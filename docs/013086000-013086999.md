# StackOverflow 问答 13086000-13086999

# android - 比较两个 XML 文件 Android

> ID：13086001
> 
> 赞同：1
> 
> 时间：2012-10-26T11:22:17.220
> 
> 标签：android, xml, compare

我想比较两个 XML 文件，它们彼此相同。我在本地存储中有一个，并使用 bufferReader 将其放在 String 上，然后从服务器获取另一个，然后再次将其放入 String 中！然后我打印它们的内容，它们实际上是相同的！即使是空格也没有什么不同！但是当我使用 equalsIgnoreCase 比较它们（2个字符串）时，它们不相等并且总是去别的！这意味着它们不相等！有人可以帮忙吗？如果没有办法像这样比较，那么我该如何比较它们呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:30:05.940

我认为这是由于格式问题而发生的。

您可以使用[XMLUnit](http://xmlunit.sourceforge.net/)来解决此问题。

XMLUnit 将帮助您

*   两段 XML 的区别
*   使用 XSLT 转换一段 XML 的结果
*   对一段 XML 的 XPath 表达式求值
*   一段 XML 的有效性
*   由 DOM Traversal 公开的一段 XML 中的各个节点

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-26T11:31:32.403

你试过 string1.equals(string2)

# java - solrconfig.xml 更改后 SolrJ 中的异常

> ID：13086005
> 
> 赞同：1
> 
> 时间：2012-10-26T11:22:33.833
> 
> 标签：java, solr, solrj

**所以**！这是我的第一个问题，所以请善待；）

我一直在使用 Solr，最近发现它~~几乎~~没有安全性。所以在浏览器中，您可以 `http://HOST:PORT/solr/update?stream.body=<delete><query>*:*</query></delete>&commit=true` 轻而易举地编写和删除我的索引。

阅读 Solr wiki 我编辑了我的 solrconfig.xml 文件，添加了我自己的 RequestHandler 以进行更新。

```
<requestHandler name="/theupdate" 
   class="solr.XmlUpdateRequestHandler">
</requestHandler> 
```

..而不是默认的..

```
<requestHandler name="/update" 
   class="solr.XmlUpdateRequestHandler">
</requestHandler> 
```

现在，在将文档集合添加到服务器时（在提交之前），我遇到了这个异常。

```
org.apache.solr.client.solrj.SolrServerException: Server at http://HOST:PORT/solr returned non ok status:400, message:Missing solr core name in path
  at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:328)
  at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:211)
  at org.apache.solr.client.solrj.request.AbstractUpdateRequest.process(AbstractUpdateRequest.java:105)
  at org.apache.solr.client.solrj.SolrServer.add(SolrServer.java:69)
  at org.apache.solr.client.solrj.SolrServer.add(SolrServer.java:54) 
```

这是我的索引代码：

```
SolrServer server = new HttpSolrServer("http://HOST:PORT/solr");
Collection<SolrInputDocument> colection = new ArrayList<SolrInputDocument>();
SolrInputDocument solrDoc = new SolrInputDocument();
OracleCachedRowSet rsX = getDataFromDB(); // not actual line
while (rsX.next()) {
  solrDoc.addField("id", rsX.getLong(1), 1.0f);
  solrDoc.addField("name", rsX.getString(2), 1.0f);
  colection.add(solrDoc);
}
server.add(colection); //<-- the exception is thrown here!
server.commit();
colection.clear(); 
```

*注意：我读过一些关于通过防火墙保护 Solr 和/或我正在处理的 servlet 容器中的基本身份验证的内容......*

**提前致谢！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:56:21.757

我一直在查看 HttpSolrServer 上可用的[方法以及 SolrJ 库中](http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/client/solrj/SolrServer.html)[SolrServer](http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/client/solrj/impl/HttpSolrServer.html)上的各种`add`方法，不幸的是，我没有看到任何地方可以在 SolrJ 中为 updateHandler 覆盖或指定不同的名称。它假定它将通过`http://HOST:PORT/solr/update`

# asp.net - 如何强制实体框架插入标识列？

> ID：13086006
> 
> 赞同：70
> 
> 时间：2012-10-26T11:22:39.103
> 
> 标签：asp.net, sql-server, database, entity-framework, ef-code-first

我想编写一些 C# 代码来用一些种子数据初始化我的数据库。显然，这将需要能够在插入时设置各种标识列的值。我正在使用代码优先的方法。默认情况下，`DbContext`处理数据库连接，因此您不能`SET IDENTITY_INSERT [dbo].[MyTable] ON`. 所以，到目前为止我所做的是使用`DbContext`让我指定要使用的数据库连接的构造函数。然后，我设置`IDENTITY_INSERT`为该`ON`数据库连接，然后尝试使用实体框架插入我的记录。这是我到目前为止的一个例子：

```
public class MyUserSeeder : IEntitySeeder {
    public void InitializeEntities(AssessmentSystemContext context, SqlConnection connection) {
        context.MyUsers.Add(new MyUser { MyUserId = 106, ConceptPersonId = 520476, Salutation = "Mrs", Firstname = "Novelette", Surname = "Aldred", Email = null, LoginId = "520476", Password="28c923d21b68fdf129b46de949b9f7e0d03f6ced8e9404066f4f3a75e115147489c9f68195c2128e320ca9018cd711df", IsEnabled = true, SpecialRequirements = null });
        try {
            connection.Open();
            SqlCommand cmd = new SqlCommand("SET IDENTITY_INSERT [dbo].[MyUser] ON", connection);
            int retVal = cmd.ExecuteNonQuery();
            context.SaveChanges();
        }
        finally {
            connection.Close();
        }
    }
} 
```

如此接近但到目前为止 - 因为，虽然`cmd.ExecuteNonQuery()`工作正常，但当我运行时`context.SaveChanges()`，我被告知“当 IDENTITY_INSERT 设置为 ON 或复制用户时，必须为表 'MyUser' 中的标识列指定显式值插入到 NOT FOR REPLICATION 标识列中。”

据推测，因为 MyUserId（即 MyUser 表中的 Identity 列）是主键，所以实体框架在我调用时不会尝试设置它`context.SaveChanges()`，即使我为`MyUser`实体提供了`MyUserId`属性值。

那么有没有办法强制实体框架尝试插入实体的主键值呢？或者可能是一种临时标记`MyUserId`为不是主键值的方法，所以 EF 尝试插入它？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2015-08-06T13:22:39.680

**EF 6**方法，使用[msdn 文章](https://msdn.microsoft.com/en-us/dn456843)：

```
using (var dataContext = new DataModelContainer())
using (var transaction = dataContext.Database.BeginTransaction())
{
    var user = new User()
    {
        ID = id,
        Name = "John"
    };

    dataContext.Database.ExecuteSqlCommand("SET IDENTITY_INSERT [dbo].[User] ON");

    dataContext.User.Add(user);
    dataContext.SaveChanges();

    dataContext.Database.ExecuteSqlCommand("SET IDENTITY_INSERT [dbo].[User] OFF");

    transaction.Commit();
} 
```

**更新：**为避免错误“当 IDENTITY_INSERT 设置为 ON 或复制用户插入 NOT FOR REPLICATION 标识列时，必须为表 'TableName' 中的标识列指定显式值”，您应该更改**StoreGeneratedPattern**属性的值模型设计器中从 Identity 到**None的标识列。**

请注意，将 StoreGeneratedPattern 更改为 None 将无法插入没有指定 id 的对象（正常方式），并出现错误“当 IDENTITY_INSERT 设置为 OFF 时，无法在表 'TableName' 中插入标识列的显式值”。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-10-26T11:41:28.810

你不需要对连接做任何有趣的事情，你可以去掉中间人，只使用[`ObjectContext.ExecuteStoreCommand`](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.executestorecommand.aspx).

然后，您可以通过执行以下操作来实现您想要的：

```
context.ExecuteStoreCommand("SET IDENTITY_INSERT [dbo].[MyUser] ON"); 
```

我不知道有任何内置方式告诉 EF 设置身份插入。

它并不完美，但它会比您当前的方法更灵活且更少“hacky”。

**更新：**

我刚刚意识到您的问题还有第二部分。既然您已经告诉 SQL 您想要进行身份插入，EF 甚至不会尝试为所述身份插入值（为什么会这样？我们还没有告诉它）。

我没有任何使用代码优先方法的经验，但是从一些快速搜索看来，您似乎需要告诉 EF 您的列不应该从商店生成。你需要做这样的事情。

```
Property(obj => obj.MyUserId)
    .HasDatabaseGeneratedOption(DatabaseGeneratedOption.None)
    .HasColumnName("MyUserId"); 
```

希望这会让你指出正确的方向:-)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-06-30T21:27:59.050

聚会有点晚了，但如果有人首先在 EF5 中使用 DB 遇到这个问题：我无法让任何一种解决方案都能正常工作，但找到了另一种解决方法：

在运行`.SaveChanges()`命令之前，我重置了表的身份计数器：

```
Entities.Database.ExecuteSqlCommand(String.Format("DBCC CHECKIDENT ([TableNameHere], RESEED, {0})", newObject.Id-1););
Entities.YourTable.Add(newObject);
Entities.SaveChanges(); 
```

这意味着`.SaveChanges()`需要在每次添加后应用 - 但至少它有效！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-01-16T11:25:51.040

这是问题的解决方案。我已经在 EF6 上尝试过，它对我有用。以下是一些应该可以工作的伪代码。

首先，您需要创建默认 dbcontext 的重载。如果您检查基类，您会发现通过现有 dbConnection 的基类。检查以下代码 -

```
public MyDbContext(DbConnection existingConnection, bool contextOwnsConnection)
        : base(existingConnection, contextOwnsConnection = true)
    {
        //optional
        this.Configuration.ProxyCreationEnabled = true;
        this.Configuration.LazyLoadingEnabled = true;
        this.Database.CommandTimeout = 360;
    } 
```

在 On modelcreating 中删除 db 生成的选项，例如，

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<MyTable>()
            .Property(a => a.Id)
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.None);

        base.OnModelCreating(modelBuilder);
    } 
```

现在在代码中你需要明确地传递一个连接对象，

```
using (var connection = new System.Data.SqlClient.SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionStringName"].ConnectionString))
        {
            connection.Open();
            using (var context = new MyDbContext(connection, true))
            {
                context.Database.ExecuteSqlCommand("SET IDENTITY_INSERT [dbo].[MyTable] ON");
                context.MyTable.AddRange(objectList);
                context.SaveChanges();
                context.Database.ExecuteSqlCommand("SET IDENTITY_INSERT [dbo].[MyTable] OFF");
            }

            connection.Close();
        } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-06-04T16:27:40.640

**这个想法只有在目标表为空，或者插入的记录的 id 高于表中所有现有 id 的情况下才有效！**

3 年过去了，我在将生产数据传输到测试系统时遇到了类似的问题。用户希望能够随时将生产数据复制到测试系统中，因此我没有在 SQL Server 中设置传输作业，而是寻找一种使用现有 EF 类在应用程序中完成传输的方法。通过这种方式，我可以为用户提供一个菜单项，以便在他们想要的时候开始传输。

该应用程序使用 MS SQL Server 2008 数据库和 EF 6。由于这两个数据库通常具有相同的结构，我认为我可以通过读取每个实体的记录来轻松地将数据从一个 DbContext 实例传输到另一个实例，`AsNoTracking()`并且只需`Add()`（或`AddRange()`）记录到目标 DbContext 实例上的适当属性。

这是一个带有一个实体的 DbContext 来说明：

```
public class MyDataContext: DbContext
{
    public virtual DbSet<Person> People { get; set; }
} 
```

要复制人员数据，我执行了以下操作：

```
private void CopyPeople()
{
    var records = _sourceContext.People.AsNoTracking().ToArray();
    _targetContext.People.AddRange(records);
    _targetContext.SaveChanges();
} 
```

只要以正确的顺序复制表（以避免外键约束问题），它就可以很好地工作。不幸的是，使用标识列的表使事情变得有些困难，因为 EF 忽略了 id 值，只是让 SQL Server 插入下一个标识值。对于具有标识列的表，我最终执行了以下操作：

1.  读取给定实体的所有记录
2.  按 id 升序排列记录
3.  将表的标识种子设置为第一个 id 的值
4.  跟踪下一个标识值，逐个添加记录。如果 id 与预期的下一个身份值不同，则将身份种子设置为下一个所需的值

只要表是空的（或者所有新记录的 id 都高于当前的 hisghest id），并且 id 是按升序排列的，EF 和 MS SQL 将插入所需的 id，并且系统都不会抱怨。

这里有一些代码来说明：

```
private void InsertRecords(Person[] people)
{
    // setup expected id - presumption: empty table therefore 1
    int expectedId = 1;

    // now add all people in order of ascending id
    foreach(var person in people.OrderBy(p => p.PersonId))
    {
        // if the current person doesn't have the expected next id
        // we need to reseed the identity column of the table
        if (person.PersonId != expectedId)
        {
            // we need to save changes before changing the seed value
            _targetContext.SaveChanges();

            // change identity seed: set to one less than id
            //(SQL Server increments current value and inserts that)
            _targetContext.Database.ExecuteSqlCommand(
                String.Format("DBCC CHECKIDENT([Person], RESEED, {0}", person.PersonId - 1)
            );

            // update the expected id to the new value
            expectedId = person.PersonId;
        }

        // now add the person
        _targetContext.People.Add(person);

        // bump up the expectedId to the next value
        // Assumption: increment interval is 1
        expectedId++;
    }

    // now save any pending changes
    _targetContext.SaveChanges();
} 
```

使用反射，我能够编写一个适用于 DbContext 中所有实体的方法`Load`。`Save`

这有点小技巧，但它允许我使用标准 EF 方法来读取和写入实体，并克服了如何在一组给定情况下将标识列设置为特定值的问题。

我希望这对面临类似问题的其他人有所帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-27T16:01:26.177

经过仔细考虑，我认为实体框架拒绝插入标识列是一个特性，而不是一个错误。:-) 如果我要在我的数据库中插入所有条目，包括它们的标识值，我还必须为实体框架为我自动创建的每个链接表创建一个实体！这不是正确的方法。

所以我正在做的是设置只使用 C# 代码并创建 EF 实体的种子类，然后使用 a`DbContext`来保存新创建的数据。将转储的 SQL 转换为 C# 代码需要更长的时间，但没有（也不应该）过多的数据只是用于“播种”数据 - 它应该是少量具有代表性的数据可以在实时数据库中快速放入新数据库以进行调试/开发的那种数据。这确实意味着如果我想将实体链接在一起，我必须对已经插入的内容进行查询，否则我的代码将不知道它们生成的标识值，例如。在我设置并完成后，这种事情将出现在种子代码`context.SaveChanges`中`MyRoles`：

```
var roleBasic = context.MyRoles.Where(rl => rl.Name == "Basic").First();
var roleAdmin = context.MyRoles.Where(rl => rl.Name == "Admin").First();
var roleContentAuthor = context.MyRoles.Where(rl => rl.Name == "ContentAuthor").First();

MyUser thisUser = context.MyUsers.Add(new MyUser {
    Salutation = "Mrs", Firstname = "Novelette", Surname = "Aldred", Email = null, LoginUsername = "naldred", Password="c1c966821b68fdf129c46de949b9f7e0d03f6cad8ea404066f4f3a75e11514748ac9f68695c2128e520ca0275cd711df", IsEnabled = true, SpecialRequirements = null
});
thisUser.Roles.Add(roleBasic); 
```

这样做也使我更有可能在更改架构时更新我的​​播种数据，因为我可能会在更改它时破坏播种代码（如果我删除字段或实体，则使用该字段的现有播种代码/entity 将无法编译）。使用 SQL 脚本进行播种，情况并非如此，SQL 脚本也不会与数据库无关。

所以我认为，如果您尝试设置实体的身份字段以进行 DB 播种数据，那么您肯定采取了错误的方法。

如果我实际上将大量数据从 SQL Server 拖到 PostgreSQL（一个完整的实时数据库，而不仅仅是一些种子数据），我可以通过 EF 来完成，但我希望同时打开两个上下文，并编写一些代码以从源上下文中获取所有各种实体并将它们放入目标上下文中，然后保存更改。

通常，唯一适合插入标识值的时间是当您从一个 DB 复制到同一 DBMS 中的另一个 DB（SQL Server -> SQL Server、PostgreSQL -> PostgreSQL 等）时，然后您会这样做它在 SQL 脚本中，而不是 EF 代码优先（SQL 脚本不会与 DB 无关，但它不需要；您不会在不同的 DBMS 之间切换）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-29T16:16:29.017

在尝试了在此站点上找到的几个选项后，以下代码对我有用（**EF 6**）。请注意，如果项目已经存在，它首先会尝试正常更新。如果没有，则尝试正常插入，如果错误是由于 IDENTITY_INSERT 引起的，则尝试解决方法。还要注意 db.SaveChanges 将失败，因此 db.Database.Connection.Open() 语句和可选的验证步骤。请注意，这不会更新上下文，但在我的情况下，这不是必需的。希望这可以帮助！

```
public static bool UpdateLeadTime(int ltId, int ltDays)
{
    try
    {
        using (var db = new LeadTimeContext())
        {
            var result = db.LeadTimes.SingleOrDefault(l => l.LeadTimeId == ltId);

            if (result != null)
            {
                result.LeadTimeDays = ltDays;
                db.SaveChanges();
                logger.Info("Updated ltId: {0} with ltDays: {1}.", ltId, ltDays);
            }
            else
            {
                LeadTime leadtime = new LeadTime();
                leadtime.LeadTimeId = ltId;
                leadtime.LeadTimeDays = ltDays;

                try
                {
                    db.LeadTimes.Add(leadtime);
                    db.SaveChanges();
                    logger.Info("Inserted ltId: {0} with ltDays: {1}.", ltId, ltDays);
                }
                catch (Exception ex)
                {
                    logger.Warn("Error captured in UpdateLeadTime({0},{1}) was caught: {2}.", ltId, ltDays, ex.Message);
                    logger.Warn("Inner exception message: {0}", ex.InnerException.InnerException.Message);
                    if (ex.InnerException.InnerException.Message.Contains("IDENTITY_INSERT"))
                    {
                        logger.Warn("Attempting workaround...");
                        try
                        {
                            db.Database.Connection.Open();  // required to update database without db.SaveChanges()
                            db.Database.ExecuteSqlCommand("SET IDENTITY_INSERT[dbo].[LeadTime] ON");
                            db.Database.ExecuteSqlCommand(
                                String.Format("INSERT INTO[dbo].[LeadTime]([LeadTimeId],[LeadTimeDays]) VALUES({0},{1})", ltId, ltDays)
                                );
                            db.Database.ExecuteSqlCommand("SET IDENTITY_INSERT[dbo].[LeadTime] OFF");
                            logger.Info("Inserted ltId: {0} with ltDays: {1}.", ltId, ltDays);
                            // No need to save changes, the database has been updated.
                            //db.SaveChanges(); <-- causes error

                        }
                        catch (Exception ex1)
                        {
                            logger.Warn("Error captured in UpdateLeadTime({0},{1}) was caught: {2}.", ltId, ltDays, ex1.Message);
                            logger.Warn("Inner exception message: {0}", ex1.InnerException.InnerException.Message);
                        }
                        finally
                        {
                            db.Database.Connection.Close();
                            //Verification
                            if (ReadLeadTime(ltId) == ltDays)
                            {
                                logger.Info("Insertion verified. Workaround succeeded.");
                            }
                            else
                            {
                                logger.Info("Error!: Insert not verified. Workaround failed.");
                            }
                        }
                    }
                }
            }
        }
    }
    catch (Exception ex)
    {
        logger.Warn("Error in UpdateLeadTime({0},{1}) was caught: {2}.", ltId.ToString(), ltDays.ToString(), ex.Message);
        logger.Warn("Inner exception message: {0}", ex.InnerException.InnerException.Message);
        Console.WriteLine(ex.Message);
        return false;
    }
    return true;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-26T12:59:14.213

我只是一名 DBA，但每当出现这样的事情时，我都认为这是一种代码味道。也就是说，为什么你有任何依赖于具有特定标识值的某些行的东西？也就是说，在您上面的示例中，为什么 Novelette 夫人需要 106 的身份值？与其一直依赖这种情况，您可以获取她的身份值并在硬编码 106 的任何地方使用它。有点麻烦，但更灵活（在我看来）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-02T19:47:52.830

> 有没有办法强制实体框架尝试插入实体的主键值？

是的，但没有我想看到的那么干净。

假设您使用的是自动生成的身份密钥，EF 将完全忽略您存储密钥值的尝试。由于上面详述的许多充分理由，这似乎是“设计使然”，但有时您仍想完全控制种子数据（或初始负载）。我建议 EF 在未来的版本中加入这种播种。但在他们这样做之前，只需编写一些在框架内工作的代码并自动处理混乱的细节。

Eventho VendorID 被 EF 忽略，您可以将其与基本循环和计数一起使用，以确定在您的实时记录之间添加多少占位符记录。占位符在添加时被分配下一个可用的 ID 号。一旦您的实时记录具有请求的 ID，您只需删除垃圾。

```
public class NewsprintInitializer: DropCreateDatabaseIfModelChanges<NewsprintContext>
{
    protected override void Seed(NewsprintContext context)
    {
        var vendorSeed = new List<Vendor>
        {
            new Vendor { VendorID = 1, Name = "#1 Papier Masson / James McClaren" },
            new Vendor { VendorID = 5, Name = "#5 Abitibi-Price" },
            new Vendor { VendorID = 6, Name = "#6 Kruger Inc." },
            new Vendor { VendorID = 8, Name = "#8 Tembec" }
        };

        //  Add desired records AND Junk records for gaps in the IDs, because .VendorID is ignored on .Add
        int idx = 1;
        foreach (Vendor currentVendor in vendorSeed)
        {
            while (idx < currentVendor.VendorID)
            {
                context.Vendors.Add(new Vendor { Name = "**Junk**" });
                context.SaveChanges();
                idx++;
            }
            context.Vendors.Add(currentVendor);
            context.SaveChanges();
            idx++;
        }
        //  Cleanup (Query/Find and Remove/delete) the Junk records
        foreach (Vendor del in context.Vendors.Where(v => v.Name == "**Junk**"))
        {
            context.Vendors.Remove(del);
        }
        context.SaveChanges();

        // setup for other classes

    }
} 
```

它按预期工作，除了我必须经常执行“SaveChanges”以保持 ID 有序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-28T13:53:49.197

我通过创建一个继承的上下文来完成这项工作：

**我与 EF 迁移的常规上下文：**

```
public class MyContext : DbContext
{
    public MyContext() : base("name=MyConnexionString")
    {...}

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        // best way to know the table names from classes... 
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
        ...
    }
} 
```

**我的替代上下文用于覆盖身份。**

不要为 EF 迁移注册此上下文（我使用它从另一个数据库传输数据）：

```
public class MyContextForTransfers : MyContext
{
    public MyContextForTransfers() : base()
    {
        // Basically tells the context to take the database as it is...
        Database.SetInitializer<MyContextForTransfers >(null);
    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
         // Tells the Context to include Isd in inserts
         modelBuilder.Conventions.Remove<StoreGeneratedIdentityKeyConvention>();
         base.OnModelCreating(modelBuilder);
    }
} 
```

**如何插入（错误管理高度简化...）：**

```
public void Insert<D>(iEnumerable<D> items)
{
    using (var destinationDb = new MyContextForTransfers())
    {
        using (var transaction = destinationDb.Database.BeginTransaction())
        {
            try
            {
                destinationDb.Database.ExecuteSqlCommand($"SET IDENTITY_INSERT [dbo].[{typeof(D).Name}] ON");
                destinationDb.Set<D>().AddRange(items);
                destinationDb.SaveChanges();
                destinationDb.Database.ExecuteSqlCommand($"SET IDENTITY_INSERT [dbo].[{typeof(D).Name}] OFF");
                transaction.Commit();
             }
             catch
             {
                transaction.Rollback();
             }
         }
    }
} 
```

在任何事务之前检查迁移可能是一个好主意，使用“常规”上下文和配置：

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-04-07T13:35:41.077

我找不到将记录插入表的方法。基本上，我用这样的东西创建了一个 SQL 脚本......

```
 sb.Append("SET IDENTITY_INSERT [dbo].[tblCustomer] ON;");

            foreach(...)
            {
                var insert = string.Format("INSERT INTO [dbo].[tblCustomer]
                     ([ID],[GivenName],[FamilyName],[NINumber],[CustomerIdent],
                      [InputterID],[CompanyId],[Discriminator]) 
                      VALUES({0}, '{1}', '{2}', '{3}', '{4}', 2, 2, 'tblCustomer'); ", 
                          customerId, firstName, surname, nINumber, Guid.NewGuid());

            sb.Append(insert);
                ...
            }

            sb.Append("SET IDENTITY_INSERT [dbo].[tblCustomer] OFF;");
            using (var sqlConnection = new SqlConnection(connectionString))
            {
                var svrConnection = new ServerConnection(sqlConnection);
                var server = new Server(svrConnection);
                server.ConnectionContext.ExecuteNonQuery(sb.ToString());
        } 
```

我正在使用 EF 6。

# html - HTML5 可拖动禁用文本字段

> ID：13086009
> 
> 赞同：1
> 
> 时间：2012-10-26T11:22:45.567
> 
> 标签：html, drag-and-drop

我正在尝试实现 html5 拖放，但我希望可拖动区域内的文本字段能够正常工作。现在输入不对鼠标事件做出反应。请参见下面的示例：

```
<div draggable="true">
    <input type="text" draggable="false" />
</div> 
```

[http://jsfiddle.net/Hvm4g/](http://jsfiddle.net/Hvm4g/)

我将如何解决这个问题？请不要提供 jQuery。如果我想用 javascript 来做 - 我现在不会问这个问题。

谢谢你的想法

# ios - 带有计数的“for循环”中的addSubview

> ID：13086014
> 
> 赞同：0
> 
> 时间：2012-10-26T11:23:08.057
> 
> 标签：ios, for-loop, subview, addsubview

我对 FOR 循环和子视图有疑问。每次循环以不同的子视图名称运行时，我都想显示不同的子视图。名称必须是“hoofdstukController”+ i 计数。

我怎样才能做到这一点？我尝试了几种方法，但都使应用程序崩溃。这是我的循环：

```
_viewControllers = [[NSMutableArray alloc] init];
for (int i = 0; i < 10; i++)
{
    CGRect frame = _scrollView.frame;
    frame.origin.x = frame.size.width * i;
    frame.origin.y = 0; 
    hoofdstukController.view.frame = frame;
    [_scrollView addSubview:hoofdstukController.view];
    [_viewControllers addObject:hoofdstukController];
} 
```

希望任何人都可以将我推向正确的方向！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:28:32.127

您应该首先将所有视图控制器添加到数组中：

```
_viewControllers = [[NSMutableArray alloc] init];
[_viewControllers addObject:hoofdstukController];
[_viewControllers addObject:hoofdstukController0];
[_viewControllers addObject:hoofdstukController1];
//etc. 
```

然后你可以遍历该数组并将它们的视图添加为子视图。请注意，您还应该将它们添加为父视图控制器的子视图控制器：

编辑：对不起'我'工作你需要修改一下

```
for (UIViewController *vc in _viewControllers)
{
    CGRect frame = _scrollView.frame;
    frame.origin.x = frame.size.width * i;
    frame.origin.y = 0; 
    vc.view.frame = frame;

    [viewControllerHostingTheScrollView addChildViewController:vc];
    [_scrollView addSubview:vc.view];
    [vc didMoveToParentViewController:viewControllerHostingTheScrollView];
} 
```

编辑：对不起'我'工作你需要修改一下：

```
int i = 0;
for (UIViewController *vc in _viewControllers)
{
    CGRect frame = _scrollView.frame;
    frame.origin.x = frame.size.width * i++;
    frame.origin.y = 0; 
    vc.view.frame = frame;

    [viewControllerHostingTheScrollView addChildViewController:vc];
    [_scrollView addSubview:vc.view];
    [vc didMoveToParentViewController:viewControllerHostingTheScrollView];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:47:34.850

在您的代码中，您 `hoofdstukController.view.frame`在一个 hoofdstukController 中设置了 10 次框架。它需要最后一帧（`frame.size.width * i`）。在这里，您必须在每次 for 循环运行以及 `alloc`您的.`init``setTag``hoofdstukController.tag=i`

# c# - 为什么在调用 ServiceHost.Open 之前实例化 XmlSerializer 会产生内存和句柄泄漏

> ID：13086015
> 
> 赞同：8
> 
> 时间：2012-10-26T11:23:08.990
> 
> 标签：c#, .net, wcf, windows-services, xml-serialization

在 .NET/WCF/Windows 服务中寻找内存和句柄泄漏时，我注意到我无法解释的奇怪行为。这里是设置和分辨率。我正在寻找的是对观察到的行为的解释。

我安装了一个 Windows 服务。
我启动了服务。
我使用事务性 WCF 调用调用了一个简单的方法（每次调用新通道 - 无缓存）。
对于每个调用，大约 2 个句柄保留在内存中。

如果以下项目适用，则可以观察到这一点：

1.  它是一个 Windows 服务；不要将其作为控制台应用程序运行。
2.  使用事务（仅单独的进程或机器测试）调用 WCF 方法。
3.  `ServiceBase.Run(servicesToRun);`在使用某种类型调用实例化 XmlSerializer 之前。
4.  该类型是自定义类型。它不会与`new XmlSerializer(typeof(string))`或 new一起发生`XmlSerializer(typeof(XmlDocument))`。无需调用序列化。如果自定义类型只有一个字符串作为属性就足够了（任何地方都没有句柄！）
5.  使用即 SGen.exe 创建静态 XmlSerialization.dll 不会产生此问题。

我的代码已经包含修复： 在 OnStart() 中*最早*
使用 XmlSerializer ：

 ***程序.cs**

```
WindowsService winSvc = new WindowsService();
ServiceBase[] servicesToRun = new ServiceBase[]{winSvc};                    
ServiceBase.Run(servicesToRun); 
```

**WindowsService.cs**

```
internal sealed class WindowsService : ServiceBase
{
    private ServiceHost wcfServiceHost = null;

    internal WindowsService()
    {
        AutoLog = true;
        CanStop = true;
        CanShutdown = true;
        CanPauseAndContinue = false;
    }

    internal void StartWcfService()
    {
        wcfServiceHost = new ServiceHost(typeof(DemoService));
        wcfServiceHost.Open();
    }

    protected override void Dispose(bool disposing)
    {
        if (wcfServiceHost != null)
        {
            wcfServiceHost.Close();
        }

        base.Dispose(disposing);
    }

    protected override void OnStart(string[] args)
    {
        new XmlSerializer(typeof(MyType));

        StartWcfService();
    }
} 
```

**演示服务.cs**

```
[ServiceBehavior
    (
        InstanceContextMode = InstanceContextMode.PerSession,
        TransactionAutoCompleteOnSessionClose = false,
        IncludeExceptionDetailInFaults = true
    )
]
public sealed class DemoService : IDemoService
{           
    [TransactionFlow(TransactionFlowOption.Allowed)]
    [OperationBehavior(TransactionScopeRequired = true, TransactionAutoComplete = true)]
    public int Add(int a, int b)
    {
        return a + b;
    }
} 
```

**客户端.cs**：

```
IChannelFactory<IDemoService> channelFactory = new ChannelFactory<IDemoService>("defaultClientConfiguration");
IDisposable channel = null;
for (int index = 0; index < 5000; index++)
{
    using
    (
        channel = (IDisposable)channelFactory.CreateChannel(new EndpointAddress("net.tcp://localhost:23456/DemoService")))
        {                       
        IDemoService demoService = (IDemoService)channel;
        using (TransactionScope tx = new TransactionScope(TransactionScopeOption.RequiresNew))
        {
            demoService.Add(3, 9);
            tx.Complete();  
        }
    )
} 
```

有人可以解释这种行为吗？

请注意，我对找到避免泄漏的方法不感兴趣（我已经知道如何做到这一点），而是在解释中（即为什么会发生）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T19:37:47.907

我认为一些内部运作可以解决这个问题。我从脑后开始这样做，因为我前段时间也遇到了这个问题，我花了一天的时间来回溯，包括广泛使用 Reflector 和 ANTS 内存分析器（在我以前的公司）......在这里去：

XML Serializer 在内部所做的是它使用 System.Reflection.Emit 创建一个类（我们称之为“A”），该类接受您传递给它的类型。相对而言，构建这样一个类需要花费大量时间，并且由于类型不会改变，因此可以重用。因此，构造的类型存储在字典中，例如它以一些 Dictionary 结尾。

对于已知（基本）类型，序列化程序代码是固定的，例如，无论您重新启动应用程序多少次，字符串的序列化都不会改变。请注意与“A”的区别，即序列化工厂不知道的任何类型，直到它第一次传递给 XMLSerializer。

XMLSerializer 第一次使用该类型时，这个过程会发生在您传递的类型和它需要的所有类型（例如所有需要序列化的字段和属性）上。

关于泄漏...当您调用 ChannelFactory 时，如果它尚不存在，它会构造序列化程序。为此，它检查序列化程序是否已存在于字典中，如果不存在，则通过创建 ISomeSerializerType 实例来创建序列化程序。

由于某些愚蠢的原因，工厂中存在一个错误，它构造了一个新的序列化程序而不将其存储在字典中。一旦构造完成，你最终会得到一个新类型——它显示为泄漏（记住：类型永远不能被卸载）——即使对象被正确处理。当您首先使用 XMLSerializer 或创建静态类时，它会正确使用 Dictionary 缓存，这意味着它不会泄漏。所以你有它，**这是一个错误**。我曾经可以访问 ANTS Memory Profiler，它很好地展示了这一点。

希望这能解释。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-26T12:28:00.410

XmlSerializer 文档是这样说的：

> 为了提高性能，XML 序列化基础结构动态生成程序集以序列化和反序列化指定类型。基础结构查找并重用这些程序集。此行为仅在使用以下构造函数时发生：
> 
> XmlSerializer.XmlSerializer(类型)
> 
> XmlSerializer.XmlSerializer（类型，字符串）
> 
> 如果您使用任何其他构造函数，则会生成同一程序集的多个版本并且永远不会卸载，这会导致内存泄漏和性能下降。最简单的解决方案是使用前面提到的两个构造函数之一。否则，您必须将程序集缓存在 Hashtable 中，如下例所示。

[http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)*

# sql-server-2008 - 将 mm/dd/yyyy hh:mm;ss AM/PM 转换为日期时间

> ID：13086021
> 
> 赞同：-1
> 
> 时间：2012-10-26T11:23:38.903
> 
> 标签：sql-server-2008, datetime

当我尝试转换日期时，出现以下错误

```
DECLARE @MinLogDate AS varchar(100)
DECLARE @MinDate AS DATETIME

SET @MinLogDate = '10/26/2012 01:23:90 AM'
SET @MinDate = (SELECT CONVERT(CHAR(10), CONVERT(datetime, @MinLogDate,103),101)) 
```

错误：

> *将 varchar 数据类型转换为 datetime 数据类型导致值超出范围。*

如何将 varchar 时间转换为日期时间？

**编辑**

根据我修改的答案..下面是我得到的实际日期时间..所以现在我可以得到头脑，但最大日期不起作用

```
 DECLARE @MinDate AS DATETIME
    DECLARE @MaxDate AS DATETIME
    DECLARE @MinLogDate AS varchar(100)
    DECLARE @MaxLogDate AS varchar(100)

    SET @MinLogDate = '8/1/2012 01:00:00 AM'
    SET @MaxLogDate = '8/31/2012 01:00:00 PM'

    SET @MinDate = CONVERT(datetime, LEFT(@MinLogDate, 10), 101)
    SET @MaxDate = CONVERT(datetime, LEFT(@MaxLogDate, 10), 101)

    SELECT @MinDate
    SELECT @MaxDate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:41:51.040

首先`103`是英国/法国`dd/mm/yyyy`，你似乎是从美国转换过来的`mm/dd/yyyy`，应该是`101`。

从`CHAR(10)`您的代码中判断 - 您只是在寻找日期部分吗？如果是这样，那么这应该足够了：

```
SET @MinDate = CONVERT(datetime, LEFT(@MinLogDate, 10), 101) 
```

**更新：**

除了您更新的问题，这现在应该可以解决问题：

```
SET @MinDate = CONVERT(datetime, LEFT(@MinLogDate, CHARINDEX(' ', @MinLogDate)), 101)
SET @MaxDate = CONVERT(datetime, LEFT(@MaxLogDate, CHARINDEX(' ', @MaxLogDate)), 101) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:50:57.367

涵盖的时间和日期。

将它们分解为组成元素。

```
DECLARE @MinLogDate AS varchar(100)
DECLARE @MinDate AS DATETIME
SET @MinLogDate = '10/26/2012 01:23:30 AM'

DECLARE @minLD varchar(16) 
DECLARE @minLT varchar(16) 

-- In response to user's comment
SET @minLD = LEFT(@MinLogDate,CHARINDEX(' ',@MinLogDate));
SET @minLT = RIGHT( @MinLogDate, LEN(@MinLogDate) - CHARINDEX(' ', @MinLogDate));

SELECT @MinDate = CONVERT(datetime, @minLD, 101) + CONVERT(time, @minLT) 
```

**笔记：**

在继续之前，我将您的时间字符串更改为有效时间字符串：)

**额外说明**

和巴里一样，我改成`103`了`101`.

编辑：回应不断变化的问题：D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T12:19:27.117

试试这个：**更改：**如上答案我将日期格式类型 101 从 103 更改。

```
DECLARE @MinLogDate AS varchar(100)
DECLARE @MinDate AS DATETIME

SET @MinLogDate = '10/26/2012 01:23:10 AM'
SET @MinDate = (SELECT CONVERT(CHAR(10), Replace(CONVERT(VARCHAR(20), Cast(@MinLogDate AS DATETIME), 101), '-', '/'))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-03T17:08:40.907

以下是我过去使用的所有格式：

```
 select CONVERT(VARCHAR(19),GETDATE())
    select CONVERT(VARCHAR(10),GETDATE(),10)
    select CONVERT(VARCHAR(10),GETDATE(),110)
    select CONVERT(VARCHAR(11),GETDATE(),6)
    select CONVERT(VARCHAR(11),GETDATE(),106)
    select CONVERT(VARCHAR(24),GETDATE(),113)
    select CONVERT(VARCHAR(10),GETDATE(),101)
    select CONVERT(VARCHAR(10),CAST(GETDATE() AS DATE), 101)
    select CONVERT(VARCHAR(8), GETDATE(), 1) 
    select CONVERT(VARCHAR(10), GETDATE(), 101) 
    select CONVERT(VARCHAR(8), GETDATE(), 10) 
    select CONVERT(VARCHAR(10), GETDATE(), 110) 
    select CONVERT(VARCHAR(23), GETDATE(), 121)
    select CONVERT(varchar(23), getdate()+0.20, 121)
    select CONVERT(varchar(23), getdate()+0.20, 21)
    select CONVERT(varchar(23), getdate()+0.20, 20)
    select CONVERT(varchar(23), getdate()+0.20, 120)
    select convert(varchar (10),CONVERT(varchar(23), getdate(), 120),110)

    select datediff(week, dateadd(week, datediff(week, 0, dateadd(month, datediff(month, 0, getdate()), 0)), 0), getdate() - 1) + 1 ----- this shows the week of month - which week today's date is in the current month

    SELECT CONVERT(VARCHAR(10), GETDATE(), 101) + ' ' + CONVERT(VARCHAR(8), GETDATE(), 108)-- format is mm/dd/yyyy hh:mm:ss

    select CONVERT(VARCHAR(10), GETDATE(), 101) + ' ' + SUBSTRING( convert(varchar, getdate(),108),1,5)-- format is mm/dd/yyyy hh:mm

    select convert(varchar(10), GETDATE(), 101) + stuff(right(convert(varchar(26),GETDATE(),109 ),15 ),7,7,' ')-- format is mm/dd/yyyy hh:mm AM/PM
    SELECT CONVERT(VARCHAR(10),GETDATE(),101) +' '+ SUBSTRING(CONVERT(VARCHAR(20), GETDATE(), 9), 13, 5) + ' ' + SUBSTRING(CONVERT(VARCHAR(30), GETDATE(), 9), 25, 2)-- format is mm/dd/yyyy hh:mm AM/PM

    select convert(varchar(10), GETDATE(), 101) + right(convert(varchar(32),GETDATE(),100),8)
    select CONVERT(VARCHAR(10), GETDATE(), 101) + ' ' + RIGHT(CONVERT(VARCHAR, GETDATE(), 100), 7)
    select convert(varchar,getDate(),120)
    select convert(varchar(10),getDate(),120)

    SELECT convert(varchar, getdate(), 100) -- mon dd yyyy hh:mmAM
    SELECT convert(varchar, getdate(), 101) -- mm/dd/yyyy 
    SELECT convert(varchar, getdate(), 102) -- yyyy.mm.dd 
    SELECT convert(varchar, getdate(), 103) -- dd/mm/yyyy
    SELECT convert(varchar, getdate(), 104) -- dd.mm.yyyy
    SELECT convert(varchar, getdate(), 105) -- dd-mm-yyyy
    SELECT convert(varchar, getdate(), 106) -- dd mon yyyy
    SELECT convert(varchar, getdate(), 107) -- mon dd, yyyy
    SELECT convert(varchar, getdate(), 108) -- hh:mm:ss
    SELECT convert(varchar, getdate(), 109) -- mon dd yyyy hh:mm:ss:mmmAM (or PM)
    SELECT convert(varchar, getdate(), 110) -- mm-dd-yyyy
    SELECT convert(varchar, getdate(), 111) -- yyyy/mm/dd
    SELECT convert(varchar, getdate(), 112) -- yyyymmdd
    SELECT convert(varchar, getdate(), 113) -- dd mon yyyy hh:mm:ss:mmm
    SELECT convert(varchar, getdate(), 114) -- hh:mm:ss:mmm(24h)
    SELECT convert(varchar, getdate(), 120) -- yyyy-mm-dd hh:mm:ss(24h)
    SELECT convert(varchar, getdate(), 121) -- yyyy-mm-dd hh:mm:ss.mmm
    SELECT convert(varchar, getdate(), 126) -- yyyy-mm-ddThh:mm:ss.mmm 
```

# c# - 类似于 vert.x for .Net 的框架

> ID：13086025
> 
> 赞同：8
> 
> 时间：2012-10-26T11:23:56.247
> 
> 标签：c#, .net, vert.x

.Net是否有类似于[vert.x](http://www.infoq.com/news/2012/05/vertx)（构建在 JVM 之上）的框架？

# c# - 类、结构或接口成员声明中的标记无效

> ID：13086026
> 
> 赞同：-2
> 
> 时间：2012-10-26T11:23:56.383
> 
> 标签：c#, asp.net

我正在尝试通过 asp.net webapp 发送文件。

我收到以下错误 8 次，我的代码中有不同的符号：类、结构或接口成员声明中的无效标记“=”

感觉就像我缺少一个功能，但我不确定。

这是我的整个 .cs 类代码：

```
// A namespace does not directly contain members such as fields or methods

namespace vCardGenerator.Website
{
public partial class SendvCard
{
    public void Mailvcard()
    {

//Class SendMail.cs
/*          
                string txtFile = txtFile.Text;
                string strDir = "C:\\local\\vCardGenerator.Website"; //temp save location
                string strFilename = Path.GetFileName(txtFile.PostedFile.FileName);

                txtFile.PostedFile.SaveAs(strDir + strfilename);
                mail.Attachments.Add(new MailAttachment(strDir + strFilename));
                //Error with MailAttachment/MailAddress??

                MailAddress;
                if (useOverrideIfDebug && AppSettings.EmailToAddressOverride.Length > 0)
                    to = new MailAddress(AppSettings.EmailToAddressOverride, recipient.DisplayName);
                else
                    to = recipient;

                Exception error = null;
                foreach (string server in AppSettings.SmtpServers)
                {   

*/
Mailer smtp = new Mailer(server);
}
    smtp.AddAttachment = (@"C:\\Desktop\\FirstName_FamilyName.vcf");
    smtp.FromAddress = "email";
    smtp.Subject = "vCard";
    smtp.MailBody = "vCard is added as file";
    smtp.AddRecipient = txtMail.Text;

//to = txtMail.Text;
    try
    {
        SmtpMail.Send();
    }
    catch (exception ex)
    {
        Responds.Write("Exception Occured:   " + ex);
    }
// Responds.Write("FAiled, try again please!")
    finally
    {
        Responds.Write("De vCard has been sent succesfully!");
    }
// delete vcard
    //  File.Delete(@"C:\\Bureaublad\\") + ("FirstName_LastName.vcf");
        File.Delete(strDir + strFilename);
} 
```

我是这方面的初学者，希望能得到有关如何解决这个问题的提示，因为谷歌再次让我失望了，我实际上是在搜索半天。但你必须从某个地方开始，对吗？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:26:16.790

您太早地关闭了该方法，因此之后的所有代码都在类中：

`Mailer smtp = new Mailer(server);`

`}`

删除尾随`}`并确保它在后面

`File.Delete(strDir + strFilename);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:26:39.407

您在此行下有一个大括号：

```
Mailer smtp = new Mailer(server); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:27:02.793

删除评论以揭露真相：

```
namespace vCardGenerator.Website
{
public partial class SendvCard
{
    public void Mailvcard()
    {

Mailer smtp = new Mailer(server);
} // <===== THIS ENDS THE METHOD
    smtp.AddAttachment = (@"C:\\Bureaublad\\FirstName_FamilyName.vcf");
    smtp.FromAddress = "email";
    smtp.Subject = "vCard";
    smtp.MailBody = "In de bijlage vindt u de vCard";
    smtp.AddRecipient = txtMail.Text; 
```

这意味着所有：

```
 smtp.AddAttachment = (@"C:\\Bureaublad\\FirstName_FamilyName.vcf");
    smtp.FromAddress = "email";
    smtp.Subject = "vCard";
    smtp.MailBody = "In de bijlage vindt u de vCard";
    smtp.AddRecipient = txtMail.Text; 
```

处于班级水平。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T11:27:39.273

删除块注释后两行的大括号。

# php - 新项目的 CMS 或框架

> ID：13086035
> 
> 赞同：-2
> 
> 时间：2012-10-26T11:24:21.520
> 
> 标签：php, frameworks, content-management-system

这可能是 StackExchange 的错误部分，但它是关于编程的，所以我认为这是一个很好的起点。

我被要求研究一个新系统并升级我们当前的系统。

我们目前正在运行 Drupal 6.x，但由于它现在已经过时并且我们希望扩展，我们需要更新的 CMS。我被告知要对从头开始编写自定义 CMS 或使用框架保持开放的态度。

我认为在 CMS 中需要的关键内容如下：

```
1\. Good URL routing system.
2\. A nice templating system (like PHPBB's or simular to smarty).
3\. Database driven (obviously), but it can be MySQL, MongoDB (NoSQL) etc.
4\. Easy to administer.
5\. Easy to customise (styles and modules/plugins).
6\. A good community for the CMS (a plus not a necessity).
7\. RESTful API would be a plus too.
8\. Security is paramount. 
```

但是，我已经研究过了，我不想走 Joomla 的路线！老实说，我不想等待 Drupal 8（我们也解雇了 Drupal 7，因为它太臃肿而且没有做我们想要的）。

另一方面，如果您知道任何提供大多数这些功能的框架，那么我对所有建议持开放态度，因为我非常满足于从框架基础编写一个。

所以请让我知道任何人的想法。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:26:49.030

我建议使用 WordPress - 您可以根据自己的喜好对其进行自定义，如果您正在寻找特定的功能，您很可能会通过一次 google 搜索找到它的插件。

如果您是从头开始编写主题，请考虑使用出色的[Skeleton Grid](http://getskeleton.com)系统进行响应式设计。它让我的生活更轻松。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-26T11:40:26.963

你想要一个 cms 还是一个框架？

1.  对于一个框架——codeigniter 已经很不错了。拥有你需要的大部分东西，只有模板系统直接使用 php
2.  如果它是您想要的 CMS - wordpress ...也许

我的建议是，如果您想要 smth 太具体，并针对您的需求进行优化，请选择一个框架并编写您自己的 CMS，这将 100% 符合您的需求

# android - 在到达扬声器之前处理声波

> ID：13086042
> 
> 赞同：1
> 
> 时间：2012-10-26T11:24:56.900
> 
> 标签：android, audio, processing

有什么方法可以在播放之前处理进入扬声器输入的声波？我想更改不同频率的分贝值。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:58:06.177

这取决于您要应用什么样的效果。您可以使用[SoundPool.setRate](http://developer.android.com/reference/android/media/SoundPool.html#setRate%28int,%20float%29) 来简单地更改音高。如果您想获得更复杂的效果，请考虑使用[AudioEffect](http://developer.android.com/reference/android/media/audiofx/AudioEffect.html)。

> > 我想更改不同频率的分贝值。

这正是[均衡器](http://developer.android.com/reference/android/media/audiofx/Equalizer.html)效果所做的。[您可以使用Equalizer.getBand](http://developer.android.com/reference/android/media/audiofx/Equalizer.html#setBandLevel%28short,%20short%29)检索所需频率的频段，然后使用[Equalizer.setBandLevel](http://developer.android.com/reference/android/media/audiofx/Equalizer.html#getBand%28int%29)更改其级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:36:05.520

如果你的意思是在数模转换之前，那么不，你不能从应用程序中做到这一点。您可以做的是在将音频写入您的 AudioTrack 实例之前处理音频，或者按照 Andrei 的建议使用 AudioEffect。在这两种情况下，音频在到达 DAC 之前仍可能会通过平台音频 DSP 中的附加滤波器（例如，多频带压缩、峰值限制、均衡以补偿所使用的特定扬声器组件等）。

在我看来，您想修改频域中的音频信号，因此您可以查看例如[FFTW](http://www.fftw.org/)，它具有 C 接口和 Java 包装器，因此您可以从本机代码和 Java 中使用它代码取决于你觉得最舒服的。我自己从未使用过它，所以我无法提供有关如何将其集成到 Android 项目中的任何信息。

# javascript - 如何使用 iPhone 的 phonegap 调用 web 服务并获取 json 响应

> ID：13086044
> 
> 赞同：0
> 
> 时间：2012-10-26T11:25:04.457
> 
> 标签：javascript, json, cordova, cocos2d-iphone, xcode4.5

我对phonegap很陌生。我安装了`phonegap2.1.0`in `xcode4.5`。现在phonegap工作正常。但是如何调用 web 服务并获得 phonegap 的 json 响应？我的代码在下面，但它不起作用。有谁能够帮我？

```
$(document).ready(function () {
    $.ajax({
    alert("alert");
    url: "http://localhost:55022/WebSite1/sample.asmx/returnEmployees",
    data: null,
    crossDomain: true,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg, textStatus, jqXHR){
            alert(textStatus);
            //var theRealData = msg.d;
           /*
           $.each(theRealData.employees, function (index, item) {
           // at this point, item is an array, since theRealData.employees is an array of arrays
           var col1 = item[0];
           var col2 = item[1];
           alert(col1);
           }); */
    },error:function(jqXHR, textStatus, errorThrown){
    console.log(textStatus +"------" +errorThrown + jqXHR );
    // navigator.notification.alert('Server Error');
    }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:26:07.817

这是因为当您在设备/模拟器上运行此代码时使用“localhost”，然后“localhost”指的是设备/模拟器本身，而不是包含您的 rails API 的 Web 服务器。您需要将“localhost”切换到服务器的 IP 地址或主机名。

# c# - sqlserver - mysql 传输日期时间问题

> ID：13086048
> 
> 赞同：0
> 
> 时间：2012-10-26T11:25:20.213
> 
> 标签：c#, mysql, sql-server, datetime

我正在实施一个应用程序来迁移数据`sqlserver`并`mysql`遇到问题。

说到`SQLSERVER DATETIME (e.g 1999-08-01 00:00:00.000)`要转移到MYSQL。MYSQL***在 00:00:00.000 附近返回语法错误***。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:27:57.243

这种格式应该适用于 MySQL。见[这里](http://sqlfiddle.com/#!2/d41d8/3120)。

# jquery - 无法通过 jquery 从表中删除特定行

> ID：13086050
> 
> 赞同：0
> 
> 时间：2012-10-26T11:25:21.400
> 
> 标签：jquery, html

我使用 jquery 添加新行并删除它们，但我的问题是，当我单击减号按钮时，它开始从下到上删除该行而不是删除特定行。意味着如果我在 10 行中填充数据并且现在想要删除第 5 行，然后单击第 5 行上的减号按钮，它会删除第 10、第 9 等等……我希望只有第 5 行会被删除，怎么可能。

这是我的 jquery 文件：

```
$(document).ready(function(e) {
    $("#add").click(function() {
        $('#mytable tbody>tr:last').clone(true).insertAfter('#mytable tbody>tr:last');
        var last_sn = $('#mytable tbody>tr:last>td:first').html();
        $('#mytable tbody>tr:last>td:first').html(parseInt(last_sn) + 1);
        return false;
    });
    $('#minus').click(function() {
        $('#mytable tr:last-child').remove();
    });
});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:27:42.507

改为这样做：

```
$('#minus').click(function() {
    $(this).closest("tr").remove();
});​ 
```

您的代码`$('#mytable tr:last-child').remove();`将始终删除最后一行。此外，您应该创建`minus`一个类，因为它将被复制到多行，从而导致多个元素具有相同`id`的 .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:27:54.773

这`$('#mytable tr:last-child').remove();`应该是

```
$(this).closest("tr").remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:31:39.893

$('#mytable tr:last-child').remove(); 将始终删除最后一行。

如果你有几个减号按钮，那么你不应该使用相同的 id (#minus) 而是使用一个类。

小提琴：http: [//jsfiddle.net/k8dAs/](http://jsfiddle.net/k8dAs/)

```
$('.minus').click(function()
{
  $(this).parents("tr").remove();
}); 
```

# android - 在android中无限运行广播接收器

> ID：13086052
> 
> 赞同：2
> 
> 时间：2012-10-26T11:25:30.050
> 
> 标签：android, broadcastreceiver

在我的项目中，我有一个包含提醒的数据库。我想将存储在数据库中的日期和时间与当前日期和时间进行比较并发出警报。我为此使用了广播接收器。我面临的问题是接收器无限运行并且不允许活动出现在屏幕上。另外，我检查了日期和时间是否在 if 条件下匹配，并且仅在匹配时才调用接收器。即使条件为假，它也会进入条件并启动接收器。这是我的代码。任何帮助将不胜感激。谢谢！

从数据库中检索值、比较值和启动接收器的代码：

```
 public class DisplayReminderList extends Activity {

ListView lv;
Intent intent;
public MediaPlayer mMediaPlayer;
ArrayAdapter<String> adapter;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.display_reminder_list);
    lv = (ListView) findViewById(R.id.when_display_listview_today);
    adapter = new ArrayAdapter<String>(getApplicationContext(),
            android.R.layout.simple_list_item_1);
    SQLiteDatabase database = new SQLiteHelper(getApplicationContext())
            .getWritableDatabase();
    Cursor c = database.rawQuery("select title from Reminder", null);

    c.moveToFirst();
    while (!c.isAfterLast()) {
        System.out.println("Data : " + c.getString(0));
        adapter.add(c.getString(0));
        c.moveToNext();
    }

    lv.setAdapter(adapter);
    c.close();

    Cursor c1 = database.rawQuery(
            "select title,reminderdate,remindertime from Reminder", null);
    Calendar cal;
    String when_reminder_date, when_reminder_time, d, t, when_reminder_title;
    c1.moveToFirst();
    while (!c1.isAfterLast()) {
        when_reminder_title = c1.getString(0);
        d = c1.getString(1);
        t = c1.getString(2);
        cal = Calendar.getInstance();

        when_reminder_date = String.valueOf(cal.get(Calendar.YEAR)) + "-"
                + String.valueOf(cal.get(Calendar.MONTH)) + "-"
                + String.valueOf(cal.get(Calendar.DAY_OF_MONTH));
        when_reminder_time = String.valueOf(cal.get(Calendar.HOUR_OF_DAY)) + ":"
                + String.valueOf(cal.get(Calendar.MINUTE)) + ":"
                + String.valueOf(cal.get(Calendar.SECOND));

        System.out.println("when_reminder_date =" + when_reminder_date
                + "  db date=" + d + " when_reminder_time="
                + when_reminder_time + " dbtime=" + t);

        if (when_reminder_date == d && t == when_reminder_time) {
            System.out.println("Inside if condition");
            Intent intent = new Intent(this, MyBroadcastReceiver.class);
            intent.putExtra("when_reminder_title", when_reminder_title);
            PendingIntent pendingIntent = PendingIntent.getBroadcast(
                    this.getApplicationContext(), 234324243, intent, 0);
            AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
            alarmManager.set(AlarmManager.RTC_WAKEUP, 0, pendingIntent);
            c1.moveToNext();
        }
    }

    c1.close();
    database.close();

}

public void playSound(Context context, Uri alert) {
    mMediaPlayer = new MediaPlayer();
    try {
        mMediaPlayer.setDataSource(context, alert);
        final AudioManager audioManager = (AudioManager) context
                .getSystemService(Context.AUDIO_SERVICE);
        if (audioManager.getStreamVolume(AudioManager.STREAM_ALARM) != 0) {
            mMediaPlayer.setAudioStreamType(AudioManager.STREAM_ALARM);
            mMediaPlayer.prepare();
            mMediaPlayer.start();
        }
    } catch (IOException e) {
        System.out.println("OOPS");
    }
}

public Uri getAlarmUri() {
    Uri alert = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_ALARM);
    if (alert == null) {
        alert = RingtoneManager
                .getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);
        if (alert == null) {
            alert = RingtoneManager
                    .getDefaultUri(RingtoneManager.TYPE_RINGTONE);
        }
    }
    return alert;
}

public void addreminder_method(View v) {
    intent = new Intent(this, EnterWhenReminder.class);
    startActivity(intent);
}} 
```

广播接收器代码：

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Vibrator;

public class MyBroadcastReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
    AlarmActivityWhen m = new AlarmActivityWhen();
    String title=intent.getStringExtra("when_reminder_title");
    Intent i = new Intent(context, AlertActivity.class);
    i.putExtra("when_reminder_title", title);
    context.startActivity(i);

    // Vibrate the mobile phone
    Vibrator vibrator = (Vibrator) context
            .getSystemService(Context.VIBRATOR_SERVICE);
    vibrator.vibrate(2000);
    m.playSound(context, m.getAlarmUri());

}} 
```

广播接收器调用的活动：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.widget.TextView;
public class AlertActivity extends Activity {
    TextView t;
    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_alert);
    Intent i=getIntent();
    String title=i.getStringExtra("when_reminder_title");
    t=(TextView) findViewById(R.id.title);
    t.setText(title);
}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_alert, menu);
    return true;
}} 
```

更新：

我将 c1.movetonext() 移到 if 块之外。现在它不再像以前那样无限运行了。谢谢你。但我需要它在后台连续运行并检查是否到了发出警报的时间。我应该将待处理意图的代码放在哪里以便发生这种情况？

# macos - 如何告诉 finder 我的应用程序已安装？

> ID：13086053
> 
> 赞同：1
> 
> 时间：2012-10-26T11:25:29.743
> 
> 标签：macos, shell, applescript, osx-snow-leopard, automator

我正在开发一个可可应用程序。我在 Mac OS 10.6.8 上看到了一个奇怪的行为……！

我的 Cocoa 应用程序内部有一个 Automator 操作。我希望它在安装后立即在 Automator 中列出。

条件如下： 1\. 安装后，用户不要进入安装路径。2\. 用户不应启动应用程序。

我的意思是，我只在上述情况下看到这个错误。如果我转到已安装的文件夹或启动应用程序，则会列出自动化应用程序。

我在 Mac OS 10.7.5 或 Mac OS 10.8.2 上没有看到这个缺陷。

我还通过终端尝试了触摸命令，以防万一认为是否需要任何类型的访问更新。但事实并非如此。

有什么建议么？我可以在安装 [安装应用程序后] 时运行任何类型或 Shell/Applescript，以便我可以在 automator 中列出 automator 操作吗？

任何建议或帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:01:39.280

You can have a .txt file with the below script and then you have to add postflight script when taking .pkg file in Package Maker.

```
open "/Applications/yourAppName.app" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-06T21:56:05.410

试试这个终端命令。

`/System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework/Support/lsregister .../Whatever.app`

但是，您不应该对路径进行硬编码，因为用户有时会将应用程序粘贴在奇怪的位置（引用：我这样做 :)。

# jquery - jQuery中的JSON编码数组

> ID：13086055
> 
> 赞同：0
> 
> 时间：2012-10-26T11:25:56.397
> 
> 标签：jquery, json, cakephp-2.1

我已经编写了如下的 jquery 函数。

```
$(document).ready(function() {
  $(".voteup").click(function() {
    $.getJSON('<?php echo $this->Html->url(array('controller'=>'users', 'action'=>'vote', 'up')); ?>/'+<?php echo $movie['Movie']['id']; ?>, 
        function(data) {
            $.each(data, function(key, value) {
            alert(value);
        });
    });
  }); 
```

鉴于我正在这样做。

```
echo json_encode($rating); 
```

数组看起来像。

```
array(
       'MovieRating' => array(
            'id' => '1',
            'thumbs_up' => '10',
            'total_votes' => '20',
        )
    ) 
```

如何在 jquery 中获取该数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:30:21.093

使用 php 函数 json_encode：[http://php.net/manual/de/function.json-encode.php](http://php.net/manual/de/function.json-encode.php)。

# c - C编程strtok问题

> ID：13086056
> 
> 赞同：1
> 
> 时间：2012-10-26T11:26:01.147
> 
> 标签：c, strtok, initializer

我正在使用 strtok 从字符串名称 [结果] 中提取 2 个单词。我想从 strtok 中获取第一个值并将其存储到名为 lastName 的 char 数组中，并将第二个值存储到名为 firstName 的 char 数组中。但是，当我编译我的代码时，我得到了 2 行的无效初始化程序错误，由箭头指示。如何解决我的问题？

```
char *p = NULL;
p = strtok(names[result]," ");
char lastName[50] = p; <---
p = strtok(NULL, " ");
char firstName[50] = p; <---
printf("%s %s\n",firstName,lastName); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:28:38.140

strtok 给出指向标记化字符串的指针。

`char lastName[50] = p;`你在那里做的事情真的不是一件好事。应该使用 strncpy() 来复制字符串，或者如果只想要指针，则应该存储在另一个指针中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:42:17.107

C 中的数组初始化只能使用文字，不能使用变量。所以你的代码是一个语法错误。

您需要使用典型`strcpy()`函数来复制字符串，或者一些更安全（和现代）的变体，例如`strlcpy()`or `snprintf()`。

您还可以在一次调用中进行解析和复制，使用`sscanf()`, 在格式化字符串中使用适当的大小说明符，以避免缓冲区溢出的风险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:47:37.263

您可以将字符串初始化为字符数组，例如 char lastName[50] = "Sample"; 在这种情况下，您尝试初始化指向字符数组 'char lastName[50] = p;' 的指针 这是无效的。更好的是，您可以使用 strcpy、memcpy 函数将字符串复制到字符数组中，或者您可以将其分配到另一个指针中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-30T02:07:36.400

其他答案都是正确的，因为复制字符串数据将使该程序工作，但原因`strtok`是如此卑鄙（通常使用它被认为是不明智的）是它通过将`NULL`s 插入原始字符串来更改您的输入。如果您无论如何都要使用它，您不妨利用这一点，只需使用`strtok`直接返回的指针。

不过，值得注意的是，由于输入已更改，并且可能将输入传递给您的人并没有预料到，因此在调用它之前先将*输入*`strtok`复制到单独的字符串可能会更好。

观察此代码的输出以了解我的意思：

```
int main(int argc, char *argv[]) {
  char name[] = "Firstname Lastname";

  printf("Name before strtok: %s\n", name);
  char *first = strtok(name, " ");
  char *last = strtok(NULL, " ");

  printf("Token strings: first=%s last=%s\n", first, last);
  printf("Name after strtok: %s\n", name);
} 
```

产生：

```
Firstname Name before strtok: Firstname Lastname
Token strings: first=Firstname last=Firstname
Name after strtok: Firstname 
```

# google-apps-script - Google Apps 脚本中 setrowsdata 的替代方法

> ID：13086062
> 
> 赞同：1
> 
> 时间：2012-10-26T11:26:29.363
> 
> 标签：google-apps-script, google-sheets

此处描述了从 Google App Scripts 写入 Google 电子表格：

[https://developers.google.com/apps-script/storing_data_spreadsheets#writing](https://developers.google.com/apps-script/storing_data_spreadsheets#writing)

其中包括 setRowsData 方法的详细信息。

我想知道是否有一种方法可以在电子表格中设置单个单元格。我搜索了谷歌和 SO，但还没有找到任何东西。我猜也许 setRowsData 是唯一的方法，但如果有替代的 setCellData 调用或类似的方法，我很想听听。

提前谢谢了

ps 非常抱歉，如果这不是正确的提问地点，但 Google App Script 团队正在将所有问题转给 SO

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:37:42.390

Range.setValue服务用于设置单元[格](https://developers.google.com/apps-script/class_range#setValue)的值。范围应该定义到单元格，例如，下面的代码就是这样做的。

```
var range = SpreadsheetApp.getActiveSheet().getRange("A1"); 
```

# objective-c - CTFrame 裁剪第一行文本

> ID：13086071
> 
> 赞同：3
> 
> 时间：2012-10-26T11:27:20.287
> 
> 标签：objective-c, ios, core-text, ctframe

我在使用 Core Text 时遇到了问题，我在 a 中显示的文本的第一行在`CTFrame`顶部被截断，如下面的屏幕截图所示，带有字符“B”：

![CTFrame 裁剪第一行的示例](../Images/2bb1e45c9c5553b9c29118f5adad713e.png)

我认为我在设置`CTFrame`. 我的代码如下：

```
- (void)drawRect:(CGRect)rect
{
    [super drawRect:rect];
    CGContextRef context = UIGraphicsGetCurrentContext();

    NSAttributedString *myString;

    //Create the rectangle into which we'll draw the text
    CGMutablePathRef path = CGPathCreateMutable();
    CGPathAddRect(path, NULL, self.bounds);

    //Flip the coordinate system
    CGContextSetTextMatrix(context, CGAffineTransformIdentity);
    CGContextTranslateCTM(context, 0, self.bounds.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);

    //Setup leading (line height)
    CGFloat lineHeight = 25;
    CTParagraphStyleSetting settings[] = {
        { kCTParagraphStyleSpecifierMinimumLineHeight, sizeof(CGFloat), &lineHeight },
        { kCTParagraphStyleSpecifierMaximumLineHeight, sizeof(CGFloat), &lineHeight },
    };

    CTParagraphStyleRef paragraphStyle = CTParagraphStyleCreate(settings, sizeof(settings) / sizeof(settings[0]));
    NSDictionary * attrs = [[NSDictionary alloc] initWithObjectsAndKeys:

                                (__bridge id)CTFontCreateWithName((__bridge CFStringRef) font.fontName, font.pointSize, NULL) ,
                                (NSString*)kCTFontAttributeName,

                                (id)textColor.CGColor,
                                (NSString*)kCTForegroundColorAttributeName,

                                (__bridge id) paragraphStyle,
                                kCTParagraphStyleAttributeName,
                                nil];

    myString = [[NSAttributedString alloc] initWithString:text attributes:attrs];
    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((__bridge CFAttributedStringRef)myString);
    CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0,[myString length]), path, NULL);

    CTFrameDraw(frame, context);
    CFRelease(frame);
    CFRelease(framesetter);
    CFRelease(path);
} 
```

其他 SO 帖子（[这个](https://stackoverflow.com/questions/9017593/setting-line-spacing-in-a-ctframe)和[这个](https://stackoverflow.com/questions/5511830/how-does-line-spacing-work-in-core-text-and-why-is-it-different-from-nslayoutm)）并不是很有帮助。

如何防止`CTFrame`剪切第一行？

**- 编辑 -**

减少`lineheight`到 20：

`lineheight`从第二行开始被尊重，但第一行文本的基线低于顶部 20 以内。

![在此处输入图像描述](../Images/2d189ea97907fb65cfda469a83f8d2bc.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T19:04:54.937

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:15:20.630

I managed to fix the problem. In the end it turned out to be the location at which I flipped the coordinate system, and by flipping it earlier on in the code the problem fixed itself.

# c - rails install pg - 找不到'libpq-fe.h头文件

> ID：13086073
> 
> 赞同：109
> 
> 时间：2012-10-26T11:27:37.643
> 
> 标签：c, ruby-on-rails, sqlite, ruby-on-rails-3, pg

```
$ sudo bundle install 
```

结果

```
Fetching gem metadata from https://rubygems.org/...........
Fetching gem metadata from https://rubygems.org/..
Using rake (0.9.2.2) 
Using i18n (0.6.1) 
Using multi_json (1.3.6) 
Using activesupport (3.2.8) 
Using builder (3.0.4) 
Using activemodel (3.2.8) 
Using erubis (2.7.0) 
Using journey (1.0.4) 
Using rack (1.4.1) 
Using rack-cache (1.2) 
Using rack-test (0.6.2) 
Using hike (1.2.1) 
Using tilt (1.3.3) 
Using sprockets (2.1.3) 
Using actionpack (3.2.8) 
Using mime-types (1.19) 
Using polyglot (0.3.3) 
Using treetop (1.4.11) 
Using mail (2.4.4) 
Using actionmailer (3.2.8) 
Using arel (3.0.2) 
Using tzinfo (0.3.33) 
Using activerecord (3.2.8) 
Using activeresource (3.2.8) 
Using bundler (1.2.1) 
Using coffee-script-source (1.4.0) 
Using execjs (1.4.0) 
Using coffee-script (2.2.0) 
Using rack-ssl (1.3.2) 
Using json (1.7.5) 
Using rdoc (3.12) 
Using thor (0.16.0) 
Using railties (3.2.8) 
Using coffee-rails (3.2.2) 
Using jquery-rails (2.1.3) 
Installing pg (0.14.1) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /usr/bin/ruby1.8 extconf.rb 
checking for pg_config... yes
Using config values from /usr/bin/pg_config
You need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.
You need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.
checking for libpq-fe.h... no
Can't find the 'libpq-fe.h header
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/usr/bin/ruby1.8
    --with-pg
    --without-pg
    --with-pg-dir
    --without-pg-dir
    --with-pg-include
    --without-pg-include=${pg-dir}/include
    --with-pg-lib
    --without-pg-lib=${pg-dir}/lib
    --with-pg-config
    --without-pg-config
    --with-pg_config
    --without-pg_config

Gem files will remain installed in /var/lib/gems/1.8/gems/pg-0.14.1 for inspection.
Results logged to /var/lib/gems/1.8/gems/pg-0.14.1/ext/gem_make.out
An error occurred while installing pg (0.14.1), and Bundler cannot continue.
Make sure that `gem install pg -v '0.14.1'` succeeds before bundling. 
```

我是 make`$ gem install pg -v '0.14.1'`但这无济于事

我的宝石文件

```
source 'https://rubygems.org'

#gem 'rails', '3.0.9'

#gem 'sqlite3', '1.3.6', :group => :development

gem 'rails', '3.2.8'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'
gem 'pg'
gem 'taps'

gem 'json'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

#group :production do
  #gem 'pg'
#end
#group :development do
  #gem 'sqlite3'
#end 
```

gem_make.out

```
/usr/bin/ruby1.8 extconf.rb 
checking for pg_config... yes
Using config values from /usr/bin/pg_config
You need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.
You need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.
checking for libpq-fe.h... no
Can't find the 'libpq-fe.h header
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/usr/bin/ruby1.8
    --with-pg
    --without-pg
    --with-pg-dir
    --without-pg-dir
    --with-pg-include
    --without-pg-include=${pg-dir}/include
    --with-pg-lib
    --without-pg-lib=${pg-dir}/lib
    --with-pg-config
    --without-pg-config
    --with-pg_config
    --without-pg_config 
```

mkmf.log

```
find_executable: checking for pg_config... -------------------- yes

--------------------

find_header: checking for libpq-fe.h... -------------------- no

"gcc -E -I. -I/usr/lib/ruby/1.8/i686-linux -I. -D_FORTIFY_SOURCE=2 -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -I -fno-strict-aliasing -g -g -O2  -fPIC    conftest.c -o conftest.i"
conftest.c:1:22: fatal error: libpq-fe.h: No such file or directory
compilation terminated.
checked program was:
/* begin */
1: #include <libpq-fe.h>
/* end */

-------------------- 
```

请帮帮我。谢谢你。

对不起这篇文字。您的帖子没有太多上下文来解释代码部分；请更清楚地解释您的情况。

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2012-10-26T12:01:48.613

做这个

```
$ sudo apt-get install libpq-dev 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2015-11-23T17:31:46.673

[尝试安装 pg gem 时找不到“libpq-fe.h 标头”](https://stackoverflow.com/questions/6040583/cant-find-the-libpq-fe-h-header-when-trying-to-install-pg-gem)中对此进行了回答

根据您的环境：

*   **苹果电脑：** `brew install postgresql`
*   **Ubuntu**：`sudo apt-get install libpq-dev`
*   **RHEL**：`yum install postgresql-devel`

然后`gem install pg`再次运行

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-11-04T13:46:11.747

尝试这个：

1.  冲泡安装postgresql
2.  宝石安装 pg
3.  捆绑安装

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-02-01T05:14:42.233

在 Fedora/RHEL 系统上，这成功了：

```
sudo yum install libpqxx-devel 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2019-10-05T22:06:04.093

*   所以：**Ubuntu**
*   语言编程：**C**

`$ sudo apt-get install libpq-dev`

就我而言，我把目录路径放错了。所以：

从：`gcc -o lib_version lib_version.c -I/usr/include/postgresql -lpq -std=c99`

至：`gcc -o lib_version lib_version.c -I /usr/include/postgresql -lpq -std=c99`

总帐

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-09-09T23:36:36.693

对于[Alpine Linux](https://pkgs.alpinelinux.org/contents?file=libpq-fe.h&path=&name=postgresql-dev&repo=main&arch=armhf)，您可以添加`libpq-fe.h`：

```
apk add postgresql-dev 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-04-03T08:17:39.250

对于亚马逊 Linux (AWS)：

```
sudo yum install postgresql-devel 
```

然后再次运行您的命令

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-01-08T09:39:09.853

在 Mac OS X 上运行如下：

```
gem install pg -- --with-pg-config=***/path/to/pg_config*** 
```

`***/path/to/pg_config***`是 pg_config 的路径

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-12-08T22:25:11.773

我在 Amazon AMI 上的 Jenkins 服务器上遇到了这个问题。

```
$ pg_config | grep VERSION
VERSION = PostgreSQL 9.4.9 
```

然后根据您需要的版本，您可以安装所需的库

```
$ sudo yum list postgresql* | grep devel
postgresql92-devel.x86_64               9.2.18-1.59.amzn1          @amzn-main
postgresql94-devel.x86_64               9.4.9-1.67.amzn1           @amzn-main
postgresql8-devel.x86_64                8.4.20-5.52.amzn1          amzn-main
postgresql93-devel.x86_64               9.3.14-1.62.amzn1          amzn-main
postgresql95-devel.x86_64               9.5.4-1.71.amzn1           amzn-main 
```

然后你可以安装相应的版本，在我的例子中是 9.4：

```
sudo yum install postgresql94-devel 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-10-14T05:22:06.077

这发生在我使用 capistrano 在 centos7 发行版中部署我的应用程序时。显然 gem 需要一些头文件，这些头文件可以通过安装正确的开发包来解决。

我通过运行修复了它，`sudo yum search postgres | grep devel`并为我的 postgres 安装找到了正确的包，即 10。

然后简单地运行`sudo yum install postgresql10-devel`，然后尤里卡！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-06-22T11:34:08.153

尝试这个：

```
sudo apt-get install libpq-dev
gem install pg 
```

这将是有效的！

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-05-03T17:14:54.307

在 mac 上确保您的 postgres 已链接。你可以这样做

```
brew link --overwrite postgresql 
```

这为我解决了这个问题。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-07-26T16:40:50.147

我使用 Ubuntu-16。我使用这里显示的方法：[https](https://www.postgresql.org/download/linux/ubuntu/) ://www.postgresql.org/download/linux/ubuntu/ 来安装postgresql-9.6；我`"sudo apt-get install libpq-dev"`用来安装devlib。但它仍然无法工作。所以我用这个方法`ln`建立软链接，这里是： `sudo ln -s /usr/include/postgresql/libpq-fe.h /usr/include/`; `sudo ln -s /usr/include/postgresql/postgres_ext.h /usr/include/` 我终于解决了这个问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-10-05T22:45:10.143

`brew install postgresql`为我工作。

安装 postgresql 出现另一个错误

`Error: The following directories are not writable by your user: /usr/local/lib/pkgconfig /usr/local/share/info /usr/local/share/man/man3`

通过向当前用户授予对上述目录的访问权限来修复此错误

`sudo chown -R $(whoami) (path)`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-02-07T22:16:09.430

如果您已通过[Homebrew](https://brew.sh/)`postgresql`在 MacOS 上安装

```
brew install postgresql@95 # 9.5 is the version needed in my project 
```

您可能需要`pg_config`根据您的版本找到`libpq`

我的项目需要旧版本的`pg`.

```
gem install pg -v '0.20.0' -- --with-pg config=/usr/local/Cellar/libpq/13.1/bin/pg_config 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-12-27T00:20:50.227

这对我有用：

```
sudo gem install pg -- --with-pg-config=/Applications/Postgres.app/Contents/Versions/9.4/bin/pg_config 
```

# perl - 为什么 substr 不在字符串末尾返回 undef？

> ID：13086078
> 
> 赞同：9
> 
> 时间：2012-10-26T11:27:46.593
> 
> 标签：perl, substr

我不确定这是否是定义的行为。我有以下代码：

```
use strict;
use warnings;
use Data::Dumper;

my $string = 'aaaaaa0aaaa';
my $char = substr($string, length($string), 1);
my $char2 = substr($string, length($string)+1, 1);

print Dumper($char);
print Dumper($char2); 
```

除了收到关于字符串结尾的警告之外`substr()`，我对输出感到困惑：

```
$VAR1 = '';
$VAR1 = undef; 
```

[Perldoc](http://perldoc.perl.org/functions/substr.html)说`substr`：

> substr 表达式，偏移量，长度
> 
> 如果 OFFSET 和 LENGTH 指定了部分在字符串之外的子字符串，则只返回字符串内的部分。如果子字符串超出字符串的任一端，则 substr() 返回未定义的值并产生警告。

两者`length($string)`和`length($string) + 1`都超出了字符串的（零索引）结尾，所以我不知道为什么`substr`在一种情况下返回空字符串，在另一种情况下返回空字符串`undef`。它是否与 C 用于字符串终止的 NULL 字符有关，并且`substr`在第一种情况下以某种方式返回，因此该字符串有一个“不可见”的最后一个字符不计入`length`？我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T12:47:19.403

这里有几个问题。首先，您应该考虑`substr` *偏移量*来指示字符*之间*的位置，因此：

```
 S T R I N G
0 1 2 3 4 5 6 
```

所以你可以看到偏移量 6 - 字符串的长度 - 位于字符串的*末尾*，而不是超出它。

其次，*长度*参数`substr`作为返回字符数的上限，而不是要求。这就是文档的含义，*仅返回字符串中的部分*。

将这些放在一起，类似的调用`substr 'STRING', 6, 1`- 要求在字符串*末尾**最多*一个字符- 返回空字符串，同时要求*超出*字符串结尾（或在其开始之前）的任何内容给出.**`undef`**

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T11:52:07.183

```
substr($string, length($string), 1) 
```

这给了您一个空字符串，因为`substr`考虑了`offset`between `0 to len(str)`，并且超出该范围的任何内容都是`undef`.

所以，`substr("aa", 2, 1);`-> 会给你最后一个空字符串`a`
，`substr("aa", 3, 1);`-> 会给你`undef`（子字符串完全超出范围）

**相似地： -**

*   `substr("aa", 2, 2);`-> 会在最后一个之后给你空字符串 `a`（部分超出范围的子字符串）

**现在，对于第二个： -**

```
substr($string, length($string) + 1, 1) 
```

这已经超过了最后一个允许的时间`offset`。所以它返回`undef`值。

认为： -

```
$str = "abcd"; 
```

然后，索引将如下所示： -

```
 a   b   c   d             undef
0   1   2   3  len(str)  len(str) + 1 
```

**更新**： -

因此，正如@Borodin 在他的帖子中解释的那样，该字符`d`位于偏移量之间 -`3`在`len(str)`上面的示例中。

但是，如果我们尝试访问除 include 之外的任何`len(str)`内容`len(str)`，我们将得到一个`empty`字符串，如**文档**中所示 -

> 如果 OFFSET 和 LENGTH 指定了部分在字符串之外的子字符串，则只返回字符串内的部分。

**此外**，如果我们尝试访问除`len(str)`之外的任何内容`len(str)`，我们将获得`undef`价值，如**docs**中所示：-

> 如果子字符串超出字符串的任一端，则 substr() 返回未定义的值并产生警告。**

# c++ - c ++ select只检查最后一个客户端套接字

> ID：13086085
> 
> 赞同：1
> 
> 时间：2012-10-26T11:28:04.333
> 
> 标签：c++, networking, select, blocking

我正在为聊天客户端编写服务器我正在解决的问题是以下选择仅在网络客户端连接并且最后连接的客户端正在写入时才会解除它的块。示例：我有 4 个客户端连接服务器将一直阻塞，直到客户端没有。4 写如果客户端 1-3 写它一直阻止我做错了什么？在这里分析是我的代码可能包含丑陋和无用的代码，但这只是分析它的行为

服务器.c++

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h> 
#include <sys/socket.h>
#include <netinet/in.h>
#include <boost/thread/thread.hpp>
#include <sys/time.h>
#include <sys/ioctl.h>

using namespace std;

void error(char *msg, int socket) {
    perror(msg);
    close(socket);
    exit(1);
}

int main(int argc, char** argv) {
    int sockfd, newsockfd, portno, n, highsock;
    socklen_t clilen;
    fd_set readfds;
    list<int> CliSocks;
    FD_ZERO(&readfds);
    /*
     * Sockfd, newsockfd contain values returned by the socket
     * portno stores the port number on which the server accepts connections
     * clilen stores the size of the address of the client
     * n contains the amount of character written of read
     */
    char buffer[256];
    /* buffer contains the characters read from the socket*/

    struct sockaddr_in serv_addr, cli_addr;
    /* 
     * sockaddr_in contains an internet address
     * serv_addr contains the servers address
     * cli addr contains the clients address
     */
    if (argc < 2) {
        fprintf(stderr, "ERROR no port provided");
        exit(1);
    }
    /*
     * error if no argument
     */
    sockfd = socket(AF_INET, SOCK_STREAM, 0);
    highsock = sockfd;
    FD_SET(sockfd, &readfds);
    int opt = 1;
    ioctl(sockfd, FIONBIO, &opt);

    if (sockfd < 0) {
        error("ERROR opening socket", sockfd);
    }
    /*
     * socket() creates a new socket
     * argument 1 contains the address domain
     * argument 2 contains the socket type
     * argument 3 contains the protocol should be 0
     * socket() returns a reference for itself
     */
    bzero((char*) &serv_addr, sizeof (serv_addr));
    /* empty the serv_addr variable*/
    portno = atoi(argv[1]);
    /*converts the port argument from string  to int*/
    serv_addr.sin_family = AF_INET;
    /*set the code for the address family*/
    serv_addr.sin_port = htons(portno);
    /*htons converts the portno to network bytes and gives it to the server address*/
    serv_addr.sin_addr.s_addr = INADDR_ANY;
    /*set the server ip to the ip of the running machine*/
    if (bind(sockfd, (struct sockaddr *) &serv_addr, sizeof (serv_addr)) < 0)
        error("ERROR on binding", sockfd);
    /*
     * bind() binds a socket to an address, in this case the
     * addess of the current host
     */
    listen(sockfd, 5);

    /*the listen system call allows the process to listen on the socket for connections*/

    while (1) {
        int sockcount = select(highsock + 1, &readfds, NULL, NULL, NULL);

        clilen = sizeof (cli_addr);
        newsockfd = accept(sockfd, (struct sockaddr *) &cli_addr, &clilen);
        /*
         * accept() lets the system wait until a client connects to the server
         */

        if (newsockfd > 0) {
            ioctl(newsockfd, FIONBIO, &opt);
            FD_SET(newsockfd, &readfds);
            highsock = newsockfd;
            CliSocks.push_back(newsockfd);
        }

        for (list<int>::iterator it = CliSocks.begin(); it != CliSocks.end(); it++) {
            bzero(buffer, 256);
            n = read(*it, buffer, 255);
            if(buffer[0] != 0){
            printf("Here is the message: %s", buffer);

            /*
             * bzero empties the buffer
             * read obviously reads data from the new socket descriptor
             */
            n = write(*it, "I got your message", 18);
            if (n < 0) error("ERROR writing to socket", sockfd);
                        }
        }
    }
    close(sockfd);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:47:50.307

问题是`readfds`在调用`select`. 这是因为调用`select` *修改*了它的参数。

```
while (1) {
    FD_ZERO(&readfds);
    FD_SET(sockfd, &readfds);
    highsock = sockfd;
    for (list<int>::iterator it = CliSocks.begin(); it != CliSocks.end(); it++) {
        FD_SET(*it, &readfds);
        highsock = *it > highsock ? *it : highsock;
    }
    int sockcount = select(highsock + 1, &readfds, NULL, NULL, NULL);

    ...
} 
```

# python - 如何在pygtk中获取菜单栏的大小？

> ID：13086086
> 
> 赞同：1
> 
> 时间：2012-10-26T11:28:10.717
> 
> 标签：python, user-interface, pygtk

我在主窗口中有一个 vbox。vbox 中有一个菜单和一个修复程序。该修复程序用于加载图像。我应该根据图像的大小来改变主窗口的大小。但我找不到获取菜单栏大小的方法。所以无法显示图像的底部（我将窗口设置为不可调整大小）。

我没有明确设置菜单的大小。所以似乎所有以'request'结尾的函数都返回-1。

如何获得菜单栏的实际大小？或者我怎样才能完全显示图像？

# box-api - Box API v2 如何使用电子邮件地址将单个用户的协作添加到文件夹？

> ID：13086091
> 
> 赞同：0
> 
> 时间：2012-10-26T11:28:25.907
> 
> 标签：box-api

我可以使用 Box API v1 做到这一点，但 v2 需要 user_id，我不知道如何发送邀请。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T21:00:18.210

*目前尚*无法在 V2 API 中仅基于电子邮件地址创建协作，但我们计划在未来添加对此的支持。

# php - Android Web 服务套接字异常

> ID：13086094
> 
> 赞同：0
> 
> 时间：2012-10-26T11:28:35.327
> 
> 标签：php, android, web-services

我正在尝试开发使用 Web 服务的简单应用程序。我在mysql中有登录屏幕和数据库。但是当我运行代码时，它会抛出套接字异常。我哪里出错了。我还想知道如何将数据放入来自 Web 服务的变量中。

这是我的清单文件

```
 <uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.INTERNET"/> 
```

和我的活动文件

```
package com.example.webserviceapplication;

import java.io.IOException;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;

import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity implements OnClickListener
{

EditText username,password;
Button login,cancel;
TextView msg;

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    username=(EditText)findViewById(R.id.username);
    password=(EditText)findViewById(R.id.password);

    login=(Button)findViewById(R.id.login);
    cancel=(Button)findViewById(R.id.cancel);

    msg=(TextView)findViewById(R.id.msg);

    login.setOnClickListener(new OnClickListener() 
    {

        @Override
        public void onClick(View v) 
        {
            try 
            {
                HttpClient client = new DefaultHttpClient();  
                String postURL = "http://gladiolus/TestPhp/android.php";
                HttpPost post = new HttpPost(postURL);
                HttpResponse responsePOST = client.execute(post);  
                HttpEntity resEntity = responsePOST.getEntity();  
                String response=EntityUtils.toString(resEntity);
                response=response.trim();
                msg.setText(response);
                Log.i("RESPONSE=",response);
            } 
            catch (Exception e) 
            {
                e.printStackTrace();
            }

        }
    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

}

 } 
```

和我的 php 文件

```
<?php
$con = mysql_connect("localhost","","");
if (!$con)
  {
    die('Could not connect: ' . mysql_error());
  }

mysql_select_db("android_test_db", $con);

$result = mysql_query("SELECT * FROM login");

while($row = mysql_fetch_array($result))
  {
  echo $row['username'] . " " . $row['password'];
  echo "<br />";
  }

print_r($row);

mysql_close($con);
?> 
```

和 php 的路径是剑兰/TestPhp/android.php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:34:26.543

一件事你的网址不正确。要在本地主机上测试它，您需要使用地址作为

```
http://10.0.2.2:80/gladiolus/TestPhp/android.php 
```

[在这里](http://developer.android.com/tools/devices/emulator.html#networkaddresses)阅读更多信息。

# jquery - CSS覆盖问题

> ID：13086098
> 
> 赞同：0
> 
> 时间：2012-10-26T11:28:54.310
> 
> 标签：jquery, css

大家好，我怎样才能让红色叠加层滑到内容后面而不是内容？[http://jsfiddle.net/MZL5q/3/](http://jsfiddle.net/MZL5q/3/)

我正在尝试：

```
.transparent_layer{
background: url('../images/overlay_repeat.png') repeat-y 0 0;
width:810px;
margin:0 auto;
padding-top: 14px;
height:0;
z-index: -99999;
background-color:red;
}​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:32:11.630

[jsFiddle](http://jsfiddle.net/TheJoeFletch/MZL5q/5/)

您需要制作另一个 div 以使用`transparent_layer`该类制作动画并制作它`position:absolute;`。

供您参考，如果这不在您的网站生产版本的页面顶部，那么您可能需要更改`div`'s 的某些定位方面。我多次阅读本教程。[CSS 定位](http://www.barelyfitz.com/screencast/html-training/css/positioning/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T11:35:19.100

请查看此[http://jsfiddle.net/MZL5q/13/](http://jsfiddle.net/MZL5q/13/)

CSS

```
.behind-layer {
    background: url('../images/overlay_repeat.png') repeat-y 0 0;
    width:810px;
    margin:0 auto;
    padding-top: 14px;
    height:0;
    z-index: 1;
    position:absolute;
    background-color:red;
}

.transparent_layer {
    width:810px;
    position:absolute;
    z-index:2;
} 
```

JS

```
$('.behind-layer').animate({
  height: '670'
}, 5000, function() {
  // Animation complete.
  alert('completed');
}); 
```

HTML

```
<div class="behind-layer"></div>
<div class="transparent_layer">
<!-- THE REST OF HTML CONTENT --> 
```

# android - getdrawingcache() 在视图 android 上为空

> ID：13086102
> 
> 赞同：2
> 
> 时间：2012-10-26T11:29:25.440
> 
> 标签：android, screenshot

我想在我的布局上截屏，下面的代码用于测量相对布局上的子计数，然后绘制布局。但我得到的 getdrawingcache() 值为 null。

```
 View v=relative layout;

                int allitemsheight   = 0;
                List<Bitmap> bmps    = new ArrayList<Bitmap>();
                for (int i = 0; i < relative.getChildCount(); i++) {

                    View childView      = relative.getChildAt(i);
                    childView.setDrawingCacheEnabled(true);
                    childView.measure(MeasureSpec.makeMeasureSpec(v.getWidth(), MeasureSpec.EXACTLY), 
                            MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED));

                    childView.layout(0, 0, childView.getMeasuredWidth(), childView.getMeasuredHeight());
                    childView.setDrawingCacheEnabled(true);
                    childView.buildDrawingCache(true);

                    bmps.add(childView.getDrawingCache());
                    allitemsheight+=childView.getMeasuredHeight();
                }

                Bitmap b    = Bitmap.createBitmap(v.getMeasuredWidth(), allitemsheight, Bitmap.Config.ARGB_8888);
                Canvas bigcanvas    = new Canvas(b);

                Paint paint = new Paint();

                bigcanvas.drawColor(c.getResources().getColor(R.color.background));

                int iHeight = 0;

                for (int i = 0; i < bmps.size(); i++) {
                    Bitmap bmp = bmps.get(i);
                    bigcanvas.drawBitmap(bmp, 0, iHeight, paint);
                    iHeight+=bmp.getHeight();

                    if (null != bmp && !bmp.isRecycled()) {

                        bmp.recycle();
                    } else {

                    }
                    bmp=null;
                } 
```

我的xml是，

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

    android:orientation="vertical" >

    <RelativeLayout
        android:id="@+id/screen"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_marginBottom="5dp"
        android:background="@drawable/login_bg" >

        <ScrollView
            android:id="@+id/scrollView1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

            <RelativeLayout
                android:layout_width="fill_parent"
                android:layout_height="fill_parent" >

                <RelativeLayout
                    android:id="@+id/above"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:layout_alignParentTop="true"
                    >

                    <TextView
                        android:id="@+id/textView1"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_alignParentTop="true"
                        android:layout_marginLeft="80dp"
                        android:layout_marginTop="28dp"
                        android:layout_toLeftOf="@+id/editText1"
                        android:text="First Name"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText1"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentTop="true"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="15dp"
                        android:layout_toLeftOf="@+id/line1"

                        android:textColor="@color/app_text_color" >
                    </EditText>
                     <View
                        android:id="@+id/line1"
                        android:layout_width="2dp"
                        android:layout_height="match_parent" 
                        android:layout_centerInParent="true"
                        android:background="@android:color/transparent" />

                    <TextView
                        android:id="@+id/textView2"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="28dp"
                        android:layout_toLeftOf="@+id/editText2"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Middle Name"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText2"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"

                        android:textColor="@color/app_text_color" >
                    </EditText>

                    <TextView
                        android:id="@+id/textView3"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView1"
                        android:layout_marginLeft="80dp"
                        android:layout_marginTop="70dp"
                        android:layout_toLeftOf="@+id/editText3"
                        android:text="Last Name"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText3"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText1"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="42dp"
                        android:layout_toLeftOf="@+id/line1"
                       >
                    </EditText>

                    <TextView
                        android:id="@+id/textView4"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView2"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="65dp"
                        android:layout_toLeftOf="@+id/spinner1"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Gender"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <Spinner
                        android:id="@+id/spinner1"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/editText2"
                        android:layout_marginRight="40dp"
                        android:layout_marginTop="42dp"
                        android:background="@drawable/spinner_bg"
                        android:ems="10"
                        android:paddingLeft="5dp"
                        android:paddingRight="5dp" />

                    <TextView
                        android:id="@+id/textView5"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView3"
                        android:layout_marginLeft="80dp"
                        android:layout_marginTop="65dp"
                        android:layout_toLeftOf="@+id/editText1"
                        android:text="Birth Date"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText4"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText3"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="44dp"
                        android:layout_toLeftOf="@+id/line1"
                       >
                    </EditText>

                    <TextView
                        android:id="@+id/textView6"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView4"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="65dp"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Age"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText5"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/spinner1"
                       >
                    </EditText>

                    <TextView
                        android:id="@+id/textView7"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView5"
                        android:layout_marginLeft="80dp"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="75dp"
                        android:layout_toLeftOf="@+id/editText1"
                        android:text="Address(St)"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText6"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText4"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="42dp"
                        android:layout_toLeftOf="@+id/line1"
                        >
                    </EditText>

                    <TextView
                        android:id="@+id/textView8"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView6"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="70dp"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Suite/apt"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText7"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/editText5"
                        android:layout_marginRight="40dp"
                        android:layout_marginTop="42dp"
                        android:background="@drawable/txt1"
                        android:ems="10"
                        android:paddingLeft="5dp"
                        android:paddingRight="5dp"
                        android:singleLine="true"
                        android:textColor="@color/app_text_color" >
                    </EditText>

                    <TextView
                        android:id="@+id/textView9"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView7"
                        android:layout_marginLeft="80dp"
                        android:layout_marginTop="65dp"
                        android:layout_toLeftOf="@+id/editText1"
                        android:text="City"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText8"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText6"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="40dp"
                        android:layout_toLeftOf="@+id/line1"
                       >
                    </EditText>

                    <TextView
                        android:id="@+id/textView10"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView8"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="70dp"
                        android:layout_toRightOf="@+id/line1"
                        android:text="State"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <Spinner
                        android:id="@+id/editText9"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/editText7"
                        android:layout_marginRight="40dp"
                        android:layout_marginTop="40dp"
                        android:background="@drawable/spinner_bg"
                        android:maxLength="2"
                        android:paddingLeft="5dp"
                        android:paddingRight="5dp"
                        android:singleLine="true"
                        android:textColor="@color/app_text_color" />

                    <TextView
                        android:id="@+id/textView11"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView9"
                        android:layout_marginLeft="80dp"
                        android:layout_marginTop="70dp"
                        android:layout_toLeftOf="@+id/editText1"
                        android:text="Zip"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText10"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText8"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="42dp"
                        android:layout_toLeftOf="@+id/line1"
                        >
                    </EditText>

                    <TextView
                        android:id="@+id/textView12"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView10"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="62dp"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Validate Address"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <TextView
                        android:id="@+id/textView13"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView11"
                        android:layout_marginLeft="80dp"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="70dp"
                        android:layout_toLeftOf="@+id/line1"
                        android:text="Email"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText11"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText10"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="45dp"
                        android:layout_toLeftOf="@+id/line1"
                        android:background="@drawable/txt1"
                      >
                    </EditText>

                    <TextView
                        android:id="@+id/textView14"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView12"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="70dp"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Home Phone"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText12"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/textView12"
                       >
                    </EditText>

                    <TextView
                        android:id="@+id/textView15"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView13"
                        android:layout_marginLeft="80dp"
                        android:layout_marginTop="52dp"
                        android:layout_toLeftOf="@+id/editText1"
                        android:text="SSN"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText14"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText12"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="45dp"
                        android:layout_toLeftOf="@+id/line1"
                        android:background="@drawable/txt1"
                        android:ems="10"
                        android:inputType="number"
                        android:maxLength="11"
                        android:paddingLeft="5dp"
                        android:paddingRight="5dp"
                        android:singleLine="true"
                        android:textColor="@color/app_text_color" >
                    </EditText>

                    <TextView
                        android:id="@+id/textView16"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView14"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="65dp"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Member ID"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText15"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/editText12"
                        android:layout_marginRight="40dp"
                       >
                    </EditText>

                    <TextView
                        android:id="@+id/textView17"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentLeft="true"
                        android:layout_below="@+id/textView15"
                        android:layout_marginLeft="80dp"
                        android:layout_marginTop="70dp"
                        android:layout_toLeftOf="@+id/editText1"
                        android:text="Group ID"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText16"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_below="@+id/editText14"
                        android:layout_marginRight="30dp"
                        android:layout_marginTop="45dp"
                        android:layout_toLeftOf="@+id/line1"
                       >
                    </EditText>

                    <TextView
                        android:id="@+id/textView18"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/textView16"
                        android:layout_marginLeft="30dp"
                        android:layout_marginTop="64dp"
                        android:layout_toRightOf="@+id/line1"
                        android:text="Employee ID"
                        android:textColor="@color/app_text_color"
                        android:textSize="25dp" />

                    <EditText
                        android:id="@+id/editText17"
                        android:layout_width="341dp"
                        android:layout_height="60dp"
                        android:layout_alignParentRight="true"
                        android:layout_below="@+id/editText15"
                        android:layout_marginRight="40dp"
                        android:layout_marginTop="42dp"
                        >
                    </EditText>

                    <RelativeLayout
                        android:id="@+id/rel"
                        android:layout_width="match_parent"
                        android:layout_height="match_parent"
                        android:layout_alignParentBottom="true"
                        android:layout_below="@+id/editText17"
                        android:layout_marginBottom="20dp"
                        android:layout_marginTop="20dp" >

                        <Button
                            android:id="@+id/button1"
                            android:layout_width="200dp"
                            android:layout_height="57dp"
                            android:layout_alignParentLeft="true"
                            android:layout_marginLeft="400dp"
                            android:background="@drawable/bt_register" />

                        <Button
                            android:id="@+id/button2"
                            android:layout_width="200dp"
                            android:layout_height="57dp"
                            android:layout_alignParentRight="true"
                            android:layout_marginRight="400dp"
                            android:background="@drawable/bt_reset" />
                        <RelativeLayout
                        android:id="@+id/rel"
                        android:layout_width="match_parent"
                        android:layout_height="20dp"
                        android:layout_alignParentBottom="true"
                        android:layout_below="@+id/button1"
                        ></RelativeLayout>
                    </RelativeLayout>
                </RelativeLayout>
            </RelativeLayout>
        </ScrollView>
    </RelativeLayout>

</LinearLayout> 
```

我得到空视图字段存在我 xml 文件

```
 <View
                    android:id="@+id/line1"
                    android:layout_width="2dp"
                    android:layout_height="match_parent" 
                    android:layout_centerInParent="true"
                    android:background="@android:color/transparent" /> 
```

请帮我解决。

# java - 如何在 Struts 的邮件消息中包含链接

> ID：13086103
> 
> 赞同：1
> 
> 时间：2012-10-26T11:29:27.683
> 
> 标签：java, email, url, servlets, struts

在使用 Struts 操作在 DB 中完成保存后，我正在发送邮件。现在我需要在邮件中包含一个链接，点击该链接将点击我的操作 URL。

我的开发网址是`wwwdev.sakthi123.road.com`.

我的行动路径会像

```
wwwdev.sakthi123.road.com/serreqsubmit.do?method=openAssignTo&statusCode='+reqStatus+'&reqId='+reqId; 
```

所以，如果我点击我需要点击这条路径的链接，从邮件中。在构建消息时，我需要在我的 Action 类方法中构建一个链接。

那么如何构建 URL 呢？

我尝试了以下方法：

```
String eol = System.getProperty("line.separator");   
message ="Please click here "+eol;
message = message + 
          httpServletRequest.getContextPath() +
          "\\serreqsubmit.do?method=openAssignTo&statusCode='+reqStatus+'&reqId='+reqId;"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:59:05.747

您可以在此处使用`<a href=`您的链接 URL。构造网址：

```
String url = "http://" + request.getServerName() + ":" + request.getServerPort()  + request.getContextPath() + "/serreqsubmit.do?method=openAssignTo&statusCode=" + reqStatus + "&reqId=" + reqId; 
```

# asp.net-mvc - 如何在asp.net MVC的backgroudworker进程中执行两个任务

> ID：13086104
> 
> 赞同：0
> 
> 时间：2012-10-26T11:29:30.360
> 
> 标签：asp.net-mvc, backgroundworker

我必须在 asp.net 的后台工作进程中并行执行两项任务。

以下是两个任务

1.  如果域中的任何服务器发生任何错误事件（一直），则发送电子邮件警报以支持人员

2.  每 4 小时一次或根据用户配置发送域中所有服务器的错误消息状态报告。

我已经通过后台工作进程实现了第一个任务（

现在我想实现第二个，每 4 小时或用户配置一次从数据库中获取数据。

请找到以下是我用于实现的源代码。

```
 protected void Application_Start()
      {
        AreaRegistration.RegisterAllAreas();
        RegisterRoutes(RouteTable.Routes);

        BackgroundWorker worker = new BackgroundWorker();
        worker.DoWork += new DoWorkEventHandler(DoWork);
        worker.WorkerReportsProgress = false;
        worker.WorkerSupportsCancellation = true;
        worker.RunWorkerCompleted +=
               new RunWorkerCompletedEventHandler(WorkerCompleted);
        worker.RunWorkerAsync(); 

    }

    private static void DoWork(object sender, DoWorkEventArgs e)
    {
        GetEmailAlertData objGetEmailAlertData = new GetEmailAlertData();
        List<Email> lstEmaildetails = objGetEmailAlertData.GetEmailAlertDetails();
        SentinelAlerter objSentinelAlerter = new SentinelAlerter();
        foreach (Email objEmail in lstEmaildetails)
        {
            try
            {
       // I have implement first task           
                objAlerter.SendAlert(objEmail);
            }
            catch (Exception ex)
            {

            }
            finally
            {

            }
        }

    } 
```

谁能建议如何在同一个后台工作进程中实现第二个任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:55:49.147

我建议您使用任务计划程序，它很简单，可以解决您的问题。

# ruby - 如何使用条件变量？

> ID：13086107
> 
> 赞同：4
> 
> 时间：2012-10-26T11:29:41.280
> 
> 标签：ruby, mutex, deadlock, race-condition, producer-consumer

Ruby 中关于条件变量的资源并不多，但大部分都是错误的。像[ruby​​-doc](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_threads.html#UF)，[教程在这里](http://phrogz.net/ProgrammingRuby/tut_threads.html#conditionvariables)或在这里[发帖](http://ssscripting.wordpress.com/2011/09/03/ruby-condition-variables/)- 他们都可能陷入僵局。

我们可以通过按给定顺序启动线程并可能`sleep`在其间放置一些线程来强制同步来解决问题。但这只是推迟了真正的问题。

我将代码重写为经典的[生产者-消费者问题](http://en.wikipedia.org/wiki/Producer-consumer_problem)：

```
require 'thread'
queue = []
mutex = Mutex.new
resource = ConditionVariable.new
threads = []

threads << Thread.new do
  5.times do |i|
    mutex.synchronize do 
      resource.wait(mutex)
      value = queue.pop
      print "consumed #{value}\n"
    end
  end
end

threads << Thread.new do
  5.times do |i|
    mutex.synchronize do
      queue << i
      print "#{i} produced\n"
      resource.signal
    end
    sleep(1) #simulate expense
  end
end

threads.each(&:join) 
```

有时你会得到这个（但并非总是如此）：

```
0 produced
1 produced
consumed 0
2 produced
consumed 1
3 produced
consumed 2
4 produced
consumed 3
producer-consumer.rb:30:in `join': deadlock detected (fatal)
        from producer-consumer.rb:30:in `each'
        from producer-consumer.rb:30:in `<main>' 
```

什么是正确的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-05-29T01:56:48.347

问题是，正如您之前评论的那样，这种方法只有在您可以保证消费者线程在我们的程序开始时首先获取互斥锁时才有效。如果不是这种情况，则会发生死锁，因为`resource.signal`您的第一个生产者线程将在消费者线程尚未等待资源时发送。结果 this first`resource.signal`基本上不会做任何事情，所以你最终会遇到这样一个场景，你调用了`resource.signal`4 次（因为第一个丢失了），而`resource.wait`被调用了 5 次。这意味着消费者将永远等待，并发生死锁。

幸运的是，我们可以通过仅在没有更多即时工作可用时才允许消费者线程开始等待来解决这个问题。

```
require 'thread'
queue = []
mutex = Mutex.new
resource = ConditionVariable.new
threads = []

threads << Thread.new do
  5.times do |i|
    mutex.synchronize do
      if queue.empty?
        resource.wait(mutex)
      end
      value = queue.pop
      print "consumed #{value}\n"
    end
  end
end

threads << Thread.new do
  5.times do |i|
    mutex.synchronize do
      queue << i
      print "#{i} produced\n"
      resource.signal
    end
    sleep(1) #simulate expense
  end
end

threads.each(&:join) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:50:50.360

这是具有多个消费者和生产者以及[MonitorMixin](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/monitor/rdoc/MonitorMixin.html)使用的更强大的解决方案，`MonitorMixin`具有特殊`ConditionVariable`的 with`wait_while()`和`wait_until()`方法

```
require 'monitor'

queue = []
queue.extend(MonitorMixin)
cond = queue.new_cond
consumers, producers = [], []

for i in 0..5
  consumers << Thread.start(i) do |i|
      print "consumer start #{i}\n"
      while (producers.any?(&:alive?) || !queue.empty?)
        queue.synchronize do
        cond.wait_while { queue.empty? }
        print "consumer #{i}: #{queue.shift}\n"
      end
      sleep(0.2) #simulate expense
    end
  end
end

for i in 0..3
  producers << Thread.start(i) do |i|
    id = (65+i).chr
    for j in 0..10 do
      queue.synchronize do
        item = "#{j} #{id}"
        queue << item
        print "producer #{id}: produced #{item}\n"
        j += 1
        cond.broadcast
      end
      sleep(0.1) #simulate expense
    end
  end
end

sleep 0.1 while producers.any?(&:alive?)
sleep 0.1 while consumers.any?(&:alive?)

print "queue size #{queue.size}\n" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:37:06.067

基于一个[论坛主题](http://www.ruby-forum.com/topic/552008)，我想出了一个可行的解决方案。它强制线程之间的交替，这并不理想。我们想要消费者和生产者的多个线程是什么？

```
queue = []
mutex = Mutex.new
threads = []

next_run = :producer

cond_consumer = ConditionVariable.new
cond_producer = ConditionVariable.new

threads << Thread.new do
  5.times do |i|
    mutex.synchronize do
      until next_run == :consumer
        cond_consumer.wait(mutex)
      end

      value = queue.pop
      print "consumed #{value}\n"
      next_run = :producer
      cond_producer.signal
    end
  end
end

threads << Thread.new do
  5.times do |i|
    mutex.synchronize do
      until next_run == :producer
          cond_producer.wait(mutex)
      end
      queue << i
      print "#{i} produced\n"
      next_run = :consumer
      cond_consumer.signal
    end
  end
end

threads.each(&:join) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T13:03:01.173

您可以简化您的问题：

```
require 'thread'
queue = Queue.new
consumer = Thread.new { queue.pop }
consumer.join 
```

因为您的主线程正在等待消费者线程退出，但消费者线程正在休眠（由于`queue.pop`），这导致：

```
producer-consumer.rb:4:in `join': deadlock detected (fatal)
    from producer-consumer.rb:4:in `<main>' 
```

所以你必须等待线程完成而不调用`join`：

```
require 'thread'

queue = Queue.new
threads = []

threads << Thread.new do
  5.times do |i|
    value = queue.pop
    puts "consumed #{value}"
  end
end

threads << Thread.new do
  5.times do |i|
    queue << i
    puts "#{i} produced"
    sleep(1) # simulate expense
  end
end

# wait for the threads to finish
sleep(1) while threads.any?(&:alive?) 
```

# bash - 检查 bash 变量是否等于 0

> ID：13086109
> 
> 赞同：217
> 
> 时间：2012-10-26T11:29:59.870
> 
> 标签：bash, equals, zero

我有一个 bash 变量深度，我想测试它是否等于 0。如果是，我想停止执行脚本。到目前为止，我有：

```
zero=0;

if [ $depth -eq $zero ]; then
    echo "false";
    exit;
fi 
```

不幸的是，这导致：

```
 [: -eq: unary operator expected 
```

（由于翻译可能有点不准确）

请问，如何修改我的脚本以使其正常工作？

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2012-10-26T11:36:09.433

看起来您的`depth`变量未设置。这意味着表达式在 bash 将变量的值代入表达式之后`[ $depth -eq $zero ]`变为。`[ -eq 0 ]`这里的问题是`-eq`运算符被错误地用作只有一个参数（零）的运算符，但它需要两个参数。这就是您收到*一元运算符*错误消息的原因。

**编辑：**正如**Doktor J**在他对这个答案的评论中提到的那样，避免检查中未设置变量问题的安全方法是将变量包含在`""`. 请参阅他的评论以获取解释。

```
if [ "$depth" -eq "0" ]; then
   echo "false";
   exit;
fi 
```

与命令一起使用的未设置变量 `[`对 bash 来说是空的。您可以使用以下测试来验证这一点，这些测试都评估为`true`空`xyz`或未设置：

*   `if [ -z ] ; then echo "true"; else echo "false"; fi`
*   `xyz=""; if [ -z "$xyz" ] ; then echo "true"; else echo "false"; fi`
*   `unset xyz; if [ -z "$xyz" ] ; then echo "true"; else echo "false"; fi`

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2012-10-26T11:57:28.860

双括号`(( ... ))`用于算术运算。

双方括号`[[ ... ]]`可用于比较和检查数字（仅支持整数），使用以下运算符：

```
· NUM1 -eq NUM2 returns true if NUM1 and NUM2 are numerically equal.

· NUM1 -ne NUM2 returns true if NUM1 and NUM2 are not numerically equal.

· NUM1 -gt NUM2 returns true if NUM1 is greater than NUM2.

· NUM1 -ge NUM2 returns true if NUM1 is greater than or equal to NUM2.

· NUM1 -lt NUM2 returns true if NUM1 is less than NUM2.

· NUM1 -le NUM2 returns true if NUM1 is less than or equal to NUM2. 
```

例如

```
if [[ $age > 21 ]] # bad, > is a string comparison operator

if [ $age > 21 ] # bad, > is a redirection operator

if [[ $age -gt 21 ]] # okay, but fails if $age is not numeric

if (( $age > 21 )) # best, $ on age is optional 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-10-26T11:37:17.983

尝试：

```
zero=0;

if [[ $depth -eq $zero ]]; then
  echo "false";
  exit;
fi 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2016-09-23T23:14:00.540

您也可以使用这种格式并使用比较运算符，例如 '==' '<='

```
 if (( $total == 0 )); then
      echo "No results for ${1}"
      return
  fi 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-06-10T23:10:54.333

具体来说：`((depth))`。例如，以下打印`1`.

```
declare -i x=0
((x)) && echo $x

x=1
((x)) && echo $x 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-07-03T09:53:50.827

你可以试试这个：

```
: ${depth?"Error Message"} ## when your depth variable is not even declared or is unset. 
```

注意：这里只是`?`在`depth`.

或者

```
: ${depth:?"Error Message"} ## when your depth variable is declared but is null like: "depth=". 
```

注意：这是`:?`在`depth`.

`depth`在这里，如果找到变量`null`，它将打印错误消息然后退出。

# jquery-mobile - jQuery Mobile Router 不路由第一个页面加载

> ID：13086110
> 
> 赞同：0
> 
> 时间：2012-10-26T11:30:04.893
> 
> 标签：jquery-mobile, router

我在多页面设置中使用 jQuery Mobile Router。

出于某种原因，没有按应有的方式处理第一页加载。我有一个 jQuery Mobile 用作默认页面的第一页，但即使用户包含应该触发另一个路由的哈希，它也不会被路由器捕获。

我能够解决这个问题的唯一方法是使用这个丑陋的黑客：

```
$(document).one('pagebeforechange', function(event, data) {
    data.toPage = window.location.hash
}); 
```

我显然做错了什么，但在哪里？

包含顺序是：jQuery Mobile Router、jQuery Mobile，然后是我的自定义路由器设置。

这没有帮助，所以我尝试按照[问题 12](https://github.com/azicchetti/jquerymobile-router/issues/12#issuecomment-8891981)中关于 jQuery Mobile Routers 问题跟踪器`autoInitialize`的`false`描述进行设置。那也没有帮助。

有什么建议么？

# image-processing - 将描述符与描述符数据库匹配

> ID：13086112
> 
> 赞同：3
> 
> 时间：2012-10-26T11:30:12.640
> 
> 标签：image-processing, opencv, neural-network, database-optimization

我正在尝试找到一种快速匹配数据库中描述符的方法。我的程序按以下方式工作：

1) 使用图像描述符填充数据库（使用适当的特征检测算法）

2）加载图像

3) 提取该图像的描述符并将其与数据库中的所有描述符进行比较，以便找到合适的匹配项。

可以想象，计算 32 个描述符的数百万次比较是非常繁重的。我使用了一个散列函数，但它只适用于两个完全相同的描述符，因此只匹配两个完全相同的图像。

你建议我用什么来加快搜索速度？

干杯

**编辑：**

我决定从使用神经网络解决方案开始。对于任何想要开始研究该主题的人来说，这是一个 [非常好的链接。](https://stackoverflow.com/questions/8742501/how-to-begin-neural-network-programming)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T16:10:02.883

您要完成的工作本质上称为机器学习/分类。考虑到数据库的大小，直接比较确实没有希望。

以防万一您不了解这些术语。您拥有的数据库称为*learning-dataset*。您需要使用机器学习算法，如 SVM（支持向量机）、K-NN（K-最近邻）、神经网络等来学习*模型*。该模型后来用于预测新实例的结果，即。您要与数据库进行比较的向量。

我强烈建议使用 SVM，因为它是机器学习文献中最先进的分类器。它有一个实现，称为“SVM light”。 [http://svmlight.joachims.org/](http://svmlight.joachims.org/)。也可以使用 SVM-light 进行排名。请也看一下。

您也可以尝试使用神经网络。我在 matlab 中使用神经网络工具箱（nprtools），它非常简洁。

# c# - 事件知道用户控件的处置？

> ID：13086113
> 
> 赞同：3
> 
> 时间：2012-10-26T11:30:14.670
> 
> 标签：c#, wpf

如果带有用户控件的窗口正在关闭，那么我应该在用户控件中调用一个方法，即只有在释放用户控件时才调用。我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:41:56.860

如果您想知道垃圾收集器何时收集，请`UserControl`使用：

```
 ~UserControl1()
    {
        //...
    } 
```

如果您想知道何时`UserControl`从其父级卸载，`Unloaded`请在 userControl 上使用事件

注意：与 a 不同`Window`， a`UserControl`不能关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:48:14.757

由于 contols 没有 Closing/Closed 事件，它不像重写 Dispose 那样简单。在某些情况下可能不会调用 Dispose。

您可能会覆盖控件的 WndProc 并捕获 WM_CLOSE 事件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-08-27T12:44:39.257

供其他人将来参考..

我处置了我的主窗口加载的用户控件，如下所示：

```
<UserControl x:Class="MyApp.Class" ... Unloaded="UserControl_Unloaded"></UserControl>

private void UserControl_Unloaded(object sender, RoutedEventArgs e)
{
    ((MyVM)this.DataContext).Dispose();
} 
```

`Unloaded`是任何视图上可用的事件。

# android - 使用 PID 查找应用程序标签的 Linux 命令。

> ID：13086119
> 
> 赞同：-1
> 
> 时间：2012-10-26T11:31:19.527
> 
> 标签：android, linux

我有所有的PID。我想从这个 pid 中找到确切的应用程序名称。让，一个 PID = 3355.its 包 = com.xxxx.yyyyy.actual 应用程序名称 = 邮件我不需要 com.xxxx.yyyyy，我需要使用 PID 的邮件。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:10:08.987

您可以从 procfs 获取过程详细信息，包括环境、命令行...

例如：

```
cat /proc/3355/cmdline 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:35:39.733

你可以这样做 -

```
 ps aux | grep 3355 
```

# mongodb - Mongo db 常规数据种子

> ID：13086121
> 
> 赞同：2
> 
> 时间：2012-10-26T11:31:33.953
> 
> 标签：mongodb, data-migration

我有 2 个 mongo 数据库。1\. 分期，2\. 生产。在暂存阶段，我们有大约 5 个种子数据集合，我们在其上运行一些批处理作业并填充更多的数据，比如 3 个集合。8个集合成为具有用户信息+该种子数据的生产的种子数据。

是否有更好的模式来管理数据推送到登台以及从登台到生产。现在我们正在尝试 mongoexport 所有的集合和 tar.gz 并将其存档在每个阶段的网络驱动器上并 mongoimport 。

导出、导入和存档非常痛苦并且需要很长时间，gzip 压缩大约为 1.5 GB。有什么好的模式可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:49:20.277

'mongoimport' 和 'mongoexport' 旨在与来自外部系统的数据一起使用——所有数据都被转换为纯 json，然后再转换回 bson。

如果您使用“mongodump”和“mongorestore”，您应该会看到更好的性能，因为它们都直接处理 bson，存储更紧凑，不需要两次翻译（一次到 json，一次从 json）。

# iphone - 在 iPhone 中绘制直方图需要更高的准确性

> ID：13086126
> 
> 赞同：8
> 
> 时间：2012-10-26T11:31:54.883
> 
> 标签：iphone, ios, uiimage, histogram

我正在一个应用程序中工作，我需要在其中绘制任何输入图像的直方图。我可以成功绘制直方图，但它不像 Mac OS 中的 PREVIEW 那样清晰。

由于代码太大，我已经上传到 GitHub[点击这里下载](https://github.com/HarshitDaftary/Generate-Histogram-Graph-For-an-Image-in-iPhone)

读入 RGB 值

```
 -(void)readImage:(UIImage*)image
{
    CGImageRef imageRef = [image CGImage];
    NSUInteger width = CGImageGetWidth(imageRef);
    NSUInteger height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    unsigned char *rawData = (unsigned char*) calloc(height * width * 4, sizeof(unsigned char));
    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height, bitsPerComponent, bytesPerRow, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);
    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);

    for (int yy=0;yy<height; yy++)
    {
        for (int xx=0; xx<width; xx++)
        {
            // Now your rawData contains the image data in the RGBA8888 pixel format.
            int byteIndex = (bytesPerRow * yy) + xx * bytesPerPixel;
            for (int ii = 0 ; ii < 1 ; ++ii)
            {
                CGFloat red   = (rawData[byteIndex]     * 1.0) ;
                CGFloat green = (rawData[byteIndex + 1] * 1.0) ;
                CGFloat blue  = (rawData[byteIndex + 2] * 1.0) ;
                // CGFloat alpha = (rawData[byteIndex + 3] * 1.0) / 255.0;
                byteIndex += 4;

                // TYPE CASTING ABOVE FLOAT VALUES TO THAT THEY CAN BE MATCHED WITH ARRAY'S INDEX.

                int redValue = (int)red;
                int greenValue = (int)green;
                int blueValue = (int)blue;

                // THESE COUNTERS COUNT " TOTAL NUMBER OF PIXELS " FOR THAT  Red , Green or Blue Value IN ENTIRE IMAGE.

                fltR[redValue]++;
                fltG[greenValue]++;
                fltB[blueValue]++;                
            }
        }
    }
    [self makeArrays];
    free(rawData);
} 
```

我将值存储在 c 数组变量 fltR、fltG、fltB 中。

我有一个类 ClsDrawPoint 它有成员

```
@property CGFloat x;
@property CGFloat y; 
```

然后准备一个包含 ClsDrawPoint 对象的数组，其中 fltR[] 的索引为 X 值，该索引的值为 Y 值。

准备好数组并绘制图形

```
-(void)makeArrays 
```

方法

你可能会看到结果

![在此处输入图像描述](../Images/c6ff06627d7e17a1c7dfa64e3605b57e.png)

**目前，它不如在 mac 中的 PREVIEW 中为同一图像准确。您可以在 Mac 中的 PREVIEW 应用程序中打开图像，然后在 Tools>AdjustColor 中，您将能够看到该图像的直方图。我想如果我的图表是准确的，它会更清晰。请检查我的代码并建议我，如果您发现它更准确。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T14:40:12.390

我从 Github 中提取了您的示例，发现您的`drawRect:`方法`ClsDraw`是绘制一个像素宽的线条。笔划以线条为中心，宽度为 1，笔划被分成半像素，从而引入了抗锯齿。

我将您的水平偏移量移动了半像素，渲染看起来很清晰。我没有弄乱垂直偏移，但要使它们变得清晰，您需要将它们四舍五入，然后将它们也移动到半像素偏移。我只做了以下更改：

```
#define OFFSET_X 0.5

- (void)drawRect:(CGRect)rect
{   
  CGContextRef ctx = UIGraphicsGetCurrentContext();
  if ([arrPoints count] > 0)
  {
    CGContextSetLineWidth(ctx, 1);
    CGContextSetStrokeColorWithColor(ctx, graphColor.CGColor);
    CGContextSetAlpha(ctx, 0.8);
    ClsDrawPoint *objPoint;
    CGContextBeginPath(ctx);

    for (int i = 0 ; i < [arrPoints count] ; i++)
    {
      objPoint = [arrPoints objectAtIndex:i];
      CGPoint adjustedPoint = CGPointMake(objPoint.x+OFFSET_X, objPoint.y);
      CGContextMoveToPoint(ctx, adjustedPoint.x, 0);
      CGContextSetLineCap(ctx, kCGLineCapRound);
      CGContextSetLineJoin(ctx, kCGLineJoinRound);
      CGContextAddLineToPoint(ctx, adjustedPoint.x, adjustedPoint.y);
      CGContextMoveToPoint(ctx, adjustedPoint.x, adjustedPoint.y);
      CGContextStrokePath(ctx);
    }
  }
} 
```

注意新`OFFSET_X`的和引入的`adjustedPoint`。

您也可以考虑使用`CGPoint`填充到`NSValue`实例中的点而不是自定义类`ClsDrawPoint`，除非您计划添加一些额外的行为或属性。[此处](https://stackoverflow.com/questions/899600/how-can-i-add-cgpoint-objects-to-an-nsarray-the-easy-way)提供更多详细信息。

# java - 很长的字符串作为 Web 服务的响应

> ID：13086131
> 
> 赞同：2
> 
> 时间：2012-10-26T11:32:05.707
> 
> 标签：java, android, string

我得到一个非常长的字符串作为我在使用中收集它的 Web 服务的响应，`StringBuilder`但我无法获得我也使用`StringBuffer`但没有成功的全部值。

这是我正在使用的代码：

```
private static String read(InputStream in ) throws IOException {
    //StringBuilder sb = new StringBuilder(1000);
    StringBuffer sb = new StringBuffer();
    String s = "";
    BufferedReader r = new BufferedReader(new InputStreamReader( in ), 1000);
    for (String line = r.readLine(); line != null; line = r.readLine()) {
        sb.append(line);
        s += line;
    } in .close();

    System.out.println("Response from Input Stream Reader >>>" + sb.toString());
    System.out.println("Response from Input S >>>>>>>>>>>>" + s);
    return sb.toString();
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:34:20.750

可能不会完全打印到控制台，`String`但它确实存在。将其保存到文件以便查看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T11:40:27.560

您还可以将字符串拆分为字符串数组以查看所有字符串

```
String delimiter = "put a delimiter here e.g.: \n";
String[] datas=sb.toString().split(delimiter);

for(String string datas){
System.out.println("Response from Input S >>>>>>>>>>>>" + string);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T12:30:32.613

我不认为你的输入对于字符串来说太大了，但只是没有显示在控制台上，因为它不接受太长的行。无论如何，这是一个非常大的字符输入的解决方案：

```
private static String[] readHugeStream(InputStream in) throws IOException {
    LinkedList<String> dataList = new LinkedList<>();
    boolean finished = false;
    //
    BufferedReader r = new BufferedReader(new InputStreamReader(in), 0xFFFFFF);
    String line = r.readLine();
    while (!finished) {
        int lengthRead = 0;
        StringBuilder sb = new StringBuilder();
        while (!finished) {
            line = r.readLine();
            if (line == null) {
                finished = true;
            } else {
                lengthRead += line.length();
                if (lengthRead == Integer.MAX_VALUE) {
                    break;
                }
                sb.append(line);
            }
        }
        if (sb.length() != 0) {
            dataList.add(sb.toString());
        }
    }
    in.close();
    String[] data = dataList.toArray(new String[]{});
    ///
    return data;
}

public static void main(String[] args) {
    try {
        String[] data = readHugeStream(new FileInputStream("<big file>"));
    } catch (IOException ex) {
        Logger.getLogger(StackoverflowStringLong.class.getName()).log(Level.SEVERE, null, ex);
    } catch (OutOfMemoryError ex) {
        System.out.println("out of memory...");
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T12:53:25.330

System.out.println() 不会打印所有字符，它只能在控制台中显示有限数量的字符。您可以在 SD 卡中创建一个文件并将字符串复制为文本文档以检查您的确切响应。

```
 try
                {
                      File root = new File(Environment.getExternalStorageDirectory(), "Responsefromserver");
                      if (!root.exists()) 
                        {
                          root.mkdirs();
                      }
                      File gpxfile = new File(root, "response.txt");
                      FileWriter writer = new FileWriter(gpxfile);
                      writer.append(totalResponse);
                      writer.flush();
                      writer.close();
                  }
                  catch(IOException e)
                  {
                             System.out.println("Error:::::::::::::"+e.getMessage());
                      throw e;

                  } 
```

# html - Firefox 中的闪烁动画

> ID：13086135
> 
> 赞同：2
> 
> 时间：2012-10-26T11:32:28.660
> 
> 标签：html, firefox, css

我正在做一个仅使用 CSS 的滑出式登录框。我面临的问题是，在 FireFox（我使用的是 Firefox 16.0）中，滑出动画会闪烁。它在 chrome 和 Safari 中运行良好（IE 中没有动画但不闪烁，登录框显示正常）。这是HTML：

```
<div id="slideout">
        <div id="slideout_inner">
             <form id="loginForm" action="#" method="POST">
                <table cellspacing="0">
                    <tbody>
                        <tr>
                            <td><label for="lUsername">Username</label></td>
                            <td><label for="lPassword">Password</label></td>
                        </tr>
                        <tr>
                            <td><input type="text" name="username" id="lUsername" class="required" /></td>
                            <td><input type="password" name="password" id="lPassword" class="required" /></td>
                            <td><input type="submit" value="Login" /></td>
                        </tr>
                        <tr>
                            <td><span class="error"></span></td>
                            <td><span class="error"></span></td>
                        </tr>

                    </tbody>
                </table>
            </form>
        </div>
        <label>Login</label> 
```

这是CSS

```
#slideout {
  position: fixed;
  top: 0px;
  left: 0;
  -webkit-transition-duration: 0.3s;
  -moz-transition-duration: 0.3s;
  -o-transition-duration: 0.3s;
  transition-duration: 0.3s;
}
#slideout_inner {
  position: fixed;
  top: -250px;
  left: 0px;
  -webkit-transition-duration: 0.3s;
  -moz-transition-duration: 0.3s;
  -o-transition-duration: 0.3s;
  transition-duration: 0.3s;
}
#slideout:hover{
  top: 250px;
}
#slideout:hover #slideout_inner{
  top: 0;
} 
```

这是问题的[JSFiddle](http://jsfiddle.net/NYCtt/)如何修复 Firefox 中的闪烁问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:46:04.737

这个[JSFiddle](http://jsfiddle.net/NYCtt/2/)或许能帮到你。

像这样写：

```
#slideout {
  position: fixed;
  top: 0;
  left: 0;
}
#slideout_inner{
    height:0;
    -webkit-transition-duration: 0.3s;
  -moz-transition-duration: 0.3s;
  -o-transition-duration: 0.3s;
  transition-duration: 0.3s;
  overflow:hidden;
}
#slideout:hover #slideout_inner{
  height:200px;
  border:1px solid red;
} 
```

**或者**

这个[JSFiddle](http://jsfiddle.net/NYCtt/3/)。

# android - 如何动态读取代码中定义的我的主题的值？

> ID：13086138
> 
> 赞同：0
> 
> 时间：2012-10-26T11:32:49.330
> 
> 标签：android

布局：</p>

```
<TextView
        android:id="@+id/textView1" 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:layout_centerHorizontal="true" 
        android:layout_centerVertical="true" 
        android:text="A" 
        android:textSize="?normal_font_size" 
         /> 
```

attrs.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <attr name="normal_font_size" format="dimension" />
</resources> 
```

主题.xml：

```
 <style name="MainTheme" parent="@android :style/Theme.Black.NoTitleBar">
        <item name="normal_font_size">15px</item>
    </style> 
```

**如何动态读取代码中定义的我的主题的值？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:05:51.333

在您的`attrs.xml`中，创建一组您想阅读的值，您甚至可以添加自定义值

```
<declare-styleable name="MyAttrs">
        <attr name="android:textSize"/>
</declare-styleable> 
```

在您的代码中，您将能够通过[`TypedArray`](http://developer.android.com/reference/android/content/res/TypedArray.html)

```
TypedArray a = context.obtainStyledAttributes(context.getTheme(), R.styleable.MyAttrs);
int textSize = a.getInteger(R.styleable.MyAttrs_android_textSize, DEFAULT_TEXT_SIZE);
a.recycle(); 
```

# java - 在单独的类上执行 runOnUiThread

> ID：13086144
> 
> 赞同：29
> 
> 时间：2012-10-26T11:33:11.960
> 
> 标签：java, android

> **可能重复：**
> [Android 如何在其他类中运行 OnUiThread？](https://stackoverflow.com/questions/7860384/android-how-to-runonuithread-in-other-class)

My Asyn Classes 是一个单独的类文件。

```
public class AdamTask extends AsyncTask<String, Void, String>{
         public void showToast(final String toast)
        {
            runOnUiThread(new Runnable() {
                public void run()
                {
                    Toast.makeText(context, toast, Toast.LENGTH_SHORT).show();
                }
            });
        }
} 
```

我将如何在我的 AsyncTask 类中执行此方法？我收到错误方法`runOnUiThread(new Runnable(){}) is undefined for the type AdamTask`

新的 AdamTask(Eve.this, `How to pass the eve activity here`).execute();

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-10-26T11:52:18.503

只需将上下文类型转换为 Activity 类

```
((Activity)context).runOnUiThread(new Runnable()
    {
        public void run()
        { 
             Toast.makeText(context, toast, Toast.LENGTH_SHORT).show();
        }
    }); 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-10-26T11:40:53.937

您需要`Activity's`参考（让我们命名`activity`）并将其传递给您的`AsyncTask`班级。然后你可以`runOnUiThread`这样调用：

```
activity.runOnUiThread 
```

[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)是类中定义的方法`Activity`。

只需向您的 AsyncTask 添加一个构造函数。您的 AsyncTask 将如下所示：

```
public class AdamTask extends AsyncTask<String, Void, String> {

private Activity activity; //activity is defined as a global variable in your AsyncTask

public AdamTask(Activity activity) {

    this.activity = activity;
}

public void showToast(final String toast)
    {
        activity.runOnUiThread(new Runnable() {
            public void run()
            {
                Toast.makeText(activity, toast, Toast.LENGTH_SHORT).show();
            }
        });
    }

...

} 
```

然后调用`AsyncTask`你需要这样的东西：

```
AdamTask adamTask = new AdamTask(Eve.this);
adamTask.excecute(yourParams); 
```

**更新**正如 Sam 在评论中提到的，当配置更改发生时`AsyncTasks`可能会导致`context`泄漏（一个示例是屏幕旋转并`Activity`重新创建时）。解决这个问题的一种方法是[无头`fragment`技术](http://luboganev.github.io/blog/headless-fragments/)。

另一种更有效的方法是使用事件总线。有关更多信息，请参见[此处](http://simonvt.net/2014/04/17/asynctask-is-bad-and-you-should-feel-bad/)（Sam 在评论中提供的链接）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-26T11:35:05.943

您需要您的 Activity 对象来执行此操作。通过构造函数传递 Activity 的 this 引用并在 AsyncTask 中使用它。

```
public class AdamTask extends AsyncTask<String, Void, String>{
         public void showToast(final String toast)
        {
            activityObj.runOnUiThread(new Runnable() {
                public void run()
                {
                    Toast.makeText(context, toast, Toast.LENGTH_SHORT).show();
                }
            });
        }
} 
```

由于 runOnUiThread 是 Activity 类中的公共方法，因此您不能在其他自定义类或除 Activity 本身之外扩展的类中使用它。

看这里，[runonUi。](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)

如果您不清楚，请查看此[答案](https://stackoverflow.com/a/7887189/603744)以了解如何通过构造函数发送活动对象

# android - 是否可以将 layout_weight 保存在 xml 中？

> ID：13086149
> 
> 赞同：6
> 
> 时间：2012-10-26T11:33:45.310
> 
> 标签：android, xml, android-layout

我需要根据屏幕的物理尺寸更改布局中 3 个视图的 layout_weight。视图的权重为 0-1-0，但是当在 xlarge 屏幕中使用布局时，这必须更改为 0.2-0.6-0.2。

我尝试将 layout_weight 保存在 dimensions.xml 的不同副本中（一个在 values/dimensions 中，另一个在 values-xlarge/dimensions 中），但看起来我无法在不设置 dp/px 或 w/e 的情况下给出维度（不能保存像 1 或 0.2 这样的“原始”数字）。

是否可以通过 xml 以某种方式实现，或者我*必须*以编程方式工作才能实现这一目标？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T11:37:17.653

尝试一个整数资源文件。它与维度非常相似。

[http://developer.android.com/guide/topics/resources/more-resources.html](http://developer.android.com/guide/topics/resources/more-resources.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T11:36:53.750

在相应的文件夹中创建一个文件，`values`即`values, values-large, values-xlarge, ...`. 添加内容类似于此示例的资源文件：

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">
    <item type="integer" name="layout_weight_xy">7</item>
</resources> 
```

然后打电话

```
android:layout_weight="@integer/layout_weight_xy" 
```

在您的布局文件中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T11:36:54.283

您可以在文件夹中创建特殊布局`layout-xlarge`并在那里提供不同的权重

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-23T08:52:05.740

首先，定义您的资源，例如 integer.xml 并确保您设置了正确的**类型**和**格式**。如果你想使用它，`layout_weight`你可以设置`type="integer" format="float"`.

```
<item name="my_weight_value" type="integer" format="float">1.2</item> 
```

然后我们可以在布局中使用它

```
 <LinearLayout
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="@integer/my_weight_value"
        android:orientation="vertical">
 </LinearLayout> 
```

# ios5 - 如何获得具有动作 CCRotate 的精灵的位置？

> ID：13086151
> 
> 赞同：1
> 
> 时间：2012-10-26T11:34:03.777
> 
> 标签：ios5, cocos2d-iphone, ccrotateby

我有一个节点，我已经固定了该节点的位置。然后我添加了一个精灵作为该节点的子节点（我之前添加了）。之后，我尝试将节点旋转某个角度。

结果精灵也在旋转，它的中心点是节点的位置。现在我的问题是，我怎样才能得到精灵的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:33:06.433

精灵位置相同 - “节点中心”。

我不明白您要评估的确切位置。我希望以下方法对您有所帮助：

每个 CCNode（以及所有子类 CCSprite、CCLayer 等）都有跟随帮助器，这些帮助器对于节点之间的评估坐标非常有用：

```
- (CGPoint)convertToNodeSpace:(CGPoint)worldPoint;
- (CGPoint)convertToWorldSpace:(CGPoint)nodePoint;
- (CGPoint)convertToNodeSpaceAR:(CGPoint)worldPoint;
- (CGPoint)convertToWorldSpaceAR:(CGPoint)nodePoint; 
```

# c# - 将日期绑定到gridview内的下拉列表

> ID：13086153
> 
> 赞同：1
> 
> 时间：2012-10-26T11:34:18.353
> 
> 标签：c#, sql, sql-server, stored-procedures

我必须在网格视图中绑定标签和下拉菜单，DDL 包含日期时间格式的运行日期，我必须在 DDL 中显示与名称关联的所有不同日期。

```
 protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        DataTable dt = new DataTable();
        dt = Common.rundate();
        DropDownList ddl = e.Row.FindControl("DropDownList1") as DropDownList;

        ddl.DataTextField = "RunDate";
        ddl.DataValueField = "TempID";
        ddl.DataSource = dt;
        ddl.DataBind();
    }

}

Store Proc::  

    alter PROC display_rundates
@rundate datetime,@tempid int
AS
  SELECT RunDate,TempID
    FROM History_Table

ORDER BY Rundate DESC
GO 
```

但我必须显示与每个名称相关的特定运行日期。任何帮助都可以理解。

```
Name   rundate
Test   datetime(DDL)
Test1   datetime 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:06:43.857

当你绑定gridview时，你还必须将主键绑定到一些模板字段控件，如果你还没有写，那么添加隐藏字段并绑定到它如下

```
 <ItemTemplate>
            <asp:HiddenField runat="server" ID="hiddenfield1" Value='<%# Eval("TempID") %>' />
            <asp:DropDownList runat="server" ID="ddl" />
 </ItemTemplate> 
```

在`RowDataBound`Event 中，您可以找到 PrimaryKey，然后使用它来设置 Dropdown Selected Value，如下所示...

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        DataTable dt = new DataTable();
        dt = Common.rundate();
        DropDownList ddl = e.Row.FindControl("DropDownList1") as DropDownList;

        ddl.DataTextField = "RunDate";
        ddl.DataValueField = "TempID";
        ddl.DataSource = dt;
        ddl.DataBind();

        HiddenField hdn=(HiddenField)row.Cells[cellindex].FindControl("hiddenField1");
        ddl.SelectedValue=hdn.Value;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:49:04.253

尝试这个

```
ddl.SelectedValue = ((System.Data.DataRowView)(e.Row.DataItem)).Row["TempId"].ToString(); 
```

基本上只是从数据项中获取“TempId”`GridView1_RowDataBound`并将该“TempId”分配给下拉的 Selected 值。

像这样的东西

```
void bindGrid()
{
   grid.DataSource = getRunDates();
   grid.DataBind();
}
DataTable getRunDates()
{
   DataTable dt = new DataTable();
   dt.Columns.Add("TempID");
   dt.Columns.Add("RunDate");
   dt.Rows.Add(new object[] { 1, "20-May-2012" });
   dt.Rows.Add(new object[] { 2, "21-May-2012" });
   dt.Rows.Add(new object[] { 3, "10-May-2012" });
   dt.Rows.Add(new object[] { 4, "20-May-2012" });
   return dt;
}
protected void grid_RowDataBound(object sender, GridViewRowEventArgs e)
{
   if (e.Row.RowType == DataControlRowType.DataRow)
   {
      DataTable dt = new DataTable();
      dt = getRunDates();
      DropDownList ddl = e.Row.FindControl("DropDownList1") as DropDownList;

      ddl.DataTextField = "RunDate";
      ddl.DataValueField = "TempID";
      ddl.DataSource = dt;
      ddl.DataBind();

      ddl.SelectedValue = ((System.Data.DataRowView)(e.Row.DataItem)).Row["TempId"].ToString();
    }
} 
```

**设计**

```
<asp:GridView runat="server" ID="grid" OnRowDataBound="grid_RowDataBound" AutoGenerateColumns="false">
   <Columns>
      <asp:TemplateField HeaderText="RunDate">
         <ItemTemplate>
             <asp:DropDownList runat="server" ID="DropDownList1" />
         </ItemTemplate>
       </asp:TemplateField>
      <asp:BoundField HeaderText="TempID" DataField="TempID" />
   </Columns>
</asp:GridView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T13:10:02.430

我仍然不相信我的解决方案，但我认为这就是我要做的方式......

第一次加载数据时，我会用每个名称的运行日期填充字典：

```
 private Dictionary<string, List<DateTime>> runDates = new Dictionary<string, List<DateTime>>();

    private void LoadData()
    {
        DataTable table = new DataTable();
        table.Columns.Add("TempName", typeof(string));

        using (var connection = new SqlConnection("YourConnectionString"))
        using (var command = new SqlCommand("SELECT DISTINCT TempName, RunDate FROM History_Table;", connection))
        {
            connection.Open();
            using (var reader = command.ExecuteReader())
            {
                while (reader.Read())
                {
                    string tempName = reader.GetString(0);
                    if (!runDates.ContainsKey(tempName))
                    {
                        DataRow row = table.NewRow();
                        row[0] = tempName;
                        table.Rows.Add(row);
                        runDates.Add(tempName, new List<DateTime>());
                    }
                    runDates[tempName].Add(reader.GetDateTime(1));
                }
            }

            GridView1.DataSource = table;
            GridView1.DataBind();
        }
    } 
```

在读取每一行时，它会检查名称是否已经存在，如果不存在，则将其添加到将用于绑定 GridView 和字典的表中。然后在绑定事件中使用名称标签从字典中查找日期列表：

```
 protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            //Find the label with the temp name and assign it
            string tempName = (e.Row.FindControl("Label1") as Label).Value;

            DropDownList ddl = e.Row.FindControl("DropDownList1") as DropDownList;

            ddl.DataTextField = "RunDate";
            ddl.DataValueField = "TempID";
            ddl.DataSource = runDates[tempName];
            ddl.DataBind();
        }

    } 
```

我玩弄了各种其他想法，一个是将日期列表作为具有唯一名称列表的 xml 字段返回（很像您之前的问题），将其存储在隐藏字段中并对行数据绑定事件进行反序列化，另一种解决方案是在数据集中生成2个表并定义关系，但是这与我提出的方法原理上非常相似，我想我更喜欢这个......

# iphone - Apple Mach-O 链接器错误 (IAP)

> ID：13086159
> 
> 赞同：3
> 
> 时间：2012-10-26T11:34:50.660
> 
> 标签：iphone, objective-c, ios, in-app-purchase

我正在为应用内购买而苦苦挣扎。每当我导入 StoreKit 时，都会收到此错误。
我已经在这几天没有运气了..有人帮忙吗？

头文件：

```
#import <StoreKit/StoreKit.h>    

#define kInAppPurchaseManagerProductsFetchedNotification          @"kInAppPurchaseManagerProductsFetchedNotification"

@interface InAppPurchaseManager : NSObject <SKProductsRequestDelegate>
{
    SKProduct *proUpgradeProduct;
    SKProductsRequest *productsRequest;
}
@end 
```

实施文件：

```
#import "IAPManager.h"

@implementation InAppPurchaseManager 

- (void)requestProUpgradeProductData
{
    NSSet *productIdentifiers = [NSSet 
       setWithObject:@"com.runmonster.runmonsterfree.upgradetopro" ];
    productsRequest = [[SKProductsRequest alloc] initWithProductIdentifiers:productIdentifiers];
    productsRequest.delegate = self;
    [productsRequest start];
}

#pragma mark -
#pragma mark SKProductsRequestDelegate methods

- (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response
{
    NSArray *products = response.products;
    proUpgradeProduct = [products count] == 1 ? [[products firstObject] retain] : nil;
    if (proUpgradeProduct)
    {
        NSLog(@"Product title: %@" , proUpgradeProduct.localizedTitle);
        NSLog(@"Product description: %@" , proUpgradeProduct.localizedDescription);
        NSLog(@"Product price: %@" , proUpgradeProduct.price);
        NSLog(@"Product id: %@" , proUpgradeProduct.productIdentifier);
    }

    for (NSString *invalidProductId in response.invalidProductIdentifiers)
    {
        NSLog(@"Invalid product id: %@" , invalidProductId);
    }

    [productsRequest release];

    [[NSNotificationCenter defaultCenter] postNotificationName:kInAppPurchaseManagerProductsFetchedNotification object:self userInfo:nil];
}
@end 
```

杀死我的错误：

```
 Undefined symbols for architecture armv7:
      "_OBJC_CLASS_$_SKProductsRequest", referenced from:
          objc-class-ref in IAPManager.o
    ld: symbol(s) not found for architecture armv7
    collect2: ld returned 1 exit status

"_OBJC_CLASS_$_SKProductsRequest", referenced from:    
Objc-class-ref in IAPManager.o    
Symbol(s) not found for architecture armv7    
Collect2: Id returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-26T11:39:57.810

因为您添加了“标题”，而不是二进制文件。将 StoreKitFramework 放入带有库的 buildPhase->Link 二进制文件中。神奇的是，这会起作用；）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-26T11:41:15.590

您忘记将**StoreKit.framework**添加到您链接的库中。

[此链接](https://stackoverflow.com/questions/3352664/how-to-add-existing-frameworks-in-xcode-4/3377682#3377682)显示如何添加它。

# php - 你需要在 MySQL 中设置外键吗？

> ID：13086160
> 
> 赞同：6
> 
> 时间：2012-10-26T11:34:55.683
> 
> 标签：php, mysql, sql, foreign-keys

假设您在 MySQL 数据库中有两个如下表：

表人：

```
 primary key: PERSON_ID,
  NAME,
  SURNAME, etc. 
```

表地址：

```
 primary key: ADDRESS_ID,
  foreign key: PERSON_ID,
  addressLine1, etc. 
```

如果您管理行的创建（在两个表中）和通过 PHP 检索数据，您还需要在数据库中创建物理关系吗？如果是，为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T11:39:10.297

是的，一个具体的原因是如果您想连接表，可以更快地检索行。创建外键约束会自动在列上创建索引。

所以表地址的模式应该是这样的，（*假设`People`表的主键是`PERSON_ID`*）

```
CREATE TABLE Address
(
    Address_ID INT,
    Person_ID INT,
    ......,
    CONSTRAINT tb_pk PRIMARY KEY (Address_ID),
    CONTRRAINT tb_fk FOREIGN KEY (Person_ID) 
        REFERENCES People(Person_ID)
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T12:39:27.473

严格来说：您*不需要*使用FK。仔细的索引和编写良好的查询似乎就足够了。然而，FK 和 FK 约束在保护数据一致性方面非常有用（例如，避免孤立数据）

假设您编写了您的应用程序，一切都经过了测试，它就像一个魅力。太好了，但谁能说每次必须改变某些事情时你都会在附近呢？您是要自己维护代码，还是其他人最终可能会进行快速修复/调整或实现​​其他功能？实际上，你永远不会是唯一一个编写和维护代码的人，即使你是唯一一个维护代码的人，随着时间的推移，你几乎肯定会遇到错误......
外键通知两者您的同事和您来自 tbl1 的数据取决于来自 tbl2 的数据，反之亦然。就像注释一样，这使应用程序更易于维护。

错误更容易检测：创建一个从 tbl1 删除记录的方法，但忘记更新 tbl2 以反映对第一个 tbl 所做的更改。发生这种情况时，数据已损坏，但导致此问题的查询不会导致错误：SQL 在语法上是正确的，并且它执行的操作是所需的操作。这些*错误*可能会隐藏很长一段时间，当发现时，天知道有多少数据被破坏了......

最后，这是一个经常使用的论点，如果与数据库的连接在一系列更新/删除查询的中途丢失怎么办？FK 约束使您能够*级联*某些操作。我实际上并没有*看到*这种情况发生，但我知道有人不编写代码来防止这种情况
删除或更新多个关系记录，但在中途，与数据库的连接由于某种原因被切断. 您可能已经编辑了 tbl2，但在发送到 tbl1 的查询之前连接已丢失。同样，我们最终得到损坏的数据。
FK`CASCADE`在这里*非常*有用。从 tbl1 中删除，并设置一个`ON DELETE CASCADE`规则，这样你就可以放心把相关记录从tbl2中删除了。在同样的情况下，`ON DELETE RESTRICT`, 也可以是一个相当有用的规则。

请注意，FK 并不是生命、宇宙和所有事物的最终答案（众所周知，它是 42），但它们是*真正*的关系数据库设计的重要组成部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T11:39:29.807

[参照完整性](http://en.wikipedia.org/wiki/Referential_integrity)是您应该阅读和理解的文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-01T09:24:41.453

有两种方法

-第一个是处理编码端的所有事情管理删除或更新记录的事情，但是当您使用外键时，您正在执行关系并且 Db 不允许您删除具有外键约束的记录，尤其是当您不这样做时不想删除与之相关的记录，在某些情况下您需要执行此类任务。

-第二种方法是在 Db 端管理事物。如果您在数据库中有一对多或多对多的关系，外键将非常有用。他们也有一些很好的行动 - RESTRICT, CASCADE, SET NULL, NO ACTION 这些可以为你做一些工作

# java - 获取最后一个令牌字符串

> ID：13086163
> 
> 赞同：3
> 
> 时间：2012-10-26T11:34:59.617
> 
> 标签：java

我有一个应用程序需要读取`String`分号“ `;`”分隔的缓冲区。

```
String buff = foo.getBuff(); // returns the buffer 
```

但是，缓冲区可能会变得非常大，我只需要获取最后一个字符串*令牌*，然后刷新临时变量`String buff`，这样我的应用程序就不会积累太多内存。

**更新：**

我试过这段代码：

```
String lastToken = buff.substring(buff.lastIndexOf(";") + 1); 
```

但是，与此相比，我没有得到上面这段代码的结果：

```
List<String> slist = Arrays.asList(buff.split(";"));
String lastToken = slist.get(slist.size() - 1); 
```

但是使用 List 非常慢。处理此问题时，我的网络应用程序几乎没有响应。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T11:38:48.033

这将帮助您：

```
String lastToken = buff.substring(buff.lastIndexOf(";") + 1); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T11:38:35.643

我不知道 Java，但通过谷歌搜索 2 个函数，我认为这样的事情应该可以工作：

```
String buff = foo.getBuff(); // returns the buffer
String lastToken = buff.substring(buff.lastIndexOf(";")+1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T11:41:12.720

检查这个：

```
String lastToken = foo.getBuff().substring(foo.getBuff().lastIndexOf(';')+1); 
```

编辑：丹比我给出的答案更好更快。

# android - Android 上的 OpenSL ES 替代方案

> ID：13086171
> 
> 赞同：4
> 
> 时间：2012-10-26T11:35:30.473
> 
> 标签：android, audio, android-ndk, opensl

我正在为需要的 android 构建一个应用程序，将队列播放器中的 pcm 数据作为浮点数播放。据我所知，这是不可能的。描述[说](http://mobilepearls.com/labs/native-android-api/opensles/index.html)：

> SL_DATAFORMAT_PCM 不允许应用程序将数据的表示形式指定为有符号整数、无符号整数或浮点数。Android 实现假定 8 位数据是无符号整数，而 16 位数据是有符号整数。此外，字段 samplesPerSec 是用词不当，因为实际单位是毫赫兹。这些问题预计将在下一个 OpenSL ES 版本中得到解决，该版本将引入一种新的扩展 PCM 数据格式，允许应用程序明确指定表示，并更正字段名称。由于这将是一种新的数据格式，并且当前的 PCM 数据格式仍然可用（尽管已弃用），因此不需要立即更改您的代码。

有没有机会通过 openssl es (1.0.1) 完成这项工作，或者对于 android ndk 是否有替代 opensl es 的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T12:59:04.727

您可以将浮点波形转换为有符号的 16 位，并将其提供给 OpenSL。

由于您需要访问波形数据才能将其提供给 OpenSL，因此在运行时进行转换应该很简单——没有太多开销。

OpenSL 要求内存位置保持有效，直到它不再需要它。因此，您可以使用中间缓冲区进行转换并重新使用它。

我就是这样做的。事实上，我只使用一个流并在软件中进行所有源混合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T22:36:06.903

您可以使用 ffmpeg 来执行此类转换。它具有特定的库以及用于此目的的一组 API，所有这些都在 libresample/avresample.h 中定义。我找不到太多信息或任何关于如何做到这一点的教程，但是通过查看头文件本身就足够了。这很简单：

[http://ffmpeg.org/doxygen/trunk/avresample_8h.html](http://ffmpeg.org/doxygen/trunk/avresample_8h.html)

希望这对你有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-14T13:15:09.603

Android L 及更高版本支持 SND_PCM_FLOAT。

但是，自己进行转换可能仍然有意义。目前，不能保证任何特定设备都会原生支持浮点输出。即使在硬件支持浮动的设备上，内核或 Android HAL 也可能无法设置为利用它。所以会在某个时候进行软件转换。如果您要为软件转换付费，您不妨自己动手，这样您就可以选择自己的范围校正和抖动算法。

# wpf - wpf 嵌套弹出窗口

> ID：13086173
> 
> 赞同：1
> 
> 时间：2012-10-26T11:35:45.020
> 
> 标签：wpf, popup, nested

我正在开发一个自定义控件，它有一个打开弹出窗口的按钮。当该弹出窗口包含我的自定义控件的另一个实例（它也有一个打开另一个弹出窗口的按钮，例如日历）时，会出现一些问题。第二个（嵌套）弹出窗口不会被怀疑。当父弹出窗口关闭时，点击不起作用，不会关闭。使用嵌套弹出窗口时是否有任何特定的最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-03T17:23:56.813

我遇到过同样的问题。`DropDownSubsetSelector`我们的 wpf 控件库中有一个自定义控件。此控件`Popup`在其控件模板中有一个带有`StaysOpen="False"`. 今天，我不得不将此控件放在位于 wpf`Popup`控件内部的自定义视图上，`StaysOpen="False"`并且对这种意外`Popup`的嵌套行为感到好奇。我对这个问题的解决方法是检查微软的经典`ComboBox`控件的源代码。你可以在这里找到它[Combobox Source](http://referencesource.microsoft.com/#PresentationFramework/src/Framework/System/Windows/Controls/ComboBox.cs)。正如您所看到的，它在控件上的行为与您期望在另一个`Popup`控件上的行为完全相同，并且它的模板内部有 Popup（可选项目的下拉菜单）。`Popup``Popup`

您必须订阅事件`MouseDownEvent`并`LostMouseCaptureEvent`处理鼠标捕获，以便正确处理控制区域`MouseDownEvent`之外的情况。`Popup`检查并复制一些源代码为您的嵌套`ExtendedPopup`. 您可以从 classic 继承它`Popup`。

# mysql - 数据库中的重复条目

> ID：13086174
> 
> 赞同：0
> 
> 时间：2012-10-26T11:35:48.220
> 
> 标签：mysql, codeigniter, join, left-join, duplicate-data

**如果我删除评论表连接，仔细检查问题就解决了，但显然这不是理想的帮助！**

我正在尝试用 Codeigniter 写博客。目前我正在显示我想要显示的所有信息，但由于某种原因，在查看博客时，我有重复的类别内容。我的数据库中只有 3 个测试类别，但我的测试帖子中有 1 个选择了所有 3 个，其中显示了 6 个，而另一个只显示了一个类别两次。

比这更奇怪的是，第一篇博文还计算了错误的评论数量。当数据库中只有 4 个并且只有两个与该帖子相关时，它显示 6，但最奇怪的是第二个帖子显示了正确数量的评论，两个。这个怎么可能。

这是来自相关模型的查询。

```
$this->db->select('posts.id,
                        posts.title,
                        posts.slug,
                        posts.content,
                        posts.author,
                        posts.date,
                        posts.time,
                        posts.tags,
                        posts.status,
                        GROUP_CONCAT(categories.name SEPARATOR \'-\') AS categories,
                        count(comments.id) as total_comments
                        ');
    $this->db->group_by(array('posts.id'));
    $this->db->join('posts_categories', 'posts_categories.blog_entry_id = posts.id', 'left outer', 'left outer');
    $this->db->join('categories', 'posts_categories.blog_category_id = categories.category_id', 'left outer');
    $this->db->join('comments', 'comments.post_id = posts.id', 'left outer' );

    $query = $this->db->get('posts', $config['per_page'], $this->uri->segment(3)); 
```

生成的标准查询是这样的：

```
SELECT DISTINCT `posts`.`id`, 
`posts`.`title`, `posts`.`slug`, 
`posts`.`content`, `posts`.`author`, 
`posts`.`date`, `posts`.`time`, 
`posts`.`tags`, `posts`.`status`, 
 GROUP_CONCAT(categories.name SEPARATOR '-') AS categories, 
 count(comments.id) as total_comments 
 FROM (`posts`) 
 LEFT OUTER JOIN `posts_categories` ON `posts_categories`.`blog_entry_id` = `posts`.`id` 
 LEFT JOIN `categories` ON `posts_categories`.`blog_category_id` = `categories`.`category_id` 
 LEFT JOIN `comments` ON `comments`.`post_id` = `posts`.`id` 
 GROUP BY `posts`.`id` LIMIT 1 
```

可以在[此处找到数据库转储](http://jonigale.com/sql-dump.txt)

任何帮助将不胜感激，这让我发疯了！

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T15:02:19.150

您是否对运行另一个查询以获取评论计数有任何疑虑？您可以执行以下查询（假设 Active Record）：

```
$this->db->where('parent_id', $post_id);
$this->db->count_all_results('comments'); 
```

但是，这必须为每个帖子运行，因此您的查询数将为 n+1，其中 n = 帖子数。

# django - Django MPTT 的模板标签破坏 HTML 标记

> ID：13086175
> 
> 赞同：0
> 
> 时间：2012-10-26T11:35:53.273
> 
> 标签：django, templates, escaping, django-mptt

我正在使用 Django MPTT 来处理我的 Django 应用程序中的分层数据。我想使用`recursetree`标签呈现 TreeView。但是，使用此代码：

```
{% recursetree system_list %}
    <li>{{ node.title }}
        {% if not node.is_leaf_node %}
            <ul>
                {{ children.title }}
            </ul>
        {% endif %}
    </li>
{% endrecursetree %} 
```

我得到这样的标记：

```
 <li>Uppeur kar parK

            <ul>

    &lt;Li&gt;Caillou

            &lt;Ul&gt;

    &amp;Lt;Li&amp;Gt;Patate

    &amp;Lt;/Li&amp;Gt;

    &amp;Lt;Li&amp;Gt;Courgette

    &amp;Lt;/Li&amp;Gt;

    &amp;Lt;Li&amp;Gt;Artichaud

    &amp;Lt;/Li&amp;Gt;

    &amp;Lt;Li&amp;Gt;Brocoli

    &amp;Lt;/Li&amp;Gt;

            &lt;/Ul&gt;

    &lt;/Li&gt;

    &lt;Li&gt;Pierre

    &lt;/Li&gt;

            </ul>

    </li> 
```

你知道为什么标记在第二级之后被转义吗？我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:58:02.880

尝试`{{ children }}`代替`{{ children.title }}`.

# jasper-reports - iReport 和 Jaspersoft Studio 有什么区别？

> ID：13086177
> 
> 赞同：20
> 
> 时间：2012-10-26T11:36:00.100
> 
> 标签：jasper-reports, ireport, jaspersoft-studio

两者都是用于可视化设计报告的工具，并且都来自同一供应商。

Jaspersoft 为什么要推动两种类似的技术？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-26T11:50:27.293

在[http://www.jaspersoft.com](http://www.jaspersoft.com)的常见问题解答中：

> **为什么 Jaspersoft 会这样做？**
> 
> 多年来，由于 Eclipse 平台的受欢迎程度和功能，我们的开发人员社区要求我们支持它。该反馈使构建基于 Eclipse 的报表设计器的决定变得容易。Jaspersoft 用户将受益于 Eclipse 平台的丰富功能，而 Eclipse 开发人员将受益于完整的开源 BI 堆栈来构建和部署他们的报告。我们还旨在创建一个功能强大且直观的报表设计环境，以吸引高级和首次使用报表开发人员。

所以我认为这只是一个分支，目的是为设计者提供一个基于 Eclipse 的应用程序。

此外，他们还提供设计器作为 Eclipse 的插件版本：

> **Jaspersoft Studio 可以使用哪些 Eclipse 版本？**
> 
> Jaspersoft Studio 的插件版本可以安装在 Eclipse IDE 3.5 或更高版本上。兼容的 Eclipse 版本是 Indigo、Helios 和 Galileo。

无论如何，我无法下载 Jaspersoft Studio 来尝试一下，因为[下载页面](http://community.jaspersoft.com/project/jaspersoft-studio)当前不存在。

# jquery - jQuery 加密参数字符串

> ID：13086179
> 
> 赞同：1
> 
> 时间：2012-10-26T11:36:02.307
> 
> 标签：jquery

我刚刚找到一个使用 1 个字符串作为数据参数的网站。此字符串是加密的，并包含将在网站的 JavaScript 部分中使用的其他参数。

例子：

```
index?data=Q7aOgwzkG9a8YK0v7wJigerA7ZCmmBj5s8flxjbDC3SzbsQwfSrTXgxHUqhpbUkcpcDmTzf9RRPZLnw8iD9aWKeT4/cToZtNW1Lqys7pPX1kSEaPGA5YvTGlneUNTLyGJ2YYgoNuP/wxsQOT17l/EXNxiAodhZ6rfS+O1lq8ly5rEniftC7/PA== 
```

参数数据可以分为几个部分：

```
Q7aOgwzkG9a8YK0v7wJigerA7ZCmmBj5s8flxjbDC3SzbsQwfSrTXg
xHUqhpbUkcpcDmTzf9RRP
ZLnw8iD9aW
KeT4/cToZtN
W1Lqys7pPX1kSEaPGA5YvTGlneUNTLyGJ2YYgoNuP/wxsQOT17l/E
XNxiAodhZ6rfS+O1lq8ly5rEniftC7/PA== 
```

这些部分正在重演：

```
Q7aOgwzkG9a8YK0v7wJigerA7ZCmmBj5s8flxjbDC3SzbsQwfSrTXg
ZLnw8iD9aW
W1Lqys7pPX1kSEaPGA5YvTGlneUNTLyGJ2YYgoNuP/wxsQOT17l/E 
```

我真的很喜欢这种加密参数的方式 - 但我不知道如何去做。我已经向他们的网站发送了一封邮件，并且正在询问但没有得到回复 - 所以也许你可以在这里帮助我，将我推向正确的方向？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:45:43.440

这不是“加密的”，它只是 base64（http://en.wikipedia.org/wiki/Base64）。我认为它不应该被拆分......这会导致解码器崩溃。

给定的代码......它的结果......不要告诉我任何东西，自己尝试一下（http://www.opinionatedgeek.com/dotnet/tools/base64decode/）

有一些用于 javascript 的 base64-en-/decoder，所以你可以使用任何你想要的。

# node.js - 使用 Node.js 时出错。

> ID：13086187
> 
> 赞同：0
> 
> 时间：2012-10-26T11:36:29.227
> 
> 标签：node.js, mongodb, mongoose

这是我的模型。

```
UserApiSchema.statics.createApi = function(user,fn){
  var instance = new UserApi();
  instance.user = user;
  instance.apiKey = "asdasdacasdasasd";
  console.log("username is " + user.username);
  instance.save(function(err){
    fn(err,instance);
  });
};

UserSchema.statics.newUser = function (email, password,username, fn) {
    var instance = new User();
    var apiInstance = new UserApi();
    instance.email = email;
    instance.password =password;
    instance.username = username;

    instance.save(function (err) {
        fn(err, instance);
    });
}; 
```

这是我的控制器-users.js：

app.post('/signup/', function(req, res) { {console.log(req.body.username); User.newUser(

```
 req.body.email, req.body.password,req.body.username,
            function (err, user) {
                if ((user)&&(!err)) {
                    console.log(user.username)

                    UserApi.createApi(
                            user,function(err,userapi){
                                if((!err)){
                                    res.send("APi created")
                                }
                                else{
                                    if(err.errors.apiKey){
                                        res.send(err)
                                    }
                                }

                            });
                    req.session.regenerate(function(){
                        req.session.user = user._id;
                        res.send("Success here!"); 

                    });
                } else {
                    if (err.errors.email) {
                          res.send(err) 
                          console.log(req.body.password);
                          console.log(req.body.email);
                          console.log(req.body);
                        }                           
                   if (err.errors.username) {
                      res.send(err) 
                      console.log(req.body.password);
                      console.log(req.body.email);
                      console.log(req.body);
                    }   
                }
            });

    } 
}); 
```

这个概念是，一旦用户名/密码被接受，API 密钥就会与用户名一起存储。虽然，用户名有效负载被接受，但是当我调用 UserApiSchema 来生成 api 时，没有生成这样的 api。也没有错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:54:35.130

可能是真正的基本...但是，您是否创建了所需的对象？

*   UserApiSchema = {};
*   UserApiSchema.statics = {};
*   UserApiSchema.statics.createApi = function(user,fn){ ...}

如果是这样……它们在一个模块中吗？您是否从模块中导出了它们？

*   出口.userApiSchema = UserApiSchema;

您是否将它们导入到 controller-users.js 中？

*   var userApiSchema = require('./UserApiSchema.js');

# android - Android WebView http 链接打开 Chrome 浏览器，带有 2 个标签到相同的 url

> ID：13086188
> 
> 赞同：3
> 
> 时间：2012-10-26T11:36:32.887
> 
> 标签：android, webview

我的应用程序中有一个显示本地 html 文件的 WebView。我正在使用 shouldOverrideUrlLoading() 方法处理其中的 PDF 文件链接，但是通过这样做，页面上的 http:// 链接现在正在 WebView 中加载，而不是在设备的浏览器中。

下面的代码可以识别 pdf 文件，并且可以正常工作，但是当我单击外部 url 时，它会在 chrome 浏览器中打开两个选项卡，指向相同的 url。我怎样才能只打开一个？

```
private class MyWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        if (url.contains(".pdf")) {
            // Remove the file:///android_asset/ text in url
            String tmpUrl = url.replace("file:///android_asset/", "");
            PdfHandler pdf = new PdfHandler(mContext);
            pdf.openPdf(tmpUrl);
            return true;
        }
        else{
            // Otherwise, the link is not for a page on my site, so launch another Activity that handles URLs
            Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
            startActivity(intent);
            return true;
        }
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T16:51:08.597

答案是将此标志添加到启动浏览器的 Activity 中：

intent.putExtra(Browser.EXTRA_APPLICATION_ID, mContext.getPackageName());

这会强制浏览器始终在我的应用程序创建的选项卡中打开一个链接

# sql - 分组和划分 Netezza

> ID：13086194
> 
> 赞同：2
> 
> 时间：2012-10-26T11:36:46.470
> 
> 标签：sql, sql-server, netezza

我有以下查询，将 sum(rev) 列中的每一行除以列的总和。

对于以下示例，sum(rev) 列的总和为 23193。除法列由以下公式得出：行 in sum(rev)/sum(rev)

```
select date,id,sum(rev), 
NULLIF(rev,0) / sum(rev) over() as Divide
from test 
where month(date) = 11
and year(date) = 2012
and day(date) = 02
and id = 'Client1'
group by date,id,rev
having sum(rev) <> 0
order by date

date                  id      sum(rev)      Divide

2012-11-02 00:00:00 Client1     1562.00     0.067348
2012-11-02 00:00:00 Client1     1.00        0.000043
2012-11-02 00:00:00 Client1     4689.00     0.202173
2012-11-02 00:00:00 Client1     267.00      0.011512
2012-11-02 00:00:00 Client1     16674.00    0.718924 
```

有2个问题

1.）当日（日期）条件被注释时，检索到的值是错误的。它在除法计算中没有给出正确的值

```
 date               sum(rev)         Divide
    2012-11-02 00:00:00 1.00            0.000002
    2012-11-02 00:00:00 267.00          0.000412
    2012-11-02 00:00:00 1562.00         0.002412
    2012-11-02 00:00:00 4689.00         0.007241
    2012-11-02 00:00:00 16674.00        0.025749 
```

2.) 我想按日期分组。所以因为我们只有 2-11-2012 的记录，所以每天必须只有一行记录

请帮助修复这两个错误

参考：[通过除以列的总和来查找列值](https://stackoverflow.com/questions/12939227/find-column-value-by-dividing-with-sum-of-a-column)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:27:28.050

如果您想`date`将每日总计除以总计，您可以这样做：

```
SELECT
  date,
  SUM(rev) AS total,
  SUM(rev) / SUM(SUM(rev)) OVER () AS portion
FROM test
GROUP BY
  date
; 
```

也就是说， 的参数`SUM() OVER ()`应该是一个有效的表达式，并且`rev`在这个 GROUP BY 查询中不是一个有效的表达式，因为`rev`它不包含在 GROUP BY 中。但是您可以（并且应该）将`SUM(rev)`其用作参数，并且它将按预期工作。

如果您想为不同的客户端提供不同的结果，请添加`id`到 GROUP BY 子句并添加`PARTITION BY id`到窗口 SUM() 的 OVER 子句中，如下所示：

```
SELECT
  date,
  id,
  SUM(rev) AS total,
  SUM(rev) / SUM(SUM(rev)) OVER (PARTITION BY id) AS portion
FROM test
GROUP BY
  date,
  id
; 
```

[阅读手册中](http://msdn.microsoft.com/en-us/library/ms189461.aspx "OVER 子句 (Transact-SQL)")有关 OVER 子句的更多信息。

# c++ - C++ builder模式插入运算符`<<`样式

> ID：13086200
> 
> 赞同：0
> 
> 时间：2012-10-26T11:37:09.537
> 
> 标签：c++, visual-c++

我有一个像这样的日志生成器类型：

```
Log Log::log(const int logLevel) 
{ 
    return Log(logLevel); 
}

Log& operator <<(Log& log, const char * s)
{
    if (log.hasLogLevel())
        log.out << s;
    return log;
} 
```

我正在使用上面的代码，如下所示：

```
Log::log(1) << "Hello logger"; 
```

但是我收到了这些警告，直到最近我才意识到这是因为操作员超载的方式（或者至少这是我的想法）

```
warning C4239: nonstandard extension used : 'argument' : conversion from 'snow::Log' to 'snow::Log &' 
```

我认为这会很好，因为它是一样的*`rvalue`？*通过这些运算符重载传递/链接。我不认为这段代码在 MSVC++ 之外编译，我想知道我应该在这里做些什么不同的事情。

如果解决方案是简单地使用右值引用，那么我对此很满意，但我想更好地理解这里发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T11:43:47.483

问题*是*Log 是一个右值，并且不允许绑定到非常量引用参数。微软没有强制执行这一点，因为他们有一些会破坏的遗留代码。

如果您只想输出字符串，一种解决方法是让`operator<<`Log 类成为成员。您*可以* 调用右值的成员。

如果您想使用其他非成员运算符，您可以提供一个右值到左值转换器，就像 C++11 中的标准流一样。

就像是

```
template<class T>
Log& operator<<(Log&& log, const T& value)
{ return log << value; } 
```

使用运算符*内部*`log`是一个左值并且可以绑定到其他运算符的非常量引用这一事实。

# asp.net - 在图表上显示数量和百分比值

> ID：13086201
> 
> 赞同：0
> 
> 时间：2012-10-26T11:37:14.753
> 
> 标签：asp.net, charts

我每个人；

我正在使用 ASP NET 图表，并且我有一个柱形图。在此图表中，我想显示百分比和数量的值，例如“10% (100)”。我做到了，它正在工作，但是该列是基于百分比值显示的，但我想基于数量值。这是我的代码：

```
Series mainSeries = new Series(serieName);
mainSeries.XValueMember = "ANSWER";
mainSeries.YValueMembers = "Total";
mainSeries.Label = "#PERCENT" + "\n(#VALY)"; 
```

这就是问题。我希望列的大小以百分比值显示，这样列大小基于数量值。如果我在数量等于 100 且百分比等于 10 时将 YValueMembers 更改为“百分比”，则该值显示为“10% (10)”，我的意思是……只显示百分比值。

那是我的图表，我想显示基于 50% 而不是 1（数量）的列。

![在此处输入图像描述](../Images/1af9726f8f2bb01c1b72c79123c10437.png)

关于我该怎么做的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:15:02.680

我不确定，但这会有所帮助

```
 Chart.Series[0].Points.DataBind(dv, "PKProject", "TotalSale", "LegendText=ProjectLabel");
 ChartSalesPerProject.Series[0].Label = "#PERCENT{P0}"; 
```

# java - 将 pdf 转换为 pdf/a 时出错

> ID：13086207
> 
> 赞同：0
> 
> 时间：2012-10-26T11:37:24.223
> 
> 标签：java, pdf, itext

我正在尝试使用 itext 从 pdf 文件创建 pdf/a 文件。一切顺利，我得到一个 pdf/a 文件。但是当我在这里查看[http://www.pdf-tools.com/pdf/validate-pdfa-online.aspx](http://www.pdf-tools.com/pdf/validate-pdfa-online.aspx) 我得到一个错误

```
The width for character 1 in font 'ArialRegular' does not match.
The width for character 2 in font 'ArialRegular' does not match.
The width for character 3 in font 'ArialRegular' does not match. 
```

我该如何解决这个错误？

```
PdfReader pdfReader = new PdfReader(file);

FontFactory.defaultEmbedding = true;
BaseFont bf = BaseFont.createFont(FONT, BaseFont.CP1252, BaseFont.EMBEDDED);
while (currentpagenumber < pdfReader.getNumberOfPages()) {
    document.newPage();
    currentpagenumber++;
    finalpagenumber++;
    page = pdfAWriter.getImportedPage(pdfReader, currentpagenumber);
    cb.addTemplate(page, 0, 0);
    cb.beginText();
    cb.setFontAndSize(bf, 18);
    cb.showTextAligned(PdfContentByte.ALIGN_CENTER, finalpagenumber+"", 520, 5, 0);
    cb.endText();
    ICC_Profile icc = ICC_Profile.getInstance(new FileInputStream(PROFILE)); 
```

这是基本代码。我还尝试使用 pdfdictionary 查找每个页面中使用的字体 .. 并尝试将其嵌入为基本字体 .. 但无法工作..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:03:52.170

以前从未使用过 IText，但现在只是想进行类似的转换，它似乎是库中的一个错误，而不是您使用它的方式。我能给你的最好的选择是报告一个错误：http: [//sourceforge.net/p/itext/bugs/](http://sourceforge.net/p/itext/bugs/) IText 邮件列表也是另一个尝试的地方。

md_5

# javascript - 使用单引号或双引号

> ID：13086212
> 
> 赞同：0
> 
> 时间：2012-10-26T11:37:46.323
> 
> 标签：javascript, jquery

> **可能重复：**
> [何时在 JavaScript 中使用双引号或单](https://stackoverflow.com/questions/242813/when-to-use-double-or-single-quotes-in-javascript)
> [引号 Javascript 中单引号和双引号的区别](https://stackoverflow.com/questions/3149192/difference-between-single-quotes-and-double-quotes-in-javascript)

当我开始学习 jQuery 时，我经常发现使用单引号或双引号作为 jQuery 选择器的示例：

`$('#myDiv');`或者`$("#myDiv");`

它们基本相同。但是使用哪个更喜欢和快速执行请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T11:39:26.250

你会想要在你希望双引号出现在字符串中的地方使用单引号（例如对于 html 属性），而不必转义它们，反之亦然。除此之外，没有区别，性能虎钳也都相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T11:40:05.593

没有性能差异。他们的意思是一样的。我通常将单打用于属性名称和其他短文字，将双打用于用户将看到的长文本。当然，例外情况是当两者之一出现在字符串中时，然后使用另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:41:27.250

我个人在处理字符串（= 多个字符）时使用双引号，在处理字符（= 一个字符）时使用单引号，尽管 Javascript 没有区别。双引号中也没有[像 php 中那样](https://stackoverflow.com/questions/3446216/difference-between-single-quote-and-double-quote-string-in-php)的“隐藏”功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T11:43:39.277

jQuery 代码风格要求使用双引号，但在用法上没有区别。

双引号的输入速度更快 =)

# javascript - 自定义导航链接可以显示任意功能区吗？

> ID：13086222
> 
> 赞同：1
> 
> 时间：2012-10-26T11:38:54.390
> 
> 标签：javascript, silverlight, dynamics-crm, ribbon

我正在自定义 Quote 实体，旨在用自定义的、Silverlight 支持的 DataGrid 替换股票 Quote Products 网格。它基本上旨在扩展基本的“相关记录视图”功能（大多数情况下，它添加了一些计算字段和内联编辑，没什么太花哨的）。

当然，整个事情最终越无缝集成越好：我把它皮肤很好，基本功能都在那里，但是功能区是一个大问题，我希望它显示 Quote Details SubGrid 功能区，但显然这件事不知道我的自定义导航链接显示的内容。

我知道功能区规则，但它们似乎没有解决这个需求；我也不知道有任何 XRM 功能可以完成它。它甚至可行吗？如果是这样，我该如何做到这一点？

* * *

更多关于我已经拥有的：

我向左侧导航区域添加了一个自定义链接（我们命名它`My Awesome Grid`），指向一个 HTML Web 资源（我们命名它`new_AwesomeGridPage`）。此资源仅托管一个 Silverlight 应用程序（它是另一个 Web 资源`new_AwesomeGrid`），其中包含一个`DataGrid`以自定义、更精美的方式列出报价详细信息的应用程序。网格是通过 OData 服务提供的，并且一切正常（可以指出，数据来自哪里以及它代表什么并不重要，当然这是真的），除了表单功能区它不会像单击相关实体的内置导航链接那样“切换”。因此我想知道如何（*如果？*) 当自定义导航链接用于显示 HTML Web 资源时，可以强制功能区显示任意相关实体的命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T11:02:56.793

嗯有点尴尬的情况，恐怕我没有详细的解决方案，只是一种方法。

据我所知，没有办法将标准色带“连接”到自定义 Silverlight 网格。

我认为你必须做的是；为所有现有按钮添加启用/可见性规则，然后在有人查看您的网格时禁用/隐藏它们。我不确定这条规则会采用什么形式，可能是 JavaScript。

然后使用与您的 Silverlight 应用程序通信的 JavaScript 操作创建新按钮，然后让您的 Silverlight 应用程序执行所需的任何逻辑。

对于功能区自定义，我建议从[功能区工作台](http://www.develop1.net/public/page/Ribbon-Workbench-for-Dynamics-CRM-2011.aspx)开始，它是功能区编辑的绝佳工具。

# wordpress - Wordpress Multisite (subdomain install) rewrite rules

> ID：13086223
> 
> 赞同：-1
> 
> 时间：2012-10-26T11:38:58.373
> 
> 标签：wordpress, apache, .htaccess, url-rewriting, rewrite

1) I have a Wordpress multisite subdomain installation with about 100 sites in the network.

Network Admin - Sites (All Sites) shows them like this:

```
main site: "www.domain-name.com"
all other sites: "subdomain-name.domain-name.com" 
```

there is also a domain mapping plugin, so they all get access as separate urls:

```
domain-name1.com
domain-name2.com
...
domain-name100.com 
```

2) Currently urls on all blogs are set to:

```
domain-name.com/2012/10/26/post-name
domain-name.com/category/category-name 
```

(I used today's date as an example)

This is also the way domains show in Google and Bing search results

3) I am going to remove "2012/10/26/" and "category/" from the urls, so they are gonna look like this:

```
domain-name.com/post-name
domain-name.com/category-name 
```

...and I need to have a rewrite rule that takes care of redirecting people coming from serps to these new urls

4) I have something like this right now:

```
RewriteRule ^([0-9]{4})/([0-9]{2})/([0-9]{2})/(.*)$ http://domain.com/$4 [L,R=301]

RewriteCond %{HTTP_HOST} ^domain\.com
RewriteRule ^([0-9]{4})/([0-9]{2})/([0-9]{2})/(.*)$ http://domain.com/$4 [L,R=301] 
```

but I am not sure if it is correct / if it is gonna work right, and also I need to have a rule for all 100 websites, and not just one. These versions (only one of them was meant to be used) dont include the "category/" part either.

5) If somebody would have an idea how to do that it would be great (one or two rewrite rules for all sites would be probably best).

Thank you in advance for any info.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T02:50:47.160

You can simplify your regex for the `RewriteRule` using `\d` to match digits and only using a match group on the `post-name`. If this behavior is the same for all of the domains, you can just omit the domain from your `RewriteCond` and `RewriteRule`:

```
RewriteRule ^\d{4}/\d{2}/\d{2}/(.*)$ $1 [L,R=301]
RewriteRule ^category/(.*)$ $1 [L,R=301] 
```

You can test the above rules and resulting URLs with [http://htaccess.madewithlove.be/](http://htaccess.madewithlove.be/)

# javascript - 允许 : 或 . meiomask 时间掩码中的符号

> ID：13086232
> 
> 赞同：3
> 
> 时间：2012-10-26T11:39:27.687
> 
> 标签：javascript, jquery, regex

我正在使用 meioMask 来屏蔽用于用户输入时间的文本框，效果很好。它允许时间长达 23:59

```
 $("[id$=txtTime]").setMask("29:59")
    .keypress(function() {
        var currentMask = $(this).data('mask').mask;
        var newMask = $(this).val().match(/^2.*/) ? "23:59" : "29:59";
        if (newMask != currentMask) {
            $(this).setMask(newMask);
        }

    }); 
```

我认为一些用户在输入日期时会尝试输入`:`符号，在使用掩码时它不允许符号，并且用户可能不希望它在输入更多数字后继续。

我怎样才能允许掩码中的`:`或符号？`.`我对正则表达式很糟糕。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T06:28:32.100

尝试修改规则以添加冒号，以便将其识别为可编辑的保留项。

```
$.mask.rules = {
  'z': /[a-z]/,
  'Z': /[A-Z]/,
  'a': /[a-zA-Z]/,
  '*': /[0-9a-zA-Z]/,
  '@': /[0-9a-zA-ZçÇáàãéèíìóòõúùü]/,
  ':': /[:]/
}; 
```

值得一试。我有点盲目，因为我没有测试过，但它可能只是工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-18T10:24:43.100

添加与上述类似的规则：`':': /:/`并`:`从字符串中删除`options.fixedChars`

# c# - 将记录插入数据库后，PageRefresh 不起作用

> ID：13086237
> 
> 赞同：0
> 
> 时间：2012-10-26T11:39:33.220
> 
> 标签：c#, asp.net

我有一个名为 fillgrid() 的函数，它用数据填充网格。但是在我调用将记录插入数据库的 insert() 函数后，它没有被执行。

它在我的本地系统中工作正常。但是当我发布我的解决方案并将其放入服务器时，fillgrid() 函数没有被执行。我没有收到任何错误，我无法识别为什么没有调用 fillgrid() 函数？

这是我的插入功能代码。

```
DataTable dtMob = new DataTable();
dtMob = dtMobilizn.Copy();
DataSet dsMobilizn=new DataSet("dsMobilization");
dsMobilizn.Tables.Add(dtMob);
int i = clsMob.InsertMobilizationDetails(dsMobilizn.GetXml());//i am getting the value as 1 when i debugged in local system
if (i != -1)
{
    FillGrid();//This function is not getting called.
}
else
{
    string str = "<script>alert('Cannot mobilize')</script>";
    ScriptManager.RegisterStartupScript(Page, Page.GetType(), "Validation Error", str, false);
    return;
} 
```

这是填充网格函数的代码。该函数在页面加载时调用，并且工作正常。

```
 DataTable dtGrid = clsMob.GetStandByEmployee(txtSrchEmpCode.Text.Trim());
        if (dtGrid.Rows.Count > 0)
        {
            if (ViewState["Sort"] != null)
            {
                DataView dView = new DataView(dtGrid);
                dView.Sort = ViewState["Sort"].ToString();
                gdMobilizn.DataSource = dView;
                gdMobilizn.DataBind();
            }
            else
            {
                gdMobilizn.DataSource = dtGrid;
                gdMobilizn.DataBind();
            }
        }
        else
        {
            gdMobilizn.DataSource = null;
            gdMobilizn.EmptyDataText = "No Standby Employees Found";
            gdMobilizn.DataBind();
        } 
```

这是 InsertMobilizationDetails 的功能

```
public int InsertMobilizationDetails(string xml)
{
    Database_Operations dbo = new Database_Operations("TransMob_InDetails", true);
    dbo.AddParameter("@xmlMob", xml);        
    return dbo.ExecuteQuery();       
} 
```

这是 ExecuteQuery 的功能

```
public int ExecuteQuery()
    {
        int rowsAffected = -1;
        SqlCon = new SqlConnection();
        using (SqlCon = new SqlConnection(ConfigurationManager.ConnectionStrings["SQL_CONNECTION"].ToString()))
        {
            try
            {
                SqlCon.Open();
                SqlCmd.Connection = SqlCon;
                SqlTransaction transaction;
                transaction = SqlCon.BeginTransaction();
                try
                {
                    SqlCmd.Transaction = transaction;
                    rowsAffected = SqlCmd.ExecuteNonQuery();
                    transaction.Commit();
                    rowsAffected = 1;
                }
                catch (Exception ex)
                {
                    transaction.Rollback();
                    rowsAffected = -1;
                    //Response.Write(ex.Message);
                }
            }
            catch (Exception exp)
            {
                rowsAffected = -1;
                //Response.Write(exp.Message);
            }
            finally
            {
                SqlCon.Close();
                SqlCon.Dispose();
            }
        }
        return rowsAffected;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:45:03.733

检查页面加载事件中的 Ispostback 属性。将方法放入！ispostback。

可能这对你有用。

# javascript - 日期范围内的价格计算问题

> ID：13086245
> 
> 赞同：-3
> 
> 时间：2012-10-26T11:39:56.083
> 
> 标签：javascript

在收费系统上未正确计算收费时遇到问题。

下面是代码，如果您在一个日期范围内运行，而不是以 1 个价格给出 2 天，然后以另一个价格说 1 天，则它不会。以下是代码示例：

```
$(function () {
    function change_charges() {
        var checkin_mon = Number($("#checkindate_Month_ID").val());
        var checkin_day = Number($("#checkindate_Day_ID").val());
        var checkin_year = Number($("#checkindate_Year_ID").val());
        var checkout_mon = Number($("#checkoutdate_Month_ID").val());
        var checkout_day = Number($("#checkoutdate_Day_ID").val());
        var checkout_year = Number($("#checkoutdate_Year_ID").val());
        var checkin_date = new Date();
        checkin_date.setFullYear(checkin_year, checkin_mon, checkin_day);
        var checkout_date = new Date();
        checkout_date.setFullYear(checkout_year, checkout_mon, checkout_day);
        var one_day = 1000 * 60 * 60 * 24
        //Calculate difference btw the two dates, and convert to days
        var stay = Math.ceil((checkout_date.getTime() - checkin_date.getTime()) / (one_day));
        var room_type = $("#room_type").val();
        var charges = 0;
        var n_charges = 0;
        var st_date = new Date();
        var end_date = new Date();
        var mon_stay = 0;
        var rem_stay = 0;
        if (room_type == "Villa") {
            st_date.setFullYear(checkin_year, 4, 1);
            end_date.setFullYear(checkin_year, 9, 31);
            if (checkin_date >= st_date && checkin_date <= end_date) {
                charges = 1995;
                n_charges = 2995;
                if (checkout_date > end_date) mon_stay = Math.ceil((end_date.getTime() - checkin_date.getTime()) / (one_day));
            }
            st_date.setFullYear(checkin_year, 10, 1);
            end_date.setFullYear(checkin_year, 11, 15);
            if (checkin_date >= st_date && checkin_date <= end_date) {
                charges = 2995;
                n_charges = 2995;
                if (checkout_date > end_date) mon_stay = Math.ceil((end_date.getTime() - checkin_date.getTime()) / (one_day));
            }
            st_date.setFullYear(checkin_year, 11, 16);
            end_date.setFullYear(checkin_year, 11, 31);
            if (checkin_date >= st_date && checkin_date <= end_date) {
                charges = 5900;
                n_charges = 5900;
                if (checkout_date > end_date) mon_stay = Math.ceil((end_date.getTime() - checkin_date.getTime()) / (one_day));
            }
            st_date.setFullYear(checkin_year, 0, 1);
            end_date.setFullYear(checkin_year, 0, 15);
            if (checkin_date >= st_date && checkin_date <= end_date) {
                charges = 5900;
                n_charges = 3900;
                if (checkout_date > end_date) mon_stay = Math.ceil((end_date.getTime() - checkin_date.getTime()) / (one_day));
            }
            st_date.setFullYear(2013, 0, 16);
            end_date.setFullYear(2013, 3, 30);
            if (checkin_date >= st_date && checkin_date <= end_date) {
                charges = 3900;
                n_charges = 2223;
                if (checkout_date > end_date) mon_stay = Math.ceil((end_date.getTime() - checkin_date.getTime()) / (one_day));
            } 
```

如果（保持 > 1）{

```
 if(mon_stay == 0)mon_stay = 1;

   if(mon_stay != 0){
      rem_stay = stay - mon_stay;

      charges = (mon_stay*charges) + (rem_stay*n_charges);   

   }

   else
   charges*=stay; 
```

}

var 今天 = 新日期（）；

if(checkin_date < 今天 || checkout_date < 今天 || checkout_date < checkin_date){

```
 charges = 0;

} 
```

$("#tot_charges").html(charges.toFixed(2));

}

$("#checkindate_Month_ID").change(function() {

change_charges();

});

$("#checkindate_Day_ID").change(function() {

change_charges();

});

$("#checkindate_Year_ID").change(function() {

change_charges();

});

$("#checkoutdate_Month_ID").change(function() {

change_charges();

});

$("#checkoutdate_Day_ID").change(function() {

change_charges();

});

$("#checkoutdate_Year_ID").change(function() {

change_charges();

});

$("#room_type").change(function() {

change_charges();

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:29:49.943

你的计算函数是错误的：以你的第一个例子：3天@1995 =5985你的代码如下：stay=3 mon_stay=1（因为你写了：if mon_stay =0 then mon_stay=1）那么

费用 = 1*1995 + 2* 2995 = 7985 ！

一个更好的公式是（我认为但很难理解）

```
charges = (mon_stay*n_charges) + (rem_stay*charges); 
```

没有 mon_stay=1 （除非它是有意的）

# javascript - 将 Javascript 推送到 DIV 标签

> ID：13086257
> 
> 赞同：-3
> 
> 时间：2012-10-26T11:40:29.370
> 
> 标签：javascript

我正在尝试将此 twitter 提要输出到右栏中的标签，但我不知道如何使其工作。似乎代码已设置为在其所在的任何位置打印。但是，我不能将代码放在页面的正文中。

[http://cusli.org/NiagaraIntlMootCourt/NiagaraMoot.aspx](http://cusli.org/NiagaraIntlMootCourt/NiagaraMoot.aspx)

这是代码。我在 html 正文中有一个 id 为“comments”的 div 标签。

```
<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>
<style type="text/css">
#nav {
padding: 0 0 0 10px;
    margin: 0;
    list-style: none;
    width: 760px;
    height: 0px;
    background:#6E102B;
    margin-bottom: 5px;

    }
.twtr-hd, 
.twtr-ft,
.twtr-user
{ 
display: none; 
}
</style>

<script>
new TWTR.Widget({
  version: 2,
  type: 'profile',
  rpp: 4,
  interval: 30000,
  width: 250,
  height: 300,

  theme: {
    shell: {
      background: '#ffffff',
      color: '#000000'
    },
    tweets: {
      background: '#ffffff',
      color: '#000000',
      links: '#b80b0b'
    }
  },
  features: {
    scrollbar: false,
    loop: false,
    live: false,
    behavior: 'all'

  }

}).render().setUser('NiagaraMoot').start();

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:46:02.033

```
 <div id="contentRight">

    <!-- this is your right coulmn, put TWitter script here -->
    <div class="myTwitter">
      <script>
         new TWTR.Widget({
           version: 2,

           ....

         }).render().setUser('NiagaraMoot').start();
      </script>
    </div> 
    <!-- end of your insert --> 

    <div id="dnn_ContentPane_Right">
     .... 
```

CSS 和主 Tweeter JS 库应该保留在`<head> ... </head>`您页面的标记中 - 最好......如果你不能将它们放在那里......它们可以在你的页面中的任何位置，但就在 init 部分之前（如上所示）。我的意思是这部分：

```
<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>
<style type="text/css">
#nav {
padding: 0 0 0 10px;
    margin: 0;
    list-style: none;
    width: 760px;
    height: 0px;
    background:#6E102B;
    margin-bottom: 5px;

    }
.twtr-hd, 
.twtr-ft,
.twtr-user
{ 
display: none; 
}
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:49:05.187

尝试这个：

```
<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>
<style type="text/css">
#nav {
padding: 0 0 0 10px;
    margin: 0;
    list-style: none;
    width: 760px;
    height: 0px;
    background:#6E102B;
    margin-bottom: 5px;

    }
.twtr-hd, 
.twtr-ft,
.twtr-user
{ 
display: none; 
}
</style>

<script>
var myThing = new TWTR.Widget({ //save you reference
  version: 2,
  type: 'profile',
  rpp: 4,
  interval: 30000,
  width: 250,
  height: 300,

  theme: {
    shell: {
      background: '#ffffff',
      color: '#000000'
    },
    tweets: {
      background: '#ffffff',
      color: '#000000',
      links: '#b80b0b'
    }
  },
  features: {
    scrollbar: false,
    loop: false,
    live: false,
    behavior: 'all'

  }

}); //remove from here

</script> 
```

在你的 HTML 里面去

```
<div>
<script>
myThing.render().setUser('NiagaraMoot').start(); //add here
</script>

</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:51:37.763

将脚本标签放在要渲染的 div 中。

例如：

```
<html>
  <body>
    <h1>Hello world</h2>
    <div>
      <script type="text/javascript">
        new TWTR.Widget({
          version: 2,
          type: 'profile',
          rpp: 4,
          interval: 30000,
          width: 250,
          height: 300,

          theme: {
            shell: {
              background: '#ffffff',
              color: '#000000'
            },
          tweets: {
            background: '#ffffff',
            color: '#000000',
            links: '#b80b0b'
          }
         },
         features: {
           scrollbar: false,
           loop: false,
           live: false,
           behavior: 'all'    
         }        
         }).render().setUser('NiagaraMoot').start();
      </script>
    </div>
  </body>
</html> 
```

# c# - .NET 4.5 异步等待和重载方法

> ID：13086258
> 
> 赞同：29
> 
> 时间：2012-10-26T11:40:29.927
> 
> 标签：c#, .net, asynchronous, .net-4.5

我有一个异步方法：

```
public async Task<UserLoginExResult> LoginExAsync(CustomTable exRequest, string language, bool throwEx = true)
{
    UserLoginExResult result = await UserService.LoginExAsync(UserGroup, language, TimezoneOffset, GetDeviceInfo(), GetLoginProperties(), exRequest);

    ProcessLoginResult(result, false, throwEx);

    return result;
} 
```

还有一个超载：

```
public Task<UserLoginExResult> LoginExAsync(CustomTable exRequest, bool throwEx = true)
{
    return LoginExAsync(exRequest, Language.ID, throwEx);
} 
```

我不确定是否应该将重载的（参数较少的）标记为`async`并使用`await`？我想我不应该，但你能告诉我如果我这样做会发生什么吗？我在这里很迷茫，不确定`Task`它会等什么？它会创造一个额外的`Task`还是`await`不创造一个新的`Task`？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-26T11:45:33.300

*不，当它只是*要包装和解开现有的方法时，使用异步方法几乎没有什么好处。在这里只有一个“普通”方法很好，委托给“真正的”异步方法。

（它们并不*完全相同*- 例如，如果`UserService.LoginExAsync`方法抛出异常而不是返回失败的任务，则 async/await 版本将只返回失败的任务，而其他版本也会*立即*抛出。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-26T11:51:01.943

`async`关键字仅启用`await`关键字。在您的情况下，您可以`Task`直接返回，因此不需要`async`关键字。`async`只会增加开销而不增加任何价值。

有关更多信息，请参阅[Stephen Toub 的 Zen of Async 演讲](http://channel9.msdn.com/Events/BUILD/BUILD2011/TOOL-829T)。他直接解决了这种情况。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-26T11:50:42.100

如果您在超载中做额外的工作，这真的是值得做的，例如

```
public async Task<UserLoginExResult> LoginExAsync(CustomTable exRequest, bool throwEx = true)
{
    Task<UserLoginExResult> result = await LoginExAsync(exRequest, Language.ID, throwEx);

    //Do some work here that depends on the result from the task completeion

    return result;
} 
```

但因为你不是，它不是！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-26T11:45:49.407

不需要标记重载，`async`因为它在内部不等待任何内容，因此编译器无需重写任何内容。

# python - 将图像添加到 python 脚本？

> ID：13086259
> 
> 赞同：0
> 
> 时间：2012-10-26T11:40:30.913
> 
> 标签：python, wxpython

在创建 wx.BitmapButton 之前，我有一个使用以下行的 wxPython 应用程序：

```
imagePlus = wx.Image('wxPlus.png', wx.BITMAP_TYPE_PNG).ConvertToBitmap() 
```

有没有办法将图像的数据包含在图像中，等等类似的东西？

```
plusData = '...√#,›o~ño\Ä¶˚ﬂy™Ω.…Õo)Ú∞L∂W_≤Ï~˛⁄...'
imagePlus = wx.Image(plusData, wx.BITMAP_TYPE_PNG).ConvertToBitmap() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:49:51.240

通过使用模块 StringIO，您可以创建一个可以传递给 wx.ImageFromStream 的“类文件对象”。

```
import StringIO

stream = StringIO.StringIO()
stream.write('...√#,›o~ño\Ä¶˚ﬂy™Ω.…Õo)Ú∞L∂W_≤Ï~˛⁄...')

image = wx.ImageFromStream(stream) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:43:33.233

如果您使用的是 wxPython，我认为[img2py](http://wxpython.org/docs/api/wx.tools.img2py-module.html)值得一看。

# ruby-on-rails-3 - 在 Rails 3 应用程序中解析 JSON HTTP 帖子？

> ID：13086262
> 
> 赞同：4
> 
> 时间：2012-10-26T11:40:42.427
> 
> 标签：ruby-on-rails-3, json, http, post

我有一个简单的 Rails 3 示例应用程序，我正在尝试解决如何解析 JSON POST 并将数据插入到我的应用程序数据库中。

我有一个基本的活动控制器和模型，控制器如下：

```
class ActivitiesController < ApplicationController
  # GET /activities
  # GET /activities.json
  def index
    @activities = Activity.order('created_at DESC').limit(10)

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @activities }
    end
  end

  # GET /activities/1
  # GET /activities/1.json
  def show
    @activity = Activity.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @activity }
    end
  end

  # GET /activities/new
  # GET /activities/new.json
  def new
    @activity = Activity.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @activity }
    end
  end

  # GET /activities/1/edit
  def edit
    @activity = Activity.find(params[:id])
  end

  # POST /activities
  # POST /activities.json
  def create
    @activity = Activity.new(params[:activity])

    respond_to do |format|
      if @activity.save
        format.html { redirect_to @activity, notice: 'Activity was successfully created.' }
        format.json { render json: @activity, status: :created, location: @activity }
      else
        format.html { render action: "new" }
        format.json { render json: @activity.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /activities/1
  # PUT /activities/1.json
  def update
    @activity = Activity.find(params[:id])

    respond_to do |format|
      if @activity.update_attributes(params[:activity])
        format.html { redirect_to @activity, notice: 'Activity was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @activity.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /activities/1
  # DELETE /activities/1.json
  def destroy
    @activity = Activity.find(params[:id])
    @activity.destroy

    respond_to do |format|
      format.html { redirect_to activities_url }
      format.json { head :no_content }
    end
  end
end 
```

我还从我尝试从以下位置接收 POST 的应用程序中获得了一个示例 JSON 有效负载：

```
payload {"files":{"changed":[],"removed":[".gitmodules","extensions","extensions/markdown"]},"project":{"permalink":"dans-stuff-2","public_key":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCuB80S+kMN1266LvCEXoU5hmjugcuXko61Hl7uD9VVgMgEOrLSkeYktOPshgCOwjQgGhSMVEHWrSuOddOi+V3rOu3v91jiU3vycRM3nK9GMaOFf+tTn0/4ReUvGOFHeir1vluHCmOAmpqsVhGWkCJY6eJE37muvGdTG4nW/VnpWYCTLfSOeaq5MVx5LU+zYLntvB5PXd7h1k5ROO8lW+5QzGVyHHEvilzJOqESIAWpNtcXGBt7clWpFH4lg2AT7JebYFuHl8Sl4LYzIRegcpg718CWJjrck9/xV6CBTGP520ifU6K0x4JOn/qFzVlqwnxmrPXwawptmCiYiJt3X8Oz DeployHQ.com Key for dans-stuff-2","name":"Dans Stuff","repository":{"port":null,"username":null,"branch":"master","url":"git@codebasehq.com:atech/deploytest/test1.git","scm_type":"git","cached":true,"hosting_service":{"name":"Codebase","url":"http://www.codebasehq.com","commits_url":"http://atech.codebasehq.com/projects/deploytest/repositories/test1/commits/master","tree_url":"http://atech.codebasehq.com/projects/deploytest/repositories/test1/tree/master"}}},"server":{"name":"cybele","server_path":"/home/dan/deploytest","port":22,"username":"dan","use_ssh_keys":true,"last_revision":"2ad223b9dd6d006d69909407ac7df322e35b009b","hostname":"cybele.phoenixdev.co.uk","identifier":"de99437e-da4a-0986-a7ab-e55805261a96","protocol_type":"ssh"},"start_revision":{"timestamp":"2011-11-30T13:48:22+00:00","author":"Dan Wentworth","ref":"a1c1073b85d1662c075d77f5d88be3fd291abd12","message":"nested markdown pathg","email":"dan@atechmedia.com"},"identifier":"9d0f9c21-f242-3966-fcd3-e821a65acd45","end_revision":{"timestamp":"2011-08-30T16:41:32+01:00","author":"Dan Wentworth","ref":"2ad223b9dd6d006d69909407ac7df322e35b009b","message":"arses","email":"dan@atechmedia.com"},"configuration":{"email_notify":true,"notification_addresses":"dan@atechmedia.com","copy_config_files":true},"timestamps":{"completed_at":"2012-01-17T09:22:15Z","duration":null,"queued_at":"2012-01-17T09:22:07Z","started_at":"2012-01-17T09:22:10Z"},"status":"completed"} -------------------------------------------------------------------------------- signature TMjVYhk/+lQigy3hdkgTZjAaaroxAi126XaDzrQ1xWGyMji9oR0F5nfE73Mo kNs7Hk7aY1GQgtDRdBjgPE+C/6etF9nPFXPacWobaxSP35TGOrpoSACNQDAQ Q0wvn0Bm/jMvhBKoQ6YYUSx8KP8nd7VkgQmv4S0cakgixA4LHfg= 
```

因为需要对 URL 进行 POST，所以我想我需要定义一个新方法：

```
def deploy_receive
   data = JSON.parse(request.body)
end 
```

我不确定的是，从这里去哪里。我将如何从 JSON 中挑选属性并将它们放入活动表中的各种属性中？

像这样的东西？

```
def deploy_receive
   data = JSON.parse(request.body)
   @activity = Activity.new(params[:fault])
   @activity.who = data.author    
end 
```

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T13:57:33.007

如果我理解正确，我认为您正在寻找如下内容：

路由文件

```
match '/api/activity/new' => 'activity#deploy_receive', :via => [:post] 
```

活动控制器（假设发布的数据格式正确）

```
def deploy_receive      
    @activity = Activity.new(params[:fault])
    if @activity.save
        render json: @activity
    else
        @activity = "error"
        render json: @activity
    end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:39:50.267

如果我理解正确；如果设置了正确的标题，Rails 已经为您完成了这项工作。结帐：[POST json 到 rails 服务器](https://stackoverflow.com/questions/4914745/post-json-to-rails-server)

# sql - 从 2 个不同的数据库中选择数据并进行比较

> ID：13086263
> 
> 赞同：0
> 
> 时间：2012-10-26T11:40:43.423
> 
> 标签：sql

如果已经问过这个问题，请原谅我，但是......我正在尝试从数据库中的 2 个不同表中选择数据，并计算一个表中与第二个表中的数据相等的所有数据（如果有意义的话） ? 下面是我尝试使用的代码

```
$select = "SELECT * FROM client_id, clientid, COUNT(client_id) FROM enquiry, check_s WHERE client_id = clientid"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:45:28.903

您的查询似乎在语法上是错误的。您可以尝试在主键（id？）和您尝试匹配的任何其他字段上连接两个表。基本语法如下：

```
SELECT * FROM 
DB1.Table1 
JOIN DB2.Table2 
ON DB1.Table1.PrimaryKey = DB2.Table2.PrimaryKey; 
```

如果您正在寻找精确的数据匹配，您可能必须根据所有字段连接表（在`ON`上述查询的子句中）。

编辑：

既然你已经解释过了，你可以试试这个：

```
SELECT table1.*, count(*) as `n` FROM table1
JOIN table2 
ON table1.field = table2.field; 
```

同样，如果您需要比较更多字段，只需将它们包含在`ON`子句中，并在子句中设置条件`WHERE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:14:10.347

我想你可能正在寻找这样的东西：

假设您的主表名称是 Client，您的辅助表（来自表单）是 Inquiry，您要在 client 中比较的列称为 client_id，而 Inquiry 中的同一列称为 clientid。然后你有

```
Select Count(Client.*)
From Client, Enquiry
Where Client.client_id = Enquiry.clientid
Group by Client.client_id 
```

# c++ - GL_TRIANGLE_FAN 第一个（中心）顶点法线

> ID：13086269
> 
> 赞同：2
> 
> 时间：2012-10-26T11:41:07.623
> 
> 标签：c++, opengl

因此，如果我要使用 GL_TRIANGLE_FAN 绘制三边金字塔，我会为中心提供一个顶点，为底部提供三个（实际上是四个，但你知道我的意思，对吧？！）。

我可以计算金字塔的所有三个面（边）的面法线。

问题是如果我只有一个调用来绘制那个顶点，我如何为每个面（边）的第一个（中心）顶点分配不同的法线？

基本上我需要为组成三角形的所有三个顶点分配相同的面法线，而为接下来的两个三角形分配相同的面。

但是当我只调用一次顶点绘制函数时，不知道如何为第一个（中心）顶点分配法线三次（这甚至可能使用 GL_TRIANGLE_FAN 吗？！）。

将该顶点法线设置为 glNormal3f(0.0f, 0.0f, 1.0f) 是不好的（尽管看起来是正确的），因为这样顶点之间的颜色插值是不正确的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T15:00:03.083

顶点只是位置是一个常见的误解。顶点是位置、法线、纹理坐标等的全部集合。如果你只改变顶点向量的一个属性，你会得到一个非常不同的顶点。

因此，不可能只有一个顶点，而是多个法线。这与定义顶点的方式相矛盾。

# r - 用于动态报告生成的 R2HTML 或 knitr？

> ID：13086275
> 
> 赞同：3
> 
> 时间：2012-10-26T11:41:20.963
> 
> 标签：r, knitr

我想编写一个 R 函数来处理一些数据，然后自动输出一个 html 报告。这份报告应该包含一些固定的文本，一些根据基础数据变化的文本和一些数字。

最好的方法是什么？R2HTML 还是 knitr？一个比另一个有什么优势？

据我了解，R2HTML 允许我按顺序构建 html 文件，而 knitr 已经在预定义的 .Rhtml 文件上运行。因此，要么使用 R2HTML，要么使用 knitr 的缝合和旋转来生成动态报告。

我将不胜感激任何建议或提示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T21:13:12.120

我抓住了这个很好的机会来宣传一下[pander](https://github.com/rapporter/pander) :)

* * *

这个包是出于类似@Yihui's great 的原因而编写的`knitr`，虽然*我想让用户真正专注于文本和R代码*而不处理块选项等。所以让用户生成 pretty `HTML`，`pdf`甚至*自动*输出一些预定义的选项`docx`。`odt`

 *这些[选项](http://rapporter.github.com/pander/#pander-options)影响例如[缓存引擎（处理](http://rapporter.github.com/pander/#caching)*没有*任何块选项的依赖项）或默认[绘图选项](http://rapporter.github.com/pander/graphs.html)（让它成为“基础” R或） `graphics`，因此您不必在每个中设置调色板或次要网格你的地块，只有一次 - 或者使用包默认值:)`lattice``ggplot2`

该包捕获所有运行 R 表达式的结果（除了错误/警告和其他消息*和*输出），并且可以自动转换为[Pandoc 的降价](http://johnmacfarlane.net/pandoc/)。有一些辅助函数可以让您将生成的文档自动转换[为类似 brew 的语法](http://rapporter.github.com/pander/#brew-to-pandoc)（如果您已`pandoc`安装），或者将 R 对象导出为 markdown/HTML/任何其他支持的格式在实时 R 会话中使用[参考类](http://rapporter.github.com/pander/#live-report-generation).

**简短演示：**

*   [酿造文件](https://github.com/Rapporter/pander/blob/master/inst/examples/short-code-long-report.brew)
*   `Pandoc.brew('file_name.brew', output = 'foo.html', convert = 'html')`
*   [HTML 输出](http://rapporter.github.com/pander/short-code-long-report.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T13:50:22.590

knitr，每次。处理图形，让您使用 markdown 编写报告，而不必在任何地方（如果需要）编写 html，缓存内容，为您煮咖啡等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T15:59:53.770

只要您有像 Emacs/ESS 或 RStudio 等体面的文本编辑器，您也可以按顺序构建 HTML 文件`R2HTML`。它对许多 R 对象的广泛支持非常出色（请参阅`methods(HTML)`参考资料），但我可能会`RweaveHTML()`皱眉到它的根`Sweave()`。

也就是说，我认为将 and 结合起来可能是个好主意`R2HTML`，`knitr`例如

```
# A LOESS Example

```{r loess-demo, results='asis'}
cars.lo <- loess(dist ~ speed, cars)
library(R2HTML)
HTML(cars.lo, file = '')
``` 
```

我在上面的例子中使用了 R Markdown 语法。关键在于`results='asis'`将原始 HTML 代码写入输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T15:39:33.033

我相信您也可以使用 Sweave 创建 HTML 文件，尽管我听说 knitr 更易于使用。*

# c# - 如何修复“microsoft.maintainability”构建错误？

> ID：13086276
> 
> 赞同：2
> 
> 时间：2012-10-26T11:41:24.737
> 
> 标签：c#, asp.net-mvc

我有一个控制器，其中包含一些私有只读接口属性，它需要这些属性才能通过调用服务来获取数据，然后该服务用于填充模型等

```
private readonly ISomeInterface _someObject; 
```

在 Controllers 构造函数中设置：

```
public ... (ISomeInterface someInterface, ...) {
...
_someObject = someObject
} 
```

`_someObject`然后用于调用服务层以获取数据。

我不得不向控制器添加另一个属性，但现在当我构建解决方案时，我收到以下错误：

```
CA1506 : Microsoft.Maintainability : 'ControllerName' is coupled with 87 different types from 30 different namespaces. Rewrite or refactor this class's methods to decrease its class coupling, or consider moving some of the class's methods to some of the other types it is tightly coupled with. 
```

它要求我减少类的耦合，我知道这样做的一种方法是针对接口（抽象）进行编码 - 我已经通过添加接口属性来做到这一点？似乎通过再添加一个属性，它会超过标记此错误的阈值。

如果我删除它，我无法获得我需要的数据？我需要修改什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:02:02.623

你的控制器有多少个动作？你有每个动作的视图模型吗？你有每个动作的输入模型吗？您是否为每个控制器操作与不同的类进行交互？您可能需要将控制器拆分为多个控制器，以减少它的工作量，从而减少更改的理由并减少依赖项。尽管使用接口会将控制器与 ISomeInterface 的特定实现分离，但就该警告而言，它不会做任何事情。更改为使用接口并没有减少类型的数量……它只是从具体类型更改为接口类型。

问题是警告不要让一个类做很多事情。有许多依赖项表明该类做得太多，应该分开。例如，如果这个控制器对“烤馅饼”、“吃馅饼”、“制作冰淇淋”和“递送食物”说了一个动作，你可以将“递送食物”移动到一个全新的类......你可以打破也可以制作冰淇淋，然后你会评估 Bake Pie 和 Eat Pie 是应该放在同一个班级还是放在不同的班级。馅饼辩论打开了一罐人们会辩论的蠕虫。

参见：[SOLID（面向对象设计）](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)

您是否有代码必须调用 2 个或更多不同的数据访问类，然后调用另一个类来创建视图模型。您可以将整个操作移至一个新类，从而将您对 3 个类的依赖减少到 1 个。

# python - 通用视图DetailView上的Django prefetch_related

> ID：13086278
> 
> 赞同：0
> 
> 时间：2012-10-26T11:41:28.277
> 
> 标签：python, django, orm

我有这个 mixin 可以在视图上应用 prefetch_related。这是我应该处理的查询集：

```
MyMode.objects.all().prefetch_related('projects') 
```

使用这些模型：

```
class Workspace():
 name = models.CharField(max_length=255)
class Project():
 name = models.CharField(max_length=255)
 workspace = models.Foreignkey(Workspace) 
```

使用我创建的这个 mixin：

```
class PrefetchRelatedMixin(object):
    prefetch_related = None

    def get_queryset(self):
        if self.prefetch_related is None:
            raise ImproperlyConfigured(u'%(cls)s is missing the prefetch_related'
                "property. This must be a tuple or list." % {
                'cls': self.__class__.__name__})

        if not isinstance(self.prefetch_related, (tuple, list)):
            raise ImproperlyConfigured(u"%(cls)s's select_related property "
                "must be a tuple or list." % {"cls": self.__class__.__name__})

        queryset = super(PrefetchRelatedMixin, self).get_queryset()

        return queryset.prefetch_related(
            ", ".join(self.prefetch_related)
        ) 
```

在这样的视图中调用：

```
class WorkspaceView(DetailView):
    prefetch_related = ['projects']
    model = Workspace

    def get_queryset(self):
        return super(WorkspaceView, self).get_queryset() 
```

但是，当我尝试遍历模板中的相关对象时：

```
{% for p in object.projects %}
    <li>{{ p.name }}</li>
{% empty %}
    <li>No Projects in this Workspace</li>
{% endfor %} 
```

我收到此错误：

```
'RelatedManager' object is not iterable 
```

mixin 中是否有某些东西改变了对象以使其返回 RelatedManager？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T17:49:02.590

@danihp 有它：你需要`.all`.

这里还有一个错误：

```
return queryset.prefetch_related(
            ", ".join(self.prefetch_related)
        ) 
```

应该读

```
return queryset.prefetch_related(*self.prefetch_related) 
```

`prefetch_related`接受多个字符串参数，而不是单个逗号分隔的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:45:10.223

[prefetch_related](https://docs.djangoproject.com/en/dev/ref/models/querysets/#prefetch-related)是 RelatedManager，你应该执行方法来获取结果：

在文档示例中：

```
>>> pizzas = Pizza.objects.prefetch_related('toppings')
>>> [list(pizza.toppings.filter(spicy=True)) for pizza in pizzas] 
```

对于您的场景：

```
{% for p in object.projects.all %} 
```

# html - 是否可以在 twitter bootstrap 框架中向 html select 添加字形图标？

> ID：13086281
> 
> 赞同：2
> 
> 时间：2012-10-26T11:41:37.857
> 
> 标签：html, css, twitter-bootstrap

我知道如何将字形图标添加到 twitter 引导框架中的 html 输入元素。可以在这里找到示例[http://techieninjas.files.wordpress.com/2012/04/52.jpg](http://techieninjas.files.wordpress.com/2012/04/52.jpg)（输入字段附近的信封图标）

我的问题是 - 是否可以将相同的字形图标添加到 html 选择而不是输入？如果是这样，你能提供一个例子吗？谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T20:28:39.297

使用 select2 可能会更幸运：http: [//ivaynberg.github.com/select2/](http://ivaynberg.github.com/select2/)

此外，这可作为 Kickstrap 应用程序使用~~[http://getkickstrap.com/apps/permalink/select-2-52238/](http://getkickstrap.com/apps/permalink/select-2-52238/)~~

**更新**

Kickstrap 2 现在使用 RequireJS 功能来加载应用程序，使其更具跨功能性。在 K2 中，Select2 可以像在任何其他 html 文档上一样加载，也可以通过[System.js 加载](https://github.com/systemjs/systemjs)。

[GetKickstrap.com](http://getkickstrap.com)

# ruby - Ruby EventMachine PeriodicTimer 混乱

> ID：13086289
> 
> 赞同：0
> 
> 时间：2012-10-26T11:42:01.883
> 
> 标签：ruby, eventmachine

在 Ruby EventMachine 中创建 PeriodicTimer 时，它非常不准确，并且似乎随机且不正确。我想知道是否有办法解决这个问题，或者我是否可能以错误的方式使用它。

下面是一个例子。我有一个 PeriodicTimer，它每 10 秒拉一个全局数组（其中包含 mysql 语句）并执行 mysql 命令。像这样运行它时，PeriodicTimer 可能只每隔几分钟就会这样做一次，或者它会在一段时间后完全停止这样做，以及其他奇特的异常。

```
Eventmachine::run {

  EM::PeriodicTimer.new(10) {
    mysql_queue = $mysql_queue.dup
    $mysql_queue = []
    mysql_queue.each do |command|
      begin
        Mysql.query(command)
      rescue Exception => e
        puts "Error occured.. #{e} #{command}"
      end
    end
  }

  # Here follow random tasks/loops that are adding mysql statements to $mysql_queue
  100_000.times {
    if ...
      $mysql_queue << "INSERT INTO `...` (...) VALUES (...);"
    end
  }
  ...
  # ...

} 
```

如果您想知道，我喜欢使用这样的“Mysql 队列”，因为它可以防止竞争条件。实际上，这实际上是一个小型 TCP/IP 客户端，它处理多个并发连接并执行 mysql 命令以记录各种操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:44:31.857

你希望这段代码做什么？如果您不将控制权传递给 EM 循环，您为什么认为该计时器会被调用？尝试将`100_000`循环分成更小的部分：

```
10_000.times do
  EM.next_tick do
    10.times do
      if ...
        $mysql_queue << "INSERT INTO `...` (...) VALUES (...);"
      end
    end
  end
end 
```

在这里使用全局 $ 是一个坏主意，如果您使用的线程可能会访问它，那么它不是很干净。

# jquery-ui - jqgrid在选择选项时自动完成重新加载网格

> ID：13086292
> 
> 赞同：0
> 
> 时间：2012-10-26T11:42:19.340
> 
> 标签：jquery-ui, jqgrid-asp.net

我正在编写一段代码，其中我有一个 jqgrid 和一个顶部带有文本框的过滤器，我使用了 jquery ui 自动完成功能，一切正常，但我现在需要自定义功能，即当我自动完成结果时选择一个选项，它应该使用选定的结果过滤网格。以下是下面给出的示例：

```
 // i am doing a search on the textbox with auto complete feature
    grid.jqGrid('setColProp', 'Name',
    {
        searchoptions: {
        sopt:['cn'],
        dataInit: function(elem) {
            $(elem).autocomplete({
            source:getUniqueNames('Name'),
            delay:0,
            minLength:0,
            matchContains: true,
            autoFill:true,
            select:function(event,ui){
            grid.setGridParam('postData', ui.item.value);
            //grid.jqGrid('clearGridData');
            grid.trigger('reloadGrid');
            return false;
            // need to write the code which will trigger the reload here on selection
        }
        });
        }
        }
    }); 
```

在选择功能上，我需要将所选选项加载到 jqgrid 中，我该怎么做。请提出解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T05:34:39.833

如果您已经为 jqgrid 实现了服务器端排序和分页，那么这应该很容易，您只需要重新加载 jqgrid。

要重新加载网格看到[这个](http://www.codeproject.com/Articles/201883/jqGrid-Quick-Tips)，使用这行代码

```
 $("#grid1").trigger("reloadGrid", [{current:true}]); 
```

这将重新加载 jqgrid，您可以在其中传递参数`postData:`并获取过滤后的数据。

# drupal - 在本地 Drupal 7 站点上启用新模块时遇到问题

> ID：13086293
> 
> 赞同：1
> 
> 时间：2012-10-26T11:42:21.087
> 
> 标签：drupal

我已经创建了我的 Drupal 网站的本地版本来进行开发工作。但是，当我将新模块添加到本地版本时，它们会安装，但无法正确启用。例如我添加了法律模块，启用它，但是当我去站点配置编辑它时，法律部分没有出现。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:44:07.753

问题是没有足够的内存分配给服务以允许运行需要更多内存的新模块，尝试把

```
ini_set('memory_limit', '256M'); 
```

在`sites/default/settings.php`文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T03:13:53.510

这是一个非常古老的线程，但认为值得添加以下内容。

我最近在本地开发安装中遇到了这个问题（顺便说一下，使用 Acquia Dev Desktop）。关闭 Memcache 模块解决了我的问题。

# android - 自定义 ListView 中 super.onMeasure 的 Android NullPointerException

> ID：13086295
> 
> 赞同：1
> 
> 时间：2012-10-26T11:42:27.280
> 
> 标签：android, android-listview

我有这个简单的自定义 ListView：

```
public class ChildListView extends ListView {

    private static final int ROW_HEIGHT = 43;

    private Context mContext;

    private int mRowCount = 0;

    public ChildListView(Context context) {
        super(context);
        mContext = context;
    }

    public ChildListView(Context context, int numRows) {
        super(context);
        mContext = context;
        mRowCount = numRows;
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        setMeasuredDimension(getMeasuredWidth(), mRowCount * Helper.dipToPx(mContext, ROW_HEIGHT));
    }

} 
```

我必须测量列表的高度，因为它是 ExpandableListView 的子项。
更多信息：在我向 ChildListView 的适配器添加另一个视图之前，它工作正常。现在它有两个视图，但我有这个例外：

```
10-26 14:33:43.781: E/AndroidRuntime(10138): FATAL EXCEPTION: main
10-26 14:33:43.781: E/AndroidRuntime(10138): java.lang.NullPointerException
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.ListView.measureScrapChild(ListView.java:1135)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.ListView.onMeasure(ListView.java:1104)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at package.views.ChildListView.onMeasure(ChildListView.java:38)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.View.measure(View.java:8526)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3228)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1017)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.measureHorizontal(LinearLayout.java:701)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:311)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.View.measure(View.java:8526)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.ListView.setupChild(ListView.java:1869)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.ListView.makeAndAddView(ListView.java:1796)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.ListView.fillDown(ListView.java:670)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.ListView.fillSpecific(ListView.java:1350)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.ListView.layoutChildren(ListView.java:1624)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.AbsListView.onLayout(AbsListView.java:1260)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.View.layout(View.java:7277)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.View.layout(View.java:7277)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.View.layout(View.java:7277)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.View.layout(View.java:7277)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.View.layout(View.java:7277)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.ViewRoot.performTraversals(ViewRoot.java:1203)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1957)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.os.Handler.dispatchMessage(Handler.java:99)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.os.Looper.loop(Looper.java:150)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at android.app.ActivityThread.main(ActivityThread.java:4277)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at java.lang.reflect.Method.invokeNative(Native Method)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at java.lang.reflect.Method.invoke(Method.java:507)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
10-26 14:33:43.781: E/AndroidRuntime(10138):    at dalvik.system.NativeStart.main(Native Method) 
```

它被扔在这条线上：

```
super.onMeasure(widthMeasureSpec, heightMeasureSpec); 
```

感谢任何帮助！

# javascript - 使用下划线的 Javascript 对象中不同的总和

> ID：13086302
> 
> 赞同：1
> 
> 时间：2012-10-26T11:42:58.263
> 
> 标签：javascript, underscore.js

只是刚刚介绍给[_Underscore](http://underscorejs.org)，所以这可能完全是胡说八道，但我想知道图书馆是否真的可以做我想做的事。

我有一个包含 5 个项目的对象：

```
Name, v2007,v2008,v2009,v2010 
```

我只是想遍历整个对象并获取其中每个不同值的 SUM `Name`（非常类似于 SQL 的 GroupBy 和 SUM）。

我有以下内容：

```
var distincts = [];
$.each(tmp, function (key, value) {
    $.each(value, function (fieldName, fieldValue) {
        if (fieldName == 'Name') {
            if ($.inArray(fieldValue, distincts) == -1) {
                distincts.push(fieldValue);
            }
        }
    });
});

$.each(distincts, function (a, b) {
    var t = _.where(tmp, {Name: b});
    var sum = _.reduce(t.v2007, function (memo, num) {
        return memo + num;
    }, 0)
    console.log(sum);
}); 
```

一直返回 0 ，实际上我不确定如何检索字段的 SUM `v2011`，`v2013`除了对它们进行硬编码，这根本不切实际！

有人可以在这里帮助我吗，有没有一种简单的方法可以让 _Underscore 库基于名称组对所有字段进行求和（例如，以“v”开头）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T13:20:39.903

我认为这可以满足您的要求：

```
var groups = _.groupBy(function(name) { return name.charAt(0) });
var sums = _.map(groups, function(group) {
    return _.reduce(group, function (a, b) { return a+b; }, 0);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-06T18:46:48.030

这是我想出的一种方法，它将获取一个对象数组并返回一个对象，其中对象的“键”是分组值，对象的“值”是聚合值：

```
function groupBy(input, xCol, yCol) {

    var output = {};

    // This function can be easily changed to do max, min, avg, sum.
    var sum = function(row, idx) {
        if (!(row[xCol] in output)) {
            output[row[xCol]] = row[yCol];
        }
        else {
            output[row[xCol]] += row[yCol];         
        }
    };
    _.each(input, sum);

    return output;
} 
```

和一个测试：

```
var input = [ {
    pn : "M1",
    date : "2014-01-01T00:00:00Z",
    qty : 1
}, {
    pn : "M1",
    date : "2014-01-01T00:00:00Z",
    qty : .5
}, {
    pn : "M2",
    date : "2014-01-04T00:00:00Z",
    qty : 2
} ];

it('should group by abc value, showing max.', function() {
    expect(groupBy(input, "pn", "qty")).toEqual({
        "M1" : 1.5,
        "M2" : 2
    });
}); 
```

这个答案只是名义上对 foreach 循环使用下划线。

# c# - XAML 中的单元格编辑模板

> ID：13086303
> 
> 赞同：1
> 
> 时间：2012-10-26T11:43:06.260
> 
> 标签：c#, wcf, silverlight, xaml

我在 silverlight 中创建了一个数据网格，其中包含所有文本框（使用 CellEditingTemplate）..![在此处输入图像描述](../Images/81429bb47ad3b6d5189cdb1024ef8506.png)

单击保存按钮时，我想将行数据网格中存在的文本框的数据插入数据库。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:34:44.007

首先你应该创建你的视图模型类。

```
public class Person 
{
  public int ID {get;set;}
  public string Name {get;set;}
  public string Address {get;set;}
  public int Age {get;set;}
} 
```

然后创建此类的 Observable Collection 并将网格项目源绑定到它。在您的模板中将每一列绑定到它在 Person 中的属性。

当您在后面的代码中按下保存按钮时，您应该调用网格的提交编辑，然后您的所有数据都将反映到您的 observableCollection ...然后您可以将数据保存到数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T08:39:15.103

我用它解决了

```
List<string> list = new List<string>();
dataGrid.ItemsSource = list;
TextBox txt = this.dtgrd.Columns[0].GetCellContent(list[0]) as TextBox; 
```

它获取了插入以下代码的文本框，因此获取了存储在文本框中的值。

```
<sdk:DataGridTemplateColumn Header="ID" Width="*">
    <sdk:DataGridTemplateColumn.CellEditingTemplate>
        <DataTemplate>
            <TextBox Name="txt_ID" />
        </DataTemplate>
    </sdk:DataGridTemplateColumn.CellEditingTemplate>
</sdk:DataGridTemplateColumn> 
```

现在可以使用 List 轻松存储获取的值。

# c - 在特定 (x,y) 坐标处评估三角形

> ID：13086306
> 
> 赞同：2
> 
> 时间：2012-10-26T11:43:25.177
> 
> 标签：c, math, 3d, geometry, computational-geometry

给定：3D 空间中的 3 个三角形顶点，该三角形上一个点的 x,y 坐标（包括三角形区域）。

Wanted：给定点的 z 坐标。

所有 3 个三角形顶点都有不同的 (x,y) 坐标（它们是高度图坐标），因此不需要处理多个（无限）匹配的情况。

我正在尝试在 C 中执行此操作，这意味着对简单数字类型（例如浮点数）进行操作的算法将是最好的（没有矩阵或向量操作）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:58:07.153

这通常使用向量/矩阵来完成，它们只是底层操作的较短符号。

*   从三个顶点中选择一个参考点 O = (ox, oy) = Point1
*   制作两个向量 U=(ux,uy) = point2 - O; V=(vx,vy) = 点 3 - O

*   求解 u 和 v 的线性系统 x,y = u*U + v*V

    x = u * (p2x-ox) + v * (p3x-ox)
    y = u * (p2y-oy) + v * (p3y-oy)

检查 0 <= u,v <= 1 和 0<=u+v<=1
如果是，则点 x,y 在三角形内且
z = u*(p2z-oz)+v*(p3z-盎司）

# blackberry - 如何在 BrowserField 中加载 HTML 页面？

> ID：13086312
> 
> 赞同：2
> 
> 时间：2012-10-26T11:43:51.753
> 
> 标签：blackberry, browserfield

我有一个 HTML 页面显示我想在 BrowserField 中显示的地图。这是我的代码。

```
BrowserFieldConfig _bfConfig = new BrowserFieldConfig();
_bfConfig.setProperty(BrowserFieldConfig.NAVIGATION_MODE,BrowserFieldConfig.NAVIGATION_MODE_POINTER);
_bfConfig.setProperty( BrowserFieldConfig.JAVASCRIPT_ENABLED, Boolean.TRUE );
_bfConfig.setProperty(BrowserFieldConfig.USER_AGENT, "MyApplication 1.0");

BrowserFieldRequest request = new BrowserFieldRequest("page.html");
BrowserField myBrowserField = new BrowserField(_bfConfig);
add(myBrowserField);

myBrowserField.requestContent(request); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T05:20:02.087

**如果“page.html”是本地文件，那么，**

一切都很好，除了这里：

```
BrowserFieldRequest request = new BrowserFieldRequest("page.html"); 
```

在这里更改如下：

```
BrowserFieldRequest request = new BrowserFieldRequest("local:///page.html"); 
```

您正在调用本地文件，这就是我们提供这样的原因。

# c# - 执行资源文件夹中包含的文件

> ID：13086315
> 
> 赞同：3
> 
> 时间：2012-10-26T11:44:01.097
> 
> 标签：c#, wpf, resources

在 WPF 应用程序中，我在资源中包含了一些文件，我想在单击按钮时执行它们。如何在`Process.Start()`.

```
private void button1_Click_2(object sender, RoutedEventArgs e)
{
    Process.Start("test.txt");    
} 
```

或者还有其他方法吗？

* * *

```
private void button1_Click_2(object sender, RoutedEventArgs e)
{
    string path = System.IO.Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location) + @"\test.txt";
    if (File.Exists(path))
    {
        Process.Start(new ProcessStartInfo(path));
    }
    else
    {
        MessageBox.Show("No file found"+path);
    } 
```

我添加了一个消息框，它显示没有找到文件。:(

编辑：我试图在发布后检查路径，这就是我得到的。找不到带有路径的文件 - C:\Users\Administrator\AppData\Local\Apps\2.0... test.txt

在我发布应用程序之前，我得到了一个路径，其 id No File Found at ..project..\bin\Debug\test.txt 这很明显，因为我的资源文件没有包含在它的资源文件夹下，而不是当我添加一个调试中的测试文件打开没有任何问题。

有人可以帮助解释一下这个案子。

编辑：

我想从资源目录 @ C:\Users\Administrator\Documents\Visual Studio 2010\Projects\FastFix\FastFix\Resources 打开一个文件，当我要发布它时将包含在我的项目中，它将作为无需安装的独立应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:49:20.850

用这个

```
 string path = System.IO.Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location) + @"\test.txt";
                    if (File.Exists(path))
                    {
                        Process.Start(new ProcessStartInfo(path));                            
                    } 
```

# php - 如何将 PHP 的 crc32 哈希转换为 MySQL 等价物？

> ID：13086316
> 
> 赞同：8
> 
> 时间：2012-10-26T11:44:01.943
> 
> 标签：php, sql, hash

显然 MySQL 的 CRC32() 函数返回一个无符号 BIGINT，而 PHP 返回十六进制值。

在 PHP 中：

`hash('crc32','hello world') == 7813f744`

在 MySQL 中：

`SELECT CRC32('hello world') == 222957957`

PHP CRC32 值存储在 CHAR(8) 列中。

我不知道如何将 PHP 生成的哈希转换为 MySQL*仅使用 SQL*生成的相同值。显而易见的似乎不起作用：

`SELECT HEX(CRC32('hello world')) == D4A1185`

`SELECT CONV('7813f744',16,10) == 2014574404`

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-01T12:37:17.440

如果你有 64 位平台，你可以在 PHP 和MySQL中安全地使用[crc32函数。](http://php.net/manual/en/function.crc32.php)`CRC32`快速测试：

```
 php > echo crc32('foobar') . "\n";
  2666930069 
```

MySQL：

```
 >select crc32('foobar');
  +-----------------+
  | crc32('foobar') |
  +-----------------+
  |      2666930069 |
  +-----------------+
  1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-26T18:23:50.430

可以使用返回与 mysql 中相同的值的包装函数：

```
function mysql_compatible_crc32($s) {
    $r = crc32($s);
    if($r<0) {
        return 4294967296+$r;
    }
    return $r;
} 
```

# python - 使用 Python/C API 将解释器中 PyStrings 的值作为 C 程序中的 CStrings 获取

> ID：13086318
> 
> 赞同：4
> 
> 时间：2012-10-26T11:44:20.510
> 
> 标签：python, c, api, get

我一直在搞乱 Python/C API 并拥有以下代码：

```
#include <Python.h>
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[]) {
    //Initialize Python
    Py_Initialize();

    //Run file
    FILE *fp = fopen("Test.py", "r");

    PyRun_SimpleFile(fp,"Test.py");

    fclose(fp);

    //Run Python code
    PyRun_SimpleString("print(__NAME__)");
    PyRun_SimpleString("print(__DESC__)");
    PyRun_SimpleString("print(__SKIN__)");
    PyRun_SimpleString("onEnable()");

    //Finalize Python
    Py_Finalize();

    return EXIT_SUCCESS;
} 
```

Test.py 包含以下内容：

```
__NAME__ = "Frank"
__DESC__ = "I am a test script"
__SKIN__ = "random image"

def onEnable():
    print("In Func") 
```

如您所料，编译和运行 c 程序会导致：

坦率

我是测试脚本

随机图像

在功能

但是，我需要一种从解释器获取 python 字符串的方法，将它们粘贴到 C 字符串中，然后打印它们，而不是使用 PyRun_SimpleString("print(blah)")。

例如：

```
char *__NAME__;
__NAME__ = Py_GetObject("__NAME__") 
```

这可能吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:22:57.057

您需要使用[PyString_AsString](http://docs.python.org/c-api/string.html#PyString_AsString)。我认为它是这样的：

```
PyObject* module = PyImport_AddModule("__main__");
PyObject* o = PyObject_GetAttrString(module , "__NAME__");
if (PyString_Check(o))
{
    const char* name = PyString_AsString(o);
    // don't delete or modify "name"!
}
Py_DECREF(o); 
```

# php - GD 创建模式

> ID：13086319
> 
> 赞同：3
> 
> 时间：2012-10-26T11:44:33.550
> 
> 标签：php, gd

如何创建这样的模式：

![](../Images/965a46f7beeb06b3452ca4014a6dceea.png)

[![](../Images/b39aad7531bf68208f8e840a0156d97f.png)](https://i.stack.imgur.com/OG22h.png)

[![](../Images/56f5f79a57227cbdb86e355f9a3a0b84.png)](https://i.stack.imgur.com/0KpAn.png)

从带有GD的PHP中的单个图像？

我已经尝试了很多，但我认为它可以更容易地完成。

我的想法：用 imagefilledrectangle 填充一行。对于第二行，用左右边距填充它（对于我的第一个示例）。接下来将图像切成两块并用它填充边距并为每一行重复此操作。

我希望有人可以帮助我:)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T18:31:29.230

对于任何类型的图案效果，我推荐以下之一：

1.  手动执行模式：

    ```
    <?php
    $srcimg = imagecreatefromgif('data:image/gif;base64,R0lGODlhFAAUAPcAAAICAgICAxkWBxoYBysoC0VCD1JODVtXDF5ZDl1YD15aEGNeDmFcEG1oDm9qDGZhEGhjEWxoE3FsDXVvFnZwB3VwDXlyB3t0BXt0B3x0BX53BndxEXdyEHhzE3t2EX95EH95KIN7BIV9BIZ+BYd/BoN+DIF6EYJ7E4N+NIR+N4eABoiABYqDBYmCBoyFBo2GBY2FDo2HDY2IDo+JD4eBEYuDEImDEoqEEZSNB5WPB5GJDpKLE5OMEJuTCZ2VCJ2WCJ+YCZiRFJ2WFoiCLo6JLoaBNpCML5OOP6CZCaCaCaGaCqCZDaObDaOdCaOcC6OcDaSbCaSdCaWdC6aeCKaeCaWeCqafC6aeDKGZEaOcEaafJ6mhDayjCq2kCq2kC6+mC6+lDK+oCaqjE6uiF7CnC7CoCrGoC7OrC7OrDbSrDLWtC7SsDLauDLauDbmwC7qxDLiwDbuyDLqyDbu0DbyzDbyzDr20DLy0DbuxErmwF7qyFL2zEr61EL21FaiiKY6KTJKOUJWQRZuWQJ2YRcG3DcC2DsK4DsG4D8S6DsS7D8e9Dsa8D8i+D8K5EcW8E8i/FcrAD83DD8vCEMzBEM3CEM7EEM/FEdHHD9DFENHGENHHEdDHFNLIENPJE9TKEdXLE9bMEtbME9rPE9rQE93SE97UE97UFOHVE+LWE+TYFOTYFebbFOfcFujcFeneFOreFevfFuvgFezhFe/jFvHlFvHmFfLnFvXrF/PoGvTrGPnsGfvxG/vyGfzzGvz2HP36IP37I/37Nfz7Nv39PtzXct7aef38TP38Tujhb+zleaypgLGuhrKwhLSxh726mLy6m8LAmsLBn8vImdrWktrXk8XDpMTCpsbDp8XEqfXwjvbxkf39kvz7v9vazeblxefmxuHg2Ono2uno3vz7wf791v7+2PHx5vLy5/Hw6/Py6PLy6fLy7f7/9P7/9f38+fz8+vz8+/39/P7+/f7+/v///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAUABQAAAj/AOkJFDivHbdsyYpN8+Zu3sCH9Oax2xbM161XpTK50SINnkOI5YwB22XrVSpSnigdgjIo3ceI5Ib94oVLCCtUojrRaBQnChF18gSyO/arl64xAfKQAiUmwI07aXoEehdxGzBeump1AGBjlCcTARbYWcOFhLOCwnbdoiUrQoAPoTJxCHCADpsuP0DAG+fL1ixYq04E2MGpUo0ADeSs+VIFQzdtuWK1SnWqzwBHlibhEZAFzhovVkY8Q+ZK1SlSo0BtskSJESI+ctig8VKFhTJipoIUeOTpUiVJrgnRgaNmCYESLZZR0/RpgiZMkSApQlToDpw2Z8AocBLC2rc3lDzooIHEaJGhQnNirwkDo4ISCuDc+TG050Gi83fkwGGzpowXA0/gkII880gzRRw8bFCHfm2scQYZXiAgAxIXYCOQO4JUscYMCWDhoBlf6GBADEqo8IdHAp1jhA9dbOEAAxA8kIAETCSxAgroPDSPOUe0AAQVVFwhRRNK5JABIOtARI8870AzhAYrvOCCCBYUcU08ShK0ZDjRMNNMNeI49BI9AQEAOw==');
    $sw = imagesx($srcimg);
    $sh = imagesy($srcimg);

    $dw = 500;
    $dh = 500;
    $destimg = imagecreatetruecolor($dw, $dh);

    // Switch statement for the patterns you listed...
    switch (0) {
      case 0 :
        $px = 0;
        for ($y = 0; $y < $dh; $y += $sh) {
          $px = ($px - ($sw / 2)) % $sw;
          for ($x = $px; $x < $dw, $x += $sw) {
            imagecopy($destimg, $srcimg, $x, $y, 0, 0, $sw, $sh);
          }
        }
        break;
      case 1 :
        $py = 0;
        for ($x = 0; $x < $dw; $x += $sw) {
          $py = ($py - ($sh / 2)) % $sh;
          for ($y = $py; $y < $dh, $y += $sh) {
            imagecopy($destimg, $srcimg, $x, $y, 0, 0, $sw, $sh);
          }
        }
        break;
      case 2 :
        for ($y = 0; $y < $dh; $y += 2 * $sh) {
          for ($x = $px; $x < $dw, $x += 2 * $sw) {
            imagecopyresized($destimg, $srcimg, $x, $y, $sw, $sh, $sw,$sh,-$sw,-$sh);
            imagecopyresized($destimg, $srcimg, $x+$sw,$y, 0,$sh, $sw,$sh,   0,-$sh);
            imagecopyresized($destimg, $srcimg, $x,$y+$sh, $sw,0, $sw,$sh,-$sw,   0);
            imagecopyresized($destimg, $srcimg, $x+$sw,$y+$sh,0,0,$sw,$sh,   0,   0);
          }
        }
        break;
    }

    header('Content-Type: image/png');
    imagepng($destimg);
    ?> 
    ```

2.  像上面一样手动做图案，但只创建一个小图案 [0:(sw,sh*2), 1:(sw*2, sh), 2:(sw*2, sh*2)] 并用于`imagesettile`填充具有该图案的图像。

    ```
    <?php
    // $src and $dest as above, except:
    $dw = $sw * 2;
    $dh = $sh * 2;

    // Now copy the entire switch statement from above; the loops can be reduced
    // to 4-5 `imagecopy` statements each instead of loops if you want.

    // Create the actual output image:
    $outputimg = imagecreatetruecolor(500, 500);
    // Set tile and use the fill functions...
    imagesettile($outputimg, $destimg);
    imagefilledellipse($outputimg, 250, 250, 500, 500, IMG_COLOR_TILED);

    header('image/png');
    imagepng($outputimg);
    ?> 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T10:49:53.467

抱歉我迟到了，同时我为此使用了 Imagick，具有以下效果：

```
<?php
$output_h   = 500;
$output_w   = 500;
$image_size = 100;
$src    = 'input.jpg';
$output = 'output.jpg';

//Centering
exec('convert '.$src.' -resize '.$image_size.' -background white -gravity center -extent '.$output_w.'x'.$output_h.' '.$outfile);

//Mirror
exec('convert '.$src.' -resize '.$image_size.' \( -clone 0 -flip \) -append -write mpr:sometile +delete -size '.$output_w.'x'.$output_h.' tile:mpr:sometile '.$outfile);

//Half drop vertical
exec('convert '.$src.' -resize '.$image_size.' -format "%[fx:round(h/2)]" info:',$result);
exec('convert '.$src.' -resize '.$image_size.' \( -clone 0 -roll +0+'.$result[0].' \) +append -write mpr:sometile +delete -size '.$output_w.'x'.$output_h.' tile:mpr:sometile '.$outfile);

//Half drop horizontal
exec('convert '.$src.' -resize '.$image_size.' -format "%[fx:round(w/2)]" info:',$result);
exec('convert '.$src.' -resize '.$image_size.' \( -clone 0 -roll -'.$result[0].'-0 \) -append -write mpr:sometile +delete -size '.$output_w.'x'.$output_h.' tile:mpr:sometile '.$outfile);

//Fill
exec('convert '.$src.' -resize '.$image_size.' +append -write mpr:sometile +delete -size '.$output_w.'x'.$output_h.' tile:mpr:sometile '.$outfile);
?> 
```

# objective-c - 在 iPad 应用程序中复制 Web 应用程序功能

> ID：13086326
> 
> 赞同：2
> 
> 时间：2012-10-26T11:45:17.733
> 
> 标签：objective-c, ios, ipad, webview

如何在 iOS 应用程序中复制 Web 应用程序的以下功能：成功登录、单击按钮并加载新网页

这就是我打算做的事情：在 iOS 应用程序中，我可以在单击按钮时调用一个新 URL，传递登录凭据并从服务器获取所需的网页并加载到 web 视图中。

有没有其他方法可以实现这一目标？在不调用新 URL 的情况下，当我单击 iPad 中的按钮时，我能否以某种方式登录到 Web 应用程序（在 iPad 的浏览器中）并在浏览器中显示页面？

# automapper - 使用 automapper 从 dto 反转映射

> ID：13086334
> 
> 赞同：0
> 
> 时间：2012-10-26T11:45:40.820
> 
> 标签：automapper

给定以下代码，是否有让 Automapper 执行此操作而不是手动设置属性？我试图避免在 Mapper.CreateMap 上进行一对一的映射，因为我不断地在 Contract 中添加和删除字段，并且此刻必须记住使用更改来更新此方法。

```
private void MapModelToContract(ContractDto model, Contract contract)
        {
            contract.Id = model.Id;
            contract.ContractDetail.BuyerCornhouseName = model.ContractDetailBuyerCornhouseName;
            contract.ContractDetail.CnoCornLtdToBuyer = model.ContractDetailCnoCornLtdToBuyer;
            contract.ContractDetail.CnoCornPartToCornLtd = model.ContractDetailCnoCornPartToCornLtd;
            contract.ContractDetail.CnoSellerCornLtd = model.ContractDetailCnoSellerCornLtd;
            contract.ContractDetail.CnoSellerCornPart = model.ContractDetailCnoSellerCornPart;
            contract.ContractDetail.Commission = model.ContractDetailCommission;
            contract.ContractDetail.ContractPrice = model.ContractDetailContractPrice;
            contract.ContractDetail.SalesPriceToCornLtd = model.ContractDetailSalesPriceToCornLtd;
            contract.ContractDetail.ContractedQuantity = model.ContractDetailContractedQuantity;
            contract.ContractDetail.CostWarehouseToFob = model.ContractDetailCostWarehouseToFob;
            contract.ContractDetail.Date = model.ContractDetailDate;
            contract.ContractDetail.DeliveryDate = model.ContractDetailDeliveryDate;
            contract.ContractDetail.FinalBuyerName = model.ContractDetailFinalBuyerName;
            contract.ContractDetail.FinalSalesPrice = model.ContractDetailFinalSalesPrice;
            contract.ContractDetail.Grade = model.ContractDetailGrade;
            contract.ContractDetail.Notes = model.ContractDetailNotes;
            contract.ContractDetail.PayableQuantity = model.ContractDetailPayableQuantity;
            contract.ContractDetail.SalesShipmentPeriod = model.ContractDetailSalesShipmentPeriod;
            contract.ContractDetail.SellerName = model.ContractDetailSellerName;
            contract.ContractDetail.ToBePaidBy = model.ContractDetailToBePaidBy;
            contract.ContractDetail.SalesBasis = model.ContractDetailSalesBasis;
            contract.ContractDetail.SalesFreightValue = model.ContractDetailSalesFreightValue;

            contract.CurrencyContract.Date = model.CurrencyContractDate;
            contract.CurrencyContract.ExchangeRate = model.CurrencyContractExchangeRate;
            contract.CurrencyContract.Number = model.CurrencyContractNumber;
            contract.CurrencyContract.Value = model.CurrencyContractValue;
            contract.CurrencyContract.IsAcc = model.CurrencyContractIsAcc;
            contract.CurrencyContract.RepaidOn = model.CurrencyContractRepaidOn;
            contract.CurrencyContract.RepaymentDate = model.CurrencyContractRepaymentDate;

            contract.Discounts.Reason = model.DiscountsReason;
            contract.Discounts.Value = model.DiscountsValue;

            contract.DocumentControl.GuaranteeLetterReceived = model.DocumentControlGuaranteeLetterReceived;
            contract.DocumentControl.PhotosReceived = model.DocumentControlPhotosReceived;

            contract.GoodsStatus.ContainerNumber = model.GoodsStatusContainerNumber;
            contract.GoodsStatus.EtaPort = model.GoodsStatusEtaPort;
            contract.GoodsStatus.ExpectedDeliveryDate = model.GoodsStatusExpectedDeliveryDate;
            contract.GoodsStatus.Port = model.GoodsStatusPort;
            contract.GoodsStatus.ShippedStatus = model.GoodsStatusShippedStatus;
            contract.GoodsStatus.VesselDeadline = model.GoodsStatusVesselDeadline;
            contract.GoodsStatus.VesselName = model.GoodsStatusVesselName;
            contract.GoodsStatus.HasSellerConfirmedRelease = model.GoodsStatusHasSellerConfirmedRelease;
            contract.GoodsStatus.ReceivedShippingInstructions = model.GoodsStatusReceivedShippingInstructions;
            contract.GoodsStatus.Notes = model.GoodsStatusNotes;

            contract.NotaFiscalCornPart.Date = model.NotaFiscalCornPartDate;
            contract.NotaFiscalCornPart.ExchangeRate = model.NotaFiscalCornPartExchangeRate;
            contract.NotaFiscalCornPart.Number = model.NotaFiscalCornPartNumber;

            contract.NotaFiscalSeller.Date = model.NotaFiscalSellerDate;
            contract.NotaFiscalSeller.GoodsReleased = model.NotaFiscalSellerGoodsReleased;
            contract.NotaFiscalSeller.Number = model.NotaFiscalSellerNumber;

            contract.TransferToSeller.Date = model.TransferToSellerDate;
            contract.TransferToSeller.TransferredFrom = model.ContractDetailBuyerCornhouseName;
            contract.TransferToSeller.Value = model.TransferToSellerValue;

            contract.CommissionLawyer.IsPaid = model.CommissionLawyerIsPaid;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T06:40:00.760

下面的映射器适合你。

如果 Source ( `ContractDto`) 和 Destination ( `Contract`) 具有相同的属性名称。

```
Mapper.CreateMap<ContractDto, Contract>(); // Maps if ContractDto & Contract have same property names 
```

如果 Source ( `ContractDto`) 和 Destination ( `Contract`) 具有不同的属性名称。然后

```
Mapper.CreateMap<ContractDto, Contract>()
    .ForMember(destination => destination.BuyerCornhouseName, options => options.MapFrom(source => source.ContractDetailBuyerCornhouseName))
    .ForMember(destination => destination.CnoCornLtdToBuyer, options => options.MapFrom(source => source.ContractDetailCnoCornLtdToBuyer));

    // Explicitly you have specify for other properties also 
```

# boost - boost::shared_ptr 引用？

> ID：13086344
> 
> 赞同：0
> 
> 时间：2012-10-26T11:46:06.047
> 
> 标签：boost, synchronization, boost-asio, shared-ptr

我需要类似的东西：

```
boost::shared_ptr<A>  _class(...);

//Start async operation
boost::aiso::post(_class);

_class.relase();

while(_class)     // not working
{
   LOG("Wait for aync operation to complete");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:36:44.587

是的，它是安全的，因为`post`复制了它的论点（我猜你的意思是`io_service_.post()`）。[请参阅此处](http://www.boost.org/doc/libs/1_51_0/libs/smart_ptr/shared_ptr.htm#ThreadSafety)的文档。

但是在你调用之后`_class.release()`，`!!_class`将永远是`false`，所以`while(_class)`永远不会执行循环体。

# silverstripe - Silverstripe 类似 tumblr 的帖子类型

> ID：13086347
> 
> 赞同：0
> 
> 时间：2012-10-26T11:46:17.807
> 
> 标签：silverstripe

我正在尝试为 silverstripe 创建一个后端界面，让 CMS 用户可以选择在 Silverstripe3 中的一组帖子类型（如 tumblr）之间进行选择。因此他们可以选择创建新闻帖子、视频帖子、画廊帖子等。

我最初开始为所有帖子提供每种类型的必要字段，并添加一个允许用户选择帖子类型的枚举字段。然后，我使用 forTemplate 方法来设置模板，具体取决于选择的帖子类型。

```
class Post extends DataObject {
    static $db = array(
       'Title' => 'Varchar(255),
       'Entry' => 'HTMLText',
       'Type'  => 'enum('Video, Photo, Gallery, Music')
    );

    static $many_many = array(
       'Videos' => 'SiteVideo',
       'Photos' => 'SitePhoto,
       'Songs'  => 'SiteMp3'
    );

    public function forTemplate() {
        switch ($this->Type) {
            case 'Video':
                return $this->renderWith('VideoPost');
                break;
            case 'Photo':
                return $this->renderWith('ImagePost');
                break;
            etc...
    }

    function getCMSFields($params=null) {
        $fields = parent::getCMSFields($params);        
        ...   
       $videosField = new GridField(
            'Videos',
            'Videos',
            $this->Videos()->sort('SortOrder'),
            $gridFieldConfig
        );
       $fields->addFieldToTab('Root.Videos', $photosField);

        $photosField = new GridField(
            'Photos',
            'Photos',
            $this->Photos()->sort('SortOrder'),
            $gridFieldConfig
        );
        $fields->addFieldToTab('Root.Videos', $photosField);

        return $fields;
    } 
} 
```

我希望用户能够在后端选择帖子类型，并且只显示适当的选项卡。因此，如果您选择 Video，则只会显示 Video GridField 选项卡。如果您选择照片类型，只有照片的 GridField 会显示。那么我希望能够调用类似

```
public function PostList() {
    Posts::get()
} 
```

并能够输出按日期排序的所有 PostType。

有谁知道这可能是如何实现的？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:18:57.167

那么第一部分可以使用javascript来完成。查看[本教程](http://www.ssbits.com/snippets/2011/inserting-javascript-into-a-dom-popup/)，如果您对此有任何疑问，请告诉我[文档。](http://doc.silverstripe.org/framework/en/topics/javascript)

第二部分会比较棘手，但我认为您可以使用页面控制器做一些事情。包括一个基于枚举值输出不同模板的方法，但您必须在某处设置链接。

我在 2.4.7 中使用 DataObjectManager 进行了管理，因为我有许多 DataObjects，并且都包含在一个页面中，但我不确定这在 SS3 中是否可行。

```
return $this->renderWith(array('CustomTemplate')); 
```

这行代码将使用不同的模板输出页面。您需要将其包含在方法中，然后在单击相应链接时调用该方法。

# wordpress - 从永久链接中删除未分类

> ID：13086349
> 
> 赞同：2
> 
> 时间：2012-10-26T11:46:26.623
> 
> 标签：wordpress, e-commerce, permalinks

我们目前正在将一家商店从大型卡特尔的托管解决方案升级为 wordpress 电子商务解决方案。到目前为止，它进展顺利，除了产品永久链接。在产品页面上，所有链接都采用`/products/uncategorized/*product_name*`. 我怎样才能得到它，以便它停止尝试将类别放入永久链接？可悲的是，这是无法避免的，因为已经有大量的 facebook 喜欢、评论和其他基于 url 的内容，`/products/*product_name*`并且更改为新格式将删除喜欢计数和评论。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-26T13:14:26.583

您可以使用一个插件来从 url 中删除类别库

[http://wordpress.org/extend/plugins/wp-no-category-base/](http://wordpress.org/extend/plugins/wp-no-category-base/)

```
e.g. 
**myblog.com/products/uncategorized/*product_name** 
to 
**myblog.com/products/*product_name* 
```

# midi - 声卡的选择会影响胆小的性能吗？

> ID：13086350
> 
> 赞同：0
> 
> 时间：2012-10-26T11:46:28.273
> 
> 标签：midi, sound-synthesis, soundcard

我正在开发 Web 应用程序，它将使用 timidity++ 将 midi 文件转换为 wav 文件。我知道没有声卡就不行，所以我必须有服务器。我的问题是：使用的声卡会影响生成wav文件的速度吗？如果我的问题的答案是肯定的，那么我在购买声卡时应该注意什么。有什么声卡可以推荐吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:52:50.023

声卡绝对*不*应该影响合成速度，尤其是离线进行时。事实上，诸如[MrsWatson 之](https://github.com/teragonaudio/MrsWatson)类的软件可以使用 VST 乐器插件将 MIDI 事件合成为音频文件，并且根本不需要任何声音硬件。

*免责声明：我是 MrsWatson 的作者*

# .net - 在 Visual Studio 中为每个项目提供单独的可执行文件

> ID：13086354
> 
> 赞同：0
> 
> 时间：2012-10-26T11:46:47.837
> 
> 标签：.net, visual-studio-2010, visual-studio

我有一个包含两个项目的 Visual Studio 解决方案。一个是 Windows 窗体应用程序，另一个是控制台应用程序。当我构建解决方案时，只生成一个可执行文件。这两个项目具有不同的程序集名称。如何为每个项目生成不同的可执行文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:50:50.593

如果您构建***解决****方案*（`F6`

 *```
TheConsoleApplication/bin/debug
TheWindowsApplication/bin/debug 
```

或者

```
TheConsoleApplication/bin/release
TheWindowsApplication/bin/release 
```

（假设默认布局；显然调整名称以适应）*

# php - 如何在php中从用户端动态提供对数据库的访问权限？

> ID：13086355
> 
> 赞同：2
> 
> 时间：2012-10-26T05:49:18.807
> 
> 标签：php, mysql

我必须在 php 中动态地向用户提供编辑、查看、删除数据库中的值等访问权限，以便超级管理员可以从应用程序本身更改权限。（无需打开数据库并为每个和每个用户）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T06:10:24.507

创建数据库时，您还创建了具有所需不同权限的用户，您有一个配置文件，其中每个用户都映射到特定的数据库用户，然后当您建立连接时，您已经在使用该用户具体权利。当用户登录应用程序时，您会检测到用户。

您还可以稍微更改每个用户组的站点界面，因此您不会显示与该组无关的控件或操作。

# web-services - 如何使用 cargo-maven 插件在 JBoss-5.1.0.GA 上部署 WAR 并等到部署完成后再运行集成测试？

> ID：13086357
> 
> 赞同：1
> 
> 时间：2012-10-26T11:46:57.840
> 
> 标签：web-services, integration-testing, maven-3, maven-cargo, maven-failsafe-plugin

我有一个 Maven Web 应用程序（Spring+ApacheCXF webservices）和几个集成测试（*IT.java）。我想通过使用 cargo-maven 插件部署战争文件来使用故障安全插件运行集成测试。

这是我的pom配置：

```
<plugins>
     <plugin>
        <groupId>org.codehaus.cargo</groupId>
        <artifactId>cargo-maven2-plugin</artifactId>
        <version>1.0.3</version>
        <configuration>
          <container>
            <containerId>jboss51x</containerId>
            <home>C:/jboss-5.1.0.GA</home>
            <append>false</append>
            <log>${project.build.directory}/logs/jboss51x.log</log>
            <output>${project.build.directory}/logs/jboss51x.out</output>
            <timeout>300000</timeout>
          </container>
          <configuration>
            <type>existing</type>
            <home>C:/jboss-5.1.0.GA/server/default</home>
            <properties>
              <cargo.servlet.port>8080</cargo.servlet.port>
              <cargo.jboss.configuration>default</cargo.jboss.configuration>
              <cargo.rmi.port>1099</cargo.rmi.port>
              <cargo.logging>high</cargo.logging>
            </properties>
            <deployables>             
              <deployable>
                <groupId>${project.groupId}</groupId>
                <artifactId>admin-services</artifactId>
                <type>war</type>                
              </deployable>
            </deployables>
          </configuration>
        </configuration>
         <executions>
            <execution>
                <id>start-container</id>
                <phase>pre-integration-test</phase>
                <goals>
                    <goal>deployer-deploy</goal>
                </goals>
            </execution>
            <execution>
                <id>stop-container</id>
                <phase>post-integration-test</phase>
                <goals>
                    <goal>deployer-undeploy</goal>
                </goals>
            </execution>            
        </executions>
      </plugin>

      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>failsafe-maven-plugin</artifactId>
        <executions>
          <execution>
            <goals>
              <goal>integration-test</goal>
              <goal>verify</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
</plugin> 
```

但问题是 cargo 插件部署了 WAR 文件，并且故障安全插件立即尝试执行 IntegrationTests，到那时应用程序尚未部署，因此测试失败。

使用相同的配置，我可以成功分两步运行集成测试。1\. 执行 cargo:deployer-deploy 2\. 执行集成测试

无论如何只有在货物插件部署应用程序后才能触发故障安全插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:51:32.400

我想你可以使用`pingURL`参数提供一个url来验证部署是否完成：见[http://cargo.codehaus.org/Maven2+Plugin+Reference+Guide](http://cargo.codehaus.org/Maven2+Plugin+Reference+Guide)

使用 cargo 您不必部署应用程序，还支持：[http](http://cargo.codehaus.org/Functional+testing) ://cargo.codehaus.org/Functional+testing （但这当然取决于您的测试）

# asp.net - 将 DropDownList 值放入 Linq 查询 where 子句

> ID：13086360
> 
> 赞同：1
> 
> 时间：2012-10-26T11:47:22.290
> 
> 标签：asp.net, sql, database, linq

我面临以下问题。我想要一个旁边有一个 DropDowList 的搜索字段，用户可以在其中选择他想要搜索的项目。我必须用这个 LINQ 代码来完成它，而不仅仅是一个 SQL 查询。

这是我的代码：

```
var Metadata = from m in db.Metadatas
    join mm in db.Multimedias
    on m.multimediaID equals mm.multimediaID
    where (m.   { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue) ||
           mm.  { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue))
           && mm.filetype.ToString().Contains(radiobuttonvalue) 
```

我想在区域中输入类似：“Dropdownlist.selectedvalue”的内容{这里我会从下拉列表中选择值。}

我希望你们能理解我的想法和问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:28:37.920

我不确定您为什么要在 linq 语句中加入。如果您的 Linq 已经知道对象之间的关系，则没有必要这样做，因为数据库中有一个外键关系设置。

你可以做的是：

```
var Metedata = db.Metadatas;

switch(Dropdownlist.selectedvalue)
{
  case "one":
    Metadata = Metadata.Where(m => m.{selected value field}.Contains(textboxvalue));
    break;

  case "two":
    Metadata = Metadata.Where(m => m.{selected value field}.Contains(textboxvalue));
    break;

  //More use cases
} 
```

我不确定完成后您将从列表中选择什么，但如果它涉及相关对象（例如多媒体），那么您可能需要查看 DataLoadOptions (LinqToSQL) 或 .Include() (EntityFrameworks)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:55:32.750

只需更改您的 sql 查询：

if(supportgrp.SelectedItem.Text == "全部")

sql ="SELECT * FROM QlyData where Date >='" + txtstartdate.Text + "' and Date<='" + txtenddate.Text + "'";

别的

sql ="SELECT * FROM QlyData where Date >='" + txtstartdate.Text + "' and Date<='" + txtenddate.Text + "' and suppgrp = '" + supportgrp.Text + "'";

# iphone - iOS：音频单元 RemoteIO 在 iPhone 上不起作用

> ID：13086363
> 
> 赞同：4
> 
> 时间：2012-10-26T11:47:39.633
> 
> 标签：iphone, ios, audio, microphone, audiounit

我正在尝试根据麦克风的输入创建自己的自定义音效音频单元。此应用程序允许从麦克风到扬声器的同时输入/输出。我可以使用模拟器应用效果和工作，但是当我尝试在 iPhone 上进行测试时，我什么也听不见。如果有人可以帮助我，我粘贴我的代码：

```
 - (id) init{
    self = [super init];

    OSStatus status;

    // Describe audio component
    AudioComponentDescription desc;
    desc.componentType = kAudioUnitType_Output;
    desc.componentSubType = kAudioUnitSubType_RemoteIO;
    desc.componentFlags = 0;
    desc.componentFlagsMask = 0;
    desc.componentManufacturer = kAudioUnitManufacturer_Apple;

    // Get component
    AudioComponent inputComponent = AudioComponentFindNext(NULL, &desc);

    // Get audio units
    status = AudioComponentInstanceNew(inputComponent, &audioUnit);
    checkStatus(status);

    // Enable IO for recording
    UInt32 flag = 1;
    status = AudioUnitSetProperty(audioUnit,
                                  kAudioOutputUnitProperty_EnableIO,
                                  kAudioUnitScope_Input,
                                  kInputBus,
                                  &flag,
                                  sizeof(flag));
    checkStatus(status);

    // Enable IO for playback
    status = AudioUnitSetProperty(audioUnit,
                                  kAudioOutputUnitProperty_EnableIO,
                                  kAudioUnitScope_Output,
                                  kOutputBus,
                                  &flag,
                                  sizeof(flag));
    checkStatus(status);

    // Describe format
    AudioStreamBasicDescription audioFormat;
    audioFormat.mSampleRate         = 44100.00;
    audioFormat.mFormatID           = kAudioFormatLinearPCM;
    audioFormat.mFormatFlags        = kAudioFormatFlagIsSignedInteger | kAudioFormatFlagIsPacked;
    audioFormat.mFramesPerPacket    = 1;
    audioFormat.mChannelsPerFrame   = 1;
    audioFormat.mBitsPerChannel     = 16;
    audioFormat.mBytesPerPacket     = 2;
    audioFormat.mBytesPerFrame      = 2;

    // Apply format
    status = AudioUnitSetProperty(audioUnit,
                                  kAudioUnitProperty_StreamFormat,
                                  kAudioUnitScope_Output,
                                  kInputBus,
                                  &audioFormat,
                                  sizeof(audioFormat));
    checkStatus(status);
    status = AudioUnitSetProperty(audioUnit,
                                  kAudioUnitProperty_StreamFormat,
                                  kAudioUnitScope_Input,
                                  kOutputBus,
                                  &audioFormat,
                                  sizeof(audioFormat));
    checkStatus(status);

    // Set input callback
    AURenderCallbackStruct callbackStruct;
    callbackStruct.inputProc = recordingCallback;
    callbackStruct.inputProcRefCon = self;
    status = AudioUnitSetProperty(audioUnit,
                                  kAudioOutputUnitProperty_SetInputCallback,
                                  kAudioUnitScope_Global,
                                  kInputBus,
                                  &callbackStruct,
                                  sizeof(callbackStruct));
    checkStatus(status);

    // Set output callback
    callbackStruct.inputProc = playbackCallback;
    callbackStruct.inputProcRefCon = self;
    status = AudioUnitSetProperty(audioUnit,
                                  kAudioUnitProperty_SetRenderCallback,
                                  kAudioUnitScope_Global,
                                  kOutputBus,
                                  &callbackStruct,
                                  sizeof(callbackStruct));
    checkStatus(status);

    // Allocate our own buffers (1 channel, 16 bits per sample, thus 16 bits per frame, thus 2 bytes per frame).
    // Practice learns the buffers used contain 512 frames, if this changes it will be fixed in processAudio.
    tempBuffer.mNumberChannels = 1;
    tempBuffer.mDataByteSize = 512 * 2;
    tempBuffer.mData = malloc( 512 * 2 );

    // Initialise
    status = AudioUnitInitialize(audioUnit);
    checkStatus(status);

    return self;
} 
```

当来自麦克风的新音频数据可用时调用此回调。但是当我在 iPhone 上测试时永远不要在这里输入：

```
static OSStatus recordingCallback(void *inRefCon, AudioUnitRenderActionFlags *ioActionFlags, const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, UInt32 inNumberFrames, AudioBufferList *ioData) {
    AudioBuffer buffer;

    buffer.mNumberChannels = 1;
    buffer.mDataByteSize = inNumberFrames * 2;
    buffer.mData = malloc( inNumberFrames * 2 );

    // Put buffer in a AudioBufferList
    AudioBufferList bufferList;
    bufferList.mNumberBuffers = 1;
    bufferList.mBuffers[0] = buffer;

    // Then:
    // Obtain recorded samples

    OSStatus status;

    status = AudioUnitRender([iosAudio audioUnit],
                             ioActionFlags,
                             inTimeStamp,
                             inBusNumber,
                             inNumberFrames,
                             &bufferList);
    checkStatus(status);

    // Now, we have the samples we just read sitting in buffers in bufferList
    // Process the new data
    [iosAudio processAudio:&bufferList];

    // release the malloc'ed data in the buffer we created earlier
    free(bufferList.mBuffers[0].mData);

    return noErr;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T23:11:21.387

我解决了我的问题。我只需要在播放/录音之前初始化 AudioSession。我使用以下代码这样做：

```
OSStatus status;

AudioSessionInitialize(NULL, NULL, NULL, self);
UInt32 sessionCategory = kAudioSessionCategory_PlayAndRecord;
status = AudioSessionSetProperty (kAudioSessionProperty_AudioCategory,
                               sizeof (sessionCategory),
                               &sessionCategory);

if (status != kAudioSessionNoError)
{
    if (status == kAudioServicesUnsupportedPropertyError) {
        NSLog(@"AudioSessionInitialize failed: unsupportedPropertyError");
    }else if (status == kAudioServicesBadPropertySizeError) {
        NSLog(@"AudioSessionInitialize failed: badPropertySizeError");
    }else if (status == kAudioServicesBadSpecifierSizeError) {
        NSLog(@"AudioSessionInitialize failed: badSpecifierSizeError");
    }else if (status == kAudioServicesSystemSoundUnspecifiedError) {
        NSLog(@"AudioSessionInitialize failed: systemSoundUnspecifiedError");
    }else if (status == kAudioServicesSystemSoundClientTimedOutError) {
        NSLog(@"AudioSessionInitialize failed: systemSoundClientTimedOutError");
    }else {
        NSLog(@"AudioSessionInitialize failed! %ld", status);
    }
}

AudioSessionSetActive(TRUE); 
```

...

# java - Hibernate 返回错误“必须设置或恢复默认类路径”

> ID：13086368
> 
> 赞同：8
> 
> 时间：2012-10-26T11:48:04.507
> 
> 标签：java, eclipse, hibernate, eclipse-plugin

我是基于 Hibernate 技术的 Java 应用程序的新手。我在安装系统时遇到了一些问题。我安装在我的朋友系统中。我在 Eclipse Juno（便携式）中安装了 JBOSS 工具（仅在 Hibernate 工具中）。

我刚刚将该文件夹复制到我的系统中，然后运行 ​​Eclipse.exe 文件，它运行顺利，我正在尝试在休眠透视图中创建新的休眠配置文件。

但我得到以下错误：

> 类路径必须设置或恢复默认

![图片](../Images/1a686dd15316351e4f93a18f9153f9dc.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-14T03:45:38.510

您需要将数据库驱动程序添加到您的类路径

1) 为您的数据库下载驱动程序（例如，如果您尝试连接到 MySQL，您可以从[http://dev.mysql.com/downloads/connector/j/](http://dev.mysql.com/downloads/connector/j/)获取它）

2）通过单击“添加外部jars”并从下载到的位置选择它来指向它，或者首先将其添加到项目中，然后通过“添加jars”选择它（推荐）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T09:49:56.700

这将是因为您尚未将外部 jar 添加到类路径中。添加所有 jars，包括使用的记录器，它将被解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-16T06:52:46.490

我在配置 Jboss 工具时也遇到了同样的问题要解决这个问题，只需按照以下步骤操作。

1）右键单击休眠文件并选择编辑配置。

2）转到主我们可以看到三个字段 1）项目 选择项目并选择数据库连接。

3）最后选择要配置的属性文件（jdbc.properties）和配置文件（hibernate.cfg.xml）项目。

享受...

# html - 如何使用 CSS 为选定的列表项赋予不同的颜色？

> ID：13086375
> 
> 赞同：14
> 
> 时间：2012-10-26T11:48:27.293
> 
> 标签：html, css

我知道这个问题已经被问过很多次了。但我只是找不到适合我的代码的技巧。我希望导航栏中的活动列表项具有不同的颜色。明显地。愚蠢的小东西。我知道。但请尝试提供帮助。

这是我的**HTML**代码：

```
<div id="container">  
    <ul id="nav">  
        <li class="active"><a href="am_home.html">Home</a></li>  
        <li><a href="am_teachingassistants.php">Teaching Assistants</a></li>  
        <li><a href="am_courseinfo.php">Course Info</a></li>  
        <li><a href="am_timetable.php">Time Table</a></li>  
    </ul>  
</div> 
```

这是**CSS**文件：

```
#container {
    position: relative;
    top: -2em;
    z-index: 2;
    width: 1200px;
    margin: auto auto;
}

#nav {
   position: relative;
   float: left;
   margin-left: 400px;
}

#nav li {
    list-style: none;
    float: left;
    border-right: 1px solid #afc4cc;
}

#nav li a {
   position: relative;
   z-index: 2;
   float: left;
   padding: 5px 45px;
   font-size: 15px;
   font-weight: bold;
   font-family: helvetica, arial, sans-serif;
   text-decoration: none;
   color: #39aea8;
}

ul, li {
    margin: 0;
    padding: 0;
}

ul#nav li a:link,ul#nav li a:visited {
    color: #39aea8;
    text-decoration: none;
}

ul#nav li a:hover,ul#nav li a:active {
    color: #f4ba51;
    text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-26T11:51:50.270

你的 CSS 代码有问题。只需替换这个：

```
 ul#nav li a:hover,ul#nav li a:active{    
} 
```

有了这个：

```
 ul#nav li a:hover,ul#nav li.active a{
 // here styling 
} 
```

你很高兴。您在 CSS 中调用活动类时犯了一个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T11:54:44.660

```
ul#nav li.active a { color: #f4ba51 ; } 
```

# spring - Spring Web Flow 异常处理

> ID：13086376
> 
> 赞同：2
> 
> 时间：2012-10-26T11:48:30.960
> 
> 标签：spring, spring-webflow, spring-webflow-2

如何防止异常，如果`requestParameters.sortBy`作为字符串（）传递`java.lang.NumberFormatException`或缺少（`java.lang.NullPointerException`）？

```
<view-state id="journeySearch" model="journeyForm">

     ...

    <transition on="sort">
        <set name="journeyCriteria.sortBy" value="requestParameters.sortBy" type="int" />
        <evaluate expression="bookingService.searchJourneys(journeyCriteria)" result="viewScope.journeys" /> 
    </transition>
</view-state> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T13:35:14.670

`requestParameters.sortBy`如果不存在则为 null，但不应抛出`NullPointerException`

关于 NumberFormatException，你可以使用类似的东西：

```
<global-transitions>
    <transition on-exception="java.lang.NumberFormatException" to=""/>
</global-transitions> 
```

您还可以实现自己的异常处理程序并使用它，`<exception-handler bean=""/>`您可以在流或状态级别使用它。

# asp.net - 页面在 OnClientClick 中得到回发返回 False

> ID：13086377
> 
> 赞同：1
> 
> 时间：2012-10-26T11:48:31.787
> 
> 标签：asp.net, c#-4.0

我在 C#.Net 中工作。我有一个asp按钮..

```
<asp:Button ID="btnSubmitData" ToolTip="Show" runat="server" Text="SHOW" CausesValidation="false"
                            OnClientClick="return FindSelectedItems();" OnClick="btnShow_Click" /> 
```

OnClientClick 中调用的函数是，

```
function FindSelectedItems() {

    var sender = document.getElementById('lstMultipleValues');
    var cblstTable = document.getElementById(sender.id);
    var checkBoxPrefix = sender.id + "_";
    var noOfOptions = cblstTable.rows.length;
    var selectedText = "";
    var total = 0;
    for (i = 0; i < noOfOptions; ++i) {
        if (document.getElementById(checkBoxPrefix + i).checked) {
            total += 1;
            if (selectedText == "")
                selectedText = document.getElementById
                               (checkBoxPrefix + i).parentNode.innerText;
            else
                selectedText = selectedText + "," +
             document.getElementById(checkBoxPrefix + i).parentNode.innerText;
        }
    }
    var hifMet1 = document.getElementById('<%=hifMet1.ClientID%>');
    hifMet1.value = selectedText;

    if (total == 0) {
        var panel = document.getElementById('<%=pnlOk.ClientID%>');
        document.getElementById('<%=pnlOk.ClientID%>').style.display = 'block';
        var Label1 = document.getElementById('<%=Label3.ClientID%>');
        Label1.innerHTML = "Atleast one metric should be selected.";
        var btnLoc = document.getElementById('<%=btnLoc.ClientID%>');
        btnLoc.disabled = true;
        var btnProd = document.getElementById('<%=btnProd.ClientID%>');
        btnProd.disabled = true;
        var btnLastYear = document.getElementById('<%=btnLastYear.ClientID%>');
        btnLastYear.disabled = true;
        return false;
    }
    else if (total > 2) {
        var panel = document.getElementById('<%=pnlOk.ClientID%>');
        document.getElementById('<%=pnlOk.ClientID%>').style.display = 'block';
        var Label1 = document.getElementById('<%=Label3.ClientID%>');
        Label1.innerHTML = "Only two metrics can be compared.";
        var btnLoc = document.getElementById('<%=btnLoc.ClientID%>');
        btnLoc.disabled = true;
        var btnProd = document.getElementById('<%=btnProd.ClientID%>');
        btnProd.disabled = true;
        var btnLastYear = document.getElementById('<%=btnLastYear.ClientID%>');
        btnLastYear.disabled = true;
        return false;
    }
    else {
        return true;
    }
} 
```

单击“显示”按钮后，我需要进行验证以检查至少一个复选框应在复选框列表中选中。我收到的警报消息（即）“应该选择至少一个指标”。但是在这部分之后，页面会重新加载。

此时我想避免页面刷新。我应该在这里做什么。？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:59:52.760

`CustomValidator`一种方法是通过使用控件和客户端验证函数将验证函数连接到正确的 ASP .Net 验证生命周期。

通过一些小的更改，您可以将您的 JavaScript 代码转换为客户端验证功能。

[完整的例子在这里](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.clientvalidationfunction.aspx)。

**相关片段**

```
<script language="javascript"> 
   function ClientValidate(source, arguments)
   {
        // Your code would go here, and set the IsValid property of arguments instead
        // of returning true/false

        if (arguments.Value % 2 == 0 ){
            arguments.IsValid = true;
        } else {
            arguments.IsValid = false;
        }
   }
</script>

<asp:CustomValidator id="CustomValidator1"
           ControlToValidate="Text1"
           ClientValidationFunction="ClientValidate"
           OnServerValidate="ServerValidation"
           Display="Static"
           ErrorMessage="Not an even number!"
           ForeColor="green"
           Font-Name="verdana" 
           Font-Size="10pt"
           runat="server"/>

  <asp:Button id="Button1"
       Text="Validate" 
       OnClick="ValidateBtn_OnClick" 
       runat="server"/> 
```

客户端验证应始终与服务器验证进行双重检查；将 a`CustomValidator`与客户端/服务器验证功能一起使用是实现此目的的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:38:56.360

```
Remove  script
else {
        return true;
     }
part from script and call function like this 

OnClientClick="javascript:return FindSelectedItems();"
This work for me. 
```

# visual-studio-2005 - 我可以将 .c 文件编译为 C++ 文件而不重命名它们吗？

> ID：13086378
> 
> 赞同：-1
> 
> 时间：2012-10-26T11:48:32.737
> 
> 标签：visual-studio-2005

SVN 给我一些 .c 文件带来了一些麻烦，我不得不在我的分支中重命名这些文件，因为它们收到了一些 C++ 扩展。我可以通过某种方式告诉 Visual Studio 将所有这些文件视为 C++ 代码来解决这个问题，即使它们具有 .c 扩展名。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T08:51:57.930

右键单击文件->属性->c++->高级时，必须设置为“编译为C++”。诀窍是不在项目上执行此操作，而是针对每个单独的文件执行此操作。

Ofc 您可以在执行此操作时选择多个文件，因此不会花费您很长时间。

# php - 内部联接和在同一查询中的位置返回空白错误mysql

> ID：13086385
> 
> 赞同：0
> 
> 时间：2012-10-26T11:49:15.390
> 
> 标签：php, mysql, mysql-error-1064

我遇到了一些问题。这是只返回空白页的查询（我已经尝试过在 php 等上报告错误）：

```
$query = mysql_query(" SELECT player.id, player.level, character.name, 
                              character.owner, character.owner 
                       FROM player 
                       INNER JOIN character ON player.id = character.owner
                       WHERE character.world  = '$world' ");

$res= mysql_fetch_array($query) or die(mysql_error); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:50:41.313

之后你缺少括号`mysql_error`，你应该在调用之后调用它`mysql_query`：

```
$sql = "SELECT ...";
$result = mysql_query($sql) or die(mysql_error()); 
```

如果查询失败，这应该显示错误消息。

有关如何[`mysql_query`](http://php.net/manual/en/function.mysql-query.php)正确使用的更多详细信息，请参阅手册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:18:37.007

```
$query = mysql_query(" SELECT player.id, player.level, character.name, 
                          character.owner, character.owner 
                   FROM player 
                   INNER JOIN character ON player.id = character.owner
                   WHERE character.world  = '$world' ") or die(mysql_error());

$res= mysql_fetch_array($query); 
```

如果您错过了某些内容，这将显示您的错误。

# cocos2d-iphone - cocos2d 去除色调

> ID：13086395
> 
> 赞同：-1
> 
> 时间：2012-10-26T11:50:25.017
> 
> 标签：cocos2d-iphone, ccaction

我正在尝试为我的精灵实现高亮动画。精灵应该突出显示给定的颜色并逐渐恢复到其原始颜色，使用以下代码：

```
- (void)highlight {
    CCTintTo *tintAction = [CCTintTo actionWithDuration:0.1 red:255 green:255 blue:255];
    CCTintTo *tintBackAction = [tintAction reverse];

    CCSequence *sequence = [CCSequence actions: tintAction, tintBackAction, nil];
    [self runAction:sequence];
} 
```

现在这个函数引发了一个异常，因为 CCTintTo 似乎没有实现“反向”，这是有道理的。有没有其他方法可以使用 CCAction 在间隔内去除添加的色调？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T18:16:50.713

1.  `CCSprite`'s default color is `ccWhite`, {255, 255, 255}, so if you want to make sprite lighter, you'll have to subclass `CCSprite`/write shader to use additive coloring.

2.  Just tint it back:

    ```
    CCColor3B oldColor = sprite.color;
    CCTintTo *tintTo = [CCTintTo actionWithDuration:t red:r green:g blue:b];
    CCTintTo *tintBack = [CCTintTo actionWithDuration:t red:oldColor.r green:oldColor.g blue:oldColor.b];
    [sprite runAction:[CCSequence actions: tintTo, tintBack, nil]]; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-31T23:07:55.640

对于 Cocos2dx (C++)

```
ccColor3B oldColor = sprite->getColor();
        CCTintTo* action = CCTintTo::create(0.5f, 127, 255, 127);
        CCTintTo* actionReverse = CCTintTo::create(0.5f, oldColor.r, oldColor.g, oldColor.b);;
        sprite->runAction(CCSequence::create(action, actionReverse, NULL)); 
```

工作正常克雷里，谢谢！我已经给你加分了:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:13:35.427

您可以在开始着色之前存储以前的颜色，然后只需使用初始 RGB 值创建 CCTintTo。

# c++ - For循环算法（操作次数）？

> ID：13086397
> 
> 赞同：-3
> 
> 时间：2012-10-26T11:50:25.593
> 
> 标签：c++, algorithm, operation

请有人可以帮助我计算（用于嵌套循环）的操作数，如下所示：

```
for(int c=0; c<10; c++){
    for(int j=0; j<n; j++)
       for(int r=0; r<n; r++)
           cout<<j;
      cout<<endl;
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:54:31.367

n*n*10 + 10，如果两者都`std::cout << j`计算`std::cout << endl;`为单独的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:53:15.610

那将是（大致成比例）。`10n²`

不完全是，取决于您如何定义操作。例如，换行符的输出只发生`10`几次。

所以，如果你的操作是一个`cout`语句，它就是.`10n² + 10`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T11:57:24.403

正确的缩进是：

```
for(int c=0; c<10; c++) {
    for(int j=0; j<n; j++)
        for(int r=0; r<n; r++)
            cout<<j;
    cout<<endl;
} 
```

添加缺少的大括号：

```
for(int c=0; c<10; c++) {
    for(int j=0; j<n; j++) {
        for(int r=0; r<n; r++) {
            cout<<j;
        }
    }
    cout<<endl;
} 
```

现在您可以清楚地看到它将打印多少次：

```
(10 * n * n) + (10) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T11:52:01.513

迭代次数为

```
 10 * n * n 
```

# javascript - 通过 HTML 文件输入拖放文件的功能检测

> ID：13086400
> 
> 赞同：7
> 
> 时间：2012-10-26T11:50:29.790
> 
> 标签：javascript, html, browser-feature-detection

我们可以检测浏览器是否支持将文件拖放到`<input type="file" />`.

例如，这在 Chrome 中是可能的，但在 IE8 中是不可能的。

`Modernizr.draganddrop`是一种可能性，但这是正确的选择吗？我没有添加任何自定义拖放事件处理程序。

**更新**

为了验证乔的回答，这里有一个 jQuery 示例，它应该停止文件删除。在 Chrome 和 Firefox 中验证。

```
$yourFileInput.on('drop', function() {
    return false; // if Joe's explanation was right, file will not be dropped
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T21:22:19.520

我认为[检测对给定 JavaScript 事件的支持的答案是什么？](https://stackoverflow.com/questions/2877393/detecting-support-for-a-given-javascript-event)可以帮助你。调整代码以测试 Input 而不是 Div，并测试“Drop”事件对我来说似乎工作正常。

在这里转载，因此您不必单击（并稍作调整，因为您似乎只需要检测这一功能）：

```
function isEventSupported(eventName) {
  var el = document.createElement('input');
  eventName = 'on' + eventName;
  var isSupported = (eventName in el);
  if (!isSupported) {
    el.setAttribute(eventName, 'return;');
    isSupported = typeof el[eventName] == 'function';
  }
  el = null;
  return isSupported;
}
if(isEventSupported('drop')){
  //Browser supports dropping a file onto Input
} else {
  //Fall back, men!
} 
```

# c# - 如何强制单继承？

> ID：13086405
> 
> 赞同：3
> 
> 时间：2012-10-26T11:50:45.063
> 
> 标签：c#, .net, inheritance

我有两节课：

```
public class A
{
}

public sealed class B : A
{
} 
```

而且我希望只有我的`B`类（在同一个程序集中定义`A`）可以继承`A`.
我能怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T11:52:20.117

> 而且我希望只有我的 B 类（在 A 的同一程序集中定义）可以继承 A。我该怎么办？

那么根本不需要继承..

```
public sealed class B
{
  //includes all methods of A and B
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T11:54:13.487

您可以使用`internal`构造函数，这可以防止其他程序集使用您的类。

```
public class A 
{
    internal A() { }    
}
public sealed class B : A { } 
```

而且，如果您不关心性能：

```
public class A
{
    public A()
    {
        Type c = GetType();
        if (c != typeof(A) && c != typeof(B)) throw ....;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T11:52:33.330

我建议您使用组合而不是继承来限制基类型成员的可见性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T11:54:30.667

如果只有 B 可以继承 A，那么你真的需要继承吗？

如果要拆分一个变得太大的班级，那么您就没有遵循良好的做法，因为它不太可能承担单一责任。

现在，如果由于某些尴尬的原因你确实需要这个，你可以试试：

```
public class B
{
    private sealed class A : B
    {

    }
} 
```

并根据您的需要进行调整。

# c++ - 防止 gcc/libstdc++ 在从 throw() 方法抛出时调用终止

> ID：13086409
> 
> 赞同：0
> 
> 时间：2012-10-26T11:51:22.723
> 
> 标签：c++, linux, exception, gcc

如果我有一个标记为 throw() 的方法，例如

```
 void method() throw()
 {
      // do some stuff, call other functions
 } 
```

*然而内部确实*发生了异常，gcc 将终止应用程序（带有消息“在抛出 'xyz' 实例后调用终止”）。

有没有办法避免这种行为？

例如，用于忽略 throw() 内容或强制生成 eh_frame 的命令行开关。等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:36:50.440

你试过[GCC 手册](http://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html)吗？

> `-fno-enforce-eh-specs`
> 
> 不要在运行时生成代码来检查是否违反异常规范。此选项违反了 C++ 标准，但可能有助于减少生产构建中的代码大小，就像定义 ` `NDEBUG`'。这不会授予用户代码违反异常规范抛出异常的权限；编译器仍会根据规范进行优化，因此抛出意外异常会导致运行时出现未定义的行为。

它*不会*强制生成 EH 帧，但它应该停止调用`std::unexpected()`，因此可能对您的情况有用。

正如文档所说，“编译器仍然根据规范进行优化”，因此例如当调用可以内联到捕获站点时它没有帮助`method()`，因为编译器假设不需要捕获，因为空异常规范说不会抛出异常，因此如果抛出异常，它不会被捕获。如果调用`method()`不能内联到捕获站点，它似乎工作，异常离开`method()`而不调用`std::unexpected()`并且可以在堆栈的更高位置被捕获。

**编辑**：这仍然会调用`std::terminate()`，即使`-fno-enforce-eh-specs`：

```
void func() throw() { throw ""; }
void func2() { func(); }
int main() { try { func2(); } catch (...) { } } 
```

编译器可以看到对的调用`func2`只调用了一个无抛出函数，因此`catch`永远不需要，因此被优化掉了。当异常被抛出时，它不会被捕获。

这*确实*适用`-fno-enforce-eh-specs`并且不会终止：

```
/* func2.cc */
void func() throw();
void func2() { func(); }

/* main.cc */
void func2();
int main() { try { func2(); } catch (...) { } } 
```

这里，在编译时`main.cc`，编译器无法判断是否`func2`要抛出异常，因为它没有异常规范，并且它的定义在 中不可见`main.cc`，所以`catch`不能省略。当抛出异常时，它将被捕获。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:32:15.403

您可以通过调用 ... 来提供自己的终止处理程序，`std::set_terminate`但是我认为从那里返回是不合法的，所以它唯一能做的就是以某种方式终止。

您可以提供自己的意外异常处理程序`std::set_unexpected`：默认调用`std::terminate`，但您可以做一些不同的事情（例如记录和吞下异常）。但是，您是否可以有效地恢复取决于您的程序。此外，我已经看到它被标记为已弃用，因此依赖它可能不是最好的主意。

# ios - UIViewController 切换的问题

> ID：13086416
> 
> 赞同：1
> 
> 时间：2012-10-26T11:51:50.000
> 
> 标签：ios, multithreading, uiviewcontroller

我的应用程序有点问题。
当我切换视图时，在这个应用程序运行两个排序算法之后，会有大约 3 到 10 秒的时间延迟。（快速和冒泡排序）在一个额外的线程中。我不知道问题出在哪里。

这里的代码片段：

```
[alert show];
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, (unsigned long)NULL), ^(void) {
     time = [Sort sortRuns:(int)slider_durchlaeufe.value WithCapacity:(int)slider_ArraySize.value Reference:alert]; //time is a global reference to my Time object
     [self setDataForStatistik]; // a Method to set the statisik for the next view 
     [alert dismissWithClickedButtonIndex:0 animated:true];
  }); 
```

我认为失败出在这段代码片段中。

我希望你能帮助我。

罗比字节

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:52:43.850

您需要在主队列上进行 UI 更新（或任何可能触发 UI 更新的更改）。在查看代码示例时，您会看到很多这种嵌套的“异步到后台队列，然后异步到主队列”。

```
[alert show];
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, (unsigned long)NULL), ^(void) {
     time = [Sort sortRuns:(int)slider_durchlaeufe.value WithCapacity:(int)slider_ArraySize.value Reference:alert]; //time is a global reference to my Time object
     dispatch_async(dispatch_get_main_queue(), ^{
         [self setDataForStatistik]; // a Method to set the statisik for the next view 
         [alert dismissWithClickedButtonIndex:0 animated:true];
     });
}); 
```

希望有帮助。

# maps - 如何从谷歌地图 api 获取波兰所有街道的列表

> ID：13086417
> 
> 赞同：0
> 
> 时间：2012-10-26T11:51:52.520
> 
> 标签：maps, street-address

我需要获取波兰所有街道及其城市和邮政编码的列表。要不要写个小程序收集波兰所有的街道？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:52:48.830

不，它违反了他们在“禁止预取、缓存或存储内容”以及“禁止大量下载或批量提供内容”的[条款中的服务条款。](https://developers.google.com/maps/terms)

# cassandra - 访问 Cassandra 中的复合行键

> ID：13086421
> 
> 赞同：2
> 
> 时间：2012-10-26T11:52:13.767
> 
> 标签：cassandra, thrift, hector

我有一个带有复合键的列族：

```
create column family MyCF
with key_validation_class = 'CompositeType(UTF8Type, UTF8Type)'
and comparator = 'CompositeType(UTF8Type, UTF8Type)'
and default_validation_class='CompositeType(UTF8Type, UTF8Type)'
; 
```

我已经存储了具有以下值的行键 1:1,2:2,1:3,2:1,1:2,2:3

```
RowKey: 1:1
= (column=colum1, value=value1, timestamp=1351093372962000)

RowKey: 2:2
=> (column=colum1, value=value1, timestamp=1351093411137000)

RowKey: 1:3
= (column=colum1, value=value1, timestamp=1351093385820000)

RowKey: 2:1
= (column=colum1, value=value1, timestamp=1351093401162000)

RowKey: 1:2
= (column=colum1, value=value1, timestamp=1351093379274000)

RowKey: 2:3
= (column=colum1, value=value1, timestamp=1351093421393000) 
```

加载 Cassandra 后，我想恢复所有以 1 开头的行，即 1:1、1:2 和 1:3

我尝试使用 Hector 和 Thrift 来完成此操作，但我无法找到有关文档的任何信息。

使用 CQL 无法恢复它，因为不支持这种查询，或者这就是论坛上所说的。

我还设法通过选择行键（1：1、1：2、1：3）来恢复信息，这可以正常工作，但我真正需要做的是恢复只询问第一个元素的信息组合键。

我该怎么做？

谢谢

# postgresql - Postgres 表可以按列顺序优化吗？

> ID：13086424
> 
> 赞同：2
> 
> 时间：2012-10-26T11:52:18.790
> 
> 标签：postgresql, database-design, sybase

我最近不得不向我们的数据库团队提出一组新的 Postgres 表，这些表将被我正在编写的应用程序使用。他们失败了设计，因为我的表有这样列出的字段：

```
my_table
    my_table_id : PRIMARY KEY, AUTO INCREMENT INT
    some_other_table_id, FOREIGN KEY INT
    some_text : CHARACTER VARYING(100)
    some_flag : BOOLEAN 
```

他们说该表不会是最优的，因为`some_text`出现在 之前`some_flag`，并且由于`CHARACTER VARYING`字段搜索比`BOOLEAN`s 慢，因此在进行表扫描时，具有列从最高精度到最低精度排序的表结构会更快；所以，像这样：

```
my_table
    my_table_id : PRIMARY KEY, AUTO INCREMENT INT
    some_other_table_id, FOREIGN KEY INT
    some_flag : BOOLEAN
    some_text : CHARACTER VARYING(100) 
```

这些 DBA 具有 Sybase 背景，最近才转为我们的 Postgres DBA。我在想这可能是一个不适用于 Postgres 的 Sybase 优化（我认为 Postgres 足够聪明以至于*不关心*列序列）。

无论哪种方式，我都找不到任何确认或否认的 Postgres 文档。寻找任何久经沙场的 Postgres DBA 来权衡这是否是有效的或虚假的（或有条件的有效！）声明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:56:38.180

根据我在 Oracle 处理类似问题的经验，如果内存服务（由于在一行中查找列数据时的 CPU 开销），版本 9 和 10（或 8 和 9）之间的行为会发生很大变化，我不相信当实际实验相当简单和结论性时，您应该依靠记录在案的行为来解决此类问题。

所以我建议你为此创建一个测试用例。创建两个具有完全相同数据和不同顺序的列的表，并运行重复和不同的测试。尝试将整个测试实现为可以在开发或测试系统上运行并告诉您答案的单个脚本。也许 DBA 是对的，您可以说：“嘿，证实了您对此的想法，非常感谢”，或者您可能找不到可衡量的显着差异。在后一种情况下，您可以将整个测试交给 DBA，并解释如何无法重现问题。让他们进行测试。

无论哪种方式，有人都会学到一些东西，并且您有一个可以应用于未来（或过去）版本的测试用例。

最后，在此处发布您发现的内容；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:21:52.867

从**数据库设计**的角度来看，您的设计与 DBA 的建议没有区别——您的应用程序不应该关心。在关系数据库中（逻辑上）没有列顺序之类的东西。实际上，如果列的顺序很重要（逻辑上）它失败了 1NF。

因此，只需将所有创建表脚本传递给您的 DBA，并让他们以他们认为在物理级别上最佳的任何方式来实现（重新排序列）。您只需继续应用程序。

数据库设计**不能**在列的顺序上失败——它根本不是设计过程的一部分。

* * *

> 必须保护大型数据库的未来用户不必知道数据在机器中的组织方式......
> 
> ...处理的问题是数据独立性问题——应用程序和终端活动独立于数据类型的增长和变化...

*英孚科德 ~ 1979*

> 物理级别的更改...不得要求更改应用程序...

[**规则 8：物理数据独立性**](http://en.wikipedia.org/wiki/Codd_rules)（ *EF Codd ~ 1985*）

* * *

所以我们在这里 - 33年后......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T22:17:14.517

您的 DBA 可能指的是“获取”给定元组 (/row) 中的布尔值的访问策略。

在他们提出的设计中，系统可以通过查看字节 9 “获取”该值。

在您提出的设计中，系统必须首先检查所有可变长度列的 LENGTH 字段[在您的布尔列之前]，然后才能知道可以找到布尔值的字节偏移量。那总是比“他们”的方式慢。

他们的考虑是物理设计之一（这是正确的）。Damir 的回答也是正确的，但是是从 LOGICAL 设计的角度来回答的。

如果你的 DBA 的评论真的是“批评‘坏’设计”，那么他们应该指出逻辑设计是**你的**工作（在那个级别上，列顺序无关紧要），而物理设计是**他们的**工作。如果他们希望**你**也做物理设计（**他们的**工作），那么老板就没有任何理由让他们继续工作了。

# c++ - 我应该如何分配从工厂函数返回的 boost::interprocess::unique_ptr，可能在 C++03 中使用 boost::move

> ID：13086428
> 
> 赞同：3
> 
> 时间：2012-10-26T11:52:33.783
> 
> 标签：c++, boost, move, unique-ptr, boost-move

我正在尝试创建一个返回 boost::interprocess::unique_ptr 的工厂函数。这是一个例子：

```
#include <boost/interprocess/smart_ptr/unique_ptr.hpp>
using namespace boost::interprocess;

class my_class {
public:
    my_class() {}
};

struct my_class_deleter {
    void operator()(my_class *p) {}
};

typedef unique_ptr<my_class, my_class_deleter> uptr;

uptr create() {
    return uptr();
}

int main() {
    uptr x;
    x = create();
    return 0;
} 
```

问题是 gcc 无法编译上面的代码：

```
main.cpp:22: error: ambiguous overload for ‘operator=’ in ‘x = create()()’
../../boost_latest/boost/interprocess/smart_ptr/unique_ptr.hpp:211: note: candidates are: boost::interprocess::unique_ptr<T, D>& boost::interprocess::unique_ptr<T, D>::operator=(boost::rv<boost::interprocess::unique_ptr<T, D> >&) [with T = my_class, D = my_class_deleter]
../../boost_latest/boost/interprocess/smart_ptr/unique_ptr.hpp:249: note:                 boost::interprocess::unique_ptr<T, D>& boost::interprocess::unique_ptr<T, D>::operator=(int boost::interprocess::unique_ptr<T, D>::nat::*) [with T = my_class, D = my_class_deleter] 
```

当我改变

```
x = create(); 
```

到

```
x = boost::move(create()); 
```

然后 gcc 说：

```
main.cpp:22: error: invalid initialization of non-const reference of type ‘uptr&’ from a temporary of type ‘uptr’
../../boost_latest/boost/move/move.hpp:330: error: in passing argument 1 of ‘typename boost::move_detail::enable_if<boost::has_move_emulation_enabled<T>, boost::rv<T>&>::type boost::move(T&) [with T = uptr]’ 
```

难道我做错了什么？

有趣的是，当我这样做时：

```
uptr x2 = create(); 
```

代码编译没有任何问题。

顺便说一句：我使用 gcc v4.4.3 和 Boost v1.51.0。

* * *

**更新：**

通过使用以下代码段，我已经能够克服这个问题：

```
x = static_cast<boost::rv<uptr>&>(create()); 
```

上述演员表基于`operator=`原始问题中提到的模糊重载的第一个版本。第二个 ( `operator=(int boost::interprocess::unique_ptr<T, D>::nat::*`) 可能是由实现模拟提供的`std::unique_ptr::operator=(nullptr_t)`，事实上它重置了`unique_ptr`. 事实证明，这也让人`operator=`模棱两可。

不幸的是，使用上述`static_cast<>()`方法使使用我的工厂变得过于复杂。

解决此问题的一种方法是删除第二个重载 for `operator=`，因为人们总是可以显式调用`unique_ptr::reset()`.

不过，我想知道是否以及如何`boost::move()`帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T12:12:32.793

事实证明，这是`boost::interprocess:unique_ptr`.

我将它报告给了图书馆的维护者（[票 #7598](https://svn.boost.org/trac/boost/ticket/7598)）。

该错误已修复，该修复将在 Boost v1.54.0 中提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T15:54:34.017

不确定它是否满足您的用例，而不是使用 unique_ptr，您不能将 my_class 设为可移动类型（使用 Boost::Move）并使用 Boost ValueFactory 作为工厂接口按值执行操作吗？

# git - Git：自动清理？

> ID：13086429
> 
> 赞同：7
> 
> 时间：2012-10-26T11:52:46.000
> 
> 标签：git, garbage-collection, git-gc

在过去，一个人不得不`git gc`不时调用。我现在读到，最新的 Git 版本应该自动执行清理。它是否正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T12:06:32.140

在一定程度上...

[来自http://www.kernel.org/pub/software/scm/git/docs/git-gc.html](http://www.kernel.org/pub/software/scm/git/docs/git-gc.html)的文档

关于 git gc --auto....

> 使用此选项， git gc 会检查是否需要进行任何内务处理；如果没有，它会退出而不执行任何工作。一些 git 命令在执行可能创建许多松散对象的操作后运行 git gc --auto。

所以这取决于你正在运行的命令。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T12:08:42.237

您可以`cron`按照此处的说明设置任务：http: [//minhajuddin.com/2011/12/09/gc-your-git-repositories-automatically-with-a-cron-task](http://minhajuddin.com/2011/12/09/gc-your-git-repositories-automatically-with-a-cron-task)

如前所述`git help gc`：鼓励用户在每个存储库中定期运行此任务，以保持良好的磁盘空间利用率和良好的运行性能。

一些 git 命令可能会自动运行`git gc`。如果您知道自己在做什么，并且您只想永久禁用此行为而无需进一步考虑，请执行以下操作：

```
git config --global gc.auto 0 
```

此外，您可以配置修剪行为：

```
git config gc.pruneexpire "30 days" 
```

# c++ - 考试样本：为什么 C++ 中的这个变量会产生这样的输出？

> ID：13086430
> 
> 赞同：0
> 
> 时间：2012-10-26T11:52:46.467
> 
> 标签：c++

> **可能重复：**
> [未定义的行为和序列点](https://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points)

手动编写以下代码：

```
#include <stdio.h>

int func (int a, int b) {
    static int c = 1;
    return a + b * (c *= -1);
}

int main () {
    int a = 2, b = 3;
    int c = func(a, b);

    a *= a++;
    b *= ++b;

    printf("%d %d %d %d\n", a, b, c, func(a, b));
} 
```

我计算变量`printf()`如下：

```
a = 5, b = 16, c = -1, func(a, b) = -11 
```

但是我的编译器告诉我最后一个值实际上是 21。

输出：

```
a = 5, b = 16, c = -1, func(a, b) = 21n 
```

我将我的价值计算为`(16*-1) + 5`

谁能告诉我哪里出错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T11:54:17.980

```
a *= a++;
b *= ++b; 
```

这两个语句在 C 中都是未定义的行为。它们违反了 C 序列点规则。

```
a *= a++; 
```

相当于：

```
a = a * a++; 
```

并且在前一个和下一个序列点之间修改对象两次是 C 中的未定义行为（C99，6.5p2）。

# jquery - 下拉列表应填充数据库中的名称

> ID：13086432
> 
> 赞同：-2
> 
> 时间：2012-10-26T11:52:58.143
> 
> 标签：jquery, asp.net, json.net

我使用的是 html 下拉菜单，而不是 asp .net 控件。我想使用 jquery 在下拉列表中填充数据库中的员工姓名。我必须在 aspx.cs 文件中编写什么代码。以及如何绑定 json 数据？请回复

```
My code is

 <script type="text/javascript" language="javascript">
 $(document).ready(function()
 {
 $().ready(function(){
 $.ajax({
 type:"POST",
 data:"{}",
 url:"TestJson.aspx/GetName",
 dataType:"json",
 success:function(msg)
 {
 var dropDown=$("#ddlName");
 dropDown.append($("<option></option>").val('').text('- Select -'));

$.each(data, function () {
    dropDown.append($("<option></option>")

        .text($(this).attr("Name")));
 });
 },
 error:function()
 { 
 alert("failed to load");
 }
 });
 });

  </script>
  <style type="text/css">

    #ddlName
    {
        width: 146px;
    }
</style>
</head>
<body>
<form id="form1" runat="server">
<div style="border:1px solid gray; width:400px;">

                    Name

                    <select id="ddlName">
                    <option value="">--Select--</option>
                </select>
        </div>
</form>

My .cs code

  public  static Details[] BindDropdown()
{
 DataTable dt = new DataTable();
    List<Details> details = new List<Details>();

    SqlConnection con = new SqlConnection("Data Source=ST0022;Initial     Catalog=QuickMove_Globe;User ID=sa;Password=good");

       SqlCommand cmd = new SqlCommand("SELECT ClientBranchID,Name FROM     ProspectiveLead", con);

            con.Open();
            SqlDataAdapter da = new SqlDataAdapter(cmd);
            da.Fill(dt);
            foreach (DataRow dtrow in dt.Rows)
            {
                Details detail = new Details();
                detail.Id = Convert.ToInt32(dtrow["ClientBranchId"].ToString());
                detail.Name = dtrow["Name"].ToString();
                details.Add(detail);
            }

    return details.ToArray();
}
public class Details
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:21:29.803

在 .aspx 页面代码中

```
 <select id="ddlStateName"><option value="0" selected="selected">State</option>
   </select> 
```

在 Web 服务中，我们有以下方法

为状态创建通用类

```
public class StateProperty
    {
      public int StateId { get; set; }
      public string StateName { get; set; }

    }

public List<StateProperty> GetAllState()
      {
          _objDataWrapper=new DbWrapper(Common.CnnString,CommandType.StoredProcedure);
          var objStateList = new List<StateProperty>();
          _dataSet=new DataSet();
          try
          {
              // Here you will write query like "select * from state" and fill it dataset
              _dataSet = _objDataWrapper.ExecuteDataSet("Aj_Proc_GetStateList");
              objStateList = BindStateObject(_dataSet.Tables[0]);
          }
          catch (Exception ex)
          {

          }
          return objStateList;
      }

   //BindStateObject method defined here 

 private List<StateProperty>BindStateObject(DataTable dataTable)
      {
          var objStateList = new List<StateProperty>();

          try
          {
              if(dataTable.Rows.Count>0)
              {
                  for(var j=0;j<dataTable.Rows.Count;j++)
                  {
                      var objState = new StateProperty
                                         {
                                             StateName = Convert.ToString(dataTable.Rows[j]["AjStateName"]),
                                             StateId = Convert.ToInt32(dataTable.Rows[j]["AjStateId"])
                                         };
                      objStateList.Add(objState);
                  }
              }
          }
          catch (Exception ex)
          {

          }
          return objStateList;
      }

     [WebMethod]
   public ListItem[] GetAllState()
   {
       var data = GetAllState();
       if (data.Count > 0)
           return data.Select(result => new ListItem()
           {
               Text = result.StateName,
               Value =
                   result.StateId.ToString(CultureInfo.InvariantCulture)

           }).ToArray();
       return null;
   } 
```

然后我们必须通过 Jquery 调用这个 web 方法

```
function BindState() {
    var countryId = countryObj.val();

        $("#ddlStateName").empty().append('<option selected="selected" value="0">Select State</option>');
        $.ajax({
            type: "POST",
            url: "pathofyourwebservice/GetState",
            async: true,
            data: '{""}',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                PopulateControl(response.d, stateObj);

            },
            error: function (xml, textStatus, errorThrown) {
                alert(xml.status + "||" + xml.responseText);
            }
        });
    } 
} 
```

//这里我定义了PopulateControl

```
function PopulateControl(list, control) {

    if (list.length > 0) {

        control.removeAttr("disabled");

        $.each(list, function () {

            control.append($("<option></option>").val(this['Value']).html(this['Text']));

        });
    }
    else {
        control.empty().append('<option selected="selected" value="0">Not available<option>');
    }
} 
```

然后在document.ready函数侧的页面上调用此方法

```
$(document).ready(function () {
  BindState();
}); 
```

# mysql - 用于更改的重复订单的数据库架构

> ID：13086435
> 
> 赞同：-1
> 
> 时间：2012-10-26T11:53:10.437
> 
> 标签：mysql, database, schema, recurring, orders

我正在创建一个订阅网站，订购的实际产品可以按月更改。我正在寻找一种有效的方法来处理与当前订单相关的产品并保留前几个月交付的产品。

下面的简要架构：

订单

```
id
customer_id
subscription_id
shipping_...
billing_... 
```

order_products

```
id
order_id
product_id
quantity
price
total 
```

order_invoices

```
id
order_id
date_shipped 
```

order_invoice_products

```
id
order_invoice_id
product_id 
```

订阅

```
id 
```

谢谢您的帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T15:44:23.833

您必须记录订单的日期（月份）。将此字段添加到订单表中。

# jsp - 将查询字符串中的二维数组传递给 JSP

> ID：13086441
> 
> 赞同：0
> 
> 时间：2012-10-26T11:53:18.387
> 
> 标签：jsp, query-string

我想在查询字符串中创建一个二维数组并将其传递给 JSP。我可以附加字符串，但找不到附加二维数组的语法。

例子：

> http://localhost:8080/queryWithQueryString?twodArray[0][0]=storeid&twodArray[0][1]=101

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:46:10.097

您可以按原样使用它。参数名称将按字面意思以这种形式出现。JSP 对此没有任何特殊处理（与 PHP 不同）。所以你需要*自己*解析它。

```
String[][] twodArray = new String[1][];
twodArray[0] = new String[2];
twodArray[0][0] = request.getParameter("twodArray[0][0]");
twodArray[0][1] = request.getParameter("twodArray[0][1]"); 
```

对多个参数名称使用标准 HTTP 约定可能更容易。

> http://localhost:8080/queryWithQueryString?twodArray[0]=storeid&twodArray[0]=101

和

```
String[][] twodArray = new String[1][];
twodArray[0] = request.getParameterValues("twodArray[0]"); 
```

`List<String[]>`使用 a而不是`String[][]`a可能更容易`List`动态扩展。如果您事先不知道物品的数量，这将很有帮助。

```
List<String[]> twodArray = new ArrayList<String[]>();

for (int i = 0; i < Integer.MAX_VALUE; i++) {
    String[] values = request.getParameterValues("twodArray[" + i + "]");
    if (values == null) break;
    twodArray.add(values);
} 
```

# c# - 在没有系统/用户 dsn 的情况下连接到 sybase 数据库

> ID：13086442
> 
> 赞同：0
> 
> 时间：2012-10-26T11:53:19.093
> 
> 标签：c#, sybase, windows-7-x64

我需要从 sybase 数据库中获取数据。我通过在开发环境中创建系统 DSN/用户 DSN 来做到这一点。这不能成为生产中的解决方案。除了知道服务器/数据库/用户名/密码之外，还有其他类似于 SQLclient for SQL 的替代方式吗？有没有类似于sybase（数据提供者）的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T16:42:49.897

答案是：isql

有关 isql 的更多信息，请查看以下链接： http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc35456.1570/html/ocspsunx/
[X33477.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc35456.1570/html/ocspsunx/X33477.htm)

我认为 isql 包含在软件开发工具包中：http:
[//downloads.sybase.com/swd/summary.do ?client=support&baseprod=1038](http://downloads.sybase.com/swd/summary.do?client=support&baseprod=1038)

# javascript - 如何从返回 json 数组的 ajax 调用构建 javascript 数组？

> ID：13086443
> 
> 赞同：0
> 
> 时间：2012-10-26T11:53:24.050
> 
> 标签：javascript, ajax, arrays, json, loops

我正在做一个返回一些 json 数据的 ajax 调用。我需要获取这些数据，遍历它并构建一个新的 javascript 数组。

这是返回的 json 的样子：

```
{
    query: [ ],
    products:  [
     {
    title: "title 1",
    price: "6.00",
    magazine: "magazine name 1",
    image: "/p/c/pc_90_cover.jpg",
    type: "Magazine",
    market: "Technology",
    zinio: "http:www.zinio.com",
    newsstand: "http://www.link1.php"
    },

     {
    title: "title 2",
    price: "6.00",
    magazine: "magazine name 2",
    image: "/p/c/pc_90_cover.jpg",
    type: "Magazine",
    market: "Technology",
    zinio: "http:www.zinio.com",
    newsstand: "http://www.link2.php"
    },

     {
    title: "title 3",
    price: "6.00",
    magazine: "magazine name 3",
    image: "/p/c/pc_90_cover.jpg",
    type: "Magazine",
    market: "Technology",
    zinio: "http:www.zinio.com",
    newsstand: "http://www.link3.php"
    }
    ] 
```

}

如何在 javascript 中遍历这些数据？这是我到目前为止所拥有的，但这是非常错误的！- 抱歉，我的 javascript 不是我最强的技能！

```
 var allProducts = $.get("http://localhost:8888/imagine-publishing/web/app_dev.php/api/v1/search/search.json?query=pho", function(data) {

                    var arrProducts = [
                        for (var product in allProducts) {

                            title  = product.title,
                            url = product.url, 
                            label = product.title, 
                            magazine = product.magazine,
                            image = product.imageThumb,
                            newsstand = product.newsstand,
                            googleplay = product.googleplay,
                            kindle = product.kindle, 
                            barnesnoble = product.barnesnoble,
                            zinio = product.zinio, 
                            kobo = product.kobo, 
                            waterstones = product.waterstones, 
                            type = product.type, 
                            brandurl = product.brandurl 

                            },

                     ];

                });

                console.log(arrProducts); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T11:55:35.590

假设 JSON 使用正确的 Content-Type ( `application/json`) 提供，jQuery 将自动解析 JSON 并使用结果填充回调函数的第一个参数。

```
var arrProducts = data.products; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:55:07.540

[http://api.jquery.com/jQuery.parseJSON/](http://api.jquery.com/jQuery.parseJSON/)

`jQuery.parseJSON("json string")`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:58:52.247

使用 jQuery 的 getJSON

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

```
 $.getJSON(url, function(data){
   // Your code goes here
  }); 
```

# r - 如何编写缓存的变量评估器？

> ID：13086446
> 
> 赞同：2
> 
> 时间：2012-10-26T11:53:27.497
> 
> 标签：r

编辑：

我有一段看起来像这样的笨拙的代码：

```
readcsvfile()
dopreprocessingoncsvfile()
readanothercsvfile()
moreprocessing()
# etc ... 
```

几天后，这逐渐变得更长，更复杂，因此现在需要一两分钟才能运行，我不是很有耐心:-P。鉴于 R 在拯救环境方面非常出色，我的意思是 R 环境中的变量，一个简单的加速方法是：

```
if( !exists("init.done") {
readcsvfile()
dopreprocessingoncsvfile()
readanothercsvfile()
moreprocessing()
init.done = T
} 
```

但是，我喜欢它更细粒度，尤其是因为有时我可能会在处理过程中调整一个函数，所以我想重新运行它，而不是看着整个世界重新加载，所以我把它改成：

```
if( !exists("somedata" ) ) {
    somedata <- readcsvfile()
}
# ... etc ... same for the others 
```

但是，有时我会犯以下错误之一，让我们面对现实吧，我也只是懒惰，所以如果有更简洁的方法，为什么还要写一个长长的 if 语句呢？我经常犯以下错误：

*   在 if 中错误输入了变量的名称，它通过我注意到每次运行脚本时它一直在运行来“检测”自身
*   错过了 if 子句中的第二个括号，这需要 10-15 秒来检测、修改和重新运行，这很烦人：-P

Sooo....我建议的解决方案是编写一个函数`cacheVar`，其定义看起来有点像：

```
cacheVar <- function( varname, expression ) {
    if( !exists(varname ) {
        setValueMagic( varname, evalMagic(expression) )
    }
}

... and whose usage looks like:

cacheVar("foo", {
    # some expression that calculates the value of foo
}) 
```

...仅当值“varname”不存在时才评估表达式。

我想充实这一点的缺失信息是：

*   这已经存在了吗？
*   如何用`setValueMagic`R 写？
*   如何用`evalMagic`R 写？

编辑：有点复杂，因为我们需要分配到父框架，可能使用`parent.env`or `parent.frame`，类似的东西。

# c# - 使用 NuGet 安装全局程序集缓存包中缺少“System.Drawing”

> ID：13086447
> 
> 赞同：2
> 
> 时间：2012-10-26T11:53:37.057
> 
> 标签：c#, ravendb, nuget, selenium-webdriver, nuget-package

我最近处理了一些与 JSON.Net 尝试在同一个库中使用 RavenDB 和 Selenium Webdriver 的“依赖地狱”版本冲突，因此我在此过程中重新安装了 Visual Studio 2010 和 Visual Studio 2012（按此顺序）。

这是我在 Visual Studio 2012 中尝试使用 NuGet GUI 安装 Selenium WebDriver 时遇到的错误。

```
Attempting to resolve dependency 'Newtonsoft.Json (≥ 4.5)'.
Attempting to resolve dependency 'DotNetZip (≥ 1.9.1.8)'.
Successfully installed 'Newtonsoft.Json 4.5.10'.
Successfully installed 'DotNetZip 1.9.1.8'.
Successfully installed 'Selenium.WebDriver 2.25.1'.
Successfully added 'Newtonsoft.Json 4.5.10' to [project-name].
Successfully added 'DotNetZip 1.9.1.8' to [project-name].
Successfully uninstalled 'Selenium.WebDriver 2.25.1'.
Successfully uninstalled 'DotNetZip 1.9.1.8'.
Successfully uninstalled 'Newtonsoft.Json 4.5.10'.
Install failed. Rolling back...
Failed to add reference to 'System.Drawing'. Please make sure that it is in the Global Assembly Cache. 
```

该命令在混乱之前运行良好。我创建了一个项目并使用System.Drawing成功编译并运行了一个程序，所以VS2012确实可以看到该库。

我之前发起重新安装的问题是，我的 VC/C++ 编译器不能包含任何基本 C 库，如 stdio.lib 等。这仍然没有解决，但不是这个问题的重点，因为我放弃了从源代码编译。

**更新**

通过创建一个新项目、复制文件并在那里安装 Nuget 解决了这个问题。错误仍然很奇怪。

# php - 拆分日期

> ID：13086454
> 
> 赞同：0
> 
> 时间：2012-10-26T11:54:00.003
> 
> 标签：php, date, datetime

```
$one = array('start' => '2012-10-12', 'stop' => '2012-11-04', 'over' => false);
$two = array('start' => '2012-10-29', 'stop' => '2012-11-14', 'over' => true);
$three = array('start' => '2012-11-12', 'stop' => '2012-12-07', 'over' => false);

$array = array($one, $two, $three); 
```

这告诉我：

```
Array
(
    [0] => Array
        (
            [start] => 2012-10-12
            [stop] => 2012-11-04
            [over] => 
        )

    [1] => Array
        (
            [start] => 2012-10-29
            [stop] => 2012-11-14
            [over] => 1
        )

    [2] => Array
        (
            [start] => 2012-11-12
            [stop] => 2012-12-07
            [over] => 
        )

) 
```

我想要拆分这些日期的函数。如果 in array is **over = true**那么这个日期应该分割其他日期。

对于这个例子，这应该返回：

```
Array
(
    [0] => Array                  //this is changed
        (
            [start] => 2012-10-12
            [stop] => 2012-10-28
            [over] => 
        )

    [1] => Array                   //this is ok
        (
            [start] => 2012-10-29
            [stop] => 2012-11-14
            [over] => 1
        )

    [2] => Array                  //this is changed
        (
            [start] => 2012-11-15
            [stop] => 2012-12-07
            [over] => 
        )

) 
```

第二个例子：

```
$one = array('start' => '2012-10-12', 'stop' => '2012-12-04', 'over' => false);
$two = array('start' => '2012-10-29', 'stop' => '2012-11-14', 'over' => true);

$second = array($one, $two); 
```

这还给我：

```
Array
(
    [0] => Array
        (
            [start] => 2012-10-12
            [stop] => 2012-12-04
            [over] => 
        )

    [1] => Array
        (
            [start] => 2012-10-29
            [stop] => 2012-11-14
            [over] => 1
        )

) 
```

我想收到：

```
Array
(
    [0] => Array                  //this is changed - old [0] date
        (
            [start] => 2012-10-12
            [stop] => 2012-10-28
            [over] => 
        )

    [1] => Array                  //this is ok
        (
            [start] => 2012-10-29
            [stop] => 2012-11-14
            [over] => 1
        )
    [2] => Array                  //this is new - from old [0] date - next part
        (
            [start] => 2012-11-15
            [stop] => 2012-12-04
            [over] => 
        )
) 
```

*   [http://codepad.org/tqtEYstB](http://codepad.org/tqtEYstB)
*   [http://codepad.org/6fYkYVQ8](http://codepad.org/6fYkYVQ8)

我怎样才能用 PHP 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:36:59.877

试试这个。

```
foreach($arr as $key=>$val)
{
   if(isset($arr[$key+1]) && $arr[$key+1]['over'] == true)
       $arr[$key]['stop'] = date('Y-m-d', strtotime($arr[$key+1]['start'] .' -1 day'));
  if(isset($arr[$key-1]) && $arr[$key-1]['over'] == true)
       $arr[$key]['start'] = date('Y-m-d', strtotime($arr[$key-1]['stop'] .' +1 day'));
} 
```

你可以在这里找到[代码](http://codepad.org/ErNXcdCH)。

**更新：**

```
 $arr1 = $arr;
 foreach($arr as $key=>$val)
{
   if(isset($arr[$key+1]) && $arr[$key+1]['over'] == true)
   {
       $arr[$key]['stop'] = date('Y-m-d', strtotime($arr[$key+1]['start'] .' -1 day'));
       $arr[$key]['over'] = true;
   }
   if(isset($arr[$key-1]) && $arr[$key-1]['over'] == true)
   {
       $arr[$key]['start'] = date('Y-m-d', strtotime($arr[$key-1]['stop'] .' +1 day'));
       $arr[$key]['over'] = true;
   }
 }

foreach($arr1 as $key=>$val)
{
   $arr[$key]['over'] = $arr1[$key]['over'];
} 
```

您在此处**更新的** [代码](http://codepad.org/WLmdFvQN)。

# c# - 在列表视图中注册双击一行

> ID：13086456
> 
> 赞同：2
> 
> 时间：2012-10-26T11:54:02.843
> 
> 标签：c#, wpf, listview

我在用户控件中有以下列表视图。我想在整行上双击。注册双击后，我想`ICommand`在我的视图模型中调用一个。

有谁知道我该怎么做？

我知道还有其他关于此的帖子，我已经尝试了其中的解决方案（同时使用 MVVM Light 和 AttachedCommandBehavior），但是双击根本没有注册，或者它试图在我的`TVSeries`对象上调用 ICommand，这是我的模型保存行中显示的数据。

这是我的列表视图：

```
<ListView Height="456"
          HorizontalAlignment="Left"
          Margin="12,12,0,0" 
          VerticalAlignment="Top"
          Width="488"
          ItemsSource="{Binding Path=Library}"
          SelectedItem="{Binding Path=SelectedTVSeries}">

    <ListView.View>

        <GridView>

            <GridViewColumn Header="Name"
                            Width="Auto">
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=Name}"
                                   FontWeight="Bold" />
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>

            <GridViewColumn Header="Year"
                            Width="Auto">
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=Year}" />
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>

            <GridViewColumn Header="Genre"
                            Width="Auto">
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=Genre}" />
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>

        </GridView>

    </ListView.View>

</ListView> 
```

**更新**

使用[AttachedCommandBehavior](http://marlongrech.wordpress.com/2008/12/13/attachedcommandbehavior-v2-aka-acb/)时，我会收到以下错误：

> **NullReferenceException 未处理**
> 
> 你调用的对象是空的。

错误发生在以下几行（它们是 AttachedCommandBehavior 的一部分）：

```
/// <summary>
/// Executes the strategy
/// </summary>
public void Execute()
{
   strategy.Execute(CommandParameter);
} 
```

我使用如下 ACB。首先，我为 ListViewItem 声明我的样式。

<-- 语言：xml -->

```
<UserControl.Resources>
    <Style x:Key="LibraryListViewItemStyle"
           TargetType="{x:Type ListViewItem}">
        <Setter Property="acb:CommandBehavior.Event" Value="MouseDoubleClick" />
        <Setter Property="acb:CommandBehavior.Action" Value="{Binding RelativeSource={RelativeSource AncestorType=ListView}, Path=DataContext.TVSeriesDoubleClickedCommand}" />
        <Setter Property="acb:CommandBehavior.CommandParameter" Value="{Binding }" />
    </Style>
</UserControl.Resources> 
```

然后我将`ItemContainerStyle`我的列表视图设置为样式。

```
<ListView Height="456"
          HorizontalAlignment="Left"
          Margin="12,12,0,0" 
          VerticalAlignment="Top"
          Width="488"
          ItemsSource="{Binding Path=Library}"
          SelectedItem="{Binding Path=SelectedTVSeries}"
          ItemContainerStyle="{StaticResource LibraryListViewItemStyle}">

...

</ListView> 
```

有谁知道如何解决这一问题？这真的是我最近的一次。

**更新：解决方案**

出现上述错误，是因为我已将 AttachedCommandBehavior 配置为期望一个动作，但我已经实现了一个命令。从以下更改

`<Setter Property="acb:CommandBehavior.Action" Value="{Binding RelativeSource={RelativeSource AncestorType=ListView}, Path=DataContext.TVSeriesDoubleClickedCommand}" />`

到以下

`<Setter Property="acb:CommandBehavior.Command" Value="{Binding RelativeSource={RelativeSource AncestorType=ListView}, Path=DataContext.TVSeriesDoubleClickedAction}" />`

这解决了错误。

但是，我发现我更喜欢使用操作，所以我保留`acb:CommandBehavior.Action`并更改了我的实现：

```
public Action<object> TVSeriesDoubleClickedAction
{
    get
    {
        return new Action<object>(tvSeries => Console.WriteLine("*** Double clicked fired: {0}", ((TVSeries)tvSeries).Name));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:03:23.060

> 或者它尝试在我的 TVSeries 对象上调用 ICommand，这是我的模型，它保存了行中显示的数据。

发生这种情况是因为您对 ICommand 的绑定设置不正确。我建议回到您尝试过的解决方案之一，它在 TVSeries 对象上调用 ICommand 并尝试将您的绑定更改为类似于以下内容：

```
Binding="{Binding RelativeSource={RelativeSource AncestorType=ListView}, Path=DataContext.YourCommandName}" 
```

# iphone - 在应用程序 iphone 中将视频发布到 youtube

> ID：13086457
> 
> 赞同：1
> 
> 时间：2012-10-26T11:54:03.420
> 
> 标签：iphone, ios6, youtube-api

我正在开发一个应用程序，其中要求在应用程序中将 iPhone 相册的视频上传到 YouTube。我在谷歌上搜索，但无法成功。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:31:52.593

请检查[此 API](https://developers.google.com/youtube/2.0/developers_guide_protocol#Uploading_Videos.)

希望能帮助到你

# casting - Xcode中的计算结果错误

> ID：13086458
> 
> 赞同：0
> 
> 时间：2012-10-26T11:54:05.030
> 
> 标签：casting, floating-point-precision

我有这个计算：

```
float tempd = 2451545 + 0.0009 + (77.048759/360) + 4682;
NSLog(@"tempd : %f", tempd); 
```

使用 Xcode 的结果是：2456227.250000 但它应该是：2456227.21492

你们知道我做错了什么吗？我似乎无法弄清楚。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:58:16.667

由于浮点精度的限制，试试这个

```
double tempd = 2451545 + 0.0009 + (77.048759/360) + 4682;
NSLog(@"tempd : %f", tempd); 
```

# java - 防止单个表使用缓存

> ID：13086461
> 
> 赞同：3
> 
> 时间：2012-10-26T11:54:22.727
> 
> 标签：java, caching, jpa, openjpa

我们正在使用 OpenJPA 2.2.x 并且有几个表在我们的应用程序之外填充（由 Asterisk 插件）。

这迫使我们通常禁用 OpenJPA 缓存。这可能会产生不好的影响，实际上缓存对于以后的性能和调整非常方便。毕竟我认为仅仅因为一个特性而完全禁用缓存也是一个相当糟糕的设计决定。

有没有办法强制 OpenJPA 总是从数据库中读取某些表而不是使用缓存？

还是有其他流行的模式来解决这个问题？

谢谢！
塞巴斯蒂安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T13:30:02.707

看看 JPA 2.0 规范......它应该准确地概述您正在寻找的内容。

简而言之，您可以`<shared-cache-mode>ENABLE_SELECTIVE</shared-cache-mode>`在 p.xml 中设置并`@javax.persistence.Cachable`在可缓存实体中使用注释。

希望这可以帮助。

瑞克

# rcp - 运行 eclipse rcp 项目的 windows ts 中的 user.home

> ID：13086473
> 
> 赞同：0
> 
> 时间：2012-10-26T11:54:53.080
> 
> 标签：rcp, terminal-services

所以我和一个朋友使用 Eclipse RCP 创建了一个应用程序。现在我们要使用 Windows 终端服务分发它。我已经启动并运行了 Windows TS，并在上面添加了大约 6 个帐户。我还使用 TS Remote App Manager 部署了我的 Eclipse RCP 应用程序。应用程序需要在users文件夹中创建一个文件夹来存储数据，所以配置设置创建这个文件夹“@user.home/....”很好，所以现在我们尝试从我们的TS Web Access访问它地点。

我们尝试运行的前两个帐户运行良好，并且正在按照我们想要的方式运行。但是，剩下的启动应用程序但立即给我一条错误消息，说我们无权访问 C:/Users/Administrator/ 的配置文件夹...我可以看到问题是我的用户没有权限写入 Admin 文件夹，但我对为什么 user.home 引用 Admin 文件夹而不是 users 文件夹感到困惑。我尝试在其属性的配置文件和终端服务部分更改用户主文件夹，但这些都没有影响。有谁知道为什么 user.home 会返回 Admin 文件夹。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T11:43:47.793

原来“Home”键没有在用户目录中设置。可以按照此处找到的答案中的说明进行修复。[Java user.home 被设置为 %userprofile% 并且没有被解析](https://stackoverflow.com/questions/2134338/java-user-home-is-being-set-to-userprofile-and-not-being-resolved)

# xna - 法线贴图没有凹凸

> ID：13086475
> 
> 赞同：2
> 
> 时间：2012-10-26T11:54:56.823
> 
> 标签：xna, shader, hlsl

我正在尝试在平面上进行法线贴图，但我无法得到任何明显的结果:(

我的着色器

[http://pastebin.com/raEvBY92](http://pastebin.com/raEvBY92)

对我来说，着色器看起来不错，但它没有呈现所需的结果（[https://dl.dropbox.com/u/47585151/sss/final.png](https://dl.dropbox.com/u/47585151/sss/final.png)）。所有的值都被传递。当我创建网格时，法线、切线和副法线被正确计算，我已经检查过了！这是环境、漫反射、镜面反射和凹凸贴图的屏幕。

[https://dl.dropbox.com/u/47585151/sss/ambient.png](https://dl.dropbox.com/u/47585151/sss/ambient.png)

[https://dl.dropbox.com/u/47585151/sss/bumpMap.png](https://dl.dropbox.com/u/47585151/sss/bumpMap.png)

[https://dl.dropbox.com/u/47585151/sss/diffuse.png](https://dl.dropbox.com/u/47585151/sss/diffuse.png)

[https://dl.dropbox.com/u/47585151/sss/specular.png](https://dl.dropbox.com/u/47585151/sss/specular.png) 他们似乎是合法的......凹凸贴图，这是 (`bump=normalize(mul(bump, input.WorldToTangentSpace))`绝对看起来正确的结果，但对结束没有任何影响结果。也许我不了解不同空间的想法或者我改变了矩阵乘法的顺序。通过世界矩阵，我了解网格的位置和方向，它永远不会改变，它是单位矩阵。只有视图矩阵会改变并代表相机在自己的空间中的位置和方向。

我的错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T10:38:00.240

首先，如果您遇到问题，最好将所有内容都注释掉，这不属于这个。目前，环境、镜面反射甚至漫反射纹理的整个光照计算并不有趣。和

```
output.color=float4(diffuse ,1); 
```

如果您更改代码中的某些内容，您可以专注于您的问题并清楚地看到发生了什么变化。

如果你的四边形位于 z=0 的 xy 平面上，你应该改变你的光矢量，他不会工作。通常，我出于测试目的使用对角线向量（如 normalize(1,-1,1)）来防止与我的对象平行。

当我查看您的代码时，在我看来，您并没有像您所想的那样理解不同的空间；）法线贴图的基本思想是提供有关具有附加法线的表面的附加信息。它们保存在法线贴图中，因此编码为 rgb，其中 b 通常是向上向量。现在您必须将它们放入您的 3D 世界，因为它们不在世界空间中，而是在切线空间中（切线空间 = 三角形的表面空间）。因为这种转换更复杂，所以正常计算反过来。您将法线、副法线和切线转换为矩阵，将您的光矢量和视图矢量从世界空间转换为切线空间（您将世界空间 xyz 的轴映射到 tnb - 切线、法线、副法线，顺序可能错误我通常交换它们直到它起作用;))。用你的线

```
bump = normalize(mul(bump, input.WorldToTangentSpace)); 
```

您尝试将切线空间中的法线转换为切线空间。更改此设置，以便将顶点着色器中的视图和光向量转换为切线空间，并将转换后的向量传递给像素着色器。在那里，您可以在切线空间中进行光照计算。也许阅读法线贴图的附加教程，然后你就会得到这个工作！:)

PS：如果您完成了基本照明，您的镜面反射计算似乎也有一些错误。

```
float3 reflect = normalize(2*diffuse*bump-LightDirection); 
```

这条线似乎应该计算中间向量，但因此您需要视图向量并且不应该使用像漫反射这样的光照强度。但是现在一个教程可以比我更详细地解释这一点。

# java - 从 HashMap 中检索位置

> ID：13086476
> 
> 赞同：1
> 
> 时间：2012-10-26T11:55:01.597
> 
> 标签：java, map

我研究了我的键在 hashMap 中的位置。例子 ：

> ```
>  HashMap<Integer, String> ht = new HashMap();
>     ht.put(1, "c");
>     ht.put(10, "b");
>     ht.put(8, "r");
> 
>     System.out.println(ht); 
> ```

10 的位置为 3 in `HashMap`， 8 的位置为 2 ...

所以我有两个问题：

1.  如何从 HashMap 中检索这些位置？
2.  当我有很多元素时，我使用 hashMap 来检索位置或二进制搜索？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-26T11:57:06.150

[`HashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)不是排序或有序的[`Map`](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)实现，所以这里没有“位置”。

[`LinkedHashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html)是有序的，[`TreeMap`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)是排序的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T11:57:22.063

哈希映射没有顺序，因此哈希映射中没有真正的位置概念。如果您需要有序/排序的地图，请查看 TreeMap 或 LinkedHashMap。

# android - 我可以在 Android 设备上自动安装 Flash Player 吗？

> ID：13086478
> 
> 赞同：3
> 
> 时间：2012-10-26T11:55:13.660
> 
> 标签：android, flash, download, installation

如您所知，Flash Player 不再在市场上分发，但我在 Internet 上托管了一些 Flash 的 apk（示例：http: [//dh.st/w2B](http://d-h.st/w2B)）

我做了一个需要 Flash 的应用程序，所以我想知道是否可以做一些事情，如果客户点击一个按钮，它会自动下载并在他的设备上安装 Flash？

我找到了这个代码来下载我的 apk，但它在我的 Android 设备上不起作用，为什么？

```
String url = "http://charlie.d-h.st/w2B/00010/Adobe%20Flash%20Player%2011.1%20%281%29.apk";
Uri uri = Uri.parse(url.toString());
Intent browserIntent = new Intent(Intent.ACTION_VIEW, uri);
startActivity(browserIntent); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:13:44.543

是的，您可以下载 APK 并**初始化**其安装过程，但用户必须接受（或拒绝）此请求。您不能进行静默或无人值守安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:24:01.043

是的，您必须下载应用程序并使用此代码调用安装程序：

```
File appFile = new File("application.apk");
Intent installIntent = new Intent(Intent.ACTION_VIEW);
installIntent.setDataAndType(Uri.fromFile(appFile),"application/vnd.android.package-archive");
startActivity(installIntent); 
```

或者您可以使用[本教程](http://www.kanatorn.info/2012/01/21/android-install-apk-programmatically-without-user-prompt/)在有根设备上进行静默操作。

或使用以下代码从市场安装应用程序：

```
Intent market = new Intent(Intent.ACTION_VIEW)
    .setData(Uri.parse("market://details?id=com.mypackage.name"));
startActivity(market); 
```

# xcode - NSTableView 没有填充任何数据

> ID：13086484
> 
> 赞同：1
> 
> 时间：2012-10-26T11:55:48.260
> 
> 标签：xcode, nstableview, populate

我正在尝试通过 Apple 文档中的示例代码设置一个非常基本的 NSTableView 和一列。我正在以编程方式设置它，因为目前 Cocoa 绑定对我来说仍然有点像黑暗艺术，但是当我构建和运行时，我的应用程序中没有数据。我的代码中是否缺少某些内容？（我还通过 Interface Builder 连接了我的数据源和委托，所以也不能这样。）

接口文件

```
#import <Cocoa/Cocoa.h>

@interface RLTAppDelegate : NSObject <NSApplicationDelegate, NSTableViewDataSource, NSTableViewDelegate>

@property (assign) IBOutlet NSWindow *window;
@property (weak) IBOutlet NSScrollView *tableView;

@property (copy) NSArray *nameArray;

@end 
```

实施文件

```
#import "RLTAppDelegate.h"

@implementation RLTAppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {
    _nameArray = [[NSArray alloc] initWithObjects:@"Ryan", @"Steven", @"Scott", nil];
}

- (NSInteger)numberOfRowsInTableView:(NSTableView *)tableView {

        return _nameArray.count;
}

- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {

    NSTextField *result = [tableView makeViewWithIdentifier:@"withoutIcon" owner:self];

    result.stringValue = [self.nameArray objectAtIndex:row];

    return result;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-14T17:55:07.223

我尝试了同样的事情，结果发现 NSTextField 结果没有被实例化。我最终使用

```
NSTextField *result = [[NSTextField alloc]init];
result.string = [_nameArray objectAtIndex:row]; 
```

这很好用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:04:49.803

我想你错过了

```
@property (weak) IBOutlet NStableView *tableview; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:09:20.983

从 xib/storyboard 连接您的 tableview 出口，不要忘记设置 delagate 和数据源。

`@property (weak) IBOutlet NSTableView *tableView;`

在 Interface Builder 的 Attributes inspector 面板 (Cmd-Opt-4) 中，将 table view type 设置为 View Based。默认情况下它是基于单元格的。

您必须在左侧对象视图中或通过在编辑器中单击它来选择表视图。请注意，第一次在编辑器中单击它时，它将选择滚动视图，因此您必须第二次单击它才能选择表视图对象。

我相信您需要 Xcode 4.3 或更高版本的 OS X 10.7 SDK，因此需要基于视图的表格视图。

# javascript - 弹出窗口中的表格不起作用

> ID：13086487
> 
> 赞同：4
> 
> 时间：2012-10-26T11:56:00.143
> 
> 标签：javascript, jquery, html, twitter-bootstrap

我正在使用引导程序，我想在弹出窗口中创建一个表单。我已经这样做了，但我无法输入表单的文本字段。有谁知道为什么？

***更新**它在一个模态中。在模态之外它可以工作，但在它内部却没有......

* **update2**我想差不多了。当我打开模式和弹出框时，我无法在文本字段中输入。关闭模式后，弹出框仍然打开，然后我可以在文本字段中输入。所以文本字段和弹出窗口之间必须有一些 z-index。真的很草率，但我试过`input{z-index:9999;}`了，但没有用

```
<a href="#" class="add_nr" data-nummer-id="nr_1" rel="popover">

<div id="add_number" class="popover">
    <div class="addnr" id="nr_1">
        <form class="form-inline">
            <div class="controls">
                <input type="text" placeholder="Artist">
            </div>
            <div class="controls">
                <input type="text" placeholder="Number">
            </div>
            <a href="#">cancel</a>
            <button type="submit" class="btn">add number</button>
        </form>
    </div>
</div>

$(function(){
        $('.add_nr').on('click', function(event){
            var $this = $(this);
            event.preventDefault();
            $('.add_nr').not($this).popover('hide');
            $this.popover('show');

        }).popover({
            trigger: 'manual',
            placement: 'bottom',
            content: function(e) {
                var $this = $(this),
                nr_id = $this.data('nummer-id');
                return $('#' + nr_id + '.addnr').html();
            }
        })
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:21:23.737

当一个 Modal 启动时，它会保持对自身的关注，防止表单中的元素获得焦点。一个简单的解决方法是在模式启动时禁用侦听器：

```
$('body').on('shown','.modal', function() {
  $(document).off('focusin.modal')
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-20T16:02:12.450

对于遇到此问题的任何人（带有无法使用模态的表单的弹出框）以及使用 Bootstrap 4 的人，您可以通过`data-modal="false"`在打开模态的按钮/控制器上使用来解决此问题。例如：

```
<button type="button" class="btn" data-toggle="modal" data-target="#new" data-focus="false"> 
```

如果你使用 JS 打开你的模式，你可以传入一个`focus`选项。[此处](https://getbootstrap.com/docs/4.5/components/modal/#options)有关选项的完整文档

# objective-c - iOS - 如何使用 UISlider 控制 UIBezierPath 绘图？

> ID：13086489
> 
> 赞同：0
> 
> 时间：2012-10-26T11:56:09.160
> 
> 标签：objective-c, ios, uislider, uibezierpath

我想使用 UISlider 控制 UIBezierPath 的绘制。

目的是能够擦洗时间线 (UISlider) 并根据滑块的当前位置使线 (UIBezierPath) 绘制。

这样当我向前擦洗时，路径会向前渲染，而当我向后擦洗时，路径会向后渲染。

我有代码可以根据我添加反向路径的示例代码在两个方向上渲染路径图（https://github.com/ole/Animated-Paths）

我很难理解的主要事情是当我移动滑块时如何渲染路径，因为我不能真正使用动画，因为它们不会随着滑块的移动而更新。

干杯达米安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T18:32:41.220

如果您正在跟踪 UISlider 的“[控制事件](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIControl_Class/Reference/Reference.html)”，例如这样：

```
[yourSlider addTarget:self action:@selector(seekBegan:) forControlEvents:UIControlEventTouchDown];
[yourSlider addTarget:self action:@selector(seekContinues:) forControlEvents:UIControlEventTouchDragInside];
[yourSlider addTarget:self action:@selector(seekEnded:) forControlEvents:UIControlEventTouchUpInside]; 
```

..然后您可以在“seekContinues:”中制作动画。我不能说它会多么顺利！因为可能有很多对该方法的调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T15:31:12.783

所以我发现我无法使用动画来实现我想要的，所以我使用了一个自定义 UIView 子类并在它的 drawRect 方法中实现了处理动画的代码

基本上我在子类中设置了一个索引来控制drawrect方法绘制的点数。

这为我提供了所需的方法，并允许我根据滑块更改值。

对于绘图，我使用 CGContextMoveToPoint 和 CGContextAddLineToPoint 来渲染路径

干杯

# eclipse - 将 Eclipse 表单标题中的消息放在标题下方的一行中

> ID：13086490
> 
> 赞同：3
> 
> 时间：2012-10-26T11:56:21.190
> 
> 标签：eclipse, layout

我在 Eclipse 表单标题中的错误消息方面遇到了一些问题。目前，布局左侧有标题，右侧有工具栏按钮，我们放在标题（使用`Form.setMessage()`）上的任何消息都出现在标题的一行上，即

```
TITLE TITLE Please enter a name for this file.     [buttons] 
```

这有一个问题，每当程序在较小的监视器上使用时，非最大化，或者与围绕这个的几个其他窗格一起使用，工具栏会被压缩并且消息会被荒谬地截断。例如，您可能会看到：

```
TITLE TITLE Plea...ile. [buttons] 
```

缓解此问题的一种方法是在标题下方的一行中显示错误消息（最好不要在按钮下方，因为它们非常高）。有什么方法可以做到这一点吗？使用换行符会导致非常奇怪的外观，错误消息缩进以与标题的末尾对齐：

```
TITLE TITLE                                        [buttons]
            Please enter a name for this file. 
```

显然，这根本没有解决问题，只会让它看起来更糟。我们追求的是：

```
TITLE TITLE                                        [buttons]
Please enter a name for this file. 
```

有任何想法吗？

# python - python中的透明对象版本控制

> ID：13086493
> 
> 赞同：3
> 
> 时间：2012-10-26T11:56:24.390
> 
> 标签：python, versioning

我想在他们不知道的情况下对对象进行版本控制。

像这样的东西：

```
class Versioned(object):
   ...
   def version(self):
       ...

class Foo(Versioned):

   def __init__(self, a):
      self.a = a

foo = Foo(123)
assert foo.version() == 1

foo.a = 1
foo.a = 2
foo.a = 3

assert foo.version() == 4 
```

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:12:35.493

快速破解：

```
class Versioned(object):
    version = 0

    def __init__(self):
        self.version = 0

    def _increaseVersion(self):
        super(Versioned, self).__setattr__('version', self.version+1)

    def __setattr__(self, attr, value):
        super(Versioned, self).__setattr__(attr, value)
        self._increaseVersion()

    def __delattr__(self, attr):
        super(Versioned, self).__delattr__(attr)
        self._increaseVersion()

class Foo(Versioned):
    def __init__(self, a):
        self.a = a
        super(Foo, self).__init__()

foo = Foo(123)
print 'value:', foo.a
print 'version:', foo.version
foo.a = 23
print 'value:', foo.a
print 'version:', foo.version
del foo.a
print hasattr(foo, 'a')
print 'version:', foo.version 
```

输出：

```
value: 123
version: 1
value: 23
version: 2
False
version: 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:11:18.250

```
class Versioned(object):
    def __init__(self):
        self.version = 0
    def __setattr__(self, name, value):
        if name == 'version':
            object.__setattr__(self, 'version', value)
        else:
            object.__setattr__(self, name, value)
            object.__setattr__(self, 'version', self.version +1) 
```

例子：

```
class Foo(Versioned):
    pass

f = Foo()
print f.version  # prints 0

f.a = 1
print f.version # prints 1

f.b = 3
print f.version # prints 2

f.b = 33
print f.version # prints 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T11:59:36.543

请看一下[https://github.com/swisscom/cleanerversion](https://github.com/swisscom/cleanerversion)。如果我正确理解了您的要求，那么它完全符合您的要求。

由于我们需要一个有点持久的解决方案，因此该模块建立在 Django 之上，它允许将这些对象写入任何 Django 支持的关系数据库。

# asp.net-mvc - asp.net mvc 设置数字格式默认十进制千位分隔符

> ID：13086494
> 
> 赞同：3
> 
> 时间：2012-10-26T11:56:25.200
> 
> 标签：asp.net-mvc, number-formatting

无论文化如何，如何在 asp.net mvc 中为格式化数字设置默认的十进制和千位分隔符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T11:59:37.603

您可以创建一个`DisplayTemplate`来处理这样的数字在您的视图中如何显示：

`/Views/Shared/DisplayTemplates/float.cshmtl`：

```
@model float
@string.Format("{0:N2}", Model); 
```

然后你可以从你的观点中这样称呼它，如果`Amount`是类型`float`：

```
@Html.DisplayFor(m => m.Amount) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T14:10:54.797

您需要指定自定义数字格式才能实现您要查找的内容。 这是关于创建自定义字符串格式化函数[的 MSDN 。](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

如果您确实需要自定义千位分隔符，请创建您自己的 NumberFormatInfo 变量，将您想要的值分配给千位分隔符（如果需要，还可以使用小数）。然后将自定义格式应用于您的号码。

```
var numberFormatter = new CultureInfo( "en-US", false ).NumberFormat;
numberFormat.NumberDecimalSeparator = ";";
numberFormat.NumberGroupSeparator = "-";
var myNumber = 1234567.89;
var myFormattedNumber = myNumber.ToString("#,###.##", numberFormatter);

//myFormattedNumber -> 1-234-567;89 
```

[MSDN 中有关 NumberFormat 类的](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.aspx)一些信息

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-26T14:03:24.430

To control the thousands separator you'll have to apply your changes to the `NumberFormat` for the current culture.

If you want this to happen regardless of the current culture you can simply clone the current culture, apply your modified `NumberFormat` and set it as the current one.

In an MVC app you would typically do this during Application_BeginRequest

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    newCulture = (CultureInfo)CultureInfo.CurrentCulture.Clone();
    newCulture.NumberFormat.NumberGroupSeparator = "~";

    System.Threading.Thread.CurrentThread.CurrentCulture = newCulture;
    System.Threading.Thread.CurrentThread.CurrentUICulture = newCulture;
} 
```

Now you can use the 'normal' formatting options of ToString() to further control the formatting according to your needs:

```
var a = 3000.5;
var s = a.ToString('N:2') // 3~000.50
s = a.ToString('N:4') // 3~000.5000 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-14T15:35:19.370

variable.ToString("n2") - 这在 ASP.Net MVC Razor 中对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-26T11:57:22.330

```
string.Format("{0:N2}", yourLovelyNumber); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-29T11:10:37.430

我将发布最终对我有用的代码。在控制器上，在 OnActionExecuting 函数上：

```
ViewBag.CurrentNumberFormat = new System.Globalization.CultureInfo("en-US", false).NumberFormat;
ViewBag.CurrentNumberFormat.NumberDecimalDigits = 2;
ViewBag.CurrentNumberFormat.NumberDecimalSeparator = "~";
ViewBag.CurrentNumberFormat.NumberGroupSeparator = " "; 
```

在视图中：

```
 @((1234567.435).ToString("#,###.##", ViewBag.CurrentNumberFormat)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-01T13:38:41.223

我有同样的问题，可以推荐**autoNumeric**插件[https://github.com/autoNumeric/autoNumeric](https://github.com/autoNumeric/autoNumeric)

包括插件：

```
<script src="~/Scripts/autoNumeric/autoNumeric.min.js" type="text/javascript"></script> 
```

html:

```
 <input type="text" id="DEMO" data-a-sign="" data-a-dec="," data-a-sep="." class="form-control"> 
```

脚本：

```
<script>
 jQuery(function($) {
$('#DEMO').autoNumeric('init');   
 });
</script> 
```

您只能输入数字，如果您输入 100000,99，您将看到 100.000,99。

# eclipse - Flash Builder 智能感知 - 无法随机检测类成员

> ID：13086499
> 
> 赞同：0
> 
> 时间：2012-10-26T11:56:49.333
> 
> 标签：eclipse, ide, compiler-errors, flash-builder

突然，flash builder 停止识别类的数据成员。当我输入 obj. 智能感知窗口不显示任何数据成员或方法。昨天我遇到了 4.6 的问题，现在遇到了 4.0 的问题。昨天我将源文件导入新项目以解决此问题。我认为这与较新的版本有关，但我也在 4.0 中得到了这个。这确实是一个巨大的问题。

我做了所有的尝试

重新打开项目重新启动 FB 三重检查导入包/类语法错误

很多人来到这里都有类似的问题，我相信这不是导入包/类或任何语法的问题，因为它突然随机发生在随机类中。

不仅如此，当我 ctl+click 变量（它应该将光标驯服到变量声明）时，IDE 会抛出错误消息“代码导航错误：找不到源”

我没有在这里粘贴任何代码，因为正如我之前所说，我确信它与任何语法、导入问题（简而言之不是编码问题）无关，而只是某种 FB 内存/堆栈或其他东西。

请让我知道是否有人遇到此问题并找到解决方案，而不是将源代码复制到新项目中

# asp.net - 是否有任何现有的 Web 控件允许以以下方式输入文本和图像

> ID：13086500
> 
> 赞同：0
> 
> 时间：2012-10-26T11:56:53.603
> 
> 标签：asp.net

我想知道是否有任何文本框类型的 Web 控件可以近似 Word 进行简单的所见即所得编辑？我不是在谈论所谓的 HTML 或富文本控件。（事实上​​，如果用户不使用颜色和字体大小，我会更喜欢。）我需要的是一个控件，它允许非技术用户直观地复制图像并粘贴它们，而不必摆弄 HTML 标签。这在当前的网络技术中是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:14:08.853

看看[HtmlEditorExtender](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/HtmlEditorExtender/HTMLEditorExtender.aspx)，从 asp.net ajax 控件可以很简单，并且很容易添加到你的 asp.net 项目中。

完整项目：[http ://ajaxcontroltoolkit.codeplex.com/](http://ajaxcontroltoolkit.codeplex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:00:01.557

您可以使用[CKEditor](http://ckeditor.com/demo)。然后，您可以对其进行自定义，以便您不想显示的选项（颜色、字体大小、html 编辑）不显示。否则，没有内置的 .net 控件可以完成此操作。

# servlets - 在 JBoss 7 上查找 EJB

> ID：13086502
> 
> 赞同：0
> 
> 时间：2012-10-26T11:57:05.887
> 
> 标签：servlets, jar, ejb, jboss7.x, ear

我开发了非常简单的 Hello World EJB (3.x)，并将其部署在 JBoss 7.1 上。

我可以从独立应用程序中成功调用此 EJB。当试图从 servlet 调用它时，我找到了 EJB。

我将 EJB 打包在 JAR 中，将 servlet 打包在 WAR 中。这似乎是 servlet 无法访问 EJB 的原因。那可能是真的吗？

一旦我将 EJB JAR 和 servlet WAR 打包到同一个 EAR 中，它就可以工作了。

那是假定的行为，还是即使不使用 EAR，我也可以完成这项工作？

也许有人可以对此有所了解。

我很确定我不需要在早期的 JBoss 版本上做这些事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:17:15.970

根据 Java EE 规范，部署的应用程序应该是隔离的，除非它们在同一个 EAR 归档中。所以你看到的行为是正确的。

这与 JBoss 4 或 JBoss 5 的默认配置不同，后者没有存档隔离（这本质上是一件坏事，但通常很方便......）。

EAR 打包有点烦人，但可以由 IDE 或 Maven 自动完成。

此外，在 Java EE v. 6 的情况下，您可以将具有本地接口的 EJB 组件打包到 WAR 存档中，从而简化部署。

# binding - OCaml 库的绑定和自省

> ID：13086504
> 
> 赞同：4
> 
> 时间：2012-10-26T11:57:09.813
> 
> 标签：binding, ocaml, idl

我想编写一个 OCaml 库，它将被 C 甚至 python 等其他编程语言使用。

我不确定它是否可行，我想我需要放弃一些类型安全性并将运行时检查添加到动态类型语言的接口中。

可行吗？是否有工具可以实现自动生成绑定的目标？我认为像 Corba 这样的东西不适合 ocaml ABI，但我可能错了。

编辑：通过放弃运行时要求并仅使用具有 llvm 前端的语言，我想我可以将 llvm 用作常见的 ABI，但这似乎很棘手。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T12:16:30.817

OCaml 有一个[与 C 代码交互](http://caml.inria.fr/pub/docs/manual-ocaml/manual033.html)的 FFI 。绑定的代码必须用 C 编写，而不是 OCaml（它没有 C 值的直接表示，而 C 有 OCaml 值的表示）。我的建议是：

1.  在 C 方面，决定 C 程序员想要的最佳导出接口（或 Python 程序员从 C 接口开始编写 Python 绑定）
2.  在 OCaml 端定义一个“低级层”，使您的 OCaml 值*尽可能接近*C 表示
3.  编写一些 C 包装器，将这种低级 OCaml 表示转换为您的最佳 C 表示

步骤（2）的原因是步骤（3）尽可能小。从 C 端操作 OCaml 值有点痛苦，尤其是您可能会冒着与垃圾收集器交互错误的风险，这意味着段错误——而且您没有任何类型安全性。所以你在 C 端做的工作越少越好。

有一些项目可以为你做一些包装工作。[例如CamlIDL](http://forge.ocamlcore.org/projects/camlidl/)，我认为[Swig](http://www.swig.org/)对 OCaml 有一些支持。不过，我从未使用过这些，所以我无法发表评论。

如果您知道要将界面转换为哪种高级语言，则可能存在不需要 C 步骤的专用桥。例如，有一些库可以直接与 Python 表示（搜索 Pycaml，不确定它们是否经过实战测试）或 Java 运行时（[OCamlJava](http://ocamljava.x9c.fr/)项目）直接交互。AC 界面仍然是一个安全的赌注，它将允许其他人创建通向他们自己语言的桥梁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:15:31.127

这是可行的，但你需要了解涉及的主题，比如 GC 是如何工作的。看看这个：[http ://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual033.html#toc148](http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual033.html#toc148)

您需要注意存根代码中的类型，否则您可以保持类型安全。

# php - 使用 strtolower() 和 preg_replace() 创建 slug

> ID：13086511
> 
> 赞同：1
> 
> 时间：2012-10-26T11:57:29.757
> 
> 标签：php, regex, clean-urls

> **可能重复：**
> [正则表达式清理（PHP）](https://stackoverflow.com/questions/3022185/regular-expression-sanitize-php)

我想让我的链接搜索引擎优化。在我开始之前，链接看起来像这样：

```
http://www.domain.tld/index.php?page=blog 
```

我的目标是将其更改为：`http://www.domain.tld/blog`. 现在可以了。

我将 htaccess 更改为：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^\w+$ index.php?page=$0 [L]
RewriteCond %{THE_REQUEST} index\.php
RewriteCond %{QUERY_STRING} ^page=(\w+)$
RewriteRule ^index\.php$ /%1? [R=301,L]
RewriteRule ^blog/(\d+)-([\w-]+)$ index.php?page=single_news&id=$1&headline=$2 
```

现在我想更改任何博客条目标题的 URI。他们看起来像这样：`http://www.domain.tld/index.php?page=single_news&id=2&headline=This%20Is%20A%20Headline`

我想让它们看起来像这样：`http://www.domain.tld/blog/2-this-is-a-headline` 我在 div 类“news_headline”中生成我的标题链接（见下文）。

```
<div id="main">
<?php
$query = "SELECT `id`, `headline`, `writer`, `content`, DATE_FORMAT(date,\"%d. %M %Y\") AS `date` FROM `blog` ORDER BY `id` DESC";
$news_resource = mysql_query($query) or die(mysql_error());
?>

<?php
$all_news = array();
$five_news = array();
for($i = 0; $news = mysql_fetch_object($news_resource); $i++){
if($i < 5){
  $five_news[] = $news;
}
$all_news[] = $news;
}
?>

<?php foreach($five_news as $news)
{ ?>

<div class="news_bg">
<div class="news_headline"><a href="blog/<?php echo $news->id; ?>-<?php echo $news->headline; ?>"><?php echo $news->headline; ?></a></div>
<div class="news_infoline_top"><?php echo $news->date; ?> &middot; <?php echo $news->writer; ?></div>
<div class="news_text"><?php echo $news->content; ?></div>
</div>
<?php } ?>
</div> 
```

使用我的 htaccess（见上文），链接现在是这样的：

```
http://www.domain.tld/blog/2-This Is A Headline 
```

我已经得到了帮助，一个好人给了我这个代码片段，使链接看起来像我想要的，但我不知道如何使用它们：

```
$urititle = strtolower(preg_replace('/[^\w-]+/','-', $title)); 
```

和

```
$_GET['headline'] != $urititle 
```

我搞不清楚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:31:26.553

你已经很接近了：

*   您将 ID 放在有趣部分的开头。这允许您通过唯一*且*快速的 ID 查询您的数据库。
*   您已经了解需要将标题的文本转换为它的*slug*变体，并且您已经知道这是字符串处理。

您还有一些步骤可以完成此操作。索姆笔记：

*   为自己创建一个执行字符串转换的函数。这里重要的部分是，您可以简单地调用它。
*   当对文章的请求进来时，根据从字符串中获取的 ID 值获取文章：`$assigned = sscanf($slug, '%d-', $id);`
*   对于 SEO，执行与创建链接时相同的操作。然后比较当前链接是否*仍然*正确（标题可能已更改）。如果没有，请永久重定向到正确的链接。

就是这样！

# objective-c - XCode - 查找错误

> ID：13086515
> 
> 赞同：2
> 
> 时间：2012-10-26T11:58:02.110
> 
> 标签：objective-c, xcode, debugging

我对 XCode (4.5) 比较陌生，并且在查找错误时遇到了一些问题。

当我尝试使用模型 segue 打开一个可以将项目添加到列表的视图时，我的项目突然开始抛出以下错误 - 这以前是有效的。

> “...-[TestUnit isEqualToString:]：无法识别的选择器发送到实例 0x89d4250”

我有一个使用断点的谷歌，我已经在我的断点列表中添加了一个“所有异常断点”，但这没有任何区别，我的控制台仍然对我没有太大帮助（在我的新眼中），我已经不知道在我的项目中这个错误在哪里......

我曾经`NSLog`追踪到控制台，并且错误似乎发生在 prepareForSegue 中，我什至注释掉了`isEqualToString`项目中的每一次出现，并且仍然抛出错误......

有人会介意给我一些急需的指示来深入了解这一点吗？

非常感谢，

马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-06T06:29:25.700

转到 Xcode -> 断点导航器 -> 添加 + -> “添加异常断点” -> 运行项目

一旦发生异常检查崩溃的位置，打印对象引用， `it have desire value or not?`

# apache - 使用 .htaccess 将两个文件列入白名单以执行

> ID：13086521
> 
> 赞同：1
> 
> 时间：2012-10-26T11:58:18.630
> 
> 标签：apache, .htaccess

我有一个网站，里面有一个图片文件夹。

我有两个问题：

1.  我想禁用该目录中的所有脚本执行（即没有 PHP/Perl/Python 任何东西。）
2.  我的图像文件夹中有两个 php 文件，分别称为 gradient.php 和 rgba.php——我照常运行这些文件。

我如何设置我的`.htaccess`文件来做到这一点。`.htaccess`此外，是否可以将这些指令合并到站点根目录中，而不是在图像目录中放置一个新指令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T19:44:54.763

您可以将这些规则添加到站点根目录中的 htaccess 文件中：

```
# check if the request is for the images folder
RewriteCond %{REQUEST_URI} ^/images/

# check that it isn't a request for an image
RewriteCond %{REQUEST_URI} !\.(jpe?g|png|gif|bmp)$ [NC]

# check that it isn't a request for the 2 ok php files
RewriteCond %{REQUEST_URI} !^/images/(gradient|rgba)\.php$

# forbid access
RewriteRule ^ - [L,F] 
```

这应该使它的任何请求`/images/`都不会以 jpg/jpeg/png/gif/bmp （或您要添加到正则表达式的任何其他扩展名）或 not`gradient.php`或结尾`rgba.php`，将导致 403 被禁止。

* * *

编辑：

> 我不希望它们被禁止，我只是希望它们不执行——它是一个上传文件夹，所以我基本上希望如果有人上传一个我没有检测到的秘密 PHP 代码的 JPG，它不会不跑

只要将 jpg 和其他图像映射到正确的 mime/类型（通过`AddType image/jpeg .jpg`），它就不会被交给 php 处理程序，并且那里的任何代码都不会被执行。如果要使用默认处理程序提供所有文件，则需要`AddHandler default-handler php`在 images 目录中的 htaccess 文件中进行设置。然后，您需要将渐变和 rgba 文件移到其他目录。您不能有选择地从 htaccess 文件中设置处理程序，尽管您可以使用`<Location>`块在您的 vhost 配置中设置处理程序。

* * *

编辑2：

我错了，您可以使用该`H`标志使用规则设置自定义处理程序。所以在上面的规则中`[L,F]`，你可以这样做，而不是`[L,H=default-handler]`任何不是图像或`gradient.php`将`rgba.php`被发送到默认处理程序的东西（例如 php 文件将按原样发送，而不是由 mod_php 处理和执行） .

所以你可以这样做：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/images/(gradient|rgba)\.php$
RewriteRule ^ - [L,H=default-handler] 
```

# java - 写入新的 xsd 文件时出现 FileNotFoundException

> ID：13086522
> 
> 赞同：0
> 
> 时间：2012-10-26T11:58:26.213
> 
> 标签：java, xml, file, xsd, filenotfoundexception

我已经使用 DOMparser 解析了一批 XML Schema 文件。然后我添加了几个注释，这对于我正在创建的应用程序是必不可少的。然后我想将这些新的“预处理”文件写入一个新位置，我得到一个 FileNotFound 异常（访问被拒绝）。

这是我正在编写文件的代码片段：

```
Transformer tFormer = TransformerFactory.newInstance().newTransformer();

// Set output file to xml
tFormer.setOutputProperty(OutputKeys.METHOD, "xml");

// Write the document back to the file
Source source = new DOMSource(document);
File preprFile = new File(newPath(xmlFile));
    // The newPath function is a series of String operations that result in a new
    relative path

try {
    // Create file if it doesn't already exist;
    preprFile.mkdirs();
    preprFile.createNewFile();
} catch (Exception e) {
    e.printStackTrace();
}

Result result = new StreamResult(preprFile);
tFormer.transform(source, result); 
```

我得到的错误如下：

```
java.io.FileNotFoundException: absolutePathHere (Access is denied) 
```

指向上述代码段中的这一行：

```
tFormer.transform(source, result); 
```

我正在使用 Windows 机器（在某处读取可能是此错误的来源），并且我已经尝试关闭 UAC，但没有成功。

我在想也许 createNewFile() 方法在创建文件后不会释放文件，但无法找到有关该文件的更多信息。

希望 StackOverflow 能再次帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:16:02.880

它可能在没有该目录权限的用户帐户下运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:35:25.120

您说“目录已创建，并且文件似乎也被创建为目录”。所以我认为它创建了名为“wsreportkbo_messages.xsd”的目录

它给您的错误可能是因为您正在尝试读取目录。**您可以使用listFiles()**列出目录中的文件。

您无法打开和读取目​​录，请使用**isFile()**和**isDirectory()**方法来区分文件和文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T08:25:47.830

我找到了解决方案：

```
File preprFile = new File(directory1/directory2/directory3/file.xsd);
File directory = new File(directory1/directory2/directory3/);

try {
// Create file if it doesn't already exist;
    directory.mkdirs();
    preprFile.createNewFile();                              
} catch (Exception e) {
    e.printStackTrace();
} 
```

谢谢您的帮助。

# webdriver - 如何成功运行这个登录程序？

> ID：13086524
> 
> 赞同：0
> 
> 时间：2012-10-26T11:58:44.233
> 
> 标签：webdriver

```
import java.io.File;

public class LoginPage { 

private final WebDriver driver;  

  public LoginPage(WebDriver driver) {    

        this.driver = driver;  } 

public void loginAs(String username, String password) {  

 DesiredCapabilities ieCapabilities = DesiredCapabilities.internetExplorer(); 
```

ieCapabilities.setCapability(InternetExplorerDriver.INTRODUCE_FLAKINESS_BY_IGNORING_SECURITY_DOMAINS, true);

// WebDriver driver = new InternetExplorerDriver(ieCapabilities);

driver.get("https://login.salesforce.com/?locale=uk");

driver.manage().timeouts().implicitlyWait(100, TimeUnit.SECONDS);

driver.findElement(By.id("username")).sendKeys(username);

driver.findElement(By.id("password")).sendKeys(password);

driver.findElement(By.id("Login")).click();ogin.loginAs("username", "password");}}

```
 }  

 public static void main(String[] args){ 
```

File file = new File("C:/Users/E20039504/Desktop/Selenium Jar/IEDriverServer.exe");

System.setProperty("webdriver.ie.driver", file.getAbsolutePath());

LoginPage login = new LoginPage(new InternetExplorerDriver());

```
login.loginAs("username", "password"); 
   }
 } 
```

我正在尝试登录 Salesforce 应用程序，但我的这段代码不起作用。请帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:28:42.003

密码文本输入的 ID 是“password”而不是“pwd”。要按下登录按钮，您还应该使用其 ID，即“登录”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T10:59:41.403

使用`password`代替`pwd`和`login`代替`login_button`

```
 driver.findElement(By.id("pwd")).sendKeys(password);   

 driver.findElement(By.className("Login_button")).click(); 
```

这段代码对我来说是正确的

```
 public class login 
         {
public static void main(String[] args) 
 {
    DesiredCapabilities ieCapabilities = DesiredCapabilities.internetExplorer(); 
           ieCapabilities.setCapability(InternetExplorerDriver.INTRODUCE_FLAKINESS_BY_IGNORING_SECURITY_DOMAINS, true);
             WebDriver driver = new InternetExplorerDriver(ieCapabilities);          
             driver.get("https://login.salesforce.com/?locale=uk");

             try {
                Thread.sleep(4000);
            } catch (Exception e) {
                // TODO: handle exception
            }
             driver.findElement(By.id("username")).sendKeys("username");   
                     driver.findElement(By.id("password")).sendKeys("password");   
                     driver.findElement(By.id("Login")).click();   

}
      } 
```

# c++ - 使用 try{...}catch(..){...} 代替 goto

> ID：13086525
> 
> 赞同：1
> 
> 时间：2012-10-26T11:58:45.477
> 
> 标签：c++, try-catch, goto

像 goto 一样使用 try-catch 是不好的做法吗？例如，简单的代码

```
try{
    if(argc<2){
        std::cout<<"no inputfile"<<std::endl;
        throw 1;
    }
    STARTUPINFO cif;
    ZeroMemory(&cif,sizeof(STARTUPINFO));
    PROCESS_INFORMATION pi;
    if(FALSE==CreateProcess(argv[1],NULL,NULL,NULL,FALSE,NULL,NULL,NULL,
                            &cif,&pi)){
        printf("smth is wrong");
        throw 1;
    }
    WaitForSingleObject(pi.hProcess, INFINITE);
    GetExitCodeProcess(pi.hProcess, &exitCode);
    std::cout<<"Process return"<<exitCode<<std::endl;
    throw 1;
}
catch(int a){
    printf("press Enter");
    getchar();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T12:00:26.373

如果你问在程序流中使用异常是否是错误的，答案是*肯定的，这是错误的*。

也就是说，对于你不太关心性能的情况，只要你不在互联网上告诉任何人，只要你没有生产要求或长长期维护要求。

在这种情况下，除了最终的成功案例之外，您似乎对所有事情都正确使用了异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:59:42.003

一般来说（就像在与语言无关的意义上，全面）使用 try/catch 机制作为控制流管理辅助是不好的做法。按预期使用它来管理异常。使用控制流构造来控制流。

# json - borswe URL testing 如何在使用 JSON 对象之前对其进行编码

> ID：13086527
> 
> 赞同：1
> 
> 时间：2012-10-26T11:58:46.760
> 
> 标签：json, url, tapestry

```
http://localhost/catalog/{"request": "catalog","user_id": "test@gmail.com","purchased": "2"} 
```

这是我的请求网址。我需要使用在浏览器中输入的示例 URL 来测试我的服务。但似乎服务器端不接受许多 JSON 项。如果我输入平面文本字符串服务器工作正常。我尝试使用[http://www.albionresearch.com/misc/urlencode.php](http://www.albionresearch.com/misc/urlencode.php)对 URL 进行编码，但仍然存在错误。

可能这是属于挂毯的问题。否则我想得到一些帮助。

以下请求有效。

```
 http://localhost/catalog/helloworld 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:54:54.123

Tapestry 在 url 中执行自己的参数编码，在客户端没有副本。

见[org.apache.tapestry5.internal.services.URLEncoderImpl.encode(String)](http://tapestry.apache.org/5.3/apidocs/org/apache/tapestry5/internal/services/URLEncoderImpl.html)

“helloworld”按预期工作的原因是没有“特殊字符”，所以转义值无论如何都等于“helloworld”。

因此，您要么需要使用 Tapestry 通过 java 对 json 进行编码，要么需要`URLEncoder`编写客户端副本。

也就是说，如果我正确理解你的问题。

**编辑**我很无聊，所以我写了客户端副本：

```
/**
 * see org.apache.tapestry5.internal.services.URLEncoderImpl.encode(String)
 * correct as at tapestry 5.3.5
 */
function tapestryUrlEncodeParameter(input)
{
    var safe = "abcdefghijklmnopqrstuvwxyz"
            + "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
            + "01234567890-_.:";

    if (input === null)
        return "$N";

    input = input.toString();

    if (input === "")
        return "$B";

    var output = "";

    for (var i = 0; i < input.length; i++)
    {
        var ch = input.charAt(i);

        if (ch === '$')
        {
            output += "$$";
            continue;
        }

        if (safe.indexOf(ch) != -1)
        {
            output += ch;
            continue;
        }

        var chHex = ch.charCodeAt(0).toString(16);
        while (chHex.length < 4)
            chHex = "0" + chHex;
        output += "$" + chHex;
    }

    return output;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:41:39.310

你有什么服务器端？无论哪种方式，如果你想这样做，你都必须在服务器端解码你编码的 json 字符串。

更好的解决方案可能是使用某种测试工具。这可以像网页中的 jquery $.get 请求一样简单，或者您可能想考虑一个更通用的 HTTP 客户端，如本文中所建议的[那样](https://stackoverflow.com/questions/7399092/json-client-tool)

# javascript - 使用javascript在IE中切断垂直下拉菜单

> ID：13086529
> 
> 赞同：0
> 
> 时间：2012-10-26T11:58:56.527
> 
> 标签：javascript, jsp

下拉框以及下拉列表中最长的选项在 IE7 中被切断。这在 Mozilla 和 chrome 中运行良好。我是 JSP 和 javascript 的新手。

我在用：

`style="width:240%"`

下拉选项是从 db 中获取的。即使该选项可见，它也会超出页面，因此看起来很奇怪。

有没有办法在 JSP 中以 2 行显示选项？

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:05:28.273

try `style = auto`，这意味着它会自动转到最长选项的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:03:23.573

如果您可以选择从样式中删除宽度，这通常会导致 IE 中的选择列表出现问题。如果没有，多行选择列表选项对于 html 选择列表控件是不可能的，但您可以使用一个 div，它可以使用 JavaScript 和 css 作为下拉列表。[http://jquery.sanchezsalvador.com/page/jquerycombobox.aspx](http://jquery.sanchezsalvador.com/page/jquerycombobox.aspx)

# c# - 输入字符串的格式不正确。格式异常未处理

> ID：13086536
> 
> 赞同：1
> 
> 时间：2012-10-26T11:59:29.953
> 
> 标签：c#

[http://i.imgur.com/E7pT9.jpg](http://i.imgur.com/E7pT9.jpg)

```
 int ctr, len;
    string gee;
    t = kalliskaBillingDataSet.Tables["DealerDetail"];
    len = t.Rows.Count - 1;     
      r = t.Rows[len];
     string id = r["DealerID"].ToString();
     gee = id.Substring(1, 3);
      ctr = int.Parse(gee); 
```

行中的输入字符串格式不正确::

```
ctr = int.Parse(gee); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:00:25.207

`E00`不是有效的十进制字符串。您需要将其解析为十六进制字符串。

使用类似的东西：

```
int.Parse(code, System.Globalization.NumberStyles.HexNumber); 
```

当然，该值可能不应该是十六进制，在这种情况下您会遇到错误。

为了更优雅地从这种情况中恢复，`int.TryParse(code, out value)`请改为使用，并检查返回值是否为真/假，指示成功/失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:00:50.067

查看屏幕截图，`code`was `E00`，无法转换为整数。

# migration - Openlaszlo embed.js 问题

> ID：13086537
> 
> 赞同：1
> 
> 时间：2012-10-26T11:59:34.340
> 
> 标签：migration, openlaszlo, lzx

我有一个处理 ctrl + s 组合键的应用程序。因此，当我按下此键时，会出现一个包含一些详细信息的新屏幕。这在 mozilla FF 15.0 和 16.0 中运行良好，但是当我在 AIR Web 浏览器运行时 3.4 中以全屏模式查看它时，浏览器被最小化并且屏幕也无法正常显示。

后来我发现，当我使用 OL 3.3 版本的 embed.js 文件时，我没有遇到这个问题，空气浏览器工作正常。但是当我使用最新的 embed-compressed.js 时，我得到了这个。知道为什么会这样吗？

我正在使用 Openlaszlo 5.0.x 这个问题也发生在 OL 4.9 的脚本中

# jquery - 通过 jQuery JSON 请求返回对象

> ID：13086539
> 
> 赞同：1
> 
> 时间：2012-10-26T11:59:39.380
> 
> 标签：jquery, json

如何在以下 jQuery 示例中正确返回对象：-

```
function get_stockists() {
    $.getJSON("/stockists/ajax_get_all", function(data) {
        //console.log(data);
    });
}

var stockists = get_stockists();
console.log(stockists); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T12:03:53.363

最好的方法不是返回，而是使用回调函数：

```
function getStockists(callback) {
    $.getJSON("/stockists/ajax_get_all", callback);
}

getStockists(function(stockists) {
    console.log(stockists);
}); 
```

# php - 当 HTML 中没有层次结构时如何使用简单的 html dom 进行抓取

> ID：13086542
> 
> 赞同：1
> 
> 时间：2012-10-26T11:59:56.297
> 
> 标签：php, simple-html-dom

```
 <td class="cinetime">
    <div>Screen: 3</div>
    <br clear="all">
    <span>1:00</span>
    <span>11:00</span>
    <span>13:00</span>
    <span>15:00</span>
    <br clear="all">
    <div>Screen: 4</div>
    <br clear="all">
    <span>12:05</span>
    <span>14:05</span>
    <span>16:05</span>
    <span>18:05</span>
    <span>20:05</span>
    <div>Screen: 3 (3D)</div>
  </td> 
```

以上是我正在编写的 HTML。

我想分别`<span>`为**屏幕 3**和**屏幕 4**获取数据。

这是我下面的代码，但它从所有`<span>`s中获取数据

```
foreach($cinema->find("td.cinetime span") as $times) {
    echo $times->plaintext;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:43:21.933

像这样的东西：

```
$dom = new simple_html_dom();
$dom->load($source);

$cinetime = $dom->find('.cinetime',0);

$screens = array();
$screenName = '';

foreach($cinetime->children() as $elem){
    if($elem->tag == 'div'){
        $screenName = $elem->innertext;
    } else
    if($elem->tag == 'span'){
        $screens[$screenName][] = $elem->innertext;
    }
}
print_r($screens); 
```

这产生了这个：

```
Array
(
[Screen: 3] => Array
    (
        [0] => 1:00
        [1] => 11:00
        [2] => 13:00
        [3] => 15:00
    )

[Screen: 4] => Array
    (
        [0] => 12:05
        [1] => 14:05
        [2] => 16:05
        [3] => 18:05
        [4] => 20:05
    )

) 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:14:48.740

您需要检查 td.cintime 中的所有元素并检查文本是否是您需要的（如 Screen: 3），然后检查其他元素是否为 span，然后将其放入某个数组中，直到获得另一个 div。这意味着一个屏幕块已经结束。重复直到你得到你需要的一切。

伪代码：

```
$screensData = array();
$start = false;
foreach($cinema->find("td.cintime *") as $times) {
   if($times->tag == 'div') {
      $start = false;
      if($times->plaintext == 'Screen: 3') {
         $screensData[3] = array();
         $start = 3;
      }
   }

   if($start && $times->tag == 'span') {
      $screensData[$start][] = $times->plaintext;
   }
} 
```

# qt - QTableWidget：我应该怎么做才能在选定的行之间单击时保持行选择？

> ID：13086544
> 
> 赞同：0
> 
> 时间：2012-10-26T12:00:09.377
> 
> 标签：qt

在选定项目中单击鼠标可选择当前项目，取消选择其他项目。

# php - PHP 5.4 和 Facebook Hiphop 兼容性

> ID：13086547
> 
> 赞同：8
> 
> 时间：2012-10-25T15:00:46.417
> 
> 标签：php, facebook, hiphop

我想知道是否有人知道 Facebook 的 Hiphop 库不支持 PHP 5.4 中的哪些功能。Hiphop github wiki 上有一些问题，例如[这个](https://github.com/facebook/hiphop-php/issues/582)问题，状态非常模糊：

> HipHop 当前不支持所有 PHP 5.4 功能。

目前我只需要假设，出于工作目的，所有新功能都不兼容，因为没有指定可以工作，如果有人对此有任何见解，那就太好了，在此先感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T15:22:26.277

远离以下情况：

**特质声明**：

```
trait vehicleInfo {
    function getSpeed() { /*1*/ }
    function getWheels() { /*2*/ }
}

class Car extends Vehicle {
    use vehicleInfo;
    /* ... */
}

class Motorcycle extends Vehicle {
    use vehicleInfo;
    /* ... */
} 
```

**PHP 5.4 数组实例化**：

```
$array = [
    "name" => "John Smith",
    "job" => "Basketweaver",
]; 
```

**函数数组解引用**：

```
function small_numbers() {
    return array (0, 1, 2);
}

echo small_numbers()[0]; 
```

**实例化的类成员访问**：

```
(new Foo)->bar(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T18:11:28.030

HipHop 目前支持 Daniel Li 指出的所有功能，除了可能的二进制数。事实上，HipHop 多年来一直支持闭包。运行时在不断改进，因此请留意未来您正在等待出现的功能。

如果有疑问，并且您有时间，只需尝试使用某个功能并查看它是否有效。

```
akrieger@vb:~/www$ hhvm features.php
2
akrieger@vb:~/www$ cat features.php
<?php

trait vehicleInfo {
    function getSpeed() { /*1*/ }
    function getWheels() { return [1,2,3,4]; }
}

class Vehicle {}

class Car extends Vehicle {
    use vehicleInfo;
    /* ... */
}

class Motorcycle extends Vehicle {
    use vehicleInfo;
    /* ... */
}

$getMotorcycleWheels = function() {
  return (new Motorcycle())->getWheels();
};

echo $getMotorcycleWheels()[1];
echo "\n";
akrieger@vb:~/www$ 
```

# php - Joomla 登录错误：用户名和密码不正确时出现 500

> ID：13086557
> 
> 赞同：3
> 
> 时间：2012-10-26T12:01:01.620
> 
> 标签：php, login, joomla

此错误仅在网站在线时出现， [https://www.sugarsync.com/pf/D7656891_67295915_916242](https://www.sugarsync.com/pf/D7656891_67295915_916242)

但在 localhost 中，这似乎没问题。 [https://www.sugarsync.com/pf/D7656891_67295915_916482](https://www.sugarsync.com/pf/D7656891_67295915_916482)

我怎样才能解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-09T07:29:44.053

只需评论这一行

```
$this->triggerEvent('onUserLoginFailure', array((array) $response)); 
```

库/joomla/application/application.php 第 774 行

我遇到了同样的问题，我尝试了很多方法，我发现这是最简单的解决方案。好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-02T13:16:18.020

在我更改了我的 CPanel 用户名后，我的 www.nairaforsms.com 上也发生了同样的事情。

我通过编辑 configuration.php 文件中的日志和 tmp 路径解决了这个问题。我用路径中的新用户名替换旧用户名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:04:09.467

如果密码不正确，当我们没有足够的权限时会出现 500 错误消息。检查你的`tmp and logs folder`。而且`error.php`在日志文件夹中也必须有写权限。

# vba - 外部宏的错误处理

> ID：13086558
> 
> 赞同：3
> 
> 时间：2012-10-26T12:01:20.987
> 
> 标签：vba, excel

我只是想知道是否可以对外部宏进行错误处理。基本上我想要实现的是我每天都有成千上万的 excel 工作簿，我想打开每个工作簿并从中运行宏（只需使用 Application.run 功能即可轻松完成）

```
Application.Run ("'" & ActiveWorkbook & "'!Export") 
```

我想要实现的是，如果该外部宏发生错误，我想运行错误解决功能。

这是我到目前为止所拥有的

```
Dim str_SearchFile, str_FileName, str_SearchPath As String
Dim wb_WorkBook As Workbook

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    str_ThisBook = ActiveWorkbook.Name 'Set the current workbook for later reference
        str_SearchPath = Sheets("Control Panel").Range("E2")
        str_SearchFile = Sheets("Control Panel").Range("E2") & "\*.xls*" 'Sets the file type to search for
        str_NextFile = Dir(str_SearchFile, vbDirectory) 'Sets the amount of files in the directory matching the criterea (.xls)

        Do While Len(str_NextFile) > 0
            On Error Resume Next
            Set wb_WorkBook = Workbooks.Open(Filename:=str_SearchPath & "\" & str_NextFile, Password:="")
            If Err.Number = 0 Then
                On Error GoTo 0
                Application.Run ("'" & str_NextFile & "'!Export")
                str_FileName = str_SearchPath & "\Done" & "\" & str_NextFile
                wb_WorkBook.Save
                wb_WorkBook.Close
                FileCopy (str_SearchPath & "\" & str_NextFile), str_FileName
                Kill (str_SearchPath & "\" & str_NextFile)
            End If
            str_NextFile = Dir
        Loop

    Application.ScreenUpdating = True
    Application.DisplayAlerts = True

End Sub 
```

非常欢迎任何建议！

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T13:30:49.203

您将无法按照您尝试的方式使其工作。

[MSDN on Error Statement](http://msdn.microsoft.com/en-us/library/office/gg251688.aspx)表明它（强调添加）：

> 启用错误处理例程并指定例程**在过程**中的位置；也可用于禁用错误处理例程。

[VBE 术语表](http://msdn.microsoft.com/en-us/library/office/gg264568.aspx)将程序定义为：

> 作为一个单元执行的命名语句序列。例如，Function、Property 和 Sub 是过程的类型。过程名称始终在模块级别定义。所有可执行代码都必须包含在一个过程中。过程不能嵌套在其他过程中。

这意味着在调用另一本书中的宏之前调用错误处理，将在被调用的宏中被忽略（通过测试确认）。

您能够启用错误处理的唯一方法是在调用宏之前实际修改工作簿中的代码......这非常复杂。供您参考，这里是一个网页，提供了[从 VBA 编辑项目代码的示例](http://thedailywtf.com/Articles/Self-Modifying-VBA.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:33:32.923

我处理这个问题的最简单方法是将您的外部工作簿的“导出”子更改为一个返回值的函数 - 比如说一个整数。

然后你可以做的就是将错误捕获放入该函数中，并根据它可以返回的过程的结果，说：

```
0 = All Went Well
1 = Failed to do XXX
2 = Failed to do YYY 
```

然后，您可以将代码更改为以下内容：

```
Select Case Application.Run ("'" & str_NextFile & "'!Export")
Case 0
   MsgBox "All Went Well"

Case 1
   MsgBox "Failed to do XXX"

Case 2
   MsgBox "Failed to do YYY"

End Select 
```

这将允许您将错误捕获放在它所属的位置并了解该过程是如何运行的。

希望这可以帮助

# java - 如何在 FormatterRegistry 中注册 Spring 3.1 打印机或解析器

> ID：13086559
> 
> 赞同：2
> 
> 时间：2012-10-26T12:01:20.937
> 
> 标签：java, spring

Spring 3.0 引入了[Type Conversion API](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/validation.html#core-convert)和[Field Formatting API](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/validation.html#format)，包含 [`Printer`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/format/Printer.html), [`Parser`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/format/Parser.html), [`Formatter`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/format/Formatter.html)( `Converter`), [`FormatterRegistry`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/format/FormatterRegistry.html)... （并且 Spring 3.1 引入了[`FormatterRegistrar`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/format/FormatterRegistrar.html).）

但我发现没有办法注册我自己的`Printer`或`Parser`. 我只找到了注册`Formatter`的方法`FormatterRegistry`。

所以我的问题是，我是否需要实现一种方法来注册`Printer`或`Parser`自己注册，或者我是否忽略了一些东西。

*问题不是我自己如何实现它，问题很简单，我是否忽略了一些东西。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T19:21:22.433

由于 a`Formatter`既是a**又**是 a `Printer` **，**`Parser`您可以实现此接口并按照此处所述注册您的类：http: [//blog.springsource.org/2011/02/21/spring-3-1-m1-mvc-namespace-增强和配置/](http://blog.springsource.org/2011/02/21/spring-3-1-m1-mvc-namespace-enhancements-and-configuration/)

# algorithm - 使用 Java 输出类似 Union-Jack 的 ASCII 艺术

> ID：13086561
> 
> 赞同：1
> 
> 时间：2012-10-26T12:01:36.883
> 
> 标签：algorithm, ascii

我被分配给一个算法输出编码（用纯 ASCII 码，没有花哨的图纸），对于给定的 K，一个 KxK 正方形，对称线为 x，其他东西为 o。但是，如果 K 是偶数，我们使用两条 x'es 来标记水平和垂直对称线。此外，我们不能在整个源代码中使用两个以上的循环。

所以我有两个想法。首先是分析每个点应该满足的坐标——每个点应该有一个方程告诉我们给定的 (Kx, Ky) 点是 x 还是 o。我们把它放在一些 if 和只是 while 循环的交替中，遍历所有可能的 (Kx, Ky)，将一些点标记为 x，其他点标记为 y。这需要一个循环。

另一个想法，相当蛮力但不让我们分析所有点，是有一组变量，然后我们用来连接字符串。让我解释一下：我们有一个 while 循环检查“height”变量（每转一圈，我们将其减一），在其中我们使用一些 repeatString 的自定义方法，该方法也包含一个 while 循环（它只是将字符串乘以给定t 次）。所以我们有这样的事情：

```
while(height):
if height==maxHeight OR ==0: print repeatString("x", maxWidth)
else if height is an element of markedKy (an array telling us which Ky's to mark as x'es as the whole): print repearString("x", maxWidth)
else print "x"+(howManySpaces*" ")+"x" ["xx" if even] + (howManySpaces*" ") +"x" 
```

...等等。我上面写的当然很松散，并没有涵盖很多情况（实际上，它做了很多），但我认为这可能会使我的概念不那么混乱。然而，第二种方法对编码来说真的很痛苦——我现在可以看到它是多么容易出错。

有没有第三种最好的方法？我对此很头疼，虽然它看起来很容易，但想不出其他任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T21:54:57.310

我可以只使用一个循环来做到这一点...... ;-)

```
input K
half := K / 2 , square := K * K
for pixel = 0; pixel < square; ++pixel
    horiz := pixel % K , vert := pixel / K
    if horiz = vert or horiz + vert + 1 = K // the diagonals
            or horiz = half or horiz = K - 1 - half // the middle vertical line(s)
            or vert = half or vert = K - 1 - half // the middle horizontal line(s)
        output "x"
    else if ShouldBeO(horiz + 1, vert + 1)
        output "o"
    else
        output " "
    if horiz = K - 1 // add "and vert < K - 1" if you don't want the last EOL
        output EndOfLine
end for 
```

# ruby-on-rails - 如何在 Rails 应用程序中启动乘客？

> ID：13086563
> 
> 赞同：2
> 
> 时间：2012-10-26T12:01:53.577
> 
> 标签：ruby-on-rails, apache, passenger

我的单个 apache 服务器中有两个应用程序。说 App1 和 App2。

现在我只想在一个应用程序上启动乘客。

如何在单个应用程序上启动和停止乘客？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:35:58.427

如果你想将乘客作为一个模块添加到 Apache 中，乘客 gem 附带一个脚本，如果你的 PATH 中有乘客，你只需在终端输入：

```
passenger-install-apache2-module 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:27:31.003

尝试这种方式启动乘客

[http://www.modrails.com/documentation/Users%20guide%20Standalone.html#_usage](http://www.modrails.com/documentation/Users%20guide%20Standalone.html#_usage)

# java - Netty 增加 ChannelBuffer 大小

> ID：13086564
> 
> 赞同：6
> 
> 时间：2012-10-26T12:01:57.180
> 
> 标签：java, netty

您好，我有一个带有应该接受字符串的处理程序的 Netty 服务器。它似乎只接收最多 1024 字节的内容。我怎样才能增加缓冲区大小。我已经试过了

```
bootstrap.setOption("child.sendBufferSize", 1048576); 
bootstrap.setOption("child.receiveBufferSize", 1048576); 
```

没有成功。

处理程序如下

```
public class TestHandler extends SimpleChannelHandler {

@Override
public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) {

    ChannelBuffer buf = (ChannelBuffer) e.getMessage();

    String response = "";

    if (buf.readable()) {

        response = buf.toString(CharsetUtil.UTF_8);
        System.out.println("CONTENT: " + response);
    }

    System.out.println(response);

}

@Override
public void exceptionCaught(ChannelHandlerContext ctx, ExceptionEvent e) {
    e.getCause().printStackTrace();

    Channel ch = e.getChannel();
    ch.close();
} 
```

}

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T15:23:23.187

你在使用 UDP 吗？如果是这样，数据包将最大为 1024 字节。此代码注释在 QOTM 代码示例中：

> 允许最大 1024 字节的数据包（默认为 768）。您可以分别增加或减少此值以避免截断数据包或改善内存占用。
> 
> 另请注意，无论您如何配置此选项，路由器都可能截断或丢弃大型 UDP 数据包。在 UDP 中，如果数据包大于特定大小，则数据包将被截断或丢弃，具体取决于路由器配置。IPv4 路由器截断，IPv6 路由器丢弃一个大数据包。这就是为什么在 UDP 中发送小数据包是安全的。

如果您使用 TCP，则应在处理程序之前将帧解码器和字符串解码器添加到管道中；像这样的东西：

```
pipeline.addLast("frameDecoder", new DelimiterBasedFrameDecoder(80960, Delimiters.lineDelimiter()));
pipeline.addLast("stringDecoder", new StringDecoder(CharsetUtil.UTF_8));
pipeline.addLast("myHandler", new TestHandler()); 
```

请注意，您将需要修改您的测试处理程序，因为 MessageEvent 实际上将包含您的字符串。

```
@Override
public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) {
    String response = (String) e.getMessage();
    System.out.println(response);
} 
```

说得通 ？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-05T06:00:38.507

在 4.0.10.Final 版本中，UDP 缓冲区大小设置为 2048 字节。

如果你想增加它设置 ChannelOptions 如下：

```
option(ChannelOption.SO_RCVBUF, int bytes) 
```

并且

```
option(ChannelOption.RCVBUF_ALLOCATOR, new FixedRecvByteBufAllocator(int Bytes)) 
```

# c++ - 在 C++ 中实现虚拟析构函数

> ID：13086567
> 
> 赞同：6
> 
> 时间：2012-10-26T12:02:04.813
> 
> 标签：c++, virtual-destructor

我开始学习 c++，但我被困在析构函数中。我们需要实现一个向量，这就是我目前所拥有的。

```
#include<string.h>
#include<cassert>
#include<iostream>

using namespace std;
template<class T>
class Vector {
    template<class U> friend ostream& operator<<(ostream&, const Vector<U>&);
private:
    T* data;
    unsigned len;
    unsigned capacity;
public:
    Vector(unsigned = 10);
    Vector(const Vector<T>&);
    virtual ~Vector(void);
    Vector<T>& operator =(const Vector<T>&);
    bool operator==(const Vector<T>&);
    T& operator[](unsigned);
};

//PROBLEM! 
template <class T>
~ Vector() {
    delete data;

}

template<class T>
Vector<T>::Vector(unsigned int _capacity)
{
    capacity = _capacity;
    len = _capacity;
    data = new T[_capacity];
}

template<class T>
Vector<T>::Vector(const Vector<T> & v)
{
    len = v.len;
    capacity = v.capacity;
    data = new T[len];
    for (unsigned int i = 0; i < len; i++)
        data[i] = v.data[i];
}

template<class T>
Vector<T> & Vector<T>::operator = (const Vector<T> & v)
{
    delete[ ] data;
    len = v.len;
    capacity = v.capacity;
    data = new T [len];
    for (unsigned int i = 0; i < len; i++)
        data[i] = v.data[i];
    return *this;
}

template<class T>
bool Vector<T>::operator == (const Vector<T> & v)
{
    bool check = true;
    check &= (len == v.len);
    if (!check) return false;
    check &= (capacity == v.capacity);
    if (!check) return false;
    for (unsigned int i = 0; i < len; i++) {
        check &= (data[i] == v.data[i]);
        if (!check) return false;

    }
    return true;
}

template<class T>
T& Vector<T>::operator[](unsigned int index)
{
    return data[index];
} 
```

给出了接口，我需要实现它。但这与 C 和 Java 有很大的不同，我有点迷茫。

* * *

在第二个练习中，我们需要使用 a) 以前的 Vector 实现作为派生类和 b) Vector 作为组合类来实现类似的东西，所以也许我们会在其中一种方法中使用虚拟析构函数？

```
void testAssociativeArray() { 
AssociativeArray<String, int> table;
 table["abc"] = 15;
 table["jkl"] = 12;
 table["xyz"] = 85;
 assert(table["jkl"], 12);
 }

template<class P, class Q>
class Pair {
P p;
Q q; public:
      Pair(const P& _p = P(), const Q& _q = Q()): p(_p), q(_q) {}
      P& objectP() {return p;}
      Q& objectQ() {return q;}
}; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-26T12:06:05.280

首先，你为什么认为析构函数应该是`virtual`？你在使用多态性吗？

其次，您对阵列的使用`delete`不正确。

由于您使用：

```
data = new T[length]; 
```

您必须使用数组语法：

```
delete [] data; 
```

第三，您需要将命名空间放在所有类函数定义的前面：

```
template <class T>
Vector<T>::~Vector()
{
    delete [] data;
} 
```

只是为了您的信息，您像这样声明析构函数......

```
virtual ~Vector(void); 
```

正如我所提到的，`virtual`除非您以多态方式将此类用作基类或派生类，否则这是不必要的。有关何时需要使用`virtual`析构函数的更多信息，请查看[此问题的答案](https://stackoverflow.com/a/461224/1732980)。

此外，`void`参数中的 也是不必要的。这曾经在旧的 C 标准中是必需的，但在 C++ 中却没有。

您应该能够像这样声明它：

```
~Vector(); 
```

* * *

如果您`AssociativeArray<P,Q>`使用与 的**has-a**关系进行定义`Vector<T>`，那么您可以简单地使该类包含一个`Vector<Pair<P,Q> >`. `virtual`在这种情况下，不需要声明方法，但仍然可以使用——有一些额外的开销。

如果您`AssociativeArray<P,Q>`使用与 的**is-a**关系进行`Vector<Pair<P,Q> >`定义，那么您应该在 中定义一些`virtual`方法`Vector<T>`，包括`virtual`析构函数。

只有在通过指针和引用多态地使用对象时，`virtual`方法的使用才有意义。请参阅[此页面](http://www.cs.bu.edu/teaching/cpp/polymorphism/intro/)。

```
AssociativeArray<String,Int>* myDerivedMap = new AssociativeArray<String,Int>();
delete myDerivedMap; //NO virtual methods necessary here. using a pointer to derived class

Vector<Pair<String,Int> >* myBaseMap = new AssociativeArray<String,Int>();
delete myBaseMap; //virtual methods ARE necessary here. using a pointer to base class 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T12:04:37.177

```
template<class T> 
Vector<T>::~Vector()
{
    delete [] data;
} 
```

请注意，您必须使用`delete []`而不是`delete`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T12:05:55.067

应该

```
template <class T>
Vector<T>::~Vector() {
    delete[] data;
} 
```

# haskell - 阿克曼函数的记忆

> ID：13086568
> 
> 赞同：17
> 
> 时间：2012-10-26T12:02:05.680
> 
> 标签：haskell, ghc, ackermann

我想计算`A(3, 20)`应该`2^23 - 3 = 8388605`使用的 Ackermann 函数（参见维基百科）的值`Data.MemoCombinators`。我的代码是：

```
{-# LANGUAGE BangPatterns #-}
import      Data.MemoCombinators as Memo

ack = Memo.memo2 Memo.integral Memo.integral ack'
    where
        ack' 0 !n = n+1
        ack' !m 0 = ack (m-1) 1
        ack' !m !n = ack (m-1) $! (ack m (n-1))

main = print $ ack 3 20 
```

但它最终导致堆栈溢出错误;-) 可以调整它还是计算链真的那么长，甚至记忆也无济于事？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-26T14:08:02.370

阿克曼函数的要点之一是递归计算它会导致非常深的递归。

递归深度大约等于没有 meoisation 的结果（取决于你如何计算，它或多或少有几个级别）。不幸的是，如果您根据调用树填写备忘录表，那么备忘录不会给您带来太多好处。

让我们按照以下计算`ack 3 2`：

```
ack 3 2
ack 2 $ ack 3 1
ack 2 $ ack 2 $ ack 3 0
ack 2 $ ack 2 $ ack 2 1
ack 2 $ ack 2 $ ack 1 $ ack 2 0
ack 2 $ ack 2 $ ack 1 $ ack 1 1
ack 2 $ ack 2 $ ack 1 $ ack 0 $ ack 1 0
ack 2 $ ack 2 $ ack 1 $ ack 0 $ ack 0 1    -- here's the first value we can compute and put in the map
ack 2 $ ack 2 $ ack 1 $ ack 0 2            -- next three, (0,2) -> 3, (1,1)->3 and (2,0)->3
ack 2 $ ack 2 $ ack 1 3                    -- need to unfold that
ack 2 $ ack 2 $ ack 0 $ ack 1 2
ack 2 $ ack 2 $ ack 0 $ ack 0 $ ack 1 1    -- we know that, it's 3
ack 2 $ ack 2 $ ack 0 $ ack 0 3            -- okay, easy (0,3)->4, (1,2)->4
ack 2 $ ack 2 $ ack 0 4                    -- (0,4)->5, (1,3)->5, (2,1)->5
ack 2 $ ack 2 5                            -- unfold
ack 2 $ ack 1 $ ack 2 4
ack 2 $ ack 1 $ ack 1 $ ack 2 3
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 2 2
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 2 1
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 2 0  -- we know that one, 3
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 3          -- that one too, it's 5
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 1 5                  -- but not that
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 1 4
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 3  -- look up
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 5          -- easy (0,5)->6
ack 2 $ ack 1 $ ack 1 $ ack 1 $ ack 0 6                  -- now (1,5)->7 is known too, and (2,2)->7
ack 2 $ ack 1 $ ack 1 $ ack 1 7
ack 2 $ ack 1 $ ack 1 $ ack 0 $ ack 1 6
ack 2 $ ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 5
ack 2 $ ack 1 $ ack 1 $ ack 0 $ ack 0 7                  -- here (1,6)->8 becomes known
ack 2 $ ack 1 $ ack 1 $ ack 0 8                          -- and here (1,7)->9, (2,3)->9
ack 2 $ ack 1 $ ack 1 9
ack 2 $ ack 1 $ ack 0 $ ack 1 8
ack 2 $ ack 1 $ ack 0 $ ack 0 $ ack 1 7                  -- known
ack 2 $ ack 1 $ ack 0 $ ack 0 9                          -- here we can add (1,8)->10
ack 2 $ ack 1 $ ack 0 10                                 -- and (1,9)->11, (2,4)->11
ack 2 $ ack 1 11
ack 2 $ ack 0 $ ack 1 10
ack 2 $ ack 0 $ ack 0 $ ack 1 9                          -- known
ack 2 $ ack 0 $ ack 0 11                                 -- (1,10)->12
ack 2 $ ack 0 12                                         -- (1,11)->13, (2,5)->13
ack 2 13
ack 1 $ ack 2 12
ack 1 $ ack 1 $ ack 2 11
ack 1 $ ack 1 $ ack 1 $ ack 2 10
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 2 9
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 2 8
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 2 7
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 2 6
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 2 5 -- uff
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 13
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 1 12
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 11 -- uff
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 13         -- (1,12)->14
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 14          -- (1,13)->15, (2,6)->15
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 15
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 1 14
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 13
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 15          -- (1,14)->16
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 16                  -- (1,15)->17, (2,7)->17
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 17
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 1 16
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 15
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 17                  -- (1,16)->18
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 18                          -- (1,17)->19, (2,8)->19
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 1 19
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 1 18
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 17
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 19                          -- (1,18)->20
ack 1 $ ack 1 $ ack 1 $ ack 1 $ ack 0 20                                  -- (1,19)->21, (2,9)->21
ack 1 $ ack 1 $ ack 1 $ ack 1 21
ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 1 20
ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 19                          -- known
ack 1 $ ack 1 $ ack 1 $ ack 0 $ ack 0 21                                  -- (1,20)->22
ack 1 $ ack 1 $ ack 1 $ ack 0 22                                          -- (1,21)->23, (2,10)->23
ack 1 $ ack 1 $ ack 1 23
ack 1 $ ack 1 $ ack 0 $ ack 1 22
ack 1 $ ack 1 $ ack 0 $ ack 0 $ ack 1 21                                  -- known
ack 1 $ ack 1 $ ack 0 $ ack 0 23                                          -- (1,22)->24
ack 1 $ ack 1 $ ack 0 24                                                  -- (1,23)->25, (2,11)->25
ack 1 $ ack 1 25
ack 1 $ ack 0 $ ack 1 24
ack 1 $ ack 0 $ ack 0 $ ack 1 23                                          -- known
ack 1 $ ack 0 $ ack 0 25                                                  -- (1,24)->26
ack 1 $ ack 0 26                                                          -- (1,25)->27, (2,12)-> 27
ack 1 27
ack 0 $ ack 1 26
ack 0 $ ack 0 $ ack 1 25
ack 0 $ ack 0 27
ack 0 28
29 
```

所以当你需要计算一个新的（未知）`ack 1 n`时，你需要计算两个新`ack 0 n`的，当你需要一个新的`ack 2 n`，你需要两个新`ack 1 n`的，因此需要四个新`ack 0 n`的，这一切都不是太戏剧化。

但是当你需要一个新的`ack 3 n`，你需要`ack 3 (n-1) - ack 3 (n-2)`新的`ack 2 k`。综上所述，在您计算完之后`ack 3 k`，您需要计算`2^(k+2)`的新值`ack 2 n`，并且通过调用结构，这些都是嵌套调用，因此您会得到一堆`2^(k+2)`嵌套的 thunk。

为避免这种嵌套，您需要重新构建计算，例如通过强制新需要`ack (m-1) k`的`k`，

```
 ack' m 1 = ack (m-1) $! ack (m-1) 1
    ack' m n = foldl1' max [ack (m-1) k | k <- [ack m (n-2) .. ack m (n-1)]] 
```

这允许计算以一个小堆栈（缓慢）运行（但它仍然需要大量的堆，似乎需要一个量身定制的记忆策略）。

只存储`ack m n`，`m >= 2`并评估`ack 1 n`它好像它被记忆减少了足够多的必要内存，以至于计算`ack 3 20`使用不到 1GB 的堆完成计算（使用`Int`而不是`Integer`让它运行大约两倍的速度）：

```
{-# LANGUAGE BangPatterns #-}
module Main (main) where

import qualified Data.Map as M
import Control.Monad.State.Strict
import Control.Monad

type Table = M.Map (Integer,Integer) Integer

ack :: Integer -> Integer -> State Table Integer
ack 0 n = return (n+1)
ack 1 n = return (n+2)
ack m 0 = ack (m-1) 1
ack m 1 = do
    !n <- ack (m-1) 1
    ack (m-1) n
ack m n = do
    mb <- gets (M.lookup (m,n))
    case mb of
      Just v -> return v
      Nothing -> do
          !s <- ack m (n-2)
          !t <- ack m (n-1)
          let foo a b = do
                c <- ack (m-1) b
                let d = max a c
                return $! d
          !v <- foldM foo 0 [s .. t]
          mp <- get
          put $! M.insert (m,n) v mp
          return v

main :: IO ()
main = print $ evalState (ack 3 20) M.empty 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:02:24.677

如果您有足够的内存，请尝试[增加堆栈大小](http://www.haskell.org/ghc/docs/6.10.4/html/users_guide/runtime-control.html)：

```
$ ghc -O2 -rtsopts source.hs
$ ./source +RTS -K128M 
```

# ruby - Jekyll 模板使用类似 django 的液体块/继承

> ID：13086569
> 
> 赞同：12
> 
> 时间：2012-10-26T12:02:07.107
> 
> 标签：ruby, django, inheritance, jekyll, liquid

我正在深入了解 Jekyll，并希望将其用作通用前端开发平台，但我遇到了 Liquid 模板语言的限制，特别是它与 Django 模板的区别。

我发现了液体继承 gem，它添加了 Django 中最重要的 Extends 和 Block 语法。这篇博文进一步扩展了 gem 以适应 Jekyll 的文件系统： http: [//www.sameratiani.com/2011/10/22/get-jekyll-working-with-liquid-inheritance.html](http://www.sameratiani.com/2011/10/22/get-jekyll-working-with-liquid-inheritance.html)

问题是它似乎并没有以与 Django 完全相同的方式实现块，这实际上使 gem 无用。

我有两个 jekyll“布局”——为了便于理解——parent.html 和 child.html。这些都不包含 YAML 部分。

家长

```
<html>
{% block foo %} {% endblock %}
</html> 
```

孩子

```
{% extends _layouts/parent.html %}
{% block foo %}
  <div>
    Bar comes next:
    {% block bar %} {% endblock %}
  </div>
{% endblock %} 
```

然后我有一个 jekyll 页面，其中包含一个 YAML 部分，因此：

```
---
title: test
---

{% extends _layouts/child.html %}
{% block bar %}My title is {{ page.title }} {% endblock %} 
```

我的期望：

```
<html>
  <div>
    Bar comes next:
    My title is test
  </div>
</html> 
```

我得到什么：

```
<html>
  <div>
    Bar comes next:
  </div>
</html>My title is test 
```

似乎有些东西未能将 mypage.html 中的块视为有资格插入到父/子的合适位置，尽管它显然仍在做某事。

我不是 ruby​​ 开发人员，而且对 Jekyll 相当陌生，所以我需要帮助确定这个堆栈的哪一部分失败了。github上的液体继承问题表明其他人正在遇到这个块嵌套问题：[https ://github.com/danwrong/liquid-inheritance/issues/3](https://github.com/danwrong/liquid-inheritance/issues/3)

我已经尝试了几个液体继承的分支，其中许多显然解决了这个问题正则表达式，但似乎没有一个可以解决这个问题。

我想做的事情根本不可能吗？看来我至少完成了 85% 的路，最后一点需要修复。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T20:51:39.433

我不确定这是否会在 Jekyll 中起作用。我可能错了，但这是我的理由：

[每个页面都使用https://github.com/mojombo/jekyll/blob/master/lib/jekyll/convertible.rb](https://github.com/mojombo/jekyll/blob/master/lib/jekyll/convertible.rb)中的 do_layout 渲染出来

这以递归方式工作 - 它处理页面的内容，然后处理页面的布局，然后处理该布局的布局等等，将 YAML 变量传递到链上（因此它们始终在父模板中作为 {{ page 。任何}}）。

这意味着唯一被传递的东西是 YAML 值，以及在 Liquid 处理后的“内容”值是什么。我不知道它在其他地方是如何完成的，但这似乎与块的想法不相容，因为它们要求你分别传递两个块。

从根本上说，在我看来，问题在于 Jekyll 已经有了一种简单的继承形式——通过您可以赋予布局的“布局”属性。从根本上说，我认为这与液体模板兼容。

说了这么多，我不确定您是否已经用尽了使用 YAML、_include 和模板逻辑的限制。如果您打算将 Django 样式块放入您的*内容*中，为什么不这样做：

内容：

```
---
title: some title
secondary_content: |
    Here is some *secondary* content that will be [markdownified](http://example.com).
    It can run to multiple lines and include
    * Lists
    * Good things
    * Etc
---

And here is the main content, as per usual 
```

模板：

```
<html>
<article>
    <h1>{{ page.title }}</h1>
    {{ content }}
</article>
<aside>
{{ page.secondary_content | markdownify}}
</aside> 
```

如果您想保持模板干净，并为不同类型的页面提供不同的内容，您可以使用各种包含：

模板：

```
<aside>
{% include sidebar_negotiation.html %}
</aside> 
```

_includes/sidebar_negotiation.html：

```
{% if page.type = 'foo' %}
{% include sidebar_foo.html %}
{% else if page.type = 'bar' %}
{% include sidebar_bar.html %}
{% endif %} 
```

然后将您的页面类型特定的东西放在这些文件中。显然你可以直接包含它，但最好将它抽象出来。这些包含将获取 YAML 中的所有变量。

如果这一切都不是一个胜利，你总是可以尝试 Hyde：[http](http://hyde.github.com/) ://hyde.github.com/它是用 Python 编写的，使用 Jinja2（基本上是 Django 模板++），并且做同样的事情。

# wpf - 运行时 WPF 的样式和模板

> ID：13086572
> 
> 赞同：1
> 
> 时间：2012-10-26T12:02:20.883
> 
> 标签：wpf, templates, mvvm, styles

我在 WPF 中创建了一个自定义的可重用控件。我希望在使用它时，消费者为控件中的项目提供样式和模板。这不是一个微不足道的项目控制。我正在使用的组件内使用第三方图形控件。我希望消费者在使用我的控件时提到节点/边的样式和模板。实现这一目标的最佳方法是什么？

问候，

# php - MYSQL 在第 2 列等于的值的开头插入

> ID：13086574
> 
> 赞同：0
> 
> 时间：2012-10-26T12:02:32.287
> 
> 标签：php, mysql

我正在尝试运行查询以在列中的值等于的列中插入`"/2/3/"`值的开头。我知道基本的 MYSQL，但在构建这个时遇到了一些问题。因此，感谢任何帮助。`"Value"``"attribute_id"``"703"`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:05:11.443

```
UPDATE table
SET value = '/2/3/' + value
WHERE attribute_id = 703 
```

（替换`table`为您的表的名称）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:33:40.907

UPDATE table_name SET value=CONCAT('/2/3',value) WHERE attribute_id = 703 注意：将 table_name 替换为你的表名

# python - Python ConfigParser，DEFAULT 部分中的插值，可能吗？

> ID：13086580
> 
> 赞同：0
> 
> 时间：2012-10-26T12:03:34.980
> 
> 标签：python, python-2.7, configparser

我正在使用`SafeConfigParser`，我的配置文件包含一个`[DEFAULT]`部分，我正在使用下面的代码来提取该部分。

```
parser = SafeConfigParser(allow_no_value=True)
parser.optionxform = str  # makes names case sensitive
defaultAttributesDic = parser.defaults() 
```

但是，我的`DEFAULT`部分包括**插值**，例如：

```
A= 10000
B= %(A)s 
```

但问题是`defaults()`返回实际的原始值（不是插值）。这是为什么？什么时候有用？我不明白这个决定背后的原因？

我`parser.items(section)`用来阅读其他部分，效果很好。值是插值返回的。我应该跳过`defaults`并`items("DEFAULT")`改用吗？请给我解释一下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:45:04.850

[defaults()](http://docs.python.org/library/configparser.html#ConfigParser.RawConfigParser.defaults)是继承自[RawConfigParser](http://docs.python.org/library/configparser.html#rawconfigparser-objects)的方法，**不**支持插值。

我认为您应该保留该`[DEFAULT]`部分以便为其他部分提供默认值，而不是试图将其*“滥用”*为*“正常”*部分。该`[DEFAULT]`部分具有特殊含义，甚至不包含在`sections()`or之类的方法中`has_section()`。

如果您需要*“默认”*部分，只需将其命名为`DEFAULT`.

# asp.net - 在不下载整个邮件的情况下获取附件名称

> ID：13086582
> 
> 赞同：0
> 
> 时间：2012-10-26T12:03:48.410
> 
> 标签：asp.net, openpop

如果不使用 OpenPop.Net 下载整个消息，我找不到获取附件文件名的方法

`Pop3Client.GetMessageHeaders`不公开有关附件的任何数据。提供附件数据，`Pop3Client.GetMessage(messageNumber)`但首先下载整个消息。

也许有人知道该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T07:26:23.477

我是 OpenPop.Net 的主要开发者。如果您查看[POP3 的 RFC，](https://www.rfc-editor.org/rfc/rfc1939)您会注意到无法获取有关附件的信息。为了获取消息头，OpenPop.Net 当前发送`TOP <messagenumber> 0`命令来接收头。

由于附件标头位于邮件正文的深处，因此我看不出任何 POP3 客户端应该如何满足您的要求。

IMAP 是另一种协议，它包含允许 IMAP 客户端获取有关消息中每个部分的信息的功能。你可能想朝那个方向走。

# service - 如何从 Java 应用程序使用 Microsoft Dynamics AX 2009 AIF Web 服务

> ID：13086588
> 
> 赞同：1
> 
> 时间：2012-10-26T12:03:59.610
> 
> 标签：service, web, axapta, dynamics-ax-2009, aif

我从客户端收到了 MS 动态 AX 2009 AIF Web 服务 WSDL url，并尝试从 Java 客户端使用它。当我连接到 IIS 服务器（Web 服务 url）并通过 NTLM 身份验证传递 SOAP 请求时，我收到如下所述的错误消息

```
 401 - Unauthorized: Access is denied due to invalid credentials.
You do not have permission to view this directory or page using the credentials that you supplied. 
```

任何人都可以请帮助并让我知道应该遵循的方法吗？

在 java 中，我使用 apache DefaultHttpClient 类建立与 IIS 服务器的连接，使用 JCIFS 库进行 NTLM V2 身份验证。我试图在不使用 java 中的 MS dynamics AX .Net Business 连接器的情况下使用 Web 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:36:35.013

检查这两个问题：

*   [vb.Net 代码使用 AX 2009 ReturnOrderInService web 服务](https://stackoverflow.com/questions/6796567/vb-net-code-to-use-ax-2009-returnorderinservice-web-service)
*   [使用 AIF Web 服务连接到 Microsoft Dynamics AX 2009](https://stackoverflow.com/questions/6705173/using-aif-webservices-to-connect-to-microsoft-dynamics-ax-2009)

但也许你的问题是防火墙问题，服务所在的地址不是公开的。

# javascript - 在单页应用程序中访问会话变量

> ID：13086589
> 
> 赞同：0
> 
> 时间：2012-10-26T12:04:04.430
> 
> 标签：javascript, mongodb, backbone.js, lithium

我正在开发一个简单的（！）2 页应用程序。

第 1 页：从用户那里获取有关为他的旅行创建的程序的基本详细信息——旅行名称、日期等。

单击保存后，将使用 Lithium PHP 中的控制器在 MongoDB 上为程序创建一个条目。生成一个 id 并将其作为 URL 中的参数传递到第 2 页，如下所示：

```
$this->redirect('/iplans/save/' . $program_id . '/' . $program_name); 
```

Page 2：是一个使用许多 Backbone 脚本（托管在单独的 js 文件中）的单页应用程序，并允许用户添加他的程序的日期细节。没有 js 脚本是内联的。

我希望在按下 Finish 时将主干集合保存在服务器端，但需要使用此集合发送 program_id，以便在 MongoDB 中更新正确的程序。

问题：

1.  如何确保来自锂/php服务器端的program_id被它们自己的js文件（不是内联）中的主干javascript拾取
2.  除了 Controller::redirect 之外还有哪些其他选项可以将控件从 page1 转发到 page2？
3.  可以使用哪些其他选项来传递 program_id 以及骨干/JS 层可能需要的任何其他值。是否有传递此类物品的标准方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:46:33.347

1.  有几个选项：

    1.  从 window.location.href 中解析出 program_id
    2.  在您的锂视图中动态创建一些 javascript。它可以很简单：
        `"<script> myvars = " . json_encode(array(...)) . "<script>"`
        然后您可以从 javascript 中读取变量。

    3.  从锂动态创建 onDomRady 函数

2.  这是一个好方法。也就是说，一页显示表单并从表单接收数据，一页显示一些数据。它们彼此不相关，这将使代码易于理解。

3.  您可以使用 AJAX/JSON 向服务器发送/接收数据。另见答案 1b,1c

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T17:36:08.517

如果它只是一个被写入会话的变量，您需要在单页应用程序中访问，只需制作一个`SessionsController`返回当前会话信息的控制器（即），并打开内容协商。

然后，您可以随时获得所需的任何密钥。

# wordpress - 主题页面宽度编辑 - 带滑块

> ID：13086590
> 
> 赞同：1
> 
> 时间：2012-10-26T12:04:06.810
> 
> 标签：wordpress, layout, themes, editing

我还有一个问题要问你们。所以我正在使用 Prospect 主题 [http://themes.wpbusinessbundle.com/prospect/](http://themes.wpbusinessbundle.com/prospect/)

而且我不知道如何在演示中显示这些元素：

1）滑块下方的白色“书写”空间与滑块的宽度完全相同（我猜在绝望的情况下我也可以用列修改它）-现在是整页

2）保持白色！当我在里面写字时，背景一直变成淡蓝色，它分成2：淡蓝色和白色

希望我可以向您展示一个示例，但我正在将其本地化，所以...希望您从中有所收获并可以帮助我？

好的，这就是我尝试编辑页面时得到的结果：http: [//www.codrutamarin.com/?](http://www.codrutamarin.com/?page_id=745) page_id= 745 --- 我希望它是深蓝色和白色，就像上面显示的原始模板一样 -并且让它在幻灯片下方居中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T04:09:27.660

哇，你做了什么;P。

您应该在 WP 的右侧菜单上制作一个主题模板为“主页”的页面。带有大按钮的大文本块被称为“号召性用语”，可以通过在页面的“可视”视图中按下可视化编辑器按钮来访问。

发布页面后，转到“外观 -> 主题”，然后在“前景”上，选择“自定义”，然后选择“静态页面”并将新主页设置为站点前端的静态页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:18:08.773

很难理解你的意思。也许拿一个打印屏幕？

# facebook-graph-api - 应用程序权限不适用，并且身份验证对话框不反映它们

> ID：13086592
> 
> 赞同：0
> 
> 时间：2012-10-26T12:04:10.410
> 
> 标签：facebook-graph-api, authentication, permissions, facebook-javascript-sdk

我有以下问题，在此先感谢您对此问题的任何帮助。

我在`Apps > [NAME-OF-THE-APP] > Permissions`（[https://developers.facebook.com/apps/[APP-ID]/permissions](https://developers.facebook.com/apps/%5BAPP-ID%5D/permissions)）中配置了我的应用程序以请求“publish_actions”，当用户第一次使用该应用程序时，如下图所示。 .

![http://f.cl.ly/items/0O0V0s3g3Y3z0t1Z2P2p/Scr​​een%20Shot%202012-10-26%20at%208.36.32%20AM.png](../Images/a5385fd98804444d2d26a76bd7275ab8.png)

问题是 Auth Dialog 没有反映这个配置，因此没有请求“publish_actions”的权限......

![http://f.cl.ly/items/12082g323w182E0U1Y05/Screen%20Shot%202012-10-26%20at%208.36.49%20AM.png](../Images/2e70d8617c8b7c6a6cf3f5cd2d1ed912.png)

我尝试了不同的“用户和朋友权限”和“扩展权限”，但身份验证对话框始终保持不变。

我使用 JavaScript SDK，这是代码，我正在尝试在 Canvas 中访问我的应用程序。

```
<script>
window.fbAsyncInit = function() {
    FB.init({appId:'398977410174164',status:true,cookie:true,xfbml:true});

    function testAPI() {
        console.log('Welcome!  Fetching your information.... ');
        FB.api('/me', function(response) {
            console.log('UserID, ' + FB.getAuthResponse()['userID'] + '.');
            console.log('Access token, ' + FB.getAuthResponse()['accessToken'] + '.');
        });
    }

    function login() {
        FB.login(function(response) {
            if (response.authResponse) {
                testAPI();
            } else {
                // cancelled
            }
        });
    }

    FB.getLoginStatus(function(response) {
        if(response.status === 'connected'){
            var signedRequest = response.authResponse.signedRequest;
        }else if(response.status === 'not_authorized'){
            login();
        }else{
            login();
        }
    });
};

(function(d){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref);
}(document));
</script> 
```

再次感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:16:12.980

在 login() 函数中使用此代码：

```
function login() {
    FB.login(function(response) {
        if (response.authResponse) {
            testAPI();
        } else {
            // cancelled
        }
    }, {scope:'publish_actions'});
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:54:45.267

*[第x次：]*

这些设置**仅**适用于从应用中心登录。（而且它们还*曾经*通过 Authenticaed Referrals 影响登录，现在已弃用。）

但是，无论何时您**自己**触发登录（就像您对 FB.login 调用所做的那样） - 您必须在此处指定权限，然后通过`scope`参数指定权限。

# asp.net - Silverlight mvvm中文本框为空时禁用按钮？

> ID：13086595
> 
> 赞同：0
> 
> 时间：2012-10-26T12:04:21.810
> 
> 标签：asp.net, silverlight, mvvm

我正在使用 MVVM 模式研究 silverlight。在设计页面中，我有三个文本框和一个按钮。这里我的要求是如果 3 文本框为空或 null 表示按钮被禁用。如何实现这一目标..任何帮助..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:26:40.600

在这里，我附上了我的编码.. Xaml：

```
<Button Content="Add"  Width="59" IsEnabled="{Binding ButtonIsEnabled}" Height="23" Margin="256,75,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" TabIndex="4" >
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="Click">
                    <si:CallDataMethod Method="AddEmployee"/>
                    <si:SetProperty TargetName="LayoutRoot" PropertyName="Background" Value="LightBlue"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </Button>
        <TextBlock FontWeight="Bold" Height="26" HorizontalAlignment="Left" Margin="47,12,0,0" Name="textBlock1" Text="First Name:" VerticalAlignment="Top" Width="77" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="130,12,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" Text="{Binding Fname,Mode=TwoWay}" TabIndex="1" AcceptsReturn="False">
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="TextChanged">
                    <si:CallDataMethod Method="ButtonIsEnabled"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </TextBox> 
        <TextBlock FontWeight="Bold" Height="25" HorizontalAlignment="Left" Margin="35,44,0,0" Name="textBlock2" Text="Second Name:" VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="130,44,0,0" Name="textBox2" VerticalAlignment="Top" Width="120" Text="{Binding Sname,Mode=TwoWay}" TabIndex="2" >
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="TextChanged">
                    <si:CallDataMethod Method="ButtonIsEnabled"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </TextBox> 
        <TextBlock FontWeight="Bold" Height="23" HorizontalAlignment="Left" Margin="45,75,0,0" Name="textBlock3" Text="Department:" VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="130,75,0,0" Name="textBox3" VerticalAlignment="Top" Width="120"  Text="{Binding Dept,Mode=TwoWay}" TabIndex="3" >
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="TextChanged">
                    <si:CallDataMethod Method="ButtonIsEnabled"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </TextBox> 
```

视图模型代码：

EmployeeListViewModel.cs

```
public bool ButtonIsEnabled
        {
            get
            {
                return !(((string.IsNullOrEmpty(this.Fname)) && (string.IsNullOrEmpty(this.Sname)) && (string.IsNullOrEmpty(this.Dept))));
            }
        }
        private string _fname;
        public string Fname
        {
            get
            {
                return _fname;
            }
            set
            {
                if (_fname != value)
                {
                    _fname = value;
                    RaisePropertyChanged("Fname");
                    //RaisePropertyChanged("ButtonIsEnabled");
                }
                else
                {
                    _fname = value;
                    RaisePropertyChanged("Fname");
                }
            }
        }

private string _sname;
        public string Sname
        {
            get
            {
                return _sname;
            }
            set
            {
                if (_sname != value)
                {
                    _sname = value;
                    RaisePropertyChanged("Sname");
                    RaisePropertyChanged("ButtonIsEnabled");
                }
                else
                {
                    _sname = value;
                    RaisePropertyChanged("Sname");
                }
            }
        }
        private string _dept;
        public string Dept
        {
            get
            {
                return _dept;
            }
            set
            {
                if (_dept != value)
                {
                    _dept = value;
                    RaisePropertyChanged("Dept");
                    RaisePropertyChanged("ButtonIsEnabled");
                }
                else
                {
                    _dept = value;
                    RaisePropertyChanged("Dept");
                }
            }
        } 
```

我的问题是：

1）它适用于第一个文本框。当我在第一个文本框中输入任何内容时，按钮处于禁用模式。但是，如果我移至第二个文本框，则表示该按钮已启用。2）我需要所有的文本框都将在仅启用按钮之后进行验证。如果任何一个文本框为空意味着按钮再次进入禁用模式..任何帮助..？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:34:15.023

如果您使用的是 Silverlight 5，那么通过自定义标记扩展有一个非常好的 MultiBinding 解决方案：[Silverlight 5 中的 MultiBinding](http://www.codeproject.com/Articles/286171/MultiBinding-in-Silverlight-5)。
还有一个`IMultiValueConverter`允许您将绑定值的集合转换为单个值（在您的情况下为布尔值）。使用扩展程序和转换器，您可以轻松实现所需的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:12:27.690

在您的 VM 中创建一个公共属性，用于检查上述条件并相应地返回一个布尔值。将此属性绑定到您的按钮`IsEnabled`属性。

确保在`PropertyChangedEvent`每个条件状态更改后触发（即在文本框更改事件中）。

# google-cloud-messaging - 收到通知时，我的 GCMIntentService 中带有 sWakeLock 的 NullPointer

> ID：13086596
> 
> 赞同：1
> 
> 时间：2012-10-26T12:04:22.140
> 
> 标签：google-cloud-messaging, power-management, intentservice, notificationmanager

WI 在我的 Android 应用中实现了推送通知。

我从我的服务器发送通知，当通知到达 Androide 设备时，我的 sWakeLock 对象上得到一个空指针。

此外，我从未调用过 runIntentInService，因为我不知道该怎么做！

这是调用堆栈：

```
10-26 13:31:55.410: E/AndroidRuntime(15351): FATAL EXCEPTION: IntentService[71715548489]
10-26 13:31:55.410: E/AndroidRuntime(15351): java.lang.NullPointerException
10-26 13:31:55.410: E/AndroidRuntime(15351):    at com.example.android.stackwidget.GCMIntentService.onHandleIntent(GCMIntentService.java:42)
10-26 13:31:55.410: E/AndroidRuntime(15351):    at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:65)
10-26 13:31:55.410: E/AndroidRuntime(15351):    at android.os.Handler.dispatchMessage(Handler.java:99)
10-26 13:31:55.410: E/AndroidRuntime(15351):    at android.os.Looper.loop(Looper.java:137)
10-26 13:31:55.410: E/AndroidRuntime(15351):    at android.os.HandlerThread.run(HandlerThread.java:60) 
```

这也是我的 GCMIntentService 类的源代码：

```
import android.app.IntentService;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.PowerManager; 
import android.os.PowerManager.WakeLock;
import android.util.Log;

public class GCMIntentService extends IntentService {

    public GCMIntentService() {
        super(Utils.GCMSenderId);
    }

    private static PowerManager.WakeLock sWakeLock;
    private static final Object LOCK = GCMIntentService.class;
    public String regIdtoSend = "";

    @Override
    protected void onHandleIntent(Intent intent) {

        try {
            String action = intent.getAction();
            if (action.equals("com.google.android.c2dm.intent.REGISTRATION")) {
                handleRegistration(intent);
            } else if (action.equals("com.google.android.c2dm.intent.RECEIVE")) {
                handleMessage(intent);
            }
        }
        finally {
            synchronized(LOCK) {
                sWakeLock.release(); //Null pointer here on sWakeLock
            }
        }
    }

    private void handleRegistration(Intent intent) {
        String regId = intent.getStringExtra("registration_id");
        Utils.registrationId = regId;
        regIdtoSend = regId;
        new LongOperation().execute("");
        Log.e("", "registration id : "+regId);
    }

    private void handleMessage(Intent intent) {
        Utils.notiMsg = intent.getStringExtra("message");

        Context context = getApplicationContext();

        String ns = Context.NOTIFICATION_SERVICE;
        NotificationManager mNotificationManager = (NotificationManager) context.getSystemService(ns);

        int icon = R.drawable.ic_action_lab_white;
        CharSequence tickerText = Utils.notiMsg;
        long when = System.currentTimeMillis();

        Notification notification = new Notification(icon, tickerText, when);
        CharSequence contentTitle = "New notification";
        CharSequence contentText = Utils.notiMsg;
        Intent notificationIntent = new Intent();
        PendingIntent contentIntent = PendingIntent.getActivity(context, 0, notificationIntent, 0);
        notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent);
        mNotificationManager.notify(1, notification);

        Utils.notificationReceived=true;

    }

    static void runIntentInService(Context context,Intent intent){
        synchronized(LOCK) {

            if (sWakeLock == null) {
                PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
                sWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "my_wakelock");
            }
        }
        sWakeLock.acquire();
        intent.setClassName(context, GCMIntentService.class.getName());
        context.startService(intent);
    }
} 
```

# svn - SVN：如何更改工作副本的所有者

> ID：13086598
> 
> 赞同：2
> 
> 时间：2012-10-26T12:04:32.957
> 
> 标签：svn

在我的机器中，我使用的是用户 id:user1 的 svn 副本。我想将“user1”更改为“user2”。请让我知道如何更改 SVN 的用户

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:33:00.117

You should be able to force SVN to treat you as a different user with:

```
svn update --username user1 --password newpassword 
```

If you want it to forget about the old username and password you can delete the `~/.subversion/auth` directory which will clear the authentication cache.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:20:57.920

1）您可以更改用户

*   颠覆 1.6 及更早版本：

    ```
     svn switch --relocate protocol://currentUser@server/path protocol://newUser@server/path 
    ```

*   颠覆 1.7 及更高版本：

    ```
     svn relocate protocol://currentUser@server/path protocol://newUser@server/path 
    ```

要找出是什么`protocol://currentUser@server/path`，请运行

```
svn info 
```

在您的工作副本中。

2）您可以使用[svndumptool](http://svn.borg.ch/svndumptool/)：

> svnadmin 转储路径/to/my/repo > repo.dump
> 
> svndumptool transform-revprop svn:author originalregexp newvalue repo.dump newrepo.dump

3）最简单的事情是让你的管理员（谁管理回购浏览器）为你创建新的登录。

# arrays - 使用二进制比较的数据帧上的 R chisq.test()

> ID：13086599
> 
> 赞同：1
> 
> 时间：2012-10-26T12:04:34.250
> 
> 标签：arrays, r, dataframe, chi-squared

我想对尺寸（50x752）的数据框进行 chisq.test 。我想为所有列的所有可能的成对比较获取 pvalues（通过多次测试调整）。最后，我想取回一个矩阵 (50x50) 以生成调整后的 chisq pvalues 的热图。这是我目前所做的，但这远非理想。

Step1：进行成对比较

```
function(data,p.adjust.method="holm")
{
cor.mat <- cor(data)
x<-ncol(data)#nb of column in matrix here 50
y<-nrow(data)#nb of column in matrix here 758
index<-t(combn(x, 2)) #create the matrix position of output for all possible combination
nindex <- nrow(index)
pvals <- numeric(nindex)

for (i in 1:nindex)
{
pvals[i]<-chisq.test(data[, index[i, 1]], data[, index[i,2]])$p.value   
}
pvals<-p.adjust(pvals,method = p.adjust.method)
out <- as.data.frame(cbind(index, pvals))
} 
```

Step2：将输出表转换为矩阵

```
 dcast(df,V2~V1,fill=1) # thanx to Roland for this function! 
```

但这效果不佳，因为我没有在最终矩阵中镜像 pvalue，并且我必须操纵第一个函数的输出以使对角线填充为 0（将列与自身进行比较时）。对你的帮助表示感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T16:41:22.513

像这样？

```
#some data
set.seed(42)
df <- data.frame(a=rbinom(1000,5,0.3),
                 b=rbinom(1000,5,0.001),
                 c=rbinom(1000,5,0.1),
                 d=rbinom(1000,5,0.9))

#function to calculate the adj. p-value
fun <- function(x,y) {
  p.adjust(chisq.test(df[,x],df[,y])$p.value,method="holm",n=choose(ncol(df),2))
}

p.adj <- outer(names(df),names(df),FUN=Vectorize(fun)) #use outer to get a matrix
diag(p.adj) <- 1  #you should find out why chisq.test returns zero at the diag
rownames(p.adj) <- names(df)
colnames(p.adj) <- names(df)

p.adj
#  a         b c         d
#a 1 1.0000000 1 1.0000000
#b 1 1.0000000 1 0.6152165
#c 1 1.0000000 1 1.0000000
#d 1 0.6152165 1 1.0000000 
```

# objective-c - 根据文本改变表格视图单元格高度

> ID：13086600
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:04:35.000
> 
> 标签：objective-c, ios, uitableview

我有一个带有几个单元格的表格视图。填充单元格的文本是不可预测的（基于 API 请求的结果）。我想要做的是根据单元格的文本是否对单元格来说太长来调整单元格的高度（例如，单元格将“...”添加到文本中）。

这样，无论结果/文本并呈现到表格视图单元格中，都始终完全显示。

我宁愿不实现，`heightForRowAtIndexPath`因为我必须实现很多代码才能做到这一点。

更新：

当我说“我有很多代码要做”时，我的意思是我确实有很多代码解析请求、检查条件和执行算法，而且我有**很多**表视图。刚把那些东西移到另一种方法，我就走了！

你能指点我演示这个的任何资源吗，你知道怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:10:06.647

您必须实现 heightForRowAtIndexPath 来改变表格行的高度，但计算高度不一定需要很多代码。

使用 NSString:sizeWithFont:constrainedToSize 来计算所需的单元格大小。

```
 //szMaxCell contains the width of your table cell, and the maximum height you want to allow
// strCellContents is an NSString containing the text to display

        CGSize szMaxCell = CGSizeMake (tableView.frame.size.width - 20,999);
        UIFont *font = [UIFont systemFontOfSize:12];    // whatever font you're using to display
        CGSize szCell = [strCellContents sizeWithFont:font constrainedToSize:szMaxCell lineBreakMode:UILineBreakModeWordWrap]; 
```

szCell 包含标签的大小。你将使用这个大小来计算你的 UILabel 在你的 cellForRowAtIndexPath 和你的 heightForRowAtIndexPath 中的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:10:51.917

使用`heightForRowAtIndexPath`. 它不应该有很多额外的代码。只需获取对您正在填充单元格的对象的引用，检查该文本值的长度并返回您需要的高度。这正是委托方法的设计目的。

# c - 为什么 realloc 在重复调用时会失败，因为使用 malloc 分配大块有效？

> ID：13086602
> 
> 赞同：1
> 
> 时间：2012-10-26T12:04:38.757
> 
> 标签：c, string, malloc, realloc

我正在尝试从标准输入读取（从文件中传递值）。我正在从字符串中读取每个字符并将其存储到动态分配的字符串指针中。需要时我重新分配内存。我正在尝试获得尽可能多的字符。虽然我可以将其限制为 100,000 个字符。但是在一些迭代之后 realloc 失败了。但是如果我在 malloc 的第一次初始化期间指定一个大的块大小，比如 1048567，我可以完全读取字符串。为什么是这样？

下面是我的程序：

```
#include <stdio.h>
#include <stdlib.h>

int display_mem_alloc_error();

enum {
    CHUNK_SIZE = 31    //31 fails. But 1048567 passes.
};

int display_mem_alloc_error() {
    fprintf(stderr, "\nError allocating memory");
    exit(1);
}

int main(int argc, char **argv) {
    int numStr;                  //number of input strings
    int curSize = CHUNK_SIZE;    //currently allocated chunk size
    int i = 0;                   //counter
    int len = 0;                 //length of the current string
    int c;                       //will contain a character
    char *str = NULL;            //will contain the input string
    char *str_cp = NULL;         //will point to str
    char *str_tmp = NULL;        //used for realloc

    str = malloc(sizeof(*str) * CHUNK_SIZE);
    if (str == NULL) {
        display_mem_alloc_error();
    }    
    str_cp = str;   //store the reference to the allocated memory

    scanf("%d\n", &numStr);   //get the number of input strings
    while (i != numStr) {
        if (i >= 1) {   //reset
            str = str_cp;
            len = 0;
            curSize = CHUNK_SIZE;
        }
        c = getchar();
        while (c != '\n' && c != '\r') {
            *str = (char *) c;
            //printf("\nlen: %d -> *str: %c", len, *str);
            str = str + 1;
            len = len + 1;
            *str = '\0';
            c = getchar();
            if (curSize / len == 1) {
                curSize = curSize + CHUNK_SIZE;
                //printf("\nlen: %d", len);
                printf("\n%d \n", curSize);    //NB: If I comment this then the program simply exits. No message is displayed.
                str_tmp = realloc(str_cp, sizeof(*str_cp) * curSize);
                if (str_tmp == NULL) {
                    display_mem_alloc_error();
                }
                //printf("\nstr_tmp: %d", str_tmp);
                //printf("\nstr: %d", str);
                //printf("\nstr_cp: %d\n", str_cp);
                str_cp = str_tmp;
                str_tmp = NULL;
            }
        }
        i = i + 1;
        printf("\nlen: %d", len);
        //printf("\nEntered string: %s\n", str_cp);
    }
    str = str_cp;
    free(str_cp);
    free(str);
    str_cp = NULL;
    str = NULL;
    return 0;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T12:08:45.480

当你`realloc`

```
str_tmp = realloc(str_cp, sizeof(*str_cp) * curSize);
if (str_tmp == NULL) {
    display_mem_alloc_error();
}
//printf("\nstr_tmp: %d", str_tmp);
//printf("\nstr: %d", str);
//printf("\nstr_cp: %d\n", str_cp);
str_cp = str_tmp;
str_tmp = NULL; 
```

你让`str_cp`指向新的内存块，但`str`仍然指向旧的，现在的`free`d 块。因此，当您访问`str`下一次迭代中指向的内容时，您会调用未定义的行为。

您需要保存`str`相对于的偏移量`str_cp`，并在重新分配之后，让`str`指向新块的旧偏移量。

And`*str = (char *) c;`是错误的，尽管它在功能上等同于正确的`*str = c;`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T12:06:40.693

```
 *str = (char *) c; 
```

这条线是错误的。

`str`是指向`char`并且`*str`是 a的指针，`char`但您正在分配指向 a 的`char`指针`char`。这不能在 C 中完成。

而且：

```
scanf("%d\n", &numStr); 
```

`\n`in `scanf`call 可能不是您所期望的：

[http://c-faq.com/stdio/scanfhang.html](http://c-faq.com/stdio/scanfhang.html)

并且：

```
str = str_cp;
free(str_cp);
free(str); 
```

你在这里有一个双倍的免费。分配后`str`，`str_cp`将具有相同的值，这样做：

```
free(str_cp);
free(str); 
```

就好像你这样做：

```
free(str);
free(str); 
```

这是未定义的行为（您不能释放两次）。

# windows-phone-7 - listitem 中的 windows phone 7 observablecollection

> ID：13086605
> 
> 赞同：0
> 
> 时间：2012-10-26T12:04:52.780
> 
> 标签：windows-phone-7

我有一个`ObservableCollection<testItem>`，每个`testItem`人都有另一个`ObvervableCollection<testData>`。

知道每个`testData`我想要的和来自`ListItem`的一些数据。目前我将列表设置为as但我只得到了.`testItem``testData``ObservableCollection<testItem>``ItemsSource``itemsData`

我能做些什么？

更新：

xml:

```
<ListBox Name="ResultList" ItemsSource="{Binding TankstellenItem}" >
 <ListBox.ItemTemplate>
   <DataTemplate>
     <Border BorderBrush="#FF3AACDF" BorderThickness="4">
       <StackPanel Orientation="Horizontal" 
                   Background="White" 
                   UseLayoutRounding="True" Tap="ItemIsClicked">
        <StackPanel Width="130" Orientation="Vertical" Margin="0,0,0,0">
            <Border BorderThickness="2" 
                    Background="#FF3AACDF" BorderBrush="White">
                   <TextBlock Text="{Binding PriceBigDigits}" 
                              FontFamily="Assets/Font.ttf#LCD" 
                              FontSize="25" TextAlignment="Center" />
            </Border>
           <TextBlock Text="{Binding FuelType}" 
                       TextAlignment="Center" 
                       FontSize="15" Foreground="Black"/>
           <TextBlock Text="{Binding UpdateDate}" 
                      TextAlignment="Center" 
                      FontSize="15" Foreground="Black" />
           <TextBlock Text="{Binding DistanceString}" 
                      TextAlignment="Center" 
                      FontSize="15" Foreground="Black"/>
       </StackPanel>
      <StackPanel Orientation="Vertical" Margin="10,0,0,0" Width="400">
         <TextBlock Text="{Binding Title}" 
                    FontSize="30" FontWeight="Bold" Foreground="Black"/>
         <TextBlock Text="{Binding Address}" FontSize="20" Foreground="Black" />
         <TextBlock Text="{Binding PLZCity}" FontSize="20" Foreground="Black" />
       </StackPanel>
  </StackPanel>
   </Border>
   </DataTemplate>
   </ListBox.ItemTemplate>
</ListBox> 
```

比我有testItem：

```
public testItem{
DistanceString (string),
Title (string),
Addresse (string),
PLZCity (string),
itemDates (ObservableCollection<itemData>)} 
```

和 itemData：

```
public itemData{
PriceBigDigits (string),
FuelType (string),
UpdateDate (string) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T20:02:35.620

如果我理解正确，您可能希望将 绑定`itemDates`到 a`ItemsControl`的`ItemsSource`属性。因此，将您的第二个包裹`StackPanel`在.`DataTemplate``ItemsControl`

# ruby-on-rails - 在 Ruby 中开始/结束/期间

> ID：13086609
> 
> 赞同：1
> 
> 时间：2012-10-26T12:05:07.803
> 
> 标签：ruby-on-rails, ruby

做到这一点的最佳方法是什么？

```
@user = UserFinder.find(first_name: "Dave")
if !@user
  return render :text => '// No user named Dave found'
end

if @user.last_name != "Edwards"
  # This is not the guy we want
  @user.destroy

  # Now we want to re-execute the search again forever until we find Dave Edwards
end 
```

请记住，这是我拥有的真实代码的一个非常简单的示例，所以我知道我可以首先过滤查询，但我想要这样。

我不确定如何使用`begin`and `while`blocks 来执行此操作，因为如果我们遇到不需要的用户，则需要销毁它。

我的尝试：

* * *

```
begin
  @user = UserFinder.find(first_name: "Dave")
  return render :text => '// No user named Dave found'
end while @user.destroy if @user.last_name != "Edwards" 
```

这不起作用，因为`while`块得到的结果`destroy`不是比较`last_name`

*PS如果这是不可能的，如何用相同的参数重新加载Rails控制器动作？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:15:41.313

尝试这个：

```
begin
  @user = UserFinder.find_by_first_name("Dave")
  render :text => '// No user named Dave found' if @user.nil?
  return if @user.nil?
end while @user.last_name != "Edwards" && @user.destroy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:35:42.000

```
user.destroy while user = UserFinder.where(:first_name => "Dave",  :last_name => "Edwards").first 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:12:01.927

这对你有用吗？

```
while (@user = UserFinder.find(first_name: "Dave")) and @user.last_name != "Edwards"
  @user.destroy
end

if @user
  render ...
else
  render :text => '// No user named Dave found'
end 
```

# node.js - 什么是 app.configure('production')

> ID：13086613
> 
> 赞同：0
> 
> 时间：2012-10-26T12:05:24.060
> 
> 标签：node.js, express

我是 NodeJS 的新手，如何处理 Express 文档中给出的以下设置？

```
app.configure('production', function(){
  app.set('db uri', 'n.n.n.n/prod');
}); 
```

我应该只复制和粘贴还是需要更改 'db.uri' 和 'nnnn' ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T13:22:44.333

这个想法是您将为生产与开发设置不同的值。在这种情况下，对 app.set() 的调用有两个参数 key 和 value。您可以定义哪些键及其对应的值对您的应用程序有意义。

你可能有这样的事情：

```
app.configure('production', function(){
  app.set('db uri', 'bigdbserver/invoiceDB');
  app.set('log level', 'warningsOnly');
});

app.configure('development', function(){
  app.set('db uri', 'mylocalbox/invoiceDB');
  app.set('log level', 'verbose');
}); 
```

**更新：**根据 Herman Junge 的建议添加：

根据 Express 文档， app.configure 将匹配您的 NODE_ENV 变量。您可以在命令行或应用程序中两种方式进行设置：

命令行

$ NODE_ENV=开发节点 app.js

在我的应用程序中

process.env.NODE_ENV = '发展';

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T13:25:00.547

它们是您的应用程序设置，生产是您在将应用程序部署到实时服务器时要使用的设置，您还可以创建 app.configure 用于开发。这些应该是诸如数据库连接字符串、记录器之类的东西，这些东西在您的开发环境中有所不同。

快速谷歌搜索会带来一些东西，例如某人想如何使用它：

[另一个关于设置的帖子](https://stackoverflow.com/questions/10714315/node-js-express-and-using-development-versus-production-in-app-configure)

高温高压

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T14:51:06.887

看看快递[文档](http://expressjs.com/api.html#app.configure)。它有一个很好的例子来说明 app.configure 函数是如何工作的。它是检查 NODE_ENV 环境变量的语法糖。

# android - 嵌套适配器视图android

> ID：13086615
> 
> 赞同：1
> 
> 时间：2012-10-26T12:05:29.663
> 
> 标签：android, adapter

我有几个 ListViews（一个在右侧，第二个在左侧）作为 Horizo​​ntalListView 中一个子视图的一部分，我希望有以下行为：当我更新左适配器时，它将重新加载并且**只有它**，

我现在要做的是在左视图适配器上调用 notifyDatasetCanged ，然后在父 HorisontalListView 适配器上调用 notifyDarasetChanged ，这会导致**所有**子级（包括右侧的子级）刷新（如果我不通知父适配器，则不会发生任何事情）。

使用适配器模式实现此行为的最佳方法是什么

# javascript - JavaScript 计算两个日期之间的年月

> ID：13086616
> 
> 赞同：0
> 
> 时间：2012-10-26T12:05:35.930
> 
> 标签：javascript, date

> **可能重复：**
> [如何在 JavaScript 中获取两个日期之间的差异？](https://stackoverflow.com/questions/41948/how-do-i-get-the-difference-between-two-dates-in-javascript)

我想知道javascript如何计算两个日期之间的年月。因此，例如在 26/10/2012 和 26/11/2013 之间，有 1 年 1 个月

我已经尝试过了，但它是错误的:(

```
var diff =  (new Date(y, m - 1, d).getTime(2011,(11-1),26) - new Date(2012, (11-1), 26).getTime()) / 1000 / 60 / 60 / 24 / 30; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:16:04.583

假设有两个日期`d1`和`d2`，`d2`两者中较大的一个在哪里：

```
var month_diff = (d2.getFullYear() - d1.getFullYear()) * 12 + d2.getMonth() - d1.getMonth();
var years = floor(month_diff / 12);
var months = month_diff % 12;
alert(years + 'years and ' + months + ' months'); 
```

如果您的要求只是计算整月，您可以在第一行之后添加以下内容：

```
if (d2.getDate() - d1.getDate() < 0 && month_diff > 0) {
   month_diff--;
} 
```

# iphone - 获取在 iPhone 中播放的音乐的力量

> ID：13086620
> 
> 赞同：5
> 
> 时间：2012-10-26T12:05:39.237
> 
> 标签：iphone, objective-c, ios, audio

我正在拼命寻找如何在我的应用程序中通过 iPod/Music 应用程序播放声音的力量。

我能找到的一切都是关于通过麦克风获得声音的力量，或者通过 AVAudioPlayer 在我自己的应用程序中播放声音，然后使用 averagePowerForChannel: 方法。我还搜索了 MPMusicPlayerController 是否可以帮助我，但我从我想要的最接近的是“nowPlayingItem”的 MPMediaItem，似乎我可以从当前播放的歌曲中访问很多信息，但没有像当前的力量。

有什么方法可以简单地获取从我的应用程序中的音乐应用程序播放的歌曲的当前功率？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T18:02:18.230

试试这个 ：`myPlayer = [MPMusicPlayerController iPodMusicPlayer];`

您可以使用 获取音量`myPlayer.volume`。这是一个浮子。一个步骤是 1/16。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-16T04:14:22.317

Larme 的答案在 iOS 7 中被弃用（`volume`属性`MPMusicPlayer`和`iPodMusicPlayer`方法）。试试这个来获取`AVAudioPlayer`当前歌曲的实例（但是，当我这样做时，出于某种奇怪的原因，它总是返回`-120 dB`）：

```
AVAudioPlayer *somePlayer = [AVAudioPlayer new];
__autoreleasing NSError* error;
somePlayer = [somePlayer initWithContentsOfURL:[[[MPMusicPlayerController systemMusicPlayer] nowPlayingItem] valueForProperty:MPMediaItemPropertyAssetURL] error:&error];
somePlayer.currentTime = [[MPMusicPlayerController systemMusicPlayer] currentPlaybackTime];
somePlayer.volume = 0;
[somePlayer play];
[somePlayer setMeteringEnabled:YES];
[somePlayer updateMeters];
NSMutableArray* amps = [NSMutableArray array];
if (error != nil) {
    NSLog(@"error: %@", error.debugDescription);
}
for (int i = 0; i < somePlayer.numberOfChannels; i++) {
    [amps addObject:@(([somePlayer peakPowerForChannel:i] + 160.0) / 160.0)];
    NSLog(@"Amplitude: %f db for channel %i", [somePlayer averagePowerForChannel:i], i);
}
float amp = 0;
for (NSNumber *x in amps) {
    amp += [x floatValue];
}
amp /= amps.count;
NSLog(@"amp: %f", amp); 
```

# android - 如何在android中实现.net的Masterpage概念以进行按钮点击

> ID：13086622
> 
> 赞同：0
> 
> 时间：2012-10-26T12:05:43.403
> 
> 标签：android, android-layout

我是 android 新手，但对`.net`.

我想在标题中添加 5 个菜单按钮，这将在每一页上重复。所以我包括`headertemplet.xml`在每一页。

但是我怎样才能为所有这些按钮编写单个按钮点击。

我应该如何进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:57:43.970

这可能是一个矫枉过正，但你可以[`Fragments`](http://developer.android.com/guide/components/fragments.html)用来做到这一点。

这个想法是一个片段来处理五个按钮的布局和点击（如果需要，将点击传递给活动以正确处理它），另一个片段来处理屏幕的其余部分。

正如您所说，按钮将出现在所有页面上，因此您只需要使用 更改第二个片段`FragmentTransaction`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:13:13.197

试试这个，因为您已经创建了一个`headertemplet.xml`文件使用`include`标签来将该 xml 文件添加到您想要的任何位置。

```
 <include  layout="@layout/Your_XML_File_Name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    /> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-26T12:10:04.897

您不能使用单次点击事件，因为 onClick 需要每个活动单独的上下文。

顺便说一句，您可以将它包含在您的每个布局中（您可能已经完成了），因此您必须在每个活动中执行其余操作（从查找 ID 到您的最后一个结果）

# ios - 贪婪的UITabBarController？

> ID：13086630
> 
> 赞同：1
> 
> 时间：2012-10-26T12:06:41.203
> 
> 标签：ios, cocoa, uiviewcontroller, uitabbarcontroller

我正在制作一个包含子视图控制器的自定义 UIViewController。它们以这种方式放置在主视图控制器中：

```
- (void) setHeaderViewController:(UIViewController *)vc
{
    [self setViewController:vc isHeader:YES];
    _headerViewController = vc;
}

- (void) setDetailViewController:(UIViewController *)vc
{
    [self setViewController:vc isHeader:NO];
    _detailViewController = vc;
}

- (void) setViewController:(UIViewController*) viewController isHeader:(BOOL)isHeader
{
    UIViewController* viewControllerRef = ((isHeader) ? _headerViewController : _detailViewController);

    if(viewControllerRef == viewController)
         return;

    const CGSize selfSize = self.view.frame.size;

    CGRect viewFrame;

    if (isHeader)
    {
        viewFrame = CGRectMake(0, 0, selfSize.width, 150);
    }
    else
    {
        viewFrame = CGRectMake(0, 150, selfSize.width, selfSize.height-150);
    }

    UIView* viewControllerView = viewController.view;

    [viewControllerView setFrame:viewFrame];
    [viewControllerView setAutoresizingMask:(UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight | ((isHeader) ? UIViewAutoresizingFlexibleBottomMargin : UIViewAutoresizingFlexibleTopMargin))];

    [self.view addSubview:viewControllerView];
} 
```

如果我在每个子视图控制器插槽内放置两个 UIViewController，则方法中定义的大小会受到尊重。但是，当放置一个 UITabBarController 时，它会变得贪婪并占据整个空间：

```
UIViewController *vc = [[WIFCustomerDetailHeaderViewController alloc] initWithNibName:@"WIFCustomerDetailHeaderViewController" bundle:nil];
[self setHeaderViewController:vc];

UIViewController *vc1 = [[UIViewController alloc] init];
vc1.title = @"Personal Data";
vc1.tabBarItem = [[UITabBarItem alloc] initWithTitle:@"Personal Data" image:nil tag:0];
vc1.view.backgroundColor = [UIColor redColor];
vc1.view.frame = CGRectMake(0,400,100,100);

UIViewController *vc2 = [[UIViewController alloc] init];
vc2.title = @"Diagnosis";
vc2.tabBarItem = [[UITabBarItem alloc] initWithTitle:@"Diagnosis" image:nil tag:0];
vc2.view.backgroundColor = [UIColor purpleColor];
vc2.view.frame = CGRectMake(0,500,50,50);

NSArray *tabs = [[NSArray alloc] initWithObjects:vc1, vc2, nil];

WIFCustomerDetailTabViewController *tvc = [[WIFCustomerDetailTabViewController alloc] init];
[tvc setViewControllers:tabs];

[self setDetailViewController:tvc]; 
```

有谁知道这里会发生什么？我找不到原因...

下面的图片..

![两个子视图控制器](../Images/f13e5667715e2bc6da490272ef3223ab.png) ![在此处输入图像描述](../Images/7362fb77cc185348592027702e34a27c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:13:02.857

UITabBarController 类的文档说，*“您必须将此视图安装为窗口的根。与其他视图控制器不同，标签栏界面永远不应安装为另一个视图控制器的子级”*。

您似乎正在尝试一种特别不受支持的设计。

# mysql - 当我将特殊的 latin1 字符写入 utf-8 编码的 mysql 表时，该数据会丢失吗？

> ID：13086631
> 
> 赞同：1
> 
> 时间：2012-10-26T12:06:41.157
> 
> 标签：mysql

例如，当我写特殊的 latin1 字符时

á, é ã , ê

到一个 utf-8 编码的 mysql 表，数据会丢失吗？

该表的字符集是 utf-8。

有什么方法可以取回 latin1 编码的行，以便我可以转换为 utf-8 并回写（这次以正确的方式）？

**更新**

我想我对“数据”的含义并不是很具体。数据是指特殊字符，而不是行。

选择时，我仍然得到行和字段，但带有“？” 而不是特殊的 latin1 字符。有可能恢复那些'？并转换为正确的 utf8 格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:40:25.930

如果整个数据库（或整个表）受到影响，您可以首先验证它是 Latin1-as-UTF8 字符集问题`SET NAMES Latin1`：

```
mysql> select txt from tbl;
+-----------+
| txt       |
+-----------+
| QuÃ©bec   |
| QuÃ©bec   |
+-----------+
2 rows in set (0.00 sec)

mysql> SET NAMES Latin1;
Query OK, 0 rows affected (0.00 sec)

mysql> select txt from tbl;
+---------+
| txt     |
+---------+
| Québec  |
| Québec  |
+---------+
2 rows in set (0.00 sec) 
```

如果这得到验证，即您在使用默认字符集 Latin-1 时获得了所需的数据，那么您可以转储整个表强制`--default-character-set=latin1`，以便使用正确的数据创建文件，**尽管使用错误的字符集规范**。

但是现在您可以替换标题行说明

```
/*!40101 SET NAMES latin1 */; 
```

使用 UTF8。重新导入数据库，您就完成了。

如果只有*一些*行受到影响，那就更困难了：

```
SELECT txt, CAST(CAST(txt AS CHAR CHARACTER SET Latin1) AS BINARY) AS utf8 FROM tbl;

+-----------+---------+
| txt       | utf8    |
+-----------+---------+
| QuÃ©bec   | Québec  |
+-----------+---------+
1 row in set (0.00 sec) 
```

...但是您有定位受影响行的问题。您可能会发现一些代码点

```
WHERE txt LIKE '%Ã%' 
```

但对于其他人，您必须手动采样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T12:17:04.457

数据不会丢失。请参阅[此 SQLFiddle 示例](http://sqlfiddle.com/#!2/9a7ba/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-06T12:34:33.407

可以使用以下命令找到其他受影响的行：

```
SELECT column
FROM table
WHERE NOT HEX(column) REGEXP '^([0-7][0-9A-F])*$' 
```

# jquery - 使用 id 或类的 Jquery maphighlight 区域

> ID：13086633
> 
> 赞同：1
> 
> 时间：2012-10-26T12:06:44.733
> 
> 标签：jquery, imagemap

我正在使用 jquery maphighlight 并且在突出显示图像地图上的各个区域时遇到问题，例如，我需要能够始终使用 id2 和 id4 突出显示区域，以便它始终是另一种颜色，当我单击其他区域时，颜色保持不变，现在加载它的红色，但点击颜色消失。地图是我使用的图像的一个类，

```
$(document).ready(function() {
$('.map').maphilight({
  fillColor: 'FF00000',
  fillOpacity: 0.5
});

var data = $('#id3').data('maphilight') || {};  
data.alwaysOn = !data.alwaysOn;
$('#id34').data('maphilight', data).trigger('alwaysOn.maphilight'); 
}); 
```

但我想用这样的 id 呼叫某个区域，这不起作用

这些是我需要c的一些领域

```
<img src="/images/test_map.png" class="map" usemap="#simple" />

<map class="tabs" name="simple">  
<area id="id1" href="#" shape="poly" coords="364,296,386,265,410,280,403,291,367,299" alt="Link" title=""/>
<area id="id2" href="#" shape="poly" coords="428,258,403,291,444,283,452,273" alt="Link" title=""/>
<area id="id3" href="#" shape="poly" coords="403,243,427,259,409,279,389,264" alt="Link" title=""/>
<area id="id4" href="#" shape="poly" coords="417,220,442,236,426,255,403,241" alt="Link" title=""/>
<area id="id5" href="#" shape="poly" coords="466,251,451,272,428,258,442,237" alt="Link" title=""/> 
```

有谁知道怎么做，我只需要用不同的颜色突出显示地图上的某些区域，以表明土地已被购买。或保留元数据如何在 maphighlight 中工作？

# c# - 从未定义样式的 ASP.NET 网格视图行

> ID：13086637
> 
> 赞同：3
> 
> 时间：2012-10-26T12:06:59.847
> 
> 标签：c#, asp.net, html, css, gridview

我有一个奇怪的问题。我创建了一个绑定到 ObjectDataSource 的 GridView。

我现在有一个奇怪的事情，所有网格行都有样式“背景颜色：白色”。但我从未宣布过这一点，我在我的项目中找不到任何设计它的地方。既不内联 .aspx 也不内联任何 css 或任何代码。只是这个样式定义在我的项目中不存在。

我直接添加到 GridView 的信息被样式定义覆盖。这是 Firebug 得到的：

```
<div>
<table id="MainContent_UserGrid" cellspacing="0" cellpadding="4" style="width:100%;border-collapse:collapse;">
<tbody>
<tr style="color:White;background-color:#5D7B9D;font-weight:bold;">
<tr style="color:#333333;background-color:White;">
<td>
<td>name.ofme@mydomain.com</td>
<td>Name of me</td>
<td>Y</td>
<td>
</tr>
<tr style="color:#284775;background-color:White;">
<tr style="color:#333333;background-color:White;">
<tr style="color:#284775;background-color:White;">
<tr style="color:#333333;background-color:White;">
</tbody>
</table>
</div> 
```

这是我的网格 ASPX 代码：

```
<asp:GridView ID="UserGrid"
              runat="server"
              AutoGenerateColumns="False" 
              DataKeyNames="AD_ID"
              DataSourceID="UserByAdminAdapter" CellPadding="4" 
              GridLines="None" Width="100%" AllowPaging="True">

    <Columns>
        <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" 
            ShowSelectButton="True" />
        <asp:BoundField DataField="AD_ID" HeaderText="AD_ID" ReadOnly="True" 
            SortExpression="AD_ID"></asp:BoundField>
        <asp:BoundField DataField="NAME" HeaderText="NAME" SortExpression="NAME" 
            ReadOnly="True">
        </asp:BoundField>
        <asp:BoundField DataField="ACCOUNT_TYPE" HeaderText="ACCOUNT_TYPE" 
            SortExpression="ACCOUNT_TYPE" Visible="False" ReadOnly="True"></asp:BoundField>
        <asp:BoundField DataField="ADMIN_ID" HeaderText="ADMIN_ID" 
            SortExpression="ADMIN_ID" Visible="False" ReadOnly="True"></asp:BoundField>
        <asp:BoundField DataField="BOOKINGS_CONSISTENT" HeaderText="BOOKINGS_CONSISTENT" 
            SortExpression="BOOKINGS_CONSISTENT" ReadOnly="True"></asp:BoundField>
        <asp:BoundField DataField="COMPANY" HeaderText="COMPANY" 
            SortExpression="COMPANY" Visible="False" />
        <asp:TemplateField HeaderText="COMPANY_NAME" SortExpression="COMPANY_NAME">
            <EditItemTemplate>
                <asp:DropDownList ID="DropDownList1" runat="server" DataSourceID="Companies" 
                    DataTextField="NAME" DataValueField="ROW_ID" 
                    SelectedValue='<%# Bind("COMPANY") %>'>
                </asp:DropDownList>
            </EditItemTemplate>
            <ItemTemplate>
                <asp:Label ID="Label1" runat="server" Text='<%# Bind("COMPANY_NAME") %>'></asp:Label>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>

    <RowStyle  BackColor="#000000" ForeColor="#333333"  />
    <AlternatingRowStyle  BackColor="#99FFCC" ForeColor="#284775" />

    <EditRowStyle BackColor="#999999" />
    <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
    <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
    <PagerStyle BackColor="#284775" ForeColor="White" HorizontalAlign="Center" />

    <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
    <sortedascendingcellstyle backcolor="#E9E7E2" />
    <sortedascendingheaderstyle backcolor="#506C8C" />
    <sorteddescendingcellstyle backcolor="#FFFDF8" />
    <sorteddescendingheaderstyle backcolor="#6F8DAE" />

</asp:GridView> 
```

顺便说一句，在 c# 代码中更改行的背景颜色也不会改变任何内容。我有一个通过 css 的解决方法，但这不是“好”。

马上谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:13:47.980

您的项目中是否有一个主题可能会覆盖您的网格样式？

您能否在代码后面的某处修改样式（我对此表示怀疑）。

与其在您的gridview footerStyle中放置特定样式，不如在您的css中创建一个类并链接到它

```
<RowStyle  BackColor="#000000" ForeColor="#333333"  /> 
```

变成

```
<RowStyle CssClass="ItemStyle" /> 
```

它可能更容易在 Firebug 中排除故障并减少内联样式的数量（同时更易于维护）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:14:26.487

是自动造型。您可以为您的 GridView 创建 CSS 类并将它们应用于以下属性：

```
 <HeaderStyle CssClass="tableHead"  />
        <RowStyle CssClass="tableRow" />
        <PagerStyle CssClass="pager" />

    //Example 
    <asp:GridView runat="server" ID="grdAssetSearchResults" AutoGenerateColumns="false" GridLines="Both" AllowSorting="true"  UseAccessibleHeader="true" >
        <HeaderStyle CssClass="tableHead"  />
        <RowStyle CssClass="tableRow" />
        <PagerStyle CssClass="pager" />
        <Columns>
         //Columns
        </Columns>
    </asp:GridView> 
```

# zend-framework - Using class constants in Zend_Config_Ini application.ini

> ID：13086640
> 
> 赞同：1
> 
> 时间：2012-10-26T12:07:35.917
> 
> 标签：zend-framework, zend-config

I've got several constants defined in one of my classes and would like to use on of them in my application.ini, is this possible?

```
logger.main.level = \My\App\Logger::WARNING 
```

This does not seem to work, it just parses it as a string

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T16:36:08.360

I believe that PHP's `parse_ini_file()` function only has access to constants in the global space and not in the class space.

I haven't been able to use `My_Class::MYCONST` or `My\Class::MYCONST` in any .ini file.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T18:20:20.070

If you want to use the value of a constant in your `application.ini` you need to define the constant in the `/public/index.php` file (see the `APPLICATION_PATH`).

If you want to do it cleanly in your code I would eiter do it using the log level manually with the numeric value (assuming the constant is numeric as in Zend_Log) since this value is not likely to change or do it in the index.php and define a new constant named something like `LOGLEVEL_WARNING` (you can then get the value of the constant statically from your class), which you will be able to use in the `application.ini` file like `logger.main.level = LOGLEVEL_WARNING`

My pick would be the numeric value in the `application.ini` file like this :

```
resources.log.stream.writerName = "Stream"
resources.log.stream.writerParams.stream = APPLICATION_PATH "/../data/logs/application_" DATESTAMP ".log"
resources.log.stream.writerParams.mode = "a"
resources.log.stream.filterName = "Priority"
resources.log.stream.filterParams.priority = 4 
```

Take a look at `APPLICATION_PATH` and `DATESTAMP` which are constants that I have defined in my index.php

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-25T06:23:57.387

You can define constants in your application.ini file and then call them with the code below in controller.

```
public function init() {
    //Getting constants from application.ini file
    $registry = Zend_Registry::getInstance();
    $this->_constants = $registry->app_config->constants;
} 
```

where your constants are defined in application.ini file like below

```
;My Constants
constants.MY_CONSTANT="value" 
```

# python - 累积频率，Ngrams

> ID：13086642
> 
> 赞同：0
> 
> 时间：2012-10-26T12:07:48.430
> 
> 标签：python, regex, nltk

在这里快速提问：如果你运行下面的代码，你会从语料库中获得每个列表的二元组频率列表。

我希望能够显示和跟踪总的运行记录。IE 而不是你在运行它时看到的显示为 1 或 2 的频率，因为索引太小了，它会计算整个语料库并显示频率。

然后我基本上需要从模拟原始语料库的频率中生成文本。

```
 #---------------------------------------------------------
#!/usr/bin/env python
#Ngram Project

#Import all of the libraries we will need for the program to function
import nltk
import nltk.collocations
from collections import defaultdict
import nltk.corpus as corpus
from nltk.corpus import brown

#---------------------------------------------------------

#create our list with the Brown corpus inside variable called "news"
news = corpus.brown.sents(categories = 'editorial')
#This will display the type of variable Python recognizes this as
print "News Is Of The Variable Type : ",type(news),'\n'

#---------------------------------------------------------

#This function will take in the corpus one line at a time
#After searching through and adding a <s> to the beggning of each list item, it also annotates periods out for </s>'
def alter_list(corpus_list):
    #Simply check for an instance of a period, and if so, replace with '</s>'
    if corpus_list[-1] == '.':
        corpus_list[-1] = '</s>'
        #Stripe is a modifier that allows us to remove all special characters, IE '\n'
        corpus_list[-1].strip()
    #Else add to the end of the list item
    else:
        corpus_list.append('</s>')
    return ['<s>'] + corpus_list

#Displays the length of the list 'news'
print "The Length of News is : ",len(news),'\n'
#Allows the user to choose how much of the annotated corpus they would like to see
print "How many lines of the <s> // </s> annotated corpus would you like to see? ", '\n'
user = input()
#Takes user input to determine how many lines to display if any
if(user >= 1):
    print "The Corpus Annotated with <s> and </s> looks like : "
    print "Displaying [",user,"] rows of the corpus : ", '\n' 
    for corpus_list in news[:user]:
       print(alter_list(corpus_list),'\n')
#Non positive number catch
else:
    print "Fine I Won't Show You Any... ",'\n'

#---------------------------------------------------------

print '\n'
#Again allows the user to choose the number of lists from Brown corpus to be displayed in
# Unigram, bigram, trigram and quadgram format
user2 = input("How many list sequences would you like to see broken into bigrams, trigrams, and quadgrams? ")
count = 0

#Function 'ngrams' is run in a loop so that each entry in the list can be gone through and turned into information
#Displayed to the user
while(count < user2):
    passer = news[count]

    def ngrams(passer, n = 2, padding = True):
        #Padding refers to the same idea demonstrated above, that is bump the first word to the second, making
        #'None' the first item in each list so that calculations of frequencies can be made 
        pad = [] if not padding else [None]*(n-1)
        grams = pad + passer + pad
        return (tuple(grams[i:i+n]) for i in range(0, len(grams) - (n - 1)))

    #In this case, arguments are first: n-gram type (bi, tri, quad)
    #Followed by in our case the addition of 'padding'
    #Padding is used in every case here because we need it for calculations
    #This function structure allows us to pull in corpus parts without the added annotations if need be
    for size, padding in ((1,1), (2,1), (3, 1), (4, 1)):
        print '\n%d - grams || padding = %d' % (size, padding)
        print list(ngrams(passer, size, padding))

    # show frequency
    counts = defaultdict(int)
    for n_gram in ngrams(passer, 2, False):
        counts[n_gram] += 1

    print ("======================================================================================")
    print '\nFrequencies Of Bigrams:'
    for c, n_gram in sorted(((c, n_gram) for n_gram, c in counts.iteritems()), reverse = True):
        print c, n_gram

    print '\nFrequencies Of Trigrams:'
    for c, n_gram in sorted(((c, n_gram) for n_gram, c in counts.iteritems()), reverse = True):
        print c, n_gram

    count = count + 1

 #--------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:27:45.580

问题是您`counts`为每个句子重新定义字典，因此 ngram 计数被重置为零。在 while 循环上方定义它，计数将在整个 Brown 语料库中累积。

额外建议：您还应该将定义移到`ngram`循环之外——一遍又一遍地定义相同的函数是荒谬的。（但这并没有什么坏处，除了性能）。更好的是，您应该使用 nltk 的`ngram`功能并阅读 about `FreqDist`，这就像类固醇上的 dict 计数器。当您处理统计文本生成时，它会派上用场。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:59:10.507

我不确定我是否理解这个问题。nltk 有一个函数生成。nltk 来自的书可在线获得。

[http://nltk.org/book/ch01.html](http://nltk.org/book/ch01.html)

```
Now, just for fun, let's try generating some random text in the various styles we have just seen. To do this, we type the name of the text followed by the term generate. (We need to include the parentheses, but there's nothing that goes between them.)

>>> text3.generate()
In the beginning of his brother is a hairy man , whose top may reach
unto heaven ; and ye shall sow the land of Egypt there was no bread in
all that he was taken out of the month , upon the earth . So shall thy
wages be ? And they made their father ; and Isaac was old , and kissed
him : and Laban with his cattle in the midst of the hands of Esau thy
first born , and Phichol the chief butler unto his son Isaac , she 
```

# symfony - Symfony2 中的 PHPExcel Bundle：声明 PHPExcel_Style_Color 错误

> ID：13086645
> 
> 赞同：0
> 
> 时间：2012-10-26T12:08:11.580
> 
> 标签：symfony, bundle, phpexcel

我安装了这个包：

[https://github.com/liuggio/ExcelBundle](https://github.com/liuggio/ExcelBundle)

在我的 Symfony2 中，基本上添加：

```
[PHPExcel]
    git=http://github.com/PHPOffice/PHPExcel.git
    target=/phpexcel
    version=origin/master

[n3bStreamresponse]
    git=git://github.com/liuggio/Symfony2-StreamResponse.git
    target=n3b/src/n3b/Bundle/Util/HttpFoundation/StreamResponse

[LiuggioExcelBundle]
    git=https://github.com/liuggio/ExcelBundle.git
   target=/bundles/Liuggio/ExcelBundle 
```

到 deps，更新 Autoload.php 和 AppKernel.php 并在一个控制器中使用此操作：

```
 $excelService = $this->get('xls.service_xls2007');
   $excelService->excelObj->getProperties()
                        ->setTitle("Reunión comercial")
                        ->setDescription("Reunión Comercial - Generación automática desde la aplicación de RRHH.");

       $excelService->excelObj->getActiveSheet()->setTitle('Reunión Comercial');
       // Set active sheet index to the first sheet, so Excel opens this as the first sheet
       $excelService->excelObj->setActiveSheetIndex(0);

   //create the response
   $response = $excelService->getResponse();
   $response->headers->set('Content-Type', 'text/vnd.ms-excel; charset=utf-8');
   $response->headers->set('Content-Disposition', 'attachment;filename=reuComercial-'.date("Y_m_d_His").'.xls');

   // If you are using a https connection, you have to set those two headers for compatibility with IE <9
   /*$response->headers->set('Pragma', 'public');
   $response->headers->set('Cache-Control', 'maxage=1');
   */
   $excelService->setActiveSheetIndex(0)
        ->setCellValue('A1', 'Lead')
          ->setCellValue('B1', 'Peticion')
          ->setCellValue('C1', 'Estado Candidato')
          ->setCellValue('D1', 'Nombre Candidato')
          ->setCellValue('E1', 'Apellido Candidato')
          ->setCellValue('F1', 'Cliente')
          ->setCellValue('G1', 'Descripcion');

   $em = $this->getDoctrine()->getEntityManager();

   $data = $em->getRepository('OportunidadBundle:Oportunidad')->reunionComercial();

   $aux = 2;
   foreach ($data as $row)
   {
      $excelService->setActiveSheetIndex(0)
          ->setCellValue('A'.$aux, $row->Lead)
          ->setCellValue('B'.$aux, $row->Peticion)
          ->setCellValue('C'.$aux, $row->Estado_Candidato)
          ->setCellValue('D'.$aux, $row->Nombre_Candidato)
          ->setCellValue('E'.$aux, $row->Apellido_Candidato)
          ->setCellValue('F'.$aux, $row->Cliente)
          ->setCellValue('G'.$aux, $row->Descripcion);
      $aux++;
   };

   $excelService->getStreamWriter()->write( $filename );

   return $response; 
```

我得到这个错误:(

```
Runtime Notice: Declaration of PHPExcel_Style_Color::bindParent() should be compatible with that of PHPExcel_Style_Supervisor::bindParent() in C:\Program Files\EasyPHP-5.3.8.1\www\www\www\intranet\vendor\phpexcel\Classes\PHPExcel\Style\Color.php line 36 
```

我不知道这意味着什么，因为 PHP 中有很多东西仍然让我无法理解：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:03:49.273

拉取最新的开发分支代码而不是标记版本是一个问题：开发分支代码永远不能保证处于您可以简单地运行它的状态。

我已经修改了 bindParent() 方法的签名，这样这个特殊的通知就不会再次出现

# python - 在 PyInstaller 中构建一串 Python 代码？

> ID：13086647
> 
> 赞同：1
> 
> 时间：2012-10-26T12:08:26.337
> 
> 标签：python, exe, py2exe, pyinstaller

我了解我们如何通过将 PyInstaller 指向文件来打包 .exe。比如：

```
c:\Python25\python c:\Users\Mike\Desktop\pyinstaller-1.4\Makespec.py -F -w sampleApp.py 
```

但是有没有办法创建一个只有字符串[而不是文件]的.exe？如：

```
string="""
print "Hello world"

"""

buildApplication(string) #Function Does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:43:58.513

据我所知，恐怕您无法使用任何现有的独立可执行文件创建工具（*py2exe*、*PyInstaller*和*cxFreeze*）来解决创建临时文件的需要。

我认为最可行的解决方案是通过晦涩难懂的安全性，结合以下两种技术：

1.  使用该函数（您可以在[py_compile模块的](http://docs.python.org/library/py_compile.html)[源代码](http://hg.python.org/cpython/file/2.7/Lib/py_compile.py#l71)中找到如何实现这一点`.pyc`），而不是明文`.py`文件，直接创建一个字节码编译文件（ ），一个字节编译文件将是与源文件相比，窥探的用处要小得多。`__builtin__.compile`
2.  使用[tempfile](http://docs.python.org/library/tempfile.html)模块创建的具有晦涩名称和位置的临时文件。该文件的寿命相对较短，但显然，一个足够坚定的用户将能够在它存在时找到并复制它，以供可执行文件创建工具使用。

# mobile - 敏捷工具包和引导程序

> ID：13086650
> 
> 赞同：0
> 
> 时间：2012-10-26T12:08:30.833
> 
> 标签：mobile, twitter-bootstrap, atk4

我正在使用 CI，但正在认真考虑转向 ATK4。我构建的 SaaS 代码始终必须是桌面和移动设备可访问的，因此最近的项目依赖于 Twitter 的 Bootstrap 布局来提供良好的浏览器体验，无论屏幕大小如何。

ATK4 如何处理移动浏览器，尤其是手机上的小屏幕？这真的只是您使用 Theme Roller 选择的主题的问题吗？如果是这样，是否有任何主题以 ATK4 的良好移动和桌面体验而闻名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:05:45.843

Agile Toolkit 针对 UI 开发，主要是桌面浏览器 UI。该站点仍然可以在移动设备上使用，就像任何 jQuery UI 站点一样。

但是，如果您想使用不同的 CSS 引擎，您可以自由地这样做，只需更改您的`shared.html`文件以包含必要的包含，并且您需要编写更多模板。好吧，你现在正在用 CI 编写模板，所以这是非常相似的体验。

# c++ - C++ 中的访问者模式

> ID：13086655
> 
> 赞同：1
> 
> 时间：2012-10-26T12:08:45.527
> 
> 标签：c++, visitor-pattern

我想在 C++ 中实现访问者模式，如下所示：

```
class Visitor{
public:
  virtual ~Visitor();
  virtual void visit(C & t)=0;
};

class V : public Visitor{
public:
  void visit(C &c);
};

class C{ 
public:
  void accept(Visitor &v){ v.visit(*this); }
}; 
```

但编译器抱怨 2 个语法错误：未知标识符 C 和访问者。哪里有问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T12:10:58.937

目前编译器看到

```
virtual void visit(C & t)=0; 
```

名字`C`不详。

您需要在前`class C`声明`Visitor`

```
class C;

class Visitor{
...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T12:23:34.107

在 C++ 语言中，编译器不会提前查找尚未定义的名称，或者更好地说，有时会，有时不会。

你可以说例如

```
struct Foo
{
    Foo(int x) : m_x(x) { }
    int m_x;
}; 
```

即使您`m_x`在定义是什么之前使用了编译器，编译器也不会抱怨`m_x`，但是在模块级别，这种前瞻是不存在的：

```
struct Foo
{
    Bar *p;  // Error, Compiler doesn't know what Bar is
};

// Too late, the compiler is not going to read down here while
// analyzing Foo.
struct Bar
{
    int x;
}; 
```

您如何解决在定义之前需要使用某些东西的情况？通过使用特殊的“前向声明”，您只声明将有具有该名称的内容，然后您在特定的内容中定义它是什么......例如

```
struct Foo; // There will be a struct Foo defined somewhere

struct Bar
{
    Foo *p; // Fine, even if the compiler doesn't really know Foo
};

struct Foo
{
    Bar *q; // Fine and no forward needed... Bar is known at this point
}; 
```

或多或少的规则是：在单个类中，所有方法都可以看到所有其他方法和所有成员，即使它们稍后在类中定义，但在模块级别，每个名称都必须在使用之前知道。

有时需要更复杂的模式，例如

```
struct Foo;

struct Bar
{
    void doit(Bar x);
};

struct Foo
{
    void doit_too(Foo x);
};

void Foo::doit(Bar x) { ... }
void Bar::doit_too(Foo x) { ... } 
```

在最后一种情况下，您被迫将两个方法的实现放在两个类的声明之后，因为仅知道这`Foo`是一个类不足以编译复制操作（注意方法中的参数已按值传递，而不是通过指针或引用）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-26T12:11:30.057

在第四行，没有人知道是什么`C`。这是一个未知的标识符。

这使得定义`Visitor`无效，因此当您稍后尝试使用`Visitor`时会发生另一个错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-26T12:11:37.503

问题是 C 类在访问者使用它时没有定义。将其移至顶部（即 C 类）或：

```
class C; 
```

在文件顶部添加上述前向声明。由于您仅将其用作参考参数，因此这就足够了。

# facebook - 数组中朋友的名字

> ID：13086656
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:09:02.097
> 
> 标签：facebook

我需要为学校制作一个 facebook 应用程序。是否可以检索登录人员的姓名并将其放入数组中？我在 actionscript 3.0 中制作这个应用程序

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-26T12:28:48.847

使用 Facebook PHP-SDK

```
$facebook = new Facebook(array(
                'appId' => 'Your_app_id',
                'secret' => 'Your_app_Secret',
                'cookie' => true,
            ));

    // Getting friends list
    $friends = $facebook->api('/me/friends');

    foreach ($friends as $friends1) {
      foreach ($friends1 as $friend) {

         $id = $friend['id'];
         $name = $friend['name'];
      }
   } 
```

# ruby - 用于 google-api-client gem 的 API

> ID：13086657
> 
> 赞同：2
> 
> 时间：2012-10-26T12:09:08.650
> 
> 标签：ruby, google-drive-api, google-api-client

我如何获得这个gem的api？我目前可以通过以下方式获取用户的姓名和电子邮件

```
google_client.execute!(:api_method => GoogleLogic.get_google_oauth2.userinfo.get).data.name
google_client.execute!(:api_method => GoogleLogic.get_google_oauth2.userinfo.get).data.email 
```

但是这些方法在这个gem的官方页面中没有写在哪里

[http://code.google.com/p/google-api-ruby-client/](http://code.google.com/p/google-api-ruby-client/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T17:11:54.707

由于 ruby​​ 客户端是动态生成的，它可能没有 API 文档。您可以在此处查看 API 定义：

[https://www.googleapis.com/discovery/v1/apis/oauth2/v1/rest](https://www.googleapis.com/discovery/v1/apis/oauth2/v1/rest)

查看库中生成了哪些方法/属性可能对您有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-03T20:42:04.653

不确定这是否相关，但我发现 github 页面上的文档非常有用：

[https://github.com/google/google-api-ruby-client](https://github.com/google/google-api-ruby-client)

还有样本：

[https://github.com/google/google-api-ruby-client-samples](https://github.com/google/google-api-ruby-client-samples)

最后，谷歌的开发者控制台非常有用。

[http://console.developers.google.com/](http://console.developers.google.com/)

# c++-cli - 从 c# 调用的 c++ 函数指针返回字符串

> ID：13086660
> 
> 赞同：0
> 
> 时间：2012-10-26T12:09:22.030
> 
> 标签：c++-cli, marshalling, function-pointers, managed, managed-c++

我需要从返回字符串的 c# 调用 c++ 回调函数。当我尝试使用下面的代码时，应用程序会严重崩溃（一条消息说这可能是由于堆损坏造成的）。

这是C++代码：

```
static String^ CppFunctionThatReturnsString()
{
    return gcnew String("From C++");
}

void main()
{
    CSharp::CSharpFunction(IntPtr(CppFunctionThatReturnsString));
} 
```

这是c#代码：

```
public class CSharp
{
    private delegate string CppFuncDelegate();

    public static void CSharpFunction(IntPtr cppFunc)
    {
        var func = (CppFuncDelegate)Marshal.GetDelegateForFunctionPointer(cppFunc, typeof(CppFuncDelegate));
        func(); // Crash
    }
} 
```

在返回之前，我是否必须对字符串进行某种编组魔法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T16:12:40.727

你为什么首先使用函数指针？只需将委托的一个实例传递给 C# 代码：

**C++：**

```
static String^ CppFunctionThatReturnsString()
{
    return gcnew String("From C++");
}

void main()
{
    CSharp::CSharpFunction(new CSharp::CppFuncDelegate(CppFuncThatReturnsString));
} 
```

**C＃：**

```
public class CSharp
{
    private delegate string CppFuncDelegate();

    public static void CSharpFunction(CppFuncDelegate d)
    {
        d();
    }
} 
```

我认为您可能需要将 CppFuncThatReturnsString 放在一个类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:42:38.277

[我在这个十年前的页面](http://discuss.fogcreek.com/dotnetquestions/default.asp?cmd=show&ixPost=1108)上找到了答案。

C++：

```
static const char* __stdcall CppFunctionThatReturnsString()
{
    return "From C++";
}

void main()
{
    CSharp::CSharpFunction(IntPtr(CppFunctionThatReturnsString));
} 
```

C＃：

```
public class CSharp
{
    private delegate IntPtr CppFuncDelegate();

    public static void CSharpFunction(IntPtr cppFunc)
    {
        var func = (CppFuncDelegate)Marshal.GetDelegateForFunctionPointer(cppFunc, typeof(CppFuncDelegate));
        Marshal.PtrToStringAnsi(func());
    }
} 
```

也就是说，将其作为 IntPtr 传递并在 C# 端将其编组为字符串。

# jquery - 如何在自动完成中删除重复项

> ID：13086662
> 
> 赞同：2
> 
> 时间：2012-10-26T12:09:28.480
> 
> 标签：jquery

```
<html>
<head>
  <script src=".\jquery.1.4.2.js"></script>
  <link rel="stylesheet" enter code heref=".\jquery.autocomplete.css" type="text/css" />   
  <script type="text/javascript" src=".\jquery.autocomplete.js"></script>

  <script>
  $(document).ready(function(){
      var data = "AndraPradesh;ArunachalPradesh;Assam;Bihar;Chhattisgarh;Goa;Gujarat;Haryana;HimachalPradesh;Jammuan&Kashmir;Jharkhand;Karnataka;Kerala;MadyaPradesh;Maharashtra;Manipur;Meghalaya;Mizoram;Nagala;Orissa;Punjab;Rajasthan;Sikkim;TamilNadu;Tripura;Uttaranchal;UttarPradesh;WestBengal".split(";");

   $("#example").autocomplete((data),{ matchContains: 0, minChars: 1, scroll: true, width: 143, selectFirst: true, multiple: true, multipleSeparator: ';', autoFill: false });
});
  </script>

</head>
<body>
<b><font color="red">ENTER INDIAN 'STATE' NAME TO SEE AUTOCOMPLETE</font></b>
<br><br> Enter States <input id="example" /> <button onclick="javascript:displaycontent();">click me</button>
</body>
<script>
function displaycontent()
{
var alertmsg = $("#example")[0].value;
alert(alertmsg );
}
</script>
</html> 
```

我已经使用了上面的代码....一旦我输入了州名....当我们输入另一个州名时，它不应该出现在下一次尝试中

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T12:34:35.653

生病详细说明henkieee的评论：

```
var data = "AndraPradesh;ArunachalPradesh;Assam;Bihar;Chhattisgarh;Goa;Gujarat;Haryana;HimachalPradesh;Jammuan&Kashmir;Jharkhand;Karnataka;Kerala;MadyaPradesh;Maharashtra;Manipur;Meghalaya;Mizoram;Nagala;Orissa;Punjab;Rajasthan;Sikkim;TamilNadu;Tripura;Uttaranchal;UttarPradesh;WestBengal".split(";");

var distinct = [];

$.each(data , function(i, el){
    if($.inArray(el, distinct ) === -1) 
        distinct.push(el);
});

//distinct will not contain any duplicates 
```

或者，如果您不想使用 jquery（在 ie7 中不起作用）：

```
var distinct = data.filter(function(elem, pos) {
    return data.indexOf(elem) == pos;
}); 
```

## [小提琴](http://jsfiddle.net/Ac64Z/)

# javascript - 双 Javascript 计数器不可能？

> ID：13086664
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:09:35.620
> 
> 标签：javascript, counter

我有一个很小的 ​​php 文件，上面只有一个 div 和一个倒计时 javascript。这是代码：

```
 <b><div id="COUNTER"></div></b>
        <SCRIPT type="text/javascript">
        var TargetCOUNTER = document.getElementById('COUNTER');
        //HIER DIE SEKUNDEN EINTRAGEN HERR REUTER !!
        var SecondsCOUNTER = 5654;
        //------------------------------------------
        var TargetTimeCOUNTER = new Date();
        var TimeBeginnCOUNTER = TargetTimeCOUNTER.getTime();
        var TimeEndCOUNTER = TimeBeginnCOUNTER + (SecondsCOUNTER*1000);
        TargetTimeCOUNTER.setTime(TimeEndCOUNTER);

        var DayCOUNTER = TargetTimeCOUNTER.getDate();
        var MonthCOUNTER = TargetTimeCOUNTER.getMonth() + 1;
        var YearCOUNTER = TargetTimeCOUNTER.getYear();
        if(YearCOUNTER < 999) YearCOUNTER += 1900;
        var hCOUNTER = TargetTimeCOUNTER.getHours();
        var mCOUNTER = TargetTimeCOUNTER.getMinutes();
        var sCOUNTER = TargetTimeCOUNTER.getSeconds();

        var fdayCOUNTER  = ((DayCOUNTER < 10) ? "0" : "");
        var fmonthCOUNTER  = ((MonthCOUNTER < 10) ? ".0" : ".");
        var fhCOUNTER  = ((hCOUNTER < 10) ? "0" : "");
        var fmCOUNTER  = ((mCOUNTER < 10) ? ":0" : ":");
        var fsCOUNTER  = ((sCOUNTER < 10) ? ":0" : ":");

        var EndDateCOUNTER = fdayCOUNTER + DayCOUNTER + fmonthCOUNTER + MonthCOUNTER  + "." + YearCOUNTER;
        var EndTimeCOUNTER = fhCOUNTER+hCOUNTER+fmCOUNTER+mCOUNTER+fsCOUNTER+sCOUNTER;

        CountDownCOUNTER();
        function CountDownCOUNTER() {
            var CurrentDateCOUNTER = new Date();
            var CurrentTimeCOUNTER = CurrentDateCOUNTER.getTime()
            var OpenTimeCOUNTER = Math.floor((TargetTimeCOUNTER-     CurrentTimeCOUNTER)/1000);

            var sCOUNTER = OpenTimeCOUNTER % 60;
            var mCOUNTER = ((OpenTimeCOUNTER-sCOUNTER)/60) % 60;
            var hCOUNTER = ((OpenTimeCOUNTER-sCOUNTER-mCOUNTER*60)/(60*60));
            var fhCOUNTER  = ((hCOUNTER < 10) ? "0" : "");
            var fmCOUNTER  = ((mCOUNTER < 10) ? ":0" : ":");
            var fsCOUNTER  = ((sCOUNTER < 10) ? ":0" : ":");

            var TimeCOUNTER = fhCOUNTER+hCOUNTER+fmCOUNTER+mCOUNTER+fsCOUNTER+sCOUNTER;
            var OutputStringCOUNTER=TimeCOUNTER;

            if(OpenTimeCOUNTER<=0) { // Event wenn der Countdown abgelaufen ist
                OutputStringCOUNTER="<a href='../hackerz/fight.php' style='text-decoration: none; color: #00ff00'>Aktualisieren</a>";
            }

            TargetCOUNTER.innerHTML=OutputStringCOUNTER; // Ausgabe des Strings in der Betreffenden Zelle
            document.title=(OutputStringCOUNTER.substring(0,2)=="<a")?"!!!READY!!!":OutputStringCOUNTER;
            window.setTimeout("CountDownCOUNTER()",1000);
        }
    </SCRIPT> 
```

它工作得很好。你可以在这里查看：http: [//dev.willstequatschen.de/hw/sites/hackerz/counter.php](http://dev.willstequatschen.de/hw/sites/hackerz/counter.php)

但我想用不同的计数器显示 2 行，当我复制并粘贴代码两次时，第二个计数器不显示。这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:16:53.157

将所有代码包装在一个接受计数器容器 id 的函数中：

```
function setCounter(id) {
    var TargetCOUNTER = document.getElementById(id);
    // rest of your code here
} 
```

分别为每个计数器调用此函数：

```
setCounter('COUNTER1');
setCounter('COUNTER2'); 
```

见演示[http://jsfiddle.net/dfsq/CdeGs/](http://jsfiddle.net/dfsq/CdeGs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:14:19.160

如果您只是复制并粘贴代码，则两个副本都可以使用`<div id="COUNTER"></div>`（这意味着只有一个计数器）。

您需要将代码更改为具有 2 个计数器 div，并让您的`CountDownCOUNTER`函数将其作为参数或使其同时更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:14:22.947

很可能您需要将副本的 ID 从“COUNTER”更改为其他唯一的 ID。您需要在原始标签以及 JS 的“GetElementbyID”顶部更改它。

事实上，根据代码的外观，最好只对“COUNTER”到“ALTCOUNTER”或其他不同的整个第二个副本进行全局搜索和替换，以防止与变量和函数名称发生冲突。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T12:17:19.783

您的代码并非真正面向对象或编写时考虑到可重用性，因此您只能以这种方式使用单个实例。

推荐的方法是以更抽象和组件式的方式重写您的代码，例如“插件”。

也许你应该放弃你的代码并使用一些现成的解决方案。

您可以做的肮脏方法是将计数器加载到单个 iframe 中 - 它可以解决范围冲突问题，但我真的不推荐它。

# jquery - 提交事件中的 Jquery 表单验证触发另一轮

> ID：13086668
> 
> 赞同：0
> 
> 时间：2012-10-26T12:09:51.790
> 
> 标签：jquery, jquery-validate

```
 $('form').on('submit', function(e) {
    e.preventDefault();
    if(!$(this).valid()) {
        $(this).find(".dialogErrorMessageArea").show();
    } else {
        $(this).submit();
    }
}); 
```

如果表单无效，我正在尝试使我的自定义错误消息区域可见。但是，else 分支现在返回到此处理程序并且从不提交。如何在else分支提交表单？或者这种方法是错误的，如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:12:49.723

尝试这个：

```
$('form').on('submit', function(e) {
  if(!$(this).valid()) {
    $(this).find(".dialogErrorMessageArea").show();
    e.preventDefault();
  }
}); 
```

或者更简单一点：

```
$('form').submit(function(e) {
  if(!$(this).valid()) {
    $(this).find(".dialogErrorMessageArea").show();
    e.preventDefault();
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:15:34.203

只需使用表单属性提交表单：

```
$('form').on('submit', function(e) {
    e.preventDefault();
    if(!$(this).valid()) {
        $(this).find(".dialogErrorMessageArea").show();
    } else {
        $("form").submit();
    }
}); 
```

# c# - 使用 MVVM 进行异步更新？

> ID：13086674
> 
> 赞同：1
> 
> 时间：2012-10-26T12:10:10.000
> 
> 标签：c#, wpf, mvvm

我的模型包含我从代码隐藏更新的*大型*数据对象（目前这发生在 UI 线程上，但我打算稍后在工作人员中执行此操作）。我的一个窗口具有此模型的视图模型，并使用`IValueConverter`. 问题是这种转换需要几秒钟。因此，我需要我的窗口来异步获取这些更新的数据。如何才能做到这一点？

**MyControl.xaml：**

```
<UserControl.DataContext>
   <local:DataViewModel x:Name="dataViewModel"/>
</UserControl.DataContext> 
```

**然后在代码中：**

```
// This triggers my value converter and blocks the UI for several seconds!
dataViewModel.HeavyObject = data; 
```

多线程代码应该去哪里？它应该是视图模型的一部分还是我的价值转换器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:17:06.517

查看`IsAsync="True"`您的绑定并检查`PriorityBinding`.

[在这里](http://www.switchonthecode.com/tutorials/wpf-tutorial-priority-bindings)您可以找到有关 PriorityBinding 的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:19:04.937

如果在您的视图模型和值转换器之间进行选择，我会投票支持视图模型。但是，我更愿意在负责与数据存储交互的存储库或客户端服务中看到您的长期运行操作。

# ruby - 从 puppet-server 以外的主机 puppet 远程复制文件

> ID：13086677
> 
> 赞同：1
> 
> 时间：2012-10-26T12:10:21.900
> 
> 标签：ruby, puppet

有没有办法将文件从同一域（mydom.org）中的另一个（bar）复制到一个主机（foo），它们都不是 puppet-server，但它们都运行了*puppetd*？我正在寻找类似于*cfengine 副本中的**服务器*方法的东西，其中可以为源文件提供服务器名称。这是我尝试过但失败的方法：

 *```
 node 'foo.mydom.org' inherits default {
    include foo_class::setup
 } 
```

foo_class::setup 在 puppet-server 节点的 modules/foo_class/setup.pp 中定义。

```
 class foo_class::setup {
    file {
     "etc_passwd_file" :
       path => "/etc/passwd",
       source => "puppet://bar.mydom.org//${path_to_file}",
    }
  } 
```

跑步时

```
 puppet --noop --server=puppet --no-daemonize --verbose --onetime 
```

我得到错误：

```
 " ..... Could not evaluate: Could not retrieve information from environment production source(s) puppet://bar.mydom.org//${path_to_file} at /etc/puppet/modules/foo_class/manifests/setup.pp ...." 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T17:50:49.747

不幸的是，只有 Puppet 无法做到这一点。Puppet 代理进程能够侦听和接受连接，但它们不像 puppet master 那样实现文件服务器。puppet 代理的侦听行为旨在用于`puppet kick`功能，从 Puppet 3.0 开始不推荐使用，而支持 MCollective。*

# objective-c - 在 Objective C 中使用正则表达式匹配方括号

> ID：13086682
> 
> 赞同：1
> 
> 时间：2012-10-26T12:10:42.023
> 
> 标签：objective-c, regex, nspredicate

我找不到任何专门解决如何在 Stack Overflow 或 Google 上的谓词中找到方括号的内容，所以我想我会在这里发布它，看看是否有人可以解释解决方案。

```
NSString *mstr = @"fasd[981db7007771ffa3]dfaads";
NSString *test =@".*\\[[0-9,a-f]{16}\\].*";
//NSPredicate *pred = [NSPredicate predicateWithFormat:@"SELF MATCHES '.*\\\\[[0-9,a-f]{16}\\\\].*'"]; //works
NSPredicate *pred = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", test];
if ([pred evaluateWithObject:mstr]) {
    NSLog(@"Yes");
} 
```

似乎当转义括号时，你需要四个反斜杠，但如果你把它放在一个字符串中，你只需要两个。不清楚为什么会这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:43:33.407

原因是因为`NSPredicate`它自己的反斜杠转义以及 C 编译器的转义。所以，让我们来看看首先完成的步骤：

**来源**：

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"\\\\[(regex here)\\\\]"]; 
```

**C-预编译器**：（取消一组反斜杠）

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"\\[(regex here)\\]"]; 
```

**NSPredicate 内部编译器**：（取消第二组反冲，并编译正则表达式）。

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"\[(regex here)\]"]; 
```

传入字符串文字时，首先编译它`NSPredicate`，而传递变量时，它的编译方式不同（它跳过了转义部分）。

# dialog - TreeStore DragNrop 活动未反映在 TreeStore 中

> ID：13086683
> 
> 赞同：0
> 
> 时间：2012-10-26T12:10:47.830
> 
> 标签：dialog, gxt, tree-structure

我创建了一个简单的 DragNDrop 编辑器来修改要保存在我的数据库中的树。（使用GXT 2.2.5无法升级）

我有一个用 TreeStore 构建的 TreePanel。TreePanel 既是 TreePanelDragSource 又是 TreePanelDropTarget。

拖放工作正常；作为测试，我使用了现有打开的 Dialog 窗口中的 TreeStore。当我在编辑器中拖放时，另一个窗口会立即显示树的变化。

但是，当我获取 TreeStore 以保存它时，节点不会在 Store 中重新排列。如何获得重组后的树结构？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T14:22:12.953

我的解决方案

```
Apparently there is no way to directly get at the Tree structure altered by Drag and Drop.
I reasoned that TreePanelView = TreePanel.getView() might have the Drag and Drop chaanges.
By examining TreePanelView in the debugger after a drag and drop I devise this solution:
/*
* These 'My' classes are used to access the internal tree within TreePanelView.
* The internal tree reflects Drag and Drop activity,
* which is NOT reflected in the TreeStore.
*/
private class MyTreePanel<M extends ModelData> extends TreePanel<M> {
    public MyTreePanel(TreeStore<M> ts) {
        super(ts);
        view = new MyView<M>();
        view.bind(this, store);
    }
    public MyView<M> getMyView() {
        return (MyView<M>) getView();
    }
}
private class MyView<M extends ModelData> extends TreePanelView<M> {
    public MyTreeStore<M> getTreeStore() {
        return (MyTreeStore<M>) this.treeStore;
    }
}
private class MyTreeStore<M extends ModelData> extends TreeStore<M> {
    public MyTreeStore() {
        super();
    }
    public Map<M, TreeModel> getModelMap() {
        return modelMap;
    }
}
To extract the tree altered by Drag and Drop:
MyTreePanel<ModelData> myTree; //Initialize the TreeStore appropriately

// After Drag and Drop activity, get the altered tree thusly:
Map<ModelData, TreeModel> viewMap = myTree.getMyView().getTreeStore().getModelMap();

The TreeModel in viewMap is actually a BaseTreeModel.
The ModelData are the objects I originally loaded into TreeStore.
I had to:
1 - Iterate over viewMap, extract "id" from BaseTreeModel and create a reverse map,
    indexed by "id" and containing my ModelData objects.
2 - Fetch root BaseTreeModel node from viewMap using root ModelData of original tree.
3 - Walk the BaseTreeModel tree.
    At each node, fetched ModelData objects by "id" from the reverse map.

In this way I reconstructed the tree altered by Drag and Drop. 
```

# javascript - 如何在不使用 [] 的情况下在 IE8 上的 javascript 中选择对象的第一个元素？

> ID：13086687
> 
> 赞同：0
> 
> 时间：2012-10-26T12:10:58.697
> 
> 标签：javascript, jquery, canvas, selector

我正在与 IE8 和`flashcanvas.js`试图捕获签名的插件作斗争。

该[演示](http://thomasjbradley.ca/lab/signature-pad/require-drawn/)在 IE8 上运行良好，但由于我使用了许多其他插件，包括 requireJS，我在 IE8 上遇到了某种问题。

我已经确定了这一点：

```
function onReadyStateChange() {
if (document.readyState === "complete") {
    document.detachEvent(ON_READY_STATE_CHANGE, onReadyStateChange);

    var canvases = document.getElementsByTagName(CANVAS);

    // => returns 1 in IE8 debugger
    console.log( canvases.length )
    // => returns objectHTMLCollection
    console.log( canvases )

    for (var i = 0, n = canvases.length; i < n; ++i) {
        console.log(" run "+i)

        // => this produces an error...
        console.log( canvases[i])

        // trigger
        FlashCanvas.initElement(canvases[i]);
        }
    }
} 
```

我不明白为什么它不起作用，但`canvases[i]`会引发`[object HTMLUnknownElement]`错误。

**问题**：
知道可能是什么原因吗？作为一种工作方法，我怎么能在`objectHTMLCollection`不使用`[]`和停留在 Javascript 的情况下选择我的第一个元素！

我还尝试向`id`画布元素添加一个或按类选择它（使用 Jquery）。同样的结果，，`length=1`选择=忘记它。

感谢帮助！

**编辑**：
我从我的主应用控制器请求这样的插件：

```
$(document).on('pagebeforeshow', '#basket', function(e, data){  

    // signaturePad
    var signIt = $('.signatureWrapper');
    if ( signIt.length > 0 && signIt.jqmData('bound') != true ) {
        signIt.jqmData('bound', true);

        require(['services/signature/app'], function (App) {
        App.render({target: signIt, drawOnly: true });
            });
        }; 
```

这将调用一个`app.js`文件，该文件定义了所需的所有依赖项，并且一旦加载了所有内容，就触发插件：

```
define([  'services/signature/app'
        , 'services/signature/jquery.signaturepad.min'
        , 'services/signature/json2.min'
        , 'services/signature/flashcanvas'
        ], function( app, signature, json2, flashcanvas ) {

    function render(parameters) {
        parameters.target.signaturePad({ drawOnly:parameters.drawOnly });
        };
        return {
            render:render
            };  
        }); 
```

`flashcanvas.js`所以，当我真的不需要它时，我正在浪费一个 http 请求。但是所有文件都加载好了，我相信......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:42:42.520

你如何将 canvas 元素添加到 DOM 中？由于 IE8 不支持 canvas 元素，您需要动态创建它并将其附加到 DOM，如[FlashCanvas 文档中所示](http://flashcanvas.net/docs/usage)

```
var canvas = document.createElement("canvas");
document.getElementById("target").appendChild(canvas);
if (typeof FlashCanvas != "undefined") {
    FlashCanvas.initElement(canvas);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:46:31.500

数组 document.getElementsByName(String balise) [http://www.toutjavascript.com/reference/reference.php?iref=156](http://www.toutjavascript.com/reference/reference.php?iref=156)

你写了 ：

```
var canvases = document.getElementsByTagName(CANVAS); 
```

你确定 CANVAS 是一个字符串吗？也许你想写

```
var canvases = document.getElementsByTagName("CANVAS"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:23:04.510

尝试将集合转换为数组：

var arr = Array.prototype.slice.call( canvases );

# java - 了解 -XX:+PrintCompilation 的输出

> ID：13086690
> 
> 赞同：20
> 
> 时间：2012-10-26T12:11:17.533
> 
> 标签：java, microbenchmark

我正在对 Java 列表迭代代码运行一些微基准测试。我使用了 -XX:+PrintCompilation 和 -verbose:gc 标志来确保在计时运行时后台没有发生任何事情。但是，我在输出中看到了一些我无法理解的内容。

**这是代码，我正在运行基准测试：**

```
import java.util.ArrayList;
import java.util.List;

public class PerformantIteration {

    private static int theSum = 0;

    public static void main(String[] args) {
        System.out.println("Starting microbenchmark on iterating over collections with a call to size() in each iteration");
        List<Integer> nums = new ArrayList<Integer>();
        for(int i=0; i<50000; i++) {
            nums.add(i);
        }

        System.out.println("Warming up ...");
        //warmup... make sure all JIT comliling is done before the actual benchmarking starts
        for(int i=0; i<10; i++) {
            iterateWithConstantSize(nums);
            iterateWithDynamicSize(nums);
        }

        //actual        
        System.out.println("Starting the actual test");
        long constantSizeBenchmark = iterateWithConstantSize(nums);
        long dynamicSizeBenchmark = iterateWithDynamicSize(nums);
        System.out.println("Test completed... printing results");

        System.out.println("constantSizeBenchmark : " + constantSizeBenchmark);
        System.out.println("dynamicSizeBenchmark : " + dynamicSizeBenchmark);
        System.out.println("dynamicSizeBenchmark/constantSizeBenchmark : " + ((double)dynamicSizeBenchmark/(double)constantSizeBenchmark));
    }

    private static long iterateWithDynamicSize(List<Integer> nums) {
        int sum=0;
        long start = System.nanoTime();        
        for(int i=0; i<nums.size(); i++) {
            // appear to do something useful
            sum += nums.get(i);
        }       
        long end = System.nanoTime();
        setSum(sum);
        return end-start;
    }

    private static long iterateWithConstantSize(List<Integer> nums) {
        int count = nums.size();
        int sum=0;
        long start = System.nanoTime();        
        for(int i=0; i<count; i++) {
            // appear to do something useful
            sum += nums.get(i);
        }
        long end = System.nanoTime();
        setSum(sum);
        return end-start;
    }

    // invocations to this method simply exist to fool the VM into thinking that we are doing something useful in the loop
    private static void setSum(int sum) {
        theSum = sum;       
    }

} 
```

**这是输出。**

```
 152   1       java.lang.String::charAt (33 bytes)
    160   2       java.lang.String::indexOf (151 bytes)
    165   3Starting microbenchmark on iterating over collections with a call to size() in each iteration       java.lang.String::hashCode (60 bytes)
    171   4       sun.nio.cs.UTF_8$Encoder::encodeArrayLoop (490 bytes)
    183   5
       java.lang.String::lastIndexOf (156 bytes)
    197   6       java.io.UnixFileSystem::normalize (75 bytes)
    200   7       java.lang.Object::<init> (1 bytes)
    205   8       java.lang.Number::<init> (5 bytes)
    206   9       java.lang.Integer::<init> (10 bytes)
    211  10       java.util.ArrayList::add (29 bytes)
    211  11       java.util.ArrayList::ensureCapacity (58 bytes)
    217  12       java.lang.Integer::valueOf (35 bytes)
    221   1%      performance.api.PerformantIteration::main @ 21 (173 bytes)
Warming up ...
    252  13       java.util.ArrayList::get (11 bytes)
    252  14       java.util.ArrayList::rangeCheck (22 bytes)
    253  15       java.util.ArrayList::elementData (7 bytes)
    260   2%      performance.api.PerformantIteration::iterateWithConstantSize @ 19 (59 bytes)
    268   3%      performance.api.PerformantIteration::iterateWithDynamicSize @ 12 (57 bytes)
    272  16       performance.api.PerformantIteration::iterateWithConstantSize (59 bytes)
    278  17       performance.api.PerformantIteration::iterateWithDynamicSize (57 bytes)
Starting the actual test
Test completed... printing results
constantSizeBenchmark : 301688
dynamicSizeBenchmark : 782602
dynamicSizeBenchmark/constantSizeBenchmark : 2.5940773249184588 
```

**我不明白输出中的这四行。**

```
260   2%      performance.api.PerformantIteration::iterateWithConstantSize @ 19 (59 bytes)
268   3%      performance.api.PerformantIteration::iterateWithDynamicSize @ 12 (57 bytes)
272  16       performance.api.PerformantIteration::iterateWithConstantSize (59 bytes)
278  17       performance.api.PerformantIteration::iterateWithDynamicSize (57 bytes) 
```

*   为什么这两种方法都被编译两次？
*   我如何阅读这个输出......各种数字是什么意思？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-26T13:45:50.177

我将尝试在[Thomas Jungblut](https://stackoverflow.com/users/540873/thomas-jungblut)发布的这个[链接](https://gist.github.com/1165804#file_notes.md)的帮助下回答我自己的问题。

```
260   2%      performance.api.PerformantIteration::iterateWithConstantSize @ 19 (59 bytes)
268   3%      performance.api.PerformantIteration::iterateWithDynamicSize @ 12 (57 bytes)
272  16       performance.api.PerformantIteration::iterateWithConstantSize (59 bytes)
278  17       performance.api.PerformantIteration::iterateWithDynamicSize (57 bytes) 
```

**第一栏**

第一列“260”是时间戳。

**第二栏**

第二列是compile_id 和method_attributes。当触发 HotSpot 编译时，每个编译单元都会获得一个编译 ID。第二列中的数字是编译 id。JIT 编译和 OSR 编译有两种不同的编译 id 序列。所以 1% 和 1 是不同的编译单位。前两行中的 % 表示这是一个 OSR 编译。触发了 OSR 编译，因为代码在一个大循环上循环，并且 VM 确定此代码很热。因此，触发了 OSR 编译，这将使 VM 能够执行堆栈替换并在准备好后转移到优化的代码。

**第三栏**

第三列`performance.api.PerformantIteration::iterateWithConstantSize`是方法名称。

**第四栏**

当 OSR 编译发生和不发生时，第四列再次不同。我们先来看看常见的部分。第四列的末尾（59 个字节），指的是编译单元的字节码大小（不是编译代码的大小）。OSR 编译中的@19 部分指的是osr_bci。我将引用上面提到的链接 -

> Java 方法中的“位置”由其字节码索引 (BCI) 定义，触发 OSR 编译的位置称为“osr_bci”。一个 OSR 编译的 nmethod 只能从它的 osr_bci 输入；同一方法可以同时有多个 OSR 编译版本，只要它们的 osr_bci 不同。

**最后，为什么方法编译两次？**

第一个是 OSR 编译，这可能是由于预热代码（在示例中）而在循环运行时发生的，第二个编译是 JIT 编译，大概是为了进一步优化编译的代码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-28T03:44:30.180

我认为第一次 OSR 发生了，然后它改变了 Invocation Counter tigger 方法编译器（PS：对不起，我的英语是 pool）

# opengl - Opengl VAO 和制服：在渲染循环中处理许多模型

> ID：13086692
> 
> 赞同：1
> 
> 时间：2012-10-26T12:11:19.067
> 
> 标签：opengl

假设我有一个描述场景中模型的类（例如矩形）。此类包含最重要的模型矩阵和 VAO。在我的渲染代码中设计绘图循环时，我现在执行以下操作（伪代码）：

```
functon draw{
  list = getListOfMeshes() /* List containing mesh class items */
  iterate list { /* could be for example 1000 different models */
    set model matrix uniform
    bind VAO 
    draw elements
  }
} 
```

我知道这可能会优化为仅一个 VAO 调用：

```
functon draw{
  bind VAO
  draw elements
  /* How to handle the uniforms that are different for each model?? */
} 
```

一旦我在我的场景中获得了许多模型，这个列表迭代就会成为一个瓶颈。有没有另一种方法来设计这个渲染循环？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-26T16:19:43.073

您将要创建一个模型界面。然后根据界面创建一个项目列表。所以像

```
<code>
class interface{
    virtual render() = 0;
    virtual setUniforms()=0;
};

class object : public interface{
    render();
    setUniforms();
};
</code> 
```

通过这种方式，您可以根据要调用的制服类型为您正在使用的每个模型调用 set uniforms 函数。所以需要法线贴图的东西可以有那个制服，而其他需要其他制服的东西可以有那些。所有实现的统一调用都将在 setUniforms() 的对象类实现中；并且由于它们是通用接口，循环和代码将为您传递到满足接口的列表中的每个对象执行适当的功能。

希望这可以帮助 ：）

# android - 我在后台使用 doInBackground() 在哪里使用 onPostExecute()

> ID：13086693
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:11:24.757
> 
> 标签：android, android-mapview, android-maps, android-parser

我正在尝试将 JSON 数据显示到 Mapview 中，但总是得到空白地图。

我知道要填充我需要在我的活动中使用 onPostExecute() 但我很困惑我需要在哪里放置 onPostExecute() 方法以及我需要在其中放置哪些行。

请有人进行这些更改，下面我已经编写了我的代码，提前感谢观众和读者

**JSON数据：-**

```
{
"maps": [
{

"title": "Place One",
"latitude" : "46.483742",
"longitude" : "7.663157",
"country": "Switzerland"
},
{
"title" : "Place Two",
"latitude" : "59.25235",
"longitude" : "18.465536",
"country" : "Sweden"
},
{
"title" : "Place Three",
"latitude" : "56.404182",
"longitude" : "-3.818855",
"country" : "Scotland"
}
]
} 
```

**活动代码：-**

```
 mapOverlays = mapView.getOverlays();        
    drawable = getResources().getDrawable(R.drawable.ic_launcher);
    itemizedOverlay = new SimpleItemizedOverlay (drawable, mapView);        
    itemizedOverlay.setShowClose(false);
    itemizedOverlay.setShowDisclosure(true);
    itemizedOverlay.setSnapToCenter(false);

    class DownloadWebPageTask extends AsyncTask<String, Void, String> {

        @Override
        protected String doInBackground(String... urls) {

    HttpClient client = new DefaultHttpClient();
    // Perform a GET request for a JSON list
    HttpUriRequest request = new HttpGet("https://dl.***.com/maps.json");
    // Get the response that sends back
    HttpResponse response = null;
    try {
        response = client.execute(request);
    } catch (ClientProtocolException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    // Convert this response into a readable string
    String jsonString = null;
    try {
        jsonString = StreamUtils.convertToString(response.
                    getEntity().getContent());
    } catch (IllegalStateException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

    // Create a JSON object that we can use from the String
    JSONObject json = null;
    try {
        json = new JSONObject(jsonString);
    } catch (JSONException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

               try{

     JSONArray jsonArray = json.getJSONArray("maps");
     Log.e("log_tag", "Opening JSON Array ");
        for
     (int i=0;i < jsonArray.length();i++){                      

            JSONObject jsonObject = jsonArray.getJSONObject(i);

                String latitude =  jsonObject.getString("latitude");
                String longitude =  jsonObject.getString("longitude");
                String title =  jsonObject.getString("title");
                String country = jsonObject.getString("country");

                double lat = Double.parseDouble(latitude);
                double lng = Double.parseDouble(longitude);

                     Log.e("log_tag", "ADDING GEOPOINT"+title); 

                      point = new GeoPoint(
                             (int) (lat * 1E6), 
                             (int) (lng * 1E6));
                    OverlayItem overlayItem = new OverlayItem(point, title, 
                            country);
                    itemizedOverlay.addOverlay(overlayItem);

                    }
               }catch(JSONException e)        {
                 Log.e("log_tag", "Error parsing data "+e.toString());
            } 

               itemizedOverlay.populateNow(); 

               mapOverlays.add(itemizedOverlay);
                    if (savedInstanceState == null) {
        MapController controller = mapView.getController();
                        controller.setCenter(point);
                        controller.setZoom(7);

                    } else {

     // example restoring focused state of overlays
                        int focused;
                focused = savedInstanceState.getInt("focused_1", -1);
                        if (focused >= 0) {
                            itemizedOverlay.setFocus
                (itemizedOverlay.getItem(focused));
                        }
                    }
                    return jsonString;   }
     }

     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T06:09:25.197

```
I understand your problem, the following code is how to get the json data and showing in a listview. It is helpful for you to show when you will write the PostExecute Method. you have to set the overlay items in PostExecute method.

    package com.androidhive.jsonparsing;

    import java.io.BufferedReader;
    import java.io.IOException;
    import java.io.InputStream;
    import java.io.InputStreamReader;
    import java.io.UnsupportedEncodingException;
    import java.util.ArrayList;
    import java.util.HashMap;

    import org.apache.http.HttpEntity;
    import org.apache.http.HttpResponse;
    import org.apache.http.client.ClientProtocolException;
    import org.apache.http.client.methods.HttpPost;
    import org.apache.http.impl.client.DefaultHttpClient;
    import org.json.JSONArray;
    import org.json.JSONException;
    import org.json.JSONObject;

    import android.app.ListActivity;
    import android.app.ProgressDialog;
    import android.content.Intent;
    import android.os.AsyncTask;
    import android.os.Bundle;
    import android.util.Log;
    import android.view.View;
    import android.widget.AdapterView;
    import android.widget.AdapterView.OnItemClickListener;
    import android.widget.ListAdapter;
    import android.widget.ListView;
    import android.widget.SimpleAdapter;
    import android.widget.TextView;

    public class AndroidJSONParsingActivity extends ListActivity {

        // url to make request
        private static String url = "http://api.androidhive.info/contacts/";

        // JSON Node names
        private static final String TAG_CONTACTS = "contacts";
        private static final String TAG_ID = "id";
        private static final String TAG_NAME = "name";
        private static final String TAG_EMAIL = "email";
        private static final String TAG_ADDRESS = "address";
        private static final String TAG_GENDER = "gender";
        private static final String TAG_PHONE = "phone";
        private static final String TAG_PHONE_MOBILE = "mobile";
        private static final String TAG_PHONE_HOME = "home";
        private static final String TAG_PHONE_OFFICE = "office";
        static InputStream is = null;
        static JSONObject jObj = null;
        static String json = "";

        // contacts JSONArray
        JSONArray contacts = null;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);
            new GetEventsTask().execute("");
        }

        protected class GetEventsTask extends
                AsyncTask<String, Integer, ArrayList<HashMap<String, String>>> {
            protected ArrayList<HashMap<String, String>> contactList;

            private final ProgressDialog dialog = new ProgressDialog(
                    AndroidJSONParsingActivity.this);

            //PreExecute Method

            protected void onPreExecute() {
                this.dialog.setMessage("Loading, Please Wait..");
                this.dialog.setCancelable(false);
                this.dialog.show();
            }

            //doInBackground Method

            @Override
            protected ArrayList<HashMap<String, String>> doInBackground(
                    String... params) {
                contactList = new ArrayList<HashMap<String, String>>();
                // Making HTTP request
                try {
                    // defaultHttpClient
                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    HttpPost httpPost = new HttpPost(url);

                    HttpResponse httpResponse = httpClient.execute(httpPost);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    is = httpEntity.getContent();
                    BufferedReader reader = new BufferedReader(
                            new InputStreamReader(is, "iso-8859-1"), 8);
                    StringBuilder sb = new StringBuilder();
                    String line = null;
                    while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    json = sb.toString();

                } catch (UnsupportedEncodingException e) {
                    e.printStackTrace();
                } catch (ClientProtocolException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }

                // try parse the string to a JSON object
                try {
                    jObj = new JSONObject(json);
                    Log.i("json objects",""+json);
                } catch (JSONException e) {
                    Log.e("JSON Parser", "Error parsing data " + e.toString());
                }
                try {
                    // Getting Array of Contacts
                    contacts = jObj.getJSONArray(TAG_CONTACTS);

                    // looping through All Contacts
                    for (int i = 0; i < contacts.length(); i++) {
                        JSONObject c = contacts.getJSONObject(i);

                        // Storing each json item in variable
                        String id = c.getString(TAG_ID);
                        String name = c.getString(TAG_NAME);
                        String email = c.getString(TAG_EMAIL);
                        String address = c.getString(TAG_ADDRESS);
                        String gender = c.getString(TAG_GENDER);

                        // Phone number is agin JSON Object
                        JSONObject phone = c.getJSONObject(TAG_PHONE);
                        String mobile = phone.getString(TAG_PHONE_MOBILE);
                        String home = phone.getString(TAG_PHONE_HOME);
                        String office = phone.getString(TAG_PHONE_OFFICE);

                        // creating new HashMap
                        HashMap<String, String> map = new HashMap<String, String>();

                        // adding each child node to HashMap key => value
                        map.put(TAG_ID, id);
                        map.put(TAG_NAME, name);
                        map.put(TAG_EMAIL, email);
                        map.put(TAG_PHONE_MOBILE, mobile);

                        // adding HashList to ArrayList
                        contactList.add(map);
                    }
                } catch (JSONException e) {
                    e.printStackTrace();
                }

                return contactList;
            }

            //onPostExecute Method 

            protected void onPostExecute(ArrayList<HashMap<String, String>> result) {
                    // selecting single ListView item
                ListView lv = getListView();
                ListAdapter adapter = new SimpleAdapter(getApplicationContext(),
                        contactList, R.layout.list_item, new String[] { TAG_NAME,
                                TAG_EMAIL, TAG_PHONE_MOBILE }, new int[] {
                                R.id.name, R.id.email, R.id.mobile });

                lv.setListAdapter(adapter);

                // Launching new screen on Selecting Single ListItem
                lv.setOnItemClickListener(new OnItemClickListener() {

                    @Override
                    public void onItemClick(AdapterView<?> parent, View view,
                            int position, long id) {
                        // getting values from selected ListItem
                        String name = ((TextView) view.findViewById(R.id.name))
                                .getText().toString();
                        String cost = ((TextView) view.findViewById(R.id.email))
                                .getText().toString();
                        String description = ((TextView) view
                                .findViewById(R.id.mobile)).getText().toString();

                        // Starting new intent
                        Intent in = new Intent(getApplicationContext(),
                                SingleMenuItemActivity.class);
                        in.putExtra(TAG_NAME, name);
                        in.putExtra(TAG_EMAIL, cost);
                        in.putExtra(TAG_PHONE_MOBILE, description);
                        startActivity(in);
                    }
                });

                    //Dismiss the dialog

                if (this.dialog.isShowing()) {
                    this.dialog.dismiss();
                }
            }

        }

    } 
```

# javascript - 当jquery.ajax中发生错误时如何退出jquery中的函数

> ID：13086694
> 
> 赞同：1
> 
> 时间：2012-10-26T12:11:25.180
> 
> 标签：javascript, jquery, ajax, function

当 jquery ajax 发生错误时，我想退出我的函数。例如：如果我使用具有 $.ajax 之外的其他指令的函数调用 $.ajax，并且当我的 $.ajax 调用出现错误时，如果我尝试调用 return 以结束剩余的指令，那些剩余的指令被执行。

所以，我想要的是从 erro $.ajax 参数结束整个函数。

```
$.ajax({
 type: "POST",
 url: "home.aspx/ReturnInfoAge",
 data: "{'dD':'" + $('#dDate_wx').val() + "','dM':'" + $('#dMonth_wx').val() + "','dY':'" +   $('#dYear_wx').val() + "'}",
 contentType: "application/json; charset=utf-8",
  dataType: "json",
   success: function (msg) {
    if (msg.d === true) {
       prt.children('.tipCont').remove();
     } else {
       getTooltips(prt, 'criticalv', 'critical', msg.d);
        showMessagingTiming('warning', msg.d, 'Vérification de la date de naissance', null, 5000);
         return;
          }
    },
     error: function (errorMsg) {
       getTooltips(prt, 'criticalv', 'critical', "Veuillez bien saisir la date de naissance.");
      showMessagingTiming('warning', 'Veuillez vérifier: certains champs n\'ont pas les valeurs qu\'il faut.', 'Vérification des champs', null, 5000);
       return;
     }
 })
//other instructions 
```

我只是不希望，如果 $.ajax 错误参数中发生错误来执行其他剩余指令

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:07:29.237

错误和成功回调是异步调用的，因此您的“其他指令”在调用其中一个回调之前开始工作。您应该将“其他说明”写入成功回调。

```
function containsAjax() {
    $.ajax({
        type: "POST",
        url: "home.aspx/ReturnInfoAge",
        data: "{'dD':'" + $('#dDate_wx').val() + "','dM':'" + $('#dMonth_wx').val() + "','dY':'" +   $('#dYear_wx').val() + "'}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            if (msg.d === true) {
                prt.children('.tipCont').remove();
            } else {
                getTooltips(prt, 'criticalv', 'critical', msg.d);
                showMessagingTiming('warning', msg.d, 'Vérification de la date de naissance', null, 5000);
            }
            //other instructions should be here.
        },
        error: function (errorMsg) {
            getTooltips(prt, 'criticalv', 'critical', "Veuillez bien saisir la date de naissance.");
            showMessagingTiming('warning', 'Veuillez vérifier: certains champs n\'ont pas les valeurs qu\'il faut.', 'Vérification des champs', null, 5000);
        }
    });
} 
```

如果您想从 containsAjax 函数返回某些内容，请使用回调：

```
function containsAjax(onsuccess, onfail) {
    $.ajax({
        type: "POST",
        url: "home.aspx/ReturnInfoAge",
        data: "{'dD':'" + $('#dDate_wx').val() + "','dM':'" + $('#dMonth_wx').val() + "','dY':'" +   $('#dYear_wx').val() + "'}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            if (msg.d === true) {
                prt.children('.tipCont').remove();
            } else {
                getTooltips(prt, 'criticalv', 'critical', msg.d);
                showMessagingTiming('warning', msg.d, 'Vérification de la date de naissance', null, 5000);
            }
            //other instructions should be here.
            onsuccess(msg);
        },
        error: function (errorMsg) {
            getTooltips(prt, 'criticalv', 'critical', "Veuillez bien saisir la date de naissance.");
            showMessagingTiming('warning', 'Veuillez vérifier: certains champs n\'ont pas les valeurs qu\'il faut.', 'Vérification des champs', null, 5000);
            onfail(errorMsg);
        }
    });
} 
```

并这样称呼它：

```
containsAjax(function(msg) {
    // success callback, returns 'msg'
}, function(errormsg) {
    // error callback, returns 'errormsg'
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:26:59.383

jquery ajax 方法返回一个 XMLHttpRequest 对象。您可以使用此对象取消或中止请求。

```
var xhr = null;

xhr = $.ajax({
    url : 'path/to/file?some-parameter',
    success : function(responseText) {
        // some DOM manipulation
    }
});

$(document).click(function() { xhr.abort() }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T15:54:46.320

如果您的函数在某个事件上被调用，那么您可以使用以下语句中止它。您可以在 Ajax 调用的错误块中编写此语句。

```
...
 error: function (errorMsg) {
   event.preventDefault();
   getTooltips(prt, 'criticalv', 'critical', "Veuillez bien saisir la date de naissance.");
   showMessagingTiming('warning', 'Veuillez vérifier: certains champs n\'ont pas les valeurs qu\'il faut.', 'Vérification des champs', null, 5000);
   return;
 }
... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T16:01:09.337

尝试抛出异常

```
error: function(){
    //...
    throw new Exception('Ajax error description');
} 
```

它会停止一切，你也会在调试控制台中看到它

# c# - winRT 中 BindingValidationError 的任何替代方法？

> ID：13086699
> 
> 赞同：0
> 
> 时间：2012-10-26T12:12:00.800
> 
> 标签：c#, windows-runtime, winrt-xaml, windows-store-apps, inotifydataerrorinfo

我正在用 C# 开发 winRT 应用程序。我正在使用 INotifyDataErrorInfo 进行验证。所以我如何在验证期间处理错误。我的意思是在 windows phone 中有一个名为“BindingValidationError”的事件，但这已从 winRT 中删除。所以有没有替代 BindingValidationError??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:37:21.537

如果要诊断错误绑定，可以尝试使用 Application.DebugSettings.BindingFailed 事件。对于验证 - 您可能需要在视图模型中完成所有操作。

# c# - 将范围转换为矩形

> ID：13086703
> 
> 赞同：2
> 
> 时间：2012-10-26T12:12:08.037
> 
> 标签：c#, .net, math

我需要将范围 BottomLeft (-180, -90), TopRight (180, 90) 转换为**System.Windows.Rect**。矩形是使用矩形的左上角位置和大小创建的，所以我尝试使用位置作为 (-180, 90) 和大小作为上述范围的宽度和高度来创建它，但这是错误的。

因此，我无法为上述范围创建 Rect。请帮助创建它。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:49:37.533

矩形可以表示为：

```
Rectangle d = new Rectangle(xCoordinate, yCoordinate, width, height); 
```

这里相关的坐标是左上角的坐标。因此，您应该根据可用的坐标计算这些参数。在你的情况下：

```
Rectangle d = new Rectangle(-90, 180, 180, 360); 
```

在哪里

```
width = right - left
height = top - bottom 
```

# android - 使背景半透明

> ID：13086706
> 
> 赞同：2
> 
> 时间：2012-10-26T12:12:13.470
> 
> 标签：android, android-layout

我希望我的 textView 或线性布局的背景是半透明的。我附上了一张图片作为我想要实现的示例。

[半透明 http://imagecdn3.maketecheasier.com/2011/03/kde-style-oxygen-transparent.jpg](http://imagecdn3.maketecheasier.com/2011/03/kde-style-oxygen-transparent.jpg)

我不想使整个活动半透明，而只是其中的一个布局字段。我怎样才能得到这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:14:57.023

See `Translucent` theme, descibed here:

[http://developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:14:09.940

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-23T02:12:09.833

**For making the activity Completely transparent**,

main.xml- android:background="@android:color/transparent"

manifest.xml- android:theme="@android:style/Theme.Translucent.NoTitleBar.Fullscreen"

**For making activity Translucent**

```
#00FFFFFF -  Full Transparency
#10FFFFFF -  90% Transparency
#20FFFFFF -  80% Transparency
#30FFFFFF -  70% Transparency
#40FFFFFF -  60% Transparency
#50FFFFFF -  50% Transparency
#60FFFFFF -  40% Transparency
#70FFFFFF -  30% Transparency
#80FFFFFF -  20% Transparency
#90FFFFFF -  10% Transparency
#99FFFFFF -  01% Transparency 
```

**Usage**- in layout.xml, android:background="20FFFFFF"

here "20" is transparency and "FFFFFF" is color Get HTML color codes from [http://html-color-codes.info/](http://html-color-codes.info/)

# calendar - 自定义 Redmine 日历显示的字段

> ID：13086707
> 
> 赞同：2
> 
> 时间：2012-10-26T12:12:25.067
> 
> 标签：calendar, redmine, redmine-plugins

我有兴趣将 Redmine 用于调度/租赁系统，并且我遇到了一个有点烦人的日历问题。

在日历上，我希望能够选择出现在默认视图中的字段，但我不确定如何去做。理想情况下，我希望主题成为主要链接，而不是跟踪器和问题 ID。

有什么方法可以修改 Redmine 在日历上显示的字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-01T22:12:58.063

Easyredmine 有一个可自定义的日历插件，可以按您选择的名称显示日历事件。我不确定它是否可以选择以您的首选字段作为标题显示已创建的问题。

[http://www.easyredmine.com/online-store/easy-redmine-plugins/meeting-manager](http://www.easyredmine.com/online-store/easy-redmine-plugins/meeting-manager)

# erlang - 如何在 Erlang 中为一组应用程序生成文档？

> ID：13086711
> 
> 赞同：3
> 
> 时间：2012-10-26T12:12:35.633
> 
> 标签：erlang, documentation-generation, rebar

## 我的问题

如何为多个应用程序生成类似 OTP 的文档？

## 解释

我已经开发了一个遵循 OTP 结构的应用程序库，并且我正在使用 rebar 来编译代码。

我的目录结构示例如下所示：

```
lib/
   apps/
      application_1/
         include/
         src/
      application_2/
         include/
         src/
      ...
   rebar.config
   rebar 
```

我的`rebar.config`文件如下所示：

```
{sub_dirs, ["apps/application_1",
            "apps/application_2",
            ...]}. 
```

当我运行`rebar doc`时，文档会生成并存储在`doc`每个应用程序目录内的文件夹中，但我想生成一个将库文件夹理解为一个单元的文档。换句话说，我想自动创建一个索引页面，就像 Erlang 文档一样。

我尝试理解 erl_docgen，但无济于事。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:49:19.183

对于 OTP，您在[http://erlang.org/doc](http://erlang.org/doc)上找到的文档似乎是使用一堆 HTML 模板、脚本和 Makefile 生成的。看：

[https://github.com/erlang/otp/tree/maint/system/doc/top](https://github.com/erlang/otp/tree/maint/system/doc/top)

您可能希望将其用作您自己的文档首页的“灵感*”*。

我不确定*rebar*是否可以为 Erlang 版本中包含的所有 Erlang 应用程序创建文档索引，但我对此表示怀疑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-09T16:43:18.450

[medoc](https://github.com/drozzy/medoc)（用于*多个*-edoc），是我编写的一个 rebar3 插件，它将所有文档放在同一个顶级`doc`目录中。

# objective-c - RestKit 重置核心数据存储

> ID：13086713
> 
> 赞同：1
> 
> 时间：2012-10-26T12:12:46.007
> 
> 标签：objective-c, ios, restkit

从官方 RestKit 页面[Restkit Github](https://github.com/RestKit/RestKit/wiki/Reset-to-a-Factory-Fresh-Persistent-Store)我发现以下重置商店：

```
- (void) resetSavedDatabase:(id)sender {
    RKManagedObjectStore *objectStore = [[RKObjectManager sharedManager] objectStore];
    [objectStore resetPersistentStores];
    [objectStore save:nil];    

} 
```

这样可行。但是，如果我在此方法之后执行以下操作，则会出现错误：

```
TestEntity *testEntity = [TestEntity createEntity];

testEntity.name = @"TestEntity";    

NSError *error;

[[RKObjectManager sharedManager].objectStore save:&error]; 
```

错误：

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“无法从此 NSManagedObjectContext 的协调器访问对象的持久存储”

一切都在后台调用。这个想法是，我想预加载一些 sqlite 数据，然后将它们与我的同步逻辑同步。（当我不删除持久存储时，逻辑有效）

有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:44:25.903

是的，它会自动重新创建存储，但在接下来的步骤中，它也会重新创建对象上下文。

所以你几乎肯定想在主线程上执行此操作。否则，RestKit 会将创建的持久存储与后台线程中的对象上下文相关联，并且在线程结束时会消失。

我完全不明白你为什么要这样做。

# javascript - 使用类名设置 div 的高度？

> ID：13086721
> 
> 赞同：1
> 
> 时间：2012-10-26T12:13:10.893
> 
> 标签：javascript, jquery, css

我有一个类名没有那个 id 的 div。

我需要使用浏览器窗口高度使用 Javascript 或 jquery 设置该 div ..

```
<div class="abc"> 

some content

</div> 
```

我如何设置div的高度？..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T12:14:56.683

你可以用 jQuery 和 .height() 做到这一点：

100px的具体高度：

```
$('.abc').height(100); 
```

对于浏览器内部高度，请执行以下操作：

```
$('.abc').height(window.innerHeight); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T12:16:00.693

```
$('.abc').height($(window).height()); 
```

要使其响应浏览器高度的变化，请执行以下操作：

```
$(window).on('resize load', setHeight);

function setHeight() {
    $('.abc').height($(window).height());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:23:33.200

习惯了像这样的css

```
html, body{
height:100%;
}
.abc{
height:100%;
} 
```

[**[现场演示][1]**](http://tinkerbin.com/G7reQsVP)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T12:15:52.350

用这个：

```
$('.abc').height(value); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T12:19:35.590

做就是了-

```
$(document).ready(function(){
  var height = $(window).height();
  $(".abc").height(height);
}); 
```

还要更改css -

```
.abc{
  overflow: auto;
} 
```

# grails - 这可以通过 formRemote 和一个 gsp 来实现吗？

> ID：13086724
> 
> 赞同：0
> 
> 时间：2012-10-26T12:13:15.353
> 
> 标签：grails, grails-controller

我有 create.gsp 用于创建域对象。除了普通的 html 正文和标题之外，我还有两个 div。一种用于显示命令对象错误，一种用于数据。我想用 AJAX 提交表单。当我提交表格时

```
<g:formRemote name="formName" update="errorsDiv" url="[controller:myController',       action:'checkAndForward']"> 
```

这被称为：

```
def checkAndForward= {CmdObject p ->        

    if (p.hasErrors()) {                            

       render(template:"/error",params:params,model :[p:p])
    } else {
    forward controller: "test", action: "save", params:params

    }
}

def save = {

    id=myservice.getData()
    render(view: "show", id:id)
} 
```

这是有效的，并且在控制器中调用了保存操作，但是..

问题是在“保存”操作后“show.gsp”显示到错误 div 所在的位置。

我只想刷新“显示”页面，就好像我从浏览器调用 /save 一样（当然带有发布的参数）

# c# - 使用asp.net将主键表的单选按钮列表的值获取到另一个外键表

> ID：13086725
> 
> 赞同：1
> 
> 时间：2012-10-26T12:13:16.500
> 
> 标签：c#, asp.net, sql-server-2008

我在 SQL Server 数据库中创建了两个表，在 ASP.NET 页面中创建了 RadioButtonList。在一个表中，我将每个单选按钮的值存储为主键。我希望在单击该单选按钮时，它的主键值存储在外键列中的另一个表中。

这里我在 MS-SQl 中使用存储过程。主键表是性别，外键表是用户。在aspx页面中，我将性别显示为单选按钮，现在的问题是如何获取性别表的主ID并填写用户表。我的代码如下：

```
ArrayList arSample = new ArrayList();
Object[] n_gender_id = new Object[3] { "@intGender", "Int", (rbtngender.SelectedValue != "") ? rbtngender.SelectedValue : "" }; 
```

我正在获取单选按钮的值，如何获取特定按钮的 ID。帮帮忙…………

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T03:48:22.340

听起来您想做类似的事情`SELECT [Id] FROM [user] WHERE [gender] = @intGender`并将@intGender 的值设置为选定的单选按钮值。

由于您显示的参数似乎是一个整数，我可能会从以下内容开始：

```
var arSample = new ArrayList();
int gender;
if (!int.TryParse(rbtngender.SelectedValue, out gender)) return;

using (var conn = new SqlConnection(ConfigurationManager.ConnectionStrings["connectionStringNameFromWeb.Config"].ConnectionString))
{
    using (var cmd = new SqlCommand("storedProcName", conn))
    {
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.AddWithValue("@intGender", gender);

        conn.Open();
        using (SqlDataReader dr = cmd.ExecuteReader())
        {
            while (dr.Read())
            {
                // process each row from the data reader...
                arSample.Add(dr["Id"]);
            }
        }
        conn.Close();
    }
} 
```

# mysql - 获取触发器更新行的主键值（MySQL）

> ID：13086733
> 
> 赞同：0
> 
> 时间：2012-10-26T12:14:03.187
> 
> 标签：mysql, sql, database, triggers

我希望确定`PRIMARY KEY`我刚刚更新的行的值。ie :是表中的`X`一个`int`值。`PRIMARY KEY``person`

此触发器在我手动输入`int`值时起作用，例如替换`X`为 1001。

```
use mydatabase;
DROP TRIGGER update_approved;
delimiter $
CREATE TRIGGER update_approved AFTER UPDATE ON person
FOR EACH ROW BEGIN
UPDATE referral_person SET
    approved = 1 WHERE
    id = X;
END$
delimiter ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:18:55.160

只需将其更改为

```
....
id = OLD.ColumnName 
```

*您的主键列*`ColumnName`的名称在哪里。

# c# - C# 属性无法识别

> ID：13086737
> 
> 赞同：2
> 
> 时间：2012-10-26T12:14:16.210
> 
> 标签：c#, attributes

这一定是一个愚蠢的问题：我在这里学习 C#，我正在尝试构建一个具有 iniFile 类的 dll。代码是从代码源直接复制[在这里](http://www.dotnet-snippets.com/dns/read-and-write-ini-files-SID574.aspx)

此项目无法构建，并出现错误“找不到类型或命名空间'DllImportAttribute'（您是否缺少 using 指令或程序集引用？）”。错误标志位于

```
[DllImport("kernel32")] 
```

如果我将属性注释掉，构建就会顺利进行。它必须设置在某个地方来解决这个问题。欢迎任何建议..thx

--更新--谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:15:49.123

确保您有以下用途：

```
System.Runtime.InteropServices 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T12:16:05.813

确保`using System.Runtime.InteropServices;`位于文件的顶部。

# .net - 每次用户使用 twitterizer 登录我的 WPF 程序时，如何避免要求 twitter 授予我的应用程序的访问权限？

> ID：13086738
> 
> 赞同：0
> 
> 时间：2012-10-26T12:14:15.597
> 
> 标签：.net, wpf, twitterizer

我正在使用 twitterizer 登录我的 wpf 程序。每次执行程序时，twitter 生成的 pin 都会存储在一个变量中，然后应用程序运行。是否可以只进行一次身份验证，然后记住该批准？如果可能，那怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:34:02.763

正如@BoltClock 所说，您需要存储 twitter 提供的令牌并使用它。

检查此链接可能对您有所帮助：

[实施标志推特](https://dev.twitter.com/docs/auth/implementing-sign-twitter)

[认证](https://dev.twitter.com/docs/api/1/get/oauth/authenticate)

# google-maps - 标记移动时如何绘制折线

> ID：13086743
> 
> 赞同：1
> 
> 时间：2012-10-26T12:14:30.547
> 
> 标签：google-maps

我正在使用来自这个问题的 ThinkingStiff 的代码[How to move a marker in Google Maps API](https://stackoverflow.com/questions/8024784/how-to-move-marker-in-google-maps-api)

如何在标记移动时添加到该代码以绘制折线？

```
<script type='text/javascript'>//<![CDATA[ 
$(window).load(function(){
function initialize() {

    var myLatLng = new google.maps.LatLng( 50, 50 ),
        myOptions = {
            zoom: 4,
            center: myLatLng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
            },
        map = new google.maps.Map( document.getElementById( 'map-canvas' ), myOptions ),
        marker = new google.maps.Marker( {position: myLatLng, map: map} );

    marker.setMap( map );
    moveMarker( map, marker );

}

function moveMarker( map, marker ) {

    //delayed so you can see it move
    setTimeout( function(){ 

        marker.setPosition( new google.maps.LatLng( 54, 54 ) );
        map.panTo( new google.maps.LatLng( 54, 54 ) );

    }, 1500 );

};

initialize();

});//]]>  

</script> 
```

# android - 更改 Android 模拟器的子网？

> ID：13086750
> 
> 赞同：2
> 
> 时间：2012-10-26T12:14:57.397
> 
> 标签：android, networking, emulation, subnet

我需要测试我编写的在不同国家/地区使用的应用程序。这个应用程序只能在那里工作，因为它与那里的本地网络通信。我的老板让我远程进入并在客户端 PC 上安装 Android 模拟器，以便我们可以运行测试。

PC 的网络配置在子网 192.168.0.xx 上运行应用程序要与之通信的设备位于 192.168.1.xx 上

似乎没有办法让模拟器在不同的子网上工作。互联网可以正常工作，所以我假设这是盲目地使用客户端 PC 的互联网连接（在 192.168.0.xx 上）。在这种情况下，如果我更改客户端 PC 的网络配置，我将失去远程连接并且无法继续工作！

我有一个谷歌无济于事。

有什么建议么？谢谢。

# java - Struts 验证框架：验证摘要为空

> ID：13086753
> 
> 赞同：0
> 
> 时间：2012-10-26T12:15:07.290
> 
> 标签：java, validation, struts, struts-validation

**背景**

我正在学习 Struts 1.x，目前正在使用验证框架。

**问题**

我有它处于半工作状态。目前它正在显示验证错误，但在 javascript 警报中..然后验证摘要（由 生成的东西`<html:error>`）是空白的。嗯，它有 3 个项目符号点应该是验证错误，但没有文本。

1.  我没想到它会使用 javascript 警报。我只想要验证摘要。如果可能的话，我该如何关闭它？
2.  为什么验证摘要缺少文本？

**编辑**

这是一些代码，如果有帮助的话。

struts-config.xml

```
<form-beans>
        <form-bean name="ProductActionForm" type="actionForms.ProductActionForm"/>
    </form-beans> 
```

验证.xml

```
<form name="ProductActionForm">
            <field property="name" depends="required">
                <arg key="ProductActionForm.name"/>
            </field>
            <field property="price" depends="required,float">
                <arg key="ProductActionForm.price"/>
            </field>
            <field property="quantityInStock" depends="integer,intRange">
                <arg0 key="ProductActionForm.quantityInStock"/>
                <arg1 name="intRange" key="${var:min}" resource="false"/>
                <arg2 name="intRange" key="${var:max}" resource="false"/>
                <var>
                    <var-name>min</var-name>
                    <var-value>0</var-value>
                </var>
                <var>
                    <var-name>max</var-name>
                    <var-value>9999</var-value>
                </var>
            </field>
        </form> 
```

JSP HTML：

```
<html:javascript formName="ProductActionForm" />
        <html:errors></html:errors>
        <html:form action="/AddProductAction" method="post" onsubmit="validateProductActionForm(this);">
            <table class="table table-striped">
                <tbody>
                    <tr>
                        <td>Name: </td>
                        <td><html:text property="name" /></td>
                    </tr>
                    <tr>
                        <td>Price: </td>
                        <td><html:text property="price" /></td>
                    </tr>
                    <tr>
                        <td># In Stock </td>
                        <td><html:text property="quantityInStock" /></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input type="submit" class="btn btn-primary" value="Submit" /></td>
                    </tr>
                </tbody>
            </table>
        </html:form> 
```

**编辑 2**

以下是一些截图：

显示 javascript 警报： ![显示 javascript 警报](../Images/cae94e15530423812f9c986fa92af5a3.png)

显示空白验证摘要： ![显示空白验证摘要](../Images/845256f17c00076163f19cdb78668879.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T19:03:34.463

嗨，马特，我们开始吧有 2 种类型的 Struts1 验证

**1\. 使用 Bean 本身中的 ActionErrors 进行验证（显示摘要）**

**2\. 使用 xml 验证并在此处自行配置所有内容。（javascript 警报）**

对于您的情况，您使用了正确的第二种类型，但要单独获取摘要，请检查此链接，如果您在链接或其示例中遇到问题，请联系我。

[这是示例](http://www.rameshsengani.in/vaannila/struts/struts-example/struts-highlighting-error-fields-example-1.html)

# android - android google play 返回测试响应而不检查测试帐户

> ID：13086761
> 
> 赞同：1
> 
> 时间：2012-10-26T12:15:40.380
> 
> 标签：android, android-lvl

我目前正在测试响应，当您将草稿 apk 上传到市场时，它会从 google play 返回，我遇到了以下情况：

我上传了一个尚未发布的应用程序，当我想测试从许可服务器返回的测试响应时，我总是在下拉列表中收到指定的响应，这与我当前登录的 google play 帐户无关。我的意思是，如果我为测试帐户指定一个 gmail 帐户，即使我在设备上使用另一个 gmail 帐户，我也会收到测试响应。如果我在设备上使用的 gmail 帐户未在 google play 帐户的测试帐户中指定，我认为我应该收到 NOT LICENSED。我每次都在清除应用程序缓存。

现在我有点困惑，如果我发布应用程序，我会在许可证验证过程中遇到一些问题。这将是我第一个发布的应用程序，这就是我寻求帮助的原因。我在 android 开发人员指南中阅读了很多讨论和这些，但我认为我遗漏了一些东西。

版本代码与上传的应用程序相同；应用程序已签名，一切都按照 android 开发人员指南的规范完成。

如果有人可以对此提供帮助或建议完整的处理步骤来测试和发布应用程序到 Google Play，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:44:00.573

您需要创建测试帐户以正确测试许可，所有其他用户将获得许可用户的状态，因为应用程序尚未发布。

看到这个，可能对你有帮助

> 注意：如果付费应用程序已上传到 Google Play 但仅保存为草稿应用程序（该应用程序未发布），则许可服务器将所有用户视为该应用程序的**许可用户**（因为甚至无法购买该应用程序） . 此例外是您执行许可实施测试所必需的。

链接在这里

[http://developer.android.com/guide/google/play/licensing/overview.html](http://developer.android.com/guide/google/play/licensing/overview.html)

# asp.net - 缺少 asp.net 表单身份验证 cookie

> ID：13086765
> 
> 赞同：1
> 
> 时间：2012-10-26T12:15:52.343
> 
> 标签：asp.net, forms-authentication

我们有一个奇怪的情况。我们的 web.config 中有以下内容：

```
<authentication mode="Forms">
     <forms name="ASPDNSFGUID" loginUrl="SignIn.aspx" timeout="525600" /></authentication> 
```

这是一个电子商务应用程序，cookie 用于帮助我们确保购物篮的内容在他们登录后被保留，但这是行不通的。我们之前已经使用了几十次，没有问题。

该站点托管在位于 coyote 点负载平衡器后面的两个前端 Web 服务器上。我们注意到，当通过 HTTPS 查看站点时，cookie 就在那里，身份验证类型是表单。但是，当我们浏览非安全时，cookie 丢失并且身份验证类型未设置。我们知道这一点，因为我们创建了一个页面来为我们打印出所有标题。

有人对可能的原因有任何想法吗？我们想知道负载均衡器是否正在剥离 cookie，但我们没有证据表明这一点，只是直觉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:30:55.487

cookie 是否设置在 https 上，如果是，https 和 http 是否在同一个域上，但仅在协议上有所不同？即[https://www.somesite.com](https://www.somesite.com)和[http://www.somesite.com](http://www.somesite.com)

`<forms>`因为，如果他们有不同的子域，除非您在 web.config 的元素中指定 domain="somesite.com"，否则您将遇到问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:21:41.410

> 我们注意到，当通过 HTTPS 查看站点时，cookie 就在那里，身份验证类型是表单。但是，当我们浏览非安全时，cookie 丢失并且身份验证类型未设置。

当您`requireSSL="true"`在`<forms >`标签上设置 时会发生这种情况。

您如何尝试`domain="yourdomain.com"`在`<forms >`标签中声明 ，而不使用 subdomain `www.`，因为这会影响 cookie。

所以先试试这个

```
<forms name="ASPDNSFGUID" domain="yourdomain.com" loginUrl="SignIn.aspx" 
          timeout="525600" /> 
```

然后尝试查看您是否以编程方式设置了requireSSL。

# wireshark - 如何使用 tcpdump 过滤 MAC 地址？

> ID：13086766
> 
> 赞同：17
> 
> 时间：2012-10-26T12:15:55.033
> 
> 标签：wireshark, ethernet, pcap, tcpdump, packet-capture

我在 DD-WRT 路由器上运行 tcpdump，以便从手机捕获上行链路数据。我只想听一些mac地址。为此，我尝试使用类似于 Wireshark 的语法运行该命令：

`tcpdump -i prism0 ether src[0:3] 5c:95:ae -s0 -w | nc 192.168.1.147 31337`

这样我就可以收听所有具有初始 MAC 地址的设备`5c:95:ae`。

问题是语法错误，我想知道你们中是否有人知道正确的语法来获得我想要的东西。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-26T13:44:53.773

`man pcap-filter`我找到了这个解决方案：

```
tcpdump "ether[6:2] == 0x5c95 and ether[8:1] == 0xae" 
```

# javascript - 在 XUL 页面内为 iframe 调用方法 ChromeWindow.postMessage 的权限被拒绝

> ID：13086774
> 
> 赞同：0
> 
> 时间：2012-10-26T12:16:25.923
> 
> 标签：javascript, firefox, firefox-addon, cross-domain, xul

我有一个扩展名，里面有一个 XUL 文件（我们称之为 A）。XUL 文件包含一个`<iframe>`，其中加载了一些网页（我们称之为 B）。B 是从不同的域加载的。
A 是 B 的父母。我想使用 B 向 A 发送消息`window.parent.postMessage()`。我收到以下异常：

> ... 拒绝 B 调用方法 ChromeWindow.postMessage 的权限

如何修复该错误？如果没有办法做到这一点，我该如何将消息从 B 传递给 A？

我在 Windows 7 下使用 Firefox 16.0.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T13:19:11.950

我有一个非常相似的问题，只是我有一个无法将“postMessage”发送到我的 xul-background-task 的 html-popup（本地）。我想我让它工作了，奇怪的是通过启动我自己的 MessageEvent （与 postMessage 所做的一样）但有一个（我相信过时的）后备......简而言之：我从 MDN 和其他网站一起酿造了一些东西；）

我在内容中的脚本：

```
var Communicator = 
{
    postMessage: function(data) 
    { 
        // We need some element to attach the event to, since "window" wont work
        // let's just use a fallback JSON-stringified textnode
        var request = document.createTextNode(JSON.stringify(data));
        // and as always attach it to the current contentwindow
        document.head.appendChild(request);
        // Now let's make a MessageEvent of our own, just like window.postMessage would do
        var event = document.createEvent("MessageEvent");
        event.initMessageEvent ("own_message", true, false, data, window.location, 0, window, null);
        // you might want to change "own_message" back to "message" or whatever you like
        //and there we go
        request.dispatchEvent(event);
    }
} 
```

而不是 window.postMessage(data) 现在使用 Communicator.postMessage(data) 就是这样！现在在我的覆盖中除了我们的好老

```
addEventListener('own_message', someMessageFunc, false, true);
//or maybe even "message" just like originally 
```

希望这也对您有用（没有在 iframe 上检查...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T09:27:57.847

你应该检查[`type`iframe B](https://developer.mozilla.org/en-US/docs/XUL/iframe#a-browser.type)

编辑：

显然，您必须将您的 chrome 标记为[contentaccessible](https://developer.mozilla.org/en-US/docs/Chrome_Registration#contentaccessible)，并考虑到安全性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T07:56:19.180

只是张贴以防有人遇到同样的问题。[使用此处](https://developer.mozilla.org/en-US/docs/Code_snippets/Interaction_between_privileged_and_non-privileged_pages)
描述的事件成功地将消息从 B 内部发送到A。

但这不是答案，因为`window.parent.postMessage()`仍然无法按预期工作。

# c# - Caliburn.Micro 和 DataGrid：检测单个单元格变化的可靠方法？

> ID：13086777
> 
> 赞同：0
> 
> 时间：2012-10-26T12:16:34.703
> 
> 标签：c#, wpf, mvvm, wpfdatagrid, caliburn.micro

我有一个基于 MVVM 的 WPF 应用程序，它依赖于*Caliburn.Micro*。

在一个视图中，我正在显示 a`DataGrid`和 a `Button`。显示`DataGrid`项目集合，其中项目类派生自`PropertyChangedBase`。
该按钮应根据可编辑`DataGrid`单元格中的内容启用或禁用。*使用Caliburn.Micro*实现这一目标的最可靠方法是什么？

从示意图上看，这就是我的代码现在的样子：

```
public class ItemViewModel : PropertyChangedBase { }

...

public class ItemsViewModel : PropertyChangedBase
{
    private IObservableCollection<ItemViewModel> _items;

    // This is the DataGrid in ItemsView
    public IObservableCollection<ItemViewModel> Items
    {
        get { return _items; }
        set
        {
            _items = value;
            NotifyOfPropertyChange(() => Items);
        }
    }

    // This is the button in ItemsView
    public void DoWork() { }

    // This is the button enable "switch" in ItemsView
    public bool CanDoWork
    {
        get { return Items.All(item => item.NotifiableProperty == some_state); }
    }
} 
```

就代码而言，*没有*通知`ItemsViewModel.CanDoWork`何时`NotifiableProperty`更改，例如当用户编辑`ItemsView`´s中的一个单元格时`DataGrid`。因此，`DoWork`按钮启用状态将永远不会改变。

`Items`一种可能的解决方法是为集合中的每个项目添加一个（匿名）事件处理程序：

```
foreach (var item in Items)
    item.PropertyChanged += 
        (sender, args) => NotifyOfPropertyChange(() => CanDoWork); 
```

但是我还需要跟踪何时（如果）从`Items`集合中添加或删除项目，或者`Items`集合是否完全重新初始化。

有没有更优雅和可靠的解决方案来解决这个问题？我确定有，但到目前为止我还没有找到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:37:51.140

我认为这是 INPC 运作良好的一个案例；为了简化注册/注销添加和删除，只需将 CollectionChanged 处理程序添加到您的 Items 集合：

```
Items.CollectionChanged += OnItemsCollectionChanged;

private void OnItemsCollectionChanged(object sender, NotifyCollectionChangedEventArgs e) {
    if (e.NewItems != null && e.NewItems.Count != 0) {
        foreach (ItemViewModel  vm in e.NewItems)
            vm.PropertyChanged += OnDetailVmChanged;
    }
    if (e.OldItems != null && e.OldItems.Count != 0) {
        foreach (ItemViewModel  vm in e.OldItems) {
            vm.PropertyChanged -= OnDetailVmChanged;
        }
    }
} 
```

Josh Smith[在这里](http://mvvmfoundation.codeplex.com/)写了一个 PropertyObserver 类，我发现它比猎枪 INPC 跟踪更优雅，但在像你这样的主细节场景中，你仍然需要跟踪添加和删除。

**由 Anders Gustafsson 编辑**
请注意，要使上述代码在一般情况下工作，需要`Items`在附加事件处理程序之前使用默认构造函数进行初始化。为了确保`OnDetailVmChanged`正确添加和删除事件处理程序，`Items`需要将属性设置器扩展为如下内容：

```
public IObservableCollection<ItemViewModel> Items
{
    get { return _items; }
    set
    {
        // If required, initialize empty _items collection and attach
        // event handler
        if (_items == null) {
            _items = new BindableCollection<ItemViewModel>();
            _items.CollectionChanged += OnItemsCollectionChanged;
        }
        // Clear old contents in _items
        _items.Clear();
        // Add value item:s one by one to _items
        if (value != null) foreach (var item in value) _items.Add(item);

        NotifyOfPropertyChange(() => Items);
    }
} 
```

（当然，有了上面的`Items`设置器，最上面的`Items.CollectionChanged`事件处理程序附件不应该包含在代码中。）

理想情况下，我会使用`if (value != null) _items.AddRange(value);`，但是当该`AddRange`方法触发`OnItemsCollectionChanged`事件处理程序时，`e.NewItems`似乎是空的（或`null`）。调用该方法时，我没有明确验证它`e.OldItems`是非空的；`Clear()`否则`Clear()`还需要逐一删除 item:s in 来替换`_items`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-27T11:10:04.863

每当属性更改时，按钮 cummand 命令会触发 RaiseCanExecuteChanged 吗？

例如 ：

```
public DelegateCommand<object> MyDeleteCommand { get; set; }

string _mySelectedItem;
    public string MySelectedItem
    {
        get { return _mySelectedItem; }
        set
        {
            _mySelectedItem = value;
            OnPropertyChanged("MySelectedItem");
            MyDeleteCommand.RaiseCanExecuteChanged();
        }
    } 
```

# php - 无法从由 PHP 脚本生成的 JSON 数据创建的 JavaScript 对象获取属性

> ID：13086779
> 
> 赞同：1
> 
> 时间：2012-10-26T12:16:38.827
> 
> 标签：php, jquery, ajax, json, codeigniter

我有一个 PHP 脚本，它对 DB 进行查询并将结果作为 JSON 数据返回。该文件包含一些 Codeigniter 特定的功能。

该函数接收 id 并将表中的一些数据返回给 JS 代码。

```
public function get_l($id){
//$id is not empty variable
$this->db->where('id',$id);
$q=$this->db->get('news');

$res = $q->result_array();

$this->output->set_header("HTTP/1.0 200 OK");
$this->output->set_header("HTTP/1.1 200 OK");
$this->output->set_header("Cache-Control: no-store, no-cache, must-revalidate");
$this->output->set_header("Cache-Control: post-check=0, pre-check=0");
$this->output->set_header("Content-Type: application/json; charset=utf-8");
$this->output->set_header("Pragma: no-cache");

$out = json_encode($res);
$this->output->set_output($out);
} 
```

然后我需要使用下一个 JS 代码处理该 JSON：

```
function getContent(id){
  $.post('/admin_ajax/news/get',
  {
    id: id

  },
  function(result)
  {
    alert(result+"\n"+result.length);//this will output [object Object] 1
    for (var key in result)
    {
      alert(key+':'+result[key]); //and this 0:[object Object]
    }
    alert(result.title); //here we are getting undefined
  },
  'json'
); 
```

我没有在控制台中收到错误或警告。在萤火虫中，我看到了从服务器返回的内容。

HTTP 标头：

```
Server  nginx/1.1.19
Date    Fri, 26 Oct 2012 11:59:12 GMT
Content-Type    application/json; charset=utf-8
Content-Length  85
Connection  keep-alive
X-Powered-By    PHP/5.3.10-1ubuntu3.4
Cache-Control   post-check=0, pre-check=0
Pragma  no-cache 
```

和回应：

```
[{"id":"5","title":"test","alias":"test","content":"tes","date":"123","type":"test"}] 
```

JSON：

```
alias  "test"

content "tes"

date  "123"

id "5"

title "test"

type "test" 
```

[我在这里](https://stackoverflow.com/questions/10800811/try-to-return-json-data-generated-with-sql-statement-from-php-script-to-js-webpa)发现了一个类似的问题，但没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:21:45.123

您的 JSON 对象位于数组 [...] 中，因此长度为 1。

```
function(result) {
    var jsonObj = result[0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:20:48.847

结果是一个包含一个元素的数组：

```
[
    {
        "id": "5",
        "title": "test",
        "alias": "test",
        "content": "tes",
        "date": "123",
        "type": "test"
    }
] 
```

索引 0 处的元素包含您需要的信息。你需要做：

```
alert(result[0].id);
alert(result[0].title);
alert(result[0].alias); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T12:22:27.887

看起来您得到的响应实际上是一个包含一个元素（json 对象）的数组。

尝试使用`result[0]`，如下所示：

```
....
function(result)
  {
    alert(result[0]+"\n"+result[0].length);//this will output [object Object] 1
    for (var key in result[0])
    {
      alert(key+':'+result[0][key]); //and this 0:[object Object]
    }
    alert(result[0].title); //here we are getting undefined
  }
.... 
```

# python - 解析 CSV 文件 (Python)

> ID：13086780
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:16:45.077
> 
> 标签：python, csv, python-2.x

我有一个格式如下的 CSV 文件：

```
"SHA-1","MD5","CRC32","FileName","FileSize","ProductCode","OpSystemCode" 
```

基本上我在 Python 2.x 中要做的是读取文件，如果在文件名列中，任何文件都存在列表中具有指定文件扩展名的文件，则 MD5 哈希列中的数据被解析为文本文档.

所以我的伪代码是这样的：

```
list = [.doc,.xls,.ppt]

with open(new.csv) as new_f:
    with open(x.csv) as old_f:
        x = f.readlines()
        if list in x:
            # *copy out the value from the MD5 value column to new.csv* 
```

我只是不知道如何提取 MD5 哈希。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:31:07.693

为 MD5 哈希创建一个列表，为文件名创建一个列表，如果该列表在文件名列表的项目中，则保存索引并将其用于您的 MD5 列表（因为您有一个表，所以索引必须是相同的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:43:56.167

确定的解决方案：-

```
import csv

results = []
filetypes = ['jpg','bmp','jpeg','mov','mp4','avi','wmv','wav','tif','gif','png']
reader = csv.reader(open('c:\users\me\Desktop\x.csv'))
for extension in filetypes:
    for line in reader:  # iterate over the lines in the csv
        if extension in line[3]:
            print line[1] + "\t" + line[3] 
```

# flex4 - 在 Flex Web 项目中检查 Internet 连接

> ID：13086781
> 
> 赞同：0
> 
> 时间：2012-10-26T12:16:50.693
> 
> 标签：flex4, connectivity

我正在开发一个 flex Web 应用程序，它向网站发送请求以获取 UTC 时间（基本上它是一个 NTP 服务器）。我需要确保用户第一次登录应用程序时连接到互联网，如果没有让他知道他没有连接。

我知道这在 AIR 项目中是可能的，但我需要在 flex 项目中完成，因为它将与另一个 flex web 项目集成。任何意见或建议都会有所帮助

# java - 使用 String.replaceAll 函数匹配正则表达式并从 Java 中的映射中获取替换值

> ID：13086783
> 
> 赞同：2
> 
> 时间：2012-10-26T12:16:56.373
> 
> 标签：java, regex, str-replace

我正在尝试解析一个表达式以找出一些保留的运算符/字符串并将它们替换为存储在哈希图中的相应数值，并显示具有数值而不是保留字符串的结果表达式。这就是我想要做的：

```
String expression = "SUM_ALL(4:5,5:6)>MAX(6:7)";
Map<String, Double> functionOperators = new HashMap<String,Double>();
functionOperators.put("SUM_ALL(4:5,5:6)", 4.0);
functionOperators.put("MAX(6:7)",5.0);

expression = expression.replaceAll("(SUM_ALL|MAX)\\s*\\(\\s*([\\d:,]+)\\s*\\)",
            Double.toString(functionOperators.get(String.format("%s(%s)","$1","$2"))));
System.out.println(expression); 
```

"$1" 和 "$2" 用于反向引用表达式中的组。

这是相同的输出：

```
Exception in thread "main" java.lang.NullPointerException 
```

而当我删除获取部分（从哈希图中）并使用反向引用组将其限制为仅更改字符串时，它工作得很好。

```
expression = expression.replaceAll("(SUM_ALL|MAX)\\s*\\(\\s*([\\d:,]+)\\s*\\)",
            String.format("%s|%s|","$1","$2")); 
```

输出：

```
SUM_ALL|4:5,5:6|>MAX|6:7| 
```

我怀疑在从哈希图中获取值时，“$1”和“$2”变量仍未通过反向引用解决，因此，它无法找到对应的键。

如果这是真的，那么你建议用什么方法来实现我需要预定义哈希图中的替换值的用例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:03:38.873

我不知道你有多少 dat 但似乎问题是 replaceAll 不能正常工作，因为我尝试过 replace 并且效果很好。

```
String expression = "SUM_ALL(4:5,5:6)>MAX(6:7)<SUM_ALL(4:5,5:6)";
String mat = "";
Map<String, Double> functionOperators = new HashMap<String,Double>();
functionOperators.put("SUM_ALL(4:5,5:6)", 4.0);
functionOperators.put("MAX(6:7)",5.0);
Matcher m = 
    Pattern.compile(
            "(?:(SUM_ALL|MAX|MIN)\\(((?:\\d+:\\d+,?){1,2})\\)[+-><\\*/]?)")
            .matcher(expression);
while (m.find()) {
    mat = String.format("%s(%s)", m.group(1), m.group(2));
    expression = expression.replace(mat, functionOperators.get(mat).toString());
}
System.out.println(expression); 
```

直接取自您之前的示例（昨天）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:45:36.463

您的第二个示例有效，因为 is 的返回值`String.format("%s(%s)","$1","$2")`是`"$1($2)"`该`replaceAll`方法的有效第二个参数。但是，当您传递`"$1($2)"`给`get`地图的方法时，它会返回`null`.

为了完成这项工作，我认为您需要将匹配、映射和替换操作分开。

*   获取正则表达式的所有匹配项的列表（请参阅[创建正则表达式匹配数组](https://stackoverflow.com/a/6020436/1288)）。
*   从地图中获取每个匹配的对应数值。
*   呼吁`replaceAll`每场比赛。

# c++ - Qt 信号中的 CancelEvent 等效项

> ID：13086787
> 
> 赞同：5
> 
> 时间：2012-10-26T12:17:09.940
> 
> 标签：c++, qt, event-handling, signals-slots

我通常习惯于 .net 框架，最近有机会使用 C++/Qt 进行项目。在这种情况下，我想实现以下功能：（为了简化事情，假设我有一个 ListView 和一个 Textbox/Textedit）

*   如果我选择 ListView 的一个项目-> 在 textedit 中显示相应的文本**（完成）**
*   如果我编辑文本并单击列表中的另一个项目-> 显示一个对话框，询问是否保存或取消更改**（完成）**。textedit 从列表中获取一个信号，告诉它所选项目已更改。
*   如果用户按下保存 -> 将其保存并刷新列表中的项目，则用户单击的新项目将在列表中被选中**（完成）**
*   如果用户按下取消 - >不要选择用户点击的其他项目**（这是我的问题所在）**

基本上我看到了两种解决方案（可能还有更多）：

*   从 textedit 向列表发送回信号，告诉列表恢复之前的选择。我个人不太喜欢这个解决方案，因为我必须将它们结合得更牢固（列表向 textedit 发送信号，现在也反过来）。此外，这种“强制”选择恢复可能会再次触发必须再次阻止的后续信号......
*   一个更好的解决方案（我认为）是在信号中有一些否决机制。我可以想象这个列表发送两个信号：
    *   让我们打电话给第一个`aboutToChangeSelection(proposedSelection, vetoObj)`
    *   动作完成后的另一个：`changedSelection(newSelection)`

第一个信号将被发送到 textedit，然后最终会使用它的否决权。在此之后，相同的信号将被发送到列表本身，根据否决执行操作，如果它实际上改变了选择，则发送第二个信号。

在 .NET 世界中存在这样一种机制，在 .NET 的帮助下[`CancelEventArgs`](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs%28v=vs.80%29.aspx)。我知道 .NET 事件和 Qt 信号具有完全不同的工作原理，但是有没有任何 Qt 等效于实现相同的效果？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:40:46.853

如果您使用的是 a`QListWidget`而不是 a `QListView`，那么您可以执行以下操作：

*   听信号：`QListWidget::itemPressed ( QListWidgetItem * item )`而不是说项目已更改的信号（即`currentItemChanged ( QListWidgetItem * current, QListWidgetItem * previous )`在我的示例中）
*   打开对话框的函数是一个连接到这个信号的槽。我认为不需要修改。
*   收听信号：`currentItemChanged ( QListWidgetItem * current, QListWidgetItem * previous )`仅用于记住当前和最后一项。
*   现在在您的情况下，当用户设置取消时，以编程方式更改回最后一项。

现在有一个问题。哪个信号会先收到？？文档中未指定，可以按任意顺序排列。如果用户在 item 上`A`，并单击 item `B`，您希望 lastitem 成为`A`当前项目，并且当前项目`B`在您正在处理的那一刻`itemPressed`。所以你`currentItemChanged`要先处理。幸运的是，您可以使用`Qt::DirectConnection`for`currentItemChanged`和 use `Qt::QueuedConnection`for`itemPressed`

选择：

您可以在列表小部件上使用[事件过滤器。](http://doc.qt.digia.com/qt/qobject.html#installEventFilter)此过滤器将是执行您在几个步骤中描述的处理的过滤器。如果用户单击接受，则将事件发送到列表视图。如果用户拒绝，您将阻止该事件。我不确定，但有可能事件没有在过滤器中处理，这将使这种替代方案不可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:22:03.050

对此不是 100% 确定，但您可以覆盖`QCoreApplication::notify( QObject * receiver, QEvent * event )`并尝试找到正确的事件并调用`ignore()`它。为了告诉何时忽略，您可以添加一个新的`QEvent`子类，将目标元素指针嵌入其中并使其充当您的否决事件 - 如果收到，那么您知道您将忽略该特定事件的某种特定类型的下一个事件目的。

# android - 有没有办法有条件地设置android活动属性？

> ID：13086791
> 
> 赞同：0
> 
> 时间：2012-10-26T12:17:19.830
> 
> 标签：android, attributes, android-activity, xamarin.android, monocross

在我的 Android 应用程序中，我有一个活动，我一直在使用 [Activity(NoHistory=true)] 来防止活动出现在活动堆栈上。

现在我想让它成为有条件的——有时它应该在活动堆栈上，以便用户可以按返回从后续屏幕返回它；有时不应该。有没有办法有条件地“装饰”一个活动，或者我必须编写一些代码来完成这个？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:21:39.617

您是否正在寻找可以像下面这样设置的意图标志？您可以使用它来启动活动并有条件地设置标志。

```
intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY); 
```

# qt - Qt开源库绘制带链接的路由器？

> ID：13086796
> 
> 赞同：0
> 
> 时间：2012-10-26T12:17:36.590
> 
> 标签：qt, open-source, widget, drawing, diagram

我想用qt画一个网络拓扑图。
为简化起见，我只需要绘制路由器、pc 和它们之间的链接，但我希望路由器能够**通过鼠标链接拖动**并将所有小部件保存到文件中并在可能的情况下重新打开。
该图将只是我的程序的一部分，我还计划配置路由器和计算机并完成其他功能。
有什么好的链接或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:31:34.153

我发现使用带有场景图的图形库更容易为您描述的任务提供解决方案。不幸的是，QT 和 GTK 缺乏浏览器（SVG、Canvas）或 Flash 平台提供的灵活性，但是将一些场景图集成到 QT 和 GTK 中并带有[Clutter 库](http://blogs.gnome.org/clutter/)很可能是一个可行的选择。

这是 QT 需要调查的内容：http: [//zchydem.enume.net/2010/11/01/playing-with-qt-scene-graph/](http://zchydem.enume.net/2010/11/01/playing-with-qt-scene-graph/)

# python - Python中的缩进错误

> ID：13086798
> 
> 赞同：3
> 
> 时间：2012-10-26T12:17:43.233
> 
> 标签：python, user-interface, button, indentation

我编写了以下程序，但不确定它有什么问题，它给出了：

```
File "Button_2.py", line 9
""" Initialise the Frame. """
                            ^
  IndentationError: expected an indented block 
```

这是我的代码的图像：

![在此处输入图像描述](../Images/7ee1960f9cba09cd75edfe14b35e5ee5.png)

这里发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T12:18:46.137

文档字符串中的缩进`__init__`关闭（它需要向右移动 1 个缩进级别）... 上的缩进`root.mainloop()`也关闭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T12:29:14.530

您在第 9 行的缩进是错误的，也就是文档字符串应该像这样向右缩进一级：

```
def __init__(self, master):
    """ Initialise the Frame. """
    Frame.__init__(self, master) 
```

这样做的原因是因为 Python 使用缩进告诉解释器代码块属于哪个类、函数或结构（如循环或 if..else 语句）。它相当于 Java 中的花括号，用于指定类、方法或程序的其他流控制部分。你可以在这里阅读更多：[http ://www.secnetix.de/olli/Python/block_indentation.hawk](http://www.secnetix.de/olli/Python/block_indentation.hawk)

PS root.mainLoop() 应该依次向左缩进。这是因为它是主程序的一部分，其缩进级别为 0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T12:20:22.857

您应该按如下方式缩进文档字符串：

```
def __init__(self, master):
    """ Initialise the Frame. """
    Frame.__init__(self, master) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T12:21:36.827

第 5 行应该再缩进 1 级，与第 6 行对齐。

# objective-c - drawRect：缩放后大矩形崩溃

> ID：13086810
> 
> 赞同：0
> 
> 时间：2012-10-26T12:18:48.023
> 
> 标签：objective-c, quartz-core

我的 UIView 结构：我有一个`"master"`UIView （实际上`UIScrollView`，但它只是每个分页滚动的目的）。作为对此的子视图，`"master"`我有我的`"pageView"`（子类`UIScrollView`）。这`UIScrollView`可以有任何内容（例如 UIImageView）。`"master"`有另一个子视图：`PaintView`（UIView 的子类）。使用这个视图，我跟踪手指的运动并绘制它。

结构如下所示：

```
[master.view addSubview: pageView];
[master.view addSubview: paintView]; 
```

我知道当用户放大（pageView 对此负责）和委托/方法调用时，我`paintView`在缩放操作期间根据缩放更改更改框架。缩放后`(scrollViewDidEndZooming:withView:atScale)`我调用paintView的自定义重绘方法。

重绘方法和drawRect：

```
-(void)redrawForScale:(float)scale {
    for (UIBezierPath *path in _pathArray) {
        //TransformMakeScale...
    }
    [self setNeedsDisplay];
} 

-(void)drawRect:(CGRect)rect {
    for (UIBezierPath *path in _pathArray) {
        [path strokeWithBlendMode:kCGBlendModeNormal alpha:1.0];
    } 
} 
```

**问题**：当我放大时，我收到内存警告并且应用程序崩溃。

在分配分析器中，我可以看到应用程序拥有大量内存，但我不明白为什么。当我不调用`'setNeedDisplay'`我的`'redrawForScale'`方法时，应用程序不会崩溃。

当我在 drawRect 中记录矩形时，我看到如下值：{{0, 0.299316}, {4688, 6630}}。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T13:48:29.523

问题是（重新）绘制如此巨大的 CGRect （如果这是错误的，请纠正我）。我的解决方案是避免调用自定义 drawRect 方法。在一些 stackoverflow 答案中（我认为在 Appls 文档中的某处）提到自定义`drawRect:`会降低性能（因为 iOS 无法对自定义 drawRect 方法做一些魔术）。

我的解决方案：使用`CAShapeLayer`. 对于每个 UIBezierPath，我都会创建一个 CAShapeLayer 实例，将 UIBezierPath 添加到图层的`path`属性中，并将图层作为子图层添加到我的视图中。

```
CAShapeLayer *shapeLayer = [[CAShapeLayer alloc] initWithLayer:self.layer];
shapeLayer.lineWidth = 10.0;
shapeLayer.strokeColor = [UIColor blackColor].CGColor;
shapeLayer.fillColor = [UIColor clearColor].CGColor;
shapeLayer.path = myBezierPath.CGPath;
[self.layer addSublayer:shapeLayer]; 
```

有了这个解决方案，我不需要实现 drawRect。所以应用程序不会崩溃，即使最大缩放比例很大。

更改 UIBezierPath（平移、缩放、更改颜色）后，我需要再次将更改后的 bezierPath 设置为 shapeLayer（再次设置 shapeLayer 的`path`属性）。

# android - 已连接到 spotify AP，但 GetConnectionState()，用户尚未登录

> ID：13086813
> 
> 赞同：2
> 
> 时间：2012-10-26T12:18:55.307
> 
> 标签：android, android-ndk, spotify

我正在使用官方 libspotify.so 在 android 中进行 spotify 流式传输。现在我可以连接到 Spotify AP，但状态仍未登录。

Initialise() 成功，callback_notify_main_thread 被调用

```
10-26 14:00:05.925: PID:1419, TID:1419 D/MBS: --- Session:Initialise
10-26 14:00:05.935: PID:1419, TID:1419 D/MBS: --- Session:callback_notify_main_thread
10-26 14:00:05.935: PID:1419, TID:1419 D/MBS: --- Session:Initialise:end:0 
```

login() 调用“成功”，callback_log_message 显示无法离线登录，日志状态为 false

```
10-26 14:00:05.935: PID:1419, TID:1419 D/MBS: --- Session:login
10-26 14:00:05.935: PID:1419, TID:1419 D/MBS: --- Session:OnLogMessage, data: 11:00:05.943 I [offline_authorizer.cpp:297] Unable to login offline: no such user
10-26 14:00:05.945: PID:1419, TID:1419 D/MBS: --- Session:login:end:0
10-26 14:00:05.945: PID:1419, TID:1419 D/MBS: --- Session:IsLoggedIn:false 
```

更多 callback_log_messages 来自不同的线程

```
10-26 14:00:05.945: PID:1419, **TID:1427** D/MBS: --- Session:OnLogMessage, data: 11:00:05.951 I [ap:1752] Connecting to AP ap.spotify.com:4070
10-26 14:00:05.965: PID:1419, **TID:1427** D/MBS: --- Session:OnLogMessage, data: 11:00:05.969 I [network.cpp:438] Connecting to 78.31.8.42:4070
10-26 14:00:06.015: PID:1419, **TID:1427** D/MBS: --- Session:OnLogMessage, data: 11:00:06.014 I [ap:1226] Connected to AP: 78.31.8.42:4070 
```

在连接到发现 ap 后，日志记录状态仍然为 false，没有调用 callback_logged_in

```
10-26 14:33:38.095: PID:1419, TID:1419 D/MBS: --- Session:IsLoggedIn:false 
```

任何想法，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T11:48:59.067

在 notify_main_thread 之后需要在主线程中调用 sp_session_process_events()。来自[https://developer.spotify.com/technologies/libspotify/faq/](https://developer.spotify.com/technologies/libspotify/faq/)

> notify_main_thread 回调是什么？为什么需要它？当主线程需要唤醒以处理事件并将回调传递给您的应用程序时，将从任何线程调用此回调。

然后将调用登录回调。并检查 GetConnectionState()，它是 4。 SP_CONNECTION_STATE_OFFLINE = 4 ///< 在离线模式下登录

# php - 从 ubuntu 虚拟机发送电子邮件并使用 catchmail：无法执行：smtp://localhost:1025

> ID：13086817
> 
> 赞同：1
> 
> 时间：2012-10-26T12:19:07.997
> 
> 标签：php, email, phpmailer

我在我的虚拟机上使用 ubuntu。我想使用 catchmail 发送电子邮件，如下所述：http: [//berk.es/2011/05/29/mailcatcher-for-drupal-and-other-php-applications-the-simple-version/](http://berk.es/2011/05/29/mailcatcher-for-drupal-and-other-php-applications-the-simple-version/)

我正在尝试发送这样的电子邮件：

```
//Mailer class:
class Mailer extends PHPMailer
{
public $UTF8Encode = false;
public function __construct($param = null)
{   
    parent::__construct($param);
    $this->Mailer = 'sendmail';
    $this->Sendmail = 'smtp://localhost:1025';
    $this->From   = 'xxxx@xxxx.com';
    $this->FromName = 'Support';
    $this->WordWrap = 50;
    $this->CharSet = 'UTF-8';
}
}

....etc.... 
```

和：

```
//Sending emails

$mail = new Mailer();
$mail->Body = "xxxx";
$mail->Subject = "xxx";
$mail->From = 'xxxx@xxxx.org';
$mail->FromName = 'Support';
$mail->WordWrap = 50;
$mail->AddAddress(xxxx@xxxx.com); 
```

我得到了错误：

```
Could not execute: smtp://localhost:1025 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:00:47.147

```
$this->Mailer = 'sendmail';
$this->Sendmail = 'smtp://localhost:1025'; 
```

问题在于您告诉 PHPMailer 使用名为`sendmail`而不是使用 smtp 的命令行程序。PHPMailer 尝试执行以下操作：

```
exec("smtp://localhost:1025 --args-and-stuff"); 
```

正如你所知道的那样，这是行不通的。

要告诉 PHPMailer 使用 smtp，您需要执行以下操作：

```
$this->Mailer = 'smtp';
$this->Host = 'localhost';
$this->Port = 1025; 
```

如果您的 SMTP 服务器需要身份验证，您可以执行以下操作：

```
$mail->SMTPAuth = true;
$mail->Username = "yourname@yourdomain";
$mail->Password = "yourpassword"; 
```

# repository - Git 和 Mercurial 的区别

> ID：13086818
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:19:14.840
> 
> 标签：repository

> **可能重复：**
> [Mercurial 和 Git 有什么区别？](https://stackoverflow.com/questions/35837/what-is-the-difference-between-mercurial-and-git)

我是 DVC 系统的新手，并且已在[bitbucket.org](https://bitbucket.org/)上注册。

我需要同时使用 Git 和 Mercurial 系统还是可以使用其中之一，有什么区别？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:22:37.197

它们是独立的 DVCS。我会选择 Git 而不是 Mecurial，因为它更受欢迎。

# ios - 给定文本的多少部分将以给定大小显示

> ID：13086819
> 
> 赞同：0
> 
> 时间：2012-10-26T12:19:15.383
> 
> 标签：ios, nsstring, drawing, uilabel, cgrect

获取视图中显示的 NSString 部分。

或者

获取可以在给定 CGRect 中显示的 NSString。

它返回显示在视图上的字符串（UIlabel、UITextFiled 等）。当字符串变大并且视图不够长而无法显示整个字符串时，这很有用。

所以我已经编写了代码并将其添加到这里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:19:48.550

```
//If you want the string displayed in any given rect, use the following code..
@implementation NSString (displayedString)

//font- font of the text to be displayed
//size - Size in which we are displaying the text

-(NSString *) displayedString:(CGSize)size font:(UIFont *)font
{
NSString *written = @"";

int i = 0;
int currentWidth = 0;
NSString *nextSetOfString = @"";

while (1)
{
    NSRange range;
    range.location = i;
    range.length = 1;

    NSString *nextChar = [self substringWithRange:range];
    nextSetOfString = [nextSetOfString stringByAppendingString:nextChar];

    CGSize requiredSize = [nextSetOfString sizeWithFont:font constrainedToSize:CGSizeMake(NSIntegerMax, NSIntegerMax)];
    currentWidth = requiredSize.width;

    if(size.width >= currentWidth && size.height >= requiredSize.height)
    {
        written = [written stringByAppendingString:nextChar];
    }
    else
    {
        break;
    }
    i++;
}

    return written;
}

@end 
```

# spring - 将 Spring EntityManager 放入异步 Servlet 3.0 的线程中？

> ID：13086821
> 
> 赞同：0
> 
> 时间：2012-10-26T12:19:18.223
> 
> 标签：spring, hibernate, jpa, spring-security, jpa-2.0

我们正在尝试在我们的 Spring 应用程序中启用 Servlet 的 3.0“异步支持”：

*   在 web.xml **(async-supported)true(/async-supported)**中为所有 servlet 和过滤器添加。

*   将请求处理代码重写为

**

```
request.getAsyncContext().start(new Runnable() {
  @Override
  public void run() {
    handleRequest(servlet, request, response);
  }
}); 
```

**

这会导致两个问题：

1.  运行异步代码时，Spring Security 身份验证丢失。

2.  也没有 EntityManager/session/...。

当然，这两个问题都是由于处理程序代码没有在与创建 Runnable 的线程相同的线程中执行。理想情况下，工作线程应该从调用线程“继承” Spring 上下文。

我可以通过在构建时保存身份验证并在执行时设置它来解决 Spring Security 问题。

```
private final Authentication authentication = SecurityContextHolder.getContext().getAuthentication();

try {
  SecurityContextHolder.clearContext();
  SecurityContextHolder.getContext().setAuthentication(authentication);

  ..run code here..

} finally {
  SecurityContextHolder.clearContext();
} 
```

但是，对于第二个问题，我不知道如何将会话“转移”到执行线程。对于 servlet 2.x，我们使用***OpenEntityManagerInViewFilter***将会话粘贴到线程。

```
<filter>
  <filter-name>openEntityManagerInViewFilter</filter-name>
  <filter-class>org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter</filter-class>
  <async-supported>true</async-supported>
  <init-param>
    <param-name>entityManagerFactoryBeanName</param-name>
    <param-value>entityManagerFactory</param-value>
  </init-param>
</filter> 
```

但是现在这当然不再有意义了，因为它所附着的线程与执行请求的线程不同。

我尝试过各种版本的 Spring 3.1 和 3.2。但是没有效果。

有谁知道如何解决这个问题？最好有黑客攻击。:-)

我的**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         version="3.0">

  <servlet>
    <servlet-name>Foo</servlet-name>
    <servlet-class>com.foo.Main</servlet-class>
    <async-supported>true</async-supported>
  </servlet>

  <servlet-mapping>
    <servlet-name>Foo</servlet-name>
    <url-pattern>/restricted/*</url-pattern>
  </servlet-mapping>

  <filter>
    <filter-name>openEntityManagerInViewFilter</filter-name>
    <filter-class>org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter</filter-class>
    <async-supported>true</async-supported>
    <init-param>
      <param-name>entityManagerFactoryBeanName</param-name>
      <param-value>entityManagerFactory</param-value>
    </init-param>
  </filter>

  <filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    <async-supported>true</async-supported>
  </filter>

  <filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>

  <listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>

  <listener>
    <listener-class>org.bar.ServletInit</listener-class>
  </listener>

  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
  </context-param>

  <context-param>
    <param-name>contextInitializerClasses</param-name>
    <param-value>com.foo.SpringCtxInitializer</param-value>
  </context-param>

  <filter-mapping>
    <filter-name>openEntityManagerInViewFilter</filter-name>
    <url-pattern>/restricted/*</url-pattern>
  </filter-mapping>

</web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:05:42.947

您需要为该异步线程打开一个新的会话/实体管理器（会话不能在线程之间共享）。为此，您可能想要使用`OpenSessionInViewInterceptor`（或者我猜对于 JPA，它被称为`OpenEntityManagerInViewInterceptor`），但是您需要手动调用它的方法或为此目的编写自己的方面并使用代理。

# windows-phone-7 - MvvmCross vNext：在 PCL 中使用 System.IO.Compression

> ID：13086823
> 
> 赞同：2
> 
> 时间：2012-10-26T12:19:28.340
> 
> 标签：windows-phone-7, xamarin.ios, xamarin.android, portable-class-library, mvvmcross

我有一些模型代码需要 System.IO.Compression 命名空间中的一些方法。但是，当使用针对 VSMonoTouch 和 MonoAndroid 的 PCL 时，它不存在。我看到 MvvmCross 解决方案中的某些东西是 TypeForwarded，但在创建类似项目时，我似乎无法找到如何使用它。

我创建了一个 MonoAndroid 库项目并添加了一个 Forward.cs 类，其内容如下：

```
using System.Runtime.CompilerServices;

[assembly: TypeForwardedTo(typeof(System.IO.Compression.CompressionMode))]
[assembly: TypeForwardedTo(typeof(System.IO.Compression.DeflateStream))]
[assembly: TypeForwardedTo(typeof(System.IO.Compression.GZipStream))] 
```

我已将项目的命名空间设置为`System.IO.Compression`. 尝试将其添加为对我的模型代码的 PCL 项目的引用，其中包含 ViewModel、服务，当然不是它说它只能引用其他 PCL 项目和程序集。

我特别需要`GZipStream`，但我似乎不知道如何将它添加到我的项目中，所以问题是我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:56:51.173

### PCL 延伸路线

如何通过扩展 PCL 来做到这一点......我不完全确定！其中一位 PCL 人员可能会提供帮助。

* * *

### 插件路由

我解决这个问题的方法是在接口中定义我想要的功能并将代码包装在插件中。

例如，`Cheesebaron.Plugins.Gzip.dll`您可以创建如下界面：

```
public interface IGZipStreamFactory
{
     Stream Decompress(Stream binaryStream);
} 
```

然后这个接口会被插入到一个只包含这个接口和 pluginmanager 类的 PCL 库中。

然后，您的 PCL 核心项目可以引用此 PCL 插件库，并且您的 ViewModel 可以使用如下代码：

```
 Cheesebaron.Plugins.GZip.PluginLoader.Instance.EnsureLoaded(); 
```

其次是

```
 var service = this.GetService<IGZipStreamFactory>();
 var unzipped = service.Decompress(inputStream); 
```

对于每个实际的平台实现，您需要准备一个特定于平台的库，实现 GZip 工厂接口，并提供一个简单的`Plugin`类实现。

例如，对于 Droid，您可以创建`Cheesebaron.Plugins.Gzip.Droid.dll`：

```
 public class MyDroidGZipStreamFactory : IGZipStreamFactory
 {
      // the implementation
 } 
```

然后你会添加：

```
public class Plugin
    : IMvxPlugin
    , IMvxServiceProducer
{
    public void Load()
    {
        this.RegisterServiceInstance<IGZipStreamFactory>(new MyDroidGZipStreamFactory));
    }
} 
```

最后... 将它们组合在一起，对于 MonoDroid，您可以在您的 UI 项目中同时引用 PCL 和特定于平台的实现——它应该都可以工作！

**请注意**，这里在幕后发生了一些基于约定的魔术 - 框架`Cheesebaron.Plugins.Gzip.Droid.dll`根据 PCL 插件命名空间加载程序集`Cheesebaron.Plugins.Gzip`

（对于 WP7 和其他平台，还有一个额外的步骤 - 有一种设置方法来覆盖注册插件的方法）

* * *

**请注意**，您可以在单个插件中注册任意数量的服务，也可以执行额外的常见初始化/设置代码。这有助于减少一些项目维护开销：如果愿意，您可以将 CheeseBaron IoC 对象放在一个`CheeseBaron.Plugins.Utils`项目中，然后在所有应用程序中共享这个插件。

该`DownloadCache`插件提供了一个小示例 - 它注册了所有`IMvxHttpFileDownloader`,`IMvxImageCache`和`IMvxLocalFileImageLoader`.

这样做的缺点是：最终链接的 exe 大小 - 您可能会向每个应用程序添加不需要的代码。

* * *

显然，这种插件方法有一点学习曲线......它确实增加了一些项目维护 - 但好消息是这些插件可以在项目之间反复使用 - 并且可以在组织之间共享（在至少，这是我的希望！）

更多关于创建插件的信息：

*   [MvvmCross vnext：将插件与 monodroid 合并](https://stackoverflow.com/questions/12931618/mvvmcross-vnext-merge-plugins-with-monodroid)
*   [http://slodge.blogspot.co.uk/2012/06/mvvm-mvvmcross-monodroid-monotouch-wp7.html](http://slodge.blogspot.co.uk/2012/06/mvvm-mvvmcross-monodroid-monotouch-wp7.html)

有关插件示例（并非所有平台都可用），请参阅[https://github.com/slodge/MvvmCross/tree/vnext/Cirrious/Plugins](https://github.com/slodge/MvvmCross/tree/vnext/Cirrious/Plugins)

* * *

### 其他路线

如果您不想使用插件 - 例如，如果您很匆忙，或者您正在为不想重用的模块编写代码，那么还有其他选择：

*   您可以在共享核心 PCL 库中定义类似 IGZipStreamFactory 的接口。然后，您可以在每个 UI 项目中提供此接口的特定于平台的实现，然后可以在 ViewModel/Model/Service 层中使用普通的 IoC/DI，以便在运行时找到正确的实现。

或者...

*   您可以只转储共享的 PCL 核心库并创建单独的特定于平台的 DLL，然后手动链接到特定于平台的文件中（我尽量不要这样做，但其他人喜欢这样做）

# vba - Excel 中的 VBA：在 2007 年执行时出现“找不到项目或库”错误

> ID：13086829
> 
> 赞同：0
> 
> 时间：2012-10-26T12:20:05.587
> 
> 标签：vba, excel, declare

在 Excel 2003 中使用 VB for Excel，我在执行带有一些未声明变量的代码时没有问题：

```
numberOfBooks = 0 
```

但是，如果我尝试在 Excel 2007 中执行相同的代码，我会收到“找不到项目或库”错误消息。

我查看了工具 > 选项，但没有选中“需要变量声明”。在 Excel 2003 中，我没有使用 Option Explicit

我究竟做错了什么？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:33:41.510

我已经多次看到这个建议（检查参考资料），这是有道理的！

但是，当出现“找不到项目或库”故障时，您处于运行模式，我无法摆脱它？我错过了什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T20:37:18.280

我肯定会支持 Daniel Cook 的建议，即检查您的参考列表；可能就是这样。但是，在过去的几个月中，我遇到了一些情况，即使引用没有任何问题，Excel 2007 也会出现该错误。部分原因似乎与 8 月 12 日发布的安全更新有关 ( [http://technet.microsoft.com/en-us/security/bulletin/ms12-aug](http://technet.microsoft.com/en-us/security/bulletin/ms12-aug) )。它在 mscomctl.ocx 中造成了一些损坏。问题和（一个）解决方案（基本上是重新注册 .ocx）在此 IBM 链接中讨论，该链接与名为 TM1 的 OLAP 产品的 Excel 插件相关：[http ://www-01.ibm.com/支持/docview.wss?uid=swg21608271](http://www-01.ibm.com/support/docview.wss?uid=swg21608271). （错误消息与您收到的错误消息不同，但我确实在我编写的另一个加载项上收到了您的错误消息，该加载项没有丢失任何引用，结果证明是同一个问题.)

我建议做的另一件事是清除您的 .exd 文件，如下所述：http: [//support.microsoft.com/kb/290537](http://support.microsoft.com/kb/290537)我还发现这些可能导致虚假库错误，尤其是在某个版本之后升级。

至于你做错的任何其他事情，好吧，我个人倾向于在不使用 Option Explicit 的情况下剥削任何为我工作的人。8^>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-10T12:32:47.617

我们公司的一个 excel 宏（到目前为止运行非常频繁，没有任何问题）突然出现了完全相同的错误。我们没有像永远一样接触代码。老实说，我仍然不知道究竟是什么导致了这个错误。也许是神秘的微软？无论如何..我终于能够修复这个错误。

即使“需要变量声明”被禁用并且`Option Exlicit`在我的情况下没有设置，**但首先声明变量**对我来说是诀窍：

`Dim numberOfBooks As Integer: numberOfBooks = 0`

我希望这可以避免一些头痛。

# visual-c++ - 收到“致命错误 C1083：无法打开包含文件：'gxall.h'：没有这样的文件或目录”

> ID：13086830
> 
> 赞同：0
> 
> 时间：2012-10-26T12:20:13.240
> 
> 标签：visual-c++, objective-grid

> **可能重复：**
> [错误消息无法打开包含文件：'gxall.h'：没有这样的文件或目录](https://stackoverflow.com/questions/5335052/error-message-cannot-open-include-file-gxall-h-no-such-file-or-directory)

嗨，我正在使用 VC++ 6.0，我已将 gxall.h 包含在 stdafx.h 文件中，但在构建代码时出现错误：

`fatal error C1083: Cannot open include file: 'gxall.h': No such file or directory`

```
// Objective Grid
#include <gxall.h> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:25:50.957

您需要在项目属性中设置 Objective Grid 的路径包括文件夹。

选择菜单`Project->[YourProjectName] Properties`然后编辑`C/C++->General->Additional Include Directories`行在那里添加你的路径，例如`\3rdParty\OGrid12.0.2\Include`。

# windows - 指示 win32 线程在单个处理器内核上运行

> ID：13086831
> 
> 赞同：4
> 
> 时间：2012-10-26T12:20:19.237
> 
> 标签：windows, multithreading, winapi

我有一个测试程序，如果它可以依赖于在 Windows 上以严格的优先级顺序调度的线程，它会简单得多。我看到一个低优先级线程与高优先级线程一起运行，我想知道这是否正在发生，因为不同的线程被安排在不同的处理器内核上。

有没有办法强制进程中的所有 Win32 线程使用单个处理器内核？ [SetThreadAffinityMask](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686247%28v=vs.85%29.aspx)看起来可能很有趣，但它的文档并不完全清楚，我不确定如何使用它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T12:23:25.373

SetThreadAffinityMask 函数：为指定线程设置处理器关联掩码。

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms686247%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686247%28v=vs.85%29.aspx)

```
SetThreadAffinityMask(GetCurrentThread(), (1 << CoreNumber)); 
```

将当前线程的亲和性设置为“CoreNumber”变量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:25:29.240

即使您将所有线程强制到一个虚拟处理器上，您仍然经常会运行低优先级线程和等待它们的高优先级线程（[优先级反转](https://en.wikipedia.org/wiki/Priority_inversion)）。一旦一个线程被 windows-scheduler 调度，它就会一直运行，直到它被抢占或休眠（或其他一些导致休眠的系统调用）。您将不得不更改应用程序的设计，使其不再假定没有低优先级线程运行，而高优先级线程也准备好运行。

# asp.net - 如何在多个表上使用 CRUD 操作创建通用网格

> ID：13086834
> 
> 赞同：1
> 
> 时间：2012-10-26T12:20:38.177
> 
> 标签：asp.net, generics, grid, crud

如何使用 CRUD 操作和相应的验证使网格具有通用性。

这里的通用意味着泛化 BL 和 UI。

我有 10 个表，其中业务逻辑和 UI 实现是相同的。但我实际上不想为它们创建 10 个存储库方法以及 10 个 aspx 页面来填充数据。

在 BL 中，有没有办法获取 List 并进行 CRUD 操作。我已经研究并有一个想法来使用反射进行读取操作但不确定更新/插入。

在 UI 中，到目前为止，我正在使用用户控件在 Grid 中填充数据并在弹出窗口中插入/更新。所以我有一个使用 MVP 的想法，但不太确定如何实现？

任何讨论/建议都会有所帮助！

# openerp - 如何在树视图中指定列宽

> ID：13086837
> 
> 赞同：3
> 
> 时间：2012-10-26T12:20:51.080
> 
> 标签：openerp

我正在使用 OpenERP 6.0.4 GTK 客户端，产品树视图显示 UoM 列太宽（比产品名称宽）。在树视图中控制列宽的地方在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T11:14:04.363

从技术上讲，这整个是 CSS 的游戏，但如果你真的很想检查，那么在 OpenERP Web 项目上`addons/web/static/src/css/base.css`检查的内容是如何进行的，你看到的类的`oe_list_content`宽度在相对位置是 100%，但每个字段类型也有自己的属性。如果您使用 Firebug 检查内容，您会发现每个单元格都有多个 CSS，但它们`oe_list_content` 是共同的，因此所有单元格都保留在相同的 tr、td 中。

谢谢你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:34:37.430

我想你不能。最接近的方法是使用`colspan="x"`field 属性，但不幸的是，这在树视图中不起作用。

# android - 带有片段的操作栏向上导航

> ID：13086840
> 
> 赞同：94
> 
> 时间：2012-10-26T12:21:00.487
> 
> 标签：android, android-fragments, android-actionbar

我有一个选项卡式 Actionbar/viewpager 布局，其中包含三个选项卡**A**、**B**和**C**。在选项卡**C**选项卡（片段）中，我添加了另一个片段，说片段**D**。和

```
 DFragment f= new DFragment();
 ft.add(android.R.id.content, f, "");
 ft.remove(CFragment.this);
 ft.addToBackStack(null);
 ft.commit(); 
```

我在 DFragment 的 onResume 中修改操作栏以添加按钮：

```
ActionBar ab = getActivity().getActionBar();
ab.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
ab.setDisplayHomeAsUpEnabled(true);
ab.setDisplayShowHomeEnabled(true); 
```

现在在 DFragment 中，当我按下硬件（电话）后退按钮时，我返回到原始选项卡式（ABC）布局并选择了 CFragment。如何使用操作栏向上按钮实现此功能？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2013-12-01T16:45:01.597

实现`OnBackStackChangedListener`此代码并将其添加到您的 Fragment Activity。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    //Listen for changes in the back stack
    getSupportFragmentManager().addOnBackStackChangedListener(this);
    //Handle when activity is recreated like on orientation Change
    shouldDisplayHomeUp();
}

@Override
public void onBackStackChanged() {
    shouldDisplayHomeUp();
}

public void shouldDisplayHomeUp(){
   //Enable Up button only  if there are entries in the back stack
   boolean canGoBack = getSupportFragmentManager().getBackStackEntryCount()>0;
   getSupportActionBar().setDisplayHomeAsUpEnabled(canGoBack);
}

@Override
public boolean onSupportNavigateUp() {
    //This method is called when the up button is pressed. Just the pop back stack.
    getSupportFragmentManager().popBackStack();
    return true;
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-10-31T18:48:07.337

我得到了它。只需在托管活动中覆盖**onOptionsItemSelected**并弹出后台堆栈，例如

```
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home: {
            FragmentManager fm = getSupportFragmentManager();
            if (fm.getBackStackEntryCount() > 0) {
                fm.popBackStack();
                return true;
            }
            break;
        }
    }
    return super.onOptionsItemSelected(item);
} 
```

致电`getActionBar().setDisplayHomeAsUpEnabled(boolean);`并按以下答案中的说明进行`getActionBar().setHomeButtonEnabled(boolean);`。`onBackStackChanged()`

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-07-22T03:31:01.910

如果您有一个父活动并希望此向上按钮用作后退按钮，则可以使用以下代码：

将此添加到主活动类中的 onCreate

```
getSupportFragmentManager().addOnBackStackChangedListener(new FragmentManager.OnBackStackChangedListener() {
        @Override
        public void onBackStackChanged() {
            int stackHeight = getSupportFragmentManager().getBackStackEntryCount();
            if (stackHeight > 0) { // if we have something on the stack (doesn't include the current shown fragment)
                getSupportActionBar().setHomeButtonEnabled(true);
                getSupportActionBar().setDisplayHomeAsUpEnabled(true);
            } else {
                getSupportActionBar().setDisplayHomeAsUpEnabled(false);
                getSupportActionBar().setHomeButtonEnabled(false);
            }
        }

    }); 
```

然后像这样添加 onOptionsItemSelected ：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            getSupportFragmentManager().popBackStack();
            return true;
     ....
 } 
```

我通常一直都在使用它，而且看起来很合法

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-05-23T16:29:29.310

您可以使用向上按钮（如后退按钮）返回；

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            super.onBackPressed();
            return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-09-15T15:55:21.847

我结合了[Roger Garzon Nieto](https://stackoverflow.com/a/20314570/226819 "罗杰·加尔松·涅托")和[sohailaziz 的](https://stackoverflow.com/a/13165609/226819 "索海拉齐兹")答案。我的应用程序有一个 MainActivity，以及加载到其中的片段 A、B、C。我的“家”片段（A）实现了 OnBackStackChangedListener，并检查了 backStack 的大小；如果小于 1，则隐藏 UP 按钮。片段 B 和 C 总是加载返回按钮（在我的设计中，B 从 A 启动，C 从 B 启动）。MainActivity 本身只是在 UP 按钮点击时弹出 backstack，并具有显示/隐藏按钮的方法，片段调用：

**主要活动：**

```
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        // Respond to the action bar's Up/Home button
        case android.R.id.home:
            getSupportFragmentManager().popBackStack();
            return true;
    }
    return super.onOptionsItemSelected(item);
}

public void showUpButton() { getSupportActionBar().setDisplayHomeAsUpEnabled(true); }
public void hideUpButton() { getSupportActionBar().setDisplayHomeAsUpEnabled(false); } 
```

**fragmentA（实现 FragmentManager.OnBackStackChangedListener）：**

```
public void onCreate(Bundle savedinstanceSate) {
    // listen to backstack changes
    getActivity().getSupportFragmentManager().addOnBackStackChangedListener(this);

    // other fragment init stuff
    ...
}

public void onBackStackChanged() {
    // enable Up button only  if there are entries on the backstack
    if(getActivity().getSupportFragmentManager().getBackStackEntryCount() < 1) {
        ((MainActivity)getActivity()).hideUpButton();
    }
} 
```

**片段B，片段C：**

```
public void onCreate(Bundle savedinstanceSate) {
    // show the UP button
    ((MainActivity)getActivity()).showUpButton();

    // other fragment init stuff
    ...
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-06-05T19:56:41.410

我知道这个问题很老，但可能有人（像我一样）也需要它。

如果您的 Activity 扩展**AppCompatActivity**，您可以使用更简单的（两步）解决方案：

1 - 每当您添加非主页片段时，只需在提交片段事务后立即显示向上按钮。像这样：

```
 // ... add a fragment
    // Commit the transaction
    transaction.commit();

    getSupportActionBar().setDisplayHomeAsUpEnabled(true); 
```

2 - 然后当按下向上按钮时，将其隐藏。

```
@Override
public boolean onSupportNavigateUp() {
    getSupportActionBar().setDisplayHomeAsUpEnabled(false);        
    return true;
} 
```

就是这样。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-10-31T13:14:24.417

这对我有用。覆盖 onSupportNavigateUp 和 onBackPressed，例如（Kotlin 中的代码）；

```
override fun onBackPressed() {
    val count = supportFragmentManager.backStackEntryCount
    if (count == 0) {
        super.onBackPressed()
    } else {
        supportFragmentManager.popBackStack()
    }
}

override fun onSupportNavigateUp(): Boolean {
    super.onSupportNavigateUp()
    onBackPressed()
    return true
} 
```

现在在片段中，如果您显示向上箭头

```
activity.supportActionBar?.setDisplayHomeAsUpEnabled(true) 
```

单击它会带您返回上一个活动。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-01-29T17:11:37.100

科特林：

```
class MyActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        ...
        supportFragmentManager.addOnBackStackChangedListener { setupHomeAsUp() }
        setupHomeAsUp()
    }

    private fun setupHomeAsUp() {
        val shouldShow = 0 < supportFragmentManager.backStackEntryCount
        supportActionBar?.setDisplayHomeAsUpEnabled(shouldShow)
    }

    override fun onSupportNavigateUp(): Boolean = 
        supportFragmentManager.popBackStack().run { true }

    ...
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-01-03T11:34:22.350

这是一个非常好的和可靠的解决方案：http: [//vinsol.com/blog/2014/10/01/handling-back-button-press-inside-fragments/](http://vinsol.com/blog/2014/10/01/handling-back-button-press-inside-fragments/)

这家伙制作了一个抽象片段来处理 backPress 行为，并使用策略模式在活动片段之间切换。

对于你们中的一些人来说，抽象类可能有一点缺点......

很快，链接中的解决方案如下所示：

```
// Abstract Fragment handling the back presses

public abstract class BackHandledFragment extends Fragment {
    protected BackHandlerInterface backHandlerInterface;
    public abstract String getTagText();
    public abstract boolean onBackPressed();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if(!(getActivity()  instanceof BackHandlerInterface)) {
            throw new ClassCastException("Hosting activity must implement BackHandlerInterface");
        } else {
            backHandlerInterface = (BackHandlerInterface) getActivity();
        }
    }

    @Override
    public void onStart() {
        super.onStart();

        // Mark this fragment as the selected Fragment.
        backHandlerInterface.setSelectedFragment(this);
    }

    public interface BackHandlerInterface {
        public void setSelectedFragment(BackHandledFragment backHandledFragment);
    }
} 
```

以及在活动中的用法：

```
// BASIC ACTIVITY CODE THAT LETS ITS FRAGMENT UTILIZE onBackPress EVENTS 
// IN AN ADAPTIVE AND ORGANIZED PATTERN USING BackHandledFragment

public class TheActivity extends FragmentActivity implements BackHandlerInterface {
    private BackHandledFragment selectedFragment;

    @Override
    public void onBackPressed() {
        if(selectedFragment == null || !selectedFragment.onBackPressed()) {
            // Selected fragment did not consume the back press event.
            super.onBackPressed();
        }
    }

    @Override
    public void setSelectedFragment(BackHandledFragment selectedFragment) {
        this.selectedFragment = selectedFragment;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-15T20:25:24.357

如果这个活动有一个空的片段堆栈，你想回到你以前的活动：

如果您有一个 MainActivity 并且您正在导航到例如带有嵌套的prefernceScreens 的 SettingsActivity，这可能会很有用。NavigateUp 将弹出片段，直到您可以完成 SettingsActivity 以返回 parentActivity/root。

```
/**
 * On actionbar up-button popping fragments from stack until it is empty.
 * @return true if fragment popped or returned to parent activity successfully.
 */
@Override
public boolean onSupportNavigateUp() {
    //Pop back stack if the up button is pressed.
    boolean canGoBack = getSupportFragmentManager().getBackStackEntryCount()>0;
    if (canGoBack) {
        getSupportFragmentManager().popBackStack();
    } else {
        finish();
        return super.onSupportNavigateUp();
    }
    return true;
} 
```

*注意：* `setDisplayHomeAsUpEnabled(true);`在片段活动中`onCreate()`

# java - 使用 Junit4 以编程方式构建 Junit 递归套件

> ID：13086846
> 
> 赞同：3
> 
> 时间：2012-10-26T12:21:28.880
> 
> 标签：java, junit, junit4

使用注释，很容易设置 Junit 'recursive' Suite ：

```
 @SuiteClasses({MyTest.class})
 public class MySuite{} 
```

然后

```
 @SuiteClasses({MySuite.class})
 public class MySweetSuite {} 
```

启动 MySweetSuite 将启动 MySuite，而 MySuite 将启动 Test。

但是如何以编程方式执行此操作，以使用 JunitCore 启动整个过程？
现在，我可以创建 MySuite

```
Class<?>[] tests = { MyTest.class};
Suite mySuite = new Suite(myBuilder, tests); 
```

我该如何做'父母' mySweetSuite ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:43:13.523

根据[jUnit 文档](http://www.junit.org/apidocs/junit/framework/TestSuite.html)，`TestSuite implements Test`.
因此尝试以下操作：

```
Class<?>[] testClasses = { MySweetSuite.class }
TestSuite suite = new TestSuite(testClasses); 
```

# sql - 热备份DB脚本理解

> ID：13086853
> 
> 赞同：0
> 
> 时间：2012-10-26T12:21:45.793
> 
> 标签：sql, oracle, backup, rman

我目前正在 ORACLE 指南上学习什么是热备份，该指南提供了用于热备份的通用脚本。我不明白这个脚本的一些要点：

```
PROMPT Path to destination directory:
ACCEPT repertory
PROMPT Path for first file
ACCEPT file
PROMPT Path for second file
ACCEPT spool
SPOOL &file
PROMPT spool &spool  ;;
PROMPT archive log list ;; 
```

我不明白第一个和第二个文件是什么，假脱机是什么意思？我认为这是一些热备份词汇但我没有找到任何解释。任何线索将不胜感激。谢谢

编辑：来源： http: [//oracle.developpez.com/guide/sauvegarde/generalites/#L3.2](http://oracle.developpez.com/guide/sauvegarde/generalites/#L3.2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:49:24.777

您引用的备份脚本非常古老，并且使用了旧技术——即使对于 Oracle 9i 来说也是旧技术。即使在那个版本中，RMAN（恢复管理器）也可用，并且在所有情况下都首选使用 RMAN。

有关如何使用它的概述，请参阅 Tim Hall 的优秀站点：[http ://www.oracle-base.com/articles/9i/recovery-manager-9i.php](http://www.oracle-base.com/articles/9i/recovery-manager-9i.php)

Oracle 的 RMAN 备份概念指南在这里：[http ://docs.oracle.com/cd/B28359_01/backup.111/b28270/rcmcncpt.htm](http://docs.oracle.com/cd/B28359_01/backup.111/b28270/rcmcncpt.htm)

更简单的是，如果您安装了 dbconsole，您可以通过 webgui 配置备份。

# c# - asp.net 中的移动设备检测

> ID：13086856
> 
> 赞同：47
> 
> 时间：2012-10-26T12:22:03.627
> 
> 标签：c#, asp.net

以下是包含三种不同条件的移动设备检测代码

```
if (Request.Browser.IsMobileDevice)
{
   //Do Something
}
else if (((System.Web.Configuration.HttpCapabilitiesBase)myBrowserCaps).IsMobileDevice)
{
  //Do Something
}
else if (IsMobileDevice(mobileDevices))
{
  //Do Something
}

public bool IsMobileDevice()
{
     private static string[] mobileDevices = new string[] {"iphone","ppc"
                                                   "windows ce","blackberry",
                                                   "opera mini","mobile","palm"
                                                   "portable","opera mobi" };

         string userAgent = Request.UserAgent.ToString().ToLower();
         return mobileDevices.Any(x => userAgent.Contains(x));
 } 
```

我被迫写了三个条件，因为它们在某些设备上失败了。

任何人都可以提出更好的方法吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-10-26T12:25:31.440

获取并更改以下代码：[http ://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

```
public static class Utils
{    
    // update : 5/April/2018
    static Regex MobileCheck = new Regex(@"(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino", RegexOptions.IgnoreCase | RegexOptions.Multiline | RegexOptions.Compiled);
    static Regex MobileVersionCheck = new Regex(@"1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-", RegexOptions.IgnoreCase | RegexOptions.Multiline | RegexOptions.Compiled);

    public static bool fBrowserIsMobile()
    {
        Debug.Assert(HttpContext.Current != null);

        if (HttpContext.Current.Request != null && HttpContext.Current.Request.ServerVariables["HTTP_USER_AGENT"] != null)
        {
            var u = HttpContext.Current.Request.ServerVariables["HTTP_USER_AGENT"].ToString();

            if (u.Length < 4)
                return false;

            if (MobileCheck.IsMatch(u) || MobileVersionCheck.IsMatch(u.Substring(0, 4)))
                return true;
        }

        return false;
    }
} 
```

这就是你所说的。

```
if (Utils.fBrowserIsMobile())
{
    // go to mobile pages
} 
```

我对代码的更改来自`http://detectmobilebrowsers.com/`

*   使静态编译正则表达式以更快地检查。
*   修复 u 小于 4 个字符的问题。
*   其他检查。

## 使用缓存

这段代码很快，一个技巧是我们已经制作了静态并预编译了正则表达式。我如何建议在第一次检查后将结果保存在用户会话中并使用更快的会话变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-01-09T20:42:11.770

我正在使用 DeviceDetector.NET，因为我经常需要将智能手机和平板电脑分开

安装它 `Install-Package DeviceDetector.NET`

然后像这样使用它

```
DeviceDetectorSettings.RegexesDirectory = "C:\\DeviceDetector.NET.3.11.4\\";
var dd = new DeviceDetector(Request.UserAgent);
dd.Parse();

var device = dd.GetDeviceName();

if(device == "tablet") {}
if(device == "smartphone") {}
if(device == "desktop") {}

/**
Possible returns
--
desktop
smartphone
tablet
feature phone
console
tv
car browser
smart display
camera
portable media player
phablet
**/ 
```

正则表达式可以在包目录中找到

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-02-01T20:51:50.727

此代码适用于我的情况。

```
public void IsMobileBrowser()
{
    String labelText = "";
    System.Web.HttpBrowserCapabilities myBrowserCaps = Request.Browser;
    if (((System.Web.Configuration.HttpCapabilitiesBase)myBrowserCaps).IsMobileDevice)
    {
        labelText = "Browser is a mobile device.";
    }
    else
    {
        labelText = "Browser is not a mobile device.";
    }
    ScriptManager.RegisterStartupScript(this, this.GetType(), "", "alert('"+ labelText + "');", true);
} 
```

参考：[HttpCapabilitiesBase.IsMobileDevice 属性](https://msdn.microsoft.com/en-us/library/system.web.configuration.httpcapabilitiesbase.ismobiledevice.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-26T12:26:20.863

Scott Hanselman 有一篇关于这个主题的精彩[博文。](http://www.hanselman.com/blog/CreateAGreatMobileExperienceForYourWebsiteTodayPlease.aspx)他提到了一个名为 51Degrees 的第 3 方解决方案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-26T12:28:45.403

现有的浏览器定义很糟糕。理想情况下，您希望使用[WURFL 数据库](http://wurfl.sourceforge.net/)来扩充这些定义。

幸运的是，这很容易使用[51 Degrees.mobi 库](http://51degrees.mobi/Products/Framework.aspx)。

还有一个[Nuget 包](http://nuget.org/packages/51Degrees.mobi)：

```
Install-Package 51Degrees.mobi 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-26T12:26:53.437

我建议将用户代理列表存储在 web.config 中，以便于配置。`IsMobileDevice`没有主动更新新的浏览器，因此它确实有其局限性，这就是您需要进一步检查的原因。

51Degrees.mobi[包](http://nuget.org/packages/51Degrees.mobi)将是更可靠的替代方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-08T19:24:17.700

检查代码隐藏中的 UserAgent 是否有类似于[此处](https://stackoverflow.com/questions/3514784/what-is-the-best-way-to-detect-a-mobile-device-in-jquery)引用的 javascript 的“Mobi” 。

```
 if (Request.UserAgent.Contains("Mobi") == true)
                {
                    DivToShowWhenMobileDevice.Style.Add("display", "");
                }
                else
                {
                    DivToShowWhenMobileDevice.Style.Add("display", "none");
                } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-26T12:25:36.877

好吧，是的，如果您想确定 useragent 可能是最好的方法。你也可以看看这个方法：

[http://msdn.microsoft.com/en-us/library/system.web.configuration.httpcapabilitiesbase.ismobiledevice.aspx](http://msdn.microsoft.com/en-us/library/system.web.configuration.httpcapabilitiesbase.ismobiledevice.aspx)

新浏览器等应该有一些问题。但这就是你目前所做的。

# ios - 无需审核流程即可远程更新 iOS 应用程序

> ID：13086857
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:22:03.573
> 
> 标签：ios

如果应用程序中有任何更改不需要遵循整个提交和审查过程，我们可以将它添加到远程服务器上的东西是什么？

请提出您的建议，以使应用程序在没有审查过程的情况下最大限度地更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:43:35.980

您可以下载数据，其中包括新的图形元素。

指导方针说，*“以任何方式或形式下载代码的应用程序都将被拒绝”*。但是，在某些逻辑中使用 HTML 和 Javascript 的应用程序通常能够替换它们。

也许你会得到更好的答案，从列出你希望能够改变的事情开始，看看是否有办法完成它们。

# iphone - iOS，为 iphone 4+5 设置表格高度，导航栏、标签栏、搜索栏和键盘始终可见？

> ID：13086867
> 
> 赞同：0
> 
> 时间：2012-10-26T12:22:43.713
> 
> 标签：iphone, objective-c, ios

在我的应用程序中，我有一个导航栏、一个标签栏、一个搜索栏，而且我总是显示键盘。

但是，由于 iphone 5 的屏幕高度不同，我需要调整桌子的高度。

我无法将表格锚定到键盘顶部，因为这显示了运行时间。

所以我试图动态地做到这一点，看起来我错过了搜索栏，太短了，嗯。

也许有更简单更明显的方法？

编辑：到目前为止我的代码。

```
-(void)keyboardWillShow:(NSNotification*)aNotification {

int th = self.view.frame.size.height;

NSDictionary *info = [aNotification userInfo];
CGSize kbSize = [[info objectForKey:UIKeyboardFrameEndUserInfoKey] 
      CGRectValue].size;

int tableTop;
int tableHeight;

tableTop = table.frame.origin.y;

tableHeight = (th - tableTop) - kbSize.height;

[table setFrame:[General setTableBoundsByHeight:tableHeight:table]];

}

+ (CGRect)setTableBoundsByHeight:(int)lHeight:(UITableView*)tbl {

    CGRect tableFrame = tbl.frame;

    return CGRectMake(tableFrame.origin.x,
                                   tableFrame.origin.y,
                                   tableFrame.size.width,
                                    lHeight);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:52:22.397

我猜你的“tableView”是你的“self.view”的一部分。如果是，则它位于不同的坐标系中。

键盘被添加到窗口中，并且 tableView 在您的视图层次结构中。您将需要使用标题下描述的功能：[在](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)**视图坐标系之间转换**

编辑：如果您阅读[有关 UIKeyboardFrameEndUserInfoKey 的文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWindow_Class/UIWindowClassReference/UIWindowClassReference.html)，您会看到它提到矩形在屏幕坐标中，而您的 UITableView 几乎可以肯定在某些其他视图坐标系中。在同一文档中，他们提到了在两者之间转换的功能。

# c# - 没有上一个和下一个按钮且没有显示模式选项的 WPF 自定义日历

> ID：13086869
> 
> 赞同：1
> 
> 时间：2012-10-26T12:22:46.070
> 
> 标签：c#, wpf, button, calendar, disabled-control

我正在使用每个月的单独日历控件创建一个 12 个月的日历。由于我通过单独的明年和上一年按钮控制日历（1 月 - 12 月），因此我想从各个日历中删除上一个和下一个日历项按钮并禁用更改显示模式的功能。

由于我是 XAML 新手并且更喜欢在代码中执行此操作，因此我更愿意在运行时更改样式，但愿意学习如何通过 XAML 实现它，但我很难找到某人正在做某事的示例像这样。

希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:14:12.807

我建议您参考[这篇](http://msdn.microsoft.com/en-us/magazine/dd882520.aspx)文章，以对日历控件有一些基本的了解。

简而言之，您需要修改 CalendarItemStyle 并从其模板中删除 PART_PreviousButton 和 PART_NextButton。[您可以在此处](http://msdn.microsoft.com/en-us/library/ff468218.aspx)找到日历控件所有部分的默认模板。

当您创建没有这些部分的新日历项样式时，请将其设置为XAML 中日历的[CalendarItemStyle](http://msdn.microsoft.com/en-us/library/system.windows.controls.calendar.calendaritemstyle.aspx)属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T14:42:55.877

好吧，经过大量的挖掘，许多例子和 Dodsky 为我指明了正确的方向。我想通了，觉得分享是回报开发者社区的最好方式。因为，我是 XAML 的新手，所以我在项目战中取得了小小的胜利。希望它能帮助像我这样的其他新手。

我将尝试解释我可以向您展示如何以任何您需要的方式操作日历的最佳方式。

在我的用户控件中

```
<Calendar CalendarItemStyle="{DynamicResource calItemStyle}"  Name="calJan"    
 HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" 
 HorizontalAlignment="Center" VerticalAlignment="Center" OverridesDefaultStyle="False" 
 IsEnabled="True" /> 
```

有些参数有点矫枉过正，重点是Dynamic Resource

```
CalendarItemStyle="{DynamicResource calItemStyle}" 
```

在我的 ResourceDictionary 中，我添加了命名空间

```
xmlns:primitives="clr-namespace:System.Windows.Controls.Primitives;assembly=PresentationFramework" 
```

您还需要将 PresentationFramework 引用添加到您的项目中，如果它不存在的话。

```
<Style x:Key="calItemStyle"
           TargetType="primitives:CalendarItem">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="primitives:CalendarItem">
                <ControlTemplate.Resources>
                    <DataTemplate x:Key="DayTitleTemplate">
                        <TextBlock Text="{Binding}"
                                       HorizontalAlignment="Center" />
                    </DataTemplate>
                </ControlTemplate.Resources>

                <DockPanel Name="PART_Root" 
                               LastChildFill="True">
                    <Button x:Name="PART_PreviousButton" 
                                DockPanel.Dock="Left"
                                Content="&lt;"
                                Focusable="False" 
                                Visibility="Hidden"
                                />

                    <Button x:Name="PART_NextButton" 
                                DockPanel.Dock="Right"
                                Content="&gt;" 
                                Focusable="False" 
                                Visibility="Hidden"
                                />

                    <Button x:Name="PART_HeaderButton"                                             
                                DockPanel.Dock="Top"
                                FontWeight="Bold"
                                Focusable="False" />

                    <Grid>
                        <Grid x:Name="PART_MonthView" 
                                  Visibility="Visible">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                        </Grid>

                        <Grid x:Name="PART_YearView" 
                                  Visibility="Hidden">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                        </Grid>
                    </Grid>
                    <Rectangle x:Name="PART_DisabledVisual" Opacity="0" Visibility="Collapsed" Fill="#A5FFFFFF"/>
                </DockPanel>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter TargetName="PART_DisabledVisual" Property="Visibility" Value="Visible" />
                    </Trigger>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type Calendar}}, Path=DisplayMode}" Value="Year">
                        <Setter TargetName="PART_MonthView" Property="Visibility" Value="Hidden" />
                        <Setter TargetName="PART_YearView" Property="Visibility" Value="Visible" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type Calendar}}, Path=DisplayMode}" Value="Decade">
                        <Setter TargetName="PART_MonthView" Property="Visibility" Value="Hidden" />
                        <Setter TargetName="PART_YearView" Property="Visibility" Value="Visible" />
                    </DataTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我选择隐藏“上一个”和“下一个”按钮，以防万一删除导致任何事件出现问题，但除此之外，它会执行我想要的操作，并且我可以根据需要添加或删除功能。

希望这对其他人有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-30T16:40:22.340

和 Chris 一样，我不想乱用一大堆 XAML。我还需要动态隐藏/显示。我想有一种方法可以通过 XAML 中的绑定来做到这一点，但我认为这是一个非常简单的开始。只需使用此代码添加一个新类，然后改用此派生控件即可。

编辑：我将其更新为具有您可以设置的属性 HidePrevNextBtns。如果选中/为真，按钮将被隐藏。这段代码确实做了几个假设。一个是模板也将具有上一个/下一个按钮，另一个是默认情况下它们是可见的。

```
class MyCalendar : Calendar 
{
    public Button PrevBtn;
    public Button NextBtn;

    protected bool _HidePrevNextBtns;
    public bool HidePrevNextBtns
    {
        get
        {
            return (_HidePrevNextBtns);
        }
        set
        {
            _HidePrevNextBtns = value;
            if (PrevBtn != null)
            {
                PrevBtn.Visibility = _HidePrevNextBtns ? Visibility.Hidden : Visibility.Visible;
                NextBtn.Visibility = _HidePrevNextBtns ? Visibility.Hidden : Visibility.Visible;
            }
        }
    }

    public override void OnApplyTemplate()
    {
        base.OnApplyTemplate();

        var cal = this.Template.FindName("PART_CalendarItem", this) as CalendarItem;

        cal.Loaded += new RoutedEventHandler(cal_Loaded);
    }

    void cal_Loaded(object sender, RoutedEventArgs e)
    {
        var cal = sender as CalendarItem;
        PrevBtn = cal.Template.FindName("PART_PreviousButton", cal) as Button;
        NextBtn = cal.Template.FindName("PART_NextButton", cal) as Button;
        if (_HidePrevNextBtns)
        {
            PrevBtn.Visibility = Visibility.Hidden;
            NextBtn.Visibility = Visibility.Hidden;
        }
    }
} 
```

# mocking - 使用 TypeMock 模拟静态函数

> ID：13086870
> 
> 赞同：1
> 
> 时间：2012-10-26T12:22:50.673
> 
> 标签：mocking, tdd, typemock, typemock-isolator

我正在尝试在我的项目中模拟静态函数。我无法使用 Rhynomocks 执行此操作，因此尝试使用 Typemock 模拟静态函数。

他们说使用 typemock 模拟静态函数是可能的，下面的文章中提供了相同的示例

[http://www.typemock.com/basic-typemock-unit-testing](http://www.typemock.com/basic-typemock-unit-testing)

但是它似乎对我不起作用。下面是我的代码：

> 公共类 Class1Test
> {
> [Isolated(Design = DesignMode.Pragmatic)]
> [Test]
> public void function()
> { Isolate.Fake.StaticMethods(Members.MustSpecifyReturnValues);
> 
> ```
>  Isolate.WhenCalled(() => LoggerFactory.Add(6, 4)).WillReturn(11);
> 
>         int value = LoggerFactory.Add(5, 6);
>     }
> 
> } 
> ```

-----------------------------------------------------------LoggerFactory.cs

公共类 LoggerFactory {

```
 public static  int Add(int intx, int inty)
    {
        return intx + inty;
    }

} 
```

我得到的错误是：

***在 InterfaceOnly 设计模式下，无法伪造非虚拟方法。使用 [Isolated(DesignMode.Pragmatic)] 来伪造它。在此处了解更多信息[http://www.typemock.com/isolator-design-mode](http://www.typemock.com/isolator-design-mode)

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T20:25:57.510

你为什么要首先模拟？您的方法不需要模拟，因为它是无状态的 - 只需直接测试它：

```
[Test]
public void Six_Plus_Five_Is_Eleven()
{
    Assert.That(11, Is.EqualTo(LoggerFactory.Add(6, 5));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:48:04.490

您的示例代码看起来不完整。我只是使用您的代码将稍微修改的复制品放在一起，它工作正常。具体来说，该`Isolate.Fake.StaticMethods`调用缺少您打算模拟的类型。

```
using System;
using NUnit.Framework;
using TypeMock.ArrangeActAssert;

namespace TypeMockDemo
{
  public class LoggerFactory
  {
    public static int Add(int intx, int inty)
    {
      return intx + inty;
    }
  }

  // The question was missing the TestFixtureAttribute.
  [TestFixture]
  public class LoggerFactoryFixture
  {
    // You don't have to specify DesignMode.Pragmatic - that's the default.
    [Isolated(Design = DesignMode.Pragmatic)]
    [Test]
    public void Add_CanMockReturnValue()
    {
      // The LoggerFactory type needs to be specified here. This appeared
      // missing in the example from the question.
      Isolate.Fake.StaticMethods<LoggerFactory>(Members.MustSpecifyReturnValues);

      // The parameters in the Add call here are totally ignored.
      // It's best to put "dummy" values unless you are using
      // WithExactArguments.
      Isolate.WhenCalled(() => LoggerFactory.Add(0, 0)).WillReturn(11);

      // Note the parameters here. No WAY they add up to 11\. That way
      // we know you're really getting the mock value.
      int value = LoggerFactory.Add(100, 200);

      // This will pass.
      Assert.AreEqual(11, value);
    }
  }
} 
```

如果您可以将该代码粘贴到项目中（使用 Typemock 和 NUnit 引用）并且它不起作用，那么您可能无法正确执行测试，或者您的机器上可能存在错误配置。无论哪种情况，如果上述代码不起作用，您可能需要联系 Typemock 支持。

# jquery-ui - 我可以混合 jqueryui 和 google app 脚本表单提交吗

> ID：13086880
> 
> 赞同：0
> 
> 时间：2012-10-26T12:24:21.613
> 
> 标签：jquery-ui, google-apps-script

如此处所述：

[https://developers.google.com/apps-script/html_service#GoogleScriptAPI](https://developers.google.com/apps-script/html_service#GoogleScriptAPI)

我在我的 google app scripts html 界面模板中使用了一个小表单来允许提交数据：

```
<form id='myForm'><input type='button' onclick='google.script.run.processForm(this.parentNode)'></form> 
```

这会在我的脚本中触发一个函数，该函数会像这样更新电子表格单元格：

```
function processForm(params) {
  var ss = SpreadsheetApp.openById(XXXXXXXXX);
  var email_sheet = ss.getSheetByName('Week '+(parseInt(params['week'],10)+1)+' Assignments');
  var range = colName(parseInt(params['assignment'],10)+1) + (parseInt(params['match'],10)+1);
  var existing_val = email_sheet.getRange(range).getValue()
  email_sheet.getRange(range).setValue(existing_val+ params['submission']);
} 
```

那里有很多特定于我的更大系统的东西，但是这样做是允许我班的学生提交作业信息，这些信息被转储到电子表格中与他们的谷歌登录相对应的位置，当他们刷新页面时， html 界面更新以指示收到提交。界面如下所示：

![htmlinstance接口使用google app脚本表单提交](../Images/d8e72ca00548522d1813615da7fd5989.png)

刚刚让它工作，我正在弹出香槟，因为它将极大地简化管理学生提交的过程，但目前如果用户点击提交按钮时界面会更加直观，并且会立即更新删除表单，并从红十字切换到绿色对勾。目前，用户必须重新加载整个页面。

通过阅读文档：

[https://developers.google.com/apps-script/html_service#Caja](https://developers.google.com/apps-script/html_service#Caja)

似乎 jqueryUI 可能是做这样的事情的方法，但我不清楚 jqueryUI 是否能很好地与谷歌应用程序脚本表单提交配合使用。我将详细研究 jqueryUI，但我想知道是否有人知道这两者是否会混合使用。

通过搜索主题，我看到 JQueryUI 不会与谷歌应用脚​​本 UIInstance 混合

[如何混合使用 jQuery 和 UiInstance 来生成 GUI](https://stackoverflow.com/questions/11298141/how-to-mix-jquery-and-a-uiinstance-for-generating-guis)

但是我正在使用 htmlinstance，所以 jquery 应该没问题吧？还是我完全找错了树？

提前谢谢了

ps 我真的需要弄清楚如何更好地设置提交按钮的样式，而且如果您在文本文件中点击返回，似乎会发生完​​整的表单提交并给出此错误“此网页不可用服务器位于 9f9e682e-25ca -4eae-b4f9-6cac8db35390.foo.bar 找不到，因为 DNS 查找失败。DNS 是将网站名称转换为其 Internet 地址的网络服务。” - 我已经在网上搜索了这个错误，但并不高兴 - 希望 JQueryUI 可以再次帮助我解决这个问题，即使对 Caja 进行了清理......我只是想就我是否应该使用我目前得到的界面减少损失获得意见...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T19:38:35.583

您可以正常使用 jQuery 和 jQueryUI `HtmlService`，它不会干扰脚本的表单提交部分。页面、表单或其外观不会影响其值的处理。

但是，根据您的描述，您真正需要进行“图标切换”和“隐藏输入和按钮”的只是一些好的旧 javascript。jQuery 可以使它更容易（更少的代码），但如果你不习惯纯 javascript，它可能只会给你更多的设置麻烦。这同样适用于 jQueryUI，它可以更轻松地构建漂亮的界面，但是您的界面似乎有些简单，而且 jQueryUI 可能有点矫枉过正。

希望这可以帮助。

# asp.net - WebMatrix 中的类中的 DB Select

> ID：13086882
> 
> 赞同：2
> 
> 时间：2012-10-26T12:24:38.737
> 
> 标签：asp.net, razor, webmatrix

我编写了一个使用与 WebMatrix 数据库连接的类。我可以很好地插入、更新查询，但我对选择查询有疑问。我无法将 Razor**动态**变量分配给我的类型指定变量。

如何在通常的 c# 类中使用 WebMatrix 数据库？

我在课堂上的代码：

```
 public bool verify_session()
    {
        if (get_user_id() > 0)
    {
        return true;
    }

        if (HttpContext.Current.Request.Cookies["session_id"] != null)
    {
        var db = Database.Open("studia_sesje");
        var data = db.QuerySingle("SELECT session_id, user_id FROM sessions WHERE session_id = '" + HttpContext.Current.Request.Cookies["session_id"] + "'");

        _session_id = (string)data.session_id;
        _user_id = (int)data.user_id;

        return true;
    }

    return false;
    } 
```

错误是

> 无法对空引用执行运行时绑定

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:56:26.000

该错误表示您的`QuerySingle`方法调用的结果为空，或者您的数据库中没有返回任何行。在尝试访问动态属性之前，您应该检查数据不为空：

```
var session_id = HttpContext.Current.Request.Cookies["session_id"];
var sql = "Select session_id, user_id From Sessions Where session_id = @0";
var data = db.QuerySingle(sql, session_id);
if(data != null){
    _session_id = data.session_id; //bit pointless, you already have that value
    _user_id = data.user_id; // no need to cast to int
    return true;
}
return false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T02:44:09.857

这简单。`null`首先检查

```
var obj=ObjectInfo.ReferenceEquals(Request["cats"],null);
if is obj == true then Execute Query 
```

# android - MediaPlayer 在单独的线程中使用 Service 或 IntentService

> ID：13086885
> 
> 赞同：8
> 
> 时间：2012-10-26T12:24:54.670
> 
> 标签：android, android-intent, media-player

嗨，我需要一个 MediaPlayer 实例在后台运行，所以我开始使用服务。

一切正常，但一段时间后我得到 ANR（应用程序无响应），即使 UI 工作正常。很公平，我知道服务仍在主线程上运行，所以 ANR 是有意义的。

所以我尝试使用 IntentService，它应该会产生自己的线程，但我除了头痛什么都没有。当工作人员独立时，IntentService 似乎没问题，但这里情况并非如此，因为每次我需要更改轨道时，我都需要从主应用程序调用 startService(intent) 方法，并且我不想以多个 MediaPlayer 实例结束互相玩。。

我还看到了一个提示，建议在服务中使用线程。如何使用媒体播放器做到这一点？声明应该在那个线程中还是只是“准备/开始等”？据我所见，这似乎不起作用，但我可能只是错误地实施了它

任何提示都非常感谢，可能有一个非常简单的例子。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-07T08:27:11.240

我强烈建议您阅读此处的培训文档：http: [//developer.android.com/guide/components/services.html](http://developer.android.com/guide/components/services.html)

这对我真的很有帮助。然后流式传输音频的 NPR 应用程序是开源的，因此请在此处查看他们的服务： [http ://code.google.com/p/npr-android-app/source/browse/Npr/src/org/npr/android /news/PlaybackService.java](http://code.google.com/p/npr-android-app/source/browse/Npr/src/org/npr/android/news/PlaybackService.java)

阅读这两个，我建议使用服务并自己处理线程。我还没有与 IntentService 合作过，但根据您的经验，处理音乐流似乎是错误的课程。希望有帮助！

# php - retrieveAllFiles 函数的参数

> ID：13086887
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:25:02.907
> 
> 标签：php, google-drive-api

我正在尝试使用谷歌驱动器API函数retrieveAllFiles（）从谷歌驱动器帐户显示文件列表，但由于它的参数，我不知道如何调用它。这是功能。

```
 function retrieveAllFiles($service) {
      $result = array();
      $pageToken = NULL;

      do {
        try {
          $parameters = array();
          if ($pageToken) {
            $parameters['pageToken'] = $pageToken;
          }
          $files = $service->files->listFiles($parameters);

          $result = array_merge($result, $files->getItems());
          $pageToken = $files->getNextPageToken();
          print $pageToken;
        } catch (Exception $e) {
          print "An error occurred: " . $e->getMessage();
          $pageToken = NULL;
        }
      } while ($pageToken);
      return $result;
    } 
```

我正在使用此链接作为参考： [Files:list - Google Drive](https://developers.google.com/drive/v2/reference/files/list)

我怎样才能得到谷歌驱动API的服务让我通过呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-23T12:03:50.067

```
<?php
require_once 'google-api-php-client/src/Google_Client.php';
require_once 'google-api-php-client/src/contrib/Google_DriveService.php';

$client = new Google_Client();
// Get your credentials from the console
$client->setClientId('YOUR_CLIENT_ID');
$client->setClientSecret('YOUR_APP_SECRET');
$client->setRedirectUri('YOUR_REDIRECT_URI');
$client->setScopes(array('https://www.googleapis.com/auth/drive'));

$service = new Google_DriveService($client);

$authUrl = $client->createAuthUrl();

//Request authorization
print "Please visit:\n$authUrl\n\n";
print "Please enter the auth code:\n";
$authCode = trim(fgets(STDIN));

// Exchange authorization code for access token
$accessToken = $client->authenticate($authCode);
$client->setAccessToken($accessToken);

//Insert a file
$file = new Google_DriveFile();
$file->setTitle('My document');
$file->setDescription('A test document');
$file->setMimeType('text/plain');

$data = file_get_contents('document.txt'); //Put this file into same folder

$createdFile = $service->files->insert($file, array(
      //'data' => $data,
      'mimeType' => 'text/plain',
    )); ////Upload File
echo '<pre>';
//print_r($createdFile);
echo '</pre>';

//////Function for getting all files from your drive

function retrieveAllFiles($service) {               
        $result = array();
        $pageToken = NULL;

        do {
            try {
              $parameters = array();
              if ($pageToken) {
                $parameters['pageToken'] = $pageToken;
              }
              $files = $service->files->listFiles($parameters);

              $result = array_merge($result, $files['items']); 

              $pageToken = $files['nextPageToken'];
            } catch (Exception $e) {
              print "An error occurred: " . $e->getMessage();
              $pageToken = NULL;
            }
        } while ($pageToken);           
        return $result;
    }   

$listss = retrieveAllFiles($service);
echo '<pre>';
print_r($listss);
echo '</pre>';
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:07:41.017

`$service`指有`Google_DriveService`它是一个扩展`Google_ServiceResource`

要使用示例脚本，您需要下载完整的[google-api-php-client](http://code.google.com/p/google-api-php-client/)

```
session_start();
require_once 'PATH_TO/src/Google_Client.php';
require_once 'PATH_TO/src/service/Google_ServiceResource.php';
require_once 'PATH_TO/src/contrib/Google_DriveService.php';

$client = new Google_Client();
$client->setApplicationName("Google Analytics PHP Starter Application");

$client->setClientId('insert_your_oauth2_client_id');
$client->setClientSecret('insert_your_oauth2_client_secret');
$client->setRedirectUri('insert_your_oauth2_redirect_uri');
$client->setDeveloperKey('insert_your_developer_key');
$service = new Google_DriveService($client); 
```

[点击这里下载](http://code.google.com/p/google-api-php-client/downloads/detail?name=google-api-php-client-0.6.0.tar.gz&can=2&q=)

# c++ - C++ 服务器-客户端 FTP 模拟

> ID：13086888
> 
> 赞同：2
> 
> 时间：2012-10-26T12:25:08.820
> 
> 标签：c++, ftp, client-server, simulation

我在使用服务器-客户端 FTP 模拟程序时遇到了一些问题。该程序不断给我“未定义的参考”错误。我在 Windows 上使用 C::B 10.05，并尝试包括 winsock.h、winsock2.h 以及我在互联网上找到的更多解决方案，但没有奏效。这是源代码。非常感谢任何帮助。谢谢。

```
//Router Head file
#include <winsock.h>
#include <fstream>
#include <iostream>
#include <time.h>
#include <winsock2.h>
#include <list>
#include <stdio.h>

#define MAXBUFSIZE 2048             //maximum packet size
#define MAXHOSTNAMELEN 256          //maximum length of host name
#define ROUTER_PORT1 7000           //router port number 1
#define ROUTER_PORT2 7001           //router port number 2
#define PEER_PORT1 5000             //port number of peer host 1
#define PEER_PORT2 5001             //port number of peer host 2
#define TIMEOUT_USEC 300000         //time-out value
#define TRACE 1
using namespace std ;

struct EVENT_LIST
{
    bool empty;
    DWORD count;                    //count is the packet number
    short destination;              //destination of this packet
    int len;                        //length of this packet
    char Buffer[MAXBUFSIZE];        //buffer for packet
};

class Router
{
public:
    char localhost[MAXHOSTNAMELEN];     //local host name
    Router(char *fn="log.txt");
    ~Router();
    void Run();
private:
    ofstream fout;
    float damage_rate, delay_rate;              //damage rate: dropped and delayed
    SOCKET Sock1, Sock2;            //sockets used for communcation with peer host 1 and 2
    EVENT_LIST FileBuf;     //buffer for delayed packets
protected:
    SOCKADDR_IN sa_in_peer1;        // address structure for peer host 1 address
    SOCKADDR_IN sa_in_peer2;        // address structure for peer host 2 address
    bool IsDamage() const;
    bool IsDelayed() const;
    void SendProc();
};

//Router.cpp
//////////////////////////////////////////////////////////
//
//  Router Constructor
//  arguements:
//      fn: A string of log file name
//
//////////////////////////////////////////////////////////

Router::Router(char *fn)        //Constructor
{
    WSADATA wsadata;
    HOSTENT* hp;
    char peer_name1[MAXHOSTNAMELEN], peer_name2[MAXHOSTNAMELEN];
    SOCKADDR_IN sa_in;

    FileBuf.empty=true;

    try
    {
        if (WSAStartup(0x0202,&wsadata)!=0)
            throw "Error in starting WSAStartup()\n";
    }

    //Display any needed error response.
    catch (char *str) { cerr<<str<<":"<<dec<<WSAGetLastError()<<endl; return;}

    //Get Host name
    gethostname(localhost,MAXHOSTNAMELEN);
    cout<<"Router starting on host:"<<localhost<<endl<<flush;

    //Open the log file
    fout.open(fn);

    try
    {
        //Create the Udp Sock1
        if((Sock1 = socket(AF_INET,SOCK_DGRAM,0))==INVALID_SOCKET)
            throw "Create UDP Socket1 failed\n";

        //Fill-in UDP Port and Address info.
        sa_in.sin_family = AF_INET;
        sa_in.sin_port = htons(ROUTER_PORT1);
        sa_in.sin_addr.s_addr = htonl(INADDR_ANY);

        //Bind the UDP port1
        if (bind(Sock1,(LPSOCKADDR)&sa_in,sizeof(sa_in)) == SOCKET_ERROR)
            throw "can't bind the socket1";

        //Create the Udp Sock2
        if((Sock2 = socket(AF_INET,SOCK_DGRAM,0))==INVALID_SOCKET)
            throw "Create UDP Socket2 failed\n";

        //Fill-in UDP Port and Address info.
        sa_in.sin_family = AF_INET;
        sa_in.sin_port = htons(ROUTER_PORT2);
        sa_in.sin_addr.s_addr = htonl(INADDR_ANY);

        //Bind the UDP port2
        if (bind(Sock2,(LPSOCKADDR)&sa_in,sizeof(sa_in)) == SOCKET_ERROR)
            throw "can't bind the socket2";

        cout<<"\nPlease enter the first peer host name:"<<flush;        //enter the dropping rate.
        cin>>peer_name1;
        cout<<"\nPlease enter the second peer host name:"<<flush;       //enter the dropping rate.
        cin>>peer_name2;
        cout<<"\nPlease enter the drop rate:"<<flush;       //enter the dropping rate.
        cin>>damage_rate;
        cout<<"\nPlease enter the delay rate:"<<flush;      //enter the dropping rate.
        cin>>delay_rate;

        //creat peer host1
        if((hp=gethostbyname(peer_name1)) == NULL)
            throw "get server name failed\n";
        memset(&sa_in_peer1,0,sizeof(sa_in_peer1));
        memcpy(&sa_in_peer1.sin_addr,hp->h_addr,hp->h_length);
        sa_in_peer1.sin_family = hp->h_addrtype;
        sa_in_peer1.sin_port = htons(PEER_PORT1);

        //creat peer host2
        if((hp=gethostbyname(peer_name2)) == NULL)
            throw "get client name failed\n";
        memset(&sa_in_peer2,0,sizeof(sa_in_peer2));
        memcpy(&sa_in_peer2.sin_addr,hp->h_addr,hp->h_length);
        sa_in_peer2.sin_family = hp->h_addrtype;
        sa_in_peer2.sin_port = htons(PEER_PORT2);

        if (TRACE)
        {
            fout<<"Peer host 1: "<<peer_name1<<endl;
            fout<<"Peer host 2: "<<peer_name2<<endl;
            fout<<"Damage Rate: "<<damage_rate<<endl;
        }
    }
    catch (char *str) {cerr<<str<<":"<<dec<<WSAGetLastError()<<endl; exit(1);}

    srand( (unsigned)time( NULL ) );
};

//////////////////////////////////////////////////////////
//
//  Router::IsDamage
//      The function that generates random damages according to damage rate.
//
//////////////////////////////////////////////////////////

bool Router::IsDamage() const
{
    return ( (((float)rand())/RAND_MAX) < ((float)damage_rate/100));
}

//////////////////////////////////////////////////////////
//
//  Router::IsDelayed
//      The function that generates random delayed according to delay rate.
//
//////////////////////////////////////////////////////////

bool Router::IsDelayed() const
{
    return ( (((float)rand())/RAND_MAX) < ((float)delay_rate/100));
};

//////////////////////////////////////////////////////////
//
//  Router::Run
//      The function receives packets from peer hosts and forwards to destinations.
//      It also drops packets and stores delayed packets for future sending.
//      It calls SendProc to send delayed packets.
//
//////////////////////////////////////////////////////////

void Router::Run()
{
    fd_set readfds;
    struct timeval *tp=new timeval;
    SOCKADDR from;
    int RetVal, fromlen, recvlen, wait_count;
    EVENT_LIST temp;
    DWORD CurrentTime, count1, count2;

    count1=0;
    count2=0;
    wait_count=0;
    tp->tv_sec=0;
    tp->tv_usec=TIMEOUT_USEC;

    while (1)
    {
        try
        {
            FD_ZERO(&readfds);
            FD_SET(Sock1,&readfds);
            FD_SET(Sock2,&readfds);
            fromlen=sizeof(from);
            if((RetVal=select(1,&readfds,NULL,NULL,tp))==SOCKET_ERROR)  //check for incoming packets.
                throw "Timer error!";
            else if(RetVal>0)   //There are incoming packets.
            {
                if(!FileBuf.empty) wait_count++;
                if(FD_ISSET(Sock1, &readfds))   //incoming packet from peer host 1
                {
                    if((recvlen=recvfrom(Sock1, temp.Buffer, sizeof(temp.Buffer), 0, &from, &fromlen))==SOCKET_ERROR)
                        throw " Get buffer error!";
                    if (TRACE)
                    {
                        fout<<"Router: Receive packet "<<count1<<" from peer host 1"<<endl;
                        cout<<"Router: Receive packet "<<count1<<" from peer host 1"<<endl;
                    }
                    temp.count=count1;
                    count1++;
                    temp.destination=2;
                }
                else if(FD_ISSET(Sock2, &readfds))  //incoming packet from peer host 2
                {
                    if((recvlen=recvfrom(Sock2, temp.Buffer, sizeof(temp.Buffer), 0, &from, &fromlen))==SOCKET_ERROR)
                        throw " Get buffer error!";
                    if (TRACE)
                    {
                        fout<<"Router: Receive packet "<<count2<<" from peer host 2"<<endl;
                        cout<<"Router: Receive packet "<<count2<<" from peer host 2"<<endl;
                    }
                    temp.count=count2;
                    count2++;
                    temp.destination=1;
                }
                else continue;
                temp.len=recvlen;
                CurrentTime=GetTickCount();
                if(FileBuf.empty&&IsDelayed())      //if the packet is delayed.
                {
                    FileBuf=temp;
                    FileBuf.empty=false;
                    if (TRACE)
                    {
                        fout<<"Router: Packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1)<<" has been delayed!"<<endl;
                        cout<<"Router: Packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1)<<" has been delayed!"<<endl;
                    }
                }
                else if(IsDamage()) //if the packet is dropped: dropping packet by no forwarding the packet.
                {
                    if (TRACE)
                    {
                        fout<<"Router: Packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1)<<" has been dropped by router!"<<endl;
                        cout<<"Router: Packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1)<<" has been dropped by router!"<<endl;
                    }
                }
                else        //otherwise, packet is forwarded to destination
                {
                    if(temp.destination==1) //forward packets received from 2 to 1.
                    {
                        if(sendto(Sock1, temp.Buffer, temp.len,0,(SOCKADDR*)&sa_in_peer1,sizeof(sa_in_peer1))==SOCKET_ERROR)
                            throw "Send packet error!";
                        if (TRACE)
                        {
                            fout<<"Router: Send packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1) <<" to host "<<temp.destination<<endl;
                            cout<<"Router: Send packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1) <<" to host "<<temp.destination<<endl;
                        }
                        if(!FileBuf.empty&&FileBuf.destination==1)
                        {
                            wait_count=0;
                            SendProc();
                        }
                    }
                    else
                    {   //forward packets received from 1 to 2.
                        if(sendto(Sock2, temp.Buffer, temp.len,0,(SOCKADDR*)&sa_in_peer2,sizeof(sa_in_peer2))==SOCKET_ERROR)
                            throw "Send packet error1";
                        if (TRACE)
                        {
                            fout<<"Router: Send packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1) <<" to host "<<temp.destination<<endl;
                            cout<<"Router: Send packet "<<temp.count<<" received from peer host "<<(temp.destination==1?2:1) <<" to host "<<temp.destination<<endl;
                        }
                        if(!FileBuf.empty&&FileBuf.destination==2)
                        {
                            wait_count=0;
                            SendProc();
                        }
                    }
                }
            }
            else //If there is no incoming packet and there is a delayed packets storing in buffer for 3 cycle times (about 0.9 second), call SendProc to send delayed packet.
            {
                if(!FileBuf.empty)
                {
                    wait_count++;
                    if(wait_count>=3)
                    {
                        SendProc();
                        wait_count=0;
                    }
                }
            }
        } //end of try
        catch(char *str) {cerr<<str<<":"<<dec<<WSAGetLastError()<<endl;}
    }//end of while
};

//////////////////////////////////////////////////////////
//
//  Router::SendProc
//      Send delayed packets to the destinations.
//
//////////////////////////////////////////////////////////

void Router::SendProc()
{
    try
    {
        if(FileBuf.destination==1)
        {
            if(sendto(Sock1, FileBuf.Buffer, FileBuf.len,0,(SOCKADDR*)&sa_in_peer1,sizeof(sa_in_peer1))==SOCKET_ERROR)
                throw "Send packet error!";
        }
        else
        {
            if(sendto(Sock2, FileBuf.Buffer, FileBuf.len,0,(SOCKADDR*)&sa_in_peer2,sizeof(sa_in_peer2))==SOCKET_ERROR)
                throw "Send packet error!";
        }
        if (TRACE)
        {
            fout<<"Router: Send delayed packet "<<FileBuf.count<<" received from peer host "<<(FileBuf.destination==1?2:1)<<" to host "<<FileBuf.destination<<endl;
            cout<<"Router: Send delayed packet "<<FileBuf.count<<" received from peer host "<<(FileBuf.destination==1?2:1)<<" to host "<<FileBuf.destination<<endl;
        }
    }
    catch(char *str){cerr<<str<<":"<<dec<<WSAGetLastError()<<endl;}
    FileBuf.empty=true;
};

//////////////////////////////////////////////////////////
//
//  Router Destructor
//  arguements:
//      fn: A string of log file name
//
//////////////////////////////////////////////////////////

Router :: ~Router()
{
    closesocket(Sock1);
    closesocket(Sock2);

    /* When done, uninstall winsock.dll (WSACleanup()) and exit */
    WSACleanup();

    //close log file
    fout.close();
};

//////////////////////////////////////////////////////////
//
//  Main function
//
//////////////////////////////////////////////////////////

int main()
{
    Router router;
    router.Run();
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-07-04T12:57:00.030

“未定义的引用”错误是链接器错误。链接器错误无法通过包含其他头文件来解决。从概念上讲，头文件包含函数的声明（函数的名称、参数的类型、返回值的类型）。您包含头文件，以便您可以引用程序中头文件中声明的函数。在链接期间，这些引用被解析为指向包含这些函数的实际实现的库。

当您收到“未定义的引用”错误时，这意味着链接器无法在链接器被告知链接的任何库中找到您在代码中引用的函数的实现。为了解决这个问题，你必须找到实现缺失函数的库，并告诉编译器链接到这个库。

当我编译你的程序时，我得到以下错误：

```
error LNK2019: unresolved external symbol "___WSAFDIsSet@8" referenced in function ""public: void __thiscall Router::Run(void)" (?Run@Router@@QAEXXZ)".
error LNK2019: unresolved external symbol "__imp__bind@12" referenced in function "__catch$??0Router@@QAE@PBD@Z$0".
error LNK2019: unresolved external symbol "__imp__closesocket@4" referenced in function ""public: __thiscall Router::~Router(void)" (??1Router@@QAE@XZ)".
error LNK2019: unresolved external symbol "__imp__htonl@4" referenced in function "__catch$??0Router@@QAE@PBD@Z$0".
error LNK2019: unresolved external symbol "__imp__htons@4" referenced in function "__catch$??0Router@@QAE@PBD@Z$0".
error LNK2019: unresolved external symbol "__imp__recvfrom@24" referenced in function ""public: void __thiscall Router::Run(void)" (?Run@Router@@QAEXXZ)".
error LNK2019: unresolved external symbol "__imp__select@20" referenced in function ""public: void __thiscall Router::Run(void)" (?Run@Router@@QAEXXZ)".
error LNK2019: unresolved external symbol "__imp__sendto@24" referenced in function ""public: void __thiscall Router::Run(void)" (?Run@Router@@QAEXXZ)".
error LNK2019: unresolved external symbol "__imp__socket@12" referenced in function "__catch$??0Router@@QAE@PBD@Z$0".
error LNK2019: unresolved external symbol "__imp__gethostbyname@4" referenced in function "__catch$??0Router@@QAE@PBD@Z$0".
error LNK2019: unresolved external symbol "__imp__gethostname@8" referenced in function "__catch$??0Router@@QAE@PBD@Z$0".
error LNK2019: unresolved external symbol "__imp__WSAStartup@8" referenced in function ""public: __thiscall Router::Router(char const *)" (??0Router@@QAE@PBD@Z)".
error LNK2019: unresolved external symbol "__imp__WSACleanup@0" referenced in function ""public: __thiscall Router::~Router(void)" (??1Router@@QAE@XZ)".
error LNK2019: unresolved external symbol "__imp__WSAGetLastError@0" referenced in function "__catch$??0Router@@QAE@PBD@Z$0". 
```

我们现在必须识别定义这些符号的库。将他们的名字放入搜索引擎告诉我他们都是 winsocket2 API 的一部分。[此处](https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-socket)给出的示例告诉我们调用了相应的库`Ws2_32.lib`。

我们现在必须告诉编译器链接到这个库。具体步骤取决于您的编译器/IDE。您表示您正在使用 Code::Blocks。请参阅[此处](https://stackoverflow.com/questions/5862757/how-do-i-link-to-a-library-with-codeblocks)给出的关于如何在 Code::Blocks 中添加库的说明（似乎 Code::Blocks 想要不带`.lib`后缀的库名称，因此名称将是`Ws2_32`，而不是`Ws2_32.lib`）。

链接到此库后，您的代码将成功编译。

# iphone - 移除前一个视图，只显示 xcode 中的当前视图

> ID：13086890
> 
> 赞同：0
> 
> 时间：2012-10-26T12:25:15.350
> 
> 标签：iphone, xcode4

我是 iphone 编程新手，不明白我哪里出错了。

如何仅显示当前视图并删除所有其他视图？因为当我单击其中一个选项卡栏项来加载一个`newview`时，它会`prevoiusview`在背景中显示并在其顶部显示视图。因此，屏幕看起来很模糊。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:36:25.443

在添加新视图之前使用它：

```
for (UIView *subview in [self.view subviews]) {
    [subview removeFromSuperview];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:39:57.560

如果您在`UIView`每次`UITabBar`执行操作时都创建。

```
[view removeFromSuperview]; 
```

如果要删除 self.view 中所有添加的项目

```
for (id view in self.view) {
    [view removeFromSuperview];
} 
```

否则使用

```
view.hidden=TRUE; 
```

# java - 访问被其他线程修改的 Set

> ID：13086891
> 
> 赞同：1
> 
> 时间：2012-10-26T12:25:16.830
> 
> 标签：java, multithreading, thread-safety, thread-synchronization

有`ExecutorService`3 个线程，每个线程将`Pair<String,Integer>`对象添加到`TreeSet<Pair<String,Integer>>`. 声明了 addToSet() 方法`synchronized`，一切正常。但是我必须实现一个新线程来执行一个计划任务，该任务必须访问这个 Set 并打印所有值。问题是有时计划的线程会崩溃（其他线程工作正常）。我认为它崩溃是因为在打印机的 for 循环（计划线程）期间其他 3 个线程正在修改 Set。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:31:41.390

`addToSet`您需要在方法和打印所有值的方法之间互斥。一种方法：

```
Object setLock = new Object(); // Put this in a scope where all threads can access it

void addToSet( T element ){
    synchronized(setLock) {
       //add it
   }
}

void printAllValues(){
   synchronized(setLock) {
       //print the values
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:32:05.497

实现这一点的最安全方法是在同步上下文中创建该集合的防御性副本，并将其用于其他进程。

粗略地说：

```
public void run() {
    TreeSet<...> localSet;
    synchronized (commonSet ) {
        localSet = new TreeSet(commonSet);
    }
    doStuff(localSet);
    ...
} 
```

请注意，这并不能解决对集合中对象的并发访问（如果这些对象是可变的。）

# internet-explorer - 如何在 Xbox 上调试 IE

> ID：13086900
> 
> 赞同：4
> 
> 时间：2012-10-26T12:26:06.700
> 
> 标签：internet-explorer, debugging, web, xbox

为一家提供基于 Web 的解决方案的公司工作，我们热衷于让我们的网站在 xbox 上的 Internet Explorer 上运行。我们的网站可以在 IE6 - 10 以及其他主要浏览器上运行，但它不适用于 xbox 的解决方案。

它使用**JS**和**ExtJS**以及在 xbox 上运行的示例。我们假设这个版本的 IE 只是破坏了一些小东西，并且想要简单地调试它以识别问题。

有谁知道如何调试此设备的 IE 版本/或如何模拟此版本的 IE？

与此问题相关的两个 Microsoft 支持服务在其当前的知识库中都没有对此的答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-10T01:06:42.687

我很幸运地将调试日志信息写入 Firebase ( [http://www.firebase.com/](http://www.firebase.com/) )。一些类似的解决方案（使用基于 JavaScript 的库从 Xbox 向某些远程机器发送文本调试信息）应该可以工作 - 我使用 Firebase，因为它相对简单而且我熟悉它。

这显然是一种奇怪的 Firebase 使用方式，也是一个非常蹩脚的调试过程。我编写调试日志代码，将我的项目的新版本上传到公共服务器，在 Xbox 上重新加载，使用 Firebase 数据调试器观察输出，进行更改，然后重复。

有时，我所做的更改以一种停止执行代码的方式破坏了页面，并且我没有得到任何调试数据，所以我必须小心地退后一步，弄清楚我做了什么。有时在我犯了错误之后，似乎有必要在 Xbox 上退出并重新加载 IE 以强制加载新页面。

但它的工作时间足够有用，除了猜测错误是什么之外，我还没有找到更好的解决方案。

一般来说，Xbox 360 上的 IE 应该表现得像 IE 9，并且您应该能够使用 IE 9 来测试发往 Xbox 的内容。但显然存在差异。以下是我学到的一些东西，其中一些是通过反复试验：

不支持：

*   console.log() （调用它会杀死你的脚本执行）
*   迅速的（）
*   插件、flash、ActiveX 控件等。

支持的：

*   JavaScript
*   一些 HTML5，包括 Canvas .. 但不是本地存储？

它可以帮助调试检查 navigator.userAgent 字符串，该字符串将包含子字符串“Xbox”。我最后一次检查时，我看到“5.0（兼容；MSIE 9.0；Windows NT 6.1；Trident/5.0；Xbox）”。

谁告诉你 Xbox 上的 IE 不支持 JavaScript，你会感到困惑。它工作正常。

我很想听听一些更好的调试技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-11T09:05:32.660

谢谢大家的回复。

我现在得到了微软的答复（一年后超过 1/2）

[http://msdn.microsoft.com/en-us/library/ie/jj883728(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/jj883728(v=vs.85).aspx)

这为您提供了很多关于 IE 上的 xbox 的信息，但是虽然调试设置快速且有点用处，但它并没有给出所有错误。

最初在 IE9 中尝试 - 但是 xbox 360 类似...

不支持：

console.log() （调用它会杀死你的脚本执行） prompt() 插件、flash、ActiveX 控件等。

支持的：

JavaScript

HTML5（遵循 IE10 中的标准）

如果有人提出更好的解决方案，请告诉我！

詹姆士

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T12:37:20.797

有关 Xbox 的调试信息，请转到此处

[Xbox 调试](http://msdn.microsoft.com/en-us/library/bb199628.aspx)

就在 xbox 上调试 Internet Explorer 而言，这不是我尝试过的事情，没有我的 xbox 我无法尝试这个。

搜索一下，通常这样的事情并不主要出现在 Microsoft 网站上，而是用户在网络上其他地方创建的解决方案

# django - Django CMS + Django 评论 = 404

> ID：13086901
> 
> 赞同：-2
> 
> 时间：2012-10-26T12:26:08.087
> 
> 标签：django, django-cms

我是 Django 1.4.2 的新手用户。我已经玩了几个星期，但我一直卡在同一点：如果我转到预设的网址，则会出现 404 ......

URLS.PY：

```
from django.conf.urls.defaults import *
from django.contrib import admin
from django.conf import settings

admin.autodiscover()

urlpatterns = patterns('',
    (r'^admin/', include(admin.site.urls)),
    url(r'^', include('cms.urls')),
    (r'^comments/', include('django.contrib.comments.urls')),
)

if settings.DEBUG:
    urlpatterns = patterns('',
    url(r'^media/(?P<path>.*)$', 'django.views.static.serve',
    {'document_root': settings.MEDIA_ROOT, 'show_indexes': True}),
    url(r'', include('django.contrib.staticfiles.urls')),
) + urlpatterns    # Example: 
```

我已经多次关注 Django CMS 和其他一些插件，但是当我想预览一个 url 时，我一直收到 404 错误。在这种情况下，我已经成功安装了 Django 评论，我可以创建评论（在后端），但如果我想在前端预览它们...404。我的 URLS.PY 有问题吗？

```
example.com/en/comments -> 404 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:27:21.577

Did you try:

```
urlpatterns = patterns('',
    (r'^admin/', include(admin.site.urls)),
    (r'^comments/', include('django.contrib.comments.urls')),
    url(r'^', include('cms.urls')),
) 
```

?

'example.com/comments/' should work. If you get the same error make sure you have 'django.contrib.comments' added to INSTALLED_APPS in your settings.py file. You may also run 'manage.py syncdb' in order for the tables related to the 'comments' app to be created.

Where the 'en/' comes from anyway? Is it a hard-coded URL in your app page or is it inserted by you manually?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:10:05.900

简单的问题：您在 URL conf 中的任何地方看到`en`或类似的东西吗？`(?P<language>...)`那你为什么期望你会得到除了 404 之外的任何东西`/en/comments/`？

此外，在 (root) 处包含 Django CMS url`^$`本质上会将所有 URL 处理传递给它的 urls.py，因此在此之后添加到 urls.py 的任何内容都将被忽略。如果你想包含别的东西，它必须在 urls.py*之前*，然后它将在你指定的 urlpattern 中可用，在这种情况下，只是`/comments/`，不是`/en/comments/`。

# iphone - 如何在 MobileSubstrate 中连接 UIApplicationDelegate

> ID：13086902
> 
> 赞同：1
> 
> 时间：2012-10-26T12:26:14.047
> 
> 标签：iphone, ios, hook

我想挂机`UIApplicationDelegate:applicationDidEnterBackground`，但系统找不到并安装这个挂机。

**我的代码如下：**

```
IMP original_UIApplicationDelegate_applicationDidEnterBackground;
void replaced_UIApplicationDelegate_applicationDidEnterBackground(UIApplicationDelegate * self,SEL cmd, UIApplication *application)
{
    NSLog(@"==========applicationDidEnterBackground==========");
    original_UIApplicationDelegate_applicationDidEnterBackground(self, cmd, application);    
} 
```

然后我打电话`MSHookMessageEx()`安装它。但是，它不起作用。

# php - $_FILES Empty - 扯掉我的头发

> ID：13086903
> 
> 赞同：0
> 
> 时间：2012-10-26T12:26:16.170
> 
> 标签：php, linux, whm

有一个表格工作正常（现在仍然如此），但超过一定大小的文件只是在空的 $_FILES 上失败。

我可以上传 10Mb、60Mb 甚至 101MB 的文件，但我真正想要上传的文件是 120MB，而且上传失败，$_FILES 为空。

```
The php.ini are set:
file_uploads = On
post_max_size = 750M
upload_max_filesize = 500M
max_execution_time = 500
include_path = .:/usr/local/lib/php
auto_prepend_file = config.php 
```

但是最大的文件就失败了。我读过我的 /tmp 目录可能已满，但唯一的 /tmp 目录与 public_html 位于同一目录中，除了 awstats 和 webalizer 之外，这个目录并没有太多内容。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:31:15.913

检查此设置`max_input_time`。它限制了脚本解析数据的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:46:56.587

有人说你`memory_limit`也需要提高。

应该高于`upload_max_filesize`。

如果您正在运行 suhosin，还有一些选项`suhosin.memory_limit`：`suhosin.post.max_value_length`

此外还有`max_input_time`选项。

也可能有一些代理，如 nginx 或 varnish，它们会阻止上传如此大的文件。

最后在 Apache 中有一个指令：`LimitRequestBody`

而对于 mod_fastcgi: `FcgidMaxRequestLen`,`FcgidConnectTimeout`

您还可以尝试使用 APC 和一些 AJAX 驱动的进度条监控您的上传：[http ://www.phpriot.com/articles/php-ajax-file-uploads/3](http://www.phpriot.com/articles/php-ajax-file-uploads/3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:52:58.777

您是否在输入文件上传 html 表单中使用“MAX_FILE_SIZE”隐藏字段？

如果使用，请检查此问题。

[http://www.php.net/manual/en/features.file-upload.php#74692](http://www.php.net/manual/en/features.file-upload.php#74692)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-26T12:28:54.797

在你的 php.ini 中设置这些：

```
upload_max_filesize = 10M
post_max_size = 10M 
```

并检查

```
memory_limit 
```

高于 post_max_size

# android - 我的 android 应用程序中的谷歌地图无法正常工作

> ID：13086904
> 
> 赞同：-2
> 
> 时间：2012-10-26T12:26:19.180
> 
> 标签：android, google-maps

我使用 android google map 创建了应用程序，但它不能在我的机器上运行，但它可以在其他机器上运行，我认为这是 google map api 密钥的问题，我该如何解决这个问题，我是 android 新手。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T12:39:24.120

请关注此[链接](http://mobiforge.com/developing/story/using-google-maps-android)

在上面的文章中提到

```
keytool.exe -list -alias androiddebugkey -keystore "C:\android\debug.keystore" -storepass android -keypass android 
```

相应地更改您的密钥库的路径。

生成 MD5 指纹。复制 MD5 密钥并转到下面的链接。

[http://code.google.com/android/maps-api-signup.html](http://code.google.com/android/maps-api-signup.html)

传递该 MD5 密钥并生成映射密钥。

使用生成的地图键。

然后工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:28:58.960

API 密钥由 Google maps API 根据您提交的 MD5 密钥提供。此密钥是每台机器单独的，因此要显示地图，您必须通过提交机器的 MD5 密钥来获取新 API

# api - 从短网址获取 flickr 图像

> ID：13086907
> 
> 赞同：0
> 
> 时间：2012-10-26T12:26:39.647
> 
> 标签：api, flickr

例如，如果您有以下简短的 flickr 网址： http: [//flic.kr/p/dnUvGp](http://flic.kr/p/dnUvGp)

如何获取链接共享的图片的图片 url？（不发送多个请求）

对于 instagram，您只需添加`media/?size=l`到 url，即可获得图像。flickr 有这样的技巧而不是使用 API 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:40:20.873

短照片id是照片id的base58转换，但不包括照片拥有者。因此，虽然您可以计算短链接，但给定一个长链接，如果不通过 API（或 URL 重定向），反之则不成立。

# c# - 谷歌自定义搜索 api c#

> ID：13086910
> 
> 赞同：1
> 
> 时间：2012-10-26T12:26:51.873
> 
> 标签：c#, web-services, google-api

`WebClient.Downloadstring(MYURL)`我有用于获取 Google 页面的ac#网络服务。

MYURL 等于：

> [http://www.google.co.uk/search?q=mystringtosearch&as_qdr=all&num=100&start=0](http://www.google.co.uk/search?q=mystringtosearch&as_qdr=all&num=100&start=0)

它工作正常，直到我`503`从谷歌那里得到错误，因为它是一个机器人。然后我被送到这里：

> [https://developers.google.com/custom-search/v1/overview](https://developers.google.com/custom-search/v1/overview)

并得到了一把钥匙。现在它说我需要做的就是添加`&key`参数。但是，当我将其作为 MYURL 时，我仍然会得到一个`503`

> [http://www.google.co.uk/search?q=mystringtosearch&key=1234567890&as_qdr=all&num=100&start=0](http://www.google.co.uk/search?q=mystringtosearch&key=1234567890&as_qdr=all&num=100&start=0)

Google API 控制台说我没有进行任何搜索，所以我知道我没有超过我的配额。

这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:39:04.103

您需要在 URL 中包含您的自定义搜索引擎 ID。如文档所述，这就是该`cx`参数的用途。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:38:00.610

您确定您使用的是正确的网址吗？你我的 url 不是 customsearch api 的 url？

如果您查看自定义搜索的文档是这样的： [https ://developers.google.com/custom-search/v1/using_rest?hl=tr](https://developers.google.com/custom-search/v1/using_rest?hl=tr)

yuo 可以通过向其 URI 发送 HTTP GET 请求来检索特定搜索的结果。搜索的 URI 具有以下格式：

[https://www.googleapis.com/customsearch/v1?parameters](https://www.googleapis.com/customsearch/v1?parameters)

文档有更多信息

# c - 为什么必须在套接字函数中传递 sizeof？

> ID：13086915
> 
> 赞同：3
> 
> 时间：2012-10-26T12:27:07.280
> 
> 标签：c, sockets

我正在研究 C 中的套接字编程，我很好奇为什么你必须在和之类的函数中传递一个参数和**该**参数的长度？为什么不只在函数内部使用？`bind()``connect()``sizeof()`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T12:29:10.927

因为它提供了一种简单的方法来使用相同的 API 处理许多不同类型的协议。

由于套接字可以使用许多不同的底层协议（正如@larsman 所指出的那样），因此调用无法确切地知道它正在处理哪种类型的结构。各种类型都有一些基本的“继承” `struct sockaddr`。

此外，它提供了一些前向兼容性；针对库的一个版本编译的二进制文件可能会针对更高版本运行，其中地址类型可能已经增长（例如支持 IPv6）。

通过将*调用者的*大小想法传递给被调用函数，被调用函数可以注意不要覆盖内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T12:29:48.230

我想你的第三个论点

```
int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen); 
```

你不能`sizeof(addr)`在函数内部做，因为那只会返回指针的大小，而不是指向的结构。`sizeof(struct sockaddr)`也不会起作用，因为不同的地址系列（本地套接字、IPv4、IPv6、外来网络协议）具有不同大小`sockaddr`的类型。

例如，对于 IPv4 套接字，您调用

```
struct sockaddr_in my_addr;
// set up my_addr
bind(fd, (struct sockaddr *)my_addr, sizeof(struct sockaddr_in)); 
```

但是对于本地（Unix）域套接字，您传递的`sockaddr_un`a 可能具有不同的长度。

[在我的 Linux 机器上，`sizeof(struct sockaddr_in) == 16`但是`sizeof(struct sockaddr_un) == 110`。]

如果您习惯于面向对象编程，那么您可以将`sockaddr`族视为具有动态类型的（浅）类层次结构。`struct sockaddr`是抽象基类，`bind`,`connect`等是方法。由于 C 没有内置的动态类型，因此必须对其进行模拟，并且传递结构的大小是其中的一部分。

# java - 倒计时栏android示例

> ID：13086921
> 
> 赞同：2
> 
> 时间：2012-10-26T12:27:33.760
> 
> 标签：java, android

在进度条上显示这个简单的倒计时有什么帮助吗？

```
new CountDownTimer(30000, 1000) {

 public void onTick(long millisUntilFinished) {
     mTextField.setText("seconds remaining: " + millisUntilFinished / 1000);
 }

 public void onFinish() {
     mTextField.setText("done!");
 }

 }.start(); 
```

[http://developer.android.com/reference/android/os/CountDownTimer.html](http://developer.android.com/reference/android/os/CountDownTimer.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:40:42.580

您可以尝试这种替代方式，我在学习进度条时创建了它，

主.xml，

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <Button android:text="@string/Button02Text" android:id="@+id/Button02"
        android:layout_width="fill_parent" android:layout_height="wrap_content">
    </Button>
</LinearLayout> 
```

进度条活动，

```
public class ProgressBarExampleActivity extends Activity 
{
    ProgressThread progThread;
    ProgressDialog progDialog;
    Button button1, button2;
    int typeBar;                     // Determines type progress bar: 0 = spinner, 1 = horizontal
    int delay = 1000;                  // Milliseconds of delay in the update loop
    int maxBarValue = 30;           // Maximum value of horizontal progress bar

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Process button to start horizontal progress bar dialog with anonymous inner class
        button2 = (Button) findViewById(R.id.Button02);
        button2.setOnClickListener(new OnClickListener()
        {
            public void onClick(View v) 
            {
                typeBar = 1;
                showDialog(typeBar);
            }
        }); 
    }

    // Method to create a progress bar dialog of either spinner or horizontal type
    @Override
    protected Dialog onCreateDialog(int id) 
    {
        switch(id) 
        {
        case 1:                      // Horizontal
            progDialog = new ProgressDialog(this);
            progDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
            progDialog.setMax(maxBarValue);
            progDialog.setMessage("Dollars in checking account:");
            progThread = new ProgressThread(handler);
            progThread.start();
            return progDialog;
        default:
            return null;
        }
    }

    // Handler on the main (UI) thread that will receive messages from the 
    // second thread and update the progress.

    final Handler handler = new Handler() 
    {
        public void handleMessage(Message msg) 
        {
            // Get the current value of the variable total from the message data
            // and update the progress bar.
            int total = msg.getData().getInt("total");
            progDialog.setProgress(total);
//          if (total >= maxBarValue)
            if (total <= 0 )            
            {
                dismissDialog(typeBar);
                progThread.setState(ProgressThread.DONE);
            }
        }
    };

    // Inner class that performs progress calculations on a second thread.  Implement
    // the thread by subclassing Thread and overriding its run() method.  Also provide
    // a setState(state) method to stop the thread gracefully.

    private class ProgressThread extends Thread 
    {   
        // Class constants defining state of the thread
        final static int DONE = 0;
        final static int RUNNING = 1;

        Handler mHandler;
        int mState;
        int total;

        // Constructor with an argument that specifies Handler on main thread
        // to which messages will be sent by this thread.

        ProgressThread(Handler h) 
        {
            mHandler = h;
        }

        // Override the run() method that will be invoked automatically when 
        // the Thread starts.  Do the work required to update the progress bar on this
        // thread but send a message to the Handler on the main UI thread to actually
        // change the visual representation of the progress. In this example we count
        // the index total down to zero, so the horizontal progress bar will start full and
        // count down.

        @Override
        public void run() 
        {
            mState = RUNNING;   
            total = maxBarValue;
            while (mState == RUNNING) 
            {
                // The method Thread.sleep throws an InterruptedException if Thread.interrupt() 
                // were to be issued while thread is sleeping; the exception must be caught.
                try 
                {
                    // Control speed of update (but precision of delay not guaranteed)
                    Thread.sleep(delay);
                } catch (InterruptedException e) {
                    Log.e("ERROR", "Thread was Interrupted");
                }

                // Send message (with current value of  total as data) to Handler on UI thread
                // so that it can update the progress bar.

                Message msg = mHandler.obtainMessage();
                Bundle b = new Bundle();
                b.putInt("total", total);
                msg.setData(b);
                mHandler.sendMessage(msg);

                total--;    // Count down
            }
        }

        // Set current state of thread (use state=ProgressThread.DONE to stop thread)
        public void setState(int state) 
        {
            mState = state;
        }
    }
} 
```

# c# - 父对象位于 EntityState.Unchanged 中，但仍插入到数据库中

> ID：13086922
> 
> 赞同：13
> 
> 时间：2012-10-26T12:27:43.970
> 
> 标签：c#, entity-framework, entity-relationship

我有一个简单的雪花模式，从中生成了我的实体框架模型。
问题是我试图将子实体映射到***现有的父实体和/或祖父***实体，但它仍然插入它。

*我跟着这个：*

> [使用现有对象插入新对象](https://stackoverflow.com/questions/5416323/insert-new-object-with-existing-object)
> [阻止实体框架插入导航属性的值](https://stackoverflow.com/questions/7884887/prevent-entity-framework-to-insert-values-for-navigational-properties)

有趣的是，即使父实体的 EntityState 是“未更改”，实体框架仍会尝试插入它。

* * *

## 架构

![在此处输入图像描述](../Images/c57199a43da5cf6dc38db24c25c8ea3b.png)

* * *

## CarRepository.Save() 方法

```
public void Save(Car car)
    {
        using (DBContext context = new DBContext())
        {
            // No need to save if it already exists
            if ( context.Cars.FirstOrDefault(x => x.RegistrationNumber == car.RegistrationNumber) != null)
            {
                return;
            }
            else
            {
                // Check if the parent POCOs exist in the DB. 
                Model existingModel = context.Models.FirstOrDefault(x => x.Name == car.Model.Name);
                Manufacturer existingManufacturer = context.Manufacturers.FirstOrDefault(x=> x.Name == car.Model.Manufacturer.Name)
                Trader existingTrader = context.Traders.FirstOrDefault(x=> x.Name == car.Trader.Name)
                TraderCompany existingTraderCompany = context.TraderCompanys.FirstOrDefault(x=> x.Name == car.Trader.TraderCompany.Name)

                context.ContextOptions.LazyLoadingEnabled = false;

                //Attach to the context if existing in the DB, i.e mark the existing POCOs not to be added the DB
                if (existingModel != null)
                {
                    car.Model = existingModel;
                    Assert.IsTrue(context.ObjectStateManager.GetObjectStateEntry(car.Model).State == EntityState.Unchanged);
                }

                if (existingManufacturer != null)
                {
                    car.Model.Manufacturer = existingManufacturer;
                    Assert.IsTrue(context.ObjectStateManager.GetObjectStateEntry(car.Model.Manufacturer).State == EntityState.Unchanged);
                }

                if (existingTrader != null)
                {
                    car.Trader = existingTrader;
                    Assert.IsTrue(context.ObjectStateManager.GetObjectStateEntry(car.Trader).State == EntityState.Unchanged);
                }

                if (existingTraderCompany != null)
                {
                    car.Trader.TraderCompany = existingTraderCompany;
                    Assert.IsTrue(context.ObjectStateManager.GetObjectStateEntry(car.Trader.TraderCompany).State == EntityState.Unchanged);
                }

                //Mark the Car for Addition to the DB
                context.Cars.AddObject(car);
                context.ObjectStateManager.ChangeObjectState(car, EntityState.Added);

                //If the POCOs do not exist in the DB mark them for addition
                if (existingModel == null)
                {
                   context.ObjectStateManager.ChangeObjectState(car.Model,EntityState.Added);
                }

                if (existingManufacturer == null)
                {
                    context.ObjectStateManager.ChangeObjectState(car.Model.Manufacturer,EntityState.Added);
                }

                if (existingTrader == null)
                {
                    context.ObjectStateManager.ChangeObjectState(car.Trader,EntityState.Added);
                }

                if (existingTraderCompany == null)
                {
                    context.ObjectStateManager.ChangeObjectState(car.Trader.TraderCompany,EntityState.Added);
                }

                context.SaveChanges();

            }
        }
    } 
```

* * *

## 编辑：

经过几天的修补，我设法想出了一个对我有用的***解决方法***。

似乎正在传递给 CarRepository.Save() 的 Car 具有某种***无法检测到的******内部上下文***......既然如此，就不可能***将其与该上下文分离并将***其添加到CarRepository.Save()。为了将其实际添加到此上下文中*，我深度/延迟复制 Car 对象及其导航属性*（如果存在）。

 **** * *

## 解决方法

```
public void Save(Car car)
{
    using (DBContext context = new DBContext())
    {
        // No need to save if it already exists
        if ( context.Cars
                    .Any(x => x.RegistrationNumber == car.RegistrationNumber))
        {
            return;
        }
        else
        {
            //Assign scalar properties to the deep copy
            Car carToBeSaved = new Car 
            {
                carToBeSaved.RegistrationNumber = car.RegistrationNumber,
                carToBeSaved.Price = car.Price
            }

            //Car -> Trader -> ...
            if(car.Trader != null)
            {   
                Trader existingTrader = 
                    context.Traders
                           .FirstOrDefault(x => x.Name == car.Trader.Name);

                //If exists in DB assign, if not deep copy
                carToBeSaved.Trader = existingTrader ??
                    new Trader
                    {
                        Name = car.Trader.Name,
                        JobTitle = car.Trader.JobTitle
                    }

                //Car -> Trader -> TraderCompany
                if(car.Trader.TraderCompany != null)
                {
                    TraderCompany existingTraderCompany = 
                        context.TradersCompanys
                               .FirstOrDefault(x => x.Name == car.Trader
                                                                 .TraderCompany
                                                                 .Name);

                    //If exists in DB assign, if not deep copy  
                    carToBeSaved.Trader.TraderCompany = existingTraderCompany ??
                        new TraderCompany
                        {
                            Name = car.Trader.TraderCompany.Name,
                            Address = car.Trader.TraderCompany.Address,
                            PhoneNumber = car.Trader.TraderCompany.PhoneNumber
                        }
                }
            }

            //Car -> Model -> ...
            if(car.Model != null)
            {   
                Model existingModel = 
                    context.Models
                           .FirstOrDefault(x => x.Name == car.Model.Name);

                //If exists in DB assign, if not deep copy
                carToBeSaved.Model = existingModel ??
                    new Model
                    {
                        Name = car.Model.Name
                    }

                //Car -> Model -> Manufacturer
                if(car.Model.Manufacturer != null)
                {
                    Manufacturer existingManufacturer = 
                        context.Manufacturers
                               .FirstOrDefault(x => x.Name == car.Model
                                                                 .Manufacturer
                                                                 .Name);

                    //If exists in DB assign, if not deep copy
                    carToBeSaved.Model.Manufacturer = existingManufacturer ??
                    new Manufacturer
                        {
                            Name = car.Model.Manufacturer.Name
                        }
                }
            }

            //Mark the Car for Addition to the DB
            context.Cars.AddObject(car);
            context.SaveChanges();

        }
    }
} 
```

*如果有人对此有任何想法，请分享。*

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-08T18:20:18.143

我发现解决此类问题的最可靠方法是使用现有对象的 Id 而不是关联实体实例。因此，在找到现有交易者后，您可以像这样为交易者设置“外来”键：

```
car.TraderId = existingTrader.Id; 
```

有一段时间这对我来说似乎是一种 hack，但在 2013 年 4 月的 MSDN 杂志中，我读到 Julie Lerman 也推荐这种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T09:18:59.200

经过几天的修补，我设法想出了一个对我有用的***解决方法***。

似乎正在传递给 CarRepository.Save() 的 Car 具有某种***无法检测到的******内部上下文***......既然如此，就不可能***将其与该上下文分离并将***其添加到CarRepository.Save()。为了将其实际添加到此上下文中*，我深度/延迟复制 Car 对象及其导航属性*（如果存在）。

 **** * *

## 解决方法

```
public void Save(Car car)
{
    using (DBContext context = new DBContext())
    {
        // No need to save if it already exists
        if ( context.Cars
                    .Any(x => x.RegistrationNumber == car.RegistrationNumber))
        {
            return;
        }
        else
        {
            //Assign scalar properties to the deep copy
            Car carToBeSaved = new Car 
            {
                carToBeSaved.RegistrationNumber = car.RegistrationNumber,
                carToBeSaved.Price = car.Price
            }

            //Car -> Trader -> ...
            if(car.Trader != null)
            {   
                Trader existingTrader = 
                    context.Traders
                           .FirstOrDefault(x => x.Name == car.Trader.Name);

                //If exists in DB assign, if not deep copy
                carToBeSaved.Trader = existingTrader ??
                    new Trader
                    {
                        Name = car.Trader.Name,
                        JobTitle = car.Trader.JobTitle
                    }

                //Car -> Trader -> TraderCompany
                if(car.Trader.TraderCompany != null)
                {
                    TraderCompany existingTraderCompany = 
                        context.TradersCompanys
                               .FirstOrDefault(x => x.Name == car.Trader
                                                                 .TraderCompany
                                                                 .Name);

                    //If exists in DB assign, if not deep copy  
                    carToBeSaved.Trader.TraderCompany = existingTraderCompany ??
                        new TraderCompany
                        {
                            Name = car.Trader.TraderCompany.Name,
                            Address = car.Trader.TraderCompany.Address,
                            PhoneNumber = car.Trader.TraderCompany.PhoneNumber
                        }
                }
            }

            //Car -> Model -> ...
            if(car.Model != null)
            {   
                Model existingModel = 
                    context.Models
                           .FirstOrDefault(x => x.Name == car.Model.Name);

                //If exists in DB assign, if not deep copy
                carToBeSaved.Model = existingModel ??
                    new Model
                    {
                        Name = car.Model.Name
                    }

                //Car -> Model -> Manufacturer
                if(car.Model.Manufacturer != null)
                {
                    Manufacturer existingManufacturer = 
                        context.Manufacturers
                               .FirstOrDefault(x => x.Name == car.Model
                                                                 .Manufacturer
                                                                 .Name);

                    //If exists in DB assign, if not deep copy
                    carToBeSaved.Model.Manufacturer = existingManufacturer ??
                    new Manufacturer
                        {
                            Name = car.Model.Manufacturer.Name
                        }
                }
            }

            //Mark the Car for Addition to the DB
            context.Cars.AddObject(car);
            context.SaveChanges();

        }
    }
} 
```

*如果有人对此有任何想法，请分享。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:50:39.923

我认为你有以下问题：

如果您将模型设置为*existingModel*像这里

```
if (existingModel != null)
{
    car.Model = existingModel;
    Assert.IsTrue(context.ObjectStateManager.GetObjectStateEntry(car.Model).State == EntityState.Unchanged);
} 
```

然后 ObjectStateManager 检测到汽车是新的，并自动将其添加到您的上下文中。因此，EF 检测到例如预设的*car.Trader*是未知的（意味着新的）并添加它。等等。

这就是为什么这些无论如何都会被保存的原因。******

# ios - iOS钥匙串：找不到值

> ID：13086923
> 
> 赞同：0
> 
> 时间：2012-10-26T12:27:45.450
> 
> 标签：ios, sfhfkeychainutils

我在具有旧版本项目的设备上的钥匙串中写了一些东西；然后，我想用新版本恢复它 - 但我没有得到任何价值。

我正在做同样的事情，我使用相同的配置文件，捆绑标识符......我的新项目版本没有获得价值的原因可能是什么？查询是完全相同的（使用 SFHFKeychainUtils）：

```
(NSMutableDictionary *) $17 = 0x00982fd0 {
    acct = "com.abc.def.ghi.jkl.1";
    class = genp;
    svce = "SOME-THING";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T11:02:43.253

我认为 SFHFKeychainUtils 与代码签名证书相关联，您应该再次检查代码签名标识和配置文件。

# unity-container - Unity 2.0：为什么 BuildUp() 检查构造函数？

> ID：13086924
> 
> 赞同：2
> 
> 时间：2012-10-26T12:27:47.053
> 
> 标签：unity-container, instance, code-injection

有人可以帮我解决这个问题吗？

我正在尝试添加具有两个构造函数和依赖项的类 SeviceImpl 的实例。

下面是我得到的。

*   在变体 A 中，统一不会注入依赖关系。我以为会的。
*   在 Variant BI 中，不明白为什么 BuildUp() 方法需要在对象已经存在时检查构造函数？为什么它不能只注入依赖项？

    ```
    public interface IService
    {
        void Run();
    }

    public class Database
    {
    }

    public class ServiceImpl : IService
    {
        public ServiceImpl(int i)
        {}

        public ServiceImpl(bool b)
        { }

        [Dependency]
        public Database Db { get; set; }

        public void Run()
        {}
    }

     public static void Main()
     {
            using (var unity = new UnityContainer())
            {
                unity.RegisterInstance<Database>(new Database());

                // Now I want to register an instance of ServiceImpl

                // Variant A

                unity.RegisterInstance<IService>(new ServiceImpl(3));
                var srv = unity.Resolve<IService>();
                // srv.Db is null which is bad
                unity.BuildUp(srv); // Doesn't throw an exception
                // srv.Db is still null

                // Variant B

                var srv = new ServiceImpl(3);
                // Hoping this call will inject Database
                unity.BuildUp(srv); // Now it does: InvalidOperationException - The type ServiceImpl has multiple constructors of length 1\. Unable to disambiguate.
                unity.RegisterInstance<IService>(srv);
            }
     } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:58:12.373

在变体 A 中，您正在注册一个现有实例，因此容器不会尝试注入任何额外的依赖项。

在变体 B 中，容器创建一个委托来创建一个实例并注入依赖项。此委托用于创建新实例或在新实例上注入依赖项，因此如果容器无法确定如何创建实例，它将失败。您可能会争辩说，如果容器用于创建实例，则应将委托设置为 throw，但仍允许构建而不是无法创建委托，但这就是今天的工作方式。

您可以通过注册类型以使用特定构造函数创建实例来解决此问题，但如果您不希望容器创建此类型的新实例，而只是构建现有实例，则这可能不合适。

```
unity.RegisterType<ServiceImpl>(new InjectionConstructor(false)); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-03-31T13:34:11.383

@fsimonazzi 的方法有效，但统一会调用`CreatePlan`：

```
IBuildPlanPolicy CreatePlan(IBuilderContext context, NamedTypeBuildKey buildKey) 
```

之后`RegisterType`。这是一个繁重的操作。

# powershell - 使用 $site | Set-Item 不会将更改保存回 IIS 站点

> ID：13086926
> 
> 赞同：8
> 
> 时间：2012-10-26T12:27:49.840
> 
> 标签：powershell, iis-7, powershell-2.0

我正在编写一些自动化脚本以使用 PowerShell 在服务器上创建/更新 IIS 站点。

目的是拥有一个配置对象，然后可以由单个脚本处理以完成所有繁重的工作。

我的配置`HashTable`如下所示：

```
$config = @{
    AppPools = (
        @{
            Name="AppPool1"
            Properties = @{
                Enable32BitAppOnWin64=$true
                ManagedRuntimeVersion="v4.0"
                ProcessModel = @{
                    IdentityType = "NetworkService"
                }
            }
        }
    )
    Websites = (
        @{
            Name="Site1"
            Properties = @{
                PhysicalPath = "C:\sites\site1"
                ApplicationPool = "AppPool1"
            }
        }
    )    
} 
```

然后我的脚本使用配置来处理每个应用程序池和网站：

```
 Import-Module WebAdministration

 $config.AppPools | 
    % {
        $poolPath = "IIS:\AppPools\$($_.Name)"

        # Create if not exists
        if(-not(Test-Path $poolPath)){ New-WebAppPool $_.Name }            

        # Update the properties from the config
        $pool = Get-Item $poolPath
        Set-PropertiesFromHash $pool $_.Properties
        $pool | Set-Item            
    }

 $config.Websites | 
    %{        
        $sitePath = "IIS:\Sites\$($_.Name)"

        # Create if not exists
        if(-not(Test-Path $sitePath)){ New-WebSite $_.Name -HostHeader $_.Name }

        # Update the properties from the config
        $site = Get-Item $sitePath
        Set-PropertiesFromHash $site $_.Properties
        $site | Set-Item 
    } 
```

如您所见，该过程实际上是相同的（除了正在创建的项目路径和类型）。如果我能正常工作，这当然会被重构！

我编写了一个名为`Set-PropertiesFromHash`. 这基本上将哈希表展平为属性路径：

```
Function Set-PropertiesFromHash{
    Param(
        [Parameter(Mandatory=$true, HelpMessage="The object to set properties on")]        
        $on,
        [Parameter(Mandatory=$true, HelpMessage="The HashTable of properties")]
        [HashTable]$properties,
        [Parameter(HelpMessage="The property path built up")]
        $path
    )
    foreach($key in $properties.Keys){
        if($properties.$key -is [HashTable]){
            Set-PropertiesFromHash $on $properties.$key ($path,$key -join '.')
        } else {            
            & ([scriptblock]::Create( "`$on$path.$key = `$properties.$key"))            
        }
    }
} 
```

`scriptblock`子句中的 created`else`将导致执行`$on.ProcessModel.IdentityType = $properties.IdentityType`（每个循环中的属性对象是最后找到的 HashTable 值，因此这确实分配了正确的值）

## 问题

还在？谢谢！

对于应用程序池，上述所有方法都可以正常工作，但*对于网站则完全失败*。**为什么这仅对网站失败？**

我知道我可以使用`Set-ItemProperty`，但这里的目的是允许配置对象驱动正在设置的属性。

下面详细介绍一个更简单的示例：

```
# Setting an app pool property this way works as expected
$ap = gi IIS:\apppools\apppool1
$ap.enable32BitAppOnWin64 # returns False
$ap.enable32BitAppOnWin64 = $true
$ap | Set-Item
$ap = gi IIS:\apppools\apppool1
$ap.enable32BitAppOnWin64 # returns True

# Setting a website property this way fails silently
$site = gi IIS:\sites\site1
$site.physicalpath # returns "C:\sites\site1"
$site.physicalpath = "C:\sites\anothersite"
$site | Set-Item
$site = gi IIS:\sites\site1
$site.physicalpath # returns "C:\sites\site1" 
```

After`Set-Item`被调用，然后再次检索的项目`$ap`具有更新的值但`$site`不包含更新的值。

我正在使用 PowerShell v2 和 IIS7

### 部分解决...更多的解决方法

我已更改`Set-PropertiesFromHash`为如下工作：

```
Function Set-PropertiesFromHash{
    Param(
        [Parameter(Mandatory=$true, HelpMessage="The object to set properties on")]        
        $on,
        [Parameter(Mandatory=$true, HelpMessage="The HashTable of properties")]
        [HashTable]$properties,
        [Parameter(HelpMessage="The property path built up")]
        $pathParts = @()
    )
    foreach($key in $properties.Keys){        
        if($properties.$key -is [HashTable]){
            Set-PropertiesFromHash $on $properties.$key ($pathParts + $key)
        } else {                  
            $path = ($pathParts + $key) -join "."
            Set-ItemProperty $on $path $properties.$key
        }
    }
} 
```

这让我现在可以继续。但是我原来的问题仍然存在。

**为什么`$site | Set-Item`网站会失败？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T16:09:00.207

这似乎有效

```
(gi IIS:\sites\site1).physicalpath
(gi IIS:\sites\site1).physicalpath = "C:\sites\anothersite"
(gi IIS:\sites\site1).physicalpath 
```

# c# - 调用 GetClientRect winAPI

> ID：13086927
> 
> 赞同：0
> 
> 时间：2012-10-26T12:27:55.500
> 
> 标签：c#, winapi, getclientrect

我在尝试调用 GetClientRect 并传入一个 Stuct 以填充返回的值时遇到问题。这是我的代码。

```
[return: MarshalAs(UnmanagedType.Bool)]
        [DllImport("user32.dll")]
        internal static extern bool GetClientRect(IntPtr hwnd, ref RECT lpRect);

        [StructLayout(LayoutKind.Sequential)]
        internal struct RECT
        {
            internal int left;
            internal int top;
            internal int right;
            internal int bottom;
        }
     RECT rect = new RECT();

     GetClientRect(PApplication.Instance.MdiMain.Handle, ref rect); 
```

我不断收到 RECT 上的错误消息，即错误 1 ​​嵌入式语句不能是声明或标记语句。

我只需要帮助从 GetClientRect 取回左上右下角的值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:34:14.323

我发现它我把代码放在 if 之后忘记添加 { } 所以我现在很好。

# c - 从扫描仪的输出中检测点阵图形

> ID：13086929
> 
> 赞同：2
> 
> 时间：2012-10-26T12:28:08.930
> 
> 标签：c, image-processing, opencv

我是图像处理的新手。我有扫描仪输出的`bmp`格式和`.bin`文件图像。bin 文件具有`hex`值或原始数据。

首先我会解释这个过程。我们使用 13 位数字。每个数字都有一个以点格式表示的模式。比如说，一个 13 位数字将有 20 个点。每个点的位置取决于数字。这是`encryption`部分。现在这些点被重复打印。这些是使用扫描仪扫描的，扫描仪将上述文件作为输出。

下一步是处理这些输出以返回 13 位数字。我正在使用`openCV`和`C`。有人可以给我一些关于如何做到这一点的想法。我无法发布 bin 文件。但是bin文件的内容是这样的格式：

> 10 78 84 88 84 84 8c 88 88 8c 8c 90 88 88 8c 8c 90 90 88 90 8c 8c 8c 8c 8c 94 90 90 8c 90 90 94 8c 8c

我添加了应用于图像的精明边缘检测的输出。

![在图像上完成的精明边缘检测的输出](../Images/410a26a5eb8e722d7f21a8e93ea78fdf.png)

提前致谢...！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T16:26:30.157

我不是真正的opencv用户。然而，假设你想提取点区域，一个快速的肮脏方法是用精明的边缘检测识别二进制图像中的连通分量。[看到这个](http://en.wikipedia.org/wiki/Connected-component_labeling)。

标记所有连接的组件后，您可以检查每个组件的[循环性](http://docs.opencv.org/modules/features2d/doc/common_interfaces_of_feature_detectors.html)

然后对每个连通分量的圆度和/或面积（计算为每个连通分量中 1 的总和）应用过滤器。只有那些通过过滤器的才是你的点。

这可能不是最好的方法，因为合并到外圈上的点可能会被过滤掉，但如果你只关心孤立的点，它原则上应该可以工作。此外，您可能希望适当地对图像进行阈值处理，而不是应用边缘检测

祝你好运

# javascript - 为什么 window.opener 在 Internet explore 9 中不起作用？

> ID：13086933
> 
> 赞同：-1
> 
> 时间：2012-10-26T12:28:28.153
> 
> 标签：javascript, internet-explorer

我有一个 JSP 文件，其中包含以下 javascript

```
<script type="text/javascript" language="javascript">
    window.opener.myfunction();
    window.close();
</script> 
```

这适用于 Chrome、Firefox 上的文件。它也适用于我在 VMWare 虚拟机中运行的 Internet Explorer 8 和 9。但是，用户报告了一个错误，结果是 window.opener 不起作用并且 myfunction 没有被调用。用户也使用 IE9，但在本机 Windows 机器上运行。

我的问题是为什么它适用于我的 IE9 而不是他的？任何 IE 设置都会导致这种情况吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:37:34.290

这是一个例子...... [http://jsfiddle.net/KjBj3/6/](http://jsfiddle.net/KjBj3/6/)

显然，您的弹出页面中将包含标记，但您得到了漂移......

```
var win = window.open("", "win","width=200,height=100");
win.document.write('<a href="#" id="close" onclick="window.close();">This is myWindow!</a>');
win.focus();
win.opener.document.write('<p>This is the source window!</p>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:52:20.113

我不知道`window.opener`，如果您可以修改开启代码，则不需要。考虑这个复制功能的代码：

```
w2 = window.open(...);
w2.opener = window; 
```

如果开瓶器是你的，让它自己指定为任何打开的窗口的开瓶器。如果你担心并发，如果还没有设置开启器，你可以在打开的窗口中休眠：

```
<script type="text/javascript" language="javascript">
    (function f(){
      if(window.opener){
        window.opener.myfunction();
        window.close();
      }else{
        setTimeout(f,1); //1ms should be enough. If not, wait again.
      }
    })()
</script> 
```

# magento - Magento 模块中的 Cron 作业

> ID：13086937
> 
> 赞同：2
> 
> 时间：2012-10-26T12:28:44.297
> 
> 标签：magento, cron

我正在尝试在我的 Linux (HostGator) 服务器上的 magento 中使用 Cron 作业。我在 magento 管理面板中创建了一个模块，我想用 mymodule 运行它，但它不工作。当我从 cpanel 运行它时，它工作正常并且需要时间安排`'cpanel'`，但我想根据我在 mymodule crontab 中设置的时间运行它。任何机构都可以告诉我有必要从 cronjob 设置`cpanel`吗？或者它可以在不同的时间安排从模块 crontab 运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:36:18.350

请阅读这篇关于 Magento 中 cron 工作的 wiki 文章 [http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/how_to_setup_a_cron_job](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/how_to_setup_a_cron_job)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T20:08:59.917

首先，您需要通过 Cpanel 配置 Cron。这是更多信息（带屏幕截图） [https://support.sweettoothrewards.com/entries/21196536-setting-up-cron-jobs-in-magento](https://support.sweettoothrewards.com/entries/21196536-setting-up-cron-jobs-in-magento)

这也是我的文章，可以为您提供更多信息，如何在您的自定义 magento 扩展中设置 cron 以及 cron 如何工作[http://blog.belvg.com/magento-certified-developer-exam-setting-up-a-cron-工作.html](http://blog.belvg.com/magento-certified-developer-exam-setting-up-a-cron-job.html)

这里也是 Fabrizio Branca 提供的非常好的免费扩展，它将帮助您测试您的 cron 作业 [http://www.fabrizio-branca.de/magento-cron-scheduler.html](http://www.fabrizio-branca.de/magento-cron-scheduler.html)

# go - 处理函数中的接收器，例如 filepath.WalkFunc

> ID：13086943
> 
> 赞同：4
> 
> 时间：2012-10-26T12:28:56.603
> 
> 标签：go

我遇到了一个小问题，对此我只有一些丑陋的解决方案。我无法想象我是第一个，但我还没有找到任何关于 SO 的线索。

在下面的（故意简化的）示例中，我想在`walk`函数上有一个接收器，它是我的`filepath.WalkFunc`.

```
package main

import (
    "fmt"
    "os"
    "path/filepath"
)

type myType bool

func main() {
    var t myType = true

    // would have loved to do something as:
    // _ = filepath.Walk(".", t.walk) 

    // that does not work, use a closure instead    
    handler := func(path string, info os.FileInfo, err error) error {return t.walk(path, info, err)}
    _ = filepath.Walk(".", handler)
}

func (t myType) walk(path string, info os.FileInfo, err error) error {

    // do some heavy stuff on t and paths
    fmt.Println(t, path)

    return err
} 
```

Func`main()`触发器`walk()`，并且由于接收器`t`to `walk()`，我找不到其他方法，只能使用这个丑陋的闭包`handler`作为`filepath.Walk()`. 我本来希望有更多类似的东西， `fileWalk(".", t.walk)`但这不起作用。它给出了编译错误“方法 t.walk 不是表达式，必须调用”

在这方面，我的关闭解决方案是正确的方法，还是我不知道有更好的选择。

PS。这是我必须使用此闭包构造来传递具有接收器的处理程序函数的几种情况之一。因此，这个问题更多地与传递处理函数有关，而不是与`filepath`行为有关。

谢谢你的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T12:46:21.563

这是不可能的。

在 Go 中，方法大多是语法糖，接收者实际上是函数的第一个参数。myType.walk 基本上有签名`func(myType, string, os.FileInfo, error) error`。当您尝试将 myType.walk 传递给 filepath.Walk 而不是 t.walk 时，您会看到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:08:46.717

虽然您提到忽略问题的文件路径行为，但给出的示例在很大程度上取决于它。

首先，要解决传入方法的问题，请尝试定义接口。

包主

```
import (
    "fmt"
)

type Foo interface {
    Bar(a string)
}

type myFoo bool

func (b myFoo) Bar(a string) {
    fmt.Println(b, a)
}

func exec(f Foo) {
    f.Bar("hello from exec")
}

func main() {
    var test myFoo
    exec(test)
} 
```

因此，在上面，您实际上将定义一个描述什么功能的接口，然后完全传入，而不是尝试传递`test.Bar`给。`exec``test`

对于 filepath.Walk，它没有定义接口，而是需要一个函数类型作为参数。在这种情况下，您需要使用 func 类型包装您的方法`filepath.WalkFunc`

如果您发现自己需要这样做很多（未经测试），您可能可以为您的类型添加一个额外的方法

```
func (t myType) handlerFunc() filepath.WalkFunc {
    return func(path string, info os.FileInfo, err error) error {
        return t.walk(path, info, err)
    }
} 
```

然后打电话`filepath.Walk(".", t.handlerFunc())`

# symfony - Symfony2 trans_default_domain 不工作

> ID：13086954
> 
> 赞同：2
> 
> 时间：2012-10-26T12:30:18.090
> 
> 标签：symfony, translation, twig

在[http://symfony.com/doc/current/book/translation.html#twig-templates](http://symfony.com/doc/current/book/translation.html#twig-templates)我读到的结尾

```
{% trans_default_domain "app" %} 
```

为整个模板设置翻译域。但对我来说它不起作用。打电话

```
app/console translation:extract de --dir=src/ --output-dir=app/Resources/translations --output-format=xliff --keep 
```

只需将所有消息放在 messages.de.xliff 文件中即可。

但是，如果我为给定的标签手动设置域，例如

```
{{ label.name|trans({}, 'app') }} 
```

并执行与上面相同的提取命令，然后我得到一个新文件 app.de.xliff

使用时还有什么事情要做`trans_default_domain`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T10:52:27.310

似乎你忘记了简单的引号，试试这个

```
{{ 'label.name'|trans({}, 'app') }} 
```

或这个

```
{{ 'label.name'|trans }} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-18T04:55:32.380

```
{% trans_default_domain "app" %} 
```

这很好，但如果翻译文件之前不存在，则应清除缓存以使其正常工作。

# html - 如何更改chhtml中的动作链接按钮样式

> ID：13086959
> 
> 赞同：0
> 
> 时间：2012-10-26T12:30:44.030
> 
> 标签：html, css, razor, styles, stylesheet

我需要以相同的样式显示所有按钮。除了 div 内容和使用类名之外的所有按钮我都很好。但我只需要一个按钮来放置 html.actionlink 类型。但这个按钮只有文字大小和文字系列与其他按钮完全不同。我的代码如下。如何解决这个问题？. 感谢您的提前指导

```
 <div id="exportButton">
            @Html.ActionLink("Export", "Export", new { page = 1, pageSize = 0, orderBy = "~", filter = "~"}, new { id = "exportSearchLink", @class = "button w100 " })
        </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:36:25.013

```
@Html.ActionLink("Please Edit Me", "Edit", null, new { style="font-weight:bold;" }) 
```

# python - 每次我开始构建新的 Flask 应用程序时创建一个新的“virtualenv”是一个好习惯吗？

> ID：13086960
> 
> 赞同：2
> 
> 时间：2012-10-26T12:30:50.547
> 
> 标签：python, flask, virtualenv

这就是我开始我的第一个`virtualenv`Flask 应用程序的方式：

```
$ virtualenv flask_env
$ source flask_env/bin/activate
(flask_env) $ pip install Flask 
```

这是我第一次使用这个。`virtualenv`每次开始构建新的 Flask 应用程序时创建一个新的应用程序是一种好习惯吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T15:17:41.987

简短的回答：是的。

更长的答案：关于你想如何工作，这是一个个人问题。我想您会发现，随着您构建的应用程序越来越多，每个应用程序都会有不同的依赖关系。也许对于一个应用程序，您需要使用 wtforms。也许对于另一个应用程序，您将使用请求。也许三分之一，你需要flask-sqlalchemy。如果您将每个应用程序都放在自己的 virtualenv 中，则可以单独管理这些要求。

如果您计划部署到 Heroku 之类的东西，您会发现拥有一个仅包含该应用程序所需的 virtualenv 要容易得多。

唯一的缺点是，如果您在构建的每个应用程序中都使用 wtforms 之类的东西并决定升级。您必须在每个 virtualenv 中进行升级。这可能不是那么糟糕，因为您可能想要测试该升级如何以不同方式影响每个应用程序。

以我个人的经验，我为每一个应用程序、每一个实验、每一个我做过的不同的事情都创建了一个 virtualenv。这是一个很好的划分，对我来说，感觉类似于 git 中的分支（尽管没有所有的合并）。

# ruby-on-rails - Rails 预编译评估失败，返回函数外

> ID：13086966
> 
> 赞同：0
> 
> 时间：2012-10-26T12:31:16.167
> 
> 标签：ruby-on-rails, deployment, asset-pipeline

```
 [176.71.146.44] executing command
 ** [out :: 176.71.146.44] ** Invoke assets:precompile (first_time)
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Execute assets:precompile
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Invoke assets:precompile:all (first_time)
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Execute assets:precompile:all
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Invoke assets:precompile:primary (first_time)
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Invoke assets:environment (first_time)
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Execute assets:environment
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Invoke environment (first_time)
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Execute environment
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Invoke tmp:cache:clear (first_time)
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Execute tmp:cache:clear
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] ** Execute assets:precompile:primary
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] rake aborted!
 ** [out :: 176.71.146.44] 
 ** [out :: 176.71.146.44] 'return' outside of function (line: 29773, col: 8, pos: 908864) 
```

有人知道这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:40:14.773

我没有看到那个错误，但我的大多数`asset:precompile`错误最终都是特定资产中的问题。

当我遇到无法解释的错误时，我开始一次尝试一件事。如果您正在使用源代码控制，您可以回滚到之前有效的更改吗？如果尚未签入，请使用 Git stash、Perforce Shelf 或类似工具。

这是一个从 CoffeeScript 文件中遇到类似编译错误的人：http: [//youtrack.jetbrains.com/issue/RUBY-12178](http://youtrack.jetbrains.com/issue/RUBY-12178)

希望有帮助。

# iphone - 无法将大 NSArray 保存到 plist

> ID：13086969
> 
> 赞同：0
> 
> 时间：2012-10-26T12:31:26.770
> 
> 标签：iphone, objective-c, json, nsarray, plist

我将字典数组保存到 plist 文件中。我已经对大约 150 个实例的数组进行了测试，并且运行良好。现在我有大约 350 个并且相同的代码不起作用（它可能是由什么引起的？

不工作 = 创建一个空的 plist。

我正在使用 TouchJSON 将 JSON 解析到数组中 某些字典的某些元素具有 NULL 值（如果有帮助）

这是我用来保存数据的代码：

```
NSString *filePathDocArray = [DOCUMENTS stringByAppendingPathComponent:@"filters.plist"];
        NSString *filePathBundleArray = [[NSBundle mainBundle] pathForResource:@"filters" ofType:@"plist"];
        //if there is no current filterlist - download and parse the JSON 
        if (![[NSFileManager defaultManager] fileExistsAtPath:filePathDocArray]) 
        {
            [[NSFileManager defaultManager] copyItemAtPath:filePathBundleArray toPath:filePathDocArray error:nil];
            NSLog(@"File saved");
        } 
        [APIDownload downloadWithURL:@"url" delegate:self]; 
```

完成加载时调用的方法：

```
- (void)APIDownload:(APIDownload*)request 
{   
    CJSONDeserializer *deserializer = [CJSONDeserializer deserializer];
    self.news = [deserializer deserializeAsArray:request.downloadData error:nil];

    NSString *filePathDocArray = [DOCUMENTS stringByAppendingPathComponent:@"filters.plist"];
    [self.news writeToFile:filePathDocArray atomically:YES];
    [news release];
    if(TableViewSynthesized) {
        [self.tableViewController release];
        TableViewSynthesized = NO;
    }
} 
```

# c++ - 结构数组的初始化列表的行为

> ID：13086971
> 
> 赞同：1
> 
> 时间：2012-10-26T12:31:29.817
> 
> 标签：c++, visual-studio-2010, array-initialization

我浏览了几本 C++ 书籍，但没有一本详细描述这一点：

在 VC++ 2010 中，我创建了一个结构体，其中故意添加了用于测试的构造函数：

```
struct BufferElement {
    size_t currentAllocationSize;
    BufferElement() {
        currentAllocationSize=50;
    }
    BufferElement(size_t size) {
        if (size==0)
            currentAllocationSize=20;
        else 
            currentAllocationSize=1;
    }
}; 
```

我有一个这种结构类型的数组：

```
int _tmain(int argc, _TCHAR* argv[])
{
    BufferElement buffers[10]={0};
    buffers[6]=0;
    for (int i=0; i<sizeof buffers/ sizeof buffers[0]; i++) {
        printf("%d\n", buffers[i].currentAllocationSize);
    }

    return 0;
} 
```

结果：

```
20
50
50
50
50
50
20
50
50
50 
```

我希望我的数组初始化器列表**{0}**应该将所有元素初始化为 0。由于这是一个结构数组，因此 0 应该意味着用 0 调用构造函数。但是测试表明，除了第一个元素之外，它们都是使用默认构造函数调用。这是标准行为吗？当数组类型是结构时，我应该如何解释数组初始值设定项 {0}？如何确保调用我的单个 arg 构造函数而不必使用 {0,0,0,0,0,0,0,0,0,0}？因为我的数组大小可能会改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:36:59.317

> 但是测试表明，除了第一个元素之外，所有的元素都是用默认构造函数调用的。

如果仅初始化数组的某些元素，则任何剩余元素都将使用默认构造函数进行初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T12:38:13.397

是的，这正是它应该表现的那样。

您只为第一个元素指定了初始化程序。由于没有为其余元素指定初始化程序，因此调用了默认构造函数。

您不能使用相同的语法来仅指定一个初始化程序并在所有 6 个元素上使用它。所以我会采用不同的方法。使用旧的 C 样式构造声明数组后：

```
BufferElement buffers[10]; 
```

元素已经构建好了。为什么不使用旧的 C 样式数组，而不是使用 a`vector` 然后您可以使用`generate`或`fill`使用非默认构造的元素填充向量：

（未经测试，应该工作）

```
#include <vector>
#include <algorithm>
using namespace std;

// ...

vector<BufferElement> buffers;
buffers.fill_n(10,0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T12:38:50.187

您只是为第一个元素指定一个值，因此一个元素将被初始化为`BufferElement(your-value)`. 其余元素没有指定值，因此它们将使用默认构造函数。这就是类和结构类型发生的情况。

在内置类型的数组中，例如`int`，其余值将改为*value-initialized*，这使它们为零。对于类对象不是这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T12:39:18.200

`{0}`标准不要求通过仅给出一个值 ( ) 来初始化数组的所有元素。由于这是一个`struct`s 数组，因此调用它们的默认构造函数来初始化它们。

如果你想用一个特定的值来初始化它们，你应该列出所有的元素，像这样：`{0, 0, 0, 0, ..., 0}`.

您可以像这样使用`std::vector`并初始化所有内容：

```
std::vector<BufferElement> vec(10, BufferElement(0)); 
```

# java - 制作统一颜色的位图

> ID：13086974
> 
> 赞同：-5
> 
> 时间：2012-10-26T12:31:34.700
> 
> 标签：java, android, bitmap

我需要一个只有红色或任何其他颜色的位图。我可以使用`CreateBitmap()`，如果可以怎么办？

```
Bitmap b= Bitmap.createBitmap //WHAT DO I NEED HERE? 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:52:46.437

以低效的方式：

```
Bitmap bitmap = Bitmap.createBitmap(width, height, Config.ARGB_8888);
for (int i = 0; i < width; i++) {
    for (int j = 0; j < height; j++) {
        bitmap.setPixel(i, j, Color.argb(255, 255, 0, 0));
     }
 } 
```

完整的红色位图

# jquery - 如何使用 ajax 在 solr 服务器中添加新文档

> ID：13086975
> 
> 赞同：0
> 
> 时间：2012-10-26T12:31:33.470
> 
> 标签：jquery, solr

我正在尝试使用 ajax 在 solr 服务器中添加新文档。

要在 solr 服务器中添加新文档，我们必须编写 http://192.168.10.113:8080/solr/update/?commit=true%20-H%20%22Content-Type:%20text/xml%22%20 --data-binary%20%20%3Cadd%3E%3Cdoc%3E%3Cfield%20name='id'%3E19990%3C/field%3E%3C/doc%3E%3C/add%3E

实际代码：<add><doc><field name='id>19990></field></doc></add>

现在我尝试在服务器中添加文档。

我的 AJAX 代码：

```
$.ajax({
            url: "http://192.168.10.113:8080/solr/update/?commit=true%20-H%20%22Content-Type:%20text/xml%22%20--data-binary%20'<add><response><doc><field%20name='id'>19990</field></doc></response></add>'",
            type: 'POST',
            success: function (data) {
                    alert(data);
            }
        }); 
```

ajax 调用没有显示任何错误。

然后我尝试获取这样的数据：http://192.168.10.113:8080/solr/select/?q=19990&version=2.2&start=0&rows=10&indent=on

它没有显示该数据。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:07:00.747

1.  solr 存储库更新可能需要一些时间。查看您的提交策略，也许尝试自己提交。

2.  你是如何尝试添加它的？使用卷曲？或使用一些浏览器？因为请求可能是更新或发布请求......

3.  使用这个：[https ://github.com/evolvingweb/ajax-solr](https://github.com/evolvingweb/ajax-solr)

4.  “--data-binary”是一个 curl 标志，不应该在 url 中，您应该将 xml 数据放在 ajax 请求的数据中，而不是在 url 中：

> ```
>  $.ajax({
>         type     : "POST",
>         url      : "http://192.168.10.113:8080/solr/update/?commit=true",
>         data     : { xml: escape("<add><response><doc><field name=id>19990</field></doc></response></add>") },
>         dataType : "text/xml",
>         success  : function(msg){
>             alert('Success ');
>         },
>         error    : function(msg) {
>             alert('Failed');
>         }
>     }); 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:49:00.200

根据[Solr Wiki - Update XML Messages](http://wiki.apache.org/solr/UpdateXmlMessages#Passing_commit_and_commitWithin_parameters_as_part_of_the_URL)页面上显示的示例，您的添加代码格式似乎已关闭。它应该是以下内容：

```
<add><doc><field name="id">19990</field></doc></add> 
```

网址编码值： `%3Cadd%3E%3Cdoc%3E%3Cfield%20name%3D%22id%22%3E19990%3C%2Ffield%3E%3C%2Fdoc%3E%3C%2Fadd%3E`

试一试，看看是否添加了文档。

此外，由于您使用的是 Ajax，如果您的数据已经是 JSON 格式，您可能需要考虑发送 JSON 数据。有关更多详细信息，请参阅[Solr Wiki - 更新 JSON](http://wiki.apache.org/solr/UpdateJSON)。

# sql-server-2008 - 带有 Excel 工作表的 SSIS

> ID：13086976
> 
> 赞同：1
> 
> 时间：2012-10-26T12:31:40.473
> 
> 标签：sql-server-2008, excel, ssis

我已经创建了 ssis 包来将 loda 数据从 excel 到数据库。我的问题是在我手动删除密码的那一刻，那些受密码保护的 excel 文件（我知道密码）。有什么方法可以在 ssis 中实现自动化，因为我有 200 个 excel 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:57:08.950

根据您公司的安全策略（或对其进行监控），这可能会或可能不会起作用，但您可以编写一个快速宏来打开所有 200 个文件并将它们保存在没有密码的临时“未受保护”目录中。然后运行您的 SSIS 脚本，完成后，删除所有 200 个文件（使用安全删除器，例如[Eraser](http://eraser.heidi.ie "橡皮")）

```
Sub ManagePWords()

Dim f(1 To 200) As Variant
Dim i As Integer
Dim origpath As String, temppath As String
Dim wb As Excel.Workbook

   origpath = "c:\where_files_are_now\"
   temppath = "c:\where_files_are_now\unprotected\"

   f(1) = Array("filename1", "password1")
   f(2) = Array("filename2", "password2")
   'keep going for all 200 files

   For i = 1 To UBound(f)
      Set wb = Application.Workbooks.Open(origpath & f(i)(0), , , , f(i)(1))
      wb.SaveAs temppath & f(i)(0) & ".xlsx", , ""
      wb.Close
   Next i

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:18:30.060

Vinnies 的回答给了我另一个想法——如果你使用像 excel 文件这样的 apdater 会怎样。

使用 excel (vba) 打开受保护的文件很容易，然后，您可以将文件全部导入此工作簿或创建它们的副本，这些副本不受保护，或者您甚至可以将数据直接复制到 ssis/sql-server。

但是，这将是我的建议。使用 excel 创建输入数据的新源，然后使用任何方法导入这些新数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T13:09:13.057

根据 MSDN，“您无法连接到受密码保护的 Excel 文件。”

[http://msdn.microsoft.com/en-us/library/ms139836(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms139836(v=sql.105).aspx)

可能有一种方法可以通过自定义脚本访问它，您可以在其中将 excel 表中的内容读出到要处理的 csv 中。或者可能变成一个对象。但是，我还没有找到任何帮助。

这是来自 SQL Server Central 的论坛帖子，可能会有所帮助。它有一个 powershell 脚本示例（需要登录）

[http://www.sqlservercentral.com/Forums/Topic885800-148-1.aspx](http://www.sqlservercentral.com/Forums/Topic885800-148-1.aspx)

无论如何，我认为您必须先从受保护的 Excel 工作表中取出数据，然后才能对其进行处理。

更新：CozyRoc 出售一个连接管理器，可以让您使用受密码保护的 Excel 表格作为连接。

[http://www.cozyroc.com/ssis/excel-connection](http://www.cozyroc.com/ssis/excel-connection)

# vb.net - 调用其中已有函数的 Subs

> ID：13086979
> 
> 赞同：1
> 
> 时间：2012-10-26T12:32:01.483
> 
> 标签：vb.net, visual-studio-2008

首先，我一直在这里和那里用谷歌搜索，你被卡住了，我需要有人帮忙。我已经有一个包含函数作为参数的子，现在的问题是我如何在我的按钮中调用这个子，请向我充分解释，我已经很绝望了

```
Public Function AddDec(ByVal Valdec1 As Decimal, ByVal Valdec2 As Decimal) As Decimal
    AddDec = Valdec1 + Valdec2
End Function

Sub Finished(ByVal AddDec As Func(Of Decimal, Decimal, Decimal))
    If DetailCount1.Text.Length >= 10 Or DetailCount2.Text.Length >= 10 Then
        If TextBox1.Text = "" Then TextBox1.Text = 0
        If DetailCount1.Text.Contains(",") Or DetailCount2.Text.Contains(",") Then
            Valdec2 = CDec(TextBox1.Text)
            TextBox1.Text = Adddec(Valdec1, Valdec2)
            MsgBox("HELP ME xD")
        Else
            ValDbl2 = CDbl(TextBox1.Text)
            TextBox1.Text = ValDbl1 + ValDbl2
        End If
    ElseIf Not DetailCount1.Text.Length >= 10 And Not DetailCount2.Text.Length >= 10 Then
        If TextBox1.Text = "" Then TextBox1.Text = 0
        If kindbil1 = "Even" And Label2.Text = "Even" Then
            val2 = CInt(TextBox1.Text)
            TextBox1.Text = CInt(val1 + val2)
        ElseIf kindbil1 = "Deci" And Label2.Text = "Deci" Then
            Valdec2 = CDec(TextBox1.Text)
            TextBox1.Text = CDec(Valdec1 + Valdec2)
        ElseIf kindbil1 = "Deci" And Label2.Text = "Even" Then
            val2 = CInt(TextBox1.Text)
            Valdec2 = CDec(val2)
            TextBox1.Text = CDec(Valdec1 + Valdec2)
        ElseIf kindbil1 = "Even" And Label2.Text = "Deci" Then
            Valdec2 = CDec(TextBox1.Text)
            Valdec1 = CDec(val1)
            TextBox1.Text = CDec(Valdec1 + Valdec2)
        End If
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:37:31.760

有点难以理解你想要做什么，但我想你想`Finished`用`AddDec`方法作为参数的`AddDec`参数来调用。

为此，您必须使用[运算](http://msdn.microsoft.com/en-us/library/y72ewk2b%28v=vs.71%29.aspx)[符`AddressOf`](http://msdn.microsoft.com/en-us/library/y72ewk2b%28v=vs.71%29.aspx)：

```
Finished(AddressOf AddDec) 
```

# arrays - 类似索引的 XSLT 数组

> ID：13086983
> 
> 赞同：0
> 
> 时间：2012-10-26T12:32:21.000
> 
> 标签：arrays, xslt, indexing

XML 代码：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<catalog>
<notold>
    <list>1</list>
    <list>2</list>
</notold>
<cd>
    <title>Empire Burlesque</title>
    <artist>Bob Dylan</artist>
    <country>USA</country>
    <company>Columbia</company>
    <price>10.90</price>
    <year>1985</year>
</cd>
<cd>
    <title>Hide your heart</title>
    <artist>Bonnie Tyler</artist>
    <country>UK</country>
    <company>CBS Records</company>
    <price>9.90</price>
    <year>1988</year>
</cd>
<cd>
    <title>Greatest Hits</title>
    <artist>Dolly Parton</artist>
    <country>USA</country>
    <company>RCA</company>
    <price>9.90</price>
    <year>1985</year>
</cd>
</catalog> 
```

XSLT 代码：

```
 <?xml version="1.0" encoding="ISO-8859-1"?>
<!-- Edited by XMLSpy® -->
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
    <h2>My CD Collection</h2>
    <table border="1">
    <tr bgcolor="#9acd32">
    <th>Title</th>
    <th>Artist</th>
        </tr>
        <xsl:for-each select="catalog/cd">
        <tr>

        <td><xsl:value-of select="title"/></td>
        <td><xsl:value-of select="artist"/></td>
        <td><xsl:value-of select="year"/></td>
        <xsl:if test='year=1985'>
          <td><xsl:value-of select="/catalog/notold"></td>
    </xsl:if>
        </xsl>
      </tr>
      </xsl:for-each>
    </table>
  </body>
  </html>
</xsl:template>
</xsl:stylesheet> 
```

我想给第一场比赛编号 1 和第二场比赛编号 2。但问题是，在每场比赛之后，它同时给出 1 和 2。我怎样才能让它在每场比赛中只使用一个号码。

谢谢。

输出：

```
<table border="1">
<tbody><tr bgcolor="#9acd32">
<th>Title</th>
<th>Artist</th>
</tr>
<tr>
<td>Empire Burlesque</td>
<td>Bob Dylan</td>
<td>1985</td>
<td>
1
2
</td>
</tr>
<tr>
<td>Hide your heart</td>
<td>Bonnie Tyler</td>
<td>1988</td>
</tr>
<tr>
<td>Greatest Hits</td>
<td>Dolly Parton</td>
<td>1985</td>
<td>
1
2
</td>
</tr>
</tbody></table> 
```

编辑：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<cdash>

<builds>
 <build>
  <buildid>19389</buildid>
 </build>
 <build>
  <buildid>19390</buildid>
 </build>
</builds>

<etests>
<columnname>LoadTime</columnname>

<etest>
<name>LoadTime</name><buildid>19389</buildid><value>676</value>
</etest>
<columnname>Median</columnname>
<etest>
<name>Median</name><buildid>19389</buildid><value>868</value>
</etest>

<etest>
<name>LoadTime</name><buildid>19390</buildid><value>1777</value>
</etest>
<etest>
<name>Median</name><buildid>19390</buildid><value>1508</value>
</etest>

</etests

</cdash> 
```

XML:

```
<?xml version="1.0" encoding="iso-8859-1"?>
<!-- Edited by XMLSpy® -->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:template match="/">
        <h2>Collection</h2>
        <table border="1">
            <tr bgcolor="#9acd32">
                <th>Title</th>
                <th>Artist</th>
            </tr>
            <xsl:for-each select="cdash/builds/build">
                <tr>
                    <td><xsl:value-of select="buildid"/></td>

                <td>
        <xsl:if test='buildid = /cdash/etests/etest/buildid'>
                            <xsl:variable name='index' 
                                          select='count(preceding-sibling::build[buildid = /cdash/etests/etest/buildid]) + 1' />
                            <xsl:value-of select="/cdash/etests/etest/value[position()=$index]" />
        </xsl:if>
                        </td>

                </tr>
            </xsl:for-each>
        </table>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:23:11.640

我认为这就是您所追求的-假设您希望 Bob Dylan 拥有第一个`notold/list`（即“1”），Bonnie Tyler 没有数字，而 Dolly Parton 拥有第二个`notold/list`。

它通过在匹配相同过滤器的所有 cd 列表中查找当前匹配 cd 的位置，通过计算`preceding-sibling`匹配列表中的 s，然后`notold/list`根据基于 1 的索引访问适当的项目来工作。

```
<?xml version="1.0" encoding="iso-8859-1"?>
<!-- Edited by XMLSpy® -->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:template match="/">
        <h2>My CD Collection</h2>
        <table border="1">
            <tr bgcolor="#9acd32">
                <th>Title</th>
                <th>Artist</th>
            </tr>
            <xsl:for-each select="catalog/cd">
                <tr>
                    <td><xsl:value-of select="title"/></td>
                    <td><xsl:value-of select="artist"/></td>
                    <td><xsl:value-of select="year"/></td>
                    <xsl:if test='year=1985'>
                        <td>
                            <xsl:variable name='index' 
                                          select='count(preceding-sibling::cd[year=1985]) + 1' />
                            <xsl:value-of select="/catalog/notold/list[position()=$index]" />
                        </td>
                    </xsl:if>
                </tr>
            </xsl:for-each>
        </table>
    </xsl:template>
</xsl:stylesheet> 
```

# mysql - 使用 PREPARE 和 EXECUTE 时遇到问题

> ID：13086985
> 
> 赞同：0
> 
> 时间：2012-10-26T12:32:21.533
> 
> 标签：mysql, sql

我首先检查表是否存在。如果不存在，那么我正在创建一个然后将数据插入其中。

```
DELIMITER $$

DROP PROCEDURE IF EXISTS `myDb`.`InsertData`$$

CREATE DEFINER=`root`@`%` PROCEDURE `InsertData`(
IN _P1 VARCHAR(255),
IN _P2 DATETIME,
IN _P3 TEXT,
IN _TableName VARCHAR(255)
)
BEGIN
DECLARE TableCount INT(1);

SET TableCount = (SELECT COUNT(table_name)
FROM information_schema.tables
WHERE table_schema = 'myDb' AND table_name = _TableName);

IF(TableCount = 0) THEN
    SET @s = CONCAT('CREATE TABLE IF NOT EXISTS `myDb`.`',_TableName,'` ( 
     `P1` VARCHAR(255),`P2` DATETIME, `P3` TEXT ;'); 
    PREPARE stmt3 FROM @s; 
    SELECT stmt3;
    EXECUTE stmt3; 
END IF;
SET @s = CONCAT('INSERT INTO `myDb`.`',_TableName,'` ( P1, P2, P3)
VALUES (' + _P1 + ',' + _P2 + ',' + _P3 + ')'); 
PREPARE stmt3 FROM @s; 
EXECUTE stmt3; 

END$$

DELIMITER ; 
```

该过程已成功编译，但是当我运行它时，它给了我错误：

```
Error Code : 1064
You have an error in your SQL syntax; check the manual that corresponds to your MySQL     
server version for the right syntax to use near '' at line 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:35:03.513

你错过了一个`)`

```
SET @s = CONCAT('CREATE TABLE IF NOT EXISTS `myDb`.`',_TableName,'` ( 
            `P1` VARCHAR(255),`P2` DATETIME, `P3` TEXT );'); 
                                                       ^----------here 
```

# asp.net - 具有内部联接的 SQL 数据上下文

> ID：13086989
> 
> 赞同：1
> 
> 时间：2012-10-26T12:33:02.813
> 
> 标签：asp.net, linq

抱歉，这可能很明显，但我整个上午都在努力让它工作。

我正在使用 ASP.net 并且有一个数据上下文，如下所示。我想要做的是添加一个内部连接并使用公司名称作为搜索参数而不是交易描述，但对于我的生活，我不能这样做。

我想要最终实现的是：

```
SELECT *
FROM Deals
INNER JOIN Companies
ON Deals.CompanyID=Companies.CompanyID 
```

有人可以通过重写以下内容来帮助我获得相同的结果吗？

```
MobileVocherDataContext db = new MobileVocherDataContext();

List<Deal> dealresult= db.Deals.Where(c=>c.DealDescription.ToLower().Contains(keyword.ToLower()) && c.ExpiredDate.Date>=DateTime.Now.Date && c.Status==true).Skip(_skip).Take(_count).ToList();
List<CustomSearchresult> result = new List<CustomSearchresult> (); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T12:49:29.017

我认为这是 Linq to Entity？

尽管您应该知道后台发生了什么，但您不必担心在 EF 中明确加入...除非性能是一个主要问题。

`dealresult`您可以按如下方式遍历和访问公司：

```
foreach(var deal in dealresult) {
     var company = deal.Company;
} 
```

重新性能：这将在每次迭代时执行一个额外的 SQL 语句。您可以使用 Include() 运算符解决此问题（这应该在 EF5 中有效 - 请在以前的版本中查找）：

```
 MobileVocherDataContext db = new MobileVocherDataContext();

 var dealresult = db.Deals
    .Where(d => d.DealDescription.ToLower().Contains(keyword.ToLower())
    && d.ExpiredDate.Date >= DateTime.Now.Date
    && d.Status
    && d.Company.CompanyName == "Keyword")
    .Include(c => c.Company)
    .Skip(_skip)
    .Take(_count)
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:47:37.143

这是一些虚拟数据和一个可以帮助您的示例。

```
 var Custs = new List<Cust>() { new Cust() {CustId=1, Name="Joe"}, new Cust() {CustId=2, Name="Pete"}, new Cust() {CustId=3, Name="Steve"}};
 var Deals = new List<Deal>() { new Deal() {CustId=1, Name="JoeDeal"}, new Deal() {CustId=1, Name="AnotherJoeDeal"}, new Deal() {CustId=3, Name="SteveDeal"}};

var CustomerDeals = from d in Deals
                     join c in Custs on d.CustId equals c.CustId
                     select d;

foreach (var d in CustomerDeals)
{
    Console.WriteLine(d.Name);
} 
```

# android - 在 ViewPager 中显示多个页面，位置不正确

> ID：13086991
> 
> 赞同：4
> 
> 时间：2012-10-26T12:33:19.240
> 
> 标签：android, android-viewpager

我正在尝试实现 Dave Smith 的 PagerContainer 以在我的 ViewPager 中显示多个页面。我已经实现了一个单击侦听器来显示页码，但是当我单击左侧页面时，会显示“单击第 2 项”消息（第 0 项是正确的）。如果单击中间页面和右侧页面，则会显示正确的消息，分别为“item 1”和“item 2”。我还附上了一张图片来描述这个问题。我怎样才能解决这个问题？提前致谢。

![在此处输入图像描述](../Images/4f4bf68f66cfba91a2f6473685bd5b4b.png)

代码片段如下：

```
 @Override
    public Object instantiateItem(ViewGroup container, final int position) {
        TextView view = new TextView(PagerActivity.this);
        view.setText("Item "+position);
        view.setGravity(Gravity.CENTER);
        view.setBackgroundColor(Color.argb(255, position * 50, position * 10, position * 50));

        view.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {

                Toast.makeText(PagerActivity.this, "clicked on Item " + String.valueOf(position), 1000).show();

            }
        });

        container.addView(view);
        return view;
    } 
```

* * *

```
 pager.setOffscreenPageLimit(adapter.getCount());

    pager.setPageMargin(15);

    pager.setClipChildren(false); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-24T07:40:50.067

直升机，

在 PagerContainer.java 文件中更改它。我认为这会有所帮助：

```
@Override
public boolean onTouchEvent(MotionEvent ev) {
    // We capture any touches not already handled by the ViewPager
    // to implement scrolling from a touch outside the pager bounds.
    switch (ev.getAction()) {
    case MotionEvent.ACTION_DOWN:
        mInitialTouch.x = (int) ev.getX();
        mInitialTouch.y = (int) ev.getY();
    default:
        if (mInitialTouch.x < mCenter.x) {
            ev.offsetLocation(-(mCenter.x - mInitialTouch.x), mCenter.y - mInitialTouch.y);
        } else {
            ev.offsetLocation(mCenter.x - mInitialTouch.x, mCenter.y - mInitialTouch.y);
        }
        break;
    }

    return mPager.dispatchTouchEvent(ev);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-06T11:33:13.947

在 CommonsWare 的链接解决方法中，触摸处理和硬件加速存在各种问题。一个相当好的解决方案是为 ViewPager 指定负边距：

```
ViewPager.setPageMargin(
    getResources().getDimensionPixelOffset(R.dimen.viewpager_margin)); 
```

然后我在我的`dimens.xml`：

```
<dimen name="viewpager_margin">-64dp</dimen> 
```

为了补偿重叠页面，每个页面的内容视图都有相反的边距：

```
android:layout_marginLeft="@dimen/viewpager_margin_fix"
android:layout_marginRight="@dimen/viewpager_margin_fix" 
```

再次在`dimens.xml`：

```
<dimen name="viewpager_margin_fix">32dp</dimen> 
```

（请注意，`viewpager_margin_fix`尺寸是绝对`viewpager_margin`尺寸的一半。）

我们[在荷兰报纸应用程序*De Telegraaf Krant*](https://play.google.com/store/apps/details?id=com.trab.news)中实现了这一点：

![De Telegraaf Krant 中的电话示例](../Images/da3cf1eae218d4c810622ce206ab099a.png)![平板电脑示例](../Images/b9887be664931b565871356eea12d3ac.png)

# android - 拥有行 uri 后，从内容提供者获取数据的正确方法是什么？

> ID：13086992
> 
> 赞同：4
> 
> 时间：2012-10-26T12:33:22.327
> 
> 标签：android, android-contentprovider

我想知道在我已经知道行 uri 的情况下是否可以直接在游标（或其他容器）中获取内容提供程序行中存在的数据（换句话说，我已经有了 ContentURIs行 ID 附加）。

插入或 Content Observer OnChange（在 android api 16 上）都会返回插入/更改的 URI，我想有效地从该行获取数据（无需太多查询或指令）。但是，我发现的唯一方法是从 URI 中解析 ID，使用该 id 的选择子句构建查询，然后获取光标，如下所示：

```
 long row = ContentUris.parseId(uri);
     String mSelectionClause = ContentProvider.Table._ID + " = ?";
     String[] mSelectionArgs = {Long.toString(row)};
     Uri other_uri = Uri.parse(ContentProvider.AUTHORITY_STRING + ContentProvider.UriPathIndex.Table);
     Cursor cursor = cr.query(other_uri ,null,mSelectionClause,mSelectionArgs,null); 
```

还有其他方法吗？我想知道是否可以直接使用行uri

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T12:46:40.607

引用自[http://developer.android.com/guide/topics/providers/content-provider-basics.html#ContentURIs](http://developer.android.com/guide/topics/providers/content-provider-basics.html#ContentURIs)

许多提供程序允许您通过将 ID 值附加到 URI 的末尾来访问表中的单行。例如，要从用户字典中检索 _ID 为 4 的行，可以使用以下内容 URI：

```
Uri singleUri = ContentUris.withAppendedId(UserDictionary.Words.CONTENT_URI,4); 
```

编辑（来自评论）：它适用于所有标准化的内容提供商（至少是谷歌提供的那些）。它适用于所有遵循由基于行的数据存储支持的内容提供者的设计指南的内容提供者。

# c# - 我怎样才能做一个线程客户端套接字

> ID：13086995
> 
> 赞同：0
> 
> 时间：2012-10-26T12:33:24.843
> 
> 标签：c#, multithreading, sockets

我已经完成了一个简单的 ASPX 页面，只有一个`<asp:Button>`. 此页面将通过 Socket 与 Windows 窗体应用程序建立连接。

**应该如何工作**

每次点击我的`<asp:Button>`我都必须将一些信息传递给我的 Windows 窗体读取，然后我会打印它。

**TCP 服务器代码**

```
public partial class PaginaTeste : System.Web.UI.Page
{
    private TcpListener tcpListener;
    private Thread listenThread;

    protected void Page_Load(object sender, EventArgs e)
    {
    }

    protected void btnBotao_OnClick(object sender, EventArgs e)
    {
        this.tcpListener = new TcpListener(IPAddress.Any, 8849);
        this.listenThread = new Thread(new ThreadStart(ListenForClients));
        this.listenThread.Start();
    }

    private void ListenForClients()
    {
        this.tcpListener.Start();

        while (true)
        {
            //blocks until a client has connected to the server
            TcpClient client = this.tcpListener.AcceptTcpClient();

            //create a thread to handle communication 
            //with connected client
            Thread clientThread = new Thread(new ParameterizedThreadStart(HandleClientComm));
            clientThread.Start(client);
        }
    }

    private void HandleClientComm(object client)
    {
        TcpClient tcpClient = (TcpClient)client;
        NetworkStream clientStream = tcpClient.GetStream();

        byte[] message = new byte[4096];
        int bytesRead;

        while (true)
        {
            bytesRead = 0;

            try
            {
                string serverResponse = "571764;10.";                        
                Byte[] sendBytes = Encoding.ASCII.GetBytes(serverResponse);
                clientStream.Write(sendBytes, 0, sendBytes.Length);
                clientStream.Flush();
            }
            catch
            {
                //a socket error has occured
                break;
            }

            if (bytesRead == 0)
            {
                //the client has disconnected from the server
                break;
            }
        }

        tcpClient.Close();
    } 
```

**客户端代码（Windows 窗体）**

```
 public partial class Form1 : Form
    {
        TcpClient clientsocket2;
        Thread thread;

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {         
        }

        private void button3_click(object sender, EventArgs e)
        {
            this.clientsocket2 = new TcpClient();
           clientsocket2.Connect("server_ip", 8849);       
            this.thread = new Thread(new ThreadStart(this.imprimir));
            this.thread.Start();
        }
protected void imprimir()
        {       
            NetworkStream serverStream = clientsocket2.GetStream();
            byte[] inStream = new byte[10025];
            serverStream.Read(inStream, 0, (int)clientsocket2.ReceiveBufferSize);
            string returndata = System.Text.Encoding.ASCII.GetString(inStream);

            string r = "Printing Test";
            int retorno = -1;

            retorno = IniciaPorta("COM7");            

            if (retorno == 1)
            {
                ConfiguraModeloImpressora(7);
                BematechTX(r);
                AcionaGuilhotina(1);
                FechaPorta();
            }

            clientSocket.Close();
        } 
```

**问题**

如果我单击一次`<asp:Button>`并初始化我的`Client Application`作品就可以了。在我第二次单击`<asp:Button>`传递给我的参数时`Client Application`返回空。

**我在客户端应用程序中读到空的地方**

`string returndata = System.Text.Encoding.ASCII.GetString(inStream);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:59:11.203

为什么在页面中按下按钮时创建 tcpListener？您需要创建 TcpClient 并向您发送命令 Winform App 此代码发送命令并从服务器获取回复

```
string data = "Some_Comand";
        byte[] b = Encoding.ASCII.GetBytes(data);
        byte[] buffer = new byte[1024];
        var client = new TcpClient();
        var serverEndPoint = new IPEndPoint(IPAddress.Parse("ip"), 8010);
        client.Connect(serverEndPoint);
        var clientStream = client.GetStream();
        clientStream.Write(b, 0, b.Length);
        Socket s = client.Client;
        byte[] receiveData = new byte[200];
        s.Receive(receiveData);
        Debug.WriteLine(Encoding.ASCII.GetString(receiveData)); 
```

就这样