# StackOverflow 问答 12665000-12665999

# javascript - 如果函数名不是“构造字符串”，JavaScript Factory 类会抛出错误

> ID：12665000
> 
> 赞同：0
> 
> 时间：2012-09-30T20:48:57.693
> 
> 标签：javascript, exception, object, factory, dynamic-loading

我有一个工厂类，我在 JavaScript 中使用它通过 AJAX 动态加载类文件，然后返回一个对象。我在系统中遇到了一个非常特殊的错误，尽管它会在每个浏览器中引发错误，但在我无法解释的情况下。

这是我的 Factory 类的简化版本（我删除了许多类型检查和错误处理以将其减少到最低限度）。

```
function Factory(){
    // This holds which files have already been loaded
    var loaded=new Object();

    // Returns a new object
    this.getObject=function(className,methodName,methodData){

        if(loadFile('class.'+className+'.js')){

            // Making sure that the object name is defined
            if(window[className]!=null){

                // Has to be an object
                if(typeof(window[className])=='function'){

                    // Creating a temporary object
                    return new window[className];
                }
            }
        }
    }
    // Loads a file over AJAX
    var loadFile=function(address){

        // Loads as long as the file has not already been loaded
        if(loaded[address]==null){

            // Required for AJAX connections (without ASYNC)
            var XMLHttp=new XMLHttpRequest();
            XMLHttp.open('GET',address,false);
            XMLHttp.send(null);

            // Result based on response status
            if(XMLHttp.status===200 || XMLHttp.status===304){

                // Getting the contents of the script
                var data=XMLHttp.responseText;

                // Loading the script contents to the browser
                (window.execScript || function(data){
                    window['eval'].call(window,data);
                })(data);

                // makes sure that file is loaded only once
                loaded[address]=true;
            }
        }
    } 
```

这是用户所做的：

```
 var Factory=new Factory();
 var alpha=Factory.getObject('example');
 alpha.set(32);
 alpha.get();
 var beta=Factory.getObject('example');
 beta.set(64);
 alpha.get();
 beta.get(); 
```

`return new window[className];`这失败了，当函数第二次运行时（在该行），它说“对象不是函数” 。我明白如果我在这里遗漏了什么，但这是踢球者：

如果我`className`在`window[]`电话中添加前缀，那么它可以工作。例如，如果我将`'example'`类文件名更改为`'test_example'`然后有这些行：

```
... if(window['test_'+className]!=null){ ...
... if(typeof(window['test_'+className])=='function'){ ...
... return new window['test_'+className]; ... 
```

然后它可以工作，并且 alpha 和 beta 对象都按预期工作。当我纯粹通过变量引用它们时，它们会失败。我尝试了 className.toString() 之类的方法但没有成功，甚至失败了：

```
className+'' 
```

这真的很奇怪，我不知道在哪里寻找和尝试什么，有谁知道为什么会发生这种情况？

编辑：这是正在加载的“example.js”脚本的示例：

```
function example(){

    var myVar=16;

    this.set=function(value){
        myVar=value;
    }

    this.get=function(){
        alert(myVar);
    }

} 
```

（如果我将其重命名为 test_example() 并使用构造字符串加载如上所示的函数，那么它再次起作用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T08:22:18.643

我弄清楚了错误在哪里，而我上面的精简版本没有显示。显然我将我的新变量命名为与类本身的名称相同，因此在第一次初始化后它被覆盖了。

# objective-c - NSPredicate 和 CoreData？

> ID：12665001
> 
> 赞同：1
> 
> 时间：2012-09-30T20:48:58.330
> 
> 标签：objective-c, ios, core-data, nspredicate

如果直接添加到谓词，查询工作正常

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"author == %@", author];
[request setPredicate:predicate];
[self.managedObjectContext executeFetchRequest:request error:nil]; 
```

如果创建查询然后传递给谓词，则查询不起作用

有解决办法吗？我宁愿不将谓词本身传递给方法

**Author 是 NSManagedObject 的子类**

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Unable to parse the format string "%@"'

[self fetchObjectsWithQuery:[NSString stringWithFormat:@"author == %@", author];

- (void)fetchObjectsWithQuery:(NSString *)query
{
   NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%@", query];
   [request setPredicate:predicate];
   [self.managedObjectContext executeFetchRequest:request error:nil];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T11:33:24.230

格式字符串的工作方式不同

```
NSString *query = [NSString stringWithFormat:@"author == %@", author] // (1) 
```

和

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"author == %@", author] 
```

特别是占位符“%@”和“%K”有不同的含义。

(1) 产生形式为的*字符串*

```
"author == <textual description of author object>" 
```

您不能在其中使用

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%@", query]; 
```

因此，您不能将谓词预先格式化为字符串。另一个演示问题的示例：

```
[NSPredicate predicateWithFormat:@"author == nil"] 
```

有效，但是

```
[NSPredicate predicateWithFormat:"%@", @"author == nil"] 
```

才不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:37:56.620

没有充分的理由不创建和传递`NSPredicate`对象。有一些方法可以准确地完成您想做的事情，但它们要么比仅使用谓词更具表现力，要么需要您复制底层的逻辑`NSPredicate`。

# sql - 对 CTE 查询进行排序

> ID：12665003
> 
> 赞同：2
> 
> 时间：2012-09-30T20:49:07.040
> 
> 标签：sql, tsql

我有一个 CTE 递归查询，它按预期返回输出，但是如果我可以控制排序会很好。例如，我想通过使用表中的自定义 SORT 列对 PARENT 节点进行排序......并且如果可能，也可以使用 SORT 列对父类别下的节点进行排序。

Hete 是[SQL Fiddle](http://sqlfiddle.com/#!3/1a7eb/4)

请看排序列，排序输出应该是这样的。

```
 Appliances < -- Parent
   Dryers
   Washers
 Toys < -- Parent
 Furniture < -- Parent 
```

如果不可能对子节点进行排序，那么它很好，但至少控制父节点的排序会很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T22:06:14.840

**编辑**

试试[这个](http://sqlfiddle.com/#!3/0b5e1/8/0)最新的问题/小提琴编辑。同样的想法，但多了一个 ISNULL，因为我忘了在递归部分处理 NULL 排序。

```
;WITH cte AS (
    SELECT 0 AS lvl, catcode, catName, parentID,
        CAST(catCode AS VARCHAR(max)) AS Path,
        CAST(isnull(sort,9999) AS VARCHAR(max)) AS SortPath
    FROM categories WHERE parentID =0
    UNION ALL
    SELECT p.lvl + 1, c.catCode, c.catName, c.parentID,
        p.Path + '_' + CAST(c.catCode AS VARCHAR(max)),
        p.SortPath + '_' + CAST(isnull(c.sort,9999) AS VARCHAR(max))
    FROM categories c
    INNER JOIN cte p ON p.catCode = c.parentID
)
SELECT 
    catCode, 
    catName AS catName, 
    lvl,
    Path,
    parentID
FROM cte 
ORDER BY SortPath 
```

注意：一系列字符串连接中的单个 varchar(max) 使最终结果为 varchar(max)。一个演员就可以了。

仅供参考 - 对于未来的 SQL 问题，如果你能准备一个[SQLFiddle](http://sqlfiddle.com)模式，以及到目前为止你有什么查询，那就太好了。这允许其他人在设置上花费最少的时间。如果您必须扩展示例或提供 what if 查询变体，它也有助于讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-27T08:45:58.330

虽然你可以找到你的问题的答案，但我认为这个问题的整个想法是错误的。从 DB 中获取记录（未排序）后，通常会将它们转换为某种对象层次结构。在那里，您可以非常快速地构建层次结构，而无需对记录进行排序。

# php - 500内部服务器错误。第一个参数应该是一个数组

> ID：12665006
> 
> 赞同：0
> 
> 时间：2012-09-30T20:49:49.330
> 
> 标签：php, zend-framework, magento

我在一个站点（www.theprinterdepo.com）上遇到了一个非常奇怪的问题，在谷歌浏览器中我看到了 500 个内部服务器错误。但是在 IE 和 firefox 上它可以正常工作）。我注意到的是，如果我转到 chrome 并单击历史记录并删除所有缓存、cookie 等，那么它会再次正常工作。

我删除了 system.log 并再次检查，唯一记录的是这个：

第一个参数应该是 /xxx/xxx/public_html/app/code/local/Mf/Searchterms/Model/Layer.php 中的一个数组

这是我从未接触过的标准 magento 文件，但这里是代码：

```
<?php

class Mf_Searchterms_Model_Layer extends Mage_Catalog_Model_Layer
{
    const XML_PATH_DISPLAY_LAYER_COUNT = 'catalog/search/use_layered_navigation_count';

    /**
     * Get current layer product collection
     *
     * @return Mage_Catalog_Model_Resource_Eav_Resource_Product_Collection
     */
    public function getProductCollection()
    {
        if (isset($this->_productCollections[$this->getCurrentCategory()->getId()])) {
            $collection = $this->_productCollections[$this->getCurrentCategory()->getId()];
        } else {
            $collection = Mage::getResourceModel('catalogsearch/fulltext_collection');
            $this->prepareProductCollection($collection);
            $this->_productCollections[$this->getCurrentCategory()->getId()] = $collection;
        }
        return $collection;
    }

    /**
     * Prepare product collection
     *
     * @param Mage_Catalog_Model_Resource_Eav_Resource_Product_Collection $collection
     * @return Mage_Catalog_Model_Layer
     */
    public function prepareProductCollection($collection)
    {

        $params = Mage::app()->getRequest()->getParams();

        $collection
            ->addAttributeToSelect(Mage::getSingleton('catalog/config')->getProductAttributes());
        $query = Mage::helper('catalogsearch')->getQuery();
        $productIds = Mage::getModel('searchterms/searchterms')->getProducts($query->getId());
        $productIds = array_filter($productIds);
        //var_dump($productIds);

        if(is_array($productIds) && sizeof($productIds) > 0){
            //echo "asd";
            $productIdArray = $productIds;
            $collection->addFieldToFilter('entity_id', array('in'=>$productIdArray));
            $collection->joinField('position',
                'searchterms_product',
                'position',
                'product_id=entity_id',
                'searchterms_id='.$query->getId(), 
                'left')
                ;

                if(isset($params['order']) && $params['order'] != ""){
                    Mage::getSingleton('catalog/product_status')->addVisibleFilterToCollection($collection);
                    Mage::getSingleton('catalog/product_visibility')->addVisibleInSearchFilterToCollection($collection);
                }else{
                    $collection->setOrder(`searchterms_product`.'position','ASC');
                    Mage::getSingleton('catalog/product_status')->addVisibleFilterToCollection($collection);
                }
        }
        else 
        {
            $collection->addSearchFilter(Mage::helper('catalogsearch')->getQuery()->getQueryText());
            $collection->setStore(Mage::app()->getStore())
                ->addMinimalPrice()
                ->addFinalPrice()
                ->addTaxPercents()
                ->addStoreFilter()
                ->addUrlRewrite();
            Mage::getSingleton('catalog/product_status')->addVisibleFilterToCollection($collection);
            Mage::getSingleton('catalog/product_visibility')->addVisibleInSearchFilterToCollection($collection);
        }

        return $this;
    }

    /**
     * Get layer state key
     *
     * @return string
     */
    public function getStateKey()
    {
        if ($this->_stateKey === null) {
            $this->_stateKey = 'Q_' . Mage::helper('catalogsearch')->getQuery()->getId()
                . '_'. parent::getStateKey();
        }
        return $this->_stateKey;
    }

    /**
     * Get default tags for current layer state
     *
     * @param   array $additionalTags
     * @return  array
     */
    public function getStateTags(array $additionalTags = array())
    {
        $additionalTags = parent::getStateTags($additionalTags);
        $additionalTags[] = Mage_CatalogSearch_Model_Query::CACHE_TAG;
        return $additionalTags;
    }

    /**
     * Add filters to attribute collection
     *
     * @param   Mage_Catalog_Model_Resource_Eav_Resource_Product_Attribute_Collection $collection
     * @return  Mage_Catalog_Model_Resource_Eav_Resource_Product_Attribute_Collection
     */
    protected function _prepareAttributeCollection($collection)
    {
        $collection->addIsFilterableInSearchFilter()
            ->addVisibleFilter();
        return $collection;
    }

    /**
     * Prepare attribute for use in layered navigation
     *
     * @param   Mage_Eav_Model_Entity_Attribute $attribute
     * @return  Mage_Eav_Model_Entity_Attribute
     */
    protected function _prepareAttribute($attribute)
    {
        $attribute = parent::_prepareAttribute($attribute);
        $attribute->setIsFilterable(Mage_Catalog_Model_Layer_Filter_Attribute::OPTIONS_ONLY_WITH_RESULTS);
        return $attribute;
    }
} 
```

**更新1：** 我设法清理了apache错误日志，刷新了浏览器，然后这是日志上的新文本：[client 83.134.115.127]脚本头过早结束：index.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T20:55:47.800

可能第一行 ( `Mage::..`) 返回`NULL`或`FALSE`结果集为空且 array_filter 需要数组，而不是 null/false 值！尝试这个：

```
$productIds = Mage::getModel('searchterms/searchterms')->getProducts($query->getId());
if (!$productIds) {
    $productIds = array();
}
$productIds = array_filter($productIds); 
```

但这（可能）是一种错误的使用方式`array_filter`。如果没有第二个参数，它将过滤任何评估为 的数组元素`false`，例如，如果一个元素是`null`, `false`, `empty array`, `empty string`。但我怀疑这`Mage::getModel(...)->getProducts(...);`是否会返回这些元素（对特定情况没有任何了解）。但是，如果它确实返回包含此类元素的数组，则表明其背后的设计不佳。

# javascript - Raphael SVG 动画在某些浏览器中不稳定

> ID：12665007
> 
> 赞同：18
> 
> 时间：2012-09-30T20:49:54.433
> 
> 标签：javascript, performance, svg, cross-browser, raphael

我有一个 SVG 对象，我正在使用 Raphael 将它添加到我的页面中。在 6 组中大约有 175 条路径，我怀疑它算得上是复杂的。

我正在使用 .animate 函数为 6 个集合中的每一个设置动画

```
function anim(direction, duration){
    return Raphael.animation({transform: "r"+direction+"360 250 250"}, duration).repeat("Infinity");
}
IG.sets.white_outer.animate(anim("",100000)); // 2 paths 
IG.sets.grey_outer.animate(anim("-",100000)); // 25 paths
IG.sets.grey_inner.animate(anim("",100000));  // 25 paths

$(window).load(function(){                      
    IG.sets.BLUE.animate({transform: "r0 250 250"}, 4000, ">");  // 32 paths
    IG.sets.RED.animate({transform: "r0 250 250"}, 3000, ">");   // 29 paths
    IG.sets.GREEN.animate({transform: "r0 250 250"}, 2000, ">"); // 24 paths
} 
```

问题是在某些浏览器中，这看起来很不稳定。

在 Mac 上流畅如黄油（测试：FF、Chrome、Safari）。它在 Chrome 中的 Windows 上也很可爱，但是当我加载 Windows FF、Safari 或 IE8 时，动画会断断续续，有点卡顿。

它甚至在 iPad 上看起来也很棒！

我希望能够让它们看起来都很棒......所以我试图找出 FF 和 Safari 中所有功能的成本（最终，希望我管理的任何覆盖都会带来一个也修复了 IE8）。

从我在 Raphael 上看到的关于波涛汹涌的动画的其他问题中，我看到提到“进入胆量”以向动画函数添加超时......（如 raphael-min.js 中所示）

```
cz= window.requestAnimationFrame||
    window.webkitRequestAnimationFrame||
    window.mozRequestAnimationFrame||
    window.oRequestAnimationFrame||
    window.msRequestAnimationFrame||
    function(a){setTimeout(a,16)}, /* there is a function here that animates */ 
```

虽然它看起来像在 FF 中，例如 RequestAnimationFrame 提供了比 setTimeout 更平滑的性能。（我通过删除 mozRequestAnimationFrame 条件并重新加载对此进行了测试，尝试了各种超时间隔）

还有什么我可能会遗漏的东西可能有助于提高我的动画的跨浏览器帧速率吗？

请注意，例如图像默认为 500x500，并且围绕图像中心（点 250x250）进行旋转，但是图像以 1000x1000 显示在页面上（视口在页面加载时进行缩放。

如果我让设计师将图像调整为 1000x1000 画布，并且从一开始就以全尺寸显示，我是否有可能得到提升？也许是“更顺畅的骑行”？我不确定哪些因素会影响 SVG 动画和性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:41:31.467

您应该查看 Element.animateWith ( [http://raphaeljs.com/reference.html#Element.animateWith](http://raphaeljs.com/reference.html#Element.animateWith) )。它具有一项功能，可让您将一个动画与另一个动画同步，以便所有内容都同步更新。如果浏览器或设备速度很慢，这种波动无济于事，但同步动画应该会让它看起来更好。

# ruby - 使用 rake 复制保留目录结构的文件

> ID：12665008
> 
> 赞同：7
> 
> 时间：2012-09-30T20:49:56.867
> 
> 标签：ruby, rake, rakefile

我的目标是将一组由模式指定的文件复制到目标目录。源目录中的文件可以有子目录。

我试过了：

```
cp_r(Dir.glob('**/*.html'), @target_dir): 
```

和

```
cp_r(FileList['**/*.html'], @target_dir): 
```

但两者都不起作用。

它仅在我执行以下操作时才有效：

```
cp_r(Dir['.'], @target_dir): 
```

但我只需要复制 *.html 文件而不是其他任何东西。

我需要什么

```
cp --parents 
```

命令确实

使用现有的 Ruby/Rake 方法有什么建议吗？

**更新**看起来用 Ant 更容易做的事情，用 Ruby/Rake 堆栈是不可能的——可能我需要研究别的东西。我不想编写自定义代码以使其在 Ruby 中工作。我只是认为 Ruby/Rake 是合适的解决方案。

**更新 2**这就是我使用 Ant 的方式

```
<target name="buildeweb" description="Builds web site" depends="clean">
    <mkdir dir="${build.dir.web}" />

    <copy todir="${build.dir.web}" verbose="true">
        <fileset dir="${source.dir.web}">
            <include name="**/*.html" />
            <include name="**/*.htm" />
        </fileset>
    </copy>

    <chmod perm="a+x">
        <fileset dir="${build.dir.web}">
            <include name="**/*.html" />
            <include name="**/*.htm" />
        </fileset>
    </chmod>
</target> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T00:05:31.240

如果你想要纯 Ruby，你可以这样做（在标准库中 FileUtils 的帮助下）。

```
require 'fileutils'

Dir.glob('**/*.html').each do |file|
  dir, filename = File.dirname(file), File.basename(file)
  dest = File.join(@target_dir, dir)
  FileUtils.mkdir_p(dest)
  FileUtils.copy_file(file, File.join(dest,filename))
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T23:49:01.720

我没听说过`cp --parents`，但是如果它可以满足您的要求，那么从您的 Rakefile 中使用它就不会感到羞耻，如下所示：

```
system("cp --parents #{your} #{args}") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T02:16:46.870

这可能很有用：

```
# copy "files" to "dest" with any sub-folders after "src_root". 
def copy_and_preserve files, dest, src_root
  files.each {|f|
    f.slice! src_root # the files without src_root dir
    dest_dir = File.dirname(File.join(dest, f))
    FileUtils.mkdir_p dest_dir # make dest dir
    FileUtils.cp(File.join(src_root, f), dest_dir, {:verbose => true})
  }
end 
```

# modernizr - Google WebFonts Loader - 顶部还是底部？

> ID：12665010
> 
> 赞同：1
> 
> 时间：2012-09-30T20:50:17.963
> 
> 标签：modernizr, webfonts

根据 HTML5 Boilerplate 团队（当然还有许多其他作者）的说法，给定页面上的所有 JS 都应该尽可能地放在底部（就在`</body>`标签之前），除了 Modernizr，因为它在页面加载。

据我所知，鉴于 Google WebFonts Loader 的工作方式与 Modernizr 几乎相同（通过进行`@font-face`特征检测并向`<html>`标签添加类），我想知道这个脚本是否同样适用......

这应该放在`<head>`or`<body>`标签上吗？有那么重要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T20:34:47.060

简短的回答：正如页面加载速度纯粹主义者愿意告诉你的那样，事实是，不，这实际上并不重要。把它放在顶部。

将 JS 包含在页面底部的唯一原因是出于页面加载性能的原因。如果将其放在顶部不会导致明显的性能下降，那么这真的没关系。特别是它只是一两个脚本，你坚持让你的大部分脚本仍然在底部。事实是：对于大多数网站来说，它所产生的差异可以忽略不计。

我真的不知道答案，因为它专门适用于 Google Webfonts，因为我还没有使用过那个库，但我的建议是把它放在 Modernizr 的顶部，不用担心它。

# cakephp - Cakephp 1.3：选择框的奇怪行为。查找列表不起作用，并且发现所有工作都奇怪

> ID：12665011
> 
> 赞同：0
> 
> 时间：2012-09-30T20:50:17.860
> 
> 标签：cakephp, cakephp-1.3

表 Cs_grpusu 指定了我办公室的区域。表用户具有 Cs_grpusu 的外键

cs_grpusu 模型（cs_grpusu.php）：

```
<?php
class CsGrpusu extends AppModel {
    var $name = 'Cs_grpusu';
    var $useTable = 'Cs_grpusu';
    var $primaryKey = 'grpusu';
    var $displayField = 'desgrp';
}
?> 
```

cs_grpusu 控制器（cs_grpusus_controller.php）：

```
<?php
class CsGrpususController extends AppController {
    var $uses = 'Cs_gprusu';
}
?> 
```

cs_grpusu 表内容： ![表格内容](../Images/d006c689847dafad33a2b37c0fc155f0.png)

在我的用户模型中，我设置了这个：

```
var $belongsTo = array(        
    'Cs_grpusu' => array(           
        'className'    => 'cs_grpusu',            
        'foreignKey'    => 'area'        
    )    
); 
```

现在我将把这些区域放在我的 User add.ctp 视图表单中：

```
echo $form->input('area',array('type' => 'select','options'=>$group)); 
```

到现在我觉得还可以。现在的问题。如果在我的用户控制器中，我以这种方式填充“组”：

```
$this->set('grupos',$this->User->Cs_grpusu->find('all')); 
```

我的选择框选项变得像这样奇怪（并且，调试时，我得到了我将在下面描述的错误）：

![奇怪的选择框](../Images/f0c3fa9e977eb1eed6b299531398102f.png)

现在，如果我尝试像这样填充组变量：

```
$this->set('grupos',$this->User->Cs_grpusu->find('list', array('fields'=>array('Cs_grpusu.grpusu','Cs_grpusu.desgrp')))); 
```

我的选择框中没有出现任何选项，并且我还收到以下错误：

```
Notice (8): Undefined index: cs_grpusu [CORE\cake\libs\model\datasources\dbo\dbo_firebird.php, line 455]

CONTEXT

$results    =   resource
$num_fields =   2
$index  =   1
$j  =   0
$column =   array(
    "GRPUSU",
    "name" => "GRPUSU",
    "GRPUSU",
    "alias" => "GRPUSU",
    "CS_GRPUSU",
    "relation" => "CS_GRPUSU",
    "2",
    "length" => "2",
    "SMALLINT",
    "type" => "SMALLINT"
)

CODE:

$column = ibase_field_info($results, $j);
            if (!empty($column[2])) {
                $this->map[$index++] = array(ucfirst(strtolower($this->modeltmp[strtolower($column[2])])), strtolower($column[1])); 
```

那么，我应该怎么做才能让我的选择框只有“接待，预算......”选项而没有那些奇怪的数字，并且没有未定义的索引错误？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:07:11.870

将模型类命名为“Cs_grpusu”是您犯的第一个错误，它应该是“CsGrpusu”。CakePHP 中的所有类名都是驼峰式命名的。阅读有关文件和类命名约定的[手册。](http://book.cakephp.org/1.3/en/view/902/File-and-Classname-Conventions)

# objective-c - Objective-C 不区分大小写和土耳其字符

> ID：12665017
> 
> 赞同：2
> 
> 时间：2012-09-30T20:51:58.873
> 
> 标签：objective-c, regex

我有一个正则表达式来搜索字符串，然后将它们包装在某些 html 标记中。问题是两个土耳其语字符（İ 和 ı）不匹配它们的小写或大写。所以它们不能正确包装。

更准确地说：

*   i 甚至 İ 与 İ 不匹配（它可能变成“I”）
*   我与 ı 不匹配（它可能变成“i”）

示例：搜索词是 İskendername。该字符串完全按照原样包含它（İskendername），但根本没有匹配项。

这是我的代码：

```
 NSString *regex_pattern =  [[NSArray arrayWithObjects:@"(", search_term, @")(?![^<>]*>)",nil] componentsJoinedByString:@""];

    NSError *error = NULL;

    NSRegularExpression *regex = [NSRegularExpression 
regularExpressionWithPattern:regex_pattern options:NSRegularExpressionCaseInsensitive error:&error];

   string_to_be_searched = [regex stringByReplacingMatchesInString:string_to_be_searched options:0 range:NSMakeRange(0, [stringByReplacingMatchesInString:string_to_be_searched length]) withTemplate:@"<div class=""highlight"">$1</div>"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T23:13:07.227

自己解决了。方法如下：

我无法获得任何类型的 NS.. 支持土耳其字符的选项。有损转换会导致我渲染的内容出现缺陷。所以我是这样整理的：

正如我所说，存在一个问题，即 -I- 被理解为 -i- 并且 -i- 被视为 I，但土耳其字母表并非如此。我们有一个小写字母 -ı- 和一个大写字母 -İ-。

我所做的是改变我的正则表达式。所以基本上我检查了 NSString 中的所有字母，并用 [iİıI] 替换了有问题的字母（I 和 i），所以我的正则表达式会接受它们，无论它们是否在顶部有一个点！

这是代码以防有人需要它..

```
- (NSString*)returnRegexPatternForSearchString:(NSString *)search_string
{
NSString *regex_pattern = [[NSString alloc] init];

for(int i =0 ;i<[search_string length]; i++)
{

 if([[search_string substringWithRange:NSMakeRange(i, 1)] isEqualToString:@"ı"] ||        [[search_string substringWithRange:NSMakeRange(i, 1)] isEqualToString:@"I"])
 {
  regex_pattern = [regex_pattern stringByAppendingString:@"[ıI]"];
 }
 else if([[search_string substringWithRange:NSMakeRange(i, 1)] isEqualToString:@"i"] || [[search_string substringWithRange:NSMakeRange(i, 1)] isEqualToString:@"İ"])
 {

    regex_pattern = [regex_pattern stringByAppendingString:@"[iİıI]"];
 }
 else
 {
     regex_pattern = [regex_pattern stringByAppendingString:[search_string substringWithRange:NSMakeRange(i, 1)]];
  }
}

return regex_pattern;
} 
```

# c# - 串口工作线程随机冻结

> ID：12665020
> 
> 赞同：1
> 
> 时间：2012-09-30T20:52:26.533
> 
> 标签：c#, multithreading, serial-port, backgroundworker

我通过以下代码调用我的后台工作人员：

```
private void UpdateDataTimer_Tick(object sender, EventArgs e)
{
    if (!serialPortWorker.IsBusy)
    {
        serialPortWorker.RunWorkerAsync();
    }
} 
```

我的`DoWork`活动如下：

```
private void serialPortWorker_DoWork(object sender, DoWorkEventArgs e)
{
    //Configures serial port
    connection.BaudRate = 19200;
    connection.DataReceived += new SerialDataReceivedEventHandler(DataReceivedEvent);

    //Sends the commands for opening diagnostics
    string[] init_commands = { "STRING", "STRING", "STRING", "STRING", "STRING" };
    foreach (string command in init_commands)
    {
        connection.WriteLine(command + connection.NewLine);
        Thread.Sleep(1000);
    }

    const string constant_message_section = "G03";
    string[] command_list = { "62", "64", "5C" };

    //Writes all commands to all radio addresses
    foreach (int address in radioAddresses)
    {
        foreach (string command in command_list)
        {
            for (int i = 0; i < MAX_ATTEMPTS; i++)
            {
                connection.WriteLine(constant_message_section + address.ToString("X4") + command);
                Thread.Sleep(500);
            }
        }
    }

    Thread.Sleep(1000); //Give a little time for all responses to come in
} 
```

出于某种原因，在调用了几百`UpdateDataTimer_Tick`次事件之后，它就不再运行了`serialPortWorker`。我在 上放了一个调试器`if (!serialPortWorker.IsBusy)`，它表明它`serialPortWorker`仍然很忙。它一定是在`DoWork`活动的某个地方挂了，对吧？任何想法为什么？

感兴趣的可以看下数据接收事件如下：

```
public void DataReceivedEvent(object sender, SerialDataReceivedEventArgs e)
{
    SerialPort sp = (SerialPort)sender;
    string receive = sp.ReadLine();

    try
    {
        Debug.Logger.WriteToDebug("Data Received Serial Port: " + receive);
    }
    catch { }

    try
    {
        int unit_address = Int32.Parse(receive.Substring(1, 4), System.Globalization.NumberStyles.HexNumber);

        if (radioAddresses.Contains(unit_address))
        {
            int radio_index = radioAddresses.IndexOf(unit_address) + 1;
            int max_index = radio_index * 3;

            integrityMonitor[radio_index] = DateTime.Now; //Last updated time

            int message_data = 0;

            if (receive.Contains("66"))
            {
                //Stuff
            }
            else if (receive.Contains("61"))
            {
                //Stuff
            }
            else if (receive.Contains("55"))
            {
                //Stuff
            }
        }
    }
    catch { }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T13:00:32.450

好的，既然没有人留下答案，我会的。问题是线路

```
connection.DataReceived += new SerialDataReceivedEventHandler(DataReceivedEvent); 
```

在后台工作人员的计时器的每个滴答声中被调用。这将导致事件处理程序的大量实例，最终导致后台工作人员锁定并一直报告忙碌。为了纠正这个问题，我需要输入

```
connection.DataReceived -= new SerialDataReceivedEventHandler(DataReceivedEvent); 
```

为了避免有许多事件处理程序处理接收到的数据事件。这解决了我的问题。

# python - python字典使用defaultdict(list)

> ID：12665021
> 
> 赞同：0
> 
> 时间：2012-09-30T20:52:46.717
> 
> 标签：python

我正在使用`collections.defaultdict(list)`.

我的打印如下所示：

```
{ 'A': [{'UNP': 'P01899'}],
  'C': [{'PDB': '2VE6'}], 
  'B': [{'PDB': '2VE6'}, {'UNP': 'P01887'}], 
  'E': [{'PDB': '2VE6'}, {'UNP': 'P01887'}],
  'D': [{'UNP': 'P01899'}],
  'G': [{'UNP': 'P01899'}],
  'F': [{'PDB': '2VE6'}], 
  'I': [{'PDB': '2VE6'}],
  'H': [{'PDB': '2VE6'}, {'UNP': 'P01887'}],
  'K': [{'PDB': '2VE6'}, {'UNP': 'P01887'}],
  'J': [{'UNP': 'P01899'}], 
  'L': [{'PDB': '2VE6'}] } 
```

我想要做的是使用一个子句 if `'UNP'`do something, if only `'PDB'`and no `'UNP'`then do something different.

我对脚本很陌生。所以非常感谢任何帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:24:26.130

一种方法是

```
>>> for key,val in my_dict.items():
...     keys = [v.keys()[0] for v in val]
...     if "UNP" in keys: print "UNP in",key
...     elif "PDB" in keys: print "PDB in",key
...
UNP in A
PDB in C
UNP in B
UNP in E
UNP in D
UNP in G
PDB in F
PDB in I
UNP in H
UNP in K
UNP in J
PDB in L
>>> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:54:23.897

如果每个项目最多只能有 1 个“UNP”且最多只能有 1 个“PDB”，则应在开头使用 defaultdict(dict)。然后你可以做这样的插入：

```
mydict['A']['UNP'] = 'P01899' 
```

并自动轻松地获得类似的数据结构

```
{ 'A': {'UNP': 'P01899'},
  'C': {'PDB': '2VE6'}, 
  'B': {'PDB': '2VE6', 'UNP': 'P01887'}, 
  'E': {'PDB': '2VE6', 'UNP': 'P01887'},
  'D': {'UNP': 'P01899'},
  'G': {'UNP': 'P01899'},
  'F': {'PDB': '2VE6'}, 
  'I': {'PDB': '2VE6'},
  'H': {'PDB': '2VE6', 'UNP': 'P01887'},
  'K': {'PDB': '2VE6', 'UNP': 'P01887'},
  'J': {'UNP': 'P01899'}, 
  'L': {'PDB': '2VE6'} } 
```

那么你想要的就很简单了：

```
itemA = mydict['A']
if 'UNP' in itemA:
    # now we have 'UNP'
elif 'PDB' in itemA:
    # now we have PDB but not UNP 
```

# java - Java：使用谷歌地图坐标围绕另一个点旋转一个点

> ID：12665022
> 
> 赞同：2
> 
> 时间：2012-09-30T20:52:54.753
> 
> 标签：java, google-maps, rotation, coordinates, point

从谷歌地球我得到了一个带有图片坐标的框，如下所示：

```
 <LatLonBox>
        <north>53.10685</north>
        <south>53.10637222222223</south>
        <east>8.853144444444444</east>
        <west>8.851858333333333</west>
        <rotation>-26.3448</rotation>
    </LatLonBox> 
```

现在我想测试一个与这个 LatLonBox 相交的点的天气。我的基本想法是检查一个点是否与 LatLonBox 相交，将点旋转给定角度，然后测试该点是否与常规（未旋转）矩形相交。

我试图手动计算旋转：

```
public static MyGeoPoint rotatePoint(MyGeoPoint point, MyGeoPoint origion, double degree)
{
double x = origion.getLatitude() + (Math.cos(Math.toRadians(degree)) * (point.getLatitude() - origion.getLatitude()) - Math.sin(Math.toRadians(degree)) * (point.getLongitude() - origion.getLongitude()));
double y =  origion.getLongitude()  + (Math.sin(Math.toRadians(degree)) * (point.getLatitude() - origion.getLatitude()) + Math.cos(Math.toRadians(degree))  * (point.getLongitude() - origion.getLongitude()));

return new MyGeoPoint(x, y); 
```

}

```
public boolean intersect(MyGeoPoint geoPoint)
{   
    geoPoint = MyGeoPoint.rotatePoint(geoPoint, this.getCenter(), - this.getRotation());

    return (geoPoint.getLatitude() < getTopLeftLatitude()
            && geoPoint.getLatitude() > getBottomRightLatitude()
                && geoPoint.getLongitude() > getTopLeftLongitude()
                    && geoPoint.getLongitude() < getBottomRightLongitude());
} 
```

结果似乎是错误的。

```
 LatLonBox box = new LatLonBox(53.10685, 8.851858333333333, 53.10637222222223, 8.853144444444444, -26.3448);

    MyGeoPoint point1 = new MyGeoPoint(53.106872, 8.852311);
    MyGeoPoint point2 = new MyGeoPoint(53.10670378322918, 8.852967186822669);   
    MyGeoPoint point3 = new MyGeoPoint(53.10652664993972, 8.851994565566875);
    MyGeoPoint point4 = new MyGeoPoint(53.10631650700605, 8.85270995172055);

    System.out.println(box.intersect(point1));
    System.out.println(box.intersect(point2));
    System.out.println(box.intersect(point3));
    System.out.println(box.intersect(point4)); 
```

结果是真，假，假，真。但它应该是真实的 4 倍。可能是我，在推理中犯了某种错误。也许是因为纬度值向上变大。但我不知道如何更改公式。

我需要一些帮助 ...

* * *

编辑：我认为我的基本想法和公式是正确的。我也找到了类似的解决方案，例如。[链接](http://developer.coronalabs.com/code/checking-if-point-inside-rotated-rectangle)，找不到任何区别。

所以我认为唯一可能的误差源是轴不成比例。所以问题是如何考虑这一点。

我希望有人有一个想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T14:04:26.607

问题确实是轴不成比例。

以下方法可以解决它。

```
public static MyGeoPoint rotatePoint(MyGeoPoint point, MyGeoPoint origion, double degree)
{
double x =  origion.longitude   + (Math.cos(Math.toRadians(degree)) * (point.longitude - origion.longitude) - Math.sin(Math.toRadians(degree))  * (point.latitude - origion.latitude) / Math.abs(Math.cos(Math.toRadians(origion.latitude)));
double y = origion.latitude + (Math.sin(Math.toRadians(degree)) * (point.longitude - origion.longitude) * Math.abs(Math.cos(Math.toRadians(origion.latitude))) + Math.cos(Math.toRadians(degree))   * (point.latitude - origion.latitude));
return new MyGeoPoint(x, y);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:48:44.057

The problem appears to be that the data structure `LatLonBox` doesn't make any sense as a description for the boundary of a picture. A box in lat-lon coordinates is *not* a geometric rectangle. (Think about a box near or including the north pole.) You need to re-think your application to deal in a lat/lon coordinate for the *center* of the picture and then deal with the rotation as an angle with respect to lines of latitude (parallel to the equator). (Even then, a picture with center on the north or south pole will be a degenerate case that must be handled separately.) So a box should properly be something like:

```
<geobox>
  <center_lat>41</center_lat>
  <center_lon>-74</center_lon>
  <rotation_degrees_ccw>-23</rotation_degrees_ccw>
  <width>1000</width> <!-- in pixels or meters, but not in degrees! -->
  <height>600</height> <!-- same as above -->
</geobox> 
```

Having said all that, suppose you have a true geometric box centered at (x0,y0), width w, height h, rotated angle T about its *center*. Then you can test a point P(x,y) for membership in the box with the following. You need the transformation that takes the box to the origin and aligns it with the axes. This is Translate(-x0,-y0) then Rotate(-T). This transformation as a matrix is

```
[cos(-T) -sin(-T) 0][1 0 -x0]   [ cos(T)  sin(T) -x0*cos(T)-y0*sin(T)]
[sin(-T)  cos(-T) 0][0 1 -y0] = [-sin(T)  cos(T)  x0*sin(T)-y0*cos(T)]
[0        0       1][0 0   1]   [  0        0                  1     ] 
```

You want to apply this transformation to the point to be tested and then see if it lies in the desired box:

```
// Transform the point to be tested.
ct = cos(T);
st = sin(T);
xp =  ct * x + st * y - x0 * ct - y0 * st;
yp = -st * x + ct * y + x0 * st - y0 * ct;
// Test for membership in the box.
boolean inside = xp >= -w/2 && xp <= w/2 && yp >= -h/2 && yp <= h/2; 
```

It's late and I haven't checked this arithmetic, but it's close. Say if it doesn't work.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T12:26:57.607

如果我理解正确，您想检查这四个点是否在旋转矩形中。

我建议不要检查角点，因为您的矩形是旋转的，但是：

如果您旋转了矩形 ABCD，则计算线 |AB|、|BC|、|CD| 和|DA|。如果您有两个点，则使用 y=ax+b （您将通过给出两个坐标的 [x,y] 来计算 a,b，从而为您提供两个简单的等式）。

最后函数 intersect 将检查

```
 if point <= line |CD| 
      AND point >= line |AB|
          AND point <= line |BC|
             AND point >= |DA| 
```

然后它在矩形内。

这可以在您将点 P[x,y] 放入 ax+y+b（a>0 或 -ax-yb）时完成。如果它为零，则它位于该线上，如果它是 < 则它位于该线下方或“在左侧”。希望我帮助..

顺便说一句，你为什么使用 -degree 值，乘以 -1 ，有必要吗？

# ios - OpenGL ES 2.0 纹理是透明的，但后面不显示 OpenGL 内容

> ID：12665027
> 
> 赞同：2
> 
> 时间：2012-09-30T20:53:19.203
> 
> 标签：ios, opengl-es, ios4, opengl-es-2.0

在**iOS 4**上使用**OpenGL ES 2.0**。

 **我有一个继承自**UIView的****OpenGL**视图。它位于提供背景的**UIImageView前面。**

 ****我有一个 。我用于**OpenGL**纹理的具有透明度的**png图像。**

 **我遇到的问题是**OpenGL**视图中图像的透明度显示到**UIImageView**背景中的图像。我想在具有透明纹理的元素后面的**OpenGL视图中显示内容。**

正在渲染下方的**OpenGL**纹理，但顶部具有透明纹理的任何部分都不会显示下方的**OpenGL**纹理。它显示**UIImageView**背景。

我需要做什么才能使透明度在**OpenGL**视图中显示透明内容后面的内容？

**编辑**：

**我重组了索引数组，因此所有具有透明纹理的元素都在最后，并且在我调用glDrawElements**时应该在所有不透明元素之后渲染。

仍然有透明度的问题。

我设置了一些数据，以便我有 2 个三角形的 4 个顶点和 6 个索引来绘制一个具有不透明纹理的正方形。2 个三角形也有 4 个顶点和 6 个索引来绘制一个具有透明纹理的正方形，该纹理位于顶点/索引数组中的其他条目之后。透明元素坐标将其呈现在不透明元​​素的前面。

我可以看到透明元素，也可以看到不透明元素的边缘从后面伸出。然而，透明度并没有显示直接位于透明元素后面的不透明元素，而是直接穿过并显示 OpenGL 视图后面的视图背景。

不透明的黄色方块：

![不透明的黄色正方形](../Images/de210f703972b2b0dfa2652ef7db943e.png)

透明测试图像：

![透明测试图像](../Images/138485bd898f9278e2c25447d9ed46de.png)

透明图像覆盖不透明图像，但透明度显示背景而不是背后的不透明图像：

![在此处输入图像描述](../Images/18efd6a12885cc873965be8d6ab7de3b.png)![在此处输入图像描述](../Images/47fd695cc5415e79f95e3ee865b2575d.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-01T07:50:42.090

你试过用一些混合吗？像这样的东西：

```
//draw your background scene here
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
//draw your foreground scene here
glDisable(GL_BLEND); 
```

-----------------编辑评论----------------

所以你想在片段着色器中进行混合：

```
vec4 color1 = texture2D(backgroundTexture, ...);
vec4 color2 = colorYouGetFromSecondaryTextureOrSomeOtherElement;

vec4 outputColor = color1*(1.0-color2.a) + color2*(color2.a);
outputColor.a = 1.0; //or some function of color1.a and color2.a

gl_FragColor = outputColor; 
```

-----------------编辑 2-------------------------------------

还考虑到您的结果，我会说您忘记了管道中的某些内容。您可能使用了 2 个或更多纹理，但只有您的第二个被绑定，导致我发布的片段片段全黑，但您的前景......您使用的是“活动纹理”吗？像这样的东西：

```
- (void)bindFirstTexture {
    glActiveTexture(GL_TEXTURE0);
    glBindTexture(GL_TEXTURE_1D, firstTextureID);
}
- (void)bindSecondTexture {
    glActiveTexture(GL_TEXTURE1);
    glBindTexture(GL_TEXTURE_2D, secondTextureID);
} 
```

在创建和绘制多个纹理之前，您都需要这种绑定。********

# windows - 如果我没有 Mac，如何将我的 Windows 应用程序移植到 Mac

> ID：12665029
> 
> 赞同：1
> 
> 时间：2012-09-30T20:53:28.883
> 
> 标签：windows, porting

我有一个 Windows 应用程序（使用 Visual Studio 的 C++），我想将它移植到 Mac。我必须让 Mac 来执行此操作吗？不用花太多钱就可以移植它会很好，甚至免费更好。谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T20:59:39.313

你也许可以一起破解一个 VmWare 映像——我以前做过。这需要相当大的努力，因为它没有得到官方支持，但可以做到。在我的图像上，鼠标不起作用，所以我不得不使用键盘上的箭头键来移动指针，但大多数人都没有这样的问题。司机是最大的问题。安装 OS X 后，所有应用程序（我尝试过的应用程序）都运行良好，但速度有些慢，而且鼠标问题让事情有些痛苦（但可以忍受）。

# html - 将 td 内容移动到单元格顶部。

> ID：12665030
> 
> 赞同：0
> 
> 时间：2012-09-30T20:53:33.213
> 
> 标签：html

我有 HTML 表格

我的代码是：

```
<table border="1">
<tr>
<td>
<p>ONE</p>
<p>TWO</p>
<p>THREE</p>
<p>FOUR</p>
</td>
<td><p>ONE</p></td>
</tr>
</table> 
```

我有两个 td，第一个 td 有四个数字，第二个 td 只有一个数字。

问题是：

*第二个*td中的数字 ONE显示在中心，但我想将它显示在 td 的顶部。

示例：http: [//jsfiddle.net/ftYwC/](http://jsfiddle.net/ftYwC/)

我想让它看起来像这样：

```
ONE  | ONE
two  |
three|
four | 
```

请注意，第二列显示在单元格的顶部，这就是我想要做的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T20:57:05.587

尝试在右侧 td 上添加以下样式：

```
style="vertical-align:top" 
```

# ruby-on-rails - Ruby on Rails：将 JSON 数据从服务器异步发送到客户端

> ID：12665031
> 
> 赞同：1
> 
> 时间：2012-09-30T20:53:42.503
> 
> 标签：ruby-on-rails, ajax, json

**背景和我的研究**

我想在不重新加载浏览器页面的情况下将数据从服务器发送到客户端。我正在阅读[Rails 指南](http://guides.rubyonrails.org/layouts_and_rendering.html)，使用 JSON 似乎很有希望。（如果我错了，请纠正我）。

> 2.2.8 渲染 JSON
> 
> JSON 是许多 AJAX 库使用的 JavaScript 数据格式。Rails 内置支持将对象转换为 JSON 并将该 JSON 呈现回浏览器：
> 
> render :json => @product 您不需要在要渲染的对象上调用 to_json。如果你使用 :json 选项，render 会自动为你调用 to_json。

* * *

**问题**

我希望能够在浏览器端渲染这个 JSON 对象。以下是该问题的适当代码。

**视频控制器**

```
class VideosController < ApplicationController
  include VideosHelper

  def home
    @video = Video.last
  end

  def next
    @next_video = next_video(params[:id])
    render :json => @next_video
  end
end 
```

**下一个.json.erb**

```
{
  "title": "<%= @video.title %>"
  "url": "<%= @video.url %>"
  "youtube_id": "<%= @video.youtube_id %>"
  "genre": "<%= @video.genre %>"
  "category": "<%= @video.category %>"
  "likes": "<%= @video.likes %>"
  "dislikes": "<%= @video.dislikes %>"
  "views": "<%= @video.views %>"
  "user_id": "<%= @video.user_id %>"
  "created_at": "<%= @video.created_at %>"
  "updated_at": "<%= @video.updated_at %>"
} 
```

如果我想在动作中呈现`@next_video`JSON 对象。`home`我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:33:15.080

我猜你需要一些 js 处理程序。home.html.erb 中的类似内容：

```
$.ajax({
  url: '<%= next_video_path(@video.id) %>',
  type: "GET",
  dataType: "json",
  success: function(data) {
    // something brilliant here 
  }
}) 
```

同样在 next.json.erb 中，您应该将 @video 更改为 @next_video（因为您没有在下一个操作中初始化 @video）。还有一个建议 - 您可以使用 REST 重命名 next 来显示和删除主页（因为您可以用 show now 替换它）并且您需要将以前的代码更改为：

```
$.ajax({
  url: '<%= video_path(@video.next) %>',
  type: "GET",
  dataType: "json",
  success: function(data) {
    // something brilliant here 
  }
}) 
```

@video.next 将返回下一个视频的 id。

# scala - 匹配一对相等的值

> ID：12665042
> 
> 赞同：10
> 
> 时间：2012-09-30T20:54:31.043
> 
> 标签：scala, tuples, match

我正在尝试处理一个元组，其中一种情况是两个值相等。`match`有没有比这更好、更简洁的方法

```
(p, q) match {
  case (p, q) if (p == q) => println("Match!")
  ...
} 
```

?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-30T21:41:09.293

就我个人而言，我认为你完成它的方式很棒，因为它简单、直观，并且对读者来说很清楚发生了什么。

也就是说，这是一种无需`if`子句就可以做到的方法。你可以只匹配交换的版本，使用反引号`q`变成稳定的标识符。正如@Luigi 指出的那样，您只需检查`p`匹配项`q`：

```
 (p, q) match {
    case (`q`, _) => println("Match!")
    ...
  } 
```

像这样：

```
def f(p: Int, q: Int) {
  (p, q) match {
    case (`q`, _) => println("Match!")
    case _ => println("No")
  }
}

f(1, 2)   // "No"
f(1, 1)   // "Match!" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-30T21:54:36.337

您可以定义自己的提取器：

```
object Eq {
   def unapply[T](pair:(T,T)):Option[T] = 
      if (pair._1 == pair._2) Some(pair._1) else None
} 
```

然后`(4,4) match { case Eq(n) => println("same: " + n) }`打印`same: 4`，虽然`(3,4)`不匹配。

我在我的[博客](http://dgronau.wordpress.com/2011/07/07/eigene-extraktoren/)中列出了一些比较提取器（对不起，它是德语的）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-30T21:13:00.597

您可以交换值，然后将元组与其正常的 equals 方法进行比较：

```
scala> val t = (1, 1)
t: (Int, Int) = (1,1)

scala> t.swap == t
res0: Boolean = true

scala> val t = (1, 2)
t: (Int, Int) = (1,2)

scala> t.swap == t
res1: Boolean = false 
```

# c++ - C++ printf WORD* (ToAscii)

> ID：12665043
> 
> 赞同：1
> 
> 时间：2012-09-30T20:54:38.720
> 
> 标签：c++, keyboard, ascii, printf

我正在使用钩子，我有一个 vkCode 和一个 scanCode 所以我使用命令 ToAscii() 如下：

```
...
LPWORD wCharacter;
ToAscii(kbdStruct.vkCode, kbdStruct.scanCode, keyboard_state, wCharacter, 0); 
```

那么现在 wCharacter 应该持有 Ascii 字符吧？

我怎样才能打印出来？

我试过了：`printf(wCharacter);`但它说：“无法将 'WORD*' 转换为 'const char*'”

我究竟做错了什么？如何打印 WORD*？还是我做错了 ToAscii 命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:01:40.387

WORD 和 ToAscii() 都是标准 C++，所以回答这个问题有点棘手。但是，无论如何，有两个问题：

*   printf() 第一个参数应该是格式字符串。你没有提供任何东西。
*   字符串是一个以零字节结尾的字符序列。如果要打印作为参数传递的单个字符，假设 WORD 是 int-ish，则可以使用 "%c" 格式字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T21:24:55.207

You are not going to get far with this, you are passing an uninitialized pointer to ToAscii(). Proper code should look like this:

```
WORD wCharacter[2];
int len = ToAscii(kbdStruct.vkCode, kbdStruct.scanCode, keyboard_state, wCharacter, 0);
if (len == 1) printf("%c", wCharacter[0]);
if (len == 2) printf("%c", wCharacter[1]); 
```

This ought to compile and work, somewhat. In practice you cannot get this reliable. The *keyboard_state* variable you pass should be the keyboard state of the process that owns the foreground window. And you should pay attention to the keyboard layout that's active for that process (see ToAsciiEx). That cannot be made to work with a low-level keyboard hook. A keyboard logger must use a WH_CALLWNDPROC hook instead to intercept WM_CHAR messages (I think, never wrote one). **Much** harder to get right, that requires a DLL that can be injecting into other processes. You are of course inventing a wheel, buy and not build is the best advice. Also would make your users a bit more comfortable about your intentions.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-13T05:03:45.693

**LPWORD w字符；**
是一个指向单词的长指针。这里的单词是两个字节的整数，而不是句子中的“单词”。它基本上是一个int16。printf 将处理它。

```
printf("%hd", *wCharacter ); 
```

1.  其中 h 指定 16 位值
2.  d 指定一个整数
3.  *wCharacter 是您的 int 的取消引用指针或值。

如果您希望您的打印值将其反映为无符号

```
printf("%hu", *wCharacter ); 
```

无符号十六进制

```
printf("%hx", *wCharacter ); 
```

带大写字母的无符号十六进制

```
printf("%hX", *wCharacter ); 
```

现在说了这么多，您的 WORD int 可能是一个 Unicode 字符或两个字节字符，与普通的 8 位标准字符相对。

在 unicode 中，如果您仍然将标准 ascii 字符表示为与某些阿拉伯语或中文字符相对，则可以通过忽略第一个字节将 unicode 字符转换为标准字符。

```
LPWORD wCharacter;
char *pChar = (char*)wCharacter;

printf("%c", pChar[1]); 
```

1.  将 pChar 声明为一个指向 8 位值 (char) 的指针。
2.  将 pChar 地址设置为您的 WORD 指针。
3.  将 pChar 指针用作数组并将其递增到第二个字节 [1]；

如果您不使用国际字符集，则此方法有效。

# c++ - 数组指针算术 - 合法和未定义的行为

> ID：12665045
> 
> 赞同：3
> 
> 时间：2012-09-30T20:54:49.720
> 
> 标签：c++, c, arrays, pointers, undefined-behavior

我在问自己这行代码是否会在 C 和 C++ 中产生未定义的行为。我试图回答每个点阅读标准所说的数组下标（C 6.5.6 - 8）。我没有发布整个段落，因为它很长。

> 此外，如果表达式`P`指向数组对象的最后一个元素，则表达式`(P)+1`指向数组对象的最后一个元素，如果表达式`Q`指向数组对象的最后一个元素，则表达式`(Q)-1`指向最后一个元素数组对象。如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则计算不应产生溢出；否则，行为未定义。如果结果指向数组 >object 的最后一个元素，则不应将其用作计算的一元运算符的操作数`*`。

```
 1  int a[10];
   2  int b = a[9]; // ok
   3  int c = a[10]; // UB
   4  int* d = (a + 10); // ok
   5  int* e = &a[10]; // ok from C99 (& and [] are ignored, pointer is not deferenced), // UB in pre C99
   6  int* f = &a[11]; // ok from C99, UB in pre c99 
      int* g = a;
   7  int* h = g + 15; // ok 
```

我认为同样的问题应该对 C++ 有效

这些行在 C 和 C++ 中是否有效，我是否误解了标准？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T20:57:39.823

6 和 7 都不是有效的，因为它们不在现有数组中执行指针运算（包括过去的指针）。其他一切基本上都是正确的。

仅在 C 中：鉴于它`a[i]`与 相同`*(a + i)`，并且`&*p`始终只是`p`没有评估`*p`，因此 5 应该始终没问题，尽管您是对的，C89 没有指定这一点，而这只是在 C99 中添加的。（这在 C++ 中完全不是这样，在 C++ 中，运算符可以被重载，并且没有提到组合`&`and `*`。）

从 n1570（草案到 C11），在 6.5.6 加法运算符的第 8 段中：

> [...] 如果指针操作数和结果 [of `P + N`] 都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则评估不应产生溢出；否则，行为未定义。[...]

C++ 包含非常相似的措辞（例如 C++11, 5.7/5）。

# java - 在单元测试中使用模拟实现修补 Java 类

> ID：12665049
> 
> 赞同：3
> 
> 时间：2012-09-30T20:54:58.167
> 
> 标签：java, unit-testing, mocking

我有一个 A 类，它在内部从 B 类实例化一个对象。第二类有很多外部副作用，例如它使用网络连接。

```
public class A {
  private B b;
  public A() {
    b = new B(); // 3rd party class that calls out externally (e.g. to a db)
  }
} 
```

我想通过提供 B 类的模拟实现来对 A 类进行单元测试。我可以通过编写自己的类或使用 Mockito 和其他框架之类的东西轻松创建 B 的模拟版本，但是如何将这个模拟实现注入到类中A的密码？

我想我可以在 A 类的构造函数中请求 B 类的实例，但这看起来很难看。没有人真正需要知道 A 级是如何开展业务的。

Python 有一个“模拟”库，允许您在测试期间在运行时“修补”函数。Java有类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T21:02:21.063

在这种情况下，我通常有一个第二个包（默认）范围构造函数，它允许您传递一个模拟以进行测试。

```
public class A {
  private B b;

  /*
  *  Used by clients
  */
  public A() {
    this(new B());
  }

  /*
  * Used by unit test
  * 
  * @param b A mock implementation of B
  */
  A(B b) {
    this.b = b;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:01:42.847

查看[Mockito。](http://code.google.com/p/mockito/) 最终，根据您的设计，您需要使用反射将 B 的模拟实例放入 A。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T17:58:49.937

使用 JMockit 模拟 API 解决这个问题很简单：

```
public class ATest
{
    @Test
    public void myTest(@Mocked B mockB)
    {
        // Record expectations on "mockB", if needed.

        new A().doSomethingUsingB();

        // Verify expectations on "mockB", if applicable.
    }
} 
```

# php - GCAL APIv3 事件开始时间？

> ID：12665059
> 
> 赞同：0
> 
> 时间：2012-09-30T20:56:50.127
> 
> 标签：php, google-calendar-api

我一直在尝试使用 Google calendar api v3。我有日历和事件列表没有问题。但是，我正在尝试获取某些事件数据。我有`getSummary()`工作和猜测`getLocation()`。

有谁知道如何调用活动的开始时间？这些功能是否在我遗漏的任何地方列出？

```
if ($client->getAccessToken()) {
  $calList = $cal->calendarList->listCalendarList();
  //print "<h1>Calendar List</h1><pre>" . print_r($calList, true) . "</pre>";

    $eventList = $cal->events->listEvents('yoyoyoyo@gmail.com');
    foreach($eventList->getItems()as $eventList){

        print "Name: ";
        echo $eventList->getSummary();
        echo "<br/><br/>";
        print "Start: ";
        echo $eventList->getdateTime(); <--- doesnt work hahah
        echo "<br/><br/><hr>";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:09:43.477

为什么是。几乎所有的谷歌 API 都带有一组有用的相关文档。实际上，您通常可以简单地搜索“google [在此处命名您的 api] 文档”并直接找到它。谷歌日历的主页也有一个直接指向他们文档的链接。都是为了以后参考。现在，您可能可以[在这里](https://developers.google.com/google-apps/calendar/v3/reference/events?hl=en)解析它 并找到您正在寻找的内容 - 因为在第一部分中我确实看到了“开始”和“结束”时间的 JSON 返回。祝你好运 ：）

# javascript - 如何确保图像以正确的顺序循环加载

> ID：12665068
> 
> 赞同：-1
> 
> 时间：2012-09-30T20:57:50.847
> 
> 标签：javascript

我正在从远程服务器加载图像。我如何确保所有图像都以正确的顺序加载

另外我如何确保仅在加载所有图像时才调用警报

以下代码未按正确顺序加载图像，并在加载图像之前调用警报。

```
$(window).load(function () {
  $('.fancybox').each(function () {
    var hh = $(this).attr('href');
    var img = new Image();
    img.src = hh;

    function TIMG(i) {
      if (img.complete != null && img.complete == true) {
        $('.mag').append('<img src="' + hh + '" class="cls" />');
      } else {
        setTimeout(TIMG, 1000);
      }
    }

    setTimeout(TIMG, 1000);    
  });

  alert(hi);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:28:08.050

Based on the new information that you just want to add them in order as soon as they are ready, you can do that like this

```
 $(document).ready(function () {
      // preload all the images as fast as possible
      var imgs = [];
      $('.fancybox').each(function () {
          // get all images preloading immediately
          // so there is the best chance they are available when needed
          var img = new Image();
          imgs.push(img);
          img.onload = function() {
              addReadyImages();
          }
          img.className = "cls";
          img.src = $(this).attr('href');
      });

      function addReadyImages() {
          // show all images that are ready up to here
          while (imgs.length && imgs[0].complete === true) {
              // append the loaded image from the start of the array
              $('.mag').first().append(imgs[0]);
              // remove the one we just did from the start of the array
              imgs.shift();
          }
      }
 }); 
```

Working demo: [http://jsfiddle.net/jfriend00/sCHws/](http://jsfiddle.net/jfriend00/sCHws/)

This algorithm works as follows:

1.  Start preloading all the images as soon as possible.
2.  Store the image objects in an array in the order that the `.fancybox` items are encountered in your page
3.  Set an onload handler for each image so we know immediately when it's ready
4.  In the onload handler for any image, append all images at the front of the array that are ready and then remove them from the array

P.S. I've assumed there is only one `.mag` item and thus we don't need to make separate copies of the image objects (much more efficient that way - rather than creating new image objects). If that is not the case, then please disclose your HTML so we can see the whole problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:06:21.110

由于浏览器在下载图像时通常不会阻塞，因此确保以正确顺序加载图像的唯一方法是串行加载它们……使用队列，然后在前一个完成后才开始下一个。绝对不建议这样做，因为这很容易造成严重的性能损失。

等待所有图像加载的时间最好通过`.promise()`jQuery 中的相关方法来完成：http: [//api.jquery.com/promise/](http://api.jquery.com/promise/)，并观察图像何时被`load()`编辑。如果您特别想控制图像的显示（这很可能是您所关心的），那么它们可以在加载后按顺序显示。

# javascript - 从 Ruby 部分设置 javascript 变量

> ID：12665072
> 
> 赞同：1
> 
> 时间：2012-09-30T20:59:13.113
> 
> 标签：javascript, ruby-on-rails, ruby, partial

我有一个很长的操作，以一个巨大的数组结束。该数组作为 Ruby 对象传递给 js.erb 文件，该文件使用它呈现部分：

```
$('#xxx').html("<%= escape_javascript(render('part', testVar: @fromServer)) %>"); 
```

这一切都很顺利，但我希望能够对结果表中的列进行排序，而不必重新执行整个操作。这应该很容易，但我无法让部分中的结果变量持续存在。我的目标是能够在部分中有一个脚本标签：

```
<script type="text/javascript">
    $("#column").click(function(){
        $.ajax({
              type : 'POST',
              url : '/sort_column',
              data : {data: jsVar},
              dataType : 'script'
        });
    });
</script> 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:07:26.117

只需在 <%= %> 中包装你需要的 ruby​​ 内容。像那样：

```
data : {data: "<%= testVar %>"}, 
```

由于文档将被发送到 ruby​​ 解释器，它将包含您的 testVar 值。也请使用蛇形符号而不是骆驼形。这是红宝石中的常见协议。

# knockout.js - 绑定到 textarea 中的点入和点出事件

> ID：12665078
> 
> 赞同：1
> 
> 时间：2012-09-30T21:00:23.330
> 
> 标签：knockout.js

我正在实现一个基于 knockoutJS 的客户端评论系统。我需要在用户单击它以启用编辑的那一刻更改 textarea 样式，并在用户单击页面的其他位置（单击）使 textarea 处于非活动状态时将 textarea 样式恢复为默认值。

如何使用 knockoutJS 绑定到这些事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:12:15.420

您可以使用`event`绑定来捕获任何事件，以及与`css`样式元素的绑定。

这是一个使用 focur/blur 事件的简单示例：http: [//jsfiddle.net/antishok/KXhem/48/](http://jsfiddle.net/antishok/KXhem/48/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T23:12:15.543

我整理了一个小提琴，展示了两种不同的方式。它位于[http://jsfiddle.net/photo_tom/ckb9V/1/](http://jsfiddle.net/photo_tom/ckb9V/1/)。

第一个`textarea`展示了如何使用淘汰赛`hasfocus`和 CSS 绑定来添加一个类。我相信这个例子展示了如何做你在你的问题中所要求的。您可以[在 http://knockoutjs.com/documentation/hasfocus-binding.html 上查看有关其工作原理的完整说明](http://knockoutjs.com/documentation/hasfocus-binding.html)

第二个 textarea 展示了如何仅使用 CSS 来实现。您可以在“ [CSS/HTML：在输入字段周围创建发光边框](https://stackoverflow.com/q/5670879/136717)”中查看完整描述

# objective-c - 在初始化期间存储到“myKeyArray”的值永远不会被读取

> ID：12665081
> 
> 赞同：2
> 
> 时间：2012-09-30T21:01:10.080
> 
> 标签：objective-c, memory-leaks

对于标记的行，我收到“在初始化期间存储到‘myKeyArray’的值永远不会被读取”消息，我不太明白为什么会发生这种情况。

```
- (void)createAndMigrateStatisticalDataForPlayersToV3 {

NSString *playerStatsfilePath = [self dataFilePath5]; 
NSString *playerDatafilePath = [self dataFilePath6];  
NSArray *myKeyArray = [[NSArray alloc]init]; <<<< "Value stored to 'myKeyArray' during its initialization is never read"
NSMutableArray *theObjects = [[NSMutableArray alloc]init]; <<<< "Value stored to 'myKeyArray' during its initialization is never read"

NSFileManager *fileMgr;
fileMgr = [NSFileManager defaultManager];

if ([fileMgr fileExistsAtPath: playerDatafilePath] == YES) {

    NSMutableDictionary *gameFileDict = [NSMutableDictionary dictionaryWithContentsOfFile:playerDatafilePath];

    NSMutableArray *dataArray = [[NSMutableArray alloc]init];
    NSMutableArray *newDataArray = [[NSMutableArray alloc]init];

    myKeyArray = [gameFileDict allKeys];

    int nrOfKeys = [myKeyArray count];

    for (int oo = 0; oo < nrOfKeys; oo++) {
        theObjects = [gameFileDict valueForKey:[myKeyArray objectAtIndex:oo]];
        [dataArray addObject:[myKeyArray objectAtIndex:oo]];    // Name
        [dataArray addObject:[theObjects objectAtIndex:1]];     // # of games played
        [dataArray addObject:[theObjects objectAtIndex:2]];     // # correct answers 
        [dataArray addObject:[theObjects objectAtIndex:3]];     // # questions
        [dataArray addObject:[theObjects objectAtIndex:4]];     // # of games won
        [dataArray addObject:[theObjects objectAtIndex:5]];     // # of games lost
    }

    int dataCount = [dataArray count];
    float avgNrOfQuestionsPerGame = 0;
    float avgNrCorrectAnswersPerGame = 0;
    float nrOfQuestions = 0;
    float nrOfCorrectAnswers = 0;
    float nrOfGamesPerPlayer = 0;
    float nrOfMatchesWonPerPlayer = 0;
    float nrOfMatchesLostPerPlayer = 0;

    for (int oo = 0; oo < dataCount; oo = oo + 6) {

        nrOfGamesPerPlayer = [[dataArray objectAtIndex:oo+1]floatValue];
        nrOfCorrectAnswers = [[dataArray objectAtIndex:oo+2]floatValue];
        nrOfQuestions = [[dataArray objectAtIndex:oo+3]floatValue];
        nrOfMatchesWonPerPlayer = [[dataArray objectAtIndex:oo+4]floatValue];
        nrOfMatchesLostPerPlayer = [[dataArray objectAtIndex:oo+5]floatValue];

        //           nrOfGamesPerPlayer = nrOfMatchesLostPerPlayer + nrOfMatchesLostPerPlayer;
        avgNrOfQuestionsPerGame = nrOfQuestions / nrOfGamesPerPlayer;
        avgNrCorrectAnswersPerGame = nrOfCorrectAnswers / nrOfGamesPerPlayer;

        for (int ff = 0; ff < nrOfGamesPerPlayer; ff++) {
            [newDataArray addObject:[dataArray objectAtIndex:oo]];      //PlayerName
            [newDataArray addObject:[self get_the_Date]];               //set todays date
            [newDataArray addObject:[NSNumber numberWithInt:avgNrOfQuestionsPerGame]];
            [newDataArray addObject:[NSNumber numberWithInt:avgNrCorrectAnswersPerGame]];

        }
    }
    [newDataArray writeToFile:playerStatsfilePath atomically: TRUE];
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T21:04:20.223

我会把这条线去掉，你不需要初始化它。

```
//NSArray *myKeyArray = [[NSArray alloc]init]; 
```

将此更改为

```
NSArray *myKeyArray; 
```

如果它是可变的，您只需要分配它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T21:16:51.523

在为 myKeyArray 和 theObjects 分配内存之后，您正在重新分配它们，因此您有大量内存泄漏。

删除带有分配的声明并将变量声明移动到执行赋值的行：

```
NSArray *myKeyArray = [gameFileDict allKeys]; 
```

对象也一样：

```
NSArray *theObjects = [gameFileDict valueForKey:[myKeyArray objectAtIndex:oo]]; 
```

请注意，您不必将其声明为 NSMutableArray。你没有改变数组。

# java - 控制打印页面上面板的大小

> ID：12665089
> 
> 赞同：0
> 
> 时间：2012-09-30T21:01:43.600
> 
> 标签：java, swing, printing

我想用两张桌子打印 jpanel。我面临两个问题，第一个是打印图像的准确性不是很好。第二个如何控制打印页面上jpanel的大小？

这是使用 xps 查看器打印的页面的图像（精度不好） ![在此处输入图像描述](../Images/c86ed28649c0688c0fc6858fa9d050fd.png)

![在此处输入图像描述](../Images/5b6e5d9b7778b4c11b989e0f80007517.png)是否可以像这样以这种精度制作打印图像

这是代码：

```
 PrinterJob printjob = PrinterJob.getPrinterJob();
    printjob.setJobName(" TESSCO CUSTOMER CARD ");

    Printable printable = new Printable() {

            public int print(Graphics pg, PageFormat pf, int pageNum) {

                    if (pageNum > 0) {
                            return Printable.NO_SUCH_PAGE;
                    }

                    Dimension size = jPanel1.getSize();
                    BufferedImage bufferedImage = new BufferedImage(size.width, size.height, BufferedImage.TYPE_INT_RGB);

                    jPanel1.print(bufferedImage.getGraphics());

                    Graphics2D g2 = (Graphics2D) pg;
                    g2.translate(pf.getImageableX(), pf.getImageableY());
                    g2.drawImage(bufferedImage, 0, 0, (int) pf.getWidth(), (int) pf.getHeight(), null);

                    return Printable.PAGE_EXISTS;
            }
    };

    Paper paper = new Paper();
    paper.setImageableArea(0, 0,700,890);
    paper.setSize(700,890);

    PageFormat format = new PageFormat();
    format.setPaper(paper);
    format.setOrientation(PageFormat.LANDSCAPE);

    printjob.setPrintable(printable, format);
    if (printjob.printDialog() == false)
            return;

    try {
            printjob.print();
    } catch (PrinterException ex) {
            System.out.println("NO PAGE FOUND." + ex);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:39:20.247

首先，不要使用窗格大小，您需要充当布局管理器并调整面板大小以适合页面。

其次，不要使用缓冲图像。这不会与打印引擎传递给您的图形上下文共享相同的属性。另外，另一种打印方法是可重入的，这意味着它可能会为每一页调用多次，这样创建缓冲图像很浪费资源

您可能想看看[如何打印表格](http://docs.oracle.com/javase/tutorial/uiswing/misc/printtable.html)

**更新**

你可以做类似...

```
public int print(Graphics pg, PageFormat pf, int pageNum) {
    if (page > 0) {
        return NO_SUCH_PAGE;
    }

    Graphics2D g2d = (Graphics2D)pg;

    double pageWidth = pf.getImageableWidth();
    double pageHeight = pf.getImageableHeight();

    double pageX = pf.getImageableX();
    double pageY = pf.getImageableY();

    g2d.translate(pageX, pageY);

    double tableHeight = pageHeight / 2d;

    jPanel1.setBounds(0, 0, (int)Math.floor(pageWidth), (int)Math.floor(pageHeight));
    jPanel1.printAll(g2d);

    return Printable.PAGE_EXISTS;

} 
```

请注意，这可能会截断您的表格。此外，您不应该对`Component`已经在屏幕上的 a 执行此操作。您应该创建一个新的“打印”组件。

**更新工作示例**

好的，所以这个概念是合理的，只是需要一些调整才能让它工作；）

![在此处输入图像描述](../Images/795b3367264c2010e40e9212ffac4d21.png)

```
public class PrintTableTest {

    public static void main(String[] args) {

        final JTable table1 = new JTable(new AbstractTableModel() {
            @Override
            public int getRowCount() {
                return 3;
            }

            @Override
            public int getColumnCount() {
                return 3;
            }

            @Override
            public String getColumnName(int column) {
                String name = null;
                switch (column) {
                    case 0:
                        name = "Day";
                        break;
                    case 1:
                        name = "FirstName";
                        break;
                    case 2:
                        name = "LastName";
                        break;
                }
                return name;
            }

            @Override
            public Object getValueAt(int rowIndex, int columnIndex) {
                Object value = null;
                switch (columnIndex) {
                    case 0:
                        switch (rowIndex) {
                            case 0:
                                value = "First";
                                break;
                            case 1:
                                value = "Second";
                                break;
                            case 2:
                                value = "Final";
                                break;
                        }
                        break;
                }
                return value;
            }
        });
        int rowHeight = (int) Math.floor(((700f / 2f) - table1.getTableHeader().getPreferredSize().height) / 3f);
        table1.setRowHeight(rowHeight);

        PrinterJob printjob = PrinterJob.getPrinterJob();
        printjob.setJobName(" TESSCO CUSTOMER CARD ");

        Printable printable;
        printable = new Printable() {
            public int print(Graphics pg, PageFormat pf, int pageNum) {

                if (pageNum > 0) {
                    return NO_SUCH_PAGE;
                }

                Graphics2D g2d = (Graphics2D) pg;

                double pageWidth = pf.getImageableWidth();
                double pageHeight = pf.getImageableHeight();

                double pageX = pf.getImageableX();
                double pageY = pf.getImageableY();

                g2d.translate(pageX, pageY);

                // Each table will take half the page...
                double tableHeight = pageHeight / 2d;

                // We need to print the header as well...
                JTableHeader header = table1.getTableHeader();
                int headerHeight = header.getPreferredSize().height;

                int yOffset = 0;

                for (int index = 0; index < 2; index++) {
                    // Set the bounds of the components
                    // The yOffset is actuall irrelevent to us, but for consitency sake
                    // we'll keep it.
                    header.setBounds(0, yOffset, (int) Math.floor(pageWidth), headerHeight);
                    table1.setBounds(0, yOffset + headerHeight, (int) Math.floor(pageWidth), (int) Math.floor(tableHeight));
                    // Force the components to update there internal layouts to match
                    // the new size. We need to do this because, technically, we're not
                    // attached to any peer, nor do we want them to be taking into account
                    // the dimensions of any parent any way :P
                    table1.doLayout();
                    header.doLayout();

                    // Translate the graphics.  Components asume a position of 0x0 when
                    // painting.  This is a side effect of the AWT/Swing painting engine
                    // (for which we are greatful), but we need to simulate the change
                    g2d.translate(0, yOffset);
                    header.printAll(g2d);
                    // Translations are relative to the last translation...
                    g2d.translate(0, headerHeight);
                    table1.printAll(g2d);
                    // Reset the last translation
                    g2d.translate(0, -(headerHeight + yOffset));

                    // Next table...
                    yOffset += table1.getHeight();
                }
                return Printable.PAGE_EXISTS;
            }
        };

        Paper paper = new Paper();
        paper.setImageableArea(0, 0, 700, 890);
        paper.setSize(700, 890);

        PageFormat format = new PageFormat();
        format.setPaper(paper);
        format.setOrientation(PageFormat.LANDSCAPE);

//        printjob.setPrintable(printable, format);
        BufferedImage img = new BufferedImage(890, 700, BufferedImage.TYPE_INT_RGB);
        Graphics2D g2d = img.createGraphics();
        g2d.setColor(Color.WHITE);
        g2d.fill(new Rectangle(0, 0, 890, 700));
        try {
            printable.print(g2d, format, 0);
        } catch (Exception exp) {
            exp.printStackTrace();
        }
        g2d.dispose();

        try {
            ImageIO.write(img, "png", new File("Print.png"));
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }
} 
```

# javascript - 我想限制形状内的圆圈和该形状内的分区

> ID：12665090
> 
> 赞同：2
> 
> 时间：2012-09-30T21:01:43.527
> 
> 标签：javascript, svg, d3.js

```
var svgcanvas = d3.select("body").append("svg:svg")
.attr("width", 725)
.attr("height", 500); 
```

数据集

```
var jsoncirclehigh = [
                   {cx:100, cy: 100, r: 2.5,
                    label:"technology"},
                   {cx:200, cy: 200, r: 2.5,
                    label:"rocks"},
                    {cx:50, cy:50, r:2.5,
                        label:"blah"}
                 ]; 
```

我创建的实际形状

```
 svgcanvas.append("svg:path")
        .attr("d","M -200,0 A200,200 0 0,0 500,0 L -200,0") 
        .attr("transform", "translate(220,400) scale(1, -1)")
        .style("stroke-width", 2)
        .style("stroke", "steelblue")
        .style("fill", "yellow"); 
```

我希望圆圈被限制在上面的形状内

```
svgcanvas.selectAll("circle")
     .data(jsoncirclehigh)
     .enter().append("circle")
       .attr("r", function (d) { return d.r; })
       .attr("cx", function (d) { return d.cx; })
       .attr("cy", function (d) { return d.cy; })
       .on("mouseover", function(){d3.select(this).style("fill", "aliceblue");})
       .on("mouseout", function() {d3.select(this).style("fill", "blue");})
       .style("stroke", "steelblue")
       .style("fill", "blue");

svgcanvas.selectAll("text")
   .data(jsoncirclehigh)
   .enter().append("svg:text")
    .text(function(d) { return d.label; })
    .attr("x", function (d) { return d.cx + 10; })
    .attr("y", function (d) { return d.cy + 10; }); 
```

我曾尝试使用 d3.scale，但对我来说并没有成功

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:26:10.927

这可能比您要寻找的更简单，但是您是否考虑过使用[clipPath](http://www.w3.org/TR/SVG/masking.html#EstablishingANewClippingPath)？

# java - 如何围绕远程点旋转单个图像

> ID：12665095
> 
> 赞同：0
> 
> 时间：2012-09-30T21:02:06.120
> 
> 标签：java

我正在用 java 开发一个管射手式游戏，它可以模拟 3D，而无需实际使用任何 3D 库。现在我有一个玩家控制的船，它围绕屏幕的中心点旋转，使用（在这种情况下，向右移动）。

```
 angle += 0.1;
    x = Math.cos(angle) * radius + cX;
    y = Math.sin(angle) * radius + cY; 
```

`angle`相对于中心点的位置在哪里（例如 270 位于中心正下方），`x`并且`y`是当前船舶位置，`radius`是与中心的距离，`cX`并且`cY`是中心点的位置。

现在围绕该点旋转工作顺利，但我不确定如何处理旋转实际船以始终指向中心。我在网上看了很多，但不知道如何在不影响屏幕上其他对象的情况下旋转一个人`Image`（或者如果这不起作用，一个数组）。`drawLines`

长话短说，如何旋转个人`Image`以不断指向远程 x,y 位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:15:56.890

您需要的`AffineTransform`是基本上是java中的矩阵类的类。`Graphics2D`有一个接受`AffineTransform`实例的绘图图像变体：

```
boolean java.awt.Graphics2D.drawImage(Image img, AffineTransform xform, ImageObserver obs) 
```

要创建变换，您可以使用 2D 矩阵运算：

```
AffineTransform trans = new AffineTransform();
trans.translate(x, y);
trans.rotate(theta);
trans.scale(scalex, scaley);
etc... 
```

请注意顺序很重要，您可能需要先缩放、旋转然后将图像平移到相应的位置。它应该做得很好。

Java 使用了一些 3D 功能来尽可能快地绘制，它比软件渲染器更快，但与原生 opengl 相去甚远。

# jquery - jQuery、Canvas、SVG 或 HTML5 动态点击圆圈进入 DIV - 入门的最佳方法

> ID：12665098
> 
> 赞同：0
> 
> 时间：2012-09-30T21:02:22.460
> 
> 标签：jquery, svg, html5-canvas

我想点击一个 DIV 元素并放置圆圈......什么是最好的方法。我想放置数百个小圆圈，直径约 5 像素，有时重叠。然后，当我拥有我想要的所有圆圈时，我需要保存这个模式。

任何人都可以建议一个好的起点吗？

仅供参考...我在 Linux 服务器 LAMP 堆栈上。

------------------ 好的，在最初的建议之后添加了我的代码。

除了隐藏动态创建的圆圈外，代码有效？？？任何想法（固定见下文）

```
 <!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <style type="text/css">
    /*<![CDATA[*/
    div{
      width: 200px;
      height: 200px;
      background-color: #0033FF;
    }

    /*]]>*/
    </style>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript">
    //<![CDATA[
    var X = 0, Y = 0;
    $('.clickInHere').live('mousemove', function(e){
                $('h1').html(e.pageX + ' - ' +e.pageY);
                X = e.pageX;
                Y = e.pageY;
                });
    $('.clickInHere').live('click', function(e){
                $('#circlesHere').append('<circle cx="' + X + '" cy="' + Y + '" r="5" stroke="black" stroke-width="2" fill="none"/>'); // NOTE: THIS DIDN'T WORK PROPERLY... SEE BOTTOM
                });
    // ]]>
    </script>

    </head>

    <body>
    <div class="clickInHere"></div>
    <div class="circleContainer" style="background-color: #eee;">
       <svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="width: 100%; height: 100%;" id="circlesHere"></svg>
    </div>
    <h1></h1>
    </body>
    </html> 
```

- - - 更新 - -

好的，所以动态创建的圆圈没有显示，因为我创建它们不正确......这是修复

```
 var obj = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            obj.setAttributeNS(null, "cx", X);
            obj.setAttributeNS(null, "cy", Y);
            obj.setAttributeNS(null, "r",  Radius);
            obj.setAttributeNS(null, "stroke", strokeColor);
            obj.setAttributeNS(null, "stroke-width", 1);
            obj.setAttributeNS(null, "fill", "white");
            $("svg")[0].appendChild(obj); 
```

我把它放到一个函数中，它工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T07:00:12.213

当然 SVG 或 HTML5 Canvas 是这里的选项。他们两个之间的决定可能来自你需要对圆圈做什么。

虽然在 SVG 中更容易引用您绘制的元素并将它们作为程序中的对象进行操作，但 Canvas 在绘制/重绘整个肖像时非常快。

如果您要保存图案，我想您只需保存圆心的位置及其半径，并在需要时重新绘制它们。对于这样的风景，我会选择画布（它会更快地渲染整个图像），但是如果您希望在圆圈上使用一些“拖放”效果，那么 SVG 可能是一个更好的选择。

如果您向我们提供有关元素使用的更多信息，我们可以更准确地向您建议要走的路。

# ruby-on-rails - 如何让 Sphinx 只返回条件的完全匹配？

> ID：12665100
> 
> 赞同：0
> 
> 时间：2012-09-30T21:02:30.817
> 
> 标签：ruby-on-rails, ruby, sphinx, thinking-sphinx

使 Sphinx 不在条件下使用全文搜索的最佳方法是什么？因此，如果我查询“Bannana”，并设置“类型”必须是“水果”的条件，准确地说。所以它不会对条件进行全文搜索并返回类型为“fruits”的结果。

希望这是有道理的，在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T05:39:29.470

如果我理解正确，则必须将条件设置为 sphinx 中的属性。这将允许您过滤属性并仅返回“水果”类型的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T12:41:47.480

可以使用 [http://sphinxsearch.com/docs/current.html#conf-index-exact-words](http://sphinxsearch.com/docs/current.html#conf-index-exact-words)

确保不匹配词干版本。我不知道如何通过thinking-sphinx进行设置。

然后可以做

```
bannana @type =fruit 
```

作为文本查询。

# python - 如何运行安装了多个 python 版本的脚本？

> ID：12665103
> 
> 赞同：3
> 
> 时间：2012-09-30T21:02:37.667
> 
> 标签：python, command-line-interface

我在 Windows 上安装了 2 个版本的 python，2.7.3 和 3.3。我的一些脚本是 2.x 和一些 3.x。从命令行执行这些脚本以将它们定向到适当的解释器时，是否有一种简单的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T21:06:56.497

**注意：**对于 Windows，使用新的 Windows Python 启动器（适用于*Python 3.3 ，可*[在此处](https://bitbucket.org/vinay.sajip/pylauncher/downloads)下载早期版本），该启动器可识别 Unix shell shebangs。你可以在[这里](http://blog.python.org/2011/07/python-launcher-for-windows_11.html)阅读。

大多数 Linux 发行版将为已安装的*Python 2.x*和*Python 3.x*`python2`解释器创建和`python3`别名（如果没有，您可以自己在.将适当的解释器设置为脚本的第一行：**`$PATH``env`**

 **```
#!/usr/bin/env python2 
```

或者

```
#!/usr/bin/env python3 
```

如果您将脚本文件设置为可执行并直接在 shell 上调用它们，这将指示 shell 使用适当的解释器。例如：

```
$ chmod +x script.py
$ ./script.py 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T21:06:25.853

先试试这个：我在 OS X 上，但是当我想使用 Python 2.6 而不是 Python 2.7（它是一个 numpy/scipy 的东西）时，我只需运行 python2.6 whatever.py 在 Python 2.6 中运行whatever.py。先试试那个。

如果这不起作用，那么您可以使用 virtualenv - Python 的虚拟环境构建器。

[http://pypi.python.org/pypi/virtualenv](http://pypi.python.org/pypi/virtualenv)

我相信也有类似的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T21:36:33.543

佩德罗罗马诺的回答是这样做的最优雅的方式。

但是，如果您不想下载和安装 Python 启动器，请按如下所述创建一个批处理文件。也可以创建快捷方式，将C:\Python27\python.exe复制到C:\Python27\python27.exe等。

我猜 C:\Python27 和 C:\Python33 已经在您的系统路径上。如果是这样，您可以在 C:\Python27\ 中创建一个名为 python2.7.bat 的批处理文件，其中包含：

```
C:\Python27\python.exe %1 
```

和 C:\Python33\ 中的类似文件（例如 python3.3.bat）

现在，您可以`python2.7 script.py`在命令提示符下的任何位置运行，它应该可以工作:)**

# javascript - 具有访问控制允许来源的服务器：*

> ID：12665104
> 
> 赞同：0
> 
> 时间：2012-09-30T21:02:48.677
> 
> 标签：javascript, ajax, http

我想通过 jsFiddle 的 AJAX 测试图像加载，但我不知道任何允许来自远程域的 AJAX 的站点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:18:49.907

给你，带`Access-Control-Allow-Origin: *`标题的图像：

[http://novaember.com/img/testimg.php](http://novaember.com/img/testimg.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:15:38.467

雅虎！*有一个文件上传*的示例 URL 。不确定如何将其与 GET 一起使用：

[http://www.yswfblog.com/upload/simpleupload.php](http://www.yswfblog.com/upload/simpleupload.php)

另请参阅[YUI3 示例中的用法](http://yuilibrary.com/yui/docs/uploader/uploader-multiple.html)。

# javascript - 如何获取跨度的类值

> ID：12665107
> 
> 赞同：-2
> 
> 时间：2012-09-30T21:03:17.700
> 
> 标签：javascript, html

> **可能重复：**
> [使用 jQuery 获取元素的类列表](https://stackoverflow.com/questions/1227286/get-class-list-for-element-with-jquery)

如何在 div 中获取 span 的类值？

```
<div id="Check">

<span class="checked">

<input id="box" name="INbox" type="checkbox" value="1" />1<br>

<span>

</div> 
```

如何从 div="Check" 上获取 class="checked" 的值？

并像这样使用它

```
<script>
var span = $('div#Outbound').find('span').attr('class');
if ( span != "checked"){

}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:05:15.217

使用[`.attr()`](http://api.jquery.com/attr/)：

```
var spanClass = $('div#Outbound').find('span').attr('class'); 
```

或者，如果您只想确定 是否`span`有一个名为 的类`checked`，请使用[`.hasClass()`](http://api.jquery.com/hasClass/)：

```
var hasCheckedClass = $('div#Outbound').find('span').hasClass('class'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T21:05:37.253

无需 jQuery：

```
var span = document.getElementById('Check').getElementsByTagName('span')[0].className; 
```

或者，如果 HTML 的格式是可以预见的“跨度是 div 内的第一个元素”，那么你可以作弊：

```
var span = document.getElementById('Check').children[0].className; 
```

要检查该类`checked`是否在跨度上，您可以执行以下操作：

```
if( span.match(/\bchecked\b/)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:05:29.897

你可以使用 jQuery hasClass

```
 <script>

    if ( !$('div#Outbound').find('span').hasClass( "checked" )){

    }
    </script> 
```

# javascript - 谷歌地图 api v3 infowindow + flot

> ID：12665108
> 
> 赞同：1
> 
> 时间：2012-09-30T21:03:20.390
> 
> 标签：javascript, google-maps-api-3, flot, infowindow

我正在尝试在 中绘制图形`infowindow`，但 flot 没有执行，也没有抛出任何错误。我在 flot 论坛上读到，人们经常在做这样的事情时遇到麻烦，因为占位符元素必须是可见的（这可能是一个红鲱鱼）。

我能够获得以下内容以在不同的元素中适当地生成图形：

```
$.plot(
    $("#placeholder"),
    [ f_data[loc] ],
    {
        grid: { hoverable: true, clickable: true },
        series: {
           bars: { show: true },
           clickable:true,
           color:'#3FA9F5',
           shadowSize: 0
       },//series
       xaxis: {
           tickDecimals:0,
           tickSize:1
       }//xaxis
    }
);//$.plot 
```

但是当我将上述内容放入或引用时`google.maps.event.addListener()`，它什么也不做（甚至不添加`<canvas>`元素）。

我确保将它放在 之后`infowindow.open(map,marker);`，这样我就认为占位符元素是可见的。我还确保`#placeholder`有物质/定义的尺寸。

PS 我尝试了 Mike Williamson 报告的他对[Google Maps V3 的最终解决方案：通过 AJAX 加载信息窗口内容](https://stackoverflow.com/questions/3381700/)，但这也不起作用。

**编辑**
在 infowindow 外部工作的 flot 示例：[index2.html](http://clients.frende.me/incognito/index2.html)
在 infowindow 内部不工作的例子（addListener 'domready'）：[index3.html](http://clients.frende.me/incognito/index3.html)
在 infowindow 内部不工作的例子（setTimeout）：[index4.html](http://clients.frende.me/incognito/index4.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:28:33.800

问题是内容 div 尚未附加到域（因此 $("#placeholer") 找不到它）。在运行代码以绘制图形之前，您需要等待 infowindow domready 事件触发，如下所示：

更新：下面的代码适用于我的本地副本（我确实修改了 css，但我认为这不是必需的）。

```
google.maps.event.addListener(marker, 'click', (function(marker, locale, s, flot_data) {
  return function() {
    var fname = 'http://clients.frende.me/incognito/images/'+date+'_'+locale.toLowerCase().replace(/\s/g,'')+'.svg';
    infowindow.setContent('<div id="gMaps_infowindow"><h3>'+locale+' ('+hour+':00): $'+s.total+'</h3><div id="flotIW" style="height:200px; width:350px;" name="'+locale+'"></div></div>');

  google.maps.event.addListener(infowindow, 'domready', function() {(function(f_data,loc) {
    $.plot(
      $("#flotIW"),
      [ f_data[loc] ],
      {
        grid: { hoverable: true, clickable: true },
        series: {
          bars: { show: true },
          clickable:true,
          color:'#3FA9F5',
          shadowSize: 0
        },//series
      xaxis: {
        tickDecimals:0,
        tickSize:1
      }//xaxis
    }
  );//$.plot
  })(flot_data,locale)});

    infowindow.open(map, marker);
    //open_popUp(flot_data,locale);
    //open_drawGraph(locale);
  }//return
})(marker, locale, s, flot_data));//google.maps.event.addListener 
```

（另一种选择是直接创建域节点，使用它来渲染图形，并将其传递给 setContent 调用（它将采用字符串或 DOM 节点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:16:24.813

你试过把你`$.plot`的包裹起来`setTimeout(function(){$.plot({stuff})}, 0)`吗？

有时这有助于让浏览器有时间在执行之前完成绘制它需要的任何元素。

您可以在此处找到更多信息为什么这可能有用：[为什么 setTimeout(fn, 0) 有时有用？](https://stackoverflow.com/questions/779379/why-is-settimeoutfn-0-sometimes-useful)

# delphi - c++builder (RAD XE2) 中的字符串类型仅处理 2047 个字符？

> ID：12665110
> 
> 赞同：-1
> 
> 时间：2012-09-30T21:03:55.583
> 
> 标签：delphi, c++builder, c++builder-xe2

我有一个 Indy 项目（使用 RAD XE2），我从 IdHTTP 得到一个返回字符串，例如： String result = IdHTTP->Get(url); 问题是 reuslt 限制为 2047 个字符长度。我如何处理完整的返回字符串？谢谢你。

编辑：仅在调试模式下（使用 Step into）时会出现此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T02:29:25.637

字符串的长度没有固有的限制。更有可能是您的调试活动正在中断网络活动，从而干扰了您的程序在调试器暂停之前从套接字读取所有内容的能力。

停止尝试单步执行异步 I/O，您可能会看到更好的结果。

另请注意，调试器的监视窗口不一定会显示变量的全部内容，因此如果您在调试器中只看到 2047 个字符，则不一定反映字符串的实际长度。`Length`改为打电话。

# string - 将字节压缩为可读字符串（无空值或 endofline）

> ID：12665113
> 
> 赞同：1
> 
> 时间：2012-09-30T21:04:27.070
> 
> 标签：string, compression

我正在寻找最合适的编码或方法来将字节压缩为可以使用类似 ReadLine 的命令读取的字符，该命令仅识别可读字符并在行尾字符处终止。实现它可能有一种常见的做法，但我对编码知之甚少。

目前，我将字节输出为十六进制字符串，因此我需要 2 个字节来表示 1 个字节。它运作良好，但速度很慢。例如：值为 255 的字节表示为 'FF'。

我敢肯定它可能会小 3 或 4 倍，尽管由于我正在输出 MP3 数据而存在限制，但我不知道如何。我应该只是压缩我的字符串还是会有太多开销？

ASCII85 会包含随机空字节和 EndOfLine 还是我对它安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:12:43.383

不要压缩 mp3 文件，那样不会获得太多（或任何东西）。

我有点失望，您在询问之前没有阅读[Ascii85](http://en.wikipedia.org/wiki/Ascii85)，因为我认为 Wikipedia 文章相当清楚地解释了它仅使用可打印的 ASCII 字符；所以，没有行尾或空字节。它非常高效，而且转换也相当简单快捷——将数据拆分为 4 字节整数；您将通过重复将 int 值除以 85 并取模 + 33 的 ASCII 值将这些转换为仅五个 Ascii85 数字。

您也可以考虑使用 Base64 或 UUEncode。这些是相当流行的（例如在电子邮件附件中使用），因此您会发现许多图书馆都在准备这些。但它们的效率较低。

# html - 奇怪的css溢出问题

> ID：12665117
> 
> 赞同：1
> 
> 时间：2012-09-30T21:05:01.583
> 
> 标签：html, css, firefox, twitter-bootstrap, overflow

> **可能重复：**
> [Firefox 上的奇怪页面错误](https://stackoverflow.com/questions/12664926/strange-page-bug-on-firefox)

我在我的项目中使用了[Choosen](http://harvesthq.github.com/chosen/)和[Twitter Bootstrap](http://twitter.github.com/bootstrap/)。[这是 jsfiddle](http://jsfiddle.net/Wexcode/7HLyZ/3/) 尝试在 Firefox 上打开它（在 chrome 上它工作得很好）按下第一个手风琴项开启器。它将关闭内部。然后再按一次打开：你会看到它只显示文本框，而不是内部 div。

这是我在 Firefox 上按 3 次后看到的屏幕截图

![在此处输入图像描述](../Images/940d53d9b20b2e7138833d031817c1cf.png)

这就是它的样子（在 Chrome 上）

![在此处输入图像描述](../Images/b2c8938a539de50220b234dc85fa591c.png)

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:08:16.353

Firefox 中的有趣行为！但如果你把下面的行去掉，它就可以正常工作。

```
 .collapse.in { overflow: visible; } 
```

如果默认情况下没有设置任何溢出，浏览器会以任何方式将其设置为可见，因此无需显式设置。参考这里[http://css-tricks.com/the-css-overflow-property/](http://css-tricks.com/the-css-overflow-property/)

# ruby-on-rails - 管理时事通讯的服务，但允许每个用户的数据库驱动数据

> ID：12665123
> 
> 赞同：2
> 
> 时间：2012-09-30T21:05:55.790
> 
> 标签：ruby-on-rails, email, subscription

如果这是题外话，我很乐意结束这个问题。它与软件开发有关，因为我希望每周向订阅者发送一封电子邮件，以获得我的服务。问题是，我需要将自定义数据放入爆炸中，例如“你上周完成了这些事情，这就是我要推荐你本周做的事情！”。所有数据都由我的应用程序确定。问题是，我是否必须构建自己的订阅管理服务才能处理这种粒度级别？我对此不感兴趣，宁愿支付邮件服务来处理选择加入/可能选择，我希望他们处理所有邮件基础设施。不过，我必须能够提供即将发布的数据/模板。

这些天有没有适合这个的服务？

# android - 如何检测通知是否已被驳回？

> ID：12665131
> 
> 赞同：26
> 
> 时间：2012-09-30T21:07:01.317
> 
> 标签：android, alarmmanager, alarm, repeat, notificationmanager

Android中是否有任何方法可以检测用户何时向左滑动通知并将其删除？我正在使用警报管理器设置重复警报，并且当用户取消通知时，我需要停止重复警报。这是我的代码：

**设置重复警报：**

```
AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, c.getTimeInMillis(), repeatFrequency, displayIntent); 
```

**我的通知代码：**

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //Get the notification ID.
    int notifID = getIntent().getExtras().getInt("Reminder_Primary_Key");

    //Get the name of the reminder.
    String reminderName = getIntent().getExtras().getString("Reminder_Name");

    //PendingIntent stores the Activity that should be launched when the user taps the notification.
    Intent i = new Intent(this, ViewLocalRemindersDetail.class);
    i.putExtra("NotifID", notifID);
    i.putExtra("notification_tap", true);

    //Add FLAG_ACTIVITY_NEW_TASK to stop the intent from being launched when the notification is triggered.
    PendingIntent displayIntent = PendingIntent.getActivity(this, notifID, i, Intent.FLAG_ACTIVITY_NEW_TASK);

    NotificationManager nm = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
    Notification notif = new Notification(R.drawable.flag_red_large, reminderName, System.currentTimeMillis());

    CharSequence from = "Here's your reminder:";

    CharSequence message = reminderName;        
    notif.setLatestEventInfo(this, from, message, displayIntent);

    //Pause for 100ms, vibrate for 250ms, pause for 100ms, and vibrate for 500ms.
    notif.defaults |= Notification.DEFAULT_SOUND;
    notif.vibrate = new long[] { 100, 250, 100, 500 };
    nm.notify(notifID, notif);

    //Destroy the activity/notification.
    finish();

} 
```

我知道我需要打电话`alarmManager.cancel(displayIntent)`来取消我的重复闹钟。但是，我不明白将这段代码放在哪里。仅当用户点击通知或将其关闭时，我才需要取消重复警报。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-04-13T20:10:57.587

我相信这[`Notification.deleteIntent`](http://developer.android.com/reference/android/app/Notification.html#deleteIntent "[文档]")就是您正在寻找的。医生说：

> 当通知被用户明确解除时执行的意图，无论是使用“全部清除”按钮还是单独将其滑开。这可能不应该启动一个活动，因为其中几个将同时发送。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-04T04:38:11.793

对于所有那些未来的人——你可以注册一个广播接收器来监听通知删除inents。

**创建一个新的广播接收器：**

```
public class NotificationBroadcastReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();

        if (action == null || !action.equals(Config.NotificationDeleteAction)) {
            return;
        }

        // Do some sweet stuff
        int x = 1;
    }
} 
```

**在您的应用程序类中注册广播接收器：**

“如果您的应用程序以 API 级别 26 或更高级别为目标，则您不能使用清单为大多数隐式广播（不专门针对您的应用程序的广播）声明接收器。”

[安卓文档。](https://developer.android.com/guide/components/broadcasts.html)

```
 registerReceiver(
        new NotificationBroadcastReceiver(),
        new IntentFilter(Config.NotificationDeleteAction)
  ); 
```

您可能注意到静态变量**Config.NotificationDeleteAction**。这是通知的唯一字符串标识符。它通常遵循以下*{namespace}{actionName}*约定：

*you.application.namespace.NOTIFICATION_DELETE*

**在通知生成器上设置删除意图：**

```
notificationBuilder
       ...
        .setDeleteIntent(createDeleteIntent())
       ... 
```

其中，*createDeleteIntent*是以下方法：

```
private PendingIntent createDeleteIntent() {
    Intent intent = new Intent();
    intent.setAction(Config.NotificationDeleteAction);

    return PendingIntent.getBroadcast(
            context,
            0,
            intent,
            PendingIntent.FLAG_ONE_SHOT
    );
} 
```

当您的通知被解除时，您注册的广播接收器应该会收到意图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-19T04:44:08.247

您还可以使用 Activity PendingIntent，如果您有一个可以处理解雇的 Activity，这可能更容易实现，因为您不必创建和配置广播接收器。

```
public static final String DELETE_TAG = "DELETE_TAG";

private PendingIntent createDeleteIntent(Context context) {
    Intent intent = new Intent(context, MyActivity.class);
    intent.putExtra(DELETE_TAG, true);

    return PendingIntent.getActivity(
            context,
            0,
            intent,
            PendingIntent.FLAG_ONE_SHOT
    );
} 
```

MyActivity 将在其 onCreate() 中接收意图，在此示例中，可以查找 DELETE_TAG 额外内容以识别它。

# java - 在我的 jsp 生成页面中显示简单图像

> ID：12665141
> 
> 赞同：0
> 
> 时间：2012-09-30T21:08:25.963
> 
> 标签：java, eclipse, jsp

这个问题可能会暴露我完全缺乏理解，我想就这样吧。一旦 JSP 页面在 Tomcat 上运行，尝试使用以下代码显示图像。请注意，这是对我不起作用的标签：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>George Brown GeoQuest - Welcome</title>
</head>
<body>
<img alt="logo" src="WebContent/GBGeoQuestLogo.gif">

</br>
<h1>Welcome, GB Geoquest Team!</h1>
<form action="/Lab4">
    <label>Team Name:
        <input type="text" name="name">
    </label><br>
    <input type="submit" value="Login">
    <input type="reset" value="Reset">
</form>
</body>
</html> 
```

我得到的只是左上角的蓝色图像问号符号，而不是我的图像。链接应该在这里可见：http: [//postimage.org/image/drnl831pz/](http://postimage.org/image/drnl831pz/)

谁能引导我朝着正确的方向前进？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T08:24:09.847

我认为您的上下文路径是 Lab4/WebContent 并且您的图像在 WebContent 中。因此，在这种情况下，您可以通过以下方式获取图像，

```
src="${pageContext.request.contextPath}/GBGeoQuestLogo.gif" 
```

它将在 WebContent 中搜索图像，因为您的上下文路径是 Lab4/WebContent。如果仍然有问题而不是在浏览器中查看 Pagesource 并验证图像路径

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:21:12.407

首先需要确认镜像文件在war文件中。一旦您确定它存在，请尝试从 JSP 中的 url 中删除“WebContent”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:26:57.180

The value of the src-attribute is missing the context of the application. Now the hostname is used as the context root, so browser uses the wrong url, e.g. `http://localhost:8080/WebContent/GBGeoQuestLogo.gif`

Add the context root to the src attribute and the image will be loaded, assuming 1) it's inside the war 2) it's located in WebContent-directory in the war:

src="${pageContext.request.contextPath}/WebContent/GBGeoQuestLogo.gif"

# bash - 参数检查 - bash

> ID：12665144
> 
> 赞同：1
> 
> 时间：2012-09-30T21:08:56.380
> 
> 标签：bash, arguments

假设我有一个带有两个参数的脚本，有没有办法检查表单中是否有一个参数或 2 个以上的参数：

```
if [ check if arguments don't equal 2 ]; then
    echo Too many arguments
    exit 1
fi 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T21:11:18.863

```
if [ $# -ne 2 ]; then
   # Number of arguments was not 2
fi 
```

该变量`$#`保存传递的参数的数量。

# http - 如何通过 httpie 调用 Asp.Net MVC Put 方法？

> ID：12665147
> 
> 赞同：0
> 
> 时间：2012-09-30T21:09:03.993
> 
> 标签：http, asp.net-mvc-4, asp.net-mvc-routing

给定一个新的 Asp.Net MVC 4 Web Api 应用程序，它具有方法

```
public class ValuesController : ApiController
{
    // PUT api/values/5
    public void Put(int id, [FromBody]string value)
    {
        lastval = "b " + value;
    }
} 
```

我们如何通过**httpie**调用这个方法？我试过

```
http PUT localhost:20780/api/values/3 value="test" 
```

它调用传递正确 id 3 的 web api 方法，但值“test”没有到达，它在调用中为 null。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T00:55:21.100

控制器是否需要表单编码的数据？如果是，那么您需要使用该[`--form, -f`](https://github.com/jkbr/httpie#forms)选项。这是因为 HTTPie 默认发送 JSON：

```
http --form PUT localhost:20780/api/values/3 value="test" 
```

# url - Yii CListView如何控制页面获取参数？

> ID：12665150
> 
> 赞同：1
> 
> 时间：2012-09-30T21:09:10.847
> 
> 标签：url, yii

使用 Yii 1.1.12。我有一个关闭 ajax的[CListView ：](http://www.yiiframework.com/doc/api/1.1/CListView)

```
<?php $this->widget('zii.widgets.CListView', array(
    'dataProvider'=>$dataProvider,
    'itemView'=>'_view',
    'ajaxUpdate' => false,
)); ?> 
```

第二页链接的 url 如下所示：

`http://www.example.com/products?Product_page=2`

我希望网址看起来像：

`http://www.example.com/products?page=2`

我怎样才能做到这一点？

（额外的好处是还描述了如何获得类似的网址`http://www.example.com/products/page/2`）

**更新**

正如 elbek 所指出的，我看到 CListView 具有[CLinkPager](http://www.yiiframework.com/doc/api/1.1/CLinkPager)`pager`类型的属性。这又具有[CPagination](http://www.yiiframework.com/doc/api/1.1/CPagination)类型的属性，该属性具有[pageVar](http://www.yiiframework.com/doc/api/1.1/CPagination#pageVar-detail)属性，描述为：`pages`

> 存储当前页面索引的 GET 变量的名称。默认为“页面”。

听起来这可能是我正在寻找的东西，但不确定如何从 CListView 修改它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T04:42:55.093

此外，要更改`pageVar`您必须修改`$dataProvider`. 您可以在控制器操作中定义它时执行此操作：

```
$dataProvider=new CActiveDataProvider('Products',array(
    'pagination'=>array(
        'pageVar'=>'page'
    )
)); 
```

或者，您当然可以`$dataProvider`在视图中使用它之前修改视图本身`CListView`：（不推荐 - 由于关注点分离）

```
$dataProvider->pagination=array('pageVar'=>'page');
$this->widget('zii.widgets.CListView', array(/*rest of your code*/)); 
```

但是通过这种更改，要使您的网址看起来像`http://www.example.com/products/page/2`您需要稍微更改`urlManager`Suvera 回答中的规则：

```
'products/page/<page:\d+>'=>'products/index', 
```

* * *

注意：如果你不需要那种类型的 url，你就不需要上面的规则，只需要指定`pageVar`就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T05:47:46.010

在您的配置中启用 urlManager 组件。并在顶部添加以下规则。

```
'urlManager'=>array(
    ......
    'rules'=>array(
        'products/page/<Product_page:\d+>'=>'products/index', //Add it in top
        ...........
        ...........
    ),
), 
```

上面的规则将创建一个类似的 url`http://www.example.com/products/page/2`

规则中的值部分`products/index` 是**产品**控制器和**索引**操作（这很重要，因此请指出您的实际路线）。

您甚至可以随心所欲地创建网址。

**例 1：**

`'products/<Product_page:\d+>'=>'products/index'`

会给你 `http://www.example.com/products/2`

**前 2**

`'TheAvengers/vs/Loki/<Product_page:\d+>'=>'products/index'`

会给你 `http://www.example.com/TheAvengers/vs/Loki/2`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:29:16.117

I think CListView has [pager](https://github.com/yiisoft/yii/blob/1.1.12/framework/zii/widgets/CBaseListView.php#L57) attribute(from its parent class)

You can try to set some attributes for this. I think it is CLinkPager instance.

# django - 用于更新或插入的 Django 模型字段验证器函数

> ID：12665153
> 
> 赞同：0
> 
> 时间：2012-09-30T21:09:39.517
> 
> 标签：django, django-models, django-validation

如果 Django 模型字段验证器函数用于更新或插入，有没有办法找出它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:43:24.983

不，没有。验证器只是一个可调用的，它接受一个值并检查它。它无法访问正在验证的字段或实例，因此无法判断它是新实例还是现有实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:38:47.533

不确定这是否是您要查找的内容，但我通常使用 self.pk 来确定模型是否已保存。如果没有主键，我可以假设它是一个插入。

# c# - 应该如何在 ASP.Net 中对事件进行单元测试？

> ID：12665159
> 
> 赞同：4
> 
> 时间：2012-09-30T21:10:02.297
> 
> 标签：c#, asp.net, unit-testing, events

我已经使用自定义事件参数和相关的引发方法定义了两个事件。现在我想知道应该测试什么以及如何测试该事件。我应该如何分析代码以找到单元测试的候选者？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T22:17:22.290

我测试事件的方式如下：

假设这是您的对象：

```
public class MyEventRaiser
{
    public event EventHandler<string> MyEvent = delegate { };

    public void Process(string data)
    {
        // do something interestuing

        Thread.Sleep(2000);

        if (!string.IsNullOrEmpty(data))
        {
            this.MyEvent(this, data + " at: " + DateTime.Now.ToString());
        }
    }
} 
```

因此，**您的 Subject Under Test 是：`MyEventRaiser`**并且您想要测试方法`Process`。您需要测试是否在满足某些条件时引发事件，否则不应引发事件。

为此，我使用这个框架（我**总是在我的测试中**使用）[FluentAssertions](http://fluentassertions.codeplex.com/)，这个框架可以与任何测试引擎一起使用，如 MSTest、NUnit、MSpec、XUnit 等

测试看起来像：

```
[TestClass]
public class CustomEventsTests
{
    [TestMethod]
    public void my_event_should_be_raised()
    {
        var sut = new MyEventRaiser();

        sut.MonitorEvents();

        sut.Process("Hello");

        sut.ShouldRaise("MyEvent").WithSender(sut);
    }

    [TestMethod]
    public void my_event_should_not_be_raised()
    {
        var sut = new MyEventRaiser();

        sut.MonitorEvents();

        sut.Process(null);

        sut.ShouldNotRaise("MyEvent");
    }
} 
```

您需要使用以下命名空间：

```
using FluentAssertions;
using FluentAssertions.EventMonitoring; 
```

# iphone - TableView 中的更多单元格

> ID：12665166
> 
> 赞同：0
> 
> 时间：2012-09-30T21:10:56.633
> 
> 标签：iphone, objective-c, ios

我有一个`tableview`我正在填充的`JSON`，但它是我拥有的值的两倍。我只有 2 个对象，但它把 4 个放在`tableview`. 有人可以告诉我我做错了什么以及为什么我在只有 2 个对象的情况下列出 4 个对象吗？我检查了计数和数据模型，它们都只显示 2 个项目。

这是我的代码：

```
 //
//  RootBeerTableViewController.m
//  BaseApp
//
//  Created by Blaine Anderson on 9/27/12.
//  Copyright (c) 2012 UIEvolution, Inc. All rights reserved.
//

#import "RootBeerTableViewController.h"
#import "GlobalData.h"

@interface RootBeerTableViewController ()

@end

@implementation RootBeerTableViewController

@synthesize rootList;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {

    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

   UITableView *tableView = [[UITableView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame] style:UITableViewStylePlain];

    tableView.autoresizingMask = UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleWidth;

    tableView.delegate = self;

    tableView.dataSource = self;

    [tableView reloadData];

    self.view = tableView;
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    rootList =[[GlobalData sharedData].mRootBeers getRootBeers];
     NSLog(@"RootList: %@", rootList);
    // Return the number of sections.
    NSLog(@"RootList count: %i", rootList.count);
    return rootList.count;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
        // Return the number of sections.
     NSLog(@"RootList row count: %i", rootList.count);
    return rootList.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    rootList =[[GlobalData sharedData].mRootBeers rootBeerList];
     NSLog(@"RootList Cell: %@", rootList);
    RootBeers* mRootBeer = [rootList objectAtIndex:indexPath.row];

    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if(cell == nil){
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle  reuseIdentifier:@"Cell"]; 
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
    }
    NSLog(@"Cell Name: %@", mRootBeer.name);
       // Configure the cell...
    cell.textLabel.text = mRootBeer.name; 
    cell.detailTextLabel.text = mRootBeer.brewer; 

    return cell;
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    [[GlobalData sharedData].mViewManager pushView:DETAILVIEW animated:YES]; 

}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:30:55.427

我相信这就是为什么...

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
rootList =[[GlobalData sharedData].mRootBeers getRootBeers];
 NSLog(@"RootList: %@", rootList);
// Return the number of sections.
NSLog(@"RootList count: %i", rootList.count);
return rootList.count;
} 
```

改成这个。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
return 1;
} 
```

您正在为 rootList 中的每个对象添加一个部分，然后在每个部分中添加所有 rootlist。所以只返回一个部分是最简单的。

# c# - ProtoBuf-Net，两个列表的反序列化，其中一个是另一个列表的一部分

> ID：12665167
> 
> 赞同：1
> 
> 时间：2012-09-30T21:11:07.540
> 
> 标签：c#, serialization, protobuf-net

Banana List 包含对 Fruits List 中对象的引用。水果列表中的香蕉一个接一个地放置。此外，它们具有递增的数字。（添加和删除香蕉应该保留这些属性） 问题是在反序列化后 Bananas List 和 Fruits List in Basket 似乎包含不同的对象。有办法避免吗？

我的第二个问题是关于 Banana 中的 ContainedBy 属性。Cos Bananas 知道它们在哪里，它们指向特定的容器，但在反序列化之后，它们再次指向上帝知道的位置（特定于它们所在的其他篮子）。问题在哪里？

```
 [ProtoContract]
    [ProtoInclude(500, typeof(Basket))]
    public interface IContainer
    {
        [ProtoMember(1, OverwriteList = true)]
        public List<Banana> Bananas { get; set; }

        [ProtoMember(2, OverwriteList = true)]
        public List<IFruit> Fruits { get; set; }

    }

    [ProtoContract]
    public class Basket : IContainer
    {
        [ProtoMember(1, OverwriteList = true)]
        public List<Banana> Bananas { get; set; }

        [ProtoMember(2, OverwriteList = true)]
        public List<IFruit> Fruits { get; set; }

        public void AddBanana()
        {
            var number = Bananas.Count;
            var newBanana = new Banana(number) {ContainedBy = this};
            var lastBanana = Bananas[Bananas.Count - 1];
            var index = Fruits.LastIndexOf(lastBanana);

            Friuts.Insert(index + 1, newBanana);
            Bananas.Add(newBanana);
        }

        public void DeleteBanana(Banana banana)
        {
            Bananas.Remove(banana);
            Fruits.Remove(banana);
            var n = 0;
            foreach (var b in Bananas)
            {
                b.Number = n++;
            }
        }
    }

    [ProtoContract]
    [ProtoInclude(600, typeof(Banana))]
    public interface IFruit
    {
        [ProtoMember(1, AsReference = true)]
        IContainer ContainedBy { get; set; }
    }

    [ProtoContract]
    public class Banana : IFruit
    {
        [ProtoMember(1)]
        public int Number { get; set; }
        [ProtoMember(2, AsReference = true)]
        IContainer ContainedBy { get; set; }
    } 
```

**Marc Gravell 给出的更新#1**答案对上述问题非常有效。但我的目标功能是容器字典，它给出了一个例外：“反序列化期间引用跟踪的对象更改了引用”。下面列出的更改适用于 Marc Gravell 的答案。

```
[ProtoContract]
class RootObject
{
    [ProtoMember(1, OverwriteList = true, AsReference = true)]
    public Dictionary<string, IContainer> Dictionary { get; set; }
}

...

internal static class Program
{
    private static void Main()
    {
        var basketA = new Basket();
        basketA.AddBanana();
        var basketB = new Basket();
        basketB.AddBanana();
        var root = new RootObject {Dictionary = new Dictionary<string, IContainer>()};
        root.Dictionary.Add("A",basketA);
        root.Dictionary.Add("B",basketB);

        RootObject clone;
        using (var file = File.Create("tmp.bin"))
        {
            Serializer.Serialize<RootObject>(file, root);
        }

        using (var file = File.OpenRead("tmp.bin"))
        {
            clone = Serializer.Deserialize<RootObject>(file);
        }

        foreach (var container in clone.Dictionary.Values) //Exception
        {          
        Console.WriteLine(container.Bananas.Count == container.Fruits.Count); //true
        Console.WriteLine(ReferenceEquals(
           container.Bananas[0],
           container.Fruits[0])); // true
        Console.WriteLine(ReferenceEquals(
            container.Fruits[0].ContainedBy,
            container)); // false

        }           
    }
} 
```

显然，将 RootObject 中的 Dictionary 标记从`[ProtoMember(1, OverwriteList = true, AsReference = true)]`to更改为`[ProtoMember(1, OverwriteList = true)]`有助于解决异常，但引用 ContainedBy 会丢失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T06:16:19.380

默认情况下，protobuf-net 是树序列化器，而不是图形序列化器；所以在你告诉它尊重所涉及的引用之前，它会*分别*序列化香蕉和水果下的信息。此外，您需要注意双重序列化，[如此处所述](https://stackoverflow.com/a/12634742/23354)。同一篇文章还描述了接口及其类之间的当前“需要工作”区域，这可能会在这里影响您；我想我已经通过交换`Fruits`and的顺序在很大程度上解决了这个问题`Bananas`。

请注意，我删除了“lastBanana / index”代码，原因很简单，即当列表为空时它会爆炸，而且我不想预先阻止你的意图 - 我会让你重新添加那个代码。

不过，我的主要想法很简单：看起来您正在序列化您的主域模型。这本身并没有*错*，但是：如果它开始变得棘手，那么我总是建议：切换到更简单的 DTO 模型进行序列化，并映射到 DTO/域模型/映射到 DTO/域模型。

无论如何，以下似乎有效：

```
using ProtoBuf;
using System;
using System.Collections.Generic;

[ProtoContract]
class RootObject
{
    [ProtoMember(1, AsReference = true)]
    public IContainer Container { get; set; }
}

[ProtoContract]
[ProtoInclude(500, typeof(Basket))]
public interface IContainer
{
    [ProtoMember(2, OverwriteList = true, AsReference = true)]
    List<Banana> Bananas { get; set; }

    [ProtoMember(1, OverwriteList = true, AsReference = true)]
    List<IFruit> Fruits { get; set; }

}

[ProtoContract]
public class Basket : IContainer
{
    public List<Banana> Bananas { get; set; }

    public List<IFruit> Fruits { get; set; }

    public void AddBanana()
    {
        if (Bananas == null) Bananas = new List<Banana>();
        if (Fruits == null) Fruits = new List<IFruit>();
        var number = Bananas.Count;
        var newBanana = new Banana { Number = number, ContainedBy = this };

        // var lastBanana = Bananas[Bananas.Count - 1];
        // var index = Fruits.LastIndexOf(lastBanana);

        // Fruits.Insert(index + 1, newBanana);

        Fruits.Add(newBanana);
        Bananas.Add(newBanana);
    }

    public void DeleteBanana(Banana banana)
    {
        Bananas.Remove(banana);
        Fruits.Remove(banana);
        var n = 0;
        foreach (Banana b in Bananas)
        {
            b.Number = n++;
        }
    }
}

[ProtoContract]
[ProtoInclude(600, typeof(Banana))]
public interface IFruit
{
    [ProtoMember(1, AsReference = true)]
    IContainer ContainedBy { get; set; }
}

[ProtoContract]
public class Banana : IFruit
{
    [ProtoMember(1)]
    public int Number { get; set; }

    public IContainer ContainedBy { get; set; }
}

static class Program
{
    static void Main()
    {
        var basket = new Basket();
        var root = new RootObject { Container = basket };
        basket.AddBanana();

        var clone = Serializer.DeepClone(root);
        Console.WriteLine(clone.Container.Fruits.Count == 1); // true
        Console.WriteLine(clone.Container.Bananas.Count == 1); // true
        Console.WriteLine(ReferenceEquals(
            clone.Container.Bananas[0],
            clone.Container.Fruits[0])); // true
        Console.WriteLine(ReferenceEquals(
            clone.Container.Fruits[0].ContainedBy,
            clone.Container)); // true
    }
} 
```

# ios - iOS OpenGL ES 2.0 屏幕外帧缓冲对象有什么用途？

> ID：12665173
> 
> 赞同：1
> 
> 时间：2012-09-30T21:12:12.493
> 
> 标签：ios, opengl-es, opengl-es-2.0, framebuffer

在 iOS 中，很容易将 OpenGL ES 2.0 渲染设置为纹理，然后将这些纹理用于后期处理通道或用作后续渲染通道的纹理。这似乎是跨 OpenGL 实现的一种相当普遍的方法。都好。

根据 Apple 的 OpenGL ES Programming Guide for iOS（参见第 28 和 29 页），您还可以创建和绘制多个离屏帧缓冲区对象。他们建议您这样做是为了执行屏幕外图像处理。但是，我无法找到并描述在渲染到缓冲区后如何访问缓冲区以进行图像处理或任何其他目的。

这些离屏缓冲区可以与非 OpenGL 框架一起用于图像处理吗？CPU可以读回这些缓冲区吗？

有没有人有任何指示或例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:06:44.013

图像处理是离屏帧缓冲区对象 (FBO) 的一种可能用途，但还有其他应用程序。

对于图像处理，您通常会渲染到由纹理支持的 FBO。渲染到该纹理后，您可以将其拉入图像处理管道的第二阶段，或者将其用作 3-D 场景某些部分的纹理。作为一个例子，我的 GPUImage 开源框架为每个应用于传入图像或视频帧的过滤器阶段使用纹理支持的屏幕外 FBO。下一阶段然后拉入该纹理并将过滤后的结果渲染到其自己的纹理支持的 FBO。

正如我所说，屏幕外渲染可以有其他应用程序。这些包括延迟光照（Apple 在 2011 年 WWDC OpenGL ES 视频中有一个相当令人印象深刻的例子）和缓存查找值的计算以供以后参考。我在我的 Molecules 应用程序中使用后者作为优化，以加速在我的原子球体表面上映射环境光遮蔽照明纹理。我没有为每个原子的每个片段执行一组计算，而是为一个通用球体渲染一次，然后在原子片段着色器中查找结果。

# php - 如何使用 php 从客户端获取registrationID？

> ID：12665174
> 
> 赞同：-1
> 
> 时间：2012-09-30T21:12:17.523
> 
> 标签：php, android, google-cloud-messaging

谁能告诉我如何获得“$registrationIDs = array("reg id1","re​​g id2");"，在下面的代码中提到，发布在这里[GCM with PHP (Google Cloud Messaging)](https://stackoverflow.com/questions/11242743/gcm-with-php-google-cloud-messaging)

```
<?php
           // Replace with real server API key from Google APIs  
            $apiKey = "your api key";    

              // Replace with real client registration IDs
           $registrationIDs = array( "reg id1","reg id2");

          // Message to be sent
         $message = "hi Shailesh";

         // Set POST variables
        $url = 'https://android.googleapis.com/gcm/send';

       $fields = array(
       'registration_ids' => $registrationIDs,
         'data' => array( "message" => $message ),
        );
     $headers = array(
      'Authorization: key=' . $apiKey,
     'Content-Type: application/json'
      );

     // Open connection
          $ch = curl_init();

        // Set the url, number of POST vars, POST data
        curl_setopt( $ch, CURLOPT_URL, $url );
        curl_setopt( $ch, CURLOPT_POST, true );
        curl_setopt( $ch, CURLOPT_HTTPHEADER, $headers);
            curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );
        //curl_setopt( $ch, CURLOPT_POSTFIELDS, json_encode( $fields ) );

         curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
     //     curl_setopt($ch, CURLOPT_POST, true);
       //     curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
            curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode( $fields ));

            // Execute post
         $result = curl_exec($ch);

        // Close connection
           curl_close($ch);
         echo $result;
          //print_r($result);
           //var_dump($result);
       ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T18:46:10.710

一旦应用程序收到 RegID，您需要构建一个网页，应用程序可以使用该网页与 RegID 进行通信。您必须引入某种服务器端存储（数据库、文件）来存储 RegID。

根据您的业务，您可能希望接受一些附加参数。POST 表格对那些人来说是个好地方。

然后在应用程序中，一旦您获得 RegID，就执行 HTTP 请求，同时传递 RegID。注意事项：不要`HttpClient`从主线程调用。使用一个`AsyncTask`，或旋转一个新的`Thread`。

# jquery - jQuery 防止默认但也保留自定义事件

> ID：12665181
> 
> 赞同：0
> 
> 时间：2012-09-30T21:13:25.543
> 
> 标签：jquery, events, preventdefault

我有一个包含所有正文点击事件的网页：

```
if (0 == $('body').hasEventListener("click.custom").length) {
    $('body').bind("click.custom", function(e) {
        console.log(e.target);
    });
} 
```

我希望此方法输出**所有**单击的元素，但是在我有其他事件处理程序的地方遇到了问题。考虑以下代码：

```
<a href="www.stackoverflow.com" class="my-link">Click</a>
<script>
    $(document).on("click", ".my-link", function(e) {
        alert("not allowed to click this");
        e.preventDefault();
    });
</script> 
```

最终发生的是 preventDefault 调用阻止我的自定义事件运行。
我希望阻止将用户重定向到链接的默认事件，但我希望触发任何自定义事件。

当然，可以从任何地方手动触发每个事件以防止调用默认值，但是有没有通用的方法呢？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:42:35.670

不确定您的 hasEventListener 方法实现是什么，我认为这会阻止自定义事件绑定，

但是，如果您删除检查，它工作正常。

[http://jsbin.com/udonew/3/edit](http://jsbin.com/udonew/3/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:32:01.300

绝对是我的错误 - 我定义了一个自定义 preventDefault ，它包含：

```
e.stopPropagation();
e.stopImmediatePropagation(); 
```

显然这就是问题所在。谢谢！

# android - 使用 Sherlock 更改操作栏选项卡中的字体样式

> ID：12665186
> 
> 赞同：11
> 
> 时间：2012-09-30T21:14:22.687
> 
> 标签：android, tabs, actionbarsherlock

我读过这个：

[Android - 自定义操作栏 Sherlock 选项卡](https://stackoverflow.com/questions/9853344/android-customizing-actionbar-sherlock-tabs)

还有更多链接，我已经弄清楚什么是 StackedBackground 和什么是 Background，但我找不到如何从选项卡中删除所有大写字母并获取常规字体，或更改操作栏选项卡中的字体大小。

除此之外，我想改变我的蓝色下划线的颜色，如果我使用 9 个补丁图形，我会得到与上面链接类似的情况，我的行在文本下方，但不在选项卡底部下方，并且原来的蓝线仍然存在，所以我得到两条线。

到目前为止，我有这个，但我已经尝试了文本大小和各种颜色，但没有：

```
<style name="CustomActivityTheme" parent="@android:style/Theme.Holo.Light">
    <item name="android:actionBarStyle">@style/MyActionBar</item>
    <item name="android:actionBarTabTextStyle">@style/MyActionBar</item>
</style>

<style name="MyActionBar" parent="@android:style/Widget.Holo.ActionBar">
    <item name="android:background">@drawable/grey</item>
    <item name="android:backgroundStacked">@drawable/ab_transparent_example</item>
    <item name="android:textAllCaps">false</item>
    <item name="android:textSize">10dp</item>
</style> 
```

编辑：我刚刚发现我可以使用“android:actionBarTabTextStyle”删除所有大写字母，但它现在从“MyActionBar”获取背景颜色......所以如何在某些层次结构中设置 actionBarTabTextStyle 和 actionBarStyle 列表，该文本被缩小而不是在 Caps 中，但它不是“MyActionBar”样式的背景。

编辑 2：我尝试了更多 9patch 图像，它看起来很难看，但我就是无法摆脱蓝线......

![丑蓝线](../Images/237e807576f2ed9f508a5814618d6bb0.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-07T01:30:42.383

我知道这是很久以前问过的，但我花了一段时间试图解决这个问题，所以这适用于任何发现这个问题并且仍然想知道答案的人。

首先在其中制作一个 xml 文件：tab_title.xml

```
<TextView
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/action_custom_title"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="My Custom title"
android:textColor="#fff"
android:textSize="18sp"
android:paddingTop="5dp" /> 
```

然后在您实例化 ActionBar 的类中，使用此代码设置每个选项卡上的文本。（此示例使用[ActionBarSherlock](http://actionbarsherlock.com/)。）

```
ActionBar bar = getSupportActionBar();
bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

String[] tabNames = {"Tab 1","Tab 2","Tab 3"};

for(int i = 0; i<bar.getTabCount(); i++){
    LayoutInflater inflater = LayoutInflater.from(this);
    View customView = inflater.inflate(R.layout.tab_title, null);

    TextView titleTV = (TextView) customView.findViewById(R.id.action_custom_title);
    titleTV.setText(tabNames[i]);
    //Here you can also add any other styling you want.

    bar.getTabAt(i).setCustomView(customView);
} 
```

希望这可以帮助任何像我一样遇到麻烦的人。

**//更新 2015 年 1 月 6 日**

如果您在**android M 预览**中使用 TabLayout并且想要更改字体，则必须向以前的解决方案添加一个新的 for 循环，如下所示：

```
 private void changeTabsFont() {

        ViewGroup vg = (ViewGroup) tabLayout.getChildAt(0);
        int tabsCount = vg.getChildCount();
        for (int j = 0; j < tabsCount; j++) {
            ViewGroup vgTab = (ViewGroup) vg.getChildAt(j);
            int tabChildsCount = vgTab.getChildCount();
            for (int i = 0; i < tabChildsCount; i++) {
                View tabViewChild = vgTab.getChildAt(i);
                if (tabViewChild instanceof TextView) {
                    ((TextView) tabViewChild).setTypeface(Font.getInstance().getTypeFace(), Typeface.NORMAL);
                }
            }
        }
    } 
```

# java - 实施清单 : 我需要新课吗？

> ID：12665189
> 
> 赞同：2
> 
> 时间：2012-09-30T21:14:53.760
> 
> 标签：java, list, implementation

首先，我最近几周一直在学习Java，所以我还没有太多经验。

这更像是一个理论问题。我想创建一个简单的列表。

所以首先我创建了一个类，在其中指定了一些方法。我希望它是通用的，所以我可以使用任何类型。

```
 public interface List<E> 
```

现在我需要实现它，所以我创建了：

```
 public class MyList<E> implements List<E> 
```

现在，我需要两个属性：

```
 private E element;
 private MyList<E> next; 
```

一个将保存我的通用类型，另一个将是到下一个元素的链接。首先，我不知道这是否是正确的写法。如果我把这个属性留在这个类中，它会正常工作吗？

其次，我一直在考虑是否最好创建另一个类，比如说一个`Box`包含这两个字段的类，从而在我的实现过程中使操作更容易。

可能是一个愚蠢的问题，但我正在努力学习并理解做到这一点的最佳方法。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T21:22:28.487

我猜你正在尝试实现一个单链表。现在回答你的问题，我认为创建一个`Box`你提到的类（通常称为`Node`）对你是有益的。因此，您的实现可能如下所示：

```
public class MyList<E> implements List<E> {
    private Node<E> head;

    private static class Node<E> {
        private E element;
        private Node<E> next;

        public Node(E element, Node<E> next) {
            this.element = element;
            this.next = next;
        }

        // ...
    }

    // ...
} 
```

`MyList`将持有一个`Node`连接到其他`Node`s 链的单个。如果您[看一下](http://developer.classpath.org/doc/java/util/LinkedList-source.html)，这就是实际`java.util.LinkedList`类的编写方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T21:27:17.337

首先，列表具有保存元素的节点。例如：

```
public class Node<E> {
    private E element;
    private Node<E> next;
} 
```

其次，您需要定义一个根节点，但从这里开始，您有两种实现方式：

*   让节点实现List接口或者继承Node元素并让this实现接口
*   创建一个实现您的接口并保存根元素的类（常用方法）

我将解释第二种方式，因为这是通常的方式。我们需要一个“主类”：

```
public class MyList<E> implements List<E> {
    private Node<E> root;
} 
```

这个类现在应该实现你的方法并在根对象上工作——例如使用根节点的下一个指针遍历节点等等。此外，通常还会保存最后一个节点以便更快地添加，并且还会存储当前大小 - 因此，您需要在 List 实现中再添加两个变量。

但是，Node 类现在应该是私有内部类！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:20:04.650

如果您只想使用您的列表，则`java.util`-package 中有标准实现：例如[LinkedList](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedList.html)和[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)。如果您想阅读有关不同类型列表及其实现方式的信息，[维基百科](http://en.wikipedia.org/wiki/Linked_list)总是一个很好的起点。

# javascript - 在文件末尾包含 javascript 文件不适用于某些功能

> ID：12665190
> 
> 赞同：-1
> 
> 时间：2012-09-30T21:15:09.713
> 
> 标签：javascript, html

在我的文件中，一个有许多 dom 元素和一个外部 javascript 文件，该文件具有一些管理事件的功能。问题是当我`functions.js`在主文件末尾包含该文件时：

```
 <script src="functions.js"></script> 
```

这适用于某些元素，但不适用于其他元素。所以我把它移到我文件的顶部，现在它适用于某些元素，但也不适用于其他元素。

它不起作用意味着我在 Web 控制台中遇到了这样的错误：

```
ReferenceError: oneOfMyFunctions is not defined 
```

最好的放置位置是什么？提前谢谢。

**编辑：**

在我的 html 文件（主文件）中，我这样做了：

```
 <script>
                window.onload = function(){

        // start calling your function eg. functions.j();
        myFunction();

   };

     </script> 
```

仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:19:19.270

您可以将`JavaScript`文件放在页面中的任何位置。但是您应该使用`window.onload`方法来开始执行您的代码。

```
<script>

  window.onload = function(){

        // start calling your function eg. functions.j();
   };

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:21:51.737

如果您在加载之前调用该函数，它不知道该做什么。有两种解决方案：

1.  使用 window.onload 选项（或 jquery $(document).ready(function(){ ... });
2.  加载脚本后进行函数调用。

# c# - 当我在 XNA 中使用矩阵和矩形赋值时，它会重复还是引用？

> ID：12665195
> 
> 赞同：0
> 
> 时间：2012-09-30T21:16:16.360
> 
> 标签：c#, matrix, xna, rectangles

我有一个关于 XNA 的问题，我也是新手，在搜索谷歌后无法在文档中找到明确的答案。

问题一：

如果我这样做：

```
Rectangle afterMoveRect = collisionRectangle;
afterMoveRect.Offset((int)moveAmount.X, (int)moveAmount.Y); 
```

我现在是否：

A. 用另一个名字引用collisionRectangle，然后移动collisionRectangle

或者

B. 创建了碰撞矩形的副本并且只移动了副本。

第二个问题：

如果我这样做：

```
Matrix transform = localTransform;

transform = transform * otherTransform; 
```

我是创建了 localTransform 的副本并复制了该副本，还是引用了 localTransform 并将其与另一个标识符相乘？

两者的问题是相同的，我是否更改了原件（可能是无意的）

问题 3：

你怎么知道你是否改变了原来的？在使用赋值运算符时，如何知道是使用新名称（如 Java）引用原始对象还是创建另一个对象的深层副本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:19:32.130

完全取决于`Rectangle`or`Matrix`是 a`struct`还是 a `class`。

如果它是一个`struct`（值类型），它将被复制，您正在处理不同的实例。如果它是一个`class`（引用类型）它将被引用，那么您正在处理同一个对象。

根据 msdn，[Rectangle](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.rectangle.aspx)和[Matrix](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.matrix.aspx)都是结构，因此您正在处理副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T21:19:33.550

它被称为引用类型和值类型。引用类型（基本上是类）在作为值给出时不会创建，仅指向引用，因此在这种情况下，新名称的修改将影响原始名称。在值类型（结构）的情况下，复制完成，之后两者独立处理。

[`Matrix`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.matrix.aspx)和都是[`Rectangle`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.rectangle.aspx)结构，它们被复制了。

# php - 将编码设置为 UTF8 - PHP

> ID：12665201
> 
> 赞同：0
> 
> 时间：2012-09-30T21:17:40.303
> 
> 标签：php, mysql, encoding, utf-8

> **可能重复：**
> [在 MySQL 中设置名称 utf8？](https://stackoverflow.com/questions/2159434/set-names-utf8-in-mysql)

我正在编写 PHP 以连接到 MySQL 数据库。我看过一些将编码设置为 UTF8 的示例`mysql_query("SET NAMES utf8");`

为什么这样做？这样做有什么好处，避免了哪些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:19:52.907

这样，数据库将以 UTF8 编码返回数据（如果您正在插入/更新，则期望这样）。如果您尝试从服务器查询非 ascii 字符并以 UTF8 格式显示内容，并带有 UTF8 编码标头，则很有用。否则你会看到破碎的字符。

如果数据库中的数据采用非 ascii 和非 utf8 编码/排序规则（如 CP-1251 用于西里尔字母）或者您在同一数据库中有多个排序规则，则特别有用。通过这种方式，您可以确保以单一通用编码获取/放入所有数据，您都理解并喜欢 :)

一般来说，这是一个很好的做法。大多数情况下，您无法确保没有非 ascii 字符的数据，或者不会插入此类数据。因此，始终这样做只是一个好习惯，因为 UTF8 似乎是当今被广泛接受和喜爱的数据编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:20:26.810

MySQL 参考非常简洁地回答了这个问题：http: [//dev.mysql.com/doc/refman/5.0/en/charset-connection.html](http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html) 请务必在 SO 之前尝试使用 google ：/ 虽然我不太介意，很多人**确实**如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:22:17.120

通过这样做，您告诉 php 以 UTF-8 与 mysql 通信。运行这行代码的成本几乎为零。在性能方面不会有任何缺点。如果您不想使用它并拥有权限，您应该从您的 mysql 设置中更改它。

请参考以下链接： [http ://dev.mysql.com/doc/refman/5.0/en/charset-connection.html](http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html)

# smalltalk - 你推荐 VisualWorks 进行海边开发吗？

> ID：12665205
> 
> 赞同：0
> 
> 时间：2012-09-30T21:18:26.260
> 
> 标签：smalltalk, seaside

你推荐 VisualWorks 进行海边开发吗？还是弗吉尼亚州？或者？

我想我记得看到过关于 Cincom 对 webvelocity 和/或 seaside 的承诺的讨论吗？我以为他们正在远离 webvelocity ？有谁知道他们是否还在海边努力？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T13:25:06.283

尽管 Cincom 的 VisualWorks 和 Instantiation 的 VAST（以前的 IBM VisualAge Smalltalk）是很好的环境，但您应该检查它们的许可和定价。

VAST 付出了很多努力，以使一切正常工作并保持最新状态，这是有史以来最强大的 Smalltalks 之一。VisualWorks 在承诺和企业存在方面有着悠久的历史。

不过我会推荐使用[Pharo Smalltalk](http://www.pharo-project.org)，这是开发 Seaside 平台的 Smalltalk 方言，然后移植到其他方言。它是当今发展速度更快的 Smalltalks 之一。

您还可以考虑使用 GLASS，即 Seaside 的[Gemstone Smalltalk](http://seaside.gemstone.com/)实现，它由强大的 Gemstone/S 活动对象数据库提供支持。

我建议您先从 Pharo 开始，然后如果需要，您可以迁移到 GLASS。

问候，

# java - 休眠教程不起作用

> ID：12665210
> 
> 赞同：1
> 
> 时间：2012-09-30T21:19:26.527
> 
> 标签：java, hibernate, maven

我一直在关注[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html上的休眠教程](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html)

正如其他人在各种网络板上指出的那样，它是不完整的。当我运行这个命令时：

> mvn exec:java -Dexec.mainClass="org.hibernate.tutorial.EventManager" -Dexec.args="store"

```
[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building First Hibernate Tutorial 1.0.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] >>> exec-maven-plugin:1.2.1:java (default-cli) @ hibernate-tutorial >>>
[INFO]
[INFO] <<< exec-maven-plugin:1.2.1:java (default-cli) @ hibernate-tutorial <<<
[INFO]
[INFO] --- exec-maven-plugin:1.2.1:java (default-cli) @ hibernate-tutorial ---
[WARNING]
java.lang.ClassNotFoundException: org.hibernate.tutorial.EventManager
        at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
        at org.codehaus.mojo.exec.ExecJavaMojo$1.run(ExecJavaMojo.java:285)
        at java.lang.Thread.run(Thread.java:722)
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 0.962s
[INFO] Finished at: Sun Sep 30 17:03:34 EDT 2012
[INFO] Final Memory: 5M/15M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.codehaus.mojo:exec-maven-plugin:1.2.1:java (d
efault-cli) on project hibernate-tutorial: An exception occured while executing
the Java class. org.hibernate.tutorial.EventManager -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e swit
ch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please rea
d the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionE
xception 
```

所以我认为问题很明显。当maven执行java时，java不知道在哪里可以找到我的'EventManager'。我在命令行上尝试了以下操作：

> 设置 CLASSPATH=C:\Users\robe\Documents\hibernate\project1\src\main\java\org

这里还有什么问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:25:27.120

I think your classpath is wrong. Try

```
set CLASSPATH=C:\Users\robe\Documents\hibernate\project1\src\main\java 
```

You don't need the org. That is part of the full qualified class name. The full class name is org.hibernate.tutorial.EventManager

I am not familiar with this tutorial's problem. You may get other classpath errors. If you do you can add more to the class path by separating them by a semi colon.

Also you are setting the classpath in the cmd line. It will only be set for that session so you will have to run your mavem command in the same one. Or set it in your global environment variables

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:29:21.553

Try running:

```
mvn clean install 
```

I know it sounds obvious, but when I tried to execute

```
mvn exec:java -Dexec.mainClass="org.hibernate.tutorial.EventManager" -Dexec.args="store" 
```

I get the same error as you did. But after running mvn clean install the app started (I ran clean install for this code [https://github.com/stivlo/hibernate-tutorial](https://github.com/stivlo/hibernate-tutorial), it looks it is the same thing)

# c++ - 在对 gawk 代码进行词法分析时区分除法和正则表达式

> ID：12665213
> 
> 赞同：2
> 
> 时间：2012-09-30T21:19:34.180
> 
> 标签：c++, regex, awk, lex

我正在为 gawk 脚本编写一个弹性解析器。我在区分正斜杠 (/) 字符的用途时遇到了问题。

显然，单个 / 将是除法运算符，但两个斜杠既可以是正则表达式也可以是除法。现在，它解析

```
int((r-1)/3)*3+int((c-1)/3)+1 
```

因为有正则表达式

```
/3)*3+int((c-1)/ 
```

而不是预期的分裂行动。如何让 flex 将其识别为数学表达式？

现在，这是我在 gawk 中识别正则表达式的 flex 正则表达式：

```
EXT_REG_EXP "\/"("\\\/"|[^\/\n])*"\/" 
```

并且除法运算符应该被我的运算符列表捕获：

```
OPERATOR "+"|"-"|"*"|"/"|"%"|"^"|"!"|">"|"<"|"|"|"?"|":"|"~"|"$"|"=" 
```

但是由于 flex 正则表达式是贪婪的，我猜它会将两个除法视为正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T01:26:00.380

我认为不可能定义一个简单的标记表达式来明确识别正则表达式。awk的[Posix 规范](http://pubs.opengroup.org/onlinepubs/009695399/utilities/awk.html)因此指出了歧义：

> 在某些情况下，用于包围 ERE 的斜线 ('/') 也可以是除法运算符。这应该以这样一种方式解决，即在除法运算符出现的任何地方，斜线都被假定为除法运算符。（没有一元除法运算符。）

然后：

> 标记 ERE 与标记 '/' 和 DIV_ASSIGN 之间存在词汇歧义。当输入序列在任何句法上下文中以斜杠字符开头时，其中标记“/”或 DIV_ASSIGN 可能作为有效程序中的下一个标记出现，则应识别这两个标记中可以识别的较长者。在令牌 ERE 可能作为有效程序中的下一个令牌出现的任何其他句法上下文中，令牌 ERE 应被识别。

（“ERE”代表“扩展正则表达式”。）由此，我认为您可以安全地得出结论，Awk 的标记器必须了解语法上下文，因此没有可能的正则表达式可以成功识别正则表达式令牌。

还值得研究如何定义 Awk 本身（或至少一个实现）来解析正则表达式。在最初的 Awk（有时称为 One True Awk）中，识别正则表达式是[解析器](https://github.com/danfuzz/one-true-awk/blob/master/awkgram.y)的工作，当它发现它应该期望读取一个正则表达式时，它显式地将词法分析器设置为“正则表达式模式”：

```
reg_expr:
      '/' {startreg();} REGEXPR '/'     { $$ = $3; }
    ; 
```

（`startreg()`是[lex.c](https://github.com/danfuzz/one-true-awk/blob/master/lex.c)中定义的函数。）`reg_expr`规则本身只在除法运算符无效的上下文中匹配。

很抱歉让您失望了，但我希望这仍然会有所帮助。

# vb.net - XAML 按钮内容根据 VB 变量变化

> ID：12665215
> 
> 赞同：0
> 
> 时间：2012-09-30T21:20:02.157
> 
> 标签：vb.net, xaml, button

初学者在这里。我想在 XAML 中创建一个按钮，该按钮具有基于 VB 中的变量的文本。我在VB中设置了变量

Dim ButtonName1 = "测试"

我需要做什么才能使按钮内容显示 ButtonName1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T03:52:59.297

这真的很容易。您的 Button 有一个 Name 属性，您可以使用它在后面的代码中引用它，请注意在此示例中`Button1`您只需将字符串分配给 Button 的 Content 属性

**Xaml**

```
<Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="10,10,0,0" Name="Button1" VerticalAlignment="Top" Width="75" /> 
```

**xml.vb**

```
Dim ButtonName1 = "Test"
Button1.Content = ButtonName1 
```

# .net-4.0 - 为什么我在新的 MVC4 项目中出现编译错误？

> ID：12665217
> 
> 赞同：13
> 
> 时间：2012-09-30T21:20:04.653
> 
> 标签：.net-4.0, asp.net-mvc-4, visual-studio-2012

我一直无法找到这个问题的答案，并且整个周末都在网上搜索，所以我希望你能帮我解决这个问题。

使用 Visual Studio 2012 时，我创建了一个新的 MVC4 Web 应用程序项目并得到一些编译错误。

这是我的问题：

1.  我使用 Visual Studio 2012 创建了一个新的 MVC4 Web 应用程序，我选择 Internet 应用程序并将其设置为使用 RAZOR 引擎。

2.  我转到应用程序属性并在应用程序选项卡下将目标框架从 .NET Framework 4.5 更改为 .NET Framework 4。

3.  构建会产生以下错误：

    > 错误 1 ​​找不到类型名称“TableAttribute”。此类型已转发到程序集“System.ComponentModel.DataAnnotations, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”。考虑添加对该程序集的引用。c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels.cs 21 6 MvcApplication1
    > 
    > 错误 2 找不到类型或命名空间名称“表”（是否缺少 using 指令或程序集引用？） c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels。 cs 21 6 MvcApplication1
    > 
    > 错误 3 找不到类型或命名空间名称“DatabaseGeneratedAttributeAttribute”（是否缺少 using 指令或程序集引用？） c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels。 cs 25 10 MvcApplication1
    > 
    > 错误 4 找不到类型名称“DatabaseGeneratedAttribute”。此类型已转发到程序集“System.ComponentModel.DataAnnotations, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”。考虑添加对该程序集的引用。c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels.cs 25 10 MvcApplication1
    > 
    > 错误 5 找不到类型或命名空间名称“CompareAttribute”（是否缺少 using 指令或程序集引用？） c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels。 cs 54 10 MvcApplication1
    > 
    > 错误 6 找不到类型或命名空间名称“Compare”（是否缺少 using 指令或程序集引用？） c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels。 cs 54 10 MvcApplication1
    > 
    > 错误 7 找不到类型或命名空间名称“CompareAttribute”（是否缺少 using 指令或程序集引用？） c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels。 cs 87 10 MvcApplication1
    > 
    > 错误 8 找不到类型或命名空间名称“Compare”（是否缺少 using 指令或程序集引用？） c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels。 cs 87 10 MvcApplication1

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-16T09:47:39.273

只需重新安装 EntityFramework：

1.  转到包管理器控制台
2.  卸载包实体框架
3.  安装包实体框架

那就是错误应该消失！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-01T11:52:33.403

其实不是MVC4模板项目的问题，而是目标.Net Framework的问题。

当您在 VS2012 中创建新的 MVC4 项目时，它将（默认情况下）引用 .Net 4.5。所有文件均基于此版本生成。AccountModel 使用来自`System.ComponentModel.DataAnnotations`( `TableAttribute`, `DatabaseGeneratedAttribute`, ...

重新定位框架版本只会更改引用并且不会影响源代码：来自 4.5 框架的属性不会被删除。

如果你想要一个带有 .Net 4.0 的 MVC4 项目，你可以：

*   从 AccountModel 中删除了 .net 4.5 属性
*   如果不需要，请删除 AccountMode
*   在创建新项目向导中选择 .NET 4.0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-09T23:57:52.037

Uninstall-Package entityframework / Install-Package entityframework 解决方案对我不起作用。相反，我不得不在记事本中打开 .csproj 文件并进行查找并将“net40”替换为“net45”，以强制它加载所有包的 .net 4.5 版本。这也使正确版本的 EntityFramework 加载。

# ruby-on-rails - rails respond_with 关联记录

> ID：12665220
> 
> 赞同：0
> 
> 时间：2012-09-30T21:20:28.650
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, grails-controller, respond-with

例如，有一个`Question`模型`has_many :answers`

我想在`questions#show`（就像stackoverflow一样）上显示一个新答案的表格

路线将类似于：

```
resources :questions do
  resources :answers
end 
```

在这些情况下，显示无效记录错误的最佳方式是什么？

问题是我不能`render`从内部执行我需要的操作`AnswersController`（因为它会是`questions#show`），唯一的方法似乎是`redirect_to`将错误存储在`flash`哈希中。

它看起来像一个非常常见的场景，我相信应该有一些更好的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T06:02:08.440

这可能是向您的 : 添加新的资源丰富的成员路由实际上是合理的少数情况之一`QuestionsController`：

```
resources :questions do
  post 'answer', :on => :member
end 
```

它将`question/:id/answer`通过路由到的 POST 请求进行识别`questions#answer`，从而允许您将所有逻辑保存在一个控制器中：

```
class QuestionsController < ApplicationController
  ...
  def show
    @question = Question.find(params[:id])
  end

  def answer
    @question = Question.find(params[:id])

    @answer = @question.answers.build(params[:question][:answer])

    if @answer.save
      # show question with newly posted answer at url /question/:id
      redirect_to @question
    else
      # show question with invalid editable answer at url /question/:id/answer
      render 'show'
    end
  end
  ...
end 
```

说明：在我看来，在一个控制器而不是两个控制器中处理逻辑的决定归结为您认为感兴趣的资源。通常，您会认为每个模型代表一个不同的资源，因此创建一个单独的控制器来处理与每个资源相关的操作。然而，当有多个深度耦合的模型在单个视图中处理多个动作（例如`show`, ）时`new`，将模型视为形成*单个*资源可能更清晰。`create`

 *在这个例子中，我认为资源是一个由问题和答案组成*的集体资源。*由于这个集体资源是由问题本身唯一标识的，我会让问题控制器处理它。问题控制器中的`show`动作已经涉及检索集体问答资源，因此您可能会将`answer`动作（以及潜在`unanswer`的`reanswer`动作）视为该`update`集体资源的类似物。

以这种方式考虑资源很大程度上取决于设计偏好，并且会根据需求进行权衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T15:54:38.303

您可以像这样渲染`questions#show`：`AnswersController`

```
render :template => 'questions/show' 
```

如果您想跳转到页面上的特定锚点，您必须在您的答案表单中定义它：

```
<%= form_for(@answer, :url => question_answers_url(@question, :anchor => 'answer_form')) do |f| -%> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-14T06:35:54.813

具有将数据发布到 answers_controller#create 操作的形式的部分。

因此，在您的问题#show 页面 - show.html.erb 中，呈现部分

```
<%= render :partial => "answers/answer_form" %> 
```

在 _answer_form.html.erb 中，有一个将数据发布到 answers#create 的表单

```
<% form_for @answer do |f| %>
  # have a text area
<% end %> 
```

**就闪光灯而言**

在 AsnwersController

```
def create
  @question = Question.find(params[:question_id])
  @answer = Answer.build(params)
  if @answer.save
    flash[:notice] = "Answer was posted successfully"  
  else
    flash[:error] = "There were a few errors please try again"  
  end
  redirect_to question_path(@question) 
end 
```*

# python - 如何从函数中检索所有返回的变量？

> ID：12665231
> 
> 赞同：0
> 
> 时间：2012-09-30T21:22:21.113
> 
> 标签：python, variables, random

```
import random

def some_function():
    example = random.randint(0, 1)
    if example == 1:
        other_example = 2
    else:
        return False
    return example, other_example 
```

在此示例中，可能会返回一个或两个变量。通常，对于一个变量，我会使用 `var = some_function()`while 来表示两个，`var, var2 = some_function()`. 如何判断函数返回了多少变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:28:01.310

try something like this:

```
>>> lis=(1,)[:2] #just one value, 
>>> lis
(1,)

>>> lis=(1,2)[:2]   #two values
>>> lis
(1, 2)

>>> lis=(1,2,3,4,5)[:2]  #any number of values
>>> lis
(1, 2)

# used [:2] here, because you only expect a maximum of 2 values
# use [:] to collect any number of values 
```

But the only problem with this approach is that you need to return a `tuple` at every `return` statement, so `return False` becomes `return False,`

using `iter()`, this too expect that you always return a tuple or any iterable:

```
>>> ret=((1,))
>>> ret=iter((1,))
>>> a,b=ret.next(),list(ret)[:1]  #used [:1] coz we need to store only 2 elements
>>> a,b
(1, [])

>>> ret=iter((1,2))
>>> a,b=ret.next(),list(ret)[:1]
>>> a,b
(1, [2])

>>> ret=iter((1,2,3,4))
>>> a,b=ret.next(),list(ret)[:1]
>>> a,b
(1, [2]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T21:28:38.013

There's no guaranteed way to tell the difference between a function that returns a single `tuple` and one that returns multiple non-tuple values. If you know that the function doesn't return a `tuple`, though, then you can use this code to check for multiple return values:

```
return_val = some_function()
if isinstance(return_val, tuple):
    # number of returned values is len(return_val)
    if len(return_val) == 2:
        var, var2 = return_val
else:
    # returned a single non-tuple item
    var = return_val 
```

The best way to handle this, however, is to write functions that don't return different numbers of values in different cases. Instead, you can do something like...

```
def some_function():
    example = random.randint(0, 1)
    if example == 1:
        other_example = 2
    else:
        return False, None
    return example, other_example 
```

...so that the function always returns two values. Alternatively, you can always return a single tuple, and just check for the number of elements in that tuple (so for instance, returning an empty tuple `()` or a tuple with a single false value `(False,)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T21:29:44.443

```
var_returned = some_function()
num_vars = len(vars_returned) if (not vars_returned == False) else 0 
```

ternary then! this can be done even shorter.

```
vars_returned = 7, 2
num_vars = len(vars_returned) if vars_returned else 0
print(num_vars)
# 2

vars_returned = False
num_vars = len(vars_returned) if vars_returned else 0
print(num_vars)
# 0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T21:35:26.473

为什么不试试这个：

```
import random

def some_function():
    example = random.randint(0, 1)
    if example == 1:
        other_example = 2
    else:
        return ()
    return example, other_example 
```

这样，您将始终将元组作为返回值，但是当您需要时，元组将测试为 False。像这样使用它：

```
answer = some_function()
if answer:
     var1, var2 = answer 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-30T23:03:08.497

让函数返回明显不同的类型是不好的做法。通常，如果一个函数返回元组，它将始终返回元组，并且它们将始终具有相同数量的项目，除非它们返回`None`。原因正是促使您提出这个问题的原因：很难解释给定的返回值。在任何地方调用你的函数，你都会有解码返回值的开销。并且任何文档都必须解释每种情况下的预期输出。

有很多合理的选择。您可以返回将数据包装在某些上下文中的对象、字典或[collections.namedtuple](http://docs.python.org/library/collections.html#collections.namedtuple)。或者，对于大多数真实世界的代码，您可以将其划分为更易于理解的不同行的函数。

# php - 在 PHP 中读取和迭代 .txt

> ID：12665233
> 
> 赞同：5
> 
> 时间：2012-09-30T21:22:41.293
> 
> 标签：php, file

我感觉我快到了。这是一个 .txt 文件，大约 60 KB，里面全是德语单词。每个单词都换行。

我想用这段代码遍历它：

```
<?php

    $file = "GermanWords.txt";
    $f = fopen($file,"r");

    $parts = explode("\n", $f);

    foreach ($parts as &$v) 
    {
        echo $v;
    }

?> 
```

当我执行这段代码时，我得到：`Resourceid#2` 这个词资源不在.txt中，我不知道它来自哪里。

我怎样才能设法显示txt中的所有单词？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-30T21:26:04.143

无需[`fopen`](http://php.net/manual/en/function.fopen.php)使用[`file_get_contents`](http://php.net/manual/en/function.file-get-contents.php)：

```
$file = "GermanWords.txt";
$contents = file_get_contents($file);
$lines = explode("\n", $contents); // this is your array of words

foreach($lines as $word) {
    echo $word;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-30T21:27:52.710

`fopen()`只是打开文件，它不读取它——在你的代码中，`$f`包含一个文件句柄，而不是文件内容。这就是“资源”一词的来源；它是文件句柄的 PHP 内部名称。

一种答案是替换`fopen()`为`file_get_contents()`. 这将在一个操作中打开并读取文件。这将解决问题，但如果文件很大，您可能不想一次将整个内容读入内存。

所以我建议改为使用`SplFileObject()`. 代码如下所示：

```
<?php
$file = "GermanWords.txt";
$parts = new SplFileObject($file);
foreach ($parts as $line) {
    echo $line;
}
?> 
```

它一次只读入内存一行，因此您不必担心文件的大小。

希望有帮助。

有关更多信息，请参阅 PHP 手册：http: [//php.net/manual/en/splfileobject.construct.php](http://php.net/manual/en/splfileobject.construct.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T21:26:05.153

`$f`，结果[`fopen`](http://php.net/fopen)是资源，而不是文件的内容。如果您只想要文件中包含的行数组，您可以使用[`file`](http://php.net/file)：

```
$parts = file('GermanWords.txt');
foreach($parts as $v){
    echo $v;
} 
```

或者，如果您想坚持使用[`fopen`](http://php.net/fopen)，可以使用[`fread`](http://php.net/fread)阅读内容：

```
$f = fopen('GermanWords.txt', 'r');
// read the entire file into $contents
$contents = fread($f, filesize('GermanWords.txt'));
fclose($handle);
$parts = explode("\n", $contents); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-04T10:33:17.563

在处理文件之前读取文件的全部内容（使用`file_get_contents`）可能会消耗内存。

如果你想逐行处理文件，这个类可能会帮助你。

它实现了一个`Iterator`（参见[phpdoc 关于它](https://secure.php.net/manual/en/class.iterator.php)），可以`foreach`循环遍历。只有读取的最后一行存储在内存中。

```
class TxtFileIterator implements \Iterator{

protected $fileHandler;
protected $key;
protected $current;
protected $fileName;

function __construct($fileName){
    $this->fileHandler = fopen($fileName, "r") or die("Unable to open file!");        

    $this->fileName = $fileName;
    $this->key = 0;
}

function __destruct(){
    fclose( $this->fileHandler );
}

//Iterator interface
public function current (){       
    return $this->current;
}

public function key (){
    return $this->key;
}

public function next (){
    if ( $this->valid() ){
        $this->current = fgets( $this->fileHandler );
        $this->key++;
    }
}

public function rewind (){
    $this->__destruct();
    $this->__construct( $this->fileName );
}

public function valid (){
    return !feof( $this->fileHandler );
} 
```

用法 ：

```
$iterator = new TxtFileIterator("German.txt");

foreach ($iterator as $line) {
    echo $line;// or do whatever you want with line
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-17T09:52:48.360

提供`SplFileObject`了[一种方法来做到这一点](https://secure.php.net/manual/en/splfileobject.fgets.php)：

```
$file = new SplFileObject("file.txt");
while (!$file->eof()) {
    echo $file->fgets();
} 
```

如果您更喜欢 foreach 循环，您可以为此创建一个[生成器函数](http://au1.php.net/manual/en/language.generators.comparison.php)：

```
function lines($filename) {
    $file = new SplFileObject($filename);
    while (!$file->eof()) {
        yield $file->fgets();
    }
}

foreach (lines('German.txt') as $line) {
    echo $line;
} 
```

# python - Blender 的内部数据在缩放操作后不会更新

> ID：12665235
> 
> 赞同：1
> 
> 时间：2012-09-30T21:22:44.583
> 
> 标签：python, 3d, blender

我有以下脚本：

```
import bpy
import os

print("Starter")

selection = bpy.context.selected_objects

for obj in selection:

    print("Obj selected")

    me = obj.data

    for edge in me.edges:

        vert1 = me.vertices[edge.vertices[0]]
       vert2 = me.vertices[edge.vertices[1]]
       print("<boundingLine p1=\"{0}f,0.0f,{1}f,1.0f\" p2=\"{2}f,0.0f,{3}f,1.0f\" />".format(vert1.co.x, vert1.co.y, vert2.co.x, vert2.co.y)) 
```

很基本，对吧？它只是将所有边缘打印到控制台中，让我将粘贴复制到 xml 文档中。当我缩放对象并在对象上执行此脚本时，我会在缩放之前获得输出到控制台的对象的 OLD 未缩放值。我尝试在所有轴上移动对象中的每个顶点，这导致输出的值被放大，然后根据我的移动进行转换。

如果我按 n 检查顶点全局值，它们会正确缩放。

为什么我没有得到正确的值？！？

这个脚本应该可以节省时间，但是让任何东西在搅拌机中工作都是一件苦差事！他们刚刚更新了他们的 api 并没有帮助，所以那里的所有示例代码都已经过时了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T07:46:51.010

好吧，这就是交易：当您在 Blender 中缩放、平移或旋转对象时，或者以其他方式执行转换时，该转换会以某种方式“存储”。你需要做什么我选择你应用了变换的对象，并使用快捷键CTRL + A，然后应用你的变换。

...

因此，通过 blender api 访问的内部数据与实际显示的值之间不乏偶然性（我使用这个词对吗？检查了它的定义，看起来是对的）。

我确信这个设计是有道理的，但现在我想一拳打在想出它的人的喉咙上。如果我缩放某些东西，我打算缩放被缩放的东西！

但无论如何，我得到奇怪值的原因是因为没有应用缩放，一旦你在对象模式下选择了你缩放的对象，你就用 CTRL + A 来做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-09T22:59:30.423

网格对象的顶点具有内部坐标系，以及适用于整个对象的全局平移、缩放和旋转变换。您可以将全局缩放矩阵应用于网格数据，并将顶点坐标转换为全局坐标系，如下所示：

```
bpy.ops.object.select_all(action='SELECT')
bpy.ops.object.transform_apply(scale=True)
bpy.ops.object.select_all(action='DESELECT') 
```

`transform_apply()`允许应用旋转和平移矩阵的其他选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:58:37.057

我不是真正的 Blender 用户（而是 Maya 用户），我认为您可以尝试一些不同的东西（我也会说更慢......），只需遍历选定的顶点，创建一个定位器或一个空对象并对其进行约束到顶点位置并获取它的 x,y,z 坐标。我已经在maya中完成了它并且可以工作。

让我们这样说：

```
data_list = []

selection = #selection code here#

for v in selection:

    loc = locator()
    pointconstraint(v, loc)
    data_list.append(loc.translation_attributes) 
```

# php - php中的修订内容

> ID：12665236
> 
> 赞同：1
> 
> 时间：2012-09-30T21:22:56.370
> 
> 标签：php, mysql, database, revision

我正在尝试为我正在构建的网站实施修订系统，并且正在对其进行设计......

像 Stackoverflow 这样的修订系统（针对内容）是如何工作的？它是存储版本之间的差异还是将全文存储在每个数据库条目中？

我猜这些列是这样的：`date, revision_num, content, author`. 我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:01:30.373

对于内容修订，存储每个修订的全文是可行的方法。如果您使用差异，您可能会节省一些空间，但必须处理数据将弥补节省的空间。对于列，您可能需要帖子 ID、修订号、时间戳、作者 ID 和内容。如果需要，您可以添加其他字段，但这些是基础。旧帖子的任何修订都将共享相同的帖子 ID。

# bash - 打开新的 bash shell 时如何隐藏 RVM 状态消息？

> ID：12665240
> 
> 赞同：1
> 
> 时间：2012-09-30T21:24:09.757
> 
> 标签：bash, rvm

每次我打开一个新的 bash shell 时，以下消息都会打印到我的终端：

```
Using /Users/foo/.rvm/gems/ruby-1.9.3-p194
Running /Users/foo/.rvm/hooks/after_use 
```

我在 Linux 和 OS X 环境中运行 RVM 版本 1.15.8，两个机器都遇到了这个问题。如何隐藏这些消息？

编辑：第二条消息似乎是由 after_use 目录中的脚本引起的。我不想完全删除目录和它包含的脚本，而是想知道究竟是什么导致了这种情况，所以我只能注释掉那一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:53:36.957

看起来你有一个`after_use`钩子

[RVM 网站](https://rvm.io/workflow/hooks/)告诉我们：

> 每个挂钩都是 ~/.rvm/hooks/[挂钩名称] 中的一个文件，您可以在其中放置任何 bash 脚本命令序列。每个钩子文件在运行时都可以在整个 RVM 环境中使用。

我猜删除`/USers/foo/.rvm/hooks/after_use`会解决这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-05T12:13:24.630

对于此问题的下一位访问者，您可以从以下内容[中学到](https://stackoverflow.com/questions/44222770/how-to-do-a-completely-silent-install-of-rvm)：

您可以使用文件描述符将输出转储到 /dev/null

首先重定向 STDOUT（文件描述符 1），然后重定向 STDERR（文件描述符 2）

`rvm --default use 2.4.0 > /dev/null 2>&1`

这将不会向屏幕/ STDOUT 提供任何输出

# jquery - Easy way to style the rows of a jQuery UI DataTable?

> ID：12665246
> 
> 赞同：0
> 
> 时间：2012-09-30T21:25:04.063
> 
> 标签：jquery, css, ruby-on-rails, datatables

I am trying to style a jQuery UI DataTable. I have found the different classes that get inserted such as "odd" and "sorting_1". Right now, in order to change the styling, I am just overriding these in a separate stylesheet.

Is there a better way to change the default styling of the rows?

I don't think the rows are covered by ThemeRoller.

I'm not sure this will matter, but I am doing this in Rails 3.1.0 using the jquery-datatables-rails gem.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:01:32.020

您可以使用 jQueryUI 对其进行样式设置。请参阅[http://datatables.net/styling/themes](http://datatables.net/styling/themes)。如果您不想“覆盖”它们，您可以手动编辑数据表 css 文件。

# mysql - 在 MySQL 中存储和搜索文件

> ID：12665247
> 
> 赞同：1
> 
> 时间：2012-09-30T21:25:10.590
> 
> 标签：mysql, database

我正在尝试在数据库中存储至少 500,000 多个小“文件”（3 KB 平均大小，偶尔可达 8~10 MB）。这是为了将它们从文件系统中删除并加快搜索/用户操作。

*   元数据（主要是文件名、创建日期时间、修改日期时间）
*   文件内容的 LONGBLOB

将它们存储在数据库（MySQL）中很好。数据库存储该数量的文件，并且使用相关索引搜索元数据（字符串、日期时间、日期时间）也很快。

不幸的是，在 LONGBLOB 中进行搜索的任何尝试都非常缓慢。LONGBLOB 中的数据如下所示：

*   80% 是“文本文件”（例如 XML）并且小于 100 KB
*   15% 是“文本文件”，但超过 100 KB（最大 8~10 MB）
*   5% 或更少是二进制文件（可能在“文本”容器中损坏）。

在执行 LIKE "%X%" 之类的操作（而不是 LONGBLOB）时，将此数据分类为文本或未知数据，然后将其放在单独的 LONGTEXT 表中是否会提高性能？

在通过 BLOB 搜索时（以非常“grep”风格），我可以采取任何其他技术来提高性能吗？搜索通常是保存在 BLOB 中的短数据序列，并且可能很少有重复的搜索（但搜索在某种程度上是可预测的，一些数据比其他数据更有趣）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:30:16.437

好吧，你最好做一个全文索引（在如此大量的数据上将是一个巨大的大小）并进行`MATCH AGAINST`查询以有效地搜索。`LIKE`在大量文本上速度非常慢，这是众所周知的，应该避免。

[http://dev.mysql.com/doc/refman/5.5/en//fulltext-search.html](http://dev.mysql.com/doc/refman/5.5/en//fulltext-search.html)

您还可以将它们保存在 FS 中并构建自己的命令行工具，您可以在服务器端语言中调用这些工具，这些工具实际上执行“GREP 样式”搜索并返回与您的“查询”匹配的文件路径列表，但我'不确定这是否有效。

# java - Is there a way to modularize a JavaFX application?

> ID：12665253
> 
> 赞同：5
> 
> 时间：2012-09-30T21:26:04.740
> 
> 标签：java, javafx-2, modularity, fxml

I've started toying with JavaFX 2 and I really like the ease with which one can create a UI with FXML. However, once you get past the basic examples and you need a UI with many windows, it seems illogical to have the definition for the whole application's UI in a single FXML file.

Is it possible to write separate components in separate FXML files and then include them as needed? Say for example that I wanted a window to popup when the user clicks on an item from the main menu; could I write the definition for that window in a separate FXML file, load it at runtime and add it to the node tree?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T09:52:50.057

从 FXML 的角度来看，有两种方法：

1.  只需使用[fx:include](http://docs.oracle.com/javafx/2/api/javafx/fxml/doc-files/introduction_to_fxml.html#include_elements)指令将应用程序拆分为不同 fxml 文件中的逻辑部分。

2.  更高级的方法是将应用程序的部分实现为单独的“控件”。它将有自己的（可能非常简单）API 来提供数据，并且可以在 FXML 或 FX API 中使用，如内置控件。有关如何使用 FXML 实现该功能的详细信息，请参阅下一个问题：[How to pass object created in FXML Controller1 to Controller2 of inner FXML control](https://stackoverflow.com/questions/9717852/how-to-pass-object-created-in-fxml-controller1-to-controller2-of-inner-fxml-cont)

# javascript - 与点击功能相反

> ID：12665254
> 
> 赞同：0
> 
> 时间：2012-09-30T21:26:20.120
> 
> 标签：javascript, checkbox, onclick

如果用户取消单击复选框，相反的功能是什么？

如果用户单击复选框，这是我的脚本

```
<script>
$(document).ready(function() {
  $("input[name$='INopt']").click(function() {
    $("#OUTsrvOtr").prop('class','text')
    });
});
</script>

 <input id="INsrv" name="INopt" type="checkbox" value="1" />1<br> 
```

但如果用户取消单击/取消选中复选框，我希望它运行

```
$("#OUTsrvOtr").prop('class','validate[required] text-input text') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T21:28:28.787

在点击方法中，您可以检查复选框是选中还是未选中

```
<script>
$(document).ready(function() {
  $("input[name$='INopt']").click(function() {
   if(this.checked){
        $("#OUTsrvOtr").prop('class','text');
     }
      else{
          $("#OUTsrvOtr").prop('class','validate[required] text-input text');
     }

    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T21:28:44.807

它仍然是单击，只需要检查`this.checked`- 如果是，`true`则该框已被选中，否则（取消选中）它是`false`.

# mysql - 选择一个表中的 ID 存在于一个或多个其他表中的记录

> ID：12665260
> 
> 赞同：2
> 
> 时间：2012-09-30T21:26:41.797
> 
> 标签：mysql, select, join, inner-join

好的，所以我发现了仅使用两个表就可以做到这一点的问题，大量的问题解释了如果 ID 不存在于其他表中如何执行此操作，但不是此查询的解决方案。

基本上，我有一张葡萄酒年份表。

然后，我有另外四个表，其中包含与特定年份相关的不同类型的内容（即视频、博客等）

我基本上需要能够提取正在使用的年份列表，即在四个内容表中的一个或多个中使用年份 ID 的位置。

我能得到的最接近的是：

```
SELECT DISTINCT vintage_id FROM `pr_video_vintage`
INNER JOIN pr_video ON pr_video.fk_vintage_id = pr_video_vintage.vintage_id
INNER JOIN pr_reports ON pr_reports.fk_vintage_id = pr_video_vintage.vintage_id
INNER JOIN pr_reports_notes ON pr_reports_notes.fk_vintage_id = pr_video_vintage.vintage_id
INNER JOIN pr_blog_entries ON pr_blog_entries.fk_vintage_id = pr_video_vintage.vintage_id
ORDER BY `pr_video_vintage`.`vintage_id` ASC 
```

但这（我猜可以理解）只返回所有表中存在的 ID。

我需要的是某种形式的 'OR' JOIN，但找不到有关如何执行此操作的任何信息。

尖端？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T21:32:35.153

试试这个：

```
SELECT  distinct vintage_id FROM `pr_video_vintage`
where exists(select 1 from pr_video where pr_video.fk_vintage_id = pr_video_vintage.vintage_id)
   or exists(select 1 from pr_reports where pr_reports.fk_vintage_id = pr_video_vintage.vintage_id)
   or exists(select 1 from pr_reports_notes where pr_reports_notes.fk_vintage_id = pr_video_vintage.vintage_id)
   or exists(select 1 from pr_blog_entries where pr_blog_entries.fk_vintage_id = pr_video_vintage.vintage_id) 
```

或者

```
 SELECT  distinct vintage_id FROM `pr_video_vintage`
where pr_video_vintage.vintage_id in (select pr_video.fk_vintage_id from pr_video)
   or pr_video_vintage.vintage_id in (select pr_reports.fk_vintage_id from pr_reports)
   or pr_video_vintage.vintage_id in (select pr_reports_notes.fk_vintage_id from pr_reports_notes)
   or pr_video_vintage.vintage_id in (select pr_blog_entries.fk_vintage_id from pr_blog_entries) 
```

或者

```
SELECT  distinct vintage_id FROM `pr_video_vintage`
where pr_video_vintage.vintage_id in (
   select pr_video.fk_vintage_id from pr_video
   union
   select pr_reports.fk_vintage_id from pr_reports
   union
   select pr_reports_notes.fk_vintage_id from pr_reports_notes
   union
   select pr_blog_entries.fk_vintage_id from pr_blog_entries) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T21:32:15.780

您可以尝试使用 OUTER JOIN 或 LEFT/RIGHT JOIN。OUTER JOIN 计算所有条目的笛卡尔积，包括两个表中都不存在的条目。LEFT JOIN 在 ON 语句的左侧显示表中的所有内容，无论它是否存在于右侧，而 RIGHT JOIN 则相反。

此外，如果您想节省一些击键，INNER JOIN 与 JOIN 是一样的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:33:18.823

您可以运行`LEFT JOIN`s，它将为不存在的链接返回一个 NULL Id，并结合一个子句来排除那些*所有*链接都为 NULL 的行。

```
SELECT DISTINCT vintage_id FROM `pr_video_vintage`
LEFT JOIN pr_video
    ON pr_video.fk_vintage_id = pr_video_vintage.vintage_id
LEFT JOIN pr_reports
    ON pr_reports.fk_vintage_id = pr_video_vintage.vintage_id
LEFT JOIN pr_reports_notes
    ON pr_reports_notes.fk_vintage_id = pr_video_vintage.vintage_id
LEFT JOIN pr_blog_entries
    ON pr_blog_entries.fk_vintage_id = pr_video_vintage.vintage_id
WHERE
    pr_video.fk_vintage_id IS NOT NULL
    OR
    pr_reports.fk_vintage_id IS NOT NULL
    OR
    pr_reports_notes.fk_vintage_id IS NOT NULL
    OR
    pr_blog_entries.fk_vintage_id IS NOT NULL
ORDER BY `pr_video_vintage`.`vintage_id` ASC 
```

# ios - 将 uilabel 和 uiimageview 保存为 uiimage

> ID：12665261
> 
> 赞同：2
> 
> 时间：2012-09-30T21:26:46.570
> 
> 标签：ios, uiimage, imageview, uilabel

我正在尝试向图像添加文本，但将 a`uilabel`作为子视图添加到`uiimageview`. 我已经这样做了，但我想将它们保存为图像；我在上下文中使用渲染，但它不起作用。

这是我的代码：

```
UIImage * img = [UIImage imageNamed:@"IMG_1650.JPG"];

        float x = (img.size.width/imageView.frame.size.width) * touchPoint.x;
        float y = (img.size.height/imageView.frame.size.height) * touchPoint.y;

        CGPoint tpoint = CGPointMake(x, y);

        UIFont *font = [UIFont boldSystemFontOfSize:30];
        context = UIGraphicsGetCurrentContext();
        UIGraphicsBeginImageContextWithOptions(img.size, YES, 0.0);
        [[UIColor redColor] set];

        for (UIView * view in [imageView subviews]){
            [view removeFromSuperview];
        }
             UILabel * lbl = [[UILabel alloc]init];
        [lbl setText:txt];
        [lbl setBackgroundColor:[UIColor clearColor]];
        CGSize sz = [txt sizeWithFont:lbl.font];
        [lbl setFrame:CGRectMake(touchPoint.x, touchPoint.y, sz.width, sz.height)];
        lbl.transform = CGAffineTransformMakeRotation( -M_PI/4 );

        [imageView addSubview:lbl];
        [imageView bringSubviewToFront:lbl];
        [imageView setImage:img];
        [imageView.layer renderInContext:UIGraphicsGetCurrentContext()];
        [lbl.layer renderInContext:UIGraphicsGetCurrentContext()];

        UIImage * nImg = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
        UIImageWriteToSavedPhotosAlbum(nImg, nil, nil, nil); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T21:36:40.897

试试下面的代码。这个对我有用。

```
UIGraphicsBeginImageContext(imageView.bounds.size);
[imageView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *bitmap = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

PS我认为你不需要`renderInContext` `UILabel`分层。

# c# - 实例化异步运行的进度条并使用线程安全调用对其进行修改

> ID：12665262
> 
> 赞同：1
> 
> 时间：2012-09-30T21:26:49.270
> 
> 标签：c#, .net, winforms

在我的应用程序中，我有一个由进度条和文件名组成的队列下载列表。当用户单击按钮时，文件名和进度条被实例化并添加到队列中。文件一次异步下载一个。我想要做的是将等待下载的文件的所有进度条保持为黄色，然后在下载时变为绿色，然后在完成时变为蓝色。如果我`CheckForIllegalCrossThreadCalls = false;`在自定义进度条的构造函数中，它目前可以工作。我想看看是否有办法对进度条进行线程安全的更改。

我将每个队列项目设置为一个对象。当按下按钮并在队列项构造函数中创建进度条时，队列项对象是从主表单代码（Form1.cs）创建的，这可能是我的问题开始的地方。下载是通过队列项目对象中的函数开始的。

**队列项目片段**

```
 public class QueueItem
 {
    public bool inProgress;
    public QueueBar bar;

    public QueueItem(args)
    {
         bar = new QueueBar();
         inProgress = false;
         // handle arguments
    }

    public void Download()
    {
        // process info
        WebClient client = new WebClient();
        client.DownloadFileCompleted += new AsyncCompletedEventHandler(client_DownloadFileCompleted);
        client.DownloadProgressChanged += new DownloadProgressChangedEventHandler(client_DownloadProgressChanged);
        client.DownloadFileAsync(url, @savePath);
    }

    private long lastByte = 0;
    private long newByte = 0;
    private void client_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)
    {
        percentValue = e.ProgressPercentage;
        bar.Value = e.ProgressPercentage;
        newByte = e.BytesReceived;
    }

    private void client_DownloadFileCompleted(object sender, AsyncCompletedEventArgs e)
    {
        // change bar color
        bar.Value = 100;
    }
 } 
```

**队列栏片段**

```
public class QueueBar : ProgressBar
{
    // variables

    public QueueBar()
    {
        this.SetStyle(ControlStyles.UserPaint, true);     
        // initialize variables
    }

    // function to change text properties
    // function to change color

    protected override void OnPaint(PaintEventArgs e)
    {
        // painting
    }
} 
```

**主要功能片段**

```
public partial class Form1 : Form
{
    private List<QueueItem> qItems;
    private BackgroundWorker queue;

    private void button_Click(object sender, EventArgs e)
    {
         // basic gist of it
        qItems.Add(new QueueItem(args));
        Label tmpLabel = new Label();
        tmpLabel.Text = filename;
        tmpLabel.Dock = DockStyle.Bottm;
        splitContainerQueue.Panel2.Controls.Add(tmpLabel);
        splitContainerQueue.Panel2.Controls.Add(qItems[qItems.Count - 1].bar);

        if (!queue.IsBusy) { queue.RunWorkerAsync(); }
    }

    private void queue_DoWork(object sender, DoWorkEventArgs e)
    {
        while (qItems.Count > 0)
        {
            if (!qItems[0].inProgress && qItems[0].percentValue == 0)
            {
                qItems[0].inProgress = true;
                qItems[0].Download();
            }
            // else if statements
        }
 } 
```

我也只是尝试创建一个后台工作人员来创建队列项并异步添加控件，但这不起作用，因为拆分容器是在不同的线程上创建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:30:46.313

您不能安全地从另一个线程调用 UI 控件（在您的 UI 线程上创建） - 您需要使用[`InvokeRequired`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invokerequired.aspx)/[`BeginInvoke()`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)进行此类调用。打电话时`BeginInvoke()`你会通过一个代表；像这样的东西（只是一些示例代码，你的看起来会略有不同）：

```
private void SomeEventHandler ( object oSender, EventArgs oE )
{
    if ( InvokeRequired )
    {
        MethodInvoker oDelegate = (MethodInvoker) delegate
        {
            SomeEventHandler ( oSender, oE );
        };

        BeginInvoke ( oDelegate );
        return;
    }
    else
    {
        // already on the correct thread; access UI controls here
    }
} 
```

您也无法在 UI 线程之外创建进度条 - 您需要将所有控件创建为 UI 的一部分，然后如果您需要从队列项中访问这些进度条，则必须传入对进度条。当您尝试访问进度条时，您将执行

```
if ( bar.InvokeRequired ) { ... } 
```

确定您是否尝试从正确的线程调用它。

造成这种混乱的原因是控件通过消息处理其许多属性更新，并且这些消息必须以正确的顺序同步传递。确保这一点的唯一方法（无需一些非常复杂的编码）是在线程运行消息泵的同一线程上创建所有控件。

# escaping - Escaping characters in linux for a buffer overflow

> ID：12665268
> 
> 赞同：-1
> 
> 时间：2012-09-30T21:27:26.390
> 
> 标签：escaping, hex, ascii, buffer-overflow

So we have a lab where we need to perform a buffer overflow on a program. I already found that GCC has buffer overflow protection and I found that when you compile it, you have to disable it using the -fno-stack-protector flag. After I got past that, i disassembled the code using gdb and found that i want to redirect the program to the address 0x4005b1\.

However when i enter user input, how do i enter the hex value of b1 in ASCII?

When the program prompts for user input is there a way to escape the b1 value. something similar to: aaaaaaaaaaaaaaaaaaaaaaaaaaa@^E\xb1 . Normally when I just compiled the program the address would start close to 0x040000, but when i use the -fno-stack-protector is starts at a much later address and that is why i need to redirect the return address to 0x4005b1\. If there isn't a way to enter b1, what are some alternative ways to get around this? Could I somehow link the program to start at a particular address and if so, how is that done? Any other help or suggestions would be much appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:52:10.263

如果你用一堆 nop 开始你的程序，那么你在地址的底部字节上有一些灵活性。

输入特殊字符取决于您使用的阅读器和行缓冲区代码。例如，GNU readline 使用 Compose 键来输入特殊字符。

# android - text view not wrapping

> ID：12665269
> 
> 赞同：0
> 
> 时间：2012-09-30T21:27:29.707
> 
> 标签：android, textview

I just tried a sample of retrieving and passing it to a textview.
I am having some trouble wrapping my textview.
The bottom part is not completely shown.
What do i need to add to the xml file for it to completely show the bottom part of the data?

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="left"
    android:orientation="vertical"
    android:padding="5dp" >

<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
     >

    <TextView
        android:id="@+id/tvFA"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="36dp"
        android:layout_marginTop="36dp"
        android:text="TextView"
        android:maxLines = "1000"
        android:scrollbars = "vertical"
        android:textSize="20sp" />
</ScrollView>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:34:54.500

在 ScrollView 中，设置为 fill_parent：

```
<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
```

# localhost - 禁止本地主机 WAMP

> ID：12665276
> 
> 赞同：10
> 
> 时间：2012-09-30T21:28:35.563
> 
> 标签：localhost, wamp

我在 WAMP 上访问我的本地主机（最后是 phpmyadmin）时遇到问题。

当我进入`localhost`或`http://127.0.0.1`进入我的浏览器时，我收到以下消息：

```
Forbidden
You don't have permission to access / on this server. 
```

我看过其他几篇关于此的帖子，其中人们遇到了无法访问其本地主机的相同问题，解决方案是编辑`httpd.conf`或`phpmyadmin.conf`. 但是我已经尝试过了，但没有结果，它仍然说我没有权限。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T21:32:08.747

您可能有另一个使用端口 80 的应用程序。它通常是 Skype 或 Teamviewer。如果您拥有其中一个（或两个）应用程序，请进入其设置并关闭“使用端口 80”。如果我没记错的话，它在两个应用程序的高级设置下。

如果您没有 Skype 或 Teamviewer，请尝试查找可能正在使用端口 80 的另一个应用程序并将其禁用。

要确定这是否是问题所在，或者如果您无法禁用其他应用程序的端口 80，请尝试将 WAMP 的端口更改为其他端口，例如：8080。

-Edit-
如果您不被允许访问`/`，但*被*允许访问任何文件，请将 a添加到`.htaccess`您站点的根目录并添加`Options +Indexes`到该文件。

如果您不允许访问任何内容，请执行与上述相同的操作，但将其放入您的`.htaccess`文件中：

```
order allow,deny
allow from all 
```

# python - Python GAE 上传到 Google Docs

> ID：12665281
> 
> 赞同：3
> 
> 时间：2012-09-30T21:29:01.330
> 
> 标签：python, google-app-engine, google-drive-api, google-docs-api

我需要在 GAE 应用程序上将文件/文档上传到 Google Docs。这应该很简单，但是我在使用 API 时遇到了很多麻烦。

上下文：

```
import gdata.docs.service

client = gdata.docs.service.DocsService()
client.ClientLogin('gmail', 'pass')

ms = gdata.MediaSource(#what goes in here?)
client.Upload(media_source=ms, title='title') 
```

要上传我正在使用`client.Upload()`，它将 MediaSource （包装器）对象作为参数。但是，`MediaSource()`似乎只接受文件的文件路径：`'C:/Docs/ex.doc'`.

由于我在没有文件系统的 GAE 上，我只能通过 Blobstore 或文件的直接 URL 访问该文件。但是我该如何输入`MediaSource()`呢？

[Java](http://blog.essaytagger.com/2011/07/how-to-upload-file-to-google-docs-when.html)中似乎有一种方法可以通过使用来完成此操作`MediaByteArraySource()`，但对于 Python 则没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T01:29:30.043

如果有人好奇，这里是我使用文档列表 API 解决这个问题的方法。

我不想使用[Drive SDK](https://developers.google.com/drive/)，因为它确实使很多事情复杂化。使用 List API 进行身份验证/登录要简单得多，而不需要一些 OAuth 技巧。这里使用的是[gdata Python 库](http://code.google.com/p/gdata-python-client/downloads/list)的 2.0.14 版本，不是当前版本（2.0.17），但似乎有更简单的上传机制。

2.0.14 的在线文档也稍微多一些（仍然很少），尽管我不得不从各种来源和反复试验中拼凑起来。缺点是您无法使用此版本上传 pdf。此代码**不适**用于 2.0.17。

这是代码：

```
import gdata.docs.service
import gdata.docs.data
from google.appengine.api import urlfetch

# get file from url
result = urlfetch.fetch('http://example.com/test.docx')
headers = result.headers
data = result.content

# authenticate client object
client = gdata.docs.service.DocsService()
client.ClientLogin('gmail', 'password')

# create MediaSource file wrapper
ms = gdata.MediaSource(file_handle=result.content, 
content_type=headers['content-type'], 
content_length=int(headers['content-length']))

# upload specific folder, return URL of doc
google_doc_name = 'title'
folder_uri = '/feeds/folders/private/full/folder:j7XO8SJj...'
entry = client.Upload(ms, google_doc_name, folder_or_uri=secret.G_FOLDER_URI)
edit_url = entry.GetAlternateLink().href 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:36:48.670

Google Drive SDK 文档包含一个用 Python 编写并在 App Engine 上运行的完整示例应用程序：

[https://developers.google.com/drive/examples/python](https://developers.google.com/drive/examples/python)

您可以将其用作实施的参考，并了解如何从 App Engine 保存文件。

# c - cmp je/jg 它们在装配中的工作方式

> ID：12665289
> 
> 赞同：1
> 
> 时间：2012-09-30T21:30:10.897
> 
> 标签：c, assembly, x86, conditional-statements, cmp

我想了解 cmp 和 je/jg 如何在汇编中工作。我在谷歌上看到了几个例子，但我还是有点困惑。下面我展示了我试图转换为 C 语言的一部分汇编代码和相应的 C 代码。它是以正确的方式实施还是我对 cmp 的工作原理有错误的理解？

```
cmp    $0x3,%eax
je     A
cmp    $0x3,%eax
jg     B
cmp    $0x1,%eax
je     C

 int func(int x){

  if(x == 3)
    goto A;

  if (x >3)
    goto B;

  if(x == 1)
     goto C;

    A:
    ......

    B:
    ......

    C:
    ...... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T21:38:52.900

您正确理解 cmp 和 je/jg 的工作原理，但您的 C 代码中有错误。这一行：

```
if (*x == 1) 
```

应该

```
if (x == 1) 
```

[这](http://en.wikibooks.org/wiki/X86_Assembly/Control_Flow)是 x86 控制流指令的一个很好的总结。

此外，没有理由对相同的值重复 cmp 指令。执行后，您可以通过多种方式测试结果，而无需重复比较。所以你的汇编代码应该是这样的：

```
cmp    $0x3,%eax
je     A
jg     B
cmp    $0x1,%eax
je     C 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-30T21:47:33.863

是的，这是正确的，除了在您的 C 代码中，您`*x`在第三个示例中但`x`在其他示例中，这是没有意义的。在您的汇编代码中没有相应的代码。

在 C 中，变量类型（有符号/无符号）是在声明变量时定义的，例如。`int x`或`unsigned int x`，但在汇编中，用于比较的有符号和无符号变量（无论是在内存中还是在寄存器中）之间的区别是通过不同的条件跳转进行的：

对于有符号变量：

```
jg  ; jump if greater
jl  ; jump if less
jge ; jump if greater or equal, "jnl" is synonymous
jle ; jump if less or equal, "jng" is synonymous 
```

对于无符号变量：

```
ja  ; jump if above
jb  ; jump if below
jae ; jump if above or equal, "jnb" is synonymous
jbe ; jump if below or equal, "jna" is synonymous 
```

[Intel x86 JUMP 快速参考](http://www.unixwiz.net/techtips/x86-jumps.html)列出了`x86`汇编中所有可用的条件跳转，连同它们的条件（标志值）和它们的短跳转和长跳转操作码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T22:24:55.567

您可能已经知道，处理器在所谓的标志寄存器中跟踪上次操作期间发生的事情。例如，如果操作溢出或结果为零等，则有一个标志。 cmp 助记符告诉处理器减去两个寄存器/寄存器和内存内容，它会更改正确的标志。之后，您可以使用已完成的跳跃进行跳跃。处理器检查标志以查看它是否相等（检查零标志），或者它是否更小/更大（无符号的溢出标志和有符号数的溢出和符号标志）。

# drag-and-drop - Drag n Drop re-order ability in meteor.js ToDo app

> ID：12665291
> 
> 赞同：4
> 
> 时间：2012-09-30T21:30:15.883
> 
> 标签：drag-and-drop, meteor

Obj:-

To add drag n drop ability in the meteor ToDo example app.

Why:-

Going through the learning curve.

What i can think of :-

Using jquery UI (as external js) and bind the update event to todo lists. having a data field on the li items, so as to execute update command from the same function itself.

Was wondering if there exists a more meteor-y approach..

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T10:43:08.910

Meteor 的模板引擎（Spark）会在对底层数据进行任何更改时重新绘制您的 TODO 列表，我预计这会扰乱 JQuery UI 的正常操作。

考虑[`constant`](http://docs.meteor.com/#constant)为您的 JQuery UI 托管区域使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T16:07:21.093

从[这个](https://stackoverflow.com/questions/10109788/callback-after-the-dom-was-updated-in-meteor-js)答案和上面劳埃德的答案，这里是解决方法：

```
<template name="todos">
...code...
  {{#constant}}
  {{sort_code}}
  {{/constant}}
</template> 
```

--

```
<div class="todo-text" data-id="{{_id}}">{{text}}</div> 
```

在 todo.js 中

```
Template.todos.sort_code = function(){
Meteor.defer(function(){
$('#item-list').sortable({
  update: function(e,iq){
    $('div.todo-text',this).each(function(i){
            var id = $(this).attr('data-id');
            Todos.update(id, {$set:{order:i+1}});
  });
  },
});
$( "#item-list" ).disableSelection();
console.log('dd');

});
}; 
```

# iphone - Objective-C 自定义设置器

> ID：12665292
> 
> 赞同：0
> 
> 时间：2012-09-30T21:30:18.540
> 
> 标签：iphone, objective-c, ios, memory-management, setter

*注意：我没有使用 ARC*

我有一个具有以下属性的 UILabel：`@property (nonatomic, retain) UILabel *someLabel;`我正在尝试设置自定义设置器。下面的代码是否会导致泄漏，因为`@property`实际上`retain`也在调用？

```
- (void)setSomeLabel:(UILabel *)someLabel
{
    if (someLabel != self.someLabel) {
        [self.someLabel release];
        self.someLabel = [someLabel retain];
    }

    // some custom code here
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-30T21:42:47.130

> 注意：我没有使用 ARC

你真的，真的应该。

* * *

你的二传手是一个无限循环。调用`self.someLabel = ...`与 完全等价`[self setSomeLabel:...]`，这会导致循环。

正确的手动设置器如下所示：

```
- (void)setSomeLabel:(UILabel *)someLabel
{
  [someLabel retain];
  [_someLabel release];
  _someLabel = someLabel;

  // some custom code here
} 
```

还有其他常见的模式。一个主要问题是如果对象被重置为相同的值，是否应该运行“一些自定义代码”。如果不是，那么这种模式更有意义：

```
- (void)setSomeLabel:(UILabel *)someLabel
{
  if (someLabel != _someLabel) {
    [_someLabel release];
    _someLabel = [someLabel retain];

    // some custom code here
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-30T21:41:40.377

该代码将导致您的应用程序进入无限循环，因为使用`self.someLabel`原因调用方法`setSomeLabel:`。

您可以为您的自定义设置器尝试以下代码：

```
 @synthesize someLabel = _someLabel;
 - (void)setSomeLabel:(UILabel *)someLabel
 {
      if (someLabel != _someLabel)
      {
           [_someLabel release];
           _someLabel = [someLabel retain];
      }

      // custom code
 }

 - (void)dealloc
 { 
     [_someLabel release];
     // ... other releases
     [super dealloc];
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:38:27.860

不，这很好，因为您在这里使用自定义设置器。

@Property 等同于声明访问器方法。

仅当 setter 和/或 getter 未实现时，@Synthesize 才会基于属性声明属性生成访问器方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T21:39:59.903

我假设您没有使用ARC ...

您是正确的，您过度保留了传入的 someLabel，而且在属性上调用 release 也不是很好！

我会使用实例变量而不是属性：

```
- (void)setSomeLabel:(UILabel *)someLabel
{
    if (someLabel != _someLabel) {
        [_someLabel release];
        _someLabel = [someLabel retain];
    }

    // some custom code here
} 
```

# javascript - 重新加载的图像未添加到本地缓存

> ID：12665294
> 
> 赞同：0
> 
> 时间：2012-09-30T21:30:38.963
> 
> 标签：javascript, image, caching, reload

我的网站上有一些 Javascript，当单击图像时，它会从服务器重新加载图像。我的网页还使用 Location.Reload 进行了 60 秒的定时刷新。唯一的障碍是通过单击重新加载的图像不会覆盖存储在缓存中的图像，因此单击图像（以获取最新版本）后，定时刷新会将其替换为较旧的缓存版本。我不想每分钟从服务器重新加载整个页面，因为 25 张图像中的大多数都不会改变。如何强制我“手动”重新加载的图像进入页面的缓存版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T07:16:46.107

浏览器认为，图像是相同的，所以它不会重新加载它。你必须欺骗它从服务器加载它。

尝试使用更改的参数设置图像的 URL，以欺骗浏览器加载它。IE

```
<img src="$url-of-image?timestamp=$timestamp" alt="changing" /> 
```

例如：

```
<img src="http://www.thing.com/animal.jpg?timestamp=123456" alt="changing" /> 
```

# c++ - 一个简单的程序，对数字进行计数和求和。我怎样才能让它工作？

> ID：12665296
> 
> 赞同：-1
> 
> 时间：2012-09-30T21:30:51.100
> 
> 标签：c++, sum, sum-of-digits

所以我必须编写一个简单的程序（循环），您可以在其中输入一个 int 并输出数字计数和数字总和。由于我在编程方面很迟钝，所以我只是在网上搜索代码并尝试将其拼凑起来。我猜总和块螺丝带有n，但我不太确定。无论如何，如果有人能指出错误并告诉我如何让它发挥作用，我将不胜感激。

```
#include <iostream>
using namespace std;

int main()
{
    while(1)
    {
        int i,p,n,sum=0;  //sum block
        cout<<"enter an int: ";
        cin>>n;

        {
            while(n!=0)
            {
                p=n % 10;
                sum+=p;
                n=n/10;
            }
            cout<<"int digit sum: "<<sum <<endl;
        }
        {
            int count = 0;
            while(n)
            {
                n /= 10;
                ++count;
            }
            cout <<"number of digits: " << count << '\n';
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T21:41:23.857

由于您使用的循环是*破坏性*的（即它们`n`在循环结束时归零），您需要将两个循环合并为一个：

```
int sum=0, count=0;
while(n!=0)
{
    count++;
    sum += n%10;
    n /= 10;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:41:48.817

如果您试图获得数字的总和，请使用此代码。数字中的位数。

```
#include <iostream>
using namespace std;

int main()
{

    int i, p, n, sum=0, count = 0;  //sum block
    cout<<"enter an int: ";
    cin>>n;

    while(n!=0)
    {
        p=n % 10;
        sum+=p;
        count++;
        n=n/10;
    }

    cout<<"int digit sum: "<<sum<<endl;
    cout<<"count of digits: "<<count<<endl;
 } 
```

您的第二个 while 循环`while(n)`将永远不会执行，因为`n`直到那时的值将变为 0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:34:37.293

您需要在第一个循环之前保存 n 的副本，以便在第二个循环中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T21:51:15.000

> 我猜总和块螺丝带有n，但我不太确定

您猜对了：您在第一个嵌套循环中进行了*更改。* `n`在为零之前您不会退出该循环`n`......所以现在它为零！

作为参考，我可能会将它的结构更像这样，以避免必须保留一个明确的副本......

```
#include <iostream>
using namespace std;

int sum_of_digits(int n);
int num_of_digits(int n);

int main()
{
    while(1)
    {
        cout << "enter an int: ";
        int n;
        cin >> n;

        cout << "sum of digits: " << sum_of_digits(n) << endl;
        cout << "num of digits: " << num_of_digits(n) << endl;
    }
}

int sum_of_digits(int n)
{
    int sum = 0;
    while(n)
    {
        sum += n % 10;
        n /= 10;
    }
    return sum;
}

int num_of_digits(int n)
{
    int count = 0;
    while(n)
    {
        ++count;
        n /= 10;
    }
} 
```

# c++ - C++11 翻译阶段 8 混淆

> ID：12665302
> 
> 赞同：2
> 
> 时间：2012-09-30T21:31:36.163
> 
> 标签：c++, templates, compiler-construction, c++11

> 阶段 7：分隔标记的空白字符不再重要。每个预处理令牌都被转换为一个令牌。生成的标记在句法和语义上进行分析，并作为翻译单元进行翻译。
> 
> 阶段 8：翻译后的翻译单元和实例化单元组合如下：检查每个翻译后的翻译单元以生成所需实例化的列表。找到所需模板的定义。是否需要包含这些定义的翻译单元的源是由实现定义的。执行所有必需的实例化以生成实例化单元。[注意：这些类似于翻译的翻译单元，但不包含对未实例化模板的引用和模板定义。— 尾注] 如果任何实例化失败，则程序是非良构的。

我删除了一些注释以缩短粘贴的文本。

为什么在 C++ 的编译阶段 8 中已经翻译了翻译单元之后，还要执行模板定位和实例化？考虑到两阶段名称查找，这些步骤不应该在第 7 阶段进行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:38:43.603

我相信这部分与模板类型的预编译有关。任何模板化的类型都是“实例化单元”。如果模板化类型处于预编译状态，则需要在此阶段进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T17:50:24.443

这是[现已弃用的](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3065.html) *导出模板*功能的保留。导出模板允许将类和函数模板的定义与其声明分开（在适当的意义上）。

作为实现细节，将翻译单元翻译与模板实例化分开是有意义的，因为它可以减少实例化模板的冗余工作。然而，大多数当前编译器在翻译单元翻译时实例化所有模板，并在链接时消除重复实例化。

希望概念和模块将允许将来将类似的功能重新引入该语言。

# java - Dijkstra 算法替代方案 - 图中最短路径、公交路线

> ID：12665303
> 
> 赞同：5
> 
> 时间：2012-09-30T21:31:49.130
> 
> 标签：java, algorithm, graph-algorithm, shortest-path

我在我的应用程序中使用了稍微修改过的 Dijkstra 算法，但它很慢，我知道必须有更好的方法。我的输入数据是巴士站，彼此之间有指定的行程时间（约 400 个节点和约 800 条路径，最大结果深度 = 4（最多 4 次巴士改变或什么都没有）。

输入数据（公交路线）：

```
bus_id | location-from | location-to | travel-time | calendar_switch_for_today
XX | A | B | 12 | 1
XX | B | C | 25 | 1
YY | C | D | 5  | 1
ZZ | A | D | 15 | 0

dijkstraResolve(A,D, '2012-10-10') -> (XX,A,B,12),(XX,B,C,25),(YY,C,D,5) 
=> one bus change, 3 bus stops to final destination
* A->D cant be used as calendar switch is OFF 
```

正如您可以想象的那样，在更复杂的图表中，例如主要城市（节点）确实与不同城市有 170 个连接，Dijkstra 速度较慢（~ 超过 5 秒），因为首先一个一个地计算所有邻居，因为它不是“试图”通过其他方式到达目标目的地...

你能推荐我其他适合的算法吗？

我在看：

*   [http://xlinux.nist.gov/dads//HTML/bellmanford.html](http://xlinux.nist.gov/dads//HTML/bellmanford.html)（更快吗？）

*   [http://jboost.sourceforge.net/examples.html](http://jboost.sourceforge.net/examples.html)（我在这里看不到
    简单的例子......）

最好有（只是可选的东西）： - 选择最少数量的公共汽车更改或最少的时间 - 选择寻找替代方式的选项（如果旅行时间相似）

谢谢你的提示

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T21:50:50.920

也许是 A* 算法？见：[http ://en.wikipedia.org/wiki/A-star_algorithm](http://en.wikipedia.org/wiki/A-star_algorithm)

也许收缩层次结构？请参阅：[http](http://en.wikipedia.org/wiki/Contraction_hierarchies) ://en.wikipedia.org/wiki/Contraction_hierarchies 。

收缩层次结构由非常好的、非常快速的开源路由机 (OSRM) 实现：

[http://project-osrm.org/](http://project-osrm.org/)

通过 OpenTripPlanner：

[http://opentripplanner.com/](http://opentripplanner.com/)

A* 由多个路由系统实现。只需使用 Google 进行搜索。

OpenTripPlanner 是一个多模式路由系统，据我所知，应该与您的项目非常相似。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-30T21:51:21.507

听起来您正在寻找[A*](http://en.wikipedia.org/wiki/A*_search_algorithm)。它是 Djikstra 的变体，它使用启发式算法来加速搜索。在某些合理的假设下，A* 是最快的最优算法。只要确保始终[与端点断开联系](http://theory.stanford.edu/~amitp/GameProgramming/Heuristics.html#breaking-ties)。

还有一些 A* 的变体可以在更短的时间内提供接近最优的路径。例如，请参见[此处](https://gamedev.stackexchange.com/questions/32813/how-does-dwarf-fortress-keep-track-of-so-many-entities-without-losing-performanc/32831#32831)和[此处](http://books.nips.cc/papers/files/nips16/NIPS2003_CN03.pdf)。

* * *

[Bellman-Ford](http://en.wikipedia.org/wiki/Bellman-ford) *（如您的问题中所建议的那样）*往往比 Djikstra 或 A* 慢 - 它主要用于存在负边权重时，而这里没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:50:46.543

[A* 算法](http://wikipedia.org/wiki/A_star)很适合这个；它通过使用启发式方法获得更好的性能。

这是一个简单的教程，可以帮助您入门：[http ://www.policyalmanac.org/games/aStarTutorial.htm](http://www.policyalmanac.org/games/aStarTutorial.htm)

# php - PHP中的整数检查

> ID：12665313
> 
> 赞同：2
> 
> 时间：2012-09-30T21:32:47.303
> 
> 标签：php

我正在用 PHP 编写赔率转换器，并遇到[了](http://www.sitepoint.com/forums/showthread.php?608881-Converting-Decimal-to-Fractions)将小数赔率转换为小数赔率的代码

```
function dec2frac($dec) { 
    $decBase = --$dec; 
    $div = 1; 
    do { 
        $div++; 
        $dec = $decBase * $div; 
    } while (intval($dec) != $dec); 
    if ($dec % $div == 0) { 
        $dec = $dec / $div; 
        $div = $div / $div; 
    } 
    return $dec.'/'.$div; 
} 
```

当我测试代码时，它有时会在计算中成功，有时会尝试加载页面一段时间但没有成功，所以我认为它以某种方式卡在了循环中。我将时间限制设置为 1 秒，并在循环中出现回声，这证实了我的怀疑。我将这两个回声添加到循环中，这样我就可以看到出了什么问题。

```
echo "$dec $div<br/>";
echo var_dump(intval($dec) == $dec)." $dec is int<br/>"; 
```

失败时的示例打印输出，使用十进制 = 1.6

1.2 2
bool(false) 1.2 is int
1.8 3
bool(false) 1.8 is int
2.4 4
bool(false) 2.4 is int
3 5
bool(false) 3 is int //应该在这里中断并返回 3/5
3.6 6
bool( false) 3.6 是 int
4.2 7
bool(false) 4.2 是 int

成功时的示例打印输出，使用小数 = 1.8

1.6 2
bool(false) 1.6 是 int
2.4 3
bool(false) 2.4 是 int
3.2 4
bool(false) 3.2 是 int
4 5
bool(true) 4 是 int

为什么有时它不能识别整数？如何修复它以便在找到整数时退出循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:53:35.257

它看起来像一个浮动精度舍入误差。intval($dec) 和 $dec*似乎*相等，但实际上并非如此。差异可以忽略不计，但严格的平等失败了。

在我的 64 位系统上，该函数以 1E-15 的精度工作，以 1E-16 的精度循环。

*一般来说，要避免**严格**比较两个浮点数。**如果两个浮点数的差小于阈值*，则将它们视为“相等” 。有计算这个阈值的方法（谷歌“确定机器精度”），因为它在任何地方都不一样。

因为在我的 PHP.INI 我有默认值

```
; The number of significant digits displayed in floating point numbers.
; http://php.net/precision
precision = 14 
```

那么即使一个是 3 而另一个是 3.0000000000044，这两个数字也会显示相等，并且菱角不会被注意到。

精度 = 18，`$dec`显示不是您所期望的：

```
1.20000000000000018
1.80000000000000027
2.40000000000000036
3.00000000000000044 
```

尝试：

```
function dec2frac($dec) {
    $decBase = --$dec;
    $div = 1;
    do {
        $div++;
        $dec = $decBase * $div;
    } while (abs(intval($dec) - $dec) > 1e-15);
    if (($dec % $div) == 0) {
        $dec = $dec / $div;
        $div = $div / $div;
    }
    return $dec.'/'.$div;
} 
```

# objective-c - Core Data + iCloud，更改通知插入和删除关系中的对象但不更新关系中现有实体的属性

> ID：12665315
> 
> 赞同：1
> 
> 时间：2012-09-30T21:33:09.330
> 
> 标签：objective-c, cocoa-touch, ios5, core-data, icloud

在我的核心数据模型中，我有一个与另一种类型的实体具有一对多关系（未排序）的实体。我也在使用 iCloud 与我的应用程序同步。

现在，当我在该关系中添加或删除对象时，更改会反映在运行应用程序的另一台设备上（对象显示或消失）。

但是，当我简单地更新该关系中对象的属性时，实体不会得到更新。我仍然可以从我的 NSLog 语句中看到 NSPersistentStoreDidImportUbiquitousContentChangesNotification 被识别，但实体没有得到更新。

但是，当我关闭应用程序，然后将其从多任务栏中删除并重新启动应用程序（并且 iCloud 商店完成加载）时，我现在可以看到表格中的更改。

我对造成这种情况的原因感到非常困惑，我需要在导入更改后立即反映出来。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T10:23:23.923

您必须将托管对象上下文的陈旧间隔设置为足够低的值（我将其设置为 0.0）才能使其正常工作。否则，Core Data 会使用缓存的值。

# python - Python 2.7 - 帮助使用 API (HL7)

> ID：12665319
> 
> 赞同：1
> 
> 时间：2012-09-30T21:33:26.173
> 
> 标签：python, api, hl7

我是编程和 Python 的新手。

我有一个非常基本的 python 脚本，它连接到服务器并发送一条短信：

```
#!/usr/bin/python           
import socket               
s = socket.socket()        
host = '127.0.0.1' 
port = 4106               
s.connect((host, port))
message = 'test1' 
s.send(message)
print s.recv(1024)
s.close 
```

一切都很好，除了这条消息是 HL7 消息并且需要包装在 MLLP 中我发现这个 API 我认为可以为我做到这一点（[http://python-hl7.readthedocs.org/en/latest/api.html #mllp-网络客户端](http://python-hl7.readthedocs.org/en/latest/api.html#mllp-network-client)）

所以我将我的程序修改为以下内容，但我不断收到错误消息： NameError: name 'MLLPClient' is not defined

```
#!/usr/bin/python           
import socket   
import hl7                 
host = '127.0.0.1' 
port = 4106               
with MLLPClient(host, port) as client:
  client.send_message('test1')
print s.recv(1024)
s.close 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T21:40:33.747

你可以用不同的方式做到这一点；

如果导入顶级包

```
import hl7 
```

您应该使用其完整名称创建对象：

```
with hl7.client.MLLPClient(host, port) as client:
    client.send_message('test1') 
```

或者您可以只导入特定的类：

```
from hl7.client import MLLPClient 
```

并像您在示例中那样使用它。

有关更多信息，请参阅[模块文档](http://docs.python.org/tutorial/modules.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T21:35:17.653

也许`from hl7 import MLLPClient` ？

或者也许做

```
with hl7.MLLPClient(...) as ... 
```

# authentication - TLS-DSK Lync-SIP 握手后收到 403 禁止响应

> ID：12665321
> 
> 赞同：2
> 
> 时间：2012-09-30T21:33:37.747
> 
> 标签：authentication, sip, lync

我有一些代码向 lync 地址 (test1@lync2013.example.com) 发送邀请。我最初从服务器收到 401 Unauthorized（如预期的那样）。然后我执行 TLS-DSK 握手，如此处所述：http: [//msdn.microsoft.com/en-us/library/ff530353](http://msdn.microsoft.com/en-us/library/ff530353%28v=office.12%29.aspx) (v=office.12).aspx并完成。

但是，我现在在尝试 INVITE 时收到 403 Forbidden 响应（即发送我的第 4 个 INVITE - 前 3 个用于 TLS-DSK 握手），并且在响应中的 ms-diagnostics 标头中有：

```
ms-diagnostics: 4005;reason="Destination URI either not enabled for SIP or does not exist";source="LYNC13.test.example.com" 
```

test1 用户确实存在（我可以从另一个 Lync 客户端调用它）和一个控制面板，我将用户设置为“企业语音”电话，如果客户端设置为能够接收外部 SIP，我认为这是正确的来电。我是否缺少更多配置？

如果有帮助，我的 SIP 域是 lync2013.example.com，我的 AD 域是 test.example.com，我的 Lync 服务器 FQDN 是 LYNC13.test.example.com。

非常感谢任何能够提供帮助的人（或者在 Lync 2013 上看到同样的问题）。我正在配置我将能够检查的 Lync 2010。

再次感谢，

西蒙·托勒姆

# r - 如何使用 r 中的 heatmap.2 使集群在对角线上排列？

> ID：12665324
> 
> 赞同：10
> 
> 时间：2012-09-21T13:30:24.627
> 
> 标签：r, data-visualization, cluster-analysis, matrix

我正在尝试对蛋白质 dna 相互作用数据集进行聚类，并使用 R 包 gplots 中的 heatmap.2 绘制热图。这是我生成这些图的完整过程：在我的案例中使用一些相关性生成距离矩阵 pearson。

```
library(RColorBrewer);
library(gplots);
args <- commandArgs(TRUE);
matrix_a <- read.table(args[1], sep='\t', header=T, row.names=1);
mtscaled <- as.matrix(scale(matrix_a))
pdf("result.pdf", pointsize = 15, width = 18, height = 18)
result <- heatmap.2(mtscaled, Colv=T,Rowv=T, scale='none',symm = T, col = brewer.pal(9,"Reds"))
dev.off() 
```

通过执行以下操作，我可以使用正常的热图功能完成此操作：

```
result <- heatmap(mtscaled, Colv=T,Rowv=T, scale='none',symm = T) 
```

但是，当我对 Heatmap.2 使用相同的设置时，集群在对角线上也不会对齐。我附上了两张图片，第一张图片使用热图，第二张图片使用热图.2。我使用了 RColorBrewer 包中的红色来帮助更好地展示我正在做的事情。我通常只使用默认的热图功能，但我需要 heatmap.2 提供的颜色变化。

这是用于生成热图的数据集列表，在它被转换为距离矩阵后： [DataSet](http://pastebin.com/JQ1wgVwD)

![从热图绘制的热图](../Images/b4555dd6b4f8e7c9cd59b5a4e2455274.png)

![从 Heatmap.2 绘制的热图](../Images/d8f48485b9316f96c8f307c0582ff5b3.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T00:45:48.693

好像两个论点是相互矛盾的。`Colv=T`表示按簇对列进行排序，并`symm=T`表示将列排序与行相同。当然，由于数据是对称的，因此这两个约束都可以得到满足，但取而代之的是，`Colv=T`你会得到两个恰好不同的独立集群排序。

如果您放弃树状图的冗余副本，以下给出您想要的热图，至少：

```
result <- heatmap.2(mtscaled, Rowv=T, scale='none', dendrogram="row", symm = T, col = brewer.pal(9,"Reds")) 
```

![对称热图](../Images/57f72b779f6150017572f9062274c076.png)

# spring - 如何使用 Spring JavMail 实现投递失败通知邮件？

> ID：12665326
> 
> 赞同：1
> 
> 时间：2012-09-30T21:34:14.697
> 
> 标签：spring, email, jakarta-mail

我将 Spring JavaMail 用于我的电子邮件通信应用程序。如何实现因邮箱地址错误导致邮件投递失败的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T09:17:20.637

**可靠地**实现这一目标并非易事。RFC 821 中的 SMTP 协议规范指定了许多返回代码。值得注意的是 550 是 SMTP 服务器在尝试向不存在的地址发送电子邮件*时应*返回的值。我说*应该*是因为大多数面向公众的 SMTP 服务器不会这样做——它们要么悄悄地接受邮件然后丢弃它，或者如果他们更有礼貌，接受邮件但发回“传递失败”通知发件人（“发件人”地址）。如果发件人向不存在的地址发送足够多的电子邮件以防止垃圾邮件，MSN 和 Gmail 等公共服务也会将发件人列入黑名单。

这样做的原因是为了防止电子邮件钓鱼和垃圾邮件。

所以你可以做的是

1.  `SendFailedException`在您的代码中检查。这仅适用于遵循 SMTP 规范并实际发回错误代码的服务器。就像我说的，很少有公共服务器真正做到这一点。
2.  为您用作发件人的地址设置一个适当的邮箱，并监视该收件箱中的传递失败通知。注意认为这些不需要遵循任何常见的模式，这就是为什么这不是微不足道的。
3.  对于没有任何通知的邮件服务器，你真的无从知晓。

这是公司从专门的提供商那里购买大量电子邮件服务的原因之一，因为他们已经构建了所有这些东西来衡量跳出率等。但即使有了这些，它也永远不会 100% 准确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T18:00:39.303

这些常见问题解答条目也可能有所帮助：

*   [如果我向错误地址发送消息，为什么我没有收到表明地址错误的 SendFailedException 或 TransportEvent？](http://www.oracle.com/technetwork/java/javamail/faq/index.html#badaddr)
*   [当无法传递消息时，将返回失败消息。如何检测这些“退回”的消息？](http://www.oracle.com/technetwork/java/javamail/faq/index.html#bounce)

# bash - 使用 ssh 将变量发送到远程服务器

> ID：12665327
> 
> 赞同：1
> 
> 时间：2012-09-30T21:34:18.307
> 
> 标签：bash, ssh

我试图登录到一个文件（在远程服务器中，比如说/home/test/log.txt）存储在 $var 中的内容。我正在尝试

```
ssh test@$192.168.1.35 "echo "var" >> /home/test/log.txt" 
```

你也试过

```
 ssh test@$192.168.1.35 "echo "$var" >> log.txt" 
```

但两者都没有工作

有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T21:42:26.197

您正在使用双引号，因此变量扩展将在本地发生。您应该使用单引号，以便命令原封不动地发送。

与`echo '$var'`give `$var`while`echo "$var"`显示内容的方式相同，服务器看到`$var`的不是本地的内容`$var`。

所以：

`ssh test@$192.168.1.35 'echo $var >> /home/test/log.txt'`

将在远程计算机上创建一个文件，其中包含远程的值`$var`。

如果你这样做

`ssh test@$192.168.1.35 'echo $var' >> /home/test/log.txt`

您会在本地计算机上获得一个文件，其中包含远程的值`$var`。

如果你这样做

`ssh test@$192.168.1.35 "echo $var >> /home/test/log.txt"`

它将您本地的值存储`$var`在远程系统上的文件中。

（另外，如果它只涉及远程系统，您可能应该使用 shell 脚本，或者如果您希望它自动发生，也可以使用 cron。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T21:38:25.363

尝试：

```
ssh test@192.168.1.35 "echo '$var' >> /home/test/log.txt" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T21:37:41.997

你试过了吗：

```
ssh test@$192.168.1.35 'echo "$var" >> /home/test/log.txt' 
```

这应该有效。假设`var`是在您的计算机上而不是遥控器上设置的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-15T08:13:39.867

这是将 linux 机器上的一些文本放入另一台 linux 机器上已经存在的文件中的正确方法：

```
echo 'text' | ssh test@$192.168.1.35 'cat >> /remote_file_path' 
```

# jira - 如何将 40 个项目分配到 JIRA 中的项目类别中？

> ID：12665333
> 
> 赞同：1
> 
> 时间：2012-09-30T21:35:06.670
> 
> 标签：jira

我可以通过 Administration -> Projects -> Select a project -> Select a project category 将项目分配给项目类别。但我必须为 40 个项目多次执行此操作。

有什么方法可以减少点击次数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T07:27:29.227

有一个简单的答案：**你不能通过界面。** 可能有一些方法可以通过 REST API，但对于仅 40 个项目来说是不值得的。毕竟 40 个项目并不多，如果您在单独的选项卡中打开所有要编辑的项目，则可以最大限度地减少单击。

# ios - Facebook OG：图片

> ID：12665334
> 
> 赞同：0
> 
> 时间：2012-09-30T21:35:08.683
> 
> 标签：ios, xcode, facebook

所以我对 facebook og:image 有疑问。

网站：http: [//images.vallo-app.com/4db279b31df280b/](http://images.vallo-app.com/4db279b31df280b/)

如果人们使用此链接显示他们的图像，没问题，facebook 会加载 og:image

但它在 iPhone 应用程序中使用，因此人们制作图片并获取 bit.ly 的缩短 url，然后他们可以发布它。

因此，如果您发布它，facebook juts 不会显示图像的预览，但如果您在 facebook.com 上的 statusupdate 中发布缩短的 bit.ly 链接，它会显示。有人知道问题是什么吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-17T20:31:56.787

您必须发布图像状态更新，而不是正常的状态更新！

# java - Java ActionListener buttonPress() 限制

> ID：12665337
> 
> 赞同：2
> 
> 时间：2012-09-30T21:35:31.397
> 
> 标签：java, actionlistener

有没有办法限制这个按钮只被打动一次？我问的原因是因为某些原因，每次按下按钮都会破坏我的其余代码。因此，为了节省大量调试时间，以某种方式限制可以按下的次数会容易得多。提前致谢。

```
ActionListener pushButton = new buttonPress();
start.addActionListener(pushButton); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:26:30.933

要防止单击按钮，您可以使用[`JButton.setEnabled(false)`](http://docs.oracle.com/javase/7/docs/api/javax/swing/AbstractButton.html#setEnabled%28boolean%29). 因此，您可以将其作为`ActionListener`.

另一种方法是`ActionListener`像这样设置一个标志：

```
final ActionListener pushButton = new ActionListener()
{
    private boolean clicked;
    public void actionPerformed(final ActionEvent e)
    {
        if(clicked)
        {
            JOptionPane.showMessageDialog(null, "Action already started");
            return;
        }
        clicked = true;
        // ... rest of the action to do ...
    }
} 
```

请注意，您不应在事件处理程序中执行长时间运行的任务，请参阅[*The Java Tutorials*](http://docs.oracle.com/javase/tutorial/uiswing/events/generalrules.html#design)[中实现事件处理程序时要牢记的设计注意事项](http://docs.oracle.com/javase/tutorial/uiswing/events/generalrules.html#design)*。*

# android - 即使应用程序关闭屏幕，电池也会耗尽，这可能是位置服务在做的吗？

> ID：12665338
> 
> 赞同：1
> 
> 时间：2012-09-30T21:35:32.933
> 
> 标签：android

我运行我的应用程序，它使用 GPS 和蓝牙，然后点击返回按钮，让它离开屏幕。我通过 LogCat 验证了应用程序的 onDestroy 被调用。OnDestroy 删除位置侦听器并关闭我的应用程序的蓝牙服务。8 小时后我看手机，电池电量已消耗一半，我的应用程序负责根据手机的电池使用屏幕。如果我使用手机的设置菜单强制停止应用程序，则不会发生这种情况。所以我的问题是：除了移除监听器来阻止定位服务消耗电力之外，我还需要做更多的事情吗？这是我唯一能想到的，当应用程序应该处于休眠状态时，电池电量会耗尽到那种程度。

这是我的 onStart() ，我在其中打开与位置相关的东西和蓝牙：

```
@Override
public void onStart() {
    super.onStart();

    if(D_GEN) Log.d(TAG, "MainActivity onStart, adding location listeners");

    // If BT is not on, request that it be enabled.
    // setupBluetooth() will then be called during onActivityResult
    if (!mBluetoothAdapter.isEnabled()) {
        Intent enableIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
        startActivityForResult(enableIntent, REQUEST_ENABLE_BT);
        // Otherwise, setup the Bluetooth session
    } else {
        if (mBluetoothService == null) 
            setupBluetooth();
    }
    // Define listeners that respond to location updates
    mLocationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);
    mLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, GPS_UPDATE_INTERVAL, 0, this);    
    mLocationManager.addGpsStatusListener(this);
    mLocationManager.addNmeaListener(this);

} 
```

这是我的 onDestroy() 我删除它们的地方：

```
public void onDestroy() {
    super.onDestroy();
    if(D_GEN) Log.d(TAG, "MainActivity onDestroy, removing update listeners");
    // Remove the location updates
    if(mLocationManager != null) {
        mLocationManager.removeUpdates(this); 
        mLocationManager.removeGpsStatusListener(this);
        mLocationManager.removeNmeaListener(this);
    }
    if(D_GEN) Log.d(TAG, "MainActivity onDestroy, finished removing update listeners");
    if(D_GEN) Log.d(TAG, "MainActivity onDestroy, stopping Bluetooth");
    stopBluetooth();
    if(D_GEN) Log.d(TAG, "MainActivity onDestroy finished");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:14:15.927

您在 OnStart 上添加 GPS 侦听器和蓝牙，并在 onDestroy() 上删除它们。如果您的活动进入停止状态（因为您启动了另一个活动），然后返回到执行初始化的活动，而没有调用 onDestroy，这可能会导致多次调用侦听器和蓝牙初始化而没有先停止它们。

但是，我相信这不会导致 GPS 出现问题，因为您只在活动中定义了一次侦听器，并且我希望 GPS 侦听器添加例程来测试并避免添加两次相同的侦听器。此外，如果在您退出应用程序后 GPS 正在运行，您应该会在手机顶部状态栏中看到 GPS 图标。

你没有显示蓝牙的代码，所以你可能有问题。

也许将您的初始化代码移动到 onResume() 并将停止代码移动到 onPause() 将解决问题，否则您将需要进行测试以避免两次连续初始化而没有停止。

祝你好运。

# android - 从活动中返回一个数组

> ID：12665339
> 
> 赞同：1
> 
> 时间：2012-09-30T21:35:54.237
> 
> 标签：android, arraylist, tostring, object-to-string

我目前正在开发一个 android 项目，我希望能够 startActivityForResult 以便我可以返回一个数组。

该数组是一个`ArrayList<Spanned>`可以说它称为 myArray 的数组。

从我读过的内容来看，我无法使用设置的结果直接从活动中返回一个数组，所以我想一旦数组将所有数据添加到数组中，我就可以在其上调用 toString 函数，即`myArray.toString()`.

如果我这样做，我不知道如何将其转换回原始`ArrayList<Spanned>`.

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:43:25.207

使用[setResult(int, Intent)](http://developer.android.com/reference/android/app/Activity.html#setResult%28int,%20android.content.Intent%29)。从子活动：

```
Intent intent = new Intent();
intent.putExtra("mydata", mydata);

setResult(RESULT_OK, intent); 
```

## 序列化

如果问题与序列化有关，您可以使用[Html.toHtml 和 Html.fromHtml](http://developer.android.com/reference/android/text/Html.html)。使用 toHtml 可以将 Spanned 转换为字符串，而使用 fromHtml 可以得到 spanned。在子活动中序列化 Spanned 并额外添加：

```
Intent intent = new Intent();
ArrayList<Spanned> myData;
ArrayList<String> strings = new ArrayList<String>();
for(Spanned item : myData)
    strings.add(Html.toHtml(item));
intent.putStringArrayListExtra("mydata", strings);

setResult(RESULT_OK, intent); 
```

要取回调用者活动中的数据，请使用 onActivityResult 中传递的意图：

```
protected void onActivityResult (int requestCode, int resultCode, Intent data) {
    ArrayList<Strings> strings = data.getStringArrayListExtra("mydata");
    ArrayList<Spanned> spanned = new ArrayList<Spanned>();
    for(String s : strings)
       spanned.add(Html.fromHtml(s));
} 
```

# c# - 序列化包含自定义类的类

> ID：12665340
> 
> 赞同：2
> 
> 时间：2012-09-30T21:35:56.013
> 
> 标签：c#, xml, xml-serialization

我想将一个对象序列化为包含其他自定义类的 xml。据我了解（我一直在阅读 MSDN 和 SO），`XmlSerializer`并没有考虑到这一点。

这是让我感到困惑的一行：

> XML 序列化仅将对象的公共字段和属性值序列化为 XML 流。XML 序列化不包括类型信息。例如，如果您有一个 Book 对象存在于 Library 命名空间中，则无法保证它将被反序列化为相同类型的对象。

取自 MSDN，[这里](http://msdn.microsoft.com/en-us/library/182eeyhh%28v=vs.71%29.aspx)

例如，我想序列化一个类型的对象`Order`，但它包含一个列表`Products`，并且每个都包含一个类型的对象`Category`：

```
class Order
{
    List<Product> products;
}

class Product
{
    Category type;
}

class Category
{
    string name;
    string description;
} 
```

我希望我的`Order`对象像这样被序列化：

```
<Order>
    <Product>
        <Category Name="">
            <Description></Description>
        </Category>
    </Product>
    <Product>
        <Category Name="">
            <Description></Description>
        </Category>
    </Product>
<Order> 
```

`XmlSerializer`已经这样做了吗？如果没有，是否有另一个类可以或我必须自己定义序列化过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T07:01:05.190

一个订单可以看作是一个产品列表，一个产品是一个类别列表（因为它可以属于多个类别）。

您可以尝试使用

```
//...
using System.Xml;
using System.Xml.Serialization;
//...

[XmlRoot("Order")]
public class Order
{
    [XmlArrayItem(ElementName = "Product", Type = typeof(Product))]
    public List<Product> Products;
}

public class Product
{
    [XmlArrayItem(ElementName = "Category", Type = typeof(Category))]
    public List<Category> Categories;
}

public class Category
{
    [XmlAttribute("Name")]
    public string name;

    [XmlElement("Description")]
    public string description;
} 
```

唯一的权衡是，`<Products>`and `<Categories>`（复数）标签是可见的，因为变量是这样命名的，但是从之后解析 XML 的角度来看，这不是问题。如果您不想要的任何其他字段出现在您的 XML 中，您可以将`[XmlIgnore()]`它们放在前面。

# javascript - jquery 麻烦 - onclick 画廊

> ID：12665345
> 
> 赞同：0
> 
> 时间：2012-09-30T21:37:18.563
> 
> 标签：javascript, jquery, onclick, gallery

我正在尝试为我在[此处](http://www.addyosmani.com/resources/shinetime/)找到的网站使用图片库。我想向这个图库添加一个更多功能。我希望链接一个大图像，并在单击它时在代码中定义的新标签 URL 中打开。我在这里包含了完整的代码：

```
<script type="text/javascript">
$(document).ready(function()
{
 /*Your ShineTime Welcome Image*/
 var default_image = 'images/large/default.jpg';
 var default_caption = 'Welcome to my portfolio';
 /*Load The Default Image*/
 loadPhoto(default_image, default_caption);
 function loadPhoto($url, $caption)
 {
    /*Image pre-loader*/
    showPreloader();
    var img = new Image();
    jQuery(img).load( function()
    {
        jQuery(img).hide();
        hidePreloader();
    }).attr({ "src": $url });
    $('#largephoto').css('background-image','url("' + $url + '")');
    $('#largephoto').data('caption', $caption);
 }
 /* When a thumbnail is clicked*/
 $('.thumb_container').click(function()
 {
      var handler = $(this).find('.large_image');
      var newsrc  = handler.attr('src');
      var newcaption  = handler.attr('rel');
      loadPhoto(newsrc, newcaption);
 });
 /*When the main photo is hovered over*/
 $('#largephoto').hover(function()
 {
    var currentCaption  = ($(this).data('caption'));
    var largeCaption = $(this).find('#largecaption');
    largeCaption.stop();
    largeCaption.css('opacity','0.9');
    largeCaption.find('.captionContent').html(currentCaption);
    largeCaption.fadeIn()
     largeCaption.find('.captionShine').stop();
     largeCaption.find('.captionShine').css("background-position","-550px 0");
     largeCaption.find('.captionShine').animate({backgroundPosition: '550px 0'},700);
     Cufon.replace('.captionContent');
 },
 function()
 {
    var largeCaption = $(this).find('#largecaption');
    largeCaption.find('.captionContent').html('');
    largeCaption.fadeOut();
 });
 /* When a thumbnail is hovered over*/
 $('.thumb_container').hover(function()
 {
     $(this).find(".large_thumb").stop().animate({marginLeft:-7, marginTop:-7},200);
     $(this).find(".large_thumb_shine").stop();
     $(this).find(".large_thumb_shine").css("background-position","-99px 0");
     $(this).find(".large_thumb_shine").animate({backgroundPosition: '99px 0'},700);
 }, function()
 {
    $(this).find(".large_thumb").stop().animate({marginLeft:0, marginTop:0},200);
 });
 function showPreloader()
 {
   $('#loader').css('background-image','url("images/interface/loader.gif")');
 }
 function hidePreloader()
 {
   $('#loader').css('background-image','url("")');
 }
  });

 </script> 
```

我有 15 张这样的缩略图/照片：

```
<div class="thumbnails">
    <br><br><br>
    <!-- start entry-->
    <div class="thumbnailimage">
        <div class="thumb_container">
            <div class="large_thumb">
                <img src="images/thumbnails/sample1.jpg" class="large_thumb_image" alt="thumb">
                <img alt="" src="images/large/sample1.jpg" class="large_image" rel="Image Sample">
                <div class="large_thumb_border"> </div>
                <div class="large_thumb_shine"> </div>
            </div>
        </div>
    </div>
    <!-- end entry-->
</div> 
```

有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:57:25.380

这应该可行，您所要做的就是为每个图像添加数据大属性，并在悬停时显示一个工具提示，其中包含大图像。

[http://jsfiddle.net/DSjLk/](http://jsfiddle.net/DSjLk/)

# c# - 使用简短版本在 C# 中格式化时间/持续时间的方法

> ID：12665346
> 
> 赞同：0
> 
> 时间：2012-09-30T21:37:27.693
> 
> 标签：c#, asp.net, timespan, duration

我正在寻找一种方法来格式化最初以小时表示的持续时间（作为“双”变量），用于用 C# 编写的 ASP.NET Web 应用程序。我需要一个只有 2 个重要值的简短版本。例如：

```
1h:20m
2d:20h 
2mo:12d 
5y:2mo 
```

我搜索了一下，似乎 C# 没有我需要的内置函数。

所以我决定自己写，但我对所有部分的正确格式感到困惑。例如，我可能会得到一个字符串，例如“1d:24h”，或者简单的 2 个月，我可能会得到“1mo:29d”

PS。我遇到的问题是定义一个月和一年有多少天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:44:55.320

DateTime 以令人讨厌的任务而闻名。

由于没有迹象表明您指的是哪个月份，因此根据给定的信息，这是不可能的。根据您考虑的月份/年份，月份可以有 28、29、30 和 31 天。

如果没有说明您正在处理哪些月份，则从 1 个月到 2 个月的翻转将是您在哪一天进行过渡的随机猜测。您要么必须添加更多传入参数来解决此问题，要么向用户解释一个月被视为 x 天且仅 x 天。

要考虑的另一件事是夏令时。下午 1 点 + 24 小时可能不是第二天下午 1 点。在这种情况下您或最终用户不妨考虑这样的日子 23h=1d 或 25h=1d。

# wpf - 从单个命令源调用多个命令目标

> ID：12665351
> 
> 赞同：0
> 
> 时间：2012-09-30T21:38:06.703
> 
> 标签：wpf, mvvm, binding, command

我需要调用一个命令的多个实例

对于这个例子，我将采用 2 个控件“A”和“B”

“A”是调用者，“B”是调用者，并且有多个“B”实例

**控制：**

```
 public class A : Control 
 {
     public A()
     {}

     public ICommand OnACommand   
     {
        get { return (ICommand)GetValue(OnAProperty); }
        set { SetValue(OnACommandProperty, value); }
     }

    public static readonly DependencyProperty OnACommandProperty =
        DependencyProperty.Register("OnACommand", typeof(ICommand), typeof(A), new UIPropertyMetadata(null));

     public bool Something   
     {
        get { return (bool)GetValue(SomethingProperty); }
        set { SetValue(SomethingProperty, value); }
     }

    public static readonly DependencyProperty SomethingProperty=
        DependencyProperty.Register("Something", typeof(bool), typeof(A), new UIPropertyMetadata(false,OnSometingPropertyChanged));

    private static void  OnSometingPropertyChanged(...)
    {
        ... 
        OnACommand.Execute(this.Value);
    }                  
 }

 public class B : Control 
 {
     public B(){ }

     public ICommand OnBCommand   
     {
        get { return (ICommand)GetValue(OnBCommandProperty); }
        set { SetValue(OnBCommandProperty, value); }
     }

    public static readonly DependencyProperty OnBCommandProperty =
        DependencyProperty.Register("OnBCommand", typeof(ICommand), typeof(B), new UIPropertyMetadata(null));              
 } 
```

**绑定：**

```
 <local:B  x:Name="B1" OnBCommand="{Binding ElementName=A1 , Path=OnACommand />
   <local:B  x:Name="B2" OnBCommand="{Binding ElementName=A1 , Path=OnACommand />   
   <local:A  x:Name="A1"  /> 
```

**我需要的是在执行 OnACommand 时执行绑定到该 A 命令的所有 B 命令。**

我认为唯一可行的方法是，如果我*在 B 中实现 Command*并将*其绑定到 OneWayTosource*，但只有最后一个 Bind to A 将是 B ，它将被 Executed 。

```
 public B()
  {
       OnBCommand = new RelayCommand<int> 
                    (
                        value => { this.Value = value ....}
                    );
  }

   <local:B  x:Name="B1" 
             OnBCommand="{Binding ElementName=A1,Path=OnACommand,Mode=OneWayToSource />
   <local:B  x:Name="B2" 
             OnBCommand="{Binding ElementName=A1,Path=OnACommand,Mode=OneWayToSource />   
   <local:A  x:Name="A1"  /> 
```

如果我以任何其他方式绑定它，例如 OneWay，我需要在 A 中实现命令，而 B 甚至不知道它已被执行，除非有可能如何从 B 中的委托确认执行。

所以总结一下，我需要从一个来源执行多个目标。

另外我可能会指出我使用常规.net事件解决了这个问题，我在'A1'中声明并订阅了所有B，但由于这是用MVVM编写的WPF，我正在寻找MVVM风格的方式来做到这一点，使用命令。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T17:43:11.150

实现您想要完成的工作的一种可能方法是使用[复合命令](http://msdn.microsoft.com/en-us/library/gg405494%28PandP.40%29.aspx#sec2)。

# prolog - 序言。如何检查两个数学表达式是否相同

> ID：12665359
> 
> 赞同：3
> 
> 时间：2012-09-30T21:39:33.977
> 
> 标签：prolog, logic, predicate

我正在编写一个序言程序，它将检查两个数学表达式是否实际上相同。例如，如果我的数学表达式目标是：(a + b) + c，那么以下任何表达式都被认为是相同的：

(a+b)+c

a+(b+c)

(b+a)+c

(c+a)+b

a+(c+b)

c+(a+b)

和其他组合

当然，我不希望检查可能答案的组合，因为表达式可能比这更复杂。

目前，这是我的方法：例如，如果我想检查 a + b *c 是否与另一个表达式（如 c*b+a）相同，那么我将两个表达式递归地存储为二进制表达式，我应该创建一个诸如 ValueOf 之类的规则将为我提供第一个表达式和第二个表达式的“值”。然后我只是检查两个表达式的“值”是否相同，那么我可以说两个表达式是相同的。问题是，因为表达式的内容不是数字，而是标识符，我不能使用序言“is”关键字来获取值。

有什么建议吗？

非常感谢

```
% represent a + b * c
binExprID(binEx1).
hasLeftArg(binEx1, a).
hasRightArg(binEx1, binEx2).
hasOperator(binEx1, +).

binExprID(binEx2).
hasLeftArg(binEx2, b).
hasRightArg(binEx2, c).
hasOperator(binEx2, *).

% represent c * b + a
binExprID(binEx3).
hasLeftArg(binEx3, c).
hasRightArg(binEx3, b).
hasOperator(binEx3, *).

binExprID(binEx4).
hasLeftArg(binEx4, binEx3).
hasRightArg(binEx4, a).
hasOperator(binEx4, +).

goal:- valueOf(binEx1, V),
       valueOf(binEx4, V). 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T00:02:07.120

数学表达式可能非常复杂，我想您指的是算术。正常形式（我希望我的措辞是恰当的）是“单项式之和”。

无论如何，一般来说，这不是一件容易解决的任务，而且您的请求存在歧义：2 个表达式在语法上可能不同（即它们的语法树不同）但仍然具有相同的值。显然，这是由于保持值不变的操作，例如加/减 0。

根据您的描述，我推测您对“评估”身份感兴趣。然后你可以在比较相等之前对这两个表达式进行规范化。

为了评估句法同一性，我会删除所有括号，将因素“分配”到加数上。该表达式成为乘法项的列表。本质上，我们得到一个列表列表，可以在不更改“值”的情况下对其进行排序。

表达式被展平后，所有乘法常数都必须累加。

一个简化的例子：

`a+(b+c)*5`会 会`[[1,a],[b,5],[c,5]]`会`a+5*(c+b)`会`[[1,a],[5,c],[5,b]]`

**经过一些改进后进行**编辑，这是一个***非常*重要的规范化过程：**

 **```
:- [library(apply)].

arith_equivalence(E1, E2) :-
    normalize(E1, N),
    normalize(E2, N).

normalize(E, N) :-
    distribute(E, D),
    sortex(D, N).

distribute(A, [[1, A]]) :- atom(A).
distribute(N, [[1, N]]) :- number(N).
distribute(X * Y, L) :-
    distribute(X, Xn),
    distribute(Y, Yn),
    % distribute over factors
    findall(Mono, (member(Xm, Xn), member(Ym, Yn), append(Xm, Ym, Mono)), L).
distribute(X + Y, L) :-
    distribute(X, Xn),
    distribute(Y, Yn),
    append(Xn, Yn, L).

sortex(L, R) :-
    maplist(msort, L, T),
    maplist(accum, T, A),
    sumeqfac(A, Z),
    exclude(zero, Z, S),
    msort(S, R).

accum(T2, [Total|Symbols]) :-
    include(number, T2, Numbers),
    foldl(mul, Numbers, 1, Total),
    exclude(number, T2, Symbols).

sumeqfac([[N|F]|Fs], S) :-
    select([M|F], Fs, Rs),
    X is N+M,
    !, sumeqfac([[X|F]|Rs], S).
sumeqfac([F|Fs], [F|Rs]) :-
    sumeqfac(Fs, Rs).
sumeqfac([], []).

zero([0|_]).
mul(X, Y, Z) :- Z is X * Y. 
```

一些测试：

```
?- arith_equivalence(a+(b+c), (a+c)+b).
true .

?- arith_equivalence(a+b*c+0*77, c*b+a*1).
true .

?- arith_equivalence(a+a+a, a*3).
true . 
```

我使用了一些内置的 SWI-Prolog，如 include/3、exclude/3、foldl/5 和[msort](http://www.swi-prolog.org/pldoc/doc_for?object=msort/2) /2 以避免丢失重复项。

这些是基本的[列表操作](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.2%27,swi%28%27/doc/Manual/apply.html%27%29%29)内置函数，如果您的系统没有它们，很容易实现。

**编辑**

foldl/4 在 SWI-Prolog apply.pl 中定义：

```
:- meta_predicate
    foldl(3, +, +, -).

foldl(Goal, List, V0, V) :-
    foldl_(List, Goal, V0, V).

foldl_([], _, V, V).
foldl_([H|T], Goal, V0, V) :-
    call(Goal, H, V0, V1),
    foldl_(T, Goal, V1, V). 
```

**处理部**

除法引入了一些复杂性，但这应该是可以预料的。毕竟，它引入了一整*类*数字：有理数。

这是修改后的谓词，但我认为代码需要更多的调试。所以我还提出了这个微重写系统可以解决的“单元测试”。另请注意，我没有自己引入否定。我希望你能做出任何需要的修改。

```
/*  File:    arith_equivalence.pl
    Author:  Carlo,,,
    Created: Oct  3 2012
    Purpose: answer to http://stackoverflow.com/q/12665359/874024
             How to check if two math expressions are the same?
         I warned that generalizing could be a though task :) See the edit.
*/

:- module(arith_equivalence,
      [arith_equivalence/2,
       normalize/2,
       distribute/2,
       sortex/2
      ]).

:- [library(apply)].

arith_equivalence(E1, E2) :-
    normalize(E1, N),
    normalize(E2, N), !.

normalize(E, N) :-
    distribute(E, D),
    sortex(D, N).

distribute(A, [[1, A]]) :- atom(A).
distribute(N, [[N]]) :- number(N).
distribute(X * Y, L) :-
    distribute(X, Xn),
    distribute(Y, Yn),
    % distribute over factors
    findall(Mono, (member(Xm, Xn), member(Ym, Yn), append(Xm, Ym, Mono)), L).
distribute(X / Y, L) :-
    normalize(X, Xn),
    normalize(Y, Yn),
    divide(Xn, Yn, L).
distribute(X + Y, L) :-
    distribute(X, Xn),
    distribute(Y, Yn),
    append(Xn, Yn, L).

sortex(L, R) :-
    maplist(dsort, L, T),
    maplist(accum, T, A),
    sumeqfac(A, Z),
    exclude(zero, Z, S),
    msort(S, R).

dsort(L, S) :- is_list(L) -> msort(L, S) ; L = S.

divide([], _, []).
divide([N|Nr], D, [R|Rs]) :-
    (   N = [Nn|Ns],
        D = [[Dn|Ds]]
    ->  Q is Nn/Dn,  % denominator is monomial
        remove_common(Ns, Ds, Ar, Br),
        (   Br = []
        ->  R = [Q|Ar]
        ;   R =  [Q|Ar]/[1|Br]
        )
    ;   R = [N/D]    % no simplification available
    ),
    divide(Nr, D, Rs).

remove_common(As, [], As, []) :- !.
remove_common([], Bs, [], Bs).
remove_common([A|As], Bs, Ar, Br) :-
    select(A, Bs, Bt),
    !, remove_common(As, Bt, Ar, Br).
remove_common([A|As], Bs, [A|Ar], Br) :-
    remove_common(As, Bs, Ar, Br).

accum(T, [Total|Symbols]) :-
    partition(number, T, Numbers, Symbols),
    foldl(mul, Numbers, 1, Total), !.
accum(T, T).

sumeqfac([[N|F]|Fs], S) :-
    select([M|F], Fs, Rs),
    X is N+M,
    !, sumeqfac([[X|F]|Rs], S).
sumeqfac([F|Fs], [F|Rs]) :-
    sumeqfac(Fs, Rs).
sumeqfac([], []).

zero([0|_]).
mul(X, Y, Z) :- Z is X * Y.

:- begin_tests(arith_equivalence).

test(1) :-
    arith_equivalence(a+(b+c), (a+c)+b).

test(2) :-
    arith_equivalence(a+b*c+0*77, c*b+a*1).

test(3) :-
    arith_equivalence(a+a+a, a*3).

test(4) :-
    arith_equivalence((1+1)/x, 2/x).

test(5) :-
    arith_equivalence(1/x+1, (1+x)/x).

test(6) :-
    arith_equivalence((x+a)/(x*x), 1/x + a/(x*x)).

:- end_tests(arith_equivalence). 
```

运行单元测试：

```
?- run_tests(arith_equivalence).
% PL-Unit: arith_equivalence ...... done
% All 6 tests passed
true. 
```**

# objective-c - 在 iPad 设备上而不是在模拟器上测试时得到“没有这样的文件或目录”

> ID：12665360
> 
> 赞同：5
> 
> 时间：2012-09-30T21:39:46.597
> 
> 标签：objective-c, xcode4.5

我有一个应用程序作为 iPhone 和 iPad 发布，即使它是作为 Universal 开发的。原因是我发布了一个通用的英文版本，只想更新 iPhone 和 iPad 瑞典语版本，因为它已经为不同设备提供了单独的应用程序。

当我在 iPhone 设备上运行时，我没有任何问题，但是在使用 iPad 进行测试时，我收到以下消息，我不知道如何删除：

> “无法启动“FamilyQuiz_3”
> 
> > 没有这样的文件或目录（/Users/peterk/Library/Developer/Xcode/DerivedData/MyApp_3-fosmfwberzyfryenqrjlfpacftjv/Build/Products/Debug-iphoneos/MyApp_3.app/MyApp_3）

我可以从 iPad 设备启动应用程序，但从 XCODE 提交时它不会自动启动。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-30T21:53:08.893

1）确保您的**iOS 部署目标**版本与构建设置中设备上的版本相同或更低。

2）从设备中删除它

3)关闭xcode

4）转到您计算机上的 /Users/peterk/Library/Developer/Xcode/DerivedData/ 并删除 MyApp_3-fosmfwberzyfryenqrjlfpacftjv 文件夹

如果这仍然不起作用，请尝试删除重新启动手机的应用程序，然后甚至重新启动计算机，然后再做一次。

# c - 如何计算文件中字符的出现次数？

> ID：12665363
> 
> 赞同：1
> 
> 时间：2012-09-30T21:39:56.260
> 
> 标签：c, file

该函数是这样调用的，

```
printf("%d occurrences of %c in %s\n",
        countoccurrences(argv[1], argv[1][0]),
            argv[1][0], argv[1]); 
```

到目前为止，这是我的功能：

```
 /* countcharinfile
     * input: char *filename, char c
     * output: the number of occurrences of char c inside file filename
     */
int countoccurrences(char *filename, char c)
{
        // count the number of occurrences of c in the file named filename      
  FILE *fp = fopen(filename,"r");
  int ch,count=0;
  while ((ch = fgetc(fp) != EOF))
    {

      if (ch == c)
        count++;
    }

        return count;
} 
```

当我运行程序时，`./main Today is a beutiful day`

我得到错误`Segmentation fault (core dumped)`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T21:47:16.690

看起来您`countoccurrences`在`main`定义之前正在使用您的函数。

在之前添加函数签名`main`：

```
int countoccurrences(char *, char); 
```

或者将函数本身移动到代码中`main`函数之前的位置。

还：

*   您需要`count`在 中将变量初始化为零`countoccurences`，并且
*   `fp != NULL`你应该在使用文件指针之前检查一下。`fopen`如果无法打开文件，将返回 NULL。

> 当我运行程序时，./main 今天是美好的一天

当您以这种方式运行程序时，您将传递 5 个参数，一个用于句子中的每个单词。检查你的函数和你的函数调用`main`：函数需要一个*文件名*来搜索，它应该是你程序的第一个参数，而不是要搜索的文本。第二个参数应该是要搜索的字符。

由于您没有检查 的返回值`fopen`，因此您在此处的调用将导致问题，因为您的工作目录中可能*没有*名为*Today的文件。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T21:45:33.250

该错误表明函数声明或定义在调用时不可见。移动定义或在`main()`.

其他要点：

*   检查返回值`fopen()`
*   初始化`count`
*   `buf`是未使用的局部变量

例如：

```
FILE *fp = fopen(filename,"r");
if (fp)
{
    int ch,count=0;
    while ((ch = fgetc(fp)) != EOF)
    {
        if (ch == c) count++;
    }
    fclose(fp);
}
else
{
    fprintf(stderr,
            "Failed to open %s: %s\n",
            filename,
            strerror(errno));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T21:46:35.360

C 需要在调用之前了解您的函数签名。任何一个：

1.  在调用之前移动你的函数，或者
2.  在调用之前放置一个声明（当然是在全局范围内）

    `int countoccurrences(char *filename, char c);`

您还需要初始化计数（大概为 0）。您应该确保使用正确的值调用它。如果你想使用第二个参数的第一个字符，你应该使用`argv[2][0]`.

# html - 在 HTML 视口中居中图像（无 JavaScript）

> ID：12665368
> 
> 赞同：13
> 
> 时间：2012-09-30T21:40:38.987
> 
> 标签：html, css, image, viewport

我有一张我想在浏览器中显示的图像：

1.  如果图像小于浏览器视口，则图像水平和垂直居中。
2.  如果图像大于视口，则在不调整图像纵横比的情况下，缩小图像以尽可能多地填充视口。同样，图像水平和垂直居中。

我**不想使用 JavaScript**；什么是最好/最语义化的 HTML 和 CSS 来做到这一点？

**更新**有人要求我澄清语义：图像是内容；HTML 中的唯一内容。

## 解决方案

@GionaF 的想法让我得到了一个快乐（而且*非常*简单）的解决方案：

## HTML

```
<!DOCTYPE html>
<head>
  <title></title>
  <LINK href="test2.css" rel="stylesheet" type="text/css">
</head>
<body>
    <div>
      <img src="photo.jpg" alt="photo" />
    </div>
</body> 
```

## CSS

```
img {
    max-width:100%;
    max-height:100%;
    position:absolute;
    top:0; left:0; right:0; bottom:0;
    margin:auto;
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-01T00:50:23.923

您***可以***通过多种方式实现它，但我不能在不知道上下文的情况下成为“语义”（图像是页面的主要/唯一内容吗？它在博客文章的中间吗？），所以我会去`div`。

* * *

## 1\. `position:absolute;`+`margin:auto;`

**支持**：跨浏览器

HTML

```
<html>
<body>
    <div id="container">
        <img src="your-image.jpg">
    </div>
</body>
</html>​ 
```

CSS

```
html,body,#container {
    height:100%;
}
#container {
    width:100%;
    position:relative;
}
#container > img {
    width:100%;
    max-width:400px; /* real image width */
    position:absolute;
    top:0; left:0; right:0; bottom:0;
    margin:auto;
} 
```

[**演示**](http://jsfiddle.net/gionaf/4kTDU/)

* * *

## 2\. `display:table;`+ `display:table-cell;`+`vertical-align:middle;`

**支持**: IE8+, 所有其他浏览器 - 带有 IE7 后备 ( [Source 1](http://www.quirksmode.org/css/display.html#table) ) ( [2](http://caniuse.com/css-table) ) ( [3](http://www.brunildo.org/test/img_center.html) )

HTML

```
<html>
<body>
    <div id="container">
        <span> /* it's important that you use a span here
                  not a div, or the IE7 fallback won't work */
            <img src="your-image.jpg">
        </span>
    </div>
</body>
</html>​ 
```

CSS

```
html,body,#container {
    height:100%;
}
#container {
    width:100%;
    display:table;
    *display:block; /* IE7 */
}
#container > span {
    display:table-cell;
    *display:inline-block; /* IE7 */
    vertical-align:middle;
    text-align:center;
}
#container > span > img {
    width:100%;
    max-width:400px; /* real image width */
} 
```

[**演示**](http://jsfiddle.net/gionaf/9GFXW/)

* * *

## 3.`background-size:contain;`

**支持**：IE9+，所有其他浏览器 - 带有供应商前缀（[来源 1](http://www.quirksmode.org/css/background.html#t012)）（[2](http://www.css3.info/preview/background-size/)）

HTML

```
<html>
<body>
    <div id="container"></div>
</body>
</html>​ 
```

CSS

```
html,body,#container {
    height:100%;
}
#container {
    margin:0 auto;
    max-width:400px; /* real image width */
    background:url(your-image.jpg) 50% 50% no-repeat;
    background-size:contain;
} 
```

[**演示**](http://jsfiddle.net/gionaf/Yb5Lb/)

* * *

注意 IE8 的渲染方式`height:auto;`，可能不会保持比例。

* * *

编辑：我刚刚意识到你写的是“***没有***调整图像的纵横比”。如果你真的不想保持这个比例，那就更容易了……但你真的是那个意思吗？ 

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T21:58:28.443

除非您为容纳图像的容器设置了高度，否则您将无法完成此操作。为了让视口知道图像在哪里居中，它需要知道您正在使用的整个高度，而不是保持与图像相同的大小。只有在被告知或有实际内容填满时，高度才会扩大。

要水平居中，您需要在图像周围设置一个容器，并将其边距设置为“0，自动”。将容器内的图像宽度设置为 100%（这将保持比例正确，因为高度将随之适当缩放），并为容器提供基于百分比的宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:18:14.253

您需要为您的图像或环绕 div 设置一个宽度和高度作为边距：自动以使图像居中。看看下面的代码如何为您工作。

## CSS

```
#container {
width: 1000px;
height: 1000px;
}

#img {
    background-color:#000;
width: 100px;
height: 100px;
margin: 0 auto;
}​ 
```

## HTML

```
<div id="container">

<div id="img">

</div> 
```

## 编辑

将图像设置为背景？然后将主体设置为 100%。

```
body
{
    background-image: url('background.jpg');
    background-repeat: no-repeat; /* you know... don't repeat... */
    background-position: center center; /*center the background */
    background-attachment: fixed; /*don't scroll with content */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T23:48:14.793

我无法找到一个完美的解决方案（从我读过的内容来看，仅使用 CSS 和 HTML 是不可能做你想做的事的）。但我找到了更接近您需要的解决方案。我再说一遍，它并不完美。所以就这样（你实际上把你的图像作为 a 的背景`div`）：

```
#mydiv {
    width: 100%;
    height: 100%;
    position: relative;
    background-image: url(photo.jpg);
    background-position: center;
    background-repeat: no-repeat;
    background-size: auto 98%, cover;
} 
```

所以，这里的关键是`background-size`属性。它在这里做什么：强制图像缩放（向上或向下）到 div/容器的宽度/高度的指定百分比（div 的宽度和高度由视口决定）。对于大于视口的图像，此解决方案很好，但问题在于较小的图像（按比例放大）。不幸的是，当前的 CSS实现不允许`max-height`为. 如果您想了解更多关于此主题的信息，请打开此网页：[http](http://www.css3.info/preview/background-size/) ://www.css3.info/preview/background-size/ 。`max-width``background-image`

无论如何，JavaScript 解决方案更好。希望能帮助到你。

# spring - Spring security 适用于 access="ROLE_USER" 但不适用于 EL

> ID：12665370
> 
> 赞同：0
> 
> 时间：2012-09-30T21:40:45.287
> 
> 标签：spring, spring-security

我正在学习使用 Spring Security，并将其集成到 Web 应用程序中。我正在使用 Spring 和 Spring Security 3.1.2 版。

如果我`access="ROLE_USER"`在安全配置中指定，身份验证正常工作，即我首先收到 401，登录后，我可以访问资源。

```
<http>
    <http-basic />
    <logout />
    <intercept-url
        pattern="/exports/**"
        access="ROLE_USER" />
</http> 
```

但是，如果我切换到 EL，我的检查将不再起作用：

```
<http use-expressions="true">
    <http-basic />
    <logout />
    <intercept-url
        pattern="/exports/**"
        access="hasRole('USER')" />
</http> 
```

我以为这两个配置是等价的，但是第二个没有授权查看资源（403错误）。

查看日志：

```
DEBUG org.springframework.security.web.access.intercept.FilterSecurityInterceptor - Previously Authenticated: org.springframework.security.authentication.UsernamePasswordAuthenticationToken@844f42c6: Principal: org.springframework.security.core.userdetails.User@c052d588: Username: test; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ROLE_USER; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@957e: RemoteIpAddress: 127.0.0.1; SessionId: null; Granted Authorities: ROLE_USER

DEBUG org.springframework.security.access.vote.AffirmativeBased - Voter: org.springframework.security.web.access.expression.WebExpressionVoter@1a15597, returned: -1

DEBUG org.springframework.security.web.access.ExceptionTranslationFilter - Access is denied (user is not anonymous); delegating to AccessDeniedHandler 
```

如果我理解正确，WebExpressionVoter 投票反对我，尽管身份验证有效。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:14:57.980

解决方案很简单：只需添加`ROLE_`in `hasRole()`，例如：

```
access="hasRole('ROLE_USER')" 
```

我被[手册](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/el-access.html)第 16.2 节中的一个例子误导了。

# sorting - 插入排序是否总是在排序列表上进行 N-1 个比较？

> ID：12665371
> 
> 赞同：1
> 
> 时间：2012-09-30T21:40:50.113
> 
> 标签：sorting, insertion-sort

我刚刚完成了旧的“排序侦探”作业（给你一些黑盒排序算法，并且必须根据结果确定每个是什么例子），我注意到插入排序总是在排序后进行 N-1 比较列表。由于在每个人都上交作业之前我将无法查看老师的代码，也不允许我在课堂上提问可能会提示其他学生如何继续解决问题的问题，这让我离开了有一个问题，我至少一周都无法得到这个问题的答案。

在现实世界中，插入排序的教科书示例是否总是会在排序列表上进行 N-1 比较，还是我的教师/教科书版本的插入排序的怪癖？

在搜索了谷歌和维基百科之后，我找不到这个问题的答案，这意味着要么我问错了问题，要么他们没有。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:56:06.417

是的，如果输入已经排序，“教科书”插入排序将执行 N-1 次比较。例如，参见 Knuth 的*计算机编程艺术*，第 3 卷，第 5.2.1 节，算法 S（*直接插入排序*）。对于每个记录 R [i] (i > 1)，该算法将其与元素 R [i-1]进行比较，以该顺序向下到 R [1]，直到找到小于 R [i]的元素。如果输入已经排序，则 R [i-1]始终小于 R [i]，因此该算法仅对每条记录执行一次比较（并且不对记录 1 进行比较）。

当然，您可以编写插入排序来按从 R [1]到 R [i-1]的顺序执行比较，但如果输入列表已经排序，则将执行 N*(N-1)/2 比较。所以不要那样做。:)

您还可以使用二进制搜索来查找插入每条记录的位置。这称为*二元插入*，Knuth 也在 §5.2.1 中讨论了它。同样，它将对已经排序的输入执行比教科书直接插入更多的比较（但对随机输入执行的比较更少）。

# html - 如何使用 Graphviz HTML 表格摆脱边框间距？

> ID：12665374
> 
> 赞同：4
> 
> 时间：2012-09-30T21:41:10.703
> 
> 标签：html, graphviz, html-table, dot

```
<table border="0" cellborder="1" cellpadding="5">
    <tr>
        <td colspan="2" align="left">d</td>
    </tr>
    <tr>
        <td align="left" width="50">ct</td>
        <td align="left">1</td>
    </tr>
    <tr>
        <td align="left">wt</td>
        <td align="left">0</td>
    </tr>
</table> 
```

Graphviz 输出：

![在此处输入图像描述](../Images/28c6b79c22a0c93d594e2a7b43b3b8a5.png)

预期输出：

![在此处输入图像描述](../Images/8d7b6f677ec521398804a846bf87b842.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T21:46:25.693

尝试添加`cellspacing="0"`到您的`table`标签

* * *

也看看这个：[http ://www.graphviz.org/doc/info/shapes.html#html](http://www.graphviz.org/doc/info/shapes.html#html)

# python - 从 json 中获取值

> ID：12665378
> 
> 赞同：0
> 
> 时间：2012-09-30T21:41:33.903
> 
> 标签：python, facebook, json

我在访问 json 中的值时遇到问题：

```
{
"data": [
  {
     "id": "",
     "from": {
        "name": "",
        "id": ""
     },
     "picture": "",
     "source": "",
     "height": 480,
     "width": 720,
     "images": [
        {
           "height": 1365,
           "width": 2048,
           "source": ""
        }, 
```

我想获取所有图像源：`albums['data']['images']`但是出了点问题，我遇到了嵌套字典的问题。请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:44:29.623

```
"data": [
  { 
```

该`"data"`字段的值不是字典，而是字典*列表*。

改为尝试`albums['data'][0]['images']`，等等列表中的其他项目，或者类似地，一个循环：

```
for item in album['data']:
    # do something with item['images'] 
```

# javascript - 什么可以阻止 CSS :hover 类工作？

> ID：12665389
> 
> 赞同：0
> 
> 时间：2012-09-30T21:43:32.643
> 
> 标签：javascript, css

什么可以防止 CSS`:hover`伪类被触发，无论是使用 CSS 还是 JavaScript？

我正在尝试在第三方的自定义日历控件中调试一个非常棘手的问题。客户希望在用户将鼠标悬停在日期上时突出显示日期——这是非常标准的东西。但是有些东西顽固地阻止了`:hover`班级按预期工作。

我可以使用选择器定位日期单元格并`background-color`毫无问题地操作。但是，将`:hover`伪类添加到该选择器不起作用。

不幸的是，我无法发布任何代码，因为这是一个需要帐户才能使用的私人应用程序。老实说，意大利面太多了，我什至不知道要包括什么……控件是用纯 JS 构建的，这里没有 jQuery，没有siree。几百行 JS，加上几百行 CSS……不知道使用 jQuery 日历控件有什么问题。

是否有一组已知的可以破坏的东西`:hover`？可能是事件传播问题，由事件处理程序返回或其他原因引起`false`的`onhover`吗？

调试此问题的任何其他建议？使用浏览器工具不是很有效，因为`:hover`除非我*悬停*，否则不会触发规则。抓到 22 那里。

编辑：[这个答案](https://stackoverflow.com/a/12361291/532797)似乎是一个可能的罪魁祸首。他们肯定在组合中使用了一些绝对定位......

编辑 2：使用 Chrome 的开发人员工具手动应用`:hover`状态有效，确认我的选择器不是问题。有些东西阻止了`:hover`状态被触发。日历控件被实现为一个 HTML 表格，每周在一行中，每个日期在一个单元格中。这看起来确实是一个分层问题，但是向`z-index`单元格添加高电平并没有任何作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T21:53:19.460

Chrome 的“开发者工具”允许您切换元素的状态。也许您可以尝试一下，看看您是否能更深入地了解您遇到的问题？

![Chrome 开发者工具 - 样式 - 切换元素状态](../Images/2994aa1036e6bf8e0ae98b01131bd2eb.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T23:10:25.267

它往往与元素的分层有关。通常，这可以通过重新分层 HTML 以使锚点位于顶部或将其设置为`position: relative`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:09:31.160

你可能有`!important`unhover 会阻止悬停。

# mysql - 从应用程序中的 mysql 提取数据仅在浏览器中打开

> ID：12665391
> 
> 赞同：0
> 
> 时间：2012-09-30T21:43:37.853
> 
> 标签：mysql, webrick

当我在 Firefox 中打开一个使用 mysql 的主干应用程序时，这是索引的 url。

```
file:///Users/mm/Sites/ccoenraets/web/index.html# 
```

在应用程序本身中，这是应该从中检索数据的 url

```
 urlRoot:"../api/employees", 
```

当我在 Firefox 中使用该应用程序时，它不会从数据库中提取数据。您知道我应该如何更改该 urlRoot 以使其从数据库中获取数据。我尝试了明显但没有成功

```
 urlRoot:"Users/mm/Sites/ccoenraets/web/index/api/employees", 
```

# ruby-on-rails - 嵌套路由中的附加参数

> ID：12665392
> 
> 赞同：2
> 
> 时间：2012-09-30T21:43:39.220
> 
> 标签：ruby-on-rails, ruby, routes

我有嵌套资源：

```
resources :posts do
  resources :comments
end 
```

我目前`link_to`是这样的：

```
<%= link_to 'Reply', [:new, @post, :comment] %> 
```

导致：

```
http://example.com/posts/8/comments/new 
```

但我需要这样的链接：

```
http://example.com/posts/8/comments/new?parent_id=7 
```

我如何使用`link_to`来创建该链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T09:06:30.687

我能够通过一个匹配语句得到它：

```
match "(/bazess/:baz_id)(/foos/:foo_id)/bars(/page/:page)(/:format)" => "bars#index", :as => :bars 
```

您还可以参考[The Rails 3 Way 中有关嵌套资源的这篇文章](http://www.informit.com/articles/article.aspx?p=1671632&seqNum=7)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T16:24:22.797

在我发表评论后作为答案发布：

```
new_post_comment_path(@post, :parent_id => 7) 
```

# domain-driven-design - 如何在 DDD 中使用巨大的域类？

> ID：12665393
> 
> 赞同：3
> 
> 时间：2012-09-30T21:43:40.907
> 
> 标签：domain-driven-design

当您以 OO/DDD 风格开发架构并对某些域实体（例如订单实体）进行建模时，您会将与订单相关的整个逻辑放入订单实体中。但是当应用程序变得越来越复杂时，Order 实体收集的逻辑越来越多，这个类变得非常庞大。与贫血模型相比，是的，它显然是一种反模式，但是所有这些庞大的逻辑都在不同的服务中分离。

可以处理巨大的域实体还是我理解错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T16:27:43.577

当您尝试创建丰富的领域模型时，请将实体集中在身份和生命周期上，从而尽量避免它们因属性或行为而变得臃肿。

域服务可能是放置行为的地方，但我倾向于看到许多域服务方法的行为可以更好地分配给值对象，因此我不会通过将行为移动到域服务来开始重构。领域服务往往作为直接的外观/适配器在与当前领域模型之外的事物的连接之前工作得最好（即掩盖基础设施问题）。

您也可以将行为放在应用程序服务中，但要问自己该行为是否属于域模型之外。作为一般规则，尝试将应用程序服务更多地集中在跨实体、域服务、存储库的编排式任务上。

当你遇到一个臃肿的实体时，首先要做的是寻找一组有凝聚力的实体属性和相关行为的集合，并通过将这些隐含的概念提取到值对象中来使它们变得明确。然后实体可以将其行为委托给这些值对象。

由于我们都倾向于对实体更满意，因此请尝试更偏向于值对象，以便您获得值对象提供的不变性、封装性和可组合性的好处——使您走向更灵活的设计。

值对象使您能够将更具功能性的样式（例如，无副作用的函数）合并到您的域模型中，从而使您的实体免于处理将复杂行为添加到管理身份和生命周期的负担中的复杂性。[有关更多详细信息，请参阅 Eric Evan 的http://domainlanguage.com/ddd/patterns/](http://domainlanguage.com/ddd/patterns/)和蓝皮书中实体和值对象的模式摘要。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-15T17:10:36.843

> 当您以 OO/DDD 风格开发架构并对某些域实体（例如订单实体）进行建模时，您会将与订单相关的整个逻辑放入订单实体中。但是当应用程序变得越来越复杂时，Order 实体收集的逻辑越来越多，这个类变得非常庞大。

有变大趋势的类，往往是*职责重叠*的类。**Order**是一个典型的类示例，它可以具有多种职责，并且可以在您的应用程序中扮演不同的角色。

鉴于**订单出现的***上下文*，它可能是一个具有可变状态的*实体*（即，如果您正在管理订单的商业条件，则在*协商阶段*）但如果您的应用程序正在管理物流，则**订单**可能会扮演不同的角色：不可*变的值对象*可能是逻辑上下文中的最佳实现。

 *******> 与贫血模型相比，是的，它显然是一种反模式，但是所有这些庞大的逻辑都在不同的服务中分离。

……*分离是件好事*。:-)

我有一种感觉，原始模型可能是以数据为中心的，并且服务于不同目的（订单创建、支付、订单履行、订单交付）的数据堆积在同一个容器（订单类）中。不能从这里说出来，但这是一种非常常见的模式。并非所有这些数据都能同时用于相同目的。

通常，像您所描述的那样臃肿的类是*Bounded Contexts*之间缺少分离的气味，和/或同一有界上下文中不完整的*Aggregate分离。*我会看看：

*   一起改变的事物；
*   因相同原因而改变的事物；
*   完成行为所需的信息；

并尝试相应地重新定义聚合边界。还有：

*   申请的不同目的；
*   不同的利益相关者；
*   不同的隐式模型/语言；

当涉及到发现所涉及的上下文时。

在大型应用程序中，您可能有多个模型，因此导致单个域概念的多个表示，至少对于扮演多种角色的概念而言。

这是对保罗方法的补充。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-01T08:01:51.903

在 DDD 中使用服务很好。您通常会在域、应用程序或基础设施层看到服务。

Eric 在他的书中使用这些准则来确定何时使用服务：

*   该操作涉及不是实体或值对象的自然部分的域概念。
*   接口是根据领域模型中的其他元素定义的
*   操作是无状态的*******

# ruby - 按中间表排序

> ID：12665394
> 
> 赞同：1
> 
> 时间：2012-09-30T21:43:42.200
> 
> 标签：ruby, sequel

鉴于这些表结构和模型，我该如何在 Ad 类中实现“流行”方法——我只想返回按点击次数排序的广告。

```
require 'sequel'

db = Sequel.sqlite

db.create_table(:users){
    primary_key :id
}

db.create_table(:ads){
    primary_key :id
    foreign_key :user_id, :users
}

db.create_table(:hits){
    primary_key :id
}

db.create_join_table(ad_id: :ads, hit_id: :hits)

class User < Sequel::Model
    one_to_many :ads
end

class Hit < Sequel::Model
end

class Ad < Sequel::Model
    many_to_one :user
    many_to_many :hits

    def self.popular
        #return ads with most hits first
    end
end

User.create
Ad.create user: User[1]
Ad.create user: User[1]
Ad[1].add_hit Hit.create
Ad[2].add_hit Hit.create
Ad[2].add_hit Hit.create
Ad.popular 
```

# android - ImageView 位图大小调整是否应该在 asyncTask 中完成？安卓

> ID：12665404
> 
> 赞同：0
> 
> 时间：2012-09-30T21:45:11.970
> 
> 标签：android, bitmap, resize, android-asynctask, android-imageview

在我的应用程序中，我有 imageUri（来自图库照片），我想缩放照片以在 imageView 中显示用户。我应该在 asyncTask 中缩放图像吗？

额外：如果您有任何关于缩放 jpg 简单快捷方式的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:23:48.967

这取决于您的用例和应用程序的结构。通常，不应在 UI 线程上从文件中解码位图。缩放现有位图并不像从文件中解码它那样繁重，所以如果它只有一个图像，我猜你可以在 UI 线程上进行。

# javascript - 用于 JavaScript/CoffeeScript 的 2 窗格 IDE？

> ID：12665413
> 
> 赞同：2
> 
> 时间：2012-09-30T21:46:22.480
> 
> 标签：javascript, debugging, ide, editor, coffeescript

我正在寻找一个看起来像[coffee2js](http://js2coffee.org/#coffee2js)网站的简单 IDE：

*   2 窗格 - 左侧为 CoffeeScript，右侧为 JavaScript - 实时预览
*   简单的调试功能 - REPL、断点、步进

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T00:14:03.207

如果你正在寻找一个轻量级的解决方案，好的旧 vim 有一个插件可以启用实时预览 [https://github.com/kchmck/vim-coffee-script 。](https://github.com/kchmck/vim-coffee-script)

```
:CoffeeCompile watch 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T22:46:02.637

Visual Studio has plugin Web Essentials that allow transparent compilation of CoffeeScript, so you can open compiled JS and split window vertically etc

Sublime Text 2 has plugin for compiling CoffeeScript as well and also allow splitting screen on two windows.

I personally love all three ( including Webstorm wrick answered about ) and use them depending on the project ( .NET stack in VS2012, other stuff in ST2 and WS )

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T22:23:02.863

对于它的价值，我尝试过 Komodo、Sublime、Aptana 等。对于前端，javascript-heavy web 开发，Webstorm 是最好的。

正如你所说，@wrick，它有一个[实时的咖啡脚本预览](http://www.jetbrains.com/webstorm/webhelp/previewing-compiled-coffeescript-files.html)选项。

它还（至少在最新的 EAP 中）具有 SASS 编译和 JSHint 集成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T21:53:36.513

找到一个：[Webstorm](http://www.jetbrains.com/webstorm/webhelp/previewing-compiled-coffeescript-files.html)。虽然它是一个比我想象的更丑陋的重量级 IDE（看起来像是 IntelliJ 的一个分支）

# php - 用 + 替换空格

> ID：12665428
> 
> 赞同：0
> 
> 时间：2012-09-30T21:47:45.910
> 
> 标签：php, mysql, str-replace

大家好我有一个MySql的小问题，基本上我从一个名为addressone的表中提取一个变量，它是varchar 255！我想要实现的目标是用 + 替换单词之间的空格，但由于某种原因它没有这样做！我有 2 个页面，一个叫做 path.php，另一个叫做谢谢，我有这个......

```
$notokinarray = array(' ');
$okinarray = array('+');

$addressone = $row["addressone"];
$addressone = str_replace($notokinarray, $okinarray, $addressone); 
```

然后我在那个页面的 html 中有这个

```
<select name="somesite" id="somesite">
<option value="">Please Choose</option>
<option value="yes">Yes</option>
<option value="no">No</option></select>
http://www.somesite.com/post.php?&field4=<?php echo '$addressone';?> 
```

带有一个提交按钮到 Thanks.php

在我的Thanks.php页面上我有这个......

```
$somesite = $_POST['somesite']; 

$sql = mysql_query("SELECT * FROM myMembers WHERE id='$id' LIMIT 1");
while($row = mysql_fetch_array($sql)){
    $addressone = $row["addressone"];
} 
if ($somesite == "yes") {
    $somesite = '<iframe src="http://www.somesite.com/post.php?&field4=<?php echo '$addressone';?> width="1" height="1"></iframe>';
    } else {
    $somesite = '';
    }

echo 
' . $somesite . '
http://www.somesite.com/post.php?&field4=<?php echo '$addressone';?>
exit();
?> 
```

据我所知，我的所有空间都应该用 + 符号替换，但由于某种原因它不是，有人可以帮忙吗？

问候，菲利普

更新

我现在要采取不同的策略，并尝试在用户注册时放置 +，但它仍然没有好处！看一下这个.....

```
$sql = mysql_query("UPDATE myMembers SET field = REPLACE(field, ' ', '+'");
     $sql = mysql_query("INSERT INTO myMembers (title, firstname, lastname,username, gender, birthday, email, password, housenumber, addressone, addresstwo, county, city, country, postcode, phone, ipaddress, sign_up_date) 
     VALUES('$title','$firstname','$lastname','$username','$gender','$full_birthday','$email1','$db_password', '$housenumber','$addressone','$addresstwo', '$county', '$city', '$country','$postcode','$phone','$ipaddress', now())")  
     or die (mysql_error()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T21:50:01.007

变量不会插入到由单引号分隔的字符串中。此外，如果它已经是字符串，则将其放入字符串中是多余的。只需完全放弃周围的报价`echo $addressone`。

除此之外，[`urlencode()`](http://php.net/urlencode)将为您正确编码字符串。

# java - 没有属性的getter方法

> ID：12665432
> 
> 赞同：0
> 
> 时间：2012-09-30T21:48:16.943
> 
> 标签：java, jsp, object, struts

嗨，我正在尝试使用 struts 为我的 jsp 代码获取一个 bean，我在我的 jsp 页面中使用的 bean 是：但是每当我运行 jsp 时，我都会收到

> 没有属性的getter方法：bean的“testData.team.type”：“unitForm”。

我正在尝试将棒球写入我的 JSP 页面。

我的操作表单的代码是：

```
import com.TestGettingData;
import org.apache.struts.action.ActionForm;
public class UnitForm extends ActionForm {

private TestGettingData testData = new TestGettingData();  

public TestGettingData getTestData() {
    return testData;
}

public void setTestData(TestGettingData testData) {
    this.testData = testData;
} 

} 
```

测试数据类有：

```
public class TestGettingData extends Sport{

    private String team = "Yankees"; 

private String position = "short stop";  

public void setTeam(String tm) {    
    team = tm; } 

public String getTeam() {     
        return team; } 

public void setPosition(String po) {    
    position = po; } 

public String getPosition() {   
    return position; 
    } 
} 
```

最后在我的体育课上：

```
public class Sport{

    public String type = "baseball";

public String getType() {
    return type;
}

public void setType(String type) {
    this.type = type;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:51:24.853

而不是`testData.team.type`，尝试`testData.type`。`type`是`testData`not in 中的属性`team`。

**更新**

`${unitForm.testData.type}`应该在您的 JSP 中显示“棒球”。

# jquery - Jquery Draggable + 放在前面

> ID：12665435
> 
> 赞同：2
> 
> 时间：2012-09-30T21:48:28.427
> 
> 标签：jquery, html, css, jquery-ui

我有一个带有许多聊天 DIV 的窗口，用户可以在其中与不同的人聊天。

目前，聊天 DIV 可以打开并四处移动，但我看不到将当前选择的 DIV 设置在前面。例如：当您将鼠标放在 DIV 上时，它会进入前台。

HTML：

```
<div id="1000000001" class="chatMessenger">
    <div class="chatMessengerContainer">
        </div>
</div> 
```

CSS：

```
div.chatMessenger {
    position: absolute;
    top: 50px;
    left: 50px;
    width: 250px;
    height: 300px;
    background-color: white;
    z-index: 100;
    border: 1px solid black;
} 
```

查询：

```
 // JQUERY UI Draggable - Initialize
    $('div#'+memberID).draggable({
        containment: $('div#chatWrapper')
    });

    // JQUERY UI Draggable - Setting the Stack
    $(document).on('mousedown','div.chatMessenger', function() {
        alert('chat mouse down...');
        //var stack = $( ".selector" ).draggable( "option", "stack" );
        $(this).draggable( "option", "stack", ".products" );
    }); 
```

警报在 mousedown 中触发，因此这是找到正确的元素。

我查看了 Draggable z-index 和 stack 但我无法让任何一个工作。

会有多个聊天DIV同时打开给选中的需要坐在前面的。

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-30T21:56:30.083

这应该有帮助

```
$('div.chatMessenger').not(this).css('z-index', '100');
$(this).css('z-index', '1000'); 
```

内部`on('mousedown')`函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T19:42:22.613

对于您希望将一个放在前面并将其他的重新设置为后面的几个可拖动对象：

```
$('.container').on('mousedown', function(event) { 
    $('.container').css('z-index','1');
    $( this ).css('z-index','1000');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-25T13:26:55.130

我发现最简单的实现是将dom中的div移动到最后一个位置。因此，如果您不必关心 dom 中的位置，这是不使用 z-index 的最简单方法。我用它来定位一些便签。

```
$("#chatWrapper").on('mousedown', '.chatMessenger', function() {
    $(this).appendTo("#chatWrapper");
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-01T10:39:01.637

虽然有一个选项 - 在启动这样的可拖动项时存在“堆栈” -

```
$('.draggable').draggable({
    stack: ".draggable"
}); 
```

但它不能正常工作，所以我写了一个小库 dragToFront 玩 z-index。以下是 plunkr 链接

[https://embed.plnkr.co/mJqkxSJhf1Umg7r2oLQN/](https://embed.plnkr.co/mJqkxSJhf1Umg7r2oLQN/)

# matlab - 用 3 个符号变量绘制曲面

> ID：12665437
> 
> 赞同：0
> 
> 时间：2012-09-30T21:48:58.237
> 
> 标签：matlab, plot

首先，我需要声明我并不是一个数学爱好者或狂热的 Matlab 用户。这是我过去 3 个小时一直在尝试解决的大学作业，但没有成功。我疯狂地用谷歌搜索，甚至通过 Facebook 寻求帮助（我得到了回复，但没有解决我的问题）。

这是我第一次使用这个软件，我需要快速绘制一些东西。但无论我读了多少书，我都会不断收到语法错误等。

基本上，我有这个等式：

```
4*x^2 + y^2 + z^2 - 8*x + 2*y + 3 = 0 
```

我正在尝试绘制它/绘制它。我认为这会非常简单，但我在做这件事时遇到了问题。

谷歌搜索向我展示了函数 ezplot() 和 ezsurf()，但是：

当我执行 ezplot('4*x^2 + y^2 + z^2 - 8*x + 2*y + 3') 时，出现以下错误：

```
??? Error using ==> char
Cell elements must be character arrays.
Error in ==> ezplot at 158
      fmsg = char(f); 
```

当我做 ezsurf('4*x^2 + y^2 + z^2 - 8*x + 2*y + 3')

```
The expression 4*x^2 + y^2 + z^2 - 8*x + 2*y + 3 must only have 2 symbolic variables
Error in ==> ezgraph3>surfplot at 526
[F,var] = ezfixfun(F,fargs,flabel);
Error in ==> ezgraph3 at 49
   [dummy,h] = surfplot(f,domain,surfstyle,cax,Npts,fixdomain,flabel,fargs);
Error in ==> ezsurf at 65
    h = ezgraph3('surf',args{:}); 
```

同样，这真的是我第一次使用这个软件。老师没有给我们任何解释，所以我不知道这些错误应该是什么意思，更不用说解决它们了。我不知道我在做什么或我应该做什么。

我尝试使用solve()首先求解'z'，然后绘制我得到的两个结果。

```
s = solve('4*x^2 + y^2 + z^2 - 8*x + 2*y + 3', 'z')
s =
   -(- 4*x^2 + 8*x - y^2 - 2*y - 3)^(1/2)
    (- 4*x^2 + 8*x - y^2 - 2*y - 3)^(1/2) 
```

但这也行不通。当我使用 ezplot() 时，它告诉我使用 ezsurf，而当我使用 ezsurf() 时，它告诉我一个我从未声明过的变量“h”：

```
>> ezsurf('-(- 4*x^2 + 8*x - y^2 - 2*y - 3)^(1/2)', '(- 4*x^2 + 8*x - y^2 - 2*y - 3)^(1/2)')
??? Undefined function or variable "h".
Error in ==> ezgraph3 at 66
    hh = h;
Error in ==> ezsurf at 65
    h = ezgraph3('surf',args{:}); 
```

任何帮助绘图将不胜感激。我的脑袋要爆炸了，因为人们一直告诉我这应该很简单。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T01:34:41.907

以下对我有用：

```
ezsurf('(8*x - 4*x^2 - y^2 - 2*y -3)^(1/2)'); 
```

请注意，它`ezsurf`接受二维函数（映射到第三维）。因此，您必须以 f(x, y) = blah 的形式表达该函数，其中 blah 是您想要作为`ezsurf`. 我所做的只是将你的函数重新排列成 z = blah 的形式，然后将 blah 输入到`ezsurf`.

哦，还有两件事，1）结果图只说明了一半，因为 z^2 的平方根可以是 z 或负 z（默认情况下，matlab 采用正平方根）。2) 上面的函数只能在没有复数的情况下进行分析（例如我在这里所做的），对于`x`和的一个非常有限的域`y`。

# c# - 使用多重绑定更新源

> ID：12665439
> 
> 赞同：2
> 
> 时间：2012-09-30T21:49:11.210
> 
> 标签：c#, wpf, data-binding, wpfdatagrid, multibinding

我有一个组合框，即可编辑。我的应用程序中的组合框就像所有数据网格单元格的编辑控件，即编辑组合框中的值应该更新我的数据网格模板列的绑定。如果它是一个正常的绑定，下面的代码会更新源代码。如果它是多重绑定，它会调用 convertback() 函数。我正在使用以下转换器来更新我的源。ParentID 属性设置为一种方式。我只需要更新 ID 属性。请帮助我使用转换功能

**Xaml**

```
<tk:Datagrid>
   <tk:DataGridTemplateColumn Header="Event ID" MinWidth="100"  CellTemplate="{StaticResource ClipsEventIDCellTemplate}" CellEditingTemplate="{StaticResource ClipsEventIDCellEditingTemplate}" />
</tk:Datagrid>

  <DataTemplate x:Key="ClipsEventIDCellTemplate">
        <TextBlock>
            <TextBlock.Text>
                <MultiBinding UpdateSourceTrigger="Explicit" Converter="{StaticResource EventIDConvert}" Mode="TwoWay"  UpdateSourceTrigger="Explicit" >
                     <Binding Path="ParentID" Mode="OneWay"/>
                     <Binding Path="ID" Mode="TwoWay"/>
                </MultiBinding>
            </TextBlock.Text>
        </TextBlock>
  </DataTemplate>

<ComboBox x:Name="UniversalTextBox"  IsEditable="True" ItemsSource="{Binding UniversalTextEntries, ElementName=TheMainWindow, Mode=OneWay}"  KeyDown="OnUniversalTextKeyDown"/> 
```

**代码**

```
 // properties
    public int ID
    {
        get { return m_id; }
        set 
        {
            if (m_id != value)
            {
                m_id = value;
                NotifyPropertyChanged("ID");
            }
        }
    }

    public int ParentID
    {
        get;
        set;
    }

  private void OnUniversalTextKeyDown(object sender, KeyEventArgs e)
    {
         if (e.Key != Key.Enter && e.Key != Key.Escape)
            return;

        var comboBox = sender as ComboBox;
        if (comboBox == null)
            return;
        BindingExpression binding = null;
        MultiBindingExpression multibinding = null;

        bool restoreGridFocus = false;
        bool isMultibinding = false;

        binding = comboBox.GetBindingExpression(ComboBox.TextProperty);
        if (binding == null)
        {
            isMultibinding = true;
            multibinding = BindingOperations.GetMultiBindingExpression(comboBox, ComboBox.TextProperty);
            if (multibinding == null && multibinding.BindingExpressions.Count < 0)
                return;
        }

        if (e.Key == Key.Escape)
        {
            restoreGridFocus = true;
            if (!isMultibinding)
                binding.UpdateTarget();
            else
                multibinding.UpdateTarget();
        }
        else if (e.Key == Key.Enter)
        {
            PopulateTextEntries(comboBox.Text);
            restoreGridFocus = true;
            if (!isMultibinding)
                binding.UpdateSource();
            else
                multibinding.UpdateSource();
        }

        if (restoreGridFocus)// set the focus back to the lastfocuced cell in the datagrid
        {
            e.Handled = true;

            if (m_BoundDataGrid != null)
            {
                var cell = m_BoundDataGridCell;

                if (cell == null)
                    cell = DataGridUtils.GetCell(m_BoundDataGrid, m_BoundObject, m_BoundColumnIndex);

                if (cell != null)
                    cell.Focus();
            }
        }

    } 
```

**转换器**

```
public class EventIDConverter : IMultiValueConverter
{
    #region IMultiValueConverter Members

    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        if (values.Length < 2)
            return null;

        return string.Format("{0}{1}", values[0], values[1]);
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        if (value == null)
            return null;

        //ToDo

         ???????????????
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T05:45:21.623

创建一个继承自`IMultiValueConverter`.

**从Convert**方法中获取`TextBlock.Text`s 值，而不是从 the中获取并实现**ConvertBack**来设置源。**`StringFormat`**

 ****```
public class EventIDConverter : IMultiValueConverter
{
#region IMultiValueConverter Members

public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
{
    if (values.Length < 2)
        return null;

    return string.Format("{0} {1}", values[0], values[1]);
}

public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
{
    if (value == null)
        return null;

    string[] splitValues = ((string)value).Split(' ');
    return splitValues;
}

#endregion
} 
```

**笔记：**

1.  我放了一个空格来分隔这两个值。这适用于 ConvertBack 中的 split 方法。

2.  您将其中一个绑定设置为`OneWay`****

# iphone - 在 NSDictionary 中出现奇怪的错误

> ID：12665452
> 
> 赞同：0
> 
> 时间：2012-09-30T21:52:06.663
> 
> 标签：iphone, objective-c, nsdictionary

在以下示例中调用 NSDictionary 时出现奇怪的异常：

```
NSInteger userId = 1;
NSDictionary *postData = [NSDictionary dictionaryWithObjectsAndKeys:
                      @"3", @"a",
                      @"0", @"b",
                      userId, @"c",
                      nil]; 
```

有人可以看到上面的问题是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:55:27.497

`NSDictionary`，与大多数集合一样，只接受真正的 Obj-C 对象（`id`类型），但您传递的`NSInteger`是一个普通的 C typedef。

尝试`NSNumber userId = [NSNumber numberWithInt:1];`

# php - 背景 & php/jquery

> ID：12665454
> 
> 赞同：0
> 
> 时间：2012-09-30T21:52:22.073
> 
> 标签：php, jquery, css, background, nested-class

我正在使用 jquery 插件创建一个带有缩略图的图像滑块。我的目标是让主图像的背景是`bg.png`，缩略图部分的背景是`wood.png`。

我已将 CSS 更改为我认为正确的内容（见下文），但缩略图部分的背景并没有完全扩展`961px`，它仅限于`921px`我用主图像建立的宽度。我有一种感觉，这可能是由于嵌套在插件的 php/jquery 中，我只是不确定如何改变它以使其工作。如果是这种情况，我该如何解决？如果是别的东西，我如何确定它是什么/如何修复它？

[thethe-image-slider.php](http://pastebin.com/QJD49Qhn)

[timthumb.php](http://pastebin.com/b4M9VGWd)

[现场直播](http://urbanpalate.com/instyle-mag-ming-by-mango/)

谢谢。

CSS

```
.thethe_image_slider.white-square-1{
    background: url('../images/bg.png');
}
.white-square-1 .thethe-image-slider-thumbnails{
    background: url('../images/wood.png');
    margin-top: 20px;
    margin-bottom: 40px;
    width: 961px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:12:19.297

找到这条线

`<div class="thethe_image_slider white-square-1" id="thethe_image_slider323" style="width:921px;"><div class="thethe_image_slider_inner" style="width:921px; height:392px;">`

并改成这个

`<div class="thethe_image_slider white-square-1" id="thethe_image_slider323" style="width:961px;"><div class="thethe_image_slider_inner" style="width:921px; height:392px;margin:0 auto;">`

在你的代码中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T22:27:11.167

将您的`thethe-image-slider-thumbnails`div 移出`thethe_image_slider white-square-1`div 但在`gallery`div 内。那对我来说很好。

# php - 不需要的 标签被插入数据库

> ID：12665455
> 
> 赞同：0
> 
> 时间：2012-09-30T21:52:34.570
> 
> 标签：php, mysql, configuration, ckeditor

我正在使用表单将文本插入 MySQL 数据库。

当用户在表单中手动键入文本时，结果会完美地插入到数据库中。

但是，如果用户从另一个网页复制和粘贴文本，则会有隐藏的 p 标签与文本一起发送到数据库。标签在表单本身中是不可见的，但在提交时它们仍会发送到数据库。

如果我随后使用 MySQL SELECT 语句在网页上显示结果，则会显示不需要的标签，它们会破坏我的网页布局！

因此，当我从另一个网页复制和粘贴文本时，我只需要知道如何阻止将不需要的“p”“span”和“div”标签插入到我的 MySQL 数据库中。

有问题的网络表单是我正在构建的内容管理系统的一部分。从用户的角度来看，我需要表单是防弹的。现实情况是，用户很可能会从其他网站复制和粘贴文本，也可能从 word 文档中复制和粘贴文本，我需要确保在复制时不会将不需要的“p”“span”和“div”标签插入数据库并从第三方来源粘贴。

**这是我的表单代码：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled</title>
<script type="text/javascript" src="http://www.achcreative.net/ckeditor/ckeditor.js"></script>
<link href="../elite.css" rel="stylesheet" type="text/css" />
</head>
<body>

<!--Begin Main Menu -->
<?php include("includes/menu.inc.php"); ?>
<!--End Main Menu -->

<h2 class="subheaderh2">Insert New News Entry</h2>  

<form method="post" action="insert_news.php">
<input name="publish" type="hidden" id="publish" value="publish" />  
<table>
<tr><td><p>News Title:</p></td></tr>
<tr><td><input name="newstitle" type="text" size="43" id="newstitle"></td></tr>
<tr><td><p>News Article:</p></td></tr>
<tr><td><textarea name="newsarticle" cols="40" rows="10" id="newsarticle"></textarea>

<script type="text/javascript">
//<![CDATA[

// Replace the <textarea id="editor"> with an CKEditor
// instance, using default configurations.
CKEDITOR.replace( 'newsarticle', 
    {
        toolbar :
        [
            [ 'Bold', 'Italic', '-', 'NumberedList', 'BulletedList', '-', 'Link', 'Unlink' ],
        ]
    });
//]]>
</script>
</td></tr>
<tr><td height="30" colspan="2"><input type="submit" value="Submit"></td></tr>  
</table></form>
<p><a href="news_results.php">Return</a></p>
</body>
</html> 
```

**这是我的表单处理脚本代码：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled</title>
</head>

<body>
<h2 class="subheaderh2">News Entry Results</h2>

<?php
// create short variable names
$newstitle=$_POST['newstitle'];
$newsarticle=$_POST['newsarticle'];
$publish=$_POST['publish'];

if (!$newstitle || !$newsarticle)
{
 echo '<p>You have not entered all the required details.<br />'
      .'Please go back and try again.</p>'
      .'<p><a href="javascript:history.go(-1)">Return</a></p>';
 exit;
}

if (!get_magic_quotes_gpc())
{
$newstitle = addslashes($newstitle);
$newsarticle = addslashes($newsarticle);
}

$time = date("l jS F Y - g:iA");

// connect to the database
include('../connect-db.php');

/* Create the prepared statement */
if ($stmt = $mysqli->prepare("INSERT INTO news (id, newstitle, newsarticle, date, archive) values (NULL, ?, ?, NOW(), ?)")) {

/* Bind our params */
$stmt->bind_param('sss', $newstitle, $newsarticle, $publish);

/* Set our params */
$newstitle=$_POST['newstitle'];
$newsarticle=$_POST['newsarticle'];
$publish=$_POST['publish'];

/* Execute the prepared Statement */
$stmt->execute();

/* Echo results */
echo "{$newstitle}";
echo "<br />{$newsarticle}";
echo "Inserted into database on: ";
echo "$time";
echo "<br />";
echo "<br />";
echo '<a href="news_results.php">view results</a>';

/* Close the statement */
$stmt->close(); 
}
else {
/* Error */
printf("Prepared Statement Error: %s\n", $mysqli->error);
}

/* close our connection */
$mysqli->close();

?>

</body>
</html> 
```

提前谢谢了

问候

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T01:47:12.673

CKEditor 提供了大量影响内容最终输出的配置选项。

如果您不希望在将某些内容粘贴到编辑器时包含 HTML 标记，您可以强制粘贴操作仅为文本，这将去除 HTML 标记。

```
config.forcePasteAsPlainText = true; 
```

如果您可以包含从另一个网页复制并粘贴到编辑器中的有问题内容的示例，将会很有帮助。包括以下三个部分。

1) 被复制的网页部分。

2) 该网页中被复制部分的源代码。

3）粘贴操作后CKEditor内容的源代码。

要在编辑器中查看源代码，您需要暂时将“源”按钮添加回工具栏中：

```
CKEDITOR.replace( 'newsarticle', 
    {
        toolbar :
        [
            [ 'Source','Bold', 'Italic', '-', 'NumberedList', 'BulletedList', '-', 'Link', 'Unlink' ],
        ]
    }); 
```

粘贴操作后，点击源按钮，复制粘贴的内容。这将使您能够准确地看到正在发生的事情。

配置选项列表可在此处获得：
[CKEditor 3 JavaScript API 文档命名空间 CKEDITOR.config](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.config.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T22:03:36.990

我想指出您的代码容易受到 XSS 攻击。

现在回到你的问题：

您可能使用 html 编辑器。`onsubmit`尝试在使用 javascript 和属性提交之前删除不需要的标签。您可以使用以下正则表达式剥离标签：

```
value_of_editor.replace(/<[^>]+>/g,''); 
```

还要确保在将 html 发送到客户端之前不输出原始 html 而是转义 html。

**更新：** 没有必要将转义消息放入数据库 - 我认为这只是浪费数据长度。而且您应该始终检查您输出给客户的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:01:10.830

您可以`strip_tags()`在需要插入数据库的文本上使用该功能。

[这是参考](http://php.net/manual/en/function.strip-tags.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T22:04:48.617

您应该使用函数**strip_tags**从字符串中去除（明显的）标签和可能有害的代码。（无论是 html 还是 php 代码）

```
$foo = strip_tags('<b>code with html</b>'); // $foo will be "code with html" 
```

# ios - xcode 4.5 和 ios 6 中的 zxing

> ID：12665457
> 
> 赞同：13
> 
> 时间：2012-09-30T21:53:02.467
> 
> 标签：ios, xcode, zxing

正如你们许多人所注意到的那样；zxing 在最新的 xcode (4.5/ios 6) 中不起作用

这是用例：

> 1.  从主干结帐最新版本（因为已经添加了一些修复）
> 2.  使用 ios 6.0 在 xcode 4.5 中创建单视图应用程序
> 3.  使用 README 添加依赖项、路径等（只需一步一步）
> 4.  将 zxingcontroller 调用添加到类（重命名为 mm）

模拟器和设备的编译都失败它显示 31 错误，如下所示：

```
Undefined symbols for architecture i386:
  "std::string::c_str() const", referenced from 
```

所有 31 个错误都相似，不同之处在于符号名称

可能有人知道如何用这个用例解决它？

ps 如果您有以前 Xcode 的应用程序，它可以工作。问题仅在于您在 Xcode 4.5 中创建新应用程序

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-01T00:00:44.377

您遇到的问题似乎与 C++ 标准库相关。

实际上，每当您看到与标准库对象（例如`std::string`）相关的链接器故障时，您应该检查所有链接库和应用程序项目本身的项目设置。他们通常需要匹配！

原始的 ScanTest（将 ZXingWidget 构建为子项目）使用以下设置，如果您按原样使用库，则这些设置需要与您的 App 构建设置相匹配。

为了确保这一点，我使用 Xcode 4.5 创建了一个全新的项目。该项目使用 ZXingWidget 作为预建库，但不作为子项目——我不喜欢不属于我自己的东西的子项目——尽管这个专业不会影响结果。

重要的设置是***C++ 标准库***- 确保设置为***编译器默认值***

![在此处输入图像描述](../Images/9cfb58ff3b2d390ff69c81c49fd325e3.png)

* * *

*一点澄清*

实际上，你不需要使用***C++ 标准库***，你也可以使用***支持 C++11 的 LLVM C++ 标准库***。**但是**您必须在与您的项目链接的所有项目、子项目和库中使用完全相同的库。因此，如果您坚持使用该库的更新版本（C++11 支持），那么您也必须使用这些设置构建 ZXing 库。

* * *

最后但同样重要的是，确保您的***架构***和***有效架构***设置与所有项目和子项目匹配（修复常见的`armv7s`链接器问题）。

首先，确保在所有项目中都设置了***架构***设置。`armv7` `armv7s`然后还将所有项目的项目设置编辑为***Valid Architecture*** `armv7s` `armv7`。

![在此处输入图像描述](../Images/78cdf16e769931b11a323fd702c4be63.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T10:56:56.070

您可能还想关闭“其他警告标志”-Werror。在 Xcode 版本 > 4.5（LLVM 编译器 > 4.1）中似乎是必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T23:32:43.303

它对我有用，您是否在项目目标的“构建设置”选项卡中的“其他链接器标志”列表中启用了 -lstdc++？听起来它无法识别 zXing 构建所需的 c++ 符号。如果是这种情况，上述建议应该会有所帮助。

# html - 文本“侦听”其下方的浮动元素，而不是同一行上的元素

> ID：12665470
> 
> 赞同：2
> 
> 时间：2012-09-30T21:55:19.660
> 
> 标签：html, css, css-float

在 Coda 中，我的文本浮动 div 可以完美运行。文本和 div 都是 1 em： ![结尾](../Images/afc4a34e7bc37250dce236d60c61894d.png)

但是，一旦我在 Chrome 中查看同一个站点，文本现在会监听它下面的 div，并且您可以看到文本都在一行上： ![铬合金](../Images/361a2aac966c7fe5519c975165a5c290.png)

这里有什么问题？HTML/CSS：http: [//jsfiddle.net/u773M/2/](http://jsfiddle.net/u773M/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:20:05.337

您的字体大小目前太大。在锚点上设置较小的字体大小（不是列表项，因为这会改变您的步长）并添加设置锚点以显示：块。

如果没有适当的空间让字母散开，它们就会被切断并且无法正确渲染。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T12:12:43.737

为文本区域或最大宽度（较新的浏览器）提供宽度并浮动或显示这些将有助于跨浏览器实现 - 我之前遇到过类似的问题，你会发现 ie7 喜欢文本上的宽度取决于标记 -向上环绕。

# java - 为什么我没有收到 NullPointerException？

> ID：12665474
> 
> 赞同：16
> 
> 时间：2012-09-30T21:55:37.973
> 
> 标签：java, nullpointerexception

> **可能重复：**
> [Java 中空引用上的静态字段](https://stackoverflow.com/questions/11579953/static-fields-on-a-null-reference-in-java)

我知道静态方法是在类级别的。所以我知道我不需要创建实例来调用静态方法。但我也知道我可以将静态方法称为实例方法。这是我感到困惑的地方，因为我期待`NullPointerException`从空对象调用静态方法（如调用实例方法）。我真的很感激一些解释为什么我在`NullPointerException`这里期望是错误的。

这是示例代码：

```
public class SampleClass {

    public static int getSumStatic(int x, int y){
        return x+y;
    }

    public int getDifferenceInstance(int x, int y){
        return x-y;
    }
}

public class TestClass {

    public static void main (String[] args){        
    SampleClass sc=null;

    System.out.println(SampleClass.getSumStatic(2, 2)); //as expected

    //I was expecting NullPointerException in the next line, since I am accessing null object
    System.out.println(sc.getSumStatic(4,5)); //static method , executes perfectly  

    System.out.println(sc.getDifferenceInstance(6,4));//throws NullPointerException
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-30T21:58:34.357

通过实例调用静态方法不需要实例存在。只要编译器能够确定变量的类型，它就会在计算`sc`表达式并丢弃结果后静态地进行等效调用：

```
System.out.println(SampleClass.getSumStatic(4,5)); 
```

来自[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf)：

> 第 15.12.1 节
> 
> ❖ 如果形式是`Primary.NonWildTypeArgumentsopt Identifier`，那么方法的名称就是标识符。令 T 为 Primary 表达式的类型。如果 T 是类或接口类型，则要搜索的类或接口是 T，如果 T 是类型变量，则为 T 的上限。
> 
> 第 15.12.4.1 节：
> 
> 1.  如果涉及包含 Primary 的 MethodInvocation 的第二个产生式，则有两个子情况：
> 
> ❖ 如果调用方式是静态的，那么就没有目标引用。表达式 Primary 被评估，但结果随后被丢弃。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T22:06:30.140

这是java设计师的某种设计错误。您应该*在类上调用静态方法*，因为*它属于类*而不是对象。

[您可以在why-isnt-calling-a-static-method-by-way-of-an-instance-an-error-for-the-java-co](https://stackoverflow.com/questions/610458/why-isnt-calling-a-static-method-by-way-of-an-instance-an-error-for-the-java-co)看到一些关于这个问题的信息

有趣的是，不可能在尚未初始化的对象变量上调用静态方法。但是如果对象是用*null*初始化的，一切都很好。

我认为这是可行的，因为与此变量一起存储的对象**通过赋值提供了类型信息**。

```
SampleClass sampleObject;
sampleObject.getSumStatic(2, 2) 
```

不会编译，因为对象未初始化，因此**在 java 编译器的语法树中没有设置类型信息**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T21:59:46.150

Java 将允许您仅基于引用访问静态方法，即使引用是`null`. 只有引用的类型很重要。

您通常应该使用类名来调用静态方法：

```
SampleClass.getSumStatic(2, 2); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-30T22:20:13.083

作为对 dasblinkenlight 的（绝对正确）响应的附加说明，您可以看到生成的 Java 字节码的差异（您可以通过 阅读阅读`javap -c`）。

考虑以下（更简单的）类：

```
public class Example {
  public static void staticMethod() {}
  public void virtualMethod() {}
} 
```

以及使用它的应用程序：

```
public class ExampleApplication {
  public static void main(String[] args) {
    Example ex = null;
    Example.staticMethod();
    ex.staticMethod();
    ex.virtualMethod();
  }
} 
```

让我们看看为 生成的字节码`ExampleApplication.main(String[])`：

```
public static void main(java.lang.String[]);
  Code:
   0:   aconst_null
   1:   astore_1
   2:   invokestatic    #2; //Method Example.staticMethod:()V
   5:   aload_1
   6:   pop
   7:   invokestatic    #2; //Method Example.staticMethod:()V
   10:  aload_1
   11:  invokevirtual   #3; //Method Example.virtualMethod:()V
   14:  return 
```

单步执行（通过偏移量，即上述输出中的数字列）：

偏移量 0 和 1 处的指令加载`null`，然后将其存储到局部变量 1 ( `ex`) 中。

偏移量 2 处的指令执行传统的静态调用：它是`invokestatic`调用`Example.staticMethod()`. 正如您所料，这不涉及实例变量。

接下来是对我们实例上的静态方法的调用。偏移量 5 处的指令加载`ex`到堆栈上（请记住，这是 null），但`pop`偏移量 6 处的指令会立即撤消此操作。因此`invokestatic`，偏移量 7 处的行为与偏移量 2 处的行为完全相同：空值不在 VM 堆栈上，并且要调用的方法由 编译`javac`，无论 的值`ex`是什么。

相比之下，虚拟（即非静态）方法将实例推入堆栈（偏移量 10），然后当它在堆栈上时，执行一条`invokevirtual`指令，该指令查找`virtualMethod()`实例以查找要执行的方法。这是`NullPointerException`抛出 a 的步骤，因为该查找无法继续。（请注意，这一步在静态情况下是不必要的，这也是静态方法调用在幼稚 VM 中更快的原因。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-30T21:58:54.293

您正在通过强类型为 的变量访问静态方法`SampleClass`。在编译期间，该方法被解析为直接在类定义上调用（因此它是一个静态方法），因此它实际上已被解析。

没有隐含`this`，`public static int getSumStatic`因此无法访问空指针。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-30T22:02:13.887

我认为类实例实例的静态函数基本上在编译时被它们的静态类信息替换（它们也不适用于像实例方法这样的继承）。

实例方法尝试访问 null 的方法并抛出 NullPointerException。

# php - PHP + Wordpress：在 wp-login.php 模板上获取会话变量

> ID：12665477
> 
> 赞同：0
> 
> 时间：2012-09-30T21:56:07.943
> 
> 标签：php, wordpress, session, global-variables, scope

我正在编辑 wp-login.php 以创建自定义登录屏幕。也许有更好的方法可以做到这一点，所以如果有人有这方面的经验，欢迎提出任何意见。

在我的主题的 functions.php 中，我开始了一个会话：

```
function init_sessions() {
    if (!session_id()) {
        session_start();
    }
}
add_action('init', 'init_sessions'); 
```

在我的主题文件中，我设置了一个会话变量：

```
// Check if we've submitted a language
if($_GET['id'] == 'en') {
    $_SESSION['bam_lan'] = 'en';
}

if(!isset($_SESSION['bam_lan'])) {
    $_SESSION['bam_lan'] = 'es';
}

// Set language
$bam_lan = $_SESSION['bam_lan']; 
```

在 wp-login.php 中，`echo $_SESSION['bam_lan'];`不回显任何内容。

如何从 wp-login.php 获取在我的主题的 functions.php 中设置的全局会话变量？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T04:27:09.073

wp-login.php 在functions.php 和“init”操作之前执行。

# matlab - 在 MATLAB GUI 中制作可旋转的冲浪图

> ID：12665485
> 
> 赞同：0
> 
> 时间：2012-09-30T21:58:03.357
> 
> 标签：matlab, user-interface

我需要制作一个 GUI，您可以在其中旋转冲浪图。我目前在我的 GUI 中有一个冲浪图，但我无法旋转它。单击它不起作用，并且它上面没有菜单栏。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T10:10:33.390

当您使用 GUIDE 创建 GUI 时，默认情况下，它将通过将图形的“工具栏”和“菜单栏”属性设置为“无”，从 GUI 图形窗口中删除工具栏和菜单栏。这通常是一件好事，因为图形工具栏和菜单栏中有很多可用的功能，这意味着您作为 GUI 设计人员很难控制用户将体验的工作流。

如果您只想快速使冲浪图可旋转，您可以将图形的“工具栏”属性设置为“图形”，`set(f, 'Toolbar', 'figure')`如果您有`f`图形的句柄，或者`set(gcf, 'Toolbar', 'figure')`如果没有 -`gcf`是当前图形的句柄。

更好的方法是关闭工具栏，并添加一个标记为“旋转开/关”的切换按钮 uicontrol。在此切换按钮的回调中，将一些调用命令的代码`rotate3d`放在冲浪图的轴上以打开或关闭旋转。也许对平移、缩放也一样。这样您就可以提供旋转，同时保持对 GUI 工作流程的控制。

# c# - 我如何阅读这个 xml 文件？

> ID：12665492
> 
> 赞同：2
> 
> 时间：2012-09-30T21:59:26.170
> 
> 标签：c#, xml, c#-4.0, xml-parsing

我有这个 xml 文件

```
<?xml version="1.0" encoding="utf-8" ?>
<parameters>
    <parameters 
        registerLink="linkValue" 
        TextBox.name="nameValue" 
    />
</parameters> 
```

我想通过代码打印出“LinkValue”和“nameValue”：

```
 Console.WriteLine("registerLink: " + registerLink);
 Console.WriteLine("TextBox.name: " + TextBox.name); 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T22:01:51.377

最简单的 API 是 XLinq (System.Xml.Linq)

```
var doc = XDocument.Load(fileName);
// This should be parameters/parameter, i follow the question with parameters/parameters
var par = doc.Element("parameters").Element("parameters");  
registerLink = par.Attribute("registerLink").Value;  // string 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:00:51.047

您可以使用像这样的 xml 阅读器

[http://msdn.microsoft.com/en-us/library/cc189056%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/cc189056%28v=vs.95%29.aspx)

一旦你有了一个工作示例，请查看此处以了解如何从文件流中打开 xml 阅读器。文件必须位于项目目录中

[http://support.microsoft.com/kb/307548](http://support.microsoft.com/kb/307548)

完成后，您可以添加一个打开文件对话框来查找计算机上的任何文件，甚至验证 .xml 扩展名等等。

编辑：正如您在下面的评论中看到的，Hanks 解决方案更好、更快、更容易。只有当您拥有包含大量数据的大型 xml 文件时，我的解决方案才会有用。您可能仍然对文件对话框感兴趣。

# c++ - C++ 转换运算符错误？

> ID：12665494
> 
> 赞同：0
> 
> 时间：2012-09-30T21:59:47.710
> 
> 标签：c++, operator-overloading, operator-keyword

在类声明中重载的运算符：

```
class Asdf{

    operator float() const;                 
    Asdf operator+(const Asdf&) const;
    Asdf operator+(float);

}

int main()

{
    Asdf object1, object2, object3;

    //Receiving error: "more than one operator '+' matches these operands"
    object1= object2 + object3;

    _getch();
    return 0;
} 
```

错误：

```
   :error C2666: 'Asdf::operator +' : 3 个重载有类似的转换

   : 可能是 'Asdf Asdf::operator +(float)'

   :'Asdf Asdf::operator +(const Asdf &) const'

```

当我删除与重载`float`转换运算符一起使用的所有转换时，代码会正确编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T22:05:32.713

发生这种情况是因为转换运算符提供了从您的类到浮点数的隐式方法。因此，其他涉及浮点数的加法运算符会阻碍。

为了解决这个问题，如果您真的希望该转换成为可能，最好的解决方案是将其标记为显式：

```
explicit operator float() const;

Asdf a;
float f = static_cast<float>(a); 
```

但是，这只适用于 C++11。在 C++03 中，更好的选择是使用函数：

```
float toFloat() const;

Asdf a;
float f = a.toFloat(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T22:09:08.017

隐式转换运算符往往会引起这类歧义，尤其是在与隐式构造函数结合使用时。

来自*C++ 编码标准*：

> 1.  考虑重载以避免隐式类型转换。
> 
> 不要超出必要的对象相乘（奥卡姆剃刀）：隐式类型转换提供了语法上的便利（但参见条款 40）。但是当创建临时对象的工作是不必要的并且优化是适当的（参见条款 8）时，您可以提供具有与常见参数类型完全匹配并且不会导致转换的签名的重载函数。
> 
> 并非所有的改变都是进步：隐式转换往往弊大于利。在提供与您定义的类型之间的隐式转换之前要三思而后行，并且更喜欢依赖显式转换（显式构造函数和命名转换函数）。

其中很多都涉及到提供隐式转换可能导致的效率和意外行为，但是函数重载导致的歧义错误包含在提供隐式转换运算符和/或构造函数时很容易遇到的副作用中。

解决方案：让您的运营商明确或尽量避免提供它。这可能很方便，但它可能会引起像这样令人讨厌的惊喜（编译器错误实际上是最不讨厌的）。

# f# - 是否可以在函数或值绑定中使用 F# 模块缩写？

> ID：12665496
> 
> 赞同：1
> 
> 时间：2012-09-30T22:00:31.453
> 
> 标签：f#

在以下 ML 摘录（取自[Effective ML talk](http://vimeo.com/14313378)）中，值绑定表达式中有一个模块缩写。是否可以在 F# 中进行等效操作？ *我知道你可以做模块缩写，如果你能像这样“内联”地做它们，我特别感兴趣。*

```
let command =
  let default_config = { exit_code = 0; message = None } in
  let flags = 
    let module F = Command.Flag in
    [ F.int    "-r" (fun cfg v -> { cfg with exit_code = v });
      F.string "-m" (fun cfg v -> { cfg with message   = v });
    ]
  ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:03:26.993

不，此功能在 F# 中不可用。您只能使用以下方法进行顶级模块缩写（如您所说）：

```
module F = Command.Flag 
```

您可以将它们写在源文件的中间，但它们必须位于顶层，并且它们的范围始终是直到文件末尾（或直到另一个隐藏的定义`F`）。也许如果你使用它，然后有另一个定义*hidden* `F`，它会产生类似的效果。例如：

```
module L = List
[0 .. 9] |> L.map ((*) 2) // Uses functional `List.map`

module L = Seq    
[0 .. 9] |> L.map ((*) 2) // Uses lazy `Seq.map` 
```

我同意在许多情况下这将是一个有用的功能 - 另一方面，F# 编程风格与 ML 有很大不同，因此来自 Effective ML talk 的建议可能不会直接映射到 F# 编程。如果您*需要*进行本地定义，那么最好的选择是将其定义为 F# 对象。

# cocos2d-iphone - Cocos2d-iphone v2 和 RestKit

> ID：12665499
> 
> 赞同：0
> 
> 时间：2012-09-30T22:00:39.503
> 
> 标签：cocos2d-iphone, xcode4.3, restkit

我尝试将 RestKit（通过 CocoaPods）安装到我的 Cocos2d 项目中。一切正常，但是当我尝试构建我的项目时，我在 github 上遇到了 38 个 libPods.a 错误，他们告诉我这是我的选项有问题。我应该在“搜索路径”的所有子选项中设置 $(inherited)。我做到了，但除此之外，我还有`<myproject>/libs/kazmath/include`Header **Search Paths**和**User Header Search Paths** [[screen screenshots]](http://www.dropmocks.com/mBlV20)。当我删除这些留置权并只留下 $(inherited) 然后构建失败，因为“找不到 kazmath.h”。`<myproject>/libs`

 **有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T20:46:31.313

永远不要忘记构建整个工作区，如果你只构建一个项目，没有 pod，它只能在 iOS 设备上工作。**

# android - Camera SetPreviewCallback 将 YUV 转换为 RGB 的最佳方法

> ID：12665502
> 
> 赞同：0
> 
> 时间：2012-09-30T22:01:03.017
> 
> 标签：android, android-camera, rgb

`camera.takePicture`我正在使用此代码在调用后将图像写入 SD ：

```
protected String doInBackground(byte[]... jpeg) {
    File directory=new File(Environment.getExternalStorageDirectory() + "/" + getString(R.string.qpw_picture_path) + "/" + getString(R.string.qpw_picture_title) + "_" + initialTime);
    directory.mkdirs();
    String currentTime = new SimpleDateFormat(getString(R.string.qpw_date_format)).format(new Date());
    File photo = new File (directory, getString(R.string.qpw_picture_title) + "_" + currentTime + "_" + current + ".jpg");
    current++;

    if (photo.exists()) {
        photo.delete();
    }

    try {
        FileOutputStream fos=new FileOutputStream(photo.getPath());         
        fos.write(jpeg[0]);
        fos.flush();
        fos.close();
    }
    catch (java.io.IOException e) {
    }

    new ImageMediaScanner(getBaseContext(), photo);
    return(null);
} 
```

在这种情况下工作正常，但是当我使用相同的代码从中写入图像时`camera.setPreviewCallback`，我最终会在 SD 上得到 450KB 损坏的图像，这些图像无法使用甚至打开。

任何帮助或建议将不胜感激。

**编辑：**

看来数据应该先从YUV转换成RGB再保存。在尝试了在 Google 和 SO 上找到的众多代码示例之一后，我再也没有遇到任何问题。

有谁知道最好的方法是什么？在速度、内存分配、CPU...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T10:05:25.317

以防万一有人在同样的问题上偶然发现[这篇 SO 帖子](https://stackoverflow.com/questions/12469730/confusion-on-yuv-nv21-conversion-to-rgb?lq=1)很好地总结了我正在寻找的内容。

# linux - 从文件脚本错误添加用户帐户

> ID：12665506
> 
> 赞同：-3
> 
> 时间：2012-09-30T22:01:20.657
> 
> 标签：linux, bash

> **可能重复：**
> [Linux 脚本从 Excel 中提取信息以创建用户](https://stackoverflow.com/questions/12664630/linux-script-extract-information-from-excel-to-create-users)

需要从 excel 电子表格创建用户，在第 ​​8 行和第 13 行的脚本中出现一些错误

第 8 行 Unexpected EOF，同时寻找匹配的 `'' 第 13 行语法错误，文件意外结束

```
#!bin/bash
echo $(pwd)/employeesdata.xls
Path=$($pwd)/employeesdata.xls
read Path
if [ -e $Path ];
then
Username= [ grep $(Username) $Path | cut -f1 -d `]'
Password= [ grep $(Password) $Path | cut -f2 -d `]'
useradd -- b $Username
echo $Password | /usr/bin/passwd --stdin $Username
fi
exit 
```

Excel 文件包含此信息和其他信息

```
Name (field1) EmployeeID (field2)    Phone             Address      
Joe Blow      22500033               156-454-3322       101 main 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:39:22.603

我认为你必须重构一些东西：

```
#!bin/bash
echo $(pwd)/employeesdata.xls
Path="$(pwd)/employeesdata.xls"
read Path
if [ -e "$Path" ]; then
    Username=$(grep "$Username" "$Path" | cut -f1 -d ' ')
    Password=$(grep "$Password" "$Path" | cut -f2 -d ' ')
    useradd -- b $Username
    echo "$Password" | /usr/bin/passwd --stdin "$Username"
fi
exit 
```

几点注意事项：

1.  引用您分配给变量的值（有时这不是必需的，但对于开始它有助于避免一些问题）
2.  引用变量的用法，除非您知道自己在做什么。在不明确引用它的情况下，该变量可以为命令/函数生成各种参数。
3.  `$(cmd)`执行命令`cmd`并用命令的输出替换它的出现。
4.  `$var`或`${var}`用名为的变量的内容替换自己`var`
5.  `"quoting $a"`，假设变量`a`contains`string`作为其内容，生成字符串`quoting string`。
6.  `'quoting $a'`，独立于变量`a`，生成字符串`quoting $a`。
7.  尽管对于新手来说可能会令人困惑，但`[`实际上是`test`命令的“别名”，可用于比较字符串、整数，并进行一些基本测试，例如检查权限或文件是否存在。`]`实际上只是一个语法要求，只是为了通知命令它的参数已经结束（当调用 .
8.  我假设你的分隔符是一个空格，但我可能是错的。

希望这会有所帮助=)

# javascript - Spidermonkey 和 getElementsByTagName

> ID：12665507
> 
> 赞同：0
> 
> 时间：2012-09-30T22:01:24.697
> 
> 标签：javascript, getelementsbytagname, spidermonkey

我想拥有`getElementsByTagName`一个支持 Spidermonkey 的系统。我在哪里可以找到该功能的源代码，或者如何使用 Spidermonkey 获得该功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T07:14:54.077

我添加了这样的内容：

```
Element.prototype.getElementsByTagName = function(tagName) {
    var elements = [];
    for (var child = this.firstElementChild; child != null; child = child.nextElementSibling) {
        if (child.localName === tagName) {
            elements.push(child);
        }
        elements.pushArray(child.getElementsByTagName(tagName));
    }
    return elements;
} 
```

# jquery - 消除 Windows Phone 7 中的点击突出显示？

> ID：12665511
> 
> 赞同：5
> 
> 时间：2012-09-30T22:01:45.630
> 
> 标签：jquery, css, windows-phone-7, windows-mobile

我正在构建一个移动 Web 应用程序，但我在使用 Windows Phone 7 时遇到了我在 Android 或 iOS 上没有的问题。该应用程序在 Mobile IE 中运行良好，但由于我使用的是 JQuery（相对）新的 .on() 方法，因此我得到了奇怪的点击突出显示效果，这使得使用该应用程序有点烦人。

示例：我有一个消息列表，例如 twitter 或电子邮件客户端（Android/iOS 样式）中的消息列表，我的 JS 代码如下所示：

```
$('#conversation_list').on('click', '.conversation', function () {
    // show all the messages in a conversation
}); 
```

最终发生的是*整个*顶级选择器（在本例中为#conversation_list）被突出显示（并且通常会在一两秒钟内保持突出显示）。我认为这可能会使一些用户感到困惑，因为即使您可能正在点击您想要的元素，也不会有这种感觉。

有什么办法可以避免这种情况，或者只是关闭 WinPhone IE 中的点击突出显示？我在 iOS 和 Android 浏览器中成功使用了 -webkit-tap-highlight-color ，但它似乎在这里不起作用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-15T17:01:23.390

对于 WP8，他们增加了支持：

```
<meta name="msapplication-tap-highlight" content="no"/> 
```

资料来源： [http ://sgrebnov.blogspot.de/2012/10/windows-phone-8-for-html5js-developers.html](http://sgrebnov.blogspot.de/2012/10/windows-phone-8-for-html5js-developers.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T05:12:56.223

请参阅此相关问题：

[Windows Phone 7 浏览器 - 单击链接时关闭灰色阴影](https://stackoverflow.com/questions/6378008/windows-phone-7-browser-turn-off-the-gray-shading-when-links-are-clicked)

没有内置支持删除此突出显示。但是，已经提出了一些解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T02:30:36.387

我认为你在这里不走运。WP7 不支持 tap-highlight-color。您可能可以使用 IE10 压力支持，但不能使用 WP7

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-15T09:26:58.547

您可以使用 CSS 在特定元素上禁用 IE 10 中的点击突出显示

-ms-touch-action：无；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-12T13:29:19.980

正如 Lepi 所说，使用：

```
-ms-touch-action: none; 
```

在 CSS 文件的按钮部分 &

```
$(".button").click( onTouchstart ); 
```

在你的 JS 文件中触发你的 onTouchstart() 函数

# php - 将数据从一个 php 生成的表单传递到另一个

> ID：12665517
> 
> 赞同：0
> 
> 时间：2012-09-30T22:02:18.600
> 
> 标签：php, forms, postgresql, post

使用 php 我正在从 PostgreSQL 系统生成一个表。用户需要能够选择删除表中的一行，所以我创建了一个“删除？” 表格最后一列中的按钮选项。

该按钮如下所示：

```
 echo '<td> <input type="submit" name="'.$row['language'].'" value="Delete?" class="odd" />'; 
```

因此，该按钮获得了具有该行语言的名称属性。

我有两个问题： 1\. 最重要的是，我不知道如何访问这个字段。最初我想我可以通过 POST 获取它，例如 name = _$POST['name']，但我需要“语言”字段来获取与该行对应的特定按钮。希望您理解...为了澄清，在打印出查询之前不会生成 html 属性名称。然后我需要知道 name 属性才能在 delete.php 中访问它。

1.  即使我可以从按钮中获取要删除的语言的名称，也可能在数据库中可能存在具有其他属性的其他同名语言，因此我不希望在执行删除时删除这些语言声明，这意味着我需要来自表的特定行的更多信息。那么我将如何传递更多信息？

我一直在考虑隐藏字段，但我不确定如何生成所有信息以及如何将其传递给我的 delete.php 文件。

如果您也有任何其他建议，尽管我愿意接受。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:06:35.657

最常见的解决方案是放在最后一列的链接中，传递您要在该链接中删除的行的 ID。

链接如下所示：

`<a href="delete.php?id=rowid>delete</a>`

不要使用 sumbit，因为每个行 id 都需要不同的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:33:02.993

您的表是否有一个自动递增的主键并且是一个整数？如果是这样，您可以简单地将其`id`字段用于`name`属性。因此，如果您的表格如下所示：

```
id | language
---+---------
 1 | English
 2 | French
 3 | C
 4 | にほんご
 5 | foobar 
```

您的输出的一行可能如下所示：

```
echo '<td><input type="submit" name="'.$row['id'].'" value="Delete?" /></td>'; 
```

不过，这取决于表单的目标。预计可以删除和编辑吗？创建一个带有 GET 数据的链接，然后提示确认，这样更简洁，更不容易被滥用。

# php - 显示裁剪的图像

> ID：12665518
> 
> 赞同：-1
> 
> 时间：2012-09-30T22:02:40.593
> 
> 标签：php, crop, php-gd

我正在使用一个脚本来帮助用户上传他们的个人资料图像，然后裁剪它们以选择方便的位置 我对未显示的 PNG 和 GIF 图像有疑问 这是裁剪文件代码，请修改它以便制作它能够显示 PNG 、 JPF 和 GIF 图像

```
<?php
 sleep(1);
 $url = $_GET['url'];
 $type = $_GET['type'];
 if ($type='jpg') {
    if(file_exists($url) AND preg_match('/^[a-z0-9\/_\-.]+$/i',$url)){
$width  =   (isset($_GET['width'])  AND preg_match('/^[0-9]{2,}$/', $_GET['width']))    ? $_GET['width']    : 300;
$height =   (isset($_GET['height']) AND preg_match('/^[0-9]{2,}$/', $_GET['height']))   ? $_GET['height']   : 300;
$left   =   (isset($_GET['left'])   AND is_numeric($_GET['left']))  ? $_GET['left']     : 0;
$top    =   (isset($_GET['top'])    AND is_numeric($_GET['top']))       ? $_GET['top']      : 0;
header ("Content-type: image/jpg");
$src    =   @imagecreatefromjpeg($url);
$im     =   @imagecreatetruecolor($width, $height);
imagecopy($im,$src,0,0,-$left,-$top,$width,$height);
imagejpeg($im,"",300);
imagedestroy($im);}}

    elseif ($type='png') {

     if(file_exists($url) AND preg_match('/^[a-z0-9\/_\-.]+$/i',$url)){
$width  =   (isset($_GET['width'])  AND preg_match('/^[0-9]{2,}$/', $_GET['width']))    ? $_GET['width']    : 300;
$height =   (isset($_GET['height']) AND preg_match('/^[0-9]{2,}$/', $_GET['height']))   ? $_GET['height']   : 300;
$left   =   (isset($_GET['left'])   AND is_numeric($_GET['left']))  ? $_GET['left']     : 0;
$top    =   (isset($_GET['top'])    AND is_numeric($_GET['top']))       ? $_GET['top']      : 0;
header ("Content-type: image/png");
$src    =   @imagecreatefrompng($url);
$im     =   @imagecreatetruecolor($width, $height);
imagecopy($im,$src,0,0,-$left,-$top,$width,$height);
imagepng($im,"",300);
imagedestroy($im);
     }
      }
     ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:07:53.157

您必须检查输入文件的格式，然后调用支持的函数。

如果输入文件是 jpeg，则调用`imagecreatefromjpeg`和`imagejpeg`.
如果输入文件是 png，则调用`imagecreatefrompng`和`imagepng`.
如果输入文件是 gif，则调用`imagecreatefromjpeg`和`imagegif`.

# mysql - 有没有办法将 DB 用户密码传递到命令行工具 mysqladmin 中？

> ID：12665522
> 
> 赞同：110
> 
> 时间：2012-09-30T22:03:26.867
> 
> 标签：mysql, windows, windows-server-2008, mysqladmin

我目前使用以下内容，但它总是提示我手动输入密码。启动可执行文件时有什么方法可以在命令行上传递它？

```
mysqladmin processlist -u root -p 
```

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2012-09-30T22:06:44.967

才知道答案......

```
mysqladmin processlist -u root -pYOURPASSWORDHERE 
```

您的密码和 -p 之间没有空格

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-09-30T22:06:44.023

尝试：

```
--password=PasswordTextHere 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2019-02-17T11:34:35.883

这应该有效：`mysql -uroot -p'password'`

如果您尝试自动化 mysql 解决方案，您可以使用变量中的密码：

`mysql_pass=$(sudo grep -oP "temporary password is generated for root@localhost: \K(.*)" /var/log/mysqld.log)`

`mysql -uroot -p"$mysql_pass" < somescript.sql`

# ruby-on-rails - 设计身份验证 - devise_error_messages！在视图中导致“nil:NilClass 的未定义方法‘错误’

> ID：12665527
> 
> 赞同：1
> 
> 时间：2012-09-30T22:04:00.127
> 
> 标签：ruby-on-rails, exception, devise, registration

设计错误消息！鉴于原因

```
undefined method 'errors' for nil:NilClass 
```

在方法之后`render :new`。`create`这开始发生在我从“Devise::RegistrationsController”而不是“ApplicationController”继承 RegistrationsController 之后。“新”方法的初始呈现不会导致任何异常。

覆盖注册控制器：

```
class RegistrationsController < Devise::RegistrationsController
  def create
    begin
      raise I18n.t("registration_disabled") unless registration_enabled?
      ....................
    rescue => ex
      flash[:alert] = ex.message
      render :new
    end
  end
end 
```

视图registrations/new.html.erb：

```
<h2><%= I18n.t("sign_up_title") %></h2>

<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
    <%= devise_error_messages! %>

    <div><%= f.label :login, I18n.t("the_login") %> <span class="mandatory">*</span><br />
      <%= f.text_field :login %></div>

    <div><%= f.label :password, I18n.t("password") %> <span class="mandatory">*</span><br />
      <%= f.password_field :password %></div>

    <div><%= f.label :password_confirmation, I18n.t("password_confirmation") %> <span class="mandatory">*</span><br />
      <%= f.password_field :password_confirmation %></div>

    <div><%= f.submit from_admin? ? I18n.t("sign_up_other") : I18n.t("sign_up") %></div>
    <p class="mandatory">* - <%= I18n.t("mandatory_fields") %></p>
<% end %>

<%= render "devise/links" %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:37:50.670

我相信这是因为您在创建对象（设计称之为资源）之前引发了异常。[devise_error_messages](https://github.com/plataformatec/devise/blob/master/app/helpers/devise_helper.rb)助手需要它。

如果要阻止访问注册，还有其他方法可以实现：

一种方法可能是：

```
class RegistrationsController < Devise::RegistrationsController
  def create
    if registration_enabled?
      super
    else
      flash[:alert] = I18n.t("registration_disabled")
      redirect_to action: :new
    end
  end
end 
```

我不是 100% 确定这是否可行，但这个想法是如果用户无法注册，则使用 flash 渲染视图，因此这将表现为“初始渲染”

编辑：其实我相信改变你的

```
render action: :new 
```

到

```
redirect_to action: :new 
```

将足以防止错误，因为 redirect_to 将执行方法，而渲染仅渲染关联视图。

# c# - 解决 C# 的困难

> ID：12665530
> 
> 赞同：1
> 
> 时间：2012-09-30T22:05:11.623
> 
> 标签：c#, goto

为什么会出现以下编译器错误：

> //错误 CS0159: 没有这样的标签 'lbl_proc_20'

使用以下代码：

```
//JUST A DUMMY CODE TO ILLUSTRATE THE CONCEPT
int a = resultOfFunction1();
int b = resultOfFunction2();

//10+ Local variables that are calculated depending on the results above

if (a < 10)
{
    switch (b)
    {
        case 0:
            //Actions for A<10, B=0, using local variables
            break;
        case 1:
            double c = someFunction(a, b);  //In real code involves calculations based on a and b
            if(c > 10.0)
                goto lbl_proc_20;   //error CS0159: No such label 'lbl_proc_20' within the scope of the goto statement

                    //Actions for A<10, B=1, using local variables
            break;
        default:
            //Actions for A<10, B=Other, using local variables
            break;
    }
}
else if (a < 20)
{
lbl_proc_20:
    switch(b)
    {
        case 0:
            //Actions for A<20, B=0, using local variables
            break;
        case 1:
            //Actions for A<20, B=1, using local variables
            break;
        case 2:
            //Actions for A<20, B=2, using local variables
            break;
        default:
            //Actions for A<20, B=Other, using local variables
            break;
    }
}
else if (a < 30)
{
    switch(b)
    {
        case 0:
            //Actions for A<30, B=0, using local variables
            break;
        case 1:
            //Actions for A<30, B=1, using local variables
            break;
        case 2:
            //Actions for A<30, B=2, using local variables
            break;
        default:
            //Actions for A<30, B=Other, using local variables
            break;
    }
} 
```

为什么我会收到 goto 语句错误以及如何使其工作？

**编辑：**更改示例以说明实际代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-30T22:08:52.200

您只能使用`goto`跳转到 . 范围内的标签`goto`。从描述错误的[文档](http://msdn.microsoft.com/en-us/library/hak1fc9d%28v=vs.80%29.aspx)`CS0159`中：

> **在 goto 语句的范围内**找不到 goto 语句引用的标签。

虽然标签存在，但你不能跳出一个`if`块进入一个`else`块。其中的代码`else`与包含`goto`.

是时候重组你的代码了，这样它就不需要`goto`.

**编辑**

您应该尝试简化您的逻辑。多个函数优于`goto`语句。

您可能要考虑的一种选择是[Windows Workflow Foundation](http://msdn.microsoft.com/en-us/library/dd489441.aspx)。这是一个非常简洁的工具，可让您以流程图的形式直观地表示您的逻辑。然后 WWF 将生成处理您指定的逻辑所需的代码。这可能会起作用，因为看起来您正在创建某种类型的有限状态机或类似过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T23:07:55.900

作为对“如何在没有 goto 的情况下进行操作”的回应

```
bool pretendA20 = false;

if (a < 10)
{
    switch (b)
    {
        case 0:
            //Actions for A<10, B=0, using local variables
            break;
        case 1:
            double c = someFunction(a, b);  //In real code involves calculations based on a and b
            if(c > 10.0)
            {
                //goto lbl_proc_20;   
                pretendA20 = true;
                break;
             }

             //Actions for A<10, B=1, using local variables

            break;
        default:
            //Actions for A<10, B=Other, using local variables
            break;
    }
}

if ((a >= 10 && a < 20) || pretendA20)
{
//lbl_proc_20:
    switch(b)
    { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T23:02:25.370

C# 语言规范（第 8 章，第 249 页）指出：

> 如果当前函数成员中不存在具有给定名称的标签，或者 goto 语句不在标签范围内，则会发生编译时错误。此规则允许使用 goto 语句将控制转移出嵌套范围，但不能转移到嵌套范围内。

在您的情况下，标签`lbl_proc_20`与 the 不在同一范围内，`goto`并且您正试图将控制权转移到另一个嵌套范围内。

您可以从这里获取语言规范：

> [http://www.microsoft.com/en-us/download/details.aspx?id=7029](http://www.microsoft.com/en-us/download/details.aspx?id=7029)

# jquery - 如何检测元素的字体系列何时更改

> ID：12665531
> 
> 赞同：0
> 
> 时间：2012-09-30T22:05:11.843
> 
> 标签：jquery, html

使用 JQuery，一旦 HTML 元素的字体系列发生变化，有没有办法引发事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:19:32.130

尝试这个

```
var fontf= $('div').css('font-family');
myfunc(); 
function myfunc(){
 if(fontf != $('div').css('font-family'))
    alert('changed');
 else setTimeout(myfunc,1000);
} 
```

# spring - wicket spring hibernate 开始

> ID：12665532
> 
> 赞同：3
> 
> 时间：2012-09-30T22:05:14.027
> 
> 标签：spring, hibernate, maven, wicket, maven-archetype

我正在寻找一个架构类型来创建一个基于

*   检票口 6.0.0
*   春天 3.2
*   Hibernate 4（基于注释）

我看到的所有示例（我一直在寻找最后 4 小时）都有不同的版本，当我尝试在第 4 个错误之后逐步更改版本时，我开始使用另一个原型，因为花费的时间很长。

如果有人使用最后一个有一个基础的“得到陈述”项目，我希望你能告诉我如何去做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-05T00:26:22.097

运行 mvn achetype:generate -Dfilter=wicket

**org.xaloon**（我的列表中的第 7 位）中有一个使用spring **/jpa/wicket**。您可以使用 JPA 语义（Spring Data？）配置/使用 Hibernate，或调整原型。也许[这](http://www.jumpingbean.co.za/hibernate-4.0.1-pom.xml)会有所帮助。

# jquery - Twitter Bootstrap：单击按钮时出现内容，但内容应显示在“悬停”上 - 请问有什么问题？

> ID：12665533
> 
> 赞同：0
> 
> 时间：2012-09-30T22:05:28.770
> 
> 标签：jquery

使用 W3C Bootstrap popover 教程，我得到了以下代码。使用 Visual Studio，网页运行良好；但是，内容“为我的网站创建一个工具栏非常简单！” 应该在按钮悬停时显示（如这里的第一个演示：http: [//www.w3resource.com/twitter-bootstrap/popover-tutorial.php](http://www.w3resource.com/twitter-bootstrap/popover-tutorial.php)）

但是，它没有 - 你必须点击按钮 - 为什么悬停不起作用？

我的项目根目录中有这三个文件：

```
<script src="js/jquery.js"></script>  
<script src="js/bootstrap-tooltip.js"></script>  
<script src="js/bootstrap-popover.js"></script> 
```

我尝试添加这样的触发器：

```
{ $("#example").popover({trigger: 'hover'});, 
```

但是，这也不起作用。

请问我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T21:22:15.250

排序：Twitter Bootstrap 或 W3C 弹出框教程中没有提到我应该访问“js/bootstrap-popover.js”文件并将点击触发器更改为悬停以使悬停工作。

我偶然打开了 JS/bootstrap-popover.js 并注意到了这段代码：

```
 $.fn.popover.defaults = $.extend({}, $.fn.tooltip.defaults, {
    placement: 'right',
     trigger: 'click' 
```

因此，我将触发器更改为悬停：

```
trigger: 'hover' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:38:52.027

**HTML**

```
<a href="#" id="example" class="btn large primary" rel="popover">hover for popover</a> 
```

**JAVASCRIPT**

```
var img = '<img src="" />';

$("#example").popover({ title: 'Look! A bird!', content: img });​​​ 
```

* * *

示例暴露于：http: [//jsfiddle.net/weuWk/](http://jsfiddle.net/weuWk/)

现在适应你的问题！！

# .net - 防止 IIS 在任务结束之前杀死它

> ID：12665536
> 
> 赞同：10
> 
> 时间：2012-09-30T22:05:53.980
> 
> 标签：.net, iis, task-parallel-library

我正在构建一个将所有内容存储在 Azure 表中的日志库。写入该表显然需要很多时间（从不超过 1 秒，但仍然太多让用户等待），所以 Log 方法返回一个 LogResult 实例，这里是类

```
public class LogResult
{
    public string Id { get; set; }
    public Task LoggingTask { get; set; }

    public LogResult(string id, Task task)
    {
        Id = id;
        LoggingTask = task;
    }
} 
```

这是 Log 方法如何完成的

```
return new LogResult(id, Task.Factory.StartNew(() => 
    DoLogInAzure(account, id, exception, request))
); 
```

为调用者提供等待它完成的选项（例如，如果它是控制台应用程序）。我面临的问题是 IIS在返回用户响应之前*不应该*等待它......如果我不等待它，IIS 并不*总是*执行任务。这个想法是向用户显示一条消息“......如果您与我们联系，请务必提及您的问题编号，XXX”，并且不要让他等到写入日志条目。

有没有办法强制 IIS 等到任务完成，即使它返回了响应？我想我可能需要编写一个异步接收请求的 Windows 服务，但看起来只是添加一个日志条目需要做很多工作......特别是如果我可以强制 IIS 等待它。

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-30T23:03:10.463

[Phil Hack的这篇文章](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)讨论了在 ASP.NET 应用程序中运行后台任务。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-01-10T13:11:15.677

感谢 Damian Schenkelman 和 Phil Haack 的博客文章，我找到了问题和解决方案。问题是 IIS 在需要处理新请求时会重用线程。而且由于它不知道我的任务正在做一些工作，所以它重用了那个线程（这是有道理的）。然后，我只需要通知 IIS 我正在使用该线程并且它不能被重用（因此，它必须重用另一个线程，创建一个新线程，或者让它等待）。我最终使用了我自己的 TaskFactory 来处理任务创建，并在 IIS 中自动注册一个通知程序。为了完整起见，为了帮助与我有同样问题的其他人，并阅读其他建议，这就是我所做的

```
public class IISNotifier : IRegisteredObject
{
    public void Stop(bool immediate)
    {
        // do nothing, I only run tasks if I know that they won't
        // take more than a few seconds.
    }

    public void Started()
    {
        HostingEnvironment.RegisterObject(this);
    }

    public void Finished()
    {
        HostingEnvironment.UnregisterObject(this);
    }
} 
```

进而

```
public class IISTaskFactory
{
    public static Task StartNew(Action act)
    {
        IISNotifier notif = new IISNotifier();
        notif.Started();
        return Task.Factory.StartNew(() => {
            act.Invoke();
            notif.Finished();
        });
    }
} 
```

现在，当我想启动一个日志任务时，我只是做

```
return new LogResult(id, IISTaskFactory.StartNew(() => 
    DoLogInAzure(account, id, exception, request))
); 
```

[您可以在https://github.com/gmc-dev/IISTask](https://github.com/gmc-dev/IISTask)查看（并下载代码）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T02:22:31.537

信息还不够，但我怀疑它可能与 GC 和引用有关，如果它在您等待任务时有效。出于您的目的，更好的方法是使用 ETW (EventProvider) 并为每个请求设置 ActivityId。只需配置一个 ETW 会话就可以将所有消息重定向到一个文件。您可以向最终用户显示 ActivityId（一个 Guid）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-18T16:05:01.330

很抱歉没有将此添加为评论，我没有足够的代表。

[https://msdn.microsoft.com/en-us/library/system.web.hosting.iregisteredobject(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.web.hosting.iregisteredobject(v=vs.110).aspx)

> 应用程序只能有一个注册类型的实例。

这似乎表明 Gervasio Marchand 接受的答案有些不正确，因为每次调用他的静态辅助方法都会创建一个新的 IISNotifier，它是一个 IRegisteredObject。

# xamarin.ios - MonoTouch：仅当我启用调试时才会部署临时构建

> ID：12665546
> 
> 赞同：1
> 
> 时间：2012-09-30T22:07:07.030
> 
> 标签：xamarin.ios, provisioning-profile

我有一个应用程序，我在过去 2 年从 MonoDevelop 部署。该应用程序有 2 个具有不同捆绑 ID 的版本，因此有 2 个配置文件。以前我已经切换了捆绑 ID，部署了，一切都很好。

在 MonoDevelop/MonoTouch (3.0.4.7/6.0.2) 的最新升级之后，对于使用 LLVM 构建且未启用调试的临时构建，我无法再使用它了。由于开发时间长，不知道是Monodevelop/MonoTouch变化还是我的项目变化引起的。

奇怪的是，如果我检查发布版本的“启用调试”，一切都部署得很好。然后它会记录一条警告说“冲突--debug 和--llvm 选项。软调试被禁用。” 这似乎表明启用调试选项无效？

所以问题是：如果我在发布版本上启用调试，为什么应用程序只能正确部署到设备？

就第 3 方内容而言，唯一的变化是我们从此处添加了新的 Admob 绑定： [https](https://github.com/dalexsoto/AlexTouch.GoogleAdMobAds) ://github.com/dalexsoto/AlexTouch.GoogleAdMobAds ，但据我所知，这些不需要包含任何特殊参数在发布版本中。

我在没有调试的情况下压缩了一个分发版本并发送给 Apple 以供批准，但我认为它与我的临时版本存在相同的问题，因此将被拒绝。希望一些 Mono 大师对此有所了解！

这是完整的日志，包括安装和首次启动：

```
 Sep 30 23:58:23 Christer-sin-iPhone librariand[5904] <Error>: client process 619 does not have a valid com.apple.developer.ubiquity-container-identifiers entitlement
    Sep 30 23:58:24 Christer-sin-iPhone ubd[5905] <Notice>:
    Sep 30 23:58:27 Christer-sin-iPhone librariand[5904] <Notice>: MMe quota status changed: under quota
    Sep 30 23:58:28 Christer-sin-iPhone installd[5365] <Error>: 0x2ffa2000 handle_uninstall: Uninstall requested by SpringBoard
    Sep 30 23:58:28 Christer-sin-iPhone installd[5365] <Error>: 0x2ffa2000 MobileInstallationUninstall_Server: Uninstalling com.myapp
    Sep 30 23:58:29 Christer-sin-iPhone ubd[5905] <Error>: Sep 30 23:58:29  SecTrustEvaluate  [leaf AnchorTrusted]
    Sep 30 23:58:30 Christer-sin-iPhone installd[5365] <Error>: 0x30b000 filter_attributes: Info.plist keys requested via MobileInstallationLookup/Browse in client Xcode (via mobile_installation_proxy) were not found in MobileInstallation's cache. Please file a bug requesting that these keys be added: <CFBasicHash 0x1e5851c0 [0x3b76a100]>{type = mutable set, count = 18,
    entries =>
    0 : <CFString 0x3b7569f4 [0x3b76a100]>{contents = "CFBundlePackageType"}
    1 : <CFString 0x1e57a800 [0x3b76a100]>{contents = "BuildMachineOSBuild"}
    2 : <CFString 0x3b757a44 [0x3b76a100]>{contents = "CFBundleResourceSpecification"}
    3 : <CFString 0x1e57b060 [0x3b76a100]>{contents = "DTPlatformBuild"}
    4 : <CFString 0x3b754794 [0x3b76a100]>{contents = "DTCompiler"}
    5 : <CFString 0x3b756564 [0x3b76a100]>{contents = "CFBundleSignature"}
    6 : <CFString 0x3b757224 [0x3b76a100]>{contents = "DTSDKName"}
    7 : <CFString 0x1e5782a0 [0x3b76a100]>{contents = "NSBundleResolvedPath"}
    8 : <CFString 0x3b753eb4 [0x3b76a100]>{contents = "UISupportedInterfaceOrientations"}
    10 : <CFString 0x3b75be84 [0x3b76a100]>{contents = "DTXcode"}
    13 : <CFString 0x3b75beb4 [0x3b76a100]>{contents = "CFBundleInfoDictionaryVersion"}
    16 : <CFString 0x3b759304 [0x3b76a100]>{contents = "CFBundleSupportedPlatforms"}
    17 : <CFString 0x1e57b0a0 [0x3b76a100]>{contents = "DTXcodeBuild"}
    18 : <CFString 0x1e5782c0 [0x3b76a100]>{contents = "UIStatusBarTintParameters"}
    19 : <CFString 0x3b757e54 [0x3b76a100]>{contents = "DTPlatformVersion"}
    20 : <CFString 0x3b75abf4 [0x3b76a100]>{contents = "DTPlatformName"}
    21 : <CFString 0x3b75bc84 [0x3b76a100]>{contents = "CFBundleDevelopmentRegion"}
    22 : <CFString 0x1e57b080 [0x3b76a100]>{contents = "DTSDKBuild"}
    }
    Sep 30 23:58:31 Christer-sin-iPhone mobile_installation_proxy[5908] <Error>: 0x3c390b88 MobileInstallationSlowLookupBreak: MobileInstallationBrowse was called without specifying an options dictionary containing kLookupReturnAttributesKey. This usage is inefficient and may cause performance problems. Break on MobileInstallationSlowLookupBreak to debug.
    Sep 30 23:58:31 Christer-sin-iPhone mobile_installation_proxy[5908] <Error>: 0x3c390b88 MobileInstallationSlowLookupBreak: Existing options dictionary: <CFBasicHash 0x1cd81790 [0x3b76a100]>{type = mutable dict, count = 1,
    entries =>
    0 : <CFString 0xa51a0 [0x3b76a100]>{contents = "RequestProxiedFor"} = <CFString 0x1cd818f0 [0x3b76a100]>{contents = "mtouch"}
    }
    Sep 30 23:58:38 Christer-sin-iPhone installd[5365] <Error>: 0x2ffa2000 handle_install: Install of "/var/mobile/Media/PublicStaging/NDC2010.app" requested by mobile_installation_proxy
    Sep 30 23:58:38 Christer-sin-iPhone installd[5365] <Error>: 0x2ffa2000 MobileInstallationInstall_Server: Installing app com.myapp
    Sep 30 23:58:39 Christer-sin-iPhone installd[5365] <Error>: Sep 30 23:58:39  SecTrustEvaluate  [leaf CriticalExtensions IssuerCommonName]
    Sep 30 23:58:41 Christer-sin-iPhone timed[5457] <Notice>: (Note ) CoreTime: Received timezone "Europe/Oslo" from "Location"
    Sep 30 23:58:41 Christer-sin-iPhone timed[5457] <Notice>: (Note ) CoreTime: Current mcc: '242' simulated:'0'.
    Sep 30 23:58:41 Christer-sin-iPhone timed[5457] <Notice>: (Note ) CoreTime: Not setting time zone to Europe/Oslo from Location
    Sep 30 23:58:42 Christer-sin-iPhone installd[5365] <Error>: 0x2ffa2000 MobileInstallationInstall_Server: Staging: 0.43s; Waiting: 0.00s; Installation: 4.41s; LS Sync: 0.12s; Overall: 4.96s
    Sep 30 23:58:42 Christer-sin-iPhone kernel[0] <Debug>: launchd[5911] Builtin profile: syncdefaultsd (sandbox)
    Sep 30 23:58:44 Christer-sin-iPhone installd[5365] <Error>: 0x2ffa2000 filter_attributes: Info.plist keys requested via MobileInstallationLookup/Browse in client Xcode (via mobile_installation_proxy) were not found in MobileInstallation's cache. Please file a bug requesting that these keys be added: <CFBasicHash 0x1e692820 [0x3b76a100]>{type = mutable set, count = 18,
    entries =>
    0 : <CFString 0x3b7569f4 [0x3b76a100]>{contents = "CFBundlePackageType"}
    1 : <CFString 0x1e58c4a0 [0x3b76a100]>{contents = "BuildMachineOSBuild"}
    2 : <CFString 0x3b757a44 [0x3b76a100]>{contents = "CFBundleResourceSpecification"}
    3 : <CFString 0x1e578200 [0x3b76a100]>{contents = "DTPlatformBuild"}
    4 : <CFString 0x3b754794 [0x3b76a100]>{contents = "DTCompiler"}
    5 : <CFString 0x3b756564 [0x3b76a100]>{contents = "CFBundleSignature"}
    6 : <CFString 0x3b757224 [0x3b76a100]>{contents = "DTSDKName"}
    7 : <CFString 0x1e5761a0 [0x3b76a100]>{contents = "NSBundleResolvedPath"}
    8 : <CFString 0x3b753eb4 [0x3b76a100]>{contents = "UISupportedInterfaceOrientations"}
    10 : <CFString 0x3b75be84 [0x3b76a100]>{contents = "DTXcode"}
    13 : <CFString 0x3b75beb4 [0x3b76a100]>{contents = "CFBundleInfoDictionaryVersion"}
    16 : <CFString 0x3b759304 [0x3b76a100]>{contents = "CFBundleSupportedPlatforms"}
    17 : <CFString 0x1e578240 [0x3b76a100]>{contents = "DTXcodeBuild"}
    18 : <CFString 0x1e57a970 [0x3b76a100]>{contents = "UIStatusBarTintParameters"}
    19 : <CFString 0x3b757e54 [0x3b76a100]>{contents = "DTPlatformVersion"}
    20 : <CFString 0x3b75abf4 [0x3b76a100]>{contents = "DTPlatformName"}
    21 : <CFString 0x3b75bc84 [0x3b76a100]>{contents = "CFBundleDevelopmentRegion"}
    22 : <CFString 0x1e578220 [0x3b76a100]>{contents = "DTSDKBuild"}
    }
    Sep 30 23:59:14 Christer-sin-iPhone NDC2010[5915] <Warning>: MonoTouch: Failed to open /private/var/mobile/Applications/38C5A938-BBDF-4BCD-AD25-1220671DDF63/NDC2010.app/MonoTouchDebugConfiguration.txt
    Sep 30 23:59:14 Christer-sin-iPhone kernel[0] <Debug>: launchd[5915] Builtin profile: container (sandbox)
    Sep 30 23:59:14 Christer-sin-iPhone kernel[0] <Debug>: launchd[5915] Container: /private/var/mobile/Applications/38C5A938-BBDF-4BCD-AD25-1220671DDF63 (sandbox)
    Sep 30 23:59:15 Christer-sin-iPhone NDC2010[5915] <Warning>: Application windows are expected to have a root view controller at the end of application launch
    Sep 30 23:59:15 Christer-sin-iPhone NDC2010[5915] <Critical>: Terminating runtime due to unhandled exception
    Sep 30 23:59:16 Christer-sin-iPhone ReportCrash[5917] <Notice>: Formulating crash report for process NDC2010[5915]
    Sep 30 23:59:16 Christer-sin-iPhone com.apple.launchd[1] (UIKitApplication:com.myapp[0x9886][5915]) <Warning>: (UIKitApplication:com.myapp[0x9886]) Job appears to have crashed: Abort trap: 6
    Sep 30 23:59:16 Christer-sin-iPhone backboardd[52] <Warning>: Application 'UIKitApplication:com.myapp[0x9886]' exited abnormally with signal 6: Abort trap: 6
    Sep 30 23:59:16 Christer-sin-iPhone ReportCrash[5917] <Error>: libMobileGestalt copySystemVersionDictionaryValue: Could not lookup ReleaseType from system version dictionary 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T01:45:57.760

# 更新：

此问题已在最新的[GoogleAdMobAds 绑定中得到修复](https://github.com/dalexsoto/AlexTouch.GoogleAdMobAds)

* * *

是的，您的问题是 Admob 绑定，在发布版本上检索大小时出现问题（谢谢 btw :)），这个类是问题所在 `GADAdSizeCons`，所以做这样的事情

```
var ad = new GADBannerView(GADAdSizeCons.Banner, new PointF(0,0))
{
    AdUnitID = "Your Id",
    RootViewController = this
}; 
```

只会崩溃`release builds on real device`，我今天在 Xamarin 上打开了一个关于这个的错误，所以我希望这会很快得到修复:)

# 所以这是解决方法

好的，所以在我们等待时，您需要手动创建`GADSize struct`，例如，如果您需要 iPhone 肖像横幅，您可以这样做

```
GADAdSize gsize = new GADAdSize()
{
    flags = 0,
    size = new System.Drawing.SizeF(320, 50)
};

var ad = new GADBannerView(gsize, new PointF(0,0))
{
    AdUnitID = "Your Id",
    RootViewController = this
}; 
```

这是值

> **横幅：** **标志**：0 **尺寸**：{Width= **320** , Height= **50** }
> 
> **FullBanner：** **标志**：0 **尺寸**：{Width= **468** , Height= **60** }
> 
> **排行榜：** **标志**：0 **大小**：{Width= **728** , Height= **90** }
> 
> **MediumRectangle：** **标志**：0 **尺寸**：{Width= **300** , Height= **250** }
> 
> **摩天大楼：** **标志**：0 **尺寸**：{Width= **120** , Height= **600** }

此解决方法的缺点是您只能创建上述尺寸，如果您尝试创建一个`Custom Size`，您将不会收到广告

希望这可以帮助

亚历克斯

# orm - Symfony2/Doctrine2 ManyToMany DQL“没有关联命名”错误

> ID：12665548
> 
> 赞同：0
> 
> 时间：2012-09-30T22:07:16.610
> 
> 标签：orm, symfony, doctrine-orm

我正在尝试进行 DQL 查询，这一直给我这个错误：

```
[Semantical Error] line 0, col 68 near 'r': Error: Class Custom\SystemBundle\Entity\Element has no association named CustomAuthBundle:Role 
```

这些实体的代码如下所示：

角色：

```
 /**
 * @ORM\ManyToMany(targetEntity="Custom\SystemBundle\Entity\Element", mappedBy="role_id")
 */
 private $element_id; 
```

元素：

```
/**
 * @ORM\ManyToMany(targetEntity="Custom\AuthBundle\Entity\Role", inversedBy="element_id")
 */
private $role_id; 
```

这是查询：

```
php app/console doctrine:query:dql 'SELECT e FROM CustomSystemBundle:Element e JOIN e.CustomAuthBundle:Role r' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:14:51.587

1.  你定义你的*对象*模型，所以没有`role_id`or的地方`element_id`。对象将存储在那里，而不是它们的标识符。所以`abc_id`→ `abc`。
2.  关联由*属性*定义，而不是类名：

    ```
    […] JOIN e.role r […] 
    ```

# javascript - 未捕获的类型错误：无法调用未定义的方法“Runme”

> ID：12665554
> 
> 赞同：-4
> 
> 时间：2012-09-30T22:08:22.753
> 
> 标签：javascript

我已经对此进行了一段时间的错误检查，但我仍然无法弄清楚出了什么问题。它应该记我的成绩，并吐出我的零用钱。它以前可以工作，但是 JSfiddle 把它搞砸了，现在它遇到了其他问题。谁能告诉我出了什么问题？代码：

```
<head>
<script>
alert('loaded');
function Runme() {
    alert("running");
    document.forms["form"].Runme();
    var Mathematics = document.personal.Mathematics;
    var OMathematics = document.personal.OMathematics;
    var Sci = document.personal.Sci;
    var OSci = document.personal.OSci;
    var ELA = document.personal.ELA;
    var OELA = document.personal.OELA;
    var SS = document.personal.SS;
    var OSS = document.personal.OSS;
    var Elec1 = document.personal.Elec1;
    var OElec1 = document.personal.OElec1;
    var Elec2 = document.personal.Elec2;
    var OElec2 = document.personal.OElec2;
    var Elec3 = document.personal.Elec3;
    var OElec3 = document.personal.OElec3;
    var Elem1 = document.personal.Elec1;
    var OElem1 = document.personal.OElec1;
    var Elem2 = document.personal.Elec2;
    var OElem2 = document.personal.OElec2;
    var Elem3 = document.personal.Elec3;
    var OElem3 = document.personal.OElec3;
    var Owed = 0;
    var Calc = function(n, o) {
        if (n >= 90) {
            Owed = Owed + 1;
            if (n >= 95) {
                Owed = Owed + 1;
            }
        }
        else if (owed >= 80) {
            Owed = Owed + 0.5;
        }
        if (n > o) {
            Owed = Owed + 0.5;
        }
        if (n < o) {
            if (n > 95) {
                Owed = Owed - 0.25;
            }
        }
    };
    Calc(Mathematics, OMathematics);
    Calc(Sci, OSci);
    Calc(ELA, OELA);
    Calc(SS, OSS);
    Calc(Elec1, Elec1);
    Calc(Elec2, Elec2);
    Calc(Elec3, Elec3);
    Calc(Elem1, Elem1);
    Calc(Elem2, Elem2);
    Calc(Elem3, Elem3);
    alert(Owed);
};
</script>
</head>
<body>
<center>
<h1>Grade Calculator</h1>
<!--form name="form" action="grades.pl" onsubmit="return checkscript()"-->
<h5>Math</h5><input type=text size=20 name=Mathematics>
<h5>Old Math</h5><input type=text size=20 name=OMathematics>
<h5>Science</h5><input type=text size=20 name=Sci>
<h5>Old Science</h5><input type=text size=20 name=OSci>
<h5>English</h5><input type=text size=20 name=ELA>
<h5>Old English</h5><input type=text size=20 name=OELA>
<h5>Social Studies</h5><input type=text size=20 name=SS>
<h5>Old Social Studies</h5><input type=text size=20 name=OSS>
<h5>Elective One</h5><input type=text size=20 name=Elec1>
<h5>Old Elective One</h5><input type=text size=20 name=OElec1>
<h5>Elective Two</h5><input type=text size=20 name=Elec2>
<h5>Old Elective Two</h5><input type=text size=20 name=OElec2>
<h5>Elective Three</h5><input type=text size=20 name=Elec3>
<h5>Old Elective Three</h5><input type=text size=20 name=OElec3>
<h5>Elem One</h5><input type=text size=20 name=Elec3>
<h5>Old Elem One</h5><input type=text size=20 name=OElec3>
<h5>Elem Two</h5><input type=text size=20 name=Elec3>
<h5>Old Elem Two</h5><input type=text size=20 name=OElec3>
<h5>Elem Three</h5><input type=text size=20 name=Elec3>
<h5>Old Elem Three</h5><input type=text size=20 name=OElec3>
</form>
<br/>
<input type="button" value="Submit and Calculate" onClick="Runme()"/>
</center>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:12:32.347

嗯，首先你需要一个`<form>`元素，它显然已经被注释掉了。

其他注意事项：
确保始终使用相同的案例。“欠”！=“欠”。
onClick 应该是“onclick”，尽管大多数浏览器都允许它工作。

```
<head>
<script>
    //alert('loaded');
function Runme() {
    //    alert("running");
    //document.forms["personal"].Runme();
    var Mathematics = document.personal.Mathematics;
    var OMathematics = document.personal.OMathematics;
    var Sci = document.personal.Sci;
    var OSci = document.personal.OSci;
    var ELA = document.personal.ELA;
    var OELA = document.personal.OELA;
    var SS = document.personal.SS;
    var OSS = document.personal.OSS;
    var Elec1 = document.personal.Elec1;
    var OElec1 = document.personal.OElec1;
    var Elec2 = document.personal.Elec2;
    var OElec2 = document.personal.OElec2;
    var Elec3 = document.personal.Elec3;
    var OElec3 = document.personal.OElec3;
    var Elem1 = document.personal.Elec1;
    var OElem1 = document.personal.OElec1;
    var Elem2 = document.personal.Elec2;
    var OElem2 = document.personal.OElec2;
    var Elem3 = document.personal.Elec3;
    var OElem3 = document.personal.OElec3;
    var Owed = 0;
    var Calc = function(n, o) {
        if (n >= 90) {
            Owed = Owed + 1;
            if (n >= 95) {
                Owed = Owed + 1;
            }
        }
        else if (Owed >= 80) {
            Owed = Owed + 0.5;
        }
        if (n > o) {
            Owed = Owed + 0.5;
        }
        if (n < o) {
            if (n > 95) {
                Owed = Owed - 0.25;
            }
        }
    };
    Calc(Mathematics, OMathematics);
    Calc(Sci, OSci);
    Calc(ELA, OELA);
    Calc(SS, OSS);
    Calc(Elec1, Elec1);
    Calc(Elec2, Elec2);
    Calc(Elec3, Elec3);
    Calc(Elem1, Elem1);
    Calc(Elem2, Elem2);
    Calc(Elem3, Elem3);
    alert(Owed);
};
</script>
</head>
<body>
<center>
<h1>Grade Calculator</h1>
<form name="personal" action="grades.pl">
<h5>Math</h5><input type=text size=20 name=Mathematics>
<h5>Old Math</h5><input type=text size=20 name=OMathematics>
<h5>Science</h5><input type=text size=20 name=Sci>
<h5>Old Science</h5><input type=text size=20 name=OSci>
<h5>English</h5><input type=text size=20 name=ELA>
<h5>Old English</h5><input type=text size=20 name=OELA>
<h5>Social Studies</h5><input type=text size=20 name=SS>
<h5>Old Social Studies</h5><input type=text size=20 name=OSS>
<h5>Elective One</h5><input type=text size=20 name=Elec1>
<h5>Old Elective One</h5><input type=text size=20 name=OElec1>
<h5>Elective Two</h5><input type=text size=20 name=Elec2>
<h5>Old Elective Two</h5><input type=text size=20 name=OElec2>
<h5>Elective Three</h5><input type=text size=20 name=Elec3>
<h5>Old Elective Three</h5><input type=text size=20 name=OElec3>
<h5>Elem One</h5><input type=text size=20 name=Elec3>
<h5>Old Elem One</h5><input type=text size=20 name=OElec3>
<h5>Elem Two</h5><input type=text size=20 name=Elec3>
<h5>Old Elem Two</h5><input type=text size=20 name=OElec3>
<h5>Elem Three</h5><input type=text size=20 name=Elec3>
<h5>Old Elem Three</h5><input type=text size=20 name=OElec3>
</form>
<br/>
<input type="button" value="Submit and Calculate" onclick="Runme()"/>
</center>

</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:12:03.243

> ```
> document.forms["form"].Runme(); 
> ```

会失败，因为没有这种形式，而且`Runme`无论如何它也没有方法。

> ```
> document.personal... 
> ```

将失败，因为没有这样的事情。

尝试摆脱对虚假表单的引用，并替换所有使用

```
document.personal.inputName 
```

和

```
document.getElementsByName("inputName")[0].value 
```

# android - Gps 状态启用/禁用广播接收器

> ID：12665558
> 
> 赞同：19
> 
> 时间：2012-09-30T22:09:21.570
> 
> 标签：android

我正在尝试注册广播接收器以在 gps 状态更改时接收更新。

但是，当 gps 状态从启用更改为禁用时，我的 GpsChangeReceiver onReceive 方法似乎没有被调用，反之亦然。

首先，我正在注册接收者：

```
GpsChangeReceiver m_gpsChangeReceiver = new GpsChangeReceiver();
this.registerReceiver(m_gpsChangeReceiver, new IntentFilter(LocationManager.PROVIDERS_CHANGED_ACTION)); 
```

然后，我有我的 GPS 接收器

```
public class GpsChangeReceiver extends BroadcastReceiver
{   
  @Override
  public void onReceive( Context context, Intent intent )
  {
    final LocationManager manager = (LocationManager) context.getSystemService( Context.LOCATION_SERVICE );
    if (manager.isProviderEnabled( LocationManager.GPS_PROVIDER ) ) {
        //do something
    }
    else
    {
        //do something else
    }
  }
} 
```

最后，我的清单包含：

```
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /> 
```

当我从手机的设置中修改其状态时，任何人都可以看到为什么永远不会调用 gps 接收器吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-10-21T15:04:19.223

在 Android 中有**两种注册广播接收器的方法：**

1.  在代码中（你的情况）
2.  在 AndroidManifest.xml 中

让我解释一下不同之处。

## 案例1（代码中注册的广播接收器）

只要您注册接收器的**上下文处于****活动**状态，您就只会收到广播。因此，当**活动**或**应用程序**被**终止时** *（取决于您注册接收器的位置）*，您**将不再接收**广播。

**我猜你在活动上下文**中注册了广播接收器，这不是很好的方法。如果您想为您的**应用程序上下文**注册广播接收器，您可以执行以下操作：

```
getApplicationContext().registerReceiver(m_gpsChangeReceiver, new IntentFilter(LocationManager.PROVIDERS_CHANGED_ACTION)); 
```

## 案例2（AndroidManifest.xml中注册的广播接收器）

即使您的应用程序被**杀死**，您**也会收到广播***（系统会唤醒您的应用程序*）。**无论**您的应用程序是否**正在运行**，当您想要接收广播时，这是正确的方法。

 *******将此接收器添加到您的 AndroidManifest.xml：

```
<receiver android:name="com.yourpackage.NameOfYourBroadcastReceiver">
  <intent-filter>
    <action android:name="android.location.PROVIDERS_CHANGED" />
  </intent-filter>
</receiver> 
```

**编辑：** 一些特殊的广播*（即 SCREEN_ON 或 SCREEN_OFF）*必须在代码中注册*（案例 1）*，否则它们将不会传送到您的应用程序。*******

# c++ - 从共享对象中的位置创建类对象

> ID：12665563
> 
> 赞同：0
> 
> 时间：2012-09-30T22:10:09.380
> 
> 标签：c++, shared-libraries, dynamic-linking, shared-objects

在 C 中，您可以通过 dlopen() 动态链接共享对象，并使用 dlsym() 定位特定符号（函数）的地址并将其分配给函数指针。

在 C++ 中，如果你碰巧知道类构造函数的地址，你能从中创建一个新对象吗？我确实意识到，使用将返回类对象的静态方法是 C++ 中动态链接的惯例。

我很好奇是否可以从构造函数地址创建对象。如果是这样，你能举个例子吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:21:21.153

你不能。问题是不能直接调用构造函数；所有构造函数调用都是由编译器隐式生成的。这也意味着您不能通过函数指针调用它。

我也只是尝试获取构造函数的地址，但这也不起作用（尽管这只是一个快速破解，不能确定它是否真的有效）——因为构造函数没有返回类型，下一个问题将是如何编写该函数指针的类型。

# c# - Program.cs 中的 log4net

> ID：12665564
> 
> 赞同：1
> 
> 时间：2012-09-30T22:10:23.717
> 
> 标签：c#, winforms, log4net

我刚刚通过添加引用、将配置添加到 App.config 和 AssemblyInfo.cs 中的加载条目，在我的 C# WinForms 应用程序中设置了 log4net。配置设置为捕获所有级别。

在我的 Program.cs 中，我试图让它捕获每一个错误。

我目前有这个：

```
 static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        private static readonly ILog log = LogManager.GetLogger(typeof(Program));
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            try
            {
                log.Info("this works");
                Application.Run(new Forms.Main());
            }
            catch (Exception e)
            {
                log.Info("nothing here", e);
            }
        }
    } 
```

我将“this works”放入只是为了测试我是否可以实际写入日志文件，这就是日志中显示的内容：

```
2012-09-30 23:00:53,959 [INFO ] - this works 
```

我的 log4net 也设置为写入即时窗口，所以我故意创建了一些错误，这就是我在窗口中看到的内容：

```
ContractManagement.Program: 2012-09-30 23:08:09,177 [INFO ] - this works
A first chance exception of type 'System.Data.SqlServerCe.SqlCeException' occurred in System.Data.SqlServerCe.dll 
```

我本来希望在日志中也看到第二个错误，但没有任何迹象:(

* * *

根据基思尼古拉斯的评论，我这样做了：

```
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    log.Info("this works");
    throw new System.ArgumentException("Keith Nicholas Test");
    //Application.Run(new Forms.Main());

} 
```

并且日志文件显示：

```
2012-09-30 23:19:12,090 [INFO ] - this works
System.ArgumentException: Keith Nicholas Test
   at ContractManagement.Program.Main() in c:\ContractManagement\ContractManagement\Program.cs:line 25 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:20:04.303

```
A first chance exception of type 'System.Data.SqlServerCe.SqlCeException' occurred in System.Data.SqlServerCe.dll 
```

这不是您的 log4net 配置的问题。其中一个内部库引发了异常，然后将其捕获，因此它永远不会出现在您的 catch 子句中。开发环境将捕获到的异常信息直接写到即时窗口中。

是的 log4net 正在写入即时窗口，但并非即时窗口中的所有内容都来自 log4net。

[更新 - 反映记录多个线程的更一般问题]

虽然与您的问题没有直接关系，但有时使用 log4net 日志记录的类可以同时在不同的线程中执行。您可以同时从多个线程获取调试、信息和/或错误方法。建议您更新 App.config 中的消息模式以包含线程，以便您可以跟踪哪个消息来自哪个线程。例如：

```
<conversionPattern value="%level %thread %logger - %message%newline" /> 
```

这只是一个示例 - 您没有包含您的转换模式，所以我不确定如果您要添加 %thread.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:14:17.167

如果从一个新线程抛出一个异常，它不会被那个 catch 块捕获......

只是为了证明您的日志记录工作正常：-

而不是运行您的应用程序，只需在第一个 log.Info 之后立即抛出一个新的异常，以证明您的异常日志记录有效。

喜欢 ：-

```
try
{
    log.Info("this works");
    throw new System.ArgumentException("Keith Nicholas Test");
}
catch (Exception e)
{
   log.Info("nothing here", e);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T23:28:14.727

很多谷歌搜索后，我有：

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    private static readonly ILog log = LogManager.GetLogger(typeof(Program));
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
        Application.ThreadException += new System.Threading.ThreadExceptionEventHandler(Application_ThreadException);
        AppDomain.CurrentDomain.FirstChanceException += FirstChanceHandler;

        Application.Run(new Forms.Main());
    }

    private static void Application_ThreadException(object sender, ThreadExceptionEventArgs e)
    {
        log.Info(e.Exception.Message);
    }

    private static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
    {
        log.Info(e);
    }

    static void FirstChanceHandler(object source, FirstChanceExceptionEventArgs e)
    {
        log.Info(e.Exception.Message);
    }
} 
```

这捕获了我希望捕获的 FirstChanceExceptions：

```
2012-10-01 00:24:02,532 9 ContractManagement.Program [INFO ] - The database file cannot be found. Check the path to the database. [ Data Source = C:\ContractManagement\ContractManagement\bin\Debug\ContractManagement.sdf ] 
```

# objective-c - 在代码中调整视图大小不起作用

> ID：12665565
> 
> 赞同：0
> 
> 时间：2012-09-30T22:10:25.683
> 
> 标签：objective-c, ios, xcode, resize

之前只真正使用过 IB 构建器，我在调整对象大小时遇到​​了问题。

我有一个内置代码的主屏幕（不是我的选择），我正在为 ipad 调整它的大小。问题是关于调整大小似乎没有发生任何事情。

```
 - (void)loadView
{
// Create the main view
UIView *mainView = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
mainView.backgroundColor = [UIColor blackColor];

// Add textured background
UIImageView *textureBg = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320.0f, 580.0f)];
textureBg.image = [UIImage imageNamed:@"BgTexture"];
[mainView addSubview:textureBg];

//////////////////////////////////Code addded resize view/////////////////////////////////////////
[textureBg setAutoresizingMask:(UIViewAutoresizingFlexibleHeight| UIViewAutoresizingFlexibleWidth)];

// Add clipboard background
UIImageView *clipBg = [[UIImageView alloc] initWithFrame:CGRectMake(7.0f, 6.0f, 305.0f, 465.0f )];
clipBg.image = [UIImage imageNamed:@"BgHomeNew2"];
clipBg.userInteractionEnabled = YES;

////////////////////////////////////Code addded resize view/////////////////////////////////////////
[clipBg setAutoresizingMask:(UIViewAutoresizingFlexibleBottomMargin| UIViewAutoresizingFlexibleWidth)];

// Add about button to clipbg
UIButton *aboutButton = [UIButton buttonWithType:UIButtonTypeCustom];
aboutButton.frame = CGRectMake(240.0f, 90.0f, 31.0f, 33.0f);
[aboutButton setImage:[UIImage imageNamed:@"LabelButton"] forState:UIControlStateNormal];
[aboutButton addTarget:self action:@selector(aboutButtonPressed:) forControlEvents:UIControlEventTouchUpInside];
[clipBg addSubview:aboutButton];

   // Create array of arrays to hold button image names and their targets
NSMutableArray *buttonsArray = [[NSMutableArray alloc] initWithObjects:
                                    [NSArray arrayWithObjects:
                                         @"BtnNewCert", @"newCertButtonPressed:", nil],
                                    [NSArray arrayWithObjects:
                                         @"BtnContractorDetails", @"contractorDetailsButtonPressed:", nil],
                                    [NSArray arrayWithObjects:
                                         @"BtnSavedCerts", @"savedCertsButtonPressed:", nil],
                                    nil];

// Iterate over the array and create the buttons
CGPoint buttonOrigin = CGPointMake(16.0f, 157.0f);
for (NSArray *buttonArray in buttonsArray) {
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    button.frame = CGRectMake(buttonOrigin.x, buttonOrigin.y, 273.0f, 88.0f);
    [button setBackgroundImage:[UIImage imageNamed:[buttonArray objectAtIndex:0]] forState:UIControlStateNormal];
    [button addTarget:self action:NSSelectorFromString([buttonArray objectAtIndex:1]) forControlEvents:UIControlEventTouchUpInside];
    //[button addTarget:self action:@selector(playButtonSound) forControlEvents:UIControlEventTouchUpInside];
    buttonOrigin.y += 98.0f;
    [clipBg addSubview:button];
}

[mainView addSubview:clipBg];

// Add more apps button
DebugLog(@"Adding more apps button");
UIButton *moreAppsButton = [UIButton buttonWithType:UIButtonTypeCustom];
moreAppsButton.frame = CGRectMake(25.0f, 12.0f, 75.0f, 24.0f);
[moreAppsButton addTarget:self action:@selector(moreAppsButtonPressed:) forControlEvents:UIControlEventTouchUpInside];
[moreAppsButton setImage:[UIImage imageNamed:@"BtnMoreApps"] forState:UIControlStateNormal];
[mainView addSubview:moreAppsButton];

// Add cabinet for iPhone5
UIImageView *cabinet = [[UIImageView alloc] initWithFrame:CGRectMake(-2.0f, 445.0f, 324.0f, 128.0f )];
cabinet.image = [UIImage imageNamed:@"Cabinet2"];
[mainView addSubview:cabinet];
[mainView bringSubviewToFront:cabinet];

self.view = mainView; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:05:33.743

这是预期的行为。什么都不需要调整大小。您使用屏幕边界初始化主视图。因此，无论是在 iPhone 还是 iPad 上，它都会直接获取设备的屏幕尺寸，并且在旋转或您以编程方式更改主视图的框架之前不会调整其尺寸。iOS 无法理解您希望`textureBg`在 iPhone 上达到 320 点，如果在 iPad 上则延长。
您需要计算需要适应屏幕尺寸的视图的框架。并且您应该避免使用像 320 等固定大小，而更喜欢诸如`self.view.bounds.size.width`. 在您需要适应 iPad 的情况下，它将节省您的时间。

# php - 在 php 代码执行应有的操作之前，需要双击按钮

> ID：12665566
> 
> 赞同：-1
> 
> 时间：2012-09-30T22:10:40.403
> 
> 标签：php, html

好的，这就是问题所在，在我的网站左侧有一个区域，它在每个网页上都显示：**您以“用户”身份登录，**然后是注销按钮。当有人按下注销按钮时，该人将被注销。但是，即使表单已提交并且此人已注销，**您仍以“用户”身份登录。**第二次按下注销后，它会删除消息+按钮。

这是代码：

```
<?php 

    if ($_SESSION['login']== "OK") { 
    echo "Je bent ingelogd als ".$_SESSION['Gebruiker']."<br/>";
    ?>
    <form action='' method='post'><input type='submit' name='btnLogout' value='Logout'></form>
    <?php
    if (isset($_POST['btnLogout'])){
        $_SESSION['login']= "";

        }
    }
  ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:13:26.073

在输出用户是否登录*之前*，您需要检查 $_POST 。

```
<?php 

if (isset($_POST['btnLogout']))
    $_SESSION['login']= "";

if ($_SESSION['login']== "OK")
{
    echo "Je bent ingelogd als ".$_SESSION['Gebruiker']."<br/>";
?>
<form action='' method='post'><input type='submit' name='btnLogout' value='Logout'></form>
}
?> 
```

# java - 在 Java 小程序中导入图像

> ID：12665567
> 
> 赞同：0
> 
> 时间：2012-09-30T22:10:43.403
> 
> 标签：java, image, applet, japplet

我正在尝试创建一个加载 52 张卡片的小程序，将它们洗牌（使用随机数生成器），然后以两排五张的形式显示牌组的前 10 张卡片。我有包含 52 张卡片图像的 HTML 文件，但是有没有一种方法可以加载图像而无需加载每个单独的图像。以及如何从网络加载图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:44:42.837

> ..有没有办法加载图像而不必加载每个单独的图像

将它们放在一个巨大的图像中，并在运行时对其进行切片。[这个答案](https://stackoverflow.com/a/10862262/418556)中有一个例子。

![](../Images/3dc90ceea9490208da0a4059c2068b99.png)

在 Google 图片中搜索“playing+card”，很可能在点击的第一页中会有 2 个或更多的图块集。

但是，更快的是加载：

1.  卡片背景
2.  `Image`或**`Shape`**每个花色符号
3.  `Image`或**`Font`**为字母和数字。

然后在启动时将它们组合起来，形成 52 张卡片中的每一张。

显然，卡片还需要一个共同的“反面”。

> 你如何从网上加载图像？

通过网址。

一些替代方案：

1.  [`Applet.getImage(URL)`](http://docs.oracle.com/javase/7/docs/api/java/applet/Applet.html#getImage%28java.net.URL%29)
2.  [`Toolkit.getImage(URL)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Toolkit.html#getImage%28java.net.URL%29)
3.  或用于同步加载的`BufferedImage`使用[`ImageIO.read(URL)`](http://docs.oracle.com/javase/7/docs/api/javax/imageio/ImageIO.html#read%28java.net.URL%29)

前两种方法是异步的并且需要一个`ImageObserver`.

考虑将其作为使用[Java Web Start 启动](https://stackoverflow.com/tags/java-web-start/info)的应用程序来执行。如果您继续使用小程序，请浏览[小程序信息中的链接。页](https://stackoverflow.com/tags/applet/info)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:55:26.683

尝试这个。

```
Image[] cards = new Image[52]

private void loadImages(){
    for (int i=0; i<cards.length; i++){
        URL imgUrl = getClass().getResource("image"+(i+1));
        cards[i] = getImage(imgUrl);
    }
} 
```

希望这可以帮助

# php - 更新所有列值的合计值的 sql 语句

> ID：12665569
> 
> 赞同：0
> 
> 时间：2012-09-30T22:11:14.680
> 
> 标签：php, mysql

我的博客网站帖子有许多不同的类别；我也有总帖子数，怎么写一个sql语句把总帖子数=中的条目更新为我不同类别的总和的个数？

这是我到目前为止所拥有的

```
$blog_number_update = "UPDATE `blog_categories` SET `posts_counter` = '(total of all other rows with an number greater then 0 in the posts_counter column)' WHERE `name` = 'Number'" 
```

这个怎么写？

（posts_counter 列中数字大于 0 的所有其他行的总数）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T08:09:42.773

我认为将计数器及其总和存储在同一个表中并不是一个好主意。为此类统计信息单独设置一个表会更明智（并且仅当动态计算它们太慢时）。

这是一种绕过 MySQL 的限制的方法，即`WHERE`当您在子查询中不使用同一个表时`UPDATE`：

```
UPDATE
        ( SELECT SUM(posts_counter) AS counter_sum
          FROM blog_categories 
          WHERE posts_counter > 0 
            AND ( name <> 'Number' OR name IS NULL ) 
        ) AS s 
    CROSS JOIN 
        blog_categories AS b
SET
    b.posts_counter = s.counter_sum
WHERE 
    b.name = 'Number' ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:30:35.127

您可以使用子查询组合这些查询。

就像是

```
 UPDATE `blog_categories` SET `posts_counter` =(SELECT SUM(posts_counter) FROM blog_categories WHERE posts_counter>0) WHERE `name` = `value` 
```

应该可以正常工作。但是，对于大型数据集，这可能会产生一些严重的性能影响。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-30T22:20:29.017

您无法在 MySQL 中更新您从中选择的表 - 所以这在一个查询中是不可能的。

要分两部分进行，您可以

```
SELECT SUM(posts_counter) FROM blog_categories WHERE posts_counter>0 
```

（该`WHERE`子句是多余的，如果那里没有负值），将结果放入 PHP 变量`$posts_counter`中，然后运行

```
UPDATE `blog_categories` SET `posts_counter` = $posts_counter WHERE `name` = 'Number' 
```

# jquery - 将标签转换为href

> ID：12665571
> 
> 赞同：1
> 
> 时间：2012-09-30T22:11:16.603
> 
> 标签：jquery

我有一些看起来像这样的html：

```
<div class="generated">
<p><label for="id_group">Group</label> <select name="group" id=" id_group" tabindex="1">
<option value="" selected="selected"></option>
<option value="1">12S</option>
<option value="2">13S</option>
<option value="3">22SOI</option>
</select></p>
</div> 
```

我想让标签“组”成为一个href。我怎么能用 jQuery 做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T22:13:21.683

尝试：

```
var html = $('label[for="id_group"]').html();
$('label[for="id_group"]').html('<a href="my_link.html">'+html+'</a>'); 
```

注意：这不会用 替换`label`，`a`但它会在元素内插入链接`label`（因此您仍然可以保留表单的`label-input`关系）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T22:16:02.650

对于这个特定的问题：

```
$('label').replaceWith(
    function(i,r) {
        return '<a href="http://example.com/">' + r + '</a>';
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/tUnQX/)。

# python - 为什么我的全局变量不是全局变量？

> ID：12665572
> 
> 赞同：0
> 
> 时间：2012-09-30T22:11:29.593
> 
> 标签：python

我的脚本开头有以下几行：

```
global lotRow
global lotCol 
```

然后，稍后，我使用函数将 lotRow 和 lotCol 设置为字符串。然后，甚至稍后，我执行以下操作：

```
getIDFromAxes(int(lotRow), int(lotCol)) 
```

这给了我：

```
 getIDFromAxes(str(lotRow), str(lotCol))
NameError: global name 'lotRow' is not defined 
```

我让 def() 在最后打印“很多”字符串以确保它们已设置，但由于某种原因我仍然无法访问它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T22:14:30.863

`global`语句不在脚本的开头；它们进入需要访问全局变量的函数内部。所以而不是：

```
global x
x = 0

def increment_x():
    x += 1
    return x 
```

您需要使用：

```
x = 0

def increment_x():
    global x
    x += 1
    return x 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T22:13:03.853

在尝试访问全局变量的函数内部时，您需要使用关键字`global`，否则它将查找本地定义 - 这当然不存在。

* * *

```
global global_variable 
```

```
def set_var ():
  global global_variable

  global_variable = 3

def print_var ():
  global global_variable

  print int(global_variable) 
```

```
set_var   ()
print_var ()

global_variable = 321

print_var () 
```

* * *

**输出：**

```
3
321 
```

# python - 在 Python 中模拟列表

> ID：12665574
> 
> 赞同：6
> 
> 时间：2012-09-30T22:11:45.637
> 
> 标签：python, list, types

我正在使用一个模拟 python 列表的类。当我在没有索引的情况下访问它时，我想将它作为 python list() 返回。

使用普通列表（）：

```
>>> a = [1,2,3]
>>> 一个
[1,2,3]

```

我得到的，基本上是：

```
>>> a = MyList([1,2,3])
>>> 一个
<MyList 对象在 0xdeadbeef>

```

我不知道哪种 dunder 方法（如果有）可以让我自定义这种行为？

我认为它会是 __ 得到 __ ？虽然 list() 没有实现 get/set/delete - 我猜是因为它是内置的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T22:21:42.020

您正在寻找的方法将是`__repr__`。另请参阅[http://docs.python.org/reference/datamodel.html#object。**代表**](http://docs.python.org/reference/datamodel.html#object.__repr__)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-30T22:16:43.653

您应该覆盖`__repr__`类中的方法（也可以选择`__str__`方法），请参阅这篇[文章](https://stackoverflow.com/questions/1436703/difference-between-str-and-repr-in-python)以讨论差异。

像这样的东西：

```
class MyList(object):
    def __repr__(self):
        # iterate over elements and add each one to resulting string 
```

正如评论中所指出的，`str()`调用`__repr__`if`__str__`未定义，但`repr()`不调用`__str__`if`__repr__`未定义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-30T22:27:55.880

一个非常简单的例子：

```
class MyList(object):
    def __init__(self,arg):
       self.mylist = arg
    def __repr__(self):
        return 'MyList(' + str(self.mylist) + ')'
    def __str__(self):
        return str(self.mylist)
    def __getitem__(self,i):
        return self.mylist[i]

a = MyList([1,2,3])
print a
print repr(a)
for x in a:
    print x 
```

输出：

```
[1, 2, 3]
MyList([1, 2, 3])
1
2
3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T22:22:59.297

请允许我回答我自己的问题 - 我相信这是我正在寻找的 __ repr __ 方法。如果我错了，请纠正我。这是我想出的：

```
def __repr__(self):
    return str([i for i in iter(self)]) 
```

# netbeans - 在 netbeans 应用程序关闭之前执行操作——参考 netbeans 退出窗口事件

> ID：12665575
> 
> 赞同：3
> 
> 时间：2012-09-30T22:12:00.487
> 
> 标签：netbeans, java-me, jogl

我正在使用包含渲染画布的主要 TopComponent 的 netbeans 应用程序：

当我关闭应用程序（不是顶部组件）时，会生成一个错误，有时这会导致应用程序关闭后运行一个进程。我研究了一些，我发现这是我正在使用的 mtgame 引擎的问题，但还没有看到任何解决方案。

如果我在关闭应用程序之前手动处理画布，则不会产生错误——我已经通过 topcomponent 附带的 componentClosed() 方法完成了此操作，并且该方法（仅）适用于从 topComponent 中取出。

有没有办法在 topcomponent 之外（或内部）创建一个类来监听与 netbeans 应用程序关闭对应的事件？

我非常感谢任何反馈或建议！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-27T10:01:36.870

请参阅[此常见问题解答条目](http://wiki.netbeans.org/DevFaqAppLifecycleHooks)。让您的模块实现[ModuleInstall](http://bits.netbeans.org/dev/javadoc/org-openide-modules/org/openide/modules/ModuleInstall.html)并覆盖**close**方法。

# windows-runtime - 在 Windows 应用商店应用程序中使用 CollectionViewSource 类

> ID：12665578
> 
> 赞同：0
> 
> 时间：2012-09-30T22:12:21.730
> 
> 标签：windows-runtime

使用 CollectionViewSource 时如何处理集合更改？我只是不知道如何保持排序并让它显示更改而不必再次“手动”设置源。有人请让我摆脱痛苦，让我知道如何以及是否可以这样做=）

# php - jQuery AJAX 和 PHP 缺少 POST 参数

> ID：12665581
> 
> 赞同：2
> 
> 时间：2012-09-30T22:12:45.077
> 
> 标签：php, jquery, ajax, post

我对通过 jQuery 的 AJAX POST 有疑问。这是客户端代码：

```
$.ajax({
    url: 'php/registration_and_login/login.php',
    type: 'post',
    data: {saveConection: saveConection, loginEmail: loginEmail, loginPass: loginPass }
}).always(login); 
```

这是PHP代码：

```
<?php
include '../functions/connection.php';
$link = conenct('localhost', 'root', '', 'w_db');

$saveConection = $_POST['saveConection'];
$loginEmail = $_POST['loginEmail'];
$loginPass = $_POST['loginPass'];

$loginEmail = mysql_real_escape_string($loginEmail);
$loginPass = mysql_real_escape_string($loginPass);
$saveConection = mysql_real_escape_string($saveConection);

$emailResult = mysql_query("SELECT COUNT('id') FROM users WHERE userEmail = '$loginEmail' AND userPass = '$loginPass'") or die('Invalid query:'. mysql_error());
$validation = mysql_result($emailResult, 0);

if($validation) {
    $query1 = mysql_query("SELECT id FROM users WHERE userEmail = '$loginEmail'") or die('Invalid query:'. mysql_error());
    $tmp = mysql_fetch_assoc($query1);
    $id = $tmp['id'];

    session_start();
    $_SESSION['id'] = $id;

    if($saveConection == 'yes'){
        setcookie('login', $loginEmail);
        setcookie('password', $loginEmail);
    }
    echo "true";
}
else {
    echo "false";
}
?> 
```

我收到此错误：

> **注意**：未定义索引：第**5**行**C:...\login.php中的 saveConection**

 **在我看来， 的 POST 没有问题`saveConection`，我也找不到问题所在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T22:22:01.477

对于您的帖子值，您必须在调用页面之前检查它们是否存在...

所以你必须这样做：

```
if(isset($_POST['saveConection']))
   $saveConection = $_POST['saveConection'];

if(isset($_POST['loginEmail']))
   $loginEmail = $_POST['loginEmail'];

if(isset($_POST['loginPass']))
   $loginPass = $_POST['loginPass']; 
```

我希望你明白 ！**

# c++ - 为什么 C++ std::list::clear() 不调用析构函数？

> ID：12665588
> 
> 赞同：9
> 
> 时间：2012-09-30T22:13:30.707
> 
> 标签：c++, list, destructor

看看这段代码：

```
class test
{
    public:
        test() { cout << "Constructor" << endl; };
        virtual ~test() { cout << "Destructor" << endl; };
};

int main(int argc, char* argv[])
{
    test* t = new test();
    delete(t);
    list<test*> l;
    l.push_back(DNEW test());
    cout << l.size() << endl;
    l.clear();
    cout << l.size() << endl;
} 
```

然后，看看这个输出：

```
 Constructor
    Destructor
    Contructor
    1
    0 
```

问题是：为什么不调用列表元素的析构函数`l.clear()`？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-30T22:14:11.900

你的清单是指针。指针没有析构函数。如果你想调用析构函数，你应该尝试`list<test>`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-01T02:19:25.617

使用 释放指针或使用将指针抽象出来的东西（例如智能指针或指针容器）的更好替代方法`delete`是直接在堆栈上创建对象。

你应该更喜欢`test t;`你`test * t = new test();`很少想要处理任何拥有资源的指针，无论是智能的还是其他的。

如果您要使用`std::list`“真实”元素，而不是指向元素的指针，则不会出现此问题。

# java - Java sql ResultSet 没有数据

> ID：12665590
> 
> 赞同：0
> 
> 时间：2012-09-30T22:13:56.220
> 
> 标签：java, sql-server, odbc, resultset

我想从 java 中的 sql 数据库中提取只有一个数据。我尝试使用结果集，但是当我想将第一行提取到一个 int 变量中时，它说结果集没有内容。

这是我的代码

```
try {

            statement = connexion.createStatement();
            statementArtist = connexion.createStatement();
            String artist = "Mac Miller";
            ResultSet resultat = statement.executeQuery("USE albums SELECT Album.numero_artist FROM Album INNER JOIN Artist ON Album.num_artist = Artiste.num_artist where name like '"+artist+"'");    
            int result = resultat.getInt(1); // Here is the problem
            String query = "USE albums INSERT INTO dbo.Album(Album.num_artist, title, price, genre, date, home, image) VALUES("
                    + result
                    + ", '"
                    + title
                    + "', "
                    + price
                    + ", '"
                    + genre
                    + "', '"
                    + date
                    + "', '"
                    + home
                    + "', '"
                    + image
                    + "')";
            statement.executeUpdate(query); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:15:52.297

您应该在结果集上调用`next()`方法来“移动”迭代器：

```
...
ResultSet resultat = statement.executeQuery("USE albums SELECT Album.numero_artist FROM Album INNER JOIN Artist ON Album.num_artist = Artiste.num_artist where name like '"+artist+"'");    
resultat.next();           
int result = resultat.getInt(1); // Here is the problem
... 
```

如果安全性和更好的性能对您的应用程序很重要，您还应该考虑使用准备好的语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:26:12.570

需要使用next()，也要测试结果ie

```
ResultSet resultat = statement.executeQuery("USE albums SELECT Album.numero_artist FROM Album INNER JOIN Artist ON Album.num_artist = Artiste.num_artist where name like '"+artist+"'");    
if (resultat.next()) {
    int result = resultat.getInt(1); // Here is the problem 
```

**'"+artist+"'"**也容易出错，例如，如果艺术家包含引号 "'"，大多数 DB 都会出现 Sql 错误。使用 Sql 参数不支持

# java - NoSuchElementException 问题

> ID：12665591
> 
> 赞同：2
> 
> 时间：2012-09-30T22:14:11.037
> 
> 标签：java, exception, while-loop, java.util.scanner

我想要做的是创建一个while循环，在该循环中运行程序菜单，直到用户输入有效响应。

但是，我创建的扫描仪实例不想打球，并且无论我尝试了什么都会抛出 NoSuchElementExceptions。

```
import java.util.Scanner;

public class Menu
{
    Menu()
    {
        isValid = false;
        uInput = 0;
    }

    public int mMain()
    {
        Scanner in2;

        do
        {           
            in2 = new Scanner(System.in); //For user input

            System.out.println("Please choose from the following options");
            System.out.println("1) Enter Employee Data");
            System.out.println("2) Look Up Employee Information");
            System.out.println("3) Employee Comparison");
            System.out.println("4) Quit");
            uInput = in2.nextInt(); //This is the line throwing the exception.

            if (uInput < 1 || uInput > 4)
            {
                System.out.println("Your choice was not valid, please choose another option.");
            }

            else
            {
                isValid = true;
                in2.close();
            }
        } while (!isValid);

       isValid = false; //reset for next time
       System.out.println("\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"); //Clear screen

       return uInput;       
    }

    int uInput; //For user input
    String uInput2; //for bug fixing
    boolean isValid; //check for valid use input
} 
```

如果需要这里是我的主要方法：

```
public class prg420_w4_commission_program
{
    public static void main(String[] args)
    {       
    //class references
    Processing proc = new Processing();
    Menu menu = new Menu();

    //Set up Variables
    int uInput; //For user input
    boolean uQuit = false; //set up program loop bool

    //Opening message
    System.out.println("Welcome to the Employee Data Entry Creation program.  Please follow the on-screen prompts.");
    System.out.println("");

    proc.initEDatabase(); //initialize employee database

    while (!uQuit)
    {

        uInput = menu.mMain(); //call main menu

        //Check user input
        switch (uInput)
        {
            case 1:
                proc.addEDBEntry(); //add employee entries
                break;

            case 2:
                proc.findEmployee();
                break;

            case 3:
                proc.sortEDBase();
                break;

            case 4:
                uQuit = true;
                break;

            default:
                proc.addEDBEntry();
                break;                      
        }           
    }

    System.out.println("Thank you for using the Employee Data Entry Creation program.");
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:24:04.017

```
in2.close(); 
```

关闭输入流，在第一次成功扫描后`stdin`关闭，每次尝试从其中获取任何内容`Scanner`都会导致 a`NoSuchElementException`被抛出。

# javascript - 调用与内部函数同名的外部函数

> ID：12665595
> 
> 赞同：2
> 
> 时间：2012-09-30T22:14:25.020
> 
> 标签：javascript

对于下面的函数 doStuff，是否可以调用 sayHello（在函数 dostuff 之外），即使它与内部函数同名？

```
var sayHello = function(){
    alert("Called from outside the function");
}
function doStuff(){
    sayHello();
    function sayHello(){
        alert("Called from inside the function. How can I call the sayHello function that is outside the scope of doStuff?");
    }
}
    doStuff();
​ 
```

在上面的 Javascript 代码中，函数 sayHello（这是 2 个函数的名称）是从函数内部而不是外部调用的。

这是在 jsFiddle 上：http: [//jsfiddle.net/5MSTU/](http://jsfiddle.net/5MSTU/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T22:15:34.170

如果外部函数是全局的，您可以将其定位为`window`对象的成员。

```
window.sayHello(); 
```

否则，您将需要使用不同的名称。JavaScript 允许您隐藏变量，因此与外部变量同名的内部变量有效地禁用了对外部变量的访问。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-30T22:25:39.090

--更新以删除此处的纯错误代码--

你可以在前面给它起别名。但我不知道这有多大用处。

```
var sayHello = function(){
    alert("Called from outside the function");
};

var aliasForSayHello = sayHello;

function doStuff() {
    function sayHello(){
        alert("Called from inside the function. How can I call the sayHello function that is outside the scope of doStuff?");
       aliasForSayHello();
    }       

    sayHello();

}

doStuff();

​ 
```

# c++ - 用元组调用可变参数模板函数？

> ID：12665597
> 
> 赞同：0
> 
> 时间：2012-09-30T22:14:40.807
> 
> 标签：c++, c++11, tuples, variadic-templates, variadic-functions

> **可能重复：**
> [如何将元组扩展为可变参数模板函数的参数？](https://stackoverflow.com/questions/687490/how-do-i-expand-a-tuple-into-variadic-template-functions-arguments)

目前，我具有以下形式的功能：

```
template<typename Type, typename... List> 
void myFunction(Type& x, List&... list); 
```

我也有一个元组：

```
std::tuple<int, unsigned int, unsigned long long int, int> myTuple; 
```

是否有可能（如果是，如何？）传递`myTuple`给`myFunction`？

# iphone - XCode 4.5 Storyboard 没有显示我的视图控制器的一些导航栏

> ID：12665598
> 
> 赞同：0
> 
> 时间：2012-09-30T22:14:42.127
> 
> 标签：iphone, ios, xcode, sdk, storyboard

在将 XCode 更新到 4.5 后，我的视图控制器的一些导航栏消失了，它显示的视图控制器小于正常大小。这是我的故事板的图片： ![在此处输入图像描述](../Images/4758d43f1f93a1d90ade18a156d918c0.png)

如您所见，它们比正常尺寸小，甚至比 iPhone 4 还要小。我在导航栏上有一些条形按钮项目，我想对它们进行处理，当我在模拟器上运行应用程序时，它会显示条形按钮或在设备上，但它没有显示在情节提要中。知道如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T22:05:34.100

我认为这是 Xcode 4.5 的一个错误为了解决这个问题，我复制并粘贴了视图控制器并显示了导航栏，然后我删除了旧的视图控制器并将新控制器连接到其余的视图控制器。虽然我解决了这个问题，但我知道这不是解决这个问题的有效方法，如果有人有任何想法通过更好的方法解决它，我将不胜感激。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T05:36:44.577

我为使用 Xcode 4.6 时导航栏从情节提要中消失的情况找到了一种（某种）解决方案。是的，这似乎是 Xcode 中的一个错误。但是，当我单击故事板中将导航控制器链接在一起的各种转场时，我发现故事板导航栏有时会出现（有时会消失）。

同样，我很确定这是一个错误，并且由于某种原因，Xcode 有时会在单击故事板中的 segue 时是否应该显示故事板导航栏感到困惑。只需尝试单击各种 segue，直到您发现导航栏全部出现 - 或者至少出现您当前正在处理的导航栏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-12T11:25:07.153

对我来说也发生了同样的事情，但几个小时后我发现问题很简单：请确保您的 segue 设置为 Push 否则导航栏不会出现！

# c++ - 即使使用睡眠，线程也不会放弃 CPU 时间

> ID：12665601
> 
> 赞同：1
> 
> 时间：2012-09-30T22:14:53.977
> 
> 标签：c++, multithreading, signals

我正在运行这个程序，我有多个线程。三个线程正在为同一个父进程生成信号。有四个处理线程用于处理由信号生成线程生成的信号。我有一个监控线程，它也接收相应的信号和进程。不过，我有一个情况。我可以看到信号分配不均。我的意思是信号被定向到相同的过程。我有四个处理程序线程和一个监视线程等待信号。所以他们中的任何一个人都可以接收到信号。我期待它均匀分布。但是，我可以看到处理程序线程有时会接收到整个信号突发。下一次整个信号突发由监视器线程处理。为什么不统一。在处理程序/监视器线程完成处理一个信号后，我添加了一个睡眠调用。因此，一旦处理程序/监视器完成一个信号，它就应该给另一个机会来处理下一个信号。但是，输出没有显示这种情况

```
#include <pthread.h>
#include <signal.h>
#include <stdlib.h>
#include <iostream>
#include <unistd.h>
#include <sys/types.h>
#include <sys/time.h>
#include <signal.h>
#include <cstdio>
#include <stdlib.h>

#define NUM_SENDER_PROCESSES 3
#define NUM_HANDLER_PROCESSES 4
#define NUM_SIGNAL_REPORT 10
#define MAX_SIGNAL_COUNT 100000

using namespace std;

volatile int usrsig1_handler_count = 0;
int usrsig2_handler_count = 0;
int usrsig1_sender_count = 0;
int usrsig2_sender_count = 0;
int monitor_count = 0;
int usrsig1_monitor_count = 0;
int usrsig2_monitor_count = 0;
double time_1[10];
double time_2[10];
int lock_1 = 0;
int lock_2 = 0;
int lock_3 = 0;
int lock_4 = 0;
int lock_5 = 0;

double timestamp() {
  struct timeval tp;
  gettimeofday(&tp, NULL);
  return (double)tp.tv_sec + tp.tv_usec / 1000000.;
}

void sleepMs(double seconds) {
  usleep((unsigned int)(seconds*1000000));
}

void *senderfunc(void *parm) {
  srand(time(0));
  while(true) {
    int signal_id = rand()%2 + 1;
    if(signal_id == 1) {
      while(__sync_lock_test_and_set(&lock_3,1) != 0) {
      }
      usrsig1_sender_count++;
      lock_3 = 0;
      kill(getpid(), SIGUSR1);
    } else {
      while(__sync_lock_test_and_set(&lock_4,1) != 0) {
      }
      usrsig2_sender_count++;
      lock_4 = 0;
      kill(getpid(), SIGUSR2);
    }

    int r = rand()%10 + 1;
    double s = (double)r/100;
    sleepMs(s);
  }
}

void *handlerfunc(void *parm)
{
  int *index = (int *)parm;
  sigset_t set;
  sigemptyset(&set);
  //cout << (*index) << endl;
  if((*index) % 2 == 0) {
    sigaddset(&set, SIGUSR1);
  } else {
    sigaddset(&set, SIGUSR2);
  }

  int sig;

  while(true) {
    sigwait(&set, &sig);
    //cout << "Handler" << endl;
    if (sig == SIGUSR1) {
      while(__sync_lock_test_and_set(&lock_1,1) != 0) {
      }
      usrsig1_handler_count++;        
      lock_1 = 0;
    } else if(sig == SIGUSR2) {
      while(__sync_lock_test_and_set(&lock_2,1) != 0) {
      }
      usrsig2_handler_count++;
      lock_2 = 0;
    }

    sleepMs(0.0001);
  }

}

void *monitorfunc(void *parm) {

  sigset_t set;
  sigemptyset(&set);

  sigaddset(&set, SIGUSR1);
  sigaddset(&set, SIGUSR2);

  int sig;  

  while(true) {
    sigwait(&set, &sig);
    //cout << "Monitor" << endl;
    if(sig == SIGUSR1) {
      time_1[usrsig1_monitor_count] = timestamp();
      usrsig1_monitor_count++;
    } else if(sig == SIGUSR2) {
      time_2[usrsig2_monitor_count] = timestamp();
      usrsig2_monitor_count++;
    }
    monitor_count++;
    //cout << monitor_count << endl;

    if(monitor_count == NUM_SIGNAL_REPORT) {
      double difference_1 = 0;
      double difference_2 = 0;
      if(usrsig1_monitor_count > 1) {
        for(int i=0; i<usrsig1_monitor_count-1; i++) {
          difference_1 = difference_1 + time_1[i+1] - time_1[i];
        }
        cout << "Interval SIGUSR1 = " << difference_1/(usrsig1_monitor_count-1)<< endl;
      }

      if(usrsig2_monitor_count > 1) {
        for(int i=0; i<usrsig2_monitor_count-1; i++) {
          difference_2 = difference_2 + time_2[i+1] - time_2[i];
        }
        cout << "Interval SIGUSR2 = " << difference_2/(usrsig2_monitor_count-1) << endl;
      }
      cout << "Count SIGUSR1 = " << usrsig1_sender_count << endl;
      cout << "Count SIGUSR2 = " << usrsig2_sender_count << endl; 
      monitor_count = 0;
      usrsig1_monitor_count = 0;
      usrsig2_monitor_count = 0;
    }

    sleepMs(0.001);

  }
}

int main(int argc, char **argv)
{
  if(argc != 2) {
    cout << "Required parameters missing. " << endl;
    cout << "Option 1 = 1 which means run for 30 seconds" << endl;
    cout << "Option 2 = 2 which means run until 100000 signals" << endl;
    exit(0);
  }

  int option = atoi(argv[1]);
  int i;

  pthread_t handlers[NUM_HANDLER_PROCESSES];
  pthread_t generators[NUM_SENDER_PROCESSES];
  pthread_t monitor;

  sigset_t set;
  sigset_t oldset;
  sigemptyset(&oldset);
  sigemptyset(&set);
  sigaddset(&set, SIGUSR1);
  sigaddset(&set, SIGUSR2);

  pthread_sigmask(SIG_BLOCK, &set, &oldset);

  int handler_mask[4] = {0,1,2,3};
  //Initializing the handler threads
  for(i=0; i<NUM_HANDLER_PROCESSES; i++) {
    pthread_create(&handlers[i], NULL, handlerfunc, (void *)&handler_mask[i]);
  }

  pthread_create(&monitor, NULL, monitorfunc, NULL);

  sleep(5);

  for(i=0; i<NUM_SENDER_PROCESSES; i++) {
    pthread_create(&generators[i], NULL, senderfunc, NULL);
  }

  if(option == 1) {
    cout << "Option 1 " << endl;
    //sleep(30);
    while(true){

    }
    exit(0);
  } else {
    while(true) {
      if((usrsig1_handler_count + usrsig2_handler_count) >= MAX_SIGNAL_COUNT) {
        cout << "Count SIGUSR1 = " << usrsig1_handler_count << endl;
        cout << "Count SIGUSR2 = " << usrsig2_handler_count << endl;
        exit(0);
      } else {
        pthread_yield();
      }
    }
  }
} 
```

这是我的输出

```
HandlerHandler

Handler
Handler
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Monitor
Handler
Handler
Handler
Handler
Handler
Handler
Handler
Handler
Handler
Handler 
```

您可以看到监视器的爆发，然后是处理程序的爆发。但是，在代码中，一旦处理程序/监视器处理信号并进行 sigwait，我添加了一个睡眠调用，以便将轮到传递给下一个可用线程。但是，这没有帮助。我猜这应该使它变得统一。但是，显示器仍然会爆裂并打印。即使在监视器中我已经在它完成信号工作后进入睡眠状态

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:19:57.480

你的代码有两个不同的问题给你你看到的结果。

第一个也是最重要的一个是每个线程都分配了一个时间片来运行。这个时间片可以被信号或 IO 中断，而不是线程将运行直到它完成它的时间片。因此，即使您设置了睡眠 - 如果睡眠时间小于该线程的时间片，它也不会将执行转移到其他线程。如果我记得在 Windows 上，这个时间片至少是 5 毫秒，但通常是 40 毫秒（尽管我可能弄错了数字）。在 linux 上，这个时间片可能更短，但对于通用的 linux 机器，我认为是一样的。我曾经使用**Sleep(0)**来放弃 Windows 上的时间片。usleep(0) 也可以这样做。所以你使用睡眠的方式不会做你想做的事。但是，由于您使用的是 pthread，只需调用**pthread_yield**放弃 CPU 或**sched_yield()**这应该是更好的做法，但谁知道......

您在测试输出时可能面临的第二个问题是，您实际上没有直接的方法来控制在多线程环境中输出到流的字符顺序。如果您真的希望输出按顺序排列，您需要实现一个单独的线程来执行输出并使用队列和一些锁定机制（关键部分，互斥锁）或自由锁定机制向 i 发送消息。

希望这能让你朝着正确的方向前进

# c++ - C++ 简单代码。需要找到重复的相邻单词

> ID：12665606
> 
> 赞同：4
> 
> 时间：2012-09-30T22:15:39.123
> 
> 标签：c++

我需要编写代码来检查用户是否两次输入了相同的单词，如果是，它将输出一条消息，说明他们输入了。到目前为止，我有：

```
#include <iostream>

using namespace std;

int main(){

    string previous = "";
    string current = "";

    while (cin>>current); {
        if(current == previous); {
            cout<<"repeated word";
        }
        previous=current;

    }
} 
```

它可以编译，但只要用户两次键入相同的单词，它就不会输出消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T22:20:53.533

如果您注意到，您的代码包含`;`在它不应该包含的地方。例如，如果你把它放在`while (cin >> current)`你想运行的 then 代码之后，就不会。

尝试这个：

```
#include <iostream>

using namespace std;

int main(){

string previous = "";
string current = "";

while (cin>>current)
{
      if(current == previous)
      {
              cout<<"repeated word";
      }
      previous=current;

      }
} 
```

# php - 搜索脚本不起作用

> ID：12665617
> 
> 赞同：0
> 
> 时间：2012-09-30T22:17:11.930
> 
> 标签：php, mysql, database

search.php 页面只是没有获取结果。只要我按下提交，无论我输入什么字符串，我都会得到一个空白页。无法理解为什么！请帮忙

表单工作正常，但不知何故在提交时给了我一个空白页，而不是结果，我哪里出错了？

```
form code

<form name="form" action="../search.php" method="get"> 
        <input name="q" type="text" value="type!" onfocus="this.value=''" />
<input type="submit" name="Submit" value="Search" />
</form>

php code

  <?php

 // Get the search variable from URL
if(isset($_POST['submit']))
{
 $var = $_GET['q'] ;
 $trimmed = trim($var);//trim whitespace from the stored variable

// rows to return

// check for an empty string and display a message.
 if ($trimmed=="")
 {
  echo "<p>Please enter a search...</p>";
 exit;
 }

// check for a search parameter
if (!isset($var))
  {
  echo "<p>We dont seem to have a search parameter!</p>";
  exit;
  }

   //connect to database
   $con=mysql_connect("localhost","",""); //(host, username, password)

  //specify database 
  mysql_select_db("test",$con) or die("Unable to select database"); //select which database we're using

 // Build SQL Query  
 $query = "select * from questions where question like \"%$trimmed%\"  or detail like \"%   $trimmed%\"     or name like \"%$trimmed%\"
 order by name"; // EDIT HERE and specify your table and field names for the SQL query

 $numresults=mysql_query($query);
 $numrows=mysql_num_rows($numresults);

// If we have no results, offer a google search as an alternative

if ($numrows == 0)
  {
 echo "<h4>Results</h4>";
 echo "<p>Sorry, your search: &quot;" . $trimmed . "&quot; returned zero results</p>";

// google
 echo "<p><a href=\"http://www.google.com/search?q=" 
 . $trimmed . "\" target=\"_blank\" title=\"Look up 
 " . $trimmed . " on Google\">Click here</a> to try the 
 search on google</p>";
 }

// next determine if s has been passed to script, if not use 0
 if (empty($s)) {
 $s=0;
 }

   // get results
   $query =  "SELECT * FROM table WHERE question LIKE '%$q%' OR name LIKE '%$q%' or detail like '%$q%'";  
    $result = mysql_query($query) or die("Couldn't execute query");

    // display what the person searched for
     echo "<p>You searched for: &quot;" . $var . "&quot;</p>";

    // begin to show results set
   echo "Results";
   $count = 1 + $s ;

 // display the results returned
  while ($row= mysql_fetch_array($result)) {
  echo "<table  align=center class=lims>";
  echo "<tr>";
  echo "<th bgcolor=#5D9BCC >QUESTIONS</th>";
  echo "<td bgcolor=#FEE9A9>" . $row['question'] . "</td>";

  echo "<tr>";

  echo "<th bgcolor=#5D9BCC>Alias</th>";
  echo "<td bgcolor=#FEE9A9>" . $row['detail'] . "</td>";

 echo "</tr>";

 echo "<tr>";
 echo "<th bgcolor=#5D9BCC>Code</th>";
 echo "<td bgcolor=#FEE9A9>" . $row['name'] . "</td>";
  echo "</tr>";
 $title = $row["name"];

 echo "$count.)&nbsp;$title" ;
 $count++ ;
 }

  $currPage = (($s/10) + 1);

  //break before paging
   echo "<br />";

  // next we need to do the links to other results
  if ($s>=1) { // bypass PREV link if s is 0
  $prevs=($s-$limit);
  print "&nbsp;<a href=\"$PHP_SELF?s=$prevs&q=$var\">&lt;&lt; 
  Prev 10</a>&nbsp&nbsp;";
  }

  // calculate number of pages needing links
  $pages=intval($numrows/10);

 // $pages now contains int of pages needed unless there is a remainder from division

 if ($numrows%10) {
 // has remainder so add one page
 $pages++;
 }

  // check to see if last page
  if (!((($s+$limit)/10)==$pages) && $pages!=1) {

  // not last page so give NEXT link
  $news=$s+10;

  echo "&nbsp;<a href=\"$PHP_SELF?s=$news&q=$var\">Next 10 &gt;&gt;</a>";
  }

  $a = $s + (10) ;
  if ($a > $numrows) { $a = $numrows ; }
   $b = $s + 1 ;
  echo "<p>Showing results $b to $a of $numrows</p>";
  mysql_close($con);
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:18:43.600

POST 键区分大小写。它需要是`if(isset($_POST['Submit']))`

编辑：没关系上面的答案。问题是表单方法是 GET，而您正在尝试使用 $_POST 访问提交密钥。您需要将其更改为`$_GET['Submit']`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:25:14.407

为什么不检查搜索输入的数据是否存在？（由评论请求重新制定:-)）

```
// Get the search variable from URL
if(isset($_GET['q'])) 
```

代替

```
// Get the search variable from URL
if(isset($_POST['submit'])) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:26:35.953

您正在检查`Submit`in `$_POST`，但表单中指定的方法是`GET`。

要让它工作，请将 PHP 代码更改为查找`$_GET['Submit']`.

（但我会将所有内容（包括表单方法）移至`POST`）。

也就是说，您的脚本似乎被粘贴了两次，第二个版本使用`$q`而不是`$trimmed`（已`$q`定义？），以及一个名为“表”而不是“问题”的 SQL 表：

```
// get results
$query =  "SELECT * FROM table WHERE question LIKE '%$q%' OR name LIKE '%$q%' or detail like '%$q%'";  
 $result = mysql_query($query) or die("Couldn't execute query"); 
```

# asp.net-mvc-3 - asp.net mvc 4 webapi 优于传统的 asp.net mvc 3 ajax 调用

> ID：12665620
> 
> 赞同：1
> 
> 时间：2012-09-30T22:17:25.563
> 
> 标签：asp.net-mvc-3, asp.net-mvc-4, asp.net-web-api

我正在测试来自 asp.net mvc 4 的新 web api，我看不出比来自现有 asp.net mvc 3 的当前动作控制器调用有多大优势。

来自 mvc 3 的动作控制器可以以与 web api 非常相似的方式返回 json。

我有 2 个关于 web api 的问题：

1.  我们什么时候应该在标准动作控制器 jsonresults 上使用 web api？
2.  我们如何保护 web api，从不同的平台授予访问权限（授权移动应用程序，pr 其他网站）？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T22:54:42.077

您正在将苹果与橙子进行比较。Web Api 框架已被开发为 WCF 或其他基于 ASP .Net 服务的技术的可行替代品。Web Api 框架并非旨在替代 MVC。回答您的问题

1.  如果您没有公开您的 API 或没有在需要服务的环境中工作（例如支持移动设备和/或不同操作系统的 SOA），您可以使用来自 MVC 控制器的标准动作控制器 json 结果。事实上，没有理由不能在移动设备或不同操作系统上使用“标准”MVC 控制器 JSON 结果，但 Web API 提供了额外有用的功能，例如内容协商和更好的 HTTP 动词处理，这使得它在 SOA 中更有用环境。
2.  通过使用自定义操作过滤器（授权操作过滤器的扩展或完全定制的操作过滤器）来保护 MVC 应用程序的方式相同。在过滤器中，您可以轻松检查 IP 地址的白名单或检查当前 Http 请求的用户代理。

# android - 编译编辑的apk后Android apk安装错误

> ID：12665621
> 
> 赞同：1
> 
> 时间：2012-09-30T22:17:25.453
> 
> 标签：android, testing, certificate, apk, ddms

出于测试目的，我使用 apktool 反编译了一个 apk，修改了 android 清单文件（只需设置 android:debuggable=true）。然后我反编译并签名。在我的手机上安装它时出现以下错误：

```
package com.test.test has no certificates at entry AndroidManifest.xml. ignoring 
```

为什么我看到这个错误，我签了。如果我不更改清单文件，它会在反编译和编译后工作。我猜 android 为每个文件存储单独的证书或 sha1 值。所以以前的和当前的文件不匹配。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:25:00.993

我解决了这个问题，实际上它没有在 manifest.MF 文件中添加 androidmanifest.xml 文件的 sha1 条目。我正在使用 android apk multitool 并使用了错误的命令。现在它正在工作。

# c++ - 如何在opencv中使用matlab c++库绘制点

> ID：12665622
> 
> 赞同：1
> 
> 时间：2012-09-30T22:17:41.867
> 
> 标签：c++, matlab, opencv

我正在使用 opencv 的 matlab 库来使用 matlab 图像并对其执行`HoughCircles`算法。

我想动态创建 matlab 图像而不是`imread`-ing 它们。

使用该图像，我想绘制一组我收集的 x,y 坐标。

我可以通过说来“声明”图像

```
Mat img 
```

但这几乎是我所得到的。我找不到将点绘制到其中的函数。

如果有人有任何见解，我将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:49:48.547

检查[`cv::Mat`文档](http://docs.opencv.org/modules/core/doc/basic_structures.html?highlight=mat#mat-mat)并查看它提供的几个构造函数：

`cv::Mat`要从2D 数组初始化 a ，您可以执行以下操作：

```
float data[2][2] = { {1,3,5,7,9}, {2,4,6,8,10} }; 
cv::Mat img = cv::Mat(2, 5, CV_32FC1, &data); 
```

或者，如果您需要单独访问像素：

*   [访问 cv::Mat](https://stackoverflow.com/q/7860953/176769)（1 通道）中的所有像素
*   [使用opencv](https://stackoverflow.com/a/4505166/176769)（3通道）循环像素
*   [OpenCV 从 Mat 图像中获取像素信息](https://stackoverflow.com/questions/7899108/opencv-get-pixel-information-from-mat-image)（3 通道）
*   [从 OpenCV 中的 Mat / cv::Mat 获取数据](http://jayrambhia.wordpress.com/2012/06/23/get-data-from-mat-cvmat-in-opencv/)（3 通道）
*   [在特定位置（1 和 3 通道）从 cv::Mat 中查找像素颜色](http://answers.opencv.org/question/1870/find-pixel-color-out-of-cvmat-on-specific-position/)（这个站点与 Stackoverflow 非常相似，不是吗？）

您可能还对阅读感兴趣：

*   [用opencv和c++绘制点的最短方法是什么？](https://stackoverflow.com/q/6655413/176769)

# xcode - 如何通过xcode中的代码删除imageview

> ID：12665623
> 
> 赞同：0
> 
> 时间：2012-09-30T22:17:45.610
> 
> 标签：xcode, imageview, cgrect

我的目标是在图像视图到达屏幕一侧时删除它。它应该是一个子弹，当它的 x 值达到某个值时，它会被删除。这是传感器的代码，但一旦达到 120，我希望将其删除：

```
CGRect frame = Image.frame;
if (frame.origin.x>120) {
   NSLog(@"delete");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:24:03.347

要删除图像视图，请执行此操作。

```
[myImageView removeFromSuperview]; 
```

（`myImageView`您的图像视图的名称在哪里）

# tmux - 如何在 tmux 中获取 send-keys 的结果？

> ID：12665625
> 
> 赞同：9
> 
> 时间：2012-09-30T22:17:49.463
> 
> 标签：tmux

我正在使用 tmux 运行服务器控制台。要检查控制台是否正在应答，我想使用`send-keys`在控制台上运行命令：

```
tmux send-keys -t mysess:mywin "show info" Enter 
```

（实际上，我目前正在将完整的控制台输出记录到文件中并读取最后一行，但我希望存在更好的解决方案。）

```
tmux pipe-pane -o -t mysess:mywin 'cat >> mysess-mywin.log' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-13T07:10:32.673

您如何访问输出的上下文将影响此解决方案是否更好，但这可能有效：

```
tmux send-keys -t <session:win.pane> '<command>' Enter
tmux capture-pane -t <session:win.pane> 
tmux show-buffer 
```

您应该能够使用`-S`、 和`-E`选项`capture-pane`以及窗格的大小来准确捕获输出。如果您愿意，您还可以使用`show-panes`和一个小的正则表达式来捕获窗格的高度，然后只使用`-S <height - 1>`来捕获最后一行。

然后很容易从另一个程序中读取它（例如，在 python 中）：

```
print Popen(['tmux', 'show-buffer'], stdout=PIPE).communicate()[0] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-22T01:15:15.313

一种选择是使用运行“显示信息”的发送键调用脚本，并让脚本“发送键”将结果返回到您所在的 tmux 会话。这仅在您开始使用 tmux 时才有效。

# css - 将文本保留在 CSS 形状内而不使用空白 div

> ID：12665630
> 
> 赞同：2
> 
> 时间：2012-09-30T22:18:40.530
> 
> 标签：css, shapes

[本文](http://css-tricks.com/examples/ShapesOfCSS/)展示了几种可以在 CSS 中创建的形状。正方形和长方形很容易支持在形状内添加文本。椭圆形和圆形将文本剪掉。三角形不显示任何文本。心脏显示它背后的文字。而且由于添加了文本，钻石看起来不再是钻石了。

有什么不错的方法可以向这些 CSS 形状添加文本吗？有没有比使用浮动 div 将文本放置在 CSS Shape 元素的单独元素中更容易的方法？

一些结果的例子：http: [//jsfiddle.net/EVBYt/](http://jsfiddle.net/EVBYt/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:41:19.950

*   CSS 形状，
*   CSS 形状的*安全区域*中的文本和
*   CSS 形状中的文本，其中文本将尽可能多地填充可用空间

是三种截然不同的野兽！

您所指的形状具有一个约束条件：使用单个元素。这在某些情况下会导致 0x0 px 元素的背景颜色完全应用于伪元素。显然，在这些情况下，您的文本将无法正确显示，您必须使用其他方法完全重做这些形状。

**[CSS 区域](http://html.adobe.com/webstandards/cssregions/)**已由 Adob​​e 向 W3C 提出。只需等待几年的标准化和实施 :)

在这漫长的等待中，大约 10 年前玩过空白 div 的 Tantek Celik 和 Eric Meyer（例如： http: [//meyerweb.com/eric/css/edge/curvelicious/demo.html](http://meyerweb.com/eric/css/edge/curvelicious/demo.html)）仍然很重要。
如果您想要实现在 IE8 中用户选择*较大文本*或在 Firefox 中使用单级缩放文本时会爆炸的设计。虽然可能有流体尺寸`em`？

如果我被迫将文本设置为如此复杂的形状，我会使用**SVG 。**

# operating-system - x86 OS 的 64 位处理器上的 64 位整数运算

> ID：12665633
> 
> 赞同：1
> 
> 时间：2012-09-30T22:18:57.210
> 
> 标签：operating-system, integer, processor

如果我有一个 64 位处理器，但使用 32 位操作系统，那么对 64 位整数的操作如何执行？

*   与 x64 操作系统一样快。
*   比 x86/32 位更快，但比 x64/64 位慢。
*   与 x86/32 位一样快。
*   还有什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:24:06.660

与 x86/32 位相同，只要其他特性匹配。64 位通用寄存器在 32 位处理器模式以及新指令中不可用。

# c++ - 根据队列内容（if 语句）确定数字是实数还是整数

> ID：12665634
> 
> 赞同：0
> 
> 时间：2012-09-30T22:19:01.983
> 
> 标签：c++, queue

我正在逐个字符地从文件中读取数据，在读取结束时，我需要能够打印出该值是实数还是整数。

我已经用 get() 读入了数据，并将它们存储到 2 个不同的队列中，如果第一部分是 integerQueue，如果是 '.' 被读入，然后将剩下的数据切换到 realQueue 中。然后相应地打印出来。

印刷有问题。只是将所有内容标记为 Integer: 然后是正确的值。

```
else if(isdigit(temp) || temp == '.')
    {
            integerQueue.push(temp);
            char temp2 = readFile.get();
            while(isdigit(temp2))
            {
                integerQueue.push(temp2);
                temp2 = readFile.get();
            }
            if( temp == '.')
            {
                realQueue.push(temp);
                temp2 = readFile.get();
                while(isdigit(temp2))
                    {
                        realQueue.push(temp2);
                        temp2 = readFile.get();
                    }
            }
            if(realQueue.empty())
            {
            writeFile <<"Integer:       ";
                while(!integerQueue.empty())
                {
                writeFile <<integerQueue.front();
                integerQueue.pop();
                }
            }
            else
            {
                writeFile<<"Real:       ";
                while(!integerQueue.empty())
                {
                writeFile <<integerQueue.front();
                integerQueue.pop();
                }
                while(!realQueue.empty())
                {
                writeFile <<realQueue.front();
                realQueue.pop();
                }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:37:00.330

第 10 行：`if( temp == '.')`-您正在读取进入这部分代码的第一个字符，而不是读取的最后一个字符（以及最终会使 while 循环中断的字符）。您应该检查 temp2 是否等于 '.'，而不是 temp。

# c# - 是否可以更改此代码以便可以推断出通用方法参数？

> ID：12665635
> 
> 赞同：2
> 
> 时间：2012-09-30T22:19:20.460
> 
> 标签：c#, generics

我为我的 WPF 应用程序编写了一个简单的中介（它是[此处](http://brentedwards.net/2010/04/13/roll-your-own-simple-message-bus-event-aggregator/)找到的代码的派生）。

```
public class Messenger
{
    private IDictionary<Type, IList<MessageObserver>> observers;

    public Messenger()
    {
        observers = new Dictionary<Type, IList<MessageObserver>>();
    }

    public IDisposeObserver AddObserver<TMessageType>(Action<TMessageType> handler) 
        where TMessageType : Message { }

    protected abstract void RemoveObserver<TMessageType>(Action<TMessageType> handler) 
        where TMessageType : Message { }

    public abstract void PostMessage<TMessageType>(TMessageType message) 
        where TMessageType : Message { }
} 
```

`Message`只是一个空类，它为通过`Messenger`. 这个想法是您将从此类派生以创建具有相关数据的特定消息类（有点像`EventArgs`）。

我的实现不同的地方在于我想删除观察者的方式。我希望能够指定何时应以声明性方式删除它们，如下所示：

```
MessengerInstance.AddObserver<LoginMessage>(HandleLogin)
    .RemoveObserverWhen(message => message.LoginResult == LoginResult.Successful); 
```

该`RemoveObserverWhen`方法需要一个`Predicate<T>`where`T`应该是`AddObserver`方法中指定的消息类型。

这里的想法是您可以在注册观察者本身的同一位置指定删除观察者的逻辑。然后，Messenger 类将在消息处理程序运行后检查谓词，如果谓词评估为真，则删除消息处理程序和删除处理程序。

每个消息处理程序都可以有任意数量的删除处理程序，因此我将其打包在一个名为`MessageObserver`.

```
public class MessageObserver : IDisposeObserver
{
    private IList<object> disposalHandlers;

    public MessageObserver(object observer)
    {
        Observer = observer;
        disposalHandlers = new List<object>();
    }

    public object Observer { get; private set; }

    public IList<object> DisposalHandlers
    {
        get { return disposalHandlers; }
    }

    public IDisposeObserver RemoveObserverWhen<T>(Predicate<T> predicate) 
        where T : Message
    {
        disposalHandlers.Add(predicate);
        return this;
    }
} 
```

提供方法的`MessageObserver`工具。`IDisposeObserver``RemoveObserverWhen`

```
public interface IDisposeObserver
{
    IDisposeObserver RemoveObserverWhen<T>(Predicate<T> predicate) 
        where T : Message;
} 
```

这里的想法是`IDisposeObserver`可以返回一个实例，以便可以链接方法。

所有这些都有效，我的 viewModel 中有以下代码：

```
MessengerInstance.AddObserver<LoginMessage>(HandleLogin)
    .RemoveObserverWhen<LoginMessage>(message => message.LoginResult == LoginResult.Successful)
    .RemoveObserverWhen<LoginMessage>(SecondDisposalHandler); 
```

我遇到的问题是，仅当我`LoginMessage`在调用`RemoveObserver`方法时指定泛型参数（在这种情况下）时才有效。我希望能够以文章开头描述的方式调用这些方法。

我认为我需要以某种方式返回一个泛型`IDisposeObserver`，但如果我进行此更改，则`MessageObserver`必须将其设为泛型，然后我无法指定约束，因为`Messenger`该类是非泛型的。

所以我的问题是，**我的代码是否可以更新，以便在调用`RemoveObserverWhen`方法时不必指定消息类型，还是必须接受当前的解决方案？**

注意：我知道还有其他可用的实现，但我这样做是为了帮助我理解 C# 中的面向对象设计原则和泛型，所以请不要向我指出其他实现的方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T22:26:51.853

> 我想我需要以某种方式返回一个通用的 IDisposeObserver 但如果我进行此更改，则必须将 MessageObserver 设为通用，然后我无法指定约束，因为 Messenger 类是非通用的。

您可能想要一个`MessageObserver`包含所有类型中性部分的非泛型基类，然后是一个实现泛型的泛型基类`IDisposeObserver<T>`。然后，您可以更改`AddObserver`为返回泛型`IDisposeObserver<T>`，但将字典保留在`Messenger`as 中`IDictionary<Type, IList<MessageObserver>>`。因此，为了清楚起见，您将拥有：

```
public interface IDisposeObserver<T>
{
    IDisposeObserver<T> RemoveObserverWhen(Predicate<T> predicate) 
        where T : Message;
}

public abstract class MessageObserver { ... }

public class MessageObserver<T> : MessageObserver, IDisposeObserver<T> { ... } 
```

当您必须*执行*该`IDiposeObserver<T>.RemoveObserverWhen`方法时，问题就来了 - 您可能只需将字典列表中的每个项目转换为`IObserver<T>`. 你会知道`T`那个时候，你会知道你已经正确地填充了列表。

当然，如果这是你对观察者*唯一*要做的事情，你可以只保留一个`IDictionary<Type, IList<object>>`，而不用打扰两个不同的`MessageObserver`类。这实际上取决于您是否从非泛型中获得任何价值。

# c# - 调试时将值设置为空，运行时设置为空

> ID：12665636
> 
> 赞同：1
> 
> 时间：2012-09-30T22:19:20.247
> 
> 标签：c#, asp.net, linq, entity-framework, linq-to-entities

我有可以有子类别/根类别的类别。当我将根类别更改为其他类别时，它可以工作，但是当我尝试将其设置为`null`（使其成为根类别）时，它不会改变任何东西。如果这有什么不同，我将使用代码优先的方法。

这是我明确声明`category.RootCategory = null`但它不起作用的代码，根类别仍然是之前设置的。

## 控制器

```
[HttpPost]
public ActionResult Edit(Category c, int? rootCategoryID)
{
    var category = _db.Categories.Where(x => x.ID == c.ID).Single();

    if (TryUpdateModel(category))
    {
        cateogry.RootCategory = null;
            _db.SaveChanges();
        return Content(Infrastructure.Helpers.SerializeObject(category));
    }

    return Redirect("/admin/category");
} 
```

## 模型

```
public class Category
{
    public int ID { get; set; }
    virtual public Category RootCategory { get; set; }
    virtual public ICollection<Category> ChildCategories { get; set; }
} 
```

## 更新

非常奇怪的行为。当我调试它并一步一步慢慢地更新它时，当我不调试它或快速运行时它不会更新。我不知道为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:44:53.343

无论如何，我添加`public int? RootCategoryID { get; set; }`到我的模型中，现在我可以像这样编辑它。

```
[HttpPost]
public ActionResult Edit(Category c)
{
    var cateogry = _db.Categories.Where(x => x.ID == c.ID).Single();

    if (TryUpdateModel(cateogry))
    {
        cateogry.UpdatedDateTime = DateTime.Now;
        _db.SaveChanges();
    }

    return Redirect("/admin/category");
} 
```

它现在可以工作，但仍然不知道为什么它在运行时没有 RootCategoryID 并在调试时工作。

# php - Wordpress 分页在所有页面上显示相同的帖子

> ID：12665639
> 
> 赞同：1
> 
> 时间：2012-09-30T22:19:34.860
> 
> 标签：php, wordpress, loops, pagination

在此页面上，我使用以下 php 代码来显示帖子[：](http://fusion.fusionconstruction.co.uk/latest-news/)

```
<?php
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
query_posts($args);
if( have_posts() ) :?>

<?php twentyeleven_content_nav( 'nav-above' );?>
<?php
$withThumb = 5; 
while ( have_posts() ) : the_post();
if ($withThumb-- > 0) { ?>
    <div class="post-thumb-title">
        <a href="<?php the_permalink() ?>"><?php the_post_thumbnail(array(632,305));?></a>
        <p class="thumb-title2"><?php the_title(); ?></p>
        <p class="news-date"><?php the_time('F jS, Y') ?></p>
        <div id="post-excerpt">
            <?php the_excerpt(); ?>
        </div>
    </div>
<?php } else { ?>
    <div class="post-title">
        <p class="thumb-title2">
            <a href="<?php the_permalink() ?>"><?php the_title(); ?></a>
        </p>
    </div>
<?php } ?>
<?php endwhile; ?>
<?php twentyeleven_content_nav( 'nav-below' ); ?> 
```

问题是，如果您点击“[旧帖子](http://fusion.fusionconstruction.co.uk/latest-news/page/2/)”，它会显示相同的帖子而不是旧帖子。

打开第 3 页、第 4 页等时也是如此。

我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T08:17:29.190

您需要将页码添加到`query_posts()`调用的参数中。

```
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
$args['paged'] = $paged;
query_posts($args); 
```

请参阅[文档](http://codex.wordpress.org/Pagination#Adding_the_.22paged.22_parameter_to_a_query)。

**注意：**如果您已经将其定义`$args`为字符串而不是数组，则需要连接`&paged=page_number_here`，而不是添加新的键值对。

# ios - iOS 浏览器在使用 -webkit-overflow-scrolling 时崩溃：触摸；

> ID：12665641
> 
> 赞同：5
> 
> 时间：2012-09-30T22:19:55.567
> 
> 标签：ios, ipad, css

在制作可滚动的 div 时，对于 iOS 设备，动量滚动不起作用 - 因此您必须使用 'beta' -webkit-overflow-scrolling: touch; 财产。

然而，这似乎让我的浏览器崩溃了——不是立即崩溃，而是随机出现。删除所有 -webkit-overflow-scrolling: touch; 属性阻止浏览器崩溃。

我尝试过使用 iScroll、touchSwipe 和其他一些我不记得名称的插件，但要么太麻烦而无法实现（我的开发时间很短），要么没有按预期工作。

有没有人遇到过同样的问题，如果有，您找到解决方案了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T22:36:36.987

我碰巧在更大的名单上，大约有 100 多个

*   元素。当我删除它时，它可以工作，但当然没有动量滚动。

    我在 iPod Touch 4.1 和 iPad 2 上测试了 iOS5 和最新的 iOS6，似乎在 Touch 上我更频繁地遇到 Safari 崩溃，但在 iPad 上也会发生。

    这似乎是他们没有正确解决的苹果错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-23T21:56:23.707

当我将它应用于页面上的多个元素时，我注意到发生了这种情况......我将它放到仅应用于“活动”div 上，并且它不再崩溃。瘸。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-10-26T10:52:12.770

```
let content = document.querySelector(".content");
if (content.scrollTop <= 0) {
    content.scrollTop = 1;
} else if (content.scrollTop >= content.scrollHeight - content.clientHeight) {
    content.scrollTop = content.scrollHeight - content.clientHeight - 1;
} 
```

# php - 使用 Id 显示链接表中的 MySql 数据

> ID：12665645
> 
> 赞同：1
> 
> 时间：2012-09-30T22:20:06.203
> 
> 标签：php, mysql

我有 2 张桌子 - 活动和与会者。

我正在尝试使用 php 在通过 events.id 单击与会者列表并显示由 id 链接的与会者表中列出的与会者。

涉及的字段是 events.id 和 Attendees.id 并显示该事件的与会者。

这就是我目前所拥有的。

```
SELECT events.*, attendees.* 
FROM attendees ON event.id = attendees.id 
WHERE event.id = attendees.id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:26:58.387

您的连接语法是隐式和显式`JOIN`语法的错误组合，缺少`JOIN`关键字，而是在`WHERE`子句中重复连接条件。

```
SELECT
  events.*, 
  attendees.* 
FROM
  attendees 
  JOIN events ON event.id = attendees.id
WHERE
  event.id = <event to find attendees for> 
```

请注意，*不建议*在 PHP中使用`events.*, attendees.*`，因为您将有重复的列名，PHP 无法访问。相反，要明确：

```
SELECT
  /* Be explicit about the columns you select in a JOIN query */
  events.id AS event_id,
  events.name AS event_name,
  events.someothercol,
  attendees.id AS attendee_id,
  attendees.name AS attendee_name
FROM
  attendees 
  JOIN events ON event.id = attendees.id
WHERE
  event.id = <event to find attendees for> 
```

如果即使没有与会者，您仍想获取活动详细信息，请`LEFT JOIN`改用：

```
SELECT
  /* Be explicit about the columns you select in a JOIN query */
  events.id AS event_id,
  events.name AS event_name,
  events.someothercol,
  attendees.id AS attendee_id,
  attendees.name AS attendee_name
FROM
  events
  /* LEFT JOIN will return event details even when there are no attendees */
  LEFT JOIN attendees ON event.id = attendees.id
WHERE
  event.id = <event to find attendees for> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:30:37.640

如果你有两个这样的表：

```
events:  
  ID  
  ...  

attendees:  
  event  
  ... 
```

您需要获取与他们的活动相关的与会者列表，试试这个：

```
SELECT * FROM attendees LEFT OUTER JOIN events ON attendees.event = events.ID 
```

如果不是，请澄清您的问题。

# c# - C# WPF 如何将内容更改为随机按钮？

> ID：12665661
> 
> 赞同：1
> 
> 时间：2012-09-30T22:22:38.657
> 
> 标签：c#, button, random, tic-tac-toe

我正在尝试在 Silverlight 中制作一款可以在 1 人模式下玩的井字游戏。因此，在单击任何按钮并将其内容更改为“X”或“O”后，我需要更改随机按钮的内容。

我试过列出所有按钮并获得一个随机值：

```
 public List<string> avail = new List<string>() { "button1", "button2", "button3", "button4", "button5", "button6", "button7", "button8", "button9" };

    public string Ran()
    {
        Random b1 = new Random();
        int index = b1.Next(avail.Count); 
        if (index > 0)
            return avail[index];
        else
            return null;
    } 
```

但我不知道如何使我的随机字符串成为按钮，所以我可以调用以下方法：

```
 public void buttonchange(Button b)
    {
        if (b.Content.ToString() == "")
            if (x == true)
            {
                x = false;
                b.Content = "X";
            }
            else
            {
                x = true;
                b.Content = "O";
            }
        if(b.Name!=null)
            avail.Remove(b.Name);
    } 
```

有任何想法吗？谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:26:10.293

制作一个按钮引用列表：

```
public List<Button> avail = new List<Button>() { button1, button2, button3, button4, button5, button6, button7, button8, button9 };

public Button Ran()
{
    Random b1 = new Random();
    int index = b1.Next(avail.Count); 
    if (index > 0) {
        return avail[index];
    } else {
        return null;
    }
}

public void buttonchange(Button b)
{
    if(b != null) {
        if (b.Content.ToString() == "") {
            b.Content = x ? "X" : "O";
            x = !x;
        }
        avail.Remove(b);
    }
} 
```

不知道为什么不使用索引为零的按钮，但......

# asp.net-mvc-3 - 如何让模型中的值与下拉列表中的选定值匹配？

> ID：12665664
> 
> 赞同：0
> 
> 时间：2012-09-30T22:23:09.717
> 
> 标签：asp.net-mvc-3

如何让模型中的值与下拉列表中的选定值匹配？

我想做的是让下拉列表反映模型的属性值。我只能在所有下拉列表中显示相同的值。我一直在尝试这样做：

```
@Html.DropDownList("searchString", Model.Enrollments.FirstOrDefault().WeekDays.Select(s => 
   new SelectListItem { Text = s.ToString(), Value = s.ToString(), 
   Selected = s.ToString().Equals(Model.Enrollments.FirstOrDefault().classDays) })) 
```

但没有运气。

我的注册模型片段：

```
 public string[] weekDays = new string[6] { "Day", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday" };

    public string[] WeekDays

    {

        get { return weekDays; }

    } 
```

我的观点是：@model SchoolIn.Models.Student 但我想插入另一个模型 Model.Enrollments 并缩小下拉列表项。

```
 <table>
     <tr>
              @{
     int cnt = 0;
        List<SchoolIn.ViewModels.EnrolledCourseData> courses = ViewBag.Courses;

        foreach (var course in courses)
        {
            if (cnt++ % 4 == 0)
            {

                       @:  </tr> <tr>

             }
                       @: <td >  
                      <br /><br /><br />
                    <input type="checkbox"  
                           name="selectedCourses"  
                           value="@course.CourseID"  
                           @(Html.Raw(course.Assigned ? "checked=\"checked\"" : "")))

   />  

                    @*course.CourseID @:  @course.Title*@
                    @course.Title<br />  <br />

      if (Model.Enrollments != null)
      {

       @Html.DropDownList("searchString", Model.Enrollments.FirstOrDefault().WeekDays.Select(s => new SelectListItem { Text = s.ToString(), Value = s.ToString(), Selected = s.ToString().Equals(Model.Enrollments.FirstOrDefault().classDays) })) 

     }

                                 @:</td> 

       }
                                @:</tr> 

 }

          </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T05:19:02.663

```
@Html.DropDownListFor( x => x.courseId, new SelectList(LookupUtils.AvailableCourcesList(), "Value", "Text", Model.courseId)) 
```

LookupUtils 是一个静态类有：

```
public static List<SelectListItem> AvailableCourcesList()
{
    var dataContext = new YourDataContext(  );
    var data = dataContext.GetCourcesFn().ToList();

    var result = ( from res in data
                   select new SelectListItem()
                              {
                                  Text = res.courseName,
                                  Value = res.courseId.ToString()
                              } ).ToList();

    return result;
} 
```

# java - Java JScrollPane 删除组件而不更改视口

> ID：12665665
> 
> 赞同：1
> 
> 时间：2012-09-30T22:23:26.697
> 
> 标签：java, swing, jscrollpane

当我的 JScrollPane 中有超过 50 个组件时，每次用户决定转到下一页时，都会清除 JScrollPane 中的前 10 个组件。

此功能可以正常工作并且是可取的，但是当组件被移除时，视口/滚动会发生变化。每次清除组件时，滚动窗格的视图都会跳回。

我想要将视口保持在完全相同的位置，同时从 JScrollPane 中删除第一个组件。

目前我有一个解决方法，但它并不优雅，虽然它找到了用户最后的位置，但它很不稳定，并且会跳过看起来不正确的滚动窗格：

```
if (middlePanel.getComponents().length > 50)
{
    Component currentScroll = scrollPane.getViewport().getView();
    for (int counter = 0; counter < memeAnchors.size(); counter++)
    {
        middlePanel.remove(counter);
    }
    scrollPane.setViewportView(currentScroll);
    scrollPane.getVerticalScrollBar().setValue(scrollPane.getVerticalScrollBar().getValue() - 800);
} 
```

我想做的甚至可能吗？

先谢谢大家了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T01:40:41.277

好吧，我谎称没有回应。

一种方法如下我的[SSCCE](http://sscce.org)中所述。注意使用 Scrollable。解释在评论中：

```
import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.LayoutManager;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.*;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

@SuppressWarnings("serial")
public class Sscce extends JPanel {
   private static final int INITIAL_ROW_COUNT = 100;
   public static final int INCREMENTAL_ADD_ROW_COUNT = 10;
   private static final int MIN_VERT_PERCENT = 4;
   private static final int TIMER_DELAY = 250;
   private ViewportViewPanel viewportViewPanel = new ViewportViewPanel(
         new GridLayout(0, 1));
   private JScrollPane scrollPane = new JScrollPane(viewportViewPanel);
   private BoundedRangeModel vertModel;
   private Timer vertChangeTimer;
   private int viewportViewPanelIndex = 0;
   public Component firstViewedComp;

   public Sscce() {
      setLayout(new BorderLayout());
      add(scrollPane);

      for (viewportViewPanelIndex = 0; viewportViewPanelIndex < INITIAL_ROW_COUNT; viewportViewPanelIndex++) {
         viewportViewPanel.add(new ViewablePanel(viewportViewPanelIndex));
      }

      vertModel = scrollPane.getVerticalScrollBar().getModel();
      vertModel.addChangeListener(new VertModelChangeListener());
   }

   private class VertModelChangeListener implements ChangeListener {

      @Override
      public void stateChanged(ChangeEvent cEvt) {
         // if timer is running, get out of here
         if (vertChangeTimer != null && vertChangeTimer.isRunning()) {
            return;
         }

         // if haven't set firstViewedComp back to null (done in Timer) get out of here
         if (firstViewedComp != null) {
            return;
         }

         // check to see if near bottom
         int diff = vertModel.getMaximum() - vertModel.getValue()
               - vertModel.getExtent();
         int normalizedDiff = (100 * diff) / vertModel.getMaximum();

         // if not near bottom, get out of here
         if (normalizedDiff >= MIN_VERT_PERCENT) {
            return;
         }

         // create and start timer
         vertChangeTimer = new Timer(TIMER_DELAY, new VertChangeTimerListener());
         vertChangeTimer.setRepeats(false);
         vertChangeTimer.start();

         // get viewport and its rectangle
         JViewport viewport = scrollPane.getViewport();
         Rectangle viewRect = viewport.getViewRect();

         // find first component that is inside of viewport's rectangle
         Component[] components = viewportViewPanel.getComponents();
         for (Component component : components) {
            if (viewRect.contains(component.getBounds())) {
               if (firstViewedComp == null) {
                  firstViewedComp = component; // first component found
                  break;
               }
            }
         }

         // delete 10 components at start 
         // add 10 components add end
         for (int i = 0; i < INCREMENTAL_ADD_ROW_COUNT; i++) {
            viewportViewPanel.remove(components[i]);
            viewportViewPanel.add(new ViewablePanel(viewportViewPanelIndex));
            viewportViewPanelIndex++;
         }

         // redo laying out components and repainting the container
         viewportViewPanel.revalidate();
         viewportViewPanel.repaint();

         // scroll back to first viewed component, but give a little delay to allow
         // layout out above to complete. So queue it on the event queue via invokeLater
         SwingUtilities.invokeLater(new Runnable() {
            public void run() {
               viewportViewPanel.scrollRectToVisible(firstViewedComp
                     .getBounds());
            }
         });

      }
   }

   // the timer listener. it just nulls out the first viewed component
   private class VertChangeTimerListener implements ActionListener {
      @Override
      public void actionPerformed(ActionEvent e) {
         firstViewedComp = null;
      }
   }

   private static void createAndShowGui() {
      Sscce mainPanel = new Sscce();

      JFrame frame = new JFrame("Sscce");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

// JPanel that is held by the JScrollPane's JViewport and that holds the smaller 
// JPanels. Note that it implements Scrollable
@SuppressWarnings("serial")
class ViewportViewPanel extends JPanel implements Scrollable {
   private static final int BLOCK = 8;

   public ViewportViewPanel(LayoutManager layout) {
      super(layout);
   }

   @Override
   public Dimension getPreferredScrollableViewportSize() {
      int scrollWidth = ViewablePanel.PREF_W;
      int scrollHeight = ViewablePanel.PREF_H * BLOCK;
      return new Dimension(scrollWidth, scrollHeight);
   }

   @Override
   public int getScrollableBlockIncrement(Rectangle visibleRectangle,
         int orientation, int direction) {
      if (orientation == SwingConstants.VERTICAL) {
         return ViewablePanel.PREF_H * (3 * BLOCK) / 4;
      }
      return 0;
   }

   @Override
   public boolean getScrollableTracksViewportHeight() {
      return false;
   }

   @Override
   public boolean getScrollableTracksViewportWidth() {
      return true;
   }

   @Override
   public int getScrollableUnitIncrement(Rectangle visibleRect,
         int orientation, int direction) {
      if (orientation == SwingConstants.VERTICAL) {
         return ViewablePanel.PREF_H;
      }
      return 1;
   }

}

// small JPanel. Many of these are held in a single GridLayout column 
// by the JPanel above.
@SuppressWarnings("serial")
class ViewablePanel extends JPanel {
   public static final int PREF_W = 400;
   public static final int PREF_H = 50;
   private int index;

   public ViewablePanel(int index) {
      this.setIndex(index);
      String title = "index " + index;
      setBorder(BorderFactory.createTitledBorder(title));
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }

   public int getIndex() {
      return index;
   }

   public void setIndex(int index) {
      this.index = index;
   }

} 
```

# jquery - Jade 按钮和 jQuery 点击事件

> ID：12665666
> 
> 赞同：4
> 
> 时间：2012-09-30T22:23:37.233
> 
> 标签：jquery, pug

我不明白为什么它不起作用...

我有这个 index.jade 文件：

```
!!! 5
html
  head
    link(rel='stylesheet', href='/stylesheets/style.css')
    script(src="/javascripts/jquery-1.8.2.js")
           script
       $("#rollButton").click(function() {
          alert("sas");
       });
  body
     input#rollButton(type="button", value="Roll") 
```

它应该弹出警报！我错过了什么？

生成的 HTML 似乎没问题：

```
<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="/stylesheets/style.css">
<script src="/javascripts/jquery-1.8.2.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
$("#rollButton").click(function() {
  alert("sas");
});
</script>
</head>
<body>
<input id="rollButton" type="button" value="Roll">
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T22:32:23.927

我还不熟悉 [jade]，但不应该有 jQuery “onReady” 函数，比如这个：

```
!!! 5
html
  head
    link(rel='stylesheet', href='/stylesheets/style.css')
    script(src="/javascripts/jquery-1.8.2.js")
    script
       $(document).ready(function(){
         $("#rollButton").click(function() {
          alert("sas");
         });
       });
  body
     input#rollButton(type="button", value="Roll") 
```

编辑：我不确定缩进。正如我在其他评论中看到的那样，它也应该被修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-30T05:24:00.607

删除这个！！！5

```
html
 head
link(rel='stylesheet', href='/stylesheets/style.css')
script(src="/javascripts/jquery-1.8.2.js")
       script
   $("#rollButton").click(function() {
      alert("sas");
   });
body
 input#rollButton(type="button", value="Roll") 
```

# facebook - 将网站内容添加到用户的 Facebook 墙

> ID：12665667
> 
> 赞同：1
> 
> 时间：2012-09-30T22:23:37.987
> 
> 标签：facebook, facebook-graph-api, facebook-timeline

我在一些网站上看到用户可以选择一个复选框来将特定内容添加到他们的墙上。例如，如果他们将图像或视频添加到网站，用户可以选择“发布到 Facebook”。Chill.com 就是这样做的。

此外，SPOTIFY.com 会在用户的时间线中添加一条通知，说明他们正在收听特定曲调。

如果有人对此有任何信息，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:52:43.917

这些自动帖子的主要方法是操作

参考：[https ://developers.facebook.com/docs/opengraph/actions/](https://developers.facebook.com/docs/opengraph/actions/)

# android - Eclipse 缓存损坏导致 ADT 生成文件出错

> ID：12665668
> 
> 赞同：3
> 
> 时间：2012-09-30T22:23:40.953
> 
> 标签：android, eclipse, adt

我有一个 android 项目，经常生成错误的`R.java`文件，让我疯狂地修复问题。

现在，我有一个带有自定义图标按钮的项目，例如

```
bt_icon1.png
bt_icon2.png 
```

等等

我已删除`bt_icon1.png`以使用另一个同名资源

结果？

```
Unparsed AAPT Error, resource already defined. 
```

资源已被删除，我试图清理项目重建，但我总是得到相同的错误，因为在 autogen 文件`R.java`中有一行 `public static final int bt_icon1=0x7f02000d;`引用已删除的图标...

我试图手动删除该行，但每次都重新创建...

我试图删除整个`R.java`文件，但 Eclipse 总是生成错误版本的文件。

有一种解决方案不强制我`.metadata`每次都删除工作区中的文件夹并重新导入所有项目？？？

我的 ADT 是最新版本，我的 Eclipse 更新到最新版本，我有最新的 SDK。

# objective-c - insertItemsAtIndexPaths 更新错误

> ID：12665669
> 
> 赞同：3
> 
> 时间：2012-09-30T22:23:41.377
> 
> 标签：objective-c, ios, ipad, nsarray, uicollectionview

在 UICollectionView 中，我正在尝试使用`performBatchUpdates:completion`对我的网格视图执行更新。我的数据源数组是`self.results`.

**这是我的代码：**

```
dispatch_sync(dispatch_get_main_queue(), ^{

            [self.collectionView performBatchUpdates:^{

                int resultsSize = [self.results count];
                [self.results addObjectsFromArray:newData];

                NSMutableArray *arrayWithIndexPaths = [NSMutableArray array];
                if (resultsSize == 0) {
                    [arrayWithIndexPaths addObject:[NSIndexPath indexPathForRow:0 inSection:0]];
                }

                else {
                    for (int i = 0; i < resultsSize; i++) {
                        [arrayWithIndexPaths addObject:[NSIndexPath indexPathForRow:resultsSize + i inSection:0]];
                    }
                }

                for (id obj in self.results)
                    [self.collectionView insertItemsAtIndexPaths:arrayWithIndexPaths];

            } completion:nil]; 
```

**解释我有什么/我在做什么：**

当初始插入到集合视图完成时，此代码运行良好。但是，当我将更多数据添加/插入到我的集合视图中（通过更新`self.results`和调用它）时，会出现以下错误：

> ***由于未捕获的异常'NSInternalInconsistencyException'而终止应用程序，原因：'无效更新：第0节中的项目数无效。更新后现有节中包含的项目数（8）必须等于其中包含的项目数更新前的那个部分 (4)，加上或减去从该部分插入或删除的项目数（插入 32，删除 0），加上或减去移入或移出该部分的项目数（0 移入，0搬出）。'

我知道这意味着数据源没有正确更新。但是，在查询我的`self.results`数组时，我看到了新的数据计数。我在第一行使用`addObjectsFromArray`. 我还将旧结果大小存储在`resultsSize`. 我使用该变量将新添加的索引路径添加到`arrayWithIndexPaths`.

现在在添加/插入项目时，我尝试了以下 for 循环：

`for (id obj in self.results)`这就是我现在正在使用的。它最初可以工作，但会进一步插入崩溃。

`for (UIImage *image in newData)`最初也可以工作，但进一步插入崩溃。

从函数的名称来看，我相信它`insertItemsAtIndexPaths`会在没有循环的情况下将所有项目插入这些索引路径。但是，如果没有循环，应用程序在最初尝试填充数据时会崩溃。

我还尝试循环`resultsSize + 1`直到新`self.results`计数（包含新数据），并且在初始更新时也会崩溃。

关于我做错了什么的任何建议？

谢谢，

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-30T23:33:15.783

我在这里看到了一些错误。首先，我不确定您为什么要使用 dispatch_sync，我对 GCD 没有太多经验，而且我无法在其中使用它（它似乎挂起，并且 UI 没有响应）。也许其他人可以提供帮助。其次，在添加索引路径的循环中，您循环遍历 resultsSize，据我了解，它是更新前数组的大小，这不是您想要的——您希望在resultsSize 并循环到 resultsSize + newData.count。最后，当您调用 insertItemsAtIndexPaths 时，您希望执行一次，而不是循环执行。我试过这个，它可以更新集合视图（我没有从头开始尝试使用空集合视图）：

```
-(void)addNewCells {
    [self.collectionView performBatchUpdates:^{
        int resultsSize = [self.results count];
        [self.results addObjectsFromArray:newData];
        NSMutableArray *arrayWithIndexPaths = [NSMutableArray array];
        for (int i = resultsSize; i < resultsSize + newData.count; i++) {
            [arrayWithIndexPaths addObject:[NSIndexPath indexPathForRow:i inSection:0]];
        }
            [self.collectionView insertItemsAtIndexPaths:arrayWithIndexPaths];
    }
        completion:nil];
} 
```

# cuda - CLR 项目中的 CUDA

> ID：12665678
> 
> 赞同：0
> 
> 时间：2012-09-30T22:24:52.710
> 
> 标签：cuda, clr

我正在尝试将 Visual Studio 2010 Forms 项目 (CLR) 中使用的模式识别 (PR) 算法转移到 CUDA。

从控制台项目调用的 CUDA 部分和 CLR 项目本身一样工作正常。

当我用 CUDA 替代方案替换 PR 算法时，我收到链接器错误：

“AssemblyInfo.obj：致命错误 LNK1313：检测到纯模块；无法与 ijw/native 模块链接”。

有没有人尝试成功地将 CLR 代码与 CUDA 混合？有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:30:35.027

我假设您有两段代码，一段是 CLR 控制台应用程序，另一段是本机库。首先，您必须使用 dll（不确定您是否使用了静态库）。其次，您可以通过两种方式连接到它：

1.  您可以使用[P/Invoke](http://msdn.microsoft.com/en-us/library/aa446536.aspx)。这将使 CLR 代码访问本机 dll。
2.  您可以将本机库更改为混合库，并公开一个包装本机代码的 ref 类。有关更多详细信息，请参见[此处](http://en.wikipedia.org/wiki/C++/CLI)。

# ruby-on-rails - Rails 内存泄漏的主要因素

> ID：12665681
> 
> 赞同：7
> 
> 时间：2012-09-30T22:25:17.973
> 
> 标签：ruby-on-rails, memory-leaks

我正在尝试解决 Rails 的内存泄漏问题。我可以通过 New Relic 看到，内存的使用量一直在增加，而从未减少。

这是一个大线程的衍生问题（[Rails 应用程序中的内存不断增加](https://stackoverflow.com/questions/12578344/memory-constantly-increasing-in-rails-app)），我在其中遇到了问题。我现在需要知道的只是：

Rails 内存泄漏的主要原因/因素是什么？

据我所理解：

*   全局变量（例如@@variable）——我没有这些

*   符号（我没有专门创建任何符号）

*   会话 - 这里应该避免什么？假设我有一个会话来跟踪一个特定用户在对站点进行文本搜索时使用的最后一个查询。我该怎么杀掉它？

*   “留下参考” - 这到底是什么意思？你能举个例子吗？

*   您可以提供的任何其他通常会造成内存泄漏的糟糕编码示例？

我想使用这些信息来查看我的代码，所以请提供示例！

最后，这会是“内存泄漏代码”吗？

```
ProductController
...
@last_products << Product.order("ASC").limit(5)
end 
```

这会让@last_products 膨胀吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T22:02:07.700

以下将破坏应用程序。

```
Foo.each do |bar|
  #Whatever
end 
```

如果您有很多 Foos 会将它们全部拉入内存。我见过应用程序爆炸，因为它们有一堆“Foos”，并且他们有一个贯穿所有 foos 的 rake 任务，而这个 rake 任务需要永远，比如说**Y 秒**，但每***X***秒运行一次，其中***X <是***。所以发生的事情是，他们现在不止一次地把所有的 Foos 都放在了内存中，因为他们只是一遍又一遍地把东西拉进内存。

虽然这不能完全发生在面向前端的 Web 应用程序中，但它并不完全有效或不想要。

代替上述方法，请执行以下操作

```
Foo.find_each do |bar|
  #Whatever
end 
```

它检索事物和批次，并且不会一次将一大堆东西全部放入您的记忆中。

就在我写完这个的时候，我意识到这个问题是在去年 9 月被问到的……哦，天哪……

# java - 覆盖客户对象上的 .equals()

> ID：12665684
> 
> 赞同：-2
> 
> 时间：2012-09-30T22:26:00.257
> 
> 标签：java, overriding, equals

我想覆盖自定义对象上的equals，并想检查当前对象是否等于Id（getId）在参数中传递的那个。我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:31:10.930

仅凭您提供的信息很难给您答案。但是你想要大致这样的东西：

```
@Override
public boolean equals(Object o) {
    if (! (o instanceof MyClass)) return false;
    return id == ((MyClass)o).getId();
} 
```

`id`您的数据字段在哪里（可能是`int`），并且`MyClass`是您的班级名称。

**注意：**如果您覆盖`equals`，强烈建议您也覆盖[`hashCode`](http://en.wikipedia.org/wiki/Java_hashCode%28%29)。如果`id`确实是一个整数，那么您可能会考虑`hashCode`只返回`id`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:39:22.043

您需要检查传入对象的类型和“nullness”。您还应该检查是否`this.id`为 null 只是为了彻底。你也可能想要覆盖`Object.hashCode()`，以便`Set`s 和`Map`s 像你想要的那样工作。

```
@Override
public boolean equals(Object obj) {
  if ((obj == null) || (!getClass().isAssignableFrom(obj.getClass()))) {
    return false;
  } 

  if (this.id == null) {
    return false;
  } else {
    return this.id.equals((ClassName)obj.getId());
  }
}

@Override
public int hashCode() {
  return this.id.hashCode();
} 
```

# javascript - jquery可拖动但保留原始元素所在的副本

> ID：12665690
> 
> 赞同：6
> 
> 时间：2012-09-30T22:26:40.387
> 
> 标签：javascript, jquery

假设我在页面顶部有 3 个笑脸，L、M 和 R。在底部，我有一个目标框。它们之间有一个语句：“将中间笑脸拖到目的地”。

虽然 draggable 允许您这样做，但它拖动实际元素，而不是副本。当用户拖动笑脸时，我希望前 3 个保持静止，只有他们正在移动的那个的副本才能实际移动。如果需要，用户应该能够将多个副本拖动到多个目标框中。

基本上，我正在寻找这样的东西

```
$("#drag-target-1").draggable('leave-copy'); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T22:41:32.650

使用带值的辅助属性`clone`来启用可拖动元素的克隆。

```
 $("#drag-target-1").draggable({helper : 'clone' }); 
```

# php - Uploadify - 重命名文件

> ID：12665696
> 
> 赞同：0
> 
> 时间：2012-09-30T22:27:00.620
> 
> 标签：php, javascript, uploadify

我正在使用uploadify，但我不太确定如何编辑php 来重命名上传的文件。

基本上，一个用户最多可以上传 4 个文件，它们应该被命名为 1-img-1、1-img-2、1-img-3、1-img-4 - 第一个数字是用户 ID（可以可以通过 POST 访问）。

这是uploadify php脚本：

```
<?php
/*
UploadiFive
Copyright (c) 2012 Reactive Apps, Ronnie Garcia
*/

// Set the uplaod directory
$uploadDir = '/img/listing_images/';

// Set the allowed file extensions
$fileTypes = array('jpg', 'jpeg', 'gif', 'png'); // Allowed file extensions

$verifyToken = md5('unique_salt' . $_POST['timestamp']);

if (!empty($_FILES) && $_POST['token'] == $verifyToken) { $i++;
    $tempFile   = $_FILES['Filedata']['tmp_name'];
    $uploadDir  = $_SERVER['DOCUMENT_ROOT'] . $uploadDir;
    $targetFile = $uploadDir . $_FILES['Filedata']['name'];

    // Validate the filetype
    $fileParts = pathinfo($_FILES['Filedata']['name']);
    if (in_array(strtolower($fileParts['extension']), $fileTypes)) {
    // Save the file
    move_uploaded_file($tempFile, $targetFile);
    echo 1;

} else {

    // The file type wasn't allowed
    echo 'Invalid file type.';

}
}
?> 
```

只是想知道是否有人可以帮助告诉我如何重命名上传的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T03:35:47.410

生成一个唯一密钥并使用该名称保护文件，未经测试的示例：

```
$fileParts = pathinfo($_FILES['Filedata']['name']);
$unique_hash = hash_hmac("md5", file_get_contents($_FILES['Filedata']['name']), SALT);
$targetFile = $uploadDir . $unique_hash . $fileParts['extension']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-20T10:09:14.350

这是原始的uploadify.php

```
<?php
/*
Uploadify
Copyright (c) 2012 Reactive Apps, Ronnie Garcia
Released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/

// Define a destination
$targetFolder = '/uploads'; // Relative to the root

$verifyToken = md5('unique_salt' . $_POST['timestamp']);

if (!empty($_FILES) && $_POST['token'] == $verifyToken) {
$tempFile = $_FILES['Filedata']['tmp_name'];
$targetPath = $_SERVER['DOCUMENT_ROOT'] . $targetFolder;
$targetFile = rtrim($targetPath,'/') . '/' . $_FILES['Filedata']['name'];

// Validate the file type
$fileTypes = array('jpg','jpeg','gif','png'); // File extensions
$fileParts = pathinfo($_FILES['Filedata']['name']);

if (in_array($fileParts['extension'],$fileTypes)) {
    move_uploaded_file($tempFile,$targetFile);
    echo '1';
} else {
    echo 'Invalid file type.';
}
}
?> 
```

我只是这样做。

```
$fileParts = pathinfo($_FILES['Filedata']['name']);
$targetFile = rtrim($targetPath,'/') . '/' .rand_string(20).'.'.$fileParts['extension']; 
```

其中 rand_string() 是一个生成随机字符串的函数。

每次您上传文件时，都会生成不同的名称（随机）。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:31:40.723

只需更改 $targetFile 变量值并移动 $fileParts 的声明和分配，如下所示：

```
$fileParts = pathinfo($_FILES['Filedata']['name']);
$targetFile = $uploadDir . '1-img-' . $i . $fileParts['extension']; 
```

# macports - 使用 macports 安装端口集/组/集合

> ID：12665700
> 
> 赞同：0
> 
> 时间：2012-09-30T22:27:47.470
> 
> 标签：macports

所以我刚刚安装了 macports（最新版本，在 OS X 10.8.2 上）。我现在想安装端口。似乎我需要搜索和安装各个端口（尽管会自动为我安装依赖项），这些端口是编译的，而不是作为二进制文件安装的。这真的是唯一的方法吗？我可以不要求安装一整套/一组端口吗？（说与乳胶有关的一切）？或者也许我可以选择一些有用的端口集合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T10:06:13.307

Macports 包含许多元端口，例如 texlive，它们是虚拟包，可以更轻松地安装一组端口。例如，安装 texlive 包将设置您进行基本乳胶工作所需的一切。一些更高级的软件包仍然需要手动安装。

我不知道“每个人都应该安装的端口”列表。

# jquery - 自动完成动态字段栏

> ID：12665703
> 
> 赞同：0
> 
> 时间：2012-09-30T22:28:21.540
> 
> 标签：jquery, html, ruby-on-rails-3, autocomplete, nested-attributes

我关注了关于创建嵌套属性形式的 railscasts[集](http://railscasts.com/episodes/196-nested-model-form-revised)。`add mission`所以我有一段咖啡脚本，当在我的表单上按下按钮时，它会创建一个 user_mission 对象。

```
jQuery ->
  $('form').on 'click', '.add_fields', (event) ->
    time = new Date().getTime()
    regexp = new RegExp($(this).data('id'), 'g')
    $(this).before($(this).data('fields').replace(regexp, time))
    event.preventDefault() 
```

生成的部分 html 如下所示：

```
 <input id="user_user_missions_attributes_70324621482200_mission_title" name="user[user_missions_attributes][70324621482200][mission_title]" size="30" type="text" /> 
```

我正在尝试添加自动完成功能的功能，该功能查看已创建任务的列表，以查看用户输入的任务是否已经存在。问题是我对 html 有点陌生，我不确定如何将自动完成调用添加到动态 html id。

有没有一种干净的方法可以找到我需要添加自动完成功能的字段？我是否必须标记化才能搜索`user_user_missions_attributes_70324621482200_mission_title`？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:57:12.430

尝试通过 name 属性的部分匹配来定位它。它不会那么快，但如果您在每个页面上只有几个，您不会注意到页面加载性能下降。

```
$("input[name*='[mission_title]']") 
```

您也可以部分匹配 ID，但它看起来不那么干净：

```
$("input[id*='_mission_title']") 
```

您还可以向这些字段添加一个类并使用它。

# c# - 用户可以看到 Silverlight 代码吗？

> ID：12665705
> 
> 赞同：2
> 
> 时间：2012-09-30T22:28:34.427
> 
> 标签：c#, .net, wpf, wcf, silverlight

我正在考虑使用 Silverlight 而不是 WPF 作为客户端和 WCF 作为服务器。这有意义吗？

我想我会有这些优势：

1) 更便携，因为它是 Web。

2) 我不需要在客户端和服务器应用程序中验证用户输入。

第三个优点是我的主要问题：我猜用户看不到我的代码，所以我的应用程序可以安全地抵御黑客。它是否正确？这意味着如果我在 Silverlight 中存储数据库连接字符串，没有客户端会看到它，对吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T22:31:43.503

打包您的 Silverlight 应用程序的 .xap 文件只是一个包含应用程序 DLL 的存档（将其重命名为 .zip 并自行查看），因此下载 .xap 的任何人仍然可以反编译您的代码。

至于您的第二点，您应该在服务器上进行验证。例如，我可以嗅探流量并查看您的应用程序调用了 WCF Web 服务。从那里我可以在不使用您的应用程序的情况下向您的服务提出自己的请求。如果你不验证服务器端的坏事将会发生。

此外，Silverlight 的“可移植性”是有争议的，但我想它比 .exe 更便携。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T22:32:42.727

> 1) 更便携，因为它是 Web。

好吧，您必须在这里定义“网络”的含义。它在 iOS（使用 Safari）或 Android 设备或其他一些设备上不起作用（除非我错过了什么）。它不是“web”，就像纯 HTML5 应用程序是“web”一样。

> 2) 我不需要在客户端和服务器应用程序中验证用户输入。

只有当服务器可以“知道”输入确实来自客户端时，这才是正确的。如果它只是一个网络请求，它可以被任何东西发布。根据我的经验，您应该*始终*在服务器上进行验证——客户端验证可以让用户的生活更轻松；服务器端验证是真正执行业务规则。

> 第三个优点是我的主要问题：我猜用户看不到我的代码，所以我的应用程序可以安全地抵御黑客。它是否正确？

不，代码在用户机器上运行；它将已被下载，并且可以像任何其他 .NET 程序集一样进行反编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T22:32:37.140

该程序集可以*很容易地*被提取和反编译，如果它在客户端上运行，您永远不会知道请求来自您的应用程序，因此甚至不要*考虑*跳过服务器验证。

# asp.net-mvc-2 - 指定 RouteValue 以匹配模式 /id

> ID：12665714
> 
> 赞同：0
> 
> 时间：2012-09-30T22:30:37.440
> 
> 标签：asp.net-mvc-2, maproute

我正在使用 asp.net mvc2，如果用户输入 foo.com/123，我希望我的网站显示详细信息（123 个）。我应该为此指定的路线值是什么，以什么顺序？我试过了

```
routes.MapRoute(
    name: "foobar",
    url: "{id}",
    defaults: new { controller = "foo", action = "bar", id = UrlParameter.Optional }
); 
```

但我得到一个 404。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T06:22:33.963

routes.MapRoute( name: "foobar", url: "{id}", 默认值: new { controller = "foo", action = "bar", id = UrlParameter.Optional } );

应该如下

```
 routes.MapRoute(
                "Default",              // Route name
                "{controller}/{action}/{id}",  // URL with parameters
                new { controller = "foo", action = "bar", id = ""// Parameter defaults

            ); 
```

# image - 喜欢按钮上的图像错误

> ID：12665719
> 
> 赞同：2
> 
> 时间：2012-09-30T22:31:36.260
> 
> 标签：image, facebook-like

首先，我是 facebook“like”按钮集成的新手

我的网页上有一个类似 facebook 的按钮 (http://www.mini-signs.dk/index.html)，但是按下类似按钮时显示的图像不正确。我尝试使用元标记

在页面之间和页面上，但似乎在同一文件夹中选择了图像名称 Galleri-Andet-Normal.jpg。

我试图删除图像并覆盖它，现在在喜欢侧面时在 facebook 时间轴上显示了一些不同的东西，但是点赞按钮对话框中的图像仍然是错误的。如果我将内容值放在浏览器中，则会显示正确的图像

我已经尝试了很多东西 og google 来解决我自己

请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T01:32:59.007

你唯一的选择就是你`change your meta tags and WAIT`。再次抓取您的页面后，您将获得新图像:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:30:08.783

试试看问题出在哪里

```
http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.mini-signs.dk%2Findex.html 
```

> og:image 引用的所有图像在两个维度上都应至少为 200 像素。请检查给定 url 中所有带有标签 og:image 的图像，并确保其符合推荐的规范。
> 
> 缺少 fb:admins 和 fb:app_id 标签。

# django - django 在任何视图 url 中提供登录凭据

> ID：12665721
> 
> 赞同：1
> 
> 时间：2012-09-30T22:31:42.557
> 
> 标签：django, login, pingdom

django 中是否有任何方法可以在访问应用程序中的任何视图时使用提供的凭据执行登录？

我的动机是使用诸如[Pingdom](https://www.pingdom.com/)之类的服务进行可用性监控。我想验证其可用性的大多数 url 都用 a 装饰，`@login_required`除非我以前登录过，否则无法访问。

我的想法解决方案将是一种在 GET 或 POST 参数中提供凭据时访问我的视图的方法。另一种选择可能是站点正常运行时间监控服务，它支持在访问相关 URL 之前登录并获取会话。

## 更新

感谢@Filip Dupanović 的指导和[这里](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.login)的代码，我的简单工作中间件如下所示：

```
from django.contrib.auth import authenticate, login

class AuthenticationEverywhereMiddleware(object):
    """
    Middleware to allow logging in by supplying login credentials in any URL
    """

    def process_request(self, request):
        if (request.GET.get('authenticateEverywhere','') == 'GET'):
            username = request.GET['username']
            password = request.GET['password']
            user = authenticate(username=username, password=password)
            if user is not None:
                if user.is_active:
                    login(request, user) 
```

我添加了触发参数`authenticateEverywhere`以防止与可能使用的视图`username`或`password`参数发生任何可能的冲突。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T23:12:15.280

你当然可以！您需要编写一个自定义[中间件类](https://docs.djangoproject.com/en/dev/topics/http/middleware/?from=olddocs)，该类实现一个自定义`process_request`方法，您可以在其中检查请求对象、获取凭据并在请求被路由到装饰有`login_required`.

# objective-c - 状态栏未隐藏在情节提要中

> ID：12665724
> 
> 赞同：4
> 
> 时间：2012-09-30T22:32:24.130
> 
> 标签：objective-c, ios

尽管我在我的 .plist 文件 UIStatusBarHidden 中将值设置为 YES，但它显示在情节提要中，但不在模拟器或设备中。如何从情节提要的视图中永久删除？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T22:44:51.723

You need to select your initial view controller (either a UINavigationController, a UITabbarController or a simple UIViewController...). Make sure you selected the controller itself and not the root view of the controller.
Then in the inspector on the right panel you can tell if you want to display the status bar.

![Interface Builder](../Images/f8288c2e4edae98b4e64d173f9e10862.png)

Select none for the initial controller in your storyboard and every controller connected to this one should hide the status bar automatically.
If you have "standalone" controllers on your storyboard you'll have to do the same thing for each of them.

# android - 如何永久保存数据，以便稍后在 Android 中访问？

> ID：12665730
> 
> 赞同：0
> 
> 时间：2012-09-30T22:33:35.503
> 
> 标签：android, file, save, storage

每当我按下后退按钮时，我的应用程序都不会调用`onSaveInstanceState()`，也无法保存数据。我正在尝试制作一个调度程序应用程序，即使按下后退按钮，我也需要保存已经设置的时间表。我想通过将源文件中的新数据添加到 stringArray 来动态编辑 ListView。我遇到的问题是文件 schedules.txt 没有保存。每当程序打开一个新活动时，该文件现在都是空白的。

这是我到目前为止的代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_schedules);
    ListView listview = (ListView) findViewById(R.id.scheduleListView);
    adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, schedulesList); 
    listview.setAdapter(adapter);
    Log.v("myapp", "currentlist of files associated with this program are: " + fileList());

    try {

        FileOutputStream fout = openFileOutput("schedules.txt", MODE_PRIVATE);
        Log.v("myapp", "FileOutputStream ran");

    } catch (FileNotFoundException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

try {
       Log.v("myapp", "first get old schedules call");
       getOldSchedules();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

public void editFile(String format) throws IOException {

    Log.v("myapp", "editFile ran");
    FileOutputStream fout = openFileOutput("schedules.txt", MODE_PRIVATE);
    OutputStreamWriter writer = new OutputStreamWriter(fout);

    writer.write("hello alex");
    writer.flush();
    writer.close();
    Log.v("myapp", "secondary getoldschedules call");
    getOldSchedules();
}

public void getOldSchedules() throws IOException{

    FileInputStream fis = openFileInput("schedules.txt");
    InputStreamReader reader = new InputStreamReader(fis);

    char[] inputbuffer = new char[32];
    reader.read(inputbuffer);
    String data = new String(inputbuffer);
    Log.v("myapp", "data in file reads: " + data);

    reader.close();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:14:17.560

这是 android 开发者网站上的数据存储选项指南，它应该告诉您您需要知道的一切：http: [//developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T23:15:37.123

据我所知，您的保存代码没有任何问题。没有被调用的原因`onSaveInstanceState`是因为在这种情况下它是错误的工作工具。只有当一个 Activity 被系统杀死以*将其带回来*时，才会调用该方法。来自 Android 文档：

> 当用户从活动 B 导航回活动 A 时调用 onPause() 和 onStop() 而不是此方法的一个示例：不需要在 B 上调用 onSaveInstanceState(Bundle)，因为该特定实例将永远不会被恢复，因此系统避免调用它。

使用后退按钮离开 Activity 是上述场景的一个示例 - Activity 正在被销毁，因此不需要保存状态以供以后恢复。`onSaveInstanceState`更多地是为小的 UI 事物而设计的，例如哪些复选框在其中进行了检查，或者在字段中输入的文本 - 而不是持久数据存储。您应该考虑将保存调用放入`onPause`（如果它很快的话）`onStop`、 或`onDestroy`.

# javascript - 等效于 file_get_contents 的 javascript

> ID：12665731
> 
> 赞同：0
> 
> 时间：2012-09-30T22:33:39.413
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk

我在 php 中使用下面的代码来发送 POST 数据，这个的 javascript 等价物是什么？

```
 $post_url = "https://graph.facebook.com/".$photo[id]."/tags/".$m."/?access_token=".$access_token."&x=20&y=20&method=POST"; 
 $response = file_get_contents($post_url); 
```

# android - `片段类的函数onCreateView的容器参数`的描述是什么意思？

> ID：12665732
> 
> 赞同：3
> 
> 时间：2012-09-30T22:33:58.577
> 
> 标签：android, android-fragments, android-view

[片段类的函数 onCreateView](http://developer.android.com/reference/android/app/Fragment.html#onCreateView%28android.view.LayoutInflater,%20android.view.ViewGroup,%20android.os.Bundle%29)的容器参数描述说：

*container ：如果非空，这是片段的 UI 应该附加到的父视图。片段不应添加视图本身，但这可用于生成视图的 LayoutParams。*

行吗

*片段不应该添加视图本身，但这可以用来生成视图的 LayoutParams*

意思`container.addView(some_view)`是不允许？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T07:46:45.953

正确的。您可以在调用`inflate()`on a `LayoutInflater`（例如）时使用此参数，或者如果您直接通过 Java 而不是膨胀创建片段内容，则`inflater.inflate(R.layout.frag, container, false);`可以确定需要什么。`LayoutParams`否则，容器归托管活动所有，您的片段应该不理会它，AFAIK。

# python - 从一个 XSLT 样式表处理多个 XML 文档

> ID：12665733
> 
> 赞同：0
> 
> 时间：2012-09-30T22:34:12.783
> 
> 标签：python, xml, xslt, xhtml

我正在创建 XSLT 样式表以从 XML 文档中提取不同城市的天气预报数据。目前，我有 3 个 XML 文件。但我不知道从一个 XSLT 样式表处理多个 XML 文档。我想使用我的一个城市的 XML 文件作为我的应用程序的主要 XML 文档，并为所有多个 XML 文档调用那个 XSLT 文件。

这是我在墨尔本的 XSLT 页面：

```
<xsl:template match="/">
        <xsl:text>Melbourne</xsl:text><br/>
        <xsl:for-each select="product/forecast/area[@description='Melbourne']/forecast-period">
            <xsl:value-of select="text[@type='forecast']"/>
            <xsl:value-of select="text[@type='precis']"/>
            <xsl:value-of select="element[@type='air_temperature_minimum']"/>,
            <xsl:value-of select="element[@type='air_temperature_maximum']"/><br/>
        </xsl:for-each>
        </xsl:template> 
```

我从 melbourne.xml 调用这个 xsl 页面。我想使用 melbourne.xml 作为主文档并从这里处理其他城市。

你们能给我一些想法吗？

PS 我是 XML 和 XSLT 的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T07:56:44.097

您可以使用 XSLT 函数[document()](http://www.w3.org/TR/xslt20/#document)打开一个外部 XML 文档。它返回文档节点。它以文档 URI(s) 作为参数。可选的第二个参数告诉如何解释相对 URI。

也许更好的选择是将元文档定义为 XSLT 的输入，其中包含要处理的文档的 URI：

```
<cities>
  <city url="melbourne.xml"/>
  <city url="timbuktu.xml"/>
</cities> 
```

然后您的 XSLT 可以从以下内容开始：

```
<xsl:template match="/cities">
  <xsl:apply-templates select="document(city/@url, .)/product"/>
</xsl:template> 
```

注意：您需要修改模板以匹配“产品”而不是 /，并相应地更改 for-each。

# php - 在 PHP 重定向期间处理片段标识符

> ID：12665737
> 
> 赞同：1
> 
> 时间：2012-09-30T22:35:06.197
> 
> 标签：php, jquery, redirect, fragment-identifier, jquery-bbq

我四处搜索（SO和谷歌），找不到任何关于其他人如何处理这种情况的适当解释。

在我的应用程序中，我使用 PHP/Apache 作为后端，使用[Ben Alman 的 jQuery BBQ 插件](http://benalman.com/projects/jquery-bbq-plugin/)作为标签浏览器历史记录。用户登录仅由 PHP 服务器端使用来自登录页面的 POST 处理，并使用服务器端会话维护状态。我遇到的问题是，如果用户访问带有片段（哈希）的 URL 并且他们没有登录，他们将被重定向到 HTTPS 登录页面。除了 URL 包含片段哈希之外，这在所有情况下都适用。从服务器端发起的任何重定向都会出现同样的情况。在这种情况下，不能使用 javascript 在重定向之前保留主题标签，因为页面加载在重定向之前永远不会完成。

我意识到片段将在重定向期间丢失（因为它只是客户端）并且服务器端永远不会看到，但是其他人如何处理这种情况并保留最初访问的 URL，以便用户最终可以正确登录或重定向后的页面？

任何建议表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-06-27T02:01:17.087

使用 JavaScript 使用片段填充隐藏的输入。

```
<input type="hidden" name="fragment" id="fragment">
<script>
if(window.location.hash){
    document.getElementById("#fragment").value=window.location.hash;
}
</script> 
```

然后在后端，您可以像这样重定向：

```
if(isset($_POST['fragment'])) {
    $fragment = '#'.$_POST['fragment'];
} else {
    $fragment = '';
}
header('Location: http://website/path'.$fragment);
exit; 
```

您*可能*应该对片段进行 urlencode。

# c# - 我想在语音输出之前显示表格

> ID：12665740
> 
> 赞同：0
> 
> 时间：2012-09-30T22:36:23.590
> 
> 标签：c#, text-to-speech

我的问题是程序在表单显示之前说话。

这是加载块：

```
/********************
*                  *
*    Start Game    *
*                  *
********************/
private void Battleship_Load(object sender, EventArgs e)
{
    // Interface housekeeping
    lblStatus.Font = new Font("HandelGotDLig", 18);

    // fill computer board
    game.buildBoards();
    human = game.Human;
    computer = game.Computer;
    shot = game.Initialize(ref human, ref shot);

    //set up displays
    gbComputerHistory.Visible = false;
    gbHumanHistory.Visible = false;
    gbShot.Visible = false;
    lblStatus.Text = "Choose who starts";
    gbStart.Visible = true;

    // display human board
    DisplayBoard(picHuman, human, false);

    // display computer ships
    DisplayBoard(picComputer, computer, false);
    this.Refresh();

    #if SPEECH
        Say("Welcome to BATTLESHIP! Prepare to Lose!");
        Say("Choose who starts first.");
    #endif
} 
```

我怀疑我可以把它埋在油漆事件中，但是我必须跟踪它是否已经说话了。

我不希望每次重新绘制表单时它都会说话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:40:21.310

尝试将语音代码添加到`Form_Shown`事件中。每当向用户显示表单时（当他们实际可以看到它时），就会引发此事件。来自[MSDN：](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.shown.aspx)

> Shown 事件仅在第一次显示表单时引发；随后最小化、最大化、恢复、隐藏、显示或无效和重新绘制不会引发此事件。

# excel - 通过 VSTO 中断运行 Excel 宏

> ID：12665741
> 
> 赞同：2
> 
> 时间：2012-09-30T22:36:49.947
> 
> 标签：excel, vsto

我通过 VSTO 将 Excel 作为计算引擎（无用户交互）运行，并且希望能够以编程方式取消长时间运行的宏。

我目前的方法是将阻塞调用在单独的线程上运行宏 (Application.Run("MyMacro"))，然后尝试从主线程中断它。

似乎没有任何用于此目的的内置方法调用，例如 Application.Interrupt()，因此我尝试以编程方式触发按下 CTRL+Break 或 ESC 时发生的键盘中断。

当前代码如下所示：

```
Application.CalculationInterruptKey = XlCalculationInterruptKey.xlAnyKey;
Application.EnableCancelKey = XlEnableCancelKey.xlInterrupt;

Application.SendKeys("{ESC}", false); //have tried with true as second argument 
```

在这种情况下，最后一行的代码块在宏完成之前不会执行。

我还尝试获取 Excel 的进程挂钩，将其设置为活动进程/窗口并调用 SendKeys 没有成功。

由于这需要成为执行任何宏的通用解决方案，因此我无法修改或提供有关宏内容的任何保证。

有任何想法吗？

谢谢，

PS 我也尝试过发送 CTRL+BREAK 键盘命令，如 Application.SendKeys("^{BREAK}", false); 调试器在此行暂停，直到宏完成执行，所以看起来 Application 对象被阻止处理任何更多命令，直到宏完成。

# php - 用 Str_Replace 替换多个单词

> ID：12665743
> 
> 赞同：5
> 
> 时间：2012-09-30T22:37:11.743
> 
> 标签：php, string, replace

我想用一个特定的词替换多个同义词。

```
<?p

$a = array(
'truck',
'vehicle',
'seddan',
'coupe',
'Toyota',
);
$b = array(
'car',
'car',
'car',
'car',
'Lexus',
);
$str = '

Honda is a truck. 
Toyota is a vehicle. 
Nissan is a sedan. 
Scion is a coupe.

';
echo str_replace($a,$b,$str);
?> 
```

结果：本田是一辆汽车。雷克萨斯是一辆汽车。日产是一辆汽车。Scion是一辆车。

有人能告诉我用“汽车”这个词替换“车辆、卡车、双门轿车、轿车”的干净方法，而不是我单独替换所有 4 个。谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T22:39:26.770

```
$a = array( 'truck', 'vehicle', 'sedan', 'coupe' );
$str = 'Honda is a truck. Toyota is a vehicle. Nissan is a sedan. Scion is a coupe.';
echo str_replace($a,'car',str_replace('Toyota','Lexus',$str)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-30T22:55:42.880

你应该使用[strtr](http://php.net/manual/en/function.strtr.php)

```
echo strtr($str,array_combine($a,$b)); 
```

或者只是将`$a`and组合`$b`成一个数组

```
$ab = array('truck' => 'car','vehicle' => 'car','sedan' => 'var','coupe' => 'var','Toyota' => 'Lexus');
echo strtr($str, $ab); 
```

输出

```
Honda is a car. 
Lexus is a car. 
Nissan is a car. 
Scion is a car. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-16T05:03:06.250

我找到了一个非常简单的解决方案来替换字符串中的多个单词：

```
<?php
 $str="    Honda is a truck. 
Toyota is a vehicle. 
Nissan is a sedan. 
Scion is a coupe.";

$pattern=array();
$pattern[0]="truck";
$pattern[1]="vehicle";
$pattern[2]="sedan";
$pattern[3]="coupe";

$replacement=array();
$replacement[0]="car";
$replacement[1]="car";
$replacement[2]="car";
$replacement[3]="car";

echo str_replace($pattern,$replacement,$str);?> 
```

**输出 ：**

```
 Honda is a car. 
Toyota is a car. 
Nissan is a car. 
Scion is a car 
```

使用此脚本，您可以根据需要替换字符串中任意数量的单词：

只需将单词（您要替换的）放在模式数组中，例如：

```
 $pattern[0]="/replaceme/"; 
```

并将字符（将用于代替被替换字符）放在替换数组中，例如：

```
 $replacement[0]="new_word"; 
```

快乐编码！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T22:48:33.543

就像是

```
$a = array( 'truck', 'vehicle', 'seddan', 'coupe' ); 

$str = 'Honda is a truck. Toyota is a vehicle. Nissan is a sedan. Scion is a coupe.'; 

echo str_replace($a,'car',$str); 
```

应该管用。

[http://codepad.org/1LhtcOSR](http://codepad.org/1LhtcOSR)

编辑：

这样的事情应该会产生预期的结果： http: [//pastebin.com/xGzYiCk3](http://pastebin.com/xGzYiCk3)

```
$text = '{test|test2|test3} some other stuff {some1|some2|some3}'; 
```

输出：

```
test3 其他一些东西 some1
test2 其他一些东西 some2
test3 一些其他的东西 some3
test3 其他一些东西 some1

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-23T11:03:56.100

用于用其他短语替换短语（一次多个）。您可以将数组作为参数传递给`str_replace()`

```
// Provides: You should eat pizza, beer, and ice cream every day
$phrase  = "You should eat fruits, vegetables, and fiber every day.";
$healthy = ["fruits", "vegetables", "fiber"];
$yummy   = ["pizza", "beer", "ice cream"];

$newPhrase = str_replace($healthy, $yummy, $phrase); 
```

# macos - "clang" 和 "Apple clang" 和有什么不一样？

> ID：12665744
> 
> 赞同：22
> 
> 时间：2012-09-30T22:37:16.227
> 
> 标签：macos, clang, macports

我刚刚升级到带有 clang 的 OS X 10.8.2。的输出`clang -v`是：

```
Apple clang version 4.1 (tags/Apple/clang-421.11.65) (based on LLVM 3.1svn)
Target: x86_64-apple-darwin12.2.0
Thread model: posix 
```

在 macports 上，有几个不同版本的 clang 可用（`port search clang`）：

```
clang @2.9 (lang)
    C, C++, Objective C and Objective C++ compiler
clang-2.9 @2.9 (lang)
    C, C++, Objective C and Objective C++ compiler
clang-3.0 @3.0 (lang)
    C, C++, Objective C and Objective C++ compiler
clang-3.1 @3.1 (lang)
    C, C++, Objective C and Objective C++ compiler
clang-3.2 @3.2-r164372 (lang)
    C, C++, Objective C and Objective C++ compiler 
```

OS X 附带的“Apple clang 4.1”是否与 macports 的 clang-3.1 相同（几乎或完全相同）？

另外，3.2 和 3.1 有什么不同？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-12-06T00:37:19.437

LLVM 3.1svn 意味着它是在 3.1 发布之后但在 3.2 之前（尚未发布）的某个时间分支的。Apple 不能使用已发布的 LLVM/Clang 版本。

从 clang 3.1 到 3.2（以及未来版本）的更改可以在[Release Notes](http://clang.llvm.org/docs/ReleaseNotes.html)中找到。

请注意，由于 3.2 尚未发布，因此发行说明不会包含完整的更改列表。

# java - Android deleteIntent 不起作用？我的代码有什么问题？

> ID：12665745
> 
> 赞同：1
> 
> 时间：2012-09-30T22:37:48.120
> 
> 标签：java, android, android-intent, notifications, alarmmanager

我正在尝试检测我的一个通知何时被清除（通过单独滑动它，或通过“删除所有”通知按钮）。我正在尝试解除 AlarmManager 警报，但到目前为止，它还没有为我工作。我的代码有什么问题？

```
onCreate(Bundle savedInstanceState) {

...

NotificationManager nm = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
Notification notif = new Notification(R.drawable.flag_red_large, reminderName, System.currentTimeMillis());

notif.deleteIntent = PendingIntent.getService(this, notifID, new Intent(this, CleanUpIntent.class), 0);

    //Destroy the activity/notification.
    finish();

}

class CleanUpIntent extends IntentService {
    public CleanUpIntent() {
        super("CleanUpIntent");
    }

    @Override
    protected void onHandleIntent(Intent arg0) {
        System.out.println(">>>>>>>>>>>>>>>>>>>" + "Repeating Alarm Cancelled...");

        Intent i = new Intent("com.utilityapps.YouForgotWhat.DisplayReminderNotification");
        int reminderID = i.getExtras().getInt("reminderID");

        PendingIntent displayIntent = PendingIntent.getBroadcast(this, reminderID, i, PendingIntent.FLAG_CANCEL_CURRENT);

        AlarmManager alarmManager = (AlarmManager) this.getSystemService(Context.ALARM_SERVICE); 

        alarmManager.cancel(displayIntent);
        displayIntent.cancel();
        }

    }

} 
```

正如你所看到的，我在`System.out.println()`我的子类中加入了一个来检查我的代码是否到达了那个类。我在 LogCat 输出中看不到那条线，所以我假设由于某种原因，我的`PendingIntent.getService()`线不起作用。我该如何解决这个问题？谢谢！:D

# ios6 - 其他开发者开发的App可以访问Passbook Pass吗？

> ID：12665747
> 
> 赞同：1
> 
> 时间：2012-09-30T22:38:16.507
> 
> 标签：ios6, passbook

我可以创建可供其他开发人员使用的应用程序访问的存折通行证吗？根据我的阅读，似乎有某种形式的身份验证使配套应用程序有权根据 passTypeId 访问手机上的存折通行证。如果我与其他应用程序共享 passTypeId，那么这些应用程序是否能够从我的通行证中读取信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T20:50:01.810

如果您从其他开发人员的服务器收到 pkpass 数据，您可以显示他们的通行证，甚至可以将其保存到存折中。但是，除非您将他们的通行证类型标识符绑定到您自己的开发者帐户/配置文件，否则您将无法通过您的应用实际查看/操作他们的通行证。即，当您调用 [passLibrary pass] 时，只会返回您的应用有权获得的通行证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T21:39:34.023

不可以。您必须与其他开发人员共享为该 passTypeId 创建的实际存折证书，包括您的分发证书（我认为），以便他们可以使用钥匙串中的这些证书构建他们的应用程序。似乎 Apple 并未将通行证设计为可在开发人员之间共享或使用。

**更新**我已经向 Apple 提交了一个增强请求，要求应用程序可以有权使用其他开发人员创建的通行证类型标识符，在构建时需要两个证书/配置文件。到今天为止，即使在构建时所有必需的证书/配置文件都可用，也无法这样做。我没有屏住呼吸。

# android - 在 Android 中多次调用 ffmpeg main 失败

> ID：12665748
> 
> 赞同：2
> 
> 时间：2012-09-30T22:38:36.647
> 
> 标签：android, ffmpeg, main

我已将 ffmpeg 库移植到 Android。使用 JNI 接口，我可以通过向 ffmpeg 的 main 方法提供参数来运行 ffmpeg 命令，就像从命令行一样。

为了获取视频的特定部分，我使用以下命令：

> ffmpeg -i /mnt/sdcard/input_video.mp4 -ss 00:00:12 -t 00:00:10 -an /mnt/sdcard/output_video.mp4

而且效果很好。视频从 12\. 秒分割到 22\. 秒并保存视频，方法正常返回（为 0）。

但是，如果我在第一个调用完成后进行第二次类似的调用（例如不同的开始时间），ffmpeg 将无法处理请求并引发分段错误。

对于第一个电话，它提供了这样的信息：

> 输入流#0.0 的猜测通道布局：单声道

和作品。但是对于第二个，消息是这样的：

> 输入流#1.0 的猜测通道布局：单声道

它不起作用。我不知道它是否与错误有关。

一般来说，这个问题应该与静态全局变量有关（我认为），但我无法正确重置它们。对ffmpeg的主要方法进行多次成功调用的解决方案可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:09:50.920

[https://github.com/jhotovy/android-ffmpeg](https://github.com/jhotovy/android-ffmpeg)

从同一个 Activity 多次调用 ffmpeg 的 main() 会导致段错误。这仍然是 libffmpeg 的问题，但 libffmpeginvoke 至少应用了此处描述的创可贴解决方案：[在 Activity 中调用第三方库的本机方法两次会导致 Android 应用程序关闭](https://stackoverflow.com/questions/10649119/calling-native-method-twice-of-third-party-library-in-an-activity-causes-the-and)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-27T15:37:31.400

Hiko制作的这个来自github的例子可以帮助其他人解决问题。 [JNI 多次调用 ffmpeg](https://github.com/HikoQiu/JNI_INVOKE_FFMPEG/blob/master/jni/ffmpeg.c#L4122)

它的作用是在 main() 方法的开头重新初始化静态变量，如下所示：

```
int main(int argc, char **argv)
{
    LOGI("start run in main.");
    received_sigterm = 0;
    received_nb_signals = 0;
    transcode_init_done = 0;
    ffmpeg_exited = 0;
    main_return_code = 0;

    run_as_daemon  = 0;
    nb_frames_dup = 0;
    nb_frames_drop = 0;

    nb_input_streams = 0;
    nb_input_files   = 0;
    nb_output_streams = 0;
    nb_output_files   = 0;
    nb_filtergraphs = 0;
    int ret;
    int64_t ti;

    register_exit(ffmpeg_cleanup);
    ............................................
    ............................................
    ........... The rest of the code ........... 
```

通过添加这些行，您将永远不会再遇到段错误。

# cocoa-touch - cocoa touch hitTest withEvent 可以识别 UIView 子类

> ID：12665750
> 
> 赞同：0
> 
> 时间：2012-09-30T22:38:52.153
> 
> 标签：cocoa-touch, ios5, uiview, uiresponder

我有一个带有子视图的视图，这些子视图是 UIView 的子类，在示例中子类称为 ESDcelda

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        UIImage *img = [UIImage imageNamed:@"lgrey091.gif"];
        [self setBackgroundColor:[UIColor colorWithPatternImage:img]];

        ESDcelda *cel1 = [[ESDcelda alloc] initWithTipo:1];
        [cel1 setFrame:CGRectMake(100, 100, cel1.frame.size.width, cel1.frame.size.height)];
        [self addSubview:cel1];

        cel1 = [[ESDcelda alloc] initWithTipo:2];
        [cel1 setFrame:CGRectMake(300, 100, cel1.frame.size.width, cel1.frame.size.height)];
        [self addSubview:cel1];
    }
    return self;
} 
```

现在我想知道我用以下方法用touchEvents指向什么样的UIView，但在日志中指针“vista”只能识别self类或UIView类，有什么方法可以识别子类“celdaSel “？

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [[touches allObjects] objectAtIndex:0];

    [self perfTouch:touch];
}

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [[touches allObjects] objectAtIndex:0];

    [self perfTouch:touch];
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [[touches allObjects] objectAtIndex:0];

    [self perfTouch:touch];
}

-(void)perfTouch:(UITouch *)touch
{
    CGPoint punto = [touch locationInView:self];

    UIView *vista = (ESDcelda *)[self hitTest:punto withEvent:nil];

    if (![vista isKindOfClass:[self class]])
    {
        celdaSel = (ESDcelda *)vista;
        [celdaSel seleccion:YES];
    }
    else
    {
        if (celdaSel != nil)
        {
            [celdaSel seleccion:NO];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T00:29:15.820

解决了，有步骤

1.  在主视图中只留下了与触摸交互的代码以及它在哪里。

v

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [[touches allObjects] objectAtIndex:0];

    [self perfTouch:touch];
}

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [[touches allObjects] objectAtIndex:0];

    [self perfTouch:touch];
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [[touches allObjects] objectAtIndex:0];

    [self perfTouch:touch];

    if (self.celdaSel != nil)
    {
        NSLog(@"%d",self.celdaSel.elemento);
    }
}

-(void)perfTouch:(UITouch *)touch
{
    CGPoint punto = [touch locationInView:self];

    [self hitTest:punto withEvent:nil];

} 
```

1.  在名为 ESDCelda 的 UIView 子类中，我覆盖 pointInside:withEvent 方法以了解当前单次触摸是否在视图上，“inter”是让我知道触摸是否在视图上的变量，“seleccionada”表示视图是否突出显示，“conten”是指向超级视图的指针，“seleccion:”是突出显示它自己的视图的方法。

v

```
-(BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event
{
    BOOL inter = [super pointInside:point withEvent:event];
    if (inter)
    {
        //NSLog(@"%i, %@", inter, self);
        if (!self.selecionada)
        {
            [self seleccion:YES];
            if (self.conten.celdaSel != nil)
                [self.conten.celdaSel seleccion:NO];
            [self.conten setCeldaSel:self];
        }
    }
    else
    {
        if (self.selecionada)
        {
            [self seleccion:NO];
            [self.conten setCeldaSel:nil];
        }
    }
    return inter;
} 
```

# c# - 如何在 Mono 中运行 MVC3 或更新的应用程序

> ID：12665751
> 
> 赞同：3
> 
> 时间：2012-09-30T22:38:58.597
> 
> 标签：c#, asp.net-mvc-3, visual-studio-2010, c#-4.0, mono

默认 ASP .NET MVC 3 应用程序是使用 Microsoft Web Developer Express 2010 创建的

应用程序发布到文件系统并复制到安装了 mono 2.10.8 、 Apache 和 mod_mono 的 Debian 服务器。

尝试运行应用程序会导致错误：

```
Server Error in '/mvc3test' Application

--------------------------------------------------------------------------------

Could not load type 'System.Web.WebPages.Razor.RazorBuildProvider' from assembly 'System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.

Description: HTTP 500\. Error processing request.

Stack Trace: 

System.TypeLoadException: Could not load type 'System.Web.WebPages.Razor.RazorBuildProvider' from assembly 'System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.
  at (wrapper managed-to-native) System.Type:type_is_assignable_from (System.Type,System.Type)
  at System.Type.IsAssignableFrom (System.Type c) [0x00000] in <filename unknown>:0 
  at System.Web.Compilation.BuildProvider.RegisterBuildProvider (System.String extension, System.Type providerType) [0x00000] in <filename unknown>:0 
  at System.Web.WebPages.Razor.PreApplicationStartCode.Start () [0x00000] in <filename unknown>:0 
  at System.Web.Mvc.PreApplicationStartCode.Start () [0x00000] in <filename unknown>:0 
  at (wrapper managed-to-native) System.Reflection.MonoMethod:InternalInvoke (System.Reflection.MonoMethod,object,object[],System.Exception&)
  at System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) [0x00000] in <filename unknown>:0  

--------------------------------------------------------------------------------
Version information: Mono Runtime Version: 2.10.8.1 (mono-2-10/70a5c95 Wed Feb 8 18:11:45 CET 2012); ASP.NET Version: 4.0.30319.1 
```

bin 目录包含从 windows 复制的所需 dll：

```
EntityFramework.dll
mvc3test.dll
System.Web.Entity.dll
System.Web.Helpers.dll
System.Web.Mvc.dll
System.Web.WebPages.dll
System.Web.WebPages.Razor.dll
mvc3test.pdb
EntityFramework.xml 
```

所以所有必需的dll都存在

如何以单声道运行 mvc3 或 mvc4 应用程序或修复此错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T01:29:43.617

需要的dll比那些多。您应该右键单击您的项目并选择 Add Deployable Dependencies，然后选中前两个框（如果您使用的是 sql ce，则选中前三个框）

请参阅此[http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx](http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx)

哦，2.10.x 分支目前不支持 MVC4。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:33:41.923

检查 copy local = true 特别是对于 `<private>true</private>`csproj 文件中提示路径下的 mvc.dll

# php - PHP数据库连接 - 选择数据库时出错

> ID：12665755
> 
> 赞同：0
> 
> 时间：2012-09-30T22:39:23.167
> 
> 标签：php, connection, database-connection

尝试使用 PHP 连接到数据库时遇到问题。我收到以下错误

```
Notice: Undefined variable: dbhandle in /opt/lampp/htdocs/connection/Connection.php on line 17

Warning: mysql_select_db() expects parameter 2 to be resource, null given in /opt/lampp/htdocs/connection/Connection.php on line 17
Could not select test 
```

我的连接文件：

```
<?php

  function Connection() {
  $username = "root";
  $password = "";
  $hostname = "localhost"; 

  $dbhandle = mysql_connect($hostname, $username, $password) 
    or die("Unable to connect to MySQL");
  echo "Connected to MySQL<br>";

  mysql_query("SET NAMES utf8");
  }

  function SelectDatabase() {
  $name = "test";
  $selected = mysql_select_db("$name",$dbhandle) 
    or die("Could not select $name");
}
    ?> 
```

索引.php

```
<html>
<head>
<?php include 'Connection.php'; ?>

</head>
<body>
<?php Connection() ?>
<?php SelectDatabase() ?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:42:07.267

`$dbhandle`在 中使用时超出范围`SelectDatabase`。您可能想要`Connection()`return `$dbhandle`。这样，你可以这样做：

```
<?php SelectDatabase(Connection()) ?> 
```

当然，您必须修改`SelectDatabase`以将连接变量作为参数。

或者，您也可以创建`$dbhandle`一个全局变量，以便可以在脚本中的任何位置使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T22:42:58.063

这是一个范围界定问题：`$dbhandle`是本地的`Connection()`

您可以使用`global $dbhandle;`不是很优雅的全局变量（放在两个函数的开头），或者

```
function Connection() {
  $username = "root";
  $password = "";
  $hostname = "localhost"; 

  $dbhandle = mysql_connect($hostname, $username, $password) 
    or die("Unable to connect to MySQL");
  echo "Connected to MySQL<br>";

  mysql_query("SET NAMES utf8");

  return $dbhandle;
}

function SelectDatabase($dbhandle) {
  $name = "test";
  $selected = mysql_select_db("$name",$dbhandle) 
    or die("Could not select $name");
} 
```

和

```
</head>
<body>
<?php $db=Connection() ?>
<?php SelectDatabase($db) ?>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:42:59.360

这里的问题很容易发现；你永远不会将`$dbhandle`参数传递给你的函数。您需要这样做，以便函数可以使用参数；由于范围问题，并非所有参数都可立即用于所有函数。

请尝试以下操作：

```
function SelectDatabase($dbhandle) {
    $name = "test";
     $selected = mysql_select_db("$name",$dbhandle) 
         or die("Could not select $name");
} 
```

然后，当您调用该函数时：

```
SelectDatabase($dbhandle); 
```

确保 $dbhandle 是全局的。

要么，或者正如其他人指出的那样，`Connection()`返回变量名，并在调用中使用它。

其次，`mysql_*`函数被弃用。我建议你[`PDO`](http://www.php.net/manual/en/intro.pdo.php)改用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T22:49:13.620

你不会让你的生活更轻松：p

你只需要这样做：

```
$connexion = new PDO("mysql:host=localhost;dbname=test","root","password"); 
```

如果您只想发出 sql 请求：

```
$connexion->query("SQL REQUEST ...."); 
```

# php - 格式化 PHP 记录集中的信息并将其设置为数组

> ID：12665758
> 
> 赞同：-2
> 
> 时间：2012-09-30T22:39:42.137
> 
> 标签：php

我正在尝试使用管理器类来获取查询结果并对信息进行格式化，这样我就不必对我的视图有逻辑了。我搜索了一些解决方案，并认为这会起作用，但我的 Key=>values 数组返回空白。有人可以看看它，看看我做错了什么吗？谢谢！

我已经验证 $results 包含我试图格式化并放回数组的值。

```
while($row = mysqli_fetch_array($results)){
    $pets[$row['petID']] = $row['petID'];
    $pets[$row['chipID']]=$row['chipID'];
    $pets[$row['adoptionDate']]=Date($row['adoptionDate'],'m-d-Y');
    $pets[$row['pType']]=$row['pType'];
    $pets[$row['breedName2']]=$row['breedName2'];
    $pets[$row['breedName1']]=$row['breedName1'];
    $pets[$row['imageName']]=$row['imageName'];
    $pets[$row['intakeDate']]= Date($row['intakeDate'],'m-d-Y');
    $pets[$row['status']]=$row['status'];
    $pets[$row['age']]=$row['age'];
    $pets[$row['ageText']]= $this->getAge($row['age']);
    $pets[$row['gender']]=$row['gender'];
    $pets[$row['genderText']] = $this->getGender($row['gender']);
    $pets[$row['breed2']]=$row['breed2'];
    $pets[$row['breed']]=$row['breed'];
    $pets[$row['petType']]=$row['petType'];
    $pets[$row['petName']]=$row['petName'];
    $pets[$row['customID']]=$row['customID'];
} 
```

这是不返回任何内容的完整函数：

```
public function getPets($cond,$orgID){

        $pets = array();
        $pg = new petsGateway();
        $results = $pg->listByQuery($cond, $orgID);

        while($row = mysqli_fetch_array($results)){
            $pets[$row['petID']] = $row['petID'];
            $pets[$row['chipID']]=$row['chipID'];
            $pets[$row['adoptionDate']]=Date($row['adoptionDate'],'m-d-Y');
            $pets[$row['pType']]=$row['pType'];
            $pets[$row['breedName2']]=$row['breedName2'];
            $pets[$row['breedName1']]=$row['breedName1'];
            $pets[$row['imageName']]= $this->getImageURL($row['imageName']);
            $pets[$row['intakeDate']]= Date($row['intakeDate'],'m-d-Y');
            $pets[$row['status']]=$row['status'];
            $pets[$row['age']]=$row['age'];
            $pets[$row['ageText']]= $this->getAge($row['age']);
            $pets[$row['gender']]=$row['gender'];
            $pets[$row['genderText']] = $this->getGender($row['gender']);
            $pets[$row['breed2']]=$row['breed2'];
            $pets[$row['breed']]=$row['breed'];
            $pets[$row['petType']]=$row['petType'];
            $pets[$row['petName']]=$row['petName'];
            $pets[$row['customID']]=$row['customID'];
        }
        return $pets;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:40:15.930

**那是相当...重复的代码...修改查询以获取所需的行并**直接在数据库中进行日期格式化不是更容易吗？

例如

```
SELECT rowID, ... DATE_FORMAT(adoptionDate, '%m-%d-%Y'), ...
FROM ... 
```

进而

```
while($row = mysql_fetch_assoc($result)) {
   $pets[] = $row;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:51:05.143

嗯....好吧，我不确定您想要什么，但是正如您现在拥有的那样，您的数组的键和值将是相同的，这使得它毫无用处。

即宠物名称 `$pets['Fido'] = 'Fido'`

可能您想摆脱`$row`作业左侧的部分，以便最终得到这个

```
while($row = mysqli_fetch_array($results))
{
    $pet = Array();

    $pet['petID']        = $row['petID'];
    $pet['chipID']       = $row['chipID'];
    $pet['adoptionDate'] = Date($row['adoptionDate'],'m-d-Y');
    $pet['pType']        = $row['pType'];
    $pet['breedName2']   = $row['breedName2'];
    $pet['breedName1']   = $row['breedName1'];
    $pet['imageName']    = $row['imageName'];
    $pet['intakeDate']   = Date($row['intakeDate'],'m-d-Y');
    $pet['status']       = $row['status'];
    $pet['age']          = $row['age'];
    $pet['ageText']      = $this->getAge($row['age']);
    $pet['gender']       = $row['gender'];
    $pet['genderText']   = $this->getGender($row['gender']);
    $pet['breed2']       = $row['breed2'];
    $pet['breed']        = $row['breed'];
    $pet['petType']      = $row['petType'];
    $pet['petName']      = $row['petName'];
    $pet['customID']     = $row['customID'];

    $pets.push($pet);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:51:55.580

这将在每次循环记录时重写 $pets[KEY]。你要..

```
$pets[]['petID'] = $row['petID'];
$pets[]['chipID'] = $row['chipID']; 
```

等等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T22:56:52.210

我在猜，但我知道你想要一些类似的东西：

```
while($row = mysqli_fetch_array($results)){
    $pets[$row['petID']]['petID']        = $row['petID'];
    $pets[$row['petID']]['chipID']       = $row['chipID'];
    $pets[$row['petID']]['adoptionDate'] = Date($row['adoptionDate'],'m-d-Y');
    $pets[$row['petID']]['pType']        = $row['pType'];
    $pets[$row['petID']]['breedName2']   = $row['breedName2'];
    $pets[$row['petID']]['breedName1']   = $row['breedName1'];
    $pets[$row['petID']]['imageName']    = $row['imageName'];
    $pets[$row['petID']]['intakeDate']   = Date($row['intakeDate'],'m-d-Y');
    $pets[$row['petID']]['status']       = $row['status'];
    $pets[$row['petID']]['age']          = $row['age'];
    $pets[$row['petID']]['ageText']      = $this->getAge($row['age']);
    $pets[$row['petID']]['gender']       = $row['gender'];
    $pets[$row['petID']]['genderText']   = $this->getGender($row['gender']);
    $pets[$row['petID']]['breed2']       = $row['breed2'];
    $pets[$row['petID']]['breed']        = $row['breed'];
    $pets[$row['petID']]['petType']      = $row['petType'];
    $pets[$row['petID']]['petName']      = $row['petName'];
    $pets[$row['petID']]['customID']     = $row['customID'];
} 
```

这样，您就有了一个数组，其中所有宠物 ID 作为第一个键，其详细信息在第二个键中。您也可以使用数组推送。

# vb.net - Needleman wunsch 算法

> ID：12665765
> 
> 赞同：0
> 
> 时间：2012-09-30T22:41:05.817
> 
> 标签：vb.net, visual-studio-2008

我目前正在构建一个应用程序，它可以解码 DNA 序列并输出 RNA 和蛋白质序列。我正在尝试扩展它，以便能够根据 needleman wunsch 算法对齐两个蛋白质序列；但不幸的是，我无法在“Visual Basic”中这样做。因为我来自非编码背景，这是我第一次尝试编码任何东西，所以如果你能把我的船开到码头，那将会有很大的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:50:10.883

网上有一些该算法的实现，如下所示：http: [//kunuk.wordpress.com/2010/10/17/dynamic-programming-example-with-c-using-needleman-wunsch-algorithm/](http://kunuk.wordpress.com/2010/10/17/dynamic-programming-example-with-c-using-needleman-wunsch-algorithm/) - 你可以在你的程序中使用它。

# android - “doInBackground（URL ... urls）”中的三个点是什么意思？

> ID：12665769
> 
> 赞同：9
> 
> 时间：2012-09-30T22:41:27.877
> 
> 标签：android, android-asynctask

每个函数中的“...”是什么意思？为什么在最后一个函数中没有“...”？

```
private class DownloadFilesTask extends AsyncTask<URL, Integer, Long> {
     protected Long doInBackground(URL... urls) {
         int count = urls.length;
         long totalSize = 0;
         for (int i = 0; i < count; i++) {
             totalSize += Downloader.downloadFile(urls[i]);
             publishProgress((int) ((i / (float) count) * 100));
             // Escape early if cancel() is called
             if (isCancelled()) break;
         }
         return totalSize;
     }

     protected void onProgressUpdate(Integer... progress) {
         setProgressPercent(progress[0]);
     }

     protected void onPostExecute(Long result) {
         showDialog("Downloaded " + result + " bytes");
     }
 } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-30T23:00:24.957

[正如莫里森所说](https://stackoverflow.com/a/12665783/119114)，`...`语法适用于*可变*长度的参数列表（`urls`包含多个`URL`）。

这通常用于允许用户`AsyncTask`执行诸如（在您的情况下）传递多个 URL 以在后台获取的操作。如果您只有一个 URL，则可以这样使用`DownloadFilesTask`：

```
DownloadFilesTask worker = new DownloadFilesTask();
worker.execute(new URL("http://google.com")); 
```

或使用多个 URL，请执行以下操作：

```
worker.execute(new URL[]{ new URL("http://google.com"), 
                          new URL("http://stackoverflow.com") }); 
```

`onProgressUpdate()`用于让后台任务向 UI 传达进度。由于后台任务可能涉及**多个**作业（每个 URL 参数一个），因此为每个任务发布单独的进度值（例如 0 到 100% 完成）可能是有意义的。你不必。您的后台任务当然可以选择计算**总**进度值，并将该单个值传递给`onProgressUpdate()`.

`onPostExecute()`方法有点不同。它处理**单个**结果，来自在 中完成的一组操作`doInBackground()`。例如，如果您下载多个 URL，那么如果其中**任何**一个失败，您可能会返回失败代码。输入参数`onPostExecute()`将是您从**返回**`doInBackground()`的任何值。这就是为什么在这种情况下，它们都是`Long`值。

如果`doInBackground()`返回`totalSize`，则该值将被传递`onPostExecute()`，它可用于通知用户发生了什么，或您喜欢的任何其他后处理。

如果您确实需要作为后台任务的结果来传达多个*结果*，您当然可以将`Long`通用参数更改为 a 以外的其他`Long`值（例如某种集合）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-30T22:44:04.193

在 Java 中，它称为 Varargs，它允许可变数量的参数。

[http://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/varargs.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-06T11:34:52.867

这三个点`...`用于表示[省略号](https://en.wikipedia.org/wiki/Ellipsis)，在我们的 Java 语言中，这些点用于表示[varangs](http://www.javatpoint.com/varargs)（可变参数数量）。

让我稍微解释一下[varangs](http://www.javatpoint.com/varargs)：

> varangs允许方法接受零个或多个参数。[如果](http://www.javatpoint.com/varargs)我们不知道必须在方法中传递多少个参数，varargs 是更好的方法。

**可变参数的语法：**

[可变参数](http://www.javatpoint.com/varargs)使用[省略号](https://en.wikipedia.org/wiki/Ellipsis)，即数据类型后的三个点。语法如下：

> `return_type method_name(data_type... variableName){}`

**java中可变参数的简单示例：**

```
class VarargsExample1{  

 static void display(String... values){  
  System.out.println("display method invoked ");  
 }  

 public static void main(String args[]){  

 display();//zero argument   
 display("my","name","is","varargs");//four arguments  
 }   
} 
```

> **可变参数规则：**
> 
> 使用可变参数时，您必须遵循一些规则，否则程序代码将无法编译。规则如下：
> 
> 方法中只能有一个变量参数。变量参数 (varargs) 必须是最后一个参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-01T22:45:23.877

**非常简短（和基本）的答案：** 这表示“转换”为数组的可变数量的项目，它应该是最后一个参数。例子：

```
test("string", false, 20, 75, 31);

void test(String string, boolean bool, int... integers) {
    // string = "string"
    // bool = false
    // integers[0] = 20
    // integers[1] = 75
    // integers[2] = 31
} 
```

但你也可以打电话

`test("text", true, 15);`

或者

`test("wow", true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 100, 123, 345, 9123);`

# java - 执行递归时的 Stackoverflow

> ID：12665772
> 
> 赞同：0
> 
> 时间：2012-09-30T22:42:31.903
> 
> 标签：java, recursion, stack-overflow

执行此递归时收到 stackoverflow 错误。有一种模式，它首先说一次：

> 在 MazeGui.move(MazeGui.java:79) 这是行 if(rigting.goal == true) {

然后它说以下两个，并且它们都在输出中重复了很长时间。问题发生在某个地方，我只是不确定是什么：

> 在 MazeGui.move(MazeGui.java:89)**这是行 move(rigting.right, pos); //向右移动**
> 
> 在 MazeGui.move(MazeGui.java:107)**这是行 move(rigting.left, pos); //向左移动**
> 
> ...
> 
> ...

我错过了终止条件或其他什么，是否发生了一些无限递归？我无法将我的头包裹起来，完全迷失了。任何帮助，将不胜感激。

**编码：**

```
public boolean move(Maze rigting, int pos)
{
    if (rigting.goal == true)
    {
        return true;
    }
    if (rigting.wallR != true)
    {
        pos += 1;
        move(rigting.right, pos); //moves right

        showLabel(pos);
        return true;
    }
    if(rigting.wallD != true) //checks if there is a wall below
    {
        pos += 10;
        move(rigting.down, pos); //moves down

        showLabel(pos);
        return true;
     }
     if(rigting.wallL != true) //checks if there is a wall on the left
     {
        pos -= 1;
        move(rigting.left, pos); //moves left

        showLabel(pos);
        return true;
     }
     if(rigting.wallU != true) //checks if there is a wall above
     {
        pos -= 10;
        move(rigting.up, pos); //moves up

        showLabel(pos);
        return true;
     }

     return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:52:28.643

您的“路径”算法有一个简单的递归循环。

在这种情况下，您的算法计算出您必须向右移动。然后，一旦你这样做了，它就会计算出你必须向左移动。一旦你向左移动，你就回到了上次的位置。由于你回到了起始位置，循环重新开始，并以这种方式无限地继续（或者，真的，直到堆栈溢出）。

一个可能的解决方案是分析您的应用程序的状态，并在状态更新的任何时候检测您之前是否处于该状态；如果是，请相应地修改您的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:49:50.813

你可能想尝试这样的事情，

```
public boolean move(Maze rigting, int pos)

{
    if (rigting.goal == true)
    {
         return true;
    }

    if (rigting.wallR != true)
    {
         pos += 1;
         showLabel(pos);
         return move(rigting.right, pos); //moves right
    }

    if(rigting.wallD != true) //checks if there is a wall below
    {
        pos += 10;
        showLabel(pos);
        return move(rigting.down, pos); //moves down
    }
    if(rigting.wallL != true) //checks if there is a wall on the left
    {
        pos -= 1;
        showLabel(pos);
        return move(rigting.left, pos); //moves left
    }

    if(rigting.wallU != true) //checks if there is a wall above
    {
        pos -= 10;
        showLabel(pos);
        return move(rigting.up, pos); //moves up
    }

    return false;
} 
```

# java - Peer 2 Java 中的对等连接

> ID：12665773
> 
> 赞同：1
> 
> 时间：2012-09-30T22:42:43.477
> 
> 标签：java, routing, network-programming, p2p, file-sharing

我得到了一个项目，我必须在没有任何中间服务器的情况下与同行共享文件。我想知道如何知道网络上有多少主机在线以及如何连接到它们。我必须通过Java为我的计算机中的主机粗略地制作路由表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:48:53.690

您不需要跟踪任何路由。您只需要知道端点地址。

您可以通过与该主机建立连接来了解该主机是否连接到网络。

您提到不会有中间服务器，因此 NAT 打孔超出了您的问题范围。

作为起点看`java.net.Socket`类文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:04:16.450

我将假设这是在专用网络上。相对包含的东西。让他们通过互联网找到彼此听起来像是一场噩梦。

因此，考虑到这一点，您的同行找到彼此的一个模型可能是选择标准化的端口序列和活动信号。然后，当对等方搜索其他人时，它会简单地遍历网络上的所有 IP，并在该端口号上发出请求。如果它得到一个活动信号，它会将它添加到一个表中。发出信号的计算机也必须记录新来的人。

您必须选择端口序列，以便它们在网络上通常不使用。（相当大）我说顺序是为了加快搜索速度。

为了进一步加快搜索速度，当发送活动信号时，它还可以发送它的对等表和它检查的 IP（以及它以相同方式接收的 IP）。然后新的对等点只需要检查网络上的新 IP，因为带有新程序实例的旧 IP 会自行建立。

希望有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-15T18:51:22.433

我建议你不要使用mac地址，如果你把你的dhcp关闭你的路由器会更好（如果你当然可以包括一个........但如果你只能包括一个集线器，你'我猜会被迫使用mac地址）。并为您的ipv4地址使用手动寻址，您将能够轻松连接到其他计算机。

# haskell - 更广义的新类型推导

> ID：12665779
> 
> 赞同：9
> 
> 时间：2012-09-30T22:43:17.483
> 
> 标签：haskell, ghc, typeclass, newtype

在某些类上下文中使用时，新类型通常用于更改某些类型的行为。例如，可以使用`Data.Monoid.All`包装器来更改`Bool`用作`Monoid`.

我目前正在编写一个适用于各种不同类型的新型包装器。包装器应该改变一个特定类实例的行为。它可能看起来像这样：

```
newtype Wrapper a = Wrapper a

instance Special a => Special (Wrapper a) where
  -- ... 
```

但是，添加此包装器通常会改变包装类型的可用性。例如，如果我以前能够使用 function `mconcat :: Monoid a => [a] -> a`，我现在不能将它用于包装值的列表。

我当然可以使用`-XGeneralizedNewtypeDeriving`and `newtype Wrapper a = Wrapper a deriving (Monoid)`。但是，这仅解决了`Monoid`其他类的问题，而我将处理一个充满不同类的开放世界，并且独立的孤儿广义新类型派生并不是一个实际的选择。理想情况下，我想写`deriving hiding (Special)`（派生除 之外的所有类`Special`），但这当然不是有效的 Haskell。

有什么方法可以做到这一点，还是我只是搞砸了，需要添加 GHC 功能请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T03:32:13.137

看，[`GeneralizedNewtypeDeriving`不安全](http://joyoftypes.blogspot.com/2012/08/generalizednewtypederiving-is.html)。在这种情况下，这是一种不安全的做法

```
{-# LANGUAGE GADTs, ConstraintKinds #-}
import Data.Monoid
import Unsafe.Coerce

data Dict c where
  Dict :: c => Dict c

newtype Wrapper a = Wrapper a

addDictWrapper :: Dict (f a) -> Dict (f (Wrapper a))
addDictWrapper = unsafeCoerce 
```

然后，您可以在需要 typeclass 实例的任何时候使用它

```
intWrapperNum :: Dict (Num (Wrapper Int))
intWrapperNum = addDictWrapper Dict

two :: Wrapper Int
two = case intWrapperNum of
           Dict -> 1 + 1 
```

这种传递显式字典的系统非常通用，并且有一个非常好的（尽管是实验性的）库来支持它，称为[Data.Constraint](http://hackage.haskell.org/packages/archive/constraints/latest/doc/html/Data-Constraint.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T06:46:07.733

恐怕在 GHC 中没有直接的方法可以做到这一点。[但我认为您可以使用Template Haskell](http://www.haskell.org/haskellwiki/Template_Haskell)解决您的问题。

# c++ - valgrind：块肯定会丢失在损失记录中......在新线程中

> ID：12665781
> 
> 赞同：2
> 
> 时间：2012-09-30T22:43:54.600
> 
> 标签：c++, boost-thread

我运行此代码并从 Valgrind 收到此消息，我是 c++ 和 Linux 的新手，但我知道我必须修复它。请你能告诉我有什么问题吗？我正在使用 Ubuntu。

消息是这样的：

```
==29304== Thread 1:
==29304== 72 bytes in 18 blocks are definitely lost in loss record 55 of 89
==29304==    at 0x402641D: operator new(unsigned int) (vg_replace_malloc.c:255)
==29304==    by 0x4032BBC: GmpPipePlayer::GmpPipePlayer(IOBase*, Referee*, unsigned char, int, DataBoard const*, int, char const*, int) (unixgmppipe.cpp:126)
==29304==    by 0x40329F9: GmpPipePlayer::CreateFunc(IOBase*, Referee*, unsigned char, int, DataBoard const*, void*) (unixgmppipe.cpp:55) 
```

代码是：int down[2], up[2];

```
pipe(down);   
pipe(up);

_pid = fork();

if (_pid < 0)
    exit(1);

if (_pid == 0)
{
    close(down[1]);
    close(up[0]);

    dup2(down[0], 0);
    dup2(up[1], 1);

    execl("/bin/sh", "sh", "-c", cmd_line, NULL);

    _exit(1);
}

close(down[0]);
close(up[1]);
_down = down[1];
_up = up[0];

_reader_thd = new Thread(reader_wrapper, this); //here is the error happening. 
```

函数 readre_wrapper 是：

```
THREAD_Return GmpPipePlayer::reader_wrapper(void *p)

{
    GmpPipePlayer *t = (GmpPipePlayer *)p;

    t->reader_fn();

    return NULL;
} 
```

这个新线程被多次调用。在我再次调用它之前，我会执行以下操作：

```
if (_pid > 0)
{
    kill(_pid, SIGTERM);
    _pid = 0;
}

if (_up)
{
    close(_up);
    _up = 0;
}

if (_down)
{
    close(_down);
    _down = 0;
} 
```

有什么想法有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T22:55:17.083

好吧，你有一个`new`从来没有匹配过的 a `delete`。您`delete _reader_thd;`在代码中的某个时刻需要 a 。或者根本不使用动态对象。

# html - 哪种标签形式是正确的？

> ID：12665782
> 
> 赞同：0
> 
> 时间：2012-09-30T22:43:57.253
> 
> 标签：html, tags

`<input type="text"/>`或者`<input type="text">`

* * *

`<link rel="stylesheet" href="ss.css" type="text/css"/>`或者`<link rel="stylesheet" href="ss.css" type="text/css">`

* * *

`<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>`或者`<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">`

我的意思是`>`vs`/>`

我的标题 HTML 类型是：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

什么适合我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T01:49:53.583

*阿拉*，您使用的是**HTML 4.01 Strict**。~~在此 DOCTYPE 中不允许~~使用斜线关闭所谓的“空元素”（如`input`, `meta`, `link`, `img`, `br`, ...），不鼓励用于此 DOCTYPE （但严格来说允许，↓ 请参阅此答案的评论）。

 ~~所以你~~必须~~应该使用`<input type="text">`.

其他 DOCTYPES 的规则不同：在 XHTML 中，您必须对空元素使用右斜线。在 HTML5 中，您可以自由选择您更喜欢的内容。

验证您的 HTML 文档：http: ~~//validator.w3.org/~~ [-](http://validator.w3.org/)如果您使用. 请注意，由于副作用，使用(in ) 会另外产生错误（↓ 见评论）。~~`<input type="text" />``<meta />``head`~~

 ~~* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:46:00.130

`/>`对 XHTML`>`对 HTML 是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:46:02.337

前者是XHTML 风格，后者是HTML/SGML 风格。大多数浏览器都可以接受。

最新的 HTML 规范 HTML5 不是基于 XHTML 的，因此省略自闭合斜线是惯用的。

编辑：您提供的文档类型适用于 HTML4 Strict。省略自动关闭的斜线可能是最“正确的”，但任何一个都可以工作，哪个是首选是口味问题。~~~~

# c++ - 静态对象的名称管理

> ID：12665784
> 
> 赞同：2
> 
> 时间：2012-09-30T22:44:12.407
> 
> 标签：c++, static-members, dynamic-linking, name-mangling

我遇到了[这篇关于](https://github.com/bartgrantham/dynamic-libraries-in-c-and-cpp-article/blob/master/README.md)C++ 中动态链接的文章。

我们可以创建一个 C++ 工厂，它会返回我们感兴趣的类的对象。此外，我们应该在工厂的文件范围内创建一个静态对象，以便可以使用`dlsym()`. （文章建议静态对象没有名称混乱。）

为什么静态对象没有名称混乱？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T22:46:57.200

名称修饰是为了帮助解析重载的函数名称而发明的。您可以定义多个具有相同名称的函数，不同之处仅在于其参数的数量和类型。名称修饰使链接器可以将此类函数解析到代码中的正确位置。

与函数名称不同，全局命名空间中的静态对象名称不能被重载，因此不需要修改它们。事实上，在全局命名空间之外的对象名称是错位的。

# javascript - 用于小型设备的 Jquery 到 javascript，需要轻量级代码

> ID：12665789
> 
> 赞同：0
> 
> 时间：2012-09-30T22:45:16.547
> 
> 标签：javascript, jquery

好的，所以我是 javascript 的新手，但我可以很好地处理 jquery...但是 jquery 在小型移动网络体验上真的很重...有时它甚至太笨拙了。

所以我有这段代码可以简单地弹出我的菜单栏，我想知道是否有任何简单的方法可以得到这个？

```
$(function() {
    $('div.menu').hide();
    $("img#menu").click(function () {
          $("div#menu").toggle("slide", {direction: "right"}, 500);
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T00:05:28.457

查看您的代码，我会指出以下内容（请参阅评论）：

```
$(function() {
    // here you are searching by class name, that is going to eat CPU
    $('div.menu').hide();
    $("img#menu").click(function () {
        // here you are doing a JavaScript animation, eating more of the CPU
        $("div#menu").toggle("slide", {direction: "right"}, 500);
    });
}); 
```

使用 CSS 而不是 JavaScript 依赖于原生代码而不是解释的 JavaScript。

还有一个技巧是许多移动设备都针对 3D CSS 过渡进行了优化（因为 3D 用于执行手机自己的 UI 使用的翻转和滑动功能）。因此，使用 3D 过渡将使您从引擎中获得更多的空间。

使用 CSS 的代码的 jsFiddle 在这里：

*   [http://jsfiddle.net/8dQMu/](http://jsfiddle.net/8dQMu/)

CSS 过渡的一个很好的介绍在这里：

*   [http://css3.bradshawenterprises.com/transitions/#how2use](http://css3.bradshawenterprises.com/transitions/#how2use)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T23:02:33.360

您可以使用纯 CSS 模拟菜单，无需任何 JavaScript，只需编写一个 css 选择器，将鼠标悬停在您想通过它显示菜单的项目上，但这样您就不能有像幻灯片这样的效果。要创建这种效果，您应该阅读他们在 jQuery 中的代码并在 JS 中实现它们。其他的事情也可以使用 jquery 的源代码来处理，但是对于选择器（比如 'div.menu'），你可以使用来自[Sizzlejs.com](http://Sizzlejs.com)的 Sizzle这个库非常小（4k gzipped 和缩小），它的选择器引擎可以做任何 jQuery 可以做的事情（实际上 jQuery 内部使用 Sizzle ）

# join - Solr 4.0 是否能够对多核使用“加入”？

> ID：12665797
> 
> 赞同：23
> 
> 时间：2012-09-30T22:46:31.260
> 
> 标签：join, solr, lucene

我注意到 Solr 4.0 为具有关系的文档引入了“加入”功能。[这很好，但是，我注意到http://wiki.apache.org/solr/Join](http://wiki.apache.org/solr/Join)给出的示例是针对单核的，所有文档都在单索引中。

有人知道我是否可以对多核使用“加入”吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-01T10:18:58.143

# android - Android-更改应用程序的权限

> ID：12665798
> 
> 赞同：0
> 
> 时间：2012-09-30T22:46:32.430
> 
> 标签：android

我知道这不是一个技术问题，但我搜索了很多时间并找不到合适的答案：

我想更改我的应用程序的权限。您可以在此处找到该应用程序：https: [//play.google.com/store/apps/details?id=io.trigger.forge2dd999d0f14b11e1bc8612313d1adcbe&feature=search_result#?t=W251bGwsMSwyLDEsImlvLnRyaWdnZXIuZm9yZ2UyZGQ5OTlkNiMGYxNGIxMWUxYmGZZZE](https://play.google.com/store/apps/details?id=io.trigger.forge2dd999d0f14b11e1bc8612313d1adcbe&feature=search_result#?t=W251bGwsMSwyLDEsImlvLnRyaWdnZXIuZm9yZ2UyZGQ5OTlkMGYxNGIxMWUxYmM4NjEyMzEzZDFhZGNiZSJd)

如果您查看“权限”，它会说：

您的个人信息
读取联系人数据
允许该应用读取存储在平​​板电脑上的所有联系人（地址）数据。恶意应用程序可能会使用此功能将您的数据发送给其他人。允许该应用读取您手机上存储的所有联系人（地址）数据。恶意应用程序可能会使用此功能将您的数据发送给其他人。

我想删除它，这样应用程序就不会读取用户的联系数据。有人可以告诉我该怎么做吗？

谢谢，

安内

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T22:49:31.617

如果应用程序实际上没有访问联系人 API，那么您可以安全地`<uses-permission/>`从`AndroidManifest.xml`文件中删除相应的 API 并重建您的 APK。

[http://developer.android.com/guide/topics/manifest/uses-permission-element.html](http://developer.android.com/guide/topics/manifest/uses-permission-element.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T01:24:06.190

只是为了添加到 Jeremy 的关于 的答案，看起来您正在使用的权限是：`android.permission.READ_PROFILE`和`android.permission.READ_CONTACTS`

你需要删除那些。有关更多详细信息，请查看：http: [//developer.android.com/reference/android/Manifest.permission.html](http://developer.android.com/reference/android/Manifest.permission.html)

# wordpress - wordpress - 如何让用户在地图上添加位置？

> ID：12665799
> 
> 赞同：4
> 
> 时间：2012-09-30T22:46:47.787
> 
> 标签：wordpress, google-maps

我正在使用 Wordpress 构建我的网站，我想添加一个表单，其中包含：名称、描述、图像和**地图上的位置**。那就是让用户在地图上添加自己的标记。

并且通过按“提交”，整个数据（名称、描述、图像、经度、纬度）将被保存到数据库中。

我怎样才能做到这一点？我应该使用哪些插件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T08:55:10.287

您可以使用[Google 地标](http://wordpress.org/extend/plugins/basic-google-maps-placemarks/)并让他们访问插件使用的“地标”自定义帖子类型的创建。你可能不得不破解特色图片..

或者，您正在查看完整的自定义帖子类型创建和谷歌地图 API 集成，这是一个利用特色图像的自定义循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T09:33:16.340

最接近您需要的插件是 SMacFadyen 建议的 - [BGMP](http://wordpress.org/extend/plugins/basic-google-maps-placemarks/)。但是，如果您想自己这样做，则需要研究一下：

*   [谷歌地图 JavaScript API](https://developers.google.com/maps/documentation/javascript/)
*   [WordPress 自定义帖子类型](http://codex.wordpress.org/Post_Types)
*   WordPress 元框

对于第一个，有很多关于如何显示地图和 InfoWindows 的教程，所以你不应该有太大的问题。对于自定义帖子类型，有一个很棒的[生成器](http://themergency.com/generators/wordpress-custom-post-types/)可以完成 99% 的工作。对于 Meta Box，您可以采用多种方式：

*   [插件](http://wordpress.org/extend/plugins/meta-box/)- 最简单，但你会依赖一个我不太喜欢的插件
*   从头开始 -[教程](http://wp.smashingmagazine.com/2011/10/04/create-custom-post-meta-boxes-wordpress/)- 这比插件好得多，但需要大量工作
*   元框库之一 - 这是我通常采用的方式 - 我正在开发自己的，但它还没有准备好，所以同时我会推荐[My-Meta-Box](https://github.com/bainternet/My-Meta-Box)或[可重复使用的自定义 WordPress 元框](https://github.com/tammyhart/Reusable-Custom-WordPress-Meta-Boxes)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-10T16:45:35.120

有几次，在搜索如何使这项工作时，我偶然发现了这个线程。每次，我都对现有插件处理这个问题的方式并不满意。所以，我现在自己把这个放在一起。

这是我的解决方案的概述。

1.  使用插件[自定义帖子类型 UI](https://wordpress.org/plugins/custom-post-type-ui/)为地图上的标记创建自定义帖子类型。
2.  使用插件[高级自定义字段](https://wordpress.org/plugins/advanced-custom-fields/)向此自定义帖子类型添加一个表示位置的字段。字段类型是“谷歌地图”类型。
3.  将标准[Google Maps API 集群示例](https://developers.google.com/maps/documentation/javascript/marker-clustering)复制到您主题中的相应主题文件中。
4.  为了显示您的标记，通过在您的主题文件中请求您新创建的自定义帖子类型的帖子来生成位置列表。
5.  对于每个标记/位置，选择“谷歌地图”字段并抽象出纬度和经度。
6.  对于每个标记/位置，为包含所有位置的数组构造适当的数组元素，至少包含纬度和经度，还可能包含信息窗口的内容。

这应该为您提供一张地图，其中标出了所有位置。

允许用户添加位置：

1.  向您的地图添加一个侦听器，用于侦听点击并返回点击的位置。也许这个监听器只有在用户表达了他想要在地图上添加一个位置的意图之后才会运行。
2.  当用户单击时，打开一个表单，例如在模式中。该表单应包含带有纬度和经度的隐藏字段，例如，还可以包含相关位置的静态图像。其他表单字段将是您需要的字段。
3.  使用 AJAX 提交表单。例如，请参阅[本教程](https://www.smashingmagazine.com/2011/10/how-to-use-ajax-in-wordpress/)。在您主题的 functions.php 中，您可以验证提交并将新提交添加到您的 Wordpress 数据库，匹配您的新自定义帖子类型。

根据您存储新位置的方式，在您下次重新加载地图时，新位置将被包括在内。（或者您可能需要首先授权新位置。）您还可以通过 AJAX 重新加载所有位置。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-07-01T08:45:37.503

[Profile Builder](https://www.cozmoslabs.com/wordpress-profile-builder/)允许您这样做。创建一个前端注册表单，包括所需的自定义字段和地图字段，供用户固定或输入他们的位置。

然后使用内置的用户列表（成员目录）模块，您可以显示[所有用户](https://www.cozmoslabs.com/160142-add-users-map-wordpress/)位置的地图。

# bind - tmux 绑定分号

> ID：12665802
> 
> 赞同：6
> 
> 时间：2012-09-30T22:47:22.280
> 
> 标签：bind, tmux

有什么方法可以绑定；(\059) 到 tmux 中的命令？

默认情况下，它绑定到最后一个窗格；但是，我想将其重新绑定到 select-pane -R。

我曾尝试将以下内容放入我的 .tmux.conf 中，但似乎没有任何效果：

1.  “bind \059 select-pane -R” -> tmux 报告“unkown key \059”，但忽略警告后，“;” 有时确实按预期工作。

2.  “绑定；选择窗格 -R”-> tmux 报告“用法：绑定键 ...”

3.  “绑定';' 选择窗格-R”-> tmux 报告“用法：绑定键...”

我现在使用第一个选项，但我想正确执行，所以每次启动 tmux 时都不会出现警告。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T07:19:39.687

分号在 tmux 中也用作命令分隔符，所以为了绑定它，你需要对其进行转义：

```
bind-key \; select-pane -R 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T07:20:25.807

*tmux*引用有点古怪；它看起来很像 Bourne shell 风格的引用，但有细微的差别。

唯一可以逃避尾随（或单独）分号的是反斜杠：

```
bind \; select-pane -R 
```

手册页的相关部分：

> 可以通过使用反斜杠对其进行转义来包含文字分号（例如，在将命令序列指定为 bind-key 时）。

尾随的未转义分号充当*tmux*命令之间的分隔符。

*tmux*向您展示了`bind-key`用法（对于您的示例编号为 2 和 3），因为当分号未转义时（即使它被引用，与 shell 不同），该行被解析为两个命令：`bind`和`select-pane -R`. 这些命令中的第一个是不完整的（`bind-key`至少需要两个参数：一个键和一个命令）。

您的`\059`尝试（您的示例编号为 1）同样未能调整绑定，因为指定键时不支持八进制语法。`Prefix` `;`is的默认绑定`last-pane`，它可能最终将窗格向右移动（即做什么`select-pane -R`），但前提是右侧的下一个窗格恰好是先前活动的窗格。

# c# - 以单独的形式使用数据库连接

> ID：12665803
> 
> 赞同：1
> 
> 时间：2012-09-30T22:47:39.997
> 
> 标签：c#, database, connection

我有一个主窗体，它有一个连接到数据库的数据网格视图。然后我有一个按钮可以打开一个单独的表单，我在那个辅助表单上有几个按钮等。

我需要从辅助表单中查询数据库，但我不确定如何在不创建全新连接的情况下做到这一点，我认为我不需要，因为程序已经连接到数据库。我只是不确定如何引用我在第一种形式中建立的 oleDB 连接（我没有编码，我使用 datagridview 上的小箭头使用 Visual Studio 将其连接到数据库）

现在，我如何引用以主要形式建立的第一个连接，而不是创建那个新连接？

这是我的代码：

```
//parameterized update query
string updateCommandString = "UPDATE RoomsTable SET [Date Checked]=@checkedDate WHERE ID = @id";
using (OleDbConnection conn = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=c:\users\spreston\documents\visual studio 2012\Projects\roomChecksProgram\roomChecksProgram\roomsBase.accdb"))
{

    using (OleDbCommand updateCommand = new OleDbCommand())
    {
        OleDbTransaction transaction = null;
        updateCommand.Connection = conn;
        updateCommand.Transaction = transaction;    
        updateCommand.CommandText = updateCommandString;
        updateCommand.CommandType = CommandType.Text;
        updateCommand.Parameters.AddWithValue("@checkedDate", this.dateTimePicker1.Value.ToShortDateString());
        updateCommand.Parameters.AddWithValue("@id", row.roomID);
        try
        {
            conn.Open();
            transaction = conn.BeginTransaction();
            updateCommand.Transaction = transaction;
            updateCommand.ExecuteNonQuery();
            transaction.Commit();
            conn.Close();
            conn.Dispose();
        }
        catch(OleDbException ex)
        {
            MessageBox.Show(ex.Message.ToString());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:31:07.650

从设计的角度来看，您应该考虑为您的表单制作一个数据访问层以供使用。您可以创建方法来为您检索这些 Db 结果，以便合并该代码并将其与表单功能分开。它可能只是一个小项目，但它是一个很好的实践，如果它是一个你想要发展的项目，你会希望它的布局是可扩展的。

就像是

```
class SomethingDA {
   static DataTable GetMyStuff(your params) {
     // establish connection, get your results
   }
} 
```

然后，您可以打电话`SomethingDa.GetMyStuff()`来获取您需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:13:19.463

如果您使用 " `Using`" 语句，则在运行此代码后您的连接将关闭。您实际上不需要`conn.Close()`and`conn.Dispose()`语句。使用为您做到这一点。

最好的办法是再次打开连接。尽快打开和关闭连接通常是一个好习惯，尽管如果您的 Access DB 是本地的，则可能不太重要。这通常不会对性能产生太大影响，因为后台的 OLE DB 驱动程序会将连接池化并使其保持打开一段时间。

# jquery - 防止jquery灯箱中的点击功能

> ID：12665808
> 
> 赞同：1
> 
> 时间：2012-09-30T22:48:27.127
> 
> 标签：jquery, click, prettyphoto

我正在使用[PrettyPhoto](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/documentation/)灯箱，并且我试图阻止灯箱打开，除非图像具有“活动”类。它在[Contentflow](http://www.jacksasylum.eu/ContentFlow/index.php)脚本中使用，该脚本将活动类添加到居中的聚焦图像中。图像有一类“项目​​”。我正在使用 data-href ，因为由于 contentflow 中的一些限制，我需要将图像放在 a 而不是标签中。我尝试了以下代码：

HTML

```
 <div class="item"  title="Image" data-href="image.jpg" data-rel="prettyPhoto">
   <img  alt="image" src="thumb.jpg" /></div> 
```

脚本

```
$('#gallery').on('click', '.item:not(.active)', function (e) {
e.preventDefault();
e.stopPropagation();
});

 $('.item[data-href]').each(function() { 
 $(this).attr('href', $(this).attr('data-href'));
  });

 $(".item").prettyPhoto(); 
```

无论如何，每张图片都会在灯箱中打开。我也试过这个：

```
$('.item:not(.active)').off('click'); 
```

由于我仍在学习 jQuery，如果有人能指出我正确的方向，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T21:16:22.637

而不是使用`$(".item").prettyPhoto();`你为什么不只是简单地说`$(".active").prettyPhoto();`？

# python - numpy.shape 给出不一致的响应 - 为什么？

> ID：12665810
> 
> 赞同：18
> 
> 时间：2012-09-30T22:48:43.683
> 
> 标签：python, numpy

为什么程序

```
import numpy as np

c = np.array([1,2])
print(c.shape)
d = np.array([[1],[2]]).transpose()
print(d.shape) 
```

给

```
(2,)
(1,2) 
```

作为它的输出？难道不应该

```
(1,2)
(1,2) 
```

反而？我在 python 2.7.3 和 python 3.2.3 中都得到了这个

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-01T07:48:57.767

当您调用`.shape`a 的属性时`ndarray`，您会得到一个包含与数组维度一样多的元素的元组。长度，即行数，是第一个维度（`shape[0]`）

*   你从一个数组开始 : `c=np.array([1,2])`。这是一个普通的一维数组，所以它的形状将是一个 1 元素元组，并且`shape[0]`是元素的数量，所以`c.shape = (2,)`
*   考虑`c=np.array([[1,2]])`。这是一个二维数组，有 1 行。第一行也是唯一的一行是`[1,2]`，它给了我们两列。因此，`c.shape=(1,2)`和`len(c)=1`
*   考虑`c=np.array([[1,],[2,]])`。另一个二维数组，有 2 行 1 列：`c.shape=(2,1)`和`len(c)=2`.
*   考虑`d=np.array([[1,],[2,]]).transpose()`：这个数组与 相同`np.array([[1,2]])`，因此它的形状是`(1,2)`。

另一个有用的属性是`.size`：这是所有维度中元素的数量，你有一个数组`c` `c.size = np.product(c.shape)`。

[有关文档](http://www.scipy.org/Tentative_NumPy_Tutorial#head-62ef2d3c0a5b4b7d6fdc48e4a60fe48b1ffe5006)中形状的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T22:56:00.283

`len(c.shape)`是数组的“深度”。

对于`c`，数组只是一个列表（向量），深度为 1。
对于`d`，数组是列表的列表，深度为 2。

笔记：

```
c.transpose()
# array([1, 2]) 
```

不是`d`，所以这种行为并不矛盾。

```
dt = d.transpose()
# array([[1],
#        [2]])
dt.shape # (2,1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-03T01:59:18.803

快速修复：检查 .ndim 属性 - 如果它是 2，那么 .shape 属性将按预期工作。

原因：如果 .ndim 属性为 2，则 numpy 报告符合约定的形状值。如果 .ndim 属性为 1，那么 numpy 只会以不同的方式报告形状。

更多讨论：当您传递 np.array 列表列表时， .shape 属性将与矩阵维度的标准概念一致：（行，列）。

如果你传递 np.array 只是一个列表，那么 numpy 认为它手上没有矩阵，并以不同的方式报告形状。

问题是：numpy 是否认为它有一个矩阵，或者它是否认为它手上有其他东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T19:23:26.420

`transpose`不会改变数组的维数。如果`c.ndim == 1`，`c.transpose() == c`。尝试：

```
c = np.array([1,2])
print c.shape
print c.T.shape
c = np.atleast_2d(c)
print c.shape
print c.T.shape 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-15T12:15:11.287

来自Matlab，我也发现很难将一维数组组织为（row_count，colum_count）

我的函数必须对像 [x1, x2, x3] 这样的一维 ndarray 或数组列表 [[x1, x2, x3], [x1, x2, x3], [x1, x2, x3]] 做出一致的响应.

这对我有用：

```
dim = np.shape(subtract_matrix)[-1] 
```

选择最后一个维度。

# xcode - 左右拖动精灵？

> ID：12665811
> 
> 赞同：1
> 
> 时间：2012-09-30T22:48:50.423
> 
> 标签：xcode, cocos2d-iphone, sprite

我想知道如何做到这一点。我怎样才能做到这一点，当用户点击并按住我的精灵时，他们只能将它拖过 x 轴，保持相同的 y 值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:31:08.780

按照本教程

[http://www.raywenderlich.com/2343/how-to-drag-and-drop-sprites-with-cocos2d](http://www.raywenderlich.com/2343/how-to-drag-and-drop-sprites-with-cocos2d)

当它设置精灵的位置而不是将 y 位置设置为触摸的位置时，只需将其设置为您想要的固定值即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-02T21:46:26.677

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *Drag = [[event allTouches] anyObject];
    CGPoint CurrentPosition = [Drag locationInView:self.view];
    CurrentPosition.x = Sprite.center.x;
    Sprite.center = CurrentPosition;
} 
```

我创建了一个这样的滑块：[https ://github.com/Antem/Custom-Slider-xCode](https://github.com/Antem/Custom-Slider-xCode)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T10:29:08.457

无论你在哪里处理你的触摸：

```
if (CGRectContainsPoint(sprite.rect, touchLocation)){
     sprite.position = ccp(touchLocation.x,sprite.position.y);
} 
```

# audio - 音频音量标准化时的动态范围压缩

> ID：12665817
> 
> 赞同：3
> 
> 时间：2012-09-30T22:49:40.463
> 
> 标签：audio, pcm

我已经询问过[音量标准化](https://stackoverflow.com/questions/12481524/audio-volume-normalization)。在大多数方法（例如，我最感兴趣的[ReplayGain](http://www.replaygain.org/)）上，我可能会得到超过 PCM 限制的峰值（也可以[在此处](http://en.wikipedia.org/wiki/Audio_normalization#Loudness_normalization)阅读）。

简单的剪辑可能是我能做的最糟糕的事情。[正如 Wikipedia 建议](http://en.wikipedia.org/wiki/Audio_normalization#Loudness_normalization)的那样，我应该进行某种形式的[动态范围压缩](http://en.wikipedia.org/wiki/Dynamic_range_compression)。

我说的是我在每个单独的 PCM 样本值上应用的函数。在另一个[类似的问题](https://stackoverflow.com/questions/2908104/help-with-dynamic-range-compression-function-audio)上，[一个答案](https://stackoverflow.com/a/2914119/133374)表明这样做是不够的，或者不是我应该做的事情。但是，我真的不明白这一点，因为我仍然必须处理剪裁案例。答案是否建议一次对多个样本进行范围压缩，并对每个样本进行简单的硬剪辑？

撇开这一点不谈，维基百科文章中讨论的功能似乎不是我想要的（在许多情况下，我最终仍然会使用剪辑案例）。我正在考虑使用类似[tanh](http://www.wolframalpha.com/input/?i=tanh%28x%29)的东西。这是个坏主意吗？它会稍微降低音量，但保证我不会得到任何剪辑。

我的应用程序是一个通用的音乐播放器。我正在寻找一种最适合所有人的解决方案，这样我就可以随时打开它，而用户很可能不想关闭它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T23:14:29.670

使用任何瞬时动态范围处理（例如削波或 tanh 非线性）都会引入可听失真。将正弦波放入瞬时非线性函数中，您将不再有正弦波。虽然对某些音频应用程序很有用，但听起来您不想要这些人工制品。

归一化不影响波形的动态（以最小/最大比率表示）。归一化涉及将波形按元素乘以恒定的标量值，以确保没有样本超过最大值。这个过程只能离线完成，因为您需要在处理之前分析整个信号。如果您的波形包含任何强烈的瞬变，归一化也是一个坏主意。您的整个信号将按瞬态峰值除以削波阈值的比率衰减。

如果您只想保护输出不被削波，最好使用侧链式压缩器。一种特定的形式是限制器（在零启动时间的阈值之上无限压缩比）。侧链压缩器计算信号的平滑能量包络，然后根据该函数应用不同的增益。它们不是瞬时的，因此您可以减少从您提到的功能中获得的声音失真。限制器可以具有瞬时启动以防止削波，但您允许释放时间，以便限制器保持对后续波形峰值的衰减，随后的波形只是被调低，因此没有失真。在强烈的声音之后，限制器恢复。

如果波形中有很多高强度峰值，您可以从这种类型的处理中获得泵浦类型的声音。如果这变得有问题，您可以进入下一个级别并在子频段内进行动态处理。这样，只有频谱中的干扰部分会被衰减，其余的声音不受影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T01:52:13.560

一般的解决方案是将增益水平归一化到明显低于 1 的水平，这样很少有歌曲需要增加增益。换句话说，大多数时候你会降低而不是增加信号的音量。尝试各种不同风格的歌曲，以确定这个级别是什么。

现在，偶尔，您仍然会遇到一首需要足够增益的歌曲，以至于在某些时候它会剪辑。你有两个选择： 1\. 不要增加那么多收益。这首歌听起来会安静一些。这就是生活。（这是一种常用方法），或 2\. 应用少量动态范围压缩和/或限制。当然，你也可以做一些1和2的组合。我相信iTunes使用了1和2的组合，但是他们在#2上非常努力，他们应用的很少。

您的建议，在逐个样本的基础上使用像 tanh 这样的函数，会导致声音失真。您不想为通用音乐播放器执行此操作。这是吉他放大器模拟器中所做的那种事情，使它们听起来“肮脏”和“邋遢”。在摇滚、流行或其他已经严重失真的现代音乐中可能听不到它，但在仔细录制的合唱、爵士或小提琴独奏音乐中，人们会感到不安。这与tanh的选择无关，顺便说一下，任何非线性函数都会产生失真。

动态范围压缩使用随时间应用于信号的包络：[http](http://en.wikipedia.org/wiki/Dynamic_range_compression) ://en.wikipedia.org/wiki/Dynamic_range_compression 这很难正确处理，而且您永远无法创建真正“透明”的压缩器。限幅器可以被认为是压缩器的极端版本​​（至少在理论上）可以防止信号超过某个电平。数字“前瞻”限制器可以做到这一点，而不会出现明显的削波。当明智地使用时，它是非常透明的。

如果采用这种方式，请确保可以关闭此功能，因为无论您认为它多么透明，都会有人听到而不喜欢它。

# cocoa-touch - 使用自定义视图控制器包含时无法创建展开转场

> ID：12665818
> 
> 赞同：12
> 
> 时间：2012-09-30T22:49:47.863
> 
> 标签：cocoa-touch, uistoryboard, uistoryboardsegue

我正在尝试将我们的应用程序转换为情节提要，并且在处理自定义容器控制器时遇到了我认为处理展开 segues 的错误。我们有一个视图控制器，它显示另一个并使用视图控制器包含 api 来执行此操作，我在 IB 中连接 segue，然后为实现选择一个自定义类。perform 方法如下所示：

```
-(void) perform {
    UIViewController *container = [self sourceViewController];
    UIViewController *child = [self destinationViewController];
    [container addChildViewController:child];
    [container.view addSubview:child.view];
    child.view.center = container.view.center;
    [UIView transitionWithView:container.view
                      duration:0.35
                       options:UIViewAnimationOptionCurveEaseInOut
                    animations:^{
                        child.view.alpha = 1;
                    } completion:^(BOOL finished) {
                        [child didMoveToParentViewController:container];
                    }];
} 
```

这完美地工作，但是我不能让它执行 unwind segue 回到容器控制器。我覆盖 viewControllerForUnwindSegueAction: fromViewController: withSender: 并确保它返回正确的值：

```
-(UIViewController *) viewControllerForUnwindSegueAction:(SEL)action fromViewController:(UIViewController *)fromViewController withSender:(id)sender {
    id default = [super viewControllerForUnwindSegueAction:action fromViewController:fromViewController withSender:sender];
    NSAssert1(default == self, @"Expected the default view controller to be self but was %@", default);
    return default;
} 
```

我还可以确认 canPerformUnwindSegueAction:fromViewController:withSender 被调用并做正确的事情，但要确保我覆盖它以返回 YES

```
-(BOOL) canPerformUnwindSegueAction:(SEL)action fromViewController:(UIViewController *)fromViewController withSender:(id)sender {
    return YES;
} 
```

我希望发生的下一步是调用 segueForUnwindingToViewController:fromViewController:identifier:，但它永远不会。相反，应用程序因 NSInternalInconsistencyException 而崩溃。

```
2012-10-01 10:56:33.627 UnwindSegues[12770:c07] *** Assertion failure in -[UIStoryboardUnwindSegueTemplate _perform:], /SourceCache/UIKit_Sim/UIKit-2372/UIStoryboardUnwindSegueTemplate.m:78
2012-10-01 10:56:33.628 UnwindSegues[12770:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Could not find a view controller to execute unwinding for <USCustomContainerViewController: 0x75949a0>'
*** First throw call stack:
(0x1c8e012 0x10cbe7e 0x1c8de78 0xb61f35 0x581711 0x45ab54 0x10df705 0x16920 0x168b8 0xd7671 0xd7bcf 0xd6d38 0x4633f 0x46552 0x243aa 0x15cf8 0x1be9df9 0x1be9ad0 0x1c03bf5 0x1c03962 0x1c34bb6 0x1c33f44 0x1c33e1b 0x1be87e3 0x1be8668 0x1365c 0x1e7d 0x1da5)
libc++abi.dylib: terminate called throwing an exception 
```

有没有人成功地使用了结合视图控制器包含 API 的 unwind segues？知道我错过了哪一步吗？我已经将一个[演示项目上传到 github](https://github.com/NZKoz/UnwindSegues)，它在我能想到的最简单的演示项目中显示了这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T00:27:18.033

你的例子中的问题是那里没有。这*太*简单了。首先，您以一种相当奇怪的方式创建容器视图控制器（您不使用新的 IB“容器视图”来帮助您执行此操作）。其次，你没有什么可以放松的：没有任何东西被推或呈现在任何东西之上。

我有一个工作示例，表明它`canPerformUnwindSegueAction`确实在父链上进行了咨询，并且`viewControllerForUnwindSegueAction`如果`segueForUnwindingToViewController`出现在正确的位置，它就会被调用并且有效。看：

[https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch19p640presentedViewControllerStoryboard2](https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch19p640presentedViewControllerStoryboard2)

我现在还在 github 上创建了您原始示例的一个分支，并对其进行了更正，以便说明这些功能：

[https://github.com/mattneub/UnwindSegues](https://github.com/mattneub/UnwindSegues)

这并不是真正需要“展开”的*情况*，但它确实显示了在涉及自定义容器视图控制器时如何使用“展开”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T14:01:38.263

Brief history before the answer: I just ran into the same exact error message when trying to use multiple Container Views on one iPad screen in iOS 6 and calling unwind segues from code. At first I thought this may be a problem because my segue was created using Storyboards by CTRL-dragging from File Owner to Exit instead of from some UI control to Exit, but I got same results when I put test Close buttons on each VC and had them trigger the unwind segues. I realized that I'm trying to unwind an embed segue, not a modal/push/popup segue, so it makes sense that it fails to do it. After all, if the unwind segue succeeds and the view controller is unloaded from a Container View, iOS 6 thinks there'll just be an empty space on the screen in that spot. (In my case, I have another container view taking up screen real estate that's shown behind the container view which I'm trying to unload, but iOS doesn't know that since the two aren't connected in any way.)

Answer: this led me to realize that you can only unwind modal, push, or popover segues, be it within the main window or as part of a Navigation/Tab Controller. This is b/c iOS then knows that there was a previous VC responsible for the whole screen and it's safe to go back to it. So, in your case, I'd look into a way to tell iOS that your child container view is connected to your parent container view in a way that makes it safe to dismiss the child container view. For example, perform a modal/push/popover segue when displaying the child container view, or wrap both into a custom UINavigationController class (I assume you don't want the navigation bar, that's why custom class).

Sorry I can't give exact code, but this is the best I got to so far and I hope it's helpful.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T09:52:30.993

这似乎是一个错误——我也希望展开 segues 在你实现时工作。

我使用的解决方法是在 IBAction 方法中显式关闭呈现的视图控制器：

```
- (UIStoryboardSegue *)segueForUnwindingToViewController:(UIViewController *)toViewController
                                      fromViewController:(UIViewController *)fromViewController
                                              identifier:(NSString *)identifier
{
    return [[UIStoryboardSegue alloc] initWithIdentifier:identifier
                                                 source:fromViewController
                                             destination:toViewController];
}

- (IBAction)unwind:(UIStoryboardSegue*)segue
{
    UIViewController *vc = segue.sourceViewController;
    [vc willMoveToParentViewController:nil];
    if ([vc respondsToSelector:@selector(beginAppearanceTransition:animated:)]) {
        [vc beginAppearanceTransition:NO animated:YES]; // iOS 6
    }
    UIView *modal = vc.view;
    UIView *target = [[segue destinationViewController] view];
    [UIView animateWithDuration:duration animations:^{
        modal.frame = CGRectMake(0, target.bounds.size.height, modal.frame.size.width, modal.frame.size.height);
     } completion:^(BOOL finished) {
        [modal removeFromSuperview];
        [vc removeFromParentViewController];
        if ([vc respondsToSelector:@selector(endAppearanceTransition)]) {
            [vc endAppearanceTransition];
          }
    }];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-29T12:39:09.053

看起来这个错误在 iOS9 中已修复。

# node.js - 使用 node.js 检测 html 按钮单击？

> ID：12665823
> 
> 赞同：4
> 
> 时间：2012-09-30T22:50:13.387
> 
> 标签：node.js

我对 node.js 很陌生，所以如果这是一个潜在的愚蠢问题，我深表歉意。我知道当请求一个新页面时，它会触发一个数据事件，然后该节点可以相应地处理；不过，在我当前的项目中，我有一个触发一些事件的 html 按钮，但不会重定向页面。因此，节点没有意识到这种情况正在发生。我有什么办法可以检测到这一点吗？甚至，作为一种解决方法，有没有办法从网页中嵌入的 javascript 调用我的节点函数之一？

谢谢~

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T23:08:37.490

您正在混合两种不同的东西，您所说的节点中的数据事件被触发，因为当您将浏览器指向您的网站时建立了网络连接，数据被接收并从客户端发送到服务器并返回。

这与客户端 ui 事件无关，例如按钮上的单击事件。

如果您希望节点识别单击您的按钮，您必须向服务器发送一些内容，您可以使用表单、发出 ajax 请求或使用 websockets。

对于使用 jquery 的 ajax 请求：[jquery $.ajax 文档](http://api.jquery.com/jQuery.ajax/)

node.js 的一个流行的 websockets 实现是[socket.io](http://socket.io/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T23:07:10.213

如果您想从客户端调用 Node 中的某些内容，可以使用[socket.io](http://socket.io)将事件传输到 Node。然后捕获这些事件，并将正确的数据返回给客户端。参考[socket.io“如何使用”](http://socket.io/#how-to-use)。

# python - 使用 MongoKit 的地理空间索引

> ID：12665824
> 
> 赞同：0
> 
> 时间：2012-09-30T22:50:25.207
> 
> 标签：python, mongodb, pymongo, mongokit

有没有办法在[MongoKit](http://namlook.github.com/mongokit/) `Document`中的字段上创建地理空间索引？

现在我找不到任何使用`indexes`描述符的参考。

我想要类似的东西

```
class Foo(Document):
    structure = {
        'location': {
            'lat': float,
            'lon': float
        }
    }
    indexes = [
        {
            'fields': ['location'],
            'type': '2d'
        }
    ] 
```

我可以使用[Pymongo](http://api.mongodb.org/python/current/)做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:22:21.647

它被[记录在案](http://namlook.github.com/mongokit/indexes.html)。

要创建地理空间索引，您需要：

```
class Foo(Document):
    structure = {
        'location': {
            'lat': float,
            'lon': float
        }
    }
    indexes = [
        {
            'fields': [('location', '2d'), ],
        }
    ] 
```

我必须查看[来源](https://github.com/namlook/mongokit/blob/master/mongokit/document.py#L421)才能意识到这一点。

问候，

# javascript - JavaScript 碰撞函数

> ID：12665825
> 
> 赞同：2
> 
> 时间：2012-09-30T22:50:27.623
> 
> 标签：javascript, html, collision

我正在通过教程制作我的第一个 HTML5 游戏。教程突然结束了，但我决定我会用诸如结束屏幕和被敌人杀死的方式来完成游戏。然而，问题是无论我读什么，我似乎都无法弄清楚这个碰撞函数来检查两个矩形是否发生碰撞。此刻，[这里](http://jackscode.99k.org/)有当前的碰撞功能。[你可以在这里](http://pastebin.com/y0fEBxHm)找到具体的函数本身，以及整个程序（以防万一我知道你可能不会看）[在这里](http://pastebin.com/QVA5qa0f). 在发布之前，我一直在阅读，但我似乎无法使碰撞工作恰到好处。我是在做完全错误的事情还是我的逻辑不正确。如果有人可以提供帮助，我将不胜感激。谢谢！

好的，抱歉这个错误，我把其他功能逻辑放在我下面，但我很确定它是一样的。我之前只是遇到错误。

```
(!(x1 + w1 < x2) &&
           !(x2 + w2 < x1) &&
           !(y1 + h1 < y2) &&
           !(y2 + h2 < y1)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T19:24:40.633

也许这可以帮助:)

```
function collision(a,b)
{
    if(a.x < b.x + b.sprite.width && a.x + a.sprite.width > b.x && a.y < b.y + b.sprite.height && a.y + a.sprite.height > b.y)
    {
        return true;
    }
    else
    {
        return false;
    }
} 
```

# mysql - MySQL根据同一张表的数据更新每条记录

> ID：12665827
> 
> 赞同：2
> 
> 时间：2012-09-30T22:50:43.747
> 
> 标签：mysql, sql-update

我在 MySQL 数据库中有一张表（只是示例）

```
CREATE  TABLE test.Names (
    id INT NOT NULL ,  
    salary INT NULL ,  
    name VARCHAR(45) NULL , 
    tmpl INT,
    PRIMARY KEY (`id`) ,  
    UNIQUE INDEX `id_UNIQUE` (`id` ASC)
); 
```

我有这些记录

```
id,   salary, name, tmpl
1,    10,     John, null 
2,    20,     Pat,  null 
3,    30,     Jane, null 
```

我想通过这个简单的计算为每个人更新表格

```
salary of each person/Sum(salary)*100 
```

所以结果应该是

```
id,   salary, name, tmpl
1,    10,     John, 16.67 
2,    20,     Pat,  33.33 
3,    30,     Jane, 50 
```

如何通过一个 SQL 查询来执行此操作？或者什么是最好的方法（我假设真正的表将有 >100 000 行）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T22:57:37.110

使用单独的 SELECT 语句来获取总工资 - 将其放入变量中，或将其与现有表交叉连接。然后你就有了每条记录的可用总和。

这段 SQL 代码就足够了：

```
SET @sum_salaries = (SELECT SUM(salary) FROM test.Names);

UPDATE test.Names
SET tmpl = salary/@sum_salaries * 100; 
```

甚至不需要加入。这种方式更简单，可能更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T22:57:57.610

尝试这个：

```
SET @SallarySum = (SELECT SUM(salary) FROM TableName);

UPDATE Names t1
INNER JOIN
(
    SELECT id, (Salary / @SallarySum) * 100 tmpl
    FROM Names
) t2 ON t1.Id = t2.Id
SET t1.tmpl = t2.tmpl; 
```

## 这是一个[SQL Fiddle 演示](http://sqlfiddle.com/#!2/aa089/1)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T22:54:54.630

尝试这个：

```
update `test`.`Names`
 set tmpl = salary / (select sum(salary) from `test`.`Names`) * 100
where tmpl is null --for multiple times execution 
```

您可能必须将 tmpl 列更改为 double 数据类型。

# jquery - 菜单上的jquery活动选项卡

> ID：12665833
> 
> 赞同：1
> 
> 时间：2012-09-30T22:51:21.413
> 
> 标签：jquery, tabs

我一直在努力寻找解决方案几个小时，但无论我做什么似乎都不起作用（我对 javascript/jquery 的了解允许我这样做）。所以我有这个在搜索表单中切换选项卡的 jquery 脚本，代码如下：

```
<ul id="tabs">
    <li><a href="#" name="tab1">T1/a></li>
    <li><a href="#" name="tab2">T2</a></li>
</ul>

<div id="content"> 
    <div id="tab1">
    TAB 1 CONTENT
    </div>

    <div id="tab2">
    TAB 2 CONTENT
    </div>
</div> 
```

和 JQUERY 代码：

```
$(document).ready(function() {
    $("#content div").hide(); // Initially hide all content
    $("#tabs li:first").attr("id","current"); // Activate first tab
    $("#content div:first").fadeIn(); // Show first tab content

    $('#tabs a').click(function(e) {
        e.preventDefault();
        if ($(this).closest("li").attr("id") == "current"){ //detection for current tab
         return       
        }
        else{             
        $("#content div").hide(); //Hide all content
        $("#tabs li").attr("id",""); //Reset id's
        $(this).parent().attr("id","current"); // Activate this
        $('#' + $(this).attr('name')).fadeIn(); // Show content for current tab
        }
    });
}); 
```

我尝试在选项卡 div 名称旁边添加一个 class="current" ，但也没有任何效果。我在想也许有这个点击功能只在点击时接受当前选项卡的更改，但我想让它自动进行，所以当第二个选项卡处于活动状态时，它会根据我提供的“当前”类保持活动状态。我的情况是这样的：第一个选项卡从英语到意大利语搜索，第二个选项卡从意大利语到英语搜索，但是当我选择第二个选项（It to En）并且页面刷新以显示结果时，第一个选项卡被选中，因此，如果用户想要搜索 2 次或更多次（从意大利语到英语），他必须一遍又一遍地选择第二个选项卡。

如果我可以让 jquery 检测到“当前”类，我可以添加一些 php 来检查 url 参数并正确激活正确的选项卡。例如：如果 search.php?lang= `it_to_eng`，我将 'current'class 添加到第二个选项卡，反之亦然。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:14:09.797

[http://jsbin.com/ebomej/1/edit](http://jsbin.com/ebomej/1/edit)

```
$(document).ready(function() {
    $("#content div").hide().eq(0).show(); // show first one
    $("#tabs li").eq(0).addClass('current'); // set active one

    $('#tabs a').click(function(e) {
        e.preventDefault();
        if( $(this).closest("li").hasClass('current') ){ //detection for current tab
         return;      
        }else{             
            $("#content div").hide(); //Hide all content
            $("#tabs li").removeClass('current');
            $(this).parent().addClass('current'); // Activate this
            $('#' + $(this).attr('name')).fadeIn(); // Show content for current tab
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T02:49:55.690

看来您必须使用**jquery.cookie**来执行此操作。我已将您的代码修改如下：

```
$(document).ready(function() {

    var cookieName = 'tab_of';
    var cookieTab = 'tab';
    var cookieOptions = {expires: 7, path: '/'};

    $("#content div").hide(); //Hide all content        
    $("#" + $.cookie(cookieName)).addClass("current");
    $("#" + $.cookie(cookieTab)).fadeIn();
    if($.cookie(cookieName) == null){
        //alert($.cookie(cookieName));
        $("#tabs li:first a").attr("class","current"); // Activate first tab
        $("#content div:first").fadeIn(); // Show first tab content
    }

    $("#tabs a").click(function(e){
        e.preventDefault();
        $("#content div").hide(); //Hide all content
        $("#tabs li a").removeClass("current");
        $("#" + $.cookie(cookieName)).removeClass("current");
        $.cookie(cookieName, $(this).attr("id"), cookieOptions);
        $("#" + $.cookie(cookieName)).addClass("current");
        $.cookie(cookieTab, $(this).attr('name'), cookieOptions);
        $('#' + $.cookie(cookieTab)).fadeIn();
    });
}); 
```

每次重新加载页面时，选项卡位置将基于最后选择的位置。在这里查看演示：http: [//jsfiddle.net/ongisnade/597HR/](http://jsfiddle.net/ongisnade/597HR/)

**新更新：**

如果您希望会话 cookie 在用户退出浏览器时被销毁。更改此行：

```
var cookieOptions = {expires: 7, path: '/'}; 
```

到

```
var cookieOptions = {path: '/'}; 
```

**新的修复更新：**

`$("#tabs li a").removeClass("current");`我在上面添加了这段代码`$("#" + $.cookie(cookieName)).removeClass("current");`

请清除浏览器缓存并重新加载页面。点击这里查看演示：http: [//jsfiddle.net/ongisnade/597HR/1/](http://jsfiddle.net/ongisnade/597HR/1/)

# cocos2d-iphone - Levelhelper sprite + SneakyJoystick

> ID：12665834
> 
> 赞同：0
> 
> 时间：2012-09-30T22:51:31.373
> 
> 标签：cocos2d-iphone, box2d, box2d-iphone, joystick, d-pad

基本上我想移动我使用[LevelHelper](http://www.gamedevhelper.com/products/levelhelper/)创建的 LHSprite 的 box2d 主体。我尝试根据天气移动 LHSprite 的 box2d 主体，我的 SneakyJoystick 处于活动状态（该部分工作正常），代码如下：

```
if(dpad.leftJoystick.velocity.x > 0){
    b2Vec2 force;
    force.Set(dpad.leftJoystick.velocity.x * 10.0f, 0.0f);
    Player.body->ApplyForce(force, Player.body->GetPosition());
} 
```

谁能看到我怎样才能让它工作？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T17:42:29.200

LHSPrite has these methods: [sprite transformPosition:ccp(50,50)]; //will set the sprite position to 50,50 together with the physical body [sprite transformRotation:240];//will rotate the sprite to angle 240, together with the physical body

you have to update LHSPrite postitions bassed on box2d body in update method (see examples).

# java - 如何使用扫描仪从键盘读取一系列字符串，全部在一行上，并将它们连接起来

> ID：12665835
> 
> 赞同：2
> 
> 时间：2012-09-30T22:51:40.780
> 
> 标签：java, string, java.util.scanner, concat

如何使用 Scanner 从键盘读取一系列字符串，全部在一行上，并将它们连接起来。

这是我到目前为止的代码：

```
import java.util.Scanner;

public class Exam12Practice {

   public static void main(String[] args) 
   {
      Scanner input=new Scanner(System.in);
      String words="";
      System.out.println("enter a word");
      while(input.hasNext())
      {
         words = words.concat(input.next());
      }

      System.out.println(words);
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T18:00:03.077

您的代码已经完成了您的要求。让它工作

```
Type in your words
Press Enter
Press CTRL-Z (^D on *nix systems) 
```

**需要注意的几点：**

`input.hasNext()`将始终返回 true，`STDIN`因此仅按 Enter 将不起作用。

您可以使用`input.readLine()`和拆分单词进行练习。

大多数人可能更愿意使用`StringBuilder`它，因为它提供的性能优于`String.concat`.

# math - 在地球上画一条路径？

> ID：12665838
> 
> 赞同：2
> 
> 时间：2012-09-30T22:52:12.123
> 
> 标签：math, language-agnostic, geometry, great-circle

所以基本上我想：

*   在地球上的两个位置之间绘制一条路径，带有经度和纬度坐标
*   能够用多条直线渲染这条路径（例如使用 OpenGL）
*   指定一个高度，以及能够在球体上弧线的奖励积分（例如飞行路径）
*   它是哪种语言并不重要。我可以翻译:)

有“大圆”距离公式，但我不确定如何将它应用到这个问题中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T02:02:17.790

好吧，这是我的方法。如果有任何步骤不清楚，请告诉我，我会详细说明。

1.  我们要从**A**到**B**。
2.  我们对这些向量进行归一化，**a** = **A** /|A|, **b** = **B** /|B|。（如果我们留在地面上，|A| 和 |B| 的大小将是地球的半径。）
3.  我们取叉积**c** = **a** x **b**。我们将围绕这个向量**c**旋转，以将**A**带到**B**，**c的大小是****A**和**B**之间夹角的余弦：theta = acos(|c|)。很酷吧？
4.  我们不想一跳就完成，我们想要 n 个小步，所以我们将 theta 分开。我们从**A**开始，然后在每一步我们围绕**c**旋转角度 theta/n。
5.  这提供了一条沿地面的路径。为了得到一个弧线（可能在某个高度开始/结束），我们决定在每一步添加多少高度（在球坐标中很容易——在笛卡尔坐标中，我们必须缩放向量）。

# php - PHP/HTML - 在列表中显示上传的文件

> ID：12665840
> 
> 赞同：0
> 
> 时间：2012-09-30T22:53:05.240
> 
> 标签：php, html, file-upload, image-uploading, file-sharing

我正在尝试创建一个文件共享站点，我可以在其中显示所有上传图像的链接。一旦用户上传了一个文件，他们将能够看到已经上传的文件并上传另一个文件。但是，我目前有两个问题： 1\. 一旦用户上传图像，我不知道如何重新显示主上传页面。2.我不知道如何根据存在的文件动态创建链接。

这是我到目前为止的代码：

**HTML/PHP** 文件共享网站

```
<body>
<h2>File-Sharing Site</h2>
<h3>Upload file</h3>
<form action="upload_file.php" method="post" enctype="multipart/form-data">
Search for file: <br />
<input type="file" name="file" id="file" />
<input type="submit" name="submit" value="Upload" />
</form>
</body>
</html> 
```

**PHP**

```
<?php
    $allowedExts = array("jpg", "jpeg", "gif", "png");
    $extension = end(explode(".", $_FILES["file"]["name"]));
    if((($_FILES["file"]["type"] == "image/gif")
    || ($_FILES["file"]["type"] == "image/jpeg")
    || ($_FILES["file"]["type"] == "image/pjpeg"))
    && ($_FILES["file"]["size"] < 800000)
    && in_array($extension, $allowedExts))
    {
    if($_FILES["file"]["error"] > 0)
    {
        echo "Error: " . $_FILES["file"]["error"] . "<br />";
    }
    else
    {
        echo "Upload: " . $_FILES["file"]["name"] . "<br />";
        echo "Type: " . $_FILES["file"]["type"] . "<br />";
        echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
        echo "Stored in: " . $_FILES["file"]["tmp_name"];

        if (file_exists("upload/" . $_FILES["file"]["name"]))
        {
            echo $_FILES["file"]["name"] . " already exists. ";
        }
        else
        {
            move_uploaded_file($_FILES["file"]["tmp_name"],
            "upload/" . $_FILES["file"]["name"]);
            echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
        }
    }
}
else
{
    echo "Invalid file";
} 
```

?>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T02:18:01.217

您可以将其添加到您的主页以显示上传的文件：

```
<?php
if ($handle = opendir('upload/')) {
    while (false !== ($entry = readdir($handle))) {
        if ($entry != "." && $entry != "..") {
            echo "$entry<br>";
        }
    }
    closedir($handle);
}   
?> 
```

当然，您必须重定向回主页以查看文件列表并可能上传更多文件。或者使用ajax来上传文件，这样你就不会被强制重定向回来。

我已经使用现成的插件来实现这一切： [http ://blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T18:59:18.317

您可以使用[Ajax 文件上传](http://www.phpletter.com/Our-Projects/AjaxFileUpload/)。使用 ajax 上传文件，然后将文件路径作为响应返回...然后将该响应打印为页面上的链接（在某些 div、字段中...）

```
 $.ajaxFileUpload
    (
        {
            url:'upload_file.php',
            secureuri:false,
            fileElementId:'file',
            dataType: 'json',
            success: function (response)
            {
                $("#div_where_you_print_response").html(response)
            },
            error: function (data, status, e)
            {
                alert(e);
            }
        }
    ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T23:02:48.803

1）使用[Header 功能](http://php.net/manual/en/function.header.php)`header('Location: ... ');`将用户重定向到主上传页面
2）您需要使用 *sql 解决方案来存储文件链接并显示它们。
2a) 为所有上传的文件赋予唯一的文件名（即 md5($file['name'])

# sql - 将主行添加到查询结果

> ID：12665844
> 
> 赞同：0
> 
> 时间：2012-09-30T22:53:48.410
> 
> 标签：sql, sql-server-2005

如何在 MSSQL 2005 中向查询结果添加主行。这是我需要返回的示例？

这是两个查询

查询 1

```
select product_id, sku from products 
```

查询 2

```
select product_id, sku from childproducts 
```

结果应该是这样的。（当然没有查询1）

```
 row 1: products.product_id, products.sku   (comes from one parent table)
    row 2: childproducts.product_id, childproducts.sku   (comes from child table)
    row 3: childproducts.product_id, childproducts.sku   (comes from child table) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:00:30.723

您可以使用 UNION ALL 组合它们，例如

```
select 1 as Sorter, product_id, sku from products
UNION ALL
select 2, product_id, sku from childproducts
ORDER BY Sorter, product_id 
```

请注意，我添加了 Sorter 列以使父集显示在子产品之前。如果您必须排除它，但仍按该顺序显示它们：

```
select product_id, sku
from (
    select 1 as Sorter, product_id, sku from products
    UNION ALL
    select 2, product_id, sku from childproducts
) X
ORDER BY Sorter, product_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:06:13.950

如果我理解正确，您想添加一个保持行顺序的主键，因此子项立即跟随父项。以下代码`row_number()`用于分配新 id：

```
select row_number() over (order by parentproduct_id, isparent desc) as newid,
       product_id, sku
from ((select product_id, sku, product_id as parentproduct_id, 1 as isparent
       from productions
      ) union all
      (select product_id, sku, parentproduct_id, 0 as isparent
       from childproducts
      )
     ) p 
```

如果您实际上并不想要数据中的 id 而只是想要排序顺序，请添加以下内容：

```
order by parentproduct_id, isparent desc 
```

# html - 删除css绝对位置，同时保持元素内联

> ID：12665845
> 
> 赞同：0
> 
> 时间：2012-09-30T22:53:54.683
> 
> 标签：html, css

如果不使用绝对定位的跨度，我如何才能做到这一点？

```
<div>
 <span style="position: absolute; right: 5px;">[details]</span>
 <div style="background-color: White;">
  <span style="white-space: pre;">foo: !         Bar: ?</span>
 </div>
</div> 
```

导致显示`position: absolute;`错误，需要调整。如何更改此标记以显示与此处相同：http: [//jsfiddle.net/yHHAL/](http://jsfiddle.net/yHHAL/)但不使用`position: absolute;`？如果必须，元素的顺序可以更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:00:34.533

使用`float: right`而不是您的`position: absolute`.

[http://jsfiddle.net/Wexcode/xtzzq/](http://jsfiddle.net/Wexcode/xtzzq/)

# javascript - 如何使 iframe 的 div 浮动在应该是页面背景的 iframe 的另一个 div 之上

> ID：12665851
> 
> 赞同：2
> 
> 时间：2012-09-30T22:54:39.977
> 
> 标签：javascript, html, css

我阅读了许多相关的问题，但我的情况似乎有点不同，这些问题都不适合我。

我想要实现的是拥有一个浮动收音机播放器，可以在我的博客中不间断地播放音乐。我使用 iframe 将我的博客作为整个页面的背景，然后将另一个 iframe 用于广播播放器，它浮动在前一个 iframe 的顶部。

我想我发现的所有方法都不起作用的原因是因为我的 iframe 的属性：

```
<iframe src="my blog address" frameborder="0" style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px" height="120%" width="120%"></iframe> 
```

以下是整个页面的样子（我需要收音机播放器漂浮在顶部）：

```
<!DOCTYPE html>
<html>
<head>
</head>

<body>

<div id="radio_player">
<iframe src="http://douban.fm/partner/baidu/doubanradio" frameborder="0"></iframe>
</div>

<div id="blog_background">

<iframe src="http://swotong.com" frameborder="0" style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px" height="120%" width="120%"></iframe>

</div>

</body>
</html> 
```

我对在这里编码和发布问题很陌生，感谢您的帮助。

最好的祝福

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:16:38.587

尝试添加`z-index:1`到您想要在顶部的框架。

你可以看到它在[这里工作](http://jsfiddle.net/)

你必须使用一个`position`属性才能工作。

[来自 css3.com 的位置属性](http://www.css3.com/css-position/)

# xml - 如何从 XML 文档的日期时间格式中提取星期几

> ID：12665854
> 
> 赞同：0
> 
> 时间：2012-09-30T22:54:54.613
> 
> 标签：xml, xslt, datetime-format, dayofweek

我正在尝试从 XML 文件的日期时间格式中提取 XSLT 样式表中的日期。我使用的是 XSLT 1.0 和 XPATH 而不是 Python，这是我的限制。这是我在 XML 文档上的代码的一个示例：

```
 <forecast-period index="3" start-time-local="2010-08-09T00:00:00+10:00" end-time-local="2010-08-10T00:00:00+10:00" start-time-utc="2010-08-08T14:00:00Z" end-time-utc="2010-08-09T14:00:00Z">
            <element type="forecast_icon_code">12</element>
            <element type="air_temperature_minimum" units="Celsius">8</element>
            <element type="air_temperature_maximum" units="Celsius">15</element>
            <text type="precis">Chance of light rain.</text>
        </forecast-period> 
```

我想从列表中提取星期一的预测。我试图在谷歌上搜索，发现星期几功能适用于此，但无法正确实施。我是这个 XSLT 和 XML 的新手。所以，我不知道如何从给定时间打印一天。

你能给我一些想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:17:21.580

您似乎在问两个问题：如何从 XML 中解析出时间戳，以及如何从时间戳中找到星期几。首先，您应该使用 XML 解析器，例如[lxml](http://lxml.de/)或 python 的内置[xml.parsers.expat](http://docs.python.org/library/pyexpat.html)。

[一旦有了时间戳字符串，就可以使用python-dateutil](http://labix.org/python-dateutil)库轻松转换为工作日名称：

```
import dateutil.parser
start_time_local = "2010-08-07T00:00:00+10:00"
weekday_name = dateutil.parser.parse(start_time_local).strftime('%A') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:02:40.537

你在这里没有提供很多信息，但我通常会转向 lxml 包来处理这些事情。如果您知道所需数据的路径，那应该非常简单。我建议您查看以下[lxml 文档](http://lxml.de/xpathxslt.html)并根据需要使用更具体的问题来编辑您的问题以完成您的任务。我希望这有帮助。如果您发布其他信息，我将尝试完善我的答案。

# ruby-on-rails - 在 Rails 3.2 中保存当前页面的按钮

> ID：12665855
> 
> 赞同：0
> 
> 时间：2012-09-30T22:55:11.907
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, mechanize, open-uri

我需要一个按钮来保存当前的网站（就像点击“另存为”一样），我在控制器中创建了一个方法，它适用于任何外部网站（比如[http://www.google.com](http://www.google.com)）但是不适用于我的应用程序内的站点，我收到超时错误！这对我没有解释:(

任何线索是什么问题？

```
#CONTROLLER FILE
def save_current_page
  # =>  Using MECHANIZE
  agent = Mechanize.new
  page = agent.get request.referer
  send_data(page.content, :filename => "filename.txt")
end 
```

我也试过 Open URI，同样的问题！

```
#CONTROLLER FILE
def save_current_page
 # => USANDO OPEN URI
 send_data(open(request.referer).read, :filename => "filename.txt")
end 
```

我正在使用 rails 3.2 和 ruby​​ 1.9，感谢任何帮助，我已经花了大约 10 个小时试图让它工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T04:53:49.783

Rails 一次只能处理一个请求。这是两个请求之间永无止境的对峙 - 第一个请求正在等待第二个请求，但第二个请求正在等待第一个请求，因此您会收到超时错误。即使您使用Passenger 或其他方式运行应用程序的多个实例，这也是一个坏主意。

我能想到解决它的唯一方法是使用如下条件语句：

```
referer = URI.parse(request.referer)

if Rails.application.config.default_url_options[:host] == referer.host
  content = "via yoursite.com"
else
  agent = Mechanize.new
  page = agent.get request.referer
  content = page.content
end

send_data content, filename: "filename.txt" 
```

有点脏，但它应该可以解决超时问题。至于从您自己的网站获取页面的实际内容 - 这取决于您。你可以渲染模板，从缓存中抓取一些东西，或者只是忽略它。

一个更好的解决方案是将此代码排入 Resque 或 Delayed Job 之类的内容中。然后队列可以发出请求并像往常一样排队等待请求页面。这也意味着用户不必等待您的应用程序发出远程请求，这很危险，因为谁知道页面需要多长时间才能响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T23:39:24.753

经过几个小时和许多其他帖子后，我得到了最终解决方案：

Bricker 是对的，因为 Rails 不能在一次调用中多次渲染，取自[http://guides.rubyonrails.org/layouts_and_rendering.html](http://guides.rubyonrails.org/layouts_and_rendering.html) “只能渲染或重定向一次操作”

该网站还声明“规则是，如果您没有在控制器操作的末尾显式渲染某些内容，Rails 将自动在控制器的视图路径中查找 action_name.html.erb 模板并渲染它。”

然后，对我来说很好的解决方案是告诉控制器如果在 :params 中设置了下载标志 (download=true) 则呈现为字符串（我还使用 request.url 让它从我的应用程序中的任何视图工作)

看法：

```
= link_to 'Download', request.url+"&downloadexcel=true", :class => 'btn btn-primary btn-block' 
```

控制器：

```
def acontrolleraction
  #some controller code here
  if params[:downloadexcel]
    save_page_xls
  else
    # render normally
  end
end

def save_page_xls
  #TRESCLOUD - we create a proper name for the file
  path = URI(request.referer).path.gsub(/[^0-9a-z]/i, '')
  query = URI(request.referer).query.gsub(/[^0-9a-z]/i, '')
  filename = @project_data['NOMBRE']+"_"+path+"_"+query+".xls"

  #TRESCLOUD - we render the page into a variable and process it
  page = render_to_string

  #TRESCLOUD - we send the file for download!
  send_data(page, :filename => filename, :type => "application/xls")
end 
```

感谢您的提示！

# google-app-engine - 从特定电子邮件域强制注册

> ID：12665858
> 
> 赞同：0
> 
> 时间：2012-09-30T22:55:30.327
> 
> 标签：google-app-engine, email, jinja2

我正在使用 google app engine 和 jinja 创建一个注册表单，要求用户使用他们的电子邮件地址进行注册。但是，我希望电子邮件仅来自特定域（例如 gmail.com）。

如何向输入的地址发送电子邮件以要求确认？

我不确定如何将 Python 与 PHP/Ruby 连接起来以编写电子邮件确认脚本。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:13:13.720

提交表单后，您可以使用 Python Mail API 发送邮件，如下所示：

```
from google.appengine.api import mail
....
message = mail.EmailMessage(sender = YOUR_GAE_EMAIL_ADDRESS, subject = 'confirmation request')
message.to = 'john.doe@gmail.com'
message.body = 'Confirm your email address using ...'
message.send() 
```

# java - 如果我初始化一个对象数组并且不设置任何值，那么默认值是多少？

> ID：12665859
> 
> 赞同：0
> 
> 时间：2012-09-30T22:55:33.123
> 
> 标签：java, arrays

我知道如果是原始类型数组，比如int，会是0，但是作为对象，比如String或者自定义类，还是0吗？空值？要不然是啥？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-30T22:57:00.830

它始终是元素类型的默认值——`null`对于任何类类型，0 表示数字类型，`'\0'`for`char`和`false`for `boolean`。（`NULL`在Java中不存在，0对于引用来说是一个无意义的值。它可能是内存中的*物理表示*，但它本身并不是一个引用值。）

请参阅JLS 的[第 15.10.1 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.10.1)了解数组创建的工作原理，并参阅第 4.12.5[节了解](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)有关不同类型的默认值的更明确的详细信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-30T22:57:06.207

对象数组的元素被初始化为`null`。像馅饼一样简单。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-30T23:00:39.670

对对象的任何引用都被初始化为`null`。[在这里](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)，您可以找到 Java 如何初始化其原始数据类型（包括对对象的引用）。

回顾一下：

```
Data Type   Default Value (for fields)
byte        0
short       0
int         0
long        0L
float       0.0f
double      0.0d
char        '\u0000'
any object  null
boolean     false 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T00:04:24.873

为了帮助您了解默认类型的原则，请考虑一下对象的决定性默认值是什么？

*   对于**int**任何数字都是有意义的，比如*0*
*   对于**布尔值**，任何逻辑值都是有意义的，例如*false*
*   对于**char**任何符号都有意义，例如*'\0'*
*   ...

此类型存在**明确范围的有效值（***例如 {false, true}*）。所以任何值都可以用作默认值。

对于对象，没有明确的有效值范围。对象可以保存任何成员变量或提供一些方法，但**对象没有特定的“值”**。

# zend-framework - 在 WAMP 环境中执行 php 命令

> ID：12665863
> 
> 赞同：0
> 
> 时间：2012-09-30T22:56:44.803
> 
> 标签：zend-framework, command-line-interface, easyphp

我是在 WAMP 环境中工作的新手，在这种情况下，我使用的是 Easyphp，但我找不到如何执行 php 命令（例如简单的 php -v），例如在连接到使用 SSH 的服务器。

我安装了 Easyphp，apache 和 mysql 服务器已打开，并且我使用该模块在我尝试执行 php 命令的同一文件夹中创建了一个虚拟主机（使用 Windows 中的 cmd 工具）。

有没有其他方法可以做到这一点？是否有专门为此而设的“控制台”？任何帮助，将不胜感激！

**编辑**

好的，也许我应该举一个具体的例子来说明我正在尝试做的事情，以防我没有很好地解释自己。我正在尝试按照本[指南](http://framework.zend.com/manual/2.0/en/user-guide/skeleton-application.html)开始使用 Zend Framework，并且在下载文件后的第一步中，它要求“键入”2 个命令：

```
php composer.phar self-update
php composer.phar install 
```

我在哪里准确地“输入”这些命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T06:20:44.173

在 Windows 中，您需要设置路径环境变量（如果安装程序尚未完成），以便它指向 PHP 可执行文件的正确位置。请参阅 EasyPHP 的文档以查看您是否需要/如何执行此操作。

然后，打开一个dos窗口，`cd`进入你的项目目录。然后您应该能够运行如图所示的命令。

# mongodb - MongoDB 聚合数组项

> ID：12665866
> 
> 赞同：1
> 
> 时间：2012-09-30T22:56:55.663
> 
> 标签：mongodb, mapreduce

鉴于下面显示的架构和 MongoDB shell 版本：2.0.4：

我将如何计算印象数数组中的项目数？

我在想我必须做一个 Map Reduce，这似乎有点复杂，我认为 count 函数会做到这一点。
有人可以证明这一点吗？

![Mongo 架构](../Images/15700005d987c47aa166b9e75c7cf7ab.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:56:27.203

一个简单的计数示例是：

```
var count = 0;
db.engagement.find({company_name: "me"},{impressions:1}).forEach(
    function (doc) {
        count += doc.impressions.length;
    }
)
print("Impressions: " + count); 
```

如果要处理大量文档，最好将计数保持为显式字段。您可以在推送到印象数数组时更新计数，或者根据需要使用[增量 MapReduce](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-IncrementalMapreduce)重新计数更新的文档。

# mysql - 列存在时查询不同的表

> ID：12665869
> 
> 赞同：0
> 
> 时间：2012-09-30T22:57:05.010
> 
> 标签：mysql, sql

数据库：MySql 5.5.3

我`type`在表中有一个列`topic`，如果`type`是“E”，这意味着“事件”表中存在一个条目，它应该查询“TOPIC_HAS_EVENT”表以从 EVENT 表中获取更多列。同样，如果 Type 是“P”，这意味着“轮询表”中存在一个条目，它应该查询“TOPIC_HAS_POLL”表以从 POLL 表中获取几列。如果类型为空，那么它应该像往常一样查询以从注释表中获取所有行及其注释。

最终结果应该包含所有类型（'E'、'P'、NULL）的所有主题行及其来自其他表的特定列。如果这可以轻松完成，那么我需要添加更多列，如下所述

## 更复杂

如果 type='E' 有一些行，它应该从 EVENT_HAS_USER 表中获取更多行，例如用户信息。

# 关系

```
Each Topic has Many Comments
Each Topic has One Event
Each Topic has One Poll

EVENT ManyTOMany User 
```

# 到目前为止创建的查询。我仍然需要添加“类型”列。请帮帮我。

```
SELECT DISTINCT
        T.TOPIC_GUID, COUNT(*) TOTAL_COMMENTS
    FROM
        CIRCLE C, CIRCLE_HAS_USER CHU, CIRCLE_HAS_TOPIC CHT, TOPIC T
    LEFT JOIN TOPIC_COMMENT TC ON T.TOPIC_GUID = TC.TOPIC_GUID
    WHERE
        CHT.CIRCLE_GUID = C.CIRCLE_GUID
            AND T.TOPIC_GUID < 400000 -- ?
            AND CHT.TOPIC_GUID = T.TOPIC_GUID
            AND CHU.CIRCLE_GUID = C.CIRCLE_GUID
            AND CHU.USER_GUID = 1
            AND CHU.STATUS = 'A'
    GROUP BY T.TOPIC_GUID
    ORDER BY T.LAST_UPDATED_TIMESTAMP DESC
    LIMIT 10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T02:03:16.383

尝试这个：

```
select (case when type = 'type1' then (select field from table1) else (select field from table2) end) as a from table; 
```

# asp.net-mvc - 检查是否已在 .net mvc 中选中复选框

> ID：12665878
> 
> 赞同：0
> 
> 时间：2012-09-30T22:58:34.450
> 
> 标签：asp.net-mvc, checkboxfor

我有一个包含复选框的强类型 ViewModel。

当我在控制器中处理更新时，**我需要确定该项目是否已被检查。**

我该怎么做呢？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:11:50.940

```
[HttpPost]    
public ActionResult Update(MyViewModel viewModel)
{
    var isChecked = viewModel.ThePropertyUsedWithYourCheckBoxFor;
} 
```

或者，我错过了什么？

# google-chrome - Chrome websocket 连接延迟

> ID：12665887
> 
> 赞同：4
> 
> 时间：2012-09-30T23:00:53.613
> 
> 标签：google-chrome, websocket

我对 websockets 和 chrome (22.0.1229.79m) 有一个奇怪的问题（我还没有为其他浏览器编写身份验证代码，所以我无法测试它们）。好像如果我重新加载 chrome 3 次，连接到我的 websocket 服务器会有很大的延迟。服务器没有延迟连接，我通过在 chrome 延迟并且连接完美时与另一台 PC 连接来测试它。

有没有什么办法解决这一问题？当我切换接收数据的服务器时，这是一个问题。它会停止，并延迟。这对用户体验来说真的很糟糕。我认为这与chrome浏览器没有关闭套接字严格相关......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T17:35:01.897

在短时间内从 Chrome 中的同一浏览器选项卡创建多个 WebSocket 连接时，我也看到了这种延迟。我相信这是为了解决 WebSockets 的潜在安全问题，该问题将允许浏览器被劫持以在网络内进行端口扫描。通过限制在给定时间内可能发生的 WebSocket 连接的数量，您极大地限制了浏览器作为远程端口扫描器的实用性。此外，出于同样的原因，有意限制 onclose 和 onerror 返回的信息量。

# javascript - 不间断音乐的 AJAX 历史

> ID：12665890
> 
> 赞同：0
> 
> 时间：2012-09-30T23:01:14.390
> 
> 标签：javascript, ajax, html5-audio, browser-history

晚安，

我的网络项目有问题：

当用户单击页面上的内部链接时，新内容由 AJAX 加载。在另一个`<div>`中，有一个`<audio>`元素不会被这个动作打断。问题是，没有历史记录，因此单击浏览器的后退按钮将使用户转到他来自的外部页面。我该如何解决这个问题？

我知道它有效，因为他们在[beatport.com](http://beatport.com)上设法做到了。

# php - 无法让 Python 3 将 POST 数据传输到 PHP

> ID：12665898
> 
> 赞同：1
> 
> 时间：2012-09-30T23:02:45.087
> 
> 标签：php, python, http, post, urllib

我想将一个简单的字符串从 Python 3 发送到一个 PHP 站点，该站点将其转换为 .txt 文件。我的整个代码如下所示：

Python：

```
import urllib.parse
import urllib.request

str1 = "abcdefg"

url = "http://site.net/post.php"

aa = str1.encode('utf-8')
req = urllib.request.Request(url, aa)
req.add_header('Content-Type', 'this/that')
urllib.request.urlopen(req, data=aa) 
```

PHP：

```
<?php

$handle = fopen("/dir/".name.".txt", "w");

$myContent = $_POST[aa];

fwrite($handle, $myContent);

fclose($handle);

?> 
```

Python 访问该站点，并创建一个 .txt 文件，但该文件为空白。我尝试更改`$_POST`为`$_GET`and `$_REQUEST`，以及`'aa'`在各个地方放置单引号和双引号。我怀疑`Python`并且`PHP`没有传达我希望它解释的字符串/数据的名称。

> 编辑：此 PHP 代码已经处理来自另一个网站的 POST 数据。该问题仅与 Python 兼容性有关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:14:16.540

您的数据需要像这样的哈希：

```
a = {}
a["name"] = "ben"; 
```

那么你需要调用 urllib.urlencode 就可以了

```
a = urllib.urlencode(a) 
```

然后像这样调用 urlopen：

```
urllib.request.urlopen(req, a) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T23:15:21.903

您可以使用 use`file_put_contents`并且`$_POST[aa]`应该是无效的`$_POST['aa']`

```
$file = "/dir/".name.".txt" ;
file_put_contents($file, $_POST['aa']); 
```

我认为你应该看看[httplib2](http://code.google.com/p/httplib2/)

```
from httplib2 import Http
from urllib import urlencode
h = Http()
str1 = body = {'aa': 'abcdefg'}
resp, content = h.request("http://site.net/post.php", "POST", urlencode(data)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T00:25:04.063

您发送的数据无效。按照[文档](http://docs.python.org/py3k/library/urllib.request.html#urllib.request.urlopen)：

> *data*应该是标准 application/x-www-form-urlencoded 格式的缓冲区。urllib.parse.urlencode() 函数采用 2 元组的映射或序列，并以这种格式返回一个字符串。**在用作数据参数之前，它应该被编码为字节**。

该文档还包含一个您只需要遵循的[简单示例：](http://docs.python.org/py3k/library/urllib.request.html#urllib-examples)

```
import urllib.request
import urllib.parse

data = urllib.parse.urlencode({'spam': 1, 'eggs': 2, 'bacon': 0})
data = data.encode('utf-8')
request = urllib.request.Request("http://requestb.in/xrbl82xr")

# adding charset parameter to the Content-Type header.
request.add_header("Content-Type","application/x-www-form-urlencoded;charset=utf-8")

f = urllib.request.urlopen(request, data)
print(f.read().decode('utf-8')) 
```

# sql - 查询以查找两个表和两个列之间的一对多关系（排除任何一对一的关系）

> ID：12665900
> 
> 赞同：2
> 
> 时间：2012-09-30T23:02:48.363
> 
> 标签：sql

这个论坛的新手，SQL 的新手。我正在尝试清理一些数据并找出错误。我有两个表，它们都共享 FILENAME、TYPE、SEC 列，我想从两个表中提取 SEC 和 TYPE 之间存在一对多关系的任何记录，以及只有一个 SEC 和 TYPE 的任何记录to one 关系可以忽略并被认为是有效的。

例如，我在表 1 中。

```
FILENAME TYPE SEC

a----------------x----1

b----------------x----2

c----------------y----1

d----------------y----3 
```

在 table2 我会有类似的东西，

```
FILENAME TYPE SEC

e----------------x----1 

f----------------x----2

g----------------z----1

h----------------y----3 
```

所以我想要一个可以找到的查询

```
FILENAME TYPE SEC

a----------------x----1

c----------------y----1

e----------------x----1

g----------------z----1 
```

我的数据库非常大，任何帮助将不胜感激！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:12:19.010

```
select t1.sec, t1.type, count(*) from table1 as t1 
join table2 as t2 on t1.sec = t2.sec and t1.type = t2.type
group by t1.sec, t1.type
having count(*) > 1 
```

编辑：这不是你问的，这将显示哪些有多个记录，但它们会被分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:13:05.273

您需要找到`sec`具有多个 1的值`type`。以下查询执行此操作，它应该适用于任何数据库：

```
select t.*
from ((select t1.*
       from t1
      ) union all
      (select t2.*
       from t2
      )
     ) t join
     (select sec
      from ((select t1.*
             from t1
            ) union all
            (select t2.*
             from t2
            )
           ) t
      group by sec
      having count(distinct type) > 1
     ) s
     on t.sec = s.sec 
```

可能有更有效的查询方式，具体取决于数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T23:13:32.223

```
select 'table1' which, t.*
from (
    select sec, min(type) typea, max(type) typeb
    from table1
    group by sec
    having min(type) <> max(type)
) x
join table1 t on t.sec = x.sec
UNION ALL
select 'table2', t.*
from (
    select sec, min(type) typea, max(type) typeb
    from table1
    group by sec
    having min(type) <> max(type)
) x
join table2 t on t.sec = x.sec 
```

第二个只是复制第一个，使用 UNION ALL 组合

# c++ - 如何在 Windows + Eclipse + Cygwin + GCC 下设置 wxWidgets

> ID：12665905
> 
> 赞同：0
> 
> 时间：2012-09-30T23:03:37.920
> 
> 标签：c++, windows, eclipse, gcc, wxwidgets

我正在尝试在 Windows 7、Eclipse CDT 和 Cygwin GCC 下使用 wxWidgets。

谁能提供一些关于如何在该环境下安装和编译 wxWidgets 的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:06:59.230

有一个[视频教程](http://wxwidgets.info/wxwidgets_and_eclipse_video/)显示了完整的安装和配置过程。在视频中使用了 MinGW，但对于 Cygwin 过程应该非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T09:35:51.773

请参阅[Eclipse wxWiki 页面](http://wiki.wxwidgets.org/Eclipse)。它看起来很旧，但可能仍然有用。

# php - 在 Symfony 2.1 上安装 PropelBundle

> ID：12665906
> 
> 赞同：2
> 
> 时间：2012-09-30T23:03:49.573
> 
> 标签：php, symfony, propel, symfony-2.1

我正在尝试在 Symfony 2.1 上安装 PropelBundle 分支 1.1。我按照手动安装的说明进行操作，但不确定在哪里注册命名空间。

现在我收到此错误消息：`Fatal error: Class 'Propel\PropelBundle\PropelBundle' not found in D:\www-files\Symfony\app\AppKernel.php on line 22`

第 22 行如下所示：`new Propel\PropelBundle\PropelBundle()`

我的 autoload.php 看起来像这样：

```
use Doctrine\Common\Annotations\AnnotationRegistry;

$loader = require __DIR__.'/../vendor/autoload.php';

// intl
if (!function_exists('intl_get_error_code')) {
    require_once __DIR__.'/../vendor/symfony/symfony/src/Symfony/Component/Locale/Resources/stubs/functions.php';

    $loader->add('', __DIR__.'/../vendor/symfony/symfony/src/Symfony/Component/Locale/Resources/stubs');
}

AnnotationRegistry::registerLoader(array($loader, 'loadClass'));

return $loader; 
```

我应该在 autoload.php 中添加一些东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T06:34:28.803

在 composer.json 中添加以下内容

```
"require" :  {
   .....
    "propel/propel-bundle" :  "1.1.*" 
} , 
```

并运行

```
php composer.phar update propel/propel-bundle 
```

该教程是 [http://www.mon-code.net/article/45/initialisation-dun-projet-symfony-2-1-avec-un-depot-git-et-composer](http://www.mon-code.net/article/45/initialisation-dun-projet-symfony-2-1-avec-un-depot-git-et-composer)

# android - 语音识别和与音乐的声音比较

> ID：12665909
> 
> 赞同：2
> 
> 时间：2012-09-30T23:04:59.493
> 
> 标签：android, speech-recognition, speech

我正在尝试使用语音识别制作一个 Android 应用程序，但不幸的是，谷歌不支持我的语言（马其顿语），我正在尝试比较两种录音声音。

我正在使用[http://code.google.com/p/musicg/](http://code.google.com/p/musicg/)来记录和比较语音，并且我在初始化用于检测语音的设置时堆栈。有人可以告诉我如何重写这个初始化函数语音检测对我来说非常重要..或其他一些想法如何做到这一点。

这是哨声检测的初始化

```
 // settings for detecting a whistle

            minFrequency = 600.0f;
            maxFrequency = Double.MAX_VALUE;

            minIntensity = 100.0f;
            maxIntensity = 100000.0f;

            minStandardDeviation = 0.1f;
            maxStandardDeviation = 1.0f;

            highPass = 500;
            lowPass = 10000;

            minNumZeroCross = 50;
            maxNumZeroCross = 200;

            numRobust = 10; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-04T04:57:58.953

我的理解是，就目前而言，musicg DetectionApi 仅用于分析单个声音块并告诉您它是否包含该*类型*的声音。例如包含的口哨或拍手 api 示例。即是拍手/是口哨。

使用 musicg，您可能做的最好的事情就是识别声音是否是声音。尽管这可能超出了[DetectionApi](http://code.google.com/p/musicg/source/browse/src/com/musicg/api/DetectionApi.java?r=f2fbf166a1d95059650274d6ee668ec08fec03cf)。

既然你说 google api 不支持 Macedonian，也许你可以试试[Pocketsphinx](http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/)，在[这篇 stackoverflow 文章](https://stackoverflow.com/questions/10991442/voice-recognition-without-internet-in-android)中提到了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-08T01:17:55.130

以下是我如何将临时录制的声音保存为 wav 格式：

```
public class RecorderActivity {

    private static final int RECORDER_BPP = 16;
    private static final String AUDIO_RECORDER_FILE_EXT_WAV = ".wav";
    private static final String AUDIO_RECORDER_FOLDER = "HQProtocol/sound";
    private static final String AUDIO_RECORDER_TEMP_FILE = "record_temp.raw";
    private String AUDIO_RECORDER_FILE = "";
    private static final int RECORDER_SAMPLERATE = 8000;
    private static final int RECORDER_CHANNELS = AudioFormat.CHANNEL_IN_MONO;
    private static final int RECORDER_AUDIO_ENCODING = AudioFormat.ENCODING_PCM_16BIT;

    private RealDoubleFFT transformer;

    EndPointDetection endpoint;

    int blockSize = 256;

    private AudioRecord recorder = null;
    private int bufferSize = 0;
    private RecorderAsynctask recordingThread = null;
    private boolean isRecording = false;

    float tempFloatBuffer[] = new float[3];
    int tempIndex = 0;
    int totalReadBytes = 0;

    ImageView imageView;
    Bitmap bitmap;
    Canvas canvas;
    Paint paint;

    Context con;

    RecorderActivity(String file, Context con, ImageView image) {
        AUDIO_RECORDER_FILE = file;
        this.con = con;

        this.imageView = image;
        bitmap = Bitmap.createBitmap((int) 256, (int) 100,
                Bitmap.Config.ARGB_8888);
        canvas = new Canvas(bitmap);
        paint = new Paint();
        paint.setStrokeWidth(5);
        paint.setColor(Color.BLUE);
        imageView.setImageBitmap(bitmap);

        transformer = new RealDoubleFFT(256);

        bufferSize = AudioRecord.getMinBufferSize(RECORDER_SAMPLERATE,
                RECORDER_CHANNELS, RECORDER_AUDIO_ENCODING);

    }

    public String getFilename() {
        String filepath = Environment.getExternalStorageDirectory().getPath();
        File file = new File(filepath, AUDIO_RECORDER_FOLDER);

        if (!file.exists()) {
            file.mkdirs();
        }

        return (file.getAbsolutePath() + "/" + AUDIO_RECORDER_FILE + AUDIO_RECORDER_FILE_EXT_WAV);
    }

    private String getTempFilename() {
        String filepath = Environment.getExternalStorageDirectory().getPath();
        File file = new File(filepath, AUDIO_RECORDER_FOLDER);

        if (!file.exists()) {
            file.mkdirs();
        }

        File tempFile = new File(filepath, AUDIO_RECORDER_TEMP_FILE);

        if (tempFile.exists())
            tempFile.delete();

        return (file.getAbsolutePath() + "/" + AUDIO_RECORDER_TEMP_FILE);
    }

    public void startRecording() {
        recorder = new AudioRecord(MediaRecorder.AudioSource.MIC,
                RECORDER_SAMPLERATE, RECORDER_CHANNELS,
                RECORDER_AUDIO_ENCODING, bufferSize);

        recorder.startRecording();

        isRecording = true;

        recordingThread = new RecorderAsynctask();
        recordingThread.execute(this);

    }

    class RecorderAsynctask extends AsyncTask<RecorderActivity, double[], Void> {

        public void shareLockedfuntionProgreesUpdate(double[] fttrezult) {

            publishProgress(fttrezult);

        }

        @Override
        protected Void doInBackground(RecorderActivity... params) {
            // TODO Auto-generated method stub

            byte data[] = new byte[bufferSize];
            String filename = getTempFilename();
            FileOutputStream os = null;

            try {
                os = new FileOutputStream(filename);
            } catch (FileNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            int read = 0;

            AudioTrack tempAudioTrack;

            double[] toTransform = new double[blockSize];

            if (null != os) {
                while (isRecording) {
                    // sampleRateTextField.setText(recorder.getSampleRate());

                    int bufferReadResult = recorder.read(data, 0, blockSize);

                    for (int i = 0; i < blockSize && i < bufferReadResult; i++) {
                        toTransform[i] = (double) data[i] / 32768.0; // signed
                                                                        // 16
                                                                        // bit
                    }

                    transformer.ft(toTransform);
                    publishProgress(toTransform);

                    if (AudioRecord.ERROR_INVALID_OPERATION != read) {
                        try {

                            os.write(data);
                            tempIndex++;

                        } catch (IOException e) {
                            e.printStackTrace();
                        }
                    }

                }

                try {
                    os.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }

            return null;
        }

        @Override
        protected void onProgressUpdate(double[]... toTransform) {
            canvas.drawColor(Color.GRAY);
            Paint p = new Paint();
            for (int i = 0; i < toTransform[0].length; i++) {

                int x = i;
                int downy = (int) (100 - (toTransform[0][i] * 10));
                int upy = 100;
                p.setColor(Color.rgb(downy % 256, i % 256, upy % 256));
                canvas.drawLine(x, upy, x, downy, p);

            }
            imageView.invalidate();
        }

    }

    public void writeAudioDataToFile(RecorderAsynctask asyntask) {
        byte data[] = new byte[bufferSize];
        String filename = getTempFilename();
        FileOutputStream os = null;

        try {
            os = new FileOutputStream(filename);
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        int read = 0;

        double[] toTransform = new double[256];

        if (null != os) {
            while (isRecording) {
                // sampleRateTextField.setText(recorder.getSampleRate());

                int bufferReadResult = recorder.read(data, 0, 256);

                for (int i = 0; i < 256 && i < bufferReadResult; i++) {
                    toTransform[i] = (double) data[i] / 32768.0; // signed
                                                                    // 16
                                                                    // bit
                }

                transformer.ft(toTransform);
                asyntask.shareLockedfuntionProgreesUpdate(toTransform);

                if (AudioRecord.ERROR_INVALID_OPERATION != read) {
                    try {

                        os.write(data);
                        tempIndex++;

                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }

            }

            try {
                os.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    public void stopRecording() {
        if (null != recorder) {
            isRecording = false;

            recorder.stop();
            recorder.release();

            recorder = null;
            recordingThread = null;
        }

        copyWaveFile(getTempFilename(), getFilename());
        deleteTempFile();
    }

    private void deleteTempFile() {
        File file = new File(getTempFilename());

        file.delete();
    }

    private void copyWaveFile(String inFilename, String outFilename) {
        FileInputStream in = null;
        FileOutputStream out = null;
        long totalAudioLen = 0;
        long totalDataLen = totalAudioLen + 36;
        long longSampleRate = RECORDER_SAMPLERATE;
        int channels = 1;
        long byteRate = RECORDER_BPP * RECORDER_SAMPLERATE * channels / 8;

        byte[] data = new byte[bufferSize];

        try {
            in = new FileInputStream(inFilename);
            out = new FileOutputStream(outFilename);
            totalAudioLen = in.getChannel().size();
            totalDataLen = totalAudioLen + 36;

            WriteWaveFileHeader(out, totalAudioLen, totalDataLen,
                    longSampleRate, channels, byteRate);

            while (in.read(data) != -1) {
                out.write(data);
            }

            in.close();
            out.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private void WriteWaveFileHeader(FileOutputStream out, long totalAudioLen,
            long totalDataLen, long longSampleRate, int channels, long byteRate)
            throws IOException {

        byte[] header = new byte[44];

        header[0] = 'R'; // RIFF/WAVE header
        header[1] = 'I';
        header[2] = 'F';
        header[3] = 'F';
        header[4] = (byte) (totalDataLen & 0xff);
        header[5] = (byte) ((totalDataLen >> 8) & 0xff);
        header[6] = (byte) ((totalDataLen >> 16) & 0xff);
        header[7] = (byte) ((totalDataLen >> 24) & 0xff);
        header[8] = 'W';
        header[9] = 'A';
        header[10] = 'V';
        header[11] = 'E';
        header[12] = 'f'; // 'fmt ' chunk
        header[13] = 'm';
        header[14] = 't';
        header[15] = ' ';
        header[16] = 16; // 4 bytes: size of 'fmt ' chunk
        header[17] = 0;
        header[18] = 0;
        header[19] = 0;
        header[20] = 1; // format = 1
        header[21] = 0;
        header[22] = (byte) channels;
        header[23] = 0;
        header[24] = (byte) (longSampleRate & 0xff);
        header[25] = (byte) ((longSampleRate >> 8) & 0xff);
        header[26] = (byte) ((longSampleRate >> 16) & 0xff);
        header[27] = (byte) ((longSampleRate >> 24) & 0xff);
        header[28] = (byte) (byteRate & 0xff);
        header[29] = (byte) ((byteRate >> 8) & 0xff);
        header[30] = (byte) ((byteRate >> 16) & 0xff);
        header[31] = (byte) ((byteRate >> 24) & 0xff);
        header[32] = (byte) (2 * 16 / 8); // block align
        header[33] = 0;
        header[34] = RECORDER_BPP; // bits per sample
        header[35] = 0;
        header[36] = 'd';
        header[37] = 'a';
        header[38] = 't';
        header[39] = 'a';
        header[40] = (byte) (totalAudioLen & 0xff);
        header[41] = (byte) ((totalAudioLen >> 8) & 0xff);
        header[42] = (byte) ((totalAudioLen >> 16) & 0xff);
        header[43] = (byte) ((totalAudioLen >> 24) & 0xff);

        out.write(header, 0, 44);
    }

    public void closeThreadIfisnot() {
        recordingThread.cancel(true);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-08T01:02:14.770

首先，您所要做的就是将录制的声音保存到 wav 中，然后很容易从他们的 API 中使用指纹类[https://code.google.com/p/musicg/source/browse/#git%2Fsrc% 2Fcom%2Fmusicg%2F指纹](https://code.google.com/p/musicg/source/browse/#git%2Fsrc%2Fcom%2Fmusicg%2Ffingerprint)

这是我进行比较的方法，一个临时录制的 WAV 声音与我数据中的所有 wav 声音。

```
public Cursor FP(String recordedClip, Context context) {

    Baza baza = new Baza(context);

    Cursor allSound = baza.getAllProtocolsForSoundCheck();

    List<Protocol> protocols = new ArrayList<Protocol>();
    int PID =-1;

    Log.d("broj",allSound.getCount()+"");

    for (int i = 0; i < allSound.getCount(); i++) {

        Protocol protocol = new Protocol();
        allSound.moveToNext();
        protocol.setSoundPath(allSound.getString(4));
        protocol.setId(Integer.parseInt(allSound.getString(1)));
        protocols.add(protocol);

        Log.d("brojProtocol",allSound.getString(2)+" ");
        baza.updateProtocolsSoundSimilarity(protocol.getId(), (float) -1);
    }

    Wave record = new Wave(recordedClip);

    List<Wave> waves = new ArrayList<Wave>();

    if (protocols != null) {
        for (int i = 0; i < protocols.size(); i++) {
            waves.add(new Wave(protocols.get(i).getSoundPath()));
        }
    }

    for (int i = 0; i < waves.size(); i++) {

        Log.d("similarity", record.getFingerprintSimilarity(waves.get(i))
                        .getSimilarity()+"");

        baza.updateProtocolsSoundSimilarity(protocols.get(i).getId(),
                record.getFingerprintSimilarity(waves.get(i))
                        .getSimilarity());
    }

    Cursor similarCursor = baza.getSimilarProtocols();
    similarCursor.moveToFirst();
    TransferClass protocolForTransfer = new TransferClass();
    protocolForTransfer.setId(Integer.parseInt(similarCursor.getString(1)));
    protocolForTransfer.setName(similarCursor.getString(2));

    Log.d("passobj",protocolForTransfer.getName()+" "+protocolForTransfer.getId());
//  return protocolForTransfer;

    return similarCursor;
} 
```

# php - PHP PEAR 邮件使用 Google Apps 邮件帐户失败 - 错误 535 身份验证失败

> ID：12665915
> 
> 赞同：0
> 
> 时间：2012-09-30T23:06:28.637
> 
> 标签：php, gmail, pear

我有一个 PHP 页面，它使用[PEAR Mail](http://pear.php.net/manual/en/package.mail.mail.php)通过 Google Apps 邮件帐户发送消息。该页面仅在秋季和冬季有效，并且在 1 月份最后一次使用时**运行良好。**

现在，当我为秋季准备网站时，此页面不再有效。[我遇到了与使用 PEAR 邮件的 SMTP 错误 535（不正确的身份验证数据）](https://stackoverflow.com/questions/11460582/smtp-error-535-incorrect-authentication-data-using-pear-mail)中描述的完全相同的问题。这个问题没有答案，它不允许我发表评论，所以我开始一个新问题。

我使用的代码与 pavan kumar 在[Send email using the GMail SMTP server from a PHP page](https://stackoverflow.com/questions/712392/send-email-using-gmail-smtp-server-from-php-page)中发布的代码相同。

错误信息是：

```
authentication failure [SMTP: Invalid response code received from server (code: 535, response: Incorrect authentication data)] 
```

我仔细检查了邮件用户的登录名自一月份以来没有更改。我将脚本中的地址和密码复制并粘贴到浏览器的 Gmail 登录中。它起作用了，所以我知道我的参数是正确的。此帐户是企业域地址，而不是 @gmail.com。

我正在尝试连接：

```
$host = "ssl://smtp.gmail.com";
$port = "465"; 
```

我还尝试指定 tls:// 和端口 587，但没有运气。根据另一个 SO 线程中的建议，我还将主机设置为“googlemail.com”而不是“gmail.com”。

我对 $smtp 对象进行了 var_dump()，并确认我的地址和密码已成功且准确地传递到其中。

该帐户位于最近升级到 PHP 5.3.5 和 Apache 2.2.22 的 cPanel 系统上。变化似乎不太可能引发这个问题，但我提到它以防它可能是一个因素。

编辑：找到[http://support.google.com/a/bin/answer.py?hl=en&answer=176600 上面](http://support.google.com/a/bin/answer.py?hl=en&answer=176600) 写着“...您必须使用设备或应用程序的 IP 地址为您的域配置 SPF 记录以确保收件人不会拒绝从它发送的邮件。您还必须将此 IP 地址添加到 Google Apps 控制面板中的电子邮件白名单框中。例如。如果您的发送设备从 123.45.67.89 发送，则将该地址添加到您的 SPF记录而不从记录中删除 Google Apps 邮件服务器...”不幸的是，我在此域中没有电子邮件白名单框 - 它是免费的 <10 用户帐户，显然没有该功能。

* * *

编辑 2：相关： http: [//support.google.com/mail/bin/answer.py ?hl=en&answer=78775](http://support.google.com/mail/bin/answer.py?hl=en&answer=78775)

* * *

编辑 3：我在 Opera 邮件中设置了帐户，并使用 AUTH LOGIN 和 AUTH PLAIN 设置成功发送。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T04:48:50.943

问题出在我的网络主机上，而不是 Google 的邮件服务器上。

该帐户位于 cPanel 服务器上，管理员已将其设置为只有指定的用户帐户才能访问外部 SMTP 服务器。为了让我进行测试，他禁用了该要求，我的邮件系统立即开始工作。

不过，到目前为止，我还没有找到关于如何在激活其 SMTP 身份验证时作为授权用户之一登录 cPanel 的文档。如果我找到一些，我会更新这个。

# javascript - 异步 JS 问题——变量范围或其他错误？

> ID：12665921
> 
> 赞同：0
> 
> 时间：2012-09-30T23:07:48.857
> 
> 标签：javascript, asynchronous

我有一个`select`元素`change`事件的侦听器：在更改时，会获取一个文件并计算一个复杂的 SVG 并将其加载到 DOM（读取：需要相当数量的 CPU 周期）。问题是，如果您`select`非常快速地更改（通过编码的键盘快捷键），则会将多个内容加载到 SVG 容器中——我一次只希望加载一个。为了解决这个问题，我做了这个（半伪）：

```
select.on("change", function() { queue(this.val); });

var queuedFile, state = "ready";
function queue(file) {
    queuedFile = file;
    // NB: in real code, queuedFile is a property and the getter empties the queue
    if (state === "ready") { loadFile(queuedFile); }
}

function loadFile(file) {
    state = "busy";

    ajaxGet(file, function(result) {

        // lots of statements, iterators, calls to other fns

        state = "ready";
        // NB: again in real code the getter empties the queue
        var qf = queuedFile;
        if (qf) { clearSVG(); loadFile(qf); }

    }); // end ajaxGet
} 
```

也就是说：在`select`更改时，将新文件排队，如果文件加载器不忙于加载另一个文件，则加载它，否则什么也不做。文件加载器完成后，如果有排队文件，则清除 SVG 并加载排队文件。似乎这一次应该只允许 SVG 容器中的一个文件。

实际上，`state`永远不会`"busy"`在签入时`queue()`，所以我仍然将多个文件加载到 SVG 中。不过，`console.log(state)`紧随其后的`state = "busy"`演出`"busy"`。我在这里想念什么？我不认为这是范围的问题`queuedFile`。

* * *

为了完整起见，我的队列属性是这样的：

```
// given: all of this code is enclosed in a function that returns an object "viewer".
// (only one instance of the "viewer" is created)

Object.defineProperty(viewer, "queuedFile", {
    get: function () {
        console.log("dequeuing", this.filequeue);
        var buffer = this.filequeue;
        this.filequeue = null;
        return buffer;
    },
    set: function (newval) {
        console.log("queuing", newval);
        this.filequeue = newval;
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T13:57:27.160

根据评论，这似乎对您有所帮助！

[http://jsfiddle.net/2FNsh/1/](http://jsfiddle.net/2FNsh/1/)

你的叉子最终有帮助：

[http://jsfiddle.net/FkMHw/1/](http://jsfiddle.net/FkMHw/1/)

# performance - 片段或几何着色器：计算渲染的三角形？

> ID：12665922
> 
> 赞同：0
> 
> 时间：2012-09-30T23:07:50.190
> 
> 标签：performance, opengl, geometry, triangle-count

`gl_PrimitiveID`似乎计算了渲染的基元数量。这似乎可以通过片段和几何着色器获得。

这是否是视锥体中渲染三角形的准确计数（假设只有 tris，因为图元 ID 也适用于线和点）而不是整个场景？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T00:01:36.310

该`gl_PrimitiveID`变量从几何着色器输出并馈送到片段着色器。如果不存在几何着色器，则片段着色器`gl_PrimitiveID`是当前渲染调用中已处理的图元数。也就是说，它是通过顶点处理管道发送的点/线/三角形的数量。如果您跟注`glDrawArrays(GL_TRIANGLES, 0, 33);`，您将`gl_PrimitiveID`在半开范围 [0, 11) 上得到 a。

如果存在几何着色器*，*则`gl_PrimitiveID`采用您从 GS 输出的任何值。如果 GS 存在并且您*没有*写入该值，则片段着色器将获得未定义的值。请注意，您可以只复制`gl_PrimitiveIDIn`到`gl_PrimitiveID`您编写的每个顶点以获得标准的 OpenGL 行为。

简而言之，不，它没有考虑视锥体剔除。除非您的 GS 确实确实查看了每个三角形的截锥体剔除（我会建议这样做）。

# lua - 将文件的前 10 行读入 Lua 表的正确代码？

> ID：12665930
> 
> 赞同：1
> 
> 时间：2012-09-30T23:09:10.863
> 
> 标签：lua

我刚刚学习 Lua，我的书（*Lua 编程*）中有一些代码“读取文件的前 10 行：”

```
a = {}
for i=1,10 do
    a[#a+1] = io.read()
end 
```

这对我来说真的没有任何意义。这不是读取十个零值吗？有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T23:50:20.217

简短版本：归结为是否`io.input`在您的问题中未列出的代码中较早地调用过。如果它被调用，它将打印该文件的前 10 行（下面将详细解释）。如果之前没有调用它并且您是从命令行运行或以交互方式运行，那么一旦代码执行，它将打印您在控制台中键入的前 10 行。对于其他情况，这仅取决于应用程序的启动方式。

[Lua 5.1](http://www.lua.org/manual/5.1)参考手册`io.read`说如下：

> io.read (···)
> 
> 等效于 io.input():read。

并且文档`io.input`说：

> 当使用文件名调用时，它会打开命名文件（以文本模式），并将其句柄设置为默认输入文件。当使用文件句柄调用时，它只是将此文件句柄设置为默认输入文件。当不带参数调用时，它返回当前的默认输入文件。[...]

`file.read`（`file`作为调用返回的对象）的文档`io.input()`说：

> 根据给定的格式读取文件*file*，指定要读取的内容。对于每种格式，该函数返回一个字符串（或一个数字），其中包含已读取的字符，如果无法读取指定格式的数据，则返回 nil。当不带格式调用时，它使用读取整个下一行的默认格式 [...]

所以这里有两种可能：

*   `io.input`之前使用参数（您的问题中未显示一些代码）调用，设置默认输入文件。不带参数的调用`io.read`将返回该输入文件的“默认格式”，即“整个下一行”。
*   `io.input`之前*没有*使用参数调用（如果没有其他代码，在您的情况下是这样）。不带参数的调用`io.read`将返回标准输入的“整个下一行”，例如如果程序从命令行运行，则返回用户的命令行输入。

在第一种情况下，`nil`将`io.read()`在读取完文件的所有行后返回。这可能意味着 10 个读取实例`nil`，但这取决于文件。

在第二种情况下，`nil`如果标准输入用尽，将返回，这可能以不同的方式发生，具体取决于应用程序的启动方式。这也可能意味着 10 个`nil`.

# xslt - 基于其子节点值的节点

> ID：12665934
> 
> 赞同：-2
> 
> 时间：2012-09-30T23:09:42.437
> 
> 标签：xslt

例如，我有以下 xml 输入：

```
<Letter>
  <LetterProductInfo>
    <Paragraph>
        <DisplayOrder>
            20
        </DisplayOrder>
        <Text>
            text abc
        </Text>
    </Paragraph>
  </LetterProductInfo>
</Letter>

<Letter>
    <LetterProductInfo>
    <Paragraph>
        <DisplayOrder>-10</DisplayOrder>
        <Text>
            text kkk
        </Text>
    </Paragraph>
  </LetterProductInfo>
</Letter>

<Letter>
   <LetterProductInfo>
    <Paragraph>
        <DisplayOrder>-20</DisplayOrder>
        <Text>
            text xyz
        </Text>
    </Paragraph>
  </LetterProductInfo>
</Letter> 
```

我需要帮助来编写 xsl，以便它将遍历所有字母节点并根据 DisplayOrder 的值选择文本 [我无法硬编码，因为我不知道 displayorder id 是什么，我所知道的是整数值]

就像是：

```
<xsl:for-each select="Letter">
   <!--
   missing logic so that xsl:value-of select="?" will print
   1\. test xyz - because its DisplayOrderId is -20
   2\. text kkk - because its DisplayOrderId is -10
   3\. text abc - because its DisplayOrderId is 20
    -->
</xsl:for-each> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T07:29:58.323

如果我很好理解你的问题，你想输出一个特定的字符串，例如：

> 1.  测试 xyz

对于每个 Letter，但您希望根据 DisplayOrder 的数值对 Letter 元素进行排序。

xsl:sort 为您执行此操作：

```
<xsl:for-each select="Letter">
  <xsl:sort select="number(LetterProductInfo/Paragraph/DisplayOrder)"
    data-type="number"/>
  <!-- your code for processing a Letter goes here -->
</xsl:for-each> 
```

或者你也可以这样做：

```
<xsl:apply-templates select="Letter">
  <xsl:sort select="number(LetterProductInfo/Paragraph/DisplayOrder)"
    data-type="number"/>
  <!-- your code for processing a Letter goes into a separate xsl:template -->
</xsl:apply-templates> 
```

我建议你 RTFM 关于 xsl:sort 在[http://www.w3.org/TR/xslt20/#xsl-sort](http://www.w3.org/TR/xslt20/#xsl-sort)

我的代码假设 LetterProductInfo/Paragraph/DisplayOrder 只返回 1 个节点。

注意：对于您的下一个问题，您可能希望更具体地了解您期望的输出。例如，我假设您只想要字符串而不是 HTML。

# html - 动态页面上的粘滞页脚 - IE6 问题

> ID：12665948
> 
> 赞同：0
> 
> 时间：2012-09-30T23:12:44.247
> 
> 标签：html, css, internet-explorer-6, sticky-footer

我有一个使用这种方法有一个粘页脚的页面：http: [//matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)

该页面是通过 Javascript 动态创建的，除了 IE6 之外，所有浏览器都可以完美地使用我的粘性页脚（不幸的是我必须支持这个愚蠢的浏览器）。页脚位于窗口底部并停留在那里（页面超出窗口大小），因此当您滚动时，页脚停留在中心。

这是我的置顶页脚的相关 html 代码：

```
<div class="container">
  <div class="header">...</div>
  <div class="navigation">...</div>
  <div class="main">...</div>
  <div class="footer">...</div>
</div> 
```

CSS：

```
html, body { height:100%; }
.container { min-height:100%; position:relative; }
.main { padding-bottom:50px; }
.footer { padding:10px 0; position:absolute; bottom:0; width:100%; background:#ffffff; height:22px; line-height:22px; }
.ie6 .container { height:100%; zoom:1;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:21:15.697

我总是对我的 Sticky Footers 使用相同的方法，它在 IE6 中也适用于我，你应该尝试一下：

[http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)

祝你好运！

# java - 数组的元素作为对另一个数组的引用？

> ID：12665950
> 
> 赞同：0
> 
> 时间：2012-09-30T23:13:02.813
> 
> 标签：java

我试图有一个 16 行 x 11 列的二维数组，其中第 0 行、第 3 列是对另一个数组的引用，该数组是一维数组。我该怎么做呢？我已经有两个数组，其中一维数组是 char 数组（尽管如果我愿意，我可以将其设为字符串数组）并且二维数组是字符串数组。2D 数组的其余部分为每个元素填充了纯字符串，但第 0 行第 3 列除外，我希望它是一维数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:34:01.247

```
Object[] arrayToReference = ...;
Object[][] arrayWithReference =  new Object[] { ..., arrayToReference, ...}; 
```

这应该有效；只需引用数组，它应该随着原始更改而更改

这是一个示例代码片段：

```
 Object[] array = new Object[] { "Test!" };
    Object[][] arrayArray = new Object[][] { array };
    System.out.println("Before: " + arrayArray[0][0]);
    array[0] = "Test2!";
    System.out.println("After: " + arrayArray[0][0]); 
```

它具有以下输出：

```
Before: Test!
After: Test2! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:29:23.297

听起来你解决问题的方法是错误的。也许你应该重新考虑你的数据结构。通常，键入一个数组。您不能真正决定在一个单元格中插入不同的类型。

如果您真的无法更改数据结构，请尝试在每个单元格中插入一个单维字符串数组，其中只有 1 个条目，这是正常进入的字符串，除了第 0 行第 3 列，这已经是大批。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T23:34:38.720

我正在考虑一个矫枉过正的解决方案，但应该通过一些改进来解决这个问题。如果对你来说可能的话。

你能创建两个实现相同接口的类吗？第一个是二维数组的类型，另一个是一维数组的类。

由于它们实现了一个通用接口，因此您可以使用该接口创建一个二维数组。那种二维数组可以在它的任何地方接受任何类型的两个对象。

# c - 结构链表分段-故障

> ID：12665958
> 
> 赞同：0
> 
> 时间：2012-09-30T23:13:51.453
> 
> 标签：c, pointers, segmentation-fault, structure

我刚开始在我的一个实验室中计算课程的 GPA，这些课程的信息存储在结构的链接列表中。到目前为止，我正在尝试打印所有课程信息，以确保它们已正确初始化并添加到链接列表中。

我遇到了一个问题，因为我不断收到分段错误。我理解分段错误的含义，但我不知道我在哪里犯了错误。任何帮助，将不胜感激。

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>

#define MAX_CLASSES 20

/* Function Prototypes */
struct course * initcourse( int, char *, char *, float, char *, char *);
void add( struct course * );

/* Definition of a data node holding course information */
  struct course {
    int term;
    char name[15];
    char abbrev[20];
    float hours;
    char grade [4];
    char type[12];
    struct course *next;
  };

/* head points to first node in list, end points to last node in list */
/* initializes both to NULL, no nodes yet */
struct course *head = (struct course *) NULL;
struct course *end = (struct course *) NULL;

/* Initializes a node, allocates memory for the node, and returns     */
/* a pointer to the new node. Must pass correct parameters.           */
struct course * initcourse( int term, char *name, char *abbrev, float hours, char *grade, char *type)
{
  struct course *ptr;
  ptr = (struct course *) calloc( 1, sizeof(struct course ) );
  if( ptr == NULL )

    return (struct course *) NULL;

  else
    {
      ptr->term = term;
      strcpy( ptr->name, name );
      strcpy( ptr->abbrev, abbrev );
      ptr->hours = hours;
      strcpy( ptr->grade, grade );
      strcpy( ptr->type, type );
      return ptr;
    }
}

/* This adds a node to the end of the list. You must allocate a node and */
/* then pass its address to this function                                */ 
void add(struct course *new)
{
  if (head == NULL)
    {
      head = new;
    }
  else
    {
      end->next = new;
      end = new;
    }
}

/* Prints all information in a node */
void printnode( struct course *ptr )
{
  printf("Term ->%d\n", ptr->term );
  printf("Name ->%s\n", ptr->name );
  printf("Abbreviation ->%s\n", ptr->abbrev );
  printf("Hours ->%f\n", ptr->hours );
  printf("Grade ->%s\n", ptr->grade );
  printf("Type ->%s\n", ptr->type );
}

/* Prints List of Nodes */
void printlist( struct course *ptr ) 
{ 
  while( ptr != NULL ) 
    { 
      printnode( ptr ); 
      ptr = ptr->next;  
    } 
} 

/* Calculates GPA */
/* float gpa ( struct course *ptr ) */
/* { */
/*   float totalhours; */
/*   float gpa; */
/*   float gradepoints; */

/*   while (ptr != NULL ) */
/*     { */
/*       totalhours += (ptr->hours); */
/*       gradepoints = (ptr->hours * ptr->grade); */
/*     } */
/*   gpa = (gradepoints /ptr->hours); */
/* } */

int main()
{

  int term;
  char name[15];
  char abbrev[20];
  float hours;
  char grade[4];
  char type[12];
  float gpa;
  struct course *ptr;

  struct course course1, course2, course3;

  course1.term = 1234;
  strcpy(course1.name,"cse1234");
  strcpy(course1.abbrev,"systems");
  course1.hours = 4;
  strcpy(course1.grade,"A");
  strcpy(course1.type,"GEC");

  ptr = initcourse(course1.term, course1.name, course1.abbrev, course1.hours, course1.grade, course1.type);

  struct course *head, *ptr2;
  head = ptr;
  // ptr2 = ptr;

  add(ptr);

  course2.term = 4332;
  strcpy(course2.name,"cse4332");
  strcpy(course2.abbrev,"Database");
  course2.hours = 4;
  strcpy(course2.grade,"B");
  strcpy(course2.type,"Technical");

  ptr2 =  initcourse(course2.term, course2.name, course2.abbrev, course2.hours, course2.grade, course2.type);

  add(ptr2);

  printlist(head);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:17:57.410

```
void add(struct course *new)
{
  if (head == NULL)
    {
      head = new;
    }
  else
    {
      end->next = new;
      end = new;
    }
} 
```

您需要在插入第一个节点时设置`end`为`new`（when `head == NULL`），否则在添加更多节点时您将取消引用空指针。

在 中`initcourse`，您应该将`next`成员设置为`NULL`，因为标准不能保证 all-bits-0 是空指针表示（*很*可能是，但不能保证）。

还，

```
struct course *head, *ptr2;
head = ptr; 
```

声明一个`head`隐藏全局变量的新局部变量，而不是直接分配给`head`（即使它是错误的），您应该调用`add(ptr);`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:18:03.540

你没有初始化`next`指针，所以最后一个元素包含一个坏指针，指向一些垃圾。

您也不初始化`end`.

另一个问题（与崩溃无关）是此代码将创建重复条目：

```
head = ptr;
add(ptr); 
```

还有其他问题。你真的应该得到一个调试器，看看发生了什么。

# java - 我如何在这里使用多态性来改进我的代码？

> ID：12665959
> 
> 赞同：1
> 
> 时间：2012-09-30T23:13:58.790
> 
> 标签：java, polymorphism

我已经阅读了它，而不是使用`instanceof`and`getClass`方法来实现多态性，因为它是更好的面向对象实践。

如果我的程序如下所示：

```
Piece
SlowPiece extends Piece,
FastPiece extends Piece,
SlowFlexible extends SlowPiece,
FastFlexible extends FastPiece 
```

我有以下规则：`SlowPiece's can only move one space, and FastPiece's as many as they'd like.`

我将如何使用`polymorphism`来确保如果我移动这样的一块`Piece piece1 = new SlowPiece();`，它不会移动超过一个？

我有一个游戏板类，它应该能够移动棋子，但我不知道如何在没有代码嗅探的情况下阻止它移动一个大于 1 的 SlowPiece。

基本上，我知道多态性对于列举事物是多么的棒，但实际上与它们交互时，我不知道如何正确使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T23:22:50.633

制作`Piece`抽象并添加抽象方法`move()`（`Piece`您也可以使用界面）。以不同的方式实施`move()`（a`SlowPiece`仅移动 1 个点等）。

```
public abstract class Piece {
    public abstract void move();
}

public class SlowPiece extends Piece {
    public void move() {
        System.out.println("moving a slow piece");
    }
}

public class FastPiece extends Piece {
    public void move() {
        System.out.println("moving a fast piece");
    }
}

Piece f = new FastPiece();
f.move();       

Piece s = new SlowPiece();
s.move(); 
```

在这里，`move()`拥有一切动人的逻辑；您甚至可以使用一些重载来允许运动变化（例如将 N/S/W/E 作为参数等）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T23:25:23.130

作为对这个问题的另一个考虑，让我们了解基本的整体概念。

*   一个`Piece`可以`move()`。
*   某些类型的`Piece` `move()`方式与其他类型不同。

可以声明`Piece`为接口，并让所有其他`Piece`s 实现这一点。这样，您*保证*每个`Piece`都有一个`move()`，并且还强制您确保每个`move()`都是不同的，具体取决于`Piece`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T23:19:40.680

除了多态性之外，您可能还应该考虑责任。

您的“董事会”课程应该做类似的事情

```
piece.move(); 
```

并且这件作品应该知道如何移动。因此，如果你有一个骰子，你可以将数字传递给 move 方法，然后作为

```
piece.move(moves); 
```

* * *

编辑：

棋盘应该管理这些动作，所以让 move 方法返回一个 int 步数。运动应该从另一个类来管理，比如板，而不是从作品本身。

我向您推荐一本关于 OO 分析的非常有趣的书：Craig Larman 的“Applying uml and patterns”。它还包含作为大富翁的棋盘游戏的分步示例！

# mysql - 它不会让我丢弃外键

> ID：12665967
> 
> 赞同：0
> 
> 时间：2012-09-30T23:15:28.993
> 
> 标签：mysql, sql, mysql-error-1025

我正在尝试从表中删除外键，但在 mysql 中出现以下错误：

> # 1025 - 将“./mobile_app/Question”重命名为“./mobile_app/#sql2-4517-15515”时出错（错误号：152）

这个错误是什么意思，如何解决？

下面是我试图删除外键的代码：

```
alter table Question drop foreign key FK_Option_Table; 
```

以下是问题表详细信息（此表中没有行）：

```
CREATE TABLE `Question` (
 `SessionId` varchar(10) NOT NULL DEFAULT '',
 `QuestionId` int(5) NOT NULL,
 `QuestionContent` varchar(5000) NOT NULL,
 `NoofAnswers` int(2) NOT NULL,
 `AnswerId` int(10) NOT NULL AUTO_INCREMENT,
 `ReplyId` varchar(2) NOT NULL,
 `QuestionMarks` int(4) NOT NULL,
 `OptionId` varchar(3) NOT NULL,
 PRIMARY KEY (`SessionId`,`QuestionId`),
 KEY `FK_Option_Table` (`OptionId`),
 KEY `FK_IndividualQuestion` (`QuestionId`),
 KEY `FK_Reply` (`ReplyId`),
 KEY `FK_AnswerId` (`AnswerId`)
) ENGINE=InnoDB AUTO_INCREMENT=76 DEFAULT CHARSET=utf8 
```

下面是 Option_Table 的详细信息：

```
CREATE TABLE `Option_Table` (
 `OptionId` varchar(3) NOT NULL,
 `OptionType` varchar(20) NOT NULL,
 PRIMARY KEY (`OptionId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

此表中有 24 行，下面是一个示例：

```
OptionId OptionType
O1       A-C
O2       A-D
O3       A-E
O4       A-F
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:22:59.027

这些是您拥有的索引而不是外键。我在您的创建语句中看不到外键。

创建外键的示例。

```
ALTER TABLE `Question` 
  ADD CONSTRAINT `SessionId`
  FOREIGN KEY (`SessionId` )
  REFERENCES `Option_Table` (`OptionId` )
  ON DELETE NO ACTION
  ON UPDATE CASCADE
, ADD INDEX `test_idx` (`SessionId` ASC) ;

ALTER TABLE `Question` DROP FOREIGN KEY `SessionId` ; 
```

# python - python中的堆栈跟踪和异常处理

> ID：12665971
> 
> 赞同：0
> 
> 时间：2012-09-30T23:16:45.460
> 
> 标签：python, python-2.7

我想设计一个 python 程序来处理其他程序中的异常，我也希望它能够访问 python 中的堆栈跟踪。我是 python 开发新手，但愿意学习，但我不知道从哪里开始。有人可以指出我可以遵循的方向/资源，并可能发展这些技能，特别是我应该学习什么来实现我的目标。

我想在 python 2.7 上开发这个

谢谢你的回复。

编辑： 通过处理异常，我只想知道发生了什么异常。就像在 Java 中使用 try catch 块一样，您可以在其中打印出堆栈跟踪并查看它是否是算术/数组越界错误

嗨，我也在想这条线上的东西，比如

```
 try

 (Execute python program here)  // ie import this program 

 except : 1st exception
 except : 2nd exception
 .
 .
 etc 
```

我知道如何从文件中读取，但不确定这对于执行别人编写的程序是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T01:55:18.650

看一下[回溯](http://docs.python.org/library/traceback.html)模块。它格式化和打印堆栈跟踪。您可以使用这是一个顶级异常处理程序。

```
import sys
import traceback

try:
    do_something()
except:
    ex, val, tb = sys.exc_info()
    traceback.print_exception(ex, val, tb) 
```

Python 本身本质上是在任何未捕获的异常上执行此操作，然后退出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T18:27:48.317

我对你的问题有点困惑；如果您只运行其他 python 代码，这将是自动的。您不需要读取任何文件，只需导入您要使用的 python 模块并调用它们的函数即可。当这些抛出异常时，它们只会最终出现在您的代码中，您可以根据需要处理它们，当然要考虑有关异常处理的最佳实践。

有关 python 异常的快速教程，请看[这里](http://docs.python.org/tutorial/errors.html)。

# ruby-on-rails - RoR 投票系统。如何计算票数、反对票和总票数？

> ID：12665978
> 
> 赞同：0
> 
> 时间：2012-09-30T23:18:25.630
> 
> 标签：ruby-on-rails, associations, voting

我正在尝试创建一个投票系统。正在投票的模型是问题，我有另一个名为 Vote 的模型，它拥有 issue_id 和 0 或 1 的投票值。投票是使用带有隐藏字段的表单创建的。这是在问题索引视图上。

```
<h1>Votes</h1> 
```

```
<% @issues.each do |issue| %>
<li>
    <div class="issue">
        <h2><%= issue.title %></h2>
        <p><%= issue.body %></p>

        <%= form_for(@vote, :remote => true) do |f| %>
        <%= f.hidden_field "issue_id", :value => issue.id %>
        <%= f.hidden_field "vote", :value => 1 %>
        <%= submit_tag "Up", :class => 'up-vote' %>
        <% end %>

        <%= form_for(@vote, :remote => true) do |f| %>
        <%= f.hidden_field "issue_id", :value => issue.id %>
        <%= f.hidden_field "vote", :value => 0 %>
       <%= submit_tag "Down", :class => 'down-vote' %>
        <% end %>

    </div>
</li>
<% end %> 
```

问题和投票之间存在 has_many 和 belongs_to 关系。我想在每个问题的按钮旁边显示赞成票和反对票的数量。所以我需要为每个问题拉出所有投票 = 1 的选票，以及所有投票 = 0 的选票，并计算每个问题。也想知道总票数。我该怎么做？我在问题模式中的投票模型问题关联和 votes_count 列上设置了 counter_cache。这项工作应该在控制器还是模型中完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:24:13.583

ActiveRecord 有一个`count`方法可以做你想做的事：http: [//api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-count](http://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-count)

例如，在您的控制器中：

```
@upvotes_count = Vote.count(:conditions => "issue_id = #{@issue.id} AND value = 1")
@downvotes_count = Vote.count(:conditions => "issue_id = #{@issue.id} AND value = 0")
@allvotes_count = Vote.count(:conditions => "issue_id = #{@issue.id}") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T23:25:36.803

我自己没有尝试过，但是您应该尝试向`Issue`模型中添加一些方法，如下所示：

```
def upvote_count
  votes.count(:conditions => "value = 1")
end

def downvote_count
  votes.count(:conditions => "value = 0")
end 
```

我在 Rails 文档中了解到这一点。您可以在这里亲自查看：

[http://ar.rubyonrails.org/classes/ActiveRecord/Calculations/ClassMethods.html](http://ar.rubyonrails.org/classes/ActiveRecord/Calculations/ClassMethods.html) [http://apidock.com/rails/ActiveRecord/Associations/CollectionAssociation/count](http://apidock.com/rails/ActiveRecord/Associations/CollectionAssociation/count)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T00:50:53.610

你真的需要自己存储选票吗？如果您没有任何其他约束，您将使用两个字段：`upvotes`和`downvotes`. 然后你定义两个动作，“upvote”和“downvote”，它们将相应的字段更新1。你可以原子地做，使用类似的东西

（模型）

```
class Issue < AR::Base

  def self.upvote(id)
    self.where(:id => id).update_all("upvotes = upvotes + 1")
  end

  def self.downvote(id)
    self.where(:id => id).update_all("downvotes = downvotes + 1")
  end

end 
```

（控制器）

```
class IssuesController < ApplicationController

  def upvote
    Issue.upvote(params[:id])
  end

  def downvote
    Issue.upvote(params[:id])
  end

end 
```

（路由器）

```
resources :issues do
  member do
    post :upvote
    post :downvote
  end
end 
```

（查看 - 哈姆）

```
= form_tag upvote_issue_path(@issue) do
  = submit_tag "Up"
= form_tag downvote_issue_path(@issue) do
  = submit_tag "Down" 
```

# c++ - 不能作为函数使用？

> ID：12665985
> 
> 赞同：1
> 
> 时间：2012-09-30T23:20:03.240
> 
> 标签：c++, macos

出于某种原因，我的met 变量不能用作我最后一个while 语句中的函数，即使我的其他两个变量可以。编译时出现错误：'(met <= 2.0e+1)' 不能用作函数|。我该如何解决？

```
// Garbage Collection. Michael Heusner.
#include <iostream>
#include <cmath>

using namespace std;

int main(){
int reg_lim, met_lim, glass_lim;
double reg, glass, met;
double total;
double reg_ratio, glass_ratio, met_ratio;

reg_lim= 50;
glass_lim= 20;
met_lim= 20;

cout << "How much regular, glass, and metal garbage do you have?" << endl;
cin>> reg;
cin>> glass;
cin>> met;

total= met+glass+reg;

cout<< "The total number of bags is "<< total<< endl;

met_ratio= met/total;
reg_ratio= reg/total;
glass_ratio= glass/total;

cout<< "The metal ratio is "<< met_ratio<< endl;
cout<< "The glass ratio is "<< glass_ratio<< endl;
cout<< "The regular ratio is "<< reg_ratio<< endl;
if( met==reg==glass)
{
cout<< "All garbage amounts are the same."<< endl;
}
else if (reg> glass && met)
{
cout<< "Regular is the largest."<< endl;
}
else if (glass> met && reg)
{
cout<< "Glass is the largest."<< endl;
}
else if (met> glass && reg)
{
cout<< "Metal is the largest."<< endl;
}

while( reg <= 50) (met <= 20)  (glass <= 20);{ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T23:22:35.133

您可能想要平衡一些括号并在该`while()`条件下添加一些逻辑运算符。一旦你这样做了，也许在左大括号之前丢失分号实际上会破坏你即将开始执行的无限循环，并使用适当的值`reg`,`met`和`glass`.

```
while (( reg <= 50) && (met <= 20) && (glass <= 20))
{
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T23:25:25.750

```
while( reg <= 50) (met <= 20)  (glass <= 20);{ 
```

会是你的问题！

这不是有效的 while 循环语句。

**相反，你应该写：**

```
while (( reg <= 50) && (met <= 20) && (glass <= 20)) {
//Statements for loop
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T23:22:53.147

您需要使用`&&`将您的条件链接在一起：

```
while ((reg <= 50) && (met <= 20) && (glass <= 20)) 
```

您之前的`if`陈述中有类似的问题：

```
if( met==reg==glass) 
```

这应该是：

```
if ((met==reg) && (reg==glass)) 
```

但由于这些是浮点数，您应该检查它们是否仅相差最小差异。

# opengl - 当调用 glutPostRedisplay 时，如何强制我的 GL 应用程序中的背景颜色立即更改？

> ID：12665986
> 
> 赞同：2
> 
> 时间：2012-09-30T23:20:12.600
> 
> 标签：opengl, background-color, glut

我有一个简单的窗口，其背景颜色在主循环中设置，并带有一些全局变量：

顶部的全局值：

```
static GLfloat redIntensity = 0.0; //values for background color 
static GLfloat greenIntensity = 0.0;
static GLfloat blueIntensity = 0.0; 
```

主要的：

```
int main(int argc, char** argv){
  ...
  glutDisplayFunc(display);
  ...
  glutKeyboardFunc(keyboard);  //**** 
  glutMainLoop();
  return 0;
} 
```

根据全局值实际设置颜色的显示：

```
 void display(void){

    glClear(GL_COLOR_BUFFER_BIT);     
    glPushMatrix();                   
    glClearColor(redIntensity, greenIntensity, blueIntensity, 0.0);
    ...
    ... //other stuff here is polygon drawn in middle of screen 

    glPopMatrix();
    glutSwapBuffers();
  } 
```

在键盘功能中，我有一个 switch 语句，它应该根据按下的键来改变背景颜色，例如：

```
...
     case 'm':
     {
       redIntensity = 0.5;
       greenIntensity = 0.0;
       blueIntensity = 0.5;
       bgc = MAGENTA;  //another global thing to keep track of current color for other reasons... 
     }
... 
glutPostRedisplay(); 
```

不幸的是，通过`glutPostRedisplay()`调用，背景颜色不会立即改变......用户必须单击其他位置或先按另一个键。我在其他地方读到`glutPostRedisplay()`只有 QUEUES 重新显示，所以我尝试`glFlush()`在之后直接添加该行。这仍然不起作用，所以我尝试在`glutDisplayFunc(display)`那里直接跟注。再一次，失败。

按下键后如何强制更改颜色？也许 main 或其他地方的排序调用引起了问题？唔...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T23:41:33.410

OpenGL是一个状态机。当 glClear 被调用时，它使用先前通过 glClearColor、glClearDepth、glClearStencil 设置的值。所以解决方案是将 glClearColor 调用放在 glClear 调用之前显示。

# python - python从字符串中导入代码

> ID：12665987
> 
> 赞同：1
> 
> 时间：2012-09-30T23:20:15.347
> 
> 标签：python, google-app-engine

我正在使用谷歌应用引擎，我试图基本上允许用户上传代码，稍后将由服务器执行。我还必须能够将变量发送到脚本，这就是为什么最初当我在桌面上运行所有内容时，我动态导入了所有内容（因为脚本的名称存储在变量中）。但现在我不能这样做，因为谷歌应用引擎环境中的文件系统。

我已经有一个数据库设置，所以我可以得到纯文本的代码。但是现在我想知道是否有任何方法可以导入 python 脚本，而不是从文件中，而是从包含 python 代码的变量中。

例如，如果这是纯文本代码，我怎样才能让它正确执行：

```
code = """
def Main(var):
    print "you entered: " + var
""" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T23:28:03.087

首先，为代码创建一个模块：

```
# define module_name somewhere
import types
module = types.ModuleType(module_name) 
```

您可能还想注册该模块：

```
import sys
sys.modules[module_name] = module 
```

然后编译代码：

```
# source should the code to execute
# filename should be a pseudo-filename that the code's from
# (it doesn't actually have to exist; it's used for error messages)
code_object = compile(source, filename, 'exec') 
```

然后在模块的上下文中执行代码对象：

```
exec code_object in module.__dict__ 
```

# function - 如何在matlab中将数据文本特定转换为整数？

> ID：12665990
> 
> 赞同：1
> 
> 时间：2012-09-30T23:21:06.890
> 
> 标签：function, matlab, rsa

我正在尝试将数据文本转换为整数以进行 RSA 加密。例如，像 cat 这样的单词将被翻译为 30120。其中 3 是 c，01 是 a，20 是 t。

所以每个字母都匹配一个从 1 到 26 的整数，其中 26 是 z。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T06:34:21.917

内部函数`double`会将字符串转换为表示字符串中元素的字符代码的整数序列。因此，例如：

```
double('cat') 
```

返回

```
99    97   116 
```

一点算术就能得到你想要的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T03:54:54.640

这应该给你一些开始。

```
abc = 'abcdefghijklmnopqrstuvwxyz';
word = 'cat';
str = '';
for i = 1:length(word); 
    idx = strfind(abc, word(i));
    str = [str,num2str(idx,'%02d')]
end
num = str2double(str) 
```

# heroku - Rails 3.2/Heroku 问题 - 在公共/视频中预编译 .mp4 视频

> ID：12665991
> 
> 赞同：1
> 
> 时间：2012-09-30T23:21:13.223
> 
> 标签：heroku, ruby-on-rails-3.2, html5-video, precompile

Rails 新手：我有一个 rails 应用程序，我想使用 html5 视频标签将视频放在一两个页面上。我目前正在使用 Rails 3.2 和 Heroku 的 cedar 堆栈来部署我的应用程序。将我的应用程序部署到 Heroku 时遇到问题。

我已将我的 .mp4 视频放在**public/videos**中，并且在运行 rails 的本地服务器时，一切正常。

但是，当我部署到 heroku 时，包含这些视频的页面无法加载，即“我们很抱歉，但出了点问题”。检查日志

```
heroku logs 
```

显示此错误

```
ActionView::Template::Error (car_circle.mp4 isn't precompiled) 
```

这并不奇怪，因为似乎公用文件夹不包含在 rails 3.2 资产管道中，因此其中的所有内容都没有得到预编译。

如果我的推理是正确的，我想知道如何将公共/视频包含在我的资产管道中，以便可以预编译这些视频。或者，如果我不应该将这些视频放在 /public 中，关于如何正确地将它们移入资产管道的一些指导也会很棒。

希望我已经为大家提供了足够的信息来帮助我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T12:30:30.460

添加

```
config.assets.paths << "#{Rails.root}/public/videos" 
```

到**config/application.rb**允许将文件夹 /public/videos 添加到资产管道中。这允许加载包含视频的页面，但是该页面仍然无法正确加载视频。

这将路径附加到资产管道。可以通过打开 rails 控制台查看资产管道中的路径，然后键入：

```
Rails.application.config.assets.paths 
```

您可能会遇到这样的列表：

```
 => ["/Users/someuser/Documents/Rails/some_app/app/assets/images", 
"/Users/someuser/Documents/some_app/app/assets/javascripts",...,
/Users/someuser/Documents/some_app/public/videos"] 
```

# css - CSS子父div

> ID：12665993
> 
> 赞同：-3
> 
> 时间：2012-09-30T23:21:15.220
> 
> 标签：css

Parent div 如何防止 div 子级向外扩展？像 div p 内容 div c。我不会在 div p 之外阻止 div c。

```
// html file
<div id="p" style="">
<div id="c">

</div>
</div>

// css file

#p {
    border: 3px solid #FC3;
    border-radius: 20px;    

}

#c {
    background-color: #0F3;
    position:absolute;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:30:30.403

您可以使用溢出：隐藏： `<div id="c" style="overflow:hidden;"/>`

# python - 函数不改变全局变量

> ID：12665994
> 
> 赞同：44
> 
> 时间：2012-09-30T23:21:17.873
> 
> 标签：python, global-variables

我的代码如下：

```
done = False

def function():
    for loop:
        code
        if not comply:
            done = True  #let's say that the code enters this if-statement

while done == False:
    function() 
```

由于某种原因，当我的代码进入 if 语句时，它在使用 function() 完成后并没有退出 while 循环。

但是，如果我这样编码：

```
done = False

while done == False:
    for loop:
    code
    if not comply:
        done = True  #let's say that the code enters this if-statement 
```

...它退出 while 循环。这里发生了什么？

我确保我的代码进入了 if 语句。我还没有运行调试器，因为我的代码有很多循环（相当大的二维数组），我放弃了调试，因为它太乏味了。当它在一个函数中时，为什么“完成”没有被改变？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-09-30T23:23:35.250

您的问题是函数创建了自己的命名空间，这意味着`done`函数内部`done`与第二个示例中的命名空间不同。使用`global done`第一个`done`而不是创建一个新的。

```
def function():
    global done
    for loop:
        code
        if not comply:
            done = True 
```

`global`可以在[此处](https://stackoverflow.com/questions/146557/do-you-use-the-global-statement-in-python)找到有关如何使用的说明

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-30T23:23:41.707

```
done=False
def function():
    global done
    for loop:
        code
        if not comply:
            done = True 
```

您需要使用 global 关键字让解释器知道您引用了全局变量`done`，否则它将创建一个只能在函数中读取的不同变量。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-30T23:23:44.347

使用`global`，只有这样你才能修改全局变量，否则`done = True`函数内部的语句将声明一个名为的新局部变量`done`：

```
done = False
def function():
    global done
    for loop:
        code
        if not comply:
            done = True 
```

阅读有关[全球声明的](http://docs.python.org/reference/simple_stmts.html#global)更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-21T09:35:32.103

### 使用 a`class`而不是`global`：

处理（不使用）全局变量的另一种方法是将您希望成为全局的函数和变量包装在一个**类**中。

虽然这对于这个特定案例来说有点繁重 - 类为项目添加了许多功能和灵活性。（个人）强烈推荐。

### 例如：

```
class Processor():
    """Class container for processing stuff."""

    _done = False

    def function(self):
        """A function which processes stuff."""
        # Some code here ...
        self._done = True

# See the flag changing.
proc = Processor()
print('Processing complete:', proc._done)
proc.function()
print('Processing complete:', proc._done) 
```

### 输出：

```
Processing complete: False
Processing complete: True 
```

# c# - 非常规的想法 - 如何将数组转换为类？

> ID：12665995
> 
> 赞同：1
> 
> 时间：2012-09-30T23:21:41.693
> 
> 标签：c#, arrays, class, search, autohotkey

首先，我是一个新手程序员。我学习了 AutoHotkey 脚本，一堆 c# 和一些或 c++。我的问题不是特定于语言或语法，而是一个概念。我将首先解释这种情况（任何代码都应该被解释为类似于伪代码）。

我最近的项目是一个即时通讯程序，有一个服务器和一个客户端。它们的工作方式如下：

## 服务器

*   将客户信息分配到 3 个不同的数组中（我不喜欢这样）
    *   NewConnection[skt]、userNick[nick]、nickFromSocket[skt]

## 客户

*   向服务器发送消息 > 服务器接收 > 服务器响应 > 客户端接收并将消息记录到聊天日志。

您可能已经注意到，数组 'userNick' 使用用户的实际昵称来代替传统的索引号（userNick[index]）。这很重要，工作方式如下：

```
// New user has connected
skt  = WINSOCK_getSkt()
NewConnection[skt]  // Simple to parse with a loop: NewConnection.MaxIndex()

// Receive new user's nickname
skt  = WINSOCK_getSkt()
nick = WINSOCK_getNick()
userNick[nick]      = nick
nickFromSocket[skt] = nick 
```

两次分配用户昵称背后的理论是避免使用循环来解析数组。这很简单并且可以实现，因为当客户端向服务器发送消息时，服务器可以看到套接字号（每个用户都是唯一的），使用该变量，我可以立即从 2 短行中获取用户的昵称：

```
// Get user's nickname
skt  = WINSOCK_getSkt()
nick = nickFromSocket[skt] 
```

我希望到目前为止一切都清楚。

## 问题

如何将所有这些转换为一个类，同时保持从数组中获取数据的速度？我知道使用类会更简单，也更合乎逻辑，但是当需要解析的用户越来越多时，我担心类的效率。对象/类中是否有等价物？感谢您抽出宝贵时间阅读本文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:26:40.743

是的，你确实需要一门课。喜欢

```
class User
{
    public string Nick { get; set; }
    public Socket Sock { get; set; }  // not sure about this type
    ...
} 
```

然后，根据您的实际需要，使用 a`List<User>`和/或`Dictionary<Connection, User>`.