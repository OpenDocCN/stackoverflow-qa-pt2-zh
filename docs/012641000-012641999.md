# StackOverflow 问答 12641000-12641999

# nhibernate - 通过 NHibernate 使用 binaryblob 和大文件的 system.outofmemoryexception

> ID：12641002
> 
> 赞同：0
> 
> 时间：2012-09-28T13:30:45.387
> 
> 标签：nhibernate

通过 NHibernate 使用 binaryblob 和大文件的 system.outofmemoryexception。我最多可以上传 45 MB 的文件，如果超过了我的系统内存不足异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:38:02.793

NHibernate 并不是为处理如此大的 blob 而设计的。使用内置的数据库流功能。如果您使用的是 MS SQL，那么您可以使用 SqlFileStream 类。

# html - CSS 菜单未正确对齐

> ID：12641003
> 
> 赞同：0
> 
> 时间：2012-09-28T13:30:56.510
> 
> 标签：html, css, twitter-bootstrap

JSFiddle：http: [//jsfiddle.net/jYSYW/](http://jsfiddle.net/jYSYW/)

我想把粉红色的菜单放在右下角`header .container`。我确实尝试过使用`position: relative;`，`aboslute`但没有成功......

有什么线索吗？

如果可能的话，我也不想将 ul/li *css*应用于引导下拉菜单。

谢谢

PS：这是我的主题的缩短版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:38:47.717

我添加了

```
header .container{
   height: 80px;
   position: relative;
   overflow: hidden;
}

nav.pull-right {
   position: absolute;
   bottom: 0;
   right: 0;
} 
```

它有效。这是一个新的小提琴：http: [//jsfiddle.net/dMu5y/](http://jsfiddle.net/dMu5y/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:40:47.050

[像这样？](http://jsfiddle.net/rJgGw/):)

添加：

```
 .container nav.pull-right {
     position: absolute;
     right: 0;
     bottom: 0;   
 }    
 .container {
       position: relative; 
       width: 100%; 
       height: 100%;
  } 
```

# asp.net - 中继器忘记单击下一个按钮时要显示的项目数

> ID：12641004
> 
> 赞同：0
> 
> 时间：2012-09-28T13:30:58.253
> 
> 标签：asp.net, vb.net, repeater

我有一个以 15 个为一组显示结果的中继器列表。当您单击下一个按钮时，它会显示下一个 15 个，依此类推。

我添加了一些按钮，这些按钮将过滤显示以显示 10、25、50 组的结果。

当您单击这些时，它确实可以工作，但是当您单击下一个按钮时，它会将显示值重置为 15。

以下是脚本块：

```
Public Property CurrentPage() As Integer
    Get
        ' look for current page in ViewState
            Dim o As Object = Me.ViewState("_CurrentPage")

        If o Is Nothing Then
            Return 0
        Else
            ' default to showing the first page
            Return CInt(o)
        End If
    End Get

    Set
        Me.ViewState("_CurrentPage") = value
    End Set
    End Property

    Protected Sub ItemsGet()
        Dim pageSize As Integer = 15
        ItemsGet(pageSize)
    End Sub

    Private Sub ItemsGet(ByVal pageSize As Integer)
        ' Read sample item info from XML document into a DataSet

        ' Populate the repeater control with the Items DataSet
        Dim objPds As New PagedDataSource()

        Dim selectedCategory As String = ddlCategory.SelectedValue.ToString()
        Dim selectedCategoryIndex As Integer = ddlCategory.SelectedIndex

        Dim selectedCategoryMonth As String = ddlCategoryMonth.SelectedValue.ToString()
        Dim selectedCategoryMonthIndex As Integer = ddlCategoryMonth.SelectedIndex

        Dim query = GetXmlDataSet()

        If (Not String.IsNullOrEmpty(selectedCategory) And selectedCategoryIndex > 0) Then
            query = query.Where(Function(x) x("SCategoryName") = selectedCategory)
        End If
        If (Not String.IsNullOrEmpty(selectedCategoryMonth) And selectedCategoryMonthIndex > 0) Then
            query = query.Where(Function(x) x("SCategoryMonth") = selectedCategoryMonth)
        End If

        If (query.Count() > 0) Then

            objPds.DataSource = query.CopyToDataTable().Rows
            objPds.AllowPaging = True
            objPds.PageSize = pageSize

            objPds.CurrentPageIndex = CurrentPage

            lblCurrentPage.Text = "Page: " + (CurrentPage + 1).ToString() + " of " + objPds.PageCount.ToString()

            ' Disable Prev or Next buttons if necessary
            cmdPrev.Enabled = Not objPds.IsFirstPage
            cmdNext.Enabled = Not objPds.IsLastPage
            Display10.Enabled = True
            Display25.Enabled = True
            Display50.Enabled = True

            categories.DataSource = objPds
            categories.DataBind()
        Else
            CurrentPage = 0
            categories.Controls.Clear()
            cmdPrev.Enabled = False
            cmdNext.Enabled = False
            Display10.Enabled = False
            Display25.Enabled = False
            Display50.Enabled = False
            lblCurrentPage.Text = "Page: 0 of 0 "
        End If
    End Sub

    Private Sub Display10_Click(ByVal sender As Object, ByVal e As System.EventArgs)
        Dim pageSize As Integer = 10
        CurrentPage = 0
        ItemsGet(pageSize)
    End Sub

    Private Sub Display25_Click(ByVal sender As Object, ByVal e As System.EventArgs)
        Dim pageSize As Integer = 25
        CurrentPage = 0
        ItemsGet(pageSize)
    End Sub

    Private Sub Display50_Click(ByVal sender As Object, ByVal e As System.EventArgs)
        Dim pageSize As Integer = 50
        CurrentPage = 0
        ItemsGet(pageSize)
    End Sub

    Private Sub cmdPrev_Click(ByVal sender As Object, ByVal e As System.EventArgs)

        ' Set viewstate variable to the previous page
        CurrentPage -= 1

        ' Reload control
        ItemsGet()
    End Sub

    Private Sub cmdNext_Click(ByVal sender As Object, ByVal e As System.EventArgs)
        ' Set viewstate variable to the next page
        CurrentPage += 1

        ' Reload control
        ItemsGet()
    End Sub

    Protected Sub ddlCategory_SelectedIndexChanged1(ByVal sender As Object, ByVal e As System.EventArgs)
        CurrentPage = 0
        ItemsGet()
    End Sub

    Protected Sub ddlCategoryMonth_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs)
        CurrentPage = 0
        ItemsGet()
    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:42:33.610

您需要“坚持”要获取的项目数量。

有几种方法可以做到这一点......

将 PageSize 重构为一个属性，其支持保留在视图状态中，记住使用适当的默认值进行初始化。

更改 ItemsGet 子以改用该属性。

我的vb生锈了！

```
Public Property PageSize() As Integer
    Get
       If Me.ViewState("PageSize") Is Nothing Then
            Me.ViewState("PageSize") = 15
        End If

        Return CInt( Me.ViewState("PageSize") )      
    End Get
    Set
        Me.ViewState("PageSize") = value
    End Set
 End Property 
```

# jsf-2 - 更改查看范围的请求会导致 java.io.NotSerializableException: javax.faces.model.ListDataModel

> ID：12641017
> 
> 赞同：1
> 
> 时间：2012-09-28T13:31:37.990
> 
> 标签：jsf-2, primefaces

将 managedBean 的范围设置为 ViewScoped 时，出现以下错误。以下是我尝试调用页面时遇到的异常

```
javax.faces.FacesException: java.io.NotSerializableException: javax.faces.model.ListDataModel  
at com.sun.faces.renderkit.ResponseStateManagerImpl.getViewState(ResponseStateManagerImpl.java:137)  
at javax.faces.application.StateManager.getViewState(StateManager.java:555)  
at com.sun.faces.context.PartialViewContextImpl.renderState(PartialViewContextImpl.java:416)  
at com.sun.faces.context.PartialViewContextImpl.processPartial(PartialViewContextImpl.java:300)  
at javax.faces.context.PartialViewContextWrapper.processPartial(PartialViewContextWrapper.java:183)  
at javax.faces.component.UIViewRoot.encodeChildren(UIViewRoot.java:981)  
at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1756)  
at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:390)  
at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)  
at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)  
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)  
at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)  
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)  
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)  
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)  
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)  
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)  
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)  
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)  
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)  
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)  
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)  
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)  
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)  
at java.lang.Thread.run(Unknown Source)  
Caused by: java.io.NotSerializableException: javax.faces.model.ListDataModel  
at java.io.ObjectOutputStream.writeObject0(Unknown Source)  

Sep 26, 2012 4:01:13 PM org.apache.catalina.core.StandardWrapperValve invoke  
SEVERE: Servlet.service() for servlet Faces Servlet threw exception  
java.lang.IllegalStateException: CDATA tags may not nest  
at         com.sun.faces.renderkit.html_basic.HtmlResponseWriter.startCDATA(HtmlResponseWriter.java:630)  
at javax.faces.context.ResponseWriterWrapper.startCDATA(ResponseWriterWrapper.java:172)  
at javax.faces.context.PartialResponseWriter.startError(PartialResponseWriter.java:342)  
at org.primefaces.context.PrimePartialResponseWriter.startError(PrimePartialResponseWriter.java:210)  
at com.sun.faces.context.AjaxExceptionHandlerImpl.handlePartialResponseError(AjaxExceptionHandlerImpl.java:200)  
at com.sun.faces.context.AjaxExceptionHandlerImpl.handle(AjaxExceptionHandlerImpl.java:123)  
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:119) 
```

任何有关解决问题的指示或帮助都非常受欢迎。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T13:38:41.450

> java.io.NotSerializableException: javax.faces.model.ListDataModel

您的视图范围 bean 显然有一个`ListDataModel`属性。这确实是不可序列化的，因为它的状态是每个定义依赖于当前的 HTTP 请求（通常不会在任何地方保存/共享——这反过来又需要序列化）。

一个视图范围的 bean 跨越多个 HTTP 请求，并通过一个唯一的键存储 HTTP 会话。一些但不是所有的 servlet 容器将会话存储在硬盘上而不是内存上，这需要所有直接存储在会话中的 Java 对象来实现`Serializable`，包括视图范围的 bean 及其所有属性。

您可以通过 2 种方式解决此特定问题：

1.  标记属性`transient`，获取包装列表作为另一个属性，并在 getter 中使用延迟加载。

    ```
    private transient DataModel<Foo> model;
    private List<Foo> list;

    public DataModel<Foo> getModel() {
        if (model == null) {
            model = new ListDataModel<Foo>(list);
        }
        return model;
    } 
    ```

2.  不要使用`DataModel`，而是使用替代方法。一个常见的要求`DataModel`是在 JSF 1.x 中能够获取当前行。但从 EL 2.2 开始，您可以将其作为方法参数传递。另请参阅[如何将选定的行传递给 dataTable 中的 commandLink？](https://stackoverflow.com/questions/4994458/how-can-i-pass-selected-row-to-commandlink-inside-datatable)

# jquery - jQuery 对话框未从后续数据表页面打开

> ID：12641023
> 
> 赞同：0
> 
> 时间：2012-09-28T13:31:50.123
> 
> 标签：jquery, pagination, datatables

为我们的呼叫中心开发一个 MVC 3 应用程序，以显示保险单持有人的数据。

我有一个页面，其中包含在数据表中排序的保险索赔。表脚本是：

```
$('#claims').dataTable({
        "bProcessing": true,
        "bJQueryUI": true,
        "bPaginate": true,
        "bSort": false,
        "sPaginationType": "full_numbers",
        "sDom": '<"H"lrp>t<"F"ip>',
        "iDisplayLength": 10,
        "bAutoWidth": false,
        "oLanguage": { "sZeroRecords": "No claims found for this policy", 
                       "sProcessing": "<img src='../../../../Content/images/ajax-loader-bar.gif' />" },
        "aoColumns": [
            { "sName": "Claim #" },
            { "sName": "Status" },
            { "sName": "Clm Type" },
            { "sName": "Rider Form" },
            { "sName": "Primary DX" },
            { "sName": "Exam Code" },
            { "sName": "Asst Exam" },
            { "sName": "Case Mgr" },
            { "sName": "Follow Up Date" },
            { "sName": "Close/Deny Date" },
            { "sName": "Closed Reason" }
        ]

    }); 
```

其中一行包含一个按钮，该按钮可打开一个对话框窗口，其中包含有关该声明的详细信息。javascript是这样的：

```
$(function () {

        $('#ClaimsDetailDialog').dialog({
            autoOpen: false,
            width: 950,
            resizable: true,
            modal: true,
            position: ['center', 'top']
        });

        $('.claimmodal').on("click", function () {
            var url = $(this).attr('href');
            var claimnum = $(this).text();
            var policynum = $(this).attr('polnum');
            $('#ClaimsDetailDialog').html("<img src='../../../../Content/images/ajax-loader-bar.gif' />")
                .dialog("option", "title", "Claim Details for Claim #" + claimnum + " for Policy #" + policynum)
                .dialog("option", "buttons", {
                    Close: function () {
                        $(this).dialog("close");
                    }
                })
                .load(url).dialog("open");
            return false;
        });
    }); 
```

这工作正常，直到有超过 10 项针对保单的索赔。用户单击第二页后，单击索赔编号不再打开对话框，而是打开请求 URL 的窗口，没有 javascript 标记。

这是相关单元格的剃刀：

```
<td style="text-align: center">
    @Html.ActionLink(@item.Claimmast.CLMNO.ToString(), "ClaimDetail", null, new { id = item.Claimmast.ID }, new { @class = "claimmodal", polnum = item.Claimmast.POLICY }) 
</td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:37:00.807

您需要使用委托，因为您正在动态更改 dom..

```
$('#claims').on('click','.claimmodal',function(){
    // your code here
}); 
```

取决于您使用的 jQuery 版本

```
$(selector).live(events, data, handler);                // jQuery 1.3+
$(document).delegate(selector, events, data, handler);  // jQuery 1.4.3+
$(document).on(events, selector, data, handler);        // jQuery 1.7+ 
```

# android - 使用 doInBackground (AsyncTask) 时无法显示吐司

> ID：12641027
> 
> 赞同：2
> 
> 时间：2012-09-28T13:31:54.027
> 
> 标签：android, facebook, android-asynctask, toast

我正在尝试在 facebook 上发帖，所以我正在使用以下代码。它运作良好，但我似乎无法发布简单的确认祝酒词。

```
private class FacebookPoster extends AsyncTask<String, Object, Object>
    {

        @Override
        protected Object doInBackground(String... message)
        {
            Bundle parameters = new Bundle();
            parameters.putString("message", message[0]);
            parameters.putString("description", "topic share");
            parameters.putString("link", ctx.getResources().getString(R.string.rateLink));
            parameters.putString("picture", ctx.getResources().getString(R.string.linkIconPicture));
            Log.d("ERRRR", "set params");
            try
            {
                facebook.request("me");
                String response = facebook.request("me/feed", parameters, "POST");
                Log.d("Tests", "got response: " + response);
                if (response == null || response.equals("") || response.equals("false"))
                {
                    return "Blank response.";

                }
                else
                {
                    return "Message posted to your facebook wall!";

                }
            }
            catch (Exception e)
            {
                return "Failed to post to wall!";
            }
        }

        @Override
        protected void onProgressUpdate(Object... values)
        {
            // TODO Auto-generated method stub
            super.onProgressUpdate(values);
            showToast(values);

        }
    } 
```

showToast 函数

```
private void showToast(Object message)
    {
        Toast.makeText(ctx, message.toString(), Toast.LENGTH_SHORT).show();
    } 
```

我认为 onProgressUpdate 没有被调用。请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T13:35:35.303

`onProgressUpdate`用于更新进度条，例如当代码仍在运行时，您需要使用该方法调用`onProgressUpdate`手动。`publishProgress`

您在`doInBackground`方法中返回一个字符串（对象）。该字符串将被发送到该`onPostExecute`方法。

所以你应该做的是删除该`onProgressUpdate`方法，并覆盖该`onPostExecute`方法并将 Toast 代码放入其中。

**注意：** `onProgressUpdate` and`publishProgress`只能用于在后台任务仍在运行时更新进度，而不是用于显示最终结果。对于最终结果，您使用该`onPostExecute`方法。

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T13:34:28.607

当然 onProgressUpdate 没有被调用。

你必须在你的 doInBackground 中自己调用它：

```
publishProgress(<somenumber>); 
```

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T13:34:09.570

你需要`publishProgress()`在你的`doInBackground()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T13:36:20.733

覆盖该`onPostExecute()`方法并将调用移至`showToast()`该方法。

看起来您`onProgressUpdate()`根本没有被调用。在您的场景中，您宁愿在`doInBackground()`完成后举杯！

# python - 字典创建中的可选字典项

> ID：12641029
> 
> 赞同：2
> 
> 时间：2012-09-28T13:32:02.900
> 
> 标签：python, dictionary, key, conditional, key-value

我有一个返回字典的函数：

```
 def to_dict(self):
     return dict({'identification': self.identifier,
                  'information': self.information,
                  'nodes': {e.position: e.to_dict for e in self.children}
                  }) 
```

有没有办法选择性地添加每个 k/v？这不起作用，例如：

```
def to_dict(self):
         return dict({'identification': self.identifier,
                      'information': self.information,
                      'nodes': {e.position: e.to_dict for e in self.children} if self.children
                      }) 
```

有没有一种方法可以添加字典创建的可选部分，而不必为每个变体构建单独的字典；有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T13:34:01.777

将字典存储在本地，在返回之前使用您的额外信息对其进行更新：

```
def to_dict(self):
     retval = {'identification': self.identifier,
               'information': self.information,
              }
     if self.children:
         retval['nodes'] = {e.position: e.to_dict for e in self.children}
     return retval 
```

我在示例中删除了`dict()`构造函数，它完全是多余的。但是因为你所有的键也是有效的 python 标识符，你*可以*`dict()`通过使用构造函数和关键字参数以稍微更紧凑的方式定义你的 dict ：

```
def to_dict(self):
     retval = dict(identification=self.identifier,
                   information=self.information)
     if self.children:
         retval['nodes'] = {e.position: e.to_dict for e in self.children}
     return retval 
```

# shell - 如何在 shell 脚本中使用 if/else 语句

> ID：12641031
> 
> 赞同：3
> 
> 时间：2012-09-28T13:32:13.823
> 
> 标签：shell

使用 if/else 语句时，我收到一个简单脚本错误。
编码：

```
#!/bin/sh
count=100
if [$count > 3]; then
echo "Test IF"
fi 
```

错误：/bin/ash：第 6 行：[100：未找到

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T13:35:13.937

```
#!/bin/sh 

count=100;
if [ "$count" -gt 3 ]; then
  echo "Test IF";
fi 
```

`[`更正您的语法：必须在and周围使用空格`]`，必须引用参数扩展，并且`-gt`适用于`[ ]`. `>`in sh 用作重定向运算符；如果你想在算术比较中使用它，你必须使用 bash-only 语法

```
$(( $count > 3 )) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T12:44:28.353

```
#!/bin/sh 

if [ $var -eq 12 ]; then 
    echo "This is a numeric comparison if example"
fi

if [ "$var" = "12" ]; then
    echo "This is a string if comparison example"
fi

if [[ "$var" = *12* ]]; then
    echo "This is a string regular expression if comparison example"
fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-07T09:18:14.637

这也行！

```
#!/bin/sh
count=100
if [ $count -gt 3 ];
then
    echo "Test IF"
fi 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T13:42:26.050

shell 中的 if 语句使用命令 [. 由于 [ 是一个命令（您也可以使用“测试”），因此在写入要测试的条件之前需要一个空格。要查看条件列表，请键入： man test

您将在手册页中看到：

`s1 > s2`测试字符串 s1 是否在字符串 s2 之后

`n1 gt n2`测试整数 n1 是否大于 n2

在您的情况下，使用 > 会起作用，因为字符串 100 在字符串 3 之后，但这样写更合乎逻辑

```
if [ $count -gt 3 ]; then
   echo "test if"
fi 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-09-17T11:57:16.680

```
if [[ "$x" == "true" ]]; then

  echo "value matched"

else

 echo "value doesn't matched"

fi 
```

# rotation - 我需要某种绘画环境来旋转图像

> ID：12641032
> 
> 赞同：-1
> 
> 时间：2012-09-28T13:32:14.823
> 
> 标签：rotation, paint, environment, image-rotation, paint.net

最近我下载了paint.net。它可以在各个角度旋转图像。
我需要 360 张图片，每张图片都旋转不同的角度，并带有适当的文件名（1.jpg、2.jpg 等）。问题是 - 在paint.net 上，我必须手动旋转它 360 次，这将花费我永远。

是否有任何环境可以按照我想要的方式旋转图像？我需要这个，因为我想将 360 度图像加载到 C++ 中的游戏中，这就是我将如何旋转图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:14:52.990

如果你是为游戏做的，为什么不编写自己的程序来为你做呢？它是最简单的方法。

例如检查这个简单的 python 脚本：

```
# Make sure to install PIL after your regular python package is installed

import Image

image = Image.open("yourpicture.jpg")
for (a in range(360)):
     image2 = image.rotate(a)
     image2.save(str(a) + "jpg")
     del image2 
```

paint.net 中没有这样的工具，但您可以尝试编写自己的插件（查看 CodeLab 插件）。

# mysql - 如何从mysql中选择字段的增量

> ID：12641035
> 
> 赞同：0
> 
> 时间：2012-09-28T13:32:29.563
> 
> 标签：mysql, sql

我有一张表格，记录了一些网页每天的累计总访问量。我想获取所有这些页面在特定日期的真实访问次数。桌子就像

```
- record_id   page_id     date     addup_number
 - 1             1        2012-9-20     2110
 - 2             2        2012-9-20     1160
 - ...          ...          ...         ...
 - n             1        2012-9-21     2543
 - n+1           2        2012-9-21     1784 
```

我想获取的结果是：

```
 - page_id      date        increment_num(the real visit numbers on this date)
 - 1           2012-9-21      X
 - 2           2012-9-21      X
 - ...           ...         ...
 - N           2012-9-21      X 
```

但我不想在 php 中执行此操作，因为它很耗时。我能用 SQL 指令或一些 mysql 函数得到我想要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:39:12.507

行。您需要通过加入`date`列并在联接的一侧添加一天来加入表本身。

假设：

1.  `date`列是合法`DATE`类型而不是字符串
2.  每一天都占到每一页（没有间隙）
3.  addup_number 是`INT`某种类型的 ( `BIGINT`, `INT`, `SMALLINT`, 等...)
4.  table_name 替换您未指明的实际表名
5.  每页每天只有一条记录...即没有页面在同一天有多次计数

你可以这样做：

```
SELECT t2.page_id, t2.date, t2.addup_number - t1.addup_number AS  increment_num
  FROM table_name t1
  JOIN table_name t2 ON t1.date + INTERVAL 1 DAY = t2.date
  WHERE  t1.page_id = t2.page_id 
```

需要注意的一件事是，如果这是一个巨大的表并且`date`是一个索引列，那么您将不得不通过在子句中添加一天来转换它，从而在连接中受到影响`ON`，但您将获得您的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:36:58.783

更新：

```
SELECT today.page_id, today.date, (today.addup_number - yesterday.addup_number) as increment
 FROM myvisits_table today, myvisits_table yesterday
WHERE today.page_id = yesterday.page_id
    AND today.date='2012-9-21'
    AND yesterday.date='2012-9-20'
GROUP BY today.page_id, today.date, yesterday.page_id, yesterday.date
ORDER BY page_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T13:38:35.537

像这样的东西：

```
SELECT date, SUM(addup_number) 
FROM your_table 
GROUP BY date 
```

# objective-c - 保持文本相同，同时保留特殊字符

> ID：12641036
> 
> 赞同：2
> 
> 时间：2012-09-28T13:32:33.900
> 
> 标签：objective-c

我有一个包含行尾的文本；我想将该文本引入 NSString 并仍然识别行尾。

即我不想在每一行的末尾放置一个“\n”。

我怎么能在 Obj-c 中这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:41:53.160

我认为最好使用 来保存文本`NSArray`，其中的每个元素都是单独的一行。您可以使用`[NSString componentsSeparatedByCharactersInSet:]`（[参考](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/componentsSeparatedByCharactersInSet%3a)）：

```
NSString *str = @"hello\nworld";
NSArray *lines = [str componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]; 
```

# c++ - 从 ProtoBuf 重复字段中获取所有元素的最有效方法是什么？

> ID：12641039
> 
> 赞同：5
> 
> 时间：2012-09-28T13:32:34.523
> 
> 标签：c++, arrays, protocol-buffers

我已经使用 Google 的 Protcol 缓冲区将一组浮点数序列化为[RepeatedField 。](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.repeated_field)

在反序列化数据时，我使用另一个设置类以更适合我的游戏类的形式保存信息。静态`CreateFrom`方法提取和转换数据。

```
class VoxelTerrainSettings
{
public:
    std::vector<int> indices;
    btAlignedObjectArray<btVector3> vertices;

    VoxelTerrainSettings(void);
    ~VoxelTerrainSettings(void);

    static VoxelTerrainSettings CreateFrom(const VoxelTerrainProtoBuf::VoxelTerrainSettings &settings)
    {
        VoxelTerrainSettings s;

        int numIndices = settings.indices().size();

        s.indices.reserve(numIndices);

        for (int i = 0; i < numIndices; ++i)
        {
            s.indices.push_back(settings.indices().Get(i));
        }

        int numVertices = settings.vertices().size();

        s.vertices.reserve(numVertices);

        int v = 0;

        for (int i = 0; i < numVertices; ++i)
        {
            s.vertices.push_back(btVector3(settings.vertices().Get(v++), settings.vertices().Get(v++), settings.vertices().Get(v++)));
        }

        return s;
    }

    //VoxelTerrain Load();
}; 
```

但是，当前从 RepeatedField 中提取所有元素的方法似乎不是很优雅。

我尝试采用更有效的方法，但它们都抛出了超出范围的错误。

```
std::copy(settings.vertices().begin(), settings.vertices().end(), vv.begin());
std::copy(&settings.vertices().Get(0), &settings.vertices().Get(settings.vertices().size() - 1), &vv[0]); 
```

我可以使用哪些方法来提高元素提取效率？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T07:00:27.577

std::copy 使用 std::front_inserter/std::back_inserter 迭代器类型将值插入容器尝试以下操作：

```
// inserting into list/deque
std::copy(settings.vertices().begin(), settings.vertices().end(), std::front_inserter(vv));
// inserting into vector
std::copy(settings.vertices().begin(), settings.vertices().end(), std::back_inserter(vv)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-26T15:05:43.243

最快的是预先预留空间，然后在一个循环中变换[优化缓存](https://stackoverflow.com/q/763262/145173)。

```
s.indices.reserve(settings.indices().size());
s.vertices.reserve(settings.vertices().size());

for (auto& vertex : settings.vertices()) {
   s.indicies.push_back(...);
   s.verticies.push_back(...);
} 
```

# gradle - 这是一个 gradle eclipse 任务错误还是故意不一致？

> ID：12641049
> 
> 赞同：0
> 
> 时间：2012-09-28T13:33:28.810
> 
> 标签：gradle

所以我在gradle中有以下依赖部分

```
dependencies {    
    compile project(':sdi-master')
    compile fileTree(dir: '../webserver/lib', include: '*.jar')
    compile fileTree(dir: '../webserver/play-1.2.4/framework/lib', include: '*.jar')
    compile fileTree(dir: '../webserver/play-1.2.4/framework', include: 'play-*.jar')   
} 
```

我也有一个像这样的复制罐子任务

```
task deleteJars(type: Delete) {
    ext.collection = files { genLibDir.listFiles() }
    delete ext.collection
}
task copyJars(type: Copy) { 
    from(configurations.compile) {}
    into genLibDir
}
copyJars.dependsOn('deleteJars')
classes.dependsOn('copyJars') 
```

注意它是如何依赖于 sdi-master 的，然后它也有一个编译文件树。当我运行 copyJars 时，正如预期的那样，我从 sdi-master 获取所有 jars 并复制到 genLibDir 中。但是，当我运行 eclipse 任务时，这些 jar 不会像我预期的那样显示在 .classpath 文件中，因此我的项目不会在 eclipse 中编译。

这是我需要报告的 gradle eclipse 任务错误还是应该是这种行为（尽管它似乎与使用configurations.compile 的复制jar 非常不一致。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T18:12:23.957

Eclipse 理解传递依赖，因此 的依赖`sdi-master`不会（也不应该）显示在当前项目的`.classpath`文件中。它们应该只出现在`sdi-master`'s 的`.classpath`文件中并且应该被标记在`exported`那里。

# ios - iOS 错误：[__NSArrayI objectAtIndex:]：索引 1 超出范围 [0 .. 0]

> ID：12641051
> 
> 赞同：2
> 
> 时间：2012-09-28T13:33:36.427
> 
> 标签：ios, uitableview, nsmutablearray, indexoutofboundsexception

在我的应用程序中，我尝试从 url 加载内容，将它们存储在可变数组中并在表格视图中显示它们。但我无法让它工作，因为每次我运行应用程序时都会出现这个错误：

```
*** Terminating app due to uncaught exception 'NSRangeException', 
reason: '*** -[__NSArrayI objectAtIndex:]: index 1 beyond bounds [0 .. 0]'
*** First throw call stack:
(0x34dd088f 0x36d9e259 0x34d2823d 0x316e562f 0x315f09a9 0x313c0c5d 0x313c1b95 0x313c1ae7
 0x313c16c3 0xa5cfb 0x33623ec7 0x35387a09 0x35390051 0x33622965 0xa4dc1 0x313a8e33 
 0x313cd629 0x31391d7d 0x314544dd 0x3139a55d 0x3139a579 0x3139a40b 0x3139a3e7 0x313a8015 
 0x313a1985 0x3136fc6b 0x3136f70f 0x3136f0e3 0x3439222b 0x34da4523 0x34da44c5 0x34da3313 
 0x34d264a5 0x34d2636d 0x313a0a13 0x3139de7d 0xa4745 0xa46dc)
terminate called throwing an exception 
```

我创建了应该在我的 viewDidLoad 中填充表的数组：

```
_videos = [[NSMutableArray alloc] init]; 
```

然后我连接到 url 并解析接收到的 xml 数据。这就像它应该的那样工作。当打开某个标签时，我创建了我的视频对象，并在用数据填充它们后，我将这些对象添加到我的数组中：

```
[_videos addObject:currentVideo]; 
```

这似乎也有效，因为它返回正确数量的视频

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

    return _videos.count;
} 
```

叫做。但在此之后，应用程序崩溃了，我什至没有达到尝试填充表格视图的地步。该函数如下所示：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    Video *curVideo = [_videos objectAtIndex:indexPath.row];

    static NSString *CellIdentifier = @"CustomCell";

    CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil)        
        cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

    cell.titleLabel.text = [curVideo title];
    cell.descLabel.text = [curVideo desc];

    return cell;
} 
```

做错了什么？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-03T22:56:01.423

`-[__NSArrayI objectAtIndex:]: index 4 beyond bounds [0 .. 1]'`当我试图展示一个模态故事板时，我有相同的错误签名，表格视图有两个（从五个更新）静态表格单元格部分。直到我删除了视图中不再需要的三个表格单元格部分后，才出现此错误。在详细检查了模态演示之前的所有 objectAtIndex 引用两天后，我决定查看 UITableViewController 子类代码本身。我找到了这个：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
//#warning Potentially incomplete method implementation.
    // Return the number of sections.
    return 5;
} 
```

然后灯泡熄灭了。被引用的`index 4`部分与我的表格视图部分的数量和`[0 .. 1]`引用我当前的两个表格单元部分的边界有关。更新该`return`值以匹配 Storyboard 表格视图中当前表格单元格部分的数量解决了该问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T13:41:44.587

您可能`_videos`在初始化之前访问的某个地方。很可能您会在 之后`init`，但在加载视图之前执行此操作。解决此类问题的方法是独占使用访问器，并延迟初始化`self.videos`。这是从不直接访问您的 ivars 的众多原因之一，除了 in`init`和`dealloc`.

```
@interface ...
@property (nonatomic, readonly, strong) NSMutableArray *videos;
@end

@implementation ...
{
  NSMutableArray *_videos; // Can't auto-synthesize. We override the only accessor.
}

- (NSMutableArray *)videos {
   if (! _videos) {
     _videos = [NSMutableArray new];
   }
   return _videos;
} 
```

`self.videos`现在，无论何时发生，所有对的引用都将被初始化。

您还可以在 中正确初始化视频`init`，这需要更少的代码：

```
@interface ...
@property (nonatomic, readonly, strong) NSMutableArray *videos;
@end

@implementation ...

- (id)init {
   self = [super init];
   if (self) {
     _videos = [NSMutableArray new];
   }
   return self;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-18T13:06:23.687

我已经为这样的图像数组传递了虚拟图像名称，

```
arrImages = [NSArray arrayWithObjects:[UIImage imageNamed:@"some.png"] 
```

上面的行引起了我的错误。所以我用@“category.png”之类的现有图像更改了@“some.png”。

这对我有用。确保您从包中传递了正确的图像名称。

# java - 任何建议为什么我的正则表达式不起作用？

> ID：12641054
> 
> 赞同：3
> 
> 时间：2012-09-28T13:33:38.983
> 
> 标签：java, regex

我得到以下字符串以从中提取一些信息：

```
String: String: String Number; 
```

现在我正在使用以下正则表达式来获取参数：

```
(.*?):(.*?):(.*?);$ 
```

这样，我将使用 Matcher 获得以下输出：

```
group(1) = String
group(2) = String
group(3) = String Number 
```

如果我想要数字，我需要在第三组的输出上执行另一个正则表达式，如下所示：

```
([a-zA-Z]* ?([0-9])?$) 
```

在字符串上使用`String Number`这会给我和输出像

```
group(1) = String
group(2) = Number 
```

我考虑过结合这两个步骤并`(.*?):(.*?):([a-zA-Z]* ?([0-9])?);$`在`String: String: String Number;`-String 上使用正则表达式。但这不起作用，我看不出原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T13:38:53.247

你去的时候，我添加了一些额外的空格匹配，但这似乎有效，你错过了第二个 : 和以下字符串之间的空格

```
 ^(.*?):\s*(.*?):\s*([a-zA-Z]*\s+([0-9])?);$ 
```

# google-maps - 在directionsService.route 之后更改缩放？

> ID：12641056
> 
> 赞同：4
> 
> 时间：2012-09-28T13:33:41.763
> 
> 标签：google-maps

我的代码：

```
directionsService.route(request, function (response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay.setDirections(response);

        map.setZoom(2);
    }
}); 
```

但 setZoom(2) 不起作用。似乎这`.setDirections`是异步的。追踪路线后无法设置缩放？

也尝试过：

```
google.maps.event.addListener(directionsDisplay, 'directions_changed', function () {
    map.setZoom(2);
}); 
```

但是地图不会缩放...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T13:42:11.573

DirectionsService 不会更改缩放，DirectionsDisplay（AKA DirectionsRenderer）会。

DirectionsRenderer 有一个选项**preserveViewport**，如果包含该选项并将其设置为 true，将阻止它更改地图的缩放（和中心）。

如果要根据方向服务的结果设置中心，请参阅我对这个类似问题的回答：

[谷歌地图缩放后的方向](https://stackoverflow.com/questions/12640190/google-map-zoom-after-directions/12640649#12640649)

如果您想要 DirectionsRenderer 设置的中心，请使用 DirectionsResult 的边界。

您还可以侦听 Directions_changed 事件，并在它触发时设置缩放，不确定这是否有效。

[文档中使用 zoom_changed 事件的示例](https://google-developers.appspot.com/maps/documentation/javascript/examples/rectangle-simple)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-08T10:15:33.650

您可以使用[getMap()](https://developers.google.com/maps/documentation/javascript/reference/3/directions)方法，然后像这样在地图对象上设置缩放

`var map = directionsDisplay.getMap(); directionsDisplay.setDirections(response); map.setZoom(12);`

为我工作！

# powershell - 巡航控制和 Powershell

> ID：12641057
> 
> 赞同：2
> 
> 时间：2012-09-28T13:33:52.863
> 
> 标签：powershell, cruisecontrol

这是我第一次使用巡航控制，所以也许我没有正确理解它。我想启动一个大型 PowerShell 脚本，用于构建一些 VM 映像。如果我可以通过巡航控制系统查看它，那将是非常酷的。我已经用谷歌搜索了这些东西，我发现了这样的东西：http: [//qaquestions.wordpress.com/2011/03/18/cruisecontrol-net-powershell-tasks/](http://qaquestions.wordpress.com/2011/03/18/cruisecontrol-net-powershell-tasks/) 但现在：我到底把这些xml语句放在哪里？我想，我必须在 CC config.xml 中创建一个新的项目标签并指定脚本和位置。但是当我启动队列时，它说，powershell 是一个未知插件，但我有 CC 2.5+ 并且 PS 应该从 1.5 开始支持。我只是不太确定，该怎么办：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T18:44:31.993

这是在 Cruise Control .NET 中运行 powershell 任务所需的绝对最小项目定义。我认为它在巡航控制中可能相当相似。

```
<project name="Run some powershell scripts">
    <tasks>
        <powershell>
            <scriptsDirectory>path to scripts folder</scriptsDirectory>
            <script>script to run</script>
        </powershell>
    </tasks>
</project> 
```

将此项目定义放在您的配置文件中（Cruise Control .NET 的 ccnet.config）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T13:07:18.940

您提到的博客中还有一些文章[http://qaquestions.wordpress.com/category/ci/cruise-control-net-ci/](http://qaquestions.wordpress.com/category/ci/cruise-control-net-ci/)总体参考使用文档[http://cruisecontrol.sourceforge.net/main/configxml。 html](http://cruisecontrol.sourceforge.net/main/configxml.html)

# android - 服务和关键事件

> ID：12641060
> 
> 赞同：0
> 
> 时间：2012-09-28T13:33:57.733
> 
> 标签：android, android-intent

当我的应用程序在后台运行时需要一个 keylistener。知道 KeyEvents 只能由活动处理，最好的方法是什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:12:31.613

幸运的是，出于明显的隐私和安全原因，这通常是不可能的。除非您是前台活动，否则您无权了解用户输入的内容。

一些按钮如果它们的事件没有被前台活动消费，就会发出广播，例如 CAMERA 按钮。

# javascript - 使用 javascript 从 html 表单中获取选定的标签名称

> ID：12641061
> 
> 赞同：0
> 
> 时间：2012-09-28T13:33:58.197
> 
> 标签：javascript

我想问是否有办法从表单中获取当前选定的标签名称。为了更清楚，请看下面的示例。

```
<form name='get_state'  id="catalog" action='post.php' method='POST' >
 <select name='plateDescr' onchange="window.loadStates()"></select>
 <select id="matType"  name="matType" onchange="window.loadStates()" hidden="hidden"></select>
</form> 
```

例如，如果当前选择了名称为“plateDescr”的选择标签，我想得到这个值“plateDescr”。有没有这样做。提前致谢！

# foundation - NSBundle 是否在启动时缓存它的所有内容？

> ID：12641063
> 
> 赞同：1
> 
> 时间：2012-09-28T13:33:59.613
> 
> 标签：foundation, nsbundle

我在检索我在访问之前写入捆绑的文件时遇到了问题。（实际上我在所有应用程序启动期间都无法访问它）。但重启后，同样的方法找到了我在第一次应用启动时写的文件。

所以最后我找到了一个解决方案，但我不确定我是否真正理解 bundle 是如何工作
的（我的文件是`menu.xml`，我把它写在 bundle 的根目录中（到 resourcePath））

起初我使用的实例方法在第一次启动时不起作用。但第二次发现。[`- pathForResource:ofType:`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSBundle_Class/Reference/Reference.html#//apple_ref/occ/instm/NSBundle/pathForResource:ofType:)

比我试过[`+ pathForResource:ofType:inDirectory:`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSBundle_Class/Reference/Reference.html#//apple_ref/occ/clm/NSBundle/pathForResource:ofType:inDirectory:)的。它两次都有效。

所以问题是：
NSBundle 是否缓存了一些东西？或者为什么实例方法在重新启动之前第一次不起作用？如果您对调查有一些想法，我会很高兴听到他们的意见。

# jquery - 了解 AJAX POST 请求的跨域差异

> ID：12641069
> 
> 赞同：0
> 
> 时间：2012-09-28T13:34:35.010
> 
> 标签：jquery, ajax, post

我在[http://example.com](http://example.com)中编写了一段 jQuery 代码。

代码如下所示：

```
$.post('http://example.com:3000/service',params,function(data){}); 
```

此代码在 chrome 和 firefox 中有效，但**在****IE**中无效。我的请求是跨浏览器吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:43:22.447

[带有 jQ​​uery 的 JSONP](https://stackoverflow.com/questions/2681466/jsonp-with-jquery)

我认为您正在寻找 JSONP - 请查看该链接以获取示例

# mongodb - 是否可以在 MongoDB 中迭代 mapReduce

> ID：12641070
> 
> 赞同：1
> 
> 时间：2012-09-28T13:34:39.860
> 
> 标签：mongodb, mapreduce, aggregation-framework

我在 MongoDB 中使用 mapReduce 为来自他/她的朋友网络的用户生成趋势歌曲。所以我遍历所有用户并检查 user_id 是否存在于他们的朋友数组中，如果存在我发出他们的歌曲然后合并整个发出的歌曲以找到他所有朋友网络的热门歌曲。

问题是我需要遍历所有用户以找到集合中每个用户的（网络趋势歌曲）。我怎样才能做到这一点，有没有像嵌套 mapReduce 这样的方法。还是我必须从应用程序层进行迭代，例如通过 for 循环执行 mapReduce！

我当前使用的 mapReduce 是这个：

```
var map = function() {
users = [];
songs = [];
    if(this.value.friends !== undefined && this.value.friends.length !== 0 && this.value.songs !== undefined && this.value.songs.length !== 0){
        key = this._id.user_id;
        for(var x=0; x<this.value.songs.length; x++)
            emit({user_id:user_id,song_id:this.value.songs[x][0]},{played:this.value.songs[x][1], counter:1});
    }
};
var reduce = function(key, values) {
    var counter = 0;
    var played = 0;
    values.forEach(function(val){
        counter += val.counter;
        played += val.played;
    });
    return {played : played, counter : counter};
};
db.runCommand({"mapreduce":"trending_users", "map":map, "reduce":reduce, "scope":{user_id: "111222333444"} ,"query":{'value.friends':{$in : ['111222333444'] }},'out':{merge:'trending_user_network'}})    
db.trending_user_network.find({'_id.user_id':'111222333444'}).sort({'value.counter':-1, 'value.played':-1}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:11:48.267

您当然可以在应用程序中使用 for 循环来循环遍历用户 ID 并为每个用户 ID 运行 map reduce。但是，对于这样的事情，您可能会更幸运地使用[聚合框架](http://docs.mongodb.org/manual/applications/aggregation/)来创建聚合操作的管道来一次完成所有操作。

我不知道您的架构的确切细节，但我认为您可以按照以下方式构建一个聚合管道：

*   `$unwind`获取映射到他们朋友的用户 ID 的用户的平面列表
*   `$unwind`再次将朋友的用户 ID 映射到他们的歌曲列表
*   `$group`获取结果列表中每首歌曲的聚合
*   `$sort`把结果整理好

实际上，您的管道可能需要更多步骤，但我认为如果您从聚合而不是 map-reduce 的角度来看待这个问题，它会更容易。

# php - 字母数字数组排序（CAVEAT：空格作为数字中的千位分隔符）

> ID：12641077
> 
> 赞同：2
> 
> 时间：2012-09-28T13:35:30.407
> 
> 标签：php, sorting

怎么做。例如我们有一个数组：

```
array(
    0 => 'Regular 1 000',
    1 => 'Regular 500',
    2 => 'Regular 2 000',
    3 => 'Big',
    4 => 'Regular 1 000 000',
    5 => 'Regular 50 000'
) 
```

我需要按以下顺序放置它们：

```
array(
    3 => 'Big',
    1 => 'Regular 500',
    0 => 'Regular 1 000',
    2 => 'Regular 2 000',
    5 => 'Regular 50 000',
    4 => 'Regular 1 000 000'
 ) 
```

而且我需要维护索引关联。看来我需要使用`uasort`. 任何人都可以向我建议一个用于该 `callable ( $cmp_function )`值的函数吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T14:39:52.967

~~这仅适用于您的数组的数字部分，但我仍然试图将我的头脑围绕在杂耍数组上以进行字母排序。如果有人可以添加它，请随时更新。~~
如果可能，您可能想尝试更改格式，因为这很*头疼*。

```
$x = array(
    'Regular 1 000',
    'Regular 500',
    'Regular 2 000',
    'Big',
    'Regular 1 000 000',
    'Regular 50 000'
); 
```

给出：

**编辑：**尤里卡！

```
$x = array(
    'A 100', // extra for testing
    'Regular 1 000',
    'Regular 500',
    'Regular 2 000',
    'Big',
    'Regular 1 000 000',
    'Regular 50 000'
);

function cus_sort($a, $b) { // you can also just do $x = function ($a, $b) {}
    $tmp_a = array(); $tmp_b = array(); // temp storage
    $tmp_a = explode(" ", $a, 2);
    if (@$tmp_a[1]) { // tmp_a exists (suppress invalid offset error if not)
        $a_numeric = (int)preg_replace("/[^0-9]/", '', $tmp_a[1]);
        // remove all non-numerical (...should add hyphens if needed...)
    } else {
        $a_numeric = false; // text only.
    }
    // else make sure that it evaluates false when we check.
    $tmp_b = explode(" ", $b, 2); // split into maximum 2 parts at first space.
    if (@$tmp_b[1]) { // tmp_b exists (suppress invalid offset error if not)
        $b_numeric = (int)preg_replace("/[^0-9]/", '', $tmp_b[1]);
    } else {
        $b_numeric = false; 
    }
    // onwards to sorting
    if ($tmp_a[0] == $tmp_b[0]) { //alphabetical parts are the same.
    // numerical sort
        if (($a_numeric > $b_numeric) || (!$b_numeric)) {
            return 1;
        } elseif (($a_numeric < $b_numeric) || (!$a_numeric)) {
            return -1;
        } else {
            return 0;
        }
    } else {
        // alpha sort
        $compare = strcasecmp($tmp_a[0], $tmp_b[0]);
        // see note below
        if ($compare > 0) {
            return 1;
        } elseif ($compare < 0) {
            return -1;
        } else {
            return 0;
        }
    }
}

uasort($x, "cus_sort"); 
```

注意：`strcasecmp(string $a, string $b)`是一种[不区分大小写](http://php.net/manual/en/function.strcasecmp.php)的数字方式来检查是否按顺序。

`print_r`返回：

```
Array
(
    [0] => A 100
    [4] => Big
    [2] => Regular 500
    [1] => Regular 1 000
    [3] => Regular 2 000
    [6] => Regular 50 000
    [5] => Regular 1 000 000
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:47:49.263

试试这个代码

```
$sorted_arr = array_map(
  function ($str) {
    preg_match('/[a-zA-Z]*\s*((\d+\s*)*)/', $str, $matches);
    return (int) str_replace(' ', '', $matches[1]);
  }, $arr
);
asort($sorted_arr, SORT_NUMERIC);
foreach ($sorted_arr as $key=>$value)
  $sorted_arr[$key] = $arr[$key];
print_r($sorted_arr); 
```

# java - 无法更新输入字段值

> ID：12641080
> 
> 赞同：0
> 
> 时间：2012-09-28T13:35:35.010
> 
> 标签：java, jsf-2, javabeans, oracle-adf

大家好，我的 jsf 页面上有一个**输入字段**，其值设置为 setter getter **dSecurityGroup**

```
public void setDSecurityGroup(String dSecurityGroup) {
    this.dSecurityGroup = dSecurityGroup;
}

public String getDSecurityGroup() throws IdcClientException, IOException {

    Map<String,String> mapValue=getDocumentPropertiesSystem();
    dSecurityGroup=mapValue.get("dSecurityGroup");
    return dSecurityGroup;
} 
```

第一次我从 getter 获取值并将其显示给用户时，我的表单上有一个**更新**按钮，单击该按钮我正在检索要更新的输入字段值，但是当我更新输入字段值并单击时更新按钮，它采用以前的值并将输入字段值更改为**旧**值。我怎样才能得到改变的价值..？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T18:00:01.250

你的代码对我来说看起来不对。你总是回来

```
dSecurityGroup=mapValue.get("dSecurityGroup"); 
```

所以只要 Thr 映射值没有改变，你就会看到这样的值。

# php - 从维基百科抓取信息

> ID：12641083
> 
> 赞同：0
> 
> 时间：2012-09-28T13:35:53.740
> 
> 标签：php, html, web-scraping, wikipedia, yql

> **可能重复：**
> [强大、成熟的 PHP 的 HTML 解析器](https://stackoverflow.com/questions/292926/robust-mature-html-parser-for-php)
> [如何使用 wikipedia api（如果存在）？](https://stackoverflow.com/questions/964454/how-to-use-wikipedia-api-if-it-exists)

我正在使用 YQL 从 Wikipedia 获取信息并将其存储在我的私有数据库中。例如，我正在抓取[此](http://en.wikipedia.org/wiki/Rajinikanth_filmography)页面。我需要页面中的所有电影名称。我正在使用这段代码：

HTML：

```
$.YQL("select * from html where url='http://en.wikipedia.org/wiki/Rajinikanth_filmography' and xpath='/html/body/div[3]/div[3]/div[4]/table'", function (data) {
            var str = data.query.results.table.tr;
            console.log(str);
            $.ajax({
                type: "POST",
                url: "db.php",
                data: {
                    sendingStr: str
                },
                success: function(data){
                    console.log(data);
                }
            });
        }); 
```

PHP：

```
$recv = $_POST['sendingStr'];
$arraySize = count($recv);
for ($i=1; $i < $arraySize; $i++) {
    foreach ($recv[$i]["td"][1] as $value) {
        foreach ($value as $val) {
            if(strlen($val["content"]) >= 3)
            {

                echo $val["content"] . "\n";

            }

        }
    }
} 
```

这是我的问题 - 如果您在页面中注意到，表中的每一行都有几个行跨度。但是当我废弃它时，我只能从每一行中获得第一个值。我应该在我的代码中进行哪些更改以便获得所有值？

# javascript - 内部函数没有正确的引用。我明白为什么，但我不知道 JS 来重做它，所以它可以正常工作

> ID：12641087
> 
> 赞同：0
> 
> 时间：2012-09-28T13:36:17.953
> 
> 标签：javascript, jquery, function

我正在创建一个这样的函数数组。数组中的**url**是正确的，但是当我最终循环遍历数组列表中的这些信息时...... **x[1]**处的函数引用了存储到**url**中的最后一个值，同时**x[0]**是正确的。有没有办法调整内部*url*以匹配**x[0]**？我正在考虑为 anon-function 设置一个参数，但我不确定这是否会起作用。我也不确定我是否可以在数据树上工作，就像 function.parent[0] 引用函数的父级并调用元素 0。我猜最后一个想法是用 DOM 逻辑方式思考。

```
var newArray = new Array();
    for(var i=0;i<fileUrls.length;++i) {
        var url = fileUrls[i];
        var x = [];//new Array();
        x = [url,
            function(){
                displayFile(url, 'image', null, ft_id, null, null, null, null, !MA.isiOS());
            }, 
            function(e){
                if(DEBUG) console.log('Error creating gallery thumbnail');
                alert('There was a problem creating a thumbnail');
                MA.hideMessage();
            }
        ];
        newArray.push(x);
    }
   pollingThrottler(2,newArray, function(a,b,c){ 
            //alert(a+"\n-----\n"+b+"\n-----\n"+c);
            //alert(bentleyPlugins.createThumbnailForPath(a,b,c));
            //alert(a);
                            //a does not reference the correct item.
            createThumbnailForPath(a,b,c);
            return;
        },function(){
            alert("success!");
        }); 
```

**是实际的代码。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:39:42.910

您需要为数组元素创建一个生成器函数，如下所示：

```
function genElement( url ) {
 return [url,
  function(){
    displayFile(url, 'image', null, ft_id, null, null, null, null, !MA.isiOS());
  }, 
  function(e){
    if(DEBUG) console.log('Error creating gallery thumbnail');
    alert('There was a problem creating a thumbnail');
    MA.hideMessage();
  }
 ];
}    
arrayList.push( genElement( myUrl ) ); 
```

基本上，您的代码中发生的情况是，所有函数元素都将引用同一个`url`变量，该变量会在循环过程中更改其值。

当您使用生成器函数时，将在调用生成器函数时生成 url 的副本。这导致每个元素都有其“自己的” url 变量来引用。

**编辑**

但是，为了易于阅读代码和性能，我建议@dystroy 的答案，因为在我看来这是做这些事情的更好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:40:10.227

您不应该使用数组，而是使用面向对象的 javascript：

```
function Thing(url) {
    this.url = url;
}
Thing.prototype.display = function(){
 displayFile(this.url, 'image', null, ft_id, null, null, null, null, !MA.isiOS());
};
Thing.prototype.doSomething = function(){
   if(DEBUG) console.log('Error creating gallery thumbnail');
    alert('There was a problem creating a thumbnail');
    MA.hideMessage();
}; 
```

然后你可以打电话

```
arrayList.push(new Thing(url)); 
```

然后`x.display()`将使用正确的网址。

[这是一本关于 javascript 中 OOP 的实用读物。](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Inheritance_and_the_prototype_chain)

编辑 ：

这是获取所需数组/对象的补充方法：

```
Thing.prototype.asArray = function(){
   var _this = this;
   return [this.url, function(){_this.display()}, this.doSomething];
} 
```

但它开始不太清楚......

# c++ - 限制#define 标签的范围

> ID：12641091
> 
> 赞同：12
> 
> 时间：2012-09-28T13:36:33.893
> 
> 标签：c++, c, scope, include, c-preprocessor

限制`#define`标签范围和避免无根据的令牌冲突的正确策略是什么？

在以下配置中：

**主程序**

```
# include "Utility_1.h"
# include "Utility_2.h"
# include "Utility_3.h"
VOID Main() { ... } 
```

**实用程序_1.h**

```
# define ZERO "Zero"
# define ONE  "One"
BOOL Utility_1(); // Uses- ZERO:"Zero" & ONE:"One" 
```

**Utility_2.h**

```
# define ZERO '0'
# define ONE  '1'
BOOL Utility_2(); // Uses- ZERO:'0' & ONE:'1' 
```

**Utility_3.h**

```
const UINT ZERO = 0;
const UINT ONE = 1;
BOOL Utility_3(); // Uses- ZERO:0 & ONE:1 
```

*注：* `Utility _1` ,`Utility_2`和`Utility_3`已独立编写

* * *

> 错误：宏重定义和令牌冲突
> 另外，**最担心的是：**编译器没有指出替换令牌的情况是什么

{Edit}**注意：这是一个通用问题，所以请：不要提议`enum`或`const`**

**即在以下情况下该怎么做：我必须使用`#define`& _请在下面评论我提出的解决方案.. __**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-28T13:38:42.360

正确的策略是不使用

```
#define ZERO '0'
#define ONE  '1' 
```

一点也不。如果您需要常量值，请在这种情况下使用 a`const char`代替，包装在命名空间中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-28T19:11:52.333

有两种类型的`#define`宏：

1.  一个只需要在一个**文件**中。让我们称它们为`Private #defines`
    例如。`PI 3.14`在这种情况下：

    根据标准做法：正确的策略是放置`#define`标签 - 仅在实现中，即。**`c`**, 文件而不是头**`h`**文件。

2.  **多个**文件需要的另一个：让我们称之为`Shared #defines`
    例如。`EXIT_CODE 0x0BAD`在这种情况下：

    在头文件中只放置这些常见`#define`的标签。**`h`**

此外，尝试使用或类似约定来**唯一地**命名标签，例如在标签前面加上eg:以便*减少冲突的概率*`False NameSpaces``MACRO_``#define MACRO_PI 3.14`

 ** * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-28T13:40:24.170

`#define`s 没有对应于 C++ 代码的范围；你不能限制它。它们是天真的文本替换宏。想象一下问“当我用 grep 替换文本时如何限制范围？”

您应该尽可能避免使用它们，而倾向于使用真正的 C++ 类型。

*正确*使用宏几乎可以通过命名约定自行解决这个问题。如果宏被命名为对象，则它应该*是*对象（而不是宏）。问题解决了。如果宏被命名为函数（例如动词），它应该*是*一个函数。

这适用于文字值、变量、表达式、语句……这些都不应该是宏。这些是可以咬你的地方。

在其他情况下，当您使用某种语法助手时，您的宏名称几乎肯定不符合其他任何命名约定。所以问题几乎没有了。但最重要的是，当命名冲突时，需要是宏的宏会导致编译错误。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-09-28T13:51:31.350

> 什么是限制#define 范围并避免无根据的令牌冲突的正确策略。

1.  除非真的有必要，否则避免使用宏。在 C++ 中，通常可以使用常量变量和内联函数。它们的优点是它们是有类型的，并且可以在命名空间、类或代码块内限定范围。在 C 语言中，更经常需要宏，但在引入宏之前要仔细考虑替代方案。

2.  使用命名约定，明确哪些符号是宏，哪些是语言级标识符。保留`ALL_CAPITALS`名称以供宏使用是很常见的；如果你这样做，那么宏只能与其他宏发生冲突。这也将注意力吸引到更可能存在错误的代码部分。

3.  在每个宏名称上包含一个“伪命名空间”前缀，以便来自不同库/模块/任何东西的宏以及具有不同用途的宏不太可能发生冲突。因此，如果您正在设计一个狡猾的库，想要为数字零定义一个字符常量，请将其命名为`DODGY_DIGIT_ZERO`. Just`ZERO`可能意味着很多事情，并且很可能与另一个狡猾的库定义的零值常量发生冲突。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-28T13:54:38.220

一些选项：

1.  对宏和普通标识符使用不同的大写约定。

    ```
    常量 UINT 零 = 0;
    ```

2.  通过在宏前面添加模块名称来伪造命名空间：

    ```
    #define UTIL_ZERO '0'
     #define UTIL_ONE '1'
    ```

3.  在可用的情况下（C++），完全抛弃宏并使用真正的命名空间：

    ```
    命名空间实用程序{
         常量字符零 = '0';
         常量字符一 = '1';
     };
    ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-28T13:53:52.317

> 什么是限制#define 范围并避免无根据的令牌冲突的正确策略。

一些简单的规则：

1.  尽量减少预处理器令牌的使用。
    一些组织甚至沿着这条路走，并将预处理器符号`#include`仅限于警卫。我没有走这么远，但是将预处理器符号保持在最低限度是个好主意。
    *   使用枚举而不是命名的整数常量。
    *   使用`const static`变量而不是命名的浮点常量。
    *   使用内联函数而不是宏函数。
    *   使用 typedefs 而不是 #defined 类型名称。
2.  采用排除冲突的命名约定。
    例如，
    *   预处理器符号的名称必须仅由大写字母和下划线组成。
    *   没有其他类型的符号可以具有仅由大写字母和下划线组成的名称。

> `const UINT ZERO = 0; // Programmer not aware of what's inside Utility.h`

首先，如果程序员不了解 Utility.h 中的内容，为什么程序员要使用该`#include`语句？显然`UINT`是从某个地方传来的……

其次，程序员通过命名变量来自找麻烦`ZERO`。为预处理器符号保留所有大写名称。如果你遵守规则，你就不必知道 Utility.h 里面有什么。只需假设 Utility.h 遵循规则。使该变量的名称`zero`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-28T13:41:12.873

我认为您真的只需要知道您所包含的内容。这就像试图包含 windows.h 然后声明一个名为 WM_KEYDOWN 的变量。如果你有冲突，你应该重命名你的变量，或者（有点像黑客），#undef it。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-09-28T17:18:32.863

C 是一种结构化的编程语言。它有其局限性。这就是面向对象系统获得第一名的原因。在 C 中似乎没有其他方法，然后了解你的头文件的变量以 _VARIABLE 表示法开头，这样它被覆盖的机会就更少了。

```
in header file 
_ZERO 0

in regular file

ZERO 0 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2012-09-28T13:36:33.893

1.  我认为正确的策略是放置`#define`标签 - 仅在实施中，即。**`c`**, 文件
2.  此外，所有`#define`内容都可以单独放在另一个文件中 - 比如说：（`Utility_2_Def.h`
    很像微软的`WinError.h`：*Win32 api函数的错误代码定义*）

    **开销：**

    1.  一个额外的文件
    2.  一个额外的#include 语句

    **收获：**

    1.  Abstraction: `ZERO`is: `0`，`'0'`或者`"Zero"`关于你在哪里使用它
    2.  一个标准的地方改变整个模块的所有静态参数

**Utility_2.h**

```
BOOL Utility_2(); 
```

**Utility_2_Def.h**

```
# define ZERO '0'
# define ONE  '1' 
```

**Utility_2.c**

```
# include "Utility_2.h"
# include "Utility_2_Def.h"

BOOL Utility_2()
{
    ...
} 
```*

# xml - 从 XML Schema 元素中提取公共元素（xsd）

> ID：12641094
> 
> 赞同：0
> 
> 时间：2012-09-28T13:36:40.720
> 
> 标签：xml, xsd

我有这个架构：

```
<xs:element name="element1">
    <xs:complexType>
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attribute type="xs:string" name="found" use="required"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
</xs:element>
<xs:element name="element2">
    <xs:complexType>
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attribute type="xs:string" name="found" use="required"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
</xs:element> 
```

如何从 element1 和 element2 中提取公共部分。我应该使用组吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:29:50.107

您定义了一个通用类型，如下所示（注意：尚未验证，但您明白了）

```
<xs:complexType name="stringWithAttribute">
  <xs:simpleContent>
    <xs:extension base="xs:string">
      <xs:attribute type="xs:string" name="found" use="required"/>
    </xs:extension>
  </xs:simpleContent>
</xs:complexType> 
```

并将其指定为 element1 和 element2 的类型，如下所示

```
<xs:element name="element1" type="stringWithAttribute">
<xs:element name="element2" type="stringWithAttribute"> 
```

# c# - 具有多个参数的 Kentico CMS 友好 URL 通配符

> ID：12641099
> 
> 赞同：1
> 
> 时间：2012-09-28T13:36:50.157
> 
> 标签：c#, asp.net, friendly-url, kentico

我的 Kentico 站点中有一个页面，用于根据 URL 中的参数过滤结果。

我在搜索页面的“文档 URL 路径”设置中设置了一个通配符，如下所示：

/搜索/{标签}

所以完整的 URL 将是：

[http://www.mysite.com/Search/SearchTag1](http://www.mysite.com/Search/SearchTag1)

但是，这只适用于一个搜索参数。我希望能够拥有一个漂亮干净的 URL，其中包含多个类似于 StackOverflow 的搜索标签：

[http://www.mysite.com/Search/SearchTag1+SearchTag2+SearchTag3](http://www.mysite.com/Search/SearchTag1+SearchTag2+SearchTag3)

但我似乎无法做到这一点。如果我用多个标签构建我的 URL，我会得到一个 404 页面。

解决此问题的唯一方法是在我的页面属性中的 Url 中创建*x个通配符吗？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T18:37:03.100

好的，我相信我找到了答案。开箱即用，Kentico 不允许在其 URL 中使用加号，如下所述：http: [//devnet.kentico.com/Forums/f55/fp3/t25532/Plus-Signs-in-url-do-not-work.aspx](http://devnet.kentico.com/Forums/f55/fp3/t25532/Plus-Signs-in-url-do-not-work.aspx)。

为了解决这个问题，您可以通过在 web.config 中创建一个名为“CMSForbiddenURLValues”的新应用程序设置来选择您希望从 URL 中禁止的符号。有关这方面的更多信息，请参见 Kentico 的知识库：[http ://devnet.kentico.com/docs/devguide/index.html?url_format_and_configuration.htm](http://devnet.kentico.com/docs/devguide/index.html?url_format_and_configuration.htm)

最后，我决定用连字符而不是加号分割我的关键字，这解决了 404 页面问题。

# html - CSS 表格列宽：固定 - 动态（30%） - 动态（70%） - 固定

> ID：12641104
> 
> 赞同：11
> 
> 时间：2012-09-28T13:37:01.377
> 
> 标签：html, css

我设法获得了这种表格布局：

固定 - 动态 (50%) - 动态 (50%) - 固定

[http://jsfiddle.net/ihtus/ksuU/](http://jsfiddle.net/ihtus/ksucU/)

![在此处输入图像描述](../Images/ab680d11f242a8830242cef805d3cd92.png)

但是我怎样才能得到这种？固定 - 动态 (30%) - 动态 (70%) - 固定

![在此处输入图像描述](../Images/d2db01b876046e9e6cccfe70ca63ba40.png)

这是我的CSS：

```
table {
    width:100%;
    border-collapse:collapse;
    table-layout:fixed;
}

td {
    border: 1px solid #333;
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-28T13:40:09.173

像这样：

```
<table>
    <tr>
      <td style="width:200px;">
        200px width - content
      </td>
      <td width="30%">
        dynamic width - content
      </td>
      <td width="70%">
        dynamic width - content
      </td>
      <td style="width:100px;">
         100px width - content
      </td>
    </tr>
  </table>

table {
    width:100%;
    border-collapse:collapse;
    table-layout:fixed;
}

td {
    border: 1px solid #333;
} 
```

[http://jsfiddle.net/7dSpr/](http://jsfiddle.net/7dSpr/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T13:53:51.027

一般方法与 Monkieboy 使用的方法相同，但应避免使用内联样式。（我的意思是写`style="someting"`）在你的 html 文件中。您应该改用类和 CSS。

首先给 td 一个这样的类`<td class="thin-column">text here</td>`，然后在你的 CSS 中使用它来应用样式：`.thin-column:{ width: 30% }`

# android - Android如何从RelativeLayout中删除ImageView

> ID：12641111
> 
> 赞同：4
> 
> 时间：2012-09-28T13:37:34.053
> 
> 标签：android, android-imageview

我想弄清楚从 RelativeLayout 中删除 ImageView 的正确方法是什么？我试过了

```
relativeLayout.removeView(someImageView) 
```

但这会导致某些手机出现一些问题。有关堆栈跟踪，请参见此处的其他帖子。[删除 ImageView 会导致某些手机崩溃](https://stackoverflow.com/questions/12614272/removing-imageview-causes-crash-on-certain-phones)

我真的不想做只是让它看起来消失的解决方案，因为这基本上是在内存中泄漏 ImageView 对吗？

```
someImageView.setVisibility(View.GONE); 
```

任何其他想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:43:39.203

如果从相对布局中删除视图，则必须重置所有其他依赖于要删除的视图的视图的相对布局参数。否则，这些其他视图将引用您删除的视图并抛出 NPE。

`LinearLayout`如果您想在不使用的情况下实现此目的，请考虑使用另一种根布局设计（如）`View.GONE`

# iphone - 如何在iphone中加载字体系列

> ID：12641112
> 
> 赞同：0
> 
> 时间：2012-09-28T13:37:35.157
> 
> 标签：iphone

我想为 iphone 使用单独的字体样式。所以，需要加载字体系列。如何在 iphone 中加载字体系列。

请问有没有人可以。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:39:56.243

试试这个[链接](http://tetontech.wordpress.com/2010/09/03/using-custom-fonts-in-your-ios-application/)。你会通过的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:47:46.103

1.  将您的 customFontName.ttf 文件拖放到您的项目中
2.  转到支持文件中的 projectname-info.plist。添加应用程序提供的关键字体 -> 添加新项目 -> 赋予值 customFontName.ttf

![在此处输入图像描述](../Images/8c99691b38d535f9162d799762f8c52c.png)

3.  随心所欲地使用它，

> myLabel.font = [UIFont fontWithName:@"customFontName" size:15.0];

# iphone - 关于gamecenter+ios的问题

> ID：12641113
> 
> 赞同：2
> 
> 时间：2012-09-28T13:37:40.827
> 
> 标签：iphone, ios, game-center

我对游戏中心一无所知。我正在开发 COCO 应用程序，我已经阅读了游戏中心[指南](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/GameKit_Guide/Introduction/Introduction.html)，并能够将游戏中心集成到我的应用程序中。

1） ***现在我可以通过我的应用程序在游戏中心输入分数。*** 通过做这个：-

```
- (void) reportScore: (int64_t) score forCategory: (NSString*) category 
{
    GKScore *scoreReporter = [[[GKScore alloc] initWithCategory:category] autorelease]; 
    scoreReporter.value = score;
    [scoreReporter reportScoreWithCompletionHandler: ^(NSError *error) 
     {
         [self callDelegateOnMainThread: @selector(scoreReported:) withArg: NULL error: error];
     }];
} 
```

我昨天工作正常。但是现在如果我尝试更新分数，它没有更新。请任何人知道分数没有在游戏中心更新的原因，我试图搜索但没有得到任何东西。

***2）我想将一个玩家的当前纬度和经度发送给另一个玩家。我知道 GKMATCH 是可能的***

```
GKMatchRequest *request = [[[GKMatchRequest alloc] init] autorelease];
    request.minPlayers = 1;
    request.maxPlayers = 1;

    [[GKMatchmaker sharedMatchmaker] findMatchForRequest:request
                                   withCompletionHandler:^(GKMatch *match, NSError *error) {
                                       if (error || !match) {
                                           // handle the error
                                       }
                                       else if (match != nil){
                                           // match found
                                       }}];

    /*GKMatchRequest *request = [[[GKMatchRequest alloc] init] autorelease];
    request.minPlayers = 1;
    request.maxPlayers = 1;
    GKMatchmakerViewController *mmvc = [[GKMatchmakerViewController alloc] initWithMatchRequest:request];
    mmvc.matchmakerDelegate = self;
    currentMatch.delegate=self;
    [self presentModalViewController:mmvc animated:YES];*/
    //[mmvc release];
}
- (void)match:(GKMatch *)match player:(NSString *)playerID didChangeState:(GKPlayerConnectionState)state {
    switch (state){
        case GKPlayerStateConnected: 
            if (match.expectedPlayerCount == 0) {
                // start the match
            }
            break;
        case GKPlayerStateDisconnected:
            // remove the player from the match, notify other players, etc
            break;
    } 
}
- (void)matchmakerViewControllerWasCancelled:(GKMatchmakerViewController *)viewController{}

// Matchmaking has failed with an error
- (void)matchmakerViewController:(GKMatchmakerViewController *)viewController didFailWithError:(NSError *)error{
}

// A peer-to-peer match has been found, the game should start
- (void)matchmakerViewController:(GKMatchmakerViewController *)viewController didFindMatch:(GKMatch *)match{
}

// Players have been found for a server-hosted game, the game should start
- (void)matchmakerViewController:(GKMatchmakerViewController *)viewController didFindPlayers:(NSArray *)playerIDs{
}

// An invited player has accepted a hosted invite.  Apps should connect through the hosting server and then update the player's connected state (using setConnected:forHostedPlayer:)
- (void)matchmakerViewController:(GKMatchmakerViewController *)viewController didReceiveAcceptFromHostedPlayer:(NSString *)playerID {
}
- (void) sendPosition
{
    NSError *error;
    NSString* str = @"teststring";
    NSData* data = [str dataUsingEncoding:NSUTF8StringEncoding];
    //  NSData *packet = [NSData dataWithBytes:&msg length:sizeof(PositionPacket)];
    [currentMatch sendDataToAllPlayers: data withDataMode: GKMatchSendDataUnreliable error:&error];
    if (error != nil)
    {
        // Handle the erro.r
    }
} 
```

但我不知道为什么，但 GKMatchmakerViewController 的委托方法没有被调用，我已经设置了委托，但我仍然无法获得 GKMATCH（这里是 currentMatch）。所以由于这个 [currentMatch sendDataToAllPlayers: data withDataMode: GKMatchSendDataUnreliable error:&error]; 这种方法不起作用。

因为 CurrentMatch 参考是 0X0。请帮帮我。我如何发送和接收数据。我做错了什么？或者还有其他事情要做。

请帮我。

谢谢

# javascript - 画布图像消失

> ID：12641115
> 
> 赞同：1
> 
> 时间：2012-09-28T13:37:55.507
> 
> 标签：javascript, html, html5-canvas

我有这个功能可以在画布上加载图像：

```
function myImage() {
  var canvas=document.getElementById("myCanvas");
  var ctx=canvas.getContext("2d");
  var img=document.getElementById("image");
  ctx.drawImage(img,0,0);
} 
```

图像加载正常，画布上还有其他图像，但是对于这个图像，当我使用任何控件移动或调整其他图像的大小时，这个消失了。

加载我使用的图像：

```
<img id="image"  src="1.png" width="64" height="64" onclick="myImage(this)"> 
```

好吧，我更新了功能：

```
function myImage() {
  var canvas=document.getElementById("myCanvas");
  var ctx=canvas.getContext("2d");
  var img=document.getElementsByClassName("test");
  ctx.drawImage(img,0,0);
} 
```

和图像

```
<img class="test" src="1.png" width="64" height="64" onclick="myImage(this)">
<img class="test" src="2.png" width="64" height="64" onclick="myImage(this)">
<img class="test" src="3.png" width="64" height="64" onclick="myImage(this)"> 
```

但我收到此错误：

```
Uncaught TypeError: Type error 
myImage
onclick 
```

在函数的最后一行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:52:35.113

也许更好用：

```
document.getElementsByClassName('test'); 
```

并拥有您想要的特定共享课程的图像

# c# - 奇怪的 SqlCommand.Parameter 行为

> ID：12641121
> 
> 赞同：1
> 
> 时间：2012-09-28T13:38:11.013
> 
> 标签：c#, visual-studio-2010, debugging

将 Visual Studio 2010 Pro SP1 与 .NET Framework 4 SP1 一起使用。

我有这个简单的代码：

```
cmd.Parameters.Add("@tatCAN_FMS", SqlDbType.TinyInt).Value = gsmData.CANSquarellMode.Value ? 2 : 1; 
```

其中`cmd`是 a`SqlCommand`并且`gsmData.CANSquarellMode.Value = true;` `gsmData.CANSquarell`是`bool?`类型。

当我使用默认的“调试”配置调试此代码时`@tatCAN_FMS = 2`，正确的值是 的值。

但是，如果我使用默认的“发布”配置再次调试相同的代码，则`@tatCAN_FMS = NULL`. 为什么？

这是某种错误还是我错过了什么？

编辑1：

在默认的“发布”配置中，如果我手动设置

```
cmd.Parameters["@tatCAN_FMS2"] = gsmData.CANSquarellMode.Value ? 2 : 1; 
```

使用即时窗口将参数值设置为预期值 (2)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:50:55.290

对包含参数值的 Parameters.AddWithValue(string name, object value) 使用重载，然后放入 gsmData.CANSquarellMode.Value ？2:1 在那里。

```
cmd.Parameters.AddWithValue("@tatCAN_FMS", gsmData.CANSqaurellMode.Value ? 2 : 1); 
```

[MS SqlParameterCollection.AddWithValue](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection.addwithvalue.aspx)

# java - 从 JavaScript 客户端到服务器的 Google Channel API 消息

> ID：12641126
> 
> 赞同：0
> 
> 时间：2012-09-28T13:38:22.250
> 
> 标签：java, google-app-engine, channel-api

过了一会儿，我得到了`Google Channel API`工作的第一部分。现在我在从 JavaScript 客户端向服务器发送消息时遇到了一些问题。这是`Google Channel API`连接的 servlet：

```
public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {
    UserService userService = UserServiceFactory.getUserService();
    User user = userService.getCurrentUser();
    if (user != null) {
        ChannelService channelService = ChannelServiceFactory.getChannelService();
        String token = channelService.createChannel(user.getUserId());

        FileReader reader = new FileReader("index.html");
        CharBuffer buffer = CharBuffer.allocate(16384);
        reader.read(buffer);
        reader.close();

        String index = new String(buffer.array());
        index = index.replaceAll("\\{\\{ token \\}\\}", token);

        resp.setContentType("text/html");
        resp.getWriter().write(index);
    } else {
        resp.sendRedirect(userService.createLoginURL(req.getRequestURI()));
    } 
```

`index.html`如下所示：

```
<script src="/_ah/channel/jsapi"></script>

<body>
    <script type="text/javascript">
        onOpened = function() {
            alert("opened");
        }

        var token = "{{ token }}";
        var channel = new goog.appengine.Channel(token);
        var handler = {
            'onopen' : onOpened,
            'onmessage' : onMessage,
            'onerror' : function() {
            },
            'onclose' : function() {
            }
        };
        var socket = channel.open(handler);
        socket.onopen = onOpened;
        socket.onmessage = onMessage;

        function sendMessage() {
            // Send JSON object to server   
        }
    </script>
    <h1>Google Test Channel API</h1>
    <form>
        <input type="button" value="Send" onclick="sendMessage();">
    </form>
</body> 
```

如果我加载应用程序，我会收到`opened`警报，我相信连接正常。现在，如果有人单击该按钮，我想向服务器发送一条消息。

我读到我必须将 XMLHttpRequest 函数与 POST 或 GET 一起使用。但我不会传递一个新的 url，我只会传递一个值。有没有办法将 JSON 对象发送到服务器？

就像是：

```
{
    "message": "This is a JavaClient message!"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:05:45.317

这与 Chanel API 并没有太大关系——它只是一个标准的 xhr 回调到服务器。您可以像这样使用标准代码，或者[像这样](http://www.w3schools.com/ajax/ajax_xmlhttprequest_send.asp)使用像 jquery[这样](http://api.jquery.com/jQuery.ajax/)的库。

如果您需要将 javascript 解析为 JSON，请使用 JSON.stringify()。

在服务器上，您可以根据需要处理您的请求，通过标准 HTTP 将响应发送回客户端，或者使用 Chanel API 不仅向原始客户端发送消息，而且向所有连接的客户端发送消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:55:28.993

您是否熟悉 Nick Johnson 的频道 API 博客文章：

[http://blog.notdot.net/2011/07/Using-the-Channel-API-on-App-Engine-for-instant-traffic-analysis](http://blog.notdot.net/2011/07/Using-the-Channel-API-on-App-Engine-for-instant-traffic-analysis)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:55:12.473

App Engine 的 Channel API 几乎只用于从服务器->客户端发送消息。这是一个单向通道。

这很好，因为构建客户端->服务器通道并不难，但是您必须自己构建它，它不是免费的。您必须为客户端->服务器消息定义自己的 url，然后使用 XMLHttpRequest 将您的消息发送到该 url。

有一个小例外，Channel API 也有一个内置机制来通知服务器连接/断开连接。在幕后，这些是使用 XMLHttpRequests 到预定义的 url 完成的（我认为它类似于 _ah/channel/disconnect 之类的东西。这些对您没有用处，因为它们会被自动调用 - 您无法定义它们何时被调用，或内容。

所以，是的，只需实现您自己的 URL 处理程序，并将您的 JSON 数据发送到该 URL。

# android - Polar Wearlink 蓝牙数据包

> ID：12641131
> 
> 赞同：3
> 
> 时间：2012-09-28T13:38:41.903
> 
> 标签：android, bluetooth, packet

我正在查看一个名为 MyTracks 的项目的代码：

[http://code.google.com/r/jrgert-polar-bluetooth/source/browse/MyTracks/src/com/google/android/apps/mytracks/services/sensors/PolarMessageParser.java?r=ebc01faf49550bc9801633ff38bb3b8ddd6f5698](http://code.google.com/r/jrgert-polar-bluetooth/source/browse/MyTracks/src/com/google/android/apps/mytracks/services/sensors/PolarMessageParser.java?r=ebc01faf49550bc9801633ff38bb3b8ddd6f5698)

现在我的方法有问题`isValid(byte[] buffer)`。我不明白他到底在这里检查什么。我们想知道数组中的第一个字节是否是包含 0xFE 的标头。我不太明白以下几行：

```
 boolean goodHdr = ((buffer[0] & 0xFF) == 0xFE);
 boolean goodChk = ((buffer[2] & 0xFF) == (0xFF - (buffer[1] & 0xFF)));
 return goodHdr && goodChk; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-09T13:54:46.097

Ewoks 是正确的，参考这篇博文：

[http://ww.telent.net/2012/5/3/listening_to_a_polar_bluetooth_hrm_in_linux](http://ww.telent.net/2012/5/3/listening_to_a_polar_bluetooth_hrm_in_linux)

“深入研究 src/com/google/android/apps/mytracks/services/sensors/PolarMessageParser.java 我们发现一个有用的评论表明，尽管 Polar 对提供开发信息持荒谬的立场（他们没有，是总结） Wearlink 数据包格式其实很简单。

Polar 蓝牙 Wearlink 数据包示例

Hdr - Len - Chk - Seq - 状态 - HeartRate - RRInterval_16 位

FE - 08 - F7 - 06 - F1 - 48 - 03 64

在哪里

*   HDR 始终 = 254 (0xFE)，
*   Chk = 255 - Len
*   序列范围 0 到 15
*   状态 = 上半字节可能是电池电压
*   位 0 是节拍检测标志。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T13:01:37.373

第一行是检查接收缓冲区是否以 0xFE 开头，因为它应该与此 Polar 可穿戴设备一样。

第二行是检查长度字节是否正确，因为它的规范值是 255-value writen is size byte..

这一起是对消息正确性的超级简单验证（更复杂的实现将包括 CRC 或其他验证方法）。干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T09:48:00.033

&0xff 只是将有符号字节转换为无符号整数以进行比较

# xml - 如果它为 XML 和 JSON 返回不同的值，它是否是一个写得很糟糕的 API？

> ID：12641136
> 
> 赞同：1
> 
> 时间：2012-09-28T13:38:52.777
> 
> 标签：xml, json, api

我正在处理一个 api，如果没有值，它会为某些值 int 或 0 返回 XML - 这应该是恕我直言，但对于 JSON，如果没有值，它返回 int 或 boolean false。这是否意味着它的 api 或 JSON 和 XML 值写得不好？我认为它应该始终相同并且完全可以互换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:50:09.003

答案是 xml 和 JSON 在自己的打字系统中不一样，所以它们不应该提供相同的答案。Stronly typed: 0 在未找到项目时是一个很好的答案（例外应该更好），但在松散类型的 JSON 中，最好使用 false。使用宽松的类型环境给你的自由。所以两个api不必完全互换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T16:38:33.020

XML 和 JSON 具有完全不同的数据模型，API 很难完全隐藏这些差异。但是，你的问题很不公平。当我们不知道所讨论的 API 的设计目标或约束是什么时，您要求人们说 API 设计糟糕，因为它具有特定的属性。例如，他们可能一直试图使 JSON 版本与其他没有 XML 等价物的东西兼容。

# mysql - 将数据从一个 Wordpress 多站点数据表复制到另一个

> ID：12641138
> 
> 赞同：0
> 
> 时间：2012-09-28T13:38:55.540
> 
> 标签：mysql, database, wordpress

关于如何执行此操作或通过功能（针对每个用户）的一些指导。

说要复制的数据是 FROM

user_id 21 的 field_id 3 中的 wp_bp_xprofile_data

被复制到

user_id 21 的 field_id 3 中的 wp_9_bp_xprofile_data

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:45:34.287

也许在第一步中转储表更容易，然后在第二步插入它。然后，您只需在转储之前重命名目标表。

# ruby - 为什么 Ruby 的 Fixnum#/ 方法在另一个 Fixnum 上调用时会向下舍入？

> ID：12641140
> 
> 赞同：2
> 
> 时间：2012-09-28T13:39:02.637
> 
> 标签：ruby

好的，那这是怎么回事？

```
irb(main):001:0> 4/3
=> 1
irb(main):002:0> 7/8
=> 0
irb(main):003:0> 5/2
=> 2 
```

我意识到 Ruby 在这里进行整数除法，但为什么呢？使用像 Ruby 这样灵活的语言，为什么不能`5/2`返回实际的数学结果`5/2`？我缺少整数除法的一些常见用途吗？在我看来，`7/8`回报`0`会引起更多的混乱，而不是它可能带来的任何好处。Ruby 这样做有什么真正的原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T13:53:49.723

因为大多数语言（甚至是高级/高级语言）都在创作中吗？您将在 C、C++、Java、Perl、Python 中对整数有相同的行为......这是[欧几里得除法](https://en.wikipedia.org/wiki/Euclidean_division)（因此对应的模`%`运算符）。

整数除法运算甚至在许多体系结构的硬件级别上实现。[其他](http://www.peterbe.com/plog/blogitem-040804-1)人问过这个问题，其中一个原因是对称性：在静态类型语言（如 see）中，这允许所有整数运算返回整数，而不会损失精度。它还允许轻松访问相应的低级汇编程序操作，因为 C 被设计为它之上的一种扩展层。

此外，正如链接文章的一条评论中所解释的那样，浮点运算多年来成本很高（或并非所有架构都支持），并且不需要将数据集拆分为固定批次等过程。

# android - 缩放时 Google Maps API 不会聚焦

> ID：12641141
> 
> 赞同：1
> 
> 时间：2012-09-28T13:39:07.850
> 
> 标签：android, google-maps, android-mapview

当我在模拟器上运行我的应用程序时，Google Maps API 运行得非常好，但是当我放大它时，它不会像网络版本那样聚焦或呈现。

有任何想法吗？

这是我的代码：

```
@Override
    protected void onCreate(Bundle arg0) {
        // TODO Auto-generated method stub
        super.onCreate(arg0);
        setContentView(R.layout.map);

        Button openDrawer = (Button) findViewById(R.id.openDrawer);
        openDrawer.setOnClickListener(this);

        MapView mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);

        List<Overlay> mapOverlays = mapView.getOverlays();
        Drawable drawable = this.getResources().getDrawable(R.drawable.androidmarker);
        MapItemizedOverlay itemizedoverlay = new MapItemizedOverlay(drawable, this);

        GeoPoint point = new GeoPoint(19240000,-99120000);
        OverlayItem overlayitem = new OverlayItem(point, "Hola, Mundo!", "I'm in Mexico City!");

        itemizedoverlay.addOverlay(overlayitem);
        mapOverlays.add(itemizedoverlay);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:42:45.293

你试过下面的代码吗？？？

```
MapController controller = mapView.getController();
controller.setZoom(15);
controller.setCenter(point); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:21:52.023

我相信你需要做的就是打电话`mapView.invalidate()`，我设置的地图和你的有点不同，我复制了下面的代码以供参考：

```
LocationManager jLocManager;
MapController mController;
GeoPoint geoP;
MapView mapView;
MyLocationOverlay myLocOverlay;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.maps);

    try {
        JJMapsInitialize();
    }catch(Exception e){
        Log.e("JJMapsInitialize", "FAILED: " + e.getMessage());
    }

    myLocOverlay = new MyLocationOverlay(this, mapView);
    myLocOverlay.enableMyLocation();
    mapView.getOverlays().add(myLocOverlay);

}

public void findMyLocation() {
    LocationManager jLocManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    // 35000 is 35 seconds to find location && 10 is the minimum distance in meters
    jLocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 3000, 10, this.jLocListener);
    jLocManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 3000, 10, this.jLocListener);
}

private void JJMapsInitialize() {
    try { 
        mapView = (MapView) findViewById(R.id.mapview);
        mapView.displayZoomControls(true);
        mapView.setBuiltInZoomControls(true);
        mController.animateTo(geoP);
        mController.setZoom(10);
        mapView.invalidate();
    } catch(Exception e) {
        Log.e("JJMapsInitialize", "FAILED: " + e.getMessage());
    }

    try {
        findMyLocation();
    } catch (Exception e) {
        Log.e("findMyLocation", "FAILED: " + e.getMessage());
    }
} 
```

* * *

正如你所看到的，我调用了初始化方法，在该方法中我使用控件设置了我`MapView`的控件，使其无效，然后添加我的叠加层。

* * *

**编辑**

`jLocListener`只是我的`LocationListener()`- 我的名字以“j”开头，所以我通常在命名约定中使用我的首字母或两个首字母。

```
public LocationListener jLocListener = new LocationListener() {
        //class findMe implements LocationListener {
        public void onLocationChanged(Location location) {
            try {
                lat = location.getLatitude();
                lon = location.getLongitude();
            } catch (Exception e) {
                Log.e("onLocationChanged", "FAILED: " + e.getMessage());
            }
        }
        public void onProviderDisabled(String provider) {
            Log.i("LocationListener", "onProviderDisabled");
        }
        public void onProviderEnabled(String provider) {
            Log.i("LocationListener", "onProviderEnabled");
        }
        public void onStatusChanged(String provider, int status, Bundle extras) {
            Log.i("LocationListener", "onStatusChanged");
        }

    }; 
```

# watir - 定位可见元素

> ID：12641145
> 
> 赞同：1
> 
> 时间：2012-09-28T13:39:31.257
> 
> 标签：watir, watir-webdriver

有没有办法用 Watir 定位可见元素？

我只想定位可见表单（通过索引参数），以便 Watir 返回第一个或第二个可见文本字段。

如何过滤不可见的字段/元素？可以用xpath做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:36:03.347

这将返回第一个可见的文本字段：

```
browser.text_fields.select {|text_field| text_field.visible?}[0] 
```

您可以像这样在文本字段中设置文本：

```
browser.text_fields.select {|text_field| text_field.visible?}[0].set "text" 
```

这将返回第二个可见文本字段：

```
browser.text_fields.select {|text_field| text_field.visible?}[1] 
```

请注意，该元素可以是可见的，但可以禁用。

# javascript - Chrome 上 window.postMessage 的问题

> ID：12641146
> 
> 赞同：17
> 
> 时间：2012-09-28T13:39:38.063
> 
> 标签：javascript, jquery, html, cross-domain, postmessage

我已经坚持了几个小时。

我在[http://example.com](http://example.com)上有一个 a.html，其中包含一个 iframe，其中 src 到[http://subdomain.example.com](http://subdomain.example.com)上的 b.html 。a.html 有一些 JS 代码将消息发布到 iframe。

postMessage 的代码很简单：

```
iframe_window.postMessage('message', iframe_element.src) 
```

但是这样一来，Chrome 就会抛出一个错误：

```
Unable to post message to http://subdomain.example.com. Recipient has origin null. 
```

我也试过：

```
iframe_window.postMessage('message', 'http://subdomain.example.com') 
```

但没有运气！

这是它工作的唯一方式：

```
iframe_window.postMessage('message', '*') 
```

但是我听说'*'不好用。

火狐没有问题。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-15T02:23:58.073

看起来这可能是发送信号时未加载子 iframe 的问题，因此 iframe.src 没有正确的值。

我做了一些测试，得到了和你一样的错误，但是当我将 postMessage 调用包装在 setTimeout 中并等待 100 毫秒时，没有错误，这告诉我这是一个初始化竞争条件。

以下是我如何在没有 setTimeout 的情况下实现更清洁的解决方案：

家长：

```
window.addEventListener("DOMContentLoaded", function() {

    var iframe = document.querySelector("iframe")
      , _window = iframe.contentWindow

    window.addEventListener("message", function(e) {

        // wait for child to signal that it's loaded.
        if ( e.data === "loaded" && e.origin === iframe.src.split("/").splice(0, 3).join("/")) {

            // send the child a message.
            _window.postMessage("Test", iframe.src)
        }
    })

}, false) 
```

孩子：

```
window.addEventListener("DOMContentLoaded", function() {

    // signal the parent that we're loaded.
    window.parent.postMessage("loaded", "*")

    // listen for messages from the parent.
    window.addEventListener("message", function(e) {

        var message = document.createElement("h1")

        message.innerHTML = e.data

        document.body.appendChild(message)

    }, false)

}, false) 
```

这是一个简单的解决方案，其中孩子将向任何人发出它已加载的信号（使用“*”，这没关系，因为没有发送任何敏感内容。）父母侦听加载的事件并检查它是否是孩子感兴趣在那发射它。

然后父母向孩子发送一条消息，孩子准备好接收它。当孩子收到消息时，它会将数据放入 <h1> 并将其附加到 <body>。

我在 Chrome 中使用实际子域对此进行了测试，该解决方案对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-29T14:48:52.617

A shorter solution is to wrap the postMessage inside iframe_element.onload function.

# unit-testing - 如何对调用异步方法的同步方法进行单元测试？

> ID：12641147
> 
> 赞同：4
> 
> 时间：2012-09-28T13:39:41.023
> 
> 标签：unit-testing, asynchronous, synchronous, async-await

为调用异步方法的同步方法编写单元测试的正确方法是什么。现在我的单元测试正在通过，但是当我尝试打开页面时，它永远不会返回。为什么我的单元测试没有失败？我怎样才能让它失败？

我用这个简单的代码复制了我的问题：

我的通过测试：

```
 [TestMethod]
   public void DoSomeWork_WhenWeDoSomeWork_ShouldReturnDone()
   {
      var service = new SyncService();

      const string expected = "Done";
      var actual = service.DoSomeWork();

      Assert.AreEqual(expected, actual);

   } 
```

我永远不会回来的观点：

```
 public ActionResult Index()
    {
       var syncService = new SyncService();

        return View((object)syncService.DoSomeWork());
    } 
```

我的服务永远不会返回查看：

```
 public class SyncService
    {
       public string DoSomeWork()
       {
          return SomeWork().GetAwaiter().GetResult();
       }

       private async Task<string> SomeWork()
       {
          var task1 = Task.Delay(1000);
          var task2 = Task.Delay(1000);

          await Task.WhenAll(task1, task2);

          return "Done";
       }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:47:21.887

对于这个具体的例子，我认为我不能帮助你，但我认为一个好的通用策略是编写两个测试。一个测试同步方法是否传递了正确的数据，另一个测试异步方法是否正常工作。

我主要使用 JavaScript 工作，这种通用方法对我有用。您也可以查看测试框架的文档，也许它为此提供了一些方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:05:40.580

首先，[不要阻塞异步代码](http://nitoprograms.blogspot.com/2012/07/dont-block-on-async-code.html)（链接到我的博客）。通过阻塞`async`代码，您实际上会导致死锁。这种死锁不会发生在您的单元测试中，因为[单元测试在线程池上下文中运行，而不是在 ASP.NET 上下文中运行](http://nitoprograms.blogspot.com/2012/02/async-unit-tests-part-1-wrong-way.html)（链接到我的博客）。

[*异步方法没有*](http://blogs.msdn.com/b/pfxteam/archive/2012/04/13/10293638.aspx)[同步包装器](http://blogs.msdn.com/b/pfxteam/archive/2012/04/13/10293638.aspx)是有[充分理由的](http://blogs.msdn.com/b/pfxteam/archive/2012/04/13/10293638.aspx)*。所以我建议完全摆脱`DoSomeWork`，只留下`SomeWork`（重命名为`SomeWorkAsync`）。*

 *要解决您的问题，您应该使用[异步控制器操作](http://www.asp.net/mvc/tutorials/mvc-4/using-asynchronous-methods-in-aspnet-mvc-4)。*

# linux - 使用boost ASIO进行串口配置

> ID：12641149
> 
> 赞同：1
> 
> 时间：2012-09-28T13:39:43.993
> 
> 标签：linux, embedded, serial-port, boost-asio

我正在使用 boost asio 配置串行端口。但为什么下面的代码给出错误？如果我评论 set_option 它工作正常。

下面的代码给出了错误

> serial_config.cpp:13：错误：数字常量之前的预期 unqualified-id 在 /home/chirag/boost_install/include/boost/asio/serial_port_service.hpp:25 包含的文件中，来自 /home/chirag/boost_install/include/boost/ asio/basic_serial_port.hpp:30，来自/home/chirag/boost_install/include/boost/asio.hpp:25，来自serial_config.cpp:1：/home/chirag/boost_install/include/boost/asio/detail/reactive_serial_port_service。 hpp：在静态成员函数“静态 boost::system::error_code boost::asio::detail::reactive_serial_port_service::store_option(const void*, termios&, boost::system::error_code&) [with SettableSerialPortOption = int]中： /home/chirag/boost_install/include/boost/asio/detail/reactive_serial_port_service.hpp:126：从 âboost::system:: 实例化error_code boost::asio::detail::reactive_serial_port_service::set_option(boost::asio::detail::reactive_descriptor_service::implementation_type&, const SettableSerialPortOption&, boost::system::error_code&) [with SettableSerialPortOption = int]â /home/ chirag/boost_install/include/boost/asio/serial_port_service.hpp:167: 从 âboost::system::error_code boost::asio::serial_port_service::set_option(boost::asio::detail::reactive_descriptor_service::implementation_type&, const SettableSerialPortOption&, boost::system::error_code&) [with SettableSerialPortOption = int]â /home/chirag/boost_install/include/boost/asio/basic_serial_port.hpp:390: 从 âvoid boost::asio::basic_serial_port::set_option 实例化(const SettableSerialPortOption&) [with SettableSerialPortOption = int,SerialPortService = boost::asio::serial_port_service]âserial_config.cpp:31：从这里实例化 /home/chirag/boost_install/include/boost/asio/detail/reactive_serial_port_service.hpp:194：错误：请求成员“store”在â* (const int*)optionâ，它是非类类型âconst intâ

```
#include <boost/asio.hpp> // include boost
using namespace::boost::asio;  // save tons of typing
#include <iostream>
using std::cin;

// These are the values our port needs to connect
#ifdef _WIN32
// windows uses com ports, this depends on what com port your cable is plugged in to.
    const char *PORT = "COM3";
#else
// *nix com ports
    const char *PORT = "dev/ttyS3";
#endif
// Note: all the following except BAUD are the exact same as the default values

// what baud rate do we communicate at
serial_port_base::baud_rate BAUD(19200);
// how big is each "packet" of data (default is 8 bits)
serial_port_base::character_size CSIZE( 8 );
// what flow control is used (default is none)
serial_port_base::flow_control FLOW( serial_port_base::flow_control::none );
// what parity is used (default is none)
serial_port_base::parity PARITY( serial_port_base::parity::none );
// how many stop bits are used (default is one)
serial_port_base::stop_bits STOP( serial_port_base::stop_bits::one );

int main()
{
    // create the I/O service that talks to the serial device
    io_service io;
    // create the serial device, note it takes the io service and the port name
    serial_port port( io, PORT );

    // go through and set all the options as we need them
    // all of them are listed, but the default values work for most cases
    port.set_option( BAUD );
    port.set_option( CSIZE );
    port.set_option( FLOW );
    port.set_option( PARITY );
    port.set_option( STOP );

    // buffer to store commands
    // this device reads 8 bits, meaning an unsigned char, as instructions
    // varies with the device, check the manual first
    unsigned char command[1] = {0};

    // read in user value to be sent to device
    int input;
    cin >> input;

    // Simple loop, since the only good values are [0,255]
    //  break when a negative number is entered.
    // The cast will convert too big numbers into range.
    while( input >= 0 )
    {
        // convert our read in number into the target data type
        command[0] = static_cast<unsigned char>( input );

        // this is the command that sends the actual bits over the wire
        // note it takes a stream and a asio::buffer
        // the stream is our serial_port
        // the buffer is constructed using our command buffer and
        //  the number of instructions to send
        write( port, buffer( command, 1 ) );

        // read in the next input value
        cin >> input;
    }

    // all done sending commands
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T03:51:51.210

如果您将 character_size 变量名称从 CSIZE 更改为 C_SIZE 那么它将起作用.....

# javascript - 知道事件的先前处理程序是否返回 false。defaultPrevented 在 IE < 9 中？

> ID：12641152
> 
> 赞同：2
> 
> 时间：2012-09-28T13:39:55.820
> 
> 标签：javascript, html, event-handling, onclick, event-bubbling

我`<div>`在应用程序中放置了一个全局模式“正在加载，请稍候”。每次单击`<a>`或时都会显示`<input type="button">`。这是通过在 中分配`<body>`一个`onclick`事件处理程序来实现的`onload`，以便在事件冒泡时执行它：

```
<body onload="setup()">
    <!-- No control over what will be here -->
</body>

<script>
function setup() {
    document.getElementsByTagName('body')[0].onclick = clickFunc;
}
function clickFunc(eventData) {
    var clickedElement = (window.event) ? event.srcElement : eventData.target;
    if (someConditions) { 
        document.getElementById('modal').style.display = "block";
    }
}
</script> 
```

现在，我在标记中有一些组件（我无法控制）`return false`在他们`onclick`的 s. `confirm()`这导致模态弹出窗口显示并在有 a并且用户拒绝时停留在那里。处理这个问题的正确方法可能是`preventDefault()`，这样事件就不会冒泡，正如[event.preventDefault() 与 return false](https://stackoverflow.com/q/1357118/851811)中所解释的那样。

但我无法控制那部分，所以：有没有办法（最好是非 jquery + 跨浏览器）知道事件处理程序（在较低级别）先前执行的结果？

如果没有，我想我只需要`<div>`在组件的`onclick`contains时避免显示模态`return false`。

这是一个用于测试的[JSFiddle](http://jsfiddle.net/wTzu7/3/)。

## 更新

Bergi 下面的答案是我正在寻找的。但是，`defaultPrevented`在 IE < 9 中似乎不支持。在 IE < 9 中是否有等效/解决方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:54:28.743

您可以检查以捕获*尚未*返回`(window.event ? event.defaultPrevented : eventData.isDefaultPrevented()) == false`的已传播事件。*`false`*

# php - 达到 5 时如何重置计数器

> ID：12641153
> 
> 赞同：0
> 
> 时间：2012-09-28T13:39:58.903
> 
> 标签：php

有人可以帮助我重置 mysql 计数器。这是代码

```
$host="localhost"; // Host name 
$username=""; // Mysql username 
$password=""; // Mysql password 
$db_name="test"; // Database name 
$tbl_name="members"; // Table name 

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect to server "); 
mysql_select_db("$db_name")or die("cannot select DB");

$sql="SELECT * FROM $tbl_name";
$result=mysql_query($sql);

$rows=mysql_fetch_array($result);
$counter=$rows['counter'];

// if have no counter value set counter = 1
if(empty($counter)){
$counter=1;
$sql1="INSERT INTO $tbl_name(counter) VALUES('$counter')";
$result1=mysql_query($sql1);
}

echo "You 're visitors No. ";
echo $counter;

// count more value
$addcounter=$counter+1;

// reset counter if 5 has been reached
If (counter==5){

echo "counter=5 ";
// now im getting an error here//
counter=0;
}

$sql2="update $tbl_name set counter='$addcounter'";
$result2=mysql_query($sql2);

mysql_close();
?>

the error is:
Parse error: syntax error, unexpected '=' in C:\xampp\htdocs\test\counter.php on line  
 and based on // counter=0 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T13:40:59.103

你忘了*$*：

```
$counter=0; 
```

*计数器*本身不是变量，另外在您的更新查询中，如果您达到 5，您很可能在 0 值之后

```
If ($counter==5){
  echo "counter=5 ";
  $counter=0;
  $addcounter=0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:24:54.340

这是正确的工作代码。

```
<?php
$host="localhost"; // Host name 
$username="root"; // Mysql username 
$password=""; // Mysql password 
$db_name="gametest"; // Database name 
$tbl_name="counter"; // Table name 

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect to server "); 
mysql_select_db("$db_name")or die("cannot select DB");

$sql="SELECT * FROM $tbl_name";
$result=mysql_query($sql);

$rows=mysql_fetch_array($result);
$counter=$rows['counter'];

// if have no counter value set counter = 1
if(empty($counter)){
$counter=1;
$sql1="INSERT INTO $tbl_name(counter) VALUES('$counter')";
$result1=mysql_query($sql1);
}

echo "You 're visitors No. ";
echo $counter;

// count more value
$addcounter=$counter+1;

// reset counter if 5 has been reached
If ($counter==5){
$counter=0;
$addcounter=0;
}

$sql2="update $tbl_name set counter='$addcounter'";
$result2=mysql_query($sql2);

mysql_close();
?> 
```

# java - 清除所有 NetBeans 引用

> ID：12641154
> 
> 赞同：0
> 
> 时间：2012-09-28T13:40:06.067
> 
> 标签：java, netbeans-7

我在 Windows XP 上的 NetBeans 7.1.2 无缘无故停止显示我的 Web 应用程序项目。因此，每次运行 IDE 时，我都必须清理项目文件夹并创建一个新的 Web 项目。

我试过了：

*   重新安装IDE；
*   删除我的用户主文件夹下的 .netbeans 文件夹；
*   在 IDE 中重新安装插件；

除了格式化我的整个机器之外，我没有更多的想法。无论如何要清理所有 NetBeans 引用并包括 Windows 注册表？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T12:42:22.397

Solved. There was nothing wrong about NetBeans cache.

I had change the location of one jar and forgot to update a Library containing a reference to this jar.

It's weird because NetBeans shows things like this as Reference Problems. But in this specific case it had hide the projects.

So, I expect that this can help someone.

# ios - 在标签栏项目中添加第三个标签

> ID：12641162
> 
> 赞同：0
> 
> 时间：2012-09-28T13:40:43.393
> 
> 标签：ios, xcode, uitabbarcontroller, uitabbar, tabbar

我是 iphone 编码新手，我想在 www.fuelyourcoding.com 上找到的标签栏项目获得一些帮助

他正在创建一个自定义标签栏。然后他可以更改标签栏的颜色而不是标准的灰色。

如何添加第三个选项卡？我试图创建一个“ThirdViewController”，因为该项目包含第一个和第二个视图控制器。我还尝试复制我认为可能影响选项卡的所有信息，并插入“ThirdViewController”，之前它说“SecondViewController”等等。

很难描述，但如果有人愿意看一下，这里是链接。

[http://fuelyourcoding.com/files/files.zip](http://fuelyourcoding.com/files/files.zip)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:48:53.483

通常，您创建一个标签栏控制器和三个视图控制器。您将这三个视图控制器添加到选项卡栏控制器，并将选项卡栏控制器添加为应用程序委托的根视图控制器。这个想法不会出错，但是如果您可以显示更多代码，那就太好了。

这是示例：

```
 ViewController1 *v1 = [[ViewController1 alloc] init];
    ViewController2 *v2 = [[ViewController2 alloc] init];
    ViewController3 *v3 = [[ViewController3 alloc] init];

    self.tabBarController.viewControllers = @[v1, v2, v3];
    self.window.rootViewController = self.tabBarController; 
```

# javascript - Chrome 显示“资源解释为样式表，但使用 MIME 类型文本/html 传输”

> ID：12641168
> 
> 赞同：3
> 
> 时间：2012-09-28T13:40:54.757
> 
> 标签：javascript, node.js, google-chrome, socket.io, mime-types

我正在尝试使用 node.js（无快递）和 socket.io 建立一个简单的聊天。问题是 Chrome 卡在我的 html 文件中的外部包含上，导致这些文件永远不会被包含在内。我包括一个 ccs 文件和三个 javascript 文件。正如 Stackoverflow 上其他相关问题的答案中所建议的那样，我通过要求 mime 模块并使用`mime.lookup(url)`'text/html' 来检查我的文档的 MIME 类型。我专门将返回的标头设置为`'Content-Type' : 'text/html'`，甚至将其设置为“text/css”和“text/javascript”都无济于事。到目前为止，我不知道下一步该尝试什么。请帮忙！

聊天.html：

```
<!DOCTYPE html>
    <html>
        <head>
        <title>CHAT</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <link type="text/css" rel="stylesheet" href="css/style.css" /> <!-- First line that Chrome complains about -->
        <script type="text/javascript" src="/socket.io/socket.io.js"></script> <!-- Second line that Chrome complains about -->
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script type="text/javascript" src="chatClient.js"></script>
                    </head>
        <body>
        <h1>this shall be a chat</h1>
        </body>
    </html> 
```

聊天客户端.js：

```
var socket = io.connect('http://localhost');

        var chatBox = document.createElement('div');

        chatBox.id = 'chatBox';

        socket.on('server', function (data) {
        console.log('Server says: ', data.message);

        socket.emit('client', { clientMessage : 'this is all I have to say, right now!' });
}); 
```

聊天服务器.js：

```
var app = require('http').createServer(handler),
io = require('socket.io').listen(app),
fs = require('fs'),
mime = require('mime');

var url = __dirname + '/chat.html';
var mimeType = mime.lookup(url);

console.log(mimeType);

app.listen(8080);

function handler (req, res) {
    fs.readFile(url, function (err, data) {
    if (err) {
        res.writeHead(500);
        return res.end('Error loading chat');
    }

    res.setHeader('Content-Type', mimeType); // Sets the header to 'text/html'
    res.writeHead(200);
    res.end(data);
    });
}

io.sockets.on('connection', function (socket) {
    console.log('CHAT ONLINE');
    socket.emit('server', { message: 'hello world' });

    socket.on('client', function (data) {
    console.log('Client says: ', data.clientMessage);
    });
}); 
```

这是我绝对第一次在这里发帖，所以请让我知道我是否应该包含更多内容来帮助您帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:48:40.120

您`mimeType`在初始化期间根据您可能发送的*一个文件进行设置，而不是根据您实际发送的文件进行设置。*这将导致您可能发送的任何非 HTML 文件（例如 CSS 或 JS 文件）带有误导性的 Content-Type 标头。您需要*在*请求处理程序中进行检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T02:51:59.460

在 socket.io 和 differents 文件夹之前已经回答了这个问题[---找到了解决方案](https://stackoverflow.com/questions/11438589/socket-io-and-differents-folders-solution-found)

我建议使用 connect 或 express 框架。让您的工作更轻松。

# jquery - 在 mvc3 中使用 ajax 更新数据库

> ID：12641170
> 
> 赞同：0
> 
> 时间：2012-09-28T13:40:58.313
> 
> 标签：jquery, ajax, asp.net-mvc-3

```
var loginCred = new Object();
loginCred.Username = $('#userName').val();
loginCred.Password = $('#password').val();
loginCred.RememberMe = $('#rememberMe').checked;

var myJsonObject = JSON.stringify(loginCred);

$.ajaxSetup({ cache: false });
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: "/Account/LogOnAjax/",
    data: myJsonObject,
    dataType: "json",
    success: function(data) {
        PostCredentialsSuccess(data);
    }

}); 
```

我尝试使用 mvc3 开发应用程序。在这里我想使用 ajax 更新数据库。这是我发布表单数据的 ajax 请求。但我想在控制器中捕获此数据并使用此数据更新数据库。请帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:14:02.210

您不需要对对象进行字符串化。

```
var myJsonObject = JSON.stringify(loginCred); 
```

您已指定 dataType: "json" 因此您可以使用 loginCred

```
data: loginCred, 
```

并尝试删除`contentType: "application/json; charset=utf-8",`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:45:07.750

这是问题所在

```
data: myJsonObject, 
```

利用

```
data:{"jsondata":myJsonObject} 
```

# c - 简单的Linux管道程序，收不到数据

> ID：12641175
> 
> 赞同：1
> 
> 时间：2012-09-28T13:41:17.230
> 
> 标签：c, linux, ipc, pipe, communication

我正在编写一个简单的 Linux C 程序来帮助我更好地理解 IPC，现在我正在尝试用管道构建它。
我有一个代码库，我在两个不同的终端窗口中作为两个不同的可执行文件运行（因此它们可以相互通信）。但是我没有做正确的事情，因为我从来没有读取任何数据，但我不确定是什么......

**注意**这不是完整的代码，我删除了输出/输入/验证以节省空间。但它在下面程序的评论中注明。

```
void main()
{
  int pipefd[2], n;
  char input = 0;
  char buffer[100] = {0};
  char outpipe[100] = {0};

  if(pipe(pipefd) < 0) {
    printf("FAILED TO MAKE PIPES\n");
    return;
  }

  printf("Starting up, read fd = %d, write fd = %d\n", pipefd[0],pipefd[1]);

  do {
    //print menu options (send message, get message, get my fd, 
    // set a fd to talk to, quit)

    // if "send a message":
    {
      printf("What would you like to send?\n");
      fgets(buffer, 100, stdin);
      write(pipefd[1], buffer, strlen(buffer));
    }
    //else if "read a message":
    {
      if(open(outpipe, 0) < 0)
          printf("Couldn't open the pipe!\n");
      else {
        n = read(outpipe, buffer, 100);
        printf("I got a read of %d bytes\nIt was %s\n",n, buffer);
        close(outpipe);
      }
    }
    //else if "get my file descriptor":
      printf("My fd tag is: /proc/%d/fd/%d\n", (int)getpid(), pipefd[0]);
    //else if "set a file descriptor to talk to":
    {
      printf("What is the pipe's file descriptor?\n");
      fgets(outpipe, 100, stdin);
      n = strlen(outpipe) - 1;
      outpipe[n] = '\0';
    }
  } while (input != 'Q');
return;
} 
```

我知道管道已成功创建，我验证了文件描述符已到位：

```
lr-x------ 1 mike users 64 Sep 26 23:31 3 -> pipe:[33443]
l-wx------ 1 mike users 64 Sep 26 23:31 4 -> pipe:[33443] 
```

看起来权限没问题（在管道 3 上读取，在管道 4 上写入）。

我这样使用它：

```
//terminal 1
Pick an option:
3
My fd tag is: /proc/8956/fd/3

//terminal 2
Pick an option:
4
What is the pipe's file descriptor?
/proc/8956/fd/3

Pick an option:
1
What would you like to send?
hello

//terminal 1
Pick an option:
2
I got a read of -1 bytes
It was 
```

我在这里做的有什么明显的错误吗？我的读取总是得到“-1”返回值......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:26:57.777

看来您误解了管道的工作原理。管道是一个匿名文件描述符，它不是文件系统中的文件。`/proc/<pid>/fd`你不必关心里面的文件。

这是您尝试执行的操作的重写：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main(void)
{
    int pipefds[2];
    char input[128];
    char output[128];
    ssize_t nread;

    if (pipe(pipefds) == -1)
    {
        perror("Could not create pipe");
        return EXIT_FAILURE;
    }

    printf("Enter input: ");
    if (fgets(input, sizeof(input), stdin) == NULL)
    {
        perror("Could not read input");
        return EXIT_FAILURE;
    }

    /* "Remove" newline from input */
    if (input[strlen(input) - 1] == '\n')
        input[strlen(input) - 1] = '\0';

    /* Now write the received input to the pipe */
    if (write(pipefds[1], input, strlen(input) + 1) == -1)
    {
        perror("Could not write to pipe");
        return EXIT_FAILURE;
    }

    /* Now read from the pipe */
    if ((nread = read(pipefds[0], output, sizeof(output))) == -1)
    {
        perror("Could not reaf from pipe");
        return EXIT_FAILURE;
    }

    /* We don't need to terminate as we send with the '\0' */

    printf("Received: \"%s\"\n", output);

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:59:51.427

这是您最关心的问题：

```
./ipctest.c: In function ‘main’:

./ipctest.c:32:9: warning: passing argument 1 of ‘read’ makes integer from pointer without a cast [enabled by default]
/usr/include/unistd.h:361:16: note: expected ‘int’ but argument is of type ‘char *’

./ipctest.c:34:9: warning: passing argument 1 of ‘close’ makes integer from pointer without a cast [enabled by default]
/usr/include/unistd.h:354:12: note: expected ‘int’ but argument is of type ‘char *’ 
```

查看某个功能所需的数据类型... :)

# python - Mysql：查询集在python中不起作用

> ID：12641187
> 
> 赞同：0
> 
> 时间：2012-09-28T13:42:10.100
> 
> 标签：python, mysql

我现在正在使用 python mysql

我有问题这是mysql查询

```
query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent ='idd' 
```

我从外部来源获得 idd 但每当我尝试执行此查询时

我收到错误

```
 File "server.py", line 28
    query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent ='idd'
                                                                                         ^
SyntaxError: invalid syntax 
```

请帮我解决我可能做错的事情

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:45:35.240

您需要使用查询参数：

```
query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent =?' 
```

`idd`然后在执行查询时传入值：

```
cursor.execute(query, (idd,)) 
```

在 python 中，您不能简单地将变量放在各种字符串之间并希望它进行插值。

要进行常规字符串插值，请使用以下[`.format()`方法](http://docs.python.org/library/string.html#formatstrings)：

```
query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent = "{0}"'.format(idd) 
```

但是你会错过准备语句的数据库查询优化器。如果重复使用，准备好的语句执行起来会更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:46:28.260

您正在混合双引号和单引号。

代替...

```
query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent = 'idd' 
```

采用...

```
query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent = "idd"' 
```

另外， idd 是一个变量吗？如果是你需要做...

```
query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent = "'+str(idd)+'"' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T13:47:40.400

您似乎忘记在进行查询时连接外部变量，

```
query = 'SELECT * FROM callerdetail WHERE screenname="1" AND status="0"AND agent = "'+idd+'"' 
```

# objective-c - NSString 和 CFString 完全一样吗？

> ID：12641189
> 
> 赞同：8
> 
> 时间：2012-09-28T13:42:14.453
> 
> 标签：objective-c, core-foundation

O'Reilly 的 Programming iOS 5 说（也许从更宽松的意义上说）“一个 NSString 是一个 CFString”。但是，至少`NSString *`会指向一些带有 的内存块`isa`，而`CFStringRef`可能不会？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T13:46:48.397

不完全一样；它们是*免费桥接的*。这个[Apple Doc](http://developer.apple.com/library/ios/#documentation/CoreFoundation/Conceptual/CFDesignConcepts/Articles/tollFreeBridgedTypes.html)应该更详细地解释。

这里有更多来自*iOS 5 Programming Pushing The Limits* on [Google Books](http://books.google.co.uk/books?id=LFaxcuKxVf0C&pg=PA369&lpg=PA369&dq=toll-free%20bridged%20isa&source=bl&ots=Nf1qGSdee8&sig=z8ceZCJCjyBVAh72hkzjB2m9niE&hl=en&sa=X&ei=eqplUPP4LInG0QWLv4DYDw&ved=0CHUQ6AEwCA#v=onepage&q=toll-free%20bridged%20isa&f=false)的详细信息。

# iphone - 从 ARC 静态库访问 @property 时 ARC 应用程序崩溃

> ID：12641190
> 
> 赞同：9
> 
> 时间：2012-09-28T13:42:16.783
> 
> 标签：自动引用计数）应用程序。, iphone, ios5, automatic-ref-counting, static-libraries, ios6

我有一个构建静态库（也是 ARC）的 ARC（[自动引用计数）应用程序。](/questions/tagged/automatic-reference-counting "显示标记为“自动引用计数”的问题")该应用程序将正常启动，但是当执行读取或写入静态库中的@property 的操作时，应用程序将因以下错误而崩溃：

```
dyld: lazy symbol binding failed: Symbol not found: _objc_setProperty_nonatomic
  Referenced from: /var/mobile/Applications/0E7ADBB4-FFE5-4CEB-B418-8A35A92E99D4/MyApp.app/MyApp
  Expected in: /usr/lib/libobjc.A.dylib

dyld: Symbol not found: _objc_setProperty_nonatomic
  Referenced from: /var/mobile/Applications/0E7ADBB4-FFE5-4CEB-B418-8A35A92E99D4/MyApp.app/MyApp
  Expected in: /usr/lib/libobjc.A.dylib 
```

所有的建议都是关于将非 ARC 库链接到 ARC 应用程序（反之亦然）。但这些都是ARC。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-28T13:44:47.813

该应用程序`Base SDK`设置为 iOS 6 并`iOS Deployment Target`设置为 iOS 5.0，但是对于静态库，`Base SDK`&`iOS Deployment Target`都设置为 iOS 6。

确保应用程序和库中的 `Base SDK`&`iOS Deployment Target`匹配解决了这个问题。

# javascript - 任何原因 CSS 'display: none;' 应该让 Firefox 崩溃吗？

> ID：12641195
> 
> 赞同：0
> 
> 时间：2012-09-28T13:42:25.873
> 
> 标签：javascript, css, firefox, svg, crash

我正在构建一个基于 Web 的应用程序，该应用程序使用“浮动”弹出 div 来模拟窗口和右键单击菜单。每当我使用 CSS（显示：无）“关闭”（隐藏）一个 div 时，Firefox 崩溃的可能性为 50/50。

我查看了崩溃日志，中断的（ff 源代码的）行是试图确定我是否在给定对象上有“指针事件：无”......或者这就是它的样子.

这似乎发生在我使用 javascript 操作 svg 元素然后在操作之前或之后将 display:none 应用于其他东西的任何情况下。svg 更改和 css 更改（断点、警报框等）之间的任何延迟通常可以防止崩溃。

有没有其他人遇到过这样的事情，或者知道为什么会发生这种情况？

# java - 定义和重用 MVEL 函数

> ID：12641197
> 
> 赞同：1
> 
> 时间：2012-09-28T13:42:28.517
> 
> 标签：java, function, embedding, evaluation, mvel

是否可以使用 MVEL 定义一些自定义预编译函数并在另一个编译表达式中使用一个？如果我尝试以下操作：

```
MVEL.compileExpression("function hello() { System.out.println(\"Hello!\"); hello(); return x * y;"); 
```

我`Exception in thread "main" [Error: duplicate function: hello]`第二次尝试执行它时得到。

看起来我不应该在表达式本身，而是在某种上下文中声明函数。我用 ParsedContext 玩了一段时间，但总是得到`Exception in thread "main" [Error: unable to access property (null parent): hello]`.

Internet 上充满了涵盖不同 MVEL 语言使用主题的教程，但此类嵌入主题的文档记录非常差。你能给我一些线索我做错了什么吗？

PS我不想从Java执行某些功能。我需要用 MVEL 动态定义它们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T00:58:39.067

这比一些常见的用例有点棘手，尽管这是可能的。

从根本上说，您需要做的是创建一个定义您的函数的脚本，如下所示：

```
VariableResolverFactory functionFactory = new MapVariableResolverFactory();
MVEL.eval("def foo() { System.out.println("foo"); }; def bar() { System.out.println("bar") };", functionFactory); 
```

然后，您所做的就是将此工厂反向链接到您运行的任何表达式：

```
VariableResolverFactory myVarFactory = new MapVariableResolverFactory();
myVarFactory.setNextFactory(functionFactory);

Serializable s = MVEL.compileExpression("foo(); bar();");

MVEL.executeExpression(s, myVarFactory); 
```

函数被记录为变量表上的引用，因此您可以使用常规变量工厂反向链接在 MVEL 中共享它们。

注意：您不应该重新分享“myVarFactory”。你想每次都创建一个新的。您只想回收“functionFactory”并将其反向链接到每个运行的工厂，如上所示。否则，您最终将在执行之间共享本地 var 状态——这不是线程安全的

# java - 找不到旧的 Java JNA 版本

> ID：12641199
> 
> 赞同：0
> 
> 时间：2012-09-28T13:42:39.170
> 
> 标签：java, jna

我试图让它工作：[如何在 Java 中快速截取屏幕截图？](https://stackoverflow.com/questions/2912007/java-how-to-take-a-screenshot-fast/4843247#answer-4843247)

不幸的是，它是使用 JNA 的旧版本（2009 年 6 月）构建的，我在任何地方都找不到。因此，当我尝试使用以下任何版本（3.2.3、3.2.5、3.2.7 和 3.3.0）运行代码时，会出现错误。

我到处寻找，但找不到 Java JNA 的旧（工作）版本。
有谁知道我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:32:58.883

你检查过[Maven 中心](http://mvnrepository.com/artifact/net.java.dev.jna/jna)吗？他们的版本回到 3.0.3。但是，我不确定您要查找哪个版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:25:43.337

以前的版本标记为可追溯到五年前，可从[github](https://github.com/twall/jna/tags)获得。

# c# - 如何将一个 XML 块从一个文档复制到另一个文档？

> ID：12641206
> 
> 赞同：1
> 
> 时间：2012-09-28T13:43:15.440
> 
> 标签：c#, xml

我有两个 dataGridViews，每个都加载一个 XML 文件，我已经做到了，以便您可以在每个网格之间拖放行。然而目前，它所做的只是从 dataGridView 复制数据。这很好用，但是我需要复制与该行相关的所有 XML。

这是我必须使用的 XML：

```
<WindowBuilderProject>
  <stringtable>

    <stentry>0..607</stentry> //All of the other records

    <stentry>
      <index>608</index>
      <sid>MNUB_AUTO</sid>
      <val>
        <en>AUTO</en>
      </val>
      <params>
        <fontref>0</fontref>
        <numref>0</numref>
        <clip>FALSE</clip>
        <include>TRUE</include>
        <protected>FALSE</protected>
        <cwidth>-1</cwidth>
        <dwidth>0</dwidth>
      </params>
    </stentry>

  </stringtable>
</WindowBuilderProject> 
```

所以我需要复制用户选择的行的 XML 并将其插入到另一个（相同格式）XML 文档中。

到目前为止，我有这个：

```
string location = "/WindowBuilderProject/stringtable/stentry[index='" + rowIndexOfItemUnderMouseToDrop + "']";
XmlNode Copy = xDoc.ImportNode(xDoc2.SelectSingleNode(location), false);
xDoc.DocumentElement.AppendChild(Copy); //This is just supposed to add it to the end, I will worry about ordering once it works 
```

它运行良好，但是我在 XML 文件的底部添加了一个。如何选择整个 XML 块？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T11:46:39.133

假设您要将元素块从 text1.xml 复制到 text2.xml，您可以使用 LINQ to XML，下面的示例假设将所有条目从 text1 复制到 text 2：

```
 var xDoc1 = XDocument.Load("C:\\text1.xml");
  var xDoc2 = XDocument.Load("C:\\text2.xml");

  var doc1Entries = xDoc1.Descendants("stentry");

  var cloneEntries = doc1Entries.Select(x => new XElement(x));
  xDoc2.Descendants("stentry").Last().AddAfterSelf(cloneEntries);

  xDoc2.Save("C:\\text2.xml"); 
```

但是您也可以使用`Where`过滤方法来获取部分 xml，下面的示例是使用索引列表进行过滤：

```
 var filterIndices = new[] {600, 601, 700, 705};

  var doc1Entries =
      xDoc1.Descendants("stentry")
           .Where(x =>         
               filterIndices.Contains(int.Parse(x.Element("index").Value))); 
```

在这里，我假设使用 插入到最后`Last`，但如果您关心排序，您可以在 xDoc2 上使用 LINQ 找到正确的位置，然后进行插入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:05:01.510

每个 XmlNode 都有几个方法（并且 XmlDocument 是 XmlNode 的子类），因此您可以使用**xDoc.SelectNodes()**或**xDoc.SelectSingleNode()**在文档结构中的任何位置选择特定节点，将该节点存储在一个对象中（让我们称它为 needleNode)，然后执行**xDoc.InsertBefore(Copy, ref needleNode)**或**xDoc.InsertAfter(Copy, ref needleNode)**。使用这四个函数，您可以将 xml 部分插入到第二个 xml 结构中的任何部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T23:54:13.293

如果您的控件是数据绑定的，则不需要向 DataGridView 的行集合添加/删除行（实际上您不能这样做）。相反，将它们添加到基础数据源集合（您要设置到 DataGridView 的 DataSource 属性中的集合）。之后，您需要刷新两个 datagridview 的视图以反映更改。

# c++ - 如何创建多个模板对象的数组

> ID：12641207
> 
> 赞同：0
> 
> 时间：2012-09-28T13:43:18.463
> 
> 标签：c++, arrays, templates

我有模板类“工厂”。工厂的原型如下：

```
template <class T>
class Factory
{
    public:
    Factory();
    ~Factory();

    //few more functions & data-members

    private:
    //few more functions & data-members
}; 
```

在 main() 中，我制作了多种类型的工厂，如下所示 -

```
int main()
{
    typedef Factory<int> IntFactory ;
    IntFactory A = IntFactory();

    typedef Factory<float> FloatFactory ;
    FloatFactory B = FloatFactory();

    //Complex is some user defined class
    typedef Factory<Complex> ComplexFactory ;
    ComplexFactory C = ComplexFactory();

    //Point3D is a user defined class
    typedef Factory<Point3D> Point3DFactory ;
    Point3DFactory D = Point3DFactory();

    //I may have several such initializations.

} 
```

问题是如何创建对象数组 A、B、C、D 以防我想遍历它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:52:42.380

我认为你能做的最好的事情（在我的脑海中并且没有经过测试）是：

```
class FactoryBase
{
    public:
        virtual ~FactoryBase() = 0;
};

template <class T>
class Factory : public FactoryBase
{
    //...
};

int main()
{
    std::vector<FactoryBase*> factories;
    factories.push_back(new Factory<int>);
    factories.push_back(new Factory<Complex>);
    //... Make sure you delete these. Better yet, use a smart pointer.
    return 0;
} 
```

注意一个`vector`指针，所有这些`push_back(new ...)`东西都非常容易受到异常和泄漏的影响......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:55:34.457

（如果您不想使用基类方法，另一种选择）

```
typedef boost::variant<IntFactory, FloatFactory, ...>  FactoryType;

std::vector<FactoryType> vFactories; 
```

然后使用访问者执行和方法...

链接[变体](http://www.boost.org/doc/libs/1_51_0/doc/html/variant/tutorial.html#variant.tutorial.basic)的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:18:55.033

有很多方法可以做你想做的事......每一种都有优点和缺点......如果你在编译期间知道所有实例，这种方法可以正常工作：

**包括**

```
#include <boost/fusion/algorithm/iteration/for_each.hpp>
#include <boost/fusion/container/vector.hpp> 
```

**函子**

```
struct do_whatever
{
    template<typename T>
    void operator()(T& t) const
    {
        ...
    }
}; 
```

**向量上的实例化和迭代**

```
boost::fusion::vector<IntFactory, FloatFactory, ComplexFactory, Point3DFactory> vv(A, B, C, D);
boost::fusion::for_each(vv, do_whatever()); 
```

# iphone - 如何设置表格单元格的背景？

> ID：12641216
> 
> 赞同：0
> 
> 时间：2012-09-28T13:43:47.360
> 
> 标签：iphone, ios5, uitableview

我已经创建了表格视图并在单元格标签中设置了文本，现在我想在我的单元格中设置背景图像，我的标签将显示在该图像上。我该怎么做？

我已经尝试过了，但它对我不起作用。

```
UIImageView *av = [[UIImageView alloc] initWithFrame:CGRectMake(500, 500, 500, 500)];
av.backgroundColor = [UIColor clearColor];
av.opaque = NO;
av.image = [UIImage imageNamed:@"cell.png"];
cell.backgroundView = av; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:49:35.540

将 的`backgroundView`属性设置`UITableViewCell`为 `UIImage`，只需使用：

```
theCell.backgroundView = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"cell_normal.png"]] autorelease]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T07:56:00.807

设置背景视图。只需使用下面的代码。

```
Cell.backgroundView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"ImageName"]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T08:13:22.110

如果您使用的是标准`UITableViewCell`样式而不是任何自定义单元格，那么除了做您已经在做的事情之外，您还需要一步。

您必须清除默认使用的标签的背景颜色，`UITableViewCell`例如，如果您正在使用，`UITableViewCellStyleDefault`那么您还必须使用

```
cell.textLabel.backgroundColor = [UIColor clearColor]; 
```

默认标签倾向于隐藏单元格的背景。

# javascript - 关闭当前弹出窗口并重定向到父窗口

> ID：12641220
> 
> 赞同：0
> 
> 时间：2012-09-28T13:44:15.973
> 
> 标签：javascript

在 JS 我正在使用：

```
window.open('index.php?module=Contacts&action=UD_lookupemailtemplates&tempmode=userdefined&temp_url='+encodeURIComponent(temp_php_url),'emailtemplate','top=100,left=200,height=400,width=500,resizable=yes,scrollbars=yes,menubar=no,addressbar=no,status=yes') 
```

打开一个链接很少的小窗口。现在单击任何一个链接，一个 id 将附加到一个 url，然后我使用了这个：

```
window.document.location.href = url; 
```

这也在 JS 中。这样做是它改变了小弹出窗口的内容，但我需要它来关闭弹出窗口并在创建弹出窗口的主父窗口中打开这个 url。
那可能吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T13:49:12.820

认为

```
var popup_window = window.open(...); 
```

用于关闭此用途

```
popup_window.close(); 
```

并重定向父窗口

```
window.parent.location.href = url; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:51:04.790

要关闭您打开的弹出窗口，请存储以下位置的返回值`window.open`：

```
var popup = window.open(...); 
```

然后，您可以使用：

```
popup.close(); 
```

根据您的问题，我不清楚 URL 变量的存储位置（在哪个窗口中），但您可以通过`popup.variableName`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-28T14:04:03.760

首先，您必须使用重定向父窗口

```
window.opener.location.href = "http://url.com"; 
```

然后关闭当前（弹出）窗口

```
window.close(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T13:49:11.400

就我个人而言，我不喜欢弹出窗口而不是那样，也许您可​​以执行以下操作：

您可以打开一个覆盖 DIV，您可以使用 AJAX 填充来自“index.php?module=Contacts...”的数据，并以这种方式在该 DIV 内创建链接，以便通过单击它们关闭该覆盖 DIV 并将页面重定向到你想要什么...

# git - 如何查看给定更改最初提交到哪个分支？

> ID：12641222
> 
> 赞同：0
> 
> 时间：2012-09-28T13:44:26.677
> 
> 标签：git

> **可能重复：**
> [显示提交的原始分支](https://stackoverflow.com/questions/4535251/show-the-original-branch-for-a-commit)

我试图弄清楚我们的 Git 存储库中的特定文件发生了什么。该文件的更改历史记录包括对几个分支和一些合并的更改。

不幸的是，我能得到的最好的输出`git log ... myfile.cs`只是显示了一个变化图，在任何地方都没有一个分支名称。如果我能看到给定更改提交到哪个分支，那就太好了。

看来这可能是 Git 不跟踪的东西。如果是这样，我还能如何确定更改提交到哪个分支？如果我弄错了，我该如何说服`git log`显示分支名称？

（为了记录，`--decorate`不做，大概是因为这个选项只装饰了每个分支上的*最后一个更改）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:56:17.217

可能重复：[显示提交的原始分支](https://stackoverflow.com/questions/4535251)

* * *

鉴于提交可能发生的众多操作（修改、合并、变基、从原点导入......），我认为您无法准确找到您想要的内容。

从其他 SO 问题（请参阅[此处](https://stackoverflow.com/questions/1419623)或[此处](https://stackoverflow.com/questions/2706797)），您可以拥有提交所属的分支：

```
git branch --contains <commit> 
```

# c# - .NET for Windows Store 中的 Thread.Sleep 替换

> ID：12641223
> 
> 赞同：99
> 
> 时间：2012-09-28T13:44:30.537
> 
> 标签：c#, .net, windows-store, windows-store-apps

.NET 似乎不支持 Windows 应用商店应用程序中的[Thread.Sleep 。](http://msdn.microsoft.com/en-us/library/d00bd51t.aspx)

例如，这个

```
System.Threading.Thread.Sleep(1000); 
```

将在针对任何 .NET Framework（2.0、3.5、4.0、4.5）时编译，但在针对 Windows 应用商店应用程序的 .NET（或在同时针对 4.5 和商店的可移植类库中）时不会编译。

System.Threading.Thread 仍然存在，只是没有 Sleep 方法。

我需要在我的应用程序中延迟几秒钟，有合适的替代品吗？

编辑为什么需要延迟：我的应用程序是一个游戏，延迟是为了让它看起来像计算机对手正在“考虑”他的下一步行动。该方法已经被异步调用（主线程没有被阻塞），我只是想减慢响应时间。

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2012-09-28T13:48:39.827

Windows 应用商店应用程序包含异步 - 并且“异步暂停”由[`Task.Delay`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.delay.aspx). 所以在异步方法中，你会写：

```
await Task.Delay(TimeSpan.FromSeconds(30)); 
```

...或任何你想要的延迟。异步方法将在 30 秒后继续，但线程*不会*被阻塞，就像所有`await`表达式一样。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2014-11-03T19:23:16.660

讨厌说明显的，但万一有人想要一条线`System.Threading.Tasks.Task.Delay(3000).Wait()`

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-05-04T12:29:47.223

我刚刚遇到了同样的问题，并找到了另一个有趣的解决方案，我想与您分享。如果您真的想阻止线程，我会这样做（感谢@Brannon 的“苗条”提示）：

```
// `waitHandle.Set` is never called, so we wait always until the timeout occurs
using (var waitHandle = new ManualResetEventSlim(initialState: false))
{
    waitHandle.Wait(TimeSpan.FromSeconds(5));
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-10-08T20:41:30.233

**MainPage.xaml.cs**

```
public MainPage()
{
  this.InitializeComponent();
  this.WaitForFiveSeconds();
}

private async void WaitForFiveSeconds()
{
  await System.Threading.Tasks.Task.Delay(TimeSpan.FromSeconds(5));
  // do something after 5 seconds!
} 
```

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2012-09-28T13:48:34.343

几乎没有理由（除了测试目的）使用`Thread.Sleep()`.

如果（且仅当）您有充分的理由将线程发送到睡眠状态，您可能需要检查`Task.Delay()`，您可以等待“等待”指定时间。尽管让线程闲置而不做任何事情从来都不是一个好主意。坏习惯...

# makefile - 获取规则依赖项的 Makefile 技巧

> ID：12641225
> 
> 赞同：3
> 
> 时间：2012-09-28T13:44:31.877
> 
> 标签：makefile, gnu-make

GNU Makefiles 中是否有任何技巧来获取规则的所有依赖项？

例子：

```
rule1:  dep1_1 dep1_2 dep1_3

rule2:  dep2_1 dep2_2 rule1

dump_deps:
    echo "Dependencies of rule1: $(call do_the_trick, $(rule1))"
    echo "Dependencies of rule2: $(call do_the_trick, $(rule2))"

install:   $(prefix install-,$(call do_the_trick, $(rule1))) 
```

我希望能够打电话来`make dump_deps`看看：

```
dep1_1 dep1_2 dep1_3
dep2_1 dep2_2 dep1_1 dep1_2 dep1_3 
```

或者自动安装依赖项之类的`make install`东西。

可能吗？

* * *

编辑：

我更改了示例以更好地表明我想要一些自动的东西，而不必自己硬编码依赖项列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-08T18:23:18.847

您无法显示*传递*依赖关系，只能显示直接依赖关系，但是，您*可以*获取下面生成的输出并将其输入程序[`dot`](http://en.wikipedia.org/wiki/DOT_%28graph_description_language%29)（的一部分 [`graphviz`](http://en.wikipedia.org/wiki/Graphviz)）以理解这些传递关系。

**编辑：**我想你也可以用其他方式对结果进行后处理以列出部门，但我认为漂亮的图片更好；如果您不同意，请随时投反对票；）

这是一个示例生成文件（在 c&p 时注意丢失的选项卡！）：

```
# Makefile that demonstrates how to dump dependencies.
# The macros we use for compiling stuff.
CC_OBJ=$(CC) -o $@ -c $(CFLAGS) $<
CC_BIN=$(CC) -o $@ $(CFLAGS) $(LDFLAGS) $^

# If we get "DUMP_DEPS=1 DUMP_DOT=1" on the command line, then instead of
# make-style dependencies, we'll output 'dot' syntax.
# Note: normally, DUMP_DOT_TAIL is undefined, so it doesn't generate any noise.
ifeq ($(DUMP_DOT),1)
DUMP_DOT_HEAD=digraph dependencies {
DUMP_DOT_TAIL=@echo "}"
$(info $(DUMP_DOT_HEAD))
list_dep=@for f in $^; do echo "    \"$@\" -> \"$$f\";"; done
else 
list_dep=@echo "$@: $^"
endif

# If we get "DUMP_DEPS=1" on the command line, then
# instead of building the code, just print the dependencies.
ifeq ($(DUMP_DEPS),1)
CC_OBJ=$(list_dep)
CC_BIN=$(list_dep)
endif

# An implicit rule that builds *.c -> *.o.
%.o:%.c
    $(CC_OBJ)

# Variables for stuff we wanna build.
target=hello

objects=main.o
objects+=stuff.o
objects+=yeah.o

# The top-level 'all' target.
.PHONY: all
all: $(target)
    $(DUMP_DOT_TAIL)

# Builds our final executable
$(target): $(objects)
    $(CC_BIN)

# A standard clean target.
.PHONY: clean
clean:
    -rm -f $(target) $(objects) 
```

现在，您可以这样做：

```
make -B DUMP_DEPS=1 
```

它将通过并列出您的所有先决条件是制作“目标：先决条件”的风格。示例输出：

正常运行：

```
cc -o main.o -c  main.c
cc -o stuff.o -c  stuff.c
cc -o yeah.o -c  yeah.c
cc -o hello  main.o stuff.o yeah.o 
```

与`make -B DUMP_DEPS=1`：

```
main.o: main.c
stuff.o: stuff.c
yeah.o: yeah.c
hello: main.o stuff.o yeah.o 
```

与`make -B DUMP_DEPS=1 DUMP_DOT=1`：

```
digraph dependencies {
    "main.o" -> "main.c";
    "stuff.o" -> "stuff.c";
    "yeah.o" -> "yeah.c";
    "hello" -> "main.o";
    "hello" -> "stuff.o";
    "hello" -> "yeah.o";
} 
```

然后，您可以运行以下命令将漂亮的图片输出到 SVG 图像：

```
make -B DUMP_DEPS=1 DUMP_DOT=1 | dot -Tsvg > deps.svg 
```

这是它的样子（这实际上是一个 png，用 生成`-Tpng > deps.png`）：

![图片](../Images/c39462129fb718b895e6e7fe4a0a0373.png)

我认为这需要一些额外的工作才能在所有情况下产生准确的结果，但原则是合理的（例如，如果您使用 gcc 生成的依赖文件，则需要先创建它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:55:35.657

这应该列出所有依赖项：

```
DEPEND = dep1 dep2 dep3

.PHONY: $(DEPEND)

dump_deps: $(DEPEND)
     @printf "%s\n" $^ 
```

您应该根据需要删除带有 .PHONY 目标的行。它用于示例。请注意，在行首和 printf 之间有一个制表符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-24T01:25:00.833

使用 make 实用程序可用的 buit in 变量 $^ - 这表示规则的所有依赖项。

还通过您的代码查看，我确实将 rule1 变成了变量/宏形式以适合我的目的......

```
rule1 := dep1 dep2 dep3 
```

# java - 如何更新 mongo 中的嵌入文档？

> ID：12641227
> 
> 赞同：1
> 
> 时间：2012-09-28T13:44:40.817
> 
> 标签：java, mongodb

我在 mongo db 中有以下文档。

```
 { "_id" : ObjectId("50656f33a4e82d3f98291eff"), 
     "description" : "gdfgdfgdfg",
     "menus" : [    
               {    
                 "name" : "gdfgdfgdfg",     
                  "description" : "dfgdgd",     
                  "text" : "dfgdfg",    
                  "key" : "2",  
                  "onSelect" : "yyy",   
                  "_id" : ObjectId("50656f3ca4e82d3f98291f00") 
              }, 
               {    
                 "name" : "rtytry",     
                  "description" : "gffhf",  
                  "text" : "dfgdfg",    
                  "key" : "2",  
                  "onSelect" : "yyy",   
                  "_id" : ObjectId("50656f3ca4e82d3f98281f00") 
              }],
      "select":"ffdfgd"
   } 
```

我想做菜单的自动更新{
“name”：“gdfgdfgdfg”，
“description”：“dfgdgd”，
“text”：“dfgdfg”，
“key”：“2”，
“onSelect”：“yyy”，
“ _id" : ObjectId("50656f3ca4e82d3f98291f00") }

我尝试使用以下代码：

```
 BasicDBObject query = new BasicDBObject("_id", new ObjectId("50656f33a4e82d3f98291eff"));

         BasicDBObject update = new BasicDBObject("_id", ObjectId("50656f3ca4e82d3f98291f00"));

         BasicDBObject updateCommand = new BasicDBObject("$set", new BasicDBObject("menus", update));

         collection.update(query, updateCommand); 
```

我得到的结果是

```
 { "_id" : ObjectId("50656f33a4e82d3f98291eff"), 
 "description" : "gdfgdfgdfg",
 "menus" :    
           {    
             "name" : "gdfgdfgdfg",     
              "description" : "dfgdgd",     
              "text" : "dfgdfg",    
              "key" : "2",  
              "onSelect" : "yyy",   
              "_id" : ObjectId("50656f3ca4e82d3f98291f00") 
          },
  "select":"ffdfgd" 
```

}

但我想在同一个嵌入式文档中更新。

任何人指导我....提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:05:46.063

好的 在不得不读了几次之后（英语......）我想我现在明白了。

您想要使用 _id 来更新子文档`50656f3ca4e82d3f98291f00`：

```
{
"name" : "gdfgdfgdfg",
"description" : "dfgdgd",
"text" : "dfgdfg",
"key" : "2",
"onSelect" : "yyy",
"_id" : ObjectId("50656f3ca4e82d3f98291f00") 
} 
```

您遇到的第一个问题是您的代码仅将`menus`字段设置为该对象。您需要的是位置运算符。所以你需要做一个点符号find（警告我的Java有点生疏）：

```
query.append("menus._id", new ObjectId("50656f3ca4e82d3f98291f00")); 
```

然后使用该位置运算符更新位置：

```
BasicDBObject update_document = new BasicDBObject("menus.$.name", my_new_subdocument.name);
update_document.append("menus.$.description", my_new_subdocument.description);
// All the other fields

BasicDBObject updateCommand = new BasicDBObject("$set", update_document); 
```

希望这应该可以解决问题。

# iphone - UITableView 中的分隔单元格

> ID：12641233
> 
> 赞同：0
> 
> 时间：2012-09-28T13:44:55.443
> 
> 标签：iphone, uitableview, distance, cells

我想`UITableView`在分隔的部分中显示单元格（它们之间有距离、空格）。

所以我想出了这个：

InventoryViewController.m

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 1;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return [[[InventoryStore sharedInventory] allInventories] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    Inventory *p = [[[InventoryStore sharedInventory] allInventories]
                  objectAtIndex:[indexPath section]];

    StepperCell *cell = [tableView
                         dequeueReusableCellWithIdentifier:@"StepperCell"];

    [cell setController:self];
    [cell setTableView:tableView];

    [[cell nameLabel] setText:[p inventoryName]];
    [[cell valueLabel] setText:
     [NSString stringWithFormat:@"$%d", [p value]]];
    [[cell quantityLabel] setText:
     [NSString stringWithFormat:@"%d", [p quantity]]];
    cell.stepper.value = [p quantity];

    return cell;
} 
```

当然在 AppDelegate.m

```
InventoryViewController *inventoryViewController = [[InventoryViewController alloc] initWithStyle:UITableViewStyleGrouped]; 
```

我的问题是，有没有更好或更简单的方法来分隔单元格，但在同一部分？我想要一个部分，并从一个数组中提取数据，但是这些单元格之间应该有距离。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:58:35.490

如果表格有空白分隔符（即 separatorStyle 设置为 UITableViewCellSeparatorStyleNone），那么您可以在每个单元格之间注入空白单元格。

例如

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
 if (indexPath.row % 2) {
 /* Your cell rendering code goes here */
 }
 else {
  UITableViewCell * blankCell = ....;
 }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return (numberOfInventoryItems * 2) - 1;
} 
```

# c - C struct 仅在存在带有声明性方法的 printf 时才有效

> ID：12641241
> 
> 赞同：-1
> 
> 时间：2012-09-28T13:45:33.987
> 
> 标签：c, pointers, struct, printf

假设我在 temp.h 中声明了一个结构，如下所示：

```
/* physical memory */
typedef struct pmem_struct {
 uint32_t val;
} pmem_s, *pmem_p; 
```

假设我在我的 temp.c 文件中的方法 pmem_p pmem_new() 中声明了这个结构，如下所示：

```
 pmem_p pmem_new() {
  pmem_s pmems;
  pmem_p pmem = &pmems;
  pmem->val = 0;
  //printf(stderr, "From Mem: %x\n", pmem->val);
  return pmem;
} 
```

现在这是我的 main.c 文件：

```
#include <stdio.h>

#include "temp.h"
#include "gen.h"

int main() {
    pmem_p pmem = pmem_new(); /* create some physical memory */
    fprintf(stderr, "From Mem: %x\n", pmem->val);
......
} 
```

为什么这个 fprintf 会打印出**From Mem: 4019cff4**，除非我取消注释 pmem_new() 中的 fprintf 行，两者都正确打印出**From Mem:0**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T13:48:12.580

因为退出`pmem`后不再指向有效的内存区域。`pmem_new()`您看到的是未定义的行为。

```
 pmem_p pmem_new() {
  pmem_s pmems;
  pmem_p pmem = &pmems;
  pmem->val = 0;
  //printf(stderr, "From Mem: %x\n", pmem->val);
  return pmem;
} 
```

`pmems`在这里，您在函数范围内的“堆栈”上进行分配`pmem_new()`。使用“堆栈分配”，一旦程序离开周围的范围，内存将变得无效。因此，指针在离开函数后`pmems`会变成**[悬空指针](http://en.wikipedia.org/wiki/Dangling_pointer#Cause_of_dangling_pointers)**`pmem_new()`。

您可以通过在“堆”上分配内存来解决它，除非您手动这样做，否则内存不会被破坏。在 C 中，这是通过以下`malloc`方法完成的：

```
pmem_p pmem_new_correct() {
  pmem_p pmem = malloc(sizeof(*pmem));
  pmem->val = 0;
  return pmem;
} 
```

但是你必须记住释放这个指针，否则你会造成[内存泄漏](http://en.wikipedia.org/wiki/Memory_leak)。

```
int main() {
  pmem_p pmem = pmem_new();
  fprintf(stderr, "From Mem: %x\n", pmem->val);
  ......
  free(pmem);
} 
```

（另请参阅[堆栈和堆是什么以及在哪里？](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap)堆栈与堆。）

# asp.net - 带有附加字段的 asp.net MVC 注册视图

> ID：12641244
> 
> 赞同：0
> 
> 时间：2012-09-28T13:45:45.323
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

我有一个注册视图 - 只有“管理员”角色的人才能创建新用户。我正在使用标准的 VS2012 注册视图 - 但我还想添加一个下拉列表，以允许管理员选择新用户所属的角色。

当表单被回发时，使用控制器 Register(RegisterModel 模型) - 我如何使用选定的角色获取下拉列表并在此处填充：

```
Roles.AddUserToRole(model.UserName, XXXXXXXXXX); 
```

看法：

```
 <fieldset>
    <legend>Registration Form</legend>
    <ol>
        <li>
            @Html.LabelFor(m => m.UserName)
            @Html.TextBoxFor(m => m.UserName)
        </li>
        <li>
            @Html.LabelFor(m => m.Email)
            @Html.TextBoxFor(m => m.Email)
        </li>
        <li>
            @Html.LabelFor(m => m.Password)
            @Html.PasswordFor(m => m.Password)
        </li>
        <li>
            @Html.LabelFor(m => m.ConfirmPassword)
            @Html.PasswordFor(m => m.ConfirmPassword)
        </li>
        <li>
            Type of user:
            @Html.DropDownList("roleName")
        </li>

    </ol>
    <input type="submit" value="Register" />
</fieldset> 
```

控制器：

```
 //
    // POST: /Account/Register

    [Authorize(Roles = "admin")]
    [HttpPost]
    public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {
            // Attempt to register the user
            MembershipCreateStatus createStatus;
            Membership.CreateUser(model.UserName, model.Password, model.Email, passwordQuestion: null, passwordAnswer: null, isApproved: true, providerUserKey: null, status: out createStatus);

            if (createStatus == MembershipCreateStatus.Success)
            {
                // Add user to selected role
                Roles.AddUserToRole(model.UserName, XXXXXXXXXX);
                // Don't want to login the user - as "admin" is creating this user
                // FormsAuthentication.SetAuthCookie(model.UserName, createPersistentCookie: false);
                //ViewBag.created = "yes";
                return RedirectToAction("UserList","Account");
            }
            else
            {
                ModelState.AddModelError("", ErrorCodeToString(createStatus));
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
```

谢谢，

标记

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T13:51:42.463

感到沮丧 - 休息一下 - 然后回来：

```
Roles.AddUserToRole(model.UserName, Request.Form["roleName"]); 
```

回答问题 - 休息一下！

谢谢，马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:55:27.110

```
 <li>
        Type of user:
        @Html.DropDownListFor( x => x.roleName, new { List = new LookupUtils.AvailableRolesList(Model.UserId), "Value", "Text", Model.roleName })
    </li> 
```

LookupUtils 是一个静态类有：

```
 public static List<SelectListItem> AvailableRolesList( int UserId )
    {
        var dataContext = new YourDataContext(  );
        var data = dataContext.GetRolesForUserFn( UserId ).ToList();

        var result = ( from res in data
                       select new SelectListItem()
                                  {
                                      Text = res.RoleName,
                                      Value = res.RoleId.ToString()
                                  } ).ToList();

        return result;
    } 
```

# java - 如何使用java从xml（DOM）的多级标签中读取特定元素

> ID：12641246
> 
> 赞同：0
> 
> 时间：2012-09-28T13:45:47.110
> 
> 标签：java, xml, dom, xml-parsing

我想使用 java 从 xml(DOM) 读取多级标签，示例 xml 是：

```
<根>
     <子类>
         <子类>
             <子类>
                 <name>测试1</name>
                 <地址>地址1</地址>
              </子类>
               <name>测试2</name>
               <地址>地址2</地址>
         </子类>
         <name>test3</name>
         <地址>地址3</地址>
     </子类>
 </root>
```

如何从上面的xml中读取<name> **test2** </name>和<address> **address2 </address>？**

我已经给出了一个示例代码..但我需要动态查找值。当我使用子类标记迭代 bu 时，它会提供所有数据。只是我想知道如何获取特定数据，例如 <name> **test2** </name> 和 <address> **address2** </address> 。

下面是我的 java 代码，它正在读取上面的 xml：

```
NodeList fList = firstWordElement
                        .getElementsByTagName("root");
                for (int i = 0; i < fList.getLength(); i++) {
                    Node firstFLNode = fList.item(i);
                    if (firstFLNode.getNodeType() == Node.ELEMENT_NODE) {
                        Element firstWdElement = (Element) firstFLNode;
                        NodeList firstWdList = firstWdElement.getElementsByTagName("innerclass");

                        for (int j = 0; j < firstWdList.getLength(); j++) {

                            Element firstWd1Element = (Element) firstWdList.item(j);

                            if (firstWd1Element.getNodeType() == Node.ELEMENT_NODE) {
                                String InnerName = ParseUtil.getTagValue("name", firstWd1Element);
                                String InnerFormat = ParseUtil.getTagValue("format", firstWd1Element);
                                String InnerDescription = ParseUtil.getTagValue("description", firstWd1Element);

                                NodeList innerClassList = firstWd1Element.getElementsByTagName("subclass");

                                for (int k = 0; k < innerClassList.getLength(); k++) {

                                    Element subClassElement = (Element) innerClassList
                                            .item(k);
                                    if (subClassElement.getNodeType() == Node.ELEMENT_NODE) {
                                        String InnerSubName = ParseUtil.getTagValue("name", subClassElement);
                                        System.out.println("Innername==="+ InnerSubName);
                                        String InnerSubFormat = ParseUtil.getTagValue("format", subClassElement);
                                        System.out.println("Innerformat==="+ InnerSubFormat);
                                        String InnerSubDescription = ParseUtil.getTagValue("description", subClassElement);
                                        System.out.println("Innerdescription==="+ InnerSubDescription);

                                    }
                                }

                            }

                        }
                    }
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:59:24.073

一种快速的方法是使用 XPath 查询。查看这些教程：

[http://www.ibm.com/developerworks/library/x-javaxpathapi/index.html](http://www.ibm.com/developerworks/library/x-javaxpathapi/index.html)

[http://www.javabeat.net/2009/03/how-to-query-xml-using-xpath/](http://www.javabeat.net/2009/03/how-to-query-xml-using-xpath/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:00:19.247

传统上，您必须遍历节点，通常通过从父节点使用 getChildren() 创建 NodeList 来完成。如果您只想要 test2 -node，您必须执行某种比较 - 您不能直接跳转到第二个节点。也就是说你可以，但这不会是一个非常健壮或可扩展的解决方案。

# excel - 多个 VLOOKUP LOOKUP IF 语句？

> ID：12641248
> 
> 赞同：-1
> 
> 时间：2012-09-28T13:46:00.397
> 
> 标签：excel, excel-formula, lookup

我有下表。
我需要做的是有一个 VLOOKUP/LOOKUP 语句，它在“比较”下查看月份，并告诉我该月份是否包含在“月份”列下，如果是，则查看已发送和已付款。如果两列都有 Yes 则返回 Yes，否则返回 Paid 列中的值。

但是，它确实需要检查是否说 2 月 1 日在月份之间，所以在这个例子中，如果 2 月 1 日在 1 月 1 日和 3 月之间，请使用 1 月的数据。目前我正在使用 VLOOKUP 和 LOOKUP 的组合：

```
=VLOOKUP(LOOKUP(I21,$L$4:$L$15),$L$4:$Q$15,6,FALSE) 
```

I21 是“比较”月份，L4-L15 是“月份”列，L4-Q15 是到 Sent 的完整范围，6 是 Sent 列。目前我不包括我需要做的付费列，如上所述。

```
 Month          Sent?          Paid?
  1st Jan        Yes            Yes
  1st Mar        Yes            No
  1st Jun        No             No
  1st Oct        N/A            N/A

 Compare
 1st Jan
 1st Feb
 1st Mar
 ...
 1st Jun 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:50:38.417

这个答案依赖于这些假设：

1.  `Month`和`Compare`值输入为`DateSerial`数字（不是字符串）
2.  `Month`数据按升序排序（如您的示例数据）
3.  你还没有说在哪一列`Paid?`。我假设`R`

将此公式放在中间单元格中（假设`A2`此示例）

```
=MATCH(I21,$L$4:$L$7,1) 
```

这将返回`Month`小于或等于该`Compare`值的最大值的索引。所以对于`1 Feb`索引是`1 Jan`

放置此公式以获得所需的结果

```
=IF(AND(INDEX($Q$4:$Q$7,A2)="Yes",INDEX($R$4:$R$7,A2)="Yes"),"Yes",INDEX($R$4:$R$7,A2)) 
```

# r - stat_bin2d 根据成功率填充

> ID：12641249
> 
> 赞同：5
> 
> 时间：2012-09-28T13:46:03.030
> 
> 标签：r, plot, ggplot2, histogram

我有一个包含以下数据的表：

```
> head(sweet)
  interval  urgency success
1     3138      761       1
2     3210     2189       1
3     3243     1256       1
4     8776      823       1
5     3094     1405       1
6     3137     1062       1 
```

Success 取值 0 和 1。我正在寻找不同紧急值的成功率，所以我画了一个这样的直方图：

```
ggplot(sweet, aes(x=urgency, fill=success==0)) + geom_histogram(position='fill') 
```

![情节1](../Images/38ef3044d60f4a0f1e44fba70585fbe3.png)

现在我想看看紧迫性和间隔组合的成功率，但类似的方法无济于事：

```
ggplot(sweet, aes(x=urgency, y=interval, fill=success==0)) + geom_bin2d() 
```

![情节2](../Images/cc5c6b709133179b3d5c5278e1e65fec.png)

有没有办法让填充连续显示成功/失败的比率，而不是二维 bin 图上无用的二进制值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T05:50:27.737

您可以使用`stat_summary2d`：

```
ggplot(sweet, aes(interval, urgency, z = success)) + stat_summary2d() 
```

![在此处输入图像描述](../Images/01fb45fdc9c84e3dc0f603d963eb0391.png)

# android - 安卓：CalendarView OnDateChangeLIsener

> ID：12641250
> 
> 赞同：16
> 
> 时间：2012-09-28T13:46:04.580
> 
> 标签：android, android-calendar

我已经实现了这个监听器，以便在单击某个日期时显示某些内容，但问题是当我向下滚动 CalendarView 时，它会自动显示一些内容但我没有单击任何内容，我只是向下滚动到CalendarView 中的另一个月份，然后是 Toast 或 Log，无论哪个（我想这是有道理的，因为侦听器本身会触发 `onDateChange 并且向下滚动日历也会更改当前选择的日期）。所以我的问题是，CalendarView 是否有任何侦听器，我可能只使用 ondateChange 侦听器的替代方法，以避免当我向下滚动 calendarView 转到另一个月份时它会​​自动触发 lisntener 的情况。

任何知道 CalendarView 的替代侦听器或任何人都知道解决方法的人？请分享

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-25T09:57:13.577

当您滚动时，日历`onSelectedDayChange`方法的行为就像您单击不同的日期一样，但这**不会更改当前日期设置**。所以 HFDO5 是对的，您只需要在创建日历时保存当前日期： `Long date = calendar.getDate();`

并检查它`onSelectedDayChange`。

```
if(callendar.getDate() != date){
date = calendar.getDate(); //new current date
//date is changed on real click...do things..

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-20T12:49:03.613

我只是遇到了同样的问题，并找到了解决方法。

创建“长日期”变量，并在您启动日历窗口时将当前日期保存在此变量中。

```
Long date;
cv = (CalendarView)findViewById(R.id.calendarView1);
date = cv.getDate(); 
```

现在在监听器中检查新日期是否与日历相同：

```
cv.setOnDateChangeListener(new OnDateChangeListener(){
        public void onSelectedDayChange(CalendarView view, int year, int month, int dayOfMonth) {
            if(cv.getDate() != date){
                date = cv.getDate();
                Toast.makeText(view.getContext(), "Year=" + year + " Month=" + month + " Day=" + dayOfMonth, Toast.LENGTH_LONG).show();
            }               
        }
    }); 
```

它对我有用:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-10T17:06:53.460

最后我决定我需要在下方显示一个“确定”按钮，`CalendarView`以便可以选择日期并取消日历。

因为当您单击当前日期时，没有任何反应，而当您滚动时，您会接到`OnDateChangeListener`.

带有黑色蒙版背景的日历布局示例，您可以单击以关闭：

```
<LinearLayout
    android:id="@+id/calendar_layout"
    android:onClick="dismissCalendar"
    android:visibility="gone"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="20dp"
    android:background="@color/black_mask">

    <CalendarView
        android:id="@+id/calendar"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:background="@color/white"
        android:showWeekNumber="false"
        android:firstDayOfWeek="2"
        />

    <TextView
        android:onClick="selectDate"
        android:text="@string/select_date"
        android:background="@color/colorPrimary"
        style="@style/settings_button"/>

</LinearLayout> 
```

然后示例代码：

```
private void openCalendar(Date date) {
    calendar.setDate(date.getTime());
    calendarLayout.setVisibility(View.VISIBLE);
}

public void selectDate(View view) {
    Date date = new Date(calendar.getDate());
    // do whatever you need with date
    dismissCalendar(view);
}

public void dismissCalendar(View view) {
    calendarLayout.setVisibility(View.INVISIBLE);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T12:49:46.657

我解决这个问题的方法是使用 HoloEverywhere 中的日历（可用于自定义的源代码），注释掉导致调用它的代码并在 onDateTapped 方法中调用它，这是预期的事情。它也适用于 ICS 之前的设备。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-08-19T19:41:46.123

也许我对以前问题的解决方案会给你一些想法。当我从日历视图中选择一个日期时，会显示一个谷歌地图，其中显示了我为该日期步行的路线。因为纬度和经度是从数据库中检索的，所以我在数据库中查询该日期，如果没有记录，应用程序会弹出一条 toast 消息。否则，它会显示带有路线的谷歌地图。

# php - 在wordpress中为“for each”循环添加分页

> ID：12641251
> 
> 赞同：0
> 
> 时间：2012-09-28T13:46:21.130
> 
> 标签：php, wordpress, pagination

我只是想知道是否可以在 wordpress`pagination_links()`的循环中使用该函数？`foreach`当我尝试它时没有任何反应，我环顾四周，似乎这比我预期的要复杂一些......

```
<?php
$args = array( 'numberposts' => 6, 'post_status'=>"publish",'post_type'=>"post",'orderby'=>"post_date");
$postslist = get_posts( $args );
foreach ($postslist as $post) : setup_postdata($post); ?>
   <div class="events">
        <div class="newslistingblock">
        <div class="newslistingblockheader"><p><a href="<?php the_permalink(); ?>" title="<?php the_title(); ?>"><?php the_title(); ?></a></p>
        </div>
        <div class="newslistingblockthumbnail">
         <?php echo get_the_post_thumbnail( $post_id, 'news-thumb', $attr ); ?> </div>
         <div class="newslistingexcerpt">
                <?php the_excerpt( ); ?> </div> 
  </div>
  </div>

<?php endforeach; ?> 
```

我基本上是在寻找基本的分页，带有“下一个”、“上一个”和数字。

对此的任何帮助将非常感谢。

编辑：我决定将代码更改为适合 wordpress ...

```
 <?php 
query_posts( 'posts_per_page=5' );
if (have_posts()) : 

while (have_posts()) : the_post(); ?>
<!-- Do suff -->

   <div class="events">
        <div class="newslistingblock">
        <div class="newslistingblockheader"><p><a href="<?php the_permalink(); ?>" title="<?php the_title(); ?>"><?php the_title(); ?></a></p>
        </div>
        <div class="newslistingblockthumbnail">
         <?php echo get_the_post_thumbnail( $post_id, 'news-thumb', $attr ); ?> </div>
         <div class="newslistingexcerpt">
                <?php the_excerpt( ); ?> </div> 
  </div>
  </div>
  <?php endwhile; ?> 
   <div class="navigation">
    <div class="alignleft"><?php next_posts_link('← Older Entries') ?></div>
    <div class="alignright"><?php previous_posts_link('Newer Entries →') ?></div>
</div>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:12:47.753

你为什么使用`foreach`而不是`while`？

带有分页的默认循环应该如下所示（也应该与 foreach 一起使用）：

```
<?php if (have_posts()) : while (have_posts()) : the_post(); ?>
    <!-- Do suff -->
<?php endwhile; ?>    
<div class="navigation">
    <div class="alignleft"><?php next_posts_link('← Older Entries') ?></div>
    <div class="alignright"><?php previous_posts_link('Newer Entries →') ?></div>
</div>
<?php endif; ?> 
```

这只是显示`next`和`previous`链接，但如果你想用数字进行分页，我建议使用很棒的插件：[Wp-Pagenavi](http://wordpress.org/extend/plugins/wp-pagenavi/)。

祝你好运！

编辑：

您遇到的错误是您没有正确设置分页变量。您需要执行以下操作：

```
<?php
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

query_posts('posts_per_page=5&paged=' . $paged); 
?> 
```

然后一切都应该工作。

您可以在 codex 中找到更多信息：http: [//codex.wordpress.org/Pagination#Adding_the_.22paged.22_parameter_to_a_query](http://codex.wordpress.org/Pagination#Adding_the_.22paged.22_parameter_to_a_query)

# cakephp - 我的“赞”系统有问题

> ID：12641255
> 
> 赞同：-1
> 
> 时间：2012-09-28T13:46:34.640
> 
> 标签：cakephp, controller

所以，我在我的 CakePHP 项目中添加了一个“Like”系统，但我遇到了一个小问题。当我想添加一个赞时......它根本不会发生。这是我所拥有的：

```
<?php 
  echo $this->Form->create("Like", array("url" => array("controller" => "likes", "action" => "like")));
  echo $this->Form->hidden("user_id",array(
    "value" => AuthComponent::user("id")
  ));
  echo $this->Form->hidden("post_id",array(
    "value" => $post["Post"]["id"]
  ));
  echo $this->Form->end();

  echo $this->Html->link(
    "<li><i class='icon-heart icon-large'></i> ".count($post["Like"])." likes</li>",
    "",
    array("escape" => false, "onclick" => "document.getElementById('LikeViewForm').submit();")
  );
?> 
```

这是控制器：

```
<?php class LikesController extends AppController{

  function like() {
    $user_id = $this->Auth->user("id");
    if(!$user_id){
      $this->redirect("/");
      die();
    }
    if ($this->request->is("post")) {
      $d = $this->request->data;         
      $d["Like"]["id"] = null;
      if($this->Like->save($d,true,array("post_id","user_id"))){
        $this->redirect($this->referer());
      }
    }
  }

} 
```

当我单击链接时，它会正确刷新页面，所以我认为表单已发送，但数据库中没有任何新内容......

有什么猜测吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:57:23.340

对于新记录，您需要`create()`先使用。试试这个：

```
function like() {
    $user_id = $this->Auth->user("id");

    if (!$user_id) {
        $this->redirect("/");
        die();
    }

    if ($this->request->is("post")) {
        $this->Like->create();
        if ($this->Like->save($this->request->data, true, array("post_id", "user_id"))) {
            $this->redirect($this->referer());
        }
    }
} 
```

希望这可以帮助。

# android - Android：软键盘未显示

> ID：12641259
> 
> 赞同：5
> 
> 时间：2012-09-28T13:46:52.850
> 
> 标签：android, android-edittext, android-softkeyboard

我在 MainActivity 布局中有 2 个 EditTexts。如果我正常运行应用程序，第一个 EditText 会获得焦点，但软键盘没有打开。

但是当我使用这个时：

```
public class TestingActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        EditText et1 = (EditText) findViewById(R.id.editText1);
        EditText et2 = (EditText) findViewById(R.id.editText2);

        et2.requestFocus();
        InputMethodManager mInputMethodManager = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
        mInputMethodManager.showSoftInput(et2, InputMethodManager.SHOW_IMPLICIT);
    }
} 
```

期待第二个 EditText 将获得焦点并且软键盘将被打开。

我只获得焦点，但只有当我单击 EditText 时才打开软键盘。

谢谢你

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T13:55:52.550

尝试在文件中为您的活动指定[android:windowSoftInputMode](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft)属性。`AndroidManifest.xml`

例如：

```
<activity android:name=".TestingActivity" android:windowSoftInputMode="stateVisible|adjustResize" /> 
```

您可能不需要`InputMethodManager`Activity 中使用的任何代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-23T07:19:37.927

我注意到键盘未显示的一个原因是选择了特定 Android 设备不支持的输入类型。例如 InputType.TYPE_NUMBER_VARIATION_NORMAL 在我的 Asus Transformer 上不起作用（没有键盘显示），而 InputType.TYPE_CLASS_NUMBER 可以正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-27T12:02:03.033

```
 et2.clearFocus();
    et2.requestFocus();
    InputMethodManager mInputMethodManager = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
    mInputMethodManager.showSoftInput(et2, InputMethodManager.SHOW_IMPLICIT); 
```

我在 Android N 平台上遇到了这个问题，并通过重新调整编辑视图来解决它。我不知道应该首先清除编辑视图的真正原因，但它对我来说很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-28T11:13:45.797

有时您需要延迟显示键盘命令，所以在我的情况下，我做了以下

```
editText.postDelayed(new Runnable() {
        @Override
        public void run() {
            InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
    imm.showSoftInput(editText, InputMethodManager.SHOW_IMPLICIT);
        }
    }, 300); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-04-29T09:42:14.077

要获得特定编辑文本的焦点，只需在编辑文本中添加标签。

```
<EditText 
    android:id="@+id/etBox"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:hint="enter into editbox"
    >
    <requestFocus/>
    </EditText> 
```

# jquery - 用 div 填充剩余宽度，没有设置大小

> ID：12641261
> 
> 赞同：0
> 
> 时间：2012-09-28T13:46:57.233
> 
> 标签：jquery, css

我见过几个这样的问题，但没有一个特别适合我的情况。我有一个标签式导航，它可以根据添加到导航中的标签数量来调整大小。然后，我有第二个区域，其中包含我想填充剩余区域的电话号码区域，从右侧延伸到左侧填充空间。

我不知道这两个物体的宽度。我对此最接近的解决方案是将导航向左浮动，然后蓝色区域在导航后面扩展，这不是我想要的，因为我希望仍然能够看到选项卡间隙之间的背景。我试过桌子，但无法让它工作。要么它只给蓝色区域它的宽度，然后给导航其余部分而不填充中间的空间，或者在另一种配置中，它会将包含表的大小折叠到组合的 2 个元素的宽度而不填充完整的 960 像素宽度。

![可变宽度填充](../Images/db7c9708a4a43832084b7527f27cbfbb.png)

理想情况下，我很想找到一个 CSS 解决方案，但我并不反对 JS 或 jQuery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:02:16.463

假设您的导航选项卡是浮动的，添加`overflow: hidden;`到深蓝色`div`（您想要占用剩余宽度的选项卡）就足够了。

小演示：[小链接](http://jsfiddle.net/glee/6Cavr/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:54:11.353

不应该`width: 100%`做的伎俩？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:08:44.960

jsfiddle上的工作代码[here](http://jsfiddle.net/Yaw57/11/)

```
<div class="base">
    <div class="menu">
        <ul>
            <li>Hello</li>
            <li>Hello</li>
        </ul>
    </div>
    <div class="extra">
        Hello is nothing but Hello
    </div>
    <br clear="all"/>
</div> 
```

CSS：

```
.base{
   width:100%;
   background:#c00;
   color:#fff;
   padding-top:15px;    
}
.menu{
    float:left;
}
.menu ul li{
    float:left;
    margin-left:5px;
    margin-right:5px;
    background:#000;
    padding:3px;
    border-radius:8px 8px 0px 0px;

}
.extra{
   float:right;
} 
```

# java - 写入一些数据后无法删除文件，哪里出错了？

> ID：12641262
> 
> 赞同：0
> 
> 时间：2012-09-28T13:47:00.323
> 
> 标签：java, file, file-io, delete-file

我正在写一些文本文件然后删除它，但删除失败。

代码非常简单：

```
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;

public class TestFile {

    public static void main(String[] args) throws IOException {
        File file = new File("c:\\abc.txt");
        writeFile(file, "hello");

        // delete the file
        boolean deleted = file.delete();
        System.out.println("Deleted? " + deleted);

    }

    public static void writeFile(File file, String content) throws IOException {
        OutputStream out = null;
        try {
            out = new FileOutputStream(file);
            out.write(content.getBytes("UTF-8"));
        } catch (IOException e) {
            try {
                out.close();
            } catch (IOException e1) {
                // ignored
            }
        }
    }
} 
```

输出是：

```
Deleted? false 
```

并且有一个文件`abc.txt`包含`hello`在`c:`.

然后我改用`FileUtils.writeStringToFile(...)`from `commons-io.jar`，文件将被删除。

但我不知道我的代码哪里出了问题，请帮我找出来。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T13:51:17.927

只有在收到 IOException 时才关闭文件。

将其更改为`finally`块，您将能够关闭和删除该文件。

```
public static void writeFile(File file, String content) throws IOException {
    OutputStream out = new FileOutputStream(file);
    try {
        out.write(content.getBytes("UTF-8"));
    } finally {
        try {
            out.close();
        } catch (IOException ignored) {
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:52:22.250

看看`FileUtils.writeStringToFile()`你没有做什么。

```
public static void writeStringToFile(File file, String data, String encoding) throws IOException {
    OutputStream out = new java.io.FileOutputStream(file);
    try {
        out.write(data.getBytes(encoding));
    } finally {
        IOUtils.closeQuietly(out);
    }
} 
```

您会注意到`out`流*始终*是关闭的，而在您的示例中，只有在抛出异常时它才会在您的`catch`块中关闭。`write()`

在 Windows 上，不能删除任何程序打开的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T13:51:22.470

如果发生异常，您只需删除文件。每次打开文件后，您都需要这样做。您可能希望将 close 放入 finally 块中。

如果您使用的是 Java 7，我考虑使用 try-with-ressources 块，它会为您关闭文件。

```
try (BufferedReader br = new BufferedReader(new FileReader(path))) 
{
    return br.readLine();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T13:51:28.110

在你的主要方法中，

```
 public static void main(String[] args) throws IOException {
        File file = new File("c:\\abc.txt");
        writeFile(file, "hello");

        // delete the file
        boolean deleted = file.delete();
        System.out.println("Deleted? " + deleted);

    } 
```

您打开文件，写入文件，然后不要关闭它。Java 会为您打开文件，因此如果您想向其中添加更多信息，您可以。但是，为了能够删除该文件，您需要确保没有其他引用对其打开。您可以通过使用 file.close() 关闭 Java 为您保留的文件句柄来执行此操作。

最好的做法是在完成后始终关闭流，尤其是在向其中添加数据的情况下。否则，您可能会遇到意外打开文件的情况，或者在极端情况下会丢失您认为已经保存的数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-28T13:49:56.697

完成文件写入后，您需要关闭 OutputStream。

```
try {
        out = new FileOutputStream(file);
        out.write(content.getBytes("UTF-8"));
        out.close();
    } catch (IOException e) {
        try {
            out.close();
        } catch (IOException e1) {
            // ignored
        }
    } 
```

# vb.net - SSRS 解密数据库列抛出错误“值不能为空。参数名称：inputBuffer”

> ID：12641266
> 
> 赞同：2
> 
> 时间：2012-09-28T13:47:13.197
> 
> 标签：vb.net, encryption, cryptography, reporting-services, streamreader

我们有一个使用实体框架在 C# MVC 应用程序中加密的数据库字段。该部分适用于加密和解密。我们需要在 SSRS 报告中显示解密的数据。

我采用了 Decrypt 方法并将其转换为 VB.Net 并放置在报告后面的代码中。调用`StreamReader`'s`ReadToEnd`方法时发生错误。我们在网上找到了一些关于在尝试关闭已经关闭的流时出现问题的参考资料。此流仅被读取一次，我们正在读取整个流，因此此时不应关闭它。

我尝试`Length - 1`从 cryptoStream 读取字节，但没有引发错误。如果我尝试读取`Length`字节，我会得到同样的错误。如果我只读取一个字节，然后只读取最后一个字节，我会得到同样的错误。堆栈跟踪和代码如下。任何帮助将不胜感激。

* * *

堆栈跟踪：

```
 at System.Security.Cryptography.RijndaelManagedTransform.TransformFinalBlock(Byte[] inputBuffer, Int32 inputOffset, Int32 inputCount)
   at System.Security.Cryptography.CryptoStream.FlushFinalBlock()
   at System.Security.Cryptography.CryptoStream.Dispose(Boolean disposing)
   at System.IO.Stream.Close()
   at System.IO.Stream.Dispose()
   at ReportExprHostImpl.CustomCodeProxy.Decrypt(String ciphertext) 
```

* * *

代码：

```
public function Decrypt(byval ciphertext as string) as string
  dim message as string
  dim key as string
  dim saltSize as integer
  saltsize = 32
  key = "KEYGOESHERE"

  dim allTheBytes as byte()
  allTheBytes = Convert.FromBase64String(ciphertext)

  dim saltBytes as byte()
  saltBytes = new byte(saltsize) {}

  dim ciphertextBytes as byte()
  ciphertextBytes = new byte(allTheBytes.Length - saltSize) {}

  dim i as integer
  for i = 0 to saltsize - 1
    saltBytes(i) = allTheBytes(i)
  next i

  for i = saltSize to (allTheBytes.Length - 1)
    ciphertextBytes(i - saltSize) = allTheBytes(i)
  next i

  try
    using keyDerivationFunction as System.Security.Cryptography.Rfc2898DeriveBytes = new System.Security.Cryptography.Rfc2898DeriveBytes(key, saltBytes)
      dim keyBytes as byte()
      keyBytes = keyDerivationFunction.GetBytes(32)
      dim ivBytes as byte()
      ivBytes = keyDerivationFunction.GetBytes(16)

      using aesManaged as System.Security.Cryptography.AesManaged = new System.Security.Cryptography.AesManaged()
        aesManaged.Padding = System.Security.Cryptography.PaddingMode.PKCS7
        aesManaged.Mode = System.Security.Cryptography.CipherMode.CBC

        using decryptor as System.Security.Cryptography.ICryptoTransform = aesManaged.CreateDecryptor(keyBytes, ivBytes)
          using memoryStream as System.IO.MemoryStream = new System.IO.MemoryStream(ciphertextBytes)
            using cryptoStream as System.Security.Cryptography.CryptoStream = new System.Security.Cryptography.CryptoStream(memoryStream, decryptor, System.Security.Cryptography.CryptoStreamMode.Read)
              using streamReader as System.IO.StreamReader = new System.IO.StreamReader(cryptoStream)
                message = streamReader.ReadToEnd()
                return message
              end using
            end using
          end using
        end using
      end using
    end using
  catch e as Exception
    return e.StackTrace
  end try
end function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:44:57.007

这听起来像一个填充错误。首先，CBC 模式下的 AES 需要精确的消息大小才能解密，即块大小的 N 倍（16 字节）。如果消息具有此大小，则 AES CBC 密文*将始终解密*。任何其他问题只能与填充有关。所以发生的情况是最后破译的纯文本没有正确的填充，并且发生异常。

有趣的来了; 在以下情况下会发生此错误：

*   二进制 AES 密钥不相同；
*   如果算法或模式不正确，或者使用了错误的填充算法；
*   如果最后两个块之一被破坏；
*   如果加密的最后一部分在操作中丢失。

换句话说，如果出现问题，它很*可能*会在删除填充字节期间出现。如果运气不好，最后一个不正确的块仍然以`01`十六进制的字节值结尾，并且填充成功，表明填充不能替代完整性保护。

# php - Facebook api打开图发布动作语法错误

> ID：12641267
> 
> 赞同：0
> 
> 时间：2012-09-28T13:47:19.277
> 
> 标签：php, facebook, facebook-opengraph, facebook-apps

我有点失落。

我刚刚在 facebook 中创建了一个操作，我正在尝试在我的应用程序中发布它。

facebook给了我这个代码：

```
curl -F 'access_token=xxx' \
     -F 'gag=http://samples.ogp.me/436800766355204' \
        'https://graph.facebook.com/me/xxx:laugh_at' 
```

当我把它放在我的 php 脚本中时，我得到 Parse error: syntax error, unexpected T_CONSTANT_ENCAPSED_STRING

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:03:36.290

那不是 PHP 代码。它旨在粘贴到命令行中。
我推荐使用[PHP SDK](http://developers.facebook.com/docs/reference/php/)，但我想你可以这样做：

```
<?php
    exec("curl -F 'access_token=xxx' -F 'gag=http://samples.ogp.me/436800766355204' 'https://graph.facebook.com/me/xxx:laugh_at'");
?> 
```

# c# - 在 (Iron)Python 脚本中引用宿主程序集失败

> ID：12641269
> 
> 赞同：4
> 
> 时间：2012-09-28T13:47:35.410
> 
> 标签：c#, ironpython

我目前正在测试 IronPython（我知道一点 C# 和一点 CPython）。现在我想在 Python 脚本中使用我的自定义类。

我有以下项目结构：

```
Solution IPTest
---Project IPTest
------Namespace IPTest
---------Program class (main)
---------Elem class
------Scripts
---------Worker.py 
```

Elem 很简单：

```
public class Elem {
    public string Name;
} 
```

我可以在 .NET 程序中使用 Python 脚本，而不会出现任何问题，例如：

```
ScriptEngine engine = Python.CreateEngine();
ScriptSource source = engine.CreateScriptSourceFromFile("./Scripts/Worker.py");
ScriptScope scope = engine.CreateScope();
source.Execute(scope);
// or var worker = Python.CreateRuntime().UseFile("./Scripts/Worker.py");
dynamic Worker = scope.GetVariable("Worker");
dynamic worker = Worker();
var res1 = worker.add(4, 5); 
```

但是，我不知道如何在 Python 脚本中引用托管程序集。经过一些研究，我尝试了以下方法：

```
import sys
import System
sys.path.append(System.IO.Directory.GetCurrentDirectory()) #make sure assembly dir is  in sys.path
import clr
clr.AddReference(“IPTest.exe”)
# or clr.AddReferenceToFile(r"IPTest.exe")
# or clr.AddReference(r"<fullpath>\IPTest\bin\Debug\IPTest.exe")
# or clr.AddReference(“../IPTest.exe”) #when not adding workingdir to sys.path
from IPTest import Elem
# or from IPTest.IPTest import Elem
# or import Elem 
```

两者都不起作用。我收到两条不同的错误消息：

1.  将 workingdir 添加到 sys.path 或使用相对路径或使用 AddReferenceToFile 时：没有名为 IPTest 的模块
2.  使用绝对路径时：给定的程序集名称或代码库无效。（来自 HRESULT 的异常：0x80131047）

我检查了程序集名称是否真的是 IPTest 并尝试使用 dll 而不是 exe - 尽管它通常应该没有任何区别，而且令人惊讶的是也不起作用。

**免责声明：**[此处](https://stackoverflow.com/questions/1394679/embedding-ironpython-cant-add-reference-to-system)描述的解决方案：

```
engine.Runtime.LoadAssembly(Assembly.GetExecutingAssembly()); //in c#
from IPTest import Elem # in python script 
```

工作得很好。但是我认为它也应该通过在脚本文件中引用来工作（这会更好）。

可能我遗漏了一些明显的东西，但我只是看不到它，所以非常感谢任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:23:44.040

`clr.AddReferenceToFile(r'IPTest.exe')`按照您的错误中所述尝试：

1.  将 workingdir 添加到 sys.path 或使用相对路径或使用**AddReferenceToFile 时：**没有名为 IPTest 的模块

# ruby - 查找/替换非转义字符的更有效方法

> ID：12641271
> 
> 赞同：3
> 
> 时间：2012-09-28T13:47:45.393
> 
> 标签：ruby, regex

我试图找到最好的方法来查找和替换（在 Ruby 1.9.2 中）以**零或偶数个反斜杠开头**的特殊代码 (%x) 的所有实例。

换句话说， ：

```
%x      -->   FOO
\%x     -->   \%x
\\%x    -->   \\FOO
\\\%x   -->   \\\%x
\\\\%x  -->   \\\\FOO
etc. 
```

一个字符串中可能有多个实例：“这是我的 %x 字符串，带有两个 %x 代码。”

[在此处](https://stackoverflow.com/questions/9613522/regex-look-behind-to-avoid-odd-number-of-consecutive-backslashes)和[此处](https://stackoverflow.com/questions/10297907/regex-odd-number-of-occurences-of-a-char)提出的问题的帮助下，我得到了以下代码来做我想做的事情：

```
 str.gsub(/
  (?<!\\)           # Not preceded by a single backslash
  ((?:\\\\)*)       # Eat up any sets of double backslashes - match group 1  
  (%x)              # Match the code itself - match group 2
  /x, 

  # Keep the double backslashes (match group 1) then put in the sub
  "\\1foo") 
```

不过，那个正则表达式似乎有点重量级。由于此代码将在我的应用程序中以合理的频率调用，因此我想确保我不会错过更好（更清洁/更有效）的方法来执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:49:14.087

我可以想象两个替代的正则表达式：

1.  使用后视断言，就像在您的代码中一样。（向后看2）
2.  在反斜杠之前再匹配一个字符。（选择）

除此之外，我只看到您的正则表达式的小优化。"%x" 是常数，因此您不必捕获它。（后视-1）

我不确定其中哪一个实际上更有效。因此，我创建了一个小基准：

```
$ perl
use strict;
use warnings;
use Benchmark qw(cmpthese);

my $test = '%x \%x \\%x \\\%x \\\\%x \\\\\%x \\\\%x \\\%x \\%x \%x %x';

cmpthese 1_000_000, {
    'look-behind-1' => sub { (my $t = $test) =~ s/(?<!\\)((?:\\\\)*)\%x/${1}foo/g },
    'look-behind-2' => sub { (my $t = $test) =~ s/(?<!\\)((?:\\\\)*)(\%x)/${1}foo/g },
    'alternative'   => sub { (my $t = $test) =~ s/((?:^|[^\\])(?:\\\\)*)\%x/${1}foo/g },
}; 
```

结果：

```
 Rate   alternative look-behind-2 look-behind-1
alternative   145349/s            --          -23%          -26%
look-behind-2 188324/s           30%            --           -5%
look-behind-1 197239/s           36%            5%            -- 
```

如您所见，替代正则表达式远远落后于后视方法，捕获“%x”比不捕获它稍慢。

问候， 马蒂亚斯

# android - eclipse中的错误“类型无法解析目标'android-3'”

> ID：12641273
> 
> 赞同：2
> 
> 时间：2012-09-28T13:47:48.133
> 
> 标签：android, eclipse

导入了一个示例项目，尝试运行应用程序但得到错误“类型无法解析目标'android-3'”这是构建路径问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:14:35.060

问题是它正在寻找您尚未下载或未定位的第 3 级 Android API。

*   右键单击您的项目并转到 Properties->Android 并选择您的 API 3 Android 版本。如果您没有此版本，您可以选择您喜欢的任何 API 级别。点击应用就可以了。现在右键单击您的项目并转到 Android 工具 -> 修复项目属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T13:49:44.083

您的 sdk API level-3 中没有这个。下载它或将目标更改为其他。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T13:51:04.740

您是否安装了 Android SDK API 3？据我所知，该错误基本上表明在构建路径中您将其配置为使用 API 3，但您没有安装它。

如果您安装了另一个 API，则另一种方法是配置项目以在构建路径中使用该 API（提供向后兼容性）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-20T07:48:48.493

该项目的目标api尚未设置。您需要从 android 项目属性中设置它们。右键单击项目并选择属性或选择项目并按 ALT + ENTER 键。将打开一个新的属性窗口。然后在属性窗口中选择 Android 并从列表中设置所需的目标 API。应用此设置，您的问题将得到解决。

# flash - 编辑嵌套符号时出现 Flash CS6 性能问题

> ID：12641279
> 
> 赞同：1
> 
> 时间：2012-09-28T13:48:04.697
> 
> 标签：flash, flash-cs6

抱歉，这不是 AS3 问题，但我希望其他经常使用 CS6 的人可以加入：

在使用“就地编辑”（双击符号）编辑嵌套符号时，我注意到 Flash CS6 中的性能显着下降，而使用“编辑”的程度较小。通过嵌套，我指的是符号内的符号，符号内的符号等。我应该尝试优化的嵌套符号的深度是否存在已知限制？画布刷新延迟在 5 个符号深左右是显而易见的，并且可能会变得非常糟糕。我正在使用 CS6 构建我的艺术资产并直接从库中导出精灵表 - FLA 中的任何地方都没有视频、导入的图像或文本，因此发布时的性能不是问题。

我是否使用了太多的嵌套图形符号让 Flash 无法处理？我现在假设 Flash 性能只会随着每个版本的发布而变得更好，而不是更糟。Flash 几乎无法用尽我的 RAM（使用约 450Mb 的 8Gb）、CPU（Core i7 2600）或 GPU（AMD HD-6900）——那是什么？甚至无法在嵌套符号深处使用具有这些滞后问题的 Wacom。

在此先感谢您的任何见解-这有时使我的工作效率停滞不前。

# facebook - Facebook Graph API 获取应用用户的朋友

> ID：12641283
> 
> 赞同：1
> 
> 时间：2012-09-28T13:48:19.700
> 
> 标签：facebook, facebook-graph-api

我一直在使用 Graph API 来获取安装了我的应用程序的用户朋友列表。

使用这个：

```
if ($user) {
  try {
 $friendsapp = $facebook->api('/me/friends?fields=installed');
 } catch (FacebookApiException $e) {
    echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
    $user = null;
 }
} 
```

我刚刚创建了这个应用程序，我只知道我自己和另一个人已经安装了它。当我以用户身份登录时，我会得到一个非常大的朋友列表。关于我做错了什么的任何想法？

作为安装了该应用程序的朋友，我应该只与其他用户一起获得回报。

谢谢！...是的，我是一个将 Facebook 集成到网站的菜鸟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:59:52.223

简单的 FQL 就足够了：

```
SELECT uid FROM user WHERE is_app_user=1 AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T03:15:10.943

这是因为使用 graphi API 会返回您要求的所有对象。指定 fields 参数只是要求 API 专门为返回的所有对象返回该属性。真的没有办法进一步缩小结果范围。另一方面，FQL 是一种查询语言，它允许您使用标准 where 子句等根据自己的喜好缩小结果集的范围。

# actionscript-3 - AS3，Flash - 在某处保存跟踪日志？

> ID：12641284
> 
> 赞同：0
> 
> 时间：2012-09-28T13:48:21.427
> 
> 标签：actionscript-3, flash

是否可以将 Trace 的日志保存在某处，以便我可以查找玩家的踪迹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:53:51.403

是的，但为此您需要一个记录器函数而不是 trace()。顺便说一句，如果您在发布模式下编译您的 SWF，则不会出现任何痕迹。像这样说：

```
private static var COMPLETE_LOG:String='';
public static function log(...args):void {
    var i:int; var s:String='\n';
    for (i=0;i<args.length;i++) {
        if (i>0) s+=' ';
        s+=args[i].toString();
    }
    COMPLETE_LOG+=s;
} 
```

使用 log() 而不是 trace() 来捕获您需要的跟踪。然后说在某处上传 COMPLETE_LOG。

# php - PHP：如何使用 alpha 蒙版为图像创建阴影

> ID：12641290
> 
> 赞同：0
> 
> 时间：2012-09-28T13:48:45.660
> 
> 标签：php, image-processing, gd, alpha-transparency

我有一个带有 alpha 蒙版的 PNG 图像。我想为这个图像生成一个阴影，它会使用 alpha 蒙版。

[一图胜千言 http://www.brunet.fr/alpha.jpg](http://www.brunet.fr/alpha.jpg)

我想我需要：

1.  从第一张图像中获取 alpha 蒙版
2.  用适当的颜色填充它，然后模糊它
3.  创建一个新的空白图像
4.  首先用阴影和第一张图像组合它

但是我在任何地方都找不到一些提示，尤其是第一部分。

[编辑：我在这里](https://stackoverflow.com/questions/7288173/how-can-i-add-a-drop-shadow-to-an-image-using-php)找到了答案的开头，我尝试了一下，让你知道。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:41:34.417

首先，您需要安装名为：[Imagick的 php ext](http://php.net/imagick)

```
<?php 
/* Read the image into the object */ 
$im = new Imagick( 'a.png' ); 
$im->setImageFormat("png"); 

/* Make the image a little smaller, maintain aspect ratio */ 
$im->thumbnailImage( 200, null ); 

/* Clone the current object */ 
$shadow = $im->clone(); 

/* Set image background color to black 
        (this is the color of the shadow) */ 
$shadow->setImageBackgroundColor( new ImagickPixel( 'black' ) ); 

/* Create the shadow */ 
$shadow->shadowImage( 80, 3, 5, 5 ); 

/* Imagick::shadowImage only creates the shadow. 
        That is why the original image is composited over it */ 
$shadow->compositeImage( $im, Imagick::COMPOSITE_OVER, 0, 0 ); 

/* Display the image */ 
header( "Content-Type: image/png" ); 
echo $shadow; 
```

# java - 包含 applicationContext.xml 文件的 Ant jar 任务

> ID：12641292
> 
> 赞同：0
> 
> 时间：2012-09-28T13:48:54.503
> 
> 标签：java, spring, ant

我有一个带有 main 方法的 spring 类。在课堂内我试图读取值 applicationContext.xml 。我的意图是将这个主类连同它的依赖 jars、属性文件和 applicationContext.xml 一起打包。因此我的目标如下

```
 <target name="testing" depends="init">
    <property name="mech.dir" value="${target.dir}/MECHNSM" />
    <property name="mech.classes.dir" value="${mech.dir}/classes" />
    <delete dir="${mech.dir}" />
    <mkdir dir="${mech.dir}" />
    <mkdir dir="${mech.classes.dir}" />
    <copy file="${tests.dir}/Mechanism.properties"      todir="${mech.classes.dir}" overwrite="true" />
    <copy file="${tests.dir}/applicationContext.xml" todir="${mech.classes.dir}" overwrite="true" />
    <javac destdir="${mech.classes.dir}" debug="true" classpath="/jars/dependency_jars/spring-context-support-3.1.1.RELEASE.jar" classpathref="project.class.path">
        <src path="${tests.dir}"/>
        <include name="com/test/Sample.java" />
    </javac>
    <jar destfile="${retymech.dir}/retryOrderPerformPost.jar" basedir="${retymech.classes.dir}">
        <manifest>
            <attribute name="Main-Class" value="com.test.Sample"/>
        </manifest>
        <!--<zipgroupfileset dir="${lib.dir}" includes="**/*.jar" />-->
        <zipfileset src="${lib.dir}/spring-web-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-core-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/log4j.jar" />
        <zipfileset src="${lib.dir}/commons-logging-1.1.1.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-asm-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-beans-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-context-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-core-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-expression-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-web-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-oxm-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/spring-test-3.1.1.RELEASE.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/httpmime-4.1.3.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/httpclient-cache-4.1.3.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/httpcore-4.1.4.jar" includes="**/*.class" excludes="META-INF/**/*" />
        <zipfileset src="${lib.dir}/httpclient-4.1.3.jar" includes="**/*.class" excludes="META-INF/**/*" />

        <fileset dir="${tests.dir}" includes="applicationContext.xml" />
    </jar>
</target> 
```

但是当我尝试运行 Sample.jar 文件时，看起来 applicationContext 文件没有被加载。我在这里做错什么了吗。请把你的建议发给我。

# c# - 如何只允许每个用户进行一个会话

> ID：12641306
> 
> 赞同：3
> 
> 时间：2012-09-28T13:49:37.393
> 
> 标签：c#, asp.net, wcf, silverlight

我被分配了一项任务，即限制单个用户同时使用多个 silverlight 应用程序。理想情况下，每次用户打开新应用程序时，前一个实例都应该收到某种通知并关闭。

Silverlight 应用程序使用通过 REST 端点公开的 WCF 服务使用数据。目前，对服务的每次调用都将用户名和密码作为参数。这很好，因为我们有无状态服务。已经有一些应用程序使用了这些服务，我正在寻找最不痛苦的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:08:02.057

好的，所以我急忙回答，因为我误解了这个问题。我最初以为您指的是同一台计算机上的实例。

**为了防止在同一台计算机上出现多个实例，**您可以使用[LocalMessageReceiver 类](http://msdn.microsoft.com/en-us/library/dd833063%28v=vs.95%29.aspx)。

[您可以在此处](http://tozon.info/blog/post/2009/11/01/Detecting-duplicate-instances-of-a-running-Silverlight-application.aspx)查看代码示例，该示例向您展示如何阻止用户打开应用程序的第二个实例。每个 LocalMessageReceiver 必须具有唯一的通道名称作为构造函数参数。如果构造函数抛出异常，您可以假设存在应用程序的另一个实例。

如果您只想保留最后一个应用程序实例并关闭以前的应用程序实例，那么您应该为每个实例创建唯一的通道名称，然后发送一条消息告诉其他实例关闭。

**为了防止应用程序在不同计算机上的多个实例，**我不太有资格回答，但首先想到的是每当用户登录时写入数据库。

如果您的服务不一定要保持无状态，那么您可以在数据库表中为用户每次登录时保留一个唯一标识符（例如：登录日期？），然后每当用户想要执行某些操作时，您可以检查数据库中的最后一个标识符是否与当前会话中的标识符相对应。如果不是，则意味着有人从另一台计算机以同一用户登录，因此您可以使会话过期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:59:31.617

因为 Silverlight 本身不是一个无状态的应用程序，所以您应该能够使用一个简单的服务和[HMAC](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)来实现它。如果您的数据库中已经有用户名和/或 guid，那么添加一个以用户 guid 为键的单一表应该很简单，其中包含一些时间戳信息和特定登录的特定 HMAC。该 HMAC 将根据机器的特定内容以及正在生成的时间戳生成。就像是：

```
userGuid | activeHMAC | lastLoginDate | currentlyLoggedIn (bit) 
```

然后在 silverlight 控件的登录操作上，可以添加或更新 userGuid 的记录以包含当前信息。这将强制所有新登录覆盖现有的登录 HMAC。然后在注销或关闭事件时，只需调用服务并将该`currentlyLoggedIn`位设置为 false。

然后，您需要确保将此 HMAC 与所有通信一起发送到 Web 服务，以便可以针对新调用进行验证，或者让每个客户端定期调用该服务来比较 HMAC，并在比较失败时禁用客户端。由于 Silverlight 以断开连接的方式运行，您的选择可能会受到数据完整性的约束。就个人而言，我认为将 HMAC 嵌入到所有通信中会更安全，以防止任何类型的延迟时间允许不适当的操作。

# c - 将数据添加到C中的数组

> ID：12641310
> 
> 赞同：0
> 
> 时间：2012-09-28T13:49:46.313
> 
> 标签：c, linux, arrays, string

我有一些想要更新的数组。问题是当数据添加到数组中时，一些变量会更新为 0。

我添加数据的代码：

```
void addStockItem(){
    system(CLS_NAME);
    printf("New Item\n\n");
    printf("New Item Name   : ");
    fflush(stdin);
    scanf(" %[^\n]s",&*itemName[totalItem]);
    //itemName[totalItem][30] = strupr(itemName[totalItem]);
    fflush(stdin);
    printf("New Item Price  : ");
    scanf("%f",&item_Price_Profit[totalItem][0]);
    printf("New Item Profit : ");   
    scanf("%f",&item_Price_Profit[i][1]);
    printf("New Item Qty    : ");   
    scanf("%d",&itemQuantity[totalItem][0]);
    itemQuantity[totalItem][1]=0;
    itemQuantity[totalItem][2]=0;
    ++totalItem;
    allStocks();
} 
```

数据，

```
int totalItem=13,itemQuantity[][3]={8,0,0,9,0,0,11,0,0,0,0,0,20,0,0,22,0,\
  0,16,0,0,18,0,0,9,0,0,7,0,0,5,0,0,12,0,0,0,0,0},sessionQuantity;

float item_Price_Profit[][2]={1,0.5,2,0.2,3,0.2,4,0.2,5,0.5,6,0.8,7,0.5,8,0.2,9,\
0.2,10,0.2,11,0.5,12,0.8,13,0.9};

char itemName[][30]={"STABILO PENCIL 2B","STABILO PEN 0.5",\
"STABILO ERASER","STABILO RULER","STABILO TEST PAD","STABILO BOOK","STABILO SCISSORS","STABILO SHARPENER","STABILO GLUE","STABILO CHALK","STABILO MARKER PEN","OXFORD DICTIONARY","STABILO HIGHLIGHTER"}; 
```

完整代码： http: [//pastebin.com/jjuCCrjz](http://pastebin.com/jjuCCrjz)

[编辑] 在我将 itemQuantity[][3] 更改为 itemQuantity[100][3]、item_Price_Profit[][2] 更改为 item_Price_Profit[100][2] 和 itemName[][30] 更改为 itemName 之后，一切都按预期工作[100][30]。除了scanf，我还有什么可能犯的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:27:25.943

我无法从我的工作计算机访问 pastebin，所以我必须按照发布的内容进行操作。

几个问题：

1.  `fflush`仅定义为处理输出流，而不是输入流；的行为`fflush(stdin)`是*未定义*的（它会做*一些事情*，但可能不是你想要的）。如果您需要从输入流中清除垃圾，则需要使用`getchar()`or`fgets()`或类似方法来使用它，直到看到换行符或其他指示您已清除垃圾的指示符。`%f`and`%d`转换说明符将跳过任何前导空格，并且在转换说明符之前有空格`%[`也会导致任何前导空格被跳过。所以`fflush`完全放弃电话。

2.  `scanf(" %[^\n]s",&*itemName[totalItem]);`- 这看起来很困惑。除非您希望输入始终有一个尾随`s`字符，否则转换说明符应该只是`%[^\n]`. 前面`&*`是`itemName`多余的；你只需要写

    ```
    scanf(" %[^\n]", itemName[totalItem]);
    ```

    尽管您可能应该在其中放置一个字段宽度说明符：

    ```
    scanf(" %30[^\n]", itemName[titalItem]);
    ```

    以避免缓冲区溢出。
3.  您正在将所有数据项（`totalItem`、`itemName`、`item_Price_Profit`等）作为全局变量访问。这通常是胃灼热的秘诀。理想情况下，函数及其调用者不应通过全局变量共享状态；相反，它们应该通过参数、返回值和异常（如果支持）进行通信。更像的东西

    ```
    void addStockItem(char *name, float *price, float *profit, float *quantity)
     {
       ...
       scanf(" %30[^\n]", 名称);
       ...
       scanf("%f", 价格);
       ...
       scanf("%f", 利润);
       ...
       scanf("%d", 数量);
     }
    ```

    这将被称为

    ```
    addStockItem(itemName[totalItem],
                  &item_Price_Profit[totalItem][0],
                  &item_Price_Profit[i][1],
                  &itemQuantity[totalItem][0]);
    ```

4.  你的数据结构对我来说真的很奇怪，但这很可能是因为我看不到你的整个程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:05:46.203

这：

```
scanf(" %[^\n]s",&*itemName[totalItem]); 
```

不可能是对的。这是传递一个转换为指针的字符，其中`scanf()`需要一个指向字符的指针。你可能的意思是：

```
scanf(" %[^\n]s", itemName[totalItem]); 
```

# xcode - 重新排序框架的经验法则？

> ID：12641312
> 
> 赞同：3
> 
> 时间：2012-09-28T13:49:49.523
> 
> 标签：xcode, frameworks

我在 xCode 中看到我可以重新排序框架。我认为它会影响在运行时加载它们的顺序吗？

我的问题：

*   对应用程序的直接影响是什么（加载速度等？）
*   重新排序有什么经验法则吗？

谢谢， 沙尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-23T10:08:07.913

我还没有发现与框架顺序相关的问题。我能想到的唯一结果是警告/错误消息的顺序（如果有的话）。

最后，我将来自同一来源的框架组合在一起（首先来自 Apple），然后按字母顺序排列它们。

# c# - 如何“检索”浏览器键入的 404 url 并使其在 c# 上自动重定向

> ID：12641314
> 
> 赞同：1
> 
> 时间：2012-09-28T13:49:58.177
> 
> 标签：c#, redirect, http-status-code-404

[我在http://mysite.com](http://mysite.com)上有 ac# web 应用程序

用户打开他的浏览器并输入[http://mysite.com/anywrongpath](http://mysite.com/anywrongpath)

我想要做的是获取“确切”网址（ /anywrongpath ）然后将该用户重定向到即 /MainPage.aspx

我想我可以通过以下方式处理重定向：

```
protected void Application_Error(object sender, EventArgs e)
{
    HttpException httpException = Server.GetLastError() as HttpException;
    if (httpException.ErrorCode == 404)
       Response.Redirect("/MainPage.aspx");
} 
```

但是，我不知道如何处理键入的 url 的检索过程。我对“Sessions”、“Request.ServerVariables”、“Request.Url”等进行了研究，但我无法解决问题。

我对如何解决它持开放态度，如果你提供微小的代码示例，我真的很高兴，thanx

穆拉特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:57:24.313

编辑您的 web.config 文件并将类似的内容放在该`system.web`部分中

```
<customErrors mode="RemoteOnly" defaultRedirect="Error.aspx">
    <error statusCode="404" redirect="MainPage.aspx" />
</customErrors> 
```

当您的用户键入类似 mysite.com/non-existant 的地址时，IIS 会将他重定向到`mysite.com/MainPage.aspx?aspxerrorpath=/non-existant`

这样，您可以获得`Request.QueryString["aspxerrorpath"]`

# silverlight - 使用 entityframeworkmodel 从数据库中检索数据时出错

> ID：12641317
> 
> 赞同：0
> 
> 时间：2012-09-28T13:50:02.213
> 
> 标签：silverlight, wcf-ria-services

我有银灯应用程序。在客户端我有使用该 Guid 的 Guid 列表当我选择 26 个客户端时我可以检索客户的所有数据它工作正常但是当我尝试访问超过 26 个客户端的数据时它给了我类似的错误

**查询 GetAtclientsERCWithAllInformation 的加载操作失败，找不到远程服务器**

我的客户端看起来像

```
var query = formscontext.GetATClientsERCWithAllInformationQuery(guid);
        try
        {
            LoadOperation<ATClient> _loadReturnTypeOperation = formscontext.Load(query);
            _loadReturnTypeOperation.Completed += (s, e) =>
            {
            some code goes here 
            } 
```

我的服务器端看起来像

```
 [Query(HasSideEffects=true)]
    public IQueryable<ATClient> GetATClientsERCWithAllInformation(List<Guid> clientsGuids)
    {
        return this.ObjectContext.ATClients.Include("ClientEfileInfo").Include("ATClientImages").Include("ATPreparer").Include("ATPreparer.ATFirm").Include("ATClientReturns")
            .Include("ATClientReturns.ATForms").Include("ATClientReturns.ATForms.FormsMaster").Where(p => clientsGuids.Contains(p.ClientGUID));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T09:49:39.177

似乎 EF 无法处理您请求的查询。silverlight 报告的错误是无用的，您应该查看 http 响应（请记住，从 http 的角度来看，您只是在进行 POST）。覆盖

```
protected override void OnError(DomainServiceErrorInfo errorInfo) 
```

在您的 domainservice 类上以获得真正的错误。
另一个快速获取错误的方法是设置一个 http 代理并检查响应（您可以使用来自 msdn 的 fiddler + wcf 二进制检查器）

# javascript - Jquery Galleriffic 如何将单独的 div 应用于每张幻灯片

> ID：12641320
> 
> 赞同：0
> 
> 时间：2012-09-28T13:50:08.490
> 
> 标签：javascript, jquery, html, galleriffic

我目前正在使用 jquery Galleriffic 插件来显示许多图像（地图）。Jquery 似乎使用索引生成每一个，因此我想知道如何根据当前索引应用不同的 div/图像来显示。

例如，每张幻灯片将包含一张像图像滑块一样旋转的地图图片（多张地图）信息”框。

我正在努力解决不知道如何唯一标识每张幻灯片、将 div/图像应用于 javascript 中的容器的事实。

[画廊：](http://www.twospy.com/galleriffic/example-1.html)

生成图片幻灯片的部分代码：

```
buildImage: function(imageData, isSync) {
            var gallery = this;
            var nextIndex = this.getNextIndex(imageData.index);

            // Construct new hidden span for the image
            var newSlide = this.$imageContainer
                .append('<span class="image-wrapper current"><a class="advance-link" rel="history" href="#"></a></span>')
                .find('span.current').css('opacity', '0');

            newSlide.find('a')
                .append(imageData.image)
                .click(function(e) {
                    gallery.clickHandler(e, this);
                }); 
```

任何帮助/方向表示赞赏

-谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:16:33.490

为什么不使用`onSlideChange`galleriffic插件本身的回调来确定图像悬停时要做什么？

```
jQuery(document).ready(function($) {
    var _currentSlide = -1;
    var gallery = $('#thumbs').galleriffic({
        onSlideChange: function(prevIndex, nextIndex) {
            //use nextIndex to determine what mouseover event does
            _currentSlide = nextIndex;
        }
     }

      $(".mainImageClass").mouseover(function() {
          //hide all current markers
          $(".marker").hide();
          //show only the relevant marker
          $(".marker[rel='" + _currentIndex + "']").show();
      });
 } 
```

HTML：

```
<div class='marker' rel='1'>Content to show when over slide #1</div>
<div class='marker' rel='2'>Content to show when over 2</div>
... 
```

我会利用这个事件而不是修改源。

# ruby-on-rails - 如何调整 Ruby 1.9.3 应用程序以在使用 Ruby 1.8.7 的服务器上工作

> ID：12641321
> 
> 赞同：1
> 
> 时间：2012-09-28T13:50:13.913
> 
> 标签：ruby-on-rails, ruby, ruby-1.9.3, bluehost, ruby-1.8.7

我有一个使用 Ruby 1.9.3 和 Rails 3.2.6 编写的应用程序。在我部署在 Bluehost 上之后，这里别无选择，服务器上有 Ruby 1.8.7。

我的 gem 出现了不同的时间格式错误。我可以在服务器上编辑它们，但下次我进行上限部署时，我将擦除更改并必须再次执行。BH 让我从命令行将 Rails 升级到 3.2.6，但我无法升级到 Ruby 1.9。

1.  我可以升级服务器还是必须用 Ruby 1.8 重写我的应用程序？
2.  如果我重写，当他们将所有服务器升级到 1.9 时，我是否必须再次重写？

我打电话给 BH 并进行了实时聊天，他们总是将我发送到新应用程序的设置页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:58:53.347

首先，如果应用程序在 1.8.7 上运行，它（很可能）也会在 1.9.x 上运行。

反过来就有点难了……Rails 3.2.x 是最后一个支持 Ruby 1.8.7 的 RoR 版本。但除非您`--old-style-hash`在创建时使用，否则您将有很多工作要做。

根据您的代码的复杂程度，修复所有哈希可能就足够了：

```
# Ruby 1.9:
hsh = { foo: "bar" }

# Ruby 1.8 and 1.9:
hsh = { :foo => "bar" } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:57:11.770

您必须将您的应用程序重写为 Ruby 1.8。大多数共享网络主机还没有使用 Ruby 1.9，或者我至少没有找到一个。因此，您必须根据要部署到的服务器的规范进行开发。大多数共享网络主机不知道如何处理 Ruby；PHP 和 Perl 等在服务器环境中已经存在了很长时间并且被很好地理解——但 Ruby 仍然有些新。

或者，您可以找到更好的/VPS 主机。我将 prgmr.com 视为学习管理 VPS 环境的一种预算方式（我不隶属于他们），但我在 Linode 上有一个 VPS，我不需要他们的服务。

# android - 尝试从后台加载应用程序到前台时无法加载 android 视图

> ID：12641323
> 
> 赞同：1
> 
> 时间：2012-09-28T13:50:17.863
> 
> 标签：android

我是安卓新手。我正在开发一个基于位置的 android 应用程序（捕获用户位置坐标）。在我的应用程序中，我有一个计时器，它运行一种特定的方法来将我的位置坐标从 sqlite 数据库刷新到服务器（通过 Web 服务调用）。

请找到我的以下代码，它有一个计时器 onCreate 视图：

```
Timer itsLocationTimer;

protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
myLocationTimer();
}

private void myLocationTimer()
{
long flushDuration = 10000;
try 
{
    itsLocationTimer = new Timer();
    itsLocationTimer.schedule(new TimerTask() 
    {           
    @Override
        public void run() {
         TimerMethod();
    }
     }, 0, flushDuration);
} 
catch (JSONException e) 
{
    e.printStackTrace();
}
}

private void TimerMethod()
{
     sendLocationCoordinatesToServer();
} 
```

当我在前台模式下运行我的应用程序时，我在位置触发或将它们发送到服务器（使用我的计时器）方面没有问题。

现在我将我的应用程序切换到后台模式并让它运行了几分钟。

在将我的应用程序从后台切换到前台时，我无法加载我的视图。我的应用程序崩溃了。

它在 logcat 中显示以下消息：

```
09-28 18:12:51.476: D/dalvikvm(7394): GC_EXTERNAL_ALLOC freed 70K, 48% free 2847K/5379K, external 499K/517K, paused 136ms
09-28 18:12:51.539: D/AndroidRuntime(7394): Shutting down VM
09-28 18:12:51.539: W/dalvikvm(7394): threadid=1: thread exiting with uncaught exception (group=0x40018578)
09-28 18:12:51.554: E/AndroidRuntime(7394): FATAL EXCEPTION: main
09-28 18:12:51.554: E/AndroidRuntime(7394): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.org.myApp/com.org.myApp.view.HomeView}: java.lang.NullPointerException
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.os.Looper.loop(Looper.java:130)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.app.ActivityThread.main(ActivityThread.java:3687)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at java.lang.reflect.Method.invokeNative(Native Method)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at java.lang.reflect.Method.invoke(Method.java:507)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at dalvik.system.NativeStart.main(Native Method)
09-28 18:12:51.554: E/AndroidRuntime(7394): Caused by: java.lang.NullPointerException
09-28 18:12:51.554: E/AndroidRuntime(7394):     at com.org.myApp.view.cub.HomeView.onCreate(HomeView.java:90)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-28 18:12:51.554: E/AndroidRuntime(7394):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
09-28 18:12:51.554: E/AndroidRuntime(7394):     ... 11 more 
```

有人可以建议我问题出在哪里吗？为什么我的应用程序从后台切换到前台时崩溃。

请问有什么建议吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:58:39.967

检查第 90 行的 HomeView.java 文件，您在那里得到了 nullpointerexception。可能是布局未在 onCreate() 中设置或布局已设置该布局不包含此控件，这就是您获得 npe 的原因

```
com.org.myApp.view.cub.HomeView.onCreate(HomeView.java:90) 
```

# c++ - 死胡同 - 无休止的循环，没有解决方案

> ID：12641324
> 
> 赞同：2
> 
> 时间：2012-09-28T13:50:22.740
> 
> 标签：c++, list

我似乎无法弄清楚为什么我的代码不起作用。

我的程序是关于读取两个代表cardealership 的文本文件，并根据模式将输入放入链接列表或STL 列表中。然后读取订单并根据可用性创建错误日志。问题是它一直在链表模式下循环，并且似乎没有写入错误日志。

我对此感到非常愚蠢。我不希望你们解决错误，但教我如何去做。我感谢更有经验的人对我的代码的任何审查。我已经尝试在 XCode 和 VS2012（带有 Win8 的 VM）中的 Eclipse 中进行调试。在所有 IDE 中，变量都没有显示在我不理解的调试编辑器中。我使用 MacOSX GCC 编译器。

所以这里是txt文件：input.txt

```
Brera 3
Golf 5
Punto 13
Fiesta 19 
```

和orders.txt

```
323 Brera 1
324 Golf 6
354 Punto 3
337 Gobldibock 1 
```

这是我的主要方法：

```
// file main.cpp
#include "cardealership.hpp"
#include <fstream>
#include <iostream>
#include <sstream>
#include <string>

int main( int argc, char* argv[] ) {
std::cout << "argv[2]: " << argv[2] << "\n";
std::cout << "argv[3]: " << argv[3] <<"\n";
const unsigned int mode = atoi( argv[1]);
std::string arg2 = argv[2];
std::string arg3 = argv[2];

cardealership* dealer = new cardealership(arg2, arg3, mode);
std::cout << "dealership created" << "\n";
dealer->readInputFileToList();
std::cout << "still running" << "\n";
dealer->readOutputFileAndAlterInventory();
std::cout << "finishing" << "\n";

return 0;
} 
```

以下是包含实际列表的类的标题：

```
// file cardealership.hpp
#ifndef CARDEALERSHIP_HPP   // prevent multiple inclusions
#define CARDEALERSHIP_HPP

#include <string>
#include <list>
#include <vector>

typedef struct linkedNode
{
  char* data;               // will store information
  int amountOfCars;
  linkedNode* next;             // the reference to the next node.
};

class cardealership
{
public:

cardealership (std::string inputFile, std::string ordersFile, const unsigned int mode);
~cardealership();

  void readInputFileToList();
void readOutputFileAndAlterInventory();
  void printInventory (); //TODO

private:
  const unsigned int mode;
std::string inputFile;
std::string ordersFile;

std::list<linkedNode*> listOfCars; //Using Linked Node without linking them...
std::vector<linkedNode*> linkedListOfCars;
};
#endif 
```

和页脚：

```
// file cardealership.cpp
#include "cardealership.hpp"
#include <iostream>
#include <cstring>
#include <fstream>
#include <sstream>

cardealership::cardealership(std::string inputFile, std::string ordersFile, const unsigned int mode)
: inputFile(inputFile),
ordersFile(ordersFile),
mode(mode)
{}

cardealership::~cardealership()
{
listOfCars.clear();
linkedListOfCars.clear();
}
void cardealership::readInputFileToList(){
std::ifstream infile;
std::string line;
infile.open(inputFile.c_str(), 
            std::ifstream::in);
if (!infile.good()){
    std::cout << "Na na na Input File" << "\n";
}
linkedNode* previousNode;

while(getline(infile, line)){

    char* model;
    int amountOfCars;
    linkedNode* tmpNode;
    std::stringstream helperStream;

    getline(infile, line);

    helperStream << line;
    helperStream >> model;
    helperStream >> amountOfCars;

    //Test
    std::cout << "Line: " << line << std::endl;
    std::cout << model << ", " << amountOfCars << std::endl;

    tmpNode->data = model;
    tmpNode->amountOfCars = amountOfCars;

    if (mode == 0) { //Use linked list
        if(previousNode != NULL){
            previousNode->next = tmpNode; //Link that shit
            previousNode = tmpNode;
            linkedListOfCars.push_back(tmpNode);
        }
        else{
            linkedListOfCars.push_back(tmpNode);
        }

    }
    else if (mode == 1){ //Use STL list
        listOfCars.push_back(tmpNode);
    }
    else{
        std::cout<< "invalid mode" << std::endl;
    }

    if (infile.eof()){
        break; // Not too nice but necessary because of last line problem
    }
}
infile.close();
}

void cardealership::readOutputFileAndAlterInventory(){
std::ifstream infile;
std::string line;
infile.open(ordersFile.c_str(), std::ifstream::in);
if (!infile.good()){
        std::cout << "Na na na Orders File" << "\n";
    }
int id;
char* model;
int amountNeeded;
std::ofstream log("errorLog.txt");
if (!log.good()){
    std::cout << "Na na na Log File" << "\n";
}

while (getline(infile, line)){
    getline(infile, line);

    std::stringstream helperStream;

    helperStream << line;
    helperStream >> id;
    helperStream >> model;
    helperStream >> amountNeeded;

    if (mode == 0) { //Use linked list
        linkedNode* tmpNode;
        linkedNode* previousNode;

        if (!linkedListOfCars.empty()){
            tmpNode = linkedListOfCars.front();

            while(tmpNode){
                if (tmpNode->data == model) {
                    std::cout<< "Model found!" << std::endl;
                }

                if (tmpNode->amountOfCars > amountNeeded){
                    std::cout<< "Enough cars available!" << std::endl;
                    tmpNode->amountOfCars -= amountNeeded;
                }

                if (tmpNode->amountOfCars <= amountNeeded){ //

                    if (previousNode != NULL) {
                        linkedNode tmp3Node = *previousNode;
                        tmp3Node.next = tmpNode->next;
                    }

                    linkedNode* tmp2Node;
                    tmp2Node = tmpNode->next;
                    tmpNode = NULL;
                    tmpNode = tmp2Node;

                    //write error to log
                    log << "ID: "<< id << ", Not enough items!";

                    previousNode = tmpNode;
                    tmpNode = tmpNode->next;

                }

            }
            if (!tmpNode) {
                std::cout<< "Model not found." << std::endl;
                //write error to log.
                log << "ID: "<< id << ", Model not available!";
            }
        }
        else{
            std::cout<< "No cars to sell." << std::endl;
        }

    }
    else if (mode == 1){ //Use STL list
        if (!listOfCars.empty()) {
            //Iterator copied and adapted from: http://www.cplusplus.com/reference/stl/list/begin/
            std::list<linkedNode*>::iterator it;

            for ( it=listOfCars.begin() ; it != listOfCars.end(); it++ ){
                linkedNode* tmpNode = *it;

                if (tmpNode->data == model) {
                    std::cout<< "Model found!" << std::endl;
                }

                if (tmpNode->amountOfCars >= amountNeeded){
                    std::cout<< "Enough cars available!" << std::endl;
                    tmpNode->amountOfCars -= amountNeeded;
                }
                if (tmpNode->amountOfCars < amountNeeded){
                    //delete entry and write error to log
                    it = listOfCars.erase(it);
                    log << "ID: "<< id << ", Not enough items!";

                }
                if (it++ == listOfCars.end()) {
                    //Write error to log if end of list is reached
                    log << "ID: "<< id << ", Model not available!";
                }

            }

        }
        else{
            std::cout<< "No cars to sell." << std::endl;
        }

    }
    else{
        std::cout<< "Invalid mode." << std::endl;
    }
}
infile.close();
}

void cardealership::printInventory (){
if (mode == 0) { //Use linked list
}
} 
```

这篇文章现在对我来说似乎很长，但我希望我仍然可以得到一些帮助......

提前致谢，

大号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:57:41.537

添加新的linkedNode时，您声明一个指向节点的指针：

```
linkedNode* tmpNode; 
```

下一次提到 tmpNode 如下：

```
tmpNode->data = model; 
```

然而，tmpNode 不是一个linkedNode，它只是一个指向一个的指针。您基本上是在尝试将一些数据保存到程序的其他部分可能使用的空间中。您需要为 tmpNode 创建一个 linkedNode 以指向它，以便它拥有自己的存储空间。您可能需要查看*新*关键字。

# java - asList().contains() 比较变量的问题

> ID：12641326
> 
> 赞同：-2
> 
> 时间：2012-09-28T13:50:41.867
> 
> 标签：java, android, arrays, comparison

我正在制作一个应用程序，用户必须选择一个 4 位数字，这将与随机选择的隐藏 4 位数字进行比较，但是当我运行代码时，它应该检查我的数组以比较所选数字并且“ **Arrays.asList().contains())** ”的随机数似乎并没有注意到它正在检查的数组确实具有它正在检查的值，有什么建议吗？

比较两个变量的代码：-

```
 guess.v1 = code.int1;
            guess.v2 = code.int2;
            guess.v3 = code.int3;
            guess.v4 = code.int4;

       int[] guess_list = { guess.v1, guess.v2, guess.v3, guess.v4 };

    if (Arrays.asList(guess_list).contains(home.value1)) {
        if (code.int1 == home.value1) {
            X1.setText("V");

            guess.c1 = GuessStatus.V;
        } else {
            X1.setText("S");
            guess.c1 = GuessStatus.S;
        }
    } else {
        X1.setText("X");
        guess.c1 = GuessStatus.X;
    } 
```

生成随机数的代码：-

```
 Code.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            Intent openCode = new Intent(b, code.class);
            // adventure_time checks whether there is a saved game already,
            // if 1, saved game,
            adventure_time = 0;

            // random number generation LET THE NUMBER GAMES BEGIN///
            Random a1 = new Random();
            random1 = new ArrayList<Integer>();
            check.fudge = 0;
            for (int index = 0; index < 4; index++) {
                random1.add(a1.nextInt(5) + 1);
                Log.v("MM", "" + random1.get(index));
            }

            value1 = random1.get(0);
            value2 = random1.get(1);
            value3 = random1.get(2);
            value4 = random1.get(3);
            startActivity(openCode);

        }

    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T13:55:25.503

您没有`Arrays.asList`拨打您认为的电话。您*实际上是*在创建 a `List<int[]>`，而不是`List<Integer>`您可能期望的 a are。（在 Java 中没有这样的类型`List<int>`，因为它不支持泛型而不是原始类型。）

最简单的解决方法是改变它：

```
int[] guess_list = { guess.v1, guess.v2, guess.v3, guess.v4 }; 
```

对此：

```
Integer[] guess_list = { guess.v1, guess.v2, guess.v3, guess.v4 }; 
```

然后，您将最终创建一个`List<Integer>`可以正常工作的。

# .net - Process Explorer 如何确定程序集标志？

> ID：12641327
> 
> 赞同：0
> 
> 时间：2012-09-28T13:50:41.257
> 
> 标签：.net, reflection, ngen, process-explorer

有人知道 Process Explorer 如何确定此处显示的这些标志吗？

![在此处输入图像描述](../Images/bbf5ae789fee987b3cb152c9e3aa452b.png)

是否有用于此的 .NET Api？

我对 Native 标志特别感兴趣。`CodeBase`我尝试在or`Location`属性上确定这一点。但这些似乎总是只返回 DLL 的路径，而不是本机映像的路径。

有任何想法吗？我被困住了。

# ios - 旋转时自动调整 AVCaptureVideoPreviewLayer 大小的问题

> ID：12641330
> 
> 赞同：4
> 
> 时间：2012-09-28T13:50:48.317
> 
> 标签：ios, ios5

我编写了一个静态框架，其中我有一个名为 ViewfinderViewController 的类，它使用 AVCaptureSession 设置相机。这个 ViewController 还添加了一个 AVCaptureVideoPreviewLayer 作为子层到它自己的视图层：

```
 // code in ViewfinderViewController.m
    previewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:captureSession];
    previewLayer.frame = self.view.bounds;
    previewLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;
    [self.view.layer addSublayer:previewLayer]; 
```

ViewfinderViewController 还进行一些视频处理，并为框架的用户提供注册一些委托方法，以防在处理的帧之一中找到或未找到感兴趣的内容。

在我的真实应用程序的 viewDidLoad 方法中，我创建了一个 ViewfinderViewController 的实例，设置它的框架并将它的视图添加为子视图：

```
 // code in the app's view controller viewDidLoad method
    ViewfinderViewController *vfVC = [[ViewfinderViewController alloc] init];
    vfVC.view.frame = self.view.bounds;
    [self.view addSubview:vfVC.view]; 
```

只要我不考虑轮换（直到现在我一直这样做），这一切都很好。我的主要问题是 ViewfinderViewController.view 调整其框架的大小，但 AVCaptureVideoPreviewLayer 没有。我有点困惑：previewLayer 不应该也自动调整大小，因为与其 superLayer 对应的视图被正确调整大小吗？

有任何想法吗？我很乐意提供更多信息，但为了缩短问题，我现在不会再进一步​​了。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-01T13:52:19.980

最后，我发现以下内容最适合我的应用程序。在我的应用程序中，我现在将 ViewFinderViewController 添加为子视图控制器：

```
- (void)viewWillAppear:(BOOL)animated;
{
    if ([self.childViewControllers containsObject:self.viewfinderViewController] == NO) {
        [self addChildViewController:self.viewfinderViewController];
        self.viewfinderViewController.view.frame = self.view.bounds;
        [self.view addSubview:self.viewfinderViewController.view];
        [self.viewfinderViewController didMoveToParentViewController:self];
    }
} 
```

这样，将自动调用 willAnimateRotationToInterfaceOrientation: 方法，我之前从视图控制器转发该方法，该视图控制器将取景器的视图添加为子视图。

此外，我在 ViewfinderViewController 的这个方法中更新了 previewLayer 大小：

```
- (void)viewWillLayoutSubviews;
{
    self.previewLayer.frame = self.view.bounds;
} 
```

我通过实现这两种方法来处理 previewLayer 的旋转：

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {
    [CATransaction begin];
    [CATransaction setAnimationDuration:duration];
    [CATransaction setAnimationTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
    [self updatePreviewLayerForOrientation:toInterfaceOrientation];
    [CATransaction commit];
}

- (void)updatePreviewLayerForOrientation:(UIInterfaceOrientation)interfaceOrientation;
{
    // correct position of previewLayer
    CGSize newSize = self.view.bounds.size;
    self.previewLayer.position = CGPointMake(0.5 * newSize.width, 0.5 * newSize.height);

    // rotate the previewLayer, in order to have camera picture right
    switch (interfaceOrientation) {
        case UIInterfaceOrientationPortrait:
            [self.previewLayer setAffineTransform:CGAffineTransformMakeRotation(0)];
            break;

        case UIInterfaceOrientationLandscapeLeft:
            [self.previewLayer setAffineTransform:CGAffineTransformMakeRotation(M_PI/2)];
            break;

        case UIInterfaceOrientationLandscapeRight:
            [self.previewLayer setAffineTransform:CGAffineTransformMakeRotation(-M_PI/2)];
            break;

        case UIDeviceOrientationPortraitUpsideDown:
            [self.previewLayer setAffineTransform:CGAffineTransformMakeRotation(M_PI)];
            break;

        default:
            break;
    }
} 
```

我希望这可以帮助所有将 AVCaptureVideoPreviewLayer 添加为子层并且在界面旋转时遇到调整大小和方向问题的人。

# sql - SQL 'FROM' 不是预期的

> ID：12641334
> 
> 赞同：1
> 
> 时间：2012-09-28T13:51:02.287
> 
> 标签：sql, database, oracle, oracle11g

上一个问题的后续

我正在使用 oracle 11g 数据库，需要在其中操作字符串列。该列包含多个采用以下格式的电子邮件地址：

jgoozooll@gmail.com;dzookep@gmail.com;admzmoore@outlook.com

我想要做的是取出最后没有'@gmail.com'的任何东西（在这个例子中 admzmoore@outlook.com.com 将被删除）但是 admzmoore@outlook.com 可能是第一封电子邮件列的下一行，所以这种方式没有真正的固定格式，唯一的格式是每个地址用分号分隔。

无论如何，是否可以通过一个命令来实现这一点，以遍历列中的每一行并删除不是@gmail.com 的任何内容？我不太确定这种处理在 SQL 中是否可行。只是在寻找你的想法！

在以下代码中出现上述“FROM”错误，我终生无法弄清楚原因。有人可能会让我看起来很愚蠢，但我必须抓住这个机会。可能还有其他错误:) 这是我的代码：

```
 SELECT REMIT_TO.ID
 , LISTAGG(EMAIL, ';') WITHIN GROUP(ORDER BY REMIT_TO.ID) REMIT_TO.EFT_EMAIL_ADDR

 FROM (SELECT REMIT_TO.ID 
        , regexp_substr(REMIT_TO.EFT_EMAIL_ADDR, '[^;]+', 1, RN) email

    FROM IQMS.REMIT_TO
    CROSS JOIN (SELECT ROWNUM RN
                   FROM(SELECT MAX (REGEXP_COUNT(REMIT_TO.EFT_EMAIL_ADDR, '[^;]+')) ML
                          FROM IQMS.REMIT_TO
                        )
                       CONNECT BY LEVEL <= ML
                  )
     )                             
 WHERE EMAIL LIKE '%@gmail.com%'
 GROUP BY REMIT_TO.ID 
```

对任何人来说有什么突出的吗？

谢谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:59:15.297

您的子查询中似乎缺少一些别名：

```
SELECT REMIT_TO.ID
 , LISTAGG(EMAIL, ';') WITHIN GROUP(ORDER BY REMIT_TO.ID) REMIT_TO.EFT_EMAIL_ADDR
FROM 
(
  SELECT REMIT_TO.ID 
        , regexp_substr(REMIT_TO.EFT_EMAIL_ADDR, '[^;]+', 1, RN) email
  FROM IQMS.REMIT_TO REMIT_TO
  CROSS JOIN 
  (
    SELECT ROWNUM RN
    FROM
    (
      SELECT MAX (REGEXP_COUNT(REMIT_TO.EFT_EMAIL_ADDR, '[^;]+')) ML
      FROM IQMS.REMIT_TO
    ) x2 -- alias needed
    CONNECT BY LEVEL <= ML
  ) x1   -- alias needed  
) REMIT_TO   -- alias needed                         
WHERE EMAIL LIKE '%@gmail.com%'
GROUP BY REMIT_TO.ID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:09:39.437

我的 Oracle 是一个生锈的工具，但乍一看你在 LISTAGG 函数之后缺少一个逗号。

```
SELECT REMIT_TO.ID
 , LISTAGG(EMAIL, ';') WITHIN GROUP(ORDER BY REMIT_TO.ID)
 , REMIT_TO.EFT_EMAIL_ADDR... 
```

# json - @ResponseBody 返回列表接口json

> ID：12641338
> 
> 赞同：0
> 
> 时间：2012-09-28T13:51:11.890
> 
> 标签：json, spring, spring-mvc

我明白这个问题。List 是一个 Spring 不知道要实例化什么的接口。一种解决方案是让我的控制器（和服务）返回一个 ArrayList。我真的很想避免这种情况。如何才能做到这一点？

```
SEVERE: Servlet.service() for servlet [Spring MVC Dispatcher Servlet] in context with path threw exception [Request processing failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [java.util.List]: Specified class is an interface] with root cause
org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [java.util.List]: Specified class is an interface

public @ResponseBody
    List<Preference> getPreferences(@PathVariable Long userId, List<Preference> preferences, ModelMap data) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:52:08.943

在你尝试解决你的问题之前，想想你期望什么样的解决方案？您想将`List`一些对象编组为 JSON。这个 JSON 应该是什么样子？如果您要先编写测试，您会在断言中添加什么？

提示：这不是一个[有效的 JSON](http://json.org/)：

~~[1、2、3、4、5]~~

~~这也不是：~~

```
[{a: 1}, {b: 2}] 
```

长话短说：您需要一个对象包装列表，以将其编组为 JSON 和 XML：

```
{array: [1, 2, 3, 4, 5]} 
```

话虽如此，只需将您的列表包装在一些简单的对象中：

```
class Wrapper {

    private List<Preference> preferences;

}

public @ResponseBody Wrapper getPreferences(/*...*/) 
```

请注意，`Wrapper`类名被丢弃，但`preferences`将使用字段名。

# c# - ServiceStack - 工作单元和结构图

> ID：12641340
> 
> 赞同：2
> 
> 时间：2012-09-28T13:51:15.577
> 
> 标签：c#, web-services, structuremap, servicestack, unit-of-work

我正在使用 ServiceStack (http://www.servicestack.net) 提供休息服务。我正在为我的数据访问层使用工作单元模式。我正在使用 StructureMap 将我的所有服务和工作单元连接在一起。

我需要做的是为我收到的每个单独的请求创建一个工作单元，然后将其处理掉。

我有一个使用该机制的 WCF 服务，[http://andreasohlund.net/2009/04/27/unitofwork-in-wcf-using-structuremap](http://andreasohlund.net/2009/04/27/unitofwork-in-wcf-using-structuremap)。

基本上导致这样的事情

```
ObjectFactory.Initialize(x =>
{
    x.Scan(a =>
        {
             a.AssemblyContainingType<IUnitOfWork>();
             a.WithDefaultConventions();
        });

    x.For<IUnitOfWork>().LifeCycleIs(new WcfOperationLifecycle());
} 
```

我正在为 ServiceStack 寻找类似的“生命周期”。

**[解决方案]**

解决方案在已接受答案的评论中。

a) 将 StructureMap 生命周期设置为 HttpContext

```
x.For<IUnitOfWork>().LifecycleIs(Lifecycles.GetLifecycle(InstanceScope.HttpContext)); 
```

b) 更新了结构映射 IOC 适配器以扩展 IRelease 接口

```
class StructureMapContainerAdapter : IContainerAdapter, IRelease
{
    public T Resolve<T>()
    {
        return ObjectFactory.GetInstance<T>();
    }

    public T TryResolve<T>()
    {
        return ObjectFactory.TryGetInstance<T>();
    }

    public void Release(object instance)
    {
    ObjectFactory.ReleaseAndDisposeAllHttpScopedObjects();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:32:48.990

听起来你只想要[Request Scope](https://github.com/ServiceStack/ServiceStack/wiki/The-IoC-container)吗？

还可以查看具体的[Service](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Service.cs)基类，了解如何使用延迟加载 +`Dispose()`来获得这种行为。

除了在[ServiceStack 的新 API](https://github.com/ServiceStack/ServiceStack/wiki/New-Api)`OnBeforeExecute()` `OnAfterExecute()`中，您还可以使用自己的**ServiceRunner**覆盖您的服务事件挂钩（在旧 API 中，您需要提供自定义服务基类）。

# sql - 为什么 Count(*) 返回意外的数字？

> ID：12641341
> 
> 赞同：1
> 
> 时间：2012-09-28T13:51:15.633
> 
> 标签：sql, sql-server, sql-server-2008

这是我的查询：

```
Select COUNT(*) 
From 
    Users u
    Inner Join 
    UsersLoginHistory uh On u.UserID = uh.UserID 
Where 
    1 = 1   
    And 
    u.AccountID = 37 
Group By u.UserID 
```

我希望能够得到的是`Count(*)`应该在对 u.UserId 进行分组后返回一个数字。但它返回`Count(*)`分组依据之前的值。

所以我可以将上面的查询重写为：

```
Select COUNT(*)
From (
    Select   u.Username   
    From 
        Users u
        Inner Join 
        UsersLoginHistory uh On u.UserID = uh.UserID 
    Where 
        1 = 1   
        And 
        u.AccountID = 37 
    Group By u.UserID
) v 
```

但是我需要找出为什么`Count(*)`在进行分组之前返回记录以及如何修复第一个查询本身。

**编辑：**样本记录

用户表

```
UserId     Username
102        tom.kaufmann 
```

UserLoginHistory 表

```
UsersLoginHistoryID UserID  LoginDateTime         LogoutDateTime         IPAddress
1                    102    2012-09-28 01:16:00 NULL                 115.118.71.248
2                    102    2012-09-28 01:29:00 2012-09-28 01:29:00  127.0.0.1
3                    102    2012-09-28 01:32:00 2012-09-28 01:32:00  127.0.0.1
4                    102    2012-09-28 01:41:00 NULL                 115.118.71.248
5                    102    2012-09-28 01:43:00 2012-09-28 07:04:00  115.118.71.248 
```

等等..

尚未在此数据库中写入每条记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:59:15.733

根据您所说的第二个查询返回所需的结果（并假设`UserID`是 PK `Users`）我认为这就是您所需要的

```
SELECT Count(UserID)
FROM   Users u
WHERE  u.AccountID = 37
       AND EXISTS (SELECT *
                   FROM   UsersLoginHistory uh
                   WHERE  u.UserID = uh.UserID) 
```

这将比展开所有连接的行然后再次折叠它们`Group By u.UserID`并计算结果的行数更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T13:55:18.530

将第一行更改为：

```
Select COUNT(*), u.UserID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T13:58:54.867

这应该为您提供 UserIds 列表和 UsersLoginHistory 表中的条目计数。

```
SELECT u.UserId
, COUNT(uh.*)
FROM Users u
INNER JOIN UsersLoginHistory uh ON u.UserID = uh.UserID
WHERE u.AccountID = 37
GROUP BY u.UserID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:17:05.257

*但我需要找出为什么 Count(*) 在进行分组之前返回记录以及如何修复第一个查询本身*

它正在计算每个用户 ID（登录次数）的行数，这正是`group by`应该如何工作的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T14:27:02.513

COUNT 是一个聚合函数，它应该是这样工作的。你得到每个分组的计数。

在您的第一个查询中，您正在查询每个用户的 userloginhistory 数。在您的第二个查询中，您正在查询具有登录历史记录的用户数。

[http://msdn.microsoft.com/en-us/library/ms173454.aspx](http://msdn.microsoft.com/en-us/library/ms173454.aspx)

# objective-c - zbar 批量二维码扫描

> ID：12641345
> 
> 赞同：0
> 
> 时间：2012-09-28T13:51:22.223
> 
> 标签：objective-c, ios, xcode4.5, zbar-sdk

我目前正在使用 ZBar 使用他们[网站上记录的步骤扫描 QR 码](http://zbar.sourceforge.net/iphone/sdkdoc/camera.html)

我的问题是，有没有办法修改这些步骤以进行批量扫描（即扫描几个 QR 码，将它们存储在 NSMutableArray 中而不关闭扫描仪）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:06:52.163

视图控制器在您关闭它之前不会关闭。在您拨打电话之前，它实际上并没有消失：

```
[scanner dismissModalViewControllerAnimated:YES]; 
```

你会想到什么具体的项目？我犹豫要为完全错误的事情编写代码并让它成为完全错误的代码。

至于 NSMutable 数组，绝对是。那应该完全没有问题。要添加完成按钮，请实现以下代码：

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] init]; 
[doneButton setTarget:self]; 
doneButton.title = @"Done"; 
[doneButton setAction:@selector(dismissViewController)]; //put the dismissal procedure method where dismiss view controller is
self.navigationItem.rightBarButtonItem = doneButton; 
```

如果您愿意，xCode 现在还具有内置的完成按钮功能：P

# android - “ISO-8859-1”字符串的 SharedPreferences 问题？

> ID：12641349
> 
> 赞同：4
> 
> 时间：2012-09-28T13:51:32.940
> 
> 标签：android, sharedpreferences

我正在尝试将少量二进制数据作为字符串写入 SharedPreferences。我可能在这里严重误解了编码，但这是我想要做的：

```
String str = new String("hi there!".getBytes(), "ISO-8859-1");

SharedPreferences p = context.getSharedPreferences("foo", MODE_PRIVATE);
Editor e = p.edit();
e.putString("string", str);
e.putBoolean("worked", true);
e.commit();

... later on after an app restart...

// the shared prefs file will be empty upon the next app start:
SharedPreferences p = context.getSharedPreferences("foo", MODE_PRIVATE);
Log.d(TAG, "String value present?: " + p.getString("string", null)); 
Log.d(TAG, "Boolean flag present?: " + p.getBoolean("worked", false)); 
```

commit() 调用返回 true，一切似乎都正常。下次我启动这个演示应用程序时，我读取了这个共享首选项实例的内容，它完全是空的。如果我不使用“ISO-8859-1”编码，那么一切都按预期工作，共享首选项文件中包含键值。

共享首选项不能与使用该编码的字符串一起使用吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:11:48.950

在第一行调用 getBytes() 时未指定字符编码，因此您将转换为 UTF8 字节。它之所以有效，是因为您使用的是 latin-1 字符，但如果您使用的是西里尔文或希腊文，它会崩溃。无论如何，这有什么意义？字符串在内存中存储为 UTF16

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:12:22.990

SharedPreferences 可能将字符串视为 UTF-8 编码，并且您正在给它提供 ISO-8859-1 编码的字符串。这两种编码不兼容，因此这可能就是您看到此问题的原因。

您必须使用 ISO-8859-1 编码吗？您可以将编码设置为 UTF-8 还是完全留空（我相信 Java 默认会将其存储为 UTF-16 编码字节）？如果可以，这通常是一个更安全的选择。

# c# - 根据时间添加子项

> ID：12641351
> 
> 赞同：0
> 
> 时间：2012-09-28T13:51:35.693
> 
> 标签：c#, linq

假设我有一个位置的事件排序列表：`List<PlannedEvent> PlannedEvents`

然后假设每个事件如下所示：

```
public class PlannedEvent
{
    public string EventName {get; set;}
    public List<string> Attendees {get; set;}
    public DateTime StartTime {get; set;}
} 
```

现在，由于我将所有事件都放在一个离散的位置，我知道一次只能发生一个事件。

随机的家伙“鲍勃”来了，他不知道他的活动名称（愚蠢的鲍勃）。但是，他确实知道他什么时候到达——那是在活动期间的某个时间。

找出“鲍勃”将参加哪个活动的好方法是什么？

我宁愿不`List<PlannedEvent>`一一迭代，

有没有更好的办法？

（注意：这个人为的问题及其假设与我的实际问题非常相似，好处是非常容易理解。这完全不是我的问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:51:35.693

当我写这个问题时，我想出了以下解决方案：

`PlannedEvents.Last(pe => pe.StartTime <= BobArrivalTime)`

# java - 将图像放入 JFace 表单元格会导致图像出现在第一列中的间隙

> ID：12641354
> 
> 赞同：6
> 
> 时间：2012-09-28T13:51:41.990
> 
> 标签：java, swt, jface, tableviewer

所以我有一个问题，当我将图像添加到 JFace 表的任何列时，第一列的行为也像其中包含图像，并且文本按该图像的大小缩进。

这是一个屏幕截图，说明了我的观点以及生成它所需的代码。有没有办法阻止这种情况发生，因为它真的在我的灯芯上？

问候，

格伦 x

![在此处输入图像描述](../Images/a842cb6cb2e30326473d1f973168075a.png)

```
package widgets;

import java.util.ArrayList;
import java.util.List;

import org.eclipse.jface.viewers.ArrayContentProvider;
import org.eclipse.jface.viewers.StyledCellLabelProvider;
import org.eclipse.jface.viewers.TableViewer;
import org.eclipse.jface.viewers.TableViewerColumn;
import org.eclipse.jface.viewers.ViewerCell;
import org.eclipse.swt.SWT;
import org.eclipse.swt.graphics.Image;
import org.eclipse.swt.graphics.ImageData;
import org.eclipse.swt.graphics.PaletteData;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Display;

import org.eclipse.swt.widgets.Shell;

public class ComponentTest {

    private static Image image;

    public static void main(String[] args) {
        final Display display = new Display();
        final Shell shell = new Shell(display);
        shell.setLayout(new GridLayout(1, true));

        TableViewer viewer1 = getViewer(shell, true);
        TableViewer viewer2 = getViewer(shell, false);

        List<String> rows = new ArrayList<String>();
        rows.add("Row 1");
        rows.add("Row 2");

        viewer1.setInput(rows);
        viewer2.setInput(rows);

        shell.pack();
        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch()) {
                display.sleep();
            }
        }
        display.dispose();
    }

    private static TableViewer getViewer(final Shell shell, boolean addImage) {
        TableViewer viewer = new TableViewer(shell, SWT.FULL_SELECTION
                | SWT.H_SCROLL | SWT.V_SCROLL | SWT.NONE);

        viewer.setContentProvider(ArrayContentProvider.getInstance());

        viewer.getTable().setLayoutData(
                new GridData(SWT.FILL, SWT.FILL, true, true));

        TableViewerColumn col = new TableViewerColumn(viewer, SWT.NONE);
        col.getColumn().setWidth(100);
        col.getColumn().setText("Text Column");
        col.setLabelProvider(new StyledCellLabelProvider() {
            @Override
            public void update(ViewerCell cell) {
                cell.setText((String) cell.getElement());
            }
        });

        col = new TableViewerColumn(viewer, SWT.NONE);
        col.getColumn().setWidth(100);
        col.getColumn().setText("Second Text Column");
        col.setLabelProvider(new StyledCellLabelProvider() {
            @Override
            public void update(ViewerCell cell) {
                cell.setText((String) cell.getElement());
            }
        });

        if (addImage) {
            col = new TableViewerColumn(viewer, SWT.NONE);
            col.getColumn().setWidth(100);
            col.getColumn().setText("Image Column");
            col.setLabelProvider(new StyledCellLabelProvider() {
                @Override
                public void update(ViewerCell cell) {
                    cell.setImage(getImage(shell.getDisplay()));
                }
            });
        }
        viewer.getTable().setHeaderVisible(true);

        return viewer;
    }

    // make a little green square
    private static Image getImage(Display display) {
        if (image == null) {
            PaletteData palette = new PaletteData(0xFF, 0xFF00, 0xFF0000);
            ImageData imageData = new ImageData(16, 16, 24, palette);

            for (int x = 0; x < 16; x++) {
                for (int y = 0; y < 16; y++) {
                    imageData.setPixel(x, y, 0xFF00);
                }
            }
            ;
            image = new Image(display, imageData);
        }
        return image;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:55:36.347

在使用 Windows 时，这是一个非常烦人的[错误。](https://bugs.eclipse.org/bugs/show_bug.cgi?id=43910)您可以通过跳过第一列（不使用它）并将其宽度设置为零来使用脏修复。

据我没记错，这会在使用 MacOS 时引入一些小故障。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T12:04:50.603

我遇到了同样的问题，并通过使用带有所有者绘制的 StyledCellLabelProvider 并覆盖绘制方法来绘制图像来解决它。关键是您不应该设置查看器单元格的图像，因为这会产生错误。我将示例代码发布到 Eclipse 错误报告中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:54:30.727

TableItem 行：301：我在这里看到 SWT 代码有问题。

```
if (code == 0) return new RECT ();
            if (!getImage) {
                RECT iconRect = new RECT ();
                iconRect.left = OS.LVIR_ICON;
                parent.ignoreCustomDraw = true;
                code = OS.SendMessage (hwnd, OS. LVM_GETITEMRECT, row, iconRect);
                parent.ignoreCustomDraw = false;
                if (code != 0) rect.left = iconRect.right;

//****problem
    code = OS.SendMessage (hwnd, OS. LVM_GETITEMRECT, row, iconRect); 
```

对于第一个带有图像的表格查看器，这里的代码是 1，说明为什么绘制文本 `iconRect`从右坐标开始。对于没有图像的第二个表格查看器，代码为零。所以它总是从实际界限开始。

如果您真的热衷于修复它，`CellStyleStyledCellLabelProvider`我建议您在此处覆盖绘画方法。

# javascript - 网络服务 jquery 功能

> ID：12641355
> 
> 赞同：0
> 
> 时间：2012-09-28T13:51:56.590
> 
> 标签：javascript, jquery, web-services, html, cordova

在下面的代码中，我尝试从 A url 中读取书籍详细信息，但它不显示输出。在输出屏幕中单击 ajax 按钮时，它不会进入`$(data).find("Book").each(function(){});`

**我的代码html：**

```
<html>
<head>
<script src="http://ajax.microsoft.com/ajax/jQuery/jquery-1.4.2.js" type="text/javascript" charset="utf-8"></script>
<script src="http://ajax.microsoft.com/ajax/jQuery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script type="text/javascript">
function bodyload() {
    alert("We are calling jquery's ajax function and on success callback xml parsing are done");
    $.ajax({
        url: 'http://www.edumobile.org/blog/uploads/XML-parsing-data/Data.xml',
        dataType: 'application/xml',
        timeout: 10000,
        type: 'GET',
        success: function(data) {
            alert("inside success function");
            $("#bookInFo").html("");
            $("#bookInFo").append("<hr>"); * * // my code work until here after that i will not receive any book details in my web page.**
            $(data).find("Book").each(function() {
                $("#bookInFo").append("<br> Name: " + $(this).find("name").text());
                $("#bookInFo").append("<br> Address: " + $(this).find("address").text());
                $("#bookInFo").append("<br> Country: " + $(this).find("country").text());
                $("#bookInFo").append("<br><hr>");
            });
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
            alert("Error status :" + textStatus);
            alert("Error type :" + errorThrown);
            alert("Error message :" + XMLHttpRequest.responseXML);
            $("#bookInFo").append(XMLHttpRequest.responseXML);
        }
    });
}​
</script>
</head>
<body>
<center><button onclick="bodyload()">Ajax call</button></center>
<p id="bookInFo"></p>
</body>
</html> 
```

请告诉我为什么没有得到输出。

![在 ios 模拟器中运行代码时，我只会收到此警报消息](../Images/0d490016c8c17275fb905a99978be658.png)

![如果我在 chrome 中运行该文件，我将获得此输出但不返回 Web 服务输出](../Images/4df10825afa6d473caa595e59f713208.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:01:28.017

我认为success函数的data参数是从xml解析出来的js对象，而不是html\dom。您不能对其应用 $() 。尝试

```
for(var i = 0; i < data.length; i++) {var name = data[i].name; etc...} 
```

或者

```
for(var prop in data){var name = data[prop].name; etc...} 
```

# mysql - 用一个命令更新两个表 MySQL

> ID：12641356
> 
> 赞同：0
> 
> 时间：2012-09-28T13:52:00.860
> 
> 标签：mysql, sql

我有两个名为“USER”和“CART”的表，这两个表包含相同的列名“USER_ID”。

如果我要在“USER”表中插入一个新的“USER_ID”，我怎样才能让这个“USER_ID”也出现在“CART”表中？仅使用一个命令：

```
INSERT INTO USER (USER_ID) VALUES ('1'); 
```

是否有捷径可寻 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:04:01.960

Tanya，我想在 mysql 中用一个查询插入两个表是不可能的。您可能会在以下链接中找到讨论/回答的问题。

[sql - 在一个查询中插入多个表](https://stackoverflow.com/questions/3860280/sql-insert-into-multiple-tables-in-one-query)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:55:03.937

您不能，您可以在一个事务中执行两个语句以确保一致性。

您可以使用触发器，但触发器充其量是一种反模式，并且副作用和复杂性说，撤消它们的效果几乎**不**值得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T13:56:27.887

如果您的 User 表是主表而 Cart 是子表，那么您可以使用。

扳机。在用户表之后插入，您需要插入到购物车表中。这是您想要的确切教程。

[插入教程后触发。](http://www.roseindia.net/sql/trigger/mysql-trigger-after-insert.shtml)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T13:56:48.417

好吧，您可以使用触发器并在购物车表中插入相同的用户 ID。

# c++ - 可访问类的私有函数？

> ID：12641358
> 
> 赞同：4
> 
> 时间：2012-09-28T13:52:12.990
> 
> 标签：c++, oop, class, gcc, information-hiding

一段时间以来，我一直在尝试学习 C++。最近我遇到了以下一段代码：

```
#include <iostream>

using namespace std;

class Point {
    private:
        double x_, y_;

    public: 
        Point(double x, double y){
            x_ = x;
            y_ = y; 
        }

        Point() {
            x_ = 0.0;
            y_ = 0.0;   
        }

        double getX(){
            return x_;  
        }

        double getY(){
            return y_;  
        }

        void setX(double x){
            x_ = x; 
        }

        void setY(double y){
            y_ = y; 
        }

        void add(Point p){
            x_ += p.x_;
            y_ += p.y_;
        }

        void sub(Point p){
            x_ -= p.x_;
            y_ -= p.y_;
        }

        void mul(double a){
            x_ *= a;
            y_ *= a;    
        }

        void dump(){
            cout << "(" << x_ << ", " << y_ << ")" << endl; 
        }
};

int main(){
    Point p(3, 1);
    Point p1(10, 5);

    p.add(p1);
    p.dump();

    p.sub(p1);
    p.dump();

    return 0;
} 
```

对于我的一生，我无法弄清楚为什么要使用这些方法`void add(Point P)`和`void sub( Point p )`工作。

`"cannot access private properties of class Point"`当我尝试使用`add`or时，我不应该得到类似的错误`sub`吗？

`gcc`使用版本编译的程序`4.6.3` `(Ubuntu/Linaro 4.6.3-1ubuntu5)`。运行时输出：

```
(13, 6)
 (3, 1) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T13:54:26.457

Private 关键字指定这些成员只能从类的成员函数和朋友访问。私有变量可以被相同类型的对象访问，甚至可以从该类的其他实例中访问。

这与许多人认为的安全无关。这是关于向其他代码隐藏类的内部结构。要求一个类不会意外地弄乱其他实例，因此没有必要对其他实例隐藏变量。（实际上这会有点棘手，而且没有或没有理由这样做。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T13:54:26.830

`private`除了 s，成员不能从类外部访问`friend`，但可以从类内部的任何地方访问。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T13:53:41.177

您可以自己调用方法，因为它们位于`public`类定义的部分中，并且它们可以访问`private`成员，因为它们是类的一部分。

```
private:
    double x_, y_;

public: 
    Point(double x, double y)
    Point() 
    double getX()
    double getY()
    void setX(double x)
    void setY(double y)
    void add(Point p)
    void sub(Point p)
    void mul(double a)
    void dump() 
```

在这种情况下，`private`只能由其他类成员访问（没有朋友）。

`public`任何人都可以访问成员。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-28T13:54:53.537

因为对这些变量的访问是***在类内部***通过它的方法进行的；您没有直接访问变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T14:12:32.747

由于`add(Point p)`和`sub (Point p)`是类的成员`Point`，它们可以访问`Point`（在这种情况下`p`）的任何实例的私有成员，而不仅仅是 object 的私有成员`this`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T13:59:25.373

您将“类”与“对象”混淆了。把它放在你的思维方式中。如果两个对象属于同一类，则一个对象可以访问另一个对象的私有成员。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-09-28T13:56:33.507

您没有直接访问私有类成员。您正在调用作为公共方法的 add() 和 sub() 方法。这些*被*允许访问私有成员变量。

如果您要尝试：

```
p.x_ ++; 
```

这是不允许的，因为 x_ 是 Point 类私有的

# jquery - 如何在 $(document).ready 中包含脚本

> ID：12641361
> 
> 赞同：2
> 
> 时间：2012-09-28T13:52:18.880
> 
> 标签：jquery

我在 $(document).ready 中有大约 8k 行代码，可用于我正在开发的 Web 应用程序，我现在正在尝试对代码进行分区，以便更容易维护。

我尝试包含脚本标签但没有成功

```
 <script type='text/javascript' src='./js/test.js'>{{html "</sc"+"ript>"}} 
```

任何人都可以建议如何在准备好的文档中包含脚本标签或如何对 javascript 进行分区。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:54:48.643

找到了答案——`$.getScript('./js/test.js')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:11:35.037

试试这个：

```
var html_doc = document.getElementsByTagName('head')[0];
js = document.createElement('script');
js.setAttribute('type', 'text/javascript');
js.setAttribute('src', '../js/test.js');
html_doc.appendChild(js);

//for IE
js.onreadystatechange = function () {
if (js.readyState == 'loaded' || js.readyState == 'complete') {
    DO SOMETHING
}
}
//for ff and chrome
js.onload = function () { DO SOMETHING } 
```

使用此代码，您还可以在加载脚本时执行某些操作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T13:56:01.057

不确定我是否完全理解您的问题，但您可以将所有代码（然后将该代码分解为单独的函数）放入一个函数中，然后从您的 document.ready 中调用该函数。

如果您愿意，可以在单独的 .js 文件中定义单独的函数。只需确保它包含在 html 页面中，例如：

```
<script type='text/javascript' src='./js/test.js' /> 
```

# path - 使用表达式语言获取真实路径

> ID：12641363
> 
> 赞同：0
> 
> 时间：2012-09-28T13:52:21.220
> 
> 标签：path, el, realpath

我必须获得**JSP**的真实路径，并且必须使用**Expression Language**来完成。**然后，我在TagLib**中发送路径。

我发现：

```
<mytag:getstats rtexprvalue="${pageContext.request.contextPath}"/> 
```

但我有一个警告`rtexprvalue`说它是*undefind*和另一个在**EL** : `The declared exception IOException is not actually thrown by the method _elExpression15() from type __2F_PrizeWheel_2F_WebContent_2F_stats_2E_jsp`。

**我的TagLib**在我的**.tld**中的声明如下：

```
<tag>
    <name>getstats</name>
    <tag-class>connector.FileConnector</tag-class>
    <attribute>
        <name>name</name>
        <rtexprvalue>true</rtexprvalue>
    </attribute>
</tag> 
```

也许我做错了。因此，如果您有更好的解决方案，我很感兴趣:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T08:47:02.727

*   警告是不相关的（似乎是随机发生的）
*   “真实路径”不是“上下文路径”

你正在寻找的是`${application.realPath}`

# c# - GridView 数据绑定不工作

> ID：12641369
> 
> 赞同：1
> 
> 时间：2012-09-28T13:53:03.720
> 
> 标签：c#, asp.net, gridview

我有一个`GridView`，我写了一个 DataBound 函数来分配一个工具提示。但它没有被分配。我写的函数是：

```
SqlCommand comd = new SqlCommand("SELECT Location_Profile_Name, " + Label10.Text + " as Home_Profile FROM Home_Profile_Master", con);
        SqlDataAdapter da = new SqlDataAdapter(comd);
        DataTable dt = new DataTable();
        da.Fill(dt);
        GridView3.DataSource = dt;
        GridView3.DataBind();

protected void GridView3_DataBound(object sender, EventArgs e)
    {
        var gv = (GridView)sender;

        foreach (GridViewRow row in GridView3.Rows)
        {
            string label2 = row.Cells[2].Text.Trim();

            if (label2.Length != 0)
            {
                con.Open();
                string str = "SELECT Location_Profile_Tool_Tip FROM Location_Profile_List_ToolTip WHERE Location_Profile_Name='" + label2 + "'";
                SqlCommand cmd = new SqlCommand(str, con);

                SqlDataReader dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    row.Cells[2].ToolTip = dr[0].ToString().Trim();
                }
                con.Close();
            }
        }
    } 
```

当我调试**label2**为空。正在为另一个 Grid 执行相同的代码。怎么了...！！请帮助..！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:58:55.687

嗯...也许这就是问题所在？

```
//                          **************
foreach (GridViewRow row in GridView3.Rows) 
```

应该？

```
//                          **
foreach (GridViewRow row in gv.Rows) 
```

**编辑**

啊! Cells 是一个从零开始的数组。如果你想要第二个单元格，你需要使用数组索引 1。

这个：

```
//                        *
string label2 = row.Cells[2].Text.Trim(); 
```

应该：

```
//                        *
string label2 = row.Cells[1].Text.Trim(); 
```

**编辑**

使用数字单元格索引非常难以阅读且非常脆弱。如果您添加一列或删除一列，您的所有代码都会中断。我强烈建议使用单元名称，如下所示：

```
//                  ************
string label2 = row[Label10.Text].Text.Trim(); 
```

**编辑**

也许这对你会更好？

```
string label2 = ( (DataRow) row.DataItem )[Label10.Text].ToString().Trim(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:28:17.277

拥有一个 TemplateField，然后使用 ItemTemplate 的 ID，可以解决问题。

```
protected void GridView3_DataBound(object sender, EventArgs e)
    {           
        foreach (GridViewRow row in GridView3.Rows)
        {
            Label label1 = (Label)row.FindControl("Label1"); //ID of the ItemTemplate for my column to which I want ToolTip
            string label2 = label1.Text.Trim();

            if (label2.Length != 0)
            {
                con.Open();
                string str = "SELECT Location_Profile_Tool_Tip FROM Location_Profile_List_ToolTip WHERE Location_Profile_Name='" + label2 + "'";
                SqlCommand cmd = new SqlCommand(str, con);

                SqlDataReader dr = cmd.ExecuteReader();
                while (dr.Read())
                {
                    row.Cells[2].ToolTip = dr[0].ToString().Trim();
                }
                con.Close();
            }
        }
    } 
```

# tomcat - 如何将 Mantis (php) 安装到在 Tomcat 上运行的 Quercus（基于 java 的 php 引擎）中

> ID：12641370
> 
> 赞同：2
> 
> 时间：2012-09-28T13:53:05.967
> 
> 标签：tomcat, mantis, quercus

这个问题解释了 Quercus 可用于在 tomcat 安装中安装 Mantis Bug Tracker（基于 php 的应用程序）。 [JBoss/Tomcat 的免费 Wiki 和错误跟踪器](https://stackoverflow.com/questions/4545231/free-wiki-and-bug-tracker-for-jboss-tomcat)

我现在已经在 Tomcat7 上成功部署了 Quercus，但我不明白如何将 Mantis 部署到 Quercus 上，我实际上将文件放在哪里？

背景：我喜欢这个想法，因为目前我服务器上的所有内容都是基于 java 的，并且部署在单个 tomcat 安装中，我不想使我的部署环境复杂化。我查看了纯 java 解决方案 JIRA，但它非常重量级，需要自己的 tomcat 实例，所以我有多个端口的复杂性，然后我查看了开源 jtrac，但它的功能并没有给我留下深刻印象。

**更新：** 我重新考虑了一下，除了将默认端口更改为 8081 并将控制端口更改为 6 之外，我使用默认值安装了 JIRA 产品，现在它与我的其他 tomcat 安装并排工作没有问题:)

以管理员的身份与 JIRA 一起玩了几个小时，发现它是一个非常流畅且易于使用的好人。仍然是原始问题的答案可能对其他人有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T08:06:14.270

# 如何在 Quercus 中安装 Mantis

## 下载并预配置 MantisBT

从 1.2.x 流中下载最新的 MantisBT 版本并解压。

## 下载并准备 Quercus

前往[The quercus 主页](http://quercus.caucho.com/)并下载最新的战争版本。您还需要使数据库的 JDBC 驱动程序可用于 quercus 应用程序。实现这一点的最简单方法是将包含驱动程序的 jar 文件复制到`WEB-INF/lib`.

## 复制和配置 Mantis

将 Mantis 目录中的所有文件复制到安装 Quercus 的目录中。创建一个名为的文件`config_inc.php`并将您的基本 MantisBT 配置放在那里。这需要完成，因为通常 servlet 容器不允许覆盖随应用程序部署的文件。一个基本的例子可以在下面看到

```
<?php
$g_hostname = 'localhost';
$g_db_type = 'mysql';
$g_database_name = 'mantis';
$g_db_username = 'mantis';
$g_db_password = 'mantis'; 
```

## 重新打包war文件

```
jar cf mantisbt.war . 
```

## 部署战争文件

此步骤特定于您的 servlet 容器。对于我的场景，我使用了 Tomcat，只需将 war 文件复制到`${TOMCAT_HOME}/webapps`并启动服务器。之后我导航到`http://localhost:8080/mantisbt/`并开始使用 Mantis。

# drupal - 基于当前节点分类的不同菜单

> ID：12641371
> 
> 赞同：1
> 
> 时间：2012-09-28T13:53:07.440
> 
> 标签：drupal, drupal-taxonomy, drupal-navigation

我想知道是否有人能给我一些关于为这种情况构建我的网站的最佳方式的见解。一点背景知识：我在一个有很多子版块的大型企业网站上工作；因此有很多菜单。我们正在使用带有面板而不是块的页面管理器。

我们网站的 URL 将使用 pathauto 进行结构化，例如：[term:vocabulary]/[term:parent:parent:name]/[term:parent:name]/[term:name])：

这些路径中的每一个都应该基于每个节点将定义的“层次结构”分类法。

所以层次词汇表将具有以下术语：

```
main section 1
    subsection 1_1
    subjection 1_2
        subsection1_2_1
main section 2
    subsection 2_1
    subsection 2_2 
```

现在的问题是：这些路径/分类术语中的每一个都有一个需要显示的特定菜单。您对如何根据页面的分类动态更改菜单有什么建议吗？

我已经查看了“分类菜单”模块，但据我了解，它实际上是根据分类列表创建您的菜单。这不是我们想要的......（我们希望创建单独的菜单并根据分类法将其拉出）。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:10:19.050

首先，我建议使用创建内容以及单个普通菜单（包括层次结构），然后使用[菜单块](http://drupal.org/project/menu_block)

但是，如果您已经决定对路径使用分类法，那么

1.  创建多个菜单。
2.  通过自定义模块创建动态块。
3.  在自定义块中，根据分类术语，决定渲染哪个菜单，然后使用函数[menu_tree_all_data](http://api.drupal.org/api/drupal/includes!menu.inc/function/menu_tree_all_data/7)获取特定菜单，然后渲染它。

我认为这应该可以解决问题。

# xna-4.0 - XNA、EmguCV 和网络摄像头的性能问题

> ID：12641372
> 
> 赞同：0
> 
> 时间：2012-09-28T13:53:18.370
> 
> 标签：xna-4.0, emgucv, face-detection

我开始使用 EmguCV，但在尝试将抓取器的位图转换为 Texture2D 时偶然发现了性能问题

这是我的代码

```
 private void FrameGrabber()
    {
        NamePersons.Add("");
        currentFrame = grabber.QueryFrame().Resize(320, 240, INTER.CV_INTER_CUBIC);
        gray = currentFrame.Convert<Gray, Byte>();
        MCvAvgComp[][] facesDetected = gray.DetectHaarCascade(face, 1.2, 10, HAAR_DETECTION_TYPE.DO_CANNY_PRUNING, new Size(20, 20));
        foreach (MCvAvgComp f in facesDetected[0])
        {
            t = t + 1;
            result = currentFrame.Copy(f.rect).Convert<Gray, byte>().Resize(100, 100, Emgu.CV.CvEnum.INTER.CV_INTER_CUBIC);
            currentFrame.Draw(f.rect, new Bgr(System.Drawing.Color.Red), 2);
            if (trainingImages.ToArray().Length != 0)
            {
                MCvTermCriteria termCrit = new MCvTermCriteria(ContTrain, 0.001);
                EigenObjectRecognizer recognizer = new EigenObjectRecognizer(trainingImages.ToArray(), labels.ToArray(), 2500, ref termCrit);
                name = recognizer.Recognize(result);
                currentFrame.Draw(name, ref font, new System.Drawing.Point(f.rect.X - 2, f.rect.Y - 2), new Bgr(System.Drawing.Color.LightGreen));
            }
            NamePersons[t - 1] = name;
            NamePersons.Add("");
        }
        t = 0;
        for (int nnn = 0; nnn < facesDetected[0].Length; nnn++)
            names = names + NamePersons[nnn] + ", ";
        names = "";
        NamePersons.Clear();

        Bitmap b = currentFrame.ToBitmap();

        //slow
        using (MemoryStream s = new MemoryStream())
        {
            b.Save(s, System.Drawing.Imaging.ImageFormat.Png);
            s.Seek(0, SeekOrigin.Begin); //must do this, or error is thrown in next line
            frame = Texture2D.FromStream(GraphicsDevice, s);
        }

        ////second option but image is bluish and still slow
        //GraphicsDevice.Textures[0] = null;
        //if (frame == null || b.Width != frame.Width || b.Height != frame.Height)
        //    frame = new Texture2D(GraphicsDevice, b.Width, b.Height);
        //BitmapData bData = b.LockBits(new System.Drawing.Rectangle(new System.Drawing.Point(), b.Size), ImageLockMode.ReadOnly, PixelFormat.Format32bppRgb);
        //int byteCount = bData.Stride * b.Height;
        //byte[] bmpBytes = new byte[byteCount];
        //Marshal.Copy(bData.Scan0, bmpBytes, 0, byteCount);
        //b.UnlockBits(bData);
        //frame.SetData(bmpBytes);
    }

    protected override void LoadContent()
    {
        spriteBatch = new SpriteBatch(GraphicsDevice);
        grabber = new Capture();
    }

    protected override void UnloadContent()
    {
        grabber.Dispose();
    }

    protected override void Update(GameTime gameTime)
    {
        FrameGrabber();            
        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Microsoft.Xna.Framework.Color.LightGray);
        spriteBatch.Begin();
        if (frame !=null)
            spriteBatch.Draw(frame, new Microsoft.Xna.Framework.Rectangle(0, 0, ScreenWidth, ScreenHeight), Microsoft.Xna.Framework.Color.White);
        spriteBatch.End();
        base.Draw(gameTime);
    } 
```

我在网上搜索文档，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T06:52:26.297

好吧，我解决了我的问题，创建了一个启动并行线程并处理来自网络摄像头的帧转换的类。如果有人有兴趣，转换为纹理并处理我使用的人脸识别：

```
 private Image<Gray, byte> gray = null;
    private HaarCascade haarCascade = new HaarCascade("haarcascade_frontalface_default.xml");

    private void QueryFrame()
    {
        while (is_running)
        {
            nextFrame = capture.QueryFrame().Flip(FLIP.HORIZONTAL);
            if (nextFrame != null)
            {
                gray = nextFrame.Convert<Gray, Byte>();
                MCvAvgComp[][] facesDetected = gray.DetectHaarCascade(haarCascade, 1.2, 10, HAAR_DETECTION_TYPE.DO_CANNY_PRUNING, new System.Drawing.Size(20, 20));
                foreach (MCvAvgComp face in facesDetected[0])
                    nextFrame.Draw(face.rect, new Bgr(System.Drawing.Color.Red), 2);
                byte[] bgrData = nextFrame.Bytes;
                for (int i = 0; i < colorData.Length; i++)
                    colorData[i] = new Color(bgrData[3 * i + 2], bgrData[3 * i + 1], bgrData[3 * i]);
            }
        }
    } 
```

# sparql - 如何解决 Sparql Query 解析异常错误？

> ID：12641373
> 
> 赞同：0
> 
> 时间：2012-09-28T13:53:19.920
> 
> 标签：sparql, jena

按照我的 sparql 代码：

```
enter code here    PREFIX wn20schema:<http://www.w3.org/2006/03/wn/wn20/schema/>"  
                + "SELECT *"  
                + "WHERE {"  
                + "  wn20instances:synset-"+input+"-"+"noun-"+" %sensenr%"+ "  ^wn20schema:hyponymOf*  ?hypo . " 
                + " }"; 
```

我收到以下错误：

```
enter code here    Exception in thread "main" com.hp.hpl.jena.query.QueryParseException: Lexical error at line 1, column 289\.  Encountered: "%" (37), after : "" 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:55:02.950

1/ 在查询中加入换行符，以便更好地查看解析错误报告所指的位置

2/ 在构造后打印查询以查看它到底是什么。

3/ 似乎将字符串“%sensenr%”放入查询字符串中。

有一个空格，因此以“名词-”结束前缀名称

然后是空间。

然后“%sensenr%”

这是非法的。

仅删除空间并不能解决您的问题。

% 是非法的，除了 %XX 十六进制序列并且 XX 必须是合法的十六进制。“se”不是。

# xml - 为什么 XML 不允许嵌套注释

> ID：12641377
> 
> 赞同：2
> 
> 时间：2012-09-28T13:53:38.420
> 
> 标签：xml

是否有任何特殊原因（除了会使解析更难）XML 不允许嵌套注释，例如

```
<!--
  <!-- this is the foo element -->
  <foo>bar</foo>
--> 
```

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:34:03.440

在不更改语法的情况下，完全可以允许嵌套注释。XML 的设计者选择不这样做是因为他们非常关心 SGML 的兼容性：它会允许不是有效 SGML 文档的 XML 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T13:59:00.600

因为`<! >`是标记声明`--`的语法，也是注释开始和结束的语法。

您不能嵌套注释，因为开始注释的语法与结束注释的语法相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T13:59:31.770

据推测，您不能嵌套标签的原因相同：

```
<tag1 <tag2>foo</tag2>> <!-- 这行不通。-->
```

~~评论实际上只是一种标签，同样的规则适用于评论和任何其他标签。~~

**更新：**昆汀正确地指出评论实际上*不是*标签。[这是完全不同的事情。](http://www.jelks.nu/XML/xmlebnf.html)然而，真实的是，注释遵循与标签相同的定界符-内容-定界符*模式*。将注释规则 (15) 与空标签规则 (44) 和开始标签规则 (40, 41) 进行比较，并将这些规则与元素规则 (39) 进行对比。元素*可以*嵌套 (43)，但一个元素是（回到 39）一个 start_tag-content-end_tag 组合，其中内容部分可以是一个元素。再次，评论*就像*一个单独的标签，而不是一个元素。

现在，所有这一切都解释*了*评论不能嵌套，但不是*为什么要*这样设计。我对 XML 的历史了解不多，无法说出其设计者的心声，但 XML 是更一般的 SGML 的“应用程序”。它也是在引入 HTML 之后很好地开发出来的，部分目的是为了解决 HTML 中的一些缺陷。SGML 和 HTML[共享相同的注释语法](http://www.flightlab.com/~joe/sgml/comments.html)，只要查看 XML 继承了相同的语法就很明显了。那么，人们不得不想象，XML 注释之所以能够以它们的方式工作，很大程度上是因为它们是从其前辈那里继承而来的：甚至在 XML 开发开始之前就已经做出了决定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T14:57:16.810

开始注释标记注释掉它看到的所有内容（包括更多开始注释标记），直到它到达第一个结束注释标记。之后，评论结束，任何剩余的关闭评论标签将不会被识别。与 HTML 相同。

# ruby-on-rails - Rails 3 项目的基于 I18n 浏览器的编辑器（运行本地无 saas 项目）？

> ID：12641384
> 
> 赞同：2
> 
> 时间：2012-09-28T13:53:51.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3, internationalization

有没有可以从浏览器编辑 I18n 翻译的 gem？我已经挖掘了 github 并发现所有 repo 都已过时并且 rails 2.x。我已经知道 copycopter 和其他在线翻译服务，*我想从浏览器本地翻译我自己的应用程序的文本*

喜欢 [https://github.com/n1k/i18n_locale_editor](https://github.com/n1k/i18n_locale_editor)

有人推荐rails 3吗？Magento 风格的内联编辑，点击编辑会更棒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:16:49.443

看[短语](https://phraseapp.com/)，很棒的服务。

# c# - 无法序列化 Web API 中的响应

> ID：12641386
> 
> 赞同：86
> 
> 时间：2012-09-28T13:53:53.267
> 
> 标签：c#, serialization, asp.net-web-api

我正在研究 ASP.NET MVC Web API，我遇到了这个错误：

> “ObjectContent`1”类型无法序列化内容类型“application/xml”的响应正文；字符集=utf-8'。

我的控制器是：

```
public Employee GetEmployees()
{
    Employee employees = db.Employees.First();
    return employees;
} 
```

为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2013-11-27T20:02:45.743

对我来说，这是循环引用的问题。

接受的答案对我不起作用，因为它只会改变 JSON 格式化程序的行为，但是当我从浏览器调用服务时，我得到了 XML。

为了解决这个问题，我关闭了 XML 并强制只返回 JSON。

在 Global.asax 文件中，将以下行放在 Application_Start 方法的顶部：

```
GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;
GlobalConfiguration.Configuration.Formatters.Remove(GlobalConfiguration.Configuration.Formatters.XmlFormatter); 
```

现在只返回 JSON 结果。如果您需要 XML 结果，则需要找到不同的解决方案。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-10-09T05:46:13.810

在您的 global.asax 文件中，在 Application_start() 方法中添加以下行：

```
GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore; 
```

希望对你有帮助！

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-03-28T17:15:57.507

我遇到了同样的问题。我解决了它。我将默认构造函数放入 DTO 类。

前任：

```
public class User
{
    public User()
    {
    }
} 
```

希望它和你一起工作！

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-02-27T16:15:09.797

把它放在构造函数中。希望这能解决问题：

```
 public MyController()
    {

        db.Configuration.ProxyCreationEnabled = false;
    } 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-03-06T02:36:51.210

我找到了两个解决方案。第一个也是最容易实现的是将任何 IEnumerables、ICollections 更改为 List 类型。WebAPI 可以序列化这些对象，但是它不能序列化接口类型。

```
public class Store
{

  [StringLength(5)]
    public string Zip5 { get; set; }

    public virtual List<StoreReport> StoreReports { get; set; }  //use a list here
 } 
```

另一种选择是不使用本机 JSON 序列化程序并在 WebApi Config 的 Register 方法中运行此覆盖：

```
 var json = config.Formatters.JsonFormatter;
        json.SerializerSettings.PreserveReferencesHandling = Newtonsoft.Json.PreserveReferencesHandling.Objects;
        config.Formatters.Remove(config.Formatters.XmlFormatter); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-09-13T17:50:06.123

解决方法很简单。

在 LINQ 查询后添加 .ToList() （或 ToDictionary 如果需要）。

它会进行急切加载而不是延迟加载数据

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-04-08T16:38:15.000

** 当从客户端从请求 web api/wcf/... 调用时会发生此错误，但作为副作用，您需要通过 include 关键字包含依赖关系。**

```
public CustomerPortalContext()
            : base("Name=CustomerPortalContext")
        {
            base.Configuration.ProxyCreationEnabled = false;
        } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-03-01T01:00:32.133

如果您正在使用 EF，除了在 Global.asax 上添加以下代码

```
 GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;
        GlobalConfiguration.Configuration.Formatters.Remove(GlobalConfiguration.Configuration.Formatters.XmlFormatter); 
```

不要忘记导入

```
using System.Data.Entity; 
```

然后您可以返回您自己的 EF 模型

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-01-07T00:11:11.810

如果使用 Entity Framework 的 web api，一个解决方案可能是 [Failed to serialize the response in Web API with Json](https://stackoverflow.com/questions/23098191/failed-to-serialize-the-response-in-web-api-with-json)

基本上，您需要为每个 EF 模型创建一个模型，这消除了类之间的依赖关系并允许轻松序列化。

代码：（取自参考链接）

创建用户模型

```
public class UserModel
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

更改我的方法 GetAll()

```
public IEnumerable<UserModel> GetAll()
{
    using (Database db = new Database ())
    {
        List<UserModel> listOfUsers = new List<UserModel>();
        UserModel userModel = new UserModel();
        foreach(var user in db.Users)
        {
           userModel.FirstName = user.FirstName;
           userModel.LastName = user.LastName;
           listOfUsers.Add(userModel);
        }
        IEnumerable<UserModel> users = listOfUsers;

        return users;
    }
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-05-15T14:14:33.690

请检查此问题的 web api 文档，[处理循环对象引用](http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization#handling_circular_object_references)

问候

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-02-12T20:19:23.260

**默认实体 6 使用 XML**到 apis，在您的项目中，找到文件**“Global.asax”文件**并添加此行：

```
GlobalConfiguration.Configuration.Formatters.Remove(GlobalConfiguration.Configuration.Formatters.XmlFormatter); 
```

此行删除 XML 格式化程序。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-20T06:37:45.830

嗯，以下可能会有所帮助。

我遇到了同样的异常，在我的情况下，我首先传递了为实体代码创建的实际 poco 实体。因为它包含与其他实体的关系，所以我只是在它之上创建了 viewmapper/dto 实体以返回。

它现在工作正常。

Poco 实体：

```
public class Tag
{
public int Id{get;set;}
public string Title{get;set;}
public IList<Location> Locations{get;set;}
} 
```

ViewMapper/Dto

```
public class TagResultsViewMapper
{
public int Id{get;set;}
public string Title{get;set;}
//just remove the following relationship 
//public IList<Location> Locations{get;set;}
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-08-14T16:53:01.973

但是如果你发现其他实体/类的这个问题，你必须为每个类创建一个新的 DTO，如果你有很多，你可以找到一个问题，我认为创建一个 DTO 只是为了解决这个问题不是最好的方法...

你试过这个吗？

```
var json = GlobalConfiguration.Configuration.Formatters.JsonFormatter;
json.SerializerSettings.PreserveReferencesHandling = 
Newtonsoft.Json.PreserveReferencesHandling.All; 
```

问候

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-16T22:43:52.237

你的问题和我的很相似。您不得直接从数据库返回数据。为此，您必须创建模型并关联要显示的数据。

在我的示例中，Json 无法序列化有关 User 的数据，我创建了一个 userModel，并且在我的 API 中，我从数据库返回 userModel 而不是 User。

User 和 UserModel 之间转换或关联数据的逻辑必须在 API 中。

[无法使用 Json 序列化 Web API 中的响应](https://stackoverflow.com/questions/23098191/failed-to-serialize-the-response-in-web-api-with-json)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-09T20:43:29.337

这是我从我的 odata Web API 调用中得到的特定错误：

```
The 'ObjectContent`1' type failed to serialize the response 
body for content type 'application/json; odata.metadata=minimal'. 
```

我终于发现我的 dbContext 类在 onModelCreating 中分配了一个*格式错误的表名*。所以 SqlClient 正在寻找**我的数据库中不存在的表**！

# c++ - gcc 的 -Wconversion 是否与使用比 int 短的整数类型的复合赋值（+= 等）不兼容？

> ID：12641387
> 
> 赞同：13
> 
> 时间：2012-09-28T13:53:53.290
> 
> 标签：c++, c, gcc, casting, warnings

gcc 有一个有用的标志`-Wconversion`，当从较宽类型到较窄类型的隐式转换时会产生警告，可能会丢失信息。不幸的是，它有以下......无益的......行为。

* * *

考虑这个程序：

```
int main(void) {
  short x = 1;
  x = x+x;
  return 0;
} 
```

用 -Wconversion 编译它会产生

```
nonsense.c: In function 'main':
nonsense.c:3:8: warning: conversion to 'short int' from 'int' may alter its value [-Wconversion] 
```

这很公平；在大多数平台上，如果发生这种情况，这将做一些你可能不会想到的事情`x==0x8000`。（您收到此警告的实际机制：操作数`+`受“通常的算术转换”的影响，这会将它们扩大为 int；因此结果也是 int 类型；然后分配回`x`是从更广泛的隐式转换到更窄的类型。）但是假设您*确实*期望并打算这样做。（您正在模拟 16 位处理器或 16 位移位寄存器；或者您知道`x`此代码中可能值的范围，并且它永远不会溢出。）您可以通过显式强制转换来告诉编译器：

```
int main(void) {
  short x = 1;
  x = (short)(x+x);
  return 0;
} 
```

然后它就不会抱怨了。

* * *

到目前为止，一切都很好。但是，如果导致问题的赋值是复合赋值 - `+=`, `*=`,`<<=`等 - 那么据我所知，*没有办法摆脱这个警告*，因为代码中没有任何一点可以您可以插入显式演员表。

这意味着，例如，你不能拥有所有

*   -Wconversion 在您项目的顶级编译器标志中，以捕获它打算处理的所有真正错误。
*   复合赋值运算符代码中任何位置的任何实例都适用于短于`int`.
*   无警告构建。

这似乎很伤心。

* * *

所以，问题是：**有没有解决这个问题的好方法？**我可以看到以下方式：

*   用于`#pragma GCC diagnostic ...`禁用尽管没有错误但已知会引发警告的代码位中的警告。（*缺点*：丑陋，特定于编译器。）
*   将复合赋值扩展为更长的单个赋值并插入显式强制转换。（*缺点*：超级丑。）
*   关掉`-Wconversion`。（*缺点*：此警告在其他地方很有用。）
*   忍受警告。（*缺点*：与 using 不兼容`-Werror`；在任何情况下，让您的代码在没有警告的情况下编译是一种很好的做法，因为“无警告”和“某些警告”之间的区别比“某些警告”和“某些警告”之间的区别更容易发现“更多警告”。）

所有这些似乎都不令人满意，我想知道我是否缺少更聪明的东西。

（注意：如果这确实是事实，我当然会接受“不，就是这样”的答案。）

* * *

因此，看起来答案似乎是这确实是预期的行为，没有办法阻止它，这比上面列出的要好得多。（Mark B 观察到您可以编写一个与显式转换相同`+=`但具有相同功能的函数。ecatmur 建议使用`operator+=`函数定义一个新类型来执行显式转换。）

我接受马克 B 的回答；标题中问题的实际答案只是“是”:-)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:17:43.760

在 RHS 上使用用户定义的类型会起作用：

```
struct cast_result {
    int t;
};
char &operator+=(char &l, cast_result r) { return l = static_cast<char>(l + r.t); }

int main() {
    char c = 'a';
    c += cast_result{2};
} 
```

您可以使用用户定义的文字等来美化这一点，但它仍然相当难看。

我认为问为什么需要对窄类型进行算术是公平的。在 C 的设计中通常假设窄类型的效率低于或可能低于`int`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:08:21.503

我假设在这种情况下警告的逻辑是它在功能上与复合运算符实现的操作相同。复合运算符语法应该做一个非常明显的复合操作，在这种情况下，你想明确地说你知道你在做什么。当您想明确存在意图时，更明确地拼写代码总是会获胜：您只编写一次，但更长的拼写版本将使未来的维护者完全清楚您的意图是什么。

我建议只是分解操作并拼出演员表。您的维护人员真的不会介意，我怀疑他们会认为这很丑陋。

或者，创建一个`scalar_mult(short&, short)`函数来隐藏演员表。然后你表现出明确的意图*并*避免在每个表达式中进行强制转换。

最后，您也许可以完全避免使用较短的类型，从而避免警告。

# c++ - C++ 常量结构成员初始化

> ID：12641392
> 
> 赞同：11
> 
> 时间：2012-09-28T13:54:15.000
> 
> 标签：c++, constructor, struct, constants

我班里有固定的`struct timespec`成员。我应该如何初始化它？

我得到的唯一疯狂的想法是派生出我自己的`timespec`并给它一个构造函数。

非常感谢！

```
#include <iostream>

class Foo
{
    private:
        const timespec bar;

    public:
        Foo ( void ) : bar ( 1 , 1 )
        {

        }
};

int main() {
    Foo foo;    
    return 0;
} 
```

> 编译完成但出现错误：source.cpp: In constructor 'Foo::Foo()': source.cpp:9:36: error: no matching function for call to 'timespec::timespec(int, int)' source.cpp :9:36：注意：候选人是：在 sched.h:34:0、pthread.h:25、/usr/lib/gcc/i686-pc-linux-gnu/4.7.2/ 中包含的文件中。 ./../../../include/c++/4.7.2/i686-pc-linux-gnu/bits/gthr-default.h:41，来自/usr/lib/gcc/i686-pc-linux -gnu/4.7.2/../../../../include/c++/4.7.2/i686-pc-linux-gnu/bits/gthr.h:150，来自/usr/lib/gcc /i686-pc-linux-gnu/4.7.2/../../../../include/c++/4.7.2/ext/atomicity.h:34，来自/usr/lib/gcc/i686 -pc-linux-gnu/4.7.2/../../../../include/c++/4.7.2/bits/ios_base.h:41，来自/usr/lib/gcc/i686-pc -linux-gnu/4.7.2/../../../../include/c++/4.7.2/ios:43，来自 /usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../../include/c++/4.7 .2/ostream:40，来自 /usr/lib/gcc/i686-pc-linux-gnu/4.7.2/../../../../include/c++/4.7.2/iostream:40 ，来自 source.cpp:1: time.h:120:8: note: timespec::timespec() time.h:120:8: note: 候选人期望 0 个参数，2 个提供 time.h:120:8: note : constexpr timespec::timespec(const timespec&) time.h:120:8: 注意：候选人需要 1 个参数，2 个提供 time.h:120:8: 注意: constexpr timespec::timespec(timespec&&) time.h:120 :8: 注意：候选人期望 1 个参数，提供 2 个参数7.2/iostream:40，来自 source.cpp:1: time.h:120:8: 注意：timespec::timespec() time.h:120:8: 注意：候选人需要 0 个参数，提供 2 个 time.h： 120:8: 注意: constexpr timespec::timespec(const timespec&) time.h:120:8: 注意: 候选人需要 1 个参数，提供 2 个 time.h:120:8: 注意: constexpr timespec::timespec(timespec&&) time.h:120:8：注意：候选人需要 1 个参数，提供 2 个参数7.2/iostream:40，来自 source.cpp:1: time.h:120:8: 注意：timespec::timespec() time.h:120:8: 注意：候选人需要 0 个参数，提供 2 个 time.h： 120:8: 注意: constexpr timespec::timespec(const timespec&) time.h:120:8: 注意: 候选人需要 1 个参数，提供 2 个 time.h:120:8: 注意: constexpr timespec::timespec(timespec&&) time.h:120:8：注意：候选人需要 1 个参数，提供 2 个参数提供 2 个提供 2 个

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T14:11:43.337

在 C++11 中，您可以在构造函数的初始化列表中初始化聚合成员：

```
Foo() : bar{1,1} {} 
```

在旧版本的语言中，您需要一个工厂函数：

```
Foo() : bar(make_bar()) {}

static timespec make_bar() {timespec bar = {1,1}; return bar;} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T13:59:13.690

使用带有辅助函数的初始化列表：

```
#include <iostream>
#include <time.h>
#include <stdexcept>

class Foo
{
    private:
        const timespec bar;

    public:
        Foo ( void ) : bar ( build_a_timespec() )
        {

        }
    timespec build_a_timespec() {
      timespec t;

      if(clock_gettime(CLOCK_REALTIME, &t)) {
        throw std::runtime_error("clock_gettime");
      }
      return t;
    }
};

int main() {
    Foo foo;    
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T13:56:10.823

使用初始化列表

```
class Foo
{
    private:
        const timespec bar;

    public:
        Foo ( void ) :
            bar(100)
        { 

        }
}; 
```

如果你想用括号初始化结构然后使用它们

```
Foo ( void ) : bar({1, 2}) 
```

# java - 自定义 Android Dialog 方向更改

> ID：12641396
> 
> 赞同：2
> 
> 时间：2012-09-28T13:54:22.380
> 
> 标签：java, android, layout, orientation, android-orientation

我在使用自定义对话框进行旋转时遇到问题。

我的对话框有纵向和横向的单独布局。启动的活动通过 onConfigurationChanged 管理自己的更改。

问题是，当在对话框可见的情况下发生旋转时，它会保留它开始时的布局。有没有办法更新对话框的布局而不更改可能显示的每个活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T07:28:16.510

我假设活动使用 onConfigurationChanged 仅更改其布局，同时保留数据、任务等。让他们每个人在必要时更新对话框似乎很愚蠢。Dialog 本身这样做是有道理的 - 但 Dialogs 没有 onConfigurationChanged。

将您的 Dialog 更改为以对话框为主题的 Activity 将满足您的需求。
不过，这是一种解决方法，而不是解决方案，所以我希望有人有更好的主意。

# sql - .NET MVC 检查查询是否不为空并显示部分视图

> ID：12641403
> 
> 赞同：1
> 
> 时间：2012-09-28T13:54:46.420
> 
> 标签：sql, linq

我想检查我的查询是否返回行，如果是，则显示部分视图。

这是我到目前为止所拥有的：

```
[ChildActionOnly]
    public ActionResult GetMembership(int id)
    {
        var membership = from m in db.CustomerEnrollment
                      where m.CustomerID == id && m.CustomerTypeID == "1" && m.EndDate >= DateTime.UtcNow
                      orderby m.StartDate
                      select m;
        return PartialView("_GetMembership", membership);
    } 
```

所以现在我只需要检查是否有行。

这会很接近还是我很遥远？

```
 if (membership != null)
        {
            return PartialView("_GetMembership", membership);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T13:57:01.850

采用：

```
if(membership.Any()){...} 
```

# ajax - 如果设置了其他 SelectOneMenu 的值，则更新 SelectOneMenu（未触发事件）

> ID：12641409
> 
> 赞同：5
> 
> 时间：2012-09-28T13:55:06.557
> 
> 标签：ajax, events, jsf, primefaces, selectonemenu

在我的应用程序中，如果设置了另一个 SelectOneMenu，我将尝试设置/更新 SelectOneMenu。我们使用的是 primefaces，所以我检查了 primefaces 展示，并找到了我正在寻找的东西。不幸的是，它不起作用。事件没有被触发，我不知道为什么。希望你能帮助我

[链接到 primefaces 展示的示例](http://www.primefaces.org/showcase/ui/pprSelect.jsf)

-> 如果设置了语言，它应该自动重新加载带有称呼的列表，但它没有。我必须按 F5 才能重新加载。有任何想法吗？

我的 xhtml 代码

```
<h:form id="addressBasicsForm">
  <p:growl id="growl" sticky="true" showDetail="true"/>
  <p:tabView id="tabView">
    <p:tab id="stammdaten" title="#{msg.adr_basics_tabtitle}">
  <table style="width:100%;">
        <tr>
          <td style="width: 50%;">
    <p:panel toggleable="false">
      <table style="margin-top:3px; width:100%;">
        <tr style="height:26px;">
          <td>
            <p:selectOneMenu id="somLang" value="#AddressBasics_m.languageId}" style="margin-left:2px; width:90%;">
              <f:selectItems value="#{AddressBasics_m.languageItems}"/>
                      <p:ajax update="somAnrede" listener="#{AdressBasics_m.handleLanguageChange}"/>
            </p:selectOneMenu>
          </td>
        </tr>
        <tr style="height:26px;">
          <td>
            <p:selectOneMenu id="somAnrede" value="#AddressBasics_m.salutationId}" style="margin-left:2px; width:90%;">
              <f:selectItems value="#{AddressBasics_m.salutationItems}" />
            </p:selectOneMenu>
          </td> 
```

我的豆子

```
@Named("AddressBasics_m")
@ConversationScoped
public class AddressBasicsView implements Serializable{
private static final long serialVersionUID = -4034697810438325785L;

public List<SelectItem> getSalutationItems(){
    if(firstrun)
        languageId = 21L;

    firstrun = false;
    if(salutationItems == null || lastLanguageId != languageId){
        salutationItems = addressService.getAllSalutationsByLangId(languageId);
        setLastLanguageId(languageId);
    }
    return salutationItems;
}

public void handleLanguageChange(){
    this.salutationItems = getSalutationItems();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T16:07:25.550

我相信问题出在您的 Ajax 调用上。Ajax 可能非常棘手，我会推荐 2 种不同的方法：

```
<p:ajax render="@form" listener="#{AdressBasics_m.handleLanguageChange}"/> 
```

或者

```
<p:ajax update=":addressBasicsForm:tabView:stammdaten:somAnrede" listener="#{AdressBasics_m.handleLanguageChange}"/> 
```

# android - 消息锁定

> ID：12641410
> 
> 赞同：-1
> 
> 时间：2012-09-28T13:55:07.440
> 
> 标签：android, iphone, mobile, blackberry

我正在开发一个短信和二维码应用程序，其中二维码或短信将被发送到用户的手机。我不希望他们将消息转发给任何人。

1.  我想知道是否有可能当用户收到消息时，可以将消息锁定在他的手机上，这样他就无法将其转发给任何人。

2.  是否也可以阻止用户编辑消息？

我正在为 Android、iPhone 和后来的 BlackBerry 开发它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:09:19.903

1）不，这是不可能的。作为第三方开发人员，除了您自己的应用程序之外，您无法控制 SMS 商店的功能。如果他们正在使用您的应用程序，您可以阻止他们通过您的应用程序转发它，但没有什么可以阻止他们使用另一个应用程序。

2) 见#1

即使可以，也没有什么能阻止用户截取消息并转发它。

# autofac - 在 Autofac 中为 InstancePerApiRequest 注册一个类并在后台线程中使用

> ID：12641418
> 
> 赞同：-1
> 
> 时间：2012-09-28T13:55:29.027
> 
> 标签：autofac

我有一个使用 InstancePerApiRequest 注册的类，但我还需要在请求范围之外访问它。当在后台任务中解析该类时，我收到以下错误：“从请求实例的范围中看不到标签匹配‘AutofacWebRequest’的范围。”。在 InstancePerApiRequest 之后添加 InstancePerLifetimeScope 可以更正错误，但这对实际注册有何影响。我仍然得到 InstancePerApiRequest 还是我只是覆盖了先前的？

请注意，任务是使用 .ContinueWith 在 DelegatingHandler 中创建的。

如果这不正确，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:21:26.533

为了解决这个问题，我最终使用 Named 和 AsInstancePerLifetime 再次注册了它们。因此，任何后台任务都使用命名的生命周期来解决，请求/响应流中的项目使用在 InstancePerApiRequest 中注册的项目。

# jquery - 防止在表格中的列范围之外单击

> ID：12641422
> 
> 赞同：1
> 
> 时间：2012-09-28T13:55:48.000
> 
> 标签：jquery

我想要做的是用户只能点击表格中的特定列。在小提琴的示例中，例如仅在第 2 列到第 15 列。时间注册模块的前两周。

我正在尝试使用 :lt() 函数，但这似乎只适用于第一行。

[http://jsfiddle.net/KvdM/FxmbB/1/](http://jsfiddle.net/KvdM/FxmbB/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:13:25.160

您只需检查 td 的[.index()](http://api.jquery.com/index/)以查看它是否在 2 到 15 之间 - 根据需要调整数字。

```
$('#sch').on('click', 'td', function() {
    var col = $(this).index();
    if (col > 1 && col < 16) {
        alert('clickable row = ' + col );
    } else {
        return false
    }
}); 
```

[http://jsfiddle.net/jJpnr/](http://jsfiddle.net/jJpnr/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:32:12.063

它可以通过一个花哨的 css 选择器来完成：demo [http://jsfiddle.net/FxmbB/12/](http://jsfiddle.net/FxmbB/12/)

如下修改您的功能

```
$(function() {
    addRow();
    addRow();
    addRow();
    $('#sch td:nth-child(n+3):nth-child(-n+16)').on('click', function() {
        alert($(this).attr('id'));
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:13:47.300

这个小提琴怎么样[http://jsfiddle.net/FxmbB/6/](http://jsfiddle.net/FxmbB/6/)？基本上我只是将事件处理移动到声明端并仅在正确的单元格上注册事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:14:31.637

给你：http: [//jsfiddle.net/FxmbB/7/](http://jsfiddle.net/FxmbB/7/)

检查 $(this) 的索引。例如，

```
$('#sch').on('click', 'td', function() {
        alert($(this).attr('id'));
        if ($(this).index() >1 && $(this).index() < 16){
            alert("OK. You can click on that");
        }
}); 
```

# html - Web 应用程序中的可点击元素的文本选择功能应该如何发挥作用？

> ID：12641426
> 
> 赞同：2
> 
> 时间：2012-09-28T13:56:12.073
> 
> 标签：html, css, web-applications, web

我们正在构建一个允许展开/折叠元素的 Web 应用程序。

可点击项目之一如下所示：

[![](../Images/16b1657591c148368862363e348a2334.png)](https://i.stack.imgur.com/jdLOu.png)

请注意单击元素时的文本选择很烦人。处理此问题的推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:13:02.247

要以 CSS 方式禁用选择：

```
user-select: none;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none; 
```

或者您可以使用不可选择的元素属性

```
<div unselectable="on">...</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:07:56.423

对于 Firefox 和 Chrome/Safari，您可以使用用户选择属性。我认为它仍然是实验性的，所以你应该使用这样的供应商前缀： `#element-id{-moz-user-select: none; -webkit-user-select: none;}`

至于 Opera 和 IE，我不知道（也许 Opera 使用 -o-user-select 会起作用，但我不确定）

编辑：我环顾了一下，因为我也对这个问题感兴趣，显然，对于 Opera 和 IE，有一个`unselectable`属性。[关于它的更多细节](http://help.dottoro.com/ljwdpnva.php)

# objective-c - 如何强制一个类声明一个协议 - 在协议中？

> ID：12641429
> 
> 赞同：1
> 
> 时间：2012-09-28T13:56:25.427
> 
> 标签：objective-c, interface

您能否提示如何实现上述目标？

我想创建一个协议 A（一个接口声明），它将强制该协议 A 的所有具体实现（类）声明一个协议 B，这些类将通过该协议 B 通知他们的代表一些事情。

我想我的问题同时是概念和句法上的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:06:45.603

您可以将您的协议声明为您要强制执行的协议的扩展：

```
@protocol NewProtocol <OldProtocol>
    - (void)foo;
@end 
```

这样你就可以确定所有必需的方法`OldProtocol`都由任何实现的对象实现`NewProtocol`。当然，可选方法不会被强制执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:03:27.697

如果您将协议 A 定义为从协议 B 继承，那么您将获得您想要的效果。

您甚至可以在同一个文件中定义这两种协议。

[在这个问题](https://stackoverflow.com/questions/5435604/protocol-inheritance-in-objective-c)中有更多关于协议继承的讨论。

# python - 文字冒险游戏中不受欢迎的重复遭遇 - 艰难地学习 Python

> ID：12641440
> 
> 赞同：0
> 
> 时间：2012-09-28T13:57:02.410
> 
> 标签：python, adventure

我正在使用 Zed Shaw 的 Learn Python The Hard Way 自学，我在额外的学分练习中遇到了麻烦，他让我们制作自己的文本冒险游戏。

当我在几个小时内完成这段代码时，我以为我做得很好，但令我沮丧的是，它一直在一遍又一遍地运行第一次遭遇。我的大脑被炸了，我无法弄清楚为什么第一次相遇会不断发生。也许你们看到了我没有看到的东西？

最后，我怎样才能让这段代码按顺序正常工作？

```
# First Encounter (main program really)
def fi_en():
    print"""
It smells of damp vegetation, and the air is particularly thick. You can 
hear some small animals in the distance. This was a nice place to sleep.

1\. Stay close, find some cover, and wait for food to show up.

2\. Explore the nearby marsh & find the nearest river, following it downstream."

3\. Walk towards the large mysterious mountain in the distance. 
"""
    answer = raw_input(prompt)
    if answer == 1:
        cun_one = roll_3d6()
        if cun_one <= cun - 2:
            print"""Time passes as eventually you capture some varmints.
You feel slightly more roguish."""
            cun = cun + 1
            fi_en()
        else: 
            print """Time passes and a group of slavers marches into right 
where you are hiding in the woods. They locate you, capture you, and haul you
away for a lifetime of servitude in the main city.
Goodbye %s""" % name
    elif answer == 2: 
        power = roll_3d6()
        if power <= pow -4:
            print"""You trudge through the marshes until you eventually reach 
a large river. Downstream from the river is a large temple covered in vines,
you walk towards it. You feel more powerful."""
            pow = pow + 2
            te_en()
        else:
            print """The vegetation here wraps itself around your legs making
it impossible to move. You will most likely die here in the vegetation. 
Goodbye %s.""" % name
    elif answer == 3:
        cun_two = roll_3d6()
        if cun_two <= cun:
            print """You make your way towards the mountain and you encounter
a really large group of devil dogs guarding the entrance to the mountain."""
            dd_en()
    else: 
        print"You have gotten lost and ended up right where you started."
        fi_en()

######################## MAIN PROGRAM ###################################################
prompt = "> "

print "\n\t\tWelcome to LeGeNeD oF DoObIeUs..."

print "\n\t\tProgrammed using Python 2.7 by Ray Weiss"

name = raw_input("\nWhat is your name brave rogue? > ")

print "\nOk %s, lets roll up some character stats." % name
print "\nPress enter to roll 3D6 for each stat."
raw_input()

display_stats()

print "\nThese are your stats. They can be changed by things in game."

print "\nThese stats will have an effect on the outcomes that you choose."

print "\nYou will be presented with many choices, type in a number."

print "\nOr risk typing something different."

print "\nPress enter to start the game"
raw_input()

print"""You are Doobieus, you are but a wandering rogue in the vast, 
mysterious, and deadly land of Calgaria. Your goal is to survive. 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You have just woken up in the woods, its really cold, and you are hungry."""

fi_en() 
```

这是我的输出

```
You have just woken up in the woods, its really cold, and you are hungry.

It smells of damp vegetation, and the air is particularly thick. You can 
hear some small animals in the distance. This was a nice place to sleep.

1\. Stay close, find some cover, and wait for food to show up.

2\. Explore the nearby marsh & find the nearest river, following it downstream."

3\. Walk towards the large mysterious mountain in the distance. 

> 2
You have gotten lost and ended up right where you started.

It smells of damp vegetation, and the air is particularly thick. You can 
hear some small animals in the distance. This was a nice place to sleep.

1\. Stay close, find some cover, and wait for food to show up.

2\. Explore the nearby marsh & find the nearest river, following it downstream."

3\. Walk towards the large mysterious mountain in the distance. 

> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:03:18.363

试试这个：

```
print '2' == 2 
```

得到它？

编辑添加：

一个稍微不那么尖刻的答案——正如 OP 的评论者所指出的那样，问题是 raw_input 返回一个字符串，并且您将所有响应都作为整数进行比较。

您可以将答案更改为 int，但何必呢？为什么不直接更改您的代码，以便检查答案是否为特定字符串？

# vb.net - 在绑定到 DataTable 的 ListBox 上设置 SelectedItem

> ID：12641441
> 
> 赞同：0
> 
> 时间：2012-09-28T13:57:04.067
> 
> 标签：vb.net, winforms, .net-4.0, datatable, listbox

所以这看起来应该很容易，但是我不太清楚这里需要的语法，因为我更习惯于 WPF / c#。基本上我有一个绑定到 DataTable 的 ListBox，我想根据 ID 值选择一个项目。像这样的东西。

```
lstUsers.DataSource = dtUsers
lstUsers.DisplayMember = "UserName"
lstUsers.SelectedItem = dtUsers.Select(String.Format("ID = {0}", myID))(0) 
```

我可以看到`dtUsers.Select(String.Format("ID = {0}", myID))(0)`在调试器中返回了正确的 DataRow，但设置 SelectedItem 什么也不做。我确定我在这里遗漏了一些明显的东西，但是我尝试过的一切都没有效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:21:13.053

你可以使用`LINQ-To-DataSet`：

```
var rows = dtUsers.AsEnumerable()
                   .Select((row,index) => new{ row,index })
                   .Where(x => x.row.Field<int>("ID")==myID);
if(rows.Any())
    lstUsers.SelectedIndex = rows.First().index; 
```

在 VB.NET 中：

```
Dim rows = dtUsers.AsEnumerable().
    Select(Function(r, i) New With {.row = r, .index = i}).
    Where(Function(x) x.row.Field(Of Int32)("ID") = myID)
If rows.Any Then
    lstUsers.SelectedIndex = rows.First().index
End If 
```

请注意，您需要添加`Imports System.Linq`(`using System.Linq;`在 C# 中)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-20T06:46:32.627

`SelectedItem`您在问题中使用的解决方案实际上比使用`SelectedIndex`or提供的答案更可靠`SelectedValue`。

*   `SelectedIndex`很容易越界然后抛出异常。

*   `SelectedValue`如果两个项目导致相同的值，则可以找到错误的值`ToString()`

*   `SelectedItem`直接匹配列表项后面的***对象。***如果没有匹配项，则列表框将不包含所选项目。您在问题示例中犯的唯一错误是您尝试分配`String`to `SelectedItem`，但最初您没有填充`SelectedItem`字符串。你的每件物品的类型是什么`DataSource`？使用那个会起作用。

**示例：**如果将*myClass*类型的项目添加到*ListBox.Items*`i1`中`i2`，它们将在*ListBox*中显示它们的值, ，但在*ListBox.Items*集合中它们将保留为 , , 。然后你可以使用并且项目将被选中。但是如果你尝试，**它不会起作用**，因为**没有匹配**。这是您在问题示例中尝试的内容以及为什么它不起作用。`i3`**`i1.ToString()``i2.ToString()``i3.ToString()`**`i1``i2``i3``ListBox.SelectedItem = i2``i2``ListBox.SelectedItem = i2.ToString()`****

 *******如果您使用列表中的对象，请坚持`SelectedItem`您的工作，不要使用`SelectedIndex`或`SelectedValue`有其缺点的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:16:00.840

请改用此代码。

```
for (var i = 0; i < lstUsers.Items.Count; i++)
    if ((listBox1.Items[i] as YourClass).ID == myID)
      listBox1.SelectedIndex = i; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:34:43.053

我找到了解决方案

```
lstUsers.DataSource = dtUsers
lstUsers.DisplayMember = "UserName"
lstUsers.ValueMember = "ID"
lstUsers.SelectedValue = dtUsers.Select(String.Format("ID = {0}", myID))(0)("ID") 
```*******

# image - 全景应用程序和图像

> ID：12641443
> 
> 赞同：-1
> 
> 时间：2012-09-28T13:57:05.597
> 
> 标签：image, windows-phone-7

我尝试做一个全景应用程序，当您点击列表框中的项目时，它会打开一个新页面。所以列表框由一个图像和一个 texbox 组成，然后我点击我想将图像的名称带入新页面。有什么建议吗？？（对不起，我的英语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:06:06.423

尝试：

```
 <ListBox ItemsSource="{Binding Items}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <Image Source="{Binding ImageUrl}" Tag="{Binding ImageName}" Tap="Image_Tap"/>
                                <TextBlock Text="{Binding Text}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox> 
```

在后面的代码中

```
private void Image_Tap(object sender, System.Windows.Input.GestureEventArgs e)
{
   Image img = sender as Image;
   String name = img.Tag.ToString();
   NavigationService.Navigate(new Uri("Page2.xaml?ImageName="+name,UriKind.Relative));
} 
```

在 Page2.xaml.cs 上

```
 protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
    {
        String Name = NavigationContext.QueryString["ImageName"];
        base.OnNavigatedTo(e);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:03:27.617

您可以传递参数，如[本例](http://xamlgeek.net/2010/10/13/parameters-and-navigation-in-windows-phone-7/)所示。

因此，在 Tap 事件中，您需要获取图像名称，将其保存到任何字符串并作为查询参数传递：

```
var url = "/Views/PageName.xaml?imageName=" + imageName;
NavigationService.Navigate(new Uri(url ,UriKind.Relative)); 
```

# c# - 在实体框架 EDMX 中创建视图之间的关联时出错

> ID：12641447
> 
> 赞同：2
> 
> 时间：2012-09-28T13:57:12.143
> 
> 标签：c#, entity-framework, edmx

我有一个项目，我在其中使用 EF5 的视图和存储过程。我在设计器中有一个带有视图的 EDMX，并且正在尝试跨 2 个视图手动创建 PK 和 FK 之间的关联，这样做时我首先收到此错误：

**错误 5 错误 3027：没有为以下 EntitySet/AssociationSet - vw_borrowervw_borrower_extension 指定映射**。

然后，如果我对关联进行表映射并选择 pk 和 fk，我会收到此错误：

**错误 5 错误 3007：从第 309、351 行开始映射片段时出现问题：列 [borrower_fk] 正在两个片段中映射到不同的概念性侧面属性。**

在一个视图中，主键名为borrower_pk，而在相关视图中，外键名为borrower_fk。

任何帮助将非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T13:20:58.827

What I ended up doing was in the EDMX remove the field that was the foreign key and then when creating the association let it add the foreign key properties to the entity. This got rid of the error. However this isn't an ideal solution. Can't wait for EF6 for better code-first stored procedure support.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:04:30.037

您必须使用[外键关联](https://stackoverflow.com/questions/5281974/code-first-independent-associations-vs-foreign-key-associations/5282275#5282275)并将[其映射为约束](https://stackoverflow.com/questions/5444450/ado-net-ef-how-to-define-foreign-key-relation-in-model-first-approach/5445806#5445806)。目前，您很可能正在尝试映射独立关联，这在 EDMX 中是不可能的，因为独立关联被映射到它们的数据库对应项。您的数据库没有这些关系，因此它们没有在 SSDL（EDMX 描述存储模型的部分）中描述，因此无法以这种方式映射。

如果您的实体不是只读的（= 您正在使用为插入、更新和删除操作映射的存储过程），这仍然是非常危险的操作。EF 从 SSDL 决定修改操作的顺序。如果您的 SSDL 不知道关系 EF 将不知道必须在子实体之前插入父实体，必须在父实体之前删除子实体，等等。我不确定 EF 在不知道时如何订购操作'没有任何参考约束，但从以前的答案看来，它只是按字母顺序处理实体。

# iphone - 在每个单元格前面的 UITableView 中显示新图像而不是另一个图像按钮

> ID：12641452
> 
> 赞同：0
> 
> 时间：2012-09-28T13:57:41.367
> 
> 标签：iphone, objective-c, xcode, uitableview, uibutton

一旦单击该按钮，我想在表格视图控制器中的另一个图像按钮顶部添加图像。我在 .h 文件中有 UIButton *button。

```
 CellForRow:{
    button=[[UIButton alloc]initWithFrame:CGRectMake(230,0,40,40); 
   [button addTarget:self action:@selector(buttonPressed:withEvent:)                 forControlEvents:UIControlEventTouchUpInside]; 
[button setImage:[UIImage imageNamed:"a"] forState:UIControlStateNormal];
button.tag=indexPath.row;
[cell addSuBView:button];
[cell setIndentationWidth:1];
[cell setIndendationLevel:1];
}
-(void)buttonPressed:(id) sender withEvent: (UIEvent *) event{
UIButton *mybtn=(UIButton*) sender;
[mybtn setImage:[UIImage imageNamed:"b"] forState:UIControlStateNormal];
} 
```

这样做是在第一个图像之上显示第二个图像。但我想要的是用新形象代替旧形象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:03:38.840

```
-(void)buttonPressed:(id)sender withEvent:(UIEvent *)event{
UIButton *button = (UIButton *)sender;
button.selected = ! button.selected;

                if (button.selected) {
                    [button setBackgroundImage:[UIImage imageNamed:@"a.png"] forState:UIControlStateNormal];
                }
                else{
                    [button setBackgroundImage:[UIImage imageNamed:@"b.png"] forState:UIControlStateNormal];

                }

} 
```

# visual-studio-2010 - 在 Visual Studio 中扩展构建资源管理器

> ID：12641454
> 
> 赞同：0
> 
> 时间：2012-09-28T13:57:52.647
> 
> 标签：visual-studio-2010, visual-studio, tfs, tfsbuild

我想知道是否有一种方法可以扩展构建资源管理器，使用 TFS 在 Visual Studio 中显示当前/已完成构建的状态。基本上，我想在有人右键单击构建时弹出的上下文菜单中添加另一个菜单选项（参见屏幕截图）。如果有人选择此菜单选项，我想加载一个自定义 UI 对话框。

![上下文菜单中的默认选项](../Images/4fbe7cfa9918d3596fd87856f8650862.png) 或者，如果我可以扩展构建资源管理器主窗口本身并在“请求者”列的右侧添加另一列，那也很棒。在这个新专栏中，我想添加一个按钮，然后触发自定义 UI。

到目前为止我能找到的最好的说明了如何扩展团队资源管理器窗口（[http://blogs.msdn.com/b/jimlamb/archive/2010/02/26/extend-team-projects-and-team-explorer- in-tfs-2010.aspx](http://blogs.msdn.com/b/jimlamb/archive/2010/02/26/extend-team-projects-and-team-explorer-in-tfs-2010.aspx)）但这不是我想做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T19:45:02.400

[Community TFS Build Extensions](http://tfsbuildextensions.codeplex.com/)有自己的构建管理器，具有默认功能的扩展功能。源代码可供下载，因此我认为您可以出于自己的目的对其进行扩展——只要您遵守[许可规则](http://tfsbuildextensions.codeplex.com/license)。

# javascript - Safari V6.0 中的 FileReader API 问题

> ID：12641455
> 
> 赞同：2
> 
> 时间：2012-09-28T13:57:54.360
> 
> 标签：javascript, safari, filereader

我正在使用以下代码片段在 javascript 中读取文件：

```
if(window.FileReader && filelist.length > 0) {
    var reader = new FileReader();
    reader.onload = reader.onloadend=function(event){
        self._ogrUpload(self, event);
    };
    reader.readAsText(filelist[i]);
    console.log(filelist[i]);
} 
```

这在 Chrome 中有效，但在 Safari V6.0 中无效。

在 Safari 中，上传似乎可以工作，但`_orgUpload()`没有调用该函数。所以我将其替换为：

```
reader.onload = function(event) { alert("TEST");}; 
```

这也不起作用。FileReader 真的可以在 Safari 6.0 中使用吗？因为我看不到控制台中抛出任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:01:53.167

试试这个，看看支持哪些功能

```
function checkFileApi(){
    var debuggers="<h4>browser supports following</h4>"
    if (window.File) debuggers+="Supports File api<br>"
    if (window.FileReader) debuggers+="Supports FileReader api<br>"
    if(window.FileList) debuggers+="Supports FileList api<br>"
    if(window.Blob) debuggers+="Supports Blob api<br>"

    console.log(debuggers)
}

checkFileApi() 
```

# php - 如何使用 htaccess 从 url 中删除客户端 ID？

> ID：12641456
> 
> 赞同：1
> 
> 时间：2012-09-28T13:57:55.110
> 
> 标签：php, .htaccess, routing

我正在创建如下网址：

[http://domain.com/app/](http://domain.com/app/) **clientID** /controller/ 或 ../app/ **clientID** /filename.ext

我需要从 URL 中删除字母数字 clientID。

我目前的 htacces 是：

> 重写规则 ^app/([a-z0-9]+) */(.* )$ /app/$2 [NC,L]

它通过了 htaccess 测试器，但我在网络上收到 404 错误。

示例：[http ://domain.com/app/gmcpoujth7/js/fancybox/jquery.fancybox-1.3.4.pack.js](http://domain.com/app/gmcpoujth7/js/fancybox/jquery.fancybox-1.3.4.pack.js)

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:34:04.223

这是一个两方面的问题。

1.  您想`clientID`从网址中删除
2.  您希望脚本仍然有效

为了使它工作，您还需要添加一个重写脚本来告诉您的文件在哪里访问文件。这有点棘手，可能需要更多的工作，而不仅仅是`htaccess`.

由于 url 正在被重写和重定向，因此您需要有某种方法将该 url 重定向到当前的`clientID`. 这是棘手的部分。您可以添加以下行来设置 cookie：

```
RewriteRule ^app/([a-z0-9]+)/(.)$ /app/$2 [co=clientID:$1:.yourserver.com:7200:/,NC,L] 
```

然后在第二次调用中，您将执行如下本地重写：（*未测试）*

```
RewriteCond %{HTTP_COOKIE} ^.*clientID=([a-z0-9]+).*$ [NC]
RewriteRule /app/$ /app/$1/$2 [QSA] 
```

这不是一个完整的答案，因为如果有人只是去：[http://domain.com/app/js/fancybox/jquery.fancybox-1.3.4.pack.js](http://domain.com/app/js/fancybox/jquery.fancybox-1.3.4.pack.js)而没有先去一个带有 的 url `clientID`，服务器可能如果有不止一个，不知道将它们发送到哪里`clientID`。你最好的选择是`clientID`保持原样。

# java - 更改线程的目标核心

> ID：12641457
> 
> 赞同：3
> 
> 时间：2012-09-28T13:57:56.807
> 
> 标签：java, multithreading, cpu-usage, cpu-cores

告诉线程以编程方式更改它正在处理的核心的方法是什么？

假设我正在使用具有一些内核的 FX-8150，但我希望我的一个线程能够在特别是 5.core 中工作。这可能吗？如果是的话，你能给一个Java的样本吗？该线程可能是另一个进程的线程或当前进程的线程。

我的伪示例：

```
time interval 1 : my_thread working in first core at 5GHz while other cores are 3.6 GHz
time interval 2 : my_thread working in second core at 5GHz while other cores are 3.6 GHz
time interval 3 : my_thread working in third core at 5GHz while other cores are 3.6 GHz
time interval 4 : my_thread working in fourth core at 5GHz while other cores are 3.6 GHz
time interval 5 : my_thread working in fifth core at 5GHz while other cores are 3.6 GHz
time interval 6 : my_thread working in sixth core at 5GHz while other cores are 3.6 GHz
time interval 7 : my_thread working in seventh core at 5GHz while other cores are 3.6 GHz
time interval 8 : my_thread working in eighth core at 5GHz while other cores are 3.6 GHz 
```

所有其他核心都需要处于空闲状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:04:15.067

我有一个名为[Java Thread Affinity](https://github.com/peter-lawrey/Java-Thread-Affinity)的库，它允许您将正在运行的线程分配给逻辑线程或核心。

在您的情况下，您至少需要为操作系统允许一个内核，并且您可以在 Linux 中保留所有剩余的内核。线程库将线程分配给这些保留的内核。您想要保留 cpu 的原因是为了防止其他线程在该 cpu 上运行。您可以告诉库将线程分配给逻辑 cpu 或整个内核。您可以将线程分配到与另一个线程相同或不同的核心或套接字上。

[https://github.com/peter-lawrey/Java-Thread-Affinity/wiki/Getting-started](https://github.com/peter-lawrey/Java-Thread-Affinity/wiki/Getting-started)

该库目前支持 Windows 和 Linux。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:05:36.457

假设您使用的是 Windows 7。在任务管理器中找到该进程，右键单击它，选择设置关联，选择您希望它使用的内核。

[http://www.sevenforums.com/tutorials/83632-processor-affinity-set-applications.html](http://www.sevenforums.com/tutorials/83632-processor-affinity-set-applications.html)

**以编程方式：**

您可以通过在与程序相同的文件夹中创建一个 .bat 批处理文件来永久设置程序的关联性，其内容为：

```
start /affinity 1 program_name.exe

start /affinity 1 <invoke your_java_program> 
```

这将强制程序仅使用 cpu core 0。使用 ... /affinity 2 ... 指定 cpu core 1 等

然后，您应该修改程序的开始菜单和/或桌面快捷方式以指向您新创建的批处理文件。

一个小缺点是，在程序打开之前，您会看到一个小的 cmd 窗口在屏幕上短暂闪烁。

为了获得额外的性能，您可以添加 /high 以赋予应用程序更高的 cpu 优先级。

```
start /affinity 1 /high program_name.exe
start /affinity 1 <invoke your_java_program> 
```

# php - __callStatic 没有调用我的非静态函数

> ID：12641462
> 
> 赞同：1
> 
> 时间：2012-09-28T13:58:05.500
> 
> 标签：php

我认为这会起作用，但事实并非如此。

```
class Foo {
    public function send($to, $message)
    {
        echo 'sending';
    }
    public static function __callStatic($method, $params)
    {
        return call_user_func_array(array(new static, $method), $params);
    }
} 
```

当我这样做时`Foo::send('mary','you had a little lamb')`，为什么它仍在调用`Foo::send()`而不是`new Foo ->send($to, $message)`？

`Non-static method Foo::send() should not be called statically, assuming $this from incompatible context`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:03:03.457

根据[手册](http://php.net/manual/en/language.oop5.overloading.php#object.callstatic)：

> 在静态上下文中调用不可访问的方法时会触发 __callStatic()。

您的方法不是不可访问的，它存在并且可以访问，它不是静态的。

# python - Zope 中 Python 脚本的 i18n（受限 python）

> ID：12641463
> 
> 赞同：1
> 
> 时间：2012-09-28T13:58:07.780
> 
> 标签：python, internationalization, zope

这是我正在尝试做的事情：我想以与 gettext 兼容的方式启用 i18n 对我的 zmi python 脚本的支持，并使用 '_' 函数。

这是我到目前为止所做的。在我的 Zope 产品模块中，我运行：

```
import gettext, __builtin__    
t = gettext.translation('myDomain', LOCALESPATH, languages=['de'], fallback=True)
__builtin__._ = t.gettext 
```

在（不受限制的）外部方法中调用 _ 工作正常，它按预期返回翻译。

```
def testI18n():
  return _('text to be translated') 
```

如果我在使用 RestrictedPython 执行其代码的 Zope“脚本（Python）”中尝试此操作，我会收到 NameError：“未定义全局名称 '_'”。

这是我的解决方法：

```
from myModule import myTranslator as _
print _('text to be translated')
return printed 
```

效果很好（当然，必须允许 Python 脚本使用 myModule）。

但我很好奇是否有办法将 _ 作为受限 python 脚本中的内置函数，以及是否可以在 RestrictedPython.Guards 中扩展 safe_builtins。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:52:14.803

首先，Zope 已经为您提供了与 gettext 兼容的 i18n 包，格式为[`zope.i18n`](http://pypi.python.org/pypi/zope.i18n). 这已经是 Zope 本身的一部分，无需单独安装。

其次，不要与`__builtin__`; 只需*将*消息工厂导入模块并命名即可`_`。

在您的 Zope 产品`__init__.py`中，您为此添加了一个消息工厂：

```
from zope.i18nmessageid import MessageFactory
from AccessControl import ModuleSecurityInfo

YourDomainMessageFactory = MessageFactory('your.domain')

ModuleSecurityInfo('your.packagename').declarePublic('YourDomainMessageFactory') 
```

现在您有了一个消息 id 工厂，可以将其导入到您的任何项目 python 文件中，*包括*受限文件：

```
from your.packagename import YourDomainMessageFactory as _

message = _('Your message to be translated') 
```

请注意我们如何`_`在代码中仍然使用本地名称。

您使用少量 ZCML 注册您的消息目录：

```
<configure
    xmlns:i18n="http://namespaces.zope.org/i18n">

    <i18n:registerTranslations directory="locales" />

</configure> 
```

where`locales`是文件所在目录的子目录`configure.zcml`。`zope.i18n`期望在注册目录中查找`<REGION>/LC_MESSAGES/yourdomain.mo`和可选的`<REGION>/LC_MESSAGES/yourdomain.po`文件；`.po`文件会根据需要自动编译`.mo`为您的文件。

ZPT 页面模板`zope.i18n`默认使用消息目录，请参阅[ZPT i18n 支持](http://wiki.zope.org/zope3/ZPTInternationalizationSupport)。

如果您需要手动翻译某些内容，请使用以下`zope.i18n.translate`功能：

```
from zope.i18n import translate

message = _('Your message to be translated')
print translate(message, target_language='de') 
```

大多数[Plone i18n 手册](http://plone.org/documentation/manual/developer-manual/internationalization-i18n-and-localization-l10n)适用于通用 Zope 应用程序。

如果*一定*要能戳进去`__builtins__`，那一定要直接操作`RestrictedPython.Guards.safe_builtins`；这是一本字典：

```
from RestrictedPython.Guards import safe_builtins

safe_builtins['_'] = t.gettext 
```

# eclipse - Eclipse 不会从目标平台下载相同版本的最新 jar

> ID：12641464
> 
> 赞同：5
> 
> 时间：2012-09-28T13:58:09.077
> 
> 标签：eclipse, eclipse-plugin, p2

我在我们的 Eclipse IDE (Indigo V3.7.2) 中有一个奇怪的问题。我们使用托管在服务器上的目标平台，该服务器是使用 b3 聚合过程构建的 p2 存储库。我们从不同的团队获得某些组件和功能。每次他们交付插件时，版本号都保持不变（例如 myjar_v1.0.0.jar）（当然大小不同）。我们在远程服务器上更新这些插件。在此更新之后，问题是，如果我使用现有工作区，我会在我的代码中看到编译问题，因为没有从目标平台下载最新的 jar。eclipse会不会因为版本和名称相同而无法识别新插件？如果是，我尝试从工作区的 .metadata 文件夹中删除旧 jar，重新启动 eclipse，但问题仍然存在。我删除了整个 .metadata 文件夹本身，但它仍然没有帮助。eclipse 是否在工作区之间共享插件/jar。即如果同一台机器上的任何其他工作区具有相同的jar？我们使用 Maven 进行构建。eclipse 是否引用本地 maven repo 中的插件？eclipse 是否维护来自目标平台的数据缓存？如果是，在哪里？

这个问题实际上让我发疯，我需要找到一种使用最新版本 jar 的方法，即使版本号相同。（我们对其他团队版本控制方法没有太多控制）

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T21:41:28.920

Eclipse（实际上是 p2）使用 ID + Version 作为包的唯一标识符。这存储在缓存中，有时甚至在实例之间共享。如果您更改 jar 的内容，即使是轻微的，您也**必须更改版本号**。您会注意到 Eclipse 使用版本号，例如 xyzqualifier，其中 qualifier 是时间戳 (20120928-2359)。

p2 拥有的 MD5 仅用于检查下载的有效性。

我很抱歉，但事情就是这样。幸运的是，Tycho 和 PDE/Build 都可以处理 .qualifier 并将它们更改为对您有意义的日期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-19T18:11:21.900

我知道这个问题已经很老了，但也许我可以深入了解这个问题。

Eclipse 并没有真正在工作空间之间共享捆绑池。相反，在解析目标平台时会考虑所有已知的工作空间。这些“已知工作区”就是您的“最近的工作区”列表中的那些。因此，在工作区 A 中的目标平台解析期间，Eclipse 在其他工作区的包池中查找所需的包，并将那些已经下载的包从那里复制到工作区 A 的包池，而不是真正下载最新的包文件从工作区 A 的目标平台中配置的 P2 存储库中。

万恶之源当然是 irbull 已经解释过的。

作为一种解决方法，您可以简单地从“最近的工作区”列表中删除所有其他工作区，关闭 Eclipse，删除要更新的工作区的捆绑池，启动 Eclipse 并启动您选择的目标平台的解析。然后，Eclipse 将真正从适当的位置下载所有包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-19T18:07:12.600

我遇到了类似的问题，我的谷歌搜索将我带到了这个页面。

我想我会把我的答案放在这里，以防它帮助别人。

**请注意（正如其他人所提到的）**：如果 JAR 确实不同，那么拥有相同编号的 JAR 是不正常的行为。我遇到这个是因为我有一个“测试”存储库，以确保我可以从存储库下载自定义插件，并且我使用相同的版本号进行了更新，因为一旦它在我的公司成为“官方”，那将是版本它将使用的编号。

长话短说，我通过 eclipse 卸载了我的插件，在我的插件目录中删除了包含插件的文件夹，从远程仓库中取出 jar，并将其解压缩到我的插件目录中，回到 Eclipse 并安装了我的插件。

同样，请注意，这不是执行此操作的预期方式，并且应该被视为最后的手段，因为我不知道这可能会破坏哪些其他内部 Eclipse 假设。我个人没见过，但是YMMV。如果我遇到任何问题，我会更新这个答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-09T13:58:11.627

在与 Eclipse 目标编辑器苦苦挣扎数小时后，我想出了一些允许我管理 P2 存储库和 .target 文件的舞步。几乎我所有的头痛都是由缓存失效问题引起的。我非常擅长确保在任何代码更改时功能和插件版本都会更改（请参阅下面的提示 3），因此目标应该选择新版本，但很多/大多数时候它不会。特别是当我使用本地 P2 存储库时。为什么要缓存本地存储库？

如果目标编辑器没有找到新版本的功能或插件，而是坚持从存储库加载缓存的旧版本的功能或插件，则需要使用“可用软件”中的重新加载选项站点的对话框使缓存无效。但是该对话框有两个版本。

计划 A：如果您只使用远程 (http) P2 存储库，那么这些说明应该有效：[https ://eclipsesource.com/blogs/2012/08/31/reloading-your-p2-cache/](https://eclipsesource.com/blogs/2012/08/31/reloading-your-p2-cache/)

计划 B：但是，如果您使用远程和本地（文件：URI）P2 存储库的组合，则需要使用更迂回的路线使缓存无效。

1.  在目标编辑器的目标定义页面中单击“添加...”。

2.  选择“软件站点”，点击下一步。点击右上角的“管理”按钮。

3.  在“可用软件站点”对话框中，选择要使其缓存无效的存储库，然后单击“重新加载”。

4.  返回目标编辑器，取消您打开的两个对话框，然后选择您刚刚使其缓存失效的存储库，然后单击“更新”。

如果有人知道包含本地存储库的此对话框的更快路径，请发表评论。

**提示 1**：要使 Target 编辑器的“更新”和“重新加载”至少部分工作，工件版本应设置为“0.0.0”以进行延迟解析。

**提示 2**。如果你做很多目标管理，我强烈推荐 M. Barbero 的免费且强大的 Target Platform Definition DSL 插件。它为您生成 .target 文件，消除了 .target 文件中功能和插件版本控制的大部分麻烦——并有助于避免不得不使用令人尴尬的 Eclipse 目标编辑器。为了消除更多版本发现问题，强烈考虑为每个功能和/或插件使用“惰性”选项。安装说明在这里：[https ://github.com/eclipse-cbi/targetplatform-dsl](https://github.com/eclipse-cbi/targetplatform-dsl)

这里有一个很好的概述：[https ://eclipsesource.com/blogs/2018/05/30/eclipse-target-platform-definition-dsl-and-generator/](https://eclipsesource.com/blogs/2018/05/30/eclipse-target-platform-definition-dsl-and-generator/)

**提示 3**：为 PDE 安装和使用 Eike Stepper 和 Ed Merks 的 Oomph 版本控制。节省大量时间，让您远离版本控制惩罚框。它现在是 Eclipse 的标准配置。它将监视您启用它的任何项目中的代码更改，了解功能和插件之间的关系，通知您不受版本控制但应该受版本控制的项目，标记插件和功能清单中的陈旧版本号以进行更新等等. 它甚至会根据您所做的更改类型建议正确的主要/次要版本号。[https://www.eclipse.org/forums/index.php/t/1100576/](https://www.eclipse.org/forums/index.php/t/1100576/)

# internet-explorer - 什么会导致响应式网站默认使用移动设备？

> ID：12641465
> 
> 赞同：0
> 
> 时间：2012-09-28T13:58:13.867
> 
> 标签：internet-explorer, css, responsive-design, media-queries

我有一个使用带有断点的媒体查询的响应式网格系统的站点。在 IE8 上，即使屏幕尺寸设置为标准桌面尺寸（大于 960 像素宽），我也将“移动版”视为默认视图。

是否存在会导致这种情况发生的已知问题（和修复）？

一如既往地感谢您的帮助。

- - 编辑 - -

我的媒体查询是如何设置的：

```
@media screen and (max-width: 767px) {  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:41:53.183

[IE8 不支持媒体查询](http://caniuse.com/css-mediaqueries)，所以它可能正在处理所有的 CSS 规则，即使是全宽屏幕也不应该。

为防止出现此问题，请在每个规则 ( )`only`后添加关键字。`@media``@media only screen ...`

然后，您可以在所有页面的部分获得支持，包括出色的插件**[respond.js](https://github.com/scottjehl/Respond)**`<head>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T10:28:34.717

这取决于您如何构建代码（并且由于您没有发布任何内容，因此很难分辨出什么是错误的；））。但一个可能的问题是您首先定义了您的移动布局，并且媒体查询 >960 在 IE8 中不会触发。像这样：

```
 body { // Default width for all browsers
   width: 300px; 
 }

 @media only screen and (min-width : 960px) { // Only for supporting desktops
   body {
     width: 960px;
   }
 } 
```

（对于不支持它们的浏览器，始终使用“默认”css（没有媒体查询）。）

一种处理方法是默认使用 960px 宽的布局：

```
 body { // Default width for all browsers
   width: 960px; 
 }

 @media only screen and (min-width : 1400px) { // Widescreen monitors
   body {
     width: 1400px;
   }
 }

 @media only screen and (max-width : 300px) { // Mobile layout
   body {
     width: 300px;
   }
 } 
```

当然，您将不得不指定更多内容，而不仅仅是正文，但这应该会给您一个想法。如果这不能解决问题，请在此处发布您的一些 CSS，以便我们查看。

# git - 列出 Git 存储库中的子模块

> ID：12641469
> 
> 赞同：296
> 
> 时间：2012-09-28T13:58:38.120
> 
> 标签：git, git-submodules

我有一个 Git 存储库，其中包含多个子模块。运行后如何列出所有子模块的名称`git submodule init`？

该`git submodule foreach`命令可以回显子模块的名称，但只有在它们被签出后才有效，而这在 init 步骤之后没有发生。在签出之前需要执行链中的更多步骤，我不想将子模块的名称硬连接到脚本中。

那么是否有一个 Git 命令来获取所有当前注册但尚未签出的子模块的名称？

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2012-09-28T14:16:46.240

您可以使用与使用本身相同的机制`git submodule init`，即查看`.gitmodules`. 此文件枚举每个子模块路径及其引用的 URL。

例如，从存储库的根目录，`cat .gitmodules`将内容打印到屏幕上（假设您有`cat`）。

因为 .gitmodule 文件具有 Git 配置格式，所以您可以使用 git config 来解析这些文件：

```
git config --file .gitmodules --name-only --get-regexp path 
```

将向您显示所有子模块条目，并使用

```
git config --file .gitmodules --get-regexp path | awk '{ print $2 }' 
```

你只会得到子模块路径本身。

* * *

## 回答 #2

> 赞同：161
> 
> 时间：2014-05-06T09:25:00.590

如果要显示嵌套的子模块，您可以使用`git submodule status`或可选。`git submodule status --recursive`

来自 Git 文档：

> 显示子模块的状态。这将打印每个子模块的当前签出提交的 SHA-1，以及 SHA-1 的子模块路径和 git describe 的输出。每个 SHA-1 将带有前缀 - 如果子模块未初始化，+ 如果当前签出的子模块提交与包含存储库的索引中找到的 SHA-1 不匹配，如果子模块存在合并冲突，则为 U。

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2016-11-29T23:01:59.910

以下命令将列出子模块：

```
git submodule--helper list 
```

输出是这样的：

```
<mode> <sha1> <stage> <location> 
```

注意：它需要 Git 2.7.0 或更高版本。

* * *

## 回答 #4

> 赞同：62
> 
> 时间：2013-06-17T21:48:36.713

要仅返回已注册子模块的名称，可以使用以下命令：

```
grep path .gitmodules | sed 's/.*= //' 
```

把它想象成`git submodule --list`不存在的。

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2014-09-28T10:31:58.093

利用：

```
$ git submodule 
```

它将列出指定 Git 存储库中的所有子模块。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2014-06-09T14:21:50.393

我注意到这个问题的答案中提供的命令为我提供了我正在寻找的信息：

*[在 .gitmodule 中找不到不是子模块的路径的子模块映射](https://stackoverflow.com/questions/4185365/no-submodule-mapping-found-in-gitmodule-for-a-path-thats-not-a-submodule)*

```
git ls-files --stage | grep 160000 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2013-06-13T13:32:25.757

我用这个：

```
git config --list|egrep ^submodule 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2017-07-05T18:45:30.637

如果您不介意仅对已初始化的子模块进行操作，则可以使用它`git submodule foreach`来避免文本解析。

```
git submodule foreach --quiet 'echo $name' 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2014-12-21T22:11:31.437

您可以使用：

```
git submodule | awk '{ print $2 }' 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2018-01-27T07:30:03.430

按名称列出所有子模块：

`git submodule --quiet foreach --recursive 'echo $name'`

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2015-03-29T03:08:52.940

这对我有用：

```
git ls-files --stage | grep ^160000 
```

它基于这篇很棒的文章：*[了解 Git 子模块](https://web.archive.org/web/20200225152945/https://www.speirs.org/blog/2009/5/11/understanding-git-submodules.html)*

它必须阅读`grep ^160000`。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2013-10-29T13:14:30.183

我用这个：

```
git submodule status | cut -d' ' -f3-4 
```

输出（路径+版本）：

```
tools/deploy_utils (0.2.4) 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-06-02T18:25:17.793

> **请只是**子*模块路径*，女士...

```
git config --list | grep \^submodule | cut -f 2 -d . 
```

> ```
> Vendor/BaseModel
> Vendor/ObjectMatcher
> Vendor/OrderedDictionary
> Vendor/_ObjC
> Vendor/XCodeHelpers 
> ```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2015-07-29T09:02:46.117

[`git config`](http://git-scm.com/docs/git-config)允许指定配置文件。
并且`.gitmodules` *是*一个配置文件。

因此，在“[使用空格作为分隔符和剪切命令](https://stackoverflow.com/a/816824/6309)”的帮助下：

```
git config --file=.gitmodules --get-regexp ^^submodule.*\.path$ | cut -d " " -f 2 
```

这将只列出路径，每个声明的子模块一个。

正如[蒂诺](https://stackoverflow.com/users/490291/tino)[在评论中](https://stackoverflow.com/questions/12641469/list-submodules-in-a-git-repository/31695872#comment84215697_12641787)指出的那样：

> *   **对于其中包含空格**的子模块，这将失败。
> *   子模块路径可能包含**换行符**，如
>     
>     
>     
>     ```
>     git submodule add https://github.com/hilbix/bashy.git "sub module"
>       git mv 'sub module' $'sub\nmodule' 
>     ```

作为更强大的替代方案，Tino 建议：

> ```
> git config -z --file .gitmodules --get-regexp '\.path$' | \
>   sed -nz 's/^[^\n]*\n//p' | \
>   tr '\0' '\n' 
> ```
> 
> 对于其中带有换行符的路径（可以使用 来创建`git mv`），请不要使用 bash`| tr '\0' '\n'`并使用类似的东西`... | while IFS='' read -d '' path; do ...`进行进一步处理。
> 这需要一个现代的 bash 可以理解`read -d ''`（不要忘记 之间的空格`-d and ''`）。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-01-26T12:53:47.950

使用内置的 git 函数显示有关每个子模块的所有信息：

```
git submodule foreach -q git config -l 
```

或者只是 URL-s：

```
git submodule foreach -q git config remote.origin.url 
```

[从这里](https://stackoverflow.com/questions/913701/how-to-change-the-remote-repository-for-a-git-submodule#comment17230685_914090)偷来的。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2019-07-06T09:42:43.617

在我的 Git ^([1])版本中，每个 Git 子模块都有一个`name`和一个`path`. 它们不一定必须相同^([2])。以可靠的方式获取两者，而不首先检查子模块（`git update --init`），是一个棘手的 shell 巫术。

# 获取子模块列表`names`

我没有找到如何使用`git config`或任何其他`git`命令来实现此目的的方法。因此我们回到正则表达式`.gitmodules`（超级丑陋）。但它似乎有点安全，因为`git`限制了 submodule 允许的可能代码空间`names`。此外，由于您可能希望将此列表用于进一步的 shell 处理，因此下面的解决方案用`NULL`-bytes ( `\0`) 分隔条目。

```
$ sed -nre \
  's/^\[submodule \"(.*)\"]$/\1\x0/p' \
  "$(git rev-parse --show-toplevel)/.gitmodules" \
| tr -d '\n' \
| xargs -0 -n1 printf "%b\0" 
```

在你的脚本中：

```
#!/usr/bin/env bash

while IFS= read -rd '' submodule_name; do
  echo submodule name: "${submodule_name}"
done < <(
  sed -nre \
    's/^\[submodule \"(.*)\"]$/\1\x0/p' \
    "$(git rev-parse --show-toplevel)/.gitmodules" \
  | tr -d '\n' \
  | xargs -0 -n1 printf "%b\0"
) 
```

*注意*：`read -rd ''`需要`bash`并且不能与`sh`.

# 获取子模块列表`paths`

在我的方法中，我尝试**不**处理来自`git config --get-regexp`with `awk`, `tr`, `sed`, ... 的输出，而是将其传递给分隔回的零字节`git config --get`。这是为了避免子模块中出现换行符、空格和其他特殊字符（例如 Unicode）的问题`paths`。此外，由于您可能希望将此列表用于进一步的 shell 处理，因此下面的解决方案用`NULL`-bytes ( `\0`) 分隔条目。

```
$ git config --null --file .gitmodules --name-only --get-regexp '\.path$' \
| xargs -0 -n1 git config --null --file .gitmodules --get 
```

例如，在 Bash 脚本中，您可以：

```
#!/usr/bin/env bash

while IFS= read -rd '' submodule_path; do
  echo submodule path: "${submodule_path}"
done < <(
  git config --null --file .gitmodules --name-only --get-regexp '\.path$' \
  | xargs -0 -n1 git config --null --file .gitmodules --get
) 
```

*注意*：`read -rd ''`需要`bash`并且不能与`sh`.

* * *

# 脚注

## ^([1]) Git 版本

```
$ git --version
git version 2.22.0 
```

## ^([2])具有发散`name`和`path`

设置测试存储库：

```
$ git init test-name-path
$ cd test-name-path/
$ git checkout -b master
$ git commit --allow-empty -m 'test'
$ git submodule add ./ submodule-name
Cloning into '/tmp/test-name-path/submodule-name'...
done.
$ ls
submodule-name

$ cat .gitmodules
[submodule "submodule-name"]
    path = submodule-name
    url = ./ 
```

移动子模块使`name`和`path`发散：

```
$ git mv submodule-name/ submodule-path

$ ls
submodule-path

$ cat .gitmodules
[submodule "submodule-name"]
    path = submodule-path
    url = ./

$ git config --file .gitmodules --get-regexp '\.path$'
submodule.submodule-name.path submodule-path 
```

## 测试

设置测试存储库：

```
$ git init test
$ cd test/
$ git checkout -b master
$ git commit --allow-empty -m 'test'
$
$ git submodule add ./ simplename
Cloning into '/tmp/test/simplename'...
done.
$
$ git submodule add ./ 'name with spaces'
Cloning into '/tmp/test/name with spaces'...
done.
$
$ git submodule add ./ 'future-name-with-newlines'
Cloning into '/tmp/test/future-name-with-newlines'...
done.
$ git mv future-name-with-newlines/ 'name
> with
> newlines'
$
$ git submodule add ./ 'name-with-unicode-'
Cloning into '/tmp/test/name-with-unicode-'...
done.
$
$ git submodule add ./ sub/folder/submodule
Cloning into '/tmp/test/sub/folder/submodule'...
done.
$
$ git submodule add ./ name.with.dots
Cloning into '/tmp/test/name.with.dots'...
done.
$
$ git submodule add ./ 'name"with"double"quotes'
Cloning into '/tmp/test/name"with"double"quotes'...
done.
$
$ git submodule add ./ "name'with'single'quotes"
Cloning into '/tmp/test/name'with'single'quotes''...
done.
$ git submodule add ./ 'name]with[brackets'
Cloning into '/tmp/test/name]with[brackets'...
done.
$ git submodule add ./ 'name-with-.path'
Cloning into '/tmp/test/name-with-.path'...
done. 
```

`.gitmodules`：

```
[submodule "simplename"]
    path = simplename
    url = ./
[submodule "name with spaces"]
    path = name with spaces
    url = ./
[submodule "future-name-with-newlines"]
    path = name\nwith\nnewlines
    url = ./
[submodule "name-with-unicode-"]
    path = name-with-unicode-
    url = ./
[submodule "sub/folder/submodule"]
    path = sub/folder/submodule
    url = ./
[submodule "name.with.dots"]
    path = name.with.dots
    url = ./
[submodule "name\"with\"double\"quotes"]
    path = name\"with\"double\"quotes
    url = ./
[submodule "name'with'single'quotes"]
    path = name'with'single'quotes
    url = ./
[submodule "name]with[brackets"]
    path = name]with[brackets
    url = ./
[submodule "name-with-.path"]
    path = name-with-.path
    url = ./ 
```

### 获取子模块列表`names`

```
$ sed -nre \
  's/^\[submodule \"(.*)\"]$/\1\x0/p' \
  "$(git rev-parse --show-toplevel)/.gitmodules" \
| tr -d '\n' \
| xargs -0 -n1 printf "%b\0" \
| xargs -0 -n1 echo submodule name:
submodule name: simplename
submodule name: name with spaces
submodule name: future-name-with-newlines
submodule name: name-with-unicode-
submodule name: sub/folder/submodule
submodule name: name.with.dots
submodule name: name"with"double"quotes
submodule name: name'with'single'quotes
submodule name: name]with[brackets
submodule name: name-with-.path 
```

### 获取子模块列表`paths`

```
$ git config --null --file .gitmodules --name-only --get-regexp '\.path$' \
| xargs -0 -n1 git config --null --file .gitmodules --get \
| xargs -0 -n1 echo submodule path:
submodule path: simplename
submodule path: name with spaces
submodule path: name
with
newlines
submodule path: name-with-unicode-
submodule path: sub/folder/submodule
submodule path: name.with.dots
submodule path: name"with"double"quotes
submodule path: name'with'single'quotes
submodule path: name]with[brackets
submodule path: name-with-.path 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-07-25T10:36:14.887

如果没有任何`.gitmodules`文件，但子模块配置存在于`.git/modules/`：

```
find .git/modules/ -name config -exec grep url {} \; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-07-06T14:17:04.783

这是从 .gitmodules 解析 Git 子模块名称的另一种方法，无需 sed 或花哨的 IFS 设置。:-)

```
#!/bin/env bash

function stripStartAndEndQuotes {
  temp="${1%\"}"
  temp="${temp#\"}"
  echo "$temp"
}

function getSubmoduleNames {
  line=$1
  len=${#line} # Get line length
  stripStartAndEndQuotes "${line::len-1}" # Remove last character
}

while read line; do
  getSubmoduleNames "$line"
done < <(cat .gitmodules | grep "\[submodule.*\]" | cut -d ' ' -f 2-) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-08-27T06:41:16.283

获取路径

```
grep url .gitmodules | sed 's/.*= //' 
```

在 repos 中获取名称

```
grep path .gitmodules | sed 's/.*= //' 
```

# import - Ubercart Feed Mappers 导入属性 - 如何

> ID：12641472
> 
> 赞同：3
> 
> 时间：2012-09-28T13:58:46.327
> 
> 标签：import, drupal-7, ubercart

我有一个带有 Ubercart 3 的 Drupal 7 实例，我还使用 Ubercart Feed Mappers 模块来映射产品字段的导入，我的所有字段、图像和类别都运行良好，但没有属性。

我已经搜索了高低的答案或简短的如何为每个产品导入属性和多个属性，但没有成功，有人知道怎么做吗？

# c - c用结构指针数组写入和读取文件

> ID：12641474
> 
> 赞同：1
> 
> 时间：2012-09-28T13:58:50.480
> 
> 标签：c, pointers, file-io, struct, io

我在 c 中有一个数据结构，它是一个结构指针数组：

```
struct trex *trex_arr[128];

struct trex{
    struct trex *next;
    char name[LEN];
    unsigned int id; 
    int groups[LEN];
    struct list *filenames; //linked list
    unsigned int fn_len;
}; 
```

我想将数组写入文件。我知道我需要在“下一个”指针和链表中的每个元素中写入对象，但是我该怎么做才能成功地将它读回到我的原始数组中（数组中有链接也）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:15:28.813

顺便说一句，最简单的方法是按顺序写出结构，以便：

```
[trex item #1]
[list item #1]
[list item #2]
[list item #3]
[trex item #2]
[list item #1]
[list item #2]
[list item #3]
[list item #4]
etc... 
```

（当然，这只是其中的一个要点。这些是二进制写入，这只是视觉效果。）

我希望这`fn_len`描述了链接列表中的项目数`struct list *filenames`。如果是这样，这是一个快照。

写作时：

1.  写出`trex`链表中的第一个结构
2.  循环并一次写出`struct list *filenames`第一个`trex`结构的
3.  对链表中的下一项重复#1，`trex`直到链表用完。

在阅读时，请记住：*你所有的指针最初都是毫无价值的*。您必须自己将它们缝合在一起。但是这些结构在文件中以正确的顺序排列。

1.  阅读第一个`trex`结构。你知道它的大小，阅读它不是问题。`next`将指针固定为空。
2.  循环并一次读取每`struct list *filenames`一个。您知道它们有多少是因为`fn_len`您刚刚阅读的结构。将该链接列表缝合在一起并将其附加到 trex 结构。
3.  对下一个结构重复 #1`trex`直到 EOF，将结构适当地连接到链表的末尾。

那应该照顾它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:35:42.690

在保存到文件期间，请通过`trex_arr`. 每个指针表示一个单独的链表的开始。对于每个这样的列表，您应该分配一些 ID（任何数字都可以，但相邻列表应该有不同的 ID）。在保存每个`trex`结构之前，将 ID 写入文件。

在每个结构之后，您将拥有文件名列表（您不需要任何 ID，因为您知道列表中的元素数量）。

假设我们有这样的结构：

```
trex_arr[0]: trex (3 filenames) -> trex (2 filenames) -> NULL
trex_arr[1]: trex (2 filenames) -> NULL
trex_arr[2]: trex (1 filenames) -> NULL 
```

结果，您将在输出文件中包含以下内容：

```
ID0
trex0
filename0
filename1
filename2
ID0
trex1
filename0
ID1
trex2
filename0
filename1
ID2
trex3
filename0 
```

读回数据相当简单。您应该跟踪 ID。一旦它发生变化（例如从`ID0`到`ID1`），您需要前进到 的下一个条目`trex_arr`。还要记住，当您读取文件时，读取的结构中的指针是无效的，您应该手动正确修复它们。

或者，您可以在保存期间遍历每个链表直到结束，以找出其长度并`trex`在保存每个链之前存储结构的数量。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-28T14:12:11.087

我不太确定您的要求是什么，但如果我理解正确，您只是希望能够在将您找到的所有内容写入文件后到达末尾时返回列表的开头？

我要做的是存储列表的第一个结构的地址，以便您可以随时回到开头。另一种解决方案是制作一个上一个/下一个双链列表，这样您就可以毫无问题地来回走动。将您在第一个链接的 prev 中的喜欢设置为 0，这样您就可以知道它是开始。

如果您能提供更多详细信息，我可能会更有帮助，但不太确定您的要求。

# android - 如何以编程方式添加 IMAP/POP3 帐户

> ID：12641482
> 
> 赞同：3
> 
> 时间：2012-09-28T13:59:06.740
> 
> 标签：android, accounts

我正在编写一个应用程序以编程方式添加 IMAP/POP3 帐户。问题是，我无法在“帐户和同步设置”中显示它。

```
 Account account = new Account(context);
   account.se;
   account.setDescription("acc added thr prog"); 
   account.setAutomaticCheckIntervalMinutes(10);
   account.setEmail("UserName@gmail.com");
   account.setDraftsFolderName("Drafts");
   account.setOutboxFolderName("OutBox");
   account.setSentFolderName("Sent");
   account.setTrashFolderName("Trash");
   account.setName("Tester");
   account.setNotifyNewMail(true);
   account.setSenderUri(mContext,"smtp+ssl+://UserName%40gmail.com:Password@smtp.gmail.com");
   mAccount.setStoreUri(mContext,"imap+ssl+://UserName%40gmail.com:Password@imap.gmail.com");
   account.setDeletePolicy(10); 
   account.setVibrate(true);
   mPrefer = Preferences.getPreferences(getInstrumentation().getContext()); 
   account.save(mPrefer);
   Object mInstrumenatation;
   Email.setServicesEnabled(mInstrumenatation.getTargetContext()); 
```

谢谢。

# opencv - bash 中的人脸检测：只需返回找到的人脸数量

> ID：12641488
> 
> 赞同：3
> 
> 时间：2012-09-28T10:23:48.307
> 
> 标签：opencv

我需要在命令行上计算一张图片中的面孔数量（要在 bash 脚本中使用：）`do-something-if-picture-passed-contains-faces, else try next picture`。

到目前为止，我的`facedetect` `OpenCV`示例正在运行，但此示例持续显示图片 - 我只需要返回一个数字（或者，只是一个错误代码：`0`如果没有找到面部，`1`如果找到了面部）。

可悲的是，我的 C++ 技能很糟糕，有人能指出我正确的方向吗？

我会使用 python 或 ruby​​，但在 Ubuntu 12.04 中，与 OpenCV 的绑定似乎更糟糕，没有一个示例正常工作（或根本不工作）。

谢谢！

**编辑：**我正在谈论的示例由 OpenCV 在 Ubuntu 下安装

`cat /usr/share/doc/opencv-doc/examples/c/facedetect.cpp`：

```
#include "opencv2/objdetect/objdetect.hpp"
#include "opencv2/highgui/highgui.hpp"
#include "opencv2/imgproc/imgproc.hpp"

#include <iostream>
#include <stdio.h>

using namespace std;
using namespace cv;

void help()
{
    cout << "\nThis program demonstrates the cascade recognizer. Now you can use Haar or LBP features.\n"
            "This classifier can recognize many ~rigid objects, it's most known use is for faces.\n"
            "Usage:\n"
            "./facedetect [--cascade=<cascade_path> this is the primary trained classifier such as frontal face]\n"
               "   [--nested-cascade[=nested_cascade_path this an optional secondary classifier such as eyes]]\n"
               "   [--scale=<image scale greater or equal to 1, try 1.3 for example>\n"
               "   [filename|camera_index]\n\n"
            "see facedetect.cmd for one call:\n"
            "./facedetect --cascade=\"../../data/haarcascades/haarcascade_frontalface_alt.xml\" --nested-cascade=\"../../data/haarcascades/haarcascade_eye.xml\" --scale=1.3 \n"
            "Hit any key to quit.\n"
            "Using OpenCV version " << CV_VERSION << "\n" << endl;
}

void detectAndDraw( Mat& img,
                   CascadeClassifier& cascade, CascadeClassifier& nestedCascade,
                   double scale);

String cascadeName = "../../data/haarcascades/haarcascade_frontalface_alt.xml";
String nestedCascadeName = "../../data/haarcascades/haarcascade_eye_tree_eyeglasses.xml";

int main( int argc, const char** argv )
{
    CvCapture* capture = 0;
    Mat frame, frameCopy, image;
    const String scaleOpt = "--scale=";
    size_t scaleOptLen = scaleOpt.length();
    const String cascadeOpt = "--cascade=";
    size_t cascadeOptLen = cascadeOpt.length();
    const String nestedCascadeOpt = "--nested-cascade";
    size_t nestedCascadeOptLen = nestedCascadeOpt.length();
    String inputName;

    help();

    CascadeClassifier cascade, nestedCascade;
    double scale = 1;

    for( int i = 1; i < argc; i++ )
    {
        cout << "Processing " << i << " " <<  argv[i] << endl;
        if( cascadeOpt.compare( 0, cascadeOptLen, argv[i], cascadeOptLen ) == 0 )
        {
            cascadeName.assign( argv[i] + cascadeOptLen );
            cout << "  from which we have cascadeName= " << cascadeName << endl;
        }
        else if( nestedCascadeOpt.compare( 0, nestedCascadeOptLen, argv[i], nestedCascadeOptLen ) == 0 )
        {
            if( argv[i][nestedCascadeOpt.length()] == '=' )
                nestedCascadeName.assign( argv[i] + nestedCascadeOpt.length() + 1 );
            if( !nestedCascade.load( nestedCascadeName ) )
                cerr << "WARNING: Could not load classifier cascade for nested objects" << endl;
        }
        else if( scaleOpt.compare( 0, scaleOptLen, argv[i], scaleOptLen ) == 0 )
        {
            if( !sscanf( argv[i] + scaleOpt.length(), "%lf", &scale ) || scale < 1 )
                scale = 1;
            cout << " from which we read scale = " << scale << endl;
        }
        else if( argv[i][0] == '-' )
        {
            cerr << "WARNING: Unknown option %s" << argv[i] << endl;
        }
        else
            inputName.assign( argv[i] );
    }

    if( !cascade.load( cascadeName ) )
    {
        cerr << "ERROR: Could not load classifier cascade" << endl;
        cerr << "Usage: facedetect [--cascade=<cascade_path>]\n"
            "   [--nested-cascade[=nested_cascade_path]]\n"
            "   [--scale[=<image scale>\n"
            "   [filename|camera_index]\n" << endl ;
        return -1;
    }

    if( inputName.empty() || (isdigit(inputName.c_str()[0]) && inputName.c_str()[1] == '\0') )
    {
        capture = cvCaptureFromCAM( inputName.empty() ? 0 : inputName.c_str()[0] - '0' );
        int c = inputName.empty() ? 0 : inputName.c_str()[0] - '0' ;
        if(!capture) cout << "Capture from CAM " <<  c << " didn't work" << endl;
    }
    else if( inputName.size() )
    {
        image = imread( inputName, 1 );
        if( image.empty() )
        {
            capture = cvCaptureFromAVI( inputName.c_str() );
            if(!capture) cout << "Capture from AVI didn't work" << endl;
        }
    }
    else
    {
        image = imread( "lena.jpg", 1 );
        if(image.empty()) cout << "Couldn't read lena.jpg" << endl;
    }

    cvNamedWindow( "result", 1 );

    if( capture )
    {
        cout << "In capture ..." << endl;
        for(;;)
        {
            IplImage* iplImg = cvQueryFrame( capture );
            frame = iplImg;
            if( frame.empty() )
                break;
            if( iplImg->origin == IPL_ORIGIN_TL )
                frame.copyTo( frameCopy );
            else
                flip( frame, frameCopy, 0 );

            detectAndDraw( frameCopy, cascade, nestedCascade, scale );

            if( waitKey( 10 ) >= 0 )
                goto _cleanup_;
        }

        waitKey(0);

_cleanup_:
        cvReleaseCapture( &capture );
    }
    else
    {
        cout << "In image read" << endl;
        if( !image.empty() )
        {
            detectAndDraw( image, cascade, nestedCascade, scale );
            waitKey(0);
        }
        else if( !inputName.empty() )
        {
            /* assume it is a text file containing the
            list of the image filenames to be processed - one per line */
            FILE* f = fopen( inputName.c_str(), "rt" );
            if( f )
            {
                char buf[1000+1];
                while( fgets( buf, 1000, f ) )
                {
                    int len = (int)strlen(buf), c;
                    while( len > 0 && isspace(buf[len-1]) )
                        len--;
                    buf[len] = '\0';
                    cout << "file " << buf << endl;
                    image = imread( buf, 1 );
                    if( !image.empty() )
                    {
                        detectAndDraw( image, cascade, nestedCascade, scale );
                        c = waitKey(0);
                        if( c == 27 || c == 'q' || c == 'Q' )
                            break;
                    }
                    else
                    {
                        cerr << "Aw snap, couldn't read image " << buf << endl;
                    }
                }
                fclose(f);
            }
        }
    }

    cvDestroyWindow("result");

    return 0;
}

void detectAndDraw( Mat& img,
                   CascadeClassifier& cascade, CascadeClassifier& nestedCascade,
                   double scale)
{
    int i = 0;
    double t = 0;
    vector<Rect> faces;
    const static Scalar colors[] =  { CV_RGB(0,0,255),
        CV_RGB(0,128,255),
        CV_RGB(0,255,255),
        CV_RGB(0,255,0),
        CV_RGB(255,128,0),
        CV_RGB(255,255,0),
        CV_RGB(255,0,0),
        CV_RGB(255,0,255)} ;
    Mat gray, smallImg( cvRound (img.rows/scale), cvRound(img.cols/scale), CV_8UC1 );

    cvtColor( img, gray, CV_BGR2GRAY );
    resize( gray, smallImg, smallImg.size(), 0, 0, INTER_LINEAR );
    equalizeHist( smallImg, smallImg );

    t = (double)cvGetTickCount();
    cascade.detectMultiScale( smallImg, faces,
        1.1, 2, 0
        //|CV_HAAR_FIND_BIGGEST_OBJECT
        //|CV_HAAR_DO_ROUGH_SEARCH
        |CV_HAAR_SCALE_IMAGE
        ,
        Size(30, 30) );
    t = (double)cvGetTickCount() - t;
    printf( "detection time = %g ms\n", t/((double)cvGetTickFrequency()*1000.) );
    for( vector<Rect>::const_iterator r = faces.begin(); r != faces.end(); r++, i++ )
    {
        Mat smallImgROI;
        vector<Rect> nestedObjects;
        Point center;
        Scalar color = colors[i%8];
        int radius;
        center.x = cvRound((r->x + r->width*0.5)*scale);
        center.y = cvRound((r->y + r->height*0.5)*scale);
        radius = cvRound((r->width + r->height)*0.25*scale);
        circle( img, center, radius, color, 3, 8, 0 );
        if( nestedCascade.empty() )
            continue;
        smallImgROI = smallImg(*r);
        nestedCascade.detectMultiScale( smallImgROI, nestedObjects,
            1.1, 2, 0
            //|CV_HAAR_FIND_BIGGEST_OBJECT
            //|CV_HAAR_DO_ROUGH_SEARCH
            //|CV_HAAR_DO_CANNY_PRUNING
            |CV_HAAR_SCALE_IMAGE
            ,
            Size(30, 30) );
        for( vector<Rect>::const_iterator nr = nestedObjects.begin(); nr != nestedObjects.end(); nr++ )
        {
            center.x = cvRound((r->x + nr->x + nr->width*0.5)*scale);
            center.y = cvRound((r->y + nr->y + nr->height*0.5)*scale);
            radius = cvRound((nr->width + nr->height)*0.25*scale);
            circle( img, center, radius, color, 3, 8, 0 );
        }
    }
    cv::imshow( "result", img );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:03:44.177

1.  更改`void detectAndDraw`为`int detectAndDraw`
2.  将`int detectAndDraw`返回`faces.end()-faces.begin();` ，您将获得图片中的面孔数量。希望这会有所帮助

# c# - “选择”元素的顺序是否有所不同？

> ID：12641494
> 
> 赞同：3
> 
> 时间：2012-09-28T13:59:28.503
> 
> 标签：c#

我正在使用如图所示声明的对象。

```
DataCollection<Entity> collection = GetDataCollection(...); 
```

然后，我挑选出如下两组数据。

```
IEnumerable<String> 
  array_1 = collection.Select(
    element => element.Attributes["attribute_1"] as String),
  array_2 = collection.Select(
    element => element.Attributes["attribute_2"] as String); 
```

我非常好奇这两个数组是否保证具有相同的顺序。即，如果它们的单独顺序必须与原始顺序相同。或者，至少，如果顺序因任何原因发生变化，`i`第一个单独列表中的第 th 个元素是否仍然对应于另一个列表中的`i`第 th 个元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:01:40.333

不能保证它们是相同的。实际上，您可能会注意到该顺序通常与原始集合一致。

如果您担心一致性，只需添加一个`OrderBy`子句以获得您需要的顺序（或至少一个在两个结果集合之间保持一致的顺序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:04:37.157

检查这个答案：

[使用 LINQ 保持顺序](https://stackoverflow.com/questions/204505/preserving-order-with-linq)

至少从这个答案看来，Select 调用保证是相同的顺序。

我仍然会使用 OrderBy(...) 来遵循这一点。似乎您永远无法确定 LINQ 调用，所以如果有人进来并添加了额外的 LINQ 调用，他们可能不知道您期望它们是相同的顺序。

# php - 如何在 wordpress 管理员创建的页面中添加 php 代码

> ID：12641496
> 
> 赞同：0
> 
> 时间：2012-09-28T13:59:32.163
> 
> 标签：php, wordpress

当我们从管理员创建一个新页面时。我们允许向页面添加标记语言，如 html 和内容。但为什么我无法添加 php 脚本。像 `<?php function... ?>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:08:38.000

它不起作用，它也不是很安全。内容和软件应该分开。
您可能还需要结帐[短代码](http://codex.wordpress.org/Shortcode_API)并添加其中一些来做您想做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:13:19.437

有一个名为 Exec-PHP 的插件[http://wordpress.org/extend/plugins/exec-php/](http://wordpress.org/extend/plugins/exec-php/)可以让您在帖子或页面上编写自己的 php。

正如@janw 所说，它不是很安全，所以请谨慎使用。

# matlab - Matlab Mex 文件错误

> ID：12641497
> 
> 赞同：0
> 
> 时间：2012-09-28T13:59:46.683
> 
> 标签：matlab

当我在 malab 2012b 中运行 mex -setup 来配置编译器时，出现以下错误：

`C:\Program Files(x86)\MATLAB\R2012\sys\perl\win32\bin\perl.exe`不是有效的Win32应用程序。

实际上，此错误不在 matlab 命令中，它在我面前弹出框。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:37:49.743

我用谷歌搜索了你的路径，发现了这个： http: [//www.mathworks.com/matlabcentral/newsreader/view_thread/268579](http://www.mathworks.com/matlabcentral/newsreader/view_thread/268579)

# asp.net - 将事件声明为字段或属性，有什么区别？

> ID：12641500
> 
> 赞同：1
> 
> 时间：2012-09-28T13:59:55.063
> 
> 标签：asp.net, events, event-handling

我在博客中读到（现在不记得了），建议在定义许多事件时使用**属性语法**（添加、删除块），而这些事件中的任何一个都应该在任何时候处理。在其他条件下使用**字段语法**很好。

这是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:03:47.283

如果通过“属性语法”你的意思是覆盖添加/删除即

```
public event EventHandler MyEvent
{
    add
    {
        ...
    }
    remove
    {
        ...
    }
} 
```

那么只有当您想更改特定事件的添加/删除行为时，您才会这样做，即当您在事件上调用`+=`/时会发生什么`-=`。

对于事件的一般用途，您几乎总是使用字段声明，即

```
public event EventHandler MyEvent; 
```

# javascript - 用于旋转下拉菜单的 Jquery/Javascript

> ID：12641503
> 
> 赞同：2
> 
> 时间：2012-09-28T14:00:01.630
> 
> 标签：javascript, jquery, html, css, rotation

我需要一个下拉菜单以逆时针旋转 90 度出现 - 以便下拉选择“按钮”文本垂直显示，然后选项同样以旋转、侧向的方式滑出，并带有垂直文本。（上下文：用户需要从图表的 Y 轴的多个选项中选择一个标题 - 并且下拉菜单需要存在于标题最终将出现的位置，同样旋转。）

html目前简单如下：

```
<select id="title"  >
<option value="title-0">Choose a chart title</option>
<option value="title-1">title 1</option>
<option value="title-2">title 2</option>
<option value="title-3">title 3</option>
</select> 
```

我知道这有 CSS3 的东西。我已经提到过： [需要 Jquery 代码来旋转整个 div](https://stackoverflow.com/questions/7292569/need-jquery-code-for-rotate-a-whole-div) 所以我尝试过这样的 CSS，或者类似的：

```
.box_rotate {
-webkit-transform: rotate(90deg);  /* Saf3.1+, Chrome */
-moz-transform: rotate(90deg);  /* FF3.5+ */
-ms-transform: rotate(90deg);  /* IE9 */
-o-transform: rotate(90deg);  /* Opera 10.5 */
transform: rotate(90deg);  
filter: progid:DXImageTransform.Microsoft.Matrix(/* IE6–IE9 */ 
M11=6.123233995736766e-17, M12=-1, M21=1, M22=6.123233995736766e-17, sizingMethod='auto expand');
zoom: 1;
} 
```

发生的情况是 - 至少在 Firefox 15 中 - 选择“按钮”被旋转，但下拉选项在激活菜单时保持在水平位置，否则它们将是 - （并且下拉链接不起作用）。

我尝试将旋转类分别应用于选项标签、选择标签或全封闭 div。这些似乎都无法解决问题。

显然，“很多插件都能够为 jQuery 添加旋转支持”。（根据前面提到的SO问题）。我见过的似乎只适用于图像或简单的 div 元素 - 没有任何东西实际上适用于整个下拉菜单。

有任何想法吗？.. 首选 Javascript/jquery 解决方案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:05:12.523

这是一个浏览器错误：[https ://bugzilla.mozilla.org/show_bug.cgi?id=455164](https://bugzilla.mozilla.org/show_bug.cgi?id=455164)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:05:07.710

`optgroup`当旋转效果应用于元素时，它似乎适用于 FX15 ，

[http://jsbin.com/ifatiy/1/edit](http://jsbin.com/ifatiy/1/edit)

```
<select>
    <optgroup>
       <option value="title-0">Choose a chart title</option>
       <option value="title-1">title 1</option>
       <option value="title-2">title 2</option>
       <option value="title-3">title 3</option>
    </optgroup>
</select> 
```

但您可能还需要指定高度（并重置 optgroup 引入的样式）

# php - 使用 cURL 向 Arduino 发送 HTTP POST

> ID：12641505
> 
> 赞同：3
> 
> 时间：2012-09-28T14:00:18.677
> 
> 标签：php, http, curl, arduino

[我正在尝试使用带有cURL的服务器的以太网屏蔽](http://en.wikipedia.org/wiki/CURL)**向**我的 Arduino发送 HTTP POST ，但它不起作用。如果我通过 HTML 表单*或 Mac OS X 的终端 cURL*发送 POST 值，Arduino 会接收数据，所以我认为 Arduino 代码是可以的。

 *这是我的 cURL 函数：

```
function curler($what,$arduinoip){
    $url = "http://".$arduinoip;
    extract($what);
    $fields = array(
         'blue' => urlencode($blue)
    );
    foreach($fields as $key=>$value){$fields_string .= $key.'='.$value.'&';}
    $fields_strings = rtrim($fields_string, '&');
    // hasta aca todo bien
    $ch = curl_init();
    curl_setopt($ch,CURLOPT_URL, $url);
    curl_setopt($ch,CURLOPT_POST, true);
    curl_setopt($ch,CURLOPT_CONNECTTIMEOUT, 20);
    curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_strings);
    //execute post
    $result = curl_exec($ch);
    $curl_errno = curl_errno($ch);
    $curl_error = curl_error($ch);
    curl_close($ch);
    if ($curl_errno > 0) {
        echo "cURL Error ($curl_errno): $curl_error\n";
    } else {
        echo "Data received: $result\n";
    }
} 
```

我得到两个回应：

> cURL 错误 (28)：connect() 超时！

和

> cURL 错误 (7): 无法连接到主机

如果未声明**CURLOPT_CONNECTTIMEOUT**，则它不返回任何内容。

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T17:13:19.963

不要在您的主机 IP 之前添加“http://”：

```
$url = $arduinoip; 
```

尝试增加你的时间限制：

```
//200+ maybe?    
curl_setopt($ch,CURLOPT_CONNECTTIMEOUT, 250); 
```*

# java - 将 GPS 坐标传递给手机

> ID：12641507
> 
> 赞同：0
> 
> 时间：2012-09-28T14:00:19.117
> 
> 标签：java, android, gps, ddms

我想知道是否有办法将 GPS 坐标传递给真实设备。

**例如 - 当我使用模拟器时，我使用 Eclipse 上的 DDMS 将 GPS 坐标传递给模拟器 - 但是，当我想将坐标传送到手机**时，DDMS 似乎不起作用。我想这样做，因为我的 GPS 天线似乎没有捕捉到任何信号，因为我在一个封闭的空间工作，并且有必要在我的手机上模拟我的应用程序

因此，我想知道我是否可以通过我的电脑将 GPS 坐标传递到我的手机

我真的很感激任何回复

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:03:50.000

一个名为 Location Spoofer 的应用程序可以完成这项工作

# internet-explorer - 尝试在使用 IE=EmulateIE7 的页面上的 iframe 中使用 IE=edge X-UA-Compatible

> ID：12641511
> 
> 赞同：28
> 
> 时间：2012-09-28T14:00:29.990
> 
> 标签：internet-explorer, iframe, mode, quirks-mode

我有一个页面将包含在他们使用以下内容的页面上的 iframe 中：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/> 
```

理想情况下，我想使用用户正在使用的浏览器可用的最新标准模式来呈现我的页面。这可能吗？

我试过包括

```
<meta http-equiv="X-UA-Compatible" content="IE=edge"/> 
```

在我的页面上，以及更改我的 web 应用程序以包含值为 'IE=edge' 的 'X-UA-Compatible' HTTP 标头，但我似乎无法让它做我想做的事。

奇怪的是，例如，如果我有两个页面，第一个包含 iframe，另一个是 iframe 中显示的内容，如下所示：

```
<!doctype html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
    <script>
        console.log("Page document mode: "+document.documentMode);
    </script> 
</head>  
<body>
<iframe src="iframepage.html" /> 
</body>
</html> 
```

和

```
<!doctype html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script>
        console.log("Iframe document mode: "+document.documentMode);
    </script> 
</head>
<body>
</body>
</html> 
```

输出是相当出乎意料的

```
Page document mode: 7
Iframe document mode: 8 
```

文档模式8从何而来？以及如何将 iframe 文档变成 9 或更高版本？

如果有人能指出我正确的方向，我将永远感激不尽！！谢谢，尼克

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-22T09:13:34.420

IE 不允许在帧层次结构中混合 IE9+ 和旧模式。如果您的顶级文档是 IE7，那么您可以在任何内部文档中获得的最高文档是 IE8。同样，您将无法在 IE9 模式页面中托管除 IE9 模式文档之外的任何内容。

# python - 使用fabric切换到不同的用户

> ID：12641514
> 
> 赞同：11
> 
> 时间：2012-09-28T14:00:43.173
> 
> 标签：python, deployment, fabric

我最近开始研究用于远程部署的结构。我需要切换到差异用户（从我登录的用户）并且无法弄清楚。甚至有可能，如果可以，怎么办？我当前的用户没有`sudo`权限。

我尝试更改以下环境变量

```
env.sudo_prefix = "su newUser -c "
env.sudo_prompt = "Password:" 
```

但是fabric不等待'newUser'的密码输入并且失败。

```
out: Password: 
[oldUser@ec2-111-11-111-111.compute-1.amazonaws.com] out: su: incorrect password

Fatal error: sudo() received nonzero return code 1 while executing!

Requested: touch x
Executed: su newUser -c  -u "root"  /bin/bash -l -c "cd /home/oldUser/upgrade && touch x"

Aborting.
Disconnecting from oldUser@ec2-111-11-111-111.compute-1.amazonaws.com... done. 
```

更新：

正如 JF Sebastian 所建议的那样，`su newUser -c`它可以工作，但它会提示每个服务器的每个命令的密码，这违背了自动化的目的。Fabric中有什么方法可以根据提示传递相同的值（在这种情况下，它总是`Password:`）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-28T22:58:29.340

谢谢[JF Sebastian](https://stackoverflow.com/users/4279/j-f-sebastian)，有几个问题。

1.  Fabric 懒惰地建立连接，所以我必须在调用 su 之前建立一个虚拟连接以避免上下文切换。
2.  密码需要存储在全局范围内，以便可以重用。Fabric 不会将其放入缓存中以用于覆盖 su 命令。

这就是最终要做的事情。它的工作。

```
pwd = None
@hosts('myhost.com')
def test():
    with cd('/home/oldUser/upgrade'):
        run('ls')  #This is to connect aggressively (instead of lazily)
        global pwd  #Change the scope of pwd
        if pwd is None:
            pwd = getpass.getpass('enter password for newUser')

        execute(su, pwd, 'newUser', 'touch x')  
        run ('ls')
        execute(su, pwd, 'newUser', 'rm x') 
        run ('ls')

def su(pwd, user, command):
    with settings(
        password= "%s" % pwd,
        sudo_prefix="su %s -c " % user,
        sudo_prompt="Password:"
        ):
        sudo(command) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-28T18:19:29.763

如果您不能 ssh as`newuser`并且不能使用`sudo(command, user='newuser')`：

```
import getpass # just for demonstration
from fabric.api import sudo, settings

def su(user, command):
    with settings(password=getpass.getpass('enter password for %s: ' % user),
                  sudo_prefix="su %s -c " % user,
                  sudo_prompt="Password:"):
        sudo(command) 
```

# objective-c - UIScrollView contentOffset CoreMotion 错误

> ID：12641519
> 
> 赞同：1
> 
> 时间：2012-09-28T14:00:58.297
> 
> 标签：objective-c, ios, xcode

当我尝试使用 CoreMotion 移动 UIScrollView 的内容时遇到问题。

问题是，我有一个大约 5000 像素的背景，在一个容器内，它位于我的 scrollView 内（是一个横向应用程序）；我已经设置了`self.scrollView.bounces = FALSE;`，我的运动值是`attitude.pitch * 10.0;`，当我将内容移动到里面并且它到达边缘时，`pointZero`或者`self.scrollView.contentSize.width`它不遵守边界并继续在白屏中移动，就像它没有限制一样。

所以，我设置了一个验证（下面的代码），但是当它到达`pointZero`它应该停止但仍然给我一个白色的小边框。我设置了一个 NSLog ，我看到它`contentOffset`仍在继续`x =-14`，就像反弹是活跃的一样。音高值控制，因为当音高值为零时，内容保持在`pointZero`，当我提高音高值时，我会一直持续到 -14。

我认为这是我的验证有问题，如果有人能提供帮助，我将非常感激！

```
self.accel = attitude.pitch *10.0;

//"pointZERO"----------------

if (self.gameArea.contentOffset.x <= self.gameArea.frame.origin.x) {
    NSLog(@"%2.f",self.gameArea.contentOffset.x);
    self.gameArea.contentOffset = CGPointZero;
 } else {
    self.gameArea.contentOffset = CGPointMake(self.gameArea.contentOffset.x + self.accel,0.0);
}

 //"END OF SCREEN"------------------------

if (self.gameArea.contentOffset.x + self.gameArea.frame.size.width >= self.gameArea.contentSize.width) {
    NSLog(@"%2.f",self.gameArea.contentOffset.x);
    self.gameArea.contentOffset = CGPointMake(self.gameArea.contentSize.width - self.gameArea.frame.size.width  ,0.0);
 } else {
    self.gameArea.contentOffset = CGPointMake(self.gameArea.contentOffset.x + self.accel,0.0);
 } 
```

# apache - htacces：如何仅在某个域上重写 URL？

> ID：12641521
> 
> 赞同：1
> 
> 时间：2012-09-28T14:01:02.063
> 
> 标签：apache, .htaccess

我有一家小型托管公司，

我希望我的主托管域使用“www”。总是因此我在 HTACCESS 中有这个：

```
# Redirect non-www urls to www
RewriteEngine on
RewriteCond %{HTTP_HOST} !^www\.givun\.co\.il
RewriteRule (.*) http://www.givun.co.il/$1 [R=301,L] 
```

问题是我还停放了其他域，这个脚本搞砸了传递给他们的内容，它基本上提供了主页。

是否可以更改此代码，使其仅在 givun.co.il 域上重写而不在停放域上重写？

任何帮助，将不胜感激，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:05:04.847

我可能误解了您的问题，但据我了解，您想将[http://givun.co.il/](http://givun.co.il/) ... 的所有内容重写为[http://www.givun.co.il/](http://www.givun.co.il/) ...

在那种情况下，您是否尝试过将其作为您的条件进行搜索？IE：

```
# Redirect non-www urls to www
RewriteEngine on
RewriteCond %{HTTP_HOST} ^givun\.co\.il
RewriteRule (.*) http://www.givun.co.il/$1 [R=301,L] 
```

# powershell - 转换为 powershell 脚本

> ID：12641522
> 
> 赞同：1
> 
> 时间：2012-09-28T14:01:03.393
> 
> 标签：powershell, code-conversion

```
 @echo off

::
:: Grabbing the users input of job number to create
:: 
SET /P JobNum="Enter Job Number: "

::
:: Creating the job number folder structure
::
MKDIR "\\server\jobs\%JobNum%"
MKDIR "\\server\jobs\%JobNum%\DataPrep"
MKDIR "\\server\jobs\%JobNum%\DataPrep\Data"
MKDIR "\\server\jobs\%JobNum%\DataPrep\Data\Input"
MKDIR "\\server\jobs\%JobNum%\DataPrep\Data\Working"
MKDIR "\\server\jobs\%JobNum%\DataPrep\Programs"
MKDIR "\\server\jobs\%JobNum%\DataPrep\Docs"
MKDIR "\\server\jobs\%JobNum%\Prepress"
MKDIR "\\server\jobs\%JobNum%\Prepress\Working"
MKDIR "\\server\jobs\%JobNum%\Prepress\PNetImages"
MKDIR "\\server\jobs\%JobNum%\CSR"
MKDIR "\\server\jobs\%JobNum%\Production"
MKDIR "\\server\jobs\%JobNum%\Production\MailDocs"
MKDIR "\\server\jobs\%JobNum%\Production\Output" 
```

需要将其转换为 PS 脚本。不确定 PS 命令以及它们如何从批处理文件中转换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T04:04:22.647

尝试这样的事情：

$JobNum = Read-Host -Prompt "Enter Job Number: "
("",
"\DataPrep",
"\DataPrep\Data",
"\DataPrep\Data\Input",
"\DataPrep\Data\Working",
"\ DataPrep\Programs"、
"\DataPrep\Docs"、
"\Prepress"、
"\Prepress\Working"、
"\Prepress\PNetImages"、
"\CSR"、
"\Production"、
"\Production\MailDocs"、
"\生产\输出") |
foreach-object { new-item -type directory -path "\server\jobs\$JobNum$_" }

# html - PHP DomNode->insertBefore()

> ID：12641523
> 
> 赞同：4
> 
> 时间：2012-09-28T14:01:06.713
> 
> 标签：html, domdocument, php

我正在尝试在我的 html 字符串中插入节点。我的目标是在每个 h2 标签之前插入一个元素。

为此，我正在使用：

```
$htmlString = "<h2>some html</h2>";

$DOM = new DOMDocument();
$DOM->loadHTML($htmlString);

$itemTitles = $DOM->getElementsByTagName('h2');

for($i = 0; $i < $itemTitles->length; $i ++)
{
    $helpNavigatorContents[] = $itemTitles->item($i)->nodeValue;
    $textBefore = new DOMNode(
        '<a name="'.$itemTitles->item($i)->nodeValue.'"></a>'
    );
    $itemTitles->item($i)->parentNode->insertBefore(
        $textBefore, 
        $itemTitles->item($i)
    );
}

$htmlString = $DOM->saveHTML($DOM); 
```

在这里我有一个问题`$textBefore`。当我声明`$textBefore`为 a`DOMText`时，我可以在节点之前插入文本，但是当我尝试使用 时`DOMNode`，我收到以下错误（[Demo](https://eval.in/34679)）：

> 警告：DOMNode::insertBefore()：无法获取 DOMNode

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T14:24:19.597

代码没有任何意义。`DOMNode`没有构造函数。它根本不应该被创建。您应该创建特定的节点类型`DOMDocument`以使它们与文档相关联。

假设您想在所有 H2 元素前添加一个锚点，这是如何做到的：

```
libxml_use_internal_errors(true);
$DOM = new DOMDocument();
$DOM->loadHTML($htmlString);
$DOM->preserveWhiteSpace = false;

foreach ($DOM->getElementsByTagName('h2') as $h2) {
    $a = $DOM->createElement('a');
    $a->setAttribute('name', $h2->nodeValue);
    $h2->parentNode->insertBefore($a, $h2);
}
$DOM->formatOutput = true;
echo $DOM->saveHTML(); 
```

演示[http://codepad.org/N0dPcLwT](http://codepad.org/N0dPcLwT)

要将 H2 元素包装到 A 元素中，只需执行相同操作并添加

```
$a->appendChild($h2); 
```

演示[http://codepad.org/w7Hi0Bmz](http://codepad.org/w7Hi0Bmz)

# android - 无法在 getView 中选中/取消选中 CheckedTextView

> ID：12641529
> 
> 赞同：16
> 
> 时间：2012-09-28T14:01:43.973
> 
> 标签：android, android-layout, android-spinner, android-checkbox

我正在自定义 ListView 中加载电话联系人。每行都是一个可检查的 LinearLayout，其中包含一个 CheckedTextView 和另一个 TextView。

我正在使用自定义 ArrayAdapter 提供列表视图。我的问题是我无法在 getView() 中控制 CheckedTextViews。例如，当我尝试以下

```
public View getView(int position, View convertView, ViewGroup parent) {
        View row = convertView;
        if(row == null){            
            row = inflater.inflate(layout, parent, false);
        }

        CheckedTextView checkedTextView =  (CheckedTextView) row.findViewById(R.id.checkedTextView);
        checkedTextView.setText("A");
        checkedTextView.setChecked(true);
        return row;
    } 
```

每当我滚动列表视图时，这应该检查每个文本视图，但这并没有发生。谁能告诉我该怎么做？

编辑：在 getView() 中检查它很重要，我不能在 setListAdapter() 之后检查所有内容

EDIT2：这是显示每行视图的 xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<com.example.multiplecontacts.CheckableLinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <CheckedTextView
        android:id="@+id/checkedTextView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:checkMark="?android:attr/listChoiceIndicatorMultiple"
        android:paddingBottom="0dp"
        android:text="CheckedTextView"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <TextView
        android:id="@+id/subTextView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Small Text"
        android:paddingTop="0dp"
        android:textAppearance="?android:attr/textAppearanceSmall" />

</com.example.multiplecontacts.CheckableLinearLayout> 
```

CheckableLinearLayout 是一个自定义布局，它扩展了 LinearLayout 并实现了我之前所说的 Checkable。我把它从[这里拿走了](http://tokudu.com/2010/android-checkable-linear-layout/)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-28T14:12:27.533

您是否在布局 xml 中为 CheckedTextView 设置了 checkMark 属性？

例如：`android:checkMark="?android:attr/listChoiceIndicatorMultiple`

CheckedTextView 不仅仅是一个带有文本的复选框。您还必须注意，CheckedTextView 是不可聚焦的，或者在没有一些操作的情况下可点击（因为它是为 ListView 设计的，因此它的状态必须由 ListView 控制`setOnItemClickListener`）

`setChoiceMode`应该为 ListView 设置。检查适配器的 getView 内的行应该通过以下方式完成：`listView.setItemChecked(position, value)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-27T18:34:41.503

@Pier-Luc Gendreau 和 @fox 在评论中提到了解决方案，但没有在回答中提到，因此代表他们发布答案。

正如@AlexOrlov 所提到的，CheckedTextView 是不可聚焦的，或者在没有一些操作的情况下是不可点击的。因此，您需要做的是使用 ListView 设置项目检查，您可以从适配器本身或从拥有 ListView 的活动/片段中进行。

要从适配器做到这一点，

```
public View getView(int position, View convertView, ViewGroup parent) 
{ 
if (//logic) {
((ListView) parent).setItemChecked(position, true);
}
} 
```

来自活动/片段

```
if (//logic) {
listView.setItemChecked(position, true);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:32:18.540

当你滚动列表时，每次它调用它的 getview() 方法。因此，如果您在 listcell 中有任何复选框或任何编辑框，它将重新初始化它。

我的想法是存储复选框的状态（选中或未选中）。所以在这里我首先使用 ArrayList 我用 false 值填充它，然后在它的点击事件上我用来存储它的实际状态。

```
 class MyAdapter extends BaseAdapter  implements OnClickListener   {

    private ArrayList<Boolean> checks=new ArrayList<Boolean>();//Boolean type array to   manage check box

  private static LayoutInflater inflater=null;

    public MyAdapter(Context context, ArrayList<HashMap<String, String>> d)
    {
              inflater =     (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

      //fill with false values
    for (int i = 0; i < d.size(); i++) 
    {
            checks.add(i, false);
    }
    }

    public int getCount()
    {
        return data.size();
    }

    public Object getItem(int position)
    {
        return position;
    }

    public long getItemId(int position) 
    {
        return position;
    }

        public View getView(int position, View convertView, ViewGroup parent)
       {

        View vi=convertView;

        if(convertView==null)

          vi = inflater.inflate(R.layout.<your layout>, null);

          //Checkbox is of button type----android:button="@drawable/btn_check"
          //make a selector xml for checkbox       

          checkBox=(CheckBox)vi.findViewById(R.id.check_box);

          checkBox.setTag(Integer.valueOf(position));
          checkBox.setOnClickListener(this);
          checkBox.setChecked(checks.get(position));

        return vi;
    }

        @Override
        public void onClick(View v) 
        {
          int viewId=v.getId();
          if(viewId== R.id.check_box)
          {
            Integer index = (Integer)v.getTag();
            boolean state = checks.get(index.intValue());
            checks.set(index.intValue(), !state);

          }
        }
     } 
```

更新：解决方案 2：您可以在 ViewHolder 类中放置一个布尔变量。这个布尔变量将用于定义是否选择了项目。

希望这对您有所帮助。

# android - 谷歌地图无法加载网址

> ID：12641532
> 
> 赞同：1
> 
> 时间：2012-09-28T14:01:53.040
> 
> 标签：android, google-maps

我尝试将 url 发送到地图，但应用程序显示敬酒“无法加载 url”。有一个可行的建议吗？

遵循代码：

```
EditText edit = (EditText) findViewById(R.id.enter);
String map = edit.getText().toString();
Uri location = Uri.parse("geo:" + map);
Intent mapIntent = new Intent(Intent.ACTION_VIEW, location);
startActivity(mapIntent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T13:02:02.600

菲利普作品的解决方案。仅使用 中的地理参考`EditText`，例如 12,48。

# facebook - Facebook 忽略 Graph API 页面帖子连接 - 忽略回复和评论？故事与信息

> ID：12641533
> 
> 赞同：2
> 
> 时间：2012-09-28T14:01:54.060
> 
> 标签：facebook, api, facebook-graph-api

我正在从 Graph API 中提取页面帖子，但我想忽略评论或回复。

例如：

```
{
"id": "115673336230_10151050684306231", 
"from": {
"name": "New York Jets", 
"category": "Professional sports team", 
"id": "115673336230"
 }, 
"story": "\"Well said, Michael. We know our...\" on [User's name removed]'s post on New York Jets's wall.", 
"story_tags": {
"40": [
  {
    "id": ----------, 
    "name": ------------, 
    "offset": 40, 
    "length": 15, 
    "type": "user"
  }
]
}, 
"type": "status", 
"created_time": "2012-09-27T13:39:55+0000", 
"updated_time": "2012-09-27T13:39:55+0000", 
"comments": {
"count": 0
}
}` 
```

除了故事字段中的“用户名帖子”位之外，似乎没有任何回复可以用来过滤出这样的回复。

我注意到所有对评论的回复都没有`message`数据和`story`数据，但从文档中不清楚这是否是一个可靠的数据点来过滤。

有没有办法忽略页面帖子连接中的评论/回复？是否所有页面帖子（非评论回复）在字段中都有数据，`message`而从不在`story`字段中？也就是说，我可以可靠地忽略没有的“帖子”`message`吗？那有一个`story`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:48:34.170

如果您想要更强大的过滤，您应该查看[使用 FQL 查询流表](https://developers.facebook.com/docs/reference/fql/stream/)。

该`type`字段允许您根据帖子的内容过滤掉帖子。添加`AND type != 247`将从返回的数据中排除注释。

可能有一种方法可以通过请求`status_type`字段来使用 API 执行此操作，但是您还必须手动请求要显示的所有其他字段，并且您最终仍将在脚本中过滤它们。

# actionscript-3 - Nonsensical TypeError: Error #1010: A term is undefined and has no properties

> ID：12641534
> 
> 赞同：0
> 
> 时间：2012-09-28T14:02:01.943
> 
> 标签：actionscript-3

我有这个简单的代码：

```
...
for (var w:Number=0; w < MAX_w; w++){

   for (var k:Number=0; k < MAX_k; k++){

      trace("test01");

      if(w != k){
         trace("test02");
         ///do sth...
      }
   }
}
... 
```

输出是：

```
...
test01 
TypeError: Error #1010: A term is undefined and has no properties.
at NS_fla::MainTimeline/vzdalenosti_bodu()
at NS_fla::MainTimeline/hlaska_zmacknul_sem()
... 
```

请怀疑任何人是什么导致了这个问题？

谢谢回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:12:12.680

如果它只跟踪“test01”一次，那么问题就不会来自 if(w!=k) 范围内的任何内容，因为第一次 w=k=0。如果您的 MAX_w 和 MAX_k 为 0，那么问题将来自循环之后。无论如何，问题不在于 w 或 k，我认为需要更多代码来解决这个问题。顺便说一句：为什么是 Number 而不是 int？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:22:50.667

根据运行时错误参考：

如果您尝试访问不存在的对象的属性，则可能会发生此错误。例如：

```
var obj:Object = new Object();
obj.a = "foo";
trace(obj.b.prop); 
```

由于拼写错误，您还可以看到此错误，例如在以下示例中，其中 mc 表示显示列表上的 MovieClip 对象，并且 stage 属性拼写错误为大写 S（它应该是 stage）：

```
trace(mc.Stage.quality); 
```

所有错误都在这里 - [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/runtimeErrors.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/runtimeErrors.html)

# c# - LinqToExcel：如何排除某些行？

> ID：12641535
> 
> 赞同：0
> 
> 时间：2012-09-28T14:02:09.253
> 
> 标签：c#, linq, c#-4.0, linq-to-excel

我已经为此苦苦挣扎了几天，我很困惑。我希望有人可以提供替代建议。基本上，我正在使用 LinqToExcel 从 excel 中读取数据。但我想排除所有“评级”为“NR”的行。这是我的数据示例：

```
CompanyName Rating  SalesMan
Apple       2       Steve
Google      NR      Steve
Microsoft   3       John
Dell        1       Steve
Pepsi       3       John 
```

我只想找到属于史蒂夫但没有评级为“NR”的所有公司。我的最终清单应该是：

```
CompanyName SalesMan
Apple       Steve
Dell        Steve 
```

我已经尝试了以下代码，但它不起作用：

1)

```
var masterList = masterDataXL.Worksheet("data_all").Where(d => !d["Rating"].Equals("NR")); 
```

2)

```
var masterList = masterDataXL.Worksheet("data_all")
    .Where(m =>
        !m["Rating"].Equals("NR")
        &&
        m["SalesMan"].ToString().Contains(resAnLastName)) // check for last name
    .Select(m => new ResAnTicksDataClass
    {
        Company = m["CompanyName"],
        Rating = m["Rating"],
        Seller = m["SalesMan"]
    }).AsEnumerable(); 
```

3) 为 Rating 创建了一个属性并执行了以下操作：

```
var masterList = masterDataXL.Worksheet("data_all")
.Where(m =>
    m["Analyst"].ToString().Contains(resAnLastName)) // check for last name
.Select(m => new ResAnTicksDataClass
{
    Company = m["CompanyName"],
    Rating = m["Rating"],
    Seller = m["SalesMan"]
}).AsEnumerable();
var dataList = (from m in masterList
where m.Rating != "NR"
select new ResAnTicksDataClass
{
    ResAnName = m.ResAnName,
    DescrTick = m.DescrTick
}).AsEnumerable(); 
```

我对您可能提出的任何其他建议持开放态度，因为我完全被难住了。非常感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T17:24:52.983

我建议您在 Excel 文件中选择“评级”列，然后对所选内容进行搜索和替换（将“NR”更改为“0”），然后进行过滤。应该有助于使用单一数据类型。

正如 phoog 所说，将 Excel 文件转换为表格，该表格需要指定每一列的类型。为此，它只会查看 Excel 文件的前 10 行。因此，如果您的文件在前 10 行中没有“NR”值，它会将列类型设置为`INT`，因此无法转换值“NR”。解决此问题的一个简单技巧是在 Excel 文件中添加一行，就在您的第一个数据行之前，数据使用您要使用的数据类型。

例如，如果一列使用文本值并且有时文本使用超过 255 个字符，请确保前 10 行至少有 1 个使用 256 个字符的文本值。否则，一旦创建表，该列将设置为`VARCHAR(255)`，`VARCHAR(MAX)`然后在转换超过 255 个字符的文本时崩溃。

结论：始终确保前 10 行使用正确的类型和大小以适合 Excel 文件的所有行！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:49:14.953

在您的第一个示例中，您应该更改此：

```
d => !d["Rating"].Equals("NR") 
```

对此：

```
d => d["Rating"] != "NR" 
```

它也可以写成更简洁的方式：

```
var masterList = 
    from d in masterDataXL.Worksheet("data_all")
    where d["Rating"] != "NR"
    select d; 
```

# python - 如何将项目添加到字典

> ID：12641539
> 
> 赞同：0
> 
> 时间：2012-09-28T14:02:40.573
> 
> 标签：python

人们。我是蟒蛇新手。我在一个类下有两个 def 函数。

```
def add_item(self, itemID, itemlist):
    lines = []

    self.itemID = itemID
    self.itemlist = itemlist

    for line in self.itemID, itemlist:
        lines.append(line) 
```

和

```
def get_keys(self):
    i = []
    i.append(self.itemID)
    return i 
```

如果我做

```
example.add_item('abc', item list)
example.add_item('abcd', item list)
example.add_item('abce', item list) 
```

那么当我这样做的时候

```
example.get_keys() 
```

它应该给出：

```
['abc', 'abcd', 'abce'] 
```

但我的只给出了最新的一个`['abce']`。

谁能让我知道如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:12:47.097

如果我理解正确，您想在示例中添加几个`key`and`item_list`并能够检索您到目前为止添加的键？最简单的是将`keys`和存储`itemlist`在两个列表中

假设您这样初始化对象

```
def __init__(self, *args, **kwargs):
   self.itemID = []
   self.itemlist = []
   ... 
```

现在，您`add_item`可以简化

```
def add_item(self, itemID, itemlist):
    self.itemID.append(itemID)
    self.itemlist.append(itemlist) 
```

而你`get_key`的只是：

```
def get_keys():
    return self.itemID 
```

* * *

*   请注意，这`get_key`正是您建议的，只是更简单（无需创建临时列表）。

*   当你这样做

    ```
    lines = []
    for line in self.itemID, itemlist:
        lines.append(line) 
    ```

    `line`先取值`self.itemID`，然后取值`itemlist`。最终，你`lines`的只是`[self.itemID, itemlist]`. 可能不是你想的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:09:51.603

我看到的第一件事是：您一次迭代两个元素，这通常是通过 using 完成的`zip()`，至少如果两个元素都是列表的话。否则，只需使用要循环的容器。

```
for id,line in zip(self.itemID, itemlist):
    lines.append(line) 
```

但我没有看到任何`dict`...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:11:13.367

您还可以使用内置方法`update`：

```
example.update({'Key':'value'}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:07:08.893

```
def add_item(self, itemID, itemlist):
    lines = [] 
```

您正在使用...初始化`lines`变量`empty list`

因此，每次您调用此方法时，它都会创建一个新列表并将项目添加到其中。您可以`lines`从该方法返回您的并将其存储在您正在调用此方法的某个变量中。

或者，只需声明`lines`为`instance variable`.

```
example = Example();
example.lines = []
example.lines.extend(example.add_item(itemId1, item_list1));
example.lines.extend(example.add_item(itemId2, item_list2)); 
```

或者，您可以将您的`itemId`and添加到您班级`list`的字典中。`__dict__`

```
dict[itemId] = value; 
```

** 注意： - 刚刚看到，你没有`for-loop`正确使用你的..你不会`two`像这样迭代迭代..

您需要阅读一本好的 Python 书籍。或者更确切地说，Python 文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T14:07:22.653

也许

```
i.extend(self.itemID) 
```

可能是您正在寻找的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T14:07:40.870

每次添加时，您似乎都在覆盖该项目。

当您调用 add_item 时，您正在创建此变量“lines”，该变量不再使用，并且 item_id 和 item_list 被新输入覆盖。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-28T14:05:22.477

要将新键添加到字典中，只需分配它。

```
dict['new_key'] = 'value' 
```

# iphone - ios6中的解雇modalViewcontroller错误

> ID：12641542
> 
> 赞同：0
> 
> 时间：2012-09-28T14:03:04.433
> 
> 标签：iphone, objective-c, ios, ios6, modalviewcontroller

我在 ios6 中面临关于解雇 modalViewController 的问题

这是我分享的代码片段：

```
 UIViewController *controller=appdelegate.navigationController.topViewController;

   if(kDeviceVersion>=5.0){

     if(controller.parentViewController){

        if(controller.parentViewController.parentViewController){

            [controller.parentViewController.parentViewController dismissViewControllerAnimated:NO completion:nil];

        }

        [controller.parentViewController dismissViewControllerAnimated:NO completion:nil];

    }

}
else{

    if(controller.parentViewController){

        if(controller.parentViewController.parentViewController){

            [controller.parentViewController.parentViewController dismissModalViewControllerAnimated:NO];

        }

        [controller.parentViewController dismissModalViewControllerAnimated:NO];

    }

} 
```

此代码在 ios4.0 到 ios 5.1.1 上运行良好。但未能在 ios6 上工作。我想解雇的那些模态视图控制器不会被解雇。相反，它显示了这个错误。

**尝试关闭其视图当前未出现的模态视图控制器。自我 = UINavigationController：0xa947440 modalViewController = UINavigationController：0x8c36170**

但是当我尝试使用 presentModalViewController 呈现该视图控制器时，它会显示

**警告：尝试在 UINavigationController：0xa947440 上呈现，它已经在呈现 UINavigationController：0x8c36170**

请建议我该怎么做以及如何为 ios6 解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T06:53:05.787

从您的问题中不清楚哪个 VC 提供了您想要解雇的 VC。但是，我建议始终遵循此规则：

从也提出它的 VC 中解散。因此，例如，如果 VC0 呈现 VC1，那么也会从 VC0 中消除 VC1。这实际上也是 Apple 推荐的方式，您可以从此处[打开和关闭其他 UIViewControllers 的一个非常相关的问题的答案中看到 - 除了使用协议和委托之外还有其他方法吗？](https://stackoverflow.com/questions/11596200/opening-and-closing-other-uiviewcontrollers-any-other-approaches-than-to-use-p)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:26:28.907

我没有使用模态视图控制器，而是使用了导航控制器并使用 CAAnimation 使用推送视图而不是当前模态视图控制器

那不是这个-----

```
 ShareViewController *share=[[ShareViewController alloc] initWithNibName:@"ShareViewController" bundle:nil];
    UINavigationController *nav=[[UINavigationController alloc]initWithRootViewController:share];
    share.modalPresentationStyle=UIModalPresentationFormSheet;
    share.modalTransitionStyle=UIModalTransitionStyleCrossDissolve;
    [self presentModalViewController:nav animated:YES];

    [share release];
    [nav release]; 
```

我们可以用这个

```
 ShareViewController *share=[[ShareViewController alloc] initWithNibName:@"ShareViewController" bundle:nil];

    CATransition* transition = [CATransition animation];
    transition.duration = 0.4;
    transition.type = kCATransitionFade;
    transition.subtype = kCATransitionFromTop;

    [self.navigationController.view.layer addAnimation:transition forKey:kCATransition];
    [self.navigationController pushViewController:share animated:NO];

    [share release]; 
```

# facebook - Facebook Faces 不显示

> ID：12641557
> 
> 赞同：-1
> 
> 时间：2012-09-28T14:03:47.437
> 
> 标签：facebook, web

我在我的 TypePad 驱动的博客上安装了 Facebook Like Box 插件。它不会显示喜欢我的 Facebook 页面的人的面孔。最初它只显示两个成员（维度允许显示六个面）。我卸载了它。两个月后，我重新安装了插件，它只显示了一个成员的脸（称他为“K”）。当该成员更新他的页面时，它将显示在 Like Box 上。但是，当新人加入我的粉丝页面时，数量会增加，但他们的脸不会显示在点赞框中。唯一会显示的脸是“K”。我决定从我的成员列表中删除“K”，看看会发生什么。结果是 Like Box 显示了零个面孔。我卸载了插件并重新安装了它，结果相同。目前我'

Facebook 不允许我完全粘贴 IFrame 代码，但大部分内容如下：

> iframe src="//www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FLiving-Fit-Healthy-and-Happy%2F342390352362&width=292&height=290&colorscheme= light&show_faces=true&border_color&stream=false&header=true" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:292px; height:290px;" allowTransparency="true">

顶部 < 然后在底部 /iframe （<--- 我必须输入它才能让 Facebook 允许将此代码粘贴到此问题框中）

无论使用哪种浏览器——无论是 Firefox 还是 Internet Explorer——Like Box 都不会显示面孔。

我知道这是 Like Box 应用程序中的一个小故障，但 Facebook 没有提供技术支持来解决这个问题。这个 Like Box 安装在商业网站上。这个应用程序的功能将帮助我决定是否在 Facebook 上使用付费广告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:47:43.960

The faces aren't showing when you plug your URL in on the [Like Box Plugin page](https://developers.facebook.com/docs/reference/plugins/like-box/) either, so you've got two possibilities: It's a Facebook bug, or it's you.

Let's assume it's you for the moment. First, visit the admin panel of your page and claim a username. You've passed the likes threshold. That alone might fix your problem.

While you're in there, check that you don't have any excessive restrictions on your page.

The only other suggestion is to look at the people who've liked your page. Have any of them set the visibility to "Only Me"? If so, their photos won't show up here.

If you're confident that you've done all that correctly and it still isn't working, [file a bug report](https://developers.facebook.com/bugs)

# jquery - Twitter Bootstrap - 将“背景”添加到下拉 jQuery

> ID：12641561
> 
> 赞同：0
> 
> 时间：2012-09-28T14:04:01.570
> 
> 标签：jquery, css, twitter-bootstrap

我不擅长 jQuery，所以我来这里寻求帮助。我想知道如何将模态背景添加到 Twitter Bootstrap 中的下拉菜单中？

jQuery(s)

模态 - [http://twitter.github.com/bootstrap/assets/js/bootstrap-modal.js](http://twitter.github.com/bootstrap/assets/js/bootstrap-modal.js)

下拉 - [http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js](http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js)

谢谢。

# r - 如何在 R 中定义一个数据框，其中包含对另一个数据框的两列进行数学运算的结果？

> ID：12641563
> 
> 赞同：1
> 
> 时间：2012-09-28T14:04:10.230
> 
> 标签：r, math, dataframe, operation

我有一个包含以下列名称和 19 行的数据框

```
> [1] "X12C.Signal_Grn"    "X12C.Signal_Red"    "X11P.Signal_Grn"   
> [4] "X11P.Signal_Red"    "X7P_.A..Signal_Grn" "X7P_.A..Signal_Red"
> [7] "X8P.Signal_Grn"     "X8P.Signal_Red"     "X9P.Signal_Grn"    
>[10] "X9P.Signal_Red"     "X10PA.Signal_Grn"   "X10PA.Signal_Red"  
>[13] "X6PB.Signal_Grn"    "X6PB.Signal_Red"    "X12P.Signal_Grn"   
>[16] "X12P.Signal_Red"    "X5P.Signal_Grn"     "X5P.Signal_Red"    
>[19] "X9P2C15.Signal_Grn" "X9P2C15.Signal_Red" "X42Pa.Signal_Grn"  
>[22] "X42Pa.Signal_Red" 
```

该类是data.frame。问题是如何为原始参考中的所有行创建一个新的数据框，其中包含第 1 列和第 2 列的 log 2 比率，然后是 3 和 4，然后是 5 和 6，依此类推？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:18:32.810

这个解决方案不是那么漂亮，但它可以满足您的需求。

```
# Generate some random data with column names on the same format as you have
df <- data.frame(matrix(runif(19*22), 19, 22))
names(df) <- sprintf("%s.Signal_%s", rep(LETTERS[1:11], each=2),
                                     rep(c("Grn", "Red"), 11))
# Calculate log2 ratios
l2r <- as.data.frame(lapply(1:(ncol(df)/2), function(i) log2(df[2*i]/df[2*i-1])))
# Give the columns comprehensive names
names(l2r) <- sub("Signal_Red", "log2ratio", names(df)[seq(2, ncol(df), 2)]) 
```

# iphone - nslog 打印某些数字

> ID：12641566
> 
> 赞同：0
> 
> 时间：2012-09-28T14:04:19.717
> 
> 标签：iphone, xcode

当我按下按钮时，我试图只打印可被 10 整除的数字，请问有什么建议吗？而且我可以更改 for 循环，所以不要问这个问题。

```
-(IBAction)begin:(id)sender{
for (int k=0;k<=20;k++){

   NSLog( @"%d",k);

   }
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:06:17.460

```
if(k % 10 == 0) { NSLog( @"%d", k); } 
```

那是模运算符。您本质上是在问“如果 k 除以 10 余数为零，则打印它”... :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:07:48.093

```
-(IBAction)begin:(id)sender{
for (int k=0;k<=20;k++){

if(k %10 == 0){
   NSLog( @"%d",k);

   }
     } 
```

# sql-server-2008 - SSRS 2008 - 对象引用未设置为对象的实例

> ID：12641570
> 
> 赞同：1
> 
> 时间：2012-09-28T14:04:38.047
> 
> 标签：sql-server-2008, ssrs-2008, ssas, reporting-services, ssas-2008

我的一个共享数据集仅在某些参数上出现问题。如果该参数没有为该数据集返回任何内容，那么我似乎遇到了这个问题，此报告中有一个使用共享数据集的 tablix，如果我删除 tablix 但保留共享数据集，我仍然会在报告预览中收到错误。

数据集使用 MDX 查询 (SSAS) 来获取其数据，如果我从查询设计器运行查询，它将返回 2 行，但行中的日期超出了我的报告范围，因此报告将返回 0，我假设那是我的问题。

有人有任何想法/提示吗？

使用 SQL Server 2008 R2

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:18:43.087

通过拥有嵌入式数据集而不是共享数据集，设法解决了这个问题。

绕过这个问题，虽然很烦人！

# oim - 如何在 Oracle 身份管理器中删除或修改用户定义的字段？

> ID：12641573
> 
> 赞同：1
> 
> 时间：2012-09-28T14:04:59.090
> 
> 标签：oim

由于我犯了一个错误，我必须在 Oracle 身份管理器中删除或修改用户定义的字段。可以通过制作新的沙箱来实现吗？

任何帮助将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-21T17:46:07.110

虽然这个帖子之前发布过。我遇到过同样的问题。

我们可以在发布之前删除或修改用户定义字段 (UDF)。我们可以导出沙箱并更改或删除字段（在提取沙箱后的文件中）。

如果您已经发布了沙箱，您可以恢复沙箱，但为此您需要拥有所有已发布的导出沙箱。然后您可以在沙盒文件中手动进行更改并重新发布这些文件。

这个想法对我有用。

# javascript - 检查未保存会话数据的规范 Java EE 方法？

> ID：12641580
> 
> 赞同：-1
> 
> 时间：2012-09-28T14:05:11.587
> 
> 标签：javascript, session, jakarta-ee

我的应用程序有一个用例，其中有一个页面，用户可以在其中编辑数据并按保存或中断编辑并进行搜索或单击链接。这个框架有点奇怪，它使用 javascript 为每个被点击的链接提交一个表单，所以我们最终得到了一个混杂的 javascript 和 java hacks 促进对话框和检查未保存的数据变得混乱，我不得不询问它：

[如何从javascript onkeydown中排除组件](https://stackoverflow.com/questions/12635188/how-to-exclude-components-from-javascript-onkeydown)

[https://stackoverflow.com/questions/12525020/why-does-this-code-create-a-loop](https://stackoverflow.com/questions/12525020/why-does-this-code-create-a-loop)

我要么得到永远不会结束的对话，按“是”到“你有未保存的数据。你想继续吗？” 循环到另一个相同的对话框，当我尝试修复它时没有任何效果。

现在程序在屏幕上运行，但解决方案很混乱，如果有另一个错误或者我们注意到我的解决方案影响了其他组件，就会有麻烦。

所以我问你是否知道一种简单的 Java 方法来检查未保存的会话数据？发生的情况是向用户显示一个表单，当数据被编辑时单击链接应该会显示一个对话框，警告数据未保存。我认为不使用 javascript 是一个更好的解决方案，你能在这里评论和/或帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:09:49.933

不。

用户在浏览器中输入数据；除非您提交，否则服务器无法知道这一点。

# c# - 出现错误时从实体框架中删除一批记录

> ID：12641591
> 
> 赞同：0
> 
> 时间：2012-09-28T14:05:43.373
> 
> 标签：c#, entity-framework, error-handling, batch-processing

我正在将来自内部系统的一堆记录批量添加到我们的 Web 数据库服务器（电子账单类型数据）。我有一个问题，如果存在数据错误（单独的问题），则每次添加之后都会出错。

```
 foreach (InvoiceHeader invoiceHeader in invoiceHeaders)
        {
            rrn++;
            db.AddToInvoiceHeaders(invoiceHeader);
            if (rrn >= RECORDS_AT_A_TIME)
            {
                try
                {
                    db.SaveChanges();
                    rrn = 0;
                }
                catch (Exception e)
                {
                    string errorText = "Error in blah blah blah \n\n";
                    errorText += "Error: " + e.ToString();
                    Log.Error(errorText);
                    // Delete out bad record or entire set of records here.
                }
            }
        } 
```

所以前 500 个可能会很好，然后我可能会得到一个无效的日期。没有其他任何东西被添加到服务器中，并且日志会因错误和崩溃而受到猛烈抨击。

**如何清除错误的一条记录或仅清除那批记录？所以它可以正确完成，我们可以返回并修复错误，从而添加丢失的数据。**

更新：我希望能够只记录错误，删除问题记录并继续。在这种情况下，它恰好是一个日期问题，我不是在寻找解决这个**实例**，而是在寻找所有未来未知的问题。我该怎么做`// Delete out bad record or entire set of records here.`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:31:51.490

使用您当前的实现，您已经在逐一处理每个项目，因此，如果其中一个项目发生您*可以*处理的错误，那么只需这样做并继续处理。此外，不要抓住一般性`Exception`，更具体地说明您的代码*应该*期待哪些异常，例如

```
try
{
    ...
}
catch (SqlTypeException)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:13:04.240

这可能是一个不太理想的解决方案，但似乎对我需要继续进行的工作有效。

```
 foreach (InvoiceHeader invoiceHeader in invoiceHeaders)
        {
            rrn++;
            if (rrn >= RECORDS_AT_A_TIME)
            {
                try
                {
                    db.SaveChanges();
                    rrn = 0;
                }
                catch (Exception e)
                {
                    string errorText = "Error in blah blah\n\n";
                    errorText += "Error: " + e.ToString();
                    Log.Error(errorText);
            // Throw out all of these records so we can move on.
            // Probably not the best solution, but it works.
                    db.Dispose();
                    db = new db_Entities();
                }
            }
        } 
```

# php - CakePHP 2.2 应用程序在网络服务器上的奇怪行为

> ID：12641596
> 
> 赞同：1
> 
> 时间：2012-09-28T14:05:58.423
> 
> 标签：php, cakephp, cakephp-2.0

我开发了一个简单的 Cake 应用程序，在完成编码后，我将它上传到[我的 Web 服务器](http://server.3p3r.com)，现在它有几个问题（它在 localhost 上就像一个魅力）：

*   `setFlash`消息不起作用（我在数据库中使用会话，并且有一些会话的记录`cake_sessions`）
*   成功登录后，它会再次将我重定向到登录页面。
*   有时缓存文件会消失！（我的`tmp`文件夹是可写的）

实际上，在登录之前不允许任何操作，但您应该`You are not authorized to access that location.`在登录页面顶部看到一条闪烁消息，但它不会出现，但是如果您使用错误的用户名/密码登录，它会显示一条消息（`wth?`）

UsersController 的登录和注销方法：

```
public function login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            $this->redirect($this->Auth->redirect());
        } else {
            $this->Session->setFlash(__('Invalid username or password, try again'));
        }
    }
}

public function logout() {
    $this->redirect($this->Auth->logout());
} 
```

最近执行的 100 个查询（来自日志）：

```
SELECT `Session`.`id`, `Session`.`data`, `Session`.`expires` FROM `srv`.`cake_sessions` AS `Session` WHERE `id` = '7orjo8clp192qeie55k6pqro26' LIMIT 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:38:36.887

听起来您的网络服务器上的会话已损坏。检查您的系统时钟 - 如果相差超过几分钟，您的会话将很快过期，如果不是立即过期

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:28:34.277

确保在用户模型中为登录设置了组件。它应该是这样的

```
 public $components = array(
    'Session',
    'Auth' => array(
        'loginRedirect' => array('controller' => 'desired_controller', 'action' => 'desired_action'),
        'logoutRedirect' => array('controller' => 'desired_controller', 'action' => 'display', 'home')
    )
); 
```

还要检查以确保您正确设置了 beforeFilter

```
//UsersController

  public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('add', 'logout', 'other_actions');
} 
```

**编辑**

这似乎与您所描述的非常相似[cakephp 登录页面无处可去](https://stackoverflow.com/questions/9266833/cakephp-login-page-doesnt-go-anywhere)

考虑到奇怪的行为，这也可能值得一试

[https://github.com/cakephp/cakephp/commit/c96e364cbb6ec8dd72dd220836a07ed104d2d50a](https://github.com/cakephp/cakephp/commit/c96e364cbb6ec8dd72dd220836a07ed104d2d50a)。它修复了会话的错误到期

# gradle - 如何从上游项目的fileTree中排除jar？

> ID：12641603
> 
> 赞同：3
> 
> 时间：2012-09-28T14:06:19.030
> 
> 标签：gradle

我们在一个项目中有以下配置...

```
configurations {
    //compile.exclude module: 'commons'
    //all*.exclude group: 'org.gradle.test.excludes', module: 'reports'
    all*.exclude module: 'log4j'
}

dependencies {
    compile group: 'org.slf4j',          name: 'slf4j-api',               version: '1.6.6'
    compile group: 'org.slf4j',          name: 'log4j-over-slf4j',        version: '1.6.6'
    compile group: 'com.google.inject',  name: 'guice',                   version: '3.0'
    compile group: 'com.google.protobuf',name: 'protobuf-java',           version: '2.4.1'
    //compile group: 'org.asteriskjava',name: 'asterisk-java',         version: '1.0.0.M3'   

    //to be erased soon
    compile group: 'commons-configuration',name:'commons-configuration',version: '1.8'
    //compile group: 'org.bouncycastle',   name: 'bcpg-jdk16',              version: '1.46'

    compile project(':sdi-master')
    compile project(':sdi-webserver')
} 
```

不幸的是，项目 sdi-webserver 有它自己的 log4j 从文件树中引入，就像这样

```
project(':sdi-webserver') {
    project.ext.genLibDir = file('lib')

    dependencies {    
        compile project(':sdi-master')
        compile fileTree(dir: '../webserver/lib', include: '*.jar')
        compile fileTree(dir: '../webserver/play-1.2.4/framework/lib', include: '*.jar')
        compile fileTree(dir: '../webserver/play-1.2.4/framework', include: 'play-*.jar')   
    } 
```

我们如何排除这个 jar，使其不属于依赖项。以上排除了我们仅适用于存储库和传递依赖项并且不适用于fileTree，但我们仍然需要以某种方式排除jar文件，因为我们希望eclipse任务构建正确的.classpath，我们希望configurations.compile具有准确的信息复制罐子等

谢谢，院长

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T23:47:35.143

只需使用`exclude`on `fileTree`。语法与 for 相同`include`。

# python - Pandas：按列对文本中的数字进行排序

> ID：12641606
> 
> 赞同：0
> 
> 时间：2012-09-28T14:06:39.843
> 
> 标签：python, sorting, dataframe, pandas

我正在尝试使用 df.sort_index 按列对数据框进行排序。第二个这样的字符串列是由文本中的数字组成的。手术后我有：

```
15 rs1820451 32681212 0.441 0.493 0.5358 98.9 29 0 0.441 T:A 
14 rs1820450 32680556 0.441 0.493 0.5358 98.9 29 0 0.441 G:C 
38 rs1820447 32693541 0.421 0.332 0.0915 94.4 26 0 0.211 G:A 
37 rs1820446 32693440 0.483 0.499 0.9633 100.0 30 0 0.475 G:T 
7 rs1808502 32660555 0.517 0.46 0.543 100.0 30 0 0.358 C:G 
24 rs17817908 32687035 0.407 0.362 0.6159 98.9 29 0 0.237 C:T 
22 rs17817896 32686160 0.407 0.362 0.6159 98.9 29 0 0.237 T:A 
66 rs17236946 32717247 0.492 0.453 0.7762 98.9 29 0 0.347 T:C 
```

这不是我想要的。最后三行应该在开头。是否有任何其他数据框方法或克服此问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:18:27.567

如果要对一列或多列进行排序，则需要使用 df.sort()，df.sort_index() 仅对索引进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:16:00.290

这根本没有错误检查或优化，但这是你想要的：

```
def sort_on(lines, col_idx):
  return sorted(lines, key=lambda l: float(l.split()[col_idx]))

lines = """\
15 rs1820451 32681212 0.441 0.493 0.5358 98.9 29 0 0.441 T:A 
14 rs1820450 32680556 0.441 0.493 0.5358 98.9 29 0 0.441 G:C 
38 rs1820447 32693541 0.421 0.332 0.0915 94.4 26 0 0.211 G:A 
37 rs1820446 32693440 0.483 0.499 0.9633 100.0 30 0 0.475 G:T 
7 rs1808502 32660555 0.517 0.46 0.543 100.0 30 0 0.358 C:G 
24 rs17817908 32687035 0.407 0.362 0.6159 98.9 29 0 0.237 C:T 
22 rs17817896 32686160 0.407 0.362 0.6159 98.9 29 0 0.237 T:A 
66 rs17236946 32717247 0.492 0.453 0.7762 98.9 29 0 0.347 T:C
""".splitlines()

sorted_lines = sort_on(lines, 3)
print "\n".join(sorted_lines) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:41:05.493

对于期货参考，这里有一个可能的解决方案。

```
 cond = ((df['L1'] != rscode) & (df['L2'] != rscode))
    outname = inf + '_test'
    df['L3'] = df['L1'].map(lambda x: int(str(x)[2:]))        
    outdata = df.drop(df[cond].index.values).sort(columns='L3', ascending=False, axis=0)
    # export outdata using Datadrame.to_csv with the original df cols 
```

欢迎改进。最好的，

# c# - 元组与泛型类性能

> ID：12641609
> 
> 赞同：1
> 
> 时间：2012-09-28T14:06:50.970
> 
> 标签：c#

更高效的 a`Tuple<int, int>`或 a`generic class`如下：

```
 public class Interval<T>
    {
       public T From, To;

       public static Interval<T> Create(T from, T to)
       {
          Interval<T> range = new Interval<T>();

                range.From = from;
                range.To = to;

                return range;
            }
        }
   } 
```

使用场景 - 这些对象的大型集合 (100K++) 使用`LINQ`. 我目前有通用课程，正在考虑转向更无脂肪并且希望更快的东西。想知道我是否会通过切换到使用来获得速度`Tuple`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:10:18.080

如果您查看 a`Tuple<int, int>`和 an的编译代码`Interval<int>`，将很难区分它们。

它们在内存中的存储方式是相同的。

* * *

您还可以考虑使用 a`struct`而不是 a `class`：

```
public struct Interval<T> {

   public T From { get; private set; }
   public T To { get; private set; }

   public Interval(T from, T to) {
     From = from;
     To = to;
   }

} 
```

结构具有值语义，因此在某些情况下用法会有所不同。实现一个运行良好的结构并不那么简单（例如实现相关的比较和转换），但它会为您节省大量内存。一个类的开销大约为 12 或 24 个字节（取决于平台），而结构体没有这种开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:15:57.703

更重要的是，如果要处理如此大的数据集合，请尝试将对象声明为结构。一个结构数组在内存中，一个类数组是该数组的一个对象，然后对于每个成员，您都有另一个具有标准“类开销”的对象

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:22:25.237

你有 Jon Skeet 的答案，所以没有什么要补充的了。但是您显然是在假设 Tuple 正在实现某种您的泛型类不会实现的魔法。我只是在看`Tuple<T1,T2>`现在的源代码，它和你已经拥有的实际上是一样的，除了它封装了属性中的字段并实现了 ToString() 和 IStructuralComparable。

我会看大图并开始寻找其他优化方法，例如优化 LINQ 查询、查找 IEnumerable 的多个枚举或使用某种缓存或延迟加载。您无法真正优化似乎只是包含两个整数的结构。

# c# - 在项目列表下方的水晶报表中打印总金额

> ID：12641611
> 
> 赞同：0
> 
> 时间：2012-09-28T14:06:51.947
> 
> 标签：c#, crystal-reports

我正在尝试在水晶报表中打印发票。我将总金额放在页脚中，将项目放在详细信息部分，但是当它打印 10 项时，总金额会在页面末尾打印。

如何打印项目列表下方的总数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T06:38:06.440

您应该使用报表页脚而不是页脚的总金额。

# java - 从 RESTful Web 服务访问 JSF2 托管 Bean

> ID：12641614
> 
> 赞同：2
> 
> 时间：2012-09-28T14:07:16.063
> 
> 标签：java, rest, tomcat, jsf-2, managed-bean

我有一个应用程序范围的托管 bean，其中包含从数据库读取的列表。每当另一个应用程序对数据库进行更改时，它应该触发 Web 服务来更新托管 bean 中的列表。

我试过了

```
FacesContext context = FacesContext.getCurrentInstance();
ApplicationBean application= (ApplicationBean) context.getApplication().evaluateExpressionGet(context, "#{applicationBean}", ApplicationBean.class); 
```

上下文变量为空，可能是因为未在 JSF 上下文中调用 Web 服务。

REST 资源类如下所示：

```
@Path("/application")
public class ApplicationResource {

@PUT
@Path("{id}")
@Consumes(MediaType.TEXT_PLAIN)
@Produces(MediaType.TEXT_PLAIN)
public void updateIdCache(@PathParam("id") String internalid) {
    ApplicationBean application = ???;
    application.update(id);
    return;
}

} 
```

使用的应用服务器是tomcat 6，如何正确完成？

谢谢和最好的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T17:14:58.640

不要认为 JSF 托管 bean 可以实现您想要的。

虽然 CDI bean 具有此功能。

带有 CDI 的 JAX-WS：

[http://weblogs.java.net/blog/jitu/archive/2010/02/19/jax-ws-cdi-java-ee-6-0](http://weblogs.java.net/blog/jitu/archive/2010/02/19/jax-ws-cdi-java-ee-6-0)

CDI实现焊接常用：焊接入门（涵盖tomcat 6） [http://docs.jboss.org/weld/reference/1.0.0/en-US/html/gettingstarted.html](http://docs.jboss.org/weld/reference/1.0.0/en-US/html/gettingstarted.html)

顺便说一句，我喜欢使用 CDI，我只使用 tomcat 6/7

# android - Android：“测试”应用程序的快速方法

> ID：12641615
> 
> 赞同：7
> 
> 时间：2012-09-28T14:07:18.060
> 
> 标签：android, eclipse, testing

我开始（或至少尝试）开发 android 应用程序，我正在使用 eclipse 沿着 android sdk 进行开发。

现在我想知道是否有一种更快的方法来“测试”和试用代码中新编写的东西，而不是在模拟器中启动它？

我想知道，因为我在 8gb ram 和 q9550（四核）上运行，上传和启动 apk 需要一些时间（比如说 20 秒），现在

我想知道这是否真的是唯一的测试方法，因为它需要大量时间，尤其是当我尝试一些不起作用的新东西时，因此我总是要像这样运行它，比如说 20 次直到我弄清楚我的代码有什么问题...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T14:10:37.940

您可以使用 USB 调试模式连接您的 android 手机并调试您的代码。如果你不能这样做，你可以导出一个 apk 文件（这很快）并使用 dropbox/gmail 将它发送到你的手机。我不是模拟器的忠实粉丝:)

这是启用USB调试的方法

[http://www.groovypost.com/howto/mobile/how-to-enable-usb-debugging-android-phone/](http://www.groovypost.com/howto/mobile/how-to-enable-usb-debugging-android-phone/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T14:11:46.170

我建议在您的设备而不是模拟器上运行。

*   [http://developer.android.com/tools/device.html](http://developer.android.com/tools/device.html)

简而言之：

*   在您的设备上打开“USB 调试”。
    *   在设备上，转到设置 > 应用程序 > 开发并启用 USB 调试（在 Android 4.0 设备上，该设置位于设置 > 开发人员选项中）。
*   设置您的系统以检测您的设备。
    *   如果您在 Windows 上开发，则需要为 adb 安装 USB 驱动程序。有关 OEM 驱动程序的安装指南和链接，请参阅 OEM USB 驱动程序文档。
    *   如果你在 Mac OS X 上开发，它就可以工作。跳过此步骤。
    *   如果您在 Ubuntu Linux 上开发，上面的链接中有详细指南。

现在在 Eclipse 中，您的设备应该可以运行了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T14:11:46.677

在 eclipse 工具包中，您可以选择直接在设备上运行它。这样做相当快。

启用 USB 调试以及从市场以外的来源安装 apk。然后假设您已经设置了通过 ADB 连接到手机所需的驱动程序/设置，您应该能够在设备上运行它并进行调试。在运行对话框中，它将列出所有可用的设备，您只需选择要使用的设备即可。

如果您已经有一个运行条目（即您已经运行了您的应用程序），

*   选择你的项目
*   单击运行 -> 运行配置

您应该在您的应用程序运行配置中（在左侧的 Android 应用程序 -> Your_App 下）。

在目标选项卡中，您应该能够选择您的设备。它可能已经在“自动选择兼容设备...”中。在我的设置中，如果它是唯一可用的设备，它将直接在我的手机上运行。您可以选择始终提示选择设备，让您每次都选择。

Eclipse 插件（ADT）信息：http: [//developer.android.com/tools/help/adt.html](http://developer.android.com/tools/help/adt.html)

有关设置设备的信息：http: [//developer.android.com/tools/device.html](http://developer.android.com/tools/device.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-28T14:13:21.510

我知道**安卓模拟器太慢了**。

您可以使用**设备**或

试试[bluestacks](http://bluestacks.com/)可以节省很多时间。

仅当您想针对特定设备测试您的应用时才使用用户设备。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-28T14:11:59.383

这是您要查找的内容：

[http://developer.android.com/tools/device.html](http://developer.android.com/tools/device.html)

总结一下：

*   使用 USB 数据线将手机连接到计算机。
*   确保已安装驱动程序并且您的手机已正确连接。
*   `Ctrl + F11`从 Eclipse制作一个。

它将构建 apk，将其传输到您的手机，然后自动启动它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-28T14:13:06.360

如果您有单元测试，[Robolectric](http://pivotal.github.com/robolectric/index.html)允许您在不使用模拟器或设备的情况下运行它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-16T08:38:42.780

您可以下载*bluestacks*作为模拟器，因为它非常快。

然后在eclipse中进行设置为`window->preferences->android->build`->然后取消选中写为“跳过包装和...”的第三个复选框，然后应用并重新启动eclipse以生效。

现在在后台打开bluestacks，只需双击eclipse bin文件夹中的apk文件，bluestack将在2到3秒内安装它，您可以直接看到结果。

注意这里你只需要保存文件，你在eclipse中工作并且只双击apk，结果将直接出现在bluestacks中。`apk`无需在 bluestacks 中卸载并重新安装。

您也可以删除您的 apk，一旦您保存所有文件 apk 将被更新，它会立即自动创建一个新版本的 apk（因此不是必需的）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-28T14:12:50.420

谷歌蓝叠。

它在 Windows 上运行，而且速度非常快。

# sql - 在 MS Access 2007 中使用 SQL 用户定义函数

> ID：12641616
> 
> 赞同：3
> 
> 时间：2012-09-28T14:07:19.503
> 
> 标签：sql, ms-access, user-defined-functions

我对 Access 很陌生，在这里需要一些帮助。我正在使用 SQL 2008 Server 作为我的数据库来开发 MS Access 2007（在 VB 中）。

我想在 Access 的前端显示一个 SQL 表，但在 Access 2007 中将 SQL 用户定义函数与我的 SQL 查询一起使用时遇到了问题。我在 Access 的 SQL 查询设计中编写了这个函数和查询并尝试运行它。但它显示错误（用户定义的“时间部分”功能无法识别）！

```
CREATE function  dbo.timepart (@date as SMALLDATETIME) 
RETURNS SMALLDATETIME 
AS 
BEGIN 
RETURN @date - DATEADD(d, DATEDIFF(d,0,@date), 0) 
END 

SELECT * FROM TABLENAME WHERE dbo.timepart(FIELDNAME) Between '9:30' AND '17:30'; 
```

我猜 MS Access 不允许编写 UDF SQL 函数！我在本地 SQL Server 2008 数据库（SQL 管理工作室）中尝试了同样的查询，并且运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:08:43.600

您应该创建一个[传递](http://support.microsoft.com/kb/303968)查询。通过传递查询，代码在 SQL Server 上运行，结果返回到 MS Access。因此，您可以使用 SQL Server T-SQL。

还有[access-SQL 直通查询（创建 SP）错误](https://stackoverflow.com/questions/12197870/access-sql-pass-through-query-creating-sp-error/12198827#12198827)

![设置 odbc](../Images/aeb34fc39d4a8a90e40ba0d6c717f7e7.png)

# css - CSS HTML 垂直自动调整大小并按需滚动

> ID：12641618
> 
> 赞同：1
> 
> 时间：2012-09-28T14:07:24.960
> 
> 标签：css, html

所以这就是我想要做的：让有一个固定大小的列。列的高度应占用父级的大小。

在列内，我有两个垂直堆叠的 div。它们的宽度都占据了列宽。第一个 div 的高度是固定大小的。然而，第二个是可变的，占用父级的任何剩余部分。而且它的内容是可变的。如果它的内容太大，应该会出现一个垂直滚动条。

如何使用 HTML 和 CSS 做到这一点？

[这是一个快速的 JSFiddle POC。](http://jsfiddle.net/Tfzhm/)

我的问题是，如果我将第二个 div 高度设置为 auto，它将延伸到其父级之外。如果我将其设置为 100%，它将再次大于其父级。重要的是滚动条只出现在第二个 div 上，而不是主 div 本身。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:19:03.330

这是我要做的：

[http://jsfiddle.net/Tfzhm/1/](http://jsfiddle.net/Tfzhm/1/)

添加`position:relative`到`container div`, 并使可滚动`div position:absolute`. 顶部应设置为与第一个堆叠 div 的高度相同的像素数量。最后，设置`bottom:0px`它到达包含 div 的底线。

# c# - 如何使用 Windows 安装程序 XML？

> ID：12641619
> 
> 赞同：1
> 
> 时间：2012-09-28T14:07:24.087
> 
> 标签：c#, wpf, wix

大家好，我试图搜索有关如何使用 Windows 安装程序 xml 创建部署软件的示例。在visual studio 2010 .. wpf ..但我很难理解....我不知道如何以及从哪里开始......我将使用什么程序......据了解，这windows 安装程序 xml 是一种编码类型的部署.. 与 installaware 或 installshield 不同.. 您只需单击/添加文件并自动检测依赖项.... 有人吗？你能帮我解决这个问题吗.. 谢谢.. 你能给我一个想法，哪个是最好的 WIX 或 installshield 或其他部署软件？谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:14:08.360

Hi Wix 是一款非常强大的软件。我告诉你的不是胆小的人，陡峭的学习曲线让我每天都在挣扎，但本教程帮助我加载。

这是一个很好的起点[http://wix.tramontana.co.hu/](http://wix.tramontana.co.hu/)

希望这对您有所帮助。首先下载 Wix 3.6 工具集，因为它是最新的稳定版本。然后进入 VS2010 并点击新建 - 项目 - Windows 安装程序 Xml - 安装项目。

这将为您提供项目的基本知识，本教程将帮助您创建一个简单的 MSI 安装程序..:)

# iphone - 调用执行委托方法的方法

> ID：12641621
> 
> 赞同：0
> 
> 时间：2012-09-28T14:07:38.177
> 
> 标签：iphone, objective-c, ios, delegates

我有一个名为 myViewController 的视图控制器。然后我有一个名为 myLogic 的 NSObject。myLogic 有一个名为 executeLogic() 的方法，它将调用一些委托方法。（我猜委托方法是在单独的线程中调用的）。我正在从 myViewController 调用 executeLogic()，我希望它在返回执行 myViewController 上的下一个命令之前执行所有委托方法。现在我得到这个错误

```
 [URLRequestDBStoreLogic respondsToSelector:]: message sent to deallocated instance 0x5d2cff0 
```

我猜是因为它在调用委托方法之前返回到主线程？我不知道。有什么解决办法吗？将不胜感激。:)

这是调用 URLRequestDBStoreLogic 类的地方（注意这是一个 NSObject 类）

```
 URLRequestDBStoreLogic * urlRequestLogicDBStoreLogic = [[URLRequestDBStoreLogic alloc]init];
[urlRequestLogicDBStoreLogic loadObjectsAtRemoteServer]; 
```

这就是被调用的方法所做的

```
 - (void) loadObjectsAtRemoteServer {

RKURL * url = [RKURL URLWithBaseURLString:@"http://y.co.uk/share/proxy/alfresco/slingshot/search?site=&term=&tag=x&maxResults=251&sort=&query=&repo=false"];
objectManager = [RKObjectManager managerWithBaseURL:url];
  //Some other Code
   [[RKObjectManager sharedManager] loadObjectsAtResourcePath:@"?tag=x" delegate:self];
} 
```

这就是它在 if 语句中中断的地方。

```
// Setup the NSURLRequest. The request must be prepared right before dispatching
 - (BOOL)prepareURLRequest
  {
    [_URLRequest setHTTPMethod:[self HTTPMethod]];

if ([self.delegate respondsToSelector:@selector(requestWillPrepareForSend:)]) {
    [self.delegate requestWillPrepareForSend:self];
}

} 
```

# iphone - 在 Iphone 中自动滚动或 Endless 滚动

> ID：12641624
> 
> 赞同：0
> 
> 时间：2012-09-28T14:07:47.690
> 
> 标签：iphone

我正在开发 iphone 应用程序。需要一次显示 5 条记录，当我到达页面末尾时，接下来的 5 条记录将需要使用自动滚动加载。

初始 5 条记录显示完成。

当我到达页面末尾时滚动不起作用。

任何一个都可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T05:28:17.323

我找到了解决方案。我的代码如下，

```
myTable.addEventListener('scroll', function(e){

    if (Ti.Platform.osname === 'iphone')
    {
        var offset = e.contentOffset.y;
        var height = e.size.height;
        var total = offset + height;
        var theEnd = e.contentSize.height;

        // this condition will check whether the scroll reach end or not?
        if (theEnd == total)
        {
             //call the function once again.
             loadContents();
        }

    }
}); 
```

我希望...有人会使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T12:52:19.940

@Suresh.g

您可以将“ScrollView”与属性“contentHeight：Ti.UI.Size（或“Auto”）一起使用。

当您使用“ScrollView”时，它会根据您的要求设置默认高度。

您还可以启用 showHorizo​​ntalScrollIndicator : true,

欲了解更多信息，请阅读此[博客](http://developer.appcelerator.com/apidoc/mobile/1.0/Titanium.UI.ScrollView)

# ruby - RSpec - 使用测试双作为块参数

> ID：12641631
> 
> 赞同：5
> 
> 时间：2012-09-28T14:08:04.987
> 
> 标签：ruby, rspec

我有一些看起来像这样的 Ruby 代码：

```
Something.create do |x|
    x.foo = bar
end 
```

我想编写一个使用 double 代替块参数 x 的测试，这样我就可以调用：

```
x_double.should_receive(:foo).with("whatever"). 
```

这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T14:20:10.933

```
 specify 'something' do
   x = double
   x.should_receive(:foo=).with("whatever")
   Something.should_receive(:create).and_yield(x)
   # call the relevant method
 end 
```

# javascript - 如何为 iOS 5+ 打开新窗口

> ID：12641632
> 
> 赞同：0
> 
> 时间：2012-09-28T14:08:09.700
> 
> 标签：javascript, jquery, html, ios, mobile-safari

标题非常不言自明。我遇到的问题是 window.open 似乎只会在新选项卡中打开链接，而不是“新窗口”或移动 safari 的新实例。我已经尝试了我能想到的每一个小技巧，但它总是只是在新标签中打开它。我是否遗漏了一些东西，或者我将不得不去本地解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:09:29.877

iOS 上的 Safari 在一个进程中只有一个窗口（基本上任何其他 iOS 应用程序也是如此）。您无法在另一个实例或窗口中打开页面，只能打开一个新选项卡。

您也无法使用 App Store 批准的 SDK 方法在本机代码中解决此问题，无论是在 Safari 中还是在您自己的应用程序中。这不是 iOS 应用程序的工作方式。

# javascript - 在计算 computed() 被评估时调用的依赖 observable

> ID：12641635
> 
> 赞同：2
> 
> 时间：2012-09-28T14:08:28.907
> 
> 标签：javascript, knockout.js

我有计算函数，它基本上应该监听可观察数组（项目）中的任何变化。问题是 Knockout 在初始化时调用此函数。我知道它这样做是为了找出它的依赖关系，但就我而言，这是一个问题，因为它发出了 ajax 请求。除了引入一些计数器变量以在第一次调用时跳过调用 ajax 之外，还有其他解决方案吗？谢谢。

```
function MyViewModel(data) {
    var self = this;
    self.nameToAdd = ko.observable("");
    self.Items = ko.observableArray(data.items || []);

    self.add = function () {
        self.Items.push({ Name: self.nameToAdd()});
        self.nameToAdd("");
    };

    self.remove = function (item) {
        self.Items.remove(item);
    };

    ko.computed(function () {
        $.ajax({
            url: "myUrl",
            type: 'POST',
            data: ko.toJSON(self.Items),
            contentType: 'application/json'
        });
    }, self);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:25:11.383

我认为您真正想要的是手动订阅您的 Items 数组，以便在更新时调用 ajax 函数。

```
self.Items.subscribe(function(){
    $.ajax({
        url: "myUrl",
        type: 'POST',
        data: ko.toJSON(self.Items),
        contentType: 'application/json'
    });
}); 
```

仅当数组本身发生更改时才会调用传递的函数，因此不会在初始化时调用。例如，参见[小提琴。](http://jsfiddle.net/Rynan/j5Qw6/)

# php - 将自定义参数传递给 FancyBox

> ID：12641645
> 
> 赞同：-1
> 
> 时间：2012-09-28T14:09:10.063
> 
> 标签：php, jquery, fancybox

我正在开发一个酒店预订和预订管理系统。

我有一系列场地，用户通过单选按钮选择。一旦他们选择了地图按钮，我想将场地名称、经度和纬度数据发送到 Fancy Box 窗口，以便 Google Maps 可以开始确定路线数据的过程，具体使用[路线规划教程](http://www.dreamdealer.nl/tutorials/getting_directions_with_google_maps.html)。

我试过了...

```
function fancyboxLocation(href, venue, lo, la) {
   $.fancybox({
       'hideOnContentClick': true,
       'height': 430,
       'padding': 0,
       'width': 700, 
       'type': 'iframe',
       'href' : href,
       'venue': venue,
       'lo': lo,
       'la': la
   });
}

<a href="javascript:;" onclick="fancyboxLocation('<?php echo config_item('base_url'); ?>venues/locations/route', '<?php echo $venues['name']; ?>', '<?php echo $venues['longitude']; ?>', '<?php echo $venues['latitude']; ?>')" title="Plan Route"> 
```

虽然出现了窗口，但我的个人参数（地点、lo 和 la）正在被删除。

这些参数正在进入fancyboxLocation 函数，但它们没有进一步移动。

任何想法我如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:52:37.920

也许你可以调用 ajax 内容

```
$.fancybox({
    'hideOnContentClick': true,
    'height': 430,
    'padding': 0,
    'width': 700, 
    'type': 'iframe',
    'href' : href,
    'ajax' : {
        type    : "POST",
        data    : 'venue='+escape(venue)+'&lo='+escape(lo)+'&la='+escape(la)
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-19T08:46:38.453

// 文档准备好

```
const fancyFunction = (elementEvent) => {
    const cta = elementEvent.data('cta');
    elementEvent.fancybox({
        autoSize: false,
        autoPlay: true,
        width: 510,
        autoHeight: true,
        beforeLoad: () => {
            console.log('beforeLoad', cta);
        }
    });
};

$('.fancy-domec').each((i, e) => {
    fancyFunction($(e));
}); 
```

// 在 HTML 上

```
 <div class="ctas">
        <p><a href="#fancy-domec" class="fancy-domec" data-cta="add">Add something</a></p>
        <p><a href="#fancy-domec" class="fancy-domec" data-cta="check">Check something</a></p>
    </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-24T05:25:47.967

我知道这很旧，但我认为它可能对其他人有所帮助。希望你一切正常。

FancyBox API 有一个如下所示的 open 方法：

```
$.fancybox( [jQuery object] ); 
```

因此，您可以使用上述方法创建一个类似于以下的简单 javascript 函数。例如：

```
function displayFancybox(param1, param2) {
     // Open FancyBox
     $.fancybox(document.getElementById("myFancyBoxContainer"));

     // Do whatever you want with your parameters (maybe write them to a div)
     document.getElementById("someDiv").innerHTML = param1;

     // Or maybe initialize a google map
     initialize(param1, param2);
} 
```

这是用户单击以触发 FancyBox 的 html 链接：

```
<a onclick="displayFancybox('some text', 'some more text');" href="#" title="Some Title">Click Me!</a> 
```

# android - Android：未知的专辑、艺术家、音乐流派将如何显示？

> ID：12641649
> 
> 赞同：2
> 
> 时间：2012-09-28T14:09:20.713
> 
> 标签：android, android-mediaplayer, audio-player

我正在 Android 中开发一个音乐应用程序，当检索歌曲的专辑、艺术家、流派名称时，我得到了一些未知名称。

对于专辑，未知专辑名称显示为“音乐”。对于艺术家，未知艺术家名称显示为“”，对于流派，未知流派显示为“”

这些默认名称在所有设备上都相同吗？因为我想将那些未知名称重命名为更具可读性 - 例如：“未知艺术家”或“未知专辑”

我只在 2 台设备上尝试过，发现未知专辑名称显示为“音乐”，但未知艺术家名称在两种设备中的显示方式不同。

我想知道如何处理这些未知名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:18:15.007

似乎您需要[UNKNOWN_STRING](http://developer.android.com/reference/android/provider/MediaStore.html#UNKNOWN_STRING)：

> 当媒体属性未知时使用的字符串。例如，如果音频文件没有任何元数据，则艺术家和专辑列将设置为此值。

我在这里检查了 MediaPlayer android 代码，实际上默认情况下它正在执行以下步骤：

*   检查来自 ContentProvider 的字符串是否为 UNKNOWN_STRING；
*   如果是这样，它会被资源中的一些字符串改变（我怀疑你真的需要那些字符串）；

因此，您只需要检查 ContentProvider 返回的数据`MediaStore.UNKNOWN_STRING`并处理任何您喜欢的数据。（例如，在所有设备上提供相同的字符串）。
比如签出[com.android.music.MediaPlaybackActivity](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.1.1_r1/com/android/music/MediaPlaybackActivity.java#MediaPlaybackActivity)源码，它有如下代码：

```
if (MediaStore.UNKNOWN_STRING.equals(albumName)) {
    albumName = getString(R.string.unknown_album_name);
    albumid = -1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-01T11:38:11.487

If your audio media have no album metadata then android scanner sets the album name to the name of the folder containing your media.

# java - 如何使用任何程序语言从已填写的 pdf 表单中提取数据？

> ID：12641650
> 
> 赞同：-2
> 
> 时间：2012-09-28T14:09:22.137
> 
> 标签：java, php, c, forms, pdf

我有一个 pdf 表格，我已经填写了该表格中的字段并将该 pdf 文件保存为一个新的 pdf 文件。现在，当我打开新的 pdf 文件时，它会自动加载之前填写的数据。我可以使用 C/Java/PHP/Javascript 中的任何语言提取该数据，以便我可以使用它并将其保存到数据库中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:14:01.297

是的你可以。最简单的解决方案可能是使用 PDF 库来访问文件。

PHP：[http ://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)

# java - OutOfMemoryError 使用 Memcached

> ID：12641652
> 
> 赞同：0
> 
> 时间：2012-09-28T14:09:24.693
> 
> 标签：java, jvm, memcached, spymemcached

我在带有 spymemcached 的 EJB 上遇到此错误，使用在 wiwndows 上运行的 memcached 远程服务器。

```
Caused by: java.lang.OutOfMemoryError: unable to create new native thread
    at java.lang.Thread.start0(Native Method)
    at java.lang.Thread.start(Thread.java:597)
    at net.spy.memcached.MemcachedConnection.<init>(MemcachedConnection.java:132)
    at net.spy.memcached.DefaultConnectionFactory.createConnection(DefaultConnectionFactory.java:176)
    at net.spy.memcached.MemcachedClient.<init>(MemcachedClient.java:194)
    at net.spy.memcached.MemcachedClient.<init>(MemcachedClient.java:154) 
```

有什么想法吗？如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:38:28.443

您可能非常快地执行异步操作并且没有检查这些操作的值。结果，操作在客户端排队，直到内存不足。尝试在 OperationFuture 对象上调用 .get() 函数以使它们同步。

# c# - InlineUIContainer 内的 Windows 8 WinRT Xaml 网格

> ID：12641656
> 
> 赞同：1
> 
> 时间：2012-09-28T14:09:33.587
> 
> 标签：c#, xaml, windows-8, windows-runtime

在我的 Windows 8 ItemDetail 视图中，我想将叠加图像添加到包含在 InlineUIContainer 元素中的标准图像。

这是我正在使用的 xaml：

```
<Paragraph LineStackingStrategy="MaxHeight">
    <InlineUIContainer>
        <Grid x:Name="MediaGrid" Width="560" Height="315" Margin="0,20,0,10">
            <Grid.Background>
                <ImageBrush ImageSource="{Binding Image}" Stretch="UniformToFill" />
            </Grid.Background>
            <Button Click="Button_Click" Background="Transparent" BorderBrush="Transparent" BorderThickness="0">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Image x:Name="OverlayImage" Visibility="{Binding ShowVideo, Converter={StaticResource booleanToVisibilityConverter}}" Source="ms-appx:///Assets/play-icon.png"/>
                    </ControlTemplate>
                </Button.Template>
            </Button>
        </Grid>
    </InlineUIContainer>
</Paragraph> 
```

当应用程序处于横向模式时，这非常有效。但是，一旦我旋转或以纵向模式打开应用程序，我就会收到错误消息：

`WinRT information: Cannot resolve TargetName image. Additional information: Unspecified error`在 LayoutAwarePage.cs`VisualStateManager.GoToState(control, DetermineVisualState(ApplicationView.Value), false);`

有谁知道为什么？经过一些消除过程后，当我在 InlineUIContainer 中有一个 Grid 时，似乎会发生这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:14:31.700

看起来缺少控件名称“图像”，并且仅在更改 VisualState 时触发

# memory - iOS6 MKMapView 使用大量内存，导致应用程序崩溃，其他人注意到了吗？

> ID：12641658
> 
> 赞同：52
> 
> 时间：2012-09-28T14:09:42.040
> 
> 标签：memory, memory-management, mkmapview, ios6, ios6-maps

有没有其他人在他们的 iOS 6 应用程序中使用地图，注意到内存使用量极高，以至于一遍又一遍地收到内存警告，甚至导致应用程序崩溃？

我已经通过仪器运行了该应用程序，并且没有看到任何泄漏，并且在创建地图视图之前，该应用程序始终以大约 3mb 的实时字节运行。创建地图并下载图块后，Live Bytes 会跃升至 ~13mb Live Bytes。然后，当我四处移动地图并放大和缩小 Live Bytes 时，Live Bytes 会不断攀升，直到应用程序在大约 40mb Live Bytes 处崩溃。顺便说一句，这是在 iPhone 4 上。在 iPod touch 上，它崩溃得更早。

我正在正确地重用注释视图，并且没有任何泄漏。其他人在新的 iOS 6 地图中看到同样的高内存使用情况吗？另外，有人有解决办法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-07T14:42:20.887

经过大量的尝试和测试不同的想法，其中一些在这里提到，对我有用的最终解决方案如下。

*   我没有在应用程序中根据需要创建新的 MKMapView，而是向我的 AppDelegate 添加了一个 mkMapView 属性，并且只在需要时创建它。一旦它被创建，它就永远存在于 AppDelegate 中，并且我在任何需要的地方重用该单个实例。这确实有助于减少使用的内存量，因为我之前实例化了几个不同的 MKMapView，并且两者都很快消耗了内存。

*   我还发现一旦收到内存警告，iOS 6 地图就可以很好地处理释放内存。是的，它在缩放和平移时确实会消耗更多内存，但似乎对内存警告做出了适当的响应。

*   我要做的最后一件事是减少我的整体初始内存占用。我注意到我开始的时候比我预期的要高，所以这也导致了我收到的与记忆有关的崩溃。一旦我降低了初始占用空间，让 MKMapView 在内存警告期间处理释放它的内存，并确保我只有 1 个 MKMapView 实例可以在整个应用程序中重用，一切运行良好。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-20T07:37:45.813

我也有这个问题，它让我发疯。试图根据 mateo 的帖子找出一个修补程序，这就是我想出的：

```
- (void)applyMapViewMemoryHotFix{

    switch (self.mkMapView.mapType) {
        case MKMapTypeHybrid:
        {
            self.mkMapView.mapType = MKMapTypeStandard;
        }

            break;
        case MKMapTypeStandard:
        {
            self.mkMapView.mapType = MKMapTypeHybrid;
        }

            break;
        default:
            break;
    }

    [self.mkMapView removeFromSuperview];
    self.mkMapView = nil;
} 
```

我不知道为什么，但是从 superview 中删除然后设置为 nil 的组合确实减少了内存使用量。我在控制器的 viewDidDisappear 中调用了这个方法。

我尝试过但没有显着效果的其他事情：

1) 在 mkMapView 的 alloc init 周围创建 autoreleasepool

2）在纬度 84 lon -30 附近设置显示区域，因为我认为北极的矢量信息可能没有那么密集......但是，没有帮助；）

这个问题非常严重，会导致我们的应用程序不稳定，并在 iOS 6 中导致大量内存警告。当然希望 Apple 发布比我更好的修补程序......很快！

请批评我的修补程序并提出更有效的方法来减少丢弃地图时的内存使用量。谢谢！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-10T07:21:30.180

我遇到同样的问题。

缩放和更改位置后永远不会释放内存。

我发现的唯一技巧是在内存警告后更改地图类型。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-09-06T10:17:24.640

这个问题在 iOS 9 中仍然存在——除非你这样做。

使用故事板中设置的地图视图与视图控制器进行切换会在大约 10-15 个显示和关闭周期后导致崩溃（对我而言）。

现在看来修复很简单。添加这个

```
override func viewDidDisappear(animated: Bool) {
    super.viewDidDisappear(animated)
    mapView.removeFromSuperview()
} 
```

似乎已经解决了这个问题，可以循环往返20多次，没有问题。没有崩溃！！

希望这可以帮助。这是一个令人沮丧的问题，很高兴它解决了。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-02T01:58:33.407

我的足迹是：2.48；19.51；49.64; 12.60即：加载mapView之前的内存，加载mapView之后，放大/缩小一点之后，释放mapView之后（这很烦人，即使在释放mapView之后，我保持10MB的增量，它不会去下！）

无论如何，我不再为 MapView 使用 IBOutlet，而是在代码中创建所有内容。新的足迹现在是：2.48；19.48；38.42; 12.54。

仍在努力放下bi ***。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-10-11T00:41:15.640

不是一个解决方案，而只是一个技巧......

...更改 mapType => mapkit 释放内存。

即使这种变化只是几分之一秒。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-10-03T12:59:21.303

我有同样的感觉，不知道怎么做`release`，`memory`即使`MKMapView`不使用。

我已经发布了控制器，`MKMapView`容器视图...`memory`仍在使用。

不要记得`MKMapView`在 iOS5 中使用 old 来体验这个。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-10-15T22:42:34.087

```
- (void)applyMapViewMemoryHotFix{

    switch (self.mapView.mapType) {
        case MKMapTypeHybrid:
        {
            self.mapView.mapType = MKMapTypeStandard;
        }

            break;
        case MKMapTypeStandard:
        {
            self.mapView.mapType = MKMapTypeHybrid;
        }

            break;
        default:
            break;
    }

    self.mapView.mapType = MKMapTypeStandard;

}
-(void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated
{
    [self applyMapViewMemoryHotFix];
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-11-11T21:17:20.830

**For those journerying here in 2014+ (iOS8 and up)**

I am running into this problem on iOS 7+ trying to support older devices (think Ipad 2 with 512MB).

My solution is to disable Zoom as it easily takes the most memory.

```
 long mem = [NSProcessInfo processInfo].physicalMemory;
    if(mem < _memory_threshold){
        self.MapView.zoomEnabled = NO;
    } 
```

I have tried *everything* from switching map types, to deallocating the map, setting the delegate to nil, removing all overlays, annotations etc.

None of that works on iOS7+. In fact, most of these fixes cause jumps in memory, as MKMapView seems to leak and never properly dealloc (I have verified through sub-classing that I see dealloc hit).

This sucks, but all I have came up with so far is disabling map features (zoom, scroll, user interactions) as a means to limit the atrocious amount of memory MKMapView takes. This has resulted in my App at the very least being semi-stable on older devices.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-11-19T16:11:36.517

我收到同样的问题 -

我对此并不完全确定，但新的苹果地图是否会预加载一大块地图以适应离线导航？

如果您在地图加载后关闭连接，然后尝试放大所需位置附近的区域，那么似乎仍然有很多细节可用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-11-05T06:38:06.837

不确定后果。

每当视图消失时，如何将 map 设置为“nil”，帮助我将内存使用量从 ~250MB 减少到 ~50-60MB。

```
-(void)viewDidDisappear:(BOOL)animated
{
     self.map = nil; 
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-03-26T12:24:13.893

只有以下几行足以解决内存问题：

**对于 Objective-C：**

```
- (void) applyMapViewMemoryFix {
  [self.mkMapView removeFromSuperview];
  self.mkMapView = nil;} 
```

**对于 Swift 3.0：**

```
func applyMapViewMemoryFix() {
    mapView.removeFromSuperview()
    self.mapView = nil
} 
```

# backbone.js - 加载模板前的客户端本地化

> ID：12641659
> 
> 赞同：1
> 
> 时间：2012-09-28T14:09:43.383
> 
> 标签：backbone.js, marionette

我使用**backbone.js**和**Marionette.js**扩展在我的网络应用程序上工作。

对于一个国际网站，我想制作一个本地化模块，并为特定语言（在客户端使用浏览器语言检测到）异步加载适当的 JSON。

在第一次加载主页时，Marionette 使用异步方法获取所有模板。

如何在 Marionette 模板呈现之前替换语言字符串？

感谢您的帮助和理解我的英语！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:53:42.727

您无需执行任何特定于 Marionette 的 Backbone 特定操作。任何好的 JavaScript 解决方案都应该可以工作，并且在这个 SO 问题中有一个很棒的 i18n 资源列表：[https ://stackoverflow.com/questions/48726/best-javascript-i18n-techniques-ajax-dates-times-numbers-货币](https://stackoverflow.com/questions/48726/best-javascript-i18n-techniques-ajax-dates-times-numbers-currency)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-03T22:00:15.547

如果您正在寻找一种即插即用的解决方案，可以从模板中提取本地化并提供内容管理和翻译服务。我建议查看 Localize.js

# sql - 1and1 不接受我的 SQL

> ID：12641660
> 
> 赞同：0
> 
> 时间：2012-09-28T14:09:44.533
> 
> 标签：sql, mysql-workbench, procedure

我在本地主机上开发时使用 MySQL Workbench，以下存储过程工作得很好。

```
CREATE PROCEDURE `follow`(IN in_follower INT(11), IN in_followee VARCHAR(45))
BEGIN
INSERT INTO follower (follower_id, followee_id)
VALUES (in_follower,(SELECT `user_id` FROM user WHERE `username` = in_followee));
END 
```

当我尝试创建 1and1 的服务器的过程时，SQL 在以下错误下被拒绝：

错误 #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 4 行的 '' 附近使用正确的语法

到底怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:13:47.610

根据[文档](http://dev.mysql.com/doc/refman/5.0/en/insert-select.html)，我认为您的语法应该是：

```
CREATE PROCEDURE `follow`(IN in_follower INT(11), IN in_followee VARCHAR(45))
    INSERT INTO follower 
    (follower_id, followee_id)
    SELECT in_follower, `user_id` 
    FROM   user 
    WHERE  `username` = @in_followee);
END 
```

老实说，我很惊讶你的原始语法在本地工作......

# iphone - 如何复制地址簿图像并在表格视图中显示？

> ID：12641661
> 
> 赞同：0
> 
> 时间：2012-09-28T14:09:43.883
> 
> 标签：iphone, image, nsdata, addressbook

如何将所有通讯录联系人的图像复制到一个数组中，然后在表格视图中显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:29:57.277

我没有任何代码示例给你，但我有你应该调用的 API。

您需要深入研究 AddressBook 文档。

ABAddressBookGetPersonCount - 获取 ABAddressBookRef 中的人数 ABAddressBookCopyArrayOfAllPeople - 获取书中所有人的数组。ABPersonCopyImageData 和 ABPersonCopyImageDataWithFormat 将为您获取每个人的图像。

有很多定义明确的示例说明如何在表格中显示图像，可能就在这个网站上。看看玩 UTableView、UITableViewCell、UITableViewDelegate 和 UITableViewDataSource。

希望这可以帮助！

# c - ctags 没有获取返回值类型在函数名称之上的函数

> ID：12641662
> 
> 赞同：0
> 
> 时间：2012-09-28T14:09:45.253
> 
> 标签：c, ctags

我正在使用一些具有以下样式的代码：

```
int
add5 (int x) {
    return x+5;
} 
```

换句话说，函数的返回值类型写在函数名的正上方。正因为如此，`ctags`不认识这些功能并让我头疼不已。有人知道如何`ctags`处理这种情况吗？

**编辑**：`ctags` *可以*识别 .c 文件上的函数名，但我需要的是`ctags`识别`.h`文件上的函数名。在 .h 文件上，我有以下内容：

```
int
add5 (int); 
```

并有`ctags`不承认`add5`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:03:19.857

你必须告诉`ctags`搜索函数的原型。它是通过`--<LANG>-kinds`选项完成的。

因此，运行以下命令：

```
ctags --c-kinds=+p * 
```

它会将声明添加到`tags`文件中，正如您在我的测试输出中看到的那样：

```
!_TAG_FILE_FORMAT       2       /extended format; --format=1 will not append ;" to lines/
!_TAG_FILE_SORTED       1       /0=unsorted, 1=sorted, 2=foldcase/
!_TAG_PROGRAM_AUTHOR    Darren Hiebert  /dhiebert@users.sourceforge.net/
!_TAG_PROGRAM_NAME      Exuberant Ctags //
!_TAG_PROGRAM_URL       http://ctags.sourceforge.net    /official site/
!_TAG_PROGRAM_VERSION   5.8     //
add5    add.h   /^add5 (int);$/;"       p 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:59:58.877

在我看来，这听起来像是`ctags`在识别函数但没有找到它的声明。

事实上，如果你在头文件中创建这个函数：

```
int
plus(int a,int b) {
    return a+b;
} 
```

`ctags`可以找到它。

# java - Spring 的 JdbcTemplate 和事务

> ID：12641666
> 
> 赞同：29
> 
> 时间：2012-09-28T14:10:08.997
> 
> 标签：java, spring, spring-mvc, jdbctemplate

使用 JdbcTemplate 时，是否需要显式配置事务？

我的代码布局如下所示：

我将有一个将被注入到我的 UserService 中的 UserDao，然后我的控制器将调用我的 UserService 中的方法。

我想让事情尽可能简单的事务，我不需要多个数据库调用来跨越一个事务。

默认情况下，我是否必须在我的配置文件中做任何事情或在`@Transaction`任何地方使用注释？

现在说在我的控制器中我需要对我的 userService 和 accountService 进行 2 次调用，我可以以某种方式明确地将它包装在事务中吗？

```
userService.updateUser(user);
accountService.updateXXX(...); 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-28T14:14:16.250

是的，`JdbcTemplate`不能代替事务管理。你仍然受益于数据库事务，所以`userService.updateUser`会在*数据库事务中操作，**但*如果`accountService.updateXXX`失败，`userService.updateUser`不会回滚。

 *如果不想使用 AOP，可以使用[TransactionTemplate](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/transaction/support/TransactionTemplate.html)代替。请参阅[Spring 参考文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/)中的[程序化事务管理](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/transaction.html#transaction-programmatic)。

我以前见过的一种模式是 MVC 控制器类调用业务服务，该服务封装了操作。然后可以对业务类的方法进行注释`@Transactional`。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-28T14:29:07.370

如果您的控制器想要对用户和帐户做几件事，并且所有这些都发生在一个事务中，那么您应该使用一种方法来完成所有这些事情。为每个 DAO 创建一个服务并不是一个好主意，因为您最终会得到围绕 DAO 的无操作包装器，并且处理速度会很慢，因为数据库必须为对 DAO 的每次调用创建单独的事务，您正在这样做比它应该做的工作要多得多。

该服务应该为控制器或其他调用它的人提供功能。我尝试创建服务的想法是，服务提供对特定类型用户有用的特定功能。*

# java - Hibernate 在 DAO 查询处停止

> ID：12641672
> 
> 赞同：3
> 
> 时间：2012-09-28T14:10:26.270
> 
> 标签：java, spring, hibernate, spring-mvc, dao

问题是，当我进入登录页面时，输入用户名/密码进行登录，即使我写得正确，我也会收到错误消息（我检查了我的数据库并且条目存在）。我知道我应该使用 Logger，但我仍在学习带有 Hibernate 的 Spring Framework。

编辑：
1.第一部分测试我输入了一个空的用户名/密码（它适用于空/空）。对于第二部分，我使用了一个*应该可以*工作的部分。
2.其他 DAO 与 Hibernate 一起正常工作（例如，它们正确检索数据，我对它们没有问题）

控制台输出如下所示：

```
-----------------------------------
User Service INVOKED
User Service-- searching for User:
DAO-- Searching for:
Hibernate: select this_.id as id9_0_, this_.accountName as accountN2_9_0_, this_.password as password9_0_, this_.secGrade as secGrade9_0_, this_.userEmail as userEmail9_0_, this_.userName as userName9_0_ from USER this_ where this_.accountName=?
DAO-- End search
DAO--Not found
User Service-- UserProxyImpl instantiated
User Service-- NOT FOUND,
null
true //<-- Error returned to the controller
-----------------------------------
User Service INVOKED
User Service-- searching for User:admin
DAO-- Searching for:admin
Hibernate: select this_.id as id9_0_, this_.accountName as accountN2_9_0_, this_.password as password9_0_, this_.secGrade as secGrade9_0_, this_.userEmail as userEmail9_0_, this_.userName as userName9_0_ from USER this_ where this_.accountName=?
UserService-- Error in retrieving user
// It stops here and i don't understand why
true // still, returns error to the controller. 
```

这是会话超时问题吗？

来自登录控制器的方法：

```
@RequestMapping(value = "/login", method = RequestMethod.GET)
    public String Login(@RequestParam(value="error", required=false) boolean error,ModelMap model) {

        if (error == true) {
            model.put("error", "You have entered an invalid username or password!");
        } else {
            model.put("error", "");
        }
        System.out.println(error);
        return "login";     

    } 
```

用户实体：

```
@Entity
@Table(name = "USER")
public class User implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = -1963505165125499005L;

    private long id;
    private int secGrade;

    private String userName;
    private String accountName;
    private String password;
    private String userEmail;

    public User(String name,
                String user_name,
                String password,
                String email,
                int secGrade){
        this.userName = name;
        this.accountName = user_name;
        this.password = password;
        this.userEmail = email;
        this.secGrade = secGrade;
    }

    @Id
    @GeneratedValue
    public long getId() {
        return id;
    }
    public void setId(long id) {
        this.id = id;
    }
    public int getSecGrade() {
        return secGrade;
    }
    public void setSecGrade(int secGrade) {
        this.secGrade = secGrade;
    }

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getAccountName() {
        return accountName;
    }

    public void setAccountName(String accountName) {
        this.accountName = accountName;
    }

    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }

    public String getUserEmail() {
        return userEmail;
    }

    public void setUserEmail(String userEmail) {
        this.userEmail = userEmail;
    }

} 
```

用于处理数据库实体的代理类：

```
public class UserProxyImpl implements UserProxy {

    private int secGrade;   
    private String name;
    private String user_name;
    private String password;
    private String email;

    public UserProxyImpl() { }

    public UserProxyImpl(User usr){
        if( usr != null){
            System.out.println("USER PROXY--- constru from "+usr.getAccountName());
            this.secGrade = usr.getSecGrade();
            this.name = usr.getUserName();
            this.user_name = usr.getAccountName();
            this.password = usr.getPassword();
            this.email = usr.getUserEmail();
        }
    }
+ GETTERS/SETTERS
} 
```

来自 UserServiceImpl 的方法，这些方法创建了 User obj 并添加了 Authorities：

```
@Override
        public UserDetails loadUserByUsername(String username) 
                throws UsernameNotFoundException,DataAccessException {
                // Declare a null Spring User
                UserDetails user = null;
                System.out.println("-----------------------------------");
                System.out.println("User Service INVOKED");

            try {
                System.out.println("User Service-- searching for User:"+username);
               // Search database for a user that matches the specified username
                UserProxyImpl dbUser = new UserProxyImpl(userDAO.searchDB(username));
                System.out.println("User Service-- UserProxyImpl instantiated");
                if(dbUser.getName() != null){
                    System.out.println("User Service-- FOUND,"+username);
                }
                else{
                    System.out.println("User Service-- NOT FOUND,"+username);
                }

               // Populate the Spring User object with details from the dbUser
               // getAuthorities() will translate the access level to the correct role type
                System.out.println(dbUser.getName());
                user = new User(
                        dbUser.getUser_name(),
                        dbUser.getPassword().toLowerCase(),
                        true,
                        true,
                        true,
                        true,
                        getAuthorities(new Integer(dbUser.getSecGrade()))
                        );
                System.out.println(user.toString());
              } catch (Exception e) {
               System.out.println("UserService-- Error in retrieving user");
               throw new UsernameNotFoundException("Error in retrieving user");
              }

              // Return user to Spring for processing.

              return user;
             }

         @Override
        public Collection<GrantedAuthority> getAuthorities(Integer access) {
               // Create a list of grants for this user
               List<GrantedAuthority> authList = new ArrayList<GrantedAuthority>(2);

               // All users are granted with ROLE_USER access

               authList.add(new GrantedAuthorityImpl("ROLE_USER"));

               // Check if this user has admin access
               // We interpret Integer(3) as an admin user
               if ( access.compareTo(3) == 0) {

                    authList.add(new GrantedAuthorityImpl("ROLE_ADMIN"));

               }
               else if ( access.compareTo(2) == 0) {                

                   authList.add(new GrantedAuthorityImpl("ROLE_MOD"));
               }

               // Return list of granted authorities
               return authList;
               } 
```

用于从数据库中检索对象的 DAO 类方法：

```
public User searchDB(String username){

        User u = (User)this.getSessionFactory().getCurrentSession()
                    .createCriteria(User.class)
                    .add(Restrictions.eq("accountName",username))
                    .uniqueResult();
        System.out.println("DAO-- End search");
        if(u != null){
            System.out.println("DAO-- Found:"+u.getUserName());
            return u;
        }
        else{
            System.out.println("DAO--Not found");
            return null;
        }

    } 
```

弹簧安全配置。XML:

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans 
    xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                        http://www.springframework.org/schema/security 
                        http://www.springframework.org/schema/security/spring-security-3.1.xsd">

 <http auto-config = 'true' use-expressions="true" access-denied-page="/denied" >

    <intercept-url pattern = "/home/" access="permitAll"/>
    <intercept-url pattern = "/home/login" access="permitAll"/>
    <intercept-url pattern = "/home/jobs" access="permitAll"/>
    <intercept-url pattern = "/home/info" access="permitAll"/>
    <intercept-url pattern = "/home/common" access="hasRole('ROLE_USER')"/>
    <intercept-url pattern = "/home/desk" access="hasRole('ROLE_MOD')"/>
    <intercept-url pattern = "/home/admin" access="hasRole('ROLE_ADMIN')"/>
    <form-login login-page="/login"
                default-target-url="/home"
                authentication-failure-url="/home/login?error=true"/>
    <logout logout-success-url="/home" />               
 </http> 

 <authentication-manager alias="authenticationManager">
    <authentication-provider ref="authenticationProvider"/>
</authentication-manager>

<beans:bean id="authenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
    <beans:property name="userDetailsService" ref="UserServiceImpl"/>
</beans:bean>

 <!-- Use a Md5 encoder  -->
 <beans:bean class="org.springframework.security.authentication.encoding.Md5PasswordEncoder" id="passwordEncoder"/>

 <!-- A custom service where Spring will retrieve users and their corresponding access levels  -->
 <beans:bean id="UserServiceImpl" class="com.x.interview_management.service.impl.UserServiceImpl"/>

</beans:beans> 
```

登录.jsp：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page session="false" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
<h1>${error}</h1>
    <sec:authorize access="!isAuthenticated()">
    <div id = "login" style="text-align:center;">

                <h3 style="text-align:center">Login with Username and Password</h3>

                    <form action='/InterviewManagement/j_spring_security_check' method='POST'>
                    <table>
                    <tr>
                        <td>Username:</td>
                        <td><input type='text' name='j_username' value=''><td/>
                    <tr/>
                    <tr>
                        <td>Password:</td>
                        <td><input type='password' name='j_password'/><td/>
                    <tr/>

                    <tr>
                        <td><input name="submit" type="submit"/></td>
                        <td><input name="reset" type="reset"/></td>
                    </tr>
                    </table>
                    </form>

    </div>
    </sec:authorize>    
    <a href="/InterviewManagement/home/">return home</a>
</body>
</html> 
```

抱歉代码布局，这是我第一次在 StackExchange 上发帖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T11:24:36.470

问题是我没有 User 类的默认构造函数。

# javascript - LI 元素的 Javascript 正则表达式

> ID：12641673
> 
> 赞同：0
> 
> 时间：2012-09-28T14:10:34.320
> 
> 标签：javascript, regex

我正在使用 Javascript 中的正则表达式（请参阅[此处](https://stackoverflow.com/questions/12586602/javascript-regular-expression-for-nested-css-classes)），并且在尝试匹配`<li>`元素时偶然发现了一些困难。我的 CSS 看起来像这样：

```
<div id="ResultTabContent" class="TabContent DetailsTabContent">
    <div class="DetailsTabContent">
    <ul>
    <li> <strong>Title:</strong>
    Text Title
    </li>
    </ul> 
```

我编写了一些 Javascript 来检测写入文本标题的 Unicode 范围，并根据范围使用自定义字体中的 PUA（私人使用区域）。这适用于类，如下所示：

```
$(document).ready(function() {
    $('h2.ClassName').each(function(index, DOMElement){
        if(/[\uE000-\uF8FF]+/.test($(DOMElement).text())) {
            $(this).removeClass('ClassName').addClass('ClassNameNonRoman');
        }
    }) 
}); 
```

但是我不能让它对 UL 继承的元素起作用。使这变得困难的是没有与`<li>`元素关联的类这一事实。

任何想法？

干杯，我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:21:56.113

因此，您似乎正在使用正则表达式来验证某些文本内容，但您的问题是关于定位`<li>`没有类的元素。

您可以使用 CSS 样式选择器进行 DOM 选择。我不确定您能够选择什么，所以我将选择器`<div>`基于具有 ID 的外部。

```
$(document).ready(function() {
    var li_els = $('#ResultTabContent > div.DetailsTabContent > ul > li');

    li_els.each(function(index, DOMElement){
        if(/[\uE000-\uF8FF]+/.test($(DOMElement).text())) {
            $(this).removeClass('ClassName').addClass('ClassNameNonRoman');
        }
    }) 
}); 
```

这使用`>`子选择器从外部 DIV 向下钻取到嵌套的 LI 元素。

然后`.each()`就像在您的原始代码中一样用于迭代 LI。

# postgresql - 如何在 postgresql 数据库中获取正在运行的查询的状态

> ID：12641676
> 
> 赞同：50
> 
> 时间：2012-09-28T14:10:37.583
> 
> 标签：postgresql, postgresql-8.4

我有一个运行很长时间的选择查询。我将如何获得该查询的状态，例如它将运行多长时间？是否从表中访问数据。

注意：根据`pg_stat_activity`查询状态显示为活动而不是等待状态。就像在 Oracle 中一样，我们可以看到查询的源/目标和处理状态 - 在 postgresql 中是否有类似的东西？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2017-05-27T00:34:08.923

基于@Anshu 回答我正在使用：

```
SELECT datname, pid, state, query, age(clock_timestamp(), query_start) AS age 
FROM pg_stat_activity
WHERE state <> 'idle' 
    AND query NOT LIKE '% FROM pg_stat_activity %' 
ORDER BY age; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-09-19T20:25:38.597

这还不能完成，但在[TODO](https://wiki.postgresql.org/wiki/Query_progress_indication)上。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-09-05T13:54:22.707

我们可以在 postgres 中找到关于数据库的查询日志。

```
select *
from pg_stat_activity
where datname = 'yourdatabasename' 
```

这将给出数据库的活动查询日志。

# debugging - NodeJS - NodeJS 的分步调试器

> ID：12641679
> 
> 赞同：10
> 
> 时间：2012-09-28T14:10:52.823
> 
> 标签：debugging, node.js, stack, trace

我正在寻找逐步调试 NodeJS 服务器代码的有效方法。目前我使用了几十个console.log()，这非常困难。完美的工具可以让我检查堆栈中每个变量的值并逐行跟踪我的程序。首选操作系统 = MacOS/Linux。是否可以？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-28T14:49:59.390

基本上，Node.js 是建立在 V8 之上的，所以它的调试能力也是建立在 V8 的调试能力之上的。

V8 包含一个调试器，可以通过端口 5858 上的 TCP 访问。

所以基本上你只需要一个能够连接到端口 5858 并谈论 V8 调试协议的前端。

一种选择是使用[节点检查](https://github.com/dannycoates/node-inspector)器，它基本上在浏览器中提供调试 UI。不幸的是，它只适用于 Google Chrome 和 Apple Safari（对我来说没问题，但可能还有其他 ;-)）。

另一种选择是使用[Eclipse 插件](https://github.com/joyent/node/wiki/Using-Eclipse-as-Node-Applications-Debugger)。

而且，最后但同样重要的是，Node.js 的内置调试器（它总是让我想起 MS-DOS 的`edlin`）也只是这个 TCP 调试器的前端，只是一个内置的。

当然，还有更多选择......这三个只是我想到的前三个;-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T14:28:37.837

这个怎么样？

您可以尝试测试 Nodeclipse 版本 0.2.0 beta。

[http://www.tomotaro1065.com/nodeclipse/](http://www.tomotaro1065.com/nodeclipse/)

它将帮助您轻松调试节点应用程序。

> 生成快速项目
> 
> ```
> Select the [File]-[New]-[Project] menu.
> Select [Node]-[Express Project], and push [Next] button.
> Enter [Project name], and push [Finish] button. 
> ```
> 
> 调试
> 
> ```
> Open the JavaScript source files that you want to set breakpoints.
> Double-click on the ruler at the left end of the line you want to set a breakpoint.
> If you want to remove a breakpoint, double-click on the ruler again.
> Select the main source file of Node Application on the Project Explorer, 
> open the context menu by right-clicking, 
> select the [Debug As]-[Node Application] menu. 
> ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T14:12:27.470

用于[`node-inspector`](https://github.com/dannycoates/node-inspector)提供您正在寻找的节点调试环境。这是梦幻般的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T14:53:02.333

检查[WebStorm](http://www.jetbrains.com/webstorm/)。它是一个很棒的 IDE，你也可以直接运行你的 nodejs 代码，或者连接到已经运行的启用调试的节点进程。在这两种情况下，WebStorm 都提供了您正在寻找的东西：逐行跟踪程序执行并在每一行检查每个变量的状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-01T10:00:17.820

尝试使用 nodeunit npm 模块来测试 nodejs 服务器端代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-14T17:52:21.207

即使问题很老了，微软“Visual Studio Code”也有一个很棒的IDE，它是用Javascript（Typescript）开发的，它能够调试Node JS项目

查看此链接[https://code.visualstudio.com/docs/nodejs/nodejs-debugging](https://code.visualstudio.com/docs/nodejs/nodejs-debugging "节点 JS 调试")

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-01T15:26:34.960

**`node inspect`内置 CLI 分步调试**

花了一些时间，但在某个时候 Node 终于添加了内置调试：

```
node inspect main.js 
```

这使您处于程序的第一行。

导航：

*   `n`跳到下一行
*   `s`进入功能
*   `c`继续
*   `o`走出去
*   `h`得到帮助

为了查看变量或注入代码，您需要首先进入 REPL 模式：

```
repl 
```

然后您可以像在`node`交互式会话中一样运行命令，例如查看变量的值只需写下变量名：

```
myvar 
```

不得不一直输入这四个字符很尴尬`repl`，但我不知道有什么替代方法。

您还可以在 a之后将`debugger`语句添加到要在程序中中断的位置`c`：

```
const i = 1;
debugger;
i = 2; 
```

相关问题：[如何调试 Node.js 应用程序？](https://stackoverflow.com/questions/1911015/how-do-i-debug-node-js-applications)

在 Node.js v10.15.1、Ubuntu 19.10 中测试。

# asp.net - 在中继器中更改 DropDownList 的 SelectedIndex 会导致 DropDownList 的所有实例具有相同的 Selected Index

> ID：12641680
> 
> 赞同：1
> 
> 时间：2012-09-28T14:10:55.477
> 
> 标签：asp.net, vb.net

我有一个包含转发器的用户控件。中继器包含一些控件，包括一个带有 id 'ddlPallet' 的 dropDownList。转发器绑定到用户控件的 Page_Load 事件中的数据集。

我正在使用转发器的 ItemDataBound 事件来根据数据集中的值更改下拉列表的 SelectedValue。

我遇到的问题是，当页面呈现时，所有下拉列表的 selectedValue 都设置为指定的最后一个 selectedValue - 即如果数据集中有 8 行并且第 8 行是“N”，那么所有实例的选定索引'ddlPallet' 的 selectedValue 将具有 'N'

这是我的 ItemDataBound 代码：

```
Protected Sub rptCavities_ItemDataBound(sender As Object, e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rptCavities.ItemDataBound
    If e.Item.ItemType = ListItemType.Item Or e.Item.ItemType = ListItemType.AlternatingItem Then
        Dim ddl As DropDownList
        ddl = e.Item.FindControl("ddlPallet") 'get the dropdown
        ddl.Items.AddRange(Me._arrPallets) 'add items
        Dim drv As DataRowView = CType(e.Item.DataItem, DataRowView) 'get the data row being bound
        Dim sv As String = "" 'get the value of the 'pallet' column from the dataset
        If Trim(drv("Pallet").ToString()) <> "" Then
            sv = drv("Pallet").ToString()
        Else
            sv = "N"
        End If
        ddl.SelectedValue = sv 'set the selected value of the dropdown list for this item
        'debug
        System.Diagnostics.Debug.WriteLine("----")
        System.Diagnostics.Debug.WriteLine("Control ID: " & ddl.ID)
        System.Diagnostics.Debug.WriteLine("Control Client ID: " & ddl.ClientID)
        System.Diagnostics.Debug.WriteLine(ddl.SelectedIndex.ToString() & " - " & ddl.SelectedItem.ToString() & " - " & ddl.SelectedValue)
        System.Diagnostics.Debug.WriteLine("")
    End If
End Sub 
```

调试输出显示正在为每个项目/每个 dropDownList 设置适当的 SelectValue：

* * *

控制 ID：ddlPallet 控制客户端 ID：Cure1_rptCavities_ctl01_ddlPallet 4 - FL - FL

* * *

控制 ID：ddlPallet 控制客户端 ID：Cure1_rptCavities_ctl02_ddlPallet 3 - EP - EP

* * *

控制 ID：ddlPallet 控制客户端 ID：Cure1_rptCavities_ctl03_ddlPallet 0 - N - N

..ETC。

这让我发疯了。我假设我有某种范围错误导致最后设置的索引值应用于转发器中 dropDownList 的所有实例，但我没有运气弄清楚在哪里或为什么。如果我使用 "Text='<%#Container.DataItem("Pallet")%>'" 将相同的数据绑定到 ASCX 文件中的标签，则会显示正确的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:31:06.757

这可能是因为您在每种情况下都将相同的项目添加到下拉列表中，而不是将下拉列表绑定到源数据。这样，它们都共享一组共同的项目，如果您将 Selected = true 设置为一个项目，那么包含该项目的每个下拉列表都将是 true。

可能是一种有趣的技术，但可能不是您想要的。

# apache - Xampp、Apache 和 SSH 隧道

> ID：12641681
> 
> 赞同：1
> 
> 时间：2012-09-28T14:10:57.067
> 
> 标签：apache, ssh, xampp, tunnel

我正在使用 Xampp 在我的本地主机（Windows）上开发一个 PHP 应用程序。我需要从我的应用程序访问第三方 API，但我只能使用我们的在线服务器 IP 地址访问 API。如何使用 SSH 隧道通过我们的在线服务器将我的 Apache 请求重新路由到互联网？（我无法设置 VPN 连接）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:23:27.343

假设您的第三方 API 的 URL 位于：

```
192.168.200.100 on port 80 
```

而你的在线服务器IP是：

```
10.10.10.100 
```

要打开隧道，请运行以下命令：

```
ssh -L127.0.0.1:8888:192.168.200.100:80 10.10.10.100 
```

ssh 命令将手动将您连接到您的在线服务器并打开一个 SSH 隧道，您可以在以下位置引用该隧道：

```
127.0.0.1 on port 8888 
```

因此，在您的 PHP 应用程序中，不是直接连接到 192.168.200.100 的第三方服务器，而是使用本地 IP 和端口 (127.0.0.1:8888)。

# gcc - fortran 链接错误

> ID：12641684
> 
> 赞同：0
> 
> 时间：2012-09-28T14:11:34.017
> 
> 标签：gcc, linker, fortran, gfortran

我在使用 gfortan 编译器编译 fortran 程序时遇到问题。主程序位于 main.f 中。所以，我在控制台中写道：

```
gfortran D:\test\test.f 
```

但它向我展示了很多错误，例如：

```
 C:\Users\Efds~1\AppData\Local\Temp\cchFNGgc.o:test.f:<.test+0x3a>: undefined reference to '_gridw_'
 C:\Users\Efds~1\AppData\Local\Temp\cchFNGgc.o:test.f:<.test+0x3a>: undefined reference to '_gridz_'
 etc. 
```

我认为这是因为函数`gridw`等`gridz`位于其他 *.f 文件中。但我不知道如何将这些联系在一起。

此外，我尝试使用 Compaq Visual Fortran Complier，但它对我没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:21:40.917

将多个源文件编译和链接到一个可执行文件的基本命令是

```
gfortran -o executable source1.f source2.f source3.f 
```

注意`.f`您指定的任何文件都被命名为它所依赖的任何其他源文件的右侧。所有这些以及更多内容都在编译器的文档中得到了很好的介绍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T15:06:43.287

如上所述，您可以使用相同的命令编译多个文件，但这很不寻常。

您可能更喜欢首先编译为目标文件（“.o”）：

```
gfortran -c gridw.f
gfortran -c gridz.f 
```

然后编译程序

```
gfortran test.f grodw.o gridz.o 
```

如果你有很多文件要链接，构建一个库可能会很有趣：

```
ar cru mylib.a gridw.o gridz.o
gfortran test.f mylib.a 
```

如果您将库命名为 libSOMETHING.a，您可以简单地编写

```
gfortran test.f -lSOMETHING 
```

# iphone - iPhone - 在目标 c 问题中创建可变参数函数

> ID：12641688
> 
> 赞同：0
> 
> 时间：2012-09-28T14:11:38.700
> 
> 标签：iphone, objective-c, function, methods

我参考[了这个 SO Answer](https://stackoverflow.com/questions/4804674/how-to-create-variable-argument-methods-in-objective-c)在目标 C 中创建可变参数函数。我通过传递如下参数来测试您的代码：

```
[self logMessage:@"string: %@\n number: %@\n image: %@",
 @"asdf",
 [NSNumber numberWithInt:23],
 [UIImage imageNamed:@"local.png"]]; 
```

并使用 NSLog() 编辑代码；

```
- (void)logMessage:(NSString *)format, ... {

    va_list args;
    va_start(args, format);

    id arg = nil;
    int i = 1;
    NSLogv(format, args);
    while ((arg = va_arg(args,NSString *))) {

        NSLog(@"val: %d", i++);
        /// Do your thing with arg here
        //NSString *name = NSStringFromClass([arg class]);
        //NSLog(@"string: %@", name);
    }        
    va_end(args);
} 
```

但输出如下：

```
2012-09-28 19:34:45.271 SIMO[2384:c07] string: asdf
 number: 23
 image: <UIImage: 0x8151f80>
2012-09-28 19:34:45.273 SIMO[2384:c07] val: 1
2012-09-28 19:34:45.273 SIMO[2384:c07] val: 2
2012-09-28 19:34:45.274 SIMO[2384:c07] val: 3
2012-09-28 19:34:45.274 SIMO[2384:c07] val: 4
2012-09-28 19:34:45.274 SIMO[2384:c07] val: 5
2012-09-28 19:34:45.275 SIMO[2384:c07] val: 6
2012-09-28 19:34:45.275 SIMO[2384:c07] val: 7
2012-09-28 19:34:45.276 SIMO[2384:c07] val: 8 
```

这说明参数是 8，但我只通过了 3 (NSString, NSNumber, UIImage) 我无法理解这个概念.. 你能澄清一下吗 有人能澄清一下吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:20:05.753

`va_arg`不知道参数列表何时结束。您使用的方法期望参数列表以 终止`nil`，例如`+[NSArray arrayWithObjects:]`.

因此，要么更改您的调用以添加`nil`到参数列表的末尾，要么找到其他方法来了解参数何时结束（例如，对于 printf 克隆，您可能会从格式字符串本身知道格式参数的数量）。

# sms - kannel 不将消息转发到 URL

> ID：12641690
> 
> 赞同：0
> 
> 时间：2012-09-28T14:11:43.213
> 
> 标签：sms, kannel

我的 kannel.conf 是：

```
group = core
admin-port = X
smsbox-port = Y
admin-password = Z
log-file = "/usr/local/kannel/log/clientA/kannel.log"
log-level = 0
box-deny-ip = "*.*.*.*"
box-allow-ip = "127.0.0.1"
access-log = "/usr/local/kannel/log/clientA/Access.log"
store-type = file
store-file = "/usr/local/kannel/log/clientA/clientA.store"

###############################################################

group = smsc
smsc = smpp
smsc-id = clientA
host =A.B.C.D
port = 9081
throughput = 2
wait-ack = 600
smsc-username = myuser
smsc-password = mypass
keepalive=30
system-type =
transceiver-mode = 1
enquire-link-interval = 1200
source-addr-ton = 0
source-addr-npi = 1
dest-addr-ton = 1
dest-addr-npi = 1
max-pending-submits = 3

#################################################################

group = smsbox
smsbox-id = smsbox82
bearerbox-host = localhost
sendsms-port = portSend
global-sender = XXXXXXX
mo-recode = true
log-file = "/usr/local/kannel/log/clientA/smsbox.log"
log-level = 0
access-log = "/usr/local/kannel/log/clientA/Access.log"

###################################################################
group = sendsms-user
username = myu
password = myp
max-messages = 3
concatenation = true

##################################################################

group = sms-service
keyword = default
get-url = "http://localhost:80/insdb.php?sender=%p&receiver=%r&smsid=%I" 
```

我在端口 80 上运行 apache，并且单独调用时的 URL 在 DB 中插入消息，但是，当消息发送到 App 时，它永远不会到达 DB，并且我在日志中没有看到任何错误来解释这一点。

有什么想法我在哪里想念吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T20:45:30.503

如果您需要保存所有到达 kannel 的 SMS 消息，则需要将 sms-service 组添加到 kannel.conf 中，因此添加如下内容：

```
group = sms-service
keyword = default
get-url="http://127.0.0.1/save?sender=%p&text=%a&receiver=%P" 
```

这将导致，对于所有收到的消息，将执行 get-url，您的应用程序（apache 等）应该能够将消息详细信息保存到 DB。

您应该查看 kannel 文档以获取有关可用占位符的详细信息，我只使用了其中的一些（发送者、接收者、消息文本）。

BR，伊莎贝尔

# javascript - 测试 Javascript 函数的阻塞行为

> ID：12641691
> 
> 赞同：2
> 
> 时间：2012-09-28T14:11:44.833
> 
> 标签：javascript, testing

在 Javascript 中，我有两个版本的递归函数，一个同步运行，一个使用简单的调度来异步运行。给定某些输入，在这两种情况下，函数都应具有无限的执行路径。我需要为这些功能开发测试，特别是检查异步版本不会阻塞主线程的测试。

我已经有测试在不返回的情况下检查这些函数的输出回调行为，我只关心测试阻塞行为。我也可以将函数运行的时间限制为一些很长但有限的时间，以用于测试目的。我目前正在使用 QUnit，但可以切换到另一个测试框架。

如何测试不返回的异步函数不会阻塞？

## 编辑，澄清

这将是我正在使用的函数的一个简单示例：

```
function a()
{
    console.log("invoked");
    setTimeout(a, 1000);
}

a(); 
```

我故意在我的描述中滥用一些线程术语，因为我觉得它们最清楚地表达了问题。不阻塞主线程，我的意思是调用函数不会阻止其他逻辑的调度和执行。我希望函数本身将在主线程上执行，但我认为只要它被安排在将来执行，函数就会运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T00:00:40.237

单元测试基于单一责任原则和隔离（将被测对象与其依赖项分开）。

在这种情况下，您希望您的函数异步运行，但此行为不是由您的函数完成的，而是由“setTimeout”函数完成的，所以我认为您必须将您的函数与“setTimeout”隔离，因为它是您不依赖的依赖项想要测试，浏览器保证它会工作。

然后，由于我们相信“setTimeout”会执行异步逻辑，我们只能测试对“setTimeout”的函数调用，我们可以用另一个函数替换“window.setTimeout”，而我们必须始终在测试完成后恢复它.

```
function replaceSetTimeout() {
    var originalSetTimeout = window.setTimeout;
    var callCount = 0;

    window.setTimeout = function() {
        callCount++;
    };

    window.setTimeout.restore = function() {
        window.setTimeout = originalSetTimeout;
    };

    window.setTimeout.getCallCount = function() {
        return callCount;
    };
}

replaceSetTimeout();
asyncFunction();
assert(setTimeout.getCallCount() === 1);
setTimeout.restore(); 
```

我建议您使用[sinon.js](http://sinonjs.org/)，因为它提供了许多工具，例如函数式[间谍](http://sinonjs.org/docs/#spies)，而不是告诉您调用了多少次以及调用了哪些参数。

```
var originalSetTimeout = window.setTimeout;
window.setTimeout = sinon.spy();
asyncFunction();

// check called only once
assert(setTimeout.calledOnce);
// check the first argument was asyncFunction
assert(setTimeout.calledWith(asyncFunction)); 
```

Sinon 还提供了执行 setTimeout 替换但具有更多功能的[假计时器](http://sinonjs.org/docs/#clock)，例如将模拟“x”毫秒的 .tick(x) 方法，但在这种情况下，我认为它对您没有帮助。

**更新以回答问题编辑：**

1 - 您的函数无限执行，因此您无法在不中断执行的情况下对其进行测试，因此您必须在某处覆盖“setTimeout”。

2 - 您希望您的函数递归执行，允许在迭代之间执行其他代码？伟大的！但请理解**您的函数不能做到这一点，**您的函数只能调用 setTimeout 或 setInterval 并希望此函数按预期工作。你应该测试你的函数做了什么。

3 - 您想从 Javascript（沙盒环境）进行测试，而不是另一个 Javascript 代码使用并释放唯一的一个执行线程（与您用于测试的线程相同）。你真的认为这是一个简单的测试吗？

4 -**但最重要的一个**- 我不喜欢白盒，因为它将测试与依赖项结合在一起，如果您更改依赖项或将来如何调用它，您将不得不更改测试。DOM 函数不存在这个问题，DOM 函数将保持相同的接口多年，而现在，除了调用这两个函数之一，你没有其他方法可以做你想做的事，所以我不认为案例“白盒测试”是个坏主意。

我告诉你这个是因为我在测试 Promise 模式实现时遇到了与必须始终异步的相同问题，即使承诺已经实现，并且我已经使用测试引擎异步测试方式（使用回调和其他东西）对其进行了测试这是一团糟，测试随机失败，测试执行速度非常慢。然后我问了一位 TDD 专家，测试怎么这么难，他回答说我没有遵循**单一责任原则**，因为我试图测试我的 promise 实现和 setTimeout 行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T02:32:30.847

如果您从行为驱动测试的角度考虑它，那么“我的功能会阻塞吗？” 不是一个有用的问题。它肯定会阻塞，一个更好的问题可能是“它是否在不超过 50 毫秒内返回”。

你可以这样做：

```
test( "speed test", function() {
  var start = new Date();
  a();
  ok(new Date() - start < 50, "Passed!" );
}); 
```

这样做的问题是，如果有人做了一些愚蠢的事情，使你的功能无限期地阻塞，测试不会失败，它会挂起。

因为 JavaScript 是单线程的，所以没有办法解决这个问题。如果我过来并将您的功能更改为：

```
function a() {
    while(true) {
        console.log("invoked")
    }
} 
```

测试将挂起。

您可以通过稍微重构一些东西来使这种方式更难破坏。有两件不同的事情正在做。您的工作量和日程安排。将它们分开，您最终会得到以下函数：

```
function a() {
    // doWork
    var stopRunning = true;

    return stopRunning;
}

function doAsync(workFunc, scheduleFunc, timeout) {
    if (!workFunc()) {
       scheduleFunc(doAsync, [workFunc, scheduleFunc, timeout], timeout);
    }
}

function schedule(func, args, timeout) {
    setTimeout(function() {func.apply(window, args);}, timeout);
} 
```

现在您可以自由地单独测试所有内容。您可以为 doAsync 的测试提供一个模拟 workFunc 和 scheduleFunc 以验证它的行为是否符合预期，并且您可以测试您的函数 a() 而不必担心它是如何安排的。

傻瓜程序员仍然可以将无限循环放入函数 a() 中，但因为他们不必考虑如何运行更多的工作单元，所以它应该不太可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T17:17:15.563

要测试或证明无限执行的执行路径永远不会阻塞几乎是不可能的，因此您必须将问题拆分为多个部分。

您的路径基本上是`foo(foo(foo(foo(...etc...))))`，没关系`SetTimeout`实际上消除了递归。因此，您所要做的就是测试或证明您的 foo 没有阻塞（我现在告诉您，测试将比证明“稍微”容易一些，更多内容如下）

## 那么，功能是否`foo`阻塞？

说点数学，如果你想知道`f(f(...f(x)...))`总是有一个值，你实际上只需要证明`f(x)`任何可以返回的总是有一个`x`值`f`。如果你能确保它们的返回值是好的，你有多少递归并不重要。

这对您`foo`来说意味着您只需要证明`foo`不会阻止任何可能的输入值。请记住，在这种情况下，所有全局变量和闭包也是输入值。这意味着您必须对每次通话中使用的每个值进行全面检查。

要进行测试，您当然必须替换 SetTimeout，但这很简单，如果您用空函数 ( `function(){}`) 替换它，很容易证明该函数不会阻塞或以其他方式改变您的执行。然后你会

## 让事情变得更容易

考虑到我上面写的内容，这也意味着您必须确保您曾经使用的任何全局函数或变量都不会更改为您的函数中断到它中断的点。这实际上是相当困难的，但是您仍然可以通过确保始终使用相同的函数和值并且其他函数不能通过使用闭包来触及它们来使事情变得更容易。

```
function foo(n, setTimeout)
{
   var x = global_var;
   // sanity check n here
   function f()
   {
      setTimeout(f, n)
   }
   return f();
} 
```

*   这样，您只需在第一次执行时测试这些值。能够假设`Math.Pi`实际上是 Pi 而不是包含`"noodles"`. 非常好。
*   不要使用全局可变对象
*   打电话给那些你不能规避的人，`setTimeout`以确保他们不能阻止

    *   如果您需要返回值，事情会变得非常棘手，但有可能，考虑一下：

        ```
        function() {
          var x = 0;
          setTimeout(function(){x = insecure();}, 1); 
        } 
        ```

        你所要做的就是

        *   使用 x 下一次迭代
        *   x 的健全性检查值优先！
*   SetTimeout 是否阻塞？

    当然这取决于 setTimeout 是否阻塞。这很难证明，但更容易测试。您实际上无法证明它，因为它的实现取决于解释器。

    就我个人而言，我会假设 setTimeout 在其返回值被丢弃时表现得像一个空函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T04:19:17.537

根据所有答案，我想出了适用于我的案例的解决方案：

```
testAsync("Doesn't hang", function(){
    expect(1);

    var ranToLong = false;
    var last = new Date();
    var sched = setInterval(function(){
        var now = new Date();
        ranToLong = ranToLong || (now - last) >= 50;
        last = now;
    }, 0);

    // In this case, asyncRecursiveFunction runs for a long time and 
    // returns a single value in callback
    asyncRecursiveFunction(function callback(v){
        clearInterval(sched);
        var now = new Date();
        ranToLong = ranToLong || (now - last) >= 50;
        assert.equal(ranToLong, false);
        start();
    });
}); 
```

它通过查看另一个计划函数调用之间的时间来测试“asyncRecursiveFunction”在处理时是否挂起。

这真的很难看，并不适用于所有情况，但它似乎对我有用，因为我可以将我的函数限制为一些大型异步递归调用，因此它运行很长时间但不是无限时间。正如我在问题中提到的，我很高兴证明这种情况不会阻止。

顺便说一句，有问题的实际代码可以在[gen.js](http://github.com/mattbierner/gen.js)中找到。主要问题是异步减少生成器。它正确地异步返回了一个值，但在以前的版本中会因为同步的内部实现而停止。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-07T20:20:41.723

在 QUnit 中执行这种异步测试实际上是可能的，但在另一个 JavaScript 测试框架 Jasmine JS 中处理得更好。我将在这两个方面提供示例。

在 QUnit 中，您需要首先调用 stop() 函数来表示测试预计将异步运行，然后您应该使用包含您期望的函数调用 setTimeout 以及调用 start() 函数来完成该块. 这是一个例子：

```
test( "a test", function() {
    stop();
    asyncOp();
    setTimeout(function() {
        equals( asyncOp.result, "someExpectedValue" );
        start();
    }, 150 );
}); 
```

**编辑：**显然，您还可以使用整个 asyncTest 构造来简化此过程。看看：[http ://api.qunitjs.com/asyncTest/](http://api.qunitjs.com/asyncTest/)

在行为驱动开发 (BDD) 测试框架 Jasmine (http://pivotal.github.com/jasmine/) 中，有用于编写异步测试的内置方法。这是 Jasmine 中的异步测试示例：

```
describe('Some module', function() {

    it('should run asynchronously', function() {
        var isDone = false;
        runs(function() {
            // The first call to runs should trigger some async operation
            // that has a side-effect that can be tested for. In this case,
            // lets say that the doSomethingAsyncWithCallback function
            // does something asynchronously and then calls the passed callback
            doSomethingAsyncWithCallback(function() { isDone = true; });
        });

        waitsFor(function() {
            // The call to waits for is a polling function that will get called
            // periodically until either a condition is met (the function should return
            // a boolean testing for this condition) or the timeout expires.
            // The optional text is what error to display if the test fails.
            return isDone === true;
        }, "Should set isDone to true", 500);

        runs(function() {
            // The second call to runs should contain any assertions you need to make
            // after the async call is complete.
            expect(isDone).toBe(true);
        });
    });
}); 
```

**编辑：**此外，Jasmine 有几种内置方法可以伪造浏览器的 setTimeout 和 setInterval 函数，而无需在您的套件中进行可能依赖于此的任何其他测试。我会看看使用那些而不是手动覆盖 setTimeout/setInterval 函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-05T20:16:23.870

基本上，JavaScript 是单线程的，所以它*会*阻塞主线程。但 ：

*   我假设您正在使用`setTimesout`来安排您的功能，因此如果对该功能的调用不会花费太多时间（例如，少于 200 或 300 毫秒），用户不会注意到它。

*   如果您在该功能期间进行 DOM 操作（包括 Canvas 或 WebGL），那么您就完蛋了。但如果没有，您可以查看*Web Workers*，它可以生成保证不会阻塞 UI 的单独线程。

但无论如何，JavaScript 和主循环，这是一个棘手的问题，过去几个月一直困扰着我，所以你并不孤单！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-12T05:07:38.797

一旦你的函数返回（在为它的下一次运行设置超时之后），javascript 将查看下一个需要运行的东西并运行它。

据我所知，javascript 中的“主线程”只是一个响应事件的循环（例如脚本标签的 onload，它运行该标签的内容）。

基于上述两个条件，尽管有任何 setTimeouts，调用线程总是会运行到完成，并且这些超时将在调用线程没有任何东西可以运行之后开始。

我测试的方法是在调用 a() 之后立即运行以下函数

```
function looper(name,duration) {
    var start = (new Date()).getTime();
    var elapsed = 0;
    while (elapsed < duration) {
        elapsed = (new Date()).getTime() - start;
        console.log(name + ": " + elapsed);
    }        
} 
```

持续时间应设置为比 a() 中的 setTimeout 持续时间更长的时间段。预期的输出将是“looper”的输出，然后是重复调用 a() 的输出。

接下来要测试的是其他脚本标签是否能够在 a() 及其子调用执行时运行。

你可以这样做：

```
<script>
    a(); 
</script>
<script>
    looper('delay',500); // ie; less than the 1000 timeout in a();
</script>
<script>
    console.log('OK');
</script> 
```

尽管 a() 及其子项仍在执行，但您仍希望日志中出现“OK”。您还可以测试它的变体，例如 window.onload() 等。

最后，您要确保其他计时器事件也能正常工作。只需将 2 个调用延迟半秒并检查它们是否交错应该表明工作正常：

```
function b()
{
    console.log("invoked b")
    setTimeout(b, 1000);
}

a();
looper('wait',500);
b(); 
```

应该产生像这样的输出

```
invoked
invoked b
invoked
invoked b
invoked
invoked b 
```

希望这就是你要找的！

编辑以防您需要有关如何在 Qunit 中执行此操作的一些技术细节：

如果 Qunit 无法捕获 console.log 输出（我不确定），只需将这些字符串推送到数组或字符串中并在运行后检查。您可以在 test module() 设置中覆盖 console.log 并在拆卸时恢复它。我不确定 Qunit 是如何工作的，但可能必须删除“this”，并使用全局变量来存储 old_console_log 和 test_output

```
// in the setup
this.old_console_log = console.log;
this.test_output = [];
var self = this;
console.log = function(text) { self.test_output.push(text); }

// in the teardown
console.log = this.old_console_log; 
```

最后，您可以使用 stop() 和 start() 以便 Qunit 知道等待测试中的所有事件完成运行。

```
stop();
kickoff_async_test();
setTimeout(function(){
    // assertions
    start();
    },<expected duration of run>); 
```

# c - C中链表中的'addFirst'方法

> ID：12641692
> 
> 赞同：3
> 
> 时间：2012-09-28T14:11:45.520
> 
> 标签：c, pointers, linked-list, singly-linked-list

我有一个我创建的列表：

```
struct list_t {
   int value;
   struct list_t* next;
}; 
```

我的'addFirst'：

```
void addFirst(struct list_t* head,int value) {

    struct list_t* toAdd = (struct list_t*) malloc (sizeof (struct list_t));
    toAdd->value = value;

    toAdd->next = head;
    head = toAdd;
} 
```

问题是当我将新的“节点”添加到列表中时，它在函数中工作（使用 DDD 调试器查看），但是当我退出函数时，我的列表保持不变。

我知道这可以通过让我的方法返回 a`struct list_t*`而不是来完成`void`，也可以通过将指向 head 指针的指针作为参数 ( `struct list_t** PtoHead`) 传递，但我的问题是是否可以使用我的方法执行此操作（即返回`void`并有一个指向`head`作为参数的指针）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:13:02.323

你可以做到，但它会很丑。

如果将新元素链接为元素编号 2，并相应地移动数据，则可以用新元素替换旧元素，同时在其后添加新元素：

```
void addFirst(struct list_t* head, int value)
{
    struct list_t* toAdd = malloc(sizeof *toAdd);

    toAdd->value = head->value;
    head->value = value;
    toAdd->next = head->next;
    head->next = toAdd;
} 
```

这假设`head`不是 NULL，对于那种情况，我认为使用这个原型是不可能解决的。

我强烈建议不要这样做，这非常不直观。

# php - 教义和复合唯一键

> ID：12641698
> 
> 赞同：122
> 
> 时间：2012-09-28T14:11:52.993
> 
> 标签：php, mysql, doctrine-orm

我想在学说中做复合唯一键。这些是我的领域：

```
/**
 * @var string $videoDimension
 *
 * @Column(name="video_dimension", type="string", nullable=false)
 */
private $videoDimension;

/**
 * @var string $videoBitrate
 *
 * @Column(name="video_bitrate", type="string", nullable=false)
 */
private $videoBitrate; 
```

我怎样才能表明那些组合在一起是复合唯一键的学说？

* * *

## 回答 #1

> 赞同：250
> 
> 时间：2012-09-29T07:57:33.467

回答问题：

```
use Doctrine\ORM\Mapping\UniqueConstraint;

/**
 * Common\Model\Entity\VideoSettings
 *
 * @Table(name="video_settings", 
 *    uniqueConstraints={
 *        @UniqueConstraint(name="video_unique", 
 *            columns={"video_dimension", "video_bitrate"})
 *    }
 * )
 * @Entity
 */ 
```

见[@UniqueConstraint](https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/annotations-reference.html#annref_uniqueconstraint)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2015-11-12T10:14:15.867

我发现它只对 ORM 更冗长`use`，然后`ORM`在注释中添加前缀。另请注意，您可以将注释分成几行以使其更具可读性，特别是如果您要提及多个项目（下例中的索引）。

```
use Doctrine\ORM\Mapping as ORM;

/**
 * VideoSettings
 *
 * @ORM\Cache(usage="NONSTRICT_READ_WRITE")
 * @ORM\Entity(repositoryClass="AppBundle\Repository\VideoSettingsRepository")
 * @ORM\Table(name="emails", uniqueConstraints={
 *      @ORM\UniqueConstraint(name="dimension_bitrate", columns={"video_dimension", "video_bitrate"})
 * }, indexes={
 *      @ORM\Index(name="name", columns={"name"})
 * })
 */
class VideoSettings 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2021-09-03T17:20:49.823

如果有人想使用**PHP 8 属性**而不是 Doctrine 注释：

```
use Doctrine\ORM\Mapping as ORM;

#[ORM\Entity]
#[ORM\UniqueConstraint(
  name: 'video_unique_idx',
  columns: ['video_dimension', 'video_bitrate']
)] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-08T18:37:25.347

我知道这是一个老问题，但我在寻找一种创建复合 PK 的方法时遇到了它，并认为它可以使用一些更新。

如果您需要的是复合主键，事情实际上要简单得多。（当然，这保证了唯一性）Doctrine 文档包含一些很好的例子，通过这个 url：[http ://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/composite-primary-keys.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/composite-primary-keys.html)

所以原始示例可能如下所示：

```
/**
 * @var string $videoDimension
 *
 * @ORM\Id @ORM\Column(type="string")
 */
private $videoDimension;

/**
 * @var string $videoBitrate
 *
 * @ORM\Id @ORM\Column(type="string")
 */
private $videoBitrate; 
```

这里有几点注意事项：

1.  列“名称”被省略，因为 Doctrine 能够根据属性名称猜测它
2.  由于`videoDimension`和`videoBitrate`都是 PK 的一部分 - 无需指定`nullable = false`
3.  如果需要 - Composite PK 可能由外键组成，因此请随意添加一些关系映射

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-29T09:51:50.320

XML 版本：

```
<unique-constraints>
    <unique-constraint columns="column1,column2" name="give_some_explicit_name" />
</unique-constraints> 
```

文档中的更多详细信息：
https ://www.doctrine-project.org/projects/doctrine-orm/en/2.7/reference/xml-mapping.html#defining-indexes-or-unique-constraints

# apache-flex - Adobe Flex - 列表组件 - 如何根据允许的最大选择数允许多个选择 (allowMultipleSelection)

> ID：12641699
> 
> 赞同：2
> 
> 时间：2012-09-28T14:11:55.523
> 
> 标签：apache-flex, list, actionscript, datagrid, flash-builder

在列表组件中，如何允许多项选择，但允许的最大选择数基于预定义的数字？

到目前为止我得到的是......我首先定义了最大选择数：

私有变量 numberOfYearsCanSelect:int = 3;

我在列表组件中设置了 allowMultipleSelection = true。

在更改列表组件时，我添加了逻辑以查看用户选择的内容是否超过了他们允许选择的内容，如果是，我将 selectedItems 的长度设置为他们可以选择的最大数量：

```
 if (event.currentTarget.selectedIndices.length > numberOfYearsCanSelect)
            {
                var arr:Vector.<Object>=event.currentTarget.selectedItems;
                arr.length=numberOfYearsCanSelect;
                event.currentTarget.selectedItems=arr;
            } 
```

问题在于，由于某种原因，当我设置 selectedItems 时列表没有更新。它允许您选择您想要的数量。

我想要发生的是，当用户选择的数量超过允许的数量时，我们只选择那个数字，其余的不选择。

也许我需要在视图上进行某种列表刷新以使其工作，或者我应该通过扩展列表类并覆盖某些方法来创建自定义列表？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:59:23.800

在我看来，子类`List`化将是最简单的解决方案。然后，您所要做的就是确保当建议的选定项目的数量超过最大值时永远不会提交用户选择。

这样的事情应该可以解决问题：

```
use namespace mx_internal;

public class LimitedList extends List {

    public var maxSelectedItems:int = 3;

    override public function initialize():void {
        super.initialize();
        allowMultipleSelection = true;
    }

    override mx_internal function setSelectedIndices(
            value:Vector.<int>,
            dispatchChangeEvent:Boolean = false,
            changeCaret:Boolean = true):void
    {
        if (!value || value.length <= maxSelectedItems)
            super.setSelectedIndices(value, dispatchChangeEvent, changeCaret);
    }

} 
```

当然，需要做一些调整才能使其成为完全可重用的组件，但您可以将其用作起点（或一次性）。

# asp.net-mvc-4 - Web API 获取 Http 500 错误

> ID：12641702
> 
> 赞同：2
> 
> 时间：2012-09-28T14:12:11.870
> 
> 标签：asp.net-mvc-4, asp.net-web-api

这是我的 MVC 控制器，一切都很好：

```
 private UnitOfWork UOW;
    public InventoryController()
    {
        UOW = new UnitOfWork();
    }

    // GET: /Inventory/
    public ActionResult Index()
    {
        var products = UOW.ProductRepository.GetAll().ToList();
        return View(products);
    } 
```

API 控制器中的相同方法调用给了我一个 Http 500 错误：

```
 private UnitOfWork _unitOfWork;
    public TestController()
    {
        _unitOfWork = new UnitOfWork();
    }

    public IEnumerable<Product> Get()
    {
        var products = _unitOfWork.ProductRepository.GetAll().ToList();
        return products;
    } 
```

调试表明，两个控制器的 UOW 调用中确实都返回了数据。然后我在 Global 中添加了一个客户配置：

```
 public static void CustomizeConfig(HttpConfiguration config)
    {
        config.Formatters.Remove(config.Formatters.XmlFormatter);
        var json = config.Formatters.JsonFormatter;
        json.SerializerSettings.ContractResolver = new CamelCasePropertyNamesContractResolver();
    } 
```

我仍然只在 API 控制器中收到 Http 500，不知道为什么。有任何想法吗？

**更新：**

似乎使用延迟加载导致了问题。当我将关联属性设置为非虚拟时，测试 API 提供了必要的 JSON 字符串。然而，在我包含 Vendor 类之前，我只有 VendorId。我真的很想包括相关的类。有任何想法吗？我知道那里有很多聪明人。任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:34:12.027

**问题解决了：**

毕竟问题不在于延迟加载。问题是，虽然我在产品中正确地与供应商建立了关联，但我在供应商中也有一系列产品，这可能导致了一些循环：

```
public class Product 
{
    public int Id { get; set; }
    public string Name { get; set; }

    public int VendorId { get; set; }
    public virtual Vendor Vendor { get; set; }
}

public class Vendor 
{
    public int Id { get; set; }
    //public Vendor()
    //{
    //    Products = new List<Product>();
    //}

    public string CompanyName { get; set; }
  //  public ICollection<Product> Products { get; set; }
} 
```

在 Vendors 中省略集合并在 Products 中恢复虚拟就可以了。

```
 "vendor": {
                        "id": 4,
                        "companyName": "Vendor 3"
                    },
                    "id": 1,
                    "name": "Product 1",
                    "vendorId": 4
                },
                {
                    "vendor": {
                        "id": 2,
                        "companyName": "Vendor 4"
                    },
                    "id": 2,
                    "name": "Product 2",
                    "vendorId": 2
                },
                {
                    "vendor": {
                        "id": 3,
                        "companyName": "Vendor 2"
                    },
                    "id": 3,
                    "name": "Product 3",
                    "vendorId": 3
                },
                {
                    "vendor": {
                        "id": 1,
                        "companyName": "Vendor 1"
                    },
                    "id": 4,
                    "name": "Product 4",
                    "vendorId": 1
                }] 
```

# vba - 如何从 Outlook 的“收件人”字段中提取电子邮件地址？

> ID：12641704
> 
> 赞同：13
> 
> 时间：2012-09-28T14:12:17.510
> 
> 标签：vba, email, outlook, text-files

我在某种程度上一直在使用 VBA，使用以下代码：

```
Sub ExtractEmail()
Dim OlApp As Outlook.Application
Dim Mailobject As Object
Dim Email As String
Dim NS As NameSpace
Dim Folder As MAPIFolder
Set OlApp = CreateObject("Outlook.Application")
' Setup Namespace
Set NS = ThisOutlookSession.Session
' Display select folder dialog
Set Folder = NS.PickFolder
' Create Text File
Set fs = CreateObject("Scripting.FileSystemObject")
Set a = fs.CreateTextFile("c:\mydocuments\emailss.txt", True)
' loop to read email address from mail items.
For Each Mailobject In Folder.Items
   Email = Mailobject.To
   a.WriteLine (Email)
Next
Set OlApp = Nothing
Set Mailobject = Nothing
a.Close
End Sub 
```

但是，这将输出作为电子邮件地址的名称，而不是带有**`"something@this.domain"`**.

是否有邮件对象的属性允许从**`'To'`**文本框中写入电子邮件地址而不是名称。

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-28T14:42:24.183

查看您的邮件项目的收件人集合对象，它应该允许您获取地址：http: [//msdn.microsoft.com/en-us/library/office/ff868695.aspx](http://msdn.microsoft.com/en-us/library/office/ff868695.aspx)

* * *

*2017 年 8 月 10 日更新*

回顾这个答案，我意识到我做了一件坏事，只链接某个地方而不提供更多信息。

下面是来自上述 MSDN 链接的代码片段，展示了如何使用 Recipients 对象获取电子邮件地址（片段在 VBA 中）：

```
Sub GetSMTPAddressForRecipients(mail As Outlook.MailItem) 
    Dim recips As Outlook.Recipients 
    Dim recip As Outlook.Recipient 
    Dim pa As Outlook.PropertyAccessor 
    Const PR_SMTP_ADDRESS As String = _ 
        "http://schemas.microsoft.com/mapi/proptag/0x39FE001E" 
    Set recips = mail.Recipients 
    For Each recip In recips 
        Set pa = recip.PropertyAccessor 
        Debug.Print recip.name &; " SMTP=" _ 
           &; pa.GetProperty(PR_SMTP_ADDRESS) 
    Next 
End Sub 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-08-20T22:39:43.547

看起来，对于组织外部的电子邮件地址，SMTP 地址隐藏在 中`emailObject.Recipients(i).Address`，尽管它似乎不允许您区分 To/CC/BCC。

Microsoft 代码给了我一个错误，一些调查显示架构页面不再可用。我想要一个以分号分隔的电子邮件地址列表，这些地址要么位于我的 Exchange 组织内，要么位于其外部。将它与另一个 S/O 答案相结合，将公司内部电子邮件显示名称转换为 SMTP 名称，就可以解决问题。

```
Function getRecepientEmailAddress(eml As Variant)
    Set out = CreateObject("System.Collections.Arraylist") ' a JavaScript-y array

    For Each emlAddr In eml.Recipients
        If Left(emlAddr.Address, 1) = "/" Then
            ' it's an Exchange email address... resolve it to an SMTP email address
            out.Add ResolveDisplayNameToSMTP(emlAddr)
        Else
            out.Add emlAddr.Address
        End If
    Next
    getRecepientEmailAddres = Join(out.ToArray(), ";")
End Function 
```

如果电子邮件在您的组织内部，您需要将其转换为 SMTP 电子邮件地址。[我从另一个 StackOverflow 答案](https://stackoverflow.com/questions/31161726/creating-a-check-names-button-in-excel)中发现这个函数很有帮助：

```
Function ResolveDisplayNameToSMTP(sFromName) As String
    ' takes a Display Name (i.e. "James Smith") and turns it into an email address (james.smith@myco.com)
    ' necessary because the Outlook address is a long, convoluted string when the email is going to someone in the organization. 
    ' source:  https://stackoverflow.com/questions/31161726/creating-a-check-names-button-in-excel

    Dim OLApp As Object 'Outlook.Application
    Dim oRecip As Object 'Outlook.Recipient
    Dim oEU As Object 'Outlook.ExchangeUser
    Dim oEDL As Object 'Outlook.ExchangeDistributionList

    Set OLApp = CreateObject("Outlook.Application")
    Set oRecip = OLApp.Session.CreateRecipient(sFromName)
    oRecip.Resolve
    If oRecip.Resolved Then
        Select Case oRecip.AddressEntry.AddressEntryUserType
            Case 0, 5 'olExchangeUserAddressEntry & olExchangeRemoteUserAddressEntry
                Set oEU = oRecip.AddressEntry.GetExchangeUser
                If Not (oEU Is Nothing) Then
                    ResolveDisplayNameToSMTP = oEU.PrimarySmtpAddress
                End If
            Case 10, 30 'olOutlookContactAddressEntry & 'olSmtpAddressEntry
                    ResolveDisplayNameToSMTP = oRecip.AddressEntry.Address
        End Select
    End If
End Function 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-06-21T19:32:34.583

上面的答案对我不起作用。我认为它们仅在收件人在地址簿中时才起作用。以下代码还能够从组织外部查找电子邮件地址。此外，它还区分了 to/cc/bcc

```
 Dim olRecipient As Outlook.Recipient
    Dim strToEmails, strCcEmails, strBCcEmails As String

    For Each olRecipient In item.Recipients

        Dim mail As String
        If olRecipient.AddressEntry Is Nothing Then
            mail = olRecipient.Address
        ElseIf olRecipient.AddressEntry.GetExchangeUser Is Nothing Then
            mail = olRecipient.Address
        Else
            mail = olRecipient.AddressEntry.GetExchangeUser.PrimarySmtpAddress
        End If

        Debug.Print "resolved", olRecipient.Name, mail

        If olRecipient.Type = Outlook.OlMailRecipientType.olTo Then
            strToEmails = strToEmails + mail & ";"
        ElseIf olRecipient.Type = Outlook.OlMailRecipientType.olCC Then
            strCcEmails = strCcEmails + mail & ";"
        ElseIf olRecipient.Type = Outlook.OlMailRecipientType.olBCC Then
            strBCcEmails = strBCcEmails + mail & ";"
        End If

    Next
    Debug.Print strToEmails
    Debug.Print strCcEmails
    Debug.Print strBCcEmails 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-03-04T23:19:27.983

另一种代码替代方案（最初基于@andreasDL 的回答）应该可以使用......

> 将 a 传递`MailItem`给`EmailAddressInfo`函数以从消息中获取 Sender、To 和 CC 字段的数组

```
Private Const olOriginator As Long = 0, olTo As Long = 1, olCC As Long = 2, olBCC As Long = 3
'BCC addresses are not included within received messages

Function PrintEmailAddresses(olItem As MailItem)
    If olItem.Class <> olMail Then Exit Function

    Dim Arr As Variant: Arr = EmailAddressInfo(olItem)
    Debug.Print "Sender: " & Arr(olOriginator)
    Debug.Print "To Address: " & Arr(olTo)
    Debug.Print "CC Address: " & Arr(olCC)
End Function

Private Function EmailAddressInfo(olItem As MailItem) As Variant
    If olItem.Class <> olMail Then Exit Function

On Error GoTo ExitFunction

    Dim olRecipient As Outlook.Recipient
    Dim olEU As Outlook.ExchangeUser
    Dim olEDL As Outlook.ExchangeDistributionList
    Dim ToAddress, CCAddress, Originator, email As String

    With olItem
        Select Case UCase(.SenderEmailType)
            Case "SMTP": Originator = .SenderEmailAddress
            Case Else
                Set olEU = .Sender.GetExchangeUser
                If Not olEU Is Nothing Then Originator = olEU.PrimarySmtpAddress
        End Select
    End With

    For Each olRecipient In olItem.Recipients
       With olRecipient
            Select Case .AddressEntry.AddressEntryUserType
                Case olSmtpAddressEntry 'OlAddressEntryUserType.
                    email = .Address
                Case olExchangeDistributionListAddressEntry, olOutlookDistributionListAddressEntry
                    Set olEDL = .AddressEntry.GetExchangeDistributionList
                    email = IIf(Not olEDL Is Nothing, olEDL.PrimarySmtpAddress, "")
                Case Else
                    Set olEU = .AddressEntry.GetExchangeUser
                    email = IIf(Not olEU Is Nothing, olEU.PrimarySmtpAddress, "")
            End Select
            If email <> "" Then
                Select Case .Type
                    Case olTo: ToAddress = ToAddress & email & ";"
                    Case olCC: CCAddress = CCAddress & email & ";"
                End Select
            End If
        End With
    Next
    EmailAddressInfo = Array(Originator, ToAddress, CCAddress)
ExitFunction:
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-28T03:37:26.607

这就是 Outlook 2019 对我有用的方法。使用您的内部域名。可能还需要一些调整 - 没有经过大量测试。将代码放在 ThisOutlookSession 模块中。（已于 2020 年 7 月 31 日更新以处理 Exchange 分发列表。）

```
Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)
Dim xMailItem As Outlook.MailItem
Dim xRecipients As Outlook.Recipients
Dim OutRec As Outlook.Recipient
Dim OutTI As Outlook.TaskItem
Dim i As Long
Dim j As Long
Dim xOKCancel As Integer
Dim sMsg As String
Dim oMembers As AddressEntries
Dim oMember As AddressEntry
Dim sDomains As String
Dim sTemp As String

On Error Resume Next
If Item.Class <> olMail Then GoTo ExitCode
sDomains = "@test1.com @test2.com"
Set xMailItem = Item
Set xRecipients = xMailItem.Recipients

'Loop through email recipients to get email addresses
For i = xRecipients.Count To 1 Step -1
    'If we have a text address entry in the email
    If InStr(xRecipients.Item(i).AddressEntry, "@") > 0 Then
        sTemp = xRecipients.Item(i).AddressEntry
        If InStrRev(sDomains, LCase(Mid(sTemp, InStr(sTemp, "@"), 254))) <= 0 Then
            sMsg = sMsg & sTemp & vbCrLf
        End If
    Else
        Select Case xRecipients.Item(i).AddressEntry.DisplayType
            Case Is = olDistList
                Set oMembers = xRecipients.Item(i).AddressEntry.Members
                For j = oMembers.Count To 1 Step -1
                    Set oMember = oMembers.Item(j)
                    sTemp = oMember.GetExchangeUser.PrimarySmtpAddress
                    If InStrRev(sDomains, LCase(Mid(sTemp, InStr(sTemp, "@"), 254))) <= 0 Then
                        sMsg = sMsg & sTemp & vbCrLf
                    End If
                    Set oMember = Nothing
                Next j
                Set oMembers = Nothing
            Case Is = olUser
                Set OutTI = Application.CreateItem(3)
                OutTI.Assign
                Set OutRec = OutTI.Recipients.Add(xRecipients.Item(i).AddressEntry)
                OutRec.Resolve
                If OutRec.Resolved Then
                    sTemp = OutRec.AddressEntry.GetExchangeUser.PrimarySmtpAddress
                    If InStrRev(sDomains, LCase(Mid(sTemp, InStr(sTemp, "@"), 254))) <= 0 Then
                         sMsg = sMsg & sTemp & vbCrLf
                    End If
                End If
                Set OutTI = Nothing
                Set OutRec = Nothing
            Case Else
                MsgBox "Unaccomodated AddressEntry.DisplayType."
                GoTo ExitCode
        End Select
    End If
Next i

'Display user message
If Len(sMsg) > 0 Then
    sMsg = "This email is addressed to the following external Recipients:" & vbCrLf & vbCrLf & sMsg
    xOKCancel = MsgBox(sMsg, vbOKCancel + vbQuestion, "Warning")
    If xOKCancel = vbCancel Then Cancel = True
End If

End Sub 
```

# asp.net-mvc-3 - 如何在 MVC3 中构建复合 UI？

> ID：12641705
> 
> 赞同：3
> 
> 时间：2012-09-28T14:12:17.877
> 
> 标签：asp.net-mvc-3, partial-views, bounded-contexts

我了解如何使用部分视图，并且了解 Ajax.ActionLink 和 Ajax.BeginForm 如何在视图中设置它们。我假设每个局部视图都有自己的控制器。我在这里考虑有界上下文，因为在每个局部视图中都可以通过自己的控制器与自己的有界上下文对话

我想我缺少的部分是：

1.  如何将部分视图包含在“主视图”（或持有视图）中，并让这些部分视图中的每一个独立发布到单独的控制器操作，然后返回以刷新部分视图而不加载“主视图”或持有视图.
2.  “主”视图或持有视图仍然需要有自己的控制器，我想阻止主控制器重新加载其视图，并让主控制器的操作方法生成的视图持有对这两个部分的引用意见。

我似乎可以采取两种方法，一种是使用“Ajax”。MVC3 的功能，另一个是直接使用 jQuery 并从客户端手动处理所有这些交互。

我正在尝试做的事情是两种方式，还是一种方式“更适合”这种类型的复合 ui 构造？

到目前为止，我所看到的只是复合 ui 构造的简单示例，例如通过 Ajax.ActionLink 刷新页面上的单个链接的链接，或者编写为 Ajax.BeginForm 的表单，该表单使用来自部分观点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T16:32:24.850

好的，所以我终于有了一些我认为正确的工作代码。这是我一起去的。我有两个简单的“实体”；客户和计费客户。它们实际上是在单独的“有界上下文”中，并且出于演示目的，这些类非常简单。

```
public class Customer
{ 
    public Guid CustomerId { get; set; }
    public string Name { get; set; }
}

public class BillingCustomer
{
    public Guid CustomerId { get; set; }
    public bool IsOverdueForPayment { get; set; }
} 
```

请注意，这两个类都引用了 CustomerId，为了这个演示，它是一个 GUID。

我从一个简单的 HomeController 开始，它构建了一个 ViewModel 将被 Index.cshtml 文件使用：

```
public ActionResult Index()
{
    var customer = new Customer {
        CustomerId = Guid.Empty, 
        Name = "Mike McCarthy" };

    var billingCustomer = new BillingCustomer { 
        CustomerId = Guid.Empty, 
        IsOverdueForPayment = true };

    var compositeViewModel = new CompositeViewModel {
        Customer = customer, 
        BillingCustomer = billingCustomer };

    return View(compositeViewModel);
} 
```

CompositeViewModel 类只是一个愚蠢的 DTO，每个域实体都有一个属性，因为我将在我的 Index.cshtml 文件中调用的局部视图每个都需要将它们各自的域模型传递到局部视图中：

```
public class CompositeViewModel
{
    public BillingCustomer BillingCustomer { get; set; }
    public Customer Customer { get; set; }
} 
```

这是我生成的 Index.cshtml 文件，它使用 HomeController 上的 Index 方法

```
@model CompositeViews.ViewModels.CompositeViewModel

<h2>Index - @DateTime.Now.ToString()</h2>

<div id="customerDiv">
    @{Html.RenderPartial("_Customer", Model.Customer);}
</div>

<p></p>

<div id="billingCustomerDiv">
    @Html.Partial("_BillingCustomer", Model.BillingCustomer)
</div> 
```

这里有几点需要注意：

1.  视图正在使用 CompositeViews.ViewModels.CompositeViewModel ViewModel
2.  Html.RenderPartial 用于渲染每个实体的局部视图，并传入适当的实体。小心 Html.Partial 调用的语法！

所以，这里是 _Customer 部分视图：

```
@model CompositeViews.Models.Customer

@using (Ajax.BeginForm("Edit", "Customer", new AjaxOptions { 
    HttpMethod = "POST", 
    InsertionMode = InsertionMode.Replace, 
    UpdateTargetId = "customerDiv" }))
{
    <fieldset>
        <legend>Customer</legend>

        @Html.HiddenFor(model => model.CustomerId)

        <div class="editor-label">
            @Html.LabelFor(model => model.Name)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
        </div>

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
} 
```

这里的重要部分是 Ajax.BeginForm 调用。请注意，它显式调用了 CustomerController 的 Edit ActionMethod。另请注意，UpdateTargetId 设置为“customerDiv”。这个 div 不在局部视图中，而是在“父”视图 Index.cshtml 中。

下面是 _BillingCustomer 视图

```
@model CompositeViews.Models.BillingCustomer

@using (Ajax.BeginForm("Edit", "BillingCustomer", new AjaxOptions { 
    HttpMethod = "POST", 
    InsertionMode = InsertionMode.Replace, 
    UpdateTargetId = "billingCustomerDiv" }))
{
<fieldset>
    <legend>BillingCustomer</legend>

    @Html.HiddenFor(model => model.CustomerId)

    <div class="editor-label">
        @Html.LabelFor(model => model.IsOverdueForPayment)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.IsOverdueForPayment)
        @Html.ValidationMessageFor(model => model.IsOverdueForPayment)
    </div>

    <p>
        <input type="submit" value="Save" />
    </p>
</fieldset>
} 
```

再次注意，UpdateTargetId 设置为 billingCustomerDiv。此 div 位于 Index.cshtml 文件中，而不是此部分视图文件中。

所以，我们唯一还没有看到的是 CustomerController 和 BillingCustomerController 上的 Edit ActionResult。这是客户控制器

```
public class CustomerController : Controller
{
    [HttpGet]
    public PartialViewResult Edit(Guid customerId)
    {
        var model = new Customer {
            CustomerId = Guid.Empty, 
            Name = "Mike McCarthy"};

        return PartialView("_Customer", model);
    }

    [HttpPost]
    public ActionResult Edit(Customer customer)
    {
        return PartialView("_Customer", customer);
    }
} 
```

在这个控制器中没有什么真正“发生”，因为帖子直接涉及构建复合 UI。请注意我们如何通过“PartialView”返回并指定要使用的局部视图的名称，以及视图需要呈现的所需模型。

这是 BillingCustomerController

```
public class BillingCustomerController : Controller
{
    [HttpGet]
    public PartialViewResult Edit(Guid customerId)
    {
        var model = new BillingCustomer {
            CustomerId = Guid.Empty, 
            IsOverdueForPayment = true };

        return PartialView("_BillingCustomer", model);
    }

    [HttpPost]
    public PartialViewResult Edit(BillingCustomer billingCustomer)
    {
        return PartialView("_BillingCustomer", billingCustomer);
    }
} 
```

同样，与 CustomerController 相同，只是这个控制器正在处理 BillingCustomer 实体。

现在，当我加载 HomeController 的 Index ActionResult 时，我得到一个如下所示的屏幕：

![复合界面](../Images/75cf7f0ebcd4046ac02b82ec92eb8150.png)

每个保存按钮都会对控制器进行异步回发，部分视图需要更新并与之对话以获取数据，所有这些都不会导致整个页面的定期回发。点击任一保存按钮时，您可以看到 DateTime 戳不会改变。

所以，这就是我如何使用局部视图构建我的第一个复合视图。由于我对 MVC3 还是很陌生，我仍然可能会搞砸一些事情，或者做一些比它需要的更难的事情，但这就是我让它工作的方式。

# spring - JPA 关系更改未在 PreUpdate 回调中更新

> ID：12641706
> 
> 赞同：0
> 
> 时间：2012-09-28T14:12:19.217
> 
> 标签：spring, jpa, eclipselink, aspectj

在我当前的项目中，我有一个可以发布到其他系统的实体。为了跟踪出版物，实体有一个称为“出版物”的关系。我正在使用 Eclipselink。

这个实体 bean 也有一个“PreUpdate”注解的方法。

为了能够使其他系统数据保持最新，我创建了一个围绕 PreUpdate 方法的调用执行的 Aspect。根据更改了哪些属性，我需要删除一些出版物。一切正常。

我遇到的问题是门户发布组件正确发送删除命令并从实体“发布”列表中删除发布。我什至可以在变更集中看到 JPA 注意到“publications”属性发生了变化。刷新事务后，缓存实体正确地不再具有已删除的发布。不幸的是，数据库仍然存在，当系统重新启动或再次从数据库加载实体时，发布元数据再次出现。

我几乎什么都试过了。我什至设法从 Aspect 中的 JPA ChangeSet 中获取已删除的实例，并尝试使用 entityManager 手动删除它们，但实际上没有任何效果。我似乎无法删除这些关系实体。目前我正在考虑使用 JDBC 来删除它们，但这只是我最后的措施。

```
@Transactional
@Around("execution(* de.cware.services.truck.model.Truck.jpaPreUpdate(..))")
public Object truckPreUpdate(final ProceedingJoinPoint pjp) throws Throwable {
    if (alreadyExecutingMarker.get() != Boolean.TRUE) {
        alreadyExecutingMarker.set(Boolean.TRUE);

        final Truck truck = (Truck) pjp.getTarget();

        final JpaEntityManager jpaEntityManager = (JpaEntityManager) entityManager.getDelegate();
        final UnitOfWorkChangeSet changeSet = jpaEntityManager.getUnitOfWork().getCurrentChanges();
        final ObjectChangeSet objectChangeSet = changeSet.getObjectChangeSetForClone(truck);

        if (log.isDebugEnabled()) {
            log.debug("--------------------- Truck pre update check (" + truck.getId() + ") ---------------------");
        }

        ////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // If the truck date has changed, revoke all publication copies.
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////

        final ChangeRecord truckFreeDate = objectChangeSet.getChangesForAttributeNamed("lkwFreiDatum");
        if (truckFreeDate != null) {
            if (log.isDebugEnabled()) {
                log.debug("The date 'truckFreeDate' of truck with id '" + truck.getId() + "' has changed. " +
                        "Revoking all publications that are not marked as main applications");
            }

            for (final String portal : truck.getPublishedPortals()) {
                if (log.isDebugEnabled()) {
                    log.debug("- Revoking publications of copies to portal: " + portal);
                }

                portalService.deleteCopies(truck, portal);

                // Get any deleted portal references and use the entityManager to finally delete them.
                changeSet = jpaEntityManager.getUnitOfWork().getCurrentChanges();
                objectChangeSet = changeSet.getObjectChangeSetForClone(truck);
                final ChangeRecord publicationChanges = objectChangeSet.getChangesForAttributeNamed("publications");
                if (publicationChanges != null) {
                    if (publicationChanges instanceof CollectionChangeRecord) {
                        final CollectionChangeRecord collectionChanges =
                                (CollectionChangeRecord) publicationChanges;
                        @SuppressWarnings("unchecked")
                        final Collection<ObjectChangeSet> removedPublications =
                                (Collection<ObjectChangeSet>)
                                        collectionChanges.getRemoveObjectList().values();
                        for (final ObjectChangeSet removedPublication : removedPublications) {
                            final TruckPublication publication = (TruckPublication) ((org.eclipse.persistence.internal.sessions.ObjectChangeSet) removedPublication).getUnitOfWorkClone();
                            entityManager.remove(publication);
                        }
                    }
                }
            }
        }
    }
} 
```

克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T13:35:47.037

问题是在提交过程中会引发 PreUpdate，此时已经计算了更改集，并且已经计算了要删除的对象集。

理想情况下，您将在应用程序逻辑中执行类似的操作，而不是通过持久性事件。

您可以尝试直接从您的事件中执行 DeleteObjectQuery（而不是使用 em.remove()），这可能有效，但通常最好在您的应用程序中执行此逻辑。

jpaEntityManager.getUnitOfWork().deleteObject(object);

另请注意，getCurrentChanges() 计算更改，在 PreUpdate 事件中已经计算更改，因此您应该能够使用 getUnitOfWorkChangeSet()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-12T19:07:58.637

我有一个类似的问题，我有一个类及其子级，当我从父级中删除子级时，它们已从数据库中删除，然后我使用 JPA/EclipseLink在父级（ ***CascadeType.ALL*** ）上使用合并附加新子级，然后孩子们没有在数据库上创建，而是在持久性电机（JPA）中创建。我通过以下方式解决此问题：

1-我在*persistence.xml*文件中将*shared-cache-mode*设置为*NONE*

 *2-当我移除孩子时，我立即执行了这个：

```
public void remove(T entity) {
        getEntityManager().remove(getEntityManager().merge(entity));
        getEntityManager().getEntityManagerFactory().getCache().evictAll();
    } 
```

就这样。我希望这对其他人有帮助。

### 检查参考

[http://wiki.eclipse.org/EclipseLink/Examples/JPA/Caching](http://wiki.eclipse.org/EclipseLink/Examples/JPA/Caching)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:20:17.920

我找到的唯一解决方案是创建一个新方法来执行删除并强制 JPA 创建一个新事务。由于这样我丢失了changeSet，我不得不手动找出哪些出版物被删除了。然后我简单地调用那个辅助方法并且出版物被正确删除，但我发现这个解决方案非常难看。

@Transactional @Around("execution(* de.cware.services.truck.model.Truck.jpaPreUpdate(..))") public Object truckPreUpdate(final ProceedingJoinPoint pjp) throws Throwable { if (alreadyExecutingMarker.get() != Boolean .TRUE) { alreadyExecutingMarker.set(Boolean.TRUE);

```
 final Truck truck = (Truck) pjp.getTarget();

    final JpaEntityManager jpaEntityManager = (JpaEntityManager) entityManager.getDelegate();
    final UnitOfWorkChangeSet changeSet = jpaEntityManager.getUnitOfWork().getCurrentChanges();
    final ObjectChangeSet objectChangeSet = changeSet.getObjectChangeSetForClone(truck);

    if (log.isDebugEnabled()) {
        log.debug("--------------------- Truck pre update check (" + truck.getId() + ") ---------------------");
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // If the truck date has changed, revoke all publication copies.
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////

    final ChangeRecord truckFreeDate = objectChangeSet.getChangesForAttributeNamed("lkwFreiDatum");
    if (truckFreeDate != null) {
        if (log.isDebugEnabled()) {
            log.debug("The date 'truckFreeDate' of truck with id '" + truck.getId() + "' has changed. " +
                    "Revoking all publications that are not marked as main applications");
        }

        removeCopyPublications(truck);
    }
}

@Transactional(propagation = Propagation.REQUIRES_NEW)
protected void removeCopyPublications(Truck truck) {
    // Delete all not-main-publications.
    for (final String portal : truck.getPublishedPortals()) {
        if (log.isDebugEnabled()) {
            log.debug("- Revoking publications of copies to portal: " + portal);
        }

        final Map<Integer, TruckPublication> oldPublications = new HashMap<Integer, TruckPublication>();
        for(final TruckPublication publication : truck.getPublications(portal)) {
            oldPublications.put(publication.getId(), publication);
        }

        portalService.deleteCopies(truck, portal);

        for(final TruckPublication publication : truck.getPublications(portal)) {
            oldPublications.remove(publication.getId());
        }

        for (TruckPublication removedPublication : oldPublications.values()) {
            if(!entityManager.contains(removedPublication)) {
                removedPublication = entityManager.merge(removedPublication);
            }
            entityManager.remove(removedPublication);
            entityManager.flush();
        }
    }
} 
```

为什么我的第一个版本不起作用？*

# zend-framework - Zend_Form 标签装饰器

> ID：12641707
> 
> 赞同：4
> 
> 时间：2012-09-28T14:12:21.447
> 
> 标签：zend-framework, zend-form

我对标签装饰器有疑问。当我生成一个表单时，我有这样的东西：

```
<label id="user_email-label"><label for="user_email" class="required">e-mail</label>
</label>
<input type="text" name="user_email" id="user_email" value="" class="span4"> 
```

但是我需要 ：

```
<label for="user_email" class="required">e-mail</label>
<input type="text" name="user_email" id="user_email" value="" class="span4"> 
```

我的代码：

```
$oText = new Zend_Form_Element_Text('user_email');
$oText->clearDecorators();
$oText->setLabel($oTranslate->translate('e-mail'));
$oText->setAttrib('class','span4');
$oText->setRequired(true);
$oText->addValidator('NotEmpty', true);
$oText->addValidator('StringLength', true, array('max' => 200));
$oText->addValidator('EmailAddress', true);
$oText->addDecorator('ViewHelper');
$oText->addDecorator('Errors');
$oText->addDecorator('Label',array('tag'=>'label', 'placement' => 'prepend'));
$oText->setFilters(array('StringToLower','StringTrim'));
$this->addElement($oText); 
```

我的第二个问题是如何在标签内放置一个复选框？当我做这样的事情时：

```
 $oCheckbox = new Zend_Form_Element_Checkbox('remember_me');
    $oCheckbox->setLabel($oTranslate->translate('remember me'));
    $oCheckbox->setChecked(true);
    $oCheckbox->addDecorator('HtmlTag',array('tag'=>'label','class'=>'checkbox muted'));
    $oCheckbox->removeDecorator('DtDdWrapper');
    $oCheckbox->addDecorator('Label',array('tag'=>'label'));
    $this->addElement($oCheckbox); 
```

我有：

```
<label class="checkbox muted">
<input type="hidden" name="remember_me" value="0"><input type="checkbox" name="remember_me" id="remember_me" value="1" checked="checked"></label>
<label id="remember_me-label"><label for="remember_me" class="optional">remember me</label></label> 
```

但是我需要：

```
<label class="checkbox muted">
<input type="hidden" name="remember_me" value="0"><input type="checkbox" name="remember_me" id="remember_me" value="1" checked="checked">
remember me</label> 
```

有任何想法吗？

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T18:02:55.007

您构建元素的部分，“标签”选项

```
$oText->addDecorator('Label',array('tag'=>'label', 'placement' => 'prepend'));` 
```

不需要。将其更改为：

```
$oText->addDecorator('Label',array('placement' => 'prepend')); 
```

至于第二个问题，我认为您必须编写自定义元素才能实现这一目标。或者，您可以使用视图脚本根据需要渲染元素的每个部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-03T10:53:19.347

第二个查询的答案是使用标签装饰器上的 IMPLICIT_APPEND 放置。

```
 $oCheckbox->addDecorator('Label',array('placement' => 'IMPLICIT_APPEND')); 
```

# c++ - 如何防止c ++中的舍入错误？

> ID：12641714
> 
> 赞同：5
> 
> 时间：2012-09-28T14:12:34.863
> 
> 标签：c++, rounding

如何防止 C++ 中的舍入错误或修复它？

例子：

```
float SomeNumber = 999.9999;
cout << SomeNumber << endl; 
```

它打印出1000！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:17:30.463

`cout`您可以通过设置精度来更改舍入。

```
cout.precision(7);
float SomeNumber  = 999.9999;
cout << SomeNumber  << endl; 
```

或者，您可以`printf`从 cstdio 使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T14:20:47.147

默认情况下，格式化输出通过`std::ostream`将浮点值四舍五入为六位有效十进制数字。您需要七个才能避免您的数字被四舍五入到 1000：

```
cout << setprecision(7) << SomeNumber << endl;
        ^^^^^^^^^^^^^^^ 
```

`float`另外，请注意，假设常用的 32 位 IEEE 表示，您已接近 的精度限制。如果您需要超过 7 个有效数字，则需要切换到`double`. 例如，以下打印`1000`，无论您指定多少精度：

```
float SomeNumber = 999.99999; // 8 significant figures
cout << setprecision(10) << SomeNumber << endl; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:21:30.683

为防止您的**输出**被四舍五入，请在 iomanip 中使用 setprecision。

```
float SomeNumber = 999.9999;
std::cout << SomeNumber << std::endl; //outputs 1000
std::cout << std::setprecision (7) << SomeNumber << std::endl; //outputs 999.9999
return 0; 
```

但是，存储在 SomeNumber 中的实际值将始终为 999.9999，因此您无需担心值本身（除非您需要比 float 提供的精度更高的精度）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:21:05.347

如前所述，如果您只寻找 cout 舍入修复，请使用 .precision 函数。如果您指的是浮点数无法表示每个可能的分数，请阅读以下内容：

使用浮点数无法避免此类舍入错误。您需要以不同的方式表示您的数据。例如，如果您想要 5 位精度，只需将其存储为表示最小单位数的 long 即可。

即 5.23524 w/ 精度为 0.00001 可以用 long（或 int，如果您的值范围适合）表示为 523524。您知道单位是 0.00001，因此您可以轻松地使其工作。

# c# - 如何将现有的 ASP.NET 应用程序集成到 Visual Studio 2010 中的现有网站中？

> ID：12641717
> 
> 赞同：0
> 
> 时间：2012-09-28T14:12:40.420
> 
> 标签：c#, asp.net, visual-studio-2010, web-site-project

我有一个在 Visual Studio 2010 中构建的现有网站，我想与我用 ASP.NET/C#（也在 VS2010 中）编写的 Web 应用程序集成。当我尝试将页面移动到网站（只是拖放）时，MyPage.aspx.designer.cs 文件不会留在文件“组”中。（.aspx、.aspx.cs）

作为参考，（如果重要的话），我的申请是我公司的在线申请，人们可以在线申请。

任何帮助表示赞赏！

-E

[更新]：这是我尝试在浏览器中查看集成页面时遇到的错误：

```
Line 1:  <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="TheEnd.aspx.cs"   Inherits="ApplicantEntry.TheEnd" %>

Line 2: 

Line 3:  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:14:26.453

您需要您的网站成为“Web 应用程序”才能实现您想要的。右键单击该站点并选择“转换为 Web 应用程序”。这应该够了吧。

或者，如果您*必须*保留您的网站非 Web 应用程序，那么您可以删除设计器文件，网站不需要它。但是现在推荐的做法是使用 Web 应用程序。

# php - JSON - 在 JavaScript 中解码字符串的正确方法

> ID：12641721
> 
> 赞同：1
> 
> 时间：2012-09-28T14:12:50.840
> 
> 标签：php, javascript, dojo, json

我想知道在 Javascript 代码中解码 JSON 字符串的最佳方法是什么。

我希望我的 json 字符串嵌入到我的 JS 中，如下所示：

```
var params = dojo.fromJson('<?=json_encode($this->params); ?>'); 
```

dojo.fromJson 解码我的字符串，而 json_encode 是一个 php 函数，它在服务器端对对象进行编码。

似乎 json 编码器忽略了 ' 字符，只将“转换为 \”。因此，当我在 $this->params 中的一个变量包含一个 ' 字符时，就会出现 Javascript 错误。

例如：

```
var params = dojo.fromJson('{"id":"11","object_type":"Let's go"}'); 
```

解决这个问题的最佳方法是什么？

感谢帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:14:51.357

由于您自己生成 JSON，因此您可以信任它，因此您不需要将其视为 JSON，而可以将其视为 JS。

```
var params = <?=json_encode($this->params); ?>; 
```

PHP 的 JSON 编码器将为`</script>`您转义，因此您无需担心使用数据终止脚本元素。

# python - PyMongo 无法连接到 Heroku MongoLab 插件

> ID：12641726
> 
> 赞同：1
> 
> 时间：2012-09-28T14:13:02.870
> 
> 标签：python, mongodb, heroku, flask, mlab

我已将 MongoLab 附加组件添加到 Heroku 实例，但我的应用程序无法连接到 MongoDB 主机。我看过[这个](https://stackoverflow.com/questions/8859532/how-can-i-use-the-mongolab-add-on-to-heroku-from-python)帖子，但我没有看到任何有用的东西。

**twitter_clone_python.py**

```
f = Flask(__name__)

# 'TheFuture' is the name of my laptop. It signifies that we are in
# development mode.
if socket.gethostname().startswith('TheFuture'):
    f.config.from_object('config.DevelopmentConfig')
# If 'TheFuture' isn't the host, then we are in production.
else:
    f.config.from_object('config.ProductionConfig')

# MongoDB connection
connection = Connection(f.config['MONGODB_HOST'], f.config['MONGODB_PORT'])
db = connection['MONGODB_DB']

# Try authenticating. This will only work in production. In development,
# MONGODB_USER and MONGODB_PASSWORD will raise KeyErrors.
try:
    db.authenticate(f.config['MONGODB_USER'], f.config['MONGODB_PASSWORD'])
except KeyError:
    pass 
```

**配置文件**

```
class Config(object):
    '''Default configuration object.'''
    DEBUG = False
    TESTING = False
    PORT = int(os.environ.get('PORT', 5000))

class ProductionConfig(Config):
    '''Configuration object specific to production environments.'''
    REDIS_URL = os.environ.get('REDISTOGO_URL')
    if REDIS_URL:
        url = urlparse.urlparse(REDIS_URL)
        REDIS_HOST = url.hostname
        REDIS_PORT = url.port
        REDIS_PASSWORD = url.password

    MONGOLAB_URI = os.environ.get('MONGOLAB_URI')
    if MONGOLAB_URI:
        url = urlparse.urlparse(MONGOLAB_URI)
        MONGODB_USER = url.username
        MONGODB_PASSWORD = url.password
        MONGODB_HOST = url.hostname
        MONGODB_PORT = url.port
        MONGODB_DB = url.path[1:]

class DevelopmentConfig(Config):
    '''Configuration object specific to development environments.'''
    DEBUG = True

    MONGODB_HOST = 'localhost'
    MONGODB_PORT = 27017
    MONGODB_DB = 'twitter-clone-python-development' 
```

运行`heroku logs`显示错误：

```
2012-09-28T13:57:25+00:00 app[web.1]: pymongo.errors.AutoReconnect: could not connect to ds037997.mongolab.com:27017: timed out 
```

# php - 如何使 PHPEXcel 从数据库中添加其他字段

> ID：12641735
> 
> 赞同：0
> 
> 时间：2012-09-28T14:13:33.757
> 
> 标签：php, phpexcel

我试图从 phpexcel.codeplex.com 创建一个带有 PHPExcel 类的电子表格，但我遇到了一个情况，无法弄清楚出了什么问题。

我有 3 个来自数据库的字段要插入到电子表格“名称”、“价格”、“库存”中。

问题是我只得到产品名称，这是表中的第一个字段。

这是我正在处理的代码：

$sql = "从产品中选择名称、价格、库存";

```
$objPHPExcel = new PHPExcel();

$res = $con->query( $sql );

// First row
$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow( 'name', 1, 'Name' );
$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow( 'price', 1, 'Price' );
$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow( 'stock', 1, 'Stock' );

// Other rows
$i = 2;
while( $row = $res->fetch( PDO::FETCH_ASSOC ) ) {
    foreach( $row as $col => $data ) {
        $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow( $col, $i, $data );
    }
    $i++;
}

// Redirect output to a client web browser (Excel5)
header( 'Content-Type: application/vnd.ms-excel' );
header( 'Content-Disposition: attachment;filename="report.xls"' );
header( 'Cache-Control: max-age=0' );

$objWriter = PHPExcel_IOFactory::createWriter( $objPHPExcel, 'Excel5' );
$objWriter->save( 'php://output' );
exit; 
```

我看不到我错过了什么...

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:18:11.400

```
$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow( 'name', 1, 'Name' ); 
```

column 参数应该是一个数值：0 = A 列，1 = B 列，等等。您使用的是一个字符串，它的类型将被转换为数字 0，因此所有内容都被写入第一 (0) 列，覆盖已经存在的任何内容....令我惊讶的是，您不仅仅获得了最后一个（股票）列的值

# linux - curl帖子问题：输入密码为空

> ID：12641741
> 
> 赞同：0
> 
> 时间：2012-09-28T14:13:53.073
> 
> 标签：linux, shell, curl

我正在使用“curl”来获取需要用户名和密码的网页。

对于某些网页，我可以使用以下表达式获取我想要的页面

```
curl -u myusername:mypassword url -o output.html. 
```

但是对于其他一些网页，我无法获得我想要的页面。

我试过上面提到的表达式，似乎用户名和密码没有随请求一起发送。

我也尝试过像这样的表达

```
curl -d"login_username=myusername&login_password=mypassword&action=login&submit=Login" url -o output.html. 
```

用户名已发送，但密码仍为空。

顺便说一句，在用户名和密码输入框下有一个“**领域：LDAP ”。**

有人知道发生了什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T02:26:02.670

假设网站使用 HTTP 基本身份验证，详细模式，带有 -v 选项，让您确认是否发送了身份验证请求。如果发送了身份验证请求，您可以看到如下所示的 Authorization 标头。

```
$ curl -v -u user:password http://foo.example.com/auth/ -o output.html

* About to connect() to x.x.x.x port 3128
*   Trying x.x.x.x... connected
* Connected to proxy.example.com (x.x.x.x) port 3128
* Server auth using Basic with user 'user'
> GET http://foo.example.com/auth/ HTTP/1.1
> Authorization: Basic cm9vdDpSaW5nMjAXMA== 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-01T02:27:57.710

cURL 用户名和密码的语法是：

```
user,password 
```

而**不是**

```
user:password 
```

所以最后：

```
curl -s -v -u myusername,mypassword url 
```

# javascript - 下拉菜单上的 slideDown

> ID：12641742
> 
> 赞同：0
> 
> 时间：2012-09-28T14:13:53.317
> 
> 标签：javascript, jquery, html, css

我想在我的页面上执行此操作（photoshop 图片）：

![在此处输入图像描述](../Images/dbda145c779ca7c5c8f22d786a687a2a.png)

在**悬停**时（在 ACTORS 链接上），我希望黄色下拉列表（Fotis J.Colakides 等所在的位置）缓慢显示。从上到下。

我不知道在我的页面上执行此操作的最佳方法是什么。

当然我必须使用这样的无序列表（）：

```
 <ul id="showInfoNav">
        <li><a class="slideBtn" href="#">MEDIA</a>
            <ul class="slideShow">
                <li>assa</li>
            </ul>
        </li>
        <li><a class="slideBtn" href="#">ACTORS</a>
            <ul class="slideShow">
                <li><a href="#" onclick="javascript:getSummary(1)">ACTOR1</a></li>
                <li><a href="#" onclick="javascript:getSummary(2)">ACTOR2</a></li>
            </ul>
        </li>
    </ul> 
```

**[更新]**

直到现在我已经这样做了：（[http://jsfiddle.net/bMGhC/](http://jsfiddle.net/bMGhC/)）

![在此处输入图像描述](../Images/3b92560c76a6b8335d3cd0a7787dc535.png)

但我是从 css 做的。我有左边：-9999px；在悬停时我在左边：0px;

我想做它向下滑动。但它不起作用。

这是我的CSS：

```
ul#showInfoNav 
    {
        list-style:none;
        float:left;
        width:100%;
    }

    ul#showInfoNav li
    {
        float:left;
        margin-right:50px;
        position:relative;
    }

    ul#showInfoNav a.slideBtn
    {
        padding:5px;
        display:block;
        text-decoration:none; 
    }
    ul#showInfoNav ul a:hover{
        color:#898989;
    }
    /*--- DROPDOWN ---*/
    ul#showInfoNav ul
    {
        background-color:#F4F9B6;
        padding:50px 10px 10px 10px;
        list-style:none;
        left:-9999px; /* Hide off-screen when not needed (this is more accessible than display:none;) */
        position: absolute;
        top:-20px;
        /*z-index:-1;*/
    }
    ul#showInfoNav ul li
    {

        float:none;
    }
    ul#showInfoNav ul a{
        white-space:nowrap; 
    }

    ul#showInfoNav li:hover ul{ /* Display the dropdown on hover */
        left:0; /* Bring back on-screen when needed */
    } 
```

我也有这个 z-index 问题。如果我将它设置为 -1，它也会隐藏在图像后面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:17:05.817

查看 jQuery UI 效果，特别是 slide()：

[http://docs.jquery.com/UI/Effects/Slide](http://docs.jquery.com/UI/Effects/Slide)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:27:15.697

您还可以查看[`slideToggle()`](http://api.jquery.com/slideToggle/)jQuery 提供的方法。

**[请参阅此处](http://jsfiddle.net/k2RLz/1/)**的示例。

类似的功能是[`slideUp()`](http://api.jquery.com/slideUp/)，[`slideDown()`](http://api.jquery.com/slideDown/)而且更通用的是，[`animate()`](http://api.jquery.com/animate/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:42:27.193

看看`.hover()`， 和`.slideUp/Down()`。如果您想要更“永久”的状态，也可以在以下代码中替换`.hover`为。`.toggle`两者的关键是利用它们的回调函数。

HTML

```
<a href="#">Click to see a list</a>
<ul>
    <li>List Item</li>
    <li>List Item</li>
    <li>List Item</li>
    <li>List Item</li>
</ul> 
```

jQuery

```
$('ul').hide(); // doing this rather than via CSS for a fail-safe for JS
$('a').hover(function() {
    $('ul').slideDown('fast');
    }, function() {
    $('ul').slideUp('slow')
})​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:23:44.643

使用 jQuery fadeIn() 时，您也可以指定持续时间。一些简单的示例是：

1.  给 li 的一些 id 或 class ( `<li id="actor1">soemthing</li>`)
2.  在 JS 文件或脚本标签中使用：

    $("#actor1).hover(function(){ $(this).slideDown('slow')}, function(){ $(this).slideUp('slow') });

编辑：我看到你想要一个滑动效果，所以我将`fadeIn()`and更改`fadeOut()`为`slideDown()`and `slideUp()`。[你可以在这里](http://api.jquery.com/?ns0=1&s=slide)阅读他们的文档

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-29T14:34:28.710

这是我找到的解决方案，我使用它是因为我不想在他的标签`<ul>`之间导航时滑动。`<li>`

```
 $('ul.slideShow').hide();
    $("#showInfoNav li").click(function () {
        $(this).find('ul.slideShow').slideDown('fast').show();
        $(this).hover(function () {   // PARENT

        }, function () {
            $(this).parent().find("ul.slideShow").slideUp('slow'); //When the mouse hovers out of the subnav, move it back up 
        });

    }); 
```

# javascript - Seed 中的 console.dir() 等价物是什么？

> ID：12641749
> 
> 赞同：1
> 
> 时间：2012-09-28T14:14:09.607
> 
> 标签：javascript, gnome, seed

在 Node.js 和 Chrome 中，console.dir() 将递归地回显一个对象到控制台。这可以在种子中轻松实现吗？我可以编写函数，但想知道这是否可以通过本机调用来完成。

# python - 合并元组列表和列表并创建字典

> ID：12641751
> 
> 赞同：0
> 
> 时间：2012-09-28T14:14:20.827
> 
> 标签：python

我有一个包含元组列表的列表和一个包含 2 个项目的列表。我需要合并并创建一个新字典。

这是一个示例： 输入：

```
list1 = [('col1',20,30),('col2',40,50)]
list2 = ['name','age'] 
```

期望的结果：

```
 output = {'col1':'name','col2':'age'} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:15:18.033

```
output = {el1[0]: el2 for el1, el2 in zip(list1, list2)} 
```

或者对于旧版本的 Python：

```
output = dict((el1[0], el2) for el1, el2 in zip(list1, list2)) 
```

# netbeans - Netbeans 7.2 Ctrl + 单击不起作用

> ID：12641752
> 
> 赞同：2
> 
> 时间：2012-09-28T14:14:25.207
> 
> 标签：netbeans, netbeans-7.2

以前从未在此系统上安装过用于 PHP 的 Netbeans 7.2 的全新安装（字面意思是 5 分钟）。

单击父类和`Class Foo extends Bar`命名空间类时，Ctrl+Click 失败。

ctrl + 点击时只找到本地方法

[这个问题](https://stackoverflow.com/questions/8369807/netbeans-php-go-to-declaration-issue)也没有帮助我。所有代码都包含在一个目录中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-05-07T11:15:48.310

如果有人遇到与 Netbeans 12 和 Java 相同的问题，请检查您是否安装了**nb-javac 插件**！

安装**nb-javac**插件为我在 Netbeans 12.3 中解决了这个问题。

要检查/安装插件，您可以转到工具> 插件> 搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T13:59:24.303

由于这是全新安装，项目缓存是否已完成构建？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-12T12:14:45.873

试试这个而不是`Ctrl`+Click：

```
Put selection on a method > Ctrl-B 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-22T07:22:12.227

**在 Windows 7 中：**首先关闭您的 netbeans，然后您应该转到**C:\Users{YourUserName}\AppData\Local\NetBeans\Cache\7.2** 并删除**7.2 文件夹**的所有内容。现在打开您的 netbeans。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-19T07:24:52.337

右键单击项目的属性，然后选择“代码辅助”，然后选择“PHP代码辅助”，一切都会好起来的！

# c++ - SDL Video Init 在 Mac OS X 10.8 上导致异常

> ID：12641755
> 
> 赞同：7
> 
> 时间：2012-09-28T14:14:27.957
> 
> 标签：c++, macos, sdl, osx-mountain-lion

我刚刚将我的 C++ 游戏移植到 OS X，第一次运行时，我在尝试调用`SDL_SetVideoMode`.

2012-09-28 15:01:05.437 SCRAsteroids [28595:707] *** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“错误（1000）在第 259 行创建 CGSWindow”***第一掷调用堆栈：（0的CoreFoundation 0x00007fff8b53b716 __exceptionPreprocess + 198 1 libobjc.A.dylib 0x00007fff90e30470 objc_exception_throw + 43 2的CoreFoundation 0x00007fff8b53b4ec + [NSException提高：格式：] + 204 3了AppKit 0x00007fff8a26a579 _NSCreateWindowWithOpaqueShape2 + 655 4了AppKit 0x00007fff8a268d70 - [NSWindow _commonAwake] + 2002 5 AppKit 0x00007fff8a2277e2-[NSWindow _commonInitFrame:styleMask:backing:defer:] + 1763 6 AppKit 0x00007fff8a22692f -[NSWindow _initContent:styleMask:backing:defer:contentView:] + 1568 7 AppKit 0x00007fff8a2226styleMask:backing:defer:] + 45 8 libSDL-1.2.0.dylib 0x0000000107c228f6 -[SDL_QuartzWindow initWithContentRect:styleMask:backing:defer:] + 294 9 libSDL-1.2.0.dylib 0x0000000107c20505 QZ_SetVideoMode + 28.37 libSDL-101\. .dylib 0x0000000107c17af5 SDL_SetVideoMode + 917 11 SCRAsteroids 0x0000000107be60fb _ZN11SDLGraphics4initEP6IWorldii + 291 ） libc++abi.dylib：终止调用抛出异常中止陷阱：6dylib 0x0000000107c17af5 SDL_SetVideoMode + 917 11 SCRAsteroids 0x0000000107be60fb _ZN11SDLGraphics4initEP6IWorldii + 291 ） libc++abi.dylib：终止调用抛出异常中止陷阱：6dylib 0x0000000107c17af5 SDL_SetVideoMode + 917 11 SCRAsteroids 0x0000000107be60fb _ZN11SDLGraphics4initEP6IWorldii + 291 ） libc++abi.dylib：终止调用抛出异常中止陷阱：6

我的初始化代码如下所示：

```
if (SDL_Init(SDL_INIT_EVERYTHING) < 0)
  return false;

const SDL_VideoInfo *videoInfo = SDL_GetVideoInfo();
if (!videoInfo) {
  fprintf(stderr, "Video query failed: %s\n",
     SDL_GetError());
  return false;
}

/* the flags to pass to SDL_SetVideoMode */
videoFlags = SDL_OPENGL;       /* Enable OpenGL in SDL */
videoFlags |= SDL_GL_DOUBLEBUFFER; /* Enable double buffering */
videoFlags |= SDL_HWPALETTE;       /* Store the palette in hardware */

/* This checks to see if surfaces can be stored in memory */
if (videoInfo->hw_available)
  videoFlags |= SDL_HWSURFACE;
else
  videoFlags |= SDL_SWSURFACE;

if (w == 0) {
  widthViewport = videoInfo->current_w;
  heightViewport = videoInfo->current_h;
  cout << "Will use full screen resolution of ";   
  videoFlags |= SDL_FULLSCREEN;
} else {
  cout << "Will use full user supplied resolution of ";
  widthViewport = w;
  heightViewport = h;
  videoFlags |= SDL_RESIZABLE;       /* Enable window resizing */
}

cout << widthViewport << "x" << heightViewport << "\n";
  /* This checks if hardware blits can be done */
if (videoInfo->blit_hw)
  videoFlags |= SDL_HWACCEL;

/* Sets up OpenGL double buffering */
SDL_GL_SetAttribute(SDL_GL_DOUBLEBUFFER, 1);
/* get a SDL surface */
surface = SDL_SetVideoMode(widthViewport, heightViewport,
  SCREEN_BPP, videoFlags); 
```

它进入最后一个 SDL 调用并抛出上面的异常。我在全屏和可调整大小的窗口模式下都试过了，同样的事情。

我在命令行上构建我的应用程序老派，而不是使用 Xcode。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T21:34:40.727

SDL_main 再次成为罪魁祸首。我的 C++`main`例程在一个不包含 的文件中`SDL.h`，因此它没有被重新定义为`SDL_main`. 包含的代码`SDL`位于可重用的静态库中，您看不到主例程。我手动将函数的名称更改为`SDL_main`，这意味着 SDL 提供了基本的主例程。我不喜欢这样做，但目前，在`SDL 1.2.15`Mac 上，这是必要的。

在 Windows 上，相同的新代码会导致链接器冲突。这是一个新问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-25T17:50:34.277

在 cocoa 中调用视频卡有问题。所以你需要在调用 SDL_Setvideomode 之前初始化它

添加以下方法，并在您的 main 方法中首先调用它

```
#include <dlfcn.h>  //To make it work on mac

//This must be called before playing with SDL, else it won't work on osx.

void pre_init()
{
    void* cocoa_lib;

    cocoa_lib = dlopen( "/System/Library/Frameworks/Cocoa.framework/Cocoa", RTLD_LAZY );
    void (*nsappload)(void);
    nsappload = (void(*)()) dlsym( cocoa_lib, "NSApplicationLoad");
    nsappload();
} 
```

`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T10:20:36.277

同样的问题，但通过链接 libSDLmain（以及 libSDL）解决了。这又需要两个框架：Foundation 和 Cocoa。

我没有重命名主要功能。

# javascript - Chrome 22 混淆了平板电脑和台式机

> ID：12641760
> 
> 赞同：5
> 
> 时间：2012-09-28T14:14:40.573
> 
> 标签：javascript, google-chrome

我知道很多 JavaScript 库都依赖于“ontouchstart”来检测它是在平板电脑上还是桌面上。

这是我正在谈论的代码示例：

```
 var hasTouch = ("ontouchstart" in window); 
```

现在，我必须注释掉所有的平板电脑检测代码才能工作。

检测平板电脑与台式机的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T16:29:10.553

看看它是否是一个移动平台，我用过这个

```
var iPadAgent = navigator.userAgent.match(/iPad/i) != null;
var iPodAgent = navigator.userAgent.match(/iPhone/i) != null;
var AndroidAgent = navigator.userAgent.match(/Android/i) != null;
var webOSAgent = navigator.userAgent.match(/webOS/i) != null;

var isMobile = iPadAgent || iPodAgent || AndroidAgent || webOSAgent; 
```

它工作得很好。

# sql-server - 选择值接近相同的所有记录

> ID：12641763
> 
> 赞同：0
> 
> 时间：2012-09-28T14:15:05.943
> 
> 标签：sql-server, database

> **可能重复：**
> [使用 T-SQL 进行模糊匹配](https://stackoverflow.com/questions/921978/fuzzy-matching-using-t-sql)

假设我有我的客户表：`firstName,MiddleName,LastName` 。我想选择姓氏等于或接近于“罗伯特”的所有记录。几乎相同，我的意思是输入文本中最多 25% 的字符与 DB 中的某个值不同。是否有可能在 Microsoft SQL sver 2008 中实现？

为什么我需要这个？假设用户输入了“peterdson”而不是“peterson”。我想显示建议更相关结果的用户消息。

# sql - 在 PostgreSQL 中聚合 (x,y) 坐标点云

> ID：12641764
> 
> 赞同：3
> 
> 时间：2012-09-28T14:15:09.390
> 
> 标签：sql, postgresql, aggregate

我有一个具有以下简化结构的 PostgreSQL 数据库表：

*   设备 ID varchar
*   Pos_X (int)
*   Pos_Y (int)

基本上，该表包含许多设备的二维航点数据。现在我想设计一个查询来减少输出中的坐标数。它应该聚合附近的坐标（对于某个 x,y 阈值）一个例子：

第 1 行：设备 1；603；1205

第 2 行：设备 1；604；1204

如果阈值为 5，则应聚合这两行，因为方差小于 5。知道如何在 PostgreSQL 或 SQL 中执行此操作吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T14:45:08.903

[**`width_bucket()`**](http://www.postgresql.org/docs/current/interactive/functions-math.html)结合您的聚合使用经常被忽视的内置函数：

如果您的坐标从 0 到 2000 运行，并且您想将 5 个正方形内的所有内容合并为单个点，我会像这样布置一个 10 (5*2) 的网格：

```
SELECT device_id
     , width_bucket(pos_x, 0, 2000, 2000/10) * 10 AS pos_x
     , width_bucket(pos_y, 0, 2000, 2000/10) * 10 AS pos_y
     , count(*) AS ct -- or any other aggregate
FROM   tbl
GROUP  BY 1,2,3
ORDER  BY 1,2,3; 
```

为了**最大限度地减少误差**，您可以`GROUP BY`像演示的那样使用网格，但保存实际的平均坐标：

```
SELECT device_id
     , avg(pos_x)::int AS pos_x   -- save actual averages to minimize error
     , avg(pos_y)::int AS pos_y   -- cast if you need to
     , count(*)        AS ct      -- or any other aggregate
FROM   tbl
GROUP  BY
       device_id
     , width_bucket(pos_x, 0, 2000, 2000/10) * 10  -- aggregate by grid
     , width_bucket(pos_y, 0, 2000, 2000/10) * 10
ORDER  BY 1,2,3; 
```

[sqlfiddle 展示了两者。](http://www.sqlfiddle.com/#!12/047cd/7)

好吧，这种特殊情况可能更简单：

```
...
GROUP  BY
       device_id
     , (pos_x / 10) * 10          -- truncates last digit of an integer
     , (pos_y / 10) * 10
... 
```

但这只是因为演示网格大小`10`方便地匹配十进制系统。尝试使用相同的网格大小`17`或其他东西......

* * *

### 扩展到时间戳

[您可以通过使用extract()](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT)将它们转换为 unix 纪元（自 '1970-1-1' 以来的秒数）来扩展此方法以覆盖`date`和值。`timestamp`

```
SELECT extract(epoch FROM '2012-10-01 21:06:38+02'::timestamptz); 
```

完成后，将结果转换回`timestamp with time zone`：

```
SELECT timestamptz 'epoch' + 1349118398 * interval '1s'; 
```

或者简单地说[`to_timestamp()`](http://www.postgresql.org/docs/current/interactive/functions-formatting.html)：

```
SELECT to_timestamp(1349118398); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:17:53.027

```
select [some aggregates] group by (pos_x/5, pos_y/5); 
```

哪里可以有任何数字而不是 5，具体取决于您需要多少聚合/

# datasource - 在 SmartGWT ListGrid 中结合数据源和本地数据

> ID：12641770
> 
> 赞同：1
> 
> 时间：2012-09-28T14:15:29.137
> 
> 标签：datasource, smartgwt, listgrid

我扩展了 ListGrid 以创建按搜索类型分组的已保存搜索列表，无论是公共的还是私人的。此列表通过标准 SmartGWT 数据源填充。

此外，我想在此列表中添加一组历史搜索，用户可以在他们逐个会话创建搜索时使用这些搜索（即，用户创建新搜索 - 直到他们关闭浏览器，该搜索将显示在搜索列表中，在“历史搜索”分组下）。

长话短说，我希望能够从两个单独的源填充 ListGrid - 从已经存在的数据源和理想情况下从保存在内存中的 RecordList。我尝试了类似的东西：

```
@Override
public void fetchData() {
    invalidateCache();
    discardAllEdits();
    super.fetchData();
    setCanEdit(true);
    for(Record r : histSearches.toArray()) {
        startEditingNew(r);
        endEditing();
    }
    setCanEdit(false);
    markForRedraw();
}; 
```

虽然这段代码确实被执行了，但它并没有以任何方式执行我希望它执行的功能。有人对如何执行此功能有任何建议吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T06:00:19.687

如果您调用 DataSource.fetchData()，在回调中您可以将所选数据作为 RecordList 获取。然后，您可以通过 recordList.add() 添加每个会话的搜索，并通过 setData() 将修改后的 RecordList 提供给 ListGrid。

顺便说一句，公共 wiki 上还有一篇文章显示了保存搜索的示例实现（尽管与您想要的不同）：

[http://wiki.smartclient.com/display/Main/Saved+Search+%28Smart+GWT%29](http://wiki.smartclient.com/display/Main/Saved+Search+%28Smart+GWT%29)

# c# - WebBrowser 调用脚本

> ID：12641771
> 
> 赞同：3
> 
> 时间：2012-09-28T14:15:38.013
> 
> 标签：c#, javascript

我有一个 Web 浏览器，其中一些设置是使用 javascript 更改的。我正在尝试使用[此处](http://msdn.microsoft.com/en-us/library/cc452443%28v=vs.100%29.aspx)的示例，但无法获得正确的语法

脚本看起来像这样

```
 <div class="DisplayInput"><input type="radio" name="displaytype" 
value="decimal" onclick="setdisplayType('decimal');" checked="checked"><a 
    href="javaScript:setdisplayType('decimal');" 
    onclick="s_objectID=&quot;javascript:setdisplayType('decimal');_1&quot;;return this.s_oc?     this.s_oc(e):true">Decimal</a></div> 
```

到目前为止，我已经尝试过这些但没有成功

```
this.webBrowser1.InvokeScript("setdisplayType");
this.webBrowser1.InvokeScript("setdisplayType('decimal')");
this.webBrowser1.InvokeScript("setdisplayType","decimal"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T14:24:19.353

在不知道您的应用程序错误发生了什么以及不知道是什么`setdisplayType`样子的情况下，我猜您可能正试图`setdisplayType`在加载该函数之前调用它。根据 MSDN 文档...

> 在实现它的文档完成加载之前，不应调用 InvokeScript(String, Object())。**您可以通过处理LoadCompleted**事件来检测文档何时完成加载。

也许您可以实现`LoadCompleted`事件处理程序，然后调用您的脚本。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-28T13:22:01.203

您必须传递一个 Object 数组作为第二个参数。你可以这样做：

```
Object[] parameters = new Object[1]; //assuming your JS function has one parameter
parameters[0] = (Object)"yourStringParameter"; //for example the parameter is a string
yourBrowser.Document.InvokeScript("scriptName", parameters); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-27T18:20:22.483

试试这个：

```
private async void web_LoadCompleted(object sender, NavigationEventArgs e)
{
  Object[] parameters = new Object[1]; 
  await yourBrowser.Document.InvokeScript("scriptName", parameters);
} 
```

# sql - 本机 SQL , 通用重复条目检索

> ID：12641772
> 
> 赞同：0
> 
> 时间：2012-09-28T14:15:37.893
> 
> 标签：sql

我有一个带有字段的表`f1`T`f2`和`f3`.

我想检索`f1`属于具有重复`f2`和`f3`字段的行的所有内容。如何才能做到这一点 ？

编辑 ：

例如：

```
(1,2,3) 
(2,2,3) 
(4,1,1) 
(2,2,2) 
(3,4,3) 
(1,5,6) 
```

预期结果是：

```
(1)
(2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:22:18.560

试试这个

```
select f1 from T group by (f1) having (count(f2) > 1 and count(f3) > 1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:20:03.290

这将带回 f2 和 f3 值出现在多行上的行上的每个 f1 值。

```
select T.f1 from T
inner join (select f2,f3 from T group by f2,f3 having count(*) > 1) dups
on t.f2 = dups.f2 and t.f3 = dups.f3; 
```

所以如果你有数据。

```
f1 f2 f3
-- -- --
1  A  b
2  A  c
3  A  b
4  B  b 
```

你会得到 1 和 3。

# html - 我应该为每个页面使用单独的精灵还是为所有页面使用单个精灵？

> ID：12641774
> 
> 赞同：1
> 
> 时间：2012-09-28T14:15:43.680
> 
> 标签：html, css

我在网站上有很多页面，有些页面有共同的图像和单独的图像，所以我应该为所有页面制作一个精灵并跨页使用还是每个页面都应该有自己的精灵

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:18:46.287

最初的目标应该是最少数量的请求和概念文件。单个精灵文件将是一个请求，然后将被缓存，这等于没有对后续页面的请求。*因此，您应该在站点范围内*使用尽可能少的 sprite 文件。

唯一的其他因素是文件大小。如果您的 sprite 文件开始变大，那么您可能希望将它们拆分以利用多个并发传输（通常为 2 个）。你的精灵文件通常应该足够小，这不是问题，因为精灵通常包含更小的视觉元素（如果这是一个问题，你应该做一些更认真的研究）。

如果您有特定于页面的小元素，它们应该在一个统一的站点范围的精灵中。如果它们具有相应的大小，那么您应该根据图像的大小与任何给定站点访问者查看该页面的可能性来决定。

# objective-c - 目标c中的getter和setter方法？

> ID：12641775
> 
> 赞同：1
> 
> 时间：2012-09-28T14:15:47.403
> 
> 标签：objective-c, ios5, ios4

Objective-C 的新手，我基本上来自 c++ 背景。我现在正在学习objective-c，并想确认我理解的是写还是错？好心提醒。

我有以下课程：

```
@interface Test: NSObject
{
 int instance1; 
}
@property int instance1;
 - (void)  sayHello;
@end 
```

“测试”类有一个实例变量`instance1`。如果成员函数 ie: sayHello 想要访问变量，它必须通过 getter/setter 函数发生。所以，有两种方法可以得到它：

1.  用户可以定义。
2.  我们可以从编译器那里得到帮助吗？如何？。将相同的变量声明为属性，并对其进行合成，编译器为我们获取该特定变量的 getter/setter 代码。

所以，不合时宜地，getter/setter 是在方法实现中访问变量的唯一方法，即。两者都`self.instance1 = 100;`需要`instance1 = 100`getter/setter。

错过了 1\. 和 2.，无法访问该`instance1`变量。

此外，`instance1`公共变量可以在具有对象实例的类之外访问。

```
Test *t = [[ Test alloc] init];
t.instance1 = 200; 
```

问题：

1.  有什么办法可以使`instance1`“私有”，使我无法访问类外的实例变量？
2.  我的理解有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:21:19.730

> 如果成员函数 ie: sayHello 想要访问变量，它必须通过 getter/setter 函数发生。

它没有`have to`。您可以直接访问 ivars，而无需使用访问器方法：

```
- (void)sayHello {
   instance1 = 123;
} 
```

您可以通过在实现文件中声明私有 ivars 来定义它们，而不是在头文件中：

```
@implementation Test {
   int privateVar;
}
// ... additional implementation, methods etc.
@end 
```

请注意，从 Xcode 4.4 开始，您不必再声明您的 ivars。您只需声明一个属性。ivar 和访问器方法将自动合成。

**有关更多详细信息，我建议阅读我对这个问题的回答：** [**变量声明**](https://stackoverflow.com/questions/12632285/declaration-definition-of-variables-locations-in-objectivec/12632467#12632467)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:45:36.720

离子 SomeDelegate.h

```
@interface SomeDelegate : NSWindowController {
@private
    int fLanguage;
    int fDBID;

    bool fEndEditingIsReturn;
@public
    int fIsMyLastMSG;  
}

@property int language; 
```

在 SomeDelegate.mm

```
@implementation SomeDelegate

@synthesize language=fLanguage; 
```

在我的示例中，您获得*私有*和*公共*变量，*私有*变量`fLanguage`有一个`property`用于*合成访问器方法*。

# php - Xdebug 在 php 中为 mysqli 查询返回 null

> ID：12641779
> 
> 赞同：0
> 
> 时间：2012-09-28T14:16:03.947
> 
> 标签：php, mysqli, xdebug, netbeans-7

我正在尝试使用 Xdebug 2.2.1 在 Netbeans（Windows 7）和 debian Squeeze 远程服务器上进行远程调试，在 PHP 5.3.17 上调试 mysqli SELECT 查询。

像这样的代码：

（这是一个单例）

```
$RawData = Database::call()->query($query); 
```

当我运行调试时，将鼠标悬停在 RawData 变量上显示：

```
mysqli_result object {
  current_field => null
  field_count => null
  lengths => null
  num_rows => null
  type => null
} 
```

变量视图选项卡不显示任何内容（/etc/php5/xdebug.log 上没有错误）

但是，当我在没有调试的情况下运行脚本时，打印出结果，查询返回了正确的值。

[我在http://bugs.xdebug.org/view.php?id=881](http://bugs.xdebug.org/view.php?id=881)上播下了类似的问题， 但它发生在不同的查询结果、php 版本、没有远程服务器，而且我没有使用 var_dump。

我错过了什么？

**编辑**：mysql 查询需要“mysql_fetch”来查看结果。

# entity-framework-5 - 实体框架 5 在运行时更改提供程序

> ID：12641781
> 
> 赞同：2
> 
> 时间：2012-09-28T14:16:14.617
> 
> 标签：entity-framework-5

我有一个在多个客户端站点上运行的应用程序。我必须在这些位置（SQL Server、DB2、Oracle）支持不同的 DBMS。我正在将应用程序从具有基于 ODBC 的数据层的 VC++ 6.0 转换为 Visual Studio 2012，并希望使用实体框架（数据库优先）。我在示例应用程序中在运行时更改数据库提供程序时遇到了麻烦。我将 app.config 中的连接字符串从 SQL Server 更改为 DB2 连接字符串，并更改了默认连接工厂。现在，当我运行程序时，我可以连接到数据库（至少没有错误），但是当我遍历 linq 结果时，我得到了异常：

> 无法将“IBM.Data.DB2.DB2Connection”类型的对象转换为“System.Data.SqlClient.SqlConnection”类型

这是程序代码：

```
 private void btnList_Click(object sender, EventArgs e)
    {
        using (var ListBill = new LB402_TestEntities())
        {
            var queryGroups = from Groups in ListBill.LB_Group
                                  select Groups.GroupName;

            foreach (string name in queryGroups)
            {
                lbGroups.Items.Add(name);
            }
        }
    } 
```

app.config 的修改部分是：

```
<defaultConnectionFactory type="IBM.Data.DB2.Entity.DB2ConnectionFactory, EntityFramework" />

<add name="LB402_TestEntities" connectionString="metadata=res://*/LB402.csdl|res://*/LB402.ssdl|res://*/LB402.msl;provider=IBM.Data.DB2;provider connection string=&quot;Server=db210:50000;Database=LISTBILL;uid=uuuuu;pwd=ppppp;&quot;" providerName="System.Data.EntityClient" /> 
```

从我的搜索和阅读来看，我似乎应该能够做到这一点，但我显然错过了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:45:57.087

更改连接字符串是不够的。EDMX 文件由三部分组成，一个是特定于提供程序的（即来自连接字符串的 .ssdl 引用）。您需要为需要支持的每个数据库提供此部分，并且需要为每个此类数据库提供 EF 提供程序。问题是 EDMX 设计器不支持为多个提供者建模。因此，您必须为每个数据库拥有单独的 EDMX = 巨大的重复性，或者您必须开始手动维护其他数据库的 SSDL 文件（它是 XML）。

您应该使用代码优先映射和 DbContext API 进行一些小的概念验证，因为它没有这些障碍 - SSDL 是在运行时从连接字符串中指定的代码映射和提供程序生成的。

# spring - OpenJPA 在启动时禁用创建表

> ID：12641782
> 
> 赞同：0
> 
> 时间：2012-09-28T14:16:21.967
> 
> 标签：spring, openjpa

`spring`我必须在非 Web 应用程序中使用外部数据库。

如何禁用 openjpa 以尝试创建实体表？我的实体`EmailAddress`并`Message`有注释“ `@Entity`”，我不知道它是否正确。

```
<persistence-unit name="myPU" transaction-type="RESOURCE_LOCAL">
        <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
        <class>pack.EmailAddress</class>
        <class>pack.Message</class>
           <properties>
                <property name="javax.persistence.jdbc.user" value="root" />
                <property name="javax.persistence.jdbc.password" value="root" />
                <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/kepsDb" />
                <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver" />
                <property name="openjpa.jdbc.SynchronizeMappings" value="false"/>
            </properties>

        </persistence-unit> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:33:51.640

删除`openjpa.jdbc.SynchronizeMappings`persistence.xml 文件的属性。

# c# - 用分号和分隔符分隔字符串并包含括号

> ID：12641783
> 
> 赞同：0
> 
> 时间：2012-09-28T14:16:28.797
> 
> 标签：c#, regex, parsing

我需要用分号 ( `;`) 作为分隔符来分隔字符串。括号内的分号应该被忽略。

例子：

```
string inputString = "(Apple;Mango);(Tiger;Horse);Ant;Frog;"; 
```

字符串的输出列表应该是：

```
(Apple;Mango)
(Tiger;Horse)
Ant
Frog 
```

其他有效的输入字符串可以是：

```
string inputString = "The fruits are (mango;apple), and they are good" 
```

上面的字符串应该拆分成一个字符串

```
"The fruits are (mango;apple), and they are good"

string inputString = "The animals in (African (Lion;Elephant) and Asian(Panda; Tiger)) are endangered species; Some plants are endangered too." 
```

上面的字符串应该分成两个字符串，如下所示：

```
"The animals in (African (Lion;Elephant) and Asian(Panda; Tiger)) are endangered species"
"Some plants are endangered too." 
```

我搜索了很多，但找不到上述场景的答案。

有谁知道如何在不重新发明轮子的情况下实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:28:21.380

使用与您要保留的内容匹配的正则表达式，而不是分隔符：

```
string inputString = "(Apple;Mango);(Tiger;Horse);Ant;Frog;";

MatchCollection m = Regex.Matches(inputString, @"\([^;)]*(;[^;)]*)*\)|[^;]+");

foreach (Match x in m){
  Console.WriteLine(x.Value);
} 
```

输出：

```
(Apple;Mango)
(Tiger;Horse)
Ant
Frog 
```

表达意见：

```
\(           opening parenthesis
[^;)]*       characters before semicolon
(;[^;)]*)*   optional semicolon and characters after it
\)           closing parenthesis
|            or
[^;]+        text with no semicolon 
```

注意：上面的表达式也接受不带分号的括号中的值，例如`(Lark)`和多个分号，例如`(Lark;Pine;Birch)`。它还将跳过空值，例如`";;Pine;;;;Birch;;;"`将是两个项目，而不是十个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:30:41.140

将带括号的情况与“正常”情况分开处理，以确保在前者中省略分号。

实现此目的的正则表达式（匹配输入中的单个元素）可能如下所示（未经测试）：

```
"\([A-Za-z;]+\)|[A-Za-z]+" 
```

# c# - Fluent NHibernate：创建映射，应该让我创建一个带有两个内部连接到同一个表的查询

> ID：12641789
> 
> 赞同：0
> 
> 时间：2012-09-28T14:16:49.840
> 
> 标签：c#, join, fluent-nhibernate

我有一个 Items 表，其中 ItemID 作为主键

我有一个包含复合主键 StoreID 和 ItemID 的 StoreItems 表。ItemID 使用对 Items 表的外键引用。

我需要创建一个看起来像这样的查询（目标是选择两个商店中存在的项目）

```
select * from Items i
inner join storeitems s1 on s1.ItemID = i.ItemID and s1.StoreID = myfirststoreid
inner join storeitems s2 on s2.ItemID = i.ItemID and s2.StoreID = mysecondstoreid 
```

我怎样才能做流畅的映射来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T08:37:52.500

未经测试。它首先选择 ID，然后获取项目。可以合并为一个语句：

```
var itemsIdsInBothStores =
    from i in session.Query<Item>()
    from s in i.Stores
    where s.Id == myfirststoreid || s.Id == mysecondstoreid
    group i by i.Id into g
    where g.Count() = 2
    select g.Key;

var itemsInBothStores = ´session.QueryOver<Item>().WhereRestrictionOn(i => i.Id).In(itemsIdsInBothStores.ToList()); 
```

# php - 显示大 XML 文件的 Magento 控制器导致浏览器中出现奇怪的渲染

> ID：12641796
> 
> 赞同：1
> 
> 时间：2012-09-28T14:17:11.137
> 
> 标签：php, xml, magento, google-chrome, magento-1.7

我正在处理一个相对广泛但不是巨大的 XML 文件，该文件是使用控制器从 Magento 中的自定义模块交付的。一切进展顺利，我已经能够让它工作并毫无问题地添加节点。浏览器（在本例中为 Chrome）一直在很好地呈现 XML 文档并按预期对其进行样式化。为了通过 Magento 正确显示 XML 标头，我使用以下代码：

```
/* Set display to render output as an XML document */
$this->loadLayout(false);
$this->getResponse()->setHeader('Content-Type','text/xml');
echo "<Magento >";
.
.
.
echo "</Magento>\n";
$this->renderLayout(); 
```

当输出达到 140 个节点时，它会停止呈现为格式化的 XML，并且只显示数据，就好像它正在呈现为 HTML 一样，并且不知道节点定义。例子：

![渲染不正确](../Images/1609913f5aafa33e6772270df60f74f4.png)

如果我注释掉一个节点所以有 139 它将正确呈现。如果我将完整的 140 多个节点 XML 页面保存为一个文件，然后将该文件放入 Chrome，它会正确呈现。例如：

![正确渲染](../Images/c86738dfc68a55dca97eb6b77c2a087f.png)

如果我通过验证器运行 140+ 个节点的 XML 文件，它会作为有效的 XML 代码通过。如果我使用 Firefox 来查看页面，我也会得到相同的渲染显示损坏结果。

这个问题。通过 Magento 控制器传递 XML 文件的大小是否有限制？如果是这样，我可以将此限制重置为超过 139 个节点，以便正确呈现吗？相反，我是否应该担心浏览器是否正确呈现页面，因为它将被不同的程序而不是浏览器使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T17:46:44.897

用 . 检查您的标题`curl`。我猜它没有被设置。

```
curl -I http://example.com 
```

尝试直接设置标题

```
header('Content-Type: text/xml'); 
```

在响应对象上设置标头只会影响通过响应对象传递的内容。由于您`echo`直接编写代码，因此响应对象永远不会有机会发送其标头。

Chrome 和 Firefox 都有一组试探法，试图猜测应该如何呈现文档。即使有一个`text/html`标题，一个简短的 XML 文档也可能被检测为 XML，从而触发 XML 呈现。一旦它达到一定的长度，浏览器就会猜测它是一个 HTML 文档，然后 HTML 呈现引擎接管。

确保正确设置标题应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:36:04.737

通常，当您中断标签（而不是关闭它）或插入不支持的字符时，就会发生此问题。XML 的大小限制未知，也许您的浏览器验证崩溃了。

# knockout.js - 使用 ko.computed 将输入值格式化为百分比

> ID：12641797
> 
> 赞同：3
> 
> 时间：2012-09-28T14:17:11.837
> 
> 标签：knockout.js

我正在尝试显示并编辑从下拉列表中选择的可观察存储视图作为百分比。不太确定如何在计算函数的读/写中获取和引用 observable。这不起作用...

[http://jsfiddle.net/PastorBones/zmdJb/](http://jsfiddle.net/PastorBones/zmdJb/)

### 脚本

```
function viewModel(){
    var self = this;

    self.data = [
        {name: 'Test1', percent: ko.observable(.1)},     
        {name: 'Test2', percent: ko.observable(.543)},         
        {name: 'Test3', percent: ko.observable(.0123)}         
    ];
    self.selOption = ko.observable();
    self.chosenOptions = ko.observableArray();
    self.addData = function(){
        if(typeof(self.selOption) !== 'undefined'){
          self.chosenOptions.push(self.selOption());
          self.selOption(undefined);
        }  
    }
    self.formatAsPercent = ko.computed({
        read: function(obj){
            if(typeof(obj) === 'undefined') return '';                
            return (obj.percent() * 100).toFixed(2) + '%';
        },
        write: function(obj){
            var val = obj.percent().replace('%','');
            obj.percent(val / 100);            
        }
    });
}

ko.applyBindings(new viewModel());
​ 
```

### HTML

```
<select data-bind="options: data, optionsText: 'name', optionsCaption: 'Choose...', value: selOption"></select>
<button data-bind="click: addData, enable: typeof(selOption()) !== 'undefined'">+</button>

<div data-bind="foreach: chosenOptions">
    <div>
        <span data-bind="text: $data.name"></span>
        <input data-bind="value: $root.formatAsPercent($data)" />
    </div>
</div>
​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:49:43.110

要访问子级的属性，计算属性应在*子*级定义。查看修改后的小提琴：http: [//jsfiddle.net/zmdJb/3/](http://jsfiddle.net/zmdJb/3/)

# javascript - Ui-Tabs 中的 Google Maps Api v3 地图被删减

> ID：12641798
> 
> 赞同：1
> 
> 时间：2012-09-28T14:17:17.963
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3, tabs

我知道这是一个常见问题，我已经在这里查看了所有主题以寻求解决方案，但是，当我更改选项卡时，我仍然会遇到这个问题：

![在此处输入图像描述](../Images/58ed2e81ac1a50ad51ebb29829d9788c.png)

请看一下我的js代码：

```
 function initialize() {

//replace 0's on next line with latitude and longitude numbers from earlier on in tutorial.
var myLatlng = new google.maps.LatLng(40.654372, -7.914174);
var myLatlng1 = new google.maps.LatLng(43.654372, -7.914174);
    var myOptions = {
      zoom: 16,
      center: myLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }

    var myOptions1 = {
      zoom: 16,
      center: myLatlng1,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }

//here's where we call the marker.
//getElementById must be the same as the id you gave for the container of the map
var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
var map1 = new google.maps.Map(document.getElementById("map_canvas1"), myOptions1);
 //google.maps.event.trigger(map1, 'resize');
 //map1.setCenter(myLatlng1);

        var marker = new google.maps.Marker({
      position: myLatlng,
      title:"ADD TITLE OF YOUR MARKER HERE"
  });

        var marker1 = new google.maps.Marker({
      position: myLatlng1,
      title:"ADD TITLE OF YOUR MARKER HERE"
  });

        var contentString = '<div id="content">'+
    '<div id="siteNotice">'+
    '<\/div>'+
    '<h2 id="firstHeading" class="firstHeading">ADD TITLE HERE<\/h2>'+
    '<div id="bodyContent">'+
    '<p style="font-size:1em">ADD DESCRIPTION HERE<\/p>'+
    '<\/div>'+
    '<\/div>';

var infowindow = new google.maps.InfoWindow({
    content: contentString
});

google.maps.event.addListener(marker, 'click', function() {
  infowindow.open(map,marker);
});

google.maps.event.addListener(marker1, 'click', function() {
  infowindow.open(map1,marker1);
}); 

google.maps.event.addListener(map, "idle", function(){
    marker.setMap(map); 
});

google.maps.event.addListener(map, "idle", function(){
    marker1.setMap(map1);
});  

  // To add the marker to the map, call setMap();

  google.maps.event.addListenerOnce(map, 'idle', function() {
    google.maps.event.trigger(map, 'resize');
    map.setCenter(myLatlng); // be sure to reset the map center as well
});

google.maps.event.addListenerOnce(map1, 'idle', function() {
    google.maps.event.trigger(map1, 'resize');
    map1.setCenter(myLatlng1); // be sure to reset the map center as well
});

  }

  function loadScript() {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "http://maps.google.com/maps/api/js?sensor=false&callback=initialize";
    document.body.appendChild(script);
  }

  window.onload = loadScript; 
```

我有两张地图，每个标签一张。我可以通过其他帖子解决中心点隐藏在左角的问题：

```
 .ui-tabs .ui-tabs-hide { /* my_tabs-1 contains google map */
    display: block !important;
    position: absolute !important;
    left: -10000px !important;
    top: -10000px !important;
} 
```

但是这里所说的问题我什至没有看这里的其他主题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T14:36:13.543

我找到了干净的解决方案：

```
<script type="text/javascript">
         function showAddressMap(){
                var mapOptions = {    
                          zoom: 15,
                          mapTypeId: google.maps.MapTypeId.ROADMAP
                         }

                var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

                 geocoder = new google.maps.Geocoder();
            // searchQuery is the address I used this in a JSP so I called with $
                 geocoder.geocode( {'address': "${searchQuery}"}, function(results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {
                          map.setCenter(results[0].geometry.location);
                          var marker = new google.maps.Marker({
                              map: map,
                              position: results[0].geometry.location
                          });
                        } else {
                          alert("Geocode was not successful for the following reason: " + status);
                        }
                 });
                 google.maps.event.trigger(map, 'resize');

             //}
          }

          JQ(document).ready(function(){
            JQ('#tabs').tabs();
            JQ('#maptab').bind('click', function() {
                showAddressMap();
            });
          });
        </script>

    <div id="tabs">
        <li><a href="#tabs-1" id="maptab"><fmt:message key="fieldset.map"/></a></li>
    </div>
    <div id="tabs-1">
    <fieldset>
            <div id="map_canvas" style="height:500px; width:100%;"></div>
    </fieldset>
    </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:24:31.927

您需要设置中心并触发调整大小事件。

```
MyMap.setCenter(MyCenterCoords);
google.maps.event.trigger(MyMap, 'resize'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T04:16:30.130

此代码 google.maps.event.trigger(map, 'resize') 应该在 pageshow 中，如下所示。

```
$('#map_result').live('pageshow',function(event){
    google.maps.event.trigger(map, 'resize');
}); 
```

顺便问一下，您找到解决方案了吗？我实际上使用 css 使它工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-27T21:57:16.640

我知道这不是一个优雅的解决方案，但您可以在每个选项卡内添加一个 iframe。当您单击选项卡时，地图会以正确的大小加载。

# symfony - Symfony2 中的 Twig CamelCase 过滤器

> ID：12641802
> 
> 赞同：3
> 
> 时间：2012-09-28T14:17:32.027
> 
> 标签：symfony, twig

所以我对 Symfony2 很陌生，我正在尝试`camelize`在树枝模板中使用过滤器。但是，当我请求该页面时，我收到一条错误消息，指出过滤器不存在：

> ::base.html.twig 中不存在过滤器“camelize”

这是我的模板文件中的行：

> {{ '你好世界' | 骆驼化}}

该过滤器列在 Twig 的[快速参考页面上](https://github.com/vito/chyrp/wiki/Twig-Reference)。

我很困惑，Symfony2 不支持所有 twig 的过滤器吗？好像少了很多，为什么呢？如果它不支持它们，那么有什么办法可以添加缺少的吗？

提前致谢！

**编辑**好的，所以事实证明我是智障，我需要记住检查我是否真的得到了正确的 git 项目。难怪我一头雾水。谢谢回复！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-11-05T16:58:46.773

Symfony 2 具有用于骆驼案例的标题过滤器

```
{{ entity.yourstring | title }} 
```

驼峰式你的字符串

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-28T14:39:36.800

您的链接指向 GitHub 上的一个**分支**，即原始项目的修改副本。原始项目是[https://github.com/fabpot/Twig](https://github.com/fabpot/Twig)。

`camelize`Twig中没有过滤器。内置过滤器在[这里](http://twig.sensiolabs.org/doc/filters/index.html)。您可以按照本教程编写自己的 camilize 过滤器（实际上很简单......）：[如何编写自定义 Twig 扩展](http://symfony.com/doc/current/cookbook/templating/twig_extension.html)。

**编辑**：只是为了好玩，您可以编写如下内容：

```
class MyTwigExtension extends Twig_Extension
{
    public function getFilters()
    {
        return array(
            'camelize' => new Twig_Filter_Method($this, 'camelizeFilter'),
        );
    }

    public function camelizeFilter($value)
    {
        if(!is_string($value)) {
            return $value;
        }

        $chunks    = explode(' ', $value);
        $ucfirsted = array_map(function($s) { return ucfirst($s); }, $chunks);

        return implode('', $ucfirsted);
    }

    public function getName()
    {
        return 'my_twig_extension';
    }
} 
```

请注意，这是一个快速而肮脏的过滤器！查看内置过滤器以了解最佳实践！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-04T13:19:36.793

您要查找的过滤器名为“title”：[http ://twig.sensiolabs.org/doc/filters/title.html](http://twig.sensiolabs.org/doc/filters/title.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-14T23:26:54.180

这是 Craft CMS 3 中默认的最佳解决方案

Craft 3 现在有一个`|camel`树枝过滤器

[https://docs.craftcms.com/v3/dev/filters.html#camel](https://docs.craftcms.com/v3/dev/filters.html#camel)

```
{{ 'foo bar'|camel }}
{# Output: fooBar #} 
```

# android - 在android应用程序中嵌入远程pdf

> ID：12641806
> 
> 赞同：0
> 
> 时间：2012-09-28T14:17:46.053
> 
> 标签：android, pdf

我正在尝试在我的应用程序中嵌入远程 pdf,,,,

这是我在谷歌搜索后尝试过的 -

```
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.pdf);

    Intent intent = new Intent(Intent.ACTION_VIEW);
    intent.setDataAndType(Uri.parse("http://mydomain.com/downloads/abc.pdf"), "application/pdf");
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);

        try {
            startActivity(intent);
        } 
        catch (ActivityNotFoundException e) {
            Toast.makeText(TestPdf.this, 
                "No Application Available to View PDF", 
                Toast.LENGTH_SHORT).show();
        }
} 
```

总是进入 catch 块，，

我也得到了使用“https://docs.google.com/viewer/....”的解决方案，它可以工作，但谷歌提供了下载 pdf 的选项，，，

我正在寻找一个解决方案来拥有一个 Activity（包含我的页眉和页脚），它将嵌入远程 pdf（不允许下载），，，，

谢谢

# sql - 报告服务中的日期时间参数

> ID：12641809
> 
> 赞同：-1
> 
> 时间：2012-09-28T14:17:54.487
> 
> 标签：sql, reporting-services, parameters, format

我需要在报告服务的日期时间参数中指定时间。当用户选择开始日期和结束日期时，我有两个参数作为开始日期和结束日期。报告服务自动将时间指定为 12:00:00，我想更改为有一些默认时间，而不是 12:00:00，此外，我正在调用带有参数的存储过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:47:14.920

如果将参数传递给存储过程，则更新该值以添加默认时间，然后再在查询中使用它。

你可以通过两种方式做到这一点

```
 `SET @StartDate = @StartDate + '6:00:00.00'` -- Adds 6 Hours or

 SET @StartDate = DATEADD(Hour,6,@StartDate)
 SET @StartDate = DATEADD(Minute,30,@StartDate)
 SET @StartDate = DATEADD(Second,45,@StartDate) 
```

以上将 06:30:45 添加到 @StartDate 参数。

您可以对 @EndDate 参数执行相同的操作。

# ios - iOS模拟器和gps

> ID：12641817
> 
> 赞同：12
> 
> 时间：2012-09-28T14:18:22.727
> 
> 标签：ios, xcode, gps, simulator

如何在 iOS 模拟器上模拟 GPS 运动？我正在开发一个使用 gps 的应用程序，我需要在用户位置发生变化时对其进行测试。我该怎么做？先感谢您..

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-28T14:47:32.947

From the `Features > Location` menu of the iOS Simulator, check the `Location` menu:

^(**Note**: The screenshot below is outdated, however the path above has been updated to reflect the proper menu location for this option.)

![Debug menu of iOS Simulator](../Images/cc6cc26897372363bb487a95a66faa23.png)

It provides you with several options pertaining to changing the location of the simulated device.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-05-18T18:09:16.480

对于那些在 2020 年来到这里的人，情况发生了一些变化，您可以在“功能”下找到修改位置设置的选项[![在此处输入图像描述](../Images/dc60ea84b8a8f2c3484bf0b47357771d.png)](https://i.stack.imgur.com/lJLY8.png)

# c++ - 如何保证进程调用malloc()时，会立即分配物理内存？

> ID：12641820
> 
> 赞同：2
> 
> 时间：2012-09-28T14:18:31.310
> 
> 标签：c++, windows, memory-management, malloc

我正在寻找一种将内存预分配给进程（物理内存）的方法，以便在我调用 new/malloc 时绝对保证它对 C++ 堆可用。无论其他进程试图对系统内存做什么，我都需要这个内存可供我的进程使用。换句话说，我想为 C++ 堆保留物理内存，以便在我调用 malloc() 时它立即可用。以下是详细信息：

我正在开发一个实时系统。该系统由几个需要大量内存的进程组成。进程 A 是关键任务进程，它必须能够生存并且不受任何其他进程的不良行为的影响。它通常适合 0.5 GB 的内存，但有时需要多达 2.5 GB。其他进程尝试使用任意数量的内存。

我担心其他进程可能会分配大量内存，从而耗尽系统中的物理内存储备。然后，当进程 A 需要更多内存 FAST 时，它不可用，系统将不得不交换页面，这将需要很长时间。至关重要的是，进程 A 必须立即获得它需要的所有内存，而我对其他进程失败感到满意。

我在 Windows 7 64 位上运行。

编辑： SetProcessWorkingSetSize 会起作用吗？含义：调用它以获得足够大的内存量可以保护我的进程 A 免受系统中任何其他进程的影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:25:58.160

[VirtualLock](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366895%28v=vs.85%29.aspx)是您正在寻找的。它将强制操作系统将页面保留在内存中，只要它们处于工作集大小（这是 MK 在他的回答中链接到的函数）。但是，没有办法将此内存提供给`malloc`/ `new`- 您必须实现自己的内存分配器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:25:27.317

我认为这个问题很奇怪，因为 Windows 7 并不是实时应用程序的首选操作系统。也就是说，似乎有一个界面可以帮助您：

[AllocateUserPhysicalPages](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366528%28v=vs.85%29.aspx)

# objective-c - 在 iOS setter 方法中保留发布常见做法

> ID：12641826
> 
> 赞同：0
> 
> 时间：2012-09-28T14:19:00.213
> 
> 标签：objective-c, ios, memory-management

IOS setter 中的常见做法如下：

```
- (void)setMyString:(NSString *)newString {
    if ( newString != myString ) {
        [myString release];
        myString = [newString retain];
    }
} 
```

相反，这不是好的做法

```
- (void)setMyString:(NSString *)newString {
    if ( myString != nil ) [myString release];
        myString = [newString retain];
    }
} 
```

在第一种情况下检查平等的原因是什么？秒的情况下有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:26:09.277

如果你在`[object setMyString:[object myString]];`不检查相等的情况下设置这样的东西 - 它会崩溃！因为它会在你发送消息之前被释放。（如果只有对象自己的字符串）。同样在第一个示例中，我们检查相等性以避免额外的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:50:02.733

您可以将其用于内存管理，[https://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/](https://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T17:34:51.027

我知道这有点多余，但是...

如果新对象和旧对象相同，那么您发送`release`给旧对象并且它被释放，指向新对象的指针将成为一个悬空指针，因为它指向的对象将不再存在（因为它指向同一个对象作为旧的对象指针）。前任。如果`myString`和`newString`指向保留计数为 1 的同一实例，则减去 1，它将等于 0。现在添加一个为时已晚，因为它会被释放。`retain`但是，反转对and的调用`release`应该没问题。如果保留计数为 1，而您添加了 1，则现在为 2，您可以安全地发送 release。一般来说，我会说，在你放弃一个对象之前，先声明对新对象的所有权。

此外，第一种类型的设置器将是您将用于`retain`/`strong`样式设置器的类型。如果是这样，`assign`您就不需要保留/释放，因为不应该断言所有权。NSStrings 通常有一个`copy`样式设置器，它复制参数并使用它，这将创建一个副本而不是保留。我通常会使用`copy`任何具有可变子类的东西，因为你不希望有人传入 NSMutableString 并在你背后改变它。[此页面](http://cocoawithlove.com/2010/06/assign-retain-copy-pitfalls-in-obj-c.html)进入访问器，您会注意到它们在释放旧值之前保留了新值，并解释了原因。

# c++ - 使用 C++ 替换字符串文字中的几个字符

> ID：12641828
> 
> 赞同：0
> 
> 时间：2012-09-28T14:19:04.087
> 
> 标签：c++

我有

```
cost char* a="test_r.txt" 
```

我想剥离 _r 并添加 _n 而不是它，使其变为“test_n.txt”并将其保存在 const char* b 中；

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:21:58.707

您不能直接修改 的内容`a`，因此您需要进行一些复制：

```
std::string aux = a;
aux[5] = 'n';
const char* b = aux.c_str(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:42:33.233

就像之前提到的，如果你把你的`const char *`放入一个`std::string`，你可以改变你的字符。关于替换长于一个字符的常量，您可以使用以下`find`方法`std::string`：

```
const char *a =  "test_r_or_anything_without_r.txt";

std::string a_copy(a); 
std::string searching("_r");
std::string replacing("_n");
size_t pos_r = 0;

while (std::string::npos != (pos_r = a_copy.find(searching, pos_r)))
{
    a_copy.replace(a_copy.begin() + pos_r,
                   a_copy.begin() + pos_r + searching.length(),
                   replacing.begin(), replacing.end());
}

const char *b = a_copy.c_str(); 
```

# javascript - 如何在 jQuery 插件中创建全局对象？

> ID：12641830
> 
> 赞同：0
> 
> 时间：2012-09-28T14:19:12.803
> 
> 标签：javascript, jquery, jquery-plugins

如何`o`在 jQuery 插件范围之外使用对象？我有以下片段：

```
 var o ={};

(function ($) {
$.fn.extend({

    gridView: function (options) {
        var defaults = {
            grid :{
                renderTo : '#container', 
            },
            gridHeader: {
            ************
            ***********

        };

        var options = $.extend(defaults, options);

        return this.each(function () {
            o = options; // i was expecting this step to fill the object 
            var obj = $(this);

            if( o.search.enabled){$(o.grid.renderTo).
         append('<div class="headerSearch">
     <input name="tbSearch" type="text" onchange="" onkeypress="do_this();" 
     id="tbSearch"><img src="'+ o.search.imgUrl +'" alt="Search"></div>')

          })(jQuery);
       console.log(o) ; // this gives me an empty object 
```

我的另一个问题是，如何以及在何处创建一个可以调用的函数，`onkeypress` 以便该`do_this();`函数也可以看到该对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:27:29.387

这没有任何意义，也行不通。您的 jQuery 代码在稍后的某个时间通过 a 调用（大概），`$("selector").gridView()`那*是*您的插件执行的时候。在那之前，您的内部没有任何东西`gridView: function`运行，并且`o`当您的代码达到`console.log(o)`.

如果你想保留一些与元素相关的数据，你应该使用`$.data`来获取和设置你的插件绑定到的元素上的数据属性。[jQuery 插件创作](http://docs.jquery.com/Plugins/Authoring#Data)页面中的数据部分将非常有用。

# jsonp - 为什么CORS是基于目标服务器的？为什么我必须使用 JSONP？

> ID：12641831
> 
> 赞同：2
> 
> 时间：2012-09-28T14:19:14.833
> 
> 标签：jsonp, cors

如果可能的话，我想在答案中举一个具体的例子。

为了解释起见，我们这里有三个玩家。

*   我的服务器 (myserver.com)
*   客户端服务器 (myclient.com)
*   客户用户（通过 myclient.com 访问数据）

我正在为我的客户提供一个 Web 服务，允许他们以 JSON 格式检索他们的数据。为了让他们的网站正常工作，他们必须使用标准的 XOR 解决方法——要么在服务器端发出请求，要么依靠我来设置

```
Access-Control-Allow-Origin: http://myclient.com 
```

所以这里有两部分问题。首先，为什么要*在*myserver.com 设置源策略？为什么我的服务器关心它向谁提供内容？不应该是 myclient.com 设置这个吗？这里的具体例子会很棒。

第二部分，我知道 JSONP 可以解决这个问题，但我担心使用它，因为我不了解第一部分的安全含义。如果我可以设置 JSONP 有什么意义`Access-Control-Allow-Origin: *`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:30:28.787

很多问题！

1.  如果您打算提供特定于用户的内容，JSONP 绝对是危险的。如果服务器提供的内容是完全公开的，并且（可能）是只读的，那么 JSONP 是一个明智的选择。不要将它用于任何假设“登录状态”或身份验证/授权的事情。

2.  CORS 绝对比 JSONP 好得多，但并非所有（旧版）浏览器都支持它。如果您想尽可能多地支持，您将需要某种回退。CORS 允许您执行 GET 以外的请求，这极大地提高了灵活性。

3.  目标服务器需要允许这样做的原因，主要是因为在域 A 上运行的 javascript 不应该能够访问域 B。如果域 A 可以“允许”这样做，则意味着您可以创建可以访问沙箱的 javascript 应用程序任何*公共服务器*。只有域 B 的所有者才能明确允许域 A 的所有者访问其内容。

4.  您的论点（为什么域 B 关心谁访问他们的资源）通常是有效的。但这不是保护域 B，而是保护最终用户。未经明确许可，不应允许域 A 代表最终用户对域 B 执行请求。

只是为了确定：除非您非常了解 JSONP 的安全含义，否则 CORS 可能是一个更安全的选择。

# ios - IOS 6 上的应用程序崩溃 - UIViewControllerHierarchyInconsistency

> ID：12641833
> 
> 赞同：5
> 
> 时间：2012-09-28T14:19:24.677
> 
> 标签：ios, ios6, uiviewcontroller

我的应用程序运行良好，直到我更新到 Xcode 4.5 并在 IOS 6 上运行它。现在它崩溃并出现异常 - UIViewControllerHierarchyInconsistency - 一个视图一次最多只能与一个视图控制器相关联。

有谁知道为什么以及如何解决它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-28T14:48:35.317

好吧，我解决了这个问题 - 显然你需要删除 XIB 文件中的 UIViewController，只留下视图。

# vb.net - 在 try / finally 块中抛出双重异常

> ID：12641834
> 
> 赞同：4
> 
> 时间：2012-09-28T14:19:25.520
> 
> 标签：vb.net, exception, try-finally

这是代码示例：

```
Try
    Throw New FirstException()
Finally
    Throw New SecondException()
End Try 
```

我发现它只会抛出 SecondException 而 FirstException 就消失了。

我认为 FirstException 会在 SecondException 的 InnerException 属性内，但它似乎不是。

我没有阻止任何事情，因为我真的不需要出现 FirstException，我只是对这种行为很感兴趣。

*   有没有办法知道 SecondException 在上层捕获它时确实首先被抛出？

*   如果第一个异常确实被第二个覆盖，原因是什么？

*   它发生在所有其他语言中吗？合乎逻辑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:51:05.287

我想为什么这种方式起作用的主要解释是你永远不会捕捉到你的第一个异常并沿着链传递它。如果您遇到上述情况，您可能会在返回原始调用者的途中抛出几个异常，那么您必须在它们被抛出时捕获它们（并在创建下一个异常时将它们作为内部异常包含在内）：

```
Dim ex1 As Exception = Nothing
Try
    Throw New Exception("first exception")
Catch ex As Exception
    ex1 = ex
Finally
    Throw New Exception("second exception", ex1)
End Try 
```

或者，可能更好 - 只是在找出所有异常之前不要抛出：

```
Dim ex1 As Exception = Nothing
Try
    ex1 = New Exception("first exception")
Finally
    Throw New Exception("second exception", ex1)
End Try 
```

抛出和捕获异常是昂贵的，所以最好不要抛出，直到你准备好返回并沿途记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:29:43.393

.net 中异常处理的限制之一是块中的代码没有很好的方法`Finally`来知道是什么异常（如果有的话）导致`Try`块中的代码退出，也没有任何正常的方法来处理 finally 中的代码块确实具有此类信息以使其可用于可能引发异常的代码。

在 vb.net 中，尽管看起来有点丑陋，但可以以一种非常有效的方式组合事物。

```
Module ExceptionDemo
    Function CopySecondArgToFirstAndReturnFalse(Of T)(ByRef dest As T, src As T) As Boolean
        dest = src
        Return False
    End Function
    Function AnnotateExceptionAndReturnFalse(ex As Exception, TryBlockException As Exception) As Boolean
        If ex Is Nothing Then Return False ' Should never occur
        If TryBlockException Is Nothing Then Return False ' No annotation is required
        ex.Data("TryBlockException") = TryBlockException
        Return False
    End Function

    Sub ExceptionTest(MainAction As Action, CleanupAction As Action)
        Dim TryBlockException As Exception = Nothing
        Try
            MainAction()
        Catch ex As Exception When CopySecondArgToFirstAndReturnFalse(TryBlockException, ex)
            ' This block never executes, but above grabs a ref to any exception that occurs
        Finally
            Try
                CleanupAction()
            Catch ex As Exception When AnnotateExceptionAndReturnFalse(ex, TryBlockException)
                ' This block never executes, but above performs necessary annotations
            End Try
        End Try
    End Sub

    Sub ExceptionTest2(Message As String, MainAction As Action, CleanupAction As Action)
        Debug.Print("Exception test: {0}", Message)
        Try
            ExceptionTest(MainAction, CleanupAction)
        Catch ex As Exception
            Dim TryBlockException As Exception = Nothing
            Debug.Print("Exception occurred:{0}", ex.ToString)
            If ex.Data.Contains("TryBlockException") Then TryBlockException = TryCast(ex.Data("TryBlockException"), Exception)
            If TryBlockException IsNot Nothing Then Debug.Print("TryBlockException was:{0}", TryBlockException.ToString)
        End Try
        Debug.Print("End test: {0}", Message)
    End Sub
    Sub ExceptionDemo()
        Dim SuccessfulAction As Action = Sub()
                                             Debug.Print("Successful action")
                                         End Sub
        Dim SuccessfulCleanup As Action = Sub()
                                              Debug.Print("Cleanup is successful")
                                          End Sub
        Dim ThrowingAction As Action = Sub()
                                           Debug.Print("Throwing in action")
                                           Throw New InvalidOperationException("Can't make two plus two equal seven")
                                       End Sub
        Dim ThrowingCleanup As Action = Sub()
                                            Debug.Print("Throwing in cleanup")
                                            Throw New ArgumentException("That's not an argument--that's just contradiction")
                                        End Sub
        ExceptionTest2("Non-exception case", SuccessfulAction, SuccessfulCleanup)
        ExceptionTest2("Exception in main; none in cleanup", ThrowingAction, SuccessfulCleanup)
        ExceptionTest2("Exception in cleanup only", SuccessfulAction, ThrowingCleanup)
        ExceptionTest2("Exception in main and cleanup", ThrowingAction, ThrowingCleanup)
    End Sub
End Module 
```

上面的模块从几个帮助模块开始，它们可能应该在它们自己的“异常帮助器”模块中。`Try`ExceptionTest 方法显示了可能在and`Finally`块中引发异常的代码模式。ExceptionTest2 方法调用 ExceptionTest 并报告从它返回的异常。`Try`ExceptionDemo 调用 ExceptionTest2 的方式是在和`Finally`块的不同组合中引起异常。

如图所示，如果在清理过程中发生异常，该异常将返回给调用者，原始异常是其`Data`字典。另一种模式是捕获清理时发生的异常并将其包含在原始异常的数据中（不会被捕获）。我的一般倾向是，在许多情况下，传播清理期间发生的异常可能会更好，因为任何计划处理原始异常的代码都可能期望清理成功；如果无法满足这样的期望，则逃逸的异常可能不应该是调用者所期望的异常。另请注意，后一种方法需要稍微不同的方法来向原始异常添加信息，因为嵌套块中引发的异常`Try`可能需要保存有关嵌套`Finally`块中引发的多个异常的信息。

# rvm - 使用 Capistrano 定义捆绑路径

> ID：12641837
> 
> 赞同：3
> 
> 时间：2012-09-28T14:19:26.923
> 
> 标签：rvm, capistrano, bundler

我在我的 deploy.rb 文件中为 capistrano 使用以下配置：

```
require 'bundler/capistrano'
require 'rvm/capistrano'

set :bundle_cmd, "/home/deployment/.rvm/gems/ruby-1.9.3-p194@global/bin/bundle"

set :default_environment, {
    'PATH' => "/home/deployment/.rvm/gems/ruby-1.9.3-p194/bin:/home/deployment/.rvm/bin:$PATH",
    'RUBY_VERSION' => 'ruby 1.9.3',
    'GEM_HOME' => "/home/deployment/.rvm/gems/ruby-1.9.3-p194",
    'GEM_PATH' => "/home/deployment/.rvm/gems/ruby-1.9.3-p194",
    'BUNDLE_PATH' => "/home/deployment/.rvm/gems/ruby-1.9.3-p194"
} 
```

但是当我跑步时，`cap deploy:update`我得到了这个：

```
* executing "cd /var/www/currienet/marketplace/releases/20120928140140 && /home/deployment/.rvm/gems/ruby-1.9.3-p194@global/bin/bundle install --gemfile /var/www/currienet/marketplace/releases/20120928140140/Gemfile --path /var/www/currienet/marketplace/shared/bundle --deployment --quiet --without development test" 
```

也就是说，它没有将捆绑路径（ --path 参数）设置为我想要的。

我尝试了许多教程，包括[rvm capistrano 教程](https://rvm.io/integration/capistrano/#gem)，但似乎没有任何效果。它继续使用 capistrano 默认值。

Capistrano 还使用以下 .bundler/config 创建了一个应用程序

```
BUNDLE_FROZEN: '1'
BUNDLE_PATH: /var/www/currienet/marketplace/shared/bundle
BUNDLE_DISABLE_SHARED_GEMS: '1'
BUNDLE_WITHOUT: development:test 
```

开发机器：Windows 7, bundler (1.0.22), capistrano (2.12.0), rvm-capistrano (1.2.7), rails (3.2.8), (no rvm)

生产：Debian、bundler (1.2.1) (no capistrano)、(no rvm-capistrano)、rails (3.2.8)、rvm 1.16.5

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T02:30:44.123

感谢[Joseph Holsten 的博客](http://web.archive.org/web/20120622085031/http://blog.josephholsten.com/2010/09/deploying-with-bundler-and-capistrano)，我能够确定我的问题是在我需要“bundler/capistrano”之前我没有在 deploy.rb 中定义捆绑器变量。我还需要定义 bundle_dir 变量，以创建如下所示的代码：

```
set :bundle_cmd, "/home/deployment/.rvm/gems/ruby-1.9.3-p194@global/bin/bundle"
set :bundle_dir, "/home/deployment/.rvm/gems/ruby-1.9.3-p194"

require 'bundler/capistrano' 
```

# javascript - 使用预定义数组的随机值在间隔中为“背景位置”设置动画

> ID：12641841
> 
> 赞同：0
> 
> 时间：2012-09-28T14:19:30.810
> 
> 标签：javascript, jquery, setinterval, background-position

我想**在间隔中随机设置身体的背景位置动画**。有一些预定义的背景位置值 (x, y) 存储在一个数组中。

这是到目前为止的脚本：

```
$(document).ready(function() {
    var xyz = new Array();
    xyz[1] = "backgroundPosition: '0% 0%'";
    xyz[2] = "backgroundPosition: '53% 34%'";
    var item = xyz[Math.floor(Math.random()*xyz.length)];

    var move = setInterval(function(){
        $('body').animate({item}, 2000);
    }, 7000);
}); 
```

有人可以告诉我问题出在哪里吗？有什么代码优化？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:21:41.943

您不是每次都设置项目。修改后的代码。在您的代码项中仅设置一次。在 setInterval 内移动该行将每次更改项目集。

```
 $(document).ready(function() {
        var xyz = new Array();
        xyz[1] = {"backgroundPosition": '0% 0%'};
        xyz[2] = {"backgroundPosition": '53% 34%'};     

        var move = setInterval(function(){
            var item = xyz[Math.floor(Math.random()*xyz.length)];
            $('body').animate(item, 2000);
        }, 7000);
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:25:21.407

每次都应该重新定义项目。而且，`Math.floor(Math.random()*xyz.length)`可以是 0，所以我在您的计算中添加了 1+，因为您从 xyz 上的键 1 开始。

```
 $(document).ready(function() {
        var xyz = new Array();
        xyz[1] = {backgroundPosition: '0% 0%'};
        xyz[2] = {backgroundPosition: '53% 34%'};     

        var move = setInterval(function(){
            var item = xyz[1+Math.floor(Math.random()*(xyz.length-1))];
            $('body').animate(item, 2000);
        }, 7000);
    }); 
```

# javascript - 正则表达式测试新密码

> ID：12641842
> 
> 赞同：0
> 
> 时间：2012-09-28T14:19:40.803
> 
> 标签：javascript, regex

您好，我正在开发一个用于测试密码字段的 javascript。但是我似乎无法让它工作。页面加载没有任何不好的事情发生，但脚本似乎无法正常工作。这是我到目前为止所写的。我希望它检查大小写字母、数字和非正则表达式。长度并不重要，只是它各有一个。这是我到目前为止所写的。

**更新：找到了一种更简单的脚本编写方式。每当密码字段错误时，我都能得到它来提醒我。但是我无法让真实的陈述在单击文档按钮的位置起作用。**

```
var str= passwordFieldForm;
    var patt=/[a-z]/g;
    var patt2 = /[A-Z]/g; 
    var patt3 = /[0-9]/g; 
    var patt4 = /[~\!@#\$%\^&*_\-\+=`\|\\(\)\{\}\[\]:;"'<>,\.\?\/]/g; 

    var result=patt.test(str);
    var result2=patt2.test(str);
    var result3=patt3.test(str);
    var result4=patt4.test(str);

    if (!result)
      alert("Needs a lowercase letter");

    if (!result2)
      alert("Needs a Uppercase Letter")

    if (!result3)
      alert("Needs a Number.")

    if (!result4)
      alert("Needs a special character")

    if (result) && (result2) && (result3) && (result4) == true
      document.getElementById("kioskform:broswerPasswordSubmit").click(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:34:55.140

这可能更接近你想要的，我没有测试过，但它应该更朝着正确的方向：

```
function test(password)
{
    var patt1 = /[a-z]/g;
    var patt2 = /[A-Z]/g;
    var patt3 = /[0-9]/g;
    var patt4 = /[~\!@#\$%\^&*_\-\+=`\|\\(\)\{\}\[\]:;"'<>,\.\?\/]/g;

    if (!patt1.test(password)) {
        return ("You need a lowercase letter.");
    }

    if (!patt2.test(password)) {
        return ("You need an uppercaseletter.");
    }

    if (!patt3.test(password)) {
        return ("You need a number.");
    }

    if (!patt4.test(password)) {
        return ("You need to use a one of the following characters '~!@#$%^&*_-+=`|\(){}[;.");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:22:04.930

这条线路有问题：

```
return ("you need to use a one of the following characters '~!@#$%^&*_-+=`|\(){}[]:;"'<>,.?/'.") 
```

您需要转义引号和其中的斜线。

```
return ("you need to use a one of the following characters '~!@#$%^&*_-+=`|\\(){}[]:;\"'<>,.?/'.") 
```

您也可以使用`==`而不是`=`进行比较，`true`而不是`"true"`. 并养成始终使用 { } 作为 if 语句内容的习惯，而不是依赖制表符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:25:28.147

您需要在上一次正则表达式测试中转义其中的几个字符：

```
 var patt4 = /[~!@#$%\^&\*_-\+=`\|\(\)\{\}\[\]\:;"'<>,\.\?\/]/g; 
```

如果有疑问，请使用反斜杠转义字符`\`。如果您逃脱了不需要转义的角色，则不会发生任何事情。

# java - 堆大小问题 - 使用 java 进行内存管理

> ID：12641843
> 
> 赞同：4
> 
> 时间：2012-09-28T14:19:40.373
> 
> 标签：java, web-services, memory-management

我的应用程序中有以下代码，它做了两件事：

解析具有“n”个数据的文件。

对于文件中的每个数据，将有两个 Web 服务调用。

```
 public static List<String> parseFile(String fileName) {
   List<String> idList = new ArrayList<String>();
   try {
     BufferedReader cfgFile = new BufferedReader(new FileReader(new File(fileName)));
     String line = null;
     cfgFile.readLine();
     while ((line = cfgFile.readLine()) != null) {
       if (!line.trim().equals("")) {
         String [] fields = line.split("\\|"); 
         idList.add(fields[0]);
       } 
     } 
     cfgFile.close();
   } catch (IOException e) {
     System.out.println(e+" Unexpected File IO Error.");
   }
 return idList;
} 
```

当我尝试解析具有 100 万行记录的文件时，java 进程在处理一定数量的数据后失败。我有`java.lang.OutOfMemoryError: Java heap space`错误。我可以部分地弄清楚由于提供了如此庞大的数据，java进程停止了。请建议我如何处理这些庞大的数据。

**编辑：**这部分代码是否会`new BufferedReader(new FileReader(new File(fileName)));`解析整个文件并受到文件大小的影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:26:47.023

您遇到的问题是您正在累积列表中的所有数据。解决此问题的最佳方法是以流媒体方式进行。这意味着不要累积列表中的所有 id，而是在每一行上调用您的 Web 服务或累积一个较小的缓冲区，然后进行调用。

打开文件并创建 BufferedReader 不会影响内存消耗，因为文件中的字节将被逐行读取（或多或少）。问题在于代码中的这一点，`idList.add(fields[0]);`当您不断将所有文件数据累积到其中时，列表将与文件一样大。

您的代码应该执行以下操作：

```
 while ((line = cfgFile.readLine()) != null) {
   if (!line.trim().equals("")) {
     String [] fields = line.split("\\|"); 
     callToRemoteWebService(fields[0]);
   } 
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:36:14.793

使用 -Xms 和 -Xmx 选项增加 Java 堆内存大小。如果未明确设置，jvm 会将堆大小设置为符合人体工程学的默认值，在您的情况下这还不够。阅读本文以了解有关在 jvm 中调整内存的更多信息：[http ://www.oracle.com/technetwork/java/javase/tech/memorymanagement-whitepaper-1-150020.pdf](http://www.oracle.com/technetwork/java/javase/tech/memorymanagement-whitepaper-1-150020.pdf)

编辑：以生产者 - 消费者方式执行此操作以利用并行处理的替代方法。一般的想法是创建一个生产者线程来读取文件并将任务排入队列以进行处理，并创建一个消费它们的消费者线程。一个非常一般的想法（用于说明目的）如下：

```
// blocking queue holding the tasks to be executed
final SynchronousQueue<Callable<String[]> queue = // ...

// reads the file and submit tasks for processing
final Runnable producer = new Runnable() {
  public void run() {
     BufferedReader in = null;
     try {
         in = new BufferedReader(new FileReader(new File(fileName)));
         String line = null;
         while ((line = file.readLine()) != null) {
             if (!line.trim().equals("")) {
                 String[] fields = line.split("\\|"); 
                 // this will block if there are not available consumer threads to process it...
                 queue.put(new Callable<Void>() {
                     public Void call() {
                         process(fields);
                     }
                  });
              } 
          }
     } catch (InterruptedException e) {
         Thread.currentThread().interrupt());
     } finally {
         // close the buffered reader here...
     }
  }
}

// Consumes the tasks submitted from the producer. Consumers can be pooled
// for parallel processing.
final Runnable consumer = new Runnable() {
  public void run() {
    try {
        while (true) {
            // this method blocks if there are no items left for processing in the queue...
            Callable<Void> task = queue.take();
            taks.call();
        }
    } catch (InterruptedException e) {
        Thread.currentThread().interrupt();
    }
  }
} 
```

当然，您必须编写代码来管理消费者和生产者线程的生命周期。正确的方法是使用 Executor 来实现它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:26:32.863

当您想使用大数据时，您有 2 个选择：

1.  使用足够大的堆来容纳所有数据。这将“工作”一段时间，但如果你的数据大小是无限的，它最终会失败。
2.  以增量方式处理数据。任何时候仅将部分数据（有限大小）保留在内存中。这是理想的解决方案，因为它可以扩展到任何数量的数据。

# objective-c - 订购 Core-Image 以仅在 GPU 上处理图像

> ID：12641853
> 
> 赞同：0
> 
> 时间：2012-09-28T14:20:27.937
> 
> 标签：objective-c, core-image

我在互联网上找到了一些信息，如果 Core-Image 的任何尺寸大于 2048（宽度或高度或两者），则 Core-Image 在 CPU 上处理图像。它看起来是真的，因为即使在 3200x2000 图像上应用 CIFilter 也非常慢。如果我在 2000x2000 图像上做同样的事情，它会快得多。是否可以告诉 Core-Image 始终处理 GPU 上的所有图像？或者我发现的信息不正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:26:39.540

GPU 上的处理并不总是更快，因为您的图像数据首先必须加载到 GPU 内存，进行处理，然后再传回。

您可以使用`kCIContextUseSoftwareRenderer`强制软件渲染（在 CPU 上），但恐怕没有常量可以强制在 GPU 上渲染。此外，软件渲染在模拟器中不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-05T01:04:06.893

最大尺寸取决于您正在使用的设备。对于 iPhone 3GS/4 和 iPad 1，它是 2048*2048。对于后来的 iPhone/iPad，它是 4096*4096。在 OSX 上，这取决于您的显卡和/或操作系统版本（2、4、8 或 16K²）。

绕过限制的一种可能方法是将图像平铺成低于限制的部分，并分别处理每个平铺。然后你必须在之后将这些部分重新组合在一起。

# javascript - Google Map API - Zoomstart - 在触发前捕捉缩放事件

> ID：12641854
> 
> 赞同：0
> 
> 时间：2012-09-28T14:20:29.123
> 
> 标签：javascript, google-maps-api-3, zooming

我需要排除一个缩放级别。因此，我需要捕获缩放事件，检查我是否要外出或进入并将地图转发到下一个合法缩放级别。

看来该`zoomstart`活动不再起作用了...有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T08:07:18.223

如果找到解决方法......诀窍是使用全局变量。在这种情况下，我想排除`MIN_ZOOM_LEVEL+1`.

```
var last_zoom_level;
google.maps.event.addListener(map, 'zoom_changed', function() {

    if(map.zoom == MIN_ZOOM_LEVEL+1) {
        if(last_zoom_level == MIN_ZOOM_LEVEL)
            map.setZoom(MIN_ZOOM_LEVEL+2);
        else if(last_zoom_level >= MIN_ZOOM_LEVEL+2)
            map.setZoom(MIN_ZOOM_LEVEL);
    }

    last_zoom_level = map.getZoom(); } 
```

# c# - 获取下一个“版本”（.NET Regex）

> ID：12641856
> 
> 赞同：1
> 
> 时间：2012-09-28T14:20:45.910
> 
> 标签：c#, .net, regex, vb.net

我需要从一个字符串`version`（最多 3 个字符，如 sql varchar(3)）中获取具有以下简单规则的“下一个版本”：

如果它的最后一个字符构成一个数字，则增加它，如果它总是最多适合 3 个字符，否则，保持原样。

说 "Hi1" => "Hi2", "H9" => "H10" 但 "xx9" 将保持不变。

```
 Public Shared Function GetNextVersion(oldVersion As String) As String
    Dim newVersion As String = String.Empty
    If Regex.IsMatch(oldVersion, "?????") Then
      Return newVersion
    Else
      Return oldVersion
    End If
  End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:23:32.353

这将是您的正则表达式，它将匹配带有一组字母后跟一组数字的任何内容。

```
Public Dim regex As Regex = New Regex( _
      "^(?<prefix>.*?0*)(?<version>\d+)$", _
      RegexOptions.IgnoreCase _
        Or RegexOptions.CultureInvariant _
        Or RegexOptions.Compiled _
    ) 
```

它将包含两个命名的捕获组，“前缀”是初始字符，“版本”是您的版本。

将版本转换为 int，递增，并通过连接前缀和新版本返回新版本号。

所以，你最终会得到这样的东西

```
Public versionRegex As Regex = New Regex( _
   "^(?<prefix>.*?0*)(?<version>\d+)$", _
   RegexOptions.IgnoreCase _
     Or RegexOptions.CultureInvariant _
     Or RegexOptions.Compiled _
 )

Public Shared Function GetNextVersion(oldVersion As String) As String
    Dim matches = versionRegex.Matches(oldVersion)
    If (matches.Count <= 0) Then
        Return oldVersion
    End If

    Dim match = matches(0)
    Dim prefix = match.Groups.Item("prefix").Value
    Dim version = CInt(match.Groups.Item("version").Value)

    Return String.Format("{0}{1}", prefix, version + 1)
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:05:29.943

我不会使用正则表达式 正则
表达式是一个解析器，这比解析更具逻辑性
对于 3 个字符，正则表达式并不比蛮力快

战略就是绩效。
必须测试边缘情况并且有很多。
先做便宜货。
显然这是 C#

认为得到了所有的测试用例。

```
static void Main(string[] args)
    {
        System.Diagnostics.Debug.WriteLine(NewVer("H"));
        System.Diagnostics.Debug.WriteLine(NewVer("Hi"));
        System.Diagnostics.Debug.WriteLine(NewVer("Hii"));
        System.Diagnostics.Debug.WriteLine(NewVer("Hiii"));
        System.Diagnostics.Debug.WriteLine(NewVer("H1"));
        System.Diagnostics.Debug.WriteLine(NewVer("H9"));
        System.Diagnostics.Debug.WriteLine(NewVer("Hi1"));
        System.Diagnostics.Debug.WriteLine(NewVer("H19"));
        System.Diagnostics.Debug.WriteLine(NewVer("9"));
        System.Diagnostics.Debug.WriteLine(NewVer("09"));
        System.Diagnostics.Debug.WriteLine(NewVer("009"));
        System.Diagnostics.Debug.WriteLine(NewVer("7"));
        System.Diagnostics.Debug.WriteLine(NewVer("07"));
        System.Diagnostics.Debug.WriteLine(NewVer("27"));
        System.Diagnostics.Debug.WriteLine(NewVer("347"));
        System.Diagnostics.Debug.WriteLine(NewVer("19"));
        System.Diagnostics.Debug.WriteLine(NewVer("999"));
        System.Diagnostics.Debug.WriteLine(NewVer("998"));
        System.Diagnostics.Debug.WriteLine(NewVer("C99"));
        System.Diagnostics.Debug.WriteLine(NewVer("C08"));
        System.Diagnostics.Debug.WriteLine(NewVer("C09"));
        System.Diagnostics.Debug.WriteLine(NewVer("C11"));
    }

    public static string NewVer(string oldVer)
    {
        string newVer = oldVer.Trim();
        if (string.IsNullOrEmpty(newVer)) return oldVer;
        if (newVer.Length > 3) return oldVer;
        // at this point all code paths need char by postion
        // regex is not the appropriate tool
        Char[] chars = newVer.ToCharArray();
        if (!char.IsDigit(chars[chars.Length - 1])) return oldVer;
        byte lastDigit = byte.Parse(chars[chars.Length - 1].ToString());
        if (lastDigit != 9)
        {
            lastDigit++;
            StringBuilder sb = new StringBuilder();
            for (byte i = 0; i < chars.Length - 1; i++)
            {
                sb.Append(chars[i]);
            }
            sb.Append(lastDigit.ToString());
            return sb.ToString();
        }
        // at this point the last char is 9  and lot of edge cases 
        if (chars.Length == 1) return (lastDigit + 1).ToString();
        if (char.IsDigit(chars[chars.Length - 2]))
        {
            if (chars.Length == 2) return ((byte.Parse(newVer)) + 1).ToString();
            byte nextToLastDigit = byte.Parse(chars[chars.Length - 2].ToString());
            if (nextToLastDigit == 9)
            {
                if (char.IsDigit(chars[0]))
                {
                    byte firstOfthree = byte.Parse(chars[0].ToString());
                    if (firstOfthree == 9) return oldVer; // edge case 999
                    // all three digtis and not 999
                    return ((byte.Parse(newVer)) + 1).ToString();
                }
                // have c99
                return oldVer;
            }
            else
            {
                //have c 1-8 9 
                return chars[0].ToString() + (10 * nextToLastDigit + lastDigit + 1).ToString();        
            }
        }
        // at this point have c9 or cc9
        if (chars.Length == 3) return oldVer;
        // at this point have c9
        return chars[0].ToString() + "10";
    } 
```

# c++ - 如何清理指向类指针向量的指针的类成员？

> ID：12641859
> 
> 赞同：0
> 
> 时间：2012-09-28T14:20:57.843
> 
> 标签：c++

我有一个名为 Foo 的类，它有一个成员，该成员是指向另一个名为 Bar 的类的指针向量的指针。我在构造函数中初始化它，但我不确定如何在析构函数中释放它。我还在学习。感谢您的帮助。拥有此成员的原因是范围超出该方法即超出堆栈。谢谢。

```
#include <iostream>
#include <vector>

using namespace std;

class Bar {};

class Foo {
public:
    Foo() {
        bars = new vector<Bar*>*[10];

        for (int i = 0; i < 10; i++) {
            bars[i]->push_back(new Bar());
        }
    }

    ~Foo () {
        for (int i = 0; i < 10; i++) {
            // TODO: how to clean up bars properly?
        }
    }

private:
    vector<Bar*>** bars;
};

int main () {
    new Foo();
    return 0;
} 
```

**更新**：我感谢各方面的反馈。我是 C 和 C++ 的新手。基本上，我想要一个 2d 结构作为类成员，它会在类的生命周期内持续存在。外部结构是数组的原因是因为我知道它需要多大。否则我以前使用向量的向量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:32:33.943

这甚至没有正确分配。您分配一个指向 的指针数组`std::vector<Bar*>`，但从不分配任何`std::Vector<Bar*>`。

最好的办法就是类似`std::vector<std::unique_ptr<Bar>>`或什`std::unique_ptr<std::vector<std::unique_ptr<Bar>>>`至或类似的东西。你所拥有的只是WTF。

或`std::unique_ptr<std::array<std::unique_ptr<std::vector<std::unique_ptr<Bar>>>, 10>>`.This 完全匹配（但自清洁）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:44:02.577

指针的数量有点荒谬，因为它们所做的只是造成混乱和泄漏，这从不正确的初始化和问题的标题中可以看出。您实际上根本不需要任何指针，也不必担心任何清理工作。

对于将第一个维度传递给构造函数的二维数组，您可以使用向量的向量：

```
std::vector<std::vector<Bar>> bars; 
```

要使用传入的大小初始化外部向量，请使用初始化程序：

```
Foo(size_t size) 
    : bars(size) {} 
```

当对象被销毁时，`bars`它的所有元素也被销毁，因此不会忘记清理或清理不当。

如果性能是一个问题，这可以转换为一种`Matrix2D`类似于二维数组的类，但实际上只有一个底层的一维数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:51:24.887

编辑：在二维结构的情况下（你说你知道你的二维结构需要多大，所以我们假设循环中的 10 是你想要的二维数组的大小。

```
#include <iostream>
#include <vector>

using namespace std;

class Bar {
public:
    int BarInfo;
};

class Foo {
public:
    Foo() {
        // Allocates 10 vector spots for 10 bar elements - 100 bars, 10 x 10
        for (int i = 0; i < 10; i++) {
            // Puts 10 bars pointer at the end;
            // Heap-allocated (dynamically), which
            // means it survives until you delete it
            // The [10] is array syntax, meaning you'll have 10 bars
            // for each bars[index] and then
            // you can access it by bars[index][0-9]
            // If you need it to be more dynamic
            // then you should try vector<vector<Bar>>
            bars.push_back(new Bar[10]);
        }
    }

    Bar* operator[] (int index) {
        return bars[index];
    }

    ~Foo () {
        // Cleanup, because you have pointers inside the vector,
        // Must be done one at a time for each element
        for (int i = 0; i < bars.size(); i++) {
            // TODO: how to clean up bars properly?
            // Each spot in the vector<> contains 10 bars,
            // so you use the array deletion
            // and not just regular 'delete'
            delete[] bars[i]; // deletes the 10 array elements
        }
    }

private:
    // vector might not be a bad idea.
    vector<Bar*> bars;
}; 
```

这是我用于测试编写的代码的主要方法，它的工作方式就像你认为二维数组应该工作一样：

```
int main ( int argc, char* argv[] ) {
    Foo foo;
    // Bar at 1st row, 2nd column ( row index 0, column index 1 )
    // Bar& is a reference
    Bar& bar12 = foo[0][1];
    bar12.BarInfo = 25;
    int stuffInsideBar = foo[0][1].BarInfo; // 25
    return 0;
} 
```

我希望这有助于并使您更接近您正在做的事情。我在这里使用了一种技术，它可能会超越初学者的头脑，以使`Foo`该类的行为就像您认为的 2D 数组一样。这称为[运算符重载](http://www.cplusplus.com/doc/tutorial/classes2/)。它是 C++ 中的一项强大功能，因此一旦您掌握了更多基础知识，它可能对您未来的项目或当前项目有用。祝你好运！

~~~~~~~~~~~~~~~~~~~~~~~

编辑前的旧答案

~~~~~~~~~~~~~~~~~~~~~~~

看来您做的间接太多了。虽然另一个人的回答向您展示了如何清理您已经设法做的事情，但我认为您可以从改变您处理课程的方式中受益。

```
#include <iostream>
#include <vector>

using namespace std;

class Bar {};

class Foo {
public:
    Foo() : bars() {
        // bars is no longer a pointer-to-vectors, so you can just
        // allocate it in the constructor - see bars() after Foo()
        //bars = new vector<Bar>();

        for (int i = 0; i < 10; i++) {
            // Puts 1 bar pointer at the end;
            // Heap-allocated (dynamically), which
            // means it survives until you delete it
            bars.push_back(new Bar());
        }
    }

    ~Foo () {
        // Cleanup, because you have pointers inside the vector,
        // Must be done one at a time for each element
        for (int i = 0; i < 10; i++) {
            // TODO: how to clean up bars properly?
            // TODOING: One at a time
            delete bars[i]; // deletes pointer at i
        }
    }

private:
    // You don't need to ** the vector<>,
    // because it's inside the class and 
    // will survive for as long as the class does
    // This vector will also be copied to copies of Foo,
    // but the pointers will remain the same at the time
    // of copying.
    // Keep in mind, if you want to share the vector, than
    // making it a std::shared_ptr of a
    // vector might not be a bad idea.
    vector<Bar*> bars;
}; 
```

如果您通过引用将类传递给函数，`vector<Bar*>`则类内部不会复制自身或删除自身，从而使其在单个堆栈帧之后持续存在。

在您的`main`中，这应该正确清理，并且比 vector** 更容易跟踪。但是，如果由于某种原因需要矢量**，那么 home_monkey 的答案应该可以帮助您更多。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-28T14:44:15.350

我认为分配有问题。线

```
new vector <Bar*> * [10] 
```

会给你一个指向类型对象的数组，`vector <Bar*> *`你需要为你的`vector <Bar*>`类型分配一些额外的内存。

我有去，

```
Foo() 
{
    bars = new vector<Bar*>*[10]; // A.

    for (int i = 0; i < 10; i++) 
    {
        bars[i] = new vector<Bar*>;  //  B. Extra memory assigned here.
        bars[i]->push_back(new Bar); //  C.
    }
} 
```

要释放资源，您必须反转上述内容

```
~Foo () 
{
    for (int i = 0; i < 10; i++) 
    {
        //  I'm assuming that each vector has one element
        delete bars[i][0]; //  Free C 
        delete bars[i];    //  Free B    
    }

    delete [] bars; // Free A
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-28T14:23:42.930

我不相信你甚至没有正确分配它。要撤消您到目前为止所做的事情，您所要做的就是：

```
for(int i=0; i < 10; ++i)
    while(bars[i]->size > 0)
    {
        delete *bars[i]->front();
        pop_front();
    }
delete[] bars; 
```

但是，您需要自己分配每个向量，例如在构造函数中：

```
for(int i=0; i<10; ++i)
    bars[i] = new vector<Bar*>(); 
```

这需要您将析构函数更改为：

```
for(int i=0; i < 10; ++i)
{
    while(bars[i]->size > 0)
    {
        delete *bars[i]->front();
        pop_front();
    }
    delete bars[i];
}
delete[] bars; 
```

关于您的更新，我建议将条形类型更改为：

```
vector<Bar*>* bars; 
```

以及分配给（无需执行上面建议的 for 循环分配）：

```
bars = new vector<Bar*>[10]; 
```

# azure - 访问 RoleEnvironment.IsEmulated 时在 Azure 中出现 RoleEnvironmentException

> ID：12641861
> 
> 赞同：4
> 
> 时间：2012-09-28T14:21:03.260
> 
> 标签：azure, azure-role-environment

在我将 ASP.NET WebRole 部署到 Azure 并查看 Azure Intellitrace 后，我注意到很多 RoleEnvironment 异常，它们发生在 RoleEnvironment.IsEmulated。

我认为 ServiceConfiguration 中缺少某些内容，因为 stacktrace 中的倒数第二个调用始终是 RoleEnvironment.GetConfigurationSettingValue。

现在我搜索了这个问题，但除了这个链接我什么也没找到：

[http://bretstateham.com/azure-serviceconfiguration-cscfg-changes%E2%80%A6/](http://bretstateham.com/azure-serviceconfiguration-cscfg-changes%E2%80%A6/)

但是我的服务配置是正确的。我认为设置？IsSimulationEnvironment？应该由 Azure 创建，但在我的情况下不是因为异常。

我不能把“？IsSimulationEnvironment？” 在我的配置中手动设置，因为这不符合服务配置的 xml 命名空间。

有人知道如何解决这个烦人的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T07:20:33.220

我认为您的 RoleEnvironment 尚不可用。即你在初始化之前检查 RoleEnvironment.IsEmulated ......

尝试这个，

```
while (!RoleEnvironment.IsAvailable)
     continue;//you can sleep sometime then continue
if (RoleEnvironment.IsEmulated)
{
  //Your code here
} 
```

# php - 提交时关闭 Eclipse 颠覆插件 (Subeclipse) 中的自动添加

> ID：12641863
> 
> 赞同：0
> 
> 时间：2012-09-28T14:21:09.973
> 
> 标签：php, eclipse, svn

我正在尝试使用 Eclipse 插件来颠覆 Subeclipse。当我去提交代码时，它会为我预先选择项目中的每个文件。这是没有意义的，因为很多文件是由我的应用程序自动生成的，我不想提交它们。每次我想提交时手动取消更改所有内容是一种痛苦。

你知道如何关闭这个功能吗？我不希望它对我没有“svn add”的文件进行任何选择

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T06:10:02.867

问题是您选择：**“RightClick on Project->Team->Commit”**，当然这将“检查”项目中的所有文件......

您可以做的是手动选择源树中要提交的文件夹，使用**“Shift + LeftClick”**，然后执行**“RightClick on Selection->Team->Commit”**。现在您会发现，在 Subclipse 显示的列表中，只有选择中的文件或任何已选择的文件夹中的文件被“选中”。

另一种方法是`svn:ignore`- 对于“您的应用程序自动生成的许多文件”，这是**正确的做法**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-12T09:26:52.460

在验证您的提交之前取消选中“显示未版本控制的文件”框

# unit-testing - 为单个文件生成新的代码覆盖率，而不清除 PHPUnit 中的所有其他覆盖率报告

> ID：12641870
> 
> 赞同：3
> 
> 时间：2012-09-28T14:21:32.480
> 
> 标签：unit-testing, phpunit, code-coverage

**首先是问题：** 在 PHPUnit 3.5 中，有没有一种方法可以为单个测试生成覆盖率报告，而不会覆盖整个测试套件的报告。即只更新受影响文件的覆盖率报告？我仍然希望输出到同一个文件夹。

**对于那些想要一些背景知识的人：**

使用 PHPUnit 3.5，我有一个项目需要追溯覆盖单元测试。现在为了知道哪些类仍然需要测试，我运行了整个测试套件并生成了一个 html 覆盖率报告。因为运行完整的套件需要一些时间，所以我想避免每次我想检查哪些测试还需要实现时都运行它。但同时我也想要我目前正在处理的单元测试的覆盖率报告，这样我就可以确保我正在执行一个类中的每一行代码（这当然是非常快的来回，因此运行整个套件只是为了生成此报告是没有意义的）。我可以为单个测试生成报告，也可以为整个套件生成报告。但我正在寻找的是混合动力车，

我已经设置了一个 ruby​​ 脚本，它将简单地为我正在处理的当前文件运行测试并生成关于该文件的覆盖率报告。但是像这样工作，它总是重置所有其他文件的覆盖率报告，即使测试没有在这些类中执行任何东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:32:40.587

这在本机是不可能的，但是如果您能弄清楚如何从 XML 覆盖数据文件重新生成 HTML，您可以将脚本修改为

1.  将完整运行的覆盖 XML 复制到暂存区域。
2.  运行单个测试时，将新的 XML 文件复制到该区域。这不一定会合并覆盖同一类的两个测试的覆盖率，但我从你的描述中猜测你正在覆盖每个测试的一个类，反之亦然。
3.  从 XML 重建 HTML。您也许可以通过查看源代码来弄清楚如何做到这一点，但我怀疑这也可能是本机的。

# asp.net-mvc-3 - 使用带有 TraceAttribute 的 PostSharp 使用 HttpContext 的 SessionID 进行日志记录

> ID：12641871
> 
> 赞同：2
> 
> 时间：2012-09-28T14:21:36.360
> 
> 标签：asp.net-mvc-3, c#-4.0, logging, aop, postsharp

我`TraceAttribute`在每个类上都使用 PostSharp 来写入日志文件。一个新的要求是能够在每个日志条目前加上`SessionID`.

不过，PostSharp 似乎无法以这种方式工作。我已经尝试了两种对我有意义的方法，但都不起作用。

**尝试#1**

我向构造函数添加了一个字符串参数，以供,和方法`TraceAttribute`传入和使用。`OnEntry``OnExit``OnException`

```
private readonly string _sessionID;

public TraceAttribute(string sessionID)
{
    _sessionID = sessionID;
    logger = new Logger();
}

public override void OnExit(MethodExecutionArgs args)
{
    logger.LogMethodExit(string.Format("Session {0} Exiting {1}.{2}", _sessionID, args.Method.DeclaringType.FullName, args.Method.Name));
} 
```

我的控制器最初用 [Trace] 属性装饰，我修改为这种方法......

```
[Trace(HttpContext.Session.SessionID)] 
```

这不起作用，因为`HttpContext`在静态上下文中不可用。

所以这个想法是不可能的。

**尝试#2**

所以我的下一个尝试是简单地在`sessionId`本地为每个方法创建变量`TraceAttribute`......

```
public override void OnEntry(MethodExecutionArgs args)
{
    var sessionID = HttpContext.Current.Session.SessionID;
    logger.LogMethodEntry(string.Format("Session {0} Entering {1}.{2}", sessionID, args.Method.DeclaringType.FullName, args.Method.Name));
} 
```

这也不起作用，`HttpContext`它尚不可用，并且`null`在我运行解决方案后立即成为运行时的对象..

**尝试#3**

```
public override void OnEntry(MethodExecutionArgs args)
{
    string sessionID = "Not initialized";
    if (HttpContext.Current.Session.SessionID != null)
        sessionID = HttpContext.Current.Session.SessionID;
    logger.LogMethodEntry(string.Format("Session {0} Entering {1}.{2}", sessionID, args.Method.DeclaringType.FullName, args.Method.Name));
} 
```

有没有办法将会话信息`TraceAttribute`以这种方式与 PostSharp 编织在一起？一些可以实现此目标的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:34:37.077

搞定了，我错过了在 web.config 中上交的会话。

将此行添加到配置中，现在可以正常工作。

```
<sessionState mode="InProc" cookieless="false" timeout="20"/> 
```

# qt - QToolButton的图标为什么不显示？

> ID：12641884
> 
> 赞同：2
> 
> 时间：2012-09-28T14:22:06.143
> 
> 标签：qt, button, resources, icons, stylesheet

我遇到了这个问题，所以我在MainWindow进行了测试，问题仍然存在。这是“MainWindow::MainWindow(QWidget *parent)...”中的代码

```
QToolButton* bt = new QToolButton(this);
bt->setIcon(QIcon(":/te.png"));
bt->setToolButtonStyle(Qt::ToolButtonIconOnly);
bt->show(); 
```

看起来像： ![在此处输入图像描述](../Images/f0d65ea235e8392c5dbf6d8dfffca398.png)

我的资源文件是这样的： ![在此处输入图像描述](../Images/71bc40768021e30cddee1ae189021b20.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:27:40.283

您为该图标指定了别名`te`，但使用它的全名来命名该图标`te.png`。改为使用`:/te`。

# java - Java 中的 SwingWorker

> ID：12641887
> 
> 赞同：-4
> 
> 时间：2012-09-28T14:22:11.697
> 
> 标签：java, multithreading, swing, swingworker

我有个问题。

我有一个`JFrame`. 它将创建一个`JDialog`.

当按下按钮时，`JDialog`它应该被释放并应该发送一封电子邮件。同时，我需要另一个`JDialog`出现 indetermined `JProgressBar`。发送电子邮件时，`JDialog`应处理（并创建新的电子邮件）或更改其内容。

我已经失败了几个小时了，所以我问任何人他（或她）是否愿意给我写一个伪代码来做我想做的事。

只是为了看看应该在`SwingWorker`课堂上包含什么（或者如果你认为它更好，可以使用多线程），什么时候`JDialog`应该创建/处置，以及在哪里粘贴电子邮件发送......

我知道我在这里要求一个完整的解决方案，但我已经陷入困境并且已经失败了很多次......这是我最后的手段......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-28T14:43:38.273

我为您做了一个简短的示例，希望对您有所帮助。基本上`JFrame`显示了一个witha按钮：

![在此处输入图像描述](../Images/0cc18c9952993a4a0fde841bf0a3b0ab.png)

`JButton`单击框架上的将`JDialog`出现另一个`JButton`（*发送电子邮件*） - 这将代表*电子邮件对话框*：

![在此处输入图像描述](../Images/2aa23768adb85c3b438c8df21c04a5d6.png)

当`JButton`on`emailDialog`被按下时，它会处理`emailDialog`并创建一个新的`JDialog`，它将保存*进度*条（或者在这种情况下是一个简单的`JLabel`）：

![在此处输入图像描述](../Images/87dc89b45fb8a0ea23863c321c16e136.png)

然后它创建并执行`SwingWorker`发送电子邮件`dispose()`的`JDialog`时间和完成时间，并显示一条`JOptionPane`消息，显示发送成功：

![在此处输入图像描述](../Images/684aae978cf401a3c9a69ca45612cb15.png)

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

public class Test {

    public static void main(String[] args) throws Exception {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().createAndShowUI();
            }
        });
    }

    private void createAndShowUI() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        initComponents(frame);
        frame.setPreferredSize(new Dimension(300, 300));//testing purposes
        frame.pack();
        frame.setVisible(true);
    }

    private void initComponents(final JFrame frame) {

        final JDialog emailDialog = new JDialog(frame);
        emailDialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        emailDialog.setLayout(new BorderLayout());

        JButton sendMailBtn = new JButton("Send Email");
        sendMailBtn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                //get content needed for email from old dialog

                //get rid of old dialog
                emailDialog.dispose();

                //create new dialog
                final JDialog emailProgressDialog = new JDialog(frame);
                emailProgressDialog.add(new JLabel("Mail in progress"));
                emailProgressDialog.pack();
                emailProgressDialog.setVisible(true);

                new Worker(emailProgressDialog).execute();

            }
        });

        emailDialog.add(sendMailBtn, BorderLayout.SOUTH);
        emailDialog.pack();

        JButton openDialog = new JButton("Open emailDialog");
        openDialog.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                emailDialog.setVisible(true);
            }
        });

        frame.getContentPane().add(openDialog);

    }
}

class Worker extends SwingWorker<String, Object> {

    private final JDialog dialog;

    Worker(JDialog dialog) {
        this.dialog = dialog;
    }

    @Override
    protected String doInBackground() throws Exception {

        Thread.sleep(2000);//simulate email sending

        return "DONE";
    }

    @Override
    protected void done() {
        super.done();
        dialog.dispose();
        JOptionPane.showMessageDialog(dialog.getOwner(), "Message sent", "Success", JOptionPane.INFORMATION_MESSAGE);

    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T16:14:22.650

@大卫克鲁坎普

来自 Substance L&F 的输出（您对用于测试目的的 EDT ust 有任何不确定性）

```
run:
JButton openDialog >>> Is there EDT ??? == true
Worker started >>> Is there EDT ??? == false
waiting 30seconds 
Worker endeded >>> Is there EDT ??? == false
before JOptionPane >>> Is there EDT ??? == false
org.pushingpixels.substance.api.UiThreadingViolationException: 
     Component creation must be done on Event Dispatch Thread 
```

以及另外 200 行关于细节的信息

输出是`"correct container created out of EDT"`

![在此处输入图像描述](../Images/4afb7075ebff32e24522a0f0279160bd.png)

我将在另一个 L&F 上进行测试，Nimbus 可能存在问题，SystemLokkAndFeel 在大多数情况下并不关心 EDT 上的大错误（对 EDT 的敏感性非常不同），Metal 默认情况下在 Windows 平台上没有任何问题，并且对于 Java6，那么您的示例也适用于第二个基础

编辑

Nimbus也不在乎

![在此处输入图像描述](../Images/a4523cd9665d1764f9e5719c39a8d198.png)

从代码

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import javax.swing.plaf.FontUIResource;

public class Test {

    public static void main(String[] args) throws Exception {
        try {
            for (UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    UIManager.setLookAndFeel(info.getClassName());
                    UIManager.getLookAndFeelDefaults().put("nimbusOrange", (new Color(127, 255, 191)));

                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
        } catch (InstantiationException ex) {
        } catch (IllegalAccessException ex) {
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        }
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                /*try {
                    UIManager.setLookAndFeel(
                            "org.pushingpixels.substance.api.skin.SubstanceOfficeBlue2007LookAndFeel");
                    UIManager.getDefaults().put("Button.font", new FontUIResource(new Font("SansSerif", Font.BOLD, 24)));
                    UIManager.put("ComboBox.foreground", Color.green);
                } catch (Exception e) {
                }*/
                new Test().createAndShowUI();
            }
        });
    }

    private void createAndShowUI() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        initComponents(frame);
        frame.setPreferredSize(new Dimension(300, 300));//testing purposes
        frame.pack();
        frame.setVisible(true);
    }

    private void initComponents(final JFrame frame) {

        final JDialog emailDialog = new JDialog(frame);
        emailDialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        emailDialog.setLayout(new BorderLayout());
        JButton sendMailBtn = new JButton("Send Email");
        sendMailBtn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                //get content needed for email from old dialog
                //get rid of old dialog
                emailDialog.dispose();
                //create new dialog
                final JDialog emailProgressDialog = new JDialog(frame);
                emailProgressDialog.add(new JLabel("Mail in progress"));
                emailProgressDialog.pack();
                emailProgressDialog.setVisible(true);
                new Worker(emailProgressDialog, frame).execute();

            }
        });
        emailDialog.add(sendMailBtn, BorderLayout.SOUTH);
        emailDialog.pack();
        JButton openDialog = new JButton("Open emailDialog");
        openDialog.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                System.out.println("JButton openDialog >>> Is there EDT ??? == " + SwingUtilities.isEventDispatchThread());
                emailDialog.setVisible(true);
            }
        });
        frame.getContentPane().add(openDialog);
    }
}

class Worker extends SwingWorker<String, Object> {

    private final JDialog dialog;
    private final JFrame frame;

    Worker(JDialog dialog, JFrame frame) {
        this.dialog = dialog;
        this.frame = frame;
    }

    @Override
    protected String doInBackground() throws Exception {
        System.out.println("Worker started >>> Is there EDT ??? == " + SwingUtilities.isEventDispatchThread());
        System.out.println("waiting 30seconds ");
        Thread.sleep(30000);//simulate email sending
        System.out.println("Worker endeded >>> Is there EDT ??? == " + SwingUtilities.isEventDispatchThread());
        dialog.dispose();
        System.out.println("before JOptionPane >>> Is there EDT ??? == " + SwingUtilities.isEventDispatchThread());
        JOptionPane.showMessageDialog(frame, "Message sent", "Success", JOptionPane.INFORMATION_MESSAGE);
        System.out.println("before JOptionPane >>> Is there EDT ??? == " + SwingUtilities.isEventDispatchThread());
        return null;
    }
} 
```

# performance - 使用 JPA 获取存储在 TIMESTAMP 中的日期（按月或年）

> ID：12641891
> 
> 赞同：2
> 
> 时间：2012-09-28T14:22:24.787
> 
> 标签：performance, oracle, jpa, eclipselink, jpql

我面临一个问题，我希望你能帮助我。

事实证明，我的 Oracle 11g 数据库中有一张表，用于存储一台电子设备的故障。表定义如下：

```
CREATE TABLE failure
( failure_id NUMERIC NOT NULL
, fecha TIMESTAMP NOT NULL
, module_id NUMERIC NOT NULL
, code NUMERIC
, PRIMARY KEY(failure_id)
); 
```

*其中“fecha”的意思是“日期”。*

我需要按年或按月为一个特定模块获取故障，但我不能。我的 ORM 将 TIMESTAMP 类型映射到 java.sql.Date 但我不知道如何比较 JPQL 句子中的月份。我曾尝试将 ORACLE 函数与本机查询一起使用，但我遇到了另一个问题：转换结果。我将 JPA 2.0 与 Eclipselink 2.3.2 一起使用。

**我的疑问是：**

我可以在这个版本的 Eclipselink 库中使用 Oracle 函数吗？我的经验说不。

```
Query query = entityManager.createQuery("SELECT f FROM Failure f "
            + "WHERE EXTRACT(YEAR FROM f.fecha) = ?1 "
            + "AND f.moduleId.moduleId = ?2");
    query.setParameter(1, year);
    query.setParameter(2, idModule); 
```

我收到此错误：`Unexpected token [(]`

我可以使用 Eclipselink 功能吗？我的经验说不。

```
Query query = entityManager.createQuery("SELECT f FROM Failure f "
            + "WHERE EXTRACT('YEAR', f.fecha) = ?1 "
            + "AND f.moduleId.moduleId = ?2");
    query.setParameter(1, year);
    query.setParameter(2, idModule); 
```

同样的错误。

您知道仅使用一个查询来获取此数据的简单方法吗？我知道我可以获取一个模块，然后使用循环检查故障，但我认为这不是性能最好的解决方案。

谢谢。

**我的消息来源：**

*   Eclipselink JPA 函数[链接](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Support_for_Native_Database_Functions#Functions)
*   Eclipselink 查询增强[链接](http://wiki.eclipse.org/EclipseLink/Release/2.1.0/JPAQueryEnhancements)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T16:30:18.367

我使用了 Eclipselink v 2.4 函数，并使用以下方法获取值：

```
Query query = entityManager.createQuery("SELECT f FROM Failure f "
                + "WHERE SQL('EXTRACT (YEAR FROM ?)', f.fecha) = ?1 "
                + "AND f.moduleId.moduleId = ?2 "); 
```

从存储在数据库中的日期中提取年份对我来说避免了两个日期之间的比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T14:08:31.730

EclipseLink 2.4 中 EXTRACT 的语法是，

```
EXTRACT(YEAR, f.fecha) 
```

[http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#Functions](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#Functions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T17:27:49.103

本机查询是用数据库的 SQL 方言编写的，因此可以使用数据库特定的功能，请参阅 EntityManager 的 createNativeQuery 方法。

但是，还有另一种解决方案，根据较低和较高的值测试时间戳：

```
WHERE f.fecha >= '2012-9-1' AND f.fecha < '2012-10-1' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-28T12:45:46.283

利用

```
Query query = entityManager.createQuery("SELECT f FROM Failure f "
        + "WHERE EXTRACT(YEAR from f.fecha) = ?1 "
        + "AND f.moduleId.moduleId = ?2"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-13T23:48:39.813

我面临着同样的问题。我只检查了 oracle 的 EXTRACT 函数的正确语法，它对我有用！（注意函数语法中的 FROM 子句。

@NamedQuery(name = "Registros.findByFechacaptura", query = "SELECT s FROM Registros s WHERE EXTRACT(YEAR FROM s.fechacaptura) = EXTRACT(YEAR FROM :fechacaptura)")

# python - 为什么我的程序提前结束？

> ID：12641894
> 
> 赞同：0
> 
> 时间：2012-09-28T14:22:48.857
> 
> 标签：python

感谢您的所有帮助，我最近能够让它运行，但我无法弄清楚为什么我的程序会在这里结束。看着它，`if answer == 3:`应该只是带你去下一次相遇，但我的程序正在关闭。我错过了什么吗？

```
# First Encounter (main program really)
def fi_en():
    global pow, cun, per
    print"""
It smells of damp vegetation, and the air is particularly thick. You can 
hear some small animals in the distance. This was a nice place to sleep.

1\. Stay close, find some cover, and wait for food to show up.

2\. Explore the nearby marsh & find the nearest river, following it downstream.

3\. Walk towards the large mysterious mountain in the distance. 
"""
    answer = int(raw_input(prompt))
    if answer == 1:
        cun_one = roll_3d6()
        if cun_one <= cun - 2:
            print"""Time passes as eventually you capture some varmints.
You feel slightly more roguish."""
            cun = cun + 1
            fi_en()
        else: 
            print """Time passes and a group of slavers marches into right 
where you are hiding in the woods. They locate you, capture you, and haul you
away for a lifetime of servitude in the main city.
Goodbye %s""" % name
    elif answer == 2: 
        power = roll_3d6()
        if power <= pow - 4:
            print"""You trudge through the marshes until you eventually reach 
a large river. Downstream from the river is a large temple covered in vines,
you walk towards it. You feel more powerful."""
            pow = pow + 2
            te_en()
        else:
            print """The vegetation here wraps itself around your legs making
it impossible to move. You will most likely die here in the vegetation. 
Goodbye %s.""" % name
    elif answer == 3:
        cun_two = roll_3d6()
        if cun_two <= cun:
            print """You make your way towards the mountain and you encounter
a really large group of devil dogs guarding the entrance to the mountain."""
            dd_en()
    else: 
        print"You have gotten lost and ended up right where you started."
        fi_en() 
```

我的输出是：

```
It smells of damp vegetation, and the air is particularly thick. You can 
hear some small animals in the distance. This was a nice place to sleep.

1\. Stay close, find some cover, and wait for food to show up.

2\. Explore the nearby marsh & find the nearest river, following it downstream."

3\. Walk towards the large mysterious mountain in the distance. 

> 3
Raymond-Weisss-MacBook-Pro:lod Raylug$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:27:13.787

在我看来，您好像错过了一大群恶魔狗。您确定要解决此问题吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:44:11.280

删除所有内容，因为您已经开始工作了，只是一个评论。

您可以使用 input('Prompt')，因为它会自动变为 int，raw_input 将输入转换为字符串，然后将该字符串转换为 int，这是不必要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:34:37.967

你还没有在任何地方定义你的全局变量。您在条件三中没有“else”语句，因此由于 cun_one 不小于/等于您未定义的 cun 变量，因此当 answer == 3 时无事可做。

# feedback - 如何谷歌feedbuner？

> ID：12641895
> 
> 赞同：0
> 
> 时间：2012-09-28T14:22:48.900
> 
> 标签：feedback, subscribe

现在，我正在为自己开发一个网站，我想让客人订阅我的网站，我看到其他网站使用 google sfeedburner 来批准它，所以我想知道如何为我的用户使用它订阅我的网站。请有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:07:14.220

[http://support.google.com/feedburner/answer/79408/?&](http://support.google.com/feedburner/answer/79408/?&)

首先，您构建内容的机器可读版本（例如 XML 或 ATOM）。然后你通过 feedburner 发布它。

简单！

# php - 使用 Symfony 验证器验证匹配和唯一性

> ID：12641897
> 
> 赞同：1
> 
> 时间：2012-09-28T14:22:50.883
> 
> 标签：php, validation, symfony, silex

我将 Silex 用于一个小型项目，但我不确定如何验证两个匹配的密码字段，也不确定如何使用数据库连接检查电子邮件的唯一性。我无法在 SF2 文档中弄清楚。

可能有人可以给我一个提示或样本吗？

提前致谢

```
if ('POST' === $user->getMethod()) {

    $constraint = new Assert\Collection(array(
        'name' => array(new Assert\NotBlank(array('message' => 'Name shouldnt be blank'))),
        'username' => array(new Assert\NotBlank(), new Assert\MinLength(3)),
        'email' => array(new Assert\NotBlank(), new Assert\Email()),
        'password' => array(new Assert\NotBlank(), new Assert\MinLength(6)),
        'password2' => array(new Assert\NotBlank(), new Assert\MinLength(6)),
        'terms' => array(new Assert\True()),
    ));

    $errors = $app['validator']->validateValue($user->request->all(), $constraint); 

    if (!count($errors)) {
    //do something
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T20:03:21.463

我在评论中看到您已经切换到 Sf2 表单。我猜您找到了该`RepeatedType`字段，该字段最适合注册表单的重复密码字段 - 它具有内置检查以验证两个值是否匹配。

您的另一个问题是检查电子邮件地址的唯一性。这是我的注册表的相关部分：

```
<?php

namespace Insolis\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;
use Symfony\Component\Validator\Constraints as Assert;
use Symfony\Component\Validator\ExecutionContext;

class RegisterType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $app = $options["app"];

        $builder->add("email", "email", array(
            "label"         =>  "E-mail address",
            "constraints"   =>  array(
                new Assert\NotBlank(),
                new Assert\Email(),
                new Assert\Callback(array(
                    "methods"   =>  array(function ($email, ExecutionContext $context) use ($app) {
                        if ($app["user"]->findByEmail($email)) {
                            $context->addViolation("Email already used");
                        }
                    }),
                )),
            ),
        ));
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        parent::setDefaultOptions($resolver);
        $resolver->setRequired(array("app"));
    }

    public function getName()
    {
        return "register";
    }
} 
```

笔记：

*   `$app`被注入，所以我可以访问依赖注入容器
*   `$app["user"]` is my User table via [KnpRepositoryServiceProvider](https://github.com/KnpLabs/RepositoryServiceProvider)
*   `$app["user"]->findByEmail` returns null or a user record

# android - jquery scrollLeft 在 Android 上不起作用

> ID：12641898
> 
> 赞同：4
> 
> 时间：2012-09-28T14:23:04.083
> 
> 标签：android, jquery, scroll, overflow

下面的代码在安卓浏览器中不起作用！

我如何解决它？

```
<input id="sannn" type="button" value="SAN" />
<div id="sann" style="width:640px; height:200px; overflow:scroll; border:solid 1px red;">
    <div style="border:solid 1px green; width:3000px; height:200px;">4545</div>
</div>

$('#sannn').bind('click', function () {
    $('#sann').scrollLeft(10);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T18:24:42.710

看起来这是 Android 浏览器 4.0.3+ 中的错误

[http://code.google.com/p/android/issues/detail?id=38505&thanks=38505&ts=1350315570](http://code.google.com/p/android/issues/detail?id=38505&thanks=38505&ts=1350315570)

问题 38505：DOM 元素 scrollLeft 设置器在 Android 浏览器 4.0.3+ 中不起作用

将 div 包装器定位为相对于溢出隐藏和特定宽度和高度。在内部 div（要移动的 div）上使用绝对位置并通过 jQuery 使用内联样式左侧位置。

如果你真的需要滚动条。Jquery UI 滑块可能会有所帮助：http: [//jqueryui.com/slider/](http://jqueryui.com/slider/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T18:56:17.133

我在使用 Zepto.js 时遇到了同样的问题。*我可以通过首先禁用溢出*来解决这个问题：滚动元素上的滚动，如下所示：

```
$("#element-to-scroll").css({'overflow': 'hidden'}).scrollLeftTo(newXPos, 250).css({'overflow': 'scroll'); 
```

# objective-c - IOS 应用程序将数据发送到 Rest API 服务

> ID：12641899
> 
> 赞同：1
> 
> 时间：2012-09-28T14:23:12.350
> 
> 标签：objective-c, ios, nss

我想创建一个 iPhone 应用程序来将数据发送到 Rest API 服务。如果数据是定义为 geoX#35#geoY#65 的字符串，我应该使用哪个 NSS 方法。正在考虑 NSString 和 NSMutablerequest 来发出我的请求并定义我的字符串，但这在 atm 上不起作用。另外我正在使用 NSURLconnection 建立与服务器的连接（也许这也是错误的）。任何可以帮助的人吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:44:35.020

您的连接数据使用特殊字符，如果您尝试使用 NSURLConnection 的 GET 方法执行此操作。它将显示连接错误。为此，您必须使用 POST 方法，例如：

```
NSData *body = nil;
NSString *contentType = @"text/html; charset=utf-8";
NSURL *finalURL = @"YOUR URL WITH the ?input=";
NSString *yourString = @"geoX#35#geoY#65"; 
contentType = @"application/x-www-form-urlencoded; charset=utf-8";
body = [[NSString stringWithFormat:@"%@", yourString] dataUsingEncoding:NSUTF8StringEncoding];
if (nil==finalURL) {
    finalURL = url;
}

NSMutableDictionary* headers = [[[NSMutableDictionary alloc] init] autorelease];
[headers setValue:contentType forKey:@"Content-Type"];
[headers setValue:mimeType forKey:@"Accept"];
[headers setValue:@"no-cache" forKey:@"Cache-Control"];
[headers setValue:@"no-cache" forKey:@"Pragma"];
[headers setValue:@"close" forKey:@"Connection"];

NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:finalURL
                                                       cachePolicy:NSURLRequestUseProtocolCachePolicy
                                                   timeoutInterval:60.0];
[request setHTTPMethod:@"POST"];

[request setAllHTTPHeaderFields:headers];

[request setHTTPBody:body];

self.conn = [NSURLConnection connectionWithRequest:request delegate:self]; 
```

# moodle - 在 Moodle 中永久显示块？

> ID：12641900
> 
> 赞同：1
> 
> 时间：2012-09-28T14:23:24.003
> 
> 标签：moodle

有没有办法在 Moodle 中永久显示一个块？我正在配置一个主题，我想知道是否有一种方法可以确保无论您在哪个页面上都可以看到一个块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T16:18:02.663

一种解决方案应该是添加一个新的块区域。
在**主题目录**的*config.php 文件*中，修改**布局选项**并将新区域添加到所有使用的布局中：

```
$THEME->layouts = array(
'base' => array(
    'file' => 'admin.php',
    'regions' => array('your-region'),
    'defaultregion' => 'your-region',
),
'standard' => array(
    'file' => 'admin.php',
    'regions' => array('your-region', 'side-post'),
    'defaultregion' => 'your-region',
),
// The site home page.
'frontpage' => array(
    'file' => 'general.php',
    'regions' => array('tools-menu', 'side-post'),
    'defaultregion' => 'tools-menu',
    'defaultregion' => 'tools-menu',
),
'course' => array(
    'file' => 'general.php',
    'regions' => array('your-region'),
    'defaultregion' => 'your-region',
    'options' => array('nofooter'=>true, 'nonavbar'=>true, 'nocustommenu'=>true),
),
etc... 
```

然后编辑所有布局文件*`theme/your_theme/layout/*.php`*并将此行添加到**您希望块出现的位置**：

```
echo $OUTPUT->blocks_for_region('your-region'); 
```

现在，您必须将所有页面类型的块添加到该区域，只需在您的数据库中执行此 sql：

```
INSERT INTO `mdl_block_instances` (
`id` ,
`blockname` ,
`parentcontextid` ,
`showinsubcontexts` ,
`pagetypepattern` ,
`subpagepattern` ,
`defaultregion` ,
`defaultweight` ,
`configdata`
)
VALUES ( NULL ,  'your_block_name',  '1',  '1',  '*',  NULL,  'your-region',  '0', NULL ); 
```

# java - Spring AOP 中的 Before 建议面临问题

> ID：12641901
> 
> 赞同：1
> 
> 时间：2012-09-28T14:23:24.143
> 
> 标签：java, spring, spring-aop, spring-annotations

我的项目基于 Spring 和 Hibernate。我熟悉 Spring AOP。

有一个要求是，无论何时（通过服务层）调用 DAO 层的任何方法，我都需要检查一些逻辑，并基于该 DAO 层方法应该被允许继续。所以，我想在这里使用AOP。该**方面**将有一个方法，应用了**之前的通知**，该方法将具有一些逻辑，并将相应地返回真或假，并且基于从方面返回的**布尔**值，DAO 方法将被允许继续执行其持久性逻辑。例如，如果返回**true**，将发生DAO持久化过程，如果返回**false**，则不会发生持久化逻辑。

但是，我面临的挑战是如何将**布尔**值从 Aspect 返回到 DAO 层方法。

是否可以使用**Before 通知从****通知方法**（即用 Aspect 编写的方法）返回一个值到**目标方法**？请帮忙。

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:46:21.230

如果您的 DAO 可以与“proceed/execute/doStuff”方法共享一个接口，那么您可以从 Advice（或不）调用它。

如果不是，为什么不向 DAO 添加一个标志并从建议中设置它，然后在 DAO 上检查它，然后再继续，然后在离开方法之前将其设置回默认状态。**

# c++ - 字符串文字的字节顺序和 case 语句中字符串的使用

> ID：12641908
> 
> 赞同：0
> 
> 时间：2012-09-28T14:23:46.833
> 
> 标签：c++, string, endianness, literals, string-literals

在我的机器上，以下程序将 1234 写入其输出。

```
const char str[] = "1234";
printf("%c%c%c%c\n",
    (int) (0xff & (*(uint32_t*) str) >> 0),
    (int) (0xff & (*(uint32_t*) str) >> 8),
    (int) (0xff & (*(uint32_t*) str) >> 16),
    (int) (0xff & (*(uint32_t*) str) >> 24)); 
```

这意味着`str`内部表示为`0x34333231`，第一个字节`str[0]`表示最低有效 8 位。

这是否意味着`str`以小端编码？这个程序的输出是否依赖于平台？

此外，是否有一种方便的方法可以在 switch case 语句中使用 1、2、4 和 8 个字符串文字？我找不到任何将字符串转换为整数的方法，因为`*(const uint32_t* const) "1234"`它不是常量表达式，并且`0x34333231`/`0x31323334`可能与平台相关，必须以十六进制表示。

**编辑：**

换句话说，`0xff & *(uint32_t*) str`总是等于`str[0]`？

嗯，没关系，刚刚意识到它是，也是为什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:25:45.220

您将字符串的字节序（只要我们谈论 ASCII 字符串就不存在）与整数的字节序混淆了。您系统上的整数是小端序。

要回答您的第二个问题，不，您不能打开字符串。如果您真的非常渴望提高速度，您可以为小端系统制作一个，为大端系统制作一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:37:37.400

字节顺序是指较大值中的字节顺序。字符串（至少在 C 和 C++ 中）是一个字节数组，因此不适用字节顺序。

您实际上可以使用多字符文字来执行您在上一段中提到的操作，尽管它的实现定义了它的工作原理并且字符串必须不超过`sizeof(int)`.

> C++ 标准，§2.14.3/1 - 字符文字
> 
> (...) 包含多个 c-char 的普通字符文字是多字符文字。多字符文字具有 int 类型和实现定义的值。

例如，`'abcd'`是`int`具有实现定义值的类型值。该值可能取决于字节序。由于它是一个整数，因此您可以打开它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:51:56.750

字节按递增的内存地址排列为 0x31、0x32、0x33、0x34。

在 32 位整数中，小端是 0x34333231。如果是大端 0x31323334。

（通常整数在偶数或 4 倍地址上对齐。）

# silverlight - Silverlight PieSeries 自定义 LegendItem 与按钮（和 FormattedRatio 百分比）

> ID：12641909
> 
> 赞同：0
> 
> 时间：2012-09-28T14:23:48.347
> 
> 标签：silverlight, charts

对于我的 PieSeries，我希望带有按钮的图例具有相关切片的填充颜色，我还希望按钮具有使用 FormattedRatio 的工具提示中显示的百分比。这是我到目前为止所拥有的：

![带有按钮和橙色切片的 PieSeries 图像](../Images/bafd2107a1d546e8fc8d36b6025c3327.png)

不幸的是，可以看出所有切片现在都变成橙色了，论坛说这是一个标准问题，但没有提供明显的原因，“FormattedRatio”也不适用于 LegendItem。（我想说示例 B：10.17%。）

有谁知道我如何取回颜色以及如何使用 legendItem 中的百分比？

**编辑：**

已经能够使用[此答案](https://stackoverflow.com/a/7757676/1372191)更改切片的背景，但 LegentItems 不会根据新的配色方案进行更改。

![在此处输入图像描述](../Images/54f4be5cb505c2f921da86bac6071af4.png)

颜色是正确的 - 我使用的是错误的测试数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:47:59.353

有一个简单的方法来改变颜色：重新定义`Palette`属性。我已经回答了一个关于颜色的类似问题，这里是：[https ://stackoverflow.com/a/5626435/427225](https://stackoverflow.com/a/5626435/427225)

对于图例项，是无法访问`FormattedRatio`属性的，因为工具包库中有很多bug，但是可以显示绑定项的属性，我举个例子。

首先，您需要为`LegendItem`类创建样式。它与默认的相同，除了 2 处更改：`ContentTemplate`我命名的您自己的，并将属性的`testItemTemplate`绑定更改为，而不是之前的。`Content``{Binding DataContext}`

```
<UserControl.Resources>
    <Style x:Key="testLegendItemStyle" TargetType="chart:LegendItem">
        <Setter Property="ContentTemplate" Value="{StaticResource testItemTemplate}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="chart:LegendItem">
                    <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="8" Height="8" Fill="{Binding Background}" Stroke="{Binding BorderBrush}" StrokeThickness="1" Margin="0,0,3,0"/>
                            <datavis:Title Content="{Binding DataContext}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                        </StackPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources>

<chart:Chart>
    <chart:PieSeries ItemsSource="{Binding Items}" IndependentValuePath="Title" DependentValuePath="Value" LegendItemStyle="{StaticResource testLegendItemStyle}" />
</chart:Chart> 
```

接下来，您需要`testItemTemplate`根据您的模型编写前面提到的，这里是示例。

**C# 视图模型**

```
var items = new[] {
    new ItemViewModel(){ Title = "Apples", Value = 35, CalculatedAndFormattedValue = "1%" },
    new ItemViewModel(){ Title = "Bananas", Value = 43, CalculatedAndFormattedValue = "4%"  },
    new ItemViewModel(){ Title = "Oranges", Value = 29, CalculatedAndFormattedValue = "3%"  },
    new ItemViewModel(){ Title = "Cherries", Value = 51, CalculatedAndFormattedValue = "2%"  },
    new ItemViewModel(){ Title = "Lemons", Value = 31, CalculatedAndFormattedValue = "5%"  },
}; 
```

**Xaml 数据模板**

```
<DataTemplate x:Key="testItemTemplate">
    <TextBlock>
        <Run Text="{Binding Title}" />
        <Run Text=" - " />
        <Run Text="{Binding CalculatedAndFormattedValue}" />
    </TextBlock>
</DataTemplate> 
```

![带有自定义图例项的饼图](../Images/1a7d6e11f64b8a0bad9b96c591fb644f.png)

不用说，你应该自己计算百分比

# jquery - jQuery：根据类位置交换类

> ID：12641910
> 
> 赞同：1
> 
> 时间：2012-09-28T14:23:51.993
> 
> 标签：jquery

我正在创建一个 Avatar 设计师，用户可以通过预选自定义发型和头发颜色等内容。

它基本上是一个带有单选按钮的表单，可用于自定义头像。

我的表单包含在一个包含三个类的 DIV 中：

```
<div id="container" class="hair-blonde skin-pink boy"> 
```

我需要类来获取单选按钮的值。因此，如果用户单击头发颜色，则头发颜色单选按钮的值将覆盖`hair-blonde`该类。

我不能使用 [ToggleClass](http://api.jquery.com/toggleClass/)或[addClass](http://api.jquery.com/addClass/)因为它们不能让您控制更改哪个类。此外，如果 hair-blonde 变为 hair-red，那么脚本将不再工作，因为它仍会寻找 hair-blonde。

我想我可以使用[split](https://stackoverflow.com/questions/3203966/jquery-get-the-first-class-only-from-a-element)将类列表转换为数组。但是，当我尝试交换课程时，什么也没有发生。

这是我正在使用的代码：

```
$(".skincolour input").click(function(){
var newskincolour = $(this).val();
var skin_colour = $('#container').attr('class').split(' ')[1];
var skin_colour = newskincolour;
}); 
```

我也试过这个作为一种变体：

```
$(".skincolour input").click(function(){
var newskincolour = $(this).val();
var skin_colour = $('#container').attr('class').split(' ')[1];
var skin_colour = $(".skincolour input").val();
}); 
```

有人可以给我一些关于我做错了什么的指示吗？

*   这是我工作的[JsFiddle](http://jsfiddle.net/tnrZ8/)
*   这是我工作的[现场](http://olo.uk.com/files/test/test6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:28:20.703

您的方法可以工作，但您忘记覆盖元素的`class`属性。尝试这个：

```
$(".skincolour input").click(function(){
    var newskincolour = $(this).val();
    var classes = $('#container').attr('class').split(' ');
    classes[1] = newskincolour;
    $('#container').attr('class', classes.join(' '));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:25:19.340

您可以使用[removeClass](http://api.jquery.com/removeClass/)删除相同类别的类，然后使用`addClass`.

# cron - IPTables 规则拒绝使用 CRON 的 IP 范围的所有流量

> ID：12641911
> 
> 赞同：-1
> 
> 时间：2012-09-28T14:23:56.377
> 
> 标签：cron, iptables

我目前有一个透明代理模式的 ClearOS 网关服务器。它有很多很棒的工具，但我有一些问题阻止我直接强制使用 Web 代理，这将使用 ACL 控制调度......

长话短说。我需要找到一种方法来阻止特定 IP 地址和 IP 范围的所有流量。我已经研究过了，我需要通过防火墙（IPTables）来做到这一点。理想情况下，我想设置一个 cron 作业来交换 IPTables 规则，以启动和停止指定 IP 范围/地址的所有流量。

我看到有人在论坛上谈论这样做，但他们没有提供任何细节。他们建议为不同的条件设置多个 iptable 配置文件，然后使用 cron 交换它们。我不确定使用 IPTables 命令设置 cron 命令来添加/删除规则或规则集是否可行或可取。无论如何，我是这方面的新手，但我足够聪明，可以进入并弄脏我的手....

如果您有有关如何执行此操作的信息，我提前感谢您。在这一点上，我并不是在寻找替代方法，因为我已经看过几乎所有的方法。使用防火墙和 cron 是我的目标。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T19:37:22.193

为那些可能遇到这个问题的人总结一下......我能够在 ClearOS 论坛和几个非常有帮助的人的帮助下解决它......这里是链接，所以我不必复制整个线程在这里：

[http://www.clearfoundation.com/component/option,com_kunena/Itemid,232/catid,7/func,view/id,46918/](http://www.clearfoundation.com/component/option,com_kunena/Itemid,232/catid,7/func,view/id,46918/)

# ruby - 使语句依赖于其他语句的顺序是一个好主意吗？

> ID：12641917
> 
> 赞同：1
> 
> 时间：2012-09-28T14:24:20.463
> 
> 标签：ruby, module, include

在[我之前的问题](https://stackoverflow.com/questions/12640645/how-to-get-the-self-to-refer-to-a-my-class-inside-a-mixin-module-even-if-it-i/12640884)之后，一个答案（[@Andy H](https://stackoverflow.com/users/725792/andy-h)）说相关的问题是陈述的顺序。那么，一般来说，*具有“前后语句依赖性”是否“正确”/“正确”？*也就是说，例如，如果我有以下*工作*代码

```
class Article < ActiveRecord::Base
  acts_as_list ...

  include MyModule
end 
```

并且以下代码*不起作用*

```
class Article < ActiveRecord::Base      
  include MyModule

  acts_as_list ...
end 
```

是否有一些“坏”的理由不继续实施课程？也就是说，一般来说，*根据其他陈述的顺序做出陈述是个好主意吗？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:33:49.603

我认为这不是“好”与“坏”的问题。

恰好是代码从上到下执行的情况。

因此，如果您有一些代码`statement_a`依赖于添加的行为，`statement_b`那么放`statement_b`之前`statement_a`是唯一的解决方案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:34:57.417

1.  在您的情况下：是的，这是不可接受的。从概念上讲，顺序在那里并不重要，它是强制固定顺序工作的实现。不太好。

2.  一般来说：当然，在像 Ruby 这样的非惰性语言中，语句的顺序很重要。但它与`x = 1; y = 2 * x`涉及状态和副作用的顺序“依赖”不同（愚蠢的例子：）`x = []; x << 1 if condition1?; x << 2 if condition2?; x`。

# shell - 标签完成终端上的奇怪字符

> ID：12641918
> 
> 赞同：0
> 
> 时间：2012-09-28T14:24:21.483
> 
> 标签：shell, terminal, putty

我正在使用腻子连接到服务器。

每当我按下制表符 .. 完成文件名时... 它会添加一些奇怪的字符..

上下箭头不起作用..最终我输入了所有内容..（文件名..）

例如

```
 directory has file.. foo.py foo.txt

  $python foo.py fo[tab].... i am hoping to see the selections.. (foo.py, foo.txt) and stuff 
```

它表明......但它也在末尾添加了一个字符..如果我尝试删除它..它会在最后添加更多字符.. :(

关于可能是什么问题的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:24:47.303

自动完成和历史记录取决于服务器运行的环境。所以我担心客户端没有什么可以启用的。如果您可以找出服务器正在运行的环境**并且**您具有写入权限，那么也许您可以找到一些特定于环境的编辑（对配置文件等）。

# php - 仅在更改 csv 行数时刷新页面

> ID：12641923
> 
> 赞同：1
> 
> 时间：2012-09-28T14:24:43.457
> 
> 标签：php, javascript, ajax, csv

根据我所做的研究，我认为我可能不得不使用 Ajax，但我对它并不是很熟悉，而且我似乎无法为我的功能找到正确的答案。

我没有使用数据库（也许我应该但我正在寻找一个短期修复）。我正在使用用户数据输入到使用 PHP 的 csv 文件。

我的 php 循环遍历 csv 文件并显示包含内容的表格。它只是一列 Twitter 用户名。

```
<php?    
echo "<table>\n";
$file = file("Twitter.csv");
$file = array_reverse($file);
foreach($file as $f){
$string=$f; 
$string=str_replace("\r\n","",$string);
    echo "<tr>\n";
            echo "<td><a href='http://twitter.com/".$string."' target='_blank'><img src='https://api.twitter.com/1/users/profile_image?screen_name=".$string."&size=bigger' border='0'></td>\n<td>\n<a href='https://twitter.com/".$string."' class='twitter-follow-button' data-show-count='false' data-lang='en' data-size='large'>Follow @".$string."</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');</script>";
    echo "</td>\n</tr>\n";
    }
echo "\n</table>";
?> 
```

一旦用户授权了 twitter 应用程序并且我获得了他们的用户名，他们将被重定向到列出其他要关注的名称的页面。但是，我希望该页面在 csv 文件的行数更改时更新。

我需要能够每 x 秒运行一次脚本以获取行数以及它是否已更改为刷新。

我想逻辑很简单：

```
$linecount = count(file('Twitter.csv'));
every x seconds{
    $checkcount = count(file('Twitter.csv'));
    if ($checkcount != $linecount){
     refresh page
    }
 } 
```

我觉得逻辑是正确的——我只是没有受过足够的教育，无法弄清楚如何编写该代码来工作。

如果文件没有更新，页面将不会刷新，但代码仍将每 x 秒执行一次，直到文件发生更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:46:55.320

The solution can be done in a few steps (untested):

*   Your PHP script writes the current value of `filemtime('Twitter.csv')` into a block of JavaScript:

> ```
> echo '<script>var currentTS = ', (int)filemtime('Twitter.csv'), ';</script>'; 
> ```

*   Create a small PHP script that returns the modification time of `Twitter.csv`:

> ```
> echo json_encode(array('ts' => filemtime('Twitter.csv'))); 
> ```

*   Write a JavaScript function that fetches the timestamp via AJAX using some simple jQuery:

> ```
> function myFunction() {
>     $.ajax({
>       url: '/path/to/check_mod_time.php',
>       timeout: 2000, // don't wait too long
>       success: function(data) {
>         if (currentTS < data.ts) {
>             location.reload();
>         }
>     });
> } 
> ```

*   Let your function get called every X seconds using `setInterval()`:

> ```
> setInterval(myFunction, 5000) // run every 5 seconds 
> ```

# java - 如果地址嵌套在用户中，为什么我必须保留两个对象？

> ID：12641925
> 
> 赞同：8
> 
> 时间：2012-09-28T14:24:45.507
> 
> 标签：java, jpa

我试图更好地熟悉 JPA，所以我创建了一个非常简单的项目。我有一个用户类和一个地址类。即使我将 Address 添加到我的 User 类中，我似乎也必须坚持两者？

用户：

```
import javax.persistence.*;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

@Entity
@Table(name = "usr") // @Table is optional, but "user" is a keyword in many SQL variants 
@NamedQuery(name = "User.findByName", query = "select u from User u where u.name = :name")
public class User {
    @Id // @Id indicates that this it a unique primary key
    @GeneratedValue // @GeneratedValue indicates that value is automatically generated by the server
    private Long id;

    @Column(length = 32, unique = true)
    // the optional @Column allows us makes sure that the name is limited to a suitable size and is unique
    private String name;

    // note that no setter for ID is provided, Hibernate will generate the ID for us

    @OneToMany(fetch=FetchType.LAZY, mappedBy="user")
    private List<Address> addresses; 
```

地址：

```
@Entity
public class Address {

    @Id // @Id indicates that this it a unique primary key
    @GeneratedValue // @GeneratedValue indicates that value is automatically generated by the server
    private Long id;

    @Column(length=50)
    private String address1;

    @ManyToOne
    @JoinColumn(name="user_id")
    private User user; 
```

实体管理器：

```
EntityManager entityManager = Persistence.createEntityManagerFactory("tutorialPU").createEntityManager();

entityManager.getTransaction().begin();

User user = new User();
user.setName("User");

List<Address> addresses = new ArrayList<Address>();
Address address = new Address();
address.setAddress1("Address1");

addresses.add(address);
user.setAddresses(addresses);
entityManager.persist(user);
entityManager.persist(address);
entityManager.getTransaction().commit();
entityManager.close(); 
```

可能做错了什么......只是不确定它是什么？

任何建议，将不胜感激。

谢谢，

小号

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T14:32:38.630

尝试`cascade`注释的元素。

```
@OneToMany(fetch=FetchType.LAZY, mappedBy="user", cascade=CascadeType.PERSIST) 
private List<Address> addresses; 
```

[文档](http://docs.oracle.com/javaee/6/api/index.html?javax/persistence/OneToMany.html)说默认情况下没有级联操作。它还指出级联操作是可选的，因此它实际上取决于您使用的实现。

此外，在设置关系时，请确保设置关系的双方。将地址设置为用户，将用户设置为地址。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-28T14:37:34.607

你在说什么叫做级联。这意味着对嵌套对象执行相同的操作，例如`Address`您的`User`. 默认情况下，如果您不指定任何`CascadeType`.

您可以一次定义各种级联类型

```
@OneToMany(fetch=FetchType.LAZY, mappedBy="user", cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REMOVE})
private List<Address> addresses; 
```

或者只是告诉 JPA 级联每个操作：

```
@OneToMany(fetch=FetchType.LAZY, mappedBy="user", cascade = CascadeType.ALL)
private List<Address> addresses; 
```

两种方式都将导致，例如，一个持久化的`Address`同时持久化一个`User`或删除关联`Address`的一个`User`被删除。

但是！...如果您`CascadeType.REMOVE`从第一个示例中删除，则删除 an`User`不会删除其关联`Address`（删除操作不会应用于嵌套对象）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:32:58.180

您正在使用 oneToMany 注释。据我了解，当您想向其添加子类（地址）时，您必须保留父类（USer）。

通过持久化 User 类，您可以让 JPA 知道要更新哪一行。

# java - php 到 java 从 mysql utf-8 编码

> ID：12641926
> 
> 赞同：0
> 
> 时间：2012-09-28T14:24:47.343
> 
> 标签：java, php, mysql, database, utf-8

我编写了一个连接 mysql 数据库的 php 项目。我还有一个 jar 文件，它在调用 php url 时运行。通过 php 我从用户那里获取参数并将它们保存到数据库中，然后我的 jar 文件连接到数据库并读取指定的行。直到这里一切都好。

这是我运行位于服务器中的 .jar 文件的 php 文件：

```
 <?php
mysql_query("SET NAMES utf8");
header("Content-Type: text/html;charset=UTF-8");

echo shell_exec('java -jar /home/path/path/path/my.jar');

?> 
```

我的jar文件如下：

```
Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/somedb?useUnicode=true&characterEncoding=UTF-8", "root", "pass"); 
```

在while循环中：

```
while (resultSet2.next()) {

        title2 = new String(resultSet2.getString("title").getBytes("UTF-8"), "UTF-8");
        url2 = new String(resultSet2.getString("url").getBytes("UTF-8"), "UTF-8");
        id = new String(resultSet2.getString("id").getBytes("UTF-8"), "UTF-8");
        date = new String(resultSet2.getString("date").getBytes("UTF-8"), "UTF-8");

        list.add(title2);
        list2.add(url2);
        list4.add(id);
        list5.add(date);

    } 
```

当我从 db 中检索某些东西时，一切都很完美。我还将 db 设置为“默认字符集 utf8 默认整理 utf8_general_ci”。

当我用 php 写一个土耳其字符时，它会保存到 db，我可以看到。但是当我尝试用我的罐子检索那些土耳其字符时，它只显示问号。我几乎尝试了一切，但没有机会。

非常感谢任何帮助。

编辑：我还在 jar 文件中将 UTF-8 更改为 ISO-8859-1。但它不再起作用了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T09:43:23.440

如果所有连接设置都正确，那么

```
title2 = resultSet2.getString("title") 
```

……应该够了。这将从数据库中检索信息并使用连接设置解释字符串，然后将其转换为 UTF-16，这是 Java 的内部表示。当您添加 getBytes("UTF-8") 时，会将内部字符串转换为 UTF-8，然后返回这些字节。然后，您将这些字节重新解释为 UTF-8。

我知道 MySQL 在以 root 身份连接时会忽略配置文件中的连接选项，因此请尝试创建一个新用户并再次运行它。

# android - 我在 eclipse (android hello world app) 中得到这 3 个错误

> ID：12641927
> 
> 赞同：0
> 
> 时间：2012-09-28T14:24:49.993
> 
> 标签：android, eclipse, android-layout

这是我从一个 android 教程中粘贴的代码。但是我得到这3个错误？请帮忙

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" />

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="This is my first Android Application!" />

    <Button
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="And this is a clickable button!" />

</LinearLayout> 
```

`Error: No resource found that matches the given name (at 'text' with value '@string/hello'). main.xml /Helloworld/res/layout line 6 Android AAPT Problem`

`[I18N] Hardcoded string "And this is a clickable button!", should use @string resource main.xml /Helloworld/res/layout line 17 Android Lint Problem`

`[I18N] Hardcoded string "This is my first Android Application!", should use @string resource main.xml /Helloworld/res/layout line 13 Android Lint Problem`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:32:03.257

您需要添加

```
<resources>
     <string name="hello">Hello World</string>
     <string name="app_name">My app</string>
</resources> 
```

最好的办法是以编程方式添加字符串：

```
TextView tv = (TextView)findViewById(R.id.text1);     //text1 is the id u provide in xml file
tv.setText("Hello World"); 
```

这里还有更多： [android:text="@string/hello" 和普通右键单击的区别--> 文本视图组件--> EditText](https://stackoverflow.com/questions/10278953/difference-between-androidtext-string-hello-and-normal-right-click-text-v)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:30:59.893

第一。您尚未在 res/values 的 strings.xml 中定义字符串“Hello”

```
<string name="hello">Hello!</string> 
```

二和三只是警告。您不应该在 layout.xmls 中对字符串进行硬编码，因为它们无法本地化。您应该使用与“hello”相同的技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:35:11.833

尝试这个，

字符串.xml 文件

```
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<resources>
    <string name="hello">Hello World</string>
    <string name="first_application">This is my first Android Application!</string>
    <string name="clickable_button">And this is a clickable button!</string>
</resources> 
```

你的 xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:orientation="vertical">
      <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/hello"/>
      <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/first_application"/>
      <Button
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/clickable_button"/>
</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:33:18.883

`@string`指的是文件`res/values`夹中名为的 xml 文件`strings.xml`，它应该类似于以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="hello">Enter your "hello" text you want displayed here</string>
</resources> 
```

正如我上面所说的，其他错误也建议为这些创建字符串。

# java - 使用 glReadPixels 读取纹理图像的像素数据

> ID：12641930
> 
> 赞同：2
> 
> 时间：2012-09-28T14:24:54.520
> 
> 标签：java, opengl, jogl

您可以使用 glReadPixels 从纹理图像中读取像素数据吗？

我生成纹理图像的代码是：

```
gl.glTexImage2D( GL2.GL_TEXTURE_2D, 0, GL2.GL_RGBA, width, height, 0, GL2.GL_RGBA, GL2.GL_UNSIGNED_BYTE, ByteBuffer.wrap( pixels ) ); 
```

变量像素包含图像的像素值。然后我使用 glReadPixels 尝试读取刚刚创建的纹理图像的像素数据。我使用 glReadPixels 的代码是：

```
 FloatBuffer buffer = FloatBuffer.allocate( 4 );
    for ( int row = 0, col; row < height; row++ ) {
        for ( col = 0; col < width; col++ ) {
            gl.glReadPixels( col, row, 0, 0, GL2.GL_RGBA, GL2.GL_FLOAT, buffer );
            System.out.print( buffer.get( 0 ) );
        }
        System.out.println();
    } 
```

问题是我一直得到 0.0 的值，我想知道纹理图像是否存储在帧缓冲区中，因为 glReadPixels 从帧缓冲区读取数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-07T00:48:18.817

glReadPixels 从默认帧缓冲区（用于 dbl 缓冲的 GL_BACK）读取，是的。要读取纹理，您可能需要使用带有纹理颜色缓冲区的 FBO。然后将 FBO 设置为活动状态，您可以使用 glReadPixels。由于 FBO 很难驯服而且您使用的是 JOGL，因此我将您链接到一个[屏幕外单元测试](http://jogamp.org/git/?p=jogl.git;a=blob;f=src/test/com/jogamp/opengl/test/junit/jogl/acore/TestFBOOnThreadSharedContext1DemoES2NEWT.java;hb=HEAD)，该单元测试在内部使用 GLFBODrawable/FBObject 并使用 glReadPixels 执行快照。Ofc ..您需要稍微浏览一下代码，它是新的 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T15:50:29.107

我认为这一行的错误。

```
gl.glReadPixels( col, row, 0, 0, GL2.GL_RGBA, GL2.GL_FLOAT, buffer ); 
```

请尝试以下操作

```
gl.glReadPixels( col, row, 1, 1, GL2.GL_RGBA, GL2.GL_FLOAT, buffer ); 
```

此外，最好同时阅读整个图像。不要忘记分配所需的缓冲区大小。

```
gl.glReadPixels( col, row, width, height, GL2.GL_RGBA, GL2.GL_FLOAT, buffer ); 
```

# java - 信号量和条件的区别（ReentrantLock）

> ID：12641933
> 
> 赞同：2
> 
> 时间：2012-09-28T14:25:17.583
> 
> 标签：java, concurrency, locking, semaphore

有谁知道方法`acquire ()`和`release ()`（`java.util.concurrent.Semaphore`）和`await ()`和之间的区别`signal (new ReentrantLock().newCondition() )`。

你可以为这些方法中的每一个公开一个伪代码吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-08T10:58:41.173

从表面上看，这些方法的行为可能看起来很相似——在某些情况下`acquire()/await()` 可以使线程阻塞，`release()/signal()`在某些情况下可以解除线程阻塞。但是 Semaphore 和 Condition 有不同的用途：

*   `java.util.concurrent.Semaphore`是比较高级的同步机制，供一般开发者使用。您通常会使用它来限制对某些资源的并发访问`acquire()`，方法是在访问资源之前进行每个请求者线程调用（如果没有可用的信号量许可，则使线程阻塞）。来自javadoc的描述：

    > 从概念上讲，信号量维护一组许可。如有必要，每个 acquire() 都会阻塞，直到获得许可，然后再接受它。每个 release() 添加一个许可，可能会释放一个阻塞的获取者。

*   `java.util.concurrent.locks.Condition`是相对低级的同步机制，它基本上增强了提供`java.lang.Object`方法的功能`wait()`，`notify()`并且`notifyAll()`. 它使线程在需要等待某个条件变为真时（通常通过其他线程的活动）暂停其活动，然后当状态变量占用时，它使那些其他线程能够“唤醒”等待线程条件的一部分可能已经改变。它通常更难正确使用，建议一般开发人员使用 java.util.concurrent 包中的高级机制（如 Semaphore）。

您可以在 Brian Goetz 的优秀书籍“Java Concurrency in Practice”中找到更多详细信息。

# symfony - Symfony2 GenerateURL 到一个复杂的路由

> ID：12641942
> 
> 赞同：4
> 
> 时间：2012-09-28T14:25:40.923
> 
> 标签：symfony, routing

这似乎是有史以来最愚蠢的问题，但我似乎无法弄清楚。我有一个页面需要重定向到复杂的路由，但我似乎无法生成 URL。重定向到一个简单的路线很容易：

```
return $this->redirect($this->generateUrl('testnumber')); 
```

但是，我想路由到：testnumber/1/question/4。我怎样才能完成这个非常简单的任务？我在文档和 Google 中找到的唯一内容允许我添加参数，而不仅仅是创建复杂的路线。例如：

```
generateURL('testnumber', array('testid'=>1, 'question'=>4)) 
```

生成 /testnumber?tes​​tid=1&question=4 的 URL，这是我不想要的。

编辑：是的，我已经在 YML 文件中创建了路线。我根本无法生成链接到它的 URL。

```
 return $this->redirect($this->generateUrl(???????????),true)); 
```

这是我的路线：

```
@Route("/testnumber/{testid}/question/{question}", name="testnumber") 
```

Symfony 文档只显示了如何生成“testnumber/1”的 URL，我需要生成“testnumber/1/question/4”。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-28T14:31:46.010

为了

```
generateURL('testnumber', array('testid'=>1, 'question'=>4)) 
```

要按照您的意愿工作，您的路线必须看起来像（使用注释的示例）

```
@Route("/testnumber/{testid}/question/{question}", name="testnumber") 
```

如果您没有在路由中定义“testid”和“question”参数，它们将被添加到查询字符串中（作为 GET 参数附加在 URL 的末尾）

```
generated_route?test_id=X&question=X 
```

[在此处](http://symfony.com/doc/2.0/book/routing.html)找到更多相关示例。

# sql - 插入存储过程传递参数

> ID：12641945
> 
> 赞同：3
> 
> 时间：2012-09-28T14:25:52.710
> 
> 标签：sql, database, stored-procedures

我有这个 SQL 语句

```
INSERT housingSurvey ([nameID], [houseID], [jobID], [Active], [comment], [needsMaintenance], [lastUpdateDate) 
VALUES (@NAMEID, @HOUSEID, @JOBID, 1, @DUEDATE, @COMMENT, NULL, @LASTUPDATEDATE) 
```

我试过这个存储过程，但我没有得到当前日期。

```
CREATE PROCEDURE housingSurveyS(
                    @NAMEID INT,
                    @HOUSEID INT,
                    @JOBID INT, 
                    @COMMENT BIT,
                    @DUEDATE NVARCHAR,
                    CURRENTTIME)
AS
BEGIN
INSERT INTO housingSurvey(
    [nameID],
    [houseID],
    [jobID],
    [Active],
    [comment],
    [dueDate],
    [needsMaintenance],
    [lastupdatedate])
VALUES (
    @NAMEID,
    @HOUSEID,
    @JOBID,
    1,
    @COMMENT,
    @DUEDATE,
    NULL,
    @LASTUPDATEDATE)
END 
```

请你看看我做错了什么。谢谢

**更新** 我将它 CURRENTTIME 更改为 DATETIME 作为参数以将当前日期插入 [lastupdatedate] ...它仍然无法正常工作...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:27:44.173

```
VALUES (
    ...
    @DUEDATE,
    @COMMENT 
```

当与 s 语句字段列表中定义的字段顺序相关时，顺序错误`INSERT`，请切换它们。

**编辑**

```
CREATE PROCEDURE housingSurveyS(
    @NAMEID INT,
    @HOUSEID INT,
    @JOBID INT, 
    @COMMENT BIT,
    @DUEDATE NVARCHAR(32) --add a size, should this be DATETIME
)
AS
BEGIN
INSERT INTO housingSurvey(
    [nameID],
    [houseID],
    [jobID],
    [Active],
    [comment],
    [dueDate],
    [needsMaintenance],
    [lastupdatedate]
) VALUES (
    @NAMEID,
    @HOUSEID,
    @JOBID,
    1,
    @COMMENT,
    @DUEDATE,
    NULL,
    GETDATE()
)
END 
```

# java - 自定义注释处理、生成文档和 Maven 3

> ID：12641948
> 
> 赞同：2
> 
> 时间：2012-09-28T14:26:13.270
> 
> 标签：java, maven, annotations, maven-3, maven-compiler-plugin

我的目标是“读取”某个包的 Java 类，然后处理该包中的类和这些类中的方法上的 Javadoc 和注释（最好同时）。解决方案必须在 Java 6 或 7 中实现，构建工具是 Maven 3。我们目前正在使用`maven-compiler-plugin`, version `2.5.1`，但如果可用/必要，我可能会进一步升级。

据我了解，这些`javax.annotation.processing`类的目的是做这种事情，我相信按照[这个其他 SO 答案](https://stackoverflow.com/a/7932577/1449525)的 Java 代码应该适用于我的目的，但是如何让它实际运行的实际细节仍然是有点模糊。

说了这么多，这就是我认为我需要的：

1.  Java 代码挑选出我想要的注释和 Javadoc 项目，然后将这些项目转换为创建我的自定义文档所需的数据模型。
2.  Java 代码，然后将此数据模型写入 docs 文件或文件目录
3.  Maven 3 配置为：
    1.  适时运行一次注释处理器
    2.  在输出的war文件中包含生成的docs目录

Maven 位比 Java 代码更让我感到困惑，所以如果你只回答一半，那就是我的复选标记的一半。此外，我的偏好是不要将此注释处理器作为单独的插件放入 Maven 存储库，因为它将与我们正在使用的一些自定义注释紧密耦合。

以下是我发现的相关问题的简短列表，但我无法综合自己的答案：

*   [为 maven-processor-plugin 编写注释处理器](https://stackoverflow.com/a/5301695/1449525)
*   [使用 maven-compiler-plugin 处理 Maven 注释](https://stackoverflow.com/q/4941355/1449525)
*   [如何使用 Maven 在没有外部 Jar 的情况下配置注释处理 API？](https://stackoverflow.com/q/9128670/1449525)
*   [Pluggable Annotation Processor API 可以检索源代码注释吗？](https://stackoverflow.com/a/7932577/1449525)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:38:15.370

我不确定您是否可以从注释处理器访问 Javadoc。考虑使用 Doclet API：

[http://docs.oracle.com/javase/7/docs/technotes/guides/javadoc/doclet/overview.html](http://docs.oracle.com/javase/7/docs/technotes/guides/javadoc/doclet/overview.html)

**编辑：**

这是我写的一个注释处理器。也许它可以作为一个样本：

[http://softsmithy.hg.sourceforge.net/hgweb/softsmithy/lib/main-golden/file/ae786193023d/softsmithy-lib-core/src/main/java/org/softsmithy/lib/util/impl/ServiceProviderAnnotationProcessor。爪哇](http://softsmithy.hg.sourceforge.net/hgweb/softsmithy/lib/main-golden/file/ae786193023d/softsmithy-lib-core/src/main/java/org/softsmithy/lib/util/impl/ServiceProviderAnnotationProcessor.java)

[http://softsmithy.hg.sourceforge.net/hgweb/softsmithy/lib/main-golden/file/ae786193023d/softsmithy-lib-core/pom.xml](http://softsmithy.hg.sourceforge.net/hgweb/softsmithy/lib/main-golden/file/ae786193023d/softsmithy-lib-core/pom.xml)

[http://softsmithy.hg.sourceforge.net/hgweb/softsmithy/softsmithy-parent/main-golden/file/9397853ba514/pom.xml](http://softsmithy.hg.sourceforge.net/hgweb/softsmithy/softsmithy-parent/main-golden/file/9397853ba514/pom.xml)

对于 Maven：据我所知，您必须**在包含注释处理器的项目中**`-proc:none`作为编译器参数（编译器插件）传递。在该项目中还添加以下资源文件：并在第一行添加注释处理器的完全限定名称。**`META-INF/services/javax.annotation.processing.Processor`**

 **我通常将注解、注解处理器和这个“服务注册表文件”打包在同一个项目 A 中。然后在我使用注解并因此依赖于这个项目 A 的任何其他项目 B 中，选择注解处理器自动起来。

我正在使用 Maven 编译器插件 v2.3.2 和 Java SE 7。**

# bash - bash 完成不像以前那样工作——没有转义文件名中的空格和奇怪的东西等

> ID：12641949
> 
> 赞同：0
> 
> 时间：2012-09-28T14:26:15.953
> 
> 标签：bash, ubuntu, bash-completion, debian-based

好的，我只是不明白为什么这不能自动工作。

当我在我的 mac 上工作时，当我在 bash 中自动完成时，空格和其他奇怪的字符会自动转义，但在我的 ubuntu 机器上，它们不会。更糟糕的是，如果我确实转义了角色，然后尝试自动完成，转义就会*消失*。为什么 debian 的 bash 不完全知道如何处理需要开箱即用的空格和其他字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:02:41.520

我的问题的答案出现在这里：

[Bash 自动完成不会转义 SPACE 并且不会在 Ubuntu 11.4 中标记目录](https://stackoverflow.com/questions/5852389/bash-autocomplete-doesnt-escape-space-and-doesnt-mark-directories-in-ubuntu-11?rq=1)

消除`/etc/bash_completion.d/acroread.sh`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T02:34:28.957

Debian 与 Ubuntu 不同。此外，bash 完成不是 bash 本身的一部分，它是一个包。我建议只需卸载并重新安装该软件包。如果您好奇或对 bash 堆栈进行了自定义更改，请事先备份您的文件以进行比较。

# php - 上传 php 脚本而不是选择的文件

> ID：12641952
> 
> 赞同：0
> 
> 时间：2012-09-28T14:26:30.720
> 
> 标签：php, html, upload

我有两个简单的启动脚本（html 和 php）从机器中选择一个文件然后上传到服务器。但是，当我按下上传时，它似乎正在上传处理上传的实际 php 脚本。他们来了：

```
<html>
<body>

<form action="upload_file.php" method="post"
enctype="multipart/form-data">
<label for="file">Filename:</label>
<input type="file" name="file" id="file" /> 
<br />
<input type="submit" name="submit" value="Submit" />
</form>

</body>
</html>

<?php
$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 20000)
&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

    if (file_exists("upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "upload/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
      }
    }
  }
else
  {
  echo "Invalid file";
  }
?> 
```

我想这只是我的某个地方的一个愚蠢的错误，但这是我第一次使用 php 上传文件的经验。非常感谢。

# c# - 在 C# 中打开 Web 浏览器并捕获输出

> ID：12641956
> 
> 赞同：2
> 
> 时间：2012-09-28T14:26:45.933
> 
> 标签：c#

从 C# 控制台应用程序中，我需要打开 Web 浏览器并且我想要输出。这是链接中的服务器名称。如果 Internet Explorer 没有显示任何内容，则表示服务器已启动。如果我让 Internet Explorer 无法显示该网页，则表示服务器已关闭。

下面是打开IE的代码

```
 Process.Start("https://foo.com"); 
```

如果 Internet Explorer 显示一个空页面，则服务器已启动，否则服务器已关闭。

想知道浏览器是如何自动关闭的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T14:30:51.373

```
using(WebClient client = new WebClient())
{
    string pageData;
    try
    {
        pageData = client.DownloadString(yourAddress);
    }
    catch(Exception e)
    {
        //something went wrong. Maybe the site is down?
    }
    //does pageData have expected content?
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:33:57.303

1.  如果你只是需要获取一个网页的值，你应该使用更轻量级的东西，例如HttpClient（http://pfelix.wordpress.com/2012/01/11/the-new-net-httpclient-class /)。这样您就不必担心清理 Internet Explorer 等外部进程。

2.  如果您坚持为此使用 IE，Process.Start(string) 将返回 System.Diagnostics.Process 的实例，因此您可以调用`.Close()`该返回的实例。

.

```
var ieProcess = Process.Start("https://foo.com");
bool isServerUp = IsServerUp(ieProcess); 
ieProcess.Close(); 
```

# java - 在 Java 中实现计时器事件的最简单方法

> ID：12641957
> 
> 赞同：1
> 
> 时间：2012-09-28T14:26:45.877
> 
> 标签：java, android, events, timer, java-7

我正在寻找一种在 Java SE 1.7 中实现计时器事件的方法，我不想使用 Swing 计时器，因为我计划将此应用程序移植到 Android。

* * *

**背景**

我正在编写一个 LoginSession 类，它应该在会话超时时生成一个事件 - 然后这个事件应该由 SessionManager 类处理。

我认为这是一个足够普遍的要求——我希望有一个简单的内置支持，但我似乎找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:28:29.853

有简单*的*内置支持。使用[Timer.schedule()](http://docs.oracle.com/javase/7/docs/api/java/util/Timer.html#schedule%28java.util.TimerTask,%20java.util.Date%29)。

# javascript - Jquery Selector 父元素的特定元素

> ID：12641963
> 
> 赞同：0
> 
> 时间：2012-09-28T14:27:02.453
> 
> 标签：javascript, jquery

我有一个正在构建的菜单，看起来像这样：

```
<ul id="myUl">
    <li><span>li #1</span>
        <ul>
            <li>
                <div class="myContent">
                    <a href="" name="myLink">clickMe!</a>
                </div>
            </li>
    </li>
</ul> 
```

所以，我想为id 的`<a>`标签定义一个点击处理程序`ul``"myUl".`

我尝试了类似css选择器的东西：

```
$('ul[id="myUl] a').on('click', do stuff!); 
```

或者

`$('ul[id="myUl] > a').on('click', do stuff!);`//这不起作用，因为`a`它不是`ul`.

`a`处理这个特定元素的点击的正确方法是`ul`什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:28:27.200

像这样。

```
$('#myUl a').on('click', your_func); 
```

请注意，我没有使用`>`，这将您*限制*为`ul`.

或者你可以这样做。

```
$('#myUl').on('click', 'a', your_func); 
```

不同之处在于 this 将处理程序绑定到 UL，但仅在`a`单击时触发它。第一个示例直接绑定到`a`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:29:38.963

很简单：

```
$('#myUl').on('click', 'a', do stuff!); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:39:59.520

您还可以在选择器中指定上下文

```
$('a','#myUl').click
//  This is equivelant to $('#myUl').find('a')
//  So this finds all descendant anchor tags of #myUl 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T14:28:34.970

在选择器中使用`>`会使它比它需要的更具体。如果您将其取出，那么它将适用于任何子元素（在任何级别），而不是直接子元素。

```
$(document).ready(function() {
    $('ul#myUl a').click(function() {
        // do stuff
    });
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-28T14:29:05.130

```
$('ul#myUl a').on('click', do stuff!); 
```

或者

```
$('ul[id="myUl"] a').on('click', do stuff!); 
```

应该管用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-28T14:29:13.630

您缺少 " in`$('ul[id="myUl"] a').on('click', do stuff!);`和 in`$('ul[id="myUl"] > a').on('click', do stuff!);` 但您可以直接使用元素的 id 作为选择器：

`$('#myUl a').on('click', handler function);`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-28T14:29:19.690

你错过了一个报价，但试试这个：

```
$('#myUl a').on('click', function(){alert('do stuff!')}); 
```

# ios - 使用 captureOutput:captureOutput didOutputSampleBuffer:sampleBuffer fromConnection:connection 捕获视频和显示图像

> ID：12641974
> 
> 赞同：3
> 
> 时间：2012-09-28T14:27:42.513
> 
> 标签：ios, avfoundation, objective-c-blocks, avcapturesession

我试图更好地理解 AVFoundation 框架以及各种 Core xxxx 框架，所以我决定尝试一个简单的视频捕获，看看我是否可以将图像作为图像输出到 UI。我查看了 rosyWriter 代码和文档，但没有任何答案。所以：

我有标准的捕获会话代码来添加输入和输出。以下内容与该问题相关：

```
//moving the buffer processing off the main queue
dispatch_queue_t bufferProcessingQueue=dispatch_queue_create("theBufferQueue", NULL);
[self.theOutput setSampleBufferDelegate:self queue:bufferProcessingQueue];
dispatch_release(bufferProcessingQueue); 
```

然后是代表：

```
-(void) captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
       fromConnection:(AVCaptureConnection *)connection
    {

    CVPixelBufferRef pb = CMSampleBufferGetImageBuffer(sampleBuffer);

    CIImage *ciImage = [CIImage imageWithCVPixelBuffer:pb];
    CGImageRef ref = [self.theContext createCGImage:ciImage fromRect:ciImage.extent];

    dispatch_async(dispatch_get_main_queue(), ^{
        self.testBufferImage.image= [UIImage imageWithCGImage:ref scale:1.0 orientation:UIImageOrientationRight];
    });
} 
```

问题：

1-我猜就像我在上面所做的那样，我们应该始终将委托设置为像我上面所做的那样在单独的队列上运行，而不是在主队列上运行。正确的？

2-结合，在委托方法中，任何处理 UI 的调用都必须像我一样放回主队列。正确的？

3- When I run this code, after about 5-10 seconds, I get a "Received memory warning" error and the app shuts. What could cause this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T19:47:41.620

1) Generally yes you should. You could run it on the main queue, but this can cause issues with UI responsiveness among other things.

2) Correct.

3) You are creating a series of CGImageRefs. Where are you releasing them?

For performance reasons you should probably use OpenGL if you need fine control over the rendering of the video. Otherwise you can use AVCaptureVideoPreviewLayer for an easy way to get a preview.

# javascript - 在 Jquery 中重新排序 ul 元素

> ID：12641975
> 
> 赞同：1
> 
> 时间：2012-09-28T14:27:43.130
> 
> 标签：javascript, jquery, jquery-ui

> **可能重复：**
> [JQuery UI 可排序：根据某些条件恢复位置](https://stackoverflow.com/questions/2661514/jquery-ui-sortable-restore-position-based-on-some-condition)

我遇到了一个小问题。我正在使用 Jquery UI 中的可排序插件来进行“大规模”重新排序。但是，我想允许用户“取消”他所做的所有重新排序。我已经`<li>`通过 HTML5 将“初始”订单保存到元素中。因此，我试图根据最初的“顺序”来按顺序取回列表。但是，在这个函数调用之后什么都没有出现......我不想只替换 inner-html，因为我想保留与每个 LI 关联的“数据”数据。

```
 function reverseBackCellsOrder(line) {
        var vals = {};
        var count = 0;
        var ul = $("#"+line+"-ul-sortable .sortable-items-"+line);

        ul.each(function (index){
            vals[$(this).data("order")] = $(this)[0];
            count++;
        });

        for(var i = 0; i < count; i++)
        {
            ul[i] = vals[i];
        }
    } 
```

编辑#1：很抱歉这个描述的“含糊不清”。我只是在函数被调用后查看了变量，并且“ul”元素保存了我想要的重新排序的元素，但是，它们没有正确显示在页面上。好像它“需要”重新粉刷。

# sql - 在字母数字字符串中生成下一个序列的 SQL 代码

> ID：12641981
> 
> 赞同：4
> 
> 时间：2012-09-28T14:28:08.473
> 
> 标签：sql, sql-server, tsql

我已经在 nvarchar 列中填充了一些字符串值。字符串的格式是这样的：

例如：16B、23G、128F、128M等...

我需要从中找出最大值，然后从代码中生成下一个。拾取最大物品的逻辑如下：

1.  拿起数字最大的字符串。
2.  如果多个最大的数字，然后拿起其中最大的字母字符串。

例如，上述系列中最大的字符串是 128M。

现在我需要生成下一个序列。下一个字符串将有

1.  与最大的数字相同，但字母加 1。IE 128N
2.  如果字母到达Z，则数字加1，字母为A。例如，128Z的下一个字符串是129A。

谁能让我知道什么样的 SQL 可以得到我想要的字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:45:28.377

如果您可以更改表定义（*），则保持基本值完全是数字并仅格式化为这些字符串会更容易：

```
create table T (
    CoreValue int not null,
    DisplayValue as CONVERT(varchar(10),(CoreValue / 26)+1) + CHAR(ASCII('A') + (CoreValue-1) % 26)
)
go
insert into T (CoreValue)
select ROW_NUMBER() OVER (ORDER BY so1.object_id)
from sys.objects so1,sys.objects so2
go
select * from T 
```

结果：

```
CoreValue   DisplayValue
----------- ------------
1           1A
2           1B
3           1C
4           1D
5           1E
6           1F
....
22          1V
23          1W
24          1X
25          1Y
26          2Z
27          2A
28          2B
29          2C
....
9593        369Y
9594        370Z
9595        370A
9596        370B
9597        370C
9598        370D
9599        370E
9600        370F
9601        370G
9602        370H
9603        370I
9604        370J 
```

所以插入一个新值*就像*从列中取出并加1一样简单`MAX`（假设可序列化隔离或类似，以处理多个用户）

* * *

(*) 即使你不能改变你的表定义——我仍然会生成这个表。然后，您可以将其连接到原始表，并可以使用它对列执行简单`MAX`的操作`int`，然后添加一个并查找下一个要使用的字母数字值。只需使用您期望使用的尽可能多的值填充它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:05:02.970

假设：

```
CREATE TABLE MyTable
    ([Value] varchar(4))
;

INSERT INTO MyTable
    ([Value])
VALUES
    ('16B'),
    ('23G'),
    ('128F'),
    ('128M')
; 
```

你可以做：

```
select top 1 
    case when SequenceChar = 'Z' then
        cast((SequenceNum + 1) as varchar) + 'A'
    else
        cast(SequenceNum as varchar) + char(ascii(SequenceChar) + 1)
    end as NextSequence
from (
    select Value, 
        cast(substring(Value, 1, CharIndex - 1) as int) as SequenceNum, 
        substring(Value, CharIndex, len(Value)) as SequenceChar
    from (
        select Value, patindex('%[A-Z]%', Value) as CharIndex
        from MyTable
    ) a
) b
order by SequenceNum desc, SequenceChar desc 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/f0cbb/33)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:59:25.483

假设您的列始终遵循您描述的格式（数字+1 字符后缀），您可以这样做

```
WITH cte1 AS(
SELECT LEFT(your_column,LEN(your_column)-1) as num, 
RIGHT(your_column,1) as suffix
FROM your_table),
cte2 AS (SELECT MAX(num) as max_num FROM cte1)
SELECT 
 CASE c.max_suffix
  WHEN 'Z' THEN 'A'
  ELSE NCHAR(UNICODE(c.max_suffix)+1)
 END as next_suffix,

CASE c.max_suffix
 WHEN 'Z' THEN a.max_num+1
 ELSE a.max_num
END as next_num

FROM  cte2 a 
CROSS APPLY (SELECT MAX(suffix) as max_suffix FROM cte1 b WHERE b.num=a.max_num)c
; 
```

我很确定还有其他方法可以做到这一点。另外，我的方法似乎不是最优的，但我认为它会返回你需要的东西......

**毫无疑问，如果您可以按照Damien_The_Unbeliever**的建议重新设计表格，那会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-11T11:55:02.450

生成以下格式的字母数字字符串序列。AB C......YZ AA AB......AZ BA BB......BZ......继续。

```
CREATE OR REPLACE FUNCTION to_az(in_num  number)

RETURN VARCHAR2

IS

 num          PLS_INTEGER    := TRUNC (in_num) - 1;
 return_txt     VARCHAR2 (1) := CHR (65 + MOD (num, 26));

BEGIN

 IF  num <= 25
 THEN
      RETURN     return_txt;
 ELSE
      RETURN     to_az (FLOOR (num / 26))
           || return_txt;
 END IF;
END to_az; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-22T16:46:23.907

ms-sql 函数生成一个字母数字的下一个序列 id，如 'P0001'、'P0002' 等。

```
ALTER FUNCTION NextProductID()
 returns varchar(20)
 BEGIN
    DECLARE  @NEXTNUMBER INT;
    DECLARE @NEXTPRODUCTID VARCHAR(20);
 SELECT @NEXTNUMBER=MAX( CONVERT(INT, SUBSTRING(PRODUCT_CODE,2,LEN(PRODUCT_CODE))))+1 FROM Product;
    --PRINT @NEXTNUMBER;
    SET @NEXTPRODUCTID=CONVERT(VARCHAR,@NEXTNUMBER)
    SELECT @NEXTPRODUCTID='P'+REPLICATE('0',6-LEN(@NEXTPRODUCTID)) + @NEXTPRODUCTID;
  return @NEXTPRODUCTID;
END 
```

这里 product 是表名，product_code 是列

# facebook - 使用 Facebook Javascript SDK 编译应用程序

> ID：12641994
> 
> 赞同：0
> 
> 时间：2012-09-28T14:28:40.727
> 
> 标签：facebook, sencha-touch, facebook-javascript-sdk, sencha-touch-2

我在尝试编译使用**Facebook Javascript SDK**的应用程序时偶然发现了一个问题：

```
[ERROR] ReferenceError: Can't find variable: FB 
```

这是我的设置：

**索引.html**

```
...

<script id="microloader" type="text/javascript" src="sdk/microloader/development.js"></script>

  <!-- dependencies -->
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : 'XXXXXXXXXXXXX', // App ID
        channelUrl : '//payme.com:3000/channel.html', // Channel File
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
      });

      // Additional initialization code here
    };

    // Load the SDK Asynchronously
    (function(d){
       var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = "//connect.facebook.net/en_US/all.js";
       ref.parentNode.insertBefore(js, ref);
     }(document));
  </script>
... 
```

**Home.js**（捕获错误的地方）

```
...
  config: {
    controls: {
      mainView: {
        initialize: 'initView'
      }
    }
  },

  initView: function() {
    var me = this;

    FB.getLoginStatus(function(response) {
      if(response.status === 'connected') {       
        ...
      } else {
        ...
      }
    });
  },
... 
```

我尝试异步和同步加载 Facebook SDK，将脚本标签放在微加载器之前和之前，但没有任何效果。

**关于如何解决这个问题的任何想法？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:57:10.483

您正在异步加载 Facebook JavaScript SDK，并且可能在加载 SDK 之前调用该方法`FB.getLoginStatus`。加载 SDK 后调用该方法`FB.getLoginStatus`（即在您拥有的行上`// Additional initialization code here`）

# sql-server - CTE 返回层次结构中的所有项目

> ID：12641995
> 
> 赞同：2
> 
> 时间：2012-09-28T14:28:45.493
> 
> 标签：sql-server, sql-server-2008, common-table-expression, recursive-query

我有一个具有递归层次结构的表（即 ID、ParentID）。对于此层次结构中的任何项目，我希望能够带回层次结构上下所有内容的列表以及每一行的级别。假设父母只能有一个孩子。

举个例子：

```
ID    ParentID
--------------
1     NULL
2     1
3     2
4     NULL
5     4
6     5 
```

给定 ID 1、2 或 3，我想返回：

```
ID    ParentID    Level
-----------------------
1     NULL        1
2     1           2
3     2           3 
```

我以前做过，但我不记得是怎么做的。我知道解决方案涉及 CTE，但我无法正确解决！任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:34:47.617

```
;with cte as 
(
    select *, 1 as level from @t where id = @yourid
    union all
    select t.*, level - 1
    from cte 
        inner join @t t on cte.parent = t.id
),
cte2 as
(   
    select * from cte
    union all
    select t.*, level+1
    from cte2 
        inner join @t t on cte2.id = t.parent

)
    select id,parent, ROW_NUMBER() over (order by level) level
    from (  select distinct id, parent, level from cte2) v 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-12T15:57:57.000

我能想到的最简单的 CTE 查询版本是：

```
WITH Ancestry (AncestorID, DescendantID)
AS
(
    SELECT 
        ParentID, ID
    FROM
        dbo.Location
    WHERE
        ParentID IS NOT NULL
UNION ALL
    SELECT 
        P.AncestorID, C.ID
    FROM
        dbo.Location C
    JOIN
        Ancestry P on C.ParentID = P.DescendantID
)
SELECT * FROM Ancestry 
```

结果是表中存在的所有祖先/后代关系的列表。

最后的“SELECT * FROM Ancestry”可以用更复杂的过滤、排序等替换。

To include reflexive relationships, the query can be modified by adding two lines to the final SELECT statement:

```
SELECT * FROM Ancestry
UNION
SELECT ID, ID FROM dbo.Location 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-01T09:56:31.170

```
;WITH Recursive_CTE AS (
     SELECT
          child.ExecutiveId,
          CAST(child.ExecutiveName as varchar(100)) BusinessUnit,
          CAST(NULL as bigint) ParentUnitID,
          CAST(NULL as varchar(100)) ParentUnit,
          CAST('' as varchar(100)) LVL,
          CAST(child.ExecutiveId as varchar(100)) Hierarchy,
      1 AS RecursionLevel
     FROM Sales_Executive_level child
     WHERE ExecutiveId = 4000 --your Id which you want to get all parent node
     UNION ALL 
     SELECT
      child.ExecutiveId,
      CAST(LVL + child.ExecutiveName as varchar(100)) AS BusinessUnit,
      child.ParentExecutiveID,
      parent.BusinessUnit ParentUnit,
      CAST('' + LVL as varchar(100)) AS LVL,
      CAST(Hierarchy + ':' + CAST(child.ExecutiveId as varchar(100)) as varchar(100)) Hierarchy,
      RecursionLevel + 1 AS RecursionLevel
     FROM Recursive_CTE parent 
     INNER JOIN Sales_Executive_level child ON child.ParentExecutiveID = parent.ExecutiveId                           
    )
    SELECT * FROM Recursive_CTE ORDER BY Hierarchy  
    OPTION (MAXRECURSION 300); 
```

# java - 从自定义标签属性传递数组

> ID：12641996
> 
> 赞同：3
> 
> 时间：2012-09-28T14:28:45.807
> 
> 标签：java, jsp, jakarta-ee, jsp-tags, taglib

我正在尝试在我的自定义标签的属性中传递一个整数数组。这是我到目前为止所做的。

你好.tld

```
<taglib>
    <tlib-version>1.0</tlib-version>
    <jsp-version>2.1</jsp-version>
    <short-name>helloTag</short-name>
    <uri>/WEB-INF/lib/hello</uri>
    <tag>
        <name>arrayIterator</name>
        <tag-class>bodyContentPkg.ArrayIterator</tag-class>
        <bodycontent>JSP</bodycontent>
        <attribute>
            <name>array</name>
            <required>true</required>
            <rtexprvalue>true</rtexprvalue>
        </attribute>
    </tag>
</taglib> 
```

ArrayIterator.java

```
package bodyContentPkg;

import java.io.IOException;

import javax.servlet.jsp.JspException;
import javax.servlet.jsp.JspWriter;
import javax.servlet.jsp.tagext.BodyTagSupport;

    public class ArrayIterator extends BodyTagSupport{
        int count;
        int[] myArray;
        int returnValue;

        public int[] getArray(){
            return myArray;
        }

        public void setArray(int[] myArray){
            this.myArray=myArray;
        }

        @Override
        public int doStartTag() throws JspException {
            count=0;
            return EVAL_BODY_INCLUDE;
        }

        @Override
        public int doAfterBody() throws JspException {
            if(count==myArray.length-1){
                returnValue=SKIP_BODY;
            }
            else{
                returnValue=EVAL_BODY_AGAIN;
                if(count<myArray.length){
                    JspWriter out = pageContext.getOut();
                    try {
                        out.println(myArray[count]);
                    } catch (IOException e) {
                            e.printStackTrace();
                    }
                }
                count++;
            }
            return returnValue;
        }
    } 
```

正文内容.jsp

```
<%@taglib prefix="cg" uri="/WEB-INF/lib/hello.tld" %>
<%pageContext.setAttribute("myArray", new int[] {1,2,3,4,5,6});%>
<cg:arrayIterator array="${myArray}"></cg:arrayIterator> 
```

当我运行 jsp 文件时，我得到一个空白页。不知道怎么了。

另一个问题是如何直接从 tag 属性传递数组，而无需设置 pageContext 的属性并避免编写 scriptlet？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T09:31:13.190

`when i run the jsp file i get a blank page. dont know whats wrong.`

您正在使用没有任何正文内容的标签，因此`doAfterBody()`不被调用。将标签更改为以下内容：

`<cg:arrayIterator array="${myArray}">&#160;</cg:arrayIterator>`

# ios - ASIFormDataRequestclass 不适用于 iOS6

> ID：12641997
> 
> 赞同：1
> 
> 时间：2012-09-28T14:28:47.320
> 
> 标签：ios

我的应用程序我正在使用 ASIFormDataRequest 类，但似乎它们不适用于升级到 iOS6 的设备。

我总是得到**空响应**

有什么建议么？或者网上有新版本吗？

我以前认为它的 ASIHTTPRequest 但错误似乎在 ASIFormDataRequest 中......

谢谢

**问题更新**

ASIFormDataRequest Web 服务在我的应用程序中无法在 iPod1+iOS 6 上运行，但在 iPad 和 iPhone 上运行良好...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:49:48.277

ASIHTTPRequest 不再被维护。开发人员停止了该项目的工作，因此 iOS 6 的更新可能永远不会到来（我自己还没有在 iOS 6 上测试过，所以我不知道问题是否肯定是由于 iOS 6 造成的）。

你可能会慢慢地想要转移到其他图书馆。[AFNetworking](https://github.com/AFNetworking/AFNetworking)就是一个例子。