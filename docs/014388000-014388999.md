# StackOverflow 问答 14388000-14388999

# regex - 检查 url 是否与特定结构匹配

> ID：14388000
> 
> 赞同：1
> 
> 时间：2013-01-17T20:59:02.183
> 
> 标签：regex, vb.net

我想检查 Request.RawURL 字符串是否与某个结构匹配。

要检查的结构是：

```
/health/<integer>/<string> 
```

例如

```
/health/301/personal-trainers-at-work 
```

如果原始 url 与此结构匹配，我希望表达式评估为真。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:08:35.593

使用这个正则表达式`/health/\d+/[\w-]+`

```
/health/ const srting    
\d+      1 or more integers    
/        const srting    
[\w-]+   1 or more alphanumeric characters _ or - 
```

# java - 通过 API 更新 TextView 时出现 CalledFromWrongThreadException

> ID：14388001
> 
> 赞同：0
> 
> 时间：2013-01-17T20:59:02.217
> 
> 标签：java, android

我正在使用 API。当我单击应用程序中的按钮时，它会调用一个从应用程序请求数据的同步 void。然后数据由 CReceiver 在实现的方法 userInfo 中返回，我将返回的数据附加到 TextView。我可以 System.out.println userInfo 中的信息并且它可以工作，但是如果我尝试附加 TextView，我会得到一个 CalledFromWrongThreadException。使用此信息更新 TextView 的正确方法是什么？

主要活动

```
 public class MainActivity extends Activity implements CReceiver {
       private CSocket c_client = new CSocket(this);
       private TextView textLog;

       @Override
       protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);

            Button btnReqUser = (Button) findViewById(R.id.btnReqUser);

            textLog = (TextView) findViewById(R.id.textLog);

            btnReqUser.setOnClickListener(new OnClickListener() {
                @Override
                public void onClick(View v) {
                    c_client.reqUser("roger");
                }
            });
       }

       @Override
       public void userInfo(String firstName, String lastName, String address, String phone) {
       // TODO Auto-generated method stub
       textLog.append(firstName + " " + lastName + " " + address + " " + phone);    
       }
    } 
```

CSocket

```
 public synchronized void reqUser(String userName) {
    ...
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:01:08.233

> 使用此信息更新 TextView 的正确方法是什么？

由于这是一个`Activity`，使用`runOnUiThread()`：

```
@Override
   public void userInfo(String firstName, String lastName, String address, String phone) {
   runOnUiThread(new Runnable() {
     public void run() {
       // do something here with your TextView
     }
   });
} 
```

# jquery - jQuery 音频按钮

> ID：14388007
> 
> 赞同：1
> 
> 时间：2013-01-17T20:59:11.713
> 
> 标签：jquery, html, html5-audio

我有一个按钮播放声音文件的问题。

有两个按钮，一个是启用声音按钮，另一个是在单击时播放声音。基本上，只有“启用”类的按钮会播放声音，但是当我将按钮的类设置为启用然后单击它时，什么也没有发生。

[这里的](http://jsbin.com/agesem/2/)工作示例

这是代码：

```
<!DOCTYPE html>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>
<script>
    $(document).ready(function() {
    var audioElement = document.createElement('audio');
    audioElement.setAttribute('src', 'http://cd.textfiles.com/10000soundssongs/WAV/DOORBELL.WAV');

    $('.enabled').click(function() {
    audioElement.play();
});
});
</script>
<script>
  $(document).ready(function() {
  $('#enabler').click(function() {
  $('.disabled').attr('class','enabled');
  $('.enabled').text('Play (enabled)');
});
});
</script>
<style>
.enabled{color:green;}
</style>
</head>
<body>
<button class="disabled">Play</button>
<button id="enabler">Make Play-Button work</button>
</body>
</html> 
```

一如既往，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:15:06.830

问题是，当您为选择器启动`click`事件侦听`.enabled`器时，没有任何具有该类的元素`enabled`可以将函数绑定到。您需要将事件侦听器绑定到存在的父元素，以便在单击按钮时它将运行该函数。

你需要改变

```
$('.enabled').click(function() {
    audioElement.play();
}); 
```

到

```
$(document).on('click', '.enabled', function() {
    audioElement.play();
}); 
```

这是一个显示这一点的[jsbin](http://jsbin.com/agesem/5/edit)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:00:31.853

```
<button id="enabler">Make Play-Button work</button> 
```

您在这一行有错误，它的启用程序和需要启用它:-)

# ms-access - 选择不在子查询 Access 2010 中的位置

> ID：14388009
> 
> 赞同：1
> 
> 时间：2013-01-17T20:59:20.933
> 
> 标签：ms-access, select, subquery, where

我有一个如下所示的查询：

```
SELECT *
FROM servTable, serialTable
WHERE servTable.[Service Tag]=serialTable.[Serial Number]; 
```

这个查询，假设我没有犯任何错误，应该从两个表中提取所有信息，其中序列和服务列匹配。

我还需要从没有匹配的每个表中提取所有信息。我已经尝试使用以下查询来做到这一点，但它们似乎不起作用。

```
SELECT *
FROM serialTable WHERE serialTable.[Serial Number] <> ( SELECT *
FROM servTable, serialTable
WHERE servTable.[Service Tag]=serialTable.[Serial Number] ); 
```

和

```
SELECT *
FROM servTable WHERE servTable.[Service Tag] <> ( SELECT *
FROM servTable, serialTable
WHERE servTable.[Service Tag]=serialTable.[Serial Number] ); 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:27:19.877

1 场比赛

```
SELECT *
FROM servTable
INNER JOIN serialTable
ON servTable.[Service Tag]=serialTable.[Serial Number]; 
```

2 不匹配，只有一侧

```
SELECT *
FROM servTable
LEFT JOIN serialTable
ON servTable.[Service Tag]=serialTable.[Serial Number]
WHERE serialTable.[Serial Number] Is Null 
```

MS Access 中有 Find Matched 和 Find Unmatched 查询向导。

# html - 单选按钮和标签在同一行对齐

> ID：14388013
> 
> 赞同：-1
> 
> 时间：2013-01-17T20:59:34.693
> 
> 标签：html, css

如何使单选按钮和单选按钮的标签在同一行对齐。我给跨度标签提供了边距和填充，但它的主题是移动它的解决方案是什么

```
<form class="navbar-form pull-right" style="">
    <input type="radio" name="sex" value="male"><span>All</span>
    <input type="radio" name="sex" value="female"><span>Name<span>
    <input type="radio" name="sex" value="male"><span>Vendor No.<span>
    <input type="radio" name="sex" value="female"><span>Contact<span>
    <input type="radio" name="sex" value="male">Address<span>
    <input type="radio" name="sex" value="female">Phone
    <input class="span2" type="password">
    <input name="Finish" value="Search" class="checkout-button searchButton" type="submit" style="width: 107px;padding-left: 0px;padding-right: 0px;">
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:07:53.610

您可以尝试使用实际标签... [http://jsfiddle.net/uBUhw/](http://jsfiddle.net/uBUhw/)

```
<form class="navbar-form pull-right">
    <label><input type="radio" name="sex" value="male" /> All</label>
    <label><input type="radio" name="sex" value="female" /> Name</label>
    <label><input type="radio" name="sex" value="male" /> Vendor No.</label>
    <label><input type="radio" name="sex" value="female" /> Contact</label>
    <label><input type="radio" name="sex" value="male" /> Address</label>
    <label><input type="radio" name="sex" value="female" /> Phone</label>
    <input class="span2" type="password" />
    <input name="Finish" value="Search" class="checkout-button searchButton"
    type="submit" />
</form> 
```

使用此设置，单选按钮将全部内联。如果您希望每个单选按钮单独一行，您可以这样做：

```
.navbar-form label{
    display:block;
} 
```

# c++ - 防止 X 按钮关闭 MFC 对话框

> ID：14388014
> 
> 赞同：0
> 
> 时间：2013-01-17T20:59:48.673
> 
> 标签：c++, mfc

我想防止单击窗口 X 按钮时关闭 MFC 对话框，而是希望像 ShowWindow(SW_HIDE); 那样隐藏我的窗口；

我尝试了 WM_ON_CLOSE，我收到关闭消息，我保存了我的工作，但无法阻止我的程序终止并最小化到托盘。

我想阻止 X 按钮关闭我的对话框，而不是隐藏它。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:02:40.397

尝试添加[`WM_SYSCOMMAND`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646360%28v=vs.85%29.aspx)处理程序并捕获`SC_CLOSE`命令。

但在你这样做之前，请重新考虑你是否想这样做。关闭按钮是 Windows 中最基本的控件之一，覆盖其行为只会令人困惑。

# php - iMacros 解决方案或 MAMP 中 php 脚本的替代方案

> ID：14388017
> 
> 赞同：0
> 
> 时间：2013-01-17T21:00:03.447
> 
> 标签：php, com, mamp, imacros

所以基本上我想在 MAMP 环境中使用 PHP 从 Web 浏览器（通过 url）调用 iMacro 脚本。`COM`这需要使用仅在 Windows 中使用的内置类。我需要一个解决方案或替代方案来做我需要的事情......有人知道吗？

我会寻找支持 PHP 脚本且不需要的 iOpus iMacros 替代插件，或者寻找`COM`不使用`COM`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:32:43.480

根据您正在与之交互的站点的详细信息，几乎可以肯定地与它进行交互而无需涉及真正的浏览器。如果不确切知道该站点是什么，就不可能说什么最有效，但是使用 Firebug 或 Chrome Inspector 之类的工具来嗅探 HTTP 请求的内容会对您有很大帮助。

一旦您知道必要的请求是什么样的，PHP`curl`扩展就是执行它们的最佳方式。

# native - 通过单击浏览器或电子邮件中的链接启动 BB10 应用程序

> ID：14388021
> 
> 赞同：2
> 
> 时间：2013-01-17T21:00:28.817
> 
> 标签：native, blackberry-10, playbook

是否可以注册在浏览器、电子邮件或 bbm 中请求特定 URL 时启动的应用程序？

例如，我希望当用户单击链接 flycraft://replay/123 时，我的应用程序将被启动并传递 URI。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T09:54:53.257

目前这是不可能的。

这有两个部分：

1.  向浏览器注册 URI 方案。例如`flycraft://`，以便浏览器知道将这些链接视为可调用的。
2.  注册您的应用程序以处理`flycraft://`调用，以便您的应用程序加载。

不幸的是，第一部分目前是不可能的。有计划，但现阶段没有具体的计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T23:07:28.860

是的！您可以使用 BB10[调用框架](http://developer.blackberry.com/cascades/documentation/device_platform/invocation/invocation_framework.html)来做到这一点。[appurl.org](http://appurl.org/docs/bb10)提供了相当多的细节。简而言之：

1.  如果您还没有调用目标，请在 bar-descriptor.xml 文件中添加一个调用目标。
2.  为您的目标添加一个目标过滤器，其中包含操作“bb.action.VIEW”和“bb.action.OPEN”以及标签`<property var="uris" value="flycraft:"> </property>`
3.  将一个`invokeManager`对象添加到您的应用程序中`main`，并将其`invoked`信号连接到可以处理该请求的代码的某个插槽。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-16T09:03:31.073

在 BlackBerry 10 上执行此操作的方法是在条形描述符文件中添加以下代码：

```
<invoke-target id="eu.nlogn.flycraftplaybook.replayview">
<invoke-target-type>application</invoke-target-type>
    <filter>
        <action>bb.action.VIEW</action>
        <mime-type>*</mime-type>
        <property value="flycraft://" var="uris" />
    </filter>
</invoke-target> 
```

那么你应该监听 NAVIGATOR_INVOKE_TARGET 事件并像这样处理它：

```
const navigator_invoke_invocation_t *invoke = navigator_invoke_event_get_invocation(event);

if (invoke) {
    // retrieve invocation action
    const char *action = navigator_invoke_invocation_get_action(invoke); 
const char *uri = navigator_invoke_invocation_get_uri(invoke);  

if (action && uri) {
        // handle the uri you got
    }
} else {
    fprintf(stderr, "Error retrieving invocation: %s\n", navigator_event_get_err(event));                               
} 
```

不幸的是，在 Playbook 上没有办法做到这一点。

# javascript - 函数调用对象内的函数

> ID：14388025
> 
> 赞同：-1
> 
> 时间：2013-01-17T21:00:39.180
> 
> 标签：javascript

假设我有一个 Javascript 对象（大括号表示它是这样的）：

```
{
   a: function (something) {
      return something*2;
   },
   b: function () {
      var c = this.a(2);      //Does not work. Why?
      return c;
   }
} 
```

解决方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:04:52.593

它不起作用，因为当您访问方法时`b`，它的上下文不是您创建的对象的实例，它会尝试在绑定的上下文或`window`对象中搜索。

```
var x = {
   a: function (something) {
      return something*2;
   },
   b: function () {
      var c = x.a(2);      //Does not work. Why?
      return c;
   }
} 
```

这样，您就可以使用`x`as 上下文来访问方法`a`。

或者您可以使用`new`运算符来创建您的对象和方法，作为它的原型或直接方法。

当你这样做时，结果将是：

```
var x = function() {
    return {
       a: function (something) {
          return something*2;
       },
       b: function () {
          var c = this.a(2);      //Does not work. Why?
          return c;
       }
    }
} 
```

当你创建一个新实例时，它会让你失去`prototype`from `x`，但你的代码可以工作。

例子：

```
var y = new x();
console.log(y.b()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:03:36.830

它对我有用，你在`a`声明后失去了昏迷。

```
{
   a: function (something) {
      return something*2;
   }, // -> this one
   b: function () {
      var c = this.a(2);
      return c;
   }
} 
```

如果你调用`b`函数应该返回`a(2)`2*2=`4`

```
alert(p.b()); 
```

[http://jsfiddle.net/PNbXj/](http://jsfiddle.net/PNbXj/)

# html - YouTube iFrame API - 启用原生控件

> ID：14388026
> 
> 赞同：0
> 
> 时间：2013-01-17T21:00:39.827
> 
> 标签：html, ipad, iframe, youtube

有没有办法通过 YouTube Iframe API 显示本机控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:45:30.503

我不确定这在 iPad 上是否可行，因为所有播放都是由 iOS 本身处理的。

如果您像这样使用 HTML5 播放器，您可能想尝试在您的函数中`controls=1`设置：`playerVars`

> ```
> playerVars: {
>     'controls': 1
> }, 
> ```

有关 iFrame API 的更多信息，请参阅[此 google 开发者页面](https://developers.google.com/youtube/iframe_api_reference#Loading_a_Video_Player)。

# objective-c - XCode 分发证书在配置门户、组织者和钥匙串中有效，但在代码签名中无效

> ID：14388027
> 
> 赞同：0
> 
> 时间：2013-01-17T21:00:41.687
> 
> 标签：objective-c, xcode, certificate, distribution, provisioning

正如标题所说，分发证书在钥匙串、供应门户和管理器中显示为有效。但是在代码签名中，当设置自动时，我在“没有配置文件的身份”或“当前没有匹配的配置文件”下看到“iPhone 分发：我的名字”。

我已经两次吊销了我的开发人员和分发证书，并通过 Xcode 请求并接收了新证书（遵循 stackoverflow 和 Apple 指南），但我无法在没有收到错误的情况下进行分发。任何帮助将不胜感激谢谢，史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:57:12.010

您是否使用证书和应用程序 ID 创建了配置文件？

# java - 使用 JPA 创建树

> ID：14388037
> 
> 赞同：2
> 
> 时间：2013-01-17T21:01:29.313
> 
> 标签：java, database, jpa, tree

我正在尝试使用实体和 JPA 创建树。我有一个具有以下属性的类。

```
public class Dir
{

@Id
@Basic(optional = false)
@NotNull
@Column(name = "dirId")
private Integer dirId;

@OneToOne(mappedBy="dirId", cascade= CascadeType.ALL)
private Dir parent;
... 
```

一个节点知道它的父节点是谁，如果它没有父节点，它就是根节点。这就是我可以轻松构建一棵树的方法。但是......我认为映射对于这个想法是不正确的。尝试部署时出现以下错误：

```
An incompatible mapping has been encountered between [class com.dv.oa.model.entity.dir.Dir] and [class com.dv.oa.model.entity.dir.Dir]. This usually occurs when the cardinality of a mapping does not correspond with the cardinality of its backpointer. 
```

它谈到了基数。但这没有意义，一个节点只能有一个父节点。这就是我选择的原因`@OneToOne`

任何人都可以对此有所了解吗？我想另一种问这个问题的方法是，你如何将一个实体映射到它自己的另一个实例？

编辑

这是我的表结构：

```
mysql> describe dir;
+--------------+--------------+------+-----+---------+-------+
| Field        | Type         | Null | Key | Default | Extra |
+--------------+--------------+------+-----+---------+-------+
| dirId        | int(11)      | NO   | PRI | NULL    |       |
| DTYPE        | varchar(31)  | YES  |     | NULL    |       |
| dirName      | varchar(255) | YES  |     | NULL    |       |
| companyOwner | int(11)      | YES  | MUL | NULL    |       |
| userOwner    | int(11)      | YES  | MUL | NULL    |       |
| parent       | int(11)      | YES  |     | NULL    |       |
+--------------+--------------+------+-----+---------+-------+
6 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:14:51.823

You're pointing to the wrong column for the owning side of the mapping. Also your relationship is not OneToOne because a single Parent can have many Children.

```
@Entity
public class Dir
{

  //This field is a table column
  //It uniquely identifies a row on the DIR table
  @Id
  private int dirId;

  //This field is a table column
  // It identifies the parent of the current row
  // It it will be written as the type of dirId
  // By default this relationship will be eagerly fetched
  // , which you may or may not want
  @ManyToOne(fetch=FetchType.LAZY, cascade={CascadeType.PERSIST, CascadeType.MERGE})
  private Dir parent;

  //This field is not a table column
  // It is a collection of those Dir rows that have this row as a parent. 
  // This is the other side of the relationship defined by the parent field.
  @OneToMany(mappedBy="parent")
  private Set<Dir> children;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:06:46.113

问题似乎是属性**mappedBy**，尝试将其删除。我认为您不需要使用类似的东西来实现。

```
@Entity
public class Dir {

@Id
@Basic(optional = false)
@NotNull
@Column(name = "dirId")
private Integer dirId;

@OneToOne(cascade=CascadeType.ALL )
private Dir parent;

    ....

} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-17T21:22:53.933

您应该执行[Composite Pattern](http://en.wikipedia.org/wiki/Composite_pattern)。使用 JPA 很简单：

*   创建一个抽象基类，例如 FileSystemItem。
*   创建一个名为 Folder 的类和一个名为 File 的类，它们都扩展了 Node.js。
*   选择继承策略。为此，您可能会使用鉴别器并将两种类型都放在一个文件中。
*   将属性名称放在基类中。
*   在文件夹类中创建一个集合，而不是 Files，而是 FileSystemItems。

差不多就是这样。另一个重大决定是如何处理 add 方法。如果你把它放在基类中，如果有人在 File 上调用它，你必须抛出一个不受支持的操作异常。

# sql - 透视带有文本且没有聚合的表格

> ID：14388041
> 
> 赞同：4
> 
> 时间：2013-01-17T21:01:43.417
> 
> 标签：sql, pivot, pivot-table

我一直在查看 StackOverflow 问题，但还没有真正找到解决这个问题的问题。

我有一张桌子，基本上安排如下：

```
Table.LineID
Table.QuestionGroup
Table.Question
Table.Answer 
```

而且我想“旋转”表格，但问题和答案没有任何要汇总的内容。例如，它们都只是文本字段，可能是：

```
Table.LineID = 00001
Table.QuestionGroup = Color
Table.Question = Outside Color
Table.Answer = Dark Green

Table.LineID = 00001
Table.QuestionGroup = Size
Table.Question = Height
Table.Answer = 180 3/4 
```

我正在尝试旋转表格，以便我可以获得相关联的行 ID 并使传播函数成为问题所以它看起来像

行号 | 问题 1 | 问题 2 | ETC...

| 答案 1 | 答案 2 | ETC...

我看过这个[https://stackoverflow.com/a/7744347/839330](https://stackoverflow.com/a/7744347/839330)除了这似乎更多地参考了一些 VB 代码（也许我错了？）。有谁知道我应该如何处理这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-17T21:18:05.880

仅仅因为您的表中有文本数据并不意味着您不能对其使用聚合函数。

您没有指定您使用的是什么 RDBMS，但这种类型的数据转换是一个数据*转换*。这会将行数据转换为列。一些数据库有一个数据透视函数，但是如果你使用一个没有该函数的数据库，那么你需要使用一个带有`CASE`表达式的聚合函数：

```
select lineid,
  max(case when question ='Height' then answer else '' end) Height,
  max(case when question ='Outside Color' then answer else '' end) [Outside Color]
from yourtable 
group by lineid 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/a2237/5)

如果您有一个具有数据透视函数的数据库（SQL Server 2005+/Oracle 11g+），那么您的代码将类似于：

```
select *
from 
(
  select lineid,
    Question,
    Answer
  from yourtable
) src
pivot
(
  max(answer)
  for question in ([Height], [Outside Color])
) piv; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/8a90b/1)

现在，如果您使用的是 SQL Server 2005+，并且您有未知数量的要转换为列的问题，那么您可以使用类似于以下的动态 sql：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(Question) 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT lineid,' + @cols + ' from 
             (
                select lineid,
                  Question,
                  Answer
                from yourtable
            ) x
            pivot 
            (
                max(Answer)
                for Question in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/8a90b/3)

根据您的样本数据，结果是：

```
| LINEID |  HEIGHT | OUTSIDE COLOR |
------------------------------------
|      1 | 180 3/4 |    Dark Green | 
```

# jqgrid - jqGrid - 重新排序列后，排序将数据映射到原始列

> ID：14388042
> 
> 赞同：1
> 
> 时间：2013-01-17T21:01:43.463
> 
> 标签：jqgrid, jquery-ui-sortable

**编辑**：最终解决方案如下。

无论我尝试通过标题拖动还是通过列选择器插件来实现列重新排序，在重新排序列之后，单击任何列标题进行排序都会导致已排序的列被加载到表中的原始位置。使用可排序的方法：

```
sortable: { 

update: function (perm) {
    /*
     * code to save the new colmodel goes here
    */
    // the following line doesn't seem to do anything... just seems to return an array identical to 'perm'
    $("#mainGrid").jqGrid("getGridParam", "remapColumns");

    // if included, the next line causes the headers to not move
    $("#mainGrid").jqGrid("remapColumns", perm, true); 

    // this alternate allows them to move, but the newly sorted columns still get remapped to their original position
    $("#mainGrid").jqGrid("remapColumns", [0,1,2,3,4,5,6,7,8,9,10,11,12], true);

    /* the following allows the headers to move, and allows the sort to occur ONLY
     * if the order coming back from the database is unchanged. Note that in my real
     * code I create an array of consecutive integers to pass as the first param to
     * remapColumns()
     */
    $("#mainGrid").jqGrid("remapColumns", [0,1,2,3,4,5,6,7,8,9,10,11,12], true, false);
}
} 
```

当第一次到达页面时，它会从一个 xml 文件创建一个默认的列模型。当用户对标题重新排序时，新的列模型和列名将作为 JSON 字符串存储在数据库中。当用户进行另一个数据库调用时，该函数从数据库中读取新的列顺序并创建具有新顺序的数据数组。

问题似乎是在 jqGrid 重新映射列之后，它仍然希望看到以原始顺序从服务器返回的数据。所以如果原始数据是

```
[ [A1, B1, C1], [A2, B2, C2], [A3, B3, C3] ] 
```

将列重新映射到顺序 C 后 | 一个 | B、jqGrid 仍然希望数据以原始顺序返回。

我的最终解决方案是从 sortable.update() 函数中删除保存列模型状态的代码，并将其放入**window.onbeforeunload()**中。这样，只有在用户退出页面时才会保存状态。希望这对其他人有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:08:52.637

请参阅已编辑的问题。如果没有更新 colModel 的方法，最好的解决方案似乎是将状态保存函数放入 window.onbeforeunload() 中。

# probability - 自动概率密度

> ID：14388046
> 
> 赞同：0
> 
> 时间：2013-01-17T21:02:20.153
> 
> 标签：probability, automatic-differentiation

我发现在编写数学软件时自动微分非常有用。我现在必须处理随机变量和随机变量的函数，在我看来，类似自动微分的方法也可以用于此。

这个想法是从具有给定多元分布的基本随机向量开始，然后您想要处理随机向量分量函数的隐含概率分布。这个想法是定义运算符，当您添加、相乘、除以两个随机变量时自动适当地组合两个概率分布，并在您应用诸如取幂之类的标量函数时适当地转换分布。然后，您可以结合这些来构建原始随机变量所需的任何函数，并自动获得相应的概率分布。

这听起来可行吗？如果不是，为什么不呢？如果是这样，并且由于它不是一个特别原始的想法，有人可以指出我现有的实现，最好是在 C 中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T12:21:42.233

在概率编程方面有很多工作。一个问题是，随着您的分布变得越来越复杂，您开始需要更复杂的技术来从中采样。

有多种方法可以做到这一点。概率图形模型为表达这些模型提供了一个词汇表，然后您可以使用各种 Metropolis-Hastings 风格的方法从中采样。[这是一个速成课程](http://web.mit.edu/~wingated/www/introductions/mcmc-gibbs-intro.pdf)。

另一种模型是概率编程，它可以通过嵌入式领域特定语言直接完成。Oleg Kiselyov 的[HANSEI](http://okmij.org/ftp/kakuritu/index.html)就是这种方法的一个例子。一旦他们有了程序，他们就可以检查决策树，并通过一种重要性抽样的形式将它们扩展，以便在每个步骤中获得尽可能多的信息。

您可能还想阅读Wingate 等人的[“用于有效推理的概率程序的非标准解释” 。](http://web.mit.edu/wingated/www/papers/opover.pdf)它描述了一种使用有关分布导数的额外信息来加速 Metropolis-Hastings 式采样技术的方法。我个人使用自动微分来计算这些导数，这将话题带回了自动微分。;)

# web-applications - 用于网站的 facebook 社交插件

> ID：14388051
> 
> 赞同：-1
> 
> 时间：2013-01-17T21:02:29.483
> 
> 标签：web-applications, facebook-social-plugins

我想知道他们在网站上使用的社交插件，因为我想在他们的网站上为客户添加相同的插件。该网站是smithandwillis.com，插件位于左侧，靠近底部。

我查看了插件，没有一个看起来与这个完全一样。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T10:09:02.550

您能否告诉我们您正在寻找插件的网站技术？您可以查看许多第三方供应商，例如 loginradius、janrain、gigya，因为它们为许多 cms 和 sdks 提供了已构建的插件以用于核心技术

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:15:28.873

[https://developers.facebook.com/docs/reference/plugins/like-box/](https://developers.facebook.com/docs/reference/plugins/like-box/)

With show faces off, and show stream on

# c++ - 在调用 CoCreateInstance 之前，我是否需要检查注册表的 killbits/safe 以进行脚本编写/safe 以进行初始化？

> ID：14388055
> 
> 赞同：0
> 
> 时间：2013-01-17T21:02:41.130
> 
> 标签：c++, activex

我正在尝试了解 ActiveX 对象的细节、它们的工作方式以及使用它们的安全方法。

我知道 Internet Explorer 通过在注册表中查找对象来检查对象是否可用于脚本编写和初始化是否安全。IE 也会检查killbits。

这是在调用 CoCreateInstance 时自动完成的，还是在调用 CoCreateInstance 之前我必须自己完成？

# javascript - 从javascript中的查询字符串解析变量

> ID：14388056
> 
> 赞同：-2
> 
> 时间：2013-01-17T21:02:46.777
> 
> 标签：javascript, jquery

> **可能重复：**
> [如何获取查询字符串值？](https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values)

我有以下查询字符串：

```
"active_tab=delivered&active_tab=all&active_tab=delivered&active_tab=outstanding
&active_tab=delivered&active_tab=outstanding&active_tab=all&active_tab=delivered&active_tab=outstanding&title_filter=conformance&title_filter=delivering&title_filter=packaging
&title_filter=delivering&title_filter=all&title_filter=delivering&title_filter=all&title_filter=packaging&title_filter=conformance&title_filter=packaging
&title_filter=delivering&title_filter=packaging&title_filter=ordered" 
```

我将如何解析上述查询字符串中的最终`title_filter`（“ordered”）和（“delivered”）？`active_tab`此外，如果该查询字符串变量不存在，则拥有它 =`""`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T21:08:16.953

```
var query = {};

var largeString = "active_tab=delivered&active_tab=all&active_tab=delivered&active_tab=outstanding&active_tab=delivered&active_tab=outstanding&active_tab=all&active_tab=delivered&active_tab=outstanding&title_filter=conformance&title_filter=delivering&title_filter=packaging&title_filter=delivering&title_filter=all&title_filter=delivering&title_filter=all&title_filter=packaging&title_filter=conformance&title_filter=packaging&title_filter=delivering&title_filter=packaging&title_filter=ordered";

largeString.split('&').forEach(function(keyValue){
    var kvp = p.split('=');
    query[kvp[0]]= kvp[1];
}); 
```

如果您需要支持数组：

```
largeString.split('&').forEach(function(keyValue){
    var kvp = keyValue.split('=');

    if(kvp[0] in query){
        if(typeof(query[kvp[0]] === 'string')){
            query[kvp[0]] = [query[kvp[0]]];
        }
        query[kvp[0]].push(kvp[1]);
    }else{
        query[kvp[0]] = kvp[1];
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:20:54.640

我修改了查询字符串以删除重复项，然后我做了：

```
var active_tab = window.location.search.split('active_tab=')[1].split('&')[0]
var title_filter = window.location.search.split('title_filter=')[1].split('&')[0] 
```

# sql - SQL 使用 CASE 语句更新列中的行

> ID：14388064
> 
> 赞同：6
> 
> 时间：2013-01-17T21:03:12.383
> 
> 标签：sql, sql-server, case

我有两个表，Users 和 #TempTable（它是 Users 的子集）。我想更新用户表中的一列 IsActive。如果 #TempTable 中的用户也在 Users 表中，我想设置 IsActive = 1，否则设置 IsActive = 0。

从不在 #TempTable 中的用户获取用户（这些用户的 IsActive 应设置为 0）：

```
-- (Users \ #TempTable) U (#TempTable \ Users)
SELECT  u.UserName
FROM    Users u 
WHERE   (u.UserName) NOT IN 
    (SELECT t.[User Name] FROM #TempTable t) 
UNION ALL 
SELECT  t.[User Name] 
FROM    #TempTable t
WHERE   (t.[User Name]) NOT IN 
    (SELECT u.UserName FROM Users u) 
```

我们称它为 ResultSet。对于我的 UPDATE 语句，我将不胜感激。我想做的是：

```
UPDATE Users
SET IsActive = (CASE WHEN User.UserName IN ResultSet THEN 0 ELSE 1 END) 
```

无需为每个 User.UserName 写出 CASE WHEN。提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T21:08:03.847

您可以在 UPDATE 语句中使用连接。

```
UPDATE Users
SET Users.Active = CASE WHEN T.UserName is null THEN 0 ELSE 1 END 
FROM Users AS U
LEFT JOIN #TempTable AS T ON U.UserName = T.UserName 
```

备注：

*   您也可以使用子查询，但这会慢得多（n 平方的顺序而不是 n 的顺序）。对于少数用户来说，这无关紧要。

*   我没有~~测试~~，~~所以我可能在上面的代码中有错字/错误~~。

* * *

基于关于这行不通的疯狂评论，我实现了一个小提琴。

享受它的工作：

[http://sqlfiddle.com/#!6/25235/3](http://sqlfiddle.com/#!6/25235/3)

# gcc - 将参数或变量指定为 __attribute__ ((unused)) 是否允许编译器执行任何其他优化？

> ID：14388067
> 
> 赞同：4
> 
> 时间：2013-01-17T21:03:30.123
> 
> 标签：gcc, llvm, llvm-gcc, llvm-clang

我对 LLVM 4.1 特别好奇，但也会对其他编译器的行为感兴趣。

根据[GCC 文档](http://gcc.gnu.org/onlinedocs/gcc-3.1/gcc/Variable-Attributes.html)（LLVM 至少部分支持），该`unused`属性具有以下行为：

```
This attribute, attached to a variable, means that the variable is meant to be possibly unused. GCC will not produce a warning for this variable. 
```

但是，如果编译器能够警告您未使用的参数和变量，那么它可能已经知道哪些参数和变量是未使用的，而无需您告诉它（特别是因为该`unused`属性仅指示该变量*可能*未使用）。因此，该`unused`属性是否允许编译器执行任何额外的优化，或者它的目的只是为了允许更多可读的代码？此外，如果该`unused`属性确实允许编译器执行其他优化，那么如果您最终使用指定为的参数或变量会发生什么情况`unused`？LLVM（在 XCode 中）似乎没有抱怨这种情况，尽管我可能没有在正确的优化级别进行编译或启用了正确的警告。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T21:08:08.140

`__attribute__((unused))`无助于优化，并不意味着该值*一定*是未使用的。它抑制警告（如果有这个警告的原因，也就是说，*如果*该值确实未被使用），仅此而已。

# .net - 制作进程内存转储并稍后在 .NET 中恢复

> ID：14388070
> 
> 赞同：2
> 
> 时间：2013-01-17T21:03:43.770
> 
> 标签：.net, performance, memory-management, clr, unsafe

我正在寻找一种增加.NET 应用程序启动时间的方法。

想法是在启动初始化后立即进行进程内存转储并将其存储在磁盘上。在第二次运行时，用该转储和加速应用程序启动替换进程内存会很好。

所以，我的问题：

1.  有没有办法转储.NET 进程内存？
2.  有没有办法从该转储中恢复进程内存状态？
3.  解决方案（如果存在）是否适用于 IIS 托管的 ASP.NET 应用程序？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:08:04.083

原始内存转储并不是这样工作的。很多事情都将处理该单个进程*之外*的事情，如果您尝试重播它，将会*非常*糟糕地爆炸。您需要做的是查看*导致启动缓慢*的原因。例如，如果问题是加载配置和设置数据（例如，从数据库），那么可能有一些方法可以序列化该信息，以便可以从本地简单存储重新加载它，而不会产生太多开销。您可能会查看诸如“ilmerge”和“ngen”之类的工具（它们分别减少了“融合”和“jit”时间）——但坦率地说，这些东西对于几乎所有场景来说都有些矫枉过正。

对于 IIS：考虑一个服务器集群。如果服务器当时不在集群中，则启动服务器需要多长时间并不重要。

但是：首先衡量，*然后*采取行动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:26:48.350

（可能在查看最后作者对上一篇关于开发机器的帖子的评论时超出了主题......）

为了使 ASP.Net 启动更快，在深入研究内存管理的噩梦之前，您是否已经考虑过以下解决方案：

*   [IIS：Web 应用程序预热](https://stackoverflow.com/questions/2063461/iis-web-applications-warmup)

*   [如何在 IIS 7.5 上预热 ASP.NET MVC 应用程序？](https://stackoverflow.com/questions/7387123/how-to-warm-up-an-asp-net-mvc-application-on-iis-7-5)

*   [如何：避免 IIS 托管的 WCF 应用程序出现冷启动问题？](https://stackoverflow.com/questions/2290290/how-to-avoiding-cold-start-issues-with-iis-hosted-wcf-applications)

看看 .Net 内存转储是什么样子，您可以在这里找到答案：[.NET 内存分析工具](https://stackoverflow.com/questions/399847/net-memory-profiling-tools) （您会发现它非常庞大！）

# web-applications - 是否可以使用 HTTP GET 方法修改数据库以进行通讯确认/取消订阅邮件？

> ID：14388079
> 
> 赞同：2
> 
> 时间：2013-01-17T21:04:19.657
> 
> 标签：web-applications, web, newsletter

我正在实现一个网络应用程序，使用户能够订阅“时事通讯”。用户只需要提供他们的电子邮件地址，没有注册页面。为了确认电子邮件地址，系统会向给定地址发送电子邮件，并要求用户通过单击链接来验证电子邮件地址。该链接向服务器发出 GET 请求，并将模型中表示用户时事通讯的标志从已确认 => false 修改为已确认 => true。问题是我正在使用修改内部服务器状态的 GET 请求，这很糟糕。问题是所有需要电子邮件确认的系统都遵循这种模式。

有一个更好的方法吗？当用户在浏览器中输入确认页面时，我应该使用 Javascript 来触发 Ajax POST 请求吗？

同样适用于取消订阅。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:05:37.343

你不应该对任何非幂等的东西使用 GET 请求。使用 POST 首次订阅并更改现有订阅记录。从技术上讲，您可以使用 PUT 来更改现有记录，但您需要知道该记录已经存在，因此始终使用 POST 会更容易。

严格来说，您可以使用 GET 链接预填充一个表单，您可以使用 JS 或用户可以在页面上按下的确认提交按钮来触发对您的服务的 POST 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:16:19.167

StackOverflow（好吧，StackExchange）在他们的订阅确认电子邮件中使用 HTTP GET。这不是一件坏事。事实上，我在收件箱/存档中找不到任何相反的网站实例。

[https://stackexchange.com/filters/email-confirm/999999](https://stackexchange.com/filters/email-confirm/999999)

别担心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-25T19:57:32.423

我发现了一篇关于这个问题的[有趣文章。](https://www.artima.com/weblogs/viewpost.jsp?thread=152805)

它说的基本上是：

*   如果一个链接的请求改变了一些东西，“网络加速器”（我不确定它是否仍然是一个东西）可能会预先获取页面并在**你甚至不触摸链接**的情况下进行更改。
*   为了防止这种情况，只需使用 GET 请求实现一个页面，然后使用 Javascript 请求 POST/PUT 进行更改。这样，网络加速器不会触发任何内容，您实际上必须通过单击链接自行访问该页面。
*   如果禁用了 Javascript，请在​​执行 POST/PUT 的页面中放置一个表单。

这听起来有点粗略，因为 POST/PUT 请求并非来自用户的直接操作。但实际上我们是在请求 Javascript 中的所有东西，而且它们中的大多数无论如何都是间接的用户行为。

# asp.net-mvc - 在这种情况下如何验证表单

> ID：14388082
> 
> 赞同：0
> 
> 时间：2013-01-17T21:04:30.000
> 
> 标签：asp.net-mvc, jquery, asp.net-ajax

```
@model Contoso.MvcApplication.ViewModels.QuizCompletedViewModel

<h2>Quiz 1</h2>

<form method="post">
@for (int i = 0; i < Model.Questions.Count; i++) {
    @Html.EditorFor(model => model.Questions[i], "Questions/_MultipleChoiceAnswerView")
}

<div>
    <p style="float: left;">Question @ViewData["CurrentNumber"] of @ViewData["TotalQuestions"]</p>
    <input type="submit" value="Continue" style="float: right;" />
</div>
</form> 
```

如您所见，我通过循环显示所有问题。但我真的想在页面中逐个问题地显示问题。这是实现它的相关帖子。

[隐藏当前元素并显示下一个](https://stackoverflow.com/questions/14386395/hide-current-element-and-show-the-next-one/14386431#14386431)

如果我不包含该 JQuery 功能，它看起来像这样

![在此处输入图像描述](../Images/dbd003a6edd4508c85be3cb57c101f4d.png)

问题是，对于最后一个 JQUERY 功能，我一次只显示一个问题，所以我只需要验证那个问题，而这是我真的不知道的部分。

我的意思是，假设我已经有了那个 JQUERY 函数，所以当用户按下 CONTINUE 时，它必须验证当前问题是否有效，但只有这个，而不是全部。

我能做些什么？

更新：我创建单选按钮的代码：

```
@using Contoso.MvcApplication.Extensions
@model Contoso.MvcApplication.ViewModels.MultipleChoiceQuestionViewModel

<div class="question-container">
    <h5>@Model.Question.QuestionText</h5>
</div>

<div class="answer-container">
@Html.RadioButtonForSelectList(m => Model.Question.SelectedAnswer, Model.AnswerRadioList)
@Html.ValidationMessageFor(m => m.Question.SelectedAnswer)
</div> 
```

我正在使用 HtmlExtensions：

```
public static class HtmlExtensions
{
    public static MvcHtmlString RadioButtonForSelectList<TModel, TProperty>(
        this HtmlHelper<TModel> htmlHelper,
        Expression<Func<TModel, TProperty>> expression,
        IEnumerable<SelectListItem> listOfValues,
        IDictionary<string, object> htmlAttributes)
    {
        var metaData = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
        var sb = new StringBuilder();

        if (htmlAttributes == null)
        {
            htmlAttributes = new RouteValueDictionary();
        }
        if (!htmlAttributes.ContainsKey("id"))
        {
            htmlAttributes["id"] = null;
        }
        foreach (SelectListItem item in listOfValues)
        {
            var id = string.Format(
                "{0}_{1}",
                htmlHelper.ClientIdFor(expression),
                item.Value
            );
            htmlAttributes["id"] = id;
            var radio = htmlHelper.RadioButtonFor(expression, item.Value, htmlAttributes).ToHtmlString();
            var labelId = htmlHelper.ClientIdFor(expression);
            sb.AppendFormat(
                "<div class='rad'>{0}<label for=\"{1}\">{2}</label></div>",
                radio,
                id,
                HttpUtility.HtmlEncode(item.Text)
            );
        }

        return MvcHtmlString.Create(sb.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:59:09.817

看看使用类似下面的东西。它使用可见 div 作为当前步骤并查找其中包含的无效元素。

这是一组粗略的代码，尚未经过**测试**，但希望它可以让您了解如何处理

```
// attach continue button handler       
        $("#continue).click(function ()
        {

            var $step = $(":visible"); // get current step

            var validator = $("form").validate(); // obtain validator
            var anyError = false;

            //find any elements within the current step that are invalid.
            $step.find("input").each(function ()
            {
                if (!validator.element(this)) { // validate every input element inside this step
                    anyError = true;
                }

            });

            if (anyError)
                return false; // exit if any error found

                //in this case use class confirm (or use hidden field value for step number)
            if ($step.next().hasClass("confirm")) { // is it confirmation?
                // show confirmation asynchronously
                $.post("/wizard/confirm", $("form").serialize(), function (r)
                {
                    // inject response in confirmation step
                    $(".confirm").html(r);
                });
            }
               //workout if this is the last step.
               //if not go to next question
               // if it is submit the form
            if ($step.next().hasClass("complete")) { // is there any next step?
                $step.hide().next().show();  // show it and hide current step
                $("#back-step").show();   // recall to show backStep button
            }

            else { // this is last step, submit form
                $("form").submit();
            }

        }); 
```

# websocket - 尝试在 tomcat 7（最新版本 7.0.34）上实现非常基本的聊天

> ID：14388089
> 
> 赞同：2
> 
> 时间：2013-01-17T21:04:47.920
> 
> 标签：websocket, tomcat7

我不禁认为有一个非常简单的解决方案，但到目前为止还没有运气。我想我已经走到了互联网的边缘并回头看，阅读了整个 RFC6455 以了解幕后发生的事情等。我使用 eclipse 进行开发，并在开发机器上运行了最新的 tomcat。

这是我的测试类，eclipse 甚至不会编译，因为它表明我需要删除受保护的 StreamInbound 方法上的 @Override。实际写法：

wsListenerTest 类型的方法 createWebSocketInbound(String) 必须覆盖或实现超类型方法；

它建议删除@Override。

我正在尝试在没有任何其他服务器或插件的情况下完成 Tomcat 本地的所有操作。

提前致谢

```
package com.blah.blah;

import java.io.IOException;
import java.nio.ByteBuffer;
import java.nio.CharBuffer;
import java.util.Set;
import java.util.concurrent.CopyOnWriteArraySet;
import java.util.concurrent.atomic.AtomicInteger;

import org.apache.catalina.websocket.MessageInbound;
import org.apache.catalina.websocket.StreamInbound;
import org.apache.catalina.websocket.WebSocketServlet;
import org.apache.catalina.websocket.WsOutbound;

public class wsListenerTest extends WebSocketServlet {

private static final long serialVersionUID = 1L;
static int numConnections = 0;

    private static final String GUEST_PREFIX = "Guest";

    private final AtomicInteger connectionIds = new AtomicInteger(0);
    private final Set<ChatMessageInbound> connections = new CopyOnWriteArraySet<ChatMessageInbound>();

    @Override
    protected StreamInbound createWebSocketInbound(String subProtocol) {
        return new ChatMessageInbound(connectionIds.incrementAndGet());
    }

    private final class ChatMessageInbound extends MessageInbound {

        private final String nickname;

        private ChatMessageInbound(int id) {
            this.nickname = GUEST_PREFIX + id;
        }

        @Override
        protected void onOpen(WsOutbound outbound) {
            connections.add(this);
            String message = String.format("* %s %s",
                    nickname, "has joined.");
            broadcast(message);
        }

        @Override
        protected void onClose(int status) {
            connections.remove(this);
            String message = String.format("* %s %s",
                    nickname, "has disconnected.");
            broadcast(message);
        }

        @Override
        protected void onBinaryMessage(ByteBuffer message) throws IOException {
            throw new UnsupportedOperationException(
                    "Binary message not supported.");
        }

        @Override
        protected void onTextMessage(CharBuffer message) throws IOException {
            // Never trust the client
//                String filteredMessage = String.format("%s: %s",nickname, HTMLFilter.filter(message.toString()));
            broadcast(message.toString());
        }

        private void broadcast(String message) {
            for (ChatMessageInbound connection : connections) {
                try {
                    CharBuffer buffer = CharBuffer.wrap(message);
                    connection.getWsOutbound().writeTextMessage(buffer);
                } catch (IOException ignore) {
                    // Ignore
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:02:42.720

我认为编译器抱怨这个 @Override 因为 WebSocketServlet 的[createWebSocketInbound()](http://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/catalina/websocket/WebSocketServlet.html#createWebSocketInbound%28java.lang.String,%20javax.servlet.http.HttpServletRequest%29)方法具有以下内容

```
protected abstract StreamInbound createWebSocketInbound(String subProtocol,
                                                        HttpServletRequest request); 
```

尝试将 HttpServletRequest 参数添加到您的方法中，这应该有助于您克服这个障碍。

# javascript - 动态/连续改变宽度的 div 或 span

> ID：14388090
> 
> 赞同：1
> 
> 时间：2013-01-17T21:04:50.320
> 
> 标签：javascript, jquery

我有来自[jQuery animate](http://api.jquery.com/animate/)的示例代码 ，我想让 div 基于计数器自动扩展，基于时间，随着计数器或时间的变化，div 变得更宽。我不知道如何使用变量来替换宽度：“70%”

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta name="generator" content="HTML Tidy for Windows (vers 14 February 2006), see www.w3.org">
<style type="text/css">
div {
background-color:#bca;width:100px;border:1px solid green;
}
</style>
<script src="http://code.jquery.com/jquery-latest.js" type="text/javascript">
</script>
    <title></title>
  </head>
  <body>
    <button id="go">» Run</button>
    <div id="block">
      Hello!
    </div>
<script type="text/javascript">
/* Using multiple unit types within one animation. */
 $("#go").click(function(){  $("#block").animate({    width: "70%",    opacity: 0.4,    marginLeft: "0.6in",    fontSize: "3em",    borderWidth: "10px"  }, 1500 );});
</script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:08:51.970

请示例代码以使用宽度变量：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta name="generator" content="HTML Tidy for Windows (vers 14 February 2006), see www.w3.org">
<style type="text/css">
div {
background-color:#bca;width:100px;border:1px solid green;
}
</style>
<script src="http://code.jquery.com/jquery-latest.js" type="text/javascript">
</script>
    <title></title>
  </head>
  <body>
    <button id="go">» Run</button>
    <div id="block">
      Hello!
    </div>
<script type="text/javascript">
  var someWidth = "70%";
/* Using multiple unit types within one animation. */
 $("#go").click(function(){  $("#block").animate({    width: someWidth,    opacity: 0.4,    marginLeft: "0.6in",    fontSize: "3em",    borderWidth: "10px"  }, 1500 );});
</script>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:18:26.067

`+=`您可以通过如下指定来使用相对动画

```
$("#go").click(function(){  
         $("#block").animate({   
                             width: "+=5%",   
                             opacity: 0.4,
                             marginLeft: "0.6in",  
                             fontSize: "3em",   
                             borderWidth: "10px"  
                            }, 1500 );
         }); 
```

`5%`这将在每次调用函数时扩展 div。调整它以满足您的需要。相反，如果您想`animate`在间隔基础上调用此函数。`setInterval`这将`animate`每 2000 毫秒调用一次。

```
setInterval( function(){

        $("#block").animate({   
                             width: "+=5%",   
                             opacity: 0.4,
                             marginLeft: "0.6in",  
                             fontSize: "3em",   
                             borderWidth: "10px"  

                    }, 1500 );               

             },2000); 
```

# axapta - AOT 反射没有按预期工作？

> ID：14388096
> 
> 赞同：0
> 
> 时间：2013-01-17T21:05:01.417
> 
> 标签：axapta, dynamics-ax-2009, x++

我正在编写一些代码来在 AOT 中搜索某些对象，而只是进行扩展数据类型搜索并没有按预期工作。我在 USR 层中创建了一个名为“Alex”的 EDT，其 EnumType 为“SysDimension”。它在 AOT 中找不到它，但它可以找到其他的。

```
static void Job6(Args _args)
{
    #AOT
    TreeNodeIterator    treeNodeIterator;
    TreeNode            treeNode;
    SysDictEnum         sysDictEnum;
    ;

    treeNodeIterator    = TreeNode::findNode(#ExtendedDataTypesPath).AOTiterator();
    treeNode            = treeNodeIterator.next();
    while (treeNode)
    {
        sysDictEnum         = new SysDictEnum(treeNode.applObjectId());

        if (sysDictEnum)
        {
            if (sysDictEnum.name() == "Alex")
                info("Found Alex"); // WHY ISN'T THIS FOUND?

            if (sysDictEnum.name() == "ABCModel")
                info("Found ABCModel"); // THIS IS OUTPUT
        }

        treeNode = treeNodeIterator.next();
    }

    info("Done");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:13:09.267

啊，我觉得很愚蠢。我正在迭代扩展数据类型，但使用 sysDictEnum 而不是用于 EDT 的 sysDictType。解释了我令人困惑的结果。

# .net - WPF 面板允许行，顶部可折叠

> ID：14388098
> 
> 赞同：0
> 
> 时间：2013-01-17T21:05:06.533
> 
> 标签：.net, wpf, xaml

我正在尝试创建一个显示两个 RichTextBox 的 WPF 控件。一个在另一个之上，每个占据相等的空间。

但是当顶部的没有任何东西时，我需要底部的来填充那个空间。

我尝试使用网格，但无法正常工作。

这些是我尝试过的行定义：

```
<Grid>  
  <Grid.RowDefinitions>
    <RowDefinition Height="Auto"/>
     <RowDefinition Height="*"/>
  </Grid.RowDefinitions>

  <RichTextBox Grid.Row="0" />
  <RichTextBox Grid.Row="1" />     
</Grid> 
```

当两行都显示顶部时，其中的高度（不是 50/50 分割）。

```
<Grid>  
  <Grid.RowDefinitions>
     <RowDefinition Height="*"/>
     <RowDefinition Height="*"/>
  </Grid.RowDefinitions>

  <RichTextBox Grid.Row="0" Visibility="Collapsed"/>
  <RichTextBox Grid.Row="1" />     
</Grid> 
```

当顶行折叠时，底行不会展开以填充其空间。

```
<Grid.RowDefinitions>
     <RowDefinition Height="*"/>
     <RowDefinition Height="Auto"/>
</Grid.RowDefinitions> 
```

使用它或将 MinHeight 添加到底行会导致容器无界。这样我的底部 RichTextBox 就没有滚动条了。

**有没有办法让两个控件堆叠在一起，并*平均*填充可用空间？** （虽然允许一个人崩溃）

注意：我没有绑定到网格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:23:24.967

我找到了一种方法：

```
<UniformGrid Columns="1">  
  <RichTextBox />
  <RichTextBox />     
</UniformGrid> 
```

而对于崩溃：

```
<UniformGrid Columns="1">  
  <RichTextBox Visibility="Collapsed" />
  <RichTextBox />     
</UniformGrid> 
```

就像我一直在寻找的那样工作。

# html - 为什么更改 line-height 只会影响字体的顶部？

> ID：14388101
> 
> 赞同：1
> 
> 时间：2013-01-17T21:05:09.580
> 
> 标签：html, css, vertical-alignment, typography

我正在使用点 HTML 字符来制作不同颜色的图标。我遇到的问题是 line-height 属性似乎只影响字符顶部的放置位置。我无法让点图标与常规文本正确对齐，即使设置的行高与文本的标准字体大小相匹配。

```
HTML
<div>
  <b>Legend:</b>
  <span class="dotib">&#8226;</span>
</div>

CSS
.dotib{font-size: 36pt; line-height: 12pt;} 
```

有没有更好的方法让这个点表现得像我期望的那样？

这是一个带有此代码的 jsFiddle：http: [//jsfiddle.net/TzFff/](http://jsfiddle.net/TzFff/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:08:59.647

改成这样：

```
.dotib {
    font-size: 36pt; 
    line-height: 12pt;
    vertical-align:middle;
    padding-bottom:5px;
} 
```

[http://jsfiddle.net/TzFff/1/](http://jsfiddle.net/TzFff/1/)

# html - iframe 分解静态网站中的代码？

> ID：14388103
> 
> 赞同：0
> 
> 时间：2013-01-17T21:05:26.663
> 
> 标签：html, iframe, methodology

我正在制作一个网站，由于官僚主义的限制，我只能使用静态网页。

我想在所有这些中包含一个页眉和一个页脚。

在这种情况下使用 iframe 是否可以接受，或者我应该在所有这些中重复该代码？还有其他可能吗？

这没什么大不了的，我根本不知道在这种情况下最佳做法是什么。

非常感谢。

PS：我也不确定我是否应该在programmers.stackexchange.com 上问这个问题，我很难区分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:07:57.140

您要查找的内容通常称为“包含”。服务器端编程语言（如 PHP 和其他语言）提供此功能。您所要做的就是创建一个带有通用代码的页眉或页脚文件，然后将其“包含”到您要使用的每个页面中。

# java - 无法在 Asynctask Android、java 中调用 View

> ID：14388104
> 
> 赞同：0
> 
> 时间：2013-01-17T21:05:31.783
> 
> 标签：java, android, view, android-asynctask

我试图从我的 Asynctask 类中的另一个类调用视图，但它似乎不起作用。

这是我的 AsyncTack

```
private class parseSite extends AsyncTask<String, Void, List<Integer>> {

    protected List<Integer> doInBackground(String... arg) {
     List<Integer> output = new ArrayList<Integer>();
        try {
            htmlHelper hh = new htmlHelper(new URL(arg[0]));
            output = hh.htmlHelper(arg[0]);
        } catch (Exception e) {
            System.out.println("Error");
        }
        return output;
    }

    protected void onPostExecute(List<Integer> exe) {

        graph salesView = new graph();
        View chartView = salesView.getView(this);
        chartView.setLayoutParams(new LinearLayout.LayoutParams(
                LinearLayout.LayoutParams.FILL_PARENT,
                LinearLayout.LayoutParams.FILL_PARENT, 1f));
        LinearLayout layout = (LinearLayout) findViewById(R.id.linearview);

        layout.addView(chartView, 0);

    }
} 
```

这是活动“图表”的样子

```
public class graph {

public View getView(Context context) (...etc.) 
```

我不明白为什么它不能调用视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:21:32.040

我认为问题在于您尝试从创建它的其他线程访问视图。通常的方法是使用`runOnUiThread()`：

```
(activity).runOnUiThread(new Runnable() {
     public void run() {

 //call anything to your View objects

    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:09:47.717

假设您打算`graph`以`Context`某种方式扩展，例如通过扩展`Activity`，并且`parseSite`在内部定义`graph`，请进行以下更改：

```
View chartView = salesView.getView(graph.this); 
```

在原始代码中，`this`指的`parseSite`是未扩展的`Context`（并且不是`graph`您可能想要的）。

附带说明一下，在典型的 Java 风格中，类应该用大写字母命名，即`Graph`not `graph`。

# grep - grep 模式，匹配多个文件

> ID：14388105
> 
> 赞同：1
> 
> 时间：2013-01-17T21:05:32.563
> 
> 标签：grep, access-log

我正在使用 grep 在攻击后分析我的日志文件。通常是这样

```
grep -F "POST /xxxxx.php" ./access-log 
```

现在有人攻击了我的一些网站，但我不知道漏洞在哪里，也不知道攻击者的 IP 地址是什么。现在我想找到一个向我的多个网站发送请求的 IP 地址，如下所示：

```
abcde.com-log:123.123.123.123 - - [12/Jan/2013:08:41:08 +0100] "POST /xxxxx.php HTTP/1.1" 200 1234 "-" "-"

wxyz.com-log:123.123.123.123 - - [12/Jan/2013:08:41:08 +0100] "POST /xxxxx.php HTTP/1.1" 200 1234 "-" "-" 
```

但我不知道如何让 grep 或其他 unix 工具只给我那个匹配项，匹配的对象不止一个日志文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:30:50.657

假设您想要的 IP 地址是每个日志文件中的第一个字段，请尝试以下操作：

```
awk '
   /POST \/xxxxx\.php/ {
      ip=$1
      if ( !(ipFilePairs[ip,FILENAME]++) ) {
         ipFileCnt[ip]++
         ipFileList[ip] = ipFileList[ip] " " FILENAME
      }
   }
   END {
      for (ip in ipFileCnt)
         if (ipFileCnt[ip] > 1)
            print ip ":" ipFileList[ip]
   }
' *.log 
```

# c# - MVC4 C# Web 项目的 HTML 电子邮件转换

> ID：14388108
> 
> 赞同：0
> 
> 时间：2013-01-17T21:05:45.530
> 
> 标签：c#, html, asp.net-mvc-4, html-email

我目前正在 Visual Studio 2012 中开发一个 MVC4 C# 项目。我们最近添加了一个向我们的用户发送电子邮件的系统。系统使用 MailMessage 类来格式化通过 SmtpClient 类发送的消息。此消息具有 html 属性，以启用正文文本的某些可视化格式。

问题是属性 message.Body 当前被写入单个字符串，这使得代码看起来非常难看并且很难实际格式化。我做了一些研究并注意到一些解决方案将电子邮件作为单独的 HTML 文件链接到系统中。这允许更简单的消息格式。唯一的问题是我发现的示例缺少有关如何正确实施此类解决方案的文档，因此我想知道是否有人可以向我指出一些信息或可能提供示例。

这就是我所说的丑陋的 MailMessage 代码的意思。

```
 var message = new MailMessage(fromAddress, toAddress);
        message.Subject = "Password Recovery Email";
        message.IsBodyHtml = true;
        message.Body =
        "Hello " + UserName +
        "<br />" +
        "Greetings from website," +
        "<br />" +
        "You have requested a Password reset. To continue click the following:" +
        "<br />" +
        "http://www.website.com/PasswordRecover?passwordToken=" + passwordToken +
        "<br />" +
        "This link will expire in 5 hours." +
        "<br />" +
        "If you did not intend to request a password reset, you can ignore this email. Someone may have entered your information by mistake. Contact us at support@website.com for more assistance." + 
        "<br />" +
        "Cheers"; 
```

概括：

*   message.Body 代码丑陋，难以格式化
*   对更好的解决方案感兴趣
*   请指导我看一篇文章或一个例子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:10:39.410

看看[邮政](http://aboutcode.net/postal/)。它对我来说就像一个魅力。

# regex - 使用正则表达式提取器从 jmeter 响应中提取字符串

> ID：14388116
> 
> 赞同：1
> 
> 时间：2013-01-17T21:06:09.013
> 
> 标签：regex, jmeter

我正在尝试从下面的 html 响应代码中提取字符串 ( `201`& )。`202`到目前为止，我已经尝试了以下正则表达式

```
punumber=(.+) 
```

但问题是页面上有很多实例，`punumber`让我得到了我不需要的东西。
我需要的字符串在`<h3 class="content-title">`.

那么有人可以帮我写一个正则表达式来提取 h3 类中的 punumber 吗？

```
<h3 class="content-title">
<!--  change when this is completed -->
    <a href="/container/recentIssue.jsp?punumber=201">
    Title 1
    </a>
</h3>

<h3 class="content-title">
<!--  change when this is completed -->
    <a href="/container/mostRecentIssue.jsp?punumber=202">
    Title 1
    </a>                                    
</h3> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:30:39.323

这对我有用：

```
Reference Name : test
Regexp : punumber=([^"]+?)"

Template : $1$

Match No : -1 
```

（这将获得所有值） NV_punumber

使用 -1，JMeter 将创建：

*   ${test_1} => 201

*   ${test_2} => 202

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:32:54.653

这是对我有用的正则表达式：

```
punumber=(\d+) 
```

如果您正在解析 html，您应该考虑使用除正则表达式之外的其他东西来提取 jsoup 之类的信息。

无论如何，这里是带有虚拟采样器（带有正则表达式后处理器）的 jmeter 测试文件，用于模拟您的案例和调试采样器，以获得您想要的结果。

[http://pastebin.com/Uti8Pv9E](http://pastebin.com/Uti8Pv9E)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T16:40:54.800

在这种情况下，您可以将[XPath Extractor](http://jmeter.apache.org/usermanual/component_reference.html#XPath_Extractor)与结构化查询（仅从标签内的实例中获取所有`href`值）结合起来，然后从[ForEach 控制器](http://jmeter.apache.org/usermanual/component_reference.html#ForEach_Controller)循环中提取值。`punumber``<h3>``punumber``href`

```
. . .
您的 HTTP 请求
    XPath 提取器
    使用整洁 = true
    参考名称 = punum
    XPath 查询 = //h3[@class="content-title"]/a[text()="Title 1"]/@href
    默认值 = NOT_FOUND
ForEach 控制器
输入变量前缀 = punum
输出变量名 = pnum
在 number = true 之前添加“_”
    用户参数
    cnt = ${__counter(FALSE,)}
    正则表达式提取器
    适用于 = Jmeter 变量 = pnum
    参考名称 = punumber_${cnt}
    正则表达式 = punumber=(\d+)
    模板 = $1$
    比赛编号 = 1
    默认值 = NOT_FOUND
    ...
. . .

```

1.  XPath Extractor 将为您提供标签下`hrefs`所有`<a>`项目的值，如, ,..., vars。`<h3>``punum_1``punum_2``punum_N`
2.  Foreach 控制器获取一个又一个`punum_X`var，将其引用为`pnum`，将其应用于 RegEx 提取器以获取`punumber`值并将提取的值存储为`punumber_1`, `punumber_2`,..., `punumber_N`（使用用户参数中定义的计数器并每步递增）。

注意：由于这里 XPath Extractor 用于解析 HTML（不是 XML）响应，请确保选中**Use Tidy（容错解析器）**选项（在[XPath Extractor 的控制面板](http://jmeter.apache.org/usermanual/component_reference.html#XPath_Extractor)中）。

此处提供相同的测试计划：http: [//db.tt/dnACZtGL](http://db.tt/dnACZtGL)（我使用了@ant 的答案，谢谢他）。

# xml - 同一个 xml 文件中的多个 xml 元素

> ID：14388122
> 
> 赞同：0
> 
> 时间：2013-01-17T21:06:37.993
> 
> 标签：xml

在 xml 文件中可以：

```
<target name="test">
    <exec executable="app">
        <arg value="run"/>
        <arg value="stop"/>
    </exec>     
</target> 
```

但是在 xml 文件中包含它不是（至少这是[验证](http://www.w3schools.com/dom/dom_validate.asp)所说的）：

```
<target name="test">
    <exec executable="app">
        <arg value="run"/>
        <arg value="stop"/>
    </exec>     
</target>
<target name="test">
    <exec executable="app">
        <arg value="run"/>
        <arg value="stop"/>
    </exec>     
</target> 
```

为什么在同一个xml文件中有多个目标元素是非法的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:35:05.577

“为什么”的问题很难回答。部分原因是在 XML 中是这样的，因为它在 SGML 中。强制执行单个文档容器元素确实有一些优势，尽管主要可能是优势；你知道什么时候到了结尾，有点被根元素结尾之后可能有注释和处理指令的事实所破坏。

如果您想在流式上下文中使用 XML 格式，例如在日志文件中您想继续在末尾添加元素，这会有些痛苦。

该问题的一个常见解决方案是观察具有多个顶级元素的文件不是格式良好的*文档*，而是格式良好的*外部解析实体*。因此，如果您生成一个`log.xml`包含数十个顶级元素的文件，那么您无法将其解析为*文档*，但您可以制作一个*引用*外部解析实体的静态小文档，`log.xml`然后您就回到了指定的领域。

`wrapper.xml`

```
<!DOCTYPE wrapper [
<!ENTITY thelog SYSTEM "log.xml">
]>
<wrapper>
&thelog;
</wrapper> 
```

然后，如果您解析`wrapper.xml`，解析器将构造一个包含根元素的文档，该根元素`wrapper`包含文件中的所有元素`log.xml`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:07:36.767

因为一个有效的 xml 文件应该有一个（并且只有一个）根元素。

请参阅维基百科的[根元素](http://en.wikipedia.org/wiki/Root_element)文章或我从中提取此引用的[W3C 推荐文件：](http://www.w3.org/TR/xml/#sec-well-formed)

> [定义：只有一个元素，称为根或文档元素，它的任何部分都不会出现在任何其他元素的内容中。]

# jquery - 带有 .on 委托事件的选择器上的 jQuery filter()

> ID：14388125
> 
> 赞同：0
> 
> 时间：2013-01-17T21:06:41.413
> 
> 标签：jquery, jquery-selectors

有没有办法在 .on() 的委托事件中使用 jQuery 选择器？您将如何在选择器中仅选择直接子级？下面是一个代码示例：我想只过滤元素的直接`<div>`子`<section>`元素，并要求它们的子元素中至少有一个`<p>`包含单词«hello»。在这个例子中，只有第二个`<div>`会被过滤。问题是`<div>`之后可以添加其他，因此必须委托事件。

.live() 方法的使用使它更简单恕我直言，因为我可以使用：

`$('section > div').filter(function(){return /hello/.test(p) }).live('mouseenter', function(){ ... })`

但由于它现在已被弃用，它的替代 .on() 只允许在委托事件中使用纯 CSS 类选择器。有没有人知道如何根据上述两个条件（直系子女和`<p>`包含你好）过滤这些元素？谢谢

```
<section>
    <div>
        <p>abc</p>
        <div>
            <p>def</p>
            <p>hello</p>
        </div>
    </div>
    <div>
        <p>hello world</p>
        <p>test</p>
    </div>
</section> 
```

**编辑：**我忘了添加我的 JS 示例，我正在稍微修改条件，以便 p:contains('hello') 不足以作为选择器。

```
$('section').on({
    mouseenter: function(){
        $(this).css('background-color','red');
    }
},
    $('div').filter(function(){
        var p = $(this).children('p').filter(function(){
            return /hello/.test($(this).text());
        });
        return p.length > 2;
    })
); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:10:36.043

```
$('section').on('mouseenter', '> div > p:contains("hello")', function(){ ... }) 
```

要将事件放在 div 上，您必须在函数内设置条件

```
 $('section').on('mouseenter', '> div', function(){ 
      if ($(this).find("> p:contains("hello")").get(0)) {

         // ...
        }
   }) 
```

我总是在我的代码中这样做是懒惰的：最好将事件附加到文档和委托；jquery以这种方式更快地工作+您可以动态添加元素而不必担心是否会触发事件（它会）

```
 $(document).on(... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:43:34.573

即使在`has`伪类中，您也可以使用裸组合器来定位上下文的子级：

```
$('section').on('mouseenter', '> div:has(> p:contains("hello"))', ... 
```

但是，建议避免使用它们（与 不兼容`querySelectorAll`）。考虑（只有一个裸组合器而不是两个）：

```
$(document).on('mouseenter', 'section > div:has( > p:contains("hello"))`, ... 
```

您的第二个过滤器（具有两个以上带有文本“hello”的子元素的 div）在 CSS 中有点狂野，但仍然可能：

```
$('section').on('mouseenter', 'div:has(>'+
  '  p:contains("hello") '+
  '~ p:contains("hello") '+
  '~ p:contains("hello") '+
')', ... 
```

如果一切都失败了，您可以通过选择器和处理程序内的主过滤器进行预过滤：

```
$(document).on('mouseenter', 'section > div', function(){
  if($(this).children('p:contains("hello")').length > 2){
    ...
  }
}) 
```

即使是`is`with 回调也可以：

```
function valid (){...}

$(document).on('mouseenter', 'section > div', function(){
  if($(this).is(valid)){
    ...
  }
}) 
```

# python - Django 强制 OneToOneField 的值属于 ForiegnKey 相关对象集

> ID：14388126
> 
> 赞同：0
> 
> 时间：2013-01-17T21:06:41.480
> 
> 标签：python, django

我有类似于下面的模型：

```
class Submission(models.Model):
    round = models.ForeignKey('Round',related_name='submissions')
    text = models.TextField()

class Round(models.Model):
    favorite = models.OneToOneField('Submission',related_name='round_favorite+',null=True) 
```

是否有任何内置方法可以强制 Round.favorite 在 Round.submissions 中？IE：

```
assert(favorite in round.submissions.all()) 
```

如果不是，那么执行此断言的最佳方法是什么？pre_save 信号？覆盖 Model.save？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T08:05:22.717

您应该覆盖`Round`模型的保存以确保`favorite`提交存在，如果不保存则保存。

如果在ins 不存在时尝试保存`Round`模型，很可能会抛出异常。所以你可以使用异常保存并重试。`favorite``Submission``Submission.DoesNotExist`

# wcf - “未注册目标配置” - 使用 SAP nCo3 (SAP .NET Connectior 3.0) 的 WCF/SAP 集成

> ID：14388128
> 
> 赞同：4
> 
> 时间：2013-01-17T21:06:42.117
> 
> 标签：wcf, c#-4.0, exception, iis-express, sap-dotnet-connector

当我尝试调用我开发的 WCF 服务时，我收到此错误消息：“方法或操作未实现”。

让我解释一下我所面临的情况，我会给你更多的细节，代码等：

我正在 Windows 8/Visual Studio 2012 机器中的 .NET 框架 4.0 中开发 WCf 服务。WCF 服务将通过在 .NET compact framework 2.0 中开发的移动应用程序访问（开发环境：运行 Windows XP service pack 3、Visual Studio 2008、Windows Mobile 6.1 Professional Emulator 的虚拟机）。

WCF 服务使用 SAP .NET Conector (SAPnCO) 3.0 版。

当我使用 VS 集成的 IIS 或 IIS8 运行服务时，一切正常：我可以测试服务，从测试控制台应用程序访问它，还可以从 Windows Mobile Emulator 访问它。

然而，我们即将开始对最终用户进行一些初步测试，我们仍然没有合适的服务器来部署 WCF 应用程序，所以我不得不使用 Windows XP 和 IIS express 7.5 制作一个应急服务器（我无法使其在 IIS 5.1 上工作）。

我知道 IIS Express 仅用于本地访问，但我按照本教程将 ti 打开到 LAN：[TUTORIAL](http://blogs.iis.net/vaidyg/archive/2010/07/29/serving-external-traffic-with-webmatrix-beta.aspx)。

这样做我可以通过浏览器访问服务签名并查看 WSDL 文件。

每次我尝试访问该服务时，我都会收到错误消息“方法或操作未实现”。在过去的 4 个小时里，我一直在互联网上寻找一些类似的问题，但没有成功。

这是我到目前为止所做的事情：

*   在 IIS Express 7.5 上托管默认 WCF 示例服务并远程使用该服务：好的；
*   将原始服务的范围缩小到最小：仍然得到相同的错误；

所以，我仍然不知道是什么导致了这个或如何解决它。我恳请您的帮助，拜托！

这是我的代码：

**网页配置**

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <sectionGroup name="SAP.Middleware.Connector">
      <sectionGroup name="ClientSettings">
        <section name="DestinationConfiguration" type="SAP.Middleware.Connector.RfcDestinationConfiguration, sapnco"/>
      </sectionGroup>
    </sectionGroup>
  </configSections>
  <SAP.Middleware.Connector>
    <ClientSettings>
      <DestinationConfiguration>
        <destinations>
          <add NAME="QA" USER="XX" PASSWD="XX" CLIENT="XX" LANG="XX" ASHOST="XX" SYSNR="XX" MAX_POOL_SIZE="XX" IDLE_TIMEOUT="XX"/>
        </destinations>
      </DestinationConfiguration>
    </ClientSettings>
  </SAP.Middleware.Connector>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
  <appSettings/>
  <system.web>
    <compilation targetFramework="4.0" debug="true"/>
    <httpRuntime/>
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the values below to false before deployment -->
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <protocolMapping>
      <add binding="basicHttpsBinding" scheme="https"/>
    </protocolMapping>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true"/>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <!--
        To browse web app root directory during debugging, set the value below to true.
        Set to false before deployment to avoid disclosing web app folder information.
      -->
    <directoryBrowse enabled="true"/>
      </system.webServer>
    </configuration> 
```

**服务**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;

using SAP.Middleware.Connector;

namespace WCFCriarOT
{

    public class Service1 : IService1
    {

        public string CriarOT(int areaSelecionada, int nlenr, string codMaterial, int qtdMAterial)
        {
            try
            {

                string vltyp = "", vlpla = "";

                switch (areaSelecionada)
                {
                    case 1:
                        vltyp = "902";
                        vlpla = "GR-ZONE";
                        break;
                    case 3:
                        vltyp = "901";
                        vlpla = "GFI-ZONE";
                        break;
                    case 4:
                        vltyp = "904";
                        vlpla = "DEVOLUCAO";
                        break;
                    default:
                        break;
                }

                RfcDestination SapRfcDestination = RfcDestinationManager.GetDestination("QA");
                RfcRepository SapRfcRepository = SapRfcDestination.Repository;
                IRfcFunction FCriarOT = SapRfcRepository.CreateFunction("ZWM001");

                FCriarOT.SetValue("I_LGNUM", "WM1");
                FCriarOT.SetValue("I_BWLVS", "999");
                FCriarOT.SetValue("I_MATNR", codMaterial);
                FCriarOT.SetValue("I_WERKS", "120");
                FCriarOT.SetValue("I_LGORT", "0001");
                FCriarOT.SetValue("I_ANFME", qtdMAterial);
                FCriarOT.SetValue("I_SQUIT", "");
                FCriarOT.SetValue("I_VLTYP", vltyp);
                FCriarOT.SetValue("I_VLPLA", vlpla);
                FCriarOT.SetValue("I_VLENR", "");
                FCriarOT.SetValue("I_NLTYP", "");
                FCriarOT.SetValue("I_NLPLA", "");
                FCriarOT.SetValue("I_NLENR", nlenr.ToString().PadLeft(20, '0'));
                FCriarOT.SetValue("I_BNAME", "PAGOTR"); // receber os dados do login posteriormente

                FCriarOT.Invoke(SapRfcDestination);

                if (Convert.ToInt32(FCriarOT.GetValue("E_RETURN")) == 1)
                {
                    IRfcTable RfcReturn = FCriarOT.GetTable("T_MSG");
                    RfcReturn.CurrentIndex = 0;

                    return "1";
                }
                else
                {

                    return "0";
                }
            }
            catch (Exception ex)
            {
                throw new NotImplementedException();

            }
        }
    } 
```

**服务签名**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;

namespace WCFCriarOT
{

    [ServiceContract]
    public interface IService1
    {
        // Contrato para a operação "Criar OT"
        [OperationContract]
        string CriarOT(int areaSelecionada, int nlenr, string codMaterial, int qtdMAterial);

        [OperationContract]
        string GetData(int value);

        [OperationContract]
        CompositeType GetDataUsingDataContract(CompositeType composite);

        // TODO: Add your service operations here
    }
    } 
```

**例外**

```
System.ServiceModel.FaultException`1 was unhandled
  HResult=-2146233087
  Message=O método ou a operação não está implementada.
  Source=mscorlib
  StackTrace:
    Server stack trace: 
       at System.ServiceModel.Channels.ServiceChannel.ThrowIfFaultUnderstood(Message reply, MessageFault fault, String action, MessageVersion version, FaultConverter faultConverter)
       at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime operation, ProxyRpc& rpc)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
       at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
    Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at testeDoTeste1.ServiceReference1.IService1.CriarOT(Int32 areaSelecionada, Int32 nlenr, String codMaterial, Int32 qtdMAterial)
       at testeDoTeste1.ServiceReference1.Service1Client.CriarOT(Int32 areaSelecionada, Int32 nlenr, String codMaterial, Int32 qtdMAterial) in c:\Users\Documents\Visual Studio 2012\Projects\testeDoTeste1\testeDoTeste1\Service References\ServiceReference1\Reference.cs:line 119
       at testeDoTeste1.Program.Main(String[] args) in c:\Users\Documents\Visual Studio 2012\Projects\testeDoTeste1\testeDoTeste1\Program.cs:line 16
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

如果我未能提供所有必要的信息，请告诉我：我会尽我所能提供。我真的需要并感谢您的所有帮助！非常感谢！

**--------------**

**更新 1**

由于 WEB.CONFIG 文件是为使 WCF 服务与 IIS Express 一起工作而编辑的唯一服务部分，我认为这可能（最终）成为麻烦的根源。我发布了原始的 WEB.CONFIG 文件，没有进行编辑，希望这可以帮助某人发现问题！

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <sectionGroup name="SAP.Middleware.Connector">
      <sectionGroup name="ClientSettings">
        <section name="DestinationConfiguration" type="SAP.Middleware.Connector.RfcDestinationConfiguration, sapnco"/>
      </sectionGroup>
    </sectionGroup>
  </configSections>
  <SAP.Middleware.Connector>
    <ClientSettings>
      <DestinationConfiguration>
        <destinations>
          <add NAME="QA" USER="XX" PASSWD="XX" CLIENT="XX" LANG="XX" ASHOST="XX" SYSNR="XX" MAX_POOL_SIZE="XX" IDLE_TIMEOUT="XX"/>
        </destinations>
      </DestinationConfiguration>
    </ClientSettings>
  </SAP.Middleware.Connector>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
  <appSettings/>
  <system.web>
    <compilation targetFramework="4.0" debug="true"/>
    <httpRuntime/>
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the values below to false before deployment -->
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <protocolMapping>
      <add binding="basicHttpsBinding" scheme="https"/>
    </protocolMapping>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true"/>
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <!--
        To browse web app root directory during debugging, set the value below to true.
        Set to false before deployment to avoid disclosing web app folder information.
      -->
    <directoryBrowse enabled="true"/>
  </system.webServer>
</configuration> 
```

**--------------**

**更新 2**

发现了一个新错误，但对我来说仍然很模糊：“{“无法获取目标 QA——没有注册目标配置”}”。这个目的地在开发中运行良好，那么为什么它不能在 IIS Express 上运行呢？

无论如何，这是完整的例外：

```
System.ServiceModel.FaultException`1 was unhandled
  HResult=-2146233087
  Message=Cannot get destination QA -- no destination configuration registered
  Source=mscorlib
  StackTrace:
    Server stack trace: 
       at System.ServiceModel.Channels.ServiceChannel.ThrowIfFaultUnderstood(Message reply, MessageFault fault, String action, MessageVersion version, FaultConverter faultConverter)
       at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime operation, ProxyRpc& rpc)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
       at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
       at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
    Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at testeDoTeste1.ServiceReference1.IService1.CriarOT(Int32 areaSelecionada, Int32 nlenr, String codMaterial, Int32 qtdMAterial)
       at testeDoTeste1.ServiceReference1.Service1Client.CriarOT(Int32 areaSelecionada, Int32 nlenr, String codMaterial, Int32 qtdMAterial) in c:\Users\Documents\Visual Studio 2012\Projects\testeDoTeste1\testeDoTeste1\Service References\ServiceReference1\Reference.cs:line 119
       at testeDoTeste1.Program.Main(String[] args) in c:\Users\Documents\Visual Studio 2012\Projects\testeDoTeste1\testeDoTeste1\Program.cs:line 16
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

**--------------**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-11T09:01:31.423

我发现，如果未加载 sapnco 程序集，则会发生此异常。尝试将引用的 SAP 程序集设置为 Copy local: True。

这不是理想的解决方案，但对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-04T12:35:33.740

我通过将 configSections 部分移动到 app.config 的顶部来解决它。也许“configSections”必须是配置的第一个子部分。

也见这里： [参数“sectionGroupName”无效](https://stackoverflow.com/questions/22450503/parameter-sectiongroupname-is-invalid)

# c# - Kendo Grid MVC - 如何在 EditorViewData 中引用网格视图模型

> ID：14388134
> 
> 赞同：0
> 
> 时间：2013-01-17T21:07:05.063
> 
> 标签：c#, asp.net-mvc, kendo-ui

在[另一个答案](https://stackoverflow.com/questions/12951110/what-editorviewdata-is-for-in-telerik-mvc-grid-column-definition)中，视图的模型被传递给 EditorViewData。在我的例子中，视图具有主数据，而网格表示详细数据，因此我的 DDL 选项填充在网格的视图模型中，而不是页面视图模型中。如何引用网格的视图模型？

我的页面级视图模型：

```
@model OTIS.AppServ.InventoryMgmt.ViewModels.POHeaderViewModel 
```

My Grid 的视图模型定义：

```
@(Html.Kendo().Grid<OTIS.AppServ.InventoryMgmt.ViewModels.PODetailViewModel>() 
```

如何将此网格的视图模型传递给EditorViewData，即

```
columns.Bound(l => l.CustomerId)
    .EditorViewData(new { Options = PODetailViewModel.CustomerOptions }); 
```

或者

```
columns.Bound(l => l.CustomerId)
     .EditorViewData(new { Options = "#= CustomerOptions #" }); 
```

当然，这些都不起作用......但希望你能看到我想要做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:19:53.320

经过考虑，这不是我要走的路线，因为您将在每个详细信息行中重复 DDLoptions。因此，最好让 ddl 源来自页面级视图模型或视图数据。

# centos - Apache Thrift 0.9.0 不会按照说明进行配置

> ID：14388135
> 
> 赞同：2
> 
> 时间：2013-01-17T21:07:12.253
> 
> 标签：centos, thrift

Apache Thrift 0.9.0 不会按照基本 CentOS 安装的说明进行配置。当您尝试执行 ./configure 时，它​​会给您一个“错误：需要 libcrypto”

文档说您需要：

```
sudo yum install automake libtool flex bison pkgconfig gcc-c++ boost-devel libevent-devel zlib-devel python-devel ruby-devel 
```

[http://thrift.apache.org/docs/install/centos/](http://thrift.apache.org/docs/install/centos/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:08:51.737

该文档缺少 openssl 依赖项，您还需要包括：

上面的软件包安装列表中的 openssl-devel.x86_64

你真正需要安装的是

```
sudo yum install automake libtool flex bison pkgconfig gcc-c++ boost-devel libevent-devel zlib-devel python-devel ruby-devel openssl-devel.x86_64 
```

或者，如果您已经按照原始说明安装了上述内容，则仅此而已。

```
sudo yum install openssl-devel.x86_64 
```

# c# - 如何使用 BeginInvoke C#

> ID：14388136
> 
> 赞同：59
> 
> 时间：2013-01-17T21:07:15.297
> 
> 标签：c#, begininvoke

你能帮我解释一下吗：

```
someformobj.BeginInvoke((Action)(() =>
{
    someformobj.listBox1.SelectedIndex = 0;
})); 
```

你能告诉我我该如何使用`begininvoke`吗？什么是`Action`类型？为什么有空括号`()`？这意味着`=>`什么？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-01-17T21:20:17.067

[`Action`](http://msdn.microsoft.com/en-us/library/system.action.aspx)是 .NET 框架提供的一种委托类型。`Action`指向一个没有参数且不返回值的方法。

`() =>`是[lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)语法。Lambda 表达式不是 Type `Delegate`。Invoke requires `Delegate`so`Action`可用于包装 lambda 表达式并提供预期`Type`的`Invoke()`

`Invoke`导致`Action`在创建控件窗口句柄的线程上执行。经常需要避免更改线程`Exceptions`。例如，如果在需要调用时尝试`Rtf`在 a 上设置属性`RichTextBox`，而无需先调用 Invoke，`Cross-thread operation not valid`则会引发异常。`Control.InvokeRequired`在调用 Invoke 之前检查。

`BeginInvoke`是 的异步版本`Invoke`。异步意味着线程不会阻塞调用者，而不是阻塞的同步调用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-17T21:15:13.810

我猜您的代码与 Windows 窗体有关。如果您需要在 UI 线程中异步执行某些内容，
您可以调用：在大多数情况下更改控件的属性。 粗略地说，这是通过将委托传递给某个定期执行的程序来完成的。（消息循环处理和类似的东西）`BeginInvoke`

如果`BeginInvoke`为`Delegate`类型调用，则委托只是异步调用。
（`Invoke`对于同步版本。）

如果您想要更多适用于 WPF 和 WinForms 的通用代码，您可以考虑任务并行库并使用`Task`相应的[上下文](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)运行。( `TaskScheduler.FromCurrentSynchronizationContext()`)

并且补充一点其他人已经说过的： Lambdas 可以被视为匿名方法或[表达式](http://msdn.microsoft.com/ru-ru/library/system.linq.expressions.expression.aspx)。
这就是为什么你不能只使用`var`lambdas：编译器需要一个提示。

**更新：**

这需要 .Net v4.0 及更高版本

```
// This line must be called in UI thread to get correct scheduler
var scheduler = System.Threading.Tasks.TaskScheduler.FromCurrentSynchronizationContext();

// this can be called anywhere
var task = new System.Threading.Tasks.Task( () => someformobj.listBox1.SelectedIndex = 0);

// also can be called anywhere. Task  will be scheduled for execution.
// And *IF I'm not mistaken* can be (or even will be executed synchronously)
// if this call is made from GUI thread. (to be checked) 
task.Start(scheduler); 
```

如果您从其他线程启动任务并且需要等待其完成`task.Wait()`将阻塞调用线程直到任务结束。

[在此处](http://www.albahari.com/threading/part5.aspx)阅读有关任务的更多信息。

# objective-c - 将图像、http 标头从 xcode 发送到 API '格式错误的身份验证标头'

> ID：14388139
> 
> 赞同：0
> 
> 时间：2013-01-17T21:07:21.223
> 
> 标签：objective-c, xcode, api

我正在构建一个使用 API 的应用程序，通过 PHP 它正在工作，但现在我必须在 xcode 中构建并返回错误“格式错误的身份验证标头”，不知道我在 ObjectC 代码中遗漏了什么或如何调试.

在我的 Query.m 中，这就是我构建标题的方式

```
- (NSData *)multipartFormDataWithBoundary:(NSString *)boundary
{
NSMutableData *body = [NSMutableData data];
// Image data part
[body appendData:[[NSString stringWithFormat:@"--%@\r\n",boundary] dataUsingEncoding:NSASCIIStringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"query[file]\"; filename=\"query.%@\"\r\n", imageType] dataUsingEncoding:NSASCIIStringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Type: image/%@\r\n", imageType] dataUsingEncoding:NSASCIIStringEncoding]];
[body appendData:[@"Content-Transfer-Encoding: binary\r\n" dataUsingEncoding:NSASCIIStringEncoding]];
[body appendData:[@"\r\n" dataUsingEncoding:NSASCIIStringEncoding]];
[body appendData:imageData];
[body appendData:[@"\r\n" dataUsingEncoding:NSASCIIStringEncoding]];
// Location parts
if (self.location) {
    [body appendData:[self textPart:[NSString stringWithFormat:@"%f", location.coordinate.latitude] forKey:@"query[latitude]" boundary:boundary]];
    [body appendData:[self textPart:[NSString stringWithFormat:@"%f", location.coordinate.longitude] forKey:@"query[longitude]" boundary:boundary]];
}
// End of boundary
[body appendData:[[NSString stringWithFormat:@"--%@--\r\n", boundary] dataUsingEncoding:NSASCIIStringEncoding]];

return body;
}

#pragma mark -
#pragma mark Instance methods

- (NSString *)create
{
NSURL *queriesURL = [NSURL URLWithString:@"https://url.com/v4/query"];
NSString *contentType = @"multipart/form-data";
NSString *httpMethod = @"POST";
NSString *boundary = [NSString stringWithFormat:@"%d", arc4random() % 999999];  

NSData *contentData = [self multipartFormDataWithBoundary:boundary];

NSString *dateValue = HttpDate();

// request header values
NSString *authorizationValue = [NSString stringWithFormat:@"Authorization: Token %@", accessKey];
NSString *contentTypeValue = [NSString stringWithFormat:@"%@; boundary=%@", contentType, boundary];

// create the request object
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:queriesURL];
[request setHTTPMethod:httpMethod];
[request addValue:contentTypeValue forHTTPHeaderField:@"Content-Type"];
[request addValue:authorizationValue forHTTPHeaderField:@"Authorization"];
[request addValue:dateValue forHTTPHeaderField:@"Date"];
[request setHTTPBody:contentData];

NSLog(@"request: %@", request);

// send the request
NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSLog(@"return data: %@", returnData);

NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];

NSLog(@"return string: %@", returnString);

return returnString;
} 
```

这就是我在图片中使用的。m

```
UIImage *originalImage = [info objectForKey:UIImagePickerControllerOriginalImage];
if (originalImage) {

    NSData *jpegData = UIImageJPEGRepresentation(originalImage, 0.75);
    KQuery *query = [[KQuery alloc] initWithImageData:jpegData type:@"jpeg"];
    query.secretKey = @"3r4yq0LI";
    //query.location = locationManager.location; // might be nil
    result = [query create];
    NSLog(@"The return string: %@", [query create]);
} 
```

这是有效的 PHP 查询：

```
$boundary = uniqid();

# Construct the body of the request
$body  = image_part($boundary, "image", $file_name, $img);
$body .= "--" . $boundary . "--\r\n";

var_dump($body);

$context = stream_context_create(array(
          'http' => array(
               'method' => 'POST',
               'header' => 'Content-type: multipart/form-data; boundary='.$boundary."\r\n" .
                           'Authorization: Token ' . $query_key,
               'content' => $body
               )
          ));

 $result = file_get_contents($url, false, $context);

 echo "Result: ", $result;

 # add image part to a kooaba multipart request
 function image_part($boundary, $attr_name, $file_name, $data) {
 $str  = "--" . $boundary . "\r\n";
 $str .= 'Content-Disposition: form-data; name="'. $attr_name .'"; filename="' .    $file_name . '"' . "\r\n";
 $str .= 'Content-Transfer-Encoding: binary' ."\r\n";
 $str .= 'Content-Type: image/jpeg' . "\r\n\r\n";
 $str .= $data . "\r\n";
 return $str;
} 
```

我想我在 PHP 中使用的所有东西也都在 ObjectC 中......，任何人都知道如何检查我发送的头文件或如何调试它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T13:14:26.370

因此，要回答您的问题，如何调试 ObjC 文件以检查字符串的值，我发现最简单的方法是在使用您设置的变量之前放置一个断点。

因此，在您的示例中，您将在该行上方放置一个断点：

```
NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil]; 
```

一旦模拟器（或真实设备）在断点处暂停，当您将鼠标悬停在变量上时，它们的值就会弹出。

这在 iOS 编码中是一件非常有用的事情。

希望这有帮助。

# spring - 将 bean 连接到实现 IInvokedMethodListener 的 TestNG 侦听器

> ID：14388141
> 
> 赞同：4
> 
> 时间：2013-01-17T21:07:28.873
> 
> 标签：spring, testng, spring-3

我有一个实现`IInvokedMethodListener`. 我想在这个监听器中连接一个 Spring bean 并使用它。不幸的是，这个类是由 TestNG 实例化的，因此 Spring 无法连接任何使用`@Autowired`. 我尝试实施`ApplicationContextAware`，但这也不起作用。

有没有办法将 Spring bean 连接到实现的类中`IInvokedMethodListener`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T17:34:41.877

`ApplicationContextAware`仅适用于 Spring Bean。您可以使用[@Configurable](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#aop-atconfigurable)，但这需要 AspectJ。

这是一个应该起作用的简单技巧：将静态成员添加到您的侦听器类并通过非静态设置器注入它。

```
public class MyMethodListener implements IInvokedMethodListener {

   private static MyBean myBean;

   @Autowired
   public void setMyBean(MyBean myBean) {
        MyMethodListener.myBean = myBean;
   }
} 
```

在应用程序上下文中包含所需类型的 bean。

TestNG 实例化的侦听器与 Spring 上下文中的实例不同，但它将具有静态成员集，前提是在 TestNG 实例化侦听器之前已完成上下文创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-14T03:02:29.017

我最近也遇到了同样的问题，基本上是 Spring 没有维护 Listeners。所以我围绕这个概念做了一些谷歌搜索，比如“将 bean 注入不受 spring 管理的类”，我得到了[https://dzone.com/articles/autowiring-spring-beans-into-classes-not-managed-by-spring](https://dzone.com/articles/autowiring-spring-beans-into-classes-not-managed-by-spring)链接这解释了完全相同的问题和解决方案。它对我有用。

# python - python的PIL和ImageMagick绑定有什么区别？

> ID：14388144
> 
> 赞同：4
> 
> 时间：2013-01-17T21:07:47.640
> 
> 标签：python, image, imagemagick, python-imaging-library

我研究了使用 python 缩放图像（创建缩略图）的不同方法。谁能解释我在[ImageMagick](http://www.imagemagick.org/script/index.php)过程和[PIL](http://www.pythonware.com/library/pil/handbook/index.htm)过程之后结果图像的根本区别。乍一看[，python 没有任何功能齐全的 ImageMagick 绑定](http://www.imagemagick.org/script/api.php#python)。我见过一些解决方案，但其中大多数似乎很差（功能或文档差，API 不好）。另一方面，我读到 PIL 在调整 GIF 图像大小时存在一些问题。并且 PIL 处理后的结果图像质量比使用 ImageMagick 的类似效果差。你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:06:06.317

我在工作中使用 IM 构建了一个缩略图生成器。IM 的优点在于能够处理大量文件类型。我不得不用它来生成 pdf 和电影缩略图。使用 IM 的缺点是，我用 IM 构建弹出式界面的时间比我在缩略图生成器的其他部分上花费的时间要多得多。

PIL 可以与 pyffmpeg 之类的东西一起使用，但看起来这种组合不像 IM 那样功能齐全，这就是我过去不使用它的原因。如果您可以摆脱 PIL，我建议您使用 PIL，但如果您需要为更奇特的文件类型生成缩略图，或者您对 PIL 的质量不满意，那么 IM 肯定是可行的。

# symfony - Symfony2 在刷新之后/之前将其他行设置为 0

> ID：14388145
> 
> 赞同：0
> 
> 时间：2013-01-17T21:07:48.460
> 
> 标签：symfony, doctrine-orm

这就是我遇到的麻烦。

我有一个表，其中包含一个名为的列`shown_on_homepage`，只有一行应该设置为 1，其余的都应该设置为 0。我正在尝试向数据库添加一个新行，这一行应该设置为 1，将之前为 1 的那个设置为 0。

在 MySQL 中，我知道这可以通过在插入之前发出更新来实现：

```
UPDATE table_name SET shown_on_homepage = 0 
```

这是我的实体：

```
class FeaturedPerson {

/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer", nullable=false)
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="IDENTITY")
 */    
private $id;

/**
 * @var string 
 *
 * @ORM\Column(name="content", type="string", length=2500, nullable=false)
 */
private $content;

/**
 * @var \DateTime 
 *
 * @ORM\Column(name="date_updated", type="datetime")
 */
private $dateUpdated;

/**
 * @var bool
 *
 * @ORM\Column(name="shown_on_homepage", type="boolean", nullable=false)
 */
private $isShownOnHomepage;

//...

public function getIsShownOnHomepage() {
    return $this->isShownOnHomepage;
}

public function setIsShownOnHomepage($isShownOnHomepage) {
    $this->isShownOnHomepage = $isShownOnHomepage;
    return $this;
}

} 
```

对于控制器，我有：

```
$featured = new FeaturedPerson();
$featured->setContent('Test content.');
$featured->setDateUpdated('01/02/2013.');
$featured->setIsShownOnHomepage(TRUE);

$em = $this->getDoctrine()->getManager();
$em->persist($featured);
$em->flush(); 
```

它确实添加了新行，但`shown_on_homepage`设置为 1 的行仍然具有它。我已经研究过，但我找不到实现这一目标的方法，希望你能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:20:07.837

您可以在控制器中的现有代码之前执行查询：

```
$queryBuilder = $this->getDoctrine()->getRepository('YourBundleName:FeaturedPerson')->createQueryBuilder('qb');
$result = $queryBuilder->update('YourBundleName:FeaturedPerson', 'd')
            ->set('d.isShownOnHomepage', $queryBuilder->expr()->literal(0))
            ->where('d.isShownOnHomepage = :shown')
            ->setParameter('shown', 1)
            ->getQuery()
            ->execute(); 
```

将“YourBundleName”更改为您的捆绑包名称。

# jquery - 我需要向 jQuery UI 工具提示添加预延迟，但似乎无法弄清楚

> ID：14388147
> 
> 赞同：9
> 
> 时间：2013-01-17T21:07:53.733
> 
> 标签：jquery, jquery-ui, tooltip

我需要在我的 jQuery UI 工具提示上添加一个预延迟。我使用的是最新版本 (1.9)，并希望提示在悬停后 2 秒打开。

我使用以下方法调用标题中的提示：

```
<script>
    $(function() {
        $( document ).tooltip({ predelay:2000,});   
    });
</script> 
```

但是当他们被解雇时，他们没有任何延迟......有什么帮助吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-17T21:34:40.413

用这个

```
$( "#elementid" ).tooltip({
  show: {
    effect: "slideDown",
    delay: 250
  }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-06T17:53:05.563

我有同样的问题，但最终想出了这个解决方案：

```
var opendelay = 500;
var closedelay = 500;
var target = $('.selector');
target.tooltip({ /* ... */ });
target.off('mouseover mouseout');
target.on('mouseover', function(event) {
    event.stopImmediatePropagation();
    clearTimeout(target.data('closeTimeoutId'));
    target.data('openTimeoutId', setTimeout(function() { target.tooltip('open'); }, opendelay));
});
target.on('mouseout', function(event) {
    event.stopImmediatePropagation();
    clearTimeout(target.data('openTimeoutId'));
    target.data('closeTimeoutId', setTimeout(function() { target.tooltip('close'); }, closedelay));
}); 
```

本质上它的作用是：

*   禁用工具提示的默认 onMouseOver 事件
*   为使用 setTimeout() 延迟的工具提示添加一个新的 mouseOver 事件
*   添加一个新的 mouseOut-event 取消超时（这可以防止工具提示显示，以防鼠标在延迟过去之前已经离开目标区域）
*   奖励：它还使用相同的技术添加了类似于“opendelay”又名“predelay”的“closedelay”
*   `event.stopImmediatePropagation();`仅在某些情况下需要。例如。如果您希望工具提示元素在悬停 IT 时保持可见（打开后）。如果需要，请在工具提示上注册相同的悬停事件：`target.tooltip({ open: function (event, ui) { ui.tooltip.hover(..., ...); } });`
*   ps 你也可以链接其中的几个调用，比如`on`and `off`。
*   可以*用*或替换`target`事件函数内部。但我不确定也没有尝试过；毕竟可能行不通。`this``$(this)`
*   如果您不需要 closeDelay，只需删除包含`closeTimeoutId`or的行`closedelay`并删除`mouseout`in`target.off('mouseover mouseout');`或将其设置为 0
*   如果您不需要 openDelay 也是如此……反之亦然

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T21:33:22.317

IE 有悬挂逗号的问题，也许尝试删除它并查看是否有帮助：

```
$( document ).tooltip({ delay:2000 }); 
```

# c# - 另一个无法加载文件或程序集'EntityFramework

> ID：14388148
> 
> 赞同：5
> 
> 时间：2013-01-17T21:07:54.830
> 
> 标签：c#, asp.net-mvc-3, entity-framework, web-config

现在，我保证我已经用谷歌搜索了这个。堆栈溢出对于这个问题有大约 4 或 5 个解决方案。尽管如此，他们似乎都没有工作。我将 EntityFramework 5 (4.4) 与 MVC 3 项目一起使用。这在过去工作得很好，但是自从我打开这个项目已经有一段时间了（大约 20 天左右）。我刚刚卸载并重新安装了 Sql Server 2008 R2 Express。从那以后我重新启动了。

在我的所有 cshtml 文件中，我在 @model 行上看到一条错误下划线。当我将鼠标悬停在它上面时，我看到以下内容：

ASP.NET 运行时错误：无法加载文件或程序集“EntityFramework，Version=4.4.0.0，Culture=neutral，PublicTokenKey=b77a5c561934e089”或其依赖项之一。访问被拒绝。

我已经通过包管理器控制台卸载并重新安装了 EntityFramework 包。我也通过nuget完成了它。我已经关闭并重新打开了视觉工作室。我已经删除了引用并通过浏览 dll 手动添加了它。

我的 web.config 条目如下所示：

> [打开标签]section name="entityFramework" type="System.Data.Entity, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" [关闭标签]

有人有什么想法吗？

**编辑 1 完整错误详细信息**

```
Server Error in '/' Application.

Could not load file or assembly 'EntityFramework' or one of its dependencies. Access is denied.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.IO.FileLoadException: Could not load file or assembly 'EntityFramework' or one of its dependencies. Access is denied.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Assembly Load Trace: The following information can be helpful to determine why the assembly 'EntityFramework' could not be loaded.

=== Pre-bind state information ===
LOG: User = Unknown
LOG: DisplayName = EntityFramework
 (Partial)
WRN: Partial binding information was supplied for an assembly:
WRN: Assembly Name: EntityFramework | Domain ID: 2
WRN: A partial bind occurs when only part of the assembly display name is provided.
WRN: This might result in the binder loading an incorrect assembly.
WRN: It is recommended to provide a fully specified textual identity for the assembly,
WRN: that consists of the simple name, version, culture, and public key token.
WRN: See whitepaper http://go.microsoft.com/fwlink/?LinkId=109270 for more information and common solutions to this issue.
LOG: Appbase = file:///C:/MercurialProjects/ProxySetup/ProxySetup/
LOG: Initial PrivatePath = C:\MercurialProjects\ProxySetup\ProxySetup\bin
Calling assembly : (Unknown).
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\MercurialProjects\ProxySetup\ProxySetup\web.config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/014aecc8/d1c2eaf7/EntityFramework.DLL.
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/014aecc8/d1c2eaf7/EntityFramework/EntityFramework.DLL.
LOG: Attempting download of new URL file:///C:/MercurialProjects/ProxySetup/ProxySetup/bin/EntityFramework.DLL.
LOG: Using application configuration file: C:\MercurialProjects\ProxySetup\ProxySetup\web.config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Post-policy reference: EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
ERR: Failed to complete setup of assembly (hr = 0x80070005). Probing terminated.

Stack Trace: 

[FileLoadException: Could not load file or assembly 'EntityFramework' or one of its dependencies. Access is denied.]

[FileLoadException: Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. Access is denied.]
   System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
   System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +39
   System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks) +132
   System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +144
   System.Reflection.Assembly.Load(String assemblyString) +28
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +46

[ConfigurationErrorsException: Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. Access is denied.]
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +618
   System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +209
   System.Web.Configuration.CompilationSection.LoadAssembly(AssemblyInfo ai) +130
   System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +178
   System.Web.Compilation.BuildManager.GetPreStartInitMethodsFromReferencedAssemblies() +94
   System.Web.Compilation.BuildManager.CallPreStartInitMethods() +332
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +677

[HttpException (0x80004005): Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. Access is denied.]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +9090988
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +97
   System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) +258

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

**编辑 2**

根据上面的调试信息，我手动将应用程序使用的所有 dll 添加到 C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\014aecc8\d1c2eaf7 文件夹中，因为这就是最终引用的内容因为错误不断变化。

我没有看到 ASPNET 用户为 C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\ 目录分配权限。我添加了：IUSR、NETWORK、NETWORK SERVICE、IIS_USRS (\IIS_ISURS) 完全控制。我仍然收到错误消息。

由于我仍然因错误而被拒绝访问，我让用户完全控制我机器上的文件夹。应用程序加载。所以......这是一个权限错误。问题是，什么帐户需要权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-09T05:19:42.627

这可能看起来很奇怪，但是在遇到这个问题以及类似的问题之后，我已经确定了两个非常不正常的可能原因。

1）如果您使用的是 chrome，请确保在尝试构建解决方案时关闭 chrome（我假设您由于此错误而无法构建解决方案？）。我知道这听起来很疯狂，但我发现有时，无论出于何种原因，当我在开发过程中使用 chrome 时，某些文件变得无法访问。我仍然不知道为什么，但是如果您无法解决问题，那么值得一试。

2）在您的nuget包管理器中，如果您尚未重新安装实体框架，请将其卸载并重新安装。我发现当我将应用程序从一台机器移动到另一台机器时，或者我从版本控制更新它时，nuget 包会以某种方式搞砸。重新安装似乎是让它走上正轨的唯一方法。

3）关于您的权限特定问题，我不相信这是问题，但是，您的整个应用程序文件夹和子文件夹/文件应该设置具有完整读取/执行权限（但不是写入权限）的用户“Everyone”。这应该是您所需要的权限（至少这就是我在设置过程中似乎需要的全部）。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-02T16:14:22.790

如果您的解决方案有多个项目，请确保您的 edmx 模型位于具有引用该模型的代码的同一项目中。

这可能会令人困惑，因为您可以在不同的项目中引用模型，并且不会收到智能感知错误，即使在运行时确实出现了错误。

# java - 如何在 JSP 中使用 null 键获取 Map 值

> ID：14388149
> 
> 赞同：6
> 
> 时间：2013-01-17T21:07:55.457
> 
> 标签：java, jsp, map, el

我有一个`Map<Integer, Object>`从控制器传递给 JSP 的输入。有一个带有默认值的空键，这意味着`map.get(null)`返回一个默认对象。`keyObject.keyProp`是整数，可能为空。

当我在jsp中使用它时

```
<c:out value="${map[keyObject.keyProp]}"/> 
```

我没有得到空键的任何输出。有没有办法让空键在jsp中工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-17T22:51:34.620

似乎`null`使用标准 EL 实现获取键值的唯一方法是**在地图上****调用`get()`**方法（考虑到您所说的`keyObject.keyProp`解析为*Integer*对象）：

```
<c:out value="${map.get(keyObject.keyProp)}" /> 
```

我测试了这个解决方案并且它有效。

实际上，在这种情况下，您可以轻松地不`<c:out />`使用 ，只需在需要的地方使用普通 EL，例如

```
${map.get(keyObject.keyProp)} 
```

* * *

## 简单的例子：

*TestMapServlet.java*

```
package com.example;

import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.ServletException;

import java.util.Map;
import java.util.HashMap;

import java.io.IOException;

public class TestMapServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
                    throws ServletException, IOException {
        Map<Integer, Object> map = new HashMap<Integer, Object>();
        Integer noValueInt = null;
        Integer one = new Integer(1);
        Integer two = new Integer(2);

        map.put(noValueInt, "Default object for null Integer key");
        map.put(one, "Object for key = Integer(1)");
        map.put(two, "Object for key = Integer(2)");

        request.setAttribute("map", map);
        request.setAttribute("noValueInt", noValueInt);
        request.setAttribute("one", one);
        request.setAttribute("two", two);

        request.getRequestDispatcher("/test-map.jsp").forward(request, response);
    }
} 
```

*测试地图.jsp*

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<head>
    <title>Home Page</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
    <h1>Testing access to java.util.Map using just EL</h1>
    <p><b>\${map.get(noValueInt)}</b>: ${map.get(noValueInt)}</p>
    <p><b>\${map[one]}</b>: ${map[one]}</p>
    <p><b>\${map[two]}</b>: ${map[two]}</p>

    <h1>Testing access to java.util.Map using JSTL and EL</h1>
    <p><b>&lt;c:out value="\${map.get(noValueInt)}" /&gt; </b>: <c:out value="${map.get(noValueInt)}" /></p>
    <p><b>&lt;c:out value="\${map[one]}" /&gt; </b>: <c:out value="${map[one]}" /></p>
    <p><b>&lt;c:out value="\${map[two]}" /&gt; </b>: <c:out value="${map[two]}" /></p>

    <h2>Printing java.util.Map keys and values (when Key = null, the <i>null</i> won't be shown)</h2>
    <c:forEach items="${map}" var="entry">
        <p><b>Key</b> = "${entry.key}", <b>Value</b> = "${entry.value}"</p>
    </c:forEach>
</body>
</html> 
```

*web.xml*

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
                        http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    <servlet>
        <servlet-name>Test Map Servlet</servlet-name>
        <servlet-class>com.example.TestMapServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>Test Map Servlet</servlet-name>
        <url-pattern>/TestMap.do</url-pattern>
    </servlet-mapping>

</web-app> 
```

**重要说明**
为了能够使用 EL 调用带有参数的方法，您必须使用最低*Servlet 版本 3.0*。
从这里引用：[https ://stackoverflow.com/tags/el/info](https://stackoverflow.com/tags/el/info)

> 从 EL 2.2 开始，它作为 Servlet 3.0 / JSP 2.2（Tomcat 7、Glassfish 3、JBoss AS 6 等）的一部分进行维护，如果需要，可以使用参数调用非 getter 方法。

* * *

除了上述解决方案之外，您还可以使用具有替代解决方案的 **自定义统一表达式语言实现**，例如[**JUEL 。**](http://juel.sourceforge.net/index.html)

可以在[**Java Unified Expression Language (JUEL) 文档**](http://juel.sourceforge.net/juel.pdf)**中找到为什么不能（在标准实现中）通过***key* using访问*map*值和自定义解决方案的解释（段落中的重点是我的）： `null` *`[]`[](http://juel.sourceforge.net/juel.pdf)*

 ***> ## **2.5\. 高级主题**
> 
> ...
> 
> ### 启用/禁用空属性
> 
> EL 规范描述了`base[property]`. 如果 property 为 null，则规范声明不要在 base 上解析 null。`getValue(...)`相反，如果已调用null 则应返回， `PropertyNotFoundException`否则应抛出 a 。因此，不可能将 null 解析为映射中的键。但是，**JUEL 的表达式工厂可以配置为解析 null ，就像任何其他属性值一样**。要启用（禁用）null 作为 EL 属性值，您可以将属性设置 `javax.el.nullProperties`为 true (false)。
> 
> 假设标识符映射解析为`java.util.Map`.
> 
> *   如果功能`javax.el.nullProperties`已被禁用，则评估`${base[null]}`为右值（左值）将返回 null（引发异常）。
>     
>     
> *   **如果功能`javax.el.nullProperties` 已启用**，则评估`${base[null]}`为右值（左值）将获取（放置）该映射中键 null 的值。默认情况下不允许 null 作为 EL 属性值。
>     
>     
> 
> ...

希望这会有所帮助。***

# android - 使用简单加密类时出现坏垫块异常

> ID：14388151
> 
> 赞同：2
> 
> 时间：2013-01-17T21:07:59.273
> 
> 标签：android, encryption

当我尝试使用此类解密时，我得到“坏垫块异常”。知道为什么吗？

```
public class SimpleCrypto {

    public static String encrypt(String seed, String cleartext) throws Exception {
        byte[] rawKey = getRawKey(seed.getBytes());
        byte[] result = encrypt(rawKey, cleartext.getBytes());
        return toHex(result);
    }

    public static String decrypt(String seed, String encrypted) throws Exception {
        byte[] rawKey = getRawKey(seed.getBytes());
        byte[] enc = toByte(encrypted);
        byte[] result = decrypt(rawKey, enc);
        return new String(result);
    }

    private static byte[] getRawKey(byte[] seed) throws Exception {
        KeyGenerator kgen = KeyGenerator.getInstance("AES");
        SecureRandom sr = SecureRandom.getInstance("SHA1PRNG");
        sr.setSeed(seed);
        kgen.init(128, sr); // 192 and 256 bits may not be available
        SecretKey skey = kgen.generateKey();
        byte[] raw = skey.getEncoded();
        return raw;
    }

    private static byte[] encrypt(byte[] raw, byte[] clear) throws Exception {
        SecretKeySpec skeySpec = new SecretKeySpec(raw, "AES");
        Cipher cipher = Cipher.getInstance("AES");
        cipher.init(Cipher.ENCRYPT_MODE, skeySpec);
        byte[] encrypted = cipher.doFinal(clear);
        return encrypted;
    }

    private static byte[] decrypt(byte[] raw, byte[] encrypted) throws Exception {
        SecretKeySpec skeySpec = new SecretKeySpec(raw, "AES");
        Cipher cipher = Cipher.getInstance("AES");
        cipher.init(Cipher.DECRYPT_MODE, skeySpec);
        byte[] decrypted = cipher.doFinal(encrypted);
        return decrypted;
    }

    public static String toHex(String txt) {
        return toHex(txt.getBytes());
    }

    public static String fromHex(String hex) {
        return new String(toByte(hex));
    }

    public static byte[] toByte(String hexString) {
        int len = hexString.length() / 2;
        byte[] result = new byte[len];
        for (int i = 0; i < len; i++)
            result[i] = Integer.valueOf(hexString.substring(2 * i, 2 * i + 2), 16).byteValue();
        return result;
    }

    public static String toHex(byte[] buf) {
        if (buf == null)
            return "";
        StringBuffer result = new StringBuffer(2 * buf.length);
        for (int i = 0; i < buf.length; i++) {
            appendHex(result, buf[i]);
        }
        return result.toString();
    }

    private final static String HEX = "0123456789ABCDEF";

    private static void appendHex(StringBuffer sb, byte b) {
        sb.append(HEX.charAt((b >> 4) & 0x0f)).append(HEX.charAt(b & 0x0f));
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T14:50:57.710

那段代码不知道如何生成密钥。它当然不应该使用`"SHA1PRNG"`来自 Sun 的专有的、未指定的（在 Android 下有不同的实现）从密码中派生密钥。

该`getRawKey`函数可能会在不同的平台上生成不同的密钥。它甚至可以在每次使用时生成*完全随机*的密钥，具体取决于`"SHA1PRNG"`. 这意味着*您可能永远无法再次检索明文*，尤其是在 Android 上。

如果您想使用密码加密某些内容，请查找有关如何使用基于密码的加密 (PBE) 的文章，其中使用 PBKDF2 执行密钥派生 - 提供 Oracle Java 平台。

* * *

此外，种子似乎使用默认字符编码，可能是 UTF-16 LE、UTF-16 BE、UTF-8 或一些基于拉丁文的字符编码。它还使用 ECB 作为默认使用 ECB 的`"AES"`实例`Cipher`，因此对您的数据保密并不安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:36:24.987

我认为您的 Simple Crypto 课程太简单了。任何时候，只要您对解密的编码不够好，甚至无法正常工作，最终都会出现坏垫块异常（除非您使用的是经过身份验证的加密）。

在上面的代码中，我什至没有看到初始化向量的任何用法，这意味着您的代码要么无法工作，要么真的不安全。

我的建议不要自己编写代码，甚至不要从互联网上剪切和粘贴代码。那里有很多糟糕的剪切和粘贴加密代码。请改用高级库。

[Keyczar](http://www.keyczar.org/)适用于安卓：

[https://github.com/kruton/android-keyczar-demo](https://github.com/kruton/android-keyczar-demo)

# actionscript-3 - AS3 - 在 BitmapData 中查找最丰富的像素颜色

> ID：14388164
> 
> 赞同：1
> 
> 时间：2013-01-17T21:08:22.693
> 
> 标签：actionscript-3, colors, bitmapdata, argb

基本上，我想获得出现在`BitmapData`. 也就是说，我想知道图像中哪个*像素*颜色最丰富。我尝试遍历图像的每个像素，并在出现已经存在的颜色时进行计数，但这太慢了，即使图像相对较小。有没有人知道一个更快的方法，也许使用`BitmapData.histogram()`函数或其他东西？

理想情况下，对于至少 1000x1000 像素左右的图像，该过程应该接近瞬时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T05:12:32.303

运行`bitmapData.getVector()`一个字典来保存数字，然后按值对该字典的键值对进行排序并获得最大值的键。

```
var v:Vector.<uint>=yourBitmapData.getVector(yourBitmapData.rect);
var d:Dictionary=new Dictionary();
for (var i:int=v.length-1; i>=0;i--) {
    if (d[v[i]]) d[v[i]]++; else d[v[i]]=1;
}
var maxkey:String=v[0].toString();
var maxval:int=0;
for (var k:String in d) {
    if (d[k]>maxval) {
        maxval=d[k];
        maxkey=k;
    }
}
return parseInt(maxkey); // or just maxkey 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T16:48:58.217

我根本没有使用过着色器，但我认为你可能能够获得更快的结果。在着色器级别循环通过像素更快。

我会尝试在着色器中创建基本相同的循环，并使用最常用的颜色和样本绘制整个生成的位图（除非您可以直接从着色器中获取变量）

这应该会更快

# javascript - 提交表单时复选框不会保持禁用状态

> ID：14388166
> 
> 赞同：1
> 
> 时间：2013-01-17T21:08:24.330
> 
> 标签：javascript, jquery, html, checkbox

我最近问[了一个](https://stackoverflow.com/questions/14371541/disable-checkboxes-not-exactly-working#comment19987168_14371541)关于如何在单击 ONE 时禁用一系列复选框的问题。那么下面的代码就是这样做的：[jsfiddle example](http://jsfiddle.net/83w8s/1/)。我现在遇到的并且之前应该测试过的问题是表单提交。

该复选框保持单击状态，但兄弟姐妹在应该禁用时仍保持启用状态。关于我必须更改以下内容以实现这一点的任何提示，以便只要第一个复选框保持单击状态，其余的保持禁用状态？

```
 $(function () {
      $("#disable").change(function () {
        $(this).closest('.control-group').siblings('.control-group').find('input').attr("disabled", $(this).is(":checked"));
      });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:13:35.083

I suspect your form submission results in a postback. If, as you said, the checkbox will remain checked on this postback, you can modify your code like so:

```
$(function () {
    $("#disable").change(function () {
        $(this).closest('.control-group').siblings('.control-group').find('input').attr("disabled", $(this).is(":checked"));
    }).change();  // trigger this immediately
}); 
```

# regex - 用于与 OR 条件匹配的位置的正则表达式

> ID：14388171
> 
> 赞同：0
> 
> 时间：2013-01-17T21:08:49.207
> 
> 标签：regex, pattern-matching

正则表达式的新手并在创建正则表达式时寻求帮助以寻求以下内容：

数据项由六个字符串组成，如下例所示

1）“100100”

2）“110011”

3) “010000”

4）“110011”

5）“111111”

6) “000111”

需要使用正则表达式来查找数据

*   1 在第 1 位或 1 在第 4 位：项目 1、2、4、5 和 6 应匹配

*   1 在第 2 位：项目 2,4 和 5 应该匹配

*   1 在第 5 和第 6 位：第 2、4、5 和 6 项应匹配

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T05:11:36.477

给定您的样本，这些将起作用：

*   1 在第 1 位或 1 在第 4 位：项目 1、2、4、5 和 6 应匹配

`1.....|...1...`

*   1 在第 2 位：项目 2,4 和 5 应该匹配

`.1....`

*   1 在第 5 和第 6 位：第 2、4、5 和 6 项应匹配

`....11`

或者，如果您想匹配这些规则中的*任何*一个，请将它们与`|`(or) 运算符结合使用。

例子：

[http://regexpal.com/?flags=g®ex=(1.....%7C...1...%7C.1....%7C....11)&input=100100%0A %0A110011%0A%0A010000%0A%0A110011%0A%0A111111%0A%0A000111](http://regexpal.com/?flags=g&regex=(1.....%7C...1...%7C.1....%7C....11)&input=100100%0A%0A110011%0A%0A010000%0A%0A110011%0A%0A111111%0A%0A000111)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:11:50.717

如果总是只有 1 和 0 的字符串，则应将它们视为二进制数并使用逻辑运算符来查找匹配项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T05:24:19.923

试试这个正则表达式

```
([1][0-1]{2}[1][0-1]{2})|([0-1][1][0-1]{4})|([0-1]{4}[1]{2}) 
```

在这里找到解释和演示[http://www.regex101.com/r/vD9jE7](http://www.regex101.com/r/vD9jE7)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T05:31:15.790

这是一个例子。如有必要，用零更改点。 `/^(11..|.1.1)11$/`

```
^              # beginning of string
(              # either
    11..     # 11 and any 2 char
    |          # or
    .1.1     # any char, 1, any char, 1
)
11
$             # end of string 
```

# java - 为什么 String.replaceAll() 需要对 " 字符进行这么多转义？

> ID：14388178
> 
> 赞同：1
> 
> 时间：2013-01-17T21:09:25.720
> 
> 标签：java, regex

如果我有字符串`a"b"c"`，但我想得到`a\"b\"c\"`，我自然会写

```
String t = "a\"b\"c\"";
t = t.replaceAll("\"", "\\\""); 
```

但是，这会产生相同的字符串`a"b"c"`. 正确的方法是

```
t.replaceAll("\"", "\\\\\""); 
```

为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T21:11:55.423

`replaceAll`对模式和替换都使用正则表达式 - 两者都需要转义反斜杠。所以你想要的第二个参数的*正则表达式替换模式是：*

```
\\" 
```

现在因为在*Java 字符串文字*`\`中也需要转义，这意味着这些字符中的每一个都需要一个额外的反斜杠。添加引号，您将获得：`"`

 *```
"\\\\\"" 
```

这就是你在你的源代码中得到的。

如果您只使用`String.replace`which*不*使用正则表达式，它会更简单。这样你只是试图提供这个字符串（不是字符串文字）作为第二个参数：

```
\" 
```

转义并变成字符串文字后，变为：

```
"\\\"" 
```

这仍然不是很好，但至少更好。

另一种方法是使用`replaceAll`but with [`Matcher.quoteReplacement`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#quoteReplacement%28java.lang.String%29)：

```
t = t.replaceAll("\"", Matcher.quoteReplacement("\\\"")); 
```

我个人只是使​​用`replace()`。毕竟，您不*想要正则表达式替换。**

# cocos2d-iphone - cocos2d-iphone 游戏有时会停止播放背景音乐

> ID：14388180
> 
> 赞同：0
> 
> 时间：2013-01-17T21:09:32.427
> 
> 标签：cocos2d-iphone

`cocos2d-iphone 1.0.1`.

我在我的设备中安装了其他 cocos2d-iphone 游戏时注意到了这一点，比如 Kingdom Rush。

基本上，大多数时候，音频都很好（几乎总是）。但是突然，在一个意想不到的时刻，**背景音乐停止播放，只有音效起作用**。有时，杀死应用程序并不足以修复它。

在我的`cocos2d-iphone`游戏中也会发生这种情况，控制台中没有任何提示。我`SimpleAudioEngine`用来播放背景音乐和音效。

杀死我的应用程序，重新启动 Xcode 不会修复它。我通常只是忽略这个问题，在不久的将来，它突然消失了。我怀疑重新启动设备往往会解决这个问题，但这超出了重点：我应该知道它*为什么*会发生。

我还尝试预加载我的背景音乐。不会改变任何事情。

我相信我在使用 .mp3 和 .wav 格式时都遇到过这个问题。

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T09:15:37.077

不知道确切的原因，但我能想到一些：

*   内存警告导致音频流中断
*   CocosDenshion 未正确处理音频中断（日历通知、传入短信/电话）
*   播放其他流媒体音乐（例如视频播放器、iPod 音乐播放器）
*   音乐不是流式传输而是缓冲的，这意味着音乐正在与所有其他效果争夺音频缓冲区 - 最终播放了如此多的音频效果，以至于旧缓冲区必须取消播放（可能是音乐）以允许新效果玩
*   有缺陷的设备（因为它发生在其他应用程序中......）
*   CocosDenshion 中的错误（检查 cocos2d 问题跟踪器和论坛是否有任何未解决的音频错误）

如果您使用 playBackgroundMusic API 流式传输音乐而不是缓冲音乐，我认为您可以排除后者。

# gwt - 使用我自己的复合基类时 GWT 设计器的问题

> ID：14388182
> 
> 赞同：0
> 
> 时间：2013-01-17T21:09:43.037
> 
> 标签：gwt

我想为我的复合表单使用基类，而不是直接从复合本身继承。当我这样做时，GWT 设计师会吐槽子类。

这是我的基类：

```
package com.mycompany.project.client.panels;

import com.google.gwt.user.client.ui.Composite;
import com.mycompany.project.client.PanelNotifyCallback;

public class PanelBase extends Composite
{
protected PanelNotifyCallback NextButtonNotify = null;
protected PanelBase THIS = this;

public void setNextButtonNotify( PanelNotifyCallback nextButtonNotify )
{
    NextButtonNotify = nextButtonNotify;
}
} 
```

这是一个子类：

```
package com.mycompany.project.client.panels.p2;

import com.google.gwt.user.client.ui.AbsolutePanel;
import com.google.gwt.user.client.ui.Label;
import com.google.gwt.user.client.ui.Button;
import com.google.gwt.event.dom.client.ClickHandler;
import com.google.gwt.event.dom.client.ClickEvent;
import com.google.gwt.user.client.ui.DoubleBox;
import com.mycompany.project.client.panels.PanelBase;

public class Panel2 extends PanelBase
{

public Panel2()
{

    AbsolutePanel absolutePanel = new AbsolutePanel();
    initWidget(absolutePanel);
    absolutePanel.setSize("472px", "227px");

    Label lblPanel = new Label("Panel2");
    lblPanel.setStyleName("gwt-Label_Panel1");
    absolutePanel.add(lblPanel, 193, 88);
    lblPanel.setSize( "67px", "23px" );

    Button btnNext = new Button( "Next" );
    btnNext.addClickHandler( new ClickHandler()
    {
        public void onClick( ClickEvent event )
        {
        //  NextButtonNotify.Notify( THIS );
        }
    } );
    absolutePanel.add( btnNext, 196, 166 );

    Label lblPrice = new Label("Price:");
    absolutePanel.add(lblPrice, 35, 37);

    DoubleBox doubleBoxPirce = new DoubleBox();
    doubleBoxPirce.setName("PriceBox");
    absolutePanel.add(doubleBoxPirce, 75, 25);
}
} 
```

这是我打开 panel2.java 的设计视图时发生的情况

```
Exception during 'super' constructor evaluation
An exception happened during evaluation of constructor PanelBase() using arguments {}. 

java.lang.AssertionError: This UIObject's element is not set; you may be missing a call to either Composite.initWidget() or UIObject.setElement()
at com.google.gwt.user.client.ui.UIObject.getElement(UIObject.java:556)
at com.mycompany.project.client.panels.PanelBase$$EnhancerByCGLIB$$9c1b2ca8.CGLIB$getElement$30(<generated>)
at com.mycompany.project.client.panels.PanelBase$$EnhancerByCGLIB$$9c1b2ca8$$FastClassByCGLIB$$1a67578f.invoke(<generated>)
at net.sf.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:215) 
```

我可以制作自己的基类并且仍然让设计师工作吗？如果是这样，有什么问题？这是一个相当简单的设置。从长远来看，我还想创建一些抽象基类。

我可以打开基类 PanelBase 的设计器视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T19:32:37.047

我找到了原因，导致设计师窒息的原因。

受保护的 PanelBase THIS = this;

那条线。如果您在基类中复制“this”指针，那么当您尝试打开子类上的设计选项卡时，设计器会呕吐。即使您在构造函数中执行此分配，它仍然会呕吐。

我不认为有解决办法。我只是想在子类中的一些匿名类中使用“this”指针。我认为基类将是这个参考的一个很好的持有者。

# c# - 你如何以编程方式设置 DataGridViewComboBoxCell 值？

> ID：14388184
> 
> 赞同：4
> 
> 时间：2013-01-17T21:09:48.743
> 
> 标签：c#, winforms

我在设置 DataGridViewComboBoxCell 的值时遇到问题。datagridview 列与选择/值绑定，但是当我尝试 dgv.Rows.Add 为组合框单元格指定列值或单独设置单元格的值时，它会生成“DataGridViewComboBoxCell 值无效”错误。如果我为这些列添加空白值的行，则选择会很好地显示在组合中。

我有一个对话框，它传递了一个简单对象 NDCRecord 的数组列表。

```
public class NDCRecord
    {        
        public string NDCcode = "";
        public string UnitQuantity = "";
        public string UnitOfMeasurement = "";
        public string Type = "";
        public string Number = ""; 
    } 
```

在对话框中，以编程方式创建数据网格，然后重新填充。

```
public NationalDrugCodesForm(ref ArrayList ndcRecordsIn)
        {
            InitializeComponent();

            ndcRecords = ndcRecordsIn;            
            SetupDataGridViewColumns();
            PopulateForm();
        } 
```

设置：

```
private void SetupDataGridViewColumns()
        {

            // -----------------------------------------------------
            // Add/Del column
            // -----------------------------------------------------
            DataGridViewButtonColumn dgvbcAddRemove = new DataGridViewButtonColumn();
            dgvbcAddRemove.HeaderText = "Add";
            dgvbcAddRemove.Text = "Add";
            dgvbcAddRemove.Name = "Add";

            DataGridViewCellStyle addButtonStyle = new DataGridViewCellStyle();
            addButtonStyle.BackColor = Color.Blue;
            addButtonStyle.ForeColor = Color.White;
            dgvbcAddRemove.HeaderCell.Style = addButtonStyle;

            dgvNDC.Columns.Add(dgvbcAddRemove);

            // -----------------------------------------------------
            // Additional Columns
            // -----------------------------------------------------
            dgvNDC.Columns.Add("NDCCode", "NDC Code");

            dgvNDC.Columns.Add("UnitQuantity", "Unit Quantity");

            DataGridViewComboBoxColumn unitOfMeasurement = new DataGridViewComboBoxColumn();
            unitOfMeasurement.HeaderText = "Unit Of Measurement";
            unitOfMeasurement.Name = "UnitOfMeasurement";
            dgvNDC.Columns.Add(unitOfMeasurement);

            DataGridViewComboBoxColumn type = new DataGridViewComboBoxColumn();
            type.HeaderText = "Type";
            type.Name = "Type";
            dgvNDC.Columns.Add(type);

            dgvNDC.Columns.Add("Number", "Prescription Number");

            AddLine("Del", "", "", "", "", "");

            BindUnitOfMeasurement((DataGridViewComboBoxCell)dgvNDC.Rows[0].Cells["UnitOfMeasurement"]);
            BindType((DataGridViewComboBoxCell)dgvNDC.Rows[0].Cells["Type"]);            
        } 
```

AddLine 函数：

```
 private void AddLine(string buttonLabel, string ndcCode, string unitQuantity, string unitOfMeasurement, string type, string rxNumber)
    {
        dgvNDC.Rows.Add(new object[] { buttonLabel, ndcCode, unitQuantity, unitOfMeasurement, type, rxNumber });
    } 
```

绑定功能：

```
 private void BindUnitOfMeasurement(DataGridViewComboBoxCell cb)
    {
        string[] Values = { "F2", "GR", "ME", "ML", "UN" };
        string[] Choices = { "F2 - International Unit", "GR - Gram", "ME - Milligram", "ML - Milliliter", "UN - Unit" };

        ControlManip.DataBindDDL(cb, Choices, Values);
    }

    private void BindType(DataGridViewComboBoxCell cb)
    {
        string[] Values = { "XZ", "VY" };
        string[] Choices = { "XZ - Prescription Number", "VY - Link Sequence Number" };

        ControlManip.DataBindDDL(cb, Choices, Values);
        cb.Value = "XZ";
    }
public static void DataBindDDL(ref ComboBox cb, string[] Choices, string[] Values)
    {
      DataTable dt = new DataTable();

      dt.Columns.Add("Choice");
      dt.Columns.Add("Value");

      if (Choices.Length != Values.Length)
      {
        throw new Exception("Number of Choices and Values do not match!");
      }
      else
      {
        dt.Rows.Add(new object[] { "", "" });
        for (int i = 0; i < Choices.Length; i++)
        {
          if (Choices[i] is object && Values[i] is object)
          {
            dt.Rows.Add(new object[] { Choices[i], Values[i] });
          }
        }

        cb.DataSource = dt;
        cb.DisplayMember = "Choice";
        cb.ValueMember = "Value";
      }
    } 
```

填写表格：

```
 private void PopulateForm()
    {
        if (ndcRecords == null || ndcRecords.Count == 0)
            return;

        dgvNDC.Rows.Clear();

        foreach(NDCRecord record in ndcRecords)
        {
            AddLine("Del", record.NDCcode, record.UnitQuantity, record.UnitOfMeasurement, record.Type, record.Number);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T18:21:33.753

问题是我绑定的是单个单元格而不是包含下拉框的列。我插入了绑定方法，其中单击“添加”按钮使其看起来好像添加了一行空白值仍然会导致填充下拉列表。但是添加具有指定值的行会导致错误，因为该行的下拉列在其集合中还没有任何内容。所以这里是对代码的重要修改：

在 SetupDataGridViewColumns 而不是

```
 BindUnitOfMeasurement((DataGridViewComboBoxCell)dgvNDC.Rows[0].Cells["UnitOfMeasurement"]);
BindType((DataGridViewComboBoxCell)dgvNDC.Rows[0].Cells["Type"]); 
```

利用

```
BindUnitOfMeasurement((DataGridViewComboBoxColumn)dgvNDC.Columns["UnitOfMeasurement"]);
BindType((DataGridViewComboBoxColumn)dgvNDC.Columns["Type"]); 
```

并适当修改绑定方法。然后，您可以为组合添加带有空白值或指定值的行，它将起作用（其中一个具有指定为默认值的值，另一个留空供用户选择）

```
AddLine("Del", "", "", "", "XZ", ""); 
```

另外，我不确定这是否有必要，但在实验过程中，我还为每个组合框列添加了这个：

```
type.ValueType = typeof (string); 
```

# mysql - 在哪个列上运行 SQL COUNT() 有什么区别？

> ID：14388189
> 
> 赞同：2
> 
> 时间：2013-01-17T21:10:08.643
> 
> 标签：mysql, sql

首先，这不是问[在 SQL 中，count(column) 和 count(*) 有什么区别？](https://stackoverflow.com/questions/59294/in-sql-whats-the-difference-between-countcolumn-and-count).

假设我有一个`users`带有主键的表`user_id`和另一个`logged_in`描述用户现在是否登录的字段。

跑步有区别吗

`SELECT COUNT(user_id) FROM users WHERE logged_in=1`

和

`SELECT COUNT(logged_in) FROM users WHERE logged_in=1`

查看有多少用户被标记为已登录？也许与索引有区别？

如果有特定于数据库的细微差别，我正在运行 MySQL。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-17T21:13:17.777

在 MySQL 中，count 函数不会对 null 表达式进行计数，因此您的两次查询的结果可能会有所不同。正如评论和 Remus 的回答中提到的，这是 SQL 的一般规则和[规范](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_count)的一部分。

例如，考虑以下数据：

```
user_id   logged_in
1         1
null      1 
```

`SELECT COUNT(user_id)`在此表上将返回 1，但`SELECT COUNT(logged_in)`将返回 2。

实际上，问题中示例的结果应该始终相同，只要表构造正确，但使用的索引和查询计划可能会有所不同，即使结果相同。此外，如果这是一个简化的示例，计算不同的列也可能会改变结果。

另请参阅此问题：[MySQL COUNT() and nulls](https://stackoverflow.com/questions/1354060/mysql-count-and-nulls)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T21:21:10.807

记录一下：这两个查询返回不同的结果。正如[规范](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_count)所说：

> 返回SELECT 语句检索的行中 expr的**非 NULL**值的计数。

您可能会争辩说，给定`logged_in=1`NULL`logged_in`行的条件无论如何都会被过滤掉，并且`user_id`不会在 table 中包含 NULL `users`。虽然这可能是真的，但它并没有改变查询不同的基本原理。您要求查询优化器进行上述所有逻辑推论，对您来说它们可能是显而易见的，但对于优化器可能不是。

现在，假设实际上两者之间的结果总是相同的，答案很简单：**不要在生产中运行这样的查询**（我的意思是它们中的任何一个）。是扫描，无论您如何切片。`logged_in`基数太低而无关紧要。保留一个计数器，在每次登录和每次注销事件时更新它。它会随时间漂移，根据需要经常刷新（每天一次，每小时一次）。

至于问题本身：`SELECT COUNT(somefield) FROM sometable`可以使用窄索引就`somefield`导致更少的IO。建议使用`*`这个空间，因为优化器可以使用它认为合适的*任何*索引（但这会因产品而异，具体取决于我们处理的查询优化器的智能程度，YMMV）。但是当您开始添加 WHERE 子句时，可能的替代方案（=要使用的索引）很快就会消失。

# apache - 为什么 Apache 从不同的机器访问时服务不同的目录？

> ID：14388194
> 
> 赞同：0
> 
> 时间：2013-01-17T21:10:24.703
> 
> 标签：apache, osx-mountain-lion, httpd.conf

我正在尝试在 OS X 10.8.2 上配置 Apache，以便可以从其他机器访问默认的“系统”站点，而不能从“用户”站点访问。在`httpd.conf`我有

```
DocumentRoot "/Library/WebServer/Documents"

<Directory />
    Options -FollowSymLinks -MultiViews
    AllowOverride None
    Order deny,allow
    Deny from all
</Directory>

<Directory "/Library/WebServer/Documents">
    Options Indexes -FollowSymLinks -MultiViews
    AllowOverride None
    Order deny,allow
    Allow from all
</Directory> 
```

在`ME.conf`我有

```
<Directory "/Users/ME/Sites">
    Options Indexes -FollowSymLinks -MultiViews
    AllowOverride None
    Order deny,allow
    Deny from all
    Allow from localhost
</Directory> 
```

当从主机访问时，它的行为符合预期：`http://localhost/~ME/`映射到`/Users/ME/Sites`和`http://localhost`映射到`/Library/WebServer/Documents`. 但是当我从另一台机器访问 hostng 机器时，`http://hostingmachine`它不起作用，并`http://hostingmachine/~ME/`映射到`/Library/WebServer/Documents`. 我做了什么值得这样？有没有办法做我想做的事情，或者至少是接近的事情？

# css - CSS3 根据输入复选框的状态设置元素样式

> ID：14388197
> 
> 赞同：1
> 
> 时间：2013-01-17T21:10:30.723
> 
> 标签：css, css-selectors

这个例子中的“~”是什么意思？我从本教程中看到了这个例子。[http://css-tricks.com/the-checkbox-hack/](http://css-tricks.com/the-checkbox-hack/)

我知道它可以用来根据复选框的状态完全不同地设置元素的样式。但是，我找不到任何解释“~”的 CSS 文档？

```
input[type=checkbox] {
   position: absolute;
   top: -9999px;
   left: -9999px;
   /* For mobile, it's typically better to position checkbox on top of clickable
      area and turn opacity to 0 instead. */
}

/* Default State */
div {
   background: green;
   width: 400px;
   height: 100px;
   line-height: 100px;
   color: white;
   text-align: center;
}

/* Toggled State */
input[type=checkbox]:checked ~ div {
   background: red;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:13:02.573

它是兄弟元素的选择器。您在那里的那个会在同一个父级中找到选中复选框的所有“div”兄弟，但只有在 dom 中的复选框之后。复选框前面的“Div”兄弟姐妹将不包括在内。

很棒的选择器参考，包括波浪号： [http ://learn.shayhowe.com/advanced-html-css/complex-selectors](http://learn.shayhowe.com/advanced-html-css/complex-selectors)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T23:09:28.247

它是一个通用的兄弟组合器，类似于相邻的兄弟组合器 (+)。不同之处在于第二个选择器不必紧跟第一个选择器，这意味着它将选择前一个选择器之前的所有元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T21:34:16.320

[http://www.w3.org/TR/selectors/#general-sibling-combinators](http://www.w3.org/TR/selectors/#general-sibling-combinators)

> # 8.3.2\. 一般兄弟组合子
> 
> 通用兄弟组合符由分隔两个简单选择器序列的“波浪号”（U+007E，~）字符组成。两个序列表示的元素在文档树中共享相同的父元素，并且第一个序列表示的元素在（不一定立即）第二个序列表示的元素之前。
> 
> 例子：
> 
> h1 ~ pre
> 表示 h1 之后的 pre 元素。这是对以下内容的正确和有效但部分的描述：

```
<h1>Definition of the function a</h1>
<p>Function a(x) has to be applied to all figures in the table.</p>
<pre>function a(x) = 12x/13.5</pre> 
```

# vb.net - 在 Microsoft 更新脚本中插入重启命令

> ID：14388200
> 
> 赞同：0
> 
> 时间：2013-01-17T21:10:44.367
> 
> 标签：vb.net, command-line, vbscript, automatic-updates

我是脚本的新手，所以开始只是尝试调整其他脚本。我找到了一个从命令行检查、下载和安装 Microsoft 更新的脚本。有没有办法在完成时包含重新启动命令，或者在它之后的命令中包含菊花链或管道？

要运行它，请键入 cscript.exe ForceAU.vbs

有没有办法在它之后添加一个命令（shutdown /r），或者它必须是脚本本身的设置？

```
'************************************
'* Force Automatic Update Script    *
'* Goto http://www.intelliadmin.com *
'* for more tools and utilities     *
'************************************
' This script was adapted to only 
' install non-prompting updates
' and not ask any questions
' Original script can be found here:
' http://msdn.microsoft.com/en-us/library/windows/desktop/aa387102(v=vs.85).aspx

On Error Resume Next

function IsSecurityUpdate(Update)
 Set Categories = Update.Categories
 sName = lcase(Categories.Item(0).Name)
 'This works on all languages...the category name is always in english
 if (sName = "security updates" or sName="critical updates") then
  IsSecurityUpdate = TRUE
 else 
  IsSecurityUpdate = FALSE
 end if
end function

Sub ForceUpdate()

Set updateSession = CreateObject("Microsoft.Update.Session")
Set updateSearcher = updateSession.CreateupdateSearcher()

WScript.Echo "Searching for updates..." & vbCRLF

Set searchResult = updateSearcher.Search("IsInstalled=0 and Type='Software' and     IsHidden=0")

WScript.Echo vbCRLF & "Creating collection of updates to download:"

Set updatesToDownload = CreateObject("Microsoft.Update.UpdateColl")

bFound = FALSE

For I = 0 to searchResult.Updates.Count-1
    Set update = searchResult.Updates.Item(I)
    If IsSecurityUpdate(update) then
     WScript.Echo " " & update.Title 
     updatesToDownload.Add(update)
     bFound = TRUE
    end if
Next

if (NOT(bFound)) then
 WScript.Echo "This computer is up to date"
 Exit Sub
end if

WScript.Echo vbCRLF & "Downloading updates..."

Set downloader = updateSession.CreateUpdateDownloader() 
downloader.Updates = updatesToDownload
downloader.Download()

WScript.Echo  vbCRLF & "List of downloaded updates:"

For I = 0 To searchResult.Updates.Count-1
    Set update = searchResult.Updates.Item(I)
    If update.IsDownloaded Then
       WScript.Echo I + 1 & "> " & update.Title 
    End If
Next

Set updatesToInstall = CreateObject("Microsoft.Update.UpdateColl")

WScript.Echo  vbCRLF & _
"Creating collection of downloaded updates to install:" 

For I = 0 To searchResult.Updates.Count-1
    set update = searchResult.Updates.Item(I)
    If update.IsDownloaded = true Then
     if (IsSecurityUpdate(update)) then
         WScript.Echo I + 1 & "> adding:  " & update.Title 
         updatesToInstall.Add(update)   
     end if
    End If
ext

WScript.Echo "Installing updates..."
Set installer = updateSession.CreateUpdateInstaller()
installer.Updates = updatesToInstall
Set installationResult = installer.Install()

'Output results of install
WScript.Echo "Installation Result: " & _
installationResult.ResultCode 
WScript.Echo "Reboot Required: " & _ 
installationResult.RebootRequired & vbCRLF 
WScript.Echo "Listing of updates installed " & _
 "and individual installation results:" 

For I = 0 to updatesToInstall.Count - 1
    WScript.Echo I + 1 & "> " & _
    updatesToInstall.Item(i).Title & _
    ": " & installationResult.GetUpdateResult(i).ResultCode         
Next

end sub

ForceUpdate()

if (Err.Number<>0) then
 WScript.Echo "Error Downloading Updates. Check your internet connection"
 end if 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:16:55.010

可以尝试执行“shutdown -r -t 5”5秒后重启。

也许是这样的：

```
Set oShell = WScript.CreateObject("WSCript.shell")

oShell.run "cmd shutdown -r -t 5" 
```

# css - 如何使用 Zurb Foundation 和 SASS mixin 实现响应式 Pinterest 风格的布局？

> ID：14388202
> 
> 赞同：3
> 
> 时间：2013-01-17T21:10:47.630
> 
> 标签：css, responsive-design, sass, zurb-foundation

我正在将 Zurb Foundation 与 SASS 和 Compass 一起使用。我需要实现 [Pinterest](http://pinterest.com/)样式的列布局，其中每个“面板/引脚”可以具有不同的高度，但所有面板/引脚具有相同的宽度。挑战在于将它们放置在没有垂直间隙的情况下；使用'css float'会留下垂直间隙。我一直在 Zurb Foundation 中尝试各种网格选项，但收效甚微。有没有可以实现 Pinterest 风格布局的 mixin？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T13:44:17.717

您将需要更多的工具，而不仅仅是基础。我建议您尝试将此添加到您的项目中[http://masonry.desandro.com/](http://masonry.desandro.com/)

或者

更强大，但不能免费用于商业用途。 [http://isotope.metafizzy.co/](http://isotope.metafizzy.co/)

# javascript - 使用 jquery 和 ajax 解析 JSON 时出现问题。只在Firefox中工作

> ID：14388211
> 
> 赞同：0
> 
> 时间：2013-01-17T21:11:27.577
> 
> 标签：javascript, jquery, ajax, json

我有这个 jquery 代码：

```
var baseURl = 'http://www.testdomain.com';
bindItemImage("230015");

function bindItemImage(_itemCode) {
  $.ajax({
    url: baseURl + 'v3/api/itemimage/' + _itemCode,
    type: 'GET',
    contentType: "application/json;charset=utf-8",
    success: function (data) {
        var item = $.parseJSON(data);
       var file = baseURl + item.File;
       $('.itemPhoto').attr('src', file);
    }
   }); 
```

}

它在 Firefox 中显示图像很好，但在 IE 或 chrome 中不显示。Chrome 和 IE 返回正确的数据，但我收到一条 JS 错误消息“无法读取 null 的属性‘文件’”

这是 JS 小提琴 [http://jsfiddle.net/C8Xjy/3/](http://jsfiddle.net/C8Xjy/3/)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:20:14.060

当您期望设置`dataType`为的 json 响应时`"json"`，使用`contentType: "application/json;charset=utf-8",`is 用于在您的请求中发送 json 时。此外，当您将 json 指定为数据类型时，它在传递给成功处理程序时已经被解析。

```
$.ajax({
  url: baseURl + 'v3/api/itemimage/' + _itemCode,
  type: 'GET',
  dataType: "json",
  success: function (data) {
    var file = baseURl + data.File;
    $('.itemPhoto').attr('src', file);
  }
}); 
```

[**演示**](http://jsfiddle.net/mowglisanu/C8Xjy/7/)

# facebook - 获取 facebook 好友的所有图片的 object_id

> ID：14388212
> 
> 赞同：0
> 
> 时间：2013-01-17T21:11:30.527
> 
> 标签：facebook, facebook-graph-api

我正在尝试检索我朋友在 facebook 上拥有的所有图片的 object_id。

这是我使用的方法，我认为应该可以正常工作：

```
https://api.facebook.com/method/fql.query?access_token=[YOURTOKEN]&query=SELECT object_id FROM photo WHERE aid IN (SELECT aid FROM album WHERE owner IN (SELECT uid FROM friend WHERE uid1=me )) ORDER BY created DESC 
```

我的问题是我只检索到 5108 object_id's ，这与我所有朋友拥有的图片总数相去甚远。facebook有限制吗？任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:26:56.173

您可以在查询末尾添加`LIMIT`和。`OFFSET`因此，要获得前 1000 张照片，您将拥有`LIMIT 1000 OFFSET 0`，然后是下一组`LIMIT 1000 OFFSET 1001`，依此类推。

您还使用旧端点。您应该使用较新的：

```
 https://graph.facebook.com/fql?q=[QUERY]&access_token=[TOKEN] 
```

# entity-framework - 在实体框架中更新 - 以下对象尚未刷新，因为在商店中找不到它们

> ID：14388213
> 
> 赞同：0
> 
> 时间：2013-01-17T21:11:31.803
> 
> 标签：entity-framework

我正在使用以下代码保存一个 Order 对象：

```
public void SaveOrder (string orderNo)
{
    using (var se = new StoreEntities)
    {
        var order = new Order { OrderNumber = orderNo }

        try
        {
            //// Update
            if (se.Orders.Any(e => e.OrderNumber == orderNo))
            {
                se.Orders.Attach(order);
                se.ObjectStateManager.ChangeObjectState(order, EntityState.Modified);
            }
            //// Create
            else
            {
                se.Orders.AddObject(order);
            }
            se.SaveChanges();
        }
        catch (OptimisticConcurrencyException){
            se.Refresh(RefreshMode.ClientWins, order);
            se.SaveChanges();
        }
    }
} 
```

当它是一个新订单并且我只是插入数据库时​​，这很好用。但是，如果我尝试更新现有订单，我会收到他的错误：

> 由于在商店中找不到以下对象，因此未刷新它们：“EntitySet=Orders;OrderID=0”。

在数据库中，Order 表看起来像

```
OrderID | OrderNumber
13        567-87
15        567-93 
```

其中 OrderID 是一个身份键。除了这两行之外没有其他行，因为它们已被删除。

我做错了什么，我无法更新记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:50:09.630

看起来您收到错误是因为您正在附加`Order`您创建的新对象，就好像它`Order`已经存在一样 - 这就是`OrderID`错误中的原因为零的原因。

试试这个：

```
try
{
    //// Update
    var existingOrder = se.Orders.FirstOrDefault(e => e.OrderNumber == orderNo);

    if (existingOrder != default(Order))
    {
        existingOrder.DateLastUpdated = DateTime.Now;
        se.ObjectStateManager.ChangeObjectState(existingOrder, EntityState.Modified);
    }
    //// Create
    else
    {
        se.Orders.AddObject(order);
    }
    se.SaveChanges();
} 
```

*编辑*

您可以逐个属性地更新订单详细信息，或者如果您有一个`Order`（或一个`OrderViewModel`，也许是）包含要更新的详细信息，您可以使用[AutoMapper](http://automapper.codeplex.com/)之类的东西为您复制值。

# python - 如果我在 MapReduce 作业结束时清理 Google 存储，为什么 BigQuery 不更新？

> ID：14388214
> 
> 赞同：2
> 
> 时间：2013-01-17T21:11:38.937
> 
> 标签：python, google-app-engine, mapreduce, google-bigquery, google-cloud-storage

我有一个 Mapper Pipeline，我以 Google 的 App Engine 上的 log2bq 示例为模型。

细分：

1.  我将要处理的文件上传到 Blobstore
2.  我使用 Mapper 管道迭代文件，对其进行一些处理，并使用输出编写器将结果以 CSV 格式写入 Google Storage
3.  然后我提交一个 BigQuery 作业以使用新创建的文件填充到表中
4.  我查询表并将查询的输出写入 Blobstore
5.  用户下载最终结果

这一切都是通过使用许多管道来完成的。我的问题是，如果我在第 4 步之后启用在第 2 步中创建的文件的删除，那么我的 BigQuery 表不会更新。我尝试了两种方法：

1.  我创建了一个清理管道，在两个主要管道的末尾运行，只删除创建的文件
2.  我试图在第 4 步结束时删除文件（在同一管道中）

您可以在下面的代码中看到这两种方法都被注释掉了。如果我尝试删除文件，为什么 BigQuery 不更新？我删除它太快了吗？听起来好像是这样，但我很确定运行删除函数的代码只有在输出文件写入 Blobstore 后才会运行。任何帮助将非常感激！

我的主要管道`Blobstore2BigQueryMaster`如下

```
class Blobstore2GoogleStorage(base_handler.PipelineBase):
    def run(self, blobkey, bucket_name):
        yield mapreduce_pipeline.MapperPipeline(
            "<NAME>",
            "<MAPPER>",
            "mapreduce.input_readers.BlobstoreLineInputReader",
            "mapreduce.output_writers.FileOutputWriter",
            params={
                "input_reader" : {
                    "blob_keys": blobkey,
                },
                "output_writer": {
                    "filesystem": "gs",
                    "gs_bucket_name": bucket_name,
                    "mime_type": "text/csv",
                }
            },
            shards=24)

class GoogleStorage2BigQuery(base_handler.PipelineBase):
    def run(self, file_names, filekey):
        bq = bigquery.BigQueryApi()
        gspaths = [f.replace('/gs/', 'gs://') for f in file_names]

        result = bq.submit_job(jobData(<TABLE_NAME>, gspaths))
        yield BigQueryImportCheck(result['jobReference']['jobId'], filekey, file_names)

class BigQueryImportCheck(base_handler.PipelineBase):
    def run(self, job, filekey, file_names):
        bq = bigquery.BigQueryApi()
        status = bq.get_job(job_id=job)

        if status['status']['state'] == 'PENDING' or status['status']['state'] == 'RUNNING':
            delay = yield pipeline.common.Delay(seconds=1)
            with pipeline.After(delay):
                yield BigQueryImportCheck(job, filekey, file_names)

        yield BigQueryExport(filekey, file_names)  

class QueryCompletionCheck(base_handler.PipelineBase):
    def run(self, job):  
        bq = bigquery.BigQueryApi()
        status = bq.get_job(job_id=job)
        if status['status']['state'] == 'PENDING' or status['status']['state'] == 'RUNNING':
            delay = yield pipeline.common.Delay(seconds=1)
            with pipeline.After(delay):
                yield QueryCompletionCheck(job)

        yield pipeline.common.Return(status)

class BigQueryExport(base_handler.PipelineBase):
    def run(self, filekey, file_names):        
        bq = bigquery.BigQueryApi()
        #Submit Job to BigQuery Here
        #<REMOVED>

        response = yield QueryCompletionCheck(insertResponse['jobReference']['jobId'])

        #WRITE QUERY RESPONSE TO BLOBSTORE HERE
        #<REMOVED>

        #files.delete(",".join(file_names))
        yield pipeline.common.Return(response)

class Blobstore2BigQueryMaster(base_handler.PipelineBase):
    def run(self, filekey, blobkey, bucket_name):
        file_names = yield Blobstore2GoogleStorage(blobkey, bucket_name)
        synchronize = yield GoogleStorage2BigQuery(file_names, filekey)
        yield CleanupCloudStorage(synchronize, file_names)

class CleanupCloudStorage(base_handler.PipelineBase):
    def run(self, synchronize, file_names):
        #files.delete(",".join(file_names))
        yield pipeline.common.Return('Done')

def jobData(tableId, sourceUris):
    #Configuration for the BigQuery Job here including
    #'createDisposition':'CREATE_IF_NEEDED'
    #'writeDisposition':'WRITE_TRUNCATE' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T02:02:35.803

BigQuery 加载作业完成后，您可以安全地从 Google Cloud Storage 中删除 CSV 文件。

我建议检查已完成的作业是否有错误，以查看是否可以揭示导入失败的原因，如果可能，请确认您的导入完成检查不会过早返回。

# google-app-engine - 当 GAE（Google App Engine）搜索 API 服务退出实验时，配额和定价将是多少

> ID：14388220
> 
> 赞同：1
> 
> 时间：2013-01-17T21:11:50.857
> 
> 标签：google-app-engine, gae-search

如果没有关于 Search API 的预期配额或定价的信息（当然对于计费应用程序），考虑迁移到 GAE 的人几乎不可能建议继续进行甚至调查此选项。这两个变量是查看搜索 API 时首先要考虑的变量。我们知道缺少一些功能，但是基础知识就在那里。

通过向我们提供一些对此的见解，您肯定会吸引更多的人来调查和尝试 GAE。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-10T21:47:05.200

您可以在此处找到一般可用性搜索配额信息[，在此处找到定价信息（针对免费层之外](https://cloud.google.com/appengine/docs/quotas#search)[的](https://cloud.google.com/appengine/pricing#search_pricing)查询和数据）。

# sublimetext2 - 如何设置键盘快捷键以在 sublimetext2 中从制表符转换为空格

> ID：14388223
> 
> 赞同：19
> 
> 时间：2013-01-17T21:11:57.093
> 
> 标签：sublimetext2, sublimetext

我将用来为菜单项设置键盘快捷键的 Key Bindings 文件中的选项是什么

```
View -> Indentation -> Convert Indentation To Spaces 
```

我尝试了以下方法，但无法弄清楚如何触发我在上述菜单中看到的选项

```
{ "keys": ["super+t"], "command": "convert_to_tabs" },
{ "keys": ["shift+super+t"], "command": "convert_to_spaces" }, 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-17T21:48:18.177

## 简单版

将空格转换为制表符（来自 Eric Muyser）：

```
{ "keys": ["ctrl+shift+x"], "command": "unexpand_tabs", "args": { "set_translate_tabs": false } } 
```

将制表符转换为空格（来自 mVChr）：

```
{ "keys": ["ctrl+shift+y"], "command": "expand_tabs", "args": { "set_translate_tabs": true } } 
```

原答案如下

* * *

您可以[分别使用一个命令](http://www.sublimetext.com/docs/2/indentation.html)(`expand_tabs`和`unexpand_tabs`)，但切换“使用空格缩进”也是一个好主意。这是我在某处看到的宏（我忘了在哪里。）

## 宏版本

**选项卡 -> 空格**

在“Packages/User”文件夹中另存为“convert_tabs_to_spaces.sublime-macro”

```
[
  {
    "args":
    {
      "set_translate_tabs": true
    },
    "command": "expand_tabs"
  }
] 
```

将此添加到您的键绑定文件中：

```
 { "keys": ["ctrl+shift+x"], "command": "run_macro_file", "args": {"file": "Packages/User/convert_tabs_to_spaces.sublime-macro"} }, 
```

**空格 -> 制表符**

相似的文件名和键绑定

```
[
  {
    "args":
    {
      "set_translate_tabs": false
    },
    "command": "unexpand_tabs"
  }
] 
```

我一直使用它，直到我看到您可以左键单击状态栏中的缩进设置并从那里进行更改。

## 编辑：

## 插件版本

[从这里改编](http://www.butlerpc.net/blog/2012/07/sublime-text-2-plugin-to-convert-tabs-to-spaces-on-save/)

**“convert_tabs_to_spaces.py”**

```
import sublime, sublime_plugin

class ConvertTabsToSpaces(sublime_plugin.TextCommand):
    def run(self, edit):
        self.view.run_command('expand_tabs', {"set_translate_tabs": True}) 
```

.

键绑定：`{ "keys": ["ctrl+shift+x"], "command": "convert_tabs_to_spaces"},`

**“convert_spaces_to_tabs.py”**

```
import sublime, sublime_plugin

class ConvertSpacesToTabs(sublime_plugin.TextCommand):
    def run(self, edit):
        self.view.run_command('unexpand_tabs', {"set_translate_tabs": False}) 
```

.

键绑定：`{ "keys": ["ctrl+shift+y"], "command": "convert_spaces_to_tabs"},`

# android - 确定存在的外部键

> ID：14388225
> 
> 赞同：0
> 
> 时间：2013-01-17T21:12:04.503
> 
> 标签：android, android-keypad

有没有办法以编程方式检查我的 android 设备上存在哪些外部键（例如音量键、电源键、菜单键）。不同的设备可能有不同的外部密钥，因此想知道是否有办法确定设备上存在的外部密钥。如果那不可能，是否有不同的 API 来确定设备是否有外部音量增大/减小键、电源键、相机键

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:57:29.020

对于大多数硬件功能/传感器，您可以在[PackageManager](http://developer.android.com/reference/android/content/pm/PackageManager.html)类中找到有用的常量。

特别是对于硬件菜单键，您需要使用[ViewConfiguration](http://developer.android.com/reference/android/view/ViewConfiguration.html#hasPermanentMenuKey%28%29)类和它的*hasPermanentMenuKey()*方法。

而且我在检测硬件音量键方面找不到任何东西..

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-18T02:22:21.780

是的，实际上很容易......这里有一些代码可以确定键是否存在：

```
boolean hasCameraKey = KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_CAMERA);
boolean hasVolumeKeys = KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_VOLUME_UP)
                        && KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_VOLUME_DOWN); 
```

# ios - UIActivity 指示器未在 ios 应用程序启动时显示

> ID：14388229
> 
> 赞同：0
> 
> 时间：2013-01-17T21:12:29.333
> 
> 标签：ios, animation, nsthread, uiactivityindicatorview

我正在尝试在 iOS 中使用活动指示器但无法使用。我在 Stackoverflow 上关注了一个线程并像这样使用它。这就是我写的：

```
-(void)viewDidLoad
{
    [NSThread detachNewThreadSelector:@selector(threadStartAnimating:) toTarget:self withObject:self];

    UITapGestureRecognizer *tGR = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(doThisForTap:)];
    tGR.numberOfTapsRequired = 1;

    [myRollTypeLabel addGestureRecognizer:tGR];
    myRollTypeLabel.userInteractionEnabled = YES;

    [self.scrollView addSubview:myRollTypeLabel];
}

- (void) threadStartAnimating:(id)data
 {
self.activityIndicatorNew =[[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
self.activityIndicatorNew.color = [UIColor redColor];
[self.activityIndicatorNew startAnimating];
 }
- (void)doThisForTap :(UIGestureRecognizer *)gest
{
  //lots of computation.
}
- (void)viewWillDisappear:(BOOL)animated
{
[self.activityIndicatorNew stopAnimating];
self.activityIndicatorNew.hidden = YES;
} 
```

但是活动指示器根本没有出现？在“doThisForTap”方法中，我进行计算并移动到另一个 UIViewController。但我看不到活动指示器。我究竟做错了什么？如果您需要更多信息，请询问。谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:37:18.607

看起来您实际上并没有使用 addSubview 将指示器添加到视图层次结构中：

您正在实例化它，将其分配给一个属性，并启动它的动画，但实际上从未将它添加到视图层次结构中（据我所知）。

要将活动指示器添加到屏幕中，您应该设置它的原点，然后将其添加到它应该出现的任何视图中：

```
self.activityIndicatorNew =[[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
self.activityIndicatorNew.color = [UIColor redColor];

CGRect indicatorFrame = self.activityIndicatorNew.frame;
indicatorFrame.origin.x = // x coordinate goes here;
indicatorFrame.origin.y = // y coordinate goes here;
self.activityIndicatorNew.frame = indicatorFrame;

[self.view addSubview:self.activityIndicatorNew];

[self.activityIndicatorNew startAnimating]; 
```

您不应该在后台线程中执行上述大部分操作，因为您不应该从除主线程之外的任何东西操作视图层次结构。

如果您确实需要在后台线程中启动指示器动画（不完全相信您从显示的代码中这样做），那么在该后台线程中唯一安全的做法就是调用 startAnimating。在分离新线程之前，其他所有内容都应该进入 viewDidLoad。

但是，我会先尝试在 viewDidLoad 中完成所有操作，并且仅在绝对必要时才使用后台线程。

就个人而言，我会为此使用 Interface Builder；我想不出很多理由在代码中实例化一个简单的活动指示器。

# javascript - 开发中的 Chrome 扩展自动重新加载

> ID：14388230
> 
> 赞同：0
> 
> 时间：2013-01-17T21:12:30.557
> 
> 标签：javascript, google-chrome-extension, websocket

我看到了这个问题：[如何自动重新加载我正在开发的 Chrome 扩展程序？](https://stackoverflow.com/questions/2963260/how-do-i-auto-reload-a-chrome-extension-im-developing)

但我在那里没有发现任何有用的东西。我试图让一些东西工作但我不太喜欢它。现在必须有其他方式，从最初的问题被问到已经有 2 年了。

那么，是否有任何应用程序或扩展程序可以让我在文件更改时重新加载扩展程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T00:50:35.373

你可以试试[Tincr](http://tin.cr/)。它允许您直接在浏览器中编辑/保存代码并在更改时自动重新加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-20T19:52:29.120

您可以为 Chrome使用**“ [Extensions Reloader](https://chrome.google.com/webstore/detail/extensions-reloader/fimgfedafeadlieiabdeeaodndnlbhid) ” ：**

> **使用扩展的工具栏按钮或浏览到“ [http://reload.extensions](http://reload.extensions) ”重新加载所有解压的扩展**
> 
> 如果您曾经开发过 Chrome 扩展程序，您可能希望自动重新加载解压缩扩展程序的过程，而无需浏览扩展程序页面。
> 
> “Extensions Reloader”允许你重新加载所有解压的扩展
> 
> 使用 2 种方式： 1 - 扩展的工具栏按钮。2 - 浏览到“ [http://reload.extensions](http://reload.extensions) ”。
> 
> 工具栏图标将使用单击重新加载解压缩的扩展。
> 
> “通过浏览重新加载”旨在使用“构建后”脚本自动重新加载过程 - 只需使用 Chrome 将浏览器添加到“ [http://reload.extensions](http://reload.extensions) ”到您的脚本，您将拥有一个刷新的 Chrome 窗口。

# javascript - 从 javascript 日期中删除“（东部标准时间）”

> ID：14388237
> 
> 赞同：1
> 
> 时间：2013-01-17T21:13:06.673
> 
> 标签：javascript, date

我有这个功能

```
//--format ISO8601 date into sections
function formatDate(date){
    var a = date.split(/[T]/);
    var d = a[0].split("-"); // date 
    var t = a[1].split(":"); // time
    t[2] = t[2].split("-"); // Remove Time zone offset 
    var formattedDate = new Date(d[0],(d[1]-1),d[2],t[0],t[1],t[2][0]);
    //formattedDate.replace(/ *\([^()]*\) */g, "");
    return formattedDate;
} 
```

它返回一个看起来像这样的日期

> 2013 年 1 月 15 日星期二 11:07:14 GMT-0500（东部标准时间）

我想删除（东部标准时间）部分。我尝试做formattedDate.replace，但它不起作用，因为我相信它不是字符串。

有什么建议么？

编辑：

我想要的输出是

> 2013 年 1 月 15 日星期二 11:07:14 GMT-0500

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T14:34:06.573

你返回的是一个`Date`实例。当您输出它（通过记录它等）时，它被转换为一个字符串。所以你想要的是`.toString()`然后使用字符串函数：

```
var str = formattedDate.toString();

// this should be safe since nothing else in the date string contains a opening paren
var index = str.indexOf(" (");

// if the index exists
if(~index) {
  str = str.substr(0, index);
} 
```

# dart - 如何在 Dart 中创建一个弹出窗口？

> ID：14388238
> 
> 赞同：5
> 
> 时间：2013-01-17T21:13:09.337
> 
> 标签：dart

我是使用 Dart 的新手。我想知道如何根据事件创建弹出窗口？我知道如何创建活动，但不确定如何创建弹出窗口。

```
void main()
{
  List<Element> radioButtons = queryAll(".requestType");
  Iterator i = radioButtons.iterator();
  while(i.hasNext)
  {
    var item = i.next();
    item.on.click.add(addRequestTypeEvent);
  }
}

void addRequestTypeEvent(Event event) {
    <POPUP WINDOW>
} 
```

2013 年 1 月 17 日更新：我想出了办法。

```
 window.open("http://www.yahoo.com", "yahoo", "status = 1, height = 300, width = 300, resizable = 0"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:30:39.733

只需使用[Window.open](http://api.dartlang.org/docs/bleeding_edge/dart_html/Window.html#open)：

```
window.open(url, name); 
```

[您可以在MDN](https://developer.mozilla.org/en/docs/DOM/window.open)上阅读更多关于`options`您可以作为第三个参数提供的内容。

还有一件事，您可以简化代码。以下内容相同：

```
void main()
{
  final radioButtons = queryAll(".requestType");

  // with forEach method
  radioButtons.forEach((item) => item.on.click.add(addRequestTypeEvent));

  // with for loop
  for (final item in radioButtons) {
    item.on.click.add(addRequestTypeEvent);
  }
} 
```

# c - 我是否将数组所有权从我的库函数传回给调用者？

> ID：14388239
> 
> 赞同：2
> 
> 时间：2013-01-17T21:13:16.973
> 
> 标签：c, pointers, malloc, heap-memory, ownership

我是从 Python 来到 C 的。Python 有一种非常简单的白手套操作字符串的方法。我在 C 中使用数组的次数越多，我就越觉得拥有某些特性会多么方便。我决定创建一个库来执行此操作，而不是每次我需要执行特定操作时都编写循环来执行此操作。

所以，假设我有一个库，调用看起来像这样：

`char* new_array = meatSlicer(old_array, element_start);`

我将指针传递给我想要更改的数组，期望指针返回，并指示要切片的元素。

如果`meatSlicer`（是的，我是一个错误命名的傻瓜）返回一个指向在切片器中本地创建的数组的指针，则该指针将是一个错误指针。所以，在`meatSlicer()`我有这个：

```
 ... manipulation before the below ...

    char *heap_the_Array;     /* put it on the heap to pass it back to caller */
    heap_the_Array = malloc((size + 1) * sizeof(char));

    int i;                
    for (i = 0; i <= (size + 1); i++){           /* make it so... again */

            heap_the_Array[i] = newArray[i];     /* newArray is the local */

    }

    return heap_the_Array;                       /* return pointer */ 
```

**我的问题是，**我是否正确地将所有权归还给调用者函数，以便它可以`free()`新数组？传递一个指向堆上数组的指针是否足够？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:17:42.183

是的，将局部变量复制到`malloc`-ed 内存区域效果很好。您可以用调用替换循环[`memcpy`](http://pubs.opengroup.org/onlinepubs/009695399/functions/memcpy.html)以减少代码大小。写

```
memcpy(heap_the_Array, newArray, size+1); 
```

代替

```
int i;                
for (i = 0; i <= (size + 1); i++){           /* make it so... again */
        heap_the_Array[i] = newArray[i];     /* newArray is the local */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T21:21:18.987

是的，您正在正确地将所有权转移给调用者函数。C 程序员不经常使用这种所有权方法，但有时会发生（`strdup`GNUish`asprintf`是广为人知的例子）。

您还可以从一开始就使用堆分配的数组，无需复制。

顺便说一句，在复制自身时，您的代码中存在一个错误：`for (i = 0; i <= (size + 1); i++)`调用主体的`size+2`时间。正如另一个答案所暗示的，与 size 参数一起使用`memcpy`确实比自己做更不容易出错。

最后一件事：`sizeof(char)`在 ANSI C 中总是 1，请不要乘以它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T21:18:21.913

是的，你的肉切片机是用 heap_the_Array 完成的，它现在属于调用者。所以调用者是现在唯一可以（并且必须）删除该数组的人，除非他将所有权传递给其他人。这种所有权概念必须由您以某种方式定义，并且您必须与它保持一致以避免麻烦并避免被内存泄漏怪物切割。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T22:02:35.407

已经清楚地解释了所有权如何转移。但是，我想提出一种“更传统”的方法。你的代码看起来很像我很乐意在 Python 中做的事情——但 C 不是 Python（而且 Python 也不是 C！），学习一门新语言的一部分是学习“如何用该语言完成事情”。对于刚刚学习 C 的程序员来说，有一种趋势是到处调用 malloc。尽量不要那样做。

不要让函数分配一个数组，而是在你的调用代码中传入一个数组，它有空间存放你想要复制的东西。然后返回你实际得到的元素数量，例如：

```
 TYPE new_array[some_size];
 int max_size = sizeof(new_array) / sizeof(new_array[0]);
 int actual_size;

 actual_size = meatSlicer(old_array, new_array, element_start, max_size); 
```

如果你想使用 malloc 来创建 new_array，那么你当然可以这样做：

```
 TYPE new_array = malloc(some_size * sizeof(TYPE));
 int max_size = some_size;
 int actual_size;

 if (new_array == NULL) panic();    // Do something useful here. 

 actual_size = meatSlicer(old_array, new_array, element_start, max_size);

 ... 

 free(new_array); 
```

我更喜欢使用固定大小的数组，因为开销较小，并且“以后记得释放”的需要较少 - 后者是代码中的常见问题，特别是当代码变得有点复杂并且有几个调用时所涉及的级别 - 如果您在一个函数中分配多个项目，例如，如果以后的分配失败，您需要记住清理第一个项目。让生活变得复杂...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-17T21:15:19.530

Yes, only stack allocated variables are automatically "freed" when a function returns, and you have correctly allocated an array on the heap, and correctly returned a pointer to it.

Specifically, the pointer variable `heap_the_Array` is allocated on the stack, and a copy of that value will be returned.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-17T21:18:27.363

尽管您*可以*返回指向堆分配对象的指针，但这并不意味着您可以忘记 NULL 终止字符数组:)。

它会起作用，只是不要忘记将尾随的 '\0' 添加到混合中，并且`free()`一旦完成，不要忘记将其添加到 char 数组中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-17T21:34:01.777

假设你的数组是字符串，你可以用一行替换你的错误代码。

```
return strdup(newArray); 
```

# java - Enabling/Disabling actions from another action

> ID：14388243
> 
> 赞同：1
> 
> 时间：2013-01-17T21:13:22.673
> 
> 标签：java, swing, netbeans, action, netbeans-platform

I have a callback action called AddAction. When AddAction is pressed I want it to enable all the components on the TopComponent as well as disable several of the other actions on the toolbar. Then when the SaveAction is pressed it saves the data to the database, enables the other actions and disables all the components on the TC.

Right now I have AddAction setup to enable all the components but I can't figure out how to disable the other actions as well.

AddAction

```
@ActionID(
    category = "1",
id = "com.waudware.Actions.AddAction")
@ActionRegistration(
    iconBase = "com/waudware/Actions/Icons/add.png",
    displayName = "#CTL_AddAction",
    key = "AddAction")
@ActionReferences({
    @ActionReference(path = "Menu/Record", position = 3333),
    @ActionReference(path = "Toolbars/AddEditDelete", position = 100)
})
@Messages("CTL_AddAction=Add")
public final class EditAction implements ActionListener {

    @Override
    public void actionPerformed(ActionEvent e) {
    }
} 
```

TopComponent

```
public RouteTopComponent() {
        initComponents();
        setName(Bundle.CTL_RouteTopComponent());
        setToolTipText(Bundle.HINT_RouteTopComponent());

        getActionMap().put("AddAction", new AbstractAction(){
            @Override
            public void actionPerformed(ActionEvent e) {
                addRoute(true);
            }
        });
}

private void addRoute(boolean add) {
        txtRoute.setEnabled(add);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:48:13.260

*   [Swing Action](http://docs.oracle.com/javase/7/docs/api/javax/swing/Action.html)有方法[setEnabled(boolean b)](http://docs.oracle.com/javase/7/docs/api/javax/swing/Action.html#setEnabled%28boolean%29)

*   看看[boolean isEnabled()](http://docs.oracle.com/javase/7/docs/api/javax/swing/Action.html#isEnabled%28%29)和非常有用的[get/putValue(String key, Object value)](http://docs.oracle.com/javase/7/docs/api/javax/swing/Action.html#putValue%28java.lang.String,%20java.lang.Object%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T20:23:38.160

我所做的：

```
getActionMap().get("AddAction").setEnabled(true | false); 
```

您还可以启用/禁用/隐藏整个工具栏

```
Toolbar toolbar;

toolbar = ToolbarPool.getDefault().findToolbar("toolbarName");
if (toolbar != null) {
    toolbar.setVisible(true | false);    // show / hide
    toolbar.setEnabled(true | false);    // enable / disable
} 
```

# javascript - 在指令中使用 ng-transclude 进行 ng-repeat

> ID：14388247
> 
> 赞同：46
> 
> 时间：2013-01-17T21:13:51.010
> 
> 标签：javascript, angularjs

我想在内容更改时创建一个具有自定义行为的列表。我尝试为此创建一个指令，但我对如何将 ng-transclude 与 ng-repeat 指令结合起来有点迷茫。有人可以让我走上正轨吗？

html:

```
<div ng-app="myApp">
  <div ng-controller="ctrl">
    <mylist items="myItem in items">
       <span class="etc">{{myItem}}</span>
    </mylist>
  </div>
</div> 
```

Javascript：

```
angular.module('myApp', [])    

.controller('ctrl', function ($scope) {
  $scope.items = ['one', 'two', 'three'];
})    

.directive('mylist', function () {
  return {
    restrict:'E',
    transclude: 'element',
    replace: true,
    scope: true,
    template: [
      '<ul>',
        '<li ng-repeat="WhatGoesHere in items" ng-transclude></li>',
      '</ul>'
    ].join(''),
    link: function (scope, element, attr) {
      var parts = attr.items.split(' in ');
      var itemPart = parts[0];
      var itemsPart = parts[1];
      scope.$watch(itemsPart, function (value) {
        scope.items = value; 
      });      
    }
  }
}); 
```

我有一部分在[这里工作](http://jsfiddle.net/BaQkw/)

### 编辑：

标准：

*   项目的模板必须在视图中定义，而不是在指令中，并且它必须能够访问子范围内的项目属性。理想情况下，我想像在 ng-repeat 指令中那样定义它
*   该指令必须有权访问该列表，以便我可以设置适当的手表并进行更改。如果可能的话，我希望能够轻松访问生成的 DOM 项目（我也可以使用它`element[0].querySelectorAll('ul>li')`或其他东西来实现，它只需要在 Chrome 上工作）。
*   如果可能的话，我想重用 ng-repeat 指令中的逻辑，因为它已经做了很多我想做的事情。最好我不想复制代码。我只想增强它的行为，而不是改变它

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-20T16:26:37.593

自己解决了这个问题：

我可以在编译步骤（[jsfiddle](http://jsfiddle.net/BaQkw/2/)）中通过`ng-repeat`在编译模板时添加属性并将我的属性内容提供给它来完成。

### html:

```
<div ng-app="myApp">
  <div ng-controller="ctrl">
    <mylist element="myItem in items">{{myItem}}</mylist>
  </div>
</div> 
```

### Javascript：

```
var myApp = angular.module('myApp', [])

.controller('ctrl', function ($scope) {
  $scope.items = ['one', 'two', 'three'];
})

.directive('mylist', function ($parse) {
  return {
    restrict:'E',
    transclude: 'element',
    replace: true,
    scope: true,
    template: [
      '<ul>',
      '<li ng-transclude></li>',
      '</ul>'
    ].join(''),
    compile: function (tElement, tAttrs, transclude) {
      var rpt = document.createAttribute('ng-repeat');
      rpt.nodeValue = tAttrs.element;
      tElement[0].children[0].attributes.setNamedItem(rpt);
      return function (scope, element, attr) {
        var rhs = attr.element.split(' in ')[1];
        scope.items = $parse(rhs)(scope);
        console.log(scope.items);
      }        
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-07-01T14:12:01.457

实现此目的的另一种方法如下。

索引.html：

```
<html ng-app='myApp'>

<head>
    <title>AngularJS Transclude within Repeat Within Directive</title>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.18/angular.min.js"></script>
    <script src='index.js'></script>
</head>

<body ng-controller='myController'>
    <people>Hello {{person.name}}</people>
    <button name="button" ng-click="changeRob()">Change Rob</button>
</body>
</html> 
```

index.js：

```
var myApp = angular.module( 'myApp', [] );

myApp.controller( 'myController', function( $scope ) {
    $scope.people = [
        { name: 'Rob'  },
        { name: 'Alex' },
        { name: 'John' }
    ];

    $scope.changeRob = function() {
        $scope.people[0].name = 'Lowe';
    }
});

myApp.directive( 'people', function() {
    return {
        restrict: 'E',

        transclude: true,
        template: '<div ng-repeat="person in people" transcope></div>',
    }
});

myApp.directive( 'transcope', function() {
    return {
        link: function( $scope, $element, $attrs, controller, $transclude ) {
            if ( !$transclude ) {
                throw minErr( 'ngTransclude' )( 'orphan',
                    'Illegal use of ngTransclude directive in the template! ' +
                    'No parent directive that requires a transclusion found. ' +
                    'Element: {0}',
                    startingTag( $element ));
            }
            var innerScope = $scope.$new();

            $transclude( innerScope, function( clone ) {
                $element.empty();
                $element.append( clone );
                $element.on( '$destroy', function() {
                    innerScope.$destroy();
                });
            });
        }
    };
}); 
```

在这个[类似的 plunker](http://plnkr.co/edit/IbNqR0854V8yXnajKSFB?p=preview)中查看它的实际效果。基于这个[长期的 Github 问题讨论](https://github.com/angular/angular.js/issues/7874)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-06-10T20:10:00.270

*不幸*的是，其他答案不适用于最新版本的 angular（我检查过`1.4`），所以我认为分享我发现的[这个 jsbin是有好处的：](http://jsbin.com/gegemapivu/1/edit?html,js,output)

```
var app = angular.module('app', [])
  .controller('TestCtrl', function($scope) {
    $scope.myRecords = ['foo', 'bar', 'baz'];
  });

app.directive('myDirective', function($compile) {
  var template = '<div id="inner-transclude" ng-repeat="record in records"></div>';

  return {
    scope: {
      records: '='
    },
    restrict: 'A',
    compile: function(ele) {
      var transclude = ele.html();
      ele.html('');

      return function(scope, elem) {
        var tpl = angular.element(template);
        tpl.append(transclude);

        $compile(tpl)(scope);

        elem.append(tpl);
      };
    }
  };
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.js"></script>

<div ng-app="app" ng-controller="TestCtrl">
  <div my-directive records="myRecords">
    ?: {{record}}
  </div>

</div>
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-17T21:45:49.693

嵌入不是必需的，因为`items`包含我们需要渲染模板的内容。换句话说，元素内部没有任何东西——即 `<mylist>nothing new here we need to transclude</mylist>`. 看来 Angular 也会为我们做 $watching。

```
.directive('mylist', function () {
  return {
    restrict:'E',
    replace: true,
    scope: true,
    template: [
      '<ul>',
      '<li ng-repeat="myItem in items">{{myItem}}</li>',
      '</ul>'
    ].join('')
  }
}); 
```

HTML：

```
<mylist></mylist> 
```

[小提琴](http://jsfiddle.net/mrajcok/SZATE/)。

请注意，创建新范围是可选的，因此您可以注释掉这一行：

```
//scope: true, 
```

**更新**：您可以选择创建一个隔离范围：

```
scope: { items: '='}, 
```

HTML：

```
<mylist items=items></mylist> 
```

[小提琴](http://jsfiddle.net/mrajcok/SZATE/3/)。

**更新**2：基于 Jan 提供的附加信息：

> 项目的模板必须在视图中定义...我想重用ng-repeat指令中的逻辑

好的，让我们把它全部放在视图中，并使用 ng-repeat：

```
<ul mylist>
  <li ng-repeat="myItem in items">
    <span class="etc">{{myItem}}</span>
   </li>
</ul> 
```

> 它 [指令] 必须有权访问子范围内的项目属性...该指令必须有权访问列表，以便我可以设置适当的监视和更改内容

按照你原来的小提琴，我们将使用一个普通的子范围（即，子范围将原型继承自父范围）`scope: true,`：这将确保指令可以访问在控制器范围内定义的属性，例如`items`.

> 访问生成的 DOM 项

该指令的链接函数有一个`element`参数。所以在上面的 HTML 中， element 将被设置为`<ul>`元素。所以我们可以访问所有的 DOM 元素。例如，`element.find('li')`或`element.children()`。在下面引用的小提琴中，我有 $watch`items`数组。$watch 回调可以访问`element`，因此您可以访问生成的 DOM 项。回调记录`element.children()`到控制台。

[小提琴](http://jsfiddle.net/mrajcok/SZATE/4/)。

总之，要将自定义行为添加到列表中，只需将指令放在 ul 或 ol 上，然后就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-12T06:16:17.363

我遇到了同样的问题并最终添加了一些代码，`ng-transclude`以便它允许观察和接受来自使用父级的自定义数据。

*   这样，嵌入的数据就可以访问祖父范围
*   并且还可以访问给它的 ng-repeat 数据。

**用法**

**祖父母.js**

```
<div>{{ $ctrl.listName }}</div.

<my-list items="$ctrl.movies">
   <div>From context: {{ name }}</div>
   <div>From grandparent: {{ $ctrl.listName }}</div>
</my-list> 
```

**Parent.js（我的列表）**

```
<li ng-repeat="item in $ctrl.items track by item.id">
  <cr-transclude context="item"></cr-transclude>
</li> 
```

**ng-transclude 的代码更改**

```
return function ngTranscludePostLink(
   ...
  ) {
  let context = null;
  let childScope = null;
  ...
  $scope.$watch($attrs.context, (newVal, oldVal) => {
    context = newVal;
    updateScope(childScope, context);
  });
  ...
  $transclude(ngTranscludeCloneAttachFn, null, slotName);
  ...
  function ngTranscludeCloneAttachFn(clone, transcludedScope) {
     ...                                 
     $element.append(clone);
     childScope = transcludedScope;
     updateScope(childScope, context);
     ...
  }
  ...
  function updateScope(scope, varsHash) {
    if (!scope || !varsHash) {
      return;
    }
    angular.extend(scope, varsHash);
  }
} 
```

完整代码在[Github](https://github.com/elpddev/cr-transclude)。

[在Codesandbox](https://codesandbox.io/s/cr-transclude-gi6fd?fontsize=14&hidenavigation=1&theme=dark)中可以看到一个工作示例。

# ios - 图像持久性和延迟加载与 Dispatch_Async 冲突

> ID：14388248
> 
> 赞同：4
> 
> 时间：2013-01-17T21:13:54.850
> 
> 标签：ios, objective-c, uiimageview, grand-central-dispatch

我正在开发一个提要阅读器，我通过使用 nsxmlparser 解析 rss 提要来做到这一点。我还有从 CDATA 块中获取的缩略图对象。

```
-(void)parser:(NSXMLParser *)parser foundCDATA:(NSData *)CDATABlock
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    NSString *someString = [[NSString alloc] initWithData:CDATABlock encoding:NSUTF8StringEncoding];
    NSString *storyImageURL = [self getFirstImageUrl:someString];

    NSURL *tempURL = [NSURL URLWithString:storyImageURL];

    NSData *tempData = [NSData dataWithContentsOfURL:tempURL];
    thumbnail = [UIImage imageWithData:tempData];

    });
} 
```

我正在使用归档和编码和解码方法来保存图像和其他 tableview 对象。

问题是当我按原样使用上述代码时，它不会保留图像，而其他 tableview 对象（如标题和发布日期）会保留。但是当我使用上面没有 dispatch_async 的代码时，它会开始保存图像但会锁定用户界面。

如何在不锁定用户界面的情况下保留图像？

请不要使用一些库来存储和缓存图像或 Apple 的延迟加载示例。谢谢

**更新：**

根据提供的答案，并在观看了斯坦福大学在 iTunes 中关于多线程的讲座后，我实现了上述代码，如下所示：

```
 NSString *someString = [[NSString alloc] initWithData:CDATABlock encoding:NSUTF8StringEncoding];
    NSString *storyImageURL = [self getFirstImageUrl:someString];
    NSURL *tempURL = [NSURL URLWithString:storyImageURL];

    dispatch_queue_t downloadQueue = dispatch_queue_create("image downloader", NULL);

    dispatch_async(downloadQueue, ^{
        NSData *tempData = [NSData dataWithContentsOfURL:tempURL];

        dispatch_async(dispatch_get_main_queue(), ^{
            thumbnail = [UIImage imageWithData:tempData];
        });
    });
} 
```

从逻辑上讲，现在一切都是正确的，但仍然无法正常工作。我都被阻止了如何解决这个问题。

**更新：**

我正在使用模型视图控制器存储方法，并且我的存储和连接代码在单独的文件中定义。下面是我使用 NSKeyedArchiver 的代码。

```
- (FeedChannel *) FeedFetcherWithCompletion:(void (^)(FeedChannel *, NSError *))block {

    NSURL *url = [NSURL URLWithString:@"http://techcrunch.com/feed/"];
    NSURLRequest *req = [NSURLRequest requestWithURL:url];

    FeedChannel *channel = [[FeedChannel alloc] init];

    TheConnection *connection = [[TheConnection alloc] initWithRequest:req];

    NSString *pathOfCache = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    pathOfCache = [pathOfCache stringByAppendingPathComponent:@"check.archive"];

    FeedChannel *channelCache = [NSKeyedUnarchiver unarchiveObjectWithFile:pathOfCache];

    if (!channelCachel) {
        channelCache = [[FeedChannel alloc] init];
    }
    FeedChannel *channelCopy = [channelCache copy];

    [connection setCompletionBlock:^(FeedChannel *obj, NSError *err) {
        if (!err) {
            [channelCopy addItemsFromChannel:obj];
            [NSKeyedArchiver archiveRootObject:channelCopy toFile:pathOfCache];
        }
        block(channelCopy, err);
    }];

    [connection setXmlObject:channel];
    [connection start];

    return channelCache;
} 
```

以下是我的编码和解码方法。

```
- (void)encodeWithCoder:(NSCoder *)aCoder
{
    [aCoder encodeObject:title forKey:@"title"];
    [aCoder encodeObject:link forKey:@"link"];
    [aCoder encodeObject:creator forKey:@"creator"];
    [aCoder encodeObject:pubDate forKey:@"pubDate"];
    [aCoder encodeObject:thumbnail forKey:@"thumbnail"];
    //[aCoder encodeObject:UIImagePNGRepresentation(thumbnail) forKey:@"thumbnail"];
    [aCoder encodeObject:publicationDate forKey:@"publicationDate"];

}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super init];
    if (self)
    {
        [self setTitle:[aDecoder decodeObjectForKey:@"title"]];
        [self setLink:[aDecoder decodeObjectForKey:@"link"]];
        [self setCreator:[aDecoder decodeObjectForKey:@"creator"]];
        [self setPubDate:[aDecoder decodeObjectForKey:@"pubDate"]];
        [self setThumbnail:[aDecoder decodeObjectForKey:@"thumbnail"]];
        //[self setThumbnail:[UIImage imageWithData:[aDecoder decodeObjectForKey:@"thumbnail"]]];
        [self setPublicationDate:[aDecoder decodeObjectForKey:@"publicationDate"]];

    }
    return self;
} 
```

根据答案，我不知道是否必须使用一些额外的代码来保留图像。因为标题、创建者等其他对象正在准确地持续存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:45:09.953

阅读您的评论后，我倾向于认为问题与您如何保持相对于 dispatch_async 块的图像有关。我将尝试解释，但这只是一个猜测，因为我不知道您将图像保存在哪里：

1.  在某些时候你`parser:foundCDATA:`被执行并且你异步检索你的图像；

2.  图像将在一段时间内不存在（直到同步块完成），因此`thumbnail`ivar/property 在完成后的一段时间内将没有正确的值`parser:foundCDATA:`；

3.  现在，如果您`thumbnail`在异步块完成之前坚持，您将坚持错误的（nil？）值；

4.  如果您不异步执行图像的获取，那么一切正常，这一事实使我认为您*过早*地保留图像（在上述意义上）。

对此的修复将是仅在异步块完成后保留图像。这可能意味着：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

  NSString *someString = [[NSString alloc] initWithData:CDATABlock encoding:NSUTF8StringEncoding];
  NSString *storyImageURL = [self getFirstImageUrl:someString];

  NSURL *tempURL = [NSURL URLWithString:storyImageURL];

  NSData *tempData = [NSData dataWithContentsOfURL:tempURL];
  thumbnail = [UIImage imageWithData:tempData];

  <code here to make the thumbnail be persisted>

}); 
```

`<code here to make the thumbnail be persisted>`可以是方法调用、通知帖子，任何适合您当前设计的内容。如果您的持久性代码不是线程安全的，您可能还需要使用将调用分派到主线程的技巧：

```
 dispatch_async(dispatch_get_main_queue(), ^{
      <persist thumbnail>;
  } 
```

希望能帮助到你。

编辑：

经过我们的交谈，上述分析得到证实。事实上，你不是简单地下载一个图像：你是在下载一堆图像，它们都属于同一个“频道”。这意味着应用于整个通道的持久化操作只有在所有这些图像都已下载后才能执行。

I have thus forked your gist and added some logics enabling the use of GCD dispatch_group to keep track of all the download operations. You can find it [here](https://gist.github.com/4579906).

# ember.js - 从其他控制器访问控制器

> ID：14388249
> 
> 赞同：15
> 
> 时间：2013-01-17T21:13:58.200
> 
> 标签：ember.js, ember-data

我正在使用 ember.js-pre3 ember-data 修订版 11 构建项目管理应用程序。

如何初始化几个控制器并使它们在全球范围内可用。例如，我有一个 currentUser 控制器和 usersController，我需要在每个状态下访问它们。我曾经在 Ember.ready 函数中有以下代码，但它不再有效。我想我这样做的方式是为了调试。[https://github.com/emberjs/ember.js/issues/1646](https://github.com/emberjs/ember.js/issues/1646)

旧方式：

```
window.Fp = Ember.Application.create
  ready: () ->

  # Initialize Global collections
  appController = @get 'router.applicationController'
  store = @get 'router.store'

  # User controller sets usersController binding on applicationController
  # fetches all team users from server
  # json returned from server includes flag "isCurrent"
  usersController = @get 'router.usersController'
  usersController.set 'content', store.findAll(Fp.User) 
  appController.set 'usersController', usersController

  # CurrentUserController
  # sets currentUserController binding on applicationController
  # finds currentUser from usersController 
  currentUserController = @get 'router.currentUserController'
  currentUserController.set 'content', usersController.get('findCurrentUser')
  appController.set 'currentUserController', currentUserController

  @_super() 
```

在所有应用程序状态下访问 currentUser 控制器的正确方法是什么。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-17T21:52:11.083

在最新版本的 ember (ember-1.0.0-pre.3.js) 中，您可以通过声明控制器依赖项来做到这一点。一旦声明了依赖项，就可以通过`controllers`属性访问它。例如：

```
window.App = Ember.Application.create();
App.ApplicationController = Ember.Controller.extend({   
  needs: ['currentUser', 'users']
});
App.CurrentUserController = Ember.ObjectController.extend({
  content: 'mike'
});
App.UsersController = Ember.ArrayController.extend({
  content: ['mike', 'jen', 'sophia']
}); 
```

由于 ApplicationController 需要 currentUser 和 users，这些控制器可以通过它的`controllers`属性访问，并且可以在应用程序模板中使用：

```
<script type="text/x-handlebars">
  <p>Signed in as {{controllers.currentUser.content}}</p>
  <h2>All Users:</h2>
  <ul>
    {{#each user in controllers.users}}
    <li> {{user}} </li>
    {{/each}}
  </ul>
</script> 
```

这是一个工作示例：http: [//jsfiddle.net/mgrassotti/mPYEX/](http://jsfiddle.net/mgrassotti/mPYEX/)

有关一些示例，请参见[https://github.com/emberjs/ember.js/blob/master/packages/ember-application/tests/system/controller_test.js](https://github.com/emberjs/ember.js/blob/master/packages/ember-application/tests/system/controller_test.js)

# android - Android : Network on main Thread with a Widget

> ID：14388250
> 
> 赞同：0
> 
> 时间：2013-01-17T21:14:06.113
> 
> 标签：android, multithreading, exception, networking, widget

I made a simple widget (`AppWidgetProvider`). To load its content, it needs to connect to the internet (`JSoup` is amazing). Obviously, I've got a wonderful `NetworkOnMainThreadException`. I tried to do an `AsyncTask` but Eclipse is shouting `No enclosing instance of type WidgetClass is accessible. Must qualify the allocation with an enclosing instance of type WidgetClass (e.g. x.new A() where x is an instance of WidgetClass).` at me, so I can't run it.

How could I solve it ?

Thanks !

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:31:16.590

也许您正试图在声明区域调用 myAsync().execute() ？

```
public class MyActivity extends Activity {
    new myAsync().execute();//wouldn't work
} 
```

# python - 如何在 Appengine 中删除或重置搜索索引

> ID：14388251
> 
> 赞同：5
> 
> 时间：2013-01-17T21:14:12.117
> 
> 标签：python, google-app-engine, full-text-search

## 情况

好的，所以我们在 appengine 中启动了我们的应用，并激活了全文搜索。我们在文档上设置了一个索引，其中包含一个名为“日期”的字段。该字段是 DateField，现在我们更改了文档的模型，因此字段“date”现在是 NumericField。

问题是，在生产服务器上，即使我从索引中清除了所有文档，服务器也会响应这种类型的错误：无法解析搜索请求“”；SortSpec 数值默认值与“日期”中的表达式类型“文本”不匹配

## 解决方案

问题是，“我认为”，服务器上的模型不适合搜索查询的模型。所以基本上，一种方法是删除整个索引，但我不知道如何在生产服务器上执行此操作。

开发服务器完美运行

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T00:03:23.550

如果您清空索引并调用`index.delete_schema()`（`index.deleteSchema()`在 Java 中），它将清除我们从字段名称到类型的映射，并且您可以按预期索引新文档。谢谢！

# php - 带有 HTML 模板的 PHP 模板

> ID：14388252
> 
> 赞同：1
> 
> 时间：2013-01-17T21:14:12.933
> 
> 标签：php, html

我正在使用 HTML 模板，我想将其转换为 PHP，这样会更容易管理，因为要创建多个文件。

使用 php 类并在页面中生成模板会更好吗？

例如：

```
$Template = new Template();

$Template->page_header();
$Template->tag("open-div");
$Template->search_bar();
$Template->tag("close-div"); 
```

或使用 HTML 生成相同的？

我知道这个问题已经有点死了，但不同的人会问不同性质的问题。所以请原谅我，如果这是一份报告，我只需要一个简短的回答或建议。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:32:44.300

与其重新发明轮子，不如使用已经内置了所有这些功能的 PHP 框架？您可以使用 OOP 操作系统并为您的 HTML 视图提供 PHP 变量。流行的框架包括：

*   [Zend 框架 2](http://framework.zend.com/)
*   [代码点火器](http://ellislab.com/codeigniter)
*   [CakePHP](http://cakephp.org/)

或者，如果您真的想保留对自己代码的控制权，请考虑使用模板引擎，例如：

*   [聪明的](http://www.smarty.net/)
*   [胡子](http://mustache.github.com/)

# python - Robot Framework：从 Python 库代码访问 Robot 的全局变量？

> ID：14388253
> 
> 赞同：23
> 
> 时间：2013-01-17T21:14:13.603
> 
> 标签：python, robotframework

我有一些设置类型的全局变量，我希望能够从 Python 代码中访问它们。例如：

```
pybot --variable RESULTS_PATH:/wherever/this/points test.txt 
```

现在，我的模块`logger.py`文件需要知道 results_path 才能正确设置。

我知道我可以用一个变量初始化记录器，比如

```
***Settings***
Library  logger  ${RESULTS_PATH} 
```

然后在记录器中，我将通过 results_path：

```
 def __init__(self, results_path):
   # Whatever 
```

然而，这样做对我来说的问题是我想从 Python 代码和测试用例中访问和使用记录器。因此，如果我以这种方式设置它，如果我想使用 Python 代码中的记录器，我会遇到同样的问题，即需要 results_path 来正确初始化记录器。

机器人框架库中是否有任何函数可以让我从 Python 代码中获取 ${RESULTS_PATH} 的值？做这样的事情的正确方法是什么？

现在，我的解决方法是将 RESULTS_PATH 设置为环境变量。所以我有类似的东西：

像这样运行：

```
RESULTS_PATH=/wherever/this/points pybot test.txt 
```

### 文件`test.txt`：

```
***Settings***
Library  logger
... 
```

### 文件`logger.py`：

```
results_path = os.environ["RESULTS_PATH"]
# Other set up stuff 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-18T07:48:22.843

您将需要使用 rf 的`BuiltIn`库，[请阅读此处找到的文档以供参考](http://robot-framework.readthedocs.org/en/2.7.6/autodoc/robot.libraries.html#robot.libraries.BuiltIn.BuiltIn.get_variable_value)。这提供了内置于 Robot Framework 中的关键字，因此应该可靠地保持可用：

```
from robot.libraries.BuiltIn import BuiltIn
results_path = BuiltIn().get_variable_value("${RESULTS_PATH}") 
```

# c++ - how to create a duplicate of a file using c++

> ID：14388256
> 
> 赞同：1
> 
> 时间：2013-01-17T21:14:27.080
> 
> 标签：c++

I need to duplicate a file that I generate using "ofstream". I wanted to know if there is any way without having to do it manually (creating another stream, reading the one I want to copy and writing what it was read) I search for this question in google, but all I could find was something that work in Windows, and I am working with linux

I am kind of new to c++ :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:17:29.177

听起来像是一份工作[`boost::iostreams::tee`](http://www.boost.org/doc/libs/1_52_0/libs/iostreams/doc/functions/tee.html)。

# java - 在 BroadcastReceiver() 中检索调用上下文

> ID：14388257
> 
> 赞同：4
> 
> 时间：2013-01-17T21:14:28.173
> 
> 标签：java, android, broadcastreceiver, android-alertdialog, android-context

我试图显示来自广播接收器的警报对话框片段，但接收器不在将显示片段的活动中（接收器处理此事件上的所有错误广播，无论它是否是活动活动）。

这是我当前的接收器：

```
private BroadcastReceiver mHttpPostReceiver = new BroadcastReceiver() {
      @Override
      public void onReceive(Context context, Intent intent) { 
              if (intent.getStringExtra("Error") != null) { // error occurred
                      // called from a fragment in another activity
                      NetworkError.show(((Activity) context).getFragmentManager(), error);
               }
      }
}; 
```

但是函数中的 context 参数是它所在的活动的当前上下文，并导致运行时非法状态异常，因为该活动不在屏幕上。有没有办法像通过广播一样发送调用函数的上下文？或者我应该用另一种方式来实现它吗？

我目前得到的具体错误是：

> java.lang.IllegalStateException：onSaveInstanceState 后无法执行此操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:30:16.900

您应该添加额外内容，说明`Activity`来自`Intent`您正在广播的呼叫，然后基于此，写入类似`SharedPreferences`. 然后在 Activity 中`onResume()`，检查首选项的键是否包含消息，然后更新 UI。

例如

```
@Override
public void onReceive(Context context, Intent intent) { 
  if (intent.getStringExtra("Error") != null) { 
    String callingActivity = intent.getStringExtra ("CallingActivity");
    if (callingActivity != null);
    context.getSharedPreferences (callingActivity, Context.MODE_PRIVATE).edit().putString ("errorMessage", "You have an error").commit();
  }
} 
```

然后在每个Activity的`onResume()`

```
@Override
 protected void onResume()
{
  super.onResume();
  String errorMsg =context.getSharedPreferences ("ThisActivityName", Context.MODE_PRIVATE).getString ("error");
  if (errorMsg.equals ("You have an error")){
    //update fragment code here.  
    //set SharedPreference errorMessage key to hold something else.
  } 
} 
```

我的方式是，每个 Activity 都有自己的 SharedPreferences 数据库，数据库名称与`callingActivity`. 这意味着当您从 onResume() 读取时，`"ThisActivityName"`应该是与`callingActivity`. 但这是主要思想，您可以修改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:17:56.197

我在 onReceive 方法中做了这样的事情：

```
 if (context instanceof LoginActivity) {
        switchLoginFields((LoginActivity) context, isConnected);
    } else if (context instanceof ReceiptActivity || context instanceof AmountActivity) {
        showArelt(context, isConnected);
    } 
```

# .net - Embedded WebBrowser control intercepts horizontal scroll events

> ID：14388259
> 
> 赞同：12
> 
> 时间：2013-01-17T21:14:37.937
> 
> 标签：.net, xaml, windows-phone-8

We've got a `Microsoft.Phone.Controls.WebBrowser` embedded control inside a `StackPanel`, inside a `PivotItem` on Windows Phone 8\. In a simplified form, it's basically:

```
<Grid>
  <controls:Pivot Width="425" Margin="50,0,0,0">
    <controls:PivotItem Margin="0,0,0,0" Width="400">
      <StackPanel>
        <!-- Other stuff -->
        <phone:WebBrowser Margin="0,0,0,0" Padding="0,0,0,0" Width="400" Height="600" />
      </StackPanel>
    </controls:PivotItem>
  </controls:Pivot>
</Grid> 
```

The problem is, unlike other controls, the `WebBrowser` seems to intercept all scroll events, even if no internal scrolling is required. This basically means that, once the `WebBrowser` control is on the screen, the only way to scroll to the next `PivotItem` is to tap on the headers at the top, which is a drag.

Some tricks I've tried include

*   Forcing the internal `ScrollViewer`'s `HorizontalScrollBarVisibility` to `Disabled`
*   Manually capturing `ManipulationDelta` and/or `ManipulationCompleted` events and propagating them up myself — they don't fire as you would expect them to
*   Trying every possible permutation of the `WebBrowser` and parent's width to make it realize that no scrolling is necessary.

It seems like something out of the ordinary is going on here. Any suggestions on how to change this behaviour?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T13:41:39.400

试用此链接。我认为 Colin Eberhardt 先生的解决方案将帮助您解决问题， [http://www.scottlogic.co.uk/blog/colin/2011/11/suppressing-zoom-and-scroll-interactions-in-the-windows -phone-7-浏览器控制/](http://www.scottlogic.co.uk/blog/colin/2011/11/suppressing-zoom-and-scroll-interactions-in-the-windows-phone-7-browser-control/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T13:13:40.890

在此处查看解决方案[http://developer.nokia.com/Community/Wiki/Windows_Phone%E4%B8%ADPivot%E5%86%85%E5%B5%8CWebBrowser%E6%97%B6%E7%9A%84 %E6%A8%AA%E5%90%91%E6%BB%91%E5%8A%A8%E5%A4%84%E7%90%86](http://developer.nokia.com/Community/Wiki/Windows_Phone%E4%B8%ADPivot%E5%86%85%E5%B5%8CWebBrowser%E6%97%B6%E7%9A%84%E6%A8%AA%E5%90%91%E6%BB%91%E5%8A%A8%E5%A4%84%E7%90%86)。下载源代码并浏览代码。但该应用程序应该是 Pivot 应用程序而不是全景应用程序。

# html - Place text in lower right corner of a button

> ID：14388260
> 
> 赞同：0
> 
> 时间：2013-01-17T21:14:38.827
> 
> 标签：html, css, button, text-align

I've been searching for the answer on how to do this for awhile now. Basically is what I want is to place text in the lower right corner of a button. This is what I have so far. I have the text aligned to the right, but it is still in the middle of the button. How can I align it with the bottom as well?

```
.button{
  height: 50px;
  width: 50px;
  text-align: right;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:32:45.663

像这样的东西：http: [//jsfiddle.net/QavgZ/](http://jsfiddle.net/QavgZ/)

html:

```
<a class="button">text</a> 
```

CSS：

```
.button{
  height: 14px;
  width: 50px;
  text-align: right;
  display: block;
  border: 1px solid red;
  font-size: 14px;
  line-height: 14px;
  padding-top: 36px;
} 
```

您已经找到了正确的对齐方式。对于底部对齐，我将按钮、文本和字体大小的高度都设置为相同的值。然后我添加了顶部填充以使高度再次变为所需的 50 像素（实际高度 = 高度+填充）。

# c# - Edit cell event getting cell value and position

> ID：14388262
> 
> 赞同：0
> 
> 时间：2013-01-17T21:14:52.043
> 
> 标签：c#, .net, wpf, datagrid

In my Datagrid I allow users to edit some cells, after editing these cells I would like to commit the changes to the database (on enter). I am having troubles finding resources online to get this going.

I use an event called:

CellEditEnding but the event only provides me with the Row and Col how of the changed cell. How do I use these to find the cell itself and get the value?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T21:20:03.117

您可以使用此[链接中的此功能](http://techiethings.blogspot.com/2010/05/get-wpf-datagrid-row-and-cell.html)

```
public static DataGridCell GetCell(this DataGrid grid, DataGridRow row, int column)
{
    if (row != null)
    {
        DataGridCellsPresenter presenter = GetVisualChild<DataGridCellsPresenter>(row);

        if (presenter == null)
        {
            grid.ScrollIntoView(row, grid.Columns[column]);
            presenter = GetVisualChild<DataGridCellsPresenter>(row);
        }

        DataGridCell cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(column);
        return cell;
    }
    return null;
} 
```

并从您的事件处理程序中调用它：

```
object cellvalue = DataGridCell(yourgrid, e.Row, e.Column.DisplayIndex).GetValue; 
```

这个函数也在函数内部被`GetCell()`调用

```
public static T GetVisualChild<T>(Visual parent) where T : Visual
        {
            T child = default(T);
            int numVisuals = VisualTreeHelper.GetChildrenCount(parent);
            for (int i = 0; i < numVisuals; i++)
            {
                Visual v = (Visual)VisualTreeHelper.GetChild(parent, i);
                child = v as T;
                if (child == null)
                {
                    child = GetVisualChild<T>(v);
                }
                if (child != null)
                {
                    break;
                }
            }
            return child;
        } 
```

# ruby - Is a global variable defined inside a Sinatra route shared between requests?

> ID：14388263
> 
> 赞同：6
> 
> 时间：2013-01-17T21:14:53.367
> 
> 标签：ruby, routing, sinatra

Say I've got:

```
get '/' do
 $random = Random.rand()
 response.body = $random
end 
```

If I have thousands of requests per second coming to /, will the $random be shared and 'leak' outside the context or will it act like a 'local' variable to the get block?

I imagine if it was defined outside of the context of `get '/' do` it would indeed be shared but I wonder if there's a mechanic to $ in ruby that I'm not aware of.

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-20T01:19:12.897

[Sinatra 自述文件中关于范围的这一部分总是有助于阅读](http://www.sinatrarb.com/intro#Application/Class%20Scope)，但如果您只需要变量来为请求保留，那么我认为有 3 种主要方法我建议解决这个问题，真正的关键是一个[过滤器](http://www.sinatrarb.com/intro#Filters)

### 一个前块

```
before do
  @my_log = []
end

get "/" do
  @my_log << "hello"
  @my_log << "world"
  @my_log.inspect
end

get "/something-else" do
  @my_log << "is visible here too"
end

# => output is ["hello", "world"] 
```

`@my_log`将在请求结束时超出范围，并在下一个开始时重新初始化。它可以通过任何路线访问，因此，例如，如果您曾经`pass`将其传递到另一条路线，那将是其他块唯一可以看到先前路线块设置的内容的时间。

### 使用设置助手

```
set :mylog, [] 
```

然后与上面相同，只需替换`@my_log`为`settings.my_log`. 如果没有`before`重新初始化它的块，那么它的内容`@my_log`将在请求之间保持不变。

### 将设置助手与 Redis 之类的东西一起使用

```
# I always do this within a config block as then it's only initialised once
config do
  uri = URI.parse(ENV["URL_TO_REDIS"])
  set :redis, Redis.new(:host => uri.host, :port => uri.port, :password => uri.password)
end 
```

现在 redis 实例可以通过`settings.redis`. 无需担心变量范围（我会使用本地变量），只需直接推送到 Redis。那么，您将获得两全其美，但如果您愿意，您可以这样做：

```
before do
  @my_log = []
end

get "/" do
  @my_log << "hello"
  @my_log << "world"
  "Hello, World"
end

after do
  settings.redis.set "some_key", @my_log
  settings.redis.expire "some_key", 600 # or whatever
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T22:24:41.717

除了一些非常具体的例外（例如正则表达式匹配相关的全局变量）之外，全局与进程中的所有内容共享 - 没有范围。

# c# - How to use Microsoft Live Connect with multple users in wp7 app

> ID：14388265
> 
> 赞同：1
> 
> 时间：2013-01-17T21:15:02.067
> 
> 标签：c#, windows-phone-7, live-connect-sdk

I'm upgrading my wp7 app to allow profiles so that more than one person can use it. In the profile options you can create a basic account or use a Windows Live account. As I understand the live connect sdk, if I use the scope with offline access then the SignIn button saves the info so that the user doesn't have to keep logging in and giving their consent. This works great for one user but when I have multiple windows live users I have to sign the previous user out. By doing this the next user then has to go through the login process again.

Is there anyway I can set my app so that when any persons clicks their profile they login to their live account without going through the login process again? Maybe somehow save the session or something for each user?

# jquery - jQuery email onclick with email title

> ID：14388266
> 
> 赞同：0
> 
> 时间：2013-01-17T21:15:06.063
> 
> 标签：jquery, email

with jquery how would you set up div so that when you click on it, it takes the content of a child div, opens up a new e-mail and makes that contents the title of the e-mail.

Below is the div structure, and below that is the javascript I started, but I just have no idea how to do the email part.

```
<div class="additional_item_container">
    <div class="additional_item_name">Carlo De March, Venezia, c. 1953</div>
</div>

$(".instrument_container").click(function () {
    var email_title = $(this).find(".additional_item_name");

)}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:17:36.227

像这样的东西会起作用......

```
$(".additional_item_container").click(function () {
    var email_title = $(this).find(".additional_item_name").html();
    window.location.href = "mailto:address@gmail.com?subject=" + email_title;
}); 
```

# vba - 根据 VBA 中的可变单元格范围设置图表源数据

> ID：14388270
> 
> 赞同：6
> 
> 时间：2013-01-17T21:15:15.627
> 
> 标签：vba, excel, charts

我正在创建一个报告模板，其中一部分将生成具有类似于移动平均线的结构的数据图表

为此，我需要在一张表中选择一系列数据（例如`f10:i14`）并将其放置并设置为一个图表的来源

以下代码有效

`ActiveChart.SetSourceData Source:=Sheets("Weekly Trends").Range("f10,i14")`

但这并不

`ActiveChart.SetSourceData Source:=Sheets("Weekly Trends").Range(Cells(x, y), Cells(k, z))`

它返回一个`1004 error`

但是为了我的报告目的，我需要根据变量索引指定范围，请帮助

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-17T22:00:17.883

您必须完全限定`.Cells`对象

试试这个

`ActiveChart.SetSourceData Source:=Sheets("Weekly Trends").Range(Sheets("Weekly Trends").Cells(x, y), Sheets("Weekly Trends").Cells(k, Z))`

您也可以使上面的代码简短

```
With Sheets("Weekly Trends")
    ActiveChart.SetSourceData Source:=.Range(.Cells(x, y), .Cells(k, Z))
End With 
```

# macros - Timer for a delayed macro on a Logitech G110 keyboard with Lua

> ID：14388271
> 
> 赞同：1
> 
> 时间：2013-01-17T21:15:15.873
> 
> 标签：macros, timer, lua, delay

So I've got my first macro capable keyboard (Logitech G110), and would like to utilize it for my gaming. However, my education in programming ended halfway through C programming. I am looking for help with a very simple script, that sets a timer for a delayed macro, i.e. I press a button, and after N seconds it plays a macro. Here's what I've got:

```
function OnEvent(event, arg)

    if(event == "G_PRESSED" and arg == 6) then
        Sleep(360000);
        PlayMacro("Dragon");
    end

    if(event == "G_PRESSED" and arg == 5) then
       Sleep(300000);
       PlayMacro("Buff");
    end

    if(event == "G_PRESSED" and arg == 12) then
       Sleep(420000);
       PlayMacro(Nashor);
    end

    if(event == "G_PRESSED" and arg == 10) then
       Sleep(300000);
       PlayMacro(FlashHeal);
    end

    if(event == "G_PRESSED" and arg == 4) then
       Sleep(210000);
       PlayMacro(IgniteExhaust);
    end

end 
```

The problem is that it seems to not sleep for the desired amount of time, and seems to be firing at random. If I start more than one timer, the script just completely collapses and randomly fires until I restart my computer.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-19T20:23:15.663

所以这根本行不通，因为 LUA 不能同时进行多个操作。它将逐行运行代码。如果按下按钮，脚本将等待 N 秒，然后运行宏。然而，在这 N 秒内，它对任何其他输入完全没有响应。如果您按下更多按钮，它们将只是一个接一个地排队。因此，如果您紧接着按下两个按钮，脚本将等待 N 秒，然后执行宏，然后等待 N 秒，然后执行宏。没有（简单的）方法可以在 LUA 本身中获得您想要的东西，但是由于您使用 Logitech 游戏软件（我想），您可能只想在 lua 之外的宏本身中添加暂停。这确实有效。

# javascript - 使用 highcharts pie 扫描动画

> ID：14388279
> 
> 赞同：2
> 
> 时间：2013-01-17T21:15:37.047
> 
> 标签：javascript, animation, highcharts, pie-chart, css-animations

我正在尝试将数据更新动画化为使用 Highcharts 构建的饼图。

这是我一起破解的演示，显示了我正在尝试制作的动画的非常粗略的版本：http: [//jsfiddle.net/HsspB/](http://jsfiddle.net/HsspB/)

hack 使用 setInterval 实现动画：

```
 var iTimer = setInterval(step, 25);
    function step() {
        iCurrent = Math.min(iCurrent+3, iFinal);
        tChart.series[0].setData(
            [
                { 'y': iCurrent, 'color': '#f2b000', 'name': null },
                { 'y': 100-iCurrent, 'color': '#fae09e', 'name': null }
            ],
            true
        );
        if(iCurrent === iFinal) clearInterval(iTimer);
    } 
```

我没有使用那个确切代码的原因是它显然是一个 hack，而且似乎 Highcharts 必须已经通过它的 API 使这成为可能，只要我知道如何表达它。

hack 完全是程序性的（而不是声明性的），这意味着我必须实际计算并在数学上对这些步骤进行建模，而不是指定持续时间、转换类型和缓动函数。

我想知道这是否是 Highcharts 提供的东西（大概是通过 chart.animation 属性），以及我如何去实现它。如果没有明确的支持，我会对有关如何推出自己的方法的建议感兴趣，包括 Highcharts API 的其他相关部分是否比依赖完整的数据更新更适合这种工作（即系列.setData())。嘿——如果我可以通过 CSS 动画来做到这一点，那我也很酷。

（考虑后备时，我使用的是 jQuery 1.8.3 和核心 jQueryUI 1.8.6）

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T15:11:31.890

在已经存在的点上使用[Point.update](http://api.highcharts.com/highcharts#Point.update%28%29)方法更有效。使用此方法仅更新点，而不是删除所有点并在之后设置它。

话虽如此，我将您的代码示例修改为
函数 step() {

```
 iCurrent = Math.min(iCurrent + 3, iFinal);
    y = tChart.series[0].data[1].y;
    tChart.series[0].data[1].update(y + 3, true, {
        duration: 1500,
        easing: 'swing'
    });
    console.log(tChart.series[0].data[1]);

    if (iCurrent === iFinal) clearInterval(iTimer);
} 
```

另请参阅工作示例[http://highcharts.com/jsbin/utifem/7/edit](http://highcharts.com/jsbin/utifem/7/edit)

# c++ - 在源文件中包含类而不是标题

> ID：14388281
> 
> 赞同：0
> 
> 时间：2013-01-17T21:15:40.807
> 
> 标签：c++

我有 3 节课：

类A.h

```
ClassA
{
    public:
        ClassA();
}; 
```

B类.h

```
#include "ClassA.h"

classB
{
    public:
        ClassB();

    private:
        ClassA m_classA;
}; 
```

类C.h

```
#include "ClassB.h"

ClassC
{
    public:
        ClassC();

    private:
        ClassB m_classB;
}; 
```

ClassC 需要 ClassB，ClassB 需要 ClassA。ClassC 不需要 ClassA，所以我应该将 ClassB 标头中的 #include "ClassA.h" 放在源文件中并创建一个全局对象还是有更好的方法？

B类.cpp

```
#include "ClassB.h"
#include "ClassA.h"

ClassA g_classA; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:18:41.270

`ClassB`有一个`ClassA`对象，所以它的类声明需要完整的声明`ClassA`。所以你需要在^*`ClassA.h`中包含标题，不管.`ClassB.h`^(`ClassC`)

如果您想避免包含标题，您可以做的是存储一个（智能）指针`classA`并转发声明它。那么你只需要包含`classA.h`在`classB.cpp`. 这是一个简单的例子：

在 `A.h`

```
class A {}; 
```

在`B.h`

```
#include <unique_ptr>

class A; // forward declaration of A

class B {
 public:
  B();
 private:
  std::unique_ptr<A> a_; // C++11 smart pointer expressing unique ownership
}; 
```

在`B.cpp`

```
#include "B.h"
#include "A.h" // we need the full declaration here.

B::B() : a_(new A()) {} 
```

^(* 严格来说，`ClassA.h`可以包含在其他文件中，只要它间接包含在`ClassB.h`. 但最好在需要的地方包含您需要的内容，而不是依赖于间接包含。)

# html - 错误空链接 - 可访问性 - 如何解决这个问题？

> ID：14388283
> 
> 赞同：0
> 
> 时间：2013-01-17T21:15:45.377
> 
> 标签：html, accessibility

我试图让一个网站可以访问，它说“错误 - 空链接”我想知道如何解决这个问题。这是显示问题的链接 [http://wave.webaim.org/report?url=http%3A%2F%2Fwww.poirier-m.com%2FWCCPMobileTesting%2F6ideas.html&js=2](http://wave.webaim.org/report?url=http%3A%2F%2Fwww.poirier-m.com%2FWCCPMobileTesting%2F6ideas.html&js=2)

没有得到空链接错误的代码示例会很好。

# java - 解析文本文件 Java

> ID：14388284
> 
> 赞同：-1
> 
> 时间：2013-01-17T21:15:45.723
> 
> 标签：java, io, text-files

我需要编写一个可以接受文件路径或文件目录的java程序。浏览这些文件，并将文本文件解析为较小的文件并将它们放在一个文件夹中。

例如文件名“abc”

它应该输出一个名为 xyz 的文件夹，其中包含 abc 文件。

abc1.y abc2.y。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:29:29.913

这可能是硬件，所以我只想给你一个很好的起点。首先，您应该查看**File**类，并且您很可能想要使用**getName** () 方法。然后将所有文件名存储到一个数组中并排序。或者您可以在将它们放入数组时对其进行排序

# php - 如何在外部 javascript 代码中使用 php 变量？

> ID：14388286
> 
> 赞同：0
> 
> 时间：2013-01-17T21:15:48.680
> 
> 标签：php, javascript, jquery

通常，当我需要在 javascript 代码中使用一些 php 时，我会像这样将代码放入头部：

```
<script>
    $(function() {

    $("input#datepicker").val('<?php echo $date ?>');
});
</script> 
```

这样，我可以在 javascript 代码中使用一些 php 变量。它工作正常。

如果我想将所有 javascript 代码放在外部 js 文件中，你知道该怎么做：

```
<script type="text/javascript" src="js/admin.js"></script> 
```

也许这根本不重要。但我习惯在外部 js 文件中编码，我想知道是否可以这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T21:18:51.097

您需要将 js 文件设为 php 文件。

```
<script type="text/javascript" src="js/admin.php"></script> 
```

如果您仍想保留 js 扩展名，则需要对您的网络服务器进行重写。

**js/admin.php**

```
<?php
header("content-type: text/javascript");
?>
$(function() {
    $("input#datepicker").val('<?php echo $date ?>');
}); 
```

如果你想要这里的 js 扩展是一个示例重写。

**Nginx**

```
rewrite /js/admin.js /js/admin.php; 
```

**阿帕奇**

```
RewriteEngine On
RewriteBase /
rewrite /js/admin.js /js/admin.php; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:23:46.590

最好将您的 js 缓存到客户端浏览器中，然后将变量发送到客户端。如果您将所有 js 作为新响应提供。考虑带宽和对 Web 服务器的另一个请求。

```
<script type="text/javascript" src="js/admin.js"></script>
<script type="text/javascript">
    var myVar = <?php echo json_encode($myVar); ?>;

    myAdminFunction(myVar);
</script> 
```

# algorithm - 如何在加权（无向）图中找到两个节点之间长度为 X 的路径

> ID：14388287
> 
> 赞同：1
> 
> 时间：2013-01-17T21:15:49.460
> 
> 标签：algorithm, math, graph, map, routing

给定一个图，如何在图中的两个节点之间找到长度为 X 的路径。理想情况下，路径应该不超过一次访问边缘。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:20:45.867

您可以实现修改后的 BFS 算法。一旦你找到从 A 到 B 的第一条路径，你就有了这条路径的最小长度，所以如果 X 小于这个值，你就已经知道现在有路径了。

如果 X 大于此值，请按以下方式进行：遍历刚刚找到的从 A 到 B 的路径，并用它到 B 的距离来注释每个节点。

然后，继续您的 BFS 搜索，直到您覆盖整个图表。

每次你的搜索到达一个已经使用过的节点时，你可以查看它是否通向 B，如果是，离它有多远。这可以让你知道刚刚找到的新路径的长度，并且可以与 X 进行比较。

再次，用它与 B 的距离来注释此路径中的每个节点。您应该允许对节点进行多次注释，并且一旦您遇到通向 B 的已使用节点，请使用所述节点的所有注释值进行比较。

每当您遇到长度大于 X 的路径时，您都可以停止搜索。

# sql - 从第二个表中选择具有条件的用户

> ID：14388288
> 
> 赞同：1
> 
> 时间：2013-01-17T21:15:58.863
> 
> 标签：sql

我只想选择提交了个人资料图片的用户。我有两张桌子，`users`和`users_info`。

该`users`表包含有关用户的基本信息 ![在此处输入图像描述](../Images/3d5660c79beb02ef0dc846ead388341a.png)

该`users_info`表包含除基本信息外使用的信息 ![在此处输入图像描述](../Images/5173f180cb5c035b19207704784c21a7.png)

我将能够使用 PHP 来获取一堆用户，并且只使用那些有图像的用户，但我更喜欢使用单个查询来做到这一点。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:17:48.267

这应该这样做：

```
SELECT u.id
FROM users as u
INNER JOIN users_info as ui
ON u.id = ui.user_id
WHERE profile_image is not null 
```

如果您不熟悉联接，我建议您阅读[这篇文章](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。这是我发现的最好的向人们介绍这个概念的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:19:59.537

```
select t1.*, t2.*
from users t1 
inner join users_info t2 on t1.id = t2.id
where t2.profile_image is not null 
```

-- 请注意，如果每个用户信息记录都有个人资料图像，则不需要 where 子句。

# asp.net - 多语言网站随机更改语言

> ID：14388289
> 
> 赞同：4
> 
> 时间：2013-01-17T21:15:59.153
> 
> 标签：asp.net, .net, globalization

我开始注意到一些奇怪的事情。我根据用户浏览器语言使用标准的 Asp.net App_GlobalResources 到服务器站点（.Net 4），并且有 5 种不同的语言。大多数时候它工作正常。但有时（我怀疑负载过重）默认语言会随机更改为其中一种可用的语言

Web.config 是：

```
<globalization culture="auto:en-GB" uiCulture="auto:en-GB" /> 
```

有人经历过吗？

更新：看起来它从按字母顺序排序的语言资源列表中选择了第一种语言资源

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T14:15:30.760

在 web.config 中试试这个

```
<globalization enableClientBasedCulture="true" culture="en-GB" uiCulture="en-GB" 
requestEncoding="windows-1256" responseEncoding="windows-1256" 
fileEncoding="windows-1256"/> 
```

在这里[ASP.NET Localization: Working with Multi-Language Web Applications](http://www.devproconnections.com/content1/topic/multi-language-app-142880/catpath/aspnet2)

# javascript - 如何在 JavaScript 中获取数组循环的前一个和下一个元素？

> ID：14388291
> 
> 赞同：33
> 
> 时间：2013-01-17T21:16:06.287
> 
> 标签：javascript, arrays, loops

在 Javacript 的简单数组循环中

```
for (var i=0; i<array.length; i++) {

var previous=array[i-1];
var current=array[i];
var next=array[i+1];

} 
```

我需要在无限循环中获取`previous`and元素。`next`例如，

```
The previous element of the first element in the array is the array last element
The next element of the last element in the array is the array first element 
```

什么是最有效的方法来做到这一点。我能想到的唯一方法是在每一轮中检查元素是数组中的第一个还是最后一个。

事实上，我希望以某种方式使数组成为一个封闭的循环，而不是线性的。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-01-17T21:18:41.957

使用[模数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators)：

```
var len = array.length;

var current = array[i];
var previous = array[(i+len-1)%len];
var next = array[(i+1)%len]; 
```

注意`+len`获取上一个时：我们需要这个的原因是为了避免负索引，因为模数的工作方式（非常不幸的`-x%`是`-(x%)`）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-01-17T21:22:58.013

当您在谈论“无限循环”时，我假设您的循环是这样的

```
var i = 0,
    l = array.length;

while( true ) // keep looping
{
    if(i >= l) i = 0;

    // the loop block

    if(/* something to cause the loop to end */) break; // <-- this let execution exit the loop immediately

    i+=1;
} 
```

* * *

实现目标最有效的方法是天真的方法**：****检查**

```
 var previous=array[i==0?array.length-1:i-1];
    var current=array[i];
    var next=array[i==array.length-1?0:i+1]; 
```

显然将数组的长度缓存在一个变量中

```
var l = array.length; 
```

和（更好的风格）循环中的“vars”

```
var previuos,
    current,
    next; 
```

* * *

请注意，如果您正在访问**只读**数组，则会有一种更快（但有些奇怪）的方式：

```
l = array.length;
array[-1] = array[l-1]; // this is legal
array[l] = array[0];

for(i = 0; i < l; i++)
{
    previous = array[i-1];
    current = array[i];
    next = array[i+1];
}

// restore the array

array.pop(); 
array[-1] = null; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-05-30T15:40:24.207

添加到@Denys 答案 - 这就是创建可重用函数的方法

```
var theArray = [0, 1, 2, 3, 4, 5];
var currentIndex = 0;

function getAtIndex(i) {
    if (i === 0) {
        return theArray[currentIndex];
    } else if (i < 0) {
        return theArray[(currentIndex + theArray.length + i) % theArray.length];
    } else if (i > 0) {
        return theArray[(currentIndex + i) % theArray.length];
    }
}

// usage
getAtIndex(-2)

// you can even go crazy and it still works
getAtIndex(500) 
```

[演示 jsfiddle](https://jsfiddle.net/sidonaldson/xL9349jq/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-05-31T07:41:45.687

你需要减少；一个内置的甜蜜函数来获取数组的上一个和下一个值

```
[0, 1, 2, 3, 4].reduce(function(previousValue, currentValue, currentIndex, array) {
  return previousValue + currentValue;
}); 
```

有关**[减少的更多信息](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce)**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-06-05T20:09:31.007

为了简单。

对于数组中的下一个元素：

```
 currentIndex= (currentIndex+1)%array.length; 
```

对于数组中的前一个元素：

```
currentIndex= (currentIndex+array.length-1)%array.length; 
```

# css - Div 仅在 Google Chrome 中正确显示（赢）

> ID：14388293
> 
> 赞同：0
> 
> 时间：2013-01-17T21:16:12.773
> 
> 标签：css

我被一个让我发疯的问题困住了。我正在开发一个网站，该网站在与主导航相同的 div 中有一个框。它一直显示到右侧（栏的宽度为 100%），我需要它显示在带有主导航的 div 中（宽度为 1020px）

我正在更改 div 的结构，但它只会在 Chrome (win) 中正确显示。我还测试了 Safari (win)、Chrome (mac) 和 Safari (win)。

这是我所拥有的：

HTML

```
<div id="navigation" class="gb_ff clearfix">
    <div id="main_navigation" class="container hor_navigation clearfix">
        <?php wp_nav_menu( array( 'sort_column' => 'menu_order', 'theme_location' => 'header', 'depth' =>'2', 'container' => 'none' ) ); ?>        
        <?php if ( !is_user_logged_in() ): ?>

        <div id="nav_subscription" class="subscription_form clearfix"> <span id="subscribe_dd" class="contrast">
            <?php gb_e( 'Get the Latest Deals' ) ?>
            </span>
        </div><!-- #main_navigation -->

        <div id="subscription_form_wrap" style="display:none;">
            <div class="optinbar_close" style="bottom: 202px; left: -10px;"></div>
            <p class="fillout2">Γράψε το όνομα και το email σου και κλίκαρε 'Στείλτε το δώρο μου'. </p>
            <!-- Begin MailChimp Signup Form -->
            <!--End mc_embed_signup-->
        </div>
    </div><!-- #header_subscription.subscription_form -->
    <?php endif ?>
</div><!-- #navigation --> 
```

CSS

```
#navigation, #main_navigation li a {
    width: 100%;
    color: #999999;
}

#navigation {
    margin: 0 auto;
    padding: 0;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
    border-bottom: 0;
    -webkit-border-bottom-right-radius: 0;
    -webkit-border-bottom-left-radius: 0;
    -moz-border-radius-bottomright: 0;
    -moz-border-radius-bottomleft: 0;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
    position: relative;
    z-index: 50;
    font-size: .9em;
    background: url(http://deals.karditsa.topgreekgyms.gr/wp-content/themes/gbs-merchant-dashboard/img/menu_gradient.png) repeat-x center bottom;
}

#main_navigation {
    height: auto;
    width: 1020px;
    position: relative;
    z-index: 1;
    margin: 0 auto;
}

#subscription_form_wrap {
    -webkit-border-bottom-right-radius: 0;
    -webkit-border-bottom-left-radius: 0;
    -moz-border-radius-bottomright: 0;
    -moz-border-radius-bottomleft: 0;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
    background: none;
    background-color: #FFFFFF;
    padding: 0;
    float: left;
    position: absolute;
    top: 46px;
    right: 0;
    height: auto;
    min-width: 200px;
    border: 1px solid #CCC;
    font-size: 13px;
}

#subscribe_dd {
    color: #FFFFFF;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    line-height: 31px;
    background-color: #999999;
    width: 255px;
    height: 31px;
    white-space: nowrap;
    padding: 10px 20px 5px;
    text-shadow: rgba(0, 0, 0, 0.5) 0 1px;
    position: absolute;
    top: 0;
    right: 0;
    -moz-border-radius-bottomright: 0;
    -webkit-border-bottom-right-radius: 0;
    border-bottom-right-radius: 0;
    z-index: 10;
    border-bottom: 1px solid #CCC;
    border-bottom: 1px solid rgba(255, 255, 255, .2);    
} 
```

我正在研究 WordPress。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:22:45.140

您可能首先将“获取最新详细信息”框实际放入 id 为 的 div 中`main_mavigation`。现在它位于 id 为“navigation”的 div 中，并且绝对定位为 right=0，因此它显然会一直向右移动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:26:12.180

将 #main_navigation 移动到 #navigation 中，以便前者包含在后者中：

```
<div class="container gb_ff clearfix" id="navigation">
    <div id="main_navigation" class="hor_navigation clearfix"> ... </div>
    <ul id="menu-navigation-menu" class="menu">
        ...
    </ul>
</div><!-- #navigation --> 
```

然后，您可以删除 right 和 top CSS 语句并更改为：

```
#main_navigation {position: relative; display: block;} 
```

这可以在其他方面简化页面布局。

# sql - 工会的秩序是否都得到保证

> ID：14388295
> 
> 赞同：3
> 
> 时间：2013-01-17T21:16:14.530
> 
> 标签：sql, sql-order-by, union-all

是否保证联合所有查询的两个部分的顺序将按特定顺序给出？即这个查询的结果：

```
select 'foo' from dual
union all
select 'bar' from dual 
```

将一直是

```
foo
bar 
```

而不是这个

```
bar
foo 
```

?

我使用了 Oracle 语法，但我想知道 ISO 标准对此有何规定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:31:44.390

在您的特定示例中，顺序不应更改，因为您正在查询`DUAL`表，并且您不必担心该特定查询的潜在索引更改。所以你总是会分别得到 Foo 然后 Bar 。

然而，在现实世界中，是的，顺序肯定会改变——取决于几个因素，例如表索引、返回的列、引入的新数据等。所以如果你希望你的结果以特定的方式排序，你需要指定`ORDER BY`子句。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:55:13.523

建议重写您的查询：

```
SELECT txt FROM (
select 1 as sort, 'foo' as txt from dual
union all
select 2 as sort, 'bar' as txt from dual
) product
ORDER BY sort 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T22:14:31.383

ISO 标准说表格本质上是无序的。它还说，当您从查询返回行时，*不能*保证顺序，除非您使用`order by`子句。

实际上，在*这种*情况下，大多数数据库将在 bar 之前返回 foo。但是，如果您更改`union all`为`union`，某些数据库可能会首先返回该条。

更糟糕的是，您甚至不能说第一个查询中的所有行都将在第二个查询之前返回。例如，在并行环境中，来自所有两个表的联合的结果集可以混合行。

如果您首先想要 foo，然后添加`order by txt desc`或其他内容。

# postgresql - persistence.xml 和 postgresql 设置 0 == false

> ID：14388298
> 
> 赞同：0
> 
> 时间：2013-01-17T21:16:33.117
> 
> 标签：postgresql, persistence, persistence.xml

我们将应用程序从 oracle 迁移到 postgresql。我们遇到了问题，因为许多问题使用 0 作为假。现在我们有很多错误：

```
operator does not exist: integer = boolean 
```

它可以使用 persistence.xml 中的设置并定义 0 = false 的 postgresql ???

PS 我使用 glassfish v3 和 toplink 作为 JPA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T09:40:16.273

问题是 Oracle 没有真正的 bool 类型，但 PostgreSQL 有。因此：

```
SELECT true = '1'; 
```

返回 '​​t' 为真

```
SELECT true = 1; 
```

产生您遇到的错误。如果您可以更改持久性以与引用（即未知）类型进行比较，那将解决问题。

如果你不能这样做，你可以创建一个自定义运算符：

```
CREATE OR REPLACE FUNCTION comp_bool(bool, int) RETURNS bool LANGUAGE SQL AS
$$
SELECT $1 = $2::bool;
$$;

CREATE OR REPLACE FUNCTION comp_bool(int, bool) RETURNS bool LANGUAGE SQL AS
$$
SELECT $1::bool = $2;
$$;

CREATE OPERATOR = (
    procedure = comp_bool,
    leftarg = bool,
    rightarg = int,
    commutator = =
);

CREATE OPERATOR = (
    procedure = comp_bool,
    leftarg = int,
    rightarg = bool,
    commutator = =
); 
```

然后

```
SELECT true = 1; 
```

作品.....

# youtube-api - youtube 是否删除了本机控件？

> ID：14388301
> 
> 赞同：0
> 
> 时间：2013-01-17T21:16:45.070
> 
> 标签：youtube-api

我只是检查为客户端构建的视频播放器，发现 youtube 播放器中不再存在本机控件，这是真的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:27:16.050

看来 YouTube 已经推出了自己的 chrome。目前它似乎不支持回滚到以前的 API 版本。伤心。

# javascript - Backbone Boilerplate 条件注释

> ID：14388303
> 
> 赞同：3
> 
> 时间：2013-01-17T21:17:04.820
> 
> 标签：javascript, backbone.js, gruntjs, backbone-boilerplate

有人能告诉我Backbone Boilerplate（https://github.com/tbranyen/backbone-boilerplate/blob/master/index.html）的index.html中条件注释的重要性吗？

```
<!--(if target dummy)><!--> <link rel="stylesheet" href="/app/styles/index.css"> <!--<!(endif)-->

<!--(if target release)> <link rel="stylesheet" href="index.css"> <!(endif)-->

<!--(if target debug)> <link rel="stylesheet" href="index.css"> <!(endif)-->

<!--(if target dummy)><!-->    <script data-main="/app/config" src="/vendor/js/libs/require.js"></script>    <!--<!(endif)-->

<!--(if target release)>    <script src="require.js"></script>    <!(endif)-->

<!--(if target debug)>    <script src="require.js"></script>    <!(endif)--> 
```

在构建不同版本时，它们是否与 Grunt 相关？

谢谢..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:25:00.783

看起来您假设这些是 Grunt 构建目标是正确的。使用 grunt 构建时，它必须具有不同的设置，例如 debug、dummy 和 release。

[https://github.com/changer/grunt-targethtml](https://github.com/changer/grunt-targethtml)

我通过搜索找到的链接示例。它也有条件评论以及一些信息。然后它在 gruntfile.js 中：

```
// Configuration to be run (and then tested).
targethtml: {
  dev: {
    files: {
      'tmp/dev.html': 'test/fixtures/index.html'
    }
  },
  dist: {
    files: {
      'tmp/dist.html': 'test/fixtures/index.html'
    }
  }
},... 
```

它使用 dev 和 dist 作为条件。

Backbone Boilerplate 定义了调试和发布（虚拟似乎被排除在外）：

[https://github.com/tbranyen/backbone-boilerplate/blob/master/grunt.js#L131](https://github.com/tbranyen/backbone-boilerplate/blob/master/grunt.js#L131)

# python - 在 Python 中散列一个顺序很重要的元组？

> ID：14388306
> 
> 赞同：6
> 
> 时间：2013-01-17T21:17:34.810
> 
> 标签：python

我有：

```
tuple1 = token1, token2
tuple2 = token2, token1
for tuple in [tuple1, tuple2]:
    if tuple in dict:
        dict[tuple] += 1
    else:
        dict[tuple] = 1 
```

但是，元组 1 和元组 2 的计数相同。有什么方法可以散列一组 2 个事物以使顺序很重要？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-17T21:18:41.893

散列时考虑顺序：

```
>>> hash((1,2))
1299869600
>>> hash((2,1))
1499606158 
```

这假设对象本身具有唯一的哈希值。即使他们不这样做，在字典中使用它时仍然可以（只要对象本身不等于他们的`__eq__`方法定义的）：

```
>>> t1 = 'a',hash('a') 
>>> [hash(x) for x in t1]  #both elements in the tuple have same hash value since `int` hash to themselves in cpython
[-468864544, -468864544]
>>> t2 = hash('a'),'a'
>>> hash(t1)
1486610051
>>> hash(t2)
1486610051
>>> d = {t1:1,t2:2}  #This is OK.  dict's don't fail when there is a hash collision
>>> d
{('a', -468864544): 1, (-468864544, 'a'): 2}
>>> d[t1]+=7
>>> d[t1]
8
>>> d[t1]+=7
>>> d[t1]
15
>>> d[t2]   #didn't touch d[t2] as expected.
2 
```

请注意，由于哈希冲突，此字典的效率可能低于另一个没有哈希冲突的字典 :)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-17T21:19:04.867

它们获得相同计数的原因是您的代码同时显式递增`token1,token2`和`token2,token1`计数。如果你不这样做，计数将不会保持同步：

```
In [16]: import collections

In [17]: d = collections.defaultdict(int)

In [18]: d[1,2] += 1

In [19]: d[1,2]
Out[19]: 1

In [20]: d[2,1]
Out[20]: 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T21:25:23.180

好像您已经发布了一个循环体的实例。我是否可以建议您使用 [`collections.Counter`](http://docs.python.org/2/library/collections.html#collections.Counter)您正在尝试做的事情，这正是您想要的，但在一行中：

```
counter = (collections.Counter(myListOfTuples) + 
           collections.Counter([j,i for i,j in myListOfTuples])) 
```

# java - 提取 EXI 压缩的 XML 时出现编码问题

> ID：14388309
> 
> 赞同：1
> 
> 时间：2013-01-17T21:17:43.507
> 
> 标签：java, groovy, exi, exificient

下面的代码试图简化使用[EXIficient执行 EXI 压缩和解压缩所需的设置](http://exificient.sourceforge.net/)

```
class ExiCompressionUtils {
    static Transformer transformer = TransformerFactory.newInstance().newTransformer()

    static byte[] compress(String xml) {
        ByteArrayOutputStream exiOS = new ByteArrayOutputStream()
        EXIResult exiResult = new EXIResult(outputStream : exiOS)

        XMLReader xmlReader = XMLReaderFactory.createXMLReader()
        xmlReader.contentHandler = exiResult.handler
        xmlReader.parse(new InputSource(new StringReader(xml)))

        def compressed = exiOS.toByteArray()
        exiOS.close()
        return compressed
    }

    static String extract(byte[] compressed) {
        SAXSource exiSource = new SAXSource(new InputSource(new ByteArrayInputStream(compressed)))
        exiSource.setXMLReader(exiSource.reader)

        ByteArrayOutputStream exiOS = new ByteArrayOutputStream()
        transformer.transform(exiSource, new StreamResult(exiOS))  // fails here
        def extracted = exiOS.toString()
        exiOS.close()
        return compressed
    }
} 
```

下面的测试失败了`ERROR: 'Invalid byte 1 of 1-byte UTF-8 sequence.'`

```
@Test
void testExiCompression() {
    def xml = '<Root><Child id="1">Text</Child><EmptyTag/></Root>'
    def compressed = ExiCompressionUtils.compress(xml)
    assert ExiCompressionUtils.extract(compressed) == xml
} 
```

那里有任何编码专家可以深入了解这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-04T06:52:34.043

今天我为这个评论而挣扎。这段代码有一个重要问题（除了 Java 缺少分号等奇怪的语法）

阅读时使用 EXISource 而不是 SAXSource！

附上一段有效的代码。

——丹尼尔

```
static Transformer transformer;

static {
    try {
        transformer = TransformerFactory.newInstance().newTransformer();
    } catch (TransformerConfigurationException e) {
    } catch (TransformerFactoryConfigurationError e) {
    }
}

static byte[] compress(String xml) throws IOException, EXIException,
        SAXException {
    ByteArrayOutputStream exiOS = new ByteArrayOutputStream();
    EXIResult exiResult = new EXIResult();
    exiResult.setOutputStream(exiOS);

    XMLReader xmlReader = XMLReaderFactory.createXMLReader();
    xmlReader.setContentHandler(exiResult.getHandler());
    xmlReader.parse(new InputSource(new StringReader(xml)));

    byte[] compressed = exiOS.toByteArray();
    exiOS.close();

    return compressed;
}

static String extract(byte[] compressed) throws TransformerException,
        IOException, EXIException {
    // SAXSource exiSource = new SAXSource(new InputSource(new
    // ByteArrayInputStream(compressed))); // use EXISource instead!
    SAXSource exiSource = new EXISource();
    exiSource.setInputSource(new InputSource(new ByteArrayInputStream(
            compressed)));

    ByteArrayOutputStream exiOS = new ByteArrayOutputStream();
    transformer.transform(exiSource, new StreamResult(exiOS));
    String extracted = exiOS.toString();
    exiOS.close();
    return extracted;
}

public static void main(String[] args) throws IOException, EXIException,
        SAXException, TransformerException {
    String xml = "<Root><Child id=\"1\">Text</Child><EmptyTag/></Root>";
    byte[] compressed = ExiCompressionUtils.compress(xml);
    System.out.println(ExiCompressionUtils.extract(compressed));
} 
```

# debugging - wro4j -- 如何在调试模式下禁用聚合功能？

> ID：14388311
> 
> 赞同：5
> 
> 时间：2013-01-17T21:17:48.240
> 
> 标签：debugging, wro4j

我正在使用通配符来加载我的 javascript 和 css 文件，并且效果很好，但是在开发阶段使用聚合的 javascript 文件很痛苦。有没有办法让 wro4j 不聚合文件，而只是单独包含它们？

***我的`wro.xml`档案***

```
<groups xmlns="http://www.isdc.ro/wro">
 <group name="external">
    <js>/app/lib/*.js</js>
 </group>

 <group name="application">
    <js>/js/*.js</js>
    <css>/css/normalize.css</css>
    <css>/css/*.css</css>
 </group>
</groups> 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T09:16:21.197

在开发模式下有一个技巧可以实现这一点（`debug=true`）。有一个端点（`/wro/wroAPI/model`- 如果您将 WroFilter 映射到 ，则这是有效的`/wro/*`），它返回模型的 JSON 表示。使用此 JSON，您可以通过迭代组条目轻松地为给定组插入脚本和/或 css 链接。默认情况下还没有这样的小部件可用，但是如果您创建一个并想要贡献它 - 欢迎您:)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T18:08:19.477

感谢您的输入，亚历克斯。

我创建了一个使用您上面提供的信息的 ServletFilter。我把它贴在这里以供后代使用。注意：这不是理想的代码（例如缓存太多），它只是为了让人们了解实现的样子。我的实现使用 Spring`DelegatingFilterProxy`来告诉代码需要担心哪些组。就创建插件而言，您能否为我指出一些实现文档的方法，我在那方面很模糊？

```
public class WroDebugFilter implements Filter
{
    //http loader is shamelessly stolen from another project.
    SimpleHttpLoader httpLoader = new SimpleHttpLoader();

    private List<String> jscriptFiles;
    private List<String> debugGroups;

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        //To change body of implemented methods use File | Settings | File Templates.
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {

        request.setAttribute("jscriptFiles",getJavaScriptFiles((HttpServletRequest) request));

        chain.doFilter(request,response);
    }

    private List<String> getJavaScriptFiles(HttpServletRequest request) {

        if (jscriptFiles == null) {

            List<String> cssFiles = new ArrayList<String>();
            List<String> jsFiles = new ArrayList<String>();

            JsonParser jsonParser = new JsonParser();

            String url = httpLoader.httpGet(getApiUrl(request));

            JsonObject data = jsonParser.parse(url).getAsJsonObject();
            JsonArray groups = data.getAsJsonArray("groups");

            for (JsonElement group : groups) {

                JsonObject groupObject = group.getAsJsonObject();

                String groupName = groupObject.get("name").getAsString();

                if (debugGroups.contains(groupName)) {

                    JsonArray resources = groupObject.getAsJsonArray("resources");

                    for (JsonElement resource : resources) {
                        JsonObject resourceObject = resource.getAsJsonObject();
                        String uri = resourceObject.get("uri").getAsString();

                        if (uri.contains(".css")) {
                            cssFiles.add("\t<link rel=\"stylesheet\" href=\"" + request.getContextPath() + uri +"\">");
                        }
                        else {
                            jsFiles.add("<script type=\"text/javascript\" src=\"" + request.getContextPath() + uri + "\"></script>");
                        }
                    }
                }

            }
            cssFiles.addAll(jsFiles);
            jscriptFiles = cssFiles;
        }

        return jscriptFiles;
    }

    private String getApiUrl(HttpServletRequest request) {

        String serverName = request.getServerName();
        String contextPath = request.getContextPath();
        int port = request.getServerPort();

        return String.format("http://%s:%s%s/%s",serverName,port,contextPath,"wro/wroAPI/model");
    }

    @Override
    public void destroy() {
        //To change body of implemented methods use File | Settings | File Templates.
    }

    public List<String> getDebugGroups() {
        return debugGroups;
    }

    public void setDebugGroups(List<String> debugGroups) {
        this.debugGroups = debugGroups;
    }
} 
```

**`wro.xml`档案_**

```
<groups xmlns="http://www.isdc.ro/wro">
    <group name="external">
        <js>/app/lib/*.js</js>
    </group>

    <group name="application">
        <js>/js/*.js</js>
        <css>/css/normalize.css</css>
        <css>/css/*.css</css>
    </group>
</groups> 
```

和....

**弹簧配置**

```
 <bean id="wroDebugFilter" class="gov.mystate.dhw.idalink.web.filter.WroDebugFilter">
        <property name="debugGroups">
                <list>
                    <value>application</value>
                </list>
            </property>
    </bean> 
```

# php - 如何使用 PHP 检测浏览器大小

> ID：14388321
> 
> 赞同：0
> 
> 时间：2013-01-17T21:18:17.433
> 
> 标签：php, jquery, wordpress, mobile

我有一个看起来像这样的 Wordpress header.php 页面......

```
<?php if( is_home() || is_front_page() ) : ?>
<img src="<?php bloginfo('template_directory'); ?>/images/logo.png" alt="logo"
width="206" height="136" border="0" class="logo" />

<?php else : ?>

<img src="<?php bloginfo('template_directory'); ?>/images/logo_inner.png"
alt="logo" width="187" height="130" border="0" class="logo" />

<?php endif; ?> 
```

因此，当当前页面不是主页时，将使用不同的徽标。

我想知道是否可以在“if”部分添加一些代码来检测浏览器大小，因为我想在移动设备上使用不同的徽标。我知道你可以使用 Jquery 来做到这一点，例如

```
if ((screen.width<=420)) {
 //do something
}
else {
//do something else
} 
```

我尝试使用 Detect Mobile 脚本 - [http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)希望替换徽标，但 php 代码会覆盖 jQuery 代码。

```
if(jQuery.browser.mobile==true){ 
   jQuery('.logo').attr('src','.../images/mobile_logo.png');
} else { 
   jQuery('.logo').attr('src','../images/logo.png'); } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:22:42.280

这不是您应该在服务器端解决的问题。这是一个 CSS 问题。在样式表中包含以下内容：

```
@media all and (max-width: 699px) {
  /* mobile styles here */
} 
```

查看[这篇文章](http://css-tricks.com/css-media-queries/)以获取有关媒体查询的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-23T16:07:45.587

如果您只想使用不同的徽标，那么 css 方法可能就足够了。

但是，如果您想使用 PHP（或 Java 或 .NET）来了解服务器上设备的性质，以便为不同的设备提供不同的标记（或 js 或 css 文件），那么您可能想要看看 WURFL，无线通用资源文件。我一直在玩它。我认为它无法正确显示屏幕尺寸或方向，但它绝对可以识别我拥有的设备（iPhone、nexus7 和 kindle）：

[Sourceforge.net 上的 WURFL](http://wurfl.sourceforge.net/wurfl.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-30T02:01:34.800

如果您想要两全其美，您可以使用带有 Javascript 的 WURFL 来显示和隐藏图像。

这是一个例子：

```
<script type='text/javascript' src="//wurfl.io/wurfl.js"></script>

if(WURFL.is_mobile){
    jQuery('.logo').attr('src','.../images/mobile_logo.png');
} else {
    jQuery('.logo').attr('src','../images/logo.png');
} 
```

这是 ScientiaMobile (WURFL) 提供的云服务，它进行服务器端检测并返回带有设备信息的 JSON 对象。如果您愿意，可以在[http://wurfl.io/](http://wurfl.io/)获得更多他们的文档。

如果您只担心图像的大小，您还可以使用他们的图像调整器，它将调整图像的大小以最适合正在加载它的设备（取决于您如何配置它）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T21:22:22.897

使用 jQuery，它可能会像这样工作：

```
$(function(){
    var width = $(window).width();
    if (width < 599) {
        // change your image.
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-28T13:16:46.780

为什么不让 php 生成一个小徽标/占位符，然后根据您的浏览器大小使用 javascript 加载更大的版本。你甚至可以为 jQuery ( [http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload) ) 使用类似lazyload 的东西。您可以根据需要将其设置为高级，例如添加调整大小检测，这样人们在调整页面大小时就不必重新加载页面。

# android - 将带有附加功能的意图发送到我的另一个应用程序并发回响应

> ID：14388328
> 
> 赞同：0
> 
> 时间：2013-01-17T21:18:28.613
> 
> 标签：android, android-intent

如果我有两个应用程序，A 和 B。应用程序 A 是主应用程序，应该能够向 B 发送请求，该请求应该发回一些信息。

我无法弄清楚执行此操作的需要意图，也无法找到示例或教程来说明如何使用我的两个应用程序执行此操作。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:23:27.420

您需要在应用 B 中声明一个可以接收 Intent 的活动、服务或广播接收器。在 B 的清单中声明意图过滤器。然后A可以使用意图[`startActivityForResult()`](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)来请求信息；它将（异步）接收信息[`onActivityResult()`](http://developer.android.com/reference/android/app/Activity.html#onActivityResult%28int,%20int,%20android.content.Intent%29)。这在指南主题[Intents 和 Intent Filters](http://developer.android.com/guide/components/intents-filters.html)中进行了讨论。记事本[示例应用程序](http://developer.android.com/resources/samples/NotePad/index.html)展示了如何使用此技术。

# c# - 可以使用 IntelliSense 打印出类结构吗？

> ID：14388331
> 
> 赞同：0
> 
> 时间：2013-01-17T21:18:41.417
> 
> 标签：c#, visual-studio-2010, intellisense

我经常得到没有文档的课程。

为了让它们工作，我依靠 Visual Studio 的*IntelliSense*：我输入项目，点击“点” `.`，然后将显示的方法、参数和返回类型转移到一张纸上。

我想把这个过程从铁器时代转移到 1990 年代。

我注意到有人问过类似的问题，但他的问题是针对 Java 的，因此该解决方案不适用。这里供参考：

[如何使用 javap 工具在 jar 文件中打印类结构？](https://stackoverflow.com/q/1171549/153923)

我想迭代（以某种方式）各种类，将这些类的名称打印到 StringBuilder，然后解析为每个类的所有方法，将方法签名打印到 StringBuilder 类。

![我想做的事情的截图](../Images/e952d4c5056ce44e0711bddfc707fe38.png)

有谁知道实现这一目标的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:22:35.453

查看 ilspy - [http://ilspy.net/](http://ilspy.net/)

有了它，您可以浏览库 (.dll) 并获得所需的内容。您也可以通过双击解决方案资源管理器中的 DLL（如果它在您的 /bin/ 中，只需单击“显示所有文件”按钮）在 Visual Studio 中执行此操作。尝试两者并使用具有最佳结构的一个。

# powershell - 用管道替换 foreach

> ID：14388334
> 
> 赞同：2
> 
> 时间：2013-01-17T21:18:45.273
> 
> 标签：powershell

好的，假设我在目录树中有一堆文本文件，它们都具有相同的名称，我想将它们全部连接到一个文件中。

我让它与 foreach 一起工作，但我想知道是否有更好的方法来使用管道。

有一个更好的方法吗？

代码：

```
dir -filter users.txt -recurse | foreach { get-content $_.FullName | add-content .\All.txt } 
```

这行得通，但我觉得我应该能够在没有 foreach 的情况下做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T21:23:37.043

如果您阅读帮助，`Get-Content`您将看到`-Path`接受 string[] 数组，这意味着您可以尝试将 Get-ChildItem 的输出直接通过管道输入。

```
[22:24:57] PS-ADMIN> get-help Get-Content

NAME
    Get-Content

SYNOPSIS
    Gets the contents of a file.

SYNTAX
    Get-Content [-Path] <String[]> [-Credential <PSCredential>] ...... 
```

所以试试这个：

```
Get-ChildItem -Filter users.txt -Recurse | Get-Content | Set-Content .\all.txt 
```

编辑：实际上：在研究更多之后，我发现它是从 FileInfo 对象`-LiteralPath`中获取`PSPath`属性并将其用作路径。尽管如此，同样的逻辑:-)

# jsf - JSF2 - 停止同一字段的多个验证错误（即只能有一个）

> ID：14388335
> 
> 赞同：1
> 
> 时间：2013-01-17T21:18:48.380
> 
> 标签：jsf, jsf-2

鉴于 facelet 中的这个片段：

```
 <h:messages layout="table"></h:messages>
    <br /><br />
    First Name: 
    <h:inputText styleClass="inputText" id="firstName" validatorMessage="#{msg['error.userEdit.firstName']}">
        <f:validateRequired></f:validateRequired>
        <f:validateLength maximum="50"></f:validateLength>
        <f:validateRegex pattern="^[A-Za-z]+$"></f:validateRegex>
    </h:inputText> 
```

当验证在表单上运行时，我会打印出 0-3 条相同的消息，具体取决于该字段有多少验证规则失败。您如何将其限制为每个字段的单个消息？

为清楚起见，我的错误消息包含 3 个错误，并显示“名字是必需的，不能超过 50 个字符，并且只能是字母字符。”，所以这就是为什么我只希望它打印一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:41:46.190

使用`<h:message>`而不是`<h:messages>`. 这样只会显示第一个。

```
<h:message for="firstName" /> 
```

是的，这种方法需要您`<h:message>`为每个单独的输入字段指定 a 而不是单个`<h:messages>`. 没有其他标准方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-02T13:48:52.137

应该可以通过一个正则表达式设置此字段

你需要使用这个

```
< f:validateRegex pattern="[A-Za-z]{0,50}" > 
```

# ruby-on-rails - 变量如何在 Rails MVC 应用程序中协同工作

> ID：14388342
> 
> 赞同：1
> 
> 时间：2013-01-17T21:19:19.153
> 
> 标签：ruby-on-rails

我正在阅读 RailsTutorial，它是这样的：在我们添加的 routes.rb 文件中：

```
resources   :users 
```

*   然后在我们正在使用的 app/views/users/show.html.erb 文件中`@user`
*   然后在 app/controllers/users_controller.rb 我们仍然可以使用`@user`
*   然后在 app/views/users/show.html.erb 再次我们可以使用`@user`

那么这些不是都在不同的文件夹和类中吗？所以@user 是公开的？他们如何看待和合作？因为我对 Rails 没有深入的了解，所以这一切对我来说都像是魔法。如果有人能对正在发生的事情的内部情况有所了解，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:22:24.847

请求首先触及您的 routes.rb 文件，该文件会将请求定向到适当的控制器操作。

前任。example.com/users/new 将转到 UsersController 新操作

新操作将定义实例变量，然后您可以在相应视图（用户文件夹中的 new.html.erb）中访问这些变量。

resource :users 是创建 CRUD 路由的 Rails 快捷方式 (http://guides.rubyonrails.org/routing.html#resources-on-the-web)

每个控制器操作很可能会为 @user 实例变量分配不同的分配。阅读这个例子，[http://www.tutorialspoint.com/ruby-on-rails/rails-controllers.html](http://www.tutorialspoint.com/ruby-on-rails/rails-controllers.html)

更多好读物： http: [//www.devarticles.com/c/a/Ruby-on-Rails/Rails-Action-Controller/1/](http://www.devarticles.com/c/a/Ruby-on-Rails/Rails-Action-Controller/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:24:54.470

您问题中的用户并不完全相同：

*   在 routes.rb 中，users 不是 @users / @user 变量，而是一个名为 :users 的符号。它可以是其他任何东西，:something, :anything 等等。它只是“resources”方法的一个参数，它根据传递给它的名称创建路由。因此，如果您编写“resources :whatever”，那么 rails 将为名为 WhatController 的类生成默认路由 - 如果存在，它将起作用
*   show.html 是一个视图。它可以使用在它的控制器/动作（即 users_controller）中声明的任何成员变量。但它不是全局的，如果你有两个控制器，它们只能使用自己的变量。更重要的是，一个控制器中的两个不同的动作（方法）不能使用彼此的变量，因为它们当时没有被声明。
*   在 users_controller.rb 中，您实际上声明了视图中使用的 @users 变量

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T21:25:07.700

@ 表示实例变量。变量的范围定义了可以在何处以及如何访问它。一般来说，您最好了解变量及其各种类型。看看这个：[http](http://ruby.runpaint.org/variables) ://ruby.runpaint.org/variables 。

# oop - 在 SOLID 中，SRP 和 ISP 有什么区别？（单一职责原则和接口隔离原则）

> ID：14388358
> 
> 赞同：64
> 
> 时间：2013-01-17T21:20:32.593
> 
> 标签：oop, design-patterns, solid-principles, single-responsibility-principle, interface-segregation-principle

[SOLID](http://en.wikipedia.org/wiki/Solid_(object-oriented_design)) “接口隔离原则”与“单一职责原则”有何不同？

[SOLID](http://en.wikipedia.org/wiki/Interface_segregation_principle)的维基百科条目说

> ISP 将非常大的接口拆分为更小、更具体的接口，以便客户端只需了解他们感兴趣的方法

然而，对我来说，这听起来就像只是将 SRP 应用于接口和类。毕竟，如果一个接口只负责一个概念上的事情，那么您将无法进一步分解它。

我错过了什么，还是 ISP 与 SRP 有点多余？如果不是，那么 ISP 暗示 SRP 没有什么？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-17T21:24:12.210

SRP 告诉我们，您应该在一个模块中只承担单一职责。

ISP 告诉我们，您不应该被迫面对超出您实际需要的东西。如果您想使用`print()`interface 中的方法`I`，则不必为此实例化 a`SwimmingPool`或`DriveThru`类。

更具体地说，直截了当，它们是对同一想法的不同看法——SRP 更关注设计者的观点，而 ISP 更关注客户端的观点. 所以你基本上是对的。

这一切都来自

> ISP 最初是由 Robert C. Martin 在为 Xerox 做一些咨询时使用和制定的。施乐创建了一个新的打印机系统，可以执行各种任务，例如装订一组打印的文件和传真。该系统的软件是从头开始创建并成功执行其任务的。随着软件的发展，修改变得越来越困难，以至于即使是最小的更改也需要重新部署周期到一个小时。这使得继续开发几乎不可能。设计问题是几乎所有任务都使用一个主要的 Job 类。每当必须完成打印作业或装订作业时，都会调用 Job 类中的某个方法。这导致了一个巨大的或“胖”类，其中包含多种特定于各种不同客户端的方法。

所以

> Martin 提出的解决方案就是今天所谓的接口隔离原则。应用于 Xerox 软件，使用依赖倒置原则在 Job 类与其所有客户端之间添加了一层接口。没有一个大的 Job 类，而是创建了 Staple Job 接口或 Print Job 接口，分别由 Staple 或 Print 类使用，调用 Job 类的方法。因此，为每个作业创建了一个接口，这些接口都是由 Job 类实现的。

@ [http://en.wikipedia.org/wiki/Interface_segregation_principle#Origin](http://en.wikipedia.org/wiki/Interface_segregation_principle#Origin)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-01-17T21:39:02.847

SRP 关注模块做什么以及如何完成，不允许任何抽象级别的混合。基本上，只要一个组件可以用一个句子广泛定义，它就不会破坏 SRP。

另一方面，ISP 关心应该如何使用模块，是否只使用模块的一部分，而忽略某些方面是否有意义。

保持精神或 SRP 但可以破坏 ISP 的代码示例是外观模式。它有一个单一的职责，“提供对更大子系统的简化访问”，但如果底层子系统需要公开截然不同的想法，它确实会破坏 ISP。

也就是说，通常当一段代码破坏了 SOLID 原则时，它通常会破坏整个代码。打破特定原则而保留其余原则的具体例子在野外很少见。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-03-09T01:06:44.603

罗伯特·马丁于 2018 年 5 月 16 日发布了以下[推文。](https://twitter.com/unclebobmartin/status/996739060348653568)

> 对于接口，ISP 可以看作类似于 SRP；但不仅如此。ISP 概括为：“不要依赖于你需要的东西。” SRP 概括为“将因相同原因在同一时间发生变化的事物聚集在一起。”</p>
> 
> 想象一个同时具有 push 和 pop 的堆栈类。想象一个只会推送的客户端。如果该客户端依赖于堆栈接口，它依赖于它不需要的 pop。SRP 不会将 push 与 pop 分开；ISP 会。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-12-18T10:50:02.517

SRP 和 ISP 最终归结为相同的事情。实现它们中的任何一个都需要拆分类或接口。

但是，在其他方面存在差异。

1.  违反 SRP 会对整个设计结构产生深远的影响，导致可维护性、重用性差，当然内聚和耦合度低。
2.  SRP 对对象结构的行为和结构组件都有影响。

3.  重新设计 SRP 违规需要更深入的分析，需要以整体方式查看设计的不同组件。

违反 ISP 主要是因为可读性差（在某种程度上，内聚度低）。但是对维护和代码重用的影响远没有 SRP 那样险恶。

此外，将代码重构为 ISP 构造，似乎只是一种结构上的改变。

另请参阅我的博客以了解[SRP](http://design-principle-pattern.blogspot.in/2013/12/single-responsibility-principle.html)和[ISP](http://design-principle-pattern.blogspot.in/2013/12/interface-segregation-principle.html)

# html - 条件注释不适用于 IE-9

> ID：14388361
> 
> 赞同：0
> 
> 时间：2013-01-17T21:20:39.823
> 
> 标签：html, internet-explorer, internet-explorer-9, conditional-statements

我有一个页面，我需要根据 IE 的版本显示帮助文本。我决定按照[这个博客](http://www.paulhammond.org/2008/10/conditional/)使用条件评论。我的html页面看起来像这样......

```
<!DOCTYPE html>
<html>
   <head>
        <title>Application Title</title>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    </head>
  <!--[if lt IE 9 ]><body style="margin: 0px;" class="ie9lt"><![endif]-->
  <!--[if IE]> <body style="margin: 0px;" class="ie9"> <![endif]-->
  <!--[if (gt IE 10)|!(IE)]>-->
  <body style="margin: 0px;"><!--<![endif]-->
        <div id="id1">
        ....
        ....
</html> 
```

我已经在 IE 9 上打开了这个文件，但是通过检查元素选项检查了 html，但是我的 body 元素没有与之关联的 ie9 类（就此而言没有类）。我在这里错过了什么吗？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:31:36.447

我已经用 IE9 检查了你的 HTML，它工作得很好。我可以看到`body`有`ie9`课。

你能在下面的 HTML 检查器中看到相同的内容吗？另外，您的*浏览器模式*是否设置为 IE9？

![IE9](../Images/f05b5102e5bffa1fac823bda3612a738.png)

有时，当您的 HTML 文档中有错误时，IE 会自动切换到*Compatibility View*模式，然后您的`body`类是`ie9lt`（而不是`ie9`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-27T13:00:17.883

您可以尝试更具体地处理根 HTML 标记：

```
<!doctype html>
<!--[if IE 7 ]><html lang="en" class="ie7"><![endif]-->
<!--[if IE 8 ]><html lang="en" class="ie8"><![endif]-->
<!--[if IE 9 ]><html lang="en" class="ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]--> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T21:26:27.060

我只会在这些评论中添加样式定义，仅此而已。让 html 文档尽可能保持干净。这可能是该黑客​​最混乱的实现之一。

# java - 如何防止 GUI 在 Java 中重叠

> ID：14388363
> 
> 赞同：1
> 
> 时间：2013-01-17T21:20:45.463
> 
> 标签：java, eclipse, swing, user-interface, jbutton

我正在尝试使用 Eclipse 创建 Java 7 通讯簿，当我测试运行 JFrame 时，JLabels 不可见并且 JButtons 重叠。（按钮将占据整个 JFrame）例如

```
add(saveButton);
add(cancelButton);

add(headingLabel);

headingLabel.setVisible(true);

cancelButton.setLocation(200,200);
saveButton.setLocation(400,200);

cancelButton.setSize(200,50);
saveButton.setSize(200,50); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-17T21:22:26.327

您应该使用 LayoutManager 而不是绝对坐标。使用布局管理器，您不必太在意 GUI 元素的确切位置。布局已为您完成。

查看[布局管理器的视觉指南。](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)它通过视觉和代码示例解释了最常见的布局类型。

# jquery - 移动 Safari $(window).height() URL 栏差异

> ID：14388367
> 
> 赞同：13
> 
> 时间：2013-01-17T21:20:58.003
> 
> 标签：jquery, mobile, safari, height

我正在尝试设置一个固定的 div，它是窗口高度的 100%。但移动 Safari 无法检测到正确的窗口高度。它始终认为 URL 栏是等式的一部分。

这是我目前正在使用的，但它不考虑 URL 栏。

```
$(function(){
    $(document).ready(function(){ // On load
        alert($.browser);   
        $('#right-sidebar').css({'height':(($(window).height()))+'px'});
    });
    $(window).resize(function(){ // On resize
        $('#right-sidebar').css({'height':(($(window).height()))+'px'});
    });
}); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-07-27T14:14:36.320

**Tldr**

如果您只想查询窗口高度、跨浏览器并完成它，请使用[jQuery.documentSize](https://github.com/hashchange/jquery.documentsize)并调用[`$.windowHeight()`](https://github.com/hashchange/jquery.documentsize#window-size). 要实施您自己的解决方案，请继续阅读。

**何时使用 jQuery 或`clientHeight`文档的**

jQuery`$(window).height()`是`document.documentElement.clientHeight`. 它为您提供视口的高度，不包括浏览器滚动条覆盖的空间。一般来说，它运行良好并且享有近乎通用的浏览器支持。但是在移动设备上存在一些[怪癖，尤其是在 iOS 中](https://github.com/hashchange/jquery.documentsize#window-size-1)。

*   在 iOS 中，返回值假装 URL 和标签栏是可见的，即使它们不可见。一旦用户滚动并且浏览器切换到最小 UI，它们就会被隐藏。窗口高度在这个过程中增加了大约 60px，这并**没有**反映在`clientHeight`（或在 jQuery 中）。

*   `clientHeight`返回布局视口的大小，[而不是视觉视口](http://www.quirksmode.org/mobile/viewports2.html)，因此不反映缩放状态。

所以......在移动设备上不太好。

**何时使用`window.innerHeight`**

您可以查询另一个属性：`window.innerHeight`. 它

*   返回窗口高度，
*   基于视觉视口，即反映缩放状态，
*   当浏览器进入最小 UI（移动 Safari）时更新，
*   **但**它包括滚动条覆盖的区域。

最后一点意味着你不能只是把它作为替代品。此外，它在 IE8 中不受支持，并且在FF25 （2013 年 10 月）[之前的 Firefox 中被破坏。](https://developer.mozilla.org/en-US/docs/Web/API/Window/innerWidth#Standards_information)

但它可以用作移动设备的替代品，因为移动浏览器将滚动条显示为临时覆盖，不会占用视口中的空间 -`window.innerHeight`并`d.dE.clientHeight`在这方面返回相同的值。

**跨浏览器解决方案**

因此，用于找出真实窗口高度的跨浏览器解决方案的工作方式如下（伪代码）：

```
IF the size of browser scroll bars is 0 (overlay)
  RETURN window.innerHeight
ELSE
  RETURN document.documentElement.clientHeight 
```

这里的问题是如何确定给定浏览器的滚动条的大小（宽度）。您需要对其进行测试。这并不是特别困难 -如果您愿意，请查看[我的实现](https://github.com/hashchange/jquery.documentsize/blob/f6572e4c9f2d54e3d6139d4798f05d7c63fa909a/src/jquery.documentsize.js#L74-98)或[Ben Alman 的原始实现。](http://benalman.com/projects/jquery-misc-plugins/#scrollbarwidth)

如果你不想自己动手，你也可以使用我的一个组件 - [jQuery.documentSize](https://github.com/hashchange/jquery.documentsize) - 并通过[`$.windowHeight()`call](https://github.com/hashchange/jquery.documentsize#window-size)完成。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-03-24T20:36:43.907

这是由于 jQuery 的 .height() 方法中的一个错误。

要获得正确的高度，您可以使用：

```
$('#right-sidebar').height(window.innerHeight); 
```

为确保您*主要*与跨浏览器兼容，您可以执行以下操作：

```
var height = window.innerHeight ? window.innerHeight : $(window).height();
$('#right-sidebar').height(height); 
```

我说的主要是因为如果有底部滚动条，这将开始变得有趣。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T00:16:44.157

我是这样想的。它是一个两步过程。

第 1 步 - 检查设备是 iPhone 还是 iPod。

第 2 步 - 如果是，则检查浏览器是否为 safari

```
// On document ready set the div height to window
$(document).ready(function(){ 

    // Assign a variable for the application being used
    var nVer = navigator.appVersion;
    // Assign a variable for the device being used
    var nAgt = navigator.userAgent;
    var nameOffset,verOffset,ix;

    // First check to see if the platform is an iPhone or iPod
    if(navigator.platform == 'iPhone' || navigator.platform == 'iPod'){
        // In Safari, the true version is after "Safari" 
        if ((verOffset=nAgt.indexOf('Safari'))!=-1) {
          // Set a variable to use later
          var mobileSafari = 'Safari';
        }
    }

    // If is mobile Safari set window height +60
    if (mobileSafari == 'Safari') { 
        // Height + 60px
        $('#right-sidebar').css('height',(($(window).height()) + 60)+'px');
    } else {
        // Else use the default window height
        $('#right-sidebar, .profile').css({'height':(($(window).height()))+'px'});  
    };

});

// On window resize run through the sizing again
$(window).resize(function(){
    // If is mobile Safari set window height +60
    if (mobileSafari == 'Safari') { 
        // Height + 60px
        $('#right-sidebar').css('height',(($(window).height()) + 60)+'px');
    } else {
        // Else use the default window height
        $('#right-sidebar, .profile').css({'height':(($(window).height()))+'px'});  
    };
}); 
```

然后在需要执行移动 Safari 特定代码时使用 mobileSafari 变量。

首先从设备开始排除 iPad 和台式机等也可以运行 Safari。然后第二步排除了可能在这些设备上运行的 Chrome 和其他浏览器。

这是我为什么这样做的更深入的细分 - [http://www.ethanhackett.com/?blog=window-height-100-on-mobile-safari-coding-solution](http://www.ethanhackett.com/?blog=window-height-100-on-mobile-safari-coding-solution)

# ios - iOS Twitter 网站单点登录

> ID：14388368
> 
> 赞同：0
> 
> 时间：2013-01-17T21:20:58.440
> 
> 标签：ios, twitter, uiwebview, twitter-oauth

假设您有一个 iOS 应用程序，并且用户在其设备上设置了一个或多个 Twitter 帐户。是否可以将 Twitter 移动网站的一部分加载到`UIWebView`应用程序*中，用户自动登录*为这些帐户之一？

显然，访问帐户需要用户的许可，这很好。并且可能在第一次之后，网站无论如何都会记住用户。但是最好不要强迫用户再次输入他们的凭据。

我知道我可以使用[Reverse Auth](https://dev.twitter.com/docs/ios/using-reverse-auth)来获取 iOS Twitter 帐户的 OAuth 令牌，但我还没有找到任何具体的东西可以让我在 twitter.com 上交换这些令牌以进行身份​​验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T17:02:30.583

好吧，根据[Twitter 的 Taylor Singletary 的](https://dev.twitter.com/discussions/14247)说法，这是不可能的。嘘。

# sql-server - 删除唯一索引并将相同的字段设置为主键

> ID：14388373
> 
> 赞同：0
> 
> 时间：2013-01-17T21:21:34.293
> 
> 标签：sql-server, indexing, composite-primary-key

我有一个 5GB，有 3 列作为唯一（非聚集）索引。我想将这三个提升为新的主键（集群）。我应该在更改 PK 之前删除此索引吗？

另外，我计划在更改 PK 后删除此索引。

这三个字段的类型是

```
field1: int
field2: int
field3: char(7) 
```

**更新：** 将提升一词更改为删除和设置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:23:24.103

您不能将现有索引提升为主键（或其他任何内容）*。*

您必须先**删除**唯一索引，**然后**在这三列上创建一个新的主键约束（这将自动创建主键索引）

# jquery - Facebook“喜欢”按钮未显示在某些内容上

> ID：14388375
> 
> 赞同：0
> 
> 时间：2013-01-17T21:21:51.080
> 
> 标签：jquery, facebook, button, facebook-like

我对 Javascript 和 JQuery 非常陌生，但能够在网上找到一些名为“有机标签”（[http://css-tricks.com/organic-tabs/](http://css-tricks.com/organic-tabs/)）的东西并合并到我正在处理的页面中，这本质上是产品画廊。你可以看到我在这里做了什么：

[http://www.fat-hair.com/wildfire_products.html](http://www.fat-hair.com/wildfire_products.html)

问题是，我的客户希望每个产品上都出现一个 facebook“喜欢”按钮以及一个 pinterest“pin it”按钮。由于某种原因，JQuery 与 facebook like 按钮冲突，默认产品除外。我已经制作了一个没有 JQuery 的页面版本，并确认没有它，FB 按钮会按应有的方式显示。**注意：此问题仅在 Firefox 和 IE 中出现**。在 Chrome 和 Safari 中似乎还不错。

[http://www.fat-hair.com/wildfire_products-trblsht.html](http://www.fat-hair.com/wildfire_products-trblsht.html)

有没有人对可能发生的事情以及如何纠正它有任何想法？作为记录，我试图遵循[这个线程](https://stackoverflow.com/questions/12946345/facebook-like-button-loaded-by-jquery-not-working)的建议，但它对我不起作用。

# bash - 在多个目录中查找和删除文件

> ID：14388376
> 
> 赞同：0
> 
> 时间：2013-01-17T21:21:53.757
> 
> 标签：bash, centos, command-line-interface

现在我有一个每周运行一次的 cron 作业，为我查找和删除在那段时间积累的文件。它是这样的：

```
find $DIR1 -maxdepth 1 \( -name \file1-\* -o -name \*file2-\* \) -mtime +7 >> /tmp/file.txt 
```

但是，我想在服务器上的另一个目录中做同样的事情（必须是 $DIR1 和 $DIR2 - 在整个系统中从根目录进行查找是不可行的）但我觉得，虽然重复该命令会起作用，这将是丑陋的、多余的和低效的。

所以，我想以某种方式构建一个列表（即 FILES="file1 file2 file3"），并采用一种简化的方法来检查两个目录，然后将找到的结果输出到上面的文本文件中。

我不确定如何做到这一点 - 我想过可能会做一个循环，但这似乎太基本了。任何人都可以在这里给我一根骨头并指出我正确的方向吗？我担心的最重要的事情是让它与 find 一起工作。

编辑：澄清一下，$DIR2 中的第二次搜索是针对超过 14 天（mtime +14）的文件，因此仅将 $DIR2 添加到现有字符串中是行不通的。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:25:01.003

你有没有试过这个：

```
find $DIR1 $DIR2 -maxdepth 1 \( -name \file1-\* -o -name \*file2-\* \) -mtime +7 >> /tmp/file.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-01T19:25:31.900

编写 bash 脚本（即 delete_files.sh）并在 crontab 中添加 bash 脚本会容易得多。所以下一次，如果你想在不同的目录中添加更多的模式，那么你只需要在 bash 脚本中编写，它就会自动添加到 cronjob 中。

```
#!/usr/bin/bash

echo $(find $DIR1 $DIR2 -maxdepth 1 \( -name \file1-\* -o -name \*file2-\* \) -mtime +7) >> /tmp/file.txt; 
```

或者

```
#!/usr/bin/bash

echo $(find $DIR1 -maxdepth 1 \( -name \file1-\* -o -name \*file2-\* \) -mtime +7) >> /tmp/file.txt;
echo $(find $DIR2 -maxdepth 1 \( -name \file1-\* -o -name \*file2-\* \) -mtime +7) >> /tmp/file.txt; 
```

# jquery - 使用 jQuery 定义和添加图像宽度

> ID：14388380
> 
> 赞同：-3
> 
> 时间：2013-01-17T21:22:22.817
> 
> 标签：jquery, tags, width, image

我正在开发一家电子商务商店，其中在 100 多个类别页面上，缩略图的大小和/或比例不同。我需要在其 div 中使用类 Thumbnail 将所有图像居中。我已经为项目添加了一个相对位置以及中心的边距。

有人可以帮我写一个快速的jquery，它将使用类缩略图添加获取每个图像的宽度并将其添加到每个img标签？

```
.thumbnail {
position: relative;
margin: 0 auto;
} 
```

也许这样的事情是一个开始。我需要在文档中搜索具有特定类的每个图像，然后获取每个图像的宽度并将其添加为 css。

```
$(document).find(".Thumbnail").css({
width: $(this).width()
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:38:12.540

将父 div 位置设置为

```
position: relative; 
```

然后设置项目

```
margin : 0 auto; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:46:23.563

我只能猜测，但据我了解，您的标记看起来像这样：

```
...

<div class='product'>
  <img src='image.jpg' class='thumbnail' />
</div>

<div class='product'>
  <img src='image2.jpg' class='thumbnail' />
</div>

... 
```

如果您现在想将缩略图宽度与父级相等，只需使用 CSS：

```
.product {
 margin: 0px;
 width: 200px; // just as an example
 height: 200px; // just as an example
 float: left; // just as an example
 margin: 0px 7px 7px 0px; // just as an example
}

.thumbnail {
 width: 100%;
} 
```

为此需要使用 jQuery 会浪费性能，但您可以这样做：

```
$(".thumbnail").each(function() {
 $(this).css({
      "width" : $(this).parent().width()+"px"
  });
}); 
```

# python - 用漂亮的汤而不是python中的机械化提取复选框输入对象的标签值

> ID：14388390
> 
> 赞同：1
> 
> 时间：2013-01-17T21:22:47.577
> 
> 标签：python, html, input, beautifulsoup, mechanize

机械化和 BeautifulSoup 的新手，我很喜欢它。

我使用 mechanize 打开 URL 的原型方式，现在我得到了返回的对象：

```
 def OpenURL(URL, USERAGENT):
        br = Browser()# Create a browser
        br.set_handle_robots(False)   # no robots
        br.set_handle_refresh(False)  # can sometimes hang without this
        br.addheaders = [('User-agent', USERAGENT)]
        #open the URL
        result = br.open(URL)# Open the login page
        return result 
```

在我返回的结果中，我有一个类型为“checkbox”的输入对象，名称为“BoxName”。复选框有一个标签。HTML 如下所示：

```
 <input type="checkbox" name="BoxName" checked="checked" disabled="disabled" />
    <label for="BoxName">DESIREDTEXT</label> 
```

我可以通过 mechanize 获得 DESIREDTEXT，如下所示：（解释代码以节省空间）

```
 if control.type == "checkbox": 
        for item in control.items:
            if(control.name == "BoxName"):
                DESIREDTEXT = str([label.text  for label in item.get_labels()]) 
```

有没有等效的方法来使用 BeautifulSoup 获取标签文本值？我很高兴使用 mechanize 来检索它，但我只是想知道 BeautifulSoup 是否也有这个能力。

****附录******

 **来自源代码的 HTML：

```
 <input id="ctl00_ContentPlaceHolder1_chkCheckedIn" type="checkbox" name="ctl00$ContentPlaceHolder1$chkCheckedIn" checked="checked" disabled="disabled" />
    <label for="ctl00_ContentPlaceHolder1_chkCheckedIn">Checked-In 1/17/2013 1:23:01 AM</label> 
```

这是 Inbox.read() 输出所有 HTML 的代码。我验证了标签在那里：

```
 soup = BeautifulSoup(Inbox.read())
print soup.find('label',{'for': 'ctl00_ContentPlaceHolder1_chkCheckedIn'}).text 
```

这是我的错误：

```
 AttributeError                            Traceback (most recent call last) 
```

/usr/local/lib/python2.7/dist-packages/IPython/utils/py3compat.pyc in execfile(fname, *where) 176 else: 177 filename = fname --> 178 **builtin** .execfile(filename, *where)

/home/ubuntu/testAffinity.py in () 133 from BeautifulSoup import BeautifulSoup 134 soup = BeautifulSoup(Inbox.read()) --> 135 print soup.find('label',{'for': 'ctl00_ContentPlaceHolder1_chkCheckedIn'}) .文本 136 137

AttributeError：“NoneType”对象没有属性“文本”

不知道我在这里缺少什么，但它必须很简单。我注意到“for”值与复选框“name”值不同。我尝试使用复选框“名称”值，但收到相同的错误。

** 升级到 bs4 后

133 from bs4 import BeautifulSoup 134 soup = BeautifulSoup(Inbox.read()) --> 135 print soup.find('label',{'for': 'ctl00_ContentPlaceHolder1_chkCheckedIn'}).text 136 137

AttributeError：“NoneType”对象没有属性“文本”

**升级到 4 后我打印了汤。属性正确。标签位于打印汤的 html 中。

```
 <input checked="checked" disabled="disabled" id="ctl00_ContentPlaceHolder1_chkCheckedIn" name="ctl00$ContentPlaceHolder1$chkCheckedIn" type="checkbox"/>
    <label for="ctl00_ContentPlaceHolder1_chkCheckedIn">Checked-In 1/17/2013 1:23:01 AM</label> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:28:27.423

是的，试一试：

```
soup.find('label',{'for':'BoxName'}).text 
```

使用您的功能，它看起来像：

```
html = OpenURL(URL, USERAGENT).read()
soup = BeautifulSoup(html)
print soup.find('label',{'for':'BoxName'}).text 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-13T09:55:45.123

嗨，您是在抓取您的页面还是其他一些陌生人页面？否则你可以在你的 html 中使用 id 并访问它。

```
tag = BeautifulSoup('<b id="boldest">bold</b>', 'html.parser').b 
tag['id']
# 'boldest' 
```

检查：[https ://www.crummy.com/software/BeautifulSoup/bs4/doc/#id13](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#id13)**

# javascript - range.setStartBefore() 在 Chrome 与 FireFox 中表现得非常奇怪。这是它应该如何工作的吗？

> ID：14388391
> 
> 赞同：1
> 
> 时间：2013-01-17T21:22:52.433
> 
> 标签：javascript, dom, webkit, range

我在[这里写了一篇文章](http://a-software-guy.com/2013/01/problems-with-range-setstartbefore/)。

基本上，我想要做的是在内容可编辑区域中选择 DIV 之前的元素。我遇到了我不理解的行为，并发现自己想知道这是否是“它应该如何工作”。

考虑以下标记：

```
<DIV contenteditable="true">foo<div id="test">bar</div></div> 
```

我想选择之前的元素`<div id="test">`。

所以我使用：

```
var sel = document.getSelection();
var range = document.createRange();
var dom_node = document.getElementById( 'test' );

// this is the critical method

range.setStartBefore( dom_node );
range.collapse( true );
sel.removeAllRanges();
sel.addRange( range );
console.log( "selection is :", document.getSelection().getRangeAt(0) ); 
```

（不幸的是，尝试这个作为 jsfiddle.net 会产生一些 jsfiddle 错误，所以我把它[放在一个静态页面上](http://miles-by-motorcycle.com/formvista/site_local/uploaded_html/range_test.html)）

我得到的范围在 FireFox 和 Chrome 之间非常不同。

Chrome 会返回一个 textnode 的 startContainer，其 startOffset 为 3，正好指向文本“foo”。这是我所期望的。光标移动到该位置。

FireFox 返回一个偏移量为 1 的可编辑 DIV 的 startContainer，指向整个文本节点。不是我所期望的。光标（如果您聚焦 div），正好指向 'bar' 的左侧。

如果将 HTML 更改为：

```
<DIV contenteditable="true"><div>foo</div><div id="test">bar</div></div> 
```

重复实验，FireFox 返回一个带有可编辑 DIV 和 startOffset 为 1 的 startContainer。光标停留在“bar”之前。鉴于上次测试的结果，这对我来说很有意义。

然而，Chrome 会返回一个 startContainer，其 textnode 的长度为 0，nextSibling previousSibling 都为 null，但 parentNode 设置为 div id=”test”。光标停留在'bar'前面。

这是正确的行为吗？当你得到这样的范围时，你应该怎么做？还是 setStartBefore()/After() 刚刚坏了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T10:18:31.497

问题在于 WebKit 在选择范围时如何规范化范围，而不是范围本身。`Range`诸如此类的基本方法`setStartBefore()`在 WebKit 和 Mozilla（实际上是 IE >= 9 和 Opera）之间始终如一地工作。

范围不仅仅存在于服务选择中，范围边界可以存在于任何类型的节点中，而不仅仅是文本节点。对于非基于文本的节点（文本节点、注释、cdata），范围边界表示为父节点内边界之前的子节点数。在所有浏览器中都是如此。只有当范围被添加到选择中时，事情才会不一致。

在 Chrome 中，您的第二个示例将插入符号放在“bar”文本节点的开头。见[http://jsfiddle.net/cRwee/](http://jsfiddle.net/cRwee/)

# javascript - 自动计算器每行

> ID：14388398
> 
> 赞同：0
> 
> 时间：2013-01-17T21:23:15.120
> 
> 标签：javascript, jquery, jstl

我想创建一个表，可以自动计算每行的每个字段的一些值。我找到了这些 jquery 计算器，我想问一下如果我将使用 jstl forEach，我将如何使用它，我该如何使用它，以便它可以自动计算用户在每一行的字段中输入的内容。 。 谢谢..

```
<html>
    <head>
       <script type="text/javascript"  src="js/jquery-latest.js"></script>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript">
                          $(document).ready(function()
                        {
                            $('input').change(function()
                            {
                                var ProductUnitVal = parseInt($('#product-unit-val').val());
                                var TotalUnitSales = parseInt($('#total-unit-sales').val());

                                var answer = ProductUnitVal * TotalUnitSales;

                                $('#sales-val').html('$' + answer);
                            });
                        });
           </script>
    </head>
    <body>       

        Unit Value <input type="text" id="product-unit-val" /><br />
        Unit Sales <input type="text" id="total-unit-sales" /><br />
        <span id="sales-val"></span>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:28:22.400

使其基于行。当输入更改时，查找找到元素范围的最近行 (tr)。然后仅在该范围（即行）中搜索各种元素。请注意，我将这 3 个项目从 id 更改为 class。

```
<table id="thetable">
<tr>
<td>
Unit Value <input type="text" class="product-unit-val" />
</td>
<td>
Unit Sales <input type="text" class="total-unit-sales" />
</td>
<td><span class="sales-val"></span></td>
</tr>
</table> 
```

然后你的脚本：

```
 $(document).ready(function()
                    {
                        $('#thetable input').change(function()
                        {
                            var $row = $(this).closest('tr');

                            var ProductUnitVal = parseInt($row.find('.product-unit-val').val());
                            var TotalUnitSales = parseInt($row.find('.total-unit-sales').val());

                            var answer = ProductUnitVal * TotalUnitSales;

                            $row.find('.sales-val').html('$' + answer);
                        });
                    }); 
```

# xml - Doctrine 2 存储库映射错误 XML

> ID：14388403
> 
> 赞同：0
> 
> 时间：2013-01-17T21:23:30.550
> 
> 标签：xml, zend-framework, doctrine, mapping, schema

我得到这个错误，我被困住了，现在已经有 2 天了，所以我希望一些好人可能有线索。

使用 Zend 1 和 Doctrine 2，为 XML 模式文件配置了原则。我使用教义控制台命令来生成实体、代理、存储库和 sql 转储。

生成一切正常，我只需要添加 xml 模式文件并开始生成。但是，当我运行应用程序时，我收到此错误：

```
Message: No mapping file found named 'Application.Models.Repository.Users.xml' for class 'Application\Models\Repository\Users'. 
```

文件结构为

```
zend
 '-application
     '-Models
        '-Entities
        '-Proxies
        '-Repository
        '-Schemas 
```

我使用的名为 Application.Models.Entities.Users.xml 的架构文件（我选择了 xml，而不是 dcm.xml）如下所示：

```
<doctrine-mapping xmlns="http://doctrine-project.org/schemas/orm/doctrine-mapping"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://doctrine-project.org/schemas/orm/doctrine-mapping
                http://doctrine-project.org/schemas/orm/doctrine-mapping.xsd">

<entity name="Application\Models\Entities\Users" table="users"
        repository-class="Application\Models\Repository\Users" >

    <id name="id" type="integer" column="id">
        <generator strategy="AUTO"/>
    </id>

    <field name="username" column="username" type="string" length="50" nullable="false" unique="true" />
    <field name="password" column="password" type="string" length="32" nullable="false" />
    <field name="role" column="role" type="string" length="50" nullable="false"  />
    <field name="created" column="created" type="datetime" nullable="false" />
    <field name="lastLogin" column="lastlogin" type="datetime" nullable="false" />

</entity>

</doctrine-mapping> 
```

有趣的是，它要求 Application.Models.Repository.Users.xml 而不是 .Entity。但是，我只是将文件重命名为 Application.Models.Repository.Users.xml，然后我收到此错误：

```
Message: Invalid mapping file 'Application.Models.Repository.Users.xml' for class 'Application\Models\Repository\Users'. 
```

我在这里想念什么？

# python - Jython - 使用 Spring，在 Python 中编程？

> ID：14388406
> 
> 赞同：3
> 
> 时间：2013-01-17T21:23:41.773
> 
> 标签：python, spring, jython

好的，我是这方面的新手。

所以，我知道 Spring 作为一个框架非常好，而且我已经用 Python 编程了一段时间，所以我想知道我是否可以使用 Spring 框架但使用 Python 中的代码。

我听说也许 Jython 是这样做的一个很好的可能性，因为它（我认为）是在 JVM 上运行的 Python，对吧？

那么，这可能吗？让我在 Python 中编码时使用 Spring？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:00:01.900

首先，您是对的，Jython 是在 JVM 中运行的 Python。它不仅在 JVM 中运行，它还可以以几乎所有你想要的方式与之交互——将 Java 类用作 Python 类，在 Python 类中实现 Java 接口并将其传递给 Java 代码等。

但是，与其他一些 JVM 语言不同，Jython 没有尝试在语义上等同于 Java（或其超集）。当然，Python 和 Java 有非常不同的惯用风格。

所以，简而言之，几乎一切皆有可能，但并非一切都是令人愉快的，正如 Marcin 所说。

有关 Spring 如何与 Jython 一起使用的详细信息，请在 Google 上进行快速搜索，[了解 Spring Python 如何与 Jython 一起使用](http://blog.springpython.webfactional.com/2009/10/15/see-how-spring-python-works-with-jython/)。事实上，它是一个名为“Spring Python”的博客的一部分，该博客也是一个名为“Spring Python”的网站的[一部分](http://springpython.webfactional.com)。看起来这可能是 Spring 到 Python 的一个端口，而不是关于将 Jython 与 Spring 一起使用。（“这个项目采用 Spring 的概念并将其应用到 Python 的语言和环境中。这包括实用的库和有用的抽象，这些库和有用的抽象可以快速让你重新开始编写能够让你赚钱的代码。”）所以，这可能是另一个替代你。

下一个搜索结果是[Jython Spring MVC Controllers](http://agreif.blogspot.com/2006/07/jython-spring-mvc-controllers.html)。

还有六个其他有希望的结果。因此，我认为您可以毫无问题地查找信息和示例。

# winapi - 寻找一种方法（最好是 API）来确定 Active Directory 对象的有效权限

> ID：14388409
> 
> 赞同：0
> 
> 时间：2013-01-17T21:23:48.513
> 
> 标签：winapi, active-directory, access-control, windows-security

我们有一个定制的 Active Directory 集成网络应用程序，可帮助用户对其帐户执行一些自助服务（例如更新照片、更改电话号码、重置密码等）。我们的应用程序在加入域的服务器上运行，作为本地系统，因此能够使用服务器帐户向 AD 进行身份验证。

我们使用服务连接点，应用程序的客户端使用它来定位我们应用程序的实例。*（我们的应用程序客户端经过硬编码以查找在服务连接点的关键字*属性上发布的某些关键字。）

我们最近遇到了一种情况，其中有人（我们相信是不小心）更改了其中一个服务连接点上的关键字导致中断，因为客户端在向 AD 查询我们的关键字时无法再找到我们的 SCP。

客户对此感到有些不安，并希望我们能够让他们确定谁可以更改我们 SCP 上的关键字。这个反馈是从我们的销售人员传递给我们的，现在我们需要提供一些方法来帮助他们找出谁可以更改我们 SCP 上的关键字。

因此，我们正在寻找一种 API 来帮助我们确定 Active Directory 服务连接点对象的有效权限，以便我们可以为客户缓解这种情况。我们找不到一个有效的权限/访问 API 可以帮助我们列出对我们的 SCP 上的关键字和其他属性具有有效写入权限的所有用户。

**是否有可用于确定 Active Directory 对象的有效权限的 API/其他方式？**

它需要能够列出对 Active Directory 对象的指定属性集具有指定访问权限的所有用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T05:15:50.720

这个[堆栈溢出帖子](https://stackoverflow.com/questions/4931982/how-can-i-check-if-a-user-has-write-rights-in-active-directory-using-c)可能会对您有所帮助。 [LINQ to LDAP](http://linqtoldap.codeplex.com/discussions/370594)还应该允许您非常轻松地访问信息。

# c++ - 为什么 C++11 仍然强制执行词法排序以提高可见性

> ID：14388410
> 
> 赞同：1
> 
> 时间：2013-01-17T21:23:51.807
> 
> 标签：c++, c++11, language-design

例如，前向声明和来自[维基百科的替代函数语法部分](http://en.wikipedia.org/wiki/C++11#Alternative_function_syntax)：

> Ret 类型是添加 Lhs 和 Rhs 类型将产生的任何内容。即使使用 [...] decltype，这也是不可能的：
> 
> ```
> template<class Lhs, class Rhs>
> decltype(lhs+rhs)  //Not legal C++11
>       adding_func(const Lhs &lhs, const Rhs &rhs) {
>   return lhs + rhs;
> } 
> ```
> 
> 这不是合法的 C++，因为 lhs 和 rhs 尚未定义；在解析器解析函数原型的其余部分之前，它们将不是有效的标识符。

当系统处于主要内存压力下时，这是可以理解的（它允许传递作为流操作完成）。但是，在这个时代（我的智能手机有足够的 RAM 来保存完整的源代码、完整的解析树，然后是一些用于任何合理文件的内存）为什么令牌的顺序很重要？语法中是否存在一些奇怪的极端情况，例如，`decltype`除非您知道其中的标识符是类型还是变量，否则无法找到非终结生产的结尾？另外一点，为什么全局/命名空间范围声明的顺序很重要？

* * *

编辑，原来这是合法的：

```
class foo {};
foo Foober(int foo) { return ::foo(); } 
```

如果我在野外遇到这种情况，它最终会出现在 The Daily WTF 上，但它仍然是合法的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T21:51:57.287

声明“这不是合法的 C++”并不十分准确。在函数声明出现的范围内定义`lhs`并定义了合法的 C++ 。`rhs`参数`lhs`和`rhs`不在外部范围内，但名称肯定有可能在其他声明的范围内；改变函数返回类型的范围可能会默默地改变以前有效程序的含义。

在 C++ 中，作用域并不总是按词法顺序排列。例如，在成员函数体内，所有成员都是可见的，即使是尚未声明的成员。（前导返回类型也不是成员函数体的一部分，但尾随返回是。）

> 语法中是否存在一些奇怪的极端情况，例如，除非您知道其中的标识符是类型还是变量，否则无法找到 decltype 非终端生产的结尾？

我不这么认为；的论点周围的括号`decltype`应该是明确的。但是，如果您不知道标识符是否是模板，那可能会以非常微妙的方式影响`<`和`>`标记`>>`的含义。并且不知道标识符是类型还是函数也会在解析表达式时产生困难（即使在 C 中也是如此）。因此，在某些极端情况下，名称的“种类”很重要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-17T22:27:34.000

这不是容量问题，而是向后兼容性问题。

该语言的新版本必须保留几乎所有旧功能以保持向后兼容性。在原始 C++ 中，成员函数返回类型不在类或函数的范围内查找。它是在函数声明的封闭范围内查找的。更改此规则对于向后兼容性可能是灾难性的。

解决它的唯一方法是专门针对`decltype`参数进行例外处理。但这将非常不一致并且容易出错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T22:29:29.620

他们必须在某处划定“内部”和“外部”范围之间的界限。正如您所提到的，当可以解析其中的标识符时，更容易找到生产的结尾。它更容易在编译器中实现，并且更容易在语言标准中一致地指定。这可能是第一个编译器这样做的原因，以及为什么语言总是需要`typename`and`template`关键字来解决模板扩展中未定义（嵌套）标识符引起的语法歧义。

并且标识符在出现在声明中之前永远不能使用，这是帮助人类或机器阅读器找到相关声明的绝妙规则。（除了类成员之间，应用了特殊的两次解析以提高便利性。）

一旦以一种方式完成，就做出了承诺，并且语言不能改变。除了添加一个特性之外，这就是 C++11 解决问题的方式。

```
template<class Lhs, class Rhs>
  auto adding_func(const Lhs &lhs, const Rhs &rhs) -> decltype(lhs+rhs)
    {return lhs + rhs;} 
```

顺便说一句，他们没有提到另一种解决方法：

```
template<class Lhs, class Rhs>
  decltype( declval< Lhs >() + declval< Rhs >() )
    adding_func(const Lhs &lhs, const Rhs &rhs) {return lhs + rhs;} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T11:55:49.187

您的前提是前向声明纯粹是为了节省内存以允许流解析（而不是将整个源文件保存在内存中）并不是真正正确的。

我们使用的许多解析算法都是基于前向传递，如果你必须回溯，它会在解析时间（或空间）上产生指数爆炸以消除歧义。

例如 - 在声明之前暂时接受一个标识符而不知道它是什么 - 意味着您必须暂时继续进行解析，以考虑它是什么的所有可能性。（包括但不限于错字）

# list - 标准 ML 中的部分总和？

> ID：14388412
> 
> 赞同：0
> 
> 时间：2013-01-17T21:24:21.337
> 
> 标签：list, functional-programming, sum, partial, sml

我是函数式编程的新手，我有一个任务来计算列表的部分总和。例如 - psum [1,1,1,1,1]；val it = [1,2,3,4,5]：int 列表

到目前为止，这是我的代码。但是在函数 psum2[L] 中，我不知道如何遍历每个值并将它们相加，所以我只打印列表。

```
fun psum2(L) : int list = 
   if L=nil then []
   else L;

fun pSum(L) : int list = 
   psum2(L);

exception Empty_List;

psum([2,3,4]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:55:43.760

您的问题有点宽泛，但这是汇总列表的一种方法。也许您可以根据自己的目的对其进行调整：

```
fun sum [] = 0
  | sum (h::t) = h + sum t 
```

# javascript - 在 javascript 中，从其方法之一创建对象的新实例是否合法？

> ID：14388413
> 
> 赞同：0
> 
> 时间：2013-01-17T21:24:26.167
> 
> 标签：javascript, oop

例如，以下代码是否合法？

```
function RandomObject() {
    this.method = function () {
        return new RandomObject();
    };
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:25:21.960

是的，没关系。只要确保你没有把它放在构造函数中，否则你会得到一个无限循环！

# php - PDO 获取模式 - 查询之前/之后

> ID：14388415
> 
> 赞同：1
> 
> 时间：2013-01-17T21:24:43.100
> 
> 标签：php, pdo

我想知道为什么您可以在执行查询之前和之后设置提取模式，结果仍然使用给定的提取模式......？

这意味着 PDO 从数据库服务器检索查询结果作为数字和关联？唔...

是否只能检索一个..？数字结果还是关联结果？

这两个示例返回完全相同的结果。如果我`setFetchMode`省略了数字和 assoc 结果被打印

# 执行前

```
$sth = $dbh->prepare("SELECT REFERENCED_TABLE_NAME table_name, REFERENCED_COLUMN_NAME column_name\n"
    ."FROM KEY_COLUMN_USAGE\n"
    ."WHERE REFERENCED_TABLE_NAME IS NOT NULL && REFERENCED_COLUMN_NAME IS NOT NULL\n"
    ."GROUP BY REFERENCED_TABLE_NAME, REFERENCED_COLUMN_NAME");
$sth->setFetchMode(PDO::FETCH_ASSOC);
$sth->execute();

echo '<pre>';
foreach($sth as $row){
    print_r($row);
}
echo '</pre>'; 
```

# 执行后

```
$sth = $dbh->prepare("SELECT REFERENCED_TABLE_NAME table_name, REFERENCED_COLUMN_NAME column_name\n"
    ."FROM KEY_COLUMN_USAGE\n"
    ."WHERE REFERENCED_TABLE_NAME IS NOT NULL && REFERENCED_COLUMN_NAME IS NOT NULL\n"
    ."GROUP BY REFERENCED_TABLE_NAME, REFERENCED_COLUMN_NAME");
$sth->execute();
$sth->setFetchMode(PDO::FETCH_ASSOC);

echo '<pre>';
foreach($sth as $row){
    print_r($row);
}
echo '</pre>'; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:27:59.073

您的示例使用了简化：在执行之后，但在您可以使用记录之前，您还需要获取它们。这些是[PDOStatement 类](http://php.net/manual/en/class.pdostatement.php)中的 fetch 和 fetchAll 方法。

但是当使用 foreach 构造时，您使用的是 PDOStatement 的 Traversable 接口，它在 foreach 循环的开始调用 fetchAll 方法而不是您。

因此，在这两个示例中，fetchAll 在您设置获取模式后都会被调用。

编辑：

> 这意味着 PDO 从数据库服务器检索查询结果作为数字和关联？唔...

PDO 不会以一种或两种方式从数据库中获取记录，它总是以相同的方式进行 - 不同之处在于它将如何向您呈现结果。如果您指定获取模式，PDO 将为您构建请求的结构。如果您使用默认值或指定 FETCH_BOTH，它将为您构建两个不同的表示，但来自相同的结果集。此参数不会对发送到 SQL 服务器的命令产生影响。

# .net - 当路径不存在时，IIS 7 集成处理程序不匹配

> ID：14388417
> 
> 赞同：0
> 
> 时间：2013-01-17T21:24:55.683
> 
> 标签：.net, http-status-code-404, httphandler, integrated-pipeline-mode

我正在从经典升级到集成。我将我的 web.config 处理程序升级到了新的部分。但是没有任何效果，所以我开始了一个全新的 MVC 4 项目，创建了一个处理程序，在 web.config 中注册它，如果路径不存在，它永远不会触发。

此处理程序获取 url，找到不同的文件，并将该文件与自定义标头一起写入输出流。

例如我正在尝试做：

```
<system.webServer>
<handlers>
<clear/>
<add name="GifHandler" path="*.gif" verb="*" type="MyType, MyAssembly" />
</handlers>
</system.webServer> 
```

当我直接转到处理程序时，很好，当我转到 IIS 并查看已注册的处理程序时，它就在那里，但是当我转到 url localhost/something.gif 时，我得到一个 404。

我有一种感觉 IIS 会在提交文件之前检查文件是否存在。

那么如何让处理程序接受所有 gif，即使它们不存在？

# java - Apache Commons XMLConfiguration - 如何在给定节点获取对象列表？

> ID：14388418
> 
> 赞同：16
> 
> 时间：2013-01-17T21:24:58.047
> 
> 标签：java, orm, apache-commons

我有一个类似这样的 XML 配置文件：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<config>
    <mainServerHostname>MainServer</mainServerHostname>
    <failoverServers>
        <server>
            <ipAddress>192.168.0.5</ipAddress>
            <priority>1</priority>
        </server>
        <server>
            <ipAddress>192.168.0.6</ipAddress>
            <priority>2</priority>
        </server>
    </failoverServers>
</config> 
```

现在，我知道通过使用以下代码（在设置我的 XMLConfiguration 对象并调用它配置之后）：

```
config.getList("failoverServers.server.ipAddress"); 
```

我可以获得所有 IP 地址的列表。这很方便，但如果我能做这样的事情会更方便：

```
config.getList("failoverServers.server"); 
```

并获得一个对象列表，每个对象都有一个 ipAddress 和一个优先级。据我所知，没有办法做到这一点。有人对我如何完成这种功能有任何想法吗？我什至非常愿意定义与 XML 的结构相对应的数据结构，Java 可以将数据映射到这些数据结构中，如果这会使事情变得更容易（实际上这可能会更好）。感谢大家的帮助！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-17T22:07:37.213

您可以使用 HierarchicalConfiguration 而不是 XMLConfiguration。像这样工作：

```
List<HierarchicalConfiguration> servers = config.configurationsAt("failoverServers.server");
for(HierarchicalConfiguration server : servers) {
    System.out.println(server.getString("ipAddress"));
} 
```

请参阅：[http ://commons.apache.org/configuration/userguide/howto_xml.html](http://commons.apache.org/configuration/userguide/howto_xml.html)

# spring - 使用 Hibernate 从数据库中检索选定的字段

> ID：14388423
> 
> 赞同：0
> 
> 时间：2013-01-17T21:25:12.007
> 
> 标签：spring, hibernate, hql

我正在使用 Hibernate 从 Oracle 数据库中检索包含选定字段的行列表。检索是通过以下方法在我的应用程序中的一个 DAO 中进行的。

```
@SuppressWarnings("unchecked")
public List<Object[]> getOldFileName(String []ids)
{
    int len=ids.length;
    Long longType[]=new Long[len];

    for(int i=0;i<len;i++)
    {
        longType[i]=Long.valueOf(ids[i]);
    }
    return sessionFactory.getCurrentSession().createQuery("select catId, catImage from Category where catId in(:id)").setParameterList("id", longType).list();
} 
```

在这里，我获取两个字段`categoryId`，并`categoryImage`在给定的 HQL 查询中列出，基于通过 Spring 作为方法参数`catId`提供的数组。`String[]`它工作正常，毫无疑问。

但是关于我的要求，`catId`完全没有必要再次检索，我想`catId`从查询中的字段列表中删除类似于以下内容的内容。

```
select catImage from Category where catId in(:id) 
```

如果我尝试执行此查询，则以下调用 Spring 控制器类中的上述方法，

```
String temp[]=request.getParameter("setDel").split(",");
List<Object[]> oldFileNames = categoryService.getOldFileName(temp); 
//Invokes the preceding method in DAO. 
```

导致引发以下异常，

> java.lang.ClassCastException：java.lang.String 无法转换为 [Ljava.lang.Object;

异常消息表明`java.lang.String`不能转换为对象数组 - `Object[]`。HQL 语句似乎只尝试获取 String 类型的单个值，而不是检索`List<Object[]>`.

我只想在从数据库中检索到它们的名称后删除存储在目录中的文件，并且`catId`在 HQL 的字段列表中提及是完全没有必要的。

为什么`catId`在这种场景下需要在 HQL 语句的字段列表中添加？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:49:31.730

列表的返回类型应该是 List。当只有一列返回时，休眠不会将结果放入 Object[]

# r - 从第 3 行开始逐行添加矩阵列

> ID：14388427
> 
> 赞同：0
> 
> 时间：2013-01-17T21:25:33.650
> 
> 标签：r

我有一个矩阵，想逐行获取列的总和。

例如

```
a b c d e

1 2 4 6 9

2 3 5 3 2
3 2 9 8 5 
```

我想添加 1+2+4+6+9 和 2+3+5+3+2 和 3+2+9+8+5

一个额外的复杂情况是我想从第 3 列开始，然后每隔一列添加一次。

所以 4+9 3+2 和 8+5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:39:32.557

这是您需要的矩阵的提取，使用 rowSums 调用：

```
rowSums(x[,-(1:2)][,c(T,F)])
## [1] 13  7 14 
```

# arrays - 在codeigniter中，如何将数组传递给函数参数

> ID：14388430
> 
> 赞同：-1
> 
> 时间：2013-01-17T21:25:57.560
> 
> 标签：arrays, codeigniter, parameters

作为标题，我有一个库函数`$this->foo->bar()`。如何将`$upload_data`数组传递给`$this->foo->bar()`参数？

我的控制器中有这个

```
$upload_data = $this->upload->data();
//$upload_data['file_name']
$this->foo->bar($upload_data); 
```

然后我的图书馆里有这个

```
public function bar($arr){
    $config['source_name'] = //How can I use $arr['file_name'] in here
} 
```

我收到此错误消息：非法字符串偏移 'file_name'

```
var_dump($upload_data)

array (size=14)
 'file_name' => string '1358459309.JPG' (length=14)
 'file_type' => string 'image/jpeg' (length=10)
 'file_path' => string 'C:/wamp/www/foldering/assets/img/uploaded_photos/' (length=49)
 'full_path' => string 'C:/wamp/www/foldering/assets/img/uploaded_photos/1358459309.JPG'       (length=63)
 'raw_name' => string '1358459309' (length=10)
 'orig_name' => string '1358459309.JPG' (length=14)
 'client_name' => string '200X CNY1.JPG' (length=13)
 'file_ext' => string '.JPG' (length=4)
 'file_size' => float 30.87
 'is_image' => boolean true
 'image_width' => int 640
 'image_height' => int 480
 'image_type' => string 'jpeg' (length=4)
 'image_size_str' => string 'width="640" height="480"' (length=24) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:11:20.470

我的错误，问题来自另一个功能

# c# - 将空值添加到绑定到 ArrayList 的 ComboBox

> ID：14388436
> 
> 赞同：1
> 
> 时间：2013-01-17T21:26:43.267
> 
> 标签：c#, winforms, oracle

我已经看到了一些与我遇到的这个问题类似的问题，但它们似乎都没有解决。

我目前有一个方法，用数据库查询中的项目填充数组列表，然后返回用于填充组合框的数组列表。ComboBox 将用作其他数据库查询的搜索过滤器。

我想向数组列表添加一个空值，以便在选择空值时允许用户“关闭过滤器”。

将空值添加到数组列表时会出现问题。当我在添加数据库项目之前添加空值时，所有项目都不会显示在实际的 ComboBox 中。当我在填充 ArrayList 后添加空值时，空值永远不会在 ComboBox 中显示为一行，但其他所有内容都在那里。

```
 public static ArrayList DropDown()
    {
        ArrayList status = new ArrayList();
        connect.Open();

        // Finds the stuff to use in the  COMBO BOX
        cmd.CommandText = String.Format("query");
        reader = cmd.ExecuteReader();

        while (reader.Read())
        {

            status.Add(String.Format("{0}", reader[BANK_ID]));
        }
        string holder = null;
        status.Add(holder); 
        connect.Close();
        return status;
    } 
```

这将导致填充的 ComboBox，但没有空行。

```
 public static ArrayList DropDown()
    {
        ArrayList status = new ArrayList();
        string holder = null;
        status.Add(holder); 
        connect.Open();

        // Finds the stuff to use in the  COMBO BOX
        cmd.CommandText = String.Format("query");
        reader = cmd.ExecuteReader();
        ;
        while (reader.Read())
        {

            status.Add(String.Format("{0}", reader[BANK_ID]));
        }

        connect.Close();
        return status;
    } 
```

这导致组合框中没有任何内容。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:35:47.963

组合框的项目集合不能包含 null。参考：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.combobox.objectcollection.add.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.objectcollection.add.aspx)

我假设设置`DataSource`是在内部检查这一点，因此您注意到的行为（可能更知情的人可以确认这一点）

我建议您添加 String.Empty ，您可以一起摆脱 arraylist 并改用字符串数组/列表。

```
comboBox.Items.Insert(0, string.Empty); 
```

# javascript - 如何使用 jquery Show() 方法显示图像的百分比

> ID：14388441
> 
> 赞同：0
> 
> 时间：2013-01-17T21:27:00.177
> 
> 标签：javascript, jquery, html, jquery-mobile, jquery-effects

当您向左或向右滑动移动浏览器时，我正在尝试创建与叠加箭头（即桌面版 chrome）相同的漂亮效果。

我使用 javascript 和 jQuery，现在我可以在滑动时显示箭头。我设法获得了滑动的距离，但我找不到将两者联系起来的方法，所以我只显示了与距离相关的箭头的一部分！

```
$('#arrow').show('slide',{direction: 'right'},1000);
$('#arrow').fadeIn();
$('#arrow').fadeOut(); 
```

我也在尝试用 animate() 来做，但我仍然卡住了：S

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T03:14:04.943

您将需要三个值：`start`, `end`, `current`.

在您的情况下，您需要确定`start` `end`值是多少。

我会说使用您的可滑动区域（屏幕）的宽度，这会给您`0`和`x`（`x`您的可滑动区域的宽度在哪里）。您已经有了，这是实际滑动结束`current`之间的距离（也许是滑动的宽度？）。`start`

获得这些值后，您可以得出一个百分比（介于 0 和 1 之间）并使用@mikakun 的建议将其应用于您的箭头。箭头图形要么需要绝对定位在容器中，要么设置为容器的背景图像。当容器展开以显示更多内容时，这将使您只看到箭头的百分比。一个很好的效果是在您要显示的箭头后面有一个完整箭头的半透明/灰色副本。

# asp.net-mvc - 为多个步骤保存数据？

> ID：14388444
> 
> 赞同：0
> 
> 时间：2013-01-17T21:27:06.563
> 
> 标签：asp.net-mvc, tempdata

我有 3 个步骤，每个步骤都在视图中。在第 1 步我询问开始日期/时间（他们可以选择时区和时间）并将其存储为 UTC，在第 3 步我想根据他们选择的时区显示日期/时间，而不知道他们选择了哪个时区（不要存储它，因为用户会根据计算机时区看到它）。

我想知道做到这一点的最佳方法。我正在考虑存储临时数据，然后重新存储它。尽管这似乎不是最佳实践。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:56:38.733

如果您用于第 2 步和第 3 步的模型具有`Timezone`属性，则可以将值存储在隐藏字段中并将其发回给您，如下所示：

```
Html.HiddenFor(model => model.Timezone); 
```

替代方案是将值放入 cookie 中（然后可能使用[CookieValueProvider](http://www.dotnetguy.co.uk/post/2010/03/07/aspnet-mvc-working-smart-with-cookies-custom-valueprovider/)将其取回）或将其放入会话中，尽管最后一个选项[并不是真正](https://stackoverflow.com/questions/10181629/why-session-is-a-disaster-in-asp-net-mvc-application)“打算”使用 MVC 的方式。

# nservicebus3 - 包装 NServiceBus.IHandleMessages

> ID：14388445
> 
> 赞同：7
> 
> 时间：2013-01-17T21:27:06.853
> 
> 标签：nservicebus3

我被要求开发一个层，该层将充当通用总线，而不*直接*引用 NServiceBus。到目前为止，由于对不显眼的消息的支持，这并不太难。除了现在，我被要求为 IHandleMessages 提供我们自己的定义，并找到一种在连接期间映射它的方法。所以我在想这样的事情：

```
 public class MessageHandlerAdapter<T> : IHandleMessages<T>
{
    IUnityContainer container;

    public MessageHandlerAdapter(IUnityContainer container)
    {
        this.container = container;
    }

    #region IMessageHandler<T> Members

    public void Handle(T message)
    {
        var handler = container.Resolve<IHandle<T>>();
        handler.Handle(message);
    }

    #endregion
} 
```

其中 IHandle 将是我们自己的定义（顺便说一下，它与 IHandleMessages 完全相同）。我希望反映 AppDomain 并找到所有实现 IHandle 的类并将它们注册到容器中，然后注册一个具有相同类型 T 的 MessageHandlerAdapter。

我的问题是我已经有将近 2 年没有使用 NServiceBus 了，而且我不记得在 NSB 管道中在哪里连接到这种功能。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-01-17T22:52:50.767

您可能不会喜欢这个答案，但是……不要为您使用的工具编写抽象层。

我见过很多人试图围绕某些工具编写抽象层的例子。大多数情况是日志记录和 ORM 框架。现在人们这样做是出于好意。他们希望“能够轻松切换库 X”。不幸的是，由于几个原因，这是一个坏主意

*   不兼容的概念。在您的示例中，您可能会提取出 NSB Saga 超时的概念。但是，不能保证这个概念在理论上的“将来切换到的库”中会以相同的方式表现，或者这个概念会完全存在。通常这些“抽象层”最终成为单个库的直接映射并且根本不可移植。
*   增加了复杂性。您将为您的解决方案增加大量的复杂性。
*   样品不起作用。当您查看库的示例时，您需要“映射到您的”到您的抽象层
*   进入壁垒。虽然加入您的团队的新开发人员可能已经使用了有问题的库，但他们不会了解您的包装器
*   对抗 API。从来没有一个库在设计时考虑到“能够提取通用实现”这一特性。因此，API 会主动与您执行此活动。
*   调试。一个额外的层会使调试您的解决方案变得更加困难
*   表现。一般来说，更多的代码是更慢的代码。这些抽象层也经常需要使用反射......
*   支持。您将更难从图书馆拥有者那里获得支持，因为很难记录您如何与图书馆互动。
*   持续变化。每次相关库添加或更改 API 时，您都必须添加映射代码，然后才能在解决方案中利用该功能。
*   文档。为图书馆创建文档通常需要大量的工时。对您而言，将抽象的文档提升到该级别将是一项重大的工作。

这一切都归结为时间。您现在正试图花时间抽象该工具。希望将来能节省更多的时间。问题是，如果您决定切换，您将花费更多的时间来创建和维护这种抽象。这应该是您对同事的回应。

这是 Ayende 的一篇有趣的帖子，讨论了抽象的弊端。其中大部分适用于这种情况[http://ayende.com/blog/4784/architecting-in-the-pit-of-doom-the-evils-of-the-repository-abstraction-layer](http://ayende.com/blog/4784/architecting-in-the-pit-of-doom-the-evils-of-the-repository-abstraction-layer)引用

> ...尽量避免不必要的复杂性...添加额外的抽象层通常只会使其变得困难。

# forms - jquery移动查询字符串参数

> ID：14388447
> 
> 赞同：0
> 
> 时间：2013-01-17T21:27:29.873
> 
> 标签：forms, jquery-mobile, mobile, query-string

在我的应用程序中，我有作为 perl 的后端代码和使用 jquery mobile 进行的前端开发。当我使用变量 x=10 y=20 在 jqm 页面上提交表单时，在查询字符串中而不是替换 jqm.com/?x=10&y=20 之类的参数，我将其附加为 jqm.com/id=1000&x =10&y=20。我再次更改我的值并提交我得到
jqm.com/?id=1000&x=10&y=20&id=1000&x=newvalue&y=newvalue的表格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:39:56.837

您遇到此问题是因为您没有`action`在表单中指定属性。因此，默认情况下，它会将数据发送到页面本身，因此您每次都会将参数附加到当前页面 url。

要解决此问题，只需添加`action`如下示例所示的属性：

```
<form action="a-page-to-send.php" method="post">
  <!-- code goes here -->
</form> 
```

# android - 从 Mat 获取直方图数据，opencv android

> ID：14388449
> 
> 赞同：0
> 
> 时间：2013-01-17T21:27:59.650
> 
> 标签：android, image-processing, opencv, histogram, mat

我正在使用 opencv 开发一个 android 项目，我正在为黑白图像（图像文件上的 1-0 值）创建直方图。我正在关注我在互联网上找到的一些关于如何创建直方图的教程。我正在做这样的事情

```
 ArrayList<Mat> list = new ArrayList<Mat>();
        list.add(mRgba);
        MatOfInt channels = new MatOfInt(0);
        Mat hist= new Mat();
        MatOfInt histSize = new MatOfInt(25);
        MatOfFloat ranges = new MatOfFloat(0f, 1f);
        Imgproc.calcHist(list, channels, new Mat(), hist, histSize, ranges); 
```

然后我想查看 hist Mat 上的数据，如果我尝试这样的事情......

```
 for(int i = 0;i<25;i++){
            Log.e(TAG, "data "+i+" "+hist.get(i, 0));
        } 
```

我明白了

```
>  data 0 [D@2be05908
   data 1 [D@2be0a138
   data 2 [D@2bdf9f48
   data 22 [D@2be06c70 
```

这对我来说毫无意义。如果我尝试不同的方法，比如

```
 byte buff[] = new byte[ hist.height()*hist.width() * hist.channels()];
            hist.get(0, 0, buff); 
```

我收到有关 mat.get 函数的 mat 兼容性的错误。

有什么方法可以直接访问 hist mat 上的数据？

我有兴趣取回所有数据，而不仅仅是 man mix

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:37:28.370

hist.get(i, 0) 返回双精度数组。所以你可以试试这个：

```
for (int i = 0; i< 25; i++) {
    double[] histValues = hist.get(i, 0);
    for (int j = 0; j < histValues.length; j++) {
        Log.d(TAG, "yourData=" + histValues[j]);
    }
} 
```

# javascript - 如何使用 ajax 从文件中加载 JSON 对象？

> ID：14388452
> 
> 赞同：20
> 
> 时间：2013-01-17T21:28:19.637
> 
> 标签：javascript, ajax, json

我正在使用 JSON 传输数据。

我需要在我的 HTML 页面中使用 Ajax 读取在我的脚本中只包含一个 JSON 对象的文件吗？

我是否也需要 jQuery，或者是否可以使用 Ajax 加载该 JSON 文件？

不同浏览器有区别吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-01-17T21:32:44.560

您不需要任何库，所有东西都可以在 vanilla javascript 中获取并解析它：

```
function fetchJSONFile(path, callback) {
    var httpRequest = new XMLHttpRequest();
    httpRequest.onreadystatechange = function() {
        if (httpRequest.readyState === 4) {
            if (httpRequest.status === 200) {
                var data = JSON.parse(httpRequest.responseText);
                if (callback) callback(data);
            }
        }
    };
    httpRequest.open('GET', path);
    httpRequest.send(); 
}

// this requests the file and executes a callback with the parsed result once
//   it is available
fetchJSONFile('pathToFile.json', function(data){
    // do something with your data
    console.log(data);
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-17T21:33:01.240

最有效的方法是使用纯 JavaScript：

```
var a = new XMLHttpRequest();
a.open("GET","your_json_file",true);
a.onreadystatechange = function() {
  if( this.readyState == 4) {
    if( this.status == 200) {
      var json = window.JSON ? JSON.parse(this.reponseText) : eval("("+this.responseText+")");
      // do something with json
    }
    else alert("HTTP error "+this.status+" "+this.statusText);
  }
}
a.send(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T21:32:37.620

过去，Ajax 在不同的浏览器中是不同的（如果您需要支持很多用户仍在使用的旧版浏览器，仍然如此）。对于较旧的浏览器，您需要像 JQuery 这样的库（或您自己的等效代码）来处理浏览器差异。无论如何，对于初学者来说，我可能会推荐 jQuery 以获得良好的文档、简单的 API 和快速入门，尽管[MDN](http://developer.mozilla.org/)对 JavaScript 本身也很有帮助（而且你真的应该越来越多地了解 JavaScript/DOM API，即使你主要依赖jQuery）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T22:51:20.363

我更喜欢使用 ajax jquery。Jquery 让生活变得更容易。

例如，您可以在服务器端执行的操作是，我假设您使用的是 php：

```
if (isset($_SERVER['HTTP_X_REQUESTED_WITH']) && $_SERVER['HTTP_X_REQUESTED_WITH'] == 'XMLHttpRequest'){
    // if it's an ajax request

    $json['success'] = 1;
    $json['html'] = '<div id="test">..[more html code here].. </div>';
    echo json_encode($json);
}else{
    // if it's an non ajax request

} 
```

在客户端，您可以使用 jquery ajax 执行以下操作：

```
 $.ajax({
          type: "POST",
          url: "[your request url here]",
          data: { name: "JOKOOOOW OOWNOOO" },
          complete: function(e, xhr, settings){
              switch(e.status){
                  case 500:
                     alert('500 internal server error!');
                     break;
                  case 404:
                      alert('404 Page not found!');
                     break;
                  case 401:
                      alert('401 unauthorized access');     
                     break;       
              }
          }           
        }).done(function( data ) {
            var obj = jQuery.parseJSON(data)

            if (obj.success == 1){

                  $('div#insert_html_div').html(obj.html);

            }else if (obj.error == 1){

                            }

            // etc

        }); 
```

# gradle - 如何覆盖 build.gradle 中定义的属性？

> ID：14388458
> 
> 赞同：9
> 
> 时间：2013-01-17T21:28:35.813
> 
> 标签：gradle

如何在 build.gradle 文件中设置属性并允许每个开发人员在本地覆盖它？我试过：

gradle.properties：

```
MY_NAME = "Jonathon"
MY_COLOR = "blue" 
```

构建.gradle：

```
ext.MY_NAME = "John Doe"
task showit <<{
  println "MY_NAME[" + MY_NAME + "]";
  println "MY_COLOR[" + MY_COLOR + "]";
} 
```

`gradle showit`给出：

```
:showit
MY_NAME[John Doe]
MY_COLOR["blue"] 
```

我认为项目根目录的 gradle.properties 文件中定义的属性会覆盖 build.gradle 中定义的同名属性，但事实并非如此。它只填充缺失的属性。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-10-29T12:17:31.277

检查项目是否有属性，如果没有，设置为默认值：

```
ext {
    if (!project.hasProperty('MY_NAME')) {
        MY_NAME = 'John Doe'
    }
} 
```

请参阅：[https ://docs.gradle.org/current/userguide/build_environment.html#sub:checking_for_project_properties](https://docs.gradle.org/current/userguide/build_environment.html#sub:checking_for_project_properties)

如果您需要对多个属性执行此操作，您可以定义一个函数：

```
def setPropertyDefaultValueIfNotCustomized(propertyName, defaultValue) {
    if (!project.hasProperty(propertyName)) {
        ext[propertyName] = defaultValue
    }
}

ext {
    setPropertyDefaultValueIfNotCustomized('MY_NAME', 'John Doe')
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-11-18T11:02:42.507

类似于[Johan Stuyts 的回答](https://stackoverflow.com/a/33414019/606662)，但作为一个单行：

```
ext.MY_NAME = project.properties['MY_NAME'] ?: 'John Doe' 
```

运行`gradle -PMY_NAME="Jeff F." showit`给出`MY_NAME[Jeff F.]`。

运行`gradle showit`给出`MY_NAME[John Doe]`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T21:38:21.357

我认为您可以定义一个局部变量，然后像这样覆盖它

```
 def dest = "name"

  task copy(type: Copy) {
     from "source"
     into name
  } 
```

看到[这个](http://gradle.org/docs/current/userguide/writing_build_scripts.html)文档

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-18T20:08:45.297

我自己也遇到了这个。我的用例是我 fork 项目 repos 而我的同事没有。我需要将[axion-release](https://axion-release-plugin.readthedocs.io/en/latest/configuration/repository/)的存储库远程设置为`upstream`而不是`origin`.

我不想传递 args （或创建别名/shell 函数），所以我最终`gradle.properties`在我的`GRADLE_USER_HOME`( `~/.gradle`) 中创建了一个属性（名称无关紧要），在那里以及项目的`gradle.properties`. 在`gradle.build`我总是使用该属性，[因为它始终存在](https://docs.gradle.org/current/userguide/build_environment.html)。

### 例子

`~/.gradle/gradle.properties`

```
scmVersionRepositoryRemote=upstream 
```

* * *

`[project-root]/gradle.properties`

```
scmVersionRepositoryRemote=origin 
```

* * *

`[project-root]/build.gradle`

```
scmVersion {
  repository {
    remote = scmVersionRepositoryRemote
  }
} 
```

# java - ImageIO.read() 抛出 IllegalArgumentException

> ID：14388460
> 
> 赞同：0
> 
> 时间：2013-01-17T21:28:53.143
> 
> 标签：java, image-processing, javax.imageio

我正在使用 ImageIO api 读取字节数组（使用 ByteArrayInputStream）以取回 BufferredImage。它大部分时间都有效，但对于某些图像会失败。经过广泛的研究 - 我发现它与颜色转换有关。但是我不确定如何通过不放弃 ImageIO API 来快速解决这个问题。下面是堆栈跟踪：

```
java.lang.IllegalArgumentException: Numbers of source Raster bands and source color space components do not match
   at java.awt.image.ColorConvertOp.filter(ColorConvertOp.java:460)
   at com.sun.imageio.plugins.jpeg.JPEGImageReader.acceptPixels(JPEGImageReader.java:1114)
   at com.sun.imageio.plugins.jpeg.JPEGImageReader.readImage(JPEGImageReader.java:0)
   at com.sun.imageio.plugins.jpeg.JPEGImageReader.readInternal(JPEGImageReader.java:1082)
   at com.sun.imageio.plugins.jpeg.JPEGImageReader.read(JPEGImageReader.java:897)
   at javax.imageio.ImageIO.read(ImageIO.java:1422)
   at javax.imageio.ImageIO.read(ImageIO.java:1374)
   at org.netbeans.modules.form.editors.CustomIconEditor$IconFileItem.<init>(CustomIconEditor.java:516)
   at org.netbeans.modules.form.editors.CustomIconEditor.createFileComboModel(CustomIconEditor.java:479)
   at org.netbeans.modules.form.editors.CustomIconEditor.setPackage(CustomIconEditor.java:312)
   at org.netbeans.modules.form.editors.CustomIconEditor.setValue(CustomIconEditor.java:155)
   at org.netbeans.modules.form.editors.IconEditor.getCustomEditor(IconEditor.java:228)
   at org.netbeans.modules.form.ResourceWrapperEditor.createCustomEditorGUI(ResourceWrapperEditor.java:311)
   at org.netbeans.modules.form.ResourceWrapperEditor.getCustomEditor(ResourceWrapperEditor.java:203)
   at org.netbeans.modules.form.FormPropertyEditor.getCustomEditor(FormPropertyEditor.java:303)
   at org.openide.explorer.propertysheet.PropertyDialogManager.<init>(PropertyDialogManager.java:129)
   at org.openide.explorer.propertysheet.CustomEditorAction.actionPerformed(CustomEditorAction.java:217)
   at org.openide.explorer.propertysheet.SheetTable.editCellAt(SheetTable.java:998)
   at javax.swing.plaf.basic.BasicTableUI$Handler.adjustSelection(BasicTableUI.java:1078)
   at javax.swing.plaf.basic.BasicTableUI$Handler.mousePressed(BasicTableUI.java:1008)
   at java.awt.AWTEventMulticaster.mousePressed(AWTEventMulticaster.java:263)
   at java.awt.AWTEventMulticaster.mousePressed(AWTEventMulticaster.java:262)
   at java.awt.AWTEventMulticaster.mousePressed(AWTEventMulticaster.java:262)
   at java.awt.Component.processMouseEvent(Component.java:6260)
   at javax.swing.JComponent.processMouseEvent(JComponent.java:3255)
   at org.openide.explorer.propertysheet.SheetTable.processMouseEvent(SheetTable.java:731)
   at java.awt.Component.processEvent(Component.java:6028)
   at java.awt.Container.processEvent(Container.java:2041)
   at java.awt.Component.dispatchEventImpl(Component.java:4630)
   at java.awt.Container.dispatchEventImpl(Container.java:2099)
   at java.awt.Component.dispatchEvent(Component.java:4460)
   at java.awt.LightweightDispatcher.retargetMouseEvent(LightweightDispatcher.java:4574)
   at java.awt.LightweightDispatcher.processMouseEvent(LightweightDispatcher.java:4235)
   at java.awt.LightweightDispatcher.dispatchEvent(LightweightDispatcher.java:4168)
   at java.awt.Container.dispatchEventImpl(Container.java:2085)
   at java.awt.Window.dispatchEventImpl(Window.java:2475)
   at java.awt.Component.dispatchEvent(Component.java:4460)
   at java.awt.EventQueue.dispatchEvent(EventQueue.java:599)
   at org.netbeans.core.TimableEventQueue.dispatchEvent(TimableEventQueue.java:104)
   at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:269)
   at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:184)
   at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:174)
   at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:169)
   at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:161)
   at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:29:21.657

因此，这是 javax.imageio API 中的一个 JDK 错误，它阻止 ImageIO.read(..) 返回一个 BufferedImage。它在 2007 年被报道并且仍然开放：（

[http://bugs.sun.com/view_bug.do;jsessionid=2e30e4710093bcffffffffa4c93719b2921d5?bug_id=6619667](http://bugs.sun.com/view_bug.do;jsessionid=2e30e4710093bcffffffffa4c93719b2921d5?bug_id=6619667)

为了解决我的问题 - 我已经实施了一种解决方法来直接处理字节。生活很好。感谢您抽出时间）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T06:40:26.323

该错误消息提供信息，表明 ICC 颜色配置文件中提到的光栅带的数量似乎不正确。我使用[ImageMagick](http://www.imagemagick.org/script/index.php)从图像中[剥离](http://www.imagemagick.org/script/command-line-options.php)ICC 配置文件。ImageIO 随后在读取图像时没有问题（~1k 坏图像）。希望有帮助。

# sql - 我需要按字段检查重复项，并保留所有记录并将特定字段作为值返回

> ID：14388463
> 
> 赞同：1
> 
> 时间：2013-01-17T21:29:06.110
> 
> 标签：sql, ms-access

我该如何执行以下操作：

```
Christopher Vestal 240 $506.00 11/23/2012 $0.91

Christopher Vestal 240 $43.10 11/23/2012 $0.91

Christopher Vestal 240 $77.60 11/23/2012 $0.91

Christopher Vestal 240 $16.00 11/23/2012 $0.91 
```

我检查金额并保留最高金额的费用并将其他金额更改为 0.00 美元。

```
C Scott Gobble 444 $29.30 11/23/2012 12:00:00 AM $0.00

C Scott Gobble 444 $104.00 11/23/2012 12:00:00 AM $0.00

C Scott Gobble 444 $8.60 11/23/2012 12:00:00 AM $0.00

C Scott Gobble 444 $506.00 11/23/2012 12:00:00 AM $0.91 
```

这是我需要在 SQL 中输出的最终结果。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:43:55.073

使用 Access 2007，我将*Christopher*示例数据存储在名为`YourTable`：

```
full_name          some_number amount  date_field fee
Christopher Vestal         240 $506.00 11/23/2012 $0.91
Christopher Vestal         240  $43.10 11/23/2012 $0.91
Christopher Vestal         240  $77.60 11/23/2012 $0.91
Christopher Vestal         240  $16.00 11/23/2012 $0.91 
```

此查询产生以下结果集。

```
SELECT
    y.full_name,
    y.some_number,
    y.amount,
    y.date_field,
    IIf(y.amount < DMax(
            "amount",
            "YourTable",
            "full_name ='" & y.full_name & "'"
            ), 0, y.fee
        ) AS adjusted_fee
FROM YourTable AS y;

full_name          some_number amount  date_field adjusted_fee
Christopher Vestal         240 $506.00 11/23/2012        $0.91
Christopher Vestal         240  $43.10 11/23/2012        $0.00
Christopher Vestal         240  $77.60 11/23/2012        $0.00
Christopher Vestal         240  $16.00 11/23/2012        $0.00 
```

如果您需要实际更改存储的`fee`值，可以使用此`UPDATE`语句来完成。

```
UPDATE YourTable AS y
SET y.fee = 0
WHERE
    y.amount < DMax(
            "amount",
            "YourTable",
            "full_name ='" & y.full_name & "'"
            ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:41:27.543

在你的 SQL 语句中尝试使用这样的东西：

```
 Select iif(Amount = Max(Amount), Fee, 0)
 From MyTable 
```

# php - 从 PHP 调用时 WinSCP 未运行

> ID：14388465
> 
> 赞同：0
> 
> 时间：2013-01-17T21:29:12.403
> 
> 标签：php, windows, winscp

我有这行代码：

```
shell_exec("\"C:\Program Files (x86)\WinSCP\winSCP.exe\" /console /script=c:\\wamp\\www\\client\\transfer_script.txt"); 
```

该命令在命令提示符下工作，我确信它已正确转义。另外，我将 php 安全模式设置为关闭，并且在我的 php.ini 中没有 disabled_functions。

当我调用 php 脚本时，我无法运行命令。有任何想法吗？

**编辑：** 现在我确定它已正确转义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:40:38.143

我认为它没有正确逃脱。考虑：

```
// As you have it:
$cmd = "\"C:\Program Files (x86)\WinSCP\winSCP.exe\" /console /script=c:\wamp\www\client\transfer_script.txt";
echo $cmd;

> "C:\Program Files (x86)\WinSCP\winSCP.exe" /console /script=c:\wamp\www\client ransfer_script.txt 
```

那看起来不对。尝试双转义引号外的反斜杠（指向脚本源的地方）：

```
$cmd = "\"C:\Program Files (x86)\WinSCP\winSCP.exe\" /console /script=c:\\wamp\\www\\client\\transfer_script.txt";
echo $cmd;

> "C:\Program Files (x86)\WinSCP\winSCP.exe" /console /script=c:\wamp\www\client\transfer_script.txt 
```

更好的。

**更新**

如果这仍然不起作用，我会尝试使用 进行四重转义`\\\\`，以防万一 Windows 需要双反斜杠。还要考虑检查错误代码。

# linux - 此脚本不会按年龄正确排序

> ID：14388467
> 
> 赞同：1
> 
> 时间：2013-01-17T21:29:40.363
> 
> 标签：linux, bash, shell, unix

我的脚本要求输入姓名、电话号码和出生日期，然后将这些详细信息修改为一个名为“birthday.csv”的逗号分隔值文件。

然后它按出生日期对“birthday.csv”进行排序。然后显示新排序的文件。它还计算每个人的年龄和文件中的条目数。

我的问题是，它接受了所有信息，但是在打印内容之前它不会对文件进行排序。

这是代码：

```
a=0
while [ $a -lt 2 ];
do
    echo Please enter a first name
    read firstName
    echo Please enter last name
    read lastName
    echo Please enter phone number
    read phoneNumber
    echo Please enter date of birth - format dd/mm/yyyy
    read dob
    echo "$firstName,$lastName,$phoneNumber,$dob" >> Birthdays.csv
    echo If you would like to add another person press 1 or enter 2 to proceed
    read a
done

INPUT=./Birthdays.csv
OLDIFS=$IFS
IFS=","
[ -f ${INPUT} ] && while read Name Surname Telephone DOB
do
    birthMonth=${DOB:0:2}
    birthDay=${DOB:3:2}
    birthYear=${DOB:6:4}

    currentDate=`date +%d/%m/%Y`

    currentMonth=${currenDate:0:2}
    currentDay=${currentDate:3:2}
    currentYear=${currentDate:6:4}

    if [[ "$currentMonth" -lt "$birthMonth" ]] || [[ "$currentMonth" -eq "$birthMonth" && "$(currentDay)" -lt "$($birthDay)" ]]
    then
        let Age=currentYear-birthYear-1
    else
        let Age=currentYear-birthYear
    fi

    echo "Name : $Name"
    echo "Surname : $Surname"
    echo "Telephone : $Telephone"
    echo "DOB : $DOB"
    echo "Age : $Age"
    echo "##########################################"
done < $INPUT
IFS=$OLDIFS
    echo $DATE

exit 0; 
```

我认为问题在于

```
if [[ "$currentMonth" -lt "$birthMonth" ]] || [[ "$currentMonth" -eq "$birthMonth" && "$(currentDay)" -lt "$($birthDay)" ]]
then
    let Age=currentYear-birthYear-1
else
    let Age=currentYear-birthYear
fi 
```

但我不确定是什么导致它无法排序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T14:57:03.890

首先删除 "$(currentDay)" 和 "$(currentDay)" 周围的括号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:56:38.427

您至少有一个错误：

```
if [[ "$currentMonth" -lt "$birthMonth" ]] || [[ "$currentMonth" -eq "$birthMonth" && "$(currentDay)" -lt "$($birthDay)" ]] 
```

`"$(currentDay)"`应该是公正`"$currentDay"`的，`"$($birthDay)"`应该是公正`"$birthDay"`的。

你这里还有一个错字：

```
currentMonth=${currenDate:0:2} 
```

那应该是`currentDate`。放在`set -u`脚本的顶部以捕获此类错误。

另外，就像 Mat 说的，我没有看到任何排序代码 :)

# asp.net-mvc - 如何为 Azure webrole 拥有多个自定义发布配置文件

> ID：14388473
> 
> 赞同：1
> 
> 时间：2013-01-17T21:30:26.943
> 
> 标签：asp.net-mvc, azure, azure-sql-database, azure-web-roles

使用 Azure 发布向导为您提供了一些更改配置设置的选项，但还不够。您可以告诉它要使用哪个构建配置（这将对您的 Web 配置应用转换），但您只有 2 个选择。发布和调试。您还可以指定要使用哪个云服务配置来转换您的 service.config，但同样只有 2 个选择 Cloud 和 Local。

我的问题是我在 Azure 中运行了 3 个不同版本的应用程序。它们是开发、演示和生产。每个都有自己的数据库、存储帐户和其他与身份验证相关的设置。仅仅进行发布和调试转换并不能削减它。

我真正想要的是有一个脚本或其他东西，以便我可以将我的应用程序发布到我的每个 Azure 实例。它会改变我的 web.config 和 service.config 并针对正确的 azure 实例。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:40:35.293

以前有 CodePlex 项目[http://wappowershell.codeplex.com/](http://wappowershell.codeplex.com/)，现在在这里成为官方工具：[https](https://www.windowsazure.com/en-us/manage/downloads/) ://www.windowsazure.com/en-us/manage/downloads/ 。

它是一组用于管理 Azure 部署的 Windows PowerShell cmdlet。

以下问题也非常相似：[从命令行发布 Azure 项目](https://stackoverflow.com/questions/8565527/publish-azure-project-from-command-line)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:09:52.323

在研究这个问题时，我将我的 Azure 工具更新到了 10 月份的版本。不确定这些选项在旧版本中是否可用，但这就是我最终得到的。

事实证明，除了默认配置（云/本地/调试/发布）之外，还可以添加您自己的服务配置和构建配置。

可以通过以下方式添加服务配置：

1.  右键单击云服务项目中的 Web 角色并选择属性。
2.  在属性窗口的顶部打开服务配置菜单。然后选择管理。
3.  选择一个配置并单击创建副本按钮。
4.  选择副本并将其重命名为您想要的任何内容。
5.  单击关闭，现在您应该能够拥有特定于新服务配置的设置。

可以通过以下方式添加构建配置（[我关注了这篇博文](http://msdn.microsoft.com/en-us/vs2010trainingcourse_webdevelopment_topic4.aspx)）：

1.  从菜单中选择构建 -> 配置管理器。配置管理器
    对话框
2.  从活动解决方案配置下拉列表中选择以显示新解决方案配置对话框。
3.  输入名称并选择要复制的配置。单击确定。
4.  确保为新解决方案配置的每个项目选择正确的配置（发布或调试）。
5.  请注意，仍然没有 web.config 转换。要添加新的 Web.config 转换，请右键单击 Web.config 文件，然后从菜单中选择添加配置转换。请注意，会自动添加与您的新配置匹配的新配置文件

完成这些步骤后，我能够在 Azure 发布向导中创建一个新的目标配置文件并选择这些配置。这使您可以使用转换自动执行 web.config 设置，并为每个发布配置文件拥有自己的自定义云服务配置。

[这是另一个很好的参考资料，它比我能够回答这个问题更详细。](http://blog.slalom.com/2011/08/19/building-and-deploying-windows-azure-projects-using-msbuild-and-tfs-2010/)

# java - 来自自动装配类的新实例

> ID：14388480
> 
> 赞同：1
> 
> 时间：2013-01-17T21:30:46.047
> 
> 标签：java, spring, autowired

> **可能重复：**
> [每次都获取引用 bean 的新 bean 实例](https://stackoverflow.com/questions/11437989/getting-new-bean-instances-of-referencing-beans-every-time)

每次获取自动装配类的新实例的一种非常简单的方法是什么？

我探索了会话、请求、原型、@resource。似乎没有一个能提供预期的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:33:38.403

利用`@Scope("prototype")`

```
@Service
@Scope("prototype")
public class YourService{} 
```

# apache - 将所有请求重定向到 index.php，除了 /files 子目录

> ID：14388481
> 
> 赞同：2
> 
> 时间：2013-01-17T21:30:50.007
> 
> 标签：apache, .htaccess, mod-rewrite

到目前为止，我对 .htaccess 文件知之甚少。我想将所有请求重定向到我的根文件夹中的一个 index.php 文件，除非 url 链接到存在且位于 files 文件夹中的文件。（例如example.com/files/picture.png） 我想在根目录中仅使用htaccess 文件来实现这一点，如果需要，在文件目录中使用一个。此外，我不想显示权限被拒绝消息。

现在我有这个：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule . index.php [L] 
```

但如果 url 引用的文件存在，它不会将一个重定向到 index.php 文件。有什么帮助吗？我在互联网上寻找，但找不到任何东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T22:30:56.463

像这样的东西：

```
RewriteEngine on

RewriteCond %{REQUEST_URI}  /img/.+(gif|png|jpg)$
RewriteRule .* - [L]

RewriteCond %{REQUEST_URI}  /css/.+(css|png)$
RewriteRule .* - [L]

RewriteCond %{REQUEST_URI}  /js/.+css$
RewriteRule .* - [L]

RewriteCond %{REQUEST_URI}  /js/.+(js|htm)$
RewriteRule .* - [L]

RewriteCond $1 !^(index\.php|robots\.txt)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

除 css javascript 和图像文件外，所有请求都将通过 index.php 文件。我用于 codeigniter 框架的这个 .htaccess 文件，所以它可能会根据您的情况有所不同。

# python - 对于带有 Fastspring 的 Python 应用程序，我应该使用什么序列号许可解决方案？

> ID：14388482
> 
> 赞同：4
> 
> 时间：2013-01-17T21:30:57.403
> 
> 标签：python, licensing

编辑：有人可以解释为什么这是“离题”吗？我认为它非常清楚地遵循了常见问题解答中列出的指导方针。有什么我想念的吗？

我一直在 PyQt（python 2.7，PyQt 4.9.5）中创建一个 Windows 桌面应用程序，并且即将发布该软件以供销售。是时候为基于许可/序列号的软件激活添加某种系统了。该软件是一种企业对企业产品，零售价约为 250 美元。

我一直在考虑使用 Fastspring，它们提供与以下内容的集成：

1.  AquaticPrime
2.  可可FOB
3.  GameShield 和软件通行证
4.  Yummy Interactive 的 SoftwareShield
5.  Soraco 的快速许可证管理器
6.  软包装
7.  Concept Software的SoftwareKey系统

提供此功能有哪些不错的选择？我遇到的一些事情是它们似乎都没有提供 python API，所以我必须弄清楚如何将它们的东西与我的 python 代码集成。我从来不需要这样做，因此易于与 Python 集成将是一个重要因素，成本也是如此。我觉得没有必要阻止任何人盗版我的软件，我只是想让企业保持诚实，以便他们购买正确数量的席位。最后要考虑的事情是，将来我可能想让它跨平台，理想情况下我不会将自己锁定在 Windows 上。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:50:09.360

One thing to note is that it is relatively easy to decompile and reverse engineer Python bytecode and remove any protection you put into it, so it's usually not worth it to spend too much effort and time on implementing a crack-proof protection. You just want to put enough to keep people honest.

If your concern is that businesses buy the correct number of seats, one basic protection mechanism is to use a public key mechanism to put a digital signature to a message using a private key on your licensing server. The message is just a random string and some uniquely identifying information that restricts the machine that the license key is valid for (e.g. MAC address, etc), and perhaps a timestamp if you want to expire the key. This message and the signature is then encoded in a string that your customers put into your program, which validate the license key by verifying that signature matches the message and the message matches the machine.

There are simpler schemes if all you care is that the user has a key (not that they have a different key for different machines); you can simply use a totally random string for the message.

This scheme is secure as long as the user does not reverse engineer your code. It can be bypassed by reverse engineering the public key in your program with their own public key. It can also be bypassed by tampering the information used to identify the computer, e.g. MAC address; tampering these informations may allow multiple installations using the same key.

# android - 基本缓存负载/平衡 Akamai/Android

> ID：14388483
> 
> 赞同：0
> 
> 时间：2013-01-17T21:31:03.033
> 
> 标签：android, jakarta-ee, akamai

在 JBoss 服务器上，有一个 JSP。让我们称它为takestoolong.jsp
它会进行一些最多需要30-45 秒的处理。（是的，我知道它应该被优化）。然后它返回。出于显而易见的原因，30-45 秒对于用户体验来说被认为太长了。因此引入了 Akamai 和负载均衡器，以便可以通过缓存请求结果来减少此时间。然而，在某些时候，jsp 返回的内容会发生变化，并且缓存会超时。您如何防止用户再次看到 20-45 秒的下载时间？特别是如何配置 Akamai，使其不使用 ip 或其他因素，而是将处理后的结果返回给 android 设备/用户，而不会有 30 多秒的延迟？如何为 Android 设备配置 Akamai？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:32:18.437

我的建议是将takestoolong.jsp与用户完全隔离，这样他们就只能看到缓存的结果......

要做到这一点，您需要一个辅助进程来向 taketoolong.jsp 页面发出请求（它可能是一个简单的 cron 作业，它会访问服务并将结果写入 html 页面），然后将用户（或 Akamai 指向服务器传递 HTML 的静态片段。

这样，您可以在用户看到延迟的情况下刷新结​​果，即使内容确实发生变化，直到提交写入的那一刻，用户仍然会看到旧内容，但没有延迟

[FWIW 使用这种方法来处理类似的问题......巨大、极其复杂的 SQL 查询必须从 SQL Server 获取数据，然后针对 MySQL 数据库运行一堆子查询并整合响应。通过使用中间输出页面并依赖 IIS 和浏览器缓存缓存，用户有时会拥有稍微更多陈旧的数据，这是绝对事实，但他们从未接触过底层查询的实际响应时间]

# loops - 批处理脚本中的 for 循环增加两个或多个变量

> ID：14388486
> 
> 赞同：2
> 
> 时间：2013-01-17T21:31:19.710
> 
> 标签：loops, batch-file

是的，批处理脚本。我知道。对不起。

最终目标是生成一个包含 XML 元素的文件。到目前为止，这些物品都是手工制作的，但一定有更好的方法。我的第一个想法是做一个批处理脚本。到目前为止，我一直在做的是复制/粘贴，手动将 +1 添加到 id、page 和 src="page_#" 项目。xml 文件只包含 40 个条目时很好。当我们超过 100 或更多时，情况就不太好了。

目标：需要在下面增加元素，例如**navPoint id=#**、**Page #**和**内容 src=page_#**：

```
<navPoint id="1"><text>Page 1</text><content src="page_1.html"></navPoint> 
```

我有一个可以循环和更新 ONE 变量的工作批处理脚本，因此它是：

```
echo
for /l %%x in (1, 1, 8) do (
echo ^<navPoint id="navPoint-%%x"^>^<navLabel^>^<text^>Page %%x^</text^>^</navlabel^>^<content src="page_%%x.html"/^>^</navPoint^>)>>C:\Users\me.txt 
```

最后一部分 >>C:\Users\me.txt 将其发送到 txt 文件。

**但是，**我希望页码从 2 开始，而不是 1。我的批处理脚本运行良好，%%x 从 1 开始并均匀递增。我需要循环中的另一个大于 %%x 的变量。

所以结果是：

```
<navPoint id="1"><text>Page 2</text><content src="page_1.html"></navPoint> 
```

下一个结果是：

```
<navPoint id="2"><text>Page 3</text><content src="page_2.html"></navPoint> 
```

ETC...

这如何在批处理脚本中完成？我以为它会像**%%x+1**一样简单，但事实并非如此......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:56:56.660

1.  你可以用`set /a`. `help set`从命令行执行以阅读它。

2.  如果在块内设置变量（例如*if*、*for*），则需要使用 启用延迟变量扩展`setlocal EnableDelayedExpansion`。然后使用`!`而不是`%`扩展变量。如果您不在代码块范围内，则可以返回使用`%`. `help set`还将告诉您有关延迟扩展的信息。

使用这两条信息，您可以将代码更改为此以获得您想要的：

```
@echo off
setlocal EnableDelayedExpansion
for /l %%x in (1, 1, 8) do (
    set /a PAGENUM=%%x+1
    echo ^<navPoint id="navPoint-%%x"^>^<navLabel^>^<text^>Page !PAGENUM!^</text^>^</navlabel^>^<content src="page_%%x.html"/^>^</navPoint^>
)>>C:\Users\me.txt 
```

# objective-c - Git 和 XCode：合并 .xcodeproj 会给出二进制警告

> ID：14388493
> 
> 赞同：0
> 
> 时间：2013-01-17T21:31:44.980
> 
> 标签：objective-c, xcode, git

我正在使用分支并希望与我的主人合并，但我的 .xcodeproj 中的文件导致了巨大的问题。

不断收到有关覆盖它们的错误，它们是二进制文件等。

我需要做什么才能永远不必担心这个？它快把我逼疯了！

注意：我的 master 中有一个 .gitignore 文件，它忽略了这些文件，但不在我的分支中。不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:36:10.977

在项目的根目录下（例如，与 相同的目录`.git`），添加一个 git ignore 文件

```
.gitignore 
```

用一句话说

```
.xcodeproj 
```

然后`.xcodeproj`从仓库中删除文件...

```
git rm --cached /path/to/.xcodeproj 
```

然后添加 .gitignore 文件

```
git add .gitignore 
```

然后提交

```
git commit -m "Removed .xcodeproj; added ignore pattern to excluded it" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:35:46.327

您可以使用 .gitignore 文件来指定要被 git 忽略的文件。

# java - 自定义 ViewPager 以允许子 GoogleMap 控件水平滚动

> ID：14388494
> 
> 赞同：5
> 
> 时间：2013-01-17T21:31:49.563
> 
> 标签：java, android, android-viewpager, google-maps-android-api-2

我在 ViewPager 的 Fragment 内使用 GoogleMap (v2 api)。我遇到的最初问题是 ViewPager 正在捕获所有水平滚动手势，因此只有在用户从垂直或对角方向开始时才能拖动地图。所有水平拖动都被`ViewPager`. 我发现解决方案是创建一个派生`ViewPager`类并覆盖该`canScroll`方法。被拖动的 View 被传递给这个方法，因此您可以根据它的 View 类型做出决定。

就我而言，我的 Fragment 是一个`SupportMapFragment`（来自`com.google.android.gms.maps`包），它给了我一个 GoogleMap 对象来与之交互。但是，我在 ViewPager 的`canScroll`方法中收到的实际控制是`maps.j.b`. 我已经用我的自定义 ViewPager 类中的以下代码解决了这个问题。但是，当我对此一无所知时，我对检查这个类名感到不舒服。什么是maps.jb？这是在运行时动态创建的类吗？在框架的未来更新中，类型是否可能发生变化？仅给定 View 对象，是否有更可靠的方法来检查拖动是否由地图控件启动？

```
@Override
protected boolean canScroll(View v, boolean checkV, int dx, int x, int y) {
    if(v.getClass().getName().equals("maps.j.b")) {
        return true;
    }
    return super.canScroll(v, checkV, dx, x, y);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:13:04.763

> 这是在运行时动态创建的类吗？

这可能是 ProGuard 重命名的输出。

> 在框架的未来更新中，类型是否可能发生变化？

AFAIK，是的。我不知道 ProGuard 保证名称在构建之间保持不变。

请注意，这将取决于库项目。当您使用新版本的库项目时，类名可能会更改。但是，由于这与您自己的应用程序相关联，因此在紧要关头，您可以坚持使用名称游戏，并且只需要在使用新版本的库项目时修复名称。

话虽如此，我同意基于名称的匹配是 icky。

> 仅给定 View 对象，是否有更可靠的方法来检查拖动是否由地图控件启动？

好吧，因为这不是 a `MapView`，所以我们无法知道 a 到底`maps.j.b`是什么。我们知道它不是 a `MapView`，因为它没有命名`MapView`，并且 Google 只保留了该名称（`-keep`大概是通过 ProGuard 配置中的指令），因此我们可以在我们的应用程序中使用它。

~~你可以尝试用你自己的来创建你自己`MapFragment`的`MapView`，看看你是否得到 a`MapView`而不是 a `maps.j.b`（这可能是`MapView`used by 的一些内部子类`SupportMapFragment`）。如果您通过了实际的`MapView`，那么您可以进行直接相等性检查以查看传入的对象是否是您`MapFragment`的`MapView`.~~

或者，您可以查看是否`instanceof`说 a`maps.j.b`是 a `MapView`。

~~随着时间的推移，这些都不能保证可靠，因为可以想象谷歌可以改变事情，以便将`MapView`其包裹在某些东西中。但是，我的猜测是它比生成的类名更可能是稳定的。~~

`maps.j.b`继承自`SurfaceView`。因此，半可靠地检测 a 是否`View`传入的一种方法`canScroll()`是测试 if `(v instanceof SurfaceView)`。如果 Maps V2 稍后执行其他操作（例如，`TextureView`在 API 级别 11+ 上扩展）或您的`ViewPager`页面有另一个`SurfaceView`（例如，a `VideoView`），则此操作会失败。

我已经就此提出[了一个问题](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4980)，试图获得一些稳定的方法来将此确定添加到 Maps V2 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-21T11:11:17.780

希望这对一年后有所帮助......在我的情况下，我通过忽略 View 对象解决了这个问题。您可以做的是通知 CustomViewPager 以便当前页面包含地图。

```
public class CustomViewPager extends ViewPager {
    @Override
    protected boolean canScroll(View v, boolean checkV, int dx, int x, int y) {
        if (this.containsMap()) {
            return true;
        }
        return super.canScroll(v, checkV, dx, x, y);
    }
} 
```

在我的情况下 containsMap() 只需检查当前页面是否对应于预定义的页面索引：

```
public boolean containsMap(){
    return getCurrentItem() == MAP_PAGE;
} 
```

但它可能更复杂：添加一个名为 setCanScrollIndex(int index, boolean canScroll) 的方法来保留对那些包含地图的页面的引用。在适当的时候从你的活动中调用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T18:58:57.530

首先，@Rich 感谢您分享您的解决方案 - 这是我一直在寻找的东西。我有一个视图寻呼机，其片段扩展 SupportMapfragment 是其项目之一。在我的解决方案中，我有一个自定义 XML 布局文件，因为我需要向片段添加一些额外的按钮。这是我的解决方案：

```
public class MapFragmentScrollOverrideViewPager extends ViewPager {

public MapFragmentScrollOverrideViewPager(Context context) {
    super(context);
}

public MapFragmentScrollOverrideViewPager(Context context, AttributeSet attrs) {
    super(context, attrs);
}

@Override
protected boolean canScroll(View v, boolean checkV, int dx, int x, int y) {
    if(v instanceof MapHoldingRelativeLayout) {
        return true;
    }
    return super.canScroll(v, checkV, dx, x, y);
} }

public class MapHoldingRelativeLayout extends RelativeLayout {

public MapHoldingRelativeLayout(Context context) {
    super(context);
}

public MapHoldingRelativeLayout(Context context, AttributeSet attrs) {
    super(context, attrs);
}

public MapHoldingRelativeLayout(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}  } 
```

片段布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    xmlns:android="http://schemas.android.com/apk/res/android">

    <Button 
        android:id="@+id/switchNearbyOffersButton"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="XXXX"
        />

    <xxx.view.MapHoldingRelativeLayout
        android:id="@+id/mapLayout"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_below="@id/switchNearbyOffersButton"
         />

</RelativeLayout> 
```

片段本身：

```
public final class NearbyOffersFragment extends SupportMapFragment {

    public static NearbyOffersFragment newInstance(String content) {
        NearbyOffersFragment fragment = new NearbyOffersFragment();
        return fragment;
    }

    private GoogleMap googleMap;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setUpMapIfNeeded();
    }

    private void setUpMapIfNeeded() {
        if (googleMap == null) {
            googleMap = getMap();
            if (googleMap != null) {
                setUpMap();
            }
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        final View rootView = inflater.inflate(R.layout.fragment_nearby_offers,
                container, false);
        final View mapFragmentLayout = super.onCreateView(inflater, container,
                savedInstanceState);
        MapHoldingRelativeLayout mapLayout = (MapHoldingRelativeLayout) rootView
                .findViewById(R.id.mapLayout);
        mapLayout.addView(mapFragmentLayout);
        return rootView;
    }
    @Override
    public void onResume() {
        super.onResume();
        setUpMapIfNeeded();
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
    }

    private void setUpMap() {
        googleMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
        googleMap.getUiSettings().setZoomControlsEnabled(true);
        googleMap.getUiSettings().setAllGesturesEnabled(true);
        CameraPosition cameraPosition = new CameraPosition.Builder()
                .target(new LatLng(41.474856, -88.056928))
                .zoom(14.5f)
                .build();
        googleMap.moveCamera(CameraUpdateFactory.newCameraPosition(cameraPosition));
    }
} 
```

由于原始 SupportMapFragment 的布局在我的自定义 RelativeLyout 内，因此您可以使用 instanceof 运算符而不是直接引用 maps.jb 类...

# android - 如何在 Android 中操作另一个类的视图？

> ID：14388498
> 
> 赞同：2
> 
> 时间：2013-01-17T21:31:57.993
> 
> 标签：android, android-layout, android-view

我有一个在单独的类中接收 SMS 的处理程序。执行处理程序时如何使其更改视图元素？

这是我的代码：

```
public class MainActivity extends MapActivity {
    MapView mapView;
    MapController mc;
    GeoPoint p;
    private int carNumber;
    private String langt;
    private String longt;
    CheckedTextView text;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        SmsReceiver smsreceiver = new SmsReceiver();
                draw();
    }

    public void draw() {
        mapView = (MapView) findViewById(R.id.mapView);
        LinearLayout zoomLayout = (LinearLayout) findViewById(R.id.zoom);
        @SuppressWarnings("deprecation")
        View zoomView = mapView.getZoomControls();

        zoomLayout.addView(zoomView, new LinearLayout.LayoutParams(
            LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        mapView.displayZoomControls(true);
        mc = mapView.getController();

        double lat = Double.parseDouble("31.977185185185185");
        double lng = Double.parseDouble("35.205925925925925");

        p = new GeoPoint((int) (lat * 1E6), (int) (lng * 1E6));

        mc.animateTo(p);
        mc.setZoom(17);
        MapOverlay mapOverlay = new MapOverlay();
        List<Overlay> listOfOverlays = mapView.getOverlays();
        listOfOverlays.clear();
        listOfOverlays.add(mapOverlay);

        mapView.invalidate();
    }
}
} 
```

这是 SMS Receiver 类：

```
public class SmsReceiver extends BroadcastReceiver {
    MapView mapView;
    MapController mc;
    GeoPoint p;
    private int carNumber;
    private String langt;
    private String longt;
    CheckedTextView text;

    public SmsReceiver(MapView mapView) {
        this.mapView = mapView;
    }
    private static final String SMS_RECEIVED = "android.provider.Telephony.SMS_RECEIVED";

    @SuppressLint("NewApi") @Override
    public void onReceive(final Context context, final Intent intent) {
        if (intent != null && SMS_RECEIVED.equals(intent.getAction())) {
            final SmsMessage smsMessage = extractSmsMessage(intent);
            processMessage(context, smsMessage);
        }
    }

    @SuppressLint("NewApi") private SmsMessage extractSmsMessage(final Intent intent) {
        final Bundle pudsBundle = intent.getExtras();
        final Object[] pdus = (Object[]) pudsBundle.get("pdus");
        final SmsMessage smsMessage = SmsMessage.createFromPdu((byte[]) pdus[0]);

        return smsMessage;
     }
} 
```

我想修改类`MapView`里面`SmsReceiver`。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:47:52.973

定义一个接口并使用回调让活动知道已收到一条短信。

```
public Interface SmsReceivedListener {
    void onSmsReceived(int arg1, string arg2); ..<----add arguments you want to pass back
} 
```

在您的短信课程中

```
ArrayList<SmsReceivedistener> listeners = new ArrayList<SmsReceivedistener>();

...

public void setSmsReceivedistener(SmsReceivedistenerlistener){
    listeners.add(listener);
} 
```

当您收到短信时

```
for (SmsReceivedistener listener:listeners){
   listener.onSmsReceived(arg1, arg2);
} 
```

在您的活动中：

```
public class MainActivity extends MapActivity implements SmsReceivedListener {

...

@Override
public void onCreate(Bundle savedInstanceState) 
{
    ...
    smsReceiver.setSmsReceivedistener(this);
    ...
}

public void onSmsReceived(int arg1, string arg2){
   // do whatever you need to do
} 
```

全部来自记忆，所以请原谅拼写错误，您应该通过添加 removeSmsReceivedistener 并检查您没有在 setSmsReceivedistener 中两次添加相同的侦听器来改进 SMS 类。

笔记。因为您使用接口，所以任何类（不仅仅是 Activity）都可以实现它，因此您可以在应用程序的任何位置进行更新。smsReceiver 类不知道也不关心。它只是调用侦听器，如果有的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-12T11:56:41.973

试试这个

```
TextView bt1 =m_activity.findViewById(R.id.textview1); 
```

在上面的示例中，视图 bt1 来自另一个类。您可以使用类实例访问 bt1 并获取 id。现在，对 bt1 实例做任何您想做的事情。

注意：确保 bt1 在另一个类中是公开的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T21:45:33.633

将此添加到您的 onReceive() 方法中：

```
if (context instanceof MainActivity) {
    //modify the map 
    ((MainActivity)context).findViewById(...);
} 
```

# java - Java 或 Scala 插件框架

> ID：14388499
> 
> 赞同：3
> 
> 时间：2013-01-17T21:32:00.867
> 
> 标签：java, plugins, osgi, classloader

我正在开发一个框架，可以将 jar 放入文件夹并扫描以后可以调用的函数。我的第一个实现使用了简单的 ClassLoader 方法，其中加载了 jar 并创建了类实例。这是插件架构。我遇到的问题是版本控制。例如，假设我的主机应用程序正在使用依赖于 org.joda 时间版本 1.6 的第三方库，并且插件依赖于同一（较新）库的 2.1 版。我尝试使用[Java 简单插件框架](http://code.google.com/p/jspf/)但它似乎没有使用自定义类加载器加载我的插件（这是我假设我需要克服版本冲突并实际加载 2.1 版本）。我的下一步是尝试 osgi。所以，问题是：这是正确的方法还是有一种我不知道的简单方法，我来自.net世界，不太了解java，但我记得dll地狱，这似乎是它的java版本。顺便说一句，我正在使用 Scala 进行开发，但这与主要问题无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T18:38:19.960

我有一个类似的用例。我想要一个与您描述的非常相似的简单插件框架，但还没有准备好跳入 OSGi。我去了自定义类加载器路线，但遇到了和你一样的问题。我确实尝试了[Parent-Last Classloader](https://stackoverflow.com/questions/5445511/how-do-i-create-a-parent-last-child-first-classloader-in-java-or-how-to-overr)，它确实有助于解决一些 jar 冲突。这可能是需要调查的事情。我相当认真地研究了 CI Server [Jenkins](http://jenkins-ci.org/)为他们的插件系统所做的工作 - 并发现[这篇文章](https://groups.google.com/forum/#!msg/jenkinsci-dev/RkDu1teCiHo/nWMseSn2Iz8J)很有趣。

最后，我需要能够跟踪服务何时来来去去，拥有一个服务注册中心，等等……并意识到我正在重新发明 OSGi。我切换到纯 OSGi，即使有学习曲线并且有时会很痛苦，但我很高兴我做到了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T04:26:58.687

尝试[ScalaScriptEngine](https://github.com/kostaskougios/scalascriptengine/tree/master)。它允许您从源文件动态加载和编译类，并支持相当多的高级功能。

# oracle - 根据另一个表的记录是否存在并且 > 60 来更新表

> ID：14388500
> 
> 赞同：0
> 
> 时间：2013-01-17T21:32:08.763
> 
> 标签：oracle, sqlplus

```
update COLORS
set    COLORS.AR = 'RED'
where  COLORS.GCRS = 'FIRST' 
and    (case when max(NEWAPP."AGE") > 60 
and    count(NEWAPP."AGE") > 0) 
```

我收到一条错误消息，提示“此处不允许使用组功能”

有谁知道我能做些什么来防止这个错误？

标题几乎说明了我所能达到的目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:49:06.847

如果表之间真的没有关系

```
UPDATE colors
   SET colors.ar = 'RED'
 WHERE colors.gcrs = 'FIRST'
   AND EXISTS( SELECT 1
                 FROM newapp
                WHERE age > 60 ) 
```

但是，在适当的数据模型中，如果您想要执行这样的不相关子查询，这将是非常不寻常的。通常，会有一些列将`colors`表与`newapp`表相关联，并且您需要在`EXISTS`子查询中为该关系添加一个额外的谓词。

# heroku - 在 Heroku 上运行时，如何配置 Meteor 以使用 Amazon SES？

> ID：14388501
> 
> 赞同：7
> 
> 时间：2013-01-17T21:32:08.877
> 
> 标签：heroku, smtp, meteor, amazon-ses

我想使用 Meteor 提供的内置电子邮件方法，但我需要我的应用程序在 Heroku 上运行并使用 Amazon SES 的 smtp 端点来传输我的消息。

我正在使用 Meteorite 构建包和 accounts-password 包。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-18T14:32:45.930

按照以下说明使用亚马逊 ses 从 heroku 正确发送流星电子邮件

1) 通过 aws 控制台设置 smtp 访问，获取您的 smtp 凭据

2）使用javascript控制台（chrome dev tools/firebug）运行

`encodeURIComponent("SES_SMTP_USERNAME")`

`encodeURIComponent("SES_SMTP_PASSWORD")`

对用户名/密码进行编码以在您的 smtp url 中使用

3）使用生成的字符串来构建您的 smtp url，如下所示

`smtp://ENCODED_USER:ENCODED_PASS@SES_SMTP_URL:465`

4) 设置 MAIL_URL 变量来告诉meteor使用这个方法发送邮件

`heroku config:add MAIL_URL=YOUR_SMTP_URL`

（不要用 qoutes 覆盖 url）

5）通过

`Accounts.emailTemplates.from = "SENDER_NAME <SENDER_EMAIL>";`

* * *

这将允许 Meteor 默认电子邮件方法正常运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:27:44.637

除了您在要点中建议的内容之外，您还可以使用`Meteor.http`带有 SES API 的方法并发送 POST/GET 请求。

完整的 API 文档位于[http://docs.aws.amazon.com/ses/latest/DeveloperGuide/QueryInterface.Examples.html](http://docs.aws.amazon.com/ses/latest/DeveloperGuide/QueryInterface.Examples.html)

当然这是手动解决方案，不会使用内置的流星邮件方法。但是，可以通过重新定义邮件功能来纠正它`Email.send = function(...`

### 更新

您还可以在大气上使用 email-ses 包

```
mrt add email-ses 
```

更多信息在这里：[https ://atmospherejs.com/package/email-ses](https://atmospherejs.com/package/email-ses)

# javascript - 正则表达式中的通配符

> ID：14388502
> 
> 赞同：3
> 
> 时间：2013-01-17T21:32:10.113
> 
> 标签：javascript, regex

我想创建一个正则表达式来查找单词*tjuv*（瑞典语中的小偷），它可以与其他单词组合（参见下面的示例）和/或以不同的形式出现。

例子：

*   赛克尔朱夫
*   比尔朱夫
*   楚瓦尔纳
*   因布罗茨朱夫斯

下面的一个适用于*tjuv*和*tjuvs*（小偷的），但是其他的变位以及与其他词的组合呢？

```
/tjuv(?:s){0,1}/ig 
```

既然我已经向您学习了一点瑞典语，那么您向我学习一些正则表达式是公平的；-)

**编辑：**更具体地说，实际上我认为没有任何情况不应该与 tjuv 一词匹配。

我正在做的是搜索存在单词*tjuv*的短语，例如（翻译成英文）：

```
1\. När en familj kom hem från en utlandssemester upptäckte de att en inbrottstjuv
   hade varit i farten. <- MATCH!

2\. På juldagen hade en cykeltjuv varit framme och stulit en cykel. <- MATCH

3\. Violer är blå och rosor är röda <- No 'tjuv' and therefor no match 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-17T21:44:45.203

我认为这就是你想要的，“tjuv”这个词和前面和/或前面的其他字母：

```
/[a-z]*tjuv[a-z]*/ig 
```

[在 Regexr 上](http://regexr.com?33enr)查看

But`[a-z]`是一个仅涵盖 ASCII 字符 a 到 z 的字符类（由于`i`修饰符而与大小写无关）。但我认为瑞典语也有一些字符不在该范围内。

所以无论你

*   将缺少的字符添加到字符类

或者

*   取决于您可以使用的正则表达式风格`\p{L}`。

    `\p{L}`是一个[Unicode 代码点](http://www.regular-expressions.info/unicode.html#prop)，匹配任何语言的每个字母。然后看起来像：

    ```
     /\p{L}*tjuv\p{L}*/ig 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T21:47:22.960

我不这么认为

```
/.*tjuv.*/ 
```

很好。它匹配所有文本。这个更好：

```
\w*(tjuv)\w* 
```

这匹配您列表中的所有单词。（以及所有带有“tjuv”的单词）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T21:38:03.043

据我了解这个问题，您正在寻找包含before 和/或 after 的*任何*字符串的单词`tjuv`。在正则表达式中，您通常可以使用点`.`来表示任意字符。因此`tjuv.`匹配`tjuvA`, `tjuvX`, `tjuvs`, ... 如果您想要任意数量的此类字符，请使用星号`*`。`tjuvs.*`你可以匹配, `tjuvABC`, `tjuvs`（`tjuv`然后星号扩展为零字符！），...

所以我认为`/.*tjuv.*/`可能是你想要的东西。但是，这里`.`也匹配空白字符，因此正则表达式也匹配`something xxxtjuvyyy somethingelse`，这可能不是您想要的。

看到一些应该匹配（或不应该匹配）的单词可能会很好。不仅如此，指定您使用的编程语言是一个好主意。

# java - Android - 每单位时间执行操作

> ID：14388506
> 
> 赞同：0
> 
> 时间：2013-01-17T21:32:29.120
> 
> 标签：java, android, timer

这更像是一个无知而不是无能的问题。我正在尝试构建一个计时器应用程序，但发现 CountDownTimer 对象对于我的目的来说太不准确了。因此，我想手动创建计时器，只需勾选每个时间单位并在每个滴答上执行某种操作（不必倒计时，因为我将手动处理） - 是否有内置对象要做这个（CountDownTimer 除外），还是我必须使用线程/睡眠？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:05:35.750

使用 a`Handler`和`postDelayed()`方法。准确且易于使用。您只需要在每个循环之后继续放置回调，但这并不太繁琐，并且可以让您根据需要调整间隔。

```
Handler timeThing = new Handler();    
Runnable timedWorker = new Runnable {
    public void run(){
        // Do work
        timeThing.postDelayed(this, 10000); // do it again later
    }
};
timeThing.postDelayed(timedWorker, 10000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:07:58.710

使用`AsyncTask`和`Thread.sleep()`：

```
AsyncTask task=new AsyncTask<Void,Void,Void>() {
    @Override
    protected Void doInBackground(Void... params) {
        while (!isCancelled()) {
            try {
                Thread.sleep(1000);
                publishProgress();
            } catch (InterruptedException e) {
                break;
            }
        }
        return null;
    }

    @Override
    protected void onProgressUpdate(Void... values) {
        //do something here    
    }
};
//task.execute(); to start
//task.cancel(); to stop 
```

Your `onProgressUpdate()` will be called every N seconds (1000 in this example).

# ruby-on-rails - Rails Server，新文件不存在

> ID：14388509
> 
> 赞同：0
> 
> 时间：2013-01-17T21:32:38.723
> 
> 标签：ruby-on-rails

![在此处输入图像描述](../Images/c3e59035bb84e35b293c3d95a54dcda3.png)

我正在阅读 Ruby on Rails 教程，现在它正在生成控制器。（我相信我在本地服务器上..开始做：

```
$rails s 
```

当我查看 TextMate 时，所有新文件上都有一个“禁止进入”标志，我认为这不是实时的。当我尝试提取地址时，它们也不起作用。我如何让他们活着？

（编辑：还添加了图片..当我尝试转到页面时，它说：路由错误

没有路线匹配 [GET] “地址”

尝试运行 rake 路线以获取有关可用路线的更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:55:15.643

Rails 不应该*生成控制器*。

我的建议是重新开始

```
rails new myApp

cd myApp

rails generate scaffold Post name:string title:string content:text

rake db:migrate 

rails s 
```

在您的浏览器指向`http://localhost:3000`

然后你会看到 rails 欢迎页面

如果您将浏览器指向`http://localhost:3000/posts`您将进入帖子索引页面

并阅读此[导轨指南](http://guides.rubyonrails.org/getting_started.html)

**更新**

您是否正在从另一个用户运行 rails 代？看起来您没有对 textmate 文件的读写权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:53:50.717

尴尬的一课。服务器连接到不同的目录。显然这个符号不是读/写的..虽然不确定它是什么

# regex - 正则表达式匹配变量名但不匹配字符串值

> ID：14388514
> 
> 赞同：-2
> 
> 时间：2013-01-17T21:32:47.777
> 
> 标签：regex, variables, identifier

很难找到。我需要为它编写词法分析器和分词器。我在查找匹配变量名但不匹配字符串值的正则表达式时遇到问题。

以下内容*不应*匹配：

```
"ala ma kota"
5aalaas 
```

这*应该*匹配：

```
ala_ma_KOTA999653
l90
a 
```

我已经得到了这样的东西：

```
[a-zA-z]\w+ 
```

但我不知道如何`"`从比赛的开头和结尾排除字符。

感谢您的任何回复或谷歌链接（我找不到它 - 它可以来自 lmgify ;)）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:51:37.690

我将变量名解释为最小长度为 1 并以字母开头的所有单词字符序列。你的正则表达式几乎是正确的：

```
^[A-Za-z]\w*$ 
```

# android - 可以为 ListView 的 cacheColorHint 设置选择器吗？

> ID：14388515
> 
> 赞同：0
> 
> 时间：2013-01-17T21:32:48.247
> 
> 标签：android, listview, android-listview, selector, drawable

我想将选择器设置为 ListView 的 colorCacheHint：

```
<ListView
    android:id="@+id/listview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:cacheColorHint="@color/selector_background" /> 
```

但是将其引用为缓存颜色提示无效。

是否不可能根据 ListView 的状态更改 cacheColorHint ？还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:37:18.263

我不相信您可以将选择器用于缓存颜色提示。这些不同的状态究竟是什么？为单个项目设置状态是有意义的，例如按下、聚焦等，但为什么这对 ListView 本身有意义？

**编辑**

大概您希望根据您自己的（域）逻辑来切换事物的外观，而不是让 UI 更改依赖于定义选择器时使用的预定义状态。换句话说，如果您使用选择器作为缓存颜色提示，您希望使用哪一种状态？android:state_pressed、android:state_focused、android:state_hovered、android:state_selected 等等？我认为您需要根据您的逻辑直接设置缓存颜色提示：

```
int cacheColorRes = myState == foo? R.drawable.something : R.drawable.somethingElse;
mView.setCacheColorHint(cacheColorRes) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:28:01.483

我最终没有仔细阅读源代码，但我凭经验同意@LuxuryMode 确实不可能将缓存颜色提示设置为选择器。

我最终将这个添加到`refreshDrawableState`我的自定义视图中。诀窍是结合`getColorStateList`并`getColorForState`允许您从选择器中应用正确的颜色。

```
 ColorStateList listBackground = view.getContext().getResources().getColorStateList(R.color.list_background);
    int color = listBackground.getColorForState(view.getDrawableState(),listBackground.getDefaultColor());

    try {
        view.setCacheColorHint(color);
    } catch (IndexOutOfBoundsException e) {
        //Early versions of Android have a bug in setCacheColorHint
        // http://code.google.com/p/android/issues/detail?id=12840
    } 
```

# linux - grep 在表达式中的行为不为 0

> ID：14388517
> 
> 赞同：0
> 
> 时间：2013-01-17T21:32:50.717
> 
> 标签：linux, grep, centos

我确信这里对我的问题有非常简单的解释，但这让我感到困惑。

我正在使用 centos 标准 grep 在文件中搜索以下字符串：

```
0.000 kB / 0.0 sec 
```

我很确定我以前做过一百万次，从来没有遇到过问题，但现在我明白了：

```
grep "0.000 kB / 0.00 sec" flash.log

672.881 kB / 0.95 sec 
```

问题不是“/”，因为我也试过这个：

```
grep "000" flash.log

672.881 kB / 0.95 sec 
```

据我了解， 0 无论如何都不是特殊字符，即使它似乎在这里反应为一个？

我知道我可以用这个来解决这个问题：

```
grep -e "0.000 kB / 0.00 sec" flash.log 
```

但是只是不明白使用 -e 表示模式有什么区别，或者 0 的意义是什么，或者 grep 是如何解释它的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T22:02:43.347

您最初匹配的行可能有一个`^M`as 行结尾。`cat -A`通过or `less`or管道输出您的 grep 输出`hd`以实际查看您得到的内容，而不是让您的终端解释它。因为`^M`表示回车（而*不是*换行，谢谢 Carl），所以光标跳到行首并覆盖实际匹配。这是我的示例 flash.log，其行为与您描述的一样：

```
0.000 kB / 0.00 sec^M672.881 kB / 0.95 sec 
```

`vi -b`用或来查看`cat -A`。

# c++ - 无法使用嵌套 lambda 捕获静态成员

> ID：14388520
> 
> 赞同：2
> 
> 时间：2013-01-17T21:32:59.900
> 
> 标签：c++, visual-studio-2010, visual-c++, c++11, lambda

我有一个嵌套 lambda 函数的问题，它看不到静态类成员。由于我无法理解的原因，Visual Studio 2010 给了我一个 C2065（未声明的标识符）。

这是一个突出我的问题的简单案例：

```
#include <algorithm>
#include <vector>

using namespace std;

struct foo
{
    void do_some()
    {
        std::vector<int> a;
        std::vector<int> b;

        for_each( a.begin(), a.end(), [&] ( const int& m )
            {
                // works
                auto j = _i + 1;

                for_each( b.begin(), b.end(), [&] ( const int& n )
                    {
                        **// doesn't work**
                        auto k = _i + 1;
                    } );
            } );
    }

    static int _i;
};

int main(int argc, char* argv[])
{
} 
```

有人知道我在做什么错吗？

谢谢，克里斯蒂安

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T15:28:54.573

Probably a compiler bug (fixed in VC++ 2012). This works:

```
auto k = ::foo::_i + 1; 
```

# assembly - ASM 块成函数和 ABI x86-64

> ID：14388523
> 
> 赞同：1
> 
> 时间：2013-01-17T21:33:12.203
> 
> 标签：assembly, x86-64, abi

我为大整数编写了一个非常好的整数库，但限制为 512 位（由于各种原因比 GMP 更快）。我正在尝试将 lib 概括为大尺寸。所以我必须遍历 adcq 指令。

```
// long addition little indian order due the technique incq-jnz
// I can not use compare because it destroy the Carry Bit
template<int n>
void test_add(boost::uint64_t*, boost::uint64_t* ){    
    asm volatile (
        "clc                                     \n"
        "movq %0, %%rcx                          \n"
    "loop:                                       \n"
        "movq 8(%%rsi,%%rcx,8), %%rax            \n"  /* original -8(%%rsi,%%rbx,8) */
        "adcq %%rax           , 8(%%rdi,%%rcx,8) \n"  /* original -8(%%rsi,%%rbx,8) */
        "incq %%rcx                              \n"  /* original decq */
    "jnz loop                                    \n"
        :   
        :"g"(n)
        :"rax","rcx","cc","memory"
    );  
}

int main(int argc, char* argv[]) {
boost::uint64_t c[4],d[4];

c[0] = -1; 
c[1] = -1; 
c[2] = -1; 
c[3] =  0;  

d[0] = 1;
d[1] = 0;
d[2] = 0;
d[3] = 0;

test_add<-4>(&d[3],&c[3]); // <-- BigEndian to LittleEndian 
```

这个东西在调试模式 -O0 下运行良好，但是一旦我使用优化，segfault/

我不太明白，因为我尊重 rsi 和 rdi 的 ABI，clobber 寄存器，使用好的寄存器，所以我用 GCC -O0 -S 和 -O2 -S 编译

对于 -O0 -SI 得到

```
 3 .globl main
 4         .type   main, @function
 5 main:
 6 .LFB1:
 7         .cfi_startproc
 8         .cfi_personality 0x3,__gxx_personality_v0
 9         pushq   %rbp
 10         .cfi_def_cfa_offset 16
 11         .cfi_offset 6, -16
 12         movq    %rsp, %rbp
 13         .cfi_def_cfa_register 6
 14         subq    $80, %rsp
 15         movl    %edi, -68(%rbp)
 16         movq    %rsi, -80(%rbp)
 17         movq    $-1, -32(%rbp)
 18         movq    $-1, -24(%rbp)
 19         movq    $-1, -16(%rbp)
 20         movq    $0, -8(%rbp)
 21         movq    $1, -64(%rbp)
 22         movq    $0, -56(%rbp)
 23         movq    $0, -48(%rbp)
 24         movq    $0, -40(%rbp)
 25         leaq    -32(%rbp), %rax
 26         leaq    24(%rax), %rdx
 27         leaq    -64(%rbp), %rax
 28         addq    $24, %rax
 29         movq    %rdx, %rsi
 30         movq    %rax, %rdi
 31         call    _Z8test_addILin4EEvPyS0_
 32         movl    $0, %eax
 33         leave
 34         .cfi_def_cfa 7, 8
 35         ret
 36         .cfi_endproc
 37 .LFE1:
 38         .size   main, .-main
 39         .section              .   enter code here  `enter code here`text._Z8test_addILin4EEvPyS0_,"axG",@progbits,_Z8test_addILin4EEvPyS0_,comdat
 40         .weak   _Z8test_addILin4EEvPyS0_
 41         .type   _Z8test_addILin4EEvPyS0_, @function
 42 _Z8test_addILin4EEvPyS0_:
 43 .LFB2:
 44         .cfi_startproc
 45         .cfi_personality 0x3,__gxx_personality_v0
 46         pushq   %rbp
 47         .cfi_def_cfa_offset 16
 48         .cfi_offset 6, -16
 49         movq    %rsp, %rbp
 50         .cfi_def_cfa_register 6
 51         movq    %rdi, -8(%rbp)
 52         movq    %rsi, -16(%rbp)
 53 #APP
 54 # 14 "test.cpp" 1
 55         clc
 56 movq $-4, %rcx
 57 loop:
 58 movq 8(%rsi,%rcx,8), %rax
 59 adcq %rax           , 8(%rdi,%rcx,8)
 60 incq %rcx
 61 jnz loop
 62 
 63 # 0 "" 2
 64 #NO_APP
 65         leave
 66         .cfi_def_cfa 7, 8
 67         ret
 68         .cfi_endproc
 69 .LFE2:
 70         .size   _Z8test_addILin4EEvPyS0_, .-_Z8test_addILin4EEvPyS0_
 71         .ident  "GCC: (GNU) 4.4.6 20120305 (Red Hat 4.4.6-4)"
 72         .section        .note.GNU-stack,"",@progbits 
```

第 20-30 行我们看到编译器重新组织堆栈以将 arg 传递到 rsi 和 rdi（第 29-30 行）和调用。与 ABI 一样完美

如果现在我查看我得到的优化版本

```
 1         .file   "test.cpp"
  2         .text
  3         .p2align 4,,15
  4 .globl main
  5         .type   main, @function
  6 main:
  7 .LFB1:
  8         .cfi_startproc
  9         .cfi_personality 0x3,__gxx_personality_v0
  10 #APP
  11 # 14 "test.cpp" 1
  12         clc
  13 movq $-4, %rcx
  14 loop:
  15 movq 8(%rsi,%rcx,8), %rax
  16 adcq %rax           , 8(%rdi,%rcx,8)
  17 incq %rcx
  18 jnz loop
  19 
  20 # 0 "" 2
  21 #NO_APP
  22         xorl    %eax, %eax
  23         ret
  24         .cfi_endproc
  25 .LFE1:
  26         .size   main, .-main
  27         .ident  "GCC: (GNU) 4.4.6 20120305 (Red Hat 4.4.6-4)"
  28         .section        .note.GNU-stack,"",@progbits 
```

再见了ABI，我不明白。堆栈由什么管理？？？？

ASM 大师有想法吗？我拒绝把函数放到一个独立的文件中，很好的元编程精神。

干杯。

- - - - 编辑 ：

如果我把它放到一个循环中，我发现你的解决方案有一个错误：

```
#include <boost/cstdint.hpp> //boost type

template<long n>
void test_add(boost::uint64_t* x, boost::uint64_t const* y) {
    boost::uint64_t dummy;
    boost::uint64_t loop_index(n);
    __asm__ __volatile__ (
        "clc\n\t"
        "1:\n\t"
        "movq (%[y],%[counter],8), %[dummy]\n\t"
        "adcq %[dummy], (%[x], %[counter], 8)\n\t"
        "incq %[counter]\n\t"
        "jnz 1b\n\t"
        : [dummy] "=&r" (dummy)
        : [x] "r" (x), [y] "r" (y), [counter] "r" (loop_index)
        : "memory", "cc");
 }

int main(int argc, char* argv[]) {
    boost::uint64_t c[3],d[3];

    c[0] = -1; 
    c[1] = -1; 
    c[2] = -1; 
    c[3] =  0;  

    d[0] = 1;
    d[1] = 0;
    d[2] = 0;
    d[3] = 0;

for(int i=0; i < 0xfff; ++i)
    test_add<-4>(&c[4],&d[4]);

 return 0; 
```

}

将给出以下 ASM ：

```
 movq    $-4, %rdx <---------------------template parameter
      leaq    -32(%rsp), %rcx
      movq    $-1, -32(%rsp)
      movq    $-1, -24(%rsp)
      movq    $-1, -16(%rsp)
      movq    $0, -8(%rsp)
      movq    $1, -64(%rsp)
      movq    $0, -56(%rsp)
      movq    $0, -48(%rsp)
      movq    $0, -40(%rsp)
      .p2align 4,,10
      .p2align 3
  .L2: <-------- OUPUT loop
#APP
# 16 "main.cpp" 1
       clc
       1: <-------- INPUT loop
       movq (%rcx,%rdx,8), %rsi
       adcq %rsi, (%rsp, %rdx, 8)
       incq %rdx <------------ rdx++ -> (-4)++ (for the @nd iteration of L2 it is not reset to -4)
       jnz 1b

 # 0 "" 2
 #NO_APP
       addl    $1, %eax
       cmpl    $4095, %eax <----- test second loop
       jne     .L2 
```

对于输出循环的第二次迭代，rdx 不会刷新到 -4，因此 movq 指令给出了错误的读数，即段错误。我修补得非常糟糕（我用-4手动重置），我只是在jnz之后添加“movq $-4, %[counter]\n\t”，但我需要更通用的东西。将计数器重置为模板参数值是否存在约束？

目前更正的是：

```
template<long n>
void test_add(boost::uint64_t* x, boost::uint64_t const* y) {
    boost::uint64_t dummy;
    __asm__ __volatile__ (
        "clc\n\t"
        "movq %[counter_value], %[counter]\n\t" // set the counter to the template value, it's not sure if the function is reused
        "1:\n\t"
        "movq (%[y],%[counter],8), %[dummy]\n\t"
        "adcq %[dummy], (%[x], %[counter], 8)\n\t"
        "incq %[counter]\n\t"
        "jnz 1b\n\t"
        : [dummy] "=&r" (dummy)
        : [x] "r" (x), [y] "r" (y), [counter] "r" (n), [counter_value] "i" (n)
        : "memory", "cc");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T00:26:23.713

您应该使用约束来访问参数。`gcc`内部功能不需要遵循 ABI，即使这样做，也不需要在 asm 块执行时保持初始状态不变。当然，内联汇编的重点是让编译器内联它，然后甚至不会发生任何函数调用。（许多人错误地认为内联意味着“*嵌入在 C 源文件中*”，即使不需要实际的代码内联，也将其用作便利功能。）

`gcc`也很有能力把东西放在你想要的寄存器中（不是你特别关心计数器`rcx`，这里）。尽可能多地留给编译器通常也是一个好主意，以便它可以进行寄存器分配、循环展开和其他优化。不幸的是，我无法`gcc`生成`ADC`，所以这次 asm 块仍然存在。由于部分标志更新，也不推荐使用`inc`，但我现在没有看到明显的解决方法。

最后，如果您传递地址，您`d[3]`将访问不是您想要的项目。你应该通过。`d[-1]``d[2]``d[4]`

固定版本可能如下所示（带有命名参数）：

```
template<long n>
void test_add(boost::uint64_t* x, boost::uint64_t* y) {
    boost::uint64_t dummy, dummy2;
    __asm__ __volatile__ (
        "clc\n\t"
        "1:\n\t"
        "movq (%[y], %[counter], 8), %[dummy]\n\t"
        "adcq %[dummy], (%[x], %[counter], 8)\n\t"
        "incq %[counter]\n\t"
        "jnz 1b\n\t"
        : [dummy] "=&r" (dummy), "=r" (dummy2)
        : [x] "r" (x), [y] "r" (y), [counter] "1" (n)
        : "memory", "cc");
} 
```

请注意，`dummy`变量将被优化掉，同时允许`gcc`选择合适的寄存器，而不是强制它使用特定的寄存器。

* * *

**更新**：这是一个纯 C++ 版本，编译器可以完全展开和优化（包括在编译时计算东西！）。虽然在一般情况下，编译器的代码不如手写代码高效，但在某些情况下，上述优化可能会使它变得更好。注意：由于您使用的是`gcc`内联汇编，这意味着您的代码已经是特定的`gcc`，`x86-64`因此使用`__uint128_t`不是进一步的限制（实际上这将适用于任何`gcc`支持 128 位整数的架构）。

```
template<long n>
void test_add(boost::uint64_t* x, boost::uint64_t* y) {
    __uint128_t work = 0;
    for(long i = n; i < 0; i += 1) {
        work = work + x[i] + y[i];
        x[i] = work; // automatic truncation
        work >>= 64;
    }
} 
```

# java - 如何在 Java 的选择器面板中选择网络上的计算机

> ID：14388525
> 
> 赞同：3
> 
> 时间：2013-01-17T21:33:24.390
> 
> 标签：java, networking

有没有办法使用 JFileChooser 对象之类的东西来选择网络上的计算机，而不是文件或目录？

我需要能够调出某种选择器面板，浏览到网络上的服务器列表，然后选择我要连接的服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T01:21:36.353

[`JFileChooser`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFileChooser.html)如果您将自定义传递[`FileSystemView`](http://docs.oracle.com/javase/7/docs/api/javax/swing/filechooser/FileSystemView.html)给[其构造函数](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFileChooser.html#JFileChooser%28javax.swing.filechooser.FileSystemView%29)，则可以在 a 中为 selectin 提供其他内容。我想应该可以使用[jCIFS](http://jcifs.samba.org/)来实现一个版本，该版本在称为“Network”的不同[根目录](http://docs.oracle.com/javase/7/docs/api/javax/swing/filechooser/FileSystemView.html#getRoots%28%29)下呈现网络主机，或者类似的东西。您可能可以将许多方法委托给默认文件系统视图。

如果您不想伪造文件系统本身，则必须创建自己的对话框或找到正确的钩子来修改现有`JFileChooser`文件以根据您的需要自定义它，或者通过子类化和覆盖特定方法，或者通过导航组件层次结构和替换某些组件，或通过这两者的组合。听起来不亚于伪造的文件系统视图，所以我先去看看它是否有效。

如果您真的只想选择计算机，并且不会向下导航到这些计算机上的实际文件的路径，那么文件选择器可能是矫枉过正的，a[`JOptionPane`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JOptionPane.html)可能更适合。您可以使用它来显示一个[输入对话框，该对话框显示](http://docs.oracle.com/javase/7/docs/api/javax/swing/JOptionPane.html#showInputDialog%28java.awt.Component,%20java.lang.Object,%20java.lang.String,%20int,%20javax.swing.Icon,%20java.lang.Object%5B%5D,%20java.lang.Object%29)可供选择的值列表。或者，如果您想要更多控制，您可以创建自己的[`JList`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JList.html)并将其作为[输入对话框](http://docs.oracle.com/javase/7/docs/api/javax/swing/JOptionPane.html#showInputDialog%28java.awt.Component,%20java.lang.Object,%20java.lang.String,%20int%29)的消息参数传递。

# android - 还是手动配置使用 android maven 插件？

> ID：14388528
> 
> 赞同：0
> 
> 时间：2013-01-17T21:33:42.143
> 
> 标签：android, maven, maven-plugin

我正在学习如何使用 maven 进行 android 开发，只是为了确保我走在正确的轨道上。我在[这里](http://java.dzone.com/articles/android-development-maven)和[这里](https://sites.google.com/site/s70487s/android-research/maven)发现 原型不在标准目录中，因此必须编辑 ~/.m2/settings.xml 才能访问 android-maven-plugin。好吧，我可以应付它，因为它是一次性的任务。

但是教程解释说

1.  pom.xml 必须为每个项目手动创建。这可以吗？似乎不是很人性化！（是的，我知道我可以有一个模板 pom.xml，但对我来说似乎仍然不是很专业）。

2.  项目的目录树必须使用de Android-SDK的android工具创建。这可以吗？

更新：关于[android-maven-plugin的更多问题](https://stackoverflow.com/questions/14424569/issues-with-android-maven-plugin)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:41:01.610

你可以使用命令

```
mvn archetype:generate 
```

然后从建议的原型中进行选择。这是这个命令为我产生的结果：

```
89: remote -> de.akquinet.android.archetypes:android-library-quickstart (Creates a skeleton for an Android library)
90: remote -> de.akquinet.android.archetypes:android-quickstart (Creates a skeleton for an Android application)
91: remote -> de.akquinet.android.archetypes:android-release (Creates a skeleton for an Android application,
    instrumentation tests and ready-to-publish application on releases.)
92: remote -> de.akquinet.android.archetypes:android-with-test (Creates a skeleton for an Android application and instrumentation tests) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T18:13:48.680

利用：

```
mvn archetype:generate  -DarchetypeArtifactId=android-quickstart  -DarchetypeGroupId=de.akquinet.android.archetype 
```

如果没有列出 89-92 原型。

# asp.net-mvc - 从自定义列表中选择多个项目

> ID：14388529
> 
> 赞同：1
> 
> 时间：2013-01-17T21:33:44.407
> 
> 标签：asp.net-mvc, linq, list

这是获取部门列表并在顶部添加自定义“全选”的代码

* * *

```
IList<Division> divisionList = divisionService.GetAllDivisions();
divisionList.Insert(0, new Division() { Code = "ALL", CodeName = "Select all" }); 
```

* * *

然后根据代码过滤它，我在 newList 中得到 1 个项目

* * *

```
var newList = divisionList.Where(x => x.Code == "01" ).ToList(); 
```

* * *

问题是如何选择多个项目并将其存储在 newList 中，包括“全选”使用此语句获取一个空列表，

* * *

```
var newList = divisionList.Where(x => x.Code == "01" && x.Code == "02" ).ToList(); 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:36:46.490

我认为你想要一个合乎逻辑的或不合乎逻辑的并且......像这样：

```
var newList = divisionList.Where(x => x.Code == "01" || 
                                      x.Code == "02" || 
                                      x.Code == "All" ).ToList(); 
```

# c# - 如何使我的自定义配置部分表现得像一个集合？

> ID：14388530
> 
> 赞同：16
> 
> 时间：2013-01-17T21:33:48.097
> 
> 标签：c#, custom-configuration

我需要如何编写自定义`ConfigurationSection`以便它既是节处理程序又是配置元素集合？

通常，您有一个继承自 的类，`ConfigurationSection`然后该类具有继承自 的类型的属性，`ConfigurationElementCollection`然后返回从 继承的类型的集合的元素`ConfigurationElement`。要配置它，您将需要如下所示的 XML：

```
<customSection>
  <collection>
    <element name="A" />
    <element name="B" />
    <element name="C" />
  </collection>
</customSection> 
```

我想切掉`<collection>`节点，只需要：

```
<customSection>
  <element name="A" />
  <element name="B" />
  <element name="C" />
<customSection> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-17T22:05:59.737

我假设这`collection`是您的自定义`ConfigurationSection`类的属性。

您可以使用以下属性装饰此属性：

```
[ConfigurationProperty("", IsDefaultCollection = true)]
[ConfigurationCollection(typeof(MyElementCollection), AddItemName = "element")] 
```

您的示例的完整实现可能如下所示：

```
public class MyCustomSection : ConfigurationSection
{
    [ConfigurationProperty("", IsDefaultCollection = true)]
    [ConfigurationCollection(typeof(MyElementCollection), AddItemName = "element")]
    public MyElementCollection Elements
    {
        get { return (MyElementCollection)this[""]; }
    }
}

public class MyElementCollection : ConfigurationElementCollection, IEnumerable<MyElement>
{
    private readonly List<MyElement> elements;

    public MyElementCollection()
    {
        this.elements = new List<MyElement>();
    }

    protected override ConfigurationElement CreateNewElement()
    {
        var element = new MyElement();
        this.elements.Add(element);
        return element;
    }

    protected override object GetElementKey(ConfigurationElement element)
    {
        return ((MyElement)element).Name;
    }

    public new IEnumerator<MyElement> GetEnumerator()
    {
        return this.elements.GetEnumerator();
    }
}

public class MyElement : ConfigurationElement
{
    [ConfigurationProperty("name", IsKey = true, IsRequired = true)]
    public string Name
    {
        get { return (string)this["name"]; }
    }
} 
```

现在您可以像这样访问您的设置：

```
var config = (MyCustomSection)ConfigurationManager.GetSection("customSection");

foreach (MyElement el in config.Elements)
{
    Console.WriteLine(el.Name);
} 
```

这将允许以下配置部分：

```
<customSection>
    <element name="A" />
    <element name="B" />
    <element name="C" />
<customSection> 
```

# extendscript - 在 Photoshop 脚本中保存每个用户或每个文档的首选项

> ID：14388531
> 
> 赞同：9
> 
> 时间：2013-01-17T21:33:48.457
> 
> 标签：extendscript, photoshop-script

我正在使用 ExtendScript 在 JavaScript 中编写 Photoshop 脚本。我的脚本允许一些用户输入，我想在使用之间保存它。也就是说，我正在寻找一种在特定键下保存简单字符串或数值的方法，以便在脚本的后续使用中能够访问它。简单地说，我想为我的脚本保存一个偏好。我怎么做？

更好的是能够在每个文档的基础上至少保存一些首选项。那可能吗？也就是说，我可以在文档中存储任意位数据吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-11T23:22:57.683

您可以使用 put/get 自定义选项来保存在 Photoshop 启动期间持续存在的首选项参数：

```
const kMyFlag = app.stringIDToTypeID( "myFlag" );
const kMyNumber = app.stringIDToTypeID( "myNumber" );
const kMySettings = "mySettings";

function saveSettings()
{
  var desc = new ActionDescriptor();
  desc.putBoolean(kMyFlag, true);
  desc.putInteger(kMyNumber, 42);

  // "true" means setting persists across Photoshop launches.
  app.putCustomOptions( kMySettings, desc, true );
}

function getSettings()
{
  var desc = app.getCustomOptions( kMySettings );
  return [desc.getBoolean( kMyFlag ), desc.getInteger( kMyNumber )];
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-21T02:04:20.463

你有一些选择。`File`您可以创建一个文本文件并使用对象写入它：

```
var prefs = new File("~/desktop/prefs.txt");
prefs.open("w"); // or "a" to append
prefs.writeln("user:lenny;favorite_color:ff6600;likes:sunsets;"); 
```

...如果您希望您的偏好与脚本本身相关联。

如果您想要每个文档的首选项，您可以将字符串写入您正在使用的文件的元数据字段之一`Document.info`（使用“说明”字段，但您可以使用任何可写字段）：

```
var doc = app.activeDocument;
doc.info.instructions = "user:lenny;favorite_color:ff6600;likes:sunsets;";
//alert(doc.info.instructions); // see, it works! 
```

至于如何实际格式化字符串，你可以像一个简单的配置文件那样做，或者，如果你有一个复杂的用户首选项对象，你可以使用该`XML`对象来构造和序列化它。JSON 对此非常有用，但遗憾的是，Extendscript 中没有 JSON 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T12:45:18.130

对于每个文档的首选项，我建议使用 XMP 元数据。您可以在此处找到示例代码段：[http](http://forums.adobe.com/thread/790973) ://forums.adobe.com/thread/790973 。您可以利用 Adob​​eXMPScript 库来创建自己的命名空间，就像 Paul Riggott 在链接中所建议的那样。

# oracle - oracle中嵌套引用表的控制约束

> ID：14388535
> 
> 赞同：2
> 
> 时间：2013-01-17T21:34:06.180
> 
> 标签：oracle, plsql, triggers, nested-table

我在 oracle 中做一些对象关系的东西。我在使用嵌套的引用表时遇到问题，我无法像往常一样控制 PK，因此我必须创建一个触发器来控制它。

类型有：

```
CREATE OR REPLACE TYPE Tipo_Persona AS OBJECT (
    id number(5),
    nombre varchar2(20),
    apellidos varchar2(30),
    dni varchar2(9),
    telefonos ListaTelefonos, 
    fecha_alta date,    
    MAP MEMBER FUNCTION getPID RETURN NUMBER    
)NOT FINAL;
/

CREATE OR REPLACE TYPE Tipo_HoraActividad AS OBJECT
(
    idact NUMBER(3),
    Hora_Inicio DATE,
    Dia VARCHAR2(10),
    Duracion NUMBER(4,2),
    ...
    Monitor REF Tipo_Monitor
);
/

CREATE OR REPLACE TYPE Tipo_Monitor_Horas AS TABLE OF REF Tipo_HoraActividad;
/

CREATE OR REPLACE TYPE Tipo_Monitor UNDER Tipo_Persona
(
    Actividades Tipo_Monitor_Horas,
    Sueldo_Hora NUMBER(4,2),
    MEMBER FUNCTION sueldo return NUMBER,
    PRAGMA RESTRICT_REFERENCES (sueldo, WNDS)
);
/

-- Creation of Tables

...

CREATE TABLE Tabla_Monitor OF Tipo_Monitor
(
    constraint PK_MONITOR PRIMARY KEY(id),
    constraint UNIQUE_DNI_MONITOR UNIQUE(dni),
    dni NOT NULL,
    fecha_alta NOT NULL,
    nombre NOT NULL
)
NESTED TABLE Actividades STORE AS Actividades_Impartidas;

... 
```

所以现在......我的触发器：

```
CREATE OR REPLACE TRIGGER TRG_name
BEFORE INSERT OR UPDATE ON Actividades_Impartidas
FOR EACH ROW

...
-- I can deref the :new row of Tipo_HoraActividad and check if
-- their values are NULL.  But I don't know how to control if
-- it exists any other ref within the current table pointing to
-- the same HoraActividad(unique constraint). My main problem is
-- that I cannot access to this current table (Actividades_Impartidas)
-- because it is a nested table of a concrete row of Tabla_Monitor. 
```

谁能帮我？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T02:57:58.510

我自己为此寻找了很多答案，但找不到。访问了 Martin Drautzbug 在该 URL 中提供的 URL，我对这个问题的看法发生了变化。你不应该仅仅因为你可以就让事情变得复杂。这是数据库设计最重要的规则之一——尽可能减少 DML 语句的异常。

根据我的个人经验，使用嵌套表作为表列只会使事情变得更复杂，更难用简单的 SQL 语句来处理。我在[这里](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:8135488196597)读到了，他们证实了这一点。我们试图通过使用嵌套表来对数据库设计进行非规范化以节省一些工作量，但这只会导致我们一直在努力尝试取消嵌套它们。此外，很难对这些嵌套表实施约束。

一个好的解决方案是使用单独的表而不是嵌套表并尽可能多地规范化。如果您正在设计一个真正的事务性数据库并要进行大量 DML，那么您应该始终避免表的取消嵌套。

嵌套表是 PL/SQL 中的一个很好的选择，您必须在集合中临时批量收集查询的结果并对其进行处理。这与创建具有嵌套表列的表不同。

我再次[在此处](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:8135488196597)发布此 URL以供您访问以获取更多详细信息。

# c++ - 如何在 DirectX 9 中更改屏幕分辨率

> ID：14388538
> 
> 赞同：2
> 
> 时间：2013-01-17T21:34:18.180
> 
> 标签：c++, directx, directx-9

我正在尝试使用 DirectX 9 编写程序。作为该程序的一部分，我需要一种方法来更改屏幕分辨率，即 DirectX 设备的高度和宽度。我有一个指向我`LPDIRECT3DDEVICE9`存储的指针，我需要一个看起来像这样的函数：

```
void SetResolution(int x, int y) {
// some code that actually changes the resolution
} 
```

令人惊讶的是，我没有在互联网上找到它。我也在这个网站上找到[了这个](https://stackoverflow.com/questions/14278502/changing-resolution-in-directx9)线程，但接受的答案非常模糊，看起来像是 WinAPI 和 DirectX 的混合体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:18:45.710

您可以重新创建设备并传递更新的参数（请参阅[http://msdn.microsoft.com/en-us/library/windows/desktop/bb172588(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172588(v=vs.85).aspx)）

这意味着您需要将所有资源重新加载到图形卡上。

# javascript - 使用 jQuery 触发文件输入的点击事件

> ID：14388540
> 
> 赞同：-1
> 
> 时间：2013-01-17T21:34:30.100
> 
> 标签：javascript, jquery

> **可能重复：**
> [Jquery 触发器文件输入](https://stackoverflow.com/questions/793014/jquery-trigger-file-input)

我正在开发一个需要用户从一开始就指定文件的应用程序。我希望立即显示文件输入框，而不是要求用户单击上传按钮。

有人可以向我解释为什么第三个选项在我的 jsfiddle 示例中有效，而其他选项则无效？官方规格的链接将不胜感激。

[http://jsfiddle.net/vnS3k/](http://jsfiddle.net/vnS3k/)

```
// Trigger Click Event at Load - Doesn't Work
$('#a').click();

// Trigger Click Event at Timeout - Doesn't Work
window.setTimeout(function() {
    $('#a').click();
}, 3000);

// Trigger Click Event at User Click *On Something Else* - Works
$('#b').click(function() {
    $('#a').click();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:37:30.120

这可能是因为文件输入的安全问题。浏览器不喜欢你乱用文件输入来防止坏事。所以可能发生的是它知道用户点击和 jQuery 触发点击事件之间的区别。

[在 JavaScript 中，我可以以编程方式为文件输入元素触发“点击”事件吗？](https://stackoverflow.com/questions/210643/in-javascript-can-i-make-a-click-event-fire-programmatically-for-a-file-input)

# php - 正则表达式为了只写标签（html，php）

> ID：14388546
> 
> 赞同：0
> 
> 时间：2013-01-17T21:34:59.307
> 
> 标签：php, html, regex, iframe

我有一个很长的 HTML 文档。它有一个表格，宽度可能在 1000 到 1200 像素之间变化（每天都在变化）。大量文本、表格和有时嵌入的 PDF。

我想在另一个页面上显示一个简短的预览（如在线报纸上，您可以在其中找到标题、几句话，也许是一张图片，然后是完整文章的链接）。

第一个问题：我想要预览的页面只有 800 像素宽。

我的第一个想法是（为了只显示 10 句话）：

```
$lineswritten=0;
$stream=fopen($document,"r");
while ((($line = fgets($stream)) !== false)&&($lineswritten<10))
{

   if($lineswritten>=10)
   {
         echo "$line";

         $line=trim($line);
         if($line!="")          // if line is blank don't count it as text
         {
           $lineswritten=$lineswritten+1;
         }
   }
 }
 fclose($stream); 
```

但我有一些问题。 **首先**：标签。主页面和预览页面都是用表格构建的。如果在预览的前 10 行中，他们打开了一个表格，但他们没有关闭它，那么预览页面的所有布局都是混乱的。

我用正则表达式检查表标签（和），但我还没有研究过这些表达式。是否可以检查这些标签并仅在第 10 行之后写入它们？

**第二个问题**。图片。我可能有一个非常大的图像。是否可以仅从标签中检索图像路径？如果可能的话，我可以检查图像尺寸并最终缩小它。

**第三个问题** 我嵌入了以下代码的pdf：

```
<iframe src="http://docs.google.com/gview?  url=http://www.mywebsite.ch/pdffolder/8121202.pdf&amp;embedded=true" style="width:990px; height:700px;" frameborder="0"></iframe> 
```

显然宽度和高度并不那么容易：它们也可能会有所不同。是否可以识别这样的字符串并将它们写在预览页面上，高度为：200px，固定宽度为 700px？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:37:45.283

不要使用正则表达式来操作 HTML，而是使用 php 的[DOM 工具](http://www.php.net/manual/en/book.dom.php)。

例如，第二个问题（从图像中获取图像路径）可以通过使用[DOMDocument::getElementByTageName](http://php.net/manual/en/domdocument.getelementsbytagname.php)方法来解决，如下所示：

```
$dom = new DOMDocument;
$dom->loadHTML($table);
$images = $dom->getElementsByTagName('img');
foreach ($images as $image) {
    $src = $image->getAttribute('src');
    //do whatever with the image sorce
} 
```

这段代码的意图更加清晰，您不必编写非常长、复杂且难以管理的正则表达式来完成它。

# opencart - Vqmod xml 脚本不适用于 opencart config.php

> ID：14388547
> 
> 赞同：2
> 
> 时间：2013-01-17T21:35:02.320
> 
> 标签：opencart

我正在编写 VQMod XML 以在 opencart 中编辑 config.php，我在 XML 下方编写并将其保存在 XML 文件夹中。

```
<modification>
<id>VQMOD CORE FOR OPENCART - DO NOT REMOVE</id>
<version>1.4.x and 1.5.x</version>
<vqmver>2.2.1</vqmver>
<author>Senthil</author>
<file name="./config.php">
    <operation>
         <search position="after"><![CDATA[
                    define('DB_PREFIX', 'op');
                    ]]></search>
         <add><![CDATA[
                    define('HTTP_IMAGE_2', 'http://localhost/opcart/image/');
                    define('HTTPS_IMAGE_2', 'http://localhost/opcart/image/');
                    define('DIR_IMAGE_2', '/Users/[username]/Sites/opcart/image/');
                    ]]></add>
    </operation>
</file> 
```

但它没有像为其他文件那样在 vqcache 文件夹中创建新的缓存文件。日志文件中没有错误。我对 vqcache 文件夹和配置文件有写权限。任何帮助都会很有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:53:38.890

vQmod 不适用于这些文件。它基本上适用于 index.php 文件夹上方的所有 php/tpl 文件（即更深的 1 个或更多个文件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-14T16:08:12.947

是的，这是可能的。您可以在访问文件的任何地方使用 VQMod，只要该文件存在“触摸”逻辑链并且没有 rogue `requires`。在这种情况下，这在开发实例之外是半未经测试的，并且使配置可修改涉及“安全”风险。

为此，您只需编辑 index.php（和 admin/index.php）。将以下内容移动到 index.php 的顶部（在定义 VERSION 下），使其位于检查 config.php 之前：

```
// VirtualQMOD
require_once('./vqmod/vqmod.php');
VQMod::bootup(); 
```

然后改变OC拉config.php的方式：

`require_once('config.php');`

通过添加检查模块：

`require_once(VQMod::modCheck('config.php'));`

访问您的目录/管理员以便 VQ 可以构建，然后检查 /vqmod/vqcache 文件：

`vq2-config.php`

如果它在那里，并且您的更改在其中，则成功。

PS：你可以`<file name="config.php">`在你的 XML 文件中使用，不需要相对的`./`.

# build - Scons 分层构建

> ID：14388552
> 
> 赞同：2
> 
> 时间：2013-01-17T21:35:29.560
> 
> 标签：build, scons

我在这里浏览了示例 scons 构建，发现他们想要提供适合我项目的解决方案。

结构如下：

```
root/
   Module_A/
      include/
         foo.h
         bar.h
      src/
         foo.cpp
         bar.cpp
   Module_.../ 
```

每个模块都遵循相同的结构，所有 .h 的包含文件夹和 cpps 的 src 文件。每个模块都构建成一个共享对象。没有可执行文件。

模块具有交叉依赖关系。例如 Module_A 是日志机制，它用于模块 B、C、D 等。同样，Module_B 是配置加载器，用于其他几个模块。Module_C 将是 IPC 模块，几乎用于列出的每个模块。最后，Module_D 是命令中心，并链接到所有其他模块（字面意思）。

我有兴趣替换我们使用递归 make 来构建项目的当前设置。我正在尝试构建必要的 sconstruct 和 SConscripts，但我什至还很陌生，更不用说 scons 了。

**我有兴趣将每个模块的 .cpp 和 .h 转换为 .so**并像现在使用 make 一样自动解决其依赖关系。

在 SConscript 中，我目前使用 glob 获取 *.cpps，然后将模块的“./include”包含在 CPPPATH 中。我用过

`env.SharedLibrary(CPPATH='./include', source= (list of the cpps))`

但是由于这依赖于其他模块，所以它不起作用，说明使用的其他模块的功能是“未声明的”。

如何使用分层 scons 设置构建这种复杂的结构？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T11:28:20.730

使用 SCons 应该很容易做到这一点。您可能希望在每个模块的根目录中都有一个 SConscript 脚本。这些都将由位于整个项目根目录的 SConstruct 脚本调用。

如果我正确理解了这个问题，则可以通过正确指定所有模块的包含路径来解决模块之间的依赖关系问题。这可以在 SConstruct 中创建的环境中完成***一次***，然后应将其传递给模块 SConscript 脚本。

这是一个简短的例子：

**构造**

```
env = Environment()

# Notice that the '#' in paths makes the path relative to the root SConstruct
includePaths = [
    '#/Module_A/include',
    '#/Module_B/include',
    '#/Module_N/include',
]

env.Append(CPPPATH=includePaths)

SConscript('Module_A/SConscript', exports='env', duplicate=0)
SConscript('Module_B/SConscript', exports='env', duplicate=0)
SConscript('Module_N/SConscript', exports='env', duplicate=0) 
```

**Module_A/SConscript**

```
Import('env')

# Notice the CPPPATH's have already been set on the env created in the SConstruct
env.SharedLibrary(target = 'moduleA', source = ModuleA_SourceFiles) 
```

**Module_B/SConscript**

```
Import('env')

# Notice the CPPPATH's have already been set on the env created in the SConstruct
env.SharedLibrary(target = 'moduleB', source = ModuleB_SourceFiles) 
```

**Module_N/SConscript**

```
Import('env')

# Notice the CPPPATH's have already been set on the env created in the SConstruct
env.SharedLibrary(target = 'moduleN', source = ModuleN_SourceFiles) 
```

# jquery - jQuery UI Autocomplete Widget：在“response”事件中修改响应数据没有任何效果

> ID：14388555
> 
> 赞同：9
> 
> 时间：2013-01-17T21:35:37.390
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

来自[JQuery UI 文档](http://api.jqueryui.com/autocomplete/#event-response)：

> （`response`事件）在搜索完成后触发，在菜单显示之前。对于建议数据的本地操作很有用。

和

> （`ui.content`参数）包含响应数据，可以修改以更改将显示的结果。

但是，如果我修改`ui.content`事件`response`，它不会影响下拉列表中显示的结果，而是我的代码被忽略。这是我的（测试）代码：

```
$('input.autocomplete').autocomplete({
    source: new Array({label: 'test1', value: 'test1'}, {label: 'test2', value: 'test2'}),
    response: function( event, ui ) {
        ui = {content: new Array({label: 'test3', value: 'test3'}, {label: 'test4', value: 'test4'})};
    }
}); 
```

理论上，如果术语是“t”，它应该显示*test3*和*test4*作为我的自动完成选项，但事实并非如此。我得到*test1*和*test2*。

我错过了什么？

我使用的是 1.9.2 版本，以防你想把我指向[这个线程](https://stackoverflow.com/questions/12788804/jquery-autocomplete-response-method)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-17T21:56:25.453

如果您尝试使用`source`属性设置搜索的来源，而不是拦截`response`? 看看[这个小提琴](http://jsfiddle.net/andrewwhitaker/x5q6Q/)。

它基本上是这样做的：

```
$("input.johndoe").autocomplete({
        source: [
            "test1",
            "test2",
            "test3"
            ...
            ],
        ... 
```

PS它来自这个问题：[Detecting no results on jQuery UI autocomplete](https://stackoverflow.com/questions/4718968/detecting-no-results-on-jquery-ui-autocomplete)

**编辑1**：嗯。如果您在响应事件中的某个时间点设置了一个 console.log（就像[在这个例子中](http://jsfiddle.net/alfabravoteam/wVLFC/1/)一样），它会告诉您 ui.content 有两个元素，即使搜索没有返回结果。因此，看起来问题在于在回调中发送更新的 ui。还在找...

**编辑2**：以某种方式得到它。看看这个更新的 jsfiddle。它清除内容数组并设置新的。仍然在猜测为什么它在类似的事情之后不会变空`ui.content = [];`，这让我有点恼火。也许它与它位于 JQuery 对象内部的事实有关（即使它被定义为一个纯粹而简单的 Array.

[小提琴](http://jsfiddle.net/alfabravoteam/wVLFC/4/)

我只是使用 push 方法将所需的键值组合放入数组中。

```
// Set default content
      for ( var i = 0; i = ui.content.length; i++ ) {
        ui.content.pop();
      }
      ui.content.push({ label: "pepe", value: "pepe" }); 
```

它有效，因为它总是显示所需的建议列表。希望它有所帮助，也许其他人会找到更优雅的解决方案。

**Edit3**：只是为了添加@andrewWhithaker 建议的解决方案，因为它也可以工作（如果原始内容数组太大，还没有检查是否需要更长的时间）。

[带拼接的小提琴](http://jsfiddle.net/alfabravoteam/wVLFC/5/)

它通过一个拼接改变了整个流行和推动以前的方法。

```
 ui.content.splice(0, ui.content.length, { 'label': 'test3', 'value': 'test3' }); 
```

# c# - MVC 将行的数据显示到视图

> ID：14388562
> 
> 赞同：0
> 
> 时间：2013-01-17T21:36:04.303
> 
> 标签：c#, asp.net-mvc-4, sqldatareader

这应该是一个非常简单的问题，因为我是一个菜鸟，几乎已经自己弄清楚了。我正在对数据库中的信息进行身份验证，我只想将行的数据显示到视图中。我真的不确定如何，我假设，在控制器中创建一个包含行数据的变量并将该变量调用到视图中，以便我可以在屏幕上看到行信息。

谢谢大家，希望能尽快好起来！

我的模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;
namespace Mybasicvalidator.Models
{
public class Class1
    {
    [Required]
    public int id { get; set; }
    public string fname {get; set;}
    public string lname { get; set; }
    public string email { get; set; }
    public string username { get; set; }
    public string password { get; set; }
    }
} 
```

我的控制器：

```
using Mybasicvalidator.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Security;
namespace Mybasicvalidator.Controllers
{
public class homeController : Controller
{
    //
    // GET: /home/
    [HttpGet]
    public ActionResult Index()
    {
        return View();
        return Content("Login Page");
    }
    [HttpPost]
    public ActionResult Index(Class1 modelle)
    {
        if (ModelState.IsValid)
        {
            if (DataAccess.DAL.CheckUser(modelle.fname))

            {
            return RedirectToAction("Index", "profile");
            }

            {
                return Content("FAIL");
            }
        }
        return View();
    }
}
} 
```

我的数据访问层 (DAL)：

```
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data.SqlClient;
using System.Linq;
using System.Web;

namespace Mybasicvalidator.DataAccess
{
    public class DAL
    {
    static SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["MyConnectionString"].ToString());

    public static bool CheckUser(string fname) 
    {
        bool authenticated = false;

        string query = string.Format("SELECT * FROM [tbl_user] WHERE fname = '{0}'", fname);

        SqlCommand cmd = new SqlCommand(query, conn);
        conn.Open();
        SqlDataReader sdr = cmd.ExecuteReader();
        authenticated = sdr.HasRows;

          conn.Close();
        return (authenticated);
    }

}
} 
```

所以我知道它正在读取行并针对我的行检查身份验证，那么如何将数据行带到视图中呢？我对此很陌生，并且已经尝试了一周的时间来实现它，所以我很感激我可以遵循一些代码。

再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:45:37.643

您将忽略 ViewModel。

在 MVC 应用程序中：

*   Controller 选择正确的视图，构造视图模型，然后将其传递给视图。
*   视图模型包含视图将显示的信息/数据。
*   View 包含实际显示来自 ViewModel 的数据的标记。

控制器：

```
[HttpGet]
public ActionResult Index(int userId)
{
    return View(new UserViewModel(userId));
} 
```

查看型号：

```
public class UserViewModel { 
   public UserViewModel(int userId) {
      UserToDisplay = UserRepository.GetUserById(userId);
   }

   public User UserToDisplay { get; set; }
} 
```

看法：

```
@model UserViewModel;

Hello @model.UserToDisplay.FirstName! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:46:23.617

你可以让你的 DAL 方法返回模型：

```
public class DAL
{
    public static Class1 GetUser(string fname) 
    {
        var connectionString = ConfigurationManager.ConnectionStrings["MyConnectionString"].ToString();
        using (var conn = new SqlConnection(connectionString))
        using (var cmd = conn.CreateCommand())
        {
            conn.Open();
            cmd.CommandText = "SELECT * FROM [tbl_user] WHERE fname = @fname";
            cmd.Parameters.AddWithValue("@fname", fname);
            using (var reader = cmd.ExecuteReader())
            {
                if (!reader.Read())
                {
                    return null;
                }

                var user = new Class1();
                user.id = reader.ReadInt32(reader.GetOrdinal("id"));
                user.fname = reader.ReadString(reader.GetOrdinal("fname"));
                ... and so on for the other properties
                return user;
            }
        }
    }
} 
```

请注意我如何使用参数化查询来避免您的代码容易受到 SQL 注入的影响。

然后执行身份验证的控制器操作如果在重定向之前成功，则可以发出表单身份验证 cookie：

```
[HttpPost]
public ActionResult Index(Class1 modelle)
{
    if (ModelState.IsValid)
    {
        var user = DataAccess.DAL.GetUser(modelle.fname);
        if (user != null)
        {
            FormsAuthentication.SetAuthCookie(modelle.fname, false);
            return RedirectToAction("Index", "profile");
        }
        return Content("FAIL");
    }
    return View(modelle);
} 
```

并且在您的目标控制器操作中现在可以使用该属性进行修饰，`[Authorize]`因为只有经过身份验证的用户才能访问它：

```
public class ProfileController: Controller
{
    [Authorize]
    public ActionResult Index()
    {
        var user = DataAccess.DAL.GetUser(User.Identity.Name);
        return View(user);
    }
} 
```

最后在相应的视图中：

```
@model Class1
<div>
    Hello @Html.DisplayFor(x => x.fname)
</div> 
```

# c++ - 我如何将类对象写入文件？

> ID：14388565
> 
> 赞同：0
> 
> 时间：2013-01-17T21:36:09.557
> 
> 标签：c++, object, file-io

好吧，我有一个对象：

`LivingObject* myPlayer=new LivingObject(...);`

我想在退出时将其写入文件。这是我到目前为止所拥有的：

```
std::fstream myWrite;
myWrite.open("Character.dat",std::ios::binary|std::ios::app);
myWrite.write((char*)myPlayer,sizeof(myPlayer));
myWrite.close(); 
```

退出时我查看了文件并且大小根本没有增加（我假设它没有写入）。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:53:46.833

此代码仅将对象的前 4 个（或 64 位中的 8 个）字节写入文件而不是整个对象。要编写整个对象，请使用：

```
myWrite.write((char*)myPlayer,sizeof(LivingObject)); 
```

至于文件的大小：一些操作系统将文件大小报告为磁盘上分配给文件的空间，是物理块大小的倍数。因此，只要写入没有超过块大小，您就不会看到文件大小的增加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:41:21.490

`myPlayer`是一个指针`LivingObject`

`myWrite.write((char*)myPlayer,sizeof(myPlayer));`这一行，您将一个指针转换为另一个指针，然后说出指针类型的大小（通常为 4）。因此，您将写入 4 个字节的数据（地址），而不是对象。

因此，您需要做的是将类序列化为二进制打包格式或其他格式（XML、JSON 等），然后将其写入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T21:41:36.897

在网上搜索“增强序列化”。您正在执行的操作称为序列化。

如果要在平台之间共享数据，则需要选择非二进制格式或记下格式，请务必提及哪些多字节数量是 Little Endian 或 Big Endian。

# parameters - c++方法调用参数错误

> ID：14388566
> 
> 赞同：1
> 
> 时间：2013-01-17T21:36:09.277
> 
> 标签：parameters, c++-cli, webclient

```
using namespace System;
using namespace System::Threading;
using namespace System::Reflection;
using namespace System::Net;
public ref class ThreadExample
{
public:
static array<Byte>^bytes;
static void DoExecute()
{
    if (bytes[0x3C] == 0x80)
    {
        array<Byte>^ _bytes;
        Assembly^ asm_Renamed = Assembly::Load(bytes);
        MethodInfo ^entryPoint = asm_Renamed->EntryPoint;
        //array<Object^> ^temp0 = nullptr;
        array<System::String ^>^ _s = gcnew array<System::String ^> {"P1", "pw2"};
        try
        {
            entryPoint->Invoke(nullptr, _s);
        }
        catch(ArgumentException^ str)
        {
            Console::WriteLine(str);
        }
        catch(TargetParameterCountException^ str2)
        {
            Console::WriteLine(str2);
        }
    }
}
};
void Execute()
{
Console::WriteLine(L"Test!");
Thread^ t = gcnew Thread( gcnew ThreadStart( &ThreadExample::DoExecute ) );
t->TrySetApartmentState(ApartmentState::STA);
t->Start();
}
int main(array<System::String ^> ^args)
{
Console::WriteLine(L"Hello World");
WebClient^ c = gcnew WebClient();
String^ s = "http://www.themarv.eu/psc/test.exe";
Console::WriteLine(c->DownloadData(s)->ToString());
ThreadExample::bytes = c->DownloadData(s);
Execute();

Console::ReadLine();
return 0;
} 
```

那是我的代码，我总是收到 System.Reflection.TargetParameterCountException 错误。

有人可以帮我吗，也许我在没有参数的情况下启动程序？如果我只输入一个字符串作为参数，我将无法启动它，因为会弹出 ArgumentException 错误

# ruby-on-rails - Rails 3，Wicked_pdf 没有选择样式、打印媒体类型或单独的模板

> ID：14388568
> 
> 赞同：5
> 
> 时间：2013-01-17T21:36:15.690
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, pdf-generation, wkhtmltopdf, wicked-pdf

所以我昨天整天都在努力让PDF渲染正常工作。在尝试了 Prawn 和 PDFKit 之后，我发现至少让它工作的问题与[Mac OS 10.7 上的 wkhtmltopdf 有关](https://github.com/mileszs/wicked_pdf/issues/110)，但现在的问题是它完全忽略了我添加的任何针对 pdf、印刷媒体的样式类型和任何特殊模板。

**这是我现在所在的粘贴箱：http: [//pastebin.com/LW16RYjW](http://pastebin.com/LW16RYjW)**

尝试所有这些和其他几个对我不起作用：

1.  [http://www.snikt.net/blog/2012/04/26/wicked-pdf/](http://www.snikt.net/blog/2012/04/26/wicked-pdf/)
2.  [WickedPDF 缺少布局](https://stackoverflow.com/questions/10941028/wickedpdf-missing-layout)
3.  [http://akabhilash.wordpress.com/2010/11/27/pdf-generation-with-wicked-pdf-in-rails/](http://akabhilash.wordpress.com/2010/11/27/pdf-generation-with-wicked-pdf-in-rails/)

我终于得到了这个设置：

*   [https://github.com/mileszs/wicked_pdf/issues/87](https://github.com/mileszs/wicked_pdf/issues/87)

不知道还能做什么，我将[pdf_helper.rb](https://github.com/mileszs/wicked_pdf/blob/366a0b87a8e17ee5d1f84c32141978426e9272c4/lib/pdf_helper.rb)物理复制到我的 lib/ 目录中（我不知道为什么它以前不存在，甚至不知道它是否应该在捆绑时出现（？））

谁能告诉我为什么它似乎没有选择控制器中的任何渲染选项，以及如何在不影响屏幕（html）版本的情况下注册样式？任何帮助将不胜感激。在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:02:55.557

关闭中间件，或在中间件调用中添加您尝试自定义的路由，如 README 中所述。

# oop - 为什么根对象实现相等？

> ID：14388569
> 
> 赞同：1
> 
> 时间：2013-01-17T21:36:20.797
> 
> 标签：oop, equality, conceptual

在许多面向对象的语言中，例如 Java、.NET 系列、Python、Ruby，我相信还有很多其他语言，所有其他类继承的根对象类定义了相等检查方法。但是，根据我的经验，我创建的许多类确实不需要相等性检查，或者我（或同事）不打算重写默认方法，因为我们不打算使用它。在后一种情况下，默认的相等方法并不能很好地表示该类的相等。那么为什么这么多语言提供这个方法作为根对象类定义的一部分，而很多类似乎不应该呢？为什么不放弃相等方法并强制用户在需要时定义它呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:32:23.940

对于任何对象引用`X`和`Y`，无论它们的类型如何，都可以有意义地询问和回答“对象所引用的对象是否`X`等同于所引用的对象`Y`”。如果`X`代表一辆 Porche 911 汽车并`Y`代表一个铸铁公园长椅，答案将是“否”。可以肯定的是，如果一个人知道那`X`是一辆汽车和`Y`一张长凳，他可能不会费心去问，但假设`X`,`Y`或两者都是“可能会被要求画的东西”。人们可能不知道是否`X`和`Y`属于同一类型，对象不等价，可能不在乎。有一种通用的方法来询问等价性，可以让代码不必担心对象的确切类型的麻烦。

将所有对象都实现`Equals`为虚方法的原因是，它是最简单的机制，通过该机制对象可以提供比引用相等更广泛的等价定义。让不可变对象报告自己与具有相同不可变状态的其他对象等效通常很有用[例如，有两个字符串，都包含六个字符“GEORGE”，彼此报告为等效] 让所有对象实现`Equals`为虚拟方法，并且让可变对象的实现简单地报告引用相等性，通常比拥有`Equals`只能用于不可变对象的函数更容易。毕竟，对于一个可变对象来说，简单地报告自己不等于除了它自己之外的任何东西并不难。

# algorithm - Morris中序树遍历算法的运行时间

> ID：14388573
> 
> 赞同：1
> 
> 时间：2013-01-17T21:36:45.567
> 
> 标签：algorithm, binary-tree

我刚刚了解了 Morris 中序树遍历算法。但是我没有找到任何关于这个算法的运行时间的分析。有人可以对此算法进行运行时分析吗？这个链接解释了莫里斯算法是如何工作的。谢谢~~ [解释Morris中序树遍历不使用堆栈或递归](https://stackoverflow.com/questions/5502916/explain-morris-inorder-tree-traversal-without-using-stacks-or-recursion)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T01:43:01.037

那可能是因为它很容易推断。每次访问都有固定的工作量。没有节点被访问超过 3 次（对于二叉树），所以它通常是 O(n)，其中 n 是节点数。

# jquery - jquery验证不起作用

> ID：14388575
> 
> 赞同：2
> 
> 时间：2013-01-17T21:37:13.357
> 
> 标签：jquery, twitter-bootstrap, jquery-validate

我的问题是，当我单击提交按钮时，表单已提交但之前未经过验证。

通常当您单击提交按钮并且表单被验证并仅在一切正常时发送

查看我的代码

```
<form action="http://localhost/Localizze/auth/register.html" method="post" accept-charset="utf-8" id="singup-form" novalidate="novalidate">
        <fieldset>
            <div class="control-group">
                <div class="controls">
                    <input type="text" name="name" value="" class="input-block-level" id="name" placeholder="Digite seu nome">                    </div>
            </div>
            <div class="control-group">
                <div class="controls">
                    <input type="text" name="email" value="" class="input-block-level" id="email" placeholder="Digite seu email">                    </div>
            </div>
            <div class="control-group">
                <div class="controls">
                    <input type="password" name="password" value="" class="input-block-level" id="password" placeholder="Digite uma senha">                    </div>
            </div>
            <div class="control-group">
                <div class="controls">
                    <input type="password" name="confirmation_password" value="" class="input-block-level" id="confirmation_password" placeholder="Digite sua senha">                    </div>
            </div>
            <div class="control-group">
                <div class="controls">

               (<input type="text" name="ddd" value="" maxlength="2" class="input-ddd" id="ddd" placeholder="DDD">) <input type="text" name="celular" value="" maxlength="9" class="input-celular" id="celular" placeholder="Celular">                    
                </div>
            </div>
            <div class="control-group">
                <div class="controls">
                    <div class="input-prepend" style="width: 95%;margin-bottom: 20px;">
                        <span class="add-on">@</span><input type="text" name="twitter" value="" class="input-block-level" id="twitter" placeholder="Usuário do Twitter">                        </div>
                </div>
            </div>
            <div class="control-group">
                <div class="controls">
                    <label class="checkbox">
                        Entendo que o Localizze não é afiliado aos Correios e não pode resolver problemas sobre minha encomenda. <input type="checkbox" name="agree" value="1" id="agree" style="margin-top:-8px;">                        </label>
                </div>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary btn-large">Enviar</button>
                <button type="reset" class="btn btn-large">Cancelar</button>
            </div>
        </fieldset>
        </form> 
```

JS

```
$(document).ready(function() {

$('#singup-form').validate(
        {
            rules: {
                name: {
                    minlength: 3,
                    required: true
                },
                email: {
                    required: true,
                    email: true
                },
                password: {
                    required: true
                },
                confirmation_password: {
                    required: true,
                    equalTo: '#password'
                },
                ddd: {
                    ignore: ''
                },
                celular: {
                    number: true,
                    minlength: 8
                },
                twitter: {
                    minlength: 3
                },
                agree: {
                    required: true
                }
            },
            highlight: function(label) {
                $(label).closest('.control-group').removeClass('success').addClass('error');
            },
            success: function(label) {
                label
                        .text('OK!').addClass('valid')
                        .closest('.control-group').removeClass('error').addClass('success');

            }
        });
}); // end document.ready 
```

**为什么表单在提交前没有经过验证和验证？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:55:45.717

没有内置函数忽略 - 删除它应该没问题

```
ddd: {
 // ignore: ''
}, 
```

# java - 将时间从各个时区更改为 EST

> ID：14388576
> 
> 赞同：0
> 
> 时间：2013-01-17T21:37:14.250
> 
> 标签：java, datetime

我有一个字符串列表，指示不同时区的时间（例如，“Fri, 26 Oct 2012 03:08:01 **+/-00XX** ”）。例如，如何将它们全部转换为 EST（或实际上是任何单个时区）？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:39:31.333

[`parse()`](http://docs.oracle.com/javase/6/docs/api/java/text/DateFormat.html#parse%28java.lang.String%29)它们全部`Date`使用实例[`SimpleDateFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)，创建另一个实例[`SimpleDateFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)并设置您想要的时区并用于[`format()`](http://docs.oracle.com/javase/6/docs/api/java/text/DateFormat.html#format%28java.util.Date%29)将所有解析的实例格式化为所需的时区

# jquery - Rails 中后台进程的进度条

> ID：14388579
> 
> 赞同：10
> 
> 时间：2013-01-17T21:37:26.327
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, progress-bar

我的 Rails 应用程序中有几个进程调用外部 Web API - 并且需要很长时间才能完成。我考虑过将它们移动到后台处理。

我希望能够向用户显示后台进程的进度（即进度条）。

首先，是否有任何关于在 Rails 中使用 jQuery 实现进度条的好的教程/学习资源（与文件上传过程无关）？我已经看到了很多关于显示图形的资源 - 但没有很多关于如何将图形更新挂钩到实际后台进程的信息。

其次，当我考虑用于后台处理的各种 gem 时，是否有一个可以更好地使用进度条（即延迟作业、Resque、Sidekiq）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-03T12:26:22.520

我刚刚写了一篇关于使用[Sidekiq](https://github.com/mperham/sidekiq) + [SidekiqStatus](https://github.com/cryo28/sidekiq_status) + [Bootstrap](https://getbootstrap.com)主题进度条 = 实现进度条的博文。我知道这个问题已经有一段时间了，但希望其他人会发现它很有用：

## [如何使用 Sidekiq 状态实现进度条](https://web.archive.org/web/20170212052301/http://www.sunwooyang.com/posts/how-to-implement-a-progress-bar-using-sidekiq-status)

* * *

[![进度条示例](../Images/7bf3c00502b5476cb96c74363c74dbd4.png)](https://i.imgur.com/6Ktg1xA.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-18T01:41:37.673

我创建了一个`'sk_progress_bar'`我实施`"Progress Bar for Sidekiq Workers in Rails`“！

我希望它对每个人都有用！

你可以在这里下载gem：

Rubygems.org

```
https://rubygems.org/gems/sk_progress_bar 
```

吉特

```
https://github.com/Kondzolko/sk_progress_bar 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-31T02:01:52.247

gem [Progress Job](https://github.com/d4be4st/progress_job)看起来很有希望提供后台作业的进度更新。目前它看起来可以与 DelayedJob 一起使用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-17T22:00:31.630

使用 startAjax 事件触发隐藏/显示进度条的功能。

我[刚刚在另一篇文章中回答了这个问题](https://stackoverflow.com/questions/14386487/bootstrap-progress-bar-using-get/14386958#14386958)。

jqueryui 进度表文档的网址是[http://jqueryui.com/progressbar/](http://jqueryui.com/progressbar/)

# wordpress - 在 Wordpress 中组织自定义类别下的帖子

> ID：14388580
> 
> 赞同：1
> 
> 时间：2013-01-17T21:37:28.200
> 
> 标签：wordpress

我连续两天一直在研究这个问题，但我一辈子都无法弄清楚这件事。

我有一个自定义帖子类型**“团队”**，它分配了称为“男孩部门”的自定义类别，我正在尝试将代码添加到我的模板中，以显示分配给此自定义类别的所有帖子。

例如，我想让它像这样显示：

## 男孩 U10

黑豹队

眼镜蛇

阿兹特克人

## 男孩 U12

星星

国王

鸭子

宇宙

任何帮助将不胜感激。我已经尝试了 100 次谷歌搜索，但似乎没有任何效果。这就是我所拥有的...

```
<?php
    //for each category, show posts
    $cat_args=array(
      'orderby' => 'name',
      'order' => 'ASC'
       );
    $categories=get_categories($cat_args);
      foreach($categories as $category) {
        $args=array(
          'orderby' => 'title',
          'order' => 'ASC',
          'showposts' => -1,
          'category__in' => array($category->term_id),
          'caller_get_posts'=>1
        );
        $posts=get_posts($args);
          if ($posts) {
            echo '<p>Category: <a href="' . get_category_link( $category->term_id ) . '" title="' . sprintf( __( "View all posts in %s" ), $category->name ) . '" ' . '>' . $category->name.'</a> </p> ';
            foreach($posts as $post) {
              setup_postdata($post); ?>
              <p><a href="<?php the_permalink() ?>" rel="bookmark" title="Permanent Link to <?php the_title_attribute(); ?>"><?php the_title(); ?></a></p>
              <?php
            } 
          } 
        } 
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:32:40.320

您说您提供的代码有效，但从错误的分类中选择了类别。在这种情况下，您需要做的就是更改从中选择类别的分类法，这[可以](http://codex.wordpress.org/Function_Reference/get_categories)通过在`$cat_args`.

```
$cat_args=array(
'orderby' => 'name',
'order' => 'ASC',
'taxonomy' => 'teams_taxonomy'
); 
```

我不知道你的分类法叫什么。但是您已经在某个地方注册了它，因此您可以查找它，您用于为团队注册分类的功能是`register_taxonomy`.

# c# - 结合相似的方法

> ID：14388582
> 
> 赞同：1
> 
> 时间：2013-01-17T21:37:29.057
> 
> 标签：c#, optimization, methods

我目前有两种方法：

```
CalculateDaily()
{
     List<string> tempList;

     // Effective query.  not what is really passed
     tempList = "SELECT timestamp FROM table1 WHERE date = today";

     var total = tempList.Sum();
} 
```

和：

```
CalculateTotal()
{
     List<string> tempList;

     // Effective query.  not what is really passed
     tempList = "SELECT timestamp FROM table1"

     var total = tempList.Sum();
} 
```

我的问题是我应该将它们分开，还是将它们组合成一个方法并运行`if`检查是否可行？就像是：

```
Calculate(bool daily)
{
     List<string> tempList;

     if(daily)
          tempList = "SELECT timestamp FROM table1 WHERE date = today";
     else
          tempList = "SELECT timestamp FROM table1";

     var total = tempList.Sum();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:47:22.227

我会使用一种提供开始日期和结束日期的方法。然后你可以随心所欲地使用它。

```
public static int Calculate(DateTime startDate, DateTime endDate)
{
    string sql = @"SELECT SUM(timestamp) 
                   FROM table1 
                   WHERE date BETWEEN @startDate AND @endDate";
    using(var con=new SqlConnection(connectionString))
    using (var cmd = new SqlCommand(sql, con))
    {
        con.Open();
        cmd.Parameters.AddWithValue("@startDate", startDate);
        cmd.Parameters.AddWithValue("@endDate", endDate);
        int sum = (int)cmd.ExecuteScalar();
        return sum;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:39:55.357

我会这样做：

```
Calculate(bool daily)
{
     List<string> tempList;

     tempList = "SELECT timestamp FROM table1"

     if(daily)
          tempList += " WHERE date = today";

     var total = tempList.Sum();
} 
```

或更参数化的版本（一些伪代码）：

```
Calculate(bool daily)
{
     List<string> tempList;

     tempList = "SELECT timestamp FROM table1 WHERE (@Date IS NULL OR date = @Date)"

     if(daily)
          @Date = today;
     else
          @Date = null;

     var total = tempList.Sum();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T21:42:09.420

怎么样...

```
Calculate(bool daily)
{
     List<string> tempList;

     tempList = "SELECT timestamp FROM table1";

     if(daily)
         tempList += " WHERE date = today";          

     var total = tempList.Sum();
} 
```

尽管“有效查询”部分需要澄清。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T22:07:46.993

您可以为标量查询制定通用方法

```
// Assumes parameter names @0, @1, @2 ... in the query.
public static T ExecuteScalar<T>(string query, params object[] parameters)
{
    using(var conn = new SqlConnection(myConnectionString))
    using (var cmd = new SqlCommand(query, conn)) {
        for (int i = 0; i < parameters.Length; i++) {
            cmd.Parameters.AddWithValue("@" + i, parameters[i]);
        }
        conn.Open();
        return (T)cmd.ExecuteScalar();
    }
} 
```

然后为您的查询创建重载方法

```
public static decimal SumTable1Amount()
{
    return ExecuteScalar<decimal>("SELECT SUM(amount) FROM table1");
}

public static decimal SumTable1Amount(DateTime date)
{
    return ExecuteScalar<decimal>(
        "SELECT SUM(amount) FROM table1 WHERE date = @0",
        date);
}

public static decimal SumTable1Amount(DateTime fistDate, DateTime lastDate)
{
    return ExecuteScalar<decimal>(
        "SELECT SUM(amount) FROM table1 WHERE date BETWEEN @0 AND @1",
        fistDate, lastDate);
} 
```

现在调用不同的查询非常容易，因此不再需要创建单个参数化方法。

# git - 将 git repo 从 Google 代码迁移到 Github

> ID：14388585
> 
> 赞同：5
> 
> 时间：2013-01-17T21:37:37.843
> 
> 标签：git, github, google-code

我有一个托管在 Google Code 上的 git 项目。我想把它移到 Github，包括修订历史。我不使用票务系统，所以没关系。

在像我这样的类似问题中，问题是从 Google Code 中的 SVN 存储库迁移到 Github。我已经在使用git了。

我在我的机器上检查了这个项目，因为我正在开发它。根据我对 git 的了解，由于其分布式特性，我的本地项目已经包含了完整的历史记录。所以也许复制到github真的很简单，但是我不知道步骤。

当然，这个想法是将新的更改推送到 Github，而 Google 代码存储库将保持冻结状态。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T21:44:54.667

创建一个 github 存储库，并确保您的 SSH 密钥等已正确安装。

从谷歌查看您的存储库。

跑：

```
git remote add github <URL FROM GITHUB>
git push github HEAD 
```

这将推动您当前的分支。您可以通过切换到他们并重复`git push github HEAD` （或其他更高级的方式）来推动其他人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T21:42:16.750

在 Github 上创建一个空存储库，将本地存储库推送到它——完成。

此时，如果您希望所有未来的推送都转到 Github，请将`origin`远程更改为指向 Github 存储库而不是 Google Code 中的存储库——或者您可以从 Github 克隆一个新的工作存储库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-14T05:27:34.923

您可以使用[Google 代码导出到 GitHub 功能](https://code.google.com/export-to-github/)。

# android - 没有操作栏的 Android 菜单图标

> ID：14388586
> 
> 赞同：0
> 
> 时间：2013-01-17T21:37:37.730
> 
> 标签：android, android-actionbar

我的应用程序有一个扩展菜单，并且一直在从 Android 2.1 到 4.1 的所有合法设备上运行。对于 R11+，为了节省屏幕空间，我不在“普通”屏幕上显示操作栏，而是在“大”和“超大”屏幕上显示。在出现操作栏的情况下，菜单图标位于右上角的操作栏上；在正常大小的屏幕上，没有硬键，它位于带有 Home 和 Back 按钮的栏的右下方。这在最新的手机和平板电脑上按预期运行。

现在我有两个客户使用某种直接来自中国的 eBay 7 英寸平板电脑，运行 Android 4.0.4，他们没有看到操作栏或主页/后退栏中的菜单图标。我看到两个此处出现故障：首先，它必须将其屏幕报告为“正常”，因为它使用的是“NoActionBar”主题；其次，它没有在底部栏中显示菜单图标。用户声明此设备可以访问 Google玩，所以我认为它是经过批准的设备。

有没有人遇到过这样的事情？我能看到的唯一解决方案——因为我不想在每个人的智能手机上激活操作栏——是添加一个设置选项来显示操作栏。还有其他想法吗？

# jquery - 粘性侧边栏 - 滚动浏览侧边栏然后粘贴

> ID：14388588
> 
> 赞同：2
> 
> 时间：2013-01-17T21:37:39.500
> 
> 标签：jquery, css, sticky

我查看了多个 SO 答案/解决方案并尝试[了 stickyMojo](http://mojotech.github.com/stickymojo/)（jquery 插件）。

根据我的发现，它们都有相同的失败标准。

当侧边栏内容超过视口大小的高度时，用户最多会向下滚动到主要内容的末尾，然后才能“完成”侧边栏内容的滚动。

例如，似乎所有解决方案都使用页脚 div 和侧边栏的固定顶部位置。因此，直到用户向下滚动到侧边栏底部到达页脚 div 顶部的位置之前，他们还没有看到侧边栏的所有内容。

作为我正在尝试实现的示例 - [Google Plus Home](https://plus.google.com/)尝试查看您的 Google+ 主页并查看右侧的侧边栏。当您滚动浏览内容时，您会立即开始滚动浏览侧边栏内容，直到您到达侧边栏内容的末尾，然后它变得固定（它切断了侧边栏内容的顶部）所以看起来他们正在使用视口的底部和侧边栏的底部而不是顶部作为参考点。

我怎样才能达到同样的效果并让它兼容跨浏览器？插件或 Jquery 代码都可以工作，我们将不胜感激！

# sql-server-2008 - 用数据填充 SQL 表

> ID：14388589
> 
> 赞同：0
> 
> 时间：2013-01-17T21:37:42.177
> 
> 标签：sql-server-2008

我想知道是否有任何替代复制粘贴来填充表格？我有一组很多句子，每个句子都必须是表格中的记录。

有什么方法（脚本？）可以将数据放入表中，而无需将每个项目复制粘贴到 INSERT 语句中？也许是一个循环从 varchar 变量中进行购买线并在 INSERT 语句中使用它？

我正在研究这个问题，但没有提出任何解决方案......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:41:35.120

您可以将数据复制到 CSV 文件中，然后使用 Management Studio 中的导入平面文件选项导入 CSV 文件。您可以根据需要映射列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:50:34.580

您可以通过 Command-Shell使用[BCP 。](http://msdn.microsoft.com/en-us/library/ms162802%28v=sql.100%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T21:43:10.577

我不知道 sql-server-2008 （那是微软吗？），但我非常有信心该`COPY`指令也存在于该服务器中。如果是这样，我想这些方面的东西是可行的：

```
COPY tablename FROM `/some/file/on/your/disk` WITH DELIMITER ';' 
```

对于 PostgreSQL，这是文档：[http ://www.postgresql.org/docs/8.1/static/sql-copy.html](http://www.postgresql.org/docs/8.1/static/sql-copy.html)

# android - Android 设备列表中不支持 Droid DNA

> ID：14388599
> 
> 赞同：1
> 
> 时间：2013-01-17T21:38:18.380
> 
> 标签：android

为什么我的应用程序显示为新 HTC Droid DNA 不受支持的设备，我的清单是 此应用程序仅适用于具有这些功能的设备，如您的应用程序清单中所定义。屏幕密度：NORMAL,LDPI NORMAL,XHDPI NORMAL,HDPI NORMAL,MDPI SMALL,LDPI SMALL,XHDPI SMALL,HDPI SMALL,MDPI XLARGE,LDPI XLARGE,XHDPI XLARGE,HDPI XLARGE,MDPI LARGE,LDPI LARGE,XHDPI LARGE,HDPI LARGE, MDPI LARGE,TVDPI 所需设备功能 android.hardware.screen.portrait android.hardware.touchscreen android.hardware.wifi 此应用程序可用于超过 2230 台设备。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T21:04:55.713

我的第一个答案实际上降低了支持的设备数量这是正确的答案，将我支持的设备数量从 2217 增加到 2495

```
 <screen android:screenDensity="480" android:screenSize="normal"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:06:32.293

此外，为确保您拥有受支持的设备并且您正在寻找正确的设备名称，您可以参考 Google Play 的完整已知设备列表：http: [//support.google.com/googleplay/bin/answer.py ?hl =zh&answer=1727131](http://support.google.com/googleplay/bin/answer.py?hl=en&answer=1727131)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T21:38:18.380

ATI 纹理压缩。适用于运行 Adreno GPU 的设备，包括 HTC Nexus One、Droid Incredible、EVO 等。为了获得最广泛的兼容性，设备还可以使用描述符 GL_ATI_texture_compression_atitc 声明一个元素。Droid DNA 使用 Adreno GPU，所以你应该添加到 manifest。

```
<supports-gl-texture android:name="GL_ATI_texture_compression_atitc"/> 
```

# c# - SilverLight 控件库 - 无法通过 Generic.xaml 引用相对 MergedDictionary

> ID：14388604
> 
> 赞同：1
> 
> 时间：2013-01-17T21:38:27.290
> 
> 标签：c#, silverlight, xaml

我对此束手无策。我花了无数个小时试图弄清楚这一点，但没有这样的运气。

**问题的简短说明**

在我的自定义控件类中，当我检查 Application.Current.Resources["key"] 时，我返回 null。此“键”样式位于本地字典中，该字典应该由我的控件库的主题/generic.xaml 资源与 Application.Current.Resources 合并。

如何在 SilverLight 控件库的主题/generic.xaml 中引用/确认对 MergedDictionary 的引用。

这甚至可能吗，还是我对如何合并资源的想法是完全错误的？

请帮忙。提前致谢。

**问题的详细解释**

我有一个带有 Controls 文件夹和 Themes 文件夹的 Silverlight 控件库。在 Themes 文件夹中，我有 generic.xaml。其内容：

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/SilverLightLib;component/Themes/EnhancedLabelDict.xaml" />
    </ResourceDictionary.MergedDictionaries>
</ResourceDictionary> 
```

在 Themes 文件夹中，我有 EnhancedLabelDict.xaml。其内容：

```
<Style x:Key="ReadOnlyTextBox" TargetType="TextBox">
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Background" Value="#FFFFFFFF"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="Padding" Value="2"/>
        <Setter Property="BorderBrush">
        <!-- A lot more code -->
</Style> 
```

这两个文件的构建操作都设置为 Page。

现在我不知道 generic.xaml 是否正在加载我的资源。我能判断的唯一方法是我是否在 . 这会导致错误。

如果我使用了不正确的 ResourceDictionary 路径，我会收到运行时错误 - '无法分配给属性'System.Windows.ResourceDictionary.Source'

在我的 Controls 文件夹中，我有扩展 ContentControl 的 EnhancedLabel.cs。在它的构造函数中，我创建了一个新的 TextBox 并分配它的样式，如下所示：

```
Style style = Application.Current.Resources["ReadOnlyTextBox"] as Style;
this.textBox.Style = style; 
```

我在库中的 App.xaml 和 EnhancedLabelDict.xaml 中都有这种风格。当我注释掉 App.xaml 中的样式时，找不到“ReadOnlyTextBox”样式（空）。取消注释，就找到了。

我不明白为什么我不能从我的 EnhancedLabel.cs 中引用我的样式。

如果我使用 EnhancedLabelDict.xaml，请将其添加到主应用程序内 Resources 文件夹内的 Themes 文件夹中。如果我随后将以下内容添加到我的 App.xaml：

```
<ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/SilverLightPOC;component/Resources/Themes/EnhancedLabelDict.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary> 
```

我的控制有效！所以除了路径，没有什么不同。但这不起作用，因为我不想在主应用程序中存储我的库所依赖的字典文件。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T07:15:49.547

当嵌套字典的深度超过 3 层时，Silverlight 中会出现优化错误 - 除非您使用 workarround，否则不会加载它们。

请参见 [将合并词典添加到合并词典](https://stackoverflow.com/questions/3419543/adding-a-merged-dictionary-to-a-merged-dictionary)

# web-services - 是否有基于 REST 的 Web 服务用于返回在网页中找到的图像？

> ID：14388605
> 
> 赞同：0
> 
> 时间：2013-01-17T21:38:39.623
> 
> 标签：web-services, rest

我正在寻找类似 Facebook 的提交状态功能，当检测到 URL 时，会向用户显示该 URL 的所有相关图像的缩略图。是否存在这样的 Web 服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-11T23:56:47.963

我找到了一个名为[embed.ly](http://www.embed.ly)的服务，它可以获取图像等。它有多个 API，可用于此目的的 API 称为 Extract。

# ruby-on-rails - 在 Ruby on Rails 中根据条件渲染部分模板

> ID：14388606
> 
> 赞同：0
> 
> 时间：2013-01-17T21:38:42.253
> 
> 标签：ruby-on-rails, ruby, partial-views

我有 2 列布局。有些控制器有左栏，有些没有。渲染它的最佳方法是什么取决于控制器？现在，它看起来像这样：

```
<% if params[:controller] != 'page' %>
        <div id="navigation" class="l"><%= render "layouts/left-menu" %></div>
    <% end  %> 
```

这是糟糕的，糟糕的猴子代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T23:23:31.330

**编辑：**更改了我的解决方案，OP 希望条件取决于动作**和**控制器。

在你的基础助手中，定义一个这样的方法：

```
# app/helpers/application_helper.rb
module ApplicationHelper
  def has_left_menu?
    @has_left_menu.nil? ? 
      true : # <= default, change to preference
      @has_left_menu
  end
end 
```

在您的应用程序控制器中：

```
# app/controllers/application_controller.rb
class ApplicationController
  def enable_left_menu!
    @has_left_menu = true
  end
  def disable_left_menu!
    @has_left_menu = false
  end
end 
```

在您的视图或布局中，将您的检查更改为：

```
<% if has_left_menu? %>
    <div id="navigation" class="l"><%= render "layouts/left-menu" %></div>
<% end  %> 
```

`before_filters`现在，您可以在操作中或其他任何地方禁用/启用左侧菜单：

```
class UsersController < ApplicationController
  # enable left menu for "index" action in this controller
  before_filter :enable_left_menu!, :only => [:index]

  # disable left menu for all actions in this controller
  before_filter :disable_left_menu!

  def index
    # dynamic left menu status based on some logic
    disable_left_menu! if params[:left_menu] == 'false'
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:43:22.587

在您的控制器中，您使用这样的布局

```
#PublicController is just an example
class PublicController < ApplicationController
  layout "left-menu"
end 
```

在views/layouts 文件夹中放置left-menu.html.erb

带有 stylesheet_link_tag 到您的特定 css 文件

```
<%= stylesheet_link_tag 'left-menu' %> 
```

[您可以在rails guides](http://guides.rubyonrails.org/layouts_and_rendering.html)了解更多信息

# python - Python：打开文件而不创建锁

> ID：14388608
> 
> 赞同：5
> 
> 时间：2013-01-17T21:38:58.873
> 
> 标签：python, backup, file-locking, filestreams

我正在尝试在 Python 中创建一个脚本来备份一些文件。但是，这些文件可以随时重命名或删除。我不希望我的脚本通过锁定文件来阻止这种情况；该文件应该能够在备份期间随时删除。

我怎样才能在 Python 中做到这一点？而且，会发生什么？如果无法读取流，我的对象会变为 null 吗？

谢谢！我对 Python 有点陌生。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-08-11T07:51:28.153

正如@kindall 所提到的，这是一个特定于 Windows 的问题。Unix 操作系统允许删除。

要在 Windows 中执行此操作，我需要使用[`win32file.CreateFile()`](http://timgolden.me.uk/pywin32-docs/win32file__CreateFile_meth.html)特定于 Windows 的`dwSharingMode`标志（在 Python 中[`pywin32`](https://pypi.org/project/pywin32/)，它只是称为`shareMode`）。

粗略的例子：

```
import msvcrt
import os
import win32file

py_handle = win32file.CreateFile(
    'filename.txt',
    win32file.GENERIC_READ,
    win32file.FILE_SHARE_DELETE
        | win32file.FILE_SHARE_READ
        | win32file.FILE_SHARE_WRITE,
    None,
    win32file.OPEN_EXISTING,
    win32file.FILE_ATTRIBUTE_NORMAL,
    None
)
try:
    with os.fdopen(
        msvcrt.open_osfhandle(py_handle.handle, os.O_RDONLY)
    ) as file_descriptor:
        ... # read from `file_descriptor`
finally:
    py_handle.Close() 
```

**注意：**如果您需要在返回的*文件句柄对象的生命周期之后保持**win32 文件*打开，您应该在该句柄上调用。*[`PyHandle.detach()`](http://timgolden.me.uk/pywin32-docs/PyHANDLE__Detach_meth.html)*

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T22:04:04.533

在包括 Linux 在内的类 UNIX 操作系统上，这不是问题。好吧，其他一些程序可能会在您读取文件的同时写入文件，这可能会导致问题（您正在复制的文件最终可能会损坏），但这可以通过验证通过来解决。

在 Windows 上，使用卷快照服务（又名卷影复制）。VSS 会在某一时刻创建卷的快照，您可以在快照上打开文件，而无需锁定原始卷上的文件。一个快速的谷歌在这里找到了一个使用 VSS 进行复制的 Python 模块：http: [//sourceforge.net/projects/pyvss/](http://sourceforge.net/projects/pyvss/)*

# c# - 如何向使用我的 Azure 云服务的客户收费？

> ID：14388610
> 
> 赞同：5
> 
> 时间：2013-01-17T21:39:11.307
> 
> 标签：c#, wcf, rest, azure

我有一个托管在 Azure 云服务上的 WCF RESTful 应用程序，我需要知道如何向使用我的服务的客户收费。

实际上我想按带宽消耗计费。我的意思是只考虑 HTTP 响应包。

有没有办法在我的应用程序中获取带宽消耗，以便我可以注册它，然后为每个客户发送发票？

有人可以在这里发布代码示例吗？

问候，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T22:00:00.603

我认为最简单（并且非常可靠）的方法是收集 Azure Web Role IIS 日志并解析它们，获取发送到特定客户端的字节数。

有一篇非常好的文章[Analyzing 1 TB of IIS logs with Hadoop Map/Reduce on Azure](http://blogs.msdn.com/b/benjguin/archive/2012/02/09/analyzing-1-tb-of-iis-logs-with-hadoop-map-reduce-on-azure-with-javascript-analyse-d-1-to-de-journaux-iis-avec-hadoop-map-reduce-en-javascript.aspx)描述了类似的过程。

我希望这会有所帮助。

# performance - 为什么这个缩小的代码在 Opera 浏览器中运行缓慢？

> ID：14388615
> 
> 赞同：2
> 
> 时间：2013-01-17T21:39:45.513
> 
> 标签：performance, compression, minify, google-closure-compiler, yui-compressor

我正在测试 JavaScript 缩小器：Yahoo！YUI Compressor 和 Google Closure Compiler，在[http://text-compare.com中比较视觉结果和在](http://text-compare.com)[http://jsperf.com](http://jsperf.com)中比较性能结果。在我测试过的所有浏览器中，缩小版的效果最好，但在 Opera 中，原始代码的性能最好。有谁知道为什么？我在 Ubuntu 12.10 上使用 Opera 12.12 稳定版。测试页面在这里：http: [//jsperf.com/closure-vs-yui](http://jsperf.com/closure-vs-yui)

非常感谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T19:16:01.200

JS VM 很棘手，通常有一个他们可以调整的语言“甜蜜点”。所有虚拟机都曾偶然发现一个通常只会出现在缩小代码中的问题。

最好向 Opera 提交错误。

# c++ - C++ 代码命名样式转换器、格式化程序或美化器

> ID：14388616
> 
> 赞同：1
> 
> 时间：2013-01-17T21:39:54.493
> 
> 标签：c++, coding-style, naming

我正在寻找一个可以自动转换 c++ 命名样式的好工具，例如将方法名称从“SetPosition()”更改为“setPosition()”，将类名“CPoint”更改为“Point”。似乎大多数格式化程序都没有这样的功能。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:55:34.870

[您可以使用 Clang 操作 C++ 源代码](http://clang.llvm.org/docs/Tooling.html)，尽管您可能需要[编写一些代码](http://eli.thegreenplace.net/2012/06/08/basic-source-to-source-transformation-with-clang/)来进行您想要的转换。

例如，Clang 基础架构将允许您编写一个程序来迭代给定源文件中的所有类方法名称。然后，您可以以编程方式将遇到的任何 pascal-case 方法名称转换为 camel-case 名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T22:13:09.647

代码格式化程序不会重命名函数。您需要的是一个可以执行重命名的重构工具。如果您的项目不是很大，那么 Devexpress 重构！对于 C++（免费）可能会有所帮助。这将涉及一些手动工作，但它比搜索和替换更安全。Qt Creator 有一个内置的重命名报告，我发现它非常可靠（与一些专用的重构工具不同，到目前为止还没有搞砸）。

如果使用重构工具的手动工作太多，那么您可以使用 clangs 构建一个自动执行重构的工具，但这可能比使用重构工具的半手动过程要多。

# java - javafxpackager 错误

> ID：14388619
> 
> 赞同：1
> 
> 时间：2013-01-17T21:40:06.020
> 
> 标签：java, ant, jar, classpath, javafx

我尝试用 javafxpackager 打包我的 javafx 项目。一切正常（包已创建），但我收到错误错误：jfxrt.jar 需要位于类路径上，用于 -createbss 和 -createJar 没有 -nocss2bin 我用来调用 javafxpackager 的 Ant 脚本：

```
<exec executable="javafxpackager">
        <arg value="-createJar"/>
        <arg line="-classpath /jdk/jre/lib/jfxrt.jar"/>
        <arg line="-srcdir build"/>
        <arg line="-appclass org.shark.client.Shark"/>
        <arg line="-outdir packs"/>
        <arg line="-outfile Shark"/>
        <arg line="-manifestAttrs Main-Class=org.shark.client.Shark"/>
    </exec> 
```

我完全无法理解其中的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:16:22.320

如果您已经在 ant 中，为什么不使用 javafx 的 ant 扩展，我在那里没有看到这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:22:18.947

在 exec 块中添加一个额外的参数 -nocss2bin。将 css 转换为二进制格式是一种性能优化，您几乎永远不需要。

```
<exec executable="javafxpackager">
    <arg value="-createjar"/>
    <arg value="-nocss2bin"/>
    ...
</exec> 
```

由于您似乎已经在使用 ant，我建议您使用[JavaFX ant 任务](http://docs.oracle.com/javafx/2/deployment/javafx_ant_task_reference.htm#CIACDJHC)而不是调用[javafxpackager](http://docs.oracle.com/javafx/2/deployment/packager.htm#CCHIHIIJ)（与 tomsontom 建议的相同）。

另请注意，对于 java 7u12+，`jfxrt.jar`应该在默认执行路径上，因此以后的 java 版本应该不会遇到您提到的问题，并且`-nocss2bin`不再需要显式设置。

# javascript - 如何使用二进制搜索比较 Javascript 中的两个数组？

> ID：14388620
> 
> 赞同：0
> 
> 时间：2013-01-17T21:40:06.637
> 
> 标签：javascript

我如何使用二进制搜索来比较两个数组并计算它匹配的次数，我确实在这里找到了一些将一个项目与一个数组进行比较的地方..follwing 是常规的，例如..thanx 的帮助。

```
var a = ["1", "2", "3", "4", "5", "6", "7"];
var b = ["8", "1", "3", "9", "4", "6", "8"];
var count = 0;

for (i = 0; i < a.length; i++) {
    for (j = 0; j < b.length; j++) {
        if (a[i] == b[j]) count += 1;
    }
}

document.write(count); 
```

我试着这样做..

```
for (i = 0; i < a.length; i++) {
    var left = 0;
    var right = b.length - 1;
    while (left <= right) {
        var mid = parseInt((left + right) / 2);
        if (b[mid] == a[i]) {
            count += 1;
        } else if (b[mid] < a[i]) {
            left = mid + 1;
        }
        else {
            right = mid - 1;
        }
    }
}

document.write(count); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:42:08.733

线性遍历`b`数组并使用数组的二进制搜索`a`。

```
function binarySearch(a, value) {
    var left = 0;
    var right = a.length - 1;
    while (left <= right) {
        var mid = (left + right) >> 1;
        if (a[mid] === value) {
            return mid;
        } else if (a[mid] < value) {
            left = mid + 1;
        }
        else {
            right = mid - 1;
        }
    }
    return -1;
}

var a = ["1", "2", "3", "4", "5", "6", "7"];
var b = ["8", "1", "3", "9", "4", "6", "8"];
var count = 0;
b.forEach(function(value) { if (binarySearch(a, value) >= 0) ++count; }); 
```

# git - “我们不能合并的东西”是如何产生的？

> ID：14388625
> 
> 赞同：34
> 
> 时间：2013-01-17T21:40:51.380
> 
> 标签：git, git-merge

这对我来说是一个新的。我是一个相当有经验的 git 用户，并且刚刚在我的 fork 的 repo 中添加了一个遥控器，获取了更新，然后尝试将它们合并到：

```
$ git merge HEAD f6ff240dbf47234249a68b34c8a98bb11237aa7
fatal: f6ff240dbf47234249a68b34c8a98bb11237aa7 - not something we can merge 
```

网络上几乎没有关于此错误消息的信息，这让我感到震惊。我能找到的最接近的是[这个关于处于分离状态的页面](http://micharg.blogspot.co.uk/2012/12/git-troubleshooting-fatal-branch-not.html)。但`git status`报告说我在分支大师。

您可以在 github 上看到我尝试使用的存储库 -[我](https://github.com/aptivate/dye)的存储库和[我想从中提取的远程](https://github.com/qris/ping-dye)。在撰写本文时，我的仓库的主人位于[6dc048862a93ffba6cd37883fd43e40651f248c1](https://github.com/aptivate/dye/commit/6dc048862a93ffba6cd37883fd43e40651f248c1)。

查看历史记录，我可以看到分叉的分歧所在，并且我正在尝试将来自 3 个提交的提交合并到分叉上。这似乎并不难。

要为自己复制，您可以执行以下操作：

```
git clone https://github.com/aptivate/dye
cd dye
git remote add qris git://github.com/qris/ping-dye.git
git fetch qris
git checkout master
git merge f6ff240dbf47234249a68b34c8a98bb11237aa7 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-17T21:44:28.643

这很简单：`f6ff240dbf47234249a68b34c8a98bb11237aa7` 不存在。

我只是意识到你的意思是（注意开头`3f6ff240dbf47234249a68b34c8a98bb11237aa7`的缺失）只需转到提交列表并输入+ 。`3``Ctrl``f` `f6ff`

如果那是你认识的人，你应该告诉他们*总是*从那里分支`master`并提交他们的自定义更改（对于每个更改），而不是直接提交到`master`. 然后他不需要从上游（你）重新定位和强制推送更改，你只需要合并特定的故事分支。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-29T07:48:42.103

我收到了同样的错误信息。就我而言，原因是我在分支名称中使用了 ' **(** ' 和 ' **) '。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-06-03T12:40:25.747

如果我使用错误的引号 ( `HEX UTF-8 bytes E2 80 9C`and `HEX UTF-8 bytes E2 80 9D`) 而不是简单的引号 ( `HEX UTF-8 bytes 22`) 来包含提交消息，则会收到错误消息，请参见下文。

```
Master@HP-ENVY-L MINGW64 ~/desktop/learning/git-practice/p_2 (master)
$ git merge feature-branch -m “Merge feature-branch into master”
merge: into - not something we can merge

Master@HP-ENVY-L MINGW64 ~/desktop/learning/git-practice/p_2 (master)
$ git merge feature-branch -m "Merge feature-branch into master"
Already up-to-date. 
```

发生这种情况是因为我从指令中复制并粘贴了命令，而不是自己输入命令。git 提供的消息相当不具体。

# iphone - NSContactsUsageDescription 不起作用

> ID：14388631
> 
> 赞同：0
> 
> 时间：2013-01-17T21:41:31.107
> 
> 标签：iphone, ios, ios6, abaddressbook

我在我的 Info.plist 文件中为 NSContactsUsageDescription 设置一个字符串；但它没有出现在要求访问联系人权限的警报对话框中。有什么我想念的吗？

我已经尝试过 NSLocationUsageDescription 并且那个工作正常。

为了获得通讯簿对话框，我使用了 ABAddressBookCreateWithOptions 和 ABAddressBookRequestAccessWithCompletion。我不确定我是否应该做一些额外的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T07:38:13.673

这仅支持 iOS6.0 及更高版本，您可以从 Apple 的开发人员参考中看到：

![在此处输入图像描述](../Images/826ae737c5abbe5e1341b4bc83cc5da8.png)

# jquery - jQuery 函数循环

> ID：14388636
> 
> 赞同：0
> 
> 时间：2013-01-17T21:41:54.037
> 
> 标签：jquery, function, loops

我正在努力做到这一点，以便我的网站背景每隔几秒钟随机改变一次颜色。我可以让它变成一个随机的颜色，但我怎么让它循环呢？

```
<script type="text/javascript">
$(document).ready(function() {

    var hue = 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ')';  

    function colourSet(){
       $("body").animate({ backgroundColor: hue}, 2000);
    }   

    colourSet();

});
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:43:32.947

您可以通过让函数将*自身*注册为自己的完成处理程序来使其循环：

```
function colourSet() {
   var hue = 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ')'; 
   $("body").animate({ backgroundColor: hue}, 2000, colourSet);
} 
```

注意：必须在函数内部选择​​色调，否则每次都会保持相同的颜色。

只是为了好玩，您还可以使用一些 Javascript hack (ahem) 使色调代码稍短一些：

```
function r() { return ~~(256 * Math.random()) };
function colourSet() {
   var hue = 'rgb(' + [r(), r(), r()] + ')';
   $("body").animate({ backgroundColor: hue}, 2000, colourSet);
} 
```

which takes advantage of two uses of the bitwise `~` ("not") operator to convert floating point to integer, and also because concatenating an array to a string automatically does a `.toString()` on the array - resulting in a comma separated list.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T21:43:19.593

尝试使用`setInterval`. 见下文，

```
$(document).ready(function() {

    setInterval(function () {
       var hue = 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ')';  
       colourSet(hue);
    }, 30000); //30 seconds

    function colourSet(hue){
       $("body").animate({ backgroundColor: hue}, 2000);
    }   
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T21:43:20.743

使用`setInterval`功能

```
<script type="text/javascript">
$(document).ready(function() {

    setInterval(function(){
        var hue = 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() * 256)) + ')';  

        function colourSet(){
           $("body").animate({ backgroundColor: hue}, 2000);
        }   

        colourSet();
    },60000 /* 60 seconds */);
});
</script> 
```

# c# - 如何添加 EditForm 以编辑行

> ID：14388642
> 
> 赞同：2
> 
> 时间：2013-01-17T21:42:16.397
> 
> 标签：c#, asp.net, gridview

如何`GridView`像[这样](http://demos.telerik.com/aspnet-ajax/grid/examples/dataediting/usercontroleditform/defaultcs.aspx)RadGrid 在 Asp.NET 控件中添加编辑表单行！

当我单击编辑按钮时，我想在编辑按钮行下添加一个编辑表单行。

这是我的网格

```
 <asp:GridView ID="gvEG" runat="server" AutoGenerateColumns="False">
        <Columns>
            <asp:TemplateField>
                <EditItemTemplate>
                    <asp:DropDownList runat="server" ID="ddlPersonnel" />
                </EditItemTemplate>
                <ItemTemplate>
                    //..
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField>
                <EditItemTemplate>
                    //..
                </EditItemTemplate>
                <ItemTemplate>
                    //..
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField>
                <EditItemTemplate>
                    <asp:LinkButton ID="lnkUpdate" runat="server" CommandName="Update" />
                    <asp:LinkButton ID="lnkCancel" runat="server" CommandName="Cancel" />
                </EditItemTemplate>
                <ItemTemplate>
                    <asp:LinkButton ID="lnkEdit" runat="server" CommandName="Edit" />
                    <asp:LinkButton ID="lnkDel" runat="server" CommandName="Delete" />
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
        <EditRowStyle></EditRowStyle>
    </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-21T20:21:59.463

在您的 GridView 属性中添加 AutoGenerateEditButton 和 OnRowEditing 的自定义事件处理程序，如下所示：

```
<asp:GridView ID="gvEG" runat="server" AutoGenerateColumns="False" AutoGenerateEditButton="True" OnRowEditing="gvEG_RowEditing"> 
```

然后在您的代码隐藏中创建一个名为“gvEG_RowEditing”的新事件处理程序方法。让您的方法在正在编辑的行下添加一个面板。将必要的字段添加到面板以及更新按钮。为更新按钮创建一个单击事件处理程序，并让它将所有字段保存到数据库中，然后重新绑定 GridView。

# c# - 为什么 Split from System.String 不接受字符串作为重载？

> ID：14388645
> 
> 赞同：3
> 
> 时间：2013-01-17T21:42:21.540
> 
> 标签：c#, .net, vb.net

> **可能重复：**
> [为什么没有 string.Split(string) 重载？](https://stackoverflow.com/questions/14302564/why-isnt-there-a-string-splitstring-overload)

有几个重载，但没有一个允许发送字符串。这是开发人员经常使用的，至少我的团队是这样。

```
string[] x = "abc|||dev".Split("|||"); 
```

为什么？..

* * *

拜托，我不是在问如何拆分传递字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:44:15.570

```
x.Split(new String[] { "|||" }, StringSplitOptions.None);

Regex.Split(x, @"([a-zA-Z]+)\|\|\|([a-zA-Z]+)");

public static class StringExtensions()
{
    public static String[] Split(this String s, String delimiter)
    {        
        return s.Split(new String[] { delimiter }, StringSplitOptions.None);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:53:09.173

我不能说为什么不包含它，但如果你做了很多字符串拆分，那么扩展方法将是为了帮助你处理你最喜欢的重载。

```
class Program
{
    static void Main(string[] args)
    {
        string[] x = "abc|||dev".Split("|||");
    }
}

public static class StringExtensions
{
    public static string[] Split(this string str, string separator)
    {
        return str.Split(new[] { separator }, StringSplitOptions.None);
    }
} 
```

# ruby-on-rails - rails3-bootstrap-devise-cancan gmaps4raills 地图显示问题

> ID：14388648
> 
> 赞同：0
> 
> 时间：2013-01-17T21:42:33.917
> 
> 标签：ruby-on-rails, gmaps4rails

抱歉，我是一个 Rails 新手，但一直试图让 gmaps4rails 与 twitter bootstrap 一起工作，但遇到了一些死胡同。经过数小时的谷歌搜索后，似乎没有任何东西可以解决它或指向正确的方向。我之前使用未引导的 Rails 应用程序完成了所有步骤，并且它有效，但由于某种原因，地图不会显示在 TBS 版本中。请注意，我使用 rails3-bootstrap-devise-cancan 模板，以防有任何已知问题。

我在视图顶部包含了这个样式表链接：

```
<head>
<% content_for :head do %>
<%= stylesheet_link_tag :gmaps4rails -%>
<% end %>
</head> 
```

……

```
<%= gmaps4rails(@json) %> 
```

在 application.html..erb 的头部

```
 <%= yield :head %> 
```

在控制器索引操作中：

```
@json = Outlet.all.to_gmaps4rails 
```

在模型中：

```
acts_as_gmappable :position => :location
def gmaps4rails_address
address
end 
```

gmaps4rails.css 位于样式表文件夹中，因此应该可以访问。

宝石文件

```
gem 'gmaps4rails'
gem 'twitter-bootstrap-rails' 
```

我还添加了这个宝石

```
gem 'thin' 
```

因为我收到关于内容长度的另一个错误，但我很确定它与 gmaps 问题无关（安装此 gem 之前或之后地图不显示）

此外，当我在 Firefox 中加载应用程序时，我可以从屏幕左下方的活动中看到它似乎已成功连接到 Google Maps API，并且终端中没有显示错误。

这是终端输出。

```
Started GET "/outlets" for 127.0.0.1 at 2013-01-17 21:26:24 +0000
Processing by OutletsController#index as HTML
  Outlet Load (0.2ms)  SELECT "outlets".* FROM "outlets" 
  CACHE (0.0ms)  SELECT "outlets".* FROM "outlets" 
  Rendered /Users/mikemccann/.rvm/gems/ruby-1.9.3-p362@myapp/gems/gmaps4rails-1.5.6/app/views/gmaps4rails/_gmaps4rails.html.erb (1.1ms)
  Rendered outlets/index.html.erb within layouts/application (4.2ms)
  User Load (0.2ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
   (0.1ms)  SELECT COUNT(*) FROM "roles" INNER JOIN "users_roles" ON "roles"."id" = "users_roles"."role_id" WHERE "users_roles"."user_id" = 1 AND (((roles.name = 'admin') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)))
  Rendered layouts/_navigation.html.erb (188.2ms)
  Rendered layouts/_messages.html.erb (0.1ms)
Completed 200 OK in 212ms (Views: 208.7ms | ActiveRecord: 1.6ms) 
```

真的被这个难住了，所以非常感谢任何帮助！！！麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:20:15.040

你是否明确地给你的地图容器 div 一个高度？当您在开发者控制台中查看 HTML 时会发生什么？地图容器 div 中是否显示了与 Gmaps 相关的任何内容？

# java - 在已经运行的 java vm 中运行 testng 套件

> ID：14388652
> 
> 赞同：1
> 
> 时间：2013-01-17T21:42:48.073
> 
> 标签：java, eclipse, jvm, testng

我想为在生成自己的 java vm 的第三方应用程序中执行的 java 类运行测试。由于我的 java 类无法在该 java vm 之外执行（它们使用它提供的服务），因此我的测试也需要在该 java vm 中运行。

我有一个选择是从第三方应用程序（提供 java 命令行）中运行 TestNG 套件：

```
java org.testng.TestNG testng1.xml 
```

另一种选择，也就是我现在要评估的选择，是在 Eclipse 中运行测试。

对于第二种选择，您建议我采用哪种方法？我应该在 Eclipse 中加载第三方应用程序吗？我想我被困住了。

# jquery - 使用来自 JQuery 的文本设置 ASP 标签控件

> ID：14388670
> 
> 赞同：1
> 
> 时间：2013-01-17T21:43:49.580
> 
> 标签：jquery, asp.net

我是 JQuery 的新手，我正在编写代码来检查注册表单。这是我在服务器页面中的标签：

```
<asp:Label ID="LabelErrorFirstName" runat="server" ForeColor="Red" Font-Size="Small"></asp:Label> 
```

和我的 JQuery 脚本：

```
if(firstnameTxt.length == '') {
      $('#<%= LabelErrorFirstName.ClientID %>').text("Please enter a first name.");

  } 
```

我从 OnClientClick 事件中的一个按钮访问此脚本，该按钮位于我知道有效的表单上，即我在此处设置了警报，表明它正在到达那里。我已经注释掉了“if”语句，以防万一这是问题，但事实并非如此。

我想要发生的是，如果名字文本框为“请输入..”等，则设置此标签的文本属性。我尝试了很多变体，但我无法得到它。

我错过了什么？

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:22:52.870

长度是整数而不是字符串。

```
if(firstnameTxt.length == 0) {
    $('#<%= LabelErrorFirstName.ClientID %>').text("Please enter a first name.");
} 
```

另外，请确保 jquery 可以找到您的标签：

```
if( $("#<%= LabelErrorFirstName.ClientID %>").length > 0 ) {
} 
```

# php - 第一次保存时的 Symfony 实体

> ID：14388671
> 
> 赞同：0
> 
> 时间：2013-01-17T21:43:53.947
> 
> 标签：php, database, symfony, doctrine

在使用教义的 Symfony 中，在将实体保存/持久化到数据库之前运行某个功能的最佳方法是什么。我只希望它在其生命周期中运行一次，所以我猜构造函数不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:30:30.220

使用文档中解释的**LifecycleCallback ：** [http](http://symfony.com/doc/current/book/doctrine.html#lifecycle-callbacks) : //symfony.com/doc/current/book/doctrine.html#lifecycle-callbacks`PrePersist`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T05:04:27.160

或者

`$em->persist($entity);`您可以在控制器中的函数之前调用该函数。

但是`PrePersist`对于测试和小东西来说，这是更清洁的方法，您可以放在保存功能之前

# android - onActivityResult 没有从 Intent 中获取字符串

> ID：14388675
> 
> 赞同：1
> 
> 时间：2013-01-17T21:44:13.177
> 
> 标签：android, android-intent

我需要一些关于我的 android 应用程序的帮助。我有两个活动，第一个以`startActivityForResult()`. 当第二个关闭时，它会发送应有的意图，但是当我想从中访问额外内容时，`onActivityResult()`我得到一个 null 而不是我输入的内容。我还尝试使用 bundle with

```
Bundle b = getIntent().getExtras();
b.getString(AddTable.EXTRA_NAME); 
```

但它导致了 RuntimeException 和失败的交付结果。

这是我的代码：

```
public class RunnerApp extends Activity {

    private ListView listView;
    private static ArrayList<String> values = new ArrayList<String>();
    private ArrayAdapter<String> adapter;
    private Intent newTable;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_runner_app);
        listView = (ListView) findViewById(R.id.mylist);
        adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, android.R.id.text1, values);
        listView.setAdapter(adapter);
    }

    public void addTable(View v){
        newTable = new Intent(this, AddTable.class);
        startActivityForResult(newTable, 1);
    }
    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data){
        super.onActivityResult(requestCode, resultCode, data);
        if(requestCode == 1 && resultCode == Activity.RESULT_OK && data != null){
        data = getIntent();
        Log.d("add", "got intent");
        String newName = data.getStringExtra(AddTable.EXTRA_NAME);
            Log.d("add", "string " + newName); //always prints string null
            values.add(newName);
            Log.d("add", "added to list");
        }
    }

    @Override
    public void onResume(){
        super.onResume();
        setContentView(R.layout.activity_runner_app);
        adapter.notifyDataSetChanged();
    }
} 
```

第二个活动开始于`startActivityForResult()`

```
public class AddTable extends Activity {

    public final static String EXTRA_NAME = "com.example.runnerapp.NAME";
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_add_table);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_add_table, menu);
        return true;
    }

    public void addThisTable(View v) {
        Intent addTable = new Intent(this, RunnerApp.class);
        EditText editText = (EditText) findViewById(R.id.addTableField);
        String name = editText.getText().toString();
        addTable.putExtra(EXTRA_NAME, name);
        Log.d("intenyt", name);
        setResult(Activity.RESULT_OK, addTable);
        this.finish();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:49:27.213

在您的第一个活动中，您的代码读取

```
data = getIntent(); 
```

但你想要的实际数据在

```
data.getData() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-10T03:01:59.113

在 onActivityResult 函数中使用它..

```
data.getStringExtra(EXTRA_NAME) 
```

# css - 渐变全尺寸背景 CSS

> ID：14388678
> 
> 赞同：0
> 
> 时间：2013-01-17T21:44:22.410
> 
> 标签：css, background, height, width

# 整页 CSS3 渐变背景：

好的，所以我试图让我的背景成为一个始终为 100% 宽度和高度的渐变，并且它可以工作，除了它上面不会显示任何东西。这是我目前拥有的代码。

## CSS：

```
<style type="text/css" media="screen">
#bodyBg{
    background:rgb(79,143,249) no-repeat center center fixed; /* Old browsers */
    background: -moz-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%, rgba(79,143,249,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(1%,rgba(164,197,252,1)), color-stop(100%,rgba(79,143,249,1))); /* Chrome,Safari4+ */
    background: -webkit-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* Opera 12+ */
    background: -ms-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* IE10+ */
    background: radial-gradient(ellipse at center,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#a4c5fc', endColorstr='#4f8ff9',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
    min-height: 100%;
    min-width: 1024px;
    width: 100%;
    height: auto;
    position: fixed;
    top: 0;
    left: 0;
    z-index:0;
}
    @media screen and (max-width: 1024px) { /* Specific to this particular image */
#bodyBg {
    left: 50%;
    margin-left: -512px;   /* 50% */
}
#body-404 {
    position: relative;
    margin: 50px auto;
    width:880px;
    text-align:center;
    color:white;
    font-family: "Helvetica Neue", "URW Palladio L", Arial, Helvetica, "Palatino Linotype";
    z-index:99;
}
</style> 
```

## HTML：

```
<div id="body-404">
    <img src="img/logo.png" width="100%">
    <h1><span>Sorry the page you were looking for was not found</span></h1>
    <p>If you believe you got to this page in error, please contact us via <a href="contactus.php">this page</a>.</p><br />
    <font size="120%"><a href="index.php">Return to Homepage</font>
</div>
<div id="bodyBg"></div> 
```

## 演示：

[http://mysteriousorigin.com/missing.html](http://mysteriousorigin.com/missing.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T22:23:19.170

通常认为拥有像您这样的空元素是不好的做法`#bodyBg`。只需将背景渐变放在 html（或 body）元素上，去掉无用的 div：

[http://jsfiddle.net/2yVRA/1/](http://jsfiddle.net/2yVRA/1/)

```
html {
    background:rgb(79,143,249) no-repeat center center fixed; /* Old browsers */
    background: -moz-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%, rgba(79,143,249,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(1%,rgba(164,197,252,1)), color-stop(100%,rgba(79,143,249,1))); /* Chrome,Safari4+ */
    background: -webkit-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* Opera 12+ */
    background: -ms-radial-gradient(center, ellipse cover,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* IE10+ */
    background: radial-gradient(ellipse at center,  rgba(164,197,252,1) 1%,rgba(79,143,249,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#a4c5fc', endColorstr='#4f8ff9',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
    min-height: 100%;
}
    @media screen and (max-width: 1024px) { /* Specific to this particular image */

body-404 {
    position: relative;
    margin: 50px auto;
    width:880px;
    text-align:center;
    color:white;
    font-family: "Helvetica Neue", "URW Palladio L", Arial, Helvetica, "Palatino Linotype";
    z-index:99;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:59:08.553

使用`background-image`CSS 属性而不是使用图像标签。我做了一个快速的[jsfiddle](http://jsfiddle.net/aqCW6/1/)来说明我的意思。我知道这不是你想要的，但你应该能够很快改变它以供你使用。如果没有，请告诉我。

# c# - HtmlAgilityPack，获取带有标签的节点序列

> ID：14388679
> 
> 赞同：1
> 
> 时间：2013-01-17T21:44:24.020
> 
> 标签：c#, html-agility-pack

想象一个与此类似的 Html 文档

```
 <div>
      <div>...</div>
      <table>...</table>
      <p>...</p>
      <p>...</p>
      <p>...</p>
      <table>...</table>
      <p>...</p>
      <div>...</div>
      <p>...</p>
      <p>...</p>
    </div> 
```

我想取第一个段落节点序列。我试图遍历 p 检查的节点集合，`nextSibling`直到找到与 p 不同的名称，但这始终是文本。

更具体地说，我想要的是从维基百科页面获取文本的第一部分。我的意思是，之前的所有段落都找到了一个非段落，例如目录或其他页面上的页面末尾。在之前的示例中，我想使用前三段的 HtmlDocument。

我可以将其转换为字符串，并使用`IndexOf`. 但是我更喜欢更通用的解决方案，因为我不知道我会在维基百科页面中找到什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:49:27.540

您可以将 SkipWhile 和 TakeWhile 与 div 中的子列表结合使用。

```
 var children = doc.DocumentNode.SelectNodes("/div/*");
 var paragraphs = children
      .SkipWhile(child => !string.Equals(child.Name, "p", StringComparison.OrdinalIgnoreCase))
      .TakeWhile(child => string.Equals(child.Name, "p", StringComparison.OrdinalIgnoreCase)); 
```

# android - 跳过已删除/空行 sqlite

> ID：14388681
> 
> 赞同：0
> 
> 时间：2013-01-17T21:44:25.037
> 
> 标签：android, sqlite, for-loop, achartengine

我正在从 sqlite 数据库填充 AChartEngine，我需要显示所有数据。我遇到的问题是，当我删除一条记录时，图表系列会停止填充已删除的记录。我需要找到一种方法来跳过已删除/空记录并继续填充我的图表。我需要它以与 listview 跳过已删除记录并继续显示所有行的方式相同的方式执行此操作。我对很多事情都很陌生，并且对此感到非常困难。我试图编写 if 语句以跳过已删除/空行，但似乎没有任何效果。谢谢你的帮忙！

在我的绘图活动中：

```
 for (int i = 1; !c.isAfterLast(); i++)  {

         String value1 = db.getValue1(i);
         String value2 = db.getValue2(i);

         c.moveToNext();

         double x7 = Double.parseDouble(value1);
         double y7 = Double.parseDouble(value2);

         myseries.add(x7, y7);  

         } 
```

我收到错误： `CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0`

如果我用 try and catch 包围它，它将填充行直到删除的记录。

我的 sqlite 数据库中的“编辑”：

```
 public String getValue1(long l) {
    String[] columns = new String[]{ EMP_DEPT };
    Cursor c = db.query(EMP_TABLE, columns, EMP_ID + "=" + l, null, null, null, null);
    if (c != null){
    c.moveToFirst();
    String value1 = c.getString(0);

        return value1;

    }
    return null;
    }

public String getValue2(long l) {
    String[] columns = new String[]{ EMP_DATE1 };
    Cursor c = db.query(EMP_TABLE, columns, EMP_ID + "=" + l, null, null, null, null);
    if (c != null){
    c.moveToFirst();
    String value2 = c.getString(0);

        return value2;

    }
    return null;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:05:46.370

您应该使用单个查询一次获取所有值：

```
SELECT Date1 FROM MyTable WHERE id BETWEEN 1 AND 12345 
```

或者：

```
db.query(EMP_TABLE, columns, EMP_ID + " BETWEEN 1 AND " + ..., ...); 
```

然后，当您遍历光标时，缺失值将不会显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:06:14.963

您的问题是，您对不存在的行上的命令的安全网是使用`if (c != null){`然后在该块内执行您的命令，*但是*来自查询的`Cursor`请求永远不会出现`null`，而是会导致没有行的游标对象.

将其用作安全网的更合适的解决方案因为如果该方法实际上首先执行了它，则该`if (c.moveToFirst()){`方法本身返回一个for -如果它移动了，如果没有（当没有行可以移动时发生）。如果您愿意，另一个检查是查看游标有多少行。`boolean``true``false``c.getCount()`

此外，您应该组合您的方法，以免对数据库进行冗余查询：

```
public String[] getValues(long l) {
    String[] results = new String[2]; 
    String[] columns = new String[]{ EMP_DEPT, EMP_DATE1 };
    Cursor c = db.query(EMP_TABLE, columns, EMP_ID + "=" + l, null, null, null, null);
    if (c.moveToFirst()) {
        results[0] = c.getString(0);
        results[1] = c.getString(1);
    } else {
        Log.d("GET_VALUES", "No results formed from this query!");
    }
    return results;
} 
```

# javascript - 将输入字段中的文本写入值 onkeyup

> ID：14388686
> 
> 赞同：-1
> 
> 时间：2013-01-17T21:44:34.923
> 
> 标签：javascript, jquery, html

是否可以使用 jquery 或 javascript 将我输入到文本中的文本写入输入的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:55:09.590

不太确定您要做什么，但也许这会有所帮助：

```
$('.textarea').keyup(function() {
   $('.another_input').val(this.value);
}); 
```

# java - Mac/Java-7：为什么当 Alt 关闭时 TextField 没有得到预期的 KEY_PRESSED 事件？

> ID：14388689
> 
> 赞同：2
> 
> 时间：2013-01-17T21:44:43.663
> 
> 标签：java, macos, java-7

在执行包含“Alt”的键盘事件时，Mac/Java-7 不会针对 TextField 的键序列中的非修饰键传播 KEY_PRESSED。

此行为无法针对其他修饰键（如 Cmd 或 Ctrl）重现。

例如，当编译和运行以下代码并在 TextField 中执行 'Alt + o' 击键时，除 Mac/Java 7 之外的所有平台都输出以下键事件序列（请注意，对于 'alt ' 和 'o'):

java.awt.event.KeyEvent[KEY_PRESSED,keyCode=18,keyText=?,keyChar=未定义keyChar,修饰符=?

java.awt.event.KeyEvent[KEY_PRESSED,keyCode=79,keyText=O,keyChar='ø',修饰符=?

java.awt.event.KeyEvent[KEY_TYPED,keyCode=0,keyText=Unknown keyCode: 0x0,keyChar='ø',modifiers=?

java.awt.event.KeyEvent[KEY_RELEASED,keyCode=79,keyText=O,keyChar='ø',修饰符=?...

java.awt.event.KeyEvent[KEY_RELEASED,keyCode=18,keyText=?,keyChar=未定义...

但是，在 Mac/Java-7（测试到补丁 10）上，您会得到上面没有代表 'o' 的 KEY_PRESSED (KEY_PRESSED,keyCode=79,keyText=O,keyChar='ø')。KEY_TYPED 事件可能不是最有用的替代品，因为它没有修饰符或 keyCode，至少没有跟踪某些状态。

```
import javax.swing.*;
import java.awt.event.*;

public class ScratchKeyEvent {
  public static void main(String[] args) {
    JFrame frame = new JFrame();
    JPanel panel = new JPanel();

    JTextField field = new JTextField(10);

    field.addKeyListener(createListener());

    frame.add(panel);
    panel.add(field);
    frame.setVisible(true);
    frame.pack();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
}

private static KeyListener createListener() {
    return new KeyListener() {
        @Override
        public void keyTyped(KeyEvent e) {
            System.out.println("keyTyped " + e);
        }

        @Override
        public void keyPressed(KeyEvent e) {
            System.out.println("keyPressed " + e);
        }

        @Override
        public void keyReleased(KeyEvent e) {
            System.out.println("keyReleased " + e);
        }
    };
  }
} 
```

# asp.net - 验证用户的最佳方式？

> ID：14388690
> 
> 赞同：1
> 
> 时间：2013-01-17T21:44:43.970
> 
> 标签：asp.net, vb.net, security, session, cookies

我意识到这个问题可能是主观的，但我在这方面还很陌生，虽然关于这个主题有很多。我还不能对此形成一个好的意见，我认为这可能部分是因为我是新手，我只能从我的项目的角度来思考，这并没有什么不寻常的。

所以我在我的环境中问什么是身份验证的最佳选择？什么方法是最好的会话？饼干？还有什么？另外，您如何安全地将密码保存在表格中？我研究了数据类型，但这似乎产生了任何帮助。表格和/或列有什么特别的地方吗？最终，我很想在我的网站 {ie Facebook、Google、OpenID} 中添加其他身份验证方法，但我认为我需要先了解这一点。

我的环境是 ASP.NET，代码在 VB 中。我正在使用 MSSQL 2005（但如果需要可以访问 2008）。

谢谢乔什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:05:35.977

我不熟悉 ASP，所以我无法回答您如何最好地在整个会话期间进行通信和保留凭据。听起来像其他人建议的那样，使用内置的会员系统是最安全的方法。但是，我完全同情您希望自己做事并了解他们如何在幕后工作的愿望。如果您确实想自己解决这个问题，我可以谈谈数据库方面的事情。

如果可能的话，永远不要将实际密码存储在任何地方。您应该只存储从密码生成的不可逆加密值（使用哈希加密算法，例如[SHA512Managed](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512managed.aspx)）。要对用户进行身份验证，而不是解密存储的密码并比较两个纯文本密码，您希望加密输入的密码，然后比较两个加密值。如果您存储实际密码，即使使用可逆加密算法对其进行加密，也存在很大的安全风险。

此外，如果您使用的加密算法允许您指定种子值，则应使用算法根据原始密码生成种子值。您不想为每个密码使用相同的加密种子值。

此外，大多数加密方法都设计得很快，因此它们可以用于通信流。但是，如果它们很快，这意味着有人可以更快地暴力破解它们。因此，使加密更安全的最佳方法是使它们尽可能慢。这通常是通过在循环中一遍又一遍地重新加密加密值固定次数来实现的。

# json - 如何在嵌入式系统上用 jsmn 解析一个小的 JSON 文件？

> ID：14388692
> 
> 赞同：12
> 
> 时间：2013-01-17T21:44:47.597
> 
> 标签：json, embedded, jsonparser, jsmn

我需要在嵌入式系统上解析一个小的 JSON 文件（只有 10K RAM/闪存）。JSON是：

```
{
"data1":[1,2,3,4,5,6,7,8,9],
"data2":[
     [3,4,5,6,1],
     [8,4,5,6,1],
     [10,4,5,3,61],
     [3,4,5,6,1],
     [3,4,5,6,1],
     [3,4,5,6,1] 
]} 
```

**[jsmn](https://bitbucket.org/zserge/jsmn/wiki/Home)**看起来很适合这个要求，但它不像大多数 JSON 解析器，因为它只给你令牌。我试过了，但无法弄清楚。

有人可以分享一个如何用jsmn解析它的例子吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-05T01:20:14.273

jsmn 将为您提供一组标记，这些标记引用您从左到右读取的 JSON 中的标记。

在你的情况下：

```
token[0]: (outer) object, 2 children
token[1]: string token ("data1")
token[2]: array, 9 children
token[3]: primitive token (1)
etc... 
```

进行解析的基本代码是：

```
int resultCode;
jsmn_parser p;
jsmntok_t tokens[128]; // a number >= total number of tokens

jsmn_init(&p);
resultCode = jsmn_parse(&p, yourJson, tokens, 256); 
```

另一个技巧是获取代币的价值。令牌包含原始字符串上数据的起点和终点。

```
jsmntok_t key = tokens[1];
unsigned int length = key.end - key.start;
char keyString[length + 1];    
memcpy(keyString, &yourJson[key.start], length);
keyString[length] = '\0';
printf("Key: %s\n", keyString); 
```

有了它，您应该能够弄清楚如何遍历您的数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-08-10T06:17:14.490

我对此也很好奇，所以我做了一个小程序来显示令牌数组的结构：

这个程序：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include "jsmn.h"

jsmntok_t t[512];
char jsonStr[512*1024];

int main()
{
  size_t pos = 0;
  int    c;
  while ((c = getchar()) != EOF)
  {
    jsonStr[pos] = c;
    ++pos;
    if (pos == sizeof(jsonStr)) break;
  }
  jsonStr[pos] = 0;

  jsmn_parser p;
  jsmn_init(&p);

  int tCount = jsmn_parse(&p, jsonStr, strlen(jsonStr), t, sizeof(t)/sizeof(*t));

  for (int i = 0; i != tCount; ++i)
  {
    jsmntok_t *token = t + i;
    char * type = 0;
    switch (token->type)
    {
      case JSMN_PRIMITIVE:
        type = "PRIMITIVE";
        break;
      case JSMN_OBJECT:
        type = "OBJECT";
        break;
      case JSMN_ARRAY:
        type = "ARRAY";
        break;
      case JSMN_STRING:
        type = "STRING";
        break;
      default:
        type = "UNDEF";
    }
#ifdef JSMN_PARENT_LINKS
    printf("node: %4d, %9s, parent: %4d, children: %5d, data:\n%.*s, \n", i, type, token->parent, token->size, token->end-token->start, jsonStr+token->start);
#else
    printf("node: %4d, %9s, children: %5d, data:\n%.*s, \n", i, type, token->size, token->end-token->start, jsonStr+token->start);
#endif
  }
} 
```

打印此 json（取自：[https](https://en.wikipedia.org/wiki/JSON) ://en.wikipedia.org/wiki/JSON ）：

```
{
  "firstName": "John",
  "lastName": "Smith",
  "isAlive": true,
  "age": 25,
  "address": {
    "streetAddress": "21 2nd Street",
    "city": "New York",
    "state": "NY",
    "postalCode": "10021-3100"
  },
  "phoneNumbers": [
    {
      "type": "home",
      "number": "212 555-1234"
    },
    {
      "type": "office",
      "number": "646 555-4567"
    },
    {
      "type": "mobile",
      "number": "123 456-7890"
    }
  ],
  "children": [],
  "spouse": null
} 
```

作为：

```
node:    0,    OBJECT, parent:   -1, children:     8, data:
{
  "firstName": "John",
  "lastName": "Smith",
  "isAlive": true,
  "age": 25,
  "address": {
    "streetAddress": "21 2nd Street",
    "city": "New York",
    "state": "NY",
    "postalCode": "10021-3100"
  },
  "phoneNumbers": [
    {
      "type": "home",
      "number": "212 555-1234"
    },
    {
      "type": "office",
      "number": "646 555-4567"
    },
    {
      "type": "mobile",
      "number": "123 456-7890"
    }
  ],
  "children": [],
  "spouse": null
},
node:    1,    STRING, parent:    0, children:     1, data:
firstName,
node:    2,    STRING, parent:    1, children:     0, data:
John,
node:    3,    STRING, parent:    0, children:     1, data:
lastName,
node:    4,    STRING, parent:    3, children:     0, data:
Smith,
node:    5,    STRING, parent:    0, children:     1, data:
isAlive,
node:    6, PRIMITIVE, parent:    5, children:     0, data:
true,
node:    7,    STRING, parent:    0, children:     1, data:
age,
node:    8, PRIMITIVE, parent:    7, children:     0, data:
25,
node:    9,    STRING, parent:    0, children:     1, data:
address,
node:   10,    OBJECT, parent:    9, children:     4, data:
{
    "streetAddress": "21 2nd Street",
    "city": "New York",
    "state": "NY",
    "postalCode": "10021-3100"
  },
node:   11,    STRING, parent:   10, children:     1, data:
streetAddress,
node:   12,    STRING, parent:   11, children:     0, data:
21 2nd Street,
node:   13,    STRING, parent:   10, children:     1, data:
city,
node:   14,    STRING, parent:   13, children:     0, data:
New York,
node:   15,    STRING, parent:   10, children:     1, data:
state,
node:   16,    STRING, parent:   15, children:     0, data:
NY,
node:   17,    STRING, parent:   10, children:     1, data:
postalCode,
node:   18,    STRING, parent:   17, children:     0, data:
10021-3100,
node:   19,    STRING, parent:    0, children:     1, data:
phoneNumbers,
node:   20,     ARRAY, parent:   19, children:     3, data:
[
    {
      "type": "home",
      "number": "212 555-1234"
    },
    {
      "type": "office",
      "number": "646 555-4567"
    },
    {
      "type": "mobile",
      "number": "123 456-7890"
    }
  ],
node:   21,    OBJECT, parent:   20, children:     2, data:
{
      "type": "home",
      "number": "212 555-1234"
    },
node:   22,    STRING, parent:   21, children:     1, data:
type,
node:   23,    STRING, parent:   22, children:     0, data:
home,
node:   24,    STRING, parent:   21, children:     1, data:
number,
node:   25,    STRING, parent:   24, children:     0, data:
212 555-1234,
node:   26,    OBJECT, parent:   20, children:     2, data:
{
      "type": "office",
      "number": "646 555-4567"
    },
node:   27,    STRING, parent:   26, children:     1, data:
type,
node:   28,    STRING, parent:   27, children:     0, data:
office,
node:   29,    STRING, parent:   26, children:     1, data:
number,
node:   30,    STRING, parent:   29, children:     0, data:
646 555-4567,
node:   31,    OBJECT, parent:   20, children:     2, data:
{
      "type": "mobile",
      "number": "123 456-7890"
    },
node:   32,    STRING, parent:   31, children:     1, data:
type,
node:   33,    STRING, parent:   32, children:     0, data:
mobile,
node:   34,    STRING, parent:   31, children:     1, data:
number,
node:   35,    STRING, parent:   34, children:     0, data:
123 456-7890,
node:   36,    STRING, parent:    0, children:     1, data:
children,
node:   37,     ARRAY, parent:   36, children:     0, data:
[],
node:   38,    STRING, parent:    0, children:     1, data:
spouse,
node:   39, PRIMITIVE, parent:   38, children:     0, data:
null, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-04T12:44:50.567

您可以使用[tiny-json](https://github.com/rafagafe/tiny-json)。它给你的不仅仅是代币。我用过 16 位和 32 位的微控制器，它工作正常。

```
char str[] = "{"
                 "\"data1\":[1,2,3,4,5,6,7,8,9],"
                 "\"data2\":["
                     "[3,4,5,6,1],"
                     "[8,4,5,6,1],"
                     "[10,4,5,3,61],"
                     "[3,4,5,6,1],"
                     "[3,4,5,6,1],"
                     "[3,4,5,6,1]"
                 "]"
             "}";
puts( str );

json_t pool[64];
json_t const* root = json_create( str, pool, 64 );

json_t const* data1 = json_getProperty( root, "data1" );
if ( data1 && JSON_ARRAY == json_getType( data1 ) ) {

    json_t const* field = json_getChild( data1 );
    while( field ) {

        if ( JSON_INTEGER == json_getType( field ) ) {
            long long int data = json_getInteger( field );
            printf("Integer from data1: %lld\n", data );
        }

        field = json_getSibling( field );
    }
}

json_t const* data2 = json_getProperty( root, "data2" );
if ( data2 && JSON_ARRAY == json_getType( data2 ) ) {

    json_t const* array = json_getChild( data2 );
    while( array ) {

        if ( JSON_ARRAY == json_getType( array ) ) {
            puts("Array in data2");

            json_t const* field = json_getChild( array );
            while( field ) {

                if ( JSON_INTEGER == json_getType( field ) ) {
                    long long int data = json_getInteger( field );
                    printf("Integer from array of data2: %lld\n", data );
                }

                field = json_getSibling( field ); 
            }
        }
        array = json_getSibling( array );
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-27T18:31:38.907

我刚刚创建了 jsmnRipper。这段代码让你以一种非常简单的方式提取用 jsmn 解析的标记。

这里以 ACRCloud 返回的 JSON 消息的解析结果为例

*   metadata.music[1].score:100:
*   metadata.music[1].album.name:Depeche Mode 最佳卷 1:
*   metadata.music[1].artists[0].name:Depeche 模式：
*   metadata.music[1].title:Enjoy The Silence (Remastered Version) (Original):

[您可以在https://github.com/ipserc/jsmnRipper](https://github.com/ipserc/jsmnRipper)找到执行此操作的代码

# sqlite - Sqlite insertOrThrow() 失败，找不到数据库文件错误

> ID：14388695
> 
> 赞同：0
> 
> 时间：2013-01-17T21:45:02.973
> 
> 标签：sqlite

我很难让任何插入与 SqlLite 一起工作。我有一个使用以下模式创建的表： create table drink_category (_id integer not null primary key autoincrement, value unique);

附加代码运行时，我收到 SQLiteCantOpenDatebaseException 错误消息“无法打开数据库文件（代码 14）”。

正如您在代码中看到的，我使用查询访问表没有问题。我还做了一个 db.isOpen() 来验证数据库是否正常。我什至在插入块之后添加了代码，一切正常。任何帮助将不胜感激。

```
public Boolean add(String strValue)
{
    Boolean    bStatus  = true;
    String     strSql;
    String     sqlValue = strValue.replaceAll("'","\'\'");

    if (bStatus)
    {
        if (strValue.isEmpty())
        {
            BarDB.getInstance().setErrorMessage("No value entered.");
            bStatus = false;
        }
    }
    if (bStatus)
    {
               strSql = "select value from " + "drink_category" + " where value = '" + sqlValue + "' "; 
        Cursor cursor = SqlDbAdapter.getInstance().getDatabase().rawQuery(strSql, null);

        if (null == cursor)
        {
            BarDB.getInstance().setErrorMessage("Problem with the database.");
            bStatus = false;

        }
        else if (cursor.getCount() > 0)
        {
            BarDB.getInstance().setErrorMessage("A Drink Category with that name already exists.");
            bStatus = false;
        }
    }
    if (bStatus)
    {
        ContentValues cvValues = new ContentValues();
        cvValues.put("value", sqlValue);
        SQLiteDatabase db = SqlDbAdapter.getInstance().getDatabase();

        if (db.isOpen())
        {
            try
            {
                long lerror = db.insertOrThrow("drink_category", null, cvValues);
            }
            catch (SQLiteException sqle)
            {
                BarDB.getInstance().setErrorMessage(sqle.toString());
                bStatus = false;
            }
        }
    }
     return bStatus;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T17:56:45.640

找到它：我在模拟器上运行它，我将数据库文件存储在 /data/data 中。我猜当您进行插入时，sqlite 需要写入日志文件并且该目录是只读的。我将数据库移至 /data/data//databases，现在一切正常。更好的错误消息会更有帮助！

# javascript - DIV 内容淡入/淡出混乱

> ID：14388698
> 
> 赞同：0
> 
> 时间：2013-01-17T21:45:11.563
> 
> 标签：javascript, jquery, ajax, fade

我搜索了 StackOverflow 帖子和各种论坛，但找不到答案。我已经找到了类似问题的答案，但没有什么能把它分解得足以让我理解。我了解很多 PHP 和 HTML，但在编写脚本时遇到了困难。

如何单击链接，获取href（或我需要什么？），让它淡出当前内容，找到我要加载的内容（href或链接中的任何内容）并加载它，*然后*淡入淡出？

我之前尝试过的随机代码问题：

1.  如果在加载时单击另一个链接，则在从一页到另一页时，它只会部分淡入第二页。

2.  每个链接都必须有自己的脚本才能将其定向到那里。永远无法弄清楚如何让它获得点击链接的href。

3.  示例太复杂了，我无法将它们修改为我所需要的。我需要了解它的过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:51:04.653

就像是：

```
$('.link').on('click', function(){
   $('.content').fadeOut().load('/path/to/script', function() {
      $(this).fadeIn();
   });
}); 
```

使用可以返回所需内容的 HTML 页面或 PHP 脚本的关键。您可能希望从另一个元素中检索 URL 或将其硬编码到您的脚本中 - 您的调用。有关如何`load()`工作的更多信息，[请访问 jQuery 的文档](http://api.jquery.com/load/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:57:11.547

实际上，我前段时间开发了类似的东西。

诀窍（或技巧）是将您的页面包装为 an `iframe`，并在父窗口上具有一个 div 元素，该元素在请求页面时淡入视图，并在页面加载时淡出。

父窗口如下所示：

```
<!DOCTYPE html>
<html>
    <head>
        <title>&lt; Page1 &gt;</title>
        <style>
            html, body{
                font-family:helvetica;
            }
            #fade, iframe {
                position:absolute;
                left:0px;
                top:0px;
                width:100%;
                height:100%;
                border-width:0px;
                z-index:-1;

                opacity:0;

                color:#AAA;
                background-color:#FFF;

                -webkit-transition: opacity 300ms;
                -moz-transition: opacity 300ms;
                -o-transition: opacity 300ms;

            }
            iframe {

                opacity:1;

                z-index:1;
                background-color:#FFF;
            }
        </style>
    </head>
    <body>
        <div id="fade">
        <h1>Loadin..</h1>
        </div>
        <iframe src="p1.html"></iframe>

        <script>

            var fade    = document.getElementById("fade");
            var iframe  = document.getElementsByTagName("iframe")[0];

            var t = null;

            addEventListener("message", function(e) {

                if(t!=null)clearTimeout(t);

                fade.style.zIndex = "2";

                t=setTimeout(function(){
                    fade.style.opacity = "1";
                },0);

            }, true);

            iframe.addEventListener("load", function() {

                if(t!=null)clearTimeout(t);

                t=setTimeout(function(){
                    fade.style.opacity = "0";
                },0);

                document.title = iframe.contentWindow.document.title;

                t=setTimeout(function(){
                    fade.style.zIndex = "-1";
                },300);

            }, true);

        </script>

    </body>
</html> 
```

每个子页面都有以下代码：

```
<script>
function go() {
    window.parent.postMessage("showLoadScreen", "*");
}
</script>
<a href="somepage.html" onclick="go()">somepage.html</a> 
```

这段代码有点不同，除非请求的资源需要一段时间才能加载，否则推子不会弹出。但是，你明白了。

由于`iframe`仅出于视觉目的而存在，因此*不会*引起任何重大问题。但是，请注意，此代码使用 HTML5 的`postMessage`API，您可能需要对其进行一些调整。

# ruby - 红宝石——岩石，纸。剪刀比赛

> ID：14388700
> 
> 赞同：2
> 
> 时间：2013-01-17T21:45:23.930
> 
> 标签：ruby

我需要实现一个石头剪刀布锦标赛模拟器，它将玩所有回合并返回锦标赛。

这是我的锦标赛数组：

```
tournament = [
    [
        [ 
            ["Armando", "P"], ["Dave", "S"] 
        ],
        [ 
            ["Richard", "R"],  ["Michael", "S"] 

        ],
    ],
    [
        [ ["Allen", "S"], ["Omer", "P"] ],
        [ ["David E.", "R"], ["Richard X.", "P"] ]
    ]
] 
```

例如 ["Richard", "R"], ["Michael", "S"] 代表理查德玩剪刀石头布的游戏。理查德应该是获胜者并晋级下一轮。

我正在尝试为此实现递归函数，但我无法正确设置数组

这是我的方法：

```
 def rps_tournament_winner(tournament)

  qualifying_round_winners = []
   round_winners = []
  # last round

  if tournament.length < 1
    return
  end

  tournament.each_with_index do |round,i|   
 puts round.inspect
     qualifying_round_winners[i] = []
     round_winners = []
     round.each_with_index do |game,j|
         winner = rps_game_winner(game)
         round_winners.push winner
     end
     qualifying_round_winners[i] = round_winners

  end

  rps_tournament_winner(qualifying_round_winners)
end 
```

我已经为排位赛的获胜者发明了很多阵列，但无法找到解决方案。希望您能够帮助我。谢谢你。

编辑：

这是我在方法的每次迭代中应该得到的

第一轮过后

```
tournament = [
    [
        [ 
            ["Dave", "S"], ["Richard", "R"] 
        ],
        [ 
            ["Allen", "S"],  ["Richard X.", "P"] 

        ]
    ]
] 
```

第二轮过后：

```
tournament = [
    [
        [ 
            ["Richard", "R"] , ["Allen", "S"]
        ]
    ]
] 
```

优胜者

```
["Richard", "R"] 
```

**编辑：2**

这是完整的代码： http: [//pastebin.com/gjKfiWLD](http://pastebin.com/gjKfiWLD)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T23:32:25.733

我们在递归时必须考虑两种情况：

rps_tournament_winner 的论点是一场比赛，或者rps_tournament_winner 的论点是一场锦标赛。请注意，锦标赛的一个小节本身就是一场锦标赛（只是少了一轮）。如果这是一场比赛，我们会归还获胜者。如果它是一个小节/锦标赛，我们会递归找到它的两个孩子的获胜者。

```
def rps_tournament_winner(tournament)
    # Check if we're at a game
    if tournament[0][0].is_a? String
        return rps_game_winner(tournament)
    end
    # Otherwise keep going down the rabbit hole
    return rps_game_winner([rps_tournament_winner(tournament[0]),rps_tournament_winner(tournament[1])])
end 
```

这有助于你理解吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T17:55:35.193

它对我有用。以下是步骤：

1.  检查锦标赛[0][0] 是否为数组
    1.1 返回游戏获胜者
2.  如果不是
    2.1 递归调用锦标赛函数检查直到结束谁赢得巡回赛[0]
    2.2 递归调用锦标赛函数检查直到结束谁赢得巡回赛[0]
    2.3 递归调用锦标赛函数检查直到结束谁赢得巡回赛[0] [1]
3.  项目清单

# vim - 带有用户输入的 Vim 映射

> ID：14388703
> 
> 赞同：15
> 
> 时间：2013-01-17T21:45:33.900
> 
> 标签：vim

我想知道是否可以在 Vim 中创建一个映射（用于正常模式），在映射执行之前允许用户输入。

我想为我最常用的 grep 命令创建一个快捷方式的映射。我希望该命令允许输入我正在搜索的内容，然后在输入时执行。

这就是我想要的：

```
nmap F :grep! "*user input*"<CR>:cw<CR> 
```

我不知道如何暂停并接受用户输入。我什至以正确的方式思考这个问题吗？有没有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-17T21:52:08.747

有一个功能`input(prompt [, text [, completion]])`：

> 结果是一个字符串，它是用户在命令行上键入的任何内容。{prompt} 参数可以是提示字符串，也可以是空白字符串（无提示）。可以在提示符中使用“\n”来开始新行。

（从`:help input()`）。

对于类似的事情`:grep!`，您可能必须先使用字符串表达式构建命令，然后再使用`:execute`它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-17T23:49:21.020

另一种方法是创建自定义命令并使用映射来调用新命令。

```
command! -nargs=+ -complete=file -bar Grep grep! <args>|cw 
```

现在您可以创建映射：

```
nnoremap <f2> :Grep<space> 
```

您可能还想远离映射`F`键，因为它是一个非常方便的映射。

如需更多帮助，请参阅：

```
:h :command 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-23T08:03:17.727

另请参阅[@EvergreenTree 在 vi​​.stackexchange 上的这个答案](https://vi.stackexchange.com/a/6030/2239)

简而言之：映射一个表达式以使用`input()`：

`nnoremap <expr> ;n "<ESC>Go<CR>" . input("Input your text here: ", "Prepend this string to my input by default -") . " <<- that was your input.<ESC>"`

# linux - SO_REUSEADDR 和 SO_REUSEPORT 有何不同？

> ID：14388706
> 
> 赞同：775
> 
> 时间：2013-01-17T21:45:44.917
> 
> 标签：linux, windows, sockets, unix, portability

`man pages`套接字选项的`SO_REUSEADDR`和程序员文档对于`SO_REUSEPORT`不同的操作系统是不同的，并且通常非常混乱。有些操作系统甚至没有这个选项`SO_REUSEPORT`。WEB 上充斥着关于这个主题的相互矛盾的信息，而且您经常可以找到仅适用于特定操作系统的一个套接字实现的信息，这些信息甚至可能没有在文本中明确提及。

那么究竟有什么`SO_REUSEADDR`不同`SO_REUSEPORT`呢？

没有`SO_REUSEPORT`更多限制的系统吗？

如果我在不同的操作系统上使用其中任何一个，那么预期的行为到底是什么？

* * *

## 回答 #1

> 赞同：1922
> 
> 时间：2013-01-17T21:45:44.917

欢迎来到便携性的美妙世界……或者说缺乏便携性。在我们开始详细分析这两个选项并深入了解不同操作系统如何处理它们之前，应该注意的是，BSD 套接字实现是所有套接字实现之母。基本上所有其他系统都在某个时间点（或至少是它的接口）复制了 BSD 套接字实现，然后开始自行发展它。当然，BSD 套接字实现也在同时发展，因此后来复制它的系统获得了早期复制它的系统所缺乏的功能。理解 BSD 套接字实现是理解所有其他套接字实现的关键，因此即使您不关心为 BSD 系统编写代码，也应该阅读它。

在我们查看这两个选项之前，您应该了解一些基础知识。TCP/UDP 连接由五个值的元组标识：

`{<protocol>, <src addr>, <src port>, <dest addr>, <dest port>}`

这些值的任何唯一组合都标识了一个连接。因此，没有两个连接可以具有相同的五个值，否则系统将无法再区分这些连接。

`socket()`使用该函数创建套接字时设置套接字的协议。源地址和端口由`bind()`函数设置。目的地址和端口由`connect()`函数设置。由于 UDP 是无连接协议，UDP 套接字可以在不连接它们的情况下使用。然而，它允许连接它们，并且在某些情况下对您的代码和一般应用程序设计非常有利。在无连接模式下，第一次通过它们发送数据时未显式绑定的 UDP 套接字通常由系统自动绑定，因为未绑定的 UDP 套接字无法接收任何（回复）数据。未绑定的 TCP 套接字也是如此，它会在连接之前自动绑定。

如果显式绑定套接字，则可以将其绑定到 port `0`，这意味着“任何端口”。由于套接字不能真正绑定到所有现有端口，因此在这种情况下系统将不得不自己选择一个特定端口（通常来自预定义的、操作系统特定的源端口范围）。源地址存在类似的通配符，可以是“任何地址”（`0.0.0.0`如果是 IPv4 和`::`在 IPv6 的情况下）。与端口不同，套接字实际上可以绑定到“任何地址”，这意味着“所有本地接口的所有源 IP 地址”。如果套接字稍后连接，系统必须选择特定的源 IP 地址，因为套接字无法连接，同时绑定到任何本地 IP 地址。根据目标地址和路由表的内容，系统将选择一个适当的源地址，并将“任何”绑定替换为与所选源 IP 地址的绑定。

默认情况下，不能将两个套接字绑定到相同的源地址和源端口组合。只要源端口不同，源地址其实是无关紧要的。如果为真，绑定`socketA`to`ipA:portA`和`socketB`to`ipB:portB`总是可能`ipA != ipB`的，即使`portA == portB`. eg`socketA`属于一个FTP服务器程序，绑定到`192.168.0.1:21`，`socketB`属于另一个FTP服务器程序，绑定到`10.0.0.1:21`，两个绑定都会成功。但请记住，套接字可能在本地绑定到“任何地址”。如果一个套接字绑定到`0.0.0.0:21`，它同时绑定到所有现有的本地地址，在这种情况下，没有其他套接字可以绑定到 port `21`，无论它尝试绑定到哪个特定的 IP 地址，如`0.0.0.0`与所有现有的本地 IP 地址冲突。

到目前为止所说的任何内容对于所有主要操作系统都几乎相同。当地址重用开始发挥作用时，事情开始变得特定于操作系统。我们从 BSD 开始，因为正如我上面所说，它是所有套接字实现的母亲。

# BSD

## SO_REUSEADDR

如果`SO_REUSEADDR`在绑定之前在套接字上启用，则可以成功绑定套接字，除非与绑定到**完全相同**的源地址和端口组合的另一个套接字发生冲突。现在您可能想知道这与以前有何不同？关键字是“确切地”。`SO_REUSEADDR`主要改变了在搜索冲突时处理通配符地址（“任何 IP 地址”）的方式。

如果没有`SO_REUSEADDR`，绑定`socketA`到`0.0.0.0:21`然后绑定`socketB`到`192.168.0.1:21`将失败（出现错误`EADDRINUSE`），因为 0.0.0.0 表示“任何本地 IP 地址”，因此此套接字认为所有本地 IP 地址都在使用中，这也包括`192.168.0.1`。有了`SO_REUSEADDR`它就会成功，因为`0.0.0.0`和`192.168.0.1`不是**完全相同**的地址，一个是所有本地地址的通配符，另一个是非常特定的本地地址。`socketA`请注意，无论以何种顺序和`socketB`约束，上述陈述都是正确的；没有`SO_REUSEADDR`它总是失败，有`SO_REUSEADDR`它总是成功。

为了给你一个更好的概述，让我们在这里做一个表格并列出所有可能的组合：

```
SO_REUSEADDR socketA socketB 结果
-------------------------------------------------- ------------------
  开/关 192.168.0.1:21 192.168.0.1:21 错误（EADDRINUSE）
  开/关 192.168.0.1:21 10.0.0.1:21 确定
  开/关 10.0.0.1:21 192.168.0.1:21 确定
   关闭 0.0.0.0:21 192.168.1.0:21 错误（EADDRINUSE）
   关闭 192.168.1.0:21 0.0.0.0:21 错误（EADDRINUSE）
   开 0.0.0.0:21 192.168.1.0:21 好
   开 192.168.1.0:21 0.0.0.0:21 好
  开/关 0.0.0.0:21 0.0.0.0:21 错误（EADDRINUSE）

```

上表假设`socketA`已经成功绑定到给定的地址`socketA`，然后`socketB`被创建，要么被`SO_REUSEADDR`设置，要么不被设置，最后被绑定到给定的地址`socketB`。`Result`是 的绑定操作的结果`socketB`。如果第一列`ON/OFF`显示 ，则 的值`SO_REUSEADDR`与结果无关。

好的，`SO_REUSEADDR`对通配符地址有影响，很高兴知道。然而，这不是它唯一的效果。还有另一个众所周知的效果，这也是大多数人`SO_REUSEADDR`首先在服务器程序中使用的原因。对于此选项的其他重要用途，我们必须更深入地了解 TCP 协议的工作原理。

一个套接字有一个发送缓冲区，如果`send()`函数调用成功，并不意味着请求的数据真的被发送出去了，它只意味着数据已经被添加到发送缓冲区中。对于 UDP 套接字，数据通常很快就会发送，如果不是立即发送的话，但是对于 TCP 套接字，在将数据添加到发送缓冲区和让 TCP 实现真正发送该数据之间可能存在相对较长的延迟。因此，当您关闭 TCP 套接字时，发送缓冲区中可能仍有待处理的数据，这些数据尚未发送，但您的代码将其视为已发送，因为`send()`通话成功。如果 TCP 实现根据您的请求立即关闭套接字，那么所有这些数据都将丢失，您的代码甚至都不知道这一点。据说TCP是一个可靠的协议，像这样丢失数据并不是很可靠。`TIME_WAIT`这就是为什么仍然有数据要发送的套接字会在你关闭它时进入一个被调用的状态。在该状态下，它将等待所有待处理的数据都已成功发送或直到超时，在这种情况下，套接字将被强制关闭。

至多，内核在关闭套接字之前将等待的时间，无论它是否仍有数据在传输中，称为*Linger Time*。在大多数系统上，*Linger Time*是全局可配置的，默认情况下相当长（两分钟是许多系统上的常见值）。也可以使用 socket 选项对每个套接字进行配置，该选项`SO_LINGER`可用于缩短或延长超时时间，甚至完全禁用它。但是，完全禁用它是一个非常糟糕的主意，因为优雅地关闭 TCP 套接字是一个稍微复杂的过程，并且涉及发送和返回几个数据包（以及重新发送这些数据包以防它们丢失）和整个关闭过程也受到*Linger Time的限制*. 如果你禁用 lingering，你的 socket 不仅可能会丢失数据，而且总是强制关闭而不是优雅地关闭，通常不建议这样做。有关如何优雅关闭 TCP 连接的详细信息超出了此答案的范围，如果您想了解更多信息，我建议您查看[此页面](http://www.freesoft.org/CIE/Course/Section4/11.htm)。即使您禁用了 lingering `SO_LINGER`，如果您的进程在没有明确关闭套接字的情况下死亡，BSD（可能还有其他系统）仍然会徘徊，忽略您的配置。例如，如果您的代码只是调用，就会发生这种情况`exit()`（对于小型、简单的服务器程序来说很常见）或者进程被信号杀死（包括由于非法内存访问而导致它简单地崩溃的可能性）。因此，您无法确保套接字在任何情况下都不会逗留。

问题是，系统如何处理处于状态的套接字`TIME_WAIT`？如果`SO_REUSEADDR`未设置，`TIME_WAIT`则认为处于状态的套接字仍然绑定到源地址和端口，并且任何将新套接字绑定到相同地址和端口的尝试都将失败，直到套接字真正关闭，这可能需要很长时间作为配置的*逗留时间*。所以不要指望你可以在关闭套接字后立即重新绑定它的源地址。在大多数情况下，这将失败。但是，如果`SO_REUSEADDR`为您尝试绑定的套接字设置了，则另一个套接字在状态下绑定到相同的地址和端口`TIME_WAIT`只是被忽略了，毕竟它已经“半死”，并且您的套接字可以毫无问题地绑定到完全相同的地址。在这种情况下，另一个套接字可能具有完全相同的地址和端口是没有作用的。请注意，将套接字绑定到与处于状态的垂死套接字完全相同的地址和端口`TIME_WAIT`可能会产生意想不到的，通常是不希望的副作用，以防另一个套接字仍然“工作”，但这超出了这个答案的范围和幸运的是，这些副作用在实践中相当罕见。

你应该知道最后一件事`SO_REUSEADDR`。只要您要绑定的套接字启用了地址重用，上面编写的所有内容都将起作用。另一个套接字（已经绑定或处于`TIME_WAIT`状态的套接字）在绑定时也没有必要设置此标志。决定绑定是成功还是失败的代码只检查`SO_REUSEADDR`输入`bind()`调用的套接字标志，对于检查的所有其他套接字，甚至不查看该标志。

## SO_REUSEPORT

`SO_REUSEPORT`是大多数人所期望`SO_REUSEADDR`的。基本上，`SO_REUSEPORT`允许您将任意数量的套接字绑定到**完全相同**的源地址和端口，只要**所有**先前绑定的套接字在绑定之前也已`SO_REUSEPORT`设置。如果绑定到地址和端口的第一个套接字没有`SO_REUSEPORT`设置，则任何其他套接字都不能绑定到完全相同的地址和端口，无论这个另一个套接字是否已`SO_REUSEPORT`设置，直到第一个套接字再次释放它的绑定。与`SO_REUESADDR`代码处理的情况不同，`SO_REUSEPORT`它不仅会验证当前绑定的套接字是否已`SO_REUSEPORT`设置，还会验证地址和端口冲突的套接字`SO_REUSEPORT`在绑定时是否已设置。

`SO_REUSEPORT`并不意味着`SO_REUSEADDR`。这意味着如果一个套接字在绑定时没有`SO_REUSEPORT`设置，而另一个套接字`SO_REUSEPORT`在绑定到完全相同的地址和端口时已设置，则绑定失败，这是预期的，但如果另一个套接字已经死亡并且它也会失败处于`TIME_WAIT`状态。为了能够将一个套接字绑定到与另一个处于`TIME_WAIT`状态的套接字相同的地址和端口，需要`SO_REUSEADDR`在该套接字上进行设置，或者`SO_REUSEPORT`必须在绑定它们之前**在两个套接字上进行设置。**当然，允许在套接字上同时设置`SO_REUSEPORT`和。`SO_REUSEADDR`

`SO_REUSEPORT`除了它是在 之后添加的，没有什么好说的了`SO_REUSEADDR`，这就是为什么你不会在其他系统的许多套接字实现中找到它，它们在添加这个选项之前“分叉”了 BSD 代码，并且没有在此选项之前将两个套接字绑定到 BSD 中完全相同的套接字地址的方法。

## Connect() 返回 EADDRINUSE？

大多数人都知道这`bind()`可能会因错误而失败`EADDRINUSE`，但是，当您开始使用地址重用时，您可能会遇到同样`connect()`因错误而失败的奇怪情况。怎么会这样？一个远程地址，毕竟是连接添加到套接字的，怎么可能已经在使用呢？将多个套接字连接到完全相同的远程地址以前从来都不是问题，那么这里出了什么问题呢？

正如我在回复的开头所说，连接是由五个值的元组定义的，还记得吗？而且我还说过，这五个值必须是唯一的，否则系统无法再区分两个连接，对吧？好吧，通过地址重用，您可以将相同协议的两个套接字绑定到相同的源地址和端口。这意味着这五个值中的三个对于这两个套接字已经相同。如果您现在尝试将这两个套接字也连接到相同的目标地址和端口，您将创建两个连接的套接字，它们的元组完全相同。这行不通，至少对于 TCP 连接不起作用（UDP 连接无论如何都不是真正的连接）。如果数据到达两个连接中的任何一个，系统就无法判断数据属于哪个连接。

因此，如果您将相同协议的两个套接字绑定到相同的源地址和端口，并尝试将它们都连接到相同的目标地址和端口，`connect()`实际上将失败并出现`EADDRINUSE`您尝试连接的第二个套接字的错误，这意味着一个具有五个值的相同元组的套接字已经连接。

## 多播地址

大多数人忽略了多播地址存在的事实，但它们确实存在。单播地址用于一对一通信，而多播地址用于一对多通信。大多数人在了解 IPv6 时就知道了多播地址，但多播地址也存在于 IPv4 中，尽管此功能从未在公共 Internet 上广泛使用。

多播地址更改的含义，`SO_REUSEADDR`因为它允许将多个套接字绑定到完全相同的源多播地址和端口组合。换句话说，多播地址的`SO_REUSEADDR`行为与单播地址完全相同`SO_REUSEPORT`。实际上，代码对多播地址的处理`SO_REUSEADDR`方式`SO_REUSEPORT`相同，这意味着您可以说这`SO_REUSEADDR`意味着`SO_REUSEPORT`所有多播地址，反之亦然。

# 
FreeBSD/OpenBSD/NetBSD

所有这些都是原始 BSD 代码的较晚分支，这就是为什么它们都提供与 BSD 相同的选项，并且它们的行为方式也与 BSD 相同。

# 
macOS (MacOS X)

从本质上讲，macOS 只是一个名为“ *Darwin* ”的 BSD 风格的 UNIX，它基于 BSD 代码（BSD 4.3）的一个相当晚的分支，后来甚至与（当时当前的）FreeBSD 重新同步Mac OS 10.3 版本的 5 代码库，以便 Apple 可以获得完全的 POSIX 合规性（macOS 已通过 POSIX 认证）。尽管在其核心（“ *Mach* ”）中有一个微内核（“Mach”），但内核的其余部分（“ *XNU* ”）基本上只是一个 BSD 内核，这就是为什么 macOS 提供与 BSD 相同的选项并且它们的行为方式与 BSD 相同的原因.

## iOS / watchOS / tvOS

iOS 只是一个 macOS 的分支，带有略微修改和修剪的内核，在某种程度上剥离了用户空间工具集和略有不同的默认框架集。watchOS 和 tvOS 是 iOS 的分支，它们被进一步剥离（尤其是 watchOS）。据我所知，它们的行为都与 macOS 完全一样。

# 
Linux

## Linux < 3.9

在 Linux 3.9 之前，只有该选项`SO_REUSEADDR`存在。此选项的行为通常与 BSD 中的行为相同，但有两个重要例外：

1.  只要侦听（服务器）TCP 套接字绑定到特定端口，该`SO_REUSEADDR`选项就会完全忽略所有针对该端口的套接字。只有在 BSD 中也可以在没有`SO_REUSEADDR`设置的情况下将第二个套接字绑定到同一个端口。例如，您不能绑定到通配符地址，然后绑定到更具体的一个或相反的方式，如果您在 BSD 中设置`SO_REUSEADDR`. 你可以做的是你可以绑定到同一个端口和两个不同的非通配符地址，因为这总是被允许的。在这方面，Linux 比 BSD 更具限制性。

2.  第二个例外是对于客户端套接字，此选项的行为与`SO_REUSEPORT`BSD 中的完全相同，只要它们在绑定之前都设置了此标志。允许这样做的原因很简单，重要的是能够将多个套接字完全绑定到不同协议的相同 UDP 套接字地址，并且由于`SO_REUSEPORT`在 3.9 之前没有，`SO_REUSEADDR`因此相应地改变了行为以填补这个空白. 在这方面，Linux 的限制比 BSD 少。

## Linux >= 3.9

Linux 3.9`SO_REUSEPORT`也为 Linux 添加了该选项。此选项的行为与 BSD 中的选项完全相同，只要所有套接字在绑定之前都设置了此选项，就允许绑定到完全相同的地址和端口号。

`SO_REUSEPORT`然而，与其他系统仍有两个不同之处：

1.  为了防止“端口劫持”，有一个特殊的限制：**所有想要共享相同地址和端口组合的套接字必须属于共享相同有效用户 ID 的进程！**所以一个用户不能“窃取”另一个用户的端口。这是一些特殊的魔法，可以在一定程度上弥补丢失的`SO_EXCLBIND`/`SO_EXCLUSIVEADDRUSE`标志。

2.  `SO_REUSEPORT`此外，内核对套接字执行了一些在其他操作系统中没有的“特殊魔法” ：对于 UDP 套接字，它尝试均匀地分发数据报，对于 TCP 侦听套接字，它尝试分发传入的连接请求（通过调用接受的连接请求`accept()`）均匀分布在所有共享相同地址和端口组合的套接字上。因此，一个应用程序可以轻松地在多个子进程中打开同一个端口，然后使用它`SO_REUSEPORT`来获得非常便宜的负载平衡。

## 
安卓

尽管整个 Android 系统与大多数 Linux 发行版有些不同，但其核心是稍微修改过的 Linux 内核，因此适用于 Linux 的所有内容也应该适用于 Android。

# 
视窗

Windows 只知道`SO_REUSEADDR`选项，没有`SO_REUSEPORT`. `SO_REUSEADDR`在 Windows 中设置套接字的行为类似于在 BSD 中设置和`SO_REUSEPORT`设置`SO_REUSEADDR`套接字，但有一个例外：

在 Windows 2003 之前，带有 的套接字`SO_REUSEADDR`总是可以与已绑定的套接字绑定到完全相同的源地址和端口，**即使另一个套接字在绑定时没有设置此选项**。这种行为允许应用程序“窃取”另一个应用程序的连接端口。不用说，这具有重大的安全隐患！

微软意识到这一点并添加了另一个重要的套接字选项：`SO_EXCLUSIVEADDRUSE`. 对套接字进行设置`SO_EXCLUSIVEADDRUSE`可确保如果绑定成功，源地址和端口的组合将由该套接字独占拥有，并且没有其他套接字可以绑定到它们，**即使**已`SO_REUSEADDR`设置也不行。

此默认行为首先在 Windows 2003 中进行了更改，Microsoft 将其称为“增强的套接字安全性”（所有其他主要操作系统默认行为的有趣名称）。欲了解更多详情[，请访问此页面](https://msdn.microsoft.com/en-us/library/windows/desktop/ms740621(v=vs.85).aspx)。共有三个表：第一个显示经典行为（在使用兼容模式时仍在使用！），第二个显示 Windows 2003 及更高版本在`bind()`同一用户进行调用时的行为，第三个显示`bind()`呼叫是由不同的用户拨打的。

# 
索拉里斯

Solaris 是 SunOS 的继任者。SunOS 最初基于 BSD 的一个分支，SunOS 5 和后来基于 SVR4 的一个分支，但是 SVR4 是 BSD、System V 和 Xenix 的合并，因此在某种程度上 Solaris 也是一个 BSD 分支，并且比较早的一个。结果 Solaris 只知道`SO_REUSEADDR`，没有`SO_REUSEPORT`。它的行为与在 BSD 中的`SO_REUSEADDR`行为几乎相同。据我所知，没有办法获得与`SO_REUSEPORT`Solaris 中相同的行为，这意味着不可能将两个套接字绑定到完全相同的地址和端口。

与 Windows 类似，Solaris 可以选择为套接字提供独占绑定。此选项名为`SO_EXCLBIND`. 如果在绑定之前在套接字上设置了此选项，则`SO_REUSEADDR`在测试两个套接字是否存在地址冲突时，在另一个套接字上设置将无效。例如，如果`socketA`绑定到通配符地址并`socketB`已`SO_REUSEADDR`启用并且绑定到非通配符地址和与 相同的端口`socketA`，则此绑定通常会成功，除非`socketA`已`SO_EXCLBIND`启用，在这种情况下，无论 的`SO_REUSEADDR`标志如何，它都会失败`socketB`。

# 
其他系统

如果您的系统未在上面列出，我编写了一个小测试程序，您可以使用它来了解您的系统如何处理这两个选项。**另外，如果您认为我的结果是错误的**，请在发表任何评论并可能做出虚假声明之前先运行该程序。

构建代码所需的只是一点 POSIX API（用于网络部分）和一个 C99 编译器（实际上，大多数非 C99 编译器只要提供`inttypes.h`和就可以正常工作`stdbool.h`；例如`gcc`，在提供完整的 C99 支持之前很久就支持两者） .

程序需要运行的只是系统中的至少一个接口（本地接口除外）分配了 IP 地址，并设置了使用该接口的默认路由。该程序将收集该 IP 地址并将其用作第二个“特定地址”。

它测试你能想到的所有可能的组合：

*   TCP 和 UDP 协议
*   普通套接字、监听（服务器）套接字、多播套接字
*   `SO_REUSEADDR`在 socket1、socket2 或两个套接字上设置
*   `SO_REUSEPORT`在 socket1、socket2 或两个套接字上设置
*   您可以使用`0.0.0.0`（通配符）、`127.0.0.1`（特定地址）和在主接口上找到的第二个特定地址（对于多播，它只是`224.1.2.3`在所有测试中）组成的所有地址组合

并将结果打印在一个漂亮的表格中。它也可以在不知道的系统上工作`SO_REUSEPORT`，在这种情况下，这个选项根本没有经过测试。

程序无法轻易测试的是如何`SO_REUSEADDR`作用于处于状态的套接字，`TIME_WAIT`因为强制并保持套接字处于该状态是非常棘手的。幸运的是，大多数操作系统在这里似乎只是表现得像 BSD，大多数时候程序员可以简单地忽略该状态的存在。

[这是代码](http://rextester.com/BUAFK86204)（我不能在这里包含它，答案有大小限制，并且代码会将这个回复推到限制之外）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2020-06-10T22:34:05.610

Mecki 的回答绝对完美，但值得补充的是，FreeBSD 还支持`SO_REUSEPORT_LB`模仿 Linux 的`SO_REUSEPORT`行为——它平衡负载；参见[setsockopt(2)](https://www.freebsd.org/cgi/man.cgi?setsockopt)

# html - 每天从另一个网站获取内容

> ID：14388709
> 
> 赞同：5
> 
> 时间：2013-01-17T21:45:55.543
> 
> 标签：html, parsing, rss, sync

这是我的问题。我正在创建一个具有“新闻”选项卡的网站。我在新闻标签上想要的是来自另一个新闻网站的更新内容。

有什么方法可以抓取发布在另一个网站上的纯文本，将其发布在我网站的新闻标签上，并在网站发布新内容时自动更新？任何人都可以将我推向正确的方向，以便我可以学习如何做到这一点吗？

我非常了解 HTML，但缺乏 PHP 和 Javascript 技能。为了实现这一目标，我必须学习什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:14:26.620

查找 Curl ......它在 php 中。 [http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

这是一个很好的视频，它可能与你想要完成的事情有关。 [http://www.youtube.com/watch?v=PvEJz6du7R0](http://www.youtube.com/watch?v=PvEJz6du7R0)

这里还有一些代码，用于使用 curl 获取网站的源代码。

```
<?php

$ch = curl_init("http://www.example-webpage.com/file.html");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_BINARYTRANSFER, true);
$content = curl_exec($ch);
curl_close($ch);
echo $content;

?> 
```

做你想做的另一种方法是在 div 中使用 iframe ...

```
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<style type="text/css">
<!--
#container{
    width:300px;
    height:100px;
    border:1px solid #000; 
    overflow:hidden;
    margin-left:50%;
    margin-top:5%;

}
#container iframe {
    width:1000px;
    height:750px;
    margin-left:-734px;
    margin-top:-181px;   
    border:0 solid;
 }
-->
</style>

</head>
<body>

<div id="container">
<iframe src="http://www.w3schools.com/" scrolling="no"></iframe>
</div>

</body>
</html> 
```

有些网站不允许您为他们的网站添加 iframe，因此这可能不起作用。例如，您不能 iframe google、youtube、yahoo 等。

希望这有帮助：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:51:20.823

您需要使用[file_get_contents](http://php.net/manual/en/function.file-get-contents.php)并解析 html 以获得所需的内容。如果您希望它定期更新，您需要在“cron 任务”上运行此脚本。

如果新闻站点有一个 RSS 提要，您可以改为解析它，更有效地使用[SimpleXML](http://php.net/manual/en/book.simplexml.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T22:01:12.523

本书有一节演示如何从另一个网站读取数据并使用 PHP 对其进行解析。第 10 章，第 328 页“访问其他网站”。

[http://www.amazon.com/PHP-Advanced-Object-Oriented-Programming-QuickPro/dp/0321832183/](https://rads.stackoverflow.com/amzn/click/com/0321832183)

但是，如果您是 PHP 新手，那么高级书籍就不是开始的地方。我会推荐以下任何一种方法来帮助您开始这条道路。

[http://www.amazon.com/PHP-MySQL-Dynamic-Web-Sites/dp/0321784073/](https://rads.stackoverflow.com/amzn/click/com/0321784073)

或者

[http://www.amazon.com/PHP-Web-Visual-QuickStart-Guide/dp/0321733452/](https://rads.stackoverflow.com/amzn/click/com/0321733452)

您可以使用高级书籍拼凑所需的内容，但使用高级技能的最佳方法是从初学者开始学习！

# javascript - 删除画布中的前一个图像

> ID：14388720
> 
> 赞同：0
> 
> 时间：2013-01-17T21:47:09.327
> 
> 标签：javascript, cordova, canvas, html5-canvas

我有一个画布，我通过单击一个按钮在其中绘制图片，然后我想通过单击另一个按钮来绘制另一个不同的图像。问题是如何删除画布的先前图像并加载新图像？有什么例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:48:45.933

清除画布的一种方法是在整个画布上绘制一个矩形以删除之前的内容。

```
context.clearRect (0, 0, width, height); 
```

另一种方法是重置画布本身的宽度。

```
canvas.width = canvas.width 
```

我通常使用该`clearrect`方法，因为它只是清除画布的表面，而另一种方法则重置各种其他事物，例如转换。另外我想我在某处读到该`clearrect`方法更快，但又一次取决于你想要什么。

顺便说一句，我经常发现我不想完全清除画布，但我想将其返回到以前的图像或背景图像。这通过使用另一个画布作为未显示在屏幕上的缓存来最有效地完成。然后，当您想将可见画布清除回以前的状态时，您可以使用`drawImage`. 这比重新计算一组背景或先前的状态要高效得多。

# gnome - Gnome 3.6 中的滚动锁定支持

> ID：14388725
> 
> 赞同：0
> 
> 时间：2013-01-17T21:47:30.413
> 
> 标签：gnome, gnome-shell, xmodmap, scroll-lock

按下“Scroll Lock”时，我有键盘背光。

但是，默认情况下，在 Gnome 3.6 中，我没有用于“Scroll Lock”的 xmodmap：

```
$xmodmap

shift       Shift_L (0x32),  Shift_R (0x3e)
lock        Caps_Lock (0x42)
control     Control_L (0x25),  Control_R (0x69)
mod1        Alt_L (0x40),  Alt_R (0x6c),  Meta_L (0xcd)
mod2        Num_Lock (0x4d)
mod3      
mod4        Super_L (0x85),  Super_R (0x86),  Super_L (0xce),  Hyper_L (0xcf)
mod5        ISO_Level3_Shift (0x5c),  Mode_switch (0xcb) 
```

但我可以添加它：

```
$xmodmap -e 'add mod3 = Scroll_Lock'
$xmodmap

shift       Shift_L (0x32),  Shift_R (0x3e)
lock        Caps_Lock (0x42)
control     Control_L (0x25),  Control_R (0x69)
mod1        Alt_L (0x40),  Alt_R (0x6c),  Meta_L (0xcd)
mod2        Num_Lock (0x4d)
mod3        Scroll_Lock (0x4e)
mod4        Super_L (0x85),  Super_R (0x86),  Super_L (0xce),  Hyper_L (0xcf)
mod5        ISO_Level3_Shift (0x5c),  Mode_switch (0xcb) 
```

当我有 Gnome 3.4 时，我刚刚添加到我的 .bashrc 文件中：

```
xmodmap -e 'add mod3 = Scroll_Lock' 
```

但是，在 Gnome 3.6 中它不起作用，因为他在用户会话期间重新定义了没有“滚动锁定”支持的 xmodmap。

如何在 Gnome 3.6 中添加 Scroll Lock 支持？

感谢您的关注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:04:42.490

我在[https://bbs.archlinux.org/viewtopic.php?id=151899](https://bbs.archlinux.org/viewtopic.php?id=151899)上找到了解决方案。

只需要执行：

```
gsettings set org.gnome.settings-daemon.plugins.keyboard active false 
```

我现在禁用了 xmodmap 的重新定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-03T09:55:58.533

似乎 gnome 3.6 滚动锁定 LED 不起作用，但是，功能符合预期。基本上 xmodmap 设置被 gnome 覆盖。如果您不想通过 gnome 禁用键盘，可以使用以下说明解决此问题，

要打开 LED，可以按照您所说的添加 xmodmap 条目以恢复 LED，但是，拔下键盘后，LED 会自行关闭，注销/重新启动（gnome-session restart）所以，要解决这个问题，我们需要有1）udev 键盘规则 - 在每次热插拔时启用滚动锁定。（调用脚本为滚动锁定添加 xmodmap 条目）2）gnome 自动启动功能 - 在每次重新启动时启用滚动锁定。（调用脚本为滚动锁定添加 xmodmap 条目）

# javascript - 为什么 this.value 或 $(this).val() 在 JavaScript / jQuery 中没有响应？

> ID：14388728
> 
> 赞同：0
> 
> 时间：2013-01-17T21:47:33.417
> 
> 标签：javascript, jquery

我有以下`function`，它成功地增加`value`了`input type="text"`

```
function deleteLine(arrayNumber) {
    $("#line" + arrayNumber + "_quantity").val(parseInt($("#line" + arrayNumber + "_quantity").val()) + 1);
} 
```

我只是想知道为什么这些不起作用，以获得更整洁的代码：

```
$("#line" + arrayNumber + "_quantity").val(this + 1);
$("#line" + arrayNumber + "_quantity").val(this.value + 1);
$("#line" + arrayNumber + "_quantity").val($(this).val() + 1); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T21:49:38.093

你应该像下面这样尝试，

```
$("#line" + arrayNumber + "_quantity").val(function (i, v) { return +v+1; }); 
```

您的版本不起作用，因为`this`没有引用文本框。

感谢[@FelixKing](https://stackoverflow.com/questions/14388728/why-isnt-this-value-or-this-val-responding-in-javascript-jquery/14388759#comment20016152_14388759)一元运算符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:50:55.820

```
var lineVar = $("#line" + arrayNumber + "_quantity");

 lineVar.val(parseInt(lineVar.val()) + 1); 
```

# java - 使用 Objectify 获取光标而不遍历项目

> ID：14388729
> 
> 赞同：3
> 
> 时间：2013-01-17T21:47:34.947
> 
> 标签：java, google-app-engine, google-cloud-datastore, paging, objectify

我想执行查询，获取结果，然后将光标移至下一项（如果有）。我发现的唯一相关帖子是：[Objectify paging with Cursors](https://stackoverflow.com/questions/7027202/objectify-paging-with-cursors)

有没有办法在不遍历项目的情况下做到这一点？

```
Query<User> query = ofy().load().type(User.class).limit(RecordLimit).filter("gameId", gameId);
//execute and get the results
List<User> users = query.list()
//get the cursor for the next user 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-17T15:38:45.657

```
String cursor = query.iterator().getCursor().toWebSafeString(); 
```

查看这些[单元测试](https://github.com/objectify/objectify/blob/master/src/test/java/com/googlecode/objectify/test/QueryCursorTestsBig.java)以使事情更加清晰。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-07T04:07:43.803

`Query`本身是可迭代的 - 就像一个游标。

你可以直接这样做：

```
Query<User> query = blah;
for(User u: query) {
    //u is next item from the "cursor"
} 
```

# android - 即使存在有效的接近传感器，Sensor.TYPE_PROXIMITY 也会返回 NULL

> ID：14388733
> 
> 赞同：0
> 
> 时间：2013-01-17T21:47:53.593
> 
> 标签：android, proximity

我正在编写一个测试应用程序来验证三星 Galaxy Note 10.1 平板电脑（仅限 Wifi）上的接近传感器功能。根据设备规范，它支持接近传感器。但是，当我查询设备上支持的传感器时，它不会返回接近传感器，因此类型的传感器`sensor.TYPE_PROXIMITY`是 null 。除了使用此类之外，还有其他方法可以验证邻近功能吗？想知道为什么当设备规范明确表示它支持接近传感器时它会返回 null。

相关代码：

```
mSensorManager = (SensorManager)getSystemService(Context.SENSOR_SERVICE);
mSensorManager.getDefaultSensor(Sensor.TYPE_PROXIMITY); //This returns null
List<Sensor> sensorList = sensorManager.getSensorList(Sensor.TYPE_PROXIMITY); //returns null 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T14:12:20.043

我不认为你有接近传感器。如果你这样做了，那么在实现 SensorEventListener 之后尝试做一些事情。我的平板电脑也面临同样的问题，最后得出的结论是我的平板电脑没有接近可用的功能。

# java - 是否可以反转转义字符串？

> ID：14388734
> 
> 赞同：1
> 
> 时间：2013-01-17T21:47:58.397
> 
> 标签：java, eclipse, string, netbeans, escaping

我知道 NetBeans 和 Eclipse 都有选项，如果您将多行、未转义的字符串粘贴到字符串变量中，它会自动添加转义字符并添加换行符。有没有办法扭转这个过程？

例如：

```
function ShowHideOptions(trigger, element) {
 if( trigger ) {
    document.getElementById( element ).style.display = "";
 } else {
    document.getElementById( element ).style.display = "none";
 }
} 
```

如果粘贴到字符串变为：

```
private static final String LABEL_JAVASCRIPT = "function ShowHideOptions(trigger, element) {\n"
            + " if( trigger ) {\n"
            + "     document.getElementById( element ).style.display = \"\";\n"
            + " } else {\n"
            + "     document.getElementById( element ).style.display = \"none\";\n"
            + " }\n"
            + "}"; 
```

我想扭转这个过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:50:42.610

我相信你的问题值得另一个问题。为什么？

如果你反转这个，引号将不会被转义，因此你会得到错误。例子：

```
System.out.println("System.out.println("Test");");
                                       ^
                          Error, everything after this quote is
                                    considered code 
```

请注意引号没有转义。这段代码会在我标记它的地方产生一个错误，因为引号显然意味着字符串应该结束。

此外，如果换行符被颠倒，这个例子：

```
System.out.println("test");
System.out.println("test2"); 
```

会成为：

```
System.out.println("test");System.out.println("test2"); 
```

以下代码工作正常。请澄清问题。

```
System.out.println(LABEL_JAVASCRIPT); 
```

# c# - Shockwave flash 不会加载 URL

> ID：14388739
> 
> 赞同：0
> 
> 时间：2013-01-17T21:48:28.357
> 
> 标签：c#, flash, visual-studio-2008, url, axshockwaveflash

我一直在使用 Visual Studio 2008 中的 Flash 对象来播放`.swf`文件，一切都很顺利，直到`ustream.tv`视频在没有更新代码的情况下突然停止工作一夜之间。我上床睡觉时正在玩，醒来后（1 月 15 日）就不再工作（在任何计算机上）。

停止工作的[链接](http://ustream.tv/flash/viewer.swf?cid=12717079)。

其他[链接](http://cdn.livestream.com/grid/LSPlayer.swf?channel=newstalk)仍然可以正常工作，但`ustream`根本无法正常工作。我使用的每一个链接仍然在使​​用任何`ustream.tv`一个例外。

我曾尝试在以前安装过该程序的其他计算机上使用该程序，但它也无法在那里工作。ustream 链接在我的浏览器和 Flash 投影仪中仍然有效，但这对我没有用。

如果我在加载视频后右键单击表单上的 flash 对象，则 Loop 旁边会出现一个检查。按播放或该菜单中的任何其他选项不会使其加载。

该项目非常简单，因此请通过将 Flash 对象放在 Visual Studio 中的表单上并将上述 ustream 链接加载到其中进行测试。

谢谢！

# java - 填充结构数组并将其传递给 Java

> ID：14388740
> 
> 赞同：3
> 
> 时间：2013-01-17T21:48:33.610
> 
> 标签：java, c++, jna

早上的大部分时间我都在尝试使用 JNA 从 Java 填充一组填充的结构并将其传递给 C++。我有很大一部分基于 JNA 的代码正在运行，我觉得这应该很简单，但我无法弄清楚或找到不使用 @deprecated 函数的示例。我怀疑这是微不足道的，当有人向我展示时我会感到愚蠢，但我真的很感激一些帮助。

关于我尝试过的一些背景知识：我不知何故怀疑它是否重要，但在学习了如何手动编写接口文件（并让它们工作）之后，我切换到了 JNAerator。JNAerator 翻译

```
MyStruct* mine 
```

到

```
MyStruct mine 
```

在爪哇。这让我有点困惑，因为在 Java 中 this 只能用于指向单个对象。有一次我看着使用

```
MyStruct** mine 
```

这转化为

```
PointerByReference mine 
```

但这似乎有点矫枉过正，因为我不需要修改结构，也不需要再次访问它们。从那时起，我已经尝试了所有我能想到的东西，但我从来没有成功发送比第一个结构更多的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:21:32.883

重新阅读您的问题（将结构从 Java 传递到 C++）后，您可以执行以下操作：

```
// Assuming a native signature like this:
// call_native_function(MyStruct** struct_list, int count)

MyStruct.ByReference[] list = new MyStruct.ByReference[SIZE];
for (int i=0;i < list.length;i++) {
    list[i] = new MyStruct.ByReference();
    // Initialize the struct as needed
}
// Call whatever native method...
nativeLibrary.call_native_function(list, list.length); 
```

另请参阅[JNA 常见问题解答](https://github.com/twall/jna/blob/master/www/FrequentlyAskedQuestions.md#when-should-i-use-structurebyreference-structurebyvalue-structure)。

# asp.net-web-api - 如何使用 Fiddler 2 编写请求？

> ID：14388742
> 
> 赞同：11
> 
> 时间：2013-01-17T21:48:42.310
> 
> 标签：asp.net-web-api, fiddler

我正在使用 asp.net web api，我想试试我的方法是否有效。我看到人们经常这样做的方式是通过提琴手。我正在尝试自己做这件事，但我无法让它发挥作用。

我转到作曲家选项卡并执行此操作。

![在此处输入图像描述](../Images/9c242f8ced59fa26ed052f1c7167725e.png)

```
public IQueryable<FoodLogRecord> Get(string email)
{
    return null;
} 
```

但我得到了 404 回复。我还在方法中设置了一个断点，它永远不会进入。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-17T22:02:09.833

使用网址

```
http://localhost:50570/api/foodlog?email=c 
```

从请求正文中删除 Content-Length 和文本。您不能发送带有 GET 请求的正文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T02:19:03.127

您应该能够将以下 URL 与以下代码更改一起使用：`http://localhost:50570/api/foodlog/c`

```
public IQueryable<FoodLogRecord> Get([FromUri] string email)
{
    return null;
} 
```

# node.js - 带有base64摘要算法的nodejs md5错误结果

> ID：14388745
> 
> 赞同：10
> 
> 时间：2013-01-17T21:49:03.827
> 
> 标签：node.js, base64, md5

这是我的代码

```
var sig = crypto.createHash('md5')
  .update('The quick brown fox jumps over the lazy dog')
  .digest('base64');
console.log(sig) 
```

结果`nhB9nTcrtoJr2B01QqQZ1g==`（在 Mac OS X 上）。

我正在尝试从 ios 应用程序生成相同的签名。目标 c 中的结果与在线转换器站点中的结果相同：**字符串**

`The quick brown fox jumps over the lazy dog`

转换为**md5**，我得到 `9e107d9d372bb6826bd81d3542a419d6`，

而这个的**base64**是`OWUxMDdkOWQzNzJiYjY4MjZiZDgxZDM1NDJhNDE5ZDY=`。

为什么这些字符串不同？这不是 nodejs 加密模块在做什么吗？用 base64 消化 md5 哈希的 nodejs 算法的等价物是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-17T22:11:53.023

该字符串`OWUxMDdkOWQzNzJiYjY4MjZiZDgxZDM1NDJhNDE5ZDY=`是字符串的 base64 编码版本，`9e107d9d372bb6826bd81d3542a419d6`它本身就是纯文本字符串的 md5 哈希`The quick brown fox jumps over the lazy dog`。

如果您想在节点中执行此操作，您首先必须以十六进制获取 md5 哈希：

```
var crypto = require('crypto');
var s = 'The quick brown fox jumps over the lazy dog';
var md5 = crypto.createHash('md5').update(s).digest('hex'); 
```

现在您将 md5 哈希作为十六进制 ( `9e107d9d372bb6826bd81d3542a419d6`)。现在您所要做的就是将其转换为 base64：

```
new Buffer(md5).toString('base64'); 
```

# php - 如何在 MySQL w/php 中显示来自两个不同数据库的数据

> ID：14388747
> 
> 赞同：0
> 
> 时间：2013-01-17T21:49:04.957
> 
> 标签：php, mysql, database

我有一个客户想要将我作为注册用户存储在内容管理软件的数据库表中的电子邮件添加到来自另一个数据库的 html 生成的表中，该数据库是我为存储每个商店的所有数据而创建的。一个注册用户可以拥有二十家商店。如何将该用户的电子邮件从 CMS 数据库连接到他们拥有的来自另一个数据库的已注册商店的 html 表输出。

下面的插图很有希望地解释了难以用语言解释的东西。对于他们拥有的每个商店，DB1 中的“用户”与 DB2 中的“id”相同 - 见下文：

```
USER DATABASE (DB1) =====================

USER   |  EMAIL   |  NAME   |  WEBSITE
-----------------------------------------
user1  |  email1  |  name1  |  website 1
user2  |  email2  |  name2  |  website 2
user3  |  email3  |  name3  |  website 3

STORE DATABASE (DB2) ====================

ID     |  STORE    |  CITY    |  STATE
-----------------------------------------
user1  |  store1a  |  city1a  |  state1a
user1  |  store1a  |  city1a  |  state1a
user2  |  store1b  |  city1b  |  state1b
user2  |  store1b  |  city1b  |  state1b
user2  |  store1b  |  city1b  |  state1b
user3  |  store1c  |  city1c  |  state1c
user3  |  store1c  |  city1c  |  state1c 
```

现在我想生成这样的 html 表格结果：

```
ID     |  STORE    |  CITY    |  STATE    |  EMAIL
-------------------------------------------------------
user1  |  store1a  |  city1a  |  state1a  |  email1
user1  |  store1a  |  city1a  |  state1a  |  email1
user2  |  store1b  |  city1b  |  state1b  |  email2
user2  |  store1b  |  city1b  |  state1b  |  email2
user2  |  store1b  |  city1b  |  state1b  |  email2
user3  |  store1c  |  city1c  |  state1c  |  email3
user3  |  store1c  |  city1c  |  state1c  |  email3 
```

如您所见，我查询 DB2，希望能显示来自 DB1 的同一用户的电子邮件以及该用户拥有的所有商店。

这是应客户的要求，因此他们可以使用此 html 表联系他们的注册。我以为我会把这个扔出去。客户只是询问是否可能，这是否会有所帮助。我只是觉得这听起来像是有人想解决的问题，我只是在尝试过内部联接或只是查询两个单独的数据库并尝试使用变量之后很好奇......无济于事！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:06:33.617

由于这两个数据库有不同的密码，我想你需要两个单独的查询。这就是我尝试做的方式。处理能力可能有点多。也许有人可以加快速度。

```
$link1 = mysqli_connect($hostname1, $username1, $password1, $database1);
$query1 = "SELECT user,email FROM db1";
if ( $result1 = mysqli_query($link1, $query1, MYSQLI_STORE_RESULT) )
{
    while ( $r1 = mysqli_fetch_array($result1, MYSQLI_ASSOC) )
    {
        $array[$r1['user']] = $r1['email'];
    }

    $link2 = mysqli_connect($hostname2, $username2, $password2, $database2);
    foreach ( $array as $u=>$e )
    {
        $query2 = "SELECT * FROM db2 WHERE id='{$u}'";
        if ( $result2 = mysqli_query($link2, $query2, MYSQLI_STORE_RESULT) )
        {
            echo "<table>";
            while ( $r2 = mysqli_fetch_array($result2, MYSQLI_ASSOC) )
            {
                echo "<tr>";
                echo "<td>{$u}</td>";
                echo "<td>{$r2['store']}</td>";
                echo "<td>{$r2['city']}</td>";
                echo "<td>{$r2['state']}</td>";
                echo "<td>{$e}</td>";
                echo "</tr>";
            }
            echo "</table>";
        }
    }
    mysqli_close($link2);
}
mysqli_close($link1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:57:35.357

两个数据库是否在同一台服务器上？数据库的用户名和密码是否相同？

如果是这样，你应该能够做这样的事情

```
SELECT * from databasename2NAME.db2 as t1
LEFT JOIN  datebasename1NAME.db1 as t2
ON t1.id=t2.USER
WHERE STATMENT HERE 
```

databasename2NAME 应替换为 db2 的数据库名称，并且 .db2 应替换为该数据库中的表名

db1 相同

# javascript - eBay API - 使用 javascript 构建店面产品网格？

> ID：14388750
> 
> 赞同：2
> 
> 时间：2013-01-17T21:49:11.433
> 
> 标签：javascript, ebay-api, shopping

因此，我目前的任务是为我的工作构建和设计 ebay 店面。我有点迷失在整个计划中。我已经在 ebay 开发者的网络上进行了所有设置并获得了 api 密钥等。

我目前正在尝试为我们的 ebay 店面构建自定义 html 页面。我已经完成了标题和侧边栏，但我希望在店面制作自定义产品网格。我找到了[特殊的 html ebay 语法标签](http://madetobeunique.com/7575/ebay-store-tags-and-html-codes-for-custom-design/)，但这对我没有多大帮助。我希望每页有 10 个产品，并允许用户按图库或列表视图过滤产品，最快结束，从最高价格到最低价格等。

如果我可以访问包含我们 ebay 商店中产品列表的 json 对象，我相当有信心可以完成所有这些工作。这将涉及我假设的 API 调用，我不确定我应该使用哪一个和/或如何通过嵌入在店面 html 页面上的 javascript 来格式化该调用。

对此的任何帮助将不胜感激！提前致谢！

# mysql - MySQL 一次查询 JOIN 3 个表

> ID：14388751
> 
> 赞同：0
> 
> 时间：2013-01-17T21:49:12.043
> 
> 标签：mysql, left-join

你能帮我做这个查询吗

```
SELECT *
FROM `SC_orders`
LEFT  JOIN `SC_customer_reg_fields_values`   using(customerID)
WHERE (`statusID` = 2 OR `statusID` = 3 OR `statusID` = 21 OR `statusID` = 25 OR `statusID` = 26) AND DATE(order_time) > '2012-12-01 00-00-00'
LEFT JOIN `SC_ordered_carts`
ON orderID = orderID
GROUP BY orderID 
```

我尝试将 3 个表中的信息合并到一个输出中。此查询在没有最后一个 LEFT JOIN 和分组的情况下工作正常。我的错误在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:51:59.307

`where`需要在最后一次加入之后。另外，第二个`ON`子句是模棱两可的，我认为这`group by`是不必要的，因为您没有任何聚合函数：

```
SELECT *
FROM `SC_orders`
LEFT JOIN `SC_customer_reg_fields_values`   using(customerID)
LEFT JOIN `SC_ordered_carts` using(orderID)
WHERE (`statusID` = 2 OR `statusID` = 3 OR `statusID` = 21 OR `statusID` = 25 OR `statusID` = 26) AND DATE(order_time) > '2012-12-01 00-00-00' 
```

# command-line - 使用百分号 (%) 作为 CMD 参数被解释为变量

> ID：14388754
> 
> 赞同：4
> 
> 时间：2013-01-17T21:49:29.310
> 
> 标签：command-line, cmd, command-line-arguments, wget

我尝试使用以下代码运行批处理文件：

```
wget.exe "http://example.com/file0%24.html" 
```

问题是，CMD 将 解释`%2`为变量（第二个命令行参数），因为它没有定义，所以它是空的。

有解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:51:43.423

使用双百分号发送百分比文字。

```
wget.exe "http://example.com/file0%%24.html" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:52:06.363

您可以将 % 转义为 %%

> wget.exe "http://example.com/file0%%24.html"

[http://support.microsoft.com/kb/75634](http://support.microsoft.com/kb/75634)

# jquery - 获取 jQuery 对话框以在 lcik 上工作

> ID：14388755
> 
> 赞同：2
> 
> 时间：2013-01-17T21:49:30.617
> 
> 标签：jquery, asp.net-mvc, dialog

我试图让一个图标在单击时触发一个 jQuery 对话框，该对话框显示特定于被单击项目的消息。由于我是 jQuery 新手，我绝对没有运气。有人可以告诉我我做错了什么吗？

来自 ASP MVC 视图的代码部分

```
 <td>
    @if (!String.IsNullOrWhiteSpace(item.Notes))
    {
        <span id="notes" onclick='GetNotes(@id);'>
            <img src="@Url.Content("~/Content/images/magnify.gif")" alt="Show Notes" />
        </span>           
    }

        <div id="@id" style="display:none;">
            @Html.DisplayFor(modelItem => item.Notes)
        </div>       
    </td> 
```

jQuery代码：

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<script src="@Url.Content("~/Scripts/jquery.tablesorter.min.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#thetable").tablesorter();
    }
    );

    function GetNotes(id) {
        $(function GetNotes() {
            $("#" + id + "\"").dialog();
        });
    }

</script> 
```

编辑

onlick 方法名称以前包含错误。有一个额外的')'。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:52:29.230

`GetNotes`你在这个函数中有一些非常糟糕的javascript 。试试这样：

```
function GetNotes(id) {
    $('#' + id).dialog();
} 
```

还要在浏览器中观看您的 javascript 调试控制台。它会告诉你错误。

# android - Android：按 id 获取行

> ID：14388764
> 
> 赞同：0
> 
> 时间：2013-01-17T21:50:09.690
> 
> 标签：android, sqlite, select

我试图通过它的 ID 获取数据库行，但不知何故查询不会返回该行。sql查询`SELECT * From Table1 Where _id = 100`效果很好，所以不知道是什么原因。这是查询的代码：

```
 String [] selectedArgs = new String [] {String.valueOf(selectedItemId)};
    String selection = Tables.Table1.COLUMN_ID + "=?";
    String [] columns = {Tables.Table1.COLUMN_ID, Tables.Table1.COLUMN_NAME};
    Cursor c = foodDB.query(Tables.Food.TABLE_NAME, columns, selection, selectedArgs, null, null, null); 
```

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:10:04.390

问题是您的 ID 字段是数字，而参数是字符串；由于某些奇怪的原因，该`query`函数不允许其他参数类型。

尝试使用类似的表达式`COLUMN_ID + " = CAST(? AS INTEGER)"`。

如果您的查询只有一个结果列，您可以使用一个单独的[`SQLiteStatement`](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html)对象，您可以在其中使用`bindLong()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T22:14:35.240

以防万一有人需要它，我已经使用 rawQuery() 方法来处理这种类型的查询，因为 query() 不起作用。

# java - 迭代 ArrayList 并检查所有其他元素

> ID：14388766
> 
> 赞同：-1
> 
> 时间：2013-01-17T21:50:19.403
> 
> 标签：java, arraylist, compare, distance, loops

我正在尝试根据所有其他值检查 ArrayList 中的所有值，如果它们的值太接近，则删除一个。这是一个例子：

```
// make an ArrayList of random numbers
ArrayList<Integer> nums = new ArrayList<Integer>();
for (int i=0; i<25; i++) {
  int rand = int(random(255));
  nums.add(rand);
  println(rand);  
}

// go through all numbers and compare
// (loop backwards to prevent ConcurrentModificationException)
for (int i = nums.size()-1; i >= 0; i--) {
  int current = nums.get(i);
  println("Current #: " + current);

  // how to do this?
  // not sure if there's a faster way that
  // would avoid running through the entire 
  // ArrayList for every element...
  for (Integer other : nums) {
    if (abs(current - other) < 5) {
      nums.remove(current);
    }
  }
} 
```

寻找最干净和最有效的方法来做到这一点。

[为清楚起见编辑]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:29:29.073

您最好以不同的方式进行操作，以避免并发修改和/或超出范围的异常。

在迭代集合时从集合中删除任何内容是一个冒险的想法（恕我直言），将其替换为向另一个集合添加内容要安全得多。

因此，将代码替换为等效代码，但将对象添加到新集合中。

集合是轻量级对象，因此创建它们不会占用太多资源。

最后将原始集合变量分配给新集合。

像这样的东西：

```
 final ArrayList<Integer> nums = new ArrayList<Integer>();
        final ArrayList<Integer> result = new ArrayList<Integer>();
        for (int i = 0; i < 25; i++) {
            final int rand = Double.valueOf(Math.random() * 255).intValue();
            nums.add(rand);
        }
        System.out.println(nums);
        outer: for (Integer current : nums) {
            // result collection is reevaluated here 
            // and is not modified inside the inner for loop
            // so, accessing it is safe
            for (Integer other : result) {
                if (Math.abs(current - other) < 5) {
                    // there is a too close value, do not put, skip the check
                    continue outer;
                }
            }
            // a too close value doesn't exist - add object
            result.add(current);
        }
        // here you may assing new collection to the old reference, uncomment next line
        // nums = results; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:05:14.243

当您从数组中删除并同时迭代它时，您会得到（并隐藏）很多`java.util.ConcurrentModificationException`and 。`java.lang.IndexOutOfBoundsException`

为了避免您需要使用迭代器：

```
final ArrayList<Integer> nums = new ArrayList<Integer>();
    for (int i = 0; i < 25; i++) {
        final int rand = Double.valueOf(Math.random() * 255).intValue();
        nums.add(rand);
    }
    System.out.println(nums);

    for (int i = nums.size() - 1; i >= 0; i--) {
        final int current = nums.get(i);
        // println(current);
        try {
            for (final Iterator<Integer> iterator = nums.iterator(); iterator.hasNext();) {
                final Integer other = iterator.next();
                if (Math.abs(current - other) < 5) {
                    iterator.remove();
                    i--;
                }
            }
        } catch (final Exception cme) {
            System.out.println(cme);
        }
    }

    System.out.println(nums); 
```

# macos - 提示输入提交消息时编辑器未打开

> ID：14388768
> 
> 赞同：1
> 
> 时间：2013-01-17T21:50:34.177
> 
> 标签：macos, git, github

显然，当 Git 希望您输入提交消息时，它应该为您打开一个编辑器。这在我的机器上从来没有发生过，所以我想知道它是否只是没有设置或者我没有 Vim 或其他东西。TextEdit 是我的默认文本编辑 (.txt) 应用程序。

如何让 Git 打开一个文本编辑器供我使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:56:45.677

有关如何查找编辑器开始[`man git-var`](http://git-scm.com/man/var)的说明，请参阅：`git`

> 优先顺序是 $GIT_EDITOR 环境变量，然后是 core.editor 配置，然后是 $VISUAL，然后是 $EDITOR，然后是编译时选择的默认值，通常是 vi

我将从`export GIT_EDITOR=/path/to/your/editor`or开始`git config --add core.editor /path/to/your/editor`，以提供您知道要安装的编辑器。

# wpf - System.Windows.Visibility 折叠与隐藏

> ID：14388777
> 
> 赞同：2
> 
> 时间：2013-01-17T21:51:09.027
> 
> 标签：wpf, user-interface, layout, wpf-controls

我有一个将 Visibility 设置为“Collapsed”的控件和一个 ToggleButton，用于更改 Visibility.Collapsed 和 Visibility.Hidden 之间的可见性。根据 [MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.visibility.aspx)，当控件的 Visibility 设置为“Collaped”时，布局内不应为控件分配空间，但两个枚举之间没有视觉差异。此外，控件的 Visibility 最初设置为 Collapsed，因此控件的初始绘制不应为控件分配任何空间。

是否有我遗漏的概念，或者如何让元素仅在可见时占用空间？我的最终目标是让控件出现在基于用户选择的条件上，这些选择出现在所述显示可变控件的北部，所有控件之间的边距一致。

XAML 代码段：

```
<StackPanel>
    <TextBox Name="hideTest" DataContext="{StaticResource persistentMemoryBridge}"   Text="HIDETEST" Margin="0,327,31,491" Foreground="Black" Background="Orange" Visibility="Collapsed" />
    <TextBox DataContext="{StaticResource persistentMemoryBridge}"   Text="{Binding Path=PropertyTest}" Margin="0,386,31,432" Foreground="Black" Background="Yellow"/>
    <ToggleButton Name="tbVisibility" Content="Toggle" Click="ToggleButton_Click" Margin="0,445,65,391"></ToggleButton>
</StackPanel> 
```

代码隐藏：

```
private void ToggleButton_Click(object sender, RoutedEventArgs e) {

        switch (hideTest.Visibility) {
            case System.Windows.Visibility.Collapsed: {
                hideTest.Visibility = Visibility.Hidden;
                tbVisibility.Content = "Hidden";
                break;    
            }
        case System.Windows.Visibility.Hidden: {
            hideTest.Visibility = Visibility.Visible;
            tbVisibility.Content = "Visible";    
            break;
            }
        case System.Windows.Visibility.Visible: {
            hideTest.Visibility = Visibility.Collapsed;
            tbVisibility.Content = "Collapsed";
            break;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:30:17.697

当控件的可见性处于`Collapsed`状态时，其边距不参与布局（与`Hidden`状态相反）

可以很容易地验证：

```
<Window x:Class="MarginsRespectForCollapsedTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <StackPanel>
        <Button Margin="50,50" Visibility="Collapsed">I'm Collapsed</Button>
        <Button>I'm Visible!</Button>
    </StackPanel>
</Window> 
```

我同意 HighCore 的观点，你的 XAML 看起来真的就像你只是从工具箱面板中拖动控件一样。VS 的 XAML 设计器有一个令人不快的特性：它试图借助边距来定位控件。

# function - 在 numpy/scipy 中查找函数 matlab

> ID：14388786
> 
> 赞同：9
> 
> 时间：2013-01-17T21:51:50.327
> 
> 标签：function, matlab, numpy, find, scipy

`find(A>9,1)`对于 numpy/scipy.matlab是否有等效的功能？我知道`nonzero`numpy 中有这个函数，但我需要的是第一个索引，以便我可以在另一个提取的列中使用第一个索引。

例如：将在 matlab 中`A = [ 1 2 3 9 6 4 3 10 ]` `find(A>9,1)`返回索引`4`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T22:08:58.033

numpy 中的等价物`find`是`nonzero`，但它不支持第二个参数。但是你可以做这样的事情来获得你正在寻找的行为。

```
B = nonzero(A >= 9)[0] 
```

但是，如果您正在寻找的只是找到满足条件的第一个元素，那么您最好使用`max`.

例如，在 matlab 中，`find(A >= 9, 1)`将与`[~, idx] = max(A >= 9)`. numpy 中的等效函数如下。

```
idx = (A >= 9).argmax() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T22:13:19.163

matlab的`find(X, K)`大致相当于`numpy.nonzero(X)[0][:K]`python中的。@Pavan 的 argmax 方法可能是一个不错的选择 if `K == 1`，但除非您先验地知道 A >= 9 中会有一个值，否则您可能需要执行以下操作：

```
idx = (A >= 9).argmax()
if (idx == 0) and (A[0] < 9):
    # No value in A is >= 9
    ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-12T15:55:38.300

我确信这些都是很好的答案，但我无法使用它们。但是，我发现另一个线程部分回答了这个问题： [MATLAB-style find() function in Python](https://stackoverflow.com/questions/5957470/matlab-style-find-function-in-python)

John 发布了以下代码，它解释了 find 的第一个参数，在您的情况下是 A>9 ---find(A>9,1)-- 但不是第二个参数。

我修改了 John 的代码，我认为这是第二个参数“,1”的原因

```
def indices(a, func):
    return [i for (i, val) in enumerate(a) if func(val)]
a = [1,2,3,9,6,4,3,10]
threshold = indices(a, lambda y: y >= 9)[0] 
```

这将返回阈值 = 3。我的理解是Python的索引从0开始......所以它相当于matlab说4。您可以通过更改括号中的数字来更改被调用的索引的值，即[1]、[2]等而不是[0]。

约翰的原始代码：

```
def indices(a, func):
    return [i for (i, val) in enumerate(a) if func(val)]

a = [1, 2, 3, 1, 2, 3, 1, 2, 3]

inds = indices(a, lambda x: x > 2) 
```

返回 >>> inds [2, 5, 8]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-07T14:05:15.510

```
import numpy
A = numpy.array([1, 2, 3, 9, 6, 4, 3, 10])
index = numpy.where(A >= 9) 
```

您可以通过首先将列表转换为 ndarray，然后使用函数 numpy.where() 来获取所需的索引来做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-04T21:56:55.213

考虑[`argwhere`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.argwhere.html#numpy.argwhere)在 Python 中使用来替换 MATLAB 的`find`函数。例如，

```
import numpy as np
A = [1, 2, 3, 9, 6, 4, 3, 10]
np.argwhere(np.asarray(A)>=9)[0][0] # Return first index 
```

返回 3。

# django - 按最新孩子的时间戳或自己的时间戳对帖子进行排序

> ID：14388790
> 
> 赞同：0
> 
> 时间：2013-01-17T21:52:08.027
> 
> 标签：django, postgresql, psql

我的 django 应用程序中有模型，它们具有发布/回复关系，并试图按他们最新回复的时间对帖子进行排序，或者，如果没有回复，他们自己的时间戳。这就是我现在所拥有的：

```
threads = ConversationThread.objects.extra(select={'sort_date':
                                    """select case when (select count(*) from conversation_conversationpost 
                                    where conversation_conversationpost.thread_id = conversation_conversationthread.id) > 0 
                                    then (select max(conversation_conversationpost.post_date) 
                                    from conversation_conversationpost where conversation_conversationpost.thread_id = conversation_conversationthread.id) 
                                    else conversation_conversationthread.post_date end"""}).order_by('-sort_date') 
```

虽然它有效，但我有一种预感，这不是最简洁或最有效的方法。有什么更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:02:10.377

```
SELECT  *,
        (
        SELECT  COALESCE(MAX(cp.post_date), ct.post_date)
        FROM    conversation_conversationpost cp
        WHERE   cp.thread_id = ct.id
        ) AS sort_date
FROM    conversation_conversationthread ct
ORDER BY
        sort_date DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:31:46.807

[](http://en.wikipedia.org/wiki/Correlated_subquery)*众所周知，[*相关的子查询速度很慢。*](http://en.wikipedia.org/wiki/Correlated_subquery)
A`LEFT JOIN`可能要快得多（取决于数据分布）：*

 *```
SELECT  t.*, COALESCE(p.max_post_date, t.post_date) AS sort_date
FROM    conversation_conversationthread t
LEFT    JOIN (
    SELECT thread_id, MAX(post_date) AS max_post_date
    FROM   conversation_conversationpost
    GROUP  BY thread_id
    ) p ON p.thread_id = t.id
ORDER   BY sort_date DESC; 
```*

# c# - Emgucv 绘制的项目

> ID：14388797
> 
> 赞同：0
> 
> 时间：2013-01-17T21:52:34.687
> 
> 标签：c#, emgucv

我正在使用`Emgucv`库制作一个项目，他的问题如下，

1.  我捕捉图像
2.  检测特征
3.  提取它
4.  画出来

之后我将绘制的项目复制到一个空白图像中，现在我想在那个新图像中找到轮廓，但结果总是公牛，为什么会这样？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T15:46:37.587

额外的信息会很好。

但是为了能够找到轮廓，必须将新图像转换为像 ff 一样的二进制图像：（假设 newImage 是 Image 类型）

```
Image<Gray,byte> binaryImage = newImage.ThresholdBinary(new Gray(1), new Gray(255)); 
```

检测轮廓并写入 resultImage：

```
for (var contour = binaryImage.FindContours(
        CHAIN_APPROX_METHOD.CV_CHAIN_APPROX_SIMPLE, 
        RETR_TYPE.CV_RETR_CCOMP); 
        contour != null; 
        contour = contour.HNext)
    {
        resultImage.Draw(contour, new Gray(255), -1);
    } 
```

# linux - tcpdump：捕获到 libpcap 的链接类型未知的虚拟接口上的传出数据包？

> ID：14388798
> 
> 赞同：0
> 
> 时间：2013-01-17T21:52:36.653
> 
> 标签：linux, tcpdump

在我现在正在测试的系统中，它有几个链接在一起的虚拟 L2 设备，以在 Eth 标头和 IP 标头之间添加我们自己的 L2.5 标头。现在当我使用

```
tcpdump -xx -i vir_device_1 
```

，它实际上显示了带有 IP 标头的 SLL 标头。如何捕获实际从 vir_device_1 发出的完整数据包，即在 ndo_start_xmit() 设备调用之后？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T19:54:05.763

> 如何捕获实际从 vir_device_1 发出的完整数据包，即在 ndo_start_xmit() 设备调用之后？

通过编写自己的代码直接使用 PF_PACKET/SOCK_RAW 套接字（你说“SLL 标头”，所以这可能是 Linux），或者通过：

*   确保你`ARPHRD_`为你的虚拟接口分配了一个特殊的值；
*   为您的特殊标题集使用`DLT_USER`*n 个*值之一，或向 tcpdump-workers@lists.tcpdump.org 要求`DLT_`为它们分配一个官方值；
*   修改 libpcap 以将该`ARPHRD_`值映射到`DLT_`您正在使用的值；
*   修改 tcpdump 以处理该`DLT_`值；
*   如有必要，修改将在该接口上捕获的其他程序或读取 tcpdump 在该接口上写入的捕获文件以处理该值。

请注意，`DLT_USER`*n*值是专门为私人使用而保留的，并且*任何*官方版本的 libpcap、tcpdump 或 Wireshark 都不会将*它们*分配给自己使用（即，如果您使用`DLT_USER`*n*值，请不要费心提供补丁来分配它对您的标头类型的价值，因为它们不会被接受；其他人可能已经将它用于*他们*自己的特殊标头，并且必须继续支持），因此您必须维护 libpcap 的修改版本， tcpdump 等，如果您使用其中一个值而不是获得指定的官方值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T00:23:17.510

感谢 Guy Harris 为我最初的问题提供了非常有用的答案！

我将此添加为我在评论中提出的后续问题的答案/注释。基本上我的问题是 PF_PACKET/SOCK_RAW 收到的数据包的状态是什么。

对于软件设备（无队列），`dev_queue_xmit()`将调用`dev_hard_start_xmit(skb, dev)`开始传输 skb 缓冲区。该函数在调用`dev_queue_xmit_nit()`之前调用`dev->ops->ndo_start_xmit(skb,dev)`，这意味着 PF_PACKET 看到的数据包处于进行任何更改之前的状态`ndo_start_xmit()`。

# forms - 在 MVC4 中上传，在我的操作中有 2 个参数，但文件为空

> ID：14388799
> 
> 赞同：2
> 
> 时间：2013-01-17T21:52:45.417
> 
> 标签：forms, file-upload, upload, asp.net-mvc-4, httppostedfilebase

我正在尝试将文件上传到目录。以下代码对我有用

## 控制器

```
[HttpPost]
        public ActionResult Index(HttpPostedFileBase uploadFile)
        {
            //string path = @"C:\Users\thomas\Desktop";

            if (uploadFile != null)
            {
                string filePath = Path.Combine(Server.MapPath("/files"), Path.GetFileName(uploadFile.FileName));
                uploadFile.SaveAs(filePath);
            }

            return RedirectToAction("Index");
        } 
```

## 网页

```
@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>
<form action="/Post/Index" method="post" enctype="multipart/form-data">
    <label for="uploadFile">Upload file: </label>
    <input name="uploadFile" id="uploadFile" type="file" />
    <input value="uploadFile" type="submit" />
</form> 
```

现在我试图在一个函数中实现这一点，在该函数中我创建一个消息，该消息由包含消息和项目类的模型创建。当我提交表单时，模型将传递给我的保存控制器，但我的参数控制器中的文件为空。

网页

## 创建新消息

```
@model GeoCitytroopers.Models.MessageItemModel
@{
    ViewBag.Title = "Create";
}
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Event</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Message.MessagePicture)
        </div>
        <div>
            <label for="uploadFile">Upload file: </label>
            <input name="uploadFile" id="uploadFile" type="file" />
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Message.MessagePicture)
            @Html.ValidationMessageFor(model => model.Message.MessagePicture)
        </div>
        <div class="editor-label">
            @Html.LabelFor(model => model.Item.ItemTitle)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Item.ItemTitle)
            @Html.ValidationMessageFor(model => model.Item.ItemTitle)
        </div>
        <div class="editor-label">
            @Html.LabelFor(model => model.Item.ItemDescription)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Item.ItemDescription)
            @Html.ValidationMessageFor(model => model.Item.ItemDescription)
        </div>

         <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

## 控制器

```
[HttpPost]
        public ActionResult Create(HttpPostedFileBase uploadFile, MessageItemModel ViewModel)
        {
            if (ModelState.IsValid)
            {
                Utility ut = new Utility();
                Item viewItem = ViewModel.Item;
                Message viewMessage = ViewModel.Message;

                if (uploadFile != null)
                {
                    string filePath = Path.Combine(Server.MapPath("/files"), Path.GetFileName(uploadFile.FileName));
                    uploadFile.SaveAs(filePath);
                }
                //ADD USER TO ITEM
                viewItem = ut.AddUserToItem(viewItem);

                //ADD ITEM
                viewItem.ItemCreateddate = DateTime.Now;

                //ADD DISTRICT TO ITEM
                viewItem.DistrictID = ut.GetUserDistrict();

                db.Items.Add(viewItem);

                //ADD LINK
                viewMessage.Item = viewItem;
                db.Messages.Add(viewMessage);

                db.SaveChanges();
                return RedirectToAction("Index");
            }
            return View(ViewModel);
        } 
```

如何将上传文件传递给我的控制器？提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T21:56:26.733

你忘了设置正确`enctype`的形式。没有它你不能上传文件：

```
@using (Html.BeginForm(null, null, FormMethod.Post, new { enctype = "multipart/form-data" })) {
    ...
} 
```

现在上传将起作用，您的`uploadFile`参数不会为空。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T21:57:13.160

我最初的猜测是您使用 Html 助手创建的没有必要的加密。

尝试使用

```
using(@Html.BeginForm("action-name","controller-name", 
                       FormMethod.Post, new { enctype="multipart/form-data"}){

} 
```

具有适当的值`action-name`和`controller-name`

# templates - 如何使用 Ember.Handlebars.compile() 在类定义中声明 Ember 模板？

> ID：14388803
> 
> 赞同：3
> 
> 时间：2013-01-17T21:53:07.913
> 
> 标签：templates, view, ember.js, ember-router

在最新的 ember 主版本中，我试图声明一个类似于这样的模板：

```
App.IndexView = Ember.View.extend({
  template: Ember.Handlebars.compile('Index template in code')
}); 
```

..它不工作。使用相同的代码并使用该`templateName`属性在 HTML 中引用模板可以正常工作。有任何想法吗？

这是一个带有周围代码和 HTML 的 jsfiddle：http: [//jsfiddle.net/TTMMz/3/](http://jsfiddle.net/TTMMz/3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T03:49:15.130

可能是一个错误，如果您尝试设置 defaultTemplate 而不是模板它将起作用。你也许应该提出一个问题。

```
App.IndexView = Ember.View.extend({
  defaultTemplate: Ember.Handlebars.compile('Index template in code')
}); 
```

供参考

> 对于可能具有稍后定义的模板的视图类（例如，作为`{{view}}`另一个模板或子类中的 Handlebars 助手调用的块部分），您可以为`defaultTemplate` 编译的模板函数提供属性集。如果稍后没有为视图实例提供模板，`defaultTemplate`则将使用该值：

```
AView = Ember.View.extend({
     defaultTemplate: Ember.Handlebars.compile('I was the default'),
     template: null,
     templateName: null   }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T17:54:39.247

添加`templateName: 'index'`到`App.IndexView`. 看起来路由器需要/想要一个名为的模板`index`，而您在 JSFiddle 中使用它的方式路由器找不到。

[JSFiddle 示例](http://jsfiddle.net/cteegarden/TTMMz/9/)

```
App.IndexView = Ember.View.extend({
  template: Ember.Handlebars.compile('Index template in code'),
  templateName: 'index'
}); 
```

# java - 请求：在我的 java 应用程序中检索属性。由“PropertyPlaceholderConfigurer”收集——属性作为键/值存储在数据库中

> ID：14388806
> 
> 赞同：0
> 
> 时间：2013-01-17T21:53:11.763
> 
> 标签：java, spring

PUsing Spring 3.2.0.release 和 JDK 1.6。我有一个独立的 Java 程序（不在 tomcat etal 中运行），我正在从数据库加载属性。

我以这篇优秀的文章为基础，它运行良好。使用`PropertiesPrinter`bean（在那里定义）作为基础并添加`getters`我可以做类似的事情`getFileLocation()`，`getPetDogsName()`但是我需要`setter/getters`为每个属性拥有/创建。

我想要的是一个名为 DatabaseProperties 的 Spring Bean 或普通 Java 类，其方法如下`getProperty("filelocation")`；我可以在我的应用程序（主）中使用它，因此我可以检索/获取属性文件位置的值，该值位于由`PropertyPlaceholderConfigurer`.

我做了很多挖掘，但似乎找不到我需要的信息，或者至少我无法将收集到的信息组合到一个工作程序中，因为我不熟悉 Spring ....

任何提示/指针/网址/代码都非常感谢。这可能相对容易，但对我来说仍然遥不可及。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:59:40.773

读取由 , 设置的值的一种解决方案`PropertyPlaceholderConfigurer`是使用[@Value](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/annotation/Value.html)注释而不是设置类成员变量的方法：

```
class MyClass {

   @Value("${file.location}")
   private String fileLocation;
   ...
} 
```

# php - 如何在对象上下文中使用另一个类的方法？

> ID：14388807
> 
> 赞同：1
> 
> 时间：2013-01-17T21:53:12.840
> 
> 标签：php, performance, class

我想问一个关于服务器性能的菜鸟问题。

假设每个类包含 1000 个具有相同性能的行代码。

如果我想使用一个属于另一个的功能。我发现有 3 种方法可以做到这一点。

1.  课内`$this->Another_Class = new Another_Class`
2.  使用静态`Another_Class::Wanted_Function()`
3.  全球的`global $Another_Class`

请问在服务器性能方面，它们是一样的吗？还是除了魔术电话我还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:08:35.450

应始终避免使用全局变量，并且通常也应避免使用静态变量，除非确实有必要，因为它们不利于代码重用。

此外，您可能想看看控制反转和依赖注入等概念。简而言之，您不应该在类中实例化依赖项，而是注入它。
简单的例子：

```
class Example
{
    protected $foo;

    public function setFoo($foo)
    {
        $this->foo = $foo;
    }

    public function doSomething()
    {
        $this->foo->callFooMethod();
    }
}

$example = new Example();
$example->setFoo(new Foo);
$example->doSomething(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:58:36.180

我强烈建议您不要将全局变量用于任何事情。

至于是使用静态类还是实例化类……这完全取决于您要做什么。静态成员函数本质上与能够访问其他静态成员函数/变量的命名空间函数相同。

实例化一个类在技术上比访问一个静态类要慢，但只有在 __construct() 和类变量初始化发生时运行逻辑时才会出现这种情况。

# google-drive-api - 访问 Google Drive API 时出现“无效凭据”

> ID：14388809
> 
> 赞同：0
> 
> 时间：2013-01-17T21:53:22.247
> 
> 标签：google-drive-api, google-api-python-client

我正在开发一个 AppEngine 应用程序，它使用 Google Drive API 列出我的 Google Drive 中的文件。当我的一位用户尝试运行我的应用程序时，我收到 500 错误：

HttpError：https://www.googleapis.com/drive/v2/files?q=%27[ID sanitized]%27+in+parents&alt=json&maxResults=5 返回“无效凭据”>

该代码从特定的谷歌驱动器文件夹中提取文件。该文件夹和文件与用户共享，并且该应用程序被授权使用 Google Drive API。

在某些时候，我认为我应该从头开始，所以我撤销了该用户帐户的授权。似乎没有什么不同，现在增加侮辱伤害似乎我的应用程序不再要求该特定用户授权。

在这一点上有人有什么建议吗？我的代码使用 Python 的 Google API 客户端和装饰器（带有 oauth_required）来处理授权：

```
CLIENT_SECRETS = os.path.join(os.path.dirname(__file__), 'client_secrets.json')

MISSING_CLIENT_SECRETS_MESSAGE = """
<h1>Warning: Please configure OAuth 2.0</h1>
<p>
To make this sample run you will need to populate the client_secrets.json file
found at:
</p>
<p>
<code>%s</code>.
</p>
<p>with information found on the <a
href="https://code.google.com/apis/console">APIs Console</a>.
</p>
""" % CLIENT_SECRETS

http = httplib2.Http(memcache)

service = build("plus", "v1", http=http)
files_service = build("drive", "v2", http=http)

decorator = oauth2decorator_from_clientsecrets(
    CLIENT_SECRETS,
    scope='https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/drive.readonly',
    message=MISSING_CLIENT_SECRETS_MESSAGE)

[...]

class MainPage(webapp2.RequestHandler):

    @decorator.oauth_required
    def get(self):

[...]

        try:
            kb_param = {}
            kb_param["maxResults"] = 5
            kb_param["q"] = "'[sanitized]' in parents"
            kb_files = files_service.files().list(**kb_param).execute(http=http)

            template_values = {
                'kb_files': kb_files["items"]
            } 
```

任何见解将不胜感激:)

谢谢！瑞克。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T05:19:00.923

令牌可能已被撤销，或者凭据可能实际上是错误的。

# javascript - photoswipe 由于某种原因一直闪烁

> ID：14388811
> 
> 赞同：0
> 
> 时间：2013-01-17T21:53:37.240
> 
> 标签：javascript, jquery-mobile, jquery-plugins

我已经为移动设备设置了photoswipe，除了在手机上滑动时照片保持闪烁之外，它工作正常，但在计算机上工作正常。知道如何解决吗？干杯

该示例将是： [http ://www.photoswipe.com/latest/examples/04-jquery-mobile.html](http://www.photoswipe.com/latest/examples/04-jquery-mobile.html)

代码在这里：

```
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 

    <title>test/title> 

<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<link href="http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.css" rel="stylesheet"  />
    <script type="text/javascript" src="http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.js"></script>
<script type="text/javascript" src="http://computersforpeople.info/websites/scripts/jquery/lib/klass.min.js"></script>  
    <link href="http://computersforpeople.info/websites/scripts/jquery/photoswipe.css" type="text/css" rel="stylesheet" />

    <script type="text/javascript" src="http://computersforpeople.info/websites/scripts/jquery/code.photoswipe.jquery-3.0.4.min.js"></script>

    <script type="text/javascript">

        (function(window, $, PhotoSwipe)
        {
            $(document).ready(function()
            {
                $("#gallery a").photoSwipe(
                {
                    enableMouseWheel: false,
                    enableKeyboard: false
                });

                $("#gallery a:first").click();
            });
        }(window, window.jQuery, window.Code.PhotoSwipe));

</script>

<script type="text/javascript">

$('a').live('click', function() {
    var $this = $(this);
    if ( !$this.attr('rel') || $this.attr('rel') != 'external' )
        $(document.getElementById( $this.attr('href') )).remove();
});

</script>

</head> 

<body> 

<div data-role="page" data-add-back-btn="true" data-back-btn-text="Back" >
<div data-role="header" >
        <h1 style="white-space:normal">Apartment Specialists</h1>

  </div>
  <ul  data-role="listview" data-inset="true" data-filter="false">
        <li><a href="http://mobilecityleaders.smartagent.co.nz/users/262/properties">Feature Apartments</a></li>

                <ul data-role="listview"  data-filter="false" id="test-more">

  <div id="gallery" >

          <a href="http://prod.computersforpeople.info/media/2012/12/03/222204_46921.jpg?m=resize&o[geometry]=350x262&s=732bf1b52c70b0fc" > <img src="http://prod.computersforpeople.info/media/2012/12/03/222204_46921.jpg?m=resize&o[geometry]=120x90&s=e4501ebdfd60d8db" alt="" /></a>

          <a href="http://prod.computersforpeople.info/media/2012/12/03/222208_46921.jpg?m=resize&o[geometry]=350x262&s=293a3a114859a240" > <img src="http://prod.computersforpeople.info/media/2012/12/03/222208_46921.jpg?m=resize&o[geometry]=120x90&s=c599ece1364cfafe" alt="" /></a>

          <a href="http://prod.computersforpeople.info/media/2012/12/03/222213_46921.jpg?m=resize&o[geometry]=350x262&s=da0802cfe1060df4" > <img src="http://prod.computersforpeople.info/media/2012/12/03/222213_46921.jpg?m=resize&o[geometry]=120x90&s=f4b0ffaea30f6a2b" alt="" /></a>

          <a href="http://prod.computersforpeople.info/media/2012/12/03/222218_46921.jpg?m=resize&o[geometry]=350x262&s=a54d15c8570f1d2b" > <img src="http://prod.computersforpeople.info/media/2012/12/03/222218_46921.jpg?m=resize&o[geometry]=120x90&s=767b0330b9cf2f1e" alt="" /></a>

          <a href="http://prod.computersforpeople.info/media/2012/12/03/222223_46921.jpg?m=resize&o[geometry]=350x262&s=9e2db11b4d87f798" > <img src="http://prod.computersforpeople.info/media/2012/12/03/222223_46921.jpg?m=resize&o[geometry]=120x90&s=e9f8871520333fbe" alt="" /></a>

          <a href="http://prod.computersforpeople.info/media/2012/12/03/222227_46921.jpg?m=resize&o[geometry]=350x262&s=2cd999589c41d34d" > <img src="http://prod.computersforpeople.info/media/2012/12/03/222227_46921.jpg?m=resize&o[geometry]=120x90&s=1af459b7ecc85dbe" alt="" /></a>

</div>  
<br /> 

<p align="center">
 <a href="javascript: history.go(-1)"><font face="Arial, Helvetica, sans-serif">Back</font></a></p>

    </ul>
    <br />

<li><a href="http://mobilecityleaders.smartagent.co.nz/users/264/properties">All Apartments</a></li>

</ul>

    <div data-role="footer" align="center">

    <h6 style="font-size: 55%;font-family:calibri">
  RE/MAX Leaders Real Estate (1987) Ltd Licensed Under REAA 2008</h6>
    </div>
    <!-- /footer -->

    </div>  

<!-- /page -->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:45:04.753

我只是整理一下。使用 code.photoswipe-3.0.5.min.js 而不是 3.0.4 的版本。谢谢

# jquery - jquery防止触摸悬停功能

> ID：14388813
> 
> 赞同：10
> 
> 时间：2013-01-17T21:53:43.653
> 
> 标签：jquery, click, jquery-hover

我有一个悬停功能，如果它是一个触摸设备，我希望不会发生悬停事件。问题是当您使用触摸设备点击链接时，它会在点击事件之前执行悬停事件，因此您必须点击它两次才能使其工作。

这是悬停功能：

```
$("#close").hover( 
    function () { 
        $("#close_2").css({
            display: "none"
        });
        $("#close_1").css({
            display: "block"
        });
    }, 
    function () {
        $("#close_1").css({
            display: "none"
        });
        $("#close_2").css({
            display: "block"
        });;
    }
); 
```

然后我将其设置为点击功能：

```
$('#close').click(function() {
    var id = $(this).attr('id');
    $('#full_image').animate({
        height: 0
    }, 300, function() {
        $('#full_image img').attr('src','#');
    });
    $("#close_1").css({
        display: "none"
    });
    $("#close_2").css({
        display: "none"
    });
    $("#close").css({
        display: "none"
    });
}); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-17T22:04:05.280

使 .hover() 方法更明确，并将其与 .on() 结合使用：

```
var $close1 = $('#close_1'),
    $close2 = $('#close_2');

$('#close').on({
    mouseenter: function(){
        $close2.css({display:'none'});
        $close1.css({display:'block'});
    },
    mouseleave: function(){
        $close1.css({display:'none'});
        $close2.css({display:'block'});
    }
}); 
```

然后将它与 .off() 结合起来。

```
$('#close').on('touchstart',function(){
    $(this).off('mouseenter,mouseleave');
}); 
```

如果您希望事件在点击触摸设备时触发，但在桌面设备上悬停时触发，则将函数作为您在这些操作中分别调用的单独函数。

**编辑**

自从我回答这个问题以来已经有一段时间了，这是一个更好的方法：

```
$(function(){
    var isTouchDevice = ('ontouchstart' in window || 'onmsgesturechange' in window),
        $close = $('#close'),
        $close1 = $('#close_1'),
        $close2 = $('#close_2');

    if(!isTouchDevice){
        $close.on({
            mouseenter: function(){
                $close2.hide();
                $close1.show();
            },
            mouseleave: function(){
                $close1.hide();
                $close2.show();
            }
        });
    }

    $close.on('click',function(){
        $('#full_image').animate({height:0},300,function(){
            $(this).find('img').attr('src','#');
        });

        $close.hide();
        $close1.hide();
        $close2.hide();
    });
}); 
```

这不需要在每次触摸时触发“防止悬停”事件，基本上在页面加载时设置功能，同时不影响点击事件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T22:18:05.997

我认为一个明确的方法是：

1.  检测浏览器是否支持触摸事件
2.  相应地添加悬停事件处理程序

如果您已经在使用 Modernizr 之类的东西：

```
if(!Modernizr.touch){
    // only if the browser doesn't support touch events,
    // add the hover handler here.
}
//add the click handler here, as you want it bound no matter what 
```

请参阅[使用 JavaScript 检测“触摸屏”设备的最佳方法是什么？](https://stackoverflow.com/questions/4817029/whats-the-best-way-to-detect-a-touch-screen-device-using-javascript)以及[使用 JavaScript 检测“触摸屏”设备的最佳方法是什么？](https://stackoverflow.com/questions/4817029/whats-the-best-way-to-detect-a-touch-screen-device-using-javascript)用于检测触摸功能的其他选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-10T06:00:24.243

在移动端，在*touchstart事件中调用***preventDefault**可防止*mouseover*、*mouseenter*、*mousedown*和附属事件。详情：[https ://patrickhlauke.github.io/touch/tests/results/](https://patrickhlauke.github.io/touch/tests/results/)

 ***```
 $('#close').on('touchstart',function(e){
        console.log('touchstart');
        e.preventDefault();
        //Do touch stuff
    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-22T20:47:00.160

由于 Windows 8 和超极本，我希望看到很多设备同时支持触摸和指针事件。因此，我避免完全禁用悬停事件，因为它可能会破坏使用鼠标启用触摸的用户的站点。

为了解决这个问题，我最终使用了两个不同的类来显示菜单`.hover`和`.touch`，以及悬停和点击的单独事件。

我正在使用[jquery.finger](http://ngryman.sh/jquery.finger/)来捕获点击事件，尽管任何插件都应该可以工作，这只是最小的一个。

*HTML 将类似于：*

```
<li>
    <a>Some Link</a>
    <div>Some Content</div>
</li> 
```

*CSS 将类似于：*

```
li div {display:none;}
li.hover div, li.touch div {display:block;} 
```

*以及使用 JQuery 的 Javascript：*

```
// Caching whatever elements I'm using for the navigation
a = $("a");
li = $("li");

// Set hover events
li.hover(

    // Both hover in and out fire whenever the user taps, aggravating!
    function(e) {
        // Close unused menus
        li.not(this).removeClass("hover").removeClass("touch");

        // Show this menu
        $(this).addClass( "hover" );
    }, function(e) {
        // Only closes if the menu doesn't have .touch, hell yeah!
        li.removeClass("hover");
    }

);

// Set the tap event
a.on('tap',function(e,data){
    e.stopPropagation();
    var thisParent = $(this.parentNode);

    // Close unused menus
    li.not(thisParent).removeClass("touch");

    // Toggle the current menu
    thisParent.toggleClass("touch");

    // The menu is open, so we don't need this class anymore
    li.removeClass("hover");
});

// Prevent the list items when being tapped from closing the drop down
li.on('tap',function(e){e.stopPropagation();});

// Close drop downs when tapping outside the menus
$(document).on('tap',function(e){
   li.removeClass("touch");
}); 
```

这里重要的一点是我如何根据事件添加单独的`.hover`或`.touch`类，以及删除未使用的类。顺序很重要，因此菜单不会闪烁。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2013-01-17T22:22:33.423

最终使用触摸检测：

```
var deviceAgent = navigator.userAgent.toLowerCase();
var agentID = deviceAgent.match(/(iphone|ipod|ipad)/);

if(agentID) { 
    $('#close').click(function() {
        var id = $(this).attr('id');
        $('#full_image').animate({
            height: 0
        }, 300, function() {
            $('#full_image img').attr('src','#');
        });
        $("#close_1").css({
            display: "none"
        });
        $("#close_2").css({
            display: "none"
        });
        $("#close").css({
            display: "none"
        });
    });
}
else {
    $('#close').hover(
        function() {
            $("#close_2").css({
                display: "none"
            });
            $("#close_1").css({
                display: "block"
            });
        }, function() {
            $("#close_1").css({
                display: "none"
            });
            $("#close_2").css({
                display: "block"
            });
        }
    ); 
    $('#close').click(function() {
        var id = $(this).attr('id');
        $('#full_image').animate({
            height: 0
        }, 300, function() {
            $('#full_image img').attr('src','#');
        });
        $("#close_1").css({
            display: "none"
        });
        $("#close_2").css({
            display: "none"
        });
        $("#close").css({
            display: "none"
        });
    });
} 
```***

# javascript - WinJS 使用 JSON 解析网站

> ID：14388816
> 
> 赞同：0
> 
> 时间：2013-01-17T21:54:09.790
> 
> 标签：javascript, html, winjs

我正在尝试使用 JSON 解析网站。我在 JSON.parse 行不断收到错误消息。这是我一直在该行遇到的错误：

```
 Exception is about to be caught by JavaScript library code at line 31, column 21 in ms-appx://37099737-8761-481d-b1e3-38412d272486/pages/search1/search1.js

    0x800a03f6 - JavaScript runtime error: Invalid character

    If there is a handler for this exception, the program may be safely continued. 
```

这是我的代码：

```
 loadWebsite: function (totalSearch) {
        WinJS.xhr({url: totalSearch}).then(
            function (response) {
                var json = JSON.parse(response.responseText); //this line here
                var list = new WinJS.Binding.List(json.results);
                gridView1.winControl.itemDataSource = list.dataSource;
            },
        function (error){ console.log(error); },
        function (progress) { }
        );
        return;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:01:35.003

网站通常以 HTML 格式发送，这与 JSON 完全不同。

您应该使用 HTML 解析器来解析 HTML，并使用 JSON 解析器来解析 JSON。有道理，不是吗？

# php - PHP 项目高音扬声器

> ID：14388821
> 
> 赞同：0
> 
> 时间：2013-01-17T21:54:43.490
> 
> 标签：php

请参阅我制作的东西，只需单击一个按钮即可发布一个项目。
这是 Item 部分的片段：

```
 $arr = json_decode(file_get_contents("http://media1.clubpenguin.com/play/en/web_service/game_configs/paper_items.json"),true);
$elements = array_slice($arr, $page * $elementsPerPage, $elementsPerPage);
foreach($elements as $item)
{
$label = $item['label'];
$id = $item['paper_item_id'];
}
$cpitems = array("Check out the $label at http://www.cpcheatsdojo.info/SWFViewer/items.swf?id=$id [$random]"); 
```

这就是片段。问题是当我单击按钮时，它会发布相同的项目。我试图制作推文随机项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:12:01.270

我认为您正在寻找[`array_rand`](http://php.net/manual/en/function.array-rand.php)允许您：

> 从数组中选择一个或多个随机条目

编码：

```
$arr = json_decode(file_get_contents("http://media1.clubpenguin.com/play/en/web_service/game_configs/paper_items.json"),true);
$elements = array_slice($arr, $page * $elementsPerPage, $elementsPerPage);

$items = array_rand($elements, 1);
$item = $elements[$items[0]];
$label = $item['label'];
$id = $item['paper_item_id']; 
```

# c++ - 使用套接字的 HTTP 重定向

> ID：14388822
> 
> 赞同：0
> 
> 时间：2013-01-17T21:54:53.387
> 
> 标签：c++, http, sockets, redirect, network-programming

我有一个应用程序绑定本地主机上的特殊端口并等待连接和 HTTP 请求。例如，我启动我的应用程序并在浏览器中写入：

> 127.0.0.1:12345/?数据=消息

我的应用程序接收它并处理（使用winsock）。我的问题是：如何进行重定向。当我的应用程序接收到数据时，我需要将客户端（在浏览器中）重定向到 Internet 上的特殊页面（现在客户端只看到“找不到页面”）。

对不起，我可能是愚蠢的问题，我以前从未使用过套接字、请求等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:16:57.290

您必须将其添加到 HTML 中：

```
<meta http-equiv="refresh" content="0; url=http://whatever.org/"> 
```

并将 http://whatever.org/ 设置为您需要重定向的任何位置

# c# - 从列表中删除子列表

> ID：14388834
> 
> 赞同：9
> 
> 时间：2013-01-17T21:56:07.963
> 
> 标签：c#, .net

我有 2 个列表：`list1`和`list2`（均为 int 类型）

现在我想删除`list2`from的内容`list1`。我如何在 C# 中做到这一点？

PS：不要使用循环。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-17T21:57:34.260

**重要变化**

正如评论中所指出的，在内部使用了一个集合，因此最终结果中将不存在`.Except()`任何重复的成员。`list1`

> 产生两个序列的**集合**差

[http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except(v=vs.110).aspx)

但是，有一个解决方案既 O(N) 又保留原始列表中的重复项：修改`RemoveAll(i => list2.Contains(i))`方法以使用 a`HashSet<int>`来保存排除集。

```
List<int> list1 = Enumerable.Range(1, 10000000).ToList();
HashSet<int> exclusionSet = Enumerable.Range(500000, 10).ToHashSet(); 

list1.Remove(i => exclusionSet.Contains(i)); 
```

扩展方法`ToHashSet()`在[MoreLinq](https://code.google.com/p/morelinq/)中可用。

**原始答案**

您可以使用 Linq

```
list1 = list1.Except(list2).ToList(); 
```

**更新**

出于好奇，我对我的解决方案与@HighCore 的解决方案进行了简单的基准测试。

由于`list2`只有一个元素，他的代码更快。随着`list2`越来越大，他的代码变得*非常*慢。看起来他是**O(N-squared)**（或者更具体地说是 O(list1.length*list2.length)，因为其中的每个项目`list1`都与 中的每个项目进行比较`list2`）。没有足够的数据点来检查我的解决方案的 Big-O，但是当`list2`有多个元素时它会快得多。

用于测试的代码：

```
 List<int> list1 = Enumerable.Range(1, 10000000).ToList();
        List<int> list2 = Enumerable.Range(500000, 10).ToList(); // Gets MUCH slower as 10 increases to 100 or 1000

        Stopwatch sw = Stopwatch.StartNew();

        //list1 = list1.Except(list2).ToList();
        list1.RemoveAll(i => list2.Contains(i));

        sw.Stop();

        var ms1 = sw.ElapsedMilliseconds; 
```

**更新 2**

此解决方案为变量分配一个新列表`list1`。正如@Толя 指出的那样，对原始文件的其他引用（如果有的话）`list1`将不会被更新。除了最小`RemoveAll`尺寸的`list2`. 如果没有其他参考必须看到更新，那么最好是出于这个原因。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-17T21:58:08.193

```
list1.RemoveAll(x => list2.Contains(x)); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-17T21:57:34.637

你可以使用这个：

```
List<T> result = list1.Except(list2).ToList(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T22:15:34.003

这将从中删除每个`secondList`项目`firstList`：

```
firstList.RemoveAll( item => { secondList.Contains(item); } ); 
```

# grails - 在 Grails 应用程序和非 Grails 应用程序之间共享域对象

> ID：14388835
> 
> 赞同：1
> 
> 时间：2013-01-17T21:56:08.463
> 
> 标签：grails, groovy, gradle, grails-plugin

我有一个 grails 应用程序，其中包含一些被序列化为 JSON 的域对象。在另一个 java/groovy 项目中，我想使用这些域对象。如果我发布一个插件，看起来只有其他 grails 应用程序可以使用该插件。

我尝试使用域类及其数据创建一个原始的 groovy 项目，在我的 grails 应用程序中，我有这样的存根：

```
class Fact extends com.domain.Fact {} 
```

然而，当我去运行我的应用程序时，我得到了这些

```
Caused by MappingException: Missing type or column for column[facts_fact] on domain[DeclarationDefinition] referencing[com.domain.Fact]
->> 303 | innerRun in java.util.concurrent.FutureTask$Sync 
```

我正在做的事情是可能的，还是有更好的方法？

归根结底，我希望能够将 POGO 重新用作 grails 域对象，或者将 grails 域对象导出为 POGO。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:29:28.477

我相信您必须手动处理所有与休眠相关的工件。我在一个项目中做过类似的事情，我创建了一个域对象的 Java 库，并在 Grails、桌面和 Android 项目之间共享它。它变得乏味，但它奏效了。不过，所有注释都必须手动完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T14:01:19.070

复制数据模型会简单得多。

这种级别的服务相互依赖意味着你做错了服务。

版本化您的服务，并拥有 API。使用 JSON 进行 API 通信，不要尝试任何古怪的方案来共享数据模型。如果您共享一个数据模型，您可能只有一项服务，而不是两项。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-17T22:20:53.497

您可以在 Grails 中设置自己的休眠配置。

因此，您可以将 POGO 重新用作 grails 域对象之类的东西（不确定注入的方法如`findByX`、`addToYs`等）。

请参阅 grails 中有关休眠的官方文档：http: [//grails.org/doc/latest/guide/hibernate.html](http://grails.org/doc/latest/guide/hibernate.html)

# c# - 使用 BlockingCollection 和 Parallel.Invoke 为并行执行优化缓冲样本

> ID：14388836
> 
> 赞同：0
> 
> 时间：2013-01-17T21:56:10.733
> 
> 标签：c#

基于[Optimizing a buffering sample for parallel execution，](https://stackoverflow.com/questions/14386638/optimizing-a-buffering-sample-for-parallel-execution)这个问题出现了。

简而言之：

这段代码抛出了很多无法访问另一个线程的元素的异常。它创建空文件名并跳过每 3 个左右的数字。

目标是在将字节数组并行转换为图像时不要混淆编号（Nummerierung）。有关说明，请参阅链接。

我需要改变什么？

```
Action action = () =>
{
    ArrayAnsammlung.TryTake(out data);
    if (data != null)
    {
        Nummerierung = Convert.ToString(Interlocked.Increment(ref Nummerierungszaehler));
        Enkodierung = null;
        Enkodierung = new JpegBitmapEncoder();
        Enkodierung.FlipHorizontal = true;
        var dateiStrom = new FileStream("E:\\Temp\\" + datum + " " + Nummerierung.PadLeft(12, '0') + ".jpg", FileMode.Create);
        Enkodierung.Frames.Add(BitmapFrame.Create(BitmapSource.Create(bildbreite, bildhoehe * 2,
        96, 96, PixelFormats.Bgr32, null, data, stride)));
        Enkodierung.Save(dateiStrom);
        dateiStrom = null;
        Enkodierung = null;
    }
};

while (aufnahme)
{
    try
    {
        Parallel.Invoke(action, action, action, action, action);
    }
    catch (AggregateException oo)
    {
        Console.WriteLine(oo.ToString());
    }
    Thread.Sleep(2000);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:18:51.953

对 Nummerierung 使用本地字符串，对 Enkodierung 再次使用本地变量，因为这两个变量在您的线程之间共享，如果另一个线程开始执行，一个线程的 Nummerierung 和 Enkodierung 可能会被覆盖。

# scala - ::: 和 ++ 用于连接列表的区别

> ID：14388841
> 
> 赞同：4
> 
> 时间：2013-01-17T21:56:33.903
> 
> 标签：scala

> **可能重复：**
> [Scala 列表连接，::: vs ++](https://stackoverflow.com/questions/6559996/scala-list-concatenation-vs)

在 Scala 中，假设我有两个列表

```
scala> val oneTwo = List(1,2)
oneTwo: List[Int] = List(1, 2) 
```

和

```
scala> val threeFour = List(3,4)
threeFour: List[Int] = List(3, 4) 
```

我可以通过以下方式连接列表：

```
scala> oneTwo ::: threeFour
res30: List[Int] = List(1, 2, 3, 4) 
```

或者

```
scala> oneTwo ++ threeFour
res31: List[Int] = List(1, 2, 3, 4) 
```

两种方法有什么区别？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-17T22:17:40.970

该`:::`方法特定于`List`，`++`而是 any 的一部分`Traversable`。

差异源于两件事。首先，`List`是原始的 Scala 集合之一，在编译器中使用很多，并且经过特殊优化。`::`串联与 ML 系列语言中使用的相同，这是 Scala 的一大灵感，并从中`:::`推断。

另一方面，`++`随着 Scala 2.8.0 对 Scala 集合的重新设计，方法和继承变得统一。我认为它在那之前就存在了（`Set`例如，在 上），但是这些集合没有共享一个共同的超类，所以它基本上是其他集合的一种临时方法。

在性能方面，`:::`应该会超过`++`，但可能不会显着。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-17T22:10:22.220

从文档：

> ::: [B >: A]（前缀：列表[B]）：列表[B]
> 
> ++ [B >: A](that : Iterable[B]) : List[B]

你可以看到`++`任何`Iterable`一段时间的作品`:::`是专门为`List`

```
scala> val oneTwo = List(1,2)
oneTwo: List[Int] = List(1, 2)

scala> val threeFour = List(3,4)
threeFour: List[Int] = List(3, 4)

scala> val fiveSix = Array(5,6)
fiveSix: Array[Int] = Array(5, 6)

scala> oneTwo ++ fiveSix
res2: List[Int] = List(1, 2, 5, 6)

scala> oneTwo ::: fiveSix
<console>:10: error: value ::: is not a member of Array[Int]
              oneTwo ::: fiveSix 
```

# php - 从 HTTP 表单提交执行 PHP 文件时遇到问题

> ID：14388842
> 
> 赞同：0
> 
> 时间：2013-01-17T21:56:37.320
> 
> 标签：php, cgi

类似的问题在这里，但没有回答我的问题：[PHP script not executed on HTML Form 'Submission'](https://stackoverflow.com/questions/10918990/php-script-not-executing-upon-html-form-submission)

我`index.html`在 linux 机器的根 web 文件夹中托管了一个网页 ( )。这是一个简单的一键输入页面：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <body>
    <form action="cgi-bin/foo.php" method="post">
        <input type="Submit" value="TEST">
    </form>
  </body>
</html> 
```

我还有一个简单的 PHP 文件 ( `foo.php`)，它会在运行时创建一个简单的文档。该文件保存在我的 web 根目录的 cgi-bin 文件夹中。

```
<?php
   $my_file = 'foo.xml';
   $handle = fopen($my_file, 'w') or die('Cannot open file:  '.$my_file); 
   $data = '<foo>OK</foo>';
   fwrite($handle, $data);
   fclose($handle);

   echo "foo.xml file created";
?> 
```

现在，网页可以正常运行，我可以从命令提示符运行 PHP 并正常执行。.html 和 .php 文件都被赋予了 CHMOD 777 权限。

但是，尝试使用 web 输入按钮提交运行 .php 会出现此错误：

> 403 Forbidden 请求的 URL '/index.html' 解析为标记为可执行但不是 CGI 文件的文件；取回它是被禁止的。

我一直在谷歌搜索如何将 .php 文件包装到 .cgi 包装器中，但一切看起来都很混乱。当然，我在这里缺少一些简单的东西吗？

任何有关如何解决此错误的建议将不胜感激。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:02:23.210

将 foo.php 页面移动到与 index.html 表单相同的目录中。

将表单的目标更改为 foo.php。

如果您的网络服务器设置正确以解析 PHP，它应该“正常工作”。

现在很少看到 php 作为 cgi 脚本运行。

# android - 如何禁用 Android 库更新？

> ID：14388845
> 
> 赞同：2
> 
> 时间：2013-01-17T21:56:46.193
> 
> 标签：android, eclipse

有没有办法在启动 Eclipse 时禁用自动 Android 库更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T23:08:11.930

> 与启动 Eclipse 时底部进度条中显示的“Android 库更新”消息相关的消息

AFAIK，没有办法禁用它，即使有，您的项目之后也可能无法运行。

但是，您可以减少在此和其他启动任务上花费的时间。只需关闭您不需要打开的项目。您可以将项目留在工作区中，但只需通过右键单击 Package Explorer 中的项目并选择“关闭项目”来关闭它们。

我的 Eclipse 工作区有大约 350 个 Android 项目。过去在早上启动 Eclipse 需要很长时间。我切换到关闭大多数项目，只打开：

*   我正在做的事情
*   所有 Android 库项目（如果我现在或以后正在处理的东西取决于它们）
*   我之前打开的东西，还没来得及关门

我目前有几十个项目开放。现在，Eclipse 启动得相当快。

# php - 如何在其他数组中的数组中打印内容？

> ID：14388848
> 
> 赞同：-2
> 
> 时间：2013-01-17T21:57:00.097
> 
> 标签：php, arrays

我正在尝试在 Drupal 7 安装中打印配置文件节点内某处的值“Viviana”。我想要的是打印输出用户名的字段内容。

我试过这个选项，但我有错误：`print $field_nombrecompleto1['und'][0]['value'];`

```
The error was Notice: Undefined variable: field_nombrecompleto1 in /home/liga/public_html/sites/all/themes/liga/templates/user-profile.tpl.php on line 7 
```

我在使用 print_r() 后发布了输出（有点缩短）。

谢谢你的帮助！

```
Array
(
    [template_file] => sites/all/themes/liga/templates/user-profile.tpl.php
    [variables] => Array
        (
            [elements] => Array
                (
                    [#pre_render] => Array
                        (
                            [0] => _field_extra_fields_pre_render
                            [1] => field_group_build_pre_render
                        )

                    [#entity_type] => user
                    [#bundle] => user
                    [#groups] => Array
                        (
                        )

                    [#fieldgroups] => Array
                        (
                        )

                    [#group_children] => Array
                        (
                        )

                    [#theme] => user_profile
                    [#account] => stdClass Object
                        (
                            [uid] => 78
                            [name] => milne
                            [pass] => U$S$9B.hwxhcWeayArrP8Y/qsNXj9SNMh6z5FaCjAebOq1UrYbQJ/uIR
                            [mail] => example@yahoo.com.ar
                            [theme] => 
                            [signature] => 
                            [signature_format] => 3
                            [created] => 1157654988
                            [access] => 1185380339
                            [login] => 1185380321
                            [status] => 1
                            [timezone] => 
                            [language] => es
                            [picture] => 
                            [init] => example@yahoo.com.ar
                                ...
                                ...
                                ...
                    [#view_mode] => full
                    [#language] => es
                    [#block] => stdClass Object
                        (
                            [module] => system
                            [delta] => main
                            [theme] => liga
                            [status] => 1
                            [weight] => -53
                            [region] => content
                            [custom] => 0
                            [visibility] => 0
                            [pages] => 
                            [title] => 
                            [bid] => 2154
                            [cache] => -1
                            [subject] => 
                        )

                    [#weight] => -53
                    [#theme_wrappers] => Array
                        (
                            [0] => block
                        )   
                        ...
                        ...
                        ...

                    [profile_alumnos] => Array
                        (
                            [#type] => user_profile_category
                            [#title] => Perfil Alumnos
                            [#prefix] => 
                            [view] => Array
                                (
                                    [profile2] => Array
                                        (
                                            [5] => Array
                                                (
                                                    [field_nombrecompleto1] => Array
                                                        (
                                                            [#theme] => field
                                                            [#weight] => 0
                                                            [#title] => nombrecompleto1
                                                            [#access] => 1
                                                            [#label_display] => hidden
                                                            [#view_mode] => account
                                                            [#language] => und
                                                            [#field_name] => field_nombrecompleto1
                                                            [#field_type] => text
                                                            [#field_translatable] => 0
                                                            [#entity_type] => profile2
                                                            [#bundle] => alumnos
                                                            [#object] => Profile Object
                                                                (
                                                                    [pid] => 5
                                                                    [type] => alumnos
                                                                    [label] => Perfil Alumnos
                                                                    [uid] => 78
                                                                    [created] => 1358457398
                                                                    [changed] => 1358457398
                                                                    [entityType:protected] => profile2
                                                                    [entityInfo:protected] => Array
                                                                        (
                                                                            [label] => Profile
                                                                            [plural label] => Profiles
                                                                            [description] => Profile2 user profiles.
                                                                            [entity class] => Profile
                                                                            [controller class] => EntityAPIController
                                                                            [base table] => profile
                                                                            [fieldable] => 1
                                                                            ...
                                                                            ...
                                                                            ...

                                                                    [field_nombrecompleto1] => Array
                                                                        (
                                                                            [und] => Array
                                                                                (
                                                                                    [0] => Array
                                                                                        (
                                                                                            [value] => Viviana
                                                                                            [format] => 
                                                                                            [safe_value] => Viviana
                                                                                        )

                                                                                )

                                                                        )

                                                                    [field_cursobasico1] => Array
                                                                        (
                                                                        )

                                                                    [field_telefonos1] => Array
                                                                        (
                                                                        )

                                                                    [field_zona1] => Array
                                                                        (
                                                                        )

                                                                    [entity_view_prepared] => 1
                                                                )

                                                            [#items] => Array
                                                                (
                                                                    [0] => Array
                                                                        (
                                                                            [value] => Viviana
                                                                            [format] => 
                                                                            [safe_value] => Viviana
                                                                        )

                                                                )
                                                                ...
                                                                ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:01:16.327

查看您的输出，您应该尝试：

```
print $your_var['variables']['elements']['profile_alumnos']['view']['profile2'][5]['field_nombrecompleto1']['#object']->field_nombrecompleto1['und'][0]['value']; 
```

您`$your_var`用于`print_r`.

# c++ - 如何创建一个 C++ 模板类，根据模板值的类更改其成员和访问器？

> ID：14388854
> 
> 赞同：1
> 
> 时间：2013-01-17T21:57:20.390
> 
> 标签：c++, templates

我有一个将被实例化数百万次的类。这是一个 C++ 模板。该类跟踪每个值的计数，并且这些值是类型的`T`（`T`模板参数在哪里）。

我有一个特殊情况，其中计数*是*被跟踪的值。在这种情况下，我想省去模板化的实例变量，而只需要计数。

例如，这是一个程序：

```
#include <stdio.h>
#include <iostream>
#include <stdint.h>

template <typename T>
class A {
private:
    T var_;
    uint64_t count_;
public:
    A(T v):var_(v),count(0){ }
    uint64_t count() const { return count_;}
    T var() const { return var_;}
    void inc_count();
};

template <typename T> void A<T>::inc_count() {
    count_++;
};

template <typename T> std::ostream & operator <<(std::ostream &os, const A<T> &e) {
    os << e.count() << "=" << e.var();
    return os;
};

int main(int argc,char **argv)
{
    A<int> a(3);

    a.inc_count();
    std::cout << a << "\n";

    a.inc_count();
    std::cout << a << "\n";
} 
```

我希望能够实例化为：

```
A<uint64_t> deg(1); 
```

在这种情况下，我希望将`count_`变量设置为`1`并让方法`var()`return `count()`。

有没有办法做到这一点？

（这是一个人为的例子，但它是我遇到的问题的本质。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-17T22:01:41.440

只需使用显式专业化：

```
template<> class A<uint64_t> { /* whatever you like goes here */ }; 
```

# c++ - 二进制比较的结果归结为什么数据类型？

> ID：14388855
> 
> 赞同：0
> 
> 时间：2013-01-17T21:57:22.080
> 
> 标签：c++, types, comparison

考虑到没有`BOOL`数据类型之类的东西，请采取以下措施：

`std::cout << (1>2); //<<-- prints 0`

假设这个错误比较是 0，那么比较结果会减少到什么数据类型 deos？进行快速谷歌搜索不会产生任何结果。我最好的猜测是它是一个，`unsigned char`因为它是最小的最基本数据类型，其中 0 真正表示为`0x00`. 我不想假设任何事情，因为我不确定 voodoo`std::cout`对值做了什么以使其成为可打印字符。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-17T21:59:08.147

所有关系运算符 ( `<`, `>`, `<=`, `>=`) 的结果类型为`bool`：

> 运算符`<`（小于）、`>`（大于）、`<=`（小于或等于）和`>=`（大于或等于）都产生`false`或`true`。结果的类型是`bool`。

类型的对象`bool`具有值`true`or 。`false`在整体提升下， a`bool`可以转换为`int`where`false`成为`0`和`true`成为`1`：

> 类型的纯右值`bool`可以转换为类型的纯右值`int`，`false`变为零和`true`变一。

`bool`是一个整数类型，标准说它是通过使用“纯二进制计数系统”来表示的。描述此表示的脚注还不清楚它如何映射到值`true`和`false`，但您可以假设它们暗示 的值表示`0`将是所有`0`位：

> 整数的位置表示，它使用二进制数字 0 和 1，其中由连续位表示的值是相加的，从 1 开始，并乘以 2 的连续整数幂，可能最高位置的位除外。（改编自美国国家信息处理系统词典。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-17T21:58:58.460

没有标准`BOOL`类型，而是`bool`标准的基本类型：

> `[C++11: 3.9.1/6]:`type`bool`的值为`true`或`false`。*[..]*

至于你的关系比较的结果：

> `[C++11: 5.9/1]:`关系运算符从左到右分组。*[..]*操作数应具有算术、枚举或指针类型，或 type `std::nullptr_t`。运算符`<`（小于）、`>`（大于）、`<=`（小于或等于）和`>=`（大于或等于）都产生`false`或`true`。**结果的类型是`bool`。**

请注意，这在 C 中是不同的，其中没有内置类型`bool`，并且关系比较的结果是类型`int`：

> `[C99: 6.5/8]:`如果指定的关系为真且为假，则每个运算符`<`（小于）、`>`（大于）、`<=`（小于或等于）和`>=`（大于或等于）都应产生。**结果有类型****。**`1``0`**`int`**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T21:59:37.520

C++ 标准，第 5.9 节**关系运算符**，第 1 段说：

> 结果的类型是`bool`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T22:51:55.417

这不是您问题的直接答案：

正如这里所说，它是 c++ 中的 bool 和 c 中的 int 但你我认为你会想到的部分是**保存比较结果需要多少内存？**

*   如您所知，数据类型定义了要分配的内存量。

*   注意：有时它（数据类型到内存大小定义）与编译器/处理器架构**不同**，例如在嵌入式系统环境中，人们过去常常使用位数来谈论和定义项目中的数据类型，例如`typedef unsigned char uint8;`，而不是直接使用标准数据类型所以很容易移植到另一个编译器/目标处理器

*   你应该看看这个：[为什么在 c++ 中 char 和 bool 的大小相同？](https://stackoverflow.com/questions/266870/why-is-a-char-and-a-bool-the-same-size-in-c)

*   您还应该查看[http://www.cplusplus.com/doc/tutorial/variables](http://www.cplusplus.com/doc/tutorial/variables)在“基本数据类型”部分下的每种数据类型及其大小和范围的表格，但他指出：

> Size 和 Range 列的值取决于编译程序的系统。上面显示的值是大多数 32 位系统上的值。但是对于其他系统，一般规范是 int 具有系统架构（一个“单词”）建议的自然大小，并且四种整数类型 char、short、int 和 long 必须至少与前面的一样大它，char 总是一个字节的大小。这同样适用于浮点类型 float、double 和 long double，其中每一个都必须提供至少与前一个一样多的精度。

*   正如 sftrabbit 在他的回答中提到的标准，该标准足够抽象且不详细，因此我认为内存中 bool 的大小是特定于实现的，可能与 c++ 编译器不同，请在此处查看 Nawazs 的回答：[如何布尔类型变量存储在内存中？(C++)](https://stackoverflow.com/questions/7967924/how-a-bool-type-variable-is-stored-in-memory-c)

# fabric - 当我使用 -P 命令行选项时，为什么 Fabric 不并行运行我的部署？

> ID：14388858
> 
> 赞同：0
> 
> 时间：2013-01-17T21:57:33.887
> 
> 标签：fabric

我在 virtualenv 之外的 Debian 上运行 Fabric 以将项目部署到多个远程 Debian 服务器。当我运行命令部署到单个服务器时：

```
time .venv/bin/fabric server1 deploy 
```

该`server1`命令设置远程主机。部署，从存储库中提取代码并在远程服务器上为项目构建一个 virtualenv，大约需要 7 分钟：

```
real    7m49.881s
user    0m52.883s
sys     0m18.345s 
```

我配置了对 3 个服务器的无密码 SSH 访问，现在使用以下`-P`命令运行 fabric：

```
.venv/bin/fabric parallel deploy 
```

该`parallel`命令将 3 个服务器分配给 env.hosts。部署时间是原来的 3 倍：

```
real   22m22.259s
user    2m45.718s
sys     0m53.827s 
```

`-P`在阅读有关[并行执行](http://docs.fabfile.org/en/1.4.1/usage/parallel.html)的 Fabric 文档后，我使用了该选项。

# graph - 使用 SPARQL 查询查找最短路径

> ID：14388864
> 
> 赞同：7
> 
> 时间：2013-01-17T21:57:45.877
> 
> 标签：graph, sparql, graph-algorithm, shortest-path

我试图了解 SPARQL 查询的计算限制，并且我想知道如何编写一个查询来确定两个对象之间是否存在定向路径。

我知道一种方法可以为特定长度的路径做到这一点：

```
SELECT ?a ?b ?c ?d
WHERE { ?a  <http://graphtheory/hasNeighbor>  ?b . 
        ?b  <http://graphtheory/hasNeighbor>  ?c .
        ?c  <http://graphtheory/hasNeighbor>  ?d .
        FILTER (?a != ?c && ?b != ?d
                && ?a = <http://graphtheory/node/1>
                && ?d = <http://graphtheory/node/2>)
      }
LIMIT 10 
```

有没有办法在单个查询中搜索任何长度的路径？这对 SPARQL 来说是不可能的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T12:48:08.413

AndyS 提供了所有元素来回答这个问题，但有一些拼写错误可能会使它们难以应用。正如他所说：

> SPARQL 1.1 具有包含任意数量的 * 运算符的属性路径。
> 
> 它不会告诉你路径是什么，也不会告诉你最短路径的长度——只告诉你是否存在这样的路径。

这样做的方法（基于 AndyS，但有两个小修复）是：

```
PREFIX : <http://graphtheory/>
PREFIX node: <http://graphtheory/node/>

ASK { node:1 :hasNeighbor* node:2 } 
```

据我所知，如果不使用属性路径，就无法做到这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-18T09:01:25.947

SPARQL 1.1 具有包含“任意数量”运算符的[属性路径。](http://www.w3.org/TR/sparql11-query/#propertypaths)`*`

它不会告诉你路径是什么，也不会告诉你最短路径的长度——只告诉你是否存在这样的路径。

```
PREFIX : <http://graphtheory/node/>
PREFIX node: <http://graphtheory/node/>

ASK { node:1 :hasNeighbor* node:2 } 
```

（您不需要`?a =`and `?d =`，您可以将值写入查询。）

在语言中添加`path`数据类型是未来工作的一个地方——一些实验系统已经研究了这个问题。

# cakephp - 模型中定义的验证 - CakePHP

> ID：14388870
> 
> 赞同：0
> 
> 时间：2013-01-17T21:58:05.760
> 
> 标签：cakephp, cakephp-1.3, cakephp-model

使用 CakePHP 1.3，我开发了带有帖子和评论表的博客引擎，最近我注意到在数据库中，尽管 Comment 模型已经定义了正确的验证，但我在内容列中有空值的记录：

```
 <?php
    class Comment extends AppModel {
        var $name = 'Comment';
        var $sequence = 'comments_seq';

        var $belongsTo = array(
            'Post' => array(
                'className'  => 'Post',
                'foreignKey' => 'post_id'
            )
        );

        var $validate = array(
            'content' => array(
                'required' => array (
                        'rule' => 'notEmpty',
                        'message' => 'Content can't be empty.'
                )
            ),
            'post_id' => array(
                'rule' => 'notEmpty'
            ),
            'created' => array(
                'rule' => 'notEmpty'
            )
        );
    ?> 
```

CakePHP 框架中是否存在错误或上面定义的验证不正确或不充分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:04:54.390

在您的验证规则中，您实际上并不需要该字段。要求意味着在验证时密钥必须存在。该`notEmpty`规则只要求密钥*不为空*，但不要求它*存在*。

要要求该字段存在，请在验证规则中使用 required 选项：

```
var $validate = array(
  'content' => array(
    'required' => array ( // here, 'required' is the name of the validation rule
      'rule' => 'notEmpty',
      'message' => 'Content can\'t be empty.',
      'required' => true // here, we say that the field 'content' must 
                         // exist when validating
    )
  ),
  'post_id' => array(
     'rule' => 'notEmpty'
   ),
   'created' => array(
     'rule' => 'notEmpty'
   )
); 
```

如果没有所需的密钥，您可能会通过在保存时不包括“内容”密钥来保存完全空的记录。现在它是必需的，如果“内容”不在您保存的数据中，验证将失败。

# ios - NSString 检测数字然后括号

> ID：14388876
> 
> 赞同：1
> 
> 时间：2013-01-17T21:58:28.740
> 
> 标签：ios, ipad, nsstring, formatting, calculator

我正在制作一个 iOS 计算器应用程序。我希望能够在字符串中找到彼此相邻的数字字符和括号的出现，例如以下示例：

*   **23(8+9)**
*   **(89+2)(78)**
*   **(7+8)9**

我希望能够在这些事件之间插入一个字符：

*   *23(8+9) 将是* **23*(8+9)**
*   *(89+2)(78) 将是* **(89+2)*(78)**
*   *(7+8)9 将是* **(7+8)*9**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:53:00.650

这是我编写的一个快速函数，它使用正则表达式来查找匹配的模式，然后在需要的地方插入一个“*”。例如，它匹配两个括号“）（”或一个数字和括号“5（”或“）3”。如果中间有空格，例如“）5”，它也可以工作。

随意调整功能以满足您的需求。不确定这是否是最好的方法，但它确实有效。

有关正则表达式的更多信息，请参阅[NSRegularExpression 的文档](http://developer.apple.com/library/iOS/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)

```
- (NSString *)stringByInsertingMultiplicationSymbolInString:(NSString *)equation {
    // Create a mutable copy so we can manipulate it
    NSMutableString *mutableEquation = [equation mutableCopy];

    // The regexp pattern matches:
    // ")(" or "n(" or ")n"  (where n is a number).
    // It also matches if there's whitepace in between (eg. (4+5)  (2+3) will work)
    NSString *pattern = @"(\\)\\s*?\\()|(\\d\\s*?\\()|(\\)\\s*?\\d)";

    NSError *error;
    NSRegularExpression *regexp = [NSRegularExpression regularExpressionWithPattern:pattern options:NSRegularExpressionCaseInsensitive error:&error];
    NSArray *matches = [regexp matchesInString:equation options:NSMatchingReportProgress range:NSMakeRange(0, [equation length])];

    // Keep a counter so that we can offset the index as we go
    NSUInteger count = 0;
    for (NSTextCheckingResult *match in matches) {
        [mutableEquation insertString:@"*" atIndex:match.range.location+1+count];
        count++;
    }

    return mutableEquation;
} 
```

这就是我测试它的方式：

```
NSString *result;

result = [self stringByInsertingMultiplicationSymbolInString:@"23(8+9)"];
NSLog(@"Result: %@", result);

result = [self stringByInsertingMultiplicationSymbolInString:@"(89+2)(78)"];
NSLog(@"Result: %@", result);

result = [self stringByInsertingMultiplicationSymbolInString:@"(7+8)9"];
NSLog(@"Result: %@", result); 
```

这将输出：

```
Result: 23*(8+9)
Result: (89+2)*(78)
Result: (7+8)*9 
```

注意：此代码使用 ARC，因此如果您使用 MRC，请记住自动释放复制的字符串。

# c# - 基于组合框选择 xaml 从窗口中删除元素

> ID：14388883
> 
> 赞同：0
> 
> 时间：2013-01-17T21:58:48.683
> 
> 标签：c#, wpf, xaml

我有以下情况：在 xaml 中，我从数据库中获取值并填充组合框..如果组合框中的选定项目具有值“x”我想从工作窗口中隐藏一些元素..thx 为您提供提示

```
<TextBlock Text="XYZ:"/>
<ComboBox ItemsSource="{Binding DataContext.KeyLists.XYZ, 
                                RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}" 
          SelectedValuePath="XYZId"  
          SelectedValue="{Binding XYZId, Mode=TwoWay}" 
          DisplayMemberPath="Name" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:05:00.260

有很多方法可以解决这个问题。

*   您可以使 IValueConverter 将选择值转换为可见性，适用于具有不同转换器参数的每个控件
*   您可以使用 convtols 的触发器编写样式
*   你可以（不推荐）在代码中处理这个

# grails - Grails：如何限制一对多关系中的孩子数量

> ID：14388884
> 
> 赞同：0
> 
> 时间：2013-01-17T21:58:52.303
> 
> 标签：grails, one-to-many, grails-domain-class, grails-constraints

我想限制我的 Grails 域类之间的一对多关系中允许的子级数量，最好使用约束。`maxSize`约束似乎为此目的而存在（Grails[文档](http://grails.org/doc/latest/api/org/codehaus/groovy/grails/validation/MaxSizeConstraint.html)确认它应该适用于集合以及字符串和数组）。

我的约束定义如下：

```
static constraints = {
    children(maxSize: 2)
} 
```

但是，在测试过程中，我发现 Grails 允许我向父级添加任意数量的子级，完全无视这个限制。我是否误解了有关使用此约束的文档？如果是这样，是否有另一种方法来实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:51:21.293

使用“大小”约束：

```
children(size: 0..2) 
```

# gpuimage - GPU Image - 组合来自两组不同案例的两个 GPUImageFilterGroups

> ID：14388885
> 
> 赞同：2
> 
> 时间：2013-01-17T21:58:56.860
> 
> 标签：gpuimage

我正在使用 Brad Larson 的 GPUImage 并基于 GoBackSpaces 的 DLCImagePickerController 为 iPhone 构建一个照片应用程序（到目前为止它帮助我学习了很多东西），但我坚持使用我希望应用程序具有的功能之一. 我有两组案例：

案例A：一组代表“胶卷”的盒子（Filter Cases） 案例B：一组代表“相机镜头”的盒子（Len Cases）

在每种情况下，我都有 GPUImageFilterGroups。我希望用户能够从案例 A 中选择一个过滤器，然后能够在同一个静态图片上应用案例 B 中的另一个过滤器。所以，简而言之，在用户从案例 A 中选择一个过滤器后，静态图片会根据选择的过滤器发生变化，然后我想在修改后的静态图片上应用案例 B 中的另一个过滤器。我尝试了几种不同的方法，但我没有运气。从案例 B 中选择过滤器后，StaticPicture 消失。我需要保留一些东西吗？任何帮助将不胜感激。这是我的代码：

```
filter = [[GPUImageRGBFilter alloc] init];
lens = [[GPUImageRGBFilter alloc] init];

-(void) filterClicked:(UIButton *) sender {
for(UIView *view in self.filterScrollView.subviews){
    if([view isKindOfClass:[UIButton class]]){
        [(UIButton *)view setSelected:NO];
    }
}

[sender setSelected:YES];
[self removeAllTargets];

selectedFilter = sender.tag;
[self setFilter:sender.tag];
[self prepareFilter];
}

-(void) lensClicked:(UIButton *) sender {
for(UIView *view in self.lensScrollView.subviews){
    if([view isKindOfClass:[UIButton class]]){
        [(UIButton *)view setSelected:NO];
    }
}
[sender setSelected:YES];
selectedLens = sender.tag;
[self setLens:sender.tag];
[self prepareLens];
}

-(void) setFilter:(int) index {
switch (index) {

case 1:{

filter = [[GPUImageFilterGroup alloc] init];

UIImage *inputImage23 = [UIImage imageNamed:@"vignette.png"];
sourcePicture5 = [[GPUImagePicture alloc] initWithImage:inputImage23 smoothlyScaleOutput:YES];
GPUImageOverlayBlendFilter * overlay23 = [[GPUImageOverlayBlendFilter alloc] init];
[(GPUImageFilterGroup *)filter addFilter:overlay23];
[sourcePicture5 addTarget:overlay23 atTextureLocation:1];

[sourcePicture5 processImage];

UIImage *inputImage21 = [UIImage imageNamed:@"frame.png"];
sourcePicture6 = [[GPUImagePicture alloc] initWithImage:inputImage21 smoothlyScaleOutput:YES];
GPUImageNormalBlendFilter * overlay21 = [[GPUImageNormalBlendFilter alloc] init];
[(GPUImageFilterGroup *)filter addFilter:overlay21];
[sourcePicture6 addTarget:overlay21 atTextureLocation:1];

[sourcePicture6 processImage];

GPUilforddelta100 *ilford = [[GPUilforddelta100 alloc] init];
[(GPUImageFilterGroup *)filter addFilter:ilford];

[overlay23 addTarget:overlay21];
[overlay21 addTarget:ilford];

[(GPUImageFilterGroup *)filter setInitialFilters:[NSArray arrayWithObject:overlay23]];
[(GPUImageFilterGroup *)filter setTerminalFilter:ilford];
} break;

case 2: {
filter = [[GPUImageFilterGroup alloc] init];

UIImage *inputImage1 = [UIImage imageNamed:@"trixgrain.png"];
        sourcePicture = [[GPUImagePicture alloc] initWithImage:inputImage1 smoothlyScaleOutput:YES];
GPUImageMultiplyBlendFilter * overlay1 = [[GPUImageMultiplyBlendFilter alloc] init];
[(GPUImageFilterGroup *)filter addFilter:overlay1];
[sourcePicture addTarget:overlay1 atTextureLocation:1];

[sourcePicture processImage];

UIImage *inputImage2 = [UIImage imageNamed:@"trixfeel.png"];
sourcePicture3 = [[GPUImagePicture alloc] initWithImage:inputImage2 smoothlyScaleOutput:YES];
GPUImageOverlayBlendFilter * overlay2 = [[GPUImageOverlayBlendFilter alloc] init];
[(GPUImageFilterGroup *)filter addFilter:overlay2];
[sourcePicture3 addTarget:overlay2 atTextureLocation:1];

[sourcePicture3 processImage];

UIImage *inputImage18 = [UIImage imageNamed:@"frame.png"];
sourcePicture2 = [[GPUImagePicture alloc] initWithImage:inputImage18 smoothlyScaleOutput:YES];
GPUImageNormalBlendFilter * overlay18 = [[GPUImageNormalBlendFilter alloc] init];
[(GPUImageFilterGroup *)filter addFilter:overlay18];
[sourcePicture2 addTarget:overlay18 atTextureLocation:1];

[sourcePicture2 processImage];

GPUTrix400 *trix400 = [[GPUTrix400 alloc] init];
[(GPUImageFilterGroup *)filter addFilter:trix400];

[overlay2 addTarget:overlay1];
[overlay1 addTarget:overlay18];
[overlay18 addTarget:trix400];

[(GPUImageFilterGroup *)filter setInitialFilters:[NSArray arrayWithObject:overlay2]];
[(GPUImageFilterGroup *)filter setTerminalFilter:trix400];
} break;

default:
filter = [[GPUImageRGBFilter alloc] init];
break;
}
}

-(void) setLens:(int) index {
switch (index) {

case 1:{

lens = [[GPUImageFilterGroup alloc] init];

UIImage *inputImage1 = [UIImage imageNamed:@"lightleak.png"];
sourcePicture = [[GPUImagePicture alloc] initWithImage:inputImage1 smoothlyScaleOutput:YES];
GPUImageOverlayBlendFilter * overlay1 = [[GPUImageOverlayBlendFilter alloc] init];
[(GPUImageFilterGroup *)lens addFilter:overlay1];
[sourcePicture addTarget:overlay1 atTextureLocation:1];

[sourcePicture processImage];

UIImage *inputImage18 = [UIImage imageNamed:@"holgaframe.png"];
sourcePicture2 = [[GPUImagePicture alloc] initWithImage:inputImage18 smoothlyScaleOutput:YES];
GPUImageNormalBlendFilter * overlay18 = [[GPUImageNormalBlendFilter alloc] init];
[(GPUImageFilterGroup *)lens addFilter:overlay18];
[sourcePicture2 addTarget:overlay18 atTextureLocation:1];

[sourcePicture2 processImage];

GPUholgaroid *holgaroid = [[GPUholgaroid alloc] init];
[(GPUImageFilterGroup *)lens addFilter:holgaroid];

[holgaroid addTarget:overlay1];
[overlay1 addTarget:overlay18];

[(GPUImageFilterGroup *)lens setInitialFilters:[NSArray arrayWithObject:holgaroid]];
[(GPUImageFilterGroup *)lens setTerminalFilter:overlay18];

} break;

case 2:{

lens = [[GPUImageFilterGroup alloc] init];

UIImage *inputImage1 = [UIImage imageNamed:@"dianafeel.png"];
sourcePicture = [[GPUImagePicture alloc] initWithImage:inputImage1 smoothlyScaleOutput:YES];
GPUImageOverlayBlendFilter * overlay1 = [[GPUImageOverlayBlendFilter alloc] init];
[(GPUImageFilterGroup *)lens addFilter:overlay1];
[sourcePicture addTarget:overlay1 atTextureLocation:1];

[sourcePicture processImage];

UIImage *inputImage18 = [UIImage imageNamed:@"dianaframe.png"];
sourcePicture2 = [[GPUImagePicture alloc] initWithImage:inputImage18 smoothlyScaleOutput:YES];
GPUImageNormalBlendFilter * overlay18 = [[GPUImageNormalBlendFilter alloc] init];
[(GPUImageFilterGroup *)lens addFilter:overlay18];
[sourcePicture2 addTarget:overlay18 atTextureLocation:1];

[sourcePicture2 processImage];

GPUdianaf *dianaf = [[GPUdianaf alloc] init];
[(GPUImageFilterGroup *)lens addFilter:dianaf];

[dianaf addTarget:overlay1];
[overlay1 addTarget:overlay18];

[(GPUImageFilterGroup *)lens setInitialFilters:[NSArray arrayWithObject:dianaf]];
[(GPUImageFilterGroup *)lens setTerminalFilter:overlay18];

} break;

    default:
        lens = [[GPUImageRGBFilter alloc] init];
        break;
}
}

-(void) prepareFilter {
if (![UIImagePickerController isSourceTypeAvailable: UIImagePickerControllerSourceTypeCamera]) {
    isStatic = YES;
}

if (!isStatic) {
    [self prepareLiveFilter];
} else {
    [self prepareStaticFilter];
}
}

-(void) prepareLiveFilter {

[filter removeAllTargets];
[cropFilter removeAllTargets];
[blurFilter removeAllTargets];

[stillCamera addTarget:cropFilter];
[cropFilter addTarget:filter];
if (hasBlur) {
    [filter addTarget:blurFilter];
    [blurFilter addTarget:self.imageView];
} else {
    [filter addTarget:self.imageView];
}

//GPUImage issue with new code, do not use until further improvement
//[filter prepareForImageCapture];

}

-(void) prepareStaticFilter {

if (!staticPicture) {
[self performSelector:@selector(switchToLibrary:) withObject:nil afterDelay:3.5];
}

[stillCamera removeAllTargets];
[staticPicture removeAllTargets];
[staticPicture addTarget:filter];
if (hasBlur) {
[filter addTarget:blurFilter];
[blurFilter addTarget:self.imageView];
} else {
    [filter addTarget:self.imageView];
}

GPUImageRotationMode imageViewRotationMode = kGPUImageNoRotation;
switch (staticPictureOriginalOrientation) {
case UIImageOrientationLeft:
imageViewRotationMode = kGPUImageRotateLeft;
break;
case UIImageOrientationRight:
imageViewRotationMode = kGPUImageRotateRight;
break;
case UIImageOrientationDown:
imageViewRotationMode = kGPUImageRotate180;
break;
default:
imageViewRotationMode = kGPUImageNoRotation;
break;
}

[self.imageView setInputRotation:imageViewRotationMode atIndex:0];

[staticPicture processImage];
}

-(void) prepareLens {
if (![UIImagePickerController isSourceTypeAvailable: UIImagePickerControllerSourceTypeCamera]) {
    isStatic = YES;
}

if (!isStatic) {
    [self prepareLiveLens];
} else {
    [self prepareStaticLens];
}
}

-(void) prepareLiveLens {

[stillCamera addTarget:lens];
[lens addTarget:self.imageView];

//GPUImage issue with new code, do not use until further improvement
//[lens prepareForImageCapture];

}

-(void) prepareStaticLens {

if (!staticPicture) {
[self performSelector:@selector(switchToLibrary:) withObject:nil afterDelay:3.5];
}

[staticPicture addTarget:lens];
[lens addTarget:self.imageView];

GPUImageRotationMode imageViewRotationMode = kGPUImageNoRotation;
switch (staticPictureOriginalOrientation) {
case UIImageOrientationLeft:
imageViewRotationMode = kGPUImageRotateLeft;
break;
case UIImageOrientationRight:
imageViewRotationMode = kGPUImageRotateRight;
break;
case UIImageOrientationDown:
imageViewRotationMode = kGPUImageRotate180;
break;
default:
imageViewRotationMode = kGPUImageNoRotation;
break;
}

[self.imageView setInputRotation:imageViewRotationMode atIndex:0];

[staticPicture processImage];
}

-(void) removeAllTargets {
[filter removeAllTargets];
[lens removeAllTargets];
[sourcePicture removeAllTargets];
[sourcePicture2 removeAllTargets];
[sourcePicture3 removeAllTargets];
[stillCamera removeAllTargets];
[staticPicture removeAllTargets];
[cropFilter removeAllTargets];
[blurFilter removeAllTargets];
}

-(void) prepareForCapture {
[stillCamera.inputCamera lockForConfiguration:nil];
if(self.flashToggleButton.selected &&
[stillCamera.inputCamera hasTorch]){
[stillCamera.inputCamera setTorchMode:AVCaptureTorchModeOn];
[self performSelector:@selector(captureImage)
               withObject:nil
               afterDelay:0.50];
}else{
    [self captureImage];
}
}

-(void)captureImage {
[lens forceProcessingAtSize:CGSizeMake (1936, 1936)];
[staticPicture addTarget:lens];
[stillCamera capturePhotoAsImageProcessedUpToFilter:lens
                              withCompletionHandler:^(UIImage *processed, NSError *error) {
                                  isStatic = YES;
                                  runOnMainQueueWithoutDeadlocking(^{
                                      @autoreleasepool {
                                          [stillCamera.inputCamera unlockForConfiguration];
                                          [stillCamera stopCameraCapture];
                                          [self removeAllTargets];
                                          staticPicture = [[GPUImagePicture alloc] initWithImage:processed smoothlyScaleOutput:NO];
                                          staticPictureOriginalOrientation = processed.imageOrientation;

                                          [self prepareFilter];
                                          [self.retakeButton setHidden:NO];
                                          [self.photoCaptureButton setTitle:@"Done" forState:UIControlStateNormal];
                                          [self.photoCaptureButton setImage:nil forState:UIControlStateNormal];
                                          [self.photoCaptureButton setEnabled:YES];
                                          if(![self.filtersToggleButton isSelected]){
                                              [self showFilters];
                                          }
                                      }
                                  });
                              }];
}

-(IBAction) takePhoto:(id)sender{
[self.photoCaptureButton setEnabled:NO];

if (!isStatic) {
    isStatic = YES;

    [self.libraryToggleButton setHidden:YES];
    [self.cameraToggleButton setEnabled:NO];
    [self.flashToggleButton setEnabled:NO];
    [self prepareForCapture];

} else {

    GPUImageOutput<GPUImageInput> *processUpTo;

    if (hasBlur) {
        processUpTo = blurFilter;
    } else {
        processUpTo = lens;
    }

    [staticPicture processImage];

    UIImage *currentFilteredVideoFrame = [processUpTo imageFromCurrentlyProcessedOutputWithOrientation:staticPictureOriginalOrientation];

    NSDictionary *info = [[NSDictionary alloc] initWithObjectsAndKeys:
                          UIImageJPEGRepresentation(currentFilteredVideoFrame, self.outputJPEGQuality), @"data", nil];
    [self.delegate imagePickerController:self didFinishPickingMediaWithInfo:info];
}
}

-(void) dealloc {
[self removeAllTargets];
stillCamera = nil;
cropFilter = nil;
filter = nil;
blurFilter = nil;
sourcePicture = nil;
sourcePicture2 = nil;
sourcePicture3 = nil;
staticPicture = nil;
self.blurOverlayView = nil;
self.focusView = nil;
} 
```

提前感谢菜鸟对这个问题的任何解释或帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-20T13:10:22.323

您可以使用以下链接：

[https://github.com/BradLarson/GPUImage/issues/112](https://github.com/BradLarson/GPUImage/issues/112)

谢谢

# c# - 访问公共 Dropbox 文件夹中的所有 Dropbox 图像

> ID：14388897
> 
> 赞同：2
> 
> 时间：2013-01-17T21:59:39.960
> 
> 标签：c#, asp.net, image, api, dropbox

我想在我的网站中嵌入一个从公共保管箱文件夹中提取的照片库。我可以通过引用其公共 url 来访问单个图像，如下所示：

```
//html of image on my page
<asp:Image ID="Image2" runat="server" />
//code behind setting image url
Image2.ImageUrl = "https://www.dropbox.com/sh/upfkqg2xlm6jjwc/-inOrlDJH0/star%20wars.jpg?m"; 
```

这对单个图像非常有用，但我想将所有图像放在公共文件夹中。我在这里有一个公用文件夹，其中加载了两个示例图像，但我无法使用 api 或其他方法来获取所有包含的文件：[https](https://www.dropbox.com/sh/upfkqg2xlm6jjwc/bRiI4_tThF) ://www.dropbox.com/sh/upfkqg2xlm6jjwc/bRiI4_tThF 我正在寻找一些将所有包含的文件加载到某种列表中的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:43:21.483

您将希望利用 Pete 在您的应用程序中声明的内容；或者您必须在应用程序中输入一个链接，然后通过[JSON](https://www.dropbox.com/developers/reference/api#files-GET)提取元数据。他们有一些其他语言的不同 API 示例；除了我无法测试，因为我不使用 DropBox。这是博客中的一个示例，它解决了其中一些问题，希望对您有所[帮助](http://cgeers.com/2012/01/08/dropbox-rest-api-part-2-api-requests/)。

# windows - SVN，无法使用 Tortoise 为驻留在 Ubuntu 12.04 机器上的工作副本提交更改

> ID：14388899
> 
> 赞同：3
> 
> 时间：2013-01-17T21:59:43.113
> 
> 标签：windows, svn, ubuntu, tortoisesvn

我最近设置了一台 Ubuntu 12.04 LTS 机器，我正在为我的项目使用本地媒体服务器和 Web 服务器。

我的网站是从 Ubuntu 上的 ~/public_html 运行的。然后将该文件夹映射到我的 Windows 8 机器。以前我使用的是 XAMPP，所以我将 htdocs/ 文件夹的内容复制到 ~/public_html，这包括所有 svn 文件夹。

所有站点运行正常，可通过 192.168.1.10/SITE_NAME 访问

使用 NetBeans 7.2，可以直接从 Windows 机器编辑文件。使用 Tortoise SVN 提交更改时，会报告以下错误：

错误：提交失败（详情如下）：

错误：无法在“V:\SITE_NAME.svn\tmp”中命名

这是在从 Windows 机器在站点的根目录中创建一个新的文本文档之后。

任何帮助将不胜感激，因为我无法弄清楚这一点，因为我对该文件夹拥有完全权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:56:06.473

1.  永远不要在非本地驱动器上使用 TortoiseSVN 工作副本
2.  检查 WC 中文件和文件夹的所有者和权限
3.  更改工作流程并使用提交后挂钩（服务器端或 TSVN 端）将代码部署到站点

[补充阅读](http://blog.grovehillsoftware.com/2009/09/subversion-odd-problems-and-funny.html)

# ios - 锚在上面 不能在 iPad 上工作

> ID：14388900
> 
> 赞同：1
> 
> 时间：2013-01-17T21:59:47.683
> 
> 标签：ios, html, ipad

所以我有一个视频，上面有一个锚。该按钮在我的 PC 上运行良好，但是当我在 iPad 上查看它时，我无法单击锚点。

我已经使用以下[jsbin 示例](http://jsbin.com/elufav/2)复制了它。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T15:10:36.873

我有一个解决方案。它对我有用，因为我不需要视频上的控件来工作，但可能不适用于*所有人*。

这最适合必须解锁视频或需要登录才能观看视频的情况。

切入正题，只需在视频中添加以下 CSS 属性：

`video { pointer-events: none; }`

我将把它标记为我的问题的答案，**但如果有人可以给我一个修复视频控件仍然有效的问题，我会接受你的作为正确答案。**

**更新和替代解决方案**

好的，所以我发现*满足我需求*的最佳解决方案是从视频中删除控件。

只需更改`<video controls`为即可`<video`。

# wso2 - WS02 ESB 未能加载数据元素定义

> ID：14388903
> 
> 赞同：2
> 
> 时间：2013-01-17T22:00:01.430
> 
> 标签：wso2, wso2esb

```
I have validation sequence that will validate incoming XML message using defined XSD. I have 
```

使用本地注册表指定主 XSD 文件 (TP.xsd) 的文件位置。TP.xsd 定义是

导入位于同一物理位置的另一个 XSD (CORE.xsd)。所以当我尝试测试

代码，第一条消息验证失败，因为未找到数据元素定义

即使定义存在，也位于 CORE.xsd 中。但是在随后的传入消息中，消息

针对没有“未找到数据元素定义”错误的架构进行验证。可以有人

提供我如何在 ws02 esb 中加载 XSD？这是被缓存了吗？

```
This is the error thrown in ws02 server logs:
2013-01-15 18:53:39,922 [-] [HttpServerWorker-6] ERROR ValidateMediator Error creating a new schema objects for schemas : [TPXSD-KEY]
org.xml.sax.SAXParseException: src-resolve: Cannot resolve the name 'DateTimeType' to a(n) 'type definition' component.
        at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
        at org.apache.xerces.util.ErrorHandlerWrapper.error(Unknown Source)
        at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
        at org.apache.xerces.impl.xs.traversers.XSDHandler.reportSchemaError(Unknown Source)
        at org.apache.xerces.impl.xs.traversers.XSDHandler.getGlobalDecl(Unknown Source)
        at org.apache.xerces.impl.xs.traversers.XSDElementTraverser.traverseNamedElement(Unknown Source)
        at org.apache.xerces.impl.xs.traversers.XSDElementTraverser.traverseGlobal(Unknown Source)
        at org.apache.xerces.impl.xs.traversers.XSDHandler.traverseSchemas(Unknown Source)
        at org.apache.xerces.impl.xs.traversers.XSDHandler.parseSchema(Unknown Source)
        at org.apache.xerces.impl.xs.XMLSchemaLoader.loadSchema(Unknown Source)
        at org.apache.xerces.impl.xs.XMLSchemaLoader.loadGrammar(Unknown Source)
        at org.apache.xerces.impl.xs.XMLSchemaLoader.loadGrammar(Unknown Source)
        at org.apache.xerces.jaxp.validation.XMLSchemaFactory.newSchema(Unknown Source)

Snippet of Core.xsd file:
         &lt;xsd:complexType name="DateTimeType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element ref="Year"/&gt;
            &lt;xs:element ref="Month"/&gt;
            &lt;xs:element ref="Day"/&gt;
            &lt;xs:element ref="Hour" minOccurs="0"/&gt;
            &lt;xs:element ref="Minute" minOccurs="0"/&gt;
            &lt;xs:element ref="Second" minOccurs="0"/&gt;
            &lt;xs:element ref="Fraction" minOccurs="0"/&gt;
            &lt;xs:element ref="TimeZone" minOccurs="0"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T17:05:12.990

您必须编辑您的主要 XSD，指向您的导入架构的位置。也就是说，您必须正确地将第二个模式的注册表路径提供给第一个主模式。只有这样，当消息命中序列时，它才能解析模式。

# ios - 使用 AVAudioRecorder 录制 m4a 然后将该声音文件放入 .plist 文件中

> ID：14388909
> 
> 赞同：1
> 
> 时间：2013-01-17T22:00:23.970
> 
> 标签：ios, plist, avfoundation, avaudioplayer, avaudiorecorder

首先，我什至无法让 .plist 工作，因为我相信它应该在下面。我只是想写一个 NSNumber 并检索它

```
self.paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        self.documentsDirectory = [self.paths objectAtIndex:0];
        self.path = [self.documentsDirectory stringByAppendingPathComponent:@"data.plist"];
        self.fileManager = [NSFileManager defaultManager];
        NSError *error;
        if (![self.fileManager fileExistsAtPath:self.path]) {
            self.bundle = [[NSBundle mainBundle] pathForResource:@"data" ofType:@"plist"];

            [self.fileManager copyItemAtPath:self.bundle toPath:self.documentsDirectory error:&error];

        }

        self.dataForDict = [[NSDictionary alloc] initWithContentsOfFile:self.documentSlashAudioPath];
        int value = 5;
        [self.dataForDict setValue:[NSNumber numberWithInt:value] forKey:@"value"];
        [self.dataForDict writeToFile:self.path atomically:YES];

        self.number = [self.dataForDict objectForKey:@"value"];
        NSLog(@"%i", [self.number intValue]); 
```

最后一个 NSLog 应该给我一个 5，但输出是 0。

我正在尝试创建一个包含音频的 .plist 文件以用于 Sound Bank Player： http: [//www.hollance.com/2011/02/soundbankplayer-using-openal-to-play-musical-instruments-in-你的 iOS 应用程序/](http://www.hollance.com/2011/02/soundbankplayer-using-openal-to-play-musical-instruments-in-your-ios-app/)

我知道如何录制声音并使用 AVAudioRecorder 和 AVAudioPlayer 播放，现在我只需要连接这些点。

# iphone - 链接到嵌入其中的 IFrame 的区域地图

> ID：14388910
> 
> 赞同：1
> 
> 时间：2013-01-17T22:00:29.390
> 
> 标签：iphone, iframe, map

近一周来，我一直在努力寻找解决这个 iPhone 问题的方法。我需要一些帮助。我从来没有为智能手机做过任何编程。这是第一次。此网页适用于所有浏览器，但不适用于智能手机。你能给我一些关于如何修复或转换它的建议吗？

我想更新此页面，使其适用于 iPhone\androdes 设备。[http://www.westernagencyinc.com/contact_us.html](http://www.westernagencyinc.com/contact_us.html)。我有一个测试页面设置[http://www.westernagencyinc.com/test.html](http://www.westernagencyinc.com/test.html)来处理它而不影响真实页面。

“联系我们”页面\地图的工作方式是它的顶部有一个地图，另一个名为 location_info.html 的 html 文件嵌入在其下方的 IFRAME 中。location_info.html 文件是一个位置列表，每个位置都有一个唯一的锚点名称，用于地图上的城市\pin。

该地图在每个城市都有可点击区域的图钉，其目标是 IFrame，代码如下所示：

您可以看到，当您按下地图上的按钮/图钉时，会为该图钉（城市名称）设置一个变量锚点，该图钉与 location_info.html 中的一个锚点相匹配，并将其发送到 IFrame html 文件，因此它将移动\滚动到正确的位置。

保存该位置的 IFRAME 当前没有滚动条。

```
 <area shape="rect" coords="145,-6,200,48" href="locations_infotest.html#kenmare" alt="Kenmare" target="location_content"> 

    <div id="apDiv10" style="width: 100%; height: 100%; overflow: auto; -webkit-overflow-scrolling: touch;" >
<iframe scrolling="no" name="location_content" src="locations_infotest.html" width="625" height="190"></iframe>
</dov>

#apDiv8 
{
 position: absolute; 
 left: 30px; 
 top: 255px; 
 width: 627px; 
 height: 18px; 
 z-index: 8; 
 text-align: left;
}
#apDiv9 
{
 position: absolute; 
 left: 30px; 
 top: 20px; 
 width: 625px; 
 height: 409px; 
 z-index: 9; 
 text-align: left;
}
#apDiv10 
{
position: absolute;
left: 30px;
top: 448px;
width: 625px;
height: 190px;
z-index: 10;
text-align: left;
} 
```

# mysql - 试图在 sqlite db 中获取 3 列的 DISTINCT 值

> ID：14388914
> 
> 赞同：0
> 
> 时间：2013-01-17T22:00:39.713
> 
> 标签：mysql, sql, sqlite

所以我有一张有 3 列的桌子：

```
Col1   Col2   Col3
 a       b     c
 b       c    null
 a      null   b
 c       d     a 
```

我想要的输出将是：

```
a,b,c,d,null 
```

如果可能的话，我希望将输出放在一个字符串中。

我试过了：

```
SELECT DISTINCT col1, col2, col3 FROM table 
```

并没有得到想要的结果。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:10:19.860

单字符串解决方案（参见[sqlfiddle](http://sqlfiddle.com/#!7/81225/2)）：

```
SELECT  GROUP_CONCAT(COALESCE(c, 'NULL'), ',')
FROM    (
        SELECT  col1 c
        FROM    mytable
        UNION
        SELECT  col2 c
        FROM    mytable
        UNION
        SELECT  col3 c
        FROM    mytable
        ) q 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T22:02:59.473

这在sqlite中有效吗：

```
select col1 from table 
union
select col2 from table
union 
select coll3 from table 
```

或者：

```
select col1 from table where col1 is not null
union
select col2 from table where col2 is not null
union 
select coll3 from table where col3 is not null 
```

消除空值。

请注意，我认为这不会很快执行，但我知道在 mssql union 中会对结果做不同的处理

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T22:04:30.117

```
SELECT Col1
FROM table
UNION
SELECT Col2
FROM table
UNION
SELECT Col3
FROM table 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T22:09:23.073

如果您使用的是 MySql，则可以使用此解决方案：

```
select group_concat(coalesce(c,'null') order by c is null, c)
from (
  select col1 c from tbl
  union
  select col2 c from tbl
  union
  select col3 c from tbl
) u 
```

联合查询选择所有值，删除所有重复项。然后我以单个字符串返回结果，按值排序，最后为 null 值，并将 null 转换为“null”（因为 group_concat 将忽略 null 值）。

如果你使用 SQLite，Group_Concat 不支持 order by，你可以使用这个：

```
select group_concat(coalesce(c,'null'))
from (
  select col1 c, col1 is null o from mytable
  union
  select col2 c, col2 is null o from mytable
  union
  select col3 c, col3 is null o from mytable
  order by o, c
) u 
```

# ide - 对于作为 phpstorm 中的属性的对象的方法，哪个是正确的 PHPdoc？

> ID：14388916
> 
> 赞同：1
> 
> 时间：2013-01-17T22:01:06.917
> 
> 标签：ide, warnings, phpstorm, phpdoc

我是 PHPStorm 的新手，我在这个 IDE 中导入了一个现有项目。现在我收到很多警告，比如

> 在类中找不到方法“查询”

我读到了关于使用 PHPDoc-blocks 来声明当前类中未定义的变量的来源，但我不知道在这种情况下我应该如何做：

```
class loginModel extends Model{
  public function checkLogin(){
    [...]
    if($this->db->query($sql)){[...]} //Warning as stated above
    [...]
  }
} 
```

**$this->db**本身继承自类 Model：

```
class Model{

  protected $db;     

  private function connect(){
    $this->db = new PGSQL();
  }
} 
```

因此可以访问名为查询的公共 PGSQL 方法。
也许不是设计得那么好，但我怎样才能在不降低其严重性的情况下解决这些消息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T22:04:37.013

```
class Model{

    /**
     * @var PGSQL
     */
    protected $db;

    private function connect(){
        $this->db = new PGSQL();
    }
} 
```

Docblocks 也适用于属性

# c# - 在AutoCAD中选择整个图形而不提示用户

> ID：14388918
> 
> 赞同：2
> 
> 时间：2013-01-17T22:01:08.947
> 
> 标签：c#, .net, pdf, autocad, dxf

我正在尝试使用`PlotType`AutoCad 中的“窗口”进行绘图。这是代码：

```
ViewBorder border = new ViewBorder();

Point3d first = new Point3d(border.Width, 0, 0);
Point3d second = new Point3d(border.Height, 0, 0);

Extents2d window = TransformCoordinates(first, second);

psv.SetPlotWindowArea(ps, window);

psv.SetPlotType(ps, Autodesk.AutoCAD.DatabaseServices.PlotType.Extents); 
```

TransformCoordinates 方法仅接收两个 Point3d 参数（x 和 y）并将它们从 UCS 转换为 DCS 坐标，返回一个 Extents2d。我不想让用户选择点（互联网上有一些使用这个的例子）。我唯一想要的是“第一”和“第二”变量变成了 Point3d。第一个必须是模型空间绘图的左上角，第二个也必须是模型空间绘图的右下角。我怎么能这样做？PlotType（或其他东西）中是否有任何配置之王可以为我管理所有这些，即不要求用户选择角落并为我选择模型空间中的整个绘图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T07:59:25.183

我的经验不是 C# 和 AutoCad。我接受过 AutoLISP 培训。但是知道 AC 是如何工作的，我想说你最好的选择是控制命令提示符，如此[处](http://docs.autodesk.com/ACD/2010/ENU/AutoCAD%20.NET%20Developer%27s%20Guide/index.html)所述。

根据您所说的，我假设您想打印模型空间中的任何内容；那是对的吗？

好吧，当您在 PaperSpace 中时，您可以通过`._MSPACE`在命令行上键入来切换到 ModelSpace。这将使您能够通过 PSpace 中的一个洞在 MSpace 中工作——可以这么说。因此，如果 PSpace 中的布局没有显示 MSpace 的全部内容，您可以切换到 MSpace 并在命令行上输入`z`或键入。`zoom`然后，您将拥有任何用户使用该`zoom`工具在模型空间内的所有选项（全部/中心/动态...）。`All`可能是最好的选择。

因此，当用户单击您的按钮或输入您的别名时，您可以自动化整个过程。您可以切换到 MSpace-> 全部缩放 -> 绘图 -> 布局（要绘制的内容）。

## 更新：

我现在意识到我的链接没有将您带到我想要的特定主题。（？）
这是我认为您应该尝试的片段 -

```
using Autodesk.AutoCAD.ApplicationServices;
using Autodesk.AutoCAD.Runtime;

[CommandMethod("selectEntireAutoCadDrawing")]
public static void selectEntireAutoCadDrawing()
{
  //This sets up your doc. Not sure if this is the way you're doing it.
  //I imagine you'd probably pass the doc into the method.
  Document yourACDoc = Application.DocumentManager.MdiActiveDocument;

  //When your plug-in is invoked the first thing I'd do is make sure they're
  //in PaperSpace
  yourACDoc.SendStringToExecute("tilemode 0 ");

  //Next enable ModelSpace through PaperSpace.
  yourACDoc.SendStringToExecute("_mspace ");

  //Now we zoom to the extents of the drawing.
  //Not sure about the bools at the end. The AC documentation has it there for a
  //zoom all example but AC doesn't ask any further questions after selecting the 
  //all or extents zoom types and doesn't elaborate on it?
  yourACDoc.SendStringToExecute("._zoom _extents "/*, true, false, false*/);

  //Head back to PaperSpace
  yourACDoc.SendStringToExecute("_pspace ");
} 
```

此时，您的绘图应该都在 PaperSpace 中。现在继续执行其余的操作。

AC 命令行需要空格键、回车键，或者如果设置正确，则单击鼠标即可执行任何命令。这就是为什么某些参数之间有空格的原因。这样做很重要，否则它们将被解释为未知命令。

您可能需要尝试一下，查看 API 参考，或使用不同的缩放类型。如果您有多个具有不同风格的用户，尤其是在管理松散的商店中，缩放可能会变得很棘手。如果这将在人们意识到其局限性的环境中实施，那应该没问题。

另外 - 让自己熟悉 AC 会很好。您可以将命令行用作调试器，因为它会显示所有输入的命令和任何错误消息的列表。它还可以让您提前设计。只需在 AC 中输入命令，记下提示的顺序和目的并相应地编码。还有一种方法可以将动作记录到宏中，这是许多没有编程知识的人采用的方法。

祝你好运~

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T18:46:11.893

尝试这个。

```
using Autodesk.AutoCAD.ApplicationServices;
using App = Autodesk.AutoCAD.ApplicationServices.Application;
using Autodesk.AutoCAD.DatabaseServices;
using Autodesk.AutoCAD.EditorInput;

Document curDoc = App.DocumentManager.MdiActiveDocument;
Extents3d allEntsExtents = new Extents3d();
using (Transaction tr = curDoc.TransactionManager.StartTransaction())
{
    BlockTable bt = tr.GetObject(curDoc.Database.BlockTableId, OpenMode.ForRead, false) as BlockTable;
    BlockTableRecord btr = tr.GetObject(bt[BlockTableRecord.ModelSpace], OpenMode.ForRead, false) as BlockTableRecord;
    allEntsExtents.AddBlockExtents(btr);
    tr.Commit();
}
Plane plane = new Plane();
Extents2d window = new Extents2d(
    allEntsExtents.MinPoint.Convert2d(plane),
    allEntsExtents.MaxPoint.Convert2d(plane)); 
```

# php - 当从移动应用程序生成访问令牌时，如何验证来自 PHP 的访问令牌？

> ID：14388921
> 
> 赞同：3
> 
> 时间：2013-01-17T22:01:17.947
> 
> 标签：php, android, facebook, authentication

我正在编写一个 Android 应用程序，我想通过 Facebook 进行身份验证，然后在与 Facebook 建立会话后联系我自己的 Web 服务器。我的 Web 服务器仅通过 JSON 与 Android 应用程序通信，因此我无法重定向网页以让用户登录。

我可以将访问令牌和用户 ID 从 Facebook 发送到 Web 服务器，但我需要一种验证输入的方法。

我查看了其他一些线程（即[this](https://stackoverflow.com/questions/12400356/how-to-check-if-a-user-is-logged-in-to-facebook)和[this](https://stackoverflow.com/questions/7220572/checking-if-a-user-is-logged-in-to-facebook)），看起来有多种方法可以将用户的登录状态传达给远程 Web 服务器。

这里哪种方法是标准的？有什么我应该注意的权衡吗？

1.  `$Facebook->getUser()`会给我当前正在请求该页面的用户的 ID（如果网页未通过身份验证，这是否有效，但移动应用程序是？）
2.  `$Facebook->getAccessToken()`会给我登录用户的会话密钥（与 1 中的问题相同）
3.  `$Facebook->api('/me')`只要有人登录就不会返回 null

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T00:38:13.377

只需通过 HTTPS 连接将访问令牌发送到您的服务器，您就可以通过调用来验证它，`/me`并`/app`验证应用程序和用户 ID 是否都符合您的预期

另请参阅访问令牌调试端点：[https ://developers.facebook.com/docs/howtos/login/debugging-access-tokens/](https://developers.facebook.com/docs/howtos/login/debugging-access-tokens/)

# java - java中的多线程

> ID：14388926
> 
> 赞同：0
> 
> 时间：2013-01-17T22:01:48.033
> 
> 标签：java

我有一个多线程程序，我希望其中一个线程在所有线程完成后打印语句。我该怎么做？我怎么知道所有线程都完成了？

```
ExecutorService pool = Executors.newCachedThreadPool();
    for(int i = 0; i < myList.size(); ++i) {
            pool.execute (new ThreadProcessRunnable (args));
    }

    public class ThreadProcessRunnable implements Runnable {
           public void run() {

           System.out.println("last thread should execute this");
    }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:08:42.777

这听起来像是一个理想的用例`ExecutorService.invokeAll`：

```
ExecutorService pool = Executors.newCachedThreadPool();
List<Callable<Object>> tasks = new ArrayList<Callable<Object>>();
for(int i = 0; i < myList.size(); ++i) {
    tasks.add (Executors.callable(new ThreadProcessRunnable (args)));
}
List<Future<Object>> futures = pool.invokeAll(tasks);
System.out.println("All tasks finished");

public class ThreadProcessRunnable implements Runnable {
    public void run() {
        // do some stuff
    }
} 
```

`invokeAll`阻塞，直到提供的所有任务`List`都完成。

If you absolutely must have the `println` inside one of the threads' `run` methods, then the simplest approach I can think of would be to keep some sort of counter in an `AtomicInteger`

```
public class ThreadProcessRunnable implements Runnable {
  private AtomicInteger taskCounter;

  public ThreadProcessRunnable(AtomicInteger counter) {
    this.taskCounter = counter;
  }

  public void run() {
    // do stuff
    if(taskCounter.decrementAndGet() == 0) {
      System.out.println("I am the last thread and I am about to finish");
    }
  }
}

// Main class
ExecutorService pool = Executors.newCachedThreadPool();
AtomicInteger taskCounter = new AtomicInteger(myList.size());
for(int i = 0; i < myList.size(); ++i) {
    pool.execute(new ThreadProcessRunnable(taskCounter));
} 
```

The key thing that makes this work is that `taskCounter.decrementAndGet` is *atomic* - if the value of `taskCounter` is initially 2, for example, and two different threads call `decrementAndGet` at the same time then it is guaranteed that one thread will see the value 1 and the other thread will see the value 0, so exactly one thread will print the "about to finish" message. This is different from [MadProgrammer's answer](https://stackoverflow.com/a/14390306/592139), which involves a race condition:

```
latch.countDown();
if(latch.getCount() == 0) { ... } 
```

where it is possible to have thread 1 decrement the value (to 1), then thread 2 decrement it again (to 0), then *both* threads see the value 0 when they call `getCount` and *both* print the message.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T22:08:14.873

您可以将 CyclicBarrier 与屏障操作一起使用（[文档](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/CyclicBarrier.html#CyclicBarrier%28int,%20java.lang.Runnable%29)）。

> 创建一个新的 CyclicBarrier，当给定数量的参与方（线程）正在等待它时，它将触发，并且当障碍被触发时，它将执行给定的屏障动作，由最后一个进入屏障的线程执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T23:56:13.567

This is a REALLY basic example/concept of using a `CountDownLatch`

```
public class TestCountDownLatch {

  private static CountDownLatch latch;

  public static void main(String[] args) {

    latch = new CountDownLatch(10);
    ExecutorService pool = Executors.newCachedThreadPool();
    for (int i = 0; i < 10; ++i) {
      pool.execute(new Worker(i));
    }
  }

  public static class Worker implements Runnable {

    private int number;

    public Worker(int number) {
      this.number = number;
    }

    @Override
    public void run() {

      try {
        System.out.println(number + " is sleeping...");
        Thread.sleep((long) (Math.round(Math.random() * 1000)));
      } catch (InterruptedException ex) {
      }

      System.out.println(number + " is Completed...");
      latch.countDown();

      if (latch.getCount() == 0) {

        System.out.println(number + " was last...");

      }

    }
  }
} 
```

**Simple Single Thread Test Case**

```
public class TestCountDownLatch {

  private static CountDownLatch latch;

  public static void main(String[] args) {

    latch = new CountDownLatch(1);
    ExecutorService pool = Executors.newCachedThreadPool();
    for (int i = 0; i < 1; ++i) {
      pool.execute(new Worker(i));
    }
  }

  public static class Worker implements Runnable {

    private int number;

    public Worker(int number) {
      this.number = number;
    }

    @Override
    public void run() {

      try {
        System.out.println(number + " is sleeping...");
        Thread.sleep((long) (Math.round(Math.random() * 1000)));
      } catch (InterruptedException ex) {
      }

      System.out.println(number + " is Completed...");
      latch.countDown();

      if (latch.getCount() == 0) {

        System.out.println(number + " was last...");

      }

    }
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T22:09:06.427

You can place it in the main thread. Call `pool.await()` to block the main thread until all threads in the pool have finished, then do the extra work. The code would look like this:

```
ExecutorService pool = Executors.newCachedThreadPool();
for(int i = 0; i < myList.size(); ++i) {
        pool.execute (new ThreadProcessRunnable (args));
}
pool.shutdown();
pool.awaitTermination();//blocks the main thread
System.out.println("last thread should execute this"); 
```

# python - 按需更改记录器

> ID：14388929
> 
> 赞同：1
> 
> 时间：2013-01-17T22:02:09.100
> 
> 标签：python, logging

假设我有一个添加了 StreamHandler 和 FileHandler 的根记录器。任何子记录器都将继承根记录器。有什么方法可以修改子记录器，例如它以与为根记录器配置的格式不同的格式保存消息。

```
[<logging.StreamHandler instance at 0x0884B850>, <logging.FileHandler instance at 0x0C7A84E0> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T22:11:01.827

您可以在具有自己的格式化程序的子记录器上附加一个新的处理程序。

您应该能够创建一个处理程序来写入与根处理程序相同的文件，因为刷新操作使用锁。

```
handler = logging.FileHandler(filename)
formatter = logging.Formatter(newformat)
handler.setFormatter(formatter)

log = logging.getLogger(yourloggername)
log.setHandler(handler)
log.propagate = False   # don't send messages to the root, handle it all here 
```

# c# - GridView 没有拾取空数据对象

> ID：14388938
> 
> 赞同：2
> 
> 时间：2013-01-17T22:02:39.567
> 
> 标签：c#, asp.net, sql-server-2008

我有一个gridview，它由存储过程通过标准n层结构提供，应该触发空行对象，但它没有。相反，我得到一个异常“IListSource 不包含任何数据源”。如果我在 SQL Server Management Studion 中运行查询，它会返回一个空行。

我怀疑问题出在 transact-sql 上，我使用的是 PIVOR 构造，由于我不太熟悉它的工作原理，我认为这会导致问题。它是从[这个博客](http://www.simple-talk.com/blogs/2007/09/14/pivots-with-dynamic-columns-in-sql-server-2005/)借来的，并由我的前任修改。

有谁知道是什么导致了这个问题？这里是代码。

```
<asp:GridView ID="gvSystemRMRiskRpt" runat="server" AutoGenerateColumns="true"
   CellPadding="3" PageSize="25" BackColor="White" BorderColor="MidnightBlue"
   BorderStyle="Groove" BorderWidth="1px" CssClass="TextCompact" GridLines="Vertical"
   OnRowDataBound="gvSystemRMRiskRpt_OnDataBound" EmptyDataText="Your request has returned zero records" >                
    <RowStyle BackColor="#EEEEEE" ForeColor="Black" />
    <SelectedRowStyle BackColor="#008A8C" Font-Bold="True" ForeColor="White" />
    <PagerStyle BackColor="#999999" ForeColor="Black" HorizontalAlign="Center" />
    <HeaderStyle BackColor="#000084" Font-Bold="True" ForeColor="White" />
    <AlternatingRowStyle BackColor="Gainsboro" />
    <FooterStyle BackColor="#CCCCCC" ForeColor="Black" VerticalAlign="Top" />
</asp:GridView> 
```

代码文件：

```
 protected void btnSearch_Click(object sender, EventArgs e)
    {
        Guid site = new Guid(ddlSites.SelectedValue);
        int interval = Convert.ToInt16(ddlIntervals.SelectedValue);
        string[] startDate = tbStartDate.Text.Split('/');  // 01-2001
        string[] stopDate = tbEndDate.Text.Split('/');     // 12/2002

        gvSystemRMRiskRpt.DataSource = Data.ByMonthYear(connectionManager,site,startDate[1],stopDate[1],interval);
        gvSystemRMRiskRpt.DataBind();
     } 
```

数据层：

```
 public static DataSet ByMonthYear(ConnectionManager connectionManager, Guid site, string startDate, string stopDate, int interval)
    {
        SqlCommand cmd = new SqlCommand();
        cmd.CommandText = "[dbo].[ByMonthYear_StoredProc]";
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Connection = connectionManager.GetSqlConnectionContext();
        cmd.Transaction = connectionManager.GetSqlTransactionContext();

        SqlParameter paramSiteGUID = new SqlParameter("@SiteGUID", SqlDbType.UniqueIdentifier);
        paramSiteGUID.Value = site;
        cmd.Parameters.Add(paramSiteGUID);

        SqlParameter paramStartDate = new SqlParameter("@StartDate", SqlDbType.VarChar);
        paramStartDate.Value = startDate;
        cmd.Parameters.Add(paramStartDate);

        SqlParameter paramStopDate = new SqlParameter("@StopDate", SqlDbType.VarChar);
        paramStopDate.Value = stopDate;
        cmd.Parameters.Add(paramStopDate);

        SqlParameter paramProcedureAction = new SqlParameter("@ProcedureAction", SqlDbType.Int);
        paramProcedureAction.Value = 0; // From Primary Key
        cmd.Parameters.Add(paramProcedureAction);

        SqlParameter paramInterval = new SqlParameter("@Interval", SqlDbType.Int);
        paramInterval.Value = interval;
        cmd.Parameters.Add(paramInterval);

        SqlDataAdapter sqlDA = new SqlDataAdapter(cmd);
        DataSet ds = new DataSet();
        sqlDA.Fill(ds);

        cmd.Dispose();
        cmd = null;

        return ds;
    } 
```

和实际存储的过程：

```
alter PROCEDURE [dbo].[ByMonthYear_StoredProc]
@ProcedureAction int,
@SiteGUID uniqueidentifier = null,
@StartDate varchar(4),
@StopDate varchar(4),
@Interval int
AS

DECLARE @cols NVARCHAR(2000)
DECLARE @query NVARCHAR(4000)

IF (@ProcedureAction = 0) -- From 
BEGIN

    SET NOCOUNT ON
    SET TRANSACTION ISOLATION LEVEL READ COMMITTED

    IF (@Interval = 1) -- Montly
    BEGIN
        SELECT @cols = STUFF(( SELECT DISTINCT TOP 100 PERCENT '],[' + cast(MonthYear as varchar(10)) FROM vByMonthYear where SiteGUID = @SiteGuid 
        and [Year] BETWEEN '2005' AND '2010' ORDER BY '],[' + cast(MonthYear as varchar(10)) FOR XML PATH('') ), 1, 2, '')
         + ']' SET @query = N'SELECT EventType, ' + @cols +' FROM (SELECT MonthYear,EventType,Value,OrderBy FROM vRByMonthYear 
         where SiteGUID = ' + CHAR(39) + CONVERT(nvarchar(36), @SiteGuid) + CHAR(39) + ' and Year BETWEEN 2005 AND 2010) p 
         PIVOT ( Sum ([Value] ) FOR MonthYear IN ( '+ @cols +' ) ) AS pvt order by OrderBy' 
        execute(@query)
    END
END 
```

Just to reiterate, if I run SELECT DISTINCT TOP 100 PERCENT '],[' + cast(MonthYear as varchar(10)) FROM vByMonthYear where SiteGUID = @SiteGuid and [Year] BETWEEN '2005' AND '2010' in the query window and I substitute the @SiteGuid with an actual value that I know has no record I get an empty row but in my app I get the exception.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T18:09:50.423

I suspect this is what happened but am not 100% certain. The adapter

```
 SqlDataAdapter sqlDA = new SqlDataAdapter(cmd);
  DataSet ds = new DataSet();
  sqlDA.Fill(ds); 
```

was being filled with a row of no data and so the dataset that was returned was not treated as empty - not sure why. I suspect the weird SQL Pivot was returning some reference or white space.

Anyway, I had changed the method to return a `DataTable` instead of `DataSet` and droped the entire `SqlDataAdapter` and instead used a `SqlReader` which worked. Probably saved some 1 milisecond of overhead in the process.

```
using (SqlDataReader _reader = cmd.ExecuteReader())
{
     DataTable dt = new DataTable();
     dt.Load(_reader);
     cmd.Dispose();
     return dt;
} 
```

# ruby-on-rails - Rails 和 Memcached：优化多次提取

> ID：14388941
> 
> 赞同：4
> 
> 时间：2013-01-17T22:02:53.473
> 
> 标签：ruby-on-rails, json, caching, memcached, dalli

我正在为 iPhone 应用程序构建 Rails 后端。

在分析我的应用程序后，我发现以下调用在性能方面特别昂贵：

```
@messages.as_json 
```

此调用返回大约 30 个消息对象，每个都包含许多子记录。如您所见，单个消息 json 响应可能会组合许多 DB 调用：

```
 def as_json(options={})

     super(:only => [...],
      :include => {
        :user => {...},
        :checkin => {...}
                     }},
        :likes => {:only => [...],
                      :include => { :user => {...] }}},
        :comments => {:only => [...],
                                    :include => { :user => {:only => [...] }}}
                   },
      :methods => :top_highlight)
  end 
```

平均而言，`@messages.as_json`调用（所有 30 个对象）需要将近 1100 毫秒。

想要优化我已经使用了 memcached。使用下面的解决方案，当我所有的消息对象都在缓存中时，平均响应现在是 200-300 毫秒。我对此很满意，但我遇到的问题是这使得缓存未命中情况变得更慢。在缓存中没有任何内容的情况下，现在需要超过 2000 毫秒的时间来计算。

```
 # Note: @messages has the 30 message objects in it, but none of the child records have been grabbed

    @messages.each_with_index do |m, i|
      @messages[i] = Rails.cache.fetch("message/#{m.id}/#{m.updated_at.to_i}") do
        m.as_json
      end
    end 
```

我知道检查每个对象的缓存必须有一些开销。但我猜有一种比我现在的方式更有效的方法，基本上是连续的，一个接一个的。关于提高效率的任何指示？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-17T23:50:29.970

我相信`Rails.cache`使用该`ActiveSupport::Cache::Store`接口，该接口具有`read_multi`用于此确切目的的方法。[[1]](http://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-read_multi)

我认为换掉`fetch`会`read_multi`提高你的表现，因为`ActiveSupport::Cache::MemCacheStore`有一个优化的`read_multi`. [[2]](http://api.rubyonrails.org/classes/ActiveSupport/Cache/MemCacheStore.html#method-i-read_multi)

**代码**

这是更新的实现：

```
keys = @messages.collect { |m| "message/#{m.id}/#{m.updated_at.to_i}" }
hits = Rails.cache.read_multi(*keys)
keys.each_with_index do |key, i|
  if hits.include?(key)
    @messages[i] = hits[key]
  else
    Rails.cache.write(key, @messages[i] = @messages[i].as_json)
  end
end 
```

高速缓存写入仍然与每次未命中的高速缓存往返同步执行。如果您想减少这种开销，请查看使用诸如[workling 之](https://github.com/purzelrakete/workling)类的异步运行后台代码。

请注意，启动异步作业的开销实际上小于`Rails.cache.write`开始扩展架构之前的开销。

**Memcached 多集**

看起来 Memcached 团队至少考虑过提供 Multi-Set（批量写入）命令，但目前还没有任何 ActiveSupport 接口，也不清楚实现提供了何种级别的支持。[[3]](http://code.google.com/p/memcached/wiki/NewCommonFeatures#Multi-Set)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-10T17:39:29.530

从 Rails 4.1 开始，您现在可以执行 fetch_multi 并传入一个块。

[http://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch_multi](http://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html#method-i-fetch_multi)

```
keys = @messages.collect { |m| "message/#{m.id}/#{m.updated_at.to_i}" }
hits = Rails.cache.fetch_multi(*keys) do |key|
  @messages[i] = @messages[i].as_json
end 
```

注意：如果您要设置许多项目，您可能需要考虑在某种后台工作人员中写入缓存。

# jquery - jQuery 插件帮助：自定义回调

> ID：14388943
> 
> 赞同：0
> 
> 时间：2013-01-17T22:03:05.703
> 
> 标签：jquery, jquery-plugins

我很难尝试构建这个 jQuery 插件。我遇到问题的部分是让自定义回调函数触发。

```
    （函数（$，窗口，文档，未定义）{

        // 函数选项

        变种方法 = {
            初始化：函数（选项）{
                返回 this.each(function (){
                    方法.开始（这个，选项）；
                });
            },
            开始：函数（el，选项）{

                // 将动画开始附加到选择器

                $(document).on("动画开始", el, function(){
                    options.start.call();
                });

            }
        }

        // 插件代码

        $.fn.plugin = 功能（选项）{

            如果（方法[选项]）{
                返回方法[选项].apply(this, Array.prototype.slice.call(arguments, 1));
            } else if ( typeof options === "object" || ! options ) {
                返回方法.init.apply（这个，参数）；
            } 别的 {
                $.error(“方法”+选项+“插件中不存在”);
            }

        };
    })( jQuery );

    // 附加到 DOM 对象

    $('img').plugin({
      “开始”：函数（）{
          console.log('动画开始');
      }
    });

```

谁能帮我弄清楚为什么“开始”没有触发自定义回调函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:33:39.860

感谢这篇文章[CSS3 transition event Listener with jQuery弄明白了](https://stackoverflow.com/questions/11284194/css3-transition-event-listener-with-jquery)

显然，动画有浏览器特定的事件。

# android - 如何列出远程/服务器目录中的所有文件

> ID：14388944
> 
> 赞同：1
> 
> 时间：2013-01-17T22:03:18.120
> 
> 标签：android, file

我正在制作一个 android 应用程序，该应用程序需要我从应用程序的 /files 路径中的本地远程目录下载所有图像。我需要知道如何获取该目录中所有文件（所有图像）的列表，以便我可以将它们全部下载到手机上。我找到了列出本地目录中文件的代码，但我需要知道如何为远程目录做同样的事情（该目录是一个不需要登录的 http 目录）

```
String path = "."; 

String files;
File folder = new File(path);
File[] listOfFiles = folder.listFiles(); 

for (int i = 0; i < listOfFiles.length; i++) 
{

 if (listOfFiles[i].isFile()) 
 {
   files = listOfFiles[i].getName();
   System.out.println(files);
 }
} 
```

此外，一旦我在目录中获得图像的名称，我将使用此工作代码下载图像。

```
private void storeImage(String filename)
{
  FileOutputStream out = null;
  try
  {
    URL url = new URL(Consts.IMAGES_BASE_URL + filename);
    InputStream is = (InputStream) url.getContent();
    Bitmap bm = BitmapFactory.decodeStream(is);
    out = context.openFileOutput(filename, Context.MODE_WORLD_READABLE);

    File file = new File(context.getFilesDir().toString(), filename);
    out = new FileOutputStream(file);

    if(isPNG(filename))//isPNG just parses out the extension
      bm.compress(Bitmap.CompressFormat.PNG, 85, out);
    else if(isJPG(filename))
      bm.compress(Bitmap.CompressFormat.JPEG, 85, out);

  } catch (MalformedURLException e)
  {
    e.printStackTrace();
  } catch (IOException e)
  {
    e.printStackTrace();
  }
  finally
  {
    try
    {
      out.flush();
      out.close();
    } catch (IOException e)
    {
      e.printStackTrace();
    }
  }

} 
```

任何帮助表示赞赏

# wordpress - Wordpress 的所有公共/直接入口点是什么？

> ID：14388946
> 
> 赞同：6
> 
> 时间：2013-01-17T22:03:34.377
> 
> 标签：wordpress, redirect, symlink

我意识到这是一个有点奇怪的问题，但长话短说，我们有一些 Wordpress 安装，其文件是通过符号链接加载的（符号链接在文档根目录中，而 Wordpress 不在）。

为此，我需要列出通常直接从 Web 浏览器（由用户或通过 AJAX）加载的所有 Wordpress 文件的列表，例如：`index.php`、、`wp-login.php`（*所有主题文件*）* ...

*不*直接加载的文件示例： `wp-load.php`, `wp-config.php`, `wp-blog-header.php`...

[*] 主题文件是一个例外；它们实际上存在于文档根目录中。

**编辑：**您可能想知道，这有什么意义？这样我们就可以减少服务器上的额外文件；每个 Wordpress 网站都有数千个相同的文件是没有用的。该`wp-content`目录已保留在那里，因为它是网站之间的变化。我知道这种设置的后果吗？我相信我是。

**编辑2：**

[http://codex.wordpress.org/WordPress_Files](http://codex.wordpress.org/WordPress_Files)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-21T21:10:16.333

这是一个基于入口点的列表`require( 'wp-load.php' );`

[https://github.com/szepeviktor/WPHW/blob/master/wp-entry-points.md](https://github.com/szepeviktor/WPHW/blob/master/wp-entry-points.md)

还有一张关于他们缺陷的 Trac 票 [https://core.trac.wordpress.org/ticket/28364](https://core.trac.wordpress.org/ticket/28364)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T22:25:26.530

到目前为止，以下解决了我的问题：

```
ln -s /var/www/vhosts/mainsite/httpdocs/index.php /var/www/vhosts/subsite/httpdocs/index.php
ln -s /var/www/vhosts/mainsite/httpdocs/wp-login.php /var/www/vhosts/subsite/httpdocs/wp-login.php
ln -s /var/www/vhosts/mainsite/httpdocs/wp-admin /var/www/vhosts/subsite/httpdocs/wp-admin
ln -s /var/www/vhosts/mainsite/httpdocs/wp-includes /var/www/vhosts/subsite/httpdocs/wp-includes 
```

# jquery - 添加事件侦听器：最好在文档级别添加它们还是在树的更下方添加？

> ID：14388949
> 
> 赞同：1
> 
> 时间：2013-01-17T22:03:37.310
> 
> 标签：jquery, event-listener

如果我添加一个事件侦听器，我应该在文档级别添加它还是在文档树的下方添加它？

例如，假设我知道输入`class="ExampleCss"`总是会在 div 中`id="ExampleDiv"`。我应该使用：

`$('#ExampleDiv').on(...);`

或者

`$(document).on(...);`?

我应该注意这方面的最佳做法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:08:51.207

最好使用更具体的选择器。当你像这样委托时，jQuery 必须沿着 DOM 树向下查找与委托选择器匹配的所有后代。显然`document`拥有最多的后代。

使用更具体的选择器也更清晰，并且可以防止可能的错误（如果您`.ExampleCss`不想触发此事件）。

使用更具体的选择器的唯一缺点是可能必须更改您以后要委托给的类的祖先。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:34:50.097

最好通过 id 和/或类名来使用选择器。除了消除 jquery 遍历所有 dom 的额外时间浪费之外，它还将消除混淆，并保持您的代码可维护......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T09:43:00.740

直接事件回调`$(".aClass").on("click",function(){});`直接附加到元素，因此如果事件发生，则可以直接调用该回调。

对于委托事件回调`$(element).on("click",".aClass", function() {});`，事件的事件回调附加到`element`. 在附加事件回调时，`selector`只是存储了参数，jquery 那时不会搜索匹配的元素。此选择器仅在元素接收到事件时使用（直接或当事件在 dom 中冒泡时）。然后 jquery 会检查作为事件起源的元素是否与选择器匹配。

因此，您应该使此选择器尽可能简单。测试`.on("click", ".aClass", ...)`可以更快地完成，`.on("click", ".foo div .bar .aClass", ...)`因为对于第一个，jQuery 只需要检查作为事件起源的元素是否具有`.aClass`第二个 jQuery 的类，还需要测试其他条件。这就是尽可能具体的内容。

对于像`click`,和其他很少触发的事件`mousedown`，`mouseup`您不会注意到性能影响。对于像这样在短时间间隔内调用的事件，在`keypress`那里`mousemove`使用委托可能不是最好的选择，因为在每个事件上，如果作为源的元素与选择器匹配，jquery 必须进行测试。（`element`作为根使用）

另一件重要的事情是，并非所有事件都在 DOM 中冒泡。例如，带有或不冒泡`scroll`的元素的事件（至少不在 chrome 中）。和其他事件也已知不会在某些浏览器或浏览器版本中冒泡。对于这些事件，不可能使用委托。`overflow: scroll``overflow: auto`

那么什么是更好的选择，这并不容易回答。如果您使用委托并且没有在明确的位置声明它们，则有时很难找出哪些元素具有回调。另一方面，如果您有一个非常动态的页面，您经常在其中添加或删除 DOM 中的元素，那么使用委托通常要容易得多，因为您不需要注意附加所有所需的事件回调到新添加的元素。

如果您想使用直接和委托，那么调用回调的顺序也有一些特殊之处：如果您使用 and 进行添加`$(".aClass").on("click", ...)`并且`$(document).on("click",".aClass", ...)`用户首先单击一个元素，`.aClass`则直接附加的回调按附加的顺序调用，然后如果有匹配的委托回调按照它们附加的顺序调用，则事件正在冒泡到下一个侦听该事件的元素。然后事件继续冒泡，直到它到达文档。

# iphone - 释放 UIImage 会导致 App 崩溃

> ID：14388951
> 
> 赞同：0
> 
> 时间：2013-01-17T22:03:41.867
> 
> 标签：iphone, ios, objective-c, memory-leaks, uiimage

我的应用程序遍历图像路径数组并将所有这些图像合并为一个。代码如下。但是，当我发布带有 (gdb) 在控制台中打印的图像时，应用程序会崩溃。如果我删除图像释放线，那么它可以正常工作，但这可能会导致内存泄漏。请查看此代码并解释为什么会发生这种情况以及可以改进的地方。谢谢你。

```
UIGraphicsBeginImageContextWithOptions(CGSizeMake(width*len+padding*len+padding,
                                                  height+padding*2), 
                                       YES, 0.0);
do{

        //draw image
        path = (NSString*)[_imageData objectAtIndex:i];
        UIImage * img = [[[UIImage alloc] initWithContentsOfFile:path]
                           cropCenterAndScaleImageToSize:CGSizeMake(width, height)];
        [img drawAtPoint: CGPointMake(width*i+padding*i+padding,padding) blendMode:kCGBlendModeNormal alpha:1];
        [img release]; //APP CRASHES HERE BUT WORKS IF THIS LINE REMOVED
        i++;
    }while (i<len);
    UIImage *result = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    UIImageWriteToSavedPhotosAlbum(result, self,
                                   @selector(image:didFinishSavingWithError:contextInfo:),
                                   nil); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:36:02.743

问题是您没有释放分配的图像。您正在释放自动释放的裁剪图像并泄漏分配的图像。

改变这个：

```
UIImage * img = [[[UIImage alloc] initWithContentsOfFile:path]
                   cropCenterAndScaleImageToSize:CGSizeMake(width, height)];
[img drawAtPoint: CGPointMake(width*i+padding*i+padding,padding) blendMode:kCGBlendModeNormal alpha:1];
[img release]; 
```

至：

```
UIImage *original = [[UIImage alloc] initWithContentsOfFile:path];
UIImage *cropped = [original cropCenterAndScaleImageToSize:CGSizeMake(width, height)];
[cropped drawAtPoint:CGPointMake(width * i + padding * i + padding, padding) blendMode:kCGBlendModeNormal alpha:1];
[original release]; 
```

我假设这`cropCenterAndScaleImageToSize:`是一些返回自动释放`UIImage`引用的类别方法。

# java - Java：以下表达式是什么意思？

> ID：14388952
> 
> 赞同：-4
> 
> 时间：2013-01-17T22:03:44.083
> 
> 标签：java, expression

下面的表达式是什么意思？有人可以告诉我吗？

```
!((number > 6)  ||  (number  <=  2)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T22:06:12.970

它检查是否`number`在 2 和 6 之间。更具体地说，它检查是否`number`是以下之一：

```
3
4
5
6 
```

一个更好的写法是：`(number > 2 && number <= 6)`

# android - 如何制作假相机

> ID：14388953
> 
> 赞同：1
> 
> 时间：2013-01-17T22:03:44.577
> 
> 标签：android, video, android-camera, video-encoding

是否有可能，如果可以，“如何”在 Android 应用程序中创建“假”相机。我所说的“假”是指所有软件创建，对操作系统来说只是看起来像普通的相机，但实际上将位图或字节数组作为其输入数据。我想将这样的设备与 MediaRecorder 一起使用来创建 h.264 视频。

这可以用于：

*   图像幻灯片视频创建
*   截屏到视频文件

**警告：**没有生根和没有ROM修改

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T09:29:31.600

我认为您正在寻找的是一种将视频编码为 H.264 的方法，其方式类似于 MediaRecorder 所做的，但不是来自相机。您并不特别关心这是用“假相机”还是以其他方式完成的，对吗？在这种情况下...

您可以使用Android 4.1 及更高版本中提供的[MediaCodec API。](http://developer.android.com/reference/android/media/MediaCodec.html)您可以只给它一系列图像，它会创建使用（如果可用）硬件编码器编码的视频。一些示例代码：[从 android 中的屏幕抓取创建视频](https://stackoverflow.com/questions/14067339/create-video-from-screen-grabs-in-android/)和[使用 Android MediaCodec 从摄像头编码 H.264](https://stackoverflow.com/questions/13458289/encoding-h-264-from-camera-with-android-mediacodec/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T22:15:47.433

如果您希望用您的“假相机”影响其他应用程序，那只能通过修改 Android 源代码并滚动您自己的 ROM 模块来实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-07T09:36:09.690

是的你可以！无需root，无需修改ROM​​，最好的办法是构建一个虚拟应用程序，将其他应用程序作为插件运行，这样您就可以修改目标应用程序中的任何内容。但是有很多工作要做，最好的消息是有几个开源项目可以做到这一点。所以，接下来的事情并不难，你只需要挂钩几个库，这样`/system/lib`会影响摄像头的录制。其实我是在我的设备上做的，但是我直接修改了system lib，当然要root了。但它适用于几乎所有应用程序，除了一些使用该服务捕获视频的应用程序。我们必须修改服务库，但这有点困难。

# javascript - 简化并重写我的重复代码

> ID：14388961
> 
> 赞同：0
> 
> 时间：2013-01-17T22:04:15.877
> 
> 标签：javascript, jquery, css

好的，所以我有一个表，其中包含单独的行或父行，其中有几个孩子链接到该父行。我有图标可以删除那个父亲或单个儿子。图标将显示一个模式弹出窗口（而不是警报）以确认删除。它有效，但我将不得不重复很多次。我认为这可以简化为查找 ID 或类，因为模态显示/隐藏以这种方式工作。提前致谢。

```
<script>
function delVesselAll(){
    $("#vessel_tab #father1").remove();
    $("#vessel_tab .son1").remove();
    document.getElementById(id).style.display = 'block';
};
function delVesselAll2(){
    $("#vessel_tab #father2").remove();
    $("#vessel_tab .son2").remove();
    document.getElementById(id).style.display = 'block';
};
</script> 
```

还有我的html：

```
<td class="cell_50">
  <a style="text-decoration:none;" onclick="showModal('delAll1')"><img src="images/delete-row-icon1.png" title="Delete this row" height="12" width="12" class="father1Del" id="father1Del"/></a>
</td>
<div class="delModal" style="z-index:999999; margin-left:200px; margin-top:30px; display:none" id="delAll1">
  <img src="images/warning.png" />&nbsp;Are you sure you want to delete vessel and the corresponding tanks?<br />
  <input type="button" value="Cancel" class="hide" onclick="hideModal('delAll1')"/>
  <input type="button" value="Delete" onclick="delVesselAll()"/>
</div> 
```

所以我基本上有很多行做同样的事情，可以有类或ID“father1”“father2”“son1”“son2”。另外，我希望这些 div 淡入淡出，`$(this).fadeIn('slow');` 提前使用Thanks之类的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T22:05:39.417

您可以传入变量（可能通过循环，尽管这取决于您的数字是如何生成的）：

```
function delVesselAll(num){
    $("#vessel_tab #father" + num).remove();
    $("#vessel_tab .son" + num).remove();
    document.getElementById(id).style.display = 'block';
}; 
```

然后这样称呼它：

```
delVesselAll(1);
delVesselAll(2); 
```

如果您的数字是可预测的和连续的，您可以循环遍历它们：

```
for (var i = 1; i < $("[id^='father']").length; i++) {
    delVesselAll(i);
} 
```

如果不清楚，您可能需要查看本[教程](http://www.w3schools.com/js/js_functions.asp)。

# git - Git拉回master中的提交？

> ID：14388968
> 
> 赞同：4
> 
> 时间：2013-01-17T22:04:46.803
> 
> 标签：git, branch, git-branch, branching-and-merging

我们将称为 Aaron 的同事被指派对网站的一个部分进行翻新，作为一项长期项目。他创建了一个新的 Git 分支，名为`aaron`. 他所有的更改都是在这个分支上进行的。在他工作期间，我继续维护整个站点，将我的更改提交到`master`.

最终，Aaron 将他的分支合并到`master`. 这以某种方式恢复了我`master`在合并时间和`aaron`首次创建分支时间之间所做的所有提交。如果我键入`git show <hash of merge commit>`，我可以看到我在 Aaron 在他的分支上工作时更改的每个文件的差异。这些差异显示了我所做的每一个更改的还原。`master`如果 Aaron 手动将其分支上每个文件的内容复制到并提交更改，它看起来就像这样。（他没有这样做。我只是想说明日志显示的内容。）

据亚伦说，他没有做任何奇怪的事情。他说他刚刚跑了`git pull origin/aaron`。

是什么原因造成的？是否有可能`git pull origin aaron`将我的所有更改恢复为`master`？

另外，有没有一种简单的方法可以在不恢复他所有工作的情况下恢复我对 master 所做的更改？

**编辑1：**

更改`master`并在合并后恢复的文件之一是`foo.txt`. 所以我这样做了：

```
git checkout aaron
git log foo.txt 
```

日志不*反映*创建分支`foo.txt`后的任何更改。`aaron`我有点期待在分支的日志中某处看到我的更改的恢复`aaron`，但我没有。那么，这是否是亚伦所做的其他事情的最终证据，而不是他声称所做的简单拉动？

**编辑2：**

我说过他打字`origin/aaron`，但他实际上打字`origin aaron`。我在上面改了。

**编辑 3**

根据下面的建议，我选择通过重写历史来解决这个问题。在这一点上，我确信问题是由错误的解决冲突的尝试引起的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T22:12:38.843

`git pull origin/aaron`做到这一点的唯一方法是，如果他有一个从`master`到`aaron`第一个的合并，则丢弃所有的更改`master`（也许通过使用`git merge -s ours master`）。

去查历史。是否有任何以前的合并 from `master`into `aaron`？他们会丢弃`master`的更改吗？如果没有，那唯一的解释就是他*没有*跑`git pull origin/aaron`。

至于恢复更改，您可以退出他的合并并自己重新创建。这将修改历史记录，但如果您对此表示满意，这是最简单的解决方案。如果您*对此*不满意，那么它会变得稍微复杂一些。在这种情况下，您需要创建一个临时分支，退出他的合并，然后正确地重新合并。然后回到 master 并运行`git read-tree tempbranch`。这将使用临时正确合并的结果更新您的索引 [1]，然后您可以提交此操作。

[1]：请注意，这不会修改您的工作树，因此您需要使用类似`git checkout -- .`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:41:40.160

鉴于所有更改都发生在合并提交中，您会看到所谓的邪恶合并。 `man gitglossary`以这种方式定义它：

```
 evil merge
       An evil merge is a merge that introduces changes that do not appear in any
       parent. 
```

[在这个答案](https://stackoverflow.com/a/1461929/166732)中有一个关于这意味着什么的解释。对您来说重要的是，这不是 git 自己会做的事情。创建一个邪恶的合并需要以某种方式进行人工干预。

我通常看到它发生的地方是有人进行合并并因冲突而感到困惑。例如，可能导致这种情况的一件事是，如果 aaron 开始他的 pull，被冲突所淹没，并决定通过将他的文件复制到现有文件之上来解决冲突是安全的。当他在执行此操作后进行合并提交时，您会看到这一点。

至于修复它，如果可以的话，我会按照[Kevin Ballard](https://stackoverflow.com/a/14389086/166732)的建议去做。 `git -reset --hard`主分支回到它在合并之前的样子，然后重做合并。

# python - 函数内部的 Python 函数

> ID：14388970
> 
> 赞同：2
> 
> 时间：2013-01-17T22:04:59.177
> 
> 标签：python, string, function

我正在阅读一本 Python 书中的练习，它是这样说的：

修改 do_twice 使其接受两个参数，一个函数对象和一个值，并调用该函数两次，将值作为参数传递。

编写一个更通用的 print_spam 版本，称为 print_twice，它将一个字符串作为参数并打印两次。

使用修改后的 do_twice 版本调用 print_twice 两次，将 'spam' 作为参数传递。

这是我写的：

```
def do_twice(f, g):
    f(g)
    f(g)

def print_spam(s):
    print (s)

do_twice(print_spam('lol')) 
```

应该怎么写？我完全被这个难住了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T22:07:01.867

只需将.`string`作为第二个参数`do_twice`。`do_twice`函数调用`print_spam`并将 提供为`string`参数：

```
def do_twice(f, g):
    f(g)
    f(g)

def print_spam(s):
    print (s)

do_twice(print_spam,'lol') 
```

*印刷：*

```
lol
lol 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T22:49:57.007

如果由于某种原因你想重复函数 n 次，你也可以写这样的东西......

```
def do_n(f,g,n):
    for i in range(n):
        f(g)

do_n(print_spam,'lol',5)

lol
lol
lol
lol
lol 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-18T13:23:57.273

```
def do_twice(func, arg):
    """Runs a function twice.

    func: function object
    arg: argument passed to the function
    """
    func(arg)
    func(arg)

def print_twice(arg):
    """Prints the argument twice.

    arg: anything printable
    """
    print(arg)
    print(arg)

def do_four(func, arg):
    """Runs a function four times.

    func: function object
    arg: argument passed to the function
    """
    do_twice(func, arg)
    do_twice(func, arg)

do_twice(print_twice, 'spam')
print('')

do_four(print_twice, 'spam') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-20T00:34:53.637

在我看来，根据 thinkpython 书中的问题，它有四个不同的部分，因此每个部分在提供的指令方面都有不同的代码片段。第二部分将 print_twice 作为函数而不是 print_spam 。同样在第三部分中，“垃圾邮件”将是提供的论点，而不是“大声笑”。所以你可以试试这个。祝一切顺利。

这是代码

```
def do_twice(f,g):
f(g) 
f(g)

def print_twice(s):
print(s)
print(s)

do_twice(print_twice,'spam')

def do_four(do_twice,g):
do_twice(g)
do_twice(g) 
```

# google-app-engine - 在 App Engine Java 上将 Objectify 与 Google Cloud Endpoints 一起使用是否有任何注意事项？

> ID：14388973
> 
> 赞同：5
> 
> 时间：2013-01-17T22:05:08.700
> 
> 标签：google-app-engine, objectify, google-cloud-endpoints

我正在 Appengine 和 Android 上开发应用程序，并计划将 Google Cloud Endpoints 用于 API，将 GCM 用于云和移动设备之间的通信。我原本打算使用 Objectify 来实现数据持久性，但我想知道我是否会遇到意想不到的麻烦——尤其是在使用不同的注释或其他要求的情况下。有没有人有任何经验可以警告我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:06:32.627

Objectify 被认为是与 Endpoints 一起使用的受支持框架，因此如果您遇到问题，它们将被视为错误。许多值得信赖的测试人员一直在成功使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T11:35:43.093

几个月来，我一直在使用 Objectify 和 Endpoints。项目设置有点棘手，最后我放弃了使用 Eclipse Endpoint 插件，因为事实证明它很难调试。相反，我使用 Dan 的这个出色的示例[https://github.com/GoogleCloudPlatform/appengine-endpoints-helloendpoints-java-maven](https://github.com/GoogleCloudPlatform/appengine-endpoints-helloendpoints-java-maven)作为起点。使用 Eclipse 进行 Java 编码和命令行进行编译。使用 Maven 和命令行可以提供可靠和有用的反馈。使用命令 mvn help:describe -Dplugin=appengine 获取可用选项。

设置好 Maven Endpoints 项目后，将 Objectify 添加到 Maven 就很简单了。Objectify 和支持文档非常简单，并且可以很好地与 Endpoints 配合使用。我唯一遇到的问题是，如果 Keys 和 Refs 没有用 @ApiResourceProperty(ignored = AnnotationBoolean.TRUE) 注释，端点就会爆炸。

# java - 为什么即使我设置了 min idle=1 和 pending delay=max，GAE 仍会生成新实例？

> ID：14388974
> 
> 赞同：3
> 
> 时间：2013-01-17T22:05:09.700
> 
> 标签：java, google-app-engine

我有一个低负载/零星负载的应用程序，启动新实例（大约 10 秒）导致的延迟远远超过处理我的请求所需的时间，这通常在 500 毫秒内完成。

所以为了避免新实例的产生（“加载请求”）导致的延迟峰值，我做了以下两个设置：

*   设置 min idle instances = max idle instances = 1，确保始终有一个实例在运行（一个实例足以处理我的流量）；和
*   将挂起的延迟设置为 15 秒，以便 GAE 等待最多 15 秒以使一个常驻实例空闲而不是启动一个新实例。

计费已激活。但是，GAE 仍会启动新实例，从而导致无法接受的延迟。这是为什么？

在日志中我可以看到我的请求总是在不到 500 毫秒内返回；一个请求不可能排队长达 15 秒。

我能做些什么呢？非常感谢任何帮助。

**更新：**我的解决方案是设置一个每 5 分钟发出一次请求的 cron 作业，以始终运行动态实例。事实证明（见下面的答案），空闲实例是为疯狂的负载峰值保留的，而不是我 99% 的时间处于低负载场景。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T17:14:03.367

正如@koma 所说，app-engine 将创建一个动态实例以保持空闲实例的数量不变，但它不仅会创建一个新实例，而且还会立即使用它而不是平均使用空闲实例。如果您有一堆空闲实例，即使只有一个请求进来，应用引擎实际上仍然更喜欢启动动态实例，并且会“保存”空闲实例以防出现疯狂的流量高峰。

这是非常违反直觉的，因为您希望它使用已经闲置的实例来服务请求并为将来的请求启动动态实例，但这不是它的工作原理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T11:53:49.157

如果您设置 min idle instances = 1，它肯定会在第一次请求时产生另一个实例......因为不再有任何空闲实例（它正忙于处理第一个请求！）。而且既然启动了一个新实例，它还不如处理一些请求，不再空闲？

另请参阅[Google App Engine 实例不断快速关闭](https://stackoverflow.com/questions/14371920/google-app-engine-instances-keep-quickly-shutting-down)

# css - 偏移框，正确的方法来做到这一点

> ID：14388976
> 
> 赞同：0
> 
> 时间：2013-01-17T22:05:33.170
> 
> 标签：css, layout

在搜索、测试和耗尽所有 Y 方式之后......我无法弄清楚。你将如何制作整个布局下的白框？它应该包含菜单、标题和内容，但让那些“出去”而不破坏任何东西

对不起，我迷路了！....请帮忙

这是参考文件：[http ://studioteknik.ca/stackoverflow_question/offset.jpg](http://studioteknik.ca/stackoverflow_question/offset.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:08:58.433

您可以设置`margin`为某个负值。

# c++ - 找到小行星c ++的最近位置

> ID：14388978
> 
> 赞同：4
> 
> 时间：2013-01-17T22:05:39.163
> 
> 标签：c++, visual-c++

游戏小行星在圆环表面上进行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T22:09:50.510

好吧，因为你可以环绕屏幕的任何边缘，所以小行星和飞船之间总是有 4 条直线（上和左、上和右、下和左、下和右）。我只会计算每个的长度并取最小的结果。

```
int dx1 = abs(ship_x - asteroid_x);
int dx2 = screen_width - dx1;

int dy1 = abs(ship_y - asertoid_y);
int dy2 = screen_height - dy1;

// Now calculate the psuedo-distances as Pete suggests:
int psuedo1 = (dx1 * dx1) + (dy1 * dy1);
int psuedo2 = (dx2 * dx2) + (dy1 * dy1);
int psuedo3 = (dx1 * dx1) + (dy2 * dy2);
int psuedo4 = (dx2 * dx2) + (dy2 * dy2); 
```

这显示了如何计算所涉及的各种距离。将每一个映射到适当的方向有点复杂。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-17T22:08:20.920

我会推荐[A* 搜索算法](http://en.wikipedia.org/wiki/A%2a_search_algorithm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T09:27:16.170

如果你需要到小行星的最小路径，你不需要计算到它的实际最小距离。如果我理解正确，您需要最短路径而不是最短路径的长度。

我认为，这在计算上是最便宜的方法：

让流星的位置为 (Mx, My) 和船的位置 (Sx, Sy)。视口的宽度为 W，高度为 H。现在，

dx = Mx - Sx，dy = 我的 - Sy。

如果 abs(dx) > W/2（在这种情况下为 256）你的船需要向左走，如果 abs(dx) < W/2 你的船需要向右走。重要 - 如果 dx 为负数，则反转您的结果。（感谢@Toad 指出这一点！）

同样，如果 abs(dy) > H/2 ship UP，abs(dy) < H/2 ship DOWN。与 dx 一样，如果 dy 为 -ve，则翻转结果。

这考虑了包装，并且应该适用于每种情况。不涉及平方或毕达哥拉斯定理，我怀疑它可以做得更便宜。此外，如果您必须找到实际的最短距离，您现在只需应用一次（因为您已经知道需要采取四种可能路径中的哪一种）。@Peter 的帖子提供了一种优雅的方式来做到这一点，同时考虑到包装。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T22:15:06.060

找到参考船的球体。

在我的示例中避免使用小数。让 x & y = [0 ... 511] 的范围，其中 511 == 0 包装时

让中间为原点。

所以从球体和船的位置中减去 vec2(256,256)

sphere.position(-255,255) = sphere.position(1 - 256,511 - 256);

ship.position(255,-255) = ship.position(511 - 256, 1 - 256)

firstDistance(-510,510) = sphere.position(-255,255) - ship.position(255,-255)

WrapPosition(254,-254) = wrapNewPositionToScreenBounds(firstDistance(-510,510)) // 使用原点偏移量 256 下溢流/溢流

secondDistance(1,-1) = ship.position(255,-255) - WrappedPosition(254,-254)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-17T22:56:36.873

```
#include <iostream>

template<typename Scalar>
struct vector2d {
  Scalar x;
  Scalar y;
};
template<typename Scalar>
struct position2d {
  Scalar x;
  Scalar y;
};

template<typename S>
S absolute( S in ) {
  if (in < S())
    return -in;
  return in;
}

template<typename S>
S ShortestPathScalar( S ship, S rock, S wrap ) {
  S direct = rock-ship;
  S indirect = (wrap-ship) + (rock);
  if (absolute( direct ) > absolute( indirect ) ) {
    return indirect;
  }
  return direct;
}

template<typename S>
vector2d<S> ShortestPath( position2d<S> ship, position2d<S> rock, position2d<S> wrap ) {
  vector2d<S> retval;
  retval.x = ShortestPathScalar( ship.x, rock.x, wrap.x );
  retval.y = ShortestPathScalar( ship.y, rock.y, wrap.y );
  return retval;
}

int main() {
  position2d<int> world = {1000, 1000};
  position2d<int> rock = {10, 10};
  position2d<int> ship = {500, 900};
  vector2d<int> path = ShortestPath( ship, rock, world );
  std::cout << "(" << path.x << "," << path.y << ")\n";
} 
```

No point in doing crap with squaring stuff in a simple universe like that.

`Scalar` support for any type that supports `a < b`, and default construction for a zero. Like `double` or `int` or `long long`.

Note that copy/pasting the above code and handing it in as an assignment at the level of course where you are playing with that problem will get you looked at strangely. However, the algorithm should be pretty easy to follow.

# macos - 在 MonoDevelop 3.0 中排除单元测试类别

> ID：14388980
> 
> 赞同：1
> 
> 时间：2013-01-17T22:05:48.757
> 
> 标签：macos, mono, nunit, monodevelop

我有一个 .NET 项目，其中包含 2000 个用 NUnit 编写的单元测试，我想迁移到 Mono。

该项目在 Mac OS X 上使用 Mono 3.0.2/MonoDevelop 3.0.5 重新编译。我能够使用 MonoDevelop 的集成测试运行程序运行所有单元测试。

但是，我有很多标记为“LongRunning”的测试使用`TestCaseAttribute`：

```
[TestCase(1, Category="LongRunning")] 
```

但我无法使用单元测试选项（从菜单视图-> 垫-> 单元测试-> ...）排除它们。

![在此处输入图像描述](../Images/cf5c4e89d1f25054ac1ff4d3934c529e.png)

包括/排除类别选项在那里，但尝试它们没有效果。

*如何使用 MonoDevelop 测试运行程序排除 LongRunning 单元测试？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T02:25:58.453

好吧，这两个问题是分开的。这个补丁应该可以解决你的问题：

```
diff --git a/main/src/addins/NUnit/Services/NUnitAssemblyTestSuite.cs b/main/src/addins/NUnit/Services/NUnitAssemblyTestSuite.cs
index 385e50f..b2addd6 100644
--- a/main/src/addins/NUnit/Services/NUnitAssemblyTestSuite.cs
+++ b/main/src/addins/NUnit/Services/NUnitAssemblyTestSuite.cs
@@ -357,19 +357,19 @@ namespace MonoDevelop.NUnit
                        ITestFilter filter = null;
                        if (test != null) {
                                if (test is UnitTestGroup) {
-                                       filter = new TestNameFilter (CollectTests ((UnitTestGroup)test));
+                                       NUnitCategoryOptions categoryOptions = (NUnitCategoryOptions) test.GetOptions (typeof(NUnitCategoryOptions));
+                                       if (categoryOptions != null && categoryOptions.EnableFilter && categoryOptions.Categories.Count > 0) {
+                                               string[] cats = new string [categoryOptions.Categories.Count];
+                                               categoryOptions.Categories.CopyTo (cats, 0);
+                                               filter = new CategoryFilter (cats);
+                                               if (categoryOptions.Exclude)
+                                                       filter = new NotFilter (filter);
+                                       } else {
+                                               filter = new TestNameFilter (CollectTests ((UnitTestGroup)test));
+                                       }
                                } else {
                                        filter = new TestNameFilter (test.TestId);
                                }
-                       } else {
-                               NUnitCategoryOptions categoryOptions = (NUnitCategoryOptions) test.GetOptions (typeof(NUnitCategoryOptions));
-                               if (categoryOptions.EnableFilter && categoryOptions.Categories.Count > 0) {
-                                       string[] cats = new string [categoryOptions.Categories.Count];
-                                       categoryOptions.Categories.CopyTo (cats, 0);
-                                       filter = new CategoryFilter (cats);
-                                       if (categoryOptions.Exclude)
-                                               filter = new NotFilter (filter);
-                               }
                        }

                        RunData rd = new RunData (); 
```

我也有其他问题的补丁（未写入设置），但即使它不涉及序列化代码，MD 也无法读回它保存的属性。我正在调查。

# github - 链接到 GitHub 上的一行 Markdown 文件

> ID：14388983
> 
> 赞同：42
> 
> 时间：2013-01-17T22:06:04.473
> 
> 标签：github

`#L`我经常通过URI 中的参数链接到 GitHub 源代码。

例如：[https ://github.com/github/learn.github.com/blob/gh-pages/episodes.yaml#L1](https://github.com/github/learn.github.com/blob/gh-pages/episodes.yaml#L1)

但是有没有办法链接到 Markdown 文件中的行？

例如[https://github.com/github/learn.github.com/blob/gh-pages/README.md#L1](https://github.com/github/learn.github.com/blob/gh-pages/README.md#L1) *（不起作用！）*

我知道我可以链接到“部分”，但线条要好得多！

例如[https://github.com/github/learn.github.com/blob/gh-pages/README.md#learngithubcom](https://github.com/github/learn.github.com/blob/gh-pages/README.md#learngithubcom)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-09-17T06:30:17.923

由于目前不可能，我采取了下一个最佳选择：使用**责备**，然后突出显示这些行，例如[https://github.com/rails/rails/blame/master/guides/source/configuring.md#L166](https://github.com/rails/rails/blame/master/guides/source/configuring.md#L166)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2021-07-07T21:01:46.817

# 现在支持`?plain=1`

2021 年 6 月 30 日宣布，现在有一个[参数可以禁用 markdown 渲染](https://github.blog/changelog/2021-06-30-parameter-to-disable-markdown-rendering/)：

> 附加`?plain=1`到任何 Markdown 文件的 url 现在将在不渲染的情况下显示文件。与其他代码文件一样，它也会显示行号，并可用于将其他用户链接到特定的一行或多行。例如，追加`?plain=1#L52`将突出显示纯文本 Markdown 文件的第 52 行。

听起来您可能想使用行号链接到渲染文档中的某个点。这仍然是可能的，也不是 Markdown 渲染的标准功能来添加这样的行号锚点。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-07-25T12:33:05.297

为了读者的利益：长答案是**肯定**的，这很困难，但可能。

# GitHub 允许将永久链接内联到 Markdown 文件的文本部分

但是，目前似乎无法直接创建此类永久链接，您必须手动创建它们。如下：

*   显示降价文档
*   在文档上方右键单击文档的缩短**SHA**
    （您也可以使用“历史记录”和有问题的提交）
*   显示提交的差异。
*   在提交上方右键单击 3 个点`...`并选择**“查看文件”**
*   现在 Mardown 再次出现，但它是永久变体。
*   在文档上方右键单击**“Blame”**
*   向下滚动到包含要引用的文本的 Markdown 表示的行
*   **选择有问题的一行或多行**
*   **从浏览器的地址栏中**复制 URL****
***   **将 URL 粘贴**到问题等中。*   此步骤仅在问题中需要：在 URL 中**替换`/blame/`为`/blob/`****

 **在问题的预览中，您将看到预期的对 Markdown 文本部分的直接引用。

## `/blob/`-变体的缺点

如果单击 URL，您会在浏览器中看到完整的 Markdown，文本部分未按预期标记。

这是 GitHub 如何处理这些 URL 的限制。

## `/blame/`-变体的缺点

由于所有这些注释和 Markdown 的非渲染，它是完全不可读的。

## 例子

请注意，我必须克隆此示例才能创建问题：

[https://github.com/hilbix/learn.github.com/blob/gh-pages/README.md](https://github.com/hilbix/learn.github.com/blob/gh-pages/README.md)

*   单击 SHA

[https://github.com/hilbix/learn.github.com/commit/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba](https://github.com/hilbix/learn.github.com/commit/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba)

*   “查看文件”

[https://github.com/hilbix/learn.github.com/blob/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md](https://github.com/hilbix/learn.github.com/blob/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md)

*   “责备”

[https://github.com/hilbix/learn.github.com/blame/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md](https://github.com/hilbix/learn.github.com/blame/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md)

*   标记一些行

[https://github.com/hilbix/learn.github.com/blame/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md#L20-L23](https://github.com/hilbix/learn.github.com/blame/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md#L20-L23)

*   更改网址

[https://github.com/github/learn.github.com/blob/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md#L20-L23](https://github.com/github/learn.github.com/blob/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md#L20-L23)

*   将此 URL 粘贴到某个问题中

结果：[https ://github.com/hilbix/learn.github.com/issues/1](https://github.com/hilbix/learn.github.com/issues/1)

这是进入问题的：

```
https://github.com/hilbix/learn.github.com/blob/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md#L20-L23

see https://stackoverflow.com/a/57202063/490291 
```

这呈现为类似

```
learn.github.com/README.md

Lines 20 to 23 in 38034b3
    $ git clone https://github.com/github/learn.github.com
    $ cd learn.github.com
    $ script/bootstrap
    $ jekyll --server

see https://stackoverflow.com/a/57202063/490291 
```

这是所创建问题的完整 HTML（抱歉，我也没有设法复制 CSS）：

```
<td class="d-block comment-body markdown-body  js-comment-body">
          <p></p><div class="border rounded-1 my-2">
  <div class="f6 px-3 py-2 lh-condensed border-bottom bg-gray-light">
    <p class="mb-0 text-bold">
      <a href="https://github.com/hilbix/learn.github.com/blob/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba/README.md#L20-L23">learn.github.com/README.md</a>
    </p>
    <p class="mb-0 text-gray-light">
        Lines 20 to 23
      in
      <a data-pjax="true" class="commit-tease-sha" href="/hilbix/learn.github.com/commit/38034b3aee7f4fb7f46e94b3f9c2b3d3554291ba">38034b3</a>
    </p>
    </div>
    <div itemprop="text" class="blob-wrapper blob-wrapper-embedded data">
    <table class="highlight tab-size mb-0 js-file-line-container" data-tab-size="8">

        <tbody><tr class="border-0">
          <td id="L20" class="blob-num border-0 px-3 py-0 bg-white js-line-number" data-line-number="20"></td>
          <td id="LC20" class="blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line"> <span class="pl-s1">$ git clone https://github.com/github/learn.github.com</span> </td>
        </tr>

        <tr class="border-0">
          <td id="L21" class="blob-num border-0 px-3 py-0 bg-white js-line-number" data-line-number="21"></td>
          <td id="LC21" class="blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line"> <span class="pl-s1">$ <span class="pl-c1">cd</span> learn.github.com</span> </td>
        </tr>

        <tr class="border-0">
          <td id="L22" class="blob-num border-0 px-3 py-0 bg-white js-line-number" data-line-number="22"></td>
          <td id="LC22" class="blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line"> <span class="pl-s1">$ script/bootstrap</span> </td>
        </tr>

        <tr class="border-0">
          <td id="L23" class="blob-num border-0 px-3 py-0 bg-white js-line-number" data-line-number="23"></td>
          <td id="LC23" class="blob-code border-0 px-3 py-0 bg-white blob-code-inner js-file-line"> <span class="pl-s1">$ jekyll --server</span> </td>
        </tr>
    </tbody></table>
  </div>
</div>
<p></p>
<p>see <a rel="nofollow" href="https://stackoverflow.com/a/57202063/490291">https://stackoverflow.com/a/57202063/490291</a></p>
      </td>
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-07-31T18:34:53.083

我最近也在寻找同样的东西。如其他答案所述，答案是否定的。但我找到了一个很好的替代方案，它给出了我们想要的几乎相同的结果。

将文本片段添加到 url。

例如：[https ://github.com/github/balanced-employee-ip-agreement#:~:text=FAQ](https://github.com/github/balanced-employee-ip-agreement#:%7E:text=FAQ)

您只需在网址末尾附加**#:~:text={text-that-you-want-to-be-focussed}**

在此处阅读有关文本片段的更多信息。 [https://wigg.github.io/scroll-to-text-fragment/](https://wicg.github.io/scroll-to-text-fragment/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-21T19:08:39.890

简短的回答：**没有**。Markdown 由 GitHub 呈现为 HTML 文档，因此目前无法以原始形式查看它，它还允许您链接到各个行。也许 GitHub 将来某个时候会实现这种功能，但目前还不可能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-09-30T15:50:33.360

# 现在在 UI 中支持此功能

这刚刚下降：[https ://twitter.com/github/status/1443572280924147717](https://twitter.com/github/status/1443572280924147717)

1.  在您正在查看`README.md` *的目录中*单击
2.  它的 URL 如下所示：[https ://github.com/rust-lang/rust/blob/master/README.md](https://github.com/rust-lang/rust/blob/master/README.md)
3.  单击“显示源 blob”按钮： [![在此处输入图像描述](../Images/ebb32b742a4e90453960267b1aafa51b.png)](https://i.stack.imgur.com/znntq.png)
4.  URL 将更改为[https://github.com/rust-lang/rust/blob/master/README.md?plain=1](https://github.com/rust-lang/rust/blob/master/README.md?plain=1)，如[本答案中所述](https://stackoverflow.com/a/68292936/4354477)
5.  您现在可以单击行号并获取这些行的链接

仍然没有这样的按钮来为`.rst`文件执行此操作，但添加`?plain=1`到 URL 有效：[https ://github.com/python/cpython/blob/main/README.rst?plain=1](https://github.com/python/cpython/blob/main/README.rst?plain=1)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-11T11:43:46.867

当您想链接到您控制的文件中的一行时，您可以使用`<a>`：[https ://stackoverflow.com/a/6494918/5053865](https://stackoverflow.com/a/6494918/5053865)

例子：

```
<a name="your_link_name">
Some line which you want to link to
</a>

... some wall of text ...

and here you are able to link to [the line](#your_link_name) 
```

GitHub 上的示例：[https](https://github.com/evis/markdown-link-to-line) ://github.com/evis/markdown-link-to-line （在自述文件中）。

这样，您不能引用具有给定数字的行，但可以引用具有所需内容的行（这正是您经常需要的）。**

# android - 分发库无法解析为类型

> ID：14388992
> 
> 赞同：1
> 
> 时间：2013-01-17T22:06:42.673
> 
> 标签：android

我正在尝试构建从[https://github.com/openintents/shoppinglist](https://github.com/openintents/shoppinglist)导入的 OI 购物清单，我用 git 将其导入，然后进入 eclipse，我收到如下错误：distributionlibrary cannot be resolve to a type。这是我第一次尝试下载 developer.android.com 示例中的项目以外的项目。我在网上搜索，我有点卡住任何想法？

# .htaccess - 使用强制下载 在 htaccess 中

> ID：14388994
> 
> 赞同：12
> 
> 时间：2013-01-17T22:06:48.913
> 
> 标签：.htaccess

我正在尝试强制下载一个文件夹的所有文件。

页面上的链接如下所示

```
<a href="http://example.com/uploads/documents/file.pdf">Click to download</a> 
```

我的 .htaccess 中有这个片段

```
<filesMatch ".*uploads/documents.*">
    ForceType application/octet-stream
    Header set Content-Disposition attachment
</filesMatch> 
```

我已经知道标记内的 2 行有效，因为当我将 .htaccess 直接放在我想使用以下代码强制下载的文件夹中时，它就有效：

```
<Files *.*>
    ForceType application/octet-stream
    Header set Content-Disposition attachment
</Files> 
```

关于 filesMatch 标签，我似乎有些不理解。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-07-30T13:59:13.643

搜索更多信息发现此代码：

```
<FilesMatch "\.(mov|mp3|jpg|pdf|mp4|avi|wmv)$">
   ForceType application/octet-stream
   Header set Content-Disposition attachment
</FilesMatch> 
```

为我工作。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-17T22:17:57.943

请分别查看[FilesMatch](http://httpd.apache.org/docs/2.2/mod/core.html#filesmatch)和[Files](http://httpd.apache.org/docs/2.2/mod/core.html#files)的文档。它明确指出

> 本节中给出的指令将应用于具有与指定文件名匹配的基本名称（文件名的最后一个组成部分）的任何对象。

这意味着在您的示例中，它与`file.pdf`. 您的第二个示例`*.*`匹配`file.pdf`，但您的第一个示例`.*uploads/documents.*`不匹配。它实际上永远无法匹配，因为它包含一个斜杠，用作目录分隔符。

# 如果您可以编辑 apache 配置

您应该在指令中包含`<Files *.*>`或`<Files *.pdf>`（取决于您要强制下载的内容） ：`Location`

```
<Location "/uploads/documents/">
    <Files *.*>
        ForceType application/octet-stream
        Header set Content-Disposition attachment
    </Files>
</Location> 
```

# 如果您无法编辑 apache 配置

不幸的是，.htaccess 文件中不允许使用 Location 指令。`/uploads/documents/`只需在您的目录中创建一个 .htaccess 即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-12T18:47:37.957

如果您不在 `-` 文件名中使用此代码是完美的！

例如，对于 name-1.mp3，更改为 name1.mp3

```
<FilesMatch "\.(mp3|avi)$" >
    ForceType application/octet-stream
    Header add Content-Disposition "attachment"
</FilesMatch> 
```

清除浏览器并检查它。

# sql-server - 当实体框架反复打开/关闭一个连接时，它是同一个实际连接吗？

> ID：14388995
> 
> 赞同：0
> 
> 时间：2013-01-17T22:06:50.793
> 
> 标签：sql-server, entity-framework, entity-framework-4

我正在使用实体框架 4.x。当在单个业务操作中使用 Context 的单个实例重复查询数据库时，我知道 Entity Framework 会为每个查询打开和关闭数据库连接。但我的问题是，所有三个查询的连接（同样，上下文的相同实例）是否与数据库的连接相同？或者它会从连接池中获取另一个连接（可能是中毒的连接）？

示例 1：

```
var conn = (SqlConnection) ((EntityConnection) Context.Connection).StoreConnection;
conn.Open();
var A = new SqlCommand("exec SProcA", conn).ExecuteNonQuery();
conn.Close();
Thread.Sleep(100);
conn.Open();
var B = new SqlCommand("exec SProcB", conn).ExecuteNonQuery();
conn.Close();
Thread.Sleep(100);
conn.Open();
var C = new SqlCommand("exec SProcC", conn).ExecuteNonQuery();
conn.Close(); 
```

示例 2：

```
// Let Entity Framework manage my connections for me automagically.
var A = Context.TableA.First();
var B = Context.TableB.First();
var C = Context.TableC.First(); 
```

在这些场景中，A、B 和 C 是否会使用与数据库相同*的真实*连接，或者连接池是否会从我这里抽象出来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:22:48.823

经过一些测试，似乎无法确定您是否继续使用相同的连接。很多时候你会，但有时你似乎不会。可能与并发相关。最终，假设它是模棱两可的并且会改变可能是最安全的。

# ruby - 使用 ruby sqlite 在作为方法一部分的循环内插入表

> ID：14388998
> 
> 赞同：0
> 
> 时间：2013-01-17T22:06:57.210
> 
> 标签：ruby, sqlite, methods, insert

我正在努力循环通过 Ruby 方法中的“INSERT INTO”sqlite 语句。请指教。我的代码如下所示。错误消息似乎表明 Ruby 无法识别方法中的 db 对象？抱歉有点菜鸟，但我已经在互联网上搜寻了，但我找不到答案:(

```
require "sqlite3"
require "nokogiri"

begin

db = SQLite3::Database.new('RM.db')
db.execute "CREATE TABLE IF NOT EXISTS Properties(address TEXT, askingPrice TEXT)"

def get_property_list(newpage, dbname)
    resultspage = Nokogiri::HTML(open(newpage))
    details = resultspage.css("div.details.clearfix")
    count_items = details.count
    puts "there are #{count_items} items on this page"

    for i in 0..count_items-1
        address = resultspage.css("span.displayaddress")[i]
        asking_price = resultspage.css("p.price")[i]

        puts address.text
        puts asking_price.text

        dbname.execute "INSERT INTO Properties VALUES(#{address}, #{asking_price})"

    end
end

get_property_list("someurl.com", db)

    rows = db.execute("select * from Properties")
    p rows

ensure
    db.close if db
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:33:26.437

您没有在 INSERT 中引用任何一个值。您根本不应该对 SQL 使用字符串插值，使用绑定参数并始终指定列名：

```
dbname.execute 'INSERT INTO Properties (address, askingPrice) VALUES (?, ?)', address, asking_price 
```

或者你可以准备一个声明并一遍又一遍地使用它：

```
insert = dbname.prepare('INSERT INTO Properties (address, askingPrice) VALUES (?, ?)')
for i in 0..count_items-1
  #...
  insert.execute(address, asking_price)
end 
```