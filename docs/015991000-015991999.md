# StackOverflow 问答 15991000-15991999

# ios - iOS：首次运行应用程序期间的 NSUserDefaults？

> ID：15991007
> 
> 赞同：1
> 
> 时间：2013-04-13T17:56:03.360
> 
> 标签：ios, objective-c

我正在使用 NSUserDefaults 类来存储一些数据，但我在初始化方面存在正常冲突。

我是说：

在 didViewLoad 方法的 Class A 中，我设置了我的 NSUserDefaults 数据，然后在我的 Class B 中的 didViewLoad 中，我想获取我的 NSUserDefaults 数据。

我已经看到断点，在首次运行应用程序期间，应用程序的所有 didViewLoad() 都已执行，因此我想在我的 B 类的 viewDidLoad() 中为首次运行应用程序设置一个条件以避免随机数据初始化。

我们是否在 Objective-C 的框架中使用了关键字而不是使用静态变量？

例如：

ClassA--> didViewLoad():

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:kdataText forKey:@"udVariable"];

ClassB-> didViewLoad(): 
```

和：

ClassB--> didViewLoad():

```
if (!first_run){ // first_run --> KEYWORD FRAMEWORK???
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSString *var = [defaults objectForKey:@"udVariable"];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T18:00:07.750

关键是`registerDefaults`更早地调用，例如在`main`应用程序委托的`applicationDidFinishLaunching:`. 从我的一个应用程序：

```
[[NSUserDefaults standardUserDefaults] registerDefaults:
    @{@"cardMatrixRows":@4, @"cardMatrixColumns":@3}]; 
```

现在有一个默认的默认值，事件/视图控制器的顺序不再重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-20T23:46:53.200

# 斯威夫特 4：

将此代码添加到 didFinishLaunchingWithOptions 中的 AppDelegate：

`UserDefaults.standard.register(defaults: ["cardMatrixRows": NSNumber(value: 4), "cardMatrixColumns": NSNumber(value: 3)])`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T18:00:03.370

只需检查是否 `[defaults objectForKey:@"udVariable"] != nil`

您也可以使用宏#define。

# python - Python lambda 打印格式化的嵌套列表

> ID：15991010
> 
> 赞同：0
> 
> 时间：2013-04-13T17:56:21.860
> 
> 标签：python, string, list, lambda

练习几件事：lambda 函数和字符串操作。我想在不导入任何东西的情况下找到最有效的方法。

所以这是一个按字母顺序重新排序单词的简短脚本：

```
def alphabeticalOrder(word):
    lst = [l for l in word]
    return sorted(lst)

def main ():
    word = raw_input('enter word: ')
    print "".join(alphabeticalOrder(word))

if __name__ == '__main__':
    main() 
```

我想对一句话中的所有单词都这样做：

```
def alphabeticalOrder(line):
    lst = []
    for word in line.split(" "):
        lst.append(sorted(list(word)))
    print lst     # trouble here

def main ():
        line = raw_input('enter sentence: ')
        print alphabeticalOrder(line)

if __name__ == '__main__':
    main() 
```

所以我的问题是；你可以编写一个 lambda 函数来遍历嵌套列表，`lst`将每个项目打印为一个按字母顺序重新排序的单词字符串吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T17:57:31.020

列表推导在这里要容易得多：

```
' '.join([''.join(sorted(word)) for word in sentence.split()]) 
```

请注意，我们可以将字符串`sorted()` *直接*传递给.

一个 lambda 只不过是一个带有单个表达式的函数，它可以定义为一个表达式本身；在这里，我首先将 lambda 结果分配给一个变量：

```
alphabeticalWord = lambda w: ''.join(sorted(word))

' '.join([alphabeticalWord(word) for word in sentence.split()]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:00:23.737

你要这个：

```
' '.join([''.join(sorted(word)) for word in sentence.split(' ')]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T18:07:41.993

An improved version of your first approach to work for sentences:

```
def alphabeticalOrder(word):
    return "".join(sorted(lst)) #return the sorted string

def main ():
    sent = raw_input('enter sentence: ')
    print " ".join(map(alphabeticalOrder,sent.split())) #map alphabeticalOrder to each
                                                        #word in the sentence

if __name__ == '__main__':
    main() 
```

output:

```
enter sentence: foo bar spam eggs
foo abr amps eggs 
```

# android - 除非我两次调用侦听器，否则 onReceive() 中的 LocationManager 不会定位，但第一次调用定位，第二次调用不使用新位置

> ID：15991012
> 
> 赞同：0
> 
> 时间：2013-04-13T17:56:29.577
> 
> 标签：android, gps, location, locationmanager

我承认我对 android 比较陌生，我来自 python 和 C++。帮助将不胜感激。我只是从广播接收器 onReceive 调用位置更新，这样我就可以给我的设备发短信并接收它的位置，在那个时刻更新。

我发现我可以调用位置来发送文本，但它不会更新位置，它只是给出最后一次知道的。如果我两次调用 requestLocationUpdates，它似乎使用设备上的 GPS 图标进行定位，但是对 requestLocationUpdates 的第二次调用不使用更新的位置，它使用的是旧位置。如果我不调用 requestLocationUpdates 两次，它甚至不会更新（并且没有 GPS 图标闪烁确认这一点。）这是我的代码，对 requestLocationUpdates 的第一个冗余调用被注释掉了。
我知道代码不是很漂亮（就像 Thread.sleep 一样，我打算在更新工作后将其删除。请原谅那些临时位。有人可以帮助我吗，代码应该在逻辑上做我想要的，但是逻辑似乎不适用于这个..：

 `````
package com.JT.appNew01;
import java.util.ArrayList;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.telephony.SmsManager;
import android.telephony.gsm.SmsMessage;
import android.widget.Toast;
import android.location.GpsStatus;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.location.Geocoder;
import android.os.Bundle;
import android.view.Gravity;
import android.view.View;
import android.view.View.OnClickListener;
public class SmsReceiverXxx extends BroadcastReceiver{
    public static final String COMMAND = "SENDER";
    public static final int SENDER_ACT_DOCUMENT = 0;
    public static final int SENDER_SRV_POSITIONING = 1;
    public static final int MIN_TIME_REQUEST = 5 * 1000;
    public static final String ACTION_REFRESH_SCHEDULE_ALARM =
            "com.JT.appNew01.ACTION_REFRESH_SCHEDULE_ALARM";
    private static Location currentLocation;//was private static
    private static Location prevLocation;//was private static
    private static Context _context;
    private String provider = LocationManager.GPS_PROVIDER;
    private static Intent _intent;
    private static LocationManager locationManager;//was private static
    //I ADDED FOR FIRST PASS THE FOLLOWING:
    private LocationListener locList=new LocationListener(){
        @Override
        public void onLocationChanged(Location location) {
            // TODO Auto-generated method stub
            try {
                gotLocation(location);
            } catch (Exception e) {
            }
        }
        @Override
        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub
        }
        @Override
        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub
        }
        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub
            try {
                String strStatus = "";
                switch (status) {
                case GpsStatus.GPS_EVENT_FIRST_FIX:
                    strStatus = "GPS_EVENT_FIRST_FIX";
                    break;
                case GpsStatus.GPS_EVENT_SATELLITE_STATUS:
                    strStatus = "GPS_EVENT_SATELLITE_STATUS";
                    break;
                case GpsStatus.GPS_EVENT_STARTED:
                    strStatus = "GPS_EVENT_STARTED";
                    break;
                case GpsStatus.GPS_EVENT_STOPPED:
                    strStatus = "GPS_EVENT_STOPPED";
                    break;
                default:
                    strStatus = String.valueOf(status);
                    break;
                }
            } catch (Exception e) {
                                e.printStackTrace();
            }
        }
        };// I ADDED THIS TO GO WITH FIRST PASS!!!!!
    private static LocationListener locationListener = new LocationListener(){//was private static
        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
            try {
                String strStatus = "";
                switch (status) {
                case GpsStatus.GPS_EVENT_FIRST_FIX:
                    strStatus = "GPS_EVENT_FIRST_FIX";
                    break;
                case GpsStatus.GPS_EVENT_SATELLITE_STATUS:
                    strStatus = "GPS_EVENT_SATELLITE_STATUS";
                    break;
                case GpsStatus.GPS_EVENT_STARTED:
                    strStatus = "GPS_EVENT_STARTED";
                    break;
                case GpsStatus.GPS_EVENT_STOPPED:
                    strStatus = "GPS_EVENT_STOPPED";
                    break;
                default:
                    strStatus = String.valueOf(status);
                    break;
                }
            } catch (Exception e) {
                                e.printStackTrace();
            }
        }
        @Override
        public void onProviderEnabled(String provider) {
        }
        @Override
        public void onProviderDisabled(String provider) {
        }
        @Override
        public void onLocationChanged(Location location) {
            try {
                gotLocation(location);
            } catch (Exception e) {
            }
        }
    };
        @Override
        public void onReceive(final Context context, Intent intent) 
        {
            SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);
            String valuephn=sharedPrefs.getString("welcome_message", "NULL");
            int zz = 0;
            int MAX_SMS_MESSAGE_LENGTH = 160; 
            Bundle bundle = intent.getExtras();        
            SmsMessage[] msgs = null;
            String str = "";    
            Object[] pdus = (Object[]) bundle.get("pdus"); 
            msgs = new SmsMessage[pdus.length];
            if (bundle != null)
            {
              try {
                for (int i=0; i<msgs.length; i++){
                    msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);                
                    str += "Map Trax - Location: " + msgs[i].getOriginatingAddress();                     
                    str += " :";
                    str += msgs[i].getMessageBody().toString();
                    str += "\n";   
                    zz=i;
                }
                   } catch (Exception e){
                         e=e;
                     }
                SmsManager sms = SmsManager.getDefault();
                PendingIntent pendingIntent = null;
                //String xyzx = msgs[zz].getOriginatingAddress();
                String xyzx="a";             // TEMPORARY FOR SKYPE!!! USE LINE ABOVE!!!
                // FIRST PASS TRY TO GET COORDS:
                //try{
                //  //if ( xyzx.contains(valuephn) ) {
                //  if ( xyzx.contains("a") ) {                // TEMPORARY FOR SKYPE!!! USE LINE ABOVE!!!
                //      _context = context;
                //      _intent = intent;
                //      locationManager = (LocationManager) context
                //              .getSystemService(Context.LOCATION_SERVICE);
                //      if (locationManager.isProviderEnabled(provider)) {
                //          locationManager.requestLocationUpdates(provider, MIN_TIME_REQUEST,
                //                  5, locList);            
                //         
                //          Location gotLoc = locationManager.getLastKnownLocation(provider);
                //          gotLocation(gotLoc);
                //          pauseOne();
                //          pauseTwo();
                //          pauseThree();
                //          pauseFour();
                //          pauseFive();
                //          pauseOne();
                //          pauseTwo();
                //          pauseThree();
                //          pauseFour();
                //          pauseFive();
                //          pauseOne();
                //          pauseTwo();
                //          pauseThree();
                //          pauseFour();
                //          pauseFive();
                //          OnNewLocationReceived(gotLoc);//JUST ADDED!!!
                //          stopLocationListener();//JUST ADDED!!!
                //         
                //
                //      } else {
                //          Location gotLoc2 = locationManager.getLastKnownLocation(provider);
                //          pauseOne();
                //          pauseTwo();
                //          pauseThree();
                //          pauseFour();
                //          pauseFive();
                //          pauseOne();
                //          pauseTwo();
                //          pauseThree();
                //          pauseFour();
                //          pauseFive();
                //          pauseOne();
                //          pauseTwo();
                //          pauseThree();
                //          pauseFour();
                //          pauseFive();
                //          OnNewLocationReceived(gotLoc2);//JUST ADDED!!!
                //          stopLocationListener();//JUST ADDED!!!
                //      }
                //  }}catch(Exception zzz){}
                // END FIRST PASS.
                try{
                //if ( xyzx.contains(valuephn) ) {
                if ( xyzx.contains("a") ) {                // TEMPORARY FOR SKYPE!!! USE LINE ABOVE!!!
                    _context = context;
                    _intent = intent;
                    locationManager = (LocationManager) context
                            .getSystemService(Context.LOCATION_SERVICE);
                    if (locationManager.isProviderEnabled(provider)) {
                        locationManager.requestLocationUpdates(provider, MIN_TIME_REQUEST,
                                5, locationListener);           

                        Location gotLoc = locationManager.getLastKnownLocation(provider);
                        gotLocation(gotLoc);
                        pauseOne();
                        pauseTwo();
                        pauseThree();
                        pauseFour();
                        pauseFive();
                        pauseOne();
                        pauseTwo();
                        pauseThree();
                        pauseFour();
                        pauseFive();
                        pauseOne();
                        pauseTwo();
                        pauseThree();
                        pauseFour();
                        pauseFive();
                        OnNewLocationReceived(gotLoc);//JUST ADDED!!!
                        stopLocationListener();//JUST ADDED!!!
                    } else {
                        Location gotLoc2 = locationManager.getLastKnownLocation(provider);
                        pauseOne();
                        pauseTwo();
                        pauseThree();
                        pauseFour();
                        pauseFive();
                        pauseOne();
                        pauseTwo();
                        pauseThree();
                        pauseFour();
                        pauseFive();
                        pauseOne();
                        pauseTwo();
                        pauseThree();
                        pauseFour();
                        pauseFive();
                        OnNewLocationReceived(gotLoc2);//JUST ADDED!!!
                        stopLocationListener();//JUST ADDED!!!
                    }
                //sms.sendTextMessage(valuephn,"", "Map Trax - GPS Co-ordinates:"+locationStringFromLocation(null).toString()+" - Map: http://maps.google.com/?q="+locationStringFromLocation(null).toString(),pendingIntent,pendingIntent);
                    Toast.makeText(context, "1: "+locationStringFromLocation(null).toString(), Toast.LENGTH_SHORT).show();
                    locationManager.removeUpdates(locationListener);
                }
                }catch(Exception zzz){
                    try{
                        if ( xyzx.contains("a") ) {
                            //sms.sendTextMessage(valuephn,"", "Map Trax - GPS Co-ordinates:"+locationStringFromLocation2(null).toString()+" - Map: http://maps.google.com/?q="+locationStringFromLocation2(null).toString(),pendingIntent,pendingIntent);
                            Toast.makeText(context, "2: "+locationStringFromLocation2(null).toString(), Toast.LENGTH_SHORT).show();
        locationManager.removeUpdates(locationListener);
                           }
                    }catch(Exception zzzz){
                        //sms.sendTextMessage(valuephn,"","Location currently unavailable",pendingIntent,pendingIntent);
                        Toast.makeText(context, "Location currently unavailable", Toast.LENGTH_SHORT).show();
                        locationManager.removeUpdates(locationListener);
                    }
                }
                };
        }
        private void pauseFive() {
            // TODO Auto-generated method stub
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        private void pauseFour() {
            // TODO Auto-generated method stub
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        private void pauseThree() {
            // TODO Auto-generated method stub
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        private void pauseTwo() {
            // TODO Auto-generated method stub
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        private void pauseOne() {
            // TODO Auto-generated method stub
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        public static String locationStringFromLocation(final Location location) {//was public static
            return String.format("%.3f,%.3f", currentLocation.getLatitude(), currentLocation.getLongitude());
        }
        public static String locationStringFromLocation2(final Location location) {//was public static
            return String.format("%.3f,%.3f", prevLocation.getLatitude(), prevLocation.getLongitude());
        }
        private static void gotLocation(Location location) {//was public static
            prevLocation = currentLocation == null ?
                    null : new Location(currentLocation);
            currentLocation = location;
            if (isLocationNew()) {
                OnNewLocationReceived(location);
                //Toast.makeText(_context, "new location saved", Toast.LENGTH_SHORT)
                //        .show();
                stopLocationListener();
            }
        }
        private static boolean isLocationNew() {//was public static
            if (currentLocation == null) {
                return false;
            } else if (prevLocation == null) {
                return true;
            } else if (currentLocation.getTime() == prevLocation.getTime()) {
                return false;
            } else {
                return true;
            }
        }
        public static void stopLocationListener() {//was public static
            locationManager.removeUpdates(locationListener);
        }
        static ArrayList<OnNewLocationListener> arrOnNewLocationListener =
                new ArrayList<OnNewLocationListener>();
        public static void setOnNewLocationListener(
                OnNewLocationListener listener) {
            arrOnNewLocationListener.add(listener);
        }
        public static void clearOnNewLocationListener(
                OnNewLocationListener listener) {
            arrOnNewLocationListener.remove(listener);
        }
        // This function is called after the new point received
        private static void OnNewLocationReceived(Location location) {
            // Check if the Listener was set, otherwise we'll get an Exception when
            // we try to call it
            if (arrOnNewLocationListener != null) {
                // Only trigger the event, when we have any listener
                for (int i = arrOnNewLocationListener.size() - 1; i >= 0; i--) {
                    arrOnNewLocationListener.get(i).onNewLocationReceived(
                            location);
                }
            }
        }
} 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:09:50.947

You have to write a service to update location and start that service when your broadcast receiver received the Sms.

BroadcastReceiver document

**Receiver Lifecycle**

A BroadcastReceiver object is only valid for the duration of the call to onReceive(Context, Intent). Once your code returns from this function, the system considers the object to be finished and no longer active.

This has important repercussions to what you can do in an onReceive(Context, Intent) implementation: anything that requires asynchronous operation is not available, because you will need to return from the function to handle the asynchronous operation, but at that point the BroadcastReceiver is no longer active and thus the system is free to kill its process before the asynchronous operation completes.

In particular, you may not show a dialog or bind to a service from within a BroadcastReceiver. For the former, you should instead use the NotificationManager API. For the latter, you can use Context.startService() to send a command to the service.``

# perl - 如何绑定到 Mojolicious 中按钮的 onclick 事件？

> ID：15991016
> 
> 赞同：1
> 
> 时间：2013-04-13T17:56:40.377
> 
> 标签：perl, onclick, mojolicious, event-driven

我正在尝试制作一个小型 web 应用程序来控制我使用的命令行音乐播放器（mocp），但是当用户按下页面上的按钮时，我无法点击路由。我预计问题与我缺乏 HTML 有关。

代码：

```
#!/usr/bin/perl
use Mocp;
use Mojolicious::Lite;

my $mocp = Mocp->new;

for my $action ( qw( play pause stop next previous unpause toggle-pause server ) ) {
    get $action => sub {
        my $self = shift;
        $mocp->$action;
        $self->render( 'controls' );
    };
}

get '/' => sub { shift->render( 'controls' ) };
app->start;

__DATA__

@@ controls.html.ep 

%= input_tag 'play', type => 'button', value => 'Play'
%= input_tag 'pause', type => 'button', value => 'Pause'
%= input_tag 'volup', type => 'button', value => 'Volume Up'
%= input_tag 'voldown', type => 'button', value => 'Volume Down'
%= input_tag 'toggle', type => 'button', value => 'Toggle'
%= input_tag 'next', type => 'button', value => '>>'
%= input_tag 'previous', type => 'button', value => '<<' 
```

如果我直接导​​航到路线（例如“/play”），一切都会按预期进行。目标是简单地单击“播放”按钮来执行相关的方法，而不必手动输入路线。我在这个阶段的问题是：

1.  将这些方法映射到路由是解决此问题的最佳方法吗？
2.  如果是这样，我如何像在 JavaScript 中一样触发带有“onclick”按钮事件的路由？

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:12:54.940

在客户端使用 jQuery，您可以使用[$.get()](http://api.jquery.com/jQuery.get/)函数触发路由

```
%= input_tag 'play', type=>'button', value=>'Play', onclick=>"$.get('/play')" 
```

或者

```
<input type="button" value="Play" onclick="$.get('/play');"> 
```

要使用 jQuery，您必须将以下行添加到您的模板中

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
</script> 
```

# vb.net - 从当前用户桌面移动文件？

> ID：15991020
> 
> 赞同：0
> 
> 时间：2013-04-13T17:56:57.343
> 
> 标签：vb.net

我正在为我制作的某个程序制作安装程序，我想知道是否可以将包含当前用户桌面内容的文件夹复制到另一个区域，我该怎么做？我正在使用：`My.Computer.FileSystem.MoveFile("", "")`

将文件夹“Emailer”（在桌面上）移动到系统文件（x86）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:02:57.290

要访问桌面的路径，请使用：

```
Environment.GetFolderPath(Environment.SpecialFolder.Desktop) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:21:46.037

获得桌面位置后（正如 Garath 在他的回答中指出的那样），检查System.IO 命名空间中的*File.Move*。例如

```
File.Move(path, path2); 
```

[http://msdn.microsoft.com/en-us/library/system.io.file.move.aspx](http://msdn.microsoft.com/en-us/library/system.io.file.move.aspx)

# animation - XNA 边界球不会显示在正确的位置

> ID：15991021
> 
> 赞同：1
> 
> 时间：2013-04-13T17:56:58.330
> 
> 标签：animation, xna

我试图让边界球为我的模型正确显示，这样我就可以看到在进行碰撞测试时发生了什么。我无法让边界球在正确的位置绘制。模型看起来不错。我相信问题出在边界球的转换步骤中。球体本身是一个简单的 .x 文件，半径为 1 个单位（在 boundingSphereModel 中）。然后我将它缩放到实际网格的边界球半径。我确实有具有不同半径的球体，但它们都显示在玩家脚下而不是身体各个部位上。我究竟做错了什么？

这是我的代码：

```
private void drawPlayer(Matrix viewMatrix, Player player)
{
    SkinnedModel skinnedModel = player.getModel();
    Matrix[] boneTransforms = new Matrix[skinnedModel.Model.Bones.Count];
    skinnedModel.Model.CopyAbsoluteBoneTransformsTo(boneTransforms);

    Matrix transformationMatrix = player.getWorldTransformation();
    foreach (ModelMesh modelMesh in player.getMeshes())
    {
        if (drawBoundingSpheres)
        {
            int boneIndex = modelMesh.ParentBone.Index;
            Matrix boneTransform = boneTransforms[boneIndex];

            GraphicsDevice.RenderState.FillMode = FillMode.WireFrame;
            Matrix scaleMatrix = Matrix.CreateScale(modelMesh.BoundingSphere.Radius);
            Matrix worldMatrix = scaleMatrix * boneTransform * transformationMatrix;

            // loop through all bounding sphere's meshes, transforming & drawing them
            foreach (ModelMesh boundingSphereModelMesh in boundingSphereModel.Meshes)
            {
                foreach (ModelMeshPart meshPart in boundingSphereModelMesh.MeshParts)
                {
                    BasicEffect basicEffect = (BasicEffect)meshPart.Effect;

                    basicEffect.World = worldMatrix;
                    basicEffect.View = viewMatrix;
                    basicEffect.Projection = cameraProjection;

                    // configure lighting
                    basicEffect.AmbientLightColor = new Vector3(0.1f);
                }
                boundingSphereModelMesh.Draw();
            }
            // done with bounding spheres; switch back to solid fill mode
            GraphicsDevice.RenderState.FillMode = FillMode.Solid;
        }

        // draw model mesh
        foreach (ModelMeshPart meshPart in modelMesh.MeshParts)
        {
            SkinnedModelBasicEffect basicEffect = (SkinnedModelBasicEffect)meshPart.Effect;

            basicEffect.World = transformationMatrix;
            basicEffect.Bones = player.getBones();
            basicEffect.View = viewMatrix;
            basicEffect.Projection = cameraProjection;

            basicEffect.Material.EmissiveColor = new Vector3(0.0f);
            basicEffect.Material.DiffuseColor = new Vector3(0.8f);
            basicEffect.Material.SpecularColor = new Vector3(0.3f);
            basicEffect.Material.SpecularPower = 8;
            basicEffect.NormalMapEnabled = false;
            basicEffect.SpecularMapEnabled = false;

            // configure lighting
            basicEffect.AmbientLightColor = new Vector3(0.1f);
            basicEffect.LightEnabled = true;
            basicEffect.EnabledLights = EnabledLights.Four;
            basicEffect.PointLights[0].Color = LIGHT_COLOR;
            basicEffect.PointLights[0].Position = COLOR0_POSITION;
            basicEffect.PointLights[1].Color = LIGHT_COLOR;
            basicEffect.PointLights[1].Position = COLOR1_POSITION;
            basicEffect.PointLights[2].Color = LIGHT_COLOR;
            basicEffect.PointLights[2].Position = COLOR2_POSITION;
            basicEffect.PointLights[3].Color = LIGHT_COLOR;
            basicEffect.PointLights[3].Position = COLOR3_POSITION;
        }

        modelMesh.Draw();
    }
} 
```

# sql - 尝试使用 LINQ to SQL 从表中删除数据时出错

> ID：15991023
> 
> 赞同：0
> 
> 时间：2013-04-13T17:57:02.173
> 
> 标签：sql, vb.net, linq

在 LINQ 中，我试图编写一个查询，一旦单击按钮，就会从数据库表中删除一条记录，即“Amendments_Awaiting_Approval”。将根据在文本框中输入的值找到并删除该行。到目前为止我有这个：'你的输入字符串

```
Dim parseRef As String = txtReferenceCode.Text

'Convert string to integer value '
Dim deleteRecord As Integer = Integer.Parse(parseRef)

' Query the database for the rows to be deleted. '
Dim deleteModuleChanges = _
    From amendments In db.Amendments_Awaiting_Approvals _
    Where amendments.Amendments_ID = deleteRecord _
    Select amendments

For Each amendment As Amendments_Awaiting_Approval In deleteModuleChanges()
    db.OrderDetails.DeleteOnSubmit(detail)
Next 
```

此段不工作。该页面甚至不会加载，当我将鼠标悬停在 deleteModuleChanges() 部分时，我收到错误“重载解析失败，因为没有可访问的 ElementAtOrDefault 接受此数量的参数”

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:37:14.177

`deleteModuleChanges`是`IEnumerable`，所以当你添加`()`到它时，VB.NET 编译器尝试`ElementAtOrDefault`在该集合上触发扩展方法，没有参数就无法完成。试试那个：

```
For Each amendment As Amendments_Awaiting_Approval In deleteModuleChanges
    db.OrderDetails.DeleteOnSubmit(detail)
Next 
```

但是，我不知道您为什么要迭代`amendment`，而是 delete `detail`。你确定那是你想做的吗？

当然，您必须提交更改：

```
db.SubmitChanges() 
```

# java - 显示 gif 动画

> ID：15991027
> 
> 赞同：0
> 
> 时间：2013-04-13T17:57:07.123
> 
> 标签：java, android, gif

好的，首先让我说我在互联网上到处搜索，甚至在这里，我找不到答案，所以我没有代码可以显示。我只是想在一个一直在播放的应用程序中制作一个gif动画，我该怎么做，SurfaceView，Movie，什么？请用示例代码解释我

PS 正如我所说，我到处搜索！所以请，如果您要向我发送警告或其他内容，请删除我的线程.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:45:57.307

我做到了，而不是 animation = (AnimationDrawable) img.getBackground(); 应该是动画 = (AnimationDrawable) img.getDrawable();

奇怪的是，在[http://developer.android.com/guide/topics/graphics/drawable-animation.html](http://developer.android.com/guide/topics/graphics/drawable-animation.html)的 Android 文档中， 这个例子是用 getBackground ......有人知道为什么吗？

# macos - 为什么我不能在不同的分叉进程中使用可可框架？

> ID：15991036
> 
> 赞同：1
> 
> 时间：2013-04-13T17:58:10.350
> 
> 标签：macos, cocoa, audio, fork, bsd

我正在与`NSSound`班级一起玩，以在我自己的后台进程中播放声音，以免阻止用户输入。我决定打电话`fork()`，但这给我带来了问题。在分配声音的那一刻，分叉的进程崩溃了。有趣的是，如果我构建一个只调用的示例`fork()`，那么子进程可以`NSSound`毫无问题地调用，只有当我在调用*之前*`fork()`尝试使用其他可可 API 时才会出现崩溃。请参阅带有`crashme?()`注释的调用的示例：

```
#import <AppKit/AppKit.h>
#import <math.h>

#define FILENAME \
    "/System/Library/Components/CoreAudio.component/" \
    "Contents/SharedSupport/SystemSounds/dock/drag to trash.aif"

void crashme1(void)
{
    NSString *path = [[NSString alloc] initWithUTF8String:"false file"];
    NSSound *sound = [[NSSound alloc]
        initWithContentsOfFile:path byReference:YES];
}

void crashme2(void)
{
    NSInteger tag = 0;
    [[NSWorkspace sharedWorkspace]
        performFileOperation:NSWorkspaceRecycleOperation
        source:@"." destination:nil
        files:[NSArray arrayWithObject:@"false file"] tag:&tag];
}

double playAif(void)
{
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSString *path = [[NSString alloc] initWithUTF8String:FILENAME];
    NSSound *sound = [[NSSound alloc]
        initWithContentsOfFile:path byReference:YES];
    [path release];

    if (!sound) {
        [pool release];
        return -1;
    }

    const double ret = [sound duration];
    [sound play];
    [sound autorelease];
    [pool release];
    return ret;
}

int main(int argc, char *argv[])
{
    //crashme1();
    //crashme2();
    int childpid = fork();
    if (0 == childpid)  {
        printf("Starting playback\n");
        double wait = playAif();
        sleep(ceil(wait));
        wait = playAif();
        sleep(ceil(wait));
        printf("Finished playback\n");
    }
    return 0;
} 
```

当我从命令行运行它时，它可以工作，但是如果我取消注释对任一`crashme?()`函数的调用之一，则分叉进程中的播放永远不会开始。是不是因为任何 Cocoa 框架 API 都不是[异步信号](https://stackoverflow.com/questions/8676371/can-i-call-chdir-or-setenv-after-fork-on-mac-os-x)安全的？有没有办法通过以某种方式包装它们来使调用异步信号安全？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T19:08:09.980

我将引用 Leopard CoreFoundation 框架发行说明。我不知道他们是否仍然在线，因为 Apple 倾向于替换而不是扩展 Core Foundation 的发行说明。

> ### CoreFoundation 和 fork()
> 
> 由于 fork() 的行为，CoreFoundation 不能用于 fork() 的子端。如果您 fork()，则必须在其后调用某种 exec*()，并且不应在 exec*() 之前在子级中使用 CoreFoundation API。这适用于所有使用 CoreFoundation 的高级 API，由于您无法知道这些高级 API 在做什么，以及它们是否使用 CoreFoundation API，因此您也不应该使用任何高级 API。这包括使用 daemon() 函数。
> 
> 此外，根据 POSIX，只有 async-cancel-safe 函数可以安全地在 fork() 的子端使用，因此即使使用较低级别的 libSystem/BSD/UNIX API 也应保持在最低限度，理想情况下仅使用 async -取消安全功能。
> 
> 这一直是正确的，过去在各种 Cocoa 开发人员邮件列表中都对此进行了说明。但是 CoreFoundation 现在正在采取一些更强有力的措施来“强制执行”这个限制，所以我们认为添加一个发布说明来指出这一点也是值得的。当某些东西使用在 fork() 之后在 CoreFoundation 中肯定不安全的 API 时，会向 stderr 写入一条消息。但是，如果文件描述符 2 已关闭，您将不会收到任何消息或通知，这太糟糕了。我们试图让进程以一种非常容易识别的方式终止，并且做了一段时间，这非常方便，但是向后二进制兼容性阻止了我们这样做。

换句话说，`fork()`除了执行一个新程序之外，在 a 的子端做很多事情从来都不是安全的。

除了一般的 POSIX 禁令之外，一个经常提到的解释是：a) 现在几乎所有的 Cocoa 程序都是多线程的，比如 GCD 等等。B) 当你 时`fork()`，只有调用线程存活到子进程中；其他线程就消失了。由于这些线程可能一直在操纵共享资源，因此子进程不能依赖于具有健全的状态。例如，`malloc()`实现可能有一个锁来保护共享结构，并且该锁可能在`fork()`. 因此，如果剩余线程尝试分配内存，它可能会无限期挂起。其他共享数据结构可能只是处于损坏状态。等等。

# c# - 如何在新进程中启动form2？

> ID：15991038
> 
> 赞同：4
> 
> 时间：2013-04-13T17:58:14.930
> 
> 标签：c#, .net, winforms, process, exe

我有一个有两个表单的项目，我需要在一个新进程中启动 form2，我该怎么做？我知道有

```
Form2 f2 = new Form2();
f2.Show();
this.Hide(); 
```

但在这种情况下，这对我不利。我需要开始一个新进程（作为另一个 .exe 文件）。

那么无论如何我该怎么做呢？

**[更新]**

我忘了告诉你我需要向 form2 传递一些信息，比如

```
Form2 f2 = new Form2(someInformation);
f2.Show();
this.Hide(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T18:00:09.933

您可以在一个单独的项目中创建您的 Form2 并通过以下方式调用构建的 exe 文件

```
System.Diagnostics.Process.Start("Form2.exe"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:10:20.727

如果您的意思是一个新线程，请执行以下操作：

```
 var secondFormThread = new Thread(() => Application.Run(new Form(someInformation)));

 this.Hide();                       // Hide the current form

 secondFormThread .Start();         // now show the other one in a new thread
 secondFormThread .WaitForExit();   // wait for this thread to finish or
                                    // maybenot, may add a timeout. Whatever 
                                    // suits your needs.

 this.Show();                       // Show the first form again 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-17T05:23:54.687

创建表单的实例并将其显示在单独的线程中。

```
new Thread(() => {
    Form2 f2 = new Form2(someInformation);
    f2.ShowDialog();
}).Start(); 
```

# javascript - 如何在新的div中附加li

> ID：15991040
> 
> 赞同：1
> 
> 时间：2013-04-13T17:58:26.670
> 
> 标签：javascript, jquery, html, css, list

我有一个这样的 HTML 标记：

```
<ul>
    <li>Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
    <li>Item 4</li>
    <li>Item 5</li>
    <li>Item 6</li>
    <li>Item 7</li>
    <li>Item 8</li>
</ul> 
```

如何将上面的 HTML 转换为：

```
<div class="main"><ul><li>Item 1</li><li>Item 2</li></ul></div>

<div class="main"><ul><li>Item 3</li><li>Item 4</li></ul></div>

<div class="main"><ul><li>Item 5</li><li>Item 6</li></ul></div>

<div class="main"><ul><li>Item 7</li><li>Item 8</li></ul></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:03:24.927

你可以这样做：

```
$('ul > li:nth-child(2n-1)').each(function() {
    $(this).next().add(this).wrapAll('<div class="main"><ul></ul></div>');
}).eq(0).closest('div').unwrap(); 
```

`**[Working Demo](http://jsfiddle.net/B9bA7/)**`

# javascript - 如何访问fineuploader参数onComplete函数？

> ID：15991042
> 
> 赞同：1
> 
> 时间：2013-04-13T17:58:32.497
> 
> 标签：javascript, fine-uploader

```
 manualuploader.fineUploader('setParams', {
        foo: bar
      });

  var manualuploader = $('#manual-fine-uploader').fineUploader({
    .
    .
    .

  })
  .on('submit', function(event, id, name) {
    .
    .

  }).on('complete', function(event, id, fileName, responseJSON) {

   // HOW CAN I ACCESS TO foo -parameter HERE?

    }
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:03:09.533

该`responseJSON`参数将包括在您的服务器对上传请求的响应中返回的所有键和值。该`setParams`函数用于将上传请求中的参数发送到您的服务器。如果出于某种原因，您想让这些相同的值可用于您的`complete`回调，只需将它们包含在服务器的响应中即可。

# javascript - iOS 用 Ja vascriptCore 实现“window.setTimeout”

> ID：15991044
> 
> 赞同：6
> 
> 时间：2013-04-13T17:58:42.070
> 
> 标签：javascript, iphone, ios, javascriptcore

我在 iOS 应用程序中使用 JavaScriptCore 库，我正在尝试实现 setTimeout 函数。

```
setTimeout(func, period) 
```

启动应用程序后，将创建具有全局上下文的 JSC 引擎，并将两个函数添加到该上下文中：

```
_JSContext = JSGlobalContextCreate(NULL);

[self mapName:"iosSetTimeout" toFunction:_setTimeout];
[self mapName:"iosLog" toFunction:_log]; 
```

这是将具有所需名称的全局 JS 函数映射到静态目标 C 函数的本机实现：

```
- (void) mapName:(const char*)name toFunction:(JSObjectCallAsFunctionCallback)func
{
  JSStringRef nameRef = JSStringCreateWithUTF8CString(name);
  JSObjectRef funcRef = JSObjectMakeFunctionWithCallback(_JSContext, nameRef, func);
  JSObjectSetProperty(_JSContext, JSContextGetGlobalObject(_JSContext), nameRef, funcRef, kJSPropertyAttributeNone, NULL);
  JSStringRelease(nameRef);
} 
```

这是目标C setTimeout 函数的实现：

```
JSValueRef _setTimeout(JSContextRef ctx,
                     JSObjectRef function,
                     JSObjectRef thisObject,
                     size_t argumentCount,
                     const JSValueRef arguments[],
                     JSValueRef* exception)
{
  if(argumentCount == 2)
  {
    JSEngine *jsEngine = [JSEngine shared];
    jsEngine.timeoutCtx =  ctx;
    jsEngine.timeoutFunc = (JSObjectRef)arguments[0];
    [jsEngine performSelector:@selector(onTimeout) withObject:nil afterDelay:5];
  }
  return JSValueMakeNull(ctx);
} 
```

延迟一段时间后应该在 jsEngine 上调用的函数：

```
- (void) onTimeout
{
  JSValueRef excp = NULL;
  JSObjectCallAsFunction(timeoutCtx, timeoutFunc, NULL, 0, 0, &excp);
  if (excp) {
    JSStringRef exceptionArg = JSValueToStringCopy([self JSContext], excp, NULL);
    NSString* exceptionRes = (__bridge_transfer NSString*)JSStringCopyCFString(kCFAllocatorDefault, exceptionArg);  
    JSStringRelease(exceptionArg);
    NSLog(@"[JSC] JavaScript exception: %@", exceptionRes);
  }
} 
```

用于 javascript 评估的本机函数：

```
- (NSString *)evaluate:(NSString *)script
{
    if (!script) {
        NSLog(@"[JSC] JS String is empty!");
        return nil;
    }

    JSStringRef scriptJS = JSStringCreateWithUTF8CString([script UTF8String]);
    JSValueRef exception = NULL;

    JSValueRef result = JSEvaluateScript([self JSContext], scriptJS, NULL, NULL, 0, &exception);
    NSString *res = nil;

    if (!result) {
        if (exception) {
            JSStringRef exceptionArg = JSValueToStringCopy([self JSContext], exception, NULL);
            NSString* exceptionRes = (__bridge_transfer NSString*)JSStringCopyCFString(kCFAllocatorDefault, exceptionArg);

            JSStringRelease(exceptionArg);
            NSLog(@"[JSC] JavaScript exception: %@", exceptionRes);
        }

        NSLog(@"[JSC] No result returned");
    } else {
        JSStringRef jstrArg = JSValueToStringCopy([self JSContext], result, NULL);
        res = (__bridge_transfer NSString*)JSStringCopyCFString(kCFAllocatorDefault, jstrArg);

        JSStringRelease(jstrArg);
    }

    JSStringRelease(scriptJS);

    return res;
} 
```

在整个设置之后，JSC 引擎应该评估这个：

```
[jsEngine evaluate:@"iosSetTimeout(function(){iosLog('timeout done')}, 5000)"]; 
```

JS执行调用native `_setTimeout`，五秒后调用native， `onTimeout`crash发生在`JSObjectCallAsFunction`. `timeoutCtx`变为无效。听起来超时函数上下文是本地的，并且在此期间垃圾收集器会在 JSC 端删除该上下文。

有趣的是，如果`_setTimeout`为了`JSObjectCllAsFunction`立即调用而更改函数，而不等待超时，那么它会按预期工作。

如何防止在这种异步回调中自动删除上下文？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-06T16:44:13.680

我最终`setTimeout`像这样添加到特定的 JavaScriptCore 上下文中，并且效果很好：

```
JSVirtualMachine *vm = [[JSVirtualMachine alloc] init];
JSContext *context = [[JSContext alloc] initWithVirtualMachine: vm];

// Add setTimout
context[@"setTimeout"] = ^(JSValue* function, JSValue* timeout) {
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)([timeout toInt32] * NSEC_PER_MSEC)), dispatch_get_main_queue(), ^{
        [function callWithArguments:@[]];
    });
}; 
```

就我而言，这允许我`cljs.core.async/timeout`在 JavaScriptCore 内部使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-23T11:08:30.260

对于已注册的 iOS 开发人员，请观看 wwdc 2013 中有关 javascript 核心的新视频，名为[“将 JavaScript 集成到本机应用程序中”](https://developer.apple.com/wwdc/videos/)。您将在那里找到最新 iOS 版本的解决方案。

对于当前的 iOS 版本，我的替代解决方案是在 JSC 中创建一个**全局数组**，用于存储应该受到垃圾收集器保护的对象。因此，您可以在不再需要时控制从数组中弹出变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-07T05:46:57.137

### 不要挂在一个 JSContextRefs 上，除了你用 JSGlobalContextCreate 创建的那个

具体来说，这很糟糕：

```
jsEngine.timeoutCtx =  ctx;
....
JSObjectCallAsFunction(timeoutCtx 
```

不要保存 ctx，而是将全局上下文传递给 JSObjectCallAsFunction。

### 你必须 JSValueProtect 任何你想保留的值比你的回调更长

JavaScriptCore 垃圾收集器可以在您调用 JavaScriptCore 函数的任何时候运行。在您的示例中，作为 setTimeout 的单个参数创建的匿名函数没有被 JavaScript 中的任何内容引用，这意味着它可以在 setTimeout 调用完成后的任何时间点被垃圾收集。因此 setTimeout 必须通过 JSValueProtect 函数告诉 JavaScriptCore 不要收集它。在使用 JSObjectCallAsFunction 调用该函数后，您应该使用 JSValueUnprotect 它，否则该匿名函数将在内存中徘徊，直到全局上下文被破坏。

### 奖励：如果您不想从函数返回任何内容，通常应该返回 JSValueMakeUndefined(ctx)

JSValueMakeNull(ctx) 与未定义不同。我的一般规则是，如果我在 Objective-C 中返回 void，则返回 JSValueMakeUndefined；如果我返回 nil 对象，则返回 JSValueMakeNull。但是，如果您想像 window 对象一样实现 setTimeout，则它需要返回一个 ID/句柄，可以将其传递给 clearTimeout 以取消计时器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-05T02:03:22.017

我已经实现`setTimout`，`setInterval`并`clearTimeout`在 Swift 上解决了这个问题。通常，示例仅显示`setTimeout`没有使用选项的函数`clearTimeout`。如果您正在使用 JS 依赖项，那么您很有可能也需要`clearTimeout`and`setInterval`函数。

```
import Foundation
import JavaScriptCore

let timerJSSharedInstance = TimerJS()

@objc protocol TimerJSExport : JSExport {

    func setTimeout(_ callback : JSValue,_ ms : Double) -> String

    func clearTimeout(_ identifier: String)

    func setInterval(_ callback : JSValue,_ ms : Double) -> String

}

// Custom class must inherit from `NSObject`
@objc class TimerJS: NSObject, TimerJSExport {
    var timers = [String: Timer]()

    static func registerInto(jsContext: JSContext, forKeyedSubscript: String = "timerJS") {
        jsContext.setObject(timerJSSharedInstance,
                            forKeyedSubscript: forKeyedSubscript as (NSCopying & NSObjectProtocol))
        jsContext.evaluateScript(
            "function setTimeout(callback, ms) {" +
            "    return timerJS.setTimeout(callback, ms)" +
            "}" +
            "function clearTimeout(indentifier) {" +
            "    timerJS.clearTimeout(indentifier)" +
            "}" +
            "function setInterval(callback, ms) {" +
            "    return timerJS.setInterval(callback, ms)" +
            "}"
        )       
    }

    func clearTimeout(_ identifier: String) {
        let timer = timers.removeValue(forKey: identifier)

        timer?.invalidate()
    }

    func setInterval(_ callback: JSValue,_ ms: Double) -> String {
        return createTimer(callback: callback, ms: ms, repeats: true)
    }

    func setTimeout(_ callback: JSValue, _ ms: Double) -> String {
        return createTimer(callback: callback, ms: ms , repeats: false)
    }

    func createTimer(callback: JSValue, ms: Double, repeats : Bool) -> String {
        let timeInterval  = ms/1000.0

        let uuid = NSUUID().uuidString

        // make sure that we are queueing it all in the same executable queue...
        // JS calls are getting lost if the queue is not specified... that's what we believe... ;)
        DispatchQueue.main.async(execute: {
            let timer = Timer.scheduledTimer(timeInterval: timeInterval,
                                             target: self,
                                             selector: #selector(self.callJsCallback),
                                             userInfo: callback,
                                             repeats: repeats)
            self.timers[uuid] = timer
        })

        return uuid
    } 
```

使用示例：

```
jsContext = JSContext()
TimerJS.registerInto(jsContext: jsContext) 
```

我希望这会有所帮助。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-15T11:18:59.050

基于@ninjudd的回答，这是我在swift中所做的

```
 let setTimeout: @objc_block (JSValue, Int) -> Void = {
        [weak self] (cb, wait) in

        let callback = cb as JSValue

        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, Int64(UInt64(wait) * NSEC_PER_MSEC)), dispatch_get_main_queue(), { () -> Void in
            callback.callWithArguments([])
        })
    }
    context.setObject(unsafeBitCast(setTimeout, AnyObject.self), forKeyedSubscript: "setTimeout") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-14T02:48:13.700

这是我的两分钱。

我认为没有必要在`_setTimeout`. 您可以利用全局上下文稍后调用计时器函数。

您`JSValueProtect`应该`jsEngine.timeoutFunc`在`_setTimeout`. 否则它可能会变成无效的引用并在以后导致崩溃。

# php - MySQL - 好友排行榜按胜利排名并将玩家包括在排名中

> ID：15991064
> 
> 赞同：1
> 
> 时间：2013-04-13T18:00:10.380
> 
> 标签：php, mysql, leaderboard

**平台：** MySQL/PHP

**场景：**创建好友排行榜，其中包括玩家的所有好友，并在单个查询中将该玩家包含在排行榜中。

**详细信息：**我正在尝试创建一个查询，其中结果包括选择的玩家及其所有朋友。排名将根据获胜次数最多的人来确定。

**问题：**这可以在单个查询中完成，还是更快获得结果集，然后将每个朋友的获胜次数与玩家获胜次数进行比较以确定排名顺序。

**其他详情：**

这是我必须返回玩家和他们的朋友以及胜利和金钱总数的查询：

```
SELECT a.profile_id, 'player', a.win AS player_wins, b1.profile_id AS friend_id,
b1.handle AS friend_handle, b1.win AS friend_wins, b1.bankroll AS friend_bank
FROM ldrbrd_cache_tmp a, buddy_tbl b, ldrbrd_cache_tmp b1
WHERE a.profile_id = b.profile_id
AND b.buddy_id = b1.profile_id
AND a.profile_id <> 1
AND b.buddy_id <> 1
AND a.profile_id = 2
ORDER BY a.profile_id, b1.win DESC; 
```

结果：

```
id | name   | player-wins | friend-id | friend-name | friend-wins | friend-money

'2','player'   ,'200'       ,'50'      ,'Freddy K'    ,'303'       ,'10004572'
'2','player'   ,'200'       ,'53'      ,'dannn'       ,'217'       ,'92065'
'2','player'   ,'200'       ,'51'      ,'YoDood'      ,'126'       ,'2383600'
'2','player'   ,'200'       ,'58'      ,'princess'    ,'19'        ,'89565'
'2','player'   ,'200'       ,'71'      ,'com-on'      ,'8'         ,'-9530'
'2','player'   ,'200'       ,'57'      ,'foolzzz'     ,'7'         ,'210'` 
```

结果显示玩家获胜数为 200，因此在这种情况下，玩家应该排名第 3。

你会注意到我有玩家获胜但我如何比较玩家获胜和朋友获胜以在同一 SQL 语句中返回排名？或者是最好的做法是将结果分配给一个数组然后确定玩家适合的位置？

**编辑：** 所以我想出了一个有效的 UNION，这是唯一的选择吗？

```
SELECT profile_id, handle, win FROM (
SELECT a.profile_id, a.handle, a.win
FROM ldrbrd_cache_tmp a
WHERE a.profile_id = 2
UNION ALL SELECT b1.profile_id, b1.handle, b1.win
FROM ldrbrd_cache_tmp a, buddy_tbl b, ldrbrd_cache_tmp b1
WHERE a.profile_id = b.profile_id
AND b.buddy_id = b1.profile_id
AND a.profile_id <> 1
AND b.buddy_id <> 1
AND a.profile_id = 2
ORDER BY profile_id, win DESC) AS player_ranking
ORDER BY win DESC; 
```

这似乎暂时有效，除非有人有更好的解决方案？

# ios - 如何在 iOS 中制作不可移动的背景？

> ID：15991070
> 
> 赞同：1
> 
> 时间：2013-04-13T18:01:00.913
> 
> 标签：ios, uiview, background

在我的应用程序中，我有 UITableViewController，上面有表格。我以这种方式用图像填充背景：

```
UIImage* backgroundImage;
backgroundImage = [UIImage imageNamed:@"bg.png"];
self.view.backgroundColor = [UIColor colorWithPatternImage:backgroundImage]; 
```

但是，当用户滚动表格时，背景会随着所有其他视图控制器组件移动。

是否有可能制作不可移动的背景，如 HTML 背景？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:03:12.343

尝试

```
UIColor *color= [[[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"Background.png"]] autorelease];
self.tableView.backgroundColor = color; 
```

或者

```
UIImageView *imageView= [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Background.png"]] autorelease];
imageView.frame = self.tableView.frame

self.tableView.backgroundView = imageView; 
```

# javascript - 鼠标离开后jQuery框淡出/淡入闪烁

> ID：15991073
> 
> 赞同：0
> 
> 时间：2013-04-13T18:01:17.440
> 
> 标签：javascript, jquery, fadein, fadeout

如何使它在鼠标悬停时淡出并在鼠标离开时再次淡入？ [我的 jsFiddle](http://jsfiddle.net/villimagg/tvtUT/)

```
$(function() {
var box = $('#box');

box.on('mouseover', function() {
    box.fadeOut(500);
});
box.on('mouseleave', function() {
    box.fadeIn(500);
});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:07:45.573

```
$(function() {
    $('#box').on('mouseenter mouseleave', function() {
        $(this).stop().fadeToggle();
    });
}); 
```

[**小提琴**](http://jsfiddle.net/tvtUT/9/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:06:22.217

试试这个：

```
$(function() {
    var box = $('#box');
    box.hover(function() {
        $(this).fadeOut(500);

    }, function() {
        $(this).stop().fadeIn(500);

    });
}); 
```

看到这个[小提琴](http://jsfiddle.net/tvtUT/7/)

# c# - wpf中可点击图像映射的最佳方式

> ID：15991076
> 
> 赞同：4
> 
> 时间：2013-04-13T18:01:40.227
> 
> 标签：c#, wpf, image

我在 c# WPF 中有一个包含许多部分的图像我想让每个部分单击使我想我试图将图像拆分为部分并在每个图像上进行事件但问题是图像的嵌套部分什么是制作图像的最佳方法地图 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:10:29.417

You can do it easily with Expression Design which is included in Microsoft Expression Studio. This is steps you gonna do:

1.  Add image to Expression Design.
2.  Then you can use PaintBrush tool for split image into parts as you want.
3.  Then you must export this to xaml. In export window you can choose Xaml Silverlight 3

Canvas as format and Paths as Text.

As you understand, it automatically converts objects you draw on your image to path object with all coordinates on it.

Then you can copy exported xaml and paste it to your application.

You can download Expression Studio from Dreamspark for free.

I have just made sample and exported it to xaml:

```
<Canvas xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" x:Name="Untitled1" Width="62" Height="62" Clip="F1 M 0,0L 62,0L 62,62L 0,62L 0,0" UseLayoutRounding="False">
    <Canvas x:Name="Layer_1" Width="62" Height="62" Canvas.Left="0" Canvas.Top="0">
        <Image x:Name="Image" Source="Untitled1_files/image0.png" Width="1920" Height="1080" Canvas.Left="0" Canvas.Top="0">
            <Image.RenderTransform>
                <TransformGroup>
                    <MatrixTransform Matrix="1,0,0,1,-929.667,-510.667"/>
                </TransformGroup>
            </Image.RenderTransform>
        </Image>
        <Path x:Name="Path" Width="159.722" Height="161.743" Canvas.Left="82.757" Canvas.Top="-0.415951" Stretch="Fill" Fill="#FFE7DEDE" Data="F1 M 82.8307,30.8333C 81.8859,46.01 90.3304,60.6249 90.3304,75.831C 90.3304,88.8304 91.9427,101.93 90.3304,114.829C 89.0281,125.247 87.0101,136.367 90.3304,146.327C 95.3301,161.327 119.518,161.327 135.328,161.327C 157.018,161.327 175.778,144.86 193.825,132.828C 209.523,122.363 235.198,120.495 241.823,102.83C 243.994,97.0391 240.326,90.2367 237.323,84.8306C 230.656,72.8294 223.759,60.756 214.824,50.3323C 205.057,38.9377 205.748,18.0458 192.325,11.3342C 183.723,7.03329 173.332,8.29683 163.827,6.83447C 144.945,3.92956 125.479,-3.30947 106.83,0.834766C 94.3289,3.61269 83.6265,18.0524 82.8307,30.8333 Z "/>
    </Canvas>
</Canvas> 
```

The exported part is Path object. You can do whatever you want on it. For example you can handle MouseClick event for this path and change background of path....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:10:36.780

You could overlay the image with a set of transparent shapes:

```
<Canvas>
    <Image Source="..."/>
    <Ellipse Canvas.Left="50" Canvas.Top="50" Width="100" Height="50"
             Fill="Transparent" MouseDown="Ellipse_MouseDown"/>
    <Path Data="..." MouseDown="Path_MouseDown"/>
</Canvas> 
```

These shapes could be simple Rectangles or Ellipses, or more or less complex Polygons or Paths.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-28T05:01:52.880

它非常简单。而不是去任何复杂的方式遵循这个，这是最简单的 1）首先在 XAML 中声明你的图像

```
<Grid Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
    <Image Name="imagePath" HorizontalAlignment="Center" VerticalAlignment="Center"/>
</Grid> 
```

2）在图像本身上查找鼠标位置以获取 x 和 y 坐标

```
String[] arr = new String[2];
var mousePos = Mouse.GetPosition(imagePath);
arr = mousePos.ToString().Split(',');
double x = Double.Parse(arr[0].ToString());
double y = Double.Parse(arr[1].ToString()); 
```

3）声明您想要获得可点击区域或鼠标悬停的区域

```
if (x >= 10 && y >= 10 && x <= 20 && y <= 20//this declares square area with x1,y1,x2,y2
{
  //do whatever you want to do
  //don't forget to add left and top each time
  left = left +x;//x=10 i.e x1
  top = top + y;//y=20 i.e y1
} 
```

4）每次移动图像时添加这个 x1 和 y1

```
int left = 0;
int top = 0; 
```

整个代码；看起来像这样

```
InitializeComponent();
imagePath.MouseMove += new MouseEventHandler(myMouseMove);

private void myMouseMove(object sender, MouseEventArgs e)
    {
        String[] arr = new String[2];
        var mousePos = Mouse.GetPosition(imagePath);
        arr = mousePos.ToString().Split(',');
        double x = Double.Parse(arr[0].ToString());
        double y = Double.Parse(arr[1].ToString());
        int x = (int)xx;
        int y = (int)yy;
        int left = 0;
        int top = 0;

        Console.WriteLine("Screen Cordinate-------------------------" + x + ", " + y);

                for (int i = 0; i < n; i++)
                {
                    if (x >= x1 && y >= y1 && x <= x2 && y <= y2
                    {                            
                        Mouse.OverrideCursor = Cursors.Hand;
                        left = left + x1;
                        top = top + y1;
                        break;
                    }
                    else
                    {
                        Mouse.OverrideCursor = Cursors.Arrow;
                    }
                } 
```

其中 x1,y1,x2,y2 是图像上的坐标就是这样！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-23T08:23:35.083

我认为使用 Adorner 来实现功能是最好的方法。

这是在 MSDN中添加图像控制（[图像注释](http://www.codeproject.com/Articles/20457/Annotating-an-Image-in-WPF)）和[Adorner 概述的示例](http://msdn.microsoft.com/en-us/library/ms743737(v=vs.110).aspx)

# ruby-on-rails - 测试子应用控制器

> ID：15991079
> 
> 赞同：0
> 
> 时间：2013-04-13T18:02:19.053
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

我有一个继承自`ApplicationController`. 为了测试之前的过滤器`Admin::BaseController`，我在这个规范中创建了一个匿名控制器。

```
require 'spec_helper'

describe Admin::BaseController do

  it { should be_a(ApplicationController) }

  controller do
    def index
      render :text => ''
    end
  end

  context 'when current user is not an admin' do
    it 'redirects to root path' do
      get :index
      response.should redirect_to(root_path)
    end
  end
end 
```

但是当我提出`index`行动请求时，它不会调用 before 过滤器`Admin::BaseController`。

当我定义该过滤器`ApplicationController`而不是`Admin::BaseController`运行测试时，它可以工作。显然这个匿名控制器继承自`ApplicationController`. 我怎样才能改变这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:33:25.227

我在这里找到了答案；[https://www.relishapp.com/rspec/rspec-rails/docs/controller-specs/anonymous-controller](https://www.relishapp.com/rspec/rspec-rails/docs/controller-specs/anonymous-controller)

```
controller(Admin::BaseController) do
  def index
    render :text => ''
  end
end 
```

成功了。

# r - 在 R-studio 中使用 knitr 将 xtable() 应用于表格列表和创建 pdf

> ID：15991080
> 
> 赞同：1
> 
> 时间：2013-04-13T18:02:29.340
> 
> 标签：r, plyr, knitr, xtable

我想使用 xtable() 将表格列表转换为 Latex，并在 R-studio 中使用 Knitr 创建一个 pdf。

我曾尝试在列表中使用 llply() 但它不起作用。

以下是表格列表：

```
library(plyr)
library(xtable)
Data <- data.frame(a=rbinom(100,1,0.5), b=rbinom(100,1,0.3), c=rbinom(100,1,0.6))
combos <- combn(ncol(Data),2)
TabelFn <- function(x) {
  Table <- addmargins(table(Data[, x[1]], Data[, x[2]]))
  return(Table)
}
Table <- alply(.data=combos, .margins=2, .fun=TabelFn, .expand=TRUE)

Table # list of tables 
```

我试图在它上面运行 llply() ：

```
llply(Table, function(x) {xtable(x)}) 
```

并得到了这个输出：

```
$`1`
% latex table generated in R 2.15.3 by xtable 1.7-1 package
% Sat Apr 13 19:45:40 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrrr}
  \hline
 & 0 & 1 & Sum \\ 
  \hline
0 & 48.00 & 11.00 & 59.00 \\ 
  1 & 31.00 & 10.00 & 41.00 \\ 
  Sum & 79.00 & 21.00 & 100.00 \\ 
   \hline
\end{tabular}
\end{table}

$`2`
% latex table generated in R 2.15.3 by xtable 1.7-1 package
% Sat Apr 13 19:45:41 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrrr}
  \hline
 & 0 & 1 & Sum \\ 
  \hline
0 & 27.00 & 32.00 & 59.00 \\ 
  1 & 21.00 & 20.00 & 41.00 \\ 
  Sum & 48.00 & 52.00 & 100.00 \\ 
   \hline
\end{tabular}
\end{table}

$`3`
% latex table generated in R 2.15.3 by xtable 1.7-1 package
% Sat Apr 13 19:45:41 2013
\begin{table}[ht]
\centering
\begin{tabular}{rrrr}
  \hline
 & 0 & 1 & Sum \\ 
  \hline
0 & 40.00 & 39.00 & 79.00 \\ 
  1 & 8.00 & 13.00 & 21.00 \\ 
  Sum & 48.00 & 52.00 & 100.00 \\ 
   \hline
\end{tabular}
\end{table} 
```

但是 Latex 不会接受。我猜这是因为 $`1`和 $等列表名称`2`。这个问题[xtable output for a list of tables](https://stackoverflow.com/questions/7424159/xtable-output-for-a-list-of-tables)解释了一种方法，但我希望有一种不太复杂的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T19:10:59.633

我犹豫发布这个，因为它不会增加你分享的链接问题......

只需更改`llply(...)`并`l_ply`确保`xtable`s 的块选项设置为类似`<<echo=FALSE, results='asis'>>=`

我能够创建一个包含以下内容的 Rnw 文件，效果很好：

```
\documentclass{article}

\begin{document}

<<echo=FALSE>>=
library(plyr)
library(xtable)
Data <- data.frame(a=rbinom(100,1,0.5), b=rbinom(100,1,0.3), c=rbinom(100,1,0.6))
combos <- combn(ncol(Data),2)
TabelFn <- function(x) {
  Table <- addmargins(table(Data[, x[1]], Data[, x[2]]))
  return(Table)
}
Table <- alply(.data=combos, .margins=2, .fun=TabelFn, .expand=TRUE)
@

<<echo=FALSE, results='asis'>>=
l_ply(Table, function(x) { print(xtable(x)) })
@

\end{document} 
```

有几点需要注意：

*   `$`是 LaTeX 中的一个特殊字符，因此在输出中包含它们会产生问题
*   `alply`并将`llply`显示输出，但您不希望这样，因此您应该在适当的时候使用`_`版本 (`a_ply`和`l_ply`)。从帮助文件到`l_ply`，*所有输出都被丢弃。这对于您纯粹因为其副作用（例如显示绘图或保存输出）而调用的函数很有用。*

# internet-explorer-9 - IE9 上的 Video.js 在 preload=auto 上出现错误 - 并且 IE 海报未显示问题

> ID：15991089
> 
> 赞同：1
> 
> 时间：2013-04-13T18:03:09.663
> 
> 标签：internet-explorer-9, preload, video.js

我正在使用 video.js 在页面上显示一些视频。视频定义了海报图像，并设置了 preload=auto，没有控件。（所有的播放都是通过 API 完成的）。

除了 IE9 之外，一切似乎都可以在几乎任何浏览器中运行。有时（并非总是如此）您会在一个或多个视频上收到视频错误，如果您尝试播放视频，它会给您一个视频未准备好的错误。

我能找到的唯一解决方法是设置 preload=none，但这是不可接受的，因为使用 preload=none 时，视频在您开始播放时加载时会以黑色矩形开始几秒钟。我们还在所有 IE 浏览器上看到了那个黑色矩形，但我无法找到解决办法——它应该显示海报。但是当我们摆脱控制时，这似乎发生了。

我可以使用 preload=none，即使使用黑色矩形，如果有一些接口我可以用来开始从 API 加载视频，但我找不到。所以我需要三种可能的解决方案之一 - 按优先顺序排列：

*   用 preload=auto 修复 IE9 特定问题的东西

*   当标签设置为 preload=none 时，允许我们在 Domready 之后使用 API 显式预加载视频

*   在视频准备好在所有浏览器上播放之前，可以显示海报而不是黑色矩形的东西。

有任何想法吗？

# html - 使用 CSS垂直对齐元素中的文本

> ID：15991093
> 
> 赞同：16
> 
> 时间：2013-04-13T18:03:31.347
> 
> 标签：html, css, vertical-alignment

 有人可以解释我如何垂直对齐`<a>`元素中的文本 - 所以两个文本都出现在红色框的中间？ 

[http://jsfiddle.net/WeKtX/](http://jsfiddle.net/WeKtX/)

这是我的*HTML*：

```
<ul>
<li><a href="#">this is a link</a></li>
<li><a href="#">this is an even longer link</a></li>
</ul> 
```

和我的*CSS*：

```
li {list-style-type:none;margin:0;padding:0}
li a {width:100px;float:left;background:red;margin-right:20px;height:40px} 
```

非常感谢您的任何指点

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-13T18:07:25.333

如果要水平居中文本，请尝试：

```
text-align: center; 
```

如果要将文本垂直居中，请尝试：

```
line-height: 40px; //Where 40px is the height of your parent element 
```

请记住，当使用 line-height 时，它只适用于**一行**文本。如果你想做多行文本，那么恐怕你必须为文本指定一个高度，然后在父元素上使用`position: absolute;`文本。`position: relative;`

对于您的多行示例，我会尝试[以下 jsFiddle](http://jsfiddle.net/WeKtX/10/)：

```
li {
    list-style-type:none;
    margin:0;
    padding:0;
    position: relative;
    height: 60px;
    width: 200px;
    display: block;
    background:red;
}

li a {
    width:100px;
    height:40px;
    position: absolute;
    top: 50%;
    margin-top: -20px;
} 
```

# visual-c++ - 如何使用批处理文件中的 VC++ CL 调用？

> ID：15991096
> 
> 赞同：0
> 
> 时间：2013-04-13T18:03:47.190
> 
> 标签：visual-c++, batch-file

如何使用批处理文件中的 VC++ CL 调用？

```
start %comspec% /k ""c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"" x86_amd64 
```

这可行，但我需要随后调用“CL *.c”，所以我尝试了：

```
start %comspec% /k ""c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"" x86_amd64 && cl.exe *.c 
```

这没有任何作用。我需要更正或阅读什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:10:21.110

`vcvarsall.bat` - just sets environment variables, so when you just execute it all settings are lost at exit. To ensure that environment variables are still there you need use `call`

So you bat can look:

```
call "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" x86_amd64 
cl.exe *.c 
```

# html - 将 PDF 文件从在线资源嵌入网页，这需要在 HTTP 标头中下载带有“Content-Disposition:”标签的文件

> ID：15991102
> 
> 赞同：2
> 
> 时间：2013-04-13T18:04:29.213
> 
> 标签：html, pdf, ruby-on-rails-3.2, http-headers

我需要在网页上显示来自第三方的 PDF 文件。我有文档链接，因为它们出现在源页面上。不幸的是，这些链接都不是文档的实际链接，而是带有某些参数的 GET 请求，或其他间接引用，如下所示：

[http://cdm.unfccc.int/UserManagement/FileStorage/SNM7EQ2RUD4IA0JLO3HCZ8BTK1VX5P](http://cdm.unfccc.int/UserManagement/FileStorage/SNM7EQ2RUD4IA0JLO3HCZ8BTK1VX5P)

如果网站不强制`Content-Disposition: attachment;`在响应标头中使用标签下载，如上所述，那么我可以通过以下方式轻松实现必要的显示：

```
<object width="90%" height="600" type="application/pdf"  
data="http://cdm.unfccc.int/UserManagement/FileStorage/SNM7EQ2RUD4IA0JLO3HCZ8BTK1VX5P"  
id="pdf_content">  
<p>Can't seem to display the document. Try <a href="http://cdm.unfccc.int/UserManagement/FileStorage/SNM7EQ2RUD4IA0JLO3HCZ8BTK1VX5P">  
downloading</a> it.</p>
<embed type="application/pdf" src="http://cdm.unfccc.int/UserManagement/FileStorage/SNM7EQ2RUD4IA0JLO3HCZ8BTK1VX5P"  
width="90%" height="600" />
</object> 
```

这在大多数浏览器中非常优雅地“站立”和“下降”。使用`<object>`and`<embed>`同时对我有用，而且，据我测试，不会影响我在下面描述的问题（告诉我我是否错了）。

当网站确实需要在 HTTP 标头中使用上述标记进行下载时，问题就开始了。例如，以下链接中的文档：

[http://mer.markit.com/br-reg/PublicReport.action?getDocumentById=true&document_id=103000000000681](http://mer.markit.com/br-reg/PublicReport.action?getDocumentById=true&document_id=103000000000681)

不会通过我上面显示的 HTML 结构显示。它优雅地落下，下载链接也很好，但我需要查看它！

我已经把头撞在墙上三天了，想不通。

也许有一种方法可以以某种方式捕获请求的标头并忽略它们，或者可能将“可见性”强制到 GET 请求中。

对于一般信息，这是 Ruby on Rails 应用程序的一部分，因此解决方案应该来自这些方面。我在这里没有给出任何 ROR 代码，因为它似乎不是问题的根源。

任何直接的解决方案都将受到祈祷，而其他任何解决方案 - 非常感谢。

我想到并丢弃评论的替代解决方案：

1.  提前将**所有这些文件**下载到本地存储，然后从那里提供它们。
    *必要的存储容量约为 1TB 并且还在不断增长，因此将其存储在服务器上* 对于小型商业 SaaS 来说会很**昂贵。**

2.  在可能需要的时候缓存这些文档。例如，当有人打开项目的页面时，后台进程会下载相关的 PDF，因此如果用户单击文档链接，他将获得刚刚下载到本地存储的文档。缓存可以保留几个小时/天，以防用户返回。
    *这可能是可行的，但如果用户群很大，那么此解决方案将与上述解决方案存在相同的问题。同样在这一刻，我不知道如何实现这种算法（非常初学者，你看）*

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-07-18T15:07:51.477

您可能想考虑使用[http://pdfobject.com](http://pdfobject.com)或者只是调整它的一些代码，因为它似乎能够做您想做的事情。我做了一个概念验证：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Embedding a PDF using PDFObject: Simple example with basic CSS</title>
  <!-- This example created for PDFObject.com by Philip Hutchison (www.pipwerks.com) -->
  <style type="text/css">
    body
    {
      font: small Arial, Helvetica, sans-serif;
      color: #454545;
      background: #F8F8F8;
      margin: 0px;
      padding: 2em;
    }
    h1
    {
      font-weight: normal;
      font-size: x-large;
    }
    a:link, a:visited
    {
      color: #3333FF;
      text-decoration: none;
      border-bottom: 1px dotted #3333FF;
    }
    a:hover, a:visited:hover
    {
      color: #FF3366;
      text-decoration: none;
      border-bottom: 1px solid #FF3366;
    }
    #pdf
    {
      width: 500px;
      height: 600px;
      margin: 2em auto;
      border: 10px solid #6699FF;
    }
    #pdf p
    {
      padding: 1em;
    }
    #pdf object
    {
      display: block;
      border: solid 1px #666;
    }
  </style>
  <script type="text/javascript" src="pdfobject.js"></script>
  <script type="text/javascript">
    window.onload = function () {
      var success =
        new PDFObject({ url: "http://mer.markit.com/br-reg/PublicReport.action?getDocumentById=true&document_id=103000000000681" }).embed("pdf");
    };
  </script>
</head>
<body>
  <h1>
    Embedding a PDF using PDFObject: Simple example with basic CSS</h1>
  <p>
    This example uses one line of JavaScript wrapped in a <em>window.onload</em> statement,
    with a little CSS added to control the styling of the embedded element.
  </p>
  <div id="pdf">
    It appears you don't have Adobe Reader or PDF support in this web browser. <a href="http://mer.markit.com/br-reg/PublicReport.action?getDocumentById=true&document_id=103000000000681">
      Click here to download the PDF </a>
  </div>
</body>
</html> 
```

# ios - 在进行许多计划更改的开发时使用 Core Data

> ID：15991104
> 
> 赞同：1
> 
> 时间：2013-04-13T18:04:54.077
> 
> 标签：ios, core-data, core-data-migration

我读了他写的这个[博客](http://sealedabstract.com/code/you-should-use-core-data/)，每个人都应该在他想要存储的不仅仅是琐碎的数据时立即使用核心数据。

所以我在我的项目中添加了一个 xcdatamodeld。我将使用公式填充应用程序中的数据库。而且我知道，在未来的发展中我会改变很多数据模型。但是必须保存公式中输入的数据。这意味着我需要多次迁移。您认为在这个发展阶段使用核心数据是一个好主意吗？我不喜欢在开发时拥有大量旧 xcdatamodel 文件的想法。

顺便说一句，如果这对任何人有帮助，我正在使用[Magical Record 。](https://github.com/magicalpanda/MagicalRecord)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:32:42.130

绝对使用核心数据。这很棒。

我发现在开发应用程序时进行迁移并不值得。有一半的时间你没有保存数据，或者你想从头开始，或者你有想要在新模型上测试的数据设置代码。

我建议更改您的核心数据堆栈设置代码，以便在出现错误时简单地删除并重新创建持久存储。当您更新应用的实时版本时保存迁移。

# sml - 十六进制字符串到 Int 的转换

> ID：15991105
> 
> 赞同：1
> 
> 时间：2013-04-13T18:04:57.953
> 
> 标签：sml

我有一个类似于 的十六进制字符串`"0xff"`，并且想将其转换为 int，即 255。

但`Int.fromString "0xff"`给出了答案`0`。

我虽然这`Int.scan`会有所帮助。但我是 SML 的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T22:06:29.387

你可以做

```
StringCvt.scanString (Int.scan StringCvt.HEX) "0xff" 
```

或者

```
StringCvt.scanString (Int.scan StringCvt.HEX) "ff" 
```

# php - 如果 DataMapper 仅用于传输/交换数据，在哪里为集合实例化对象？

> ID：15991106
> 
> 赞同：0
> 
> 时间：2013-04-13T18:05:07.203
> 
> 标签：php, oop, model-view-controller

由于 DataMapper 应该用于对象和关系数据库之间的数据交换/传输，我会得到这样的用户

```
$user = $this->entityFactory->build('User');
$userMapper = $this->mapperFactory->build('User');

$user->setId(43);
$userMapper->fetch($user); 
```

这很好用，因为我可以`User`在映射器之外创建对象并将其传入，但是当我获得对象的集合/列表时该怎么办？

首先在映射器之外创建空对象似乎并不正确，并且肯定会导致一些问题，那么最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T13:59:44.060

I don't know if this question is still in your mind, however let me give you an answer to this. In principle the first step is the same

```
$userCollection = $this->entityFactory->build('UserCollection');
$userCollectionMapper = $this->mapperFactory->build('UserCollection');
$user = $this->entityFactory->build('User');
$user->setId(43);
$userCollection->add($user);
$userCollectionMapper->fetch($userCollection); 
```

So the userObject would function here as an searchObject for the collectionMapper (like teresko proposed in an older thread). Your CollectionMapper would retrieve the data from the database and i prefer to use something like

```
//returns new User object
$newUser = $userCollection->newUser();
//populate user object with DB entry
$userCollectionMapper->populate($newUser,$DBresponse);
//add to collection
$userCollection->add($newUser); 
```

Of course there would be a loop before that looping through the found lines in the database and you would have to clear the list of user objects before adding the results. So this is the way i would deal with the problem. Hope it helps.

# php - PHP 根本没有检测到连接中止

> ID：15991113
> 
> 赞同：5
> 
> 时间：2013-04-13T18:05:50.080
> 
> 标签：php, connection, abort, disconnect

我已经阅读并深刻理解了这些： [http ://www.php.net/manual/en/features.connection-handling.php](http://www.php.net/manual/en/features.connection-handling.php) [http://www.php.net/manual/en/function.register-shutdown-function .php](http://www.php.net/manual/en/function.register-shutdown-function.php)

但是，我已经测试了 PHP 5.1.6 和 5.3，但事情并没有像那里描述的那样工作。我观察到的是：

*   connection_status() 始终返回 true，即使在客户端关闭连接之后也是如此。
*   即使ignore_user_abort为0，客户端关闭连接后脚本的执行仍会继续
*   在脚本结束之前，使用 register_shutdown_function() 注册的函数不会运行。当客户端中止连接时，脚本不会被中断（因此函数不会被调用）。

所以基本上 PHP 根本不会检测到客户端的断开连接。

请注意，这并不是将 ignore_user_abort 设置为 1：如果是这种情况，则 connection_status() 将返回 1，即使脚本将继续运行并且直到结束才会调用关闭函数。事实并非如此。

ini_get("ignore_user_abort") 按预期返回 0。

这是 PHP 中的错误，还是由于某些 Apache 设置？

如何让 PHP 按照上述文档中的描述工作？

测试脚本：

```
<?php

function myShutdown() {
    error_log("myShutdown ".connection_status()." ".ini_get("ignore_user_abort"));
}

register_shutdown_function(myShutdown);

echo "Hi!";
error_log(" *** test/test *** ");
for ($i=0; $i<10; $i++) {
    sleep(1);
    error_log(".");
    echo ".";
}
?> 
```

重现步骤： - 访问脚本的 url - 在 10 秒过去之前中止客户端上的连接（例如点击浏览器中的停止按钮）

预期/期望的行为：日志应显示少于 10 个点，并在末尾显示“myShutdown 1 0”（如果您实时查看日志，则 myShutDown 应在客户端断开连接时立即出现）

观察到的/当前的行为：日志总是显示正好 10 个点，最后显示“myShutdown 0 0”（如果您实时观看，无论客户端何时断开连接，它都会持续 10 秒）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T20:37:45.133

首先，使用基本的 ubuntu 12.04 LAMP 安装（php5.3），我也无法让它工作。但是我有一些信息，希望对您有所帮助。任何意见或编辑表示赞赏！:)

* * *

我发现您的代码存在两个问题。第一个是语法错误。`myShutdown`调用时缺少单引号`register_shutdown_function()`。将行更改为：

```
register_shutdown_function('myShutdown'); 
```

我看到的第二个问题是s[`flush()`](http://www.php.net/manual/en/function.flush.php)之后丢失的调用`echo`。文档说：

> 在尝试向客户端发送信息之前，PHP 不会检测到用户已中止连接。简单地使用 echo 语句并不能保证发送信息，请参见 flush()。

但即使`flush()`在任何情况下都无济于事。从以下文档`flush()`：

> flush() 可能无法覆盖 Web 服务器的缓冲方案，并且它对浏览器中的任何客户端缓冲都没有影响。它也不会影响 PHP 的用户空间输出缓冲机制。这意味着如果您正在使用 ob_flush() 和 flush() 来刷新 ob 输出缓冲区，则必须调用它们。
> 
> 一些服务器，特别是在 Win32 上，仍然会缓冲脚本的输出，直到它在将结果传输到浏览器之前终止。
> 
> Apache 的服务器模块（如 mod_gzip）可能会自己进行缓冲，这将导致 flush() 不会导致数据立即发送到客户端。
> 
> 甚至浏览器也可以在显示之前缓冲它的输入。例如，Netscape 会缓冲文本，直到它接收到行尾或标记的开头，并且在看到最外层表格的标记之前不会呈现表格。
> 
> 某些版本的 Microsoft Internet Explorer 仅在收到 256 字节的输出后才开始显示页面，因此您可能需要在刷新之前发送额外的空格以使这些浏览器显示页面。

在该页面的评论中，建议设置几个标头和 apache 配置：

```
apache_setenv('no-gzip', 1); 
ini_set('zlib.output_compression', 0); 
ini_set('implicit_flush', 1); 
```

但是，即使这对我也不起作用。我已经使用wiresharek对此进行了调查，尽管Web服务器在0.0037秒后发送内容（'Hi'），但Web浏览器正在缓冲页面。

# java - JoptionPane 验证遇到问题

> ID：15991114
> 
> 赞同：1
> 
> 时间：2013-04-13T18:05:53.920
> 
> 标签：java, swing, validation, design-patterns, joptionpane

我遇到的问题是这段代码：

```
 String birthString = JOptionPane.showInputDialog(
           null, "Enter birth year: ", "How long have you been alive?",
           JOptionPane.QUESTION_MESSAGE);      
   Pattern p = Pattern.compile("[A-Z,a-a,&%$#@!()*^]");
   Matcher m = p.matcher(birthString);
   if (m.find()){
       JOptionPane.showMessageDialog(null, 
             "That doesn't look like numbers to me... Try again.",
             "How long have you been alive?", JOptionPane.WARNING_MESSAGE);
   }      
   int birth = Integer.parseInt(birthString);
   String currentString = JOptionPane.showInputDialog(
           null, "Enter cureent year: ", "How long have you been alive?",
           JOptionPane.QUESTION_MESSAGE);
   int current = Integer.parseInt(currentString);
   Pattern c = Pattern.compile("[A-Z,a-a,&%$#@!()*^]");
   Matcher n = c.matcher(currentString);     
   if (n.find()){
       JOptionPane.showMessageDialog(null, 
             "That doesn't look like numbers to me... Try again.",
             "How long have you been alive?", JOptionPane.WARNING_MESSAGE);
   } 
```

如果有人输入除数字以外的任何内容，我想做到这一点，它会给出对话框消息“这对我来说看起来不像数字......再试一次”。唯一的问题是它没有这样做，程序只是错误。任何帮助将不胜感激，我知道这是我做错的小事，只是找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:12:05.743

You're trying to match a year, why not use a simpler regular expression. `\\d+` will match one or more integer characters. [Matcher#matches](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#matches%28%29) will do a match on the full `String`:

```
if (!birthString.matches("\\d+")) {
   JOptionPane.showMessageDialog(null,
    "That doesn't look like numbers to me... Try again.",
     "How long have you been alive?", JOptionPane.WARNING_MESSAGE);
} 
```

See: [Pattern](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)

# java - Arraylist、日期和线程

> ID：15991116
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:05:59.033
> 
> 标签：java, multithreading, date, arraylist

这是一个银行账户模拟程序，我希望使用交易频率将日期添加到交易中，以将日期添加到日历中，从而为每笔交易正确增加日期。但是，当我打电话获取另一个班级的日期时，它会给我每笔交易的总添加日期。所以说四个星期过去了，它会显示每笔交易发生在这四个星期，而不是每周。底部的 system.out.println 将正确的日期打印到控制台，所以我认为它与我将它存储在数组列表中的方式有​​关。

如果有人能告诉我哪里出错了，我会很高兴。

```
 public void run() {
    calendar = Calendar.getInstance();
    while (duration > 0) {
        duration--;
        if (duration % freq == 0) {
            if (type == false) {
                this.withdraw(amount, billName);
                Transaction out = new Transaction(billName, amount, "Out",date);
                transList.add(out);
                date.setTime( calendar.getTime().getTime());
                calendar.setTime(date);
                calendar.add(Calendar.DAY_OF_MONTH, freq*7);
                date.setTime( calendar.getTime().getTime());
            } else {
               this.deposit(amount, billName);
               Transaction in = new Transaction(billName, amount, "In",date);
               transList.add(in);
            }
        }
        try {
            Thread.sleep(1000);
            System.out.println(date);
        } catch (InterruptedException ex) {
            Logger.getLogger(
               DepositThread.class.getName()).log(Level.SEVERE, null, ex);
        }
    }            
}

public void sortType( String sortPara ) {
   trans.setText("");
   for(int i=0; i<transList.size();i++){
      String textArea = trans.getText();
      transList.get(i).getDate();
      if(transList.get(i).type.equals(sortPara)) {
         System.out.println(transList.get(i).getName());
         trans.setText(textArea+transList.get(i).getName()+
            "       "+String.valueOf(transList.get(i).getAmount())+"     "+ 
            transList.get(i).getDate()+"\n");
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:49:58.463

您正在将相同的可变日期对象添加到所有事务中，然后开始更改它： `date.setTime( calendar.getTime().getTime());`。

使您的日期对象不可变，并为每笔交易创建一个新对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:54:02.270

您正在使用相同的日期。

改变

```
 Transaction out = new Transaction(billName, amount, "Out",date); 
```

至

```
 Transaction out = new Transaction(billName, amount, "Out", new Date(date)); 
```

# android - 如何将 TableLayout.LayoutParams 中的文本视图与表格列的父右侧对齐？

> ID：15991120
> 
> 赞同：2
> 
> 时间：2013-04-13T18:06:16.840
> 
> 标签：android

```
lblDate = new TextView(
PromotionProfile.this);
lblDate.setText(submitDate);
lblDate.setTextSize(16);
lblDate.setTextColor(Color.WHITE);
lblDate.setPadding(10, 5, 5, 0);

lblID = new TextView(PromotionProfile.this);
lblID.setText("ID " + loginID);
lblID.setGravity(Gravity.RIGHT);
lblID.setTextSize(16);
lblID.setTextColor(Color.WHITE);
lblID.setPadding(0, 5, 10, 5);

lbl_brand = new TextView(
PromotionProfile.this);
lbl_brand.setText(merchantName);
lbl_brand.setTextSize(16);
lbl_brand.setTextColor(Color.BLACK);
lbl_brand.setPadding(10, 5, 5, 0);

lbl_pts = new TextView(
PromotionProfile.this);
lbl_pts.setText(points + " Points");
lbl_pts.setTextSize(16);
lbl_pts.setGravity(Gravity.RIGHT);
lbl_pts.setTextColor(Color.BLACK);
lbl_pts.setPadding(0, 5, 10, 5);

row1 = new TableRow(PromotionProfile.this);
row2 = new TableRow(PromotionProfile.this);

row1.addView(lblDate);
row1.addView(lblID);
row2.addView(lbl_brand);
row2.addView(lbl_pts);
tbPoints.addView(row1);
tbPoints.addView(row2); 
```

> 我想让 lblID 和 lbl_pts 在表格列中向右对齐。我已经尝试过RelativeLayout.LayoutParams 方法，但仍然无法解决..我可以知道解决方案吗？多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:34:30.217

最后我自己解决了这部分代码:)

lblDate.setLayoutParams(new TableRow.LayoutParams(0, android.view.ViewGroup.LayoutParams.WRAP_CONTENT, 5)); lblID.setLayoutParams(new TableRow.LayoutParams(0, android.view.ViewGroup.LayoutParams.WRAP_CONTENT, 5)); lbl_brand.setLayoutParams(new TableRow.LayoutParams(0, android.view.ViewGroup.LayoutParams.WRAP_CONTENT, 5)); lbl_pts.setLayoutParams(new TableRow.LayoutParams(0, android.view.ViewGroup.LayoutParams.WRAP_CONTENT, 5));

# java - how to locally synchronize two maps?

> ID：15991122
> 
> 赞同：1
> 
> 时间：2013-04-13T18:06:29.783
> 
> 标签：java, multithreading

For instance,

```
class Test{
   static Map a = new ...
   static Map b = new ...

   public void process(){

      ...
      a.put(...);
      b.put(...);
  } 
} 
```

Do I have to lock like this:

```
 synchronized(a){
     a.put();
 }

 synchronized(b){
     b.put(b);
 } 
```

This seems to be awkward. Any other right way to do this? Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:13:26.467

不，您需要在一个`synchronized`块中执行这两个操作，否则另一个线程可能会看到两个映射之间的不一致。

一种可能的选择是使用一种`synchronized`方法，或者您可以使用其他一些私有对象或其中一个地图作为监视器。这是同步方法示例：

```
 static Map a = new ...
   static Map b = new ...

   public synchronized void process(){

      ...
      a.put(...);
      b.put(...);
  } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:43:12.593

您可以使用专用对象，例如

```
Object mapLock = new Object(); 
```

同步。

或者您可以同步`a`在记住，即使您需要访问`b`您也需要同步`a`。

一般来说，同步`this`不是一个好主意。我的意思是这是一个坏习惯，如果不是在这个应用程序中而是在您制作的其他应用程序中，这样做最终可能会导致性能不佳或不明显的死锁。

[在 Java 中避免同步（this）？](https://stackoverflow.com/questions/442564/avoid-synchronizedthis-in-java)

您还可以考虑使用并发包中的 ReadWriteLock。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T18:40:02.313

您确实需要在一个`synchronized`块内运行这两个操作。值得注意的是，在您的示例中，您已经静态定义了映射，而该`process()`方法是实例方法。同步方法意味着对该实例的调用将被同步，但对 2 个不同实例的调用不会（因为将同步关键字应用于方法时使用的锁是有效的`this`）。您可以将 process() 方法设为静态，或者使用`synchronized(Test.class) {}`块代替以确保不会发生竞速。

您还需要注意如何将地图公开给客户 - 如果您将它们作为属性提供，那么我可能会用 Collections.unmodifiableMap() 将它们包装起来，以确保没有其他东西可以与他们一起搞砸您没有在寻找 - 但是这并不能完全防止客户遇到“奇怪”的时间，因为他们仍然会看到更改以潜在不安全的方式发生。因此，我也可能将类型声明为 ConcurrentHashMap 以使事情更安全一些（尽管仍然存在一些危险的操作，例如在线程之间共享迭代器）

# android - 在方向更改时 LoaderManager 调用 onLoadFinished 但未设置列表

> ID：15991128
> 
> 赞同：0
> 
> 时间：2013-04-13T18:07:14.020
> 
> 标签：android, android-asynctask, android-loadermanager, android-loader

我一直在学习 Android 加载器，并试图用 AsyncTaskLoader 实现一个。

我一直非常成功，因此这让这更加烦人：P

我的 onLoadFinished 函数如下：

```
@Override
public void onLoadFinished(Loader<JSONArray> arg0, JSONArray data) {
    // TODO Auto-generated method stub
      setProgressBarIndeterminateVisibility(false);
      mLoadedData = data;
    //Log.d("here","dosomething");
    //Toast.makeText(getApplicationContext(), "msg msg", Toast.LENGTH_LONG).show();

     //Log.d("json",mLoadedData.toString());

    Fragment f = getSupportFragmentManager().findFragmentByTag("pub_list");
    ((BP_Fragment) f).set_result(mLoadedData);

} 
```

我的片段中的 set_result 函数如下：

```
public void set_result(JSONArray data) {
    // TODO Auto-generated method stub
    //Toast.makeText(getSherlockActivity(), "set result is called..", Toast.LENGTH_SHORT).show();

    Log.d("pubs",data.toString());
    for (int i = 0; i <data.length(); i++){
        Log.d("string","here");
        JSONObject c;
        try {
            c = data.getJSONObject(i);

        String id = c.getString("pid");
        String name = c.getString("name");
        String town = c.getString("town");
        String county = c.getString("county");
        //Double score=c.getDouble(criteria);
        //Log.d("score",score);
        //HashMap<String, String> map = new HashMap<String, String>();

        pubs.add(new PubListDetails(id,name,town,county,1.0,"pub"));
        //map.put(TAG_PID, id);
        //map.put(TAG_NAME, name);

        //productsList.add(map);

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

     PubListAdapter adapter = new PubListAdapter(getSherlockActivity(), pubs);
     // Toast.makeText(getSherlockActivity(), "This is called", Toast.LENGTH_SHORT).show();

      setListAdapter(adapter);

} 
```

我已经使用 LoaderManager 调试器检查加载程序是否被保留.. 它是。我已经使用控制台日志从 set_result 函数中输出我的数据 - 每次方向变化时数据都在那里。 IE 一切都被调用，一切都按照建议传递 YET set_adapter 仅在第一次将数据设置到列表中, no 当它作为保留加载器的结果被调用时。

为什么？:PI 很困惑。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T10:37:01.120

所以我解决了这个问题。

在我的加载器活动中，我在 onCreate 中创建了一个片段，其中包含我的列表和我的 set_result 函数。

尽管在我重新创建有关方向更改的活动时，加载程序已成功保留，但它正在创建另一个具有相同标签的片段，而不是使用保留的片段。

因此，当我调用我的 set_result 函数时，我假设它正在查找我的初始片段并在其上设置列表。

当您创建两个具有相同标签的片段时，我不确定 100% 片段是如何工作的 - 我只能假设重新创建的版本被放置在我最初的版本之上，从而隐藏了它。

# c# - 如果调试和生产中的调试文件路径。模式

> ID：15991132
> 
> 赞同：0
> 
> 时间：2013-04-13T18:07:28.920
> 
> 标签：c#, .net

我想从特定路径位置读取文件。该位置在本地服务器和在线服务器上具有不同的磁盘号和目录结构。

所以我希望默认设置文件路径以满足我的在线服务器磁盘以及当我调试应用程序以使用本地文件路径时。

我试过这个

```
private const string _configurationFilePath = @"E:\web\mysite\";   
#if DEBUG
enter code here
_configurationFilePath = @"D:\mywebprj\mysite\";
#endif 
```

我收到错误消息已经包含 _configurationPath 的定义

在不使用配置文件和其他手动输入的解决方案的情况下，有没有更好的方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:11:11.337

You use `private const string` so it cannot be modified. Write you code like this:

```
#if !DEBUG
    private const string _configurationFilePath = @"E:\web\mysite\";   
#endif
#if DEBUG
enter code here
    private const string _configurationFilePath = @"D:\mywebprj\mysite\";
#endif 
```

BTW much better idea is to store this path in configuration instead of harcoding it.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:41:22.203

一种更好的解决方案。您可以在项目文件的 afterbuild 部分中使用复制 msbuild 任务。

您可以使用命名法 app.$(configuration).config 根据解决方案配置名称创建多个 app.config。示例：app.Debug.config。app.Release.config 等

然后使用 msbuild 复制任务将只有一个应用程序配置文件复制到 $(OutDir) 作为 MyProject.exe.config。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T18:12:09.280

利用`#if DEBUG #else #endif`

```
#if DEBUG
    private const string a = @"d:\";
#else
    private const string a = @"e:\";
#endif 
```

# c# - 如何获取cmd位置？

> ID：15991133
> 
> 赞同：0
> 
> 时间：2013-04-13T18:07:33.973
> 
> 标签：c#

我正在使用 c# .net 4.5；我的问题是如何获得 cmd 位置。例如，为了获得我自己的表单位置 `this.Location`，我得到了 x 和 y。对于正在运行但与我自己的应用程序无关的应用程序，我怎么能做到这一点？我知道这是可能的，因为 Windows 8 使用类似的东西。:)

感谢您的帮助...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:19:14.140

乍一看，您的问题似乎是您想要应用程序 exe 的位置而不是窗口的位置。如果你想要窗口的位置，你需要使用 API。

```
[StructLayout(LayoutKind.Sequential)]
public struct Rect
{
    public int left;
    public int top;
    public int right;
    public int bottom;
}

[DllImport("user32.dll")]
public static extern IntPtr GetWindowRect(IntPtr hWnd, ref Rect rect 
```

然后像这样使用它：

```
var proc = Process.GetProcessesByName(proccessName)[0];   
Rect rect = new Rect();
GetWindowRect(proc.MainWindowHandle, ref rect); 
```

希望能帮助到你

有关更多信息，请查看[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633519%28v=vs.85%29.aspx)和[pInvoke](http://www.pinvoke.net/default.aspx/user32/GetWindowRect.html)

# angularjs - 从AngularJS中的指令调用父控制器的方法

> ID：15991137
> 
> 赞同：69
> 
> 时间：2013-04-13T18:08:06.553
> 
> 标签：angularjs, angularjs-directive

在我之前的[问题](https://stackoverflow.com/questions/15990122/passing-object-to-angularjs-directive-from-the-controller)之后，我现在尝试从我的指令中调用父控制器上的方法。我得到一个未定义的参数。这就是我所做的：

```
<body ng-app="myApp" ng-controller="MainCtrl">
  <span>{{mandat.rum}}</span>
  <span>{{mandat.surname}}</span>
<input type="text" ng-model="mandat.person.firstname" />
<my-directive mandate-person="mandat.person" updateparent="updatePerson()" >

  </my-directive>
</body> 
```

和脚本：

```
var app = angular.module('myApp', []);

    app.controller('MainCtrl', function ($scope) {
        $scope.mandat = { name: "John", surname: "Doe", person: { id: 1408, firstname: "sam" } };
        $scope.updatePerson = function(person) {
            alert(person.firstname);
          $scope.mandat.person = person;   
        }
    });

    app.directive('myDirective', function () {
        return {
            restrict: 'E',
            template: "<div><span>{{mandatePerson.id}}<span><input type='text' ng-model='mandatePerson.firstname' /><button ng-click='updateparent({person: mandatePerson})'>click</button></div>",
            replace: true,
            scope: { mandatePerson: '=', updateparent: '&' }
            }
        }
    ) 
```

当调用 updatePerson 方法时，person 是未定义的。

jsfiddle在这里：http: [//jsfiddle.net/graphicsxp/Z5MBf/7/](http://jsfiddle.net/graphicsxp/Z5MBf/7/)

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-04-13T18:45:25.483

只需简单地更改您的html，如下所示

```
<my-directive mandate-person="mandat.person" updateparent="updatePerson(person)" >

      </my-directive> 
```

您没有通过 updatePerson 传递“人”，这就是它不起作用的原因

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2015-01-17T08:40:50.670

访问控制器方法意味着从指令控制器/链接/作用域访问父作用域上的方法。

如果指令正在共享/继承父范围，那么只需调用父范围方法就很简单了。

当您想从独立指令范围访问父范围方法时，需要做更多的工作。

很少有选项（可能比下面列出的更多）可以从隔离指令范围调用父范围方法或监视父范围变量（特别是**选项#6**）。

*请注意*，我`link function`在这些示例中使用了，但您也可以`directive controller`根据要求使用 a 。

**选项1。** **通过对象文字和来自指令 html 模板**

**`index.html`**

```
<!DOCTYPE html>
<html ng-app="plunker">

  <head>
    <meta charset="utf-8" />
    <title>AngularJS Plunker</title>
    <script>document.write('<base href="' + document.location + '" />');</script>
    <link rel="stylesheet" href="style.css" />
    <script data-require="angular.js@1.3.x" src="https://code.angularjs.org/1.3.9/angular.js" data-semver="1.3.9"></script>
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <p>Hello {{name}}!</p>

    <p> Directive Content</p>
    <sd-items-filter selected-items="selectedItems" selected-items-changed="selectedItemsChanged(selectedItems)" items="items"> </sd-items-filter>

    <P style="color:red">Selected Items (in parent controller) set to: {{selectedItemsReturnedFromDirective}} </p>

  </body>

</html> 
```

**`itemfilterTemplate.html`**

```
<select ng-model="selectedItems" multiple="multiple" style="height: 200px; width: 250px;" ng-change="selectedItemsChanged({selectedItems:selectedItems})" ng-options="item.id as item.name group by item.model for item in items | orderBy:'name'">
  <option>--</option>
</select> 
```

**`app.js`**

```
var app = angular.module('plunker', []);

app.directive('sdItemsFilter', function() {
  return {
    restrict: 'E',
    scope: {
      items: '=',
      selectedItems: '=',
      selectedItemsChanged: '&'
    },
    templateUrl: "itemfilterTemplate.html"
  }
})

app.controller('MainCtrl', function($scope) {
  $scope.name = 'TARS';

  $scope.selectedItems = ["allItems"];

  $scope.selectedItemsChanged = function(selectedItems1) {
    $scope.selectedItemsReturnedFromDirective = selectedItems1;
  }

  $scope.items = [{
    "id": "allItems",
    "name": "All Items",
    "order": 0
  }, {
    "id": "CaseItem",
    "name": "Case Item",
    "model": "PredefinedModel"
  }, {
    "id": "Application",
    "name": "Application",
    "model": "Bank"
    }]

}); 
```

工作 plnkr：[http ://plnkr.co/edit/rgKUsYGDo9O3tewL6xgr?p=preview](http://plnkr.co/edit/rgKUsYGDo9O3tewL6xgr?p=preview)

**选项#2。通过对象文字和来自指令链接/范围**

**`index.html`**

```
<!DOCTYPE html>
<html ng-app="plunker">

  <head>
    <meta charset="utf-8" />
    <title>AngularJS Plunker</title>
    <script>document.write('<base href="' + document.location + '" />');</script>
    <link rel="stylesheet" href="style.css" />
    <script data-require="angular.js@1.3.x" src="https://code.angularjs.org/1.3.9/angular.js" data-semver="1.3.9"></script>
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <p>Hello {{name}}!</p>

    <p> Directive Content</p>
    <sd-items-filter selected-items="selectedItems" selected-items-changed="selectedItemsChanged(selectedItems)" items="items"> </sd-items-filter>

    <P style="color:red">Selected Items (in parent controller) set to: {{selectedItemsReturnedFromDirective}} </p>

  </body>

</html> 
```

**`itemfilterTemplate.html`**

```
<select ng-model="selectedItems" multiple="multiple" style="height: 200px; width: 250px;" 
 ng-change="selectedItemsChangedDir()" ng-options="item.id as item.name group by item.model for item in items | orderBy:'name'">
  <option>--</option>
</select> 
```

**`app.js`**

```
var app = angular.module('plunker', []);

app.directive('sdItemsFilter', function() {
  return {
    restrict: 'E',
    scope: {
      items: '=',
      selectedItems: '=',
      selectedItemsChanged: '&'
    },
    templateUrl: "itemfilterTemplate.html",
    link: function (scope, element, attrs){
      scope.selectedItemsChangedDir = function(){
        scope.selectedItemsChanged({selectedItems:scope.selectedItems});  
      }
    }
  }
})

app.controller('MainCtrl', function($scope) {
  $scope.name = 'TARS';

  $scope.selectedItems = ["allItems"];

  $scope.selectedItemsChanged = function(selectedItems1) {
    $scope.selectedItemsReturnedFromDirective = selectedItems1;
  }

  $scope.items = [{
    "id": "allItems",
    "name": "All Items",
    "order": 0
  }, {
    "id": "CaseItem",
    "name": "Case Item",
    "model": "PredefinedModel"
  }, {
    "id": "Application",
    "name": "Application",
    "model": "Bank"
    }]
}); 
```

工作 plnkr：[http ://plnkr.co/edit/BRvYm2SpSpBK9uxNIcTa?p=preview](http://plnkr.co/edit/BRvYm2SpSpBK9uxNIcTa?p=preview)

**选项#3。通过函数引用和来自指令 html 模板**

**`index.html`**

```
<!DOCTYPE html>
<html ng-app="plunker">

  <head>
    <meta charset="utf-8" />
    <title>AngularJS Plunker</title>
    <script>document.write('<base href="' + document.location + '" />');</script>
    <link rel="stylesheet" href="style.css" />
    <script data-require="angular.js@1.3.x" src="https://code.angularjs.org/1.3.9/angular.js" data-semver="1.3.9"></script>
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <p>Hello {{name}}!</p>

    <p> Directive Content</p>
    <sd-items-filter selected-items="selectedItems" selected-items-changed="selectedItemsChanged" items="items"> </sd-items-filter>

    <P style="color:red">Selected Items (in parent controller) set to: {{selectedItemsReturnFromDirective}} </p>

  </body>

</html> 
```

**`itemfilterTemplate.html`**

```
<select ng-model="selectedItems" multiple="multiple" style="height: 200px; width: 250px;" 
 ng-change="selectedItemsChanged()(selectedItems)" ng-options="item.id as item.name group by item.model for item in items | orderBy:'name'">
  <option>--</option>
</select> 
```

**`app.js`**

```
var app = angular.module('plunker', []);

app.directive('sdItemsFilter', function() {
  return {
    restrict: 'E',
    scope: {
      items: '=',
      selectedItems:'=',
      selectedItemsChanged: '&'
    },
    templateUrl: "itemfilterTemplate.html"
  }
})

app.controller('MainCtrl', function($scope) {
  $scope.name = 'TARS';

  $scope.selectedItems = ["allItems"];

  $scope.selectedItemsChanged = function(selectedItems1) {
    $scope.selectedItemsReturnFromDirective = selectedItems1;
  }

  $scope.items = [{
    "id": "allItems",
    "name": "All Items",
    "order": 0
  }, {
    "id": "CaseItem",
    "name": "Case Item",
    "model": "PredefinedModel"
  }, {
    "id": "Application",
    "name": "Application",
    "model": "Bank"
    }]
}); 
```

工作 plnkr：[http ://plnkr.co/edit/Jo6FcYfVXCCg3vH42BIz?p=preview](http://plnkr.co/edit/Jo6FcYfVXCCg3vH42BIz?p=preview)

**选项#4。通过函数引用和指令链接/范围**

**`index.html`**

```
<!DOCTYPE html>
<html ng-app="plunker">

  <head>
    <meta charset="utf-8" />
    <title>AngularJS Plunker</title>
    <script>document.write('<base href="' + document.location + '" />');</script>
    <link rel="stylesheet" href="style.css" />
    <script data-require="angular.js@1.3.x" src="https://code.angularjs.org/1.3.9/angular.js" data-semver="1.3.9"></script>
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <p>Hello {{name}}!</p>

    <p> Directive Content</p>
    <sd-items-filter selected-items="selectedItems" selected-items-changed="selectedItemsChanged" items="items"> </sd-items-filter>

    <P style="color:red">Selected Items (in parent controller) set to: {{selectedItemsReturnedFromDirective}} </p>

  </body>

</html> 
```

**`itemfilterTemplate.html`**

```
<select ng-model="selectedItems" multiple="multiple" style="height: 200px; width: 250px;" ng-change="selectedItemsChangedDir()" ng-options="item.id as item.name group by item.model for item in items | orderBy:'name'">
  <option>--</option>
</select> 
```

**`app.js`**

```
var app = angular.module('plunker', []);

app.directive('sdItemsFilter', function() {
  return {
    restrict: 'E',
    scope: {
      items: '=',
      selectedItems: '=',
      selectedItemsChanged: '&'
    },
    templateUrl: "itemfilterTemplate.html",
    link: function (scope, element, attrs){
      scope.selectedItemsChangedDir = function(){
        scope.selectedItemsChanged()(scope.selectedItems);  
      }
    }
  }
})

app.controller('MainCtrl', function($scope) {
  $scope.name = 'TARS';

  $scope.selectedItems = ["allItems"];

  $scope.selectedItemsChanged = function(selectedItems1) {
    $scope.selectedItemsReturnedFromDirective = selectedItems1;
  }

  $scope.items = [{
    "id": "allItems",
    "name": "All Items",
    "order": 0
  }, {
    "id": "CaseItem",
    "name": "Case Item",
    "model": "PredefinedModel"
  }, {
    "id": "Application",
    "name": "Application",
    "model": "Bank"
    }]

}); 
```

工作 plnkr：[http ://plnkr.co/edit/BSqx2J1yCY86IJwAnQF1?p=preview](http://plnkr.co/edit/BSqx2J1yCY86IJwAnQF1?p=preview)

**Option#5：通过 ng-model 和双向绑定，可以更新父作用域变量。**. 因此，在某些情况下，您可能不需要调用父范围函数。

**`index.html`**

```
<!DOCTYPE html>
<html ng-app="plunker">

  <head>
    <meta charset="utf-8" />
    <title>AngularJS Plunker</title>
    <script>document.write('<base href="' + document.location + '" />');</script>
    <link rel="stylesheet" href="style.css" />
    <script data-require="angular.js@1.3.x" src="https://code.angularjs.org/1.3.9/angular.js" data-semver="1.3.9"></script>
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <p>Hello {{name}}!</p>

    <p> Directive Content</p>
    <sd-items-filter ng-model="selectedItems" selected-items-changed="selectedItemsChanged" items="items"> </sd-items-filter>

    <P style="color:red">Selected Items (in parent controller) set to: {{selectedItems}} </p>

  </body>

</html> 
```

**`itemfilterTemplate.html`**

```
<select ng-model="selectedItems" multiple="multiple" style="height: 200px; width: 250px;" 
 ng-options="item.id as item.name group by item.model for item in items | orderBy:'name'">
  <option>--</option>
</select> 
```

**`app.js`**

```
var app = angular.module('plunker', []);

app.directive('sdItemsFilter', function() {
  return {
    restrict: 'E',
    scope: {
      items: '=',
      selectedItems: '=ngModel'
    },
    templateUrl: "itemfilterTemplate.html"
  }
})

app.controller('MainCtrl', function($scope) {
  $scope.name = 'TARS';

  $scope.selectedItems = ["allItems"];

  $scope.items = [{
    "id": "allItems",
    "name": "All Items",
    "order": 0
  }, {
    "id": "CaseItem",
    "name": "Case Item",
    "model": "PredefinedModel"
  }, {
    "id": "Application",
    "name": "Application",
    "model": "Bank"
    }]
}); 
```

工作 plnkr：[http ://plnkr.co/edit/hNui3xgzdTnfcdzljihY?p=preview](http://plnkr.co/edit/hNui3xgzdTnfcdzljihY?p=preview)

**选项#6：通过`$watch`和`$watchCollection`**以上所有示例 中的两种方式绑定`items`，如果项目在父范围内被修改，指令中的项目也将反映更改。

如果您想从父范围内查看其他属性或对象，您可以使用`$watch`和`$watchCollection`如下所示

**html**

```
<!DOCTYPE html>
<html ng-app="plunker">

<head>
  <meta charset="utf-8" />
  <title>AngularJS Plunker</title>
  <script>
    document.write('<base href="' + document.location + '" />');
  </script>
  <link rel="stylesheet" href="style.css" />
  <script data-require="angular.js@1.3.x" src="https://code.angularjs.org/1.3.9/angular.js" data-semver="1.3.9"></script>
  <script src="app.js"></script>
</head>

<body ng-controller="MainCtrl">
  <p>Hello {{user}}!</p>
  <p>directive is watching name and current item</p>
  <table>
    <tr>
      <td>Id:</td>
      <td>
        <input type="text" ng-model="id" />
      </td>
    </tr>
    <tr>
      <td>Name:</td>
      <td>
        <input type="text" ng-model="name" />
      </td>
    </tr>
    <tr>
      <td>Model:</td>
      <td>
        <input type="text" ng-model="model" />
      </td>
    </tr>
  </table>

  <button style="margin-left:50px" type="buttun" ng-click="addItem()">Add Item</button>

  <p>Directive Contents</p>
  <sd-items-filter ng-model="selectedItems" current-item="currentItem" name="{{name}}" selected-items-changed="selectedItemsChanged" items="items"></sd-items-filter>

  <P style="color:red">Selected Items (in parent controller) set to: {{selectedItems}}</p>
</body>

</html> 
```

**脚本 app.js**

```
var app = angular.module('plunker', []);

app.directive('sdItemsFilter', function() {
  return {
    restrict: 'E',
    scope: {
      name: '@',
      currentItem: '=',
      items: '=',
      selectedItems: '=ngModel'
    },
    template: '<select ng-model="selectedItems" multiple="multiple" style="height: 140px; width: 250px;"' +
      'ng-options="item.id as item.name group by item.model for item in items | orderBy:\'name\'">' +
      '<option>--</option> </select>',
    link: function(scope, element, attrs) {
      scope.$watchCollection('currentItem', function() {
        console.log(JSON.stringify(scope.currentItem));
      });
      scope.$watch('name', function() {
        console.log(JSON.stringify(scope.name));
      });
    }
  }
})

 app.controller('MainCtrl', function($scope) {
  $scope.user = 'World';

  $scope.addItem = function() {
    $scope.items.push({
      id: $scope.id,
      name: $scope.name,
      model: $scope.model
    });
    $scope.currentItem = {};
    $scope.currentItem.id = $scope.id;
    $scope.currentItem.name = $scope.name;
    $scope.currentItem.model = $scope.model;
  }

  $scope.selectedItems = ["allItems"];

  $scope.items = [{
    "id": "allItems",
    "name": "All Items",
    "order": 0
  }, {
    "id": "CaseItem",
    "name": "Case Item",
    "model": "PredefinedModel"
  }, {
    "id": "Application",
    "name": "Application",
    "model": "Bank"
  }]
}); 
```

您可以随时参考 AngularJs 文档以获取有关指令的详细说明。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-05-24T09:05:33.850

有两种方法，我们可以调用 using`&`和`=`。

**如果我使用`=`范围属性**，那么

```
ng-click='updateparent({person: mandatePerson})' 
```

将改为

```
ng-click='updateparent(mandatePerson)' 
```

* * *

在指令中，

```
updateparent="updatePerson()" 
```

将更改为

```
updateparent="updatePerson" 
```

此处无需提及参数，它们将作为参考传递给控制器​​的函数定义。

使用`&`在其他答案中进行了解释。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-15T23:09:02.477

这是另一种模式（适用于**Angular 1.5**）。

```
angular.module('module', [])

    .controller('MyController', function() {

        var self = this;
        self.msg = 0;
        // implement directive event listener interface
        this.onEvent = function(arg) {
            self.msg++;
        };
    })

    .directive('myDirective', function() {
        return {
          scope: {
            data: '=',
            handler: '='
          },
          template: '<button ng-click="handler.onEvent(data)">Emit event</button>'
        }
    });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>

<div ng-app="module" ng-controller="MyController as ctrl">
<my-directive handler="ctrl" data="'...received'"></my-directive>
  {{ctrl.msg}}
</div>
```

# c# - C# 自定义边框标题栏菜单

> ID：15991143
> 
> 赞同：0
> 
> 时间：2013-04-13T18:09:03.990
> 
> 标签：c#, winforms, api

我创建了带有自定义边框和标题栏的 C# winforms。我已经禁用了`(ControlBox = false)`论坛上的控制框，但它似乎也禁用了右键单击标题栏时出现的系统上下文菜单。将控制框设置为 false 时是否可以使用上下文菜单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:13:31.837

据我所知，简短回答不

长答案您不能使用上下文菜单，因为它是控制框本身的一部分

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:54:05.317

@System.Object 是对的，上下文菜单是控制框的一部分，但是如果你真的想拥有它，你可以自己写，因为我在 windows7 中看到了默认的标题栏上下文菜单（恢复，大小，移动，退出等。）没什么大不了的。

或者

你可以用 c# 重写你的项目，`WPF`没有太大区别。而且，如果您正在计划更复杂的设计，从长远来看应该会有所回报。

# jpa - Why won't my EJB Entity work with a non-relational table, when using createNativeQuery?

> ID：15991144
> 
> 赞同：0
> 
> 时间：2013-04-13T18:09:05.053
> 
> 标签：jpa, jpa-2.0

I'm trying to use entities with a MySQL ndbcluster table. This table type doesn't allow foreign keys, but up until now it hasn't been a problem with my entities.

However, I have run into a bit of a problem, when I try to load an entity using the EntityManager's createNativeQuery method. I need to use this method due to my inability to do this: [How to make a CriteriaBuilder join with a custom "on" condition?](https://stackoverflow.com/questions/15990141/how-to-make-a-criteriabuilder-join-with-a-custom-on-condition)

My MySQL table looks like this:

```
CREATE TABLE `category` (
    `id` SMALLINT(6) NOT NULL AUTO_INCREMENT,
    `category_id` SMALLINT(6) NULL DEFAULT NULL,
    PRIMARY KEY (`id`),
    INDEX `category_id` (`category_id`)
)
COLLATE='utf8_general_ci'
ENGINE=ndbcluster
ROW_FORMAT=DEFAULT 
```

If I change the table engine to innodb, and add foreign keys, the createNativeQuery method works fine.

My entity class looks like this:

```
@Entity
@Table(name = "category")
public class Category implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @Column(name = "id")
    private Short id;
    @OneToMany(mappedBy = "categoryId")
    private List<Category> categoryList;
    @JoinColumn(name = "category_id", referencedColumnName = "id")
    @ManyToOne
    private Category categoryId;

    public Category() {
    }

    // getters and setters
} 
```

Even without foreign keys, this entity works fine when I use the CriteriaBuilder for a query, but unfortunately not everything is possible with the CriteriaBuilder.

I get an error when I call getResultList on a Query object created with createNativeQuery. I don't know if this is a bug, or if something should be added to my entity class to make this work.

The error says:

```
Exception [EclipseLink-6044] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.QueryException
Exception Description: The primary key read from the row [ArrayRecord(
 => 2519
 => 2463
 => Tools)] during the execution of the query was detected to be null.  Primary keys must not contain null.
Query: ReadAllQuery(referenceClass=Category sql="select * from `category`")
at org.eclipse.persistence.exceptions.QueryException.nullPrimaryKeyInBuildingObject(QueryException.java:895)
at org.eclipse.persistence.internal.descriptors.ObjectBuilder.buildObject(ObjectBuilder.java:584)
at org.eclipse.persistence.internal.descriptors.ObjectBuilder.buildObject(ObjectBuilder.java:560)
at org.eclipse.persistence.queries.ObjectLevelReadQuery.buildObject(ObjectLevelReadQuery.java:717)
at org.eclipse.persistence.queries.ReadAllQuery.registerResultInUnitOfWork(ReadAllQuery.java:769)
... 
```

My table contains 1 row, where id=1 and category_id=null, so there are no primary keys with a null-value, despite what the error says. If I remove that row or set category_id=1, I don't get an error.

Need help, please.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T21:10:11.053

通过从 EclipseLink (JPA 2.0) 切换到 OpenJPA (JPA 2.0) 来管理它。似乎 EclipseLink 2.3.2 和/或 GlassFish 3.1.2.2 中的某个地方存在错误。

我在我的另一个项目中使用了 EclipseLink (JPA 2.0)，使用稍微不同的版本 Netbeans + GlassFish 3.1.1，我在实体类上使用 createNativeQuery 来获取非关系 myisam 表。这从来没有引起任何问题。确实应该是bug。

但是问题解决了。再见，再见 EclipseLink，你好 OpenJPA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T13:25:44.003

问题是区分大小写。在 MySQL 中，除非您引用它，否则您的列“id”将在数据库中定义为“ID”。如果您将映射切换为大写，它应该可以解决问题（即“ID”）。

您还可以引用列名（“'id'”）

或设置持久性单元属性，

“eclipselink.jpa.uppercase-column-names”=“真”

# javascript - Can i make my code shorter?

> ID：15991145
> 
> 赞同：2
> 
> 时间：2013-04-13T18:09:07.683
> 
> 标签：javascript

I have many functions for calculating some stats , and i need to recheck the value's every time but that is extra code and make's it harder to read , can i store the variable assignment in another function:

```
function MC () {
var check=document.getElementById('check').checked;

var ea=Number(document.form.ea.value),
    ed=Number(document.form.ed.value),
    pa=Number(document.form.pa.value),
    pd=Number(document.form.pd.value);

var hpSum = 0,spSum=0,eaSum=0,edSum=0,pdSum=0,paSum=0;

if(check){
    eaSum = ea + 11;
    edSum = ed + 17;
    pdSum = pd + 17;
    paSum = pa + 11;
} else {
    eaSum = ea - 11;
    edSum = ed - 17;
    pdSum = pd - 17;
    paSum = pa - 11;
}

    document.form.ea.value=eaSum;
    document.form.ed.value=edSum;
    document.form.pa.value=paSum;
    document.form.pd.value=pdSum;
}; 
```

NOTE:I am speaking for the variables:ea,ed,pa,pd and sum variables.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:13:05.110

您可以尝试构建参数对象：

```
function MC() {
  var check = document.getElementById('check').checked,
      keys = {
        "ea":11,
        "ed":17,
        "pd":17,
        "pa":11
      }, i;
  for( i in keys) { if( keys.hasOwnProperty(i)) {
    document.form[i].value = +document.form[i].value + (check ? keys[i] : -keys[i]);
  }}
} 
```

请注意，这`+somevar`是`parseFloat(somevar)`. `Number(somevar)`与它创建的包装对象不同，如果您稍后添加任何内容，可能会干扰比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:34:52.787

我会用你自己的代码，浓缩一点。假设 form 是表单的名称，则需要更多的代码来跟踪哪些输入已更改，而不是读取它们。

```
function MC () {
    var f= document.form,
    v= document.getElementById('check').checked? [11, 17]:[-11, -17];
    f.ea.value= Number(f.ea.value)+v[0];
    f.ed.value= Number(f.ed.value)+v[1];
    f.pa.value= Number(f.pa.value)+v[0];
    f.pd.value= Number(f.pd.value)+v[1];
} 
```

# iphone - AppDelegate 没有正确初始化 viewController

> ID：15991148
> 
> 赞同：1
> 
> 时间：2013-04-13T18:09:24.590
> 
> 标签：iphone, ios, appdelegate

我正在使用[PaperFoldMenuController](https://github.com/honcheng/PaperFoldMenuController)在我的应用程序中创建一个很酷的 SlideMenu。

在 AppDelegate 中，我定义了 viewController 并将它们添加到 SlideMenu 数组中：

```
// Init viewControllers
       RootViewController *rootViewController = [[RootViewController alloc] init];
     LivetickerViewController *livetickerViewController = [[LivetickerViewController alloc] init];

// Add view controllers to array
    [viewControllers addObject:rootNavController];
    [viewControllers addObject:livetickerNavController];

    // Add to PaperFoldView
    [_menuController setViewControllers:viewControllers]; 
```

我使用故事板来设计 LivetickerViewController 的大部分部分。但并未显示所有更改。我检查了 Storyboard 是否与视图相关联。

代码中有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:02:50.113

如果您在情节提要中设计了 LivetickerViewController，那么您需要从情节提要中获取它，而不是使用 alloc init。

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
LivetickerViewController *livetickerViewController = [storyboard instantiateViewControllerWithIdentifier:@"livetickerViewController"]; 
```

确保情节提要的名称是您项目中的实际名称，并且您已为视图控制器提供了一个与您在 instantiateViewControllerWithIdentifier: 方法中传递的内容相匹配的标识符。

如果你在故事板中创建了 rootViewController，你应该对它做同样的事情。

# android - Log in with twitter4j callback

> ID：15991149
> 
> 赞同：1
> 
> 时间：2013-04-13T18:09:33.873
> 
> 标签：android, callback, twitter, twitter-oauth, twitter4j

I try to write an application where an user can log in on twitter. I use twitter4j like library.My problem is that when I go in the page where I must put username and password, the program block because i don't know use callback to came in my application. Someone can me help?

public class MainActivity extends Activity {

```
private Twitter twitter;
RequestToken requestToken;
final public static String CALLBACK_SCHEME = "x-latify-oauth-twitter";
final public static String CALLBACK_URL = CALLBACK_SCHEME + "://callback";
private Uri uri;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Button b = (Button) findViewById(R.id.button1);
    b.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            new updateTwitterStatus().execute();

        }
    });

}

@Override
protected void onDestroy() {

    twitter.shutdown();
}

class updateTwitterStatus extends AsyncTask<Void, Void, String> {

    @Override
    protected String doInBackground(Void... params) {
        String testStatus = "prova tweet ";

        ConfigurationBuilder cb = new ConfigurationBuilder();

        // the following is set without accesstoken- desktop client
        cb.setDebugEnabled(true)
                .setOAuthConsumerKey("******")
                .setOAuthConsumerSecret(
                        "*****");

        try {
            TwitterFactory tf = new TwitterFactory(cb.build());
            twitter = tf.getInstance();
            Log.i("bauu", "miao");

            requestToken = twitter.getOAuthRequestToken();
            String authUrl = requestToken.getAuthenticationURL();
            startActivity(new Intent(Intent.ACTION_VIEW,
                    Uri.parse(requestToken.getAuthenticationURL())));
            uri = Uri.parse(requestToken.getAuthenticationURL());

            return authUrl;

        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onPostExecute(String s) {

        startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(s)));    
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:25:19.460

确保您在 twitter 开发应用程序选项中的回调 URL 如下所示，

```
http://YOUR-URL/app://YOUR-APP-HOST 
```

在您的 android 清单文件中，在将您带到 twitter 的活动之间，确保您定义：

```
 <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data
              android:host="YOUR-APP-HOST"
              android:scheme="app" />
          </intent-filter> 
```

最后，确保在你的程序中，

```
final public static String CALLBACK_URL = "app://YOUR-APP-HOST"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T17:01:04.917

只需 4 个简单步骤即可登录 Twitter：

1-为您的活动添加*意图过滤器*（基于@rennoDeniro 响应）`AndroidManifest.xml`

```
 <intent-filter>
    <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
    <data
              android:host="twitter"
              android:scheme="myapp" />
 </intent-filter> 
```

2- 定义 twitter 密钥和秘密`strings.xml`

```
<string name="twitter_consumerKey">XXX</string>
<string name="twitter_consumerSecret">XXX</string> 
```

3- 请求 twitter 注册页面`MainActivity.java`

```
public String CALLBACK_URL="myapp://twitter";
public Twitter twitter;
private static RequestToken rToken;

public void onLoginTwitter(View v) {
    (new RequestTwitterLoginTask()).execute();
}

class RequestTwitterLoginTask extends AsyncTask<Void, Void, String> {

    @Override
    protected String doInBackground(Void... params) {
        twitter = new TwitterFactory().getInstance();
        try
        {
            twitter.setOAuthConsumer(R.string.twitter_consumerKey, R.string.twitter_consumerSecret);
            String callbackURL = CALLBACK_URL;
            rToken= twitter.getOAuthRequestToken(callbackURL);

        }
        catch(Exception e)
        {
               Toast.makeText(getApplicationContext(), "Exception: " + e.toString(),Toast.LENGTH_SHORT).show();
            e.printStackTrace();
        }            

        return null;
    }

    @Override
    protected void onPostExecute(String s) {
        startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(rToken.getAuthenticationURL())));
    }
} 
```

4-处理回调`MainActivity.java`

```
public void onResume(){
    super.onResume();

    if (this.getIntent()!=null && this.getIntent().getData()!=null){
        Uri uri = this.getIntent().getData();

        //handle returning from authenticating the user
        if (uri != null && uri.toString().startsWith(CALLBACK_URL)) {
            String token = uri.getQueryParameter("oauth_token");
            String verifier = uri.getQueryParameter("oauth_verifier");

            try {
                Twitter t = new TwitterFactory().getInstance();
                t.setOAuthConsumer(getResources().getString(R.string.twitter_consumerKey), getResources().getString(R.string.twitter_consumerSecret));

                AccessToken accessToken = t.getOAuthAccessToken(rToken,verifier);

                long userID = accessToken.getUserId();
                User user = t.showUser(userID);

                /* Do whatever you want */
            } catch (TwitterException e) {
                Toast.makeText(getApplicationContext(), "Twitter Exception: " + e.toString(),Toast.LENGTH_SHORT).show();
                e.printStackTrace();
            }

            return;
        }
    }    

    Toast.makeText(getApplicationContext(), "Resume",Toast.LENGTH_SHORT).show();

} 
```

# php - 单击或替代方法更改输入标签值？

> ID：15991150
> 
> 赞同：1
> 
> 时间：2013-04-13T18:09:46.557
> 
> 标签：php, html

我有一些 PHP 代码打印交易表中的数据行。每一行就像

用户名-报价-交换-日期-交易

TRADE 是一个输入，单击时，相关的 PHP 会检查并相应地更新数据库。

如果 POST 等

```
$idn=strip_tags($_POST['buy']));

$query1=$db->prepare("SELECT * FROM tradeauction WHERE id=:buyid");
$query1->execute(array(':buyid'=>$idn)); 
```

///检查等

这是包含 TRADE 输入/按钮的 div : (我知道这可能是一个很长的路要走，但是它的旧代码，我只是想整理它并将整个站点从 mysql 转换为 PDO。 )

```
 <div class="buyrow left">
        <?PHP echo"<input class=\"changeBlue\" onmouseover=\"this.className='changeBlueoff'; document.getElementById('$ct->id').className='changeBlueoff'\" 
    onmouseout=\"this.className='changeBlue'; getElementById('$ct->id').className='changeBlue'\" 
onclick=\"this.value='$ct->id'; this.submit()\" type=\"submit\" value=\"Trade\" name=\"buy\">"; ?> &nbsp; 
       </div>

    $ct->id 
```

显然是行的id。

类更改只是更改按钮的颜色。

当前单击时，它可以工作，但会向用户简要显示 id。我不希望这种情况发生。我只想让它一直简单地说交易。（悬停时为蓝色）

如何使单击时不显示该值，但仍将 id 值传递给 PHP 检查？或者有人可以提出另一种更简单的方法来实现这一目标吗？

编辑：对于交易中的每个 ID（行），它将以 HTML 格式打印-

```
<div id="cashtrades">
  <div class="trrow left"> <?php echo "<a href=profile.php?viewuser=$ct->username >$ct->username</a>"?></div>
  <div class="prrow left"><?PHP echo"$showname"; ?></div>
  <div class="ofrow left"><?PHP echo"$symbolcheck".makecomma($ct->item_amount)." $itemcheck"; ?> </div>
  <div class="exrow left"><?PHP echo"$exsymcheck".makecomma($ct->exchange_amount)." $exitemcheck"; ?></div>
  <div class="darow left"><?PHP echo"$ct->datepost"; ?></div>
  <div class="buyrow left"><?PHP echo"<input class=\"changeBlue\" onmouseover=\"this.className='changeBlueoff'; document.getElementById('$ct->id').className='changeBlueoff'\" 
          onmouseout=\"this.className='changeBlue'; getElementById('$ct->id').className='changeBlue'\" 
          onclick=\"this.value='$ct->id'; this.submit()\" type=\"submit\" value=\"Trade\" name=\"buy\">";?>&nbsp;</div> 
  </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:47:24.250

看看[JQuery](http://jquery.com/)。您会发现它将彻底改变您与 javascript 的交互。如果您不确定所有 {}(){()} 的含义，请搜索 Douglas Crockford 并观看他的视频。

那就是说。

```
<div class="buyrow left"><?PHP echo"<input class=\"changeBlue\" onmouseover=\"this.className='changeBlueoff'; document.getElementById('$ct->id').className='changeBlueoff'\" 
      onmouseout=\"this.className='changeBlue'; getElementById('$ct->id').className='changeBlue'\" 
      onclick=\"this.value='$ct->id'; this.submit()\" type=\"submit\" value=\"Trade\" name=\"buy\">";?>&nbsp;</div> 
```

尝试

```
 <div class="buyrow left">
// this is a new hidden input with the buy id 
<input type=hidden name=buy id=buyinput value=<?php echo $ct->id ?> >

//onclick Submit
<?PHP echo"<input class=\"changeBlue\" onmouseover=\"this.className='changeBlueoff'; document.getElementById('$ct->id').className='changeBlueoff'\" 
      onmouseout=\"this.className='changeBlue'; getElementById('$ct->id').className='changeBlue'\" 
      onclick=\"this.submit()\" type=\"submit\" value=\"Trade\" name=\"anotherbuy\">";?>&nbsp;</div> 
```

阅读此代码非常困难，我认为您应该以另一种方式执行此操作，但是上面的内容应该可以解决您的问题。

# javascript - What is the simplest method to write a file with Chrome file interface?

> ID：15991151
> 
> 赞同：0
> 
> 时间：2013-04-13T18:09:46.700
> 
> 标签：javascript

Chrome implements the file interface as described here [http://www.html5rocks.com/en/tutorials/file/filesystem/](http://www.html5rocks.com/en/tutorials/file/filesystem/), just adding the `webkit` prefix. The documentation covers several aspects of the interface, but what are the simplest steps, for example, to prompt the user with a file saving dialog, or to tell him that the file has been saved somewhere? For example, let's say we want to save some text data for the user.

I'm mainly referring to lines of code as a metric of simplicity, but within the 80 characters per line (and common sense). I'm also referring to Chrome 26.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:39:55.913

这就是我发现的。当然，它的用途是相当有限的，最好参考上面链接的主要文章

```
function error(e) { console.log(e); };
webkitRequestFileSystem(TEMPORARY, Math.pow(2, 10), function(fs) {
    fs.root.getFile( 'exported.txt', {create:true}, function(fileEntry) {
        fileEntry.createWriter(function(fileWriter) {
            fileWriter.onwriteend = function() {
                alert('content saved to '+fileEntry.fullPath);
            };
            var blob = new Blob(['Lorem Ipsum'], {type: 'text/plain'});
            fileWriter.write(blob);
        });
    }, error);
}, error); 
```

# jquery - Knockout.Js selectedOptions 从选项中过滤

> ID：15991153
> 
> 赞同：0
> 
> 时间：2013-04-13T18:09:56.280
> 
> 标签：jquery, knockout.js

我正在将一个集合绑定到一个 select multi，集合中的一些项目具有属性“Selected”：“True”，我想将这些设置为 select multi 中的 selectedOptions，我想我会使用 ko.utils .arrayFilter 将它们过滤掉，然后将它们设置为 selectedOptions 但对于我来说，我无法找出最好的方法来做到这一点。

可以帮助，我有一个 Fiddler 页面设置，除了 ko.utils.arrayFilter 添加在这里[http://jsfiddle.net/dumbarse/TpnZh/3/](http://jsfiddle.net/dumbarse/TpnZh/3/)。

```
<select data-bind="options:availableThings,optionsText: 'Title', selectedOptions: selectedThings" size="5"  multiple="true"></select>

Var initialThingsModel = [
            {"Id":1,"Title":"First","Selected":"True"},
            {"Id":2,"Title":"Next"},
            {"Id":3,"Title":"Another","Selected":"True"},
            {"Id":4,"Title":"Last"}
        ];

        var viewModel = {
            availableThings: ko.observableArray(initialThingsModel),
            selectedThings: ko.observableArray(),                
        };

        ko.applyBindings(viewModel); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:19:20.890

这`ko.utils.arrayFilter`是在此处使用的正确方法（您可以在此处阅读有关它的更多信息：[KnockoutJS 中的实用程序函数](http://www.knockmeout.net/2011/04/utility-functions-in-knockoutjs.html)）：

```
selectedThings: ko.utils.arrayFilter(initialThingsModel, 
    function(item) { return item.Selected == "True"; }) 
```

演示[JSFiddle。](http://jsfiddle.net/CGK2A/)

如果您想在`selectedThings`添加/删除项目时进行更改，`availableThings`则需要将其包装`ko.utils.arrayFilter`成`ko.computed`：

```
var viewModel = {
     availableThings: ko.observableArray(initialThingsModel),               
};
viewModel.selectedThings = ko.computed(function() { 
    return ko.utils.arrayFilter(viewModel.availableThings(), 
       function(item) { return item.Selected == "True";}) 
}); 
```

演示[JSFiddle。](http://jsfiddle.net/mJaAg/)

# android - 基于地图的安卓游戏。OpenGL-ES 还是画布？

> ID：15991154
> 
> 赞同：0
> 
> 时间：2013-04-13T18:09:59.327
> 
> 标签：android, opengl-es-2.0, android-canvas

我打算做一个安卓游戏。游戏不包括很多动作。就像用户可以在自定义地图之间切换、放大和缩小、选择土地的一部分、在地图上绘制一些对象一样。用户还应该有一个仪表板来管理他的游戏。它不包括像汽车/人一样移动的物体。

我对 Canvas 和 OpenGL-ES 的开发都是新手，但我觉得 OpenGL-ES 包含的内容比我需要的要多得多。但我怀疑 Canvas 是否足以满足我的要求。

那么，你会建议我怎么做？

提前致谢。

阿德尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T01:07:38.793

我想说这是一个很难回答的问题，因为除了您自己（作为游戏设计师）之外的任何人几乎都不可能知道您的特定游戏需要哪一个。

但是，我个人会说，我会使用 openGL ES 2.0。我花了几个月的时间设计一个游戏（甚至更长的时间编写它）却发现画布不够强大。诚然，它确实有“移动对象”，但数量并不多——它最终产生了很多我无法消除的生涩运动，所以我正在使用 openGL ES 2.0 对其进行重新编码。

我想说，看一些用 Canvas / Surfaceview 编写的游戏示例，并尽你所能判断你认为应该使用哪个游戏。

在做出这个决定时请记住，如果您认为 Canvas/Sur​​faceview 足够好，那就去做吧，但是即使是这样，您以后是否会创建要求更高的游戏？如果是这样，那么就像我上面所说的，我会直接跳入 openGL ES 2.0。

Canvas = 更简单的编码，更差的性能

Open GL ES 2.0 = 要求更高的编码，但有可能获得更好的性能。

只是我的观点！

# javascript - 将 js 变量或 inout 值传递给剃须刀

> ID：15991161
> 
> 赞同：3
> 
> 时间：2013-04-13T18:10:29.727
> 
> 标签：javascript, c#, jquery, asp.net-mvc, razor

是否可以将 js 变量或 html 值传递给剃须刀？

```
@{
    int n = ?????;
    Html.RenderPartial("_AddressBookEdit", @Model.Addresses[n]);
} 
```

如何从 javascript 设置变量 n 或从隐藏字段为其分配一个值？

```
n = $('#myvar').val()'; 
```

上面的代码不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T18:18:46.133

您在这里缺少基本的理解。我已经回答了你这个问题的一个版本，但是我认为你没有误解这一点。

如果不通过服务器，您无法将任何东西从 javascript 传递到 razor。

那是因为剃须刀是在服务器端执行的（因此其中有 c#）。调用控制器，实例化该类，然后调用与请求的操作匹配的方法，然后返回视图。返回视图时，执行视图中的c#代码。执行完所有代码后，它会在响应中发出 html 页面，然后 javascript 在客户端上运行。为了让您从 javascript 到 razor，您必须发出一个新请求以从一开始就通过该路径，以便最终返回。

解决这个问题服务器端。

# javascript - face's detected save image, instead of draw image(glasses)

> ID：15991164
> 
> 赞同：0
> 
> 时间：2013-04-13T18:10:46.187
> 
> 标签：javascript, computer-vision, face-detection

So im attempting to use lulu's CCV JavaScript library and this code example seen here that draws glasses over a detected face: [enter link description here](https://github.com/neave/face-detection) But instead of drawing glasses I would like to be able to detect the face, and draw a rectangle around it, then save it in the web browser as a variable.

In the face.html file there is a line which I believe draws the glasses to the detected face

```
 for (i = App.comp.length; i--; ) {
             ctx.strokeRect(App.glasses, (App.comp[i].x - w / 2) * m, (App.comp[i].y - w / 2) * m, (App.comp[i].width + w) * m, (App.comp[i].height + w) * m);
            }
    }
}; 
```

I have tried replaced that line with this code snippet:

```
ctx.strokeRect(comp[i].x, comp[i].y, comp[i].width, comp[i].height); 
```

It does draw a rectangle, but a small one in the corner of the screen. I'm lost lost as where to go from here.

The entire code for the html page is seen here:

```
<pre>
<!DOCTYPE html>
<html lang="en">
<!-- Adapted to work with the getUserMedia API using code from http://wesbos.com/html5-video-face-detection-canvas-javascript/ -->
    <head>
        <meta charset="utf-8">
        <title>HTML5 Face Detection - JavaScript getUserMedia API and Groucho Marx glasses!</title>
        <style>
body {
    font-family: sans-serif;
    font-size: 17px;
    line-height: 24px;
    color: #fff;
    width: 100%;
    height: 100%;
    margin: 0;
    text-align: center;
    background-color: #111;
}

#info {
    position: absolute;
    width: 100%;
    height: 30px;
    top: 50%;
    margin-top: -15px;
}

#output {
    width: auto;
    height: 100%;
    background: black;
    -webkit-transform: scale(-1, 1);
}
        </style>
    </head>
    <body>
        <p id="info">Please allow access to your camera!</p>
        <canvas id="output"></canvas>
        <script src="ccv.js"></script>
        <script src="face.js"></script>
        <script>

// requestAnimationFrame shim
(function() {
    var i = 0,
        lastTime = 0,
        vendors = ['ms', 'moz', 'webkit', 'o'];

    while (i < vendors.length && !window.requestAnimationFrame) {
        window.requestAnimationFrame = window[vendors[i] + 'RequestAnimationFrame'];
        i++;
    }

    if (!window.requestAnimationFrame) {
        window.requestAnimationFrame = function(callback, element) {
            var currTime = new Date().getTime(),
                timeToCall = Math.max(0, 1000 / 60 - currTime + lastTime),
                id = setTimeout(function() { callback(currTime + timeToCall); }, timeToCall);

            lastTime = currTime + timeToCall;
            return id;
        };
    }
}());

var App = {
    start: function(stream) {
        App.video.addEventListener('canplay', function() {
            App.video.removeEventListener('canplay');
            setTimeout(function() {
                App.video.play();
                App.canvas.style.display = 'inline';
                App.info.style.display = 'none';
                App.canvas.width = App.video.videoWidth;
                App.canvas.height = App.video.videoHeight;
                App.backCanvas.width = App.video.videoWidth / 4;
                App.backCanvas.height = App.video.videoHeight / 4;
                App.backContext = App.backCanvas.getContext('2d');

                var w = 300 / 4 * 0.8,
                    h = 270 / 4 * 0.8;

                App.comp = [{
                    x: (App.video.videoWidth / 4 - w) / 2,
                    y: (App.video.videoHeight / 4 - h) / 2,
                    width: w, 
                    height: h,
                }];

                App.drawToCanvas();
            }, 500);
        }, true);

        var domURL = window.URL || window.webkitURL;
        App.video.src = domURL ? domURL.createObjectURL(stream) : stream;
    },
    denied: function() {
        App.info.innerHTML = 'Camera access denied!<br>Please reload and try again.';
    },
    error: function(e) {
        if (e) {
            console.error(e);
        }
        App.info.innerHTML = 'Please go to about:flags in Google Chrome and enable the &quot;MediaStream&quot; flag.';
    },
    drawToCanvas: function() {
        requestAnimationFrame(App.drawToCanvas);

        var video = App.video,
            ctx = App.context,
            backCtx = App.backContext,
            m = 4,
            w = 4,
            i,
            comp;

        ctx.drawImage(video, 0, 0, App.canvas.width, App.canvas.height);

        backCtx.drawImage(video, 0, 0, App.backCanvas.width, App.backCanvas.height);

        comp = ccv.detect_objects(App.ccv = App.ccv || {
            canvas: App.backCanvas,
            cascade: cascade,
            interval: 4,
            min_neighbors: 1
        });

        if (comp.length) {
            App.comp = comp;
        }

        for (i = App.comp.length; i--; ) {
             ctx.strokeRect(App.glasses, (App.comp[i].x - w / 2) * m, (App.comp[i].y - w / 2) * m, (App.comp[i].width + w) * m, (App.comp[i].height + w) * m);

        }
    }
};

App.glasses = new Image();
App.glasses.src = 'glasses.png';

App.init = function() {
    App.video = document.createElement('video');
    App.backCanvas = document.createElement('canvas');
    App.canvas = document.querySelector('#output');
    App.canvas.style.display = 'none';
    App.context = App.canvas.getContext('2d');
    App.info = document.querySelector('#info');

    navigator.getUserMedia_ = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

    try {
        navigator.getUserMedia_({
            video: true,
            audio: false
        }, App.start, App.denied);
    } catch (e) {
        try {
            navigator.getUserMedia_('video', App.start, App.denied);
        } catch (e) {
            App.error(e);
        }
    }

    App.video.loop = App.video.muted = true;
    App.video.load();
};

App.init();

        </script>
    </body>
</html>
</pre> 
```

Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T09:05:26.243

```
var x_offset = 0, y_offset = 0, x_scale = 1, y_scale = 1;
if (App.video.Width * App.video.Height > localVideo.videoWidth * localVideo.clientHeight) {
  x_offset = (localVideo.clientWidth - localVideo.clientHeight * localVideo.videoWidth / localVideo.videoHeight) / 2;
} else {
  y_offset = (localVideo.clientHeight - localVideo.clientWidth * localVideo.videoHeight / localVideo.videoWidth) / 2;
}
x_scale = (localVideo.clientWidth - x_offset * 2) / localVideo.videoWidth;
y_scale = (localVideo.clientHeight - y_offset * 2) / localVideo.videoHeight;
            for (var i = 0; i < comp.length; i++) {
  comp[i].x = comp[i].x * x_scale + x_offset;
  comp[i].y = comp[i].y * y_scale + y_offset;   
  comp[i].width = comp[i].width * x_scale;
  comp[i].height = comp[i].height * y_scale; 
```

然后使用这条线

```
ctx.strokeRect(comp[i].x, comp[i].y, comp[i].width, comp[i].height); 
```

用 App.video.width 替换所有 localvideo.clientwidth，用 App.video.height 替换 ocalvideo.clientheight

# java - 两个 INT 变量的切换案例

> ID：15991167
> 
> 赞同：6
> 
> 时间：2013-04-13T18:10:57.360
> 
> 标签：java, switch-statement

考虑以下代码：

```
if (xPoint > 0 && yPoint > 0) {
    m_navigations = Directions.SouthEast;
}
else if (xPoint > 0 && yPoint < 0) {
    m_navigations = Directions.NorthEast;
}
else if (xPoint < 0 && yPoint > 0) {
    m_navigations = Directions.SouthWest;
}
else if (xPoint < 0 && yPoint < 0) {
    m_navigations = Directions.NorthWest;
}
else if (xPoint == 0 && yPoint < 0) {
    m_navigations = Directions.North;
}
else if (xPoint == 0 && yPoint > 0) {
    m_navigations = Directions.South;
}
else if (xPoint > 0 && yPoint == 0) {
    m_navigations = Directions.East;
}
else if (xPoint < 0 && yPoint == 0) {
    m_navigations = Directions.West;
} 
```

这很难看，我想使用 switch case，但是如何使用`switch`变量`2`？

我想过这样的[事情](https://stackoverflow.com/questions/9235152/can-i-use-a-case-switch-statement-with-two-variables)- @Frits van Campen 的答案，但我需要使用`>`和`<`运营商......

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T18:54:32.343

你可以用枚举做任何事情。我为前两个值创建了示例，您可以继续其余的。

```
public enum Direction
{
    SouthEast(1,1),
    NorthEast(1,-1);

    int _xPoint, _yPoint;

    Direction(int xPoint, int yPoint)
    {
        _xPoint = xPoint;
        _yPoint = yPoint;
    }

    public static Direction getDirectionByPoints(int xPoint, int yPoint)
    {
        for (Direction direction : Direction.values())
        {
            if(   Integer.signum(xPoint) == direction._xPoint 
               && Integer.signum(yPoint) == direction._yPoint )
            {
                return direction;
            }
        }
        throw new IllegalStateException("No suitable Direction found");
    }
} 
```

所以你可以打电话：

```
m_navigations = Direction.getDirectionByPoints(xPoint,yPoint); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:28:52.860

使用 signum 在这样的方向上获得 -1、0 或 1：

```
String direction = Integer.signum(xPoint)+","+Integer.signum(yPoint);
switch(direction){
  case "1,1": 
    m_navigations = Directions.SouthEast;
    break;
  case "-1,0"
    m_navigations = Directions.West;
    break;

etc..
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T19:19:08.307

最简单和最简单的解决方案是使用多维数组。

```
public class CalculateDirections {
    private final static Directions DIRECTION_MAP[][] = {
        {Directions.NorthWest, Directions.North, Directions.NorthEast},
        {Directions.West, null, Directions.East},
        {Directions.SouthWest, Directions.South, Directions.SouthEast},
    };

    public static void main(String[] args) {
        int x = Integer.valueOf(args[0]);
        int y = Integer.valueOf(args[1]);

        int signumX = Integer.signum(x);
        int signumY = Integer.signum(y);
        Directions direction = DIRECTION_MAP[signumY + 1][signumX + 1];

        System.out.println(direction);
    }
}

enum Directions {
    SouthEast, NorthEast, SouthWest, NorthWest, North, South, East, West
} 
```

有几个优点：

*   没有 if/else 级联，它们需要一些运行时间并且难以管理。
*   不创建临时字符串。在紧凑的游戏循环中，这可能很重要。
*   不能通过列表或数组进行线性搜索。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T19:14:39.157

与其他答案类似，但没有字符串。只是为了好玩 ：-）

```
public Directions getDirection(int xPoint, int yPoint) {
    int num = 8 * (xPoint == 0 ? 0 : xPoint > 0 ? 1 : 2);
    num += yPoint == 0 ? 0 : yPoint > 0 ? 1 : 2;
    switch (num) {
    case 01:
        return Directions.South;
    case 02:
        return Directions.North;
    case 010:
        return Directions.East;
    case 011:
        return Directions.SouthEast;
    case 012:
        return Directions.NorthEast;
    case 020:
        return Directions.West;
    case 021:
        return Directions.SouthWest;
    case 022:
        return Directions.NorthWest;
    }
    return Directions.None;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-13T18:26:45.303

```
boolean xNeg  = xPoint  < 0;
boolean yNeg  = yPoint  < 0;
boolean xZero = xPoint == 0;
boolean yZero = yPoint == 0; 
```

我们有四个位，我们有 2^4 种可能性，一个方向数组可以做剩下的事情......

```
int index =
   ((xNeg ?1:0)<<3)|
   ((yNeg ?1:0)<<2)|
   ((xZero?1:0)<<1)|
   ((yZero?1:0)<<0);
Directions dir = directions[index]; 
```

在类加载时初始化`directions`的`static final`方向数组。

```
static final Directions[] directions = {
   Direction.NorthEast, // false, false, false, false ==> x  > 0 && y  > 0
   Direction.East,      // false, false, false, true  ==> x  > 0 && y == 0
   Direction.North,     // false, false, true , false ==> x == 0 && y  > 0
   ...
} 
```

使用从三元、移位和/或运算符计算的整数索引数组比字符串切换中使用的字符串连接消耗的 CPU 更少，并且在 Java 1.0 中运行良好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-13T19:01:22.097

在这一刻 ：

```
 String direction = Integer.signum(xPoint) + "|" + Integer.signum(yPoint);
    switch(direction)
    {
        case "1|1":
            {m_navigations = Directions.SouthEast; break;}
        case "1|-1":
            {m_navigations = Directions.NorthEast; break;}
        case "-1|1":
            {m_navigations = Directions.SouthWest; break;}
        case "-1|-1":
            {m_navigations = Directions.NorthWest; break;}
        case "0|-1":
            {m_navigations = Directions.North; break;}
        case "0|1":
            {m_navigations = Directions.South; break;}
        case "1|0":
            {m_navigations = Directions.East; break;}
        case "-1|0":
            {m_navigations = Directions.West; break;}
        default: break;         
    } 
```

现在我将尝试@danieln 的建议。

# java - 阅读文件并找到独特的单词

> ID：15991169
> 
> 赞同：0
> 
> 时间：2013-04-13T18:10:59.883
> 
> 标签：java, string

我想读取一个文件并获取其中唯一单词的数量。到目前为止，我能够逐行读取文件（readline），将其存储在数组列表中，然后操作字符串。

我的输入将如下所示：

> （或（或电视派对）（学习））（=> 考试（不是（或电视派对）））

基本上，我正在尝试将每一行从前缀转换为中缀，并且我需要找出输入文件中涉及的所有差异变量（如 tv、party 等），以便我可以构建一个真值表并测试案例。

目前我正在处理数组列表中的所有字符串。有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:24:01.593

如果要查找变量，请尝试：

```
String line = "(OR (OR tv party) (study)) (=> exam (NOT (OR tv party)))";
Scanner sc = new Scanner(line);
sc.useDelimiter("[^a-z]");
Set<String> set = new TreeSet<String>();
while(sc.hasNext()) {
    String word = sc.next();
    if (!word.isEmpty()) {
        set.add(word);
    }
}
System.out.println(set); 
```

这打印：

```
[exam, party, study, tv] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:25:14.897

拆分行并将单词存储到`Set`. 最后，您将获得独特的单词。如果您也想知道单词计数，请使用`map<String, Integer>`其中键（字符串）是单词，值（整数）是计数器。

# http - HTTP/1.0 响应是否需要 Content-Length 标头？

> ID：15991173
> 
> 赞同：64
> 
> 时间：2013-04-13T18:11:27.087
> 
> 标签：http, http-headers

`Content-Length`HTTP/1.0 响应是否需要标头？HTTP规范提到它是请求所必需的，但没有提到任何关于响应的内容：

[http://www.w3.org/Protocols/HTTP/1.0/draft-ietf-http-spec.html#Content-Length](http://www.w3.org/Protocols/HTTP/1.0/draft-ietf-http-spec.html#Content-Length)

> 所有包含实体主体的 HTTP/1.0 请求消息都需要有效的 Content-Length 字段值。

如果响应不需要它，当响应大于 1MB 时，客户端如何读取响应？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-04-14T02:27:51.440

规范的第 10.4 节（您链接到）没有说明对响应本身的要求，而是链接到[第 7.2.2 节](http://www.w3.org/Protocols/HTTP/1.0/draft-ietf-http-spec.html#BodyLength)，该节指定服务器可以通过以下方式指示包含实体主体的响应的长度

*   发送`Content-Length`标头，或
*   发送整个响应后关闭连接。

[第 7.2 节](http://www.w3.org/Protocols/HTTP/1.0/draft-ietf-http-spec.html#Entity-Body)说对`HEAD`请求的响应以及 1xx、204 或 304 响应不应包含实体主体，因此无需包含`Content-Length`标头；和

> 所有其他响应必须包含一个实体主体或一个`Content-Length`定义为零 (0) 值的标头字段。

所以回答这个问题：当没有`Content-Length`收到时，客户端会继续读取，直到服务器关闭连接。

# php - php fputcsv 麻烦到 Col

> ID：15991176
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:11:55.807
> 
> 标签：php, csv

我从 html 获取名称和数据。我想将其写入 CSV。

所以我得到了这个 CSV。

```
 ColA    ColB         ColC   ColD   ColE   ColF   ColG
 name1   surname1     data1  data2   data3 data4 data5
 name2   surname2     data6  data7   data8 data9 data10
 name3   surname3     data11 data12  data13 data14 data15
 name..n surname..n data..n data..n  data..n data..n data..n 
```

但我想要 ColA 中的姓名和姓氏。

```
 ColA           ColB   ColC   ColD   ColE   ColF  
 name1 surname1     data1  data2   data3 data4 data5
 name2 surname2     data6  data7   data8 data9 data10
 name3 surname3     data11 data12  data13 data14 data15
 name..n surname..n data..n data..n  data..n data..n data..n 
```

我认为是因为 "space" 的名字和姓氏（有些有中间名）但 Data 没有空格。我想在 ColA 中写名字和姓氏。请帮助我。TT

```
 $fp = fopen("data.csv","w");
   $string = '';
    for ($i=0; $i<$count_name; $i++)
{
while ( $iterate <= 5 and $j < $count_data )
{
    $string = $string.$temp_data[$j]." ";
    $j++;
    $iterate++;
}
$csv_string = $temp_name[$i]." ".$string;
//echo $temp_name[$i];
$array = explode(' ',$csv_string);
//var_dump($array);
fputcsv($fp,$array);
//$string = "";
$iterate = 1;
$string = "";

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:57:07.503

如果我理解正确，你应该试试这个：

```
$fp = fopen('data.csv', 'w');
for(/* Each line of data you have */){
    $colA = $name ." ".$surname; // Concatenate name and surname that you have received from your html
    $colB = $data1; // Data1 from html
    $colC = $data2; // Data2 from html
    fputcsv($fp, array($colA,$colB,$colC)); // A new line on your csv
}
fclose($fp); 
```

# c - 是否可以将指向局部变量的指针保留在该变量的范围之外？

> ID：15991179
> 
> 赞同：2
> 
> 时间：2013-04-13T18:12:17.150
> 
> 标签：c, pointers, memory

假设我使用以下代码：

```
int *pointer;
if(1) {
    int num = 5; // local variable, can't be used outside the if block.
    pointer = &num
} 
```

这是跟踪`num`变量的安全方法吗？我知道这段代码会起作用。但我认为编译器会使用旧`num`内存分配新变量，导致`pointer`引用不可预测的值。真的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-13T18:17:28.470

不，这不安全。当达到关闭`}`时`if`，`num`的生命周期结束，并且 的值`pointer`变得不确定。此后使用它会调用未定义的行为。

编译器实际做的事情取决于，它很可能会使用`num`用于另一个在出现之前未使用的局部变量的存储空间`num`。然后使用`pointer`来获取`num`已经肯定会失败的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:17:46.717

不，它可能不起作用，因为您试图保持超出范围的对象的值并且它所属的堆栈帧将被销毁。这可能会工作一次或两次，但它始终是未定义的行为。

# java - 如何将字符串值实现到数组中

> ID：15991181
> 
> 赞同：0
> 
> 时间：2013-04-13T18:12:29.003
> 
> 标签：java, android, arrays, string

我创建了这段代码，我有一个字符串数组。问题是我有一个来自另一个 Intent 的值，我想将它添加到数组中。我知道使用 ArrayList 更容易，但问题是在我输入之后数组的值我想在 Textview 上设置数组的随机字符串，所以我使用

```
txtV1.setText(myStringArray[new Random().nextInt(myStringArray.length)]); 
```

但这对于 ArrayList 是不可能的，因为它说：表达式的类型必须是数组类型，但它解析为 ArrayList

我用谷歌搜索但找不到任何解决方案。希望您能够帮助我。

这是我的整个代码：

```
String[] myStringArray = {"Object1","Object2","Object3"};

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.activity_main);
    txtV1=(TextView)findViewById(R.id.textView1);

Bundle extras = getIntent().getExtras();
        String value = extras.getString("key");//this value I want to add to the array

txtV1.setText(myStringArray[new Random().nextInt(myStringArray.length)]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:36:23.683

您可以使用 ArrayList 保存您的字符串，然后在需要时使用 get(int) 检索特定的 String 或 toArray() 将列表转换为字符串数组。

```
ArrayList <String> array = new ArrayList<String>();
array.add(new String("Object1"));
array.add(new String("Object2"));
array.add(new String("Object3"));

setText(array.get(new Random().nextInt(array.size()))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:00:27.847

为什么不使用 ArrayList<> 而不是数组？

```
ArrayList<String> myStrings = new ArrayList<String>(Arrays.asList("Object1","Object2","Object3"));

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.activity_main);
    txtV1=(TextView)findViewById(R.id.textView1);

    Bundle extras = getIntent().getExtras();
    String value = extras.getString("key");

    myStrings.add(value);
    int randomIndex = new Random().nextInt(myStrings.size());
    txtV1.setText(myStrings.get(randomIndex)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T18:33:47.800

我建议将 System.arraycopy 用于扩展数组，如下所示：

```
String[] oldArray = {"Object1","Object2","Object3"};
String[] newArray = new String[oldArray.length + 1];
System.arraycopy(oldArray, 0, newArray, 0, oldArray.length);

String randomValue = newArray[new Random().nextInt(newArray.length)]; 
```

这会留下最后一个空间，您可以随意填充`String`。

或者，根据您的意愿和变量：

```
String[] myStringArray = {"Object1","Object2","Object3"};
String[] myNewStringArray = new String[myStringArray.length + 1];
System.arraycopy(myStringArray, 0, myNewStringArray, 0, myStringArray.length);
myNewStringArray[myNewStringArray.length - 1] = extras.getString("key");

txtV1.setText(myNewStringArray[new Random().nextInt(newArray.length)]); 
```

尽管如果您发现使用 来改变您的代码的任何可能性`ArrayList`，我强烈推荐这种方法。

**更新**

与 a 相同的方法`ArrayList`：

```
List<String> myList = new ArrayList( myArray ); // Or Arrays.asList("Object1", "Object2", "Object3"); if you'd like to hardcode initial values.
myList.add(extras.getString("key");
txtV1.setText(myList.get(new Random().nextInt(myList.size()))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T18:41:03.260

这对我来说很好

```
Random rand = new Random();
ArrayList<String> myArray = new ArrayList<String>();
myArray.add("MyKey");
myArray.add("MyKey2");
myArray.add("MyKey3");
TextView myTextView = new TextView(null); 
myTextView.setText(myArray.get(rand.nextInt(myArray.length()))); 
```

你的问题是这个，

# c# - 在页面之间导航时 Windows 商店应用程序暂停

> ID：15991183
> 
> 赞同：4
> 
> 时间：2013-04-13T18:12:40.383
> 
> 标签：c#, performance, user-interface, windows-store-apps

我正在使用 OOTB Grid App 模板构建 Windows Store App。我注意到当我从一个页面向前或向后导航时有 500-1000 毫秒的暂停。当我点击后退按钮时（后退箭头在 500-1000 毫秒内保持在“命中”状态），这主要是值得注意的。继续前进并没有那么糟糕，因为通常屏幕有动画和过渡来填充大部分加载时间。

我的第一个想法是该`LoadState`方法中存在导致速度减慢的某些东西，但我唯一拥有的不是来自我在后台线程上运行并使用`async`前言调用它的模板。

我的第二个想法是我将一个复杂的对象传递给每个页面`navigationParameter`，而不仅仅是传递一个简单的字符串。我不认为这可能是原因，因为对象应该通过引用传递，所以真的不应该有任何减速，因为我将非字符串传递到`NavigateTo`方法中。

*（我还没有阅读任何关于这方面的指导，所以我不知道在页面之间传递非字符串时页面导航是否不那么活泼。如果有人对此有任何见解，那就太好了）*

我的下一个想法是我的 Xaml 太复杂了，暂停是 Xaml 将所有项目加载到列表中，什么不是。这可能是问题所在，如果是这样，我不知道如何测试或修复它。加载完所有内容后，用户界面感觉流畅（页面上的所有项目都滚动而不会卡顿）

如果是这种情况，是否有任何方法可以显示 Xaml 生成的加载圆圈，然后一旦完成生成，淡入内容并淡出圆圈？

我要修复的主要问题是我不希望后退按钮在点击中“冻结”。任何帮助或指导都会很棒！

* * *

## 基本应用信息：

页面具有列表和网格视图控件与不同项目模板的组合。没有使用图像或图形，但我确实在一些项目模板上使用了渐变画笔（不是超级复杂，类似于开始屏幕项目渐变）。大多数列表只有 20-30 项，有些则更少。

平均页面有 1 个项目源和 2 个项目显示控件、一个列表和一个包含所选项目详细信息的滚动查看器。

任何项目的详细信息大约是 2-3 个普通段落的详细信息文本和 3-4 < 20 个字符字符串。

* * *

编辑：项目代码：

## 第 1 页代码

```
 protected async override void LoadState(Object navigationParameter, Dictionary<String, Object> pageState)
    {
        if (navigationParameter == null)
            this.DefaultViewModel["Groups"] = GlobalData.Catalog.Catalog;
        else
            this.DefaultViewModel["Groups"] = navigationParameter;

        await GlobalData.LibraryDownload.DiscoverActiveDownloadsAsync();
    } 
```

该`DiscoverActiveDownloadsAsync`方法与[此示例代码中的代码相同](http://code.msdn.microsoft.com/windowsapps/Background-Transfer-Sample-d7833f61/sourcecode?fileId=52027&pathId=238539495)

`SaveState`、`OnNavigateTo`和`OnNavigateFrom`方法尚未从`LayoutAwarePage`基类修改。

## 第 2 页代码

```
 protected async override void LoadState(Object navigationParameter, Dictionary<String, Object> pageState)
    {
        if (navigationParameter is CatalogBook)
        {
            var catBook = (CatalogBook)navigationParameter;
            var book = catBook.Book;
            await book.InitializeAsync();

            this.DefaultViewModel["Group"] = catBook;
            this.DefaultViewModel["Items"] = book.Items;
        }
        else if (navigationParameter is IBook)
        {
            var book = await Task.Run<IBook>(async () =>
                {
                    var b = (IBook)navigationParameter;
                    await b.InitializeAsync();
                    return b;
                });

            this.DefaultViewModel["Group"] = book;
            this.DefaultViewModel["Items"] = book.Chapters;
        }

        if (pageState == null)
        {
            // When this is a new page, select the first item automatically unless logical page
            // navigation is being used (see the logical page navigation #region below.)
            if (!this.UsingLogicalPageNavigation() && this.itemsViewSource.View != null)
            {
                this.itemsViewSource.View.MoveCurrentToFirst();
            }
        }
        else
        {
            // Restore the previously saved state associated with this page
            if (pageState.ContainsKey("SelectedItem") && this.itemsViewSource.View != null)
            {
                var number = 0;
                if(!int.TryParse(pageState["SelectedItem"].ToString(), out number)) return;

                var item = itemsViewSource.View.FirstOrDefault(i => i is ICanon && ((ICanon)i).Number == number);
                if (item == null) return;

                this.itemsViewSource.View.MoveCurrentTo(item);

                itemListView.UpdateLayout();
                itemListView.ScrollIntoView(item);
            }
        }
    }

    ...

    protected override void SaveState(Dictionary<String, Object> pageState)
    {
        if (this.itemsViewSource.View != null)
        {
            var selectedItem = this.itemsViewSource.View.CurrentItem;
            pageState["SelectedItem"] = ((ICanon)selectedItem).Number;
        }
    } 
```

该`InitializeAsync`方法从 SQLite 数据库中读取有关一本书的一些基本信息（章节、作者等），并且通常运行速度非常快（< 10ms）

## 网格代码

我通过使用 SQLite-net Nuget 包的异步方法查询 SQLite 数据库来获取数据。查询通常如下所示：

```
 public async Task InitializeAsync()
    {
        var chapters = await _db.DbContext.Table<ChapterDb>().Where(c => c.BookId == Id).OrderBy(c => c.Number).ToListAsync();

        Chapters = chapters
            .Select(c => new Chapter(_db, c))
            .ToArray();

        HeaderText = string.Empty;
    } 
```

我使用以下 Xaml 填充网格：

```
 <CollectionViewSource
        x:Name="groupedItemsViewSource"
        Source="{Binding Groups}"
        IsSourceGrouped="true"
        ItemsPath="Items"
        d:Source="{Binding DisplayCatalog, Source={d:DesignInstance Type=data:DataCatalog, IsDesignTimeCreatable=True}}"/>

    <common:CatalogItemTemplateSelector x:Key="CatalogItemTemplateSelector" />

    ...

    <GridView
        Background="{StaticResource ApplicationPageLightBackgroundThemeBrushGradient}"
        ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}" 
        SelectionMode="Multiple"            
        Grid.Row="1" 
        ItemTemplateSelector="{StaticResource CatalogItemTemplateSelector}" 
        IsItemClickEnabled="True"
        ItemClick="ItemView_ItemClick" Margin="-40,0,0,0">
        <GridView.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal" Height="628" Margin="120,10,0,0" />
            </ItemsPanelTemplate>
        </GridView.ItemsPanel>
        <GridView.GroupStyle>
            <GroupStyle>
                <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                        <Grid Margin="1,10,0,6">
                            <Button
                                AutomationProperties.Name="Group Title"
                                Click="Header_Click"
                                Style="{StaticResource TextPrimaryButtonStyle}" >
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Name}" Margin="3,-7,10,10" Style="{StaticResource GroupHeaderTextStyle}" />
                                    <TextBlock Text="{StaticResource ChevronGlyph}" FontFamily="Segoe UI Symbol" Margin="0,-7,0,10" Style="{StaticResource GroupHeaderTextStyle}"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </DataTemplate>
                </GroupStyle.HeaderTemplate>
                <GroupStyle.Panel>
                    <ItemsPanelTemplate>
                        <VariableSizedWrapGrid Margin="0,0,80,0" ItemHeight="{StaticResource ItemHeight}" ItemWidth="{StaticResource ItemWidth}"/>
                    </ItemsPanelTemplate>
                </GroupStyle.Panel>
            </GroupStyle>
        </GridView.GroupStyle>

    </GridView> 
```

类`CatalogItemTemplateSelector`看起来像这样：

```
public class CatalogItemTemplateSelector : DataTemplateSelector
{
    protected override DataTemplate SelectTemplateCore(object item, DependencyObject container)
    {
        // cast item to your custom item class
        var customItem = item as ICatalogItem;
        if (customItem == null)
            return null;

        string templateName = String.Empty;
        if (customItem is CatalogFolder || customItem is CatalogMoreFolder)
        {
            templateName = "FolderItemDataTemplate";
        }
        else if (customItem is CatalogBook || customItem is CatalogMoreBook)
        {
            templateName = "BookItemDataTemplate";
        }

        object template = null;
        // find template in App.xaml
        Application.Current.Resources.TryGetValue(templateName, out template);
        return template as DataTemplate;
    }
} 
```

两个模板都是约 20 行 Xaml，没什么特别的

如果还有其他我没有包含的代码，请告诉我，我会添加它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T05:22:26.707

您的内存使用情况如何？您可能正在分页到磁盘吗？

摘自[http://paulstovell.com/blog/wpf-navigation](http://paulstovell.com/blog/wpf-navigation)

> Page Lifecycles ....
> 假设您的页面需要将某种参数数据传递给它： ... 导航时，如果单击“返回”，WPF 不可能知道要传递给构造函数的值；因此它必须使页面保持活动状态。
> ...如果您直接导航传递一个对象，WPF 将使该对象保持活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T23:13:23.237

我没有答案，但是这个 Channel 9 (Microsoft) 视频在 XAML 性能方面非常好。也许它可以帮助您解决问题。

[http://channel9.msdn.com/Events/Build/2012/4-103](http://channel9.msdn.com/Events/Build/2012/4-103)

# java - 用 Java 解析 JavaScript

> ID：15991189
> 
> 赞同：2
> 
> 时间：2013-04-13T18:13:07.903
> 
> 标签：java, javascript, parsing

我正在寻找一些帮助来解析来自网络的 .js 文件中的 JavaScript 变量和数组。类似于 Jsoup 的东西，除了它解析 JavaScript 而不是 HTML。关于如何管理这样的事情有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:22:36.620

从 Java 1.6 开始 JavaScript 解析器 Rhino 是 JDK 的一部分。

查看 Oracle 的官方教程：http: [//docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/](http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/)

# java - 使用 JOptionPane 时如何在数组中停止用户输入

> ID：15991198
> 
> 赞同：1
> 
> 时间：2013-04-13T18:14:42.967
> 
> 标签：java, arrays, swing, joptionpane

我是 Java 新手。我正在上我的第一个 Java 课程。我正在尝试创建一个固定大小的数组（例如：大小为 10 的数组），我使用 JOptionPane 让用户输入数据。我的问题是如何让用户随时停止输入。（例如：他们只输入了 3 个数据而不是 10 个并且他们想要完成它）。这是我的第一篇文章，如果格式不正确，我很抱歉。感谢你们。

```
import java.util.Arrays;
import javax.swing.JOptionPane;
public class TestArray {

/**
 * @param args
 */
public static void main(String[] args) {
    String[] lastName = new String[10];
    for (int i = 0; i < lastName.length; i++)
    {
        lastName[i] = JOptionPane.showInputDialog(null,"Please Enter  Tutor Last Names: " );

    }
    JOptionPane.showMessageDialog(null, lastName); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:21:35.053

`break`当您遇到`null`value 或 empty时，就跳出循环`String`。单击取消或输入空白`String`以中断循环。

```
for (int i = 0; i < lastName.length; i++) {
    lastName[i] = 
          JOptionPane.showInputDialog(null, "Please Enter  Tutor Last Names:");
    if (lastName[i] == null || lastName[i].isEmpty()) {
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:21:07.003

只需使用某个变量进行检查，并在每个周期结束时提示用户继续或不继续...如果用户想退出只需使用`break;`

但最好的做法是在旋转循环之前获得迭代次数......询问用户他们想要执行这些步骤的时间......将其存储在变量中并将其用作退出条件......

# javascript - .replace 在 JavaScript/jQuery 中

> ID：15991200
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:15:09.240
> 
> 标签：javascript, jquery

我正在使用 .replace 方法替换`onclick`锚标记上的功能，但它不起作用。

```
<script type="text/javascript">
$(function(){
var htm= $('.jitu').html();
htm.replace("show()",'showme()');
})
</script>

<div class="jitu"><a href="#" onclick="show()">me</a> </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:17:37.253

你应该使用： -

```
$('.jitu a').attr('onclick','showme()'); 
```

[http://jsfiddle.net/Fxfvn/](http://jsfiddle.net/Fxfvn/)

对您的代码的解释：-您正在做的只是替换一个字符串而不是真正的 DOM。此外，这不是更改属性的理想方式。这里 html 只是一个 html 字符串，没有参考...

```
var htm= $('.jitu').html();
htm.replace("show()",'showme()'); 
```

由于您使用的是 jquery。可以直接绑定

```
$('.jitu a').removeAttr('onclick').click(showme); //(if you have onclick. to avoid duplicate alert) 
```

别的

```
$('.jitu a').click(showme); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T04:18:53.380

如果您没有将最终值应用于元素，则仅进行字符串替换不会做任何事情；这会起作用，但我不推荐它：

```
var $jitu = $('.jitu');
$jitu.html($jitu.html().replace('show()', 'showme()')); 
```

更正确的方法是解开旧的挂钩`onclick`并用新的点击处理程序替换它：

```
$('.jitu > a')
    .prop('onclick', null)
    .on('click', showme); 
```

[**演示**](http://jsbin.com/aquziy/1/)

如果您一开始甚至没有内联`onclick="show()"`并仅用于`$(element).on(event, fn)`注册您的点击处理程序，那就更好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T18:17:58.420

请改用[.attr(attributeName, value)](http://api.jquery.com/attr/#attr2)函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T18:21:28.787

另一种方法：

```
$('.jitu').find('[onclick="show()"]').attr('onclick', 'showme()'); 
```

[http://jsfiddle.net/CfpBP/](http://jsfiddle.net/CfpBP/)

但是，您应该考虑使用更不显眼的方式来绑定事件。例如：

```
$('.jitu a').click(showme); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-13T18:19:04.543

这应该可以解决问题：

```
htm.onclick = function() { showme(); }; 
```

# if-statement - 如果序列返回错误，则批处理文件复杂。

> ID：15991202
> 
> 赞同：0
> 
> 时间：2013-04-13T18:15:16.360
> 
> 标签：if-statement, batch-file, cmd

我正在尝试让用户登录，并在他们登录时设置他们的权力或等级。排名是管理员用户和访客。我需要为程序中的每个命令执行下面的代码。它返回 ) 在这个时候是没有预料到的。知道为什么吗？对于此命令，所有用户都应该能够访问它，但稍后我需要为每个组设置某些内容。

```
if %inputCommand%==/help (
  if %power%==Admin (
goto helpInfo
  ) else (
    if %power%==User (
  goto helpInfo
) else (
  if %power%==Guest (

      ) else (
        goto powerReadFailed
      )
    )
  )
) else (
goto readInputCommandTwo
    ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:29:27.730

尝试这个：

```
if "%inputCommand%"=="/help" (
  if "%power%"=="Admin" (
goto helpInfo
  ) else (
    if "%power%"=="User" (
  goto helpInfo
) else (
  if "%power%"=="Guest" (
        rem
      ) else (
        goto powerReadFailed
      )
    )
  )
) else (
goto readInputCommandTwo
    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:44:23.820

为什么这么复杂？

怎么样

```
for %%a in (admin user guest) do if /i "%power"=="%%a" (
 for %%b in (help somethingelse whatever) do if /i "%inputcommand"=="%%b" (
 goto %%a%%b
 )
 goto %%ainvalidcommand
)
:powerreadfailed 
```

然后你可以设置标签

```
adminhelp userhelp guesthelp
adminsomethingelse usersomethingelse guetsomethingelse
... 
```

写是完全合法的

```
:adminhelp
:userhelp
echo admin and user get the same help 
```

并且添加一个新的用户类或命令并不难......

（ IF`/i`表示进行不区分大小写的比较）

# php - 使用 php 类进行用户身份验证。这是正确的吗？

> ID：15991203
> 
> 赞同：0
> 
> 时间：2013-04-13T18:15:45.120
> 
> 标签：php, mysql, oop, class, error-handling

这是我第一次尝试创建一个类。

我创建了一个用户类，它可以登录、注册和注销。

似乎它正在工作，但我确定我做错了什么。例如，当我只使用 login() 方法时，为什么我必须给出我在 ___construct 中创建的所有变量。登录我只需要用户名和密码。

我在模板系统中使用 $_ERROR 变量显示错误。如何在课堂上显示错误。我用 throw new ExampleException

谁能复习我的课并告诉我我犯的错误吗？我只是想学习如何使用类...

这是我的课

```
<?php
class User
{

var $Username = '';
var $Email = '';
var $Password = '';
var $Salt = '';

protected $_username;
protected $_email;
protected $_password;
protected $_salt;

protected $_db;
protected $_user;

public function __construct(PDO $db, $Username, $Email, $Password, $Salt)
{
    $this->_db = $db;
    $this->_username = $Username;
    $this->_email = $Email;
    $this->_password = $Password;
    $this->_salt = $Salt;

}

private function saltString($Password) // Creates random string for password
{
    $Characters = 'PEcN0';
    $string = md5( $Password . $Characters );

    return $string;
}

public function login() // checks if CheckCredentials is true. if it's true it creates sessions
{
    $user = $this->_CheckCredentials();
    if($user){
        $this->_user = $user;
        $_SESSION['UserID'] = $user['UserID'];
        $_SESSION['Username'] = $user['Username'];
        $_SESSION['Level'] = $user['Level'];
        $_SESSION['Reputation'] = $user['Reputation'];
        return $user['UserID'];
    }
    return false;
}

public function register() // checks if addUser is true.
{
    $user = $this->_addUser();
    if($user){
        $this->createSession($user);    
    }
    return false;
}

public function _CheckCredentials() // checks password and username for login method
{
    $sql = $this->_db->query("SELECT * FROM users WHERE Username = '" . $this->_username . "'");

    if($sql->rowCount() > 0){
        $user = $sql->fetch(PDO::FETCH_ASSOC);
        $pass = $this->saltString($this->_password);
        if($pass == $user['Password']){
            $sql = $this->_db->query( "UPDATE users SET LastLogin = NOW() WHERE UserID = '" . $user['UserID'] . "'" );
            return $user;
        }
    }
    return false;
}

public function _addUser() // add user into database
{
    $sql = $this->_db->query( "SELECT * FROM users WHERE Username = '" . $this->_username . "' OR Email = '" . $this->_email . "'" );
    if($sql->rowCount()){
        $user = $sql->fetch(PDO::FETCH_ASSOC);
        if($user['Username'] == $this->_username){
            throw new ExampleException("This username was taken.");
        }else{
            throw new ExampleException("This e-mail address is being used.");
        }
    }else{
        $intert = $sql->query( "INSERT INTO users ( UserID, OauthUid, OauthProvider, Username, Password, Email, CookieKey, Level, Registered, LastLogin, Reputation, Contents )
        VALUES ( NULL, '". $UserID ."', '". $Provider ."', '" . $Username . "', '" . $Password . "', '" . $Email . "', '" . generateKey( 5 ) . "', '1', NOW(), NOW(), '0', '0')" );

        $UserID = $sql->lastInsertId();

        if($instert){
            $_SESSION['UserID'] = $UserID;
            $_SESSION['Username'] = $Username;
            $_SESSION['Level'] = '1';
        }
    }
    return false;

}

public function getUser()
{
    return $this->_username;
}

}
?> 
```

这就是我使用它的方式......

```
<?php

if ( isset( $_POST['Username'] ) )
{
$Username =  trim( $_POST['Username'] );
$Password =  trim( $_POST['Password'] );

if ( !preg_match( '/^[a-z0-9_]+$/i', $Username ) )
    $_ERROR = 'bad username!';
else
{
    $UserClass = new User($dbc, $Username, $Email, $Password, $Salt);

    if($userid = $UserClass->login())
    {
        if ( isset( $_POST['Remember'] ) )
        {
            setcookie( 'UserID', $data['UserID'], time() + 31536000, '/', SITE );
            setcookie( 'PassHash', md5( $data['Password'] .     $data['CookieKey'] ), time() + 31536000, '/', SITE );
        }

        header( "Location: " . ( $_POST['Redirect'] != '' ? base64_decode(     $_POST['Redirect'] ): '/index.php' ) );
        die();
    }
    else
        $_ERROR = "Check your username or password!";
        $_INFO .= $_SESSION['UserID'];

}
}else{

$Reff = '';
if ( isset( $_SERVER['HTTP_REFERER'] ) )
$Reff = base64_encode( $_SERVER['HTTP_REFERER'] );

$_INFO .= $_SESSION['UserID'];
$_PAGE .= t_LoginForm( $Reff );

}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:29:28.897

您使用 PDO 总是一个优点，但问题是您没有绑定参数。PDO 最大的优点实际上是绑定参数。在您的示例中：

```
$sql->bindParam(':userid',$UserID);
$sql->bindParam(':provider',$Provider); 
```

等等...............

第二部分吓到我了，如果您阅读了密码安全性，应该会吓到您，这是您使用 md5 作为您的密码，而您只是连接了一个名为 $characters 的随机密钥字符串？那位先生......是......只是......愚蠢（抱歉直言不讳，但这实际上是一个大问题，可能会给您的客户/用户带来巨大的麻烦，这是非常严重的）。

在这里试试这个[Bcrypt Library](https://github.com/ircmaxell/password_compat)。现在是 2013 年，您不应该使用 md5，即使使用盐，甚至使用您正在使用的方法：

```
 $Characters = 'PEcN0';
    $string = md5( $Password . $Characters );

    return $string; 
```

相信我，不要建立自己的“加密/散列”方法，而是使用社区信任的方法。

同样回到 PDO 部分，不要忘记将其添加到您的属性中：

```
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, FALSE); 
```

我希望你能从这篇文章中学到一些东西。你不应该在没有 bindParam 的情况下使用 PDO，而且你根本不应该在有或没有盐的情况下使用 MD5。Bcrypt Bcrypt Bcrypt Bcrypt Bcrypt。

# jquery - jQuery 手风琴 100% 宽度

> ID：15991204
> 
> 赞同：1
> 
> 时间：2013-04-13T18:15:48.793
> 
> 标签：jquery, css, wordpress

我的 wordpress 标题上有一个 jQuery 手风琴。我注意到手风琴的宽度因浏览器和屏幕宽度而异。

我试图通过在手风琴类中添加 'width: 100%' 来解决这个问题，但宽度仍然没有填满屏幕/标题宽度？但是，当在“chrome 检查元素”中编辑并将“width：100%”插入手风琴宽度时，它可以工作，但是 100% 的 css 在 chrome 中被“划掉”？

请有人可以帮助我做错了什么？谢谢

```
/* Vertical Accordion Style */
.va-container{
    position:relative;
    margin:40px auto 0 auto;
        top: -47px;
        left: 0px;
        width: 100%;
}         
.va-wrapper{
    width:100%;
    height:100%;
    position:relative;
    overflow:hidden;
    background:#000;
        left: 0px;
}
.va-slice{
    cursor:pointer;
    position:absolute;
    width:100%;
    left:0px;
    overflow:hidden;
}
.va-slice-1{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Airfreight22.png) no-repeat center center;
}
.va-slice-2{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Seafreight2.png) no-repeat center center;
}
.va-slice-3{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/Satellite.png) no-repeat center center;
}
.va-slice-4{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/41.jpg) no-repeat center center;
}
.va-slice-5{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/41.jpg) no-repeat center center;
}
.va-slice-6{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/41.jpg) no-repeat center center;
}
.va-slice-7{
    background:#000 url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/41.jpg) no-repeat center center;
}
.va-slice-color-1{
    background-color:#97c5eb;
}
.va-slice-color-2{
    background-color:#68ace5;
}
.va-slice-color-3{
    background-color:#0072cf;
}
.va-slice-color-4{
    background-color:#0039a6;
}
.va-slice-color-5{
    background-color:#00338e;
}
.va-slice-color-6{
    background-color:#002c76;
}
.va-slice-color-7{
    background-color:#002144;
}
.va-title{
    font-family: 'Open Sans Condensed', sans-serif;
    text-transform:uppercase;
    font-size:40px;
    margin-left:20px;
    color:#fff;
    text-shadow: 0px 0px 1px white;
}
.va-content{
    display:none;
    margin-left:25px;

}
.va-slice p{
    font-size: 22px;
    font-style: italic;
    font-family:Georgia, serif;
}
.va-slice ul{
    margin-top:20px;
}
.va-slice ul li{
    float:left;
    margin:0px 2px;
}
.va-slice ul li a{
    color:#000;
    background:#eede2f;
    padding:3px 6px;
    font-size:14px;
    font-family:'PT Sans', sans-serif;
    text-transform:uppercase;
}
.va-slice ul li a:hover{
    background:#000;
    color:#fff;
    text-shadow:none;
}
.va-nav span{
    width:40px;
    height:25px;
    background:transparent url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/prev.png) no-repeat center center;
    position:absolute;
    top:-35px;
    left:50%;
    margin-left:-20px;
    text-indent:-9000px;
    opacity:0.7;
    cursor:pointer;
    display:none;
    z-index:100;
}
.va-nav span.va-nav-next{
    background-image:url(http://www.fsi.lookinside.co.za/wp-content/uploads/2013/04/next.png);
    top:auto;
    bottom:-35px;
}
.va-nav span:hover{
    opacity:1.0;
}

/* End Additional CSS Styles */
<div class="container">

            <div id="va-accordion" class="va-container">
                <div class="va-nav">
                    <span class="va-nav-prev">Previous</span>
                    <span class="va-nav-next">Next</span>
                </div>
                <div class="va-wrapper">
                    <div class="va-slice va-slice-1">
                        <div class="va-title">Airfreight</div>
                        <div class="va-content">
                            <p>Henry Watson</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="va-slice va-slice-2">
                        <div class="va-title">Seafreight</div>
                        <div class="va-content">
                            <p>Keith Johnson</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-3">
                        <div class="va-title">Satellite Tracking</div>
                        <div class="va-content">
                            <p>Andrew Alaniz</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-4">
                        <div class="va-title">Guarding</div>
                        <div class="va-content">
                            <p>Ben Freeman</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-5">
                        <div class="va-title">Machine Moving</div>
                        <div class="va-content">
                            <p>Alex Schuman</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-6">
                        <div class="va-title">Investigations</div>
                        <div class="va-content">
                            <p>Maria Wales</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                    <div class="va-slice va-slice-7">
                        <div class="va-title">Transport</div>
                        <div class="va-content">
                            <p>Paul White</p>
                            <ul>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Portfolio</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>  
                    </div>
                </div>
            </div>

        </div>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <script type="text/javascript" src="wp-content/themes/FSI5/jquery.easing.1.3.js"></script>
        <script type="text/javascript" src="wp-content/themes/FSI5/jquery.mousewheel.js"></script>
        <script type="text/javascript" src="wp-content/themes/FSI5/jquery.vaccordion.js"></script>
        <script type="text/javascript">
            $(function() {
                $('#va-accordion').vaccordion({
                    visibleSlices   : 5,
                    expandedHeight  : 250,
                    animOpacity     : 0.1,
                    contentAnimSpeed: 100
                });
            });
        </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:25:08.943

您需要为您的手风琴设置一个包装器并将包装器宽度设置为 100%

```
<div class="container">
<div id="va-accordion" class="va-container">
...stuff...
</div>
</div>

.container {width:100% !important;} 
```

发生这种情况是因为手风琴宽度基于其包装

您还将希望删除您的`.va-container`类并将其属性放入`.container`该类 中

```
.container {
width:100% !important;
position:relative;
    margin:40px auto 0 auto;
        top: -47px;
        left: 0px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T20:45:15.260

我将此添加到标题中 - 不确定它是否是正确的方法，但它似乎正在工作

样式=“高度：450px；宽度：100%！重要；”

# amazon-ec2 - 亚马逊 ec2 设置每月最高费用

> ID：15991206
> 
> 赞同：0
> 
> 时间：2013-04-13T18:15:57.177
> 
> 标签：amazon-ec2, amazon

我看到很多类似但没有直接答案的问题。我只想使用一个实例来运行一些轻量级的每小时数据聚合并熟悉 ec2 实例。我觉得我不明白我的风险是什么。有没有办法设置我每月的最高费用？我不在乎我的实例是否在成本受到影响时关闭，我只想为我的实验承担有限责任。

此外，我自己对日志进行一些监控并不是我将为这样一个简单的实验采取的解决方案。我只是想知道是否有一些简单的方法来限制责任。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T20:05:08.433

简短的回答是否定的，您将无法设置上限并停止服务。

但是，您可以轻松监控您的成本。从[计费警报](http://aws.amazon.com/about-aws/whats-new/2012/05/10/announcing-aws-billing-alerts/)开始。帐户活动向您显示了迄今为止所发生成本的近乎实时的核算。

# mysql - 由于“未知数据库”错误，无法执行 rails 生成

> ID：15991211
> 
> 赞同：1
> 
> 时间：2013-04-13T18:16:52.517
> 
> 标签：mysql, ruby-on-rails, mysql2

这是我在使用 rails new simple_cms -d mysql 在新创建的应用程序中生成 $ rails 后遇到的错误

```
Users/localuser/.rvm/gems/ruby-1.9.3-p392/gems/mysql2-0.3.11/lib/mysql2/client.rb:44:in `connect': Unknown database 'simple_cms_development' (Mysql2::Error) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T18:20:30.783

检查您的 config/database.yml 是否正确，如果正确，请确保

```
rake db:create 
```

以便创建数据库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:18:25.553

它正在尝试连接到名为 simple_cms_development 的数据库，但失败了。您的 database.yml 是否正确？

# javascript - 将一个 div 分成两部分，在固定 div 下方显示一半，在上方显示一半

> ID：15991212
> 
> 赞同：14
> 
> 时间：2013-04-13T18:17:13.837
> 
> 标签：javascript, jquery, css, html

我在页面的中间有一个固定的 div。我有另一个包含图像库的 div。目前，图像按预期滚动“低于”固定 div。但我想要一种图像永远不会隐藏在固定 div 下的效果。他们不会进入 div 之下，而是将它们分开，部分图像显示在下方，部分图像显示在上方。本质上，我希望将一个 div（带有图片库的那个）分成两部分，一部分显示在固定 div 下方，一部分显示在上方。这里有一些精美的图形可以更好地说明我希望做什么。

我很乐意使用所需的 css/html/javascript 的任何组合。

可能吗？

```
 Current Behavior           Desired Behavior
|===================|     |===================|
|  =====    =====   |     |  =====    =====   |
| |     |  |     |  |     | |     |  |     |  |
| | img |  | img |  |     | | img |  | img |  |
| |  1  |  |  2  |  |     | |  1  |  |  2  |  |
|  =====    =====   |     |  =====    =====   |
|===================|     |===================|
|   fixed   div     |     |   fixed   div     |
|===================|     |===================|
| |  3  |  |  4  |  |     |  =====    =====   |
|  =====    =====   |     | |     |  |     |  |
|  =====    =====   |     | | img |  | img |  |
| |     |  |     |  |     | |  3  |  |  4  |  |
| | img |  | img |  |     |  =====    =====   |
|===================|     |===================| 
```

滚动一点

```
|===================|     |===================|
| | img |  | img |  |     | | img |  | img |  |
| |  1  |  |  2  |  |     | |  1  |  |  2  |  |
|  =====    =====   |     |  =====    =====   |
|  =====    =====   |     |  =====    =====   |
| |     |  |     |  |     | |     |  |     |  |
|===================|     |===================|
|   fixed   div     |     |   fixed   div     |
|===================|     |===================|
|  =====    =====   |     | | img |  | img |  |
| |     |  |     |  |     | |  3  |  |  4  |  |
| | img |  | img |  |     |  =====    =====   |
| |  5  |  |  6  |  |     |  =====    =====   |
|  =====    =====   |     | |     |  |     |  |
|===================|     |===================| 
```

再滚动一点

```
|===================|     |===================|
|  =====    =====   |     |  =====    =====   |
|  =====    =====   |     |  =====    =====   |
| |     |  |     |  |     | |     |  |     |  |
| | img |  | img |  |     | | img |  | img |  |
| |  3  |  |  4  |  |     | |  3  |  |  4  |  |
|===================|     |===================|
|   fixed   div     |     |   fixed   div     |
|===================|     |===================|
| | img |  | img |  |     |  =====    =====   |
| |  5  |  |  6  |  |     |  =====    =====   |
|  =====    =====   |     | |     |  |     |  | 
|  =====    =====   |     | | img |  | img |  |
| |     |  |     |  |     | |  5  |  |  6  |  |
|===================|     |===================| 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T20:59:11.137

在这里，我快速将 html、css 和 jquery 组合在一起，这在 Chrome 中对我有用。

**[jsfiddle 演示](http://jsfiddle.net/CsAB8/)**

**html:**

```
 <div id="toppart">
        <div class="tiles">
            <div class="tile">1</div>
            <div class="tile">2</div>
            <div class="tile">3</div>
            <div class="tile">4</div>
            <div class="tile">5</div>
            <div class="tile">6</div>
        </div>
    </div>
    <div id="strap">
        <p>the fixed strap</p>
    </div>
    <div id="bottompart"></div> 
```

**CSS**的关键部分：

 **```
#strap {
    position:absolute;
    top:45%;
    height: 10%;
    background-color:blue;
}
#toppart, #bottompart {
    background-color:#fff;
    position:absolute;
    height:45%;
    overflow:auto;
}
#bottompart {
    top:55%;
    z-index:-1;
}

#bottompart div {
    position:relative;
    top:-100%;
} 
```

和**javascript**代码：

```
 $(document).ready(function () {
          //mirror contents
          $('#bottompart').append($('#toppart').html());
          //scroll bottom with top
          $("#toppart").scroll(function(){
                 $("#bottompart").scrollTop($("#toppart").scrollTop());
          });
          //scroll top with bottom
          $("#bottompart").scroll(function(){
                 $("#toppart").scrollTop($("#bottompart").scrollTop());
          });
    }); 
```

希望你能明白 ;-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T18:23:05.727

这在 CSS 中是不可能的。我看到的唯一可行的实现是让顶部和底部 div 具有完全相同的内容，监听它们的 onscroll 事件，然后将它们“同步”到另一个具有所需间隙的。不过，您需要对 iOS 设备进行一些降级，因为它们在滚动完成之前不会发送 onscroll 事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-14T01:15:26.087

这是解决此问题的一种方法，但它使用 JavaScript。

我使用 JavaScript 复制原始内容并分成两部分。（这样你就不必提供两倍的内容）

顶部的 z-index 比底部高，溢出被隐藏，位置固定。高度设置为从页面顶部到中间元素的距离。它的内容被移动到本节中的包装器 div 中，允许它像视口一样工作。

底部与顶部对齐，但顶部的填充与中间部分相等（将内容向下推该量）。顶部覆盖了上半部分的内容，因此您只能看到中间元素下方的部分（最高 z-index）。

这样做的一个问题是它要求顶部有一个背景，它需要与页面的背景相匹配。

我在这里整理了一个演示：http: [//jsfiddle.net/Rykus0/mwkM8/](http://jsfiddle.net/Rykus0/mwkM8/)

HTML：

```
<div id='content'>
    <p>Your Content Here</p>
    <img src='http://lorempixel.com/200/250/' alt='img' />
    <img src='http://lorempixel.com/200/250/' alt='img' />
</div>
<div id='middle'></div> 
```

JS：

```
(function(w,d){
    var top = d.getElementById('content'),
        bottom = top.cloneNode(true),
        middle = d.getElementById('middle'),
        top_content = d.createElement('div');

    top.id = 'top';
    bottom.id = 'bottom';
    top_content.id = 'top_content';

    top_content.innerHTML = top.innerHTML;
    top.innerHTML = '';

    top.style.display = 'none'; //more efficient to change the style while the element is not displayed, and then display

    top.style.height = middle.offsetTop + 'px';

    bottom.style.paddingTop = middle.scrollHeight + 'px';
    console.log(middle.scrollHeight);

    top.parentNode.appendChild(bottom);
    top.appendChild(top_content);
    top.style.display = bottom.style.display = 'block';

    w.addEventListener('scroll', function(){
        var y = (w.pageYOffset !== undefined) ? w.pageYOffset : (d.documentElement || d.body.parentNode || d.body).scrollTop;
        top_content.style.top = -y + 'px';
    }, false);
})(window, document); 
```

CSS：

```
#middle{
    position:fixed;
    top:50%;
    z-index:100;
    margin-top:-25px;
    height:50px;
    width:100%;
    background:#999;
}

#top,#bottom{
    top:0;
    width:100%;
    background:#fff;
}

#top{
    position:fixed;
    z-index:50;
    overflow:hidden;
}
#top_content{
    position:relative;
}

#bottom{
    position:absolute;
    z-index:25;
} 
```**

# php - php 通过 onLoad 传递变量

> ID：15991216
> 
> 赞同：0
> 
> 时间：2013-04-13T18:17:29.603
> 
> 标签：php, javascript, ajax

我有一个 php 页面，它使用 javascript 在页面上生成日历。我正在尝试传递一个变量，以便我可以在加载的页面上引用它。

下面是我用来生成日历的脚本（以及其他几个）

```
<script language="javaScript" type="text/javascript">
function initialCalendar(){
    var hr = new XMLHttpRequest();
    var url = "calendar_start.php";
    var currentTime = new Date();
    var month = currentTime.getMonth() + 1;
    var year = currentTime.getFullYear();
    showmonth = month;
    showyear = year;
    var vars = "showmonth="+showmonth+"&showyear="+showyear;
    hr.open("POST", url, true);
    hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    hr.onreadystatechange = function() {
        if(hr.readyState == 4 && hr.status == 200) {
            var return_data = hr.responseText;
            document.getElementById("showCalendar").innerHTML = return_data;
        }
    }
    hr.send(vars);
    document.getElementById("showCalendar").innerHTML = "processing...";
}
</script> 
```

下面是我在 php 页面上显示它的方式：

```
<body onLoad="initialCalendar();"> 
```

我尝试在初始日历（）的括号中使用`'<?php echo $page; ?>'`和`'<?php $_POST['$page'] ?>'`

但是我没有运气，我希望我已经正确解释并且足够详细以使有意义，但是如果您需要更多信息，请发表评论

谢谢，瑞安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:48:25.270

由于您通过参数传递变量，例如

```
localhost/project/calendar.php?page=something 
```

使用`$_GET['page']`而不是`$_POST`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:20:42.833

我不知道您的`$_POST`阵列的布局，但如果我理解正确的问题，您应该尝试：

```
<body onLoad="initialCalendar('<?php echo $_POST['page'];?>');"> 
```

并将您的函数声明更改为：

```
function initialCalendar(page){ 
```

请注意，我在`'`PHP 输出的值周围使用了单引号。这是为了确保如果值是字符串，它不会破坏任何东西。

# android - 在android中测量噪音

> ID：15991217
> 
> 赞同：0
> 
> 时间：2013-04-13T18:17:33.143
> 
> 标签：android, audio, audio-recording

我可以借助 android 中的语音识别来检测语音，但想测量语音的强度，并在测量强度后相应地执行另一项任务。我这样做如下：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.voicerecogscreen);

    speakButton = (Button) findViewById(R.id.speakButton);

    wordsList = (ListView) findViewById(R.id.list);
    PackageManager pm = getPackageManager();
    List<ResolveInfo> activities = pm.queryIntentActivities(
            new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH), 0);
    if (activities.size() == 0)
    {
        speakButton.setEnabled(false);
        speakButton.setText("Recognizer not present");
    }        
}

/**
 * Handle the action of the button being clicked
 */
public void speakButtonClicked(View v)
{
    startVoiceRecognitionActivity();
}

/**
 * Fire an intent to start the voice recognition activity.
 */
private void startVoiceRecognitionActivity()
{
    Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,
            RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
    intent.putExtra(RecognizerIntent.EXTRA_PROMPT, "Voice recognition Demo...");
    startActivityForResult(intent, REQUEST_CODE);        
}

/**
 * Handle the results from the voice recognition activity.
 */
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data)
{
    if (requestCode == REQUEST_CODE && resultCode == RESULT_OK)
    {

        ArrayList<String> matches = data.getStringArrayListExtra(
                RecognizerIntent.EXTRA_RESULTS);
        wordsList.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,
                matches));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:31:54.897

通常要测量音频功率（强度），您会使用[AudioRecord](http://developer.android.com/reference/android/media/AudioRecord.html)获得 PCM 数据， 但我怀疑您是否可以在使用`Speech Recognizer`“不确定”时做到这一点。但如果这种方法有效，应该会给你带来高质量的结果。

如果它不起作用：

在SpeechRecognizer [Listener API](http://developer.android.com/reference/android/speech/RecognitionListener.html)中有：[onRMSChanged](http://developer.android.com/reference/android/speech/RecognitionListener.html#onRmsChanged%28float%29)和[onBufferReceived](http://developer.android.com/reference/android/speech/RecognitionListener.html#onBufferReceived%28byte%5B%5D%29)

在哪里：

*   **onRMSChanged**为您提供音频信号的当前 RMS 值（信号有多强）
*   **onBufferReceived**并且`AudioRecorder`应该使用相同的技术从 PCM 样本中查找 RMS 值。看看[这里](https://stackoverflow.com/questions/5800649/how-to-detect-silence-when-recording-in-java/5800854#5800854)

注意：并非所有`SpeechRecognizerListener`设备都会调用所有 API，因此您需要小心并使用测试驱动的方法来解决此问题。

# ios - 通过 iOS 应用销售 iBooks

> ID：15991228
> 
> 赞同：0
> 
> 时间：2013-04-13T18:18:17.710
> 
> 标签：ios, ibooks

假设我有一个应用程序，我可以在其中以 iBook 的形式销售补充内容。无论哪种方式他们都占 30%，但我可以使用该应用程序作为销售它的平台。有没有办法我可以通过应用程序本身销售它，但保留 iBook 的功能？（多点触控、iBook 作者等）

我可以通过 MDM 或无线方式进行分发，但我更喜欢一种简化的方法：

购买 > 在 iBooks 中打开 > 阅读

另一种选择是使用 UIPageViewController 在应用程序本身中复制书籍的功能。不过，这似乎是我在重新发明轮子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:32:05.483

使用 iOS 6.0 或更高版本，您可以`SKStoreProductViewController`用来销售其他应用程序、书籍、音乐等。iTunes 中的几乎所有内容都可以在您的应用程序中进行销售。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:29:56.630

不，如果您在应用内销售商品而不使用应用内购买，它将被拒绝

# jquery - jquery - 添加侦听器和性能

> ID：15991231
> 
> 赞同：0
> 
> 时间：2013-04-13T18:18:26.127
> 
> 标签：jquery, flip

我正在玩一个名为 Flip 的 jquery 插件。我想遍历一系列行为。如果这是最有效的方法，我不是。我怀疑我正在为每次迭代添加一个监听器，这可能会影响性能。

参考： http: [//lab.smashup.it/flip/](http://lab.smashup.it/flip/)

```
$(document).ready(function() {

        function myFunction(container, title,color){            
            var $this = $("#"+container);
            $this.flip({
                direction:'tb',
                content: title,
                color: color,
            })
        }

            var n=0;
            var doSomething = function(){                   
            if (n == 4) {n=1;} else {n++;}              

                switch(n)
            {
                case 1:
                myFunction("flipbox1","title1", "#1B9772");
                break;

                ...

                default:
                }
            }

            setInterval(doSomething, 1000); 

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:31:04.603

不要担心性能，这样的事情应该没什么大不了的。回调实际上是内置在这个 jQuery 插件中的，所以你不需要自己编写。我会尝试稍微修改您的代码，如下所示：

```
$(document).ready(function() {
    var title = "Hello!";
    var color = "orange";

    $("#myDiv").flip({
        direction:'tb',
        content: title,
        color: color,
        onBefore: function() {
            alert("Flip started");
        },
        onEnd: function() {
            alert("Flip ended");
        }
    });
}); 
```

# c++ - 使用 QJsonDocument 将子字符串解析为 JSON

> ID：15991232
> 
> 赞同：5
> 
> 时间：2013-04-13T18:18:26.183
> 
> 标签：c++, json, qt, parsing, qt5

我有一个字符串，其中*包含*（不是*）* JSON 编码的数据，就像在这个例子中：

```
foo([1, 2, 3], "some more stuff")
    |        |
  start     end   (of JSON-encoded data) 
```

我们在应用程序中使用的完整语言嵌套了 JSON 编码的数据，而语言的其余部分是微不足道的（只是递归的东西）。在递归解析器中从左到右解析这样的字符串时，我知道什么时候遇到 JSON 编码的值，比如这里`[1, 2, 3]`从索引 4 开始。解析这个子字符串后，我需要知道结束位置才能继续解析其余部分的字符串。

我想将此子字符串传递给像`QJsonDocument`Qt5 中经过良好测试的 JSON 解析器。但是在阅读[文档](http://qt-project.org/doc/qt-5.0/qtcore/qjsondocument.html)时，不可能只将一个子字符串解析为 JSON，这意味着一旦解析的数据结束（在使用`]`here 之后）控制返回而​​不报告解析错误。另外，我需要知道结束位置才能继续解析我自己的东西（这里剩余的字符串是`, "some more stuff")`）。

为此，我曾经使用自定义 JSON 解析器，它通过引用获取当前位置并在完成解析后更新它。但由于它是业务应用程序的安全关键部分，我们不想再坚持使用我自己制作的解析器。我的意思是有`QJsonDocument`，所以为什么不使用它。（我们已经使用 Qt5。）

作为一种解决方法，我正在考虑这种方法：

*   让我们`QJsonDocument`从当前位置开始解析子字符串（不是有效的 JSON）
*   错误报告了一个意外字符，这是 JSON 之外的某个位置
*   让我们`QJsonDocument`再次解析，但这次是具有正确结束位置的子字符串

第二个想法是编写一个“JSON 结束扫描器”，它获取整个字符串、一个起始位置并返回 JSON 编码数据的结束位置。这也需要解析，因为不匹配的括号/括号可以出现在字符串值中，但与完全手工制作的 JSON 解析器相比，编写（和使用）这样的类应该更容易（也更安全）。

有人有更好的主意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T19:20:26.117

我使用 Spirit Qi基于[http://www.ietf.org/rfc/rfc4627.txt滚动了一个快速解析器[*]。](http://www.ietf.org/rfc/rfc4627.txt)

它实际上并没有解析为 AST，但它解析了所有 JSON 有效负载，这实际上比这里需要的要多一点。

*[**此处**](http://liveworkspace.org/code/3k4Yor%242)*的示例*[(http://liveworkspace.org/code/3k4Yor$2)](http://liveworkspace.org/code/3k4Yor%242)*输出：

```
Non-JSON part of input starts after valid JSON: ', "some more stuff")' 
```

根据OP给出的测试：

```
const std::string input("foo([1, 2, 3], \"some more stuff\")");

// set to start of JSON
auto f(begin(input)), l(end(input));
std::advance(f, 4);

bool ok = doParse(f, l); // updates f to point after the start of valid JSON

if (ok) 
    std::cout << "Non-JSON part of input starts after valid JSON: '" << std::string(f, l) << "'\n"; 
```

我已经测试了其他几个涉及更多的 JSON 文档（包括多行）。

几点说明：

*   我制作了基于迭代器的解析器，因此它可能很容易与 Qt 字符串一起使用（？）
*   如果要禁止多行片段，请将跳过器从更改`qi::space`为`qi::blank`
*   有一个关于数字解析的一致性快捷方式（请参阅 TODO），它不会影响此答案的有效性（请参阅评论）。

[*] 从技术上讲，这更像是一个解析器*存根*，因为它不会转化为其他东西。它基本上是一个词法分析器，承担了太多的工作:)

* * *

## 示例的完整代码：

```
// #define BOOST_SPIRIT_DEBUG
#include <boost/spirit/include/qi.hpp>

namespace qi = boost::spirit::qi;

template <typename It, typename Skipper = qi::space_type>
    struct parser : qi::grammar<It, Skipper>
{
    parser() : parser::base_type(json)
    {
        // 2.1 values
        value = qi::lit("false") | "null" | "true" | object | array | number | string;

        // 2.2 objects
        object = '{' >> -(member % ',') >> '}';
        member = string >> ':' >> value;

        // 2.3 Arrays
        array = '[' >> -(value % ',') >> ']';

        // 2.4\.  Numbers
        // Note out spirit grammar takes a shortcut, as the RFC specification is more restrictive:
        //
        // However non of the above affect any structure characters (:,{}[] and double quotes) so it doesn't
        // matter for the current purpose. For full compliance, this remains TODO:
        //
        //    Numeric values that cannot be represented as sequences of digits
        //    (such as Infinity and NaN) are not permitted.
        //     number = [ minus ] int [ frac ] [ exp ]
        //     decimal-point = %x2E       ; .
        //     digit1-9 = %x31-39         ; 1-9
        //     e = %x65 / %x45            ; e E
        //     exp = e [ minus / plus ] 1*DIGIT
        //     frac = decimal-point 1*DIGIT
        //     int = zero / ( digit1-9 *DIGIT )
        //     minus = %x2D               ; -
        //     plus = %x2B                ; +
        //     zero = %x30                ; 0
        number = qi::double_; // shortcut :)

        // 2.5 Strings
        string = qi::lexeme [ '"' >> *char_ >> '"' ];

        static const qi::uint_parser<uint32_t, 16, 4, 4> _4HEXDIG;

        char_ = ~qi::char_("\"\\") |
               qi::char_("\x5C") >> (       // \ (reverse solidus)
                   qi::char_("\x22") |      // "    quotation mark  U+0022
                   qi::char_("\x5C") |      // \    reverse solidus U+005C
                   qi::char_("\x2F") |      // /    solidus         U+002F
                   qi::char_("\x62") |      // b    backspace       U+0008
                   qi::char_("\x66") |      // f    form feed       U+000C
                   qi::char_("\x6E") |      // n    line feed       U+000A
                   qi::char_("\x72") |      // r    carriage return U+000D
                   qi::char_("\x74") |      // t    tab             U+0009
                   qi::char_("\x75") >> _4HEXDIG )  // uXXXX                U+XXXX
               ;

        // entry point
        json = value;

        BOOST_SPIRIT_DEBUG_NODES(
                (json)(value)(object)(member)(array)(number)(string)(char_));
    }

  private:
    qi::rule<It, Skipper> json, value, object, member, array, number, string;
    qi::rule<It> char_;
};

template <typename It>
bool tryParseAsJson(It& f, It l) // note: first iterator gets updated
{
    static const parser<It, qi::space_type> p;

    try
    {
        return qi::phrase_parse(f,l,p,qi::space);
    } catch(const qi::expectation_failure<It>& e)
    {
        // expectation points not currently used, but we could tidy up the grammar to bail on unexpected tokens
        std::string frag(e.first, e.last);
        std::cerr << e.what() << "'" << frag << "'\n";
        return false;
    }
}

int main()
{
#if 0
    // read full stdin
    std::cin.unsetf(std::ios::skipws);
    std::istream_iterator<char> it(std::cin), pte;
    const std::string input(it, pte);

    // set up parse iterators
    auto f(begin(input)), l(end(input));
#else
    const std::string input("foo([1, 2, 3], \"some more stuff\")");

    // set to start of JSON
    auto f(begin(input)), l(end(input));
    std::advance(f, 4);
#endif

    bool ok = tryParseAsJson(f, l); // updates f to point after the end of valid JSON

    if (ok) 
        std::cout << "Non-JSON part of input starts after valid JSON: '" << std::string(f, l) << "'\n";
    return ok? 0 : 255;
} 
```

# fullcalendar - 更改日历视图之前的回调

> ID：15991234
> 
> 赞同：7
> 
> 时间：2013-04-13T18:18:42.400
> 
> 标签：fullcalendar

我将引导弹出窗口添加到单击时打开的日历事件中：

```
eventClick: (event, jsEvent, view) ->
  if event.ajaxUrl?
    elem = jQuery(@)
    elem.popover('destroy')

    jQuery.ajax({url: event.ajaxUrl})
    .done (result) ->
      elem.popover(
        placement: 'top'
        html: true
        trigger: 'manual'
        title: moment(event.start).format('dddd, DD. MMMM YYYY - HH:mm')
        content: result
        container: 'body')

      elem.popover('show') 
```

我的问题是，当我更改日历视图（例如更改月份或周/日布局）时，这些弹出框保持打开状态。由于弹出框绑定到`.fc-event`日历中的 div/span，我需要访问这些 DOM 元素才能运行`.popover('destroy')`。

每当更改 fullCalendar 视图时，旧的 DOM 元素都会替换为新视图的元素，因此我必须在视图实际更改之前访问它们。不幸的是，只有事件加载的回调（`loading`在视图更改后发生）和`viewDisplay`（相同，但你得到了新视图）。

为了确保我理解`viewDisplay`正确，我在日历中添加了一个小测试，它总是给我“0”（数据选择器来自[jquery 数据选择器](https://stackoverflow.com/questions/2891452/jquery-data-selector)）

```
viewDisplay: (view) ->
    alert(jQuery('.fc-event:data(popover)').size()) 
```

有没有办法在每次更改视图时挂接到日历进程 - 但在视图实际更改之前？

**编辑**

现在我只是在将鼠标移到任何日历按钮上时销毁弹出框（因为`click`在视图更改后将执行绑定），但此解决方案只是一种解决方法

```
jQuery('.fc-button').on 'mouseover', () ->
    jQuery('.fc-event:data(popover)').popover('destroy') 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-07-02T15:43:41.327

**V3**

我认为您正在寻找[http://fullcalendar.io/docs/display/viewRender/](http://fullcalendar.io/docs/display/viewRender/)

来自文档

> **视图渲染**
> 
> 当呈现新的日期范围或视图类型切换时触发。function(view, element) 视图是新视图的视图对象。element 是新视图容器的 jQuery 元素。
> 
> 当用户更改视图或调用任何日期导航方法时，将触发此回调。
> 
> 此回调将在视图完全渲染后触发，但在事件渲染之前（另请参见：eventAfterAllRender）。

## 更新

V4 从 viewRender 重命名为 datesRender [https://fullcalendar.io/docs/v4/datesRender](https://fullcalendar.io/docs/v4/datesRender)

V5 从 datesRender 重命名为 datesSet [https://fullcalendar.io/docs/datesSet](https://fullcalendar.io/docs/datesSet)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-06-20T06:48:30.417

在 V4 中，不推荐使用 viewRender，查看发行说明，现在它们有：

“viewSkeletonRender”回调，当新视图被挂载时触发，它接收一个包含很多好东西的视图对象。

“viewSkeletonDestroy”回调，在旧视图即将卸载之前触发。

--

或者，想法可能无法直接回答问题，您可以使用“datesRender”回调。我需要的是在上一个、下一个或视图更改时运行一个函数。（我必须根据日期范围和视图计算事件类型的总小时数）

# ios - UITableView中的UILabel

> ID：15991240
> 
> 赞同：1
> 
> 时间：2013-04-13T18:19:23.110
> 
> 标签：ios, ipad, uitableview, uilabel

我的问题是如何为每个标签添加灰色边缘（`UITableViewCell`包含许多 3 个标签）？

这样我的每个单元格的标签都会被边缘分开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:35:41.697

如果您只想将标签彼此分开，您可以在它们之间添加一个 UIImageView，宽度较小（如 1 或 2 个点），带有深色图片。如果您希望它们有边框，请设置：

```
myLabel.layer.borderColor = [UIColor blackColor];
myLabel.layer.borderWidth = 1.0; 
```

不要忘记包括`QuarzCore`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:33:02.800

通过将子视图添加到 UITableViewCell 的 contentView 属性，您可以将 UIView 作为 UITableViewCell 的内容。将标签作为子视图添加到单元格中，并在标签之间添加分隔符，您可以使用这种代码

```
UIView* vertLineView = [[UIView alloc] initWithFrame:CGRectMake(80, 0, 1, 44)];
vertLineView.backgroundColor = [UIColor redColor];
[self.contentView addSubview:vertLineView]; 
```

参考：[在 UITableViewCell 上绘制垂直分隔符](https://stackoverflow.com/questions/10563989/draw-vertical-separator-on-uitableviewcell)

希望这能解决您的问题。

# c - 如何在 C 中实现波浪线扩展？

> ID：15991241
> 
> 赞同：18
> 
> 时间：2013-04-13T18:19:40.520
> 
> 标签：c

`chdir("~/")`似乎不起作用。我是否应该查看字符串并手动替换波浪号，还是有更好的方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-13T18:27:03.560

POSIX 提供[`wordexp(3)`](http://linux.die.net/man/3/wordexp)执行类似 shell 的扩展，包括波浪号扩展。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-13T18:28:50.020

您可以使用[`wordexp`](http://linux.die.net/man/3/wordexp)下面的示例

```
#include <stdio.h>
#include <wordexp.h>

int main(int argc, char* argv[]) {
    wordexp_t exp_result;
    wordexp(argv[1], &exp_result, 0);
    printf("%s\n", exp_result.we_wordv[0]);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-13T18:21:56.883

路径中的波浪号是特定于 shell 的东西。您可以做什么查看第一个字符是否是波浪号和斜杠（或字符串的波浪号结尾），然后将波浪号替换为环境变量的值`HOME`（您可以从中获取[`getenv`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getenv.html)）。

如果第二个字符*不是*斜线，则很可能是`~user/path`. 然后您必须提取用户名并使用例如[`getpwnam`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getpwnam.html)获取用户的密码条目，其中包含该用户的主目录。

# ruby-on-rails - simple_form 标签为列值

> ID：15991243
> 
> 赞同：1
> 
> 时间：2013-04-13T18:19:53.633
> 
> 标签：ruby-on-rails, simple-form

我在 rails 中使用 simple_form 并且有一种情况，我希望标签是另一个字段的值。在这种情况下，该字段不会更改，因此我不想出现在表单上。

为了更好地解释，我有两行看起来像

```
<%= f.input :name, :label => false, :disabled => true, :input_html => { :class => 'input-small' } %>
<%= f.input :status, :collection => ["Not started", "Passed", "Failed"], :include_blank => false, :label => false %> 
```

我想做的是让第一个元素成为第二个元素的标签。现在我可以通过将它们内联来做到这一点，但我希望它们与其他元素对齐，以便标签和输入对齐。

所以做类似的事情

```
<%= f.input :status, :collection => ["Not started", "Passed", "Failed"], :include_blank => false, :label => f.name %> 
```

或者

```
<%= f.input :status, :collection => ["Not started", "Passed", "Failed"], :include_blank => false, :label => {f.input :name, :label => false, :disabled => true} %> 
```

关于如何解决这个问题的任何想法？

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-18T18:12:54.167

'f.object' 获取与该表单关联的对象，然后您可以访问以下字段：

```
<%= f.select(:status, [["Not started","Not started"], ["Passed", "Passed"], ["Failed", "Failed"]]), :label => f.object.name %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T10:06:01.083

最后，我确实选择了内联选项，这并不理想，但完成了工作。但是我必须执行以下操作。

主窗体设置为规范窗体 其下方的块设置为窗体水平

然后子表单部分定义为无 simple_form

```
<div class="control-group form-inline">
  <div class="controls">
    <%= f.text_field :name, :disabled => 'true', :size => 10 %>
    <%= f.select(:status, [["Not started","Not started"], ["Passed", "Passed"], ["Failed", "Failed"]]) %>
  </div>
</div> 
```

如果将其设置为简单形式，则内联将无法按要求工作。再次不完美，当然也不优雅，但有效

# javascript - 为所有浏览器和移动网络浏览器 javascript 播放波形文件

> ID：15991246
> 
> 赞同：0
> 
> 时间：2013-04-13T18:20:19.393
> 
> 标签：javascript, html, audio, wave

如何通过javascript或其他方式为所有浏览器和移动浏览器播放波形文件？

我需要播放 alert.wave 或 mp3 文件，但`<audio>`不能`<embed>`在移动网络浏览器上运行。

我应该怎么办？

你有没有办法跨浏览器播放这个波形文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:57:49.763

首先确保您正确引用了文件。

还要检查每个浏览器用于音频的编解码器。[https://developer.mozilla.org/en-US/docs/HTML/Supported_media_formats](https://developer.mozilla.org/en-US/docs/HTML/Supported_media_formats)

之后你应该可以玩它们了。

# android - 主要活动未打开

> ID：15991254
> 
> 赞同：0
> 
> 时间：2013-04-13T18:21:00.593
> 
> 标签：android

我的应用程序似乎可以正常启动，并带有启动画面和其他东西。但是当它休眠 6 秒并且它应该进入主要活动时，应用程序崩溃了，请问有什么帮助吗？

这是我的代码（android.intent.action1.MAINACTIVIVTY，“action”被故意更改为“action1”）

```
package com.hellhogone.multitools;

import com.hellhogone.multitools.R;

import android.media.MediaPlayer;
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Window;
import android.view.WindowManager;

public class Splash extends Activity{

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN); 
    setContentView(R.layout.splash);

    MediaPlayer yo = MediaPlayer.create(Splash.this, R.raw.smusic); 
    yo.start(); 

    Thread timer = new Thread(){
        public void run(){
            try{
                sleep(6000);
            }catch(InterruptedException e){
                e.printStackTrace();
            }finally{
                Intent h1 = new Intent("android.intent.action1.MAINACTIVITY");
                startActivity(h1); 
            }
        }
    };

    timer.start(); 
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    finish(); 
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:26:51.507

您不能从 UI 线程以外的其他线程启动活动。为避免此问题，您可以使用[`runOnUiThread()`](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)：

```
 }finally{
        runOnUiThread(new Runnable() {
            public void run() {
                Intent h1 = new Intent("android.intent.action1.MAINACTIVITY");
                startActivity(h1);
            }
        });
    } 
```

# .htaccess - 选择规范版本

> ID：15991271
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:22:28.747
> 
> 标签：.htaccess, https, ssh, seo, canonicalization

我正在运行一个使用 SSH 证书的网站。这留给潜在的 CNames： https://example.com https://www.example.com http://example.com http://www.example.com

从 SEO 的角度来看，我知道最好选择一个然后设置 301 重定向。

在 Google 网站管理员工具中，您可以选择 www。和非 www。版本。我随意选择了非www。版本。没有特别的理由。

然后我在这个论坛上获取了一些关于如何编辑我的 htaccess 文件以将所有 URL 重定向到[http://example.com](http://example.com)的代码。

我想知道这里是否有最佳实践。选择非 https 版本是否会使 SSH 无效？从搜索的角度来看，从 SEO 的角度来看，这 4 个版本中的哪一个更好？

任何人都对选择 4 中的哪一个有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:06:34.817

我假设当您说[“SSH”（安全外壳）](http://en.wikipedia.org/wiki/Secure_Shell)时，您的意思是[“SSL”（安全套接字层）](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)。

“http:”表示正常的未加密不安全http。“https:”表示在 SSL/TLS 之上分层的 http，它提供网站的加密和身份验证。所以是的，使用非 https 版本意味着您无法获得 SSL 的安全优势。

SSL 证书通常仅对单个特定主机名有效。例如，如果您的网络服务器有一个仅对 www.example.com 有效的证书，但有人试图访问 https://example.com，他们将收到错误消息或可怕的警告。CNAME 是不够的：您还需要该名称的有效证书。因此，请使用证书中指定的名称。（当然，如果您为对 example.com 和 www.example.com 都有效的证书支付了额外费用，那么您可以在它们之间进行选择。但是由于我对 SEO 的了解可能比您少，所以我不会建议哪个一个是最好的。）

# c# - 如何在堆叠栏中反转轴？

> ID：15991276
> 
> 赞同：2
> 
> 时间：2013-04-13T18:22:42.493
> 
> 标签：c#, zedgraph

我正在尝试为甘特图创建一个水平堆积条形图，但轴是相反的。

我写的代码如下：

```
a[0] = 0;
a[1] = 6;
a[2] = 7;
a[3] = 7;

b[0] = 6;
b[1] = 0;
b[2] = 11;
b[3] = 0;

c[0] = 0;
c[1] = 6;
c[2] = 0;
c[3] = 19;

string[] labels = new string[] { "A1", "A2", "B1" , "B2" };

GraphPane _p = zedGraphControl1.GraphPane;

BarItem bar1 = _p.AddBar("", a, null, Color.White);
BarItem bar2 = _p.AddBar("", b, null, Color.Blue);
BarItem bar3 = _p.AddBar("", c, null, Color.Green);

_p.BarSettings.MinClusterGap = 0;

_p.YAxis.Scale.TextLabels = labels;
_p.YAxis.Type = AxisType.Text;

_p.BarSettings.Base = BarBase.Y;
_p.BarSettings.Type = BarType.Stack; 
```

如何反转y轴？我希望 A1 在顶部，然后是 A2、B1 和 B2。

![在此处输入图像描述](https://i.stack.imgur.com/cLAN5.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T04:30:08.930

```
_p.YAxis.Scale.IsReverse = true; 
```

# linux - 执行包含重定向字符的 bash 行（命令）

> ID：15991277
> 
> 赞同：1
> 
> 时间：2013-04-13T18:22:53.493
> 
> 标签：linux, bash

如何执行包含重定向字符的 bash 行（命令）？例如，以下行不能被执行。

```
home>CMD="ls -l > out"
home>$CMD
ls: cannot access >: No such file or directory
ls: cannot access out: No such file or directory 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T18:27:26.827

`eval $CMD`会做你想做的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T18:31:37.077

您可以使用 eval，但不建议这样做。如果将命令存储在变量中的目的是多次执行，则最好使用函数。

例子：

```
dols() {
    ls -l > out
}

dols 
```

另请参阅：[我正在尝试将命令放入变量中，但复杂的情况总是失败！](http://mywiki.wooledge.org/BashFAQ/050)

# c# - ADO.NET 实体模型更新

> ID：15991278
> 
> 赞同：2
> 
> 时间：2013-04-13T18:22:56.950
> 
> 标签：c#, linq, ado.net, entities

嗨，我正在尝试从数据库中更新一条记录，但由于某种原因，该记录没有更新。我正在使用 ADO.NET 实体框架 4.0

```
public void updateCredits(string username)
 {
     myDBEntities Entity = new myDBEntities();
     User u = Entity.Users.SingleOrDefault(u => u.username == username)
     u.firstname = "name";
     u.credits = 11.5;
     Entity.SaveChanges();
 } 
```

我尝试重新启动 VS 甚至 SQL Server，但没有运气。难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:35:10.837

更改跟踪似乎存在问题。您可以尝试手动将`User`实体标记为已更改，如下所示：

```
public void updateCredits(string username)
 {
     myDBEntities Entity = new myDBEntities();
     User u = Entity.Users.SingleOrDefault(u => u.username == username)
     u.firstname = "name";
     u.credits = 11.5;
     Entity.Entry(u).State = EntityState.Modified;  //<-- manually indicate the entity was changed
     Entity.SaveChanges();
 } 
```

如果上面的代码有效，那么很有可能 ChangeTracking 以某种方式被禁用。

# c# - 在多对多中允许重复吗？

> ID：15991279
> 
> 赞同：2
> 
> 时间：2013-04-13T18:23:00.153
> 
> 标签：c#, entity-framework, ef-code-first, many-to-many, duplicates

我有 Item 表，它本身有 manyTomany：

```
public virtual ICollection<Item> Related { get; set; }

modelBuilder.Entity<Item>().HasMany(x => x.Related ).WithMany(); 
```

数据：

```
Item_Id   Item_Id1
8         2
8         3
8         4 
```

如何允许重复，例如允许另一个 8-2，当我尝试插入另一个“重复”数据时，它只显示 1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-12T17:19:30.500

我认为问题的根源是误解了实体是什么。一个实体是唯一的，并且具有唯一的 ID，例如，一家公司可能有一组唯一的雇员，因此您不能在同一个集合中拥有同一个人的两个实例。如果您有一个购物车，您必须将集合中的项目视为“订单行”，而不是项目本身。任何订单行都有自己的 ID 和对实体的引用，即您要购买的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:46:13.870

我没有专门检查这个，所以你可能需要弄清楚细节 -
但是（**我认为**）**唯一的方法是`manually define`索引表**（例如`Item2Item`）。

> 查看我制作的这篇文章以获取更多信息 [EF code-first many-to-many with additional data](https://stackoverflow.com/questions/10199158/ef-code-first-many-to-many-with-additional-data/10199455#10199455) 这是关于如何为多对多创建自定义表 - 添加额外字段。

现在您有了一个自定义表，**您需要对其进行一些更改**- 您需要从`.HasKey`. **而是使用您自己的 pk**，例如任何其他表的身份。

即，您可以定义一个唯一的 PK，与任何其他表一样的身份 - 并将其作为您的密钥。这应该让您在 fk 列中有重复的键）。

* * *

检查这篇文章，因为它在逻辑上看起来很接近（虽然不一样）
[多对多（连接表）关系与具有 codefirst 或流式 API 的同一实体？](https://stackoverflow.com/questions/10041695/many-to-many-join-table-relationship-with-the-same-entity-with-codefirst-or-fl/10048992#10048992)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T10:09:50.423

好吧，这给了我最终的解决方案--> [EF Code 首先，如何实现从一个表到另一个表的两个外键？](https://stackoverflow.com/questions/4698233/ef-code-first-how-can-i-achieve-two-foreign-keys-from-one-table-to-other-table), NSGaga 感谢您的指导

```
public class Item : IValidatableObject
{
    [Key]
    public int ID { get; set; }
    public virtual ICollection<ItemRelation> Related{ get; set; }
    public string Name { get; set; }

    public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        if (....)
        {
            yield return new ValidationResult("Name not valid", new[] { "Name" });
        }

    }
}

public class ItemRelation
{
   [Key]
    public int ID { get; set; }

    public int ItemAID { get; set; }
    public virtual Item ItemA { get; set; }

    public int ItemBID { get; set; }
    public virtual Item ItemB { get; set; }

}

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);

        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();

        modelBuilder.Entity<ItemRelation>().HasRequired(c => c.ItemA)
                            .WithMany(m => m.Related)
                            .HasForeignKey(c => c.ItemAID)
                            .WillCascadeOnDelete();

        modelBuilder.Entity<ItemRelation>().HasRequired(c => c.ItemB)
                           .WithMany()
                           .HasForeignKey(c => c.ItemBID)
                           .WillCascadeOnDelete(false);

    }

    public DbSet<Item> Items { get; set; }
    public DbSet<ItemRelation> ItemsRelations { get; set; } 
```

数据：

```
Id   ItemA_Id   ItemB_Id
1    8         2
2    8         3
3    8         5
4    8         5
5    8         5
6    1         6
7    5         4
8    2         9 
```

# python - 无法在scrapy中导入项目

> ID：15991282
> 
> 赞同：4
> 
> 时间：2013-04-13T18:23:48.080
> 
> 标签：python, module, web-scraping, scrapy

我有一个非常基本的蜘蛛，按照入门指南中的说明进行操作，但由于某种原因，尝试将我的项目导入我的蜘蛛会返回错误。蜘蛛和项目代码如下所示：

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector

from myProject.items import item

class MyProject(BaseSpider):
    name = "spider"
    allowed_domains = ["website.com"]
    start_urls = [
        "website.com/start"
    ]

    def parse(self, response):
        print response.body

from scrapy.item import Item, Field

class ProjectItem(Item):
    title = Field() 
```

当我运行此代码时，scrapy 要么找不到我的蜘蛛，要么无法导入我的项目文件。这里发生了什么？这应该是一个运行正确的例子吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T11:41:58.977

我在使用`scrapy`. 您可以在 Python 模块的开头添加这一行：

```
from __future__ import absolute_import 
```

更多信息在这里：

*   [http://www.python.org/dev/peps/pep-0328/#rationale-for-absolute-imports](http://www.python.org/dev/peps/pep-0328/#rationale-for-absolute-imports)
*   [http://pythonquirks.blogspot.ru/2010/07/absolutely-relative-import.html](http://pythonquirks.blogspot.ru/2010/07/absolutely-relative-import.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T18:23:48.080

所以，这是我前几天遇到的一个问题，我能够通过一些试验和错误来解决，但我找不到任何文档，所以我想我会提出这个问题，以防万一遇到和我一样的问题。

这不是scrapy的问题，而是命名文件以及python如何处理导入模块的问题。基本上问题是，如果您将蜘蛛文件命名为与项目相同的名称，那么您的导入将会中断。Python 将尝试从最接近您当前位置的目录导入，这意味着它将尝试从无法工作的蜘蛛目录中导入。

基本上只需将您的蜘蛛文件的名称更改为其他名称，它就会正常运行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-24T05:32:49.080

您正在导入一个字段，您必须从 items.py 导入一个类，例如 from myproject.items import **class_name**。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-18T08:42:49.913

如果结构是这样的：

```
package/
    __init__.py
    subpackage1/
        __init__.py
        moduleX.py
        moduleY.py
    subpackage2/
        __init__.py
        moduleZ.py
    moduleA.py 
```

如果你在moduleX.py中，导入其他模块的方式可以是：

```
from .moduleY.py import *

from ..moduleA.py import *

from ..subpackage2.moduleZ.py import * 
```

请参阅：[PEP 导入：多行和绝对/相对](https://www.python.org/dev/peps/pep-0328/#rationale-for-absolute-imports)

# java - Java SimpleDateFormat 将结果解析一小时（是的，我设置了时区）

> ID：15991285
> 
> 赞同：9
> 
> 时间：2013-04-13T18:23:51.797
> 
> 标签：java

谜语：为什么这个简单的 JUnit 断言会失败？

```
public void testParseDate() throws ParseException {
    final SimpleDateFormat formatter = new SimpleDateFormat(
            "yyyy-MM-dd HH:mm:ss z");
    formatter.setTimeZone(UTC);
    final Calendar c = new GregorianCalendar();
    c.setTime(formatter.parse("2013-03-02 11:59:59 UTC"));

    assertEquals(11, c.get(HOUR_OF_DAY));
} 
```

我原以为一天中的小时是 11，但根据 JUnit，一天中的小时是 12。

```
junit.framework.AssertionFailedError: expected:<11> but was:<12>
at junit.framework.Assert.fail(Assert.java:47)
    ... snip ... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T18:46:42.547

公历的默认构造函数使用机器的本地时区。如果这与 UTC 不同，则会出现这种行为。尝试使用 GregorianCalendar(TimeZone) 构造函数并将 UTC 传递给它。

这将起作用：

```
public void testParseDate() throws Exception {

    TimeZone UTC = TimeZone.getTimeZone("UTC");

    // Create a UTC formatter
    final SimpleDateFormat formatter = new SimpleDateFormat(
            "yyyy-MM-dd HH:mm:ss z");
    formatter.setTimeZone(UTC);

    // Create a UTC Gregorian Calendar (stores internally in UTC, so
    // get(Calendar.HOUR_OF_DAY) returns in UTC instead of in the
    // local machine's timezone.
    final Calendar c = new GregorianCalendar(UTC);

    // Ask the formatter for a date representation and pass that
    // into the GregorianCalendar (which will convert it into
    // it's internal timezone, which is also UTC.
    c.setTime(formatter.parse("2013-03-02 11:59:59 UTC"));

    // Output the UTC hour of day
    assertEquals(11, c.get(Calendar.HOUR_OF_DAY));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:58:09.157

您还需要为日历设置时区/夏令时。看看这个摘自[文档](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/GregorianCalendar.html)的片段：

```
 // create a Pacific Standard Time time zone
 SimpleTimeZone pdt = new SimpleTimeZone(-8 * 60 * 60 * 1000, ids[0]);

 // set up rules for daylight savings time
 pdt.setStartRule(Calendar.APRIL, 1, Calendar.SUNDAY, 2 * 60 * 60 * 1000);
 pdt.setEndRule(Calendar.OCTOBER, -1, Calendar.SUNDAY, 2 * 60 * 60 * 1000);

 // create a GregorianCalendar with the Pacific Daylight time zone
 // and the current date and time
 Calendar calendar = new GregorianCalendar(pdt); 
```

# azure - azure worker 角色中的异步/等待导致角色回收

> ID：15991287
> 
> 赞同：13
> 
> 时间：2013-04-13T18:24:00.680
> 
> 标签：azure, async-await

我在我的 WorkerRole (RoleEntryPoint) 中玩任务、异步和等待。

我有一些无法解释的回收，现在我发现如果在等待调用中运行时间过长，角色就会回收。要重现它，只需在 Run 方法中执行 await Task.Delay(60000) 即可。

谁能给我解释一下为什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-13T18:59:49.233

该`Run`方法*必须*阻塞。从[文档](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx)：

> 如果您确实重写了 Run 方法，您的代码应该无限期地阻塞。如果 Run 方法返回，则通过引发 Stopping 事件并调用 OnStop 方法自动回收角色，以便您的关闭序列可以在角色脱机之前执行。

一个简单的解决方案是这样做：

```
public override void Run()
{
  RunAsync().Wait();
}

public async Task RunAsync()
{
  while (true)
  {
    await Task.Delay(60000);
  }
} 
```

或者，您可以[`AsyncContext`从我的 AsyncEx 库](https://nitoasyncex.codeplex.com/wikipage?title=AsyncContext)中使用：

```
public override void Run()
{
  AsyncContext.Run(async () =>
  {
    while (true)
    {
      await Task.Delay(60000);
    }
  });
} 
```

无论您选择哪个选项，*都不*`Run`应该是. 这有点像控制台应用程序（[请参阅我的博客了解为什么](http://blog.stephencleary.com/2012/02/async-console-programs.html)[不允许](http://blog.stephencleary.com/2012/02/async-console-programs.html)）。*`async``Main`[`async Main`](http://blog.stephencleary.com/2012/02/async-console-programs.html)*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:53:30.803

我建议使用较低的值，`Task.Delay`例如 1000 (ms)。我怀疑工人角色无法对健康检查做出足够快的反应。然后该角色被视为无响应并重新启动。

确保该`Run`方法永远不会以这样的方式返回

```
while (true)
{               
    Thread.Sleep(1000);
} 
```

或者`Task.Delay`在你的情况下。*

# c++ - 需要帮助为 std 字符串应用 MinGW 补丁，得到意想不到的结果

> ID：15991290
> 
> 赞同：0
> 
> 时间：2013-04-13T18:24:13.830
> 
> 标签：c++, mingw, std, patch

我正在尝试应用这些补丁：

[http://tehsausage.com/mingw-to-string](http://tehsausage.com/mingw-to-string)

这样我就可以使用无论如何我都应该可以访问的 std 字符串内容。

我有 MinGW 4.7.2，起初，我尝试复制 zip 文件，但没有成功。

现在我正在尝试手动应用补丁。我将补丁信息复制到 file.patch 中，将其放在与我正在修补的文件相同的文件夹中，然后运行

```
patch < file.patch 
```

然后我得到：

```
 patching file stdio.h
 patch unexpectedly ends in middle of line
 Hunk #1 FAILED at 574.
 patch unexpectedly ends in middle of line
 1 out of 1 hunk FAILED -- saving rejects to file stdio.h.rej
 patch unexpectedly ends in middle of line 
```

我确保最后没有多余的空白..

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:48:41.647

OK, installed the latest mingw from the web-site, downloaded the [patch files](http://tehsausage.com/mingw-to-string) and made sure they were clean.

I applied each one individually, and they worked without issue. There was a warning that it was 'Stripping the trailing CRs from the file', but it worked without issue.

each patch is applied in the appropriate directory; e.g. the `stdio.patch` is applied to `stdio.h` which is in `/mingw/include` using:

```
patch </path/to/stdio.patch 
```

ditto for `wchar.patch`

The `os_defines.h` file is found at `/mingw/lib/gcc/mingw32/4.7.2/include/c++/mingw32/bits`, and the patch works properly for that one as well.

I created a github with the patches at [https://github.com/petesh/mingwpatches.git](https://github.com/petesh/mingwpatches.git) - you can clone the repository, or download the individual files from there. Each of them should work correctly without more than a complaint about the trailing CR warning.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:31:20.857

查看补丁文件后，您可能需要使用该命令的`-c`选项。`patch`这`patch`表明补丁文件来自上下文差异。

例如

```
$ patch -c < file.patch 
```

# ios - NSFileWrapper 包是否类似于 Mac OS X 包 (pkg)？

> ID：15991293
> 
> 赞同：0
> 
> 时间：2013-04-13T18:24:25.627
> 
> 标签：ios, nsfilewrapper

在许多[地方](http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/DocumentBasedAppPGiOS/CreateCustomDocument/CreateCustomDocument.html#//apple_ref/doc/uid/TP40011149-CH8-SW2)，Apple 文档都谈到了由 NSFileWrapper 创建的文件包（例如，用于 iCloud）。这是否类似于用于在 OS X 平台上将文件夹隐藏为单个文件的 .pkg 格式？

我有一个包含多个文本文件的应用程序，我希望能够让用户备份。我已经使用 NSFileWrapper 创建了一个执行此操作的“文件”。我曾认为这类似于 OS X 上的 .pkg 文件，但尽管随后将文件带入 OS X（通过电子邮件），但我无法打开它 - 尽管重命名文件等。

那么，NSFileWrapper 的“包”与 OS X 的“包”完全不同吗？

谢谢，理查德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:27:09.373

不。一个在文件系统级别上工作，而另一个是一堆文件与一组特定的解包指令一起压缩

NSFileWrapper，来自您提到的链接：

> 文件包装器是文件系统节点的运行时表示，它可以是目录、常规文件或符号链接。

虽然 a`.pkg`看起来像：

> 在许多平台上用于安装文件的基于 xar 的格式。

维基百科，[（不）令人惊讶](http://en.wikipedia.org/wiki/.pkg)的是，对 .pkg 到底是什么有一个不错的概述。

# vim - 在 FakeVim 中更改缓冲区

> ID：15991295
> 
> 赞同：3
> 
> 时间：2013-04-13T18:24:31.127
> 
> 标签：vim, qt-creator, fakevim

有谁知道[`FakeVim`](http://doc.qt.digia.com/qtcreator-2.5/creator-editor-fakevim.html)在文件之间更改的一些快捷方式？是否可以在 Fake 中使用缓冲区`Vim`？我不小心发现这`Ctrl+w,w`会让你进入下一个窗口。有人知道其他吗？例如到达左侧、右侧、顶部、底部窗口？（vim`Ctrl+w,l`和其他）？是否有任何文件`FakeVim`？是否可以配置`FakeVim`vimrc 文件来创建在缓冲区和视图之间切换的快捷方式`Projects`？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T12:38:23.363

最近我一直在对 FakeVim 插件进行大部分更改。

[您可以在https://github.com/hluk/FakeVim（Git](https://github.com/hluk/FakeVim) master 分支的最新版本）找到 FakeVim 支持的 Vim 命令列表。

我仍然不确定如何在 Qt Creator 中记录这些功能。我可能会`:help <command>`在不久的将来实现类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:52:21.690

[FakeVim 文档](http://doc.qt.digia.com/qtcreator-2.5/creator-editor-fakevim.html)严重缺乏。例如，这一段是如此模糊以至于不负责任：

> 在 FakeVim 模式下，主编辑器中的大多数击键都会被截取并以类似于 Vim 的方式进行解释。Qt Creator 中不包含 Vim 的文档。有关使用 Vim 的更多信息，请参阅 Vim 网站上的文档。

基本上，如果没有适当的文档或查看编辑器的源代码，就不可能知道什么应该起作用，什么不应该起作用，以及起作用的行为以何种方式偏离了 Vim 的行为。如今，这就是现代 IDE 的通行证。

随便……</p>

我认为您最好的选择就是反复试验：因为您似乎知道如何使用 Vim，所以您将有很多命令和快捷方式可以尝试。

# javascript - 没有滚动 javascript 导致文本输入无效？iPhone 网络应用程序

> ID：15991297
> 
> 赞同：1
> 
> 时间：2013-04-13T18:24:51.253
> 
> 标签：javascript, iphone, web-applications, text, input

我有一个 iPhone 网络应用程序，我使用这个 Javascript 使滚动或选择变得不可能：

```
document.ontouchstart = function(e){
    e.preventDefault();
} 
```

我刚刚发现这段代码也“禁用”了一个输入表单：

```
<input type="text" /> 
```

嗯..它在那里，但是当你点击它时，没有弹出键盘..

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:52:34.557

最好的选择是做类似的事情

```
document.ontouchstart = function(e){
  if(e.target.type == 'text'){

  }
  else {
    e.preventDefault();
  }
} 
```

检测事件目标是否是文本输入。

# java - 点击时使用 ImageView 填充屏幕

> ID：15991305
> 
> 赞同：0
> 
> 时间：2013-04-13T18:25:49.460
> 
> 标签：java, android, image, imageview, lightbox

我的应用程序中有一个`ListView`在每一行都有文本和图像的应用程序。现在，当单击该行时，我想缩放图像以填满屏幕。在下一次单击时，它应该折叠到原来的大小。

我正在寻找类似于[Lightbox](http://lokeshdhakar.com/projects/lightbox2/)的东西。单击图像时，它会展开。

我可以访问 ImageView。我需要做什么才能达到这种效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:44:55.390

如果要放大/缩小视图，可以使用缩放动画。我建议观看 Chet Haase 教程 DevBytes：[查看动画](https://www.youtube.com/watch?feature=player_detailpage&v=_UWXqFBF86U#t=54s)

# android - 我的 Eclipse 或手机有什么问题？

> ID：15991306
> 
> 赞同：0
> 
> 时间：2013-04-13T18:25:56.690
> 
> 标签：android, eclipse, logcat

当我在Eclipse运行时连接我的手机时，在LogCat中它继续写一些没有结束的东西，并且一直打印一些错误消息“Fatal signal something”，这是怎么回事？这是日志的一部分，它仍在打印，而且不会很快停止

[http://pastebin.com/4Z58CiGm](http://pastebin.com/4Z58CiGm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:28:35.673

这些都是来自系统应用程序和进程的日志，您可以放心地忽略它们。

您应该使用以下方法标记应用程序中的所有语句：

```
Log.d("MyAwesomeTag", "Message"); 
```

然后您可以使用过滤它们`tag:MyAwesomeTag`并忽略不属于您的所有内容

# console - 如何使用终端的比特币私钥签署消息

> ID：15991310
> 
> 赞同：3
> 
> 时间：2013-04-13T18:26:18.277
> 
> 标签：console, terminal, digital-signature, bitcoin

我正在尝试使用比特币私钥签署一条消息，以便从 InstaWallet 获得退款。

有关如何从 OS X 上的终端执行此操作的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T23:57:37.167

（第 22、23 页来自[比特币、椭圆曲线和 ECDSA 数学简介](https://github.com/bellaj/Blockchain/blob/6bffb47afae6a2a70903a26d215484cf8ff03859/ecdsa_bitcoin.pdf)）

> 4.6 ECDSA
> 
> 2.4.2 简要概述了数字签名的工作原理。比特币使用椭圆曲线的数学作为其数字签名的基础。召回椭圆曲线由 T = (p, a, b, G, n, h) 定义，比特币使用 sep256k1 规定的参数。我们还有私钥和公钥对 (Kpriv, Kpub 其中 Kpub = Kpriv × G，如 4.5 所述。如果 Alice (A) 和 Bob (B) 想要互相发送消息（或交易），这是他们将如何创建和验证数字签名。
> 
> 4.6.1 签名生成 [7]
> 
> 为了给消息签名，Alice 将执行以下操作。
> 
> 1.  选择一个随机整数 k，1 ≤ k ≤ n - 1。
> 2.  计算 kG = (x1, y1) 并将 x1 转换为整数 x1。
> 3.  计算 r = x1 (mod n)。如果 r = 0，则转到步骤 1。
> 4.  计算 k^-1 (mod n)。其中 k^−1 是乘法逆元，满足 k−1

[ ... ]

请点击链接并继续，通过第 23 页继续执行步骤 5、6 和 7；或通过 Jorky10 在此处通过 python 回答： [How to sign and verify signature with ecdsa in python](https://stackoverflow.com/questions/34451214/how-to-sign-and-verify-signature-with-ecdsa-in-python)

# php - 带有 PHP Captcha 插件的 HTML 表单，我遇到了一些问题

> ID：15991312
> 
> 赞同：1
> 
> 时间：2013-04-13T18:26:26.557
> 
> 标签：php, javascript, captcha, forms

我一直在寻找类似的问题，但没有找到我的特殊情况。

我在我拥有的表单中使用 PHP Captcha 插件。我处理不正确和正确的验证码条目非常相似。如果用户的短语是正确的，我会抛出一个 javascript“成功”警报，发送表单电子邮件，然后将它们发送回最后一页。如果不正确，我会抛出一个 javascript“您的错误”警报并将它们发送回最后一页。

我的问题 - 如果它们不正确，我需要刷新 Captcha，因为使用不正确的 Captcha 条目，您将始终需要刷新图像以进行另一次尝试。此外，如果它们正确，我希望清除该字段，但仅在正确时清除，如果不正确，我想保留表单数据。我怎样才能做到这一点？

这是我的 PHP 验证码，所以你可以看到我的尝试。让我知道你是否想要 html...（我也在 POST 之前用 JS 检查了所有条目）

```
<?php
/*set email*/
  $myemail  = "email@email.com";

  /* Check all form inputs using check_input function */
$name = $_POST['name'];
$companyName  = $_POST['companyName'];
$phone    = $_POST['phone'];
$email  = $_POST['email'];
$TimeForContact   = $_POST['TimeForContact'];
$aval = $_POST['aval'];
$messageFromFrom = $_POST['message'];
$firstTime = $_POST['firstTime'];
$subject = "Some Subject";

  require_once('recaptcha-php-1.11/recaptchalib.php');
  $privatekey = "*someprivatekey*"; //I took this out for the question
  $resp = recaptcha_check_answer ($privatekey,
                                $_SERVER["REMOTE_ADDR"],
                                $_POST["recaptcha_challenge_field"],
                                $_POST["recaptcha_response_field"]);

  if (!$resp->is_valid) {
    // What happens when the CAPTCHA was entered incorrectly

echo '<script type="text/javascript"> alert ("You have inserted the wrong phrase in the Captcha box. Please try again! Thank you."); window.history.back();</script>';
          exit();

  } else {

  $message = "some message

End of message
";

/* Send the message using mail() function */
mail($myemail, $subject, $message);

          echo '<script type="text/javascript"> alert ("Success! You have emailed your submission. Please await our response. Thank you."); window.history.back()</script>';

exit();
  }

?> 
```

我最初尝试通过 JS 重新加载页面，例如：

```
window.reload(history.back()); 
```

或者

```
window.location.reload(history.go(-1)); 
```

任何一个+多个类似的组合都没有成功。

所以重申这个问题：
如何在需要时刷新表单/验证码

或者

您提交验证码表单的习惯行为是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:35:04.980

你应该做这样的事情。本质上是检查错误并将错误推送到错误数组中，您可以稍后循环并显示给用户。提交后，您检查recaptcha，如果它无效，它将自动清除该字段。不要使用 alerts 或 exit() 或任何类似的东西，一个简单的 $errors 数组就足够了。

```
//untested code
<?php

//check to make sure they submitted the form
if(isset($_POST['submit'])){

    $errors = array();

    $myemail  = "email@email.com";
    $name = $_POST['name'];
    $companyName  = $_POST['companyName'];
    /* ... */

    //recaptcha check
    require_once('recaptcha-php-1.11/recaptchalib.php');
    $privatekey = "*someprivatekey*";
    $resp = recaptcha_check_answer (
        $privatekey,$_SERVER["REMOTE_ADDR"],
        $_POST["recaptcha_challenge_field"],
        $_POST["recaptcha_response_field"]
    );

    //validate all data here
    if (!$resp->is_valid) {
        array_push($errors, "recaptcha invalid please try again");
    }else if( /* name is invalid */) {
        array_push($errors, "name invalid");
    }else if (){
        /* keep validing ...... with else if*/
    }

    /*....*/

    else{
        //everything validated so were good
        mail($myemail, $subject, $message);  
    }

}

?>

<html>
<head>
    <title></title>
</head>
<body>

    <form action="process.php">
        <!-- Your form here, "process.php" is this page itself -->
        <input name="submit" type="submit" value="Send">
    </form>

</body>
</html> 
```

# java - 参数索引超出范围（2 > 参数个数，即 1）

> ID：15991317
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:26:57.060
> 
> 标签：java, jdbc

```
String query = "insert into dept values(?,'?','?'))";
PreparedStatement pu=con.prepareStatement(query);
pu.setInt(1, 2);
pu.setString(2, "a");
pu.setString(3, "ss");
pu.execute(query); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T18:30:44.977

删除问号周围的引号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:30:54.953

占位符字符周围的单引号导致此错误。删除它们：

```
String query = "insert into dept values(?,?,?))"; 
```

# php - $.ajax 内部加载功能不起作用

> ID：15991321
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:27:04.543
> 
> 标签：php, jquery, ajax

如何在加载函数中序列化此表单数据。它仅序列化单选值。当我单击更改值并点击“保存”按钮时，ajax 仅适用于单选...问题可能是什么？

Javascript

```
$(document).ready(function() {

$("#pard_configure_a").click(function() {

        $("#pard_admin").load('../pard_admin/view/configure.php', function() {

            $(":submit").click(function(event) {
        event.preventDefault();

        var data = $("#pard_site_configuration").serialize();
$("#hhh").html(data);
        $.ajax({

            url: "../controller/configure.controller.php",
            type: "POST",
            data:data,

            success: function(responce) {
                //$("#res").html(responce);

            }
        });

    });

});
});

}); 
```

HTML

```
<div id="pard_configure">
<p>
<form  id="pard_site_configuration" method="post">
 <fieldset>
<legend >Site Configuration</legend>
<!-- Site Settings-->
<div id="pard_site_settings">
<label class="pard_site_settings">Site Settings</label>
<div class="input-prepend">
<span class="add-on">Site Title</span>
<input class="span6" id="prependedInput" type="text" >
</div>
<br/>
<div id="pard_site_offline_radio" class="input-prepend">
<span class="add-on">Site Offline</span>

<label id="radio_1" class="radio">

<span class="add-on">ON</span>

<input type="radio" name="optionsRadios" id="optionsRadios1" value="option1" checked>
</label>
<label id="radio_2" class="radio">
<span class="add-on">OFF</span>
<input type="radio" name="optionsRadios" id="optionsRadios2" value="option2">

</label>
</div>
<div class="input-prepend">
<span class="add-on">Admin Email</span>
<input class="span3" id="prependedInput" type="text" placeholder="example@domain.com">
</div>
<div class="input-prepend">
<span class="add-on">Meta Description</span>
<br/>
<textarea rows="3"></textarea>
</div>
<div class="input-prepend">
<span class="add-on">Meta Keywords</span>
<br/>
<textarea rows="3"></textarea>
</div>
<div class="input-prepend">
<span class="add-on">Copyright</span>
<br/>
<textarea rows="3"></textarea>
</div>
</div><!-- Site Settings end-->
<!-- Database Settings-->
<div id="pard_database_settings">
<label class="pard_database_settings">Database Settings</label>
<div class="input-prepend">
<span class="add-on">Host</span>
<input class="span2" id="prependedInput" type="text" placeholder="localhost">
</div>
<div class="input-prepend">
<span class="add-on">Database Name</span>
<input class="span2" id="prependedInput" type="text" placeholder="database">
</div>
<div class="input-prepend">
<span class="add-on">Database Username</span>
<input class="span2" id="prependedInput" type="text" placeholder="Username">
</div>
<div class="input-prepend">
<span class="add-on">Database Password</span>
<input class="span2" id="prependedInput" type="text" placeholder="Password">
</div>
</div><!-- Database Settings end-->
<div id="pard_admin_form_button">
<input id="pard_site_configuration_submit" class="btn btn-small btn-primary" type="submit" value="Save"/>
<input class="btn btn-small" type="submit" value="Close" /></div>
</fieldset></form>
</p><div id="hhh"></div></div> 
```

在 id="hhh" 中序列化结果

```
optionsRadios=option1 
```

**注意**我将 id="hhh" 设置为查看序列化数据的临时位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:28:14.997

确保在所有表单输入中都有 name 属性：

```
<input name="someName" class="span6" id="prependedInput" type="text" > 
```

您的代码适用于单选按钮，因为它们具有`name`属性。当您使用`.serialize()`时，这会忽略没有名称属性的元素。

# rest - 在 URL 开头使用变量在 AngularJS 中路由

> ID：15991322
> 
> 赞同：0
> 
> 时间：2013-04-13T18:27:11.513
> 
> 标签：rest, web-applications, angularjs, routing, angular-routing

我遇到了一些我无法解释的行为，但我相信其他人可以。我正在像这样设置我的应用程序模块：

```
var appmodule = angular.module('appmodule', ['ui']).config(
['$routeProvider', function($routeProvider) {
    $routeProvider.
      when('/dashboard', {
        templateUrl: 'partials/dashboard.html', 
        controller: dashCtr,
        layer: 'main'
      }).
      when('/:campaignId/edit', {
        templateUrl: 'partials/edit.html',
        controller: campaignCtr,
        layer: 'layer1'
      }).
      when('/:campaignId', {
        templateUrl: 'partials/campaign_info.html',
        controller: campaignCtr,
        layer: 'layer1'
      }).
      when('/inbox', {
        templateUrl: 'partials/inbox.html',
        controller: inboxCtr,
        layer: 'main'
      }).
      otherwise({redirectTo: '/dashboard'});
}]); 
```

当我导航到 app.com/:campaignId 或 app.com/:campaignId/edit 时，一切正常，但如果我尝试 app.com/inbox（或其他任何内容），我会被重定向回 /dashboard。我在其他几个地方读过 URL 不能以变量开头，但我对这个概念很陌生（通常只是前端的设计方面）并且不明白为什么。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:47:35.833

好吧，这仅仅是因为`inbox`路线低于 ''/:campaignId' 路线。Angular 按照定义的顺序检查规则，并且 ''/:campaignId' 规则匹配每个 url，因此没有机会进入 'inbox' 路由。

只需在所有其他路线之后定义“/：campaign”路线，一切都应该正常工作。

# c++ - 在 C++ 中访问构造函数

> ID：15991328
> 
> 赞同：1
> 
> 时间：2013-04-13T18:28:03.817
> 
> 标签：c++, oop, class, constructor

我正在尝试使用类 Node 创建一个 Node 对象：

```
int main(){
    for(int i=0; i< 20; i++)
        Node *handle = new Node(i, 10);
}

class Node{
 public:
    static vector<Node> map;
    static int totalNodes;
    vector<Node> connections;   
    int NodeID;

    Node(int ID, int weight){
    NodeID = ID;
    CreateConnections(weight);
    totalNodes++;
    map.push_back(*this);
} 
```

出于某种原因，我得到

```
'Node' : undeclared identifier
'Node' handle : undeclared identifier
 syntax error : identifier node 
```

下课后将 main() 向下移动给了我

```
unresolved external symbol 
for Node::map and Node::totalNodes 
```

我对 C++ 有点陌生，所以任何提示都将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T18:29:51.777

你必须用 ; 结束你的类定义。

```
 class Node
 {
    //....
    map.push_back(*this);
 };  //^^^Cannot miss ; 
```

同时，您需要将`Node`before声明`main`。

还有一点：

```
 Node(int ID, int weight){
     NodeID = ID;
     CreateConnections(weight);
     totalNodes++;
     map.push_back(*this);
 }//missing closing } on constructor definition 
```

您对`map`and的引用未定义的原因`totalNodes`是：类的静态成员必须在类外部初始化。因此，当您内联构造函数尝试访问它们时，它们没有被定义。所以你有未定义的参考。

您应该执行以下操作：

```
 class Node{
 public:
    static vector<Node> map;
    static int totalNodes;
    vector<Node> connections;   
    int NodeID;
    Node(int ID);
 };

int Node::totalNodes = 0;  //definition of static variables
vector<Node> Node::map;

//^^^define constructor outside class body
Node::Node(int ID){ //your second parameter for ctor not used, so remove it
    NodeID = ID;
    totalNodes++;
    map.push_back(*this);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T18:30:54.127

您`Node`在使用后声明。只需将声明移到 the 之前`main`，您应该会很好：

```
class Node { ... };
int main() { ... } 
```

您还可以对类进行[*前向声明*](http://en.wikipedia.org/wiki/Forward_declaration)（声明没有定义的标识符）：

```
class Node;
int main() { ... }
class Node { ... }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T18:29:44.747

您需要将 Node 声明放在使用它的 main 之前。
仅仅提出声明是不够的，因为 main 中的新节点需要声明节点。
至于未解析的外部，需要定义Node::totalNodes

```
int Node::totalNodes = 0; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T18:31:08.603

你要么需要做一个`Node`类似的前向声明

```
class Node;

int main(){
   for(int i=0; i< 20; i++)
   Node *handle = new Node(i, 10);
}

class Node { }; //impelementation 
```

或放在`main`定义后`class Node`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-13T18:31:25.140

只需在第一行添加以下行：

```
class Node; 
```

# facebook - 使用适用于 iOS 的 Facebook 和 Twitter SDK 注册

> ID：15991329
> 
> 赞同：5
> 
> 时间：2013-04-13T18:28:13.907
> 
> 标签：facebook, ios6, twitter, facebook-ios-sdk

我正在尝试添加 Facebook 和 Twitter 登录并在我的 iOS 应用中注册。由于我的应用程序是基于服务器的，我还需要在我的数据库上创建一个用户配置文件。但问题是我无法从 Facebook 和 Twitter 获取密码，原因很明显。所以我不知道该怎么做。应该将什么用作创建的新配置文件的密码，然后也将用户登录。

人们过去通过从 Facebook 和 Twitter 获取信息来在他们的数据库中创建个人资料做了什么？

我想保存电子邮件地址、姓名、位置、兴趣以及密码。正确的做法应该是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T14:49:27.533

当然，您无法访问该信息。它的工作方式是 Facebook 或 Twitter 向您发送回复说“是的，用户 XXXXXX 的凭据可以”或“不，凭据错误”。然后您可以将用户的 ID 保存到您的数据库中。

除非您请求权限，否则您将永远不会获得任何其他信息。

[https://developers.facebook.com/docs/concepts/login/](https://developers.facebook.com/docs/concepts/login/)

[https://dev.twitter.com/docs/auth/sign-twitter](https://dev.twitter.com/docs/auth/sign-twitter)

要请求权限，您必须创建一个应用程序。

[如何在 facebook 应用程序中请求许可？](https://stackoverflow.com/questions/3006114/how-to-ask-for-permission-in-facebook-application)

# php - PHP文件中的Webvtt

> ID：15991333
> 
> 赞同：0
> 
> 时间：2013-04-13T18:28:29.273
> 
> 标签：php

如何在 php 文件中加载 webvtt？就像是：

```
<?php
header("Content-Type: ???; charset=ISO-8859-1");

WEBVTT

00:00.000 --> 00:01.000
vM7nH0Kl-120.jpg#xywh=0,0,120,50

00:00.000 --> 00:02.000
vM7nH0Kl-120.jpg#xywh=120,0,120,50

00:00.000 --> 00:03.000
vM7nH0Kl-120.jpg#xywh=240,0,120,50

00:00.000 --> 00:04.000
vM7nH0Kl-120.jpg#xywh=360,0,120,50

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:39:38.460

你应该使用`text/vtt`见：[http ://dev.w3.org/html5/webvtt/#the-webvtt-file-format](http://dev.w3.org/html5/webvtt/#the-webvtt-file-format)

```
header("Content-Type:text/vtt;charset=utf-8"); 
```

# google-maps - 为什么此 Google 地图 API v3 无法加载？

> ID：15991334
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:28:31.283
> 
> 标签：google-maps

```
<?php ?>
<!DOCTYPE html>
<html>enter code here
    <head> 
```

那是底部的 Map_canvas 吗？

```
 <style type="text/css">
            html { height: 100% }
            body { height: 100%;    }
            #map_canvas { height: 50% ; width:50%}
        </style> 
```

* * *

```
 <script type="text/javascript"
                src="http://maps.google.com/maps/api/js?sensor=false">
        </script>
        <script type="text/javascript">
            var map;
            var marker2;
            function initialize()
            {
                var athens = new google.maps.LatLng(37.958592, 23.686191);
                var myOptions = {
                    zoom: 12,
                    center: athens,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                map = new google.maps.Map(document.getElementById("map_canvas"),
                myOptions);
                var marker1 = new google.maps.Marker({
                    position: athens,
                    map: map,
                    title: ""
                }); 
```

这是自动完成部分。很可能是这里的错误。//----------------------------自动完成---------- ----

```
 var input = document.getElementById('location');
    var autocomplete = new google.maps.places.Autocomplete(input);
    google.maps.event.addListener(autocomplete, 'place_changed', function() {
      infowindow.close();
      marker.setVisible(false);
      input.className = '';
      var place = autocomplete.getPlace();
      if (!place.geometry) {
        // Inform the user that the place was not found and return.
        input.className = 'notfound';
        return;
      }
      var address = '';
      if (place.address_components) {
        address = [
          (place.address_components[0] && place.address_components[0].short_name || ''),
          (place.address_components[1] && place.address_components[1].short_name || ''),
          (place.address_components[2] && place.address_components[2].short_name || '')
        ].join(' ');
      }
      infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
    });
    setupClickListener('changetype-geocode', ['geocode']);
    // autocomplete results:
  google.maps.event.addDomListener(window, 'load', initialize);
//--------------------------------------------------------------- 
```

这些功能用于标记放置，添加新的和删除以前的标记

```
 function putMarker(Location)
            {
                var newpos = new google.maps.LatLng(Location);
                marker2 = new google.maps.Marker({
                    position: newpos,
                    map: map,
                    title: ""
                });
            }

            function addMarker()

            {
               var Location = document.getElementById("lacation").value;
                var title= document.getElementById("mark").value;

                var newpos = new google.maps.LatLng(Location);

                marker2 = new google.maps.Marker({
                    position: newpos,
                    map: map,
                    title: title
                });

            }

            function removeMarker()
            {
                marker2.setMap(null);
            }

        </script>
    </head> 
```

这是身体

```
 <body onload="initialize()">
        <div id="map_canvas" style="float: left; margin-right: 40px;border: 1px solid black;"></div>
        <div id="Panel"   style="border: 1px solid black;" >
            <table>
                <tr>
                    <td>Location:</td> 
              <td><input type="text" id="location" name="Location search"/></td>
                <tr><br>
                <td> Title:</td> 
                    <td><input type="text" id="mark" name="Title of Marker"/></td>
                </tr><br>
                    <td>What the problem is?:</td> 
                    <td><textarea rows="3" cols="50" name="explaination"></textarea></td>
                </tr><br>
                <td><input type="button" value="Add" id="buttonadd" onclick="addMarker()"/></td>
                <td><input type="button" value="Remove" id="buttonremove" onclick="removeMarker()"/></td>
            </table>
        </div><br><br>
    </body>
</html>** 
```

好吧，地图无法加载（这是主要问题，但“自动完成”也失败了。也许更有经验的眼睛可以看到我看不到的错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:08:59.017

```
The main error was just a miss-type in google lilbrary. and as Dr.Molle noticed a missed bracket in the initialize();
anyway i've fixed this and i've added an array that counts and naming the markers  

  <!----------------------------------Google Scripts Library--------------------->

            <script type="text/javascript"src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>

            <!---------------------------------END of Google Scripts Library--------------------->
            <script type="text/javascript">
                var map;
                var marker2;
                var Location;
                var myOptions;
                var marker1;
                var input;

                 var posa=-1; 
                var markers=new Array();
                function initialize()
                {
                    var athens = new google.maps.LatLng(37.958592, 23.686191);

                     myOptions = {
                        zoom: 12,
                        center: athens,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };

                    map = new google.maps.Map(document.getElementById("map_canvas"),
                    myOptions);

                        marker1 = new google.maps.Marker({
                        position: athens,
                        map: map,
                        title: ""
                    });

                    //-------------------------Autocomplete--------------------------

               var input = document.getElementById('search');
          var autocomplete = new google.maps.places.Autocomplete(input);

          autocomplete.bindTo('bounds', map);

          var infowindow = new google.maps.InfoWindow();

          google.maps.event.addListener(autocomplete, 'place_changed', function() {

              posa++;
                var place = autocomplete.getPlace();  
                markers.push( new google.maps.Marker({
            map: map,
            title: 'a name (probably the user's name.)'+place.name
          })); 

            alert (posa); 
            infowindow.close();

            if (place.geometry.viewport) {
              map.fitBounds(place.geometry.viewport);
            } else {
              map.setCenter(place.geometry.location);
              map.setZoom(17);  // Why 17? Because it looks good.
            }
        //alert(autocomplete.getBounds());

            markers[posa].setPosition(place.geometry.location);

            var address = '';
            if (place.address_components) {
              address = [
                (place.address_components[0] &&
                 place.address_components[0].short_name || ''),
                (place.address_components[1] &&
                 place.address_components[1].short_name || ''),
                (place.address_components[2] &&
                 place.address_components[2].short_name || '')].join(' ');
            }

            infowindow.setContent('<div><b>' + place.name + '</b><br>' + address);
            infowindow.open(map, markers[posa] );
          });

       //--------------------------------END of Autocomplete--------------------------------
                    google.maps.event.addDomListener(window, 'load', initialize);

                }   //<------------- need to be the last bracket?
                    // END of initialize Function

                function putMarker(Location)
                {
                    var newpos = new google.maps.LatLng(Location);
                    marker2 = new google.maps.Marker({
                        position: newpos,
                        map: map,
                        title: "",
                        draggable:true
                    });
                }

                function addMarker()

                {
                    Location = document.getElementById("search").value;
                    var title= document.getElementById("mymark").value;

                    var newpos = new google.maps.LatLng(Location);

                    marker2 = new google.maps.Marker({
                        position: newpos,
                        map: map,
                        title: title
                    });

                }

                function removeMarker()
                {
                    marker2.setMap(null);

                }

    function listmarkers()
    {
       var x=""
       alert(posa)
       for ( i=0;i<=posa;i++)
       x=x+markers[i].title+"<br>"
            document.getElementById("markerlist").innerHTML=x
    }

            </script> 
```

这是身体：

```
<body onload="initialize();">

    <div id="map_canvas" style="float: left; margin-right: 40px;border: 1px solid black;"></div>

    <div id="Panel"   style="border: 1px solid black;" >

        <table>
            <tr>
                <td>Location:</td> 
                <td><input id="search" type="text" size="50" placeholder="Enter a location" autocomplete="on"></td>
            <tr><br>
            <td> Title:</td> 
            <td><input type="text" id="mymark" name="Title of Marker" placeholder="Give a title"/></td>
            </tr><br>
            <td>Comments:</td> 
            <td><textarea rows="3" cols="50" name="explaination" placeholder="Briefly explain what the problem is"></textarea></td>
            </tr><br>
            <td><input type="button" value="Add" id="buttonadd" onclick="addMarker();"/></td>
            <td><input type="button" value="Remove" id="buttonremove" onclick="removeMarker();"/></td> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-14T10:12:06.120

```
here is the whole script:

 <script type="text/javascript"
                src="http://maps.google.com/maps/api/js?sensor=false">
        </script>
        <script type="text/javascript">
            var map;
            var marker2;

            function initialize()
            {
                var athens = new google.maps.LatLng(37.958592, 23.686191);

                var myOptions = {
                    zoom: 12,
                    center: athens,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };

                map = new google.maps.Map(document.getElementById("map_canvas"),
                myOptions);

                var marker1 = new google.maps.Marker({
                    position: athens,
                    map: map,
                    title: ""
                });

//-------------------------Autocomplete--------------------------

             var input = document.getElementById('location');
    var autocomplete = new google.maps.places.Autocomplete(input, myOptions );

    google.maps.event.addListener(autocomplete, 'place_changed', function() {
      infowindow.close();
      marker.setVisible(false);
      input.className = '';
      var place = autocomplete.getPlace();
      if (!place.geometry) {
        // Inform the user that the place was not found and return.
        input.className = 'notfound';
        return;
      }

      var address = '';
      if (place.address_components) {
        address = [
          (place.address_components[0] && place.address_components[0].short_name || ''),
          (place.address_components[1] && place.address_components[1].short_name || ''),
          (place.address_components[2] && place.address_components[2].short_name || '')
        ].join(' ');
      }

      infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);

    });

    // autocomplete results:
  google.maps.event.addDomListener(window, 'load', initialize);
//---------------------------------------------------------------

            function putMarker(Location)
            {
                var newpos = new google.maps.LatLng(Location);
                marker2 = new google.maps.Marker({
                    position: newpos,
                    map: map,
                    title: ""
                });
            }

            function addMarker()

            {
               var Location = document.getElementById("lacation").value;
                var title= document.getElementById("mark").value;

                var newpos = new google.maps.LatLng(Location);

                marker2 = new google.maps.Marker({
                    position: newpos,
                    map: map,
                    title: title
                });

            }

            function removeMarker()
            {
                marker2.setMap(null);

            }

        </script> 
```

# c# - 意外的 GC 行为

> ID：15991336
> 
> 赞同：0
> 
> 时间：2013-04-13T18:28:40.523
> 
> 标签：c#, memory-leaks, garbage-collection, windows-phone-8, bytearray

在处理大字节数组时，我在 WP8 模拟器上看到了一些奇怪的 GC 行为，即内存没有被释放，也没有被重用。

示例：我的应用程序的内存使用基线约为 17MB。如果我再分配一个 50MB 字节数组，内存使用量将如预期的那样增加到 67MB。我将字节数组重新初始化为零大小并调用 GC.Collect() 这不会减少总内存使用量。这是预期的；内存不会释放回 Windows，只是标记为可重用。如果然后我将字节数组重新初始化为相同的大小，50MB，我希望内存被重用并且总内存使用量不会增加。正确的？错误的。内存未重用，现在总内存使用量为 117 MB。请参阅下面的示例代码..

谁能解释一下？由于我分配的字节数完全相同，因此问题不应该源于 LOH 碎片，对吧？

```
 // memory usage = 17MB
    var tb = new byte[1024*1024*50];
    // memory usage = 67MB
    tb = new byte[0];
    GC.Collect();
    // memory usage = 67MB
    tb = null;
    GC.Collect();
    // memory usage = 67MB
    tb = new byte[1024*1024*50];
    // memory usage = 117MB
    GC.Collect();
    // memory usage = 117MB; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:58:38.337

我用一个按钮尝试了这个来重复分配，第一次点击或多或少像你描述的那样，但之后内存使用是平的。

因此，您的观察很可能会受到启动问题以及后台发生的分配的干扰。

从更广泛的角度来看，GC 的行为符合预期。

# php - 如何在 file_get_contents 期间解析 HTML 中的变量

> ID：15991340
> 
> 赞同：0
> 
> 时间：2013-04-13T18:29:12.703
> 
> 标签：php, html, parsing, php-parser

我正在构建一个 CMS，作为其中的一部分，任何静态 HTML 都被拆分为可重用的块，然后保存在一个中心位置。当我们需要每个块时，我们可以使用 file_get_contents 将其添加到包含页面 HTML 代码的字符串中。

作为 CMS，HTML 的某些部分需要从数据库中加载数据。现在我可以简单地放置占位符，例如 %cmsarea0%、%cmsarea1%、%cmsarea2% 等，然后使用 str_replace 将数据库中的 HTML 放入其中。但这对我来说似乎不是最好的方法。

理想情况下，我的页面类中有几个预定义的变量，然后在 HTML 文件中让 PHP 在加载了 file_get_contents 时回显该变量，但是似乎没有多少测试有效。我正在加载的 .html 文件中的 PHP 代码被注释掉了。

我知道这种事情是可能的，因为 PHPBB 使用类似的东西，他们将变量包装在大括号中，然后以某种方式解析。但是我该如何实现呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:37:31.750

我不明白你为什么不想使用`str_replace()`，这对我来说似乎是完美的补救措施。

尝试以下

**HTML** - myURL.php

```
<html>
    <body>
        <div id="myDiv1">%cmsarea1%</div>
        <div id="myDiv2">%cmsarea2%</div>
        <div id="myDiv3">%cmsarea3%</div>
    </body>
</html> 
```

**PHP** - HTMLparse.php

```
$theContent = file_get_contents("myURL.php");

$var1 = $theContent.str_replace("%cmsarea1%", "My first variable");
$var2 = $theContent.str_replace("%cmsarea2%", "My second variable");
$var3 = $theContent.str_replace("%cmsarea3%", "My third variable"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:43:10.303

你全错了。在 PHP 中不应使用 file_get_contents 添加 HTML 文件，而应使用 include。这样，HTML 页面中的任何 PHP 代码都将被执行（前提是它包含在标签中）。请记住，包含的 HTML“部分”应具有 .php 扩展名，以便执行其中包含的 PHP 脚本。这是 PHP-HTML 模板的基础知识。

在网上搜索“php 模板网站”并学习。这是我得到的第一个结果，非常有用：[http ://www.1stwebdesigner.com/css/how-to-create-php-website-template/](http://www.1stwebdesigner.com/css/how-to-create-php-website-template/)

# r - R中的plot.qual函数：文本太大

> ID：15991351
> 
> 赞同：1
> 
> 时间：2013-04-13T18:30:08.397
> 
> 标签：r

我正在尝试在 R 中制作“斜率图”可视化，类似于在此博客文章中找到的可视化：

[http://www.r-bloggers.com/a-nifty-line-plot-to-visualize-multivariate-time-series/](http://www.r-bloggers.com/a-nifty-line-plot-to-visualize-multivariate-time-series/)

我正在取消大师赛第 1,2 和第 3 轮的高尔夫成绩，并以与博客文章中相同的格式排列了 93 名高尔夫球手的姓名。**注意：高尔夫球手被逐轮淘汰，所以我生成了一些假分数只是为了保持数据集没有差距（稍后会回到这个问题）。**

我正在使用 plot.qual 函数，其代码可以在 git 上找到： [https ://gist.github.com/fawda123/5281518/raw/a7194a748cda5a8d2ea83f87e4a59496ee5e0953/plot_qual.r](https://gist.github.com/fawda123/5281518/raw/a7194a748cda5a8d2ea83f87e4a59496ee5e0953/plot_qual.r)

**注意：由于某种原因，我无法使用 paste0 函数，所以我将代码更改为 paste(...,sep=" ",...)。不确定这是否导致问题。**

我已将数据存储在 Masters.2013 中。数据的格式与博客文章相同，尽管列数 (93) 多于博客文章使用的列数 (25)。

当我运行 plot.qual(Masters.2013) 时，我收到以下错误消息：

**> plot.qual(Masters.2013) 警告信息：在 plot.qual(Masters.2013) 中：列之间的行空间不足**

我将列数减少到 25、5、2 等（plot.qual(Masters.2013[,1:5])，但每次都会出现错误消息。

情节看起来很拥挤，没有台词（会发布图像但没有足够的声誉）

我认为问题不在于数据，因为格式与博客文章相同，并且似乎几乎可以正常工作。

# plot.qual 代码如下

# 编辑：添加一些示例数据（如下），感谢评论的人。另外-当添加 par(cex=.5) 时，它会产生更好的结果，但是我想知道文本是否可以自动调整大小，以便连接线始终与文本的边缘相交。

```
Data=structure(list(PLAYER = structure(1:3, .Label = c("Round 1", 
"Round 2", "Round 3"), class = "factor"), Marc.Leishman = c(66L, 
66L, 69L), Fred.Couples = c(68L, 71L, 73L), Jim.Furyk = c(69L, 
69L, 70L), Tiger.Woods = c(70L, 70L, 71L), Angel.Cabrera = c(71L, 
69L, 68L), John.Senden = c(72L, 72L, 67L), Adam.Scott = c(69L, 
72L, 78L), Jason.Dufner = c(72L, 69L, 64L), David.Lynn = c(68L, 
73L, 71L), Lee.Westwood = c(70L, 70L, 80L), Justin.Rose = c(70L, 
70L, 70L), K.J..Choi = c(70L, 70L, 74L), Rickie.Fowler = c(68L, 
68L, 76L), Jason.Day = c(70L, 70L, 73L)), .Names = c("PLAYER", 
"Marc.Leishman", "Fred.Couples", "Jim.Furyk", "Tiger.Woods", 
"Angel.Cabrera", "John.Senden", "Adam.Scott", "Jason.Dufner", 
"David.Lynn", "Lee.Westwood", "Justin.Rose", "K.J..Choi", "Rickie.Fowler", 
"Jason.Day"), row.names = c(NA, 3L), class = "data.frame")

   plot.qual<-function(x,x.locs=c(0.01,0.99),y.locs=c(0,1),steps=NULL,sp.names=NULL,dt.tx=T,rsc=T,
                ln.st=NULL,rs.ln=c(3,15),ln.cl='RdYlGn',alpha=0.7,leg=T,...){

require(RColorBrewer)
require(scales)

if(length(x.locs) != 2 | length(y.locs) != 2) 
stop('x and y dimensions must be two-element vectors')

if(x.locs[1]<0 | x.locs[2]>1 | y.locs[1]<0 | y.locs[2]>1) 
stop('x and y dimensions must in range of 0--1')

dim.x<-c(0,1) #plot dims x
dim.y<-c(0,1) #plot dims y
wrn.val<-F

x[,1]<-as.character(x[,1]) 
tot.sp<-ncol(x)-1
sp.col<-2:ncol(x)

#rescale if T, sort legend for later
sp.orig<-x[,sp.col]
if(length(rs.ln)==1) rsc<-F
if(rsc) x[,sp.col]<-rescale(x[,sp.col],rs.ln)
if(rsc==F & leg) leg<-F #no legend if line widths aren't rescaled

#reorder species columns, add rank as integer
first.ord<-order(x[1,sp.col],decreasing=T)
x[,sp.col]<-x[,sp.col][,first.ord]
names(x)[sp.col]<-names(x)[sp.col][first.ord]

names(x)[sp.col]<-paste(1:tot.sp,sep=" ",names(x)[sp.col])

#list of spp by date, arranged in decreasing order for each date
dt.dat.srt<-vector('list',nrow(x))
names(dt.dat.srt)<-x[,1]
for(val in 1:nrow(x)){
tmp<-t(x[val,sp.col])
tmp<-tmp[order(tmp,decreasing=T),,drop=F]
dt.dat.srt[[val]]<-tmp
}

#initiate plot object
plot(dim.x,dim.y,type='n',axes=F,xlab='',ylab='',...) 

#subset for steps, if provided
if(!is.null(steps)) dt.dat.srt<-dt.dat.srt[names(dt.dat.srt) %in% steps]

#plot legend
if(leg){
y.locs[1]<-0.05*diff(y.locs)+y.locs[1]
leg.txt<-format(round(seq(min(sp.orig),max(sp.orig),length=5),2),nsmall=2,digits=2)
leg.wds<-seq(rs.ln[1],rs.ln[2],length=5)
legend('bottom',(y.locs[1]-    y.olds)/2,col=alpha('black',alpha),lwd=leg.wds,legend=leg.txt,bty='n',
       horiz=T)
}  

#x locations
x.vals<-rep(seq(x.locs[1],x.locs[2],length=length(dt.dat.srt)),each=tot.sp)
x.vals<-split(x.vals,x.vals)

#y locations, rearranged in loop, exception if dates are plotted
if(dt.tx) y.vals<-rev(seq(y.locs[1],y.locs[2],length=tot.sp+1))[-1]
else y.vals<-rev(seq(y.locs[1],y.locs[2],length=tot.sp))

#get line colors
if(length(ln.cl)==1)
if(ln.cl %in% row.names(brewer.pal.info)){
  pal.num<-brewer.pal.info[row.names(brewer.pal.info) == ln.cl,1]
  ln.cl<-brewer.pal(pal.num,ln.cl)
}
line.cols<-alpha(colorRampPalette(ln.cl)(tot.sp),alpha)

#define distance of lines from labels
if(is.null(ln.st)){
str.max<-max(strwidth(row.names(dt.dat.srt[[1]])))
if(diff(x.locs)-length(dt.dat.srt)*str.max < 0){
  warning('not enough space for lines between columns')
  wrn.val<-T
}
else
  ln.st<-0.2*str.max + str.max/2
}

for(val in 1:(length(dt.dat.srt)-1)){

#temp data to plot
plt.tmp<-dt.dat.srt[c(val,val+1)]
x.tmp<-x.vals[c(val,val+1)]

#plot temp text for column 
text(x.tmp[[1]],y.vals,row.names(plt.tmp[[1]]))

if(val == length(dt.dat.srt)-1){
  text(x.tmp[[2]],y.vals,row.names(plt.tmp[[2]]))
  if(dt.tx){
    dt.txt<-substitute(italic(x),list(x=names(plt.tmp)[2]))
    text(unique(x.tmp[[2]]),y.locs[2],dt.txt)
  }
}   

if(dt.tx){
  dt.txt<-substitute(italic(x),list(x=names(plt.tmp)[1]))
  text(unique(x.tmp[[1]]),y.locs[2],dt.txt)
}

srt.ln.y<-match(row.names(plt.tmp[[1]]),row.names(plt.tmp[[2]]))

#if no line rescale, use first element of rs.ln
if(rsc) lwd.val<-plt.tmp[[1]][,1]
else lwd.val<-rep(rs.ln[1],tot.sp)

#vector for species selection of line segments
if(is.null(sp.names)) sel.sp<-rep(T,tot.sp)
else{
  sel.names<-unlist(lapply(strsplit(row.names(plt.tmp[[1]]),' '),function(x) x[2]))
  sel.sp<-(sel.names %in% sp.names)
}

#for lines
if(!wrn.val)
  segments(
    x.tmp[[1]][sel.sp]+ln.st,
    y.vals[sel.sp],
    x.tmp[[2]][sel.sp]-ln.st,
    y.vals[srt.ln.y][sel.sp],
    col=line.cols[sel.sp],
    lwd=lwd.val[sel.sp]
  )

#resort color vector for next colummn
srt.cl.y<-match(row.names(plt.tmp[[2]]),row.names(plt.tmp[[1]]))
line.cols<-line.cols[srt.cl.y]

}

}

par(mar=c(1,1,1,1),family='serif',cex=.5)
plot.qual(Data) 
```

# java - 如何清除 ArrayList？

> ID：15991352
> 
> 赞同：12
> 
> 时间：2013-04-13T18:30:22.680
> 
> 标签：java, android, arraylist

我有以下代码`ThisClass`：

```
static ArrayList<MyClass> classlist; 
```

如果我打电话：

```
ThisClass.classlist = new ArrayList<MyClass>();
ThisClass.classlist.add(object); 
```

然后再次调用此行：

```
ThisClass.classlist = new ArrayList<MyClass>(); 
```

它会重置`ThisClass.classlist`列表，即类列表列表将不再包含对象吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-13T18:50:43.927

这是一个插图：

## 代码 1：创建 ArrayList 并添加对象

```
ThisClass.classlist = new ArrayList<MyClass>();
ThisClass.classlist.add(object); 
```

结果如下：

![在此处输入图像描述](https://i.stack.imgur.com/z7f4p.png)

## 代码 2：通过重新初始化进行重置

```
ThisClass.classlist = new ArrayList<MyClass>(); 
```

结果 - 您通过使其指向一个新对象来重置它：

![在此处输入图像描述](https://i.stack.imgur.com/qkCrk.png)

## 代码 3：通过清除对象进行重置

要使它“不再包含对象”，您应该做的是：

```
ThisClass.classlist.clear(); 
```

Clear 循环遍历所有元素并使它们为*null*。在内部，ArrayList 也指向其对象的内存地址，但为简单起见，请认为当您调用此方法时它们正在被“删除”。

![在此处输入图像描述](https://i.stack.imgur.com/BXuqK.png)

## 代码 4：重置整个班级列表

如果你想让它“不再包含 ArrayList”，你可以这样做：

```
ThisClass.classlist = null; 
```

这意味着：

![在此处输入图像描述](https://i.stack.imgur.com/07k9z.png)

另外，请注意您的问题标题提到了“静态 ArrayList”。`static`在这种情况下并不重要。无论对象是否是静态的，您的问题的结果都是相同的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-13T18:49:33.977

打电话

```
ThisClass.classlist = new ArrayList<MyClass>(); 
```

**将**清除`ThisClass.classlist`数组（实际上，将创建一个新数组`ArrayList`并将其放置在旧数组的位置）。

## 话虽这么说，使用起来要好得多：

```
ThisClass.classlist.clear(); 
```

这是一种更清晰的方法：在代码中显示您的真实意图，表明您真正想要完成的工作，从而使您的代码更具可读性/可维护性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T18:32:40.143

正确的。

从技术上讲，您并不*清楚*这样`ArrayList`做，您实际上实例化了一个新的 empty `ArrayList`。

# django - 更新父对象时删除子对象

> ID：15991353
> 
> 赞同：0
> 
> 时间：2013-04-13T18:30:23.880
> 
> 标签：django, django-admin

我正在开发一个 Django 项目，管理员可以通过上传 CSV 文件将价目表添加到合同中（合同是父对象，价目表是子对象）

当新的价目表到达时，我希望管理界面删除所有旧的子对象并创建新的。

我已经尝试过原始 sql 和 delete() 选项，但是我无法更新父级 -> 删除所有子级 -> 创建新的子级对象。

# python - Django 模型。在多个模型类和管理员中关联元组

> ID：15991354
> 
> 赞同：2
> 
> 时间：2013-04-13T18:30:29.130
> 
> 标签：python, django, django-models

关于在模型中关联数据的新手 Django 问题。

我有三个表，CarMake、CarModel 和 Driver。

CarMake 有几个汽车品牌。

CarModel 有每个品牌的几个模型。

*   我的第一个问题是如何在 models.py 类中关联每个汽车品牌的多个汽车型号？

*   其次，在管理页面（最终通过视图）中，我如何将这些汽车制造商和汽车型号与驾驶员相关联。所以在 Admin 中，如果我创建一个新的 Driver，我选择 driver_name，然后从下拉列表中选择 car_make，然后根据我选择的 Make，从汽车型号的下拉列表中选择。

    例如在管理员中：

    ```
     driver name =    "john" 

      driver car = -> Toyota    -> Avalon 
    ```

*   第三，我如何为驾驶员选择多个汽车品牌和每个品牌的多个车型。因此，如果驾驶员选择大众汽车模型​​车，他们可以从下拉列表中选择“高尔夫”和“帕萨特”作为他们的汽车。

这是我正在考虑的一些基本代码：

```
from django.db import models

class CarMake(models.Model):
    MAKE = (
        ('Ford'),
        (''Toyota'),
        ('Volkswagon'),
    )

    car_make = models.CharField(choice=MAKE)

class CarModel(models.Model):
    MODEL = (
        ('Ford'
            ('Focus'),
            ('Explorer'),
            ('F150'),
        )
        ('Toyota'
            ('Avalon'),
            ('Highlander'),
            ('Tundra'),
        )
        ('Volkswagon'
            ('Golf'),
            ('Jetta'),
            ('Passat'),
        )
    )

    car_model = models.CharField(choice=MODEL)

class Driver(models.Model):
    driver_name = models.CharField(max_length=120)
    driver_car = '''choose make and model''' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:32:05.383

查看[Django 模型文档](https://docs.djangoproject.com/en/dev/topics/db/models/)以了解如何创建您的`models.py`. 我看到了你在这个文件中得到的确切想法，但你正在结合两件事。

`models.py`应该包含*实体以及它们是如何连接的，* ***而不是*** *实体和这些实体的可能实例*。`models.py`定义数据库结构**而不是**其内容 - 这一点很重要。

作为一些指针：

*   `CarModel`应该有一个`ForeignKey`表`CarMake`。这将定义汽车与制造者之间的关系。然后你需要定义另一个字段来保存那辆车的模型。我不确定如何强制仅从某个制造商处选择汽车（但这本身就是一个问题）-也许这应该在前端逻辑中？
*   `Driver`还应该有一个`ForeignKey`of`CarModel`来定义这个司机开什么车。**注意**一个司机可以开多少辆车？您需要决定他们是否只能驾驶一辆，或者他们是否可以驾驶很多辆。

在继续之前仔细阅读文档，它对您的帮助比其他任何事情都大，并且始终是最好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T23:49:04.737

From what you have described, it sounds like you want a one to many relationship between CarMake and CarModel. e.g. One CarMake can have multiple CarModels, but one CarModel *can not* have multiple CarMakes. Here is some code to get you started:

```
# In app/models.py
class CarMake(models.Model):
    name = models.CarField(max_length=30)

class Car(models.Model):
    model = models.CarField(max_length=30)
    make = models.ForeignKey(CarMake)

class Driver(models.Model):
    driver_name = models.CharField(max_length=120)
    car = models.ForeignKey(Car) 
```

**Creating Make Models**

```
make = CarMake(name='Toyota')
make.save()

car = Car(make=make, model='Avalon')
car.save() 
```

**Registering in Admin**

```
# in app/admin.py
from django.contrib import admin
from app.models import CarMake, CarModel, Driver

admin.site.register(CarMake)
admin.site.register(CarModel)
admin.site.register(Driver) 
```

# android - 单击按钮时如何显示新屏幕？

> ID：15991355
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:30:30.360
> 
> 标签：android

我正在编写我的第一个 android 应用程序，我想在单击按钮时在新屏幕上显示结果。我搜索了一下，发现我需要多个活动或布局。但是我仍然不明白我应该做什么（我之前没有使用Android开发过）。我想在单击按钮时显示一个全新的屏幕，我该怎么办？

我希望是否有人能说出明确的步骤。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T19:14:56.230

使用 Intent 在两个 Activity 之间切换。

```
Intent inn1=getIntent();
inn1=new Intent(HomeActivity.this,SecondActivity.class);
startActivity(inn1); 
```

首先在android中创建一个Simple Activity，在main.xml中添加一个**Button 。**`findViewById`然后使用方法找到按钮的id 。然后为代码添加**OnClick**方法，并将意图代码放入 Onclick 方法中。并且不要忘记在**清单**文件中输入类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T20:02:32.477

只需确保将其与 .xml 布局相关联

```
//Add the variable to avoid any errors
Button goToAnotherClass;

goToAnotherClass = (Button) findViewById(R.id.anotherclassbutton); //find the button by its assigned id

//Make the button do something:
goToAnotherClass.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent myIntent = new Intent(CurrentClass.this,
                    TheClassIWantToGoTo.class);
            startActivity(myIntent);

        }
    }); 
```

如果您仍在苦苦挣扎，请观看[此视频。](http://thenewboston.org/watch.php?cat=6&number=9)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T18:36:53.623

在这里您可以找到如何实现这一目标的信息以及更多信息：[编写您的第一个应用程序 - 开始另一个活动](http://developer.android.com/training/basics/firstapp/starting-activity.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T18:34:17.660

听起来您需要查看 Android [Activity](http://developer.android.com/reference/android/app/Activity.html)类。您所要求的众多实现之一是为您的应用程序的每个屏幕使用一个活动。

这就是您开始新活动的方式（取自[此处](http://developer.android.com/training/basics/firstapp/starting-activity.html)）。

```
/** Called when the user clicks the Send button */
public void sendMessage(View view) {
    Intent intent = new Intent(this, DisplayMessageActivity.class);
    EditText editText = (EditText) findViewById(R.id.edit_message);
    String message = editText.getText().toString();
    intent.putExtra(EXTRA_MESSAGE, message);
    startActivity(intent);
} 
```

# javascript - jQuery滚动到页面部分

> ID：15991356
> 
> 赞同：19
> 
> 时间：2013-04-13T18:30:35.813
> 
> 标签：javascript, jquery, ruby-on-rails

我正在尝试建立一个新的时尚单页网站，在该网站上滚动到页面上的某个部分。我想将“固定”标题带到内容所在的确切位置。我正在使用 Zurb 基金会。这是我到目前为止所拥有的（这里找到的一些代码）：

```
 <li><%= link_to "Recent Work", "#", "data-scroll" => "recent" %></li>

  $(document).ready(function() {
$("a[data-scroll]").click(function() {
   var id = $(this).data("scroll")
    $('html,body').animate({
            scrollTop: $("#"+id).offset().top},
        'slow');
});
 });

  <div id="recent">some content</div> 
```

我遇到的问题如上所述。我想把我的固定标题带到这个 div 在页面上的确切位置。请指教。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-13T18:32:39.920

[有一个插件。](https://github.com/flesler/jquery.scrollTo)

[或者只是自己动手。](https://stackoverflow.com/questions/6677035/jquery-scroll-to-element)

如果您需要抵消“自己动手”的解决方案，请尝试以下操作：

```
$("#button").click(function() {
    var offset = 20; //Offset of 20px

    $('html, body').animate({
        scrollTop: $("#elementtoScrollToID").offset().top + offset
    }, 2000);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-02T06:01:58.420

自提出和回答这个问题以来已有 5 年多的时间，情况发生了一些变化。大多数人现在可能会使用 Angular 或 React 之类的 Javascript 框架，但对于那些不使用的人（像我自己，从事一些较旧的遗留项目），我已经对[grainlarceny 的答案](https://stackoverflow.com/a/15991388/5358731)进行了一些修改。

此解决方案允许在任何元素上滚动，而不仅仅是在正文上，并考虑到已经在元素上进行的任何滚动。

```
$("#button").click(function() {

    // Find the element that you are scrolling (commonly body, but doesn't need to be!)
    var scrollingElement = $('#scrollingElement');

    // Find the element that you want to scroll to.
    var targetElement = $("#targetElement");

    // Stop any current animations (prevents a backlog of scroll animations for trigger-happy end-users)
    scrollingElement.stop();

    // Define the scrolling animation...
    scrollingElement.animate({
            scrollTop:
                // The distance in pixels from the top of the page to the top of the target element.
                targetElement.offset().top

                // The distance in pixels from the top of the page to the top of the scrolling element.
                - scrollingElement.offset().top

                // So far, the above two offsets determine how far down the scrolling element the target actually is...

                // The distance in pixels the scrolling element has ALREADY been scrolled.
                + scrollingElement.scrollTop()

                // SUCCESS! This will now take us to the target element.

                // OPTIONAL PART - SCROLLING OFFSET (for prettiness :])
                // This will change based on how you set up your page. Here are some examples...

                // To allow for a margin above your target...
                - parseFloat(targetElement.css("margin-top"))

                // To allow for padding from a parent element (in this case the scrolling element)...
                - parseFloat(scrollingElement.css("padding-top"))

                // If all else fails, you can always specify your own amount (in pixels)...
                - 20
        },
        200); // Duration in milliseconds of the scroll animation
}); 
```

# 现场示例

```
var listItem = $("li")

listItem.on("click", function() {
  var scrollingElement = $('#scrollingElement');
  var targetElement = $(this.dataset.link);

  scrollingElement.stop();
  scrollingElement.animate({
    scrollTop: targetElement.offset().top -
      scrollingElement.offset().top +
      scrollingElement.scrollTop() -
      parseFloat(targetElement.css("margin-top"))
  }, 200);
})
```

```
html,
body {
  background: #FFF;
  height: 100%;
  margin: 0;
}

li {
  cursor: pointer;
  list-style: none;
  margin: 10px;
}

li:hover {
  color: blue;
}

#links {
  border: solid 1px black;
  float: left;
  height: 90%;
  margin: 3%;
  width: 20%;
}

#scrollingElement {
  border: solid 1px black;
  float: left;
  height: 90%;
  margin: 3%;
  overflow: auto;
  width: 60%;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<html>

<body>
  <div id="links">
    <ul>
      <li data-link="#head1">Heading 1</li>
      <li data-link="#head2">Heading 2</li>
      <li data-link="#head3">Heading 3</li>
      <li data-link="#head4">Heading 4</li>
      <li data-link="#head5">Heading 5</li>
    </ul>
  </div>
  <div id="scrollingElement">
    <h1 id="head1">Heading 1</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed justo interdum, tincidunt felis a, condimentum est. Donec pulvinar tincidunt orci, vitae aliquet diam luctus sit amet. Class aptent taciti sociosqu ad litora torquent per conubia nostra,
      per inceptos himenaeos. Praesent varius cursus lorem, ultrices porta erat vehicula sed. Donec blandit venenatis laoreet. Morbi venenatis hendrerit suscipit. Pellentesque justo velit, ultricies id orci et, viverra fermentum nibh. Nulla vitae interdum
      tellus. Duis bibendum maximus mauris ac condimentum. Phasellus convallis ligula ligula, sed tempor quam varius ac. Etiam dignissim arcu sed nibh facilisis, eu rutrum elit pharetra. Suspendisse dignissim commodo eros, rutrum volutpat orci mollis
      quis. Donec vulputate, tortor eget viverra sodales, ex libero euismod sapien, dignissim interdum neque urna non orci. Fusce eget ex iaculis, aliquam tortor sit amet, congue velit. Curabitur eget pretium odio. Phasellus dapibus, sapien ut tempor
      dapibus, mauris felis venenatis magna, in posuere metus nulla in justo. Nam accumsan finibus libero ut gravida. Duis orci dolor, vulputate ut quam sit amet, egestas porttitor diam. Pellentesque habitant morbi tristique senectus et netus et malesuada
      fames ac turpis egestas. Proin ultricies sapien eu dignissim lacinia. Donec ut porta metus. Pellentesque ultrices gravida auctor. Quisque nulla risus, ornare eu molestie at, dapibus vitae tortor. Nullam consequat libero in libero sollicitudin, in
      luctus ante semper. In hac habitasse platea dictumst. Sed ultricies mattis ex, ac feugiat diam pharetra vitae. Vestibulum malesuada pulvinar sem vitae commodo. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.
      Cras porta gravida mollis. Aliquam mollis mi ac nisl fermentum elementum. Morbi vestibulum efficitur dolor ut consectetur.
    </p>
    <h1 id="head2">Heading 2</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed justo interdum, tincidunt felis a, condimentum est. Donec pulvinar tincidunt orci, vitae aliquet diam luctus sit amet. Class aptent taciti sociosqu ad litora torquent per conubia nostra,
      per inceptos himenaeos. Praesent varius cursus lorem, ultrices porta erat vehicula sed. Donec blandit venenatis laoreet. Morbi venenatis hendrerit suscipit. Pellentesque justo velit, ultricies id orci et, viverra fermentum nibh. Nulla vitae interdum
      tellus. Duis bibendum maximus mauris ac condimentum. Phasellus convallis ligula ligula, sed tempor quam varius ac. Etiam dignissim arcu sed nibh facilisis, eu rutrum elit pharetra. Suspendisse dignissim commodo eros, rutrum volutpat orci mollis
      quis. Donec vulputate, tortor eget viverra sodales, ex libero euismod sapien, dignissim interdum neque urna non orci. Fusce eget ex iaculis, aliquam tortor sit amet, congue velit. Curabitur eget pretium odio. Phasellus dapibus, sapien ut tempor
      dapibus, mauris felis venenatis magna, in posuere metus nulla in justo. Nam accumsan finibus libero ut gravida. Duis orci dolor, vulputate ut quam sit amet, egestas porttitor diam. Pellentesque habitant morbi tristique senectus et netus et malesuada
      fames ac turpis egestas. Proin ultricies sapien eu dignissim lacinia. Donec ut porta metus. Pellentesque ultrices gravida auctor. Quisque nulla risus, ornare eu molestie at, dapibus vitae tortor. Nullam consequat libero in libero sollicitudin, in
      luctus ante semper. In hac habitasse platea dictumst. Sed ultricies mattis ex, ac feugiat diam pharetra vitae. Vestibulum malesuada pulvinar sem vitae commodo. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.
      Cras porta gravida mollis. Aliquam mollis mi ac nisl fermentum elementum. Morbi vestibulum efficitur dolor ut consectetur.
    </p>
    <h1 id="head3">Heading 3</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed justo interdum, tincidunt felis a, condimentum est. Donec pulvinar tincidunt orci, vitae aliquet diam luctus sit amet. Class aptent taciti sociosqu ad litora torquent per conubia nostra,
      per inceptos himenaeos. Praesent varius cursus lorem, ultrices porta erat vehicula sed. Donec blandit venenatis laoreet. Morbi venenatis hendrerit suscipit. Pellentesque justo velit, ultricies id orci et, viverra fermentum nibh. Nulla vitae interdum
      tellus. Duis bibendum maximus mauris ac condimentum. Phasellus convallis ligula ligula, sed tempor quam varius ac. Etiam dignissim arcu sed nibh facilisis, eu rutrum elit pharetra. Suspendisse dignissim commodo eros, rutrum volutpat orci mollis
      quis. Donec vulputate, tortor eget viverra sodales, ex libero euismod sapien, dignissim interdum neque urna non orci. Fusce eget ex iaculis, aliquam tortor sit amet, congue velit. Curabitur eget pretium odio. Phasellus dapibus, sapien ut tempor
      dapibus, mauris felis venenatis magna, in posuere metus nulla in justo. Nam accumsan finibus libero ut gravida. Duis orci dolor, vulputate ut quam sit amet, egestas porttitor diam. Pellentesque habitant morbi tristique senectus et netus et malesuada
      fames ac turpis egestas. Proin ultricies sapien eu dignissim lacinia. Donec ut porta metus. Pellentesque ultrices gravida auctor. Quisque nulla risus, ornare eu molestie at, dapibus vitae tortor. Nullam consequat libero in libero sollicitudin, in
      luctus ante semper. In hac habitasse platea dictumst. Sed ultricies mattis ex, ac feugiat diam pharetra vitae. Vestibulum malesuada pulvinar sem vitae commodo. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.
      Cras porta gravida mollis. Aliquam mollis mi ac nisl fermentum elementum. Morbi vestibulum efficitur dolor ut consectetur.
    </p>
    <h1 id="head4">Heading 4</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed justo interdum, tincidunt felis a, condimentum est. Donec pulvinar tincidunt orci, vitae aliquet diam luctus sit amet. Class aptent taciti sociosqu ad litora torquent per conubia nostra,
      per inceptos himenaeos. Praesent varius cursus lorem, ultrices porta erat vehicula sed. Donec blandit venenatis laoreet. Morbi venenatis hendrerit suscipit. Pellentesque justo velit, ultricies id orci et, viverra fermentum nibh. Nulla vitae interdum
      tellus. Duis bibendum maximus mauris ac condimentum. Phasellus convallis ligula ligula, sed tempor quam varius ac. Etiam dignissim arcu sed nibh facilisis, eu rutrum elit pharetra. Suspendisse dignissim commodo eros, rutrum volutpat orci mollis
      quis. Donec vulputate, tortor eget viverra sodales, ex libero euismod sapien, dignissim interdum neque urna non orci. Fusce eget ex iaculis, aliquam tortor sit amet, congue velit. Curabitur eget pretium odio. Phasellus dapibus, sapien ut tempor
      dapibus, mauris felis venenatis magna, in posuere metus nulla in justo. Nam accumsan finibus libero ut gravida. Duis orci dolor, vulputate ut quam sit amet, egestas porttitor diam. Pellentesque habitant morbi tristique senectus et netus et malesuada
      fames ac turpis egestas. Proin ultricies sapien eu dignissim lacinia. Donec ut porta metus. Pellentesque ultrices gravida auctor. Quisque nulla risus, ornare eu molestie at, dapibus vitae tortor. Nullam consequat libero in libero sollicitudin, in
      luctus ante semper. In hac habitasse platea dictumst. Sed ultricies mattis ex, ac feugiat diam pharetra vitae. Vestibulum malesuada pulvinar sem vitae commodo. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.
      Cras porta gravida mollis. Aliquam mollis mi ac nisl fermentum elementum. Morbi vestibulum efficitur dolor ut consectetur.
    </p>
    <h1 id="head5">Heading 5</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent sed justo interdum, tincidunt felis a, condimentum est. Donec pulvinar tincidunt orci, vitae aliquet diam luctus sit amet. Class aptent taciti sociosqu ad litora torquent per conubia nostra,
      per inceptos himenaeos. Praesent varius cursus lorem, ultrices porta erat vehicula sed. Donec blandit venenatis laoreet. Morbi venenatis hendrerit suscipit. Pellentesque justo velit, ultricies id orci et, viverra fermentum nibh. Nulla vitae interdum
      tellus. Duis bibendum maximus mauris ac condimentum. Phasellus convallis ligula ligula, sed tempor quam varius ac. Etiam dignissim arcu sed nibh facilisis, eu rutrum elit pharetra. Suspendisse dignissim commodo eros, rutrum volutpat orci mollis
      quis. Donec vulputate, tortor eget viverra sodales, ex libero euismod sapien, dignissim interdum neque urna non orci. Fusce eget ex iaculis, aliquam tortor sit amet, congue velit. Curabitur eget pretium odio. Phasellus dapibus, sapien ut tempor
      dapibus, mauris felis venenatis magna, in posuere metus nulla in justo. Nam accumsan finibus libero ut gravida. Duis orci dolor, vulputate ut quam sit amet, egestas porttitor diam. Pellentesque habitant morbi tristique senectus et netus et malesuada
      fames ac turpis egestas. Proin ultricies sapien eu dignissim lacinia. Donec ut porta metus. Pellentesque ultrices gravida auctor. Quisque nulla risus, ornare eu molestie at, dapibus vitae tortor. Nullam consequat libero in libero sollicitudin, in
      luctus ante semper. In hac habitasse platea dictumst. Sed ultricies mattis ex, ac feugiat diam pharetra vitae. Vestibulum malesuada pulvinar sem vitae commodo. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.
      Cras porta gravida mollis. Aliquam mollis mi ac nisl fermentum elementum. Morbi vestibulum efficitur dolor ut consectetur.
    </p>
  </div>
</body>

</html>
```

# c# - 将文本数据从文件重定向到标准输入 c# windows

> ID：15991361
> 
> 赞同：1
> 
> 时间：2013-04-13T18:30:47.290
> 
> 标签：c#, windows, file, stdin, redirect

如何将数据从某个文本文件重定向到 C# 程序的标准输入？通过一些代码或命令提示符（在 Windows 中）？我试过在命令提示符中重定向它，如下所示：input.txt > program.exe > output.txt（就像在linux中一样），但这不起作用。也试过这样：

```
string path = @"D:\input.txt";
// Open the file to read from. 
using (StreamReader sr = File.OpenText(path))
{
    string s = "";
    using (StreamWriter stdinput = new StreamWriter(Console.OpenStandardInput()))
    {
        while ((s = sr.ReadLine()) != null)
        {
            stdinput.WriteLine(s);
        }
    }
} 
```

但这也不起作用。它因以下错误而崩溃：

> “在 mscorlib.dll 中发生了“System.ArgumentException”类型的未处理异常
> 
> 附加信息：流不可写。”

我怎样才能做我想做的事？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T18:33:07.830

[使用命令重定向运算符](https://ss64.com/nt/syntax-redirection.html)

```
 program.exe < input.txt > output.txt 
```

# jboss7.x - JBoss 部署不符合 JDBC 的驱动程序类 com.mysql.jdbc.Driver

> ID：15991364
> 
> 赞同：10
> 
> 时间：2013-04-13T18:30:55.867
> 
> 标签：jboss7.x, mysql-connector

大家晚上好，有人知道这个错误吗

```
JBAS010404: Deploying non-JDBC-compliant driver class com.mysql.jdbc.Driver (version 5.1) 
```

当我开始部署 mysql jar 并且我的应用程序无法在服务器上启动时，它总是出现，我为此`HTTP Status 404`遭受了很多痛苦并且无法找到任何解决方案，请帮助我。

注：我用过`mysql-connector-java-5.1.24.jar`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-13T19:58:44.853

由于 MySQL 驱动程序不兼容 JDBC，因此会打印该消息。这可能看起来有点奇怪，但这是一个长期存在的已知问题：

*   [http://bugs.mysql.com/bug.php?id=62038](http://bugs.mysql.com/bug.php?id=62038)

问题是要完全兼容 JDBC，驱动程序必须具有符合 SQL92 标准入门级的 SQL 支持，但 MySQL 不支持所需的功能。你没看错：MySQL 不支持 20 年前标准的最基本级别。缺少功能的最突出的例子可能是[检查约束](http://dev.mysql.com/doc/refman/5.6/en/create-table.html)。因此，驱动程序不合规，JBoss 会记录一条消息，说明这一点。

但是，这不会阻止驱动程序正确部署。正如消息所说，JBoss 部署它。

如果您的应用程序无法运行，则问题出在其他地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:28:30.863

尝试使用这些[说明](https://github.com/akostadinov/edg-examples/blob/master/chunchun/src/main/config/jboss.mysql.txt)将 mysql 驱动程序部署到 JBoss AS。使用 fedora18 中的连接器 5.1.22，我从来没有遇到过问题。这是[module.xml](https://github.com/akostadinov/edg-examples/blob/master/chunchun/src/main/config/jboss/modules/com/mysql/main/module.xml)

# cocos2d-iphone - 从后台返回时进入主场景

> ID：15991365
> 
> 赞同：0
> 
> 时间：2013-04-13T18:31:00.847
> 
> 标签：cocos2d-iphone

当应用程序回到后台时，我在代表处有这个：

```
if( [navController_ visibleViewController] == director_ )
     [director_ resume]; 
```

现在，如果我在`ccscene 2`进入后台时，当我回来时，它会转到`scene2`。

我想定义家庭场景，每次我们来自背景时，我们都会从代表那里去。

我该怎么做？

# vb.net - 如何控制表单的加载位置

> ID：15991370
> 
> 赞同：1
> 
> 时间：2013-04-13T18:31:22.543
> 
> 标签：vb.net

我敢肯定，这将是许多问题中的第一个。

我开始在 VB.net 中创建一个应用程序，但我对这种语言还不是很熟悉。我正在尝试基于系统托盘图标设计一个应用程序，我的意思是，当您启动应用程序时，应该没有加载的初始表单，只有系统托盘中的图标。

从那里我需要做两件事。我想“鼠标悬停”在系统托盘正上方弹出表单，“双击”让它在计算机屏幕中间打开。

我成功使用“静态”展示位置 { `Me.Location = New Point(800, 390)`}

我可以让窗口/表单在我想要的位置打开，但问题是当我更换到另一台计算机时，它们没有在正确的位置打开。无论屏幕分辨率如何，我都需要一种方法来确保表单在正确的位置打开。

任何人都可以推荐我应该谷歌了解更多关于表单放置甚至链接的信息。由于对这门语言如此陌生，我的谷歌尝试失败了，我需要更多的指导和一些帮助，直到我掌握了术语并知道我在寻找什么，......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:36:30.947

如果您想根据桌面大小动态放置表单，请查看：

```
SystemInformation.VirtualScreen.Width   
SystemInformation.VirtualScreen.Height 
```

...并根据这些动态值移动您的表单。例如

```
Me.Location = New Point(SystemInformation.VirtualScreen.Width - Me.Width, SystemInformation.VirtualScreen.Height - Me.Height) 
```

有关 VirtualScreen 的更多信息，请查看 MSDN：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.virtualscreen.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.virtualscreen.aspx)

VirtualScreen 将为您提供多个显示器的组合大小和宽度，因此作为替代方案，您也可以简单地查看主屏幕，例如

```
Screen.PrimaryScreen.WorkingArea.Width
Screen.PrimaryScreen.WorkingArea.Height 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:35:28.763

您可以使用`Me.CenterToScreen`将其置于用户屏幕的中心，据我所知，这是您能做的最好的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T18:35:29.540

在表单属性中有一个属性**StartUpPosition**将其设置为**CenterScreen**

# javascript - 地图画布更改大小 API 后重新定位 Google 地图

> ID：15991373
> 
> 赞同：0
> 
> 时间：2013-04-13T18:31:34.727
> 
> 标签：javascript, google-maps-api-3

我正在使用 Google Maps API v.3 创建一个 google 地图，其方向与[google 的这个示例](https://google-developers.appspot.com/maps/documentation/javascript/examples/directions-panel)非常相似。

主要区别在于，在页面加载时，谷歌地图画布设置为 100%，当用户请求方向时，地图减少到 70%（为方向面板腾出空间）

当用户获得方向时，方向显示为好像地图画布处于 100%，而不是 70%，基本上切断了部分方向。当显示方向响应时，我需要地图重新定向/重新定位。

你可以在这里演示：http: [//j2designpartnership.com/directions/](http://j2designpartnership.com/directions/)

当用户输入方向时，调用此函数： `calcRoute()`

```
function calcRoute() {

        if (document.getElementById("start").value != "") {
            activeSettings();
        }
        else{
            defaultSettings();
        }

        var start = document.getElementById("start").value;
        var end = document.getElementById("end").value;

        var request = {
            origin:start, 
            destination:end,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };

            //make the request for our directions
            directionsService.route(request, function(response, status) {

                if (status == google.maps.DirectionsStatus.OK) {

                    directionsDisplay.setDirections(response);
                }
            });

            var recenter = new google.maps.LatLng(40.440625,-79.995886);
            map.setCenter(recenter);
    } 
```

这里要注意的部分是顶部条件，如果输入字段中有文本，基本上会改变地图画布的宽度。

既然地图画布更小了，我该如何重新定位地图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:11:12.977

[当地图 div 更改大小时，按照文档中的](https://developers.google.com/maps/documentation/javascript/reference#Map)规定触发地图上的调整大小事件

> 调整大小 | 无 | 当 div 更改大小时，开发人员应在地图上触发此事件： google.maps.event.trigger(map, 'resize') 。

# php - 我添加链接并得到错误解析错误：语法错误

> ID：15991375
> 
> 赞同：0
> 
> 时间：2013-04-13T18:31:37.107
> 
> 标签：php

我已经尽力了，但不是运气。

这是错误消息：解析错误：语法错误，意外的 T_STRING，期待 ','

```
 <?php
echo '<a style="cursor: pointer"  onclick="javascript: window.location = \'fruit_list.php?do=delete&id=<?php print $fruitdata['id']; ?>/\';">Delete</a>';?> 
```

请纠正我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:33:21.267

```
<?php echo '<a style="cursor: pointer"  onclick="javascript: window.location = \'fruit_list.php?do=delete&id='.$fruitdata['id'].'\';">Delete</a>';?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:35:04.433

您必须`<?php print ...`从命令中删除该部分：

```
echo '<a style="cursor: pointer"  onclick="javascript: window.location = \'fruit_list.php?do=delete&id=' . $fruitdata['id'] . '\';">Delete</a>';?> 
```

请注意，如果将代码分成两行，则代码可能更具可读性：

```
$action = "window.location = 'fruit_list.php?do=delete&id={$fruitdata['id']}";
echo '<a style="cursor: pointer" onclick="javascript:' . $action . '">Delete</a>'; 
```

# css - 如何让 Ember.js 的 bindAttr 刷新？

> ID：15991376
> 
> 赞同：0
> 
> 时间：2013-04-13T18:31:37.367
> 
> 标签：css, ember.js

我正在尝试创建“排序依据”按钮，当单击使用 Ember.js 时更改排序和 css 类。

排序部分和初始类分配工作，但是，当我更新依赖属性时，类分配不会刷新。

我错过了什么？

这是在我的 HTML 中：

```
<script type="text/x-handlebars" data-template-name="sort-option-item">
    <dd {{bindAttr class="IsActive:active IsDesc:reversed"}}
        {{action sortBy on="click"}}><a href="#">{{Name}}</a></dd>
</script>

<script type="text/x-handlebars">
    {{#each option in controller.sortOptions}}
        {{view App.SortOptionView controllerBinding="option"}}
    {{/each}}
</script> 
```

这是在我的 Javascript 中：

```
var App = null;

$(function () {

    App = Ember.Application.create();

    // Define Types:

    App.SortOptionCtrl = Ember.Controller.extend({
        Name: null,
        Predicate: null,
        Controller: null,
        IsActive: false,
        IsDesc: false,
        sortBy: function () {
            if (this.Controller != null)
                this.Controller.sortBy(this.Predicate);
        },
        Check: function () {
            this.IsActive = this.Controller != null
                            && this.Controller.isSortedBy(this.Predicate);
            this.IsDesc = this.Controller != null
                          && this.Controller.isSortedDescBy(this.Predicate);
            // adding an alert(this.IsActive); here
            // proves that the function is indeed called and works as expected
        }
    });

    App.ProductsController = Ember.ArrayController.extend({

        initialized: false,
        content: [],
        viewContent: [],
        sortProperties: ['Order'],
        sortAscending: true,
        sortOptions: [],

        initialize: function () {

            if (this.initialized == true)
                return;

            this.initialized = true;
            var ctrl = this;

            this.sortOptions.pushObject(App.SortOptionCtrl.create({
                Name: 'Unsorted',
                Predicate: null,
                Controller: ctrl,
            }));
            this.sortOptions.pushObject(App.SortOptionCtrl.create({
                Name: 'By Name',
                Predicate: 'Name',
                Controller: ctrl,
            }));
            this.sortOptions.pushObject(App.SortOptionCtrl.create({
                Name: 'By Date',
                Predicate: 'Date',
                Controller: ctrl,
            }));

            this.sortOptions.forEach(function (opt) { opt.Check(); });
        },

        load: function () {

            this.initialize();
            // ....
        },

        sortBy: function (predicate) {

            var prevPredicate = this.sortProperties[0];

            if (predicate == prevPredicate && predicate != null) {
                this.sortAscending = !(this.sortAscending);
            }
            else {
                this.sortAscending = true;
            }

            this.sortProperties.length = 0;

            if (predicate)
                this.sortProperties.pushObject(predicate);
            else
                this.sortProperties.pushObject('Order');

            this.sortOptions.forEach(function (opt) { opt.Check(); });
        },

        isSortedBy: function (predicate) 
        {
            if (predicate == null)
                predicate = 'Order';

            var activePredicate = this.sortProperties[0];

            if (predicate == activePredicate) {
                return true;
            }
            else {
                return false;
            }
        },

        isSortedDescBy: function (predicate) {

            if (predicate == null)
                predicate = 'Order';

            var activePredicate = this.sortProperties[0];

            if (predicate == activePredicate) {
                if (this.sortAscending)
                    return false;
                else
                    return true;
            }
            else {
                return false;
            }
        },

    });

    App.SortOptionView = Ember.View.extend({
        templateName: 'sort-option-item'
    });

    // Create Instances:

    App.productsController = App.ProductsController.create({
    });

    App.productsController.load();

    App.initialize();
}); 
```

版本：Ember：1.0.0-rc.2，车把：1.0.0-rc.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:22:04.757

如果您希望您的视图对控制器中发生的任何事情做出反应，您应该创建计算属性（通过[`fn(){}.property('dependency')`](http://emberjs.com/guides/object-model/computed-properties/)）。但是，为了使计算属性正常工作，您需要使用 Ember[`get()`](http://emberjs.com/api/classes/Ember.Object.html#method_get)和[`set()`](http://emberjs.com/api/classes/Ember.Object.html#method_set)属性访问器。

在您的代码中，您正在做类似的事情

```
this.IsActive = this.Controller != null && 
                this.Controller.isSortedBy(this.Predicate); 
```

当你应该做这样的事情时：

```
this.set('active',
     this.get('controller') != null &&
     this.get('controller').isSortedBy(this.get('Predicate'))
); 
```

您可能已经注意到，这段代码将值*设置*为`active`，但模板正在侦听`isActive`。该属性已更改为计算属性：

```
isActive: function() {
    return this.get('active');
}.property('active') 
```

它将监听`active`属性的变化，每当发生这种情况时，它将缓存新值，并通知所有订阅者对象刷新/更新。

指示使用 Ember`get`和`set`访问器是为了正确使用使此事件链成为可能的可观察对象。

我已经修改了您的示例应用程序`get`并`set`在适当的情况下进行了修改。你可以在这个小提琴中看到它：http: **[//jsfiddle.net/schawaska/fRMYu/](http://jsfiddle.net/schawaska/fRMYu/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T20:16:30.377

在乔的帮助下，更多地阅读了 Ember 的手册并清理了我的代码，我得到了这个分拣机解决方案：

排序选项控制器：

```
App.SortOptionCtrl = Em.Controller.extend({
    Name: null,
    Predicate: null,

    _isActive: false,
    isActive: function () {
        return this.get('_isActive');
    }.property('_isActive'),

    _isDesc: false,
    isDesc: function () {
        return this.get('_isDesc');
    }.property('_isDesc'),

    controller: null,

    updateState: function () {
        if (!this.Predicate) {
            this.set('_isActive', (this.get('controller')
                .get('activePredicate') == null));
            this.set('_isDesc', false);
        }
        else {
            this.set('_isActive', (this.get('controller')
                .get('activePredicate') == this.Predicate));
            this.set('_isDesc', (this.get('_isActive')
                && !this.get('controller').get('sortAscending')));
        }
    }.observes('controller.activePredicate', 'controller.sortAscending'),

    sortBy: function () {
        if (this.get('controller') != null) {
            this.get('controller').sortBy(this.Predicate);
        }
    },
}); 
```

产品控制器：

```
App.ProductsController = Ember.ArrayController.extend({

    content: [],
    viewContent: [],
    activePredicate: null,
    sortProperties: ['Order'],
    sortAscending: true,
    sortOptions: [],

    filter: function (obj) {
        return true;
    },

    init: function () {

        this._super();

        var ctrl = this;

        this.sortOptions.pushObject(App.SortOptionCtrl.create({
            Name: 'Unsorted',
            Predicate: null,
            controller: ctrl,
        }));
        this.sortOptions.pushObject(App.SortOptionCtrl.create({
            Name: 'By Name',
            Predicate: 'Name',
            controller: ctrl,
        }));
        this.sortOptions.pushObject(App.SortOptionCtrl.create({
            Name: 'By Date',
            Predicate: 'Date',
            controller: ctrl,
        }));

        this.sortOptions.forEach(function (opt) {
            opt.updateState();
        });
    },

    sortBy: function (predicate) {

        var prevPredicate = this.sortProperties[0];

        if (predicate == prevPredicate && predicate != null) {
            this.set('sortAscending', !(this.get('sortAscending')));
        }
        else {
            this.set('sortAscending', true);
        }

        this.set('activePredicate', predicate);
        this.set('sortProperties.length', 0);

        if (predicate)
            this.get('sortProperties').pushObject(predicate);
        else
            this.get('sortProperties').pushObject('Order');
    },

}); 
```

# javascript - 将数据附加到谷歌地图的营业地点

> ID：15991377
> 
> 赞同：0
> 
> 时间：2013-04-13T18:31:40.760
> 
> 标签：javascript, google-maps

我很想知道，只要数据位于您的应用程序中，谷歌就可以将数据附加到他们地图上的特定位置。例如...

如果我想创建一个对商店或餐馆进行评分的评分应用程序。客户想要查找他们所在位置的商店。他们将能够在我的应用程序中看到我的数据，显示该特定业务的评级。

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:00:14.053

最肯定的。您将需要一个独立的平台来跟踪您的数据，即评级、评论等。此外，您必须自己管理整个地图，即根据用户搜索绘制标记并在他们单击标记时填充信息框（如果你需要）。您很可能会有一个跟踪餐厅纬度/经度的数据库。您甚至可以使用谷歌本身来检索餐厅信息，并在绘制点时将您自己的评分叠加在地图上。

例如[，这](http://gmaps-samples-v3.googlecode.com/svn/trunk/infowindow_custom/infowindow-custom.html)是一个自定义信息框，您可以使用它来显示评级等。

我要添加到应用程序中的一项有趣功能是使用 HTML5 的地理位置来自动检测用户的纬度/经度。

# c - spoj - opn - 转换表达式 - 分段错误

> ID：15991380
> 
> 赞同：1
> 
> 时间：2013-04-13T18:31:54.413
> 
> 标签：c, segmentation-fault

我第一次尝试在 spoj 上提交解决方案，这是我解决在[spoj 上转换表达式问题的](http://www.spoj.com/problems/ONP/)解决方案。我收到 SIGSEV 错误，这是一个运行时错误，分段错误。我在我的代码中检查了很多，但我没有在我的代码中看到任何此类错误。请帮助解决这个问题。

我有编辑过的代码：-

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int precedence(char c)
{
switch (c)
{
    case '/':
        return 2;

    case '*':
        return 2;

    case '+':
        return 1;

    case '-':
        return 1;

    case '^':
        return 3;

    case ')':
        return 4;

    case '(':
        return -1;

    default:
        return -1 ;
}
}

int main()
{
 //char input[400]="a*(b+c)-d/e";
 // char input[400]="a+b*c-d/e*f";
 // char input[400] = "(a+b*c-d)/(e*f)";
 // char input[400] = "(a+(b*c))" ;
 //char input[400] = "((a+b)*(z+x))";
 // char input[400] = "((a+t)*((b+(a+c))^(c+d)))";
 char input[402];
 char *stack;
 char *output;
 char *p = input ;
 int i , top  , t  , l ;

scanf("%d",&t);

while (t-- != 0 )
{
    scanf("%s",input);
    p = input ;
    i = 0 ;
    top = 0 ;
    l = strlen(input);
    stack = (char *)malloc(sizeof(strlen(input)));
    output = (char *)malloc(sizeof(strlen(input)));

    stack[top++]='(';

    *(p+l)=')';
    *(p+l+1)= '\0';

    while(p[0] != '\0')
    {
        if (p[0] >= 'a' && p[0] <= 'z' )
        {
            output[i]=p[0];
            i++;
        }
        else if (p[0] == '(')
        {
            stack[top++] = p[0];
        }
        else if (p[0] == ')')
        {
            while (stack[top-1] != '(')
            {
                --top;
                output[i] = stack[top];

                i++ ;
            }
            //to remove the left parenthesis
            top--;

        }
        else if (p[0] == '+' || p[0] == '-' || p[0] == '*' || p[0] == '/' || p[0]=='^')
        {
            while(precedence(stack[top-1]) >= precedence(p[0]))
            {
                output[i]=stack[top-1];
                top--;
                i++;
                //j = k;
            }
            stack[top] = p[0];
            top++;
        }

        p++;
    }
    printf("%s\n",output);
    free(stack);
    free(output);

for(i = (strlen(input)-1) ; i >= 0 ; i--)
    input[i]='\0';

}

return 0 ;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:38:27.707

```
*(p+strlen(p))=')'; 
```

覆盖 的 0 终止符`p`，然后

```
*(p+strlen(p))= '\0'; 
```

`strlen(p)`in this 可能不再找到任何 0 终止符，并导致段错误。此外，无论如何，该行是多余的，`*(p + strlen(p))`根据定义已经是 0 `strlen`（如果`p`是字符串，即 0 终止）。

如果要`')'`在末尾添加a，请存储长度，

```
size_t len = strlen(p);
p[len] = ')';
p[len+1] = 0; 
```

并使用两次。**但请确保您有足够的空间分配。**

# php - php mysql + 插入查询解释

> ID：15991382
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:31:56.293
> 
> 标签：php, mysql, insert

在任何人投反对票并批评我之前，我是开发新手，我需要在我的查询中使用 php 和 mysql

所以我试图让用户在注册页面中插入一些信息，这些信息将向具有这些字段的名为 user 的表提交信息：

*   用户名，
*   名，
*   姓，
*   地址，
*   区名，
*   村名，
*   出生日期，
*   电子邮件地址，
*   专业化名称，
*   密码，
*   注册日期

我有另一个具有这些字段的名称专业化表：

*   专业化_id
*   规格名称

我需要的是用户在注册页面中选择专业化，但在用户表中我需要使用 specialization_id 作为专业化表的外键

我使用的插入查询是：

```
 $query = mysql_query("INSERT INTO user(user_name, first_name, last_name, address, district_name, village_name, birth_date, email_address, specialization_name, password, registered_date)VALUES('$username', '$fname', '$lname', '$country', '$district', '$village', '$bdate', '$email', '$specialization', '$pass1',  now())")or die("could not insert data"); 
```

# 注册.php

```
<?php require_once('for members/scripts/connect.php'); ?>

<?php
ob_start();
 function countryQuery(){

  $countryData = mysql_query("SELECT * FROM country") or die("could select database");

  while($record = mysql_fetch_array($countryData)){

     echo'<option value="' . $record['country_name'] .  '">' . $record['country_name'] . '</option>';

  }

}

function specializationQuery(){

$specData = mysql_query("SELECT * FROM specialization");

  while($recordJob = mysql_fetch_array($specData)){

     echo'<option value="' . $recordJob['specialization_name'] .  '">' . $recordJob['specialization_name'] . '</option>';

  }

}

function districtQuery(){

$distData = mysql_query("SELECT * FROM districts");

  while($recorddist = mysql_fetch_array($distData)){

     echo'<option value="' . $recorddist['district_name'] .  '">' . $recorddist['district_name'] . '</option>';

  }

}

function villageQuery(){

$villageData = mysql_query("SELECT * FROM village");

  while($recordvillage = mysql_fetch_array($villageData)){

     echo'<option value="' . $recordvillage['village_name'] .  '">' . $recordvillage['village_name'] . '</option>';

  }

}

 //default value
$message = "Fields Marcked with an [*] are Required";
  $username = "";
  $fname = "";
  $lname = "";
  $specialization = "";
  $email = "";
  $pass1 = "";
  $pass2 = "";
  $district = "";
  $village = "";

if(isset($_POST['username'])){
  $username = mysql_real_escape_string($_POST['username']);
  $fname = mysql_real_escape_string($_POST['fname']);
  $lname = mysql_real_escape_string($_POST['lname']);
  $email = mysql_real_escape_string($_POST['email']);
  $pass1 = mysql_real_escape_string($_POST['pass1']);
  $pass2 = mysql_real_escape_string($_POST['pass2']);
  $bdate = mysql_real_escape_string($_POST['birthdate']);
  $country = mysql_real_escape_string($_POST['country']);
  //$local_adress = $_POST['adress'];
  $specialization = mysql_real_escape_string($_POST['specialization']);
  $district = mysql_real_escape_string($_POST['district']);
  $village = mysql_real_escape_string($_POST['village']);

  //error handeling
  if((!$username)||(!$fname)||(!$lname)||(!$email)||(!$pass1)||(!$pass2)||(!$specialization)||(!$district)||(!$village)){
  $message = "**** Please insert the Required Fields below ****<br />";

  if($fname == "")
 {
     $message = $message . "Enter First name<br/>";
 }
  if($lname == "")
 {
     $message = $message . "Enter Last name<br/>";
 }

 if($specialization == 0)
 {
     $message = $message . "Select Your Job<br />";
 }
 if($district == 0)
 {
     $message = $message . "Select Your District<br />";
 }
 if($village == 0)
 {
     $message = $message . "Select Your Village<br />";
 }
 if($email == "")
 {
     $message = $message . "Enter Email Adress<br/>";
 }
  if ($username == "") {
    $message = $message . "Enter User Name<br/>";
  }

  if($pass1 == "")
 {
     $message = $message . "Enter password<br/>";
 }

  if($pass2 == "")
 {
     $message = $message . "rechek the password <br/>";
 }

 } 

     elseif(strlen($pass1) <= 8)
    {
     $message = $message . "Your Password must be at least 8 charachters<br />";
}
   else if($pass1!=$pass2){
   $message = "your password do not match!";
   }else{
   //securing the data
   $username = preg_replace("#[^0-9a-z]#i","",$username);
   $fname = preg_replace("#[^0-9a-z]#i","",$fname);
   $lname = preg_replace("#[^0-9a-z]#i","",$lname);
   //$pass1 = sha1($pass1);

   $email = mysql_real_escape_string($email);
   // checking for duplicate
   $user_query = mysql_query("SELECT user_name FROM user WHERE user_name = '$username'LIMIT 1") or die("could not check the username");
   $count_username = mysql_num_rows($user_query);

    $email_query = mysql_query("SELECT email_address FROM user WHERE email_address = '$email'LIMIT 1") or die("could not check the email");
   $count_email = mysql_num_rows($email_query);

    if($count_username > 0){
     $message = " your username is alredy in use";
    }elseif($count_email > 0){
      $message = "your email is alredy in use";
    }
   else{

      $query = mysql_query("INSERT INTO user(user_name, first_name, last_name, address, district_name, village_name, birth_date, email_address, specialization_name, password, registered_date)VALUES('$username', '$fname', '$lname', '$country', '$district', '$village', '$bdate', '$email', '$specialization', '$pass1',  now())")or die("could not insert data");  
      //var_dump($query);
      //exit();

    $message = "Registered Success <a href='profile.php'>Your Profile</a> ";
    //from the social website

        if ($query) 
       {
       $_SESSION['user_id'] = mysql_insert_id();
       $_SESSION['login'] = 'true';
       $_SESSION['login_user'] = $username;
       }

    }
   }
 }

?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Register Page</title>
<link href="style/stylesheet.css" rel="stylesheet" type="text/css" />
<link href="style/imagesGallery.css"rel="stylesheet" type="text/css"/>
<script src="js/main.js" type="text/javascript"></script>
<script src="js/jquery.js" type="text/javascript"></script>
</head>

<body>

<div class="container">
<table width="200" border="0" align="center">
<tr>
  <tr>
    <td><img src="web_header copy.jpg" alt="visitor header" width="1080" height="128" /></td>
  </tr>
  <tr>

     <td>
       <marquee direction="left" width="99%" behavior="alternate">
        <img src="imggallery/images/akoura/akoura_small.jpg" width="119" height="91">
        <img src="imggallery/images/ballaa2/ballaa2_small.jpg" width="119" height="91">
        <img src="imggallery/images/baalbeck/baalbek_small.jpg" height="92">
        <img src="imggallery/images/barouk/cedre_barouk_small.jpg" width="119" height="91">
        <img src="imggallery/images/batroun/batroun_small.jpg" width="119" height="91">
        <img src="imggallery/images/bchareh/bchareh_small.jpg" width="119" height="91">
        <img src="imggallery/images/beiteldin/beiteldine_small.jpg" width="119" height="91">
        <img src="imggallery/images/beyrouth/beyrouth_small.jpg" width="119" height="91">
        <img src="imggallery/images/beyrouth/beyroyj frm sky/beyrouthfromSky_small.jpg" width="119" height="91">
        <img src="imggallery/images/deir el mara/deirelamar_small.jpg" width="119" height="91">
        </marquee>
        <hr />
       <h2 class="registerTitle">Registration Fields</h2>
       <h4 class="registerTitle">Sign Up Today....</h4>
 <!-- <div class="container center"> -->
       <p style="color:#FF0000" align="center"><?php print("$message")?></p>
    </td>

    <tr>
        <table width="680" border="0" align="center">
        <form action="register.php" method="post">

        <tr>

        <td><span class="Fields">First Name</span> <span class="requiredField">*</span></td>
        <td>
        <input type="text" name="fname" placeholder="Firstname" /></td>

      <td><span class="Fields">Last Name</span><span class="requiredField">*</span></td>

      <td><input type="text" name="lname" placeholder="Lastname" /></td>
      </tr>

    <tr>
      <td><label for="birthdate" class="Fields">Birth Date                     </label></td>
      <td><input type="date" name="birthdate" value= "YYYY_MM_DD"  onfocus="if (this.value == 'YYYY_MM_DD') {this.value = '';}" onblur="if (this.value == '') {this.value = 'YYYY_MM_DD';}" />
        <br /></td>

    </tr>

    <tr>
      <td class="Fields"><label for="country">Country</label></td>
      <td><select name="country"  class="select">
      <option value="0">-- Select Your Country --</option>
        <?php countryQuery(); ?>
      </select></td>
      <td class="Fields"><label for="specialisation">Specialisation <span class="requiredField">*</span></label></td>
      <td><select name="specialization"  class="select">
      <option value="0">-- Select Your Specialization --</option>

        <?php specializationQuery(); ?>
      </select></td>

    </tr>

    <tr>
      <td class="Fields"><label for="district">District<span class="requiredField">*</span></label></td>
      <td><select name="district"  class="select">
      <option value="0">-- Select Your District --</option>

        <?php districtQuery(); ?>
      </select></td>

      <td class="Fields"><label for="village">Village<span class="requiredField">*</span></label></td>
      <td><select name="village"  class="select">
      <option value="0">-- Select Your Village --</option>

        <?php villageQuery(); ?>
      </select></td>

    </tr>

    <tr>
      <td class="Fields"><label for="email">Email Adress<span class="requiredField">*</span></label></td>
      <td><input type="text" name="email" placeholder="Email Adress" />
        <br /></td>
      <td><label for="username"><span class="Fields">User Name</span> <span class="requiredField">*</span></label></td>
      <td><input type="text" name="username" placeholder="Username" />
        <br /></td>

    </tr>

    <tr>
      <td class="Fields"><label for="password">Password<span class="requiredField">*</span></label></td>
      <td><input type="password" name="pass1" placeholder="Password" />
        <br /></td>
      <td class="Fields"><label for="password2">Re_Password<span class="requiredField">*</span></label></td>
      <td><input type="password" name="pass2" placeholder="Validate Password" />
        <br /></td>

    </tr>

    <tr>
      <td></td>
      <td></td>
      <td><input type="submit" value="Register"/></td>
      <td></td>
    </tr>

  </form>
</table>
<!--</div>-->
  </tr>

  <tr>
    <td><?php require_once('footer.php'); ?></td>
  </tr>
  </tr>
  </tr>
</table>

</div>
</body>
</html>
<?php ob_end_flush(); ?> 
```

所以任何人都可以帮助我？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:36:30.640

“**specialization_name**”肯定会导致问题。* 是 SQL 查询中的一条语句，它基本上代表所有内容（例如，SELECT * FROM someTable... 表示从 someTable 中选择所有内容）。您应该删除星号，假设您设置正确，您的查询将正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:49:11.370

试试[PHP PDO](http://php.net/manual/en/book.pdo.php)，php 中的 mysql_ 函数将被贬低，而且 PDO 更安全，是将您的应用程序移植到其他数据库的最佳实践。不能用 Mysql_ 做到这一点

像这样 ：

```
 //We connect to the database
    $host="xxxxxx"; // Host name
    $username="xxxxxxx"; // Mysql username
    $password="xxxxxxxxxx"; // Mysql password
    $db_name="xxxxxxxx"; // Database name

    // Connect to server via PHP Data Object
    $dbh = new PDO("mysql:host=localhost;dbname=DBFinaid", $username, $password);
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, FALSE);

        try {
                $query = $dbh->prepare("
                      INSERT INTO user(user_name, 
                                        first_name, 
                                        last_name,
                                        address, 
                                        district_name, 
                                        village_name, 
                                        birth_date, 
                                        email_address, 
                                        specialization_name, 
                                        password, 
                                        registered_date)
                    VALUES(':username', 
                                        ':fname', 
                                        ':lname', 
                                        ':country', 
                                        ':district', 
                                        ':village', 
                                        ':bdate', 
                                        ':email', 
                                        ':specialization', 
                                        ':pass1',  
                                         now())"
                                    );

                $query->bindParam(':YOURVALUES', $YOURVALUE); // Make sure the number values in bindParam equal your values in the query
                .....................................
                $query->execute();
        catch (PDOException $e) {
                error_log($e->getMessage());
                die($e->getMessage());
            }

            $dbh= null;

  [1]: http://php.net/manual/en/book.pdo.php 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:01:08.860

您的`specializationQuery`函数应该打印字符串，`<option value="' . $recordJob['specialization_id'] . '">' . $recordJob['specialization_name'] . '</option>`而不是`<option value="' . $recordJob['specialization_name'] . '">' . $recordJob['specialization_name'] . '</option>`，因此您获得了`specialization_id`必须插入用户数据库的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T18:39:50.697

我认为你不应该使用`specialization_name`但`specialization_id`在你的`user`-table 中。我假设`specialization_id`是表中的键，`specialization`您的表中应该有`user`一个外键 ( )，它引用表 ( )`user.specialization_id`的主键。`specialization``specialization.id`

假设您有以下专业：

1.  规格1
2.  规格2
3.  规格3

那么您在 HTML 中的 Selection 元素应如下所示：

```
<select name="specialization"  class="select">
  <option value="0">-- Select Your Specialization --</option>
  <option value="1">Spec1</option>
  <option value="2">Spec2</option>
  <option value="3">Spec3</option>
</select> 
```

现在，如果用户选择让我们说**Spec2**，那么您的变量`$specialization`应该具有值 2 并且您应该能够将其插入到数据库中。

希望能帮助到你！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-13T18:42:36.260

为了使事情变得更简单，我相信您可以在用户表中使用 ENUM 字段，而不是使用另一个表。这可能是您的替代方案。

# abcpdf - abcpdf page-break-before 不处理列表中的最后一项

> ID：15991387
> 
> 赞同：0
> 
> 时间：2013-04-13T18:32:26.157
> 
> 标签：abcpdf

abcpdf 的文档[http://www.websupergoo.com/helppdf9net/source/3-concepts/g-htmlrender.htm](http://www.websupergoo.com/helppdf9net/source/3-concepts/g-htmlrender.htm)说下面的 html 元素会导致分页。它可以，但对于最后一页，您可以在屏幕截图中看到它没有。HTML 通过验证，并且有中断，所以这是一个错误吗？

```
<div style="page-break-before: always">&nbsp;</div> 
```

![在此处输入图像描述](https://i.stack.imgur.com/2bY7i.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-15T19:44:02.907

这似乎是设计使然，因此无法解决。

# java - 为什么 FileOutputStream 在文件开头添加空字符和传输结束字符？

> ID：15991400
> 
> 赞同：1
> 
> 时间：2013-04-13T18:33:46.220
> 
> 标签：java, file-io

为什么下面的代码

```
import java.io.DataOutputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class Test {
    public static void main(String[] args) throws IOException {
         DataOutputStream out = new DataOutputStream( new FileOutputStream("plik.txt")); 
         String test = new String("test");
         out.writeUTF(test);
         out.close(); 
    }

} 
```

在文件开头生成带有“null”和eot字符的文件，然后是“test”？我希望它会生成只有“测试”的文件，而不需要额外的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:38:55.027

来自 DataOutputStream.writeUTF() 的 Javadoc：

> 首先，两个字节被写入输出流，就好像通过 writeShort 方法给出了后面的字节数。这个值是实际写出的字节数，而不是字符串的长度。在长度之后，使用修改后的 UTF-8 字符编码按顺序输出字符串的每个字符。[...]

所以它不是 2 个字符，而只是 2 个字节。

DataOutputStream 的目的是：

> 数据输出流允许应用程序以可移植的方式将原始 Java 数据类型写入输出流。然后，应用程序可以使用数据输入流来读回数据。

另请注意，建议使用 NIO2 API 和自动资源管理。并且不要用字符串包装字符串。写入文件系统时，还要为流使用缓冲区。

```
try (DataOutputStream out = new DataOutputStream(new BufferedOutputStream(Files.newOutputStream(Paths.get("plik.txt")))){ 
         String test = "test";
         out.writeUTF(test);
} 
```

如果您只想将一些文本以 UTF-8 格式写入文件，请使用以下代码：

```
try (PrintWriter pw = new PrintWriter(Files.newBufferedWriter(Paths.get("plik.txt"), Charset.forName("UTF-8"))){ 
         String test = "test";
         pw.print(test);
} 
```

# linux - ethercat 模块的以太网驱动程序

> ID：15991403
> 
> 赞同：0
> 
> 时间：2013-04-13T18:33:54.033
> 
> 标签：linux, network-programming, linux-kernel, linux-device-driver

我有基于网络设备的 EK1101、EL6002、EL2034 模块。这些模块通过以太网电缆连接到 PC 以太网端口。我已经用一些应用程序测试了这些模块，它在我的电脑上运行良好。

EK1101 用作耦合器。它连接PC以太网端口和其他从模块（EL6002，EL2034，..）

EL6002 作为 RS232 通讯工作。EL2034 用作数字 I/O。同样，我们有超过 10 种不同的设备。这些模块同时与 EK1101 耦合器接口。

我如何实现为 Linux 驱动程序？并开始？我是修改现有的网络驱动程序还是从头开始新的驱动程序？我需要写什么类型的字符或网络驱动程序？如果它的字符驱动程序如何通过以太网端口传输数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-01T01:42:40.487

使用串行切片（EL6002），每个端口每次交换只能发送 22 个字节（每个方向）。在以 1kHz 更新的全串行带宽 (115k) 下，您将不会错过更新，而不会使发送器饿死和/或在接收器上丢失数据。如果这是一个问题，您可能需要声明对用于主控 EtherCAT 回路的以太网端口的独占控制权。这需要某种形式的 root 权限，否则总是有人会尝试通过端口发送数据包，从而影响您的时间。您没有提供有关您的应用程序或时序要求的太多细节，所以这对您来说可能并不重要。

我一直在使用 Etherlab IgH 开源堆栈，它需要 root 权限才能加载实现底层堆栈的内核模块。完成后，您可以将其他所有内容设置为在没有 root 权限的情况下从用户空间运行。

一旦您的应用程序获得对主堆栈的访问权，您就设置了一个数据交换域（TwinCat 称之为任务），您将拥有一个可用于监控 EtherCAT 帧数据的共享内存区域。您的应用程序负责决定何时发送和接收域更新。

# android - executeMyFriendsRequestAsync 遇到问题

> ID：15991404
> 
> 赞同：1
> 
> 时间：2013-04-13T18:33:59.100
> 
> 标签：android, facebook

出于某种原因，即使我几乎完全从示例中复制了这段代码，我似乎也看不到我朋友的任何信息。我正在使用只有几个朋友的假帐户。有人可以告诉我可能出了什么问题吗？

```
Session.openActiveSession(this, true, new Session.StatusCallback() {
     @Override
     public void call(Session session, SessionState state, Exception exception) {
         if (session.isOpened()) {
         Request.executeMyFriendsRequestAsync(session, new Request.GraphUserListCallback() {
        @Override
    public void onCompleted(List<GraphUser> users, Response response) {
         Log.d("INFO", "on complete");
         Log.i("INFO", "" + users.toString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T04:44:10.543

```
final Runnable getFacebookUserInfo = new Runnable() {
    @Override
    public void run() {
        Request.executeMeRequestAsync(facebookConnector.getFacebook()
                .getSession(), new Request.GraphUserCallback() {
            @Override
            public void onCompleted(GraphUser user, Response response)
            {
                //...   
            }
        });

        Request.executeMyFriendsRequestAsync(facebookConnector.getFacebook()
                .getSession(), new Request.GraphUserListCallback() {
            @Override
            public void onCompleted(List<GraphUser> users, Response response) {
                if (users != null) {
                    List<String> friendsList = new ArrayList<String>();
                    for (GraphUser user : users) {
                        friendsList.add(user.getId());
                        //...
                    }
                }
            }
        });
} 
```

};

我认为它很有用。

# java - 为什么这个线程是安全的？

> ID：15991405
> 
> 赞同：0
> 
> 时间：2013-04-13T18:34:00.350
> 
> 标签：java, multithreading

因为它总是打印出'3'。不需要同步？我正在测试这个简单的东西，因为我在一个真正的多线程问题中遇到了麻烦，这不能很好地说明问题，因为它很大。这是展示情况的简化版本。

```
class Test {

public static int count = 0;

class CountThread extends Thread {

    public void run()
    {
        count++;
    }
}  

public void add(){
    CountThread a = new CountThread();
    CountThread b = new CountThread();
    CountThread c = new CountThread();

    a.start();
    b.start();
    c.start();

    try {
        a.join();
        b.join();
        c.join();
    } catch (InterruptedException ex) {
        ex.printStackTrace();
    }

}
public static void main(String[] args) {

    Test test = new Test();
    System.out.println("START = " + Test.count);

    test.add();

    System.out.println("END: Account balance = " + Test.count);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T18:38:25.353

> 因为它总是打印出'3'。不需要同步？

它不是线程安全的，你只是很幸运。如果你运行这个 1000 次，或者在不同的架构上，你会看到不同的输出——不是 3。

我建议使用`AtomicInteger`静态字段 ++ 而不是`synchronized`.

```
public static AtomicInteger count = new AtomicInteger();
...
public void run() {
    count.incrementAndGet();
}
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:37:14.440

在我看来，`count++`在您为其他班级调用“运行”之前，它的速度足以完成。所以基本上它是按顺序运行的。
但是，如果这是一个真实的例子，并且两个不同的线程`CountThread`并行使用，那么是的，你会遇到同步问题。

为了验证这一点，您可以尝试在 count++ 之前和之后打印一些测试输出，然后您将在完成之前查看是否`b.start()`正在调用。对.`count++``a.start()``c.start()`

考虑改用 AtomicInteger，这比尽可能同步要好得多 -

> **incrementAndGet**
> `public final int incrementAndGet()`
> 以原子方式将当前值加一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T18:44:04.160

此代码不是线程安全的：

```
public static int count = 0;

class CountThread extends Thread {

    public void run()
    {
        count++;
    }
} 
```

您可以在一个系统上运行此代码一百万次，并且每次都可能通过。这并不意味着它是线程安全的。

考虑一个系统，其中 in 的值`count`被复制到多个处理器缓存中。它们都可能在某些情况下强制将其中一个缓存复制回主 RAM 之前独立更新。考虑这`++`不是原子操作。读写的顺序`count`可能会导致数据丢失。

实现此代码的正确方法（使用 Java 5 及更高版本）：

```
public static java.util.concurrent.atomic.AtomicInteger count =
                                 new java.util.concurrent.atomic.AtomicInteger();

class CountThread extends Thread {

    public void run()
    {
        count.incrementAndGet();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T18:37:38.173

仅仅因为输出是正确的，它就不是线程安全的。创建线程会在操作系统方面造成大量开销，之后可以预期单行代码将在单个时间片内完成。无论如何它都不是线程安全的，只是没有足够的潜在冲突来实际触发一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-13T18:37:43.647

它不是线程安全的。

只是碰巧有机会展示这个问题。考虑计数到更高的数字（1000000？），`run`以增加多个线程上的 2 个操作重叠的机会。

还要确保您的机器不是单核 CPU...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-15T13:33:12.143

要使类线程安全，要么计数`volatile`以强制线程之间的内存围栏，要么使用*AtomicInteger*，或者像这样重写（我的偏好）：

```
class CountThread extends Thread {

    private static final Object lock = new Object();

    public void run()
    {
        synchronized(lock) {
            count++;
        }
    }
} 
```

# image - GAE blobstore 正在杀死我

> ID：15991428
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:36:35.370
> 
> 标签：image, google-app-engine, blob

我遵循了本教程： [https ://developers.google.com/appengine/docs/python/images/usingimages](https://developers.google.com/appengine/docs/python/images/usingimages)

它正在杀死我......我设法让它工作......但是我无法让它满足我的需求......问题是我想使用 json 序列化我的模型......

1.  为什么他们将 avatar = db.BlobProperty() 放入模型中而不使用对该 blob 的引用？...有什么理由吗？

2.  我找不到一个像样的教程，关于如何在 Blob 中存储图像，然后将其位置/键/引用存储在模型中。有什么建议吗？使用下面的代码......我正在做教程中的确切内容......我如何获得对该图片的引用，以及如何存储它？？？

    ```
    pic = self.request.get('img')
    pic = db.Blob(pic) 
    ```

我设法做的是将实体的 id 存储在 JSON 中，并使用该 id 来检索和显示图片。我用以下代码显示图片：

```
class Image(webapp2.RequestHandler):
def get(self):
    #product = db.get(self.request.get('img_id'))

    product = MenuProduct.by_id(int(self.request.get('img_id')))
    if product.small_pic:
        self.response.headers['Content-Type'] = 'image/png'
        self.response.out.write(product.small_pic)
    else:
        self.error(404) 
```

1.  我猜使用这种方法所有的效率都会下降......对吗？

抱歉，我的帖子听起来很乱……但我有点厌倦了与这个主题相关的“很棒”的糟糕文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:37:24.097

[您应该使用单独的Blobstore](https://developers.google.com/appengine/docs/python/blobstore/overview)服务并将[BlobKey](https://developers.google.com/appengine/docs/python/blobstore/blobkeyclass)存储在模型中，而不是将 Blob 存储为 BlobProperty 。

# php - PHP 使用 google geolocation api 使用地理位置提取和打印纬度和经度

> ID：15991433
> 
> 赞同：1
> 
> 时间：2013-04-13T18:37:03.847
> 
> 标签：php, google-maps-api-3

```
<?php echo $lat; ?>, 
<?php echo $lng; ?>) 
```

我正在尝试使用此页面中的代码使用谷歌在地图上方或下方的页面上获取坐标和 dprint， [http: //www.galengrover.com/projects/PHPGoogleMaps-Examples/geolocation.php](http://www.galengrover.com/projects/PHPGoogleMaps-Examples/geolocation.php)

我似乎不明白这是如何工作的。

```
require( '_system/autoload.php' );
$map_options = array(
'map_id'        => 'map23',
'draggable'     => true,
'center'        => 'San Diego, CA',
'height'        => '500px',
'width'         => '500px',
'zoom'          => 16,
'bicycle_layer' => true
);
$map = new \PHPGoogleMaps\Map( $map_options );

// 
$marker = \PHPGoogleMaps\Overlay\Marker::createFromUserLocation( array( 'geolocation_high_accuracy' => true, 'geolocation_timeout' => 10000 ) );

$map->addObject( $marker );

// If you want to set geolocation options you must call enableGeolocation() explicitly
// Otherwise it will be called for you when you use geolocation functions
$map->enableGeolocation( 5000, true );

// Set the loading content. This will display while the browser geolocates the user.
$map->setLoadingContent('<div style="background:#eee;height:300px;padding: 200px 0 0 0;text-align:center;"><img src="_images/loading.gif" style="display:block; margin: auto;"><p>Locating you...</p></div>'); ?>

<!DOCTYPE html>
<html lang="en">    
  <head>    
    <meta charset="utf-8">  
<title>Ground Overlays - 
  <?php echo PAGE_TITLE ?>
</title>    
<link rel="stylesheet" type="text/css" href="_css/style.css">       
<?php $map->printHeaderJS() ?>  
<?php $map->printMapJS() ?>
</head>
  <body><h1>Geolocation</h1>( 
    <?php require( '_system/nav.php' ) ?> 
<p>This example finds your location and centers the map on it. It also uses map::setLoadingContent() to display a loading message to the user.
</p>
<?php $map->printMap() ?>(
<?php echo $lat; ?>, 
<?php echo $lng; ?>) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:04:45.740

**编辑**

我编辑了代码来向您展示这一点。请参阅 geosuccess() 函数。它会提醒你的坐标。一切都存储在“this”中，因此如果您在谷歌浏览器中进入控制台并输入“this”，您将在那里看到所有数据。

```
<?php

// This is for my examples
require( '_system/config.php' );

// Autoload stuff
require( '_system/autoload.php' );

$map = new \PHPGoogleMaps\Map;

// 
$marker = \PHPGoogleMaps\Overlay\Marker::createFromUserLocation( array( 'geolocation_high_accuracy' => true, 'geolocation_timeout' => 10000 ) );

$map->addObject( $marker );

// If you want to set geolocation options you must call enableGeolocation() explicitly
// Otherwise it will be called for you when you use geolocation functions
$map->enableGeolocation( 5000, true );
$map->centerOnUser( \PHPGoogleMaps\Service\Geocoder::geocode('New York, NY') );
$map->setWidth('500px');
$map->setHeight('500px');
$map->setZoom(16);

// Set the callbacks
$map->setGeolocationFailCallback( 'geofail' );
$map->setGeolocationSuccessCallback( 'geosuccess' );

// Set the loading content. This will display while the browser geolocates the user.
$map->setLoadingContent('<div style="background:#eee;height:300px;padding: 200px 0 0 0;text-align:center;"><img src="_images/loading.gif" style="display:block; margin: auto;"><p>Locating you...</p></div>');
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Geolocation - <?php echo PAGE_TITLE ?></title>
    <link rel="stylesheet" type="text/css" href="_css/style.css">
    <?php $map->printHeaderJS() ?>
    <?php $map->printMapJS() ?>
    <script type="text/javascript">
    function geofail() {
        alert( 'geolocation failed' );
    }
    function geosuccess() {
        alert("Lat:" + this.geolocation.hb + " Long: " + this.geolocation.ib);
        //alert( 'geolocation succeeded' );
    }
    </script>
</head>
<body>

<h1>Geolocation</h1>
<?php require( '_system/nav.php' ) ?>

<p>This example finds your location and centers the map on it. It also uses map::setLoadingContent() to display a loading message to the user.</p>

<?php $map->printMap() ?>

</body>

</html> 
```

# python - 对 Python SMTP 客户端感到困惑

> ID：15991437
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:37:33.270
> 
> 标签：python, smtp, python-2.x

我正在尝试了解如何使用 Python 发送电子邮件。使用[Tutorial's Point](http://www.tutorialspoint.com/python/python_sending_email.htm)和[Stack Overflow](https://stackoverflow.com/q/10147455/1993598)中的脚本，我创建了一个[基本脚本](http://pastebin.com/jxV1kie4)，可以使用 Gmail 发送电子邮件。我对几行代码有几个问题。他们似乎正在与 Gmail 服务器通信。

```
server = smtplib.SMTP('smtp.gmail.com:587')
server.ehlo() 
```

是什么`server.ehlo`意思？它特定于gmail吗？

```
server.starttls() 
```

这是什么意思？

```
server.login(username,password)
server.sendmail(fromaddr, toaddrs, msg)
server.quit() 
```

是什么`server.quit()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:58:29.497

ehlo 是客户端和服务器端之间协议交换的一部分 ehlo 将客户端的名称提供给服务器

starttls 启动 SSL 套接字层的加密和身份验证

login 发送凭据，如 SMTP 规范中所述

sendmail 执行其他 SMTP 协议命令，mail from、rcpt to 和 data

quit 从服务器端发送关闭连接的命令

# plone - 克隆新手：网站看起来没有样式而不是 Sunburst

> ID：15991438
> 
> 赞同：2
> 
> 时间：2013-04-13T18:37:34.067
> 
> 标签：plone

我的网站使用了 Sunburst 主题，没有任何自定义样式表——最多我会更新徽标。久违了，我最近更新了徽标和首页。徽标已成功更新，但是发生了其他事情，现在该站点似乎没有样式。跳到内容/跳到导航文本链接（为了便于访问）出现在他们以前没有的顶部。

我检查了portal_skins/custom，但那里没有要删除的ploneCustom.css 文件，只有logo.png。我尝试将主题更改为 Classic，但它似乎也没有样式，所以我将其更改回 Sunburst。接下来我去了portal_skins/sunburst_styles并按下public.css和ploneCustom.css的自定义按钮，希望覆盖当前样式。即使样式文件已复制到 portal_skins/custom（我没有修改副本），该站点仍然显示为无样式。

请帮助一个研究生，他的偶尔任务是维护一个 Plone 站点（服务器正在运行 Plone 4。）服务器管理员不在一个会议上 - 具有 Plone 专业知识的前任服务器管理员去年秋天毕业，现在不在这个国家（也在同一个会议上。）我已经阅读了文档并搜索了类似的问题，但我无能为力。

对于如何恢复到默认的 Sunburst 主题样式，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:54:27.403

有时升级时似乎会应用“克隆经典主题”。在主题控制面板 ( `http://yoursite/@@skins-controlpanel`) 中，确保选择了“Sunburst”。

# youtube-api - YouTube 2.0 API 授权与 Google+ 页面

> ID：15991442
> 
> 赞同：1
> 
> 时间：2013-04-13T18:37:51.507
> 
> 标签：youtube-api, google-plus

我有一个使用 AuthSub 向 Google 进行身份验证并将视频上传到 YouTube 帐户的旧应用程序。当我将我的 YouTube 帐户链接到 Google+ 信息页时，我无法再将视频上传到该频道，因为我只能在 AuthSub 帐户选择器页面上选择 Google 帐户，而不能选择 Google+ 信息页。如何让我的应用通过 Google+ 信息页的身份验证？

相关 YouTube Google+ 集成社区帖子： https: [//plus.google.com/109134699638863873361/posts/AcqYTcrc4Go](https://plus.google.com/109134699638863873361/posts/AcqYTcrc4Go)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T14:34:56.607

推荐的做法是迁移到 OAuth 2。OAuth 2 支持通道选择器，允许您授权应用程序对您有权访问的任何通道发出请求，这些通道与您自己的 Google 帐户或通过 Google+ 信息页相关联。

我知道迁移到 OAuth 2 对某些开发人员来说可能需要一些时间，或者您可能不是开发人员，而是仍在使用 AuthSub 等传统授权流程的应用程序的用户。在这些情况下，您需要为与您的 Google+ 信息页关联的 Google 帐户分配一个密码，如[本帮助中心文章中所述](http://support.google.com/youtube/bin/answer.py?hl=en&answer=3046478)。使用 ClientLogin、OAuth 1 或 AuthSub 时，您需要提供您为 Google+ 信息页设置的 Google 帐户电子邮件地址和密码。

我们将在不久的将来在[YouTube API 博客上发布一些内容，更详细地讨论使用 +Page 频道的最佳实践。](http://apiblog.youtube.com/)

# xml - 无法从 GO 中的 XML 中提取正确的数据

> ID：15991443
> 
> 赞同：0
> 
> 时间：2013-04-13T18:37:54.673
> 
> 标签：xml, xml-parsing, go

我正在从 Web 检索一些 XML，但在提取所需数据时遇到问题。这是 XML：

```
<metadata xmlns="http://musicbrainz.org/ns/mmd-2.0#" xmlns:ext="http://musicbrainz.org/ns/ext#-2.0" created="2013-04-13T16:54:01.107Z">
    <artist-list count="2" offset="0">
        <artist id="35dac7d2-0b1f-470f-9a5a-c53c8821f6d6" type="Person" ext:score="100">
            <name>Eric Prydz</name>
            <sort-name>Prydz, Eric</sort-name>
            <gender>male</gender>
            <country>SE</country>
        </artist>
    </artist-list>
</metadata> 
```

我想提取姓名、性别和国家。这是代码：

```
package main

import (
    "encoding/xml"
    "fmt"
    "io/ioutil"
    "net/http"
)

func main() {
    client := &http.Client{}
    req, _ := http.NewRequest("GET", "http://www.musicbrainz.org/ws/2/artist/?query=artist:Fred", nil)
    res, _ := client.Do(req)

    bs, _ := ioutil.ReadAll(res.Body)

    var artist Artist
    xml.Unmarshal(bs, &artist)

    fmt.Printf("%#v\n", artist)
}

type Artist struct {
    Name    string `xml: "name"`
    Gender  string `xml: "gender"`
    Country string `xml: "country"`
} 
```

但每次我运行这个我总是得到这个：

```
main.Artist{Name:"", Gender:"", Country:""} 
```

有人能指出问题出在哪里吗？
谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T20:04:33.770

好的，问题是，您没有充分描述`xml`要解组的数据。您的数据看起来更像

```
struct metadata {
    // you need to tag it because go field names can't contain -'s
    artists []Artist "artist-list"
} 
```

像这样的东西应该工作。基本上`Unmarshal`就是只看顶层节点，而不是往下走找结构。

# javascript - jQuery dotdot 插件不起作用

> ID：15991444
> 
> 赞同：4
> 
> 时间：2013-04-13T18:38:01.960
> 
> 标签：javascript, jquery, css, xhtml, dotdotdot

我正在尝试使用 dotdotdot 插件在面板中显示评论列表，但结果并不令人振奋：

![注释](https://i.stack.imgur.com/2wWXy.png)

从下面的xhtml代码：

```
<li>
    <h:link value="#{Comment.commentAuthorName}: " id="goToProfileWithAuthorName"
            outcome="/profile.xhtml" type="submit"
            style="text-decoration:none;font-weight:bold;font-size: 11px;color: rgb(120,120,159);">
        <f:param name="userId" value="#{Comment.comauthorId}"/>
    </h:link>

    <div id="wrapper">
        #{Comment.commentText}
    </div>
    <br></br>
    <abbr class="timeago" title="#{Comment.commentDate}"
          style="color: #778899;font-size: 10px;">
    </abbr>

    <br/>
</li> 
```

以及下面的js代码：

```
$(document).ready(function() {
    $("#wrapper").dotdotdot({
        //  configuration goes here
    });
}) 
```

如果我解决了溢出问题，我也许可以解决垂直尺寸问题，但我猜想 dotdotdot 有一些不正确的地方。让我告诉你一件更奇怪的事情：

![dotdot2](https://i.stack.imgur.com/o3jP4.png)

如您所见，似乎 div(wrapper) 宽度值计算正确，但文本不断溢出。可能是什么原因？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-31T18:32:34.950

我遇到了类似的问题，最终我放弃了这个插件并开始使用这个 CSS：

```
text-overflow: ellipsis;
overflow: hidden;
white-space: nowrap; 
```

要使其工作，您必须定义`width`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-13T18:42:55.507

尝试这个

```
div#wrapper{
   word-wrap: break-word;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T18:51:44.800

根据你的截图，我猜你有不止一个`<div id="wrapper">`. 由于每页只能使用一次 ID，因此插件可能无法正确迭代它们。尝试将其更改为一个类`<div class="wrapper">`并将 JS 更新为：

```
$(document).ready(function() {
    $(".wrapper").dotdotdot({
        //  configuration goes here
    });
}) 
```

小提琴链接：http: [//jsfiddle.net/ryanbrill/RgHRs/](http://jsfiddle.net/ryanbrill/RgHRs/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T19:11:02.850

默认情况下，文本会在其容器内换行。如果您的文本没有换行，则存在一些导致它的 CSS，无论是直接的（例如，`white-space: nowrap`）还是间接的（例如，`position: absolute`）。如果您必须显式设置 CSS 属性才能恢复此默认行为，例如`word-wrap: break-word`，那么您必须有一些已经影响您的文本的 CSS 属性，因为这不是默认要求。

正如您在评论中所说，您有一个带有`position: absolute`, 的容器，它将破坏`dotdotdot`。

您可以通过将元素包装在另一个容器（在绝对定位的容器内）中来解决此问题，该容器的宽度设置为与容器相同的宽度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-03T23:47:40.090

在我的情况下，dotdotdot 不适用于元素，因为它们最初是不可见的，然后在选项卡选择后显示。所以我不得不将 dotdotdot 初始化移到某个`onTabShown`事件上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-13T20:11:18.783

**如果您指定字母级换行， dotdotdot.js**确实声称支持您所描述的字母级换行/中断：

```
$('.my_elements').dotdotdot({ wrap: 'letter' }); 
```

但是，实现似乎有问题。你可能需要不止一个词才能让它发挥作用。看这个例子：

[http://jsfiddle.net/pqz5b408/1/](http://jsfiddle.net/pqz5b408/1/)

# java - 即使我处理了异常并且文件确实存在，我仍然收到“FileNotFoundException”。

> ID：15991449
> 
> 赞同：2
> 
> 时间：2013-04-13T18:38:25.517
> 
> 标签：java, file, exception, exception-handling

```
Scanner read=new Scanner(file); 
```

此语句中出现异常“FileNotFoundException”。

```
 import java.util.*;
  import java.io.*;

  public class shoppingList {

        public static void main(String []args)throws IOException {

              File file=new File("MyList.txt");

              try {

                   if(file.exists()==false)
                    throw new FileNotFoundException("the file input doesn't exist");
              }
              catch(FileNotFoundException e){System.out.print(e.getMessage());}

              //I tried handling the exception but it didn't work

              Scanner read=new Scanner(file);

              File outfile=new File("MyReceipt.txt");
              FileOutputStream fos=new FileOutputStream(outfile);
              PrintWriter output=new PrintWriter(fos);

              while(read.hasNext()) {
                 String item=read.next();
                 double price=read.nextDouble();
                 String status=read.next();

                 output.println("My Receipt: ");
                 output.println("--------------------");

                 if(status.equals("Done")==true)
                    output.println(item+"  "+price);

                 double total=0;

                 total+=price;
                 output.println("--------------------");
                 output.println("total= "+total);
             }

             read.close();
             output.close();
      }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:47:34.457

问题是程序只是在 catch 语句之后继续。因此，即使您处理了抛出的第一个 FileNotFoundException，`file.exists`您也会得到第二个，`Scanner read=new Scanner(file);`而这个没有被处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:54:29.160

`new File("MyList.txt")`将尝试在当前目录中查找文件。

当前目录取决于程序运行的环境。例如，如果程序在 Eclipse IDE 中运行，则 Java 项目为当前目录。

尝试提供绝对路径。例如`C:\\workspace\\project\\MyList.txt`。

或者，将文件放在源代码树或包下，然后`InputStream`按类路径打开。例如，如果将其放在一个名为的包中，`my.foo.shopping`您可以直接创建一个`Scanner`，如下所示。

```
Scanner read=new Scanner(shoppingList.class.getResourceAsStream("/my/foo/shoppin/MyList.txt")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T18:45:18.237

抓到 后`FileNotFoundException`，您尝试读取另一个文件并抛出另一个`FileNotFoundException`

问题在于：

```
 Scanner read=new Scanner(file); 
```

解决方案是将所有代码放在 try 块中：

```
File file=new File("MyList.txt");

try{

    if(file.exists()==false)
         throw new FileNotFoundException("the file input doesn't exist");

       //i tried handling the exception but it didn't work

         Scanner read;
            read = new Scanner(file);

         File outfile=new File("MyReceipt.txt");
         FileOutputStream fos;
            fos = new FileOutputStream(outfile);

         PrintWriter output=new PrintWriter(fos);

         while(read.hasNext()){
            String item=read.next();
            double price=read.nextDouble();
            String status=read.next();

            output.println("My Receipt: ");
            output.println("--------------------");

            if(status.equals("Done")==true)
               output.println(item+"  "+price);

            double total=0;

            total+=price;
            output.println("--------------------");
            output.println("total= "+total);
         }
         read.close();
         output.close();
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-06T08:01:59.003

尝试使用文件类的 getAbsolutePath() 来查看您在哪个目录中工作，以及您的文件是否存在于同一目录中。否则考虑给出完整的路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-13T19:30:15.337

```
try {

               if(file.exists()==false)
                throw new FileNotFoundException("the file input doesn't exist");
          }
          catch(FileNotFoundException e){System.out.print(e.getMessage());}

          //I tried handling the exception but it didn't work

          Scanner read=new Scanner(file); 
```

这里的最后一行显示，在您的 try-catch 之外是您创建`Scanner read=new Scanner(file);`问题的地方，如果该文件不存在，则没有什么可以阻止扫描仪在尝试访问此文件时崩溃。

你应该把这条线`Scanner read=new Scanner(file);`放在你的 try-catch 里面，像这样：

```
 try {
            if(file.exists()){
                Scanner read=new Scanner(file);
            }
            else if(file.exists()==false)
                throw new FileNotFoundException("the file input doesn't exist");
            }
        } 
```

如果文件不存在，这应该可以防止您的程序崩溃。

# oracle - 获取存储过程的代码

> ID：15991451
> 
> 赞同：-4
> 
> 时间：2013-04-13T18:38:28.353
> 
> 标签：oracle, stored-procedures

我不知道如何在 ORACLE 中获取存储过程的源代码。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:39:27.543

使用以下语句：

```
select text from user_source
where name = 'SP_NAME'
order by line; 
```

# c# - 如何使用脚本创建xml文本并在场景中显示文本？

> ID：15991456
> 
> 赞同：2
> 
> 时间：2013-04-13T18:39:09.603
> 
> 标签：c#, unity3d

我需要创建一个 xml 文本文件并通过（使用框）使用脚本在场景中显示此文本？我创建了一个 xml 文本文件，即位于 c 驱动器中。请参阅我的以下代码并使用 C# 帮助我。下面的代码使用 ngui 标签。但是使用框显示很好。

```
using UnityEngine;
using System.Collections;
using System.Xml;
using System.IO;

public class Xml : MonoBehaviour 
{
    // Use this for initialization
    void Start () 
    {
        XmlDocument xml=new XmlDocument();
        xml.Load(Application.dataPath+"/Resources/text.xml");
    }

    // Update is called once per frame
    void Update () { }

    void OnGUI()
    {
        UILabel subtitle = GameObject.Find("Label").GetComponent();
        subtitle.text = "";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:55:53.367

如果您只想要 XML 文件中的文本，您不能只使用阅读器的[InnerXml](http://msdn.microsoft.com/en-gb/library/system.xml.xmldocument.innerxml.aspx)属性吗？您需要将 XmlDocument 移动为行为的成员变量，这样您就可以访问 OnGUI 中的文本，而无需在每一帧都重新加载它。

```
subtitle.text = xml.InnerXml; 
```

如果您想做一些更复杂的事情，请查看[XMLDocument](http://msdn.microsoft.com/en-gb/library/system.xml.xmldocument.aspx)的方法以了解如何浏览 XmlFile

# android - ActionBar Sherlock 如何将导航模式重置为默认值

> ID：15991459
> 
> 赞同：0
> 
> 时间：2013-04-13T18:39:24.197
> 
> 标签：android, actionbarsherlock

我正在使用主要活动具有 NAVIGATION_MODE_LIST 的 Action Bar sherlock。

```
 mLocations = getResources().getStringArray(R.array.locations);
    Context context = getSupportActionBar().getThemedContext();
            ArrayAdapter<CharSequence> list = ArrayAdapter.createFromResource(
                context, R.array.locations, R.layout.sherlock_spinner_item);
    list.setDropDownViewResource(R.layout.sherlock_spinner_dropdown_item);

    getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
    getSupportActionBar().setListNavigationCallbacks(list, this); 
```

导航列表中的每个项目都会打开新活动。按下 BACK 按钮后，您将返回主要活动。问题是，导航列表保留了先前的选择。

例如导航列表有：Home、Menu 1、Menu 2 如果您选择 Manu 1，则会出现新活动。然后按回，显示主要活动，但导航列表已选择“菜单 1”。所以它不可能再次进入菜单 1。需要选择主页，而不是再次菜单 1.如何解决？

请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T02:46:15.223

相信在 Home Activity 中，只需要在 onResume 事件中设置菜单项即可

```
 protected void onResume(final int actId) {
    super.onResume();

    getSupportActionBar().setSelectedNavigationItem(0);
} 
```

# javascript - 时间字符串上的 Javascript split()

> ID：15991479
> 
> 赞同：4
> 
> 时间：2013-04-13T18:41:07.427
> 
> 标签：javascript, arrays, string, split

我有一个可以采用以下格式的字符串（数字是示例）：

```
2h34m2s
23m6s
7h8s
4h2m
3h
2m
2s 
```

我最初打算只使用`split()`正则表达式来匹配`h`,`m`和`s`. 但是，如果只有一些指标存在（如果它的形式是`2m3s`，那么我需要一种方法来知道数组中的第一个条目代表分钟而不是小时）。

我认为正确的解决方案将涉及某种正则表达式，但它目前使我无法理解。任何关于清洁高效解决方案的想法？

编辑：

（我想接受任意数量的数字，所以我没有`{1,2}`在正则表达式中使用。

```
var timeString = $('#interval').val();
var hours = timeString.match('/\d+(?=h)/')[0];     // 2h4m8s
var minutes = timeString.match('/\d+(?=m)/')[0];
var seconds = timeString.match('/\d+(?=s)/')[0];
console.log('hours: ' + hours);
console.log('minutes: ' + minutes);
console.log('seconds: ' + seconds); 
```

控制台正在给出`null`这些值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:45:20.940

您可以使用以下正则表达式：

`\d+(?=m)`几分钟，

`\d+(?=h)`几个小时，和

`\d+(?=s)`几秒钟。

您可能应该进行不区分大小写的匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:53:35.097

```
var string = "23h4m"
var regexp = /(\d+h)?(\d+m)?(\d+s)?/;
var result = string.match(regexp) // gives you ["23h4m", "23h", "4m", undefined] 
```

您可以使用`result[1]`小时、`result[2]`分钟和`result[3]`秒来访问结果。如果没有给出，这些值是未定义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T18:48:32.430

您可以在此处使用具有正面预测的正则表达式：

```
/\d{1,2}(?=h)/ 
```

将匹配小时：后跟字母时的一位或两位数字`h`。类似于`m`和`s`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T19:07:19.517

```
//match any digits and include the letters

var rx=/((\d+)(h|m|s))/g;    

//test:
var str1='2h34m2s',str2='23m6s';

str1+'=\n\t'+str1.match(rx).join(':\n\t')+'\n'+
str2+'=\n\t'+str2.match(rx).join(':\n\t')
//returns

2h34m2s=
    2h:
    34m:
    2s
23m6s=
    23m:
    6s 
```

# android - Android - 使用 RESTful api 将数据写入数据库

> ID：15991481
> 
> 赞同：0
> 
> 时间：2013-04-13T18:41:30.767
> 
> 标签：android, json, rest, http-post, restful-architecture

我是一名初学者 Android 程序员，我正在开发一个程序，该程序从本机设备电话簿中读取联系人并将其写入数据库 ( )。

我可以从我的手机获取和读取联系人，但我被困在“将联系人写入数据库”。这是我必须遵循的准则：

```
write function: 
write: 
[{'activity':'writeData', 
  'firstname':'Janis', 
  'lastname':'Berzins', 
  'telnr': '12312312'}]

request should be sent as: [{'activity':'readData'}]

example for read: [{"firstname":"Vards","lastname":"Uzvards","telnr":"12345678"},{"firstname":"Viesturs","lastname":"Lapsa","telnr":"11223344"}] 
```

我研究了无数教程、文档等，花了四天时间，这就是我认为应该用于发送到数据库部分的内容：

```
public static HttpResponse doPost(String url, JSONObject c) throws ClientProtocolException, IOException 
{
    HttpParams httpParams = new BasicHttpParams();
    HttpClient httpclient = new DefaultHttpClient(httpParams);
    HttpPost request = new HttpPost(url);
    StringEntity s = new StringEntity(c.toString());
    s.setContentEncoding("UTF-8");
    s.setContentType(new BasicHeader(HTTP.CONTENT_TYPE,"application/json"));

    request.setEntity(s);
    request.addHeader("accept", "application/json");

    return httpclient.execute(request);
} 
```

为了创建一个简单的测试 Json，我使用了这个类：

```
 public class RestPost extends AsyncTask<String, Void, String>
{
    @Override
    protected String doInBackground(String... params) {
        JSONObject json = new JSONObject();

        try
        {
            json.put("activity", "writeData");
            json.put("firstname", "Janis");
            json.put("lastname", "Berzins");
            json.put("telnr", "123123123");

            RestMethods.doPost(Main.server, json);
        }

        catch (JSONException e)
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
            Log.i("Error: ", e.toString());
        }
        catch (ClientProtocolException e)
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
            Log.i("Error: ", e.toString());
        }
        catch (IOException e)
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
            Log.i("Error: ", e.toString());
        }
        Log.i("DONE ", " I GUES");
        return null;
    }
} 
```

但是在我的 Android 应用程序执行此功能后 - 数据库 () 中没有任何变化。

所以，拜托，谁能帮我弄清楚，我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:49:28.843

您需要一个 json 数组（请参阅规范中 json 周围的“[”和“]”字符。

```
 JSONArray jsonArray = new JSONArray();
    // your code to create the JSONObject
    // ...
    jsonArray.put(json);

    // use this within your RestMethods call
    RestMethods.doPost(Main.server, jsonArray); 
```

您可能可以一次将多个对象发送到服务器 - 即使“规范”没有提到它，但使用数组是一个提示，您可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:35:59.237

好的，我可以将它发送到数据库！:) 现在我正在使用 Get 方法.. 这就是我得到的 - 现在它似乎不起作用，可能是因为数据库中的数据是作为 JSONArray 发送的？

```
public static JSONObject doGet(String url)
{
    JSONObject json = null;

    HttpClient httpclient = new DefaultHttpClient();
    HttpGet httpget = new HttpGet(url); 

    httpget.addHeader("accept", "application/json");
    HttpResponse response;

    try {
        response = httpclient.execute(httpget);
        HttpEntity entity = response.getEntity();    

        if (entity != null) 
        {
            InputStream instream = entity.getContent();
            String result= convertStreamToString(instream);
            json=new JSONObject(result);     
            instream.close();
        }   
    } 

    catch (ClientProtocolException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
        Log.i("Error: ", e.toString());
    } 
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
        Log.i("Error: ", e.toString());
    } 

    catch (JSONException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
        Log.i("Error: ", e.toString());
    }        

    return json;
}

public static String convertStreamToString(InputStream is) {

    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();

    String line = null;
    try 
    {
        while ((line = reader.readLine()) != null) 
        {
            sb.append(line + "\n");
        }
    } 
    catch (IOException e) 
    {
        e.printStackTrace();
        Log.i("Error: ", e.toString());
    } 
    finally 
    {
        try 
        {
            is.close();
        } 
        catch (IOException e) 
        {
            e.printStackTrace();
        }
    }
    return sb.toString();
} 
```

# redirect - 如何保护查询字符串/POST 详细信息给第三方

> ID：15991484
> 
> 赞同：0
> 
> 时间：2013-04-13T18:41:39.493
> 
> 标签：redirect, iframe, asp.net-mvc-4, proxy

我基本上是在查看父页面和带有第三方链接的 iframe 之间的安全问题。

我想向第三方发送一个 POST 或一个 GET（不管我可以控制哪一方），但不公开其中的任何细节（比如 SID 或用户令牌）并拥有它的 HTML 内容（ JS/HTML/Images) 加载到 iframe 中。

我已经查看了服务器端重定向，使用 webclinet/webresponse 创建了一个代理，并且很好奇是否有一个好的方法来做到这一点。

以前有没有人这样做过，或者认为安全性是不可能的？地狱，即使我在如何解决这个问题上找错了树。

如果有人对此有任何示例，将不胜感激。

干杯，杰米

[编辑] 在想我可能需要添加更多细节。

假设我有一个父页面：[https](https://mycompany.com/ShowThirdParty) ://mycompany.com/ShowThirdParty 。

目前其中有一个 iframe，其中包含另一个组件的内容（也归我所有，或者更具体地说是另一个团队拥有）

基本上我想以外部页面无法读取的方式向 iframe 中的内容发送一些凭据，将 iframe 放入模式中（我已经这样做了）并且 iframe 具有受限内容auhtentication 几乎无缝且不可见。

我目前将它作为通过 JS 动态生成的 GET url 工作，然后传递给 iframe src 参数，显然这不安全。

我有点想要某种跨完整 url 的服务器端重定向，但我什至不认为这是可能的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T12:13:26.860

它也可以通过 POST 方法（使用 POST 将数据提交到 iFrame）来完成，因为它是 HTTPS，因此您发送到 iFrame 的数据是加密的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:52:00.487

您可以尝试使用 AJAX 并加载一个 PHP 脚本（带有对脚本进行编码/加密的任何参数）来查询第 3 方页面并将响应加载到 iframe 中。不太确定您的代码是如何设置的，但应该有办法。

# php - 如何让mysql查询忽略值？

> ID：15991494
> 
> 赞同：-2
> 
> 时间：2013-04-13T18:42:40.080
> 
> 标签：php, mysql

我有这个 mysql 查询，$B 和 $C 的值来自下拉菜单，我如何添加一个被这个查询忽略的值，或者我怎样才能使这个查询成为一个常量值？换句话说，我需要一个会抛出所有结果的值，例如此查询中不存在 B='$B' 和 C='$C'

```
 select * from TABLE where A like '%$name%' AND B='$B' AND C='$C' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T20:03:55.253

如果我正确理解您的问题，您可以使用如下查询：

```
SELECT *
FROM table
WHERE
  A like '%$name%' AND
  ((B='$B' AND C='$C') OR '$B'='all_values') 
```

如果您将 $B 的值设置为`'all_values'`，则此查询将返回满足第一个条件 ( `A LIKE '%$name%'`) 的所有行，而忽略第二个条件 ( `B='$B' AND C='$C'`)，因为 OR。

# c++ - Poco c++Net：Http 从响应中获取标头

> ID：15991496
> 
> 赞同：4
> 
> 时间：2013-04-13T18:42:58.807
> 
> 标签：c++, http, http-caching, poco-libraries

我为 http 使用 POCO C++ Net 库

我想尝试为持久缓存制定策略。

首先，我认为我需要从缓存标头中获取过期时间并与缓存值进行交叉检查（如果我错了，请告诉我）。

那么如何从中提取缓存标头`httpResponse`？

我已经看到您可以在 Java 中执行此操作，( [`getFirstHeader()`](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/HttpResponse.html))，但是如何在 POCO C++ 中执行此操作？

下面是一个使用 POCO 的普通 http GET 请求：

```
try
{
    // prepare session
    URI uri("http://www.google.se");
    HTTPClientSession session(uri.getHost(), uri.getPort());

    // prepare path
    string path(uri.getPathAndQuery());
    if (path.empty()) path = "/";

    // send request
    printnet(path.c_str());
    HTTPRequest req(HTTPRequest::HTTP_GET, path, HTTPMessage::HTTP_1_1);
    session.sendRequest(req);

    // get response
    printnet("Get response");

    HTTPResponse res;
    cout << res.getStatus() << " " << res.getReason() << endl;

    // print response
    istream &is = session.receiveResponse(res);
    StreamCopier::copyStream(is, cout);
}
catch (Exception &ex)
{
    printnet(ex.displayText().c_str());
    return -1;
}
return 0; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T23:15:02.650

> 那么如何从 httpResponse 中提取缓存头呢？

```
res.get("Cache-control"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T19:13:12.773

在最后一个`try`块中，可以添加以下内容以将标题打印到屏幕上：

```
cout << "RESPONSE:";
string name;
string value;
NameValueCollection::ConstIterator i = res.begin();
while(i!=res.end()){

    name=i->first;
    value=i->second;
    cout << name << "=" << value << endl << flush;
    ++i;
} 
```

# django - django 表单选择字段的初始值被忽略

> ID：15991501
> 
> 赞同：13
> 
> 时间：2013-04-13T18:43:23.477
> 
> 标签：django, forms, django-templates, choice

我有这个表格：

```
class UserUsesSourceForm(forms.Form):
    # some fields here
    username = forms.CharField(label=("Username"), max_length=30, help_text = ("Required"))
    provider = forms.ChoiceField(widget=forms.Select(), choices=SOURCES_CHOICES, initial=SOURCES_CHOICES[1]) 
```

可用的选择是：

```
E = 'e'
A = 'a'
SOURCES_CHOICES = (
                  (A, 'A'),
                  (E, 'E'),
                  ) 
```

风景：

```
form = UserUsesSourceForm(initial={"username":request.user.username, 'provider':SOURCES_CHOICES[1]})return render_to_response('update_datasource.html', context_instance=RequestContext(request, params)) 
```

和模板：

```
<form action="" method="post">
    {% csrf_token %}
    {% if form.non_field_errors %}
    <p>
        {% for error in form.non_field_errors %}
            <div class="text-error">{{ error|escape }}</div>
        {% endfor %}
    </p>
    {% endif %}
    <div class="control-group">

        <label class="control-label" for="id_provider">Data source</label>
        <div class="controls">
            {{form.provider}}
        </div>
                </div>
</form> 
```

问题是即使初始值设置正确，并且我可以在调试中测试它（即表单“提供者”字段初始值是我想要的元组），最终的html总是显示选择框中的第一个元素：

```
<select name="provider" id="id_provider">
<option value="A">A</option>
<option value="E">E</option>
</select> 
```

..虽然我希望它有一个“默认”或“活动”选项。请注意，**用户名字**段已正确初始化。如何进一步调查以找出问题所在？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-13T19:37:17.920

您需要`option`在数据中传递值而不是元组`initial`：

```
form = UserUsesSourceForm(
    initial={'username':request.user.username,
             'provider':SOURCES_CHOICES[1][0]}) 
```

# python - pyzmq 用自己的套接字创建一个进程

> ID：15991504
> 
> 赞同：1
> 
> 时间：2013-04-13T18:43:38.033
> 
> 标签：python, zeromq, python-multithreading, pyzmq

我有一些代码正在监视其他一些更改的文件，我想做的是启动使用 zeromq 和不同套接字的代码，我现在这样做的方式似乎导致断言在 libzmq 的某个地方失败，因为我可能正在重用同一个插座。我如何确保当我从监视器类创建一个新进程时，上下文不会被重用？这就是我认为正在发生的事情，如果您能说我还有其他愚蠢之处，请告知。这是一些代码：

```
import zmq
from zmq.eventloop import ioloop
from  zmq.eventloop.zmqstream  import ZMQStream
class Monitor(object):
    def __init(self)
        self.context = zmq.Context()
        self.socket = self.context.socket(zmq.DEALER)
        self.socket.connect("tcp//127.0.0.1:5055")
        self.stream =  ZMQStream(self._socket)
        self.stream.on_recv(self.somefunc)

    def initialize(self,id)
        self._id = id

    def somefunc(self, something)
        """work here and send back results if any """
        import json
        jdecoded = json.loads(something)
        if self_id == jdecoded['_id']
           """ good im the right monitor for you """
           work = jdecoded['message']
           results  = algorithm (work)
           self.socket.send(json.dumps(results))
        else:
           """let some other process deal with it, not mine """
           pass

 class Prefect(object):
    def __init(self, id)
        self.context = zmq.Context()
        self.socket = self.context.socket(zmq.DEALER)
        self.socket.bind("tcp//127.0.0.1:5055")
        self.stream =  ZMQStream(self._socket)
        self.stream.on_recv(self.check_if)
        self._id = id
        self.monitors = []
    def check_if(self,message):
        """find out from message's id whether we have
            started a proces for it previously"""
        import json
        jdecoded = json.loads(message)
        this_id = jdecoded['_id']
        if this_id in self.monitors:
            pass
        else:
            """start new process for it should have its won socket """
            new = Monitor()
            import Process
            newp = Process(target=new.initialize,args=(this_id) )
            newp.start()
            self.monitors.append(this_id) ## ensure its remembered 
```

发生的事情是我想要所有的监控进程和一个单一的高级进程在同一个端口上监听，所以当高级工程师看到一个它没有看到它的请求时，它会为它启动一个进程，所有存在的进程可能也应该监听但是忽略不适合他们的消息。就目前而言，如果我这样做，我可能会遇到一些崩溃，这可能与某些东西对同一个 zmq 套接字的并发访问有关（我尝试过 threading.thread，仍然崩溃）我在某处读到不同线程对 zmq 套接字的并发访问是不可能的. 我将如何确保新进程获得自己的 zmq 套接字？

编辑：我的应用程序中的主要交易是请求通过 zmq 套接字进入，并且正在侦听的进程通过以下方式对消息作出反应：

```
1\. If its directed at that process judged by the _id field, do some reading on a file and reply since one of the monitors match the messages _id, if none match, then:
2  If the messages _id files is not recognized, all monitors ignore it but the Prefect creates a process to handle that _id and all future messages to that id.
3\. I want all the messages to be seen by the monitor processes as well as the prefect process, seems that seems easiest, 
4\. All the messages are very small, avarage ~4096 bytes.   
5\. The monitor does some non-blocking read and for each ioloop it sends what it has found out 
```

more-edit=> 并且完美进程现在绑定，它将接收消息并回显它们，以便监视器可以看到它们。这就是我的想法，作为架构，但它不是最终的。.

所有消息都通过浏览器从远程用户到达，让服务器知道客户端想要什么，服务器通过 zmq 将消息发送到后端（我没有显示这个，但并不难）所以在生产中它们可能不会绑定/连接到本地主机。我选择了 DEALER，因为它允许任意方向的异步/无限消息（见第 5 点。）并且 DEALER 可以与 DEALER 绑定，并且初始请求/回复可以从任何一方到达。另一个可以做到这一点的可能是 DEALER/ROUTER。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T20:49:10.847

您是正确的，您不能在分叉边界上继续使用相同的套接字（多处理使用分叉）。一般来说，这意味着您不想创建将在分叉进程中使用的套接字，直到子进程启动之后。由于在您的情况下，套接字是 Monitor 对象的一个​​属性，因此您根本不想在主进程中创建 Monitor。看起来像这样：

```
def start_monitor(this_id):
    monitor = Monitor()
    monitor.initialize(this_id)
    # run the eventloop, or this will return immediately and destroy the monitor

... inside Prefect.check_if():

    proc = Process(target=start_monitor, args=(this_id,))
    proc.start()
    self.monitors.append(this_id) 
```

而不是您的示例，子进程唯一要做的就是分配一个 ID，然后终止该进程，最终没有任何效果。

# php - 通过输入可编辑 preg_match_all

> ID：15991505
> 
> 赞同：1
> 
> 时间：2013-04-13T18:43:52.983
> 
> 标签：php, preg-match-all

嗨，我怎样才能使 preg_match_all 可编辑

```
preg_match_all('{(".$limit.")}i',$content,$matches);

<input type="text" size="30" name="limit" id="limit" value="" /> 
```

所以如果我想搜索一个不同的字符串，我只需要在输入表单中输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:49:47.660

1.  您对表达式字符串使用了错误的引号
2.  您以错误的方式使用表达式分隔符，它必须是一个字符（*而不是*'{' 和 '}'）。
3.  您应该使用[preg_quote()](http://php.net/manual/en/function.preg-quote.php)作为输入转义正则表达式语法使用的特殊字符。
4.  如果您还没有完成，请`$limit`从超全局数组中检索。`$_GET`

```
if (isset($_GET['limit'])) {
  $limit = preg_quote($_GET['limit'], '%');
  preg_match_all('%('.$limit.')%i',$content,$matches);
} 
```

您还需要一个表单来提交值 - 正如 HamZa 在评论中所说：

```
<form action="this-script.php" method="get">
  <input type="text" size="30" name="limit" id="limit" value="" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-24T16:08:43.163

如果你经常在你的模式中使用用户输入，你可以看看[T-Regx 工具](https://t-regx.com)，它有一个模式构建器！并且还有自动分隔符

```
$pattern = Pattern::inject('%(@limit)%', [
    'limit' => $_GET['limit']
]);

$pattern->match($string)->forEach(function (Match $m) {
    // do something with $m
}); 
```

[`Pattern::inject()`](https://t-regx.com/docs/pattern-building)（或[`Pattern::prepare()`](https://t-regx.com/docs/pattern-building)）将引用任何用户输入。

# java - 无法从 XML 中提取数据

> ID：15991511
> 
> 赞同：0
> 
> 时间：2013-04-13T18:44:28.747
> 
> 标签：java, xml, jsoup

我使用 getElementBytag 方法从以下 XML 文档中提取数据（雅虎财经新闻 api [http://finance.yahoo.com/rss/topfinstories](http://finance.yahoo.com/rss/topfinstories)）

* * *

我使用以下代码。它使用 getelementsBytag 方法获取新项目和标题没有问题，但由于某种原因，在按标签搜索时不会拾取链接。它只获取链接元素的结束标签。是 XML 文档的问题还是 jsoup 的问题？

```
import java.io.IOException;         
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;   

class GetNewsXML {
    /**
     * @param args
     */
    /**
     * @param args
     */
    public static void main(String args[]){
        Document doc = null;
        String con = "http://finance.yahoo.com/rss/topfinstories";
        try {
            doc = Jsoup.connect(con).get();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        Elements collection = doc.getElementsByTag("item");// Gets each news item
        for (Element c: collection){
            System.out.println(c.getElementsByTag("title"));
        }
        for (Element c: collection){
            System.out.println(c.getElementsByTag("link"));
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T18:01:31.230

你得到`<link /> http://...`; 链接作为文本节点放在-tag之后*。*`link`

但这不是问题：

```
final String url = "http://finance.yahoo.com/rss/topfinstories";

Document doc = Jsoup.connect(url).get();

for( Element item : doc.select("item") )
{
    final String title = item.select("title").first().text();
    final String description = item.select("description").first().text();
    final String link = item.select("link").first().nextSibling().toString();

    System.out.println(title);
    System.out.println(description);
    System.out.println(link);
    System.out.println("");
} 
```

**解释：**

```
item.select("link")  // Select the 'link' element of the item
    .first()         // Retrieve the first Element found (since there's only one)
    .nextSibling()   // Get the next Sibling after the one found; its the TextNode with the real URL
    .toString()      // Get it as a String 
```

通过您的链接，此示例打印所有元素，如下所示：

```
Tax Day Freebies and Deals
You made it through tax season. Reward yourself by taking advantage of some special deals on April 15.
http://us.rd.yahoo.com/finance/news/rss/story/SIG=14eetvku9/*http%3A//us.rd.yahoo.com/finance/news/topfinstories/SIG=12btdp321/*http%3A//finance.yahoo.com/news/tax-day-freebies-and-deals-133544366.html?l=1

(...) 
```

# ruby-on-rails - Rails 中的电子邮件模型和电子邮件列冲突

> ID：15991512
> 
> 赞同：0
> 
> 时间：2013-04-13T18:44:36.660
> 
> 标签：ruby-on-rails, email, database-design

我有一个**提交者**模型，它有一个**电子邮件**列。我还有一个**电子邮件**模型，其中包含电子邮件**后缀**列。

我的问题（我相信）是因为我的提交者模型有一个电子邮件列，当我尝试使用`submitter.email.suffix`在我的电子邮件模型中显示后缀时，它说没有定义的方法。

知道我可以在这里做什么吗？

看法：

```
<% @submitters.each do |submitter| %>  <tr>
<td><%= submitter.school.name %></td>
<td><%= submitter.first_name %></td>
<td><%= submitter.last_name %></td>
<td><%= submitter.email %><%= submitter.email.suffix %></td>
<td><%= link_to 'Show', submitter %></td>
<td><%= link_to 'Edit', edit_submitter_path(submitter) %></td>
<td><%= link_to 'Destroy', submitter, method: :delete, data: { confirm: 'Are you sure?' } %></td>
</tr>
<% end %>
</table> 
```

作为旁注，我没有问题显示电子邮件后缀的 ID，但显然我试图显示实际的后缀：

```
<td><%= submitter.email %><%= submitter.email_suffix_id %></td> 
```

**Submitter.rb**有一个`has many :emails`，**Email.rb**有一个`belongs_to :submitter`关联。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:04:26.447

所以让我们分解一下。你说你想做

```
submitter.email.suffix 
```

但是，您的模型没有这样的`:email`关联。相反，您已经声明您的`Submitter`模型具有

```
has_many :emails 
```

这意味着：

1.  要在某个实例上打印`:email`属性，请使用`Submitter``submitter`

    ```
    puts submitter.email 
    ```

2.  要打印与您的关联相关的每个实例的`:prefix`属性，您需要遍历它们`Email``submitter``has_many`

    ```
    submitter.emails.each do |e|
      puts e.suffix
    done 
    ```

目前还不清楚你到底**想做**什么，但希望这能消除你的一些困惑；**到目前为止没有方法命名冲突**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T21:22:38.833

`submitter.email.suffix`不起作用，因为它返回 Submitter "email" 这是一个字符串，而不是 Email 实例。

```
submitter.emails.each(&:suffix) 
```

应该管用。`submitter.emails`将返回一个电子邮件的实例，它们确实有`suffix`方法（根据你的话）。

# ios - 切换到另一个视图，IOS

> ID：15991513
> 
> 赞同：0
> 
> 时间：2013-04-13T18:44:38.800
> 
> 标签：ios

我是编码世界的新手，但正在开发一个应用程序。我设置了代码，因此需要密码，但我希望它进入我的下一个视图，即拍照。如果这是一个愚蠢的问题，我很抱歉，但我需要帮助。

TestViewController.m 文件

```
#import "TestViewController.h"

@interface TestViewController ()

@end
@implementation TestViewController

- (IBAction)enterpassword
{
    NSString *passwordString = [NSString stringWithFormat:@"1234"];

    if ([passwordfield.text isEqualToString:passwordString]) {
        // Password is correct
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Correct Password" message:@"Password is Correct." delegate:self cancelButtonTitle:@"Enter" otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
    else {
        // Password is incorrect
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Incorrect Password" message:@"Password is Incorrect." delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
        [alert show];
        [alert release];

    }

}
- (void)viewDidLoad

{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)dealloc {
    [actionSeat release];
    [super dealloc];
}

@end

@implementation PhotoAppViewController
@synthesize imageView,choosePhotoBtn, takePhotoBtn;

-(IBAction) getPhoto:(id) sender {
    UIImagePickerController * picker = [[UIImagePickerController alloc] init];
    picker.delegate = self;

    if((UIButton *) sender == choosePhotoBtn) {
        picker.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;
    } else {
        picker.sourceType = UIImagePickerControllerSourceTypeCamera;
    }

    [self presentModalViewController:picker animated:YES];
}

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
    [picker dismissModalViewControllerAnimated:YES];
    imageView.image = [info objectForKey:@"UIImagePickerControllerOriginalImage"];
}

/*
 // The designated initializer. Override to perform setup that is required before the view is loaded.
 - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
 if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
 // Custom initialization
 }
 return self;
 }
 */

/*
 // Implement loadView to create a view hierarchy programmatically, without using a nib.
 - (void)loadView {
 }
 */

/*
 // Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
 - (void)viewDidLoad {
 [super viewDidLoad];
 }
 */

/*
 // Override to allow orientations other than the default portrait orientation.
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
 // Return YES for supported orientations
 return (interfaceOrientation == UIInterfaceOrientationPortrait);
 }
 */

- (void)didReceiveMemoryWarning {
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

- (void)viewDidUnload {
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)dealloc {
    [super dealloc];
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:53:53.760

您需要创建视图控制器，然后将其推送，或者您可以以模态方式呈现它。

像这样：

```
 if ([passwordfield.text isEqualToString:passwordString]) {
        // Password is correct

    PhotoAppViewController *viewController = [[[PhotoAppViewController alloc] init] autorelease];
        [self pushViewController:PhotoAppViewController animated:YES];

    }
    else {
        // Password is incorrect
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Incorrect Password" message:@"Password is Incorrect." delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
        [alert show];
        [alert release]; 
```

您真的不需要发出警报说密码正确......只要让它工作。

# mysql - 将查询混合在一起

> ID：15991514
> 
> 赞同：0
> 
> 时间：2013-04-13T18:44:39.260
> 
> 标签：mysql, coldfusion

我在 ColdFusion 中制作了一个使用不同 MySQL 表的聊天脚本。一个是存储对话的地方，另一个是定义谁开始对话和谁接收对话的地方。

现在，我制作了一个脚本，让您可以与某人一起聊天。发送消息时，它会在 MySQL 表中添加一行，其中包含时间戳、消息 ID、发送消息的用户 ID 和消息本身。整个对话显示在这段代码中：

```
// Get all conversations started by the user that is signed in 
<cfquery name = "Friendship" datasource = "#DSN#">
    SELECT *
    FROM  `conversations`
    WHERE  `user_one` LIKE  '#user.id#'
    ORDER BY  `conversations`.`lastmessage` DESC
</cfquery>

// Get all conversations started by others but receiver is the user that is signed  in                                                                                  
<cfquery name = "FriendshipBack" datasource = "#DSN#">
    SELECT *
    FROM  `conversations`
    WHERE  `user_two` LIKE  <cfqueryparam value="#user.id#" cfsqltype="cf_sql_integer">
    ORDER BY  `conversations`.`lastmessage` DESC
</cfquery>

// OUTPUT - conversations that I began
<cfoutput query="Friendship">
    // This code translates a user id into a name
    <cfquery name = "FriendshipToUsername" datasource = "#DSN#">
        SELECT *
        FROM users
        WHERE id = '#user_two#'
    </cfquery>

    <cfif IsDefined("FriendshipToUsername.username")>
        <cfif IsDefined('URL.chat') and URL.chat neq "">
        </cfif>                

       // Display username 
      <h3>#FriendshipToUsername.username#</h3>
    </cfif>

</cfoutput>

/// OUTPUT - conversations that I received
<cfoutput query="FriendshipBack">
    // This query translates a user id into a name
    <cfquery name = "FriendshipToUsernameBack" datasource = "#DSN#">
        SELECT *
        FROM users
        WHERE id = <cfqueryparam value="#user_one#" cfsqltype="cf_sql_integer">
    </cfquery>

    <cfif IsDefined('URL.chat') and URL.chat neq "">
    </cfif>                
    // Display username 

    <h3>#FriendshipToUsernameBack.username</h3>
</cfoutput> 
```

此时聊天列表分为两类：一类是登录用户开始对话的列表，另一类是登录用户收到其他人的对话的列表。问题是，我不希望它以这种方式显示，所以我想将两个列表混合在一起并根据时间戳（从最新到最旧）列出它们

此时聊天列表分为两类：一类是登录用户开始对话的列表，另一类是登录用户收到其他人的对话的列表。问题是，我不希望它以这种方式显示，所以我想将两个列表混合在一起并根据时间戳（从最新到最旧）列出它们

有什么办法可以做到这一点？

*我知道我的代码是可利用的，但这仍然是 WIP*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:14:17.560

> 此时聊天列表分为两类：一类是登录用户开始对话的列表，另一类是登录用户收到其他人的对话的列表。

然后只需查询其中*任何*一个条件为真的表，并按时间戳对记录进行排序。（另外，正如另一个线程所提到的，在搜索*完全*匹配时，正确的运算符是等于，即`=`，不是`LIKE`）。

```
 ...
  WHERE  conversations.user_one = <cfqueryparam value="#user.id#" 
                                           cfsqltype="cf_sql_integer">
  OR     conversations.user_two = <cfqueryparam value="#user.id#" 
                                           cfsqltype="cf_sql_integer">
  ORDER BY  conversations.lastmessage DESC 
```

> 此代码将用户 ID 转换为名称

如果可以避免，请不要在循环内查询。它增加了很多不必要的开销。检索相关列的正确方法是将 a 添加[`JOIN`](http://www.w3schools.com/sql/sql_join.asp)到您的查询中。`user`由于您必须多次加入表（以获取两个名称），因此请使用 an`alias`来区分：

```
 SELECT conversations.user_one
         , conversations.user_two
         , u1.username AS userNameOne
         , u2.username AS userNameTwo
         , ... 
  FROM   conversations 
            JOIN users u1 INNER JOIN u1.id = conversations.user_one
            JOIN users u2 INNER JOIN u2.id = conversations.user_two
  WHERE  ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:00:26.360

如果您运行一个联合所有查询而不是两个单独的查询，您将能够这样做。

# javascript - 数据表中的浮动图

> ID：15991519
> 
> 赞同：1
> 
> 时间：2013-04-13T18:45:08.993
> 
> 标签：javascript, jquery, datatable, flot

我想从表格中构建一个流动图。该表是使用 jquery 数据表插件构建的。该表可以内联编辑。

我想知道是否有人有任何技巧来显示浮点数据。您会从 json 中提取数据还是直接从图表中提取数据来构建 Flot 图表？

使用 datatables jquery 插件动态填充数据。

表是这样的。。

```
<div id="plotarea">  
    <table>  
        <caption>GDP, based on exchange rates, over time. Values in billion USDs.</caption>  
        <tr>  
            <td></td>  
            <th scope="col">2003</th>  
            <th scope="col">2002</th>  
            <th scope="col">2001</th>  
            <th scope="col">2000</th>  
            <th scope="col">1999</th>  
            <th scope="col">1998</th>  
        </tr>  
        <tr>  
            <th scope="row">USA</th>  
            <td>10,882</td>  
            <td>10,383</td>  
            <td>10,020</td>  
            <td>9,762</td>  
            <td>9,213</td>  
            <td>8,720</td>  
        </tr>  
        <tr>  
            <th scope="row">EU</th>  
            <td>10,970</td>  
            <td>9,040</td>  
            <td>8,303</td>  
            <td>8,234</td>  
            <td>8,901</td>  
            <td>8,889</td>  
        </tr>          
    </table>  
</div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-29T11:31:24.123

您可以使用循环来遍历您的表并为浮点数构建数据数组。像这样的东西：

```
 var headerTr = $('table tr:first()');
    var rowCount = $('table tr').length - 1;
    var data = [];        

    for (var row = 0; row < rowCount; row++) {
        var tr = $('table tr').eq(row + 1);
        var dataseries = {
            label: tr.find('th').text(),
            data: []
        };
        for (var col = 0; col < tr.find('td').length; col++) {
            var xval = headerTr.find('th').eq(col).text();
            var yval = tr.find('td').eq(col).text().replace(',', '');
            dataseries.data.push([xval, yval]);
        }
        data.push(dataseries);
    }; 
```

这是一个工作示例的[小提琴](https://jsfiddle.net/fn5rm5mb/)。通过单击按钮开始绘图。对于您的数据表，您可以将其更改为`onchange`事件或类似的东西。

# android - android中的自定义字体（用于整个应用程序）

> ID：15991521
> 
> 赞同：1
> 
> 时间：2013-04-13T18:45:17.510
> 
> 标签：android, performance, fonts

我有这个 android 代码，其中包含许多类，每个类都有不同的视图。我们可以转到设置并根据所选字体更改其字体。目前只有预装的 android 字体可用。有没有办法稍微调整我的代码，以便我可以添加一个 .ttf 文件并将其作为字体选项提供。我不想对代码进行大的更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:49:51.230

您可以使用字体为 textview 中的文本设置自定义字体。因此，每当您需要为 textview 自定义字体时，您都可以使用以下字体。

activity_main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:orientation="vertical"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
    >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" />
<TextView android:id="@+id/text"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:textColor="#FFF"
          />
 </LinearLayout> 
```

编码：

```
public class MainActivity extends Activity {

private TextView text;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    text = (TextView) findViewById(R.id.text);
    Button b= (Button) findViewById(R.id.button1);
    b.setOnClickListener( new OnClickListener()
    {

        @Override
        public void onClick(View v) {
            text.setText("This is a custom toast");
            Typeface typeFace =  Typeface.createFromAsset(getAssets(),"fonts/kn.ttf");
            text.setTypeface(typeFace);

        }

    });

}
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/Afk8n.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T18:49:04.880

不，你不能，除非你使用自己的 View 和自定义字体。

# opengl - 如果我溢出 OpenGL 矩阵堆栈会发生什么？

> ID：15991524
> 
> 赞同：1
> 
> 时间：2013-04-13T18:45:21.950
> 
> 标签：opengl

我想知道如果我溢出 OpenGL 矩阵堆栈会发生什么 - 我的意思是，我推了太多次而没有弹出。我刚试过，在我的机器上没有发生明显的错误。正常吗？每个正确的OpenGL实现都是这样吗？或者 OpenGL 是否会报告一些错误，或者某些东西可能会爆炸？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T23:45:26.573

# google-maps - 将 AJAX 与谷歌静态地图一起使用时 URL 中的空白

> ID：15991526
> 
> 赞同：0
> 
> 时间：2013-04-13T18:45:28.117
> 
> 标签：google-maps, iframe, google-static-maps

我有一个页面，其中有一个嵌入在 iFrame 中的 Google 静态地图实例。当页面加载时，这个 iFrame 的初始实例会加载一个设置的位置。页面上有一个地址列表，用户可以单击并根据他们的选择，通过 AJAX 重新加载嵌入了 Google 地图的 iFrame。

我在加载新 URL 时遇到了一些问题。以下是我目前使用的 PHP

```
$database->mysqlquery("SELECT street_address
                       FROM favorites
                       WHERE id = $row_id");

while($row = mysql_fetch_array($database->results)){
    $address = $row[street_address];
}

$url = "http://maps.googleapis.com/maps/api/staticmap?center=$address&zoom
=18&size=640x640&sensor=false"; 
```

我从我的数据库中获取地址并将其分配给一个变量。然后我将变量传递给静态地图 URL。

定义了 url，我调用了一个 iFrame

```
<iframe width = "425" height = "315" frameborder = "0" scrolling = "no" 
marginheight = "0" marginwidth = "0" src= "<?php echo $url; ?>" id = "iframe"></iframe> 
```

当我直接点击php页面或通过AJAX调用页面时，iFrame不加载。当我使用 Chrome 或 Firefox 检查页面时，我看到以下来源

```
<iframe width="425" height="315" frameborder="0" scrolling="no" 
marginheight="0" `marginwidth="0" 
src="http://maps.googleapis.com/maps/api/staticmap?center=116 Ponce De Leon Ave 
NE, Atlanta, GA&amp;zoom=18&amp;size=640x640&amp;sensor=false" id="iframe"></iframe> 
```

如果我从上面获取 src 字符串并直接通过浏览器加载链接，则地图会加载。

为什么我的 iFrame 没有加载？

**更新**

添加 rawurlencode() 以编码 $address 变量后的新 iFrame HTML

```
<iframe width="425" height="315" frameborder="0" scrolling="no" marginheight="0" 
marginwidth="0" 
src="http://maps.googleapis.com/maps/api/staticmap? 
center=116%20Ponce%20De%20Leon%20Ave%20NE%2C%20Atlanta%2C%20GA&amp;
zoom=18&amp;size=640x640&amp;sensor=false" id="iframe"></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:15:02.560

您必须对 street_address 进行编码，例如通过[`rawurlencode()`](http://php.net/rawurlencode)

URL 中不允许有空格（当您直接在浏览器中使用带空格的 URL 时，它可以工作，因为大多数浏览器会自动对 URL 进行编码）

# javascript - Jquery - 将html元素的内容转换为另一个元素

> ID：15991528
> 
> 赞同：0
> 
> 时间：2013-04-13T18:45:33.433
> 
> 标签：javascript, jquery, dom, tooltip, tipsy

我想将同一类的许多元素转换为其他元素。让我解释...

我的页面上有这个 HTML 的多个实例：

```
<td>FirstName LastName <span class="fortipsy">Some long text .. Lorem ipsum dolor sit   amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat</span></td> 
```

在页面加载时，我想获取所有跨度标签并将它们中的每一个转换为：

```
<td>FirstName LastName <a href="#" class="tipsy" title="Some long text .. Lorem ipsum    dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat"><img src="tipsy.gif" border="0"></a></td> 
```

简而言之，我想在页面加载时将这些元素转换为醉意。有什么建议或线索吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:50:26.737

**[jsFiddle 演示](http://jsfiddle.net/mohammadAdil/uruJJ/4/)**

```
$(".fortipsy").each(function () {
    var txt = $(this).text();
    $(this).parent().append("<a href='#' class='tipsy' title='" + txt + "'><img src='tipsy.gif' border='0'></a>")
    $(this).remove();
}); 
```

# javascript - 在 contentEditable div 旁边显示源代码

> ID：15991529
> 
> 赞同：0
> 
> 时间：2013-04-13T18:45:37.887
> 
> 标签：javascript, html, contenteditable

现在，我正在尝试创建一个所见即所得的 HTML 编辑器，我需要在正在编辑的 div 旁边显示 contentEditable div 的源代码。我正在尝试自动同步这两个元素，但我还不确定最好的方法是什么。

```
<div contentEditable ="true" id = "showSourceCodeForThis">test 1</div>
<input type = "text" id = "showSourceCodeHere"></input> 
```

每当更新 contentEditable div 时，我希望显示的源代码也能自动更新，反之亦然。是否可以将 contenteditable div 的内容与显示 contenteditable div 源代码的文本框同步？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:45:37.887

这是一个可行的解决方案：http: [//jsfiddle.net/sDdN3/14/](http://jsfiddle.net/sDdN3/14/)

HTML：

```
<div contentEditable ="true" id = "showSourceCodeForThis">test 1</div>
<input type = "text" id = "showSourceCodeHere"></input> 
```

JavaScript：

```
function test(){
    var divs = document.getElementById('showSourceCodeForThis');
        divs.onkeyup=function(event){
            document.getElementById('showSourceCodeHere').value = document.getElementById('showSourceCodeForThis').innerHTML;
        }
}

function test2(){
    var divs = document.getElementById('showSourceCodeHere');
        divs.onkeyup=function(event){
            document.getElementById('showSourceCodeForThis').innerHTML = document.getElementById('showSourceCodeHere').value;
        }
}

test();
test2(); 
```

# c# - 比较视图中viewbag的值

> ID：15991531
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:45:42.073
> 
> 标签：c#, asp.net-mvc-4

我整天都在做一个学校项目，现在我想一个很简单的问题，但我没有看到。

在我的视图文件（details.cshtml）中，我尝试比较 viewbag 值。 `ViewBag.ScoreOne`包含一个 int

```
@if(Model.Turn == Model.PlayerOneId && ViewBag.ScoreOne <= 10){

}
else if (@Model.Turn == Model.PlayerTwoId && ViewBag.ScoreTwo <= 10)
{

}else{

} 
```

我把语句中的代码放出来了，因为它没有用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:51:33.023

在比较之前将 ViewBag 的属性 ((int)ViewBag.ScoreOne) 转换为 int。

# c++ - C++ getline() 不需要命名空间声明

> ID：15991532
> 
> 赞同：6
> 
> 时间：2013-04-13T18:45:57.447
> 
> 标签：c++, scope

为什么*getline()*来自本地范围内的标头**字符串**并且可以使用：

```
#include <iostream>
#include <string>

int main() {
    std::string str;
    getline(std::cin, str);
    std::cout << str << "\n";
    return 0;
} 
```

这适用于 gcc。但为什么？它在 header **string**中定义，这应该要求我使用*std::getline()*而不是*getline()*。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T18:49:56.433

您正在体验 Argument Dependent Lookup (ADL，也称为 Koenig Lookup)。由于一个或多个参数是在`std`命名空间中定义的类型，因此它会搜索命名空间中的函数以及`std`它要搜索的任何其他位置。我向您指出[Stephan T. Lavavej 的视频](http://channel9.msdn.com/Series/C9-Lectures-Stephan-T-Lavavej-Core-C-/Stephan-T-Lavavej-Core-C-1-of-n)，以了解有关它和一般名称查找的更多信息。

# c - mingw 中的错误，同时扫描字符串

> ID：15991535
> 
> 赞同：0
> 
> 时间：2013-04-13T18:46:15.907
> 
> 标签：c, mingw

我刚刚安装了mingw。我正在测试它。我只是写了一个简单的程序。但它给出了错误。可能有什么问题？

```
 int main()
    {
        char name[10];
        printf("Enter your name\t");
        scanf("%s", &name);
        printf("Hello %s",name);
        return 0;
    } 
```

错误是，

```
- format '%s' expects argument of type 'char *', but argument 2 has type 'char (*)[10]' [-
     Wformat]

- Line breakpoint: sorts.c [line: 16] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T18:47:37.820

改变：

```
scanf("%s", &name); 
```

至

```
scanf("%s", name); 
```

`&name`是指向数组`10`的指针`char`，是在函数调用表达式中转换为指向指针`name`的数组。转换说明符需要一个指向参数的指针。`10``char``char``s``char`

# python - Python：调整坐标

> ID：15991536
> 
> 赞同：1
> 
> 时间：2013-04-13T18:46:19.250
> 
> 标签：python, coordinates

我有这个 Python 脚本，它应该调整一组三角形元素的坐标。该脚本应将节点的坐标从元素更改为元素的重心。下图是我为这个问题制作的草图。

![在此处输入图像描述](https://i.stack.imgur.com/4oY7H.jpg)

但是我的脚本有问题，我不知道是什么。坐标不会在正确的方向上改变，并且会生成额外的新坐标，而我只想调整现有坐标。

**有谁知道如何在 Python 中正确编程？**

```
coords = [[0.0, 0.0], [1.0, 0.0], [0.0, 1.0], [0.0, 0.0], [1.0, 1.0], [0.0, 1.0], [0.0, 1.0], [1.0, 1.0], [0.0, 2.0], [0.0, 2.0], [1.0, 1.0], [1.0, 2.0], [1.0, 1.0], [2.0, 1.0], [1.0, 2.0], [1.0, 2.0], [2.0, 1.0], [2.0, 2.0], [1.0, 1.0], [2.0, 0.0], [2.0, 1.0], [1.0, 0.0], [2.0, 0.0], [1.0, 1.0]]
elems = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11], [12, 13, 14], [15, 16, 17], [18, 19, 20], [21, 22, 23]]

#define vectors
def add_vectors(*points):
  new_x = 0.0
  new_y = 0.0
  for point in points:
    new_x += point[0]
    new_y += point[1]
  return [new_x, new_y]

def subtract_vectors(a, b):
  new_x = a[0] - b[0]
  new_y = a[1] - b[1]
  return [new_x, new_y]

def mul_by_scalar(vector, scalar):
  new_x = vector[0] * scalar
  new_y = vector[1] * scalar
  return [new_x, new_y]

#define triangles
triangles = []
for elem in elems:
    triangles += [coords[e] for e in elem]

#adjust coordinates
CM = mul_by_scalar(add_vectors(*triangles), 1.0/3)

point_to_CM_vectors = []
for point in triangles:
  point_to_CM_vectors.append(subtract_vectors(CM, point))

new_triangle = []
for elem in elems:
    for point, motion in zip(triangles, point_to_CM_vectors):
      new_triangle.append(add_vectors(point, mul_by_scalar(motion, 0.01)))

print 'triangles =', triangles
print 'new_triangle =', new_triangle 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T23:48:19.780

**这是使用numpy**提供的矢量化运算符对您的问题的重新处理。

```
import numpy as np

#define triangles
triangles = np.array([[coords[e] for e in elem] for elem in elems])

#find centroid of each triangle
CM = np.mean(triangles,axis=1)

#find vector from each point in triangle pointing towards centroid
point_to_CM_vectors = CM[:,np.newaxis] - triangles

#calculate similar triangles 1% smaller
new_triangle = triangles + 0.01*point_to_CM_vectors 
```

# java - 在速度方面优化 Java 工作者

> ID：15991540
> 
> 赞同：0
> 
> 时间：2013-04-13T18:46:53.750
> 
> 标签：java

我有一个处理大量数据的 Java 工作者。它在 main() 中等待 Redis 队列，然后根据类型调用不同的函数来处理数据。

我有两个关于优化代码的问题：

1.  拥有私有静态类变量并使用它们将数据发送到方法而不是使用函数参数会更好吗？
2.  如果在这些经常被调用的方法中使用的变量在类上是私有的静态变量，而不是在进入方法时总是重新声明，它会加快执行时间吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:09:06.893

您在谈论速度，但`static`变量将主要帮助您记忆。

**如果您正在创建多个即时变量（非`static`字段）并考虑更改为`static`一个：**

> 当一个类的多个实例需要访问这些实例的局部变量（实例变量）中的特定对象时，最好使该变量成为`static`变量，而不是让每个实例都拥有一个单独的引用。这减少了每个对象占用的**空间**（少一个实例变量），并且如果每个实例创建一个单独的对象来填充该实例变量，也可以减少创建的对象数量。（引自《 [Java 性能调优](http://oreilly.com/catalog/javapt/chapter/ch04.html)》一书。）

**如果您不创建实例变量，而只是在参数中传递一个变量：**

在性能方面，应该没有区别。由于Java中的所有方法参数都是按值传递的，这意味着实际变量不会被复制过来：只有它的地址（指针 - 对变量的引用）被复制到被调用方法的参数中。

在任何情况下，`static`字段都会损害代码的可读性（这会使它们更难维护）。如果你真的需要某种`static`行为，也请考虑使用[单例](http://en.wikipedia.org/wiki/Singleton_pattern)设计模式。

**底线是：**

在我看来，您的情况是：您只是传递变量（没有实例变量）。

我建议你保持这种状态。如果您更改它，使用静态字段将获得接近零（如果有）的性能增益 - 另一方面，您的代码将更难以维护/理解/调试。

# android - 从 sdcard 保存和加载显示空文件

> ID：15991546
> 
> 赞同：0
> 
> 时间：2013-04-13T18:47:37.773
> 
> 标签：android

我有一个布局，其中有一个编辑文本字段，可以在其中输入数据。我有 2 个按钮。保存和绘图。

当我按保存时，我想保存来自 edittext 字段的数据（以 xls 格式）和 sd 卡中的当前日期。

当我按下情节时，我想绘制它们。

保存数据：

```
case R.id.savebtn:
            savefunc();
            break;
...
public void savefunc(){
        //saving 

         File sdCard = Environment.getExternalStorageDirectory();
         File directory = new File (sdCard, "MyFiles");
         directory.mkdirs();
         File file = new File(directory, filename);
         try {
             FileOutputStream fOut = new FileOutputStream(file);
             DataOutputStream os = new DataOutputStream(fOut);
         os.writeUTF(thedata);
         os.writeUTF(mydate);
         os.close();
         } catch (FileNotFoundException e) {
         // handle exception
         } catch (IOException e) {
         // handle exception
           }
    } 
```

阅读：

```
public void readfunc(){

        File sdCard = Environment.getExternalStorageDirectory();
        File directory = new File (sdCard, "MyFiles");
        File file = new File(directory, filename);
        try{
            FileInputStream fIn = new FileInputStream(file);
            DataInputStream is = new DataInputStream(fIn);
            String name = is.readUTF();
            String content = is.readUTF();
            is.close();
            } catch (FileNotFoundException e) {
                // handle exception
             } catch (IOException e) {
             // handle exception
               }

    } 
```

和 ：

```
 case R.id.savebtn:
  savefunc();
    break;
case R.id.graphicsbtn:
    readfunc();          

    ... 
```

但是 xls 文件询问我格式，我选择 UTF8 并且它是空的。

如果我离开它会显示中文字符。

我不确定代码的“阅读”部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:43:42.267

Read this documentation here have more information about save data to external storage and read it is:

[Saving and Reading file from External storage](http://developer.android.com/training/basics/data-storage/files.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T10:12:28.397

好的，我找到[了这个](http://www.mysamplecode.com/2012/05/java-read-file-bufferedinputstream.html)并且工作正常！

# actionscript-3 - 使用多帧影片剪辑最大限度地减少内存使用

> ID：15991548
> 
> 赞同：0
> 
> 时间：2013-04-13T18:47:42.503
> 
> 标签：actionscript-3, flash, movieclip

我在 Flash 中有一个 100 帧的 MovieClip。每个框架都包含一个我需要在项目中使用的图标。我在需要图标出现的任何地方创建此图标 MovieClip 的实例，并`gotoAndStop`在某个帧上显示该图标。

每当我创建 MovieClip 的实例时，将 100 个图标存储在单个影片剪辑中会导致在内存中创建每个图标吗？如果我将每个图标存储在库中并仅附加所需的图标，那么这会比创建包含所有图标的 MovieClip 消耗更少的内存吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:44:26.673

回答您的问题：当您转到带有图标的框架时，Flash 将创建该图标的新实例。当您离开该帧时，Flash 将使该图标符合垃圾收集条件，除非您以某种方式强制它将实例保存在内存中，例如使用 addEvenListener ，其中作为侦听器的方法是图标或其中的某个位置。

我认为 goToAndStop 与新实例的内存使用量可能会更高。如果您在使用 goToAndStop() 时没有遇到问题，那么每次从一个图标切换到另一个图标时都实例化一个新图标，您不太可能遇到其他问题。其他回答的人是非常正确的，您将通过只实例化所有图标一次（通过任何方法）来使用更少的 CPU 周期，然后每次使用该图标时只需使用同一个图标。但是，您的整体内存占用会更高，因为您将始终在内存中拥有所有图标（甚至是您当前未使用的图标）。

如果您想走只实例化一次的路线，我建议您使用延迟加载，您只在第一次使用时实例化每个图标。一种方法是使用已有的内容并在*第*一次使用特定图标时访问框架，然后存储 BitmapData 或对图标本身的引用并重用它。另一种方法是[构建一个 swc](http://active.tutsplus.com/tutorials/workflow/quick-guide-to-creating-and-using-swcs/?search_index=4)并使用类似的模式。

这些都不需要静态变量顺便说一句，因为听起来你没有使用大量不同的图标 MC 副本。即使您是，最好通过[依赖注入](http://www.developria.com/2009/09/as3-dependency-injection-demys.html)处理引用您拥有的图标。

但是，我认为您可能会询问文件大小与实际内存使用情况。*该*问题的答案是，您的 fla 使用的所有资源都被编译到 swf 中，无论它们是在 MovieClip、SWC 还是在库中并选中了“帧 N 中的 Export for Actionscript”。

**我明白了，我有胸部，我猜**
试试这个，以验证我的“猜测”。

1.  创建一个在第 1 帧具有关键帧的 swf。
2.  在那里画一个圆圈。
3.  在第 10 帧上放置另一个关键帧。画一个正方形。
4.  在发布设置中，选中“生成大小报告”。

现在，您知道（或者您应该知道）这个 swf 可以在第 1 帧显示圆圈，即使在第 10 帧编译的资源尚未下载。那么，在下载第 10 帧之前，有*什么方法*可以将正方形加载到内存中？提示：答案是否定的。

现在问问自己：您是否认为 Macromedia 编写了一个特殊版本的 MC，它*无法*延迟加载，而作为 Flash 为您在上面制作的电影生成的主要文档类的 MC 显然处理得很好？

Macromedia 工程师做了很多事后看来相当愚蠢的事情，但他们并没有*那么*无能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:48:37.767

如果您的图标是位图，那么每个影片剪辑将共享相同的数据 - 唯一的内存增加将是由于更多的影片剪辑，而不是它们的内容（这不应该是一个问题）。

如果您的图标不是位图（其他动画剪辑、形状、按钮等），那么所有内容都会被复制，因此随着添加更多动画剪辑，内存使用量会增加得更快。

另一个考虑因素是屏幕上的大量动画剪辑对 FPS 的影响比简单的对象更大，因此即使您使用的是位图，您也可能需要考虑添加图标本身而不是动画剪辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T20:54:12.520

如果进入 100 帧 MovieClip 的每个图标都是一个图像，那么您可以轻松地将该图像导出为动作脚本并仅访问您需要的图像。

另一个想法是创建一个静态类，将每个图标框架作为符号存储在静态数组（如果您想按索引访问图标）或字典（如果您想按名称检索它）中。

例如

```
package{

    import flash.display.Bitmap;

    public class Icons{

        public static const assets:Vector.<Bitmap> = Vector.<Bitmap>([new Icon01ASExportName(),//instance bitmaps once
                                                                      new Icon02ASExportName(),//reuse them later multiple times
                                                                      ...
                                                                      new Icon99ASExportName()]);
    }

} 
```

还有一种方法是生成一个 SpriteSheet，或者在运行时生成一个 SpriteSheet，然后将其保存为文件，然后[copyPixels()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#copyPixels%28%29)从主 spritesheet 的右侧矩形粘贴图标。您有多种工具可用于生成 spritesheet：

*   [佐伊](http://gskinner.com/blog/archives/2011/02/zoe-export-swf-animation-as-easeljs-spritesheets.html)
*   [SWF表](http://www.bit-101.com/blog/?p=2939)
*   [闪光 CS6](http://tv.adobe.com/watch/cs6-creative-cloud-feature-tour-for-web/generating-sprite-sheets-using-flash-professional-cs6/)
*   [TexturePacker](http://www.codeandweb.com/texturepacker)（如果您有影片剪辑，您可以将它们导出为图像序列以放入软件中）

还有一些方法可以[在运行时生成 spritesheet](https://github.com/emibap/Dynamic-Texture-Atlas-Generator)。

对于 Lee Brimelow 的关于 spritesheets 和 BitmapData 的一些很好解释的视频教程：Sprite Sheets and Blitting - Part [1](http://www.gotoandlearn.com/play.php?id=140) , [2](http://www.gotoandlearn.com/play.php?id=141) and [3](http://www.gotoandlearn.com/play.php?id=142)。

# css - css三角形的渐变颜色

> ID：15991551
> 
> 赞同：0
> 
> 时间：2013-04-13T18:47:49.707
> 
> 标签：css, navigation, breadcrumbs, linear-gradients

我有导航菜单，其中有 css 箭头。我可以获得导航菜单项的渐变效果，但无法获得箭头。

```
<ul id="content_navigation">
        <li><a href="">Test Link 1</a></li>
        <li><a href="">Test Link 2</a></li>
        <li><a href="">Test Link 3</a></li>
        <li><a href="">Test Link 4</a></li>
        <li><a href="" class="current">Test Link 5</a></li>
    </ul> 
```

CSS 很长，所以在下面添加了工作小提琴。

这是工作[**小提琴**](http://jsfiddle.net/qBcjq/17/)

找到了一个具有完美答案的**[类似问题](https://stackoverflow.com/questions/12431596/css-gradient-for-triangle-shaped-arrow)**，但我无法在我的代码中实现相同的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T20:22:20.903

实现这一点的关键是旋转+倾斜和旋转渐变：

```
#content_navigation a::after,
#content_navigation a::before{
   -webkit-transform:rotate(45deg) skew(20deg,20deg);
   -webkit-transform-origin:0 0;
   background: -webkit-linear-gradient(135deg,  #fefefe 0%,#e1e1e1 100%);
   /* just for better understanding you should change the bg-color
   to understand how this is done*/
   background:red;
   border-top:1px solid red;
   border-right:1px solid red;
} 
```

最大的缺点是您需要在这些元素上声明一个显式的宽度 + 高度。伪元素也可能与内容重叠。为避免这种情况，您需要修改 z-index 以将其推送到后台。与边界技巧相比的优势是您甚至可以使用`box-shadow`.

这是您[修改后的 Fiddle](http://jsfiddle.net/qBcjq/19/)仅在 Chrome 中工作的链接。但是你现在应该可以自己解决这个问题了。

# linux - 将文件添加到 zip 文件中的特定目录

> ID：15991552
> 
> 赞同：1
> 
> 时间：2013-04-13T18:47:55.537
> 
> 标签：linux, unix, zip

假设我们有一个 zip 文件，其中包含一个名为的目录`aq`，并且在当前工作目录中我们有文件：

```
./
|- aq/a.txt
|- b.txt 
```

当我使用此命令时： 文件将被压缩到`zip test.zip aq/*`zip文件内的目录中`a.txt``aq`

问题是我如何才能添加`b.txt`到文件`aq`内的目录中，而不像我对?`test.zip``b.txt``aq``a.txt`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:22:09.937

Make a temp directory called, e.g. `/tmp/$$/aq/`, symlink into the temp directory and then do:

```
(cd /tmp/$$ && zip -r $ZIPDEST aq/) 
```

i.e. zip using the temp dir. zip by default follows symbolic links, so it puts the file into the zip without making a copy.

This is pretty much how I construct complicated hierarchical zip files without copying everything to make the archive.

Tar has better options for renaming items as you're putting them into the archive, but you asked about zip.

# c++ - Gtkmm 3.0：如何在 DrawingArea 的 on_draw 方法中获取用户类数据

> ID：15991560
> 
> 赞同：0
> 
> 时间：2013-04-13T18:48:47.633
> 
> 标签：c++, gtkmm

在我的第一个 Gtkmm 3.0 程序中，我遇到了程序结构和从 DrawingArea 类访问我的类数据的问题。

基于来自 gnome 网站的演示程序（“绘制细线”），我有一个窗口类、一个绘图区域类和一个带有用户数据的 Board 类。

一个drawingArea 对象被定义为windows 类中的一个成员变量。在窗口类构造函数中，我实例化了一个 Board 对象。

现在我想访问drawingArea 类的on_draw 例程中的Board 成员变量。最好的方法是什么？

我的董事会课程有：

```
class Board {
public:
   int sqPix; 
```

我的窗口类有：

```
Board &ExampleWindow::getBd()   { return bdw; }
void  ExampleWindow::setBd(Board b) {bdw = b; }
ExampleWindow::ExampleWindow(char * fn, vector<int>& t)
{
  Board bd = Board(t);
  setBd(bd); 
```

我的窗口类 .h 文件有：

```
 class ExampleWindow : public Gtk::Window
{
public:
  ExampleWindow();
  ExampleWindow(char * fn, std::vector<int>& t);
  virtual ~ExampleWindow();
  Board &getBd();
  void  setBd(Board b);
private:
  Board bdw;
  MyArea m_Area; 
```

在我的绘图区课程中，我想做类似的事情：

```
bool MyArea::on_draw(const Cairo::RefPtr<Cairo::Context>& cr)
{
  Gtk::Allocation allocation = get_allocation();
  =====> int sqPix = ExampleWindow::getBd().sqPix; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:26:31.697

您可能不应该将顶级窗口与绘图区域耦合，否则您无法在应用程序的其他窗口中重用绘图代码，例如更改示例板外观的首选项。

相反，在其构造函数中传递一个 Board 引用或指向您的 DrawingArea 的指针。这是窗口的构造函数，其中 DrawingArea 采用 Board 引用。如果您认为 DrawingArea 并不总是与一个 Board 相关联，则可以使用指针和 setBoard()：

```
ExampleWindow(const char * fn, const vector<int>& t) : bdw(t), m_Area(bdw) {
  ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:57:23.147

添加指向定义的指针，稍后您可以在构造函数中对其`ExampleWindow`进行初始化。这样您就可以访问 ExampleWindow 的公共接口。您可以创建公共 getter 以允许外部用户 ( ) 访问字段。`MyArea``MyArea``MyArea`

# maven - Intelli J IDEA 需要永远更新索引

> ID：15991561
> 
> 赞同：157
> 
> 时间：2013-04-13T18:48:49.453
> 
> 标签：maven, ide, intellij-idea, indexing

Intelli J 花费大量时间（几乎 12 小时）来更新项目的索引是否正常？我刚刚在我的机器上安装了 Intelli J 并导入了一个相当大的 Maven 项目（13k+ 个文件）。

我知道这个项目很大，但我让我的电脑整晚都开着，当我早上醒来时，Intelli J 仍然没有完成更新文件的索引，这使得自从弹出窗口以来无法做任何事情标题“更新索引”一直挂在屏幕中间。

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2014-04-11T06:41:11.287

There are several answers in the Forums for different IntelliJ Versions, here is what I´ve tried (IntelliJ 13).

*   Give more Memory. Does not help anything with the 'Updating indices'
*   Delete .idea and iml in project. Does not help.

In the end what resolved my problem with 'Updating indices' was:

*   delete 'caches' folder in user/.IntellIJIdea13/system/

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2015-08-24T20:13:57.020

我尝试删除缓存，它工作得很好。感谢解决问题的朋友。

只是：

1.  打开 IntelliJ IDEA
2.  选择*文件*菜单
3.  选择*无效缓存/重新启动...*菜单。
    选择后，您会看到一个包含大量选项的弹出窗口。
4.  选择*Invalidate and Restart*
    并在此之前确保您保存了所有更改，否则它可能会删除一些未保存的更改。

一旦你点击它，IntelliJ 将重新启动，然后你可以看到所有索引都非常快地完成。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-09-02T09:31:32.583

删除库文件夹中的缓存

```
rm -rv ~/Library/Caches/IdeaIC15/caches/ 
```

在 Mac OSX 上，缓存的位置是`~/Library/Caches`

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2020-09-23T07:27:23.710

在`Intellij 2020.2`我也遇到了这个问题。重新启动/无效缓存对我不起作用。我所做的只是删除以下路径中的缓存文件夹：

```
C:\Users\davoud\AppData\Local\JetBrains\IntelliJIdea2020.2 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-09-11T10:29:03.413

我对 IntelliJ 2017.2.3 也有同样的问题——即我的项目会一遍又一遍地更新索引。

我发现我已经超出了我的主目录中的磁盘配额。默认情况下，IntelliJ 将索引存储在主目录中，如下所示：

```
~/.IdeaIC2017.2/system/index/ 
```

我的解决方案是：

1.  退出 IntelliJ
2.  将整个 .IdeaIC2017.2 目录移动到另一个有更多空间的挂载：

    ```
    mkdir /space/ideaConfig
    mv ~/.IdeaIC2017.2 /space/ideaConfig/IdeaIC 
    ```

3.  更新`bin/idea.properties`以指向新的索引/配置位置：

    ```
    idea.config.path=/space/ideaConfig/IdeaIC/config
    idea.system.path=/space/ideaConfig/IdeaIC/system 
    ```

这个问题的其他一些答案可能是由于相同的问题，并且被“删除缓存文件夹”、“使缓存无效”等无意中修复，这可能会释放足够的磁盘空间来构建索引。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-03T11:59:39.190

尽管接受的答案和其他答案可能会解决特定问题，但我发现索引时间过长的问题通常来自存储库包含或链接到包含大量文件的某个目录的事实。通常这是为了测试而完成的，所讨论的目录实际上并不是项目的一部分，例如被 VCS 忽略。

IDE 在编制索引时不会自动忽略这些目录，但可以从项目中“排除”该目录。这也将阻止索引。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-04-18T16:08:31.317

更简单的方法如下：文件 --> 设置 --> （取消选中）在框架或编辑器选项卡激活时同步文件。

![在此处输入图像描述](https://i.stack.imgur.com/aYO9m.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-12-03T05:36:01.827

我能够通过去解决这个问题`File -> Invalidate Caches / Restart`

然后在打开的对话框中选择“无效并重新启动”[![在此处输入图像描述](https://i.stack.imgur.com/WFVV0.png)](https://i.stack.imgur.com/WFVV0.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-02-06T10:55:32.373

我猜想法是收集垃圾而不是做有用的工作。使用 G1 GC 而不是默认值。

帮助 -- 编辑自定义 VM 选项

```
-XX:+UseG1GC 
```

代替

```
-XX:+UseConcMarkSweepGC 
```

当然重新启动Idea。

缺点：G1 在停止进程之前尝试收集垃圾。这很疯狂，但这就是它的作用。对于一个 16G 堆的程序，清理需要 27 分钟。所以不要将你的 Idea 配置为使用 16G 堆。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-09T08:04:44.323

[您可以使用IDEA Indexing](https://www.jetbrains.com/help/idea/indexing.html#exclude)手动排除文件或目录，它可以提高文件加载速度。有些文件是动态生成的，我们不需要每次启动IDEA时都索引这些文件。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2021-04-28T05:04:29.800

~/Library/Caches/JetBrains/IntelliJIdea2021.1 它对我有用..

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-10-10T01:16:47.910

可能 - 缓存系统中的旧错误。它发生在所有版本中，尤其是当您升级 IntelliJ 或 JDK 版本时。要修复它： 1) 关闭 GUI。2) 转到 %HOME_DIR%.IntelliJIdeaXXXX\system\caches 并删除它 3) 再次启动 GUI。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2021-05-20T13:56:15.600

IDEA 2020.2 右键Project下的文件夹，然后标记为Exclude，排除不想索引的文件夹

# c - 如何编译这个 hello world 操作系统？

> ID：15991564
> 
> 赞同：-2
> 
> 时间：2013-04-13T18:49:10.017
> 
> 标签：c, operating-system, boot

我正在尝试使用[helloWorld OS](http://www.acm.uiuc.edu/sigops/roll_your_own/1.helloworld.html)。我按照给出的说明进行操作，但无法制作`main.c`. 我查看了make文件，它引用`./bootmaker`了不在他们说要下载的文件夹中。看起来好像是他们运行的脚本，但我不知道如何获取或创建它。我可以从哪里获得`./bootmaker`或有哪些程序可以代替我使用它来完成相同的工作？

**更新**
我想补充一点，这是一个典型的案例，没有完全阅读提供给我的文档，这导致了我的困惑，我为这个糟糕的帖子道歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:16:55.753

该指南的第 4 步为您提供了 Bootmaker 的链接。

这是链接：[http ://www.acm.uiuc.edu/sigops/roll_your_own/1.bootstrap.html](http://www.acm.uiuc.edu/sigops/roll_your_own/1.bootstrap.html)

Bootmaker 来源：[http ://www.acm.uiuc.edu/sigops/roll_your_own/code/util.tar.gz](http://www.acm.uiuc.edu/sigops/roll_your_own/code/util.tar.gz)

# magento - Magento 属性显示在一个主题中/不显示在另一个主题中

> ID：15991567
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:49:24.217
> 
> 标签：magento, layered-navigation

Magento 属性未显示在分层导航中。在我原来的主题属性中，它们应该显示出来。使用其他主题时，所有属性均未显示。显然主题中一定有某个地方，但我不知道在哪里改变它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:13:19.060

用这么少的信息很难猜出你的情况，但如果你的“原始主题”包含一些额外的分层导航属性代码，那么文件应该在

```
\app\design\frontend\PACKAGE\THEME\template\catalog\navigation\left.phtml 
```

# javascript - 如何使用 JavaScript 在客户端执行动态数学函数？

> ID：15991579
> 
> 赞同：1
> 
> 时间：2013-04-13T18:50:37.310
> 
> 标签：javascript, math, excel-formula

我有一个网络应用程序。我的任务是增加执行动态（或从服务器端加载）数学公式的能力，例如在 Excel 中。是的，我可以使用 JavaScript 沙箱，但它确实不安全，我不需要太多功能，只需要数学（求和、乘法等）和“如果”短语。我希望你们知道实现数学处理器的最佳方法。

问候保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T04:28:32.643

[您可以使用 jison ( http://zaach.github.io/jison/](http://zaach.github.io/jison/) ) 或 PEGjs ( [https://github.com/dmajda/pegjs](https://github.com/dmajda/pegjs) )编写自己的解析器。

至于语法规范，您应该查看 ECMA-376 ( [http://www.ecma-international.org/publications/standards/Ecma-376.htm](http://www.ecma-international.org/publications/standards/Ecma-376.htm) ) 和 MS-XLS ( [http://msdn.microsoft.com /en-us/library/cc313154%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/cc313154%28v=office.12%29.aspx)）。两者都有公式语言的高级描述（带有伪 ABNF）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T18:34:45.347

这是我的解决方案：

```
/* description: Parses end executes mathematical expressions with IF THEN ELSE statments. */
/* generated from http://zaach.github.io/jison/try/ */
/* The example IF(1>2) THEN 5 ELSE 1 */

/* lexical grammar */
%lex
%%

\s+                   /* skip whitespace */
[0-9]+("."[0-9]+)?\b  return 'NUMBER'
"*"                   return '*'
"/"                   return '/'
"-"                   return '-'
"+"                   return '+'
"^"                   return '^'
"("                   return '('
")"                   return ')'
"<"                   return '<'
">"                   return '>'
"PI"                  return 'PI'
"E"                   return 'E'
"IF"                  return 'IF';
"THEN"                return 'THEN'
"ELSE"                return 'ELSE'
"=="                  return '=='
<<EOF>>               return 'EOF'
.                     return 'INVALID'

/lex

/* operator associations and precedence */

%left '+' '-'
%left '*' '/'
%left '^'
%left UMINUS
%left 'IF'
%left '<'
%left '>'
%left '=='

%start expressions

%% /* language grammar */

expressions
    : e EOF
        {return $1;}
    ;

e
    : e '+' e
        {$$ = $1+$3;}
    | e '-' e
        {$$ = $1-$3;}
    | e '*' e
        {$$ = $1*$3;}
    | e '/' e
        {$$ = $1/$3;}
    | e '^' e
        {$$ = Math.pow($1, $3);}
    | '-' e %prec UMINUS
        {$$ = -$2;}
    | '(' e ')'
        {$$ = $2;}
    | NUMBER
        {$$ = Number(yytext);}
    | E
        {$$ = Math.E;}
    | PI
        {$$ = Math.PI;}
    | e '<' e
        {$$ = $1<$3;}   
    | e '>' e
        {$$ = $1>$3;}
    | e '==' e
        {$$ = $1==$3;}
    | IF '(' e ')' THEN e ELSE e
        {
            if($3 == true){
                $$ = $6;
            }
            else{
                $$ = $8;
            }           
        }
    ;
} 
```

我不确定，这是正确的方法，但它对我有用。[您可以在http://zaach.github.io/jison/try/](http://zaach.github.io/jison/try/)尝试一下

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-28T12:42:33.957

您可以使用 math.js 中包含的表达式解析器：

[http://mathjs.org](http://mathjs.org)

示例用法：

```
math.eval('1.2 / (2.3 + 0.7)');   // 0.4
math.eval('5.08 cm in inch');     // 2 inch
math.eval('sin(45 deg) ^ 2');     // 0.5
math.eval('9 / 3 + 2i');          // 3 + 2i
math.eval('det([-1, 2; 3, 1])');  // -7 
```

# c++ - 我可以（a）不通过输入迭代器写入，或（b）只读取一次吗

> ID：15991587
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:51:43.597
> 
> 标签：c++

以下陈述的哪一部分不正确？

> 输入迭代器只能从当前位置读取一次，然后必须递增。无法写入当前位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:12:08.250

> 输入迭代器只能从当前位置读取一次，然后必须递增。

这部分是不正确的。您可以根据需要多次取消引用输入迭代器！（*然而*，[大多数输入迭代器都是单程的](https://stackoverflow.com/a/8869179/560648)。）

> 无法写入当前位置。

这部分是正确的。你有一个*输入*迭代器。

# php - PHP“无”字符

> ID：15991590
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:51:46.383
> 
> 标签：php, string, variables

我喜欢在字符串中嵌入变量 -`"I like $verb $noun in strings!"`

但后来我正在设计一个数据库访问脚本：

```
$sqlfragment = "SELECT * from " . $databasetableprefix . "_user"; 
```

迷人的。但是我在字符串中的嵌入变量发生了什么？！

我想做这样的事情：

```
$sqlfragment = "SELECT * from $databasetableprefix_user"; 
```

但这将被解释为来自变量`$databasetableprefix_user`。

所以我会使用一个空格：

```
$sqlfragment = "SELECT * from $databasetableprefix _user"; 
```

但是数据库表名中不允许有空格，所以这是行不通的。

（我想要的是这个结果字符串：`"SELECT * from cc_user"`，如果`cc`是前缀。）

我可以使用变量嵌入创建这个字符串吗？也许是一种“无”字符，它会阻止 PHP 认为它是变量名的一部分，但不会传递给 SQL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T18:55:03.553

```
$sqlfragment = "SELECT * from {$databasetableprefix}_user"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T18:55:53.080

将变量包装在 {} 中，如下所示：

$sqlfragment = "SELECT * from {$databasetableprefix}_user";

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T18:56:53.967

您必须使用大括号来告诉 PHP 变量名称的开始和结束位置，如[PHP 手册中详细描述的那样](http://uk1.php.net/manual/en/language.types.string.php#language.types.string.parsing)。

```
$sqlfragment = "SELECT * from {$databasetableprefix}_user"; 
```

此外，使用变量生成 SQL 语句时要非常小心，因为如果您不仔细跟踪变量的来源或验证它们的值，它很容易成为安全风险。

# asp.net - 在 IIS7 和 ASP.NET 下 cookie 过期是如何工作的，有没有办法自动刷新呢？域级cookie过期？

> ID：15991591
> 
> 赞同：1
> 
> 时间：2013-04-13T18:51:48.790
> 
> 标签：asp.net, cookies, iis-7

我正在使用使用表单身份验证的单个登录页面。此页面在 mysites.com 上创建域 cookie。

我还有其他三个需要身份验证才能访问的网站。在我的页面 loginsso.mysites.com 中，我的 cookie 过期时间设置为 30 分钟。然而，当 cookie 过期时，会发生什么情况，它将把用户踢出我的其他三个站点。

为了使这更复杂，这三个站点中的每一个都有空闲超时。

这就是它的工作原理：

*   用户登录 mysso.mysite.com*   它创建一个域级别的 cookie（这个 cookie 有 30 分钟的超时期限）*   -mysitea.mysite.com 有 3 个空闲小时到期*   -mysiteb.mysite.com 有 1 个空闲小时到期*   -mysitec.mysite.com 有 2 个空闲小时到期

因此，由于 mysso.mysite.com 上的 cookie 规范，登录到 mysso.mysite.com 并导航到 mysiteb.mysite.com 并在那里工作 30 分钟的用户将在 30 分钟后不再能够访问该站点。

基本上我需要一种方法来处理这个问题。如果用户导航到 mysiteb 并开始工作，他并没有闲着，也不应该被踢出 mysitesso。

希望这有任何意义。

我也有可能将 SessionTimeOut 与 CookieExperation 以及它们的处理方式混合在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:59:24.923

在您的情况下，为 SSO 和单个应用程序使用会话 cookie。会话 cookie 是没有设置过期日期的 cookie——它会一直保留到浏览器关闭（有关详细信息，请参阅[此处](http://erlend.oftedal.no/blog/?blogid=41)）。处理服务器端逻辑中所有应用程序的会话到期，并在发生超时时销毁会话。

您还应该确保会话 cookie 免受 javascript 访问，以防止 XHR 攻击（适用于所有现代浏览器）。你可以在这里这样做：

```
cookie.HttpOnly = true; 
```

有关该属性的更多文档`HttpOnly`可以在[文档](http://msdn.microsoft.com/en-us/library/system.web.httpcookie.httponly.aspx)中找到，或者通过查找[有关表单身份验证的深入文章](http://msdn.microsoft.com/en-us/library/aa480476.aspx)`HttpOnly`。

# android - 在自定义 ListView 中隐藏数字键盘后复选框的状态发生了变化

> ID：15991598
> 
> 赞同：1
> 
> 时间：2013-04-13T18:52:34.010
> 
> 标签：android, listview, checkbox

我有一个自定义 ListView，其中包含一些 TextView、EditText 和一个代表购物清单项目的复选框。当我在值Edittext中键入值时，我会检查复选框，敬酒向我显示了值乘以其各自数量的总和，当所有项目的所有复选框都被检查时，对话框向我显示了购物列表的总价值。我的问题是，当我输入值后隐藏数字键盘时，复选框失去了选中状态。可能是什么问题呢？

这是我的 getView 方法的部分代码：

```
@Override
public View getView(final int position, View convertView, ViewGroup parent) {

    final ViewHolder holder;

    SharedPreferences sharedPrefs = contexto.getSharedPreferences("sharedPrefs", Context.MODE_PRIVATE);

    if (convertView == null) {
        LayoutInflater inflater = contexto.getLayoutInflater();
        convertView = inflater.inflate(R.layout.items_layout, null);
        holder = new ViewHolder();
        holder.texto = (TextView) convertView.findViewById(R.id.txtDescricao);
        holder.checkbox = (CheckBox) convertView.findViewById(R.id.chkProduto);
        holder.edtValor = (EditText) convertView.findViewById(R.id.txtValor);
        holder.edtQtde = (EditText) convertView.findViewById(R.id.txtQuantidade);
        holder.btnMenos = (Button) convertView.findViewById(R.id.btnMenos);
        holder.btnMais = (Button) convertView.findViewById(R.id.btnMais);
        //holder.btnExcluir = (ImageButton) convertView.findViewById(R.id.btnExcluir);
        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
    }

    editor = sharedPrefs.edit();

    holder.posicao = position;
    holder.texto.setText(getItem(position).getTexto());     

    if(getItem(position).getValor() > 0)
        holder.edtValor.setText(Double.toString(getItem(position).getValor()));
    else
        holder.edtValor.setText("");

    holder.edtValor.setTag(new LinhaItemTag(getItem(position), position));  
    holder.edtValor.addTextChangedListener(new TextWatcherValor(holder));       

    if(quantidades[position] > 0)
        holder.edtQtde.setText(Integer.toString(quantidades[position]));
    else
        holder.edtQtde.setText("");

    holder.edtQtde.setTag(new LinhaItemTag(getItem(position), position));   
    holder.edtQtde.addTextChangedListener(new TextWatcherQuantidade(holder));

    holder.btnMenos.setTag(new LinhaItemTag(getItem(position), position));  
    holder.btnMais.setTag(new LinhaItemTag(getItem(position), position));
    //holder.btnExcluir.setTag(new LinhaItemTag(getItem(position), position));

    holder.checkbox.setOnCheckedChangeListener(null);
    //holder.checkbox.setChecked(getItem(position).Selecionado());
    getItem(position).setSelecionado(sharedPrefs.getBoolean("CheckValue"+position, false));
    holder.checkbox.setChecked(getItem(position).Selecionado());
    holder.checkbox.setTag(new LinhaItemTag(getItem(position), position));

    holder.checkbox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

        @Override
        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
            LinhaItemTag elemento = (LinhaItemTag) buttonView.getTag();
            elemento.item.setSelecionado(isChecked);        
            editor.putBoolean("CheckValue"+position, isChecked);
            editor.commit();

            if (isChecked) {
                pegos[elemento.position] = true;                    
            } else {
                pegos[elemento.position] = false;               
            }

            String vlrTotal = calculaTotal();

            boolean checados = true;
            for (int i = 0; i < lista.size(); i++) {
                if (!pegos[i]) {
                    checados = false;
                    break;
                }
            }           
            if (checados) {             
                mostraDlgFinaliza();                                        
            }
            else if(getItem(elemento.position).Selecionado())
            {
                Toast.makeText(contexto, "R$ " + vlrTotal, Toast.LENGTH_LONG).show();
            }
        }
    });

//Other piece of code

return convertView;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T18:57:39.277

## 对 Android CheckBoxes 使用 setOnClickListener() 而不是 setOnCheckChangedListener

而不是`setOnCheckChangedListener()`，您应该使用`setOnClickListener()`并通过 确定选中的设置`holder.checkbox.isChecked()`。

**示例**：

```
holder.checkBox.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View arg0) {
        final boolean isChecked = holder.checkBox.isChecked();
        // Do something here.
    }
}); 
```

更改后的`CheckBox`侦听器无效，因为由于方向/键盘更改导致滚动或屏幕重绘`CheckBox`等各种原因，各个对象不断被回收和重置。`ListView/GridView`每个人都`CheckBox`可以在进出视野时出现在不同的位置。这就是为什么您必须每次都设置检查值`getView()`并且必须响应点击。

否则，如果您只响应检查的更改，您将`checkChanged`在意外时间收到回调，因为它们`CheckBox`被回收，有时如果正在交换的单元格中的检查状态具有相同的检查设置，您将根本不会收到回调。

# android - Android OpenGL ES 2.0 黑色纹理

> ID：15991599
> 
> 赞同：1
> 
> 时间：2013-04-13T18:52:43.727
> 
> 标签：android, opengl-es, textures

我正在Android上学习gles2.0（我是新手:)），我想画一个有纹理的正方形，但我做不到。我用谷歌搜索了很多，但我无法找出答案，我只得到一个黑色方块。

我设置了一个 GLSurfaceView，然后是一个渲染器：

```
public class MySurfaceRenderer implements GLSurfaceView.Renderer {

    private Context context;
    private Sprite sprite1;

    @Override
    public void onDrawFrame(GL10 gl) {
        GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);
        sprite1.Draw();
    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) {
        GLES20.glViewport(0, 0, width, height);
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig config) {
        GLES20.glEnable(GLES20.GL_BLEND);
        GLES20.glBlendFunc(GLES20.GL_SRC_ALPHA,GLES20.GL_ONE_MINUS_SRC_ALPHA);
        GLES20.glClearColor(0.0f, 0.3f, 0.0f, 1.0f);
        sprite1 = new Sprite(context, R.drawable.test);
    }

} 
```

精灵类：

```
public class Sprite {

    private static String TAG = "SpriteRender";

    private Context context;

    private FloatBuffer databuffer;
    private FloatBuffer texturebuffer;
    // x, y,
    float data[] =  {-0.5f,  -0.5f,
                     -0.5f, 0.5f,
                     0.5f, 0.5f,
                     0.5f, -0.5f};
    // u,v 
    float texturedata[] =   {0.0f, 0.0f,
                            0.0f, 1.0f,
                            1.0f, 1.0f,
                            1.0f, 0.0f};
    private int mProgram;
    private int vertexShader;
    private int fragmentShader;
    private int texture;
    private int positionHandler;
    private int texCoordHandler;
    private int textureHandler;

    public Sprite(Context context, int textureid){
        this.context = context;

        ByteBuffer bb_data = ByteBuffer.allocateDirect(data.length * 4);
        bb_data.order(ByteOrder.nativeOrder());
        ByteBuffer bb_texture = ByteBuffer.allocateDirect(texturedata.length * 4);
        bb_texture.order(ByteOrder.nativeOrder());

        databuffer = bb_data.asFloatBuffer();
        databuffer.put(data);
        databuffer.position(0);
        texturebuffer = bb_texture.asFloatBuffer();
        texturebuffer.put(texturedata);
        texturebuffer.position(0);

        vertexShader = ShaderLoader.loadShader(GLES20.GL_VERTEX_SHADER, ShaderLoader.readFromAssert(context, R.raw.tvs));
        fragmentShader = ShaderLoader.loadShader(GLES20.GL_FRAGMENT_SHADER, ShaderLoader.readFromAssert(context, R.raw.tfs));

        mProgram = GLES20.glCreateProgram();
        GLES20.glAttachShader(mProgram, fragmentShader);
        GLES20.glAttachShader(mProgram, vertexShader);
        GLES20.glLinkProgram(mProgram);

        int[] linkStatus = new int[1];
        GLES20.glGetProgramiv(mProgram, GLES20.GL_LINK_STATUS, linkStatus, 0);

        if (linkStatus[0] == 0){
            // Displays error message
        }
        positionHandler     = GLES20.glGetAttribLocation(mProgram, "a_Position");
        texCoordHandler     = GLES20.glGetAttribLocation(mProgram, "a_TexCoordinate");
        textureHandler      = GLES20.glGetUniformLocation(mProgram, "u_Texture");

        texture = TextureLoader.loadTexture(context, textureid);
    }

    public void Draw(){
        GLES20.glUseProgram(mProgram);
        databuffer.position(0);
        texturebuffer.position(0);  

        GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture);

        GLES20.glUniform1i(textureHandler, 0);

        GLES20.glEnableVertexAttribArray(texCoordHandler);
        GLES20.glEnableVertexAttribArray(positionHandler);

        GLES20.glVertexAttribPointer(positionHandler, 2, GLES20.GL_FLOAT, false, 8, databuffer);
        GLES20.glVertexAttribPointer(texCoordHandler, 2, GLES20.GL_FLOAT, false, 8, texturebuffer);

        GLES20.glDrawArrays(GLES20.GL_TRIANGLE_FAN, 0, 4);
    }

} 
```

ShaderLoader.loadShader 从文件加载着色器（在 res/raw 中），TextureLoader.loadTexture 从资源加载纹理：

```
public static int loadTexture(Context context, int resource){
    int[] texture = new int[1];

    GLES20.glGenTextures(1, texture, 0);

    BitmapFactory.Options bo = new BitmapFactory.Options();
    bo.inScaled = false;
    Bitmap tex = BitmapFactory.decodeResource(context.getResources(), resource, bo);

    GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
    GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);
    GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE);
    GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE);

    GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, tex, 0);
    tex.recycle();

    if(texture[0] == 0){
        // Displays error
    }

    return texture[0];

} 
```

顶点着色器：

```
attribute vec4 a_Position;
attribute vec2 a_TexCoordinate;
varying vec2 v_TexCoordinate;

void main() {
  v_TexCoordinate = a_TexCoordinate;
  gl_Position = a_Position;
} 
```

片段着色器：

```
precision mediump float;
varying vec2 v_TexCoordinate;
uniform sampler2D u_Texture;

void main() {
  gl_FragColor = texture2D(u_Texture, v_TexCoordinate);
} 
```

我看了一些东西：

*   使用 png、jpg、bmp(565) 测试，分辨率：32x32 和 64x64
*   在绘图函数中，所有行 glGetError()​ 返回 0
*   加载纹理时，Sprite.texture 不为 0（大约为 70001）
*   如果我将片段着色器更改为 gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5); 它正在工作。

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T08:02:50.387

我想出了答案：

当我加载纹理时，我没有正确地将它传递给 OpenGL。

我添加了 TextureLoader.loadTexture 一个 GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture[0]); 像这样的行：

```
...
Bitmap tex = BitmapFactory.decodeResource(context.getResources(), resource, bo);    
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture[0]); 
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
... 
```

现在它正在工作。

# oracle - 在特定条件下使列只读

> ID：15991601
> 
> 赞同：1
> 
> 时间：2013-04-13T18:52:54.280
> 
> 标签：oracle, plsql

我正在尝试创建某种触发器以防止在今天日期之后编辑行（将使用 SYSDATE 来获取）。

我不确定如何执行此操作，因为我是 PL/SQL 的新手，并且可能会认为某种包使用游标获取日期，然后使用函数将布尔值返回给过程，然后以某种方式停止 DML 语句开火？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T21:40:01.967

显然，您需要一个日期列作为您的目标。截断 SYSDATE 会给你午夜。因此，如果截断的 SYSDATE 大于另一个日期，则它必须至少是第二天。

引发应用程序错误将导致更新失败。请注意，如果您要更新多行，则单个故障将回滚所有更改。

```
create or replace trigger your_trg 
    before update on your_table 
    for each row 
begin
    if trunc(sysdate) > :old.whatever_date then
        raise_application_error(-20000, 'It is too late to change this record');
    end if;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T13:31:43.927

您正在寻找的解决方案是[VPD Column masking](http://docs.oracle.com/cd/B28359_01/network.111/b28531/vpd.htm#i1014682)。VPD 主要用于安全目的，使您能够定义行/列级别的规则以进行数据访问和显示。

# internet-explorer - 网站是否可以在 IE 兼容模式下正常运行？

> ID：15991602
> 
> 赞同：0
> 
> 时间：2013-04-13T18:52:58.543
> 
> 标签：internet-explorer, cross-browser

在 IE 兼容模式下工作时，我在我的网站上观察到一些可怕的视觉效果。

IE兼容模式应该模拟IE6和IE7吗？您的网站在 IE 兼容模式下看起来和往常一样吗？我目前正在使用 IE8 测试我的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:12:16.557

简短回答您的问题：不，您无需担心兼容模式。

长答案：对于大多数用户来说，他们永远不会知道也不关心兼容模式。兼容模式可能会发挥作用有几个原因，但大多数用户不会使用它。

您需要注意的几个原因是：

1.  如果您的站点明确告诉 IE 使用兼容模式。
2.  如果您在本地网络（例如本地主机或公司内部网）上查看该站点。
3.  如果您的网站在代码中有某些特定的错误（尽管这更有可能导致怪癖模式而不是兼容模式）。

兼容模式有两个目的：

*   正在升级但需要向后兼容的公司。
*   希望在旧 IE 版本上测试其网站的开发人员。

大多数用户永远不会在兼容模式下看到您的网站，但是您可以对您的网站做一些事情来确保它绝对不会发生。

*   `<!DOCTYPE>`在页面顶部放置一个有效的。
*   使用`X-UA-Compatible`元标记强制 IE 使用其最佳模式。

我不喜欢链接到我自己的网站，但是我写了一篇相当详细的博客文章，介绍了 IE 的各种模式以及如何确保您的网站以您想要的模式显示。我通常不会发布它，但它在这里是相关的，我认为它对你阅读会很有用。你可以在这里阅读： http: [//spudley.com/blog/keeping-ie-in-standards-mode](http://spudley.com/blog/keeping-ie-in-standards-mode)

希望有帮助。

# python - 无法使用 Twitter API 发布

> ID：15991603
> 
> 赞同：1
> 
> 时间：2013-04-13T18:53:02.517
> 
> 标签：python, twitter

当我运行我的 Twitter 机器人时，我不断收到 400 个错误。

我检查了我正在使用 APIv1.1 并且我在我的速率限制之下：

```
x-ratelimit-class: api
x-ratelimit-limit: 150
x-ratelimit-remaining: 148
x-ratelimit-reset: 1365882051
x-transaction: a561da7695963295 
```

我不知道我的网址是否不正确。我尝试以不同的方式对其进行格式化，但仍然出现相同的错误。我已经尝试了所有 3 种格式：

```
 data = None
    full_url = "https://api.twitter.com/1.1/statuses/retweet/"  + tweet + ".json"
    response = urllib2.urlopen(full_url, data)

    response = urllib2.urlopen("https://api.twitter.com/1.1/statuses/retweet/%s.json" % tweet, data)
    response = urllib2.urlopen("https://api.twitter.com/1.1/statuses/retweet/{}.json".format(tweet), data) 
```

`Tweet`肯定是一个字符串。

这个调用是我程序中的第二个调用。第一个 API 调用会根据条件更新我自己的状态，因此它实际上很少执行推文操作。这会是个问题吗？这个 API 调用也在一个 for 循环中——这可能是个问题吗？

# java - 从 FTP 服务器并行下载的建议

> ID：15991606
> 
> 赞同：0
> 
> 时间：2013-04-13T18:53:21.257
> 
> 标签：java

我是一个新手Java程序员。在这个线程中，我不需要任何特定的程序代码。我只需要一些建议如何开始我的项目。

我有一个当前在 PHP 中运行的程序，我想用 Java 重写它以进行练习。

所以任务是：

1.  我有多个 FTP 服务器，可以说 30 个（可以是任何一个）。
2.  该程序必须连接到这些 ftp 服务器并下载它找到的任何文件。

就这样。我的主要问题是程序必须 24/7 执行此操作，最大的问题是：在 Java 中是否可以进行**并行下载**，如果可以，我应该如何开始？

非常感谢任何指南或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:03:39.663

当然有可能，但正如 D 先生所说，这不是 Java 初学者可以做到的。

只是想知道它涉及什么：

*   多线程 - 对于您希望下载的每个文件，您需要一个线程来完成这项工作。
*   处理下载过程中随时可能发生的多种错误情况，例如连接中断（没有 Internet 连接）、错误的 URL、找不到服务器、服务器没有响应等。
*   如果磁盘上没有可用空间，请注意您的应用程序不会挂起。

还有更多。

更新：基本上你需要一个检查和调度类（例如）`DownloadManager`，它会定期检查服务器列表并在新的.`FTPDownloder``implements Runnable``Thread(new FTPDownloader(downloadData))`

# matlab - 在matlab中创建堆积条形图

> ID：15991610
> 
> 赞同：0
> 
> 时间：2013-04-13T18:53:49.233
> 
> 标签：matlab, plot, bar-chart, stackedbarseries

您好我正在尝试在 matlab 中创建堆积条形图，但输出图似乎将第一个数据集（AD_monthly_generation_250）添加到第二个数据集（CC_monthly_demand_2012）。我怎样才能避免这种情况？

我的代码是

```
%% AD STACKED CC %%

AD_monthly_generation_250 = [186 186 186 186 186 186 186 186 186 186 186 186]';
CC_monthly_demand_2012 = [199.575 206.701 145.284 135.944 127.689 93.281 80.311 78.859 98.145 168.572 206.365 113.030]';

% Create a stacked bar chart using the bar function
figure;
bar(1:12, [ AD_monthly_generation_250 CC_monthly_demand_2012 ], 0.5, 'stack');

% Add title and axis labels
title('Seasonal Anaerobic Digestion (250kWe) Supply to Demand - 2012','FontSize',22);
 set(gca,'XTickLabel',{'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',' Sep',     'Oct', 'Nov',' Dec'},'FontSize',18)
 ylabel('Energy (MWh)'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:05:35.927

我认为该`'stack'`选项按预期工作......试试这个代码，也许这就是你想要的：

```
%% AD STACKED CC %%

AD_monthly_generation_250 = [186 186 186 186 186 186 186 186 186 186 186 186]';
CC_monthly_demand_2012 = [199.575 206.701 145.284 135.944 127.689 93.281 80.311 78.859 98.145 168.572 206.365 113.030]';

% Create a stacked bar chart using the bar function
figure;
% bar(1:12, [ AD_monthly_generation_250 CC_monthly_demand_2012 ], 0.5, 'stack');
bar(1:12, AD_monthly_generation_250, 0.5, 'b');
hold on;
bar(1:12, CC_monthly_demand_2012, 0.5, 'r');
hold off;

% Add title and axis labels
title('Seasonal Anaerobic Digestion (250kWe) Supply to Demand - 2012','FontSize',22);
 set(gca,'XTickLabel',{'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',' Sep',     'Oct', 'Nov',' Dec'},'FontSize',18)
 ylabel('Energy (MWh)'); 
```

# iphone - 使用 UIImagePickerController 播放录制的视频

> ID：15991611
> 
> 赞同：1
> 
> 时间：2013-04-13T18:53:51.497
> 
> 标签：iphone, uiimagepickercontroller, mpmovieplayercontroller

我正在创建一个应用程序，它将使用录制视频，并将录制的视频`UIImagePickerController`保存在文档目录中并尝试在单击时播放视频`USE`（想要显示录制视频的完整第一帧以及中间的播放按钮，例如iPhone 的原生应用程序）。

我可以录制视频并将其保存到文档目录中，但无法创建帧和播放。

我试图继续学习新课程，在那里我可以播放录制的视频，但单击`USE`按钮时崩溃了。

这是我的代码

```
-(void)btnRecord_Press
{
    BOOL canRecordVideo;

    canRecordVideo = [UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera];

    if (canRecordVideo)
    {
        UIImagePickerController *videoRecorder = [[UIImagePickerController alloc]init];
        videoRecorder.sourceType = UIImagePickerControllerSourceTypeCamera;
        videoRecorder.delegate=self;

        videoRecorder.showsCameraControls = TRUE;

        NSArray *mediaTypes = [UIImagePickerController availableMediaTypesForSourceType:UIImagePickerControllerSourceTypeCamera];

        NSArray *videoMediaTypesOnly = [mediaTypes filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"(SELF CONTAINS %@)",@"movie"]];

        BOOL movieOuputPossible  = (videoMediaTypesOnly!=nil);

        if (movieOuputPossible)
        {
            videoRecorder.mediaTypes = videoMediaTypesOnly;

            [self presentViewController:videoRecorder animated:YES completion:nil];
        }

    }
}

-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    NSURL *videoURL = [info objectForKey:UIImagePickerControllerMediaURL];

    NSData *videoData = [NSData dataWithContentsOfURL:videoURL];
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *tempPath = [documentsDirectory stringByAppendingFormat:@"/vid1.mp4"];

    BOOL success = [videoData writeToFile:tempPath atomically:NO];

    [self dismissViewControllerAnimated:NO completion:nil];

    PlayMovie *play = [[PlayMovie alloc]initWithNibName:@"PlayMovie" bundle:Nil];

    [self.navigationController pushViewController:play animated:YES];

} 
```

任何帮助都是不言而喻的。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T08:40:40.480

我使用这段代码做到了这一点。

```
-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    videoURL = [info objectForKey:UIImagePickerControllerMediaURL];

    [self dismissViewControllerAnimated:NO completion:nil];

    [self Play];

}

-(void)Play
{

    NSData *videoData = [NSData dataWithContentsOfURL:videoURL];
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *tempPath = [documentsDirectory stringByAppendingFormat:@"/vid1.mp4"];

    BOOL success = [videoData writeToFile:tempPath atomically:NO];

    player = [[MPMoviePlayerController alloc]initWithContentURL:videoURL];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(btnDone_Press) name:MPMoviePlayerWillExitFullscreenNotification object:nil];

    self._player.shouldAutoplay = NO;

    UIImage *thumbnail = [player thumbnailImageAtTime:1.0 timeOption:MPMovieTimeOptionNearestKeyFrame];

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
    {        
        screenSize = [[UIScreen mainScreen]bounds].size;

        if (screenSize.height >480.0f)
        {
            player.view.frame = CGRectMake(0, 0, 320, 548);

        }
        else
        {
            player.view.frame = CGRectMake(0, 0, 320, 460);

        }

    }

    [self.view addSubview:player.view];

    self._player.scalingMode = MPMovieScalingModeAspectFit;

    self._player.fullscreen = YES;

    [self._player play];
} 
```

# android - switch 语句后无法访问的代码

> ID：15991613
> 
> 赞同：3
> 
> 时间：2013-04-13T18:53:56.297
> 
> 标签：android, eclipse

```
public Cursor query(Uri paramUri, String[] paramArrayOfString1, String paramString1,String[] paramArrayOfString2, String paramString2)
  {             
SQLiteQueryBuilder localSQLiteQueryBuilder = new SQLiteQueryBuilder();
    if (paramUri.getPathSegments().size() == 1);
     for (StringBuilder localStringBuilder = null; ; localStringBuilder = new   StringBuilder(100))
      switch (sURIMatcher.match(paramUri))
      {
    case 0:

    case 1:

    case 2:

    case 3:
     default:
      throw new IllegalArgumentException("Unknown URI " + paramUri); 
      }
    localSQLiteQueryBuilder.setTables("category");//unreachable code

    while (true)
    {
      Cursor localCursor = localSQLiteQueryBuilder.query(mOpenHelper.getReadableDatabase(), paramArrayOfString1, paramString1, paramArrayOfString2, null, null, paramString2);
      localCursor.setNotificationUri(contentResolver, paramUri);
      return localCursor;
      localSQLiteQueryBuilder.setTables("shop,category");
      localSQLiteQueryBuilder.appendWhere("shop_category_id=category._id");
      continue;
      localSQLiteQueryBuilder.setTables("shop,category");
      StringBuilder localStringBuilder;
  localStringBuilder.append("shop_category_id=category._id");
      localStringBuilder.append(" AND ");
      localStringBuilder.append("_id");
      localStringBuilder.append('=');
      localStringBuilder.append((String)paramUri.getPathSegments().get(1));
      localSQLiteQueryBuilder.appendWhere(localStringBuilder.toString());
      continue;
     localSQLiteQueryBuilder.setTables("shop,category");
     localSQLiteQueryBuilder.setDistinct(true);
     localStringBuilder.append("shop_category_id=category._id");
     localStringBuilder.append(" AND ");
     localStringBuilder.append("shop_category_id");
     localStringBuilder.append('=');
     localStringBuilder.append((String)paramUri.getPathSegments().get(1));
     localSQLiteQueryBuilder.appendWhere(localStringBuilder.toString());
     paramString2 = "shop._id";
}
} 
```

switch 语句后出现无法访问的代码错误，我无法弄清楚如何解决它。我试图删除该行，但如果我这样做了，我会收到很多错误。我的代码在上面。有人可以帮助我吗？谢谢进步。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T19:00:42.777

代码真的无法访问：

所有案例都是失败的（它们没有`break`语句，因此匹配后的所有案例都将执行）并以`default`抛出`Exception`. 这意味着抛出后的代码`Exception`将永远不会被执行。

也许你的意思是这样的：

```
 switch (sURIMatcher.match(paramUri)){
    case 0:
      // do something
      break;
    case 1:
      // do something
      break;
    case 2:
      // do something
      break;
    case 3:
      // do something
      break;
    default:
      throw new IllegalArgumentException("Unknown URI " + paramUri); 
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:03:28.980

我想这是由于你的开关不好......你必须使用`break;`

```
switch (sURIMatcher.match(paramUri))
  {
case 0:
      //your code
      break;
case 1:
      //your code
      break;
case 2:
       //your code
      break;
case 3:
      //your code
      break;
default:
     //your code
     break;      
 } 
```

# jquery - 使用 JQuery 递归遍历 xml

> ID：15991614
> 
> 赞同：1
> 
> 时间：2013-04-13T18:53:56.810
> 
> 标签：jquery, recursion, xml-parsing

```
 <div id="page-wrap"></div>

    $(document).ready(function(){
       var xml = "<root> \
            <method name='A'> \
            <childcall name='B'></childcall> \
            <childcall name='C'></childcall> \
            </method> \
            <method name='B'> \
            <childcall name='D'></childcall> \
            </method> \
            <method name='C'> \
            <childcall name='D'></childcall> \
            <childcall name='E'></childcall> \
            </method> \
            <method name='D'> \
            <childcall name='F'></childcall> \
            </method> \
            </root>";

        var data = $.parseXML(xml);
        console.log(data);
        //alert(data);

        var htmltxt="<ul>";
        $(data).find('method').each(traverseXml);
        htmltxt = htmltxt + "</ul>";
        //alert(htmltxt);
        $("#page-wrap").html(htmltxt);

     function traverseXml(data){
            var namenode = $(this).attr('name');
            var count = 0;
            $(this).children('childcall').each(function(){ count++; });
            if(count>0){
                htmltxt = htmltxt + "<li class='category'>" + namenode +"<ul>";

                $(this).children('childcall').each(function(){ 
                        var name = $(this).attr('name');
                        htmltxt = htmltxt + "<li>" + name + "</li>";    
                });
                htmltxt = htmltxt + "</ul></li>";
            }else{
                htmltxt = htmltxt +"<li>"+namenode+"</li>";
            }
         }

$('li.category').addClass('plusimageapply');
$('li.category').children().addClass('selectedimage');
$('li.category').children().hide();
$('li.category').each(
function(column) {
$(this).click(function(event){
if (this == event.target) {
if($(this).is('.plusimageapply')) {
$(this).children().show();
$(this).removeClass('plusimageapply');
$(this).addClass('minusimageapply');
}
else
{
$(this).children().hide();
$(this).removeClass('minusimageapply');
$(this).addClass('plusimageapply');
}
}
});
}
);
  }); 
```

代码遍历了一级xml。这是小提琴 - [http://jsfiddle.net/CKa6V/10/](http://jsfiddle.net/CKa6V/10/)

我希望递归遍历 xml 节点，以便每个节点都扩展到最后一个子节点。例如，A 扩展为 B，然后 B 变得可扩展并扩展为 D，最后 D 扩展为 F。对于所有节点也是如此。

编辑：对不起，如果问题不清楚。我正在寻找以下输出 -

```
A
|__B
   |__D
      |__F
|__C
   |__D
      |__F
   |__E
B
|__D
   |__F
C
|__D
   |__F
|__E

D
|__F 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T12:02:55.913

我将从[我在您上一个问题上完成的代码](https://stackoverflow.com/a/15925282/460368)开始，并将其修改如下（链接到此答案末尾的新小提琴）：

JS：

```
var xml = "<root> \
            <method name='A'> \
            <childcall name='B'></childcall> \
            <childcall name='C'></childcall> \
            </method> \
            <method name='B'> \
            <childcall name='D'></childcall> \
            </method> \
            <method name='C'> \
            <childcall name='D'></childcall> \
            <childcall name='E'></childcall> \
            </method> \
            </root>";

        var data = $.parseXML(xml);
        console.log(data);
        var curLi = [];
        $(data).find('method').each(function(){
            var hasChild = $(this).children('childcall').length > 0;
            curLi.push('<li');
            curLi.push(((hasChild) ? ' class="category plusimageapply">': '>'));
            curLi.push($(this).attr('name'));
            if(hasChild){
                curLi.push('<ul>');
                 $(this).children('childcall').each(function(){
                     var name = $(this).attr('name');
                     curLi.push('<li><a href="'+name+'">'+name+'</a></li>');
                 });
                curLi.push('</ul>');
            }
            curLi.push('</li>');
         });
        $('#test').append(curLi.join(''));

$('li.category').click(function(event){
    if($(this).is('.plusimageapply')) {
        $(this).children().show();
        $(this).removeClass('plusimageapply');
        $(this).addClass('minusimageapply');
    }
    else
    {
        $(this).children().hide();
        $(this).removeClass('minusimageapply');
        $(this).addClass('plusimageapply');
    }
}); 
```

HTML：

```
<ul id="test">

</ul> 
```

[http://jsfiddle.net/dujRe/9/](http://jsfiddle.net/dujRe/9/)

* * *

## 编辑

好吧，我以为你在谈论身体扩张——因为每个孩子都必须展示出来。

对于您的树，您可以这样做：

JS：

```
var data = $.parseXML(xml);
var curLi = [];
function parseBranch(l){
    var b = $(data).find('method[name='+l+']');
    if(b.length > 0){
        curLi.push('<ul>');
    }
    b.each(function(){
        $(this).children('childcall').each(function(){
            var name = $(this).attr('name');
            curLi.push('<li><a href="'+name+'">'+name+'</a>');
            parseBranch(name); // recursion here
            curLi.push('</li>');
        });
    });
    if(b.length > 0){
        curLi.push('</ul>');
    }
}
$(data).find('method').each(function(){
    var hasChild = $(this).children('childcall').length > 0;
    curLi.push('<li');
    curLi.push(((hasChild) ? ' class="category plusimageapply">': '>'));
    curLi.push($(this).attr('name'));
    if(hasChild){
        curLi.push('<ul>');
        $(this).children('childcall').each(function(){
            var name = $(this).attr('name');
            curLi.push('<li><a href="'+name+'">'+name+'</a>');
            parseBranch(name);
            curLi.push('</li>');
        });
        curLi.push('</ul>');
    }
    curLi.push('</li>');
});
$('#test').append(curLi.join(''));

$('li.category').click(function(event){
    if($(this).is('.plusimageapply')) {
        $(this).children().show();
        $(this).removeClass('plusimageapply');
        $(this).addClass('minusimageapply');
    }
    else
    {
        $(this).children().hide();
        $(this).removeClass('minusimageapply');
        $(this).addClass('plusimageapply');
    }
}); 
```

[http://jsfiddle.net/dujRe/10/](http://jsfiddle.net/dujRe/10/)

# c# - 如何将值显示为百分比？

> ID：15991619
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:54:13.430
> 
> 标签：c#

我正在用 C# 构建一个测验，它可以工作并将结果显示为字符串，但是我希望结果显示为 % - 我该怎么做？

```
protected void Button1_Click(object sender, EventArgs e)
{
    int score = 0;

    if (qn1.SelectedValue == "Yes")
        score++;
    if (qn2.SelectedValue == "Yes")
        score++;
    if (qn3.SelectedValue == "Yes")
        score++;
    if (qn4.SelectedValue == "Yes")
        score++;
    if (qn5.SelectedValue == "Yes")
        score++;

    literalScore.Text = score.ToString();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T19:01:34.863

您需要提供[`FormatProvider`](http://msdn.microsoft.com/en-us/library/d830955a%28v=vs.85%29.aspx)to`ToString()`方法。在您的情况下`P`需要用于百分比 -

```
score = (double)score/(double)totalPossible;
literalScore.Text = score.ToString("P"); 
```

从[这里](http://msdn.microsoft.com/en-gb/library/dwhawy9k.aspx#PFormatString)的链接-

> 百分比 ("P") 格式说明符将数字乘以 100 并将其转换为表示百分比的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T19:52:57.600

我不确定我是否清楚地理解了你的问题。但我从你的问题中了解到的是，如果有人回答了 3 个问题，那么他的百分比应该是 60 %，并且应该写在结果中。

```
 protected void Button1_Click(object sender, EventArgs e)     
 {
 int score = 0;

 if (qn1.SelectedValue == "Yes")
    score++;
 if (qn2.SelectedValue == "Yes")
    score++;
 if (qn3.SelectedValue == "Yes")
    score++;
 if (qn4.SelectedValue == "Yes")
    score++;
 if (qn5.SelectedValue == "Yes")
    score++;

 literalScore.Text = (score*20).ToString() + " % ";
 } 
```

如果问题是 5，你必须乘以 20，如果问题是 10，你必须乘以 10

# jquery - jquery scrolltop 脚本不工作

> ID：15991628
> 
> 赞同：1
> 
> 时间：2013-04-13T18:54:54.437
> 
> 标签：jquery, css, scrolltop

我的最终目标是让我的标题在窗口到达某个点时从相对位置切换到固定位置。在试图到达那里时，我想出了这个函数，它不会给我任何错误，但似乎也没有做任何事情。有人可以帮我理解为什么吗？这是页面上加载的最后一个脚本，并且在它之前调用了 jquery..

```
<script type="text/javascript">
$(function() {
var $window = $(window);
function top() {
var $top = $window.scrollTop();
if( $top > 100 ) {
    $("header").css("position","absolute"); 
}
else {
    $("header").css("position","fixed");    
}
};
});
</script> 
```

如果我想将其限制为移动应用程序怎么办？不应该这样的工作......

```
<script type="text/javascript">
 $(function() {
     var $window = $(window).width();
     function windowWidth() {
         if ( $window < 480 ) {
      function top() {
          var $top = $window.scrollTop();
          if( $top > 100 ) {
             $("header").css("position","absolute"); 
           }
           else {
              $("header").css("position","fixed");    
          }
     };
     $(window).scroll(top);
         }
     };
   });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T18:57:04.143

使用`$(window).scroll(top)`或使用`setTimeInterval(top, 100);`

假设标头为 id

```
<script type="text/javascript">
 $(function() {
     var $window = $(window);
      function top() {
          var $top = $window.scrollTop();
          if( $top > 100 ) {
             $("#header").css("position","absolute"); 
           }
           else {
              $("#header").css("position","fixed");    
          }
     };
     $(window).scroll(top);
   });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:02:25.033

它没有做任何事情的原因是你没有调用它。您没有任何东西可以触发代码。我假设这是你找到的[这个脚本。](https://stackoverflow.com/questions/10593891/track-the-scroll-position-beyond-elements#answer-10594396)如果您注意到它包含在 $(window).scroll 中，而不仅仅是函数，则可以触发它。

因此，您需要修改代码：

```
$(window).scroll(function() {
    if($(window).scrollTop() > 100) {
        $("header").css("position","absolute"); 
    } else {
        $("header").css("position","fixed");    
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:03:58.883

我认为您没有`.scroll()`在给定代码中的任何地方调用该函数，因此它永远不会被触发：

```
<script type="text/javascript">
  $(function() {
     var $window = $(window);
     function top() {
        var $top = $window.scrollTop();
        if( $top > 100 ) {
            $("header").css("position","absolute"); 
        }else {
            $("header").css("position","fixed");    
        }
     };
     $window.scroll(top);
  });
</script> 
```

# haskell - 为什么我在 Haskell 中接收堆栈溢出消息？

> ID：15991634
> 
> 赞同：3
> 
> 时间：2013-04-13T18:55:29.920
> 
> 标签：haskell, stack-overflow

```
 import Data.Vector hiding((++))
 import System.Environment 
 d = generate 1000000 (\z->case z of
                      0 -> 2
                      1 -> 3
                      2 -> 5
                      otherwise -> if odd z then (d ! (z-1)) +2 else (d ! (z-1)) + 4)
 algorithmA _ _  1 pt  = pt
 algorithmA t k n pt = let dk = d ! k
                       q = div n dk
                       r = mod n dk
                      in if r /=0 then
                            if q>dk then
                              algorithmA t (k+1) n pt
                            else (n:pt)
                         else
                             algorithmA (t+1) k q (dk:pt)

main = do
        args<-getArgs
        let n = read (args !! 0)
        if (floor(sqrt(fromInteger n))) > Data.Vector.last d  then error ("The square  root of number is greater than " ++ show (Data.Vector.last d))
     else
         print (algorithmA 0 0 n []) 
```

当我编译上述程序并在命令行中给出示例时，`test1 2222`我会收到消息“Stake space overflow: current size ... use +RTS -Ksize -RTS to increase ...”。但是当我删除 main 函数中的 if 时，程序可以正常工作。此外，如果我在 ghci 中给出命令`Data.Vector.last d` ，则计算出的值没有问题。那么为什么要打印此消息？当我将堆栈大小增加到 20M 时，程序可以毫无问题地播放。test1 是可执行文件的名称。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T20:25:21.730

问题是您的代码在构建`d`. 请记住，这`Data.Vector.Vector`是一个*装箱*向量类型 - 也就是说，它在内部表示为指向堆对象的指针数组（它们是值或未评估的[thunk](http://hackage.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects#Thunks)）。因此，当您填充`d`时`generate`，您实际上是在创建一个 thunk 向量。在您的示例中，当`n`访问 position 处的 thunk 时，它会触发对位置`n-1`和处的 thunk 的评估`n-2`，这反过来又会触发对 thunk `n-3`、`n-4`等的评估`n-5`。因此，评估最后一个元素会导致评估先前的`1000000 - 1`元素，从而导致堆栈增长。这就是为什么您会收到堆栈溢出错误。

在不修改代码的情况下解决此问题的一种简单方法[是在访问最后一个元素之前完全评估整个向量](https://gist.github.com/23Skidoo/5379967)。在这种情况下，所有 thunk 都按顺序评估并且没有堆栈溢出（因为一旦评估了 thunk，它就会被它所代表的表达式的值替换，所以当你在评估元素`n`之后评估元素`n-1`时`n-2`，只有必须访问这两个元素，并且不会触发所有先前 thunk 的级联评估）：

```
import Control.DeepSeq (($!!))
...
let l = V.last $!! d
... 
```

测试：

```
$ ghc -O2 Test.hs
[1 of 1] Compiling Main             ( Test.hs, Test.o )
Linking Test ...
$ ./Test 2222    
[101,11,2] 
```

或者，您可以[使用未装箱的向量](https://gist.github.com/23Skidoo/5379892)（`Int`s 的平面数组）：

```
d :: U.Vector Int
d = U.create $ do
  v <- M.new dSize
  go 0 v
    where
      dSize = 1000000
      go i v | i >= dSize = return v
             | otherwise = do
               val <- case i of
                 0 -> return 2
                 1 -> return 3
                 2 -> return 5
                 _ -> if odd i
                      then (+2) <$> (M.read v (i-1))
                      else (+4) <$> (M.read v (i-1))
               M.write v i val
               go (i+1) v 
```

# automake - Automake：在默认源中包含额外文件

> ID：15991636
> 
> 赞同：1
> 
> 时间：2013-04-13T18:55:46.490
> 
> 标签：automake

我正在为我的库编写一些简单的测试，并且我试图让我的 Makefile.am 文件尽可能整洁，所以我试图依赖[默认的 _SOURCES](https://www.gnu.org/savannah-checkouts/gnu/automake/manual/html_node/Default-_005fSOURCES.html)功能。这是我当前的 Makefile.am：

```
AM_CPPFLAGS = $(MYLIB_CFLAGS) -I..
AM_DEFAULT_SOURCE_EXT = .vala
AM_LDFLAGS = $(MYLIB_LIBS)
VALAFLAGS = -D GLIB_2_32 --vapidir=../ --pkg mylib_internal --pkg libsoup-2.4 --pkg json-glib-1.0 --pkg gee-1.0

TESTS = autocomplete
check_PROGRAMS = autocomplete

autocomplete_LDADD = ../mylib.la
autocomplete_SOURCES = autocomplete.vala common.vala

CLEANFILES = *.c 
```

如果我省略了`autocomplete_SOURCES`变量，则自动使用 autocomplete.vala，这很好（根据默认的 _SOURCES 功能），但我*还需要*包含 common.vala。事实上，我要编写的每个测试程序都希望在其源文件列表中包含这个 common.vala。有没有办法让我不必为`*_SOURCES`我编写的每个测试程序指定？

奖励：他们也都希望在他们的文件中包含 mylib.la `*_LDADD`，所以，我有没有办法在全局范围内完成此任务，而不必为每个测试程序指定它？

**编辑：**我发现您可以`LDADD`不使用前缀就可以将其应用于每个已编译的程序。这有点帮助......现在弄清楚`*_SOURCES`......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-01T19:44:15.957

没有办法做到这一点。

如果需要，您可以引入一个随处使用的变量：

```
general_stuff = whatever.vala
x_SOURCES = $(general_stuff) ...
y_SOURCES = $(general_stuff) ... 
```

# ruby-on-rails - Restful Authentication——如何在没有密码的情况下登录用户

> ID：15991639
> 
> 赞同：0
> 
> 时间：2013-04-13T18:55:55.360
> 
> 标签：ruby-on-rails, restful-authentication

我有一个跨网站集成要处理。基本上我将一个参数传递给 rails 应用程序，如果它评估正确......那么我想登录一个用户。

这可以在没有用户密码的情况下完成吗？

像简单地将密码评估为真的一样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T21:09:05.030

这称为“令牌身份验证”，并由 Devise 支持，或者可以相对容易地自行启动。您想生成一个不可猜测的秘密令牌（您的参数），然后使用它代替用户名。设计 wiki 有几个示例的链接：

[https://github.com/plataformatec/devise/wiki/How-To:-Simple-Token-Authentication-Example](https://github.com/plataformatec/devise/wiki/How-To:-Simple-Token-Authentication-Example)

如果您想要一个更轻量级的解决方案，您还可以简单地生成一个身份验证令牌（使用 bcrypt 之类的东西），然后执行以下操作：

```
@user = User.find_by_auth_token(params[:auth_token]) 
```

如果 @user 为 nil，则返回 403。

# python - 使用 ATpy 和 numpy 高效读取大文件？

> ID：15991640
> 
> 赞同：1
> 
> 时间：2013-04-13T18:55:59.867
> 
> 标签：python, numpy, scipy, large-files, astronomy

我已经到处寻找这个问题的答案，但似乎没有什么真正符合要求。我有非常大的文件，我试图用 ATpy 读取，数据以 numpy 数组的形式出现。对于较小的文件，以下代码就足够了：

```
sat = atpy.Table('satellite_data.tbl') 
```

从那里我建立了一些变量，我必须在以后进行操作以用于绘图目的。有很多这样的操作：

```
w1 = np.array([sat['w1_column']])
w2 = np.array([sat['w2_column']])
w3 = np.array([sat['w3_column']])

colorw1w2 = w1 - w2 #just subtracting w2 values from w1 values for each element
colorw1w3 = w1 - w3 
```

等等

但是对于非常大的文件，计算机无法处理。我认为在解析开始之前所有数据都存储在内存中，这对于 2GB 文件是不可行的。那么，我可以用什么来处理这些大文件呢？

我看过很多帖子，人们将数据分解成块并使用`for`循环遍历每一行，但鉴于这些文件的性质和操作类型，我认为这对我不起作用我需要在这些阵列上做。我不能只对文件的每一行进行一次操作，因为每一行都包含许多分配给列的参数，在某些情况下，我需要对单个列中的数字进行多项操作。

老实说，我并不真正了解 ATpy 和 numpy 幕后发生的一切。我是 Python 的新手，所以我很欣赏清楚拼写出来的答案（即不依赖大量隐式编码知识）。必须有一种干净的方式来解析它，但我没有找到它。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:11:30.417

研究使用熊猫。它是为这种工作而建造的。但是数据文件需要以结构良好的二进制格式（如 hdf5）存储，以便在任何解决方案中获得良好的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T01:13:13.403

对于非常大的数组（大于内存容量），您可以使用[pytables](http://pytables.org)，它以一些巧妙的方式（使用 HDF5 格式）将数组存储在磁盘上，这样就可以对它们进行操作，而无需一次将整个数组加载到内存中。然后，您不必手动分解数据集或一次一行地操作它们。

我对 ATpy 一无所知，所以你最好在 ATpy 邮件列表或至少一些天文学 python 用户邮件列表上询问，因为 ATpy 可能内置了另一个解决方案。

* * *

从 pyables 网站：

> PyTables 是一个用于管理分层数据集的包，旨在高效、轻松地处理大量数据。
> 
> PyTables 建立在 HDF5 库之上，使用 Python 语言和 NumPy 包。
> 
> ... 快速，但非常易于使用的交互式浏览、处理和搜索大量数据的工具。PyTables 的一个重要特性是它优化了内存和磁盘资源，以便数据占用更少的空间......

# android - MediaPlayer.create() 导致致命信号 11 无法控制的错误

> ID：15991643
> 
> 赞同：1
> 
> 时间：2013-04-13T18:56:31.337
> 
> 标签：android, android-mediaplayer

我的游戏从显示介绍视频开始，然后加载主菜单并播放歌曲。以下是歌曲的创作和执行。

```
 try
    {System.out.println("?????????? create and play");
        menuSong = MediaPlayer.create(this, R.raw.kindergarten_ska);
        menuSong.setLooping(true);
        menuSong.start();
    }
    catch (Exception e)
    {
        System.out.println("??????????? caught");
    } 
```

`A/libc(1898): Fatal signal 11 (SIGSEGV) at 0x00000000 (code=1)`在 MediaPlayer.create() 期间引发错误。烦人的部分是，应用程序没有发现错误，而是回到了介绍！然后以无限循环结束。这意味着（据我所知）我无能为力来处理错误。

此外，尝试从我的 4.0.4 平板电脑运行时会发生此错误。它在我的 2.2.1 手机上运行良好。

像这样的错误会让我相信某些东西是空的，但在这种情况下唯一可能的就是 R 值。这是一个 ogg 文件，所以我不明白为什么它不能在平板电脑上运行。

同样有趣的是，这是唯一会崩溃的 MediaPlayer 用法。MediaPlayer 在代码的其他地方工作得很好。

# c# - ASP.NET 自动注销

> ID：15991652
> 
> 赞同：4
> 
> 时间：2013-04-13T18:57:28.477
> 
> 标签：c#, asp.net, asp.net-mvc

我正在和另外 4 个人一起做一个小组项目。我们正在使用嵌入式 c# 在 MVC4 中的 ASP.NET 中设计一个工作亭。

我正在努力让系统在用户空闲 10 分钟时将其注销。我需要一些关于如何开始编写系统以注销用户的方法的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T19:12:29.107

如果您不使用“Windows 身份验证”，这至少取决于您可以通过 web.config 控制的会话超时：

```
<configuration>
    <system.web>
        <sessionState timeout="10" />
    </system.web>
</configuration> 
```

由于大多数技术以某种方式依赖于会话，因此这在大多数情况下都有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-13T21:51:11.070

您正在寻找的答案是 AliK 建议的答案。您想在 web.config 中设置自动超时，以便在一定的空闲时间后自动注销用户并将其重定向到登录页面。

```
<authentication mode="Forms">
   <forms loginUrl="Login.aspx" protection="All" timeout="1" slidingExpiration="true">
   </forms>
</authentication> 
```

如果我没记错的话，超时值以分钟为单位，而不是秒或毫秒。此外，滑动到期意味着每次您在网站上执行操作时都会重置超时。因此，如果您有 5 分钟的超时，并且在单击站点上的按钮之前闲置了 4 分钟，那么在单击按钮后，您将获得新的 5 分钟超时。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-25T20:55:48.217

如果您使用 FormsAuthentication，我会这样做：

控制器动作：

```
public ActionResult CheckLogin()
{
    if (Request.Cookies["CookieName"] == null) return Json(0, JsonRequestBehavior.AllowGet);
    var cookie = Request.Cookies["CookieName"].Value;
    var ticket = FormsAuthentication.Decrypt(cookie);
    var secondsRemaining = Math.Round((ticket.Expiration - DateTime.Now).TotalSeconds, 0);
    return Json(secondsRemaining, JsonRequestBehavior.AllowGet);
} 
```

每个页面或布局页面上的 Jquery：

```
<script>
    $(function () {
        setTimeout(doStuff, 1000);
    });
    function doStuff() {
        $.ajax("/CheckLogin").done(function (data) {
            if (data <= 60) {
                startLogout(data);
            } else {
                setTimeout(doStuff, 1000);
            }
        });
    }

    function startLogout(seconds) {
        var countdown = setInterval(function () {
            //Show something here
            if (count == 0) {
                clearInterval(countdown);
                //Do something here
            }
            seconds--;
        }, 1000);
    }
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T17:27:35.367

如果您需要让他们自动注销，请从 Linus Caldwell 的设置 web.config 会话超时的建议开始。他的示例显示 30 分钟，因此您只需将其更改为 10 分钟。但是，用户不会知道他们已注销，直到他们实际尝试请求某些服务器资源。要让这种情况自动发生，您可以采取多种方式。这两种方式都涉及在超时期限到期后自动刷新页面。一种方法是使用 javascript 计时器。另一种是为每个页面添加一个刷新标题。

```
<script type="text/javascript">
var seconds = 60 * 11;// set timer for 11 minutes (1 minutes after session expires)
countdown();
function countdown(){
   seconds--;
   if (seconds <= 0){
          window.location.reload(); // force a refresh.
   }else{
          setTimeout('countdown()', 1000);
   }
}
</script> 
```

另一种方法是在你的 global.asax 中：

```
protected void Application_BeginRequest()
{
    Response.Headers.Add("Refresh", Convert.ToString(Session.Timeout * 11));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-14T19:07:57.887

如果空闲意味着用户没有鼠标和键盘事件，并且我正确理解了您的要求，您应该检查[jquery-idleTimeout](https://github.com/philpalmieri/jquery-idleTimeout)插件。

另一个不错的是[jQuery idleTimer Plugin](http://paulirish.com/2009/jquery-idletimer-plugin/)

希望这可以帮助。

# javascript - Javascript 再次无法在 JSF 模板下工作

> ID：15991653
> 
> 赞同：0
> 
> 时间：2013-04-13T18:57:29.590
> 
> 标签：javascript, html, jsf-2, xhtml, facelets

我找到了[BalusC 回答的主题](https://stackoverflow.com/questions/11027285/javascript-does-not-work-under-jsf-template)

它描述了我遇到的确切问题。当我找到它时，我以为我也找到了答案，但对我来说，解决方案不起作用。我已经遇到了 <h:outputScript> 标签的问题，也许是同样的问题（<script> 标签正在工作）。

我与用户 Plaha 有相同的项目描述，这提出了问题。我正在尝试使用支持 JSF bean 的参数属性调用模板页面中定义的 JavaScript 函数。但是现在警报功能就足够了。

我试图使页面 gridTest.xhtml 看起来像示例中的 content.xhtml，但它不起作用。

gridsTemplate.xhtml 看起来与线程中的模板一模一样 + 我有 <head> 标记，其中有一些 JavaScript 函数。我的gridTest.xhtml：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:c="http://java.sun.com/jsp/jstl/core">

<h:head>
<link rel="stylesheet" type="text/css"
    href="/juritest/resources/css/style.css" />
<script type="text/javascript"
    src="/juritest/resources/js/jquery-1.8.2.js"></script>
<script type="text/javascript" src="/juritest/resources/js/menu.js"></script>
</h:head>

<body>
<ui:composition template="../../templates/gridsTemplate.xhtml">
    <ui:define name="content">
        <h:form rendered="#{gridPopUpBean.testNotStarted}">
            ...
        </h:form>
        <h:form rendered="#{not gridPopUpBean.testNotStarted}">
            <h:outputScript target="body">
                alert("working?");
            </h:outputScript>
  ... 
```

出于好奇，我尝试将 < h:outputScript 直接放在 ui:define 下，就像示例中一样，但它也不起作用。

# javascript - 如何将实时流媒体页面限制为每个用户一个连接？

> ID：15991656
> 
> 赞同：1
> 
> 时间：2013-04-13T18:57:41.037
> 
> 标签：javascript, node.js, connection, streaming, user-tracking

我想限制连接到我的直播页面的限制用户，这样用户就不能在同一帐户下从不同位置共享密码和多次登录。

我不介意一个用户在家中使用两台不同的设备登录，例如电脑和谷歌电视。这让我认为基于源 IP 地址的限制是处理这个问题的正确方法。

问题是，如果用户登录，并且我记录了他们的 IP 地址，并限制他们仅从该 IP 登录，他们就无法更改位置。

使用 HTTP，在他们登录后，它是无连接的，所以我忘记了他们是否正在观看来自 CDN 的流。

这让我觉得如果用户登录到另一个位置，我应该在客户端使用 javascript 来断开播放器的连接。

这意味着我需要一种以合理可扩展的方式与登录客户端进行通信的方法。

你能建议一个合适的方法来处理这个问题吗？我觉得必须有一个简单且可扩展的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T22:58:19.597

这实际上取决于您对绕过您的访问控制的人的敏感程度。

如果您对某些人绕过它们感到满意，那么您可以在客户端执行访问控制，并让客户端每 60 秒左右 ping 服务器一次，告诉服务器它仍在流式传输。然后在服务器中，将用户的 IP 地址存储在过期队列中。因此，如果玩家停止 ping 服务器，IP 地址将在 3 分钟后从队列中过期。通过 ping 服务器，我的意思是发送一个简单的 http GET 请求以保持会话打开。当用户关闭客户端时，ping 将停止，您的服务器将在 3 分钟后使该客户端的 IP 地址过期。此时，用户可以使用不同的 IP 地址登录。

重要的是要记住，精明的用户将能够在 Chrome 等浏览器中观看网络事件，并查看您的内容从哪里提供，并轻松绕过任何限制，因为您无法控制 CDN 本身。

如果您需要更严格的控制，则需要从服务器提供内容。然后，您绝对会知道客户端何时停止访问流。

可能有一个中间立场。如果您担心没有 CDN 的流式传输速度，您可以考虑查看 CloudFlare.com。CloudFlare 是一个 CDN 层，位于所有 http 请求的前面，甚至是动态请求。静态请求从边缘提供，就像普通的 CDN 一样，但动态请求通过 CloudFlare 的网络反向代理，每次都返回到您的服务器。如果您将流式传输请求设置为看起来像 CloudFlare 的动态内容，那么您将获得通过与边缘点的低延迟、高带宽连接进行流式传输的潜在好处，同时仍然能够单独跟踪用户。

# javascript - 如何在特定父级下仅选择一个 div

> ID：15991664
> 
> 赞同：0
> 
> 时间：2013-04-13T18:58:44.990
> 
> 标签：javascript, jquery

我想对具有“可搜索”类的 div 执行搜索，但我不确定应该如何选择它。我之前尝试过类似代码的东西，但它没有用。

```
 $('#SEARCH').change(function () {
                //if (e.which == 13) {
                    var txt = $('#SEARCH').val();
                    $('.divin').each(function(){
                       if($(this + ' > .searchable').text().toUpperCase().indexOf(txt.toUpperCase()) == -1){
                           $(this).hide();
                       }
                    });
                //}
            }); 
```

**($(this + ' > .searchable')**不正确

HTML：

```
<li id="listItem_156" class="divin">
<div style="width:30px;">
    <a href="#?w=800" rel="popup_name" id="156" class="poplight">
        <img height="16" style="cursor:move;" width="16" src="img/arrow.png" border="0"  />
    </a>
</div>
<div style="width:220px;" class="searchable">
    <a href="action=MemberDetails&item=156" class="body">Mike Frank </a> 
</div>
<div style="width:110px;">
    0 
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:00:01.860

利用`jQuery.find`

```
if($(this).find(' >.searchable').text().toUpperCase().indexOf(txt.toUpperCase()) == -1){
      $(this).hide();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:05:46.347

为什么不直接这个

```
 $('.divin .searchable').each(function(){ 
```

因此

```
 $('#SEARCH').change(function () {
                //if (e.which == 13) {
                    var txt = $('#SEARCH').val();
                    $('.divin .searchable').each(function(){
                       if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) == -1){
                           $(this).parent().hide();
                       }
                    });
                //}
            }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:17:41.643

[在 jsfiddle](http://jsfiddle.net/bQLS9/)

```
 $('#SEARCH').change(function () {
        var txt = $('#SEARCH').val();
        $('.divin .searchable').show().filter(function () {
              return $(this).text().toUpperCase().indexOf(txt.toUpperCase()) === -1
        }).hide();

    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-13T19:10:44.660

你有两种方法：

首先是`.find()`：

```
$('.divin').each(function(){
   if($(this).find('> .searchable').text().toUpperCase().indexOf(txt.toUpperCase()) == -1){
        $(this).hide();
   }
}); 
```

第二个给定的上下文是这样的：

```
$('.divin').each(function(){
   if('> .searchable', this).text().toUpperCase().indexOf(txt.toUpperCase()) == -1){
        $(this).hide();
   }
}); 
```

# c - 将结构指针添加到结构指针的末尾

> ID：15991670
> 
> 赞同：-1
> 
> 时间：2013-04-13T18:59:31.920
> 
> 标签：c, pointers, reference, struct, allocation

我已经在论坛中搜索了一段时间，但似乎无法解决此问题。它编译并完成了我需要它做的几乎所有事情，但有一件事是关闭的。每当我更新 chore_array 时，它是**指向 struct chore 的指针的指针**，新的更新会替换所有以前的分配。

```
typdef struct _chore{
    char *chore_name;
    int number;
    char *due_date;
    }chore;
typedef struct _chorelist{
    chore **chore_array;
    int occupied_number;
    int size_of_array;
    }chorelist;

void addChoreToLast(chorelist *chore_list,chore *chore_input)
{
  if(chore_list->occupied_number < chore_list->size_of_array)
  {
      chore_list->chore_array[chore_list->occupied_number]=chore_input;
      chore_list->occupied_number++;
  }
  else
  {
      chorelist *pChoreList = (struct _chorelist*)malloc(sizeof(struct _chorelist)*chore_list->occupied_number);
      memcpy(pChoreList,chore_list,sizeof(struct _chorelist*)+sizeof(struct _chore*)+1);
      pChoreList = chore_list;
      pChoreList->chore_array[pChoreList->occupied_number]=chore_input;
      pChoreList->occupied_number++;
  } 
```

代码输入：

```
Enter chore name      : Dishes
Enter chore number    : 1
Enter Date to complete: 04/21/2013

Enter another chore   : Sweeping
Enter chore number    : 4
Enter Date to complete: 05/02/2013 
```

代码输出：

```
Entered Chores are    : Sweeping,   Chore Number: 1, Date: 04/21/2013
                        Sweeping,   Chore Number: 4, Date: 05/02/2013 
```

期望的输出：

```
Entered Chores are    : Dishes,     Chore Number: 1, Date: 04/21/2013
                        Sweeping,   Chore Number: 4, Date: 05/02/2013 
```

在我的 main 函数中，它本质上是给定的并且不能更改，它调用一个函数来初始化**chorelist并为****chorelist**结构的每个成员分配内存，以便我可以为其每个成员分配值和字符串。我的问题是，每次调用函数后，杂项的名称都会被替换，该函数包含一个已经建立的杂项列表。

我在**addChoreToLast**中的赋值语句是否关闭？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:29:07.183

您可以使用`realloc`：

```
void addChoreToLast(chorelist *chore_list,chore *chore_input) {
    chore **p = NULL;
    if(chore_list->occupied_number == chore_list->size_of_array) {
        p = realloc(chore_list->chore_array, (chore_list->size_of_array + 1) * sizeof(chore *));
        if(!p) {
            perror("Can not allocate memory");
            return;
        }

        chore_list->size_of_array++;
        chore_list->chore_array = p;
    }
    chore_list->chore_array[chore_list->occupied_number]=chore_input;
    chore_list->occupied_number++;
} 
```

# bash - BASH/Readline 逐字空字符

> ID：15991674
> 
> 赞同：0
> 
> 时间：2013-04-13T18:59:44.023
> 
> 标签：bash, readline, null-character

我试图准确地了解 TTY、内核、线路规则和 shell 中的谁实际上处理了我输入的任何给定部分。特别是，我一直在研究这篇文章：

[TTY 揭开神秘面纱](http://linusakesson.net/programming/tty/index.php)

我的问题：如果我想让实际的删除字符出现在 BASH 中，我可以使用 ^V 逐字逐句。例如，我可以使用 Ctrl+V 然后 Ctrl+H 有一个退格字符。漂亮整齐！

```
echo '3^H'
3 
```

我的问题是这样的：如果我处于以规范模式读取的内容（我相信 cat 会这样做），我可以通过执行 Ctrl+V 然后 Ctrl+2（基本上是 Ctrl+@，这是插入符号）在其中放置一个空字符对于空字符）。

但是，BASH 不允许我在其中一行包含逐字空字符，而且看起来 python 和其他 readline 程序也不会。

有人知道这是为什么，还是通用的解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:13:30.237

C 库使用文字 null 作为字符串终止符，因此使用它的任何内容都无法表示包含文字 null 的字符串。

需要支持文字空值的程序定义了自己的字符串数据类型。

# php - 禁止我的通讯录使用一些搜索字符串

> ID：15991678
> 
> 赞同：0
> 
> 时间：2013-04-13T19:00:06.980
> 
> 标签：php, search

我正在开发一个网页，可以找到人们的内部电话号码和组织电子邮件地址。一切顺利。输入至少 3 个字符后，页面会列出匹配的记录。我想要的是防止我的脚本进行一些恶意搜索。我列表中的每个人都有一个以“somebody@abc.def.gh”结尾的电子邮件地址，如果有人键入“.gh”，它会立即列出所有记录。我创建了一个包含禁止搜索字符串的数组。但在这里我被困住了。

```
$forbidden_strings = array(
                            "@abc.def.gh",
                            "abc.def.gh",
                            "bc.def.gh",
                            "c.def.gh"
                            /* goes to the end... */
                          ); 
```

我试图写一些，但数组越来越大。因为有很多可能性。我可能会想念其中一些。这不是我猜的正确方法。一定有更好、更酷、更聪明的方式。

我需要一些专业的帮助。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:13:06.993

我有个主意！如果我将电子邮件地址分成两部分，我可以提供对它的前端的搜索。

```
|name       | email  | domain    |
+-----------+--------+-----------+
|John Smith | jsmith | abc.def.gh| 
```

# c# - 将python翻译成C#

> ID：15991679
> 
> 赞同：-6
> 
> 时间：2013-04-13T19:00:10.470
> 
> 标签：c#, python

这在 C# 中看起来如何？

```
checksum = hashlib.sha256(hashlib.sha256(address).digest()).digest()[:4] 
```

尤其是最后一部分 [:4] 是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:03:03.523

那是一片。它从 0 到 4（含）获取列表中的每个位置。

```
 >>> [1,2,3,4,5,6,7,8][:4]
 [1, 2, 3, 4] 
```

# zend-framework2 - 如何在哪里获得“不相等”？

> ID：15991686
> 
> 赞同：6
> 
> 时间：2013-04-13T19:00:46.017
> 
> 标签：zend-framework2

我有这样的事情：

```
 $sql = new Sql($this->tableGateway->getAdapter());
    $select = $sql->select();

    $select
        -> from('mytable')
        -> join('exp', 'field1_id=field1.id', '*', 'LEFT');

    $where = new  Where();
    $where -> equalTo('field2_id', $field2_id);

    $select->where($where);

    $statement = $sql->prepareStatementForSqlObject($select); 
```

但是如果我想使用“not equalTo”怎么办？怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T19:04:34.843

你需要使用 notEqualTo

```
$where->notEqualTo('field2_id', $field2_id); 
```

[http://framework.zend.com/apidoc/2.1/classes/Zend.Db.Sql.Predicate.Predicate.html#notEqualTo](http://framework.zend.com/apidoc/2.1/classes/Zend.Db.Sql.Predicate.Predicate.html#notEqualTo)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-15T10:40:19.180

这就是我使用它的方式，我们大多数人可能正在搜索这样的查询字符串，在单个查询中包含这样的子句。

```
return $details = $this->select(function(Select $select) use ($domain, $domainWithoutWWW){
            $select->columns(['dealername'=> 'dealer.name']);
            $select->join('template',"dealer.template_id = template.id", ['template_name' => 'name','template_html' => 'html','template_css' => 'css'], 'left');
            $select->where($select->where->notEqualTo('dealer.used_car_dealer_id',1826));
            $select->where(array('dealer.parent' => 0));
            $select->where(new In('domain', ['abc.com', 'xyz.com', 'lmn.com']));
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-26T10:55:42.290

最简单的方法是内联编写条件：

```
$select->where('field1 != 0'); 
```

# c++ - 课堂中的访问冲突读取位置

> ID：15991687
> 
> 赞同：0
> 
> 时间：2013-04-13T19:00:46.203
> 
> 标签：c++, memory, runtime-error

我对 C++ 很陌生，我一直在玩指针和类。我遇到了一个问题，到目前为止我还没有找到解决方案：

> RAII.exe 中 0x77F87508 (msvcr110d.dll) 处的未处理异常：0xC0000005：访问冲突读取位置 0xCCCCCCC0。

这似乎与我访问一个我无权访问的指针有关。

主要.cpp：

```
#include <memory>
#include <iostream>
#include "Example.hpp"

void example()
{
    Example e;
}

int main()
{
    example();
    std::cout << "Press any key to exit";
    std::cin.get();
    return 0;
} 
```

示例.cpp：

```
#include "Example.hpp"

Example::Example()
{
    m_a = new int(1);
    m_b = new int(2);
    m_b = new int(3);
}

Example::~Example()
{
    delete m_a;
    delete m_b;
    delete m_c;
} 
```

示例.hpp：

```
#ifndef _EXAMPLE_HPP_
#define _EXAMPLE_HPP_

#include <memory>
#include <iostream>

class Example
{
private:
    int *m_a;
    int *m_b;
    int *m_c;
public:
    Example();
    ~Example();
};

#endif _EXAMPLE_HPP_ 
```

所以，我基本上做的是在构造函数中分配内存并在析构函数中释放它。

欢迎任何帮助！先谢谢了

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-13T19:03:06.583

您的代码中有一个错误：

```
Example::Example()
{
    m_a = new int(1);
    m_b = new int(2);
    m_b = new int(3); // <--- you probably meant it to be m_c
} 
```

因此，当您调用`delete m_c;`析构函数时，您最终会释放不属于您的应用程序的内存，因此会遇到崩溃。

# python - 二进制数的Python遗传算法

> ID：15991689
> 
> 赞同：2
> 
> 时间：2013-04-13T19:00:47.860
> 
> 标签：python, genetic-algorithm

我被要求制作一个遗传算法，目标是确定一个 1 和 0 最多的 8 位字符串。eval 函数应该返回更改的数量加 1。例如，00000000 返回 1，00011100 返回 3，01100101 返回 6。这就是我所拥有的：

```
def random_population():
    from random import choice

    pop = ''.join(choice(('0','1')) for _ in range(8))
    return pop   

def mutate(dna):   
    """   For each gene in the DNA, there is a 1/mutation_chance chance 
    that it will be   switched out with a random character. This ensures 
    diversity in the   population, and ensures that is difficult to get stuck in 
    local minima.   """   
    dna_out = ""   
    mutation_chance = 100   
    for c in xrange(DNA_SIZE):
        if int(random.random()*mutation_chance) == 1:
            dna_out += random_char()
        else:
            dna_out += dna[c]   return dna_out

def crossover(dna1, dna2):   
    """   Slices both dna1 and dna2 into two parts at a random index within their   
    length and merges them. Both keep their initial sublist up to the crossover   
    index, but their ends are swapped.   """   
    pos = int(random.random()*DNA_SIZE)
    return (dna1[:pos]+dna2[pos:], dna2[:pos]+dna1[pos:])

def eval(dna):
    changes = 0
    for index, bit in enumerate(dna):
        if(index == 0):
            prev = bit
        else:
            if(bit != prev):
                changes += 1
        prev = bit
    return changes+1

#============== End Functions =======================#

#============== Main ================# changes = 0

prev = 0
dna = random_population()
print "dna: "
print dna
print eval(dna) 
```

我实际上无法弄清楚遗传算法部分（交叉/突变）。我应该随机配对数字，然后随机选择一对，让一对保持不变，然后在随机点交叉。然后它将通过随机突变整个种群中的一位而结束。当前的交叉和变异代码取自我发现并试图理解的遗传算法示例。欢迎任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T20:07:44.140

我建议的部分内容：

该代码不起作用，但它可能会传输信息。

```
# a population consists of many individuals
def random_population(population_size = 10):
    from random import choice

    pop = [''.join(choice(('0','1')) for _ in range(8)) for i in range(population_size)]
    return pop   

# you need a fitness function
def fitness(individual):
    return # a value from 0 up

def algorithm():
    # a simple algorithm somehow alike
    # create population
    population = random_population()
    # this loop must stop after some rounds because the best result may never be reached
    while goal_not_reached(population) and not time_is_up():
        # create the roulette wheel
        roulette_wheel = map(fitness, population)
        # highest value of roulette wheel
        max_value = sum(roulette_wheel)
        # the new generation
        new_population = []
        for i in range(len(population) - len(new_population)):
             # create children from the population
                 # choose 2 random values from 0 to max_value and find the individuals
                 # for it in the roulette wheel, combine them to new individuals 
             new_population.append(new_individual)
        # mutate the population
        population = map(mutate, new_population)             # a new generation is created 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-13T23:13:21.533

我发现我喜欢做的一件事是：

1.  选择最后一批的最佳候选人，比如说 5。
2.  与 2、3、4、5 配对 1 个。
3.  与 3, 4, 5 配对 2
4.  有 3 与 4 和 5 交配
5.  有 4 与 5 交配。通常，如果您将原始的 5 放入下一代并且每次交配产生 2 个后代，那么您的种群在达到这一点之前就已经满了。一个交配和它的相反双胞胎。
6.  至于实际的交配，我喜欢在长度的 40% 到 60% 之间的一点上随机切割染色体，然后在下一次交配时，我选择该范围内的另一个随机点。
7.  与它们交配后，我会检查染色体中的每一位，并给它大约 5% 的翻转或变异机会
8.  有时我也会让一些最差的两个配对，以降低我获得局部最大值或最小值的机会

我希望这对你有点帮助。

-杰夫

编辑：哦，我的这个是在四月份被问到的。对不起挖坟。

# python - python子进程定位可执行路径

> ID：15991690
> 
> 赞同：1
> 
> 时间：2013-04-13T19:00:50.987
> 
> 标签：python, windows

我如何告诉子进程一个目录，它应该在哪里寻找可执行文件来运行？我读[了 CreateProcess 如何定位可执行文件？](https://stackoverflow.com/questions/5776789/how-does-createprocess-locate-the-executable) 但是，我不想修改当前进程的 env 变量（至少我想非常小心地做这件事——调用后立即恢复）。原因是我有两个同名的应用程序版本（x86、x64 版本在 win64 操作系统上运行），所以我想有固定的命令行字符串来执行工具并改变搜索路径以选择正确的版本。解决我的问题最安全的方法是什么？这里有一个示例代码来刷你的理解：

```
command_line = 'myapp -param=10 -param2=20'
exec_app(command_line, PLATFORM_WIN64)
exec_app(command_line, PLATFORM_WIN32) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:18:12.013

> 解决我的问题最安全的方法是什么？

传递绝对路径。您负责可执行文件所在的位置。将该逻辑构建到您的 Python 代码中，形成完整的绝对路径，然后使用它。

# android - 如何使用 PDF 库在 android 应用程序中呈现 pdf

> ID：15991691
> 
> 赞同：4
> 
> 时间：2013-04-13T19:00:57.730
> 
> 标签：android, pdf-rendering

我在 PDF 渲染方面进行了很多搜索，但没有得到正确的答案。谁能告诉我哪个库（根据 GPL 许可）渲染 PDF 以及如何渲染该 PDF。如果有人有示例代码，那么它将对我更有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:05:47.923

文件格式

[http://www.mupdf.com/](http://www.mupdf.com/)

MuPDF 是免费软件：您可以根据自由软件基金会发布的 Affero GNU 通用公共许可证（许可证的第 3 版或（由您选择）任何更高版本）的条款重新分发和/或修改它。

这是我在 SO 上找到的链接。一些有用的pdf库列表

[https://stackoverflow.com/questions/4665957/pdf-parsing-library-for-android/4766335#4766335](https://stackoverflow.com/questions/4665957/pdf-parsing-library-for-android/4766335#4766335)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-24T06:37:12.727

你至少有两个选择

Android-Pdf-Viewer-Library [https://github.com/jblough/Android-Pdf-Viewer-Library](https://github.com/jblough/Android-Pdf-Viewer-Library)

Mupdf [http://www.mupdf.com/](http://www.mupdf.com/)

MuPDF 是免费软件：您可以根据自由软件基金会发布的 Affero GNU 通用公共许可证（许可证的第 3 版或（由您选择）任何更高版本）的条款重新分发和/或修改它。

**另请参阅** [在应用程序中集成 MuPDF 阅读器](https://stackoverflow.com/questions/8500530/integrate-mupdf-reader-in-an-app/8587527#8587527)

# php - 我如何异步显示 SQL 查询的结果（使用 ajax）？

> ID：15991698
> 
> 赞同：0
> 
> 时间：2013-04-13T19:02:02.720
> 
> 标签：php, mysql, jquery

我通过这个网站非常努力地寻找并发现了类似的问题，但不明白答案。也许我需要更加熟悉 AJAX，但这是我的问题：

我有一个 PHP 页面（mymdb.php），用户在其中提交信息（名字和姓氏）。我有一个获取 mysql_query (_results.php) 结果的页面。最后，我有一个 JS 页面（bacon.js），它旨在异步显示查询结果（通过淡出一个 div，然后向下滑动其上方的结果）。

所以我想我需要以某种方式访问​​ SQL 查询的 $results，然后使用 jquery.html(results) 显示它们。如何从 JS 页面访问 php 变量 $results？

代码不多。这是用户提交信息的 mymdb.php 页面中的相关代码：

```
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />

    <script src='//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
    <script src="bacon.js" type="text/javascript"></script>
</head>

<body>
    <div class="main">
        <form method="post" action="mymdb.php" id="search_form">
            <fieldset id="search_box">
                Actor's first last name:
                <input name="first_name" type="text" size="12" id="fname" /> 
                <input name="last_name" type="text" size="12" id="lname" /> 
                <button type="submit" name="submitButton" id="submitButton">go</button>
            </fieldset>
        </form>

        <div id="everythingElse">
            <h1>The One Degree of Kevin Bacon</h1>
            <p>
                Type in an actor's name to see if he/she was ever in a movie with Kevin Bacon!
            </p>

            <p id="result_paragraph">

            </p>

            <div id="kevinBaconImg"><img src="http://www.images22.com/pics/04/kevin-bacon-blue-eyes.jpg" alt="Kevin Bacon"/></div>
        </div>
    </div>
</body> 
```

这是进行 SQL 查询的 _results.php 页面：

```
<?php
    mysql_connect("localhost", "username", "password");
    mysql_select_db("imdb_small");

    //get all movies the actor is in
    $results1 = mysql_query("SELECT name, year 
        FROM movies m 
            JOIN roles r ON m.id = r.movie_id 
        JOIN actors a ON a.id = r.actor_id 
        WHERE a.first_name = $('#fname').val() AND a.last_name = $('#lname').val();"
    );
?> 
```

这是JS代码：

```
$(document).ready(function() {

    $('#submitButton').click(function(e) {
        e.preventDefault();

        $.post('mymdb.php', $('#search_form').serialize(), function() {

            $('#result_paragraph').html('<?= $results1 ?>').slideDown(); //this should dislay the results from the query
            $('#kevinBaconImg').fadeOut(); //this image fades out once the user submits the first and last names of the actor

        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:04:35.997

使用你在回调函数中得到的数据

我对php不太了解，但似乎你应该`echo`从你的php中得到结果

```
$.post('mymdb.php', $('#search_form').serialize(), function(result) {

            $('#result_paragraph').html(result).slideDown(); //this should dislay the results from the query
            $('#kevinBaconImg').fadeOut(); //this image fades out once the user submits the first and last names of the actor

   }); 
```

# javascript - 引导库模板 flickr 图像

> ID：15991699
> 
> 赞同：0
> 
> 时间：2013-04-13T19:02:04.050
> 
> 标签：javascript, ajax, api, flickr

我将此模板用于个人项目。
[https://github.com/blueimp/Bootstrap-Image-Gallery](https://github.com/blueimp/Bootstrap-Image-Gallery)
，这里有从 flickr 获取照片的代码。此代码使用 flickr.interestingness.getList 方法，该方法将标签作为参数，如此处所示。[http://www.flickr.com/services/api/flickr.interestingness.getList.html](http://www.flickr.com/services/api/flickr.interestingness.getList.html)
我想将标签作为参数传递，但我无法弄清楚在 ajax 或 w/e 中这样做的语法此代码中使用的格式是。

```
 // Load images via flickr for demonstration purposes:
    $.ajax({
        url: 'http://api.flickr.com/services/rest/',
        data: {
            format: 'json',
            method: 'flickr.interestingness.getList',

            api_key: 'API_KEY_abc123'
        },
        dataType: 'jsonp',
        jsonp: 'jsoncallback'
    }).done(function (data) {
        var gallery = $('#gallery'),
            url;
        $.each(data.photos.photo, function (index, photo) {
            url = 'http://farm' + photo.farm + '.static.flickr.com/' +
                photo.server + '/' + photo.id + '_' + photo.secret;
            $('<a data-gallery="gallery"/>')
                .append($('<img>').prop('src', url + '_s.jpg'))
                .prop('href', url + '_b.jpg')
                .prop('title', photo.title)
                .appendTo(gallery);
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-22T07:55:08.280

这似乎是一个更好的项目：

```
http://petejank.github.io/js-flickr-gallery/ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-02-04T06:00:09.233

```
/*
 * Bootstrap Image Gallery JS Demo 3.0.0 
 * https://github.com/blueimp/Bootstrap-Image-Gallery
 *
 * Copyright 2013, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 * Plugin was modified by ravindu
 */
(function( $ ) {
            $.fn.flickr = function(options) {
                var url = 'http://api.flickr.com/services/rest/?jsoncallback=?';

                var settings = $.extend( {
                    'api_key': 'YOUR API',          
                }, options);

                function view_image(event) {
                    var target = $(event.target);

                    if(target.is('img')) {
                        var url = target.attr('data-url');
                        var cache = new Image();
                        cache.src = url;
                        var gallery = target.parents('.flickr-gallery:first').children('div.viewport');
                        var info = gallery.children('div.image-info');
                        var image = gallery.children('img');
                        image.fadeOut('slow', function () {
                            image.attr('src', url);
                            image.fadeIn('slow');
                            info.html(target.attr('data-title') + '<br />' + target.attr('data-tags'));
                        });
                    }
                }

                return this.each(function() {    

                    var gallery = $(this);
                    gallery.addClass('flickr-gallery');
                    gallery.append('<h2></h2><h3></h3><div class="viewport"></div><div class="browser"><ul></ul></div><div class="clear"></div>');

                    $.getJSON(url, {
                        method: 'flickr.photosets.getInfo',
                        api_key: settings.api_key,                      
                        photoset_id: settings.photoset_id,
                        format: 'json'
                    }).success(function(state) {
                        gallery.children('h3').html(state.photoset.description._content);
                        gallery.find('.loader').addClass('activate');

                        $.getJSON(url, {
                            method: 'flickr.photosets.getPhotos',
                            api_key: settings.api_key,
                            media: 'photos',
                            photoset_id: settings.photoset_id,
                            format: 'json',
                            extras: 'url_sq,url_m,url_b,date_taken,tags'
                        }).success(function(state) {

                            $('.loader').removeClass('activate');

                            var list = gallery.find('ul:first');
                            list.html('');
                            list.on('click', view_image);

                            $.each(state.photoset.photo, function(index, photo){

                                  baseUrl = 'http://farm' + photo.farm + '.static.flickr.com/' +
                photo.server + '/' + photo.id + '_' + photo.secret;

                                list.append('<a href="' + this.url_m + '" title="' + this.title + '" data-gallery="" > <img src="' + this.url_sq + '" title="' + this.title + '" ' +
                                    'data-title="' + this.title + '" ' +
                                    'data-url="' + this.url_m + '" ' +
                                    ( this.date_taken ? 'data-date="' + this.date_taken + '" ' : '' ) +
                                    'data-tags="' + this.tags + '" ' +
                                    '/></a>');
                            });

                        }).fail(function(state) { 
                            alert("Unable to retrieve photo set"); 
                        });
                    }).fail(function(state) { 
                        alert("Unable to retrieve photo set information"); 
                    });
                });

            };
        })( jQuery );
        $(document).on('ready', function(){

            $('#photos-1').flickr({ photoset_id:'72157640241840746'});
            $('#photos-2').flickr({ photoset_id:'72157640251299195'});
            $('#photos-3').flickr({ photoset_id:'72157640241840746'});
            $('#photos-4').flickr({ photoset_id:'72157640251299195'});
            $('#photos-5').flickr({ photoset_id:'72157640241840746'});

        }); 
```

# algorithm - 计算图的顶点连通性

> ID：15991701
> 
> 赞同：2
> 
> 时间：2013-04-13T19:02:11.563
> 
> 标签：algorithm, graph

是否有一种算法可以在给定图时计算该图的顶点连通性（为了将图分成两个连通图而要删除的最小顶点数）。（请注意，图表可能已经断开连接）。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:08:23.843

请参阅： [确定图是否为 K 顶点连接](https://stackoverflow.com/questions/10115114/determining-if-a-graph-is-k-vertex-connected)

[图的 k 顶点连通性](https://stackoverflow.com/questions/5944005/k-vertex-connectivity-of-a-graph?rq=1)

当你将它与二分搜索结合起来时，你就完成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T20:32:31.053

这[本书的章节](http://www.cse.msu.edu/~esfahani/book_chapter/Graph_connectivity_chapter.pdf)应该有你开始需要的一切；它基本上是对确定图的边连通性和顶点连通性的算法的调查，其中描述了算法的伪代码。第 12 页概述了可用算法以及复杂性分析和参考。一般情况下的大多数解决方案都是基于流的，除了一种随机算法。不同的通用解决方案针对图的不同属性进行了优化，因此您可以预先选择最渐近有效的解决方案。此外，对于某些类别的图，存在比一般解决方案提供的复杂度更高的专门算法。

# python - open() 的缓冲参数和迭代文件时使用的硬编码预读缓冲区大小有什么区别？

> ID：15991702
> 
> 赞同：2
> 
> 时间：2013-04-13T19:02:12.097
> 
> 标签：python, file-io, io-buffering

受[这个问题](https://stackoverflow.com/questions/15979793/is-there-any-way-to-find-the-buffer-size-of-a-file-object)的启发，我想知道 Python`open()`函数的可选缓冲参数到底是做什么的。通过查看[source](http://hg.python.org/cpython/file/84cd07899baf/Objects/fileobject.c)，我看到它`buffering`被传入`setvbuf`以设置流的缓冲区大小（并且它在没有 的系统上什么也不做`setvbuf`，文档确认）。

但是，当您遍历文件时，会调用一个常量`READAHEAD_BUFSIZE`来定义一次读取多少数据（此常量[在此处](http://hg.python.org/cpython/file/84cd07899baf/Objects/fileobject.c#l2314)定义）。

我的问题正是这个`buffering`论点与`READAHEAD_BUFSIZE`. 当我遍历一个文件时，哪一个定义了一次从磁盘读取多少数据？C 源代码中是否有一个地方可以说明这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:04:55.707

`READAHEAD_BUFSIZE`仅*在*将文件用作迭代器时使用：

```
for line in fileobj:
    print line 
```

它是一个独立于普通缓冲区参数的缓冲区，由`fread`C API 调用处理。迭代时都使用两者。

来自[`file.next()`](http://docs.python.org/2/library/stdtypes.html#file.next)：

> 为了使`for`循环成为循环文件行的最有效方式（一种非常常见的操作），该`next()`方法使用隐藏的预读缓冲区。作为使用预读缓冲区的结果，`next()`与其他文件方法（如`readline()`）组合不能正常工作。但是，使用`seek()`将文件重新定位到绝对位置将刷新预读缓冲区。

操作系统缓冲区大小没有改变，`setvbuf`当文件打开并且文件迭代代码没有触及时完成。相反，调用`Py_UniversalNewlineFread`(which uses `fread`) 用于填充预读缓冲区，在 Python 内部创建*第二个缓冲区。*否则，Python 将常规缓冲留给 C API 调用（`fread()`调用被缓冲；用户空间缓冲区被咨询`fread()`以满足请求，Python 不必对此做任何事情）。

`readahead_get_line_skip()`然后从此缓冲区提供行（换行终止）。如果缓冲区不再包含换行符，它将通过以 1.25 倍于前一个值的缓冲区大小递归自身来重新填充缓冲区。这意味着如果整个文件中没有换行符，文件迭代可以将文件的整个其余部分读入内存缓冲区！

要查看缓冲区读取了多少，请`fileobj.tell()`在循环时打印文件位置（使用 ）：

```
>>> with open('test.txt') as f:
...     for line in f:
...         print f.tell()
... 
8192   # 1 times the buffer size
8192
8192
~ lines elided
18432  # + 1.25 times the buffer size
18432
18432
~ lines elided
26624  # + 1 times the buffer size; the last newline must've aligned on the buffer boundary
26624
26624
~ lines elided
36864  # + 1.25 times the buffer size
36864
36864 
```

等等

实际从磁盘读取的字节（假设`fileobj`是磁盘上的实际物理文件）不仅取决于`fread()`缓冲区和内部预读缓冲区之间的相互作用；而且如果操作系统本身正在使用缓冲。很可能即使文件缓冲区已用尽，操作系统也会为系统调用提供服务，以从其自己的缓存中读取文件，而不是转到物理磁盘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T20:23:01.353

在深入挖掘源代码并尝试了解更多如何`setvbuf`和`fread`工作之后，我想我理解了彼此之间的关系和关系：当迭代文件时，每一行都填充了一个缓冲区`buffering`，但是填充这个缓冲区使用调用，每个都填充一个字节缓冲区。`READAHEAD_BUFSIZE``READAHEAD_BUFSIZE``fread``buffering`

Python 的`read`实现为[file_read](http://hg.python.org/cpython/file/84cd07899baf/Objects/fileobject.c#l1052)，它调用[Py_UniversalNewlineFread](http://hg.python.org/cpython/file/84cd07899baf/Objects/fileobject.c#l2809)，将要读取的字节数传递给`n`. `Py_UniversalNewlineFread`然后最终调用`fread`读取 n 个字节。

当你遍历一个文件时，函数[readahead_get_line_skip](http://hg.python.org/cpython/file/84cd07899baf/Objects/fileobject.c#l2269)就是检索一行。这个函数也调用`Py_UniversalNewlineFread`，传递`n = READAHEAD_BUFSIZE`。所以这最终变成了`fread`对`READAHEAD_BUFSIZE`字节的调用。

`fread`所以现在的问题是，实际上从磁盘读取了多少字节。如果我在 C 中运行以下代码，则 1024 个字节被复制`buf`到`buf2`. `setvbuf`（这可能很明显，但在这对我来说是一个有用的实验之前从未使用过。）

```
FILE *f = fopen("test.txt", "r");
void *buf = malloc(1024);
void *buf2 = mallo(512);
setvbuf(f, buf, _IOFBF, 1024);
fread(buf2, 512, 1, f); 
```

因此，最后，这向我表明，在迭代文件时，*至少* `READAHEAD_BUF_SIZE`会从磁盘读取字节，但可能更多。我认为第一次迭代将读取 x 字节，其中 x是大于`for line in f`.x 的最小倍数。`buffering``READAHEAD_BUF_SIZE`

如果有人能确认这是实际发生的事情，那就太好了！

# c# - [JavaFlags] 属性的含义是什么？

> ID：15991705
> 
> 赞同：3
> 
> 时间：2013-04-13T19:02:25.037
> 
> 标签：c#, .net, j#

我反编译了一个最初来自 J# 的 DLL。我看到原始代码中缺少以下属性：

```
[JavaFlags(0)]
public ToolBarButton toolBarButtonProg;

[JavaFlags(8)]
public static int lastClass; 
```

我看到这些 JavaFlags 是在以下 J# 命名空间中定义的。

```
namespace com.ms.vjsharp.cor
{
  [AttributeUsage(AttributeTargets.All, AllowMultiple = false)]
  public class JavaFlags : Attribute
  {
    public int attr;

    public JavaFlags(int attr)
    {
      this.attr = attr;
    }
  }
} 
```

但是这些属性的目的是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T23:55:36.260

此属性可能由 J# 编译器添加以表示未在 CLR 中直接表示的 Java 构造。例如，CLR 中没有与`protected`Java 中的修饰符完全相同的可见性修饰符，因此编译器在 CLR 中生成一个方法`public`以及一个`[JavaFlags(4)]`属性，因此 J# 编译器知道`protected`在编译其他 Java 代码时处理该方法。

# android - 如何在 Android 应用程序中播放 .mov 格式的视频文件

> ID：15991706
> 
> 赞同：5
> 
> 时间：2013-04-13T19:02:25.520
> 
> 标签：android, video, mov

我正在开发一个 android 应用程序，它播放来自我们服务器的 iphone 和 android 上传的视频，问题是 iphone 录制的视频是 .mov 格式，android 不支持。我搜索了很多，但找不到任何解决方案。帮帮我。提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-13T12:02:20.500

我会建议您将格式从 iphone 更改为兼容的（即使打开会更好），因为服务器上两种不同格式的视频迟早会令人头疼。

如果可以，请使用[ffmpeg](https://www.ffmpeg.org/)重新格式化您的视频，并将其全部以相同的格式保存在服务器上。

如果你做不到或者很难实现，你可以试试谷歌的 ExoPlayer 组件。我已经尝试过像您这样的应用程序，设备（iPhone 和 Android）在其中录制视频并上传到服务器。在服务器端重新格式化所有这些视频几乎是不可能的，因此我们最终决定在客户端为遗留视频应用解决方案。

[https://google.github.io/ExoPlayer/](https://google.github.io/ExoPlayer/)

ExoPlayer 的设置比 VideoView 大，但操作起来很简单。

```
 private var player: ExoPlayer = initPlayer()

    private fun initPlayer(): ExoPlayer {
        val bandwidthMeter = DefaultBandwidthMeter()
        val videoTrackSelectionFactory = AdaptiveTrackSelection.Factory(bandwidthMeter)
        val trackSelector = DefaultTrackSelector(videoTrackSelectionFactory)
        return ExoPlayerFactory.newSimpleInstance(context, trackSelector)
    }

fun setup() {

        videoExo.setPlayer(player)
        videoExo.useController = false

        val dataSourceFactory = DefaultDataSourceFactory(
            context,
            Util.getUserAgent(context, context?.packageName), DefaultBandwidthMeter()
        )

        val videoSource = ExtractorMediaSource.Factory(dataSourceFactory).createMediaSource(videoUri)

        player.addListener(object: Player.EventListener {
            override fun onPlayerStateChanged(playWhenReady: Boolean, playbackState: Int) {
                if (playbackState == Player.STATE_READY) {
                    startCallback()
                }
            }
            override fun onPlaybackParametersChanged(playbackParameters: PlaybackParameters?) {}
            override fun onSeekProcessed() {}
            override fun onTracksChanged(trackGroups: TrackGroupArray?, trackSelections: TrackSelectionArray?) {}
            override fun onPlayerError(error: ExoPlaybackException?) {}
            override fun onLoadingChanged(isLoading: Boolean) {}
            override fun onPositionDiscontinuity(reason: Int) {}
            override fun onRepeatModeChanged(repeatMode: Int) {}
            override fun onShuffleModeEnabledChanged(shuffleModeEnabled: Boolean) {}
            override fun onTimelineChanged(timeline: Timeline?, manifest: Any?, reason: Int) {}
        })

        player.prepare(videoSource)
        player.playWhenReady = true
        player.repeatMode = REPEAT_MODE_ALL

    } 
```

希望这可以帮助

# objective-c - 使用 loadNibNamed:owner:topLevelObjects: 是否允许顶级插座中的弱引用？

> ID：15991707
> 
> 赞同：0
> 
> 时间：2013-04-13T19:02:28.180
> 
> 标签：objective-c, cocoa, automatic-ref-counting, nib

我最近意识到

```
loadNibNamed:owner: 
```

在 10.8 中已弃用，因此已开始将其切换到

```
loadNibNamed:owner:topLevelObjects: 
```

我正在使用 ARC，并且由于这个新版本现在允许我的控制器保留对我笔尖中所有顶级对象的强引用，将我的出口连接更改为顶级对象到弱引用是否有意义（对于那些当然支持弱引用）？

这只是为了与其他渠道保持一致，我确实理解（在这种情况下）为同一个对象持有两个强引用并没有错。

**我不是在询问使用 IBOutlets 和 ARC 的一般情况，我是在特别询问何时通过新的 10.8 方法加载 nib 以查看它是否改变了必须使用强插座保持顶级对象的规则.**

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:54:11.257

这在很大程度上取决于您对`topLevelObjects`数组指针所做的事情。一旦掌握了它，您要么需要保留整个数组，要么需要对数组中的每个对象进行强引用，以确保不会丢失任何东西。

如果要保存数组，则可以安全地使用对顶级对象的弱引用。如果你不这样做，你必须持有强大的。

# java - 从外部 jarfile 中卸载的类中读取字节码

> ID：15991708
> 
> 赞同：0
> 
> 时间：2013-04-13T19:02:46.680
> 
> 标签：java, jar, bytecode, bytecode-manipulation

在我的 Java 应用程序中，我希望从实际未加载的类文件中读取字节码内容，在也未加载的 jar 文件中。例如，我需要能够获取任何给定的 jarfile，并在其中找到所有类，理想情况下。所以采取以下情况：

我的应用程序（这是一种库）被要求在任何路径上“检查”某个 jar，并使用我的库提供应用程序提供的各种模式以查找相似性（例如常量池相似性）。因此，我的库需要遍历类文件中的所有 jar。显然，我可以对其进行硬编码或从文件加载，但我更愿意拥有它，以便我可以通过 jar 中所有文件的字节码来匹配它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:12:54.307

您应该使用[JarFile](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/jar/JarFile.html) API 并遍历其中的文件。应该不难做到。这篇[文章](http://cs.dvc.edu/HowTo_ReadJars.html)可能是一个好的开始。

至于字节码，您可以将每个（未压缩的）类文件视为一个字节数组并计算一个哈希值，也许是每个文件的 MD5 哈希值，并将其与之前的哈希值进行比较。

# python - python argparse - 我可以只使用互斥的可选参数还是有更好的方法

> ID：15991711
> 
> 赞同：1
> 
> 时间：2013-04-13T19:02:56.410
> 
> 标签：python, command-line-arguments, argument-passing, argparse

我正在编写一个脚本，该脚本从 Web 下载文件，执行一些处理并将数据存储到 mysql 数据库中。

我`argparse`用于接受论点。本质上，该脚本将做 4 件事中的 1 件事：

1) 从网上下载用户提供的文件名并执行处理/db-insert。

2）根据昨天的日期下载当前最多的文件名。我有一个 cron 工作，每天凌晨 2 点后运行这部分。

3) 与#2 相同，但需要一个附加文件。

4）处理当前文件夹中的用户定义文件，并将其保存到同一文件夹中的输出文件中。

该脚本只能做上述 4 件事中的 1 件事。因此，我想我可以使用互斥的可选参数，如下所示：

```
parser = argparse.ArgumentParser()
group = parser.add_mutually_exclusive_group(required=True)
group.add_argument('-f','--filename',action='store',nargs=1,help='Filename to download')
group.add_argument('-b','--bulkfile',action='store',nargs=2,help='Bulk filename to process and save')
group.add_argument('-l', '--load', action='store_true', help='Download current load data')
group.add_argument('-s', '--supply', action='store_true', help='Download current supply data')
args = parser.parse_args()

if args.filename:
    do something
elif args.bulkfile:
    do something
elif args.load:
    do something
elif args.supply:
    do something
else: 
    print "Improper usage. Can only use [-f | -b | -l| -s]"
    return 
```

我知道这并不理想。我宁愿让`argparse`处理它的使用部分。我正在寻找实现目标的最佳方式。我很感激帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T20:18:22.977

`argparse`将为您处理使用情况。在没有参数的情况下运行您的脚本，我收到以下错误消息：

```
usage: test.py [-h] (-f FILENAME | -b BULKFILE BULKFILE | -l | -s)
test.py: error: one of the arguments -f/--filename -b/--bulkfile -l/--load -s/--supply is required 
```

两者都跑，`-l`我`-s`得到

```
usage: test.py [-h] (-f FILENAME | -b BULKFILE BULKFILE | -l | -s)
test.py: error: argument -s/--supply: not allowed with argument -l/--load 
```

解析器会自动为您处理互斥参数的错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T20:18:26.583

本着`svn`or`git`你可以使用[subcommands](http://docs.python.org/2.7/library/argparse.html#sub-commands)的精神。

# oracle - 检索存储过程中定义的参数列表

> ID：15991712
> 
> 赞同：0
> 
> 时间：2013-04-13T19:02:59.113
> 
> 标签：oracle

如何检索在提供的存储过程中定义的参数列表。数据库是Oracle 11g。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T19:04:03.290

这是您应该使用的 sql 语句：

```
select argument_name, in_out, data_type

from   all_arguments

where  owner = 'schema_name' and

       package_name = 'package_name or null' and

       object_name = 'sp_name'

order by position 
```

# html - 将图像与文本垂直对齐

> ID：15991716
> 
> 赞同：0
> 
> 时间：2013-04-13T19:03:11.523
> 
> 标签：html, vertical-alignment

我有一个图像，我想与一个框内的文本块对齐。

问题是我无法让文本与图像顶部对齐。盒子顶部和图像之间总是有一个空间。

这是我在框中的图像和文本的代码，它的外观如下： http: [//paulcwebster.com](http://paulcwebster.com)

```
<div style="width:1000px;height:155px;border:1px solid black;">
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody>
            <tr>
                 <td width="134"><a href="index.html"><img src="gfx/adverse-reactions.jpg" alt="" border="0" height="150" width="176"></a></td>
                 <td width="1827"><font color="blue" size="2"><a href="gfx/VanMagAdverseReactionsApril2013.pdf" target="_new">Adverse Reaction</a></font>
Vancouver Magazine April 2013<br><br><em>British Colombia's firing of scientists closely involved in staging major studies of physician prescribing practices, and the safety of a wide array of drugs is a situation that Dr. David Henry, CEO of Toronto&rsquo;s Institute for Clinical Evaluative Sciences, Canada&rsquo;s preeminent centre for science-based health policy development, describes as extremely distressing. &ldquo;The most comprehensive data in Canada has been denied to us,&rdquo; he says, noting that the B.C. government has failed to respond to repeated inquiries from alarmed scientists across Canada.</em></td>
            </tr>
        </tbody>
    </table>
    <br>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:13:52.627

您可以在 td 中使用 valign="top" ，例如：

```
<td width="134" valign="top"> 
```

或者您可以使用 CSS 属性：{ vertical-align: top; }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:06:15.203

您可以尝试将 ( `vertical-align`) 两个元素（文本和图像）垂直对齐到`text-top`or `top`。

您也可以通过简单地将图像单独对齐到`text-top`. 但是，如果没有 jsFiddle，我无法对此进行测试。

例子：

```
img {
    vertical-align: text-top;
} 
```

# java - Eclipse 调试器不适用于这两个小线程

> ID：15991717
> 
> 赞同：0
> 
> 时间：2013-04-13T19:03:13.537
> 
> 标签：java, multithreading

如何调试这个？我知道这不是线程安全的，但只是想跟踪逻辑。

```
class Test {
public static int count = 0;
class CountThread extends Thread {

    public void run()
    {
        System.out.println(Thread.currentThread().getName() + " start");
        count++;
        System.out.println(Thread.currentThread().getName() + " end");
    }
}  

public void add(){
    CountThread a = new CountThread();
    CountThread b = new CountThread();

            a.start();
    b.start();

            try {
        a.join();
        b.join();
    } catch (InterruptedException ex) {
        ex.printStackTrace();
    }

}
public static void main(String[] args) {

    Test test = new Test();
    System.out.println("START = " + Test.count);

            test.add();

            System.out.println("END: Account balance = " + Test.count);
} 
```

当它执行到a.start()时，在Eclipse中我点击“step into”，它不会去run()方法，而是去下面，在我的代码中没有办法去run() . 如何调试这个？

```
 public synchronized void start() {
    /**
 * This method is not invoked for the main method thread or "system"
 * group threads created/set up by the VM. Any new functionality added 
 * to this method in the future may have to also be added to the VM.
 *
 * A zero status value corresponds to state "NEW".
     */
    if (threadStatus != 0 || this != me)
        throw new IllegalThreadStateException();
    group.add(this);
    start0();
    if (stopBeforeStart) {
    stop0(throwableFromStop);
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T19:05:25.700

> 执行到a.start()时，在Eclipse中点击“step into”，并没有进入run()方法，而是进入[Thread.start()方法]，没有办法在我的代码中运行（）。

这是意料之中的，Eclipse 没有问题。当线程被派生并开始执行时，您无法调试正在执行的本机方法。

> 如何调试这个？

`run()`我会在你方法的第一行设置一个断点。`Thread.run()`或者，如果必须，您可以在调用方法的方法中放置一个断点`run()`：

```
// the Thread.run() method
public void run() {
    if (target != null) {
        // Your `CountThread` objects are the `target`.
        target.run();
    }
} 
```

**注意：**您需要了解此类程序的任何调试都会极大地改变线程的执行顺序。这些`System.out.println()`调用也这样做，因为它们产生 IO 并且底层`PrintStream`是`synchronized`. 这意味着一旦你删除了 print 语句和断点，你的程序就会表现得非常不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T19:08:20.117

`start()`不是`run()`。

您需要在`run()`. 然后，运行应用程序，eclipse 将停留在 run() 中。

在调试视图中，您将看到两个线程。

不要忘记设置断点`a.join();`。

# apache-poi - 如何显示最多一位小数

> ID：15991721
> 
> 赞同：1
> 
> 时间：2013-04-13T19:03:36.883
> 
> 标签：apache-poi, jxl, jexcelapi

我正在使用 jxl-2.6.3.jar。

我想显示最多小数点后 1 位的 bigdecimals。

如果我像下面这样写，则 1.2 显示为 "1.2" ，但 1.0 显示为 "1"。. 如果是 1.0，我也需要 0，即“1.0”而不是简单的“1”。.

```
BigDecimal number = new BigDecimal(1.0);
NumberFormat dp1 = new NumberFormat("#.#");
WritableCellFormat format = new WritableCellFormat(dp1);
workSheet.addCell(new Number(1, 1, number.doubleValue(),format)); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:54:41.937

您应该使用数字格式`"#.0"`。“#”字符表示只有在需要表示数字时才应该存在数字，“0”字符表示必须存在数字，即使不需要表示数字。如需进一步参考，请参阅[Excel 格式符号](http://office.microsoft.com/en-us/excel-help/number-format-codes-HP005198679.aspx)。

`"#.0"`无论您是在 JXL 中使用还是在 Apache POI`NumberFormat`中创建数据格式字符串，该格式都可以使用。`DataFormat`

# python - 如何在python中找到右边的位

> ID：15991726
> 
> 赞同：2
> 
> 时间：2013-04-13T19:04:06.917
> 
> 标签：python, bit-manipulation

我试图确定一个数字是偶数还是奇数，我认为这可以通过取该数字左侧的位来实现，例如：

```
number    bit      odd
  1       0001      1
  2       0010      0
  3       0011      1
  4       0100      0 
```

因此，如果最后一位为 1，则为奇数，如果为 0，则为偶数。

如何在 python 上解决这个问题？当然使用按位运算，就像标题一样，我只想得到数字的最后一位。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T19:05:26.097

使用按位与`&`：

```
odd = number & 1 
```

* * *

```
In [24]: for number in range(1, 5):
   ....:     print(number & 1)
   ....:     
   ....:     
1
0
1
0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:06:48.553

通常你使用模运算符来完成这样的任务：

```
1 % 2 # gives you 1 (odd)
2 % 2 # gives you 0 (even) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:06:51.277

要检查一个数字是偶数还是奇数，只需使用

```
if a%2:
    #do stuff
 else:
     #do stuff 
```

# javascript - Rails - 如何在 Rails 应用程序中获取 JavaScript 中的文件路径？

> ID：15991732
> 
> 赞同：-1
> 
> 时间：2013-04-13T19:05:16.790
> 
> 标签：javascript, ruby-on-rails-3

我正在使用一个 Rails 应用程序，我试图在我的 javascript 中指定一个 json 文件路径。但是，似乎我无法获得我应该得到的文件。我尝试了：该文件的绝对路径和相对路径。但是，没有什么对我有用。我知道 Rails.root 之前在我的 rake 任务中用于指定文件路径。但是，这次我需要在 Rails 应用程序的 JavaScript 中指定文件路径。我正在尝试找到flare.json 文件。我把它放在我的 app/assets/data/flare.json 中并尝试了这个：

```
<script type="text/javascript">

d3.json("/app/assets/data/flare.json", function(error, root) {
.....

}

</script> 
```

但是，我在 JavaScript 控制台中得到错误：

```
GET `http://localhost:3000/app/assets/data/flare.json 404 (Not Found)` 
```

任何人都可以请帮助我在 Rails 应用程序的 javaScript 中指定文件路径的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T10:12:07.713

所以让我说对了，你想用 d3 加载一个 json 文件吗？如果是这种情况，请考虑以下情况：浏览器内 javascript 环境无权访问服务器端的文件资源。您可以通过服务器专门公开文件来加载它们，然后执行 AJAX 请求以使用 javascript 检索它们。例如：

将文件移动到应用程序中的公共目录，然后将 javascript 更改为

```
d3.json("/flare.json", function(error, root) {
  .....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:15:12.173

把它放在 config/application.rb

# 启用资产管道

config.assets.enabled = true

config.assets.paths << "#{Rails.root}/app/assets/something"

# java - 不逐行写

> ID：15991743
> 
> 赞同：0
> 
> 时间：2013-04-13T19:06:07.550
> 
> 标签：java, file, append

```
private static void displaytoFile(int trial, int count) {
        // TODO Auto-generated method stub
        String answer;
         try{
              // Create file 
                  FileWriter fstream = new FileWriter(outputfile);
                  BufferedWriter out = new BufferedWriter(fstream);
                  answer = "Case #"+trial+": "+count;
                  out.write(answer);
                  out.newLine();
              //Close the output stream
                out.close();
              }catch (Exception e){//Catch exception if any
                  System.err.println("Error: " + e.getMessage());
              }

    } 
```

displaytoFile() 方法在我的项目中循环调用，但我无法逐行写入文件。它只写入最后一行，即上次迭代期间传递的参数。我在控制台和其他代码中测试没关系，它显示了所有内容，但此代码片段似乎有一些问题，因为它似乎覆盖了以前的值。我怎样才能逐行写入文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:09:10.440

使用[`FileWriter(String, boolean)`](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.lang.String,%29boolean%29)构造函数来追加输入而不是重写整个文件：

```
FileWriter fstream = new FileWriter(outputfile, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:09:31.367

```
 FileWriter fstream = new FileWriter(outputfile);
 BufferedWriter out = new BufferedWriter(fstream);

 answer = "Case #"+trial+": "+count;
 out.write(answer);
 out.newLine();

 //Close the output stream
 out.close(); 
```

有问题。这是因为在循环的每次迭代中，您清除文件然后将当前行写入其中。您应该在循环之前打开文件并在循环之后关闭它。或者确保您附加到文件中，而不是先清除然后写入，就像您现在所做的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:09:37.050

您必须表明要附加到文件

[在此处](http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html#FileWriter%28java.lang.String,%20boolean%29)查看方法文档

# git - 由于粗心，我回滚到我的第一个提交。有没有办法获得最新的提交？

> ID：15991744
> 
> 赞同：0
> 
> 时间：2013-04-13T19:06:08.300
> 
> 标签：git

我不确定我做了什么，因为我不太了解 git，只是开始输入命令。我的意图是删除自上次提交以来所做的更改，但看起来我已经删除了存储库中自第一次提交以来的所有更改。当我运行 git log 时，只显示 2/23 的提交。是否有命令可以恢复最新版本？

@Adrian 指出 git reflog：这是我的输出。签出 HEAD@{1} 的命令是什么？

```
26ceb46 HEAD@{0}: reset: moving to 26ceb4673a42710adb16840cc2f96e2073869eb5
e9c0494 HEAD@{1}: commit: After root fiasco, about to change illustration, novel, and edition models
e6ca6e6 HEAD@{2}: commit: Before adding edition as a table
17b2d98 HEAD@{3}: commit: Added search grid view, pagination on search grid view and index view.
d582f81 HEAD@{4}: commit: Before fixing tag display page
117cf37 HEAD@{5}: commit: Commit before adding tagging_id to illustration table
a543a4b HEAD@{6}: commit: Search bar and search results page working
d372d6e HEAD@{7}: commit: Fixed formatting, added search bar
0188759 HEAD@{8}: commit: Style changes, implemented basic grid views, Removed extra models/controlle
003cc92 HEAD@{9}: commit: Swapped to mysql
8cfd94e HEAD@{10}: checkout: moving from master to mysql-transition
8cfd94e HEAD@{11}: commit: Before Novel
2cc012b HEAD@{12}: commit: Archive Scaffold
26ceb46 HEAD@{13}: commit (initial): Archive Scaffold 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:22:47.090

Now that you've identified the commit you want to restore, you can issue the command

```
git checkout e9c0494 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:11:26.243

键入`git reflog`。您将列出所有更改的历史记录。您可以在更改之前安全地签出以提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:22:12.870

This should list all the unreachable commits still present in your reflog.

```
git fsck --unreachable --no-reflogs 2>/dev/null | grep 'unreachable commit' | awk '{print $3;} 
```

Then you could run `git show SHA1` to display the commit message and the diff.

Note that unreachable git commits are kept in reflogs for a period of only 30 days.

**Example:**

```
$ git fsck --unreachable --no-reflogs 2>/dev/null | grep 'unreachable commit' | awk '{print $3;}
bb308ef25fd7c3e0e5643bfec6a64c990724f25c
f0067516d9ce241a7fad1d03f4bd418172d1c7c4
f226f1200efdbe3687760e717d6670715e288439

$ git show bb308ef25fd7c3e0e5643bfec6a64c990724f25c
commit bb308ef25fd7c3e0e5643bfec6a64c990724f25c
Author: Ash <tuxdude@Suse1520>
Date:   Sat Mar 23 13:36:36 2013 -0700

    Removed Something.

diff --git a/file1 b/file1
index b9330fb..e69de29 100644
--- a/file1
+++ b/file1
@@ -1 +0,0 @@
-SOMETHING 
```

If you want to see how a work-tree looks like, you could also directly checkout that commit using `git checkout SHA1`

# lua - 复制lua表时不匹配

> ID：15991747
> 
> 赞同：1
> 
> 时间：2013-04-13T19:06:25.757
> 
> 标签：lua, nested, compare, hex, lua-table

我正在使用 Lua 和 Love2d 编写游戏，但在处理嵌套表时遇到了障碍。

我有一个函数，它遍历一个包含与墙壁、按钮等相对应的数字的表格，并根据键打印彩色块。这些表之一的示例如下所示：

```
map = {
    { 1, 1, 1, 1, 1, 1, 1, 1, 1 }
    { 1, 0, 0, 0, 0, 0, 0, 0, 1 } 
    { 1, 0, 1, 1, 2, 0, 0, 0, 1 } 
    { 1, 0, 0, 0, 0, 0, 0, 0, 1 } 
    { 1, 1, 1, 1, 1, 1, 1, 1, 1 } 
} 
```

这在渲染时工作正常。但是，当我尝试使用从如下所示的文本文件中读取此数据的函数来创建同一个表时：

```
 111111111
    100000001 
    101120001 
    100000001 
    111111111 
```

它创建了一个*看起来*相同的表，但是当我尝试渲染它时它根本不起作用。

所以我尝试使用一些打印出表格内容的代码进行调试，虽然内容相同，但描述嵌套表格的十六进制位是不同的。例子：

读取地图文件的第一个嵌套表：

```
1   table: 0x106c5a720
1   1
2   1
3   1
4   1
5   1
6   1
7   1
8   1
9   1 
```

读取手动创建的表的第一个嵌套表：

```
1   table: 0x106c64120
1   1
2   1
3   1
4   1
5   1
6   1
7   1
8   1
9   1 
```

这里发生了什么？这些值都是相同的，但发生了一些奇怪的事情。

编辑：这是呈现地图以供参考的代码：

```
for y=1, #map do
    for x=1, #map[y] do
      if map[y][x] == 1 then
        print("found a wall")
        love.graphics.rectangle("fill", x * 30, y * 30, 30, 30)
      elseif map[y][x] == 2 then
        print("found a button")
        love.graphics.setColor(255, 0, 0)
        love.graphics.rectangle("fill", x * 30, y * 30, 30, 30)
        love.graphics.setColor(0, 0, 255)
      end
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T20:14:17.140

从文本文件中读取数据时，您会得到**字符串**。
在您的原始`map`表格中，您有**numbers**。
数字不等于字符串。

```
assert(1 ~= '1') 
```

# java - Android 启动器 - 主页按钮

> ID：15991749
> 
> 赞同：1
> 
> 时间：2013-04-13T19:06:45.380
> 
> 标签：java, android, android-launcher

我正在为 Android 开发一个主屏幕启动器应用程序。
现在，如果用户已经在主屏幕上，
我想要在用户按下主屏幕按钮时执行自定义操作。

我知道其他一些可以覆盖主页按钮的启动器，
例如 Go Launcher Ex。

我的代码是：

```
@Override
public boolean dispatchKeyEvent(KeyEvent event)
{
    int action = event.getAction();
    int keyCode = event.getKeyCode();

    switch (action)
    {
        case KeyEvent.ACTION_DOWN:
            switch (keyCode)
            {
                case KeyEvent.KEYCODE_HOME:
                    break;
            }
            break;

        case KeyEvent.ACTION_UP:
            switch (keyCode)
            {
                case KeyEvent.KEYCODE_HOME:
                    if (!event.isCanceled())
                        Log.i("TEST", "HOME");
                    break;
            }
            break;
    }

    return super.dispatchKeyEvent(event);
} 
```

但是当我按下主页按钮时，什么也没有发生..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:14:34.863

启动器是某种活动。

所以我相信当用户按下主页按钮时你会获得焦点。我可以肯定地告诉你一件事。这个有可能！

您在 View 类中获得了 setOnFocusChanged()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:09:25.703

参考这篇[文章](https://stackoverflow.com/questions/6693896/home-key-press-event-listener)：

> 抱歉，您无法“检测到主页键按钮按下事件”。

然而，在同一篇文章中，Idistic 建议这是一种解决方法：

```
long userInteractionTime = 0;

@Override
public void onUserInteraction() {
    userInteractionTime = System.currentTimeMillis();
    super.onUserInteraction();
    Log.i("appname","Interaction");
}

@Override
public void onUserLeaveHint() {
    long uiDelta = (System.currentTimeMillis() - userInteractionTime);

    super.onUserLeaveHint();
    Log.i("bThere","Last User Interaction = "+uiLag);
    if (uiDelta < 100)
        Log.i("appname","Home Key Pressed");    
    else
        Log.i("appname","We are leaving, but will probably be back shortly!");  
} 
```

# wcf - 静态验证方法 WCF

> ID：15991751
> 
> 赞同：0
> 
> 时间：2013-04-13T19:06:51.213
> 
> 标签：wcf, static-methods

如果我有一些 WCF 方法，例如

```
GetEmployeeDetailsResponse GetEmployeeDetails(GetEmployeeDetailsRequest request)
GetCustomerDetailsResponse GetEmployeeDetails(GetCustomerDetailsRequest request) 
```

我需要对 Request 对象执行输入验证，我可以使用静态方法吗？许多验证将很常见，例如 Request 对象不应为 null 并且员工 ID/客户 ID（在请求消息中）不应为 0 等。我猜由于 Request 对象本身是独立的对象，将它们传递给静态方法不应该导致任何线程安全问题。我正在使用按呼叫服务。

谢谢维卡斯
_

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T20:17:41.457

是的你可以。

但是 - 考虑一下您将验证请求 #1 并在请求 #1 完成**之前**收到请求 #2的情况。如果您的静态方法将为这两个请求做一些共同的事情，您会发现自己在思考`locks`，...

使用某种检查器，例如 [IClientMessageInspector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.iclientmessageinspector.aspx)，将是此类事情的更正确选择 - IMO。

# ios - 在屏幕上移动 UIbutton

> ID：15991753
> 
> 赞同：0
> 
> 时间：2013-04-13T19:06:52.313
> 
> 标签：ios

我在屏幕上有很多 UIbuttons，我希望用户能够通过按住它们然后拖动它们来移动按钮。我想出了这段代码：

```
- (void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event {

[[NSUserDefaults standardUserDefaults] synchronize];
[[NSNotificationCenter defaultCenter] postNotificationName:@"MoveAllViewsUpForDrag" object:self userInfo:nil];

//[self.layer removeAllAnimations];

// Retrieve the touch point
CGPoint pt = [[touches anyObject] locationInView:self.view];
startLocation = pt;

originYDraggable = self.frame.origin.y;
originXDraggable = self.frame.origin.x;

[[self superview] bringSubviewToFront:self];

[UIImageView animateWithDuration:0.5 animations:^(void) {

    CGRect frame = [self frame];
    frame.size.width = frame.size.width + 15;
    frame.size.height = frame.size.height + 15;
    [self setFrame:frame];

    [self setAlpha:0.6];

}];

Draggable* sharedSingleton = [Draggable sharedManagerDraggable];

//nameOfTheMessage = sharedSingleton.namePassedToDraggable;

NSLog(@"%@, %d", sharedSingleton.namePassedToDraggableArray, self.tag);

}

- (void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event {
// Move relative to the original touch point
CGPoint pt = [[touches anyObject] locationInView:self];
CGRect frame = [self frame];
frame.origin.x += pt.x - startLocation.x;
frame.origin.y += pt.y - startLocation.y;
[self setFrame:frame];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {

[[NSUserDefaults standardUserDefaults] synchronize];
[[NSNotificationCenter defaultCenter] postNotificationName:@"MoveAllViewsDownForDrag" object:self userInfo:nil];

CGRect frame = [self frame];
if (frame.origin.y < 50) {

    SaveEventsOrganizer* sharedSingletonOrganizer = [SaveEventsOrganizer sharedManagerSaveEventsOrganizer];
    Draggable* sharedSingletonDraggable = [Draggable sharedManagerDraggable];

    NSString *string = sharedSingletonDraggable.namePassedToDraggableArray[self.tag - 1];

    sharedSingletonOrganizer.NameOfEventPassedToOrganizerFromDraggable = string;
    [sharedSingletonOrganizer addAnEvent];

    [self removeFromSuperview];

}else{

    [UIImageView animateWithDuration:0.5 animations:^(void) {

        CGRect frame = [self frame];
        frame.size.width = frame.size.width - 15;
        frame.size.height = frame.size.height - 15;
        frame.origin.x = originXDraggable;
        frame.origin.y = originYDraggable;
        [self setFrame:frame];

        [self setAlpha:1.0];

    }];

    /*CABasicAnimation* anim = [CABasicAnimation animationWithKeyPath:@"transform.rotation"];
     [anim setToValue:[NSNumber numberWithFloat:0.0f]];
     [anim setFromValue:[NSNumber numberWithDouble:M_PI/80]]; // rotation angle
     [anim setDuration:0.1];
     [anim setRepeatCount:NSUIntegerMax];
     [anim setAutoreverses:YES];
     [self.layer addAnimation:anim forKey:@"iconShake"];*/

}
} 
```

唯一的问题是我不知道如何检测已按下哪个按钮来移动它。有任何想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:18:03.670

您可以使用命中测试。请参阅我书中的示例：

[http://www.aeth.com/iOSBook/ch18.html#_hit_testing](http://www.apeth.com/iOSBook/ch18.html#_hit_testing)

在您的背景视图中获得了点...

```
CGPoint pt = [[touches anyObject] locationInView:self.view]; 
```

您现在可以点击测试该点所在的子视图（按钮）（如果有）：

```
UIView* v = [self.view hitTest:pt withEvent:nil]; 
```

但是，我认为您整体上执行此操作的方式非常复杂。使用手势识别器可能会更开心。在我的书中，我还描述了如何使用 UIPanGestureRecognizer 来拖动对象：

[http://www.aeth.com/iOSBook/ch18.html#_gesture_recognizers](http://www.apeth.com/iOSBook/ch18.html#_gesture_recognizers)

# c++ - XCODE：使用字符串流时的链接问题

> ID：15991755
> 
> 赞同：1
> 
> 时间：2013-04-13T19:07:08.620
> 
> 标签：c++, xcode, stringstream

我不明白为什么 XCode 在使用时会遇到链接问题

```
 string create_base_uri(string host, int port, string dbname){
      std::ostringstream ostr; //output string stream
      ostr << port; //use the string stream just like cout,
      string port_string = ostr.str();
      return "http://" + host + ":" + port_string + "/" + dbname;
} 
```

> 架构 x86_64 的未定义符号：“CouchServer::create_base_uri(std::__1::basic_string, std::__1::allocator >, int, std::__1::basic_string, std::__1::allocator >)”,引用自：couchServer::get_document_by_id(std::__1::basic_string, std::__1::allocator >) in couch_server.o ld：符号未找到架构 x86_64 clang：错误：链接器命令失败，退出代码1（使用 -v 查看调用）

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T19:24:54.767

您需要定义相对于类的成员函数：

```
string CouchServer::create_base_uri(string host, int port, string dbname) {
    //..
} 
```

相反，您正在定义一个自由函数：

```
string create_base_uri(string host, int port, string dbname) {
    //..
} 
```

有趣的是，它可以编译，因为它不引用该类的任何其他成员。将其设为免费功能可能会更好！如果它当前是私有成员，则可以将其放在匿名命名空间中。如果它在其他地方有用，你可以把它变成一个实用函数。

# asp.net - Regex to disallow extended ASCII characters

> ID：15991762
> 
> 赞同：1
> 
> 时间：2013-04-13T19:08:12.813
> 
> 标签：asp.net, regex

I'm looking for a regular expression that will disallow extended ASCII characters, inorder to apply it on a text box in an ASP.NET application. Please help!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:22:51.610

The following will only match a string that contains only ASCII characters

```
^[\x00-\x7F]+$ 
```

To disallow only the extended ASCII characters you could use

```
^[^\x80-\xFF]+$ 
```

# magento - Magento 小部件不显示自定义模板

> ID：15991768
> 
> 赞同：2
> 
> 时间：2013-04-13T19:08:42.197
> 
> 标签：magento, templates, widget

我在 Magento 中设置了一个带有一个自定义小部件的自定义模块。小部件应该在前端呈现一些 HTML。因此，我创建了一个自定义 .phtml 文件并在 widget.xml 中进行了配置

```
<?xml version="1.0"?>
<widgets>
    <startslider_slider type="startslider/slider ">
        <name>Slider Startpage</name>
        <description type="desc">Adds a slider</description>
        <parameters>
            <the_text>
                <label>myTestText</label>
                <visible>1</visible>
                <required>1</required>
                <type>text</type>
            </the_text>
            <template translate="label">
                <label>Frontend Template</label>
                <visible>1</visible>
                <required>1</required>
                <type>select</type>
                <values>
                    <three translate="label">
                        <value>startslider/slider-3.phtml</value>
                        <label>Slider with three blocks</label>
                    </three>
                    <four translate="label">
                        <value>startslider/slider-4.phtml</value>
                        <label>Slider with four blocks</label>
                    </four>
                </values>
            </template>
        </parameters>       
    </startslider_slider>
</widgets> 
```

我可以在后端（）中插入和配置小部件，`{widget type="startslider/slider" the_text="blabla" template="startslider/slider-3.phtml"}`并在前端执行块类的 _toHtml() 方法并输出一些文本，仅用于测试。但是 .phtml 模板的内容从未显示。我想知道 Magento 是否无法找到 .phtml？

我将 .phtml 放在以下位置：

```
magento-vhost/app/design/frontend/default/myCustomTheme/template/startslider/slider-3.phtml
magento-vhost/app/design/frontend/default/default/template/startslider/slider-3.phtml
magento-vhost/app/design/frontend/base/default/template/startslider/slider-3.phtml 
```

我是不是忘记了什么？我必须配置某事吗？否则使用自定义.phtml？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-13T20:13:52.920

可能的事情太多了，但这里有一些东西可以尝试。

您的`startslider/slider`小部件继承自哪个类？如果不是，`Mage_Core_Block_Template`那么您没有模板小部件块。

你为你的小部件创建了一个`_toHtml`方法——这个小部件是否仍然调用 `parent::_toHtml();`. 如果不是，模板渲染代码将永远不会运行。

做什么

```
var_dump($this->getData());
var_dump($this->getTemplate());
var_dump($this->getTemplateFile()); 
```

从`_toHtml`方法渲染？这些路径是否与文件系统完全匹配（包括字母大小写）？

# jquery - jquery - 当另一个值为空时从输入中清除值

> ID：15991773
> 
> 赞同：0
> 
> 时间：2013-04-13T19:09:30.817
> 
> 标签：jquery, html, html-input

我有 2 个输入字段

```
<input id="pass1" name="pass1" value="" size="12" type="password" />
<input id="pass2" name="pass2" value="" size="12" type="password" /> 
```

when`id="pass1"`没有值（为空）并且`id="pass2"`有一个值，我想`id="pass2"`在提交表单之前用 jquery 清除。

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:11:12.083

我认为检查第二个输入是没用的，没有逻辑上的原因，我的意思是在这两种情况下你最终都是空的`#pass2`

```
$("form").on('submit',function(){
      if($("#pass1").val() == ''){
          $("#pass2").val('');
          return false;
      }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:25:08.200

See you have to do a form submit and check if the `#pass1` is empty or not and `return false` or `event.preventDefault()` to stop the form to submit.

```
$(function(){
  $("yourFormId").submit(function(e){
    if($("#pass1").val() == ''){
       $("#pass2").val('');
       e.preventDefault(); //<----stop the form submission here after clearing
    }
  });
}); 
```

# javascript - 通过 Kendo UI (Javascript/Jquery) 将日期传递给 WCF REST 服务

> ID：15991775
> 
> 赞同：0
> 
> 时间：2013-04-13T19:09:33.283
> 
> 标签：javascript, wcf, rest, jquery, kendo-grid

这个想法是我有日历控制，我可以从中选择不同的日期。根据选择的日期，我对 WCF 服务 (GetDealData()) 进行 ajax 调用以获取一些数据集。请问有人可以看看这里有什么问题吗？这两天我有点疯狂地试图弄清楚为什么我的 GetRemoteData() 方法每次执行 OnDateChange 方法时都会传递相同的日期（即 2012 年 10 月 25 日），即使我在日历控件上选择了不同的日期也是如此。是否与未正确分配 json 数据有关？

```
$('#calendarContainer').kendoCalendar({
        format: "dd/MM/yyyy",
        culture: "en-GB",
        change: onDateChange
});

function onDateChange() {
        var date = kendo.toString(this.value(), 'dd/MM/yyyy');
        var bob = GetRemoteData(date);
        $("#grid").data("kendoGrid").dataSource.data(bob);
        $("#grid").data("kendoGrid").dataSource.read();          
    } 
```

函数获取远程数据（日期）{

```
 var chosenDate;

        if (typeof date=="undefined")
        {
            alert("it is null " + date);
            chosenDate = "25-10-2012";
        }
        else {
            alert("it is not null " + date);               
            chosenDate = date;
        }

        source = new kendo.data.DataSource({
         //   autoSync:true,
            transport: {
                read: {
                    type: "GET",
                    url: "http://localhost:35798/RestServiceImpl.svc/GetDealData",
                    dataType: "jsonp",
                    contentType: "application/json; charset=utf-8",
                    cache: false,
                    data: {
                        startDate:chosenDate
                    }
                }

            },
            schema: {
                model: {
                    fields: {
                        DealNumber: { type: "string" },
                        DealIssuer: { type: "string" },
                        Ticker: { type: "string" },
                        DealType: { type: "string" },
                        DealValue: { type: "number" },
                        DealStatus: { type: "string" },
                        DealPricingCompletionDate: { type: "date" }
                    }
                }
            },
            pageSize: 16
        });
        return source;
    }

    WCF Methods
    [OperationContract]
    [WebInvoke(Method = "GET", ResponseFormat = WebMessageFormat.Json,
      BodyStyle = WebMessageBodyStyle.WrappedRequest,
      UriTemplate = "GetDealData?startDate={startDate}")]
    List<DealData> GetDealData(string startDate);

    public List<DealData> GetDealData(string startDate)
    {
        CultureInfo culture = new CultureInfo("en-GB");                                 
        List<DealData> model =                      Service.GetDealData(Convert.ToDateTime(startDate,culture));         
        return model;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T04:26:17.420

从您的代码来看，这个问题似乎与 wcf 无关——它只是一个 JavaScript 问题。看来，您的日期始终未定义。

我会尝试找出 的值是什么`this.value()`，然后是 -`kendo.toString(this.value(), 'dd/MM/yyyy')`值。

对我来说，这听起来像是一些格式问题。

您可以使用浏览器的控制台来调试 JavaScript

# formatting - 表单提交时间格式故障/修复上的 Google Apps 脚本

> ID：15991777
> 
> 赞同：1
> 
> 时间：2013-04-13T19:09:47.330
> 
> 标签：formatting, google-apps-script, google-sheets

**背景：**

*如何：*我怀疑这是 Google 表单（提交过程）/电子表格中的一个小故障，但可能是电子表格界面的日期转换实用程序的一部分（并且是预期的功能）。

*在 Google Forms 的文本框中*输入格式时，Form submit 和 Response Spreadsheet 之间存在某种通信错误，或者在将 Form 的数据发送到电子表格之前对其进行预处理。故障似乎只发生在不包含“。”格式的文本字段中的`##:## TEXT`数据`TEXT`上**。字符**。例如：`4:15 pm`会重现故障，但`4:15 p.m`不会`4:15 p.m.`。

*结果：*当将*撇号*字符放入电子表格（即`'4:15 pm`）时，将在字符串的开头添加一个撇号字符，这会抛出我使用该时间数据的几个子系统。这是两个屏幕截图（对不起，第二个尺寸不好）：

![G1](https://i.stack.imgur.com/NWeQO.png)![G2](https://i.stack.imgur.com/ZGCsb.png)

我 99% 确定故障是由`##:`组合引起的。

**临时修复？**：真正的问题是……在我开始操作时间数据之前，我该如何去除那个讨厌的撇号？我知道如何获取单元格/范围的 getValue()。假设我通过以下方式获得单元格的值：

```
var value = myRange.getValue();
// value = '4:15 pm 
```

我该如何处理该值`4:15 pm`？一个简单的java函数可以是

```
value = value.substring(1); // Assuming "value" is a String 
```

但是在 Google App Scripts for *Spreadsheets*中，我不知道该怎么做。

**后期脚本：**有必要对这些数据进行后期处理，这样我就不必向语言系的大学教员讲授如何在表格中正确输入时间格式。

提前感谢那些可以提供帮助的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T20:34:15.530

> 我如何才能将该值处理到下午 4:15？一个简单的java函数可以是
> 
> 值 = value.substring(1); // 假设“value”是一个字符串但在 Google App Scripts for Spreadsheets 中，我不知道该怎么做。

Google Apps Scripts 使用具有完全相同方法的 Javascript。

```
value = value.substring(1); 
```

应该返回除第一个字符之外的所有字符。

有关 Javascript 子字符串的更多信息，请访问： http: [//www.w3schools.com/jsref/jsref_substring.asp](http://www.w3schools.com/jsref/jsref_substring.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T20:04:25.783

如果您删除电子表格单元格中的 '，电子表格界面会将此条目转换为日期对象。

这可能（或不是）对您来说是一个问题，所以当您读回数据以供其他用途时，您应该处理这个问题......当文本不同（例如使用 PM）时不会发生这种情况，因为在这种情况下' 电子表格不需要将其保留为字符串，因为电子表格无法将其转换为日期对象（时间值）。

人工智能有其不好的一面；-)

* * *

**编辑：** 您不能使用您提到`onFormSubmit`的 javascript 在触发函数中执行此操作。`substring()`如果你不熟悉，这里是要走的路：

在执行特定操作时运行脚本：

1.  打开或创建一个新的电子表格。
2.  单击未保存的电子表格对话框并更改名称。
3.  选择工具 > 脚本编辑器并编写要运行的函数。
4.  选择资源 > 当前项目的触发器。您会看到一个面板显示未设置触发器消息。点击这里，马上添加一个。
5.  点击链接。
6.  在运行下，选择要由触发器执行的功能。
7.  在事件下，选择从电子表格。
8.  从下一个下拉列表中，选择打开时、编辑时或表单提交时。
9.  单击保存。

[请参阅此处](https://developers.google.com/apps-script/understanding_triggers#ActionTriggers)和[此处的](https://developers.google.com/apps-script/understanding_events)文档

# java - 克隆/复制对象

> ID：15991778
> 
> 赞同：1
> 
> 时间：2013-04-13T19:09:50.383
> 
> 标签：java, clone

我正在用 Java 创建一个 connect 4 游戏，并且我正在尝试制作自定义对象（游戏板）的深层副本，然后修改该副本并将其作为 mini max 算法的一部分添加到列表中。

这是我用于复制的代码：

```
public void getPossibleBoards(Board board) {
    for(int i = 0; i < 7; i++) {
        if(!board.columns.get(i).isFull()) {    
            Board tmpBoard = board.copy(board);
            tmpBoard.columns.get(i).addCounter(turn);   
            boardList.add(tmpBoard);
        }
    }
}

public Board copy(Board other) {
    Board b = new Board(other);
    b.columns = other.columns;
    return b;
} 
```

这需要主板（作为参数传递），遍历板上的列，如果列未满，它会创建一个新的板对象并将一个计数器放在一个空列中，然后将这个新的板对象添加到列表供以后使用。

问题是，当我复制电路板时，它会一直引用主板并对其进行修改，然后每个循环都会在列中添加一个计数器，而无需先清除电路板。

预期输出为：（玩家 1 是人，玩家 2 是计算机）

```
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
2 0 0 0 0 0 1

0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 2 0 0 0 0 1

0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 2 0 0 0 1 
```

依此类推，直到 7 个循环结束。

实际输出：

```
0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 2 
2 2 2 2 2 2 1 

0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 0 
0 0 0 0 0 0 2 
2 2 2 2 2 2 1 
```

依此类推，直到 7 个循环结束。

### 编辑：

我对下面的解决方案有问题，所以我决定尝试另一种方法，但得到了相同的结果，我不明白为什么。

我基本上是在创建一个新的 Board 对象，在构造函数中我为其分配新的空白列，然后循环通过 main_board 以获取每个插槽的计数器的颜色（在 Slot 类中存储为整数），并更改新董事会分别。

```
if(!board.columns.get(i).isFull()) {    
    Board tmpBoard = new Board();

    for(int j = 0; j < 7; j++) {
        for(int k = 0; k < 7; k++) {
                    tmpBoard.columns.get(j).slots.get(k).setColour(board.columns.get(j).slots.get(k).getColour());
        }   
    }
} 
```

板子构造器

```
public Board() {
    for(int i = 0; i < 7; i++) {
        columns.add(new Column());
    }
} 
```

### 编辑：没关系，上述解决方案有效，只是我忘记在复制后添加一个新计数器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T19:15:05.977

该行 `b.columns = other.columns;`会导致问题，因为您正在执行引用分配（即它没有像您期望的那样进行深层复制）。您可以使用`System.arraycopy`方法复制该数组。

我认为在您的情况下，您使用 ArrayList 来表示列/行，如果是这样，您可以使用：

`Collections.copy(arrayList2,arrayList1);`

或者干脆

`new ArrayList<Integer>(oldList)`

为了创建一个副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:14:45.123

为什么`Board`将另一个`Board`作为构造函数参数？

你的问题是你不复制列，你只`b.columns = other.columns`在你的`copy`方法中做。如果两块板之一被改变，两块板都会受到影响。复制时创建一个新的列实例，并深度复制列中的所有元素，直到达到不可变对象或基元。

# gwt - 无法运行 HighChart GWT 演示示例 - 区域范围

> ID：15991780
> 
> 赞同：0
> 
> 时间：2013-04-13T19:10:03.703
> 
> 标签：gwt, highcharts, gwt-highcharts

我试图在我的应用程序中获得一个面积图，但是，我什至无法显示最基本的一个（我真的检查了他们的实现是否可以工作，但它没有并抛出这个错误）

示例我尝试运行[http://www.moxiegroup.com/moxieapps/gwt-highcharts/showcase/#area-range](http://www.moxiegroup.com/moxieapps/gwt-highcharts/showcase/#area-range)

> com.google.gwt.core.client.JavaScriptException: (TypeError) @org.moxieapps.gwt.highcharts.client.BaseChart::nativeRenderChart(Ljava/lang/String;Lcom/google/gwt/core/client/JavaScriptObject;ZZLcom /google/gwt/core/client/JavaScriptObject;Lcom/google/gwt/core/client/JavaScriptObject;Lcom/google/gwt/core/client/JavaScriptObject;Lcom/google/gwt/core/client/JavaScriptObject;Lcom/google /gwt/core/client/JavaScriptObject;Lcom/google/gwt/core/client/JavaScriptObject;Lcom/google/gwt/core/client/JavaScriptObject;Lcom/google/gwt/core/client/JavaScriptObject;Lcom/google/gwt /core/client/JavaScriptObject;Lcom/google/gwt/core/client/JavaScriptObject;)([string: 'Chart', JavaScript object(10), bool: false, bool: false, JavaScript object(36), JavaScript object (37), JavaScript 对象(38), JavaScript 对象(26), JavaScript 对象(32),JavaScript 对象（25），JavaScript 对象（30），JavaScript 对象（31），JavaScript 对象（34），JavaScript 对象（35）]）：$wnd.Highcharts 未定义

是否有可能我使用了不正确的 JQuery？非常感谢任何和所有帮助，因为此功能对我们的应用程序很重要

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T22:09:34.900

这个错误的原因是当我包含 highcharts.js 时，我没有包含 highcharts-more.js。包括这解决了我的问题！

# jain-sip - 云中 jboss 为 7 的 mobicent sip servlet

> ID：15991782
> 
> 赞同：2
> 
> 时间：2013-04-13T19:10:28.410
> 
> 标签：jain-sip

我已经为 mobicent sip servlet 开发了 javaee 解决方案。我需要与客户端共享应用程序以进行测试。我如何在云中上传mobicent？或者是否可以通过互联网与静态 ip mobicent url（jboss 服务）共享我的本地电脑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-09T09:04:29.117

我们刚刚在 Amazon Marketplace 上创建了一个 AMI，请参阅[https://aws.amazon.com/marketplace/pp/B00G9G94JW/ref=sp_mpg_product_title?ie=UTF8&sr=0-4](https://aws.amazon.com/marketplace/pp/B00G9G94JW/ref=sp_mpg_product_title?ie=UTF8&sr=0-4) ，这样您就可以分拆一个新实例并部署您的应用程序与您的客户分享。用户指南在这里[http://www.telestax.com/docs/](http://www.telestax.com/docs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T08:04:24.993

只需将其部署到 Amazon EC2 并与您的客户端共享 IP。

# android - jsoup 未知主机异常

> ID：15991787
> 
> 赞同：3
> 
> 时间：2013-04-13T19:11:01.500
> 
> 标签：android, jsoup

这是我已经工作了 3 天的代码。我无法找出它抛出的原因：

```
java.net.UnknownHostException:
Unable to resolve host "www.google.co.in": No address associated with hostname 
```

下面是`MainActivity`课程：

```
package com.example.yo;

import java.io.IOException;
import java.net.*;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import android.annotation.SuppressLint;
import android.annotation.TargetApi;
import android.app.Activity;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Build;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

@TargetApi(Build.VERSION_CODES.GINGERBREAD)
public class MainActivity extends Activity {

    Document doc;
    TextView tv;
    String res = "";

    String BLOG_URL = "https://www.google.co.in/";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // set layout view
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);

        new jsoupexample().execute(BLOG_URL);
    }

    @TargetApi(Build.VERSION_CODES.GINGERBREAD)
    public class jsoupexample extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... arg0) {
            // TODO Auto-generated method stub
            try {
                doc = Jsoup.connect(BLOG_URL).userAgent("Mozilla/5.0").timeout(20000).get();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            Elements links = doc.select("a[href]");

            for (Element element : links) {
                res = element.attr("href");
            }
            return res;
        }
    }

    protected void onPostExecute(String result) {
        if (result != null && !result.isEmpty()) {
            tv.setText(result);
        } else {
            tv.setText("no value returned");
        }
    }
} 
```

这是日志猫：

```
04-14 00:23:32.800: W/System.err(26397): java.net.UnknownHostException: Unable to resolve host "www.google.co.in": No address associated with hostname
04-14 00:23:32.810: W/System.err(26397):    at java.net.InetAddress.lookupHostByName(InetAddress.java:394)
04-14 00:23:32.810: W/System.err(26397):    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
04-14 00:23:32.820: W/System.err(26397):    at java.net.InetAddress.getAllByName(InetAddress.java:214)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:340)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:316)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.makeSslConnection(HttpsURLConnectionImpl.java:461)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.connect(HttpsURLConnectionImpl.java:442)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:290)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:240)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:81)
04-14 00:23:32.820: W/System.err(26397):    at libcore.net.http.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:165)
04-14 00:23:32.830: W/System.err(26397):    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:425)
04-14 00:23:32.830: W/System.err(26397):    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:410)
04-14 00:23:32.830: W/System.err(26397):    at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:164)
04-14 00:23:32.830: W/System.err(26397):    at org.jsoup.helper.HttpConnection.get(HttpConnection.java:153)
04-14 00:23:32.830: W/System.err(26397):    at com.example.yo.MainActivity$jsoupexample.doInBackground(MainActivity.java:50)
04-14 00:23:32.830: W/System.err(26397):    at com.example.yo.MainActivity$jsoupexample.doInBackground(MainActivity.java:1)
04-14 00:23:32.830: W/System.err(26397):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
04-14 00:23:32.830: W/System.err(26397):    at java.util.concurrent.FutureTask.run(FutureTask.java:234)
04-14 00:23:32.830: W/System.err(26397):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
04-14 00:23:32.830: W/System.err(26397):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
04-14 00:23:32.830: W/System.err(26397):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
04-14 00:23:32.830: W/System.err(26397):    at java.lang.Thread.run(Thread.java:856)
04-14 00:23:48.490: W/dalvikvm(26397): threadid=11: thread exiting with uncaught exception (group=0x41767930)
04-14 00:23:48.510: E/AndroidRuntime(26397): FATAL EXCEPTION: AsyncTask #1
04-14 00:23:48.510: E/AndroidRuntime(26397): java.lang.RuntimeException: An error occured while executing doInBackground()
04-14 00:23:48.510: E/AndroidRuntime(26397):    at android.os.AsyncTask$3.done(AsyncTask.java:299)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at java.util.concurrent.FutureTask.run(FutureTask.java:239)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at java.lang.Thread.run(Thread.java:856)
04-14 00:23:48.510: E/AndroidRuntime(26397): Caused by: java.lang.NullPointerException
04-14 00:23:48.510: E/AndroidRuntime(26397):    at com.example.yo.MainActivity$jsoupexample.doInBackground(MainActivity.java:57)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at com.example.yo.MainActivity$jsoupexample.doInBackground(MainActivity.java:1)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
04-14 00:23:48.510: E/AndroidRuntime(26397):    at java.util.concurrent.FutureTask.run(FutureTask.java:234)
04-14 00:23:48.510: E/AndroidRuntime(26397):    ... 4 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T04:24:59.593

发生异常`java.net.UnknownHostException: Unable to resolve host`是因为您的应用无法连接到指定的主机。

可能的原因是您的互联网连接实际上已关闭。您可以使用`ping`命令对其进行测试。

另一个常见原因是您的 Android 清单文件中缺少访问 Internet 的权限`AndroidManifest.xml`。

如果您尚未添加该权限，请将下面的行添加到您的`AndroidManifest.xml`文件中，就在`<manifest>`标签之后和标签之前`<application>`：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

有关 Android 互联网权限语法和其他 AndroidManifest 权限示例的更多信息，请查看 android.com 的示例：http: [//developer.android.com/tools/samples/index.html](http://developer.android.com/tools/samples/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:29:47.220

你真的需要`https`吗？我建议尝试使用`http`.

# mysql - mysql导入错误1064

> ID：15991790
> 
> 赞同：0
> 
> 时间：2013-04-13T19:11:06.657
> 
> 标签：mysql, csv, mysqlimport

我正在尝试通过 mysqlimport 导入一个简单的 CSV 文件并收到以下错误：

```
mysqlimport '--fields-enclosed-by="' '--fields-terminated-by=;' '--lines-terminated-by=\n' '--columns=Name;Vorname;Test' -u db01usr -pPW01 db01 /var/www/vhosts/path/httpdocs/feedtest/test.csv 
```

错误：

```
mysqlimport: Error: 1064, You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ';Vorname;Test)' at line 1, when using table: test 
```

该文件是：

```
Name;Vorname;Test
Test1;Test2;Test3 
```

mySQL 表：

```
CREATE TABLE IF NOT EXISTS `test` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `Name` text,
  `Vorname` text,
  `Test` text,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:31:16.707

使用`,`而不是分号来分隔列：

```
mysqlimport '--fields-enclosed-by="' \
            '--fields-terminated-by=;' \
            '--lines-terminated-by=\n' \
            '--columns=Name,Vorname,Test' \
            -u db01usr -pPW01 db01 /var/www/vhosts/path/httpdocs/feedtest/test.csv 
```

# security - 对未知实体使用 PGP

> ID：15991797
> 
> 赞同：0
> 
> 时间：2013-04-13T19:11:55.703
> 
> 标签：security, authentication, pgp

我目前正在研究 PGP 和身份验证方案。

假设我正在与自称是 ftp 站点管理员的人交流。（比如说，他的电子邮件地址是 admin@genuine-website.com）

假设我们都有彼此的 PGP 公钥。

首先说，我们交换指纹并验证它们（通过直接传输它们而不使用像电话/短信这样的带外身份验证）。第二步，我们交换签名消息，然后验证签名。

这两个步骤是否足以确定真实性？

通过这个虚构的例子，我想问的基本问题是这些步骤是否“足够”或者我应该在此基础上选择另一种相互身份验证方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:30:24.480

这已经足够了，但最棘手的是验证指纹。对于 PGP，这是通过与其他密钥交叉签名密钥来完成的。虽然在 X.509 中它是分层结构（顶级 CA 并由它们签名证书），但在 PGP 中它是作为“信任网络”完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:37:54.793

不，这还不够好。中间人可以用他的公钥代替你和你伴侣的公钥，然后用指纹做同样的事情，这样一切看起来都正常。

您需要使用 PGP 的信任网络，或在您信任的其他介质中交换指纹，以验证您收到的公钥是真实的。

# jquery - 从第二个集合中过滤的 Knockout.Js selectedOptions

> ID：15991799
> 
> 赞同：0
> 
> 时间：2013-04-13T19:12:01.680
> 
> 标签：jquery, knockout.js

我正在将一个集合绑定到一个 select multi，集合中的一些项目也在第二个集合中，我想将这些设置为 select multi 中的 selectedOptions。

我希望使用 ko.utils.arrayFilter 来执行此操作，但似乎无法从另一个集合中过滤出一个集合。

[http://jsfiddle.net/dumbarse/BcUBK/](http://jsfiddle.net/dumbarse/BcUBK/)

```
<select data-bind="options:availableThings,optionsText: 'Title', selectedOptions: selectedComputeThings" size="5"  multiple="true"></select>
        var initialThingsModel = [
            {"Id":1,"Title":"First"},
            {"Id":2,"Title":"Next"},
            {"Id":3,"Title":"Another"},
            {"Id":4,"Title":"Last"}
        ];
           var initialSelectedThingsModel = [
            {"Id":2,"Title":"Next"},
            {"Id":4,"Title":"Last"}];

    var viewModel = {
        availableThings: ko.observableArray(initialThingsModel),   
        selectedThings:  ko.observableArray(initialSelectedThingsModel)
    };
    viewModel.selectedComputeThings = ko.computed(function() { return ko.utils.arrayFilter(viewModel.availableThings(), function(item) { return item.Id == selectedThings.Id;}) });

        ko.applyBindings(viewModel); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:42:35.037

您应该修改`computed`并编写如下内容：

```
viewModel.selectedComputeThings = ko.computed(function() {
    return ko.utils.arrayFilter(
        initialThingsModel,
        function(thing){ 
            return ko.utils.arrayFirst(
                initialSelectedThingsModel,
                function(sel){ return sel.Id == thing.Id; }
            );
        }
    );
}); 
```

作品：http: [//jsfiddle.net/BcUBK/1/](http://jsfiddle.net/BcUBK/1/)

**更新：**

要跟踪您不需要的选择`computed`- 很简单`observableArray`（哦，您`selectedThings`的模型中已经有了！）。只需用对选定事物的参考来填充它。

稍微修改您的`selectedThings`声明：

```
selectedThings:  ko.observableArray([]) 
```

转换为将 refs 分配给可观察数组`computed`的简单函数：`selectedThings`

```
viewModel.preselectThings = function() {
    viewModel.selectedThings(ko.utils.arrayFilter(
        initialThingsModel,
        function(thing){ 
            return ko.utils.arrayFirst(
                initialSelectedThingsModel,
                function(sel){ return sel.Id == thing.Id; }
            );
        }
    ));
}; 
```

在之前/之后的任何地方添加函数调用`ko.applyBindings`：

```
ko.applyBindings(viewModel);

viewModel.preselectThings(); 
```

并更改`selectedComputeThings`为`selectedThings`标记中的任何位置。

利润！

[http://jsfiddle.net/BcUBK/3/](http://jsfiddle.net/BcUBK/3/)

# javascript - 具有多个输入的自定义 Knockout 绑定，其中之一是包含索引数组

> ID：15991804
> 
> 赞同：1
> 
> 时间：2013-04-13T19:12:35.130
> 
> 标签：javascript, knockout.js

[这是我在 jsFiddle 上遇到的问题的一个例子。](http://jsfiddle.net/67TyP/3/)

我想创建一个需要两个输入的自定义绑定。这可以通过将值数组传递给绑定来完成。例如，这个绑定：

```
ko.bindingHandlers.whatever = {
    update: function (element, valueAccessor) {
        var args = valueAccessor();
        element.innerHTML = args[0] + " " + args[1];
    }
}; 
```

将接受两个输入并将它们与它们之间的空格连接起来。因此，类似的东西`<p data-bind="whatever: ['First', 'Second']"></p>`将显示为`<p>First Second</p>`.

这也适用于变量。因此，如果我在视图模型中有一些数据：

```
var vm = {
    category: "Category",
    people: [
        {name:  "Bob"},
        {name:  "Ann"}
    ]
};
ko.applyBindings(vm); 
```

我可以做类似的事情：

```
<p data-bind="whatever: [category, 'blah blah blah']"></p> 
```

它会显示：

```
<p>Category blah blah blah</p> 
```

当我想将嵌套变量传递给我的绑定时，我的问题就出现了。像这样的东西：

```
<p data-bind="whatever: [people[0].name, 'blah blah blah']"></p> 
```

我希望它显示`<p>Bob blah blah blah</p>`，但我收到此错误消息：

**错误：无法解析绑定。消息：语法错误：元素列表后缺少]；绑定值：随便：[people[0].name, 'blah blah blah']**

（再一次，[这里是这个 jsFiddle 的链接](http://jsfiddle.net/67TyP/3/)。）

这看起来很奇怪，好像它变得困惑并认为这`[0]`是另一个列表而不是`people`. 任何想法为什么会发生这种情况或如何解决问题？

我对 Knockout 不是很有经验，所以很可能我做错了可怕的事情。例如，我什至很难在网上找到人们创建自定义绑定的示例，这些绑定直接从模板中获取多个输入（出于某种原因，这是不应该做的事情吗？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T20:09:48.257

除了传递数组之外，不完全确定问题似乎会导致问题。我用命名参数替换，它可以工作：

[http://jsfiddle.net/37Py6/](http://jsfiddle.net/37Py6/)

另请注意，我使用了

```
ko.bindingHandlers.text.update(...) 
```

，以免做DOM操作是淘汰码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T20:25:23.390

如果你用一个函数包装它也可以工作：http: [//jsfiddle.net/67TyP/7/](http://jsfiddle.net/67TyP/7/)

```
<p data-bind="whatever: function(){ return [people[0].name, 'blah blah blah']}() "></p> 
```

# jquery - 如何使用 Jquery 在容器 div 中选择任何单击的 html 标记

> ID：15991811
> 
> 赞同：0
> 
> 时间：2013-04-13T19:13:14.383
> 
> 标签：jquery, html, tags, containers, click

我希望你能帮助我。

我正在尝试触发一个降低任何点击标签（h1、img、div 等）不透明度的事件，但我只希望此事件在包含 div 内的标签上触发。

例子：

```
<div id="opacity_wrapper">
  <div class="row-fluid">
     <div class="span12" style="padding-top: 25px;">
       <div class="well well-large" style="background-color: #FFF">
             <h1> Some Stuff </h1>
             <img src="/img/blah.jpg" />
             <h2> more stuff </h2>
             <div style="background-color: #000">
               <a href="#"> some link </a>
               <h2> blahblahblah> </h2>
             </div>
      </div>
    </div>
  </div>
</div>

<div>
  <h6> more stuff </h6>
  <h5> more stuff> </h5>
  <button> some button </button>
</div> 
```

因此，如果点击了任何“h1”、“img”、“h2”、“div”或“a”标签，我希望它触发（并且仅针对被点击的特定 h1、img 或 h2 标签)，但我不希望它触发不包含在 opacity-wrapper div 中的任何元素，例如底部的“h6”、“h5”或按钮标签。

这可能吗？

这让我最接近，但它不排除任何元素。

```
<script>
  $(document).ready(function(){
  $( window ).click(function ( e ) {
  $( e.target ).css({ opacity: 0.5 });
    });
});
</script> 
```

如果有什么办法，

如果 window.clicked 元素是 #opacity_wrapper" 的子元素，则 {

e.target.css 不透明度 0.5 } 否则 { 什么都不做 }

然后我相信这会奏效。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:17:00.980

更改您绑定点击事件的选择器应该这样做：

```
$(document).ready(function(){
   $("#opacity_wrapper").click(function ( e ) {
      $( e.target ).css({ opacity: 0.5 });
   });
}); 
```

请注意，您的一个关闭`<div>`s 有问题，这会影响到这一点。`<div class="span12" style="padding-top: 25px;">`正在以开放的方式“关闭”`<div>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:23:38.430

```
$('.well').click(function(event) {
  $(event.target).css('opacity','0.5');  
}); 
```

这将为您完成。这将选择限制为应用了“well”类的 div。单击下一个时，您显然需要清除选择并重置不透明度。

# c# - 获取动态添加的 MenuItem 的文本

> ID：15991816
> 
> 赞同：1
> 
> 时间：2013-04-13T19:13:49.543
> 
> 标签：c#, menustrip

我有一个将标签添加到 MenuStrip 的函数。在 ItemClicked 函数上，我使用了以下代码：

```
MenuItem mi = sender as MenuItem;
string a = mi.Text; 
```

但是，在阅读此内容后，我收到以下错误：

```
Object reference not set to an instance of an object. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:21:32.340

```
 private void menuStrip1_ItemClicked(object sender, ToolStripItemClickedEventArgs e)
        {

         string str=e.ClickedItem.Text;
        } 
```

# php - 获取 ip 位置和操作系统

> ID：15991818
> 
> 赞同：2
> 
> 时间：2013-04-13T19:13:59.283
> 
> 标签：php, html, operating-system, location, ip

我想知道如何获取 ip 位置以及访问者正在运行的操作系统。比如说，我使用的是 Mac，所以如果我访问这个网站，它会说 Mac OS。

所以基本上像**[ipchicken.com](http://ipchicken.com)**这样的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:19:35.697

要获取客户端的 ip，请使用全局[`$_SERVER`](http://www.php.net/manual/en/reserved.variables.server.php)数组：

```
$ip = $_SERVER['REMOTE_ADDR']; 
```

要将 ip 解析为主机名，您可以使用[`gethostbyaddr()`](http://www.php.net/manual/en/function.gethostbyaddr.php)：

```
$hostname = gethostbyaddr($_SERVER['REMOTE_ADDR']); 
```

* * *

对于用户代理标头，它将包含有关客户端正在使用的操作系统和浏览器的信息，首选方法是使用该函数[`get_browser()`](http://www.php.net/manual/en/function.get-browser.php)：

```
$clientInfo = get_browser(null, true);
var_dump($clientInfo); 
```

...什么会给你一个像这样的数组：

```
Array
(
    [browser_name_regex] => ^mozilla/5\.0 (windows; .; windows nt 5\.1; .*rv:.*) gecko/.* firefox/0\.9.*$
    [browser_name_pattern] => Mozilla/5.0 (Windows; ?; Windows NT 5.1; *rv:*) Gecko/* Firefox/0.9*
    [parent] => Firefox 0.9
    [platform] => WinXP
    [browser] => Firefox
    [version] => 0.9
    [majorver] => 0
    [minorver] => 9
    [cssversion] => 2
    [frames] => 1
    [iframes] => 1
    [tables] => 1
    [cookies] => 1
    [backgroundsounds] =>
    [vbscript] =>
    [javascript] => 1
    [javaapplets] => 1
    [activexcontrols] =>
    [cdf] =>
    [aol] =>
    [beta] => 1
    [win16] =>
    [crawler] =>
    [stripper] =>
    [wap] =>
    [netclr] =>
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:21:18.483

The IP of the visitor is available in the `$_SERVER['REMOTE_ADDR']` field, the user agent string is available in the `$_SERVER['HTTP_USER_AGENT']` field.

Please note that both information may or may not be correct, depending on whether the visitor uses an HTTP proxy or modifies the headers sent by the browser.

The `Name Address` can be obtained by a reverse DNS request.

To get information like the visitors' operating system or browser vendor, you can use the `get_browser()` function provided by PHP or a replacement (depending on the environment you run your code in, the `browscap.ini` file required by PHPs `get_browser()` function might be outdated or missing).

# vhdl - 使用 Xilinx ISE 设计套件在 Spartan 6 上生成单端口 ROM

> ID：15991819
> 
> 赞同：1
> 
> 时间：2013-04-13T19:14:05.407
> 
> 标签：vhdl, fpga, xilinx, spartan

我在将单端口 rom 设计到 spartan 6 板上时遇到了一些麻烦。我使用提供的核心生成器来创建块内存，并选择具有 32 位宽度和 256 深度的单端口 rom，其 coe 文件的计数从 0 到 255。我将 rom 作为组件放入我的 vhdl 中，并将 XilinxCoreLib 添加为图书馆。当我尝试生成编程文件时，出现翻译错误：

```
logical block 'rom1' with type 'rom' could not be
resolved. A pin name misspelling can cause this, a missing edif or ngc file,
case mismatch between the block name and the edif or ngc file name, or the
misspelling of a type name. Symbol 'rom' is not supported in target
'spartan6'. 
```

如果有帮助，我目前正在使用 Xilinx ISE 13.1。我觉得这应该很容易做到，但我一直无法找到如何做到这一点。

编辑：谢谢大家，是事物的结合。速度等级错误，并且没有将 ngc 文件的副本添加到我的工作目录中。我将来会使用数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T20:16:38.063

最简单的方法是完全忘记供应商工具并简单地声明一个常量数组！

如果这是在与设计的其余部分分开的包中，几行 printf 或一个简单的脚本可以围绕内容生成 VHDL 样板，这些样板来自您的汇编程序或任何创建实际数据的工具

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T13:08:10.290

有很多因素会导致这个问题，一个是您正在使用为另一个 FPGA 系列生成的块并在 Spartan6 中使用它。另一个是您可能使用旧版本的工具生成了 ROM，并且此后 ROM 的包装器发生了变化。您可以像 Brian 建议的那样生成一个阵列并忘记工具特定的 ROM 类型，或者在您的当前项目设置下重新生成 IP 并查看它是如何进行的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T21:20:08.347

由于您在 ISE 中将 Xilinx 生成的内核添加到您的设计中，因此您需要通过 Project 菜单的“Add Source”添加 VHD 文件和 NGC 文件。

更简单的是，根据您的 ROM 需要多大以及进入其中的数据，甚至无需使用 Xilinx 内核，而是使用纯 VHDL 在您的 VHDL 文件中声明一个常量数组和初始化值。这是一个例子：

```
type array_ROM is array (0 to NUMBER_OF_ROWS-1) of std_logic_vector (ROM_BITWIDTH-1 downto 0);

signal my_ROM : array_ROM
    :=
        (
            x"12345678",
            x"ABCDEF01",
            ...
            x"01010101"
        ); 
```

现在，您不要将省略号 (...) 放入该初始化列表中，只需放入位宽与 ROM_BITWIDTH 匹配的常量行。NUMBER_OF_ROWS 是您在 ROM 中需要的地址位置数。在此示例中，ROM_BITWIDTH 必须设置为 32，因为我在初始化列表中使用了 32 位十六进制常量。作为一个信号，它实际上是可以修改的，所以如果你需要它是常数，只需使用“常数”而不是信号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T07:07:54.273

正如消息所说，我想问题是拼写错误。要获得正确的组件声明/实例化，请在 ISE 的设计窗口中选择您的 rom.xco。然后从进程窗口中选择“查看 vhdl 实例化模板”。使用其中描述的组件声明和实例化。

# php - Symfony 方法在提交操作时没有在 jquery 中被调用

> ID：15991820
> 
> 赞同：0
> 
> 时间：2013-04-13T19:14:06.517
> 
> 标签：php, javascript, jquery, html, symfony

我正在尝试在表单的提交按钮上调用 jquery ajax 函数。我的表格是树枝的形式，我没有提到任何动作，因为我想做一个 ajax 调用。

```
 <label for="email">Email</label>
      <input type="text" name="username" value="" />

      <label for="email">Password</label>
      <input type="password" name="password" value="" />

      <input type="submit" name="action" id="login" value="login" /> 
```

我的 js 看起来像这样：

```
 $("#login").click(function(event) {
        var posting = $.post(http://domain-name/api/login, $('#mainform').serialize(), function(data,status) {
        if(status == 'success'){ 
```

当我单击提交按钮时，它不会重定向到此 url。相反，它需要相对 url 并尝试找出未定义的 app->post('/login') 的路径。

我不明白为什么它不调用 js 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T09:20:55.527

尝试修改提交按钮。而是放：

```
<input type="button" name="action" id="login" value="login" /> 
```

或者使用方法 preventDefault 并且不要将 post 函数保存到变量中，我不是 js 专家，但看起来你正在保存一个函数......并且在 URL 上使用双引号

```
$("#login").click(function(event) {
    event.preventDefault();
    $.post("http://domain-name/api/login", $('#mainform').serialize(), function); 
} 
```

# php - 未找到元素 FF - 在萤火虫中可见错误

> ID：15991821
> 
> 赞同：3
> 
> 时间：2013-04-13T19:14:10.013
> 
> 标签：php, javascript, html, ajax, http

我正在创建一个全球高分表。JavaScript 通过一些 AJAX 函数和 POST 将用户名和分数发送给 PHP。然后 PHP 脚本获取该变量，并将得分值与服务器上的文件进行比较。然后它将新的乐谱放在乐谱表上应该放在的位置，并重写文件。

我昨晚让它工作了，但是现在，当我调用该函数时，它会显示我的代码，并且 firebug 给出错误“未找到元素”。我不确定从那时到现在我做了什么，但我就是想不通这个。

这是我第一次使用 PHP 和 AJAX，所以我不确定错误在哪里或是什么。任何帮助，将不胜感激！

确切的错误：

```
Timestamp: 4/13/2013 1:59:18 PM
Error: no element found
Source File: file:///C:/wamp/www/ajax.php
Line: 84, Column: 3
Source Code:
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:29:57.953

如果我无法帮助您解决此问题，我将删除此答案，但我想这样发布，以便您更好地阅读我的建议。

首先将您的`HandleResponse`功能更改为：

```
function HandleResponse(response)
{
  console.log(response);
  document.getElementById('ResponseDiv').innerHTML = response;
} 
```

并在萤火虫中发布出现在错误上方的结果。

我们在这里所做的是为我们添加一种方法来查看是否有任何数据实际上是从 AJAX 请求返回的。调用`console.log`告诉浏览器将给定的参数打印到控制台（在你的情况下，萤火虫）。

**更新 1**

在您的评论中，您说当您记录`response`. 这意味着您没有从服务器收到任何反馈（至少在数据方面）。

我的下一个建议是您将调用更改`MakeRequest`为以下内容：

```
<input type='button' id="test" onclick='MakeRequest("*");' value='Global Highscore Table'/> 
```

像以前一样，在方法中保留该`console.log`行`HandleResponse`，然后在 firebug 中发布错误上方出现的结果。

在这里，我们设置您`MakeRequest`发出一个传递通配符查询参数的请求。在提出这个建议时，我没有意识到请求的文件需要两个参数，也没有意识到传递通配符会使脚本出错。但是，这仍然是一件好事，因为我们发现了一个新错误，它告诉我们正在接收请求。

**更新 2**

现在，将“ajax.php”文件中的**所有内容**剪切并粘贴到记事本或其他类似的应用程序中。然后，将以下内容设置为“ajax.php”文件的**唯一内容：**

```
<?php echo "Request received and response sent"; ?> 
```

再次，发布`console.log`.

在这里，我们从修复复杂的代码后退了一步，我们将回到基础。在这里，我们要做的就是验证我们是否可以发送请求并接收响应。

如果`"Request received and response sent"`作为请求的响应成功返回，那么我们知道错误出在 ajax.php 中，而不是在请求中。如果不是，我们知道请求存在问题（无论是服务器问题还是请求本身）。如果是后者，ajax.php 仍然可能有问题，但我们必须先修复请求。

**更新 3（最终解决方案）**

发现问题是由于在本地服务器上未正确运行。

# java - Java将键码转换为字符串或字符

> ID：15991822
> 
> 赞同：8
> 
> 时间：2013-04-13T19:14:12.327
> 
> 标签：java, string, keyevent, keycode

我想将 keyevent 键码值转换为字符串或字符值。任何一个都可以。

例如，当我按“SPACE”时，“让我们说”的键码为 20，我想将该值转换为字符或字符串。有没有这样做的标准方法，或者我必须为键盘上的每个键写一堆“if”语句？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-13T19:19:32.963

将其投射到 Char。

```
Char c=(Char)keycode; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-07-24T16:46:42.650

如果 e 是 KeyEvent 的可变参数，则使用

```
 e.getKeyText(e.getKeyCode()) 
```

但最好在 KeyEvent 的静态上下文中使用它

```
KeyEvent.getKeyText(e.getKeyCode()) 
```

它返回一个字符串，但您可以转换为或获取以其他可解析数据类型返回的字符串的值

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-14T16:06:52.550

只需将其转换为一个字符，但不能使用大写 c：

```
char c = (char) 20; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T19:19:05.773

一种方法是**加载 Map 中的所有值，**然后获取每个按下的键的值。就像如果您按下空格键并输入 20，只需从地图中获取与该键关联的值并使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-08T18:00:36.130

另一个类似于 Reujoe 的选项是`getKeyChar()`在您有 KeyEvent 变量时使用。

`e.getKeyChar()`

它将键码的字符表示形式返回为`Char`

# android - 使用 json (android) 保护 http 请求

> ID：15991823
> 
> 赞同：0
> 
> 时间：2013-04-13T19:14:16.923
> 
> 标签：android, mysql, http, phpmyadmin

我正在使用 json 请求登录并显示与用户有关的消息。但是如果我从浏览器发出相同的请求，它仍然可以工作。我正在为我的 App 使用 PHP-MYSQL。我没有任何网站，所以我需要应用程序本身的答案。

我正在使用带有 android 应用程序的 facebook sdk，所以我没有任何密码。我想在调用时保护用户和用户数据配置文件之间的聊天消息。就是这样。

我的问题是：

1.  如何确保仅在应用程序内拨打电话？

2.  当一些人试图在浏览器中复制和粘贴代码时，我如何确保通话安全？

3.10秒后创建的消息有超时时间。所以不能重复使用相同的url和msg。

我有像 http://example.com/login=emailId 这样的 http 调用；

获取消息：http://example.com/getMsgs/user=uiniqueNo；

我在应用程序中使用时提供了上述链接，它工作正常但不安全。请建议我一些文件和流程。我已经检查了这个链接[保护 HTTP 请求不被其他人调用，](https://stackoverflow.com/questions/3068916/protect-http-request-from-being-called-by-others) 但不清楚。请建议我任何具有上述要求的教程。在此先感谢。我非常感谢您的帮助。

```
public class CustomizedListView extends Activity {
    // All static variables
    static final String URL = "http://example.com/getmsgs/userno=123";
    // XML node keys
    static final String KEY_SONG = "song"; // parent node
    static final String KEY_ID = "id";
    static final String KEY_TITLE = "title";
    static final String KEY_ARTIST = "artist";
    static final String KEY_DURATION = "duration";
    static final String KEY_THUMB_URL = "thumb_url";

    ListView list;
    LazyAdapter adapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();

        JSONObject json = JSONfunctions.getJSONfromURL(URL);

        try {
            JSONObject arr2 = json.getJSONObject("feed");
            JSONArray arr = arr2.getJSONArray("entry");

            for (int i = 0; i < arr.length(); i++) {
                JSONObject e1 = arr.getJSONObject(i);

                JSONArray arr3 = e1.getJSONArray("im:image");

                JSONObject arr8 = e1.getJSONObject("im:name");

                JSONObject arr10 = e1.getJSONObject("im:artist");

                    JSONObject e12 = arr3.getJSONObject(0);

            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();

            map.put(KEY_THUMB_URL,  e12.getString("label"));

            map.put(KEY_ARTIST, arr8.getString("label"));
            map.put(KEY_TITLE, arr10.getString("label"));
            // adding HashList to ArrayList
            songsList.add(map);
            }

        } catch (JSONException e) {
            // Log.e("log_tag", "Error parsing data "+e.toString());
            Toast.makeText(getBaseContext(),
                    "Network communication error!", 5).show();
        }

        list=(ListView)findViewById(R.id.list);

        // Getting adapter by passing xml data ArrayList
        adapter=new LazyAdapter(this, songsList);        
        list.setAdapter(adapter);

        // Click event for single list row
        list.setOnItemClickListener(new OnItemClickListener() {

            @SuppressWarnings("unchecked")
            @Override
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {

                HashMap<String, String> o = (HashMap<String, String>) list.getItemAtPosition(position);
                Toast.makeText(CustomizedListView.this, "ID '" + o.get("KEY_TITLE") + "' was clicked.", Toast.LENGTH_SHORT).show(); 

            }
        });     
    }   
} 
```

在上面的代码中，任何人都可以猜到 usersno，但我如何确保应用程序和 php 服务器中没有 123应该深入到用户无法破解的操作系统中，因此我可以解密服务器 php 中的代码，用户将无法随机键入任何内容为 123。

```
<?php

$strno=$_GET['strno'];

if (isset($strno))
{
        $connect=mysql_connect("localhost","test","test") or die ('Connection error!!!');
        mysql_select_db("test") or die ('Database error!!!');

    $query=mysql_query("select sno FROM users  where strno='$strno';");
    while($row = mysql_fetch_assoc($query))

    {
        $jsonoutput='{"json":{
            "msg_sub":"'.$row['msg_sub'].'",
            }}';
    }

}

echo trim($jsonoutput);
mysql_close($connect) or die ('Unable to close connection-error!!!');
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:55:30.260

好吧，除非你使用 https 在你的 api 和你的 js 客户端之间传输数据，否则没有***办法真正完美地保护这个系统。***

这是你做的：

1.  首先在你的数据库端创建一个用户登录系统，用户名/密码表
2.  接下来创建一个表单供用户登录
3.  每当用户尝试访问 api 时，您的服务器将检查它是否为该用户设置了会话，他们要么必须登录，要么传递现有的会话 ID，这将授予他们访问权限
4.  接下来是购买 https 证书，以确保您的数据安全传输
5.  现在对 api 的每个请求，服务器总是检查他们的用户是否发送了有效的 SESSION ID，如果没有，它会简单地将他们重定向到登录页面

这几乎是您可以为系统添加安全性的唯一方法。最重要的部分是 https 证书。没有这个，无论用户/密码有多好，它仍然可能受到损害。

**编辑**

这是一些示例代码，可帮助您入门。此代码未经测试，只是为了给您一个想法。[您可以在此处](http://www.tizag.com/phpT/phpsessions.php)阅读有关会话的所有信息。

```
 <?php

    /*
        like I said earlier, you need to have a "login" screen on your app
        - when the user clicks login it POSTS the request back here
    */

    if(isset($_SESSION['username'])){
        //the username is in the session so it means
        //theyre already logged in
        //not sure what strno is doing but you can do that here

        $strno=$_GET['strno'];

        if (isset($strno))
        {
                $connect=mysql_connect("localhost","test","test") or die ('Connection error!!!');
                mysql_select_db("test") or die ('Database error!!!');

            $query=mysql_query("select sno FROM users  where strno='$strno';");
            while($row = mysql_fetch_assoc($query))

            {
                $jsonoutput='{"json":{
                    "msg_sub":"'.$row['msg_sub'].'",
                    }}';
            }

        }

        echo trim($jsonoutput);
        mysql_close($connect) or die ('Unable to close connection-error!!!');

    }else if(isset($_POST) && isset($_POST['username']) && isset($_POST['password'])){
        //log them in
        //query ur database to see if the user exists
        //if you get a row back then store that row in the session like
        //note: this is just example code

        if(/*user is in database, get the row....*/){
            session_start();
            $_SESSION['username'] = $row['username'];
        }
    }else{
        die("Access Denied");
    }

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:32:25.977

有两种选择可以实现这一目标。首先是使用`GET`方法，您可以在您正在寻找的服务器端创建一个特定的参数。例如，从您正在发送的 android 应用程序中`http://www.my-backend.com/api/test_api?my_secure_code=thisIsTestString`，服务器返回正确的响应，但如果您发送`http://www.my-backend.com/api/test_api?my_secure_code=thatsAnotherString`，则您在请求中搜索的参数值不是`thisIsTestString`，因此您应该返回错误消息。

在我看来，实现这一点的第二种方法更好，因为在我看来 using`GET`并不安全。它比 using 更容易`POST`。在这种情况下，您必须`my_secure_param`作为 post 参数发送，您可以通过在浏览器中输入来使用它（仍然有一种方法可以通过浏览器安装 post 请求插件来实现此目的）。所以我认为这里最好的解决方案是`POST`在连接到后端时使用请求，使用`MD5`or发送一些散列字符串`SHA1`（至少这是我们保护与服务器的连接的方式+一些额外的东西）。

**编辑：**关于评论，你可以通过在你的服务器上为特定用户创建某种标识来实现这一点，而不是信任 facebook。这只是一个建议...例如，您可以从 facebook 获取 id 用户并创建一个唯一的哈希 id，您将其存储在您的服务器中，并且每次您从应用程序发送请求时，您都必须发送该唯一 id，这将在应用程序中创建的方式与在服务器上创建它的方式相同。如果匹配，则每次有人发送消息时，您都必须检查该哈希，如果不只是返回错误..而且不要忘记，使用`POST`requests 而不是`GET`！如果不更改服务器后端中的一些代码，就无法实现这样的目标。

# android - Android 免触控手势识别应用错误

> ID：15991830
> 
> 赞同：0
> 
> 时间：2013-04-13T19:14:40.897
> 
> 标签：android, gesture-recognition

我们正在构建一个关于无触摸手势识别的 android 应用程序。

** *代码摘要：

> 通过代码，我们试图通过手动滑动来更改文本字段中的文本。当用户从右向左滑动手时，文本应变为 Left ....等等。当我们运行应用程序时出现以下错误，请帮助我们解决它。*

**

我已经阅读了许多与我的错误相关的类似错误，但没有一个可以解决我的错误。

请帮忙

我们收到以下错误：

```
04-14 00:05:39.393: E/AndroidRuntime(333): FATAL EXCEPTION: main   04-14 00:05:39.393: E/AndroidRuntime(333): java.lang.RuntimeException: Unable to instantiate activity  ComponentInfo{com.grex/com.grex.MainActivity}: java.lang.ClassNotFoundException: com.grex.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.grex-1.apk]
04-14 00:05:39.393: E/AndroidRuntime(333): at  android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.app.ActivityThread.access$1500(ActivityThread.java:117) 
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.os.Handler.dispatchMessage(Handler.java:99) 
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.os.Looper.loop(Looper.java:123)
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.app.ActivityThread.main(ActivityThread.java:3683) 
04-14 00:05:39.393: E/AndroidRuntime(333):  at java.lang.reflect.Method.invokeNative(Native Method) 
04-14 00:05:39.393: E/AndroidRuntime(333):  at java.lang.reflect.Method.invoke(Method.java:507)
04-14 00:05:39.393: E/AndroidRuntime(333):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-14 00:05:39.393: E/AndroidRuntime(333):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-14 00:05:39.393: E/AndroidRuntime(333):  at dalvik.system.NativeStart.main(Native Method) 
04-14 00:05:39.393: E/AndroidRuntime(333): Caused by: java.lang.ClassNotFoundException: com.grex.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.grex-1.apk]
04-14 00:05:39.393: E/AndroidRuntime(333):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
04-14 00:05:39.393: E/AndroidRuntime(333):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
04-14 00:05:39.393: E/AndroidRuntime(333):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
04-14 00:05:39.393: E/AndroidRuntime(333):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561) 
```

任何人都可以通过 vch 提出我们可以解决此问题的方法吗

主要活动 ：

```
package com.grex;

//import com.grex.R; import com.nanocritical.nanogest.Nanogest;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageView;
import com.nanocritical.nanogest.Nanogest;
import com.nanocritical.nanogest.Nanogest.Gesture;
import com.nanocritical.nanogest.Nanogest;

public class MainActivity extends Activity implements Nanogest.GestureListener {
    private Nanogest ngest;
    EditText et= (EditText) findViewById(R.id.editText1);
    Button r= (Button) findViewById(R.id.BtnResume);
    Button p= (Button) findViewById(R.id.BtnPause);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        try{
        super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            ngest = new Nanogest(this, this, null);
            et.getText().toString();
        } catch(Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public void onResume() {
        try{
            super.onResume();
            ngest.start();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    public void onPause() {
        try{
            super.onPause();
            ngest.stop();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    public void onGesture(Nanogest.Gesture gesture, double timestamp) {
        try{
            switch (gesture) {
            case SWIPE_LEFT:
                onLeft();
                break;
            case SWIPE_RIGHT:
                onRight();
                break;
            case SWIPE_UP:
                onUp();
                break;
            case SWIPE_DOWN:
                onDown();
                break;
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void onDown() {
        // TODO Auto-generated method stub
        try{
            et.setText(R.string.down);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void onUp() {
        // TODO Auto-generated method stub
        try{
            et.setText(R.string.up);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void onRight() {
        // TODO Auto-generated method stub
        try{
            et.setText(R.string.right);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void onLeft() {
        // TODO Auto-generated method stub
        try{
            et.setText(R.string.left);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

清单文件：

> ```
> <uses-sdk
>     android:minSdkVersion="10"
>     android:targetSdkVersion="17" />
> <uses-permission android:name="android.permission.CAMERA"/>
> 
> <application
>     android:allowBackup="true"
>     android:icon="@drawable/ic_launcher"
>     android:label="@string/app_name"
>     android:theme="@style/AppTheme" android:debuggable="true">
>     <activity
>         android:name="com.grex.MainActivity"
>         android:label="@string/app_name" >
>         <intent-filter>
>             <action android:name="android.intent.action.MAIN" />
> 
>             <category android:name="android.intent.category.LAUNCHER" />
>         </intent-filter>
>     </activity>
> </application> 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:08:39.413

这些行：

```
EditText et= (EditText) findViewById(R.id.editText1);
Button r= (Button) findViewById(R.id.BtnResume);
Button p= (Button) findViewById(R.id.BtnPause); 
```

应该分为两个阶段：

1.  声明 - 与现在相同的地方：

    ```
    EditText et = null;
    Button   r  = null;
    Button   p  = null; 
    ```

2.  实例化 - in `onCreate()`, after`setContentView`

    ```
    et = (EditText) findViewById(R.id.editText1);
    r  = (Button) findViewById(R.id.BtnResume);
    p  = (Button) findViewById(R.id.BtnPause); 
    ```

# c# - 无法从文本框中传递变量

> ID：15991831
> 
> 赞同：1
> 
> 时间：2013-04-13T19:14:41.487
> 
> 标签：c#, email, smtp, gmail

在线上

```
const string subject = "hello" + textBox1.Text; 
```

它不打印 textBox1.Text 的值，但我打印单词“textBox1.Text”。我该如何解决？

```
var fromAddress = new MailAddress("samuimark@gmail.com", "samui mail");
var toAddress = new MailAddress("teeramail@gmail.com", "To Name");
const string fromPassword = "t429";
const string subject = "hello" + textBox1.Text  ;
const string body = "you have a mail";

var smtp = new SmtpClient
{
    Host = "smtp.gmail.com",
    Port = 587,
    EnableSsl = true,
    DeliveryMethod = SmtpDeliveryMethod.Network,
    UseDefaultCredentials = false,
    Credentials = new NetworkCredential(fromAddress.Address, fromPassword)
};
using (var message = new MailMessage(fromAddress, toAddress)
{
    Subject = subject,
    Body = body
})
{
    smtp.Send(message);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T19:21:30.437

代替

```
const string subject = "hello" + textBox1.Text  ; 
```

采用

```
string subject = "hello" + textBox1.Text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T11:03:56.710

textBox1.Text 不是常量表达式。将其值赋值给字符串而不是 const 字符串

```
string subject = "hello" + textBox1.Text; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-18T18:45:14.990

安装使用

```
Subject = subject,
Body = body 
```

我建议你也改变它

```
Subject = subject.Text,
Body = body.Text 
```

只需将“subject.Text”和“body.Text”更改为您的文本框名称但您必须保留 .Text

# javascript - 根据内容位置合并两个字典

> ID：15991833
> 
> 赞同：0
> 
> 时间：2013-04-13T19:14:47.097
> 
> 标签：javascript

我有两个字典，它们记录了同一事件并采取了不同的步骤。

```
A: [ { tap red }, { tap blue }, { tap green }, { tap commit } ]

B: [ { tap yellow }, { tap blue }, { tap commit } ] 
```

合并后应如下所示：

```
[ { tap yellow }, { tap red }, { tap blue }, { tap green }, { tap commit } ] 
```

黄色和红色并在蓝色之前在 A 和 B 中完成，因此它应该位于 before `{ tap blue }`、`{ tap green }`is before`{ tap commit }`和`{ tap commit }`始终位于末尾。

在 JavaScript 中实现这一点的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:23:44.993

具体取决于您希望它在各种退化情况下的行为方式，但从广义上讲：（粗略的伪javascript）

```
var position_B = 0
foreach( A as position_A ) {
    var found_B = B.indexOf( A[position_A], position_B );
    if( found_B !== -1 ) {
        // todo: copy B[position_B] to B[found_B] (inclusive) into Result
        position_B = found_B + 1;
    } else {
        // todo: copy A[position_A] into Result
    }
}
// todo: copy B[position_B] to B[end] (inclusive) into Result 
```

它遍历 A 的所有项目，并且对于每个项目，检查它是否在 B 中。如果是，则复制 B 的最后一个匹配项和当前匹配项之间的所有项目，否则它只复制 A。然后它将所有内容包含在B 到目前为止尚未包括在最后。

# vb.net - 我可以控制 .NET 编译器自动转换为表达式的内容吗

> ID：15991843
> 
> 赞同：1
> 
> 时间：2013-04-13T19:16:14.027
> 
> 标签：vb.net, linq, compiler-construction

VB 编译器自动将 lambda 转换为它们的`LambdaExpression`等价物（例如 in `Dim a As LambdaExpression = Function(x) x.Length`）。直到最近，我还认为该功能*仅*适用于 lambda，但后来我发现尝试将方法调用的*结果*作为参数传递给方法时出现相同的行为。编译器将我的调用转换为 a`MethodCallExpression`而不是调用！

```
Dim myQuery = From x In DataSource.Items
              Group By x.Key Into g = Group
              Select New With {
                  .Key = Key,
                  .RedItems = g.Sum(ItemsOfColor(Colors.Red))
              }

Private Function ItemsOfColor(color As Integer) As Expression(Of Func(Of Item, Integer))
    Return Function(item) If(item.Color = color, 1, 0)
End Function 
```

`RedItems`包含一个作为参数`MethodCallExpression`调用`ItemsOfColor`的，而不是我预期的调用*结果*。`Colors.Red``LambdaExpression`*`ItemsOfColor`*

 *问题：为什么编译器认为这是我想要的行为，有没有办法关闭它？

注意：这是系列中的第三个问题，它慢慢地帮助我了解 LINQ 是如何编译的及其副作用。[第一](https://stackoverflow.com/q/11679553/794234)部分和[第二](https://stackoverflow.com/q/15949279/794234)部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T19:55:07.003

我想我终于明白了这个问题......所以就这样吧。查询表达式语法（如上）使它*看起来*是`.RedItems = g.Sum(ItemsOfColor(Colors.Red))`一个普通的方法调用，但**它不是**. 该“调用”实际上位于`Select`上一行语句的 lambda 主体内。用 lambda 语法重写，这将是：

```
.Select(Function(x) New With {
    .Key = Key,
    .RedItems = g.Sum(ItemsOfColor(Colors.Red))
}) 
```

这清楚地表明我们实际上已经**在**lambda 中了。负责将 lambda 参数转换`Select`为表达式树的编译步骤会看到对的调用`ItemsOfColor`并创建 a `MethodCallExpression`，正如我们所期望的那样！

简而言之，将方法调用转换为表达式没有特殊规则，它实际上是一个 lambda，而我原来的问题在当前版本的 EF/LINQ 中是不可能的。也许有一天 MS 会扩展这两者中的一个来识别 a `MethodCallExpression`，它会产生一个表达式并进行调用（从而使这种类型的重构成为可能）。*

# javascript - 如何确定鼠标指针是否越过javascript中的元素

> ID：15991845
> 
> 赞同：0
> 
> 时间：2013-04-13T19:16:24.057
> 
> 标签：javascript, mouseevent

可以为元素定义鼠标悬停事件，以便您知道鼠标指针当前位于该元素的某个位置。如何确定鼠标指针是否离开该元素区域？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T19:18:06.953

[Mouseover](https://developer.mozilla.org/en-US/docs/DOM/Mozilla_event_reference/mouseover)和[mouseout](https://developer.mozilla.org/en-US/docs/DOM/Mozilla_event_reference/mouseout)以及 jQuery 让事情变得简单：

```
$("img").mouseover(function(){
   alert('your message');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T19:50:49.800

考虑到你可以使用`jQuery`. `mouseover`and事件`mouseout`可以工作，但我建议您改用[`mouseenter`](http://api.jquery.com/mouseenter/)and[`mouseleave`](http://api.jquery.com/mouseleave/)事件，因为如果您有子元素， `mouseover`and`mouseout`事件**可能会触发多次。**`element`

```
$("#my-element")
    .mousenter(function(){
        console.log('enter');
    })
    .mouseleave(function(){
        console.log('leave');
    }); 
```

但是，如果您不想使用`jQuery`，可以在 vanilla JS 中使用。

```
document.getElementById('my-element').addEventListener('mouseover' function (e) {
    console.log('over');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T19:24:25.443

use onmousemove, onmouseover and onmouseout events...
onmousemove - The event occurs when the pointer is moving while it is over an element
onmouseover - The event occurs when the pointer is moved onto an element
onmouseout - The event occurs when a user moves the mouse pointer out of an element

# apache - Apache - 如何对 .htaccess 文件中的特定位置使用身份验证？

> ID：15991846
> 
> 赞同：0
> 
> 时间：2013-04-13T19:16:25.623
> 
> 标签：apache, .htaccess, authentication

我有一个“虚拟”URL `www.abc.com/admin`，我想用一个简单的 htpasswd 来保护它。该目录在物理上不存在。页面的其余部分应该可供所有人访问。

我知道真实现有目录的解决方案，并找到了解决方案`<FoldersMatch>`or`<DirectoryMatch>`但不幸的是，这不适用于我的虚拟主机。只会`<FilesMatch>`。

还有其他方法可以让它工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T21:12:21.520

您可以使用该`Satisfy Any`语句来检查请求*是否不是*针对`/admin`或是否存在有效用户：

```
# sets ENV if request is for /admin
SetEnvIf Request_URI ^/admin no_require_auth=true

# Auth stuff
AuthUserFile /var/www/htpasswd
AuthName "Password Protected"
AuthType Basic

# Setup a deny/allow
Order Deny,Allow
# Deny from everyone
Deny from all
# except if either of these are satisfied
Satisfy any
# 1\. a valid authenticated user
Require valid-user
# or 2\. the "no_require_auth" var is set
Allow from env=no_require_auth 
```

# c# - 主线程终止时 SynchronizationContext 会发生什么？

> ID：15991847
> 
> 赞同：3
> 
> 时间：2013-04-13T19:16:43.230
> 
> 标签：c#, multithreading, synchronizationcontext

我有两个线程，主线程和我创建的另一个线程来做一些工作。我不明白当我从另一个线程调用 originalContext.Post（主线程的同步上下文）时会发生什么，其中一些 UI 元素已更新，而主线程已经终止？这安全吗？为什么？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T22:34:51.847

这当然不会有很好的结局。这取决于实际的同步提供程序，不止一个。尝试将重点放在常见的 WindowsFormsSynchronizationContext 和 WpfSynchronizationContext 上。两者都会从队列中清除任何待处理的帖子，它们会消失得无影无踪。如果您继续发布，则 Winforms 将抛出 InvalidOperationException。Wpf 比较复杂，它可以设置 DispatcherOperation.Status 字段来表示它没有工作。但据我所知，上下文代码没有观察到这个字段，所以它应该默默地落在位桶中。

显然，您永远不希望这种情况发生。简单的解决方法是 Thread.IsBackground = true 让 CLR 清理混乱，通常不希望让程序在没有 UI 的情况下继续。

# scala - 如何发布具有只读私有凭据的构建时访问权限的 SBT 项目？

> ID：15991849
> 
> 赞同：2
> 
> 时间：2013-04-13T19:16:53.230
> 
> 标签：scala, maven, jenkins, sbt, cloudbees

我想使用 CloudBees Jenkins 服务来构建基于 SBT 的 scala 项目的夜间快照，并将它们发布到 Sonatype OSS Maven 存储库。SBT 有 [两种方式](http://www.scala-sbt.org/release/docs/Detailed-Topics/Publishing.html#credentials)为构建提供发布凭证；一个在 .sbt 文件中内嵌凭据（未加密，natch），另一个使用外部属性文件的硬编码路径（遗憾的是，仍然未加密）。

CloudBees 有一种提供配置文件来构建代理的[机制](http://wiki.cloudbees.com/bin/view/DEV/Sharing+Files+with+Build+Executors)，但我不想在我的 中硬编码此位置的路径`build.sbt`，也找不到任何方法告诉 SBT`.sbt`从命令行读取文件。我最接近的方法是设置`sbt.global.base` [系统属性](http://www.scala-sbt.org/release/docs/Detailed-Topics/Command-Line-Reference.html#command-line-options)，但不幸的是这失败了，因为配置文件的位置是只读的，而 SBT 使用这个位置来编译它的类文件。

Damien Lecan通过运行一个预构建脚本将一组文件复制到构建执行程序的目录中[想出了一个巧妙的方法来解决这个问题。](http://blog.dlecan.com/configure-sbt-credentials-on-cloudbees-to-publish-artifacts/)我发现这个解决方案可以接受但令人反感，因为它使构建依赖于临时状态并增加了另一个潜在的故障点。`.sbt``$HOME/.sbt`

如何发布具有只读私有凭据的构建时访问权限的 SBT 项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:16:53.230

SBT 似乎没有任何方法可以将任意 .sbt 文件添加到构建中。但是，该 [`set`命令](http://www.scala-sbt.org/release/docs/Detailed-Topics/Command-Line-Reference.html#commands-for-managing-the-build-definition)允许用户在构建时修改设置，并且该命令可以像任何其他命令一样在命令行上使用。

这可以与`Credentials`对象可以接受`File`引用的事实相结合，以提供用于从私有挂载加载安全凭证的外部文件。

在 CloudBees 私有 WebDAV 存储库中，将凭证属性文件添加到您的首选位置（例如`/private/sbt/.credentials`）。在您的 Jenkins 作业配置中，将“使用 sbt 构建”部分中的“操作”字段设置为如下所示：

`'set credentials += Credentials(file("/private/myproject/sbt/.credentials"))' publish`

在我的构建中，我实际上是这样做`clean update "+ test" "+ publish"`的，以确保一个干净的环境，并确保所有交叉编译的构建在它们中的任何一个被传输到存储库之前都通过了它们的测试。

# assembly - 我正在尝试从 8086 程序集中的数组中输出一个字符串

> ID：15991852
> 
> 赞同：1
> 
> 时间：2013-04-13T19:16:57.280
> 
> 标签：assembly, x86, dos, x86-16

```
BITS 16
ORG 0x0100

SECTION .text
MAIN:

      mov DI,array
      call GetString
      call Putln
      call PutString
      call Putln
      mov SI,array
      ;jmp Next

;Next:
      mov AX,4C00H
      ;mov AL,00H
      int 21H

%INCLUDE 'STDIO.ASM'

SECTION .data
mesg db  'I','h','a','t','e','a','s','s','e','m','b','l','y' ;

SECTION .bss
array resb 256  ;reserve 256 bytes of space

Putch:                   ;outputs character in DL
     push DI
     mov AH,02H
     int 21H
     pop DI

     ret

Getch:                   ;inputs a character into AL
     push DI
    ; mov BH,AH
     mov AH,08H
     int 21H
    ; mov AH,BH
     mov DL,AL
     pop DI
     ret

Putln:                 ;prints out a new line
    mov AH,02H
    mov DL,CR
    int 21H
    mov DL,LF
    int 21H
    ret

GetString:
        call Getch
        cmp DL,0DH
        je End
        call Putch
        stosb
        jmp GetString

End:
  mov AL,00H
  stosb
  ret

PutString:
       cld
       lodsb
       cmp AL,00H
       jz End1
       mov DL,AL
       call Putch
       jmp PutString

End1:
    ret

SECTION .data
;mesg db  'I',' ','h','a','t','e',' ','a','s','s','e','m','b','l','y' ;
CR  equ  0AH
LF  equ  0AH 
```

我试图从 8086 程序集中的数组中输出一个字符串，但是当我运行它时，即使我可以输入字符，当我按 Enter 时它也会给我符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-25T14:15:57.703

我认为您的数据段寄存器可能设置不正确。当您在实模式下操作时，最好使用以下命令启动您的程序

```
mov ax,.data    ; The way this is done can vary between assemblers
mov ds,ax 
```

另外，据我所知，DOS 调用不是使用以零结尾的字符串，而是使用以“$”结尾的字符串，所以原因可能是您没有声明`mesg`如下：

```
mesg db 'I love assembly!$' 
```

（实际上，您似乎没有以任何方式终止字符串）

# hadoop - 如何在hadoop的map函数中选择合适的值类型？

> ID：15991855
> 
> 赞同：0
> 
> 时间：2013-04-13T19:17:03.683
> 
> 标签：hadoop, mapreduce

我正在使用一个价值很大的程序。每个值由 id 数字组成（以逗号分隔的整数）：

值1：1,207,688,4401,5432,40000,872111100

值2：65,876,992,10002,9843221

我将值存储为文本，但它为每个字符获取 1 个字节。如果 id 中的位数变大，它会占用很多空间。我将值存储为文本类型吗？哪种格式最适合存储它？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:39:22.730

如果内存效率是一个真正的问题，并且您知道这些 ID 的长度永远不会超过`Long.MAX_VALUE`，我建议使用`LongWritable`.

相反，如果您知道它们往往足够长，以至于每个字符的字节值比以数字形式存储的内存效率更高，那么`Text`就非常合适。

在大多数情况下，考虑到它无论如何都会被写到文件中，不值得担心太多 - 通常只有`long`在使用它执行某种形式的计算时才值得转换为，否则你也可以坚持`Text`避免在初始解析之上的转换开销。

# categories - 是否可以在不上传应用的情况下创建 Facebook 应用页面？

> ID：15991857
> 
> 赞同：1
> 
> 时间：2013-04-13T19:17:14.657
> 
> 标签：categories, facebook-page

我正在制作一款我们计划在不到 3 个月内上传到 Facebook 的游戏。但是，我们想在上传之前制作一个 Facebook 页面来进行宣传。我不确定我们是否应该将其归类为游戏/玩具页面或应用程序页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:18:34.693

是的，应用页面只是让您拥有 API 的代码。您可以稍后更改类别。

# ruby - Ruby regex gsub 文本文件中的一行

> ID：15991858
> 
> 赞同：3
> 
> 时间：2013-04-13T19:17:29.277
> 
> 标签：ruby, regex, gsub

例如，我需要匹配输入的文本文件字符串中的一行，并用一个字符包装捕获的行。

例如想象一个这样的文本文件：

```
test
foo
test
bar 
```

我想使用 gsub 来输出：

```
XtestX
XfooX
XtestX
XbarX 
```

我在匹配一条线时遇到了麻烦。我尝试使用以 ^ 开头并以 $ 结尾的正则表达式，但它似乎不起作用。有任何想法吗？

我有一个文本文件，其中包含以下内容：

```
test
foo
test
bag 
```

文本文件正在作为命令行参数读入。

所以我得到了

```
string = IO.read(ARGV[0])
string = string.gsub(/^(test)$/,'X\1X')

puts string 
```

它输出与文本文件中完全相同的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T19:29:43.970

如果你想匹配*每一*行，那么

```
gsub(/^.*$/, 'X\&X') 
```

成功了。如果您只想匹配某些行，请替换`.*`为您需要的任何内容。

**更新：**

用我的替换你`gsub`的：

```
string = IO.read(ARGV[0])
string = string.gsub(/^.*$/, 'X\&X')
puts string 
```

我得到：

```
$ gsub.rb 测试文件
XtestX
XfooX
XtestX
XbarX

```

**更新 2：**

根据@CodeGnome，您可以尝试添加`chomp`：

```
IO.readlines(ARGV[0]).each do |line|
  puts "X#{line.chomp}X"
end 
```

这对我来说同样有效。我对正则表达式的理解是`^`，`$`没有必要进行咀嚼，但也许我错了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-20T10:00:02.150

您可以像这样在一行中执行此操作：

```
IO.write(filepath, File.open(filepath) {|f| f.read.gsub(//<appId>\d+<\/appId>/, "<appId>42</appId>"/)}) 
```

`IO.write`默认情况下截断给定文件，因此如果您先阅读文本，执行正则表达式`String.gsub`并使用块模式返回结果字符串`File.open`，它将一举替换文件的内容。

我喜欢这样的阅读方式，但它当然也可以写成多行：

```
IO.write(filepath, File.open(filepath) do |f|
    f.read.gsub(//<appId>\d+<\/appId>/, "<appId>42</appId>"/)
  end
) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T19:23:03.970

If your file is `input.txt`, I'd do as following

```
File.open("input.txt") do |file|
  file.lines.each do |line|
    puts line.gsub(/^(.*)$/, 'X\1X')
  end
end 
```

*   `(.*)` allows to capture any characters and makes it a variable Regexp
*   `\1` in the string replacement is that captured group

If you prefer to do it in one line on the whole content, you can do it as following

```
 File.read("input.txt").gsub(/^(.*)$/, 'X\1X') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T19:21:12.757

`string.gsub(/^(matchline)$/, 'X\1X')` Uses a backreference (\1) to get the first capture group of the regex, and surround it with X

Example:

```
string = "test\nfoo\ntest\nbar"
string.gsub!(/^test$/, 'X\&X')
p string
=> "XtestX\nfoo\nXtestX\nbar" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-13T19:54:07.813

## Chomp 行结尾

您的行可能有换行符。您需要以一种或另一种方式处理此问题。例如，这对我来说很好：

```
$ ruby -ne 'puts "X#{$_.chomp}X"' /tmp/corpus
XtestX
XfooX
XtestX
XbarX 
```

# ios - 更新滑块值

> ID：15991863
> 
> 赞同：0
> 
> 时间：2013-04-13T19:17:57.333
> 
> 标签：ios

我有 2 个 ViewController，ViewController_A 和 ViewController_B。ViewController_A 有一个带有 doSlider 方法的滑块，如下所示。

```
- (void)doSlider:(float)value{
  [viewController_B getValue:[slider_1 value]];
} 
```

ViewController_B 有一个 getValue 方法，如下所示。

```
- (void)getValue:(float)value{
  width = value;
  NSLog(@"getValue %f", width);
} 
```

当我在 ViewController_A 中拖动滑块时，ViewController_B 将打印出宽度值。但它似乎只在 getValue 方法中可用。我可以将宽度值传递给 ViewController_B 中的其他方法，例如 touchesMoved。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:00:52.167

是的。获得滑块值后，`[slider_1 value]`您可以随心所欲地使用它。当您将值传递给`getValue:`并分配给`width`您时，您可以随意使用`width`。

# javascript - 如何将 span 元素添加到 img，然后用链接包装所有内容？

> ID：15991868
> 
> 赞同：1
> 
> 时间：2013-04-13T19:18:09.867
> 
> 标签：javascript, jquery, html

在我的 HTML 源代码中，我只有：

```
<img src="..."/> 
```

现在我想用 jQuery 添加一个 span 以获得`<img src="..."/><span>My span</span>`，然后使用`.wrap()`它来将它全部包裹在一个链接周围，最后得到这样的东西：

```
<a href="#"><img src="..."/><span>My span</span></a> 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T19:20:25.043

怎么样

```
$('img').wrap('<a href="#">').after('<span>My span</span>'); 
```

[http://jsfiddle.net/Ykdgd/](http://jsfiddle.net/Ykdgd/)

# javascript - Ember.js - 如何从控制器触发视图方法？

> ID：15991871
> 
> 赞同：23
> 
> 时间：2013-04-13T19:18:34.857
> 
> 标签：javascript, ember.js

我正在尝试从控制器调用视图方法，但不知道该怎么做。从视图中我可以轻松调用控制器方法，例如`this.get('controller').send('method');`

**如何从控制器做类似的事情`this.get('view').send('method');`？**

*为了让您更好地了解我正在尝试做的事情。*

我有应用程序控制器`Ember.Controller.extend({})`我有应用程序视图`Ember.View.extend({})`和应用程序模板。

在应用程序模板中是登录表单，当用户提交它时执行控制器方法。在此方法中，如果登录凭据不正确，我需要调用`jQueryUI`在登录表单上执行方法的视图方法（准确地说是摇动方法并显示一些文本）。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-04-13T23:09:42.640

这听起来对`Ember.Evented`. 通过使用事件订阅和调度，您可以避免耦合视图和控制器。

简单地混合`Ember.Evented`：

```
Controller = Ember.Controller.extend(Ember.Evented) 
```

现在，您可以在控制器上调用`on`和`trigger`方法，订阅事件，然后启动事件。因此，在您看来，您可能会这样做：

```
didInsertElement: function () {
    this.get('controller').on('loginDidFail', this, this.loginFail);
} 
```

然后在您的控制器调用`this.trigger('loginDidFail')`中启动您的`loginFail`视图方法。

请记住在视图被关闭后删除处理程序......请参阅下面的答案。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-02-20T22:43:10.820

只是想回答这个问题，以解决在清除视图时（当路由更改时）正确删除侦听器的问题。也没有必要使用 jquery 代理，因为 on/off 方法支持目标，这很好，因为取消订阅代理肯定更复杂。修改 Christopher 提供的内容：

```
didInsertElement: function()
{
  this.get('controller').on('loginDidFail', this, this.loginFail);
},

willClearRender: function()
{
  this.get('controller').off('loginDidFail', this, this.loginFail);
} 
```

在不删除订阅的情况下，对登录路由的任何后续访问（不重新加载页面）都会添加额外的监听器；即内存泄漏、错误和意外行为。

# ios - 底部的圆角 CoreGraphics iOS

> ID：15991872
> 
> 赞同：2
> 
> 时间：2013-04-13T19:19:02.740
> 
> 标签：ios, cocoa-touch, core-graphics

画画

*   底部，左侧和右侧的边框。
*   底部圆角
*   剪辑到边框
*   用可能在 .xib 文件中设置的实际颜色填充颜色，但在下面的代码中，我将颜色设置为清除颜色。

对于上述内容和下面列出的代码，我得到以下输出。

![在此处输入图像描述](https://i.stack.imgur.com/vzFLf.png)

可以在图像中找到所需输出的粗略概念，如下所示。![在此处输入图像描述](https://i.stack.imgur.com/DkZir.png)

```
-(id) initWithCoder:(NSCoder *)aDecoder{
    self=[super initWithCoder:aDecoder];
    if(self){
        self.clipsToBounds=YES;
        self.backgroundColor=[UIColor clearColor];
    }
    return self;
}

- (void)drawRect:(CGRect)rect
{
    // Drawing code

    CGFloat margin=2.0;
    CGRect outerRect=CGRectInset(rect, margin, margin);
    CGMutablePathRef path=createRoundedRectForRect(outerRect, 10.0);

    CGFloat margin1=1.0;
    CGRect innerRect=CGRectInset(outerRect, margin1, margin1);
    CGMutablePathRef innerPath=createRoundedRectForRect(innerRect, 5.0);
    CGContextRef context=UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);

    CGContextAddPath(context, path);
    CGContextAddPath(context, innerPath);
    CGContextClip(context);

    CGContextSetFillColorWithColor(context, [UIColor blueColor].CGColor
                                    );
    CGContextStrokeRect(context, rect);

    CGContextSetFillColorWithColor(context, [UIColor redColor].CGColor
                                   );
    CGContextFillRect(context, innerRect);

    CGContextRestoreGState(context);
}

CGMutablePathRef createRoundedRectForRect (CGRect rect, CGFloat radius){
    CGMutablePathRef path=CGPathCreateMutable();
    CGPathMoveToPoint(path, NULL, CGRectGetMaxX(rect), CGRectGetMinY(rect));

    CGPathAddArcToPoint(path, NULL, CGRectGetMaxX(rect), CGRectGetMaxY(rect), CGRectGetMinX(rect), CGRectGetMaxY(rect), radius);

    CGPathAddArcToPoint(path, NULL, CGRectGetMinX(rect), CGRectGetMaxY(rect), CGRectGetMinX(rect), CGRectGetMinY(rect), radius);

    CGPathAddLineToPoint(path, NULL, CGRectGetMinX(rect),CGRectGetMinY(rect));

    return path;
} 
```

**第 2 部分，更改**

以下这些更改为我提供了以下输出，其中“添加”按钮仍然重叠并且未剪裁到边框。

输出几乎是预期的，如下图所示。

![在此处输入图像描述](https://i.stack.imgur.com/PdEHS.png)

```
- (void)drawRect:(CGRect)rect
{
    CGSize radii=CGSizeMake(10.0, 10.0);
    UIBezierPath *path=[UIBezierPath bezierPathWithRoundedRect:rect byRoundingCorners:UIRectCornerBottomLeft|UIRectCornerBottomRight cornerRadii:radii];
    [[UIColor blackColor] setFill];
    [path fill];

    CGFloat margin=4.0;
    CGRect innerRect=CGRectMake(rect.origin.x+margin, 0, rect.size.width-(2*margin), rect.size.height-margin);

    //Scaling InnerRadii
    CGSize radii2=CGSizeMake(radii.width-margin, radii.height-margin);
    UIBezierPath *innerPath=[UIBezierPath bezierPathWithRoundedRect:innerRect byRoundingCorners:UIRectCornerBottomRight|UIRectCornerBottomLeft cornerRadii:radii2];

    [[UIColor redColor] setFill];
    [innerPath fill];

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T22:01:53.290

这是我将如何做到的。我会创建一个底角圆角的外部矩形。然后，我会复制这个矩形并改变它的尺寸，让它稍微小一点，并将它覆盖在第一个矩形的顶部。

```
- (void) drawRect:(CGRect)rect
{
    UIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:rect
       byRoundingCorners:UIRectCornerBottomLeft | UIRectCornerBottomRight cornerRadii:CGSizeMake(10.0f, 10.0f)];

    [[UIColor blackColor] setFill];
    [path fill];

    CGRect innerRect = CGRectInset(rect, 4.0f, 2.0f);
    innerRect.origin.y -= 2.0f;

    UIBezierPath *innerPath = [UIBezierPath bezierPathWithRoundedRect:innerRect
        byRoundingCorners:UIRectCornerBottomLeft | UIRectCornerBottomRight cornerRadii:CGSizeMake(8.0f, 8.0f)];

    [[UIColor redColor] setFill];
    [innerPath fill];
} 
```

这会产生以下输出：

![在此处输入图像描述](https://i.stack.imgur.com/Xy5fa.png)

编辑：按照 Paul.s 的建议缩放cornerRadii。

# php - PHP：使用 AJAX 请求页面时 HTTP_X_REQUESTED_WITH 不存在

> ID：15991873
> 
> 赞同：0
> 
> 时间：2013-04-13T19:19:03.863
> 
> 标签：php, apache, xampp

我在许多相关问题中搜索了答案，但没有一个能真正解决我的问题，所以我有以下代码：

```
if (isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest') {

}else{
    echo("This page can't be accessed.");
} 
```

我尝试重命名`HTTP_X_REQUESTED_WITH`为`HTTP_X_REQUEST_WITH`，因为另一个问题的答案，我看到有时请求作为 HTTP_X_REQUEST_WITH 而不是发送`HTTP_X_REQUESTED_WITH`。

但是这些都不起作用，这很奇怪，因为它几天前就起作用了……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:36:33.033

AJAX 请求不会自动获取 HTTP_X_REQUESTED_WITH 标头。

jQuery 和大多数其他库都会发送它，但如果您使用了自己的 AJAX，则需要使用自己的 HTTP_X_REQUESTED_WITH 标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-24T12:40:21.883

已`HTTP_X_REQUESTED_WITH`更改为`X_REQUESTED_WITH`适用于主要的现代浏览器。请注意，某些浏览器可能仍使用`HTTP_X_REQUESTED_WITH`.

# .htaccess - htaccess 规范名称重定向

> ID：15991876
> 
> 赞同：0
> 
> 时间：2013-04-13T19:19:05.833
> 
> 标签：.htaccess, rewrite, http-redirect

我正在使用 SSL 证书运行网站。

为了优化我的 SEO，我想将所有 CNames 重定向到[https://example.com](https://example.com)。

同一个地址有4个变种： https://example.com https://www.example.com http://example.com http://www.example.com

这段代码几乎可以工作：

```
RewriteCond %{HTTP_HOST} ^www\.example\.com$ [OR]
RewriteCond %{HTTPS} =on
RewriteRule ^.*$ https://example.com/$0 [R,L] 
```

但是，其中一个 URL 不会重定向。如果我只输入 example.com ( [http://example.com](http://example.com) )，则 URL 不会重定向到[https://example.com](https://example.com)。

任何人都可以用上面的代码帮助我纠正这个问题吗？

回应下面乔恩的回答。我将代码片段添加到现有的 .htaccess 文件中。由于我对 .htaccess 不熟悉，我想知道该片段周围的代码是否导致了重定向循环？

这是 .htaccess 文件，包括下面的代码段：

```
 <IfModule mod_rewrite.c>
    RewriteEngine On

    # Installation directory
    RewriteBase /

    # Protect application and system files from being viewed
    RewriteRule ^(application|modules|system|tests|sql) - [F,L]

    # Allow any files or directories that exist to be displayed directly
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d

    # Rewrite all other URLs to index.php/URL
    RewriteRule .* index.php?kohana_uri=$0 [L,QSA]

    #redirect CNames to non www
    RewriteCond %{HTTP_HOST} ^www\.example\.com$ [OR]
    RewriteCond %{HTTPS} off
    RewriteRule ^.*$ https://example.com/$0 [R,L]

   </IfModule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T00:54:59.220

这是另一种选择：

```
# http www and non-www to https non-www
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} (?:www\.)?(.*)  [NC]
RewriteRule ^(.*) https://%1/$1          [R=301,L]

# https www to non-www
RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST}  ^www\.(.*) [NC]
RewriteRule ^(.*) https://%1/$1      [R=301,L] 
```

我猜这段代码的最佳位置是在`RewriteBase /`指令下方。

如果有循环，则很难由前面的代码生成。也许通过第二条规则，您可以尝试添加一个条件，如下所示：

```
# Add next line before the rule
RewriteCond %{REQUEST_URI}  !index\.php   [NC]
# Current rule
RewriteRule .* index.php?kohana_uri=$0 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T19:26:51.110

HTTPS 应该“关闭”

```
RewriteCond %{HTTP_HOST} ^www\.example\.com$ [OR]
RewriteCond %{HTTPS} off
RewriteRule ^.*$ https://example.com/$0 [R,L] 
```

因为您希望主机以 www 开头或 HTTPS 关闭。

# delphi - 如何访问页面控件上的元素？

> ID：15991880
> 
> 赞同：3
> 
> 时间：2013-04-13T19:19:22.573
> 
> 标签：delphi, delphi-7

我正在使用 Delphi 7。

假设我的表单上有一个页面控件。此页面控件有两个或三个选项卡。每个选项卡上都有一些其他控件，例如标签、编辑等。例如，如何获取代码中编辑的文本属性？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-13T19:21:39.590

Iterate across the controls of the tabsheet using its `ControlCount` and `Controls` properties.

```
for i := 0 to TabSheet.ControlCount-1 do
begin
  if TabSheet.Controls[i] is TEdit then
    ShowMessage(TEdit(TabSheet.Controls[i]).Text);
end; 
```

This will iterate over all immediate children of the tabsheet. If you need to iterate deeper into the children of the children and so on then you want a recursive solution.

If you want to search in each tabsheet then you need to iterate over them too.

```
for i := 0 to PageControl.PageCount-1 do
  TabSheet := PageControl.Pages[i];
  for j := 0 to TabSheet.ControlCount-1 do
  begin
    if TabSheet.Controls[j] is TEdit then
      ShowMessage(TEdit(TabSheet.Controls[j]).Text);
  end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T20:04:45.453

您仍然可以直接访问 TEdit

```
Edit1.Text := 'My Edit box on a Tab'; 
```

# c - 释放其所有内存并将其头指针设置为 NULL（空列表）

> ID：15991884
> 
> 赞同：2
> 
> 时间：2013-04-13T19:19:32.867
> 
> 标签：c, linked-list

在我的考试中有一个问题。

编写一个函数`DeleteList`()，它接受一个列表，释放其所有内存并将其头指针设置为 NULL（空列表）。

解决方案为

```
void DeleteList(struct node** headRef) {
    struct node* current = *headRef;
    struct node* next;
    while (current != NULL) {
        next = current->next; 
        free(current); 
        current = next; 
    }
    *headRef = NULL;
} 
```

我的解决方案：

```
void DeleteList(struct node** headRef) {
    struct node* current = *headRef;

    while (current != NULL) {
        *headRef = *headRef->next;
         free(current);
         current = * headRef;
    }
    free(current);
    *headRef = NULL;
} 
```

这是正确的方法吗？谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T23:32:02.570

您的解决方案没有这样做“并将其头指针设置为 NULL”，因为您的提案 ( `*headRef = NULL;`) 的最后一行不再将传入的 headRef 值设置为 NULL，而是列表中的最后一个 Next 点（已经为 null） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:24:20.733

```
void DeleteList(struct node **headRef)
{
    struct node *current = *headRef;

    while (current) {
         *headRef = (*headRef)->next;
         free(current);
         current = *headRef;
    }
    *headRef = NULL;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:29:34.717

```
free(current); //you should remove this line after the while loop because when while loop breaks the current is already NULL so free(NULL) makes no sense. 
*headRef = NULL; 
```

看这里[Free(NULL)](https://stackoverflow.com/questions/1938735/does-freeptr-where-ptr-is-null-corrupt-memory)。

其余的必须按照我的方式工作。

# java - Struts 2 #{} 在 Netbeans 7.3 中给出编译错误

> ID：15991885
> 
> 赞同：0
> 
> 时间：2013-04-13T19:19:34.497
> 
> 标签：java, jsp, struts2, maven-2, netbeans-7.3

我正在使用 Netbeans 7.3，并且创建了一个 maven Struts 2.3 项目。

其他一切似乎都很好，除非我在 JSP 中编写类似这样的内容：

```
<s:select list="#{'-1':'All Activity','0':'Posts Only','1':'Trades Only'}" 
```

上面的代码在 JSP 中给出了错误。虽然它曾经在 6.9 中运行良好，但对我来说似乎是一个错误。任何帮助将非常感激。

我已经在插件页面上发表了关于它的评论，虽然在我看来并不像插件问题，因为 maven 与 NB 插件 AFAIK 无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:49:48.640

在上面的代码中，列表是使用 OGNL 表达式填充的。这是有效的表达式，但 IDE 并不总是支持它，因为 OGNL 版本和插件版本可能不匹配。您始终可以将其排除在验证之外。但这不是主要问题，您无法注意它。

此示例使用相同的集合，看起来不错

```
<s:select list="#@java.util.LinkedHashMap@{'-1':'All Activity','0':'Posts Only','1':'Trades Only'}"/> 
```

# cygwin - 在 cygwin 上升级 python 后 importerror-no-module-named-pkg-resources

> ID：15991888
> 
> 赞同：0
> 
> 时间：2013-04-13T19:19:53.570
> 
> 标签：cygwin

不久前我升级到 python 2.7。我没有使用我最近下载的任何软件包，所以直到现在我才意识到错误已连接。我无法使用任何软件包，因为我收到 no_module_named pkg-resources 错误。我看到了这个问题：[什么是导致 ImportError: No module named pkg_resources after upgrade of Python on os X?](https://stackoverflow.com/questions/1756721/what-is-causing-importerror-no-module-named-pkg-resources-after-upgrade-of-pyth) 并尝试按照说明进行操作，但当然因为我使用的是 cygwin，所以我不能使用 curl。我使用 cygwin setup 尝试下载分发（我猜 cygwin 也不存在）并找到了 python-setuptools。如果它可以帮助我下载它并且它摆脱了那个错误。这很棒，因为现在我至少可以使用 easy_install。但是，我仍然收到以下错误

```
dependencies when running many of my packages:
Traceback (most recent call last):
  File "/usr/bin/ipython", line 5, in <module>
    from pkg_resources import load_entry_point
  File "/usr/lib/python2.7/site-packages/pkg_resources.py", line 2803, in <module>
    working_set.require(__requires__)
  File "/usr/lib/python2.7/site-packages/pkg_resources.py", line 696, in require
    needed = self.resolve(parse_requirements(requirements))
  File "/usr/lib/python2.7/site-packages/pkg_resources.py", line 594, in resolve
    raise DistributionNotFound(req)
pkg_resources.DistributionNotFound: 
```

任何想法我认为这可能是我的站点包不在新的 python 文件夹中的问题，所以我将对此进行调查。无论哪种方式，我都想为 cygwin 用户分享我的解决方案。

更新：我将站点包从 2.6 复制到 2.7，但没有帮助。我最终意识到，因为鸡蛋都是 2.6 而不是 2.7，所以 python 2.7 不会接受它们。这很烦人。我想我必须重新安装所有软件包，除非有人有更简单的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-04T04:36:25.103

要解决这个问题的根源。我发现我的操作错误假设 curl 与 Cygwin 不兼容。我发现你可以[设置](https://stackoverflow.com/questions/3647569/how-do-i-install-curl-on-cygwin)cygwin来启用curl，问题解决了！

# python - 你如何选择一个 gae 实体的 key_name？

> ID：15991895
> 
> 赞同：1
> 
> 时间：2013-04-13T19:20:31.893
> 
> 标签：python, sql, google-app-engine, google-cloud-datastore

我想检索我的所有类实体 key_names 而不是键。

有没有办法用 gae 做到这一点？

这是我当前的代码：

```
entities = db.GqlQuery("SELECT __key_name__ FROM Class").fetch(1000)
logging.info(entities) 
```

这当然不起作用，因为没有属性**key_name**。有谁知道如何获得相同的效果？

我知道如何返回 Key 属性，但我想要的是**key_name**。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T19:31:24.953

当然，密钥包含密钥名称。因此，当您有一个键列表时，您可以调用`name()`它们中的每一个来获取名称组件。

# google-apps-script - 通过代码编写电子表格函数

> ID：15991896
> 
> 赞同：0
> 
> 时间：2013-04-13T19:20:40.180
> 
> 标签：google-apps-script, google-docs, formula

我想将其写入范围 B1..

=拆分（A1，“”）

（分隔符是空格）

我如何使用代码来做到这一点？

我试过这个...

```
 var splitCell = "=SPLIT(A1," ")";
 SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1").getRange("B1").setFormula(splitCell); 
```

但是这些报价显然是毁灭性的。因此，在这种情况下如何处理报价？

* * *

**编辑**

对不起。脑放屁。

var splitCell = '=SPLIT(A8," ")';

我以为我已经尝试过（大约一百万次），但是当我（再次）尝试时，它没有问题。

不管怎么说，还是要谢谢你

（我相信我将来会带着不那么臭的问题回来）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:51:41.660

在我提出问题的时候，我不被允许回答我自己的问题（这里的新手有限制）。但是，我的问题的“已编辑”部分说明了我的问题的答案。

对于造成的混乱，我深表歉意，但当时我没有其他选择，因此即使我已经解决了问题，我的问题仍然是“未回答”。

无论如何，答案是： var splitCell = '=SPLIT(A8," ")';

# c# - 调用 SQL Server 存储过程的问题

> ID：15991897
> 
> 赞同：-2
> 
> 时间：2013-04-13T19:20:47.783
> 
> 标签：c#, sql, sql-server, stored-procedures, compiler-errors

我创建了一个存储过程并从 Visual Studio 调用它，但是当我调用存储过程时，程序出现编译器错误。SQL Server 中确实存在存储过程。

这是错误：

> 方法没有重载“总和”采用 0 参数

SQL Server 中的存储过程：

```
CREATE PROCEDURE sumtotal(@totaling int output)
AS
BEGIN
declare @sum int
set @sum=(select SUM(amount_income) from IncomeTable)
insert into Total_Table(Total_Income)
values(@sum)
    set @totaling=@sum
    return @totaling
END
GO 
```

在VS中：

```
AccountDBClassDataContext context = new AccountDBClassDataContext();
int total;

private void button3_Click(object sender, EventArgs e)
{
   dataIncome = context.sumtotal();
} 
```

我知道也许我的问题是愚蠢的问题，但这是一个问题。

请帮我 。

干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T19:22:52.213

There is one `output` parameter specified in stored procedure, so you have to pass it when you're calling it:

```
private void button3_Click(object sender, EventArgs e)
{
   int? dataIncome = null;
   context.sumtotal(ref dataIncome);
} 
```

# css - Detect the type of font that is displayed in an image

> ID：15991900
> 
> 赞同：-7
> 
> 时间：2013-04-13T19:21:04.920
> 
> 标签：css, photoshop

Does anyone by any chance know what font this is?

[http://spiketradinginc.com/images/font.png](http://spiketradinginc.com/images/font.png)

I was thinking Helvetica possibly? Wasn't sure I'm not a designer.

What would be the best resume font that would look good on paper? (Print/Web)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:38:40.340

图像中的第一个字体是**[Museo Slab 500](http://www.myfonts.com/fonts/exljbris/museo-slab/500/)**。

我是这样发现的：

1.  [使用Paint.NET](http://www.getpaint.net/)打开图像

2.  *图层 > 旋转/缩放*

3.  旋转*-19.75°*

4.  使用*矩形选择*工具，仅突出显示 1 种字体

5.  *图像 > 裁剪到选择*

这给了我以下图像：

![](https://i.stack.imgur.com/m4zWv.png)

然后我将它上传到[WhatTheFont](http://www.myfonts.com/WhatTheFont/)，填写每个字符的框（它没有成功选择字母`i`，所以我将它们留空）。

结果显示了 5 种可能的匹配，通过仔细比较每个字体样本与原始图像，我推断它是 Museo Slab 500。

您可以按照此过程查找图像中的其他字体！

# java - 如何以编程方式将视图移动到另一个视图下？

> ID：15991901
> 
> 赞同：0
> 
> 时间：2013-04-13T19:21:05.357
> 
> 标签：java, android, xml

我有一个drawview，我想把它放在另一个视图中。为此，我有以下代码：

```
DrawView drawview = new DrawView(this);
drawview.setLayoutParams(new RelativeLayout.LayoutParams(
    RelativeLayout.LayoutParams.WRAP_CONTENT,
    RelativeLayout.LayoutParams.WRAP_CONTENT));
views.addView(drawview); 
```

它工作正常，但我想要的是单击`button`更改视图的顺序，一个视图（视图）将在另一个视图（drawview）之上。

但我希望始终显示两个视图（视图是透明的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T21:06:29.133

FrameLayout 是将视图置于另一个视图之上的唯一方法。[您可以在此处](http://developer.android.com/reference/android/widget/FrameLayout.html)找到有关 FrameLayout 的详细文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T14:05:01.647

类似的问题已在

[如何以编程方式放置或放置视图？](https://stackoverflow.com/questions/15997992/how-to-put-up-or-down-a-view-programatically)

对不起大家“重复”这个问题

# routes - Slim Framework - cannot add route middleware

> ID：15991906
> 
> 赞同：1
> 
> 时间：2013-04-13T19:21:32.247
> 
> 标签：routes, middleware, slim

I am new to Slim Framework and PHP. I cant get this to work, if I use a normal function and use "foo" as a parameter, it works, but doesnt work like this, even tho the documentation uses pretty much the same thing [http://docs.slimframework.com/](http://docs.slimframework.com/)

```
<?php
    require 'Slim/Slim.php';
    session_start();

    \Slim\Slim::registerAutoloader();
    $app = new \Slim\Slim();

    $foo = function() {
       global $app;
        if(!isset($_SESSION["user_id"])) {
            $app->redirect("/redirecto/login");
        } else {
            echo "Authenticated";
        } 
    }

    $app->get("/", $foo, function() {
        global $app;
        $app->render('index.php');
    });

    $app->get("/login", function() use ($app) {
        $app->render("login.php");
    });

?> 
```

The error is

```
Parse error: syntax error, unexpected '$app' (T_VARIABLE) in C:\xampp\htdocs\redirecto\index.php on line 41 
```

*(the $app->get("/", $foo, function() { line )*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T12:22:09.707

我想我在这里要说的第一件事是尽量避免将 Slim 实例称为全局实例。

从文档中，我们实际上调用 Slim getInstance 方法来获取当前 Slim 实例的副本。我将重写下面的代码，查看文档并查看一些有关[nettuts](http://net.tutsplus.com/?s=Slim%20Framework)的教程，因为它们有帮助。

```
<?php
require 'Slim/Slim.php';
session_start();

\Slim\Slim::registerAutoloader();
$app = new \Slim\Slim();

$foo = function() {
    $app = \Slim\Slim::getInstance();
    if(!isset($_SESSION["user_id"])) {
        $app->redirect("/redirecto/login");
    } else {
        echo "Authenticated";
    } 
}

$app->get("/", $foo, function() use ($app) {
    $app->render('index.php');
});

$app->get("/login", function() use ($app) {
    $app->render("login.php");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T17:59:27.063

您可以像这样设置它，以正常方式声明您的函数并将带有其名称的字符串传递给路由器方法。这将`foo()`在执行路由器关闭之前调用

```
function foo() {
    $app = \Slim\Slim::getInstance();
    if(!isset($_SESSION["user_id"])) {
        $app->redirect("/redirecto/login");
    } else {
        echo "Authenticated";
    } 
}

$app->get("/", 'foo', function() use ($app) {
    $app->render('index.php');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-17T19:45:17.423

正如其他人告诉你的那样，以下是一种不好的做法

```
$foo = function() {
   global $app;
    if(!isset($_SESSION["user_id"])) {
        $app->redirect("/redirecto/login");
    } else {
        echo "Authenticated";
    } 
} 
```

而您应该将其声明为

```
$foo = function() use ($app) { 
```

**但是**，专门针对该错误

```
Parse error: syntax error, unexpected '$app' (T_VARIABLE) in C:\xampp\htdocs\redirecto\index.php on line 41 
```

这是因为在以您的方式定义闭包之后，您需要添加一个分号`}`。所以你的闭包应该变成：

```
$foo = function() use ($app) {
   global $app;
    if(!isset($_SESSION["user_id"])) {
        $app->redirect("/redirecto/login");
    } else {
        echo "Authenticated";
    } 
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-21T10:14:13.063

您正在将中间件创建为创建自己的范围的匿名函数。为了在函数内部使用变量，您需要使用语句`$app`将其传递到作用域中。`use`

例如

```
$foo = function () use ($app) {
    $app = \Slim\Slim::getInstance();
    if(!isset($_SESSION["user_id"])) {
        $app->redirect("/redirecto/login");
    } else {
        echo "Authenticated";
    } 
} 
```

您对代码列表中的路由执行相同的操作。

# sql-server-2008 - Database synchronization?

> ID：15991909
> 
> 赞同：0
> 
> 时间：2013-04-13T19:21:52.187
> 
> 标签：sql-server-2008, data-synchronization

I have a small problem, I am working on a project where I need to synchronize the databases to maintain the same data at diff locations, all have their own database the structure of all the database,tables,stored procedures,etc are the same. i.e. they are the copy of a single database but data is entered from different locations and I need to have data to be synchronized so that we can see the data from anywhere, will creating a windows service work?

C# code will be a nice help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T06:03:23.257

您可以通过两种方式做到这一点.....第一种方式使用服务组合

i) 带有 Windows 服务的 W CF 服务或带有 Windows 服务的 Web 服务。您将需要安装在每个客户端机器上的 Windows 服务，该服务将检查本地数据库中的新数据并将该数据发送到 Web 或 wcf 服务，该服务将安装在 LAN 的服务器机器上。但是如果客户端在网络上，那么 web 服务或 w cf 服务应该在安装服务器数据库的静态 IP 地址上，如果客户端在某些情况下离线，那么你应该使用 MSMQ 或 Rabbit MQ 或任何排队机制...处理这种情况..

第二种方法是在 sql server 2008 中使用复制通过以下链接：

[http://www.codeproject.com/Articles/215093/Replication-in-MS-SQL-Server](http://www.codeproject.com/Articles/215093/Replication-in-MS-SQL-Server) [http://www.informit.com/guides/content.aspx?g=sqlserver&seqNum=313](http://www.informit.com/guides/content.aspx?g=sqlserver&seqNum=313) ) [数据库同步](https://stackoverflow.com/questions/15991909/database-synchronization)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-07T06:14:09.850

我猜你需要复制，让 SQL 管理你没有编写任何代码的地方，并且易于配置。

看看[http://www.codeproject.com/Articles/215093/Replication-in-MS-SQL-Server](http://www.codeproject.com/Articles/215093/Replication-in-MS-SQL-Server)，或者输入 SQL 复制，有大量可用的材料。

# java - How can i delete these spaces in Android

> ID：15991914
> 
> 赞同：2
> 
> 时间：2013-04-13T19:22:27.643
> 
> 标签：java, android, button, space

Here is my method, and this method's output is [http://l1304.hizliresim.com/18/f/m1r29.jpg](http://l1304.hizliresim.com/18/f/m1r29.jpg)

I don't want any spaces between these buttons. How can i do this?

```
public void butonOlustur(){
     TableRow layout1 = (TableRow) findViewById(R.id.tableRow1);
     TableRow layout2 = (TableRow) findViewById(R.id.tableRow2);
     TableRow layout3 = (TableRow) findViewById(R.id.tableRow3);
     TableRow layout4 = (TableRow) findViewById(R.id.tableRow4);
     TableRow layout5 = (TableRow) findViewById(R.id.tableRow5);
     TableRow[] layouts = new TableRow[6];
     layouts[0]=layout1;
     layouts[1]=layout2;
     layouts[2]=layout3;
     layouts[3]=layout4;
     layouts[4]=layout5;
     Button[][] myButton = new Button[4][25];
     for(int j = 0; j <myButton.length; j++){
     for(int i =0 ; i <25; i++){

         Button temp = new Button(this);
         myButton[j][i] = temp;
         layouts[j].addView(myButton[j][i], 15, 15);

     }
     layouts[j] = layouts[j+1];
     }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:21:57.893

[请参阅此处](https://stackoverflow.com/questions/2277732/how-to-get-rid-of-the-extra-gap-between-a-button-and-other-views)或[此处](https://stackoverflow.com/questions/4361309/remove-space-between-buttons)回答的类似问题。

基本上，您可以创建自己的 9patch 图像，或者只是将 layout_marginLeft 和 layout_marginRight 更改为负值。

如果您决定设置边距，您将不希望以像素为单位进行设置。要将边距设置为 dp 而不是像素，您可以使用[此答案](https://stackoverflow.com/questions/5255184/android-and-setting-width-and-height-programmatically-in-dp-units)中的公式。

# c# - 如何将 Datetimepicker 信息导出到日期时间？

> ID：15991917
> 
> 赞同：-1
> 
> 时间：2013-04-13T19:22:51.037
> 
> 标签：c#, datetime, methods, scheduling, datetimepicker

我正在创建一个应用程序，它正在从用户指定的时间/日期到时间/日期安排图片。

如何将信息从 DatetimePicker 导出到 Datetime 方法？并从那里开始所有工作？

如果有更好的方法请告诉我，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:28:29.180

以字符串形式获取日期：

```
string date= dateTimePicker1.Value.ToShortDateString(); 
```

并转换为日期时间：

```
DateTime dt = Convert.ToDateTime(date); 
```

# java - 如何在不知道 id 的情况下在 EditText 中设置文本？

> ID：15991923
> 
> 赞同：0
> 
> 时间：2013-04-13T19:23:31.890
> 
> 标签：java, android, eclipse, sdk

我想在不知道 id`setText()`的情况下使用函数`EditText`，所以如果`EditText`应用程序中有三个，则命令`setText()`应该更改所有三个上的文本，我不会知道 id。

我打算使用这个命令：

```
EditText ed = (EditText) findView (something); 
```

我不认为这很简单。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:29:19.770

您可以将only`TextViews`放在`ViewGroup`(ie `LinearLayout`) 中，然后像这样遍历他们的孩子。-

```
for (int i = 0; i < containerView.getChildCount(); i ++) {
    View view = containerView.getChildAt(i);
    if (view instanceof TextView) {
        TextView textView = (TextView) view;
        textView.setText(yourText);
    }
} 
```

# python - 是否有任何用于 Python 的字符检测包？

> ID：15991924
> 
> 赞同：-2
> 
> 时间：2013-04-13T19:23:33.000
> 
> 标签：python, image, ocr, libraries

是否有任何用于 Python 的字符检测包？

我实际上对角色是什么并不感兴趣，只是图像中有一个角色。具体来说，我正在编写一个程序来放大每个单独的字符，然后执行[OCR](http://en.wikipedia.org/wiki/Optical_character_recognition)。

我们的总体思路是找到每个字符，然后对图像中的字符进行[图像傅里叶变换](http://en.wikipedia.org/wiki/Fourier_analysis#Applications_in_signal_processing)，并将其与字符傅里叶库进行比较。让我知道我是否应该更具体。我们确实在尝试找到一种方法来有效地识别要对哪些迷你图像进行傅里叶变换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:28:22.950

[PyTesser](http://code.google.com/p/pytesser/)是一个 Python 绑定到用于 OCR 的 Google 的[Tesseract](http://en.wikipedia.org/wiki/Tesseract_%28software%29)引擎。

# ios - 正在使用不同的帧原点绘制 CALayer 子图层。界限问题

> ID：15991933
> 
> 赞同：0
> 
> 时间：2013-04-13T19:24:23.100
> 
> 标签：ios, objective-c, core-animation, core-graphics, calayer

我以这种方式在给定视图中将 CAShapeLayer 作为 subLayer 添加到 self.layer：

```
//balloonrect's value is this one
_balloonRect = CGRectMake(0, 55, 239, 118);

CAShapeLayer *balloonFrame = [CAShapeLayer layer];
balloonFrame.cornerRadius = 15.0f;
balloonFrame.frame = _balloonRect;
balloonFrame.fillColor = _balloonColor.CGColor;
balloonFrame.strokeColor = _balloonStrokeColor.CGColor;
balloonFrame.lineWidth = 5.0f;
balloonFrame.lineCap = kCALineCapRound;
balloonFrame.lineJoin = kCALineJoinRound;
balloonFrame.masksToBounds = YES;
UIBezierPath *fillPath = [UIBezierPath bezierPathWithRoundedRect: CGRectInset( _balloonRect, balloonFrame.lineWidth, balloonFrame.lineWidth) cornerRadius: 15.0f];
balloonFrame.path = fillPath.CGPath; 
```

但是，不明白为什么，形状是在**balloonRect**中指定的高度下绘制的，它看起来是 110 像素而不是它应该的 55。奇怪的是，如果我添加该行

```
 balloonFrame.bounds = _balloonRect; 
```

设置图层的框架后，一切似乎都很好，究竟发生了什么？如果它们是针对图层本身的，为什么我必须设置边界？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:26:54.133

1.  的高度`balloonRect`不是 55，而是 118。 CGRectMake 去`(x-top-left, y-top-left, width, height)`。

2.  更改`bounds`某物的 以使其具有非零`x-top-left`并`y-top-left`移动其绘图原点，因此您将绘图向上和向左推（实际上不改变图层的大小）。

阅读我书中关于框架和边界的部分可能会对您有所帮助，从这里开始：[http ://www.aeth.com/iOSBook/ch14.html#_frame](http://www.apeth.com/iOSBook/ch14.html#_frame)

# sql - How do use one value in a table to replace another value in the same table?

> ID：15991935
> 
> 赞同：1
> 
> 时间：2013-04-13T19:24:35.030
> 
> 标签：sql, sql-server-2008

I have a table that contains codes (i.e. 8202-6) and has a resulting value in a different column. I used the "Case When" function to take the codes out a single column and place them in separate columns based on the code number. However, now I end up with a bunch of null values in the rows and one code with one result. I would like to replace the actual code with it's corresponding value (i.e. 8206-6 = Height, result 75). So in the Height column I get the LOINC code instead of the Height value of 75\. Can anyone help me figure out the right code to use. Below is an example of the code that I'm using just to get the columns separated.

```
Select Distinct

p.PatientID,
Convert(varchar, fs.obsdate, 101) as Date_of_Service,
p.LASTNAME,
p.FIRSTNAME,
CONVERT(varchar, "p"."DATEOFBIRTH", 101) as DOB,
Case When fs.loinccode='8302-2' Then fs.loinccode end as Height,
Case When fs.loinccode='3141-9' Then fs.loinccode end as Weight,
Case When fs.loinccode='8310-5' Then fs.loinccode end as Temperature,
Case When fs.loinccode='8287-5' Then fs.loinccode end as HeadCircumf,
Case When fs.loinccode='8867-4' Then fs.loinccode end as Pulse,
Case When fs.loinccode='9279-1' Then fs.loinccode end as Respiration,
Case When fs.loinccode='8480-6' Then fs.loinccode end as BPSystolic,
Case When fs.loinccode='8462-4' Then fs.loinccode end as BPDiastolic,
fs.obsvalue as Test_Results,
fs.units as Test_Units

From

PERSON as p 
Left Outer join flowsheet_observation fs on fs.pid=p.pid 
```

Result:

```
Height  Weight  Temperature HeadCircumf Pulse   Respiration BPSystolic  BPDiastolic Test_Results    Test_Units
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    + history of lef tshoulder dislocation 10 years ago    Current Meds:        NULL
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    never   NULL
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    regular NULL
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    tympanic    NULL
NULL    NULL    NULL    NULL    NULL    NULL    NULL    8462-4  100 mm Hg
NULL    NULL    NULL    NULL    NULL    NULL    8480-6  NULL    140 mm Hg
NULL    NULL    NULL    NULL    8867-4  NULL    NULL    NULL    82  /min
NULL    NULL    8310-5  NULL    NULL    NULL    NULL    NULL    99.1    deg F
NULL    3141-9  NULL    NULL    NULL    NULL    NULL    NULL    283 lb
8302-2  NULL    NULL    NULL    NULL    NULL    NULL    NULL    72.5    in
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    37.72   NULL
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    regular NULL
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    tympanic    NULL
NULL    NULL    NULL    NULL    NULL    NULL    NULL    8462-4  100 mm Hg
NULL    NULL    NULL    NULL    NULL    NULL    8480-6  NULL    142 mm Hg
NULL    NULL    NULL    NULL    8867-4  NULL    NULL    NULL    86  /min
NULL    NULL    8310-5  NULL    NULL    NULL    NULL    NULL    99.4    deg F
NULL    3141-9  NULL    NULL    NULL    NULL    NULL    NULL    281 lb 
```

Any help with this would be greatly appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:04:14.993

您需要创建一个表 code_names 将代码与其含义相关联，

```
code   | label
8302-2 | Height
3141-9 | Weight
... 
```

然后加入 flowsheet_observation 并选择标签而不是代码。不需要所有这些情况。

编辑：如果创建代码表不是一个选项，则可以使用联合创建代码关系：

SELECT '8302-2' AS 代码，'Height' AS 标签 UNION SELECT '3141-9' AS 代码，'Weight' AS 标签 UNION ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:13:18.450

尝试使用 MAX(CASE WHEN THEN END) 并按其他字段分组

# python - Changing the definition of an existing function

> ID：15991936
> 
> 赞同：1
> 
> 时间：2013-04-13T19:25:08.033
> 
> 标签：python, python-2.7

I want to print to a file using `print` I import from `__future___`. I have the following as an import:

```
from __future__ import print_function 
```

From now on, I can print using:

```
print("stuff", file=my_handle) 
```

However, I have many calls to `print` in a function, so I would want to be able to use a function where the keyword argument is bound to `my_handle`. So, I use partial application:

```
printfile = partial(print, file=my_handle)
printfile("stuff")
printfile("more stuff") 
```

which is what I intended. However, is there any way I can change to definition of `print` itself by partially applying the keyword argument? What I have tried was:

```
print = partial(print, file=my_handle) 
```

however I got an error saying:

```
UnboundLocalError: local variable 'print' referenced before assignment 
```

Is there any way to use `print` without mentioning my file every time?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T13:27:56.537

`print = partial(print, file=my_handle)`

这一行在第二个上引起 UnboundLocalError，第二`print`个用作 的参数`partial()`。这是因为`print`在此特定函数中发现名称是局部变量 --- 因为您分配给它，在这种情况下在同一行中，更一般地在同一函数中。您不能在一个函数中使用相同的变量名有时引用全局变量，有时引用局部变量。

要修复它，您需要使用不同的名称：

`fprint = partial(print, file=my_handle)`.

# string - 在 Matlab 中清理字符串以进行比较

> ID：15991945
> 
> 赞同：0
> 
> 时间：2013-04-13T19:26:06.887
> 
> 标签：string, matlab, sanitization, consistency, input-sanitization

[这](https://stackoverflow.com/questions/15990891/how-to-redirect-stdout-to-stdin-in-matlab-aka-how-to-manage-file-descriptors)是考虑的后续问题`evalc`，而不是手动处理文件描述符。您可以在下面看到一个关于消毒不良的示例。我想删除诸如尾随字符、所有空格、所有换行符等 - 通常会导致意想不到的事情 -**是否有现成的清理命令来执行此操作？**

```
EDU>> a

a =

1 +1*{x} -1*{y}*{z}

EDU>> b

b =

1 +1*{x} -1*{y}*{z}

EDU>> isequal(a,b)

ans =

     0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:26:06.887

我不知道是否存在任何现成的健壮实现，但这很好用

```
xx=@(x)regexprep(x,'\s',''); isequal(xx(a),xx(b)) 
```

我使用匿名函数并删除一些奇怪的东西，例如在窗口上通常很难看到的尾随空格/换行符。

此外，诸如`strtrim()`和之类的命令`deblank()`对您删除尾随字符很有用。

# signalr - Signalr Owin 简单示例 javascript 客户端未被调用

> ID：15991947
> 
> 赞同：0
> 
> 时间：2013-04-13T19:26:10.303
> 
> 标签：signalr, signalr-hub, signalr.client, owin

我有一个 5.3.0 版本的信号器自托管，它正在升级到更新版本的信号器。使用[https://github.com/SignalR/SignalR/wiki/Self-host](https://github.com/SignalR/SignalR/wiki/Self-host)示例我创建了一个简单的示例，但我无法让它工作。

我可以连接到服务器上的集线器并调用集线器上的方法，但我无法让集线器调用 javascript 客户端。

在提琴手中查看它时，我从未看到集线器返回响应。

这是代码

```
using System;
using Microsoft.AspNet.SignalR;
using Microsoft.Owin.Hosting;
using Owin;

namespace ConsoleApplication3
{
class Program
{
    static void Main(string[] args)
    {
        string url = "http://localhost:8080/";

        using (WebApplication.Start<Startup>(url))
        {
            Console.WriteLine("Server running on {0}", url);
            Console.ReadLine();
        }
    }
}
}

using Microsoft.AspNet.SignalR;
using Owin;

namespace ConsoleApplication3
{
  class Startup
  {
    // This method name is important
    public void Configuration(IAppBuilder app)
    {
        var config = new HubConfiguration
        {
            EnableCrossDomain = true,
            EnableJavaScriptProxies = true
        };

        app.MapHubs(config);
    }

  } 
```

}

```
using System;
using System.Threading.Tasks;
using Microsoft.AspNet.SignalR;
using Newtonsoft.Json;

namespace ConsoleApplication3.Hubs
{
public class Chat : Hub
{

    public override Task OnConnected()
    {
        Notify(Context.ConnectionId);
        return new Task(() => { });
    }

    public void RunTest()
    {
        Notify(Context.ConnectionId);
    }

    public void Notify(string connectionId)
    {
        dynamic testMessage = new
        {
            Count = 3,
            Message = "Some test message",
            Timestamp = DateTime.Now
        };

        String json = JsonConvert.SerializeObject(testMessage);

        var context = GlobalHost.ConnectionManager.GetHubContext<Chat>();
        context.Clients.Client(connectionId).sendNotification(json);
    }

 }
} 
```

这是客户端

```
<!DOCTYPE html> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head>
<title></title>     
    <script src="Scripts/json2.js"></script>
    <script src="Scripts/jquery-1.9.1.js"></script>
    <script src="Scripts/jquery.signalR-1.0.1.js"></script>
    <script src="http://localhost:8080/signalr/hubs"></script>

<script>         
    $(function () {

        // Proxy created on the fly
        var notification = $.connection.chat;
        $.connection.hub.logging = true;

        // Declare functions that can be run on the client by the server
        notification.client.sendNotification = onAddNotification;
        notification.client.disconnected = function (connectionid) {
            console.log(connectionid);
        };
        // Testing code only
        $("#testButton").click(function () {
            // Run test function on server
            notification.server.runTest();
        });

        jQuery.support.cors = true;

        // Map the onConnect and onDisconnect functions
        notification.client.connected = function () {
            alert("Notification system connected");
        };
        notification.client.disconnected = function () { };
        $.connection.hub.url = "http://localhost:8080/signalr";

        //$.connection.hub.start();
        $.connection.hub.start(function () {
            alert("Notification system connected");
        });

    });

    // Process a newly received notification from the server
    function onAddNotification(message) {

        // Convert the passed json message back into an object
        var obj = JSON.parse(message);

        var parsedDate = new Date(parseInt(obj.Timestamp.substr(6)));

        // Update the notification list
        $('#notifications').prepend('<li>' + obj.Message + ' at ' + parsedDate + '</li>');

    };

    </script> 
</head> 
<body>     
    <a href="javascript:void(0)" class="btn" id="testButton">Send test</a>     
    <ul class="unstyled" id="notifications">             
    </ul> 
</body> 
```

任何想法都会受到赞赏，因为我相当卡住。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:42:43.107

您的代码中有几件事：

改变这个：

```
public override Task OnConnected()
{
    Notify(Context.ConnectionId);
    return new Task(() => { });
} 
```

至：

```
public override Task OnConnected()
{
    Notify(Context.ConnectionId);
    return base.OnConnected();
} 
```

同样在您的集线器中：

这个功能太努力了：

```
public void Notify(string connectionId)
{
    dynamic testMessage = new
    {
        Count = 3,
        Message = "Some test message",
        Timestamp = DateTime.Now
    };

    String json = JsonConvert.SerializeObject(testMessage);

    var context = GlobalHost.ConnectionManager.GetHubContext<Chat>();
    context.Clients.Client(connectionId).sendNotification(json);
} 
```

我什至不确定你为什么要传递连接 ID（也许它是静态的？）

```
public void Notify()
{
    dynamic testMessage = new
    {
        Count = 3,
        Message = "Some test message",
        Timestamp = DateTime.Now
    };

    Clients.Client(Context.ConnectionId).sendNotification(testMessage);
} 
```

您不需要序列化两次，我们已经为您完成了。

消除：

```
jQuery.support.cors = true; 
```

永远不要这样设置。

还：

```
// Map the onConnect and onDisconnect functions
notification.client.connected = function () {
    alert("Notification system connected");
};

notification.client.disconnected = function () { }; 
```

这些没有映射任何客户端。您无法将连接和断开连接从服务器映射到客户端。客户端有自己的事件。

其他事情：

这应该在 start 回调中，这样你就不会在它准备好之前点击它：

```
$.connection.hub.start().done(function() {
    // Testing code only
    $("#testButton").click(function () {
        // Run test function on server
        notification.server.runTest();
    });
}); 
```

# .net - Windows 服务找不到数据提供者

> ID：15991948
> 
> 赞同：0
> 
> 时间：2013-04-13T19:26:13.963
> 
> 标签：.net, windows-services, oracle11g, .net-4.5, odac

我有一个将实体框架与[ODAC](http://www.oracle.com/technetwork/developer-tools/visual-studio/downloads/index.html)结合使用的 Windows 服务。该服务只需轮询数据库中的表以检查准备处理的记录。

该服务在我的开发 PC 上按预期工作，但在部署到服务器时无法正常工作。服务器安装了相同的 ODAC 组件，并且执行相同代码的控制台应用程序可在开发 PC 和服务器上运行。

我从服务器收到的 windows 服务错误消息如下：

`System.ArgumentException: The specified store provider cannot be found in the configuration, or is not valid. ---> System.ArgumentException: Unable to find the requested .Net Framework Data Provider. It may not be installed. at System.Data.EntityClient.EntityConnection.GetFactory(String providerString)`

谷歌搜索此错误消息表明数据提供程序未正确安装/配置某些内容，但随后控制台应用程序工作正常，所以我不相信这是问题的原因。

欢迎任何想法，如果需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T09:12:47.630

这似乎与我使用的 ODP.NET 版本有关。32 位和 64 位版本没有正确安装，现在我重新安装了一切似乎都正常。

# c# - 访问不同类中的列表

> ID：15991950
> 
> 赞同：0
> 
> 时间：2013-04-13T19:26:32.090
> 
> 标签：c#, wpf, listbox

我无法使用存储在不同类中的信息填充列表框。此类称为 TeacherTools，其中使用了许多方法来控制该列表中的学生对象。

我要做的基本上是将学生的名字添加到列表中，但我不确定语法。

```
public partial class TeacherTools : Window
{
    private List<Student> studentList = new List<Student>();

    public List<Student> Kids
    {
       get { return studentList; }
       set { studentList = value; }
    }
}

public partial class MainWindow : Window
{
    private void beginTest(object sender, RoutedEventArgs e)
    {
        foreach (Student s in Kids) //Unsure here
        {
            studentsList.Items.Add(s.Name);
        }
    }
} 
```

感谢您的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T20:14:40.440

我想你想要做的是在列表框中显示学生的名字..

```
studentsList.DataSource = teachTool.Kids;
studentsList.DisplayMember = "Name"; 
```

这里有一个更长的例子 [http://msdn.microsoft.com/en-GB/library/system.windows.forms.listcontrol.displaymember.aspx](http://msdn.microsoft.com/en-GB/library/system.windows.forms.listcontrol.displaymember.aspx)

编辑：这样做将给予与学生类相关的更多控制自由编辑2：以上是针对winforms的......`ItemSource`并且`DisplayMemberPath`似乎是wpf等价物

[DisplayMemberPath](http://msdn.microsoft.com/en-gb/library/system.windows.controls.itemscontrol.displaymemberpath.aspx) [ItemSource](http://msdn.microsoft.com/en-gb/library/system.windows.controls.itemscontrol.itemssource.aspx)

# c - “错误：预期的表达式之前”我函数的第一行

> ID：15991965
> 
> 赞同：0
> 
> 时间：2013-04-13T19:28:26.173
> 
> 标签：c, expression

我在编译时收到此错误...“stock.c:103：错误：'stock_t'之前的预期表达式”...我做错了什么吗？

```
stock_t * createStockHolding(
     char * name, float closing, float opening, int shares, 
     float (* getPrice) (void * S),
     float (* getTotalDollarAmount)(void * S),
     float (* getPercentChange)(void * S),
     char * (* toString)( void * S)) {

        stock_t * newStock = (stock_t*)malloc(sizeOf(stock_t));
        newStock->stockSymbol = name;
        newStock->closingSharePrice = closing;
        newStock->openingSharePrice = opening;
        newStock->numberOfShares = shares;
        newStock->getPrice = getPrice;
        newStock->getTotalDollarAmount = getTotalDollarAmount;
        newStock->getPercentChange = getPercentChange;
        newStock->toString = toString;
        return newStock;
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T19:33:18.767

它是 的大写字母`sizeOf`O。您必须使用`sizeof`（小`o`）。

# python - 通过命令行使用 Python 进行交互式绘图

> ID：15991968
> 
> 赞同：18
> 
> 时间：2013-04-13T19:28:54.753
> 
> 标签：python, command-line, numpy, matplotlib

我正在尝试使用 Python 以及 numpy 和 matplotlib 库进行一些数据分析和绘图并查看我的绘图，相应地调整我的代码等。所以我需要能够检查绘图。但是，从命令行运行脚本会导致图形暂时弹出然后立即消失。另一个答案建议`raw_input("text here")`在程序末尾添加一行以强制 python 等待输入并保持绘图打开。这确实为我打开了绘图窗口，但实际绘图消失了，我在 python 等待输入时得到一个空的灰色图形窗口。

我正在运行**MAC OS X 10.8.3**并使用**终端 v2.3**，我的 python 安装是**python 2.7.3**

```
import matplotlib.pylab as plt
import numpy as np

[ .. bunch of calculations .. ]

plt.ion()
plt.figure("Test Figure")
plt.plot(xspace[:],vals[:,50])

raw_input("press key to exit") 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-04-13T20:41:20.430

[`plt.show`](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show)在代码末尾使用。

# jquery - 如何防止 jQuery 中的函数 .fadein() 将用户发送到页面顶部？

> ID：15991971
> 
> 赞同：0
> 
> 时间：2013-04-13T19:29:13.920
> 
> 标签：jquery, joomla, fadein, page-jump

我有一个菜单，我基本上单击并隐藏当前 p 并淡入相应的按钮文本。问题是，它使我的页面从字面上跳到顶部。

这是菜单的html：

```
<li class="sub"><a href="#" class="sub_ha1"> 
   › Instalação/Configuração de Componentes</a>
</li> 
```

这是相应文本的html

：

```
<div id="sub_ha1" class="text" style="display:block;">
  <img src="../images/serv/ha1.jpg" alt="">
  <h1> Instalação/Configuração de Componentes - 35€ </h1>

  <p>Chamamos de hardware a todos os componentes ..... </p>
</div> 
```

这是jQuery：

```
$("#navigation a.sub_ha1").click(function () {
$(".text").hide();
$("#sub_ha1").fadeIn();
return false;
}); 
```

我想要的是一种防止它的方法，因为它只是在通过几个菜单后让它变得烦人。

谢谢

编辑： http: [//jsfiddle.net/M2AE6/](http://jsfiddle.net/M2AE6/) 如果您在单击第一个或第二个菜单项后单击关于或联系菜单，您将看到发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T19:53:07.240

您还可以更改链接href。

```
<a href="javascript:void(0);">text</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:22:30.013

正如 tcovo 在对主要问题的评论中所说`what if you use function() { $(".text").not($("#sub_ha1").fadeIn()).hide(); return false; } so that #sub_ha1 gets shown (initially with opacity 0) before the other .text are hidden? – tcovo`，这实际上效果非常好，除非总文本高度小于菜单。谢谢大家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:37:25.933

尽管您的代码看起来正确，但您可以尝试以下代码：

```
$("#navigation a").click(function(e){
   e.preventDefault(); // <----stop it here
   $(".text").hide();
   $("#"+this.className).fadeIn(); // <--this will get you the specific div you want to fade In.
   // $("[id='"+this.className + "']").fadeIn();// <---another way to do it
}); 
```

# ssl - Congiuring varnish 与多个域+ssl 支持

> ID：15991977
> 
> 赞同：0
> 
> 时间：2013-04-13T19:29:31.623
> 
> 标签：ssl, nginx, varnish

我目前正在参与以负载均衡器为后端的清漆实现，该后端应将流量相应地转发到多个 Web 服务器。

我正在努力实现：

```
Public Traffic -> haproxy/DNS -> [Varnish (x2) / nginx(ssl) ] -> Loadbalancer -> Web server(x4) 
```

我可以将 Varnish 、 nginx 配置为一个域的 ssl/443 终结器。（即，如果我将 dns 指向 varnish eth 并访问网络服务器为该页面提供服务）

**清漆配置**

```
backend loadbalancer { .host = "xxx.xxx.xxx.xxx"; .port = "80" } 
backend loadbalancer_ssl { .host = "xxx.xxx.xxx.xxx"; .port = "443"; }
sub vcl_recv {

                                 # Set the director to cycle between web servers.
                                  if (server.port == 443) {
                                        set req.backend = loadbalancer_ssl;
                                  }
                                  else {
                                   set req.backend = loadbalancer;
                                  }
}
# And other vcl rules for security and other. 
```

**Nginx 配置**

```
 location / {
        # Pass the request on to Varnish.
        proxy_pass  http://127.0.0.1;
            proxy_http_version 1.1;

#SSL certificate and config 
```

=> 我将如何实现将清漆配置为具有多个域的 ssl 终止的 dns 入口点？=> 是否有可能以某种方式配置清漆以接受所有连接并直接绕过 ssl 到 Web 服务器？（这样我就不必担心 ssl 支持的多个接口）

=> 或者用 443 终结器实现的任何标准方法？

注意：为什么我要实现这一点：创建多层安全性并使用现有的硬件设备。

**已经到位：**

1.  所有服务器都有（使用 lightty 的 ssl 的多个接口）。
2.  负载平衡器 -> 硬件 -> 将平衡这些 Web 服务器之间的负载。

任何在那里分享观点的专家都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:58:52.613

我决定使用 nginx 作为 ssl 终结器，并实现我的问题答案如下。如果有人觉得它有用，我决定更新它。

从我上面的查询：

我将如何实现将清漆配置为具有多个域的 ssl 终止的 dns 入口点？

=> 它的工作原理是我们需要让套接字监听 https/ nginx/pound/ 或其他任何可以读取 ssl 的东西。（我以前不太相信将这一点用作 ssl 终结器，但是我认为我很好，因为超出了那个级别，现在我计划将其设置为内部区域。

=> 是否有可能以某种方式配置清漆以接受所有连接并直接绕过 ssl 到网络服务器？（这样我就不必担心 ssl 支持的多个接口）

可以通过多个接口（如果您有多个域）来实现这一点。或者，如果您正在处理子域，则使用相同的界面。或者，您可以为所有需要 ssl 的页面创建一个安全页面（取决于权衡）

=> 或者用 443 终结器实现的任何标准方法？我决定使用 nginx 来使用 nginx 提供的那些功能（安全层中间）。

# http - 如何通过 HTTP 从多个位置下载单个文件？

> ID：15991983
> 
> 赞同：5
> 
> 时间：2013-04-13T19:29:58.087
> 
> 标签：http, curl, download, wget

我需要快速下载一个大文件，但我能找到的所有资源都限制了带宽。它们中的每一个似乎都支持 HTTP 1.1 字节服务（范围请求），因为我可以暂停和恢复下载。如何从多个来源并行下载它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T19:32:11.863

假设这是一个编程问题（假设这是 StackOverflow），我将解释如何而不是仅仅链接到利用这一点的下载加速器。

**在服务器方面需要什么来做到这一点？**

*   支持`Range`HTTP 标头的服务器。
*   允许并发连接的服务器。通过使用基于端点或 IP 的限制服务器端，可以支持`Range`同时不允许多个同时连接。出于这个原因，我建议您设置一个简单的测试服务器，而不是在测试时从文件共享站点下载。

**什么是`Range`标题？**

`Range`如果未设置标头，则通过 HTTP 传输的数据按从文件开头开始的顺序发送。服务器上文件的第一个字节将是 HTTP 响应的第一个字节，服务器上文件的最后一个字节将是 HTTP 响应的最后一个字节。标`Range`头允许您指定字节应该从哪里开始发送，允许您“跳过”响应的开头。

**实际答案示例**

*我们的情况*

响应是纯文本。响应内容只有一个字“StackOverflow！！” 编码 ASCII，意味着每个字符是一个字节。因此，`Content-Length`标头的值是 15[个八位字节](http://en.wikipedia.org/wiki/Octet_%28computing%29)（字节的另一个术语）。

我们将使用 3 个请求下载此文件。为了这个例子，我们会说它会快 3 倍，但你应该意识到这种方法会使非常小的文件的下载速度变慢。这是因为 HTTP 标头必须随每个请求以及 3 次握手一起发送。我们还将假设服务器支持 HEAD 请求，并且`Content-Length`标头与下载响应一起发送。最后，由于 HEAD 请求的原因，该请求将使用 GET 执行。但是，POST 有一些解决方法。

*多汁的细节*

首先，执行 HTTP HEAD 请求。取“Content-Length”标头并将该值除以您希望建立的并发并行连接的数量。对于这个例子，`Content-Length`是 15，我们希望建立 3 个连接，所以除以 5。

现在执行您希望并行执行的请求数量。对于每个请求，将`Range`标头设置为“范围：字节=”，然后是已经发出的请求数乘以上面找到的除值。然后附加“-”，后跟您刚刚确定的值加上除后的值。对于此示例，每个请求都应具有如下设置的标头。

1.  `Range: bytes=0-5`
2.  `Range: bytes=5-10`
3.  `Range: bytes=10-15`

每个请求的响应应该是

1.  堆
2.  超频
3.  低的！！

本质上，我们只是符合范围规范（[RFC 2616 的第 3.12 节](https://www.rfc-editor.org/rfc/rfc2616#section-3.12)）以及字节范围规范（RFC 2616 的第 14.35 节）。

最后，附加每个请求的字节以形成最终的响应数据。

免责声明：我从未真正尝试过这个，但它应该在理论上有效

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-17T23:02:29.497

如果从多个来源获取，我不能说是否`wget`能够再次将文件放在一起。

以下示例显示了如何使用`aria2c`.

您将构建一个下载描述文件，然后将其传递给 aria，如下所示：

```
aria2c -i uri.txt --split=5 --min-split-size=1M --max-connection-per-server=5 
```

哪里`uri.txt`可能包含

```
http://a.com/file1.iso http://mirror-1.com/file1.iso http://mirror-2.com/file1.iso
dir=/downloads
out=file1.iso 
```

这将从 3 个不同的位置获取相同的文件，并将其放入名为 file1.iso (out) 的下载文件夹 (dir) 中。

# c - 缓冲区输出缺少名字

> ID：15991985
> 
> 赞同：0
> 
> 时间：2013-04-13T19:30:07.737
> 
> 标签：c, file, memory-management, structure

嗨，我在将数据读入结构数组时遇到了这个问题，这就是我目前所拥有的：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_NAME   20
#define FILE_NAME  50
#define LIST_SIZE 50
//void getData(RECORD name[], RECORD score)

typedef struct 
{
    char *name;
    int  score;
}RECORD;

int main (void)
{
    // Declarations
       FILE *fp;
       char fileName[FILE_NAME];
       RECORD list[LIST_SIZE];
       char buffer[50];
       int count = 0;
    // Statements
       printf("Enter the file name: ");
       gets(fileName);

       fp = fopen(fileName, "r");

       if(fp == NULL)
           printf("Error cannot open the file!\n");
       while (fgets(buffer, LIST_SIZE, fp) != NULL)
         {   
                     printf("%s\n", buffer);
         list[count].name = (char*) calloc(strlen(buffer), sizeof(char));
         sscanf(buffer,"%s%d", list[count].name, &list[count].score);
         printf("name is: %s and score is:%d \n", list[count].name, list[count].score);
         count++;

         }
       printf("Read in %d data records\n", count);
       return 0;
} 
```

因此，当我尝试在没有分配名称的情况下打印出来时，在 while 循环内它似乎工作正常，但是在我为名称分配内存之后，缓冲区在打印时丢失了名字。所以我有这个输出

```
Enter the file name: in.txt
Ada Lovelace, 66

Torvalds, 75

Norton, 82

Thompson, 82

Wozniak, 79

Andreessen, 60

Knuth, 60

Goldberg, 71

Hopper, 82

Joy, 91

Tanenbaum, 71

Kernighan, 72
Read in 12 data records 
```

而不是正确的输出

```
Enter the file name: in.txt
Ada Lovelace, 66

Linus Torvalds, 75

Peter Norton, 82

Ken Thompson, 82

Steve Wozniak, 79

Marc Andreessen, 60

Donald Knuth, 60

Adele Goldberg, 71

Grace Hopper, 82

Bill Joy, 91

Andrew Tanenbaum, 71

Brian Kernighan, 72
Read in 12 data records 
```

这是我注释掉 fscanf 行后的输出，所以我认为那里可能会出现错误。内存分配过程是否有问题，我认为我做错了。

我现在修复了 fscanf 语句

```
Enter the file name: in.txt
Ada Lovelace, 66

name is: Ada and score is:3929744
Linus Torvalds, 75

name is: Linus and score is:3929752
Peter Norton, 82

name is: Peter and score is:3929760
Ken Thompson, 82

name is: Ken and score is:3929768
Steve Wozniak, 79

name is: Steve and score is:3929776
Marc Andreessen, 60

name is: Marc and score is:3929784
Donald Knuth, 60

name is: Donald and score is:3929792
Adele Goldberg, 71

name is: Adele and score is:3929800
Grace Hopper, 82

name is: Grace and score is:3929808
Bill Joy, 91

name is: Bill and score is:3929816
Andrew Tanenbaum, 71

name is: Andrew and score is:3929824
Brian Kernighan, 72
name is: Brian and score is:3929832
Read in 12 data records 
```

如您所见，行名是：只打印名字而不是姓氏和整数分数的地址。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:42:50.127

fgets 和 fscanf 相互争斗，因为它们都在从文件中读取。使用 fgets 从文件读取到缓冲区，然后使用 sscanf 将数据解析到结构中。

一般来说，您应该更喜欢 fgets 而不是 fscanf，因为它更安全。无论如何，不​​要混合使用 fgets 和 fscanf。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T21:49:27.400

试试这个：

```
...

while (fgets(buffer, LIST_SIZE, fp) != NULL)
{
    char *tok;
    printf("%s\n", buffer);

    tok = strchr(buffer, ',');
    if (!tok)
    {
        printf("Bad line\n");
        continue;
    }

    list[count].name = strndup(buffer, tok - buffer);
    list[count].score = atoi(tok + 1);

    printf("name is: %s and score is:%d \n", list[count].name, list[count].score);
    count++;
}
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:59:59.077

您的代码有几个问题。首先，如果您的输入文件中有特定模式，请尝试使用 scanf 和 fscanf。在使用 fgets 和 get 时，我遇到了换行符的问题。fscanf 也会读取直到找到空格字符或换行符（您是否在代码中考虑过这一点？因为很明显为什么它只读取一个名称段）。可能是您使用 printf 时遇到了同样的问题，它只写到 \n 或 ' '。如果您可以使用 C++，您可能想考虑使用 ifstream 和 sstream。

# ios - 我在 iMessage UIActivityViewController 中的应用

> ID：15991990
> 
> 赞同：5
> 
> 时间：2013-04-13T19:30:27.770
> 
> 标签：ios, imessage

当我在 iMessage 中打开附加图像并点击“共享”按钮时，我可以看到“Path”或“Evernote”等 3rd 方应用程序的图标。问题是：如何将我自己的应用程序添加到此列表中？

![在此处输入图像描述](https://i.stack.imgur.com/RbdLqm.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T10:35:13.170

您需要向应用程序添加文档类型，而不是 URL 方案。尝试将以下片段添加到您的`Info.plist`：

```
<key>CFBundleDocumentTypes</key>
<array>
    <dict>
        <key>CFBundleTypeName</key>
        <string>public.jpeg</string>
        <key>CFBundleTypeRole</key>
        <string>Editor</string>
        <key>LSHandlerRank</key>
        <string>Owner</string>
        <key>LSItemContentTypes</key>
        <array>
            <string>public.jpeg</string>
        </array>
    </dict>
</array> 
```

使用此片段（特别是带有`LSItemContentTypes`键），您可以声明您的应用程序是具有统一类型标识符 (UTI) 的文档的编辑器`public.jpeg`。因为这个 UTI 是由系统声明的，所以我相信你没有必要在你的应用程序的`Info.plist`.

[您可以在标题为System-Declared Uniform Type Identifiers](http://developer.apple.com/library/ios/#DOCUMENTATION/Miscellaneous/Reference/UTIRef/Articles/System-DeclaredUniformTypeIdentifiers.html)的 Apple 文档中找到所有系统声明的 UTI 。如果您是 UTI 的新手，您可能还应该阅读 Apple 文档[Uniform Type Identifier Concepts](http://developer.apple.com/library/ios/#DOCUMENTATION/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html)。

最后但并非最不重要的一点是，不要忘记查阅[信息属性列表键参考](https://developer.apple.com/library/mac/#documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html)以了解您应该为核心基础键`CFBundleTypeRole`和`LSHandlerRank`.

顺便说一句：[这个优秀的 SO 答案](https://stackoverflow.com/questions/2774343/how-do-i-associate-file-types-with-an-iphone-application/2781290#2781290)还包含有关使用 UTI 的详细信息，特别是如果您需要声明自己的应用程序特定的 UTI。

# ios - 如何检测平移手势何时真正快速移动，而不是精细移动，以相应地调整控制？

> ID：15991991
> 
> 赞同：3
> 
> 时间：2013-04-13T19:31:00.903
> 
> 标签：ios, objective-c, uigesturerecognizer, uipangesturerecognizer

在我的应用程序中，我可以选择让用户向上平移以调整控件，但是当他们真正快速平移时它会有点慢，我想跳得更多。

```
// If user is panning upwards or downwards, adjust WPM every 8 translations in either direction
if (translation.y<-8 || translation.y>8) {
    // Reset translation so we can see when it exceeds 8 again
    [recognizer setTranslation:CGPointMake(0, 0) inView:self.view];

    // Figure out direction, if pan down, decrease by 5, if up, increase by 5
    int sign = (translation.y > 0) ? -1 : 1;
    WPM = @([WPM intValue] + (sign * 5));

    if ([WPM intValue] >= 200 && [WPM intValue] <= 1500) {
        self.WPMLabel.text = [WPM stringValue];

        self.wordsPerMinute = WPM;

        [[NSUserDefaults standardUserDefaults] setObject:WPM forKey:@"WPM"];
    }
} 
```

我将如何改变它以考虑更快的加速？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-09T20:55:45.430

使用手势识别器上的速度属性。

[https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIPanGestureRecognizer_Class/Reference/Reference.html#//apple_ref/occ/instm/UIPanGestureRecognizer/velocityInView](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIPanGestureRecognizer_Class/Reference/Reference.html#//apple_ref/occ/instm/UIPanGestureRecognizer/velocityInView)：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T19:38:24.250

速度涉及时间。因此，每次您的代码运行时，您都需要在实例变量中保存事件的`timestamp`. 这样，*下次*代码运行时，您可以将翻译更改*和*经过的时间与上一次更改进行比较。

我要做的是尝试保存三个或四个以前的时间和三个或四个以前的位置在一个数组中，以便您可以采用移动平均值并抑制速度变化。

# javascript - 如果 && 在 Javascript 中，我可以使用简写执行多个语句吗？

> ID：15991993
> 
> 赞同：3
> 
> 时间：2013-04-13T19:31:09.810
> 
> 标签：javascript, if-statement, shorthand

```
var foo = true;

function doThis() {alert("do this");}
function doThat() {alert("do that");}

// fine
if(foo) {
    doThis();
    doThat();
}

// fine
foo && (doThis());

// NO, syntax error
foo && (doThis(); doThat();); 
```

这甚至可能吗？或者我根本不应该这样做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-13T19:33:46.797

是的，如果你用逗号分隔函数：

```
foo && (bar(), baz()) 
```

这是一种*糟糕*的编码实践，但它对于缩小代码或[代码高尔夫](http://codegolf.stackexchange.com)的目的很有用。

```
if (foo) {
    bar();
    baz();
} 
```

变成：

```
foo&&(bar(),baz()) 
```

和

```
if (!foo) {
    bar();
    baz();
} 
```

变成：

```
foo||(bar(),baz()) 
```

和

```
if (foo) {
    bar();
    baz();
} else {
    fizz();
    buzz();
} 
```

变成：

```
foo?(bar(),baz()):(fizz(),buzz()) 
```

尽管变量可能会在缩小器中重命名为：

```
a&&(b(),c()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T19:32:58.973

不能在表达式中间放置分号。

```
foo && (doThis() || doThat()); 
```

由于`doThis`没有返回值，它的评估如下：

```
true && (doThis() || doThat());
(doThis() || doThat());
(undefined || doThat());
(doThat());
undefined; 
```

但是正如@zzzzBov 所回答的那样，也可以使用[逗号运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)，并且在它不依赖于返回值的意义上更好。

请注意，这样的速记不是很易读，您应该让缩小工具来完成这种工作。（例如[闭包编译器](http://closure-compiler.appspot.com/home)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T19:35:37.717

您可以使用[逗号运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)：

```
foo && (doThis(), doThat()); 
```

当然，如果`doThis`返回一个`truthy`值，您也可以拥有：

```
foo && doThis() && doThat(); 
```

但这更像是；

```
if (foo)
    if (doThis())
        doThat(); 
```

但是，如果左侧没有赋值，通常不会使用这种“速记”，因为这会使代码更丑陋且可读性较差。

# opencv - 查找图片是否包含颗粒噪声

> ID：15991996
> 
> 赞同：2
> 
> 时间：2013-04-13T19:31:17.320
> 
> 标签：opencv, image-processing, noise

我正在尝试查找某张图片是否包含颗粒噪声。我有关于如何在电影中找到颗粒噪声的想法（将每一帧与前一帧进行比较），但我不知道在单帧中该做什么。我正在使用 OpenCV 和 Matlab。相框可以是任何普通的相机镜头。如果有人可以提供帮助，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:44:11.520

The Laplacian of Gaussian (LoG), or any other high order edge detection filter brings out grains in the image. I would first try applying the LoG on the image and look for strong solitary edge pixels i.e. pixels that show up with a high edge intensity, while all of the neighbours are non-edges. If you find many such solitary edge pixels, the original image might be grainy.

# php - AbstractType Proxies\__CG__\Far\MT\AccountBundle\Entity\Account 无法转换为 int

> ID：15991997
> 
> 赞同：0
> 
> 时间：2013-04-13T19:31:18.153
> 
> 标签：php, symfony, symfony-forms

```
class Accounts extends AbstractType
{
    private $em;

    private $accountrepo = null;

    private $choices = array();

    public function __construct()
    {
    }

    public function setAccountRepository($repo)
    {
        $this->accountrepo = $repo;
        return $this;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults([
        'choices' => $this->getChoices(),
        'attr' => [
                    'data-dojo-type' => 'dijit/form/FilteringSelect',
                    ],
            'data_class' => 'Far\MT\AccountBundle\Entity\Account'
        ]);
    }

    public function getParent()
    {
        return 'choice';
    }

    public function getName()
    {
        return 'Accounts';
    }

    public function getChoices()
    {
        if ( count($this->choices) > 0 ) {
            return $this->choices;
        }
        $this->choices[0] = "";
        foreach ($this->accountrepo->findAll() as $account) {
            $this->choices[$account->getId()] = $account->getName() . " (" .
            $account->getCurrency().") ";
        }
        return $this->choices;
    }

} 
```

使用上面的代码我得到了错误：

> 注意：类 Proxies__CG__\Far\MT\AccountBundle\Entity\Account 的对象无法在 /workspace/tools/vendorsymfony2/symfony/symfony/src/Symfony/Component/Form/Extension/Core/ChoiceList/ChoiceList 中转换为 int。第 457 行

这仅在我编辑记录时发生，我使用此类型具有 ChoiceList 类型，以便过滤 db 值并将其放置在“组合框”上。

关于我可能做错的任何建议？

**编辑**

```
use Doctrine\ORM\Mapping as ORM;

/**
 * Movement
 *
 * @ORM\Entity(repositoryClass="Far\MT\AccountBundle\Entity\MovementRepository")
 * @ORM\Table(name="movement")
 */
class Movement
{
    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var \Date
     *
     * @ORM\Column(name="date", type="date")
     */
    private $date;

    /**
     * @var string
     *
     * @ORM\ManyToOne(targetEntity="MovementType")
     * @ORM\JoinColumn(name="movementtype", referencedColumnName="id", unique=false)
     */
    private $Type;

    /**
     * @var float
     *
     * @ORM\Column(name="value", type="float")
     */
    private $value;

    /**
     * @var Account
     *
     * @ORM\ManyToOne(targetEntity="Account", cascade={"persist"})
     * @ORM\JoinColumn(name="fromaccount", referencedColumnName="id", unique=false)
     */
    private $fromAccount;

    /**
     * @var Account
     *
     * @ORM\ManyToOne(targetEntity="Account", cascade={"persist"})
     * @ORM\JoinColumn(name="toaccount", referencedColumnName="id", unique=false)
     */
    private $toAccount;

    /**
     * @var string
     *
     * @ORM\ManyToOne(targetEntity="ExpenseType", cascade={"persist"})
     * @ORM\JoinColumn(name="expensetype", referencedColumnName="id",
     * nullable=true, unique=false)
     */
    private $ExpenseType;

    /**
     * @var string
     *
     * @ORM\ManyToOne(targetEntity="Holder",  cascade={"persist"})
     * @ORM\JoinColumn(name="holder", referencedColumnName="id", unique=false)
     */
    private $orderHolder;

    /**
     * @var string
     *
     * @ORM\Column(name="description", type="string", length=254)
     */
    private $description;

    /**
     * @var float
     *
     * @ORM\Column(name="xrate", type="float", nullable=true)
     */
    private $xrate = null;

    public function getDescription()
    {
        return $this->description;
    }

     public function setDescription($description)
     {
        $this->description = $description;
        return $this;
     }
    /**
     * Get id
     *
     * @return integer
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set Account
     *
     * @param string $account
     * @return Movement
     */
    public function setAccount($account)
    {
        $this->Account = $account;

        return $this;
    }

    /**
     * Get Account
     *
     * @return string
     */
    public function getAccount()
    {
        return $this->Account;
    }

    /**
     * Set date
     *
     * @param \DateTime $date
     * @return Movement
     */
    public function setDate($date)
    {
        $this->date = $date;

        return $this;
    }

    /**
     * Get date
     *
     * @return \DateTime
     */
    public function getDate()
    {
        return $this->date;
    }

    /**
     * Set Type
     *
     * @param string $type
     * @return Movement
     */
    public function setType($type)
    {
        $this->Type = $type;

        return $this;
    }

    /**
     * Get Type
     *
     * @return string
     */
    public function getType()
    {
        return $this->Type;
    }

    /**
     * Set value
     *
     * @param float $value
     * @return Movement
     */
    public function setValue($value)
    {
        $this->value = $value;

        return $this;
    }

    /**
     * Get value
     *
     * @return float
     */
    public function getValue()
    {
        return $this->value;
    }

    /**
     * Set fromAccount
     *
     * @param string $fromAccount
     * @return Movement
     */
    public function setFromAccount($fromAccount)
    {
        $this->fromAccount = $fromAccount;

        return $this;
    }

    /**
     * Get fromAccount
     *
     * @return string
     */
    public function getFromAccount()
    {
        return $this->fromAccount;
    }

    /**
     * Set toAccount
     *
     * @param string $toAccount
     * @return Movement
     */
    public function setToAccount($toAccount)
    {
        $this->toAccount = $toAccount;

        return $this;
    }

    /**
     * Get toAccount
     *
     * @return string
     */
    public function getToAccount()
    {
        return $this->toAccount;
    }

    /**
     * Set ExpenseType
     *
     * @param string $expenseType
     * @return Movement
     */
    public function setExpenseType($expenseType)
    {
        $this->ExpenseType = $expenseType;

        return $this;
    }

    /**
     * Get ExpenseType
     *
     * @return string
     */
    public function getExpenseType()
    {
        return $this->ExpenseType;
    }

    /**
     * Set orderHolder
     *
     * @param string $orderHolder
     * @return Movement
     */
    public function setOrderHolder($orderHolder)
    {
        $this->orderHolder = $orderHolder;

        return $this;
    }

    /**
     * Get orderHolder
     *
     * @return string
     */
    public function getOrderHolder()
    {
        return $this->orderHolder;
    }

    /**
     * Set exchange rate for movement
     *
     * @param float $xrate
     */
    public function setXrate($xrate)
    {
        $this->xrate = (double)$xrate;
        return $this;
    }

    /**
     * Return movement exchange rate
     *
     * @return float
     */
    public function getXrate()
    {
        return $this->xrate;
    }
} 
```

**实体账户**

```
use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;

/**
 * Account
 *
 * @ORM\Table(name="account")
 *
 * @ORM\Entity(repositoryClass="Far\MT\AccountBundle\Entity\AccountRepository")
 */
class Account
{

    public function __construct()
    {
        $this->holders          = new ArrayCollection();
        $this->pocketAccounts   = new ArrayCollection();
    }

    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string
     *
     * @ORM\Column(name="code", type="string", length=40)
     */
    private $code;

    /**
     * @var string
     *
     * @ORM\Column(name="name", type="string", length=255)
     */
    private $name;

    /**
     * @var string
     *
     * @ORM\Column(name="currency", type="string", length=20)
     */
    private $currency;

    /**
     * @var Far\MT\AccountBundle\Entity\Holder
     *
     * @ORM\ManyToMany(targetEntity="Holder", inversedBy="Accounts")
     * @ORM\JoinTable(name="account_holder",
     * joinColumns={@ORM\JoinColumn(name="account_id", referencedColumnName="id")},
     * inverseJoinColumns={@ORM\JoinColumn(name="holder_id",
     * referencedColumnName="id")}
     * )
     *
     */
    private $holders;

    /**
     * @var Far\MT\AccountBundle\Entity\Account
     *
     * @ORM\OneToMany(targetEntity="Account", mappedBy="parentAccount")
     */
    private $pocketAccounts;
    /**
     *
     * @ORM\ManyToOne(targetEntity="Account", inversedBy="pocketAccounts", cascade={"persist"})
     * @ORM\JoinColumn(name="parent_id", referencedColumnName="id")
     */
    private $parentAccount;

    /**
     * Specifies the account type has string
     *
     * @var String
     *
     * @ORM\Column(name="accounttype", type="string", length=40)
     */
    private $accountType;

    /**
     * Total value of available money this should not account money that is
     * pending transaction
     *
     * @var double
     *
     * @ORM\Column(name="totalavailable", type="float")
     */
    private $totalAvailable = 0;

    /**
     * Total value of accounted money this takes into account money that has
     * pending transaction
     *
     * @var double
     *
     * @ORM\Column(name="totalaccounted", type="float")
     */
    private $totalAccounted = 0;

    /**
     * Get id
     *
     * @return integer
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set code
     *
     * @param string $code
     * @return Account
     */
    public function setCode($code)
    {
        $this->code = str_replace(" ", "", strtoupper(trim($code)));

        return $this;
    }

    /**
     * Get code
     *
     * @return string
     */
    public function getCode()
    {
        return $this->code;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return Account
     */
    public function setName($name)
    {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set currency
     *
     * @param string $currency
     * @return Account
     */
    public function setCurrency($currency)
    {
        $this->currency = $currency;

        return $this;
    }

    /**
     * Get currency
     *
     * @return string
     */
    public function getCurrency()
    {
        return $this->currency;
    }

    /**
     * Set holders
     *
     * @param null|Doctrine\Common\Collections\ArrayCollection $holders
     * @return Account
     */
    public function setHolders($holders)
    {
        if ($holders === null) {
            $this->holders = new ArrayCollection();
        } else {
            $this->holders = $holders;
        }

        return $this;
    }

    /**
     * Get holders
     *
     * @return string
     */
    public function getHolders()
    {
        return $this->holders;
    }
    /**
     *
     * Get Pocket accounts
     *
     * @return \Doctrine\Common\Collections\ArrayCollection()
     */
    public function getPocketAccounts()
    {
        return $this->pocketAccounts;
    }

    public function setPocketAccounts($PocketAccounts)
    {
        $this->pocketAccounts = $PocketAccounts;
        return $this;
    }

    /**
     * Get Parent Account
     *
     * @return \Far\MT\AccountBundle\Entity\Account
     *
     */
    public function getParentAccount()
    {
        return $this->parentAccount;
    }

    public function setParentAccount($ParentAccount)
    {
        $this->parentAccount = ($ParentAccount);
        return $this;
    }
    /**
     * does this account has a parent
     *
     * @return boolean
     */
    public function hasParentAccount()
    {
        return ($this->parentAccount !== null);
    }

    public function setAccountType($accountType)
    {
        $this->accountType = $accountType;
        return $this;
    }

    public function getAccountType()
    {
        return $this->accountType;
    }

    public function getTotalAccounted()
    {
        return $this->totalAccounted;
    }

    public function setTotalAccounted($total)
    {
        $this->totalAccounted = $total;
        return $this;
    }

    public function getTotalAvailable()
    {
        return $this->totalAvailable;
    }

    public function setTotalAvailable($total)
    {
        $this->totalAvailable = $total;
        return $this;
    }

    public function __toString()
    {

        return 'Account';
    }
} 
```

**请注意，更新的是运动实体女巫包含 fromAccount 和 toAccount 中的帐户。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T23:18:19.877

不知道他向我指出我不理解 data_class 参数的答案。

```
 'data_class' => 'Far\MT\AccountBundle\Entity\Account' 
```

> 18:37 < ocramius> netcrash：不，抱歉，帮不上忙，因为我不知道 data_class 做什么（不是 sf2 表单用户）

我错过了一个数据转换器，data_class（指定实体正在工作，不确定原因......），我放置了一个 DataTransformer，它解决了这个问题。见下文。

```
use Far\MT\AccountBundle\Form\DataTransformer\AccountToIdTransformer;
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Doctrine\Common\Persistence\ObjectManager;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class Accounts extends AbstractType
{
    /**
     *
     * @var EntityManager
     */
    private $em;

    private $accountrepo = null;

    private $choices = array();

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        parent::buildForm($builder, $options);
        $transformer = new AccountToIdTransformer($this->em);
        $builder->addModelTransformer($transformer);
    }

    public function setAccountRepository($repo)
    {
        $this->accountrepo = $repo;
        return $this;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults([
        'choices' => $this->getChoices(),
        'attr' => [
                    'data-dojo-type' => 'dijit/form/FilteringSelect',
                    ]
        ]);
    }

    public function getParent()
    {
        return 'choice';
    }

    public function getName()
    {
        return 'Accounts';
    }

    public function getChoices()
    {
        if ( count($this->choices) > 0 ) {
            return $this->choices;
        }
        $this->choices[0] = "";
        foreach ($this->accountrepo->findAll() as $account) {
            $this->choices[$account->getId()] = $account->getName() . " (" .
            $account->getCurrency().") ";
        }
        return $this->choices;
    }

} 
```

和数据转换器：

```
/**
 * This is a transformer for the Account AbstractType
 *
 * @link http://symfony.com/doc/master/cookbook/form/data_transformers.html
 *
 * @author andref
 */
class AccountToIdTransformer implements DataTransformerInterface
{
    /**
     * @var ObjectManager
     */
    private $om;

    /**
     *
     * @param ObjectManager $om
     */
    public function __construct($om)
    {
        $this->om = $om;
    }
    /**
     * Transforms an object (issue) to a int (Id).
     *
     * @param  Account|null $account
     * @return string
     */
    public function transform($account)
    {
        if (null === $account) {
            return "";
        }

        return $account->getId();
    }

    /**
     * Transforms a int (Id) to an object (Account).
     *
     * @param  int $Id
     *
     * @return Account|null
     *
     * @throws TransformationFailedException if object (Account) is not found.
     */
    public function reverseTransform($id)
    {
        if (!$id) {
            return null;
        }

        $Account = $this->om
            ->getRepository('FarMTAccountBundle:Account')
            ->findOneBy(array('id' => $id))
        ;

        if (null === $Account) {
            throw new TransformationFailedException(sprintf(
                'An Account with Id "%s" does not exist!',
                $id
            ));
        }

        return $Account;
    }
} 
```