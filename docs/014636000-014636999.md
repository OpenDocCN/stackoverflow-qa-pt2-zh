# StackOverflow 问答 14636000-14636999

# c++ - 一个类可以同时继承抽象类和 CRTP 类吗？

> ID：14636001
> 
> 赞同：0
> 
> 时间：2013-01-31T22:03:51.940
> 
> 标签：c++, templates, inheritance, abstract-class, crtp

一个类可以同时继承抽象类和 CRTP 类吗？或者，如果我从 CRTP 类继承，我继承的所有类都必须使用 CRTP？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:07:29.920

> 一个类可以同时继承抽象类和 CRTP 类吗？

为什么不？是的，它可以。

> 或者，如果我从 CRTP 类继承，我继承的所有类都必须使用 CRTP？

为什么这样？不，他们不必这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:28:28.030

是的。

```
class AbstractBase {
public:
  virtual ~AbstractBase() {}
  virtual void Function() =  0;
};

template<class T>
class CRTPBase {
public:
  void Function2() {}
};

class Derived : public AbstractBase, public CRTPBase<Derived> {
public:
  void Function() {}
};

int main () {
  Derived d;
  d.Function();
  d.Function2();
} 
```

# c++ - 子字符串输出不符合预期？

> ID：14636002
> 
> 赞同：0
> 
> 时间：2013-01-31T22:04:11.327
> 
> 标签：c++, string, algorithm, substring

小问题。使用我从文本文件转换的字符串：

```
std::string content((std::istreambuf_iterator<char>(istr) ), 
                        (std::istreambuf_iterator<char>() ) ); 
```

打印时看起来像：

```
@....@........@......@....................@....@...............@..........@..@......
@....@..@@@...@......@.......@@@..........@....@..@@@....@@@...@..........@..@......
@@@@@@.@...@..@......@......@...@.........@....@.@...@..@......@.......@@@@..@......
@....@.@@@@...@......@......@...@.........@....@.@...@..@......@......@...@..@......
@....@.@......@......@......@...@.........@.@@.@.@...@..@......@......@...@.........
@....@..@@@@...@@.....@@.....@@@...........@..@...@@@...@.......@@.....@@@@..@......
.................................................................................... 
```

然而，当我在这里使用此代码时：

```
 for (int i = 0; i < (content.length()-6); i++){
        std::string w = content.substr(i, 6);
        std::cout << w << '\n';
    } 
```

我得到了很多我想要的子字符串，但它们看起来不像我预期的那样。我的意图是有一些看起来像这样的东西（作为第一行的例子）：

```
@....@
......
..@...
...@..
......
......
......
@....@
......
......
...@..
......
..@..@
...... 
```

相反，我遵循以下原则：

```
@....@
....@.
...@..
..@...
.@....
@.....
......
......
......
.....@
....@.
...@..
..@...
.@.... 
```

我不确定为什么会这样，也许我认为 substr 做了一些它没有做的事情？我只想获取第一行的前 6 个字母，然后是下一个 6，然后是下一个，依此类推，继续到字符串的第二行。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:08:33.370

我实际上并不了解 C++，但是当您尝试制作子字符串 (0, 5) 然后是 (1, 6) 然后是 (2, 7) 等时，看起来您正在制作子字符串(6, 11) 然后 (12, 17)。

尝试`i`每次增加 6 而不是 1。所以新的代码是

```
for (int i = 0; i < (content.length()-6); i += 6){
        std::string w = content.substr(i, 6);
        std::cout << w << '\n';
    } 
```

在您的示例中被转移的 @ 每次都是相同的 @，因为您只是在移动一个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:08:53.530

尝试`i += 6`而不是`i++`在你的 for 循环中。

# javascript - Imperavi Redactor 内容未复制到隐藏的文本区域

> ID：14636003
> 
> 赞同：2
> 
> 时间：2013-01-31T22:04:12.593
> 
> 标签：javascript, html, ruby-on-rails-3, textarea, redactor

我在这里尝试使用[Imperavi Redactor](http://imperavi.com/redactor/)控件进行富文本编辑：

```
<div class="control-group">
  <%= f.label :description %>
  <div class="controls">
    <%= f.text_area :description, :class => "richtext" %>
  </div>
</div>

$(document).ready(function(){
    $('.richtext').redactor();
}); 
```

富文本编辑器出现并且工作正常，但是当我输入内容时，我可以使用 Google Chrome 中的检查元素看到 html 标记没有被复制到隐藏的文本区域。看：

```
<div class="controls">
    //Removed toolbar for brevity.
    <div class="redactor_box">
        <div class="redactor_richtext redactor_editor" contenteditable="true" dir="ltr"><p>asdfjoiasjdf</p><p>dfjiasdfjiasd</p><p>idsfj</p><p>asdffaas</p></div>
    </div>

    <textarea class="richtext" cols="40" id="program_description" name="program[description]" rows="20" style="display: none;"></textarea></div>
</div> 
```

当对此文本区域进行表单 POST 时，服务器显然看不到任何内容，因为文本区域是空白的。

关于如何将丰富的 html 复制到 textarea 的任何建议？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:10:58.997

尝试内置功能`$().syncCode()`

```
syncCode: function()
{
    var html = this.formatting(this.$editor.html());
    this.$el.val(html);         
} 
```

或者`$().setCode()`

```
setCode: function(html)
{
    html = this.preformater(html);

    this.$editor.html(html).focus();

    this.syncCode();
}, 
```

# java - Java VM 内存性能 - 数组写入比数组读取快吗？

> ID：14636004
> 
> 赞同：12
> 
> 时间：2013-01-31T22:04:26.533
> 
> 标签：java, performance, memory

我在 java 中的一个长数组上执行了一个简短的基准测试，结果非常奇怪。似乎带有随机写入的顺序读取比带有顺序写入的随机读取要快 - 一半的时间。有没有人知道为什么？

以下是两种方法，它们在顺序读取时随机写入一些 long 数组（使用 -Xmx2G 左右运行），在随机写入时顺序读取：

```
import java.util.Random;

public class Scratch {
static Random random = new Random();
static long[] arr = new long[100000000];

static void seqReadRandWrite() {
    for(int i=0;i<arr.length;i++) {
        int at = random.nextInt(arr.length);
        arr[at] = arr[i];
    }
}

static void seqWriteRandRead() {
    for(int i=0;i<arr.length;i++) {
        int at = random.nextInt(arr.length);
        arr[i] = arr[at];
    }
}

public static void main(String[] args) throws Exception {

    seqWriteRandRead(); // warm up

    long nanos = System.nanoTime();
    seqReadRandWrite();
    System.out.println("Time: " + (System.nanoTime()-nanos) + "ns");

    nanos = System.nanoTime();
    seqWriteRandRead();
    System.out.println("Time: " + (System.nanoTime()-nanos) + "ns");

}
} 
```

我笔记本上的结果是

时间：2774662168ns

时间：6059499068ns

这意味着随机写入的速度是读取速度的两倍。或者？我的笔记本坏了吗？

ps.：这并不声称是基准，尽管有关基准测试的链接建议中的大部分要点都已涵盖。即使我多次运行已经 200,000,000 次操作，结果仍然保持不变。似乎（似乎！）将内存从随机位置移动到顺序块比将内存从顺序位置移动到随机块慢，至少在这种大小的内存和上述执行方式的情况下。我想知道为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:12:10.023

您的基准测试产生的数字未能通过“它们有意义吗？” 测试。在这种情况下，您应该始终双重/三重/四重检查您的方法……在将数字视为现实的真实反映之前。

编写可靠的基准测试很困难。而在 Java 的情况下，这*尤其*困难，因为 Java 平台的某些方面可能会在您的基准测量中引入系统性失真……除非您特别允许/补偿它们。

但是“检查你的方法”规则适用于所有实验……尤其是那些产生似乎没有意义的结果的实验​​。（就像中微子比光速更快......）

* * *

另一件需要注意的事情是，一旦你重写了基准以考虑混杂因素，你可能*仍然*会看到意想不到的数字。这里的问题是，像这样的基准测试的性能可能对 L1 和 L2 缓存的大小、缓存行的大小、不同内存级别的相对速度……以及它们与基准在紧密循环中产生的指令。

这些事情很复杂，难以分析，并且会产生违反直觉的行为。（对我来说）不同的机器给出不同的测量性能并不奇怪。

因此，即使这些数字是真实的，从这个基准测试**中得出关于读写速度的任何一般性结论仍然是不安全的。**即使您将它们限制在您的笔记本电脑上，也不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:42:06.853

总而言之，问题标题略有错误。事实似乎是**在某些环境（例如我的和 OP 的）随机数组写入比随机数组读取更快**。但请注意，对于其他一些人来说，情况并非如此。

根据@JustinKSU 的[评论](https://stackoverflow.com/questions/14636004/java-vm-are-array-writes-faster-than-array-reads#comment20446375_14636004)，我将读取和写入分开，发现随机写入比随机读取更快。结果如下。这似乎是原因，这里的集体意见似乎是缓存上的读取未命中比写入未命中更昂贵（如果写入中涉及任何缓存）。

在生产中，虽然有其他活动，但热点可能会发挥作用。

```
/cygdrive/c/Java/jdk1.7.0/bin/javac.exe Scratch.java && /cygdrive/c/Java/jdk1.7.0/bin/java Scratch
Starting
seqRead: 1273719725ns
seqRead: 1243055271ns
seqRead: 1245022497ns
seqRead: 1242868527ns
seqRead: 1241655611ns
randRead: 6900959912ns
randRead: 6965196004ns
randRead: 7379623094ns
randRead: 7020390995ns
randRead: 6938997617ns
seqWrite: 1266963940ns
seqWrite: 1250599487ns
seqWrite: 1246471685ns
seqWrite: 1230472648ns
seqWrite: 1246975416ns
randWrite: 3898382192ns
randWrite: 3897441137ns
randWrite: 3939947844ns
randWrite: 4207906037ns
randWrite: 4103594207ns

Compilation finished at Thu Jan 31 14:38:57 
```

我修改后的代码如下：

```
import java.util.Random;

public class Scratch {
static Random random = new Random();
static long[] arr = new long[100000000];

static void seqReadRandWrite() {
    for(int i=0;i<arr.length;i++) {
        int at = Math.abs(random.nextInt() % arr.length);
        arr[at] = arr[i];
    }
}

static void seqWriteRandRead() {
    for(int i=0;i<arr.length;i++) {
        int at = Math.abs(random.nextInt() % arr.length);
        arr[i] = arr[at];
    }
}

static void seqRead() {
    int x = 0;
    for(int i=0;i<arr.length;i++) {
        int at = Math.abs(random.nextInt() % arr.length);
        x += arr[i];
    }
}

static void randRead() {
    int x = 0;
    for(int i=0;i<arr.length;i++) {
        int at = Math.abs(random.nextInt() % arr.length);
        x += arr[at];
    }
}

static void seqWrite() {
    for(int i=0;i<arr.length;i++) {
        int at = Math.abs(random.nextInt() % arr.length);
        arr[i] = at;
    }
}

static void randWrite() {
    for(int i=0;i<arr.length;i++) {
        int at = Math.abs(random.nextInt() % arr.length);
        arr[at] = at;
    }
}

public static void main(String[] args) throws Exception {

    // seqWriteRandRead(); // warm up
    System.out.println("Starting");

    long nanos =  -1;
    /*
    for (int i = 0; i < 5; i++) {       
        nanos = System.nanoTime();
        seqWriteRandRead();
        System.out.println("WriteRandRead Time: " + (System.nanoTime()-nanos) + "ns");

        nanos = System.nanoTime();
        seqReadRandWrite();
        System.out.println("ReadRandWrite Time: " + (System.nanoTime()-nanos) + "ns");
    }
    */

    for (int i = 0; i < 5; i++) {       
        nanos = System.nanoTime();
        seqRead();
        System.out.println("seqRead: " + (System.nanoTime()-nanos) + "ns");
    }

    for (int i = 0; i < 5; i++) {       
        nanos = System.nanoTime();
        randRead();
        System.out.println("randRead: " + (System.nanoTime()-nanos) + "ns");
    }

    for (int i = 0; i < 5; i++) {       
        nanos = System.nanoTime();
        seqWrite();
        System.out.println("seqWrite: " + (System.nanoTime()-nanos) + "ns");
    }

    for (int i = 0; i < 5; i++) {       
        nanos = System.nanoTime();
        randWrite();
        System.out.println("randWrite: " + (System.nanoTime()-nanos) + "ns");
    }

}
} 
```

**更新**

@tomcarchrae 在 Linux 上进行了相同的测试，结果明显不同。下面，第一列是我测试的数字，第二列是汤姆的：

```
seqRead:   1273719725ns   2810487542ns  
seqRead:   1243055271ns   2780504580ns  
seqRead:   1245022497ns   2746663894ns  
seqRead:   1242868527ns   2746094469ns  
seqRead:   1241655611ns   2763107970ns  
randRead:  6900959912ns   23093543703ns 
randRead:  6965196004ns   22458781637ns 
randRead:  7379623094ns   24421031646ns 
randRead:  7020390995ns   25880250599ns 
randRead:  6938997617ns   26873823898ns 
seqWrite:  1266963940ns   4226886722ns  
seqWrite:  1250599487ns   4537680602ns  
seqWrite:  1246471685ns   3880372295ns  
seqWrite:  1230472648ns   4160499114ns  
seqWrite:  1246975416ns   4008607447ns  
randWrite: 3898382192ns   25985349107ns 
randWrite: 3897441137ns   22259835568ns 
randWrite: 3939947844ns   22556465742ns 
randWrite: 4207906037ns   22143959163ns 
randWrite: 4103594207ns   21737397817ns 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T22:52:37.107

我相信这个基准对你来说完全没用。有很多测量参数需要考虑，你没有描述，你解决这个问题的方式，完全没有描述。要对有关 VM、计算机、RAM 速度、您同时处理的软件、您复制的对象类型或简单内容等方面的实现速度做出任何结论，您必须了解一种有条不紊的方法。这个问题无法回答。您必须缩小您想了解速度的具体情况。

尤其是在使用随机数时，您无法得出任何结论。这大大增加了最佳、最坏或平均情况复杂性的问题。

请检查算法的复杂性，然后继续搜索如何进行科学的运行时性能测量。我希望我能帮助你一点。

第一个答案很棒，可以帮助您理解。[如何在 Java 中编写正确的微基准测试？](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java)

此致，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-18T10:07:36.187

答案在之前的评论中，归结为内存访问模式的影响。这篇博文介绍了随机读取[的](http://mechanical-sympathy.blogspot.co.uk/2012/08/memory-access-patterns-are-important.html)影响。写入不会受到类似的影响。

这不是 Java 问题（或者实际上是任何语言问题），而是您在其上运行的硬件的现实（并且是常见的现实）。这并不意味着您应该忽略它！尽管您最初的基准测试可能存在缺陷，但它仍然对某些软件造成了真正的问题，因此这是一个宝贵的教训。

结论并不是读取比写入更昂贵。硬件不能很好地满足随机内存访问的需求。这基本上就是为什么 LinkedList 的性能在顺序访问方面比 ArrayList 差得多，它们都具有相同的计算复杂度，但数组访问发挥了链表所没有的硬件强度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T22:42:35.457

你的实验坏了，不是你的笔记本电脑。请参阅此处的讨论和一些有助于衡量性能的工具： [Java 性能计时库](https://stackoverflow.com/questions/1237181/java-performance-timing-library)

以下是一些与您的结果相关的结果。我还修改了您的代码，使其在测量方式上更加严格和谨慎。

* * *

我的环境是使用 Sun JDK 1.6.0_38 的 Linux（基于 Ubuntu 12.10 的 Mint 14）

以1.5G的堆为例，即-Xmx1512

* * *

注：有趣。可能是我的结果不同，因为下面的数组大小不同。将重新运行和更新。

不：结果相似，平均值没有太大差异。但有趣的是与短期的差异，即 21092.5 (/10 = 2109.2) 与 1645.2 可能由于内存分页而变慢。

结果`static long[] arr = new long[100000000];`（有问题的原始数组大小）

> 写入：DescriptiveStatistics：n：10 分钟：20893.0 最大值：22190.0 平均值：21092.5 标准开发：390.90727800848117 中值：20953.5 偏度：3.0092198852491543 峰度：9.264808973899097
> 
> 阅读：DescriptiveStatistics：n：10 分钟：21668.0 最大值：22736.0 平均值：21892.5 标准开发：318.31509546359877 中值：21766.5 偏度：2.5034216544466124 峰度：6.560838306717343

* * *

我没有看到读取与写入的巨大差异。我将实验更改为在一个稍小的阵列上测量 10 次（结果是相同的读/写次数）。随意使用更大的数组或样本大小重新运行。

> 写入：DescriptiveStatistics：n：10 分钟：1584.0 最大值：1799.0 平均值：1645.2 标准开发：59.51619760853156 中值：1634.5 偏度：2.137918517160786 峰度：5.764166551997385
> 
> 阅读：DescriptiveStatistics：n：10 分钟：1568.0 最大值：2202.0 平均值：1689.0 标准开发：186.93908693000031 中值：1623.0 偏度：2.770215113912315 峰度：8.12245132320571

这是您的代码的修改版本，其中包含更多示例：

```
import java.util.Random;

import org.apache.commons.lang.time.StopWatch;
import org.apache.commons.math.stat.descriptive.DescriptiveStatistics;

public class Test {
    static Random random = new Random();
//  static long[] arr = new long[100000000];
    static long[] arr = new long[10000000];

    static void seqReadRandWrite() {
        for (int i = 0; i < arr.length; i++) {
            int at = Math.abs(random.nextInt()) % arr.length;
            arr[at] = arr[i];
        }
    }

    static void seqWriteRandRead() {
        for (int i = 0; i < arr.length; i++) {
            int at = Math.abs(random.nextInt()) % arr.length;
            arr[i] = arr[at];
        }
    }

    public static void main(String[] args) throws Exception {

        StopWatch timer = new StopWatch();
        int count = 10;

        // warm up
        for (int i=0; i<3; i++){
            seqReadRandWrite();
        }
        DescriptiveStatistics write = new DescriptiveStatistics();
        for (int i=0; i<count; i++){
            timer.reset();
            timer.start();
            seqReadRandWrite();
            timer.stop();
            write.addValue(timer.getTime());
        }
        System.out.println("Write: " + write);

        // warm up
        for (int i=0; i<3; i++){
            seqWriteRandRead(); 
        }
        DescriptiveStatistics read = new DescriptiveStatistics();
        for (int i=0; i<count; i++){
            timer.reset();
            timer.start();
            seqWriteRandRead();
            timer.stop();
            read.addValue(timer.getTime());
        }

        System.out.println("Read: " + read);

    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-31T22:59:41.943

我的电脑上的结果：（ns per r/w）

```
seq read :     1.4 
rnd read :   10x.x   
seq write:     3.3 
rnd write:   10x.x 
```

seqReadRandWrite 和 seqWriteRandRead 在每个循环 100ns 时同样快。

所以这可能取决于硬件。还有VM设置。试试看`java -server`速度是否有所提高。

# ruby-on-rails - 大礼包 i18n 问题

> ID：14636006
> 
> 赞同：1
> 
> 时间：2013-01-31T22:04:30.087
> 
> 标签：ruby-on-rails, ruby-on-rails-3, spree

我有一个 Rails 电子商务网站运行 spree 和意大利 i18n 通过这些宝石

```
gem 'spree_i18n'
gem 'rails-i18n' 
```

在管理界面中，当我从日历中选择某个产品的“可用”日期时，它在保存后就可以正常工作，但是一旦我重新编辑该产品，“可用”字段就会像这样填充：

```
<span class="translation_missing" title="translation missing: it.spree.date_picker.format">Format</span> 
```

当然，对该产品的任何进一步节省都将导致该产品不可用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T07:42:07.783

这可能与此日期选择器本地化更改有关：[https ://github.com/spree/spree/pull/2220](https://github.com/spree/spree/pull/2220)

尝试更新或将以下内容添加到您的 it.yml 本地化文件

```
 spree:    
     date_picker:
      format: ! '%m/%d/%Y'
      js_format: 'mm/dd/yy' 
```

# c - 关于 C 中 scanf() 的一些问题

> ID：14636022
> 
> 赞同：2
> 
> 时间：2013-01-31T22:05:24.553
> 
> 标签：c, scanf

我编写了这个测试程序来获取 scanf() 函数的返回值。

但是在测试中，如果我输入一个整数，程序是正常的，但是当我输入一个字符串时，它会进入一个无限循环。谁能解释其中的原因？

另一件事是转义字符 \0 代表 ascii 代码 0？当我打印“\12”时，我会得到一个新行，但是当我打印“\9”时，我无法得到一个“TAB”（TAB 的 ascii 代码是 9）。

```
#include <stdio.h>

int main(void){
    int x;
    int temp;
    //printf("\13");
    for(;;){
        temp=scanf("%d",&x);
        printf("%i",temp);
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:11:05.893

当输入与格式说明符不匹配时， scanf() 不会丢弃导致无限循环的输入。

```
 for(;;){
        temp=scanf("%d",&x);
      if(temp == 0) { // Input failure
          perror("invalid input");
          break;
       }
        printf("%i",temp);
    } 
```

如果即使在输入无效后仍想继续循环，则您已读取输入并自行刷新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:07:17.773

你说`scanf`要读取一个整数。如果您输入字符串，`scanf`则将等待整数输入。`scanf`也不会清除输入，因此它会一遍又一遍地读取相同的内容。您应该检查`temp`它成功读取某些内容时的值，它将返回成功读取的计数。在你的字符串输入的情况下，它应该返回 0。

此外，根据您的输出位置和使用选项卡输出的外壳，可能会或可能不会忽略或解释不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T22:10:51.153

当`scanf`无法读取您在格式字符串中询问的内容时，它只会将数据留在输入流中，下次它会再次读取它，再次失败，依此类推，直到永远。你应该清空你的输入。

此外，根据标准，您不应依赖 ASCII。但是，是的，`'\0'`是空字符，您应该使用`'\t'`硬编码的 ASCII 值来代替。

# iphone - 了解 Instruments 中的僵尸踪迹

> ID：14636028
> 
> 赞同：0
> 
> 时间：2013-01-31T22:05:46.840
> 
> 标签：iphone, ios, instruments, nszombie, zombie-process

我是 ios 开发的新手，我的应用程序由于 EXEC_BAD_ACCESS 而崩溃。为了检测问题，我在 xCode 4.5 中使用 Instruments 启用了 Zombies 并跟踪 Allocations 在它检测到 Zombie Messaged 后，我很难找到代码崩溃的哪一部分。

这是仪器屏幕截图： ![在此处输入图像描述](../Images/e3d46c3e24ea7b0dac73d08759cdbc01.png) 感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:11:45.367

看看你的代码会很有趣吗？您可能正在运行一些导致内存泄漏或访问错误的任务，例如；在后台线程中调用一些与 UI 相关的任务。最近在 IOS6 中出现了用 call 显示警报的问题`[alert show];`，如果你有类似的情况，那么你可以用这样的方式替换这个 show 方法。

```
[alert performSelectorOnMainThread:@selector(show) withObject:nil waitUntilDone:YES]; 
```

如果这不是问题，那么您可能会显示您的代码，并且有人可以通过这种方式更好地帮助您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-10T18:25:17.533

我在开始学习仪器时也遇到了问题，然后我发现我必须打开“扩展详细信息”窗格才能看到它。（可能还有其他简单的方法可以启用它，但我还没有找到）

![如何使用 Zombie 工具查找哪行代码崩溃](../Images/39e41a20a69684da37f62e68ca119a56.png)

# sql-server - 如何在 T-SQL 中使用 case 语句进行日期比较（> 或 <）？

> ID：14636029
> 
> 赞同：1
> 
> 时间：2013-01-31T22:05:56.570
> 
> 标签：sql-server, tsql, case

我在 case 语句中的大于运算符上遇到错误。我在这里想念什么？

```
DECLARE @ODS_LOAN_MAXDATE DATE, @MAX_MAINTENANCE DATE, @MAX_TRANS DATE, @ODS_LOAN_Count int 

SELECT @MAX_MAINTENANCE = MAX(DATE_MAINTENANCE_LAST) FROM FISERV_ODS..LOAN_MASTER_FILE
SELECT @MAX_TRANS = MAX(DATE_TRANS_LAST) FROM FISERV_ODS..LOAN_MASTER_FILE

SELECT CASE @ODS_LOAN_MAXDATE
    WHEN @MAX_MAINTENANCE > @MAX_TRANS
        THEN @MAX_MAINTENANCE
    ELSE @MAX_TRANS 
END 
FROM FISERV_ODS..LOAN_MASTER_FILE 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:10:05.043

语法应该是：

```
SELECT CASE WHEN @MAX_MAINTENANCE > @MAX_TRANS
        THEN @MAX_MAINTENANCE
    ELSE @MAX_TRANS 
END 
```

# c# - 读取 Active Directory ACE

> ID：14636034
> 
> 赞同：2
> 
> 时间：2013-01-31T22:06:11.763
> 
> 标签：c#, active-directory

我正在尝试阅读 AD ACE。问题是，我可以看到权限、继承等，但 ObjectType（ACE 的名称是 GUID 格式）。我正在尝试获取 ObjectType 的友好名称。这是我的代码

```
System.DirectoryServices.DirectoryEntry userEntry = new DirectoryEntry("LDAP://xx");

System.Security.AccessControl.AuthorizationRuleCollection rules = userEntry.ObjectSecurity.GetAccessRules(true, true, typeof(System.Security.Principal.SecurityIdentifier));

foreach (System.Security.AccessControl.AuthorizationRule rule in rules)
{
   System.DirectoryServices.ActiveDirectoryAccessRule oar = rule as System.DirectoryServices.ActiveDirectoryAccessRule;
   Console.WriteLine(oar.ObjectType.ToString()); //GUID
   ....                     
} 
```

请建议我如何获取对象名称，或者我应该使用不同的 API。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T13:44:28.910

必须对“ldapDisplayName”属性的架构和配置进行另一个查询

```
 public static string GetNameForGuidasd(string objectGuid, string targetAttribute, string propertyToQuery, DirectoryEntry searchRoot)
        {
            DirectoryEntry schemaContainer = new DirectoryEntry("LDAP://cn=schema,cn=configuration,DC=xx,DC=xx");
            string attributeName = null;
            DirectorySearcher searcher = new DirectorySearcher(schemaContainer);
            searcher.SearchScope = SearchScope.OneLevel;
            string filter = String.Format("(&({0}={1}))", propertyToQuery, BuildFilterOctetString(objectGuid));
            searcher.Filter = filter;
            using (searcher)
            {
                var result = searcher.FindOne();
                if (result != null)
                {
                    attributeName = (string)result.Properties[targetAttribute][0];
                }
            }
        }

        private static string BuildFilterOctetString(string objectGuid)
        {
            System.Guid guid = new Guid(objectGuid);
            byte[] byteGuid = guid.ToByteArray();
            string queryGuid = "";
            foreach (byte b in byteGuid)
            {
                queryGuid += @"\" + b.ToString("x2");
            }
            return queryGuid; 
        } 
```

# android - 每秒限制帧数

> ID：14636035
> 
> 赞同：-1
> 
> 时间：2013-01-31T22:06:28.143
> 
> 标签：android, screen, frame-rate, timedelta

大家好，我正在尝试使用以下代码将我的 FPS 限制为 30，但我不确定它是否有效。

```
while (runthread){

            c = null;
            timestart = System.currentTimeMillis();                         //Get time at start of loop for FPS calc

            try{
            c=mySurfaceHolder.lockCanvas();                                 //Set c (Canvas) to locked

            synchronized(mySurfaceHolder){
            framesskipped = 0;                                              // resetting frames skipped (as this is about to render to the screen, the frames skipped variable is only incremented when the onDraw() method is skipped, once it's run, reset it back to 0 for the next count
            doDraw(c);                                                      //Draw game world
            updateMenu();  //Update game logic

            }
            }
            finally{
                if (c != null){

                mySurfaceHolder.unlockCanvasAndPost(c);                     //Unlock and post

                }
            }

            //work out timings

                timeend = System.currentTimeMillis();                       //get end time for current frame (for FPS) 
                frametime = timeend-timestart;                              //Set the frametime variable to the time the frame took to render & update (end time - start time)
                sleepfor = (int) (30.3030303030303-frametime);              // this is the time that the thread will sleep for if <target time (1000/33 = apx. 30FPS

                if (sleepfor>0){                                            // If the 'sleepfor' variable is >0 then set the thread to sleep for it's value (expressed in milliseconds)

                    try {
                        MainThread.sleep(sleepfor);                         //send thread to sleep for value of sleepfor (determined above).

                    } catch (InterruptedException e) {}                     //in case of exception
                }                                                           //close if statement

                    while (sleepfor<0 && framesskipped<maxframesskipped){   //if sleepfor is < 0 (ie, frame took longer to render than target time and the maxframesskipped has not reached it's limit)
                        updateMenu();                                       //Update game logic only
                        sleepfor+=33;                                       //time to sleep plus the time frame took to render
                        framesskipped++;                                    //add one to framesskipped variable so this only skips a certain number of frames
                        frame=0;
                        } 
```

我放置在 onDraw 方法中的日志记录的输出。

![在此处输入图像描述](../Images/f7fc288a2e47695d3aceec7a4ea089b5.png)

正如你所看到的，它看起来并没有限制在 30fps，我不知道为什么，我的数字一定是错误的。

其次，有人知道为什么我的帧数会不时下降到 5 吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T02:11:00.877

我发现了问题所在：

```
sleepfor = (int) (30.3030303030303-frametime); 
```

本来应该

```
sleepfor = (int) ((1000/fps)-frametime); 
```

所以 sleepfor = (int) (33.3333333-frametime);

改变了它，它以 30 / 31 fps 运行得很好

# python - execfile() 的 Sage 5.0 语法错误

> ID：14636039
> 
> 赞同：1
> 
> 时间：2013-01-31T22:06:53.540
> 
> 标签：python, sage

以下是我希望能够在会话中调用的 .sage 文件的一部分：

```
def projective_grid(m,n):  
    r"""
    The  mxn grid in projective space
    """
    g = graphs.Grid2dGraph(m,n)
    g = Graph(g)
    for i in range(m):
        g.add_edge(((i,0),(m-i-1,n-1),1))
    for j in [1..(n-2)]:
        g.add_edge(((0,j),(m-1,n-j-1),1))
    g.delete_edge(((0,0),(m-1,n-1)))
    g.add_edge(((0,0),(m-1,n-1),2))
    g.delete_edge(((m-1,0),(0,n-1)))
    g.add_edge(((m-1,0),(0,n-1),2))
    if n%2==1 and m == 2:
        g.delete_edge((0, (n-1)/2), (1, (n-1)/2))
        g.delete_edge((0, (n-1)/2), (1, (n-1)/2))
        g.add_edge((0, (n-1)/2),(1,(n-1)/2),2)
    if n == 2 and m%2==1:
        g.delete_edge(((m-1)/2, 0), ((m-1)/2, 1)) 
        g.delete_edge(((m-1)/2, 0), ((m-1)/2, 1)) 
        g.add_edge(((m-1)/2, 0), ((m-1)/2, 1),2)    
    pos = {}
    k = -1
    for i in [1..m]:
      for j in [1..n]:
        k+=1
        pos[k] = (j,i)
    g.set_pos(pos)
    return g 
```

我可以将此代码复制粘贴到 Sage 会话中而不会引发错误，但是当我尝试使用 execfile() 调用该文件时，我得到以下信息：

```
sage: execfile('/Users/WyattAlt/Desktop/thesis/stack_test.sage')
------------------------------------------------------------
   File "/Users/WyattAlt/Desktop/thesis/stack_test.sage", line 9
     for j in [1..(n-2)]:
                  ^
SyntaxError: invalid syntax 
```

如果我用 range(1,n-1) 和类似的替换有问题的部分，问题就会消失，但我想了解为什么这不起作用。有任何想法吗？提前致谢。

编辑：我在 OS X 10.5.8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:11:04.007

Sage 语法和 Python 语法在一些地方有所不同，包括那个范围语法。

在幕后，Sage 控制台会预先解析您输入到标准 Python 中的内容：

```
sage: [1..10]
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
sage: preparse('[1..10]')
'(ellipsis_range(Integer(1),Ellipsis,Integer(10)))' 
```

事实上，即使是整数文字也被包装了：

```
sage: 10
10
sage: preparse('10')
'Integer(10)' 
```

当您使用`execfile`纯 Python 函数时，您将绕过 Sage 预解析器。如果你想要等价的，你可以使用`load`：

```
sage: !echo "print [1..10]" >> test.sage
sage: !cat test.sage
print [1..10]
sage: execfile("test.sage")
------------------------------------------------------------
   File "test.sage", line 1
     print [1..10]
                ^
SyntaxError: invalid syntax

sage: load("test.sage")
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

# java - EGit - “替换为提交...”不能正常工作

> ID：14636040
> 
> 赞同：3
> 
> 时间：2013-01-31T22:06:55.190
> 
> 标签：java, eclipse, git, eclipse-plugin, egit

我将**EGit**与**Eclipse Indigo SR 2 Build 20120216-1857 一起使用**。

几乎所有东西都运行良好，除了`Replace With -> Commit...`功能。事实上，它可以工作，但不能完全恢复项目，因为它留下了我添加的新文件。

看起来它在当前 HEAD 和我选择恢复的提交之间做了一种混合。**我真正想要的是用以前的提交替换我的项目的内容，就像在分支之间切换时所做的那样。**

有什么解决办法吗？有谁知道最新版本的 Eclipse 是否提供了完整的 EGit 版本？

还是我误解了这个功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T09:35:29.077

@VonC 向我指出了一种解决方案，但这并不是我真正想要的。

我尝试了*重置*命令，但首先，我必须标记提交才能选择它。然后它会更改整个`master`分支并取消下一次提交。事实上，我不想更改任何分支或删除任何提交，我只想能够返回到前一个以查看整个代码并最终运行它。

最后，我可以让它在提交时使用**Checkout来工作。**查看所有提交：`Right click on your project -> Show In -> History`

它不会修改您正在处理的任何分支，而只是将项目的内容替换为提交保存的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-01T07:03:18.797

`Replace with`我在 Egit 中知道的“ ”是**[关于 git checkout](http://wiki.eclipse.org/EGit/User_Guide#Reverting_Changes)**的（而不是`git revert`像下面的[robinst](https://stackoverflow.com/users/305973/robinst) [评论](https://stackoverflow.com/questions/14636040/egit-replace-with-commit-doesnt-work-as-excepted/14641324#comment20461552_14641324)）。
而且[checkout 和 reset 不一样](https://stackoverflow.com/q/8358035/6309)。

> 我真正想要的是用以前的提交替换我的项目的内容，就像在分支之间切换时所做的那样。

那将更接近**[“重置”功能](http://wiki.eclipse.org/EGit/User_Guide#Resetting_your_current_HEAD)**。
选择“硬重置”将删除任何私有文件并将索引和工作树完全恢复到选定的提交。

![在 Egit 中重置](../Images/3e9aa1006afaf0ecce0c1aafc5883426.png)

^(（来自“[如何使用 Egit 删除提交？](https://stackoverflow.com/questions/13534336/how-to-delete-commits-with-egit) ”）)

> `hard`- HEAD 现在指向新的提交，索引和工作树被更新。

您也可以在[本教程](http://eclipsesource.com/blogs/tutorials/egit-tutorial/)中看到它：

![在 Egit bis 中重置](../Images/fa074fc6da9222a6e004d7da35ef169b.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:29:55.383

除非您将新创建的文件添加到其中，否则新创建的文件不在 git index 中（未跟踪）。由于您将工作区恢复为提交，因此只会修改您跟踪的文件（添加到 git 索引）。不触及新创建的文件。

如果要删除未跟踪的文件：

`git clean -f -d`会做的。

# php - 主键在 UPDATE 语句上得到更新

> ID：14636041
> 
> 赞同：1
> 
> 时间：2013-01-31T22:06:56.240
> 
> 标签：php, mysql, sql, pdo

我有一个查询，它在我网站上的每个页面加载时运行。以一种简单的形式，它检查用户 IP 是否在数据库中，如果不是，它将添加它，如果是，则不执行任何操作。为了节省自己必须运行两个查询来完成此操作（一个要检查，一个要插入），我正在使用以下 SQL：

```
INSERT IGNORE INTO `limits`
SET `ip` = :ip, `limit` = :limit 
```

这意味着如果`:ip`已经存在则什么都不做，如果不存在则创建记录。它工作正常，但是我注意到我的表的主键在每次页面加载时都会增加。

例如，主键字段被调用`id`，它是`int(11) AUTO_INCREMENT`. `id`数据库中的第一条记录的值显然是`1`. 刷新页面 10 次后，它现在的值为`11`，即使我的 IP 没有更改并且查询没有插入新记录。

有没有办法让查询`id`在每次执行时都不更新字段？

# c# - VARCHAR(1) 等效于 C# 领域，SQL INSERT ERROR

> ID：14636046
> 
> 赞同：0
> 
> 时间：2013-01-31T22:07:11.767
> 
> 标签：c#, sql, sql-server, ajax, asp.net-mvc-4

我正在构建一个 Web API，它将一些值插入 Microsoft SQL Server 数据库。

此 API 的最终使用将在 JAVA Spring 应用程序中。

我不想“本末倒置”，所以作为 POC，我想先向自己证明，我可以从一个简单的网页调用我的 Web API。

本质上，我的简单网页有一些文本输入字段，当我单击按钮时，我会验证文本字段，然后从中创建一个 JSON 字符串。接下来我有一个 Ajax 调用，将这个 JSON 字符串传递给我的控制器。我在 .NET 土地上的控制器收到了我的请求，但因以下错误而窒息 -

> *发生错误。","ExceptionMessage":"字符串或二进制数据将被截断。*

堆栈跟踪如下。

> 在 System.Data.SqlClient.SqlInternalConnection.OnError ... 等等等等

我认为问题出在我试图插入的几个列中。

它们属于类型`VARCHAR(1)`并具有`NOT NULL`SQL Server 中的属性。

在我的简单网页上，我从未为这些值创建文本输入。相反，我认为当我`INSERT`在服务器上进行实际操作时，我可以坚持这些值。顺便说一句，我正在使用`TableAdapter`来处理我所有的数据库连接等......

使这一切发生的代码如下：

```
//JQUERY - collecting the input and generating the JSON
$('#pythonIsActive').is(':checked') ? activeCourse = 'Y' : activeCourse = 'N';  
        $('#pythonRequiresSecurityClearance').is(':checked') ? clearanceRequired = 'Y' : clearanceRequired = 'N';
        $('#pythonOfferedFall').is(':checked') ? fall = 'Y' : fall = 'N';
        $('#pythonOfferedWinter').is(':checked') ? winter = 'Y' : winter = 'N';
        $('#pythonOfferedSpring').is(':checked') ? spring = 'Y' : spring = 'N';
        $('#pythonOfferedSummer').is(':checked') ? summer = 'Y' : summer = 'N';
        $('#pythonIsTentative').is(':checked') ? tenativeCourse = 'Y' : tenativeCourse = 'N';

        var Course = {
            CourseID: $('#pythonCourseId').val(),
            CourseLongName: $('#pythonLongName').val(),
            IsActiveCourse: activeCourse,
            Description: $('#pythonCourseDescription').val(),
            DepartmentID: $('#pythonDepartmentId').val(),
            LabHours: $('#pythonLabHours').val(),
            LectureHours: $('#pythonLectureHours').val(),
            CourseShortName: $('#pythonShortName').val(),
            EffectiveYear: $('#pythonEffectiveYear').val(),
            EffectiveQuarter: $('#pythonEffectiveQuarter').val(),
            IsClearanceRequired: $('#pythonRequiresSecurityClearance').val(),
            ClearanceRequired: $('#pythonSecurityClearanceRequired').val(),
            CourseCoordinatorID: $('#pythonCoordinatorID').val(),
            IsOfferedQ1: fall,
            IsOfferedQ2: winter,
            IsOfferedQ3: spring,
            IsOfferedQ4: summer,
            Prerequisite1: $('#pythonPrerequisite1').val(),
            Prerequisite2: $('#pythonPrerequisite2').val(),
            Prerequisite3: $('#pythonPrerequisite3').val(),
            IsTentative: tenativeCourse,
            Prerequisites: $('#pythonPrerequisites').val()
        };
        courseDataToPost = JSON.stringify(Course);
        return courseDataToPost; 
```

接下来，我会像这样将这个 JSON 字符串传递给我的 AJAX CALL -

```
$.ajax({
    type: "POST",
    url: "/api/courses",
    cache: false,
    contentType: "application/json; charset=utf-8",
    async: true,
    data: dataToPost,
    dataType: "json",
    success: function () {
      alert("Success!");
    },
    error: function (x, e) {
      alert("The call to the server side FAILED. " + x.responseText);
    }
}); 
```

因此，这成功地将请求路由到正确的控制器方法 -

```
 // POST /api/courses
    [HttpPost]
    public void Post(pythonCourse course)
    {
        var postTableAdapter = new tnpCourseTableAdapter();
        decimal zero = 0;
        string no = "N";

        try
        {
            postTableAdapter.Insert(course.CourseID, course.CourseLongName, 
                                    course.IsActiveCourse, course.Description,
                                    course.DepartmentID, course.LabHours, 
                                    course.LectureHours, course.CourseShortName,
                                    course.EffectiveYear, course.EffectiveQuarter, 
                                    course.IsClearanceRequired,
                                    course.ClearanceRequired, 
                                    course.CourseCoordinatorID, course.IsOfferedQ1,
                                    course.IsOfferedQ2, course.IsOfferedQ3, 
                                    course.IsOfferedQ4, course.Prerequisite1,
                                    course.Prerequisite2, course.Prerequisite3, 
                                    course.IsTentative, zero, zero, null,
                                    no, no, no, null, null, null, null);
        }
        catch (Exception)
        {
            throw;
        }            
    } 
```

当我在服务器代码中到达这里时，调试器在 catch 块上停止并给出“字符串或二进制数据...”错误。

请注意，在我的参数列表中，我传递了 string 的 3 个实例`no`。

这些参数是字符串，但 SQL Server 需要`VARCHAR(1)`.

这是造成我悲伤的原因，还是有其他事情发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:09:37.743

此错误意味着您将太多数据放入列中。您的列需要一个字符串。

因此，错误意味着如果您放入`no`列中.. 它将被截断为`n`.

另一个例子：如果列是`VARCHAR(5)`并且您插入了“Hello World！”，它会警告它只能插入“Hello”。

# haskell - 是否可以为“免费”实现 MonadFix？

> ID：14636048
> 
> 赞同：21
> 
> 时间：2013-01-31T22:07:15.870
> 
> 标签：haskell, monadfix, free-monad

[http://hackage.haskell.org/package/free](http://hackage.haskell.org/package/free) in`Control.Monad.Free.Free`允许访问任何给定的“免费单子” `Functor`。但是，它没有`MonadFix`实例。这是因为这样的实例无法编写，还是只是被遗漏了？

如果不能编写这样的实例，为什么不呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-01T05:09:38.583

考虑对做什么的描述`mfix`：

> 一元计算的不动点。`mfix f`只执行`f`一次动作，最终的输出作为输入反馈。

在 的上下文中，“执行”一词`Free`意味着创建`Functor`. 因此，“仅一次”意味着在评估的结果中`mfix f`，构造函数中保存的值`Pure`必须完全确定创建了多少层仿函数。

现在，假设我们有一个特定的函数`once`，我们知道它总是只会创建一个`Free`构造函数，但是需要许多`Pure`构造函数来保存叶值。那么，'once' 的输出将只是与 type`Free f a`的某个值同构的 type 值`f a`。有了这些知识，我们就可以安全地取消`Free`输出`once`，得到一个类型的值`f a`。

现在，请注意，因为`mfix`需要“只执行一次操作”，所以对于符合要求的实例，除了在单个应用程序中创建之外，`mfix once`应该不包含额外的一元结构。`once`因此，我们可以推断，从中获得的值`mfix once`也必须与 type 的值同构`f a`。

给定任何类型`a -> f a`为 some的函数`Functor` `f`，我们可以用 single 包装结果`Free`并获得`a -> Free f a`满足上述描述的类型函数`once`，并且我们已经确定我们可以解开结果`mfix once`以获取`f a`返回类型的值。

因此，一个符合要求的实例`(Functor f) => MonadFix (Free f)`意味着能够通过上述包装和展开来编写一个`ffix :: (Functor f) => (a -> f a) -> f a`适用于所有实例的函数`Functor`。

这显然不能证明您*不能*编写这样的实例……但是如果可能的话，那`MonadFix`将是完全多余的，因为您可以`ffix`直接轻松地编写。（而且我想`mfix`用`Monad`约束重新实现它，使用`liftM`. 呃。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-01T03:50:02.433

好吧，受`MonadFix`实例的启发`Maybe`，我尝试了这个（使用以下定义`Free`）：

```
data Free f a
    = Pure a
    | Impure (f (Free f a))

instance (Functor f) => Monad (Free f) where
    return = Pure
    Pure x >>= f = f x
    Impure x >>= f = Impure (fmap (>>= f) x)

instance (Functor f) => MonadFix (Free f) where
    mfix f = let Pure x = f x in Pure x 
```

[法律](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Monad-Fix.html)是：

*   纯度：`mfix (return . h) = return (fix h)`
*   左缩：`mfix (\x -> a >>= \y -> f x y) = a >>= \y -> mfix (\x -> f x y)`
*   滑动: `mfix (liftM h . f) = liftM h (mfix (f . h))`, 为严格`h`
*   嵌套：`mfix (\x -> mfix (f x)) = mfix (\x -> f x x)`

纯度很容易证明——但我在尝试证明左缩时遇到了一个问题：

```
mfix (\x -> a >>= \y -> f x y)
= let Pure x = (\x -> a >>= \y -> f x y) x in Pure x
= let Pure x = a >>= \y -> f x y in Pure x
-- case a = Pure z
  = let Pure x = Pure z >>= \y -> f x y in Pure x
  = let Pure x = f x z in Pure x
  = let Pure x = (\x -> f x z) x in Pure x
  = mfix (\x -> f x z)
  = Pure z >>= \y -> mfix (\x -> f x y)
-- case a = Impure t
  = let Pure x = Impure t >>= \y -> f x y in Pure x
  = let Pure x = Impure (fmap (>>= \y -> f x y) t) in Pure x
  = Pure _|_ 
```

但

```
 Impure t >>= \y -> mfix (\x -> f x y)
  = Impure (fmap (>>= \y -> mfix (\x -> f x y)) t)
  /= Pure _|_ 
```

所以，至少，如果`Pure`和`Impure`构造函数是可区分的，那么我的实现`mfix`不满足法律。我想不出任何其他的实现，但这并不意味着它不存在。抱歉，我无法进一步阐明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-07T11:29:30.383

不，不能笼统地写出来，因为不是每个 Monad 都是 MonadFix 的实例。每个 Monad 都可以使用下面的 FreeMonad 来实现。如果您可以免费实现 MonadFix，那么您将能够从任何 Monad 派生 MonadFix，这是不可能的。但当然，您可以为 MonadFix 类定义一个 FreeFix。

我认为它可能看起来像这样，但这只是第三次猜测（尚未测试）：

```
data FreeFix m a = FreeFix { runFreeFix :: (forall r. (r -> m r) -> m r) -> m a }

instance (Monad m) => Monad (FreeFix m) where
    return a = FreeFix $ \_-> do
        return a
    f >>= g = FreeFix $ \mfx -> do
        x <- runFreeFix f mfx
        runFreeFix (g x) mfx

instance (Monad m) => MonadFix (FreeFix m) where
    mfix f = FreeFix $ \mfx -> do
        mfx (\r->runFreeFix (f r) mfx) 
```

这个想法是 m 是一个缺少 mfix 实现的 Monad；所以当 FreeFix 会被缩减时，mfix 需要是一个参数。

# jquery-ui - jquery UI 在子 div 上可拖动 x 轴，在父 div 上拖动 y 轴

> ID：14636050
> 
> 赞同：2
> 
> 时间：2013-01-31T22:07:17.067
> 
> 标签：jquery-ui, draggable

我在一个容器 div 中有 4 个 div。我希望能够垂直拖动四个 div 的内容，但也能够水平拖动所有四个 div 的容器。像下面这样的东西..

![http://imgur.com/L4trY6F](../Images/3e8b8b0194e8e46e9857f53d80d98b3e.png)

或者在这里看到：http: [//jsfiddle.net/PuVCz/](http://jsfiddle.net/PuVCz/)

问题是，当您在其中单击前两个 div 时，您可以上下拖动它们，当您在 2 个右侧空 div 内单击时，您可以左右拖动整个区域，但是当您单击前两个时，您不能水平移动整个区域因为 jquery 认为您正在尝试控制内容的上/下移动。

有没有办法使用可拖动来实现这一点？

PS 一些代码来取悦堆栈溢出提交系统，但图片或 JSF 显示我的意思要好得多

```
$(function() {
    $( "#content" ).draggable({axis: "x" });
    $( ".fredcontent" ).draggable({axis: "y" });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T11:16:17.730

我有同样的问题..

我的解决方案是进入拖动状态，移动方向。

```
start: function(e, ui) {
                // get the start x coords to detect horizontal scroll
                start = ui.position.left;
                outerDragStartPos = parseInt(outerDrag.css('left'));
...

drag : function(event, ui){
                // if horizontal scroll
                if(ui.position.left != start){ 
```

如果方向是垂直的，那么不会发生任何有趣的事情。

但是如果脚本检测到 x 轴上的移动，那么它会禁用“滚动 x 行为”并移动外部容器。

```
 // disable horizontal scroll for the internal container
   innerDrag.draggable( "option", "axis", "y" );

   // moving delay
   if(ui.position.left > 30 || ui.position.left < -30){
        outerDrag.css('left',outerDragStartPos + ui.position.left+"px"); 
```

我做了一个[小提琴](http://jsfiddle.net/MYhCA/)来展示它的样子。

我希望它有点帮助。^‿^

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T07:41:40.820

[这](http://jsfiddle.net/PuVCz/2/)是一个适合你的小提琴。诀窍是显示一些#content 空间，以便您可以水平拖动它。还添加了

```
.fredcontent{
    height:100%;
} 
```

这样您就可以水平拖动空的div。以前它们没有 100% 的高度，因此两个空 div 的左右拖动是

```
$( "#content" ).draggable({axis: "x" }); 
```

而不是

```
$( ".fredcontent" ).draggable({axis: "y" }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T19:26:12.153

我创造了一种方法来做到这一点。基本上，您将拖放应用到所有子元素，如果您在 X 轴上拖动，它将更改父元素的 X 坐标。这是在小提琴上。

只需将其添加到您的父元素

```
$('#parent').doubleDragOnXY(); 
```

首先，它将 .draggable() 函数应用于属于 #parent 的每个子元素

```
var children = $(this).children();

        children.draggable({..}) 
```

然后在拖动属性中，它会测试您是在 X 轴还是 Y 轴上拖动它。如果您在 X 轴上拖动，请将父级“left”css 属性设置为新位置。如果拖过 Y 轴，则返回新位置：

```
if (xMax) {
   var newLeft = parentStart + newPosition.left;
   $(this).parent().css({
      left: newLeft
   });                   
   newPosition.top = originalPosition.top;
   newPosition.left = originalPosition.left;
}
if (!xMax) {
   newPosition.left = originalPosition.left;
}
return newPosition; 
```

在这个小提琴上检查一下。 [http://jsfiddle.net/Dtwigs/mRPuv/](http://jsfiddle.net/Dtwigs/mRPuv/)

ps 这段代码很大程度上受到了我在堆栈溢出中发现的另一个示例的启发，尽管我无法找到/记住该示例。基本上它允许一个对象在 Y 或 Y 上移动，但不能同时在两者上移动。

# r - 在 ggplot2 中使用 smooth 使用数据中给出的误差来拟合线性模型

> ID：14636052
> 
> 赞同：3
> 
> 时间：2013-01-31T22:07:36.667
> 
> 标签：r, ggplot2

我有这个数据框：

```
> dat
   x         y        yerr
1 -1 -1.132711 0.001744498
2 -2 -2.119657 0.003889120
3 -3 -3.147378 0.007521881
4 -4 -4.220129 0.012921450
5 -5 -4.586586 0.021335644
6 -6 -5.389198 0.032892630
7 -7 -6.002848 0.048230946 
```

我可以用标准误差平滑来绘制它：

```
p <- ggplot(dat, aes(x=x, y=y)) + geom_point()
p <- p + geom_errorbar(data=dat, aes(x=x, ymin=y-yerr, ymax=y+yerr), width=0.09)
p + geom_smooth(method = "lm", formula = y ~ x) 
```

![在此处输入图像描述](../Images/d6417b750e3dd55725757896495c31b5.png)

但我需要的是使用**yerr**来拟合我的线性模型。ggplot2可以吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-01T12:11:45.127

好吧，我找到了一种方法来回答这个问题。

因为在我们收集数据的任何科学实验中，如果该实验正确执行，所有数据值都必须有一个相关的错误。

**在某些情况下，误差的方差可能在所有点上都相等，但在许多情况下，例如原始问题中的当前情况，这是不正确的。**因此，在将曲线拟合到我们的数据时，我们必须使用不同测量值的误差值方差。

这样做的方法是将权重归因于错误值，根据统计分析方法，它等于 1/sqrt(errorValue)，因此，它变为：

```
p <- ggplot(dat, aes(x=x, y=y, weight = 1/sqrt(yerr))) + 
    geom_point() + 
    geom_errorbar(aes(ymin=y-yerr, ymax=y+yerr), width=0.09) + 
    geom_smooth(method = "lm", formula = y ~ x) 
```

![在此处输入图像描述](../Images/fedb83051e8f7718a29e56dad1021a23.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-01T18:47:38.327

对于任何模型拟合，我都会在我使用的绘图范例之外进行拟合。为此，传递一个`weights`与观测值的方差成反比的值。然后将通过加权最小二乘程序进行拟合。

对于您的示例/情况**ggplot**正在`geom_smooth`为您执行以下操作。虽然它看起来更容易使用`geom_Smooth`，但直接拟合模型的好处最终超过了这一点。一方面，您拥有拟合模型，并且可以对拟合、模型假设等进行诊断。

拟合加权最小二乘

```
mod <- lm(y ~ x, data = dat, weights = 1/sqrt(yerr)) 
```

然后`predict()`从模型的范围内`x`

```
newx <- with(dat, data.frame(x = seq(min(x), max(x), length = 50)))
pred <- predict(mod, newx, interval = "confidence", level = 0.95) 
```

在上面我们得到了`predict.lm`生成适当置信区间的方法以供使用。

接下来，准备绘图数据

```
pdat <- with(data.frame(pred),
             data.frame(x = newx, y = fit, ymax = upr, ymin = lwr)) 
```

接下来，构建情节

```
require(ggplot2)
p <- ggplot(dat, aes(x = x, y = y)) +
       geom_point() +
       geom_line(data = pdat, colour = "blue") + 
       geom_ribbon(mapping = aes(ymax = ymax, ymin = ymin), data = pdat, 
                   alpha = 0.4, fill = "grey60")
p 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T09:07:46.103

你的问题有点含糊。这里有一些建议可以帮助您入门。

1.  ggplot2 只是使用`lm`回归函数。要获取值，只需执行以下操作：

    ```
     lm(y ~ x, data=dat) 
    ```

    这将为您提供 y 截距和渐变。

2.  `stat_smooth`您可以在using`se`参数中关闭标准错误：

    ```
    .... + geom_smooth(method = "lm", formula = y ~ x, se = FALSE) 
    ```

3.  您可以通过以下点/错误带添加功能区：

    ```
    ##This doesn't look good. 
    .... + geom_ribbon(aes(x=x, ymax =y+yerr, ymin=y-yerr)) 
    ```

# geometry - 当已知三角形的两点时，如何找到圆上的第三点？

> ID：14636053
> 
> 赞同：4
> 
> 时间：2013-01-31T22:07:45.473
> 
> 标签：geometry, coordinate

假设在一个圆上有一个三角形 ABC，其中 A 是圆心，B 和 C 是同一个圆的边界上的两点，关于这个三角形，我们知道以下几点：

1.  A (x1,y1) 的二维坐标值，即 (357,257)
2.  B (x2,y2) 的二维坐标值，即 (93,169)
3.  从 A 到 B 的距离是 278（圆的半径）
4.  从 A 到 C 的距离是 278（圆的半径）
5.  从 B 到 C 的距离是 244
6.  角度 ∠BAC ≡ ∠CAB ≡ ∠A = 52°

现在的问题是：

如何求点 C (x3,y3) 的二维坐标值？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T03:45:38.397

您可以将 B 点相对于 A 点旋转 52°（不要忘记使用弧度）。如果您需要向另一个方向旋转，请更改角度符号。

```
x3=x1+(x2-x1)*Cos(52)-(y2-y1)*Sin(52)
y3=y1+(x2-x1)*Sin(52)+(y2-y1)*Cos(52) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T01:03:05.160

所以另一种看待它的方式可能是圆以 (357, 357) 为中心，你在圆的外侧有一个点，你想绕着圆前进这么多度？似乎是 (5) <=> (6) （或者，我猜，约束是不一致的）。

自然会有两种解决方案，因为您的约束允许两个答案，如果将两者绘制在一起，它们看起来就像圆的相邻切片。

最简单的解决方案可能是使用 arctan 得到从 A 到 B 的线段水平线的角度，然后加上或减去 52 并使用 sin/cos 在圆外得到一个新点。

例如（在 C 中，假设我正确地记住了我的象限）

```
float angleOfAB = atan2f(B.y - A.y, B.x - A.x);
float angleOfAC = angleOfAB + 52.0f * M_PI / 180.0f; // in radians

// could use squartf here if the radius is unknown

Position C;
C.x = A.x + 278.0f * cos(angleOfAC);
C.y = A.y + 278.0f * sin(angleOfAC); 
```

# android - 如何计算相对于在 ImageView 中绘制的位图的触摸事件？

> ID：14636054
> 
> 赞同：1
> 
> 时间：2013-01-31T22:07:51.247
> 
> 标签：android

我创建了一个 imageView，在其中我在画布上绘制了位图。ImageView 比我绘制的位图高，所以图像最终垂直居中。

在draw方法中，位图的左上角用坐标(0,0)表示，右下角用(bounds.bottom, bounds.right)表示（使用drawable类中的getBounds获得。

我正在跟踪 ImageView 中的触摸事件。我的问题是，我如何计算相对于绘制的位图的触摸事件？我找不到有关可绘制的绘制位置的信息来计算相对事件坐标。

例如，触摸位图的左上角会在 (0,0) 位置返回一个事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:43:48.417

只要您确定图像居中：

y_coordinate_relative_to_image = touch_y_coordinate - (screen_height - image_height)/2 x_coordinate_relative_to_image = touch_x_coordinate - (screen_width - image_width)/2

如果它也不是在 x 方向上居中，那么如果它是左对齐的，你就不必做任何事情。如果它是正确的，那么你减去宽度的差异，但没有两个因素。

话虽如此，您可能会遇到以下问题：

[Android 触摸输入：坐标？](https://stackoverflow.com/q/6330802/1082887)

如果您的 AndroidManifest.xml 配置不正确，触摸坐标的范围似乎与屏幕像素分辨率不同。

# php - 实现特定的类似计数器

> ID：14636056
> 
> 赞同：1
> 
> 时间：2013-01-31T22:08:03.353
> 
> 标签：php, html, ajax

好吧，这是一个很奇怪而且不是很具体的问题，但是 stackoverflow 是我最后的希望，所以这里是：

过去几周我一直在基于 CMS 构建自己的网站，到目前为止，我设法解决了我遇到的每一个问题，耐心、运气和/或良好的搜索，即使我只有一些基本的 HTML /CSS 知识。但现在我完全坚持实施一个类似的计数器。CMS 的编码人员在[这里](https://gist.github.com/3129327)创建了一个带有一些基本说明的小片段。我跟着他们，但我无法让它工作。我可以收到错误

`{"status":"error","msg":"The post could not be found"}`

，但我无法增加计数器（它只是将我重定向到我的错误页面），而且我不知道如何使用 Ajax 示例。我已经尝试在他们的论坛中提问，但没有人回答我。我试图从工作[网站](http://csspandemic.com/)的代码中学习，但这也无济于事。我完全被卡住了，无法使用谷歌让它工作。

因此，如果有人可以向我解释如何实现它，或者向我指出一个类似的例子，那就太好了。

我知道这是一个奇怪的问题，如果您不能/不会帮助我，我完全理解，但无论如何提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:47:23.420

好的，这真的很奇怪，但是今天我使用“;”解决了这个问题 代替 ”：”。所以 URL 应该是 localhost/kirby/screenshots/like/post;test 并且一切正常。这对我来说没有任何意义，因为所有现有的主题都使用 ":" ，我猜我在我的配置中改变了一些东西。如果其他人有类似的问题，只需将其留在这里。

# asp.net-mvc - 无法使用 ASP.NET MVC4 ScriptBundling 渲染 Css

> ID：14636057
> 
> 赞同：0
> 
> 时间：2013-01-31T22:08:07.423
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4, bundling-and-minification

我有一个从 ASP.NET MVC4 WebAPI 项目开始的应用程序。不知何故，当我有 BundleTable.EnableOptimizations Defaulted（这是真的）时，我的 css 没有被渲染。当我将它设置为 false（在我的 RegisterBundles.cs 文件中）时，网站会正确呈现。

我在网络流量中看到的内容（以 http 状态 403 失败，禁止。

```
http://localhost:17138/Content/Styles/?v=xz2jRv8a4HMY4rDzixZn1RlC6AERf9qY0Gh7MavTpZE1 
```

我一直将其与默认的空新项目进行比较，该项目有效，但我无法弄清楚我缺少什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T19:04:09.557

请参阅此链接，这表明问题出在您的项目中存在的 /Content/Styles 文件夹中： [ASP.NET MVC framework 4.5 CSS bundles does not work on the hosting](https://stackoverflow.com/questions/12081255/asp-net-mvc-framework-4-5-css-bundles-does-not-work-on-the-hosting)

正如那里的答案所建议的那样，由于该文件夹存在于磁盘上，因此 IIS 会处理该请求。

# batch-file - 将文件夹复制到域中所有 XP 计算机的批处理脚本

> ID：14636063
> 
> 赞同：1
> 
> 时间：2013-01-31T22:08:22.680
> 
> 标签：batch-file

我试图创建一个批处理文件，如果它们正在运行 Windows XP，它将复制一个文件夹到域中的所有计算机。我有这个：

```
for /f "Tokens=1 delims=$" %a in ('dsquery * domainroot -limit 300 -filter "(&(objectCategory=computer)(operatingSystem=Windows XP*))"^| dsget computer -samid^|find /V "samid" ^| find /V "dsget"') do ( robocopy \\fserver\programs\ "\\%a\C$\Documents and Settings\All Users\Application Data\" /s /R:1 /W:1)c 
```

问题是当我运行它时，在复制到位置的计算机名称之前添加了一个空格。例如：

```
Error accessing Destination Directory \\ HP-0D9F\C$\Doc... 
```

我如何摆脱空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-07T15:51:45.080

如果你改变你`dsquery`的一点，你可以删除额外的空间。这也消除了必须使用`dsget`和额外的`find`，因此它似乎运行得更快一些。此命令将查询所有 Windows XP 计算机的域，检索每台计算机的“名称”，过滤结果以从输出中删除列标题，并打印每台计算机的名称。

```
for /f %i in ('dsquery * domainroot -limit 300 -filter "(&(objectcategory=computer)(operatingsystem=Windows XP*))" -attr name ^| find /v /I "name"') do @echo %i 
```

现在，只需在您可以将其作为单行命令运行之后添加您的 robocopy 命令，`do`而不必制作批处理文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T09:49:30.130

您可以删除空间，但这必须在不同的行中完成，因此实际上您需要在批处理文件中执行此操作

```
setlocal enabledelayedexpansion
for /f "Tokens=1 delims=$" %%a in ('dsquery * domainroot -limit 300 -filter "(&(objectCategory=computer)(operatingSystem=Windows XP*))"^| dsget computer -samid^|find /V "samid" ^| find /V "dsget"') do (
set pc=%%a
set pc=!pc:\\ =\\!
robocopy \\fserver\programs\ "\\!pc!\C$\Documents and Settings\All Users\Application Data\" /s /R:1 /W:1
) 
```

可能可以使用`&&`'s 连接命令，但我还没有进行任何测试以了解它是否适​​用于延迟扩展，`cmd /v:on`如果你真的想在一行上使用它，可以考虑使用。

# google-maps - 谷歌地图的天气层没有出现，但交通是

> ID：14636064
> 
> 赞同：0
> 
> 时间：2013-01-31T22:08:25.737
> 
> 标签：google-maps, google-maps-api-3

嘿伙计们，我正在尝试为我的地图添加不同的图层，但我遇到了天气图层的一些问题。当我自己添加交通图层时，地图可以工作，但是当我添加天气图层时，地图只有一个灰色框应该已经出现了。任何帮助都会非常感谢！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Description" content="Get ready to experience Indianapolis! This site will make your visit the best one yet!"/>
<title>The Indy Tour- Travel</title>
<link href="../style/style.css" rel="stylesheet" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyA6VosQrKQOjoTbDSp4Kk4BHvofOJFUfZU&sensor=true"></script>
    <script type="text/javascript">
        var map;
        function initialize() { 
            var myOptions = {
            zoom: 9,
            mapTypeId: google.maps.MapTypeId.ROADMAP
            };

        var all = [
            ["Indianapolis International Airport", "7800 Col. H. Weir Cook Memorial Drive", "Indianapolis", "IN", "46241", "null", "null", "airport"],          
            ["Indianapolis International Airport", "7800 Col. H. Weir Cook Memorial Drive", "Indianapolis", "IN", "46241", "39.71449", "-86.29842", "airport"], 
            ["Location 2", "7205 Olmstead Dr", "Burlington", "NC", "27215", "36.069974", "-79.548101", "airport",],
            ["Location 3", "W Market St", "Graham", "NC", "27253", "36.0722225", "-79.4016207", "resturant"],
            ["Location 4", "Mt Hermon Rock Creek Rd", "Graham", "NC", "27253", "35.9826328", "-79.4165216", "hotel"],
            ["Location 5", "415 Spring Garden St", "Greensboro", "NC", "27401", "36.06761", "-79.794984", "hotel"]
        ];

        var infoWindow = new google.maps.InfoWindow;
        map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);

        var trafficLayer = new google.maps.TrafficLayer();
  trafficLayer.setMap(map);
  var weatherLayer = new google.maps.weather.WeatherLayer({
  temperatureUnits: google.maps.weather.TemperatureUnit.CELSIUS
});
weatherLayer.setMap(map);

var cloudLayer = new google.maps.weather.CloudLayer();
cloudLayer.setMap(map);  

        var pos = new google.maps.LatLng(39.76656, -86.15);
        map.setCenter(pos);

        function infoCallback(infowindow, marker) { 
            return function() {
            infowindow.open(map, marker);

        };

   }            
   function setMarkers(map, all) {  
    for (var i in all) {                                        
            var name    = all[i][0];
            var address = all[i][1];
            var city    = all[i][2];
            var state   = all[i][3];
            var zip     = all[i][4];
            var lat     = all[i][5];
            var lng     = all[i][6];
            var image   = all[i][7];
            var latlngset;
            latlngset = new google.maps.LatLng(lat, lng);

            var icon=null;
            if  (image=="airport") {
                icon=airport;
                var marker = new google.maps.Marker({  
                map: map,  title: city,  position: latlngset, icon: icon, shadow: shadow
            });
            }
            else if (image=="hotel") {
                icon=hotel;
                var marker = new google.maps.Marker({  
                map: map,  title: city,  position: latlngset, icon: icon, shadow: shadow
            });
            }
            else if (image=="resturant") {
                icon=resturant;
                var marker = new google.maps.Marker({  
                map: map,  title: city,  position: latlngset, icon: icon, shadow: shadow
            });
            }

            var airport = new google.maps.MarkerImage(
            '../images/airport.png',
            new google.maps.Size(32,37),
            new google.maps.Point(0,0),
            new google.maps.Point(16,37)
            );
             var hotel = new google.maps.MarkerImage(
            '../images/hotel.png',
            new google.maps.Size(32,37),
            new google.maps.Point(0,0),
            new google.maps.Point(16,37)
            );
            var resturant = new google.maps.MarkerImage(
            '../images/resturant.png',
            new google.maps.Size(32,37),
            new google.maps.Point(0,0),
            new google.maps.Point(16,37)
            );
            var shadow = new google.maps.MarkerImage(
            '../images/shadow.png',
            new google.maps.Size(54,37),
            new google.maps.Point(0,0),
            new google.maps.Point(16,37)
            );
            var content = '<div class="map-content"><h3>' + name + '</h3>' + address + '<br />' + city + ', ' + state + ' ' + zip + '<br /><a href="http://maps.google.com/?daddr=' + address + ' ' + city + ', ' + state + ' ' + zip + '" target="_blank">Get Directions</a></div>';                   
            var infowindow = new google.maps.InfoWindow();
              infowindow.setContent(content);
              google.maps.event.addListener(
                marker, 
                'click', 
                infoCallback(infowindow, marker)
              );
          }
        }           
        setMarkers(map, all);
      };
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</head>

<body>
<div id="logo">
    <div id="wrap">
        <div id="header">
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="History.html">History</a></li>
                <li><a href="Attractions.html">Attractions</a></li>
                <li><a href="Landmarks.html">Landmarks</a></li>
                <li><a href="#" style="color:#F60; text-decoration:underline;">Travel</a></li>
            </ul>
      </div>

        <div id="content">
            <h1 id="title">Travel</h1>
            <div id="map_canvas"></div>
            <img id="line" alt="footer" src="../images/footer.png"/>
            <div id="footer">
                    <ul id="ftext">
                    <li><a href="About.html">About the Team and Site</a></li>
                    <li><p style="display:inline;">Created 2012-2013 for BPA.</p></li>
                    <li><a href="Credits.html">Credits</a></li>
                </ul>

            </div>
        </div>
    </div>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:17:07.393

weatherLayer 需要默认不加载的天气库。

```
 <script type="text/javascript" 
    src="http://maps.googleapis.com/maps/api/js?libraries=weather&key=AIzaSyA6VosQrKQOjoTbDSp4Kk4BHvofOJFUfZU&sensor=true"></script> 
```

# asp.net - 显示存储在不同硬盘中的图像

> ID：14636068
> 
> 赞同：0
> 
> 时间：2013-01-31T22:08:37.067
> 
> 标签：asp.net, asp.net-mvc

我正在开发包含一些文章的 ASP.NET MVC 网站。每个用户都可以根据自己的意愿创建任意数量的文章——这完全没有问题。我让用户能够上传与那篇文章相关的图片（最多 N 张图片），这没有问题。

我的问题是，由于该站点将包含许多图像，我希望将图像存储部分存储到几个硬盘上。我有两个硬盘驱动器的专用服务器，我希望能够将图像保存在 D:\ 而不是本地 C:\ 文件夹中。此外，看起来，我需要为该站点添加另一台服务器，因此我希望能够将图像存储在可由同一个 Web 应用程序访问的不同服务器上。

我现在的代码很简单：我只是`Server.MapPath("~/Content/uploads/" + article.ArticleIdentifier)`用作文件夹容器，然后存储相关图像。

使用相同的 Web 应用程序共享少数高清或服务器中存储的图像的推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:33:57.983

最安全的方法是在 IIS 中创建一个存储文件的虚拟目录。虚拟目录可以指向 IIS 支持的任何位置（物理、UNC 等），因此您拥有最大的灵活性，并且就安全问题而言，即使文件在另一台服务器上，您也可以上传和管理文件不会遇到应用程序权限提升问题 - 您仍然需要确保适当的用户具有读/写权限。

[在 IIS 中创建虚拟目录](https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/create-virtual-directory-folder-remote-computer)

在 C# 中访问虚拟目录：

[已弃用的 API](https://docs.microsoft.com/en-us/previous-versions/iis/6.0-sdk/ms524632(v=vs.90))：`Server.MapPath("~/VirtualDir/");`

[当前 API](https://docs.microsoft.com/en-us/dotnet/api/system.web.hosting.hostingenvironment.mappath?view=netframework-4.8)：`HostingEnvironment.MapPath("~/VirtualDir/");`

# asp.net - Internet Explorer 9 中 URL 查询字符串值的 UTF-8 字符编码问题

> ID：14636073
> 
> 赞同：10
> 
> 时间：2013-01-31T22:09:17.540
> 
> 标签：asp.net, internet-explorer, encoding, utf-8, query-string

在尝试显示 URL 查询字符串中提供的特殊字符（德语重音字符）时，我在 Internet Explorer 中发现了一个奇怪的问题，特别是 IE9。**这在 Firefox 和 Chrome 中按预期工作。**

例如，我正在使用的 URL 如下所示：

```
http://mysite.com/TestPage.aspx?Title=Hochauflösendes® 
```

我还尝试了 URL 的 URL 编码版本：

```
http://mysite.com/TestPage.aspx?Title=Hochaufl%C3%B6sendes%C2%AE 
```

无论哪种情况，当我尝试在我的页面上使用 显示“标题”查询字符串值时`Request.QueryString["Title"]`，IE 都无法正确显示字符：

```
Hochaufl�sendes� 
```

**如果我直接在页面上对文本进行硬编码，它会在所有浏览器上正确显示。**只有当它从出现问题的查询字符串中提取时。

该页面保存为 UTF-8 编码，并且我的`meta`页面中有必要的标记：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
```

我还通过 Fiddler 查看了页面的标题和内容，所有编码都是正确的。

什么可能导致 IE 无法正确显示特殊字符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T22:30:44.173

正如 Aristos 所建议的那样，使用`HttpContext.Current.Request.RawUrl`适合我的情况。

要从 RawUrl 中检索实际的查询字符串值，可以使用如下简单的方法：

```
private string GetQueryStringValueFromRawUrl(string queryStringKey)
{
    var currentUri = new Uri(HttpContext.Current.Request.Url.Scheme + "://" + 
        HttpContext.Current.Request.Url.Authority + 
        HttpContext.Current.Request.RawUrl);
    var queryStringCollection = HttpUtility.ParseQueryString((currentUri).Query);
    return queryStringCollection.Get(queryStringKey);
} 
```

使用此方法检索值已被测试为在 IE8 和 IE9 中工作。该错误已在 IE10 中修复。

# css - 跨度类样式

> ID：14636077
> 
> 赞同：5
> 
> 时间：2013-01-31T22:09:32.153
> 
> 标签：css, html

我不明白，这似乎很简单。我想用 .class 向“Hello”文本添加跨度样式

[http://www.mysecretathens.gr/kulte_test/index.html](http://www.mysecretathens.gr/kulte_test/index.html)

为什么这个 .greeting 类不起作用？当我这样放时它才变成60像素

```
<span style="font-size:60px;"> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:17:22.010

你还没有关闭它上面的 CSS 类。在前面放一个花括号：

```
::selection{ 
```

像这样：

```
#container2 {
    background-color: #ebebeb;
    height: 400px;
    background-image: url("white_arrow.png");
    background-repeat: no-repeat;
    background-position: 50% -28px;
    margin: 0 auto;
    padding-top: 80px;
    text-align: center;
    color: #636161;
    font-family:'Open Sans', sans-serif;
    font-size: 20px;
    line-height: 30px;
}
::selection {
    color: #fff;
    color: rgba(255, 255, 255, .85);
    text-shadow: none;
    background: #da0225;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:17:31.240

问题是您没有关闭 #container2 css 规则。

```
#container2 {
background-color: #ebebeb;
height: 400px;
background-image: url("white_arrow.png");
background-repeat: no-repeat;
background-position: 50% -28px;
margin: 0 auto;
padding-top: 80px;
text-align: center;
color: #636161;
font-family: 'Open Sans', sans-serif;
font-size: 20px;
line-height: 30px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:15:15.797

在花括号之间使用空格！

（押韵）。

哦，您网站的真正问题是#container2 缺少结束符}。

# php - 使用 PHP 解析由 SOAP 'CSV' 生成的数组返回的结果

> ID：14636078
> 
> 赞同：0
> 
> 时间：2013-01-31T22:09:35.720
> 
> 标签：php, sql, arrays

我正在使用这个 php 来解析数据并遍历行，但是逗号和双引号的配置让我非常困惑。

任何帮助将不胜感激。

我正在使用的这段代码破坏了其中包含逗号的字符串。

```
$getDataExploded = array();
$out = "";
foreach($getData as $getDataRows)
{
    $getDataExploded = explode(",",$getDataRows);
        $out .= '<div id="'.$getDataExploded[4].'" class="row"><span style="font-size:14px; color:#646464;">'.$getDataExploded[0].'</span><br><span style="font-size:12px; color:#3877D9;">'.$getDataExploded[1].' / '.$getDataExploded[2].'<br><em style="font-size:11px; color:#757575;">Posted: '.$getDataExploded[3].'</em></span></div>';

}

echo($out); 
```

这是我要解析的数组的样子......

数组（29）{ [0]=> 字符串（62）“'wefwefwef','ewfwefwef','wefwefwef',1/29/2013 9:09:04 PM,37”[1]=> 字符串（47） "'wefwef','wefwefwef','',2013 年 1 月 29 日 9:08:11 PM,36" [2]=> string(82) "'工作如你所不知','桑迪飓风','爱达荷州博伊西',1/29/2013 9:06:12 PM,35" [3]=> string(32) "'','','',1/29/2013 9:04:10 PM,34 " [4]=> string(49) "'wefwefwef','wfwefwef','',1/29/2013 9:02:05 PM,33" [5]=> string(82) "'警长招聘' ,'警长招聘','罗德岛',1/28/2013 7:13:53 PM,25" [6]=> string(81) "'社区销售代表','Trugreen','Warwick',1 /28/2013 7:13:53 PM，24" [7]=>string(86) "'警官招聘','克兰斯顿市','克兰斯顿',1/28/2013 7:13:53 PM,23" [8]=> string(144) "'RNs, LPNs , CNA, Nurse Practitioners and Physician Assistant Recruitment','Adil Business Systems, Inc.','Rhode Island',1/28/2013 7:13:53 PM,22" [9]=> string(79) "' Econotel EBS','Telecommunications Installer','Rumford',1/28/2013 7:13:53 PM,21" [10]=> string(73) "'Full-Charge Bookkeeper','Econotel EBS',' Rumford',1/28/2013 7:13:53 PM,20" [11]=> string(127) "'认证护理助理','晨星家庭护理','韦克菲尔德、韦斯特利、纽波特和纳拉甘西特', 2013 年 1 月 28 日下午 7:13:53，19" [12]=> string(78) "'汽车会计'，'殖民丰田','史密斯菲尔德',1/28/2013 7:13:53 PM,18" [13]=> string(89) "'认证护理助理','关于家庭护理的一切','Middletown',1 /28/2013 7:13:53 PM,17" [14]=> string(97) "'客户开发/内部销售','Hexagon Metrology','North Kingstown',1/28/2013 7:13: 53 PM,16" [15]=> string(85) "'RI Sheriff','RI Department of Public Safety','statewide',1/28/2013 7:13:53 PM,15" [16] => string(89) "'Certified Nursing Assistants','Morning Star Home Care','Warwick',1/28/2013 7:13:53 PM,14" [17]=> string(95) "'Entry -Level Software Developers','Hexagon Metrology','North Kingstown',1/28/2013 7:13:53 PM,13" [18]=> string(83) "'Electronics Technician','Purvis Systems Inc.','Middletown',1/28/2013 7:13:53 PM,12" [19]=> string(81) "'Nurse Practitioner','Memorial Hospital',' Plainville, MA',1/28/2013 7:13:53 PM,11" [20]=> string(86) "'家庭护理物理治疗师','纪念医院','Pawtucket',1/28/2013 7:13:53 PM,10" [21]=> string(87) "'Real Estate Specialist','Linear Title and Closing','Middletown',1/28/2013 7:13:53 PM,9" [22]=> string(77) "'设备技术员','Angelica Textiles','Pawtucket',1/28/2013 7:13:53 PM,8" [23]=> string(68) "'绘画机组负责人','LOPCO','罗德岛',1/28/2013 7:13:53 PM,7" [24]=> string(102) "'Diesel Mechanic','Interstate Diesel Equipment Service, Inc.','North Kingstown',1/28/2013 7:13:53 PM,6" [25]=> string(73) "'Hydromat Machine Operators','Greystone','Lincoln ',1/28/2013 7:13:53 PM,5" [26]=> string(85) "'全国销售经理','Hexagon Metrology','North Kingstown',1/28/2013 7:13 :53 PM,4" [27]=> string(131) "'北普罗维登斯试用警官招聘'，'北普罗维登斯镇'，'北普罗维登斯'，2013 年 1 月 28 日下午 7:13:53， 3" [28]=> string(113) "'领土服务代表'，'Scotts Lawn Service'，'罗德岛和马萨诸塞州'，2013 年 1 月 28 日下午 7:13:53，2" }string(73) "'Hydromat Machine Operators','Greystone','Lincoln',1/28/2013 7:13:53 PM,5" [26]=> string(85) "'全国销售经理',' Hexagon Metrology','North Kingstown',1/28/2013 7:13:53 PM,4" [27]=> string(131) "'北普罗维登斯见习警官招聘','北普罗维登斯镇', '北普罗维登斯',1/28/2013 7:13:53 PM,3" [28]=> string(113) "'领土服务代表','Scotts Lawn Service','罗德岛和马萨诸塞州',1/ 2013 年 2 月 28 日下午 7:13:53，2" }string(73) "'Hydromat Machine Operators','Greystone','Lincoln',1/28/2013 7:13:53 PM,5" [26]=> string(85) "'全国销售经理',' Hexagon Metrology','North Kingstown',1/28/2013 7:13:53 PM,4" [27]=> string(131) "'北普罗维登斯见习警官招聘','北普罗维登斯镇', '北普罗维登斯',1/28/2013 7:13:53 PM,3" [28]=> string(113) "'领土服务代表','Scotts Lawn Service','罗德岛和马萨诸塞州',1/ 2013 年 2 月 28 日下午 7:13:53，2" }1/28/2013 7:13:53 PM,4" [27]=> string(131) "'北普罗维登斯见习警官招聘','北普罗维登斯镇','北普罗维登斯',1/28/ 2013 年 7:13:53 PM,3" [28]=> string(113) "'领土服务代表'，'斯科特草坪服务'，'罗德岛和马萨诸塞州'，2013 年 1 月 28 日下午 7:13:53 ,2" }1/28/2013 7:13:53 PM,4" [27]=> string(131) "'北普罗维登斯见习警官招聘','北普罗维登斯镇','北普罗维登斯',1/28/ 2013 年 7:13:53 PM,3" [28]=> string(113) "'领土服务代表'，'斯科特草坪服务'，'罗德岛和马萨诸塞州'，2013 年 1 月 28 日下午 7:13:53 ,2" }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:14:03.150

PHP 提供了`str_getcsv()`一种您可能会觉得有用的方法。它使您无需担心逗号和文本分隔符。

```
$getDataExploded = array();
$out = "";
foreach($getData as $getDataRows)
{
    $getDataExploded = str_getcsv($getDataRows);
    //Do out stuff here `htmlentities` as required

}

echo($out); 
```

编辑：更改了 jeroen 指出的 htmlentities 的使用

# html - 如何将表格的第 th 个单元格排列在其下方 td 单元格的中间（在边框上）

> ID：14636081
> 
> 赞同：0
> 
> 时间：2013-01-31T22:09:40.123
> 
> 标签：html, css, html-table, alignment, text-align

![网格](../Images/88e56d444ce15700b408ac95155f07d3.png)

我正在尝试创建[此表格布局](https://i.stack.imgur.com/PBPN9.png)。基本上，`18`您在网格中看到的橙色表示周二上午 11 点到下午 12 点之间的使用率为 18%。所以这就是为什么顶部的小时最好在表格单元格的边缘，而不是在单元格的中间。这样它就可以显示代表一小时时间范围内使用情况的数据。

我基本上已经应用了一个基本的技巧，并沿着顶部右对齐了时间，所以它们看起来有点像它们在单元格之间。如您所见，这并不完美。

我想要做的实际上是让顶部的时间在数据单元之间很好地居中。我想我可以使用固定大小的列宽来做到这一点，但是表格需要拉伸到页面宽度的 100% 并且列宽的百分比。然后它可以扩展到更小的浏览器。

**有没有办法在 HTML 和 CSS 中做到这一点？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:23:01.177

您总是可以将每个表格标题文本包装成一个`<div>`标签，并使用 css`position:relative`或`left:2px`任何数量的像素使其看起来不错。

例子

```
<table>
  <tr>
    <th style="text-align:right;"><div style="position:relative;left:2px;">1</div></th>
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:32:30.920

您可以使用`position: relative;`将您的月份数字放置在您想要的位置，但这很棘手，因为表格单元格在 CSS 定位中经常表现得很奇怪。确切的定位可能取决于所使用的字体。

我想出了一个需要**2 个表**的解决方案。我们的想法是为标题设置一张表，为内容设置一张表。诀窍是在标题中**减少 1 个单元格。**

现场示例：http: [//jsfiddle.net/w6TnE/](http://jsfiddle.net/w6TnE/)

如您所见，月份数字与边框完全对齐。但请记住，此设置需要**固定宽度**，在本例中为 60px：

```
td, th{ border:1px solid #ccc; padding:5px 0; text-align:center; width:60px;} 
```

我只是添加了一些额外的样式以使其清晰。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T22:38:27.423

您可以在相对定位的元素中使用绝对定位的元素来获得您想要的效果。这个想法是用 为元素设置样式，然后在`<th>`元素中`position: relative`设置小时数本身的样式`position: absolute`。然后，您可以将数字放置在与单元格相关的任何位置。

[这](http://jsfiddle.net/zwRMB/)是一个示例 jsfiddle。要调整数字的位置，您可能希望对块中的`right`属性使用像素值而不是百分比。`th > span`

有关更多信息，您可能想了解不同的[定位方法](http://www.w3schools.com/css/css_positioning.asp)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T23:00:39.423

要使第一行真正居中在带有单个表格的底部单元格之间，您可以使用 colspan + widths 百分比而不使用定位。这样它就会很流畅，它适用于任何字体，并且当你使用 2 位数字时它不会被搞砸。

HTML：

```
<table border="0" cellpadding="0" cellspacing="0">
    <tbody>
        <tr>
            <td>&nbsp;</td>

            <th colspan="2">1</th>

            <th colspan="2">1</th>

            <th colspan="2">1</th>

            <th colspan="2">1</th>

            <th colspan="2">1</th>

            <td>&nbsp;</td>
        </tr>

        <tr>
            <td colspan="2">0</td>

            <td colspan="2">0</td>

            <td colspan="2">0</td>

            <td colspan="2">0</td>

            <td colspan="2">0</td>

            <td colspan="2">0</td>
        </tr>
    </tbody>
</table> 
```

CSS：

```
table {
    text-align: center;
    width: 70%;    
    }

table td {
    width:8.33%; // 100% divided by (double the number of bottom cells)
}

table th {
    width:16.66%; // 200% divided by (double the number of bottom cells)
}

table td[colspan="2"] {
    background:yellow;
}

table td,
table th {
    outline:1px solid tan;
} 
```

演示：http: [//jsfiddle.net/G7KZe/](http://jsfiddle.net/G7KZe/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T22:25:07.987

```
table td{ text-align:center;} 
```

这将使每个单元格的文本与中心对齐。

# json - d3.js json 未捕获的语法错误意外令牌 o

> ID：14636084
> 
> 赞同：1
> 
> 时间：2013-01-31T22:09:57.533
> 
> 标签：json, d3.js

另一个d3问题。

我正在玩打包的气泡示例，我已经到了一个地步，我试图弄清楚如何在没有外部 .json 文件的情况下加载数据。最终将打开的服务器不允许 .json 文件，我宁愿不尝试使用 jsonp 加载数据。

因此，我尝试创建一个将数据作为变量存储在代码中的版本。

```
var jsonl = {"name": "","children": [{"name": "A","children": [{"name": "AA","children": [{"name": "AAB", "size": "10", "area": "10"}]},{"name": "AB","children": [{"name": "ABB", "size": "20", "area": "20"}]}]}]}; 
```

我收到了一个未捕获的语法错误，虽然是意外的 token o 错误。我已经通过 JSLint 运行了 json，它说它很好，所以我不确定意外的令牌是什么。

我已将代码放在 jsfiddle 上。

[http://jsfiddle.net/9zpAN/](http://jsfiddle.net/9zpAN/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T05:54:24.897

您正在尝试`JSON.parse`在 JavaScript 对象上运行，而它需要一个字符串：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)

所以，不需要解析；您已经有了要使用的对象。

# google-chrome - 谷歌浏览器扩展开发环境

> ID：14636085
> 
> 赞同：1
> 
> 时间：2013-01-31T22:09:58.050
> 
> 标签：google-chrome, testing, google-chrome-extension

正如标题所示，我正在寻找更好的 Chrome 扩展开发环境。我正在为我的 IDE 使用 Sublime Text 2，这很好。问题在于测试扩展。现在，当我需要测试我编写的代码时，我首先必须使用 --enable-easy-off-store-extension-install 参数启动 Chrome。然后我需要通过 Chrome 将它打包为 .crx 文件。最后，我必须将文件拖放到 Chrome 中并手动安装。显然，这会很快变得非常耗时。

我知道我可以将扩展作为未打包的扩展进行测试，但这会导致权限错误，这是一个问题，因为我需要执行 COR。有没有更好的方法来测试 Chrome 中的扩展程序？

# emacs - 如何在不影响终止环的情况下将区域或整个缓冲区复制到 Emacs 中的另一个缓冲区？

> ID：14636090
> 
> 赞同：3
> 
> 时间：2013-01-31T22:10:14.780
> 
> 标签：emacs, elisp

我想将该区域复制到 Emacs 中的另一个（临时）缓冲区，但如果没有（活动）区域，我想复制整个当前缓冲区。我所做的如下：

```
(defun do-something-with-region-or-buffer ()
  (interactive)
  (save-excursion
    (let ((begin (point-min)) (end (point-max)))
      (when (region-active-p)
        (setq begin (region-beginning))
        (setq end (region-end)))
      (copy-region-as-kill begin end)
      (with-temp-buffer
        (switch-to-buffer (current-buffer))
        (rename-buffer "*My Temp Buffer*")
        (delete-other-windows)
        (yank)
        (do-something-with-current-buffer))))) 
```

然而，我有一种强烈的感觉，那就是这不是最理想的，因为我在搞乱杀戮戒指。如何在不影响的情况下做到这一点？（额外的问题：*如果*没有活动区域，我对区域*或*整个缓冲区的处理方式是一个好方法吗？）

 ** * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T22:38:33.857

我就是这样做的：

```
(defun aak/dswrob ()
  (interactive)
  (let* ((regionp (region-active-p))
         (beg (and regionp (region-beginning)))
         (end (and regionp (region-end)))
         (buf (current-buffer)))
    (with-temp-buffer
      (switch-to-buffer (current-buffer) nil t)
      (rename-buffer "*My Temp Buffer*" t)
      (insert-buffer-substring buf beg end)
      (read-key-sequence "Keys?")))) 
```

由您决定是否需要`insert-buffer-substring`或 `insert-buffer-substring-no-properties`，但无需使用杀戮戒指。

此外，在内部交互地做一些事情也很奇怪 `with-temp-buffer`：你是要在那里运行一种模态循环，还是只是显示一些进展？

至于对区域*或*整个缓冲区进行处理（注意：模 *变窄*），这并不罕见（见`replace-string`和朋友）。*

# spatial-index - 将矩形转换为希尔伯特数范围

> ID：14636092
> 
> 赞同：3
> 
> 时间：2013-01-31T22:10:18.603
> 
> 标签：spatial-index, spatial-query, hilbert-curve

当空间数据使用希尔伯特数表示时，一个矩形范围映射到多个希尔伯特数范围。有没有什么快速的方法可以在不遍历给定矩形 R 重叠的每个单元格的情况下找到这个映射？我可以考虑只考虑 R 的边界单元格然后对它们进行排序......有没有更好的方法？

谢谢。

# javascript - 调用 if 语句更好还是不断重新分配值？（javascript或任何语言）

> ID：14636096
> 
> 赞同：0
> 
> 时间：2013-01-31T22:10:52.133
> 
> 标签：javascript, performance, if-statement

> **可能重复：**
> [将变量的值更改为可能已经存在的值](https://stackoverflow.com/questions/14570189/changing-the-value-of-a-variable-to-what-it-might-already-be)

哪个更好：

```
if(value != 1){
   value = 1
} 
```

或者

```
value = 1 
```

（这是用于动画循环中的函数，因此它不断被调用，不知道这是否重要，但认为我应该包含该信息......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:15:24.320

[这与Computer Stupidities](http://www.rinkworks.com/stupid/cs_programming.shtml)上的一个故事非常相似：

> 我曾经在调试别人的旧代码时遇到过这个 gem：
> 
> ```
> if (value == 0)
>    return value;
> else
>    return 0; 
> ```

在您的代码中，无论 的原始值如何`value`，它总是会`1`在最后。所以就这样设置吧。

# python - 从列表创建 django 表单时出错。

> ID：14636097
> 
> 赞同：0
> 
> 时间：2013-01-31T22:10:52.497
> 
> 标签：python, django

错误：

```
'list' object has no attribute '_meta' 
```

表格.py：

```
from django.db import models
from django.forms import ModelForm
from django import forms

class Blog(models.Model):
    blog_id = models.CharField(max_length=100)

class TumblrForm(ModelForm):
    class Meta:
        model = Blog
        fields = ('blog_id',)
        widgets = {
            'blog_id':forms.RadioSelect(),
        } 
```

表单创建：

```
form = TumblrForm(instance=blogs_id) #blogs_id is a list of blog urls 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:12:18.890

A`ModelForm`编辑一个实例。您不能将网址列表传递给它。它需要一个`Blog`.

```
TumblrForm(instance=Blog.objects.get(pk=1)) 
```

如果您想编辑多个 ModelForm，您需要查看 django 的`FormSet`.

# rest - 使用外部服务测试 Angular $resource

> ID：14636099
> 
> 赞同：3
> 
> 时间：2013-01-31T22:11:04.303
> 
> 标签：rest, testing, angularjs

我正在尝试对使用 Angular $resource 进行的 REST 请求进行一些基本测试。服务代码工作得很好。

```
'use strict';

angular.module('lelylan.services', ['ngResource']).
  factory('Device', ['Settings', '$resource', '$http', function(Settings, $resource, $http) {

    var token = 'df39d56eaa83cf94ef546cebdfb31241327e62f8712ddc4fad0297e8de746f62';
    $http.defaults.headers.common["Authorization"] = 'Bearer ' + token;

    var resource = $resource(
      'http://localhost:port/devices/:id',
      { port: ':3001', id: '@id' },
      { update: { method: 'PUT' } }
    );

    return resource;
  }]); 
```

我在指令中使用设备资源，它可以工作。当我开始对服务进行一些测试时，问题就出现了。这是一个示例测试，其中我使用 $httpBackend 模拟 HTTP 请求，并向模拟的 URL 发出请求。

不幸的是，尽管提出了请求，但它没有返回任何内容。我确信这一点，因为如果向另一个 URL 发出请求，测试套件会自动引发错误。我花了很多时间，但没有解决方案。这里是测试代码。

```
'use strict';

var $httpBackend;

describe('Services', function() {

  beforeEach(module('lelylan'));

  beforeEach(inject(function($injector) {
    var uri = 'http://localhost:3001/devices/50c61ff1d033a9b610000001';
    var device = { name: 'Light', updated_at: '2012-12-20T18:40:19Z' };
    $httpBackend = $injector.get('$httpBackend');
    $httpBackend.whenGET(uri).respond(device)
  }));

  describe('Device#get', function() {
    it('returns a JSON', inject(function(Device) {
      device = Device.get({ id: '50c61ff1d033a9b610000001' });
      expect(device.name).toEqual('Light');
    }));
  });
}); 
```

由于设备未加载，这是错误。

```
Expected undefined to equal 'Light'.
Error: Expected undefined to equal 'Light'. 
```

我也尝试过使用以下解决方案，但它没有进入检查预期的功能。

```
it('returns a JSON', inject(function(Device) {
  device = Device.get({ id: '50c61ff1d033a9b610000001' }, function() {
    expect(device.name).toEqual('Light');
  });
})); 
```

非常感谢任何解决此问题的建议或链接。非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:39:11.947

You were very close, the only thing missing was a call to the `$httpBackend.flush();`. The working test looks like follows:

```
it('returns a JSON', inject(function(Device) {
  var device = Device.get({ id: '50c61ff1d033a9b610000001' });
  $httpBackend.flush();
  expect(device.name).toEqual('Light');
})); 
```

and a live test in plunker: [http://plnkr.co/edit/Pp0LbLHs0Qxlgqkl948l?p=preview](http://plnkr.co/edit/Pp0LbLHs0Qxlgqkl948l?p=preview)

You might also want to check [docs for the $httpBackend mock](http://docs.angularjs.org/api/ngMock.$httpBackend).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T15:41:27.583

在更高版本的 Angular 中，我使用的是 1.2.0rc1，您还需要在 $apply 中调用它或在范围内调用 $digest。除非您执行以下操作，否则不会进行资源调用：

```
var o, back, scope;

beforeEach(inject(function( $httpBackend, TestAPI,$rootScope) {
    o = TestAPI;
    back = $httpBackend;
    scope = $rootScope.$new();

}));

it('should call the test api service', function() {
    back.whenGET('/api/test').respond({});
    back.expectGET('/api/test');
    scope.$apply( o.test());
    back.flush();
}); 
```

# android - 如何通过短信发送谷歌地图位置

> ID：14636100
> 
> 赞同：1
> 
> 时间：2013-01-31T22:11:05.427
> 
> 标签：android, google-maps, smsmanager

如何`LocationManager`在文本字符串中分配变量`SMSManager`？我想将带有坐标的短信作为短信发送。

私人位置管理器lm；私人位置监听器位置监听器；

```
 lm = (LocationManager) 
            getSystemService(Context.LOCATION_SERVICE);

        locationListener = new MyLocationListener();   

        lm.requestLocationUpdates(
                LocationManager.GPS_PROVIDER, 
             0, 
             0, 
            locationListener);
        lm.requestLocationUpdates(

            LocationManager.NETWORK_PROVIDER, 
            0, 
            0, 
            locationListener);

btnSendSMS = (Button) findViewById(R.id.btnSendSMS);
    btnSendSMS.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            sendSMS("55565", "coords" );

        }
    });

 private void sendSMS(String phoneNumber, String message) {

    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber, null, message, null, null);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T08:22:11.553

这是我通过电子邮件和短信发送当前位置的代码希望它有帮助:) 根据您的需要修改它

```
final LocationManager mlocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);

    final LocationListener mlocListener = new MyLocationListener();

    final Location location = mlocManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    updateWithNewLocation(location);
    mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, mlocListener);
    mc=mapview.getController();
    mc.setZoom(18);
    mlo=new MyLocationOverlay(this,mapview);
    mapview.getOverlays().add(mlo);
    mapview.invalidate();   
    }

    public class MyLocationListener implements LocationListener

    {

    public void onLocationChanged(final Location location)
    {
        updateWithNewLocation(location);
    }
    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub

    }

    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub

    }

    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub

    }

    }

    private void updateWithNewLocation(final Location location)
    {
    mapview=(MapView) findViewById(R.id.map);
    String latLongString;
    TextView myLocationText;
    myLocationText = (TextView)findViewById(R.id.text);
    String addressString = "No address found";

    if ( location != null )
    {
    final double lat = location.getLatitude();
    final double lng = location.getLongitude();

    latLongString = "Lat:" + lat + "\nLong:" + lng;
    final double latitude = location.getLatitude();
    final double longitude = location.getLongitude();
    final Geocoder gc = new Geocoder(this, Locale.getDefault());

    final GeoPoint myLocation = new GeoPoint((int)(lat * 1000000), (int)(lng * 1000000));
    mapview.getController().animateTo(myLocation);
    mapview.getController().setCenter(myLocation);

    try
    {
    final List<Address> addresses = gc.getFromLocation(latitude, longitude, 4);
    final StringBuilder sb = new StringBuilder();
    if ( addresses.size() > 0 )
    {
        final Address address = addresses.get(0);
        for ( int i = 0; i < address.getMaxAddressLineIndex(); i++ )
        {
            sb.append(address.getAddressLine(i)).append("\n");
        }
        sb.append(address.getLocality()).append("\n");
        sb.append(address.getPostalCode()).append("\n");
        sb.append(address.getCountryName());
    }
    addressString = sb.toString();
    }
    catch ( final IOException e )
    {
    }
    }
    else
    {
    latLongString = "No location found";
    }
    myLocationText.setText("Your Current Position is:\n" +
    latLongString + "\n" + addressString);

    }

    @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // TODO Auto-generated method stub
        MenuInflater inf = getMenuInflater();
        inf.inflate(R.menu.newmenu, menu);
            return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        String tv1; 
        TextView myLocationText;
        myLocationText = (TextView)findViewById(R.id.text);
        tv1= myLocationText.getText().toString(); 
    switch (item.getItemId()) {
    case R.id.msg:

        Intent sendIntent = new Intent(Intent.ACTION_VIEW);
        sendIntent.putExtra("sms_body", tv1); 
        sendIntent.setType("vnd.android-dir/mms-sms");
        startActivity(sendIntent); 

    return(true);
    case R.id.email:
        /* Create the Intent */
        final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);

        /* Fill it with Data */
        emailIntent.setType("plain/text");
        emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[]{"to@email.com"});
        emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "Subject");
        emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, tv1);
        startActivity(Intent.createChooser(emailIntent, "Send mail..."));
         return(true);
    }
    return(super.onOptionsItemSelected(item));
    } 
```

# mysql - MySQL I/O 错误

> ID：14636106
> 
> 赞同：1
> 
> 时间：2013-01-31T22:11:19.500
> 
> 标签：mysql

我收到以下错误：

```
Can't create table 'tmp' (errno: 5) CREATE TABLE IF NOT EXISTS tmp 
```

尝试使用数据文件读取目录时，我得到以下信息：

```
ls: reading directory .: Input/output error 
```

在 mysql 中：

```
mysql> show tables;
Empty set (0.28 sec) 
```

但 ...

```
mysql> select * from nw_site LIMIT 0,1;
1 row in set (0.00 sec) 
```

因此，即使存在 I/O 错误，SELECT 和 UPDATE 也可以正常工作。该网站似乎仍在运行。

mysqldump 很遗憾无法取出任何数据，这意味着我没有备份——只有 3 天的空 mysqldumps。由于该网站工作正常，我只是注意到了。

任何想法如何进行？我很想以某种方式获得备份。

** 编辑 **

我找到了一种无需 mysqldump 即可获得备份的方法： [http ://www.perlmonks.org/?node_id=149869](http://www.perlmonks.org/?node_id=149869)

# c# - C# 用户输入随机数

> ID：14636107
> 
> 赞同：-4
> 
> 时间：2013-01-31T22:11:21.667
> 
> 标签：c#, loops, if-statement, random, input

我需要帮助编写一个代码，让用户在不重复相同数字的情况下输入 50 到 150 之间的 10 个数字。这将是一个循环程序。这是我到目前为止所拥有的：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace IP3_Program
{
    class Program
    {
        static void Main()
        {
            int total = 0;
            string inValue;
            int [] number = new int[10];
            for (int i = 0; i < number.Length; i++)
            {
                Console.Write("Enter number{0}: ", i + 1);
                inValue = Console.ReadLine();
                number[i] = Convert.ToInt32(inValue);
            }              
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:18:40.423

```
var numbers = new List<int>();
while (numbers.Count != 10)
{
    // get number from user

    if (numbers.Contains(newNumber) || newNumber < 50 || newNumber > 150)
    {
        // reject the number
        // you'd probably want to display a message here
        // alerting the user another input in needed
    }
    else
    {
        numbers.Add(newNumber);
    }
} 
```

# facebook - facebook 会在他们的服务器上保留照片的 exif 吗？

> ID：14636109
> 
> 赞同：0
> 
> 时间：2013-01-31T22:11:31.463
> 
> 标签：facebook, facebook-graph-api, metadata, exif

我知道 facebook 会删除上传的 exif 数据。我的问题是：他们是否仍将原始照片及其 exif 数据保存在服务器端？如果是这样，我们“开发者”可以访问 facebook 照片的 exif 数据吗？

谢谢

# javascript - 为什么这个事件不断被解雇？

> ID：14636111
> 
> 赞同：0
> 
> 时间：2013-01-31T22:11:40.503
> 
> 标签：javascript, cross-browser, infinite-loop

此脚本检查表单是否已正确填写，但`toggle()`函数不断被触发（至少在 FireFox 中）。在下面的示例中，“现在在这里”在表单有效后继续显示（即所有字段都有一些文本）。

```
<script type="text/javascript">
        <!--
        function toggle()
        {
            if(document.getElementById('username').value.length > 1 && document.getElementById('pw1').value.length > 1 && document.getElementById('pw2').value.length > 1 && (document.getElementById('pw1').value == document.getElementById('pw2').value))
            {
                alert("now here")
                document.getElementById('submit').disabled = false
            }
        }
//-->
</scipt>
Username:<input type="text" name='username' id='username' maxlength="30" onkeyup="toggle()"/><br />
        Password:<input type="password" name="pw1" id="pw1" onkeyup="passwordCheck(document.getElementById('pw1'), document.getElementById('pw2')); toggle()"/><br />
        Confirm password:<input type="password" name="pw2" id="pw2" onkeyup="passwordCheck(document.getElementById('pw1'), document.getElementById('pw2')); toggle()"/> 
```

我很受伤，为什么`onkeyup`总是被解雇？就好像用户从来没有把手指从钥匙上拿开一样。是因为`onkeyup`当它触发警报窗口时被搞砸了，因为焦点从文本字段变为窗口并且当按下确定时焦点又变回文本字段？

更新：我在 Bugzilla 中[找到了它。](https://bugzilla.mozilla.org/show_bug.cgi?id=112298)你可以[投票给它](https://bugzilla.mozilla.org/page.cgi?id=voting/user.html&bug_id=112298#vote_112298)。2001年底就被报道了，为什么豆子这么长还不修？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:42:07.553

看起来您希望该功能在正确填写表单后将提交从禁用更改为启用。每次`onKeyUp`使用所有三个输入调用该函数时都应该触发该函数，因为您在所有三个输入中都调用它。

我的 jsfiddle ( [http://jsfiddle.net/BhaeG/](http://jsfiddle.net/BhaeG/) ) 仅`alert("now here")`在 if 语句的所有条件都正确时触发。

除非我真的错过了什么，否则它似乎按设计工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:39:06.827

在 FireFox 中，如果您在警报窗口上按 Enter 键，它会触发`onKeyUp`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-17T18:46:50.083

我通过使用 onkeydown 而不是 onkeyup 解决了这个问题。YMMV。

# visual-studio - Visual Studio 和 Resharper 以及符号完成

> ID：14636112
> 
> 赞同：2
> 
> 时间：2013-01-31T22:11:41.290
> 
> 标签：visual-studio, resharper

在 Intellij 或 Eclipse 中，当我开始键入尚未导入的类时，我会得到建议。例如，如果我键入“Lis”，我很可能会收到大量关于我的类路径中的各种 List 类的建议。如果我不知道如何正确拼写课程或不确切知道我在做什么，我可以通过打字快速完成。在 VS 2012 中，即使使用 Resharper，我也无法重现此行为。它确实有所作为，在VS中不可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:15:02.243

为此，我使用了[导入符号完成](http://www.jetbrains.com/resharper/webhelp/Coding_Assistance__Code_Completion__Type_Name.html)功能。

只需写下部分名称（或驼峰式首字母缩写）并按：`Shift`+ `Alt`+ `Space`（VS 快捷方式）或`Ctrl`+ `Alt`+ `Space`（IntelliJ 快捷方式）

这甚至适用于尚未导入命名空间的类型/符号（ReSharper 将添加它们）。

# qt - 使用 MinGW 安装 Qt Creator

> ID：14636114
> 
> 赞同：5
> 
> 时间：2013-01-31T22:11:45.897
> 
> 标签：qt, mingw

所以看起来Digia从诺基亚手中接管了Qt，获得一些简单的下载是相当混乱的。

如果我现在转到下载页面 ( [http://qt-project.org/downloads](http://qt-project.org/downloads) )，我看到有一个适用于 Windows 的 Qt Creator 2.6.2 下载。当我下载并运行安装时，MinGW 似乎不再与它一起打包。

我尝试单独安装 MinGW 4.4，然后添加一个工具链，但是当我尝试编译基于 CMake 的项目时没有任何运行。

然后我发现了提供 Qt SDK 1.2.1 的诺基亚网站；但是现在看起来他们要求您创建一个帐户才能下载安装程序。

可能会建议下载全套 Qt 库，但这不是最好的主意，因为我基本上是在为我一直使用的基于 CMake 的开源库集编写安装过程工作了一段时间（[http://tudat.tudelft.nl](http://tudat.tudelft.nl)）。

用户不满意必须下载所有 Qt 库，因为我们没有使用其中任何一个。

我现在已经完全用完了解决方案（请注意，这似乎只是 Windows 的问题，因为当我在 Linux 和 Mac 上安装 Qt Creator 时，GCC 自动检测似乎工作正常）。

所以，简而言之，是否有人有一个简单的安装例程来安装 Qt Creator 并让它与 MinGW 一起编译基于 CMake 的项目？

提前致谢！

卡提克

PS：我知道Qt Creator + MinGW上有很多线程，但是随着Digia和诺基亚网站最近的变化，它们现在似乎都已经过时了。

* * *

我应该补充一点，问题不在于在 Windows 下无法自动检测到工具链。通过将 MinGW 和 CMake 添加到系统路径中，我已经设法让 Qt Creator 自动检测到 MinGW 和 CMake。问题是当我尝试为我的项目打开 CMakeLists.txt 文件时，我无法选择任何生成器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-09T19:32:04.663

直截了当：

1.  安装 Qt 框架
2.  安装 MinGw
3.  安装 CMake
4.  安装其他东西，例如 git
5.  安装 Qt Creator

正如您已经提到的，Qt Creator 很有可能通过自动检测获取所有内容。不过，如果一切就绪，您应该检查 Qt 设置，例如调试器。

第一次打开 cmake 项目时，Qt Creator（应该）要求使用工具链。如果以后要更改链，请删除构建文件和 cmake 目录。

Qt Creator 和 cmake 的更多详细信息：http: [//qt-project.org/doc/qtcreator-2.7/creator-project-cmake.html](http://qt-project.org/doc/qtcreator-2.7/creator-project-cmake.html)

# crystal-reports - Crystal Reports 在饼图中抑制 0

> ID：14636117
> 
> 赞同：0
> 
> 时间：2013-01-31T22:12:26.127
> 
> 标签：crystal-reports, pie-chart

提前感谢您的帮助，

我有一个在 Crystal Reports 2011 中制作的 Crystal Report。该报告从视图中进行了简单的选择，并使用了大约 6 个列。

在 2 个连续部分中，有一个交叉表和一个饼图，它们都报告相同的公式字段。该字段的公式如下：

```
 iif( IsNull({IROView.OVERTURNREASON})=false, {OVERTURNREASON},"") 
```

基本上，如果我的值不为空，我会得到该值，如果是，我会得到一个空字符串。

在交叉选项卡的自定义样式选项卡下，有一个抑制空行和抑制空列复选框。我正在为饼图寻找类似的东西，因为即使空字符串没有切片，图例也有一个值为 0（或 0%）的空白字符串条目。

再次感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:32:48.160

您可能需要考虑更新图表引擎以使用最新版本的[CRChart](http://www.threedgraphics.com/tdg/products/tools/crchart/product_info.php)。三维图形为 SAP 编写了原始组件（nee BusinessObjects nee Crystal Decisions nee Seagate Software）；他们拥有源代码。@HIDE_ZERO宏可能会完全[满足](http://www.threedgraphics.com/tdg/products/tools/crchart/html_docs/docs/macros/hide_zero.htm)您的需要。

# android - Android从点数据库设置GoolgeMap边界

> ID：14636118
> 
> 赞同：6
> 
> 时间：2013-01-31T22:12:34.537
> 
> 标签：android, android-maps-v2

使用 Google Maps Android API v2，我正在尝试使用`LatLngBounds.Builder()`数据库中的点来设置地图的边界。我想我已经接近了，但是活动正在崩溃，因为我认为我没有正确加载积分。我可能就在几行之外。

```
//setup map
private void setUpMap() {

    //get all cars from the datbase with getter method
    List<Car> K = db.getAllCars();

    //loop through cars in the database
    for (Car cn : K) {

        //add a map marker for each car, with description as the title using getter methods
        mapView.addMarker(new MarkerOptions().position(new LatLng(cn.getLatitude(), cn.getLongitude())).title(cn.getDescription()));

        //use .include to put add each point to be included in the bounds   
        bounds = new LatLngBounds.Builder().include(new LatLng(cn.getLatitude(), cn.getLongitude())).build();

       //set bounds with all the map points
       mapView.moveCamera(CameraUpdateFactory.newLatLngBounds(bounds, 50));
    }
} 
```

我认为我如何安排 for 循环以获取所有汽车可能存在错误，如果我删除边界语句，则地图点按预期正确绘制但未正确界定地图。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-02T04:28:20.423

您每次都在循环中创建一个新的 LatLngBounds.Builder() 。尝试这个

```
private LatLngBounds.Builder bounds;
//setup map
private void setUpMap() {

    bounds = new LatLngBounds.Builder();   
    //get all cars from the datbase with getter method
    List<Car> K = db.getAllCars();

    //loop through cars in the database
    for (Car cn : K) {

        //add a map marker for each car, with description as the title using getter methods
        mapView.addMarker(new MarkerOptions().position(new LatLng(cn.getLatitude(), cn.getLongitude())).title(cn.getDescription()));

        //use .include to put add each point to be included in the bounds   
        bounds.include(new LatLng(cn.getLatitude(), cn.getLongitude()));

    }
    //set bounds with all the map points
    mapView.moveCamera(CameraUpdateFactory.newLatLngBounds(bounds.build(), 50));
} 
```

# django - Django formset 和外键保存

> ID：14636119
> 
> 赞同：0
> 
> 时间：2013-01-31T22:12:44.303
> 
> 标签：django, formset

我几乎尝试了我在互联网上找到的所有想法，但仍然无法正常工作，

```
class RankedSkill(models.Model):
    RANK_CHOICES = (
        (1, 1),
        (2, 2),
        (3, 3),
        (4, 4),
        (5, 5),
        (6, 6),
        (7, 7),
        (8, 8),
        (9, 9),
        (10, 10),
    )
    skill = models.ForeignKey(Skill, related_name='ranks')
    rank = models.IntegerField(max_length=2, choices=RANK_CHOICES)
    assessment = models.ForeignKey(Assessment, related_name='skill_ranks')
) 
```

评估和技能是另一种模型。在我的应用程序中，我想为每项技能创建表单来对它们进行排名。为此，我使用了 django formset，我从 RankedSkillForms 创建了一个 formset，其中包含通过 Skill.objects.all() 获得的初始数据。

```
skills = Skill.objects.all()
SkillFormSet = formset_factory(SkillRankForm, max_num=skills.count())
if request.method == 'POST':
    formset = SkillFormSet(request.POST)
    if formset.is_valid:
        person = get_object_or_404(People, id=person_id)
        assessment = Assessment.objects.create(supervisor=request.user, employee=person)
        for form in formset.forms:
            ranked_skill = form.save() # error coming from here
            ranked_skill.assessment = assessment
            ranked_skill.save()
    else:
        return render(request, 'people/make_assessment.html', {'formset': formset})
else:
    initial = []
    for skill in skills:
        initial.append({'skill': skill})
    formset = SkillFormSet(initial=initial)
    return render(request, 'people/make_assessment.html', {'formset': formset}) 
```

一切正常，直到我尝试保存。

它以 u'Skill Object' 字符串的形式获取初始数据（技能）。（我删除了 unicode，因为在该技能名称出现之前而不是 u'Skill Object' 字符串之前）

错误消息是“无法分配“u'Skill object'”：“RankedSkill.skill”必须是“Skill”实例。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:20:46.613

您`SkillRankForm`正在接受字符串而不是 PK 或实例。

你需要要么...

修改表单以使用 PK 而不是 Text，例如 with`skills = forms.ModelChoiceField`
或将传入的字符串强制转换为表单（或视图，甚至）中的技能对象。

```
 ranked_skill = form.save(commit=False)
        skill, created = Skill.objects.get_or_create(name=form.cleaned_data['skill'])  
                                           #^^^^ assuming there's a name field
        ranked_skill.skill = skill
        ranked_skill.save() 
```

还有一件事......你应该修复你的表单集验证：

```
if formset.is_valid: 
               #^^^ you need to call is_valid() or this will always return True. 
```

# unit-testing - 在模型中加载数据库时未显示 CIUnit 测试结果

> ID：14636130
> 
> 赞同：0
> 
> 时间：2013-01-31T22:14:09.450
> 
> 标签：unit-testing, phpunit, codeigniter-2

我正在尝试让 CIUnit 与我的 Fedora 17 64 位机器一起工作。在使用我现有的代码学习[本](http://d.hatena.ne.jp/Kenji_s/20120117/1326763908)教程时，我遇到了如下所示的奇怪行为。

```
[root@fedora tests]# phpunit --debug
PHPUnit 3.7.13 by Sebastian Bergmann.
Configuration read from /test_app/tests/phpunit.xml
Starting test 'ManagerModelTest::testNumServers'.
[root@fedora tests]# 
```

然后，什么也没有发生。我在 Windows 7 上测试了完全相同的代码，它运行良好（显示了断言和失败的测试数量）。但是当我在fedora上尝试时，没有显示任何结果。以下是我的模型和测试类。

```
class Manager_model extends CI_Model
{
    public function __construct()
    {
        parent::__construct();
        $this->load->database('agreements');
    }
}

class ManagerModelTest extends CIUnit_TestCase
{
    private $mm;

    public function setUp()
    {
        parent::setUp();
        $this->CI->load->model('manager_model');
        $this->mm = $this->CI->manager_model;
    }

    public function testNumServers()
    {
        $this->assertTrue(FALSE);
    }
} 
```

我什至没有在测试中使用任何模型函数。但是，如果我在模型中注释掉`$this->load->database('agreements');`，它工作正常。我检查了日志文件，但没有发现错误消息。为什么这发生在 Fedora 机器上，而不是在 Windows 7 上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T17:34:18.883

原来我的 php-cli 没有加载 mysql.ini，因此不支持`mysql_connect()`. 安装 php-mysql 后，它似乎工作正常。

# json - 如何使用 ko.mapping 脚本（Razor 页面）访问和显示映射数据？

> ID：14636135
> 
> 赞同：0
> 
> 时间：2013-01-31T22:14:29.793
> 
> 标签：json, knockout.js

Java 脚本（使用[Can`t get json object to with knockout](https://stackoverflow.com/questions/14616138/cant-get-json-object-to-with-knockout) answer {1} 方法获取数据）：

```
<script type="text/javascript">
    $.getJSON("/api/TelemarketingApi", function (result) {
        function viewModel() {            
            return ko.mapping.fromJS(result);
        };
        ko.applyBindings(new viewModel());
    })
    .error(function () { alert("error"); });
</script> 
```

JSON对象：

```
[
    {
        "TelemCalls": [ {"ID": 1, "duratio": "11"}],
        "ID": 1,
        "FirstName": "Jonas",
        "LastName": "Jonaitis",
        "Phone": "860123123",
        "Municipality": null
    }
] 
```

如何在**剃须刀**页面中访问和显示映射的 JSON 数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T08:53:22.360

请记住，您的映射数据只能在 JavaScript 中访问，而不是在 Razor 构建页面时在服务器端访问。因此，要在页面上显示 viewModel 的属性值，请尝试以下操作：

```
<input data-bind="value: FirstName" />
<ul data-bind="foreach: TelemCalls">
    <li data-bind="text: duratio"></li>
</ul> 
```

如果您的顶级视图模型是一个数组，请使用以下语法：

```
<div data-bind="$data">
    <input data-bind="value: FirstName" />
    <ul data-bind="foreach: TelemCalls">
        <li data-bind="text: duratio"></li>
    </ul>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T08:49:14.077

您是否将 viewModel 从 json 对象映射并绑定到整个剃须刀视图。要在 razor 视图中显示值，只需创建绑定到 viewModel 的 html 元素，如下所示：

```
<input type="text" data-bind="value: ID" />
<input type="text" data-bind="value: FirstName" />
<input type="text" data-bind="value: LastName" />
<input type="text" data-bind="value: Phone" />
<input type="text" data-bind="value: Municipality" /> 
```

小提琴中的示例：http: [//jsfiddle.net/vfportero/hcVmZ/](http://jsfiddle.net/vfportero/hcVmZ/)

# linux - 符号链接数百个 wordpress 网站

> ID：14636139
> 
> 赞同：2
> 
> 时间：2013-01-31T22:14:37.420
> 
> 标签：linux, wordpress, symlink

PHP程序员在这里。老板希望我创建多个 wordpress 网站，这些网站通过符号链接回到单个父 wordpress 目录。每个网站都驻留在一个单独的 Linux 用户帐户中。换句话说，一个父母，许多孩子副本，都驻留在不同的 /home/ 帐户中。我需要符号链接策略方面的帮助...

到目前为止，对于每个新的 linux 网络帐户，

1.  安装数据库
2.  sed 将配置值替换为临时配置文件
3.  mysql插入一些配置数据
4.  符号链接？？？

    一种。每个wordpress文件？？

    湾。整个 public_html 目录？？

如果我更改父 wordpress PHP 代码，我可以将配置文件的“真实”副本放在子用户目录中，在符号链接的 public_html 上方。所以，我只需要使用一个子符号链接到父的 public_html 目录。但是，apache 返回 500 错误。如何设置权限？

权限是问题。chgrp 会起作用吗？哪个组？什么文件模式？或者我需要创建一个特殊的组来容纳 apache 用户，没人吗？

任何帮助将不胜感激。欢迎使用代码示例 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T01:40:19.557

问题的原因（偏执的安全性，“切换用户”阻止）：

```
PHP 5 Handler   suphp
Suexec  on 
```

问题的解决方案（DSO）：

```
PHP 5 Handler   dso
Suexec  off 
```

性能优化，在 httpd.conf LINE 75 添加了 +FollowSymLinks：

```
<Directory "/">
    Options All +FollowSymLinks
    AllowOverride All
</Directory> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T00:03:35.017

每个 linux 用户都必须有一个 wp-content 目录和一个 wp-config.php 文件。不要忘记为 wp-content 目录设置写入权限。

您可以将其余的 wordpress 文件符号链接到全局 wordpress 文件。

linux 用户不能写入全局 wordpress 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T21:20:01.673

这是很有可能做到的。实际上，我已经写了一篇详细的文章来解释符号链接 WordPress 目录的过程。

1.  基本上这个想法是替换 wp-config.php 文件。

2.  从 github 下载 WordPress 的 repo，您​​可以使用一个简单的命令切换到新版本或旧版本的 WordPress。“git checkout 3.7 分支”

这是完整的说明集：http: [//www.htmlgraphic.com/symlinking-wordpress-core-files-wordpress-skeleton/](http://www.htmlgraphic.com/symlinking-wordpress-core-files-wordpress-skeleton/)

# php - 包含期间的PHP操作码内存占用？

> ID：14636141
> 
> 赞同：1
> 
> 时间：2013-01-31T22:14:52.290
> 
> 标签：php, memory, include, php-opcode

在优化网站的内存时，我注意到内存消耗的飞跃，同时包含大量用于特定目的的 PHP 类文件（600+）。分开来看，我注意到包含一个 PHP 文件（因此可能编译为操作码）占用的内存大约是磁盘上文件大小的 50 倍。

在我的例子中，磁盘上的文件总共有大约**800 kB**大小（带有缩进和注释，纯类声明，字符串不多），但是在包含所有文件后，内存消耗大约高出**40 MB**。

我这样测量（PHP 5.3.6）：

```
echo memory_get_usage(), "<br>\n";
include($file);
echo memory_get_usage(), "<br>\n"; 
```

在 600 个文件的循环中，我可以看到内存消耗从基本上为零增长到 40 MB。（没有自动加载器加载额外的类，或者任何立即执行的全局代码或构造函数代码，它实际上只是纯粹的包含。）

这是正常行为吗？我假设操作码比纯源代码更紧凑（去掉所有空格和注释，或者只有一两个指令字节而不是“foreach”字符串等）？

如果这是正常的，有没有办法优化它？（我假设使用操作码缓存只会节省我的编译时间，而不是实际的内存消耗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T13:44:13.910

**显然这就是它的方式。**

我已经从头开始重新测试了这个：

*   包含一个空的零长度文件：增加**784 字节**内存消耗
*   包含一个空类 X { } 定义：**2128 字节**
*   包含一个具有一个空方法的类：**2816 字节**
*   包含一个具有两个空方法的类：**3504 字节**

在所有测试中，包含文件的文件大小都小于 150 字节。

# linq - LINQ : Distinct 和 Orderby

> ID：14636142
> 
> 赞同：13
> 
> 时间：2013-01-31T22:15:01.400
> 
> 标签：linq, sql-order-by, distinct

我正在尝试使用 LINQ (to EF) 获取 DISTINCT 列表，然后对其进行排序。我找到的所有示例都根据 DISTINCT 值对结果进行排序。但我想在不同的领域对其进行排序。

示例：具有 2 个字段（canvasSize 和 canvasLength）的表格；

```
var sizes = (from s in ent.competitors                         
             select s.canvasSize).Distinct().OrderBy(x => x); 
```

我找到的所有例子都给出了这种类型的答案。但它按 canvasSize 排序，而我想按 canvasLength 排序。

我被卡住了......任何提示都非常感谢......

每 J. Skeet > 附加信息：

```
company  canvasSize  canvasLength

abc       8x10         8
d         8x10         8
e         10x10        10
f         10x10        10
g         40x40        40 
```

我希望它在 canvasSize 上与众不同。问题是在排序时，结果是这样的：

```
10x10
40x40
8x10 
```

我想要相同的结果集，但使用 canvasLength 排序，所以结果是：

```
8x10
10x10
40x40 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-31T22:19:42.543

我认为您所追求的可能是这样的：

```
var sizes = (from s in ent.competitors                         
             select new { s.canvasSize, s.canvasLength })
            .Distinct()
            .OrderBy(x => x.canvasLength); 
```

**更新**

根据您问题中的额外信息，以下内容应该可以满足您的要求：

```
var sizes = ent.competitors
               .Select(c => new {c.canvasSize, c.canvasLength})
               .Distinct()
               .OrderBy(x => x.canvasLength)
               .Select(x => x.CanvasSize) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:18:45.453

```
var sizes = ent.competitors
               .GroupBy(s => s.canvasSize)
               .Select(g => g.First())
               .OrderBy(s => s.canvasLength); 
```

# jquery - jquery移动按钮扩展页面尺寸

> ID：14636144
> 
> 赞同：0
> 
> 时间：2013-01-31T22:15:03.057
> 
> 标签：jquery, jquery-mobile, button, mobile, html-table

我有一个我一直在构建的移动网站，并且按钮从页面上延伸出来，以获取更长文本的按钮。

我注意到，当我在 jquery mobile 中使用内置列时，它会自动截断按钮，否则它们的文本会超出页面宽度。它通过让按钮文本在需要将其切断的末尾只有“....”来做到这一点。

由于我的页面是用于格式化的，我不想为我的页面使用双列或三列，因为我希望按钮占据页面的 2/3，而标题占据 1/3。下图将显示这一点，并且按钮离开右侧的页面：

![在此处输入图像描述](../Images/6537609c32b6a4b4af6b024eb974972f.png)

更长的话它更糟糕。现在，因为我希望按钮占据 2/3，所以我正在使用带有 colspan 的表格：

打印 ”

```
<table border=\"0\" width=\"100%\">
                <tr>
                    <td> <h3>Brewery:</h3></td>
                    <td colspan=\"2\"> <a href=\"$breweryURL\" data-theme=\"b\" data-ajax = \"false\" data-role=\"button\">$brewery</a>  </td>
                </tr>
                <tr>
                    <td><h3>Style:</h3></td>
                    <td colspan=\"2\"> <a href=\"$styleURL\" data-theme=\"b\" data-ajax = \"false\" data-role=\"button\">$style</a>  </td>
                </tr>

            </table>
        "; 
```

# sharepoint - 如何回滚 Sharepoint 内容编辑器

> ID：14636145
> 
> 赞同：1
> 
> 时间：2013-01-31T22:15:03.437
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-2007

我的团队网站上有内容编辑器，我在其中添加了几个链接。但是今天在添加一些新链接时，内容编辑器崩溃了。所以现在当我试图打开包含内容编辑器的网站时，浏览器停止工作。

快速解决方案是：我可以删除现有的内容编辑器并创建一个新的（`?contents=1`在损坏的团队网站中使用）。但是由于我的内容编辑器包含很多链接，所以有没有办法可以将内容编辑器回滚到以前的版本（直到昨天下午）？

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:24:57.017

Stackoverflow 是关于编程相关的问题，您的问题更多是用户问题。

您不能回滚内容编辑器。如果您为拥有内容编辑器的页面启用了版本控制，那么您可能很幸运并且可以检索到早期版本。否则，您只能检查数据库中的内容编辑器内容，但这将是一项非常繁琐的任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:34:31.330

您以前的版本可能在混乱中丢失了。您必须转到站点管理员，然后关闭/删除 Web 部件并重新开始。您可以简单地关闭 Web 部件（从站点管理员），然后编辑 Web 部件属性以挽救其内容。

无论哪种方式，都不应将内容直接添加到内容编辑器 Web 部件中（因此）。相反，应使用该选项指向 SharePoint 网站其他位置的文档库中的文件，并启用版本控制。

然后，在 CEWP 将页面从编辑到内容炸毁的情况下，您可以恢复到文档的先前版本，CEWP 将立即更新，页面立即恢复。

# git - 使用 go 语言和 gitolite

> ID：14636150
> 
> 赞同：2
> 
> 时间：2013-01-31T22:15:23.040
> 
> 标签：git, github, go, gitolite

知道如何在 Gitolite 中使用 Google 的 go 语言聪明的 get 命令吗？它适用于 Google Code 和 Github，如下所示：

> 去获取代码.google.com/p/go.example/hello

或者

> 去获取 github.com/alphazero/Go-Redis

但我的 gitolite 访问看起来更像：

> git clone git@mygitolite:myproject

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:21:56.127

它与gitolite无关。
Gitolite 只是一个**[授权层](http://sitaramc.github.com/gitolite/auth.html)**，它将`git clone/push/pull`根据您的用户名接受或拒绝您的命令。

如果您可以将 git repo 声明为 go 的源，则可以使用它。
Gitolite 只会检查你是谁，但不会影响该 repo 与 go 一起使用的方式。

* * *

[OP Peter Krnjevic 完善](https://stackoverflow.com/users/1155002/peter-krnjevic) 了这个[问题](https://stackoverflow.com/questions/14636150/using-go-language-with-gitolite/14636225#comment20449129_14636225)：

> go 的问题是它从目录结构中提取 repo 名称，例如：

```
~/gocode/src/github.com/me/myproject 
```

> 自动转化为

```
git clone github.com/me/myproject. 
```

> **但是如何将 gitolite 名称转换为路径？**

我认为你不需要转换任何东西：如果 go 能够联系你的 git repo（GitHub 或任何其他托管 repo 服务器），gitolite 将拦截命令并验证它（或拒绝它）。
您可以将 gitolite 插入 ssh 或（就像通过 go import 完成 git 请求一样）使用 https。

但重点是：

*   gitolite 在服务器端
*   如果您想通过 go 导入轻松访问您的存储库，您应该将它与 Apache 服务器（例如，[与我的配置）一起使用，而不是 ssh。](https://github.com/VonC/compileEverything/blob/passenger/apache/env.conf.tpl#L49-L93)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T16:20:16.437

我为这个用例编写了一个工具。看看有没有帮助。

[https://github.com/tuxychandru/gorepos](https://github.com/tuxychandru/gorepos)

# mysql - 无法在 Windows Azure 上托管的 Wordpress 中保存任何更改

> ID：14636153
> 
> 赞同：0
> 
> 时间：2013-01-31T22:15:41.230
> 
> 标签：mysql, wordpress, azure

我们使用 Windows Azure 平台来托管 wordpress 和 mysql 数据库。三天前，突然之间，我们无法保存对 wordpress 的任何更改。wordpress 显示更改已成功进行，但均未生效。谷歌搜索问题后，问题似乎与 Windows Azure 上的 mysql 权限有关。我试图联系微软，但他们引导我到这里。我想知道是否有人遇到同样的问题并有解决方案。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T16:50:35.680

我从 MSDN 论坛找到了答案。azure 上 mysql db 的问题在于 db 实际上托管在 cleardb 上。azure 将 mysql 数据库作为服务提供，但初始空间仅为 20MB。它很容易耗尽空间。我必须去 cleardb dot com 注册一个应付账户并链接到 azure。然后增加空间。它立即起作用。

MSFT 目前对 WindowsAzure 的支持非常有限。我不满意。但我很高兴最终能从技术论坛找到答案。

# java - 访问 MIFARE 卡管理器小程序

> ID：14636155
> 
> 赞同：2
> 
> 时间：2013-01-31T22:16:13.070
> 
> 标签：java, android, applet, nfc, mifare

我有一个可用的 Android 设置，我可以在其中使用 nfc_extra 模拟 Mifare 4K 标签。但是是否有任何文档或可能性来管理虚拟卡（访问 Mifare Manager Applet）。[我在http://nelenkov.blogspot.nl](http://nelenkov.blogspot.nl) （很棒的博客）上读到了类似的内容，但他没有继续讨论 mifare 部分。

非常感谢！

# java - Apache FOP AFP 到 XML 的转换

> ID：14636157
> 
> 赞同：3
> 
> 时间：2013-01-31T22:16:23.827
> 
> 标签：java, xml, pdf, apache-fop, afp

我正在寻找一个 Java API，它提供将 AFP（IBM 高级功能演示）格式的文档转换为 xml 或 pdf 的功能。我正在尝试实现 Apache FOP 1.1，但几乎没有关于 AFP 的实现文档，并且在任何地方都没有教程或示例。我肯定会感谢有关这项工作的任何方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T10:22:57.220

Apache FOP 支持生成 AFP。它不提供处理现有 AFP 文件的任何功能。至于将 AFP 文件转换为其他格式，[Compart](http://www.compart.com/en/products)在这方面有非常好的工具。

# sitecore - 将类值添加到 sc:image 不显示

> ID：14636166
> 
> 赞同：0
> 
> 时间：2013-01-31T22:17:27.077
> 
> 标签：sitecore, sitecore6

我正在向 sc:image 添加一个类值，但是当它呈现时它显示不正确。在没有渲染的情况下，它在 HTML 中的外观如下：

```
 <a href="/">
    <sc:Image ID="Logo" runat="server" Field="Header Logo" class="logo" /> 
 </a> 
```

但是当它呈现到网页时，它会显示如下：

```
<a href="/">
    <img src="/~/media/logo.png" alt="" width="196" height="34"> 
</a> 
```

但是，我想完成这样的事情：

```
<a href="/">
    <img src="/~/media/logo.png" alt="" width="196" height="34" class="logo"> 
</a> 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:41:14.623

将类应用于图像的一种方法是将 CSS 类放置在不是 Web 控件的更高块级别，可能位于包装 DIV 上。这可能允许您在整个块中利用样式，而不仅仅是图像本身。

要将类直接应用于 IMG 标记，您应该使用 Image 控件的 CssClass 属性，以便将其呈现为“类”标记：

```
<a href="/">
     <sc:Image ID="Logo" runat="server" Field="Header Logo" CssClass="logo" />
</a> 
```

# dart - Dart：当组件有多个实例时，如何引用一个组件元素？

> ID：14636171
> 
> 赞同：2
> 
> 时间：2013-01-31T22:17:40.300
> 
> 标签：dart, dart-webui

我有一个模板：

```
<element name="x-my-elem" constructor="MyElem" extends="div">
  <template>
    <div> 
      <button on-click="onClick()"> Button </button>
      <div id="displayMe">
      </div>
    </div>
  </template>
</element> 
```

和脚本：

```
class MyElem {
   onClick {
      query("#displayMe").innerHtml = "hello";
   }
} 
```

现在，在 html 文件中有多个组件实例：

```
<div is="x-my-elem" id="p1" ></div>
<div is="x-my-elem" id="p2" ></div>
... 
```

我希望每个按钮只更改属于它的“displayMe”。如何实现？有没有办法生成唯一的ID？比 this.elements[i] 更好的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:29:35.367

首先，我认为对于组件内部，您应该更喜欢类而不是 id，因为您可以拥有组件的多个实例，就像您在此处所做的那样。

无论哪种方式，将查询范围限定为组件的方法是使用`this.query()`而不是`query()`，如下所示：

```
class MyElem {
   onClick {
      this.query(".displayMe").innerHtml = "hello";
   }
} 
```

# java - 不确定我是否理解 TransactionAwarePersistenceManagerFactoryProxy

> ID：14636178
> 
> 赞同：191
> 
> 时间：2013-01-31T22:18:07.653
> 
> 标签：java, spring, persistence, dao, jdo

我正在尝试`org.springframework.orm.jdo.TransactionAwarePersistenceManagerFactoryProxy`在我的 Spring 项目中使用它，但我不确定如何使用它或者它是否正是我想要的。我意识到它可以帮助我的 DAO 与普通的 JDO 一起工作`PersistenceManagerFactory`。另一个问题是：如果代理没有正确制作会发生什么？我仍然可以使用它来访问我的工厂以创建事务感知持久性管理器吗？如果工厂管理的对象是单例，这会改变吗？为什么不直接访问 PersistenceManagerFactory 呢？也许`PersistenceManagerFactoryUtils.getPersistenceManager`会更适合我的需要？可以`getObject`返回null吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-06-29T04:54:55.823

答案可直接在[文档中获得](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/orm/jdo/TransactionAwarePersistenceManagerFactoryProxy.html)

> 我意识到它可以帮助我的 DAO 与普通的 JDO PersistenceManagerFactory 一起工作。

是的。TransactionAwarePersistenceManagerFactoryProxy 代理允许 DAO 使用普通的 JDO PersistenceManagerFactory 引用，同时仍参与 Spring（或 J2EE 服务器）的资源和事务管理。你肯定可以在你的应用程序中使用它。但在不了解您的确切需求的情况下，我们无法进一步确认。

> 我仍然可以使用它来访问我的工厂以创建事务感知持久性管理器吗

DAO 可以在 JNDI PersistenceManagerFactory 和本地 PersistenceManagerFactory 的代理之间无缝切换。

> 如果工厂管理的对象是单例，这会改变吗？为什么不直接访问 PersistenceManagerFactory 呢？

通常最好使用 Spring 的 JdoTemplate 编写基于 JDO 的 DAO，这样可以提供诸如一致的数据访问异常而不是 DAO 层的 JDOExceptions 之类的好处。但是，Spring 的资源和事务管理（以及依赖注入）也适用于针对普通 JDO API 编写的 DAO。

# ios - 构建报亭应用程序

> ID：14636182
> 
> 赞同：1
> 
> 时间：2013-01-31T22:18:33.737
> 
> 标签：ios, newsstand-kit

我正在寻找学习做一个报亭应用程序，并且需要一些基本信息。我知道设置消耗品、非消耗品和订阅，但我最关心的是与内容服务器端的通信。在构建应用程序时，我需要杂志出版商提供哪些信息？服务器地址，密码......我真的不知道我需要什么才能让应用程序有效地与他们、Apple 通信并交付内容。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T09:02:29.637

这是如何创建报亭应用程序的好教程 -[链接](http://www.viggiosoft.com/blog/blog/2011/10/17/ios-newsstand-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T14:00:15.737

[你也可以走简单的路，通过类似http://uninkd.com](http://uninkd.com)的方式发布你的杂志。

# java - JTextPane 不会换行

> ID：14636186
> 
> 赞同：1
> 
> 时间：2013-01-31T22:18:51.510
> 
> 标签：java, swing, word-wrap, jtextpane

我正在尝试让 JTextPane 自动换行。我已经在 Internet 上搜索了这个站点，似乎 JTextPane 应该默认自动换行 - 人们遇到的最大问题是禁用换行或让换行在 JScrollPane 内工作。我尝试了 TextPanes、ScrollPanes 和 JPanel 的各种组合，但无济于事。下面是测试过的最简单的代码，但仍然存在问题（没有换行）。

```
public class Looseleaf extends JFrame{

    public Looseleaf(){
        this.setSize(200,200);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
        JTextPane txtPane = new JTextPane();
        this.add(txtPane);
        this.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:36:46.103

根据您的布局，`JTextPane`可能会或可能不会包装，这取决于它对可用尺寸的感知。

相反，添加`JTextPane`到`JScrollPane`...

```
public class Looseleaf extends JFrame{
    public Looseleaf(){
        this.setSize(200,200);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
        JTextPane txtPane = new JTextPane();
        this.add(new JScrollPane(txtPane)); // <-- Add the text pane to a scroll pane....
        this.setVisible(true);
    }
} 
```

**更新了其他示例**

试试这个。这对我有用。

```
public class TestTextPaneWrap {

    public static void main(String[] args) {
        new TestTextPaneWrap();
    }

    public TestTextPaneWrap() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    public class TestPane extends JPanel {

        public TestPane() {
            setLayout(new BorderLayout());
            JTextPane editor = new JTextPane();
            editor.setMinimumSize(new Dimension(0, 0));
            add(new JScrollPane(editor));
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-29T16:36:52.533

至少在我的情况下，以下编码有效。如果将 JTextPane 添加到具有边框布局的 JPane 中并将该窗格添加到 JScrollPane 中，则这些行将不会换行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-16T20:58:53.053

我用过`JTextArea`而不是`JTextPane`

然后使用方法：

```
textArea.setLineWrap(true); 
```

# optimization - Neo4j 推荐设置

> ID：14636188
> 
> 赞同：1
> 
> 时间：2013-01-31T22:19:14.150
> 
> 标签：optimization, neo4j

我租了一台 Joyent SmartOS 机器来为我的项目托管 Neo4j 服务器。

该机器是*超小型 0.5 GB (1 vCPU)*，这意味着它具有 512 兆字节的 RAM。

您会推荐什么而不是以下默认的*Neostore。*设置？

```
neostore.nodestore.db.mapped_memory=25M
neostore.relationshipstore.db.mapped_memory=50M
neostore.propertystore.db.mapped_memory=90M
neostore.propertystore.db.strings.mapped_memory=130M
neostore.propertystore.db.arrays.mapped_memory=130M 
```

如果需要，一些 CPU 信息：

```
# psrinfo -pv
The physical processor has 6 cores and 12 virtual processors (1 3 5 7 9 11 13 15 17 19 21 23)
  The core has 2 virtual processors (1 13)
  The core has 2 virtual processors (3 15)
  The core has 2 virtual processors (5 17)
  The core has 2 virtual processors (7 19)
  The core has 2 virtual processors (9 21)
  The core has 2 virtual processors (11 23)
    x86 (GenuineIntel 206C2 family 6 model 44 step 2 clock 2400 MHz)
      Intel(r) Xeon(r) CPU           E5645  @ 2.40GHz
The physical processor has 6 cores and 12 virtual processors (0 2 4 6 8 10 12 14 16 18 20 22)
  The core has 2 virtual processors (0 12)
  The core has 2 virtual processors (2 14)
  The core has 2 virtual processors (4 16)
  The core has 2 virtual processors (6 18)
  The core has 2 virtual processors (8 20)
  The core has 2 virtual processors (10 22)
    x86 (GenuineIntel 206C2 family 6 model 44 step 2 clock 2400 MHz)
      Intel(r) Xeon(r) CPU           E5645  @ 2.40GHz 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T11:53:23.023

您的配置中的`neostore.xxxx.mapped_memory`设置应该理想地匹配您的 graph.db 目录中相应文件的大小。

假设您有 512 MB RAM 可用并且您的图表约为 250 MB，则为 OS*和*JVM 堆提供了约 250 MB，我认为这太小了。

如果你的盒子有 2G，我会计算：

*   250 MB 映射内存
*   1 GB Java 堆（又名 -Xmx1g -Xms1g）
*   750 MB 操作系统（其余）

# android - AIR 原生扩展 - 启动 Android 后台服务

> ID：14636190
> 
> 赞同：0
> 
> 时间：2013-01-31T22:19:13.923
> 
> 标签：android, service, air, adobe, air-native-extension

我正在开发一个需要启动后台服务的 AIR 本机扩展。

我尝试了不同的启动服务的方法。

这是我的 AIR Android 清单部分（来自我的 -app.xml 文件）

```
//AIR android manifest section
<manifest android:installLocation="auto">
    <application>
        <activity android:name=".TestActivity">
            <intent-filter>
                <action android:name=".TestActivity"/>
                <category android:name="android.intent.category.DEFAULT"/>
            </intent-filter>
        </activity>

    <service android:name=".TestService">
    <intent-filter>
        <action android:name="test.default.service"/>
    </intent-filter>
    </service>
    </application>
</manifest> 
```

服务类与活动在同一个包中。Activity 运行得很好，在 Activity 的 onStart() 方法中，我尝试使用以下方法启动服务：

方法一：

```
import android.app.Activity;

public class TestActivity extends Activity
{
    @Override
    protected void onStart()
    {
        super.onStart();
        Intent intent = new Intent("test.default.service");

        //clearly the classes are available because this compiles!
    intent.setClass(TestActivity.this, TestService.class);

        startService(intent);
    }
} 
```

结果：

```
Unable to start service Intent { act=test.default.service cmp=air.com.my.company/com.my.company.TestService } U=0: not found 
```

方法二：

```
import android.app.Activity;

public class TestActivity extends Activity
{
    @Override
    protected void onStart()
    {
        super.onStart();

        //start a service with intent
        startService(new Intent("test.default.service"));
    }
} 
```

结果：

```
FATAL EXCEPTION: main
java.lang.RuntimeExeption: Unable to instantiate service air.com.my.company.TestService:
java.lang.ClassNotFoundException: 
Didn't find class "air.com.my.company.TestService" on path: /data/app/air.com.my.company-1.apk 
```

问题似乎是那个“空气”。尝试启动服务时，在包名称前加上前缀。在运行我自己的自定义服务时，如何解决包名称的这种混乱？

我一直在讨论堆栈溢出，以及 Adob​​e 的论坛，似乎无法找到解决这个问题的完整方法。

还有一些其他的帖子涉及这个主题，但没有一个提供真正的运行解决方案和源代码。

*   [AIR Native Extension 无法启动服务意图 Android GCM](https://stackoverflow.com/questions/12065255/air-native-extension-unable-to-start-service-intent-android-gcm)
*   [适用于 Android 应用内计费的 Air Native 扩展](https://stackoverflow.com/questions/8053049/air-native-extensions-for-android-in-app-billing)

我已将其缩减为最简单的情况，以确保没有导致问题的额外移动部件。

有关如何从在 AIR 中运行的扩展上下文启动 Android 服务的任何官方信息都会有所帮助。似乎连 Adob​​e 都对这个问题保持沉默。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T23:38:03.897

我认为您需要使用包名称在清单添加中完全确定服务类的范围：

```
...
<service android:name="com.my.company.TestService"> 
```

不知道它是否会起作用。我知道普通的 Android 会正确地预先设置类，但 AIR 应用程序得到了普及。前缀可能会导致您的问题。

更新：

我们实际上使用我们的几个原生扩展来做到这一点，所以我知道这是正确的。

使用完全范围的类名声明服务不使用点速记符号，这是您遇到问题的地方。使用点简写，Android 将假定该类在您的应用程序包中，在 AIR 应用程序下是

```
air.com.my.company 
```

您这样做的方式意味着您的 ANE 将无法在具有不同应用程序 ID 的另一个应用程序中工作！

默认情况下，另一个 AIR 应用程序将查找

```
air.com.other.company.TestService 
```

因此，留下速记符号将意味着此应用程序将找不到您的服务/活动：

```
air.com.my.company.TestService 
```

正确的方法是在您的本机代码中使用干净的包名称，例如 com.company.nativepackage，然后将其包含在清单中，如下所示：

```
<application>
    <activity android:name="com.company.nativepackage.TestActivity">
        <intent-filter>
            <action android:name="TestActivity"/>
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter>
    </activity>

    <service android:enabled="true" android:exported="true" android:name="com.company.nativepackage.TestService">    
        <intent-filter>
            <action android:name="air.com.my.company.DO_CUSTOM_ACTION"/>
        </intent-filter>
    </service>
</application> 
```

这将适用于任何应用程序，并使您的 ANE 更加便携。希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:48:29.673

我已经输入了这个问题并回答了它，因为我花费了大量时间来找出确切的要求，并且我希望为许多其他开发人员节省一些严重的头痛。

上面显示的 android manifest 非常好。上面显示的代码（在两种方法中）都很好。

问题在于 AIR 应用程序的签名证书和包名称。

**Adobe AIR 原生扩展规则**

*规则 1.* 代码签名证书包必须与您的 app.xml 中的应用程序 id 匹配，因此如果证书包是`com.my.company`，那么空中应用程序 id 必须是`<id>com.my.company</id>`

*规则 2.* 使用 ADT 为 android 打包原生扩展时，会在您的包名称中添加一个前缀，使其看起来像`air.com.my.company`.

当 Android ActivityManager 尝试运行您的服务时，它会在`air.com.my.company`. 因此，Service 类必须存在于您的 java 代码中的同一个包中（包括“air”前缀）。我的 TestService 类现在定义为`air.com.my.company.TestService`

使用以下清单，它运行得很好！

```
<application>
    <activity android:name=".TestActivity">
        <intent-filter>
            <action android:name="TestActivity"/>
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter>
    </activity>

    <service android:enabled="true" android:exported="true" android:name=".TestService">    
        <intent-filter>
            <action android:name="air.com.my.company.DO_CUSTOM_ACTION"/>
        </intent-filter>
    </service>
</application> 
```

而且...这是我调用服务的方式。

```
Intent intent = new Intent("air.com.my.company.DO_CUSTOM_ACTION");
intent.setClass(currentContext, TestService.class);
currentContext.startService(intent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T06:17:05.863

对我来说，唯一的变化是我传递给原生包的上下文。就我而言，我的本机代码公开了一些 init(context) 方法，我最初是这样使用它的：

```
instance.init(context.getActivity()); 
```

这给了我“无法找到服务”错误。所以我把它改成：

```
instance.init(context.getActivity().getApplicationContext()); 
```

现在它可以工作了。

# emacs - 在特定 URL emacs 处检索裸文本

> ID：14636191
> 
> 赞同：0
> 
> 时间：2013-01-31T22:19:23.417
> 
> 标签：emacs, urlfetch

`browse-url-emacs`在发布这个问题之前，我尝试使用`C-x C-f`但徒劳无功。

问题：是否可以检索特定 url 处的整个文本，甚至是 url 请求的整个服务器响应？即不是下载然后在emacs中打开文件，而是传递`http(s)://path.to.text.el.py.html.etc/`给一些内置命令并在新缓冲区中获取整个响应或文本？或者更好地只是将 url 拖放到 emacs 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-20T20:50:45.583

升级到*Emacs 24.3.1*修复了这个不寻常的错误/问题。

# python - SQLAlchemy：分离对象的修改

> ID：14636192
> 
> 赞同：23
> 
> 时间：2013-01-31T22:19:32.760
> 
> 标签：python, sqlalchemy, duplicates, clone, instance

我想使用 orm 在 SQLAlchemy 中复制模型实例（行）。我的第一个想法是这样做：

```
i = session.query(Model)
session.expunge(i)

old_id = i.id
i.id = None
session.add(i)
session.flush()
print i.id #New ID 
```

然而，显然分离的对象仍然“记住”它所拥有的 id，即使我在分离时将 id 设置为 None。因此， session.flush() 尝试执行 UPDATE 将主键更改为 null。

这是预期的行为吗？如何删除此属性的“内存”，并在将分离的对象重新添加到会话时将其视为新对象？一般来说，如何克隆 SQLAlchemy 模型实例？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-02T00:04:24.313

这种情况可以使用[make_transient()](http://docs.sqlalchemy.org/en/latest/orm/session_api.html?highlight=make_transient#sqlalchemy.orm.session.make_transient)辅助函数：

```
inst = session.query(Model).first()
session.expunge(inst)

make_transient(inst)
inst.id = None
session.add(inst)
session.flush()
print inst.id #New ID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-01T03:00:08.883

```
def duplicate(self):
    arguments = dict()
    for name, column in self.__mapper__.columns.items():
        if not (column.primary_key or column.unique):
            arguments[name] = getattr(self, name)
    return self.__class__(**arguments) 
```

# wordpress - Wordpress：将 $tags 传递给侧边栏中的 [shortcode] 以获取与当前页面相关的动态内容

> ID：14636193
> 
> 赞同：1
> 
> 时间：2013-01-31T22:19:37.653
> 
> 标签：wordpress, variables, dynamic

我正在使用 Testimonials Widget 短代码，它使用自定义帖子类型作为其内容。我试图将它放在显示与当前帖子共享标签的推荐的侧边栏中，并且在页面的情况下，只显示所有在旋转器（testimonials_widget）而不是列表（testimonials_list）中。到目前为止，我什至无法让它的这一部分工作。

```
<?php 
if ($all_the_tags);
$all_the_tags = get_the_tags();
foreach($all_the_tags as $this_tag) {
echo do_shortcode('[testimonialswidget_list  tags="<?php echo $this_tag->name; ?>" limit=2]');
 }
?> 
```

在它上升后我意识到这当然行不通 - 它正在解析所有标签并显示每一个推荐，无论如何，重复的次数与标签一样多。但至少在没有标签的帖子上，它没有显示任何东西——所以我知道至少有一些代码在工作。

这里是 PHP 新手（好吧，我已经使用它多年，但显然我仍然不擅长它）所以请耐心等待，并使用简单的话 ;)

# java - 应用程序在按钮触摸时崩溃 - onTouch 方法错误？

> ID：14636195
> 
> 赞同：0
> 
> 时间：2013-01-31T22:19:52.240
> 
> 标签：java, android, button, crash

当我单击“startButton”时，我的应用程序不断崩溃。我猜问题出在 onTouch 方法的某个地方，但我已经尝试解决问题几个小时了；禁用内部不同的东西`startButton.setOnTouchListener`并没有什么不同。你能发现什么不对吗？

```
MediaPlayer mp;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.main);
    final Button startButton = (Button) this.findViewById(R.id.button1);
    final TextView timeLeft = (TextView) this.findViewById(R.id.timeLeft);
    MediaPlayer.create(getBaseContext(), R.raw.songthingy);

    startButton.setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            if (event.getAction() == MotionEvent.ACTION_DOWN) {

                mp.start();
                timeLeft.setText("Status: Initiated");
                startButton.setText("Stop");

                startButton.setOnClickListener(new View.OnClickListener() {

                    @Override
                    public void onClick(View arg0) {
                        mp.release();

                    }

                });

                new CountDownTimer(30000, 1000) {

                    public void onTick(long millisUntilFinished) {
                        timeLeft.setText("Status: Starting in... "
                                + millisUntilFinished / 1000);
                    }

                    public void onFinish() {
                        timeLeft.setText("Status: Finished");
                    }
                }.start();

                mp.setOnCompletionListener(new OnCompletionListener() {
                    @Override
                    public void onCompletion(MediaPlayer mp) {
                        mp.release();
                    }
                });
            }
            ;
            return true;
        }
    });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:21:47.040

没有异常堆栈，但我看到的一个问题是：

```
MediaPlayer mp; 
```

被指向`null`并且您正在调用

mp.start();

在`OnTouchListener`，这导致`NullPointerException`。

我认为你需要做的是：

```
 final TextView timeLeft = (TextView) this.findViewById(R.id.timeLeft);
 mp= MediaPlayer.create(getBaseContext(), R.raw.songthingy); 
```

# tidesdk - 我可以从远程托管的应用程序访问“Ti”单例吗？

> ID：14636197
> 
> 赞同：0
> 
> 时间：2013-01-31T22:20:11.057
> 
> 标签：tidesdk

我有一个 TideSDK 应用程序，其主 url 托管在服务器上。例如[http://example.com/myApp](http://example.com/myApp)。

我正在尝试从该代码访问 Titanium 单例，但它没有定义。TideSDK 不会将它的引用传递给窗口对象或其他东西吗？

我在文档中没有找到任何关于此的内容，因为我想大多数应用程序都将代码捆绑在其中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T14:24:51.960

Ti 对象不可用于任何远程服务器 url。这是因为 TideSDK 的安全策略到位。

现有的策略是防止任何远程 URL 通过 Ti 对象访问您的整个计算机。因此，如果您在 TideSDK 中加载任何 url，它将不允许它们访问您的本地计算机..并且只有您自己计算机中的 url 才能访问它。

# twitter-bootstrap - Twitter Bootstrap 表列 - 第一个表的列宽比第二个表短

> ID：14636198
> 
> 赞同：0
> 
> 时间：2013-01-31T22:20:14.013
> 
> 标签：twitter-bootstrap, haml

我正在尝试将 .haml 与 Twitter Bootstrap 一起使用来创建两个表。问题是我的第二个表格渲染得很好，但我的第一个表格文本少得多，似乎在页面上无休止地延伸。如何将我的第一个表格列宽设置为小，与第二个表格的宽度不同？我试过 :class => "table table-condensed" 但这仍然太大了。

```
%html
  %head
    %link(rel="stylesheet" href="css/bootstrap.css")
    %link(rel="stylesheet" href="css/my.css")
    %title Working Units
  %body
    %p  
    %p These are the units that are updating. 
%table{:class => "table table-bordered"}
  %thead
    %tr 
      %th Job 
      %th Age 
  %tbody
    - @plines.each do |row|
      %tr 
        - row.split(/[-,]/).each do |column|
          %td= column
%p These are the units that are not updating. 
%table{:class => "table table-bordered"}
  %thead
    %tr 
      %th Job 
      %th Age 
      %th Time
  %tbody
    - @mlines.each do |row|
      %tr 
        - row.split(/[-,]/).each do |column|
          %td= column
%a{:href=>"/"} Back to the form 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T11:22:53.587

将表格包裹在`div`具有特定宽度的 a 中：

```
:css
    .halfsize {
          width: 50%;
    }
.halfsize
    %table{:class => "table table-bordered"}
      %thead
        %tr 
          %th Job 
          %th Age 
      %tbody
        - @plines.each do |row|
          %tr 
            - row.split(/[-,]/).each do |column|
              %td= column 
```

# php - 除非选择文件，否则 Sql 更新不起作用

> ID：14636200
> 
> 赞同：0
> 
> 时间：2013-01-31T22:20:19.063
> 
> 标签：php, mysql, forms, sql-update

在这个编辑文件中，我必须选择相同的图片文件或另一个图片文件才能更新行。但我希望能够在不触及其他行的情况下更改我想要的任何内容。有什么想法吗？

```
<?php
include('../config.php');
include ('../ac.thumbs.php');

 if ($_GET['sil']) {
    $sil = htmlspecialchars(stripslashes($_GET['sil']));
    mysql_query("DELETE FROM CloseOut WHERE itemNO = $sil limit 1");
    echo "<h1>$sil item nolu kayit silinmistir</h1><br>";
}

    $edit = htmlspecialchars(stripslashes($_GET['edit']));
 $data = mysql_query("SELECT * FROM CloseOut WHERE itemNO=$edit") or die(mysql_error()); 

 //Puts it into an array 
 while($info = mysql_fetch_array( $data )) 
 { echo "
<center>
<a href=\"edit.php?sil=$info[itemNO]\"onclick=\"return confirm('Do you really want to erase this entry?')\">[ Delete ]</a><br>
<a href=../../large.php?f=upload/".$info['resim'], $thumblarge .">
<img src=../../small.php?f=upload/".$info['resim'], $thumbsmall .">
</a>";
$editresim = $info[resim];
$editisim = $info[isim];
$editalan1 = $info[alan1];
$editalan2 = $info[alan2];
$editalan3 = $info[alan3];
$editalan4 = $info[alan4];
} 

 //Resimlerin yuklenecegin yer
 $target = "../../upload/";  
 //////////////////////////////////////////////////////////////////////
 ///////////////////////////////Resim1/////////////////////////////////
 //////////////////////////////////////////////////////////////////////
 $target1 = $target . basename( $_FILES['resim1']['name']) ; 
 //Formdan gelen bilgileri almasi icin
 $resim=($_FILES['resim1']['name']); 
 $isim=$_POST['isim1']; 
 $alan1=$_POST['alan11']; 
 $alan2=$_POST['alan21']; 
 $alan3=$_POST['alan31']; 
 $alan4=$_POST['alan41']; 

/////////////Formdaki bos alanlara bos bilgi kayit etmemesi icin////////////////////////

$updates = array();
if (!empty($resim))
  $updates[] = 'resim="'.mysql_real_escape_string($resim).'"';
if (!empty($isim))
  $updates[] = 'isim="'.mysql_real_escape_string($isim).'"';
if (!empty($alan1))
  $updates[] = 'alan1="'.mysql_real_escape_string($alan1).'"';
if (!empty($alan2))
  $updates[] = 'alan2="'.mysql_real_escape_string($alan2).'"';
if (!empty($alan3))
  $updates[] = 'alan3="'.mysql_real_escape_string($alan3).'"';
if (!empty($alan4))
  $updates[] = 'alan4="'.mysql_real_escape_string($alan4).'"';
$updates = implode(', ', $updates);

/////////////////////////////////////////////////////////////////////////////////////////
 //update etmesi icin
if(move_uploaded_file($_FILES['resim1']['tmp_name'], $target1)) 
{   
mysql_query("UPDATE CloseOut SET $updates WHERE itemNO='$edit' ");
echo "Tebrikler, ". basename( $_FILES['resim1']['name']). " isimli dosya yuklendi ve database'e basariyla islendi!<br>"; 
 } 

?>

<br>
<center> 
<table width="900" border="5" style="background-color:white; "bordercolor="#000000">
    <tr>
        <td width="120" height="50" bgcolor= "545454"><b>RESIM</b></td>
        <td width="120" height="50" bgcolor= "545454"><b>NAME</b></td>
        <td width="120" height="50" bgcolor= "545454"><b>CATAGORY</b></td>
        <td width="120" height="50" bgcolor= "545454"><b>QUANTITY</b></td>
        <td width="120" height="50" bgcolor= "545454"><b>LOCATION</b></td>
        <td width="120" height="50" bgcolor= "545454"><b>PRICE</b></td>
    </tr>
    <tr>
<form enctype="multipart/form-data" method="post" action="">
<td><input type="file" name="resim1" value="<?php echo $editresim;?>"> </td>
<td><input type="text" name="isim1" value="<?php echo $editisim;?>"> </td>
<td><input type="text" name="alan11" value="<?php echo $editalan1;?>"> </td>
<td><input type="text" name="alan21" value="<?php echo $editalan2;?>">  </td>
<td><input type="text" name="alan31" value="<?php echo $editalan3;?>"></td>
<td><input type="text" name="alan41" value="<?php echo $editalan4;?>"></td>
</tr>

<td colspan="5"><center><input type="submit"></center></td>

</form>
</table>
</center> 
```

# .net - 反映到不同的 AppDomain

> ID：14636202
> 
> 赞同：0
> 
> 时间：2013-01-31T22:20:28.873
> 
> 标签：.net, reflection, appdomain

我想修改我没有编写的 .NET 程序的行为。用ILSpy看了下相关源码，发现程序是用*静态字段*来加载我想改变的数据，所以我写了一个简单的程序反映到静态字段上，改变值，然后启动该程序。

问题是，程序启动时似乎忽略了更改！我环顾四周，发现[静态变量仅在`AppDomain`](https://stackoverflow.com/a/1563211/794234). 我怀疑这是我的问题。我的启动器应用程序正在修改“静态”变量，但调用`Process.Start`创建一个新的`AppDomain`，这使我的更改无关紧要。

任何方式：

1）改变*另一个静态变量* `AppDomain`

或者

2）解决问题的不同方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T05:39:57.813

我认为你应该能够通过引导它来实现这一点。

新建一个同类型的应用程序（Console、WinForms等），在新应用程序中添加已有应用程序.EXE作为引用，然后调用已有应用程序的入口点，就可以正常运行了以前做过。

然后，通过反射，您应该能够绕过任何不方便的访问修饰符，以便能够修改值。

我刚刚创建了一个简短的测试应用程序，它确实做到了这一点，并且运行良好。我不知道你的应用程序，所以我不确定杂草中有什么鳄鱼，但我认为引导程序会给你最好的机会。

# asp.net - 缓存数据库导致 WebAPI 身份验证

> ID：14636203
> 
> 赞同：0
> 
> 时间：2013-01-31T22:20:31.043
> 
> 标签：asp.net, authentication, caching, asp.net-web-api

我正在使用 ASP.NET WebApi 创建一个 RESTful Web 服务。我要求所有传入请求都通过 SSL，因为我将使用基本 HTTP 身份验证。客户端负责在请求标头中包含凭据，Web 服务将对每个请求的客户端进行身份验证。

实际的身份验证需要进行数据库调用。有没有办法缓存数据库结果（用户名和密码），这样我就不必为短时间内发生的每个传入请求进行数据库调用？

因此，当请求进入时，Web 服务将在缓存中查找用户名/密码组合。如果找到，它将处理请求。如果没有找到，它将调用数据库进行身份验证，然后将用户名/密码添加到缓存中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T13:57:33.773

我能想到的最简单的缓存是使用 System.Web.Caching。下面是一个极其简化的版本，它向当前缓存添加一个值，然后检索它进行处理。我不建议按原样使用此代码。

```
// GET api/values/5
[HttpGet]
public string GetValue(int id)
{
    HttpContext.Current.Cache.Insert("2", "test1");

    var value = Convert.ToString(HttpContext.Current.Cache.Get(id.ToString()));

    return !string.IsNullOrEmpty(value) ? value : "nothing found";
} 
```

# java - 在空列表上使用“.Get(0)”时，我得到一个越界异常而不是 null？

> ID：14636204
> 
> 赞同：5
> 
> 时间：2013-01-31T22:20:36.300
> 
> 标签：java, arraylist, indexoutofboundsexception

因此，在我的家庭作业中，对于我的错误检查测试内容，我得到了 a`List<SomeObject>`并且得到了`IndexOutOfBoundsException`. 我通过检查来解决它，`.isEmpty`但我想知道为什么不：

```
boolean b = myList.Get(0) != null; 
```

工作？

当我调试应用程序并查看时，`myList`我看到 9 个`null`. 我可以看到它的大小`0`，所以这可能是为什么？它的大小`0`，所以当我尝试获取条目时它不存在？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-31T22:51:19.197

如果是 Java：

```
ArrayList<Object> list = new ArrayList<Object>();
list.get(0); 
```

将造成

```
Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
    at java.util.ArrayList.RangeCheck(ArrayList.java:547)
    at java.util.ArrayList.get(ArrayList.java:322)
    at HelloWorldTester.main(HelloWorldTester.java:7) 
```

原因实际上在源代码上。rangecheck 可能正在检查您要获取的内容是否小于列表的大小。如果它更高那么

```
throw new IndexOutOfBoundsException(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T23:33:04.377

按设计工作。我不明白你为什么期望能够得到任何东西，甚至`null`是从一个空的`List`. 你不能。

# javascript - CKeditor 添加多种样式的插件

> ID：14636207
> 
> 赞同：0
> 
> 时间：2013-01-31T22:20:45.647
> 
> 标签：javascript, plugins, ckeditor

[Codewaggle 的回答](https://stackoverflow.com/questions/7676144/ckeditor-format-class)让我开始了，我也看过[Reinmar 的回答](https://stackoverflow.com/questions/12787891/ckeditor-plugin-to-set-classes)，但我不能把它放在一起。

我想创建一个具有五个自定义跨度（更正、删除、建议...等）的插件，然后我可以将其添加到我的 CSS 中，并有一个按钮来使用 Drupal 7 中的 CKeditor 应用每种样式。

我不想为样式使用下拉菜单，而是更喜欢为每个添加的类添加带有图标的按钮。

我使用 basicstyles 插件作为起点，但我之前从未在 javascript 中做过任何事情，所以我真的一头雾水。

我已经添加了

```
config.extraPlugins = 'poligoeditstyles'; 
```

到配置文件并根据CKeditor上的指南设置我的插件的文件结构。

我假设如果一切都按计划进行，我应该会看到一个按钮拖到我的工具栏中，但是，唉！没有喜悦。当我添加内容或在 Drupal 的配置页面上时，我看不到任何添加到我的 CKeditor 工具栏的内容：

```
admin/config/content/ckeditor/edit/Advanced 
```

我错过了什么吗？任何帮助，将不胜感激！

这是我的插件代码：

```
/**
 * POLIGO edit styles plug-in for CKeditor based on the Basic Styles plugin
 */

CKEDITOR.plugins.add( 'poligoeditstyles', {
    icons: 'correction,suggestion,deletion,commendation,dontunderstand', // %REMOVE_LINE_CORE%
    init: function( editor ) {
        var order = 0;
        // All buttons use the same code to register. So, to avoid
        // duplications, let's use this tool function.
        var addButtonCommand = function( buttonName, buttonLabel, commandName, styleDefiniton ) {
                // Disable the command if no definition is configured.
                if ( !styleDefiniton )
                    return;

                var style = new CKEDITOR.style( styleDefiniton );

                // Listen to contextual style activation.
                editor.attachStyleStateChange( style, function( state ) {
                    !editor.readOnly && editor.getCommand( commandName ).setState( state );
                });

                // Create the command that can be used to apply the style.
                editor.addCommand( commandName, new CKEDITOR.styleCommand( style ) );

                // Register the button, if the button plugin is loaded.
                if ( editor.ui.addButton ) {
                    editor.ui.addButton( buttonName, {
                        label: buttonLabel,
                        command: commandName,
                        toolbar: 'poligoeditstyles,' + ( order += 10 )
                    });
                }
            };

        var config = editor.config,
            lang = editor.lang;

        addButtonCommand( 'Correction', 'That's a mistake', 'correction', config.coreStyles_correction );
        addButtonCommand( 'Suggestion', 'That's OK, but I suggest...', 'suggestion', config.coreStyles_suggestion );
        addButtonCommand( 'Deletion', 'You don't need that', 'deletion', config.coreStyles_deletion );
        addButtonCommand( 'Commendation', 'Great job!', 'commendation', config.coreStyles_commendation );
        addButtonCommand( 'Dontunderstand', 'I don't understand what you mean', 'dontunderstand', config.coreStyles_dontunderstand );

    }
});

// POLIGO Editor Inline Styles.

CKEDITOR.config.coreStyles_correction = { element : 'span', attributes : { 'class': 'correction' }};
CKEDITOR.config.coreStyles_suggestion = { element : 'span', attributes : { 'class': 'suggestion' }};
CKEDITOR.config.coreStyles_deletion = { element : 'span', attributes : { 'class': 'deletion' }};
CKEDITOR.config.coreStyles_commendation = { element : 'span', attributes : { 'class': 'commendation' }};
CKEDITOR.config.coreStyles_dontunderstand = { element : 'span', attributes : { 'class': 'dontunderstand' }}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:11:15.470

在黑暗中拍摄，但您是否在初始化或其他地方的配置中将按钮添加到 config.toolbar - 请参阅[http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Toolbar](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Toolbar)

# script# - 导入初始化函数

> ID：14636210
> 
> 赞同：0
> 
> 时间：2013-01-31T22:21:10.463
> 
> 标签：script#

我正在尝试为我想要创建的一些应用程序在 Script# 中为 Office ( [http://msdn.microsoft.com/en-us/library/fp142185.aspx ) 创建导入项目库。](http://msdn.microsoft.com/en-us/library/fp142185.aspx)其中一个函数希望创建以下 JS：

`Office.initialize = function (reason) {/* initialization code */}` （[http://msdn.microsoft.com/en-us/library/fp161139.aspx](http://msdn.microsoft.com/en-us/library/fp161139.aspx)）

我有办公室类，我可以使用 IntrinsicProperty 属性创建初始化属性。但是，如果不使用另一种方法，我就无法访问该属性。

```
public static void Initialize()
{
   Office.Intialize = delegate(InializationEnum initEnum)
   {
      ...
   };
} 
```

`

产生以下JS

```
OfficeScript.initialize = function AgaveScript$initialize() {
    Office.intialize = function(initEnum) {
        ...
    };
} 
```

这不是我想要创建的 JS。

是否可以导入 Office.initialize 之类的函数？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T06:01:32.687

尝试将您的代码设置为 Office.Initialize 在 OfficeScript 的静态 ctor 中。

顺便说一句，以其他人可以使用的方式执行此 Office 导入库会很有趣……作为共享导入库。

# php - 如何在每个页面上正确包含 PHP 标头

> ID：14636212
> 
> 赞同：1
> 
> 时间：2013-01-31T22:21:13.663
> 
> 标签：php, templates, header, include

我当前的项目通过 index.php 路由所有内容。然后我看看是什么`$_SERVER['REQUEST_URI']`，检查白名单，然后执行一些逻辑来包含相关的 html 模板。像这样：

```
<?php

include("header.html");

$requested_page = $_SERVER['REQUEST_URI'];

if ($requested_page in $whitelist){
    $page_title = $requested_page;
    include ($requested_page . "_controller.php");
    include ($requested_page . "_template.html");
}

include ("footer.html")

?> 
```

我的问题是我想`$page_title`在标题模板中使用，像这样......

`<title><?php echo $page_title?></title>`

但显然它不会起作用，因为当包含标题时， $page_title 尚未设置。谁能建议如何解决这个问题？“输出缓冲”可能有帮助吗？如果是这样，怎么做？如果这种使用 php 生成页面的方式存在重大问题，请说出来！谢谢

编辑：我应该补充一点，条件逻辑在我的实际项目中要复杂得多，我在这里简化了很多。我不想一直重复我对页眉和页脚的包含，所以这就是不包含它们的原因。如果可能的话，我真的宁愿让他们远离所有的逻辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:29:36.720

您可以重新排序代码以实现此目的：

```
<?php 
$requested_page = $_SERVER['REQUEST_URI'];

if ($requested_page in $whitelist){
    $page_title = $requested_page;
    include("header.html");
    include ($requested_page . "_controller.php");
    include ($requested_page . "_template.html");
}else{
    //Make sure we include header if page not in white list
    include("header.html");
}

include ("footer.html")
?> 
```

编辑：实际上考虑一下，您可能可以将逻辑和包括解耦：

```
<?php 
$requested_page = $_SERVER['REQUEST_URI'];
$includes = array();
$includes[] = 'header.html';
if ($requested_page in $whitelist){
    $page_title = $requested_page;
    $includes[] = $requested_page . "_controller.php";
    $includes[] = $requested_page . "_template.html";
}

$includes[] = "footer.html";
foreach($includes as $include){
    include($include);
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:38:13.163

我为我的加载 MVC 库编写了这个来加载视图，但我认为这会变得很方便：

```
$target = "myfile.php";

$data = array(
  'page_title' => 'page title'
);

ob_start();
if(count($data) > 0) extract($data);
include_once($target);
$content = ob_get_clean();

echo $content; 
```

并且您可以使用函数将`$data`键用作变量。`extract()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:43:16.567

简单的

```
<?php 
$requested_page = $_SERVER['REQUEST_URI'];

$page_title = "";

if ($requested_page in $whitelist) $page_title = $requested_page;

include("header.html");

if(!empty($page_title)) {
    include ($requested_page . "_controller.php");
    include ($requested_page . "_template.html");
}

include ("footer.html")
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T01:19:10.583

关于什么..？

```
<?php 
$page_title = $requested_page = $_SERVER['REQUEST_URI'];
if (!in_array($requested_page, $whitelist)) {
    header('Location: http://example.com/your404');
    exit(0);
}

include 'header.html';
include "$requested_page_controller.php";
include "$requested_page_template.html";
include 'footer.html'; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-31T22:23:39.093

尝试使用带有页面标题`index.php`的`$_POST`或重定向回您的页面。`$_GET`

如果设置了这些，您可以从页面的开头阅读它们。

```
<?php

if (isset($_GET['pagetitle'])){
  echo "<html><head><title>".$_GET['pagetitle']."</title></head>";
}

include("header.html");

$requested_page = $_SERVER['REQUEST_URI'];

if ($requested_page in $whitelist){
    $page_title = $requested_page;
    include ($requested_page . "_controller.php");
    include ($requested_page . "_template.html");
    header( 'Location: http://www.yoursite.com/index.php?pagetitle='.
           urlencode('This is the page title'),'"' ) 
}

include ("footer.html")

?> 
```

# c# - FFMPEG 进程太多

> ID：14636216
> 
> 赞同：0
> 
> 时间：2013-01-31T22:21:26.127
> 
> 标签：c#, loops, process, ffmpeg

我有一个视频文件列表，我想用 ffmpeg 转换它们。这是我的代码：

```
 public static void ConvertToMp3(String inputPath, String title)
    {
        String outputpath = "\"D:\\Mp3\\" + title + ".mp3\"";

        String _out;
        Process p = new Process();

        p.StartInfo.UseShellExecute = false;
        p.StartInfo.RedirectStandardInput = true;
        p.StartInfo.RedirectStandardOutput = true;
        p.StartInfo.RedirectStandardError = true;
        p.StartInfo.CreateNoWindow = true;
        p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        p.StartInfo.FileName = "ffmpeg";
        p.StartInfo.Arguments = " -i \"" + inputPath + "\" -vn -f mp3 -ab 192k " + outputpath;

        p.Start();
        p.StandardOutput.ReadToEnd();
        _out = p.StandardError.ReadToEnd();
        p.WaitForExit();

        if(!p.HasExited)
            p.Kill();

        Console.WriteLine(_out);   
    } 
```

它工作正常，但是当我在循环中调用此函数*n*次时，它打开了太多进程。我想一次只打开一个进程，完成后，转到下一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-21T07:43:50.857

之前`WaitForExit`，添加此命令

```
p.Exited += (sender, e) =>
            {
               // Thread.Sleep(1000 * 60);
               // Thread thread = new Thread(() => callProcess());
               // thread.Start();                    
            }; 
```

这将在过程完成后起作用。我通常使用新线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:02:58.747

如何检查进程计数并仅在其小于 x 时才执行您的代码（例如 2）

```
int process = 0;
foreach (System.Diagnostics.Process myProc in System.Diagnostics.Process.GetProcesses())
{
   if (myProc.ProcessName == "process name")
      process++;

   if (process < 2)
      p.Start();
} 
```

# javascript - 有没有办法使用 JavaScript 添加帮助气泡

> ID：14636217
> 
> 赞同：0
> 
> 时间：2013-01-31T22:21:27.047
> 
> 标签：javascript, html, css

是否有一种使用 Javascript 的方式在输入框上添加帮助气泡？

例如，当您将鼠标悬停在 Name: ***_* ____**的输入上时，它会显示为 First Name????

谢谢

一个例子是这个[https://edit.europe.yahoo.com/registration?.intl=uk](https://edit.europe.yahoo.com/registration?.intl=uk)

当您浏览名称字段时，它会显示气泡中的名字

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:24:03.390

你的意思是[title属性](http://www.w3.org/TR/html401/struct/global.html#h-7.4.3)吗？

```
<input type="text" title="First Name" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:39:57.660

As said in another answer you can add a title attribute to a html tag to have a tool tip display.

Or if you are after the behaviour where information is displayed somewhere on the page telling you about the text box you have selected you can; dynamically add to a div using document.createElement() and appendChild() when you [hover over the element](http://www.w3schools.com/jsref/event_onmouseover.asp) and removing it with removeChild() upon moving your mouse away or change the [innerHTML](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML) of the html tag on those two events.

**Edit:** Unfortunately because I am a 'new' user I can't include all the hyperlinks to each part of the mozilla developer site, but simply search for those functions there for more explnation.

# jquery - jQuery：将文本 URL 转换为链接作为输入

> ID：14636218
> 
> 赞同：4
> 
> 时间：2013-01-31T22:21:28.997
> 
> 标签：jquery, regex, replace, contenteditable

我正在取得进展，但不太确定如何让它正常工作......

我有一个内容可编辑的 div，其功能类似于 textarea。

我还有一个正则表达式来识别正在输入的 URL 并自动链接它们。但是，当用户键入时，我无法使这项工作“直播”。

这是我到目前为止所拥有的[jsFiddle 。](http://jsfiddle.net/r9FkT/3/)我遇到的另一个问题是输入链接后光标跳转到 div 的开头（因为我要替换 div 的`.html()`？）

是否有创造性的解决方案可用于`.replace()`div 中的单个文本字符串，而无需替换 div 的全部内容？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T23:54:53.363

首先，IE 会自动为您执行此操作。

对于其他浏览器，我建议在用户不活动一段时间后进行更换。这是我的一个答案，说明了如何进行替换：

[https://stackoverflow.com/a/4045531/96100](https://stackoverflow.com/a/4045531/96100)

这是一个带有（坏）链接正则表达式和讨论的类似的：

[https://stackoverflow.com/a/4026684/96100](https://stackoverflow.com/a/4026684/96100)

为了保存和恢复选择，我建议使用基于字符偏移的方法。以下代码通常存在缺点，但对于在更改格式但保持文本不变的同时保存和恢复选择的特殊情况，这是理想的。这是一个例子：

[https://stackoverflow.com/a/13950376/96100](https://stackoverflow.com/a/13950376/96100)

最后，这里有一些关于如何等待用户不活动的讨论和示例的答案：

*   [https://stackoverflow.com/a/7837001/96100](https://stackoverflow.com/a/7837001/96100)
*   [https://stackoverflow.com/a/1621309/96100](https://stackoverflow.com/a/1621309/96100)

把它们放在一起：

```
var saveSelection, restoreSelection;

if (window.getSelection && document.createRange) {
    saveSelection = function(containerEl) {
        var range = window.getSelection().getRangeAt(0);
        var preSelectionRange = range.cloneRange();
        preSelectionRange.selectNodeContents(containerEl);
        preSelectionRange.setEnd(range.startContainer, range.startOffset);
        var start = preSelectionRange.toString().length;

        return {
            start: start,
            end: start + range.toString().length
        }
    };

    restoreSelection = function(containerEl, savedSel) {
        var charIndex = 0, range = document.createRange();
        range.setStart(containerEl, 0);
        range.collapse(true);
        var nodeStack = [containerEl], node, foundStart = false, stop = false;

        while (!stop && (node = nodeStack.pop())) {
            if (node.nodeType == 3) {
                var nextCharIndex = charIndex + node.length;
                if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {
                    range.setStart(node, savedSel.start - charIndex);
                    foundStart = true;
                }
                if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {
                    range.setEnd(node, savedSel.end - charIndex);
                    stop = true;
                }
                charIndex = nextCharIndex;
            } else {
                var i = node.childNodes.length;
                while (i--) {
                    nodeStack.push(node.childNodes[i]);
                }
            }
        }

        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
    }
} else if (document.selection) {
    saveSelection = function(containerEl) {
        var selectedTextRange = document.selection.createRange();
        var preSelectionTextRange = document.body.createTextRange();
        preSelectionTextRange.moveToElementText(containerEl);
        preSelectionTextRange.setEndPoint("EndToStart", selectedTextRange);
        var start = preSelectionTextRange.text.length;

        return {
            start: start,
            end: start + selectedTextRange.text.length
        }
    };

    restoreSelection = function(containerEl, savedSel) {
        var textRange = document.body.createTextRange();
        textRange.moveToElementText(containerEl);
        textRange.collapse(true);
        textRange.moveEnd("character", savedSel.end);
        textRange.moveStart("character", savedSel.start);
        textRange.select();
    };
}

function createLink(matchedTextNode) {
    var el = document.createElement("a");
    el.href = matchedTextNode.data;
    el.appendChild(matchedTextNode);
    return el;
}

function shouldLinkifyContents(el) {
    return el.tagName != "A";
}

function surroundInElement(el, regex, surrounderCreateFunc, shouldSurroundFunc) {
    var child = el.lastChild;
    while (child) {
        if (child.nodeType == 1 && shouldSurroundFunc(el)) {
            surroundInElement(child, regex, createLink, shouldSurroundFunc);
        } else if (child.nodeType == 3) {
            surroundMatchingText(child, regex, surrounderCreateFunc);
        }
        child = child.previousSibling;
    }
}

function surroundMatchingText(textNode, regex, surrounderCreateFunc) {
    var parent = textNode.parentNode;
    var result, surroundingNode, matchedTextNode, matchLength, matchedText;
    while ( textNode && (result = regex.exec(textNode.data)) ) {
        matchedTextNode = textNode.splitText(result.index);
        matchedText = result[0];
        matchLength = matchedText.length;
        textNode = (matchedTextNode.length > matchLength) ?
            matchedTextNode.splitText(matchLength) : null;
        surroundingNode = surrounderCreateFunc(matchedTextNode.cloneNode(true));
        parent.insertBefore(surroundingNode, matchedTextNode);
        parent.removeChild(matchedTextNode);
    }
}

var textbox = document.getElementById("textbox");
var urlRegex = /http(s?):\/\/($|[^\s]+)/;

function updateLinks() {
    var savedSelection = saveSelection(textbox);
    surroundInElement(textbox, urlRegex, createLink, shouldLinkifyContents);
    restoreSelection(textbox, savedSelection);
}

var $textbox = $(textbox);

$(document).ready(function () {
    $textbox.focus();

    var keyTimer = null, keyDelay = 1000;

    $textbox.keyup(function() {
        if (keyTimer) {
            window.clearTimeout(keyTimer);
        }
        keyTimer = window.setTimeout(function() {
            updateLinks();
            keyTimer = null;
        }, keyDelay);
    });
});
```

```
body { font:.8rem/1.5 sans-serif;  margin:2rem; }
#textbox {
    border:thin solid gray;
    padding:1rem;
    height:10rem;
    margin:1rem 0;
    color:black;
    font-size:1rem;
}
a { color:blue; background:lightblue; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
Start typing a message with a link i.e. <code>http://example.com</code>...
<div id="textbox" contenteditable></div>
```

# c# - C# 保存和加载所有表单元素？

> ID：14636219
> 
> 赞同：1
> 
> 时间：2013-01-31T22:21:30.843
> 
> 标签：c#, winforms, save

我正在尝试使用一个非常通用的函数来设计我的 C# winform 应用程序，以自动遍历所有表单元素并将它们的状态/值保存在文本文件中，以便以后加载它。我希望它非常通用，以便在未来的项目中重用此代码很容易，因为它不会被严重束缚于细节。我要保存的表单元素是文本框、组合框、数据网格视图、列表框，仅此而已。我想保存他们的价值观和关于他们的一切。

我打算这样做的一种方法是遍历每个可能的表单元素，然后检测每个类型，然后创建相应的 c# 代码以重新创建其值（'tboxmine.value="blue大象"'），然后将代码写入文件，以便我可以从文件中加载代码并使用 CSCcompiler 执行它。到目前为止，我的代码似乎无法正常工作，我怀疑这个编译器实际上是否*在*我的应用程序中运行代码（我认为它可能正在创建一个新线程？），而且看起来可能有一个更直接的相对标准的方式来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:30:21.463

这似乎有点像反向“最佳实践”方法。如果您不了解数据绑定，我建议您调查一下。

基本上，您创建类来表示您的数据并使用数据绑定将控件与您的对象相关联。控件将自动显示正确的值并允许用户更改它。如果用户更改了值，您的对象会自动更新。

要保存数据，您将使用某种序列化将对象存储在文件中。加载时，您让序列化程序重建您的类结构，并且（最好的情况）您可以开始了。

这不完全是您所要求的，但我认为您可以很好地使用它;-)

注意：未保存控件的完整状态。例如，在文本框中，您的文本将被保存，但 BackColor 不会。

为了让您开始查看本教程： http: [//www.codeproject.com/Articles/24656/A-Detailed-Data-Binding-Tutorial](http://www.codeproject.com/Articles/24656/A-Detailed-Data-Binding-Tutorial)

# c# - 首先在实体框架5代码中完全忽略基类/接口

> ID：14636222
> 
> 赞同：2
> 
> 时间：2013-01-31T22:21:40.217
> 
> 标签：c#, .net, inheritance, entity-framework-5

我有以下实体类：

```
[System.ComponentModel.DataAnnotations.Schema.Table("User")]
public class User: UserBase, IPersistCustom<Entity> { ... } 
```

根据您使用的层次结构映射类型，EF 将生成描述符列或拆分表。有没有办法让 EF 完全忽略此类继承自某些东西或实现接口的事实？

我的意思不是仅仅忽略基类属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T16:10:21.400

如果您将基类标记为抽象并使用每个具体类型方法的表，这可能会起作用。就像是;

```
context.Entity<User>().Map(p =>
        {
            p.MapInheritedProperties();
            p.ToTable("Users");
        }); 
```

参考[这个](http://weblogs.asp.net/manavi/archive/2011/01/03/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-3-table-per-concrete-type-tpc-and-choosing-strategy-guidelines.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T16:02:15.157

你在找这个.... 流利的 API 选项

```
 modelBuilder.Entity<XYZ>().Ignore(p => p.PropertyName); 
```

# ruby-on-rails - Rails logger.error 未显示在 SysLog 中

> ID：14636223
> 
> 赞同：2
> 
> 时间：2013-01-31T22:21:46.137
> 
> 标签：ruby-on-rails, syslog, syslog-ng

我有一个关于如何正确配置以使 rails`logger.error`消息显示在`SysLog`. 我们用`SyslogLogger gem`. 在我们的`Syslog config`中，我们有这样的过滤器：

```
if $programname == 'rails' and ($syslogseverity-text == 'emerg') then  @somehost                   

if $programname == 'rails' and ($syslogseverity-text == 'alert') then  @somehost                      

if $programname == 'rails' and ($syslogseverity-text == 'crit') then  @somehost                      

if $programname == 'rails' and ($syslogseverity-text == 'err') then @somehost                        

if $programname == 'rails' and ($syslogseverity-text == 'warn') then @somehost

if $programname == 'rails' then                         ~ 
```

当出现异常或致命错误时，将显示堆栈跟踪日志。但是，我们`logger.error`用来记录它们的任何语句都没有显示出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:03:16.333

看来您需要`#config.logger`在`config/environments/production.rb`.

之后，您可以设置`config.logger = SyslogLogger.new`或进行分布式设置`config.logger = SyslogLogger.new "myApp"`。

您可以查看此[博客文章](https://bowerstudios.com/node/688)或此[stackoverflow 文章](https://stackoverflow.com/questions/1445118/using-syslog-in-rails-application?rq=1)以获取更多信息。

# python - 在python中格式化JSON对象

> ID：14636228
> 
> 赞同：0
> 
> 时间：2013-01-31T22:22:07.753
> 
> 标签：python, python-3.x, python-2.7, json

我在记事本中有 json 对象（C:\data.txt）。有数百万条记录，我只是以一条记录为例。但我只想在记事本上查看数据，例如：1 123-567-9876 TEST1 TEST 717-567-9876 哈里斯堡 null US_PA

我不想要括号等一旦我得到干净的数据，计划是将数据从记事本（比如 C:\data2.txt）导入 SQL 数据库。

这是json对象的格式。

```
{
    "status":"ok",
      "items":[
  {
     "1":{

        "Work_Phone":"123-567-9876",
        "Name_Part":[
           "TEST1",
           "TEST"
        ],
        "Residence_Phone":"717-567-9876",
        "Mailing_City":"Harrisburg",
        "Mailing_Street_Address_line_1":"",
        "Cell_Phone":null,
        "Mailing_Country_AND_Province_OR_State":"US_PA"

     }
      }
   ]
} 
```

有人可以帮助使用 python 代码格式化这个 json 对象并将其导出到记事本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:52:31.553

您可以使用

```
import simplejson as json 
```

然后您可以打开文件并将其加载到 python 字典中：

```
f = file("C:/data.txt","r")
data = json.loads(f.read()) 
```

但这仅在 json-objects 存储在文件的数组中时才有效。所以这必须看起来像这样：

```
[{ ... first date ...},
{... second date ...},
...,
{... last date ...}] 
```

然后在数据中有一个字典数组。现在您可以将日期写入另一个文件：

```
g = file("output.txt","w")
for d in data:
    for i in items:
        for k in i.keys:
             g.write(... some string build from the parameters ...) 
```

如果做得好，文件 output.txt 包含这些行。详细地说，这可能很困难，因为每个项目似乎都包含一些数组。

# jquery - jQuery - 从跨度标签计算平均值并在文本字段中输出

> ID：14636232
> 
> 赞同：1
> 
> 时间：2013-01-31T22:22:27.877
> 
> 标签：jquery, average, jquery-calculation

我刚开始使用 jQuery，但遇到了一些麻烦。我需要在跨度标签之间获取一个数字，并在输入字段中输出平均值。只有值不同于 0 的 span 才有效，否则应忽略它们。此外，数字可以随时更改，平均值必须在不重新加载页面的情况下更新。

相关的 HTML

```
<div>
    <span class="pm_label">5</span>
</div>
<div>
    <span class="pm_label">10</span>
</div>
<div>
    <span class="pm_label">0</span>
</div>

<input type="text" name="average" class="average" value=""> 
```

非工作JS：

```
jQuery( document ).ready( function($) {

    var sum = 0; 
    var nums = 0;

     $('.pm_label').each(function(){

        var value = $(this).html()

        if(value != 0) {

            sum += value;
            nums++;
        }
     });

     var avg = sum / nums ; 

     $('#average').val(Math.floor(avg));
     console.log(avg);

}); 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:31:21.740

为了让你开始：

```
var total = 0,
    valid_labels = 0,
    average;

$('.pm_label').each(function () {
    var val = parseInt(this.innerHTML, 10);
    if (val !== 0) {
        valid_labels += 1;
        total += val;
    }
});

average = total / valid_labels;
$('.average').val(average); 
```

这是一个**[演示](http://jsfiddle.net/F6tsQ/4/)**

你可以把它变成一个函数，并在`span`s' 值改变时调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:31:17.750

修改你的测试框有一个ID

```
<input type="text" name="average" class="average" value=""> 
```

至

```
<input type="text" ID ="average" name="average" class="average" value=""> 
```

或使用名称属性选择

```
$('input[name="average"]').val("");

use sum += parseInt(value);   instead of  sum += value; 
```

# bash - 有没有一种有效的方法来为 bash 提示符中的文本着色而无需两次调用？

> ID：14636234
> 
> 赞同：1
> 
> 时间：2013-01-31T22:22:36.830
> 
> 标签：bash, prompt

无需两次调用即可在 bash 提示符中为文本着色的有效方法？

有很多关于定制 PS1 的资源。这里的关键点是：

*   可以调用自定义函数生成文本，生成自定义文本
*   这样的函数可以发出自定义颜色代码
*   需要标记非打印文本（如颜色代码）以使自动换行工作
*   自定义函数不可能进行该标记。

我在最后一点上可能是错的，如果有办法，那将完美地解决这个问题。

这是一个简化且有些人为的示例，如果这有意义的话，它在拓扑上与我正在修补的示例相似。我有一个外部命令（调用它`generate_text`），它在标准输出上产生“OK”或一些单字消息。它也可能什么都不发射。这三种状态应该显示在提示符中：如果它什么也没发出，则保持提示符原样（`user@hostname:path$`）；如果它发出 OK，在提示符前放一个绿色的“OK”；如果还有其他内容，请将该文本标记为红色。

我目前的解决方案是有一个自定义函数调用 generate_text 并发出其文本或基于它发出颜色代码，然后调用该函数两次：

```
generate_prompt()
{
    txt=`generate_text`
    [ -z "$txt" ] && exit # The empty case. Produce nothing.
    $1 && echo "##$msg## " || case $msg in
        'OK') echo -e '\e[1;32m'; ;; # Green for OK
        *) echo -e "\e[1;31m"; ;; # Red for anything else
    esac
}
PS1='\[$(generate_prompt false)\]$(generate_prompt true)\[\e[0m\]'$PS1 
```

这意味着我必须调用 generate_text 两次并假设它们将返回相同的字符串（通常是这种情况，但理论上状态可能会在两次调用之间发生变化）。这让我觉得有点浪费。有没有一种方便的方法可以在同一个函数中同时发出非打印颜色代码和一段文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:39:55.280

这是未记录的，因此可能不是一个好的解决方案，但似乎有效。它使用 bash 提示的内部知识，这表明 \001 和 \002 字符之间的文本不计入提示字符串中的可见字符数。

```
generate_prompt()
{
    local txt=$(generate_text)
    case "$txt" in
        '') ;;
        OK) echo -e "\001\e[1;32m\002 $txt \001\e[0m\002"; ;; # Green for OK
         *) echo -e "\001\e[1;31m\002 $txt \001\e[0m\002"; ;; # Red for anything else
    esac
}
PS1='$(generate_prompt)'$PS1 
```

扩展提示字符串的 bash 源包含以下用于制定上述解决方案的注释：

```
/* Current implementation:
    \001 (^A) start non-visible characters
    \002 (^B) end non-visible characters
   all characters except \001 and \002 (following a \001) are copied to
   the returned string; all characters except those between \001 and
   \002 are assumed to be `visible'. */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T23:19:45.280

您可以使用 PROMPT_COMMAND 计算所有必需的值，然后在提示符中使用它们：

```
generate_prompt() {
  color="" message=""
  txt=$(generate_text)
  [[ -z $txt ]] && return

  message="##$txt##"
  [[ $txt == OK ]] && color=$'\e[1;32m' || color=$'\e[1;31m'
}
PROMPT_COMMAND=generate_prompt
PS1='\[$color\]$message\[\e[0m\]'$PS1 
```

请注意，有时已将 PROMPT_COMMAND 配置为设置 xterm 标题，在这种情况下，您可以附加到它。

# selenium - 使用 Selenium Web 驱动程序在 iframe 中定位复选框时遇到问题

> ID：14636237
> 
> 赞同：0
> 
> 时间：2013-01-31T22:22:45.910
> 
> 标签：selenium, checkbox, click

我正在尝试使用 Web Driver 和 python 在基于 Javascript 的网站中的 iframe 中找到一个复选框。我尝试通过 ID 和 XPATH 进行定位，但似乎都不起作用，因为我必须在错误的框架中查找。该复选框在页面上对用户可见，selenium IDE 似乎也给出了与我相同的答案，但它仍然导致“NoSuchElementException: Message: u'The element could not be found”

复选框的 html：输入 type="checkbox" onclick="CE.CESECUR.onClickFullSecurity()" id="cefullsecure"

硒代码：_settings_ssl_locator = (By.XPATH, ".//*[@id='cefullsecure' and onclick='CE.CESECUR.onClickFullSecurity()']")

```
def click_settings_enable_ssl(self):
    self.selenium.find_element(*self._settings_ssl_locator).select() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-24T20:12:12.897

我认为您需要先切换到框架，然后找到元素，对框架上存在的元素执行任务/操作，然后切换回上一帧。

```
WebElement checkBoxframe = driver.findElement(By.tagName("enter frame name here"));
driver.switchTo().frame(checkBoxframe);
//write your selenium code here for checkbox
driver.switchTo().defaultContent(); 
```

# jsf-2 - primefaces保存在数据表编辑上不起作用

> ID：14636238
> 
> 赞同：0
> 
> 时间：2013-01-31T22:22:47.160
> 
> 标签：jsf-2, primefaces, cdi

我的 xhtml 页面。添加功能工作正常。所以转换器工作正常，由于 ViewScope 不工作，我尝试了 SessionScope，它工作正常。

```
 <p:commandButton id="addOfficeButton"  icon="ui-icon-circle-plus"  oncomplete="AddOfficeDialog.show();"/>        

   <h:form  id="officeform"> 
    <p:growl id="growl" showDetail="true" sticky="true" />   
      <p:dataTable id="officeDT" var="office" value="#{offices}" rowKey="#{office.id}" style="width:40%"
                   selection="#{officeManagementController.selectedOffice}" selectionMode="single" editable="true">
        <p:ajax event="rowSelect" listener="#{officeManagementController.onRowSelect}" oncomplete="editDlg.show()"
                update=":tabView:officeform:growl,:tabView:officeform:editPanel"/> 
        <p:column sortBy="#{office.id}" headerText="Office ID">
            <h:outputText value="#{office.id}" />  
        </p:column>  

        <p:column headerText="System">     
               <h:outputText value="#{office.department.name}" />
        </p:column>  

        <p:column headerText="Section">     
               <h:outputText value="#{office.role.name}" rendered="#{office.role!=null}"/> 
        </p:column>  

        <p:column headerText="Options" style="width:50px"> 
           <p:rowEditor></p:rowEditor>    
        </p:column> 
      </p:dataTable>

      <p:dialog id="AddOfficeDialog" widgetVar="AddOfficeDialog" modal="true" header="Add/Edit Office" hideEffect="fade" showEffect="fade">
        <p:outputPanel layout="block" id="officeDetail">
         <p:panelGrid columns="2">

            <h:outputText value="Systemmm" />  
            <h:selectOneMenu value="#{officeManagementController.selectedSystem}" converter="#{applicationSystemConverter}">  
               <f:selectItem itemLabel="Select One" itemValue="#{null}" />  
               <f:selectItems value="#{departmentss}" var="appdepartment" itemLabel="#{appdepartment.name}" itemValue="#{appdepartment}"/> 
               <f:ajax event="change" listener="#{officeManagementController.onDepartmentChanged}" render="role"/> 
            </h:selectOneMenu> 

            <h:outputText value="Section" />  
            <h:selectOneMenu id="role" validate="true" value="#{officeManagementController.newOffice.role}" converter="#{departmentSectionConverter}">  
               <f:selectItem itemLabel="Select One" itemValue="#{null}" />  
               <f:selectItems value="#{officeManagementController.assignableRoles}" var="role" itemLabel="#{role.name}" itemValue="#{role}"/>  
            </h:selectOneMenu> 

         </p:panelGrid>
         <p:outputPanel layout="block" style="text-align:center;">
            <p:commandButton actionListener="#{officeManagementController.createOffice}" id="addOffice"  
                             value="Add Office" title="Add new office" oncomplete="AddOfficeDialog.hide();" update="growl,officeform"/>  
         </p:outputPanel>
        </p:outputPanel>
      </p:dialog>

       <p:dialog id="editDlg" widgetVar="editDlg" modal="true"  header="Add/Edit Office" hideEffect="fade" showEffect="fade">
       <p:outputPanel  id="editPanel">
         <p:panelGrid columns="2">
          <h:outputLabel value="Office ID: " />
            <h:outputText  value="#{officeManagementController.selectedOffice.id}"/>

            <h:outputText value="System" />  
            <h:selectOneMenu value="#{officeManagementController.selectedOffice.department}" converter="#{applicationSystemConverter}">  
               <f:selectItem itemLabel="Select One" itemValue="#{null}" />  
               <f:selectItems value="#{applicationSystems}" var="appdepartment" itemLabel="#{appdepartment.name}" itemValue="#{appdepartment}"/> 
               <f:ajax event="change" listener="#{officeManagementController.onApplicationSystemChanged}" render="sect"/> 
            </h:selectOneMenu> 

            <h:outputText value="Section" />  
            <h:selectOneMenu id="sect" validate="true" value="#{officeManagementController.selectedOffice.role}" converter="#{departmentSectionConverter}">  
               <f:selectItem itemLabel="Select One" itemValue="#{null}" />  
               <f:selectItems value="#{officeManagementController.assignableSysSections}" var="role" itemLabel="#{role.name}" itemValue="#{role}"/>  
            </h:selectOneMenu> 

           </p:panelGrid>
           <p:outputPanel layout="block" style="text-align:center;">
           <h:inputHidden binding="#{officeManagementController.selectedOfficeId}" />
          <p:commandButton actionListener="#{officeManagementController.updateOffice()}" 
                    value="Update Office" title="Update office" oncomplete="editDlg.hide();" update="@this,editPanel,growl,officeform"/>  
            </p:outputPanel>
         </p:outputPanel>
      </p:dialog>

   </h:form> 
```

支持豆：

```
 public void updateOffice() {
        selectedOffice.setId(Long.valueOf((String)selectedOfficeId.getValue()));
        officeManagementService.update(selectedOffice);
        facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, CrudStatusMessage.SUCCESS.toString(), "Successfully updated Module: " + selectedOffice.getName()));
    } 
```

我正在使用行值填充对话框，但问题是单击更新按钮，我在部门上收到值不是有效错误，但主要是未设置 selectedModule 的值。请帮忙。坚持了一周。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T03:54:43.023

首先你不需要`()`：

```
<p:commandButton action="#{officeManagementController.updateOffice}" value="Update Office" title="Update office" oncomplete="editDlg.hide();" update="@this,editPanel,growl,officeform"/> 
```

尝试`<f:ajax/>`在你的中使用`<h:selectOneMenu>`并检查它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:40:32.567

我认为您实际上需要`actionListener`（而不是`action`）按钮。您应该阅读 API 文档中的差异，但底线是 actionListener 将执行 AJAX 回发，而 action 将导致重定向（这反过来会破坏您的视图并将其替换为新视图）。

# c# - C#怎么做相当于C++的“Type& operator[]”？

> ID：14636243
> 
> 赞同：0
> 
> 时间：2013-01-31T22:23:25.083
> 
> 标签：c#, get, indexer

我有以下带有索引器的 C# 泛型类：

```
public class MySpecializedContainer<T> where T : new()
{
    private InternalContainer<Element> container;
    public T this[int index]
    {
        set 
        {
            ConvertTToElement( value, container[index] );
        }
        get
        {
            T obj = new T();
            Element elem = container[index];
            ConvertElementToT( elem, obj );
            return obj;
        }
    }
} 
```

正如你所看到的，我的班级假装 Element 的内部容器是 T 的容器，只要我可以将 Element 转换为 T 就可以工作，反之亦然。

我遇到的问题如下：

以下将按预期工作，因为它将有效地更改内部容器中的实际元素：

```
public class MyClass {
   public int a ;
}
MySpecializedContainer<MyClass> container = ...;
MyClass temp = container[18];
temp.a = 5;
container[18] = temp; 
```

但这个更简单的版本不会：

```
container[18].a = 5; 
```

**这只会更改 get 访问器在索引器中创建的副本...**

有什么办法可以使这项工作？

否则我有一个解决方案，至少可以使这个语句“container[18].a=5”不编译，但我真的很想支持它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:40:00.647

No, it's not possible (without major changes to the way your existing code works).

In order to get this to work the `MyClass` instance returned would need to be smart enough to know when it's changed and to update the underlying `Element` when that happens. This isn't possible with a mutable field. If it was a virtual property then you have a shot.

If we modify `MyClass` like so:

```
public class MyClass 
{
   public virtual int a {get;set;}
} 
```

Then we can create a special subclass of it within the container:

```
public class MySpecializedContainer<T> where T : new()
{
    private class MySubClass : MyClass
    {
        private Element wrappedElement;
        public MySubClass(Element wrappedElement)
        {
            this.wrappedElement = wrappedElement;
        }
        public override int a
        {
            set
            {
                base.a = value;
                wrappedElement.Update(value);
            }
        }
    }
} 
```

You'll need to update the `ConvertElementToT` accordingly as well so that you create a new instance of `MySubClass` and pass in the appropriate `Element` object.

So the lesson here is don't use public fields.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:31:02.467

`Element`如果和之间存在引用转换，您只能真正做您想做的事情`T`。然后在您的索引器中，您可以将对转换为的内部对象的引用传回`T`.

# java - 根据java中的整数值减少进度条

> ID：14636248
> 
> 赞同：0
> 
> 时间：2013-01-31T22:23:46.313
> 
> 标签：java, progress-bar, awt

我正在用Java编写游戏，我想知道进度条是否会根据用户输入的生命数量而减少。例如，如果从输入中读取的生命数为 3，那么怪物每接触一次主角，角色的生命就会从进度条中减少 1/3"。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:47:53.540

> 我想知道进度条是否会根据用户输入的生命数量而减少。

假设您已经在绘制进度条，那么如何将用户输入的生命数量传递给您用来绘制进度条的函数。有了这个，您将能够以较小的尺寸绘制进度条。这种方式将允许在函数中处理它：

```
 int userInputLives; //With this variable containing the user input.
 DrawProgressBar(0,400,userInputLives); //Taking x1, y1, User input. 
```

你也可以这样做（假设你像这样绘制进度条）：

```
 int userInputLives; //With this variable containing the users input.
 DrawProgressBar(0,400,0+(userInputLives),400); //Taking x1, y1, x2, y2. 
```

# javascript - Javascript JSON 数据到 HTML 表

> ID：14636252
> 
> 赞同：0
> 
> 时间：2013-01-31T22:24:15.870
> 
> 标签：javascript, json, xml, html-table

我有一些代码，我现在将其粘贴在下面。代码所做的是读取 XML 文件的内容并将其放入 JSON。然后将 JSON 中的数据放入 HTML 表中。除了一件事，一切都很好。创建表格时，第一行（列标题之后）在每个单元格中始终显示为“未定义”。我浏览了这段代码，找不到任何会导致它的东西，但我不是专家，我相信一双新的眼睛会有所帮助，所以有什么想法吗？

```
<html>
<head>
<h1><u>USA State Information</u></h1>
</head>
<body>
<p><b>Please select an area of the USA in the dropdown list below.</b></p>
<p><select name="area" onchange="findXML(this.value)">

<?php
//set directory and open it
$xmldir = 'XML';
$dir = opendir($xmldir);

//create array and read through files in directory
$xmlfiles = array();
while ($file = readdir($dir))
{
    //if the first char is not '.' then add to array
    if (substr($file,-1,1) !== ".")
    {
        $xmlfiles[] = $file;
    }
    else
    {
        //do nothing
    }
}

echo '<option value="select">Select</option>';

foreach($xmlfiles as $area){ 
    echo '<option value="'.$area.'">'.$area.'</option>'; 
}
echo '</select>';

//close directory
closedir($dir);
?>
</p>
<p>
<div id=tbl>
</div>
<table id="elems" border="1" cellspacing="1" cellpadding="5">
<tr>
<td><b>Name</></td>
<td><b>Number</></td>
<td><b>Joined</></td>
<td><b>Population</></td>
</tr>
</table>
<script>
function findXML($area) {
$area = "XML/" + $area;
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET",$area,true);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML;
//find number of elements in the XML file
$length = xmlDoc.getElementsByTagName("name").length;

var JSONObject = [{}];
for (i=0; i!=$length; i++){
    //do something

    JSONObject.push(
    { "name":(xmlDoc.getElementsByTagName("name")[i].childNodes[0].nodeValue),
    "number":(xmlDoc.getElementsByTagName("number")[i].childNodes[0].nodeValue), 
    "joined":(xmlDoc.getElementsByTagName("joined")[i].childNodes[0].nodeValue),
    "population":(xmlDoc.getElementsByTagName("population")[i].childNodes[0].nodeValue) }
    );
}

r=1;
i=0;
for (i=0; i!=($length); i++){

    var tblr = document.getElementById("elems").insertRow(r);
    var cell1= tblr.insertCell(0);
    var cell2= tblr.insertCell(1);
    var cell3= tblr.insertCell(2);
    var cell4= tblr.insertCell(3);
    cell1.innerHTML = JSONObject[i].name;
    cell2.innerHTML = JSONObject[i].number;
    cell3.innerHTML = JSONObject[i].joined;
    cell4.innerHTML = JSONObject[i].population;
    r++;
}

}
</script>
</p>

</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:29:07.287

我想我发现了问题：

```
var JSONObject = [{}]; 
```

应该

```
var JSONObject = []; 
```

The reason this fixes the issue is that you're iterating through the `JSONObject` array starting at the first index. This is fine, but the way you initialized the array gives the first index an empty object. When you go to get the properties `name`, `number`, etc., the empty object won't have them and they'll be returned as undefined.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:27:44.430

你有没有尝试过：

对于 (i= **1** ; i!=($length); i++){

可能是您的索引从 1 而不是 0 开始

# windows-7 - 如何在 reg 文件中传递带空格的参数

> ID：14636254
> 
> 赞同：1
> 
> 时间：2013-01-31T22:24:19.087
> 
> 标签：windows-7, spaces, regedit

谁能告诉我应该如何在以下带有双引号（“%1”）的 .reg 文件中传递参数 %1（在最后一行）。

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell\CopyDateTimeSuffix]
@=""

[HKEY_CLASSES_ROOT\*\shell\CopyDateTimeSuffix\Command]
@="G:\\PRO\\Gemensam\\Program\\CopyDateTimeSuffix\\CopyDateTimeSuffix.bat %1" 
```

问题是参数（包含文件路径）有时包含空格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:45:13.540

或许像这样

```
@="G:\\PRO\\Gemensam\\Program\\CopyDateTimeSuffix\\CopyDateTimeSuffix.bat \"%1\"" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-20T14:59:50.740

我的回答可能有点晚了，但这里是：

[HKEY_CLASSES_ROOT\*\shell\CopyDateTimeSuffix\Command] @="G:\PRO\Gemensam\Program\CopyDateTimeSuffix\CopyDateTimeSuffix.bat %1%*

然后在 CopyDateTimeSuffix.bat ：

DoSomething.exe "%*"

注意：由于某种原因，如果您仅将通配符 %* 作为参数传递，则注册表会返回空白（卡住了一段时间）

# excel - 根据范围内的数据组织/排序工作簿工作表

> ID：14636256
> 
> 赞同：0
> 
> 时间：2013-01-31T22:24:21.190
> 
> 标签：excel, vba

我需要根据特定规则对 Excel 2010 中的一些工作表进行排序。例如，在宏运行的工作簿（Workbook_0）中，我有一个单词列表，全部在一行中，每列一个

*   A：“芒果” B：“苹果” C：“香蕉”。我将此范围保存在 Range 类型的变量中。

我的宏创建了一个新的工作簿 (Workbook_1)，其中的工作表名为，例如，

*   “apple_count”、“apple_avg”、“banana_count”、“banana_average”、“mango_count”、“mango_avg”。

我想做的是根据 Workbook_0 中指定的顺序对 Workbook_1 中的工作表进行排序。在示例中，我将获得

*   “mango_count”、“mango_avg”、“apple_count”、“apple_avg”、“banana_count”、“banana_avg”。

为了让生活更轻松，我确信 Workbook_1 将只有名称包含在 Workbook_0 中的工作表。尽管问我为什么在创建 Workbook_1 时不对工作表进行排序可能是公平的，但这不是我需要做的。我不确定如何在不产生低效且难以调试的代码的情况下进行此操作。

任何帮助是极大的赞赏！谢谢！

更新：@MattCrum 解决方案效果很好。这是我的最终代码，其中包括一些修改（忽略大小写、修复错误、输出到不同的工作簿、移动其他工作表）：

```
Dim rngTemp As Range, rngAll as Range
Dim shtTemp As Worksheet, shtFound As Worksheet

Set rngAll = Range("A1:A3")
Set shtFound = Sheets(1)

' Sort _count sheets
For Each rngTemp In rngAll
    For Each shtTemp In Workbooks(OutputFileName).Worksheets
        If LCase(shtTemp.Name) = LCase(rngTemp.Value) & "_count" Then
            shtTemp.Move , shtFound
            Set shtFound = shtTemp
        End If
    Next
Next

' Move _avg sheets to the right of correctly ordered _count sheets
For Each rngTemp In rngAll
    For Each shtTemp In Workbooks(OutputFileName).Worksheets
        If LCase(shtTemp.Name) = LCase(rngTemp.Value) & "_time" Then
            shtTemp.Move , Sheets(LCase(rngTemp.Value) & "_count")
        End If
        If LCase(shtTemp.Name) = LCase(rngTemp.Value) & "_avg" Then
            shtTemp.Move , Sheets(LCase(rngTemp.Value) & "_time")
        End If
    Next
Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:13:23.570

这是一个相当简单的方法 - 如果你有很多床单，不确定它会有多快，但试一试：

```
Sub SortSheets()

Dim rngAll As Range, rngTemp As Range
Dim shtTemp As Worksheet, shtFound As Worksheet

Set rngAll = Sheet1.Range("A1:A3")
Set shtFound = Sheets(1)

'Sort _count sheets

    For Each rngTemp In rngAll
        For Each shtTemp In ThisWorkbook.Worksheets
            If shtTemp.Name = rngTemp.Value & "_count" Then
                shtTemp.Move , shtFound
                Set shtFound = shtTemp
            End If
        Next
    Next

'Move _avg sheets to the right of correctly ordered _count sheets

    For Each rngTemp In rngAll
        For Each shtTemp In ThisWorkbook.Worksheets
            If shtTemp.Name = rngTemp.Value & "_avg" Then
                shtTemp.Move , Sheets(rngTemp & "_count")
            End If
        Next
    Next

End Sub 
```

# ios - 用于保存的 NSManagedObjectContext 进度表？

> ID：14636257
> 
> 赞同：1
> 
> 时间：2013-01-31T22:24:30.963
> 
> 标签：ios, core-data, nsmanagedobjectcontext, mbprogresshud

有没有办法将 NSManagedObjectContext 设置为定期向委托发送消息，因为它执行复杂的操作，例如删除具有许多级联删除的对象，或将更改保存到磁盘？我会将进度更新发送到 MBProgressHUD 控制器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:18:34.127

总会有办法的。有没有简单的方法？不。

上下文不保存到磁盘本身。Apple 强烈反对继承 NSManagedObjectContext。NSPersistentStore 是实际的序列化/反序列化。您需要创建自己的 NSPersistentStore ，它在保存时将具有可观察的进度属性或委托。

# regex - 如何使用正则表达式提取内部单词

> ID：14636263
> 
> 赞同：0
> 
> 时间：2013-01-31T22:25:04.857
> 
> 标签：regex

我试图只匹配一系列地址中的街道名称。地址可能如下所示：

> 23桶路。
> 
> 14 老磨坊博士
> 
> 65-345 霍华德的虚张声势

我想使用正则表达式来匹配“Barrel”、“Old Mill”和“Howard's”。我需要弄清楚如何排除最后一个词。到目前为止，我有一个排除数字的后视方法，我可以使用以下方法包含单词和空格以及“'”：

```
(?<=\d\s)(\w|\s|\')+ 
```

如何排除最后一个词（可能以句点结尾，也可能不以句点结尾）？我想我应该使用前瞻，但我不知道如何制定它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:32:34.770

我相信你想要的前瞻是`(?=\s\w+\.?$)`.

`\s`：您不想包含最后一个空格 `\w`：至少一个单词字符（AZ、az、0-9 或 '_'） `\.?`：可选句点（对于“St.”等缩写词） `$`：确保这是最后一个字

如果有可能在换行符之前可能有额外的空格，只需将其更改为`(?=\s\w+\.?\s*$)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:33:29.420

您不需要对此进行回顾：

```
/^[-\d]+ ([\w ']+) \w+\.?$/ 
```

*   匹配一个或多个数字和连字符
*   空间
*   将字母、数字、空格、撇号匹配到捕获组 1
*   空间
*   匹配最后一个单词和一个可选的句点

一个示例 Ruby 实现：

```
regex = /^[-\d]+ ([\w ']+) \w+\.?$/

tests = [ "23 Barrel Rd.",  "14 Old Mill Dr.", "65-345 Howard's Bluff" ]

tests.each do |test|
  p test.match(regex)[1]
end 
```

输出：

```
"Barrel"
"Old Mill"
"Howard's" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:36:49.143

为什么不只匹配你想要的？如果我理解得很好，你需要得到数字后面的所有单词，不包括最后一个单词。单词由空格分隔，因此只需获取数字和最后一个空格之间的所有内容。

[例子](http://regex101.com/r/dD3rW9)

`\d+(?:-\d+)? ((?:.)+) `注意：末尾有空格。

Tha 最终会得到你想要的 \1 N 次。

如果您只想匹配您可能使用的确切文本`\K`（并非每个正则表达式引擎都支持）但是：[示例](http://regex101.com/r/wB8oO8)

使用正则表达式`\d+(?:-\d+)? \K.+(?= )`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T22:44:32.040

另一种选择是使用`split()`大多数脚本语言中提供的功能。这是您想要的 Python 版本：

`stname = address.split()[1:-1]`

（这`address`是原始地址行，`stname`是街道名称，即您要提取的内容。）

# javascript - 如何基于一个属性优化 JS 对象的数组查找

> ID：14636266
> 
> 赞同：0
> 
> 时间：2013-01-31T22:25:18.127
> 
> 标签：javascript, jquery, arrays

我们有大量的对象：

```
var englishStudents = [
    {StudentId: 1, Name: "John"},
    {StudentId: 2, Name: "Jack"},
    {StudentId: 3, Name: "Jane"}
]; 
```

需要检查另一个类似的对象是否包含在这个数组中，只需比较一个属性即可。

```
var randomStudent = {StudentId: 1337, Name: "Foo"}; 
```

这就是我所拥有的，似乎它会起作用，但我认为这不是最好的方法。

```
var studentIds = $.map(englishStudents, function (student, index) { return student.StudentId; });
var randomStudentLearnsEnglish = false;
for (var sId in studentIds) {
    if (randomStudent.StudentId == sId) {
        randomStudentLearnsEnglish = true;
        break;
    }
} 
```

这样做的优化方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:31:22.587

您应该将学生数据保存在像[JHashtable](http://www.timdown.co.uk/jshashtable/)这样的哈希表中，而不是数组中。对于更复杂的场景，你可以维护多个哈希表，比如`studentsById`,`studentsByCountryCode`等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:39:25.517

If all you want to know is if the ID exists can do this:

```
function checkIdExists( id){
    /* map array of matching ID, if none exists length of array is zero*/
    return  $.map(englishStudents, function (student, index) { 
               return student.StudentId==id; 
    }).get().length;
}); 
```

Use:

```
 if( checkIdExists( 1234)){
     /* run exists code*/
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T22:30:37.563

只需做一个哈希而不是一个数组，所以：

```
var englishStudents = {
    1: {StudentId: 1, Name: "John"},
    2: {StudentId: 2, Name: "Jack"},
    3: {StudentId: 3, Name: "Jane"}
}; 
```

然后要检索，只需执行以下操作：

```
var student = englishStudents[id]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T22:30:49.090

如果你真的想要，你可以创建一个进一步的索引方案：

```
var englishStudents = [
    {StudentId: 1, Name: "John"},
    {StudentId: 2, Name: "Jack"},
    {StudentId: 3, Name: "Jane"}
];
 //if doing this a lot of time, take the one time hit of construction and memory
var idToNameMap = createIdToNameMap(englishStudents); //returns {'1': 'John', '2': Jack' , '3': 'Jane'}

var randomStudent = getRandomStudent();
if( idToNameMap[ randomStudent.StudentId] != undefined){ ... } 
```

# compilation - libpng 版本 1.5.14 缺少 endif

> ID：14636267
> 
> 赞同：1
> 
> 时间：2013-01-31T22:25:19.887
> 
> 标签：compilation, libpng, cray

我曾尝试使用 CC 5.10 在 Cray x86_64 系统上编译 libpng 1.5.14，但经常遇到丢失的 endif 错误。我通过在文件末尾添加#endif 修复了许多这些错误，允许“make check”继续通过第一个系列的 3 个测试。但是，dfn.c 中有 1 个我无法修复的 endif 错误。我试图通过将 dfn.c 复制到 hack_dfn.c，在 hack_dfn.c 的末尾添加 #endif 语句，然后在重新创建 dfn.c 之后让 Makefile 将 hack_dfn.c 复制到 dfn.c 来破解它，但没有成功编译过程。以下是未对 dfn.c 文件进行任何修复的最后输出，包括我收到的错误：

```
Running tests.  For details see pngtest-log.txt
Running test-pngtest.sh
  PASS: pngtest --strict pngtest.png
PASS: test-pngtest.sh
Running test-pngvalid-simple.sh
  PASS: pngvalid --standard
  PASS: pngvalid --standard --progressive-read
  PASS: pngvalid --standard --interlace
  PASS: pngvalid --standard --progressive-read --interlace
  PASS: pngvalid --size
  PASS: pngvalid --size --progressive-read
  PASS: pngvalid --transform
PASS: test-pngvalid-simple.sh
Running test-pngvalid-full.sh
  PASS: pngvalid --gamma-threshold
  PASS: pngvalid --gamma-transform
  PASS: pngvalid --gamma-sbit
  PASS: pngvalid --gamma-16-to-8
  PASS: pngvalid --gamma-background
  PASS: pngvalid --gamma-alpha-mode
  PASS: pngvalid --gamma-transform --expand16
  PASS: pngvalid --gamma-background --expand16
  PASS: pngvalid --gamma-alpha-mode --expand16
PASS: test-pngvalid-full.sh
==================
All 3 tests passed
==================
make[1]: Leaving directory `/usr/local/libpng-1.5.14'
rm -f scripts/symbols.out dfn.c dfn?.out
test -d scripts || mkdir scripts
echo '#include "scripts/symbols.dfn"' >dfn.c
cc -E -DHAVE_CONFIG_H -I.  -DPNG_CONFIGURE_LIBPNG\
             -DPNGLIB_LIBNAME='PNG15_0' -DPNGLIB_VERSION='1.5.14' -DSYMBOL_PREFIX='' -DPNG_NO_USE_READ_MACROS -DPNG_BUILDING_SYMBOL_TABLE dfn.c > dfn1.out
PGC-S-0218-Missing #endif (dfn.c: 2)
PGC/x86-64 Linux 12.4-0: compilation completed with severe errors
make: *** [scripts/symbols.out] Error 2 
```

我没有时间检查 3282 个 if[n]def 语句，检查每个语句是否已关闭。我希望这里有比我自己更了解 libpng 的人至少可以帮助我找到可以开始寻找的地方。奇怪的是，我能够在另一个使用 gcc 的系统上编译相同版本的 libpng 而没有问题。我希望避免在这个系统上使用 gcc。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T05:16:38.713

也许你的 C 预处理器被 #endif 语句上的注释弄糊涂了，例如，

```
 #endif /* PNG_READ_SUPPORTED */ 
```

# jsf - 未调用 handleFileUpload

> ID：14636269
> 
> 赞同：0
> 
> 时间：2013-01-31T22:25:28.280
> 
> 标签：jsf, file-upload, primefaces

我的文件上传有一个奇怪的问题

永远不会调用handleFileUpload，并且在xhtml文件中它用黄色强调它并说unkown property

这是我的 web.xml

```
<context-param>
        <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
        <param-value>server</param-value>
    </context-param>
    <filter>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <servlet-name>Faces Servlet</servlet-name>
    </filter-mapping>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    </servlet> 
```

我的文件上传控制器，我回去看看能不能调用最基本的版本，但目前还不行

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package richard.fileupload;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import javax.annotation.PostConstruct;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.context.FacesContext;

import org.primefaces.event.FileUploadEvent;

@ManagedBean(name = "fileUploadController")
public class FileUploadController {

     public void handleFileUpload(FileUploadEvent event) {
     System.out.println("called");
     FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
     FacesContext.getCurrentInstance().addMessage(null, msg);
     }
     }
      /*
    private String username;

    @PostConstruct
    public void init() {
        System.out.println("called get username");
        username = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
    }
    private String destination = "C:/Users/Richard/printing~subversion/fileupload/web/WEB-INF/uploaded/"; // main location for uploads
    File theFile = new File(destination + username); // will create a sub folder for each user (currently does not work, below hopefully is a solution) 

    public File getDirectory(String destination, String username) {
             System.out.println("called get directory");
        // currently not working, is not calling the username or destination 
        //set the user directory from the destinarion and the logged user name
        File directory = new File(destination, username);
        //check if the location exists
        if (!directory.exists()) {
            //let's try to create it
            try {
                directory.mkdir();
            } catch (SecurityException secEx) {
                //handle the exception
                secEx.printStackTrace(System.out);
                directory = null;
            }
        }
        return directory;
    }

    public void handleFileUpload(FileUploadEvent event) {
             System.out.println("called handle file");
        FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
        FacesContext.getCurrentInstance().addMessage(null, msg);
        try {
            copyFile(event.getFile().getFileName(), event.getFile().getInputstream());
        } catch (IOException e) {
            //handle the exception
            e.printStackTrace();
        }
    }

    public void copyFile(String fileName, InputStream in) {
        try {

            // write the inputStream to a FileOutputStream
            OutputStream out = new FileOutputStream(new File(theFile + "/" + fileName)); // cannot find path when adding username atm
            System.out.println(theFile); //testing 

            int read = 0;
            byte[] bytes = new byte[1024];

            while ((read = in.read(bytes)) != -1) {
                out.write(bytes, 0, read);
            }

            in.close();
            out.flush();
            out.close();
//make sure new file is created, (displays in glassfish server console not to end user)
            System.out.println("New file created!");
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }
    }
}
*/ 
```

这是我的uploadText.xhtml

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:corejsf="http://corejsf.com"> 
    <h:outputStylesheet name="css/testcss.css" />
    <h:head>
        <title>Print to Uni</title>
        <meta http-equiv="content-type" content="text/html; charset=windows-1252" />
        <!-- <link rel="stylesheet" type="text/css" href="style.css" title="style" /> -->
    </h:head>
    <body>
        <div id="main">
            <div id="header">

                <div id="logo">
                    <div id="logo_text">
                        <h1><a href="/GUI/index.xhtml">Remote<span class="logo_colour">Printing</span></a></h1>
                        <h2>This is a web app that allows users to print to University</h2>
                    </div>
                </div>
            </div>
        </div>
    </body>
    <div id="site_content">
        <div id="content">
            <h:body>
                <h:form enctype="multipart/form-data">
                    Upload a text file:
                    <h:form>
                        <!--<p:growl id="messages" showSummary="true" showDetail="true" /> -->
                        <br></br>
                        <br></br>

                        <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"
                                      mode="advanced" 
                                      update="messages"
                                      sizeLimit="100000000" 
                                      allowTypes="/(\.|\/)(gif|jpe?g|png|doc|docx|txt|pdf)$/"
                                      auto="true"/>
                        <p:growl id="messages" showDetail="true"/>
                    </h:form>
                    <br></br>
                    <br></br>
                    <p:commandButton value="Submit" action="/GUI/submittedText" icon ="ui-icon-arrowstop-1-n"/>
                    <div class="divider"/>
                    <p:commandButton  value="Homepage" action="#{userBean.buttonHome}" icon="ui-icon-home"/>   
                </h:form>
            </h:body>
        </div>
    </div>
</html> 
```

我的库中需要两个公共文件，这是什么原因造成的？我确实让它工作但没有备份更改，现在它不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T01:03:40.903

您的 HTML 在[语法上无效](http://validator.w3.org)。其中，您有多个`<body>`标签并且您正在嵌套`<form>`元素。JSF 看起来像个魔术师，但如果*你*强迫它生成语法上无效的 HTML，那么它就无能为力了。当涉及到语法无效的 HTML 时，浏览器的行为是未指定的。嵌套表单通常是浏览器没有向服务器提交预期数据的原因，因此服务器最终什么也没有收到。

您的 HTML 应该只有一个`<body>`标记（在 JSF 术语中，因此只有一个`<h:body>`）。你的 HTML 也不应该有嵌套`<form>`元素（在 JSF 术语中，你不应该`<h:form>`相互嵌套）。在浏览器中打开页面，右键单击并*查看源代码*。将其复制粘贴到前面链接的 W3 验证器中并单独修复问题。

除此之外，您的托管 bean 没有分配范围注释。每次在 EL 中引用它时都会`@NoneScoped`重新创建它，从而导致模型属性和操作在完全独立的实例中设置和调用。至少做到`@ViewScoped`。

# jquery - 切换多个搜索区域和手柄图标

> ID：14636270
> 
> 赞同：0
> 
> 时间：2013-01-31T22:25:33.140
> 
> 标签：jquery, html

我需要做的是在`<h2>`单击时切换每个搜索区域。

我还需要它来切换`<h2> <span>`元素上的类 icon-minus 和 icon plus。（这没有显示在我的小提琴上，因为它需要安装字体。）

在加载时，它应该只显示第一个搜索区域，其余部分隐藏（显示：无）。

它还必须能够切换当前搜索区域和图标。

我有一个蹩脚的尝试[jsFiddle](http://jsfiddle.net/mbUbg/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:51:11.890

你可以这样做。您只需要添加一个[.not()](http://api.jquery.com/not/)以便当前 div 不会与其他 div 一起隐藏

```
$('.s-container h2').on('click', function () {
  var $el = $(this);
  var div = $el.next('.s-area');
  $('.s-area').not(div).hide(); // hide all but the current one that is toggling
  div.slideToggle('fast',function(){ 
      // add correct class accordingly to the h2 elemeents
      $('.s-container h2').attr('class',function(){
            return $(this).next('.s-area').is(':visible') ? 'icon-minus' : 'icon-plus';
      });
  });
}); 
```

[http://jsfiddle.net/3KESK/](http://jsfiddle.net/3KESK/)

# .net - 改进正则表达式以按季度匹配日期时间

> ID：14636274
> 
> 赞同：0
> 
> 时间：2013-01-31T22:25:46.870
> 
> 标签：.net, regex

我想验证一个字符串以匹配日期，如`'dd.mm.yyyy HH:mm'`季度`:00`、、、`:15``:30``:45`

例子

```
12.03.2012 20:00
28.12.2014 20:15
31.09.2012 01:45 
```

这个正则表达式对我有用

```
^(0[1-9]|[12][0-9]|3[01]).(0[1-9]|1[012]).((20)\d\d) ([01][0-9]|2[0-4]):([01][05]|[4][5]|[3][0])?$ 
```

但是，这是最好的方法吗？

请给一些建议以改进它。

**在@Kobi 很棒的建议之后**

```
^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.((20)[1-9][0-9]) ([01][0-9]|2[0-4]):([03]0|[14]5)?$ 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:32:13.680

`[01][05]|[4][5]|[3][0]` 可能匹配`10`或`05`，您正在寻找`[03]0|[14]5`。

`:(...)?`验证以 . 结尾的字符串`:`。你想要类似的东西`(:...)?`- 冒号应该在括号内。

确保转义点：`\.`而不是`.`- 否则它匹配所有字符。

如果这最终出现在 .net 引擎上，则`\d`匹配所有 Unicode 数字，因此您可能更喜欢`[0-9]`.

我还建议使用以下代码，这可能会更加健壮（例如 - 它使 29.02.2013 与 29.02.2012 之类的日期无效）：

```
public bool IsValidDateAndHour(string input)
{
    DateTime date;
    bool success = DateTime.TryParseExact(input, "dd.MM.yyyy HH:mm",
                                          CultureInfo.InvariantCulture,
                                          DateTimeStyles.None, out date);
    return success && date.Minute % 15 == 0;
} 
```

# ios - 使用 gcsize 对象访问数组

> ID：14636277
> 
> 赞同：-1
> 
> 时间：2013-01-31T22:25:51.587
> 
> 标签：ios, objective-c, nsmutablearray, nsarray

我想在集合视图中创建不同大小的单元格。在**collectionViewLayout sizeForItemAtIndexPath我用****CGSize**对象创建了一个数组。当我想检索存储在 NSArray 中的对象（与 NSMutableArray 相同）时，我得到以下语义问题：

```
Returning 'id' from a function with incompatible result type 'CGSize' (aka 'struct CGSize') 
```

如何访问数组中的 CGSize 对象？

编辑：我发现存储在数组中的值来自 NSSize 类型。

```
-(CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout *)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath {
    UIImage *image;
    int row = [indexPath row];

    NSArray *mElements = [NSArray arrayWithObjects:[NSValue valueWithCGSize:CGSizeMake(306.0, 270.0)],
                                [NSValue valueWithCGSize:CGSizeMake(100.0, 150.0)],
                                [NSValue valueWithCGSize:CGSizeMake(200.0, 150.0)],
                                [NSValue valueWithCGSize:CGSizeMake(200.0, 150.0)],
                                [NSValue valueWithCGSize:CGSizeMake(100.0, 150.0)],
                                nil];

    return [mElements objectAtIndex:row]; // Semantic issue

} 
```

我不明白的是，在另一部分，同样的方法有效......

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {

    CollectionViewCell *myCell = (CollectionViewCell *)[collectionView dequeueReusableCellWithReuseIdentifier:Cellid forIndexPath:indexPath];

    int row = [indexPath row];

    myCell.cellImageView.image = [self.searches objectAtIndex:row];  // Here it works...
    return myCell;
} 
```

为什么它适用于具有 UIImages 的数组而不适用于具有 CGSize 对象的数组？

干杯——杰里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:30:27.453

> 为什么它适用于具有 UIImages 的数组而不适用于具有 CGSize 对象的数组？

因为`UIImage`s**是**对象，所以`CGSize`s**不是对象。**（*但你可以而且应该在他们各自的文档中查找这一点，真的......*）

如果您尝试理解错误消息，那就足够了。您的数组包含对象（类型`NSValue *`）而不是`CGSize`结构。所以你不能直接从数组中返回一个对象。您必须获取`NSValue`对象并从中提取`CGSize`结构：

```
return [[mElements objectAtIndex:row] CGSizeValue]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:44:31.293

SIGABRT 被抛出，因为我的迭代数组比定义的 mElements 数组长。现在它起作用了。

# jdbc - 使用 JDBC Driver for Informix + 遇到 NULL 值时抛出 SQLException

> ID：14636278
> 
> 赞同：0
> 
> 时间：2013-01-31T22:25:56.303
> 
> 标签：jdbc, informix, sqlexception

我正在为 Informix 使用 JDBC 驱动程序。我很好地连接到我的主机，但是当执行查询时，我的选择中指定的字段之一返回空值。而不是仅仅检索该值，并且 SQLException 被抛出：

在查询的任何表中都找不到列 (colname)（或 SLV 未定义）。

我以这种方式使用驱动程序：

```
 try{
    PreparedStatement pstmtDist = conn.prepareStatement(query2);

    ResultSet rsDist = pstmtDist.executeQuery();

    while(rsDist.next()){
            int distCaseId = 0;
            String distCaseIdStr = new String();

            int distCaseDefNum = 0;
            String distCaseDefNumStr = new String();

            distCaseIdStr = rsDist.getObject("colname").toString();
            distCaseId = Integer.parseInt(distCaseIdStr.trim());

            distCaseDefNumStr = rsDist.getObject("colname2").toString();
            distCaseDefNum = Integer.parseInt(distCaseDefNumStr.trim());

            //System.out.println(String.format("distCaseId == %d  distCaseDefNum == %d\n",distCaseId,distCaseDefNum));

    }// end while district cases

    rsDist.close();
    pstmtDist.close();
    connDist.close();

    }
    catch (SQLException e){
            System.out.println("EXCEPTION: "+e.getMessage());

    } 
```

欢迎任何提示！

-TU

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T11:07:04.830

我认为问题在于：

```
 distCaseDefNumStr = rsDist.getObject("colname2").toString(); 
```

`getObject()`并且可以返回类似的行`null`。

如果你`colname2`有`null`值然后`getObject()`返回`null`，然后 Java 尝试在对象上运行`toString()`方法。`null`

是的，关于 column not found in result 的消息很奇怪，但我认为您确实观察到了*空指针异常*。的使用`getString()`或`getInt()`方法`ResultSet`。

# java - Ant compile 没有创建构建目录

> ID：14636279
> 
> 赞同：0
> 
> 时间：2013-01-31T22:25:56.330
> 
> 标签：java, eclipse, ant

环境：Mac OSX 10.7.5、Eclipse 4.2.1、Apache Ant 1.8.2 版

我在 Eclipse 中创建了一个示例 Hello World 程序，然后将项目导出到 build.xml 文件中。

在提示符下我输入：

$蚂蚁

> 构建文件：/Users/cspam/Documents/workspace/TestHelloWorld/build.xml
> 
> 构建子项目：
> 
> 在里面：
> 
> 构建项目：[echo] TestHelloWorld：/Users/cspam/Documents/workspace/TestHelloWorld/build.xml
> 
> 建造：
> 
> 构建成功

但我正在寻找的构建目录没有创建。这是我的xml文件：

```
<project basedir="." default="build" name="TestHelloWorld">
<property environment="env"/>
<property name="ECLIPSE_HOME" value="../../eclipse"/>
<property name="debuglevel" value="source,lines,vars"/>
<property name="target" value="1.6"/>
<property name="source" value="1.6"/>
<path id="TestHelloWorld.classpath">
    <pathelement location="bin"/>
</path>
<target name="init">
    <mkdir dir="bin"/>
    <copy includeemptydirs="false" todir="bin">
        <fileset dir="src">
            <exclude name="**/*.java"/>
        </fileset>
    </copy>
</target>
<target name="clean">
    <delete dir="bin"/>
</target>
<target name="cleanall" depends="clean"/>
<target name="build" depends="build-subprojects,build-project"/>
<target name="build-subprojects"/>
<target name="build-project" depends="init">
    <echo message="${ant.project.name}: ${ant.file}"/>
    <javac debug="true" debuglevel="${debuglevel}" destdir="bin" includeantruntime="false" source="${source}" target="${target}">
        <src path="src"/>
        <classpath refid="TestHelloWorld.classpath"/>
    </javac>
</target>
<target name="build-refprojects" description="Build all projects which reference this project. Useful to propagate changes."/>
<target name="init-eclipse-compiler" description="copy Eclipse compiler jars to ant lib directory">
    <copy todir="${ant.library.dir}">
        <fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar"/>
    </copy>
    <unzip dest="${ant.library.dir}">
        <patternset includes="jdtCompilerAdapter.jar"/>
        <fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar"/>
    </unzip>
</target>
<target name="build-eclipse-compiler" description="compile project with Eclipse compiler">
    <property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter"/>
    <antcall target="build"/>
</target> 
```

我是使用 Ant 的新手——所以这对我来说是全新的。有人告诉我它应该构建一个“构建”目录，但它没有被创建。我不确定我在做什么，如果有任何指示/帮助/建议，我将不胜感激。

更新：正如@Cliff 建议的那样。这是执行 ant -clean 后 ant 的输出

> 构建文件：/Users/cspam/Documents/workspace/TestHelloWorld/build.xml
> 
> 构建子项目：
> 
> 初始化：[mkdir] 创建目录：/Users/cspam/Documents/workspace/TestHelloWorld/bin
> 
> build-project: [echo] TestHelloWorld: /Users/cspam/Documents/workspace/TestHelloWorld/build.xml [javac] 编译2个源文件到/Users/cspam/Documents/workspace/TestHelloWorld/bin
> 
> 建造：
> 
> 构建成功总时间：0 秒

看起来 .class 文件确实是在清理后创建的。在 Eclipse 中右键单击“build.xml”文件并执行 Run As->Ant Build 也将成功执行相同操作。

我现在正在将此 xml 文件推送到 Bamboo 以查看是否可以正常运行。这是一个直接的过程吗？再次感谢您的帮助。

# linq - 将 Linq 查询结果返回到 List 对象

> ID：14636280
> 
> 赞同：4
> 
> 时间：2013-01-31T22:26:03.663
> 
> 标签：linq, entity-framework

我正在尝试将查询结果返回到 List 对象中，但是我通常使用的以下代码不起作用。对 Linq 来说还是比较新的，有人可以解释正确的语法/发生了什么吗？如果我将数据类型更改`productTraining`为`var`...

```
List<AgentProductTraining> productTraining = new List<AgentProductTraining>();  

productTraining = from records in db.CourseToProduct
                  where records.CourseCode == course.CourseCode
                  select records; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-31T22:29:09.640

`Select()`并且`Where()`会返回`IQueryable<T>`，不会`List<T>`。您必须将其转换为`List<T>`- 实际执行查询（而不仅仅是准备它）。

您只需要`ToList()`在查询结束时调用。例如：

```
// There's no need to declare the variable separately...
List<AgentProductTraining> productTraining = (from records in db.CourseToProduct
                                              where records.CourseCode == course.CourseCode
                                              select records).ToList(); 
```

但是，当您所做的只是一个`Where`子句时，我个人不会使用查询表达式：

```
// Changed to var just for convenience - the type is still List<AgentProductTraining>
var productTraining = db.CourseToProduct
                        .Where(records => records.CourseCode == course.CourseCode)
                        .ToList(); 
```

# sql - SQL，如何将 VARCHAR 转换为 bigint？

> ID：14636282
> 
> 赞同：26
> 
> 时间：2013-01-31T22:26:11.680
> 
> 标签：sql, sql-server

我有一个字段，`VARCHAR(6)`我正在尝试将其插入到另一个类型`bigint` 的表中，这给了我一个错误

（从数据类型 varchar 转换为 bigint 时出错

这就是我在做什么

```
CONVERT(bigint, seconds) as seconds 
```

有人可以帮忙解决这个问题吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-01T00:09:01.393

这是答案

```
(CASE
  WHEN
    (isnumeric(ts.TimeInSeconds) = 1) 
  THEN
    CAST(ts.TimeInSeconds AS bigint)
  ELSE
    0
  END) AS seconds 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-01T06:04:09.060

另一种方法是执行以下操作：

```
SELECT
   CAST(P0.seconds as bigint) as seconds
FROM
   (
   SELECT
      seconds
   FROM
      TableName
   WHERE
      ISNUMERIC(seconds) = 1
   ) P0 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-01T06:16:07.467

我认为您的代码是正确的。如果您运行以下代码，它将转换被视为 varchar 的字符串 '60' 并返回整数 60，如果在第二个中存在包含字符串的整数，则它可以工作。

```
select CONVERT(bigint,'60') as seconds 
```

它返回

```
60 
```

# html - 如何使用垂直堆叠的 div 作为每个填充浏览器窗口的页面？

> ID：14636284
> 
> 赞同：0
> 
> 时间：2013-01-31T22:26:17.730
> 
> 标签：html, css, height, liquid-layout

我已经在一些网站上看到了一种效果，它们为您提供了基本上垂直的“页面”，每个页面都填满了浏览器窗口。例子：

[http://www.bleed.no/](http://www.bleed.no/)

[http://www.weworkonsunday.com/](http://www.weworkonsunday.com/)

第一个是更清洁和更复杂的交易。

我一直在想如何实现这种效果。如果高度不是问题，那么使用页面锚等就足够简单了，但是填充窗口的垂直方向（以及宽度）是让我失望的原因。

有没有我想念的简单方法？或者都是一些复杂的java tomfoolery？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:54:43.493

此结果确实需要一些 javascript 专业知识（以您的示例中实现的方式）。

有一个 jquery 库试图简化这个过程。

[http://stephband.info/jparallax/](http://stephband.info/jparallax/)

即使没有真正简单的实现方法。效果非常依赖于布局并且是一种“新”的网站制作方式的原因之一......直到有人解决这个问题需要一些时间。

这是另一个如何在没有库帮助的情况下以您描述的方式实现视差的示例。

操作方法：http : [//net.tutsplus.com/tutorials/html-css-techniques/simple-parallax-scrolling-technique/](http://net.tutsplus.com/tutorials/html-css-techniques/simple-parallax-scrolling-technique/) 演示： http: [//nettuts.s3.amazonaws.com/2138_SimpleParallax/Demo/index。 html](http://nettuts.s3.amazonaws.com/2138_SimpleParallax/Demo/index.html)

如果您搜索“视差滚动”，您会发现很多其他资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:56:25.717

从概念上讲，我将构建一个带有堆叠 div 的垂直页面，所有这些都具有响应窗口高度的相同类（并且在调整浏览器大小时也会响应）。使用 jQuery 的未经测试的代码：

```
<div id="page1" class="page">content</div>
<div id="page2" class="page">content</div>
<div id="page3" class="page">content</div>

<script>

    // set up onResize event handler
    window.onresize = onResizeScreen;

    // run onResize event handler once on load
    $.(function() { onResizeScreen(); });

    // onResize event handler
    function onResizeScreen(event) {
        $(".page").attr("height", screen.height);
    }

    // function to scroll to specific page
    function gotoPage(pageNumber){
        window.scroll(screen.height*pageNumber-1);
    }

</script>

<style>
    .page {
        width: 100%;
    }
</style> 
```

你对解决这类问题听起来很陌生。如果您不知道上述内容的含义，请检查 jQuery 并处理 JavaScript 事件。

# php - Uncaught SyntaxError: Unexpected token <; 未捕获的 ReferenceError：未定义初始化

> ID：14636285
> 
> 赞同：0
> 
> 时间：2013-01-31T22:26:34.593
> 
> 标签：php, javascript, mysql, google-maps-api-3

我知道以前有人问过这个问题，但我似乎在我的代码中找不到错误：

它在下面（它是用于谷歌地图的 javascript，内部有一个 php 调用来动态地为标记用户创建一个纬度和经度数组）：

```
<script type="text/javascript">

var directionDisplay;
var directionsService = new google.maps.DirectionsService();
var map;

function initialize() {
    directionsDisplay = new google.maps.DirectionsRenderer();

    var mapOptions = {
    zoom: 5,
    mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById('map_canvas'),
                              mapOptions);
    directionsDisplay.setMap(map);

    var markers = [

    <?php

    //orgnize fans by city
    $query = "SELECT city, state, COUNT(*) fans FROM users GROUP BY city ORDER BY fans DESC";
    $result = mysql_query($query) or die(mysql_error());
    while($row = mysql_fetch_array($result)){

    //pulls the city, state code from the database and stores it as a string in $address
    $address = urlencode('"' . $row['city'] . ", " . $row['state'] . '"');
    $googleApi = 'http://maps.googleapis.com/maps/api/geocode/json?address=%s&sensor=false';     

    $json = file_get_contents(sprintf($googleApi, $address));   
    $resultObject = json_decode($json);

    $location = $resultObject->results[0]->geometry->location;

    $lat = $location->lat;
    $lng = $location->lng;

        echo "{ lat: ".$lat.", lng: ".$lng.", name: ".'"'.$row['city'].", ".$row['state'].'"'."},";
    }

    ?>

    ];

    // Create the markers ad infowindows.
    for (index in markers) addMarker(markers[index]);
    function addMarker(data) {
        // Create the marker
        var marker = new google.maps.Marker({
            position: new google.maps.LatLng(data.lat, data.lng),
            map: map,
            title: data.name
        });

        // Create the infowindow with two DIV placeholders
        // One for a text string, the other for the StreetView panorama.
        var content = document.createElement("DIV");
        var title = document.createElement("DIV");
        title.innerHTML = data.name;
        content.appendChild(title);
        var streetview = document.createElement("DIV");
        streetview.style.width = "200px";
        streetview.style.height = "200px";
        content.appendChild(streetview);
        var infowindow = new google.maps.InfoWindow({
            content: content
        });

        // Open the infowindow on marker click
        google.maps.event.addListener(marker, "click", function() {
            infowindow.open(map, marker);
        });

        // Handle the DOM ready event to create the StreetView panorama
        // as it can only be created once the DIV inside the infowindow is loaded in the DOM.
        google.maps.event.addListenerOnce(infowindow, "domready", function() {
            var panorama = new google.maps.StreetViewPanorama(streetview, {
            navigationControl: false,
            enableCloseButton: false,
            addressControl: false,
            linksControl: false,
            visible: true,
            position: marker.getPosition()
            });
       });

    }

    // Try HTML5 geolocation
    if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            var pos = new google.maps.LatLng(position.coords.latitude,
            position.coords.longitude);

            var infowindow = new google.maps.InfoWindow({
            map: map,
            position: pos,
            content: 'Your Current City'
        });

            map.setCenter(pos);
        }, function() {
        handleNoGeolocation(true);
        });

    } else {
        // Browser doesn't support Geolocation
        handleNoGeolocation(false);
    }

}

function handleNoGeolocation(errorFlag) {
    if (errorFlag) {
        var content = 'Error: The Geolocation service failed.';
    } else {
        var content = 'Error: Your browser doesn\'t support geolocation.';
    }

    var options = {
    map: map,
    position: new google.maps.LatLng(60, 105),
    content: content
    };

    var infowindow = new google.maps.InfoWindow(options);
    map.setCenter(options.position);
}

function calcRoute() {
    var start = document.getElementById('start').value;
    var end = document.getElementById('end').value;
    var waypts = [];
    var checkboxArray = document.getElementById('waypoints');
    for (var i = 0; i < checkboxArray.length; i++) {
        if (checkboxArray.options[i].selected == true) {
            waypts.push({
                        location:checkboxArray[i].value,
                        stopover:true});
        }
    }

    var request = {
    origin: start,
    destination: end,
    waypoints: waypts,
    optimizeWaypoints: true,
    travelMode: google.maps.DirectionsTravelMode.DRIVING
    };
    directionsService.route(request, function(response, status) {
                            if (status == google.maps.DirectionsStatus.OK) {
                            directionsDisplay.setDirections(response);
                            var route = response.routes[0];
                            var summaryPanel = document.getElementById('directions_panel');
                            summaryPanel.innerHTML = '';
                            // For each route, display summary information.
                            for (var i = 0; i < route.legs.length; i++) {
                            var routeSegment = i + 1;
                            summaryPanel.innerHTML += '<b>Route Segment: ' + routeSegment + '</b><br>';
                            summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
                            summaryPanel.innerHTML += route.legs[i].end_address + '<br>';
                            summaryPanel.innerHTML += route.legs[i].distance.text + '<br><br>';
                            }
                            }
                            });
}

google.maps.event.addDomListener(window, 'load', initialize);

</script>

<body onload="initialize()">

<center><div id="map_canvas" style="width: 1100px; height: 450px;">map div</div></center> 
```

ETC...

这是 php 部分的 javascript 控制台输出：

```
 var markers = [

    <br />
Uncaught SyntaxError: Unexpected token <
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22San+Francisco%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "San Francisco, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22New+York%2C+NY%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "New York, NY"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Los+Angeles%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Los Angeles, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Oakland%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Oakland, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22San+Diego%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "San Diego, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Lafayette%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Lafayette, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Chester+Springs%2C+PA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Chester Springs, PA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Berkeley%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Berkeley, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Gilbert%2C+AZ%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Gilbert, AZ"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Martinez%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Martinez, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Queens%2C+NY%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Queens, NY"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Manhattan%2C+NY%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Manhattan, NY"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Brier%2C+WA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Brier, WA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Sacramento%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Sacramento, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Pacific+Beach%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Pacific Beach, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22New+London%2C+CT%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "New London, CT"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Santa+Cruz%2C+CA%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Santa Cruz, CA"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Jackson%2C+MS%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Jackson, MS"},<br />
<b>Warning</b>:  file_get_contents() [<a href='function.file-get-contents'>function.file-get-contents</a>]: http:// wrapper is disabled in the server configuration by allow_url_fopen=0 in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
<br />
<b>Warning</b>:  file_get_contents(http://maps.googleapis.com/maps/api/geocode/json?address=%22Honolulu%2C+HI%22&amp;sensor=false) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: no suitable wrapper could be found in <b>/nfs/c09/h04/mnt/139243/domains/crowdsets.com/html/maptest.php</b> on line <b>202</b><br />
{ lat: , lng: , name: "Honolulu, HI"},    
    ]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:38:24.850

Error message says that file_get_contents can't access http:// protocol (disabled in php.ini). You can enable it by changing `allow_url_fopen=1` in php.ini, read more at [http://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen](http://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen) . If that's not possible (you don't have server config access), you could use one of those instead of file_get_contents:

1.  php native socket [http://php.net/manual/en/book.sockets.php](http://php.net/manual/en/book.sockets.php)
2.  php curl extension (has to be enabled/installed to server): [http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)
3.  Zend_Http_Client wrapper for other adapters [http://framework.zend.com/manual/1.12/en/zend.http.client.html](http://framework.zend.com/manual/1.12/en/zend.http.client.html)

It's much easier to catch and handle errors with one of those suggested extensions/libraries.

# bash - 我将如何制作一个运行带有 & 符号 & 的命令的别名？

> ID：14636286
> 
> 赞同：1
> 
> 时间：2013-01-31T22:26:39.237
> 
> 标签：bash, vim, ubuntu-unity

我正在尝试使用 Unity 运行 gvim 工作，但我似乎无法让它工作。

一种解决方法是我可以运行该命令`gvim -f MYARGS&`以使其与 Unity 配合使用。

这让统一管理菜单栏或其他东西。为此，我尝试了类似的命令：`alias gvim=gvim& -f`，但这不起作用。然后我试着让它成为一个函数

```
alias gvim=gvim_hack
# Why isnt this passing all args (if any) to gvim and running it the way I want?
gvim_hack()
{
  gvim -f $@ &
} 
```

但这似乎也不起作用。我对linux很陌生。

已解决：我有名称冲突

```
alias gvim=gvim_hack
gvim_hack()
{
  /usr/bin/gvim -f $@ &
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:28:22.117

定义别名时使用引号。

```
alias gvim='gvim -f &' 
```

# sql - 在sql中将本地日期时间从xml转换为日期时间

> ID：14636287
> 
> 赞同：4
> 
> 时间：2013-01-31T22:26:48.187
> 
> 标签：sql, sql-server, xml

我正在通过 xml 接收一些数据，这些数据将被插入到关联的 SQL 表中。我用来插入数据的方法是在 sql 中查询 XML 并根据需要进行批量插入。

我遇到的问题是日期永远不会被识别为有效日期，因此总是回到默认日期。

这是带有提供日期的 XML 片段

```
<Upload xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <DeviceID>0008E02B66DD_</DeviceID>
  <DeviceType>03.20</DeviceType>
  <FarmID>2</FarmID>
  <UploadDate>0001-01-01T00:00:00</UploadDate>
  <Sessions>
    <SessionID>99</SessionID>
    <RecordedDate>2012-02-03T13:00:00+13:00</RecordedDate>
    <Readings />
  </Sessions>

... 
```

这是我处理它的 SQL 代码片段

```
Select
(CASE 
 WHEN ISDATE(s.value('(RecordedDate)[1]', 'varchar(50)')) = 1 THEN s.value('(RecordedDate)[1]', 'varchar(50)')
 ELSE @UploadDate
 END) DateOfMeasurement
INTO #Session
FROM
@XMLData.nodes('/Upload') AS Upload(u)
CROSS APPLY
u.nodes('./Sessions') Sessions(s) 
```

*   注意：@UploadDate 实际上是 SQL getDate() 的值，即我的默认值

我要插入的数据库中的字段是**日期**时间字段

问题：

我想将 XML 中收到的日期（即**2012-02-03T13:00:00+13:00**）插入到我的 SQL 数据库中的日期时间字段中。反正有没有在 SQL 中很好地转换它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T22:57:04.753

```
declare @XMLData xml = '
<Upload xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <DeviceID>0008E02B66DD_</DeviceID>
  <DeviceType>03.20</DeviceType>
  <FarmID>2</FarmID>
  <UploadDate>0001-01-01T00:00:00</UploadDate>
  <Sessions>
    <SessionID>99</SessionID>
    <RecordedDate>2012-02-03T13:00:00+13:00</RecordedDate>
    <Readings />
  </Sessions>
</Upload>';

select T.N.value('substring((RecordedDate/text())[1], 1, 19)', 'datetime'),
       T.N.value('(RecordedDate/text())[1]', 'datetime'),
       T.N.value('(RecordedDate/text())[1]', 'datetimeoffset')
from @XMLData.nodes('/Upload/Sessions') as T(N); 
```

结果：

```
2012-02-03 13:00:00.000 
2012-02-03 00:00:00.000 
2012-02-03 13:00:00.0000000 +13:00 
```

# log4j - 使用 jboss-as-7.1.1 配置 log4j

> ID：14636289
> 
> 赞同：4
> 
> 时间：2013-01-31T22:26:52.950
> 
> 标签：log4j, jboss7.x

我已经在这个论坛、jboss 文档和互联网上阅读了很多内容，以成功获得 log4j 配置以与 jboss 一起使用 7.1.1，我不想在 jboss 中使用日志记录子系统。我想使用我自己的 log4j 配置。我的 jboss 服务器配置为独立模式。以下是我根据文档配置 log4j 所做的：

1.  根据[https://docs.jboss.org/author/display/AS71/How+To#HowTo-HowdoIuselog4j.propertiesorlog4j.xmlinsteadofusingtheloggingsubsystemconfiguration%3F](https://docs.jboss.org/author/display/AS71/How+To#HowTo-HowdoIuselog4j.propertiesorlog4j.xmlinsteadofusingtheloggingsubsystemconfiguration%3F)定义一个 jboss-deployment-structure.xml ，我在 META-INF 中添加了这个我的 EAR 目录
2.  我按原样添加了一个 log4j.xml，并打包在我耳朵的 lib 目录中的一个 jar 中。
3.  从standalone.xml 中删除了日志子系统和扩展模块=“org.jboss.as.logging”。
4.  我没有更改在 startup.sh 中作为启动参数提供的 logging.properties，因为我已经读过这是 jboss 服务器在子系统启动之前将使用的日志记录。

尽管做了所有这些，但我无法让应用程序按照我的 log4j 配置进行记录。

我使用我自己的 log4j 配置而不是日志记录子系统的原因是能够为 size-rotating-file-handler 使用自定义滚动文件附加程序，因为我希望旋转的文件具有附加到文件名的时间戳。

帮助表示赞赏，

好的，所以我创建了一个从 SizeRotatingFileHandler.java 扩展的类 MyHandler.java 并覆盖了 preWrite 方法。MyHandler.java 在包 abc 中我在模块 a/b/c 下创建了一个子目录，并在 c 目录中添加了一个仅包含 Myhandler.class 文件的 jar。我添加了一个 module.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.0" name="a.b.c">
     <resources>
           <resource-root path="RotatingHandler.jar"/>
          <!-- Insert resources here -->
     </resources>
     <dependencies>
          <module name="org.jboss.logging"/>
     </dependencies>
</module> 
```

然后在standalone.xml中我为自定义处理程序添加了一个条目

```
<custom-handler name="FILE3" class="a.b.c.MyHandler" module="a.b.c">
        <level name="INFO"/>
        <formatter>
            <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
        </formatter>
        <file relative-to="jboss.server.log.dir" path="srveree.log"/>
    </custom-handler> 
```

当我启动 Jboss 时，它说它找不到类 abcMyHandler。如何解决此错误？

更新：我解决了这个错误。模块内部的包结构有问题。但是，我仍然要回到原来的问题，即使用 jboss-as-7.1.1.Final 配置 log4j。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T14:52:38.857

我能够用 jboss 配置 log4j。事实证明，您需要为主部署中的每个子部署单独添加排除项。例如，我的耳朵里面有 jar 和 war 文件。所以我在 jboss-deployment-structure.xml 中为它们中的每一个添加了单独的条目并且它起作用了。

```
<sub-deployment name="your-subdeployment.jar">
    <exclusions>
        <module name="org.apache.log4j"/>
        <module name="org.slf4j" />
        <module name="org.apache.commons.logging"/>
        <module name="org.log4j"/>  
        <module name="org.jboss.logging"/>
    </exclusions>
</sub-deployment> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T01:36:32.187

您没有指出的一件事是您是否也在`EAR/lib`文件夹中添加了 log4j 库。我想你可能有，或者你应该看到其他错误。

`log4j.xml`老实说，我不确定 log4j 是否会在您的 EAR 中包含一个 JAR。我认为这`EAR/META-INF`将是您的 log4j 配置文件更合适的位置。

在这种情况下，没有真正的理由删除日志子系统。另外，我并不是要说服您使用它，但您可以相当轻松地创建自定义处理程序来执行您想要执行的操作。您可以基于[SizeRotatingFileHandler](https://github.com/jboss-logging/jboss-logmanager/blob/master/src/main/java/org/jboss/logmanager/handlers/SizeRotatingFileHandler.java)，然后在[rename](https://github.com/jboss-logging/jboss-logmanager/blob/master/src/main/java/org/jboss/logmanager/handlers/SizeRotatingFileHandler.java#L182)上添加一个后缀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-16T14:14:56.673

考虑在您的standalone.xml 中进行配置

```
<subsystem xmlns="urn:jboss:domain:logging:1.1"> 
```

这里可以设置

```
<console-handler name="CONSOLE">
            <level name="DEBUG"/>
...
        <logger category="com.myCompany">
            <level name="DEBUG"/>
        </logger>
... 
```

意味着：您在 com.myCompany 包中的类中的记录器应该从 DEBUG 级别记录。

# python - python中的安全凭证存储

> ID：14636290
> 
> 赞同：17
> 
> 时间：2013-01-31T22:26:57.580
> 
> 标签：python, security, reflection, storage, credentials

## 攻击

在凭证存储环境中，一种可能的威胁模型是攻击者，它具有以下能力：

*   检查任何（用户）进程内存
*   读取本地（用户）文件

AFAIK，对这种类型的攻击的共识是无法防止（因为凭据必须存储在内存中以供程序实际使用它们），但是有几种技术可以减轻它：

*   最小化敏感数据在内存中的存储时间
*   一旦不再需要数据就覆盖内存
*   通过隐蔽措施破坏内存中的数据，继续移动它和其他安全措施

## 特别是 Python

第一种技术很容易实现，可能[通过密钥环](http://pypi.python.org/pypi/keyring) （希望是内核空间存储）

据我所知，如果不编写 C 模块，第二个是根本无法实现的（但我很想在这里被证明是错误的，或者有一个现有模块的列表）

第三个很棘手。

特别是，python 是一种具有非常强大的自省和反射能力的语言，很难阻止任何可以在解释器进程中执行 python 代码的人访问凭据。

似乎有一种共识，即[没有办法强制执行私有属性](https://stackoverflow.com/questions/551038/private-implementation-class-in-python)，并且[尝试这样做最多只会惹恼正在使用您的代码的其他程序员](https://stackoverflow.com/questions/10365193/is-this-code-truly-private-python/10365338#10365338)。

## 问题

考虑到所有这些，如何使用 python 安全地存储身份验证凭据？最佳实践是什么？可以对“一切都是公共的”哲学做些什么吗？我知道[“我们在这里都是成年人”](https://en.wikipedia.org/wiki/Python_syntax_and_semantics)，但我们是否应该被迫在与攻击者共享密码和使用另一种语言之间做出选择？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-04T08:18:21.730

存储身份验证凭据的原因有两个：

1.  *对您的*用户进行身份验证：例如，您仅在用户对您的程序进行身份验证后才允许用户访问服务
2.  *使用另一个程序或服务对程序*进行身份验证：例如，用户启动您的程序，然后使用 IMAP 通过 Internet 访问用户的电子邮件。

在第一种情况下，您永远不应该存储密码（或密码的加密版本）。相反，您应该使用高质量的盐对密码进行*哈希处理，并确保您使用的哈希算法计算量大（以防止字典攻击），例如 PBKDF2 或 bcrypt。*有关更多详细信息，请参阅[Salted Password Hashing - Doing it Right 。](http://crackstation.net/hashing-security.htm)如果你遵循这种方法，即使黑客检索到了加盐的、散列缓慢的令牌，他们也不能做太多事情。

在第二种情况下，采取了许多措施来使秘密发现变得更加困难（正如您在问题中概述的那样），例如：

*   将机密加密直到需要，按需解密，然后立即重新加密
*   使用地址空间随机化，因此每次应用程序运行时，密钥都存储在不同的地址
*   使用操作系统密钥库
*   使用 C/C++ 等“硬”语言，而不是 Java 或 Python 等基于 VM 的内省语言

这样的方法当然聊胜于无，但熟练的黑客迟早会破解它。

## 代币

从理论的角度来看，身份验证是证明被挑战的人是他们所说的人的行为。传统上，这是通过共享秘密（密码）实现的，但还有其他方法可以证明自己，包括：

*   [带外](http://en.wikipedia.org/wiki/Out-of-band)身份验证。例如，在我居住的地方，当我尝试登录我的网上银行时，我会在手机上收到[一次性密码](http://en.wikipedia.org/wiki/One-time_password)(OTP) 作为短信。在这种方法中，我证明我拥有一个特定的电话号码
*   [安全令牌](http://en.wikipedia.org/wiki/Security_token)：要登录服务，我必须按下令牌上的按钮以获取 OTP，然后将其用作我的密码。
*   其他设备：

    *   [智能卡](http://en.wikipedia.org/wiki/Smart_card)，特别是美国国防部使用的智能卡，它被称为[CAC](http://en.wikipedia.org/wiki/Common_Access_Card)。Python 有一个名为[pyscard](http://pyscard.sourceforge.net/)的模块来与此接口
    *   [NFC](http://en.wikipedia.org/wiki/Near_field_communication#Security_aspects)设备

还有一个更完整的列表[在这里](http://en.wikipedia.org/wiki/Two-factor_authentication)

所有这些方法之间的共同点是最终用户控制这些设备，并且秘密实际上永远不会离开令牌/卡/电话，当然也永远不会存储在您的程序中。这使它们更加安全。

## 会话窃取

然而（总有一个然而）：

让我们假设您设法保护登录，因此黑客无法访问安全令牌。现在您的应用程序正在愉快地与安全服务进行交互。不幸的是，如果黑客可以在您的计算机上运行任意可执行文件，则黑客可以劫持您的会话，例如通过在您对服务的有效使用中注入额外的命令。换句话说，虽然您已经保​​护了密码，但它完全无关紧要，因为黑客仍然可以访问“安全”资源。

这是一个非常真实的威胁，正如多次跨站点脚本攻击所显示的那样（一个例子是[美国银行和美国银行网站易受攻击](http://news.softpedia.com/news/U-S-Bank-and-Bank-of-America-Websites-Vulnerable-112148.shtml)，但还有无数）。

## 安全代理

如上所述，将帐户凭据保存在第三方服务或系统上是一个基本问题，以便应用程序可以登录，尤其是在唯一的登录方法是用户名和密码的情况下。

一种方法是通过将与服务的通信委托给安全代理来部分缓解这种情况，并在应用程序和代理之间开发一种安全登录方法。在这种方法中

*   应用程序使用 PKI 方案或双因素身份验证来登录安全代理
*   用户将第三方系统的安全凭证添加到安全代理。凭据永远不会存储在应用程序中
*   稍后，当应用程序需要访问第三方系统时，它会向代理发送请求。代理使用安全凭证登录并发出请求，将结果返回给应用程序。

这种方法的缺点是：

*   用户可能不想信任存储凭据的安全代理
*   用户可能不信任通过它流向第三方应用程序的数据的安全代理
*   应用程序所有者有额外的基础设施和托管成本来运行代理

## 一些答案

所以，关于具体的答案：

> 如何使用 python 安全地存储身份验证凭据？

*   如果存储应用程序的密码以验证用户，请使用 PBKDF2 算法，例如[https://www.dlitz.net/software/python-pbkdf2/](https://www.dlitz.net/software/python-pbkdf2/)
*   如果存储密码/安全令牌以访问其他服务，则没有绝对安全的方法。
*   [但是，请考虑使用例如pyscard](http://pyscard.sourceforge.net/)将身份验证策略切换到例如智能卡。您可以使用智能卡对应用程序的用户进行身份验证，也可以使用 X.509 证书对另一个服务安全地对应用程序进行身份验证。

> 可以对“一切都是公共的”哲学做些什么吗？我知道“我们在这里都是同意的成年人”，但我们是否应该被迫在与攻击者共享密码和使用另一种语言之间做出选择？

*恕我直言，用 Python 编写一个特定*的模块并没有错，它确实隐藏了秘密信息，使其成为其他人重用的正确错误（惹恼其他程序员*是它的目的*）。您甚至可以在 C 中编写大部分代码并链接到它。但是，出于明显的原因，不要对其他模块执行此操作。

但是，最终，如果黑客控制了计算机，则计算机上根本就没有隐私。理论上最坏的情况是您的程序在虚拟机中运行，并且黑客可以完全访问计算机上的*所有*内存，包括 BIOS 和显卡，并且可以通过身份验证逐步了解您的应用程序以发现其秘密。

鉴于没有绝对的隐私，剩下的只是混淆，而保护级别仅仅是混淆的难度与熟练的黑客想要信息的程度。我们都知道这将如何[结束](http://news.cnet.com/8301-10805_3-57563484-75/windows-rt-jailbreak-tool-unleashed-online/)，即使对于[定制硬件](http://nakedsecurity.sophos.com/2012/10/25/sony-ps3-hacked-for-good-master-keys-revealed/)和[价值数十亿美元的产品](http://www.ibtimes.com/ios-6-61-untethered-jailbreak-evasi0n-be-released-monday-algorithm-used-progress-bar-hints-12pm-est)也是如此。

> 使用 Python 密钥环

虽然这将相对于其他应用程序非常安全地管理密钥，但*所有 Python 应用程序都*共享对令牌的访问权限。对于您担心的攻击类型，这一点也不安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-30T09:35:46.717

我不是该领域的专家，我真的只是想解决与您相同的问题，但看起来像[Hashicorp 的 Vault 之](https://hashicorp.com/blog/vault.html)类的东西可能会提供很好的帮助。

特别是 WRT 存储第三部分服务凭证的问题。例如：

> 在 API 驱动的现代世界中，许多系统还支持以编程方式创建访问凭证。Vault 通过称为动态机密的功能利用这种支持：按需生成的机密，并且还支持自动撤销。
> 
> 对于 Vault 0.1，Vault 支持动态生成 AWS、SQL 和 Consul 凭证。

更多链接：

*   [Github](https://github.com/hashicorp/vault)
*   [保险柜网站](https://www.vaultproject.io)
*   [用例](https://www.vaultproject.io/intro/use-cases.html)

# griffon - griffon：向我的应用程序添加一个 splitPane

> ID：14636294
> 
> 赞同：0
> 
> 时间：2013-01-31T22:27:33.227
> 
> 标签：griffon

我需要在我的 Griffon 应用程序中添加一个 splitPane textArea。我似乎找不到正确语法和方法的示例。

谁能帮我吗？？

到目前为止，这是我的观点：

==================================================== ================================

```
package test1

import griffon.util.GriffonNameUtils as GNU
import java.beans.PropertyChangeListener

application(title: 'Test1',
  //preferredSize: [600, 300],
  pack: true,
  locationByPlatform: true,
  iconImage:   imageIcon('/griffon-icon-48x48.png').image,
  iconImages: [imageIcon('/griffon-icon-48x48.png').image,
               imageIcon('/griffon-icon-32x32.png').image,
               imageIcon('/griffon-icon-16x16.png').image]) {                  

    borderLayout()
    panel(constraints: WEST,
          border: titledBorder(title: 'Platform')) {
        migLayout()
        buttonGroup(id: 'platform')
        def radioButtonConverter = { String title, v -> v ? title : model.deviceType }
        for (data in model.deviceTypes) {
            radioButton(data.title, buttonGroup: platform, constraints: 'wrap',
                selected: bind('deviceType', target: model,
                          converter: radioButtonConverter.curry(data.title), value: data.selected))
        }
    }

    panel(constraints: EAST,
          border: titledBorder(title: 'Path Browser')) {
        migLayout()
        controller.griffonClass.actionNames.each { name ->
            button(getVariable(name + 'Action'),
                constraints: 'growx, wrap')
        }
    }

    panel(constraints: CENTER, id: 'devicePanel',
          border: titledBorder(id: 'devicePanelBorder', title: 'No Devices')) {
        noparent {
            model.addPropertyChangeListener('deviceType', { e ->
                model.deviceTypes.each{ d-> d.selected = false }
                model.deviceTypes.find{ d -> d.title == e.newValue }.selected = true
                devicePanelBorder.title = e.newValue
                devicePanel.layout.show(devicePanel, e.newValue)
                devicePanel.repaint() // force redraw
            } as PropertyChangeListener)
        }
        cardLayout()
        for(data in model.deviceTypes) {
            // we set the title as the page's constraints -> simplifies bookkeeping
            // in the PropertyChangeListener registered above
            panel(constraints: data.title) {
                gridLayout(cols: 2, rows: (data.devices.size()/2))
                data.devices.each { device ->
                    checkBox(device.name, selected: bind(value: device.selected, target: device, 'selected'))
                }
            }
        }
    }

    panel(constraints: SOUTH) {
        riverLayout()
        buttonGroup(id: 'execute', constraints: 'center')
        button('Build XML', buttonGroup: execute)
        button('Run', buttonGroup: execute)
        button('Exit', buttonGroup: execute)
    }

    panel(constraints: NORTH) {
        riverLayout()
        label('TWC Companion Device Test Tool', constraints: 'center')
    }
} 
```

==================================================== ===========================================

谢谢！！

铁螳螂7x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T09:43:19.193

如 SwingPad 所示（[https://github.com/griffon/griffon/blob/master/src/dist/samples/SwingPad/griffon-app/views/griffon/samples/swingpad/SwingPadContent.groovy](https://github.com/griffon/griffon/blob/master/src/dist/samples/SwingPad/griffon-app/views/griffon/samples/swingpad/SwingPadContent.groovy)）使用`splitPane`很简单

```
splitPane(resizeWeight: 0.5f) {
     label('Left component')
     label('Right component')
} 
```

查看 Griffon 指南的查看部分以了解有关节点的更多信息

[http://griffon.codehaus.org/guide/latest/guide/views.html#specialNodes](http://griffon.codehaus.org/guide/latest/guide/views.html#specialNodes)

以下链接指向可与 SwingBuilder 一起使用的所有节点

[http://groovy.codehaus.org/Swing+Builder](http://groovy.codehaus.org/Swing+Builder)

最后，您可以启动 SwingPad ($GRIFFON_HOME/samples/SwingPad) 并使用实时节点。此应用程序包括所有节点的列表（帮助 -> 节点列表）以及一个非常基本的节点名称完成功能。

# python - 过滤包含元组字符串的 Python 字典值中的项目

> ID：14636295
> 
> 赞同：2
> 
> 时间：2013-01-31T22:27:44.303
> 
> 标签：python, dictionary

我需要从以下内容创建一个新字典：

```
{'FOO': "('BAR','BAA'),('CAR','CAA')", 'FOOO': "('BAAR','BAAA'),('CAAR','CAAA')"} 
```

我想在字典值的元组字符串中检索项目，并使用原始键和检索到的项目作为对应值创建一个新字典。检索的项目必须按位置（每个元组的第一项）。完成的字典应如下所示：

```
{'FOO': ('BAR','CAR'), 'FOOO': ('BAAR','CAAR') 
```

这应该相对容易，但我一直在努力完成这项工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:31:07.597

您可以使用`ast.literal_eval`来解析这些字符串。然后只需提取正确的元素即可。

```
d = {'FOO': "('BAR','BAA'),('CAR','CAA')", 'FOOO': "('BAAR','BAAA'),('CAAR','CAAA')"}
d2 = {k: zip(*ast.literal_eval(v))[0] for k,v in d.iteritems()}
# d2 is now {'FOO': ('BAR', 'CAR'), 'FOOO': ('BAAR', 'CAAR')} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:31:27.840

首先，[`ast.literal_eval`](http://docs.python.org/2/library/ast.html#ast.literal_eval)将每个`"('BAR','BAA'),('CAR','CAA')"`变成`(('BAR', 'BAA'), ('CAR', 'CAA'))`.

然后你可以做得到`[0]`第一个。这就是你所缺少的吗？

值得注意的是，作为一般规则，如果您使用`literal_eval`，您通常会做错事。例如`tuple`，您可以存储 JSON 数组或[`pickle`d](http://docs.python.org/2/library/pickle.html)或[`marshal`led](http://docs.python.org/2/library/marshal.html) `tuple` ，而不是存储 a 的字符串文字版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T22:39:37.987

这可能不是最好的方法，但您可以使用正则表达式解决它。

```
import re

di={'FOO': "('BAR','BAA'),('CAR','CAA')",
      'FOOO': "('BAAR','BAAA'),('CAAR','CAAA')"}

ndi = {}
for k in di:
    ndi[k] = re.findall('\(\'(\w+)\'\,', di[k]) 
```

# google-maps-sdk-ios - 大量标记

> ID：14636301
> 
> 赞同：3
> 
> 时间：2013-01-31T22:28:08.920
> 
> 标签：google-maps-sdk-ios

我正在使用需要管理 400-500 个标记的 SDK 版本 1.0.2 开发应用程序。一般来说，性能非常好，除非自定义信息窗口可见。较大的数字或标记和自定义信息窗口会导致 UI 卡顿。

我意识到问题是标记的数量，当我减少标记的数量时，问题不会出现。我试图通过仅添加在 didChangeCameraPosition 回调期间可见的标记来减少标记的数量，但我发现添加和删除标记对性能的影响更大。

不知道我还能尝试什么，任何关于如何进行的建议都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T20:12:48.547

2013 年 7 月发布的新 SDK 版本 1.4.0 有一个新的委托方法`mapView:idleAtCameraPosition:`，它将在相机移动结束后调用。因此，您可以将标记添加逻辑转移到此方法，而不是 `didChangeCameraPosition`在相机更改过程中多次调用该方法。这应该会提高一些性能。

# ruby-on-rails - 是否可以将 Blocks 或 Procs 作为参数发送给 Sidekiq？

> ID：14636302
> 
> 赞同：2
> 
> 时间：2013-01-31T22:28:10.003
> 
> 标签：ruby-on-rails, ruby, sidekiq

我有一个标准系统，用于对各种数据集执行计算。很棒的是我可以将这些计算作为 Proc 传递给 perform 方法。这是我想要完成的事情：

```
class Calculator
    include Sidekiq::Worker

    def perform rails_model , rails_model_id
         obj = Kernel.const_get( rails_model ).find( rails_model_id )
         yield( obj )
    end
end

Calculator.perform_asyc( "User" , 123 , { |u| u.do_something } ) 
```

这种事情是可能的还是不好的做法？我知道直接发送对象是不好的做法，所以我假设发送块也是一个坏主意？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:02:15.150

这是不可能的。Ruby 中的代码没有序列化格式，只有数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-08T21:35:39.623

实际上，您可以实现这一点。我需要一个工作人员对记录集合执行一些操作，但我希望能够灵活地更改模型上的查询，以便在需要时返回不同的集合。

```
class MyWorker
  include Sidekiq::Worker

  def perfom(scoping_query)
    MyModel.class_eval(scoping_query).call.find_each do |m|
     # do stuff...
    end
  end    
end

MyWorker.perform_async("proc { where(attribute: value) }") 
```

我的解决方案将适用于您的示例。

```
class Calculator
  include Sidekiq::Worker

  def perform(klass, id, code_block)
    obj = klass.constantize.find(id)
    klass.constantize.class_eval(code_block).call(obj)
  end
end

Calculator.perform_asyc("User", 123, "proc { |u| u.do_something }") 
```

如您所见，诀窍是将块作为字符串发送，然后在返回 Proc 的类的范围内评估该字符串，然后您可以调用它。

# ms-access - SQL_query WHERE User = 'Windows 用户名'

> ID：14636308
> 
> 赞同：1
> 
> 时间：2013-01-31T22:28:29.567
> 
> 标签：ms-access, vbscript, hta

我正在开发一个使用 vbscript 访问、读取和更新 MS Access 数据库的 HTA。我希望能够选择当前 Windows 用户名与数据库中的“用户”列匹配的所有记录。

我之前使用过下面的示例来收集 Windows 用户名，但是在尝试插入`strSender`查询时我没有任何运气。

```
Set wshShell = CreateObject( "WScript.Shell" )
strSender = wshShell.ExpandEnvironmentStrings( "%USERNAME%" ) 
```

任何建议表示赞赏。

谢谢。

添加于 02-01-13：

这是一个片段，可让您了解我要做什么。

```
Dim conn

sub dotheconnection

Set conn = CreateObject("ADODB.Connection")

conn.Open "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=./Database/data.mdb; User Id=; Password="

If conn.errors.count <> 0 Then 

    alert("problem connecting to the database")
else
    getdata

end if
end sub

sub getdata

SQL_query = "SELECT * FROM MyDatabase ORDER BY Team, Status, Employee"
Set rsData = conn.Execute(SQL_query)

strHTML = strHTML & "<table id='data_table' cellspacing='0' cellpadding='4' border='1'><tr><td bgcolor='#000000'><font color='blue'><b>Employee</b></font></td><td bgcolor='#000000'><font color='blue'><b>Team</b></font></td><td bgcolor='#000000'><font color='blue'><b>Status</b></font></td></tr>"
Do Until rsData.EOF = True
strHTML = strHTML & "<tr class='in_out'><td onclick='deleteUser("& rsData("ID") &")' language='vbscript' style='cursor:hand; color:red'>del</td><td>" & rsData("Employee") & "</td><td>" & rsData("Team") & "</td><td><b>" & rsData("Status") & " </b></td> <td onclick='editUser("& rsData("ID") &")'language='vbscript' style='cursor:hand; color:red'>Edit</td></tr>"
rsData.moveNext ' go to next record
Loop

strHTML = strHTML & "</table>"
thediv.innerHTML = strHTML

SQL_query = "SELECT Count(*) AS intTotal FROM MyDatabase"
Set rsData = conn.Execute(SQL_query)
strHTML1 = strHTML1 & "<b>Number of Users: </b>"
strHTML1 = strHTML1 & "" & rsData("intTotal") & ""
Count.innerHTML = strHTML1
end sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:19:08.093

我将此参数查询保存为*qryFetchUserRecords*：

```
PARAMETERS which_user Text ( 255 );
SELECT yt.*
FROM YourTable AS yt
WHERE yt.User=[which_user]; 
```

此 VBScript 使用来自该查询的结果集加载 ADO 记录集。它使用命名查询作为连接对象的“方法”，并将参数值作为参数提供给该方法。

```
Dim cn ' As ADODB.Connection
Dim rs ' As ADODB.Recordset
Dim strSender ' As String

Set cn = CreateObject("ADODB.Connection")
cn.Open "your connection string"
Set rs = CreateObject("ADODB.Recordset")
strSender = CreateObject("WScript.Network").UserName
cn.qryFetchUserRecords strSender, rs
' do stuff with recordset here
rs.Close
Set rs = Nothing
Set cn = Nothing 
```

如果您不想使用已保存的查询，可以使用 ADO Command 对象并在执行之前将参数添加到其中。但这对我来说似乎是不必要的额外努力。

当心`User`是一个保留字，因此可以通过在语句中将其括在方括号中来避免麻烦`SELECT`，或者像我在该示例中所做的那样使用表名或别名对其进行限定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:33:28.527

看起来您可能需要 WScript.NetWork 对象。请参阅此处的示例：http: [//www.codeproject.com/Articles/1422/Getting-User-Information-Using-WSH-and-VBScript](http://www.codeproject.com/Articles/1422/Getting-User-Information-Using-WSH-and-VBScript)

# php - 5 小时后终止进程的 cron 作业

> ID：14636311
> 
> 赞同：6
> 
> 时间：2013-01-31T22:28:40.557
> 
> 标签：php, cron, crontab

我基本上有一个每天晚上运行的 cron 作业，它更新我数据库中的数千种产品。

我在晚上运行 cron 作业的原因是因为在此期间没有多少人访问该站点，服务器上的延迟会更短，cron 作业几乎可以运行数天而不受任何干扰。

这是 cron 作业命令的样子

```
30 23 * * *     /usr/bin/php /var/www/ul/prices_all.php >> /var/www/ul/log/prices_all.txt 
```

我想知道的是是否有可能创建一个 cron 作业在 5 小时后杀死这个进程，例如

```
30 05 * * *     kill /var/www/ul/prices_all.php[process] 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-31T22:31:15.347

您可以使用超时 (coreutils) 执行此操作：

```
30 23 * * *   timeout 18000  /usr/bin/php /var/www/ul/prices_all.php >> /var/www/ul/log/prices_all.txt 
```

它只是设置一个超时时间（18000 秒 = 5 小时），如果在该时间之后它仍在运行，则终止该进程。

或者您可以在 php 文件本身中设置超时：

```
<?php set_time_limit(18000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:33:28.893

是的，您可以创建一个 cronjob，在 5 小时后终止该进程。有一些不错的方法可以做到这一点。例如，您可以让第一个脚本在启动时将其 pid（您可以使用[getmypid()](http://php.net/manual/en/function.getmypid.php)获取）写入文件，然后让第二个 cron 作业读取该 pid 并终止它。这会起作用，但非常不优雅。

如果您的 PHP 配置允许（即不在安全模式下），更优雅的方法是在脚本本身中设置[执行限制。](http://php.net/manual/en/function.set-time-limit.php)

# c++ - 是否可以为访问 USB 设备的三星智能电视编写 C++ 应用程序

> ID：14636312
> 
> 赞同：0
> 
> 时间：2013-01-31T22:28:40.987
> 
> 标签：c++, samsung-smart-tv

是否有一个简单的方法来为三星智能电视编写 C++ 应用程序，该应用程序应该能够在后台运行（而不是 HTML/JS 小程序）并访问插入电视的 /dev/ttyUSBx 设备？

他们是否有一些 API 可以访问 /dev/ttyUSBx 或者它将是一个简单的 Linux 应用程序？他们是否允许加载此类应用程序？是否有编译此类应用程序的工具链？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:38:23.490

至少根据三星的说法，“不”。

> > > 问：SDK 中是否支持 C++？
> > > 
> > > A: 不，三星平台仅支持基于 Web 技术的应用程序（JS、CSS、HTML、FLASH）

[http://www.samsungdforum.com/Support/FAQList?page=1&faqCateID=2](http://www.samsungdforum.com/Support/FAQList?page=1&faqCateID=2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-29T09:02:51.593

在 SDK 4.5 中将包含 Native Client 技术，NaCl，目前支持的语言有 C 和 C++。欲了解更多信息： http: [//www.samsungdforum.com/Guide/d17/index.html](http://www.samsungdforum.com/Guide/d17/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T10:32:26.463

对于三星智能电视，您不能使用 C++，唯一允许的语言/技术是 HTML/JavaScript/CSS 和 Flash（使用不多）。

大多数应用程序都是基于 JavaScript 的。

也许你可以与三星达成一些独家协议，因为例如 Skype 很可能不是用 JavaScript 开发的，而且我听说的 AngryBirds 也是 C++。

BR

不锈钢

# hive - Hive 根据条件组合列值

> ID：14636313
> 
> 赞同：0
> 
> 时间：2013-01-31T22:28:40.620
> 
> 标签：hive

我想知道是否可以根据条件组合列值。让我解释...

假设我的数据看起来像这样

```
Id name offset
1 Jan 100
2 Janssen 104
3 Klaas 150
4 Jan 160
5 Janssen 164 
```

我的输出应该是这个

```
Id fullname offsets
1 Jan Janssen [ 100, 160 ] 
```

我想组合两行的名称值，其中两行的偏移量不再相隔 1 个字符。

我的问题是这种类型的数据操作是否可行，是否有人可以分享一些代码和解释？

请温柔一点，但这一小段代码会返回一些我想要的东西......

```
 ArrayList<String> persons = new ArrayList<String>();

    // write your code here
    String _previous = "";

    //Sample output form entities.txt
    //USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Berkowitz,PERSON,9,10660
    //USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Marottoli,PERSON,9,10685
    File file = new File("entities.txt");

    try {
        //
        // Create a new Scanner object which will read the data
        // from the file passed in. To check if there are more
        // line to read from it we check by calling the
        // scanner.hasNextLine() method. We then read line one
        // by one till all line is read.
        //
        Scanner scanner = new Scanner(file);
        while (scanner.hasNextLine()) {

            if(_previous == "" || _previous == null)
                _previous = scanner.nextLine();

            String _current = scanner.nextLine();
            //Compare the lines, if there offset is = 1
            int x = Integer.parseInt(_previous.split(",")[3]) + Integer.parseInt(_previous.split(",")[4]);
            int y = Integer.parseInt(_current.split(",")[4]);
            if(y-x == 1){
                persons.add(_previous.split(",")[1] + " " + _current.split(",")[1]);
                if(scanner.hasNextLine()){
                    _current = scanner.nextLine();
                }
            }else{
                persons.add(_previous.split(",")[1]);
            }
            _previous = _current;
        }
    } catch (Exception e) {
        e.printStackTrace();
    }

    for(String person : persons){
        System.out.println(person);
    } 
```

这块样本数据的工作

```
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Richard,PERSON,7,2732
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Marottoli,PERSON,9,2740
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Marottoli,PERSON,9,2756
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Marottoli,PERSON,9,3093
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Marottoli,PERSON,9,3195
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Berkowitz,PERSON,9,3220
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Berkowitz,PERSON,9,10660
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Marottoli,PERSON,9,10685
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Lea,PERSON,3,10858
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Lea,PERSON,3,11063
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Ken,PERSON,3,11186
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Marottoli,PERSON,9,11234
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Berkowitz,PERSON,9,17073
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Lea,PERSON,3,17095
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Stephanie,PERSON,9,17330
USER.A-GovDocs-f83c6ca3-9585-4c66-b9b0-f4c3bd57ccf4,Putt,PERSON,4,17340 
```

产生这个输出

```
Richard Marottoli
Marottoli
Marottoli
Marottoli
Berkowitz
Berkowitz
Marottoli
Lea
Lea
Ken
Marottoli
Berkowitz
Lea
Stephanie Putt 
```

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-01T22:22:08.590

使用下面的创建表加载表

```
drop table if exists default.stack;
create external table default.stack
(junk string,
  name string,
 cat string,
 len int,
 off int
 )
 ROW FORMAT DELIMITED
 FIELDS terminated  by ','
 STORED AS INPUTFORMAT                                                  
  'org.apache.hadoop.mapred.TextInputFormat'                           
OUTPUTFORMAT                                                           
  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' 
 location 'hdfs://nameservice1/....'; 
```

使用下面的查询来获得您想要的输出。

```
select max(name), off from (
select CASE when b.name is not null then
            concat(b.name," ",a.name)
            else
            a.name
       end as name
       ,Case WHEN b.off1 is not null
             then b.off1
             else a.off
        end as off
from default.stack a
left outer join (select name 
                       ,len+off+ 1 as off
                       ,off as off1
                 from default.stack) b
on a.off = b.off ) a
group by off
order by off; 
```

我已经对此进行了测试，它会产生您想要的结果。

# matlab - matlab 中的 cvpartition 类.. c= cvpartition(n,kfold,k)。n 在这里指定了什么？

> ID：14636319
> 
> 赞同：0
> 
> 时间：2013-01-31T22:29:16.983
> 
> 标签：matlab, data-analysis, statistics

我实际上是在尝试加载一个包含 1261 行的 csv 文件并在 matlab 中使用 cvpartition 类，这样我就可以收集 7 个模型的训练和测试集（使用 k='7'-fold 交叉验证）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T11:17:01.070

`n`是您希望划分为训练集和测试集或折叠以进行交叉验证的观察数。所以在你的情况下`n`是1261。

# python - Python上的卡片匹配游戏

> ID：14636320
> 
> 赞同：1
> 
> 时间：2013-01-31T22:29:29.653
> 
> 标签：python, list, python-3.x

我目前正在用 python 构建一个简单的纸牌匹配游戏，有一个 5x4（行*列）网格，其中两个玩家尝试匹配一副 20 张牌（2,10 只花色红心）* 2。

我遇到的问题是遍历卡片组，以网格方式打印卡片，所以它看起来像这样：

```
-----     -----    -----     -----
-   -     -   -    -   -     -   -
 4-H       6-H      7-H       8-H
-   -     -   -    -   -     -   - 
-----     -----    -----     ----- 
```

我目前拥有的代码如下：

```
#needed import for shuffle function
from random import shuffle

#class for my deck
class Deck:
    #constructor starts off with no cards
    def __init__( self ):
        self._deck = []

    #populate the deck with every combination of suits and values    
    def Populate( self ):
        #Heart, Diamond, Spades, Clubs
        for suit in 'HDSC':
            #Jack = 11, Queen = 12, King = 13, Ace = 14
            for value in range(2, 15):
                if value == 11:
                    value = 'J'
                elif value == 12:
                    value = 'Q'
                elif value == 13:
                    value = 'K'
                elif value == 14:
                    value = 'A'
                #add to deck list
                self._deck.append(str(value) + '-' + suit)

    #populate the deck with only hears hearts and all cards except face cards and aces (2, 3, 4, 5, 6, 7, 8, 9, 10) twice
    def gamePop( self ):
        suit = 'H'
        for x in range(2):
            for value in range(2, 11):
                self._deck.append(str(value) + '-' + suit)

    #shuffle the deck with the random import             
    def Shuffle( self ):
        shuffle( self._deck )

    #length of the deck
    def len( self ):
        return len( self._deck )

    def stringIt( self ): 
        #Returns the string representation of a deck
        result = ''
        for c in self._deck:
            result = result + str(c) + '\n'
        return result

#class for a single card
class Card:
    #constructor for what type of card it is
    def __init__( self, value, suit ):
        self._value = value
        self._suit = suit
        self._card = self._value + self._suit

    #print the type of card    
    def Description( self ):
        return ( self._card )

    #overloaded ==
    def __eq__( self, another ):
        if ( self._card == another.Description() ):
            return True
        else:
            return False
#main function which plays the game
def main():

    #sets player counters to zero,
    pOneCount = 0
    pTwoCount = 0

    #creates the deck to be put on the board
    gameDeck = Deck()
    gameDeck.gamePop()
    gameDeck.Shuffle()

    print(gameDeck._deck)
    currentCard = 0
    for row in range(5):
        for card in range(0,4+i):
            mystring = 
        print ('-------  ' * 4)
        print ('|     |  ' * 4)
        for x in range(4):
            print ('|  ' +gameDeck._deck[currentCard]+'|'),
            currentCard += 1
        print ('|     |  ' * 4)
        print ('-------  ' * 4) 
```

编辑：我清除了我尝试过的代码。

当前的输出是这样的：

```
-------  -------  -------  -------  
|     |  |     |  |     |  |     |  
|  7-H|
|  5-H|
|  7-H|
|  9-H|
|     |  |     |  |     |  |     |  
-------  -------  -------  ------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:29:13.327

问题出在 def main() 中：

定义主（）：

```
 print ('-------  ' * 4)
    print ('|     |  ' * 4)
    for x in range(4):
        print ('|  ' +gameDeck._deck[currentCard]+'|'),
        currentCard += 1
    print ('|     |  ' * 4)
    print ('-------  ' * 4) 
```

* 4 只是意味着：

```
print ('-------  ' * 4) 
```

会变成这样：

```
print ('-------  ' + '-------  ' + '-------  ' + '-------  ' ) 
```

它也可以输入为：

```
print ('-------  -------  -------  -------  ' ) 
```

所以。你的问题在这里：

```
 for x in range(4):
        print ('|  ' +gameDeck._deck[currentCard]+'|'),
        currentCard += 1 
```

这将打印为：

```
|  7-H|
|  5-H|
|  7-H|
|  9-H| 
```

你需要把它写成这样：

```
 print ('|  ' +gameDeck._deck[currentCard]+'|'+'|  ' +gameDeck._deck[currentCard+1]+'|'+'|  ' +gameDeck._deck[currentCard+2]+'|'+'|  ' +gameDeck._deck[currentCard+3]+'|') 
```

所以它会像你想要的那样打印在一行中：

```
 |  7-H|  |  5-H|  |  7-H|  |  9-H| 
```

这是我清理一下的代码。如果它可以正常工作，它应该可以工作：

```
def main():

    #sets player counters to zero,
    pOneCount = 0
    pTwoCount = 0

    #creates the deck to be put on the board
    gameDeck = Deck()
    gameDeck.gamePop()
    gameDeck.Shuffle()

    print(gameDeck._deck)
    currentCard = 0
    for row in range(5):
        for card in range(0,4+i): 
        print (' ------- ' * 4)
        print (' |     | ' * 4)
        print (' | ' +gameDeck._deck[currentCard]+' | '+' | ' +gameDeck._deck[currentCard+1]+' | '+' | ' +gameDeck._deck[currentCard+2]+' | '+' | ' +gameDeck._deck[currentCard+3]+' | ')
        print (' |     | ' * 4)
        print (' ------- ' * 4) 
```

哦，就像约翰 Y 说的（复制和粘贴）：

主函数有一个悬空的 mystring =，这是一个明显的语法错误

这是我用来测试的，因为整个代码对我不起作用，我只是测试了打印部分：

```
print (' ------- ' * 4)
print (' |     | ' * 4)
print (' | ' +"1-H"+' | '+' | ' +"2-H"+' | '+' | ' +"3-H"+' | '+' | ' +"4-H"+' |  ')
print (' |     | ' * 4)
print (' ------- ' * 4) 
```

这让我：

```
 -------  -------  -------  ------- 
 |     |  |     |  |     |  |     | 
 | 1-H |  | 2-H |  | 3-H |  | 4-H |  
 |     |  |     |  |     |  |     | 
 -------  -------  -------  ------- 
>>> 
```

# c# - Visual Studio Datepicker 和 Timepicker WP7

> ID：14636328
> 
> 赞同：0
> 
> 时间：2013-01-31T22:29:50.370
> 
> 标签：c#, visual-studio-2010, windows-phone-7, user-controls

你们中的大多数人可能已经遇到过这种情况，但是在我的 Datepicker Control 和 Timepicker Control 中，符号只是标记为 X（无符号）。

我只习惯于在应用程序栏的 xaml 页面上正常设置符号。虽然 Datepicker 和 Timepicker 符号会在您单击它们时显示。我的问题是：我如何编码控件并设置适当的符号，因为我没有这方面的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T11:10:17.670

您应该在项目中包含带有图像的 Toolkit.Content 文件夹，并将图标的构建操作指定为内容

[http://www.windowsphonegeek.com/articles/wp7-datepicker-and-timepicker-in-depth--api-and-customization](http://www.windowsphonegeek.com/articles/wp7-datepicker-and-timepicker-in-depth--api-and-customization)

![在此处输入图像描述](../Images/0e9b377abbfde7cc21232c580f5e14c4.png)

# rest - 结合 REST 请求和回复的约定？

> ID：14636332
> 
> 赞同：19
> 
> 时间：2013-01-31T22:30:01.140
> 
> 标签：rest

对于复杂的 Web 应用程序，一个页面视图可能需要许多不同类型的数据。如果您正在执行客户端模板化并从 RESTful Web 服务中提取此数据，您可能需要发出大量请求来填充页面。是否有任何约定可以组合 REST 请求，以接收包含所有所需响应的单个有效负载？

以 Stack Exchange 用户页面为例，您可能需要至少从[Stack Exchange API](http://api.stackoverflow.com/1.0/usage)调用这些来构建页面：

*   /用户/{id}
*   /users/{id}/answers
*   /users/{id}/声誉
*   /users/{id}/tags
*   /users/{id}/问题
*   ...ETC

此类 API 的提供者能否允许您通过单个请求获取所有数据？ *特别是*如果涉及其他根类型，假设您还必须请求 /revisions/{id} 和 /tags 来构建页面也出于某种原因。

需要明确的是，我不想知道是否*可以*在 Web API 中提供这样的功能——我想知道是否有标准的或至少记录在案的方法来这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-07T10:55:27.703

我认为我们需要一些标准的方式来做到这一点，但在那之前，你可能只能靠自己了。

过去，当我想做跨多个资源的交易时，我也遇到过类似的挑战。我发明了新的资源，更清楚地描述了我将要进行的操作（从账户 A 中减去 5 并在账户 B 中添加 5 成为与 from 和 to 成员的交易）。

也许可以通过使用另一个 REST 调用作为容器来应用类似（但更通用）的方法；

```
POST /batchRequests { requests: [
    { method: 'POST', url: '/resource', payload: { ... } }
], transactional: false } 
```

这反过来又返回了一个包含结果的“BatchRequest”对象。这与 Facebook 所做的非常接近。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:51:19.557

我认为这可能违反 REST 原则，不是吗？即每个对象表示的唯一 URI 及其有效负载。这不会让事情变得更糟吗？鉴于它不是 TI 计算器，而是一台能够并行 HTTP 请求的现代计算机，而一台计算机则需要尽可能长的时间。

不要认为有一个标准，但这里有一个例子[——https://developers.facebook.com/docs/reference/api/batch/](https://developers.facebook.com/docs/reference/api/batch/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-06T14:56:10.640

我知道我很晚了，但也许我的想法可以帮助别人......

我的解决方案有点不同。

我将资源存储在每个资源的单个 uri（统一资源标识符）中。

**用户**

```
GET /user => INDEX
PUT /user => CREATE (RETURN LOCATION HEADER)
GET /user/{id} => FIND
POST /user/{id} => UPDATE
DELETE /user/{id} => REMOVE 
```

**留言**

```
GET /user/{id}/message => INDEX
PUT /user/{id}/message => CREATE (RETURN LOCATION HEADER)
GET /user/{id}/message => FIND
POST /user/{id}/message/{id} => UPDATE
DELETE /user/{id}/message/{id} => REMOVE 
```

**朋友们**

```
GET /user/{id}/friend => INDEX
PUT /user/{id}/friend => CREATE (RETURN LOCATION HEADER)
GET /user/{id}/friend => FIND
POST /user/{id}/friend/{id} => UPDATE
DELETE /user/{id}/friend/{id} => REMOVE 
```

生成的内容类型可以通过客户端需要指定的**HTTP-Header进行更改。**

```
Accept: "application/vnd.com.example.api+json; version: 1.0;" 
```

当前是**Accept HTTP-Header**字段，它告诉服务器要使用哪个版本和哪个内容类型。

为了保持浏览器或代理缓存功能，我决定在我的 api 上返回**Vary HTTP Header字段，其中所有内容都在****更改**HTTP-Headers，以便浏览器可以通过**uri 和 headers**正确区分资源。

```
Vary: "Accept, Accept-Language" 
```

最大的问题是，如何组合资源以防止客户端一次打开过多的 tcp 连接。

例如：如果您通过**/user**从我的 API 查询用户列表，API 将返回所需内容类型（JSON、XML、HTML）的用户对象数组。

*我不会详细介绍，因为有可用的分页和过滤器/搜索支持。*

每个用户对象都具有依赖资源，例如**朋友**和/或**消息**。

有一个非常好的结构化标准，称为**HAL**（超文本应用程序语言），它提供了一些简单的方法来将资源与其*相关资源*或*链接资源*结合起来。它使用 JSON 来表示数据。

看看**Mike Kelly**的[http://stateless.co/hal_specification.html](http://stateless.co/hal_specification.html)。

 **但是该解决方案也不会在一次调用中组合资源，它只是将依赖或链接资源的 uri 与有效负载一起发送到客户端。

这将让客户决定显示哪些附加信息。

当然，所有非常重要的缓存功能都在工作。

大多数流量，在浏览资源时，将是可以很容易缓存的重复请求。

如果您给出的示例想要在用户列表中显示用户的朋友数或消息数，请考虑将依赖资源添加为结果的键。

**示例用户响应 (JSON)**

```
{
     id: 1,
     email: test@test.com,
     ...
     friends: {
         count: 1,
         _links: [{
             'id': '2',
             'name': 'Peter Parker',
             'uri': '//api.example.com/user/2'
         }]
     },
     messages: {
         count: 1,
         _links: [{
             'id': 'x4gZ6',
             'subject': 'Testmessage',
             'uri': '//api.example.com/user/1/message/x4gZ6'
         }]
     },
     ...
} 
```

现在我们来谈谈如何防止使用多个 TCP 连接！

有一个非常简单和好的方法......

为什么不使用：

```
 Connection: "keep-alive" 
```

这将使客户端能够根据需要一次查询尽可能多的资源。虽然所有资源都通过与服务器的单个 TCP 连接进行查询。

**我知道保持活动连接还有其他问题，因此请随时与我讨论所有想法。**

谢谢！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-16T17:20:27.677

我参加这个聚会很晚了，但我一直在网上寻找一些关于平衡干净的 REST 设计与实际网站的现实的话题。我发现了通常的“减少对性能的 http 请求”，但没有关于良好实践的好文章，着眼于权衡。（评论者可以随意给我指出一个方向！）什么鬼，还没有明显的答案。

不确定您是在问*其他人*是否有可能通过这样做让您的生活更轻松，或者您是否因为您正在设计 API 而问。你的问题说其他人所以我们开始吧。

> 此类 API 的提供者能否允许您通过单个请求获取所有数据？特别是如果涉及其他根类型，假设您还必须请求 /revisions/{id} 和 /tags 来构建页面也出于某种原因。
> 
> 需要明确的是，我不想知道是否可以在 Web API 中提供这样的功能——我想知道是否有标准的或至少记录在案的方法来这样做。

简短版：我还没有看到很多关于这个主题的好文章。REST 的流行可能还很年轻，因为它有一套好的学术共识风格的答案。在我可以摆脱它的地方，我会做我必须做的事情，并且我不太担心我的设计是多么纯粹：像 REST 这样的首字母缩略词。但是，如果我是大型公共 API 的提供者（见下文），我可能会偏向更纯粹的标准（再次，例如 REST）实现。

这是可能的，而且我已经在我自己的应用程序中玷污了许多纯 REST 设计，以实现我在性能方面所需要的。主要是 RPC 或组合资源获取/更新，以最大限度地减少 HTTP 请求的数量，成为现代科学怪人 Web 开发人员可能产生的东西。

> 此类 API 的提供者能否允许您通过单个请求获取所有数据？

从技术上讲，他/她当然可以做到这一点。但如果我是一个流行的、面向公众的 API 的发布者，我可能会使用更“纯”的 REST 方法，因为如果有很多陌生人会使用它，那么简单性、可用性和维护现在就具有全新的意义。在这种情况下，对于我和消费者而言，性能的优先级可能低于我既是消费者又是提供者的企业应用程序。

像往常一样，开发人员必须在实现速度、简洁设计、可维护性、性能和无数其他事情之间做出适当的平衡。（这个决定已经从选择语言开始——Python/Ruby vs Java/C# vs C++ vs...）**

# javascript - 我的 JSPerf 测试用例在使用回调评估 toggle() 时“中断”

> ID：14636333
> 
> 赞同：0
> 
> 时间：2013-01-31T22:30:02.380
> 
> 标签：javascript, jsperf

在测试[我对](https://stackoverflow.com/a/14636007/1430996)[向 jQuery .toggle() 方法添加 HTML5 隐藏属性支持的](https://stackoverflow.com/questions/14635847/adding-html5-hidden-attribute-support-to-jquery-toggle-method)答案时，我创建了一个 JSPerf 测试来确定与 .toggle() 方法[相比](http://jsperf.com/hidden-premium)[要慢多少`.toggle(function() \[...\])``.toggle()`](http://jsperf.com/hidden-premium)。令我惊讶的是，据报道，带有额外处理的脚本执行得更快！除了结果违反直觉之外，我怀疑是一个问题，因为在结果返回很久之后，我还看到屏幕上的切换。

**如何“修复”我的测试以获得准确的结果？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T09:14:40.703

IE

```
$('button').click(function() {
    $('#myElement').toggle(function() { alert("called") })
}) 
```

您传递给的回调函数仅在切换操作完成*后*`toggle`才会执行。换句话说，它是一个异步操作，因此如果您想测量触发回调需要多长时间，请[使用 jsPerf 的 async/defer 功能](http://jsperf.com/faq#async)。

# c# - 将 ListView SubItem 转换为 int

> ID：14636335
> 
> 赞同：1
> 
> 时间：2013-01-31T22:30:10.647
> 
> 标签：c#, listview

目前，我的程序将数据加载到内存中，并将整数添加到列表视图中。我正在尝试获取所选列表视图项的值，尽管当我使用：

```
int offset = Convert.ToInt64(listView1.SelectedItems[0].SubItems[2].ToString()); 
```

我在尝试使用它时遇到了一个奇怪的异常。例如，我试图发送一个带有 int 值的 MessageBox（使用 .ToString()），它会引发一些奇怪的异常。

另外我想指出 SelectedItems[0] 仅在抓取字符串时有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:31:27.003

### 哎呀，你忘了`SubItems[2].Text`

* * *

您需要使用该`ListViewSubItem.Text`属性

```
Int64 offset = Int64.Parse(listView1.SelectedItems[0].SubItems[2].Text);
Int64 offset = Convert.ToInt64(listView1.SelectedItems[0].SubItems[2].Text); 
```

* * *

`listView1.SelectedItems[0].SubItems[2].ToString()`会返回类似“ `ListViewSubItem: {the_subitem_text}`”的东西

`listView1.SelectedItems[0].SubItems[2].ToString()`默认返回`Object.ToString()`

# php - 使用模式对话框的 jquery 和 php 更新

> ID：14636338
> 
> 赞同：1
> 
> 时间：2013-01-31T22:30:24.697
> 
> 标签：php, jquery, modal-dialog

我正在尝试使用模式窗口根据文章 id 显示带有特定信息的 html 表单，但我正在努力将值/id 传递给我的自定义 php 函数。所以，这里是 html/php 部分

```
 while(...) :
       <a href="#" id="$row['id']" class="button">Edit</a>
    endwhile; 
```

现在js，

```
 $("a.button").on("click", function() {
        $("#modal").reveal();
        return false;
    }); 
```

html和php函数

```
 <div id="modal">
        <?php echo showForm($needThisIDbasedOnClick); ?>
    </div> 
```

希望这一切对你有意义，我正在努力获取某个 id 并传递给 php 函数

我尝试删除`return false;`和跟随 href 属性`<a href="?id=17"> ...`，而不是使用 $_GET['id'] 获取值，`showForm($_GET['id'])`但这个解决方案不能按照我想要的方式工作，它会重新加载页面......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T05:11:43.433

带有 PHP 代码的页面在服务器端执行。PHP 被解释，然后内容被发送到您的浏览器。收到数据后，您的 JS 代码在客户端执行（感谢您的浏览器的 JS 机器）。

如果您想在不重新加载任何内容的情况下显示信息，您有两种解决方案：

*   在PHP处理期间将所有信息嵌入页面并保持隐藏，用JS代码显示好的取决于点击的链接。**（糟糕的解决方案）**

*   使用带有参数 ID 的 AJAX 请求，该请求将调用返回指定行信息的新的简短 PHP 脚本。

如果我恢复该过程可能是：

**1)**第一个请求在您的主脚本**main.php上**

**2）**页面显示您的所有项目（仅嵌入ID）并包含信息容器（隐藏且为空）

例子

```
<!-- Your list of link with article ID -->
<div>
    <a class="articleLink" id="123" href="#">View</a>
    <a class="articleLink" id="124" href="#">View</a>
    <a class="articleLink" id="125" href="#">View</a>
</div>

<!-- The bloc that will contain info and will be shown in a popup later (hidden) -->
<div id="divInfo">
    <input type="text" name="name" value=""/>
    <input type="text" name="description" value=""/>
</div>

<script>

    $(document).ready(function() {

        // add listener to all link
        $(".articleLink").click(function(mouseEvent) {

            // Retrieve the article ID                
            var myId = $(this).attr('id');

            // Ajax call with the id of the link
            // onSuccess, fill the divInfo and show it
            $.ajax('getInfo.php', {
                dataType: 'json',
                type: 'POST',
                data: {
                    articleId: myId
                },
                success: function(data, status, xhrObj) {

                    // The data is received, update the info container
                    $("#divInfo input[name=name]").val(data.name);
                    $("#divInfo input[name=description]").val(data.desc);

                    // Show the div in a popup
                    //...
                }
            });

            return false;
        });
    });

</script> 
```

**3）**您单击一个链接，它将运行对第二个 PHP 脚本的 ajax 调用：**getInfo.php**，并给出指定的 ID

**4)**脚本在您的数据库中检索数据并最终返回信息（例如 JSON 格式）

假设您的 PHP getInfo.php**将**返回**JSON**

```
{"name":"an article name","description":"the article description"} 
```

注意：您可以使用函数在 PHP 中从数组轻松生成 JSON

```
json_encode() 
```

**5)**收到数据时调用 Ajax 调用的 onSuccess 方法，您可以使用数据填写表单（这是唯一的并且已经存在于页面中 - 并且是隐藏的）。

祝你好运

# javascript - 在数组元素上用 RegExp 替换（）

> ID：14636340
> 
> 赞同：0
> 
> 时间：2013-01-31T22:30:33.213
> 
> 标签：javascript, regex, replace

我想编写一个 JavaScript 函数，将一些简单的 BBcode 标签（如 [red] [/red]）转换为 Html-Tags。我认为 replace() 函数是最好的方法。我写了一个简单的 testfunction 来尝试一下，但它似乎不起作用。

```
/**
* @function
* @description Replaces the bb-tags with html-tags
*/
function bbToHtml(form) {
    debugger

    var text = form.text.value;
    bbTags = new Array("[red]", "[yellow]", "[green]", "[/red]", "[/yellow]", "[/green]");
    htmlTags = new Array("<font color='red'>", "<font color='yellow'>", "<font color='green'>", "</font>", "<font>", "</font>");

    for (var i = 0; i < bbTags.length; i++) {
        var re = new RegExp(bbTags[i], "g");
        text = text.replace(re, htmlTags[i]);
    }

    alert(text);
} 
```

它应该转换`"[red]hello[/red]"`为`"<font color='red'>hello</font>"`，但它只是给了我一个奇怪的字符串。

怎么了？我认为这与我的正则表达式有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:32:23.100

`[`并且`]`在正则表达式中具有特殊含义并且需要转义，而且您不需要像编写代码那样的正则表达式并且可以这样做：

```
function bbToHtml(form) {
    debugger

    var text = form.text.value;
    bbTags = new Array("[red]", "[yellow]", "[green]", "[/red]", "[/yellow]", "[/green]");
    htmlTags = new Array("<font color='red'>", "<font color='yellow'>", "<font color='green'>", "</font>", "<font>", "</font>");

    for (var i = 0; i < bbTags.length; i++) {
        while(text.indexOf(bbTags[i])!==-1){
            text = text.replace(bbTags[i], htmlTags[i]);
        }
    }

    alert(text);
} 
```

只是让您知道，您可以使用数组文字而不是数组。`new Array(comma seperated values)`与`[comma seperated values]`javascript中的相同。此外，在您的情况下，您可以像使用地图一样使用数组，例如：

```
var bbTagsToHTML = {}
bbTagsToHtml["[red]"] = "<font color='red'>" 
```

并遍历它。

如果您希望也可以转义正则表达式，请参阅[如何在正则表达式中使用变量？](https://stackoverflow.com/questions/494035/how-do-you-pass-a-variable-to-a-regular-expression-javascript/494122#494122)对于执行此操作的功能。

您也可以手动执行此操作。`"[red]"`变成`"\[red\]"`（括号转义）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:34:34.317

只需更改此行

```
text = text.replace(re, htmlTags[i]); 
```

进入

```
text = text.replace(bbTags[i], htmlTags[i]); 
```

删除无用的代码。

`replace`也适用于“正常”（不是正则表达式）值作为参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:41:02.463

如果你想用正则表达式来做，你可以简化*很多*。没有数组或循环：

```
var str = '[red]foo[/red] hello world [blue]hey[/blue]',
    re = /\[(\w+)\](.*)\[\/\1\]/g;

str = str.replace(re, '<font color="$1">$2</font>');

console.log(str);
//^ <font color="red">foo</font> hello world <font color="blue">hey</font> 
```

另外，作为旁注，`font`很少使用了，我建议您将 a`span`与类一起使用。

# tcp - TCP/IP 块的代码生成

> ID：14636343
> 
> 赞同：0
> 
> 时间：2013-01-31T22:30:46.357
> 
> 标签：tcp, simulink, tcp-ip

我正在使用 Simulink 来模拟打开/关闭硬件板上的 LED。我正在使用仪器控制工具箱提供的 TCP/IP 模块在 Simulink 模块和电路板之间进行数据通信。所以我的 Simulink 模型是客户端。我想生成模型的 C 代码，但生成的代码不包含 TCP/IP 块。你们有什么想法为什么我会遇到这个问题？你知道如何实现我自己的可能生成为 c 代码的 TCP/IP 块吗？感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T11:11:48.580

我假设 rtw 文件是在您的情况下创建的，并且您使用的是 Simulink Coder 或 Real Time Workshop。

要从特定块（作为您的 TCP/IP 块）创建 C 代码，您需要一个特定于块的 tlc 文件。TLC = 目标语言编译器

取自 TLC 文档： http: [//www.mathworks.com/help/pdf_doc/rtw/rtw_tlc.pdf](http://www.mathworks.com/help/pdf_doc/rtw/rtw_tlc.pdf)

> Real-Time Workshop 在将 Simulink 模型编译为适合生成代码的中间形式 (model.rtw) 后调用 TLC。为了适当地生成代码，TLC 使用其函数库来转换
> 
> 两类目标文件：
> 
> •系统目标文件
> 
> •阻止目标文件

我猜 Tcp/Ip - Block 的块目标文件丢失了。

如果你没有它或得到你必须在 TLC 中实现 tcp/ip 功能。

（请多多包涵，我还没有评论的权限）

# python - 切换装饰器

> ID：14636350
> 
> 赞同：12
> 
> 时间：2013-01-31T22:31:17.043
> 
> 标签：python, decorator

打开和关闭装饰器的最佳方法是什么，而不是实际去每个装饰并评论它？假设你有一个基准装饰器：

```
# deco.py
def benchmark(func):
  def decorator():
    # fancy benchmarking 
  return decorator 
```

在你的模块中是这样的：

```
# mymodule.py
from deco import benchmark

class foo(object):
  @benchmark
  def f():
    # code

  @benchmark
  def g():
    # more code 
```

这很好，但有时你不关心基准并且不想要开销。我一直在做以下事情。添加另一个装饰器：

```
# anothermodule.py
def noop(func):
  # do nothing, just return the original function
  return func 
```

然后注释掉导入行并添加另一个：

```
# mymodule.py
#from deco import benchmark 
from anothermodule import noop as benchmark 
```

现在基准测试是在每个文件的基础上切换的，只需更改相关模块中的导入语句。单个装饰器可以独立控制。

有一个更好的方法吗？最好根本不必编辑源文件，并指定在其他地方的哪些文件中使用哪些装饰器。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T22:33:49.403

您可以将条件添加到装饰器本身：

```
def benchmark(func):
    if not <config.use_benchmark>:
        return func
    def decorator():
    # fancy benchmarking 
    return decorator 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-22T04:25:31.683

我一直在使用以下方法。它与 CaptainMurphy 建议的几乎相同，但它的优点是您不需要像调用函数一样调用装饰器。

```
import functools

class SwitchedDecorator:
    def __init__(self, enabled_func):
        self._enabled = False
        self._enabled_func = enabled_func

    @property
    def enabled(self):
        return self._enabled

    @enabled.setter
    def enabled(self, new_value):
        if not isinstance(new_value, bool):
            raise ValueError("enabled can only be set to a boolean value")
        self._enabled = new_value

    def __call__(self, target):
        if self._enabled:
            return self._enabled_func(target)
        return target

def deco_func(target):
    """This is the actual decorator function.  It's written just like any other decorator."""
    def g(*args,**kwargs):
        print("your function has been wrapped")
        return target(*args,**kwargs)
    functools.update_wrapper(g, target)
    return g

# This is where we wrap our decorator in the SwitchedDecorator class.
my_decorator = SwitchedDecorator(deco_func)

# Now my_decorator functions just like the deco_func decorator,
# EXCEPT that we can turn it on and off.
my_decorator.enabled=True

@my_decorator
def example1():
    print("example1 function")

# we'll now disable my_decorator.  Any subsequent uses will not
# actually decorate the target function.
my_decorator.enabled=False
@my_decorator
def example2():
    print("example2 function") 
```

在上面，example1 将被装饰，而 example2 将不会被装饰。当我必须按模块启用或禁用装饰器时，我只有一个函数，可以在我需要不同副本时创建一个新的 SwitchedDecorator。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-27T20:47:12.687

我认为你应该使用装饰器 a 来装饰装饰器 b，它可以让你在决策函数的帮助下打开或关闭装饰器 b。

这听起来很复杂，但想法相当简单。

所以假设你有一个装饰器记录器：

```
from functools import wraps 
def logger(f):
    @wraps(f)
    def innerdecorator(*args, **kwargs):
        print (args, kwargs)
        res = f(*args, **kwargs)
        print res
        return res
    return innerdecorator 
```

这是一个非常无聊的装饰器，我有十几个这样的，缓存器，记录器，注入东西的东西，基准测试等。我可以用 if 语句轻松扩展它，但这似乎是一个糟糕的选择；因为那我得换十几个装饰器，一点都不好玩。

那么该怎么办？让我们更上一层楼。假设我们有一个装饰器，它可以装饰一个装饰器？这个装饰器看起来像这样：

```
@point_cut_decorator(logger)
def my_oddly_behaving_function 
```

这个装饰器接受记录器，这不是一个很有趣的事实。但它也有足够的权力来选择是否应该将记录器应用于 my_oddly_behave_function。我称它为 point_cut_decorator，因为它具有面向方面编程的某些方面。切入点是一组位置，其中一些代码（建议）必须与执行流程交织在一起。切点的定义通常在一个地方。这种技术似乎非常相似。

我们如何实现它的决策逻辑。好吧，我选择创建一个函数，它接受被装饰者、装饰者、**文件**和**名称**，它只能说明是否应该应用装饰器。这些是坐标，足以非常精确地确定位置。

这是 point_cut_decorator 的实现，我选择将决策函数实现为一个简单的函数，你可以扩展它以让它从你的设置或配置中决定，如果你对所有 4 个坐标使用正则表达式，你最终会得到一些非常强大的：

```
from functools import wraps 
```

myselector 是决策函数，在 true 上应用装饰器，在 false 上不应用。参数是文件名、模块名、装饰对象，最后是装饰器。这使我们能够以细粒度的方式切换行为。

```
def myselector(fname, name, decoratee, decorator):
    print fname

    if decoratee.__name__ == "test" and fname == "decorated.py" and decorator.__name__ == "logger":
        return True
    return False 
```

这装饰了一个函数，检查 myselector，如果 myselector 说继续，它会将装饰器应用于函数。

```
def point_cut_decorator(d):
    def innerdecorator(f):
        @wraps(f)
        def wrapper(*args, **kwargs):
            if myselector(__file__, __name__, f, d):
                ps = d(f)
                return ps(*args, **kwargs)
            else:
                return f(*args, **kwargs)
        return wrapper
    return innerdecorator

def logger(f):
    @wraps(f)
    def innerdecorator(*args, **kwargs):
        print (args, kwargs)
        res = f(*args, **kwargs)
        print res
        return res
    return innerdecorator 
```

这就是你使用它的方式：

```
@point_cut_decorator(logger)
def test(a):
    print "hello"
    return "world"

test(1) 
```

**编辑：**

这是我谈到的正则表达式方法：

```
from functools import wraps
import re 
```

如您所见，我可以在某处指定一些规则，这些规则决定是否应用装饰器：

```
rules = [{
    "file": "decorated.py",
    "module": ".*",
    "decoratee": ".*test.*",
    "decorator": "logger"
}] 
```

然后我遍历所有规则，如果规则匹配则返回 True，如果规则不匹配则返回 false。通过在生产中使规则为空，这不会使您的应用程序减慢太多：

```
def myselector(fname, name, decoratee, decorator):
    for rule in rules:
        file_rule, module_rule, decoratee_rule, decorator_rule = rule["file"], rule["module"], rule["decoratee"], rule["decorator"]
        if (
            re.match(file_rule, fname)
            and re.match(module_rule, name)
            and re.match(decoratee_rule, decoratee.__name__)
            and re.match(decorator_rule, decorator.__name__)
        ):
            return True
    return False 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T19:55:41.590

这是我最终想到的每个模块切换的方法。它使用@nneonneo 的建议作为起点。

随机模块正常使用装饰器，不知道切换。

foopkg.py：

```
from toggledeco import benchmark

@benchmark
def foo():
    print("function in foopkg") 
```

barpkg.py：

```
from toggledeco import benchmark

@benchmark
def bar():
    print("function in barpkg") 
```

装饰器模块本身为所有被禁用的装饰器维护了一组函数引用，每个装饰器检查它是否存在于这个集合中。如果是这样，它只返回原始函数（没有装饰器）。默认情况下，该集为空（启用所有内容）。

切换deco.py：

```
import functools

_disabled = set()
def disable(func):
    _disabled.add(func)
def enable(func):
    _disabled.discard(func)

def benchmark(func):
    if benchmark in _disabled:
        return func
    @functools.wraps(func)
    def deco(*args,**kwargs):
        print("--> benchmarking %s(%s,%s)" % (func.__name__,args,kwargs))
        ret = func(*args,**kwargs)
        print("<-- done")
    return deco 
```

主程序可以在导入期间打开和关闭单个装饰器：

```
from toggledeco import benchmark, disable, enable

disable(benchmark) # no benchmarks...
import foopkg

enable(benchmark) # until they are enabled again
import barpkg

foopkg.foo() # no benchmarking 
barpkg.bar() # yes benchmarking

reload(foopkg)
foopkg.foo() # now with benchmarking 
```

输出：

```
function in foopkg
--> benchmarking bar((),{})
function in barpkg
<-- done
--> benchmarking foo((),{})
function in foopkg
<-- done 
```

这增加了错误/功能，启用/禁用将渗透到从主函数中导入的模块导入的任何子模块。

**编辑**：

这是@nneonneo 建议的课程。为了使用它，装饰器必须作为函数调用（`@benchmark()`, not `@benchmark`）。

```
class benchmark:
    disabled = False

    @classmethod
    def enable(cls):
        cls.disabled = False

    @classmethod
    def disable(cls):
        cls.disabled = True

    def __call__(cls,func):
        if cls.disabled:
            return func
        @functools.wraps(func)
        def deco(*args,**kwargs):
            print("--> benchmarking %s(%s,%s)" % (func.__name__,args,kwargs))
            ret = func(*args,**kwargs)
            print("<-- done")
        return deco 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-30T09:23:10.420

我认为还没有人提出这个建议：

```
benchmark_modules = set('mod1', 'mod2') # Load this from a config file

def benchmark(func):
  if not func.__module__ in benchmark_modules:
      return func

  def decorator():
    # fancy benchmarking 
  return decorator 
```

每个函数或方法都有一个`__module__`属性，该属性是定义函数的模块的名称。创建要进行基准测试的模块的白名单（或黑名单，如果您愿意），如果您不想对该模块进行基准测试，只需返回原始的未修饰函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-30T08:35:33.027

我会检查装饰器体内的配置文件。如果必须根据配置文件使用基准测试，那么我会转到您当前的装饰器主体。如果没有，我将返回该函数并且什么也不做。这种味道的东西：

```
# deco.py
def benchmark(func):
  if config == 'dontUseDecorators': # no use of decorator
      # do nothing
      return func
  def decorator(): # else call decorator
      # fancy benchmarking 
  return decorator 
```

调用装饰函数时会发生什么？`@`在

```
@benchmark
def f():
    # body comes here 
```

是这个的语法糖

```
f = benchmark(f) 
```

所以如果 config 想让你忽略装饰器，你只是在做`f = f()`你所期望的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-29T19:15:35.970

另一种直接方式：

```
# mymodule.py
from deco import benchmark

class foo(object):

  def f():
    # code

  if <config.use_benchmark>:
    f = benchmark(f)

  def g():
    # more code

  if <config.use_benchmark>:
    g = benchmark(g) 
```

# linux - 尽管缺少基于文件系统的功能，如何执行进程并保留功能？

> ID：14636359
> 
> 赞同：6
> 
> 时间：2013-01-31T22:31:29.277
> 
> 标签：linux, execve, linux-capabilities

我想让系统在没有`setuid`文件“+p”功能的情况下可用，并且通常没有在我设置[PR_SET_NO_NEW_PRIVS](http://www.outflux.net/blog/archives/2012/03/26/keeping-your-process-unprivileged/)时被禁用的东西。

使用这种方法（`init`集合`PR_SET_NO_NEW_PRIVS`和基于文件系统的能力提升不再可能）你不能“重新填充”你的能力，只需要小心不要“飞溅”它们。

如何在`execve`不“破坏”任何授予功能的情况下进行其他进程（例如，如果新程序的文件是`setcap =ei`）？只是“我相信这个新过程，就像我相信自己一样”。例如，给*用户*一个能力（并且用户想在他启动的任何程序中锻炼它）......

我可以永久制作整个文件系统`=ei`吗？我想保持文件系统不干扰方案，不能授予或撤销功能；通过父->子控制一切。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-07T22:05:13.980

如果您参考功能手册页，目前没有简单的方法可以做到这一点：

```
During an execve(2), the kernel calculates the new capabilities of the process
using the following algorithm:

P'(permitted) = (P(inheritable) & F(inheritable)) | (F(permitted) & cap_bset)

P'(effective) = F(effective) ? P'(permitted) : 0 

P'(inheritable) = P(inheritable)    [i.e., unchanged]

where:

P        denotes the value of a thread capability set before the execve(2)
P'       denotes the value of a capability set after the execve(2)
F        denotes a file capability set
cap_bset is the value of the capability bounding set 
```

如果您要执行的文件没有设置它的 fP 位，或者如果它的 fI 位没有设置，您的进程将没有被允许，因此没有有效的能力。

设置整个文件系统允许和继承位在技术上是可行的，但这没有多大意义，因为它会大大降低系统的安全性，（编辑：正如你提到的，这不适用于新的可执行文件）。

您确实可以使用 pam_cap 为用户提供一些功能，但是您不能让他们执行他们刚刚使用它编译的任何文件。功能是通过设计为程序而不是用户赋予权力的，你可以在[Hallyn 的论文](http://ols.fedoraproject.org/OLS/Reprints-2008/hallyn-reprint.pdf)中阅读：

> 一个关键的见解是观察到程序而不是人行使特权。也就是说，在计算机中所做的一切都是通过代理程序——程序——并且只有当这些程序知道如何处理特权时，它们才能被信任使用它。

另请参见定义 POSIX 功能的[POSIX 草案](http://wt.tuxomania.net/publications/posix.1e/download.html)1003.1e，第 310 页：

> 为一个流程链（单个流程中的一系列程序）建立一组在该链的整个生命周期中保持固定和活跃的能力也是不合适的。[...] 这是最小权限原则的应用，它同样适用于用户和进程。

最近（2012 年 12 月）有人要求介绍你想在[这个Linux 内核邮件列表中作为一个特性做什么，并且给出了一些非常有趣的答案。](http://www.gossamer-threads.com/lists/engine?do=post_view_flat;post=1641892;page=1;sb=post_latest_reply;so=ASC;mh=25;list=linux)有些人认为，在继承规则中删除文件功能`exec`会引入一些安全问题，并且功能不是为这样的功能设计的，即使没有解释它会引入哪个安全问题：/

目前唯一的方法是修改 Linux 内核中继承能力的方式（要修改 2 个文件，我在 3.7 内核上成功测试过），但不清楚是否如上所述那样安全。

在旧内核（2.6.33 之前）上，可以选择在没有文件功能的情况下进行编译（`CONFIG_SECURITY_FILE_CAPABILITIES`），但我怀疑使用这样的旧内核是否适合您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-04T08:29:38.650

我并不是说我推荐这个用于你正在做的事情，但它就是这样。

摘自手册，有一些改动。据它说：`fork`不改变能力。**现在在 Linux 内核 4.3 中添加了一个环境设置**，这似乎是你想要做的。

```
 Ambient (since Linux 4.3):
          This is a set of capabilities that are preserved across an execve(2) of a program that is not privileged.  The ambient capability set obeys the invariant that no capability can ever
          be ambient if it is not both permitted and inheritable.

          The ambient capability set can be directly modified using
          prctl(2).  Ambient capabilities are automatically lowered if
          either of the corresponding permitted or inheritable
          capabilities is lowered.

          Executing a program that changes UID or GID due to the set-
          user-ID or set-group-ID bits or executing a program that has
          any file capabilities set will clear the ambient set.  Ambient
          capabilities are added to the permitted set and assigned to
          the effective set when execve(2) is called.

   A child created via fork(2) inherits copies of its parent's
   capability sets.  See below for a discussion of the treatment of
   capabilities during execve(2).

Transformation of capabilities during execve()
   During an execve(2), the kernel calculates the new capabilities of
   the process using the following algorithm:

       P'(ambient) = (file is privileged) ? 0 : P(ambient)

       P'(permitted) = (P(inheritable) & F(inheritable)) |
                       (F(permitted) & cap_bset) | P'(ambient)

       P'(effective) = F(effective) ? P'(permitted) : P'(ambient)

       P'(inheritable) = P(inheritable)    [i.e., unchanged]

   where:

       P         denotes the value of a thread capability set before the
                 execve(2)

       P'        denotes the value of a thread capability set after the
                 execve(2)

       F         denotes a file capability set

       cap_bset  is the value of the capability bounding set (described
                 below).

   A privileged file is one that has capabilities or has the set-user-ID
   or set-group-ID bit set. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-01T19:37:56.660

我认为（我的理解），使用功能的最佳方式是：

*   对于需要能力和受信任的程序，包括受信任的不泄漏能力：例如，wire-shark 的数据包嗅探部分，需要侦听端口 80 的 Web 服务器。
    *   新程序，功能感知：设置允许。
    *   遗留程序，不知道功能：设置允许和有效
*   对于会泄漏功能的程序，并且具有可以（有时）使用功能的代码：设置继承
    *   例如，对于`chmod`设置继承 CAP_FOWNER，如果用户需要超级权限（通常由 root 持有），那么他们需要使用`setpriv`（或等效的，这可以滚动到`sudo`），否则它在非特权模式下工作。
*   当一个进程需要分叉和共享一些功能时，然后并且只有在那时才使用环境。可能相同的可执行文件；如果它是不同的，那么这个新的将允许或继承文件上的集合。[编辑：我刚刚意识到，如果您不执行，则不需要环境。如果我想到一个环境的用例，在一个设置良好的系统中，那么我会在这里添加它。Ambient 可以用作一种过渡机制，当没有在可以使用它的文件上设置继承时。]

环境的用途：

*   在文件没有正确功能的系统上。（一种过渡技术）。
*   对于 shell 脚本，它不能具有功能（因为它们不能具有 setuid），除非在已修复然后允许脚本上的 setuid 的系统上。
*   在这里添加更多。

# rsyslog - 我的 rsyslog.conf 操作不会触发 Shell Execute

> ID：14636361
> 
> 赞同：4
> 
> 时间：2013-01-31T22:31:44.017
> 
> 标签：rsyslog

我正在使用 4.6.2 版的 rsyslog 并在以下行中包含以下内容`/etc/rsyslog.conf`：

```
$template InputToScript,"/home/user/%msg%"
if $msg contains "abcdefg" then ^touch;InputToScript 
```

我做了一个PID`kill -1 <pid>`在哪里`<pid>``rsyslogd`

然后我输入

```
logger "xxxabcdefgyyy" 
```

我没有看到`/home/user/xxxabcdefgyyy`创建的文件。

我遗漏了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-06-04T21:04:54.500

当根据[https://github.com/rsyslog/rsyslog/issues/721](https://github.com/rsyslog/rsyslog/issues/721)从**logrotate**截断日志文件时，我看到了这个问题。

原来有一个**imfile**选项来处理截断**——reopenOnTruncate——**否则在被截断的文件达到其原始大小之前不会继续记录

例如

```
input(type="imfile"
      File="/var/log/secure"
      Tag="secure-testing"
      Ruleset="secure_ruleset_testing"
      reopenOnTruncate="on") 
```

您还可以根据[https://www.rsyslog.com/how-to-use-debug-on-demand/启用](https://www.rsyslog.com/how-to-use-debug-on-demand/)**rsyslog 调试输出**——

```
export RSYSLOG_DEBUG="DebugOnDemand NoStdOut"
export RSYSLOG_DEBUGLOG=/somepath/example.log
/etc/rc.d/init.d/rsyslog stop
rsyslogd -n 
```

在单独的会话窗口中运行：

```
kill -USR1 `cat /var/run/rsyslogd.pid` 
```

（确保 pid 文件存在或使用进程列表获取它）。调试日志将显示在指定的文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-28T06:54:29.720

您可能需要说明`touch`rsyslog 打开子 shell 时的完整路径。所以代码应该是

`if $msg contains "abcdefg" then ^/usr/bin/touch;InputToScript`

# javascript - 页面加载 2 秒后显示 div

> ID：14636362
> 
> 赞同：14
> 
> 时间：2013-01-31T22:31:55.247
> 
> 标签：javascript, jquery

我目前正在尝试在页面加载后 2 秒显示一个 div。我可以通过在页面加载两秒后隐藏 div 来成功地做相反的事情。问题是什么都没有发生，并且 div 保持隐藏状态。如何在页面加载两秒后正确显示 div？额外：意味着在运行两秒时显示一个 ajax 加载 gif，然后淡入 div

```
<script type = "text/javascript">  
$(window).load(function() {
    setTimeout(function() {
        $("#contentPost").show('fadeIn', {}, 500)
    }, 2000);
});
</script> 
```

**html/css**

```
<style>
.contentPost { display:none;}
</style>

<div class="contentPost">
 <h2>Hi there</h2>
</div> 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-31T22:35:40.020

```
$(document).ready(function() {
    $(".contentPost").delay(2000).fadeIn(500);
}); 
```

将完美地工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T22:33:54.553

我从来没有见过你这样写的显示方法。尝试将其更改为使用 jquery 方法[fadeIn](http://api.jquery.com/fadeIn/)：

```
<script>
$(function() {
  $("#contentPost").delay(2000).fadeIn(500);
});
</script> 
```

[show](http://api.jquery.com/show/)方法不接受任何参数，并且不会按您的意愿工作。

# linux - 通过命令行在 linux 中执行桌面应用程序而不显示其 GUI 窗口

> ID：14636365
> 
> 赞同：2
> 
> 时间：2013-01-31T22:32:16.723
> 
> 标签：linux, command-line, framebuffer, xserver

我有一个窗口化的应用程序（fi 一个带有图形或 GUI X 窗口的应用程序），它将一个文本文件作为输入（stdin）并写入一个输出文本文件。在计算过程中，它会短暂打开一个图形计算所需的窗口，然后应用程序退出。如何将此程序集成到 linux 中 shell 的纯文本和自动化批处理环境中？当我尝试在 shell 中运行它时，当然会收到错误“无法打开显示”。

有没有办法让APP窗口隐藏起来，让它可以纯粹在shell中运行？

（在我的情况下，它实际上是一个 AIR 应用程序，但我希望这对于所有类型的基于 xwindow 的应用程序都是可以解决的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T00:24:51.710

似乎我可以回答我自己的问题。答案是：Xvfb。它提供了一个“假”的虚拟帧缓冲区。

在 Ubuntu linux 中，我做了：

```
apt-get install xvfb 
```

安装后，可以使用 xvfb-run 包装脚本，这正是我需要的：

```
xvfb-run myapp 
```

完美的！

# java - JLayeredPane，背景图片+“图标”层

> ID：14636369
> 
> 赞同：1
> 
> 时间：2013-01-31T22:32:27.283
> 
> 标签：java, swing, diagramming, jlayeredpane, null-layout-manager

我需要 2 个独立的 JPanel（或任何轻量级组件）相互叠加，并最终嵌入 JPanel 中，直接或通过 JLayeredPane 之类的东西。因此，没有重型组件或玻璃板。较低的 JPanel（名为 BackgroundPanel）绘制背景图像或播放视频，同时保持纵横比并使用 alpha。上面的面板（称为 CompassPanel）上有图标，允许用户添加、删除和移动图标（就像一个图表库，虽然这个功能与这篇文章没有直接关系）。由于 JNLP 应用程序和部署环境的带宽限制，我无法添加许多外部依赖项。但是，如果有人知道可以处理 alpha 和纵横比保持的背景图像和视频的轻量级图表库，我就是游戏。 ![JLayeredPane 占用 BackgroundPanel 应使用的空间](../Images/01189599102afbceaadbc3bf8669a8ea.png)

我已经阅读了关于没有布局管理器的[JAVA 教程](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)（这不是我想做的事情，你在哪里 GBL！？），但是对于这些缩放要求和在调整大小等过程中让图标停留在图像的同一部分等。我想不出另一种方法来做到这一点。

这是代码，我使用的是 Java 1.7。另外，这是我的第一个stackoverflow，不要温柔;-)

```
import java.awt.AlphaComposite;
import java.awt.Color;
import java.awt.Composite;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.Insets;
import java.awt.Rectangle;
import java.awt.event.ComponentAdapter;
import java.awt.event.ComponentEvent;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.imageio.ImageIO;
import javax.swing.BorderFactory;
import javax.swing.ImageIcon;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JLayeredPane;
import javax.swing.JPanel;
import javax.swing.border.BevelBorder;

public class Panel extends JPanel {

    private static final Logger logger = Logger.getLogger(Panel.class.getName());

    public Panel() throws IOException {

        final BufferedImage backgroundImage = ImageIO.read(new URL(
                "http://www.windpoweringamerica.gov/images/windmaps/us_windmap_80meters_820w.jpg"));
        final Dimension backgroundImageSize = new Dimension(backgroundImage.getWidth(), backgroundImage.getHeight());
        logger.log(Level.INFO, "Image dimensions: {0}", backgroundImageSize);
        setToolTipText("This is the panel");

        final JLayeredPane layeredPane = new JLayeredPane();
        layeredPane.setBorder(BorderFactory.createLineBorder(Color.RED, 10));
        layeredPane.setToolTipText("This is the layered pane!");
        layeredPane.getInsets().set(0, 0, 0, 0);

        final BackgroundPanel backgroundImagePanel = new BackgroundPanel(backgroundImage);
        final CompassPanel compassPanel = new CompassPanel();
        backgroundImagePanel.setToolTipText("You'll probably never see me, I'm in the background, forever beneath the compass panel");
        compassPanel.setToolTipText("I'm the compass panel");

        // Per http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html, for every container w/o a layout manager, I must:
        // 1) Set the container's layout manager to null by calling setLayout(null). -- I do this here
        // 2) Call the Component class's setbounds method for each of the container's children. --- I do this when resizing
        // 3) Call the Component class's repaint method. --- I do this when resizing

        setLayout(null);
        add(layeredPane);
        layeredPane.add(backgroundImagePanel, JLayeredPane.DEFAULT_LAYER);
        layeredPane.add(compassPanel, JLayeredPane.PALETTE_LAYER);

        // Whenever this panel gets resized, make sure the layered pane gets resized to preserve the aspect ratio of the background image
        addComponentListener(new ComponentAdapter() {
            @Override
            public void componentResized(ComponentEvent evt) {
                Dimension availableSize = calculateAvailableSize(Panel.this);
                Rectangle contentBounds = calculateBoundsToFitImage(availableSize, backgroundImageSize);
                // Ok, this is a big deal. Now I know how big everything has to be, lets force it all to be the right size & repaint.
                layeredPane.setBounds(contentBounds);
                backgroundImagePanel.setBounds(contentBounds);
                compassPanel.setBounds(contentBounds);

                Panel.this.repaint();
                logger.info(String.format("Panel size: %s. Available size: %s. Content Bounds: %s", getSize(), availableSize, contentBounds));
            }
        });
    }

    /**
     * Paints the constant fitted aspect-ratio background image with an alpha of 0.5
     */
    private static class BackgroundPanel extends JPanel {

        private static final Logger logger = Logger.getLogger(BackgroundPanel.class.getName());
        private final AlphaComposite ac = AlphaComposite.getInstance(AlphaComposite.SRC_ATOP, 0.5f);
        private final BufferedImage backgroundImage;

        BackgroundPanel(BufferedImage backgroundImage) {
            setLayout(null);
            this.backgroundImage = backgroundImage;
        }
        private Dimension lastPaintedDimensions = null;

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            final Dimension size = getSize();
            if (lastPaintedDimensions == null || !size.equals(lastPaintedDimensions)) {
                logger.log(Level.INFO, String.format("Painting background on %d x %d", size.width, size.height));
            }
            final Image paintMe = backgroundImage.getScaledInstance(size.width, size.height, Image.SCALE_SMOOTH);
            final Graphics2D g2 = (Graphics2D) g.create();
            g2.drawImage(paintMe, 0, 0, this);
            g2.setColor(Color.BLUE);
            g2.dispose();
            lastPaintedDimensions = size;
        }
    };

    private static class CompassPanel extends JPanel {

        final List<Compass> compassLabels = new ArrayList<>();

        CompassPanel() {
            setLayout(null);
            setOpaque(false);
            setCursor(Cursor.getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));
        }
    }

    private static class Compass extends JLabel {

        private static final BufferedImage compassImage;

        static {
            try {
                compassImage = ImageIO.read(new URL("http://cdn1.iconfinder.com/data/icons/gur-project-1/32/1_7.png"));
            } catch (IOException ex) {
                throw new RuntimeException("Failed to read compass image", ex);
            }
        }
        final float xPercent, yPercent;

        public Compass(float xPercent, float yPercent) {
            this.xPercent = xPercent;
            this.yPercent = yPercent;
            setIcon(new ImageIcon(compassImage));
            setBorder(BorderFactory.createBevelBorder(BevelBorder.RAISED));
            setOpaque(true);
            setCursor(Cursor.getDefaultCursor());
        }
    }

    public static void main(String[] args) throws IOException {
        final JFrame frame = new JFrame("Hello Stackoverflowwwwwww! Here is a Dynamic Layered Pane Question.");
        frame.setLayout(null);
        frame.setContentPane(new Panel());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(800, 600);
        frame.setVisible(true);
    }

    private static Dimension calculateAvailableSize(final JComponent component) {

        int availableHeight = component.getSize().height;
        int availableWidth = component.getSize().width;

        final Insets insets = component.getInsets();

        availableHeight -= insets.top;
        availableHeight -= insets.bottom;

        availableWidth -= insets.left;
        availableWidth -= insets.right;

        if (component.getBorder() != null) {
            Insets borderInsets = component.getBorder().getBorderInsets(component);
            if (borderInsets != null) {
                availableHeight -= borderInsets.top;
                availableHeight -= borderInsets.bottom;

                availableWidth -= borderInsets.left;
                availableWidth -= borderInsets.right;
            }
        }

        return new Dimension(availableWidth, availableHeight);
    }

    private static Rectangle calculateBoundsToFitImage(Dimension parentSize, Dimension imageSize) {
        final double scaleFactor;
        final int xOffset, yOffset, scaledHeight, scaledWidth;
        {
            final double xScaleFactor = (double) parentSize.width / imageSize.width;
            final double yScaleFactor = (double) parentSize.height / imageSize.height;
            scaleFactor = xScaleFactor > yScaleFactor ? yScaleFactor : xScaleFactor;
            scaledHeight = (int) Math.round(scaleFactor * imageSize.height);
            scaledWidth = (int) Math.round(scaleFactor * imageSize.width);
        }

        xOffset = (int) ((parentSize.width - scaledWidth) / 2.0);
        yOffset = (int) ((parentSize.height - scaledHeight) / 2.0);
        return new Rectangle(xOffset, yOffset, scaledWidth, scaledHeight);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:02:20.627

多哈。我只是回答了我自己的问题。调用 #setBounds 与您的父容器相关，因此需要正确考虑 x 和 y 偏移量，因此可以解决以下问题：

```
backgroundImagePanel.setBounds(0, 0, contentBounds.width, contentBounds.height);
compassPanel.setBounds(0, 0, contentBounds.width, contentBounds.height); 
```

# ios - 自定义地图路径线

> ID：14636371
> 
> 赞同：3
> 
> 时间：2013-01-31T22:32:27.923
> 
> 标签：ios, ios6, mkmapview, mkoverlay

我无法在地图上用笔划画线。（内部颜色和外部颜色）我相信我在正确的道路上并且有子类 mkOverlayView 来覆盖绘图（需要填充道路大小）所以在 drawMapRect...

```
CGFloat lineWidth = MKRoadWidthAtZoomScale(zoomScale);

MKMapRect clipRect = MKMapRectInset(mapRect, -lineWidth, -lineWidth);

  ...

CGContextAddPath(context, path);
CGContextSetStrokeColorWithColor(context, line.color.CGColor);
CGContextSetLineJoin(context, kCGLineJoinRound);
CGContextSetLineCap(context, kCGLineCapRound);
CGContextSetLineWidth(context, lineWidth);
CGContextSetAlpha(context, 0.4f);
CGContextStrokePath(context);

CGPathRelease(path); 
```

我不确定如何添加笔画。任何帮助将不胜感激。xcode 4.6 / ios 6.0+

![在此处输入图像描述](../Images/38f866bc302b4d859c2a25ff1e3933bc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:40:38.003

stroke first a path ( road with) with color 1, then change stroke width and color to a thinner line with road with * 0.6 in color 2, and stroke again.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T08:28:32.630

好的，我设法根据马修的建议弄清楚了，但做了一些调整......

![在此处输入图像描述](../Images/2f161fb2ca37dd10bafde7ad79ddaac5.png)

本质上，我创建了一个描边路径`CGPathCreateCopyByStrokingPath`，并使描边比基色稍暗。然后`transparentLayer`使用路径和描边创建一个，使用混合模式`kCGBlendModeDestinationAtop`并在顶部绘制另一条只有填充的路径。我不确定这是否是最好的方法，但似乎效果很好。

```
CGPathRef newpath =  CGPathCreateCopyByStrokingPath(path, NULL, lineWidth, kCGLineCapRound, kCGLineJoinMiter, 0.0);
CGContextAddPath(context, newpath);

CGContextSetStrokeColorWithColor(context, line.color.CGColor);
CGContextSetFillColorWithColor(context,  line.color.CGColor);
CGContextSetLineWidth(context, lineWidth * 0.3);
CGContextSetAlpha(context, 0.8f);
CGContextBeginTransparencyLayer (context, NULL);
CGContextStrokePath(context);
CGContextBeginPath(context);
CGContextAddPath(context, newpath);
CGContextFillPath(context);
CGContextEndTransparencyLayer(context);
CGContextSetBlendMode(context, kCGBlendModeDestinationAtop);
CGContextSetAlpha(context, 0.3f);
CGContextBeginPath(context);
CGContextAddPath(context, newpath);
CGContextFillPath(context);

CGPathRelease(path);
CGPathRelease(newpath); 
```

**编辑**这是一个基于 AlexWien 方法的更简单的解决方案 ![在此处输入图像描述](../Images/d5a86b36ff0a51ff56449826d2ce5fc9.png)

```
 if (path != nil)
    {

        CGPathRef  path2 = CGPathCreateCopy(path);
        CGFloat hue;
        CGFloat saturation;
        CGFloat brightness;
        CGFloat alpha;

        [line.color getHue:&hue saturation:&saturation brightness:&brightness alpha:&alpha];

        UIColor *c2 =[UIColor colorWithHue:hue saturation:saturation brightness:brightness alpha:0.4];
        CGContextAddPath(context, path);

        CGContextSetStrokeColorWithColor(context, c2.CGColor);
        CGContextSetLineJoin(context, kCGLineJoinRound);
        CGContextSetLineCap(context, kCGLineCapRound);
        CGContextSetLineWidth(context, lineWidth);
        CGContextStrokePath(context);
        CGPathRelease(path);

             CGContextSetBlendMode(context, kCGBlendModeSourceAtop);
            CGContextAddPath(context, path2);
              CGContextSetRGBStrokeColor(context, 1.0f, 1.0f, 1.0f, 0.3f);
            CGContextSetLineJoin(context, kCGLineJoinRound);
            CGContextSetLineCap(context, kCGLineCapRound);
            CGContextSetLineWidth(context, lineWidth/2.0f);
            CGContextStrokePath(context);
            CGPathRelease(path2);

    } 
```

# r - 如何使用 ggplot2 在散点图中将两个轴的交点设置为 (1,1)

> ID：14636373
> 
> 赞同：1
> 
> 时间：2013-01-31T22:32:30.820
> 
> 标签：r, ggplot2

我想要的是如下粗略图：

![在此处输入图像描述](../Images/80c2ea0bdf6f6aadb5791743c17096bc.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T22:43:47.783

我假设你想要两条相交的线，你可以这样`geom_vline()`做`geom_hline()`

这是一个例子：

```
df <- data.frame(x=seq(-5,10), y=seq(-5,10))
qplot(x=x,y=y,data=df) + geom_vline(xintercept=1) + geom_hline(yintercept=1) 
```

这使得：![在此处输入图像描述](../Images/274f6dc2eabdbaaec907a297d51424e8.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-31T22:51:59.230

您可以从绘图中隐藏原始轴并使用 abline() 绘制您自己的轴

```
x <- rnorm(100,1)
y <- rnorm(100,1)

plot(x,y,axes=F)
abline(h=1)
abline(v=1) 
```

# android - “getPackageManager().getPackageInfo(getPackageName(), 0).versionCode”中的零表示获取verionCode的方法是什么意思

> ID：14636381
> 
> 赞同：3
> 
> 时间：2013-01-31T22:33:06.873
> 
> 标签：android

今天google了如何获取android应用程序的版本号，发现网上的每个人都是这样说的：

> getPackageManager().getPackageInfo(getPackageName(), 0).versionCode

我读了api，但它只是说getPackageInfo的第二个参数是附加选项标志。并且该页面只列出了一些不包括0的标志
。我使用1,2,512等进行测试，结果与使用0相同。
我只想知道为什么每个人都使用0而不是另一个数字的原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:34:24.327

0 表示所有标志都关闭

有关所有标志的含义，请参阅[此页面](http://developer.android.com/reference/android/content/pm/PackageManager.html)

# android - 如何使用python在android中获取mac地址

> ID：14636382
> 
> 赞同：2
> 
> 时间：2013-01-31T22:33:18.500
> 
> 标签：android, python, mac-address, xbmc

我正在尝试在 Android 中的 XBMC linux 环境中编写插件。我可以在 XBMC 中看到 Mac 地址。但我想获取插件的mac地址，但我不知道怎么做。

```
mac=uuid.getnode() 
```

我已经尝试过使用上面的代码，但是每次在 android 中运行时只给我数字并且每次都不同。

有人可以提出任何建议吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T00:10:55.700

如果您查看[文档](http://docs.python.org/2/library/uuid.html#uuid.getnode)：

> 以 48 位正整数形式获取硬件地址。第一次运行时，它可能会启动一个单独的程序，这可能会很慢。如果所有获取硬件地址的尝试都失败了，我们会按照 RFC 4122 的建议选择一个随机的 48 位数字，并将其第八位设置为 1。

第一部分解释了为什么它是“仅数字”。它*应该*是一个数字。如果你想要某种特定的十六进制字符串格式，只需格式化它——例如，通过调用`hex()`.

最后一句话解释了为什么它“每次都不一样”。如果您查看[源代码](http://hg.python.org/cpython/file/2.7/Lib/uuid.py#l461)，在任何非 Windows 平台上，`getnode`都会尝试`_unixdll_getnode`，然后`_ifconfig_getnode`，然后回退到一个随机数。前者需要一个`uuid_generate_time`在`libuuid`or中调用的函数`libc`，这在 Android 上不存在。后者`ifconfig`使用一系列不同的标志运行命令并搜索特定的字符串，然后回退到`arp`and `lanscan`。同样，这些都不适用于 Android。

在 Android 上没有推荐的获取 MAC 地址的方法，主要是因为他们不希望你得到一个。[这篇博文](http://android-developers.blogspot.com/2011/03/identifying-app-installations.html)解释了原因，[这个 SO 问题](https://stackoverflow.com/questions/2785485/is-there-a-unique-android-device-id)（尤其是 Seka Alekseyev 的回答）增加了更多细节。一些应用程序在获得 MAC 地址后会尝试保留它，并且不再检查，这解决了一些问题，但不是大多数问题。

有一个 Java API 可以为每个有意义的服务获取 MAC——WiFi、3G、蓝牙等。由您决定哪个是“该”MAC，并且您需要正确的权限（例如，`android.permission.ACCESS_WIFI_STATE`），并且可能没有值或垃圾值，但您可以使用如下代码获取它：

```
WifiManager wm = (WifiManager)getSystemService(Context.WIFI_SERVICE);
String mac = wm.getConnectionInfo().getMacAddress(); 
```

据我所知，SL4A 或任何其他 Android Python 发行版中都没有直接公开这些函数的内容，因此您必须编写自己的包装器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-03T17:33:59.380

您可以使用[XBMC 信息标签](http://wiki.xbmc.org/?title=InfoLabels)

```
if xbmc.getInfoLabel('Network.MacAddress') != None:
    mac_address = xbmc.getInfoLabel('Network.MacAddress')
else:
    mac_address = None 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T04:56:17.380

您可以通过这种简单的方式获取 mac 地址，假设“eth0”是您的网络设备名称：

> o = open('/sys/class/net/eth0/address', 'r')
> 
> mac_address = o.read().strip() #on "ff:ff:ff:ff:ff:ff" 形式

# android - android应用程序中的用户类型

> ID：14636384
> 
> 赞同：-2
> 
> 时间：2013-01-31T22:33:27.310
> 
> 标签：android

我目前正在为android制作一个离线应用程序。是否可以有两种类型的用户 - 管理员和非管理员？管理员是向应用程序添加数据的人，而非管理员只会查看应用程序中的数据。

如果可能，如果管理员向应用程序添加了新数据，我该如何更新非管理员的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:42:38.310

当然，这是可能的。你想添加什么样的数据？

要开始使用两个按钮“管理员”和“用户”在您的第一个视图中，当应用程序启动时显示。

“Admin”启动 AdminActivity 以添加数据。这可以存储在键值对、SQLiteDatabase 中或直接存储到内部存储中 - 取决于您要添加的数据类型。

“用户”启动应用程序的只读透视图，显示管理员添加的数据。

# c - 递增时如何忽略特殊字符以及如何使用 % 循环遍历 ASCII？

> ID：14636388
> 
> 赞同：0
> 
> 时间：2013-01-31T22:33:32.603
> 
> 标签：c, encryption, ascii, modulus, rot13

```
 #include <stdio.h>

int main()

{
    char msg[31] = {'\0'};
    char encrypted[31] = {'\0'};
    int key;

    printf("Please enter a message under 30 characters: ");
    fgets(msg, 31, stdin);

    printf("Please enter an encryption key: ");
    scanf("%d", &key);

    int i = 0;

    if (msg[i] && (('a' >= msg[i] && msg[i]>= 'z') || ('A' >= msg[i] && msg[i] >= 'Z')))
    {
        i++;
    } else {

    while (msg[i] && (('a' <= msg[i] && msg[i]<= 'z') || ('A' <= msg[i] && msg[i] <= 'Z')))
{
    encrypted[i] = (msg[i] + key);
    i++;
}
    }

    printf("%s\n", msg);
    printf("%d\n", key);
    printf("%s\n", encrypted);

} 
```

我的代码可以工作，但我不知道如何让递增忽略特殊字符和空格。另外，我如何使用 % 循环回 'a' 和 'A' 以保持消息中的所有大写字母相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:45:29.110

你不能做这样的范围测试：

```
'a' <= msg[i] <= 'z' 
```

这评估为`'a' <= msg[i]`真或假（1 或 0），始终小于`'z'`。

所以要开始你需要：

```
( msg[i] >= 'a' && msg[i] <= 'z' || msg[i] >= 'A' && msg[i] <= 'Z' ) 
```

现在，您已将此条件放在循环中，因此一旦遇到特殊字符，它将立即终止。如果您想对字母有不同的行为，请在循环中检查它们：

```
for( i = 0; msg[i] != 0; i++ ) {
    if( msg[i] >= 'a' && msg[i] <= 'z' || msg[i] >= 'A' && msg[i] <= 'Z' ) {
        encrypted[i] = msg[i] + key;
    } else {
        encrypted[i] = msg[i];
    }
} 
```

现在是你问题的第二部分。你似乎想旋转你的字母。尝试这个：

```
// Sanity -- to avoid overflowing `char`
key %= 26;
while( key < 0 ) key += 26;

for( i = 0; msg[i] != 0; i++ ) {
    if( msg[i] >= 'a' && msg[i] <= 'z' ) {
        encrypted[i] = 'a' + ((msg[i]-'a' + key) % 26);
    } else if( msg[i] >= 'A' && msg[i] <= 'Z' ) {
        encrypted[i] = 'A' + ((msg[i]-'A' + key) % 26);
    } else {
        encrypted[i] = msg[i];
    }
} 
```

如果您根本不希望加密字符串中包含非字母，请创建另一个索引：

```
int e = 0;

   encrypted[e++] = etc;  // Only when you want to add something to the string. 
```

并且不要在循环之后忘记：

```
encrypted[e] = 0;   // terminate string. 
```

# google-app-engine - GAE 数据存储同步

> ID：14636396
> 
> 赞同：0
> 
> 时间：2013-01-31T22:34:02.783
> 
> 标签：google-app-engine, deployment, sync

这个问题真的是从这个问题开始的：

[GAE 在服务器和本地开发机器之间同步内容](https://stackoverflow.com/questions/14628438/gae-syncing-content-between-the-server-and-the-local-development-machine)

如果一个项目被添加到本地开发机器上的数据存储中，那么这个项目是否会被添加到应用程序在线数据存储中？

还是在部署之前本地添加的所有数据都被擦除了，在线Datastore上的数据没有变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:12:13.970

您的本地数据独立于数据存储，没有数据同步。数据存储、blobstore 等服务由存根在本地模拟。

# qt - Qt - 不要将主要版本号附加到可执行文件/库名称的末尾

> ID：14636397
> 
> 赞同：9
> 
> 时间：2013-01-31T22:34:03.103
> 
> 标签：qt, dll, version, filenames, naming

如何阻止 Qt 将我的 DLL 重命名为`MyDLLName{MAJOR_VERSION_NUM}.dll`?

这只发生在我`VERSION`在项目文件中设置时，但我也想设置版本。例如，如果我有：

```
VERSION = 1.2.3.4 
```

我的库被命名`MyDll`，它将在调试文件夹中创建我的 DLL 作为`MyDLL1.dll`. 如果我拿走版本号，它会保留我想要的名称（`MyDLL.dll`）。

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-12-26T10:16:27.613

用这个：

```
CONFIG += skip_target_version_ext 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-10T16:04:58.233

See this answer (on SO) for why it is there: [Why library name gets an additional 0 in its name?](https://stackoverflow.com/questions/404774/why-library-name-gets-an-additional-0-in-its-name)

You can "not-set" the version to remove it from the generated name, but are you sure you want to do that? (It's there to avoid DLL Hell.)

The "proper-answer" is that the `LIB` template is adding the version number.

Also, note:

*   `VERSION` is used to define `VER_MAJ` and `VER_MIN`
*   msvc_nmake generator adds `/VERSION:major.minor` to link flags if !empty
*   msvc_vcproj generate adds `/VERSION:major.minor` to link flags and `MSVCPROJ_VERSION` if !empty

You can explicitly set those yourself, or "unset" any of them.

You can explicitly remove the version number from the target name with the `TARGET_EXT` variable, for example, see: [http://qt-project.org/faq/answer/how_can_i_add_version_information_to_my_application](http://qt-project.org/faq/answer/how_can_i_add_version_information_to_my_application)

If you want to create your own plugin to decide how to generate the target name (without the version number), you can make your own plugin as described in this answer (on SO): [How to avoid having version numbers in .so file name](https://stackoverflow.com/questions/3754434/qmake-how-to-avoid-having-version-numbers-in-so-file-name)

# html - HTML 和 CSS3：如何让元素保持静止

> ID：14636399
> 
> 赞同：0
> 
> 时间：2013-01-31T22:34:05.447
> 
> 标签：html, css

我正在测试 CSS3，现在我正在尝试使用过渡。[这](http://wordpressitis.altervista.org/)是我正在开发的网站。如果将鼠标悬停在顶部的第一个方块上，它会向左过渡。问题是，由于第一个方格移动，有一个空白空间，其他方格正在向它移动。我希望这些方块在物体移动时保持静止。有什么办法吗？

CSS

```
.container {
    margin: 0px auto;
    border: 2px;
    width: 545px;
    height: auto;
}

.title {
    margin: 0px auto;
    width: 600px;
    height: auto;
    text-align: center;
}

.elemento1 {
    float: left;
    width: 266;
    height: auto;
}

.elemento2 {
    float: right;
    width: 266;
    height: auto;
}

.foot {
    clear: both;
}

p.padding {
    padding-bottom: 15px;
    padding-top: 15px;
}

.anim {
    -webkit-transition:width 2s, height 2s, -webkit-transform 2s;
}

.anim:hover {
    width:100px;
    height:100px;
    transform: translate(-50px,0px);
    -ms-transform: translate(-50px,0px); /* IE 9 */
    -webkit-transform: translate(-50px,0px); /* Safari and Chrome */
    -o-transform: translate(-50px,0px); /* Opera */
    -moz-transform: translate(-50px,0px); /* Firefox */
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:36:55.160

您需要做的是将动画元素放在一个包装元素中，该元素已经包含足够的空白空间供您的动画四处移动。这样它会在包裹元素内部移动，而不是撞到邻居。

# php - Joomla 开发 :: URL 重写的问题

> ID：14636402
> 
> 赞同：0
> 
> 时间：2013-01-31T22:34:10.647
> 
> 标签：php, url, joomla, rewrite

我正在为 Joomla 创建一个组件，但我遇到了 URL 重写的问题。

我创建了由组件的基本文件调用的类“router.php”，并使用“JRoute”在 SEF 中重写我的链接。

问题是 Joomla 忽略了我的组件 rooter 并加载了本机组件的内容`com_content`。

对于以下网址 - [http://lafoliedesvernis.com/vernitheque/revendeurs/2-printemps-haussmann.html](http://lafoliedesvernis.com/vernitheque/revendeurs/2-printemps-haussmann.html) - Joomla 将向我显示`com_content`谁拥有的文章，`ID = 2`而不是显示我的组件的记录`ID = 2`

我觉得我已经达到了我的目标，但是对于一些我看不到的地方的代码。是什么让 Joomla 忽略我的路由器并使用`com_content`路由器？

这是我的路由器的代码：

```
<?php
defined ('_JEXEC') or die ('Restricted access');

   VernithequeBuildRoute function (& $ query)
   {
     $ Segments = array ();

     if (isset ($ query ['view'])) {
       $ Segments [0] = $ query ['view'];
         unset ($ query ['view']);
      };

     if (isset ($ query ['id'])) {
           $ Segments [1] = $ query ['id'];
         unset ($ query ['id']);
      };

     return $ segments;
   } / / End function VernithequeBuildRoute

   VernithequeParseRoute function ($ segments)
   {
     $ Vars = array ();

     if (count ($ segments)> 0) {

         $ Vars ['view'] = $ segments [0];
       switch ($ vars ['view']) {
         case 'all':
             $ Catid = explode (':', $ segments [1]);
             $ Vars ['catid'] = (int) $ catid [0];
          break;
         case 'category':
             $ Vars ['id'] = (int) $ segments [1];
          break;
         case 'brand':
             $ Id = explode (':', $ segments [1]);            
             $ Vars ['id'] = (int) $ id [0];       
          break;
         case 'resellers':
             $ Id = explode (':', $ segments [1]);            
             $ Vars ['id'] = (int) $ id [0];       
          break;
         case 'varnish':
             $ Id = explode (':', $ segments [1]);            
             $ Vars ['id'] = (int) $ id [0];       
          break;
         case 'configure':
             $ Id = explode (':', $ segments [1]);            
             $ Vars ['id'] = (int) $ id [0];       
          break;
         box 'panel':
             $ Id = explode (':', $ segments [1]);            
             $ Vars ['id'] = (int) $ id [0];       
          break;

       };

     Else {}
       $ Vars ['view'] = $ segments [0];
     } / / End count (segments) statement

     return $ vars;
   } / / End VernithequeParseRoute
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T08:51:29.593

法语 ：

Bien j'ai un peu avancé ce qui me permet d'apporter une précision supplémentaire :

il ne s'agit apparemment pas d'un problème de "router", j'ai étudier celui du "com_content", notamment les infos qu'il renvoi (l'array $vars)。

en l'occurrence l'array $vars renvoyé par le "router" du "com_content" est composé de l'index "view" (string), de l'index "id" (int), et de l'index "catid " (int) si il y en a une。J'ai donc fait en sorte que le "router" de mon composant renvoie la meme selected, et ce le cas car si je fais un var_dump de $vars sur la page de destination j'ai bien les données renvoyées qui s'affiche, mais les données chargées sont celles du "com_content", il s'agit bien d'un problème d'extension !! Joomla ne charge pas la bonne extension il ne va pas lire la bonne table... de quoi ca peut venir ?? de l'item ID ?? 留连菜单？？

En cas de besoin je met le code pour JRoute :

```
// Not Working   
$link = JRoute::_('index.php?view='.$type.''.$catid.'&id='. $slug);
// also try this but Not Working to   
$link = JRoute::_('index.php?option=com_vernitheque&view='.$type.''.$catid.'&id='. $slug); 
```

英语 ：

所以我迈出了一步，我可以带来一些精确度：

显然这不是“路由器”问题，我研究了“com_content”路由器，包括参考信息（$ vars 数组）。

在这种情况下，“com_content”的“路由”返回的 $vars 数组由索引“view”（字符串）、索引“id”（int）和索引“catid”（int）组成，如果有一。所以我确保我的组件中的“路由器”返回相同的东西，并且这种情况是因为如果我在登录页面上执行 $ vars 的 var_dump，我会返回出现的数据，但加载的数据是“com_content”的数据，确实是扩展问题！Joomla 没有加载正确的扩展名，它不会读取正确的表格......所以会发生什么？商品编号？？菜单链接？？

如有必要，我将代码用于 JRoute：

```
// Not Working   
    $link = JRoute::_('index.php?view='.$type.''.$catid.'&id='. $slug);
    // also try this but Not Working to   
    $link = JRoute::_('index.php?option=com_vernitheque&view='.$type.''.$catid.'&id='. $slug); 
```

非常感谢您的帮助 ！！谢谢 beaucoup 倒 votre 助手！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T20:55:47.837

您当前的 SEF URL 由两部分组成：

**vernitheque/revendeurs/** 指向组件，

和

**2-printemps-haussmann.html**

标识文章/项目。

Joomla 基于菜单项别名而不是组件名称创建第一部分！（除非您的组件没有关联的菜单项，在这种情况下您会看到 /component/content）

所以检查你的菜单，/vernitheque 应该是第一级菜单项的别名，可能 revendeurs 是某些 com_content 视图的第二级。

因此，创建一个指向组件中视图的菜单项并为其指定一个有意义的别名。

您的 SEF 网址现在应该有新别名作为前缀，并且路由应该重新开始工作。

然而，如果生成的别名仍然指向 Joomla com_content，这将非常奇怪：Joomla 只允许唯一的顶级别名。

我没有深入研究您的代码，但是从您描述的问题的行为看来，问题似乎超出了它的范围（它调用了错误的组件，而不是传递了错误的参数）

# wcf - maxReceivedMessageSize 未修复 413：请求实体太大

> ID：14636407
> 
> 赞同：28
> 
> 时间：2013-01-31T22:34:27.197
> 
> 标签：wcf, iis, .net-4.0, web-config, wcf-binding

我对 WCF Web 服务的调用失败了`System.Net.WebException: The request failed with HTTP status 413: Request Entity Too Large.`

检查提琴手，我看到我正在发送：

> 内容长度：149839

超过 65KB。

在服务器上启用 WCF 跟踪，我看到：

> System.ServiceModel.ProtocolException：已超出传入消息 (65536) 的最大消息大小配额。要增加配额，请在适当的绑定元素上使用 MaxReceivedMessageSize 属性。

添加此属性并不能解决问题。

我只尝试了该属性，并且（后来）尝试了帖子建议的其他各种属性。这是我目前拥有的**（在服务器上）**：

```
<basicHttpBinding>

  <binding name="PricerServiceSoap"
    closeTimeout="00:10:00" openTimeout="00:10:00"
    receiveTimeout="00:10:00" sendTimeout="00:10:00"
    maxBufferSize="2147483647"    
    maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647">

    <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647"
      maxArrayLength="2147483647" maxBytesPerRead="2147483647"
      maxNameTableCharCount="2147483647" />
  </binding>

</basicHttpBinding> 
```

我唯一的终点（下`<client>`）是：

```
<endpoint address="/NetPricingService/Service.asmx"
  binding="basicHttpBinding" bindingConfiguration="PricerServiceSoap"
  contract="Pricing.PricerService.PricerServiceSoap"
  name="PricerServiceSoap" /> 
```

我还添加了：

```
<dataContractSerializer maxItemsInObjectGraph="2147483647"/> 
```

下`<behavior>`。

我什至运行过（对于 IIS 7）：

```
%windir%\system32\inetsrv\appcmd set config "WebServicesDev/PricingService"
-section:requestFiltering -requestLimits.maxAllowedContentLength:104857600
-commitpath:apphost 
```

没有任何区别。

**一个问题是这是一个 WCF 服务，旨在替换旧的 ASMX 服务。服务框架是使用现有 WSDL 中的 svcutil 生成的。我无法更改客户端配置**（并且客户端使用多种语言）。我的测试客户端项目使用添加 Web 引用（在 下`Add Service Reference / Advanced`）导入了服务，因此我没有 WCF 配置。但是，如果我将测试客户端指向较旧的 ASMX 服务，它就可以工作。

我该如何解决或诊断这个问题？

**附加信息**

如果我使用 Microsoft 服务配置编辑器生成配置（设置 maxReceivedMessageSize 和 maxBufferSize），它可以工作。问题是端点是在 下指定的`<service>`，它不会让我指定 /NetPricingService/Service.asmx 相对地址。如果我在 svcutil 生成的配置（端点位于`<client>`）中编辑绑定，则它不适用于大请求。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-01T23:20:22.790

答案正盯着我的脸。

svcutil 生成的配置是针对客户端的。我在服务器上使用它。

我正在编辑 下指定的端点的绑定`<client>`，这对服务完全没有影响。

添加适当的`<service>`端点并在其绑定上设置 maxReceivedMessageSize 和 maxBufferSize 解决了该问题。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-08-12T12:03:55.073

我有一个类似的问题。对我来说，问题是我的端点没有明确命名绑定使用**`bindingConfiguration`**，因此一定是在某处使用了一些默认值。

我有：

```
<webHttpBinding>
    <binding 
        name="myXmlHttpBinding" 
        maxReceivedMessageSize="10485760" 
        maxBufferSize="10485760">
        <readerQuotas 
            maxDepth="2147483647" 
            maxStringContentLength="2147483647" 
            maxArrayLength="2147483647" 
            maxBytesPerRead="2147483647" 
            maxNameTableCharCount="2147483647"/>
        <security mode="None"/>
    </binding>
</webHttpBinding> 
```

我的端点定义为：

```
<service 
    name="blah.SomeService">
    <endpoint 
        address="" 
        behaviorConfiguration="WebHttpBehavior" 
        binding="webHttpBinding" 
        contract="blah.ISomeService">

        <identity>
            <dns value="localhost"/>
        </identity>
    </endpoint>
</service> 
```

一旦我将端点更改为：

```
 <service name="blah.SomeService">
    <endpoint address="" 
        behaviorConfiguration="WebHttpBehavior" 
        binding="webHttpBinding" 
        bindingConfiguration="myXmlHttpBinding" 
        contract="blah.ISomeService">
      <identity>
        <dns value="localhost"/>
      </identity>
    </endpoint>
  </service> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-08-19T19:28:56.277

我也遇到了这个问题，并在提琴手中意识到正在工作的最大 Content-Length 最终为 30000000。

在验证我的 WCF 配置是否正确后，我发现一篇文章建议修改 IIS 设置请求筛选。

[Web 应用程序调用 WCF 服务的大文件上传失败 - 413 请求实体太大](https://blogs.msdn.microsoft.com/dsnotes/2015/08/21/large-file-upload-failure-for-web-application-calling-wcf-service-413-request-entity-too-large/)

1.  打开 IIS 管理器
2.  选择您的应用
3.  选择请求过滤图标。
4.  选择编辑功能设置...（右侧面板）
5.  调整最大允许内容长度（字节）默认显示为 30000000

或 web.config 文件示例

```
<system.webServer>
  <security>
    <requestFiltering>
      <requestLimits maxAllowedContentLength="50000000" />
    </requestFiltering>
  </security>
</system.webServer> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-09T19:58:50.677

尝试了 10 个不同博客的内容，我的同事发现了。除了 basicHttpBinding 部分之外，我们还必须在其中添加一个 basicHttpsBinding 部分。我们有一个调用 wcf 的 webapi 服务。webapi 方法在调用 wcf 服务方法时捕获了实体太大错误。此更改已应用于 wcf 服务的 web.config 文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-22T21:18:11.337

没有任何建议对我有用。`MaxReceivedMessageSize`解决这个问题的方法是增加`System.ServiceModel.Channels.HttpTransportBindingElement`

有两个不同的`MaxReceivedMessageSize`参数：

*   `MaxReceivedMessageSize`在 System.ServiceModel.Configuration 中。**基本HttpBindingElement**
*   `MaxReceivedMessageSize`在 System.ServiceModel.Channels 中。**HttpTransportBindingElement**

在转储文件中，我看到它由于限制而失败`HttpTransportBindingElement`

将此添加到我的 web.config 解决了这个问题：

```
<customBinding>
   <binding closeTimeout="00:10:00" openTimeout="00:10:00" sendTimeout="00:10:00">
      <httpTransport maxReceivedMessageSize="2147483647" maxBufferSize="2147483647" useDefaultWebProxy="true" transferMode="Buffered" />
   </binding>
</customBinding> 
```

来源：[WCF 服务在上传超过 64 KB 的文件时显示 413 Request Entity Too Large 错误](https://port135.com/413-request-entity-too-large/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-02T12:27:57.197

添加这个为我解决它：

```
 <bindings>
        <basicHttpBinding>
            <binding name="BasicHttpBinding_Example"
 maxBufferSize="2147483647" 
maxReceivedMessageSize="2147483647">
            </binding>
        </basicHttpBinding>
    </bindings> 
```

# asp.net - MVC 4 可以在 .net 3.5 上运行吗？

> ID：14636410
> 
> 赞同：8
> 
> 时间：2013-01-31T22:34:54.210
> 
> 标签：asp.net, asp.net-mvc-4

我的服务器最多只支持 ASP .NET 3.5。我正在学习开发 MVC 4。是否可以在 .NET 3.5 机器上运行 MVC 4？当然，我无权更改服务器机器的配置。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T22:42:43.757

不，它使用在更高框架版本中实现的组件，将不可用。

这是 MVC 4 的要求：

> 系统要求 支持的操作系统：Windows 7、Windows Server 2003 R2（32 位 x86）、Windows Server 2003 R2 x64 版本、Windows Server 2003 Service Pack 2、Windows Server 2008、Windows Server 2008 R2、Windows Vista Service Pack 2、Windows XP 服务包 3
> 
> 需要 PowerShell 2.0、.NET 4、ASP.NET 4 和 Visual Studio 2010 SP1 或 Visual Web Developer 2010 SP1 才能使用此功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:42:25.513

不幸的是，你不能。ASP.NET MVC 3 和 4 都需要 .NET Framework 4.0（它们还需要 Visual Studio 2010 或更高版本；如果您使用的是 VS2008 和/或 .NET 3.5，那么您将无法使用 ASP.NET MVC 2.0）。

出于好奇，您正在运行什么服务器？Windows Server 2003（Small Business Server 2003 除外）[完全支持 .NET Framework 4.0](http://msdn.microsoft.com/en-us/library/8z6watww%28v=vs.100%29.aspx)。下一个较旧的操作系统是 Windows 2000，但它不运行 .NET 3.5。我唯一的另一个猜测是你有一个糟糕的虚拟主机？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:42:28.790

MVC 4 针对 .NET 4.5 框架。查看此问答了解更多详细信息：[https ://softwareengineering.stackexchange.com/questions/157717/what-is-dependency-of-asp-net-mvc-on-net-framework-and-how-to-与网络一起使用](https://softwareengineering.stackexchange.com/questions/157717/what-is-dependency-of-asp-net-mvc-on-net-framework-and-how-to-use-it-with-net)

# java - 替换 server.xml 中的 Tomcat StandardContext

> ID：14636411
> 
> 赞同：0
> 
> 时间：2013-01-31T22:35:01.667
> 
> 标签：java, tomcat6

我在 Tomcat 6.0.24 上运行一个 Java 应用程序，它需要能够在运行时动态更改 JSESSIONID cookie 的 PATH。在决定最简单的方法可能是扩展 org.apache.catalina.core.StandardContext 并覆盖 getEncodedPath 函数之前，我花了很长时间尝试在过滤器中操作 cookie。

我创建了一个名为 MultiTabContext 的自定义上下文，它扩展了 StandardContext 并删除了所有出现的类路径问题。我已经在 catalina/conf/server.xml 中定义了我的上下文（我知道它应该在 context.xml 中，但我稍后会解决这个问题）：

```
<Server port="8005" shutdown="SHUTDOWN">
  ...
  <Service name="Catalina">
    ...
    <Engine name="Catalina" defaultHost="localhost">
      ...
      <Host name="localhost"  appBase="webapps"
            unpackWARs="true" autoDeploy="true"
            xmlValidation="false" xmlNamespaceAware="false">
        ...
        <!-- HERE IS MY CONTEXT -->
        <Context className="foo.app.server.MultiTabContext"
                 path=""
                 crossContext="false"
                 debug="0"
                 reloadable="true"/>
      </Host>
    </Engine>
  </Service>
</Server> 
```

这是我的 MultiTabContext：

```
package foo.app.server;

import org.apache.catalina.core.StandardContext;

public class MultiTabContext extends StandardContext {

    @Override
    public String getEncodedPath() {
        return super.getEncodedPath();
    }
} 
```

因为路径是“”，所以我希望在每个请求上都使用我的上下文，而不是 StandardContext。但是，该应用程序仍在使用 StandardContext，而不是我的。任何人都知道如何定义上下文，以便 Tomcat 使用我的而不是 StandardContext（或者知道动态更改 JSESSIONID cookie 路径的更好方法）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:52:45.110

我不确定天气是否有助于回答您的问题。但是，我有一种方法可能会有所帮助。当请求得到处理时，您可以在运行时更改 JSESSIONID cookie 路径。

```
/**
 * This gets the information from the request
 * 
 * @param parameter, pass JSESSION ID 
 * @return
 */
protected String getRequestInfo(HttpServletRequest request, String parameter)
{
    Cookie[] cookies = null;
    if (request.getRequestURI() == null || request.getRequestURI().length() == 0) 
    {
        performanceLogger.debug(" Request generated null pointer");
    }
    try 
    {
        cookies = request.getCookies();
    } 
    catch (Exception ex)
    {
        cookies = null;

    }
    if (cookies == null || cookies.length == 0)
    {
        return null;
    }

    String paramValue = null;
    for (Cookie c : cookies)
    {
        if (c.getName().equals(parameter)) 
        {
            //change the path of JESSION ID over here 
            break;
        }
    }
    return paramValue;
} 
```

# listview - Android布局未在列表视图下方显示按钮

> ID：14636412
> 
> 赞同：0
> 
> 时间：2013-01-31T22:35:02.967
> 
> 标签：listview, android-linearlayout

我有 2 个类似的项目，它们从数据库中提取联系地址并显示在列表视图中。我需要选择联系人并单击一个按钮。下面是布局文件（与我在两个项目中使用的相同）。一个项目显示带有按钮的列表，而另一个项目显示列表，而不是按钮。请问有什么建议吗？

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_marginLeft="10dp"
android:orientation="vertical"
tools:context=".MainActivity" >

<ListView
    android:id="@android:id/list"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:stackFromBottom="false"
    android:transcriptMode="normal"
    android:choiceMode="multipleChoice"  >

</ListView>

<Button
    android:id="@+id/SelectBtn"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="@string/selectBtn"
    android:layout_weight="0" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T08:55:13.973

试试这个代码，

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_marginLeft="10dp"
android:orientation="vertical"
tools:context=".MainActivity" >

<ListView
    android:id="@+id/list"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:stackFromBottom="false"
    android:transcriptMode="normal"
    android:choiceMode="multipleChoice"  >

</ListView>

<Button
    android:id="@+id/SelectBtn"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Ok"
    android:layout_weight="0" />

</LinearLayout> 
```

# android - 在 SearchView 中限制对 ContentProvider 的查询次数

> ID：14636413
> 
> 赞同：0
> 
> 时间：2013-01-31T22:35:08.047
> 
> 标签：android, android-contentprovider, android-searchmanager

我有一个通过*搜索 API*管理的**自动完成功能** ，并显示位置列表作为建议。数据由远程*GAE 应用程序*提供。`SearchView`*`ContentProvider`*

 **我遇到的问题是`SearchView`对用户按下的每个字母进行查询。

例如，对于*纽约*，它进行了 8 个查询，我想限制这一点，因为很多查询都被浪费了，因为网络延迟大于用户输入延迟，例如在收到“Ne”之前询问“New”。

我会喜欢一种更智能的行为，就像其他搜索组件一样，这些组件有一些逻辑，可以在用户主动输入时不执行这么多查询。

PD：使用 Searchable API 或提供程序的解决方案会更好，因为我`SearchView`在较新的 Android 版本中使用，在较旧的版本中使用搜索对话框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:53:03.410

您至少可以通过指定以下内容来限制为开始搜索而键入的最少字符数：

```
android:searchSuggestThreshold 
```

在可搜索的配置中**

# quickbooks - 使用 C# 开发工具包，发票不会出现在 QB 中

> ID：14636414
> 
> 赞同：2
> 
> 时间：2013-01-31T22:35:14.240
> 
> 标签：quickbooks, invoice, intuit-partner-platform, devkit

代码似乎可以运行。我没有收到任何错误消息，但在我同步后发票没有出现在 QB 中。代码基本上是这样的（[http://pastebin.com/y7QENxeX](http://pastebin.com/y7QENxeX)），上面有一些（大概）小的改动。我能够创建帐户和客户，所以我相信我的应用程序的基本基础设施是好的。我不明白为什么我被困在发票上。我想我的 customerID 是 2。我现在公司里只有 5 个。而且我认为我的 itemID 是 1，因为我现在在 QB 中只有一个。

非常感谢任何和所有帮助。

```
Intuit.Ipp.Data.Qbd.PhysicalAddress physicalAddress = new Intuit.Ipp.Data.Qbd.PhysicalAddress();
physicalAddress.Line1 = "123 Main St.";
physicalAddress.Line2 = "Apt. 12";
physicalAddress.City = "Mountain View";
physicalAddress.CountrySubDivisionCode = "CA";
physicalAddress.Country = "USA";
physicalAddress.PostalCode = "94043";
physicalAddress.Tag = new string[] { "Billing" };

Intuit.Ipp.Data.Qbd.InvoiceHeader invoiceHeader = new Intuit.Ipp.Data.Qbd.InvoiceHeader();
invoiceHeader.ARAccountId = new Intuit.Ipp.Data.Qbd.IdType() { idDomain = Intuit.Ipp.Data.Qbd.idDomainEnum.QB, Value = "37" };
invoiceHeader.ARAccountName = "Accounts Receivable";
// original code : invoiceHeader.CustomerId = new IdType() { idDomain = idDomainEnum.NG, Value = "3291253" };
invoiceHeader.CustomerId = new Intuit.Ipp.Data.Qbd.IdType() { idDomain = Intuit.Ipp.Data.Qbd.idDomainEnum.QB, Value = "2" };
invoiceHeader.Balance = (decimal)100.00;
invoiceHeader.BillAddr = physicalAddress;
invoiceHeader.BillEmail = "detroit@tigers.com";
invoiceHeader.CustomerName = "Detroit Tigers";
invoiceHeader.DocNumber = "1234567";
invoiceHeader.DueDate = DateTime.Now;
invoiceHeader.ShipAddr = physicalAddress;
invoiceHeader.ShipDate = DateTime.Now;
invoiceHeader.TaxAmt = (decimal)5;
invoiceHeader.TaxRate = (decimal).05;
invoiceHeader.ToBeEmailed = false;
invoiceHeader.TotalAmt = (decimal)105.00;

List<Intuit.Ipp.Data.Qbd.InvoiceLine> listLine = new List<Intuit.Ipp.Data.Qbd.InvoiceLine>();

//Loop for multiple invoice lines could be added here
Intuit.Ipp.Data.Qbd.ItemsChoiceType2[] invoiceItemAttributes = { Intuit.Ipp.Data.Qbd.ItemsChoiceType2.ItemId, Intuit.Ipp.Data.Qbd.ItemsChoiceType2.UnitPrice, Intuit.Ipp.Data.Qbd.ItemsChoiceType2.Qty };
// original code : object[] invoiceItemValues = { new IdType() { idDomain = idDomainEnum.QB, Value = "5" }, new decimal(33), new decimal(2) };
object[] invoiceItemValues = { new Intuit.Ipp.Data.Qbd.IdType() { idDomain = Intuit.Ipp.Data.Qbd.idDomainEnum.QB, Value = "1" }, new decimal(33), new decimal(2) };
var invoiceLine = new Intuit.Ipp.Data.Qbd.InvoiceLine();
invoiceLine.Amount = 66;
invoiceLine.AmountSpecified = true;
invoiceLine.Desc = "test " + DateTime.Now.ToShortDateString();
invoiceLine.ItemsElementName = invoiceItemAttributes;
invoiceLine.Items = invoiceItemValues;
invoiceLine.ServiceDate = DateTime.Now;
invoiceLine.ServiceDateSpecified = true;
listLine.Add(invoiceLine);

Intuit.Ipp.Data.Qbd.Invoice invoice = new Intuit.Ipp.Data.Qbd.Invoice();
invoice.Header = invoiceHeader;
invoice.Line = listLine.ToArray();

Intuit.Ipp.Data.Qbd.Invoice addedInvoice = commonService.Add(invoice); 
```

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T13:21:32.303

您需要阅读以下有关 QuickBooks for Windows 同步管理器如何工作、如何查看同步是否正确运行、对象是否处于错误状态以及如何解决的信息。它可以是任何数量的东西。将记录插入云端后，它会异步下载到桌面上的 QuickBooks，此时应用业务逻辑并将记录从云端匹配到桌面。如果出现问题，同步管理器将显示失败对象的记录、失败原因以及对象现在处于错误状态。

此时，您可以查看错误并采取措施进行修复，例如还原或更新并重新提交。链接到下面的文档。

[QuickBooks 同步管理器](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0300_Sync_Manager)
[数据同步](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0400_Data_Synchronization)
[对象处于错误状态](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0100_Calling_Data_Services/0015_Retrieving_Objects)
[同步活动](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0600_Object_Reference/SyncActivity)
[同步状态](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0600_Object_Reference/SyncStatus)

问候贾里德

# html - HTML5 视频格式 - 兼容性

> ID：14636415
> 
> 赞同：11
> 
> 时间：2013-01-31T22:35:14.770
> 
> 标签：html, video, mp4, ogg, webm

所以，我正在建立一个用户可以上传观看视频的网站。我正在使用标准的 HTML5 视频播放器 ( `<video...> <src>...`) 目前，我使用多个来源：MP4、OGG 和 WEBM，以实现跨浏览器兼容性

由于维护三种格式既是 CPU 密集型（转换），又是占用宝贵的磁盘空间，我开始搜索是否真的需要支持这三种格式

根据我在 Wikipedia ( [http://en.wikipedia.org/wiki/HTML5_video](http://en.wikipedia.org/wiki/HTML5_video) ) 上找到的图表，OGG 和 MP4 应该足够了，因为所有浏览器似乎都支持这些格式中的至少一种

...还是我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T22:44:41.167

要获得全面的答案，请参阅：[http](http://diveintohtml5.info/video.html) ://diveintohtml5.info/video.html 底部有一个兼容性矩阵，该矩阵开始过时，但在撰写本文时具有权威性。

> *   Firefox 3.5+ 在 Ogg 容器中支持 Theora 视频和 Vorbis 音频。Firefox 4+ 也支持 WebM。
> *   Opera 10.5+ 支持 Ogg 容器中的 Theora 视频和 Vorbis 音频。Opera 10.60（及更高版本）也支持 WebM。
> *   Chrome 3.0+ 在 Ogg 容器中支持 H.264、Theora 视频和 Vorbis 音频。Chrome 6.0+ 也支持 WebM。
> *   Mac 和 Windows PC 3.0+ 上的 Safari 将支持 QuickTime 支持的任何内容。理论上，您可以要求您的用户安装第三方 QuickTime 插件。实际上，很少有用户会这样做。因此，您只剩下 QuickTime 支持“开箱即用”的格式。这是一个很长的列表，但它不包括 WebM、Theora、Vorbis 或 Ogg 容器。但是，QuickTime 在 MP4 容器中支持 H.264 视频（主要配置文件）和 AAC 音频。
> *   Apple 的 iPhone 和 Google Android 手机等手机支持 MP4 容器中的 H.264 视频（基线配置文件）和 AAC 音频（“低复杂度”配置文件）。
> *   Adobe Flash（9.0.60.184 及更高版本）支持 MP4 容器中的 H.264 视频（所有配置文件）和 AAC 音频（所有配置文件）。
> *   Internet Explorer 9+ 支持 MP4 容器中 H.264 视频和 AAC 或 MP3 音频的所有配置文件。如果您安装了第三方编解码器，它也将播放 WebM 视频，任何版本的 Windows 默认情况下都不会安装该编解码器。IE 不支持其他第三方编解码器（与 Safari 不同，它将播放 QuickTime 可以播放的任何内容）。
> *   Internet Explorer 8 根本不支持 HTML5 视频，但几乎所有 Internet Explorer 用户都拥有 Adob​​e Flash 插件。在本章后面，我将向您展示如何使用 HTML5 视频，但又可以优雅地回退到 Flash。

# php - PHP 学习 OOP 和 Ajax，以及一个 OOP 错误

> ID：14636416
> 
> 赞同：0
> 
> 时间：2013-01-31T22:35:21.570
> 
> 标签：php, ajax

我想讨论三件事：

1\. 学习 Ajax 的好资源在哪里？我看过这个网站，但它不包含太多信息：
[http](http://www.php-learn-it.com/tutorials/starting_with_php_and_ajax.html)

: //www.php-learn-it.com/tutorials/starting_with_php_and_ajax.html 2\. 哪里有学习 OOP 的好资源？我已经在这个网站上完成了所有步骤：
[http](http://www.killerphp.com/tutorials/object-oriented-php/) ://www.killerphp.com/tutorials/object-oriented-php/但它是从 2007 年开始的。

* **3 解决了！*** 3.还有一个关于killerphp教程的问题；
为什么我会收到此错误：

```
Notice: Undefined variable: name in C:\xampp\htdocs\class_lib.php on line 11 
```

致命错误：无法访问第 11 行 C:\xampp\htdocs\class_lib.php 中的空属性

**使用此代码（index.php）：**

```
<?php
$william = new person("William N");

echo "<p>name: ". $william->get_name()."</p>"; 
```

?>

**这在 class_lib.php 中：**

```
class person {
var $name;

function __construct($persons_name)
{
    $this->name = $persons_name;
}
public function get_name()
{
     return $this->$name;
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:38:00.237

```
return $this->$name; 
```

should be:

```
return $this->name; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:39:41.703

try it like this:

```
class person {
   protected $name;

  public function __construct($persons_name)
  {
        $this->name = $persons_name;
  }
   public function get_name()
   {
        return $this->name;
   } 
```

Are you using PHP 5? You should not use var anymore if so.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T23:26:07.763

由于您的第三个问题已经得到回答，就第二个问题而言，我还没有读过这本书，但是 php.net 一如既往地为您提供了所有基础知识，甚至更多内容，几乎每一页都有示例。:)

# unity3d - 如何配置 AppHarbor 以显示 unity3d 文件？

> ID：14636420
> 
> 赞同：0
> 
> 时间：2013-01-31T22:35:59.990
> 
> 标签：unity3d, appharbor

我有一个调用 unity3d 文件的 html 文件，但是当我尝试在浏览器上加载它时出现此错误“无法下载数据文件”。有一个错误详细信息链接，但它只是说“下载失败，重试”。有谁知道我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T04:21:43.573

您是否尝试过从 AppHarbor 仪表板下载构建输出以确认该文件在其中？[AppHarbor FAQ](http://support.appharbor.com/kb/getting-started/frequently-asked-questions)中有更多调试建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:07:41.160

我终于修复了创建 Visual Studio 项目并在 web.config 上添加了 mime 类型

# postgresql - Connect to PostgreSQL from UI

> ID：14636421
> 
> 赞同：0
> 
> 时间：2013-01-31T22:36:01.853
> 
> 标签：postgresql

I haven't used PostgreSQL before but now I have a Rails app that is using PostgreSQL and I want to see if I can connect to it and see if there is any data in there: I used InductionApp to try to connect, but don't know what to actually type in the fields to connect or where to find the data that I need to connect: [http://inductionapp.com](http://inductionapp.com)

![enter image description here](../Images/561d841d20e1a6e9ab3defa4069ff7bf.png)

![enter image description here](../Images/32d58097b0820e78e4fe84d812f806a2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:45:53.973

好的，我想通了，我发布了一个屏幕截图，它对我来说是怎样的：

![在此处输入图像描述](../Images/fae9c77e570fc87d4acf4b8ea17e1e05.png)

# mysql - MySQL IF Result Count 0 Return Message

> ID：14636423
> 
> 赞同：0
> 
> 时间：2013-01-31T22:36:10.653
> 
> 标签：mysql, sql, select

I need the following query to return a message, such as "No Result" if the Record Count = 0.

```
set @ID_CARTERA = 1;

select    

LEFT(A.F_ANOTRIMESTRE, 4 ) Year,
RIGHT(A.F_ANOTRIMESTRE, 2 ) Quarter,
ROUND ( A.POR_RENTABILIDAD, 2 ) Quarterly_Yield

from      dr_rent_carteras_trimestres A

where     A.ID_CARTERA = @ID_CARTERA
And       (LEFT(A.F_ANOTRIMESTRE, 4 ) = ( select    MAX(left(F_ANOTRIMESTRE, 4 ) ) - 0
                                         from      dr_rent_carteras_trimestres
                                         where     ID_CARTERA = @ID_CARTERA ) 
            and
            RIGHT(A.F_ANOTRIMESTRE, 2 ) = 12) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T03:13:32.387

你可以像这样欺骗系统：

1.  生成查询以返回 COUNT(*)。这将始终返回一行，即使要计算的行数为零

2.  使用 COUNT(*) 查询左连接您的主查询。使用 Case 语句将结果替换为“无结果”。

因此，结果查询将如下所示（假设 - 主查询仅返回零或一条记录 - 因此 LEFT JOIN 中没有 ON 子句！！！！！！）：

```
set @ID_CARTERA = 1;

select    
CASE cnt WHEN 0 THEN "No Results" ELSE Year END,
Quarter,
Quarterly_Yield
FROM
(select count(*) AS cnt
from      dr_rent_carteras_trimestres A
where     A.ID_CARTERA = @ID_CARTERA
And       (LEFT(A.F_ANOTRIMESTRE, 4 ) = ( select    MAX(left(F_ANOTRIMESTRE, 4 ) ) - 0
                                         from      dr_rent_carteras_trimestres
                                         where     ID_CARTERA = @ID_CARTERA ) 
            and
            RIGHT(A.F_ANOTRIMESTRE, 2 ) = 12) ) cnt_tbl
LEFT JOIN
( select    
LEFT(A.F_ANOTRIMESTRE, 4 ) Year,
RIGHT(A.F_ANOTRIMESTRE, 2 ) Quarter,
ROUND ( A.POR_RENTABILIDAD, 2 ) Quarterly_Yield
from      dr_rent_carteras_trimestres A
where     A.ID_CARTERA = @ID_CARTERA
And       (LEFT(A.F_ANOTRIMESTRE, 4 ) = ( select    MAX(left(F_ANOTRIMESTRE, 4 ) ) - 0
                                         from      dr_rent_carteras_trimestres
                                         where     ID_CARTERA = @ID_CARTERA ) 
            and
            RIGHT(A.F_ANOTRIMESTRE, 2 ) = 12) ) main_tbl 
```

使用 UNION 也可以完成同样的事情。如果您希望我展示如何在评论中询问

# jquery - A jQuery "bug" for the pros- alert makes it work

> ID：14636425
> 
> 赞同：1
> 
> 时间：2013-01-31T22:36:27.767
> 
> 标签：jquery

I have a simple function on click that toggles a div. It checks the classes to determine if it should remove the 'hilighted' state classes.

This fails to remove the holdhilite class:

```
function togglediv(id){
    //alert('toggle id= '+id);
    $("#"+id).toggle("fast");
    if(window.location.hash.split("#")[1]==justtheid(id)){
        var scr = document.body.scrollTop;
        window.location.href = '#';
        document.body.scrollTop = scr;          
    }       
    var trid = "tr_"+justtheid(id);
    if($("#"+trid).attr('class')=='holdhilight rowhover'){
        $("#"+trid).removeClass('holdhilight');         
    }
    else{
        $("#"+trid).addClass('holdhilight');            
    }
} 
```

On the other hand, this works 100%:

```
function togglediv(id){
    alert('toggle id= '+id);
    $("#"+id).toggle("fast");
    if(window.location.hash.split("#")[1]==justtheid(id)){
        var scr = document.body.scrollTop;
        window.location.href = '#';
        document.body.scrollTop = scr;          
    }       
    var trid = "tr_"+justtheid(id);
    if($("#"+trid).attr('class')=='holdhilight rowhover'){
        $("#"+trid).removeClass('holdhilight');                         
    }
    else{
        $("#"+trid).addClass('holdhilight');            
    }
} 
```

Note the only difference is that alert being uncommented (i don't even want to tell you how long it took me to figure out this was the issue... lol)

So, what's the deal? why does waiting/clicking ok on the alert allow the class=='holdhilight rowhover' to match but when no alert, it does not (even though an alert in this spot says it DOES indeed match, but once the alert is in place, it works again... lol)

I've waiting in my browser 30 seconds before trying to close it, and that did nothing to fix it. It's not the script taking forever to run.

This is all wrapped in a ready() function anyway.

I'm in an ie8-specific enviro (intranet) using the latest 1.9

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:29:01.183

我终于通过使用动作处理程序作为一个函数来完成其他工作。这应该很明显，我觉得回答它很愚蠢，但是嘿，也许它可以帮助其他人。

```
$('#'+id).toggle('fast', function() {
//all the hash location stuff here will fire after the toggle is done. 
}); 
```

# php - Getting demographics info about youtube channels using youtube api

> ID：14636428
> 
> 赞同：2
> 
> 时间：2013-01-31T22:36:33.693
> 
> 标签：php, codeigniter, youtube, youtube-api

I need to access Youtube channel's demographics data with oauth.

One problem is that Youtube api called insight only provides zipped folders with csv files.

While I can probably download the zip, unzip, access the file, and delete the original once I get the data I need, I was wondering if there is any other way to get youtube channel's demographics data.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:17:29.897

我相信是的，使用新的 YouTube Analytics API：

[https://developers.google.com/youtube/analytics/v1/available_reports](https://developers.google.com/youtube/analytics/v1/available_reports)

从文档：

频道报告

下表列出了可通过 API 访问的不同类型的渠道报告。要检索频道报告，请将 ids 参数值设置为 channel==USER_ID，其中 USER_ID 指定当前经过身份验证的用户的 YouTube 用户 ID。

我认为这就是你想要的报告：

```
dimensions: country

metrics: views, comments, favoritesAdded, favoritesRemoved, likes, dislikes, shares, subscribersGained, subscribersLost

filters: video 
```

或者这个：

```
dimensions: ageGroup, gender

metrics: viewerPercentage

filters: country video(,country) 
```

这个例子展示了如何调用 API：

[https://developers.google.com/youtube/analytics/v1/sample-application](https://developers.google.com/youtube/analytics/v1/sample-application)

# html - Updating src of video tag multiple times

> ID：14636441
> 
> 赞同：0
> 
> 时间：2013-01-31T22:37:39.500
> 
> 标签：html, video

On a simple page i have a list of titles, clicking on any title will dynamically update the src of a element on the page. This works fine... a few times... then the browser (Safari) refuses to update the src any more, in the debugger it says something about failing to load local resource. If I how ever refresh the page, it will start working again, a few times until it stops again. It seems to work in all other browsers so I'm guessing it's a bug in Safari.

I simply update the src attribute of my video tag, and then call "load()" on the element. I've also tried totally replacing the video element each time instead, but with the same result.

Any hints / workarounds?

Clarification: If I update the src with exactly the same source all the time will still exhibit the buggy behavior using Safari (v6.0.2). Replacing the src works a few times, then the browser suddenly stops accepting updates to the src and emits an error about not being able to load local resource.

**HTML part:**

```
<video controls>
    <source type="video/mp4" src="videos/myvideo.mp4"/>
</video>
<button id="#buttonChangeVideo">Change video</button> 
```

**Javascript/jQuery part:**

```
$('#buttonChangeVideo').click(function() {
    var $video = $('video');
    $video.attr('src', 'videos/myvideo.mp4');
    $video.get(0).load();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T18:32:02.087

```
<source type="text/html" src="videos/myvideo.mp4"/>

$video.attr('src', 'video/myvideo.mp4'); 
```

**视频**和**视频**是有区别的

# ruby-on-rails - Rails 3 中的 Ajax 成功事件

> ID：14636442
> 
> 赞同：0
> 
> 时间：2013-01-31T22:37:50.130
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, jquery, ruby-on-rails-3.2

Rails 新手在这里。我有对服务器进行 ajax 查询的链接：

```
<%= link_to g.name, g, :class => 'link link-to-gallery', :remote => true %> 
```

从部分加载数据的 JS 视图：

```
$('#content').html('<%= escape_javascript render("layouts/galleries/show") %>'); 
```

以及使用模型操作并呈现 html 和 js 的控制器：

```
类画廊控制器 < 应用控制器
  定义显示
    @画廊 = Gallery.all
    @gallery_to_show = Gallery.find(params[:id])
    respond_to 做 |格式|
      格式.html
      格式.js
    结尾
  结尾
结尾

```

Ajax 工作正常，但我尝试在 ajax 完成后放置回调：

```
jQuery（函数（）{
  $(".link-to-gallery").bind("ajax:complete", function() {
    警报(1)
  });
});

```

并且警报从不显示。我究竟做错了什么？Rails 版本是 3.2.11，Ruby 版本是 1.9.3p194

更新：当我使用此代码时

```
jQuery（函数（）{
  $(".link-to-gallery")
    .on("ajax:before", function () {
      警报（“之前”）
    })
    .on("ajax:complete", function() {
      警报（“完成”）
    });
});

```

“之前”警报触发但只有一次。如果我再次按下，我将一无所获。但是ajax仍然有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:46:42.107

我认为问题在于您的控制器方法没有使用成功状态消息 200 响应异步调用。

试试这个

```
def show
  @galleries = Gallery.all
  @gallery_to_show = Gallery.find(params[:id])
  respond_to do |format|
    format.html { :status => 200 }
    format.js { :status => 200 }
  end
end 
```

如果这不起作用，试试这个。

```
def show
  @galleries = Gallery.all
  @gallery_to_show = Gallery.find(params[:id])
  respond_to do |format|
    format.html { :status => :ok }
    format.js { :status => :ok }
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T19:58:04.787

看来我很跛脚但足够聪明来解决这个问题。我有这些链接：

```
<%= link_to g.name, g, :class => 'link link-to-gallery', :remote => true %> 
```

在ajax之后重新渲染的部分中。因此，附加到这些链接的回调函数在 ajax 之后被清除掉了。所以我把这个部分的链接放在外面，它现在可以工作了。

# c# - HttpClient PostAsync to Blogger API

> ID：14636443
> 
> 赞同：4
> 
> 时间：2013-01-31T22:37:52.700
> 
> 标签：c#, rest, oauth, blogger, dotnet-httpclient

I am using the following API to allow me to interact with Google Blogger. I need to insert a post into the users blog. However I am having trouble with my PostAsync functionality. I get a 401 telling me that my request isn't authorized despite having an API Key, however I think I may not be properly inserting my OAuth token.

I have the following code,

This is the code where I set up my authorization header, (note the key there is fake but is the same form as what i think is the OAuth token)

```
httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("ya29.AHES6ZTBZi1dWPVdlcF7qAD-nSM6XxwY2323232m4lXW"); 
```

And this is my PostAsync function

```
 HttpResponseMessage response = await req.PostAsync(URLs.postBlogURL + blogID + URLs.postBlogURLPost, new StringContent(json)); 
```

Can anyone tell me where I am going wrong? Cheers.

[**UPDATE**]

I amen't sure whether the authorization has to include the string bearer in it.

```
 httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer ya29.AHES6ZTBZi1dWPVdlcF7qAD-nSM6XxwY2323232m4lXW"); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-06T19:57:38.247

这就是我能够为我的请求设置正确的 OAuth auth 标头的方式：

```
httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue( "Bearer", _accessTokenWrapper.Token.access_token ); 
```

构造函数的第一个参数是用于 Authorization 标头的方案。因此，在请求中，标头内容为：

```
Authorization: Bearer {the access token string} 
```

# python - Elif 如果不工作或者我不理解

> ID：14636446
> 
> 赞同：0
> 
> 时间：2013-01-31T22:38:11.083
> 
> 标签：python, if-statement

好吧，我的代码可以正常工作，但是当我输入“否”时，如果我想重试输入密码，它就不起作用了；它只是进入输入密码行（第 20 行）。我已经尝试了多种方法来解决这个问题，但我根本做不到。

```
import time
import os

print ("Hello world.")
time.sleep(1)
print ("Waiting 5 seconds.")
time.sleep(5)
print ("You have waited 10 seconds.")
print ("Executing Chrome.")
time.sleep(1)
print ("Execution failed!")
password = input("Enter the execution password: ")
if password == 'password1234':
    os.system ('C:\\Users\\Harry\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe')
else:
    print ("Wrong password!")
    time.sleep(1)
    passretry = input("Do you want to try again? ")
    if passretry == 'yes' or 'Yes':
        passretry1 = input("Enter password: ") 
        if passretry1 == 'password1234':
            os.system ('C:\\Users\\Harry\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe')
    elif passretry == 'no' or 'No':
        print ("Closing...")
        time.sleep(1)
    else:
        print ("Wrong password.")
        time.sleep(.5)
        print ("Retry limit exceeded, closing.")
        time.sleep(1) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T22:39:45.183

```
if passretry == 'yes' or 'Yes': 
```

上面的 if 语句被评估为： -

```
if (passretry == 'yes') or 'Yes': 
```

现在，因为`'Yes'`被评估为`True`，所以，你的`if`语句总是`True`，因此你总是必须输入新密码。

* * *

您需要将条件更改为： -

```
if passretry in ('yes', 'Yes'): 
```

同样，`elif`应将以下内容更改为：-

```
elif passretry in ('no', 'No'): 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:39:59.587

这个条件：

```
if passretry == 'yes' or 'Yes': 
```

意思是“如果`passretry == 'yes'`是真的，或者`'Yes'`是真的”。 `'Yes'`始终为真，因为非空字符串算作真。这就是为什么您总是采用第一个代码路径。

你需要把事情说得更清楚一点：

```
if passretry == 'yes' or passretry == 'Yes': 
```

（或者让你的代码更通用一点：

```
if passretry.lower() == 'yes': 
```

这将允许人们大喊大叫`YES`。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T22:40:23.023

您需要另一个完整的声明：

```
passretry == 'yes' or passretry == 'Yes': 
```

字符串 'Yes' 的计算结果始终为 True。

# tcpdf - Tcpdf generating table in examples directory but in no other

> ID：14636451
> 
> 赞同：0
> 
> 时间：2013-01-31T22:38:25.880
> 
> 标签：tcpdf

So I downloaded tcpdf... read and went through the examples, all works fine.

I then copied the tables example to another directory, made sure all included file paths were changed so all files were successfully included.

but it won't generate any tables or lists via writeHtml()! what is going on?

EDIT: I copied the exact same file in the exact same examples directory but with a different name, and this makes it not display any tables...

# xcode - Detect Xcode Build/Run in Cocoa

> ID：14636468
> 
> 赞同：0
> 
> 时间：2013-01-31T22:39:55.403
> 
> 标签：xcode, cocoa

I was wondering if there was a way to detect a build or run in Xcode on a Cocoa app i.e. detect if the user of the app has built/run an xcode project?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-13T06:59:30.627

您可以为此使用@( **DATE** )。

```
NSString *versionText = [NSString stringWithFormat:"Version is %@",@(__DATE__)]; 
```

# linux - Linux - 在 CLI 中更改主机名

> ID：14636473
> 
> 赞同：10
> 
> 时间：2013-01-31T22:40:19.887
> 
> 标签：linux, command-line-interface, fedora

我不知道如何搜索这个，这就是我要求它的原因（我所有的搜索都没有显示任何相关信息）。

我有一个看起来像这样的 Fedora 18 服务器：

```
[root@dhcp-192-168-5-100 ~]# 
```

我想将其更改为：

```
[root@server1 ~]# 
```

目前，这台机器设置为通过 DHCP 获取 IP，但这不是机器的 IP 地址，这就是为什么我需要将 CLI 更改为更相关的东西。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-31T22:47:12.203

您可以键入“主机名 HOSTNAME”，其中 HOSTNAME 是您想要的新名称。下次您通过 ssh 登录/连接时，您会看到这样的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:49:32.733

1.  像这样编辑`/etc/sysconfig/network`和更改/添加 HOSTNAME 变量`HOSTNAME=server1.domain.com`重新启动后它应该有 server1。
2.  编辑 /etc/hosts 并将 and 添加`server1`到`server1.domain.com`127.0.0.1 行，所以它看起来像：`127.0.0.1 localhost.localdomain localhost server1 server1.domain.com`

有关网络文件的更多信息，您可以在此处阅读： [https ://docs.fedoraproject.org/en-US/Fedora/15/html/Deployment_Guide/ch-The_sysconfig_Directory.html#s2-sysconfig-network](https://docs.fedoraproject.org/en-US/Fedora/15/html/Deployment_Guide/ch-The_sysconfig_Directory.html#s2-sysconfig-network)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:49:16.303

刚刚发现这个，这描述得很好。

```
 [root@dhcp-192-168-5-100 ~]# hostname MYHOSTNAME 
```

[在 Feodora 中更改主机名](http://www.labtestproject.com/using_linux/permanently_change_hostname_on_fedora)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-12T00:09:16.523

1.  将“yournewhostname”添加到 /etc/sysconfig/network 的 HOSTNAME 字段中。
2.  将“yournewhostname”添加到 127.0.0.1 的 /etc/hosts
3.  echo "yournewhostname" > /proc/sys/kernel/hostname 或服务主机名

重要提示：注销并重新登录。

# jquery - Is it possible to adapt the width of a div that sticks to the left to always cover a div that is always centred?

> ID：14636474
> 
> 赞同：2
> 
> 时间：2013-01-31T22:40:21.727
> 
> 标签：jquery, css, html, sticky

I was able to do what I need to do with js, you can see it [here](http://jsfiddle.net/qgY98/7/), resize the window to see what I mean.

The code is:

```
$(window).resize(function() {
   var offset = $("#two").offset();
    $('#three').css('width',offset.left+320); 
}); 
```

The idea is that the red div is always "centered" but the part of the green div that overflows the read one (pointed with the arrow) is always the same:

![enter image description here](../Images/132d583dac2a92b450607d7ef041eaf1.png)

But it doesn't look that that good when you resize it, is it possible to this with only css? Or modify the js so that it looks more fluid?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:54:48.207

好吧，如果绿色 div 可能是绝对定位的，那么它的外部宽度需要是 50% + 红色 div 宽度的一半 + 你想要的固定额外宽度（红色 div 的右侧）：

```
#three{
    ...
    position: absolute;
    width:50%;
    padding-right:120px; /* half of 200 + 20 extra pixels */
} 
```

见[小提琴](http://jsfiddle.net/orig/qgY98/8/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T23:37:29.810

使用2个div，这是可以实现的。

现场示例：http: [//jsfiddle.net/RP24h/](http://jsfiddle.net/RP24h/)

**HTML 代码**

```
<div id="green"></div>
<div id="red">
    <div id="blue"></div>
</div> 
```

**CSS 代码**

```
body{ padding-top:60px;}
div{ height:100px;}
#green{ background:green; position:absolute; left:0; top:60px; width:50%;}
#red{ background:red; width:400px; margin:0 auto; position:relative;}
#blue{ background:blue; position:absolute; right:-20px; top:0; width:20px;} 
```

这里的想法是你像往常一样定位你的**红色，居中。****绿色**div 是绝对定位的，宽度为 50%，因此它始终从屏幕左侧开始（left:0;）并始终恰好在屏幕中间结束（width:50%;） . 但是因为**红色**div*总是居中，所以它隐藏了***绿色**div的右端。

**蓝色**div 在这里添加您想要的额外内容。只要确保正确的值正好是宽度的负值（这里是正确的：-20px；和宽度：20px；}。结果，红色和蓝色 div 之间永远不会有间隙，蓝色div 总是 20px 大。

# xml - System.Xml.Linq、便携式库和 Silverlight

> ID：14636478
> 
> 赞同：1
> 
> 时间：2013-01-31T22:40:44.130
> 
> 标签：xml, silverlight, silverlight-4.0, silverlight-5.0, portable-class-library

我构建了一个引用 System.Xml.Linq 的可移植类库（profile47，其中包括 Silverlight 5）。我可以从我的 Silverlight 5 应用程序中引用该可移植库，并且可以在 C:\Program Files (x86)\Microsoft SDKs\Silverlight\v5.0\Libraries\Client 中引用 System.Xml.Linq 的 Silverlight 版本。问题是 System.Xml.Linq dll 的版本号 (5.0.5.0) 与可移植库引用的版本号不同，当我运行 Silverlight 应用程序时，它会引发异常：

```
Could not load file or assembly 'System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. The system cannot find the file specified. 
```

由于 app.config 中没有像完整的 .NET 框架那样的程序集重定向机制，有什么方法可以使它工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T16:03:32.593

从可移植类库中删除 System.Xml.Linq 引用。如果您的配置文件中有 .net 框架 4.0.3，那么 .Net 可移植子集就足够了。

# ios - 如何正确编写此正则表达式代码片段？

> ID：14636480
> 
> 赞同：0
> 
> 时间：2013-01-31T22:40:49.963
> 
> 标签：ios, objective-c, regex

我正在尝试让 UIWebView 显示一些带有图像的文本。文本中有一些链接，例如：

> “我曾经养过一条鱼**`http://mysite.com/images/fish.jpg`**。我还养过一只小狗和一只公鸡**`http://mysite.com/images/dog.jpg`**”

会导致：

> **我曾经有一条鱼**

```
----------------------------------
|                                 |
|Fish Image From                  |
|http://mysite.com/images/fish.jpg|
|                                 |
|                                 |
---------------------------------- 
```

> **我还养了一只小狗和一只公鸡**

```
----------------------------------
|                                |
|dog Image From                  |
|http://mysite.com/images/dog.jpg|
|                                |
|                                |
----------------------------------
--------------------------------------
|                                    |
|rooster Image From                  |
|http://mysite.com/images/rooster.jpg|
|                                    |
|                                    |
--------------------------------------

    NSMutableString *mutableString = [[NSMutableString alloc] initWithFormat:@"<html><head></head><body>%@</body>",string];

    NSString *pattern = @"http://.+\\.(?:jpg|jpeg|png|gif|bmp)";
    NSString *replacement = @"<br /><img style=\"width:100%;height:auto;\" src=\"$1\"/><br />";
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:pattern           
                          options:0 error:NULL];
    [regex replaceMatchesInString:mutableString
                          options:0
                          range:NSMakeRange(0, mutableString.length)
                          withTemplate:replacement]; 
```

但是当我检查结果时，图像得到了这个：`<br /><img style="width:100%;height:auto;" src=""/><br />`并且链接消失了。

图像必须在哪里：

**文本...**
`<br /><img style="width:100%;height:auto;" src="http://mysite.com/images/fish.jpg"/><br />`

**文本...**

`<br /><img style="width:100%;height:auto;" src="http://mysite.com/images/dog.jpg"/><br />`

`<br /><img style="width:100%;height:auto;" src="http://mysite.com/images/rooster.jpg"/><br />`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:47:05.490

我认为`$1`要正常工作，您需要将匹配的模式放在一个组内，即 inside `()`。如何使用以下模式：

```
(http://.+\\.(?:jpg|jpeg|png|gif|bmp)) 
```

同样从模式中`.+`我吃掉整个字符串的部分。为了使其不那么贪婪，可以将其替换为`.+?`或更正确`\w.*?`地保持`+`原始模式的效果。

# handler - Deleting handler from pipeline

> ID：14636481
> 
> 赞同：0
> 
> 时间：2013-01-31T22:40:50.573
> 
> 标签：handler, netty, pipeline

I am trying to delete a certain handler from my handler pipeline, but I am having trouble doing it. When I list the handlers in the pipeline before and after, the handler that I tried to remove is still there. So what am I doing wrong here? Here is a code snippet. All of this is in the startup phase. You can see that last thing that I do is configure the pipeline factory. I am using Netty 3.6.1.final.

```
 List<String> handlers = new ArrayList<String>();

    // list handlers in the pipeline
    try {
        handlers = this.pipelineFactory.getPipeline().getNames();
        for (int len = handlers.size(), i = 0; i < len; i++) {
          String s = handlers.get(i);
          System.out.println("Item " + i + " is " + s);
        }

    } catch( Exception e ) {}

    try {
        System.out.println("Remove hexdump");
        this.pipelineFactory.getPipeline().remove("hexdump");
    } catch( Exception e ) {
       System.out.println("error = " + e.getMessage());
    }

    try {
        handlers = this.pipelineFactory.getPipeline().getNames();
        for (int len = handlers.size(), i = 0; i < len; i++) {
          String s = handlers.get(i);
          System.out.println("Item " + i + " is " + s);
        }

    } catch( Exception e ) {}

    // Configure the pipeline factory.
    this.bootstrap.setPipelineFactory(this.pipelineFactory); 
```

Here is the output:

```
Item 0 is framer
Item 1 is hexdump
Item 2 is handler
Remove hexdump
Item 0 is framer
Item 1 is hexdump    
Item 2 is handler 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T08:08:30.260

不确定不检查完整代码，但看起来 pipelineFactor.getPipeline() 将始终在您的情况下创建一个**新**管道。由于它是一个工厂，它每次都会创建处理程序。再添加一个`sysout`，`this.pipelineFactory.getPipeline()`如果您看到 3 个不同的对象哈希码，那么这就是根本原因。
解决方案可能是`pipeline = this.pipelineFactory.getPipeline()`，然后使用`pipeline`添加删除等。
另外，为了记录，无论如何它似乎是错误的用法，您应该从`ChannelHandlerContext`对象的`decode`方法或`messageReceived`处理程序的方法中获取管道。

# java - Flying Saucer 在生成的 PDF 中打印 EL 表达式而不是实际值

> ID：14636486
> 
> 赞同：0
> 
> 时间：2013-01-31T22:41:26.527
> 
> 标签：java, jsf, flying-saucer

我正在尝试使用飞碟从 xhtml 页面生成 PDF。我的相关代码如下。

pdf.xhtml 本身工作正常。

但是，如果我尝试使用 CreatePDF 支持 bean 方法创建 pdf，生成的 pdf 包含 EL 表达式 #{basvuruBean.sirketAdi} 而不是支持 bean 的 sirketadi 属性的输入值。支持 bean 是会话范围的。

我的代码有什么问题？

提前感谢您。

另一个使用支持 bean 从 jsf 页面生成 pdf 的库推荐？

作为生成 pdf 基础的 xhtml 页面：pdf.xhtml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
</h:head>
        <body>Sirket Adı: #{basvuruBean.sirketAdi}
</body>
</html> 
```

在 basvuruBean 支持 bean 中创建 PDF 方法

```
public void createPDF() {

            FacesContext facesContext = FacesContext.getCurrentInstance();
            ExternalContext externalContext = facesContext.getExternalContext();
            String servername = externalContext.getRequestServerName();
            String port = String.valueOf(externalContext.getRequestServerPort());
            String appname = externalContext.getRequestContextPath();
            String protocol = externalContext.getRequestScheme();
            HttpSession session = (HttpSession) externalContext.getSession(true);
            this.url = protocol + "://" + servername + ":" + port + appname + "/"+PDF_PAGE+";JSESSIONID=" + session.getId();
            try {
                ITextRenderer renderer = new ITextRenderer();
                renderer.setDocument(new URL(this.url).toString());
                renderer.layout();
                HttpServletResponse response = (HttpServletResponse) externalContext.getResponse();
                response.reset();
                response.setContentType("application/pdf");
                response.setHeader("Content-Disposition", "inline; filename=\"" + PDF_FILE_NAME + "\"");
                OutputStream browserStream = response.getOutputStream();
                renderer.createPDF(browserStream);

            } catch (Exception ex) {
                Logger.getLogger(BasvuruBean.class.getName()).log(Level.SEVERE, null, ex);
            }
            facesContext.responseComplete(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:11:46.620

That can happen if the request URL did not match the URL pattern of the `FacesServlet`. It's the one responsible for performing all the JSF/EL works. So, if you've mapped the Faces Servlet on an URL pattern of for example `*.jsf`, then you should point to `pdf.jsf`, not `pdf.xhtml`.

* * *

**Unrelated** to the concrete problem, the `jsessionid` path fragment must be in all lowercase.

# version-control - TFS 非 Windows 用户

> ID：14636487
> 
> 赞同：2
> 
> 时间：2013-01-31T22:41:30.273
> 
> 标签：version-control

如何将非 Windows 用户添加到我的 Team Foundation Server 2012 速成版？我们与一家外包公司合作，我们想要一个设置，在这里和外部的团队都可以访问 TFS 速成版。由于外部开发人员不是我们的域/Windows 用户，我正在努力将每个人都添加到项目中。任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:49:15.327

不确定 2012 年，但以前版本的 TFS 可以在工作组上管理。您需要为所有用户创建本地帐户。甚至域用户每次都需要进行身份验证。

[http://msdn.microsoft.com/en-us/library/ms252507.aspx](http://msdn.microsoft.com/en-us/library/ms252507.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T08:53:31.027

本地 TFS 仅支持 Windows 身份验证（本地或域）。

我建议您考虑为该项目使用 Team Foundation Service（云中的 TFS）。它目前是免费的，而是使用 Microsoft 真实帐户。

# c - 将指针初始化为在函数中动态分配的指针

> ID：14636489
> 
> 赞同：2
> 
> 时间：2013-01-31T22:41:39.223
> 
> 标签：c, pointers, realloc

当我试图存储从套接字接收的数据时，我正在将一个指针传递给一个函数以动态分配它。它适用于一个请求，第二个请求通常会导致段错误。Valgrind 抱怨：条件跳转或移动取决于引用我的响应指针的未初始化值。

我怎样才能初始化指针或者我能做些什么来保证它的安全？在主函数中释放它是否正确？

```
int main(int argc, char **argv) {
    char * response;
    char readbuf[BUFFSIZE + 1] = "";
    //here I read some data into readbuff which I will send to the server below
    handle_request_data(readbuf, &response);
    //do some stuff with response, send to another socket
    free(response); // can I do that?
}

int handle_request_data(char * readbuf, char ** response) {
    //create tcp socket, connect to it and send readbuf to server

    int recv_total = 0;
    char buffer[BUFFSIZE + 1] = "";
    *response = malloc(BUFFSIZE + 1);
    while ((tmpres = recv(sock_tcp, buffer, BUFFSIZE, 0)) > 0) {

        if (recv_total > 0) {
            //need more memory for buffer
            *response = realloc(*response, BUFFSIZE + recv_total + 1);
        }
        memcpy(*response + recv_total, buffer, tmpres);
        recv_total += tmpres;
    }
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:03:28.483

1) Q: 初始化指向在函数中动态分配的指针的指针

警告：您应该只在函数内部初始化一次指针。如果您在其他地方（重新）初始化它，您将面临内存泄漏或其他灾难的风险。

2）问：在main函数中free它是否正确？

当然 ：）。但同样的警告：只释放*一次*。而且，理想情况下，在释放它之后养成将它设置为 NULL 的习惯。

3) 问：它对第一个请求有效，第二个请求通常会导致 seg 错误。

我的猜测是您在代码中的某处*踩到了指针。*

问：“缓冲区”在哪里定义？你确定你没有在 recv() 中覆盖它（并破坏你的“响应”指针）吗？

问：段错误究竟发生在哪里？你能在调试器中单步调试那部分代码吗？

请发回你找到的东西！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:49:59.687

首先，最简单的：

> 在主函数中释放它是否正确？

为什么不呢？反正你什么也做不了。

其次，困难的部分：好吧，您应该尝试使用调试器调试您的代码。乍一看，这似乎很好，但我们永远不知道。你在使用多线程吗？您确定不存在竞争条件吗？等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:58:48.220

什么是缓冲区？内部`handle_request_data`未定义。全球？你的意思是 readbuf 吗？不使用该参数。

# java - 当我将数据从 InputStream 读取到 OutputStream 时，如何动态压缩数据？

> ID：14636493
> 
> 赞同：4
> 
> 时间：2013-01-31T22:41:53.303
> 
> 标签：java, gzip, inputstream

我有一个大`InputStream`的包含 gzip 的数据。

我无法直接修改 InputStream 中的数据。`InputStream`稍后使用它的代码需要未经修改的压缩数据。如果需要，我可以将其换成`InputStream`新`InputStream`的，但数据必须保持压缩状态。

`InputStream`出于调试目的，我需要打印出未压缩的内容。

将 my 中的未压缩数据打印`InputStream`到 a的最简单方法是什么`PrintStream`，而不是不可撤销地解压缩`InputStream`本身并且不将整个内容读入内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T01:31:49.923

这就是我的做法。

```
// http://stackoverflow.com/a/12107486/82156
public static InputStream wrapInputStreamAndCopyToOutputStream(InputStream in, final boolean gzipped, final OutputStream out) throws IOException {
    // Create a tee-splitter for the other reader.
    final PipedInputStream inCopy = new PipedInputStream();
    final TeeInputStream inWrapper = new TeeInputStream(in, new PipedOutputStream(inCopy));

    new Thread(Thread.currentThread().getName() + "-log-writer") {
        @Override
        public void run() {
            try {
                IOUtils.copy(gzipped ? new GZIPInputStream(inCopy) : inCopy, new BufferedOutputStream(out));
            } catch (IOException e) {
                Log.e(TAG, e);
            }
        }
    }.start();
    return inWrapper;
} 
```

此方法包装原始 InputStream 并返回包装器，从现在开始您需要使用它（不要使用原始 InputStream）。然后，它使用[Apache Commons TeeInputStream](http://commons.apache.org/io/api-2.4/org/apache/commons/io/input/TeeInputStream.html)使用线程将数据复制到 PipedOutputStream，并在此过程中可选地对其进行解压缩。

要使用，只需执行以下操作：

```
InputStream inputStream = ...; // your original inputstream
inputStream = wrapInputStreamAndCopyToOutputStream(inputStream,true,System.out); // wrap your inputStream and copy the data to System.out

doSomethingWithInputStream(inputStream); // Consume the wrapped InputStream like you were already going to do 
```

后台线程将一直存在，直到前台线程消耗整个输入流，以块的形式缓冲输出并定期将其写入 System.out 直到全部完成。

# javascript - 如何检查不存在的类？(getElementsByClassName)

> ID：14636500
> 
> 赞同：0
> 
> 时间：2013-01-31T22:42:20.730
> 
> 标签：javascript

```
arr = document.getElementsByClassName(type2);  // suppose type2 is not available in the dom - class = "some_class"
// check for empty 
```

此片段返回

[对象 HTMLCollection]

它的长度为 0。

这是在使用 getElementsByClassName 时检查类不存在的最佳方法，即只检查长度为 0 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:44:32.150

是的。检查`length`返回集合的属性。

* * *

由于`0`是假的，你可以这样做：

```
var type2 = 'some_class';
var noElementHasType2Class = ! document.getElementsByClassName(type2).length; 
```

# scala - 无法理解“作为参数的函数”递归

> ID：14636502
> 
> 赞同：2
> 
> 时间：2013-01-31T22:42:25.447
> 
> 标签：scala, recursion, functional-programming, sml, ml

我正在学习函数式编程语言课程，但在“作为参数的函数”的上下文中我很难理解递归

```
fun n_times(f , n , x) = 
    if n=0
    then x
    else f (n_times(f , n - 1 , x))

fun double x = x+x;

val x1 = n_times(double , 4 , 7);

the value of x1 = 112 
```

这将 'x' 'n' 倍加倍，因此 7 倍增 4 倍 = 112

我可以理解更简单的递归模式，例如在列表中添加数字或函数的“幂”，但我不明白这个函数“n_times”是如何通过调用自身来评估的？能解释一下这个函数是如何工作的吗？

我在学习这门课程时标记了 scala，以提高我对 scala（以及函数式编程）的理解，我认为这是一种常见的模式，所以可以提供建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T22:53:13.853

如果`n`为 0，`x`则返回。

否则，`f (n_times(f , n - 1 , x))`返回。

做什么`n_times`？它采用`f`with `x`、`n`times 或等效调用`f`的结果：以`n_times(f, n - 1, x)`(calling `f` `n-1`times on `x`) 的结果调用。

请注意，`f`我的意思是例如：

调用`f`3 次：`f(f(f(x)))`

调用`f`2 次：`f(f(x))`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T22:54:59.027

只需手动扩展。我要打电话`n_times` `nx`来节省空间。

核心操作是

```
nx(f, n, x) -> f( nx(f, n-1, x)) 
```

终止于

```
nx(f, 0, x) -> x 
```

所以，当然，

```
nx(f, 1, x) -> f( nx(f, 0, x) ) -> f( x )
nx(f, 2, x) -> f( nx(f, 1, x) ) -> f( f( x ) )
...
nx(f, n, x) -> f( nx(f,n-1,x) ) -> f( f( ... f( x ) ... ) ) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T22:57:33.007

函数`n_times`有一个基本案例 when`n = 0`和一个归纳案例，否则。您在归纳案例上递归，直到在基本案例上终止。

这是一个说明性的跟踪：

```
 n_times(double, 4, 7)
~> double (n_times(double, 3, 7)) (* n = 4 > 0, inductive case *)
~> double (double (n_times(double, 2, 7))) (* n = 3 > 0, inductive case *)
~> double (double (double (n_times(double, 1, 7)))) (* n = 2 > 0, inductive case *)
~> double (double (double (double (n_times(double, 0, 7))))) (* n = 1 > 0, inductive case *)
~> double (double (double (double 7))) (* n = 0, base case *)
~> double (double (double 14)) 
~> double (double 28)
~> double 56
~> 112 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T14:21:05.360

思考你已经知道的东西是相同的递归，只是混合了另一个概念：高阶函数。

n_times 得到一个函数 (f) 作为参数，因此 n_times 是一个高阶函数，它又能够在他的身体中应用这个 f 函数。实际上这是他的工作，将 fn 次应用于 x。

那么如何将 fn 次应用于 x 呢？好吧，如果你申请了 n-1 次

```
n_times(f , n - 1 , x) 
```

，然后你再申请一次。

```
f (n_times(f , n - 1 , x)) 
```

您必须像往常一样停止递归，即 x 的 n=0 情况。

# c# - C# Explicity 在 Process.Start() 上抛出错误

> ID：14636509
> 
> 赞同：0
> 
> 时间：2013-01-31T22:42:44.800
> 
> 标签：c#

我是 C# 初学者，我为游戏制作了一个小启动器并启动它，我正在使用这个按钮事件：

```
private void button5_MouseClick(object sender, MouseEventArgs e)
    {
        Process.Start("engine.exe", "/load /config debug");
        Application.Exit();
    } 
```

如您所见，这也使用 Application.Exit() 在游戏开始时关闭启动器，因为它们是分开的。

我想知道的是我的方法是否适合启动游戏+关闭启动器，而且，

我想知道当我单击按钮并且engine.exe 丢失时如何弹出消息“找不到Engine.exe”。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:46:32.753

```
try
{
    Process.Start("engine.exe", "/load /config debug");
    Application.Exit();    
}
catch(FileNotFoundException e)
{
   MessageBox.Show(e.Message);
} 
```

# ruby-on-rails - 未定义的局部变量或方法“sign_out”

> ID：14636510
> 
> 赞同：1
> 
> 时间：2013-01-31T22:42:48.047
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

当我单击退出链接时，即使该方法似乎存在，我也会收到以下错误。

```
NameError in SessionsController#destroy 
undefined local variable or method `sign_out' for #<SessionsController:0x007f87c8ecd8d8> 
```

这是我的代码，会话控制器

```
class SessionsController < ApplicationController

  def new
  end

  def create
     user = User.find_by_email(params[:session][:email].downcase)
     if user && user.authenticate(params[:session][:password])
        # Sign the user in and redirect to the user's show page.
     else
         flash.now[:error] = 'Invalid email/password combination' # Not quite right!
        render 'new'
     end
  end

  def destroy
    sign_out
   redirect_to root_url
  end
end 
```

会话助手

```
module SessionsHelper

  def sign_in(user)

    cookies.permanent[:remember_token] = user.remember_token
    self.current_user = user
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user

    @current_user ||= User.find_by_remember_token(cookies[:remember_token])

  end

  def signed_in?
    !current_user.nil?
  end

   def sign_out
     self.current_user = nil
     cookies.delete(:remember_token)end
end 
```

布局

```
<header class="navbar navbar-fixed-top navbar-inverse">
  <div class="navbar-inner">
    <div class="container">
      <%= link_to "sample app", root_path, id: "logo" %>
      <nav>
        <ul class="nav pull-right">
          <li><%= link_to "Home", root_path %></li>
          <li><%= link_to "Help", help_path %></li>
          <% if signed_in? %>
            <li><%= link_to "Users", '#' %></li>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Account <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><%= link_to "Profile", current_user %></li>
                <li><%= link_to "Settings", '#' %></li>
                <li class="divider"></li>
                <li>
                  <%= link_to "Sign out", signout_path, method: "delete" %>
                </li>
              </ul>
            </li>
          <% else %>
            <li><%= link_to "Sign in", signin_path %></li>
          <% end %>
        </ul>
      </nav>
    </div>
  </div>
</header> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:05:37.770

在会话控制器中包含会话助手。

```
class SessionsController < ApplicationController
  include SessionsHelper 
  ...
end 
```

如果您想让会话助手方法在所有控制器中可用，请将其添加到应用程序控制器而不是会话控制器中。

# vim - Vim 中 .gitignore 的语法高亮显示？

> ID：14636513
> 
> 赞同：7
> 
> 时间：2013-01-31T22:43:07.377
> 
> 标签：vim, syntax-highlighting, vim-syntax-highlighting

有人知道吗？标题中的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:46:02.977

您可以通过安装我相信的[Fugitive 插件来突出显示此语法。](https://github.com/tpope/vim-fugitive)如果不这样做，您可以安装[此语法文件](https://github.com/tpope/vim-git)。两者都出自 tpope，是您 Vim 武器库的绝佳补充。:)

# actionscript-3 - 流式传输 FLV 视频

> ID：14636515
> 
> 赞同：0
> 
> 时间：2013-01-31T22:43:09.437
> 
> 标签：actionscript-3, video, flv

我有 3 个正在流式传输的 flv 视频。第一个是介绍。然后第二个是在介绍结束后立即在介绍之后播放。第二个视频正在循环播放。一切似乎都很好。但有时当我加载 swf 时，它会从第二个视频开始。任何想法为什么？

```
import flash.events.MouseEvent
var nc:NetConnection = new NetConnection();
nc.connect(null);

var ns:NetStream = new NetStream(nc);
loader.vid.Video_1.attachNetStream(ns);

var listener:Object = new Object();
listener.onMetaData = function(evt:Object):void {};
ns.client = listener;

ns.play("video_1.flv");

ns.addEventListener(NetStatusEvent.NET_STATUS, NCListener);
function NCListener(e:NetStatusEvent){
if (e.info.code == "NetStream.Buffer.Empty") {
ns.play("video_2.flv");
}
};

loader.button_01.addEventListener(MouseEvent.CLICK, play_video_01);

loader.button_01.addEventListener(MouseEvent.ROLL_OVER, play_effect_01);

function play_video_01 (event:Event):void{

    ns.play("video_3.flv");
    loader.button_01_mc.gotoAndPlay (21);

}
function play_effect_01 (event:Event):void{

    loader.button_01_mc.gotoAndPlay (2);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T03:12:56.503

在您的代码中，第二个视频的播放由 message 触发`NetStream.Buffer.Empty`。由于多种原因以及视频播放结束时，可能会发送该消息。例如，当流式传输（我知道你没有这样做）时，`NetStream.Buffer.Empty`可以在出现网络问题时进行调度。这绝对是您的问题的原因，但不清楚为什么有时缓冲区空消息会立即发送。

我要做的第一件事是修改您的`NetStatusEvent`侦听器，以便它跟踪所有正在发送的消息。这样您就可以看到发生此问题时发生的事件顺序。

其次，您应该尝试使用另一条消息来触发第二个视频的播放。我不是 100% 确定，但我认为该消息`NetStream.Play.Stop`是您想要的（当到达视频结尾以及以编程方式停止播放时会发送该消息）。您从 a 获得的完整消息列表`NetStatusEvent`在[这里](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/NetStatusEvent.html#info)。

结合这两个建议，您的`NetStatusEvent`处理程序可能如下所示：

```
function NCListener(e:NetStatusEvent)
{
    var code:String = e.info.code;
    trace("code: ", code);
    if (code == "NetStream.Record.Stop"
        ns.play("video_2.flv");
} 
```

最后，您可能希望将其他事件侦听器添加到`NetStream`. 当问题发生时，它会发送一个`IOErrorEvent`和`AsyncErrorEvent`......也许你会得到其中一个。

# html - 为什么链接在新标签页中打开，但在当前标签页中没有？

> ID：14636516
> 
> 赞同：0
> 
> 时间：2013-01-31T22:43:14.663
> 
> 标签：html, google-chrome, browser

我的页面上有以下链接。该链接指向一个内部地址。

```
<a href="internal_address"> Add XYZ and do ABC</a> 
```

当我点击链接时，什么也没有发生。浏览器显示加载图标，但停留在当前页面上。如果我右键单击链接并说在新选项卡中打开，则链接会在新选项卡中完美打开。这是什么原因？我该如何调试呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-09T13:44:11.813

您需要设置超链接元素的目标

```
<a href="internal_address" target="_blank"> Add XYZ and do ABC</a> 
```

另一个示例（如果直接复制到 HTML 文件中将起作用）

```
<a href="http:\\www.google.co.uk" target="_blank">Goto Google</a> 
```

# java - MulticastSocket.receive 永远不会返回

> ID：14636519
> 
> 赞同：1
> 
> 时间：2013-01-31T22:43:19.287
> 
> 标签：java, multicast

我正在尝试使用 java 开发一个多播应用程序。这是我的代码：

这是 Lamport.Java 文件：

```
package dsass2;
import java.net.*;
import java.io.*;
public class Lamport
{
static int Current_Time;
static int Time_Interval;
static String Multicast_Group;
static int port;
static MulticastSocket s;

static public int SendMsg(byte[] sending)
{
    DatagramPacket pack;
    try{
        pack = new DatagramPacket(sending, sending.length,InetAddress.getByName(Multicast_Group), port);
    }
    catch(UnknownHostException uhe){
        System.out.println("UnknownHostException Occured in SendMsg! "+uhe);
        return 0;
    }
    try{
        s.send(pack);
    }
    catch(IOException io){
        System.out.println("IOException Occured in SendMsg! "+io);
    }
    catch(NullPointerException npe){
       System.out.println("You Must Initialize Lamport Logical Clock First! ");
       return 0;
    }
    return 1;
}

static public int RecvMsg(byte[] recived)
{
   DatagramPacket pack = new DatagramPacket(recived, recived.length);
   try{

       s.receive(pack);
   }
   catch(IOException io){
       System.out.println("IOException Ocurred in RecvMsg! " + io);
       return 0;
   }
   catch(NullPointerException npe){
       System.out.println("You Must Initialize Lamport Logical Clock First! ");
       return 0;
   }
   return 1;
}

static public int Initialize(String mcastip, int port, int timeinterval)
{
    try{
    s=new MulticastSocket(port);
    }
    catch(IOException io)
    {
        System.out.println("IOException Ocurred in Initialize! " + io);
    }
    try{
        s.joinGroup(InetAddress.getByName(mcastip));
    }
    catch(UnknownHostException uhe){
         System.out.println("UnknownHostException Ocurred in Initialize! " + uhe);
    }
    catch(IOException io){
        System.out.println("IOException Ocurred in Initialize! " + io);
    }
    Multicast_Group=mcastip;
    Time_Interval=timeinterval;
    Thread Logical_Clock = new Thread(Clock_Incrementer);
    Logical_Clock.start();
    return 1;//it means no error occured.
}

static public int GetCurrentClock()
{
    return Current_Time;
}

Lamport () //Cunstructor
{
    Current_Time=0;
}

static Runnable Clock_Incrementer=new Runnable()
{
    public void run()
    {
        while(true){
            Current_Time+=Time_Interval;
              try{
                  Thread.sleep(1000);
              }
              catch(InterruptedException ie){
                  System.out.println("Logical Clock thread interrupted! " + ie);
              }
        }
    }
};
} 
```

这是我的 main.java 文件：

```
package dsass2;
import java.util.Scanner;

public class Main {
public static void main(String[] args){
    Scanner user_input=new Scanner(System.in);

    int voroodi=0;

    byte[] message=new byte[1024];

    while(voroodi!=5){

        System.out.println("What do you want to do?\n1\. Initialize Lamport Logical Clock\n2\. Send a message\n3\. Recieve a message\n4\. Get Current Clock\n5.Exit From Program");

        voroodi=Integer.parseInt(user_input.next());

        switch(voroodi){
            case 1:
                System.out.println("Please Enter Multicast Group IP:");
                String group=user_input.next();
                System.out.println("Please Enter Port Number:");
                int port=Integer.parseInt(user_input.next());
                System.out.println("Please Enter Time interval:");
                Lamport.Initialize(group, port, Integer.parseInt(user_input.next()));
                break;
            case 2:
                System.out.println("Please Enter Your Message:");
                String Msg=user_input.next();
                Lamport.SendMsg(Msg.getBytes());
                break;
            case 3:
                System.out.println("Please Wait for a Message...");
                if(Lamport.RecvMsg(message)==1)
                {
                    System.out.println("New Message Recieved:");
                    System.out.println(message.toString());
                }
                break;
            case 4:
                System.out.printf("Current Time is: %d\n", Lamport.GetCurrentClock());
                break;
            case 5:
                System.exit(0);
                break;
            default:
                System.exit(0);
                break;
        }
    }
    System.exit(0);
}
} 
```

初始化后，当我尝试从一台计算机（ip：192.168.1.2）向局域网中的另一台计算机（IP：192.168.1.3）发送数据包时，消息发送成功，但“s.receive（pack）;” RecvMsg 函数中的命令不返回，并永远阻止程序。我在 IP 为 192.168.1.3 的计算机上使用了 wireshark，**我可以看到数据包传输到目标计算机！**，所以可能没有防火墙，或者......问题。谁能帮忙？

# css - 将父 div 对齐到具有左对齐子元素的响应页面的中心

> ID：14636522
> 
> 赞同：2
> 
> 时间：2013-01-31T22:43:32.757
> 
> 标签：css

我有一个包含此部分的响应页面：

```
<div id="team">
    <div class="person">
        <div class="photo"></div> 
        <div class="title"></div> 
    </div>
    <div class="person">
        <div class="photo"></div> 
        <div class="title"></div> 
    </div>
    <div class="person">
        <div class="photo"></div> 
        <div class="title"></div> 
    </div>
    <div class="person">
        <div class="photo"></div> 
        <div class="title"></div> 
    </div>
    <div class="person">
        <div class="photo"></div> 
        <div class="title"></div> 
    </div>
</div> 

#team {
    width: 100%;
    margin: 0 auto;
}
#team .person { 
    display: inline-block;
    text-align: left;
    cursor: default;
    margin: 0 3em;
} 
```

`team`有 100% 的宽度。我需要对齐`team`到页面的中心取决于页面宽度。但是孩子`person`应该在`team`. 所以当我们有一些`person`没有填满一行时，它应该向左对齐。你能帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:58:01.573

`margin: 0 auto;`真的只适用于固定宽度的元素。您不能期望设置为 100% 宽度的 div 以它为中心。

如果您想将 的内容居中`#team`，您可以简单地应用`text-align: center;`。这将适用于您的`.person`div，因为您将它们设置为`display: inline-block;`

看看`text-align: center;`这里的结果，看看它是否是你要找的：http: [//jsfiddle.net/Chs9X/](http://jsfiddle.net/Chs9X/)

# rabbitmq - 为什么 celery 会向 rabbitmq 添加数千个队列，这些队列在任务完成后似乎仍然存在很长时间？

> ID：14636534
> 
> 赞同：21
> 
> 时间：2013-01-31T22:44:38.270
> 
> 标签：rabbitmq, celery

我正在使用带有rabbitmq后端的芹菜。它在 rabbitmq 中生成了数千个队列，其中包含 0 或 1 个项目，如下所示：

```
$ sudo rabbitmqctl list_queues
Listing queues ...
c2e9b4beefc7468ea7c9005009a57e1d        1
1162a89dd72840b19fbe9151c63a4eaa        0
07638a97896744a190f8131c3ba063de        0
b34f8d6d7402408c92c77ff93cdd7cf8        1
f388839917ff4afa9338ef81c28aad75        0
8b898d0c7c7e4be4aa8007b38ccc00ea        1
3fb4be51aaaa4ac097af535301084b01        1 
```

这似乎效率低下，但我进一步观察到，这些队列在处理完成后会持续很长时间。

我发现似乎正在执行此操作的任务：

```
@celery.task(ignore_result=True)
def write_pages(page_generator):  
    g = group(render_page.s(page) for page in page_generator)
    res = g.apply_async()

    for rendered_page in res:
        print rendered_page # TODO: print to file 
```

似乎因为这些任务是在一个组中调用的，所以它们被放入队列中但从未被释放。但是，我显然正在消耗结果（因为我可以在迭代时查看它们正在打印`res`。所以，我不明白为什么这些任务会保留在队列中。

此外，我想知道正在创建的大量队列是否表明我做错了什么。

感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-01T00:52:07.003

带有 AMQP 后端的 Celery 会将任务墓碑（结果）存储在以产生结果的任务 ID 命名的 AMQP 队列中。即使在结果耗尽后，这些队列也会持续存在。

几个建议：

*   将 ignore_result=True 应用于您可以执行的每项任务。不要依赖其他任务的结果。
*   切换到不同的后端（也许 Redis ——它更有效）：[http ://docs.celeryproject.org/en/latest/userguide/tasks.html](http://docs.celeryproject.org/en/latest/userguide/tasks.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-30T13:50:51.097

使用`CELERY_TASK_RESULT_EXPIRES`（或在 4.1 上`CELERY_RESULT_EXPIRES`）定期清理任务从 rabbitmq 中删除旧数据。

[http://docs.celeryproject.org/en/master/userguide/configuration.html#std:setting-result_expires](http://docs.celeryproject.org/en/master/userguide/configuration.html#std:setting-result_expires)

# javascript - 如何在 JavaScript 中检查变量是否为整数？

> ID：14636536
> 
> 赞同：467
> 
> 时间：2013-01-31T22:44:45.403
> 
> 标签：javascript

如何在 JavaScript 中检查变量是否为整数，如果不是则抛出警报？我试过这个，但它不起作用：

```
<html>
    <head>
        <script type="text/javascript">
            var data = 22;
            alert(NaN(data));
        </script>
    </head>
</html> 
```

* * *

## 回答 #1

> 赞同：559
> 
> 时间：2013-02-10T02:28:15.830

这取决于，您是否也想将字符串转换为潜在整数？

这将做：

```
function isInt(value) {
  return !isNaN(value) && 
         parseInt(Number(value)) == value && 
         !isNaN(parseInt(value, 10));
} 
```

### 使用按位运算

简单的解析和检查

```
function isInt(value) {
  var x = parseFloat(value);
  return !isNaN(value) && (x | 0) === x;
} 
```

短路并保存解析操作：

```
function isInt(value) {
  if (isNaN(value)) {
    return false;
  }
  var x = parseFloat(value);
  return (x | 0) === x;
} 
```

或者也许两者合二为一：

```
function isInt(value) {
  return !isNaN(value) && (function(x) { return (x | 0) === x; })(parseFloat(value))
} 
```

测试：

```
isInt(42)        // true
isInt("42")      // true
isInt(4e2)       // true
isInt("4e2")     // true
isInt(" 1 ")     // true
isInt("")        // false
isInt("  ")      // false
isInt(42.1)      // false
isInt("1a")      // false
isInt("4e2a")    // false
isInt(null)      // false
isInt(undefined) // false
isInt(NaN)       // false 
```

这是小提琴：http: [//jsfiddle.net/opfyrqwp/28/](http://jsfiddle.net/opfyrqwp/28/)

### 表现

测试表明短路解决方案具有最佳性能 (ops/sec)。

```
// Short-circuiting, and saving a parse operation
function isInt(value) {
  var x;
  if (isNaN(value)) {
    return false;
  }
  x = parseFloat(value);
  return (x | 0) === x;
} 
```

这是一个基准：http: [//jsben.ch/#/htLVw](http://jsben.ch/#/htLVw)

如果您喜欢更短、更钝的短路形式：

```
function isInt(value) {
  var x;
  return isNaN(value) ? !1 : (x = parseFloat(value), (0 | x) === x);
} 
```

当然，我建议让 minifier 来解决这个问题。

* * *

## 回答 #2

> 赞同：377
> 
> 时间：2013-01-31T22:54:23.497

使用 === 运算符（[严格相等](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Identity_strict_equality_())），如下所示，

```
if (data === parseInt(data, 10))
    alert("data is integer")
else
    alert("data is not an integer") 
```

* * *

## 回答 #3

> 赞同：129
> 
> 时间：2014-12-11T14:06:25.620

`Number.isInteger()`似乎是要走的路。

MDN 还为不支持的浏览器提供了以下 polyfill `Number.isInteger()`，主要是所有版本的 IE。

[链接到 MDN 页面](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger)

```
Number.isInteger = Number.isInteger || function(value) {
    return typeof value === "number" && 
           isFinite(value) && 
           Math.floor(value) === value;
}; 
```

* * *

## 回答 #4

> 赞同：128
> 
> 时间：2013-01-31T23:00:42.970

假设您对所讨论的变量一无所知，您应该采用这种方法：

```
if(typeof data === 'number') {
    var remainder = (data % 1);
    if(remainder === 0) {
        // yes, it is an integer
    }
    else if(isNaN(remainder)) {
        // no, data is either: NaN, Infinity, or -Infinity
    }
    else {
        // no, it is a float (still a number though)
    }
}
else {
    // no way, it is not even a number
} 
```

简而言之：

```
if(typeof data==='number' && (data%1)===0) {
    // data is an integer
} 
```

* * *

## 回答 #5

> 赞同：78
> 
> 时间：2013-01-31T22:53:17.473

您可以检查该数字是否有余数：

```
var data = 22;

if(data % 1 === 0){
   // yes it's an integer.
} 
```

请注意，如果您的输入也可以是文本并且您想先检查它不是，那么您可以先检查类型：

```
var data = 22;

if(typeof data === 'number'){
     // yes it is numeric

    if(data % 1 === 0){
       // yes it's an integer.
    }
} 
```

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2014-11-09T02:24:50.693

您可以使用一个简单的正则表达式：

```
function isInt(value) {
    var er = /^-?[0-9]+$/;
    return er.test(value);
} 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2019-06-02T09:29:36.260

在**ES6**中，为 Number Object 添加了 2 个新方法。

如果参数是整数，则Number.isInteger **()**方法在其中**返回 true ，否则返回 false。**

**重要提示：**对于可以表示为整数的浮点数，该方法也将返回 true。例如： 5.0 （因为它完全等于 5 ）

示例用法：

```
Number.isInteger(0);         // true
Number.isInteger(1);         // true
Number.isInteger(-100000);   // true
Number.isInteger(99999999999999999999999); // true

Number.isInteger(0.1);       // false
Number.isInteger(Math.PI);   // false

Number.isInteger(NaN);       // false
Number.isInteger(Infinity);  // false
Number.isInteger(-Infinity); // false
Number.isInteger('10');      // false
Number.isInteger(true);      // false
Number.isInteger(false);     // false
Number.isInteger([1]);       // false

Number.isInteger(5.0);       // true
Number.isInteger(5.000000000000001); // false
Number.isInteger(5.0000000000000001); // true 
```

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2013-01-31T22:49:09.680

首先，NaN 是一个“数字”（是的，我知道这很奇怪，随它去吧），而不是一个“函数”。

您需要检查变量的类型是否为数字，并检查整数我会使用模数。

```
alert(typeof data === 'number' && data%1 == 0); 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2014-05-18T12:43:48.580

**使用时要小心**

> 人数 % 1

空字符串 ('') 或布尔值（真或假）将作为整数返回。你可能不想这样做

```
false % 1 // true
'' % 1 //true 
```

## Number.isInteger(数据)

```
Number.isInteger(22); //true
Number.isInteger(22.2); //false
Number.isInteger('22'); //false 
```

在浏览器中构建函数。Dosnt 支持旧版浏览器

**备择方案：**

```
Math.round(num)=== num 
```

但是，对于空字符串和布尔值，Math.round() 也会失败

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2014-07-29T13:10:21.463

要检查像海报这样的整数是否需要：

```
if (+data===parseInt(data)) {return true} else {return false} 
```

注意数据前面的+（将字符串转换为数字），=== 表示精确。

以下是示例：

```
data=10
+data===parseInt(data)
true

data="10"
+data===parseInt(data)
true

data="10.2"
+data===parseInt(data)
false 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-03-31T06:09:04.363

最简单和最干净的 pre-ECMAScript-6 解决方案（即使将字符串或 null 等非数字值传递给函数，它也足够强大以返回 false）如下：

```
function isInteger(x) { return (x^0) === x; } 
```

以下解决方案也可以使用，尽管不如上面的解决方案那么优雅：

```
function isInteger(x) { return Math.round(x) === x; } 
```

**请注意**，在上述实现中，Math.ceil() 或 Math.floor() 可以同样有效地使用（而不是 Math.round()）。

或者：

```
function isInteger(x) { return (typeof x === 'number') && (x % 1 === 0); } 
```

一种相当常见的错误解决方案如下：

```
function isInteger(x) { return parseInt(x, 10) === x; } 
```

虽然这种基于 parseInt 的方法适用于许多 x 值，但一旦 x 变得相当大，它将无法正常工作。问题是 parseInt() 在解析数字之前将其第一个参数强制转换为字符串。因此，一旦数字变得足够大，它的字符串表示就会以指数形式呈现（例如，1e+21）。因此，parseInt() 将尝试解析 1e+21，但在到达 e 字符时将停止解析，因此返回值 1。观察：

```
> String(1000000000000000000000)
'1e+21'

> parseInt(1000000000000000000000, 10)
1

> parseInt(1000000000000000000000, 10) === 1000000000000000000000
false 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2018-06-06T04:04:50.433

为什么没有人提到`Number.isInteger()`？

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger)

对我来说非常有效，并解决了`NaN`以数字开头的问题。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2016-10-14T14:41:20.563

```
if(Number.isInteger(Number(data))){
    //-----
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-01-31T22:47:44.863

检查变量是否等于舍入为整数的同一个变量，如下所示：

```
if(Math.round(data) != data) {
    alert("Variable is not an integer!");
} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-10-23T12:36:48.740

ECMA-262 6.0 (ES6) 标准包括[Number.isInteger](http://www.ecma-international.org/ecma-262/6.0/#sec-number.isinteger)函数。

为了增加对旧浏览器的支持，我强烈建议使用强大且社区支持的解决方案：

[https://github.com/paulmillr/es6-shim](https://github.com/paulmillr/es6-shim)

这是纯*ES6 JS polyfills 库*。

请注意，此库需要 es5-shim，只需遵循 README.md。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-02-26T19:02:05.683

你可以使用这个功能：

```
function isInteger(value) {
    return (value == parseInt(value));
} 
```

即使该值是包含整数值的字符串，它也会返回 true。
因此，结果将是：

```
alert(isInteger(1)); // true
alert(isInteger(1.2)); // false
alert(isInteger("1")); // true
alert(isInteger("1.2")); // false
alert(isInteger("abc")); // false 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-10-28T18:08:46.727

使用`|`运算符：

```
(5.3 | 0) === 5.3 // => false
(5.0 | 0) === 5.0 // => true 
```

因此，测试函数可能如下所示：

```
var isInteger = function (value) {
  if (typeof value !== 'number') {
    return false;
  }

  if ((value | 0) !== value) {
    return false;
  }

  return true;
}; 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2016-10-27T03:59:30.010

您可以尝试`Number.isInteger(Number(value))`if`value`可能是字符串形式的整数，例如`var value = "23"`，并且您希望它评估为`true`. 避免尝试`Number.isInteger(parseInt(value))`，因为这并不总是返回正确的值。例如，如果`var value = "23abc"`您使用该`parseInt`实现，它仍然会返回 true。

但是，如果您想要严格的整数值，那么可能`Number.isInteger(value)`应该做到这一点。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2017-06-09T16:29:05.303

```
var x = 1.5;
if(!isNaN(x)){
 console.log('Number');
 if(x % 1 == 0){
   console.log('Integer');
 }
}else {
 console.log('not a number');
} 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2018-09-07T13:51:35.817

## 我的做法：

`a >= 1e+21`→ 只*通过*非常大的数字。与本讨论中提供的其他解决方案不同，这肯定会涵盖所有情况。

`a === (a|0)`→ 如果给定函数的参数与按位转换后的值*完全相同*(===)，则表示参数是整数。

`a|0`→ 返回`0`任何*不是数字的值*`a`，如果确实是数字，它将去除小数点后的任何内容，因此将变为*`a``1.0001``1`*

 *```
function isInteger(a){
    return a >= 1e+21 ? true : a === (a|0)
}

/// tests ///////////////////////////
[
  1,                        // true
  1000000000000000000000,   // true
  4e2,                      // true
  Infinity,                 // true
  1.0,                      // true
  1.0000000000001,          // false
  0.1,                      // false
  "0",                      // false
  "1",                      // false
  "1.1",                    // false
  NaN,                      // false
  [],                       // false
  {},                       // false
  true,                     // false
  false,                    // false
  null,                     // false
  undefined                 // false
].forEach( a => console.log(typeof a, a, isInteger(a)) )
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2021-02-10T21:14:53.720

## 大整数 ( `bigint`) 呢？

大多数这些答案在大整数（2 ^(53)和更大）上失败：按位测试（例如`(x | 0) === x`）、测试`typeof x === 'number'`、常规 int 函数（例如`parseInt`）、常规算术在大整数上失败。这可以通过使用来解决[`BigInt`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt)。

我已将几个答案编译成一个片段以显示结果。大多数大整数完全失败，而其他工作，除非通过类型`BigInt`（例如`1n`）。我没有包括重复的答案，也遗漏了任何允许小数或不尝试测试类型的答案）

```
// these all fail
n = 1000000000000000000000000000000
b = 1n

// These all fail on large integers
//https://stackoverflow.com/a/14636652/3600709
console.log('fail',1,n === parseInt(n, 10))
//https://stackoverflow.com/a/14794066/3600709
console.log('fail',2,!isNaN(n) && parseInt(Number(n)) == n && !isNaN(parseInt(n, 10)))
console.log('fail',2,!isNaN(n) && (parseFloat(n) | 0) === parseFloat(n))
console.log('fail',2,!isNaN(n) && (function(x) { return (x | 0) === x; })(parseFloat(n)))
//https://stackoverflow.com/a/21742529/3600709
console.log('fail',3,n == ~~n)
//https://stackoverflow.com/a/28211631/3600709
console.log('fail',4,!isNaN(n) && parseInt(n) == parseFloat(n))
//https://stackoverflow.com/a/41854178/3600709
console.log('fail',5,String(parseInt(n, 10)) === String(n))

// These ones work for integers, but not BigInt types (e.g. 1n)
//https://stackoverflow.com/a/14636725/3600709
console.log('partial',1,typeof n==='number' && (n%1)===0) // this one works
console.log('partial',1,typeof b==='number' && (b%1)===0) // this one fails
//https://stackoverflow.com/a/27424770/3600709
console.log('partial',2,Number.isInteger(n)) // this one works
console.log('partial',2,Number.isInteger(b)) // this one fails
//https://stackoverflow.com/a/14636638/3600709
console.log('partial',3,n % 1 === 0)
console.log('partial',3,b % 1 === 0) // gives uncaught type on BigInt
```

### 检查类型

如果您确实想测试传入值的类型以确保它是整数，请改用：

```
function isInt(value) {
    try {
        BigInt(value)
        return !['string','object','boolean'].includes(typeof value)
    } catch(e) {
        return false
    }
} 
```

```
function isInt(value) {
    try {
        BigInt(value)
        return !['string','object','boolean'].includes(typeof value)
    } catch(e) {
        return false
    }
}

console.log('--- should be false')
console.log(isInt(undefined))
console.log(isInt(''))
console.log(isInt(null))
console.log(isInt({}))
console.log(isInt([]))
console.log(isInt(1.1e-1))
console.log(isInt(1.1))
console.log(isInt(true))
console.log(isInt(NaN))
console.log(isInt('1'))
console.log(isInt(function(){}))
console.log(isInt(Infinity))

console.log('--- should be true')
console.log(isInt(10))
console.log(isInt(0x11))
console.log(isInt(0))
console.log(isInt(-10000))
console.log(isInt(100000000000000000000000000000000000000))
console.log(isInt(1n))
```

* * *

### 不检查类型

如果您不关心传入的类型是否实际上是布尔值、字符串等转换为数字，那么只需使用以下内容：

```
function isInt(value) {
    try {
        BigInt(value)
        return true
    } catch(e) {
        return false
    }
} 
```

```
function isInt(value) {
    try {
        BigInt(value)
        return true
    } catch(e) {
        return false
    }
}

console.log('--- should be false')
console.log(isInt(undefined))
console.log(isInt(null))
console.log(isInt({}))
console.log(isInt(1.1e-1))
console.log(isInt(1.1))
console.log(isInt(NaN))
console.log(isInt(function(){}))
console.log(isInt(Infinity))

console.log('--- should be true')
console.log(isInt(10))
console.log(isInt(0x11))
console.log(isInt(0))
console.log(isInt(-10000))
console.log(isInt(100000000000000000000000000000000000000))
console.log(isInt(1n))
// gets converted to number
console.log(isInt(''))
console.log(isInt([]))
console.log(isInt(true))
console.log(isInt('1'))
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2015-12-25T08:17:33.520

此外，`Number.isInteger()`. 也许是使用 ES6 指定的[另](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isSafeInteger)`Number.isSafeInteger()`一种选择。

在`Number.isSafeInteger(..)`ES6 之前的浏览器中进行 polyfill：

```
Number.isSafeInteger = Number.isSafeInteger || function(num) {
    return typeof num === "number" && 
           isFinite(num) && 
           Math.floor(num) === num &&
           Math.abs( num ) <= Number.MAX_SAFE_INTEGER;
}; 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-01-18T05:49:55.113

`Number.isInteger()`如果您的浏览器支持它是最好的方法，如果没有，我认为有很多方法可以去：

```
function isInt1(value){
  return (value^0) === value
} 
```

或者：

```
function isInt2(value){
  return (typeof value === 'number') && (value % 1 === 0); 
} 
```

或者：

```
function isInt3(value){
  return parseInt(value, 10) === value; 
} 
```

或者：

```
function isInt4(value){
  return Math.round(value) === value; 
} 
```

现在我们可以测试结果：

```
var value = 1
isInt1(value)   // return true
isInt2(value)   // return true
isInt3(value)   // return true
isInt4(value)   // return true

var value = 1.1
isInt1(value)   // return false
isInt2(value)   // return false
isInt3(value)   // return false
isInt4(value)   // return false

var value = 1000000000000000000
isInt1(value)   // return false
isInt2(value)   // return true
isInt3(value)   // return false
isInt4(value)   // return true

var value = undefined
isInt1(value)   // return false
isInt2(value)   // return false
isInt3(value)   // return false
isInt4(value)   // return false

var value = '1' //number as string
isInt1(value)   // return false
isInt2(value)   // return false
isInt3(value)   // return false
isInt4(value)   // return false 
```

因此，所有这些方法都是可行的，但是当数量很大时，parseInt 和 ^ 运算符就无法正常工作。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-11-18T17:33:50.297

试试这个：

```
let number = 5;
if (Number.isInteger(number)) {
    //do something
} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2020-08-20T09:15:33.937

“接受”的答案是错误的（正如下面的一些评论指出的那样）。这种修改可以使它工作：

```
if (data.toString() === parseInt(data, 10).toString())
    alert("data is a valid integer")
else
    alert("data is not a valid integer") 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2014-02-11T12:13:10.200

您可以为此使用正则表达式：

```
function isInteger(n) {
    return (typeof n == 'number' && /^-?\d+$/.test(n+''));
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2014-02-12T23:53:36.227

```
function isInteger(argument) { return argument == ~~argument; } 
```

用法：

```
isInteger(1);     // true<br>
isInteger(0.1);   // false<br>
isInteger("1");   // true<br>
isInteger("0.1"); // false<br> 
```

**或者：**

```
function isInteger(argument) { return argument == argument + 0 && argument == ~~argument; } 
```

用法：

```
isInteger(1);     // true<br>
isInteger(0.1);   // false<br>
isInteger("1");   // false<br>
isInteger("0.1"); // false<br> 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2014-10-02T12:20:54.607

来自[http://www.toptal.com/javascript/interview-questions](http://www.toptal.com/javascript/interview-questions)：

```
function isInteger(x) { return (x^0) === x; } 
```

发现这是最好的方法。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2015-06-09T09:48:39.380

这将解决另一个场景（**121.**），最后一个点

```
function isInt(value) {
        var ind = value.indexOf(".");
        if (ind > -1) { return false; }

        if (isNaN(value)) {
            return false;
        }

        var x = parseFloat(value);
        return (x | 0) === x;

    } 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2015-06-25T15:44:12.653

对于没有分隔符的正整数值：

```
return ( data !== '' && data === data.replace(/\D/, '') ); 
```

测试 1\. 如果不为空和 2\. 如果 value 等于在其 value 中替换 non-digit char 的结果。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2018-10-11T17:56:01.877

你也可以这样试试

```
var data = 22;
if (Number.isInteger(data)) {
    console.log("integer");
 }else{
     console.log("not an integer");
 } 
```

或者

```
if (data === parseInt(data, 10)){
    console.log("integer");
}else{
    console.log("not an integer");
} 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2021-08-24T18:05:31.523

接受的答案对我不起作用，因为我需要检查 int/float 和字母表。所以试试这个对 int/float 和字母检查都有效

```
function is_int(value){
        if( (parseInt(value) % 1 === 0 )){
            return true;
        }else{
            return false;
        }
} 
```

**用法**

```
is_int(44);   // true
is_int("44");   // true
is_int(44.55);  // true
is_int("44.55");  // true
is_int("aaa");  // false 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2015-01-29T09:55:46.333

我必须检查变量（字符串或数字）是否为整数，我使用了这个条件：

```
function isInt(a){
    return !isNaN(a) && parseInt(a) == parseFloat(a);
} 
```

[http://jsfiddle.net/e267369d/1/](http://jsfiddle.net/e267369d/1/)

其他一些答案有类似的解决方案（依靠与`parseFloat`结合`isNaN`），但我的应该更直接和自我解释。

* * *

编辑：我发现我的方法对于包含逗号的字符串（如“1,2”）失败，我还意识到，在我的特殊情况下，如果字符串不是有效的整数，我希望函数失败（应该在任何浮点数上失败，甚至 1.0)。所以这是我的功能 Mk II：

```
function isInt(a){
    return !isNaN(a) && parseInt(a) == parseFloat(a) && (typeof a != 'string' || (a.indexOf('.') == -1 && a.indexOf(',') == -1));
} 
```

[http://jsfiddle.net/e267369d/3/](http://jsfiddle.net/e267369d/3/)

当然，如果您确实需要该函数来接受整数浮点数（1.0 的东西），您可以随时删除点条件`a.indexOf('.') == -1`。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2016-03-30T20:02:59.500

Lodash [https://lodash.com/docs#isInteger](https://lodash.com/docs#isInteger)（自 4.0.0 起）具有检查变量是否为整数的功能：

```
_.isInteger(3);
// → true

_.isInteger(Number.MIN_VALUE);
// → false

_.isInteger(Infinity);
// → false

_.isInteger('3');
// → false 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2017-01-25T14:32:00.047

在几次成功和失败之后，我想出了这个解决方案：

```
const isInt = (value) => {
  return String(parseInt(value, 10)) === String(value)
} 
```

我喜欢上面检查值是否不是 NaN 并使用 parseFloat 的想法，但是当我在 React 基础架构中尝试它时，由于某种原因它不起作用。

编辑：我找到了一种不使用字符串的更好方法：

```
var isInt = function (str) {
  return str === '0' || !!~~str;
} 
```

我认为这是最短的答案。甚至可能是最有效的，但我可以得到纠正。:)

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2017-12-20T12:11:03.983

好的，减去了，原因没有描述我的例子，所以更多的例子:)：

我使用正则表达式和测试方法：

```
var isInteger = /^[0-9]\d*$/;

isInteger.test(123); //true
isInteger.test('123'); // true
isInteger.test('sdf'); //false
isInteger.test('123sdf'); //false

// If u want to avoid string value:
typeof testVal !== 'string' && isInteger.test(testValue); 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2021-04-26T17:54:45.950

答案中有很多选择。

`isNaN`对于纯整数可能很棘手，您仍然需要其他检查使其过时。
`Number.isInteger()`在 IE 中不受官方支持（大多数人不在乎，但那里有落后者）。

我最终自己写了一些东西：

```
function isInteger(valueToCheck) {
    return typeof valueToCheck !== 'undefined'
        && (valueToCheck === parseInt(valueToCheck, 10));
} 
```

## 测试

```
let undefinedValue;
const testValues = [
    1,
    '',
    undefinedValue,
    1.1,
    '1',
    '1.1',
    '1-2',
    'bob',
    false,
    [],
    [1],
    {},
    {foo: 1}
];

testValues.forEach(value => {
    console.log(`${value} - ${isInteger(value)}`);
}) 
```

结果：

```
1 - true
'' - false
undefined - false
1.1 - false
'1' - false
'1.1' - false
'1-2' - false
'bob' - false
false - false
[] - false
[1] - false
{} - false
{foo: 1} - false 
```

一些测试值是多余的，但它们的存在清楚地表明没有任何东西可以通过。你可以省略函数中的未定义检查，但我发现未定义的东西在 JS 中可能很奇怪，所以感觉更安全。

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2016-12-19T16:05:42.247

尝试以下功能：

```
function isInteger (num) {
    return num == parseInt(+num,10)  && !isNaN(parseInt(num));
}

console.log ( isInteger(42));        // true
console.log ( isInteger("42"));      // true
console.log ( isInteger(4e2));       // true
console.log ( isInteger("4e2"));     // true
console.log ( isInteger(" 1 "));     // true
console.log ( isInteger(""));        // false
console.log ( isInteger("  "));      // false
console.log ( isInteger(42.1));      // false
console.log ( isInteger("1a"));      // false
console.log ( isInteger("4e2a"));    // false
console.log ( isInteger(null));      // false
console.log ( isInteger(undefined)); // false
console.log ( isInteger(NaN));       // false    
console.log ( isInteger(false));       // false
console.log ( isInteger(true));       // false
console.log ( isInteger(Infinity));       // false 
```

* * *

## 回答 #39

> 赞同：-2
> 
> 时间：2015-05-27T15:50:13.797

您可以使用正则表达式来执行此操作：

```
function isInt(data){
  if(typeof(data)=='number'){
    var patt=/^[0-9e+]+$/;
    data=data+"";
    data=data.match(patt);
    if(data==null){return false;}
     else {return true;}}
  else{return false;} 
} 
```

`false`如果数据不是整数，它将返回，`true`否则。

* * *

## 回答 #40

> 赞同：-2
> 
> 时间：2016-01-07T07:20:25.847

为文本框添加类 numOnly，

```
$(document).on("input", ".numOnly", function(e) {
    this.value = this.value.replace(/[^0-9\$]/g,'');
    if(this.value!=""){
      alert('Integer Number.');
    }else{
      alert('Not an Integer Number.');
   }
}); 
```

它对我有用..试试这个

您可以使用 keypres、keyup、keydown 等代替输入。*

# c# - ClickOnce 部署中的“找不到网络名称”异常？

> ID：14636538
> 
> 赞同：3
> 
> 时间：2013-01-31T22:44:48.100
> 
> 标签：c#, clickonce

尝试安装 ClickOnce 应用程序时出现以下异常：

```
Below is a summary of the errors, details of these errors are listed later in the log.
* Activation of C:\Users\user\Downloads\appname.application resulted in exception. Following failure messages were detected:
    + Downloading file://192.168.2.9/appdir/appname.application did not succeed.
    + The network name cannot be found.

    + The network name cannot be found.

    + The network name cannot be found. 
```

我一直无法弄清楚。我试过在网上四处寻找，似乎没有任何关于这个问题的资源。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T02:29:05.567

原来这是发布设置中的安装 URL 的问题。我没有使用网络路径，而是使用共享路径。实际位置是在 IIS 中设置的，因此当然无法在共享中找到该文件。

从以下位置更改“安装文件夹 URL”字段：

`\\\server-name\path`

到

`http://server-name/path`

解决了这个问题。愚蠢的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T11:00:39.933

我以这种方式解决了这个问题。检查 IIS 和文件夹中的权限

```
Give the IIS Full control Permision to Everyone
Share the physical path folder to Everyone 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-04T13:59:57.827

大多数此类错误消息是由于无法通过网络找到的错误连接字符串造成的。重新检查连接字符串中的数据源值或服务器值和数据库名称将解决问题

# regex - 在记事本++中使用正则表达式的行号？

> ID：14636539
> 
> 赞同：19
> 
> 时间：2013-01-31T22:44:56.707
> 
> 标签：regex, notepad++

是否可以在 Notepad++ 中使用正则表达式获取行号；

我想做的是替换：

```
line1
line2
line3
etc.. 
```

和

```
1-line1
2-line2
3-line3
etc.. 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-31T22:50:52.623

Notepad++ 可以通过使用 TextFX 插件来做到这一点。选择行，然后`TextFX->TextFX Tools->Insert Line Numbers`从菜单栏中选择。

这将添加行号填充到前导零的 8 个位置。要以您问题中描述的形式获取它们，您可以使用带有这些值的正则表达式替换：

搜索：`^0+([0-9]+)\s`

用。。。来代替：`line\1-`

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-03-21T04:17:17.163

较旧的问题，但我今天自己也有这个问题，并找到了另一个答案，而不是已经提出的答案。

列编辑器 (Alt + C) 提供了一种插入编号的方法。存在用于选择起始编号、间隔以及每个编号应重复的频率的选项。将光标放在第一行的第一个位置并递增一以模拟实际的行号。

# java - 带有国际字母的 Java 正则表达式

> ID：14636540
> 
> 赞同：5
> 
> 时间：2013-01-31T22:45:02.310
> 
> 标签：java, regex, internationalization

这是我当前的代码：

```
return str.matches("^[A-Za-z\\-'. ]+"); 
```

我希望它包括国际信件。我如何在 Java 中做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-02T13:00:00.700

看来你想要的是，匹配所有的*字母*字符。通常，您会使用 Posix`\p{Alpha}`表达式来做到这一点，并通过您希望也允许的标点符号进行扩展。正如[Java 正则表达式文档](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)所说，它只匹配 ASCII。

但是，文档没有明确说明的是，您可以使此类使用 Unicode 字符。为此，您需要打开*Unicode 字符类*匹配。
您可以通过以下两种方式之一执行此操作：

1.  通过创建`Pattern`传递`UNICODE_CHARACTER_CLASS`常量的对象：
    `Pattern p = Pattern.compile("^[p{Alpha}\\-'. ]+", UNICODE_CHARACTER_CLASS);`
2.  通过使用`(?U)`嵌入式模式标志：
    `str.matches("^(?U)[\\p{Alpha}\\-'. ]+");`

概念证明：

```
String[] test = {"Jean-Marie Le'Blanc", "Żółć", "Ὀδυσσεύς", "原田雅彦"};
for (String str : test) {
    System.out.print(str.matches("^(?U)[\\p{Alpha}\\-'. ]+") + " ");
} 
```

明显的结果是：

> 真的 真的 真的 真的

如果您认为一切都是正确的，我还有两点要说明：

*   原田雅彦（原田正彦）由[表意文字](http://en.wikipedia.org/wiki/Ideogram)组成。实际上它们***不是***字母字符，
*   您想要匹配点 (.) 符号。没关系，但请考虑匹配[表意句号](http://en.wikipedia.org/wiki/Full_stop#Full_stops_in_other_scripts)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:52:19.633

我假设您想要匹配 ASCII 字母 AZ 以外的字母数字字符。您可以使用`\p{IsAlphabetic}`Unicode 字符类执行此操作：

```
return str.matches("^[\\p{IsAlphabetic}\\-'. ]+"); 
```

您会在[完整文档](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)中找到更多 Unicode 字符类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T22:59:45.310

将模式替换为：

```
"^[\\p{L}\\-'. ]+" 
```

`\p{L}`包括所有 unicode 字母。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-22T09:22:58.643

使用正则表达式`\P{L}`匹配任何字母（国内或国际）

通过添加`[\p{L}&&[^\p{IsLatin}]]`，您可以匹配所有非拉丁字母。

特别是对于希腊语，正则表达式必须`\p{InGreek}`匹配希腊字母并且`\P{InGreek}`（区别是大写 P）匹配非希腊字母。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T23:00:46.617

除非您说出“国际字母”的意思，否则无法完全回答这个问题，但一般的解决方案是通过`\p{name}`语法使用命名字符类。有许多命名的字符类。有些是由正则表达式语言定义的，有些是由 Unicode 标准定义的。有关部分列表，请参阅[Pattern javadocs](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)，以及相关的 Unicode 标准。

# webkit - 在 Centos 5.8 上使用 WebKitGTK+？

> ID：14636541
> 
> 赞同：4
> 
> 时间：2013-01-31T22:45:18.830
> 
> 标签：webkit, gtk, centos, centos5

我正在尝试为嵌入式设备构建一个嵌入式简单的网络浏览器，我决定使用 WebKit / WebKitGTK+。但是，我们的设备使用的是基于 CentOS 5.8 的 Linux 环境。在进行多次网络搜索时，我无法找到任何 RPMS 或提及对 CentOS 5.8 的 WebKit / WebKitGTK+ 的支持。

有谁知道是否可以构建旧版本的 WebKitGTK+，例如 1.2.6-2.el6_0，它在 CentOS 6.3 上运行良好？CentOS 5.8 有可用的 RPMS 吗？

这里的目标是能够在 CentOS 5.8 上运行相对最新的，至少 1.2.6 版本的 WebKitGTk

**注意：我能够整理出所有内容。只是花了很长时间使用正确的选项以正确的顺序编译所有依赖项。我能够在 Centos 5.8 上运行 WebKitGTK 1.6.0。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T11:37:41.033

如果您可以安装它需要的旧版本的库，那么构建旧版本的 webkit 应该没有任何问题。

如果您安装的 GTK+ 等旧版本或新版本比旧版本的 webkit 需要它可能需要相当多的移植来编译。

我不知道有任何 RPM 符合您的要求

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T19:52:01.100

根据编译选项，您应该能够在隔离目录中编译依赖项。对于每个库，您通常使用`--prefix`选项来指定目标。然后在编译依赖于该库的内容时，您通常可以选择指定在哪里查找该库 - 例如`--with-libraryname=/path/to/library`. 你想检查`./configure --help`你正在编译的每一件事以获得正确的选项。

这将是相当多的工作，但是您应该能够将所需的所有内容编译到一个独立的目录中，而无需替换系统上的任何内容。我强烈建议您避免在 root 中执行此操作，以确保您有正确的选择。

# kendo-ui - KendoUI 网格过滤问题

> ID：14636546
> 
> 赞同：1
> 
> 时间：2013-01-31T22:45:43.307
> 
> 标签：kendo-ui, kendo-grid

我正在使用最新版本的 kendoui，每当我使用“不等于”或“不包含”过滤器时，我都会收到以下错误：

```
Uncaught TypeError: Cannot read property 'length' of undefined 
```

我正在使用服务器端数据源，所有其他过滤器似乎都可以正常工作。

另外，如何为日期列指定日期时间选择器？

我查看了文档并尝试使用：

```
filterable: {
                ui: "datetimepicker"
             } 
```

但它从不显示日期时间选择器。

这是代码：

```
 var dataSourceArguments = {
        pageSize:10,
        serverPaging:true,
        serverFiltering:true,
        serverSorting:true,
        transport:{
            read:{
                url:$("#grid_order").attr('data-url'),
                dataType:"json"
            }
        },
        schema:{
            total:"count",
            data:'fields'
        },
        sort:{'field':'order_date', dir:'desc'}
    };
    var ds2 = new kendo.data.DataSource(dataSourceArguments);
    $("#grid_order").kendoGrid({
        dataSource:ds2,
        groupable:true,
        scrollable:true,
        sortable:true,
        pageable:true,
        columns:[
            {
                field:'order_date',
                title:'Order Date',
                width:150,
                filterable: {
                   ui: "datetimepicker"
                }
            },
            {
                field:"reference",
                title:'Reference',
                width:120,
                encoded:false
            },
            {
                field:"client__company",
                title:'Client',
                encoded:false
            },
            {
                field:"grand_total",
                title:'Total',
                width:100
            },
            {
                field:'status',
                title:'Status',
                width:120,
                encoded:false
            },
            {
                field:'actions',
                width:200,
                title:'Actions',
                filterable:false,
                encoded:false,
                sortable:false
            }
        ],
        filterable:true
    }); 
```

**更新：**我设法让日期选择器工作，但是每当我选择日期时，并单击过滤器它会过滤，但我选择的日期会从该字段中消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-17T00:09:42.783

将 order_date 从数据源添加到方案中，并将字段的数据类型添加到**date**。

看[http://docs.kendoui.c​​om/api/framework/datasource](http://docs.kendoui.com/api/framework/datasource)

# html - 网站徽标的正确位置是什么？

> ID：14636550
> 
> 赞同：0
> 
> 时间：2013-01-31T22:45:56.457
> 
> 标签：html, validation

作为我添加到每个页面的标题的一部分，紧随 my 之后`<body>`是我网站的徽标。这`<img>`是在一个`<a>`标签内，指向我的索引页。

这是[W3C 验证器](http://validator.w3.org/)

> 第 21 行，第 38 列：文档类型在此处不允许元素“a”；缺少“p”、“h1”、“h2”、“h3”、“h4”、“h5”、“h6”、“div”、“pre”、“address”、“fieldset”、“ins”之一, "del" 开始标签

（我会跳过消息的其余部分，但是其中的 html 标记搞砸了，我不知道如何在块引用中转义它们）。

放置徽标的正确位置是什么？从逻辑上讲，它不在一个部门内。制作一个空白容器元素似乎很愚蠢。

本地来源：

```
...
<body>
<a title="Home" href="index.html"><img src="images/logo.png" id="logo"/></a>
.... 
```

完整来源： http: [//pastie.org/5998955](http://pastie.org/5998955)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:50:51.397

该错误是指您放置一个内联块元素而没有容器块的错误。

您必须执行以下操作才能使其有效：

```
<body>
<div><a title="Home" href="index.html"><img src="images/logo.png" id="logo"/></a></div> 
```

该错误清楚地说明了这一点，甚至建议您可以使用哪些标签来纠正问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:52:35.043

如果您想使用 XHTML，那么您将不得不将内联元素包装在块元素中以进行验证。

你可以使用 HTML5 来做你正在做的事情并让它验证（但你必须`alt`为你的图像添加属性）。

馅饼：http : [//pastie.org/5998964](http://pastie.org/5998964)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:58:07.857

您的问题不是“将网站徽标放在哪里”，您的问题是基于您在 head 部分中指定的文档类型的格式错误的 HTML。

A 是内联标签，需要用 P 或 DIV 等块级标签包裹。

# php - 如何将对象实例分配给行为？

> ID：14636552
> 
> 赞同：0
> 
> 时间：2013-01-31T22:46:07.110
> 
> 标签：php, cakephp, cakephp-2.2

我正在努力让我的 Behavior 类在回调中使用对象实例。

```
class SomethingBehavior extends ModelBehavior
{
     public function setObject($obj)
     {
         // do stuff
     }

     public function afterFind(Model $model,$results,$primary)
     {
        // use the $obj reference set above
     }
} 
```

现在我需要模型类在执行任何查找操作之前调用 setObject(..)。所以理想情况下，我只会在构造函数中分配我需要的对象。

```
class Document extends AppModel
{
    //.....
    public function __construct($id,$table,$ids)
    {
        parent::__construct($id,$table,$ds);
        $this->Something->setObject(new MyClass());
    }
} 
```

我的问题是尚未配置 Behavior 对象，并且在尝试使用它时出现 not an object 错误。

我在组件中找不到任何模型的回调方法。例如，没有`setup`或`initialize`方法。

如何将我需要的对象分配给行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:35:03.993

你似乎没有过多地处理行为。尝试使用可包含、树或其他核心或插件行为，那么您很快就会弄清楚基础知识。

首先，行为附加到模型（从 2.3 开始：已加载），而不是相反。然后模型在功能上变得“更丰富”。

静态使用`public $actsAs`或动态使用

```
$this->Behaviors->attach('Something'); // since 2.3: load() instead of attach() 
```

它可以直接访问行为方法。假设我们在您的行为中有一个方法 foo() 。然后你可以从你的模型中调用它

```
$this->foo($foo, $bar); 
```

或从您的控制器作为

```
$this->Document->Behaviors->attach('Something')
$this->Document->foo($foo, $bar); 
```

太棒了，对吧？行为方法通常有这样的声明：

```
public function foo(Model $Model, $foo, $bar) {
    $alias = $Model->alias;
    // do sth
} 
```

如您所见，您总是将模型隐式传递给它（作为第一个参数自动传递）。您可以访问其所有属性。

并且不要触摸模型的构造函数。没必要这样做。

如果你真的需要在运行时传入一个对象，为什么你的方法不起作用？

```
public function setObject(MyClass $obj) {
    $this->Obj = $obj;
} 
```

现在您可以在内部使用行为方法中的对象

```
public function doSth(Model $Model) {
    $this->Obj->xyz();
} 
```

此外，这可能不是最优雅的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:17:34.037

您永远不会设置`something`Document 类的成员。您要么需要在构造函数中实例化它，要么将其传入。

就个人而言，我会做这样的事情：

```
class Document extends AppModel
{
    private $behavior;

    public function __construct($id,$table,$ids, ModelBehavior $behavior)
    {
        parent::__construct($id,$table,$ds);
        $this->behavior = $behavior
        $this->behavior->setObject(new MyClass());
    }
}

$doc = new Document(..., new SomethingBehavior()); 
```

或者更好的是，您甚至可以通过执行以下操作进一步将其分开：

```
class Document extends AppModel
{
    private $behavior;

    public function __construct($id,$table,$ids, ModelBehavior $behavior)
    {
        parent::__construct($id,$table,$ds);
        $this->behavior = $behavior
    }
}

$behavior = new SomethingBehavior();
$behavior->setObject(new MyClass());

$doc = new Document(..., $behavior); 
```

这样，构造函数中的魔法就会减少。

# macos - setting Array in model-class from NSArrayController

> ID：14636558
> 
> 赞同：1
> 
> 时间：2013-01-31T22:46:39.797
> 
> 标签：macos, cocoa, nsarraycontroller

How do I set the array in my model-class `ValueItem` with the content of an `NSArrayController`in my AppDelegate class:

```
@interface AppDelegate : NSObject <NSApplicationDelegate>
{
    ValueItem *vi;
} 
```

and:

```
@implementation AppDelegate
{

    ValueItem *array = [[ValueItem alloc]init];
    [array setValueArray:[outArrayController arrangedObjects]];

    NSArray *testArray2 = vi.valueArray; // !!!getter or setter doesn't work!!!
    NSLog(@"test array 2 is:%@", testArray2);
} 
```

`NSLog` returns `NULL`. What do I miss here? (valueArray is initialized with `@property` and `@synthesize`)

ValueItem.h:

```
#import <Foundation/Foundation.h>
@interface ValueItem : NSObject
{
    NSNumber *nomValue;
    NSNumber *tolerancePlus;
    NSNumber *toleranceMinus;
    NSMutableArray *valueArray;
}
@property (readwrite, copy) NSNumber *nomValue;
@property (readwrite, copy) NSNumber *tolerancePlus;
@property (readwrite, copy) NSNumber *toleranceMinus;
@property (nonatomic, retain) NSMutableArray *valueArray;

@end 
```

ValueItem.m:

```
#import "ValueItem.h"
@implementation ValueItem

@synthesize nomValue, tolerancePlus, toleranceMinus;
@synthesize valueArray;

-(NSString*)description
{
    return [NSString stringWithFormat:@"nomValue is: %@ | tolerancePlus is: %@ | toleranceMinus is: %@", nomValue, tolerancePlus, toleranceMinus];

}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:59:21.160

**Solution**: Need to make sure you're dealing with the AppDelegate's `vi` property:

```
// We need to make sure we're manipulating the AppDelegate's vi property!
self.vi = [[ValueItem alloc]init];
[vi setValueArray:[outArrayController arrangedObjects]];

NSArray *testArray2 = vi.valueArray; // !!!getter or setter doesn't work!!!
NSLog(@"test array 2 is:%@", testArray2); 
```

* * *

**Explanation** : On the first two lines you were manipulating the `array` `ValueItem` variable, then attempting to set `testArray2` to the value of the uninitialized `vi` `ValueItem` variable.

```
// This is a new variable, unrelated to AppDelegate.vi
ValueItem *array = [[ValueItem alloc]init];
[array setValueArray:[outArrayController arrangedObjects]];

// Here, AppDelegate.vi hasn't been initialized, so valueArray *will* be null!
NSArray *testArray2 = vi.valueArray; 
NSLog(@"test array 2 is:%@", testArray2); 
```

# oracle - Oracle WebLogic 12c 部署计划存档？

> ID：14636561
> 
> 赞同：4
> 
> 时间：2013-01-31T22:46:50.367
> 
> 标签：oracle, deployment, weblogic

我正在尝试查找有关使用 WLS 12c 的部署计划存档的任何文档，但我没有找到任何文档。

我确实找到了这个旧线程：[https ://forums.oracle.com/forums/thread.jspa?threadID=2293718](https://forums.oracle.com/forums/thread.jspa?threadID=2293718)

> 我们在部署服务的 WebLogic 控制台中拥有的“部署计划存档”选项是从 11G 添加的新功能，目前尚未完全实现，因此这就是它没有记录在任何 Oracle 文档中的原因。

我们在使用管理控制台部署我们的应用程序并使用我们的部署计划 (Plan.xml) 之后，但上传部署计划需要一个 jar 而不是 xml 文件。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-28T15:55:14.703

您必须同时选择应用程序 war/ear 文件和计划下方，然后将两者都上传。

# search - 使用 ack （或类似的东西），我如何排除子目录

> ID：14636562
> 
> 赞同：1
> 
> 时间：2013-01-31T22:47:02.307
> 
> 标签：search, ack

例如：

```
-- /
---- foo
------ exclude-me
----  bar
------ exclude-me
---- baz
------ exclude-me 
```

我如何搜索所有`foo`,`bar`和`baz`, 但排除任何子目录`exclude-me`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:58:23.087

对于 ack，您的用例被覆盖`--ignore-dir=exclude-me`（仅由普通目录名称除外）。

[对于类似的事情，我会在浏览](http://linux.die.net/man/1/ack)一些手册一段时间后尝试一些类似的方法。

# c# - 需要一些关于排序字符串列表的想法

> ID：14636565
> 
> 赞同：1
> 
> 时间：2013-01-31T22:47:09.997
> 
> 标签：c#, wpf, string, sorting

我有 C#\WPF 应用程序，它只是在列表框控件中显示变量名称及其值的列表。当用户点击“刷新”按钮时，将使用变量的新值重新创建列表。有些变量可能已经改变，而有些变量保持不变。

我希望自上次刷新以来已更改的值位于列表框的顶部，但想不出一种优雅的方式来解决这个问题。任何想法或示例将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:56:42.100

最好为您的列表项（模型）提供一些额外的功能，这些功能旨在简单地为视图提供服务，viewmodel 样式——当然，如果您想让它们保持纯净，您可以将模型包装在 viewmodel 中。

例如，您可以为模型提供一个`Changed`可以设置的属性（或者，`Value`属性设置器可以在值更改时自动更改它）。然后，此属性可用于`ListBox`通过对框绑定到的集合视图进行排序来对 中的项目进行排序：

```
<CollectionViewSource x:Key="SortedModels" Source="{Binding ListOfModels}">
    <CollectionViewSource.SortDescriptions>
        <SortDescription PropertyName="Changed"/>
    </CollectionViewSource.SortDescriptions>
</CollectionViewSource>

<ListBox ItemsSource="{Binding Source={StaticResource SortedModels}}"/> 
```

假设您的模型实现`INotifyPropertyChanged`并且`ListOfModels`是`ObservableCollection`，这就是自动完成排序所需的全部内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:54:20.150

与其拥有名称/值对的对象列表，不如将其视为具有 // 属性的对象`Name`列表。当您更新对象列表时，您可以进行适当的设置，并将其用作排序的一部分。`Value``IsChanged``IsChanged``IsChanged`

特别是，不要将其视为对字符串列表进行排序。您有一个变量列表，这些变量具有属性 ( `name`, `value`, `isChanged`)。你的列表框绑定到一个`CollectionView`（`Listbox.Items`给你的那个，或者你从中得到的东西`CollectionViewSource`）。上面`CollectionView`有`SortDescriptions`，您可以将其设置为先排序`IsChanged`，然后再排序`Name`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T22:58:25.657

可能还有更多选择：

1.  保持当前列表的状态。加载新列表。使用 linq`Except`查看差异。`Except`使用顶部的结果和下面的其余顺序创建新列表。
2.  使用 some 扩展您的项目`Timestamp`，这将标记项目的创建时间。选择一个间隔，多*旧的*项目应该在顶部。读取新值，并将满足条件的值（间隔中的最新值）放在顶部。或者你可以按那个对它们进行排序`TimeStamp`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T22:59:55.827

使用类似的东西：

```
var olditems = new Hashset<string>(listbox.items); // or List<T>
List<string> newitems = getNewItems();
newitems = newitems.RemoveAll(x => olditems.Contains(x));
listbox.Items.Clear();
listbox.Items.Add(newitems);
listbox.Items.Add(olditems); 
```

我没有测试过代码，这个想法应该会变得清晰。

另请参阅：[使用 LINQ 从 List<T> 中删除元素](https://stackoverflow.com/questions/853526/using-linq-to-remove-objects-within-a-listt)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T23:03:08.763

我喜欢 Jeff 的想法，但每次用户更新列表时，它都需要额外的逻辑来重置 IsChanged 值。尝试将时间戳添加到您的名称/值对，并在每次更新值时更新时间戳。然后只需将时间戳添加到您的排序中。

# ruby - Ruby Test::Unit 的当前测试方法名称

> ID：14636568
> 
> 赞同：1
> 
> 时间：2013-01-31T22:47:13.127
> 
> 标签：ruby, unit-testing, methods, testunit

在 Ruby 的 Test::Unit 中，如何获取当前 test_ 方法的名称？在 MiniTest 中，这可以通过 来完成`self.__name__`，但是，它不适用于完整版。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T19:53:11.630

我知道了！

测试名称通过继承链传递，所以我只需要捕获它并将其保存在本地以供参考。

```
def initialize(name = nil)
    @test_name = name
    super(name) unless name.nil?
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-15T21:34:59.660

对于 Test::Unit 2.x 的完整性，`method_name`请参见[http://git.io/7yngvg](http://git.io/7yngvg)

```
def setup
  puts self.method_name # will output e.g. "test_check_username"
end 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-31T22:52:59.973

你可以使用**方法**，比如这个例子：

```
class MyTest
  def test_method_example
    __method__
  end
end 
```

它包括方法名称的“：”字符前缀

# python - 在 Python 中使用 lambda

> ID：14636569
> 
> 赞同：5
> 
> 时间：2013-01-31T22:47:15.357
> 
> 标签：python, sorting

我正在尝试使用 lambda 对列表进行排序。我想做的是根据它们与初始位置的曼哈顿距离对坐标进行排序。我知道我的大部分语法都写下来了，但似乎我遗漏了一些小东西，谢谢！

```
while (len(queue) > 0):  
    queue.sort(queue, lambda x: util.manhattanDistance(curr,x)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:51:18.713

您似乎正试图告诉该`sort()`方法使用您的 lambda 函数作为排序的**键**。这是通过**关键字参数** `key`完成的：

`queue.sort(queue, key = [your lambda function])`

重写的行是：

`queue.sort(queue, key = lambda x: util.manhattanDistance(curr,x))`

编辑：误解了原始 lambda 函数的目的；认为它是一个比较函数，这没有意义，因为距离函数不能是负数

# javascript - 使用 Ajax 的“安静”表单提交

> ID：14636570
> 
> 赞同：1
> 
> 时间：2013-01-31T22:47:19.780
> 
> 标签：javascript, ajax

我的意图是将数据从表单提交到服务器，而不是重新加载页面。它甚至不需要显示更新的数据。我正在使用 Firefox 进行开发，我正在寻找两种途径来获得我想要的东西：

1.  我发现如果我在表单中放置一个按钮，该表单将与包含它的页面名称一起作为“GET”请求提交。本例中的表单标签没有方法属性，动作标签为空。我可以在 action 属性中输入我想要的功能，浏览器会将其余的表单字段应用于请求。我发现表单的制定很方便，但是浏览器会继续并用来自服务器的响应替换页面，从而使我远离原始页面。
2.  从表单中取出按钮并将其专门连接到 javascript 函数允许我将函数注册到 onreadystatechange 事件。这具有运行功能而不是在服务器响应时重新加载页面的效果。这样做的不利方面似乎是该函数必须自己制定“GET”请求。

在我看来，javascript函数应该有一种方法来告诉表单使用它自己的设备提交，然后准备好处理响应。作为新手，我不熟悉此要求的“最佳实践”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:00:58.950

您可以只使用 a`<button>`来发布您的详细信息。

```
function ajaxPage(postPage, paramList) {
    xmlhttp.open("POST",postPage,false);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send(paramList);
    return xmlhttp.responseText;
} 
```

在这种情况下，您`postPage`是一段相关代码的地址，并且`paramList`是`&`分隔名称值对的列表。

亲切的问候，韦斯蒂

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:49:39.007

您可以在表单中添加“onsubmit”功能。

重要的是在该函数中返回 false 或调用 event.preventDefault() 以防止浏览器发布表单。

HTML：

```
<form onsubmit="javascript:myFunction()">
    ...
</form> 
```

脚本：

```
function myFunction(evt) {
    // do your ajax call...
    evt.preventDefault();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:55:19.287

真的不需要“提交”，您可以使用 ajax 搜索自动完成建议实现：

Onfocus On..即使您将所有表单数据发送到服务器端，您也希望通过服务器端响应自动完成而不是脓液，您可以为用户解释您需要的内容。

[此](https://stackoverflow.com/questions/574941/best-way-to-track-onchange-as-you-type-in-input-type-text)链接可能会对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T18:20:25.927

这就是我最终得到的结果，按照原始问题中的描述继续使用路径号 2，调用脚本的按钮在表单之外，因此没有提交事件。表单中的数据由脚本收集，如对相关问题的回答中所述：

[https://stackoverflow.com/a/589100/747544](https://stackoverflow.com/a/589100/747544)

从那里，“get”请求由脚本制定

```
XMLHttpRequest.open("GET", "/myCommand?"+queryString ,true);
XMLHttpRequest.send(null); 
```

该表单实际上已被脚本“扫描”而从未提交过，因此无需通过 onSubmit 事件返回 false 来阻止默认行为。或防止默认（）。

# c# - 使用 LINQ 遍历对象树

> ID：14636571
> 
> 赞同：2
> 
> 时间：2013-01-31T22:47:33.473
> 
> 标签：c#, linq

一个国家有一个州列表。一个州有一个城市列表。查找具有邮政编码 11201 的城市的州。

我该怎么做呢？

当我做

```
Country.States.SelectMany(
                           s => s.Cities.Where(c => c.Zip ==11201)
                         )
                          .Select(s => s); 
```

我得到的是城市而不是州。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T22:49:18.013

```
Country.States.Where(s => s.Cities.Any(c => c.Zip == 11201)); 
```

正如 Benjamin Gruenbaum 所指出的，如果您想检索一个状态（而不是列表），请替换`Where`为`FirstOrDefault`

```
Country.States.FirstOrDefault(s => s.Cities.Any(c => c.Zip == 11201)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-31T23:03:29.947

只是为了颜色，另一种方法：

```
var foo = 
    from state in Country.States
    from city in state.Cities
    where city.Zip == 11201  // Hey, that's my zip code!
    select state;
var justTheOne = foo.FirstOrDefault(); 
```

# java - 替换 dalvik.system.VMStack

> ID：14636575
> 
> 赞同：1
> 
> 时间：2013-01-31T22:48:04.433
> 
> 标签：java, android, api

有替代品`import dalvik.system.VMStack`吗？

Android API 说它已被弃用。我想做的是将某人的旧项目移植到更新的系统上。是否有可能直接替换此 API，或者有人可以推荐一种解决此问题的方法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:54:02.413

你需要什么？您可以从[`ClassLoader.getSystemClassLoader()`](http://developer.android.com/reference/java/lang/ClassLoader.html#getSystemClassLoader%28%29). StackTrace 也可用。还需要什么吗？

# python - 将 Twitter Bootstrap 轻松集成到任何 Pyramid 表单框架

> ID：14636576
> 
> 赞同：4
> 
> 时间：2013-01-31T22:48:05.153
> 
> 标签：python, twitter-bootstrap, pyramid, mongoengine

我正在构建一个基于 Pyramid、MongoEngine 和 Twitter Bootstrap 的 Web 服务。它只包含几个简单的形式。实现表单的最佳方式是什么，以便它们与 Twitter Bootstrap 很好地集成？大多数情况下，我担心需要自己手动破解所有 HTML。

*   哪些 Pyramid 框架可以很好地与 Bootstrap 和附加组件一起使用？

*   如果我需要在整个模板中传播 CSS 类等内容，那么最简单的方法是什么？

我正在使用 MongoEngine 模型，但是这些模型的数量很少，并且很容易将它们调整为框架。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-01T04:21:24.870

使用deform_bootstrap 变形是一个合理的选择。

[变形引导： http](http://pypi.python.org/pypi/deform_bootstrap) ://pypi.python.org/pypi/deform_bootstrap

您可以在这里查看它的外观：

[http://deformdemo.xo7.de/](http://deformdemo.xo7.de/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-16T19:54:16.670

你也可以试试[deform_jinja2](https://github.com/sontek/deform_jinja2)

# dependency-injection - PHPStorm、Silex DI 索引代码完成

> ID：14636579
> 
> 赞同：6
> 
> 时间：2013-01-31T22:48:43.480
> 
> 标签：dependency-injection, phpstorm, code-completion, silex, service-locator

我正在尝试`PHPStorm`它的代码完成问题。我用框架编写项目，`Silex`并面临 PHPStorm 缺乏`Silex`依赖注入容器的代码完成。例如，它没有完成代码`$app['twig']->`或`$app['db']->`任何其他服务。我找到的唯一方法就是像这样做

```
$db = $app['db'];
/** @var $db \Doctrine\DBAL\Connection */
$db->.... 
```

然后`PHPStorm`会做代码完成。使用 ServiceProvider 接口注册服务。有没有办法让 PHPStorm 在这种情况下完成代码而无需额外的变量和注释？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T23:00:36.043

据我所知，目前这是不可能的，但是，目前正在努力添加对通用工厂模式的支持，请在他们的问题跟踪器上查看此问题：

[http://youtrack.jetbrains.com/issue/WI-6027](http://youtrack.jetbrains.com/issue/WI-6027)

PhpStorm 开发人员欢迎在他们的问题跟踪器上提出新功能请求，并且响应迅速。因此，您可以提交功能请求

此外，这可能与您的问题有关：http: [//youtrack.jetbrains.com/issue/WI-5304](http://youtrack.jetbrains.com/issue/WI-5304)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-11T10:08:14.567

这是 PHPStorm / Intellij IDEA 的插件： [https ://plugins.jetbrains.com/plugin/7809?pr=](https://plugins.jetbrains.com/plugin/7809?pr=)

还没试过，但看起来很有希望......

编辑：只是给了它一个快速的镜头，它看起来真的很酷而且设置简单：

*   通过 IDE 插件管理器安装插件

*   添加以下依赖项：

> ```
> "require": {
>     "sorien/silex-pimple-dumper": "~1.0"
> } 
> ```

*   注册提供者：

    $app->register(new Sorien\Provider\PimpleDumpProvider());

你完成了。

# python - 当我尝试在 python 中向多个人发送电子邮件时遇到错误

> ID：14636597
> 
> 赞同：0
> 
> 时间：2013-01-31T22:50:34.280
> 
> 标签：python

我正在使用以下代码向 python 中的人发送电子邮件。

```
import smtplib
from email.mime.multipart import MIMEMultipart, MIMEBase
from email.mime.text import MIMEText
from email.utils import formatdate

    def send_mail(send_from,send_to, subject, text, files=[], server = "localhost"):
        for s in send_to:
               COMMASPACE = ', '
               msg = MIMEMultipart()
               msg['From'] = send_from
               msg['To'] = COMMASPACE.join(s)
               msg['Date'] = formatdate(localtime=True)
               msg['Subject'] = subject

               msg.attach( MIMEText(text) )

               for f in files:
                       part = MIMEBase('application', "octet-stream")
                       part.set_payload( open(f,"rb").read() )
                       Encoders.encode_base64(part)
                       part.add_header('Content-Disposition', 'attachment; filename="%s"' %os.path.basename(f))
                       msg.attach(part)

               server = smtplib.SMTP(server)
               server.sendmail(send_from, s, msg.as_string())
               server.close() 
```

如果格式混乱，请见谅。emails 是一个包含两封电子邮件的预定义列表。我遇到的错误是：AttributeError: SMTP instance has no attribute 'find'

任何的想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:33:58.337

您无需为每个收件人创建单独的电子邮件；只需发送一条包含多个收件人的消息：

```
def send_mail(send_from,send_to, subject, text, files=[], server = "localhost"):
   msg = MIMEMultipart()
   msg['From'] = send_from
   msg['To'] = COMMASPACE.join(send_to)

   # ... 

   server = smtplib.SMTP(server)
   server.sendmail(send_from, send_to, msg.as_string())
   server.close() 
```

[这与docs](http://docs.python.org/2/library/email-examples.html)中的示例“这是一个如何发送包含一堆可能位于目录中的家庭照片的 MIME 消息的示例”几乎相同。

（如果您不希望每个人都看到对方的地址，您可以将它们全部设为`BCC`s 而不是`To`s。）

如果您对原始代码的问题而不是如何正确执行更感兴趣，那么有两个立即可见的问题：

1.  `join`正如维德解释的那样，你正在输入每个地址。
2.  您将单个地址作为字符串作为第二个参数传递给[`SMTP.sendmail`](http://docs.python.org/2/library/smtplib.html#smtplib.SMTP.sendmail)，但第二个参数是地址序列。要解决此问题，请使用`[s]`而不是`s`，就像大多数示例一样。

这两者都是由相同的混淆引起的，将每个地址视为地址列表。您可能会遇到由相同问题引起的其他错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:17:30.927

我认为你的问题在这里：

```
>>> COMMASPACE = ', '
>>> send_to = ('test@example.com','test2@example.com')
>>> for s in send_to:
...  print COMMASPACE.join(s)
...
t, e, s, t, @, e, x, a, m, p, l, e, ., c, o, m
t, e, s, t, 2, @, e, x, a, m, p, l, e, ., c, o, m 
```

这就是我认为您正在尝试做的事情：

```
 >>> COMMASPACE.join(send_to)
    'test@example.com, test2@example.com' 
```

# ruby-on-rails - 使用 wkhtmltopdf 输出到 PDF 时页面上的 Highcharts 图表无法正确呈现

> ID：14636599
> 
> 赞同：1
> 
> 时间：2013-01-31T22:50:42.813
> 
> 标签：ruby-on-rails, highcharts, wkhtmltopdf, pdfkit

我的 wkhtmltopdf PDF 输出的页面上有几个 Highcharts 图表缺少图表的一些元素，主要是所有简单的直线，包括刻度线、网格线、列边框、图例边框和我的折线/样条图表中的线条（数据点显示）。

我已经尝试了从其他堆栈问题中解决此问题的技巧，即在系列中设置以下所有内容：

```
enableMouseTracking: false,
shadow: false,
animation: false 
```

...以及在列/样条上设置那些。没运气。

这是[浏览器页面图像的链接](https://dl.dropbox.com/u/106213/displayed-page.png)。

这是[pdf 输出图像的链接](https://dl.dropbox.com/u/106213/pdf-page.png)。

这是前两个图表的[图表选项要点的链接。](https://gist.github.com/4686853)

这一切都在安装在 VirtualBox 来宾中的 Linux Ubuntu 12.04 上，使用截至两天前下载的最新 Highcharts 和 wkhtmltopdf 版本 0.10.0_rc2。对 wkhtmltopdf 的调用主要通过 Rails 3 应用程序中的 PDFKIT gem，但我在命令行上直接调用 wkhtmltopdf，结果相同。

TIA 寻求帮助！

**更新：**

我已将问题隔离到图表之前的特定 HTML 片段。我正在使用 Twitter Bootstrap css/javascript 框架，此代码生成一组按钮：

```
<div class='btn-group' data-toggle='buttons-radio'>
  <button class="filterButton btn" data-filter="school_year" data-group="dr_filter" data-value="2012">2012</button>
  <button class="filterButton btn" data-filter="school_year" data-group="dr_filter" data-value="2011">2011</button>
  <button class="filterButton btn btn-primary selected" data-filter="school_year" data-group="dr_filter" data-value="2010">2010</button>
  <button class="filterButton btn" data-filter="school_year" data-group="dr_filter" data-value="2009">2009</button>
  <button class="filterButton btn" data-filter="school_year" data-group="dr_filter" data-value="2008">2008</button>
</div> 
```

具体来说，是 .btn-group 标签的存在导致了问题 - 把它拿走，让其他一切保持原样，PDF 生成的页面显示与没有注意到的问题相同。此外，如果您将此代码段移动到图表之后页面上的任何位置，则一切正常。

我已将问题进一步隔离到实际的 html/css，因为当我完全禁用 Bootstrap javascript 函数时问题仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T12:32:05.387

wkhtmltopdf 上报告了一个与您的情况非常相似的问题。见[问题 689](http://code.google.com/p/wkhtmltopdf/issues/detail?id=689)。Wkhtmltopdf 不能正确处理透明度/阴影，并可能导致不可预知的结果。

删除 svg 中的所有 stroke-opacity 属性并用 opacity 属性替换它们，然后再将其发送到 wkhtmltopdf。这段代码可以解决问题。

```
nodes = document.querySelectorAll('*[stroke-opacity]');

for (nodeIter = 0; nodeIter < nodes.length; nodeIter += 1) {
    elem = nodes[nodeIter];
    opacity = elem.getAttribute('stroke-opacity');
    elem.removeAttribute('stroke-opacity');
    elem.setAttribute('opacity', opacity);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-25T13:00:17.217

尝试传递选项 javascript-dealy

```
wkhtmltopdf --quiet --page-size letter --encoding UTF-8 --javascript-dealy 5000 - - 
```

或者，如果您使用的是 pdfkit gem/library，请尝试在 html 代码中添加以下行

```
 <meta content="5000" name="pdfkit-javascript-delay"/> 
```

# git - 使用 git branch 进行在线开发和测试

> ID：14636602
> 
> 赞同：3
> 
> 时间：2013-01-31T22:50:50.253
> 
> 标签：git

我需要一种在发布更改之前在线测试更改的方法。到目前为止，从我读到的内容来看，git 可以在其中发挥作用。我对 git 知之甚少，所以...

初步信息是：1）网站域是： http: [//www.domain.com](http://www.domain.com) 2）是使用“*”通配符 *.domain.com => www.domain.com 的 dns 重定向

1）我认为我应该使用一个开发分支......但是我怎样才能测试那个分支呢？2) 我将使用什么链接来访问该分支以及如何设置它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:24:52.120

为此，您需要将开发分支部署在服务器上的不同位置并使用子域。
例如，www.domain.com 将是您的生产分支，而 dev.domain.com 将是您的测试分支。
子域将指向服务器上的不同位置。
您可以在 Web 服务器配置中进行设置。
为了提高安全性，我还建议使用密码或 IP 白名单限制对开发子域的访问。

如果你告诉我更多关于你的服务器上的配置，我可以向你展示配置。
首先，您使用什么网络服务器？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:27:06.943

这是我的工作流程。

我有 3 个主要分支：

1.  大师，这个分支反映了主要网站：website.com
2.  开发，这个分支反映了开发网站：dev.website.com
3.  Preprod，要添加另一个级别的测试，您可能不需要它。

每个功能都在基于开发的分支上编码。当证明稳定时，develop 会合并到 master 上。

我的 Web 服务器将开发分支与 dev 子域同步，将主分支与主域同步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T23:30:08.373

我假设你已经阅读了一些 git 教程，我喜欢推荐[Git Immersion](http://gitimmersion.com)。

您可以在开始时使用简单的设置 -**保留两个分支 - 一个（主）具有稳定的、经过测试的代码，一个具有您开发的代码**。[这是一篇很好的文章](http://nvie.com/posts/a-successful-git-branching-model/)，描述了一个好的但完整的 git 分支模型，所以你可以看到它在更大的项目中的样子。

**有一些自动化的方式将代码部署到服务器中**是很好的。当你有一个（使用一些 CI 工具或脚本来检查存储库、复制必要的文件、运行数据库迁移等）时，很容易将你的应用程序部署到任何位置（例如指定的测试服务器）。我不会冒险在生产服务器上测试新代码，但如果你缺钱，你可以这样做。请记住为开发应用程序**设置单独的数据库副本！**

当您稳定代码并且它可以在生产中使用时，您**将 development 分支与 master 分支合并**。

# sql-server - SQL 表与实体框架 MVC

> ID：14636605
> 
> 赞同：4
> 
> 时间：2013-01-31T22:50:58.590
> 
> 标签：sql-server, asp.net-mvc, entity-framework

我知道一点 MVC，但我想先用 DataBase 开发 MVC。我想知道一件事。我在网上看到一张这样的表：

```
CREATE TABLE dbo.Payroll 
    (
     ID int PRIMARY KEY, 
     PositionID INT, 
     Salary decimal(9,2),
     SalaryType nvarchar(10),  
     CHECK  (Salary > 10.00 and Salary < 150000.00) 
    ); 
```

我想知道 CHECK 元素是否会导致我的 webSite 中的数据验证。

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:56:57.733

不，它不会自动在您的网站上添加验证。它将对数据库强制执行该约束，如果用户输入超出该范围的值，它将“崩溃”。

您仍然应该在客户端添加验证，以防止来自数据库的未处理错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:59:41.340

验证不会在 Web 应用程序/站点中完成，而是在数据库中完成。就像 UNIQUE 或 FOREIGN KEY 约束一样，如果违反该约束，它将引发错误/异常

看到这个小提琴：[http](http://sqlfiddle.com/#!3/ede45) ://sqlfiddle.com/#!3/ede45 - 删除最后一行中的注释，看看它如何违反约束并抛出错误 - 如果不处理，用户将看到。您需要在此类条目进入数据库之前对其进行处理，并且约束只是双重检查或交叉检查

# php - 查询车辆的可用租赁日期

> ID：14636614
> 
> 赞同：1
> 
> 时间：2013-01-31T22:51:32.887
> 
> 标签：php, mysql, sql

我无法在我正在开发的网站上实现搜索功能。

搜索表单有两个字段，用户想要租用车辆的开始日期和结束日期。

在数据库中，我有两张表，一张用于车辆，另一张用于可用日期。

```
Table: cars
 - car_id (int)
 - name (varchar)
 - description (varchar)

Table: cars_availability
 - car_id (int)
 - date (datetime)
 - status (int) // 1: available 2: booked 
```

**cars_availability**中的每一行代表相关汽车可供出租或预订的一天。

**问题：**

如果用户搜索从 2013 年 2 月 5 日到 2013 年 2 月 8 日可用的汽车，**我**想做**一个**查询以选择用户选择中所有日子都可用的所有汽车。

**我目前未完成的解决方案：**

我知道我可以使用这样的东西来迭代所有的日子

```
$begin = new \DateTime( date('Y-m-d', strtotime($data['rent_start'])));
$end = new \DateTime( date('Y-m-d', strtotime($data['rent_end'])));
$end = $end->modify( '+1 day' ); 

$interval = \DateInterval::createFromDateString('1 day');
$period = new \DatePeriod($begin, $interval, $end);

$available_cars = array();

foreach ( $period as $dayTime ){

    // query the cars and joining the cars_availabilty table

    $item = DB::select('cars.*')
    ->from('cars')
    ->join('cars_availability')->on('cars_availability.item_id', '=', 'cars.item_id')
    ->where('items_availability.date', '=', $dayTime->format("Y-m-d H:i:s"))
    ->and_where('items_availability.status', '=', 1)
    ->execute()->as_array();

    if(count($item) > 0){

      if(isset($available_cars[$item[0]['item_id']])){

        $available_cars[$item[0]['item_id']][] = $item[0];

      }else{

        $available_cars[$item[0]['item_id']] = array();
        $available_cars[$item[0]['item_id']][] = $item[0];
      }
    }

} 
```

在此之后，我将拥有一系列车辆，这些车辆可能全天都可用，但我需要做一些额外的数学运算才能找到答案。

我想知道这个问题是否有一些更优雅的解决方案，也许使用更好的查询。

如果您能给我任何反馈，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:55:36.617

这实际上是一个相当健全的查询设置。就个人而言，我建议遵循@inhan 的建议，特别是如果事实证明汽车可以在更短的时间内预订（几小时？）。然而，由于极端情况，查询编写起来有点复杂（如果你看看这里，你应该找到相关的例子）。

不幸的是，我无法说明这如何适合您的框架，但 SQL 可能如下所示：

```
SELECT Cars.car_id, Cars.name, Cars.description
FROM Cars
JOIN (SELECT car_id
      FROM Cars_Availability
      WHERE `date` >= '2013-02-05'
            AND `date` < '2013-02-09'
            AND status = 1
      GROUP BY car_id
      HAVING COUNT(*) = DATEDIFF('2013-02-09', '2013-02-05')) Available
  ON Available.car_id = Cars.car_id 
```

（有一个[SQL Fiddle 示例](http://sqlfiddle.com/#!2/5f970/2)）
此查询假定每天只有一个条目，否则会中断。基本上，它抓取大于/等于开始日期且小于“结束”日期的每个“可用”行（日期/时间/时间戳......很复杂；[本文](https://sqlblog.org/2011/10/19/what-do-between-and-the-devil-have-in-common)处理特定于 SQL Server 的问题，但基本概念适用），并确保它们之间的天数有一个。大多数情况下，您正在寻找该`HAVING`子句。
给定正确的索引`Cars_Availability`，它甚至可能不会上桌，这也使它成为一个很好的表现者。

# opencv - 过滤红色色调 - emgucv/opencv

> ID：14636615
> 
> 赞同：4
> 
> 时间：2013-01-31T22:51:34.767
> 
> 标签：opencv, emgucv

如何过滤红色色调的图像？我知道红色在 330° 和 30° 之间大约为零（在 OpenCV 中用 165 到 15 表示？）。由于在 360°（OpenCV 中为 180）存在溢出，我如何使用 InRange 方法使用该范围？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:48:30.393

我使用以下代码检测 HUE 颜色：

> 垫 img_hsv, dst ;
> 帽子>>图片;
> cvtColor（图像，img_hsv，CV_RGB2HSV）；
> inRange(img_hsv, 标量(110, 130, 100), 标量(140, 255, 255), dst);

其中 dst 是与 img_hsv 和 CV_8U 类型大小相同的 Mat。
你的标量决定了过滤后的颜色。在我的情况下：

HUE 从 110 到 140
SAT 从 130 到 255
VAL 从 100 到 255

更多信息： [OpenCV 2.4 InRange()](http://docs.opencv.org/modules/core/doc/operations_on_arrays.html?highlight=inrange#inrange)

我不确定是否使用超出 180 范围的色调，但我认为您可以单独计算它们，然后添加生成的垫子。

# css - 浮动其子元素也浮动的元素

> ID：14636616
> 
> 赞同：0
> 
> 时间：2013-01-31T22:51:35.757
> 
> 标签：css, styles, css-float

我有一个`div`和一个`ul`我正在尝试浮动以创建两列。中的项目`ul`也是浮动的，因此它们会在垂直包装之前水平扩展：

[http://jsfiddle.net/3dhHe/7/](http://jsfiddle.net/3dhHe/7/)

```
<style type="text/css">
    ul {list-style-type: none;}
    li {float:left; width:275px; min-height: 50px; padding: 12px; border-radius: 4px; border: 2px outset #eee;}
    .float-right {width: 300px; float: right; margin-left: 25px;}
    .float-left {float: left;}
</style>

<div class="float-right">
    This content should float to the right
</div>
<ul class="float-left">
    <li>Item 1</li><li>Item 2</li><li>Item 3</li><li>Item 4</li>
    <li>Item 5</li><li>Item 6</li><li>Item 7</li><li>Item 8</li>
</ul> 
```

如果我从列表项中删除浮点数，那么一切都会按预期工作，但是，当`li`元素应用了浮点数时，`ul`元素似乎“丢失”了它的浮点数。

有没有办法强制 ul 浮动到 div 的左侧，同时允许 ul 的内容浮动？注意：我需要 ul 的宽度是动态的，所以我不能为其设置显式宽度。

谢谢！！！

* * *

## 更新

我正在尝试实现这样的目标： ![浮动 2 列](../Images/9a0c36207752b92b9e27f707f83d8968.png)

右边的文本可以有一个静态的宽度，但`ul`包含的框不应该有一个明确的宽度（这样如果浏览器的宽度增加，那么“测试 3”框将移动到第一行）。

我遇到的问题是，如果我没有在 上设置宽度`ul`，那么文本内容将移到`ul`:

![](../Images/bc1631a40286e5b4fa086b96e8a659a0.png)

有没有办法定位第`div`一个，然后限制`ul`只使用剩余空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:59:25.497

为了实现你的目标：

**1** . 必须在 1 行上水平浮动`li`。`ul`

当实现这一点时：

**2** . 必须在`ul`旁边找到足够的空间`div`才能漂浮在它旁边。

您必须给`ul`a `max-width`，以强制它不要扩展并尽可能多地占用空间，确保它足够，以便它的所有孩子`li`都漂浮在彼此旁边。

如果这`max-width`还不够，那么`li`意志就没有力量说不**！**，并且它们只会在彼此下方换行。

看看：http: [//jsfiddle.net/AliBassam/3EmdM/](http://jsfiddle.net/AliBassam/3EmdM/)

**为什么会这样？**

当您告诉他们`li`时`float:left;`，就好像您在告诉他们：**尽力向左漂浮，尽可能地向左漂浮，哭泣并向您的妈妈（ul）抱怨并告诉她您必须漂浮剩下！我们所有人都在同一条线上！**.

当`ul`注意到不是所有的孩子`li`都漂浮在同一条线上时，它会在下方换一条新线，`div`这样它就可以实现这一点。

这是[另一个示例](http://jsfiddle.net/AliBassam/vAgS8/)，请注意，当 2`li`彼此浮动时**(1)**，并且当有足够的空间让整体`ul`在`div`**(2)**旁边时，它会浮动在它旁边。

这是[另一个](http://jsfiddle.net/AliBassam/C2uh6/)带有 2的示例`divs`，结果相同，第二个`div`不会浮动，直到它的所有子`div`元素都漂浮在其中**(1)并且在另一个**`div`**(2)**旁边找到了足够的空间。

**更新**

您需要的是同时拥有**父 Div**`div`和`ul`内部，这将有一个and ，给它一个最小宽度将允许它在您最大化浏览器时扩展，它会允许它变得更小但仅限于限制.**`div``position:relatve;``min-width`**

 **然后给孩子`div`static `width`，比方说，`250px`，并给`ul`a或多一点（将其视为 a `position:absolute;`）。`right:250px``margin-right`

```
<div style="position:relative; min-width:600px;">
<ul style="position:absolute; right:250px; left:0px; ">
    <li>Test 1</li>
    <li>Test 2</li>
    <li>Test 3</li>
    <li>Test 4</li>
    <li>Test 5</li>
    <li>Test 6</li>
</ul>
<div style="float:right; width:250px;">
    This content should float to the right
    <br />
    This content should float to the right
    <br />
    This content should float to the right
    <br />
    This content should float to the right
</div>
</div> 
```

看看：http: [//jsfiddle.net/AliBassam/FFrev/](http://jsfiddle.net/AliBassam/FFrev/)**

# iphone - 创建 NSURL 但只显示链接文本

> ID：14636619
> 
> 赞同：3
> 
> 时间：2013-01-31T22:51:57.290
> 
> 标签：iphone, ios, uiactivityviewcontroller

我正在使用 UIActivityViewController 在我的应用程序中共享屏幕截图。据我了解，我们可以有一个文本字段、一个图像和一个 URL。我想做的是让我的文本字段中的一个词本身就是一个可点击的 URL。就像是，

“查看我在**myGameName**中的高分！” 其中 myGameName 是指向我的游戏网站的链接。基本上我想要的就像一个 html 链接

```
<a href="url">Link text</a> 
```

实际上仅显示“链接文本”的位置。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:54:07.457

不，文本字段/图像/URL 都是单独的项目，因为某些服务“本机”不支持它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:58:11.617

检查此库以制作属性标签[https://github.com/mattt/TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T01:56:40.173

我想你可以看看[OHAttributedLabel](https://github.com/AliSoftware/OHAttributedLabel)

# php - 使用 simple_html_dom 仅检查类名的一部分

> ID：14636621
> 
> 赞同：0
> 
> 时间：2013-01-31T22:52:01.207
> 
> 标签：php, simple-html-dom

对不起，如果这个问题的标题很差。请允许我解释一下自己（但请记住，我是编程新手，甚至是 StackOverflow 的新手，我都很喜欢这两者）。

基本上，我正在从站点 X 上的 HTML 表格中的特定单元格中抓取数据。特定单元格的名称类似于 id="xyz/part_to_check/"。换句话说，我需要 simple_html_dom 仅从具有以特定名称结尾的类 id 的单元格中提取数据，同时避免其他名称可能都以相同内容开头的单元格。

当我告诉 simple_html_dom 检查一个单元格时，它会类似于

```
$html->find("a[href="name of cell goes here"]"); 
```

我怎样才能让“单元格名称”仅适用于名称以我想要的结尾的单元格？

我希望我在这里有点清楚。如果我不是，我会道歉。再一次，这对整个事情都是新的。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:58:05.160

在符号`$`前加一个：`=`

```
$html->find('a[href$="someValue"]');
//                 ^ This indicates that the href should END with that string. 
```

# c - 如何强制程序使用未对齐的地址？

> ID：14636622
> 
> 赞同：4
> 
> 时间：2013-01-31T22:52:05.907
> 
> 标签：c, linux, multithreading

1.  我听说对齐 int 的读取和写入是原子且安全的，我想知道系统何时使非 malloc 全局变量不对齐，而不是打包结构和强制转换/指针算术字节缓冲区？

2.  [X86-64 linux] 在我所有的正常情况下，系统总是选择不会被撕裂的整数位置，例如，一个字上的两个字节，另一个字上的另外两个字节。任何人都可以发布强制全局变量未对齐地址的程序/片段（C 或程序集），以便整数被撕裂，系统必须使用两次读取来加载一个整数值吗？

    当我打印下面的程序时，地址彼此接近，因此多个变量在 64 位内，但从来没有看到过字撕裂（系统或编译器中的智能？）

    ```
    #include <stdio.h>
    int a;
    char  b;
    char c;
    int      d;
    int e = 0;

    int isaligned(void *p, int N)
    {
        if (((int)p % N) == 0)
            return 1;
        else
            return 0;
    }

    int main()
    {

        printf("processor is %d byte mode \n", sizeof(int *));
        printf ( "a=%p/b=%p/c=%p/d=%p/f=%p\n", &a, &b, &c, &d, &e );

        printf ( " check for 64bit alignment of test result of 0x80 = %d \n", isaligned( 0x80, 64 ));
        printf ( " check for 64bit alignment of a result = %d \n", isaligned( &a, 64 ));
        printf ( " check for 64bit alignment of d  result = %d \n", isaligned( &e, 64 ));

    return 0;} 
    ```

    输出：

    ```
    processor is 8 byte mode 
    a=0x601038/b=0x60103c/c=0x60103d/d=0x601034/f=0x601030
     check for 64bit alignment of test result of 0x80 = 1 
     check for 64bit alignment of a result = 0 
     check for 64bit alignment of d  result = 0 
    ```

3.  在上述情况下如何读取 char ？它是否从 8 字节对齐边界（在我的情况下为 0x601030 ）读取，然后转到 0x60103c ？

4.  内存访问粒度总是字长不是吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T00:01:49.447

1）是的，不能保证未对齐的访问是原子的，因为[至少有时，在某些类型的处理器上]数据可能会作为两个单独的写入写入 - 例如，如果您跨越内存页面边界 [我是不是说虚拟内存的 4KB 页面，我说的是 DDR2/3/4 页面，它是总内存大小的一小部分，通常是 16Kbits 乘以实际内存芯片的宽度 - 这将取决于记忆棒本身]。同样，在 x86 以外的其他处理器上，您会遇到读取未对齐内存的陷阱，这将导致程序中止，或者在软件中将读取模拟为多次读取以“修复”未对齐读取。

2）您始终可以通过以下方式创建未对齐的内存区域：

```
char *ptr = malloc(sizeof(long long) * number+1);
long long *unaligned = (long long *)&ptr[2];

for(i = 0; i < number; i++)
   temp = unaligned[i]; 
```

顺便说一句，您的对齐检查检查地址是否对齐到 64 字节，而不是 64 位。您必须除以 8 以检查它是否与 64 位对齐。

3) char 是单字节读取，地址将在字节本身的实际地址上。实际执行的内存读取可能是针对完整的缓存线，从目标地址开始，然后循环，例如：

0x60103d 是目标地址，因此处理器将从我们想要的 64 位字开始读取 32 字节的缓存行：0x601038（一旦完成，处理器就会继续执行下一条指令 - 同时下一次读取将执行填充缓存线），然后缓存线填充0x601020、0x601028、0x601030。但是如果我们关闭缓存[如果您希望您的 3GHz 最新 x86 处理器比 66MHz 486 稍慢，禁用缓存是实现此目的的好方法]，处理器将只读取 0x60103d 处的一个字节。

4) 不是在 x86 处理器上，它们具有字节寻址 - 但对于普通内存，读取是在高速缓存线的基础上完成的，如上所述。

还要注意，“可能不是原子的”与“不会是原子的”完全不同——所以你可能很难按意愿让它出错——你真的需要得到两个不同的所有时间线程恰到好处，并且跨越缓存线，跨越内存页面边界等等以使其出错 - 如果您不希望它发生，就会发生这种情况，但试图让它出错可能很难[相信我，我去过那里，做到了]。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T23:05:38.550

1）这个答案是特定于平台的。但是，一般来说，编译器会对齐变量，除非您强制它这样做。

2) 在 32 位 CPU 上运行时，以下内容需要两次读取才能加载一个变量：

```
uint64_t huge_variable; 
```

该变量比寄存器大，因此需要多次操作才能访问。你也可以通过使用打包结构来做类似的事情：

```
struct unaligned __attribute__ ((packed))
{
    char buffer[2];
    int  unaligned;
    char buffer2[2];
} sample_struct; 
```

3）这个答案是特定于平台的。某些平台的行为可能与您描述的一样。一些平台具有能够获取数据的半寄存器或四分之一寄存器的指令。我建议检查编译器发出的程序集以获取更多详细信息（确保首先关闭所有编译器优化）。

4) C 语言允许您以字节大小的粒度访问内存。这是如何在后台实现的，以及您的 CPU 获取多少数据来读取单个字节是特定于平台的。对于许多 CPU，这与通用寄存器的大小相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T23:03:08.670

1.  在这些情况之外，它可能不会。

2.  在组装中它是微不足道的。就像是：

    ```
     .org 0x2
    myglobal:
         .word SOME_NUMBER 
    ```

    但是在 Intel 上，处理器可以安全地读取未对齐的内存。它可能不是原子的，但从生成的代码中可能并不明显。

3.  英特尔，对吧？Intel ISA 具有单字节读/写操作码。反汇编你的程序，看看它在使用什么。

4.  不一定 - 您可能在内存字长和处理器字长之间存在不匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T00:06:34.060

1.  C 标准保证`malloc(3)`返回符合最严格对齐要求的内存区域，因此在这种情况下不会发生这种情况。如果有未对齐的数据，它可能是按片段读取/写入的（这取决于架构提供的确切保证）。
2.  在某些架构上允许未对齐的访问，在其他架构上这是一个致命错误。如果允许，它通常*比*对齐访问慢得多；当不允许时，编译器必须将这些部分拼接在一起，这甚至*要*慢得多。
3.  通常允许字符（实际上是字节）具有任何字节地址。在这种情况下，使用字节的指令只是获取/存储单个字节。
4.  不，内存访问是根据数据的宽度。但*真正的*内存访问是根据高速缓存行（为此在[CPU 高速缓存](http://en.wikipedia.org/wiki/CPU_cache)上读取）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-01T00:56:51.533

如果不调用未定义的行为，非对齐对象永远不会存在。换句话说，没有任何动作序列，所有动作都具有明确定义的行为，程序可以采取这将导致非对齐指针的存在。特别是，没有可移植的方法让编译器为您提供未对齐的对象。最接近的是许多编译器具有的“打包结构”，但这仅适用于结构成员，而不适用于独立对象。

此外，没有办法在可移植 C 中测试对齐性。您可以使用实现定义的指针到整数的转换并检查低位，但没有基本要求“对齐”指针在低位中具有零，或者转换为整数后的低位甚至对应于指针的“最低有效”位，无论这意味着什么。换句话说，指针和整数之间的转换不需要进行算术运算。

如果您真的想制作一些未对齐的指针，假设`alignof(int)>1`，最简单的方法是：

```
char buf[2*sizeof(int)+1];
int *p1 = (int *)buf, *p2 = (int *)(buf+sizeof(int)+1); 
```

如果大于 1 *，*两者`buf`和`buf+sizeof(int)+1`同时对齐是不可能的。因此，两个强制转换中的至少一个应用于未对齐的指针，调用未定义的行为，典型结果是未对齐的指针。*`int``alignof(int)``(int *)`*

# ios - 在自定义范围滑块上设置 alpha (NMRangerSlider)

> ID：14636623
> 
> 赞同：1
> 
> 时间：2013-01-31T22:52:09.553
> 
> 标签：ios, objective-c

我正在使用 muZZkat 的自定义范围滑块：NMRangeSlider@github [1](https://github.com/muZZkat/NMRangeSlider)

但我需要淡化滑块。当我创建范围滑块时，我将其放入内容视图中。我尝试将内容视图的 alpha 设置为 0.7

```
UIView *sliderView = [self configureLabelSliderWithSize:CGSizeMake(300, 70)];

sliderView.alpha = .4; 
```

但它没有产生预期的效果：

![在此处输入图像描述](../Images/a180ae67e55d90068696f8feea22b7fb.png)

upperHandle`UIImageView`和 lowerHandle 也淡出显示背景轨道（蓝色部分）。我宁愿让手柄的 alpha 更高，这样你就看不到它后面的蓝色部分。

我尝试向游侠滑块类添加一个方法：

```
-(void)toggleAlpha {
    self.trackBackground.alpha = .3;
    self.track.alpha = .3;
    self.lowerHandle.alpha = .3;
    self.upperHandle.alpha = .3;
} 
```

但这根本不会改变 alpha。

UIImageViews 都在`-(void)addSubviews`方法中初始化：

```
- (void) addSubviews
{
    //------------------------------
    // Track Brackground
    self.trackBackground = [[UIImageView alloc] initWithImage:self.trackBackgroundImage];
    self.trackBackground.frame = [self trackBackgroundRect];

    //------------------------------
    // Track
    self.track = [[UIImageView alloc] initWithImage:self.trackImage];
    self.track.frame = [self trackRect];

    //------------------------------
    // Lower Handle Handle
    self.lowerHandle = [[UIImageView alloc] initWithImage:self.lowerHandleImageNormal highlightedImage:self.lowerHandleImageHighlighted];
    self.lowerHandle.frame = [self thumbRectForValue:_lowerValue image:self.lowerHandleImageNormal];

    //------------------------------
    // Upper Handle Handle
    self.upperHandle = [[UIImageView alloc] initWithImage:self.upperHandleImageNormal highlightedImage:self.upperHandleImageHighlighted];
    self.upperHandle.frame = [self thumbRectForValue:_upperValue image:self.upperHandleImageNormal];

    [self addSubview:self.trackBackground];
    [self addSubview:self.track];
    [self addSubview:self.lowerHandle];
    [self addSubview:self.upperHandle];
} 
```

如果我在这里将它们的 alpha 设置得较低，它就可以工作。

我不明白为什么我不能从其他任何地方更改 alpha？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:45:41.757

我刚刚添加了 NMRangeSlider-Demo 并检查了它。我认为问题在于您可能在 viewDidLoad 方法中调用**了 toggleAlpha ，对吗？**

您应该调用 viewDidAppear 方法，因为 NMRangeSlider 类中的 layoutSubviews 方法（又调用 addSubview）是在 viewDidLoad 之后和 viewDidAppear 之前调用的，因此您在 viewDidLoad 中所做的任何事情都将在 addSubview 方法中初始化子视图时被重置。

只需在 viewDidAppear 中添加 toggleAlpha 对我有用。

# python - 在 Python 中编写仅附加 gzip 压缩的日志文件

> ID：14636640
> 
> 赞同：6
> 
> 时间：2013-01-31T22:53:22.733
> 
> 标签：python, gzip

我正在构建一项服务，在该服务中记录来自多个来源的纯文本格式日志（每个来源一个文件）。我不打算轮换这些日志，因为它们必须永远存在。

为了使这些文件永远变小，我希望我可以对它们进行 gzip 压缩。由于它们是日志数据，因此文件压缩得非常好。

在 Python 中编写仅附加的 gzip 压缩文本文件的好方法是什么，以便以后可以在服务开启和关闭时恢复写入？我并不担心丢失几行，但如果 gzip 容器本身发生故障并且文件变得不可读，那就不行了。

另外，如果不行，我可以简单地将它们写成纯文本而不用 gzip 压缩，如果它不值得麻烦的话。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T22:56:31.430

注意：在 unix 系统上，您应该认真考虑使用为这个确切任务编写的外部程序：

*   [`logrotate`](http://linuxcommand.org/man_pages/logrotate8.html)（旋转、压缩和邮寄系统日志）

您可以将*旋转*次数设置得如此之高，以至于第一个文件将[在 100 年](https://serverfault.com/a/50185/4346)左右被删除。

* * *

在 Python 2 中，`logging.FileHandler`接受一个`encoding`可以设置为`bz2`or的关键字参数`zlib`。

这是因为`logging` [使用](http://hg.python.org/cpython/file/8ee6d96a1019/Lib/logging/__init__.py#l919)了该`codecs`模块，该模块又将`bz2`(or `zlib`) 视为*encoding*：

```
>>> import codecs
>>> with codecs.open("on-the-fly-compressed.txt.bz2", "w", "bz2") as fh:
...     fh.write("Hello World\n")

$ bzcat on-the-fly-compressed.txt.bz2 
Hello World 
```

* * *

Python 3 版本（尽管文档[中提到](http://docs.python.org/3.3/library/codecs.html#standard-encodings) `bz2`了别名，但您实际上必须使用`bz2_codec`- 至少使用 3.2.3）：

```
>>> import codecs
>>> with codecs.open("on-the-fly-compressed.txt.bz2", "w", "bz2_codec") as fh:
...     fh.write(b"Hello World\n")

$ bzcat on-the-fly-compressed.txt.bz2 
Hello World 
```

# nhibernate - 修剪字符串 NHIBERNATE

> ID：14636655
> 
> 赞同：4
> 
> 时间：2013-01-31T22:54:41.880
> 
> 标签：nhibernate

不敢相信我没有找到答案，但你怎么能做这样的查询

```
SELECT LTRIM(RTRIM("ColumnName")) FROM .... 
```

在 NHibernate

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T05:09:17.400

以银行为 POCO 的示例：

```
public class Bank
{
  public virtual int    ID { get; set; }
  public virtual string City { get; set; }
  public virtual string Street { get; set; }
} 
```

有一个语法`LTRIM(RTRIM...`

```
Bank bank = null;
var session = ...;
var query = session.QueryOver<BankAddress>()
  .SelectList(l => l

    // properties ID, City
    .Select(c => c.ID).WithAlias(() => bank.ID)
    .Select(c => c.City).WithAlias(() => bank.City)  

    // projection Street 
    .Select(Projections.SqlProjection(               
        " LTRIM(RTRIM({alias}.Street)) as Street"  // applying LTRIM(RTRIM
        , new string[] { "Street" }
        , new IType[] { NHibernate.NHibernateUtil.String }
  ))
  .TransformUsing(Transformers.AliasToBean<Bank>())
  ;

var list = query.List<Bank>(); 
```

# javascript - 将代码转换为 RequireJS

> ID：14636659
> 
> 赞同：0
> 
> 时间：2013-01-31T22:54:58.687
> 
> 标签：javascript, design-patterns, module, requirejs

*TL; DR 在问题的底部，对于那些不想阅读我所有垃圾的人。*

我目前的 JavaScript 模块化方法是简单地创建一个全局锚点，例如“csc”（我公司的首字母缩写词），然后开始在其上添加模块。

所以我最终会得到一个全局结构，如：

```
csc.
    Utils 
    Map
       .Geolocation
    Storage.
            Cookie
            DB 
```

这些文件中的每一个都存储在一个目录结构中：

```
csc.js
csc.Utils.js
csc.Map.js
csc.Storage.js 
```

这消除了一直加载我的整个代码库的需要。

我正在尝试过渡到使用 RequireJS，但该库采用的方法似乎有点不同。

为了维护我的命名空间结构，我可以围绕我的所有模块定义模块，但仍然将它们添加到全局“csc”引用中。然而，这似乎违背了 Require 的核心原则。

但是，如果不将它们保持在全局范围内，我就会失去我漂亮的命名空间，例如“csc.Map.Geolocation”，因为我现在有一堆单独的变量，如下所示：

```
require(['csc', 'csc.Utils', 'csc.Map'], function (csc, utils, map) {
}); 
```

如果我上面可怕的描述还不够，我会将我的问题归结为本质：

**有没有办法，也许在模块定义中，将这三个变量组合回这个问题顶部定义的结构？还是我做错了，我应该坚持 Require 做事的方式吗？我很想遵循 Require 方法，但我也喜欢让我的所有模块都可链接和命名空间的能力。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:19:08.243

不要对文档的示例路径层次结构感到气馁，请注意 require 并没有严格执行任何特定的约定。您可以自由设计和遵循自己的约定。

`Utils`, `Map`, 和`Storage`都成为目录。它们执行的基本操作应`module.js`在各自的目录中命名，如下所示：

```
core.js
Utils/
      module.js
Map/
    module.js
    geolocation.module.js
Storage/
        module.js
        cookie.module.js
        db.module.js 
```

这些`module.js`文件包括并返回他们的孩子。这是 Storage/module.js 的示例：

```
require(["Storage/cookie", "Storage/db"], function (cookie, db) {
    var Storage = {};
    // do whatever you need with Storage
    Storage.cookie = cookie
    Storage.db = db

    return Storage
}); 
```

还要注意`core.js`根目录中的文件。这个文件的工作原理是一样的，

```
require(["Utils/module", "Storage/module", "Map/module"], function (utils, storage, map) {
    var Core = {};
    // do whatever you need with Storage
    Core.Utils = utils
    Core.Storage = storage
    Core.Map = map

    return Core
}); 
```

现在，无论您需要访问这些模块（基本上是每个文件），都需要 core.js。*是的，这将在 development 中*一直加载所有涉及的文件，但是当你编译你的应用程序时，你的所有变量都将在匿名函数的范围内，并且不能通过 window 对象直接访问。

再次，根据您的需要进行调整，这是您自己的约定。

# html - 页脚下方的额外空白

> ID：14636664
> 
> 赞同：1
> 
> 时间：2013-01-31T22:55:18.887
> 
> 标签：html, css

在页脚下方，我看到了额外的空白......如何删除额外的空白......我降低了容器的高度，但即使它不起作用......如何修复它......

在下面提供我的小提琴

[http://jsfiddle.net/h8J4p/embedded/result/](http://jsfiddle.net/h8J4p/embedded/result/)

```
<div class="footer">
       <!-- <p>&copy; Company 2012</p>-->
       <p>Copyright© www.defie.co. All rights reserved.</p>

      </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:20:45.893

首先，您需要通过使用以下内容来消除正文默认具有的额外填充和边距：

```
body {padding:0;margin:0;} 
```

其次，您需要删除@Sport Billy 指出的实体如果仍然有问题，请检查上一个元素。你可能有`margin-bottom`或`padding-bottom`在最后一个元素中

如果这些都不起作用，`position:relative;`请正确使用和定位元素。但将其用作最后的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:14:50.313

有一些空白被转换为`&#8203;`javascript 下方的实体，包括在页脚之后。尝试删除它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T23:27:45.960

所有 css 文件的最佳解决方案...使用此通配符，您将所有边距和填充重置为零

```
*{
 margin:0;
 padding:0;
} 
```

# c - MATLAB 的 tic-toc 和 C 的时钟差异

> ID：14636665
> 
> 赞同：8
> 
> 时间：2013-01-31T22:55:30.853
> 
> 标签：c, matlab, time, mex

在使用 MEX 编译后，我编写了一些 C 代码，我称之为 MATLAB。在 C 代码中，我使用以下代码测量*部分计算的时间：*

```
clock_t begin, end;
double time_elapsed;
begin = clock();
/* do stuff... */
end = clock();
time_elapsed = (double) ((double) (end - begin) / (double) CLOCKS_PER_SEC); 
```

Elapsed time 应该是以秒为单位的执行时间。

然后我将值输出`time_elapsed`到 MATLAB（它已正确导出；我检查了）。然后在 MATLAB 端我调用这个 C 函数（在我使用 MEX 编译它之后）并使用`tic`and测量它的执行时间`toc`。事实证明完全荒谬的是，我使用 tic 和 toc 计算的时间是 0.0011 秒（500 次运行的平均值，st.dev. 1.4e-4），而 C 代码返回的时间是 0.037 秒（ 500 次运行的平均值，标准偏差 0.0016）。

在这里，人们可能会注意到两个非常奇怪的事实：

1.  整个函数的执行时间低于部分代码的执行时间。因此，MATLAB 或 C 的测量非常不准确。
2.  在 C 代码中测量的执行时间非常分散，并且表现出非常高的 st。偏差（变异系数为 44%，而 tic-toc 仅为 13%）。

这些计时器是怎么回事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-01T03:44:14.340

您正在将苹果与橙子进行比较。

查看 Matlab 的文档：

*tic* - [http://www.mathworks.com/help/matlab/ref/tic.html](http://www.mathworks.com/help/matlab/ref/tic.html)
*toc* - [http://www.mathworks.com/help/matlab/ref/toc.html](http://www.mathworks.com/help/matlab/ref/toc.html)

*tic*和*toc 可*让您测量实际经过的时间。

现在看看*时钟*函数[http://linux.die.net/man/3/clock](http://linux.die.net/man/3/clock)。

尤其，

> clock() 函数返回程序使用**的处理器时间的近似值**。
> 
> 返回的值是**到目前为止**作为clock_t使用的CPU时间；要获得使用的秒数，请除以 CLOCKS_PER_SEC。如果使用的处理器时间不可用或其值无法表示，则函数返回值 (clock_t) -1。

那么什么可以解释你的差异：

*   CPU 时间（由 clock() 测量）和实际运行时间（由 tic 和 toc 测量）是不一样的。所以你会期望cpu时间小于经过时间？也许。如果您在 0.0011 秒内以 100% 的速度驱动 10 个内核怎么办？这意味着 clock() 测量值是 tic 和 toc 测量值的 10 倍。可能，不太可能。
*   clock(.) 非常不准确，并且与文档一致，它是一个**近似**的cpu 时间测量值！我怀疑它与调度程序量子大小挂钩，但我没有深入研究 Linux 内核代码来检查。我也没有检查其他操作系统，但是[这个家伙的博客](http://www.guyrutenberg.com/2007/09/10/resolution-problems-in-clock/)与那个理论是一致的。

那么该怎么办...首先，将苹果与苹果进行比较！接下来，确保您考虑计时器分辨率。

# gis - OpenLayers 中的 WFS 层向服务器查询 GML 数据，但不显示返回的数据

> ID：14636668
> 
> 赞同：0
> 
> 时间：2013-01-31T22:56:01.583
> 
> 标签：gis, openlayers

我已将 WFS 图层添加到地图中，并且可以看到（使用 Fiddler）向服务器发出请求以获取图层数据。服务器使用 GML 作为数据格式，返回的数据是有效的。但是，OpenLayers 不显示数据。这是我使用的代码。

```
$(document).ready(
        function () {
            // allow testing of specific renderers via "?renderer=Canvas", etc
            var renderer = OpenLayers.Util.getParameters(window.location.href).renderer;
            renderer = (renderer) ? [renderer] : OpenLayers.Layer.Vector.prototype.renderers;
            var geographic = new OpenLayers.Projection("EPSG:4326");
            var mercator = new OpenLayers.Projection("EPSG:900913");

            map = new OpenLayers.Map({
                div: "map",
                layers: [
                    new OpenLayers.Layer.WMS("OpenLayers WMS",
                        "http://vmap0.tiles.osgeo.org/wms/vmap0",
                        { layers: "basic" }
                    ),
                    new OpenLayers.Layer.Vector("GML", {
                        strategies: [new OpenLayers.Strategy.Fixed()],
                        protocol: new OpenLayers.Protocol.WFS({
                                url: "http://localhost/MapServer/Default.aspx",
                                featureType: "Layer_ACTIVE",
                                featureNS: "http://www.tstgis.org/gml",
                                version: "1.1.0",
                                geometryName: "line"
                            }),
                            renderers: renderer
                        })
                ],
                zoom: 15
            });

            var bb = new OpenLayers.Bounds(-179.821327209473, 12.1057098342161, -56.5289154052734, 78.1442901657839);
            map.zoomToExtent(bb);
}); 
```

该测试脚本是在 localhost/mapserver 下运行的 HTML shell 的一部分，因此它排除了熟悉的跨域问题。

到底是怎么回事？注意：返回的数据集非常大（1.5 MB），我想知道这是否与丢失的显示有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T20:05:21.343

我毫不怀疑这是 OpenLayers 的配置问题。根据我对 OpenLayers 的了解，我已经正确配置了它。事实证明，就我而言，设置 featurePrefix 选项是必不可少的。这样做的原因是每个 FeatureMember 节点的 XML 响应 (GML) 中的名称空间和前缀用于识别响应的适当读取器。默认情况下，featurePrefix 设置为“功能”。如果响应的命名空间 + 前缀与 OpenLayers 中的配置不匹配，则特征不会添加到图层中，因此不会显示。在我的情况下，前缀设置为空字符串，因为服务器不会向响应添加前缀。

此外，设置 geometryName 也很关键。对于 WFS 版本 1.0，geometryName 的默认值是“the_geom”，对于更高版本，默认值为 null。服务器使用geometryName 来实际定位要素。就我而言，服务器上使用的geometryName 是“msGeometry”。

这是工作代码。

```
$(document).ready(
function () {
    // allow testing of specific renderers via "?renderer=Canvas", etc
    var renderer = OpenLayers.Util.getParameters(window.location.href).renderer;
    renderer = (renderer) ? [renderer] : OpenLayers.Layer.Vector.prototype.renderers;
    var geographic = new OpenLayers.Projection("EPSG:4326");
    var mercator = new OpenLayers.Projection("EPSG:900913");

    map = new OpenLayers.Map({
        div: "map",
        layers: [
            new OpenLayers.Layer.WMS("OpenLayers WMS",
                "http://vmap0.tiles.osgeo.org/wms/vmap0",
                { layers: "basic" }
            ),
            new OpenLayers.Layer.Vector("GML", {
                strategies: [new OpenLayers.Strategy.Fixed()],
                protocol: new OpenLayers.Protocol.WFS({
                        url: "http://localhost/MapServer/Default.aspx",
                        featureType: "Data_ACTIVE",
                        version: "1.1.0",
                        geometryName: "msGeometry",
                        featurePrefix: ""
                    }),
                    renderers: renderer
                })
        ],
        zoom: 15
    });

    var bb = new OpenLayers.Bounds(-179.821327209473, 12.1057098342161, -56.5289154052734, 78.1442901657839);
    map.zoomToExtent(bb); 
```

});

# javascript - 需要具有与 Flash 相同结果的解决方案 - 符合 HTML 5

> ID：14636669
> 
> 赞同：-1
> 
> 时间：2013-01-31T22:56:02.493
> 
> 标签：javascript, html, flash, adobe-edge

我曾经建立使用 Flash 制作背景动画和背景电影的网站，同时在顶部放置常规（可选）Html 文本。

Flash 确实符合要求，因为它允许在动画本身内流式传输电影，因此您可以很好地分层并获得一个非常有创意的网站。

但闪电侠正在消亡……

所以我在这里问各位好人，我应该寻找什么解决方案（或多个解决方案）才能在现代非 Flash 平台（网络移动等）中实现相同的目标。

它需要：

*   **创建可以在其中包含电影文件的动画。我需要从动画中控制电影，而不仅仅是将它们作为背景**

注意：我已经查看了将电影作为网站背景的各种插件等，但这不会产生我需要的结果，因为它只是电影播放，不能像 Flash 中的动画那样编写脚本。我还检查了 Adob​​e Edge。它最接近我的需要，但我发现无法像在 Flash 中那样处理其中的视频 - 如果我错了，请纠正我。

无论如何，我都不是 Javascript 大师。我会更深入地研究它，但我不确定它是否能满足我的需要。

我希望我没有把你这个冗长的问题弄糊涂，我感谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:09:09.693

Try the html canvas element. You can pipe video to the canvas using a hidden video element and any animation you can think of is possible through canvas. Since these are dom elements, you can of course put other HTML on top of them.

For good canvas frameworks check: [http://www.backslash.gr/content/blog/webdevelopment/7-10-javascript-canvas-frameworks](http://www.backslash.gr/content/blog/webdevelopment/7-10-javascript-canvas-frameworks)

I'm personally a big fan of paper.js and processing.js

# objective-c - Objective-C 中子类化的设计复杂性

> ID：14636672
> 
> 赞同：1
> 
> 时间：2013-01-31T22:56:27.247
> 
> 标签：objective-c, cocos2d-iphone, subclassing

我正在使用 Cocos2D for iOS，但您很可能不必熟悉 Cocos2D，只需 Obj-C 即可回答我的问题。

我在开发这个游戏时有一个敌人类，我已经使用了很长时间，但现在它已经达到了一个复杂的程度，我需要做一些事情来使它更有条理和可读性。

它目前的工作方式是这样的：我有一个敌人类，我分配了一定次数并插入到一个可变数组中。然后我可以随时翻阅那个可变数组。当敌人类被分配时，它也被引导初始化并传递一个敌人名称的字符串。在它的 init 中有一系列 if/if else 语句检查敌人名称并为其设置正确的值。这工作得很好，除了设计方面，当我添加越来越多的敌人时，查看所有这些名称会变得非常混乱。

我现在想做的是从所有不同敌人的敌人类别中分离出来。我需要访问敌人的属性，就像我访问该类的其他类型的敌人一样。

现在在敌人类初始化中，我有类似的东西：

```
-(id) initWithEnemy:(NSString *)kind {

    if([kind isEqualToString:@"enemyName"]){

    //set values

    }
    else if([kind isEqualToString:@"anotherEnemyName"]){

    //set values

    }

    //etc, etc..

} 
```

现在我想让这个设定值发生在其他文件中。每个敌人的一个或一组头文件/主文件。所以在 initWithEnemy 中，我想也许我可以从传递的“kind”字符串中分配一个敌人名称类。不确定我是否可以使用 NSClassFromString。我已经对其进行了一些试验，但我不确定如何像以前那样访问类属性。即使我确实以与以前相同的方式访问属性，这是否意味着所有敌人名称类都必须具有所有相同数量的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:18:42.923

1.  而不是字符串，声明一个`enum`

    ```
    typedef enum {
        kEnemyInvalid = 0,
        kEnemyName1,
        kEnemyName2,
        [...]
    } EnemyType; 
    ```

2.  `Enemy`为所有敌人类型创建一个具有全局属性的类。

3.  为每种类型创建必要的敌人子类。一个班级可能会涵盖不止一种敌人类型。
4.  创建一个函数（可能是一个类方法）

    ```
    Class EnemyClassFromEnemyType(EnemyType type) {
        switch (type) {
            case kEnemyName1:
               return [EnemyName1 class];
            case kEnemyName2:
               return [EnemyName2 class];
            default:
               return Nil;
        }
    } 
    ```

    这个函数在敌人类型和实现它的类之间建立了联系。有一些方法可以让它更漂亮，我首选的方法是使用 X-Macros。

5.  现在让我们创建一个工厂方法来创建敌人

    ```
    + (Enemy*)createEnemyWithType:(EnemyType*)enemyType {
        Class enemyClass = EnemyClassFromEnemyType(enemyType);
        return [[enemyClass alloc] initWithType:enemyType];
    } 
    ```

**使用 X-Macros 也一样**

头文件

```
#define ENEMY_DEFINITIONS \
  ENEMY_DEFINITION(kEnemyInvalid, = 0, Nil) \
  ENEMY_DEFINITION(kEnemyName1,, [EnemyName1 class]) \
  ENEMY_DEFINITION(kEnemyName2,, [EnemyName2 class])

#define ENEMY_DEFINITION(name, intValue, enemyClass) name intValue, 

/**
 * Your enum declaration.
 */
typedef enum {
    ENEMY_DEFINITIONS
} EnemyType;

#undef ENEMY_DEFINITION

Class EnemyClassFromEnemyType(EnemyType type);
NSString* NSStringFromEnemyType(EnemyType type);
```

实施文件

```
#define ENEMY_DEFINITION(name, intValue, enemyClass) [name] = @#name,

NSString* EnemyTypeStringTable[] = {
    ENEMY_DEFINITIONS
}

#undef ENEMY_DEFINITION

NSString* NSStringFromEnemyType(EnemyType type) {
    return EnemyTypeStringTable[type]
}

#define ENEMY_DEFINITION(name, intValue, enemyClass) classTable[name] = enemyClass;

Class EnemyClassFromEnemyType(EnemyType type) {
    static Class* classTable = nil;

    if (classTable == nil) {
        classTable = malloc(sizeof(Class) * sizeof(EnemyTypeStringTable) / sizeof(NSString*));

        ENEMY_DEFINITIONS
    }

    return classTable[type];
}

#undef ENEMY_DEFINITION
```

使用 X-Macros 技术的美妙之处在于您将所有东西都放在一个地方，您可以轻松添加更多类型而无需更改任何其他内容。你会得到类似 Java 枚举的东西，因为枚举可以有属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T23:06:43.670

您可以将敌人拆分为具有具体子类的抽象基类——这是一个好方法。但是请注意，使用组合而不是继承通常会更好 - 这是您将对象注入到持有者类中以建模某些东西的地方。否则，您可能会遇到一个问题，即您的敌人既是“怪物”又是“巫师”，而单一继承链不允许这样做。

这里有两种设计模式似乎很合适——它们都专注于将复杂的实例化规则与类本身解耦。一种是***工厂模式***，另一种是***建造者模式***。如果您拆分为类层次结构，则前者是合适的，否则是后者。

抱歉，无法提供更多示例 - 在 iPad 上和出门的路上写这个。

# javascript - 车把内动作助手的范围#each循环

> ID：14636679
> 
> 赞同：2
> 
> 时间：2013-01-31T22:57:18.747
> 
> 标签：javascript, ember.js, handlebars.js

我对 {{#each}} 块内的范围感到困惑。

如果我有车把脚本

```
<script type="text/x-handlebars">
      {{#each vars}}
      <button {{action foo}}> {{name}} </button>
      {{/each}}
</script> 
```

我将我的应用程序控制器设置为

```
App.ApplicationController = Ember.Controller.extend({
    vars: Ember.ArrayController.create({
        content: [
            {   name: "Cow",
                foo: function(){console.log("moo");}
            },
            {   name: "Cat",
                foo: function(){console.log("meow");}
            }
        ]
    })
}); 
```

该脚本可以`{{name}}`正常查看并将其作为您期望的按钮标题放入，但操作不会绑定到 `foo` 数组成员中定义的函数。

有没有办法做到这一点，我错过了，还是我需要重构以`foo`直接在内部定义`ApplicationController`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T19:53:55.087

您可以设置事件`ApplicationController`并传入单个对象并调用存储的`foo()`. 在`{{#each vars}}...{{/each}}`块内部，您可以使用`this`将实际对象传递给事件处理程序。

**JS：**

```
App.ApplicationController = Ember.Controller.extend({
    vars: Ember.ArrayController.create({
        content: [
            {   name: "Cow",
                foo: function(){console.log("moo");}
            },
            {   name: "Cat",
                foo: function(){console.log("meow");}
            }
        ]
    }),
  doFoo: function(obj) {
    obj.foo();
  }
}); 
```

**车把：**

```
{{#each vars}}
      <button {{action doFoo this}}> {{name}} </button>
{{/each}} 
```

[JSBin 示例](http://jsbin.com/adedag/62/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:02:54.107

[车把模板中的操作未触发](https://stackoverflow.com/questions/9479437/action-in-handlebars-template-not-firing)

这可能是由于根元素，请在此处查看此帖子以获取更多信息

# java - Java AES 加密适用于单元测试。但从 UDP/TCP 传入时失败

> ID：14636682
> 
> 赞同：1
> 
> 时间：2013-01-31T22:57:34.890
> 
> 标签：java, encryption

我的代码

```
import java.security.*;
import java.security.spec.InvalidKeySpecException;
import javax.crypto.*;
import javax.crypto.spec.SecretKeySpec;

import sun.misc.*;

import org.apache.commons.codec.binary.Base64;

public class FrontierCipher
{
    private static final String ALGO = "AES";
    private static String keyString = "00112233445566778899AABBCCDDEEFF0123456789ABCDEF0123456789ABCDEF";

     private static Key generateKey() throws Exception 
     {
        Key key = new SecretKeySpec(convertToByteArray(keyString), ALGO);
        return key;
    }
    public static byte[] encryptBytes(byte[] data) throws Exception
    {
        Key key = generateKey();
        Cipher c = Cipher.getInstance(ALGO);
        c.init(Cipher.ENCRYPT_MODE, key);

        byte[] encVal = c.doFinal(data);
        byte[] encryptedValue = Base64.encodeBase64(encVal);

        return encryptedValue;
    }

    public static byte[] decrpytBytes(byte[] encryptedData) throws Exception
    {   
        Key key = generateKey();
        Cipher c = Cipher.getInstance(ALGO);
        c.init(Cipher.DECRYPT_MODE, key);

        byte[] decordedValue = Base64.decodeBase64(encryptedData);
        byte[] decValue = c.doFinal(decordedValue);

        return decValue;
    }

    public static byte[] convertToByteArray(String key) throws KeySizeException
    {
        if(key.length()<64)
            throw new KeySizeException("Key must contain 64 characters");

        byte[] b = new byte[32];

        for(int i=0, bStepper=0; i<key.length()+2; i+=2)
            if(i !=0)
                b[bStepper++]=((byte) Integer.parseInt((key.charAt(i-2)+""+key.charAt(i-1)), 16));

        return b;
    }

    public static void main(String[] args) throws Exception
    {
        byte[] password  = {6,75,3};
        byte[] passwordEnc = encryptBytes(password);
        byte[] passwordDec = decrpytBytes(passwordEnc);

        System.out.println("Plain Text : " + password[0]+" "+ password[1]+" "+ password[2]);
        System.out.println("Encrypted Text : " + passwordEnc[0]+" "+ passwordEnc[1]+" "+ passwordEnc[2]);
        System.out.println("Decrypted Text : " + passwordDec[0]+" "+passwordDec[1]+" "+passwordDec[2]);
    }
} 
```

**在本地运行时**

```
Plain Text : 6 75 3
Encrypted Text : 74 43 117
Decrypted Text : 6 75 3 
```

**运行时，等待 udp 数据包来我得到这个**

```
 javax.crypto.IllegalBlockSizeException: Input length must be multiple of 16 when decrypting with padded cipher
    at com.sun.crypto.provider.SunJCE_f.b(DashoA13*..)
    at com.sun.crypto.provider.SunJCE_f.b(DashoA13*..)
    at com.sun.crypto.provider.AESCipher.engineDoFinal(DashoA13*..)
    at javax.crypto.Cipher.doFinal(DashoA13*..) 
```

**测试服务器使用**

```
private static void udpServer()
    {
        try
        {      //This is whats coming in ==> byte[] password={6,75,3};

            DatagramSocket serverSocket = new DatagramSocket(18000);
            byte[] receiveData = new byte[64];

            while (true)
            {
                DatagramPacket receivePacket = new DatagramPacket(receiveData, receiveData.length);
                serverSocket.receive(receivePacket);

                byte[] b = decrpytBytes(receivePacket.getData());
            }
        }
        catch(Exception e)
        {
            //blahh
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T00:10:06.683

好的，这是一个糟糕的例子，我稍后会更新，我得睡觉了。

请注意，使用 ECB 编码对于普通数据总是不安全的。当可能发生中间人攻击（填充 Oracle 攻击）时，CBC 编码非常不安全。但它应该工作。如果您有更新的 Java 7，请尝试使用`"AES/GCM/NoPadding"`并且不要忘记将随机 IV 发送到另一端。

```
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetSocketAddress;
import java.net.SocketException;
import java.nio.charset.Charset;

import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public class UDP_AES {

    /**
     * @param args
     * @throws SocketException 
     */
    public static void main(String[] args) throws SocketException {

        Thread t = new Thread(new Runnable() {
            DatagramSocket socket;
            byte[] receiveData = new byte[1024];
            Cipher aesCipher;

            {
                try {
                    socket = new DatagramSocket(18000);
                    aesCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
                    IvParameterSpec zeroIV = new IvParameterSpec(new byte[aesCipher.getBlockSize()]);
                    SecretKey key = new SecretKeySpec(new byte[] { 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7,}, "AES");
                    aesCipher.init(Cipher.DECRYPT_MODE, key, zeroIV);
                } catch (Exception e) {
                    throw new IllegalStateException("Could not create server socket or cipher", e);
                }

            }

            @Override
            public void run() {
                while (true) {
                    DatagramPacket packet = new DatagramPacket(receiveData, receiveData.length);

                    try {
                        socket.receive(packet);
                        final byte[] plaintextBinary = aesCipher.doFinal(packet.getData(), 0, packet.getLength());
                        String plaintext = new String(plaintextBinary, Charset.forName("UTF-8"));
                        System.out.println(plaintext);
                    } catch (Exception e) {
                        throw new IllegalStateException("Could not receive or decrypt packet");
                    }
                }
            }

        });
        t.start();

        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            // yeah, whatever
        }

        DatagramSocket sendingSocket = new DatagramSocket();
        String plaintext = "1234";
        byte[] plaintextBinary = plaintext.getBytes(Charset.forName("UTF-8"));

        try {
            Cipher aesCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
            SecretKey key = new SecretKeySpec(new byte[] { 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7,}, "AES");
            IvParameterSpec zeroIV = new IvParameterSpec(new byte[aesCipher.getBlockSize()]);
            aesCipher.init(Cipher.ENCRYPT_MODE, key, zeroIV);
            final byte[] ciphertextBinary = aesCipher.doFinal(plaintextBinary);

        DatagramPacket sendingPacket = new DatagramPacket(ciphertextBinary, ciphertextBinary.length);
        sendingPacket.setSocketAddress(new InetSocketAddress("localhost", 18000));
            sendingSocket.send(sendingPacket);
        } catch (Exception e) {
            throw new IllegalStateException("Could not send or encrypt", e);
        }
    }

} 
```

# binding - 如何简化将同一转换器分配给多个绑定（Windows 商店应用程序）？

> ID：14636683
> 
> 赞同：0
> 
> 时间：2013-01-31T22:57:36.297
> 
> 标签：binding, winrt-xaml, windows-store-apps

```
<TextBlock Visibility="{Binding IsTrue1, Converter={StaticResource BooleanToVisibilityConverter}}"/>
<TextBlock Visibility="{Binding IsTrue2, Converter={StaticResource BooleanToVisibilityConverter}}"/>
<TextBlock Visibility="{Binding IsTrue3, Converter={StaticResource BooleanToVisibilityConverter}}"/> 
```

“转换器”属性在 Binding 上，而不是在 TextBlock 上，所以我不能在 TextBlock 上使用样式。

每个绑定都是不同的，因此我无法创建单个 Binding 资源。

那么，如何避免设置相同的转换器 3 次呢？

编辑：我会尝试解释更多。我正在寻找一种为绑定对象提供默认转换器的方法，这样当我使用同一个转换器创建许多绑定时，我就不必一遍又一遍地设置同一个转换器。

所以，如果我可以这样写：

```
<Grid DefaultBindingConverter="{StaticResource BooleanToVisibilityConverter}">
    <TextBlock Visibility="{Binding IsTrue1}"/>
    <TextBlock Visibility="{Binding IsTrue2}"/>
    <TextBlock Visibility="{Binding IsTrue3}"/>
    ... 
```

显然这是不正确的，只是为了说明我的想法。

希望这次我解释得足够清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T15:06:00.177

让我们谈谈你问题中的两个问题。

**1\. 单一资源**

看来您对`StaticResource`Converter 中的定义有误解。例如`BooleanToVisibility`，您编写的代码不是三次复制的对象。它只声明了一次，使用了三次。

再举一个例子，如果你的代码如下

```
int i;
i=1;
i=2;
i=3; 
```

你声明`i`了一次，使用了三遍。同样，`StaticResource`您使用的也是类似的作品。您可以声明或标记`x:Key="BooleanToVisibility"`，就是这样。`<UserControl.Resources>``<Application.Resources>`

**2.样式使用**

如果你想在 TextBlock 中设置 Style，你可以使用下面的方法。

```
<TextBlock Visibility="{Binding Number1, Converter={StaticResource BooleanToVisibilityConverter}}">
    <TextBlock.Style>
        <Style>
            <!-- Define your Styles here -->                
        </Style>
    </TextBlock.Style>
<TextBlock> 
```

正如您在上面看到的，您可以将`Style`XAML 属性扩展为内部标记。

**==编辑==**

我现在明白你的意图了。您可能希望像 DataContext 一样以分层继承方式应用 Converter。

可悲的是，据我所知，这在 XAML 下是不可能的。因为每个 Binding 只是一个属性，因此必须一个一个地应用它。

可能的解决方法是使用代码隐藏来枚举元素并应用它们。

```
for(int i=0;i<3;i++){
    var textbox = (TextBox)this.FindName("TextBox" + i);
    var binding = new Binding("IsTrue" + i);
    binding.Converter = new YourDefaultConverter();
    textbox.SetBinding(TextBox.TextProperty, binding);
} 
```

希望这有助于减少你的家务。

# python - 在 Scrapy 所需的 Python 2.7 上安装 Zope Interface 4.0.3 时出错

> ID：14636689
> 
> 赞同：4
> 
> 时间：2013-01-31T22:57:59.260
> 
> 标签：python, scrapy, zope

Python 和 Scrapy 的新手。我显然需要这些模块才能正常运行scrapy。我按照建议下载了 Zope 界面，并尝试按照 Scrapy 上的说明使用 easy_install 进行安装。我正在运行 Windows 7 64 并首先下载了 Pyton 2.7 的 64 位版本以及包括 Zope 在内的所有模块。那没有用，所以我卸载了所有内容并下载了 32 位版本，但我遇到了同样的问题。显然，我做错了一些非常基本的事情。将不胜感激帮助。

这就是发生的事情：
C:>easy_install zope.interface-4.0.3-py2.7-win32.egg

我得到了一大堆结果（即使我正确地将其格式化为代码，stackoverflow 也不允许我复制/粘贴），最后说：

```
No local packages or download links found for zope.interface-4.0.3-py2.7-win32.egg 
```

我知道我需要 zope，因为当我尝试运行 srapy 时，我收到以下错误（还有其他结果）：

C:>scrapy shell [http://www.yahoo.com](http://www.yahoo.com)

`raise ImportError(required + ": no module named zope.interface.") ImportError: Twisted requires zope.interface 3.6.0 or later: no module named zope.interface.`

正如我所说，我在这方面是真正的新手，并且在使用所有需要的模块和包时遇到了困难。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T23:26:46.563

easy_install 和 pip install 采用包名，而不是文件名。

所以正确的调用是

```
easy_install zope.interface 
```

这将获取最新版本。如果你特别想要那个版本

```
easy_install "zope.interface==4.0.3" 
```

您通常可以通过谷歌搜索找到包名称，例如。pypi zope 界面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T11:24:34.327

I've spent an absurdly long time trying overcome the zope problems when installing scrapy and just found a solution!

I just followed step 7 here (as Talvalin suggested) [http://steamforge.net/wiki/index.php/How_to_Install_Scrapy_in_64-bit_Windows_7](http://steamforge.net/wiki/index.php/How_to_Install_Scrapy_in_64-bit_Windows_7)

Then, in my site-packages location I just changed the name of the egg file "zope.interface-3.8.0-py2.7-win-amd64.egg" to "zope". All worked fine after that.

Hope this helps somebody!

# mysql - ORDER BY 是否应该更改结果集？

> ID：14636693
> 
> 赞同：2
> 
> 时间：2013-01-31T22:58:09.450
> 
> 标签：mysql, sql-order-by

我的印象是，在 SQL 查询中使用 ORDER BY 不会影响为结果集选择了哪些记录。我认为 ORDER BY 只会影响结果集的呈现。

然而，最近，在我使用 ORDER BY 子句之前，我从查询中得到了意想不到的结果。这表明 a) ORDER BY 可以影响结果集中包含哪些记录，或者 b) 我还有一些其他需要处理的错误。

它是哪一个？

这是查询：`SELECT node_id FROM users ORDER BY node_id LIMIT 100`

（node_id 既是主键也是外键）。

如您所见，该查询包含一个 LIMIT 子句。似乎如果我使用 ORDER BY，则在选择前 100 名之前对记录进行排序。我原以为它会根据自然顺序选择 100 条记录，然后根据 node_id 对其进行排序。

我已经查找了有关 ORDER BY 的信息，但到目前为止，我能找到的唯一信息表明它只影响演示文稿......我正在使用 MySQL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:04:05.127

ORDER BY 反映了 LIMIT 条款之前所有记录的顺序。为了得到你想要的结果，你需要这个：

```
select u.node_id
from users u
join
(
    SELECT node_id
    FROM users 
    LIMIT 100
) us ON u.node_id = us.node_id
ORDER BY u.node_id 
```

这样，您将首先使用 limit 子句并获取前 100 条记录，然后对结果进行排序。join 子句比双 Select 语句快，尤其是在处理许多记录时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:01:40.243

您可以使用嵌套查询：

```
SELECT node_id  FROM 
(
SELECT node_id FROM users LIMIT 100
) u 
ORDER BY node_id 
```

# visual-studio - 调试时 Visual Studio 关闭（安装更新 2 后）

> ID：14636696
> 
> 赞同：3
> 
> 时间：2013-01-31T22:58:19.450
> 
> 标签：visual-studio, visual-studio-2012

我刚刚在两台计算机上安装了 Visual Studio 更新 2，现在当我尝试调试我的程序时，Visual Studio 关闭了！！

它没有显示任何异常，只是关闭。我该怎么办？我试图重新安装视觉工作室并再次安装，但我遇到了同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T21:42:51.730

根据 Marc Paine（Visual Studio 调试器 QA 负责人）的说法：

> 您使用的是 Visual Web Devleoper 版本的 VS，对吗？如果是这样，我们在此 CTP 中有一个仅影响 VWD 的已知错误。您可以将 symsvr.dll 从任何其他安装的 VS（其他快速版本或专业版）复制到 VWD 的 common7\ide 目录中。那应该可以解决问题。我们已经解决了这个问题，它应该可以在下一个 CTP 中使用。

不幸的是，它对我不起作用......所以我在支持论坛中告诉它，但微软只是将我的反馈标记为已关闭并且不再回答我......

所以不幸的是我的解决方案是格式化我的电脑。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-07T10:56:48.753

它现在是一个 CTP，它实际上并不应该是*稳定*的；相反 - 它具有实验功能。所以它崩溃不应该让你感到惊讶。收集尽可能多的数据并将其发送给 Microsoft；希望他们能修复它。

# windows - 升级后无法启动 jenkins windows slave

> ID：14636700
> 
> 赞同：1
> 
> 时间：2013-01-31T22:58:33.237
> 
> 标签：windows, jenkins

我刚刚将詹金斯更新到 1.5。我的 Windows 从属设备在升级过程中断开连接，现在我无法再次连接它们。我用以下命令启动 Windows 从站：

```
javaws.exe slave-agent.jnlp 
```

我收到此错误：

![在此处输入图像描述](../Images/db81779858f8bc65f715aeea02402f44.png)

我可以很好地远程访问 Windows 从站，以便它们运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T02:56:16.370

由于此[安全公告](https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2013-01-04)，这是一个新的已知问题。可以在[此处](http://jenkins.361315.n4.nabble.com/JNLP-slave-no-longer-works-td4650702.html)找到其他信息，包括几个修复/解决方法。

就个人而言，由于我们的 Jenkins 位于一个安全的私有网络上，因此转到 Manage Jenkins -> Configure Global Security，并在基于项目的矩阵授权策略下，在“slave”部分启用“connect”，对于用户“Anonymous”就足够了让我们工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-31T15:07:38.780

为了始终确保正确更新，必须执行以下步骤：

# 如何在 Windows 中更新 Jenkins Slave

1.  转到 services.msc 输入“je”以找到 jenkins 从服务并停止运行
2.  做： sc delete jenkinsslave-c__h （或服务的名称）
    1.  要知道服务的名称，请转到 services.msc 并打开“Jenkins Slave”属性（它是自动/突出显示的）
    2.  如果它只是“标记为删除”关闭“服务”窗口（这将有效地删除服务）
3.  转到 c:h\ 目录（或运行 jenkins 的目录）并删除所有文件，让工作区目录保持不变
    1.  for %i in (*) if not %i == workspace del "%i"
4.  打开“Java 控制面板”（在开始按钮上搜索“配置 Java”）并将安全设置为中
5.  配置 Jenkins 工作空间将在[http://server:8080/jenkins/computer/node_to_use/configure运行的路径](http://server:8080/jenkins/computer/node_to_use/configure)
6.  转到[http://server:8080/jenkins/computer/node_to_use](http://server:8080/jenkins/computer/node_to_use)并运行“启动”
7.  做：文件>安装为服务；行。
8.  转到 services.msc 并按 F5 刷新以显示“Jenkins Slave”
9.  停止服务
10.  打开属性，然后在“此帐户：”的“登录”选项卡中插入“.\user”作为机器的管理员用户（或通过 GUI 登录测试使用的用户）。插入密码。
11.  在以下条件下设置为开机自动启动：
    1.  延迟模式；
    2.  2 次失败重试（1 分钟间隔）
12.  确保用户具有所需的文件和访问权限
13.  转到计算机管理（右键单击@我的电脑>管理）
    1.  系统工具>事件查看器>（Windows日志>）应用程序>右键单击并选择属性>“根据需要覆盖事件”
14.  运行詹金斯奴隶

# git - 如何使用 Git 拉取远程分支

> ID：14636702
> 
> 赞同：1
> 
> 时间：2013-01-31T22:58:40.263
> 
> 标签：git

我试图拉的 git 服务器有一个新的分支。（称之为分支 9）

在我的本地，我没有那个，我要把它拉到我的本地计算机上吗？

我应该运行这个吗？

```
$git checkout -b branch-9
$git pull branch-9 
```

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:01:33.007

做一个`git fetch`遗嘱，如果你已经将 git 服务器配置为远程，创建一个本地跟踪分支。

```
git fetch
git checkout branch-9 # This will automatically set up to track "origin/branch-9" 
```

上述命令的长格式为：

```
git fetch
git checkout -b branch-9 origin/branch-9 
```

*在*您开始对 的副本进行本地更改后`branch-9`，您可能想要使用`git pull`. 与and 或or`git pull`相同（取决于您的设置，默认为）。`git fetch``git merge``git rebase``git merge`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:01:22.000

首先获取远程分支的本地副本：

```
git fetch 
```

这将创建`origin/branch-9`. 现在签出`branch-9`：

```
git checkout branch-9 
```

这将创建一个新的本地分支来跟踪远程分支。

# jquery - 将 JQuery 变量传递给 asp.net 中的代码

> ID：14636703
> 
> 赞同：0
> 
> 时间：2013-01-31T22:58:40.243
> 
> 标签：jquery, asp.net, webforms

我一直在尝试将变量从 JQuery 函数传递到后面的代码，以便我可以通过 SQL 语句将其输入数据库。但是，我似乎从来没有让变量通过。或者如果它正在通过，我似乎无法让它显示以确保它已经通过。谁能看到我的脚本有什么问题？

```
<script type="text/javascript">
  $(function () {
      var comment = $("#comment"),
      allFields = $([]).add(comment);
      $('#<%= hidden.ClientID %>').val(comment);

      $("#dialog-form").dialog({
          autoOpen: false,
          height: 300,
          width: 350,
          modal: true,
          buttons: {
              "Add Comment": function () {
                  var bValid = true;
                  allFields.removeClass("ui-state-error");
                  if (bValid) {
                      $("#comments tbody").append("<tr>" +
                        "<td>" + comment.val() + "</td>" +
                        "<td>" + "<%=currentUser%>" + "</td>" +
                        "</tr>");

                      $(this).dialog("close");
                      //                          
                  }
              },
              Cancel: function () {
                  $(this).dialog("close");
              }
          },
          close: function () {
              allFields.val("").removeClass("ui-state-error");
          }
      });

      $("#NewComment")
    .button()
    .click(function () {
        $("#dialog-form").dialog("open");

    });
  });  
    </script> 
```

这是我隐藏的输入字段：

```
<input id="hidden" type="hidden" runat="server" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:24:09.090

我建议使用这样的实际 Asp.Net`HiddenField`控件：

**标记**：

```
<div>
    <asp:HiddenField ID="hidden" runat="server" />
    <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Button" />
</div> 
```

**代码背后**：

```
protected void Button1_Click(object sender, EventArgs e)
{
    string hidden = this.hidden.Value;
    Response.Write(hidden);
} 
```

**Javascript**：

```
<script>
    $(document).ready(function () {
        $("#<%=hidden.ClientID %>").val("Hello, World!");
    });
</script> 
```

**输出**：你好，世界！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:08:26.270

What are you trying to do with this line: `$('#<%= hidden.ClientID %>').val(comment);` ? aren't you missing something like comment**.val()**

Still if I were you I would use a simple handler and make a ajax request.

# ios - 快速点击时触发两次IBAction

> ID：14636704
> 
> 赞同：3
> 
> 时间：2013-01-31T22:58:42.787
> 
> 标签：ios, ios6

我有一个奇怪的问题。我有一个用于设置用户设置的视图。我将它放在常规菜单中以供常用访问，当我在此场景中点击 UIButtons 时，它们只执行一次 IBAction 回调。即使您向按钮发送垃圾邮件。这是一件好事。

现在，为了让用户的操作更快，我还允许在其他地方访问同一个 ViewController。这次我没有使用推送动画，而是自己实例化 ViewController 并将其显示在其他所有内容之上。出于某种原因，在这种情况下，如果我快速点击按钮，则会多次调用 IBAction。

这对我来说是个问题，因为我在 IBAction 中有一个 performSegue，它会推动下一个视图两次。因此，当用户返回时，它会返回到同一个视图，如果您再返回一次，它会使应用程序崩溃。

我不知道如何解决这个问题，因为同一个 UIViewController 在两个不同的上下文中表现不同......

我正在使用 xcode 4.5

# function - 索引超过空函数的矩阵维度

> ID：14636711
> 
> 赞同：0
> 
> 时间：2013-01-31T22:59:40.337
> 
> 标签：function, matlab

我在 matlab 中创建的函数遇到了这个问题。我有变量 h = 0.2 和 x = (0:h:1)'。'x' 是一个包含 5 个元素的行向量。我在matlab中使用以下函数

```
function d = dplus(fstring, x, h)
d=0;
end 
```

每当我将以下内容插入matlab时

```
dplus('prob4Func',x,h) 
```

我收到此错误“??? 索引超出矩阵尺寸。” 这完全没有意义，因为我什至没有在函数的任何地方使用向量“x”。我缺少matlab是否有一些微妙之处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T16:30:53.873

我只需要使用“clearvars dplus”来让它工作。谢谢纳万！

# css - CSS底部对齐

> ID：14636715
> 
> 赞同：-1
> 
> 时间：2013-01-31T22:59:50.490
> 
> 标签：css

[我在http://rygol.cz/qlife/](http://rygol.cz/qlife/)上有网页，当我缩小时，每次迭代时 id="contacts" 都会出现在任何地方。我需要类似的东西

```
border: 0; 
```

因为我需要那篇文章的任何想法怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:15:43.007

首先，尝试使用以下链接验证您的 HTML：[HTML 验证](http://validator.w3.org/) 尝试修复这些错误，然后再尝试修复您的`id="contact"`

至于`id="contact"`用途`position:absolute`或`position:relative;`可能解决您的问题。如果这不起作用，使用它`display:block;`或`display:inline-block;`两者都可以帮助您实现目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:16:01.140

要在内容底部对齐 div，请将 {position: relative;} 添加到内容 div 和 {position: absolute; bottom: 26px;} 到要对齐的 div。

CSS：

```
#content-wrapper {
position: relative;
}

#leftcolumn {
padding-bottom: 110px; /* this will prevent the normal content in the left column to go under the aligned div */
}

#contacts {
margin-top: 0;
position: absolute;
bottom: 26px;
} 
```

Demo: [http://jsfiddle.net/NMDCF/](http://jsfiddle.net/NMDCF/)

# php - 获取 REQUEST_URI 并且不要覆盖

> ID：14636716
> 
> 赞同：3
> 
> 时间：2013-01-31T22:59:54.987
> 
> 标签：php, session-variables, session-cookies

我尝试使用下面的代码将 REQUEST_URI 存储在会话中。当访问者登陆我们网站的页面时，我需要存储第一个 REQUEST_URI，并且在他们开始浏览页面时不被覆盖。这不起作用，因为我浏览了我看到由 echo 显示的新 URI 的站点。

```
session_start();
if ( !isset( $_SESSION['theuri'] ) ) {
    if ( !empty( $_SERVER['REQUEST_URI'] ) ) {
        $_SESSION['theuri'] = $_SERVER['REQUEST_URI'];
    }
}

echo $_SESSION['theuri']; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:18:25.420

清除您的 cookie，然后重试。它可能是第一次设置的时候你从来没有 !empty() 条件并且从那时起就没有改变

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:20:44.023

你可以试试这个技巧：

```
if(session_id() == '') 
     session_start(); 
```

如果 WP 尝试为您启动会话，应该会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T23:24:52.213

您必须在任何输出之前启动会话，以便正确设置 cookie。Wordpress 是无状态的，根本不使用会话。您提到您将此代码放在页脚中，因此可能已经有输出。

一个 hacky 解决方案是在 index.php 或 wp-config.php 的顶部输入 session_start()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T23:34:02.783

我发现这篇文章说要将此代码添加到我的functions.php，现在我页脚中的代码工作正常。

[http://devondev.com/2012/02/03/using-the-php-session-in-wordpress/](http://devondev.com/2012/02/03/using-the-php-session-in-wordpress/)

```
add_action('init', 'myStartSession', 1);
add_action('wp_logout', 'myEndSession');
add_action('wp_login', 'myEndSession');

function myStartSession() {
    if(!session_id()) {
        session_start();
    }
}

function myEndSession() {
    session_destroy ();
} 
```

# c++ - std::vector 的 VBO 和正确的步伐

> ID：14636720
> 
> 赞同：0
> 
> 时间：2013-01-31T23:00:10.123
> 
> 标签：c++, opengl, stl, vbo

我想知道如何在**没有**数据复制的情况下获得以下问题的最大数据局部性和性能。

我有一个 std::vector< MyClass* >`MyClass`像

```
class MyClass
{
public:
    MyClass(int n,double px,double py,double pz)
    {
        someField=n;
        x=px;
        y=py;
        z=pz;
        anotherField=100;
        anotherUnusefulField=-10.0;
    }

    int someField;
    int anotherField;

    double x;
    double y;
    double z;
    double anotherUnusefulField;
};

std::vector<MyClass*> myClassVector;
// add some values and set x,y,z

for (std::vector<MyClass*>::iterator iter = myClassVector.begin(); iter!=myClassVector.end();++iter)
{
    MyClass *tmp = *iter;
    tmp->x+=1.0;
    tmp->y+=2.0;
    tmp->z+=3.0;
} 
```

我经常对这些数据进行迭代，并且我还想强制执行数据局部性。指向 MyClass 的指针中包含的数据应发送到 OpenGL 顶点数组，其中顶点**仅**由`x,y,z`变量确定。正如您可能想象的那样，很难正确设置步幅，所以我在这里询问是否有其他（便携式）解决方案来解决这个问题。

（ps 我已经阅读了[带有 std::vector 的帖子 VBO，](https://stackoverflow.com/questions/7173494/vbos-with-stdvector)但我的情况基本不同，因为我有指针，并且类中还有其他变量。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:15:18.840

> 我有指针

这些指针对 OpenGL 是无用的，因为它们位于客户端地址空间中。OpenGL 也不会取消引用二级指针。

> 我在课堂上还有其他变量。

好吧，那就不要这样做了。如果你将这些类实例传递给 OpenGL，你会复制很多无用的数据。我建议您只需将索引存储到类成员中紧凑的 std::vector 或数组中，并引用向量/数组本身。您可以使用 getter/setter/referencer 成员函数来抽象出对向量的访问，即

```
class …
{

    // …
    std::vector<v_t> *v;
    size_t index_v;
    x_t getX() const { return (*v)[index_v]; }
    x_t setX(x_t x) { return (*v)[index_v] = x;}
    x_t &x() { return (*v)[index_v]; }

}; 
```

# c# - 在多个 SQL 表中搜索数据

> ID：14636722
> 
> 赞同：1
> 
> 时间：2013-01-31T23:00:17.377
> 
> 标签：c#, asp.net, sql

在我的 SQL 数据库中，我对美国的每个州都有一个表。用户可以创建多个不同状态的页面。每个表都有一个“UserID”列，该列将始终与登录用户匹配。如何在多个表中搜索“UserID”？

```
string sqlquery = "SELECT * FROM[all tables] WHERE @UserID ='" + userID.Text + "'";

SqlConnection conn1 = new SqlConnection(connString);
SqlCommand comm1 = new SqlCommand(sqlquery, conn1);
SqlDataReader DR1 = comm1.ExecuteReader();
if (DR1.Read())
{
Textbox1.Text = DR1.GetValue(0).ToString();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T23:21:27.487

我还没有看到您的数据库架构，但我已经可以告诉您需要重构它。没有必要为每个状态都有一张表，而且维护起来可能很粗糙。您应该拥有一个包含所有状态的表，然后是另一个引用 State 表的表，该表包含您想要的任何信息（您的“页面”）

```
CREATE TABLE States
(
    StateID int not null, --PK
    StateName nvarchar(32) not null
)

CREATE TABLE Pages
(
    PagesID int not null, --PK
    StateID int not null, --FK
    UserID int not null
    //Whatever other columns you need
) 
```

现在，您可以`Pages`根据特定`Page`的`State`或`User`

```
SELECT * FROM Pages WHERE UserID = (userId)
SELECT * FROM Pages WHERE StateID IN (1, 5, 20)
SELECT * FROM Pages WHERE PageID = (pageID) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:26:31.593

正确的答案是您需要更改您的数据库，以便所有这些信息都保存在一个表中。简单的答案是花几分钟时间创建一个将所有表联合在一起的视图，以便您可以访问它们，就好像它们都在一个表中一样。

我的回答与其他人的唯一区别是我不会在你的 c# 代码中联合它们。我只是在将它们结合在一起的数据库上创建一个实际视图。视图会很简单（虽然很长），您的代码也会很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T23:19:19.457

如果表具有相同的列，我会选择类似的东西。使用 sql `UNION`。

```
var statesTables = new[]{"NY, Texas, Oregano, Alabama}";

var qBuild = new StringBuilder();

qBuild.Append(string.Format("SELECT * FROM {0} WHERE UserId = @userId ", statesTables[0]));

for(int i=1;i<stateTables.Length;i++){
     qbuild.Append(string.Format("UNION SELECT * FROM {0} WHERE UserId = @userId ", statesTables[i]))
}

SqlConnection conn1 = new SqlConnection(connString);
SqlCommand comm1 = new SqlCommand(qBuild.ToString(), conn1);
comm1.Parameters.Add(new SqlParameter("userId", userId)); 
```

它将生成 SQL：

```
SELECT * FROM NY WHERE UserId = @userId
UNION 
SELECT * FROM Texas WHERE UserId = @userId
UNION 
SELECT * FROM Oregano WHERE UserId = @userId
UNION 
SELECT * FROM Alabama WHERE UserId = @userId 
```

*如果有一些不同的列，请将 * 替换为表共有的列名。*

**但是，正如其他人所建议的那样，重构您的数据库模式将是最好的！**

# ruby-on-rails - 为什么这个“if 语句”不能部分工作？

> ID：14636727
> 
> 赞同：0
> 
> 时间：2013-01-31T23:00:46.687
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在某些情况下，它没有`tag`像下面这样的参数。
所以我放了 <%= tag + ',' if tag %>，但它得到了这个错误

> ActionView::Template::Error（参数数量错误（0 代表 1））：

我该如何解决？

**index.html.erb**

```
<%= render 'layouts/social_like', :url => root_url, :title => @title %> 
```

**布局/_social_like.html.erb**

```
....
<a href="https://twitter.com/share" class="twitter-share-button" data-lang="en" data-hashtags="<%= tag + ',' if tag %>hash2,hash3,hash4">Tweet</a>
.... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:49:12.160

内联 if 语句在 ERB 中并不能很好地工作（完全？）。您可以使用三元运算来做到这一点：

```
...data-hashtags='<%= tag ? "#{tag}," : "" %>hash2,hash3,hash4'> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:52:58.990

`tag`是一种使用一个 arg 的 rails 辅助方法；ruby 认为你试图在没有参数的情况下调用它。重命名您的变量，它应该可以工作。

# function - innerHTML 调用以接收 url

> ID：14636728
> 
> 赞同：1
> 
> 时间：2013-01-31T23:00:52.783
> 
> 标签：function, http, url, innerhtml, brightcove

我正在尝试拨打电话，以便在我的播放列表中单击视频的标题时，它将回调特定的视频 url，以显示在我创建的元数据字段框中。

到目前为止，我得到了结果，但我使用的下面的函数给了我 rmtp url，如下所示：

`(rtmp://brightcove.fcod.llnwd.net/a500/d16/&mp4:media/1978114949001/1978114949001_2073371902001_How-to-Fish-the-Ice-Worm.mp4&1358870400000&7b1c5b2e65a7c051419c7f50bd712b1b )`

Brightcove 曾说过使用 ( `FLVURL&media_delivery=http`)。

我已经尝试了所有我知道的方法来在我的函数中放置媒体传递，但总是想出除了 rmtp 或空白之外什么都没有。

你能帮忙解决我展示的少量代码吗？如果我需要展示更多，那不是问题。谢谢

```
function showMetaData(idx) {
    $("tr.select").removeClass("select");
    $("#tbData>tr:eq("+idx+")").addClass("select");

    var v = oCurrentVideoList[idx];

    //URL Metadata
    document.getElementById('divMeta.FLVURL').innerHTML = v.FLVURL; 
```

这是我的人口呼吁我的名单。

```
//For PlayList by ID

function buildMAinVideoList() {

//Wipe out the old results
$("#tbData").empty();

console.log(oCurrentMainVideoList);
oCurrentVideoList = oCurrentMainVideoList;
// Display video count
document.getElementById('divVideoCount').innerHTML = oCurrentMainVideoList.length + " videos";
document.getElementById('nameCol').innerHTML = "Video Name";
//document.getElementById('headTitle').innerHTML = title;
document.getElementById('search').value = "Search Videos";
document.getElementById('tdMeta').style.display  = "block";
document.getElementById('searchDiv').style.display  = "inline";
document.getElementById('checkToggle').style.display  = "inline";
$("span[name=buttonRow]").show();
$(":button[name=delFromPlstButton]").hide();

//For each retrieved video, add a row to the table
var modDate = new Date();
$.each(oCurrentMainVideoList, function(i,n){
    modDate.setTime(n.lastModifiedDate);
    $("#tbData").append(
        "<tr style=\"cursor:pointer;\" id=\""+(i)+"\"> \
        <td>\
            <input type=\"checkbox\" value=\""+(i)+"\" id=\""+(i)+"\" onclick=\"checkCheck()\">\
        </td><td>"
            +n.name +
        "</td><td>"
            +(modDate.getMonth()+1)+"/"+modDate.getDate()+"/"+modDate.getFullYear()+"\
        </td><td>"
            +n.id+
        "</td><td>"
            +((n.referenceId)?n.referenceId:'')+
        "</td></tr>"
    ).children("tr").bind('click', function(){
        showMetaData(this.id);
    })
});

//Zebra stripe the table
$("#tbData>tr:even").addClass("oddLine");

//And add a hover effect
$("#tbData>tr").hover(function(){
    $(this).addClass("hover");
}, function(){
    $(this).removeClass("hover");
});

//if there are videos, show the metadata window, else hide it
if(oCurrentMainVideoList.length > 1){showMetaData(0);}
else{closeBox("tdMeta");}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T15:18:43.510

如果查找 HTTP 路径，当对 Brightcove 的 API 调用正确时，您将看不到 rtmp:// url。

由于您正在获取 rtmp URL，这可以验证您正在使用具有 URL 访问权限的 API 令牌，这很好。像这样的请求应该返回播放列表和 http URL（插入您的令牌和播放列表 ID）。

[http://api.brightcove.com/services/library?command=find_playlist_by_id&token=](http://api.brightcove.com/services/library?command=find_playlist_by_id&token=) {yourToken}&playlist_id={yourPlaylist}&video_fields=FLVURL&media_delivery=http

此 API 测试工具可以帮助您构建查询，并显示预期结果： http: [//opensource.brightcove.com/tool/api-test-tool](http://opensource.brightcove.com/tool/api-test-tool)

我没有看到您的代码有什么问题，但如果您还没有尝试过，在浏览器中进行调试可以帮助您确认返回的 API 结果，而无需通过代码访问它。这可以帮助您根除用于访问值的代码的任何问题，以及值本身的问题。如果您以前没有使用过它，这是关于在 Chrome 中进行步进调试的概述： [https ://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints](https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints)

# java - 如何验证 POJO 与所需属性列表中的 NOT NULLABLE 属性？

> ID：14636730
> 
> 赞同：0
> 
> 时间：2013-01-31T23:01:02.997
> 
> 标签：java, hibernate, pojo, data-consistency

我的问题是我需要根据数据验证在我的数据库中保留两种状态“VALID”和“INVALID”，这意味着，在我的数据库中，所有属性都是 NULLABLE 但如果所有必需的值，另一个进程将放置状态“VALID”当缺少一个或多个必需值时，它们存在并且“无效”。

我正在使用关系模型（oracle 11g）和 Hibernate 3。

所以...

有人知道一个框架或机制来验证给定对象（PO​​JO）与所需对象/属性的列表（或另一个 POJO）之间的数据一致性（对象/属性不为空）？请注意，这些对象可以具有简单的属性，也可以包括其他对象或对象列表。

更重要的是，在某些情况下，验证有一个条件，例如，仅当另一个属性具有特定值时才验证（检查是否为 NULL）一个特定属性。

目前我有一种方法使用反射和一个数据库表来存储我所有需要的对象/属性的参数化，但我想知道是否存在另一种更好的方法。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T00:32:12.620

好吧，我找到了一个很好的方法来做到这一点：

PropertyUtils.getNestedProperty

并为可空性编程所有条件。

# ios - 在 MonoTouch 中从 NSDate（或 DateTime）获取 NSDateComponents 实例

> ID：14636732
> 
> 赞同：2
> 
> 时间：2013-01-31T23:01:12.227
> 
> 标签：ios, xamarin.ios

我需要获取一个完全定义的[NSDateComponents](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSDateComponents_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSDateComponents)实例（即设置了日历、时区和实际日期值等），以用作[EKReminder的](http://developer.apple.com/library/ios/#documentation/EventKit/Reference/EKReminderClassRef/Reference/Reference.html)[StartDateComponents](http://developer.apple.com/library/ios/documentation/EventKit/Reference/EKReminderClassRef/Reference/Reference.html#//apple_ref/occ/instp/EKReminder/startDateComponents)和[DueDateComponents](http://developer.apple.com/library/ios/documentation/EventKit/Reference/EKReminderClassRef/Reference/Reference.html#//apple_ref/occ/instp/EKReminder/dueDateComponents)值。

这里有很多[关于 SO 的答案，](https://stackoverflow.com/a/13210367/505457)解释了如何从 obj-c 中的日历实例中做到这一点。和开源项目[做同样的事情](https://github.com/kevinbirch/sched/blob/master/src/EventKitController.m#L96-L100)。

但是我似乎无法弄清楚如何在 MT 中做同样的事情。NSCalendar类不公开任何与选择器相关的[方法](http://docs.go-mono.com/monodoc.ashx?link=T:MonoTouch.Foundation.NSCalendar/*)`components:fromDate:`。

人们是如何处理 MT 中的 DateTime/NSDate -> NSDateComponents 的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:58:06.230

这些 API 在 MonoTouch 中实际上是缺失的——但我现在已经添加了它们，因此您将在未来的版本中找到它们。

同时您可以`components:fromDate:`手动调用：

```
var calendar = new NSCalendar (NSCalendarType.Gregorian);
var date = (NSDate) DateTime.Now;
var ptr = Messaging.IntPtr_objc_msgSend_UInt32_IntPtr (calendar.Handle, Selector.GetHandle ("components:fromDate:"), (uint) (NSCalendarUnit.Year | NSCalendarUnit.Month), date.Handle);
var comps = new NSDateComponents (ptr);

Console.WriteLine (comps.Year); 
```

# python - web2py 在重复键更新时插入

> ID：14636733
> 
> 赞同：0
> 
> 时间：2013-01-31T23:01:21.523
> 
> 标签：python, web2py

如何在 web2py 中使用 DAL 来执行 INSERT ... ON DUPLICATE KEY UPDATE。我没有在[手册](http://web2py.com/books/default/chapter/29/06#insert)中找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T06:12:44.470

试试[`db(...).update_or_insert(...)`](http://web2py.com/books/default/chapter/29/06#update_or_insert)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T04:55:56.407

这就是我现在正在做的工作。

首先我更新：

```
count = db(...).update(...) 
```

它返回修改的行数。

然后，如果`count==0`我这样做`insert`。

# javascript - 事件监听器和 js-test-driver？

> ID：14636735
> 
> 赞同：0
> 
> 时间：2013-01-31T23:01:31.377
> 
> 标签：javascript, jquery, js-test-driver

我的 JS 在 DOM 准备好后被加载。一旦 DOM 准备就绪，JS 会检查环境的某些方面（窗口尺寸等），将事件侦听器绑定到特定元素，然后最终运行。

如何在 js-test-driver 中进行设置？我可以使用**/*:DOC += ... */**来模拟我的 HTML，但我不知道如何首先执行此操作，然后加载我的脚本，并让它将事件侦听器绑定到其中的元素。

老实说，我宁愿 jstestdriver 加载我的 html 页面以及所有列出的脚本，并将其用作起点。也许有更好的工具？我可以使用的插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T09:11:07.440

您可以使用 jQuery 的[load()](http://api.jquery.com/load/)函数来加载您要测试的 HTML 页面。在您的 JSTestDriver 测试函数中：

```
$('html').load('pageToLoad.html', function() {
    // load was performed - run your asserts here now
}); 
```

但是，由于这使用回调函数，您可能必须使用[Async Test Case](http://code.google.com/p/js-test-driver/wiki/AsyncTestCase)。

# javascript - 全局数组值丢失函数范围之外的数据

> ID：14636738
> 
> 赞同：1
> 
> 时间：2013-01-31T23:01:39.937
> 
> 标签：javascript

为什么会这样，它只在函数范围内有效，而我已经在全局范围内声明了它

```
testing = [];

function func1(){
  //some codes here that fills the "testing" array... 
}
//I want to display here the new array values.. 
```

在[JSFiddle上观看](http://jsfiddle.net/24Ffs/6/)

1.  点击按钮
2.  检查元素的输出，
3.  在控制台上

    > 我需要另一个函数上的“测试”数组。那我将如何使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:03:41.773

调用此方法**后，**您的数组将被填充`console.log("outside function scope :\n"+testing);`。

忽略 jsfiddle 中的所有问题，您没有看到您期望的行为的原因是因为导致数组被填充的事件是异步的，其中在范围之外显示它的代码会立即执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:04:09.307

请注意消息在控制台中出现的顺序。页面加载时：

```
outside function scope : 
```

点击按钮后：

```
inside function scope :
RSdKmX2BH7o,EWMLMc3ES3I,SIXwlxhjaKY,RIKTFn5ALE8,acp8TbBPVos,6GpKR4-TLoI,XLKLkTnKRwg,6WPELkw5kD0 
```

加载页面后，任何函数范围之外的代码都会立即运行，但填充的代码`testing`仅在单击按钮后才会运行。

# python - Python 中无法识别目录

> ID：14636739
> 
> 赞同：0
> 
> 时间：2013-01-31T23:01:44.280
> 
> 标签：python, django, zip

我正在上传一个包含文本文件文件夹的压缩文件夹，但它没有检测到压缩的文件夹是一个目录。我认为这可能与在`os.path.isdir`调用中需要绝对路径有关，但似乎无法弄清楚如何实现它。

```
 zipped = zipfile.ZipFile(request.FILES['content'])
            for libitem in zipped.namelist():
                if libitem.startswith('__MACOSX/'):
                    continue
                # If it's a directory, open it
                if os.path.isdir(libitem):
                    print "You have hit a directory in the zip folder -- we must open it before continuing"
                    for item in os.listdir(libitem): 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:24:11.557

通常在运行您想要使用的脚本时使事情处理相对路径等`os.path`。

在我看来，您正在从 Zipfile 中读取您实际上并未解压缩的项目，那么您为什么希望文件/目录存在？

通常我会`print os.getcwd()`找出我在哪里，也`os.path.join`用来加入数据目录的根目录，是否与包含我无法分辨的脚本的目录相同。使用类似`scriptdir = os.path.dirname(os.path.abspath(__file__))`.

我希望你必须做类似的事情

```
libitempath = os.path.join(scriptdir, libitem)
if os.path.isdir(libitempath):
    .... 
```

但我猜你在做什么，因为这对我来说有点不清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T00:59:13.620

您上传的文件是一个 zip 文件，它只是其他文件和目录的容器。所有 Python`os.path`函数都对本地文件系统上的文件进行操作，这意味着您必须先提取 zip 的内容，然后才能使用`os.path`或`os.listdir`.

不幸的是，无法从`ZipFile`对象中确定条目是针对文件还是目录。

首先进行提取的重写或您的代码可能如下所示：

```
import tempfile

# Create a temporary directory into which we can extract zip contents.
tmpdir = tempfile.mkdtemp()
try:
    zipped = zipfile.ZipFile(request.FILES['content'])
    zipped.extractall(tmpdir)

    # Walk through the extracted directory structure doing what you
    # want with each file.
    for (dirpath, dirnames, filenames) in os.walk(tmpdir):
        # Look into subdirectories?
        for dirname in dirnames:
            full_dir_path = os.path.join(dirpath, dirname)
            # Do stuff in this directory
        for filename in filenames:
            full_file_path = os.path.join(dirpath, filename)
            # Do stuff with this file.
finally:
    # ... Clean up temporary diretory recursively here. 
```

# qt - 在 QTextEdit 中绘画而不影响文本

> ID：14636741
> 
> 赞同：2
> 
> 时间：2013-01-31T23:01:45.117
> 
> 标签：qt, pyqt, qpainter, qtextedit, qtextdocument

我正在尝试在 a 中绘制一些线条，`QTextEdit`但是当`paintEvent`它被称为清除整个`QTextEdit`文本时，线条被绘制，无法进一步输入文本。如果我滚动，绘制的线条会非常奇怪，以某种方式在水平或垂直方向上相乘。我想在不`QTextEdit`影响其文本的情况下进行绘制，并且绘制的内容在滚动时正常运行，以保持其坐标。

这是代码：

```
class TextEdit(QTextEdit):
    def __init__(self, parent = None):
        super(TextEdit, self).__init__(parent)
        self.setViewportMargins(10, 0, 0, 0)

    def paintEvent(self, event):
        painter = QPainter(self.viewport())
        painter.drawLine(10, 10, 200, 10) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T01:39:25.263

将此添加到`paintEvent`方法的底部：

```
super(TextEdit, self).paintEvent(event) 
```

# macos - 如何将剪贴板上的文本行作为 bash 命令执行

> ID：14636743
> 
> 赞同：2
> 
> 时间：2013-01-31T23:01:48.120
> 
> 标签：macos, bash, unix, clipboard

我正在使用 Mac OS X 的`pbpaste`命令，它返回剪贴板的内容。我想创建一个 shell 脚本，将返回的每一行`pbpaste`作为单独的 bash 命令执行。例如，假设剪贴板的内容由以下几行文本组成：

```
echo 1234 >~/a.txt
echo 5678 >~/b.txt 
```

我想要一个执行每一行的 shell 脚本，在我的主文件夹中创建两个文件 a.txt 和 b.txt。经过大量的搜索和反复试验，我已经到了能够`while`使用以下构造将单独的文本行分配给循环中的变量的地步：

```
pbpaste | egrep -o [^$]+ | while read l; do echo $l; done 
```

正如预期的那样，它将以下内容发送到标准输出：

```
echo 1234 >~/a.txt
echo 5678 >~/b.txt 
```

然后我尝试使用以下构造执行它们，而不是简单地回显每一行文本：

```
pbpaste | egrep -o [^$]+ | while read l; do $l; done 
```

我认为这将执行每一行（从而在我的主文件夹中创建两个文本文件 a.txt 和 b.txt）。`echo`相反，第一项`nnnn >~/...`（

```
1234 >~/a.txt
5678 >~/b.txt 
```

在理解为什么我的构造不起作用以及哪些更改可能使其起作用方面，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:09:25.147

> […] the remaining terms (`nnnn >~/...`) seem to get lumped together as if they were a single parameter, […]

Not exactly. The line actually gets split on whitespace (or whatever `$IFS` specifies), but the problem is that the redirection operator `>` cannot be taken from a shell variable. For example, this snippet:

```
gt='>'
echo $gt foo.txt 
```

will print `> foo.txt`, rather than printing a newline to `foo.txt`.

And you'll have similar problems with various other shell metacharacters, such as quotation marks.

What you need is the `eval` builtin, which takes a string, parses it as a shell command, and runs it:

```
pbpaste | egrep -o [^$]+ | while IFS= read -r LINE; do eval "$LINE"; done 
```

(The `IFS=` and `-r` and the double-quotes around `$LINE` are all to prevent any other processing besides the processing performed by `eval`, so that e.g. whitespace inside quotation marks will be preserved.)

Another possibility, depending on the details of what you need, is simply to pipe the commands into a new instance of Bash:

```
pbpaste | egrep -o [^$]+ | bash 
```

* * *

**Edited to add:** For that matter, it occurs to me that you can pass everything to `eval` in a single batch; just as you can (per your comment) write `pbpaste | bash`, you can also write `eval "$(pbpaste)"`. That will support multiline `while`-loops and so on, while still running in the current shell (useful if you want it to be able to reference shell parameters, to set environment variables, etc., etc.).

# ruby-on-rails - 我的日志中的所有这些 [1m [35m 是什么，我该如何让它消失？

> ID：14636746
> 
> 赞同：12
> 
> 时间：2013-01-31T23:02:12.420
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

如果这个问题已经得到回答，我提前道歉。我一直在尝试在 Google 和 StackOverflow 上搜索此内容，但由于我的搜索查询中有标点符号，搜索引擎往往会对其进行处理并给我无意义的结果。

在我的 rails 应用程序（rails 3.2.11，ruby 1.9.3）中，我的日志通常如下所示：

```
Started GET "/apply/contact" for 127.0.0.1 at 2013-01-29 17:35:21 -0600
Processing by JobApplicationsController#show as HTML
  Parameters: {"id"=>"contact"}
  [1m[36mJobApplication Load (0.5ms)[0m  [1mSELECT "job_applications".* FROM "job_applications" WHERE "job_applications"."id" = 9 LIMIT 1[0m
  [1m[35mPerson Load (0.4ms)[0m  SELECT "people".* FROM "people" WHERE "people"."id" = 42 LIMIT 1
  Rendered job_applications/contact.html.haml within layouts/bare (9.6ms)
  Rendered shared/_messages.html.haml (0.1ms)
Completed 200 OK in 88ms (Views: 24.8ms | ActiveRecord: 0.9ms | Solr: 0.0ms) 
```

我想知道的是关于`[1m[36m`and`[1m[35m`标记，它们出现在某些行之前，以及`[0m`有时`[1m`出现在行内的 and 。

唯一出现的数字是 0、1、32、35 和 36。这些标记在日志文件中总是以不可打印的转义字符开头。

这些数字代表什么？为什么它们会出现在我的日志中？有没有办法摆脱它们？他们（和他们的转义角色朋友）在尝试阅读日志并诊断问题时非常烦人。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-31T23:06:56.923

这些是[ANSI shell 颜色代码](http://www.bashguru.com/2010/01/shell-colors-colorizing-shell-scripts.html)。[您可以使用config.colorize_logging](http://guides.rubyonrails.org/configuring.html)禁止它们，或者使用[sed 命令](https://gist.github.com/2245881)从现有日志中删除它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-20T16:21:46.940

如果您想使用这些 ANSI shell 颜色代码而不是抑制它们，请在寻呼机（如`less`）而不是编辑器（如`vim`）中查看您的日志。

```
less -r log/production.log 
```

（确保使用`-r`标志来使用控制代码。）

# asp.net-mvc - html.textbox 命名 asp.net mvc

> ID：14636748
> 
> 赞同：1
> 
> 时间：2013-01-31T23:02:18.490
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-2

我正在尝试遍历数据库并为每条记录创建一个文本框。在我尝试使用控制器中的信息之前，一切正常。如何将此信息传递回控制器？

```
<% Using (Html.BeginForm("NewEnvCd", "Config", Nothing, FormMethod.Post))%>

    <%: Html.Hidden("Environment", Model.NewEnvironment)%>
    <div class="box" style="margin-top:30px;width:800px;">
    <h4 >Add New Environment Code</h4>
        <div>
        <div>
        <div style="float:left; text-decoration:underline;">Environment Code</div><div style="float:right;width:400px;text-decoration:underline;">Parameter Values</div>
        </div>
        <br /><br />
        <% Dim i As Int32 = 0 %>
        <% For Each cfg In Model.ParameterValues%>

            <div style="margin-bottom:5px;">

                <div style="float:left;">
                    <%: Html.Hidden("newEnvironment", Model.NewEnvironment)%>
                    <%: Html.Hidden("cfg[" & i & "].Name", cfg.Name) %>
                    <%: Html.Hidden("cfg[" & i & "].EnvCd", cfg.EnvCd) %>
                    <%: cfg.Name%>

                </div>
                <div style="float:right;">
                    <%: Html.TextBox("cfg[" & i & "]value", If(Not cfg.Value Is Nothing, cfg.Value, ""), New With {.style = "width:400px;"})%>
                </div>
                <div class="clear"></div>
            </div>
            <% i += 1 %>

        <% Next %>

        <input type="submit" value="Save" />
        <%: Html.ActionLink("Return to List", "Index", "Config") %>
        </div>
        </div>
<% End Using %> 
```

控制器如下所示：

```
 Function NewEnvCd(ByVal newEnvironment As String, Optional ByVal copyEnvironment As String = "") As ActionResult
        Dim model As NewEnvCdModel
        model = New NewEnvCdModel(newEnvironment, copyEnvironment)
        Return View(model)
    End Function

    <HttpPost()>
    Function NewEnvCd(ByVal newEnvironment As String, ByVal name As String, ByVal value As String, ByVal cfg As IList(Of ConfigData.tblTT_Configuration))

        If (cfg.Count() = 0 OrElse String.IsNullOrWhiteSpace(name)) Then
            Return RedirectToAction("Index")
        End If

        For Each c In cfg
            Repository.CreateEnvironment(If(c.EnvCd, newEnvironment), c.Name, c.Value)
        Next
        Return RedirectToAction("index")
    End Function 
```

我可能不清楚我的问题，但我正在寻找的答案与使用每个 cfg 记录的名称有关（即 cfg.Name、cfg.Value、cfg.EnvCd）。我试图单独传递 cfg 的参数（ByVal 名称作为字符串，ByVal 值作为字符串），当我应该将 cfg 作为列表或可查询（ByVal cfg As IList（Of ConfigData.tblTT_Configuration））传递时，然后从控制器中提取值。谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T07:25:56.240

假设您的`ConfigData.tblTT_Configuration`模型具有名为 的属性`Name`，`EnvCd`并且`Value`您需要做的就是修复您的 TextBox 名称，以便[`naming convention`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)在绑定到列表时遵守：

```
<%: Html.TextBox(
    "cfg[" & i & "].Value", 
    If(Not cfg.Value Is Nothing, cfg.Value, ""), 
    New With {.style = "width:400px;"}
) %> 
```

请注意，您在值之前缺少一个点。

# sql - 使用 Left() 从多个表中选择并组合 2 行

> ID：14636755
> 
> 赞同：2
> 
> 时间：2013-01-31T23:02:34.027
> 
> 标签：sql

我拥有的这个功能可以满足我的需求，但只是想知道是否有办法一次性完成：

```
drop table ##aa
select s.storeid,cast(LEFT(p.paytype,1) as varchar(50)) as Paytype,SUM(amount) as Total
into ##aa
from RPTrs s, rpPay p
where s.storeid=p.StoreID and s.ReceiptNO=p.ReceiptNo 
and trsdate between '1/1/06' and '1/1/13'
group by s.storeid,LEFT(p.paytype,1)

update A set a.paytype=b.currencydesc
from ##aa a, Currencies b
where a.Paytype=b.POSCurrency

select * from ##aa order by Paytype, StoreID 
```

我要问的是，我想将 b.CurrencyDesc 应用于初始 p.paytype。Paytype 仅显示 C 作为示例，但我希望它代表现金，V 代表 Visa，如货币表中所述

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:21:16.040

好像你可以添加一个`JOIN`：

```
select   s.storeid
       , b.currencydesc as Paytype
       , SUM(amount)    as Total
into     ##aa
from     RPTrs s

join     rpPay p
on       s.storeid=p.StoreID
     and s.ReceiptNO=p.ReceiptNo

join     Currencies b 
on       b.POSCurrency=cast(LEFT(p.paytype,1) as varchar(50))

where    trsdate between '1/1/06' and '1/1/13'
group by s.storeid
       , b.currencydesc 
```

转换为使用显式连接语法。不知道什么表有贡献`trsdate`。而且我不确定`CAST`加入条件是否需要。

# java - 使用 HtmlUnit 以编程方式从 HTML 获取列表

> ID：14636757
> 
> 赞同：1
> 
> 时间：2013-01-31T23:02:41.360
> 
> 标签：java, html, dom, htmlunit

我正在尝试以编程方式（在 Java 中）提取与特定日期相对应的文章列表（标题和 URL 链接），如此处[所示](http://finance.yahoo.com/q/h?s=EURUSD=X&t=2013-01-31T00:11:00-05:00)。

结果将是这样的：

```
Thursday, January 31, 2013

 - Dollar Curbs Tumble Despite....
 - http://finance.yahoo.com/news/dollar-curbs-tumble-despite-gdp-051100047.html

Wednesday, January 30,2013

 - [video] Santelli's Midday Bond Report
 - http://us.rd.yahoo.com/finance/external/video/cnbc/SIG=110mfa5qs/*http://video.cnbc.com/gallery/?video=3000144631&__source=yahoo%7Cheadline%7Cquote%7Cvideo%7C&par=yahoo 
```

因此，如图所示，对于给定的日期，我正在尝试使用 HtmlUnit 提取所有标题/链接。

问题是：对于这项琐碎的任务，我对 HTML/DOM 的了解非常有限，如果有人能帮助我解决这个问题或为我指明正确的方向，我将不胜感激。

谢谢你。

编辑：检查页面时，似乎我正在寻找的标签包含在交替的“h3”和“ul”标签中。我只是不知道如何到达和遍历这些标签..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T03:08:17.760

首先，找到 id 为 "yfncsumtab" 的表：

```
HtmlTable table = page.getElementById("yfncsumtab"); 
```

然后，在表中查找`<h3>`和`<ul>`

```
SimpleDateFormatter dateParser = ...
List<DateAndTitle> result = new LinkedList();
Date lastDate = null;

// for(HtmlElement node : table.getHtmlElementDescendants()) {
for(HtmlElement node : findAllChildren(table)) {
    if( "ul".equals( node.getTagName() ) ) {
        String title = node.asText();
        result.add(new DateAndTitle(lastDate, title);
    }
    if( "h3".equals( node.getTagName() ) ) {
        String dateString = node.asText();
        lastDate = dateParser.parse(dateString);
    }
} 
```

和帮助函数递归查找所有后代 html 节点：

```
private HtmlElement findAllChildren(DomNode parent) {
    List<HtmlElement> result = new LinkedList();
    for(DomNode child : parent.getChildren()) {
        if( child instanceof HtmlElement ) {
            result.add( (HtmlElement) child );
        }
    }

    for(DomNode child : parent.getChildren) {
        result.addAll( findAllChildren( child ) );
    }

    retutn result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T03:00:34.517

尝试使用 getElementsByTagName() 以便您可以获取所有 <LI>

[http://httpunit.sourceforge.net/doc/api/com/meterware/httpunit/WebResponse.html#getElementsByTagName(java.lang.String)](http://httpunit.sourceforge.net/doc/api/com/meterware/httpunit/WebResponse.html#getElementsByTagName%28java.lang.String%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T14:00:19.817

只需学习[XPath](http://www.w3schools.com/xpath/default.asp)。`getFirstByXPath`通过使用或，您将获得 1 到 4 行的解决方案`getByXPath`。它位于“[入门](http://htmlunit.sourceforge.net/gettingStarted.html)”页面中。

# android - 使用 H.264 播放 mp4 的 Android 2.x 应用程序

> ID：14636758
> 
> 赞同：0
> 
> 时间：2013-01-31T23:02:44.830
> 
> 标签：android, video, mp4

Android 2.x 不能从头开始播放带有 H.264 基带的 mp4。

但是，在应用内播放视频文件时，某些应用程序能够管理这一点。

如何将编码器/解码器附加到应用程序内的视频播放器，以确保在没有外部依赖的情况下支持此格式。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:01:01.067

这些应用程序集成了一些媒体库（例如[FFmpeg](http://ffmpeg.org/)）

然而，解释如何编译、集成和使用这样的库远远超出了堆栈溢出的范围。

如果你有兴趣如何做到这一点。阅读以下问题/文章：

[Android 上的 FFmpeg](https://stackoverflow.com/questions/4725773/ffmpeg-on-android)

[用于 android 的 ffmpeg（使用教程：“ffmpeg 和 Android.mk”）](https://stackoverflow.com/questions/2645041/ffmpeg-for-a-android-using-tutorial-ffmpeg-and-android-mk)

[http://sourceforge.net/projects/ffmpeg4android/](http://sourceforge.net/projects/ffmpeg4android/)

[http://www.roman10.net/how-to-build-ffmpeg-for-android/](http://www.roman10.net/how-to-build-ffmpeg-for-android/)

# android - SharedPreferences 在关卡选择屏幕上加载金/银/铜

> ID：14636764
> 
> 赞同：0
> 
> 时间：2013-01-31T23:03:19.613
> 
> 标签：android, button, background, sharedpreferences

我有一个游戏，它的分数有金/银/铜奖阈值。游戏将获得的奖励保存在 SharedPreferences 文件中，键是关卡编号。所以在我的关卡选择屏幕上，我有 20 个关卡。我的代码如下所示：

```
 private void initButtons() {
    Button b1 = ((Button) findViewById(R.id.b1));

    load = getSharedPreferences(Game.DATA, Game.GOLD);
    if(load.getInt(Integer.toString(1), 0) == 4){
    b1.setBackgroundDrawable(getResources().getDrawable(
            R.drawable.gold));
    b1.setText("1");
    b1.setTextSize(30);
    b1.setOnClickListener(this);
    }

    ((Button) findViewById(R.id.b2)).setOnClickListener(this);
    ((Button) findViewById(R.id.b3)).setOnClickListener(this);
    ((Button) findViewById(R.id.b4)).setOnClickListener(this);
    ((Button) findViewById(R.id.b5)).setOnClickListener(this);
    ((Button) findViewById(R.id.b6)).setOnClickListener(this);
    ((Button) findViewById(R.id.b7)).setOnClickListener(this);
    ((Button) findViewById(R.id.b8)).setOnClickListener(this);
    ((Button) findViewById(R.id.b9)).setOnClickListener(this);
    ((Button) findViewById(R.id.b10)).setOnClickListener(this);
    ((Button) findViewById(R.id.b11)).setOnClickListener(this);
    ((Button) findViewById(R.id.b12)).setOnClickListener(this);
    ((Button) findViewById(R.id.b13)).setOnClickListener(this);
    ((Button) findViewById(R.id.b14)).setOnClickListener(this);
    ((Button) findViewById(R.id.b15)).setOnClickListener(this);
    ((Button) findViewById(R.id.b16)).setOnClickListener(this);
    ((Button) findViewById(R.id.b17)).setOnClickListener(this);
    ((Button) findViewById(R.id.b18)).setOnClickListener(this);
    ((Button) findViewById(R.id.b19)).setOnClickListener(this);
    ((Button) findViewById(R.id.b20)).setOnClickListener(this);
} 
```

所以我需要 3 个 if，else if 每个按钮的语句。这似乎很多。上面的代码是有效的还是我应该使用其他方法？

感谢安迪的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:13:42.760

```
private static int[] button_id{R.id.b1,R.id.b2.....};
private void initButtons() {
    for(int i=0;i<button_id.length;i++){
        Button ONE_OF_YOUR_BUTTON=getButton(button_id[i]);
        ONE_OF_YOUR_BUTTON.doStuffToIt();
    }
}

    }

private static Button getButton(int id){
    return (Button)findViewById(id));
} 
```

}

您可以随时循环播放。这些问题属于[代码审查](https://codereview.stackexchange.com/)

# linux - G++：链接器似乎没有正确链接

> ID：14636771
> 
> 赞同：-1
> 
> 时间：2013-01-31T23:03:41.313
> 
> 标签：linux, linker, g++

我尝试编译一个我必须控制 DAQ 设备的程序。在 Windows 中，g++ 编译和链接正常，但在 Linux 中却不行。链接器（由 G++ 调用）显示：

```
g++ -Wall -o "acelerar-30-0" "acelerar-30-0.cpp" (en el directorio: /home/poly/)
/tmp/ccRLpB4q.o: In function `main':
acelerar-30-0.cpp:(.text+0x429): undefined reference to `AdxInstantAoCtrlCreate'
collect2: ld returned 1 exit status
Ha fallado la compilación. 
```

cpp 文件是这样的（剪切）：

```
include stdlib.h
include stdio.h
include math.h
include "compatibility.h"
include "bdaqctrl.h"
include "comunes.h"
using namespace Automation::BDaq;
define deviceDescription L"USB-4704,BID#0"
int32       channelStart = 0;
int32       channelCount = 1;
double      voltaje[0];
int32       modo;
int32       ms;
int main(int argc, char* argv[])
{
    if (argc!=3)
        salidaerror(argv[0],1);
    channelStart = atoi(argv[1]);
    ms = atoi(argv[2]);
    if (channelStart<0||channelStart>1||ms<10)
        salidaerror(argv[0],1);
    ErrorCode ret = Success;
    InstantAoCtrl * instantAoCtrl = AdxInstantAoCtrlCreate();
... 
```

我已经为此花费了几个小时，但找不到答案。该 SDK 用于 Debian/Ubuntu，它在 Linux 和 Windows 上具有相同的代码。

有什么提示吗？谢谢

编辑：由于格式不正确，删除了一些标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T01:39:15.820

根据我的（有限）经验，典型的 gcc 行为将要求您在命令行上指定包含该函数的库作为参数，如下所示：

```
-lsome_library 
```

即使库位于您的库路径中，这也是必需的（可以使用 -L 指定其他库路径）。找到包含该函数的适当库文件，并在上面的参数格式中使用其文件名减去扩展名和前导“lib”。

# ruby-on-rails - 如何在表单构建器中获取提交按钮值？

> ID：14636773
> 
> 赞同：2
> 
> 时间：2013-01-31T23:03:51.327
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, simple-form, font-awesome

我正在使用`simple_form`Rails 3.2 上的 gem 创建一个表单。

我遇到的问题是我希望在我的表单行中添加一个`font-awesome`图标。`f.button :submit`由于输出是类型，`input`我无法在其中嵌入图标元素。

我可以简单地将`submit`按钮硬编码到包含图标的表单中，但我不确定如何获取按钮值 - `Create %model`/ `Update %model`。

我的代码发布在下面：

```
<div id="form">
  <%= simple_form_for @program, :html => { :class => 'form-horizontal' } do |f| %>
    <%= f.input :name %>
    <%= f.input :url %>
    <%= f.input :description, :input_html => { :class => "span5", :rows => 10 } %>

    *********************

    <%= f.button :submit do %>
      <i class="icon-save"></i> What Here??? <--- Doesn't work since output is type input
    <% end %>

    *********************

    <button class="btn">
      <i class="icon-save"></i> <%= f.button(:submit).label %> <--- Doesn't work, alternative?
    </button>
  <% end %> 
</div> 
```

预期输出：

```
<button type="submit" class="btn">
    <i class="icon-plus-sign"></i> Create *ModelName*        
</button> 
```

或更新*ModelName*，具体取决于控制器操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:18:01.500

```
<%= f.button do %>
    <i class="icon-save"></i> <%= "#{f.object.new_record? ? 'Create' : 'Update'} #{f.object.class.model_name.human}" %>
<% end %> 
```

最好为此制作一些辅助方法。如果您想使用 I18n，请查看[源代码](https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/form_helper.rb)（`button`和`submit_default_value`方法，第[1763](https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/form_helper.rb#L1763)和[1776](https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/form_helper.rb#L1776)行）。这很清楚。

# javascript - 如何在ajax回调中保留变量？

> ID：14636776
> 
> 赞同：2
> 
> 时间：2013-01-31T23:04:08.550
> 
> 标签：javascript, jquery, ajax, asp.net-mvc, asynchronous

我写了一些javascript来运行一系列“模块”。对于每个模块，它都会进行 ajax 调用，获取模块的 html，并将模块转储到页面布局的两列之一中。

```
var modules = [
    { name: 'ExchangeStatus', title: 'Exchange Status', column: 'left' },
    { name: 'Grid', title: 'Contacts', column: 'right' }
    { name: 'Filters', title: 'Filters', column: 'left' }
],
modulesUrl = '/Modules/';

for (var count = 0; count < modules.length; count++) {
    var module = modules[count];

    // Get module HTML.
    $.ajax({
        url: modulesUrl + module.name,
        success: function (moduleHtml) {

            // Append module HTML to appropriate element.
            $('#' + module.column + 'Column').append(moduleHtml);

            // Custom event to trigger the module to load its data.
            var initializeModuleEvent = $.Event('initialize' + module.name);
            initializeModuleEvent.firstLoad = true;
            $(document).trigger(initializeModuleEvent);

        }
    });
} 
```

问题在于 for 循环创建了一个竞争条件。在 ajax 回调`module.column`中几乎总是最后一个模块的值，因为 for 循环在 ajax 回调返回之前很久就完成了。如何维护模块变量，以便每个回调处理适当的模块？目前所有三个模块都在左列中，因为循环中的最后一个模块在左列中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T23:08:15.953

您可以尝试创建一个额外的范围来传递`module`：

```
for (var count = 0; count < modules.length; count++) {
    var module = modules[count];

    (function(module) {
      $.ajax({
        ...
      })
    }(module)); 
```

**编辑：**如果你愿意，你也可以使用`forEach`：

```
modules.forEach(function(module) {
 // 'module' will be available everywhere in this scope
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T23:09:15.467

将您的成功回调修改为：

```
$.ajax({
    url: modulesUrl + module.name,
    success: (function (module) {
        return function (moduleHtml) {
            // Append module HTML to appropriate element.
            $('#' + module.column + 'Column').append(moduleHtml);

            // Custom event to trigger the module to load its data.
            var initializeModuleEvent = $.Event('initialize' + module.name);
            initializeModuleEvent.firstLoad = true;
            $(document).trigger(initializeModuleEvent);
        };
    }(module));
}); 
```

这将为适当的`module`变量值创建一个新范围。

没有必要在`ajax`这里包装整个通话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T23:29:09.003

而不是使用for循环使用jquery的每个..这将解决问题

```
var modules = [
    { name: 'ExchangeStatus', title: 'Exchange Status', column: 'left' },
    { name: 'Grid', title: 'Contacts', column: 'right' }
    { name: 'Filters', title: 'Filters', column: 'left' }
],
modulesUrl = '/Modules/';

$(modules).each( function(index, elem)
{
    var module = elem;

    // Get module HTML.
    $.ajax({
        url: modulesUrl + module.name,
        success: function (moduleHtml) {

            // Append module HTML to appropriate element.
            $('#' + module.column + 'Column').append(moduleHtml);

            // Custom event to trigger the module to load its data.
            var initializeModuleEvent = $.Event('initialize' + module.name);
            initializeModuleEvent.firstLoad = true;
            $(document).trigger(initializeModuleEvent);

        }
    });
}
}
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T23:08:39.160

那会有所帮助

```
for (var count = 0; count < modules.length; count++) {
    var module = modules[count];

    (function (module) {
        // Get module HTML.
        $.ajax({
            url: modulesUrl + module.name,
            success: function (moduleHtml) {

                // Append module HTML to appropriate element.
                $('#' + module.column + 'Column').append(moduleHtml);

                // Custom event to trigger the module to load its data.
                var initia`enter code here`lizeModuleEvent = $.Event('initialize' + module.name);
                initializeModuleEvent.firstLoad = true;
                $(document).trigger(initializeModuleEvent);

            }
        });
    })(module)
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T23:17:54.397

试试这个方法，告诉我它是否有效！

```
for (var n = 0; n < modules.length; n++) {
(function () {
    var i = n;
        var module = modules[i];

        // Get module HTML.
        $.ajax({
            url: modulesUrl + module.name,
            success: function (moduleHtml) {

                // Append module HTML to appropriate element.
                $('#' + module.column + 'Column').append(moduleHtml);

                // Custom event to trigger the module to load its data.
                var initializeModuleEvent = $.Event('initialize' + module.name);
                initializeModuleEvent.firstLoad = true;
                $(document).trigger(initializeModuleEvent);

            }
        });
    } ());
} 
```

# autocomplete - Sublime text 2 - AutoComplete 带来不相关的建议

> ID：14636778
> 
> 赞同：0
> 
> 时间：2013-01-31T23:04:10.820
> 
> 标签：autocomplete, sublimetext2

有时，自动完成功能会提出一些与上下文完全无关的建议。

例如：

**我的模块.py：**

```
class test_1(object):
    def test_def(self):
        my_var_1 = 'sample text'

class test_2(object):
    def another_test_function(self):
        self.my_var_2 = 'another sample text' 
```

**配置文件：**

```
MY_CONF_1 = 12
MY_CONF_2 = 13
MY_CONF_3 = 14 
```

**测试.py：**

```
import Conf
import TEST

print Conf. 
```

在我输入`Conf.`( `ctrl`+ `space`) 的那一刻，它会显示`print`, `import`, `MyModule`,的选项`Conf`。在上下文中它是无关紧要的。它不会将任何变量带入 Conf.py 文件中。（好吧，当我开始打字时它确实如此`MY_C`）

我已经尝试过 "AllAutoComplete" 和 "CodeIntel" ，但它们都没有按预期工作。

如何强制自动完成仅带来与上下文相关的可用选项？

PS：AutoComplete 的模糊搜索有时效果很好，例如，当你在某个地方有数据库的表名并只是输入它时，但在大多数情况下我不能依赖。

# c - C 指针分段错误崩溃

> ID：14636780
> 
> 赞同：0
> 
> 时间：2013-01-31T23:04:19.160
> 
> 标签：c, segmentation-fault

```
// Struct for Country Data
typedef struct
{
    char name[50];          // Country name
    char code[3];           // Country code
    int population;         // Country Population
    double lifeExp;         // Country Life expectancy  

}   CountryData;

// Struct for Dir File
typedef struct
{
    char code[50];
    int offSet;

}   DirData;

// Function Declarations
void fillCountryStructs(CountryData **dataPtr, int nLines, int fd);
void fillDirectoryStructs(CountryData **dataPtr, DirData **director, int nLines,int fd2);
void sortStructs(DirData **director, int nLines);
int verifyString(char *s1, char *s2);

// Main Function
// - This function starts the program, get the number of lines as a 
//   parameter, fills the structs and writes the data to the Country
//   File and the Directory file.
int main(int argc, char *argv[])        // Always remember to pass an argument while executing
{
    // Some variables
    int nLines;             // The number of lines
    char *pEnd;             // For String functions
    FILE *Fin,*Fout;        // File pointers
    int fd; 
    int fd2;
    nLines = strtod(argv[1], &pEnd); 
    CountryData **countryDataPtr;   // Array of structs
    CountryData **tempStruct;
    DirData **director;
    char buffer[15];    

    // Allocate memory for the struct pointers
    countryDataPtr = calloc(nLines, sizeof(CountryData*));
    director = calloc(nLines, sizeof(DirData*));
    // File Stream for "AllCountries.dat"
    if((fd = open("AllCountries.dat", O_RDWR|O_CREAT)) ==-1)
        err_sys("File not found...\n");
    // File Stream for "RandomStruct.bin"
    if ((fd2 = open("RandomStruct.bin",O_RDWR|O_CREAT)) == -1) 
        err_sys("Failed to open binary\n");

    // Filling the Country stucts
    fillCountryStructs(countryDataPtr, nLines, fd);

    close (fd);
    //fclose(Fin);                                      // Closing the file "AllCountries.dat"
    // Writing Binary File
    write(fd2, (countryDataPtr[0]->name[0]), sizeof(CountryData));

    int c=0;
    int n=0;
    int counter=0;
    int tempn=0;
    for (c=0;c<nLines;c++)
    {    
    write(fd2, (countryDataPtr[c]->name),50);

    write(fd2, (countryDataPtr[c]->code),4);

    sprintf(buffer, "%d", countryDataPtr[c]->population); // Function from String.h
    n = strlen(buffer);
    write(fd2, buffer, n);

    if (n<15)
    {
    for (counter=0;counter<(15-n);counter++)
    {
    write(fd2," ",1);
    }
    }
    //printf("n: %i n-15: %i\n",n,(15-n));

    //sprintf(buffer, "%0.1f", countryDataPtr[c]->lifeExp); // Function from String.h
    //n=((int)(countryDataPtr[c]->lifeExp));

    tempn=((int)(countryDataPtr[c]->lifeExp));

    sprintf(buffer, "%d", tempn); // Function from String.h
    n = strlen(buffer);
    write(fd2, buffer,n);
    write(fd2,"\n",1);
}
    close (fd2);

        printf("prueba\n");
    //fclose(Fout);
    printf("RandomStruct.bin written Sucessfully\n");

    // Filling the Directory File
    // File Stream for "RandomStructDir.dir"

    if ((fd2 = open("RandomStructDir.dir",O_RDWR|O_TRUNC)) != -1) 
        err_sys("Failed to open binary\n");
    printf("holla0\n");

    fillDirectoryStructs(countryDataPtr, director, nLines, fd2);

    printf("holla\n");
    sortStructs(director, nLines);                                  // Sorting the structs
    printf("holla2\n");
    // Write the number of lines in the FIRST LINE
    // of the Directory File
    write(fd2, &nLines, sizeof nLines);
    // Writing Directory File after the number of lines was written

    //write(fd2,(director[0]->code[0]), sizeof(DirData));

    for (c=0;c<nLines;c++)
    {    
        write(fd2, (director[c]->code),4);
    }

    close (fd2);
    //fclose(Fout);
    printf("RandomStructDir.dir written Sucessfully\n\n");

    exit(0);
}

// Filling the Country structs
// - This function extracts the data from the file using strtok 
//   and fills all the structs with their corresponding values.
void fillCountryStructs(CountryData **dataPtr, int nLines, int fd)
{
    int curLine = 0;        // Current line
    int index = 0;          // The index
    char buf[BUFSIZE];      // The Buffer with the size of BUFSIZE
    char *tok;              // Token
    char *pEnd;             // For the String functions
        char ch = 'a'; // The temp character
    int temPop;
    double temLifeExp;  
    int num=0;

    for(curLine = 0; curLine < nLines; curLine++)
    {
       // Reading each line
    dataPtr[curLine] = (CountryData *)calloc(1, sizeof(CountryData));
    index = 0;
    do
    {
    read(fd, &ch, 1);
    buf[index++] = ch;
    }
    while(ch != '\n');

        // Strtoking...
        tok = strtok(buf, ",\n");

        index = 1;
        while(tok != NULL)
        {
            tok = strtok(NULL, ",\n");

            // Get the Country Code
            if(index == 1)
            {
                strcpy(dataPtr[curLine]->code, tok);        // Copying code to the struct
             //write(fd2, (tok), sizeof(CountryData[0]));
            }
            // Get the Country Name
            if(index == 2)
            {
                strcpy(dataPtr[curLine]->name, tok);        // Copying name to the struct
          //write(fd2, (tok), sizeof(CountryData));
            }
            // Get the Country Population
            if(index == 7)
            {
                temPop = (int)strtol(tok, &pEnd, 10);
                dataPtr[curLine]->population = temPop;      // Copying population to the struct
            }
            // Get the Country Life expectancy
            if(index == 8)
            {
             num=countchar(tok);
          printf ("The number of characters entered is %d\n", num);
          printf ("The character entered is %s\n",tok);
                temLifeExp = strtod(tok, &pEnd);
                dataPtr[curLine]->lifeExp = temLifeExp;     // Copying life expectancy to the struct
            }
            index++;
        }
    }
}

int countchar (char list[])
{
        int i, count = 0;
        for (i = 0; list[i] != '\0'; i++)
        count++;
        return (count);
}

// Filling the Directory Structs
// - This function fills the directory with the offset
void fillDirectoryStructs(CountryData **dataPtr, DirData **director, int nLines, int fd2)
{

    int i = 0;
    for(i = 0; i < nLines; i++)
    {
        strcpy(director[i]->code, dataPtr[i]->code);      //It crashes in this Line
        director[i]->offSet = 72 * (i);     
    }   

}

// Sorting the Dir Structs
// - This function sorts the Directory Structs.
void sortStructs(DirData **director, int nLines)
{

    int maxNumber;
    int i;
    DirData **temp;
    temp = calloc(1, sizeof(DirData*));

    // Sorting the array of pointers!
    for(maxNumber = nLines - 1; maxNumber > 0; maxNumber--)
    {
        for(i = 0; i < maxNumber; i++)
        {
            if((verifyString(director[i]->code, director[i+1]->code)) == 1)
            {
                temp[0] = director[i];
                director[i] = director[i+1];
                director[i+1] = temp[0];
            }           
        }           
    }
}

// Veryfying the strings
// - This function compares two strings and return a specific value
//   accordingly.
int verifyString(char *s1, char *s2)
{
    int i;
    if(strcmp(s1,s2) == 0)
        return(0);          // They are equal

    for(i = 0; s1[i] != 0; i++)
    {
        if(s1[i] > s2[i])
            return(1);              // s1 is greater
        else if(s1[i] < s2[i])
            return(2);              // s2 is greater
    }

    return (2); // s2 is greater
} 
```

因此，出于某种原因，这是我的代码，当我调用此方法时，它会崩溃：

`void fillDirectoryStructs(CountryData **dataPtr, DirData **director, int nLines, int fd2)`...

它崩溃的确切行：

```
strcpy(director[i]->code, dataPtr[i]->code);    <-here 
```

它一定是关于指针的，或者我不知道，我正在尝试将右侧的内容复制到左侧的结构中。我打印`dataPtr[0]->code`并显示正确的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:07:54.383

```
 strcpy(director[i]->code, dataPtr[i]->code);      //It crashes in this Line 
```

在这一点上，`director[i]`不指向任何东西。你需要一条`director[i] = calloc(...`线，就像 in 一样`fillCountryStructs`。

# jquery - 使用 jQuery Datatables，如何从 JSON 输入值？

> ID：14636782
> 
> 赞同：2
> 
> 时间：2013-01-31T23:04:22.397
> 
> 标签：jquery, ajax, json, datatables

我对基于 JS 的网络应用程序工作很陌生，所以这是我的问题。我有一个数据表设置，它使用硬编码数据正常运行，我得到了我的 JSON 结果。我不知道如何使用 JSON 结果填充表并替换硬编码数据。

下面是我必须使用 JS 的地方，所以我希望动态加载内容`".1"-".5"`

```
function fnClickAddRow() {

$.getJSON('thelink',function(data){
    var dealers = data['dealers'];

    $.each(dealers,function(x,dealer){

    $('#example').addClass( "table datatable table-striped table-bordered sub-table" );
    $('#example').removeClass( "dataTable" );

    $('#example').dataTable().fnAddData( [
    '<img id="' + dealer['user_id'] + '" src="assets/utopia/icons/add.png">',
    dealer['name'],
    ".1",
    ".2",
    ".3",
    ".4",
    ".5",
    '<a href="javascript:void(0)" onclick="edit_user(27186);" class="edit"><img alt="Edit user" src="/assets/utopia/icons/pencil.png" title="Edit User"></a> <a href="javascript:void(0)" onclick="remove_user_confirm(27186);" class="delete"><img alt="Remove user" src="/assets/utopia/icons/trash_can.png" title="Remove User"></a>'] );

    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T08:39:39.463

如果您只想在数据表中显示 json 数据，请查看文档： [http ://www.datatables.net/plug-ins/server-data-formats](http://www.datatables.net/plug-ins/server-data-formats)

如果您需要动态替换（添加/删除）表中的行，请查看： [http](http://datatables.net/examples/api/add_row.html) ://datatables.net/examples/api/add_row.html 并检查 fnDeleteRow 方法： [http ://www.datatables.net/api](http://www.datatables.net/api)

# emacs - 如何为 Emacs 取消设置空白模式的前景色

> ID：14636786
> 
> 赞同：5
> 
> 时间：2013-01-31T23:04:37.333
> 
> 标签：emacs, whitespace, long-lines

在编程文件中，我使用空白模式来突出显示制表符和长行。默认突出显示对我来说太装饰了。我只想用灰色背景突出显示它们，并保持字体应有的正常颜色。我怎么能设置呢？

以下设置不起作用。我希望超过 80 列的代码显示为黄色，因为快照中 80 列内的字符。

```
;; face for long lines' tails
(set-face-attribute 'whitespace-line nil
                    :background "#555"
                    :weight 'bold)

;; face for Tabs
(set-face-attribute 'whitespace-tab nil
                    :background "#555"
                    :weight 'bold) 
```

![空白模式](../Images/62c4037ee2de9565a5a74b495247046e.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T00:22:19.257

`set-face-attribute`仅更改您指定的属性。

设置`:foreground`为`nil`：

```
(set-face-attribute 'whitespace-line nil
                    :foreground nil
                    :background "#555"
                    :weight 'bold) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-10T17:14:32.710

对我来说，令人不快的颜色原来是尾随空格，我正在使用这个：

```
;; whitepace looks rediculous in color themes.
(defadvice color-theme-install (after my-color-theme-install-after activate)
  "Fix trailing-whitespace after color theme destroys it"
  (set-face-attribute 'trailing-whitespace nil
                      :foreground 'unspecified
                      :inverse-video 'unspecified
                      :slant 'unspecified
                      :weight 'unspecified
                      :background "#fff")) 
```

# c# - 在txt文件中添加一行

> ID：14636787
> 
> 赞同：1
> 
> 时间：2013-01-31T23:04:51.630
> 
> 标签：c#

我有一个 txt 文件，其中包含如下数据：

```
:10FF800000040B4E00040B4E00047D1400047D148D
:10FF900000040B4E0004CF6200040B4E00040B4E15
:10FFA00000040B4E00040B4E00040B4E00040B4EDD
:10FFB00000047D1400047D1400047D1400047D14ED
:10FFC00000040B4E000000000000000000000000D4
:10FFD0000000000000040B4E0000000000000000C4
:10FFE0000000000000000000000000000000000011
:10FFF0000000000000000000060000000000BFF844
:020000020000FC
:020000040014E6
:043FF0005AC8A58C7A
:00000001FF 
```

我想用我的 C# 程序做的是在特定行之后或之前添加一行，假设添加行：

```
:020000098723060 
```

在此行之前：

```
:020000020000FC 
```

我试过使用 File.ReadLines("file.txt").Last(); 但这只是给了我最后一个，如果我想要第三个或第四个怎么办？另外，有什么方法可以识别文件中的“：”吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T23:08:58.550

The *simplest* way - if you're happy to read the whole file into memory - would be just:

```
public void InsertLineBefore(string file, string lineToFind, string lineToInsert)
{
    List<string> lines = File.ReadLines(file).ToList();
    int index = lines.IndexOf(lineToFind);
    // TODO: Validation (if index is -1, we couldn't find it)
    lines.Insert(index, lineToInsert);
    File.WriteAllLines(file, lines);
}

public void InsertLineAfter(string file, string lineToFind, string lineToInsert)
{
    List<string> lines = File.ReadLines(file).ToList();
    int index = lines.IndexOf(lineToFind);
    // TODO: Validation (if index is -1, we couldn't find it)
    lines.Insert(index + 1, lineToInsert);
    File.WriteAllLines(file, lines);
} 
```

There are significantly more *efficient* ways of doing this, but this approach is really *simple*.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T23:09:18.113

A brute force approach

```
string[] lines = File.ReadAllLines("file.txt");
using(StreamWrite sw = new StreamWriter("file.txt"))
{
   foreach(string line in lines)
   {
       if(line == ":020000020000FC")
          sw.WriteLine(":020000098723060");
       sw.WriteLine(line);
   }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T23:14:30.973

我会说最好逐行读取和写入，特别是如果目标文件往往很大：

```
using (StreamReader r = new StreamReader("Test.txt"))
{
    using (StreamWriter w = new StreamWriter("TestOut.txt"))
    {
        while (!r.EndOfStream)
        {
            string line = r.ReadLine();
            w.WriteLine(line);
            if (line == ":020000020000FC")
                w.WriteLine(":020000098723060");
        }
        w.Close();
        r.Close();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T01:41:42.877

“：”字符并没有真正帮助实现，这些行都已经用*换行符*分隔了。

这是一种不将其全部加载到内存或输出到不同文件的方法的尝试。

**永远不要越过溪流。**

```
static Int32 GetCharPos(StreamReader s)
{
    var ia = BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.GetField;
    Int32 charpos = (Int32)s.GetType().InvokeMember("charPos", ia, null, s, null);
    Int32 charlen = (Int32)s.GetType().InvokeMember("charLen", ia, null, s, null);
    return (Int32)s.BaseStream.Position - charlen + charpos;
}

static void Appsert(string data, string precedingEntry = null)
{
    if (precedingEntry == null)
    {
        using (var filestream = new FileStream(dataPath, FileMode.Append))
        using (var tw = new StreamWriter(filestream))
        {
            tw.WriteLine(data);
            return;
        }
    }

    int seekPos = -1;
    using (var readstream = new FileStream(dataPath, 
        FileMode.Open, FileAccess.Read, FileShare.Write))
    using (var writestream = new FileStream(dataPath, 
        FileMode.Open, FileAccess.Write, FileShare.Read))
    using (var tr = new StreamReader(readstream))
    {
        while (seekPos == -1)
        {
            var line = tr.ReadLine();
            if (line == precedingEntry)
                seekPos = GetCharPos(tr);
            else if (tr.EndOfStream)
                seekPos = (int)readstream.Length;
        }

        writestream.Seek(seekPos, SeekOrigin.Begin);
        readstream.Seek(seekPos, SeekOrigin.Begin);
        int readLength = 0;
        var readBuffer = new byte[4096];
        var writeBuffer = new byte[4096];
        var writeData = tr.CurrentEncoding.GetBytes(data + Environment.NewLine);
        int writeLength = writeData.Length;
        writeData.CopyTo(writeBuffer, 0);
        while (true & writeLength > 0)
        {
            readLength = readstream.Read(readBuffer, 0, readBuffer.Length);
            writestream.Write(writeBuffer, 0, writeLength);
            var tmp = writeBuffer;
            writeBuffer = readBuffer;
            writeLength = readLength;
            readBuffer = tmp;
        }                
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-01T00:21:37.280

这是一个解决方案，虽然它可能不是最好的，但它确实有效：

```
public void AddTextToFile(string filePath, int lineNumber, string txt) //zero based lineNumber
{
        Collection<string> newLines = new Collection<string>(File.ReadAllLines(filePath).ToList());

        if (lineNumber < newLines.Count)
            newLines.Insert(lineNumber, txt);
        else 
            newLines.Add(txt);

        using (StreamWriter writer = new StreamWriter(filePath, false))
        {
            foreach (string s in newLines)
                writer.WriteLine(s);
        }
} 
```

并且要回答有关确定字符串中是否存在“：”的问题，答案是肯定的，在上面的示例中，您可以通过...检查该行是否包含它

```
if(newLines[idx].Contains(':'))
//do something 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-31T23:17:49.040

不确定您是否由于大小等原因试图避免读取整个文件...但是您不能只读取文件然后替换...例如

```
var text = readFile(somePath);
writeFile( text.replace(":020000020000FC\n",":020000098723060\n:020000020000FC\n") , somePath); 
```

# c - C 等价于 regionprops

> ID：14636788
> 
> 赞同：0
> 
> 时间：2013-01-31T23:04:56.227
> 
> 标签：c, matlab

我正在尝试将人脸检测 Matlab 代码转换为 C，以便在 PIC32 微控制器上使用它。但是 Matlab Coder 给出了一个错误，指出不支持 regionprops 函数。我必须有哪些替代方法才能在 C 中获得用于人脸检测的工作功能？

谢谢

# javascript - 用于编辑网页的 Javascript 库

> ID：14636791
> 
> 赞同：0
> 
> 时间：2013-01-31T23:05:22.823
> 
> 标签：javascript, jquery, html

是否有 javascript 库或其他制作网页的方法，当您双击标题或其他内容时，文本会被文本输入字段替换为您单击的文本的值？

我正在一个有任务列表的网站上工作。我想让用户更改列表中的项目，而不必处理加载新页面或处理弹出窗口或弹出窗口。我知道我以前见过这样的东西，我就是找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:08:00.140

我认为[Jeditable](http://www.appelsiini.net/projects/jeditable)是您正在寻找的。演示[在这里](http://www.appelsiini.net/projects/jeditable/default.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:08:28.453

You might check out AngularJS. It makes this sort of thing almost trivial.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T23:15:05.393

[Redactor](http://imperavi.com/redactor/)远远优于这些示例，但它需要花钱。它可以让您直接上传到 Amazon S3，这很棒。我自己购买了一个，但我可以一次又一次地重复使用许可证。

[KitGUI](http://www.kitgui.com)也非常好，它会自动保存到 CDN，适用于所有技术，并且对 SEO 有好处，Redactor 只负责编辑，编辑后不显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T23:07:08.117

尝试 CKEditor ( [http://ckeditor.com/](http://ckeditor.com/) ) 或查看 html5 可编辑 - 如果您想要更基本的东西。

# msbuild - MSbuild，如何访问内联任务代码中的项目属性值？

> ID：14636796
> 
> 赞同：5
> 
> 时间：2013-01-31T23:05:34.170
> 
> 标签：msbuild, msbuild-task, msbuild-propertygroup

我有用 csharp 编写的内联任务代码

我想知道是否有办法访问内联任务代码中的propect属性

例如。我正在尝试用项目属性值替换字符串匹配。是否可以？

```
<![CDATA[
      MatchCollection matches = Regex.Matches(SourceStr, Pattern);

      for (int i = 0; i < matches.Count; i++)
           // replace the match value with project property... possible?

    ]]> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T23:21:48.987

将其作为参数传递，就像使用已编译任务一样？

```
<ParameterGroup>
    <Foo ParameterType="System.Bar" Required="true" />
<ParameterGroup> 
```

编辑：看起来简单的内联标记也可以工作。

```
<![CDATA[
    Console.WriteLine("$(Foo)");
]]> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T01:18:51.983

太大，无法作为评论回复。

它为空的原因与您的另一个问题一样 - 评估顺序。在达到目标之前对代码进行评估和标记化，我假设这是您设置值和设置属性的地方。

如果我了解您要通过该任务实现的目标，请看下面的示例，只需将它们作为属性传递并作为输出传递。

也就是说，我认为你应该先研究一下**属性函数**，为自己省去很多麻烦。

[http://msdn.microsoft.com/en-us/library/dd633440.aspx](http://msdn.microsoft.com/en-us/library/dd633440.aspx)

```
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <UsingTask TaskName="Foo" TaskFactory="CodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll">
        <ParameterGroup>
            <SourceStr Required="true" Output="true" />
            <Pattern Required="true" />
            <Value Required="true" />
            <Macros ParameterType="Microsoft.Build.Framework.ITaskItem[]" Output="true" />
        </ParameterGroup>
        <Task>
            <Using Namespace="System.Linq" />
            <Using Namespace="System.Text.RegularExpressions" />
            <Code Type="Fragment" Language="cs">
            <![CDATA[
                var regex = new Regex(Pattern);
                var matches = regex.Matches(SourceStr).Cast<Match>().Select(m => m.Value).ToList();
                matches.ForEach(m => Log.LogMessage("{0} -> {1}", m, Value));
                Macros = matches.Select(m => new TaskItem(m)).ToArray();
                SourceStr = regex.Replace(SourceStr, Value);
            ]]>
            </Code>
        </Task>
    </UsingTask>
    <Target Name="Foo">
        <PropertyGroup>
            <SourceStr>Bar</SourceStr>
            <Value>z</Value>
        </PropertyGroup>
        <Message Text="in $(SourceStr)" />
        <Foo SourceStr="$(SourceStr)" Pattern="r$" Value="$(Value)">
            <Output TaskParameter="SourceStr" PropertyName="SourceStr" />
            <Output TaskParameter="Macros" ItemName="Macros" />
        </Foo>
        <Message Text="out $(SourceStr)" />
        <Message Text="sans %(Macros.Identity)" />
    </Target>
</Project> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T23:33:45.450

[MSDN 文档](http://msdn.microsoft.com/en-us/library/dd722601%28v=vs.100%29.aspx)中有示例。例如：

```
<Project xmlns='http://schemas.microsoft.com/developer/msbuild/2003' ToolsVersion="4.0">
    <UsingTask TaskName="TokenReplace" TaskFactory="CodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll">
        <ParameterGroup>
            <Path ParameterType="System.String" Required="true" />
            <Token ParameterType="System.String" Required="true" />
            <Replacement ParameterType="System.String" Required="true" />
        </ParameterGroup>
        <Task>
            <Code Type="Fragment" Language="cs">
                <![CDATA[
    string content = File.ReadAllText(Path);
    content = content.Replace(Token, Replacement);
    File.WriteAllText(Path, content);
    ]]>
            </Code>
        </Task>
    </UsingTask>

    <Target Name='Demo' >
        <TokenReplace Path="C:\Project\Target.config" Token="$MyToken$" Replacement="MyValue"/>
    </Target>
</Project> 
```

如果`$(MyValue)`是项目属性，您可以执行以下操作：

```
<TokenReplace Path="C:\Project\Target.config" Token="$MyToken$" Replacement="$(MyValue)"/> 
```

# android - 如何在 Android 中创建标题边框？

> ID：14636799
> 
> 赞同：6
> 
> 时间：2013-01-31T23:05:44.170
> 
> 标签：android, titled-border

有人知道如何创建像[摇摆](http://docs.oracle.com/javase/tutorial/uiswing/components/border.html)那样的标题边框布局吗？

在[这个](https://stackoverflow.com/questions/1598119/is-there-an-easy-way-to-add-a-border-to-the-top-and-bottom-of-an-android-view)网站上，我发现了一个在对象之间生成矩形的技巧。也许这可以帮助我创建这样一个标题边框？

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-01T00:31:51.163

又快又脏：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" 
android:color="#000000">
<View
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/rectangle"
    android:layout_margin="20dp"
    />
<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:background="#000000"
        android:layout_marginTop="10dp"
        android:text="TITLE!"
        android:textColor="#ffffff"/>
</RelativeLayout>

</FrameLayout> 
```

并且`@drawable/rectangle`在这样的可绘制`rectangle.xml`文件中：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" 
    android:shape="rectangle">
<solid android:color="@android:color/transparent"/>
<stroke  android:width="2dip" android:color="#ffffff"/>  
</shape> 
```

# javascript - 在 uiwebview 中播放多个声音

> ID：14636800
> 
> 赞同：1
> 
> 时间：2013-01-31T23:05:42.843
> 
> 标签：javascript, html, uiwebview, media, html5-audio

在过去几个小时搜索此数据库后，我发现 safari（和 uiwebview）将音频标签视为单例，因此每次只会创建一个音频播放器。

我的问题：是否有现成的objectiveC（类似phonegap）工具，我可以使用它从JS调用来创建多个并发音频播放器，或者我是否需要深入研究objectiveC编程来创建本机代码和允许的桥接器我从JS激活播放器？

背景：我正在开发一款游戏，需要同时播放多种声音（例如背景音乐和按钮点击）。我正在用 javascript 编写游戏以用于跨平台目的（也用于现成的网站游戏演示），ios 版本使用 phonegap 打包为应用程序。

我正在使用以下代码预加载我的音频文件：

```
var elem = document.createElement('audio');
elem.addEventListener("loadeddata", function() {                  
    handler.audioLoaded(name);
    ready = true;
}, true);
elem.setAttribute('src', src);
elem.load(); 
```

此代码在每个音频资源的循环中调用 - 在桌面上的 chrome 中运行良好，但在 ipad 上运行时，只有第一个被加载的资源可用 - 下一个资源不会被加载，并且在`elem.play()`被调用时不会播放。

任何建议将不胜感激。

==================================================== ===========================

更新：原来 phonegap Media 对象做得很好，一次播放多个音频文件。

# excel - 如何有条件地合并/加入 Excel 工作表？

> ID：14636802
> 
> 赞同：11
> 
> 时间：2013-01-31T23:06:13.573
> 
> 标签：excel, vba, join, merge, conditional

```
+---------+---------+  +---------+--------------+  +---------+-------------+
+ country + widgets +  + country + frammis rods +  + country + comex gears +
+---------+---------+  +---------+--------------+  +---------+-------------+
+ alpha   +       1 +  + bravo   +            8 +  + charlie +          18 +
+ bravo   +       3 +  + charlie +           16 +  + delta   +           9 +
+ charlie +       7 +  + delta   +           32 +  +---------+-------------+
+ delta   +      11 +  +---------+--------------+
+---------+---------+ 
```

我在同一个电子表格中有几个这样的 Excel 工作表^^^。我正在尝试创建一个包含合并数据的新工作表，其中仅显示那些在**所有**工作表类别中都有数据的国家/地区。

**例如，**

```
+---------+---------+--------------+-------------+
+ country + widgets + frammis rods + comex gears +
+---------+---------+--------------+-------------+
+ charlie +       7 +           16 +          18 +
+ delta   +      11 +           32 +           9 +
+---------+---------+--------------+-------------+ 
```

随着各种工作表的更新/新工作表的添加，我正在寻找一种相当简单、灵活的方式来执行此操作。我知道如何在 MYSQL 中执行此操作，但我不确定在 excel 中是否可行。

那么，专家们有什么想说的呢？

提前谢谢。:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T03:01:46.633

首先，感谢[@MikeD](https://stackoverflow.com/users/185547/miked)关于使用数据透视表的解决方案的精彩文章。我确实设法让它在 Excel 2007 中工作。

但是，我决定使用 SQL 查询，因为它的速度要快得多。（是的，您可以使用 SQL 来合并工作表。太好了！）

**1)**数据 --> 来自其他来源 --> 来自 Microsoft Query

**2)**选择数据源 --> Excel 文件* --> 选中“使用查询向导创建/编辑查询”

**3)**选择工作簿

**4)**选择您想要的列 --> 单击下一步 --> 在弹出警告您需要设置手动加入时单击“确定”

![在此处输入图像描述](../Images/72dc39068bae6d72fe26ae28d56bba00.png)

**5)**在“Microsoft Query”窗口中 --> 表 --> 连接

![在此处输入图像描述](../Images/5abb6bbee4eea5d1b63b89d8214bb6be.png)

**6)**点击“返回数据”图标

![在此处输入图像描述](../Images/755cf58dfb546488451e3b175ac34c89.png)

**7)**导入数据 --> `CTL`+ 单击重复项的列标题（例如“Country2”、“Country3”）--> 右键单击​​ --> “隐藏”

![在此处输入图像描述](../Images/56788054684501f01d7b63efe94ac012.png)

**8）**！

![在此处输入图像描述](../Images/a06b0e92b453737fad337a6bfeabe6b5.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-01T20:47:16.263

我建议使用具有多个合并范围的数据透视表。（至少在 2010 年）无论工作表是在同一个工作簿中还是在不同的工作簿中，这都有效（参见图片）

提示：在 Excel 2010 中按 Alt-D，然后按 P 访问 2003 类似数据透视表向导。

![数据透视表向导](../Images/90b39276f0577dc14c4e5a73ae0fb2ce.png)

没有页面字段

![3 个数据表 + Pivot 整合](../Images/ec6159ae7974e70ec2209105fef61f00.png)

不要忘记要求 SUM 而不是 COUNT （任何值单元格-->右键单击-->汇总值）

要获得最终布局，请在数据透视表上方添加一个额外的标题行（深蓝色 A、B；C、...），创建一个自动过滤器并过滤所有列中的非空白

![在此处输入图像描述](../Images/1b8ff5b6c272970dac91600931aad343.png)

呸呸呸！

# heroku - Sinatra - 未设置下游应用程序

> ID：14636807
> 
> 赞同：1
> 
> 时间：2013-01-31T23:06:39.527
> 
> 标签：heroku, routes, sinatra, thin

我收到这个奇怪的错误：`downstream app not set`

但是我的应用程序正在响应并且运行良好。

我已经检查过了 - 我没有发现任何对未定义路由的请求。（也许有一些工具可以调试）

也检查了谷歌。

请帮助 - 如何消除此错误。

日志：

```
00:52:51 web.1 | 从 pid 13052 开始
00:52:59 web.1 | 127.0.0.1 - - [01/Feb/2013 00:52:59]“获取/管理 HTTP/1.1”200 5046 0.3123
00:52:59 web.1 | 127.0.0.1 - - [01/Feb/2013 00:52:59] “GET /javascripts/jquery.imagesloaded.min.js HTTP/1.1”304 - 0.0138
00:52:59 web.1 | 127.0.0.1 - - [01/Feb/2013 00:52:59] “GET /javascripts/jquery.masonry.min.js HTTP/1.1”304 - 0.0121
00:52:59 web.1 | 127.0.0.1 - - [01/Feb/2013 00:52:59] “GET /javascripts/jquery.capty.custom.js HTTP/1.1”304 - 0.0075
00:52:59 web.1 | 127.0.0.1 - - [01/Feb/2013 00:52:59] “GET /stylesheets/articles_grid.css HTTP/1.1”304 - 0.0131
00:52:59 web.1 | 127.0.0.1 - - [01/Feb/2013 00:52:59] “GET /javascripts/articles_grid.js HTTP/1.1”304 - 0.0008
00:53:05 web.1 | RuntimeError - 未设置下游应用程序：
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:688:in `forward'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:772:in `route_missing'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:719:in `route!'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:715:in `route!'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:715:in `route!'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:843:in `dispatch!'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:644:in `block in call!'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:808:in `instance_eval'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:808:in `block in invoke'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:808:in `catch'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:808:in `invoke'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:644:in `call!'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/base.rb:629:in `call'
00:53:05 web.1 | /home/blacktea/Projects/************************/app.rb:22:in `call'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.3.2/lib/rack/session/abstract/id.rb:195:in `context'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.3.2/lib/rack/session/abstract/id.rb:190:in `call'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.3.2/lib/rack/head.rb:9:in `call'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.3.2/lib/rack/commonlogger.rb:20:in `call'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/sinatra-1.2.6/lib/sinatra/showexceptions.rb:21:in `call'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.3.2/lib/rack/methodoverride.rb:24:in `call'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/connection.rb:84:in `block in pre_process'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/connection.rb:82:in `catch'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/connection.rb:82:in `pre_process'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/connection.rb:57:in `process'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/connection.rb:42:in `receive_data'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/backends/base.rb:61:in `start'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/server.rb:159:in `start'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/controllers/controller.rb:86:in `start'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/runner.rb:185:in `run_command'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/lib/thin/runner.rb:151:in `运行！
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/gems/thin-1.2.11/bin/thin:6:in `'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/bin/thin:19:in `load'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/bin/thin:19:in `'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'
00:53:05 web.1 | /home/blacktea/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `'
```

这是 layout.haml

```
！！！
%html
  ％头
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "content-type"}
      %title 项目
      %script{:src => "https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js", :type => "text/javascript"}
      %script{:src => "/javascripts/jquery.imagesloaded.min.js", :type => "text/javascript"}
      %script{:src => "/javascripts/jquery.masonry.min.js", :type => "text/javascript"}
      %script{:src => "/javascripts/jquery.capty.custom.js", :type => "text/javascript"}

      %link{:rel => :stylesheet, :href => "/stylesheets/articles_grid.css", :type => "text/css"}
      %script{:src => "/javascripts/articles_grid.js", :type => "text/javascript"}

  %body{:onload => "framesetsize(800, 1000)", :style => "overlflow: hidden;"}
    %script{:src => "http://connect.facebook.net/en_US/all.js", :type => "text/javascript"}
    :javascript
      FB.init({
        appId : '#{ @app['id'] }',
         饼干：真
       });
    =产量

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:06:39.527

似乎我的开发浏览器（Chrome）一直在请求 /favicon.ico

```
get "/favicon.ico" do
end 
```

解决了问题

# quickbooks - 使用 QBSDK 12 连接到 QB 13 会弹出 qb_utils.js 错误

> ID：14636808
> 
> 赞同：2
> 
> 时间：2013-01-31T23:06:41.920
> 
> 标签：quickbooks, intuit-partner-platform

QB 13.0 Enterprise 在我们的环境中引入了 QB 12.0 中不存在的问题。使用 QBSDK 12.0、qbXML 4.0 版、Windows Server 2008 R2 和在 python 2.7.3 中开发的解决方案。QB File Doctor 不会报告任何问题，并且所有 XML 都已由 QB XML Validator 成功验证。

我必须通过这篇文章来解决升级后的 LGB 文件损坏问题：[自动登录失败](http://community.intuit.com/posts/automatic-login-through-integrated-applications-fails)

我创建了一个测试 .Net 程序来复制问题，该问题发生在 BeginSession 和 EndSession 调用之间的随机点：

```
using QBXMLRP2Lib;
RequestProcessor2 proc = new RequestProcessor2();
proc.OpenConnection2("Test QB", "Test QB", QBXMLRPConnectionType.localQBD);
string ticket = proc.BeginSession("the path to the QB file", QBFileMode.qbFileOpenMultiUser);
proc.EndSession(ticket);
proc.CloseConnection(); 
```

弹出一个“脚本错误”对话框：行：46 字符：8 错误：未指定的错误。代码：0 网址：[https ://qbinproduct.intuit.com/ipd/common/js/qb_utils.js](https://qbinproduct.intuit.com/ipd/common/js/qb_utils.js)

以及是否继续运行脚本的标准两个选项。无论选择什么，QB 都会崩溃：

```
Problem signature:
    Problem Event Name: APPCRASH
    Application Name: qbw32.exe
    Application Version: 23.0.4005.2305
    Application Timestamp: 50d6cc51
    Fault Module Name: StackHash_5b31
    Fault Module Version: 6.1.7601.17725
    Fault Module Timestamp: 4ec49b8f
    Exception Code: c0000374
    Exception Offset: 000ce6c3
    OS Version: 6.1.7601.2.1.0.272.7
    Locale ID: 1033
    Additional Information 1: 5b31
    Additional Information 2: 5b3188f7410a3a5d99b8b3c79d62fc31
    Additional Information 3: 38e7
    Additional Information 4: 38e72e11a56a600df179c0b7bdb3159c 
```

我将不胜感激任何解决方案或建议。

# python-2.7 - AttributeError：“模块”对象没有属性“Unpickler”

> ID：14636819
> 
> 赞同：1
> 
> 时间：2013-01-31T23:07:53.497
> 
> 标签：python-2.7

我在 SciTE 文本编辑器中运行一个程序，它卡在 import scipy as sp 语句中。

```
import pylab as pl
import numpy as np
import scipy as sp
import scipy.integrate as spi
import scipy.optimize as spo
import numpy.random as nr
import matplotlib.pyplot as plt
print "check"
#parameters to be used
rs=0.14
ra=0.0027
js=-0.033
ja=0.81
Mz=91.0
Tz=2.5 
root_s=sp.linspace(20.,140.,200)  #plotting sigma_A and sigma_S functions against   centre of mass energies from 20GeV to 140 GeV
s=(root_s)**2
.....
..... 
```

我收到此错误消息：

```
>pythonw -u "collisions.py"
3.14159265359
1.0
Traceback (most recent call last):
  File "collisions.py", line 4, in <module>
    import scipy as sp
  File "C:\Python27\lib\site-packages\scipy\__init__.py", line 85, in <module>
    from numpy import oldnumeric
  File "C:\Python27\lib\site-packages\numpy\oldnumeric\__init__.py", line 14, in <module>
    from compat import *
  File "C:\Python27\lib\site-packages\numpy\oldnumeric\compat.py", line 106, in <module>
   class Unpickler(pickle.Unpickler):
AttributeError: 'module' object has no attribute 'Unpickler'
>Exit code: 1 
```

奇怪的是，我的代码在交互式 qtconsole 中运行良好。我是编程新手，在互联网的其他地方我还没有遇到过这样的问题。为什么返回值 pi 和 1.0 即使我的代码中没有应该这样做的地方？

# javascript - 带有闭包编译器的 AngularJS - 简单优化失败

> ID：14636822
> 
> 赞同：0
> 
> 时间：2013-01-31T23:07:59.083
> 
> 标签：javascript, angularjs

有人可以解释一下为什么简单的优化在 AngularJS 中对我来说失败了吗？更重要的是，我怎样才能让他们工作？（也欢迎定义控制器的最佳实践/澄清）。

这是我的场景，大大简化了。

我正在使用这个 HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html ng-app="">
  <head>
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/excite-bike/jquery-ui.css" type="text/css" rel="stylesheet" />

    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.4/angular.min.js" type="text/javascript"></script>
    <script src="simple_script.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js" type="text/javascript"></script>
    <script>
    //inline JS here
    $(function() {
        var spinner = $( "#qtySpinner" ).spinner({
            spin: function( event, ui ) {
                scope.qty = ui.value;
                scope.$digest();
                //console.log( event );
            }
        }); //end spinner

        var scope = angular.element(spinner).scope();
    });
    </script>
    <title>Angular Testing</title>
  </head>
  <body>
    <div ng-controller="InvoiceCntl">
      <b>Invoice:</b><br>
      <br>
      <table>
        <tr>
          <td>
            Quantity
          </td>
          <td>
            Cost
          </td>
        </tr>
        <tr>
          <td>
            <input id="qtySpinner" type="integer" min="0" ng-model="qty" required="">
          </td>
          <td>
            <input type="number" ng-model="cost" required="">
          </td>
        </tr>
      </table>
      <hr>
      <b>Total:</b> {{calculate(qty,cost)}}
    </div>
    <br>
  </body>
</html> 
```

我正在使用这个高度缩小的证明（我认为）JS文件作为“simple_script.js”，它实际上是这样工作的：

```
//this works
window["InvoiceCntl"] = function ($scope) {
   $scope["qty"] = 1;
   $scope["cost"] = 19.95;
   $scope["calculate"] = function (xval, yval) {
                            return xval * yval;
                         };
} 
```

使用带有 SIMPLE_OPTIMIZATIONS的 Google Closure Compiler ( [http://closure-compiler.appspot.com/home](http://closure-compiler.appspot.com/home) ) 进行缩小，我得到了这个，它打破了：

```
//this breaks, seemingly because "a" replaces "$scope"?
window.InvoiceCntl=function(a){a.qty=1;a.cost=19.95;a.calculate=function(a,b){return a*b}}; 
```

我认为这是因为`$scope`Angular 寻找的一个关键词（依赖注入？），因为当我手动添加额外的步骤，在函数的第一行传递`$scope`和分配它时`a`，它起作用了。像这样：

```
//manually passing "$scope" and immediately assigning it to "a" works
window.InvoiceCntl=function($scope){var a=$scope;a.qty=1;a.cost=19.95;a.calculate=function(a,b){return a*b}}; 
```

*   为什么`$scope`在这种情况下不像正常的函数参数？
*   有没有一种方法可以使用 Closure 编译器（或其他东西）来缩小（简单或高级）角度代码，而无需像这样的手动步骤？
*   是`$scope`可配置的还是固定的关键字，即，我可以在定义控制器时将关键字更改为“$myscope”吗？（不确定这对我有帮助）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:10:15.140

您应该阅读[http://docs.angularjs.org/tutorial/step_05](http://docs.angularjs.org/tutorial/step_05)

我认为您对注入 '$scope' 的担忧是正确的。你可以像下面这样注入。

```
var module = angular.module('youApp', []);
module.controller('yourCtrl', ['$scope', function($scope) {
   $scope["something"] = "somevalue";
})]; 
```

**编辑：**缩小重命名`$scope`，您可以通过添加来防止这种情况：

```
InvoiceCntl.$inject = ['$scope']; 
```

# regex - 用于包含字母数字和特殊字符的正则表达式

> ID：14636826
> 
> 赞同：29
> 
> 时间：2013-01-31T23:08:13.317
> 
> 标签：regex

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-31T23:09:10.897

You need to escape the hyphen:

```
"^[a-zA-Z0-9!@#$&()\\-`.+,/\"]*$" 
```

If you don't escape it then it means a range of characters, like `a-z`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T23:26:04.153

在您的字符类`)-'`中，与 eg 一样，它被解释为一个范围`a-z`，因此它指的是具有从 41`)`到 96的十进制 ASCII 代码的任何字符`'`。

由于`_`有代码 95，它在范围内，因此允许，如`<`,`=`等`>`。

为避免这种情况，您可以转义`-`, ie `\-`，或者将 放在`-`字符类的开头或结尾：

```
/^[a-zA-Z0-9!@#$&()`.+,/"-]*$/ 
```

无需转义`"`, 并注意因为您使用的是`*`量词，所以空字符串也将通过测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T23:11:42.827

字符类中的连字符表示一个范围，除非它们被转义或位于字符类的开头或结尾。如果您想包含连字符，通常最好将它们放在前面，这样您甚至不必担心转义：

```
^[-a-zA-Z0-9!@#$&()`.+,/\"]*$ 
```

顺便说一句，`_`确实介于`)`ASCII 和反引号之间：

[http://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters](http://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-26T14:05:34.073

使用此正则表达式，您允许所有字母数字和特殊字符。这`\w`是允许所有数字并`\s`允许空间

```
[><?@+'`~^%&\*\[\]\{\}.!#|\\\"$';,:;=/\(\),\-\w\s+]* 
```

允许的特殊字符是 `! @ # $ & ( ) - ‘ . / + , “ = { } [ ] ? / \ |`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-21T08:05:14.910

因为不知道有多少特殊字符，所以很难通过白名单来检查字符串是否包含特殊字符。检查字符串仅包含字母或数字可能更有效。

对于科特林示例

```
fun String.hasOnlyAlphabetOrNumber(): Boolean {
    val p = Pattern.compile("[^a-zA-Z0-9]")
    return !(p.matcher(this).matches())
} 
```

对于 swift4

```
func hasOnlyAlphabetOrNumber() -> Bool {
    if self.isEmpty { return false }
    do {
        let pattern = "[^a-zA-Z0-9]"
        let regex = try NSRegularExpression(pattern: pattern, options: .caseInsensitive)
        return regex.matches(in: self, options: [], range: NSRange(location: 0, length: self.count)).count == 0
    } catch {
        return false
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-03T16:42:38.440

这个怎么样..它允许特殊字符以及字母数字

```
"[-~]*$" 
```

# ruby-on-rails - Whenever rails gem not working with cronjob.. why?

> ID：14636829
> 
> 赞同：0
> 
> 时间：2013-01-31T23:08:24.987
> 
> 标签：ruby-on-rails, cron, crontab, whenever

I am using Whenever gem with rails. For some reason the first cronjob does not work. If i copy paste the command into the shell manually, it works as it should.

The second "touch testing123.txt" also works fine.

I have no idea why the GiftPackage.do_scheduled_deliveries rails method does not run. I'm really at a loss right now.. any help would be greatly appreciated!

```
# Begin Whenever generated tasks for: /var/www/mysite/releases/20130131200554/config/schedule.rb
*/1 * * * * /bin/bash -l -c 'cd /var/www/mysite/releases/20130131200554 && script/rails runner -e staging '\''GiftPackage.do_scheduled_deliveries'\'''
*/1 * * * * /bin/bash -l -c 'cd /var/www/mysite/releases/20130131200554 && touch testing123.txt'
# End Whenever generated tasks for: /var/www/mysite/releases/20130131200554/config/schedule.rb 
```

Thanks! :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:16:31.603

尝试在作业之前设置 PATH 变量，您的 cron 可能无法找到 ruby​​ ：

例如 ：

```
PATH=/usr/local/rvm/gems/ruby-1.9.3-p194/bin:/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin:/usr/local/rvm/rubies/ruby-1.9.3-p194/bin:/usr/local/rvm/bin:/usr/local/sbin:/usr/local/$
# Begin Whenever generated tasks for: /var/www/mysite/releases/20130131200554/config/schedule.rb
*/1 * * * * /bin/bash -l -c 'cd /var/www/mysite/releases/20130131200554 && script/rails runner -e staging '\''GiftPackage.do_scheduled_deliveries'\'''
*/1 * * * * /bin/bash -l -c 'cd /var/www/mysite/releases/20130131200554 && touch testing123.txt'
# End Whenever generated tasks for: /var/www/mysite/releases/20130131200554/config/schedule.rb 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T00:09:54.097

您很可能在应用程序本身内遇到错误。

第一步是，使用登台环境在控制台中运行任务。

其次是检查 cron 日志，看看它是否输出任何错误。

您可以通过将以下内容添加到 schedule.rb 文件来设置何时记录输出；

```
set :output, "/[path to log]/cron.log" 
```

这应该可以帮助您更接近找到解决方案。

# jquery - Jquery附加的输入按钮不适用于.on（点击）

> ID：14636834
> 
> 赞同：0
> 
> 时间：2013-01-31T23:08:43.283
> 
> 标签：jquery, append

我的代码的 jsFiddle：http: [//jsfiddle.net/8Vcyu/](http://jsfiddle.net/8Vcyu/)

我设置了一个表单，用户可以在其中输入 1 到 10 行信息。如果用户添加第 10 行 jquery 删除“添加行”按钮。如果删除第 10 行，则添加按钮会返回。这一切都很好，但是当“添加行”按钮被添加回页面时，它不再起作用 - 没有添加新行。非常感谢任何帮助，这个问题让我很困惑。

**HTML**

```
<form name="input" action="/engine/preview.php" enctype="multipart/form-data" id="customizeForm" method="post">
    <div id="customize_container">
        <div id="customize_right">
                <table class="customize_table">
                    <tr class="tr_clone">
                        <td>
                            <input type="text" name="title[]" value="NAME" maxlength="12" />
                        </td>
                        <td>
                            <input type="text" name="entry[]" value="Your Name" maxlength="20" />
                        </td>
                        <td>
                            <a href="#" class="closeRow"></a>
                        </td>
                    </tr>
                    <tr class="tr_clone">
                        <td>
                            <input type="text" name="title[]" value="NAME" maxlength="12" />
                        </td>
                        <td>
                            <input type="text" name="entry[]" value="Your NAME" maxlength="20" />
                        </td>
                        <td>
                            <a href="#" class="closeRow">remove</a>
                        </td>
                    </tr>
                    <tr class="tr_clone">
                        <td>
                            <input type="text" name="title[]" value="NAME" maxlength="12" />
                        </td>
                        <td>
                            <input type="text" name="entry[]" value="Your ID" maxlength="20" />
                        </td>
                        <td>
                            <a href="#" class="closeRow">remove</a>
                        </td>
                    </tr>
                    <tr class="tr_clone">
                        <td>
                            <input type="text" name="title[]" value="NAME" maxlength="12" />
                        </td>
                        <td>
                            <input type="text" name="entry[]" value="Your Account Name" maxlength="20" />
                        </td>
                        <td>
                            <a href="#" class="closeRow">remove</a>
                        </td>
                    </tr>
                    <tr class="tr_clone">
                        <td>
                            <input type="text" name="title[]" value="LABEL" maxlength="12" />
                        </td>
                        <td>
                            <input type="text" name="entry[]" value="Information" maxlength="20" />
                        </td>
                        <td>
                            <a href="#" class="closeRow">remove</a>
                        </td>
                    </tr>
                </table>
                <div id="add_row_button">
                    <input type="button" name="add" value="Add" class="tr_clone_add" />
                </div>
        </div>
        <div class="clear"></div>
        <input type="submit" value="Preview Your Card" class="preview_cards" />
    </div>
    </form> 
```

**JS**

```
function countRows() {
  return $(".customize_table tr").length;
}

$(".closeRow").on('click', function() {
    $(this).closest('tr').remove();
    var $rows = countRows();
    if($rows == 9) {
        $("#add_row_button").append("<input type='button' name='add' value='Add' class='tr_clone_ad' />");
    }
});

$("input.tr_clone_add").on('click', function() {
    var $rows  = countRows();
    if($rows <= 9) {
        var $tr    = $("table.customize_table tr:last-child");
        var $clone = $tr.clone( true );
        $tr.after($clone);
        $rows  = countRows();
        if($rows == 10) {
            $(".tr_clone_add").remove()
        }
    }
});

$(document).ready(function() {
    $("#customizeForm").ajaxForm({
        success: function(responseText){
            $.fancybox({
                'content' : responseText,
                'minWidth' : 800,
                'minHeight' : 600,
                'scrolling' : 'no',
                'type' : 'iframe',
            });
        }
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:14:42.703

您应该使用 on() 的委托方法 -

```
$('body').on('click', 'input.tr_clone_add', function(){... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:42:30.003

两件事：我创建了一个负责将按钮绑定到单击的函数，并将其添加到单击按钮`$(document).ready()`时`Remove`。

```
function bindAddButton()
{
    $("input.tr_clone_add").on('click', function() {
        var $rows  = countRows();
        if($rows <= 9) {
            var $tr    = $("table.customize_table tr:last-child");
            var $clone = $tr.clone( true );
            $tr.after($clone);
            $rows  = countRows();
            if($rows == 10) {
                $(".tr_clone_add").remove()
            }
        }
    });
} 
```

另外，我注意到当您重新添加按钮时，您的按钮的类名中缺少一个“d”：

```
$("#add_row_button").append("<input type='button' name='add' value='Add' class='tr_clone_ad' />"); 
```

这使代码失败。

这是一个JSFiddle：

[http://jsfiddle.net/8Vcyu/15/](http://jsfiddle.net/8Vcyu/15/)

# asp.net-mvc-3 - ASP.NET MVC 3 One-To-Many Can't Update Bridge Table

> ID：14636837
> 
> 赞同：4
> 
> 时间：2013-01-31T23:08:57.263
> 
> 标签：asp.net-mvc-3, entity-framework, ef-code-first, one-to-many

I've looked around for hours, but I can't seem to find a straight forward method for solving my problem.

Basically, I have a 1-to-many relationship, bridged with a table. My controller seems to handle the 'create' method perfectly, creating records within the '1' table and the bridging 'many' table.

However, the 'edit' method doesn't seem to modify/update the bridging table at all. Any thoughts on what I'm doing wrong, and why it differs from the 'create' approach?

For brevity, let's say I have the following model:

```
public class Incident
{
    [Key]
    public int IncidentID { get; set; }
    public string Title { get; set; }
    public virtual ICollection<IncidentResources> Resources{ get; set; }
} 
```

And an Resource model:

```
public class Resource
{
    [Key]
    public int ResourceID{ get; set; }
    public int Name { get; set; }
    ...OTHER FIELDS REMOVED FOR BREVITY...
} 
```

And I am bridging these two via a bridging table and model:

```
public class IncidentResource
{
    [Key]
    public int IncidentResourceID { get; set; }
    public int IncidentID { get; set; }
    public int ResourceID { get; set; }
    public virtual <Resource> Resource { get; set; }
} 
```

In my Controllers, I have the following code:

```
[HttpPost]
public ActionResult Create(Incident incident)
{
  //incident.Resources is returned as a valid object...
  if (ModelState.IsValid)
  {        
    db.Incidents.Add(incident);
    db.SaveChanges();
    return RedirectToAction("Index");
  }
  return View(incident);
} 
```

The above works perfectly! As I mentioned, the new Incident is inserted into the proper table, and all Resources assigned to the incident are added to the IncidentResources table.

However, the following code DOES NOT work this way for the edit...

```
[HttpPost]
public ActionResult Edit(Incident incident)
{
  if (ModelState.IsValid)
  {
    //THE USER CAN ADD ADDITIONAL RESOURCES
    foreach (IncidentResource r in incident.Resources)
    {
      r.IncidentID = incident.IncidentID;
    }
    db.Entry(incident).State = EntityState.Modified;
    db.SaveChanges();
    return RedirectToAction("Index");
  }
  return View(incident);
} 
```

Again, the above seemingly does nothing to the IncidentResources table. Records are not added, removed, or updated. I don't receive an error either. It just doesn't do anything.

Please note that I DO NOT want to just trash the bridge table data and reinsert. I will have 1-to-many relationships to that data that I do not want to orphan.

What am I not understanding about how this works?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:18:29.177

您需要附加在 EF 外部创建的实体实例，并让 EF 知道它已被修改。

尝试添加：

```
db.Incidents.Attach(incident); 
```

在你改变状态之前。在您的情况下，您的最后一个代码块应如下所示：

```
[HttpPost]
public ActionResult Edit(Incident incident)
{
  if (ModelState.IsValid)
  {
    //THE USER CAN ADD ADDITIONAL RESOURCES
    foreach (IncidentResource r in incident.Resources)
    {
      r.IncidentID = incident.IncidentID;
    }
    db.Incidents.Attach(incident);
    db.Entry(incident).State = EntityState.Modified;
    db.SaveChanges();
    return RedirectToAction("Index");
  }
  return View(incident);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T08:28:19.413

除非您在表单的隐藏字段中跟踪 IncidentID，否则我敢打赌问题源于它试图更新不存在的事件 (IncidentID:0)

这将取决于您的路线，但假设默认路线模式：

```
[HttpPost]
public ActionResult Edit(int id, Incident incident)
{
  incident.IncidentID = id;

  if (ModelState.IsValid)
  {
    //THE USER CAN ADD ADDITIONAL RESOURCES
    foreach (IncidentResource r in incident.Resources)
    {
      r.IncidentID = incident.IncidentID;
    }
    db.Entry(incident).State = EntityState.Modified;
    db.SaveChanges();
    return RedirectToAction("Index");
  }
  return View(incident);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T01:35:15.227

IncidentResource 对象中的 IncidentID 似乎没有作为外键映射到 Incident 表。尝试添加 ForeignKey 注释以将 IncidentID 显式设置为指向 Incident 的外键：

```
 [ForeignKey("Incident")]
    public int IncidentID { get; set; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T09:04:24.390

你不应该做以下

```
[HttpPost]
public ActionResult Edit(Incident incident)
{
  if (ModelState.IsValid)
  {
    //THE USER CAN ADD ADDITIONAL RESOURCES
    foreach (IncidentResource r in incident.Resources)
    {
      r.IncidentID = incident.IncidentID;
      db.Entry(r).State = EntityState.Modified;
    }
    db.SaveChanges();
    return RedirectToAction("Index");
  }
  return View(incident);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T17:22:02.317

如果可以，您可以尝试将 IncidentResource 表的外键 IncidentID 添加到主键中，以形成复合主键。我遇到了类似的问题，这对我有帮助。

我从其他几个 stackoverflow 问题中得到了解决方案。我的设置与这些不完全匹配，因为我使用 AutoMapper 和实体模型第一个工作单元方法，但在关系表上制作复合键解决了我的问题。

[是否可以从集合中删除子项并解决 SaveChanges 上的问题？](https://stackoverflow.com/questions/11033348/is-it-possible-to-remove-child-from-collection-and-resolve-issues-on-savechanges)

[识别关系和非识别关系有什么区别？](https://stackoverflow.com/questions/762937/whats-the-difference-between-identifying-and-non-identifying-relationships)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T20:39:36.927

我想知道，在您当前的代码中，Entity Framework 是否看到 Incident 对象根本没有更改，并且没有尝试查看是否有 IncidentResources 需要调整。

尝试在循环中添加以下行：

`db.Entry(r).State = EntityState.Modified;`

编辑：我应该补充一点，在写完这个答案之后，我正在观看 Julie Lerman 关于实体框架的演讲，她确实提到“修改后的状态不会通过图形级联”，这意味着上面的代码应该这样做为你。

# windows - 用于环境的 Lua 注册表？

> ID：14636839
> 
> 赞同：1
> 
> 时间：2013-01-31T23:08:59.837
> 
> 标签：windows, lua, registry

我正在尝试阅读 Windows 注册表以找出安装了哪些脚本环境以及在哪里可以使用独立的解释器可执行文件。

例如，当我做 python 时，我搜索了

HKEY_LOCAL_MACHINE/SOFTWARE/Python/PythonCore/InstallPath

这为我提供了环境的 python 可执行文件的安装路径，这使我可以找到我是否有 python 2.7、3 等以及这些 exes 的位置。

我正在为 Windows 的 Lua 寻找类似的东西。

我**必须**使用注册表进行此搜索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:25:03.223

尼科尔所说的。通过针对已知可执行文件列表扫描 PATH 会更好地为您服务（但即使这样也不能保证，因为我的许多本地安装不在 PATH 中）。不过，我认为有更好的机会找到那些不会在注册表中留下痕迹的脚本引擎。或者可能使用多种机制的组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T00:19:17.070

Lua 没有安装路径。Lua 没有*安装*。Lua 不像 Python，它的安装程序将所有内容放在一个特定的位置并设置注册表和`PATH`条目等。

独立解释器没有查询其位置的机制。如果你有兴趣学习 Lua 版本，可以随时查看`_VERSION`变量字段。但除此之外，不，没有做你想做的事的机制。

# xml - Run XSLT file directly in browser - Eclipse IDE

> ID：14636843
> 
> 赞同：0
> 
> 时间：2013-01-31T23:09:13.690
> 
> 标签：xml, eclipse, xslt

I am trying my first XSLT transformation. I wrote a simple XML file and a simple XSL file which lists elements in a table. I created the files using the eclipse IDE and the transformation was complete to XML. i.e. I got an out.xml file which contained the corresponding html code correctly. How can I run this file on the server to view the output of the html file on the browser instead?

Is there a way of specifying to the XSL file to open in the browser? maybe in the href part where I link the XML with the XSL?

I tried this:

```
<?xml-stylesheet type="text/xsl" href="http://8089/Transformations/BookStore.xsl"?> 
```

where 8089 is the port where I am running my tomcat server, Transformations is the name of the project and BookStore.xsl is the XSL stylesheet.

However after doing that, it's still opening in the file. Am I doing something wrong?

Thanks :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T23:35:51.217

如果 Tomcat 正在侦听端口 8089，则 URL 应该类似于

```
http://localhost:8089/Transformations/BookStore.xsl 
```

如果您知道两者的相对位置，通常使用相对 URI 从 XML 指向 XSLT 会更简单。

# c# - 在哪里解析数据

> ID：14636850
> 
> 赞同：0
> 
> 时间：2013-01-31T23:10:00.687
> 
> 标签：c#, sql

在以下场景中：

*   用 C# 编写的基于窗体的 Windows 应用程序
*   GUI 仅包含与接口相关的代码，但为功能逻辑实例化了一个类
*   从 SQL 存储和加载数据的 SQL 类
*   以与数据库兼容的格式存储数据的数据类

我想通过 sql 类加载数据并将其存储在数据类中。最好的方法是什么？

1.  功能类实例化一个 SQL 类，调用查询函数并使用构造函数将包含的值传递给新的数据类实例；
2.  SQL 类包含一个函数，该函数将查询转换为数据类，从而以正确的格式将数据返回给函数类；
3.  Data 类包含一个直接解析查询结果的方法，因此功能逻辑只需调用解析。

选项 1 似乎最适合这种结构。我在编写大型应用程序方面的经验相当有限，所以我想知道有更多经验的人对此有何看法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:30:42.987

有更多经验的人使用 ORM（[对象关系映射器](http://en.wikipedia.org/wiki/Object-relational_mapping)）为他们执行此操作。
或者可能编写一个[数据访问层](http://en.wikipedia.org/wiki/Data_access_layer)来封装数据库访问并将[数据传输对象传递](http://en.wikipedia.org/wiki/Data_transfer_object)给应用程序代码。

选项 1 感觉数据库正在渗入应用程序。关注点分离在大型应用程序中非常重要。
选项 2 听起来像是开始编写自己的数据访问层。
选项 3 将污染具有关系数据库结构知识的数据传输对象。

认真考虑拿起 ORM。
实体框架。冬眠。亚音速。大量的。小巧玲珑。有很多可供选择。最主要的是，这是一个已经被很多经验丰富的开发者多次解决的问题。您可以利用他们的学习并加快您的发展。

# iis - rsync --delay-updates on Cygwin doesn't work?

> ID：14636852
> 
> 赞同：2
> 
> 时间：2013-01-31T23:10:20.197
> 
> 标签：iis, cygwin, rsync

What I'm trying to do:

I want to launch files to a .NET based website. Any time the dlls change, Windows recycles the web app. When I rsync files over the app can recycle several times because of the delay instead of the preferred single time. This brings the site out of commission for a longer period of time.

How I tried to solve it:

I attempted to remedy this by using the --delay-updates, which is supposed to stage all of the file changes in temporary files before changing them over. This appeared to be exactly what I wanted, however, giving the --delay-updates argument does not appear to behave as advertised. There is no discernable difference in the output (with -vv), and the end behavior is identical (the app recycles multiple times rather than once).

I don't want to run Cygwin on all of the production machines for stability reasons, otherwise I could rsync to a local staging directory, and then perform a local rsync, which would be fast enough to be "atomic".

I'm running Cygwin 1.7.17, with rsync 3.0.9.

I came across atomic-rsync ([http://www.opensource.apple.com/source/rsync/rsync-40/rsync/support/atomic-rsync](http://www.opensource.apple.com/source/rsync/rsync-40/rsync/support/atomic-rsync)) which accomplishes this by rsyncing to a staging directory, renaming the existing directory, and then renaming the staging directory. Sadly this does not work in a Windows setting, because you cannot rename folders with running dll files in them (permission denied).

You are able to **remove** folders with running binaries, however this results in recycling the app every time, rather than just when there are updates to the dlls, which is worse.

Does anyone know how to either

1.  Verify that --delay-updates is actually working
2.  Accomplish my goal of updating all the files atomically (or rather, very very quickly)?

Thanks for the help.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T20:39:41.867

这很古老，但我最终发现 --delay-updates*实际上*按预期工作。由于其他因素，该应用程序似乎只是多次回收。

# asp.net - 过滤 ASP 健康监控事件

> ID：14636853
> 
> 赞同：0
> 
> 时间：2013-01-31T23:10:20.667
> 
> 标签：asp.net, iis, health-monitoring

我最近向我的站点添加了 ASP.NET 运行状况监控。现在它的设置只有一个规则：

```
<add name="Email Event Monitor" 
     eventName="Application Lifetime Events" 
     provider="MailWebEventProvider" 
     profile="Default" minInstances="1" 
     maxLimit="Infinite" minInterval="00:01:00" custom="" /> 
```

问题是我的网站使用 CMS，而且我经常收到“应用程序编译正在开始”的垃圾邮件。事件。如何过滤掉这些事件？

`eventName`此外，规则属性的可能值列表在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T22:09:25.307

我会将`eventName`“应用程序生命周期事件”更改为“所有错误”，这样您只会得到错误，而不是生命周期事件。

您可以`eventName`从您的根 web.config 文件（位于`%windir%\Microsoft.NET\Framework\framework_version\CONFIG`）中`<eventMappings>`的`<healthMonitoring>`.

# jquery - SharePoint JQuery 重定向 NewForm.aspx，具体取决于内容类型和开始时间

> ID：14636856
> 
> 赞同：0
> 
> 时间：2013-01-31T23:10:39.213
> 
> 标签：jquery, sharepoint, redirect, contenttype, dynamic-url

大家好，
我正在使用具有四种内容类型的 SharePoint 2007 日历。

1.  标准会议
2.  Skype 会议
3.  电话会议
4.  聊天会议

我正在使用 JQuery 1.4.2。

我正在尝试在日历页面上为提前不到 72 小时安排的 Skype 会议创建警报弹出窗口。如果在 URL 中传递了“SkypeError=1”，我会在日历页面中内置警报以显示。

现在我正在尝试让 Ne​​wForm.aspx 识别已选择 Skype 会议内容类型并显示错误。在 PreSaveAction 函数中，我有一个警报显示 ContentTypeId 正在被识别，另一个警报显示选择了哪个动态 URL。然后在 setOnSubmitRedir 函数中，我有一个警报，显示相同的 URL 已传递给它，另一个警报显示完整的 url 已针对提交按钮进行了修改。

在日历中添加 Satandard 会议时，一切正常。但是，如果我选择任何其他内容类型，则只有取消按钮有效。如果我按提交，我会得到通用的 MOSS2007“*发生意外错误。* ”考虑到我可以看到正确的信息正在传递，这很奇怪。另外，当我查看错误页面的 URL 时，我会在那里看到：
`https://myURL/myPortal/Lists/ConfRes/NewForm.aspx?RootFolder=%2fmyPortal%2fLists%2fConfRes&Source=/myPortal/Pages/MeetingCalendar.aspx?SkypeTime=yes`

我尝试从动态重定向中删除“ *?SkypeTime=yes ”，认为“* *?* ”可能会导致问题。
保存内容时，一切似乎都失败了。收到错误时永远不会保存内容。当我从页面中删除代码时，提交适用于所有内容类型。

非常感谢和需要帮助。任何有关如何测试从开始时间不到 72 小时内添加的事件的帮助也非常感谢。

代码是使用 CEWP 添加的。我没有服务器权限来启用更多可靠的错误或查看日志。

```
<script type="text/javascript" src="/94thaamdc/SiteCollectionCode/jquery-1.4.2.min.js">
//Load JQuery
</script>

<script type="text/javascript">
// Where to go when cancel is clicked on the form
goToWhenCanceled = '/myPortal/Pages/MeetingCalendar.aspx';
// Edit the redirect on the cancel-button's
$('.ms-ButtonHeightWidth[id$="GoBack"]').each(function(){
    $(this).click(function(){
            STSNavigate(goToWhenCanceled);
      })
});

// Function to determine the dynamic URL for the OnSubmit-redirect.
// This function is automatically executed before saving the item.
function PreSaveAction(){
// The URL is determined by the ContentTypeId located in the URL of the content type link.
// Grab the ContentTypeId from the content type link's URL and save it to a local
// variable called contentTypeId.
var contentTypeId = querySt("ContentTypeId");
// Assign a dynamic redirect URL to the function by setting it here
// based on contentTypeId from the URL.
    if(contentTypeId=='0x010...'){
        var dynamicRedirect = '/myPortal/Pages/MeetingCalendar.aspx?SkypeError=1';
    }else{
        var dynamicRedirect = '/myPortal/Pages/MeetingCalendar.aspx';
    }
    // Alerts are just to watch what's going on in the code. Remove when done testing.
    alert("1\. contentTypeId:  "+contentTypeId);
    alert("2\. dynamicRedirect:  "+dynamicRedirect);
    // Call the function and set the redirect URL in the form-action attribute
    setOnSubmitRedir(dynamicRedirect);
    // This function must return true for the save item to happen
    return true;
}

//Function to parse the ContentTypeId from the URL string
function querySt(stKey) {
    stQString = window.location.search.substring(1);
    arKeyValues = stQString.split("&");
    for (i = 0; i < arKeyValues.length; i++) {
        arPairs = arKeyValues[i].split("=");
        if (arPairs[0] == stKey) {
            return arPairs[1];
        }
    }
};

// Function to edit the form-action attribute to add the source=yourCustomRedirectPage
function setOnSubmitRedir(redirURL){
var action = $("#aspnetForm").attr('action');
var end = action.indexOf('&');
    if(action.indexOf('&')<0){
        newAction = action + "?Source=" + redirURL;
    }else{
        newAction = action.substring(0,end) + "&Source=" + redirURL;
    }
$("#aspnetForm").attr('action',newAction);
// Test to see if the URL was passed correctly. Remove when done testing.
alert("3\. redirURL:  "+redirURL);
// Test to see if the new URL is properly formatted. Remove when done testing.
alert("4\. newAction:  "+newAction);
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T02:56:32.453

由于我无法弄清楚为什么重定向不起作用，我选择了另一条不需要它的路径。不过，我仍然想知道最初的尝试有什么问题。我需要改进弹出的实际警告框，但下面的代码运行良好。该警告仅针对进入事件的人显示，并且每次他们进入日历时都会显示，直到他们在 72 小时前进入新事件。

```
<script type="text/javascript" language="javascript" src="/myPortal/jquery.1.4.2.min.js"></script>
<script type="text/javascript" language="javascript" src="/myPortal/jquery.SPServices-0.7.2.min.js"></script>
<script type="text/javascript" language="javascript">
/*
Name:           EventTimeLimit
Developer:      RogueVeggie
Version - Date: v1 - 20130207

Purpose:        Test if a Skype meeting has been added less than 72 hours prior to 
                the actual meeting time in a SharePoint Calendar.
                A warning displays if this is the last event entered by the user.

Prerequisite:   Create a Content Type called "Skype Meeting".
                In the SharePoint calendar Create a Calculated column called Skype72hrTest.
                Paste the following script into it:

                IF([Content Type]="Skype Meeting",IF([Sit Down Time]-Created>=3,"Pass","Fail"),"NA")

                Add this code to a Content Editor Web Part at the bottom of your SharePoint 
                Calendar page.
                Set the web part Chrome to "None".
                Don't hide the web part or the warning won't display.
*/

var taskListName = "MYGUID12-3456-7890-ASDF-GHJKLZXCVBNM" // This is the GUID of the list we want to query.
var lastId = $().SPServices.SPGetLastItemId({ 
    listName: taskListName 
}); // This gets the ID of the last event added by the current user.
var testQuery = "<Query><Where><Eq><FieldRef Name='ID' /><Value Type='Text'>"+lastId+"</Value></Eq></Where></Query>"; // This is our CAML Query string.
var divWarn = "<DIV style='Z-INDEX: 999; POSITION: absolute; PADDING-BOTTOM: 25px; BACKGROUND-COLOR: #800505; PADDING-LEFT: 25px; WIDTH: 743px; PADDING-RIGHT: 25px; HEIGHT: 175px; COLOR: white; FONT-SIZE: 150%; TOP: 55%; FONT-WEIGHT: 900; PADDING-TOP: 25px; LEFT: 22.38%' id='VTCWarn'><DIV style='FONT-SIZE: 200%'>WARNING:</DIV><DIV>Skype scheduling requires 72 hour notice to register.<BR>Please contact IT.</DIV></DIV>";//This is the warning message

$(document).ready(function() {
  $().SPServices({
    operation: "GetListItems",
    async: false,
    listName: taskListName ,
   CAMLRowLimit: 1,
    CAMLQuery: testQuery,
    CAMLViewFields: "<ViewFields><FieldRef Name='Skype72hrTest' /></ViewFields>",// Skype72hrTest is a calculated column in the calendar to test if the event was added less than 72 hours before the Skype meeting.
    completefunc: function (xData, Status) {
        $(xData.responseXML).SPFilterNode("z:row").each(function() {
            var passFail = $(this).attr("ows_Skype72hrTest");// Skype72hrTest stores the result in a string as "Pass", "Fail", or "NA".

            if (passFail === "string;#Fail"){// Tests to see if the string Fail is in the Skype72hrTest column
                $("#Warning").append(divWarn);
            }
        });
    }
  });
});
// The below DIV is needed so we have a place to put the warning when passFail=Fail.
</script>
<div id='Warning'></div> 
```

# php - PHP：如何在 php 中获取动态生成的图像的字节大小？

> ID：14636857
> 
> 赞同：4
> 
> 时间：2013-01-31T23:11:04.283
> 
> 标签：php, size, filesize

> **可能重复：**
> [如何使用 PHP 和 GD 获取图像资源大小（以字节为单位）？](https://stackoverflow.com/questions/4023441/how-to-get-image-resource-size-in-bytes-with-php-and-gd)

是否可以使用 php 获取对象 $image 的文件大小（不是图像大小尺寸）？我想将此添加到我的“Content-Length：”标题中。

```
$image = imagecreatefromjpeg($reqFilename); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:13:07.683

您可以为此使用[filesize()](http://php.net/manual/en/function.filesize.php)：

```
 // returns the size in bytes of the file
 $size = filesize($reqFilename); 
```

当然，只有在调整大小的图像是存储在磁盘上的图像时，如果您在调用后调整图像大小，则上述内容当然有效，`imagecreatefromjpeg()`那么您应该使用@One Trick Ponys 解决方案并执行以下操作：

```
 // load original image
  $image = imagecreatefromjpeg($filename);
  // resize image
  $new_image = imagecreatetruecolor($new_width, $new_height);
  imagecopyresampled($new_image, $image, 0, 0, 0, 0, $new_width, $new_height, $width, $height);
  // get size of resized image
  ob_start();
  // put output for image in buffer
  imagejpeg($new_image);
  // get size of output
  $size = ob_get_length();
  // set correct header
  header("Content-Length: " . $size);
  // flush the buffer, actually send the output to the browser
  ob_end_flush();
  // destroy resources
  imagedestroy($new_image);
  imagedestroy($image); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T23:19:26.637

我认为这应该有效：

```
$img = imagecreatefromjpeg($reqFilename);

// capture output
ob_start();

// send image to the output buffer
imagejpeg($img);

// get the size of the o.b. and set your header
$size = ob_get_length();
header("Content-Length: " . $size);

// send it to the screen
ob_end_flush(); 
```

# c# - 最新 Twitter API 1.1 的 Twitterizer 版本

> ID：14636861
> 
> 赞同：4
> 
> 时间：2013-01-31T23:11:25.093
> 
> 标签：c#, c#-4.0, twitter, twitterizer

对于使用 Twitterizer 作为组件与 Twitter API 进行通信的人，我有一个问题。

我看到 Twitter 网站最近更新到 API 版本 1.1

我有一个使用 Twitterizer 版本 1 构建的应用程序。

请让我知道 Twitterizer 是否已更新其组件以与新的 Twitter API 1.1 兼容

我看到 Twitterizer 有两个更新版本，版本 2.4.2 和版本 3..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T23:31:53.833

简要浏览 twitterizer 提供的源代码表明他们的 API 目标尚未更新。

对此提出质疑的代码行`Twitterizer/Twitterizer2/Core/OptionalProperties.cs`位于[https://github.com/Twitterizer/Twitterizer](https://github.com/Twitterizer/Twitterizer)从第 50 行开始。这是一个片段。

```
 public OptionalProperties()
    {
        // Set the default values for the properties
        this.UseSSL = false;
        this.APIBaseAddress = "http://api.twitter.com/1/";
    } 
```

有相当多的源代码看起来需要针对 v1.1 进行检查，但是您可以尝试构建库，并将`APIBaseAddress`符号中的版本号从更改`/1/`为`/1.1/`以查看哪些中断，并可能发送拉取请求如果您愿意，请提供更新。

[1.1 的 REST API 方法的完整列表在这里。(@dev.twitter.com)](https://dev.twitter.com/docs/api/1.1)

脚注：[Twitterizer3 也具有相同的基本端点 URL。(@github)](https://github.com/Twitterizer/Twitterizer3/blob/master/Twitterizer/Core/OptionalProperties.cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T09:24:48.933

支持 Twitter REST API 1.1 的 Twitterizer 更新版本已通过 BitBucket 提供，源代码可从此处下载：

[https://bitbucket.org/szrsharp/twitterizer-remaked-for-api-1.1/overview](https://bitbucket.org/szrsharp/twitterizer-remaked-for-api-1.1/overview)

我构建了 Twitterizer2 解决方案并将输出 DLL 复制到我的项目中，Twitter 帖子又可以正常工作了。

[Code Project](http://www.codeproject.com/Tips/580151/Twitterizer-for-API-v1-1)上有关于这个更新项目的更多信息，作者在底部回复了一些评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-12T17:57:45.347

Rob Willis 的回答似乎不再奏效了。由于我遇到了同样的问题（在旧的 .NET 3.5 应用程序中使用 Twitterizer），我切换到 TweetSharp，它是唯一可用于支持 Twitter API 1.1 的 .NET 3.5（以及 2.0）的库。

有关更多信息，您可以[在此处阅读我的回答](https://stackoverflow.com/a/27449299/1233379)。

我个人可以保证它可以工作，因为我在一个旧的 3.5 项目中使用了它并且我设法使它工作（实际上它拯救了我的一天）。

# vba - 使用选项卡名称作为 VBA 的工作簿名称

> ID：14636864
> 
> 赞同：0
> 
> 时间：2013-01-31T23:12:03.697
> 
> 标签：vba, excel

我对 VBA 完全陌生，我需要一些关于我在 Microsoft Office 中找到的以下 VBA 代码的帮助（我目前使用的是 Excel 2007）。我想知道如何做三件事：

1.  创建一个在单击时运行代码的按钮。
2.  *使用活动工作表*的名称保存临时工作簿文件，而不是源工作簿的名称。
3.  选择 K 列中的所有电子邮件地址，并将它们作为在下面的代码中创建的电子邮件的收件人插入。

有人可以帮我解决这个问题吗？

```
Sub Mail_ActiveSheet()

    Dim FileExtStr As String
    Dim FileFormatNum As Long
    Dim Sourcewb As Workbook
    Dim Destwb As Workbook
    Dim TempFilePath As String
    Dim TempFileName As String
    Dim OutApp As Object
    Dim OutMail As Object

    With Application
        .ScreenUpdating = False
        .EnableEvents = False
    End With

    Set Sourcewb = ActiveWorkbook
        ActiveSheet.Copy
    Set Destwb = ActiveWorkbook

    ' Determine the Excel version, and file extension and format.
    With Destwb
            If Sourcewb.Name = .Name Then
                With Application
                    .ScreenUpdating = True
                    .EnableEvents = True
                End With
                MsgBox "You answered NO in the security dialog."
                Exit Sub
            Else
                Select Case Sourcewb.FileFormat
                Case 51: FileExtStr = ".xlsx": FileFormatNum = 51
                Case 52:
                    If .HasVBProject Then
                        FileExtStr = ".xlsm": FileFormatNum = 52
                    Else
                        FileExtStr = ".xlsx": FileFormatNum = 51
                    End If
                Case 56: FileExtStr = ".xls": FileFormatNum = 56
                Case Else: FileExtStr = ".xlsb": FileFormatNum = 50
                End Select
            End If
    End With

    ' You can use the following statements to change all cells in the
   ' worksheet to values.
    '    With Destwb.Sheets(1).UsedRange
    '        .Cells.Copy
    '        .Cells.PasteSpecial xlPasteValues
    '        .Cells(1).Select
    '    End With
    '    Application.CutCopyMode = False

    ' Save the new workbook, mail, and then delete it.
    TempFilePath = Environ$("temp") & "\"
    TempFileName = " " & Sourcewb.Name & " " _
                 & Format(Now, "dd-mmm-yy h-mm-ss")

    Set OutApp = CreateObject("Outlook.Application")

    Set OutMail = OutApp.CreateItem(0)

    With Destwb
        .SaveAs TempFilePath & TempFileName & FileExtStr, _
                FileFormat:=FileFormatNum
        On Error Resume Next
       ' Change the mail address and subject in the macro before
       ' running the procedure.
        With OutMail
            .To = "laragon2@its.jnj.com"
            .CC = ""
            .BCC = ""
            .Subject = "test"
            .Body = "test"
            .Attachments.Add Destwb.FullName
            .Display
        End With
        On Error GoTo 0
        .Close SaveChanges:=False
    End With

    Set OutMail = Nothing
    Set OutApp = Nothing

    With Application
        .ScreenUpdating = True
        .EnableEvents = True
    End With
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T03:15:37.847

对于 1\. 您可以在`Developer`Tab--> `Controls`Group -->下创建一个按钮`insert`，找到一个按钮并将现有宏分配给它。

对于 2\. 改变`sourcewb.name`-->`activeSheet.name`

对于 3。（假设 K 列，每个单元格中的每个单元格都包含一个有效的电子邮件地址）

**编辑**您可以将下面的代码放在该行之后：

`Set Sourcewb = ActiveWorkbook`

* * *

```
Dim recipients As String
Dim i As Long
Dim height as long

With ActiveSheet
    .Activate
    Height = .Cells(.Rows.Count, 11).End(xlUp).Row ' column k
    For i = 1 To Height
        If .Cells(i, 11).Value <> "" Then 'if that cell contains ONE email address
            recipients = recipients & ";" & .Cells(i, 11).Value 'append it
        End If

    Next i
    If Len(recipients) > 0 Then 'remove the first dummy ";"
        recipients = Mid(recipients, 2)
    End If

End With 
```

并更换

```
With OutMail
            .To = "laragon2@its.jnj.com" 
```

经过

```
With OutMail
            .To = recipients 
```

**编辑 2** : To 从`.cells(i,11)`to更改`.cells(i,7)`为所有`11`

在 VBA`cells(ROW,COLUMN)`中使用语法。

A = 1

B = 2

...

G = 7

K = 第 11 列，依此类推

您也可以使用下面的代码替换原始零件

```
Dim recipients As String
Dim i As Long
Dim height As Long
Dim colNum As Long

With ActiveSheet
    .Activate
    colNum = .Columns("K").Column ' You can replace K to G <~~~~ Changes here
    height = .Cells(.Rows.Count, colNum).End(xlUp).Row   '<~~~~ Changes here
    For i = 1 To height
        If .Cells(i, 11).Value <> "" Then 'if that cell contains ONE email address
            recipients = recipients & ";" & .Cells(i, colNum).Value 'append it   '<~~~~ Changes here
        End If

    Next i
    If Len(recipients) > 0 Then 'remove the first dummy ";"
        recipients = Mid(recipients, 2)
    End If

End With 
```

# java - Java ExecutorService 性能

> ID：14636867
> 
> 赞同：1
> 
> 时间：2013-01-31T23:12:25.763
> 
> 标签：java, multithreading, performance, executorservice

您好我已经实现了一种从数百万个元素（整数）的数组中计算模式值的方法。我现在将顺序版本与使用执行器服务的（应该是）改进版本进行比较......不幸的是，性能不如预期：

```
Sequentiallly iterating hashMap (version 0)

#size   #time       #memory
10000000    13772ms     565mb
20000000    35355ms     1135mb
30000000    45879ms     1633mb

Assigning jobs to a Service Executor (version 2)
#size   #time       #memory
10000000    16186ms     573mb
20000000    34561ms     1147mb
30000000    54792ms     1719mb 
```

Executor Service 的代码如下：

```
 /* Optimised-Threaded Method to calculate the Mode */
    private int getModeOptimisedThread(int[] mybigarray){
        System.out.println("calculating mode (optimised w/ ExecutorService)... ");

        int mode = -1;

        //create an hashmap to calculating the frequencies        
        TreeMap<Integer, Integer> treemap = new TreeMap<Integer, Integer>();

        //for each integer in the array, we put an entry into the hashmap with the 'array value' as a 'key' and frecuency as 'value'.
        for (int i : mybigarray) {
            //we check if that element already exists in the Hashmap, by getting the element with Key 'i'
            // if the element exists, we increment the frequency, otherwise we insert it with frecuency = 1;
            Integer frequency = treemap.get(i);
            int value = 0;
            if (frequency == null){ //element not found
                value = 1;
            }
            else{                   //element found
                value = frequency + 1;
            }

            //insert the element into the hashmap
            treemap.put(i, value);
        }

        //Look for the most frequent element in the Hashmap        
        int maxCount = 0;

        int n_threads = Runtime.getRuntime().availableProcessors();
        ExecutorService es = Executors.newFixedThreadPool(n_threads);

        //create a common variable to store maxCount and mode values
        Result r = new Result(mode, maxCount);

        //set the umber of jobs
        int num_jobs = 10;
        int job_size = treemap.size()/num_jobs;        

        System.out.println("Map size "+treemap.size());
        System.out.println("Job size "+job_size);

        //new MapWorker(map, 0, halfmapsize, r);
        int start_index, finish_index;

        List<Callable<Object>> todolist = new ArrayList<Callable<Object>>(num_jobs);

        //assign threads to pool

            for (int i=0; i<num_jobs; i++)
            {   
                    start_index=i*job_size;
                    finish_index = start_index+job_size;

                    System.out.println("start index: "+start_index+". Finish index: "+finish_index);
                    todolist.add(Executors.callable(new MapWorker(treemap.subMap(start_index, finish_index), r)));

            }        
       try{
           //invoke all will not return until all the tasks are completed
           es.invokeAll(todolist);
        } catch (Exception e) { 
            System.out.println("Error in the Service executor "+e);
        } finally {
           //finally the result
            mode = r.getMode(); 
        }

        //return the result
        return mode;
    } 
```

关于 Executor Service 代码质量的任何建议？请建议，这是我第一次实现ES

编辑：

Worker 公共类 MapWorker 实现 Runnable{

```
 private int index;
    private int size;
    private int maxCount;
    private Result result;
    private  Map <Integer, Integer> map;

    //Constructor    
    MapWorker( Map <Integer, Integer> _map, Result _result){        
        this.maxCount = 0;
        this.result = _result;
        map = _map;
    }

    public void run(){               
        for (Map.Entry<Integer, Integer> element : map.entrySet()) {
            if (element.getValue() > result.getCount()) {                
                 result.setNewMode(element.getKey(),element.getValue());                 
            }
        }         
    }

} 
```

和结果类：

```
public class Result {
    private int mode;
    private int maxCount;

    Result(int _mode, int _maxcount){
        mode = _mode;
        maxCount = _maxcount;
    }

    public synchronized void setNewMode(int _newmode, int _maxcount) {
        this.mode = _newmode;
        this.maxCount = _maxcount;
    }

    public int getMode() {
        return mode;
    }

    public synchronized int getCount() {
        return maxCount;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T02:49:44.730

1.  对于每个作业，使用单独的 Result 对象（不同步）。当所有作业完成后，选择具有最大值的结果。

2.  `int num_jobs = n_threads;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T22:14:38.747

计算频率时正在完成大部分工作。这将显着支配您通过尝试更新结果获得的并行性的任何好处。在最后更新全局频率之前，您需要在本地计算频率的每个工作人员对模式的计算进行并行化。您可以考虑使用[AtomicInteger](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html)将模式存储在全局存储中以确保线程安全。计算完频率后，您可以在最后按顺序计算模式，因为按顺序遍历地图的计算成本要低得多。

像下面这样的东西应该会更好： 编辑：修改了 updateScore() 方法来修复数据竞争。

```
    私有静态类 ResultStore {

 `private Map<Integer, AtomicInteger> store = new ConcurrentHashMap<Integer, AtomicInteger>();

    public int size() {
        return store.size();
    }

    public int updateScore(int key, int freq) {
        AtomicInteger value = store.get(key);
        if (value == null) {
            store.putIfAbsent(key, new AtomicInteger(0));
            value = store.get(key);
        }
        return value.addAndGet(freq);
    }

    public int getMode() {
        int mode = 0;
        int modeFreq = 0;
        for (Integer key : store.keySet()) {
            int value = store.get(key).intValue();
            if (modeFreq < value) {
                modeFreq = value;
                mode = key;
            }
        }
        return mode;
    }
}

private static int computeMode(final int[] mybigarray) {

    int n_threads = Runtime.getRuntime().availableProcessors();
    ExecutorService es = Executors.newFixedThreadPool(n_threads);
    final ResultStore rs = new ResultStore();

    //set the number of jobs
    int num_jobs = 10;
    int job_size = mybigarray.length / num_jobs;

    System.out.println("Map size " + mybigarray.length);
    System.out.println("Job size " + job_size);

    List<Callable<Object>> todolist = new ArrayList<Callable<Object>>(num_jobs);
    for (int i = 0; i < num_jobs; i++) {
        final int start_index = i * job_size;
        final int finish_index = start_index + job_size;

        System.out.println("Start index: " + start_index + ". Finish index: " + finish_index);

        todolist.add(Executors.callable(new Runnable() {
            @Override
            public void run() {
                final Map<Integer, Integer> localStore = new HashMap<Integer, Integer>();
                for (int i = start_index; i < finish_index; i++) {
                    final Integer loopKey = mybigarray[i];
                    Integer loopValue = localStore.get(loopKey);
                    if (loopValue == null) {
                        localStore.put(loopKey, 1);
                    } else {
                        localStore.put(loopKey, loopValue + 1);
                    }
                }
                for (Integer loopKey : localStore.keySet()) {
                    final Integer loopValue = localStore.get(loopKey);
                    rs.updateScore(loopKey, loopValue);
                }
            }
        }));

    }
    try {
        //invoke all will not return until all the tasks are completed
        es.invokeAll(todolist);
    } catch (Exception e) {
        System.out.println("Error in the Service executor " + e);
    }

    return rs.getMode();
}` 

```

# function - 使用执行 (plpgsql) 创建函数

> ID：14636869
> 
> 赞同：1
> 
> 时间：2013-01-31T23:12:29.650
> 
> 标签：function, postgresql, select, primary-key, execute

我想创建一个函数，根据表名返回主键的下一个值：

```
CREATE OR REPLACE FUNCTION next_pk (_table varchar) RETURNS INTEGER AS $$
    BEGIN
        RETURN EXECUTE 'SELECT COALESCE (MAX (primary_key), 0) + 1 FROM ' || quote_ident (_table) || ' limit 1';
    END;
$$ LANGUAGE plpgsql;

select next_pk ('myTable'); 
```

但它给出了以下错误：

```
ERROR:  type "execute" does not exist
LINE 1: SELECT EXECUTE 'SELECT COALESCE (MAX (primary_key), 0) + 1 F... 
```

有什么线索吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:28:02.843

您需要整数变量并“执行”：

```
CREATE OR REPLACE FUNCTION next_pk (_table varchar) RETURNS INTEGER AS $$
DECLARE
    result integer;    
BEGIN  
    EXECUTE 
        'SELECT COALESCE (MAX (primary_key), 0) + 1 FROM ' || quote_ident (_table) 
        INTO result;
    RETURN result;
END;
$$ LANGUAGE plpgsql;

select next_pk ('myTable'); 
```

# regex - . （点）正则表达式

> ID：14636870
> 
> 赞同：2
> 
> 时间：2013-01-31T23:12:32.717
> 
> 标签：regex, notepad++, delimiter

我想在 .txt 文件中添加分隔符。每行有相同数量的字符；我知道分裂应该发生在哪里。

例如，

我的名字是哈利

我想将文件转换为如下所示：

我的|姓名|是|哈利

我在**notepad++ 上使用正则表达式**，我可以这样做： (..)(..)(..)(.....)

替换为 \1|\2|\3|\4

有没有更有效的方法可以编写这个**正则表达式**？我是否必须使用 100“。” （点）如果分成 100 个字符？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:15:48.843

[http://www.regular-expressions.info/reference.html](http://www.regular-expressions.info/reference.html)为您服务！

`(.{100})`如果您期望正好 100，则可以使用。

如参考文献中所述：

`{n} where n is an integer >= 1` 准确地重复上一个项目 n 次。示例：a{3} 匹配 aaa

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:53:23.363

如果文本与您的示例格式相同，您可以使用：

```
 Find what : ([a-z])([A-Z]) 
Replace with : \1|\2 
```

确保检查**大小写匹配**和**正则表达式**

**全部替换**

# iis-7 - PHP 大文件上传（再次）

> ID：14636872
> 
> 赞同：0
> 
> 时间：2013-01-31T23:12:40.907
> 
> 标签：iis-7, upload, php, large-files

首先对另一个相同的问题感到抱歉（我知道这个问题的无数次迭代），但我完全被这个问题所困扰，整天都在寻找答案（以及在这里检查所有以前的线程）。

所以我试图通过 PHP 上传大（ish）文件。该脚本在 8-10Mb 标记左右的文件处失败（适用于高达 7.5Mb 的文件，在 10Mb 处失败）。它只返回一个空文件数组，即：

```
print_r($_FILES)
= array( ) 
```

我在 Windows 2008 R2 操作系统上使用 Plesk 10 运行 IIS7。这是我的表格：

```
<form enctype="multipart/form-data" action="upload.php" method="POST">
  <input type="hidden" name="MAX_FILE_SIZE" value="200000000">
  <input name="Filedata" type="file" />
<input type="submit" value="Upload File" class="button" />
</form> 
```

一些相关的 php.ini 变量：

```
max_execution_time: 240
max_input_time: 360
post_max_size: 1600M
upload_max_filesize: 800M
memory_limit 1600M 
```

我的 web.config 有这个：

```
<security>
  <requestFiltering>
    <requestLimits maxAllowedContentLength="200000000"/>
  </requestFiltering>
</security> 
```

我知道正在收听 php.ini，因为 php_info() 将它们报告为（也 ini_get('...') 也将它们报告为正确的。顺便说一下，它们是“本地”值，“主人的要低得多（但我假设如果 php_info() 报告本地的，那么它们就是正在使用的）。我在我的脚本中放入了一些调试代码：

```
echo ini_get('post_max_size') . "<br />";
echo ini_get('upload_max_filesize') . "<br />";
echo $_SERVER['CONTENT_LENGTH'] . "<br />"; 
```

这呼应了：

```
1600M
800M
10424520 
```

最后一个是以字节为单位的 10Mb（ish）文件大小（我假设）。所以我的问题是，我在这里缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T00:45:15.850

所以我终于在这里找到了答案，并认为它可能对未来的一些灵魂有所帮助。

事实证明，虽然 Plesk 允许您覆盖“本地”php 设置，但实际上并没有监听更改，并且正在监听 php.ini 中的“主”值，而本地的则没有.

这里有更多信息： [PHP post_max_size local value overridden by master value on Plesk / IIS?](https://stackoverflow.com/questions/11730198/php-post-max-size-local-value-overridden-by-master-value-on-plesk-iis)

为了解决这个问题，我根据需要通过更改默认的 plesk php.ini 来更改主值。phpinfo() 报告我需要的 post_max_size 现在在本地和主服务器中都是 800M，它可以根据需要工作。

# nservicebus - 为什么 NServiceBus.NHibernate 会导致有关 Common.Logging 参考的 CodeAnalysis 警告？

> ID：14636873
> 
> 赞同：1
> 
> 时间：2013-01-31T23:12:44.230
> 
> 标签：nservicebus, common.logging

我有一个配置为 UseNHibernateTimeoutPersister 的 NServiceBus 端点。

我使用 EL 5 进行日志记录：

```
<section name="loggingConfiguration"  type="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.LoggingSettings, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/> 
```

我还在项目中添加了对 NServiceBus.Core 的引用。

为什么我会收到以下 CodeAnalysis 警告：

警告 36 CA0060：找不到间接引用的程序集“Common.Logging，Version=2.0.0.0，Culture=neutral，PublicKeyToken=af08829b84f0328e”。分析不需要此组件，但分析结果可能不完整。此程序集由：c:\NServicebus3.3.2\NServiceBus.NHibernate.dll 引用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:35:26.073

您需要添加对 Common.Logging v2 的引用，您可以使用以下命令从 nuget 获取该引用：

```
PM> Install-Package Common.Logging -Version 2.0 
```

# php - Drupal 7 Form API - 自定义选择主题

> ID：14636875
> 
> 赞同：0
> 
> 时间：2013-01-31T23:13:00.683
> 
> 标签：php, drupal, drupal-7, form-api

我整天都在搜索，但找不到任何答案——我确信我做得对，在 Drupal 6 中运行良好，并且在 Drupal 7 中应该运行良好。

我想为表单中的选择元素提供自定义主题功能

`$form['field_name'] = array(
'#type' => 'select',
'#title' => t('Title Here'),
'#theme' => 'custom_select',
'#options' => $values,
);`

我有权声明新的自定义主题函数，但我的问题是当使用上面的自定义主题函数时，我得到一个空的 $variables 数组，它只是读取

`Array([element] => null)`

谁能看到我可能做错了什么？清除缓存，完成了我能想到的一切 - 为什么 Drupal 没有将元素数据传递给主题函数？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T10:44:00.123

好吧，终于解决了这个问题，以防万一其他人有问题-确保在 hook_theme 中设置渲染元素而不是变量！

前

`function hook_theme(){`

`return array(
'select_currency' => array(
'variables' => array('element' => null),
'file' => 'module_name.theme.inc',
));

}`

后

`function hook_theme(){`

`return array(
'select_currency' => array(
'render element' => 'element',
'file' => 'module_name.theme.inc',
));

}`

我一直在拔头发，直到我想起渲染元素！

# angularjs - 不使用 ng-repeat 的数组指令

> ID：14636880
> 
> 赞同：0
> 
> 时间：2013-01-31T23:13:32.823
> 
> 标签：angularjs, angularjs-directive, ng-repeat

我再次偶然发现性能缓慢，`ng-repeat`并且无法弄清楚如何构建一个指令，该指令将在不使用`ng-repeat`任何地方（甚至在模板中）的情况下呈现元素数组

那么，你们是怎么做到的呢？

即使我遍历数组，对每个元素都使用模板：

```
.directive('foo', function($parse, $compile) {
    return {
        restrict: 'E',
          scope: { items: '=myarray' },
            link: function (scope, element, attrs){
                 var tmplt = '<div> {{name}} </div>';
                 scope.items.forEach(function(){
                     element.append(tmplt(scope)); 
                     // now I'd like to have a scope of that element, 
                     // and pass it into the template, and use properties related 
                     // only to that element
                     // but I don't know how to get a scope for a child element
                  });

             scope.$watch(attrs.myarray, function(value) { console.log('something change'); })

            }
        }}); 
```

如果我选择为所有元素使用一个模板，那么我别无选择，只能`ng-repeat`在其中使用它，它将创建 ngRepeatWatchers 并且一切都会再次变慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T08:53:48.300

虽然我同意@Mark，但这是您问题的肮脏解决方案：

[http://plnkr.co/edit/wxM8mSoNsRGXBJUao5Xb?p=preview](http://plnkr.co/edit/wxM8mSoNsRGXBJUao5Xb?p=preview)

这个想法是创建孤立的子范围：

```
 scope.items.forEach(function(item){                     
                 var childScope = scope.$new(true);                     
                 angular.extend(childScope, item);
                 element.append($compile(tmplt)(childScope)); 
              }); 
```

并且不要忘记在每次刷新时删除这些子范围。

并且需要对该解决方案进行基准测试，以查看它是否更快以及与 ngRepeat 相比多少。

# java - 在 ftp 协议中通过套接字传输文件

> ID：14636881
> 
> 赞同：0
> 
> 时间：2013-01-31T23:13:36.247
> 
> 标签：java, sockets, ftp, serversocket

我在通过套接字发送文件（不一定是 txt 文件）时遇到问题。我有 2 个类：服务器、客户端。当我从套接字输出流中读取并想在文件中写入字节时，它看起来工作但当我打开文件时它什么都没有。（损坏的显示大小= 0 kb）。我还希望它通过套接字传输所有类型的文件。我不想使用appache commons net。这是我的代码服务器类

```
FileOutputStream toFile1 = new FileOutputStream(f);             
BufferedOutputStream toFile= new BufferedOutputStream(toFile1);
BufferedInputStream bis=new BufferedInputStream(incoming.getInputStream());
byte[]buffer=new byte[2048];
int bytesRead=0;

while((bytesRead = bis.read(buffer)) >= 0)
{   
    toFile.write(buffer, 0, bytesRead);

}

toFile.close();
toFile1.close();
bis.close();
out.println("226 Connection Closed");
out.flush();
                  } 
```

客户端类

```
 BufferedOutputStream output = new BufferedOutputStream(socket.getOutputStream());
 byte[] buffer = new byte[60*2024];
 int bytesRead = 0;
 while ((bytesRead = input.read(buffer,0,60*1024)) != -1) {
        output.write(buffer, 0, bytesRead);
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:28:11.843

该代码可能发生的唯一方法是，如果您正在发送零长度文件，或者可能从已经位于 EOF 的文件输入流中读取，或者您之后正在查看错误的文件。

# java - 首次尝试使用链接参数失败的 Facebook 发布

> ID：14636884
> 
> 赞同：7
> 
> 时间：2013-01-31T23:13:47.697
> 
> 标签：java, facebook, facebook-graph-api

我正在尝试使用 Graph API 发布到 Facebook，其中一个参数是链接。

示例网址：

[https://graph.facebook.com/me/feed?access_token=Xxxx&message=&link=http://something/token/123456B&description=test](https://graph.facebook.com/me/feed?access_token=Xxxx&message=&link=http://something/token/123456B&description=test)

每次链接更改时，第一次发布都会失败。如果我重试两次或三次，则通话有效。

这是我得到的错误：

{"error":{"message":"在非对象上调用成员函数 getImageInfo()","type":"BadMethodCallException"}}

这曾经工作得很好，但两天前突然停止工作。链接总是为我们改变，因此它破坏了所有的帖子。

最近与 Facebook 的 API 有什么变化吗？任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:36:16.850

好吧，我修复了...我认为...在 url 链接中，元 og:image 不能为空，因为 '' 并且链接必须是绝对的。如果链接没有图像，请不要放置元数据。顺便说一句，我在 fb 应用程序面板上将应用程序更新为 2013 年 2 月的重大更改以激活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T06:40:50.910

这似乎是 Facebook 后端错误消息问题。[您应该考虑在Facebook Developers Bug Reporting System](http://developers.facebook.com/bugs/create)报告此错误消息和行为

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T18:18:23.203

今天好像有涨有跌。有时很好，但大多数时候它不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T05:59:49.013

我有同样的问题，只是设法解决它。URL 的页眉中的 og:image 元素存在问题。我的图片链接是相对于网站的，但我将其更改为绝对链接，现在似乎一切正常。

```
<meta property="og:image" content="{should be absolute url here}" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-01T05:39:15.823

我在 iOS 开发中遇到了同样的问题，来自服务器的响应：

```
"com.facebook.sdk:HTTPStatusCode" = 500;
    "com.facebook.sdk:ParsedJSONResponseKey" =     {
        body =         {
            error =             {
                message = "Call to a member function getImageInfo() on a non-object";
                type = BadMethodCallException;
            };
        };
        code = 500;
    }; 
```

能有什么帮助？:)

# emacs - Emacs 缓冲区管理

> ID：14636886
> 
> 赞同：1
> 
> 时间：2013-01-31T23:13:57.503
> 
> 标签：emacs

我想知道人们如何管理随机生成的无用消息等 emacs 缓冲区，例如在我完成后，我得到一个完成缓冲区，它创建了一个缓冲区，我必须遍历才能到达下一个缓冲区。有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T23:56:35.637

标题比较模糊。关于 Emacs 中“缓冲区管理”的一般主题有很多问答。这是一个包含其他几个链接的链接（请参阅右侧边栏中的“链接”）：
[如何更轻松地在 Emacs 中的缓冲区之间切换？](https://stackoverflow.com/questions/7394289/how-can-i-more-easily-switch-between-buffers-in-emacs)

对于您的具体问题，我建议使用优秀的`winner-mode`. 只需添加`(winner-mode 1)`到您的 .emacs 文件中（或键入`M-x` `winner-mode` `RET`来尝试一下）。

启用后，您可以调用`winner-undo`with `C-c``<left>`（如有必要，可重复调用）以倒退所有先前的窗口配置。

因此，当弹出一个窗口并且您不再需要它时，您输入`C-c``<left>`并立即恢复到以前的状态。

`C-c``<right>`调用`winner-redo`恢复您开始的配置（即它不会像 undo 命令那样逐步执行配置）。

另请注意，许多类型的缓冲区可以`q`用 . 掩埋或删除`z`。

# coldfusion - Update a specific row in an html table - ColdFusion

> ID：14636888
> 
> 赞同：0
> 
> 时间：2013-01-31T23:14:03.630
> 
> 标签：coldfusion, coldfusion-9

I am outputting data from a query to an html table for representation. On the Right corner of the table I have an "Update" button and a "Delete" button.

What I am trying to do is:

*   When I press on the update button a modal opens. Inside that modal I have a form which I want to have predefined the values from the current row and be able to edit the specific row
*   When I press the delete button on a row I want that row to be deleted and reload the page

This is my html table, the last two columns on the right are the buttons

```
 **Survey Name**    **Category**    **Weight**  **Update**  **Delete**
 Consultation   Ambiance                 20         Update  Delete
 Consultation   Consultation             40         Update  Delete
 Consultation   Follow Up                40         Update  Delete 
```

This is my first query which generates the table

```
<cfquery name="categories" datasource="#dsn#">
        select s.name, s.id as surveyid, rc.categoryname, rc.id as categoryid, sc.cweight 
        from survey_categories sc
        join surveys s on s.id = sc.surveyidfk
        join rating_categories rc on rc.id = sc.categoryidfk
        where sc.surveyidfk='#form.survey#'
    </cfquery> 
```

This is the form I am accessing when I press "Update"

*   This form has an extra cfloop around the select tag to get the rest of the categories that I have in the database in case the user needs to change the category.
*   So, for example if I pressed the update button on the second row on my table this form should have `Consultation` in the drop down menu and the number `40` on the bottom textbox
*   A small note that may help, the first query that outputs the table also output a unique id with the pair (id, surveyName, Category, Weight). So the update query in the end would be something like

    `update categories set category='Example', weight='30' where id='345'`

I don't know how much this can help.

```
<cfoutput>
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h3 id="myModalLabel">Update</h3>
      </div>
      <div class="modal-body">
         <form name="update" action="updateSCpair.cfm" method="post">
            <input type="text" value="#categories.name#" class="input-xlarge" disabled> <br />
            <select name="categories">
                <cfloop query="ratingCat">
                  <option value="#ratingCat.id#" >#ratingCat.categoryName#</option>
                </cfloop>
            </select>
            <br />
            <input  class="span3" type="number" placeholder="Enter Category Weight" required >

      </div>
      <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
        <button class="btn btn-primary">Save changes</button>
        </form>
    </div>

    </cfoutput> 
```

**UPDATE** TO make it more clear because I think I wrote too much. I need to call a modal on form submittion. I will need to replace my current buttons with a form and then pass all the data through hidden variables. The problem is that this is not working for me. I found another example here but it doesn't seem to work. [EXAMPLE](https://stackoverflow.com/questions/4598326/jquery-post-form-to-a-modal-window-for-previewing-the-entered-data)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T00:15:08.887

我认为最简单的方法是在每行的末尾有两个表格。你已经有了按钮。其余的可以是隐藏字段。

您的更新表单将有一个目标属性来启动您的弹出窗口。由于您已经拥有查询中的值，您只需将它们作为隐藏字段提交到弹出窗口。

您的删除表单将提交到当前的coldfusion 页面。在页面的开头，您会看到这样的内容：

```
<cfif StructKeyExists(form, "DeleteMeOrSomethingLikeThat")>
code to delete record
</cfif> 
```

这会让你开始。如果你以后想改进它，你可以。

最后，一次只做一件事。

# html - 带有 Flash 后备的 HTML5 视频播放器，只有 mp4

> ID：14636889
> 
> 赞同：0
> 
> 时间：2013-01-31T23:14:12.453
> 
> 标签：html, flash, mp4

任何人都可以帮我设置一个 HTML5 视频播放器，在 Flash 上回退并且只使用 mp4 视频文件吗？该文件应从 URL 提供（如[http://www.resursecrestine.ro/download/41323](http://www.resursecrestine.ro/download/41323)）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:23:21.593

您可能想查看[videojs](http://videojs.com/)。它支持 MP4 等，并具有轻量级的 Flash 后备。

# ajax - Ajax called the previous Action in struts2?

> ID：14636890
> 
> 赞同：0
> 
> 时间：2013-01-31T23:14:12.933
> 
> 标签：ajax, struts2

Let say I have jsp pages named **list_question.jsp** and **ajax_result.jsp**

in struts.xml

```
<action name="question/*/*" class="ProcessAction" >
  <param name="selectedCatId">{1}</param>
  <param name="questionId">{2}</param>
  <result name="success">list_question.jsp</result>
</action>

<action name="submitReponse" class="AJXAction" >
  <result name="success">ajax_result.jsp</result>
</action> 
```

the scenario as follows:

First, the page **list_question.jsp** is displayed as the success result of **ProcessAction**. Everything worked perfectly.

Then, inside **list_question.jsp**, I perform an ajax call as follows:

```
$("#postResponse").click(function(){
                $("#responses").html("loading...");
                $.ajax({
                        type:"POST",
                        url: "submitReponse", // Action name
                        data: $('form').serialize(),
                        success: function(data){
                            $("#responses").html(data);
                        }
                        }); 
            }); 
```

The problem is, it never called the **AJXAction** action class, rather it always invoked the previous action class (**ProcessAction**), even though different action names are specified.

I am missing something?

# iphone - Dismissing a Presented View Controller

> ID：14636891
> 
> 赞同：124
> 
> 时间：2013-01-31T23:14:21.797
> 
> 标签：iphone, ios, objective-c, cocoa-touch, uiviewcontroller

I have a theoretic question. Now İ'm reading Apple's [ViewController](https://developer.apple.com/reference/uikit/uiviewcontroller) guide.

They wrote:

> When it comes time to dismiss a presented view controller, the preferred approach is to let the presenting view controller dismiss it. In other words, whenever possible, the same view controller that presented the view controller should also take responsibility for dismissing it. Although there are several techniques for notifying the presenting view controller that its presented view controller should be dismissed, the preferred technique is delegation.

But I can't explain, why I have to create a protocol in presented VC and add delegate varible, create delegate method in presenting VC for dismissing presented VC, instead of a simple call in **presented** view controller method

`[self dismissViewControllerAnimated:NO completion:nil]`?

Why is the first choice better? Why does Apple recommend it?

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2013-01-31T23:29:22.513

我认为 Apple 正在为一个可能很笨拙的 API 掩饰一下。

```
 [self dismissViewControllerAnimated:NO completion:nil] 
```

其实有点小题大做。尽管您可以合法地在呈现的视图控制器上调用它，但它所做的只是将消息转发到呈现的视图控制器。如果您想在关闭 VC 之外做任何事情，您将需要知道这一点，并且您需要以与委托方法相同的方式对待它 - 因为这几乎就是它的本质，一个烘焙的有点不灵活委托方法。

也许他们遇到了很多糟糕的代码，这些代码并不真正了解这些代码是如何组合在一起的，因此他们很谨慎。

但是，当然，如果您需要做的就是忽略这件事，请继续。

我自己的做法是一种妥协，至少它提醒了我是怎么回事：

```
 [[self presentingViewController] dismissViewControllerAnimated:NO completion:nil] 
```

*[迅速]*

```
 self.presentingViewController?.dismiss(animated: false, completion:nil) 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2016-06-10T04:36:17.467

*为 Swift 3 更新*

我来到这里只是想解除当前（呈现的）视图控制器。我正在为任何出于相同目的来到这里的人做出这个答案。

# 导航控制器

如果您使用的是导航控制器，那么这很容易。

**回到之前的视图控制器：**

```
// Swift
self.navigationController?.popViewController(animated: true)

// Objective-C
[self.navigationController popViewControllerAnimated:YES]; 
```

**回到根视图控制器：**

```
// Swift
self.navigationController?.popToRootViewController(animated: true)

// Objective-C
[self.navigationController popToRootViewControllerAnimated:YES]; 
```

（感谢Objective-C的[这个答案。）](https://stackoverflow.com/a/20120647/3681880)

# 模态视图控制器

当视图控制器以模态方式呈现时，您可以通过调用将其关闭（从第二个视图控制器）

```
// Swift
self.dismiss(animated: true, completion: nil)

// Objective-C
[self dismissViewControllerAnimated:YES completion:nil]; 
```

[文件](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/#//apple_ref/occ/instm/UIViewController/dismissViewControllerAnimated:completion:)说，

> 呈现视图控制器负责关闭它呈现的视图控制器。如果您在呈现的视图控制器本身上调用此方法，UIKit 会要求呈现的视图控制器处理解除。

所以它适用于呈现的视图控制器自己调用它。[这](https://stackoverflow.com/a/37274189/3681880)是一个完整的例子。

# 代表们

OP 的问题是关于使用代表解除视图的复杂性。

*   [这个 Objective-C 的答案](https://stackoverflow.com/a/14910469/3681880)很深入。
*   [这](https://stackoverflow.com/a/27435406/3681880)是一个 Swift 示例。

到目前为止，我不需要使用委托，因为我通常有一个导航控制器或模式视图控制器，但是如果我将来确实需要使用[委托模式](https://stackoverflow.com/questions/24099230/delegates-in-swift/33549729#33549729)，我会添加一个更新。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2014-07-11T03:19:15.927

这是为了视图控制器的可重用性。

您的视图控制器不应该关心它是否被呈现为模式、推送到导航控制器或其他任何东西。如果您的视图控制器自行关闭，那么您假设它是以模态方式呈现的。您将无法将该视图控制器推送到导航控制器上。

通过实现一个协议，您可以让父视图控制器决定它应该如何呈现/推送和解除/弹出。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-02-28T09:54:39.260

尝试这个：

```
[self dismissViewControllerAnimated:true completion:nil]; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-01-31T23:17:35.950

***根据我的经验，当您需要从任何***您想要的 ViewController 中将其关闭并为每个关闭它的视图控制器执行不同的任务时，它会派上用场。任何采用该协议的 viewController 都可以以自己的方式关闭视图。（ipad vs iphone，或者从不同的视图dismiss时传递不同的数据，dismiss时调用不同的方法等。）

编辑：

因此，澄清一下，如果您只想关闭视图，我认为无需设置委托协议。***如果您在从不同的呈现视图控制器中解除它后***需要做不同的事情，这将是您使用委托的最佳方式。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-05-20T10:31:42.540

**Swift 3.0** //在swift中关闭视图控制器

```
self.navigationController?.popViewController(animated: true)
dismiss(animated: true, completion: nil) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-03-03T06:06:16.673

引用视图[控制器编程指南](https://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/ModalViewControllers/ModalViewControllers.html)，“视图控制器如何呈现其他视图控制器”。

> 呈现的视图控制器链中的每个视图控制器都有指向链中围绕它的其他对象的指针。换句话说，呈现另一个视图控制器的呈现视图控制器在其呈现视图控制器和呈现视图控制器属性中都具有有效对象。您可以根据需要使用这些关系来跟踪视图控制器链。**例如，如果用户取消当前操作，您可以通过关闭第一个呈现的视图控制器来移除链中的所有对象。关闭视图控制器不仅会关闭该视图控制器，还会关闭它呈现的任何视图控制器。**

所以一方面它实现了一个很好的平衡设计，良好的解耦等等......但另一方面它非常实用，因为你可以快速回到导航的某个点。

虽然，我个人更愿意使用*展开转场*而不是尝试向后遍历*呈现的视图控制器*树，这就是苹果在本章中引用的内容。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-05-14T09:33:47.430

有一点是，这是一种很好的编码方法。它满足许多`OOP`原则，例如，SRP、关注点分离等。

因此，呈现视图的视图控制器应该是关闭它的控制器。

例如，出租房屋的房地产公司应该有权收回房屋。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-10-21T11:00:47.827

我喜欢这个：

```
 (viewController.navigationController?.presentingViewController
            ?? viewController.presentingViewController
            ?? viewController).dismiss(animated: true) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-13T08:41:15.803

除了 Michael Enriquez 的回答之外，我还能想到另一个原因，为什么这可能是保护自己免受未确定状态的好方法：

假设 ViewControllerA 以模态方式呈现 ViewControllerB。但是，由于您可能没有为 ViewControllerA 编写代码，因此您不知道 ViewControllerA 的生命周期。在呈现您的视图控制器 ViewControllerB 后，它可能会关闭 5 秒（例如）。

在这种情况下，如果您只是简单地使用`dismissViewController`from ViewControllerB 来关闭自己，您最终会处于未定义的状态——从您的角度来看，可能不是崩溃或黑屏，而是未定义的状态。

相反，如果您使用的是委托模式，您会知道 ViewControllerB 的状态，并且可以针对我描述的情况进行编程。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-10-31T12:51:19.770

迅速

```
let rootViewController:UIViewController = (UIApplication.shared.keyWindow?.rootViewController)!

        if (rootViewController.presentedViewController != nil) {
            rootViewController.dismiss(animated: true, completion: {
                //completion block.
            })
        } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-12-16T16:28:06.683

如果您使用模态，请使用视图关闭。

```
[self dismissViewControllerAnimated:NO completion:nil]; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-12-02T22:00:20.210

只关注问题的标题，这是正确的答案。

```
 presentedViewController?.dismiss(animated: true) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-02-05T02:56:53.500

这是胡说八道。委托在需要时很好，但如果它使代码更复杂——确实如此——那么就需要有它的理由。

我相信苹果有它的理由。但是，除非有真正的理由不这样做，而且到目前为止，这里没有人提出我能看到的，否则简单地让所介绍的 VC 进行解雇会更清晰、更简洁。

协议在需要时非常出色，但面向对象的设计绝不是让模块不必要地相互通信。

Tom Love（Objective C 的共同开发者）曾经评论说，Objective C 是“优雅的”、“小巧的”、“清晰的”和“定义明确的”（与 C++ 相比）。他说得轻松。委托是一个有用的功能，似乎“仅仅因为”而被过度使用，虽然我喜欢使用该语言工作，但我害怕感觉被迫使用不必要的语法来使事情变得比它们必须的更复杂的想法。

# android - 如何使用 SharedPreferences 保存变量

> ID：14636892
> 
> 赞同：1
> 
> 时间：2013-01-31T23:14:28.153
> 
> 标签：android, json, sharedpreferences, gson, state

我有自己的对象，需要存储以备后用。用户保存此对象，将其转换为 JSON 字符串，然后当用户连接到网络时，将 JSON 字符串转换回对象，对其执行操作。

我的问题是，在运行时，我怎么知道如何存储对象？

IE

```
Gson gson= new Gson();
String pointOfInterest = gson.toJson(point);
SharedPreferences.Editor sharedprefEditor = application_shared_preferences.edit();
sharedprefEditor.putString(?KEY?,pointOfInterest); 
```

我可以使用什么来获取 KEY 的值？如果我使用索引，每次打开或关闭应用程序时它都会重置，这将替换我的对象。

**编辑** 对不起，我没有说得足够清楚，上面代码所在的方法可以运行任意次数，并且可以存储多个pointsOfInterest。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:18:54.687

首先，如果您使用索引，则 Preference 将永远存在：

例如：

```
sharedprefEditor.putString("JSON569",pointOfInterest); 
```

您还可以将索引保存在其他首选项中；例如由一列分隔：

```
sharedprefEditor.putString("indexes","569;789;852"); 
```

您可以轻松地检查实例是否存在：

```
myPreference.getString("JSON789","").contentEquals(""); 
```

或获取所有实例：

```
for (int anIndex:indexes)
    Log.i("TAG","Current value: "+myPreference.getString("JSON"+anIndex,"")); 
```

请再解释一下您的问题，我认为那里没有困难/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:20:00.450

您可以随意命名密钥，只需使其保持一致即可。一种方法是在你的类中为它创建一个常量：

```
public class MyClass {
    private static final String OBJECT_KEY = "myObjectKey";

    ... 
```

然后当您保存对象时：

```
Gson gson= new Gson();
String pointOfInterest = gson.toJson(point);
SharedPreferences.Editor sharedprefEditor = application_shared_preferences.edit();
sharedprefEditor.putString(OBJECT_KEY,pointOfInterest); 
```

加载它时，只需使用`OBJECT_KEY`从共享首选项中获取字符串：

```
String objectString = sharedPrefs.getString( OBJECT_KEY, "" ); 
```

# razor - Pass null parameter to controller with ActionLink

> ID：14636893
> 
> 赞同：5
> 
> 时间：2013-01-31T23:14:28.723
> 
> 标签：razor, parameters, asp.net-mvc-4, controller, actionlink

I have a view that lists a bunch of categories:

```
<ul>
    <li>@Html.ActionLink("All", "Index", "Products")</li>
    @foreach (var item in Model.ProductCategories)
    {
        <li>@Html.ActionLink(item.Name, "Index", new { id = item.Id }, null)</li>
    }
</ul> 
```

As shown I should get a list of category links, the top one being "All" and the following ones being the respective category name, with an id passed to the controller.

My controller looks like this:

```
public ActionResult Index(int? id)
{
    var categories = _productCategoryRepository.GetAll().OrderByDescending(f => f.Name);
    var items = id == null
        ? _productItemRepository.GetAll().OrderBy(f => f.Name).ToList()
        : _productCategoryRepository.GetSingle((int)id).ProductItems.OrderBy(f => f.Name).ToList();

    var model = new ProductsViewModel()
                    {
                        ProductCategories = categories,
                        ProductItems = items
                    };

    return View(model);
} 
```

So the categories should always be the same. But the items should show every item, when the **id** is *null* and the items of the specific category when the **id** is set.

That all works absolutely great, so when I click a category link. I get to the url like this:

**/Products/Index/3**

Great! Now I click the "All" link, but it's routing me to **/Products/Index/3** even though I clearly don't pass a parameter to it. I tried passing a null value:

```
@Html.ActionLink("Alle", "Index", "Products", new { id = null }) 
```

But I then get the error: *Cannot assign 'null' to anonymous type property.*

How can I force null to be passed to my index controller?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-01T03:28:57.007

你的控制器动作会很高兴接受一个 nullable `int`，所以像这样给它一个 nullable `int`！

```
@Html.ActionLink("Alle", "Index", "Products", new { id = (int?)null }) 
```

# java - 测试执行期间上下文中的模拟对象

> ID：14636897
> 
> 赞同：3
> 
> 时间：2013-01-31T23:14:36.837
> 
> 标签：java, spring, testing, mocking, springockito

我正在开发一个同时具有组件和集成测试的应用程序。两者之间的区别在于：组件测试测试多个类（即，它的内部对象并未全部模拟出来 - 但其中一些可能是 [例如 JMS 发布者]），而集成测试是一种测试一切都被嘲笑了。换句话说，Spring 为您提供了对象，然后您按原样对其进行测试。

到目前为止，一切都很好。

问题是：为了能够从 Spring 上下文中替换一个或另一个依赖项，我使用了 Springockito ( [https://bitbucket.org/kubek2k/springockito/wiki/Home](https://bitbucket.org/kubek2k/springockito/wiki/Home) )，它为您提供了一种模拟一些 bean 的方法来自 Spring 上下文。

所以 - 在组件测试中 - 我有这个：

```
@RunWith(SpringJUnit4ClassRunner.class)
@DirtiesContext(classMode = AFTER_CLASS)
@ContextConfiguration(loader = SpringockitoContextLoader.class, locations = "classpath:spring-classify-test.xml")
public class....

     @Autowired
     @ReplaceWithMock
     private SomeServiceInterface someServiceInterface;
     @Autowired
     private Bean bean; 
```

Bean 具有 SomeServiceInterface 作为依赖项。

```
public class Bean { 
   private SomeServiceInterface... 
```

在上述情况下， SomeServiceInterface 将被模拟替换。当然，这个例子是对问题的过度简化——我用模拟对象替换了 bean，这些模拟对象是对象图中的依赖项。

值得注意的是，我从这个文件加载了上下文：spring-classify-test.xml 另外值得注意的是，我在执行类之后将上下文标记为脏 - 所以，AFAIK，下一个测试类必须重新加载上下文。

现在进行集成测试：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(loader = SpringockitoContextLoader.class, locations = {"classpath:/spring-service-integration-test.xml" })
public class ...

    @Autowired
    private Bean bean; 
```

我从 spring-service-integration-test.xml 加载上下文 - 但是 Bean 内部的 SomeServiceInterface 仍然被嘲笑！集成测试中使用的上下文也发生了变化！

如果我用 @DirtiesContext(classMode = ClassMode.AFTER_EACH_TEST_METHOD) 标记集成测试，则类中的第一个测试将失败，因为 SomeServiceInterface 被模拟 - 但下一个测试将通过，因为上下文已经刷新。

有趣的是：

如果我要求 Spring 在集成测试中注入 SomeServiceInterface，它将注入 SomeServiceInterface 的具体实现——而不是模拟！

我已经尝试了很多方法来解决这个问题：

1.  使用上下文中的 registerBeanDefinition 方法完成组件测试后，以编程方式覆盖上下文中的 bean

2.  创建一个 TestExecution 侦听器，以便我可以在执行 IntegrationTest 之前尝试手动刷新上下文

3.  对不同的上下文使用相同的加载器......

4.  这个故事一直在继续。

有人有什么主意吗？

PS：我很理解采用 Springockito 是一个可疑的想法 - 但这个决定不是我做出的，现在我们在项目中有超过 500 个测试 - 因此重构它们以删除 Springockito 将是一项漫长的任务，因此它不是可行的期权 ATM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T13:59:41.153

我建议尝试使用最新[的 springockito-annotations](https://mvnrepository.com/search?q=springockito-annotations) 1.0.8

```
@DirtiesMocks(classMode = DirtiesMocks.ClassMode.AFTER_CLASS) 
```

请参阅[https://bitbucket.org/kubek2k/springockito/wiki/springockito-annotations#!reseting-mocksspies-in-experimental-package-hope-youll-like-it](https://bitbucket.org/kubek2k/springockito/wiki/springockito-annotations#!reseting-mocksspies-in-experimental-package-hope-youll-like-it)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T01:23:29.710

注释在向[TestContextManager](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/test/context/TestContextManager.html)注册时`@DirtiesContext`由[DirtiesContextTestExecutionListener](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/test/context/support/DirtiesContextTestExecutionListener.html)处理。使用普通的 Spring 测试，默认情况下会注册该侦听器。也许 Springockito 或您的测试“组件测试”中的其他东西正在做一些干扰默认侦听器注册的事情？

# sql - 带有视图的 PostgreSQL ORDER BY

> ID：14636901
> 
> 赞同：6
> 
> 时间：2013-01-31T23:14:52.703
> 
> 标签：sql, postgresql, sql-order-by, sql-view, postgresql-9.2

假设我想编写一个`SELECT`使用 a 的简单查询`VIEW`：

```
CREATE TEMP VIEW people AS
SELECT 
     p.person_id
    ,p.full_name
    ,p.phone
FROM person p
ORDER BY p.last_name;

SELECT
     p.*
    ,h.address
    ,h.appraisal
FROM people p
LEFT JOIN homes h
     ON h.person_id = p.person_id
ORDER BY p.last_name, h.appraisal; 
```

这里明显的问题是`p.last_name`当我去执行 final 时不再可用`ORDER BY`。

如何对最终查询进行排序，以便`people`视图的原始序列遵循最终查询？

这里的简单解决方案是在视图中包含 p.last_name。我不想那样做——我在现实世界中的例子（要复杂得多）使这成为一个问题。

我过去对临时表做过类似的事情。例如，我使用创建表，`CREATE TEMP TABLE testing WITH OIDS`然后执行一个`ORDER BY testing.oid`以通过原始序列。

是否可以对视图做同样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T23:29:17.807

如果您使用`row_number() over()`.

这是一个例子：

```
SELECT
    p.*
    ,h.address
    ,h.appraisal
FROM (SELECT *, row_number() over() rn FROM people) p
LEFT JOIN homes h
    ON h.person_id = p.person_id
ORDER BY p.rn, h.appraisal; 
```

这是您可以测试的[SQL Fiddle 。](http://sqlfiddle.com/#!1/67239/2)

正如@Erwin Brandstetter 正确指出的那样，使用`rank()`将产生正确的结果并允许对其他字段进行排序（在本例中为评估）。

```
SELECT
    p.*
    ,h.address
    ,h.appraisal
FROM (SELECT *, rank() over() rn FROM people) p
LEFT JOIN homes h
    ON h.person_id = p.person_id
ORDER BY p.rn, h.appraisal; 
```

以这种方式考虑，使用 row_number()，它将始终仅按该字段排序，而不管任何其他排序参数。通过使用相同关系的 rank()，可以轻松搜索其他字段。

祝你好运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-01T00:25:17.247

基于[@sgeddes 的想法](https://stackoverflow.com/a/14637065/939860)，但[**`rank()`**](http://www.postgresql.org/docs/current/interactive/functions-window.html)改用：

```
SELECT p.*
      ,h.address
      ,h.appraisal
FROM  (SELECT *, rank() OVER() AS rn FROM people) p
LEFT  JOIN homes h ON h.person_id = p.person_id
ORDER BY p.rn, h.appraisal; 
```

我提供了一个测试用例来证明差异。
[**-> sqlfiddle**](http://sqlfiddle.com/#!12/197c2/2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T23:29:10.087

创建一个 row_number 列并在选择中使用它。

```
CREATE TEMP VIEW people AS
SELECT 
     row_number() over(order by p.last_name) as i
    ,p.person_id
    ,p.full_name
    ,p.phone
FROM person p

SELECT
     p.*
    ,h.address
    ,h.appraisal
FROM people p
LEFT JOIN homes h
     ON h.person_id = p.person_id
ORDER BY p.i, h.appraisal 
```

# python - 查找 python 列表的键值以与其他数组一起使用

> ID：14636904
> 
> 赞同：2
> 
> 时间：2013-01-31T23:15:12.850
> 
> 标签：python, arrays, python-2.7

我目前正在开发一个 python 程序，它使用 3 个不同的数组进行大量计算。每个键处的数组值（即`i[1]`与`a[1]`哪个相关也与`q[1]`.

我试图找出哪个值`q`最高（我正在使用python的`q.max()`函数），但我不知道如何找出该最大值的键值。即，如果最大值`q[67]`等于并且等于我将`111110029233`如何获取该`[67]`值，以便我可以使用该键在`i`列表和`a`列表中查找相应的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:20:33.637

试试这个：

```
import operator
max(enumerate(q),key=operator.itemgetter(1))[0] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T23:29:34.070

```
>>> q = [1,2,3,4,5,6,5,4,3,2,1]
>>> q.index(max(q))
5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T23:24:44.680

`max`不会返回索引，要找到它，您必须像这样遍历列表：

```
q = [1,2,3,4,5,6,5,4,3,2,1]

def find_max(li):
    max_item = max(li)
    return (li.index(max_item), max_item)

print find_max(q) 
```

然后，您可以使用返回值中的第一个元素来访问列表中的相关元素。

或者，如果您只想要可以使用的索引：

```
q.index(max(q)) 
```

正如此[堆栈溢出答案中所回答的那样](https://stackoverflow.com/questions/2474015/getting-the-index-of-the-returned-max-or-min-item-using-max-min-on-a-list)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T23:25:27.347

```
q = [1,2,3,4,5,100,-1,0]
index = max(enumerate(q), key=lambda x: x[1])[0] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-01T00:26:19.297

听起来您的最终目标是找到产生最大价值的`a`和值。目前，您正在尝试找到该最大值的索引，以便您可以使用它来访问and中的相应值，但我认为以不同的方式进行处理会更有效。`i``q``q``i``a`

```
max_q, max_i, max_a = max(zip(q, i, a)) 
```

这会找到最大值`q`、 值以及对应的`i`和`a`值。以下是它的工作原理：

首先，该`zip`函数从每个列表中构造一个匹配值元组的生成器（或列表，如果您使用的是 Python 2）。也就是说，它产生`(q[0], i[0], a[0])`了`(q[1], i[1], a[1])`，依此类推。

然后该`max`函数将比较元组，使用第一个值（来自`q`）作为最重要的部分。如果 中存在唯一的最大值`q`，那就是它。如果最大值相同，我上面写的代码将优先选择具有最高`i`值的代码，如果相同，则选择具有最高`a`值的代码。

最后，它将最大元组解包到`max_q`,`max_i`和`max_a`变量中，以便您可以单独使用它们。

# flash - 将 swf 嵌入到 flash builder 中---“找不到类型”？

> ID：14636906
> 
> 赞同：0
> 
> 时间：2013-01-31T23:15:16.003
> 
> 标签：flash, actionscript, air, flash-builder

我正在使用 ActionScript 开发移动应用程序。

我正在导入 .swf 文件但出现错误：

```
Type was not found or was not a compile-time constant: MySwf. 
```

这是我的代码：

```
package
{
import flash.display.Sprite;
import flash.display.StageAlign;

    public class gyyyyppp extends Sprite
 {
    [Embed(source='assets/g1.swf')] public static const MySwf : Class;

    public function gyyyyppp()
    {
        stage.align = StageAlign.TOP_LEFT;

        var p3:MySwf= new MySwf();

        addChild(p3);
    }
  }
} 
```

我做错了什么？

（ps 我的 swf 文件是用非 ​​adobe 程序制作的）我正在使用 Flash Builder

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:24:43.607

我不认为你可以将嵌入类设置为变量类型，试试这个：

```
var p3:MovieClip = new MySwf(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-01T00:55:24.917

我假设您希望能够调用嵌入式 SWF 的自定义方法。如果你只是想使用这个 SWF 中的图形，那么 @ *MickMalone1983*的答案就是你需要的，除了 SWF 的内容可能不是`MovieClip`但是`Sprite`，例如，所以使用`DisplayObject`type:更安全`var p3:DisplayObject = new MySwf()`。

调用自定义方法的问题在于，您不能引用嵌入（或加载）SWF 中定义的类，因为编译器无法链接到此类。因此，您必须编写一个接口，其中包含应该可以从外部访问的方法，然后

1.  通过嵌入式 SWF 的主类实现该接口：

    ```
    public class MySwf extends Sprite implements MyInterface ... 
    ```

2.  使用`Loader`object 实例化嵌入的 SWF 并将实例转换为相同的接口：

    ```
    [Embed(source='assets/g1.swf', mimeType='application/octet-stream')]
    public static const MySwfData : Class;

    public function load()
    {
        var loader:Loader = new Loader();
            loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onSwfLoaded);
            // we need the loaded code to be in the same (main) application domain
            loader.loadBytes(new MySwfData() as ByteArray, new LoaderContext(false, loaderInfo.applicationDomain));
    }

    private function onSwfLoaded(e:Event):void
    {
        var p3:MyInterface = (e.target as LoaderInfo).content as MyInterface;
            p3.myCustomMethod(); // myCustomMethod is defined in MyInterface

        addChild(p3 as DisplayObject);
    } 
    ```

这样，您将能够调用嵌入式 SWF 的自定义方法，因为它们将在嵌入式 SWF 和主应用程序中定义。

此外，通常您`-static-link-runtime-shared-libraries=true`在编译主应用程序时需要指定编译器标志。

# jquery - 带有 ASP.NET 回发的 jQuery 模态对话框

> ID：14636907
> 
> 赞同：17
> 
> 时间：2013-01-31T23:15:17.480
> 
> 标签：jquery, asp.net, jquery-ui, jquery-ui-dialog

我刚刚将我的 jQuery/ [jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)升级到最新版本（jQuery 1.9.0、jQuery UI 1.10.0），它似乎破坏了我的一些 jQuery UI 对话框功能。

为了在 ASP.NET 中的 jQuery UI 对话框中进行回发，有一个非常常见的解决方法，您必须将 DIV 重新附加到主 FORM，因为 jQuery 会在 FORM 之外重新构建 DIV，就像这样：

```
$("#newInsurance").dialog({
    autoOpen: false,
    modal: true,
    open: function (type, data) {
        $(this).parent().appendTo($("form:first"));
    }
}); 
```

不幸的是，由于升级它现在将 Dialog 置于背景的灰色/禁用覆盖层后面。所以Popup中的表格无法使用，全部变灰。我已经尝试了几件事，但我似乎无法让它工作 - 似乎这种旧的解决方法不再有效。有谁知道可行的新解决方法？还是我错过了什么？在我升级之前，这一直很好。

以下是有关使用的解决方法的更多信息：

*   Stack Overflow 问题*[jQuery UI Dialog(Modal)，防止任何回发](https://stackoverflow.com/questions/13951338)*

*   堆栈溢出问题*[$(“#dialog”).parent().appendTo($(“form:first”));](https://stackoverflow.com/questions/4157342)*

*   Stack Overflow 问题*[jQuery modal form 对话框回发问题](https://stackoverflow.com/questions/568784)*

我使用 Internet Explorer 9 和 Google Chrome 24.x 对此进行了测试

[根据 jQuery UI 网站](http://jqueryui.com/upgrade-guide/1.10/#dialog)，Dialog API 在 jQuery UI 1.10.0 中已经完全重新设计：

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-01T02:51:51.093

好的，所以这似乎是 jQuery UI v1.10 的修复：

```
$("#newInsurance").dialog({
    autoOpen: false,
    appendTo: "form",
    modal: true
}).parent().css('z-index', '1005'); 
```

在 jQuery UI v1.10 中，他们添加了一个*appendTo*属性，这似乎与调用`.parent().appendTo($("form"))`. 修复的诀窍是 z-index。

# php - 如何使用 PHPCrawler 使用 PHP 删除某些标签和内容

> ID：14636910
> 
> 赞同：1
> 
> 时间：2013-01-31T23:15:29.580
> 
> 标签：php, dom, phpcrawl

我目前正在将 PHPCrawler 用于网站上的某些搜索功能。我需要从索引中删除一些页面元素。

例如，我使用过：

```
$doc_body = preg_replace('/<li>(.*?)<\/li>/is', "", $doc_body); 
```

删除列表，因为我不希望结果中的列表。这完全可以正常工作。

现在，我需要删除的另一件事如下：

```
<div class="example">all contents within</div> 
```

所以为此我尝试过：

```
 $doc_body = preg_replace('/<div(.*?)class="(.*?)example(.*?)"(.*?)>(.*?)<\/div>/is', "", $doc_body); 
```

这会产生错误，因为可能并非每个页面都有 div 类示例。因此，我使用以下代码对其进行了调整：

```
 if(strpos($doc_body,'<div class="example">')){
      $doc_body = preg_replace('/<div(.*?)class="(.*?)example(.*?)"(.*?)>(.*?)<\/div>/is', "", $doc_body);
      } 
```

不幸的是，这也不起作用！它不会产生错误，但不会从结果中删除所有内容。

这是我第一次使用 phpcrawler 或 Domdocument ......虽然我不确定我的问题是否与他们有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:27:25.637

我建议您看一下[DOMDocument](http://php.net/domdocument)和[XPath](http://php.net/domxpath)，它们用于查询文档模型，就像 CSS 一样，但语法略有不同。W3Schools 在[这里](http://www.w3schools.com/xpath/default.asp)有一个关于 XPath 的轻量级教程。

解析整个文档时，正则表达式总是一个坏主意，因为它既耗费资源又耗时。

例如，要使用 查找每个带有“example”类的 div `XPath`，您只需查询文档即可；

```
//div[@class="example"] 
```

然后用api去掉节点，`DOMDocument`最后归一化，得到最终结果。

```
$doc = new DOMDocument();
$xpath = new DOMXPath($doc);
$doc->loadHTML($html);

// Remove all the lists
foreach ($xpath->query("//ul | //ol") as $node) {
     $node->parentNode->removeChild($node);
}

// Remove all <div class="example" /> nodes
foreach ($xpath->query("//div[@class='example']") as $node) {
     $node->parentNode->removeChild($node);
}

$doc->normalize();

// Get the final document for indexing
$html = $doc->saveHTML(); 
```

# xml - HTML 在 for-each 测试中的格式不正确

> ID：14636911
> 
> 赞同：0
> 
> 时间：2013-01-31T23:15:33.097
> 
> 标签：xml, xslt, xslt-1.0

我确信我的逻辑是不正确的。但是，如果没有多个 for-each 测试，我不确定如何解决这个问题。

也许 for-each 不是正确的方法？我会很感激任何建议。Additinally 我正在使用 XSLT 1.0 以防万一这是必要的信息。

这是我正在使用的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<FIGURES>
    <FIGURE>
        <TITLE>Title 1</TITLE>
        <DESC>Description 1</DESC>
        <CONTENT>Content 1</CONTENT>
    </FIGURE>
    <FIGURE>
        <TITLE>Title 2</TITLE>
        <DESC>Description 2</DESC>
        <CONTENT>Content 2</CONTENT>
    </FIGURE>
    <FIGURE>
        <TITLE>Title 2</TITLE>
        <DESC>Description 2</DESC>
        <CONTENT>Content 2</CONTENT>
    </FIGURE>
</FIGURES> 
```

这是我正在尝试的 XSLT：

```
<xsl:template match="/">
  <div class="container">
    <ul class="list">

      <xsl:for-each select="//FIGURE">

        <li>
          <a href="#section-{position()}"><h3><xsl:value-of select="TITLE" /></h3></a>
          <p><xsl:value-of select="DESC" /></p>
        </li>

        <div class="content">
          <div id="section-{position()}">
            <xsl:value-of select="CONTENT" />
          </div>
        </div>                           

      </xsl:for-each>  

    </ul>    
  </div>

</xsl:template> 
```

这是我想要但没有得到的 HTML：

```
<div class="container">
  <ul class="list">
    <li>
      <a href="#section-1"><h3>Title 1</h3></a>
      <p>Description 1</p>
    </li>
    <li>
      <a href="#section-2"><h3>Title 2</h3></a>
      <p>Description 2</p>
    </li>   
    <li>
      <a href="#section-3"><h3>Title 3</h3></a>
      <p>Description 3</p>
    </li>
  </ul>
  <div class="content">
    <div id="section-1">
      <p>Content 1</p>
    </div>
    <div id="section-1">
      <p>Content 2</p>
    </div>  
    <div id="section-1">
      <p>Content 2</p>
    </div>          
  </div>
</div> 
```

这是我得到但不想要的 HTML：

```
<div class="container">
  <ul class="list">
    <li>
      <a href="#section-1"><h3>Title 1</h3></a>
      <p>Description 1</p>
    </li>
   <div class="content">
     <div id="section-1">Content 1</div>
   </div>
   <li>
     <a href="#section-2"><h3>Title 2</h3></a>
     <p>Description 2</p>
   </li>
   <div class="content">
     <div id="section-2">Content 2</div>
   </div>
   <li>
     <a href="#section-3"><h3>Title 2</h3></a>
     <p>Description 2</p>
   </li>
   <div class="content">
     <div id="section-3">Content 2</div>
   </div>
 </ul>
</div> 
```

**编辑**使用肖恩的例子我想通了。我只是错过了标签上的 select 属性。

```
<xsl:template match="/">
  <div class="container">
    <xsl:apply-templates />
  </div>
</xsl:template>

<xsl:template match="FIGURES">
  <ul class="list">
    <xsl:apply-templates select="FIGURE" mode="titles" />
  </ul>  
  <div class="content">
    <xsl:apply-templates select="FIGURE" mode="content" />
  </div>
</xsl:template>

<xsl:template match="FIGURE" mode="titles">
  <li>
    <a href="#section-{position()}">
      <h3><xsl:value-of select="TITLE" /></h3>
    </a>
    <p><xsl:value-of select="DESC" /></p>
  </li>
</xsl:template>

<xsl:template match="FIGURE" mode="content">
  <div id="section-{position()}">
    <p><xsl:value-of select="CONTENT" /></p>
  </div>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:21:14.560

**这个 XSLT 1.0 样式表...***

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" indent="yes" doctype-system="about:legacy-compat" encoding="UTF-8" />
<xsl:strip-space elements="*" />

<xsl:template match="/">
 <html>
   <body>
     <div class="container">
       <xsl:apply-templates />
     </div>
   </body>
 </html>
</xsl:template>

<xsl:template match="FIGURES">
  <ul class="list">
    <xsl:apply-templates mode="titles" />
  </ul>  
  <div class="content">
    <xsl:apply-templates mode="content" />
  </div>
</xsl:template>

<xsl:template match="FIGURE" mode="titles">
  <li>
    <a href="#section-{position()}">
      <h3><xsl:value-of select="TITLE" /></h3>
    </a>
    <p><xsl:value-of select="DESC" /></p>
  </li>
</xsl:template>

<xsl:template match="FIGURE" mode="content">
  <div id="section-{position()}">
    <p><xsl:value-of select="CONTENT" /></p>
  </div>
</xsl:template>

</xsl:stylesheet> 
```

**...当应用于引用的输入文档时，将产生...**

```
<!DOCTYPE html SYSTEM "about:legacy-compat">
<html>
  <body>
    <div class="container">
      <ul class="list">
        <li><a href="#section-1"><h3>Title 1</h3></a><p>Description 1</p>
        </li>
        <li><a href="#section-2"><h3>Title 2</h3></a><p>Description 2</p>
        </li>
        <li><a href="#section-3"><h3>Title 2</h3></a><p>Description 2</p>
        </li>
      </ul>
      <div class="content">
        <div id="section-1">
          <p>Content 1</p>
        </div>
        <div id="section-2">
          <p>Content 2</p>
        </div>
        <div id="section-3">
          <p>Content 2</p>
        </div>
      </div>
    </div>
  </body>
</html> 
```

* * *

## 更新

如果您没有使用 xsl:strip-space（您应该使用，正如我在解决方案中给您的那样），或者由于某种原因，您在图形元素之间散布了其他节点，那么此样式表将为您提供更强大的解决方案...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" indent="yes" doctype-system="about:legacy-compat" encoding="UTF-8" />
<xsl:strip-space elements="*" />

<xsl:template match="/">
 <html>
   <body>
     <div class="container">
       <xsl:apply-templates />
     </div>
   </body>
 </html>
</xsl:template>

<xsl:template match="FIGURES">
  <ul class="list">
    <xsl:apply-templates mode="titles" />
  </ul>  
  <div class="content">
    <xsl:apply-templates mode="content" />
  </div>
</xsl:template>

<xsl:template match="FIGURE" mode="titles">
  <li>
    <a href="#section-{count(preceding-sibling::FIGURE)+1}">
      <h3><xsl:value-of select="TITLE" /></h3>
    </a>
    <p><xsl:value-of select="DESC" /></p>
  </li>
</xsl:template>

<xsl:template match="FIGURE" mode="content">
  <div id="section-{count(preceding-sibling::FIGURE)+1}">
    <p><xsl:value-of select="CONTENT" /></p>
  </div>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T00:16:12.827

不确定这是否是最有效的方法，但应该解决目的：

```
<xsl:template match="/">
<xsl:apply-templates select="./FIGURES"/>
</xsl:template>

<xsl:template match="FIGURES">
<html>
<body>
  <div class="container">
    <ul class="list">
      <xsl:apply-templates select="//FIGURE"/>
   </ul>
  <div class="content">
    <xsl:apply-templates select="//CONTENT"/>
  </div>
</div>
</body>
</html>
</xsl:template>

<xsl:template match="CONTENT">
<div id="section-{position()}">
<p><xsl:value-of select="."/></p>
</div>
</xsl:template>

<xsl:template match="FIGURE">
<li>
<a href="#section-{position()}">
<h3><xsl:value-of select="./TITLE"/></h3>
</a>
<p><xsl:value-of select="./DESC"/></p>
</li>
</xsl:template> 
```

# c - 为什么在 C 中使用目标文件？

> ID：14636916
> 
> 赞同：1
> 
> 时间：2013-01-31T23:16:10.780
> 
> 标签：c, linker, include

当我编译一个 C 程序时，为方便起见，我一直在最后包含某个标头的源文件。因此，如果 main.c 包含 util.h，则 util.h 将包含 util.c 将使用的所有头文件、概述类型或结构等，然后在最后包含 util.c。然后，当我编译时，我只需要使用 gcc main.c -o main，其余的都处理好了。

我一直在查找 C 编码标准，试图找出做事的最佳方式是什么，但有这么多，这么多相互矛盾的意见，我不知道该怎么想。为什么这么多地方建议单独编译目标文件而不是将它们全部包含在网络中？util 除了 util.c 之外从不触及任何东西，所以两者是完全独立的，理论上（我的理论）会很好，但我可能错了，因为这是计算机科学，即使他们是对的，人们也会错，所以如果我已经错了，我可能错了。

有人说头文件应该只是原型，源文件是包含它的文件，它是必要的系统头文件。从纯粹美学的角度来看，我更喜欢在标题（在本例中为 util.h）中包含所有信息（类型、使用的系统标题、原型），并且在 util.c 中只有功能代码（不包括一个“#include” util.h"" 在最顶部）。

我想我的意思是，在所有这些东西都有效的情况下，选择一种方法对于不了解背景的人（我）来说听起来很随意。请告诉我为什么和什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T23:25:39.223

虽然您的程序很小，但这将起作用。但是，在某些时候，您的程序会变得足够大，以至于每次更改一行时都重新编译整个程序是一件很痛苦的事情。

这 - 甚至比避免编辑大文件 - 是拆分程序的原因。如果 main.c 和 util.c 分别编译成目标文件，那么在 main.c 中更改一个函数中的一行将不再需要您重新编译 util.c 中的所有代码。

当你的程序由几十个文件组成时，这将是一个*巨大*的胜利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:23:09.597

我认为关键是您只想包含该文件独立所需的内容。这通过允许编译器仅读取必要的标头而不是在可能不需要时重复读取每个标头来减少总体编译时间。例如，如果您的`util.c`方法使用函数和/或类型 in`<stdio.h>`但您`util.h`不使用，那么您只想包含`<stdio.h>`in`util.c`以便在编译器编译*时*`util.c`只包含in ，但如果您改为包含在其中 ，则每个源文件这包括也包括它是否需要它。*`<stdio.h>``<stdio.h>``util.h``util.h``<stdio.h>`*

 *对于只有少量文件的小型项目，这可以忽略不计，但正确包含头文件会影响大型项目的编译时间。

关于“目标文件”的问题：当您将源文件编译为目标文件时，您创建了一个快捷方式，允许构建系统仅重新编译具有过时目标文件的源文件。这是显着减少编译时间的有效方法，尤其是对于大型项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T23:29:30.797

首先，从 .h 文件中包含 .c 文件是完全符合低音要求的。

这样做的“标准”方式遵循大致如下的思路：

您有一个库，其中包含许多函数。将所有内容保存在一个大源文件中意味着任何使用您的库的人都必须链接*整个*库，即使他只使用其中的一个函数。（想象一下将整个 C 标准库链接到一个`puts( "Hello" )`.）

因此，您将内容拆分到多个源文件中，这些源文件是单独编译的。每当您对其中一个函数进行更改时，您只需要重新翻译一个小源文件并更新库存档（或可执行文件） - 而不是每次都重新翻译整个内容。（这*仍然*是一个问题，因为代码大小在某种程度上跟上了 CPU 的改进。在不太花哨的硬件上编译类似 Boost 库的东西仍然需要几分钟......）

然而，现在你正处于紧要关头。该函数在 .c 文件中定义，并且可以方便地链接相应的 .o 文件（如果需要，可以通过 .a 存档）。*但是*，要真正从另一个源文件（也称为“翻译单元”）正确地*处理*函数（由 .o 文件提供），您的编译器需要知道函数名称、它的参数列表和它的返回类型。这就是为什么将函数的*声明*（即没有函数体的函数头）放在单独的头文件 (.h) 中的原因。

其他源文件现在可以`#include`作为头文件，正确地寻址函数（编译器不知道函数实际做了什么*）*，当你的库/程序的所有部分都编译成 .o 文件时，*所有*东西都链接在一起。

源文件包含自己的头文件，主要是为了确保两个文件在函数声明上一致。;-)

就是这样，就我现在能写出来的而言。将所有内容放在一个单一的源文件中*几乎*是不可接受的（实际上，不，不是，对于超过 200 行的任何内容都不能），但是在 .h 文件末尾包含 .c 文件意味着您学会了 C 编码通过查看糟糕的代码而不是一本好书，或者任何辅导过你的人都不应该在他的生活中辅导另一个人的 C 编码。无意冒犯。;-)

**PS：**头文件还提供了对一段代码的很好的总结/监督。不提供标头的语言（例如 Java）需要 IDE 或文档工具来提取此类信息。就个人而言，我发现头文件是一种好处，而不是一种责任。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T23:47:48.920

请按习惯使用`*.h`and文件： files是d in files；*仅*包含宏定义、数据类型声明、函数声明和数据声明。*所有*定义都在文件中。这就是其他人组织 C 程序的方式，请帮助您的人类同胞（有一天可能需要理解您的程序）。如果在外部使用了 in 的内容，您将编写包含该文件中要在外部使用的任何内容的声明，并将其包含在（以检查声明和定义是否一致）和所有使用文件中。*如果*一堆总是`*.c``*.h``#include``*.c``*.h`*`extern`*`*.c``file.c``file.h``file.c``*.c``*.h`*包含在一起，这可能意味着拆分`*.c`为不正确（或者至少是`*.h`; 也许您应该制作一个`.h`包含所有这些声明的拆分，并在相关文件`*.h`组中根据需要创建供内部使用）。`*.c`***

 ***[如果按照您的大纲编写的程序遇到了我的问题，我可以向您保证，我会像瘟疫一样避免它。额外的混淆可能会在[IOCCC](http://www.ioccc.org/)中受到欢迎，但不是我。这肯定表明有人不知道如何干净地组织程序，因此该程序可能不值得尝试。]

**回复：单独编译：**你分解了一个 C 程序，以便更容易理解，你可以在 C 文件中隐藏事情如何工作的细节（想想`static`），这为 Parnas 的模块化提供了支持。这也意味着如果您更改文件，则不必重新编译所有内容。

**回复：不同的 C 编程标准：**是的，周围有很多。选择一个你觉得舒服的，并坚持下去。如果您从事一个项目，请遵守他们的标准。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-01T00:24:18.490

“包含在单个翻译单元中”的方法对于任何大型项目都变得非常低效，对于分布在多个开发人员之间的项目是不切实际的。

Morover 在创建静态库时，如果库中的所有内容都来自单个翻译单元，那么任何链接到它的代码都会获得所有库代码，无论它是否被引用。

使用诸如*make*之类的构建管理器或大多数 IDE 中可用的功能的项目使用头文件依赖项来允许*增量构建*；只编译那些被修改或依赖于修改文件的源。依赖关系由文件包含确定，因此最小化冗余依赖关系可以加快构建时间。

一个典型的商业项目可能包含数十万行代码和数百个源文件；完全重建时间可能从几分钟到几小时不等。如果在您的开发周期中，您必须在代码更改和测试之间等待那么长的时间，那么生产力将会非常低！****

# python - numpy 或 python 中的 A-star 搜索

> ID：14636918
> 
> 赞同：11
> 
> 时间：2013-01-31T23:16:18.837
> 
> 标签：python, numpy, a-star

我尝试在 stackoverflow 中搜索标签`[a-star] [and] [python]`和`[a-star] [and] [numpy]`，但没有。我也用谷歌搜索了它，但无论是由于标记化还是它的存在，我什么都没有。

它并不比你的编码面试树遍历更难实现。但是，为每个人提供正确有效的实现会很好。

numpy 有 A* 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-28T07:00:13.480

Numpy 没有 A*，但 NetworkX 有。请参阅[https://networkx.github.io/documentation/networkx-1.10/reference/generated/networkx.algorithms.shortest_paths.astar.astar_path.html](https://networkx.github.io/documentation/networkx-1.10/reference/generated/networkx.algorithms.shortest_paths.astar.astar_path.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-27T23:10:26.553

因为您的问题指定`numpy`OR `python`： PyPi 上至少有[一个 astar 求解器在 python 中可用](https://pypi.python.org/pypi/astar)。

GitHub 上似乎也有一些选项，其中之一[利用了 numpy 和 c++（希望是有效的）](https://github.com/hjweide/a-star)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-06T19:44:07.767

不，Numpy 中没有 A* 搜索。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-06-28T07:21:08.017

Gamedev 库也提供了它们的实现。例如，`libtcod`（一个roguelike引擎）[here](http://roguecentral.org/doryen/data/libtcod/doc/1.5.2/html2/path_init.html?c=false&cpp=false&cs=false&py=false&lua=false)有，但它只对`libtcod`自己的网格有用。

通用 A*“适用于所有人”是不可能的，因为它可以应用的东西太多了。各种图形、网格、平面以及所有这些都可以通过十几种方式实现，每种方式都有十几个 API。

# data-cleaning - 谷歌优化行和列之间的交叉引用

> ID：14636919
> 
> 赞同：3
> 
> 时间：2013-01-31T23:16:20.777
> 
> 标签：data-cleaning, openrefine

我不确定这是否可以在 Google Refine 中实现。但基本上，我有这样的数据。

![在此处输入图像描述](../Images/7846f72a1b3ee4e60c0bd6313f2ff1c0.png)

![在此处输入图像描述](../Images/8f9ca7b0f6a0eb37ae83324a5e7381cf.png)

第一个表是所有用户的表。第二张表显示所有朋友。但是，在`"friends"`列中的第二个表中，并非所有 id 都存在于我要删除的第一个表中。那么，如何`friends`在第二个表的列中搜索每个 id 并删除表 1 中不存在的 id？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T23:58:37.510

将这两个表放在不同的项目中（我们将它们称为`Table1`和`Table2`）。

在`Table2`上列`friends`：

*   使用“拆分多值单元格”将每个值放在单独的行上
*   将访问者列转换为数字（或反过来将 Table1 中的 user_id 转换为字符串）
*   将“基于此列添加新列”与表达式一起使用`cross(cell,'Table1','user_id').length()`

如果没有匹配，则返回 0，如果匹配则返回 1，如果 Table1 中有重复项，则返回 N>1

如果您希望数据恢复为原始格式，请设置一个方面以过滤有效性列，清除所有错误值，然后使用“连接多值单元格”来反转您之前执行的拆分操作。

我为 OpenRefine 2.6 使用 cross() 修复了一些缓存错误，所以如果交叉不起作用，请尝试停止并重新启动 Refine 服务器。

# rest - 如何使用 angularjs 客户端应用程序构建烧瓶 restful api？

> ID：14636923
> 
> 赞同：1
> 
> 时间：2013-01-31T23:16:33.877
> 
> 标签：rest, webserver, angularjs, flask, directory-structure

如何让烧瓶 api 和 angular 应用程序在同一个网络服务器上运行？现在我被困在一台服务器上运行flask-api和一个单独的节点网络服务器上的角度应用程序（使用角度种子项目）。这似乎不太理想。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T11:26:41.777

我目前处于开发阶段，但我正在使用类似的堆栈。你是对的烧瓶需要在不同的端口上使用，但只需用“（”“）”包装你的api响应。这样您就可以在 angular.js 上接受 JSONP 并使用烧瓶 api 响应。

# php - 根据 UNIX 时间戳选择即将到来的会话

> ID：14636925
> 
> 赞同：0
> 
> 时间：2013-01-31T23:17:09.733
> 
> 标签：php, unix, unix-timestamp

我有一项服务，当会话“准备好”时显示特定按钮，即提前 15 分钟并通过会话。

我这样做是通过提取所有最近请求的会话，分析它们的时间戳，然后在该会话即将到来时提取一个特定的 ID。这是代码：

```
$session_check_query = "SELECT * FROM requested_sessions WHERE username_t = '{$_SESSION['username']}'";
$session_check_process = mysql_query($session_check_query);

date_default_timezone_set($_SESSION['timezone']);
$current_time = time();

while ($sessions = mysql_fetch_array($session_check_process)) {
    if ($sessions['time_from_t'] - $current_time <= 900 && $current_time - $sessions['time_from_t'] > 0 && $sessions['accepted'] == 1) {
        $session_id = $sessions['id'];
    }
} 
```

问题是，当我在循环中回显 $session_id 时，它将输出 1、2、3、4。这意味着感觉我在数据库中的所有会话都符合这个标准，而不仅仅是一个。

这段代码有问题吗？time_from_t 是 UNIX 格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T03:17:06.753

一个可能的问题可能源于与`time()`时区无关的事实 - 它总是返回 UTC 时间（这一事实隐藏在[评论](http://www.php.net/manual/en/function.time.php#100220)中）。可以使用对象处理更强大的时区处理[`DateTime`](http://www.php.net/manual/en/book.datetime.php)：

```
$date = new DateTime('now', new DateTimeZone($_SESSION['timezone']));
$current_time = $date->format("U"); 
```

无论哪种方式，下一步都是验证您的`$current_time`变量并`time_from_t`查看数学错误的地方。

# r - 从 data.frame 列表中排除向量

> ID：14636926
> 
> 赞同：0
> 
> 时间：2013-01-31T23:17:10.620
> 
> 标签：r

我有一个包含 50 个 data.frame 对象的列表，每个 data.frame 对象包含 20 行。我需要在每次迭代时从每个 data.frame 对象中排除一行或一个向量。

单次迭代可能看起来像这样：

```
to_exclude <- 0  # 0 will be replaced by the induction variable
training_temp <- lapply(training_data, function(x) {
                                        # Exclude the vector numbered to_exclude
                                        } 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:37:45.050

```
df <- data.frame(x=1:10,y=1:10)

thelist <- list(df,df,df,df)

lapply(thelist, function(x) x[-c(1) ,] ) 
```

这将始终删除第一行。这是您想要的，还是您想根据值删除行？

这将始终排除第一列：

```
lapply(thelist, function(x) x[, -c(1) ] )

# because there are only two columns in this example you would probably 
# want to add drop = FALSe e.g.
# lapply(thelist, function(x) x[, -c(1), drop=FALSE ] ) 
```

所以从你的循环值：

```
remove_this_one <- 10
lapply(thelist, function(x) x[ -c(remove_this_one) ,] )
# remove row 10 
```

# api - Magento 更新产品的客户群价格

> ID：14636927
> 
> 赞同：2
> 
> 时间：2013-01-31T23:17:16.683
> 
> 标签：api, magento, product

我正在尝试使用 Mage 更新 Magento 中的客户组价格（因为我在 SOAP V2 API 中找不到这样做的方法）。我找到了一个 StackOverflow 示例，但它对我不起作用。我正在使用的代码如下：

```
<?php
  include_once '../App/Mage.php';
  Mage::app();

  $productID = $_GET["id"];
  $product = Mage::getModel('catalog/product')->load($productID);

  $groupPricingData = array(array('price_id'=>1,'website_id'=>0, 
                                'cust_group'=>3, 'price'=>666));

  $product->setData('group_price',$groupPricingData);
  $product->save();

  echo "true"; 

?> 
```

如果我使用已设置任何客户价格的产品，我会收到以下错误。如果我尝试没有现有价格的产品，它不会出错，但不会创建客户组价格。

```
SCREAM: Error suppression ignored for 
( ! ) Fatal error: Uncaught exception 'Mage_Eav_Model_Entity_Attribute_Exception' with
message 'SQLSTATE[23000]: Integrity constraint violation: 1062
Duplicate entry '24-0-3-0' for key 'CC12C83765B562314470A24F2BDD0F36'' in      
C:\wamp\www\magento\app\code\core\Mage\Core\Model\Config.php on line 1348 
( ! ) Mage_Eav_Model_Entity_Attribute_Exception: SQLSTATE[23000]: 
Integrity constraint violation: 1062 Duplicate entry '24-0-3-0' for   
key 'CC12C83765B562314470A24F2BDD0F36' in    
C:\wamp\www\magento\app\code\core\Mage\Core\Model\Config.php on line 1348 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T12:00:01.020

尝试将此扩展用于 magmi 团体价格：

[https://github.com/tim-bezhashvyly/magmi-grouped-price-plugin](https://github.com/tim-bezhashvyly/magmi-grouped-price-plugin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-23T17:00:47.720

我一直在网上搜寻有关如何正确“更新” Magento 产品记录上的团体价格的答案，但没有成功。倾注于 Magento 的源代码也没有让我到任何地方。但是，我发现了两种关于如何清除现有团体价格的解决方案，这样您就不会收到此错误。

1 - 直接 SQL 查询以删除现有的组价数据

```
$coreResource = Mage::getSingleton('core/resource');
$conn         = $coreResource->getConnection('core_write');
$table_name   = $coreResource->getTableName('catalog_product_entity_group_price');
$conn->delete($table_name, array('entity_id = '.$product->getId())); 
```

2-将产品的组价设置为空，并保存产品。

```
$product->setData('group_price', array())->save(); 
```

在设置您的团体价格数据和保存产品之前执行其中任何一个（无需同时执行），将避免违反完整性约束，因为它们有效地删除了产品的现有团体价格。方法 1 感觉很粗略，因为我们通常不进行直接的 sql 查询，而是依赖模型类来为我们封装这个逻辑已经内置的方法，但是在我的测试环境（Magento 1.9）中它可以工作。方法 2 可能看起来更安全，但是它更耗费资源，因为它保存了整个产品记录，而我们真正需要做的就是更新/删除现有的团体价格。另外，它需要一个多余的保存，因为我们正在“保存以删除”现有的团体价格。

我建议之后重新索引产品价格，因为组价格数据也存储在“catalog_product_index_group_price”中。

# javascript - 从未调用过 KnockoutJS 点击绑定

> ID：14636932
> 
> 赞同：0
> 
> 时间：2013-01-31T23:17:48.850
> 
> 标签：javascript, knockout.js

```
function UserModel() {
    self.forgeTransactions = function() {
        console.log("forgeTransaction()");
    }

    self.navigateToNew() = function {
        console.log("navigateToNew()");
    }
}

ko.applyBindings(new UserModel());

<button class="btn" style="float: right" data-bind:"click: forgeTransactions">Add fake transaction</button> 
```

这段代码的问题是永远不会调用forgeTransaction，而如果我将点击绑定更改为navigateToNew，我可以在控制台上清楚地看到“navigateTwo”。

为什么会这样？

注意：如果需要，我可以附上整个来源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:25:55.947

`data-bind=`你不应该写`data-bind:`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:20:30.943

您的函数已被调用`forgeTransactions`，但您正试图调用`forgeTransaction`按钮数据绑定。

# php - 更改包的 Composer git 源

> ID：14636936
> 
> 赞同：18
> 
> 时间：2013-01-31T23:17:57.463
> 
> 标签：php, github, composer-php, git-fork

我使用 Composer 和这个 composer.json 拉入一个包：

```
{
    "require": {
        "torophp/torophp": "dev-master",
    },
} 
```

当我运行`composer install`时，它似乎直接从 GitHub 中提取了这个包。

我在 github 上创建了该 repo 的一个分支，并做了一些小改动。有没有办法让作曲家在 GitHub 上提取我的版本而不是原始版本？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-01T00:23:11.437

如果这是你的`composer.json`

```
"require": {
  "torophp/torophp": "dev-master"
} 
```

并且您想更改它并改用您的 fork，只需将您的存储库添加到`composer.json`如下所示：

```
"repositories": [
   {
     "type": "vcs",
     "url": "https://github.com/your-github-username/torophp"
   }
] 
```

**重要提示**：请勿更换`"require"`零件，必须继续使用`torophp/torophp`！

添加`"repositories"`部件后，运行`composer update`（或`composer.phar update`），然后 composer 将下载您的 fork（即使它在操作期间回显“正在*安装 torophp/torophp”*）。

* * *

**更新（18.09.2014）：** *正如@efesaid 在评论中提到的：*

> 如果你的包是在 packagist 上发布的，你需要添加 `--prefer-source`从 VCS 强制安装的选项。

* * *

**注意**：对于那些从 HTTP(S) 源中提取问题的人（即`[RuntimeException] Failed to clone https://github.com/your-github-username/torophp, could not read packages from it`尝试更新时遇到的问题），您可以更改`composer.json`为使用 git 协议。为此，请进行`composer.json`如下更改并`composer update`再次运行。

```
"repositories": [
   {
     "type": "git",
     "url": "git://github.com/your-github-username/torophp.git"
   }
] 
```

* * *

现在进入`vendor/torophp/torophp`并运行`git remote -v`以仔细检查您是否使用了所需的存储库源。

从那里您可以将更改提交到您的 fork 并从源 ( `git pull origin master`) 更新它。

* * *

**更新**：要在 GitHub 上使用**私有存储库，您****必须**使用 git 协议，并且还必须为 git 客户端安装 SSH 密钥。

Composer 参考：[从 VCS 存储库加载包](http://getcomposer.org/doc/05-repositories.md#vcs)

# html - CSS 多元素高度 100%

> ID：14636939
> 
> 赞同：2
> 
> 时间：2013-01-31T23:18:04.193
> 
> 标签：html, css, height

必须有十几个具有相似标题的帖子，但我发现没有一个能够有效地完成我认为很简单的事情，即允许多个元素具有 100% 的高度。采取以下代码：

```
<html>
<head>
<style>
html, body, [role="main"] {height:100%; width:6in; overflow:hidden;}
[role="banner"] {position:fixed; top:0; left:0;}
.height {height:100%; width:100%}
</style>
</head>
<body>
<header role="banner">
<nav>
<a href="#1">Section one</a>
<a href="#2">Section two</a>
<a href="#3">Section three</a>
</nav>
</header>

<div role="main">

<section id="1" class="height">
</section>

<section id="2" class="height">
<header>
<h1>section title</h1>
</header>
<button>Navigate Articles</button>

<article class="height">
<h1>title</h1>
<p>paragraph</p>
</article>

<article class="height">
<h1>title</h1>
<p>paragraph</p>
</article>

</section>

<section id="3" class="height">
</section>

</div>

</body>
</html> 
```

我希望能够在不滚动的情况下导航。单击将您带到某个部分的链接，该部分将填充 100% 的屏幕高度。当我使用上面的代码时，我没有得到我想要的效果。在具有“高度”类的元素上使用固定位置时，我曾一度接近。它适用于第一部分，但较低的部分和第二部分中的文章会重叠。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T02:03:00.610

好的，我终于让它与纯 CSS 一起工作。问题不是从一个部分移动到另一个部分，而是控制子元素。

```
.parent { height: 100%; position: relative; overflow-y: hidden }

.child { min-height: 100%; } 
```

有关解释，请参阅此[Soure](https://stackoverflow.com/questions/9446988/expanding-the-parent-container-with-100-height-to-account-for-any-floated-conte)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:38:01.927

仅使用 CSS 实现您所要求的功能是不切实际的。由于您指的是显示和隐藏内容，因此您可能需要实现少量 javascript 以在单击导航链接时将单击操作绑定到隐藏/显示功能。

我将以下内容应用于您的代码：

**jQuery：**

```
//Hide all .height sections at first.
$('section.height').hide();

//Show them, when their respective link is clicked.
$('nav a').click(function() {
    var $this = $(this);
        section = $this.attr('href');

    $(section).siblings('.height').hide();
    $(section).show();    
}); 
```

**并更新了你的 CSS；**

```
html, body, [role="main"] { 
    height:100%;
    overflow:hidden;
}
body {
    position: relative; /*so .height is relative to body when absolutely positioned*/
}

[role="banner"] {
    background: yellow;
    position:fixed;
    top:0;
    left:0;
    z-index: 999;
}

.height {
    background: red;
    height:100%;
    width:100%;
    position: absolute;
}
h1 {
    margin-top: 30px; /* to prevent menu overlap. */
} 
```

你可以在这里看到结果：http: [//jsfiddle.net/mUEYM/2/](http://jsfiddle.net/mUEYM/2/)

基本前提是将`.height`元素设置为`position: absolute;`. 这将允许它们扩展到浏览器窗口的确切高度/宽度，前提是`html`并且`body`还具有 100% 的宽度和高度。

我`z-index`对导航应用了一个值，以确保在`.height`显示部分时它位于部分上方。

# command-line - 使用 Windows 命令行，如何将一个文件夹完全替换为另一个文件夹？

> ID：14636944
> 
> 赞同：1
> 
> 时间：2013-01-31T23:18:41.470
> 
> 标签：command-line, batch-file, cmd, xcopy

到目前为止，我已经将它复制到可以将所有文件`c:\Users\John\Folder1`从`c:\Users\John\Folder2`.

但我希望完全交换文件夹。

例如替换`c:\Users\John\Folder1` 为`c:\Users\John\SomeFolder\Folder1`.

我现在有这个：`xcopy c:\Users\John\SomeFolder\* c:\Users\John\Folder1 /s /i`

这只是从`c:\Users\John\SomeFolder\Folder1`to复制所有文件，`c:\Users\John\Folder1`但保留之前存在的文件。我想要替换整个文件夹。如果我正在复制的新文件夹不再有这些文件，我希望将它们删除。

抱歉，如果这令人困惑 - 非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-17T09:50:23.310

这会将第一个文件夹镜像到第二个文件夹。

要**非常**小心路径是正确的。

```
@echo off
robocopy "c:\Users\John\SomeFolder\Folder1" "c:\Users\John\Folder1" /mir 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:48:38.197

我认为您可以创建一个批处理文件来执行此操作。

**伪代码：**

1.  擦除目录 1 的内容
2.  将目录1的内容复制到目录2

**代码：**在记事本中 创建一个名为的文件`swapFiles.bat`，然后输入以下代码：

```
rd /s %1
mkdir %1
xcopy /s /i %2\* %1 
```

***如何使用它：***

```
swapFiles c:\Users\directory1 c:\Users\directory2 
```

`directory1`是`old`目录（即将被清除的目录）

希望这可以帮助你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T00:16:23.810

也许我完全没有理解你的意思，但这不会起作用吗？（例子）：

```
rename Folder1 transit
rename Folder2 Folder1
rename transit Folder2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T08:54:33.823

您是否要在复制文件夹 1 之前删除此文件夹 c:\Users\John\SomeFolder 如果是这样，此代码可能适合您

```
@echo off

robocopy /s c:\Users\John\Folder1 c:\Users\John\SomeFolder\Folder1
rmdir /s /q c:\Users\John\Folder1 
```

# ruby-on-rails-3 - best_in_place 更新后更新各种 DOM 元素

> ID：14636946
> 
> 赞同：1
> 
> 时间：2013-01-31T23:18:43.140
> 
> 标签：ruby-on-rails-3, best-in-place

在使用 best_in_place 更新 DOM 元素后，我在表中有需要更新的各种值。在最佳就地更新之后，如何触发一个名为“update.js.erb”的“create.js.erb”之类的 JavaScript 操作？

例如，我有一个商品价格表，我需要在用户更新单个商品数量后更新该表的“总计”字段。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T23:18:43.140

我见过很多人问这个问题，但还没有找到满意的解决方案。我发现最好的方法是创建一个 javascript 函数，在 ajax:success 之后监视特定 DOM 元素的更新，然后使用 jQuery 更新指定的 DOM 元素。

在要更新的项目的控制器中，我打包了一个 JSON 响应，其中包含我的 javascript 更新 DOM 元素所需的所有信息。

您会看到我还将新表格行的部分呈现为 HTML 字符串，并将该字符串与 JSON 响应一起传递。

```
___Item Controller_____

    respond_to do |format|
  if @item.update_attributes(params[:item])

    #json response variables to refresh table row after update
    id = [@item]  
    new_row = render_to_string('items/_item.html', :layout => false, :locals => { :item => @item })
    #----------json-variables-----------#

    format.json { render :json => { new_row: new_row, id: id, :status => 200 }}
    format.js   
  else
    format.json { render :json => @item.errors.full_messages, :status => :unprocessable_entity }
    format.js
  end
end 
```

然后在与页面一起加载的 .js 文件中（如 application.js），我包含一个函数，用于监视要更新的具有“row_class”类的表行。

```
$(document).ready(function(row_class, row_id_prefix){

$("." + row_class).on("ajax:success",function(event, data, status, xhr){
    var parsed_data = jQuery.parseJSON(data); //parses string returned by controller into json object

    var id = parsed_data["id"];
    var new_row = parsed_data["new_row"]; //this is an html string that replaces the existing table row

    $('tr#' + row_id_prefix + id).replaceWith(new_row);
    $('tr#' + row_id_prefix + id).effect('highlight');
    $('.best_in_place').best_in_place(); //activates in-place-editing for newly added content.      
})); 
```

您可以修改 jQuery 以更新您需要的任何 DOM 元素。此外，如果您需要在对象上调用的 ruby​​ 方法的结果（例如人性化总计、税收总计等），您可以将这些定义为控制器中 JSON 对象中的变量。

最终，如果 best_in_place 会触发（在这种情况下） items/update.js.erb 脚本，那将是最好的，但它看起来不像在路线图上。

# r - 使用starcluster在亚马逊EC2上的R和雪

> ID：14636950
> 
> 赞同：7
> 
> 时间：2013-01-31T23:18:50.493
> 
> 标签：r, amazon-web-services, amazon-ec2

我正在尝试在 AWS EC2 集群上的 R 中并行运行分析。我正在使用 starcluster 来设置和管理 EC2 集群，并尝试在 R 中使用`snow`和 `foreach`。首先，我在集群中有 2 个节点，1 个主节点和 1 个工作节点。

```
starcluster start mycluster 
starcluster listinstances

-----------------------------------------
mycluster (security group: @sc-mycluster)
-----------------------------------------
....
Cluster nodes:
     master running i-xxxxxxxxx masterIP.compute-1.amazonaws.com
    node001 running i-xxxxxxxxx node001IP.compute-1.amazonaws.com
Total nodes: 2

starcluster sshmaster mycluster 
```

然后我启动 R 并加载`snow`包并尝试创建一个集群对象。

```
R
library("snow")

cl = makeCluster(c("masterIP.compute-1.amazonaws.com", "node001IP.compute-1.amazonaws.com"), type = "SOCK") 
```

但是，这给了我以下错误消息：

```
The authenticity of host 'masterIP.compute-1.amazonaws.com (xx.xxx.xx.xx)' can't be established.
ECDSA key fingerprint is xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'masterIP.compute-1.amazonaws.com,xx.xxx.xx.xx' (ECDSA) to the list of known hosts.
Permission denied (publickey). 
```

因此，我尝试将我的 ssh 密钥（`keyname.rsa`具体而言）复制到 EC2 上的 .ssh 文件并再次尝试。那仍然没有用；我收到了同样的 `Permission denied (publickey).`错误。我认为 starcluster 处理了 ssh 的设置和节点之间的通信，所以我有点困惑为什么我无法设置它。我也尝试只添加 node001, so `cl = makeCluster(c("node001IP.compute-1.amazonaws.com"), type = "SOCK")`，但发生同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T06:45:39.173

事实证明，经过多次修改，所需要的只是更新到 R 版本 2.15。之后该命令`cl = makeCluster(c("masterIP.compute-1.amazonaws.com", "node001IP.compute-1.amazonaws.com"), type = "SOCK")`完美运行。

# jquery - BlackBerry bbUI 应用程序中 Flot 图表的画布尺寸太大

> ID：14636956
> 
> 赞同：3
> 
> 时间：2013-01-31T23:19:18.067
> 
> 标签：jquery, flot, blackberry-webworks, blackberry-10

我在也使用[bbUI.js](https://github.com/blackberry/bbUI.js/)工具包的 BB10 WebWorks 应用程序中使用[Flot](http://www.flotcharts.org/)折线图。

使用 Ripple 模拟器运行应用程序时，图表大小是正确的 (1000x500)。但是，当我将应用程序部署到设备（Dev Alpha）时，图表尺寸太大（2243x1121）。

使用 Web Inspector 我发现画布元素的宽度和高度属性超过了占位符大小：

```
<div id="weight-chart" style="width: 1000px; height: 500px; 
     padding: 0px; position: relative;">
  <canvas class="flot-base" 
     style="direction: ltr; position: absolute; left: 0px; top: 0px; 
            width: 1000px; height: 500px;" 
     width="2243" height="1121">
  </canvas>
  <canvas class="flot-overlay" 
    style="direction: ltr; position: absolute; left: 0px; top: 0px; 
           width: 1000px; height: 500px;" 
    width="2243" height="1121">
  </canvas>
</div> 
```

这是 HTML 页面片段：

```
<div data-bb-type="screen" data-bb-scroll-effect="on" id="chart-page" 
     data-bb-indicator="true">

  <!-- chart goes here: -->
  <div id="weight-chart" style="width:1000px;height:500px;"></div>

  <div data-bb-type="action-bar" data-bb-back-caption="Back"></div>
</div> 
```

这是完成的对 Flot 的 javascript 调用`ondomready`：

```
bb.init({onscreenready: function(element, id, params) {
  }, 
  ondomready: function(element, id, params) {
    if (id == 'chart') {
      chartDataset = ...
      chartOptions = ...
      $.plot($("#weight-chart", element), chartDataset, chartOptions);
      element.getElementById('chart-page').refresh();
    }
}); 
```

你对正在发生的事情有任何线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T09:32:35.703

您只需要在 JS 中找到这一行：

```
this.pixelRatio = devicePixelRatio / backingStoreRatio; 
```

并替换为：

```
this.pixelRatio = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-28T01:48:57.043

您的问题是实现不同大小的图表，因此您需要调整大小。你应该一起使用：

```
jquery.flot.js 
jquery.flot.resize.min.js 
```

# objective-c - 将目标 C 程序中的程序异常/错误报告给开发人员

> ID：14636960
> 
> 赞同：0
> 
> 时间：2013-01-31T23:19:33.190
> 
> 标签：objective-c, macos

我正在将 C# 应用程序移植到 mac osx，在程序的 C# 版本中，我们有一个 try catch() 块，它捕获程序抛出的任何异常，这可能是空指针异常或我们没有捕获的任何异常。

然后顶级异常处理程序询问用户是否愿意报告它，当用户说报告时，将异常堆栈报告给我们。这有助于识别错误。

在我的 OSX 应用程序中，C/C++ 程序的后端部分与 Objective C 中的用户界面

目标 C 程序中是否有类似的功能？如果没有，是否有其他方法可以从程序内报告、异常或错误报告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:42:23.983

就异常而言，对于非致命错误，NSError 实际上优于 Objective-C 中的异常。这在 Apple 的[Exception Programming Topics: Introduction to Exception Programming Topics for Cocoa](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Exceptions/Exceptions.html)文档中有描述：

> **重要提示：**您应该将异常用于编程或意外的运行时错误，例如越界集合访问、尝试改变不可变对象、发送无效消息以及失去与窗口服务器的连接。
> 
> ...
> 
> 代替异常，错误对象（[NSError](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSError_Class/Reference/Reference.html#//apple_ref/occ/cl/NSError)）和 Cocoa 错误传递机制是在 Cocoa 应用程序中传达预期错误的推荐方式。有关详细信息，请参阅[错误处理编程指南](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ErrorHandlingCocoa/ErrorHandling/ErrorHandling.html#//apple_ref/doc/uid/TP40001806)。

[Using NSError to Great Effect](http://www.cimgf.com/2008/04/04/cocoa-tutorial-using-nserror-to-great-effect/)是关于 NSError 的一个很好的教程（除了前面链接的错误处理文档）。

至于崩溃/致命错误报告，请参阅[“Crash Reporter for Cocoa app”问题](https://stackoverflow.com/questions/1110986/crash-reporter-for-cocoa-app)以了解许多选项。

# .net - .NET 服务参考，不使用配置文件

> ID：14636979
> 
> 赞同：0
> 
> 时间：2013-01-31T23:21:42.557
> 
> 标签：.net, wcf, web-services

我过去一直在使用 Web 引用，但开始使用 Web 服务的服务引用来调用第三方 Web 服务。我发现的一个主要区别是服务引用将信息放在配置文件中。我正在创建一个 DLL 文件，它将对服务引用的 Web 服务进行所有调用。当我将该 DLL 引用到另一个项目时，我不想将配置信息添加到新项目中。在使用 Web 引用时，除了包含 Web 引用的 DLL 之外，不需要使用任何东西。不需要配置数据。有没有办法使用服务引用获得相同的行为，或者它们是否依赖于配置文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:32:04.123

就在这里。

.config 文件是一种无需重新编译即可更改行为的精美而灵活的方法。

您可以在 .config 中设置的所有内容都可以通过编程方式进行设置，因此您可以：

*   硬编码源代码中的定义
*   从数据库或任何其他可信来源获取定义

需要允许封装服务引用的项目具有由其他项目定义的设置 Web 引用设置。

# java - 同步队列？

> ID：14636985
> 
> 赞同：0
> 
> 时间：2013-01-31T23:22:05.387
> 
> 标签：java, synchronization, thread-safety, queue, blockingqueue

我有两个线程用于制作在线游戏。一个线程接收两个 X 和 Y 数字，另一个线程将 X 和 Y 数字发送给登录到服务器的每个人。基本上我需要一个队列，这将允许第一个线程将 2D 数组添加到队列中，并继续这样做，同时拉出数组并从队列中删除数组以用于发送到其他玩家。有没有办法做到这一点？我知道我需要一个同步队列，但是我如何同步一个，这叫阻塞队列吗？

总的来说，我需要一个同步的队列，这将允许两个线程投入和取出东西。可能吗？

-担

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-31T23:40:18.617

阻塞队列是一个队列，其中：

1.  向其中添加元素，在队列上没有可用空间的情况下阻塞调用者线程，直到元素被删除（由其他线程）；
2.  从中删除元素，在没有任何元素要删除的情况下阻塞调用者线程，直到它添加的元素（由其他线程）。

为了实现*线程安全*（尽管不一定同步）队列的功能，您通常会使用`BlockingQueue`的实现之一，例如`LinkedBlockingQueue`.

# django - 在 Django 中捕获错误的 % 编码 URL 以返回自定义“错误 400”页面

> ID：14636986
> 
> 赞同：1
> 
> 时间：2013-01-31T23:22:10.423
> 
> 标签：django, url, encoding, percent-encoding

有时，其他网站使用错误的百分比编码 URL 链接到我们的 Django 支持的网站。Disqus.com 和 Twitter.com 确实有同样的问题，所以我们的用例没有什么特别之处：http: [//disqus.com/%C3A4](http://disqus.com/%C3A4)。在此 URL 中，缺少第二个 %。有效的 URL 如下所示：[http ://disqus.com/%C3%A4](http://disqus.com/%C3%A4)

Django 返回一个空的错误 400（错误请求）页面。但是，我们想捕捉错误，而不是返回一个普通的非信息页面，我们希望至少向我们的用户展示我们的自定义 404 页面。甚至更好的是，我们想检查输入 URL 是否缺少 %-characters 或任何类似的东西来验证其格式。MiddleWare/process_request 即使出现 400 错误也会被调用，所以我们确实有一个钩子来捕获错误。

我们想在我们的网站上解决这个问题。有没有最佳实践...？一个 handler400 会很棒 - 是否可以自己创建一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T12:11:37.713

在您的模板中创建 404.html，然后将其放入您的 urls.py

```
#handle the errors    
from django.utils.functional import curry
from django.views.defaults import *

handler404 = curry(page_not_found, template_name='404.html')

You can also handle other errors like this:
handler500 = curry(server_error, template_name='500.html')
handler403 = curry(permission_denied, template_name='403.html') 
```

处理任何类型的错误。你会在这里得到一个想法。

```
https://github.com/Roejames12/django-error-pages 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T08:34:33.430

正如 Cathy's aswer 中已经以评论的形式发布的那样，这非常好，但在这种特殊情况下不起作用，我在这里发布了我们当前的、略显老套的解决方案作为另一个答案：

显然，这个错误不能在 Django 的 MiddleWares 中被覆盖。这是在 \django\core\handlers\wsgi.py 中的 WSGIHandler 内部触发的 UNICODE 解码错误。准确的说是

```
path_info = force_unicode(environ.get('PATH_INFO', u'/')) 
```

在 WSGIRequest 内部，这导致了问题。这基本上是 Django 的正确行为，但正如我的问题中所述，我们只是想向我们的用户展示一些比空的错误页面更有用的东西。因此，我们在将传入的 URL 请求传递给我们的 WSGIHandler 之前检查有效的 UNICODE 字符。这篇博文为我们指明了正确的方向：[http ://codeinthehole.com/writing/django-nginx-wsgi-and-encoded-slashes/](http://codeinthehole.com/writing/django-nginx-wsgi-and-encoded-slashes/)

因此，我们在 wsgi.py 中重新路由无效 URL，如下所示：

```
os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'

import django.core.handlers.wsgi
_application = django.core.handlers.wsgi.WSGIHandler()

# for Django 1.7+
# from django.core.wsgi import get_wsgi_application
# _application = get_wsgi_application()

from django.utils.encoding import force_unicode
def application(environ, start_response):
    try:
        path_info = force_unicode(environ.get('PATH_INFO', u'/'))
    except:
        environ['PATH_INFO'] = u'/'
    return _application(environ, start_response) 
```

相反，子类化 WSGHandler 也应该有效。在此示例中，我们只是将无效 URL 重定向到我们的站点根目录“/”。但是您也可以重定向到任何自定义错误页面 URL，或者您可以尝试清理您的 URL……它对我们有用，但也许有更好的解决方案。

# jquery - JQuery Div 在滚动时跟随顶部/底部间隙

> ID：14636988
> 
> 赞同：0
> 
> 时间：2013-01-31T23:22:12.387
> 
> 标签：jquery, html, scroll, fixed

滚动页面时我需要一个固定的 div，但在顶部和底部值之间。现在我有这个代码并且它可以工作，但是当我找到页面底部时，我找不到停止它的解决方案。 . 我想要一个 400px 的底部间隙（我的页脚的高度）..

```
jQuery(document).ready(function () {
    var el = jQuery('#news_right_cont');
    var elpos = el.offset().top;
    var gap = 174;
    jQuery(window).scroll(function () {
        var y = jQuery(this).scrollTop();
        if (y < elpos) {
            el.stop().animate({
                'top': 174
            }, 0);
        } else {
            el.stop().animate({
                'top': y - elpos + gap
            }, 0);
        }
    });
}); 
```

我希望你能找到一个解决方案..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:52:47.317

您可以使用以下内容来查找滚动是否已到达页面底部

```
 if (document.documentElement.clientHeight + y >= document.body.offsetHeight) {
        //add your conditions                
    } 
```

而不是你的 if else

```
if (y < elpos) {
            el.stop().animate({
                'top': 174
            }, 0);
        } else {
            el.stop().animate({
                'top': y - elpos + gap
            }, 0);
        } 
```

添加以下内容

```
if (document.documentElement.clientHeight + y + 400 < document.body.offsetHeight) {
                             el.stop().animate({ top: y - elpos + gap }, 0);
            } 
```

您基本上只在限制范围内滚动。`document.documentElement.clientHeight + y + 40 中的数字 400 你可以根据你的页脚位置进行修改

# c++ - 字符串解析来操作每个标记（没有 STL）

> ID：14636989
> 
> 赞同：0
> 
> 时间：2013-01-31T23:22:28.770
> 
> 标签：c++, string, parsing

这是一个家庭作业问题，但我已经完成了，这只是为了我的理解。补充一下，我不能使用 STL :(

基本上，我们要实现一个“学生”类，它有 5 个参数（名字/姓氏、ID、年级和专业）。然后每个学生对象必须存储在一个数组中（我们称之为教室）。

当用户添加新学生时，我的问题就出现了。起初我的代码只是像这样获取每个参数：

```
cin >> first >> last >> id >> grade >> major; 
```

然后将它们传递给另一个将其存储在数组中的函数。如果用户按应有的方式输入所有内容，这可以正常工作，例如输入：

```
students> add John Smith 123 Freshman Computerscience 
```

但是当输入不正确时，特别是使用 ID 输入（它是一个 int），如下所示：

```
students> add John Smith 123abc Freshman Computerscience 
```

它将以“abc”作为成绩，以“新生”作为专业，其余的都会出现错误。

所以我决定将整个输入作为一个字符串解析出来，代码如下：

```
 class Student {
    private:
        string first_name;
        string last_name;
        int ID;
        string classification;
        string major;
    public:
        Student();

        /* Main class functions */
        void add(string, string, int, string, string);
        void print(string);
        bool remove(int);

        /* Helper class functions */
        bool empty();
        bool ifexist(int);
    };

  int main() 
     {
        bool done = false;
        string command, first, last, grade, major;
        int id;
        string query, input;
        string inputArray[6];
        string token = " ";
        while(!done) {
            cout << prompt;
            cin >> command;

            if(command == "add")
            {
                /* Get new student info */
                cin >> first >> last >> id >> grade >> major;;

                // this commented code is my attempt to fix error
                // count = 0;
                // while(getline(cin, input)) {
                //  stringstream s(input);
                //  while(s >> token) {
                //      inputArray[count] = token;
                //      count++;
                //  }
                //  if(count == 5) break;
                // }

                // first = inputArray[0];
                // last  = inputArray[1];
                // if(atoi(inputArray[2].c_str()))
                //  id= atoi(inputArray[2].c_str());
                // else cout << ERROR_INPUT << endl; 
                // grade = inputArray[3];
                // major = inputArray[4];

                // for (int i=0; i<5; i++) {
                //  cout << inputArray[i] << endl;
                // }
                //cout << first << endl << last << endl << id << endl << grade << endl << major << endl;

                int i = getInsertPoint();
                bool e = ifexist(id);

                /* Check if student already exists */
                if(e) cout << "Error! Already exists, try again" << endl;
                else  classroom[i].add(first, last, id, grade, major); 
            }
            else if(command == "print") 
            {
                /* Get query type to be printed (ex: firstname) */
                cin >> query;
                print(query);
            }
            else if(command == "remove")
            {
                cin >> id;
                remove(id);
            }
            else if(command == "quit") done = true;
            else cout << ERROR_INPUT << endl;
        }
        return 0;
    } 
```

我可以打印出数组，一切都很好，但是当我将每个数组传递给将它存储在对象中的函数时，什么也没有出现。但是，当我使用我提到的第一个代码时，它确实有效。

所以我的问题是：有没有更好的方法来解析/检查输入字符串（不带 STL），允许我将每个令牌单独发送到另一个函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:52:53.867

您的循环结构有些损坏。根据您的意图，这可能是一个问题：

```
while(getline(cin, input)) {
    stringstream s(input);
    while(s >> token) {
      inputArray[count] = token;
      count++; 
```

在这里，您将愉快地继续，即使您累积的单词超过了您的数组可以处理的 6 个单词。如果发生这种情况，程序的行为将变得不确定。

```
 }
    if(count == 5) break; //got everything I need 
```

因此，如果您恰好累积了 5 个单词（您的数组可以容纳的 6 个单词），您将处理这五个单词。如果少于 5 个单词，则从下一行继续累积额外的单词。只有在“解析”一个或多个（最多 5 个）非空行产生正好 5 个单词时，您才会停止。如果您超过了 5 个字的限制（例如，如果第一行有 4 个字，第二行至少有 2 个字），您将继续直到输入结束或程序崩溃，因为您正在写满内存。

```
 } 
```

您的使用`atoi()`将接受无效输入（如“123abc”）。另一方面，当空间意外丢失时（“123Freshman”），您的代码将出现异常。

所以我对你的问题的回答是：是的，有更好的方法来解析和检查输入。但除非您能清楚地说明输入规则，否则我们无法帮助您修复代码。当您询问“将每个令牌单独发送到另一个功能”的方法时，您的意思也不清楚。

逐字逐句，答案将是：

```
string token;
while (getline(cin, token)) { 
   another_function(token);
} 
```

如果您不向我们展示一个完整的示例（代码和输入），我们无法告诉您为什么“当 [您] 将每个传递给将其存储在对象中的函数时”事情不起作用：您期望什么发生，你所看到的。如果您也不向我们展示该代码，我们也无法告诉您为什么结果与“[您]提到的第一个代码。”不同。

# android - 发送电子邮件给出 SSLProtocolException

> ID：14636992
> 
> 赞同：0
> 
> 时间：2013-01-31T23:23:09.160
> 
> 标签：android, email, ssl-certificate, sendmail

我正在使用这个示例代码：

[http://www.jondev.net/articles/Sending_Emails_without_User_Intervention_%28no_Intents%29_in_Android](http://www.jondev.net/articles/Sending_Emails_without_User_Intervention_%28no_Intents%29_in_Android)

我正在尝试使用我自己的服务器电子邮件在 Android 上无意发送电子邮件。

我知道该示例配置为仅适用于 Gmail。

**我改变了：**

```
 _host = "smtp.myserver.com"; // default smtp server 
    _port = "587"; // default smtp port 
    _sport = "587"; // default socketfactory port 
```

**这在 MainActivity 上：**

```
Mail m = new Mail("username@myserver.com", "password"); //to my sever email 
```

我只是在 Outlook 上设置了正确的信息，它可以工作，我可以从这封电子邮件发送和接收。

**服务器允许此设置：**

POP3 SMTP IMAP WebMail 移动/PDA

**问题：**

我需要添加/更改更多内容吗？或者此示例不能与其他 gmail 一起使用。

**我在 Logcat 上收到此错误：**

```
 01-31 21:07:08.989: E/MailApp(17094): Could not send email
    01-31 21:07:08.989: E/MailApp(17094): javax.mail.MessagingException: Could not connect to SMTP host: smtp.semhora.com, port: 587;
    01-31 21:07:08.989: E/MailApp(17094):   nested exception is:
    01-31 21:07:08.989: E/MailApp(17094):   javax.net.ssl.SSLProtocolException: SSL handshake aborted: ssl=0x1e4490: Failure in SSL library, usually a protocol error
    01-31 21:07:08.989: E/MailApp(17094): error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol (external/openssl/ssl/s23_clnt.c:683 0xad12957d:0x00000000)
    01-31 21:07:08.989: E/MailApp(17094):   at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1391)
    01-31 21:07:08.989: E/MailApp(17094):   at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:412)
    01-31 21:07:08.989: E/MailApp(17094):   at javax.mail.Service.connect(Service.java:310)
    01-31 21:07:08.989: E/MailApp(17094):   at javax.mail.Service.connect(Service.java:169)
    01-31 21:07:08.989: E/MailApp(17094):   at javax.mail.Service.connect(Service.java:118)
    01-31 21:07:08.989: E/MailApp(17094):   at javax.mail.Transport.send0(Transport.java:188)
    01-31 21:07:08.989: E/MailApp(17094):   at javax.mail.Transport.send(Transport.java:118)
    01-31 21:07:08.989: E/MailApp(17094):   at com.example.sendemailtester.Mail.send(Mail.java:102)
    01-31 21:07:08.989: E/MailApp(17094):   at com.example.sendemailtester.MainActivity$1.onClick(MainActivity.java:33)
    01-31 21:07:08.989: E/MailApp(17094):   at android.view.View.performClick(View.java:2485)
    01-31 21:07:08.989: E/MailApp(17094):   at android.view.View$PerformClick.run(View.java:9080)
    01-31 21:07:08.989: E/MailApp(17094):   at android.os.Handler.handleCallback(Handler.java:587)
    01-31 21:07:08.989: E/MailApp(17094):   at android.os.Handler.dispatchMessage(Handler.java:92)
    01-31 21:07:08.989: E/MailApp(17094):   at android.os.Looper.loop(Looper.java:130)
    01-31 21:07:08.989: E/MailApp(17094):   at android.app.ActivityThread.main(ActivityThread.java:3687)
    01-31 21:07:08.989: E/MailApp(17094):   at java.lang.reflect.Method.invokeNative(Native Method)
    01-31 21:07:08.989: E/MailApp(17094):   at java.lang.reflect.Method.invoke(Method.java:507)
    01-31 21:07:08.989: E/MailApp(17094):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
    01-31 21:07:08.989: E/MailApp(17094):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
    01-31 21:07:08.989: E/MailApp(17094):   at dalvik.system.NativeStart.main(Native Method)
    01-31 21:07:08.989: E/MailApp(17094): Caused by: javax.net.ssl.SSLProtocolException: SSL handshake aborted: ssl=0x1e4490: Failure in SSL library, usually a protocol error 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:29:58.280

我从未使用过这个包装器，但代码假设支持 SSL，而您的端口 587 服务器似乎不支持 SSL。注释掉这两行

```
props.put("mail.smtp.socketFactory.port", _sport); 
props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory"); 
```

并将这一行从 false 设置为 true

```
props.put("mail.smtp.socketFactory.fallback", "false"); 
```

这可能会有所帮助。

# highcharts - Highcharts 条形图工具提示多个内容窗格在 FireFox 中制动

> ID：14636994
> 
> 赞同：1
> 
> 时间：2013-01-31T23:23:12.637
> 
> 标签：highcharts, bar-chart, tooltip, contentpane

我创建了一个使用内容窗格的应用程序。每个页面都在主内容窗格中加载，其他页面以选项卡格式打开，因此用户可以来回翻转而不必重新加载页面。

我在每个页面上添加了多个 Highchart 图表。一切看起来都很棒！当用户单击每个页面时，图表加载正常。当您单击每个选项卡/页面时，条形图看起来不错；但是，工具提示仅适用于 FireFox 中的第一个条形图。令人惊讶的是，IE 可以正常工作，并且页面上的其他图表显示工具提示很好。

每个图表都有一个唯一的 ID。我注意到以相同方式使用的其他图表（饼图）可以正常工作并按预期显示工具提示。这个问题似乎与条形图有关。

有任何想法吗？

# php - php反射获取属性而不获取基类的属性

> ID：14636999
> 
> 赞同：3
> 
> 时间：2013-01-31T23:24:01.130
> 
> 标签：php, reflection

所以我正在使用一个设置类，它扩展了一个类似于“全局设置”的基本设置类。有几个服务，每个服务都有自己的设置类，扩展了抽象的基本设置类。抽象基本设置类对应于服务之间共享的设置。因此，首先我将通过下面的示例进行说明，然后我将定义问题：

例子：

```
abstract class BaseSettings {
    protected $settingA;
    protected $settingB;
}

class MyServiceSettings extends BaseSettings {
    private $settingC;
    public $settingD;
} 
```

问题：

如果我像这样创建一个 ReflectionClass 实例..

```
$reflect = new ReflectionClass($this); 
```

..来自 MyServiceSettings 类或 BaseSettings 类（因为显然你不能拥有抽象类的实例），`$reflect->getProperties()`将始终返回 MyServiceSettings 和 BaseSettings 的属性（我想这是合适的，因为我们真的在工作有一个具体的类）

现在我确信我可以创建一个空类来扩展抽象 BaseClass 以确定哪些属性去哪里（或者只是摆脱抽象并创建 BaseClass 的实例），但这看起来相当混乱，所以我想知道是否也许有一种更优雅的方法来确定哪些属性属于父类，哪些属于子类？

如果您好奇我为什么要这样做 - 我正在将设置序列化为 .json 文件，以实现我添加的恢复功能，以便可以从上次成功完成的最后一个原子操作继续。为什么我必须这样做——环境的限制。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T23:35:46.820

我会这样：

```
$class = new ReflectionClass('Some_class_name');
$properties = array_filter($class->getProperties(), function($prop) use($class){ 
    return $prop->getDeclaringClass()->getName() == $class->getName();
}); 
```

所以基本上获取所有属性并遍历它们，检查它们是否在我们反映的类中声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T20:54:48.230

虽然上述方法仅用于获取 的设置`MyServiceSettings`，但当您从类调用此方法时`BaseSettings`，它仍会返回扩展它的类的属性（只要您正在处理该类具有的`BaseSettings`类的实例`BaseSettings`被另一个类扩展——不管这个`BaseSettings`类是抽象的还是具体的）至少当你在基类中引用`$this`基类时。

也许有更好的解决方法，但我发现的方法是简单地使用

```
$reflectionClass = new ReflectionClass(get_parent_class($this)); 
```

只是为了说明如何使用它，这里是我用来反序列化类及其基类的函数的改编：

```
// "attribute" to be used in doc comments if it should not be
// serialized / deserialized
// ( remember: /** ... */ doc comments must have two asterisks!! )
private $DoNotSerialize = "[@DoNotSerialize]";

protected function dehydrate(ReflectionClass $reflectionClass) {

    // if you're using private or protected properties and need to use 
    // $property->setAccessible()
    if(floatval(phpversion()) < 5.3) {
        throw new Exception("requires PHP version 5.3 or greater");
    }

    clearstatcache();

    $properties = array_filter(
        $reflectionClass->getProperties(ReflectionProperty::IS_PROTECTED|ReflectionProperty::IS_PUBLIC)
        , function($prop) 
            use($reflectionClass) {
                return $prop->getDeclaringClass()->getName() == $reflectionClass->getName();
          }
     );

    $settings = null;

    foreach($properties as $property) {

        $comment = $property->getDocComment();
        if( strpos($comment,$this->DoNotSerialize) !== false ){
            continue;
        }

        if($property->isProtected()){
            $property->setAccessible(TRUE);
        }

        if(isset($settings)) {
            // implementation of array_push_associative
            // can be found at http://php.net/manual/en/function.array-push.php
            array_push_associative(
                $settings
                , array($property->getName() => $property->getValue($this))
            );
        }
        else {
            $settings = array($property->getName() => $property->getValue($this));
        }
    }

    //implementation irrelevant here
    writeToFile($reflectionClass->getName(), $settings);

    if(get_parent_class($reflectionClass)) {
        $this->dehydrate(get_parent_class($reflectionClass));
    }
} 
```