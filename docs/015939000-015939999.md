# StackOverflow 问答 15939000-15939999

# java - Java中受保护的访问修饰符

> ID：15939002
> 
> 赞同：10
> 
> 时间：2013-04-11T00:48:00.327
> 
> 标签：java, protected, access-modifiers

我在理解 java 中受保护的访问修饰符（或其背后的设计）时遇到了一些麻烦。我认为这意味着包访问和通过继承包含抽象成员的类的对象进行访问。

我编写了以下示例代码。我看到如果未注释，注释掉的行会产生编译错误。为什么我可以通过 Second 中的 Second 对象访问 pro 而不能通过 Second 中的 First 对象？

```
package first;

public class First {

    protected void pro(){
        System.out.println("Can see protected method");
    }

} 
```

* * *

```
package first;

public class InFirst {

    public static void main(String[] args){
        First fst = new First();
        fst.pro();
    }

} 
```

* * *

```
package second;

import first.First;

public class Second extends First {

    public static void main(String[] args){

        First fst = new First();

//      fst.pro();

        Second sec = new Second();
        sec.pro();

    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-11T08:57:24.640

链接的[网页](http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)@MadProgrammer 给出了一个不错的解释：

> “受保护的修饰符指定该成员只能在其自己的包中访问（与包私有一样），此外，它的类在另一个包中的子类也可以访问。”

这意味着必须通过定义它的类或该类的子类直接访问受保护的成员，同时也必须位于适当的包中。这并不一定意味着您可以通过在所述类的子类中创建的所述类的实例来访问受保护的成员。重点是所涉及的软件包。

## 以下是您的示例：

```
package first; // Current package

First fst = new First(); // from package first and does not extend anything
fst.pro(); 
```

试图从哪个包访问有问题的成员？**第一的**

包含所述成员的（子）类或其继承成员的父类是否在同一个包中定义？**是的，`First`在 中定义`package first`，因此可以从中`protected`访问该成员。`First``package first`**

```
package second; // Current package

First fst = new First(); // from package first and does not extend anything
fst.pro(); 
```

试图从哪个包访问有问题的成员？**第二**

包含所述成员的（子）类或其继承成员的父类是否在同一个包中定义？**不，`First`在 中定义`package first`，因此`protected`使成员无法从`First`中访问`package second`。**

```
package second; // Current package

Second sec = new Second(); // from package second and extends First from package first
sec.pro(); 
```

试图从哪个包访问有问题的成员？**第二**

包含所述成员的（子）类或其继承成员的父类是否在同一个包中定义？**是的，`Second`在 中定义的`package second`，从 中继承成员`First`，因此`protected`可以从`Second`中访问该成员`package second`。**

## 为了清楚起见，更多示例：

```
package first; // Current package

Second sec = new Second(); // from package second and extends First from package first
sec.pro(); 
```

试图从哪个包访问有问题的成员？**第一的**

包含所述成员的（子）类或其继承成员的父类是否在同一个包中定义？**是的，`Second`继承了在`First`中定义`package first`的成员，因此`protected`可以从`Second`中访问该成员`package first`。**

```
package first; // Current package

Third third = new Third(); // from package third and extends Second from package second,
                           // which extends First from package first
third.pro(); 
```

试图从哪个包访问有问题的成员？**第一的**

包含所述成员的（子）类或其继承成员的父类是否在同一个包中定义？**是的，`Third`从 继承成员`Second`，它从`First`定义成员的位置（`package first`）继承它，因此`protected`可以从`Third`in访问该成员`package first`。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T00:51:41.123

![受保护与默认](https://i.stack.imgur.com/FEGP6.jpg)这是显示访问级别的图表。您的代码属于图中 Convertible 中的 R(Reference) 案例。即不允许访问另一个包中的子类中的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-06T15:30:22.707

java中受保护的成员

相同的包-（它的行为类似于默认）

它可以在同一个类、它的子类和非子类中访问。（它的行为类似于默认值）您甚至可以使用父或子引用访问受保护的成员。

外包装——

它只能由 itz 子类访问，这里最重要的一点是使用的引用必须仅属于同一个子类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T00:52:08.390

protected 表示对同一包中的其他类可见。由于 Second 位于不同的包“second.Second”中，因此它无法首先访问 .pro()。

如果您在“first”的包名称下创建了 Second - 它就会起作用。

# ruby - 如何动态地乘以代码文本？

> ID：15939004
> 
> 赞同：0
> 
> 时间：2013-04-11T00:48:38.160
> 
> 标签：ruby, loops

我的 Ruby 代码中有一个代码片段：

```
while words.size >= 3
  frequency["#{words[0]} #{words[1]} #{words[2]}"] += 1
  words.shift
end 
```

我想设置一个变量`i`，并根据 的值`i`运行相应的代码。例如是`i=2`：

```
while words.size >= 2
        frequency["#{words[0]} #{words[1]}"] += 1
        words.shift
end 
```

更改`while`条件中的值很容易，但是如何根据变量复制循环体`i`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T00:52:09.307

您可以在循环中使用 if..else 语句轻松完成此操作：

```
while words.size > 0
  if words.size >= 3
    frequency["#{words[0]} #{words[1]} #{words[2]}"] += 1
  elsif words.size >=2
    frequency["#{words[0]} #{words[1]}"] += 1
  else
    break
  end
  words.shift
end 
```

但是，这是 Ruby，根据您创建这些键的方式，很容易说：

```
while words.size >= 2
   frequency[words.first(3).join(" ")] += 1
   words.shift
end 
```

这将占用 words 数组中的前三个元素，并将它们与空格连接起来，为您提供频率键。在只剩下两个单词的情况下，它会同时使用它们。

# c++ - C++ 我知道数组长度，但想知道是否有一种更简洁的方式来定义数组元素

> ID：15939005
> 
> 赞同：1
> 
> 时间：2013-04-11T00:48:50.407
> 
> 标签：c++, arrays, memory

我有以下内容：

```
Action* actions[]; 
```

在 ActionBar 类中。

我想在它的构造函数中做这样的事情：

```
actions = {
    new Action( new Image( gfx, "Images/ActionBar/Push001.png", 200, 200, TRUE ), 0, 200, 200, 200, 200 ),      
    new Action( new Image( gfx, "Images/ActionBar/Pull001.png", 200, 200, TRUE ), 1, 200, 200, 200, 200 )
}; 
```

最初我在做：

```
Action* actions[ 2 ]; 
```

然后在构造函数中：

```
actions[ 0 ] = new Action( new Image( gfx, "Images.....    
actions[ 1 ] = new Action( new Image( gfx, "Images..... 
```

这样做的最佳方法是什么？这样最后我可以在我的游戏循环中做类似的事情

```
SomeFunctionIPassAnActionInto( actionBar->actions[ 0 ] ); 
```

**编辑::稍微改变了问题**，我一直都知道会有5个动作，所以如果我这样做了

```
Actions* actions [ 5 ]; 
```

我将如何声明这样的数组元素：

```
actions = {
   new Action( "push" ),
   new Action( "pull" ),       
   new Action( "bla" ),
   new Action( "ble" ),       
   new Action( "blo" )
} 
```

之类的事情

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:00:23.250

在 C++11 中，您可以在*ctor-initializer*中初始化数组。

```
ActionBar::ActionBar()
    : actions {
        new Action( new Image( gfx, "Images/ActionBar/Push001.png", 200, 200, TRUE ), 0, 200, 200, 200, 200 ),      
        new Action( new Image( gfx, "Images/ActionBar/Pull001.png", 200, 200, TRUE ), 1, 200, 200, 200, 200 )
      }

{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:15:39.133

```
How would I declare the array elements like this:

actions = {
   new Action( "push" ),
   new Action( "pull" ),       
   new Action( "bla" ),
   new Action( "ble" ),       
   new Action( "blo" )
} 
```

让它工作的最简单的方法是定义一个构造函数，`Action`它接受一个`char const*`，`char const* const*`或者`std::string const&`然后将此参数（可能从您展示的示例中进行某种翻译）转发到 Image 构造函数（因为 image 是成员，你需要在初始化列表中做一些事情，比如你定义的函数`_image(new Image(translate(arg)))`在哪里变成)。`translate``push``Images/ActionBar/Push001.png`

# c++ - 为什么我的虚拟方法在 C++ 中被跳过？

> ID：15939008
> 
> 赞同：0
> 
> 时间：2013-04-11T00:49:07.317
> 
> 标签：c++, pointers, factory, factory-pattern, roguelike

长话短说：我正在研究的程序是一个流氓，尽管这个问题并不真正需要。

这是与此问题相关的类的层次结构树：

```
 Entity
                        Item                     Creature
                  Weapon     Armor 
```

我在 Entity 中声明了几个虚函数，它们在从它派生的类中也是虚函数。

我不确定如何表达我的问题，但我会解释问题并在下面发布代码。我有一个名为**ItemFactory的****工厂**类型类，它打开一个 xml 文件并使用我制作的简单解析器 - 并创建 Item 对象并设置它们的值。它有一个返回**Item**指针的方法。在我的主文件中，我声明/定义了一个**ItemFactory**对象。当需要在游戏中放置一个**Item时，我使用一个指针，即****Item**类型，并调用该方法随机选择一个**Item**指向。所有这一切都完美无缺..

 ******这就是问题所在。**实体**有一个名为**dumpObject()**的虚拟方法，它打印它所拥有的变量的状态。**dumpObject()在****Item**中也是虚拟的。当从**Item**调用它时，该方法首先使用以下方法调用**Entity 的**转储：

```
 Entity::dumpObject(); 
```

然后它转储它自己的变量。我对**武器**和**盔甲**做同样的事情，除了使用这个：

```
 Item::dumpObject(); 
```

## 我的问题：

由于**ItemFactory**同时拥有 - **Weapons**和**Armor**，并且主程序中的指针指向一个**Item**，因此不应调用***“itemPointer->dumpObject();”*** 转储 Weapon/Armor 的值（取决于它指向的..），这也会转储**Item**中的值，这也会转储**Entity**中的值？

当我运行代码时，唯一被转储的部分是项目和实体中的部分。

如果我需要提供更多详细信息，请告诉我。有什么建议么？谢谢！

## 这是代码片段

我包含了标题，只是试图尽量减少我发布的代码量

* * *

**项目.cpp**

```
void Item::dumpObject(){
    cout << "Item:" << endl;
    dumpObjectData();
}

void Item::dumpObjectData(){
    Entity::dumpObjectData();
    cout << "        [Weight] " << getWeight() << endl;
    cout << "         [Value] " << getValue() << endl;
    cout << "      [Quantity] " << getQuantity() << endl;
    cout << "   [Enchantment] " << getEnchantment() << endl;
} 
```

* * *

**实体.cpp**

```
void Entity::dumpObject(){
    cout << "Entity:" << endl;
    dumpObjectData();
}

void Entity::dumpObjectData(){
    XMLSerializable::dumpObjectData(); //XMLSerialization handles parsing

    cout << "          [Name] " << getName() << endl;
    cout << "   [DisplayChar] " << getDisplayChar() << endl;
    cout << "    [Properties] " << endl;

    for( auto it = m_vProperties.begin(); it != m_vProperties.end();it++ ){
            cout << "       - " << (*it) << endl;
    }
} 
```

* * *

**武器.cpp**

```
void Weapon::dumpObject(){
    cout << "Weapon:" << endl;
    dumpObjectData();
}

void Weapon::dumpObjectData(){
    Item::dumpObjectData();

    cout << "        [Damage] " << getDamage() << endl;
    cout << "         [Range] " << getRange() << endl;
    cout << "      [Accuracy] " << getAccuracy() << endl;
    cout << "      [AmmoType] " << getAmmoType() << endl;
    cout << "          [Type] " << getType() << endl;
} 
```

* * *

**装甲.cpp**

```
void Armor::dumpObject(){
    cout << "Armor:" << endl;
    dumpObjectData();
}

void Armor::dumpObjectData(){
    cout << "calls to dump item data"<<endl;
    Item::dumpObjectData();
    cout << "calls to dump armor"<<endl;
    cout << "          [Type] " << getType() << endl;
    cout << "          [Slot] " << getSlot() << endl;
    cout << "    [ArmorValue] " << getArmorValue() << endl;

} 
```

* * *

**主要的**

```
 ItemFactory myItems = ItemFactory::instance();
    Item * pItem1 = myItems.generateItem();
    pItem1->dumpObject(); 
```

* * *

* * *

* * *

## 标头

**实体.h**

```
#include "XMLSerializable.h"
#include <vector>

class Entity : public XMLSerializable {

public:
    Entity(void);
    virtual ~Entity(void);

    virtual void dumpObject();
    virtual void dumpObjectData();

}; 
```

* * *

**项目.h**

```
#include "Entity.h"

class Item : public Entity{

public:
    Item(void);
    virtual ~Item(void);

    virtual void dumpObject();
    virtual void dumpObjectData(); 
```

};

* * *

**武器.h**

```
#include "Item.h"

class Weapon : public Item {
public:
    Weapon(void);
    virtual ~Weapon(void);

    virtual void dumpObject();
    virtual void dumpObjectData();

}; 
```

* * *

**盔甲.h**

```
#include "Item.h"

class Armor : public Item {
public:
    Armor(void);
    virtual ~Armor(void);

    virtual void dumpObject();
    virtual void dumpObjectData();

}; 
```

* * *

**项目工厂.cpp**

```
ItemFactory & ItemFactory::instance(){
    static ItemFactory myObj;
    return myObj;
}

ItemFactory::ItemFactory(){
    m_mtRandom.seed( time(NULL) );
    fstream xmlFile;
    xmlFile.open("items.xml");
    vector<XMLSerializable*> pObjects;
    parseXML(xmlFile, pObjects);

    XMLSerializable * pObject;

    for(auto it = pObjects.begin(); it != pObjects.end(); it++){
            pObject = (*it);
            Item * pItem = dynamic_cast<Item*>(pObject);
            if (pItem != NULL){
                    m_vItems.push_back(pItem);
            }
    }
}

ItemFactory::~ItemFactory(){

}

Item * ItemFactory::generateItem() {
    vector<Item*> tempItems;

    for(auto it = m_vItems.begin(); it != m_vItems.end(); it++){
            tempItems.push_back((*it));
    }

    int randomItem = (m_mtRandom() % (m_vItems.size() - 1));

    Item * pItem = tempItems.at(randomItem);

    Item * pReturnValue = new Item(*pItem);

    return pReturnValue;
} 
```

既然我刚刚完成了所有这些工作，我认为除了 Main 之外的任何代码都是必要的。哈哈，我猜 Main 中指针的逻辑是错误的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:25:13.770

那么这是你的问题：

```
Item * pReturnValue = new Item(*pItem); 
```

这是给你一个浅拷贝，这样你就不会得到`Armor`or `Weapon`。

如果您只需要在给定基类实例的情况下进行复制，请在基类中定义一个`clone`方法。

看起来您正在尝试使用该`prototype`模式，所以您确实想创建新实例？

```
class Entity : public XMLSerializable {

public:
    Entity(void);
    virtual ~Entity(void);

    virtual Entity* clone() const { return new Entity(*this);}

    virtual void dumpObject();
    virtual void dumpObjectData(); 
```

};

```
class Armor : public Item {
public:
    Armor(void);
    virtual ~Armor(void);
    virtual Armor* clone() const { return new Armor (*this);}
    virtual void dumpObject();
    virtual void dumpObjectData();

}; 
```

注意协变返回值的使用`clone()`。即返回值确实不同，但由于方法签名匹配并且返回值是相互派生的，因此调用是虚拟的。

然后你可以写：

```
Item * pReturnValue = pItem->clone(); 
```

有关原型模式的背景信息，请参见：[维基百科](http://en.wikipedia.org/wiki/Prototype_pattern)。******

# c - C语言打开视频文件并播放

> ID：15939011
> 
> 赞同：-1
> 
> 时间：2013-04-11T00:49:51.303
> 
> 标签：c, file, network-programming

我正在创建一个服务器/客户端程序，其中客户端将从服务器请求视频。一旦它开始接收视频数据包，我正在创建一个视频文件并写入它。

我的主要问题是在写了一些帧之后，我必须打开视频文件并且它必须播放视频。1）如何使用C播放视频文件？2）是否可以在同一个文件上写入并同时播放同一个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T00:54:53.963

单独的 C 不提供此功能。您需要利用额外的面向多媒体的库，例如 gstreamer，并使用适合您使用的环境的框架显示它，例如 Linux 下的 gtk 就可以了。或者使用外部程序并调用它来播放视频。

[这个问题](https://stackoverflow.com/questions/3305736/play-a-video-using-gtk)应该为您指明正确的方向。

# python - 防止在 Python 中舍入为零

> ID：15939014
> 
> 赞同：6
> 
> 时间：2013-04-11T00:50:04.117
> 
> 标签：python, math, rounding, pi

我有一个程序打算使用 Chudnovsky 算法来近似 pi，但是我的方程中一个非常小的项一直被四舍五入为零。

这是算法：

```
import math
from decimal import *
getcontext().prec = 100

pi = Decimal(0.0)
C = Decimal(12/(math.sqrt(640320**3)))
k = 0
x = Decimal(0.0)
result = Decimal(0.0)
sign = 1
while k<10:
    r = Decimal(math.factorial(6*k)/((math.factorial(k)**3)*math.factorial(3*k)))
    s = Decimal((13591409+545140134*k)/((640320**3)**k))
    x += Decimal(sign*r*s)
    sign = sign*(-1)
    k += 1
result = Decimal(C*x)
pi = Decimal(1/result)

print Decimal(pi) 
```

如果没有“小数”项，等式可能会更清晰。

```
import math

pi = 0.0
C = 12/(math.sqrt(640320**3))
k = 0
x = 0.0
result = 0.0
sign = 1
while k<10:
    r = math.factorial(6*k)/((math.factorial(k)**3)*math.factorial(3*k))
    s = (13591409+545140134*k)/((640320**3)**k)
    x += sign*r*s
    sign = sign*(-1)
    k += 1
result = C*x
pi = 1/result

print pi 
```

问题在于“s”变量。对于 k>0，它总是为零。例如，在 k=1 时，s 应该等于大约 2.1e-9，但它只是零。因此，我在第一个 =0 之后的所有条款。如何让 python 计算 s 的确切值而不是将其四舍五入为 0？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:01:20.237

尝试：

```
s = Decimal((13591409+545140134*k)) / Decimal(((640320**3)**k)) 
```

你正在做的算术是原生 python - 通过允许 Decimal 对象执行你的除法，你应该消除你的错误。

那么，在计算`r`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T01:02:35.450

一些评论。

如果您使用的是 Python 2.x，则`/`返回整数结果。如果您想要 Decimal 结果，请先将至少一侧转换为 Decimal。

`math.sqrt()`仅返回约 16 位精度。由于您的 C 值只能精确到 ~16 位，因此您的最终结果只能精确到 16 位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T02:13:46.603

如果您在 Python 2.x 中进行数学运算，您可能应该将这一行放入每个模块中：

```
from __future__ import division 
```

这改变了除法运算符的含义，以便在需要时返回一个浮点数以给出（更接近）精确的答案。历史行为是`x / y`返回一个`int`if both `x`and `y`are `int`s，这通常会迫使答案向下舍入。

如果需要，返回一个浮点数通常被认为是一种更好的方式来处理像 Python 这样鼓励鸭子类型的语言中的除法，因为你可以只担心你的数字的*值*，而不是为不同的类型获得不同的行为。

在 Python 3 中，这实际上是默认设置，但由于旧程序*依赖*于除法运算符的历史行为，因此人们认为这种更改过于向后不兼容，无法在 Python 2 中进行。这就是为什么您必须显式打开它的原因与`__future__`进口。我建议*始终*在可能进行任何数学运算的任何模块中添加该导入（或者只是任何模块，如果您可能会被打扰）。你几乎永远不会对它的存在感到不安，但是没有它是我不得不追逐的一些晦涩的错误的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T01:03:03.320

我觉得 's' 的问题在于所有项都是整数，因此您正在做整数数学。一个非常简单的解决方法是`3.0`在分母中使用。计算中只需要一个浮点数即可返回一个浮点数。

# ms-access - 下标超出范围 - Excel.Application.WorksheetFunction.CountA

> ID：15939018
> 
> 赞同：0
> 
> 时间：2013-04-11T00:50:44.497
> 
> 标签：ms-access, ms-access-2007, vba, ms-access-2010

我正在尝试从 MS-Access VBA 计算 Excel 电子表格中非空单元格的数量。

这个想法是我在 MS-Access 中单击表单上的一个按钮，非空单元格的数量存储为字符串。

调用 Excel 工作簿文件，调用`"MattExcelFile.xls"`该工作簿中的工作表，`"Sheet1"`我想在其上使用 Excel`COUNTA`函数的范围是`"C1:C500"`.

这是我到目前为止拼凑的代码：

```
Option Compare Database

Sub ImportDataFromRange()

Dim xlFilePath As String
Dim rowVariable As String

xlFilePath = "C:\Users\Matt\Desktop\MattExcelFile.xls"

rowVariable = Excel.Application.WorksheetFunction.CountA(Workbooks(xlFilePath).Sheets("Sheet1").Range("C1:C500"))

Debug.Print rowVariable

End Sub

Private Sub Command0_Click()

ImportDataFromRange

End Sub 
```

这是我在运行此代码时收到的错误消息，突出显示该`rowVariable = ...`行：

> 运行时错误“9”：
> 
> 下标超出范围

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:14:23.577

我不确定您是否设置了适当的引用，因此这里是为您提供的完整代码，其中包含一些注释。

```
Sub test()
Dim rowVariable As String '<--why string?

'1st
Dim xlFilePath
    xlFilePath ="C:\Users\Matt\Desktop\MattExcelFile.xls"

'2nd- set refernces
Dim EXL As Object
Set EXL = CreateObject("Excel.Application")

'3rd open worksheet- required
With EXL
   .Workbooks.Open xlFilePath

'4th count using WF- set appropriate reference to workbook
'be careful about sheet name- give error '9'
    Dim tmpName() As String
    tmpName = Split(xlFilePath, "\")
    rowVariable = .WorksheetFunction.CountA(.Workbooks(tmpName(UBound(tmpName))).Sheets("Arkusz1").Range("A2:A10"))
'control of value
    Debug.Print rowVariable
End With

'5th-close everything and clean
EXL.Quit
Set EXL = Nothing
End Sub 
```

# jquery - 键限制jQuery插件

> ID：15939020
> 
> 赞同：0
> 
> 时间：2013-04-11T00:51:12.743
> 
> 标签：jquery, jquery-plugins

我想创建我的第一个 jQuery 插件，它应该提供输入限制的方法。这是代码。但我不知道如何为 keydown 事件传递参数“事件”。

```
(function ($) {
var methods = {
    IntegerOnly: function (event) {
        // Allow: backspace, delete, tab, escape, and enter
        if (event.keyCode == 46 || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 27 || event.keyCode == 13 ||
        // Allow: Ctrl+A
        (event.keyCode == 65 && event.ctrlKey === true) ||
        // Allow: home, end, left, right
        (event.keyCode >= 35 && event.keyCode <= 39)) {
            // let it happen, don't do anything
            return;
        }
        else {
            // Ensure that it is a number and stop the keypress
            if (event.shiftKey || (event.keyCode < 48 || event.keyCode > 57) && (event.keyCode < 96 || event.keyCode > 105)) {
                event.preventDefault();
            }
        }
    }
};

$.fn.inputRestriction = function (method) {
    if (methods[method]) {
        return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
    } else if (typeof method === 'object' || !method) {
        return methods.init.apply(this, arguments);
    } else {
        $.error('Method ' + method + ' does not exist on jQuery.inputRestriction');
    }   
};
})(jQuery); 
```

它应该被称为

```
$('#txtInteger').inputRestriction('IntegerOnly'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:01:09.957

您编写插件的方式，必须以这种方式使用：

```
$("txtInteger").keydown(function(event) {
    $(this).inputRestriction('IntegerOnly', event);
}); 
```

# java - 如何使用 Mockito/Powermock 模拟枚举单例类？

> ID：15939023
> 
> 赞同：27
> 
> 时间：2013-04-11T00:51:25.163
> 
> 标签：java, enums, singleton, mockito, powermock

我不确定如何模拟枚举单例类。

```
public enum SingletonObject{
  INSTANCE;
  private int num;

  protected setNum(int num) {
    this.num = num;
  }

  public int getNum() {
    return num;
  } 
```

我想在上面的例子中存根 getNum()，但我不知道如何模拟实际的 SingletonObject 类。我认为使用 Powermock 来准备测试会有所帮助，因为枚举本质上是最终的。

```
//... rest of test code
@Test
public void test() {
  PowerMockito.mock(SingletonObject.class);
  when(SingletonObject.INSTANCE.getNum()).thenReturn(1); //does not work
} 
```

这是使用 PowerMockMockito 1.4.10 和 Mockito 1.8.5。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-05-22T19:26:36.053

如果你想删除 INSTANCE 返回的内容，你可以这样做，但它有点讨厌（使用反射和字节码操作）。我使用 PowerMock 1.4.12 / Mockito 1.9.0 创建并测试了一个包含三个类的简单项目。所有类都在同一个包中。

# SingletonObject.java

```
public enum SingletonObject {
    INSTANCE;
    private int num;

    protected void setNum(int num) {
        this.num = num;
    }

    public int getNum() {
        return num;
    }
} 
```

# SingletonConsumer.java

```
public class SingletonConsumer {
    public String consumeSingletonObject() {
        return String.valueOf(SingletonObject.INSTANCE.getNum());
    }
} 
```

# SingletonConsumerTest.java

```
import static org.junit.Assert.*;
import static org.powermock.api.mockito.PowerMockito.*;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;
import org.powermock.reflect.Whitebox;

@RunWith(PowerMockRunner.class)
@PrepareForTest({SingletonObject.class})
public class SingletonConsumerTest {
    @Test
    public void testConsumeSingletonObject() throws Exception {
        SingletonObject mockInstance = mock(SingletonObject.class);
        Whitebox.setInternalState(SingletonObject.class, "INSTANCE", mockInstance);

        when(mockInstance.getNum()).thenReturn(42);

        assertEquals("42", new SingletonConsumer().consumeSingletonObject());
    }
} 
```

调用`Whitebox.setInternalState`替换`INSTANCE`为您可以在测试中操作的模拟对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-04T18:52:27.417

与您打算模拟的方法有一个接口

```
public interface SingletonInterface {
  int getNum();
} 
```

让枚举实现接口

```
public enum SingletonObject implements SingletonInterface {
    INSTANCE;
    private int num;

    protected void setNum(int num) {
        this.num = num;
    }

    @Override
    public int getNum() {
        return num;
    }
} 
```

模拟界面

```
@Test
public void test() {
  SingletonInterface singleton = Mockito.mock(SingletonInterface.class);
  when(singleton.getNum()).thenReturn(1); //does work
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-02T17:45:28.617

**Mockito文档在****枚举**用例上没有明确说明：

*   [模拟最终类型、枚举和最终方法（自 2.1.0 起）](https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html#39)

Powermock 支持：

*   **与JUnit 4**兼容

 ****build.gradle** ( ******也应该与**Maven**一起使用)

```
 testImplementation 'org.junit.jupiter:junit-jupiter-api:5.8.1'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.8.1'
    testImplementation 'org.mockito:mockito-inline:4.0.0'
    testImplementation 'org.mockito:mockito-junit-jupiter:4.1.0' 
```

至于可用的实验功能（***Powermock + JUnit 5***），可以尝试一下：

```
 implementation group: 'org.powermock', name: 'powermock-module-junit5', version: '1.6.4'
    testImplementation 'org.powermock:powermock-mockito-release-full:1.6.4' 
```

枚举：

```
public enum ConnectionFactory {
   INSTANCE;

   public Connection get() throws SQLException {
      //
      // Load url from configuration file  ('application.yml')
      //
      final var connection = DriverManager.getConnection(url);
      connection.setAutoCommit(false);

      return connection;
   }
} 
```

可以使用这些方法：

```
class DatabaseUnitTests {

   private final ConnectionFactory connectionFactory = Mockito.spy(ConnectionFactory.INSTANCE);

   //Or

   @InjectMocks
   private final ConnectionFactory connectionFactory = Mockito.mock(ConnectionFactory.class);

   @Test
   void check_is_database_connection_is_OK(){
      Mockito.doReturn(mockedConnection()).when(connectionFactory).get();

      // Do something
   } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-14T14:31:01.420

我不确定这是否是最好的方法，但就我而言，到目前为止它运行良好。我正在使用 mockito-core 和 mockito-inline (3.11.0)，我在间谍的帮助下嘲笑我的单身人士。您的班级示例：

```
SingletonObject so = SingletonObject.INSTANCE;
private SingletonObject spySo = Mockito.spy(so);

@Before
public void setUp() {
    Mockito.doReturn(10).when(spySo).getNum();
}

@Test
public void simpleTest() {
    assertThat(spySo.getNum(), is(10));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-15T12:24:07.753

除了上面的 Matt Lachman 回答之外，在中为 power mock 创建一个对象工厂`SingleTonConsumerTest.class`

```
@ObjectFactory
public IObjectFactory getObjectFactory() {
    return new org.powermock.modules.testng.PowerMockObjectFactory();
} 
```

这将消除`Mockito cannot mock/spy following: - final classes - anonymous classes - primitive types`错误。**

# ruby-on-rails - 范围之间的 Rails 控制器

> ID：15939024
> 
> 赞同：0
> 
> 时间：2013-04-11T00:51:32.497
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试查找这两个日期之间的所有广告，以限制我看到和看不到的内容

这里的模型

```
Advertiser
#  publishon            :date
#  publishoff           :date 
```

控制器外观如下

```
@advertisments = Advertiser.where("publishon >= ? AND publishoff <= ?", Date.today, Date.today) 
```

由于某种原因它没有抓住它，我需要更改 Date.today 的格式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T00:58:38.460

当您查询时，您的日期可能会转换为 DateTimes。检查您的日志以获取生成的 SQL 以进行验证，但如果是这样，您正在查询：

```
>= Wed, 10 Apr 2013 00:00 && <= Wed, 10 Apr 2013 00:00 
```

您可能在广告日期设置了小时和分钟。尝试

```
(..., Date.today, Date.tomorrow) 
```

请务必添加规格或回归测试，以确保您只能在 24 小时内进行选择。

# java - 如何使用 Rhino 将“AstRoot”对象写入包含注释的文件？

> ID：15939032
> 
> 赞同：3
> 
> 时间：2013-04-11T00:52:14.117
> 
> 标签：java, javascript, rhino

我已经使用 Rhino 解析了 javascript 源代码并成功地重建了它。

当我调用***astroot.toSource()***时，它向我展示了重建的源代码。

但是***.toSource()***方法不能打印评论。

使用**.toSource()**方法，我所有的 javascript 源的评论都消失了。

那么，我怎样才能获得包括评论在内的完整来源？

我的目标是将 AstRoot Object(contain source) 写入一个包含完整注释的新 javascript 文件。

我正在使用犀牛 1.7R4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T14:56:23.060

一般来说，这很困难，因为注释可以出现在任何声明、语句或表达式的中间。那么如何在各种 AST 对象中表示这一事实呢？它可以完成，但对于解析器及其创建的 AST 对象来说非常混乱。

如果您限制自己只允许对语句边界进行评论，那么有一些可能的解决方案。

一种方法是编写自己的 javascript 标记器并在读取文件时检查流。然后你需要弄清楚如何跟踪它们。一种骇人听闻的方法是将它们转换为 'var somexxxxx = "comment";' 并在 ast.toSource() 调用后使用命名约定将它们转换回来。这会将您的评论映射到 AST 节点结构中。

# sql-server - 批量插入日期时间错误

> ID：15939033
> 
> 赞同：2
> 
> 时间：2013-04-11T00:52:15.103
> 
> 标签：sql-server, sql-server-2012, bulkinsert

我正在尝试`BULK INSERT`在 SQL Server 2012 中使用将数据从文本文件导入数据库表。我`Z`在文本文件中使用带有指示符（DOB 字段）的 UTC 日期时间值。但在执行时`BULK INSERT`，我收到“数据转换错误”。

谁能帮帮我吗？

**脚本**

```
CREATE TABLE Info
(
FirstName VARCHAR(40),
LastName VARCHAR(40),
DOB DATETIME
)

BULK INSERT Info FROM 'F:\InfoTextFile.txt'  WITH (FORMATFILE='F:\InfoFormatFile.fmt') 
```

**F:\InfoTextFile.txt 的内容**

> 约翰·史密斯 1988-08-23T00:00:00.0Z
> 
> 威廉·亚历山大 1987-07-22T00:00:00.0Z

**'F:\InfoFormatFile.fmt' 的内容**

```
11.0

3

1     SQLCHAR     0     10     ""     1     FirstName     ""

2     SQLCHAR     0     10     ""     2     LastName      ""

3     SQLDATETIME 0 22     "\r\n" 3     DOB           "" 
```

**错误：**

> 消息 4864，级别 16，状态 1，第 2 行第 1 行第 3 列 (DOB) 的批量加载数据转换错误（指定代码页的类型不匹配或无效字符）。
> 
> 消息 4832，级别 16，状态 1，第 2 行批量加载：在数据文件中遇到意外的文件结尾。
> 
> Msg 7399, Level 16, State 1, Line 2 The OLE DB provider "BULK" for linked server "(null)" reported an error. The provider did not give any information about the error.
> 
> Msg 7330, Level 16, State 2, Line 2 Cannot fetch a row from OLE DB provider "BULK" for linked server "(null)".

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T07:02:14.470

Try this one -

```
--C:\InfoTextFile.txt ->
--John Smith 1988-08-23T00:00:00.0Z
--William Alexander 1987-07-22T00:00:00.0Z

--C:\InfoFormatFile.fmt ->
--11.0
--3
--1     SQLCHAR     0     10     " "     1     FirstName     ""
--2     SQLCHAR     0     10     " "     2     LastName      ""
--3     SQLCHAR     0     22     "\n"    3     DOB           ""

BULK INSERT Info 
FROM 'C:\InfoTextFile.txt' 
WITH (FIELDTERMINATOR = ' ', ROWTERMINATOR = '\n', FORMATFILE='C:\InfoFormatFile.fmt') 
```

# ruby - 使用 RubyMine 在类之间移动方法

> ID：15939034
> 
> 赞同：3
> 
> 时间：2013-04-11T00:52:16.607
> 
> 标签：ruby, rubymine, automated-refactoring

如何（我可以？）使用 RubyMine 将方法从一个类移动到另一个类？

我尝试右键单击方法名称，选择`Refactor`和`Move ...`，但这给了我`Move file path/to/file.rb To directory:`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T07:24:40.990

尚不支持移动方法重构，请[投票支持此功能请求](http://youtrack.jetbrains.com/issue/RUBY-2987)。

# mysql - 在 SQL 中，我如何仅获取整个表的单个列中具有相同值的条目？

> ID：15939035
> 
> 赞同：0
> 
> 时间：2013-04-11T00:52:24.280
> 
> 标签：mysql, sql

所以我坚持尝试制作一个 SQL 来抓取对特定 COLUMN 具有相同值的每一行。

示例：
表格：买家

```
aID | bID                        aID | bID
 1  |  3                          1  |  3 
 1  |  4                          1  |  2
 1  |  2                          2  |  2
 1  |  5                          1  |  4    this one also should return aID = 1
                                       since aID =1 is present for every different bID 
```

我想我很接近：

```
SELECT aID
  FROM buyers
 WHERE COUNT(bID) = (SELECT S1.aID
                       FROM buyers S1, 
                            buyers S2
                      WHERE S1.aID = S2.bID
                        AND S2.bID <> S1.bID) 
```

它必须在一列中的每一行中，否则不要得到它，所以如果一个`aID`不同，那就不要得到它。an`aID`必须与每个匹配`bID`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:30:02.087

```
SELECT aID
FROM buyers
GROUP BY aID
HAVING COUNT(*) = (SELECT COUNT(distinct bID) FROM buyers) 
```

[小提琴](http://www.sqlfiddle.com/#!2/d2905/1)

这假设每个`aID,bID`组合都是唯一的。如果`bID`可以重复相同的`aID`，你需要这样做：

```
SELECT aID
FROM (SELECT DISTINCT aID, bID FROM buyers)
GROUP BY aID
HAVING COUNT(*) = (SELECT COUNT(distinct bID) FROM buyers) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:11:02.483

怎么样

```
Select Distinct aId 
From Table t
Where Not Exists
   (Select * From table i
    Where bId <> t.bId
       And Not Exists 
           (Select * From table
            Where bId = i.bId
              And aId <> t.aId)) 
```

这说：

向我展示所有不同的值，`aId`使得具有不同值的行都不`aId`包含一个`bId`值，以至于甚至没有一行具有`bId`相同的值`aId`。

# python - Python：while循环在noughts和crosses中

> ID：15939041
> 
> 赞同：0
> 
> 时间：2013-04-11T00:53:10.433
> 
> 标签：python, loops, while-loop

我编写了一个 noughts 和 crosss 游戏，并且正在使用 while 循环来运行游戏。但是，我一定是做错了什么，因为当板上有 X 或 O 的行/列/对角线时，我无法让它打印“你赢”或“你输”。我知道检查板的功能就像我自己测试过的那样工作长。谢谢

```
import random

board = [
['1','-','-','-'],
['2','-','-','-'],
['3','-','-','-'],
['#','1','2','3'],
[' ',' ',' ',' ']
]

rows = {
    'top':
    board[0][1:],
    'mid':
    board[1][1:],
    'bottom':
    board[2][1:]
}

cols = {
    'left':
    [board[0][1],
    board[1][1],
    board[2][1]],
    'mid':
    [board[0][2],
    board[1][2],
    board[2][2]],
    'right':
    [board[0][3],
    board[1][3],
    board[2][3]]
}

diags = {
    'top-bottom':
    [board[0][1],
    board[1][2],
    board[2][3]],
    'bottom-top':
    [board[2][1],
    board[1][2],
    board[0][3]]
}

gamestate = 1

def print_board(board):
    for i in board:
        print " ".join(i)

def win_check(rows,cols,diags):
    plrWin = ['X','X','X']
    cpuWin = ['O','O','O']
    global gamestate
    for i in rows.values():
        if i == plrWin:
            return True
            gamestate = 0

        elif i == cpuWin:
            return False
            gamestate = 0

    for x in cols.values():
        if x == plrWin:
                return True
            gamestate = 0

        elif x == cpuWin:
            return False
            gamestate = 0

    for y in diags.values():
        if y == plrWin:
            return True
            gamestate = 0

    elif y == cpuWin:
        return False
        gamestate = 0

def game_entry():
    print "Your turn."
    coordY = input("Guess column: ")
    coordX = input("Guess row: ")
    board[coordX - 1][coordY] = 'X'

def random_location():
    while True:
        cpuX = random.randint(1,3)
        cpuY = random.randint(1,3)
        if (board[cpuX - 1][cpuY] == 'X') or (board[cpuX - 1][cpuY] == 'O'):
            continue
        else:
            board[cpuX - 1][cpuY] = 'O'
            break

while gamestate == 1:
    print_board(board)
    game_entry()
    random_location()
    if win_check(rows,cols,diags) == True:
        print "You win!"
        gamestate = 0
        break
    elif win_check(rows,cols,diags) == False:
        print "You lose."
        gamestate = 0
        break
    else:
        continue 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T00:58:51.060

您的问题在于所有`rows`和`cols`字典：

```
>>> l = [[1, 2, 3], [4, 5, 6]]
>>> x = l[0][1:]
>>> x
[2, 3]
>>> l[0][1] = 4
>>> x
[2, 3] 
```

如您所见，它们不会在电路板更改时更新。你必须找到另一种方法来做到这一点。

我只会使用几个循环并手动检查对角线：

```
def has_someone_won(board):
    # Rows
    for row in board:
        if row[0] == row[1] == row[2] != '-':
            return True

    # Columns
    for i in range(3):
        if board[0][i] == board[1][i] == board[2][i] != '-':
            return True

    # Diagonal 1
    if board[0][0] == board[1][1] == board[2][2] != '-':
        return True

    # Diagonal 2
    if board[2][0] == board[1][1] == board[0][2] != '-':
        return True

    # There's no winner
    return False 
```

# c# - 删除列表的重复项，通过 C# 中的属性值进行选择？

> ID：15939044
> 
> 赞同：7
> 
> 时间：2013-04-11T00:53:40.213
> 
> 标签：c#, linq, list, duplicates

我有一个对象列表，我需要从中删除一些重复项。如果它们具有相同的 Id，我们认为它们是重复的，并且更喜欢 booleanValue 为假的那个。这是我到目前为止所拥有的：

```
objects.GroupBy(x => x.Id).Select(x => x.Where(y => !y.booleanValue)); 
```

我已经确定 GroupBy 没有进行这样的分组，所以我看不到其他任何功能是否正常工作。对此有什么想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-11T01:03:57.263

你可以这样做：

```
var results = 
    from x in objects
    group x by x.Id into g
    select g.OrderBy(y => y.booleanValue).First(); 
```

对于`Id`在 中找到的每个`objects`元素，它将选择第一个元素 where`booleanValue == false`或第一个元素（如果它们都没有`booleanValue == false`）。

如果您喜欢流利的语法：

```
var results = objects.GroupBy(x => x.Id)
                     .Select(g => g.OrderBy(y => y.booleanValue).First()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:13:50.893

像这样的东西应该工作：

```
var result =
    objects.GroupBy(x => x.Id).Select(g =>
        g.FirstOrDefault(y => !y.booleanValue) ?? g.First()) 
```

这假定您的对象是引用类型。

另一种可能性可能是`Distinct()`与 custom一起使用`IEqualityComparer<>`。

# actionscript-3 - 使JPG白色背景透明

> ID：15939045
> 
> 赞同：1
> 
> 时间：2013-04-11T00:53:41.280
> 
> 标签：actionscript-3, flash, transparency

我正在加载一些图像，我想从 PNG 转换为 JPG 以具有更小的文件大小。然而，由于 JPG 没有透明度信息，因此图像的背景显示为白色。

加载图像后，如何使此白色背景透明？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:21:24.780

我假设您想在运行时将白色像素更改为透明像素。首先，我只想说最好的答案，就是使用 PNG 格式。我的观点是在运行时做这样的事情并不是一个好的解决方案。如果您有很多图像，文件大小很重要，那么运行时处理会带来它自己的负面影响，即处理图像时的长时间停顿。

我个人会探索我可以做些什么来减小 PNG 文件的大小，并且可能永远不会使用这样的解决方案。

但是，如果您选择走这条路，您需要做的是：

*   将图像转换为带有 Alpha 通道的 BitmapData。

*   循环通过 BitmapData 并使这些像素透明。

或者

*   使用`threshold()`BitmapData 的方法。

正如有人在您的问题的评论中提到的那样，使用白色作为背景颜色并不是一个好主意，因为所有白色像素都将变得透明，而不仅仅是背景像素。

因此，选择一种不在这些图像的调色板中的颜色是您想要用作背景颜色的颜色

正如评论者指出的那样，`threshold()`BitmapData 的方法可能效果最好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T01:06:31.697

JPG（技术上，JPEG 文件交换格式）文件，正如普通浏览器和图形应用程序所理解的那样，不支持像 PNG 那样在图像中存储 alpha 通道。根据您的应用程序，您可能希望存储一个单独的黑白“图像”文件，它是 JPG 的透明蒙版，并使用该对。可以在自定义软件中使用格式的扩展，但它们不会在其他地方被理解。

但首先，请确保 JPG 确实是您想要使用的。JPG 仅适用于“摄影”图像，这些图像通常没有透明蒙版（当然也有例外）。如果图像更像图标/绘图，那么无论如何 JPG 很可能不会比 PNG 小很多，并且具有难看的锯齿伪影，因此仅优化 PNG 会给您带来更好的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T10:44:40.687

您可能需要考虑将 png 嵌入 Flash 库中，然后导出为 swf。然后，您可以使用 Flash 使用有损 JPEG 算法压缩您的 png，但它仍将保留 alpha 通道。这可能会导致文件大小更小，但有利于保持 8 位 Alpha 通道（每个像素有 256 个透明度级别）。

通过屏蔽特定颜色，您只会得到一个 1 位的 alpha 蒙版（一个像素要么完全可见，要么完全隐藏。）您还可能遇到问题，例如图像中的颜色与遮罩颜色对应时，从您要显示的实际图像中删除像素。

在 JPEG 图像中使用无光泽颜色的另一个问题是 JPEG 压缩会留下伪影，尤其是在对象边缘和无光泽颜色周围。这使得很难正确掩盖特定颜色。

# excel - 使用 Excel 中的数据连接动态填充单元格

> ID：15939048
> 
> 赞同：-2
> 
> 时间：2013-04-11T00:54:56.140
> 
> 标签：excel, cell, populate

我目前正在尝试在 Excel 中处理数据连接，并且我想在数据定期更改时动态填充一些单元格。

更准确地说，我有一个 Excel 工作表，它通过互联网数据连接每 3 分钟更新一次 - 股市更新 - 在 8 小时的时间窗口内。每 3 分钟更新一次单元格的内容（十进制数），例如 B1。

我想知道是否可以在我的工作表上的一列中“记录”整个 8 小时内的每个数字 B1。8*60/3=160，因此我想用单元格 B1 的内容动态填充 160 个单元格。

如果可能的话，我想从这 160 个单元格中取出最大值（使用 MAX(,) 函数），将该数字记录在另一列中并绘制 B1 值在 8 小时内的演变图时间窗口。我们的想法是每天都这样做，这样一周或一个月后，我就可以查看工作表并评估市场趋势。

在回答和评论之后，我尝试编写一些 VBA 子例程，但我很难让它们真正工作。这是我的代码：

```
Dim RunTime As Date
Dim j As Integer

Sub CopyCell()
Sheets("test").Cells(j, 3) = Sheets("test").Range("B1").Value
j = j + 1
'If Time >= TimeSerial(20, 0, 0) Then'
    Application.OnTime RunTime, "CopyCell()", , False
End If
End Sub

Sub Main()
MsgBox "Starting Macro"
j = 0
RunTime = Now + TimeValue("00:03:00")
Application.OnTime RunTime, "CopyCell()"
End Sub 
```

与此同时，我自己触发了 Main() 子程序，并希望它在 20:0:0（晚上 8 点）停止。当我触发 Main() 子时，我收到消息“CopyCell() 在此工作簿中不可用”，但我确实已在 VBA 编辑器的 ThisWorkbook 选项卡中复制了上述代码，并且我已启用所有宏。请注意，如果我单独运行 CopyCell() 子程序，则单元格 B1 的内容将复制到单元格 C1。

你能帮我弄清楚我的代码有什么问题吗？

谢谢，-大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:31:37.310

没有您的代码，很难为您提供有关如何准确执行此操作的代码，但从基本角度来看，您可以很容易地做到这一点。每当您触发刷新时，只需让 VBA 将数据写入单独的工作表或数据库（最好是像 Access 这样的数据库，因为它可以与 Excel 一起使用，并且您不需要保存 Excel 工作簿）

# javascript - 如何利用 FuelUX DataGrid“加载”事件？

> ID：15939051
> 
> 赞同：3
> 
> 时间：2013-04-11T00:55:08.273
> 
> 标签：javascript, jquery, fuelux

我需要将点击事件绑定到`<a>`通过自定义格式化程序动态添加的 FuelUX DataGrid 列中的标签。

格式化程序按预期工作，但是，我不确定应该如何绑定 click 事件处理程序。我宁愿以一种不引人注目的方式这样做。

DataGrid 应该有一个[“已加载”事件挂钩](http://exacttarget.github.io/fuelux/#datagrid)，但没有示例说明如何使用此事件。有人可以给我举个例子吗？谷歌对我来说太短了。

我可以找到该事件的唯一参考是[datagrid.js 的 163](https://github.com/ExactTarget/fuelux/blob/master/src/datagrid.js)：

```
self.$element.trigger('loaded'); 
```

我假设这意味着我需要在对象上定义一个“加载”函数，但是在哪里/如何？我的数据网格是：

```
$('#jobs').datagrid({
    dataSource: dataSource,
    itemsText: 'Available Positions',
    itemText: 'Available Position';
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T01:25:37.607

[在 jQuery API 中查找.trigger()](http://api.jquery.com/trigger/)的引用后，我需要做的就是`'on'`向数据网格添加一个处理程序：

```
$('#jobs').datagrid({
    dataSource: dataSource,
    itemsText: 'Available Positions',
    itemText: 'Available Position';
}).on('loaded', function() {
    console.log('DataGrid loaded');
); 
```

# jquery - 使用 queue:false 后不触发 jQuery animate 回调？

> ID：15939055
> 
> 赞同：2
> 
> 时间：2013-04-11T00:56:00.593
> 
> 标签：jquery, callback, jquery-animate

为什么使用后没有触发动画**回调**`queue:false`？

例如，这里发生回调。

```
$("#move").click(function(){

        $(".box").animate({ 
            marginLeft: "100px"
        },500 , function() {

            alert('complete');
            console.log('complete');
        });

        return false;
}); 
```

但不是这样，

```
$("#move").click(function(){

        $(".box").animate({ 
            marginLeft: "100px"
        }, { queue:false, duration:500 } , function() {

            alert('complete');
            console.log('complete');
        });

        return false;
}); 
```

jsfiddle的[链接](http://jsfiddle.net/PGn9X/)

我可以同时拥有两者`queue:false`吗`callback`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-04-30T17:53:51.103

那行不通karthikr ...队列将不再起作用。正如您提到的动画被定义为.animate（属性，选项）。您需要使回调成为选项参数的一部分：

```
$("#move").click(function(){

    $(".box").animate({ 
        marginLeft: "100px",
     },{queue:false, duration:500, complete:function() {

          alert('complete');
          console.log('complete');
        }//callback function
    });//options and animate

    return false;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T01:01:15.903

格式错误：

签出这个[小提琴](http://jsfiddle.net/PGn9X/1/)

jquery animate[定义如下](http://api.jquery.com/animate/)：`.animate( properties, options )`

```
$("#move").click(function(){

        $(".box").animate({ 
            marginLeft: "100px",
         queue:false, duration:500 } , 5000, function() {

            alert('complete');
            console.log('complete');
        });

        return false;
}); 
```

# php - Postegre sql更新语句引号问题

> ID：15939061
> 
> 赞同：0
> 
> 时间：2013-04-11T00:56:40.053
> 
> 标签：php, sql, postgresql

我试图更新我的数据库中的最后一次访问时间，我遇到的问题是我使用 postgres sql 并且对于字符串我必须在单引号内使用双引号，但是这是抛弃语句，有没有办法解决这个

```
$sql= "UPDATE users SET last_access=' .date("Y-M-D", time ()).' WHERE login_id= '" .$login. "'";
pg_query($conn, $sql); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:03:36.563

```
$sql= "UPDATE users SET last_access='"
    .date("Y-m-d", time ()).
    "' WHERE login_id= '$login'"; 
```

或者使用 Postgresql 的日期更容易和更清洁：

```
$sql= "UPDATE users SET last_access = current_date WHERE login_id= '$login'"; 
```

# c# - 无法从循环中启动/执行线程数组

> ID：15939062
> 
> 赞同：0
> 
> 时间：2013-04-11T00:56:44.733
> 
> 标签：c#, multithreading, lambda

我有一个线程数组，在完成工作后需要返回一些值。如果我创建单独的线程变量但不通过循环，一切正常。

```
public temp ()
        {
            int count = 10; // comes from function

            int[] ret = new int[count] // return value array
            Cls[] cls = new Cls[count]; // Class instance array
            Thread[] threads = new Thread[count]; // threads array

            // Main LOOP
            for (int i = 0; i < count; i++)
            {
                cls[i] = new Cls('\0', 1); // create new class instances
                threads[i] = new Thread(state => 
                {
                    ret[i] = cls.SomeMethod('some', 'thing'); // SomeMethod returns int which I need to store 
                });
            }

            // *** 1st TRY ***
            //-----------------------
            for (int i = 0; i < count; i++)
            {
                threads[i].Start() // (error)
            }

            // *** 2nd TRY ***
            //------------------------
            threads[0].Start();
            threads[1].Start(); 
            //.....
        } 
```

**第一次尝试：** 由于某种原因，当我到达（第二个）循环内的线程[i].Start（）时，它会给出数组“超出范围”错误，因为 i（主循环的）变为 3 .... 为什么以及如何？

**第二次尝试：**错误：System.__ComObject 无法转换为接口...（<-此错误不是我的问题的一部分。）我的问题是：

如果我分别分配/启动线程（不在循环中），例如

**线程1 = {...};**

**thread2 = {...}** ... 然后启动每个线程

**thread1.Start();**

**thread2.Start();** ....一切顺利，但为什么不从循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:02:59.463

您正在*[关闭循环计数器](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)*。

基本上，将其更改为：

```
// Main LOOP
for (int i = 0; i < count; i++)
{
    // this is fine referring to i, because it's not in a lambda:
    cls[i] = new Cls('\0', 1);
    int j = i; // create a new variable for the lambda
    threads[i] = new Thread(state => 
    {
        // here you must refer to j, not i, because you're in a lambda
        ret[j] = cls.SomeMethod('some', 'thing');
    });
} 
```

发生的事情是您的 lamda 表达式中的代码指的`i`是*变量*，而不是创建线程时的当前*值*。`i`它们都指的是内存中的同一个变量。

因此，当您启动线程时，`i`等于`count`，并且当您的线程代码尝试访问时，您的索引超出范围`ret[i]`。

# ruby-on-rails-3 - 尝试使用 Rails 上的太阳黑子在对象类型上实现方面

> ID：15939070
> 
> 赞同：0
> 
> 时间：2013-04-11T00:57:47.237
> 
> 标签：ruby-on-rails-3, sunspot-rails

我的基本目标是根据返回的对象类型创建一个方面，而不是各种对象的任何特定字段。我在我的控制器中有一个搜索，它返回多种类型的对象。它看起来像这样：

```
def search
  @raw_results = Sunspot.search ProductReview, Vendor, Product do |query|
    query.fulltext(params[:search])
    query.facet(:class)
    query.with(:class, params[:item_type]) if params[:item_type].present?
  end
  @returned_items = @raw_results.results
end 
```

**如果我用/search?search=note**调用这个控制器，我会得到正确的项目和正确的方面列表。

我添加了该`query.with(:class, params[:item_type])`行，现在如果我调用链接**/search?item_type=ProductReview&search=notes**我收到错误：

*“ProductReview”的未定义方法“名称”：字符串*

有没有更直接的方法来创建对象类型的构面？如果没有，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T14:11:39.967

没有什么比睡上 1/2 晚更好的了。可能有一种更优雅的方式，但这很好用......

`class_name`我在要索引的每个模型中添加了一个新方法 ( )：

```
def class_name
  self.class.name
end 
```

（实际上，我将它放入了一个名为`SharedMethods`并包含`SharedMethods`在每个模型中的模块中。）

在每个模型的`searchable`块中，我添加了：

```
searchable do
  string :class_name
end 
```

然后只是`:class_name`在设置方面时引用。工作！

# c# - 在不实际验证签名的情况下确定文件是否在 c# 中具有数字签名

> ID：15939073
> 
> 赞同：13
> 
> 时间：2013-04-11T00:58:13.427
> 
> 标签：c#, digital-signature, signing, file-properties

有没有一种简单的方法可以检查文件上是否存在数字签名，而无需尝试验证其签名的证书？

我想在一个目录中签署一长串 exe 和 dll 文件，但只签署尚未签署的文件。

例如，如果其中一个文件已由 Microsoft 或其他第 3 方签名，我不想用我公司的证书再次对其进行签名。

通过右键单击文件并查看其属性（如果显示数字签名选项卡，则表明它已被签名），可以轻松检查文件是否具有数字签名。我正在寻找一种使用 C# 检查此数字签名属性的简单方法。

现在，我正在使用带有 signtool.exe 的 verify 命令——它不仅检查数字签名是否存在，而且检查用于签署文件的证书是否由受信任的机构颁发。

这是我这样做的简单但笨拙的方法：

```
private static Boolean AlreadySigned(string file)
{
    ProcessStartInfo startInfo = new ProcessStartInfo();
    startInfo.RedirectStandardOutput = true;
    startInfo.RedirectStandardError = true;
    startInfo.FileName = "signTool.exe";
    startInfo.Arguments = "verify /v " + file;
    startInfo.UseShellExecute = false;

    Process process = new Process();
    process.StartInfo = startInfo;
    process.EnableRaisingEvents = true;
    process.Start();
    process.WaitForExit();
    string output = process.StandardOutput.ReadToEnd();

    return output.Contains("Signing Certificate Chain:");
} 
```

请注意，我正在使用详细标志“/v”并检查输出是否包含文本“签名证书链：”——只是因为我注意到该字符串始终在已签名文件的输出中——并且是从任何未签名的文件中省略。

无论如何，尽管它很笨拙，但这段代码似乎可以完成工作。我想更改它的一个原因是因为它似乎需要几百毫秒才能对文件执行验证命令。我不需要验证我只是想查看文件上是否存在数字签名的证书。

简而言之，有没有一种简单的方法来检查数字签名是否存在 - 而无需尝试验证它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-16T01:00:24.097

我使用“Get-AuthenticodeSignature”powershell 命令想出了一个相当不错的解决方案。我发现[这个网站](http://www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C)解释了如何在 c# 中使用 powershell 命令。这样我就不需要产生多个进程，而且速度很快。

```
using System.Collections.ObjectModel;
using System.Management.Automation;
using System.Management.Automation.Runspaces;

private static Boolean alreadySigned(string file)
{            
            try
            {
                RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();
                Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
                runspace.Open();

                Pipeline pipeline = runspace.CreatePipeline();
                pipeline.Commands.AddScript("Get-AuthenticodeSignature \"" + file + "\"");

                Collection<PSObject> results = pipeline.Invoke();
                runspace.Close();
                Signature signature = results[0].BaseObject as Signature;
                return signature == null ? false : (signature.Status != SignatureStatus.NotSigned);
            }
            catch (Exception e)
            {
                throw new Exception("Error when trying to check if file is signed:" + file + " --> " + e.Message);
            }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-11T05:47:19.073

如果要对 .NET 程序集执行此操作，可以执行以下操作：

```
 string filePath = "C:/path/to/file.dll";
        Assembly assembly = Assembly.LoadFrom(filePath);
        Module module = assembly.GetModules().First();
        X509Certificate certificate = module.GetSignerCertificate();
        if (certificate == null)
        {
             // file is not signed.
        } 
```

该类`X509Certificate`有一些静态方法也可能有用（例如`CreateFromSignedFile`），但我对它们不太熟悉。这是我们用来仔细检查我们的内部工具是否已应用数字签名的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T05:10:38.037

首先，signtool 仅适用于 PE 文件。对于其他文件类型，可以使用包装签名或嵌入签名或分离签名来完成签名。

包装签名会更改实际文件，使其无法被通常用于读取它的应用程序读取。例如。如果您在 PDF 上创建包装签名，则在删除签名之前，任何 PDF 工具都无法读取该文件。

某些文件格式支持其格式的嵌入签名（EXE 文件和 Authenticode 格式就是示例）。在那里，您可以将签名嵌入到文件中，其他应用程序仍然可以读取它。但这是特定于格式的，支持这一点的格式并不多。

最后分离的签名与文件分开保存。即，如果您有一个文件`a.txt`，则创建一个分离的签名并将其放入，例如，`a.txt.pkcs7detached`.

如您所见，分离的签名最适合您的任务。在这种情况下，您有一个 .pkcs7detached 文件列表，因此您可以检查 - 如果该文件没有对应的带有签名的 .pkcs7detached 文件，则创建一个新签名。

[我们的SecureBlackbox](http://www.eldos.com/sbb/net-pki.php)产品的 PKIBlackbox 包支持上述所有签名类型。

# javascript - 如何覆盖延迟对象传递的闭包

> ID：15939079
> 
> 赞同：1
> 
> 时间：2013-04-11T00:58:44.617
> 
> 标签：javascript, jquery, closures, jquery-deferred

因此，我尝试在 Web 应用程序上使用 $.Deferred 对象来确保在尝试执行 [目标] 之前已完成 [先决条件]。

长话短说，我想用它的真实代码看起来像......

```
function QuoteReview(openQuote) {
    //constants
    this.RETIRE_AFTER=180; //...seconds. Do not use cached values older than this, instead, reload them
    this.lastLoadedQuotes=undefined;
    this.quotes=[];
    this.currentQuote={
        chosen:false, 
        id:undefined, 
        loaded:false, 
        name:undefined,
        pricebook:undefined,
        prontoId:undefined,
        state:undefined,
        reviewer:undefined,
        opportunityId:undefined,
        accountCode:undefined,
        items:[],
        lastLoad:undefined 
    };
    var _curQuote=this.currentQuote;
    this.displayQuote=function(forceLoad) {
        //if forceLoad was specified as true, the quote has never been loaded, or the last load is past it's retirement age, load it first
        if (forceLoad || typeof this.currentQuote.lastLoad == "undefined" || ((new Date() - this.currentQuote.lastLoad)/1000)>this.RETIRE_AFTER)
            this.loadQuote().then(this._displayQuote);
        else
            this.displayQuote();
    }
    this._displayQuote=function() {
        console.log(this); //Displays the deferred object
        console.log(self); //reference error (expected)
        console.log(currentQuote); //reference error
        console.log(_curQuote); //reference error
    }
    this.loadQuote=function() {
        if (this.currentQuote.chosen) {
            var self=this;
            return $.getJSON("queries/getQuote.php?id="+encodeURIComponent(this.currentQuote.id),function(data) {
                //TODO add in the error/logged out handling
                data=data.data[0];
                self.currentQuote.name=data.name;
                self.currentQuote.pricebook=data.pricebook;
                self.currentQuote.prontoId=data.prontoId;
                self.currentQuote.state=data.state;
                self.currentQuote.reviewer=data.reviewer;
                self.currentQuote.opportunityId=data.opportunityId;
                self.currentQuote.accountCode=data.accountCode;
                self.currentQuote.items=data.items;
                self.currentQuote.lastLoad=new Date();
                self.currentQuote.loaded=true;
            });
        } else {
            console.log("tried to load quote before it was chosen!");
            return $.Deferred();
        }
    }
} 
```

但我制作了一些测试代码来更容易地显示问题：

```
function getSomeAjax() {
    return $.getJSON("queries/quoteSearch.php?needle=",function(data) {
        console.log("got the response");
        console.log(data);
        window.someInfo=data;
    });
}
function _useIt() {
    console.log("we would use the data here, doing some dom type stuff");
    console.log(window.someInfo);
    console.log(this);
}
function useIt() {
    getSomeAjax().then(_useIt);
} 
```

（该查询只返回一些数据......在这种情况下并不重要，我们不做任何事情）

问题是，当我登录`this`该`_useIt()`函数时，我看到了延迟对象的范围。现在这是完全有道理的，我当时正在调用 - 延迟对象的成员，但是有人知道解决这个问题的方法吗？如果我使用`.apply(window,[])`它似乎甚至不会调用 _useIt。现在，看到我只是`quoteReview = new QuoteReview();`在页面上使用并且我将始终只有一个 QuoteReview 对象，我知道我可以做`quoteReview.currentQuote`而不是`this.currentQuote`，如果推来推去我不介意这样做，但我也会想知道这样做的正确方法。

回答后编辑：在这种情况下，我最终使用了 Travis 和 Esthete 的答案组合。我发现 Aesthete 在回调函数中为我工作，但后来我意识到我还需要创建一个`_curParts`,`_curQuotes`和`_curPart`变量；我也使用了一个`var self=this`assigned inside`loadQuote()`来访问匿名ajax函数中的成员，但这似乎是双重工作（考虑到`self`还具有的所有属性`_curQuote`）。相反，我`var self=this`在整个构造函数的范围内使用它来访问匿名 ajax 函数和`.then()`作为回调传递的函数中的成员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:07:02.113

您应该能够使用闭包来解决问题，尽管我认为这不是最好的解决方案。

```
var _curQuote = this.currentQuote;
this._displayQuote=function() {
  // Use _curQuote, which should just reference the member currentQuote.
} 
```

看看[这个 fiddle](http://jsfiddle.net/5QCgs/1/)，它应该有望消除一些混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T01:10:13.097

您需要使用闭包和一个新的作用域变量。 `this`取决于调用上下文，并将被分配给您所看到的 jQuery 对象。

您可以尝试这样的事情（从您的代码中截取）：

```
this.loadQuote=function() {
    var self = this; // This is grabbing the correct context
    return $.getJSON("local/address.php",function(data){
        //success handler. Fills in the this.currentQuote object
        // Here you'll want to use self.currentQuote
    });
} 
```

**编辑：我想提供一些样本来澄清一些评论。我个人的偏好是 Underscore.js 绑定方法。如果您不使用该框架，则可以包含您自己的该方法版本并将其扔到函数原型上以进行更清晰的调用。**

```
var MyClass = function() {
    this.MyVariable = "Hello World";

    this.MyCallback = function(data) {
        alert(this.MyVariable);
    };

    // Using 'self' variable to preserve invocation context
    //    The important thing is that 'self' is LOCAL ONLY
    //    and the MyCallback method can reliably rely on 'this'
    this.MakeCallSelfVariable = function() {
        var self = this;
        return $.getJSON("url", function(data) {
            self.MyCallback(data);
        }
    };

    // Using Underscore.js _.bind()
    this.MakeCallUnderscore = function() {
        return $.getJSON("url", _.bind(this.MyCallback, this));
    };

    // Using jQuery's options to set the context (obviously
    //    depends on jQuery
    this.MakeCallJQuery = function() {
        return $.ajax({
            dataType: "json",
            url: "url",
            context: this, // Important line
            success: function(data) {
                // Here, 'this' will refer to what you
                //    assigned to context
                this.MyCallback(data);
            }
        });
    };
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T02:43:15.947

的含义`this`并不总是很明显，我不想猜测它是什么`_useIt()`。它可以是全局名称空间或其中的任何内容，具体取决于代码的组织方式。

暂`this`且不说，处理代码的第一件事是避免`data`通过全局成员传递。As`getSomeAjax()`返回一个符合 Promise 的 jqXHR，`data`自动传递给 chained`.then()`和`.done()`handlers。

例如，您的代码将简化如下：

```
function getSomeAjax() {
    return $.getJSON("queries/quoteSearch.php?needle=", function(data) {
        console.log("got the response");
        console.log(data);
    });
}
function _useIt(data) {
    console.log("we would use the data here, doing some dom type stuff");
    console.log(data);
}
function useIt() {
    getSomeAjax().then(_useIt);
} 
```

...，这可能更容易理解`_useIt`匿名写：

```
function getSomeAjax() {
    return $.getJSON("queries/quoteSearch.php?needle=", function(data) {
        console.log("got the response");
        console.log(data);
    });
}
function useIt() {
    getSomeAjax().then(function(data) {
        console.log("we would use the data here, doing some dom type stuff");
        console.log(data);
    });
} 
```

请注意，它`data`作为匿名函数的第一个参数出现的方式与它作为`$.getJSON()`回调的第一个参数出现的方式相同。第二个和第三个参数在这两个函数中同样可用。

此外，这里的力量`.then()`可能不是必需的。`.done()`将完成这项工作，除非您需要通过返回一个新值或一个新的 Promise 来过滤 Promise，以便向下传递一个扩展的方法链，例如。`getSomeAjax(...).then(...).then(...).done(...).fail(...).always(...)`.

# jquery - ajax 成功时撇号字符未正确转换为 UTF-8

> ID：15939081
> 
> 赞同：0
> 
> 时间：2013-04-11T00:58:52.947
> 
> 标签：jquery, html, ajax, utf-8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:18:16.410

Need to use [HTML entities](http://www.w3.org/TR/html4/sgml/entities.html) to display those characters:

[http://www.danshort.com/HTMLentities/](http://www.danshort.com/HTMLentities/)

That would be `&lsquo;` I believe.

To do the encoding, since you're already using jQuery you could use [this method](https://stackoverflow.com/questions/1219860/javascript-jquery-html-encoding) to encode the paragraph element's text

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T01:34:48.377

I'm pretty sure this isn't an issue with the ajax request or any of the JavaScript. In fact, you don't need to include the "contentType" option in your call to `.ajax()`. Also, it's not a question of "escaping" but of "encoding." You need the server to properly encode the response so it is UTF-8\. The server should also set the "Content-Type" response header to "text/html; charset=utf-8". First you could check what the response headers look like for the ajax response. But even if they are correct, that does not mean that the response was actually encoded properly. You'd have to check your server code to see what it is doing.

# asp.net - 当前用户身份在 IIS 中的格式不正确

> ID：15939085
> 
> 赞同：0
> 
> 时间：2013-04-11T00:59:22.433
> 
> 标签：asp.net, webforms, windows-authentication

我有一个使用 Windows 身份验证的 ASP.Net Web 窗体项目。当我在我的 DEV 机器（Windows 7）上运行它时，以下代码行正确返回了由反斜杠（“\”）分隔的域名和用户名（即域名\用户名）：

```
System.Web.HttpContext.Current.User.Identity.Name 
```

好的，当我在我的 WebServer 上运行我的项目时，上面的行将域名和用户名一起返回，但这次没有分隔符。（即域名用户名）。

我已经在我的 Web 服务器上打开了 Windows 身份验证。我很难过任何想法？

# php - jquery上的if语句错误

> ID：15939087
> 
> 赞同：0
> 
> 时间：2013-04-11T00:59:36.287
> 
> 标签：php, jquery, ajax

您好，我正在为我的网页开发一个 jquery ajax 解决方案，有一个 getir.php 我将它用于 jquery 发布数据（它是一个用户名），如果名称存在，它会回显“TRUE”或“FALSE”

这里是

```
if (isset($_POST['name'])) {
if($synan->checkNameIsExist($_POST['name'])){
    echo'TRUE';
}else{
    echo'FALSE';
}
} 
```

它工作正常我在控制台中看到真假结果，但我在 jquery 部分有问题

```
$(document).ready(function () {
    $("#user_name_reg").blur(function () {
        txt = $(this).val();

        $.post("getir.php", {
            name: txt,
            method: "checkName"
        }, function (result) {

            console.log(result);
            if (result == 'TRUE') {
                $("span").html("answer true");
            } else {
                $("span").html("answer false");
            }
        });
    });
}); 
```

我无法使它在 if 语句中起作用。谢谢你的建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:19:30.300

鉴于您的输出来自：

```
console.log(typeof result, result.length, result); 
```

是`string 78 true`，我们知道 3 件事：

1.  我们正在处理一个字符串
2.  涉及很多空白
3.  正在进行一些奇怪的案例转换。

下面的解决方案解释了这些观察结果：

```
result = $.trim(result).toLowerCase();
if (result == 'true') {
    $("span").html("answer true");
} else {
    $("span").html("answer false");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T01:15:25.710

如果 PHP 使用默认内容类型：'text/plain' 并且实际上只返回 'TRUE' 或 'FALSE'**没有任何前导空格或其他内容，**则上面的示例**将**起作用。您应该确保在调用时在输出周围使用引号`console.log()`。像这样：

```
console.log("'" . result . "'"); 
```

如果它周围有空格，请确保在 PHP 中的开始`<?php`标记之前或结束标记之后没有内容`?>`

# php - PHP cookie 在 IE 中不起作用

> ID：15939096
> 
> 赞同：0
> 
> 时间：2013-04-11T01:01:08.020
> 
> 标签：php, internet-explorer, cookies, setcookie

我正在使用 PHP 创建一个 cookie，下面是其中一个 cookie 的示例：

`setcookie("LogPasswordError", "Please enter your Password.", time()+1, '/');`

如果用户密码不正确，则会在文件中创建`loginForm.php`此 cookie，如果已设置`HTML`，则会以不同文件中的形式回显。在 IE 中没有设置 cookie，但它在 Firefox 和 Chrome 中有效。为什么 cookie 没有在 IE 中设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:13:06.080

哪个版本的IE？

如果你在本地主机上试试这个：

setcookie("LogPasswordError", "请输入您的密码。", time()+3600, '/', **false** );

这表示使用当前时间加上 3600，**false**表示不使用 https 协议。

# python - 在两个 vtkPolyData 对象之间绘制最接近的向量？

> ID：15939098
> 
> 赞同：1
> 
> 时间：2013-04-11T01:01:13.337
> 
> 标签：python, geometry, distance, vtk

我正在使用 vtk 试图确定两个多数据对象之间的最小距离。我`vtkDistancePolyDataFilter`用来确定最小距离，但是如何确定定义此最小结果的每个对象上的关联 x、y、z 点？

下面的最小示例根据与圆柱体的距离为立方体着色；我想在每个对象`vtkLine`的最近点之间画一个。`vtkPolyData`结果`vtkDistancePolyDataFilter`似乎包括立方体对象的单元格、法线和距离，但我不知道如何轻松找出其中哪些与最小距离相关联，或者这与圆柱体上的点有何关系。

**编辑：**我不确定`vtkDistancePolyDataFilter`是否正确计算了最小距离-它似乎只进行顶点-顶点交互。

```
import vtk

ren = vtk.vtkRenderer()
renWin = vtk.vtkRenderWindow()
renWin.AddRenderer(ren)
iren = vtk.vtkRenderWindowInteractor()
iren.SetRenderWindow(renWin)

cube = vtk.vtkCubeSource()
cube.SetCenter (1.2, 0.3, 0.4);

transform = vtk.vtkTransform()
transform.RotateX(45)
transform.RotateY(45)
transform.Translate((1.2,0.2,0))

tf = vtk.vtkTransformPolyDataFilter()
tf.SetInput(cube.GetOutput())
tf.SetTransform(transform)
tf.Update()

cubeMapper = vtk.vtkPolyDataMapper()
cubeMapper.SetInput(tf.GetOutput())
cubeActor = vtk.vtkActor()
cubeActor.SetMapper(cubeMapper)

#Create Cylinder
cylinder = vtk.vtkCylinderSource()
cylinder.SetHeight(2)
cylinderMapper = vtk.vtkPolyDataMapper()
cylinderMapper.SetInput(cylinder.GetOutput())
cylinderActor = vtk.vtkActor()
cylinderActor.SetMapper(cylinderMapper)

#Determine distance btwn Cylinder and Cube
distfilt = vtk.vtkDistancePolyDataFilter()
distfilt.SetInputConnection(1, tf.GetOutputPort())
distfilt.SetInputConnection(0, cylinder.GetOutputPort())
distfilt.Update()

#Color the cube based on distance to cylinder
distmapper = vtk.vtkPolyDataMapper()
distmapper.SetInputConnection(distfilt.GetOutputPort(1))
distmapper.SetScalarRange( \
    distfilt.GetOutput().GetPointData().GetScalars().GetRange()[0],
    distfilt.GetOutput().GetPointData().GetScalars().GetRange()[1],)

distactor = vtk.vtkActor()
distactor.SetMapper(distmapper)

distarray = distfilt.GetOutput().GetPointData().GetScalars()
for i in range(24):
    print distarray.GetValue(i)
    # Minimum distance is the lowest of these results, but what are the
    # Corresponding points on the cylinder and cube?

scalarBar = vtk.vtkScalarBarActor()
scalarBar.SetLookupTable(distmapper.GetLookupTable())
scalarBar.SetTitle("Distance")
scalarBar.SetNumberOfLabels(5)

ren.AddActor(cubeActor)
ren.AddActor(cylinderActor)
ren.AddActor(distactor)
ren.AddActor2D(scalarBar)

iren.Initialize()
renWin.Render()
iren.Start() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T04:47:43.053

这不能直接使用 VTK 完成 - 需要物理/运动学/碰撞库。我目前正在研究如何让 Bullet 与 VTK 一起工作。

# c++ - 如何将两个 double 数据类型元素转换为一种 Point 数据类型

> ID：15939101
> 
> 赞同：0
> 
> 时间：2013-04-11T01:01:26.770
> 
> 标签：c++

我正在迭代一个存储点数据类型 [x,y] 的向量，以便对每个 x 和 y 进行一些单独的计算……从向量元素 1 中的 x 中减去向量元素 2 中的 x…… .为此，我将这些点转换为双数据类型.....现在我需要将它们放回点数据类型.....？

示例代码：

```
double  Pta;
    double  Ptb;
    double vect;

    double PtResult;
    for(vector<Point>::iterator iter_a = Left_Arm_xy.begin()+1; iter_a != Left_Arm_xy.end(); ++iter_a)
    {

        if(center.y <= 240)
        {
            Pta = iter_a->x - (iter_a -1)->x;
            Ptb = iter_a->y - (iter_a -1)->y;

            vect = ((Point)Pta, Ptb);

        } 
```

编译器在代码的最后一行显示：“错误：没有运算符“= 匹配这些操作数”

```
vect = ((Point)Pta, Ptb); 
```

如果可以的话，这种转换是否可能有人可以提出解决方案......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:11:53.880

如果你想`Point`从你的两个数据点中创建一个，那么`Point`只需要一个构造函数，它将两个双精度作为参数并使用它：

```
 Point vec(Pta, Ptb) ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T01:09:33.873

1.  将 vect 设为 2 向量，请参见以下更改：

    ```
    double  x;
    double  y;
    Vec2   vect;
    Vec2   PtResult; // not used?

    for
    (
        vector<Point>::iterator iter_a = Left_Arm_xy.begin()+1;
        iter_a != Left_Arm_xy.end();
        ++iter_a
    )
    {

        if(center.y <= 240)
        {
            x = iter_a->x - (iter_a -1)->x;
            y = iter_a->y - (iter_a -1)->y;

            vect = new vect(x, y);

        } 
    ```

    } }

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T01:11:19.573

如果`Point`只是一个包含`x`和`y`成员的简单结构，您可以执行以下操作：

```
Point vect;
vect.x = Pta;
vect.y = Ptb; 
```

或者更简单地说：

```
Point vect;
vect.x = iter_a->x - (iter_a -1)->x;
vect.y = iter_a->y - (iter_a -1)->y; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T01:25:00.593

首先想感谢所有在这里尝试帮助我的人，每个人都会投票：P ....我设法使用@Jorge Israel Pena 的建议解决了这个特殊问题....

尽管我分享了最终的解决方案代码示例：

```
double Pta; 
double Ptb;
Point  vect;
int i = 0;
for(vector<Point>::iterator iter_a = Left_Arm_xy.begin()+1; iter_a != Left_Arm_xy.end(); ++iter_a, i++)
{

if(center.y <= 240)
{

    vect.x = Pta = iter_a->x - (iter_a -1)->x;
    vect.y = iter_a->y - (iter_a -1)->y;

    cout<<"Calculation No. : "<<i<<" ""Center Points: "" "<<*iter_a<<" ""Vector Addition Tail to Head: "" "<<vect<<endl;

} 
```

# postgresql - SQLAlchemy / Flask / PostgreSQL 池连接

> ID：15939104
> 
> 赞同：18
> 
> 时间：2013-04-11T01:01:45.020
> 
> 标签：postgresql, sqlalchemy, flask, flask-sqlalchemy

在与 Django 玩了很长时间之后，我正在尝试一些 Flask 和 SQLAlchemy，我必须说我非常喜欢它。但是有一些我没有得到的东西：我有一个使用 PostgreSQL 的小型 Flask / SQLAlchemy 应用程序。在我的`__init__.py`文件中，我有：

```
from flask import Flask
from flask.ext.sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config.from_object('settings')
db = SQLAlchemy(app) 
```

我想知道：

1.  有自动连接池吗？还是每次调用 Model.query... 都会创建到数据库的新连接？
2.  如果没有，我该如何配置它？
3.  如果是，默认值是什么，我该如何修改这些值？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-11T01:44:53.107

Flask-SQLAlchemy 使用 SQLAlchemy 中的方法创建一个 SQLAlchemy 引擎，您可以[在 create_engine 函数](http://docs.sqlalchemy.org/en/rel_0_8/core/engines.html#engine-creation-api)`create_engine`的文档中阅读一些选项和默认值。[根据 Flask-SQLAlchemy 文档](http://pythonhosted.org/Flask-SQLAlchemy/config.html)，您可以指定一些特定于池的配置选项。您可以通过各种方式设置这些值，您可以在[Flask 配置](http://flask.pocoo.org/docs/config/)中了解这些信息。您已经有一个配置模块，因此您可以在配置文件中添加类似...`settings`

```
SQLALCHEMY_POOL_SIZE=10 
```

所以，是的，有自动连接池。[这是由 SQLAlchemy 默认提供的](http://docs.sqlalchemy.org/en/latest/core/pooling.html)。在发布此答案时，Flask-SQLAlchemy 允许您使用配置文件修改**其中一些**选项（尽管似乎有一个旧的[拉取请求允许您指定任何 create_engine 参数](https://github.com/mitsuhiko/flask-sqlalchemy/pull/67)）。

如果您需要比 Flask-SQLAlchemy 提供的更多支持来配置 SQLAlchemy 引擎，您可以使用没有 Flask-SQLAlchemy 包装器的 SQLAlchemy，或者修改 Flask-SQLAlchemy（可能合并拉取请求）以允许这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-07T11:34:01.000

您的烧瓶实例的每个工作人员运行具有多个工作人员的适当 wsgi 服务器将拥有自己的引擎 - 因为您的脚本是为每个工作人员单独加载的。

因此，您根本无法控制真正的池，除非您限制 wsgi 服务器的工作线程并计算每个引擎/池实例允许的最大连接数。

可以在[https://docs.sqlalchemy.org/en/13/core/pooling.html#using-connection-pools-with-multiprocessing阅读更多详细信息](https://docs.sqlalchemy.org/en/13/core/pooling.html#using-connection-pools-with-multiprocessing)

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2018-11-09T17:33:02.747

NullPool 可以在 create_engine 方法上设置

```
` from sqlalchemy.pool import NullPool
  engine = create_engine('db connection url',poolclass=NullPool)` 
```

# javascript - 在 Internet Explorer 中运行本地“Javascript Dependant”HTML 文件

> ID：15939105
> 
> 赞同：4
> 
> 时间：2013-04-11T01:01:45.693
> 
> 标签：javascript, jquery, internet-explorer, browser

当您使用 Internet Explorer 打开本地 HTML 文件（包含 Javascript）时，会出现一条消息：

`Internet Explorer restricted this webpage from running scripts or ActiveX Controls`

我的问题：**有没有办法让 IE 或用户允许本地 HTML 文件运行 javascript？**

我们正在分发一张 CD，它在 AutoRun 上显示我们基于 HTML 的菜单。该菜单在用户浏览器中运行，并传达有关 CD 上内容的信息（自定义包，因此不是安装程序）。我们的菜单严重依赖 JQuery，所以不能运行 Javascript 是不好的。我们选择用 HTML、CSS、Javascript 制作菜单，以实现跨平台兼容。

**有没有办法从 IE 中的本地 HTML 文件自动运行 Javascript？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T01:05:53.290

你想要网络的标志：

[http://msdn.microsoft.com/en-us/library/ms537628(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms537628(v=vs.85).aspx)

共有三个版本

*   `<!-- saved from url=(0023)http://www.contoso.com/ -->`
*   `<!-- saved from url=(0014)about:internet -->`
*   `<!-- saved from url=(0016)http://localhost -->`

格式非常具体，具体到位置，并且回车**和**换行必须跟在`-->`.

```
<!doctype html>
<!-- saved from url=(0023)http://www.contoso.com/ -->
<html>
  <head>
    <title>A Mark of the Web Example.</title>
  </head>
  <body>
     <p>Hello, World</p>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-11T01:05:32.223

Internet Explorer 应该询问您是否要允许它，通常是通过单击该通知。还有一个设置可以永久允许它。

# java - Java 小程序在网页上运行时只显示灰色

> ID：15939114
> 
> 赞同：0
> 
> 时间：2013-04-11T01:02:44.170
> 
> 标签：java, applet, webpage

因此，对于一项任务，我必须制作一个小的 Java 小程序并将其显示在网页上。它在 NetBeans 中构建得很好，但是当我尝试在网页中运行它时，它显示为灰色，如下所示：[http://devii.in/7apW](http://devii.in/7apW)我硬盘上的 .jar 文件加载得很好，所以我很困惑至于是什么搞砸了。任何帮助，将不胜感激。谢谢你。

你可以自己在这里查看：http: [//trainman1405.com/hi.html](http://trainman1405.com/hi.html) 罐子：[http ://trainman1405.com/Apples.jar](http://trainman1405.com/Apples.jar)

我的代码：

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
public class Apples extends JApplet  {
    private static void display() {
        JTextField field1 = new JTextField();
        JTextField field2 = new JTextField();
        JTextField field3 = new JTextField();
        JTextField field4 = new JTextField();
        JTextField field5 = new JTextField();
        JPanel panel = new JPanel(new GridLayout(0, 1));
        panel.add(new JLabel("Username:"));
        panel.add(field1);
        panel.add(new JLabel("Password:"));
        panel.add(field2);
        panel.add(new JLabel("Repeat Password:"));
        panel.add(field3);
        panel.add(new JLabel("Email address:"));
        panel.add(field4);
        panel.add(new JLabel("Repeat email address:"));
        panel.add(field5);
        int result = JOptionPane.showConfirmDialog(null, panel, "Form",
            JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE);
    }
    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                display();
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:04:36.997

启动小程序时，`main`永远不会调用该方法。小程序的入口点是[init](http://docs.oracle.com/javase/7/docs/api/java/applet/Applet.html#init%28%29)方法：

```
public void init() {
   EventQueue.invokeLater(new Runnable() {

      @Override
      public void run() {
        display();
      }
   });
} 
```

# css - CSS，使左右背景图像滑出小屏幕的视图

> ID：15939119
> 
> 赞同：3
> 
> 时间：2013-04-11T01:03:12.587
> 
> 标签：css, background-image

这是我在窗口缩小时尝试实现的模型，使用左右两个单独的图像：

![屏幕越来越小](https://i.stack.imgur.com/QuAaS.jpg)

对于宽屏幕，图像会粘在左右两侧，但随着屏幕缩小，它们会滑出视野。如果那里有任何天才可以想出一个纯 css 解决方案，这里是一个模型：

[http://jsfiddle.net/TV8sB/1/](http://jsfiddle.net/TV8sB/1/)

`<div id="bg1"><div id="bg2"></div></div>`

如果可能的话，CSS 将是首选，否则我可以在 javascript 中做一些基本的事情。

干杯! 戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:27:44.833

如果您不介意使用一些未广泛实施的技术，您可以尝试[`calc()`](https://developer.mozilla.org/en-US/docs/CSS/calc)：

[http://jsfiddle.net/TV8sB/2/](http://jsfiddle.net/TV8sB/2/)

```
@media only screen and (max-width: 700px) {
    #bg1{
        background-position:-webkit-calc(50% - 285px) top;
        background-position:-moz-calc(50% - 285px) top;
        background-position:-ms-calc(50% - 285px) top;
        background-position:calc(50% - 285px) top;
    }
    #bg2{
        background-position:-webkit-calc(50% + 285px) top;
        background-position:-moz-calc(50% + 285px) top;
        background-position:-ms-calc(50% + 285px) top;
        background-position:calc(50% + 285px) top;
    }
} 
```

[兼容表](http://caniuse.com/#feat=calc)

（我之所以选择`285px`它是因为它最适合我的 Chrome。您当然可以选择其他您认为效果更好的像素。）

如果您对此不满意，您可能需要将它们分开（即`#bg1`，将它们作为独立元素而不是内容包装器）。`#bg2``#content`

* * *

编辑：

这是另一个不使用的解决方案`calc()`：

[http://jsfiddle.net/TV8sB/3/](http://jsfiddle.net/TV8sB/3/)

```
<div id="bg1"></div><div id="bg2"></div>

<div id="content">
<!-- ... -->
</div> 
```

```
#bg1{
    position:absolute;
    width:50%;
    top:0px;
    left:0px;
    bottom:0px;
    background: url("http://sunny-kids-wordpress-theme.dtbaker.net/wp-content/themes/sunny-kids/images/background_leaves_left.png") no-repeat left top;
}
#bg2{
    position:absolute;
    width:50%;
    top:0px;
    right:0px;
    bottom:0px;
    background: url("http://sunny-kids-wordpress-theme.dtbaker.net/wp-content/themes/sunny-kids/images/background_leaves_right.png") no-repeat right top;    
}
@media only screen and (max-width: 700px) {
    #bg1{
        background-position:right 220px top 0px;
    }
    #bg2{
        background-position:220px 0px;
    }
} 
```

但事实证明，[四个值`background-position`没有实现比`calc()`](https://developer.mozilla.org/en-US/docs/CSS/background-position#Browser_compatibility).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T04:06:31.760

这是另一个解决方案，其最高级的 CSS 要求是媒体查询，您似乎已经愿意接受：

**HTML**

```
<body>
    <div class="bg" id="bg1"></div>
    <div class="bg" id="bg2"></div>
    <div id="content">
        ...         
    </div>
</body> 
```

**CSS**

```
html {
    position: relative;
}
html, body{
    background:#f8e9a4;
    margin: 0;
}
.bg {
    position: absolute;
    top: 0;
    bottom: 0;
}
#bg1{
    background: url("http://sunny-kids-wordpress-theme.dtbaker.net/wp-content/themes/sunny-kids/images/background_leaves_left.png") no-repeat left top;
    width: 113px;
    left: 0;
}
#bg2{
    background: url("http://sunny-kids-wordpress-theme.dtbaker.net/wp-content/themes/sunny-kids/images/background_leaves_right.png") no-repeat right top;   
    width: 122px;
    right: 0;
}
#content{
    width:400px;
    background:#FFF;
    margin: 20px auto;
    min-height:500px;
    padding:20px;
    border-radius:10px;
    position: relative;
}

@media only screen and (max-width: 700px) {
    #bg1{
       right: 50%;
        margin-right: 220px;
        width: auto;
        background-position: right top;
    }
    #bg2{
         left: 50%;
        margin-left: 220px;
        width: auto;
        background-position: left top;
    }
}

@media only screen and (max-width: 440px) {
    #content{
        width:90%;
        }
    img{
     max-width:100%;   
    }
} 
```

这是**[通过 jsfiddle 的工作示例](http://jsfiddle.net/TV8sB/6/)**。

**更新：**这是**[另一个版本](http://jsfiddle.net/TV8sB/7/)**，它抛弃了`#bg1`and和伪元素。`#bg2``body:before``body:after`

# scheme - 如何用`lambda`重写`let*`？

> ID：15939122
> 
> 赞同：8
> 
> 时间：2013-04-11T01:03:25.873
> 
> 标签：scheme, lambda

我了解如何`(let ((x v1) (y v2)) e)`重写为`((lambda (x y) e) v1 v2)`. 但是我不太熟悉`let*`。

我们如何`(let* ((x v1) (y v2) (z v3)) e)`根据 lambda 和函数应用程序进行重写？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:14:57.733

这个`let`表达式：

```
(let ((x v1)
      (y v2))
  e) 
```

等效于下面的`lambda`应用程序，注意这里的变量可以按任何顺序求值（不强制执行严格的从左到右顺序），并且一个变量的定义不能引用它之前的变量：

```
((lambda (x y)
   e)
 v1 v2) 
```

另一方面，这个`let*`表达式：

```
(let* ((x v1)
       (y v2)
       (z v3))
  e) 
```

可以转换为一系列嵌套`lambda`的 s，以确保变量的评估顺序与用于定义它们的顺序相同，并且首先定义的变量可以在所有后续定义中引用：

```
((lambda (x)
   ((lambda (y)
      ((lambda (z)
         e)
       v3))
    v2))
 v1) 
```

另一个例子：这个代码只有在我们使用第二个转换时才有效：

```
(let* ((x 1)
       (y (+ x 1)))
  (+ x y)) 
```

可以看到，`y`references的定义`x`，只有这样才能起作用：

```
((lambda (x)
   ((lambda (y)
      (+ x y))
    (+ x 1)))
 1) 
```

最后，这里有两本很棒的学习 Scheme 的在线书籍：

*   [如何设计程序](http://www.ccs.neu.edu/home/matthias/HtDP2e/)
*   [计算机程序的结构和解释](http://mitpress.mit.edu/sicp/full-text/book/book.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T02:07:51.330

## `let*`扩展到什么

这个：

```
(let* ([a 1] [b (* 2 a)])
  (cons a b)) 
```

扩展为：

```
((lambda (a)
   ((lambda (b)
      (cons a b))
    (* 2 a)))
 1) 
```

这是一个很好的方式来思考`lambda`Scheme 中的含义（很好，因为它既简单又准确）：它既是程序中位置的标签，*又*是绑定变量的范围。在 Scheme 中，程序中某个位置的标签（例如您可以`goto`在其他语言中执行的操作或在机器语言中的分支）始终与绑定变量的范围一起使用。您只能通过提供绑定到其范围内的变量的值来“转到”程序中的某个位置。

Scheme`let`是一种说法，“我想创建一个绑定这些变量的范围，但我不想等到稍后再告诉它们的值。我想在这里指定它们的值。” 因此，`let`它只是一个生成 lambda 然后在那里提供值的宏。

如果您希望其中一个变量的值是使用另一个变量的表达式，就像上面`b`表达的方式一样`a`，那么`b`必须在`a`. 因此，`let*`宏定义了包含前一个变量的范围内的每个连续变量。由于我们有一堆嵌套的作用域，它们是由一堆嵌套的 lambda 实现的。

## 宏

以下是如何告诉 Scheme 如何将 a 重写`let*`为一堆嵌套的 lambda 和函数应用程序：

```
(define-syntax let*
  (syntax-rules ()
    [(__ () body ...)
      (begin body ...)]
    [(__ ([v e] [v* e*] ...) body ...)
      ((lambda (v)
         (let* ([v* e*] ...)
           body ...))
       e)]))

(let* ([a 1] [b (* 2 a)])
  (cons a b))
=> (1 . 2) 
```

在[Chez Scheme](http://www.scheme.com/petitechezscheme.html)中，您可以在 REPL 中通过键入`(expand '(let* ([a 1] [b (* 2 a)]) (cons a b))`并查看结果来解决这个问题。这是我尝试时出现的结果：

```
(let ([#:a 1]) (let ([#:b (#2%* 2 #:a)]) (#2%cons #:a #:b))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T01:13:07.040

`let*`只是嵌套`let`实例。例如，

```
(let* ((x v1)
       (y v2)
       (z v3))
  e) 
```

是相同的

```
(let ((x v1))
  (let ((y v2))
    (let ((z v3))
      e))) 
```

这对你的理解有帮助`let*`吗？:-)

更新：OP 正在询问（在对 Óscar 帖子的评论中）`let*`与`let`. 这是一个示例：首先，让我们使用`let*`：

```
(let ((x 42))
  (let* ((x 10)
         (y (+ x 13)))
    y)) 
```

这将返回 23 (10 + 13)。内部的值`x`被使用，外部的值`x`被遮蔽。

现在，让我们看看如果我们使用`let`而不是会发生什么`let*`：

```
(let ((x 42))
  (let ((x 10)
        (y (+ x 13)))
    y)) 
```

这将返回 55 (42 + 13)。内部的值`x`不用于计算`y`; 它只在`let`.

# c# - Windows Phone 7 上的 UV 纹理偏移动画

> ID：15939123
> 
> 赞同：2
> 
> 时间：2013-04-11T01:03:27.273
> 
> 标签：c#, windows-phone-7, animation, xna, xna-4.0

如果没有自定义着色器 (WP7)，如何实现简单的 UV 纹理动画？我只需要像在这个视频中那样抵消它：[https ://www.youtube.com/watch?feature=player_detailpage&v=VbDjHMer0Bw#t=309s](https://www.youtube.com/watch?feature=player_detailpage&v=VbDjHMer0Bw#t=309s)

我可以在模型甚至只是一堆顶点上执行此操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:12:48.233

如果您更改正在绘制的顶点，则无需自定义着色器即可实现这一点。

如果您在某处有一个顶点数组，则可以在以下位置执行以下操作`Update`：

```
var speed = new Vector2(0.1f, 0.1f);
Vector2 uvOffset = speed * (float)gameTime.ElapsedGameTime.TotalSeconds;

for (int i = 0; i < vertices.Length; ++i)
{
    vertices[i].TextureCoordinate += uvOffset;
} 
```

由于顶点经常变化，因此最好直接使用`DrawUserPrimitives`or来绘制它们`DrawUserIndexedPrimitives`，例如：

```
GraphicsDevice.DrawUserPrimitives<VertexPositionNormalTexture>(PrimitiveType.TriangleList, vertices, 0, vertices.Length / 3); 
```

在 XNA 上，`Model`所有内容都存储在非动态`VertexBuffer`s 中，这意味着您唯一的选择是复制缓冲区，更改它，然后将其重新复制回来。**请注意**，这可能非常缓慢且占用内存，具体取决于您的模型的复杂程度是。所以请记住这一点。

```
var speed = new Vector2(0.1f, 0.1f);
Vector2 uvOffset = speed * (float)gameTime.ElapsedGameTime.TotalSeconds;

//unset first
GraphicsDevice.SetVertexBuffer(null);

foreach (ModelMesh mesh in model.Meshes)
{
    foreach (ModelMeshPart mp in mesh.MeshParts)
    {                    
        //copy array first to change it
        var newVertices = new VertexPositionNormalTexture[mp.VertexBuffer.VertexCount];
        mp.VertexBuffer.GetData<VertexPositionNormalTexture>(newVertices);

        //offset all texture coords
        for (int i = 0; i < newVertices.Length; ++i)
        {
            newVertices[i].TextureCoordinate += uvOffset;
        }

        //set data back into buffer
        mp.VertexBuffer.SetData<VertexPositionNormalTexture>(newVertices);
    }
} 
```

如果您在数组中捕获初始纹理坐标，则始终可以在一定数量后返回它们；这样你就不会局限于不断地包裹整个纹理。

# youtube - Youtube API 播放列表跳过功能

> ID：15939132
> 
> 赞同：-2
> 
> 时间：2013-04-11T01:04:12.037
> 
> 标签：youtube, youtube-api, playlist

我看到了这个网站[http://youtube-related-music.appspot.com/index.html](http://youtube-related-music.appspot.com/index.html) 你看看即将到来的视频是什么，如果你想跳过它。

我需要类似但不相关的视频或搜索功能。只是中间区域（视频容器、正在播放、下一个按钮、下一个和跳过按钮）适用于 youtube 播放列表。

可能吗 ？需要哪一项？播放器 API 还是数据 API？

我不擅长写剧本。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T16:19:25.043

您提供的链接显示了一个非工作页面。

如果您从 youtube 创建并嵌入播放列表，
您会看到正在播放。
有一个下一步按钮。
你可以看到播放了什么以及接下来会播放什么。

此外，播放器内将显示整个列表的缩略图，
您的访问者可以通过它滚动并可以直接转到任何视频。

不需要脚本......只需嵌入一个“播放列表”
，其代码显示在 youtube 的播放列表页面上。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T01:51:26.320

谢谢回复。

在[此](http://youtube-related-music.appspot.com/index.html)站点中，您可以搜索视频并播放某些内容。视频带有进度条、缩略图、视频名称、上传者、已完成时间、剩余时间、下一个和跳过功能。 [http://i.stack.imgur.com/aCFYu.jpg](http://i.stack.imgur.com/aCFYu.jpg)

跳过功能不同于“嵌入播放列表”。Youtube 的经典嵌入播放列表只为您提供下一首歌曲按钮。但是在这个脚本中，您可以跳过第二首歌曲而没有完成第一首歌曲；）。但问题是这个基于相关视频的脚本。它可以适应播放列表吗？

祝你今天过得愉快

谢谢

# android - setOnItemClickListener 不工作

> ID：15939135
> 
> 赞同：6
> 
> 时间：2013-04-11T01:04:25.833
> 
> 标签：android, listview, onclicklistener

我试图让我的 setOnItemClickListener 工作，但是当我添加方法时，Eclipse 说我应该删除“@Override”注释，如果我这样做了，监听器就不起作用。问题是我需要捕获“点击”事件并做一些事情......这是我的方法：

```
list.setOnItemClickListener(new OnItemClickListener() {
    @Override //<-- this is the annotation that eclipse says I should remove
    public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

    }
}); 
```

我真的很确定问题不在于方法本身，我想它是别的东西。请查看我的活动并告诉我做错了什么：

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import android.app.Activity;
import android.content.Intent;
import android.database.SQLException;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.ListView;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;

public class Sounds extends Activity{

ListView list;
    LazyAdapter adapter;

 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);         
        setContentView(R.layout.list_table);
        list=(ListView)findViewById(R.id.list);
        ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();
        DB_Helper myDbHelper = new DB_Helper(this);       
        try {
            myDbHelper.createDataBase();
        }catch (IOException ioe) {
                throw new Error("Unable to create database");
        } 

        try {

            myDbHelper.openDataBase();
            String[] columns = new String[3];
            columns[0] = "id_Category";
            columns[1] = "category_name";
            columns[2] = "image_name";   
            songsList = myDbHelper.selectAll("Categories",columns);
        }catch(SQLException sqle){
            throw sqle;
        }

    adapter = new LazyAdapter(this, songsList);        
    list.setAdapter(adapter);

    // Click event for single list row
   list.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

          //ToDo something...
        }
    }); 
 }

 @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.about_sounds, menu);

        return true;
    }
 @Override
 public boolean onOptionsItemSelected(MenuItem item) {
     switch(item.getItemId()) {
     case R.id.about_sounds_item1:
         Intent talesToLearnActivity = new Intent(Sounds.this, AboutSounds.class);
            startActivity(talesToLearnActivity);
         break;
     default:

         break;
     }

     return true;
 }
} 
```

如果我删除注释，我的方法不会捕获事件。如果我不删除它，我的应用程序不会编译。顺便说一句，我正在使用 Android 2.2 SDK

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:18:57.750

检查项目属性并确保它`Java Compiler -> JDK Compliance -> Complier Compliance Level`是 1.6。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T03:52:50.093

检查项目中的属性并确保 Java Compiler -> JDK Compliance -> Complier Compliance Level 为 1.6。否则它将无法正常工作。

# python - python 3.2 tkinter，单选按钮中的文本不显示

> ID：15939152
> 
> 赞同：0
> 
> 时间：2013-04-11T01:06:50.267
> 
> 标签：python, text, tkinter, radio-button

所以我一直在玩python 3.2 tkinter。今天刚刚发现单选按钮中的文字没有显示在按钮旁边，它只显示“0”。此外，当我在单选按钮语句的末尾有 .pack() 时，它显示错误“NoneType”对象没有属性“pack”。太奇怪了，是因为他们在新版本中发生了变化。我需要导入其他东西吗？谢谢

```
from tkinter import*

class Name:
    def __init__(self, master):
        frame = Frame(master)
        frame.pack()

        self._var = IntVar()
        self._fullRadio = Radiobutton(frame, text="yes", textvariable=self._var, value=1)
        self._fullRadio.grid(row=2, column=0)#.pack()

        self._partRadio = Radiobutton(frame, text="no", textvariable=self._var, value=2)
        self._partRadio.grid(row=3)#.pack()

        self._notRadio = Radiobutton(frame, text="not both", textvariable=self._var, value=3)
        self._notRadio.grid(row=4)#.pack()

root = Tk()
application = Name(root)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:18:43.403

您想要参数`variable`，而不是`textvariable`：

```
from tkinter import*
class Name:
    def __init__(self, master):
        frame = Frame(master)
        frame.grid() # changed from frame.pack()

        self._var = IntVar()
        self._fullRadio = Radiobutton(frame, text="yes", variable=self._var, value=1)
        self._fullRadio.grid(row=2, column=0)

        self._partRadio = Radiobutton(frame, text="no", variable=self._var, value=2)
        self._partRadio.grid(row=3)

        self._notRadio = Radiobutton(frame, text="not both", variable=self._var, value=3)
        self._notRadio.grid(row=4)

root = Tk()
application = Name(root)
root.mainloop() 
```

此外，根据经验，最好不要在同一帧中混合`.grid()`和。`.pack()`

至于你的第二个问题：`.grid()`是另一个布局管理器。只是做`self._fullRadio.grid(row=2, column=0)`已经设置了布局；你不需要使用`.pack()`除了`.grid()`（在同一个对象上）。

你得到一个`NoneType`对象没有方法的错误，`.pack()`因为`self._fullRadio.grid(row=2, column=0)`返回`None`（它是一个方法调用）。坚持使用`grid`或`pack`，但不要同时使用两者。

# mysql - 在 sql 中使用 SELECT 和 GROUP_CONCAT 函数更新表行

> ID：15939158
> 
> 赞同：0
> 
> 时间：2013-04-11T01:07:27.127
> 
> 标签：mysql, sql, group-concat

我的 sql 数据库中有 3 个表。

这是我的数据表：

```
表格1
识别字
1个
2 乙
3℃
7点
14z
32问
57 我

表2
ID FORWORD
1个苹果
1个橙子
3碟1
3碟2
3碟3
14 本书
32 字母 1
32 字母 2
32 字母 3
57键盘
57 鼠标

表3
ROWID 单词名称
1 一个空
2 b 空
3 c 空
4 o 示例，示例 1
5 z 空
6 q 窗口，窗口 1
7 我为空

```

table1 和 table2 具有相同的 ID。table1 和 table3 有 WORD。我想更新 table3 中 NAME 列中的数据并获得如下结果：

```
表3
ROWID 单词名称
1个苹果，橙子
2 b 空
3 c 光盘1、光盘2、光盘3
4 o 空
5z书
6 q 字母 1、字母 2、字母 3
7 i 鼠标

```

请帮忙解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:27:45.537

我认为您正在寻找一个`UPDATE`with a `JOIN`，使用`GROUP_CONCAT`：

```
update table3 t3
  join (
    select t1.word, group_concat(t2.forward order by t2.forward separator ', ') name
    from table1 t1
      left join table2 t2 on t1.id = t2.id
    group by t1.word
    ) t on t3.word = t.word
set t3.name = t.name; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/8b1b4/2)

请注意，第 7 行应该返回键盘、鼠标，因为 table2 有 2 条记录，57。

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

# java - 论坛设计的混合内容警告

> ID：15939159
> 
> 赞同：2
> 
> 时间：2013-04-11T01:07:32.063
> 
> 标签：java, php, security, https, mixed-content

我目前正在我的本地主机上设计一个社交网络，其中还涉及一个论坛方面。用户可以在网站上做的三件事让我有些担心。

1.  通过站点上任何页面的标题登录到他们的个人资料。
2.  在他们的墙上张贴包含外部网站链接的内容。
3.  在论坛上发布各种不同的内容，包括指向外部站点的链接以及外部站点上的图像。

由于#1，我将整个网站设为 https。因此，无论用户在站点的哪个位置，他们都可以登录，并且他们的整个会话都将被加密。这个功能很好用，但我害怕`Mixed Content Warnings`。

现在，我在考虑是否让整个网站安全 b/c 如果我保持这种方式，是否会为每个链接到外部站点或来自外部站点的图像的页面显示混合内容警告？不幸的是，我从未见过此警告 b/c 我使用的所有浏览器似乎都没有向我显示。我搜索了某种显示此警告的浏览器列表，但我找不到有限的列表。所以这是尴尬的 b/c 我很担心并试图避免我从未见过的事情。但我想到了一种解决方案。

我目前关于如何解决图像问题的想法是在用户发布论坛时从用户那里获取图像并将它们写入我的磁盘，并提供新的图像链接。我很确定这正是谷歌图像在显示来自 http 站点的数百万张图像时保持 https 的方式。我认为他们将它们全部写入自己的服务器。例子：

[https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTj_52I-TSX79mQFJRLTDNGahtGbsh_BpYDp0H3hbzJDWK2qxPZ](https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTj_52I-TSX79mQFJRLTDNGahtGbsh_BpYDp0H3hbzJDWK2qxPZ)

所以我想我已经找到了解决图像问题的方法，但是外部链接呢？因为当用户在他们的墙上发布一个指向[https://stackoverflow.com/](https://stackoverflow.com/)的链接时，我会阅读该帖子并用一个锚标签将其包围，所以从技术上讲，对于浏览器来说，这不是不安全的内容吗？这不会发出警告吗？

我怎样才能解决这个问题而不惹恼我的用户？你对我的形象问题有更好的解决方案吗？感谢大家阅读我的困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T09:11:48.003

链接一般都可以。仅通过将它们包含在页面中，它们不会生成任何警告。他们可以在单击时执行：当页面从 HTTPS 导航到 HTTP 时，某些浏览器会显示警告。但在这种情况下，默认设置是“不再显示此警告”，因此几乎每个人都会在浏览的第一天点击它，并且永远不会再看到它。

检测用户提供的图像链接，在发布时间获取它们然后重新提供它们会起作用，但是要做的工作很多（我认为我没有看到其他论坛这样做）并且有一些安全警告 - 例如，您希望提供来自单独域的图像以避免 XSS 内容嗅探问题（如 Google 所做的`gstatic.com`），并设置限制以避免巨大的图像导致拒绝服务。

剩下的情况是 iframe 嵌入，一些用户可能希望为例如 YouTube 视频发布。在这里，您可以将 iframe 源限制为支持 HTTPS 的已知良好服务。

# wcf - 从其他项目引用 ServiceContract

> ID：15939161
> 
> 赞同：0
> 
> 时间：2013-04-11T01:08:33.310
> 
> 标签：wcf, visual-studio, architecture

我整天在这里和其他地方搜索，所以请原谅任何冗余，但是，我正在尝试做我收集到的应该是简单的、推荐的方式来构建 WCF 服务。

该场景是一个服务，为多个 ServiceContract 提供服务，每个 ServiceContract 在它自己的项目中。

我从简单开始；在我的解决方案中，我有一个 WCF ServiceLibrary 和一个类库，以及一个默认配置文件。

我在解决方案中有另一个项目，名为`WCF_Sandbox.Greeting`. 程序集名称是 WCF_Sandbox.Greeting.dll

在那个项目中有一个 IGreeting 类（装饰为 ServiceContract）和一个实现类 Greeting。

我**真的**很难获得通过服务公开的`SayHello()`方法。`IGreeting``WCF_Sandbox`

我不断得到

> “此服务未在...实施的服务中列出”

错误，或错误

> 没有可用的元数据。

如果有人能建议如何从这个其他项目获取服务以出现在 WCF_Sandbox 服务中，我将不胜感激。似乎这是很多人都在努力解决的一个基本问题，而且我还没有在任何地方看到它以直接的方式得到回答。非常感谢！

```
app.config file. System.Configuration does not support config files for libraries. -->
<system.serviceModel>
<services>
  <service name="WCF_Sandbox.Service1">
    <host>
      <baseAddresses>
        <add baseAddress = "http://localhost:8733/Design_Time_Addresses/WCF_Sandbox/Service1/" />
      </baseAddresses>
    </host>
    <endpoint address="" binding="basicHttpBinding" contract="WCF_Sandbox.IService1">
      <identity>
        <dns value="localhost"/>
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior>
      <serviceMetadata httpGetEnabled="True" httpsGetEnabled="True"/>
      <serviceDebug includeExceptionDetailInFaults="False" />
    </behavior>
  </serviceBehaviors>
</behaviors>
</system.serviceModel>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T06:22:33.443

我想我理解你想要完成的事情——你想通过库将服务与其他代码分开——这一切都很好，但我认为你有一些基本的误解。我不确定您的整体经验水平如何，所以如果我说的任何内容您已经知道或理解，请原谅我。

首先，库不是可执行代码。使用库（我知道）的唯一方法是让执行程序使用它。它们提供了一种在多个应用程序之间共享代码的方法，而无需源代码的多个副本。在 WCF 术语中，这是一种将合同与托管应用程序分开的方法。

因此，在您的情况下，听起来您已经创建了库（顺便说一下，WCF 服务库**是**一个类库 - 它只是一个不同的项目模板，可以让您启动并运行 WCF）。

接下来需要做的是托管服务。您可以通过 IIS、Windows 服务或自托管应用程序执行此操作。例如，如果您打算在 IIS 中托管您的服务，您可以将包含您的服务的库 (DLL) 放在您计划托管该服务的虚拟目录/应用程序的 bin 文件夹中。然后，您将在虚拟目录/应用程序的根目录中为该服务添加一个 *.svc 文件，并将 ServiceModel 部分从默认的 app.config 文件复制到 web.config 文件。

要使用服务，您可以通过 Visual Studio 添加服务引用（在将使用服务的项目中）或通过 SvcUtil 生成代理并将其包含在客户端项目中。

简而言之，如果我正确理解了您的设置，那么您就成功了。您只需要托管服务，然后编写一个客户端来使用它。

有很多事情我没有在这里介绍 - 这只是我认为你正在尝试做的事情的一种方式。

我强烈建议阅读微软的[入门教程](http://msdn.microsoft.com/en-us/library/ms734712.aspx)——尤其是关于托管和创建客户端的部分。

我希望这可以消除您的一些困惑 - WCF 有许多不同的选项和风格，非常棒，但它也可能有一个陡峭的学习曲线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T04:31:47.060

正如@Tim 提到的，代码可能很有用。

我建议以下步骤：

1）。确保项目参考（@Tim 建议） - 我想你已经做到了

2）。可能是我错了，但是如果您的服务合同是 IGreeting，那么端点应该包含 IGreeting 而不是 Service1，看起来像

> ...端点地址=""绑定="basicHttpBinding"合同=" **WCF_Sandbox.IGreeting** "

3）。确保合约属性具有完整的限定接口名称（即完整的命名空间 + 接口名称）。

4）。尝试使用 WCF 配置工具（可从 Visual Studio 工具-> 菜​​单中获得）手动选择您的合同，然后查看您的配置文件。

# stored-procedures - db2 存储过程创建行为

> ID：15939165
> 
> 赞同：1
> 
> 时间：2013-04-11T01:08:55.997
> 
> 标签：stored-procedures, db2, db2-luw

我正在使用 db2 存储过程，并且在理解以下概念时遇到了困难。当我创建如下简单的存储过程时

```
create or replace procedure test()
begin
insert into mytable(a) values ('a');
insert into mytable(a) values ('b');
insert into mytable(a) values ('c');
end 
```

我可以看到 mytable 在此创建过程中被填满。我期待使用'call test()'来插入我的数据，但我可以看到它不是我想的那样。我在这里做错了什么或者它确实像这样工作？

为了避免这种奇怪的行为，我发现我需要将所有内容放在同一行，并且我有我所期望的，即当我调用任何“创建或替换过程”时没有插入数据

```
create or replace procedure test() begin insert into mytable(a) values ('a'); insert  into mytable(a) values ('b');  insert into mytable(a) values ('c');     end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T08:41:55.150

您正在使用该`-t`选项，它指定它`;`是语句终止符。

在编写过程或其他代码块时，不能使用分号作为语句终止符，因为需要将整个过程声明视为单个语句。DB2 将其分解为基于分号的多个语句。

[使用`-tdX`选项](http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/index.jsp?topic=/com.ibm.db2.luw.admin.cmd.doc/doc/r0010409.html)将语句终止符设置为其他内容。我`!`在 DB2 中用作标准语句终止符，它对我很有效（它在 DB2 语法中不使用，除了`!=`，可以替换为`<>`）。

进行此更改应该可以解决您的问题。

不过，我很惊讶将它放在一行上使它起作用，因为我不希望这会产生任何影响（有一个选项可以自动将行视为语句终止符，但您没有启用它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T09:22:20.733

问题是每条指令的终止字符。

例如，如果您有一个名为 test.sql 的脚本文件，其中包含插入和存储过程定义，那么您的定义将是：

测试.sql

```
insert into mytable (a) values ('a')@
create procedure test ()
  begin
    insert into mytable (a) values ('b');
  end@ 
```

您将通过此命令执行脚本

```
 db2 -td@ -f test.sql 
```

@ 符号表示终止字符（选项 -td@ 表示终止字符分隔符）。请注意，这与 ; （分号）因为 ; 用作例程（存储过程、udf、触发器）中的终止字符。

如您所见，“a”值将插入到第一个插入中。'b' 值将从存储过程中插入。

为了确定您插入了什么，您可以查询 DB2 目录以查看定义的存储过程和“主体”。

# php - 使用本地 WAMP 服务器测试联系表

> ID：15939169
> 
> 赞同：0
> 
> 时间：2013-04-11T01:10:04.007
> 
> 标签：php, html, localhost, wampserver

我正在制作联系表格，以便有人可以向指定的电子邮件发送消息。但是，我收到一条非常持久且不会消失的错误消息：

```
Warning: mail(): Failed to connect to mailserver at &quot;localhost&quot; port 25, verify your &quot;SMTP&quot; and &quot;smtp_port&quot; setting in php.ini or use ini_set() in C:\wamp\www\mail.php on line 10 
```

我尝试按照指定在第 10 行放入 ini_set() ，但是它没有改变任何东西。我试图研究可能是什么情况，但到目前为止还没有遇到任何事情。我在想也许 WAMP 不支持邮件。

* * *

HTML 代码

```
<form action = "mail.php" method=  "POST">
    <p>Name</p> <input name = "name" type = "text">
    <p>Email</p> <input name = "email" type = "text">

    <p>Message</p><textarea name = "message" rows = "6" cols = "25"></textarea><br />
    <input value = "Send" type = "submit" >
    <input value = "Reset Form" type = "reset">
</form> 
```

成功制作表单的地方，通过提交按钮将数据发送到 mail.php。

* * *

PHP 代码

```
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];

$recipient = "To: myawesome.email@gmail.com";
$mailheader = "From: $name \r\n";
$formcontent= "From: $email \r\n Message: $message";

mail($recipient, $mailheader, $formcontent) or die("Error!");
echo "Your message has been delivered." . " -" . "<a href='form.html' style='text-decoration: none; color: #ff0099;'> Return Home </a>";
?> 
```

mail.php 应该接收 $recipient、$mailheader 和 $formcontent 并将它们通过电子邮件发送到指定地址。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:15:58.253

要么您没有在端口 25 上运行邮件服务器（很可能是这种情况），要么您有软件防火墙阻止了该端口。

* * *

请注意，即使使用本地运行的邮件服务器，您的 ISP 也很可能会阻止端口 25 - 这是防止垃圾邮件的正常做法。

要从本地服务器进行测试，并实际发送电子邮件，您很可能需要使用外部电子邮件提供商 - 并在 25 以外的端口上连接到它。Gmail 的 SMTP 服务器（TLS，端口 465）将在这里创造奇迹，但您需要通过 Gmail 帐户进行身份验证和发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:12:49.110

您是否尝试检查您的邮件服务器是否正确配置或像此示例一样配置它

```
// Please specify your Mail Server - Example: mail.example.com.

ini_set("SMTP","mail.example.com");
// Please specify an SMTP Number 25 and 8889 are valid SMTP Ports.

ini_set("smtp_port","25");

// Please specify the return address to use

ini_set('sendmail_from', 'example@YourDomain.com')
; 
```

或者检查你的 php.ini 文件。这是一个示例配置。

```
[mail function]
; For Win32 only.
SMTP = localhost
smtp_port = 25

; For Win32 only.
;sendmail_from = me@example.com
; For Unix only.  You may supply arguments as well (default: "sendmail -t -i"). 
```

# php - CakePHP（或只是 PHP）获取会话持续时间

> ID：15939177
> 
> 赞同：0
> 
> 时间：2013-04-11T01:11:42.820
> 
> 标签：php, cakephp, session-timeout

有什么方法可以获取用户会话的持续时间？

如果用户登录，我可以节省初始时间。如果他注销，我可以得到最后的时间并计算会话的持续时间。

如果用户没有注销并且会话刚刚过期怎么办？有什么方法可以知道是否/何时发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:24:58.600

无法知道会话是否仍处于活动状态，因此您可以做的最好的事情是`SESSION_START_TIME`在您的数据库和每个请求日志上保存一个`LAST_REQUEST_TIME`.

这样您就知道会话的开始时间和“可能”结束时间。

您还可以通过使用...检查所有会话来了解现在有多少活动会话，`LAST_REQUEST_TIME<5minutes`因此这不是一个糟糕的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:29:52.867

不，不是。HTTP 会话较少。真正想要更细致地了解活跃用户的人会经常使用某种心跳技术，它创建一个持久连接或通过轮询、使用 ajax、flash 电影或 websockets 来模拟它。

PHP 会话实际上更像是一种将一些临时服务器端存储与特定客户端/浏览器实例链接起来的机制，尽管有些人可能会读入名称。

# java - eclipse更新很慢

> ID：15939181
> 
> 赞同：1
> 
> 时间：2013-04-11T01:12:33.807
> 
> 标签：java, eclipse, eclipse-plugin, updates, performance

每次我启动 Eclipse （无论我的电脑打开了 2 小时还是 1 分钟），更新速度都比平时慢得多。我的意思是，如果我有诸如绘画方法之类的东西，则更新非常缓慢，并且以更慢的速度将内容绘画到屏幕上。

这通常会在短时间内停止，但有时会持续一个小时或更长时间。我在网上搜索过这个，但似乎找不到任何东西。我的台式机和笔记本电脑都遇到了这个问题。

有没有其他人遇到过这个问题？我在想它可能与插件有关，但我不完全确定。有关修复的任何建议或可能的解释？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:29:04.103

尝试使用命令行清理您的 Eclipse 安装`eclipsec.exe -clean`：

> 修复尘土飞扬的工作区的最简单方法是使用 eclipse.exe 可执行文件的 -clean 命令行参数。

[http://www.eclipsezone.com/eclipse/forums/t61566.html](http://www.eclipsezone.com/eclipse/forums/t61566.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:23:23.397

您需要查看哪些进程同时在运行，并注意它们的 cpu 和内存使用情况。

在 Windows 上这是 cnlt-alt-delete 在 unix 上是 ps -au 和变体

还要注意网络使用情况。

您可能有一个需要或不需要的后台进程占用资源。

# java - 如何在此程序中添加图片

> ID：15939188
> 
> 赞同：0
> 
> 时间：2013-04-11T01:13:34.907
> 
> 标签：java, user-interface, image

大家好，我想问一下，我有这个程序，它有 6 个按钮，每个按钮都会显示不同的东西，但我想知道当我点击“图片 1”时如何让它显示图片以及这些图片应该放在哪里所以该程序知道在哪里可以找到它们？谢谢希望你能帮忙：ps我用的是netbeans

```
import java.awt.Toolkit;
import java.awt.Dimension;  
import java.awt.Container;
import java.awt.FlowLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
  public class Gui {
static JFrame aWindow = new JFrame("This Is Me:");
   public static void main(String[] args) {
    int windowWidth = 600;                                      
    int windowHeight = 500;                                     
   aWindow.setBounds(500,500, windowWidth, windowHeight);       
   aWindow.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
FlowLayout flow = new FlowLayout();                             
 Container  content = aWindow.getContentPane();                 
 content.setLayout(flow);                                            
    for(int i = 1; i <= 5; i++) {
          content.add(new JButton("Picture " + i));}           
    String path = "__2 copy.jpg";
     aWindow.setVisible(true);                                   
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:21:25.563

> 当我单击“图片1”时，如何让它显示图片？

您需要先将 a 附加`ActionListener`到按钮上。`actionPerformed`然后，您需要在该方法中加载图像。

加载图像的最佳方式是使用`ImageIO`API。如何实现这一点取决于图像的存储方式。

如果图像存储在应用程序 Jar 中（捆绑资源，见下文），您将使用类似...

```
ImageIO.read(getClass().getResource("/path/to/image.jpg"); 
```

如果它们存储在外部...

```
ImageIO.read(new File("relative/path/to/image.jpg"); 
```

加载图像后，您可以使用 an`ImageIcon`包装加载的图像`ImageIO`并将其应用于`JLabel`.

看...

*   [如何编写动作监听器](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)
*   [读取/加载图像](http://docs.oracle.com/javase/tutorial/2d/images/loadimage.html)
*   [如何使用标签](http://docs.oracle.com/javase/tutorial/uiswing/components/label.html)

更多细节。

当然，您可以创建自己的图像组件来显示图像，但这是一个相当先进的主题，我不确定这是否是您想要的。

> 这些图片应该放在哪里，以便程序知道在哪里可以找到它们？

这取决于。您希望图像始终可用于程序还是要更改它们？

如果图像不太可能经常更改，您可以将它们作为内部资源嵌入到 Jar 文件中。这如何完成取决于您构建应用程序的方式，但一般而言，您在项目源中创建一个目录并将图像放置在那里。然后，您可以通过类加载器引用图像。

如果您希望能够快速更改图像（并且不需要重新构建应用程序），那么我会将它们存储在与应用程序 Jar 相同的目录中。`File`这将允许您从相对位置（即`new File("Image.jpg");`）将它们引用为s

**更新了示例**

![在此处输入图像描述](https://i.stack.imgur.com/GOkhD.png)

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.io.File;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestImages {

    public static void main(String[] args) {
        new TestImages();
    }

    public TestImages() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestPane extends JPanel {

        private JLabel lblPic;

        public TestPane() {
            setLayout(new BorderLayout());
            JPanel buttons = new JPanel(new FlowLayout(FlowLayout.CENTER));
            JButton btnFile = new JButton("Load from file");
            JButton btnResource = new JButton("Load from resource");

            buttons.add(btnFile);
            buttons.add(btnResource);

            btnFile.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    try {
                        BufferedImage image = ImageIO.read(new File("Pony01.png"));
                        lblPic.setIcon(new ImageIcon(image));
                    } catch (Exception exp) {
                        JOptionPane.showMessageDialog(TestPane.this, "Failed to load image", "Fail", JOptionPane.ERROR_MESSAGE);
                        exp.printStackTrace();
                    }
                }
            });

            btnResource.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    try {
                        BufferedImage image = ImageIO.read(getClass().getResource("/Pony02.png"));
                        lblPic.setIcon(new ImageIcon(image));
                    } catch (Exception exp) {
                        JOptionPane.showMessageDialog(TestPane.this, "Failed to load image", "Fail", JOptionPane.ERROR_MESSAGE);
                        exp.printStackTrace();
                    }
                }
            });

            lblPic = new JLabel();
            lblPic.setVerticalAlignment(JLabel.CENTER);
            lblPic.setHorizontalAlignment(JLabel.CENTER);
            add(lblPic);
            add(buttons, BorderLayout.NORTH);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(300, 300);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.dispose();
        }
    }
} 
```

显然，您需要提供自己的图像。嵌入的资源应该存在于源代码的顶层文件夹中（通常称为`default`包）

# linux - 从数组中排除字符串项

> ID：15939192
> 
> 赞同：1
> 
> 时间：2013-04-10T20:04:02.337
> 
> 标签：linux, shell

我有一个脚本，我想从第二个列表中指定的数组中删除项目，我有以下代码，但它不起作用：

```
db_exclude=( 'information_schema' 'mysql' )

databases=$(/usr/bin/mysql --defaults-extra-file=/etc/unimicrosys/sqlbackup/my.cnf -e 'show databases' -s --skip-column-names)
length=${#databases[@]}

for exclude in $db_exclude[@]; do
    for (( i=0; i<$length; i++ )); do
        echo $i
        if [[ databases[$i] = $exclude ]]; then
            unset $databases[$i];
        fi;
    done
done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:58:10.613

我无法检查 mysql 命令是否生成数组，但如果数据库设置为数组，则此方法有效

```
db_exclude=( 'information_schema' 'mysql' )

databases=( 'aaaa' 'information_schema' 'bbb' 'mysql' 'ccc' )

length=${#databases[@]}

for exclude in ${db_exclude[@]}; do
    for (( i=0; i<$length; i++ )); do
        echo $i
        if [[ ${databases[$i]} = $exclude ]]; then
            unset databases[$i];
        fi;
    done
done

echo ${databases[@]} 
```

我通过运行脚本发现了问题，该脚本`bash -x`显示 for 循环仅执行一次，并且比较的是文本“数据库 [0]”，而不是值。

# gmail - 如何在 Google 日历中使用别名？

> ID：15939194
> 
> 赞同：18
> 
> 时间：2013-04-11T01:14:19.840
> 
> 标签：gmail, google-calendar-api, icalendar

我有一个 google 帐户（比如 hellome@gmail.com），它设置为为许多其他帐户（hellome@mydomain.com、secondaccount@gmail.com ...）发送邮件。

对于这些帐户中的至少一个 (hellome@mydomain.com)，google 不会让我设置单独的 google 帐户。它说有一个现有帐户并且它已被禁用。也许这是因为它已经连接到一个 gmail 帐户。

我想将谷歌日历事件创建为“hellome@mydomain.com”，即让“hellome@mydomain.com”显示在事件的“创建者”字段中，而不是“hellome@gmail.com”。

这很重要，因为在为工作创建事件时，我不希望我的个人电子邮件出现。有没有办法切换电子邮件帐户、隐藏或更改 Google 日历中的“创建者”字段？非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-06-02T09:36:00.990

据我所知，这是不可能的。谷歌忽略了数百名有同样问题的人。我们刚刚取消了我们的 Google Apps for Business 帐户，只是因为此功能不可用。

我们与其他所有企业一样，在向客户发送谷歌日历活动时不想使用个人名称@company.com，而是使用别名 sales@company.com

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-26T03:56:32.170

有可能的。

1.  使用您的备用电子邮件地址设置一个 google 帐户，并且
2.  更改日历设置以与您的主要 Google 帐户共享其日历
3.  从下拉框中进行新会议时选择该日历。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-19T08:28:08.577

有一种方法可以做到这一点，

1.  将 sales@ 创建为邮箱而不是别名。
2.  然后授予您的 name@，对 sales@ 帐户的邮箱和日历的完全创建/修改/编辑权限

您还可以在 GSuite 中创建一个群组（即使只有 1 个人），并允许该群组管理 sales@ 邮箱和日历。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-27T14:57:45.947

我也是 GSuite 的用户，我尝试了很多东西，但似乎我们确实需要添加一个新用户（每月额外支付 4 欧元）。

BR,

理查德。

# apache - 如何告诉 Apache 只使用一个 .htaccess 文件而不请求任何其他文件？

> ID：15939195
> 
> 赞同：2
> 
> 时间：2013-04-11T01:14:22.160
> 
> 标签：apache, .htaccess, configuration, apache2, virtualhost

我可以告诉 Apache`.htaccess`我的应用程序中只有一个文件吗？

例如，如果我有一个`.htaccess`文件`public_html`并且我`AllowOverride`没有`none`在我的虚拟主机上设置，[文档](http://httpd.apache.org/docs/2.2/en/howto/htaccess.html#page-header)说对于我拥有的每个 HTTP 请求，Apache 服务器将尝试`.htaccess`在当前目录和高-水平的。

但我想`.htaccess`在整个应用程序上只保留一个文件，我不希望 Apache 尝试`.htaccess`在当前目录和高级目录中查找文件，**而只是读取`public_html/.htaccess`文件**。

这样做的动机是因为我想获得一个网站托管，但我不允许更改我的 VirtualHost。因此，要执行服务器操作，`.htaccess`我允许使用文件。但是，如果我可以在我的主`public_html/.htaccess`文件上知道没有其他`.htaccess`文件，我的应用程序可能会节省很多处理。

有可能做到这一点吗？如何？

如何测试是否有效？

**编辑**

[文档](http://httpd.apache.org/docs/current/mod/core.html#allowoverride)说：

**允许覆盖**

```
Only available in <Directory> sections
AllowOverride is valid only in <Directory> sections specified without regular expressions, not in <Location>, <DirectoryMatch> or <Files> sections. 
```

所以，我不能`AllowOverride None`在我的`public_html/.htaccess`文件上尝试类似的东西。但是有没有办法计算这个？

# apache-flex - 在 flex 端缩放 SVG 图像

> ID：15939196
> 
> 赞同：0
> 
> 时间：2013-04-11T01:14:22.980
> 
> 标签：apache-flex, svg

以下是我的问题的子部分：

1.  如何将生成的 svg 文件从服务器（java）发送到客户端（flex）？（我应该将它作为 ByteArray 发送还是使用其他方法？）
2.  如何从 flex 显示这个 svg？（我应该将图像文件svg的源属性设置为xml吗？）
3.  如何从 flex 端缩放这个 svg？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:45:48.113

> 如何将生成的 svg 文件从服务器（java）发送到客户端（flex）？（我应该将它作为 ByteArray 发送还是使用其他方法？）

SVG是一种文本格式；因此，如果您正在寻找一种通过电线发送的简单方法；我会用文字。

> 如何从 flex 显示这个 svg？（我应该将图像文件svg的源属性设置为xml吗？）

SVG 不是 Flash Player 的原生格式。我认为您需要构建一个基于 ActionScript 的 SVG 渲染器/查看器，以便在 Flash 平台应用程序中使用 SVG 查看器执行任何操作。 [这是一个这样的库](http://odd.ness.io/category/svg-viewer)。

我相信 Flex 编译器可以在 SVG 上发挥一些作用，使其成为在 Flex 中可用的东西。 [更多关于这里](http://livedocs.adobe.com/flex/3/html/help.html?content=embed_4.html)的信息。您必须在编译时嵌入 SVG 图形；它在运行时不会做任何事情。

您可以使用命令行工具在服务器上将 SVG 编译为 SWF，然后让您的 Flex 应用程序加载 SWF。

> 如何从 flex 端缩放这个 svg？

一旦确定了如何将其显示为 Flex 组件，就可以使用[scaleX](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/UIComponent.html#scaleX)、[scaleY](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/UIComponent.html#scaleY)和[scaleZ](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/UIComponent.html#scaleZ)属性来放大或缩小。

# mod-rewrite - seo 的 mod_rewrite 循环模式

> ID：15939197
> 
> 赞同：0
> 
> 时间：2013-04-11T01:14:37.720
> 
> 标签：mod-rewrite

我有以下链接

[http://xyz.com/path1/path2/page/par1/par1value/par2/par2value/par3/par3value](http://xyz.com/path1/path2/page/par1/par1value/par2/par2value/par3/par3value) ....未定义的参数数量

我希望通过 mod_rewrite 将其转换为类似的东西：

[http://xyz.com/path1/path2/page.php?par1=par1value&par2=par2value&par3=par3value&par4=par4value](http://xyz.com/path1/path2/page.php?par1=par1value&par2=par2value&par3=par3value&par4=par4value) ...

我做了很多尝试，但没有一个完全成功。我最终得到了类似的东西 - 对于 2 个参数（虽然它不会重复）

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.+)\/(.+)\/(.+)\/(.+)\/(.+)[^/]+$ $1.php?$2=$3&$4=$5 [L] 
```

我对此解决方案不满意，请帮助我正确构建条件

在此先感谢诺伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T11:27:25.297

最后我这样做了：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+?)/(.*?)$ $1.php?route=$2 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ $1.php [L] 
```

和

*   我正在解析我的 PHP 脚本中的“路由”
*   从 GET 数组中删除“路线”作为 SEO 类的一部分

    ```
     public static function router($router = "route") {
        if ($route = GetFromGet($router)) {
            $arr = preg_split('/\//', $route);
            if (sizeof($arr)) {
                unset($_GET[$router]);
                foreach ($arr as $key => $value) {
                    if (($key % 2) == 1) {
                        $_GET[$arr[$key - 1]] = $value;
                    }
                }
            }
        }
    } 
    ```

因此，在我调用的常用文件的开头某处：

```
SEO::router(); 
```

以上解决了这个问题，但是我仍然很好奇 mod_rewrite 本身是否有可能。

# android - 使用振荡 LED 灯会省电吗？

> ID：15939198
> 
> 赞同：2
> 
> 时间：2013-04-11T01:14:38.740
> 
> 标签：android, performance

如果我的应用程序不只是打开 LED 灯，而是让它像下图所示那样快速闪烁，或者只是保持打开状态，我的应用程序会节省电池吗？

```
pon.setFlashMode(Camera.Parameters.FLASH_MODE_TORCH);
poff.setFlashMode(Camera.Parameters.FLASH_MODE_OFF);

while(lightShouldBeOn) {
        try{
                cam.setParameters(pon);
                Thread.sleep(delay);
                cam.setParameters(poff);
                Thread.sleep(delayoff);
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:27:36.293

脉冲波调制是用于 LED 以及其他设备的功率控制的众所周知的技术。作为一个额外的好处，功率和强度与占空比高度线性。

通常，处理器中会有一个 PWM 外围设备为您处理快速切换，但这需要驱动程序支持；用户应用程序将无法访问它。这是一个使用驱动程序来做的问题：[在Android中设置闪光灯的亮度](https://stackoverflow.com/questions/8851897/set-brightness-of-flash-in-android)

但这并不是一个真正的软件问题。

# ruby-on-rails-3 - 如何在 Prawn 中设置子表的格式和样式？

> ID：15939199
> 
> 赞同：2
> 
> 时间：2013-04-11T01:14:43.773
> 
> 标签：ruby-on-rails-3, pdf, prawn

我是使用 Prawn 生成 PDF 的新手，所以这可能是一个简单的问题，但它让我发疯了！

我有一个带有嵌套子表的表。我已经能够轻松地设置主表的样式和格式，但我似乎不能对嵌套的子表做同样的事情。我真正需要做的就是设置列宽并删除边框，但我似乎无法弄清楚。

这是我到目前为止的代码：

```
 def line_items
    data = line_item_rows
    table(data)  do
       row(0).font_style = :bold
       columns(0).width = 160
       columns(1).width = 300
       columns(2).align = :right
       columns(2).valign = :bottom
       row(0).columns(2).valign = :top
       row(0).columns(2).align = :left
       self.header = true
    end   
  end

  def line_item_rows
    [["Description", "Items" ,"Price ex GST"]] +
    @line_items.map do |item|
      [item.description, sub_item_rows(item), price(item.charge_ex_gst)] 
    end +
    [["","Total", price(@project.charge_ex_gst)]]
  end

  def sub_item_rows(item)
   item.sub_items.map do |sub_item|
      ["#{sub_item.quantity} x  #{sub_item.name} #{price(sub_item.total_charge_ex_gst)}"] 
    end
  end 
```

关于如何将样式应用于子表的任何建议？在此先感谢您的帮助。

干杯，马克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T09:52:23.950

好的，这就是它的修复方法。我需要使用“make_table”并在那里应用格式，如下所示：

```
 def line_items
    move_down 15
    data = line_item_rows

        table(data) do
           row(0).font_style = :bold
           columns(0).width = 160
           columns(1).width = 300
           columns(2).align = :right
           columns(2).valign = :bottom
           row(0).columns(2).valign = :top
           row(0).columns(2).align = :left
           self.header = true
        end     
  end

  def line_item_rows
    [["Description", "Items" ,"Price ex GST"]] +
    @line_items.map do |item|
      [item.description, 
        sub_items(item), 
        price(item.charge_ex_gst)] 
    end +
    [["","Grand Total", price(@project.charge_ex_gst)]]
  end

  def sub_items(item)
    sub_data = sub_item_rows(item)
    make_table(sub_data) do
       columns(0).width = 200
       columns(1).width = 100
       columns(1).align = :right
       #columns(0).borders = []
    end   
  end

  def sub_item_rows(item)
   item.sub_items.map do |sub_item|
      ["#{sub_item.quantity} x #{sub_item.name}", price(sub_item.total_charge_ex_gst)] 
    end  +
      [["","Total"]]
  end 
```

# macos - NSColor 在屏幕上显示不同的颜色

> ID：15939200
> 
> 赞同：0
> 
> 时间：2013-04-11T01:14:53.730
> 
> 标签：macos, cocoa

我扩展 NSColor 以添加类方法

```
+ (NSColor*) initWithHTMLString: (NSString*) rgb 
```

我为 NSWindow 对象设置了背景颜色：

```
[self.window setBackgroundColor:[NSColor initWithHTMLString:@"37854F"]]
NSLog(@"Color=%@",[self.window.backgroundColor toHTMLRGB]); 
```

当我运行程序时，日志行是`"Color=37854F"`. 但是，我使用 PixelStick 工具来丢弃颜色像素，像素颜色不是`37854F`，颜色分量比它的原点小一点。

有没有人知道解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T07:13:36.057

产生差异的原因是使用 obj-c 创建的颜色经过调整以考虑当前颜色配置文件（请参阅系统首选项 -> 显示器 -> 颜色）。到目前为止，当您有多个监视器并将正在运行的应用程序从一个监视器拖到另一个监视器时，相同的颜色会出现不同的显示。不幸的是，即使您使用 colorWithDeviceRed:Green:Blue:Alpha 代替 colorWithCalibratedRed:Green:Blue:Alpha，在特定显示器上使用精确的颜色也是非常困难的。

色彩感知是一件复杂的事情，各种输出设备起着重要的作用，难怪没有1:1的映射。但是，如果两者都在同一台显示器上运行，那么确实应该可以创建一种颜色（例如在绘画应用程序或颜色管理应用程序、设计师应用程序等中）并在 Cocoa 中重新创建完全相同的颜色。

值得注意的是：当您在 OSX 上的设计中使用您的颜色（无论是浏览器中的图像或 PDF 文件或其他任何内容）并在虚拟机（例如 Parallels Desktop 中）的 Windows 应用程序中使用其组件值时，您可以重现任何屏幕颜色选择器显示的确切颜色。

[更新]：由于将系统颜色配置文件设置为通用颜色配置可以解决颜色匹配问题，因此可能值得考虑在代码中创建自己的通用颜色空间，如本[技术问答中所述](https://developer.apple.com/library/mac/#qa/qa1396/_index.html)

[更新]：我刚刚发现另一个 NSColor 消息，看起来是我们都在寻找的：

```
NSColor colorWithSRGBRed:green:blue:alpha 
```

在一些测试中，我可以看到颜色是准确的。不幸的是，此消息仅适用于 10.7 及更高版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-12T02:34:48.677

这是您使用精确屏幕颜色（Swift 3）初始化 NSColor 的方式：

```
let components = [red, green, blue, alpha]

let color = NSColor(
    colorSpace: NSScreen.main()!.colorSpace!, 
    components: components,
    count: 4) 
```

如果您对屏幕截图进行颜色选择，您可以确认 RGB 组件完全匹配。

# git - 忽略 Git 中注释掉的文件头信息

> ID：15939203
> 
> 赞同：-1
> 
> 时间：2013-04-11T01:15:05.057
> 
> 标签：git, version-control

在我的编码项目中，每个文件通常都有一个注释掉的标题部分，其中包含有关文件的一些信息，包括当前项目版本。每当我发布项目的新版本时，我都需要更新所有文件中的版本信息。

我的问题如下：当我检查不同提交之间的文件更改时，它自然显示项目中的每个文件都已更改，这使得很难发现实际更改。有没有办法忽略对文件标题部分的更改？我正在寻找诸如 git 标签或关键字之类的东西来放置在我需要忽略的任何行上，类似于：

```
/* <gitignore> Project Version: 10.6 </gitignore> */ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T01:51:10.330

`git`正如您可能已经知道的那样，已经跟踪了版本信息。尝试使此类评论保持最新可能会很麻烦，并且很容易错过某些内容或以其他方式使它们不同步。我建议您从文件本身中删除此信息，并用于`git tag`将提交标记为发布版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T02:32:55.410

您可以使用[关键字扩展](http://git-scm.com/book/ch7-2.html#Keyword-Expansion)。但是，一般来说，我不会将插入版本号作为版本控制的一部分，而是将其作为发布过程的一部分。

# android - 在 Facebook Android SDK 中刷新令牌权限

> ID：15939204
> 
> 赞同：4
> 
> 时间：2013-04-11T01:15:11.663
> 
> 标签：android, facebook, facebook-android-sdk

我一直在到处寻找，但找不到任何具体信息。

根据最新的 SDK 3.0 文档 [http://developers.facebook.com/docs/reference/android/3.0/AccessToken#getPermissions](http://developers.facebook.com/docs/reference/android/3.0/AccessToken#getPermissions)：

AccessToken.getPermissions() 返回的权限列表“如果自创建 AccessToken 对象以来已添加或删除权限，则可能已**过时”**

我的问题是：
有没有办法要求**刷新权限列表**，以便令牌可以反映 Facebook 保留的最新权限列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-27T11:56:35.170

从 Facebook SDK 版本 3.14 开始，Facebook 在 Session 类中添加了 refreshPermissions 方法。

有关更多信息，您可以查看 github 中的源代码： [https ://github.com/facebook/facebook-android-sdk/blob/f6c4e4c1062bcc74e5a25b3243f6bee2e32d949e/facebook/src/com/facebook/Session.java#L605](https://github.com/facebook/facebook-android-sdk/blob/f6c4e4c1062bcc74e5a25b3243f6bee2e32d949e/facebook/src/com/facebook/Session.java#L605)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T04:16:14.260

找到满足我需求的解决方案：

而不是更新我的令牌，我只是进行 FQL 查询来检索我想知道的权限的远程（最新）状态

以下代码查询有关发布权限（官方称为“publish_actions”）：

```
public void asyncQueryIfHasPublishPermissions() {
    String fqlQuery = "SELECT publish_actions FROM permissions WHERE uid = me()";
        Bundle params = new Bundle();
        params.putString("q", fqlQuery);
        Session session = Session.getActiveSession();
        Request request = new Request(session,
            "/fql",                         
            params,                         
            HttpMethod.GET,                 
            new Request.Callback(){         
                public void onCompleted(Response response) {
                    JSONObject graphResponse = response.getGraphObject().getInnerJSONObject();
                    boolean publishPermissions = false;
                    try {
                        if (graphResponse.getJSONArray("data").getJSONObject(0).getInt("publish_actions")==1) {
                            publishPermissions = true;
                        }
                    } catch (JSONException e) {
                        Log.e("FacebookIntegration", "JSON error "+ e.getMessage());
                    }
                    FacebookRequestError error = response.getError();
                    if (error != null) {
                        Log.e("FacebookIntegration", "FacebookRequestError "+ error.getErrorMessage());
                    }
                    Log.i("FacebookIntegration", "asyncQueryIfHasPublishPermissions response: "+publishPermissions);
                }                  
        }); 
        Request.executeBatchAsync(request);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T14:16:33.090

Daniele B 给出的解决方案看起来有点吓人，所以我决定自己写。

这不是实际的解决方案，因为它不会升级存储在`Session`对象中的权限，但它允许我们检查授予我们哪些权限。

```
 Request.executeGraphPathRequestAsync(facebookSession, "me/permissions", new Request.Callback() {

    @Override
    public void onCompleted(Response response) {
        GraphObject graphObject; 

        List<String> permissionsToGet = new ArrayList<String>();
        try {
        if (response != null && (graphObject = response.getGraphObject()) != null){
            JSONObject permissions = (JSONObject) ((JSONArray) graphObject.getProperty("data")).get(0);
            for (String permission : facebookPermissions){
                if (!permissions.has(permission) || permissions.getInt(permission) != 1){
                    permissionsToGet.add(permission);
                }
            }

            if (!permissionsToGet.isEmpty()){
                //get new permissions
            } else {
                //all needed permissions are available
            }
        }
        } catch (Exception ex){
            //handle error
        }

    }
}); 
```

# perl - WWW::Mechanize::Firefox 调用 eval_in_page 然后死对象错误

> ID：15939208
> 
> 赞同：1
> 
> 时间：2013-04-11T01:15:59.600
> 
> 标签：perl, firefox, www-mechanize-firefox

我正在使用`[WWW::Mechanize::Firefox](https://metacpan.org/module/WWW%3a%3aMechanize%3a%3aFirefox)`.

当我第二次调用时，它会因错误`eval_in_page`而死。`dead object`

这是我的代码

```
$mech->get($url);

$mech->eval_in_page('some_fun1(123)');
my @divs = $mech->xpath('//div[@class="sometext"]');
my @data = map { $_->{innerHTML} } @divs;
#...

$mech->eval_in_page('some_fun2(456)');  #dead object error...
my @divs_fun2 = $mech->xpath('//div[@class="sometext"]');
my @data_fun2 = map { $_->{innerHTML} } @divs_fun2;
#... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-08T15:10:15.247

> Firefox 15 引入了内存使用方面的重大改进，禁止附加组件在其父文档被销毁后保留对 DOM 对象的引用。这消除了加载项中最常见的内存泄漏原因，并应减少许多用户的内存消耗。

[https://blog.mozilla.org/addons/2012/09/12/what-does-cant-access-dead-object-mean/](https://blog.mozilla.org/addons/2012/09/12/what-does-cant-access-dead-object-mean/)

# c# - 在 MVC C# 中保存数据后如何替换部分视图？

> ID：15939209
> 
> 赞同：0
> 
> 时间：2013-04-11T01:16:05.950
> 
> 标签：c#, asp.net-mvc

在我看来，当用户单击“创建”按钮时，会更改一个局部视图。在我看来，我创建了多个局部视图然后在将数据保存在局部视图上之后，我想重新生成局部视图。

这是我的部分观点

```
@model LMS.Models.OrderTypeModels

<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

 @{
      var defaulyDelivery = ViewBag.defaulyDelivery as IEnumerable<LMS.Models.t_COM_DELIVERY>;

            }

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)

    <table>

     <tr><td>   @Html.LabelFor(model => model.Name)
    </td><td>
      @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
    </td></tr>

    <tr><td>  @Html.LabelFor(model => model.ddAddress)
    </td><td>
      @Html.DropDownListFor(model => model.ddAddress, ViewBag.defaulyDelivery as SelectList) 
    </td></tr>

        <tr><td>  @Html.LabelFor(model => model.Address)
    </td><td>
      @Html.EditorFor(model => model.Address)
            @Html.ValidationMessageFor(model => model.Address)
    </td></tr>

        <tr><td>  @Html.LabelFor(model => model.Active)
    </td><td>
    @Html.EditorFor(model => model.Active)
            @Html.ValidationMessageFor(model => model.Active)
    </td></tr>

    <tr><td colspan="2">

 <input type="button" value="Save Order Type"   onclick="location.href='@Url.Action("SaveOderType", "Business", new { ordertype = @Model })'"  />

    </td></tr>
    </table>

} 
```

这是我的控制器

```
 public void SaveOderType(OrderTypeModels ordertypePeolpe)
        {

            ORDER_TYPE orderType = new ORDER_TYPE();
            //orderType.

            orderType.KEY = lastOrderTypeId + 1;
            orderType.BS_KEY = currentbskey;           
            db.AddToORDER_TYPE(orderType);
            db.SaveChanges();

        } 
```

如果重定向到我的第一个控制器，所有其他部分视图都消失了。我该怎么做。

# c# - AvalonDock (2.0) + MVVM + VSPackage = 文件选择麻烦？

> ID：15939212
> 
> 赞同：4
> 
> 时间：2013-04-11T01:17:06.433
> 
> 标签：c#, wpf, mvvm, vs-extensibility, avalondock

我有一个控件，它利用 AvalonDock (2.0)`DockingManager`控件来显示由底层视图模型管理的一组文档：

```
<avalonDock:DockingManager DocumentsSource="{Binding Items}">
    <avalonDock:DockingManager.LayoutItemContainerStyle>
        <Style TargetType="{x:Type avalonDockControls:LayoutItem}" BasedOn="{StaticResource DocumentItem}"/>
    </avalonDock:DockingManager.LayoutItemContainerStyle>
    <avalonDockLayout:LayoutRoot>
        <avalonDockLayout:LayoutPanel Orientation="Horizontal">
            <avalonDockLayout:LayoutDocumentPane/>
        </avalonDockLayout:LayoutPanel>
    </avalonDockLayout:LayoutRoot>
</avalonDock:DockingManager> 
```

The document view model has an `IsSelected`property, and when the view model is selected, I want to select and show the document in the `DockingManager`. 为此，我将`Style`for更新`LayoutItem`如下：

```
<Style x:Key="DocumentItem" TargetType="{x:Type avalonDockControls:LayoutItem}">
    <Setter Property="Title" Value="{Binding Model.TabTitle}"/>
    <Setter Property="IsSelected" Value="{Binding Model.IsSelected, Mode=TwoWay}"/>
</Style> 
```

当控件托管在 WPF 应用程序中时，此方法可以正常工作，但当控件托管在 VSPackage 中时，通常在视图模型中选择文档不会将所选文档显示在视图中。在下图中，用户单击客户节点进行编辑，但客户文档没有进入视图。

![AvalonDock 问题](https://i.stack.imgur.com/w2DWv.png)

视图模型层`IsSelected`按预期设置，当控件使用 a`TabControl`时，所选文档始终显示在顶部。

这似乎是 AvalonDock 中的一个问题。我发现的是，当`LayoutItem`通过视图模型选择 a 时，列表中的第一个文档在`LayoutDocument/LayoutContent/LayoutElement`层被重新选择为 true ，这会逐渐备份并`IsSelected`在层重置为 true `LayoutItem`。我很想`IsSelected`在该层绑定到我的视图模型`LayoutDocument/LayoutContent/LayoutElement`，但`DependencyProperty`该层没有。

我已经尝试了绑定`IsSelected`到我的视图模型的替代方法，但到目前为止没有成功。有没有其他人遇到过这个问题？知道任何解决方法或其他方法吗？我不想求助于不得不使用非 MVVM 方法，只是为了进行文档选择。

**编辑：**这个问题似乎很模糊，因为我很难创建一个重现的测试用例，即使使用 VSPackage。`ToolWindow`在以下使用 dual s 和 Mediator 消息模拟实际控件的测试用例中，文档选择工作正常。

![工具窗口](https://i.stack.imgur.com/TDWtl.png)

此测试用例（带有 WPF 应用程序和 VSPackage）可[在此处](https://skydrive.live.com/?cid=0E945D83357E9465&id=E945D83357E9465!108&sc=documents#cid=0E945D83357E9465&id=E945D83357E9465!299&sc=documents)获得（单击`Tools=>My command name`以启动工具窗口，并在一个窗口中输入文档标题以选择或创建并在带有 的窗口中选择一个文档`DockingManager`）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T14:38:33.047

我在这个问题上悬赏，因为我相信其他人会以某种方式遇到这个问题，应该有更好的解决方案。

目前，我有一个可怕的黑客来让文档选择工作：

1.  我在样式中维护了与文档视图模型的相同`IsSelected`绑定。`LayoutItem`
2.  在我的主视图模型中，我添加了一个`SelectedItem`属性来跟踪以编程方式选择了哪个文档（通过编辑事件等）。
3.  `ActiveContentChanged`我在控件上添加了一个事件处理程序`DocumentManager`，并且在此方法`SelectedItem`中，如果未选择它，我将在我的视图模型中重新选择它。AvalonDock 在放弃之前尝试了六次以重新选择列表中的第一个文档！
4.  `PreviewMouseDown`我在控件上添加了一个事件处理程序`DocumentManager`，并在此方法中将视图模型设为空，`SelectedItem`以便用户启动的选择继续工作。

再次，寻找更好的答案！

# visual-studio-2010 - 在 powershell 中获取 app.config 元素

> ID：15939218
> 
> 赞同：2
> 
> 时间：2013-04-11T01:18:29.627
> 
> 标签：visual-studio-2010, powershell, linq-to-xml

如下所示的配置文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<appSettings>
    <add key="Environment" value="Dev Environment"/>
</appSettings>
</configuration> 
```

如何在 Powershell 中获取键“环境”的值？我的意思是当您选择键“环境”时它应该返回“开发环境”。

我更喜欢 linq 在这里使用任何有任何想法的人都非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:33:29.123

我推荐[xpath](http://www.w3schools.com/xpath/)。

首先像这样创建一个[XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)对象：

```
$xml = [xml] @'
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<appSettings>
    <add key="Environment" value="Dev Environment"/>
</appSettings>
</configuration>
'@ 
```

... 或这个：

```
$xml = [xml] (Get-Content C:\file.xml) 
```

然后使用 SelectNodes 或 SelectSingleNode 方法并提供您的 xpath 作为参数。xpath 是特定领域的语言，可能会有些复杂。这个 xpath 查询说给我所有名为 add 的节点的属性命名值，这些节点有一个名为 key 的属性，其值为 Environment。

```
$xml.SelectNodes('//add[@key="Environment"]/@value')[0].'#text' 
```

PowerShell`#text`在 XmlElement 和 XmlAttribute 对象上添加了一个 NoteProperty，您可以使用它来访问节点的文本。

# linux - 从 ls 中提取子字符串

> ID：15939226
> 
> 赞同：5
> 
> 时间：2013-04-11T01:19:07.423
> 
> 标签：linux, bash, unix, substring

我正在创建一个小脚本，我必须列出我所有的 Tomcat 二进制文件。
到目前为止，我能够做到这一点：
`ls -1 | grep '\-tomcat\-' | cut -f3 -d'-'`

这基本上列出了所有版本，但它添加了 .zip 或 .tar.gz

```
5.5.17.zip
5.5.26.tar.gz
5.5.27.tar.gz
5.5.28.tar.gz
5.5.31.tar.gz
5.5.32.tar.gz 
```

我想知道如何从提取的字符串中删除 .zip 和 .tar.gz 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T01:30:35.980

通过另一个管道`cut`：

```
ls -1 | grep '-tomcat-' | cut -f3 -d'-' | cut -f1-3 -d'.' 
```

只要版本都具有三个组件，这将起作用。如果版本只有 5.5，就不行了。

另一种选择就是使用`sed`：

```
ls -1 | grep '-tomcat-' | cut -f3 -d'-' | sed 's/.tar.gz\|.zip//' 
```

这将从字符串中删除`.tar.gz`或。`.zip`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-11T01:45:24.753

或者简化整个方法：

```
ls apache-tomcat*|sed -r 's/^.*-([0-9.]+)\..*/\1/' 
```

更少的工具，它为您提供版本号。

PS：跟进@Nemo 的建议：我们让shell globbing 和先验知识完成了一半的工作（只列出实际上看起来像apache-tomcat 的东西）。当将 ls 的输出传输到另一个工具时，-1 是没有意义的，所以我们摆脱了它。sed 获取来自 ls 的值，将行首匹配到第一个 - 后跟一个数字，括号记住所有数字和文字句点，然后我们匹配字符串的其余部分直到行尾（隐式）。然后整个匹配被记住的数字和句点替换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T01:46:27.247

`ls -1 | awk -F. '/-tomcat-/ {print $1}'`

使用 awk 的解决方案。以前的所有答案都一样。

编辑：

我可能误解了，也许这就是你所追求的：

`ls -1 | awk -F\- '/tomcat/ {print substr($3,0,6)}'`

# ios - ABPeoplePickerNavigationController shouldContinueAfterSelectingPerson 返回搜索结果

> ID：15939229
> 
> 赞同：4
> 
> 时间：2013-04-11T01:19:27.023
> 
> 标签：ios, objective-c, uinavigationcontroller, addressbookui

```
- (BOOL)peoplePickerNavigationController:
(ABPeoplePickerNavigationController *)peoplePicker
      shouldContinueAfterSelectingPerson:(ABRecordRef)person {

        DefaultContactSelectViewController *view = [[self storyboard] instantiateViewControllerWithIdentifier:@"DefaultContactView"];
        view.recordID  = recordID;
        view.phones = phones;
        view.emails = emails;
        view.first_name = first_name;
        view.last_name = last_name;
        view.delegate = self;

        [peoplePicker pushViewController:view animated:YES];
    return NO;
} 
```

在上面的代码示例中，我在选择联系人后推送了一个自定义联系人视图控制器。问题是如果从搜索结果中选择了联系人，然后用户点击返回返回到联系人选择器，搜索结果将被清除。

如果上面的代码返回 YES，则不会发生此问题，但是它将推送默认的联系人视图，这不是我想要的。

如果您知道如何解决此问题，请提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T09:32:25.800

您可能应该编写一个自定义的 PeoplePickerViewController，因为您永远无法充分控制 Apple 的默认控制器。

无论如何，至于您当前的问题，这是您需要做的：

声明三个新属性（根据您是否使用 ARC 使用适当的声明 - 我假设没有 ARC）

```
@property (nonatomic, assign) ABPeoplePickerNavigationController *peoplePicker;
@property (nonatomic, assign) UIViewController *peoplePickerRootViewController;
@property (nonatomic, copy) NSString *currentSearchString; 
```

现在，当您显示人员选择器时，添加以下行：

```
// save people picker when displaying
self.peoplePicker = [[[ABPeoplePickerNavigationController alloc] init] autorelease];

// save it's top view controller
self.peoplePickerRootViewController = self.peoplePicker.topViewController;

// need to see when view controller is shown/hidden - viewWillAppear:/viewWillDisappear: won't work so don't bother with it.
self.peoplePicker.delegate = self; 
```

现在，我们将在推送人员视图之前保存搜索字符串：

```
- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person
{
    self.currentSearchString = nil;
    if ([self.peoplePickerRootViewController.searchDisplayController isActive])
    {
        self.currentSearchString = self.peoplePickerRootViewController.searchDisplayController.searchBar.text;
    }
    // other stuff... 
```

显然，在这个类中实现 UINavigationControllerDelegate。当根视图返回视图时，我们将强制显示搜索结果视图。这是实现`navigationController:willShowViewController:animated:`

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated
{
    if (navigationController == self.peoplePicker)
    {
        if (viewController == self.peoplePickerRootViewController)
        {
            if (self.currentSearchString)
            {
                [self.peoplePickerRootViewController.searchDisplayController setActive: YES];
                self.peoplePickerRootViewController.searchDisplayController.searchBar.text = self.currentSearchString;
                [self.peoplePickerRootViewController.searchDisplayController.searchBar becomeFirstResponder];
            }
            self.currentSearchString = nil;
        }
    }
} 
```

如果不使用 ARC，请不要忘记在 dealloc 中释放 currentSearchString。

小警告：当 ABPeoplePickerNavigationController 试图隐藏搜索结果视图时，当您选择一个人时会有轻微的闪烁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T18:37:25.390

好的，我有一个类似的问题。我想你正在使用ARC？

如果是这样，我保存并将整个 ABRecordRef 传递给我的另一个视图，然后必须使用以下方法保留 person 对象：

```
CFRetain( m_MyContact object ); 
```

完成后不要忘记在对象上使用 CFRelease()。

# css - css/main.css 是否有其他用途？

> ID：15939231
> 
> 赞同：0
> 
> 时间：2013-04-11T01:19:31.423
> 
> 标签：css

我遇到了最奇怪的问题...

以最简单的形式，我有一个`index.html`包含以下内容的文件：

```
<link rel="stylesheet" href="css/main.css"> 
```

（在试图确定根本原因的过程中，我已经大大减少了它）

当我查看页面的源代码时，我得到以下信息：

```
<style>html,button,input,select,textarea{color:#222}body{font-size:1em;line-height:1.4}::-moz-selection{background:#b3d4fc;text-shadow:none}::selection{background:#b3d4fc;text-shadow:none}hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:1em 0;padding:0}img{vertical-align:middle}fieldset{border:0;margin:0;padding:0}textarea{resize:vertical}.chromeframe{margin:0.2em 0;background:#ccc;color:#000;padding:0.2em 0}.ir{background-color:transparent;border:0;overflow:hidden;*text-indent:-9999px}.ir:before{content:"";display:block;width:0;height:150%}.hidden{display:none!important;visibility:hidden}.visuallyhidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.visuallyhidden.focusable:active,.visuallyhidden.focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.invisible{visibility:hidden}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{*zoom:1}@media print{*{background:transparent!important;color:#000!important;box-shadow:none!important;text-shadow:none!important}a,a:visited{text-decoration:underline}a[href]:after{content:" \(" attr(href) "\)"}abbr[title]:after{content:" \(" attr(title) "\)"}.ir a:after,a[href^=javascript:]:after,a[href^=#]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100%!important}@page {margin:0.5cm}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}}</style> 
```

奇怪的是，我的`css/main.css`文件中**没有任何**内容。

我已经确认这些 CSS 规则出现在我测试过的所有浏览器中。

这些规则从何而来？如果我重命名文件`css/test.css`并适当地引用它，这种行为怎么会消失？

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:58:05.043

感谢所有的帮助。我备份了我的数据，销毁了主机上与我的域相关的所有内容，并恢复了我的文件。这已经解决了这个问题。我能想到的唯一一件事就是安装一些 Ruby gem（试图学习 RoR）。我不确定这是否起到了作用。不管怎样，都解决了。再次感谢！你们真棒！

# java - 我对 2-sum 的解决方案很慢？

> ID：15939233
> 
> 赞同：0
> 
> 时间：2013-04-11T01:19:47.010
> 
> 标签：java, algorithm, performance

我正在研究 2-sum 问题，我认为我的解决方案非常有效，但是在我运行它之后，该程序显然花费了太长时间。这是我的代码：

```
 public int[] twoSum(int[] numbers, int target) {
        int [] original = new int[numbers.length];
        for(int i=0; i<numbers.length; i++){
            original[i] = numbers[i];
        }
        Arrays.sort(numbers);
        int [] returnArray = new int[2];
        int left = 0;
        int right = numbers.length-1;
        int found1 = 0, found2 = 0;
        int index1 = 1, index2 = numbers.length-1;
        for (;left<right;){
            if(numbers[left] + numbers[right] == target){
                found1 = numbers[left];
                found2 = numbers[right];
                break;
            }
            else if(numbers[left] + numbers[right] < target){
                left++;
            }
            else{
                right--;
            }
        }
        for(;index1<index2;){
            if(original[index1] == found1){
                returnArray[0] = index1+1;
            }
            else{
                index1 ++;
            }
            if(original[index2] == found2){
                returnArray[1] = index2+1;
            }
            else{
                index2 --;
            }

        }
        return returnArray;
    } 
```

问题指出

> 您可以假设每个输入都只有一个解决方案。函数 twoSum 应该返回两个数字的索引，以便它们相加到目标，其中 index1 必须小于 index2。请注意，您返回的答案（index1 和 index2）不是从零开始的。

我的想法是首先对数组进行排序，然后找到这两个元素，然后是两个索引。而且我认为有必要先存储原始数组，因为排序会改变数组。我的解决方案的哪一部分很慢？

PS我不经常使用Java，请随时指出我的错误。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:15:47.073

你这里有两张通行证。一个是找到数字，另一个是记住原始索引。

如果您首先保留索引，则可以避免第二遍。

从包含按顺序索引的数组开始，即 { 1,2,3,4, ...}，然后使用非默认比较器对其进行排序：

```
sort(T[] a, Comparator<? super T> c) 
```

让该比较器使用原始数组中的值对索引进行排序。

然后在索引上运行你的二和，你已经有了索引值。

# ios - 我是否需要从数据源的 cellForPath: 中调用 UICollectionView 的 dequeueCell:？

> ID：15939234
> 
> 赞同：6
> 
> 时间：2013-04-11T01:19:54.860
> 
> 标签：ios, uicollectionview

我真的，真的想为我的 UICollectionView 提供“静态”单元格，就像 UITableView 的过去一样。但我知道，我们优秀的男孩和女孩必须将`dequeueReusableCellWithReuseIdentifier:forIndexPath:`其用作我们细胞的工厂。因此，我提出了以下方案，并要求对其潜力进行反馈。到目前为止，它对我有用，但我害怕一个未知的陷阱。

```
#import "MyCellClass.h"

@implementation MyViewController {
   MyCellClass *_cell0; // etc - many are possible. could store in array
}

-(void)viewDidLoad {
   // assume MyCellClass has a +nib and +reuseId. The reader understands.
   [_collectionView registerNib:[MyCellClass nib] forCellWithReuseIdentifier:[MyCellClass reuseId]];
}

-(void)viewDidAppear:animated {
   // this is where the fun begins. assume proper counts coming from the datasource
   NSIndexPath *indexPath = [NSIndexPath indexPathWithRow:0 inSection:0];
   _cell0 = [[self collectionView] dequeueReusableCellWithReuseIdentifier:[MyCellClass reuseId] forIndexPath:indexPath];
   // etc
}

-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {
   if ([indexPath row] == 0) return _cell0;
   // etc
} 
```

我故意掩盖了诸如配置单元格之类的细节。疯狂？天才？只是现状？到目前为止它似乎工作，但我担心，不知何故，Apple 期望`dequeue`从内部调用`cellForPath`。有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:35:35.583

调用的唯一原因`dequeueReusableCellWithReuseIdentifier:forIndexPath:`是重用单元格。但是“静态”集合视图？我们在谈论多少个细胞？如果我有一个足够小的集合视图，它从不滚动，我会考虑根本不费心重用单元格。*那*肯定会巧妙地解决问题。毕竟，故事板中的静态表格并没有重用单元格。这就是使它成为静态的原因。所以我会说，`dequeueReusableCellWithReuseIdentifier:forIndexPath`完全放弃这些东西，当被问到时只提供细胞。

没有什么神奇的`dequeue`；这只是一种找出重用堆中是否有任何单元格的方法，如果有，则获取一个。毕竟，考虑一下表格视图在 iOS 4 中是如何工作的。你说过`dequeue`，但是如果没有可重复使用的单元格来回馈，表格就会返回`nil`，而你必须`alloc-init`自己的单元格或将其从笔尖中拉出来，*你自己*。好吧，您建议对集合视图中的*所有项目执行此操作。*继续前进。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-11T18:21:11.050

**Apple TSI Guy 的回应：**

> 尽管您说您的应用程序有效，但您确实应该在数据源方法“cellForItemAtIndexPath”中使用“dequeueReusableCellWithReuseIdentifier”。那是支持的使用模式。不要试图抓住你的 MyCellClass，让集合视图管理它，它会在必要时要求你将它出列。

我会噘嘴，更改我的代码，然后发出增强请求。但我告诉你它工作得很好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-19T04:14:25.177

查看我的[MBStaticCollectionView](https://github.com/matibot/MBStaticCollectionView)，它使您能够从 Interface Builder 定义静态 UICollectionView 单元格，而无需定义数据源。

# django - SES - Django - 发送给几个人的电子邮件 - 仅由一个人接收

> ID：15939236
> 
> 赞同：1
> 
> 时间：2013-04-11T01:20:03.027
> 
> 标签：django, amazon-ses

我正在使用 SES 和 Django 向多个收件人发送电子邮件。

第一个接收器正确接收它，而不是其他接收器。我试图改变接收者的顺序，它总是第一封收到它的电子邮件。我使用的代码与另一个我没有任何问题的项目相同......因此我怀疑亚马逊存在问题，但从亚马逊控制台发送确实可以正常工作。

在检查第一封电子邮件收到的电子邮件时，我可以看到它应该发送到正确的地址（在**to**字段中）。

收到的普通电子邮件是这样的（我已经删除了 IP 和 ID，并用 email-number@gmail.com 替换了电子邮件）：

```
Delivered-To: EMAIL-1@gmail.com
Received: by ... with SMTP id nXXX;
        Wed, 10 Apr 2013 18:02:18 -0700 (PDT)
X-Received: by ... with SMTP id XXX;
        Wed, 10 Apr 2013 18:02:17 -0700 (PDT)
Return-Path: <XXX-000000@amazonses.com>
Received: from a8-50.smtp-out.amazonses.com (a8-50.smtp-out.amazonses.com. [...])
        by mx.google.com with ESMTP id XXX;
        Wed, 10 Apr 2013 18:02:17 -0700 (PDT)
Received-SPF: pass (google.com: domain of XXX@amazonses.com designates ... as permitted sender) client-ip=...;
Authentication-Results: mx.google.com;
       spf=pass (google.com: domain of XXX@amazonses.com designates ... as permitted sender) smtp.mail=XXX@amazonses.com
Return-Path: XXX@amazonses.com
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Subject: Website Enquiry
From: noreply@mydomain.com.au
To: EMAIL1@gmail.com, EMAIL2gmail.com
Date: Thu, 11 Apr 2013 01:02:16 +0000
Message-ID: <XXX@email.amazonses.com>
Reply-To: test@gmail.com
X-SES-Outgoing: 54.240.8.50

Hello,

you have received a message from XXX:

Name: francois
Email: test@gmail.com

test 55 
```

如前所述，如果我反转到：EMAIL2@gmail.com，EMAIL1gmail.com。EMAIL1 收到邮件，而不是 EMAIL2@gmail.com。

Django 代码非常基本，只需使用以下代码：

```
 self.send_email(
            content=self.get_contact_email_content(contact),
            subject='Website Enquiry',
            to=['EMAIL1@gmail.com', 'EMAIL2@gmail.com'],
            reply_to=contact.email_address
        ) 
```

相同的行为生活和开发。

我一无所知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T04:53:06.337

找到了，我在做：

```
to=['EMAIL1@gmail.com, EMAIL2@gmail.com'] 
```

代替：

```
to=['EMAIL1@gmail.com', 'EMAIL2@gmail.com'] 
```

# ios - 为什么 UINavigationController 没有 rootViewController 属性？

> ID：15939243
> 
> 赞同：12
> 
> 时间：2013-04-11T01:21:21.240
> 
> 标签：ios, objective-c, uinavigationcontroller

我很好奇。我们真的不能轻易访问它。我的意思是，我知道它有，但无法访问。

为什么？

基本上，我希望在通过访问它的视图发送一些事件之前加载 rootViewController。在 viewDidload 上设置了一个 postnotification。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-11T01:23:26.490

如果您有多个，请使用：

```
UIViewController *root = navController.viewControllers[0]; 
```

`navController`你在哪里`UINavigationController`。这将永远有效。

使用`UINavigationController topViewController`. 如果只有一个控制器，则此方法有效。

# xcode - Xcode 4.6 中的搜索路径混淆

> ID：15939250
> 
> 赞同：0
> 
> 时间：2013-04-11T01:22:17.643
> 
> 标签：xcode, clang, xcode4.6

在 Xcode 中，我将 MailCore 添加为子项目和目标依赖项。它在我的机器上运行良好。可悲的是，当我与另一位合作者共享该项目时，他无法显示头文件。

![我的搜索路径](https://i.stack.imgur.com/E1K8H.png)

不知何故，他的搜索路径将我的文件夹名称硬编码在其中（如在 andrewjl 中），有没有办法解决这个问题以指向他机器上的类似目录？

![在此处输入图像描述](https://i.stack.imgur.com/npoux.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:35:57.347

不要使用绝对搜索路径，而是使用相对路径。

“$(SRCROOT)”是您的项目文件所在的位置。

“$(SRCROOT)/AnotherFolder” for AnotherFolder 是您的项目文件的对等点

一旦将此变量添加到搜索路径（双击 searchpaths 行后），您可以添加“$(SRCROOT)/Products/MyReceipt.......”并且一旦您关闭添加/删除searchPath 弹出窗口，您将看到搜索路径指向的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:28:27.753

您的搜索路径是绝对路径。将它们写为相对路径（相对于项目）。

# web - 将字段添加到数据来自子表单的查询

> ID：15939254
> 
> 赞同：0
> 
> 时间：2013-04-11T01:22:39.560
> 
> 标签：web, ms-access-2010

我需要过滤带有在非相关表上计算的参数的表，但要在 Access web 中执行此操作，我需要将 [Project_Id] 添加到任务列表中。

为了进一步澄清，用户回答了一些关于项目细节的问题，这反过来将在后台计算一组对任务列表进行排序所需的参数。

问题是任务列表是通用的并且与项目无关，因此在我可以使用与项目相关的过滤器参数之前，我需要为任务列表分配一个项目 ID，或者没有关系并且无法知道要使用哪些项目参数.

我尝试通过查询来执行此操作，但作为 Web 数据库，我无法从表单控件中选择数据。

希望有人可以帮助我找到解决方案，因为我已经用尽了谷歌和我自己对该主题的了解。由于安全问题，我无法使用代码的最后一件事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T05:07:26.823

如果有人感兴趣，我发现使用数据宏将项目 ID 分配给任务列表。

数据宏被分配给与项目相关的表，并在更新时编辑任务列表，为表中的每条记录添加当前项目 ID。

我仍然有一些问题需要解决，但总的来说它可以满足我的需要。

# coldfusion - 是 cffile action="rename" === fileMove 在 CFScript 中吗？

> ID：15939255
> 
> 赞同：3
> 
> 时间：2013-04-11T01:23:20.543
> 
> 标签：coldfusion, cfml

和做`fileMove()`完全一样的事情`<cffile action="rename">`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T03:00:28.180

不，它们是不同的。没有可用于重命名文件的 CFML 脚本功能。所以，上面的用例只是实现文件重命名的一个技巧。

您必须指定相同的源文件夹和目标文件夹，但要更改 <destination> 中的文件名。

```
filemove("c:\userdata\files\myFile.docx", "c:\userdata\files\yourFile.docx"); 
```

# meteor - 如何确保某个值不在 Meteor 集合中？

> ID：15939258
> 
> 赞同：1
> 
> 时间：2013-04-11T01:23:34.133
> 
> 标签：meteor

就像是：

```
if (myCollection.find({'thingamaJig.$' : 'number1'}) = null) { 
"number1 is NOT in       myCollection" } 
else { "number1 is already in myCollection!"  } 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T07:38:19.563

您可以使用`findOne`

```
if(!myCollection.findOne({thingamagig:number1})) {
    //Number1 not in collection
} 
```

即使 thingamagic 是一个数组，这也会起作用，例如

一个文件看起来像：

```
{thingamagig : [1,4,5,9]} 
```

这将运行，因为 10 不在数组中

```
if(myCollection.findOne({thingamagig:10}) == null) {
     //Not in collection
} 
```

# prestashop - Prestashop 子类别中的子类别菜单

> ID：15939260
> 
> 赞同：2
> 
> 时间：2013-04-11T01:23:59.367
> 
> 标签：prestashop

我试图在所有子类别中显示 prestashop 类别的子类别菜单。默认情况下，您只能看到类别中的子类别菜单，但看不到子类别的“兄弟”子类别。

我想我只需要让这段代码在一个子类别中工作，因为这段代码在一个类别中运行良好：

```
{foreach from=$subcategories item=subcategory}
<li >    <a href="{$link->getCategoryLink($subcategory.id_category, $subcategory.link_rewrite)|escape:'htmlall':'UTF-8'}"
class="cat_name">{$subcategory.name|escape:'htmlall':'UTF-8'}</a>
</li>    {/foreach} 
```

有任何想法吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-05T06:56:58.477

和往常一样，我不会给你一个完整的代码，但我会告诉你怎么做。在 smarty 中，您需要创建一个以父类别的参数编号为参数的函数，在此函数中，您需要使用 Category::getChildren( $id_category );然后在 smarty 中，您只需通过 smarty 函数进行循环。

问候

对不起我的英语。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-07T05:18:37.097

首先，我会在 /override/controllers/ 中创建一个覆盖文件，名为**CategoryController.php**

并添加：

```
<?php

class CategoryController extends CategoryControllerCore
{
    public function displayContent()
    {
        // Get the global smarty object.
        global $smarty;

        // Get current category's parent.
        $parent_category = new Category($this->category->id_parent, self::$cookie->id_lang);

        // Get parent category's subcategories (which is current category's siblings, including it self).
        $category_siblings = $parent_category->getSubCategories((int)self::$cookie->id_lang)

        /* Assign your siblings array to smarty. */
        $smarty->assign(
            array(
                "category_siblings" => $category_siblings
            )
        );

        /* This we run the normal displayContent, but pass the siblings array to
           category.tpl */
        parent::displayContent();
    }
}

?> 
```

在**product-list.tpl**文件中：

```
<ul>
    {foreach from=$category_siblings item=elemento}
         <a href="{$link->getCategoryLink($elemento.id_category, $elemento.link_rewrite)|escape:'htmlall':'UTF-8'}" class="cat_name"> <li {if $category->id == $elemento.id_category}class="active"{/if}> {$elemento.name} </li> </a>
    {/foreach}
</ul> 
```

通过*[在 category.tpl 中为 prestashop 中的当前类别获取同级类别](https://stackoverflow.com/questions/11206886/get-sibling-categories-in-category-tpl-for-the-current-category-in-prestashop)*

# javascript - 如何将 servlet 返回的文本解析为 Javascript 中的 $.post() 请求

> ID：15939261
> 
> 赞同：0
> 
> 时间：2013-04-11T01:24:08.613
> 
> 标签：javascript, ajax, jsp, jquery

我的java脚本是这样的：

```
$.post("url", {
        x: y,
        a: b
    },

    function (data) {
        if (data == "success") {
            $("#results").html("success");
            updatefunction(); // Need to update some values in database
        } else {
            $("#results").html("transaction failed: " + data);
        }
    }); 
```

我的 servlet 返回这个：

```
PrintWriter out = response.getWriter();
if(balance == true){
   out.println("success");
}
else{
    out.println("In Sufficient Balance");
} 
```

我无法在 javascript 中比较我的 servlet 返回的字符串。我不想使用 JSON 或 XML 并使程序变得复杂。

是否有任何地方可以将（数据）解析为字符串，以便在成功的基础上完成剩下的工作......

每次进入 else 循环并通过 #results 更新时：事务失败：成功

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:33:35.363

跟踪来自 servlet 的响应，像这样

```
$.post("url", 
{x:y, a:b}, 
function(data){
   alert(data);
   if(data == "success"){
        $("#results").html("success");
        updatefunction();   // Need to update some values in database
    }
    else{
        $("#results").html("transaction failed: "+ data);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:28:30.317

它很可能是空白。只需检查字符串的实例。

```
if(data.indexOf("success") !== -1){
  ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T17:37:46.647

我使用 jQuery.trim(string) 从字符串中删除空格。还将我的 servlet 中的内容类型更改为：

```
response.setcontenttype("text"); 
```

感谢@jsshah 和@joseph caracuel

# php - PHP中的PDOException，MySQL中没有错误

> ID：15939262
> 
> 赞同：0
> 
> 时间：2013-04-11T01:24:24.190
> 
> 标签：php, mysql, pdo

这是正在运行的查询：

```
SELECT  `fleet_pilots`.`user_id` ,  `pilot_tracker`.`start_time` ,  `fleets`.`fleet_cta` 
FROM  `fleet_pilots` 
LEFT JOIN  `fleets` ON  `fleets`.`fleet_id` =  `fleet_pilots`.`fleet_id` 
LEFT JOIN  `pilot_tracker` ON  `pilot_tracker`.`user_id` =  `fleet_pilots`.`user_id` 
AND  `pilot_tracker`.`end_time` =  '0000-00-00 00:00:00'
WHERE  `fleet_pilots`.`fleet_id` =  '26'
AND  `fleet_pilots`.`user_approved` =  '1' 
```

当我在 mysql 中运行查询时，我没有问题并得到我期望的结果。

当我在php中使用结果时出现问题：

```
$sql = "SELECT `fleet_pilots`.`user_id`, `pilot_tracker`.`start_time`, `fleets`.`fleet_cta`
        FROM `fleet_pilots`
        LEFT JOIN `fleets` ON `fleets`.`fleet_id` = `fleet_pilots`.`fleet_id`
        LEFT JOIN `pilot_tracker` ON `pilot_tracker`.`user_id` = `fleet_pilots`.`user_id` AND `pilot_tracker`.`end_time` = '0000-00-00 00:00:00'
        WHERE `fleet_pilots`.`fleet_id` = :fleet_id AND `fleet_pilots`.`user_approved` = '1'";
$this->db->query($sql);
$args = array(
    ':fleet_id' => $this->input['fleet_id'],
    );
$this->db->execute($args);

$fleet_users = array();

while ( $row = $this->db->fetch_row() )
{
    $fleet_users[] = $row['user_id'];

    if (isset($row['start_time']) && $row['fleet_cta'])
    {
        $sql = "UPDATE `pilots`
                SET `user_total_points` = `user_total_points` + :user_total_points, `user_points` = `user_points` + :user_points
                WHERE `user_id` = :user_id";
        $this->db->query($sql);
        $args = array(
            ':user_id' => $row['user_id'],
            ':user_points' => $this->conf->Config['point_per_min'] * ((strtotime('now') - strtotime($row['start_time']))/60),
            ':user_total_points' => $this->conf->Config['point_per_min'] * ((strtotime('now') - strtotime($row['start_time']))/60),
            );
        $this->db->execute($args);
    }
} 
```

我收到此错误消息：

```
<br />
<b>Fatal error</b>:  Uncaught exception 'PDOException' with message 'SQLSTATE[HY000]: General error' in /usr/local/apache2/vhosts/trifectas.org/htdocs/fleetmaster/libs/database.class.php:109
Stack trace:
#0 /usr/local/apache2/vhosts/trifectas.org/htdocs/fleetmaster/libs/database.class.php(109): PDOStatement-&gt;fetch(2)
#1 /usr/local/apache2/vhosts/trifectas.org/htdocs/fleetmaster/libs/common.class.php(1170): Database-&gt;fetch_row()
#2 /usr/local/apache2/vhosts/trifectas.org/htdocs/fleetmaster/libs/common.class.php(1226): Common-&gt;submit_end_fleet()
#3 /usr/local/apache2/vhosts/trifectas.org/htdocs/fleetmaster/libs/common.class.php(225): Common-&gt;process_end_fleet()
#4 /usr/local/apache2/vhosts/trifectas.org/htdocs/fleetmaster/index.php(25): Common-&gt;__construct()
#5 {main}
  thrown in <b>/usr/local/apache2/vhosts/trifectas.org/htdocs/fleetmaster/libs/database.class.php</b> on line <b>109</b><br /> 
```

第 1170 行是 while ( $row = $this->db->fetch_row() ) 行。

任何帮助表示赞赏。

编辑：以下更改为我解决了这个问题。

```
$sql = "SELECT `fleet_pilots`.`user_id`, `pilot_tracker`.`start_time`, `fleets`.`fleet_cta`
        FROM `fleet_pilots`
        LEFT JOIN `fleets` ON `fleets`.`fleet_id` = `fleet_pilots`.`fleet_id`
        LEFT JOIN `pilot_tracker` ON `pilot_tracker`.`user_id` = `fleet_pilots`.`user_id` AND `pilot_tracker`.`end_time` = '0000-00-00 00:00:00'
        WHERE `fleet_pilots`.`fleet_id` = :fleet_id AND `fleet_pilots`.`user_approved` = '1'";
$this->db->query($sql);
$args = array(
    ':fleet_id' => $this->input['fleet_id'],
    );
$this->db->execute($args);
$row = $this->db->fetch_array();

$fleet_users = $result = array();

foreach ( $row AS $key => $value )
{
    $result[$key] = $value;
}

foreach ( $result AS $row )
{
    $fleet_users[] = $row['user_id'];

    if ( isset($row['start_time']) && $row['fleet_cta'] )
    {
        $sql = "UPDATE `pilots`
                SET `user_total_points` = `user_total_points` + :user_total_points, `user_points` = `user_points` + :user_points
                WHERE `user_id` = :user_id";
        $this->db->query($sql);
        $args = array(
            ':user_id' => $row['user_id'],
            ':user_points' => $this->conf->Config['point_per_min'] * ((strtotime('now') - strtotime($row['start_time']))/60),
            ':user_total_points' => $this->conf->Config['point_per_min'] * ((strtotime('now') - strtotime($row['start_time']))/60),
            );
        $this->db->execute($args);
    }
} 
```

这是我的 PDO 包装器。

```
<?php

defined('IN_APP') || die('Hands off!');

class Database
{
    protected $connection;
    protected $result;
    protected $params;
    protected $executed = false;
    protected $_queryCounter = 0;

    public function __construct($dsn, $username = null, $password = null, $driver_options = null)
    {
        try
        {
            $this->connection = new PDO($dsn, $username, $password, $driver_options);
            $this->connection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        }
        catch (PDOException $e)
        {
            $this->get_error($e);
        }
    }

    public function query($sql, $params = array())
    {
        $this->result = $this->connection->prepare($sql);
        $this->params = is_array($params) ? $params : array($params);
        $this->executed = false;
    }

    public function bind($pos, $value, $type = null)
    {
        if ( is_null($type) )
        {
            switch (true)
            {
                case is_int($value):
                    $type = PDO::PARAM_INT;
                    break;
                case is_bool($value):
                    $type = PDO::PARAM_BOOL;
                    break;
                case is_null($value):
                    $type = PDO::PARAM_NULL;
                    break;
                default:
                    $type = PDO::PARAM_STR;
            }
        }

        $this->result->bindValue($pos, $value, $type);
    }

    public function bindParam($pos, $value, $type = null)
    {
        if ( is_null($type) )
        {
            switch (true)
            {
                case is_int($value):
                    $type = PDO::PARAM_INT;
                    break;
                case is_bool($value):
                    $type = PDO::PARAM_BOOL;
                    break;
                case is_null($value):
                    $type = PDO::PARAM_NULL;
                    break;
                default:
                    $type = PDO::PARAM_STR;
            }
        }

        $this->result->bindParam($pos, $value, $type);
    }

    public function execute($vars = array())
    {
        $this->_queryCounter++;
        $this->executed = true;

        foreach ( $vars as $k => $v )
        {
            $this->bind($k, $v);
        }

        return $this->result->execute();
    }

    public function fetch_array($vars = array())
    {
        if ( !$this->executed )
        {
            $this->execute($vars);
        }

        return $this->result->fetchAll(PDO::FETCH_ASSOC);
    }

    public function fetch_row($vars = array())
    {
        if ( !$this->executed )
        {
            $this->execute($vars);
        }

        return $this->result->fetch(PDO::FETCH_ASSOC);
    }

    public function lastInsertId()
    {
        return $this->connection->lastInsertId();
    }

    public function rowCount($vars = array())
    {
        if ( !$this->executed )
        {
            $this->execute($vars);
        }

        return $this->result->rowCount();
    }

    public function beginTransaction()
    {
        $this->connection->beginTransaction();
    }

    public function commit()
    {
        $this->connection->commit();
    }

    public function queryCounter()
    {
        return $this->_queryCounter;
    }

    public function debugDumpParams()
    {
        return $this->result->debugDumpParams();
    }

    public function get_error($e)
    {
        $this->connection = null;
        die($e->getMessage());
    }

    public function getConnection()
    {
        return $this->connection;
    }

    public function __destruct()
    {
        $this->connection = null;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:33:19.403

`PDO::fetchRow`不存在。假设您的`$this->db`对象是一个`PDO`实例，这是行不通的。`PDO::query`返回一个`PDOStatement`结果对象。您需要从中获取行，*而*不是从`PDO`对象中获取。如果这没有帮助，您需要显示您的数据库类在做什么。

# c++ - 类型索引元组

> ID：15939264
> 
> 赞同：3
> 
> 时间：2013-04-11T01:24:27.117
> 
> 标签：c++, templates, generics, tuples

如何实现一个按类型而不是按索引访问元素的元组类？类似于此界面的内容...

```
template<typename... T>
class Tuple
{
public:
    Tuple(T... elements);

    template<typename U>
    U &get();               // U is one of the types in T...
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:57:35.597

您`Tuple`使用可变参数模板实现的方式是这样的

```
// Base case, Tuple<>
template< typename... Ts >
class Tuple {
};

// recursive inheritance :D
template< typename T, typename... Ts >
class Tuple< T, Ts... > : private Tuple< Ts... > {
public:
   // we implement get() by checking wether element type match with
   // request type
   template< typename t >
   typename std::enable_if< std::is_same< t, T >::value, t& >::type
   get() {
     return element;
   }

   // above is not enough since it only check this class's element type,
   // we can check the rest of the tuple by inspecting its the parent classes.
   template< typename t >
   typename std::enable_if< !( std::is_same< t, T >::value ), t& >::type
   get() {
       return Tuple<Ts...>::template get<t>();  // call its parent's get() 
                                                // ::template to shut compiler up
   }       

private:
    T element;
};

Tuple< short, int, float, double, char, std::string > t;
auto x = t.get< std::string >();    //  x will be an empty string. 
```

这假设没有重复的元素类型，如果有，它将选择最前面的那个。如果请求类型不在 Tuple 中，则不会编译。

# jedit - 如何在 Isabelle/jEdit 中的假设周围显示括号？

> ID：15939265
> 
> 赞同：5
> 
> 时间：2013-04-11T01:24:31.980
> 
> 标签：jedit, isabelle, proof-general

当 Isabelle 在 ProofGeneral 中显示目标时，假设呈现为在它们周围有括号，如下所示：

![证明假设的一般渲染](https://i.stack.imgur.com/4tOP6.png)

然而，在 Isabelle/jEdit 中，这似乎已更改为元含义箭头：

![jEdit渲染假设](https://i.stack.imgur.com/5Dbhp.png)

虽然我知道前者有些不标准，但我发现它更容易阅读。有没有办法修改 Isabelle/jEdit 的行为，以旧的 ProofGeneral 样式打印出目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T01:24:31.980

Isabelle 呈现其输出的格式由 Isabelle 的“打印模式”决定。在 ProofGeneral 中，默认`print_mode`包括`brackets`模式，它在假设周围呈现括号，而默认的 jEdit`print_mode`包括`no_brackets`，它的作用相反。

可以通过设置并重新启动 jEdit、添加到命令行或包含在文件中`Plugins > Plugin Options > Isabelle/General > Print Mode`来更改打印模式：`brackets``-m brackets``isabelle jedit``~/.isabelle/etc/settings`

```
ISABELLE_JEDIT_OPTIONS="-m brackets" 
```

这将导致 jEdit 显示括号，如 ProofGeneral：

![jEdit渲染括号](https://i.stack.imgur.com/JNY4M.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-01T22:32:02.667

1.  进入`Plugins -> Plugin Options -> Isabelle -> General`
2.  然后在`brackets`打印模式字段中输入。
3.  单击应用。
4.  然后关闭 Isabelle 并重新启动它。

此后，您的假设周围应该有括号。

# oop - 为什么接口有用？（哎呀）

> ID：15939269
> 
> 赞同：4
> 
> 时间：2013-04-11T01:24:44.210
> 
> 标签：oop, interface, implements

我已经知道实现和接口的基础知识。我不明白什么时候使用接口。有接口的要求是什么？

例子：

```
/// Interface demo
Interface IDemo
{
    // Function prototype
    public void Show();
}

// First class using the interface
Class MyClass1 : IDemo
{
public void Show()
{
    // Function body comes here
    Response.Write("I'm in MyClass");
}
}

// Second class using the interface
Class MyClass2 : IDemo
{
public void Show()
{
    // Function body comes here
    Response.Write("I'm in MyClass2");
    Response.Write("So, what?");
}
} 
```

这两个类具有相同的函数名称和不同的主体。这也可以在没有接口的情况下实现。有方法参考的目的是什么？当我扩展一个超类时，至少我得到了超类的属性和方法。

请给我一个清晰的解释和一个真实的世界场景，以便我很好地理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:29:11.427

如果需要多重继承，则需要一个接口。

假设您有一个需要可比较的类和一个列表。由于在某些语言中只能继承一个类，为了向编译器证明它同时具有 Comparable 的 compareTo() 方法和 List 的 add() 方法，就需要接口。这是最简单的解释，但我相信其他人会给出更多理由。

在某些情况下，接口也使多重继承更容易，因为“在后台”没有任何事情发生。他们只指定对象需要在方法方面提供什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T01:44:42.593

首先，他们为用户提供了一个合约，因此用户不需要知道使用了什么底层实现，而只需要知道合约。如果底层实现发生变化，这会产生松散耦合。

## 现实世界的例子

通过这种方式，我们可以使用某些模式，例如策略和命令模式：[使用策略模式和命令模式](https://stackoverflow.com/questions/3883692/strategy-pattern-vs-command-pattern)

[策略模式的真实示例](https://stackoverflow.com/questions/370258/real-world-example-of-the-strategy-pattern)

[命令模式应用的真实世界示例](https://stackoverflow.com/questions/12153708/real-world-example-of-application-of-the-command-pattern)

## 抽象类和接口之间的区别

关于抽象类可以说大部分内容，请参见此处了解差异：[接口与抽象类（一般 OO）](https://stackoverflow.com/questions/761194/interface-vs-abstract-class-general-oo)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-12T16:59:10.107

使用接口的两个原因：

1.  您需要多重继承，而您的编程语言不支持它（例如，Java、C#）。在这种情况下，您在派生类中继承的大多数（除了一个）基类都需要定义为接口类。

2.  您希望使用某个类的多个实现。在这种情况下，类可以是抽象类或接口。您的客户端提供此类的特定具体实现，它可能因客户端而异。接口（或抽象类）要求每个实现都具有相同的行为（方法）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-12T12:16:44.353

我相信使用接口最重要的原因之一是**类型匹配**。通过对接口而不是实现进行编程，您的程序可以更加灵活。

您可以查看不同的设计模式（我建议您从 Strategy Pattern 开始，[http](http://en.wikipedia.org/wiki/Strategy_pattern#Example) ://en.wikipedia.org/wiki/Strategy_pattern#Example ）我认为您将立即了解程序到接口如何使您的代码更加灵活。

希望这能有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T16:42:32.477

大部分功能来自于一个对象可以被接口类型的变量引用。这是微妙的变化强大。

```
private foo()
{
     IDemo demoOne = new MyClass1();
     IDemo demoTwo = new MyClass2();
} 
```

这可能会变得非常强大，因为您可以封装不同的行为。例如：

```
private foo(bool option)
{
     IDemo demo = option ? new MyClass1() : new MyClass2();
}

private bar (IDemo demo)
{
     demo.Show();
} 
```

现在 bar 可以使用 IDemo 对象，而不必知道传入的是哪个 IDemo 的具体实现。关于使用哪个实现的决定封装在 foo 方法中。在这样一个简单的例子中，这似乎没什么大不了的。如果您查看跳跳虎答案中发布的链接，您会发现这在哪里变得非常有用。

这特别有用的一种情况是单元测试。你可以有一个业务逻辑类，它接受一个数据层对象的接口。当应用程序运行时，业务逻辑类被传递一个真实数据层对象的实例。当类被单元测试时，它被传递一个返回测试数据的对象的实例。这允许单元测试以可预测的数据输入运行。这在依赖注入中是已知的。

另一个有用的情况是当您想要与框架或第三方代码交互时。假设您要实现自定义集合。如果您的类实现了 IEnumerable 接口，则可以在 foreach 循环中遍历集合中的项目。框架不需要知道您的类如何存储项目或项目中的内容，但如果它知道您实现了 IEnumerable，它可以允许您使用 foreach 循环。

# qt - Qt 可执行文件命名

> ID：15939270
> 
> 赞同：0
> 
> 时间：2013-04-11T01:24:44.987
> 
> 标签：qt, ogre, ogre3d

我希望这是一个简单的问题。我已经使用 MSVC2010 在 QtCreator 2.6.1 中设置了一个 Ogre3D 项目。我必须设置一个自定义构建步骤，我注意到字母“d”附加到已编译的 .exe 的名称（例如 OrgeProgramd.exe、CoolGamed.exe）

这并不重要，我只是想知道为什么会这样。正常吗？.pro 文件中的目标是正确的。我尝试使用 Release 构建，我得到了同样的结果。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T04:57:15.677

查看您的 pro/pri 文件并找到与此类似的行：`TARGET = $$join(TARGET,,,d)`. 如果你这样做 - 这就是原因。

# php - jquery .load() 很慢。如何加快速度？

> ID：15939273
> 
> 赞同：2
> 
> 时间：2013-04-11T01:25:00.987
> 
> 标签：php, jquery, ajax

我一直在谷歌搜索如何加快 .load() 加载时间，但未能找到任何解决方案。只是对外部脚本生成的 html 表的简单加载。结果在加载表格时大约需要 10 秒，而没有 .load() 只需要 2-3 秒。当我在桌子上使用数据表插件时，它变得最糟糕。它可以加载只要 25s 无论如何我可以更快地加载表格吗？

索引.php

```
<script>
$('#Table').load("ajaxtable.php?type=tableA");
.
.
.
</script>
<div id = 'Table'></div> 
```

ajaxtable.php

```
if ($_GET["type"] == "tableA"){
//select * from DBtable;'
//result will generate 100 column by 500 rows result 
return;
} 
```

# function - 画布动画。单人乒乓

> ID：15939274
> 
> 赞同：-1
> 
> 时间：2013-04-11T01:25:02.477
> 
> 标签：function, animation, canvas, pong

这是我的第一个 Web 开发课程，我在函数和不知道调用哪个方面遇到了问题。我的老师给了我们以下代码：

```
<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Canvas Animation</title>
    <!-- include the jQuery UI stylesheet -->
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.19                                                                                /themes/base/jquery-ui.css">
<!-- include the jQuery and jQuery UI JavaScript files -->
<script src="jquery.min.js"></script>
<script src="jquery-ui.js"></script>

<style>
canvas {
    border: 1px solid black;
}
</style> 
```

## 单人乒乓

通过以下方式完成此游戏：

*   当球击中桨时，它应该弹回（方向取决于它击中的桨上的位置）。
*   当球击中最左边的墙壁时，球员输了。
*   防止桨移出屏幕的顶部/底部。
*   **奖励（2 分）：**提供按钮“更快”和“更慢”（画布外），增加/减少球的速度。

```
<canvas id="mycanvas" width="300" height="300"> d </canvas>

<script>
// global variables

var context;
// width/height of the canvas
var width;
var height;

// position and direction of the ball
var x = 100;
var y = 180;
var dx = 2;
var dy = 2;

// paddle
var paddley; // y location
var paddleh; // height
var paddlew; // width

// keyboard input
var upPressed = false; // is the user pressing up?
var downPressed = false; // is the user pressing down?

// setup canvas and animation timer 
function init() {
    context = $("#mycanvas")[0].getContext("2d");
    width = $("#mycanvas").width();
    height = $("#mycanvas").height();
    return setInterval(draw, 10); // every 10 milliseconds, draw will be called.
}

// called when a key is pressed
function onKeyDown(evt) {
    if (evt.keyCode == 38) upPressed = true; // 38 is code for up button
    else if (evt.keyCode == 40) downPressed = true; // 40 is code for down button
}

//called when a key is released
function onKeyUp(evt) {
if (evt.keyCode == 38) upPressed = false;
else if (evt.keyCode == 40) downPressed = false;
}

// attaches the key methods to the document.
$(document).keydown(onKeyDown);
$(document).keyup(onKeyUp);

// clear the screen to prepare for drawing a new frame
function clear() {
    context.clearRect(0, 0, width, height);
}

// draw a circle at x,y with radius r
function circle(x,y,r) {
  context.beginPath();
  context.arc(x, y, r, 0, Math.PI*2, true);
  context.closePath();
  context.fill();
}

// draw a filled rectangle at x,y with width,height
function rect(x,y,w,h) {
    context.beginPath();
    context.rect(x,y,w,h);
    context.closePath();
    context.fill();
}

// init location and size of paddle 
function init_paddles() {
    paddley = 100;
    paddleh = 75;
    paddlew = 10;
}

// draw a single frame of the game
function draw() {
    clear();
    // draw circle
    circle(x, y, 10);

    // update paddle location
    if (upPressed) paddley -= 5;
    else if (downPressed) paddley += 5;

    // draw paddle
    rect(10, paddley, paddlew, paddleh);

    // ball hit a wall!     
    if (x + dx > width || x + dx < 0)
        dx = -dx; // flip x direction
    if (y + dy > height || y + dy < 0)
        dy = -dy; // flip y direction

    // move ball        
    x += dx;
    y += dy;        
}

init();
init_paddles();
</script>

 </body> 
```

当球击中桨时，我只需要帮助，它会向相反的方向反弹。那么它会不会是这样的： if(x + dx > paddley || x + dx >paddleh) dx = -dx;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:09:51.120

考虑到球拍在屏幕的右边，球的位置是它的中心，球拍的位置是左上角：

```
// Collision on the y and x axis
var onY = (y + dy < paddley + paddleh) && (y - dy > paddley);
var onX = (x + dx > width - paddlew);

if (onX && onY)
{
    // A factor that depends on the distance from the collision point to
    // the paddle's center.
    var delta = abs(y - (paddley + paddleh/2))/paddleh;

    // We change dx and dy such that the speed (dx² + dy²) stays the same
    dx = -dx*sqrt(1 - delta);
    dy = sqrt(pow(dy, 2) + pow(dx,2)*delta);
} 
```

您应该添加一个因素`delta`并对其进行更改，直到球按照您的意愿反弹。

# c++ - Boost库在ubuntu上产生错误

> ID：15939279
> 
> 赞同：0
> 
> 时间：2013-04-11T01:25:14.427
> 
> 标签：c++, boost, installation, boost-asio

我正在尝试编译从[这里](http://www.gamedev.net/blog/950/entry-2249317-a-guide-to-getting-started-with-boostasio/?pg=1)得到的代码。我已经使用 sudo apt-get install libboost-all-dev 在 Ubuntu 上安装了 boost 库。安装很顺利，我能够编译所有的例子。然后我尝试了一个使用 boost::asio 和 Google 协议缓冲区的[示例。](http://eli.thegreenplace.net/2011/03/20/boost-asio-with-protocol-buffers-code-sample/)Vim 中的 Clang_complete 开始给我一些奇怪的问题，这让我相信我需要更新 boost 的版本。（从存储库安装 1.46）。

我意识到 Ubuntu 存储库使用的是旧版本的 Boost，所以我决定自己下载并安装它。我使用[本](http://ubuntuforums.org/showthread.php?t=1180792)教程来安装库（将 ./bjam 替换为 ./b2）。这是问题开始的时候。下面的代码在 Synaptic 的 boost 安装中运行良好，但是在手动构建之后我得到了很多错误。我在想缺少什么，但我不确定如何确定我需要安装什么。

代码如下所示：

```
#include <boost/asio.hpp>
#include <boost/shared_ptr.hpp>
#include <boost/thread.hpp>
#include <boost/thread/mutex.hpp>
#include <boost/bind.hpp>
#include <iostream>

boost::mutex global_stream_lock;

void WorkerThread( boost::shared_ptr< boost::asio::io_service > io_service )
{
global_stream_lock.lock();
std::cout << "[" << boost::this_thread::get_id()
    << "] Thread Start" << std::endl;
global_stream_lock.unlock();

io_service->run();

global_stream_lock.lock();
std::cout << "[" << boost::this_thread::get_id()
    << "] Thread Finish" << std::endl;
global_stream_lock.unlock();
}

size_t fib( size_t n )
{
if ( n <= 1 )
{
    return n;
}
boost::this_thread::sleep( 
    boost::posix_time::milliseconds( 1000 )
);
return fib( n - 1 ) + fib( n - 2);
}

void CalculateFib( size_t n )
{
global_stream_lock.lock();
std::cout << "[" << boost::this_thread::get_id()
    << "] Now calculating fib( " << n << " ) " << std::endl;
global_stream_lock.unlock();

size_t f = fib( n );

global_stream_lock.lock();
std::cout << "[" << boost::this_thread::get_id()
    << "] fib( " << n << " ) = " << f << std::endl;
global_stream_lock.unlock();
}

int main( int argc, char * argv[] )
{
boost::shared_ptr< boost::asio::io_service > io_service(
    new boost::asio::io_service
);
boost::shared_ptr< boost::asio::io_service::work > work(
    new boost::asio::io_service::work( *io_service )
);

global_stream_lock.lock();
std::cout << "[" << boost::this_thread::get_id()
    << "] The program will exit when all work has finished."
    << std::endl;
global_stream_lock.unlock();

boost::thread_group worker_threads;
for( int x = 0; x < 2; ++x )
{
    worker_threads.create_thread( 
        boost::bind( &WorkerThread, io_service )
    );
}

io_service->post( boost::bind( CalculateFib, 3 ) );
io_service->post( boost::bind( CalculateFib, 4 ) );
io_service->post( boost::bind( CalculateFib, 5 ) );

work.reset();

worker_threads.join_all();

return 0;
} 
```

现在，当我尝试编译代码时，出现以下错误：

**命令行：** g++ -o example3a example3a.cpp -lboost_system -lboost_thread **编译器输出：**

```
In file included from /usr/include/boost/algorithm/string/replace.hpp:24:0,
             from /usr/include/boost/units/detail/utility.hpp:25,
             from /usr/include/boost/exception/detail/type_info.hpp:19,
             from /usr/include/boost/exception/detail/object_hex_dump.hpp:15,
             from /usr/include/boost/exception/to_string_stub.hpp:16,
             from /usr/include/boost/exception/info.hpp:16,
             from /usr/include/boost/exception/detail/exception_ptr.hpp:20,
             from /usr/include/boost/exception_ptr.hpp:9,
             from /usr/include/boost/thread/future.hpp:28,
             from /usr/include/boost/thread.hpp:24,
             from example3a.cpp:3:
/usr/include/boost/algorithm/string/formatter.hpp:102:16: error: ‘dissect_formatF’ in 
namespace ‘boost::algorithm::detail’ does not name a type
/usr/include/boost/algorithm/string/formatter.hpp:115:22: error:
‘boost::algorithm::dissect_formatter’ has not been declared
In file included from /usr/include/boost/exception/detail/exception_ptr.hpp:20:0,
             from /usr/include/boost/exception_ptr.hpp:9,
             from /usr/include/boost/thread/future.hpp:28,
             from /usr/include/boost/thread.hpp:24,
             from example3a.cpp:3:
/usr/include/boost/exception/info.hpp: In member function ‘virtual 
boost::shared_ptr<boost::exception_detail::error_info_base>
boost::exception_detail::error_info_container_impl::get(const
boost::exception_detail::type_info_&) const’:
/usr/include/boost/exception/info.hpp:100:21: error: no match for ‘operator*’ in
‘*boost::exception_detail::type_info_((*(const std::type_info*
(*((&p)->boost::shared_ptr<T>::operator* [with T =
boost::exception_detail::error_info_base, typename
boost::detail::sp_dereference<T>::type = boost::exception_detail::error_info_base&
().boost::exception_detail::error_info_base::_vptr.error_info_base
0xfffffffffffffffffffffffffffffff8u)))).boost::exception_detail::type_info_::type_’
/usr/include/boost/exception/info.hpp:100:21: note: candidates are:
/usr/include/c++/4.6/complex:399:5: note: template<class _Tp> std::complex<_Tp>
std::operator*(const _Tp&, const std::complex<_Tp>&)
/usr/include/c++/4.6/complex:390:5: note: template<class _Tp> std::complex<_Tp>
std::operator*(const std::complex<_Tp>&, const _Tp&)
/usr/include/c++/4.6/complex:381:5: note: template<class _Tp> std::complex<_Tp>
std::operator*(const std::complex<_Tp>&, const std::complex<_Tp>&)
/usr/include/boost/exception/info.hpp:100:21: error: no match for ‘operator*’ in
‘*ti.boost::exception_detail::type_info_::type_’
/usr/include/boost/exception/info.hpp:100:21: note: candidates are:
/usr/include/c++/4.6/complex:399:5: note: template<class _Tp> std::complex<_Tp>
std::operator*(const _Tp&, const std::complex<_Tp>&)
/usr/include/c++/4.6/complex:390:5: note: template<class _Tp> std::complex<_Tp>
std::operator*(const std::complex<_Tp>&, const _Tp&)
/usr/include/c++/4.6/complex:381:5: note: template<class _Tp> std::complex<_Tp> 
std::operator*(const std::complex<_Tp>&, const std::complex<_Tp>&) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:51:19.020

好的，我得到它的工作。我按照[此处](http://ubuntuforums.org/showthread.php?t=1180792)的说明进行操作，但以下内容似乎弄乱了安装：

```
/bootstrap.sh --exec-prefix=/usr --libdir=/usr/lib --includedir=/usr/include 
```

（我注意到旧版本的 boost 在 /usr/include 和 /usr/lib 中。这就是我添加上述选项的原因。:(

相反，我简单地尝试了这个：

```
./bootstrap.sh
./b2
sudo ./b2 install 
```

现在示例编译。

# node.js - 如何将 node.js 缓冲区传递给需要 Stream 的函数？

> ID：15939280
> 
> 赞同：0
> 
> 时间：2013-04-11T01:25:14.553
> 
> 标签：node.js, tar

我有一个包含 tar 内容的缓冲区，我想用[tar](https://github.com/isaacs/node-tar) node.js 包解析它，但是使用这个包的所有示例都使用 .pipe() 和流 - 如何将缓冲区传递给 tar 包？

我从[AWS SDK](https://aws.amazon.com/sdkfornodejs/)获得 Buffer 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T04:10:18.737

Streams 有一个标准的 API，所以你可以直接使用`write`and`end`而不是使用`pipe`.

```
var data = ... // Buffer
var parser = tar.Parse();

// Bind whatever handlers you would normally bind
parser.on('entry', function(e){
});

// Write the data into the parser, which will parse it and trigger your event handlers
parser.end(data); 
```

# ios - 可以在调试打开的情况下为 iOS 应用程序恢复代码

> ID：15939283
> 
> 赞同：1
> 
> 时间：2013-04-11T01:25:48.973
> 
> 标签：ios, xcode, debugging

如果我分发一个打开调试的 iOS 应用程序，有多少代码可以被邪恶的人重构？

我问的是一个邪恶的人能够快速重建源代码，而不是哲学问题。

我的问题的核心是：编译器（在我的特定情况下为 gcc 或 llvm）将源代码的哪些方面插入到源代码中。

# svn - 在安装了 cygwin 的 dos 提示符下运行 shell 脚本时签出路径无效

> ID：15939284
> 
> 赞同：0
> 
> 时间：2013-04-11T01:26:22.260
> 
> 标签：svn, path, cygwin

这是在 dos 提示符下调用 shell 脚本时的结帐位置

```
+ svn co svn+ssh://builder@dev.serv/svn/scripts/Core_V6 /cygdrive/c/.jenkins/jobs/TEST_BUILD/workspace/
A    C:\cygdrive\c\.jenkins\jobs\TEST_BUILD\workspace\test.sh 
```

这里的路径无效（期望：C:.jenkins\jobs\TEST_BUILD\workspace\test.sh），在 c:\ 中创建了一个额外的 cygdrive 文件夹，它不是指 cygwin 安装中的 cygdrive 文件夹。

从 cygwin 终端运行结帐时，它提供了一个有效的路径

```
$ svn co svn+ssh://builder@dev.serv/svn/scripts/Core_V6 /cygdrive/c/.jenkins/jobs/TEST_BUILD/workspace/
A    /cygdrive/c/.jenkins/jobs/EVEREST_BUILD/workspace/Everestv6builder/everest_orj.sh 
```

这不会创建任何其他文件夹。cygwin 版本 1.7.17 是使用的版本。

当子流程被分叉时，路径被误解的可能原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T19:50:29.563

我遇到了类似的问题。我使用的是文本编辑器，其中 EOL ( CRLF ) 设置为 DOS/Windows。使用 cygwin 时，应将 EOL 转换为 UNIX EOL ( LF )。

# python - 如何将整数列表转换为整数？

> ID：15939285
> 
> 赞同：0
> 
> 时间：2013-04-11T01:26:25.903
> 
> 标签：python

我正在制作一个程序，只要数字低于 300，就可以从最低到最高对数字进行排序，但我不知道如何将用户输入更改为列表。这是我的代码：

```
List1=[]
List2=[]
var=1
thing=input("Insert numbers here")
List1.append(thing)
while var < 300:
    for that in List1:
        if that < var:
            List2.append(number)
    var = var + 1
print(List2) 
```

当我运行代码时，它说在第 8 行，字符串不能与 int 进行比较。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:28:55.123

看起来你的变量`that`是一个字符串。这就是为什么您不能将其与整数进行比较的原因。如果您需要将字符串转换为[int](http://docs.python.org/2/library/functions.html#int)，您可以简单地用[int](http://docs.python.org/2/library/functions.html#int) (your_variable_here) 包装它。

例如

`if int(that) < var:`

这会将字符串转换`that`为[整数](http://docs.python.org/2/library/functions.html#int)（数字）。将其转换为整数的好处是您可以将其与其他整数进行比较，并使用基本的[算术运算](http://en.wikipedia.org/wiki/Arithmetic#Basic_arithmetic_operations)。如果您使用字符串，那将是不可能的。

更好的解决方案是将输入直接存储为整数。

```
List1.append(int(thing)) # We wrap the keyboard input with int 
```

此外，如果您正在运行 Python 2.x，我建议您使用[raw_input](http://docs.python.org/2/library/functions.html#raw_input)，而不是[input](http://docs.python.org/2/library/functions.html#input)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:42:46.743

由于这似乎没有在任何循环中，我看不出您如何在列表中拥有多个条目。也许您可以输入空格分隔的数字？使用**python 3**，这可以像这样最小化（减去错误处理）：

```
nums = [x for x in list(map(int, input("Enter numbers: ").split())) if x < 300]    
nums.sort() 
```

或者..

```
nums = input("Enter numbers: ") # Get the number string
nums = nums.split() # Split the string by space character
nums = list(map(int, nums)) # call int() on each item in the list, converting to int
nums.sort() # sort the list of numbers
nums = [x for x in nums if x < 300] # remove any numbers 300 or over. 
```

输入输出：

```
Enter numbers: 1 5 301 3000 2
[1, 2, 5] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T18:22:25.390

如果您输入以逗号分隔的数字，则以下单行将起作用：

```
>>> sorted(list(input("Enter numbers: ")), reverse=True)
Enter numbers: 1, 2, 3
[3, 2, 1] 
```

要删除 < 300 的数字：

```
>>> sorted([num for num in input("Enter numbers: ") if num < 300], reverse=True)
Enter numbers: 1, 301, 299, 300, 2, 3
[299, 3, 2, 1] 
```

# struts2 - 如何将验证错误显示为列表

> ID：15939287
> 
> 赞同：0
> 
> 时间：2013-04-11T01:26:48.737
> 
> 标签：struts2

我在 jsp 文件中有一个带有此代码的简单登录表单：

```
 <s:form
        action="conexion" validate="true" theme="xhtml" target="formError">
        <s:textfield name="username" key="profile.rut" />
        <s:password name="password" key="profile.password" />
        <s:submit id="boton_ingreso"/>
    </s:form> 
```

当它被渲染时，它以这种方式渲染：

```
<form onreset="clearErrorMessages(this);clearErrorLabels(this);" method="post" target="formError" action="/AgendaPlus/conexion.action" onsubmit="return validateForm_conexion();" name="conexion" id="conexion">
<table class="wwFormTable">
<tbody><tr>
<td class="tdLabel"><label class="label" for="conexion_username">RUT:</label></td>
<td><input type="text" id="conexion_username" value="" name="username"></td>
</tr>

<tr>
<td class="tdLabel"><label class="label" for="conexion_password">Contraseña:</label></td>
<td><input type="password" id="conexion_password" name="password"></td>
</tr>

<tr>
<td colspan="2"><div align="right"><input type="submit" value="Submit" id="boton_ingreso" class="ui-button ui-widget ui-state-default ui-corner-all" role="button" aria-disabled="false">
</div></td>
</tr>

</tbody></table></form> 
```

这样，当发生错误时，错误会显示在每个字段上方，并带有错误作为`<tr>`标记，并且由于它是一个表格，因此我无法将其设置为移动到其他地方。我尝试使用`<s:form>`标签的目标属性，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:33:10.753

请参阅[fielderror 的标签文档](http://struts.apache.org/development/2.x/docs/fielderror.html)：

```
<s:fielderror /> 
```

您知道还有其他主题，并且您可以创建自己的主题，对吗？

例如，`"simple"`主题不会呈现任何表格或错误。

该`target`属性似乎是错误报告的一种奇怪用途。

# android - android中的表格布局（跨度/收缩）？

> ID：15939292
> 
> 赞同：0
> 
> 时间：2013-04-11T01:28:02.143
> 
> 标签：android, html, layout, android-tablelayout

我想要这个特殊的表格布局：

![餐桌布置](https://i.stack.imgur.com/mK3Tj.jpg)

在我当前的布局中，较短的单元格与具有长文本的单元格大小相同：

![布局错误](https://i.stack.imgur.com/owu0O.jpg)

必须怎么做？

它应该看起来像第一张图片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:06:51.950

可能有更好的方法可以做到这一点，实际上我以前没有使用过 TableLayout，但下面的 XML 给出了您要求的基本布局：

```
 <TableLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <TableRow
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_span="4"
                android:layout_weight="1"
                android:text="Text"
                android:gravity="center" />
        </TableRow>

        <TableRow
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.25"
                android:text="Text" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_span="3"
                android:layout_weight="0.75"
                android:text="Text that is longer than other cells" />
        </TableRow>

        <TableRow
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.25"
                android:text="Text" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.25"
                android:text="Text" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.25"
                android:text="Text" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.25"
                android:text="Text" />
        </TableRow>
    </TableLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T14:37:08.477

Yojimbo，你是对的，但是如果你使用

> 机器人：布局重量

您必须记住将（在这种特殊情况下） android:layout_width=" **wrap_content** " 替换为

> 机器人：布局宽度=“ **0dp** ”。

[在这里](https://stackoverflow.com/questions/3995825/what-does-androidlayout-weight-mean)你有一个很好的参考。

# c# - 错误：“您需要调用 RxApp.ConfigureServiceLocator 来设置服务位置”

> ID：15939294
> 
> 赞同：1
> 
> 时间：2013-04-11T01:28:24.093
> 
> 标签：c#, reactiveui

以下代码在问题标题中提供了运行时错误。但是，当我在 MainWindow 构造函数中注释掉 OneWayBind() 调用时，应用程序运行时不会出错。有任何想法吗？

**窗户**

```
public partial class MainWindow : Window, IViewFor<MainViewModel>
{
    public MainWindow()
    {
        ViewModel = new MainViewModel();

        InitializeComponent();

        this.OneWayBind(ViewModel, x => x.ContentItems, x => x.panelDemo.ItemsSource);
    }

    public MainViewModel ViewModel
    {
        get { return (MainViewModel)GetValue(ViewModelProperty); }
        set { SetValue(ViewModelProperty, value); }
    }
    public static readonly DependencyProperty ViewModelProperty =
        DependencyProperty.Register("ViewModel", typeof(MainViewModel), typeof(MainWindow), new PropertyMetadata(null));

    object IViewFor.ViewModel
    {
        get { return ViewModel; }
        set { ViewModel = (MainViewModel)value; }
    }
} 
```

**班上**

```
public class ContentItem
{
    public BitmapImage Image { get; set; }
    public string Name { get; set; }
} 
```

**视图模型**

```
public class MainViewModel : ReactiveObject
{
    string _Directory;
    public string Directory
    {
        get { return _Directory; }
        set { this.RaiseAndSetIfChanged(x => x.Directory, value); }
    }

    bool _IsBusy;
    public bool IsBusy
    {
        get { return _IsBusy; }
        set { this.RaiseAndSetIfChanged(x => x.IsBusy, value); }
    }

    ObservableAsPropertyHelper<IList<ContentItem>> _ContentItems;
    public IList<ContentItem> ContentItems
    {
        get { return _ContentItems.Value; }
    }

    public MainViewModel()
    {
        this.WhenAny(x => x.Directory, x => x.Value)
            .Do(_ => IsBusy = true)
            .Select(GetImages)
            .Do(_ => IsBusy = false);
    }

    IObservable<IList<ContentItem>> GetImages(string directory)
    {
        return new DirectoryInfo(directory).GetFiles().ToList().ToObservable()
            .Select(x => new ContentItem
            {
                Image = new BitmapImage(new Uri(x.FullName)),
                Name = x.Name
            }).ToList();
    }
} 
```

太感谢了！我唯一希望 ReactiveUI 4.5.0 是它具有当前的 WPF 实现示例！它们都已经过时了六个月或更长时间！

# r - 疑似内存问题后 R/Rstudio/Rstudio-server 的崩溃日志

> ID：15939307
> 
> 赞同：1
> 
> 时间：2013-04-11T01:29:47.010
> 
> 标签：r, rstudio, rstudio-server

我在 R 中有一个长时间运行的进程（通过 Rstudio-server），我怀疑它可能存在内存问题，最终导致 R 会话崩溃。不幸的是，我无法准确监控正在发生的事情：崩溃日志是否存在，如果存在，我在哪里可以找到它们？

我的设置如下：

*   Rstudio-server 安装在 ubuntu 12.04 中，在 vmmare 播放器虚拟机上。
*   我在安装 Windows 7 时从 firefox 访问 r 会话。
*   我让程序运行了一夜，回来发现rstudio界面出现以下错误信息：

    由于意外崩溃，先前的 R 会话异常终止。由于此崩溃，您可能丢失了工作区数据。

似乎以下代码导致了问题（不是可重现的示例）。该代码采用回归公式列表（约 250k）、1500 行 x 70 列的数据框，还允许您指定要在计算中使用的核心数：

```
get_models_rsquared = function(combination_formula,df,cores = 1){
  if (cores == "ALL"){cores <- detectCores()}
  require(parallel) #if parallel processing is not required, mclapply should be changed to lapply.

  #using mclapply to calculate linear models in parallel,
  #storing adjusted r-squared and number of missing rows in a list
  combination_fitted_models_rsq = mclapply(seq_along(combination_formula), function(i) 
    list(summary(lm(data = df, combination_formula[[i]]))$adj.r.squared,
         length(summary(lm(data = df, combination_formula[[i]]))$na.action)), mc.cores = cores  )

  #now store the adjusted r-squared and missing rows of data
  temp_1 = lapply(seq_along(combination_fitted_models_rsq), function(i) 
    combination_fitted_models_rsq[[i]][[1]])
  temp_1 = as.numeric(temp_1)

  temp_2 = lapply(seq_along(combination_fitted_models_rsq), function(i) 
    combination_fitted_models_rsq[[i]][[2]])
  temp_2 = as.numeric(temp_2)

  #this is the problematic line
  temp_3 =  lapply(seq_along(combination_formula), function(i) {
    length(attributes(terms.formula(combination_formula[[i]]))$term.labels)
  }#tells you number of predictors in each formula used for linear regression
   )#end lapply
  result = data.frame(temp_1,temp_2,temp_3)
  names(result) = c("rsquared","length.na","number_of_terms")
  return(result)
} 
```

调用函数时，计算`temp_3`似乎会出现问题。但是，如果您将代码从函数中取出并在运行函数**后进行**`temp_3`计算，则一切正常。

# android - 带有 ActionBarSherlock 的底部菜单

> ID：15939308
> 
> 赞同：0
> 
> 时间：2013-04-11T01:29:47.220
> 
> 标签：android, actionbarsherlock, menuitem, submenu

我正在尝试使用 ActionBarSherlock 实现底部菜单。在 Android 2.1 中显示菜单，但在 Android 4 中不显示菜单。怎么了？

![在此处输入图像描述](https://i.stack.imgur.com/LQlpg.jpg)

下面，代码：

```
public class Atividade extends Activity implements OnCreateOptionsMenuListener {

     ActionBarSherlock mSherlock = ActionBarSherlock.wrap(this);

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        if (android.os.Build.VERSION.SDK_INT < 11)
            // Remove title bar
            this.requestWindowFeature(Window.FEATURE_NO_TITLE);

        setTheme(R.style.Theme_Sherlock_Light_DarkActionBar);

        mSherlock.setUiOptions(ActivityInfo.UIOPTION_SPLIT_ACTION_BAR_WHEN_NARROW);        
        mSherlock.setContentView(R.layout.atividade);
        .
        .
        .               
    } 
```

下面是菜单选项：

```
 @Override
    public boolean onCreateOptionsMenu(Menu menu) {

        menu.add("Agenda")
            .setIcon(R.drawable.ic_compose)
            // .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);
            .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

        menu.add("Favoritos")
        .setIcon(R.drawable.favoritos)
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

        menu.add("Mapa")
            .setIcon(R.drawable.maps)
            .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

        com.actionbarsherlock.view.SubMenu subMenu1 = menu.addSubMenu("Compartilhar");              
        subMenu1.add("Facebook");
        subMenu1.add("Twitter");
        subMenu1.add("E-Mail");
        subMenu1.add("SMS");

        MenuItem subMenu1Item = (MenuItem) subMenu1.getItem();
        subMenu1Item.setIcon(R.drawable.compartilhar);
        subMenu1Item.setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T07:04:54.577

您可以考虑使用内部使用 ActionBarSherlock 的[HoloEverywhere](https://github.com/Prototik/HoloEverywhere)（也有演示源代码）。对于初学者，您可以翻译（右键单击 -> 在 chrome 上翻译）并使用[本](http://menzerath.eu/artikel/android/actionbarsherlock-holoeverywhere/)教程。个别样品可以在[这里](http://actionbarsherlock.com/download.html)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T03:51:20.043

让你的 Activity 扩展`SherlockActivity`。正如 Jake Wharton 建议的那样，使用清单来设置活动的`theme`和`uiOptions`属性。

# delphi - 我们如何在运行时检测和更改样式？

> ID：15939310
> 
> 赞同：4
> 
> 时间：2013-04-11T01:29:53.763
> 
> 标签：delphi, delphi-xe3, vcl-styles

Delphi XE3 及以下版本有适合我们应用程序的样式，这很酷。但是我注意到我们可以标记任意数量的样式，并且他们可以选择使用其中的哪个样式作为默认样式。

这意味着我们可以随意更改样式，但是如何在代码中进行呢？以及如何让用户选择在我们的软件中使用哪种风格？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-11T01:35:00.457

[`TStyleManager`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.Themes.TStyleManager)做你需要做的事情来完成这个任务。用于[`TStyleManager.StyleNames`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.Themes.TStyleManager.StyleNames)获取样式列表，并[`TStyleManager.TrySetStyle`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.Themes.TStyleManager.TrySetStyle)在运行时更改它们。

要了解它是如何工作的，请启动一个新的`VCL Forms Application`. 将您想要的所有 VCL 样式添加到项目中，然后将 a 拖放`TComboBox`到表单上。您需要`implementation` `uses`像下面这样添加子句：

```
uses
  Vcl.Themes;

procedure TForm1.ComboBox1Change(Sender: TObject);
begin
  TStyleManager.TrySetStyle(ComboBox1.Items[ComboBox1.ItemIndex]);
end;

procedure TForm1.FormShow(Sender: TObject);
var
  s: String;
begin
  ComboBox1.Items.BeginUpdate;
  try
    ComboBox1.Items.Clear;
    for s in TStyleManager.StyleNames do
       ComboBox1.Items.Add(s);
    ComboBox1.Sorted := True;
    // Select the style that's currently in use in the combobox
    ComboBox1.ItemIndex := ComboBox1.Items.IndexOf(TStyleManager.ActiveStyle.Name);
  finally
    ComboBox1.Items.EndUpdate;
  end;
end; 
```

# c# - 限制gridview的Boundfield中显示的字符数

> ID：15939313
> 
> 赞同：0
> 
> 时间：2013-04-11T01:30:40.677
> 
> 标签：c#, .net, gridview

我有一个显示用户名、主题和日期的网格视图。.aspx 代码如下所示：

```
 <asp:BoundField DataField="UserName" 
            SortExpression="UserName" />
        <asp:BoundField DataField="Subject" 
            SortExpression="Subject" />
        <asp:BoundField DataField="Date" 
            SortExpression="Date" /> 
```

如果用户输入一个 200 个字符的主题，我不希望它全部显示，否则页面会像疯了一样被拉伸。有没有办法进行检查，以便如果主题超过 60 个字符，其余的被删除并且 ... 只是附加上？所以主题会从说：

这是一个很长的主题

到

这是一个真正的......

我知道如何在后面的 C# 代码中执行此操作，但不确定如何在 .aspx 中操作它

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:36:55.793

试试这个：

```
<asp:TemplateField>
    <ItemTemplate>
        <%# ((string)Eval("Subject")).Length < 200? Eval("Subject") :((string)Eval("Subject")).Substring(0,200) + "..."%>)
    </ItemTemplate>
</asp:TemplateField> 
```

或者（更简洁）您可以（如果可能）将属性添加到数据源项类并以正常方式使用该属性。说，您的数据源项目类是`UserMail`；然后添加一个公共属性`TruncatedSubject`，例如：

```
partial class UserMail
{        
    public string TruncatedSubject
    {
       get
       {
           return Subject.Length < 200? Subject : (Subject.SubString(0,200) + " ...");
       }
    }        
} 
```

然后您可以像普通列一样使用它（`TruncatedSubject`而不是）。`Subject``BoundField`

# java - 逐条比较两个非常大的 XML 文件的最佳方法

> ID：15939314
> 
> 赞同：4
> 
> 时间：2013-04-11T01:30:46.043
> 
> 标签：java, xml, vtd-xml

我有两个大型 XML 文件（3GB，80000 条记录）。一个是另一个的更新版本。我想确定哪些记录已更改（已添加/更新/删除）。文件中有一些时间戳，但我不确定它们是否可信。与文件中的记录顺序相同。

这些文件太大而无法作为 XML 加载到内存中（即使是一个，也不要介意两者）。

我正在考虑的方式是在记录级别的第一个文件中使用 ID 的内存映射对内容偏移量进行某种解析/索引，然后流式传输第二个文件并使用随机访问来比较那些记录两者都存在。这可能需要 2 或 3 次通过，但没关系。但是我找不到可以让我这样做的简单库/方法。带有 VTDNavHuge 的 vtd-xml 看起来很有趣，但我无法理解（从文档中）它是否支持基于预保存位置的随机访问重新访问和加载记录。

Java 库/解决方案是首选，但 C# 也是可以接受的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-23T01:19:28.303

只需使用 SAX 或 StAX 同时解析两个文档，直到遇到差异，然后退出。它不会将文档保存在内存中。任何标准 XML 库都将支持 S(t)AX。唯一的问题是，如果您认为元素的不同顺序无关紧要......

# algorithm - 查找数组中所有索引的索引右侧的最小元素

> ID：15939318
> 
> 赞同：0
> 
> 时间：2013-04-11T01:31:16.693
> 
> 标签：algorithm

给定一个数组，我希望找到当前元素右侧的最小元素 i where`0=<i<n`并将相应最小元素的索引存储在另一个数组中。

例如，我有一个数组 A ={1,3,6,7,8} 结果数组将包含 R={1,2,3,4} 。（R 数组存储最小元素的索引）。我只能想到一种 O(N^2) 方法.. 对于 A 中的每个元素，我将遍历 A 右侧的剩余元素并找到最小值。是否可以在 O(N) 中做到这一点？我想使用该解决方案来解决另一个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:36:36.483

您应该能够通过从*右侧*填充数组并维护当前最小值的索引来在 O(n) 中执行此操作，如下面的伪代码：

```
def genNewArray (oldArray):
    newArray = new array[oldArray.size]
    saveIndex = -1
    for i = newArray.size - 1 down to 0:
        newArray[i] = saveIndex
        if saveIndex == -1 or oldArray[i] < oldArray[saveIndex]:
            saveIndex = i
    return newArray 
```

这通过数组*一次，*给你 O(n) 时间复杂度。它可以这样做，因为一旦你找到了元素 N 之外的最小值，它只会在元素 N 小于当前最小值时改变元素 N-1。

以下 Python 代码显示了这一点：

```
def genNewArray (oldArray):
    newArray = []
    saveIndex = -1
    for i in range (len (oldArray) - 1, -1, -1):
        newArray.insert (0, saveIndex)
        if saveIndex == -1 or oldArray[i] < oldArray[saveIndex]:
            saveIndex = i
    return newArray

oldList = [1,3,6,7,8,2,7,4]
x = genNewArray (oldList)

print "idx", [0,1,2,3,4,5,6,7]
print "old", oldList
print "new", x 
```

这个的输出是：

```
idx [0, 1, 2, 3, 4, 5, 6, 7]
old [1, 3, 6, 7, 8, 2, 7, 4]
new [5, 5, 5, 5, 5, 7, 7, -1] 
```

您可以看到新数组（第二个）每个元素的索引正确地指向原始数组（第一个）中每个元素右侧的最小值。

请注意，我采用了“右侧”的一个特定定义，这意味着它不包括当前元素。如果您对“右侧”的定义包括当前元素，只需更改循环中`insert`and`if`语句的顺序，以便首先更新索引：

```
idx [0, 1, 2, 3, 4, 5, 6, 7]
old [1, 3, 6, 7, 8, 2, 7, 4]
new [0, 5, 5, 5, 5, 5, 7, 7] 
```

`saveIndex`由于您知道可以在最后一个元素中找到最后一个元素的最小索引，因此该代码删除了检查：

```
def genNewArray (oldArray):
    newArray = []
    saveIndex = len (oldArray) - 1
    for i in range (len (oldArray) - 1, -1, -1):
        if oldArray[i] < oldArray[saveIndex]:
            saveIndex = i
        newArray.insert (0, saveIndex)
    return newArray 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:37:37.423

看起来像HW。令 f(i) 表示 i 处元素右侧的最小元素的索引。现在考虑向后走（填写 f(n-1)，然后是 f(n-2), f(n-3), ..., f(3), f(2), f(1)）并思考关于 f(i) 的信息如何为您提供 f(i-1) 的信息。

# asp.net - w3wp 使用 700mb-1.2gb 的内存而不是负载

> ID：15939319
> 
> 赞同：1
> 
> 时间：2013-04-11T01:31:46.533
> 
> 标签：asp.net, asp.net-mvc-3, entity-framework, redgate

我有一个使用 EF/Autofac 和 memcached（3 个前端服务器）的 MVC3 应用程序。启动应用程序时，一个用户会迅速跃升至 300mb。在我们的生产站点（流量较低（任何时候<10 个用户））上，它可以轻松达到超过 1.2gb 的内存。这对我来说似乎是一个非常大的数字。

我尝试过 Redgate Memory Profiler，但我似乎找不到任何不寻常的东西。

我唯一能想到的可能是以下代码导致某种内存泄漏你怎么看？

```
private Dictionary<string, object> cacheDictionary = new Dictionary<string, object>();

    private IMemcachedClient _client;

    public MemcachedManager(IMemcachedClient client)
    {
        this._client = client;
    }

    #region ICacheManager Members

    public T Get<T>(string key)
    {
        object data;
        if (!cacheDictionary.TryGetValue(key, out data))
        {
            byte[] byteData = _client.Get<byte[]>(key);
            data = CommonHelper.Deserialize<T>(byteData);
            cacheDictionary.Add(key, data);
        }
        return (T)data;
    }

    public void Set(string key, object data, int cacheTime)
    {
        if (!cacheDictionary.ContainsKey(key)) //if memcache turned off this should still work
            cacheDictionary.Add(key, data);

        data = CommonHelper.Serialize(data);
        bool setCache = _client.Store(StoreMode.Set, key, data, DateTime.Now.AddMinutes(cacheTime));

        if (!setCache)
        {
            log.ErrorFormat("Failed to set the cache item, key {0}", key);
        }
    } 
```

# php - Imagick 与 MAMP + php 5.3.6 + cakephp

> ID：15939323
> 
> 赞同：0
> 
> 时间：2013-04-11T01:32:28.130
> 
> 标签：php, apache, cakephp, mamp, imagick

我在 cakephp 应用程序中的 MAMP 安装上运行 imagick 时遇到问题。

我已按照[此处](http://thoomtech.com/post/8832473042/mamp-imagemagick-lion)指示的安装说明进行操作，如果我在 php 脚本中对其进行测试（我可以看到模块已加载到 phpinfo 中），则安装似乎对我来说存在“Imagick”类。但是，只要我回显任何内容，我使用该类运行的任何示例都会挂起。我的看法是：

```
<?php
    /* Create a new imagick object */
    $im = new Imagick();

    /* Create new image. This will be used as fill pattern */
    $im->newPseudoImage(50, 50, "gradient:red-black");

    /* Create imagickdraw object */
    $draw = new ImagickDraw();

    /* Start a new pattern called "gradient" */
    $draw->pushPattern('gradient', 0, 0, 50, 50);

    /* Composite the gradient on the pattern */
    $draw->composite(Imagick::COMPOSITE_OVER, 0, 0, 50, 50, $im);

    /* Close the pattern */
    $draw->popPattern();

    /* Use the pattern called "gradient" as the fill */
    $draw->setFillPatternURL('#gradient');

    /* Set font size to 52 */
    $draw->setFontSize(52);

    /* Annotate some text */
    $draw->annotation(20, 50, "Hello World!");

    /* Create a new canvas object and a white image */
    $canvas = new Imagick();
    $canvas->newImage(350, 70, "white");

    /* Draw the ImagickDraw on to the canvas */
    $canvas->drawImage($draw);

    /* 1px black border around the image */
    $canvas->borderImage('black', 1, 1);

    /* Set the format to PNG */
    $canvas->setImageFormat('png');

    /* Output the image */
    header("Content-Type: image/png");
    echo $canvas;
    ?> 
```

一旦`echo $canvas`遇到这个脚本就会挂起。**该脚本在一个普通的旧 php 文件中完美运行，**即在 cake 之外，但是当通过我的 cakephp 应用程序操作访问时它会挂起。我的操作代码是：

```
public function test(){

            $this->layout = false;
    } 
```

Cake 错误日志为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:26:15.863

好的，问题在于如何在 cakephp 中设置标题。Cake 不允许我以这种方式在视图中设置页眉。

我将以下代码添加到测试操作中：

```
$this->response->type("image/png"); 
```

它现在完美无缺。

# android - 如何使用多个 android.intent 类别？

> ID：15939324
> 
> 赞同：0
> 
> 时间：2013-04-11T01:32:29.677
> 
> 标签：android, android-intent, categories

像这样：（这个坏了）

```
<activity
        android:name="com.example.Main"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity
        android:name="com.example.IKI"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.MAINIKI" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

    <activity
        android:name="com.example.UC"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.MAINUC" />

            <category android:name="android.intent.category.**DEFAULT**" />
        </intent-filter>
    </activity> 
```

问题是粗体代码。我该如何使用该活动？还有哪些可供选择的类别？在那儿？我应该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:46:44.370

当您的项目中有多个主要活动类别时，您可以使用不同的活动。

# jquery - jquery - 以编程方式触发侦听器

> ID：15939325
> 
> 赞同：0
> 
> 时间：2013-04-11T01:32:30.763
> 
> 标签：jquery, listener

此侦听器当前通过单击 div 中的 ref 触发，如下所示。使用 jquery，如何以编程方式触发事件？- 或者可能更好地重写监听器。

```
$("#flipPad a:not(.revert)").bind("click",function(){
    var $this = $(this);
    $("#flipbox").flip({
        direction: $this.attr("rel"),
        color: $this.attr("rev"),
        content: $this.attr("title"), 
        onBefore: function(){$(".revert").show()}
    })
    return false;
}); 
```

html:

```
<div id="flipbox">Message1</div>
<div id="flipPad">
<a href="#" class="left" rel="rl" rev="#39AB3E" title="Change content as <em>you</em> like!">left</a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:33:57.533

你可以这样做：

```
$('#flipPad a:not(.revert)').click(); 
```

你也可以这样做：

```
$('#flipPad a:not(.revert)').trigger('click'); 
```

文档链接：

*   [jQuery.click()](http://api.jquery.com/click/)（见版本#3）
*   [jQuery.trigger()](http://api.jquery.com/trigger/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T01:34:05.700

这应该以编程方式触发它（触发事件处理程序）：

```
$("#flipPad a:not(.revert)").click(); 
```

# python - Python写入MySQL - 没有错误但没有写入

> ID：15939326
> 
> 赞同：1
> 
> 时间：2013-04-11T01:32:51.003
> 
> 标签：python, mysql, database

我正在尝试写入我的本地主机 MySQL 数据库。

我创建了一个名为“test”的数据库、一个名为“price_update”的表和一个名为“model”的行

当我运行下面的脚本时，我没有收到任何错误，但是，我也没有任何东西写入我的数据库。

我不确定从哪里开始寻找问题。该行是 varchar(10) 和排序规则 utf9_general_ci。

```
import MySQLdb

conn = MySQLdb.connect(host="127.0.0.1",user="someUser",passwd="somePassword",db="test")

query = "INSERT INTO price_update (model) values ('12345')"
x = conn.cursor()
x.execute(query)
row = x.fetchall() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:38:10.917

您必须提交更改：

```
conn.commit() 
```

另外，我会让您的查询更安全：

```
query = "INSERT INTO price_update (model) values (%s)"
...
x.execute(query, ('12345',)) 
```

# ruby-on-rails - 在 database.yaml 中使用不同的开发环境

> ID：15939332
> 
> 赞同：0
> 
> 时间：2013-04-11T01:33:27.603
> 
> 标签：ruby-on-rails

我希望有一个 database.yaml 作为两个独立团队正在开展的项目的一部分。虽然测试和生产部分相同，但两个团队的开发部分不同。有没有办法使用本地环境变量来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:38:41.647

您可以创建自己的配置机制（例如，每个用户、每台机器等），或者只是创建一个新配置并通过以下方式进行设置`RAILS_ENV`：

```
RAILS_ENV=dev1 rails s # Or rails c etc, to run the "other" dev config...
RAILS_ENV=dev2 rails s 
```

# excel - 数据透视表组跳过范围

> ID：15939334
> 
> 赞同：4
> 
> 时间：2013-04-11T01:33:31.763
> 
> 标签：excel, grouping, pivot-table

背景：Excel 数据透视表可以将数据分组到数字范围内，然后您可以将其用作数据透视图中的轴类别。

示例：Excel 可能会将 1-30 的一系列数字分为三组：

*   1-10
*   11-20
*   21-30

但是，如果数据只有：5、6、22、29，那么 Excel 将在数据透视表`1-10`的第一行和`21-30`第二行列出。它将跳过该`11-20`范围，因为该范围内没有数据值。

问题：如何包括所有组，所以当您创建数据透视图时，数据中的“漏洞”在哪里？（例如，在上面的示例中，如果您对每个组中的数据求和，您如何使数据透视表看起来像这样：

*   1-10：11
*   11-20：0
*   21-30：51

显示中间组，即使该组中没有数据值？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T01:42:10.977

字段设置 > 布局和打印，选中显示没有数据的项目。

# python - python编码问题或oracle问题

> ID：15939337
> 
> 赞同：1
> 
> 时间：2013-04-11T01:33:42.243
> 
> 标签：python, oracle

我使用python套接字从远程端接收段落并提取消息并保存在我的oracle数据库中，整个过程很好，但是orcale中的数据不可读，我不知道是哪个造成了麻烦，段落或python编码或甲骨文。这是示例段落

```
<?xml version="1.0" encoding="GBK"?>
<REQUEST>
<INFO>
<FUNNAM>GetTransInfo</FUNNAM>
<DATTYP>1</DATTYP>
<LGNNAM>直联集团管一</LGNNAM>
</INFO>
<SUMMARY>
<BBKNBR>57</BBKNBR>
<C_BBKNBR>杭州</C_BBKNBR>
<ACCNBR>571905400610608</ACCNBR>
<BGNDAT>20100525</BGNDAT>
<ENDDAT>20100528</ENDDAT>
<LOWAMT></LOWAMT>
<HGHAMT></HGHAMT>
<AMTCDR></AMTCDR>
</SUMMARY>
</REQUEST> 
```

python编码代码如下

```
data = data.lower().replace('encoding="gbk"', 'encoding="utf-8"')     
data = unicode(data, 'gbk').encode('utf-8') 
dom = parseString(data) 
```

当我运行 sql 脚本时

```
SELECT * FROM NLS_DATABASE_PARAMETERS 
```

我得到 NLS_CHARACTERSET 的结果是 AL32UTF8

谁能帮帮我。提前致谢。

# validation - 服务器端验证有效，但不显示错误消息

> ID：15939346
> 
> 赞同：2
> 
> 时间：2013-04-11T01:34:53.757
> 
> 标签：validation, struts2

我有这个表格：

```
 <s:form
        action="conexion" validate="true" theme="css_xhtml">
        <s:textfield name="username" key="profile.rut" labelposition="left" />
        <s:password name="password" key="profile.password" labelposition="left" />
        <s:submit id="boton_ingreso" align="left" cssClass="send" value="Entrar" />
    </s:form> 
```

这个验证器：

```
<validators>
<field name="username">
    <field-validator type="requiredstring">
        <param name="trim">true</param>
        <message>*</message>
    </field-validator>
    <field-validator type="rutValidator">
        <param name="trim">true</param>
        <message>*</message>
    </field-validator>
</field>
<field name="password">
    <field-validator type="requiredstring">
        <param name="trim">true</param>
        <message>*</message>
    </field-validator>
</field>    
</validators> 
```

而这个定义：

```
 <action name="conexion" class="agenda.SecurityAction">
        <interceptor-ref name="profiling">
            <param name="profilingKey">profilingKey</param>
        </interceptor-ref>            
        <interceptor-ref name="jsonValidationWorkflowStack"/>
        <result name="success" type="tiles">/profile.tiles</result>
        <result name="error" type="redirectAction">
            <param name="actionName">cliente</param>
        </result>
        <result name="input" type="redirectAction">
            <param name="actionName">cliente</param>
        </result>
    </action> 
```

这在客户端非常有效。但是当我从表单中删除 validate="true" 以测试服务器端时，valdation occus 并且表单再次加载，但没有出现错误消息。

关于相同的其他问题：我没有使用 JSON 验证，而是使用普通的客户端验证。为什么当我删除定义时它不起作用？

我猜这是因为 jsonValidationWorkflowStack 可能继承自其他验证拦截器。如果是的话，也许定义另一个比较方便，而不是jsonValidationWorkflowStack。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T06:03:31.310

您的`input`结果是重定向，并且在重定向期间所有请求属性（也包括消息）都消失了，您必须使用 MessageStoreInterceptor 在请求之间保留它们。

参见[Struts 2 Validation using Message Store Interceptor](https://stackoverflow.com/questions/13414543/struts-2-validation-using-message-store-interceptor)

[http://struts.apache.org/development/2.x/docs/message-store-interceptor.html](http://struts.apache.org/development/2.x/docs/message-store-interceptor.html)

# ios - 类别中创建的按钮的选择器调用已发布的方法

> ID：15939349
> 
> 赞同：1
> 
> 时间：2013-04-11T01:35:11.860
> 
> 标签：ios, objective-c, exc-bad-access, objective-c-category

我有一个类的类别，它创建一个使用以下选项正确初始化的按钮

```
[cancelButton addTarget:self action:@selector(cancelReconnect:) forControlEvents:UIControlEventTouchUpInside]; 
```

然后在同一个 category.m 文件中我有方法

```
-(void)cancelReconnect{ NSLog(@"here!"); } 
```

当在导入类别的视图控制器中按下按钮时，我得到一个 EXC_BAD_ACCESS 并且看起来我的方法/类似乎已被释放。

如果我将相同的 cancelReconnect 方法放在“self”所在的视图控制器中。这是相同的结果。

我的 addTarget 正确吗？我的选择器方法被释放了吗？如何解决这个问题？

请注意，我的自定义类的 .h 文件中的 toolBarItems 数组很强大，但我不知道数组中的按钮是否是。视图控制器是否保留指向类的类别方法的强指针

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:39:21.420

你犯了一个常见的错误。您的实际方法已命名`cancelReconnect`，但您告诉按钮选择器已命名`cancelReconnect:`（注意冒号）。

将您的方法更改为：

```
- (void)cancelReconnect:(UIButton *)button {
    NSLog(@"here!");
} 
```

# django - ForeignKey 和多对多自查询

> ID：15939352
> 
> 赞同：1
> 
> 时间：2013-04-11T01:35:38.500
> 
> 标签：django, django-models

我有一个 Django 模型如下：

```
class Topic(models.Model):
    name=models.CharField(db_index=True,max_length=30)
    categorykey=models.ForeignKey(Category)

class Category(models.Model):
    categorykey=models.CharField(db_index=True,max_length=30)
    relatedcategories=models.ManyToManyField("Category",symmetrical=False) 
```

类别可以具有相关类别。例如，如果类别是“兽医”，则相关类别可能是“动物”、“医学”等。我想找到一个类别中的所有主题及其相关类别。

我不知道该怎么做，我想我想要类似的东西：

```
categorykey="Vet"
topics=list(Topic.objects.filter(categorykey__relatedcategories__in=categorykey)) 
```

但这只会引发错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T09:40:00.683

尝试这个：

```
topics = Topic.objects.filter(categorykey__relatedcategories__categorykey = 'Vet') 
```

或这个：

```
vet_category = Category.objects.get(category_key = 'Vet')
topics = Topic.objects.filter(categorykey__relatedcategories = vet_category) 
```

（取决于哪个对您更方便。）

# python - Python中的十六进制值

> ID：15939357
> 
> 赞同：3
> 
> 时间：2013-04-11T01:37:03.293
> 
> 标签：python, hex

撇开关键术语不谈，单词 value of `0xFF20`is `-224`。从`int( 'FF20', 16 )`我得到`65312`。

考虑到语言的高级特性，在 Python 中获取十六进制字符串的“单词”值的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T01:42:25.113

如果您想要签名值，就像 Pantashu 提到的那样，那么您可以使用`ctypes`

```
ctypes.c_short(int('FF20', 16)).value 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T01:42:22.320

如果第一个字符的高位设置（8-F），则在解析后从您的值中减去值 0x1000...（0 的数量等于单词中的十六进制字符的数量）。

例如，FF20 设置了高位，将其转换为十进制并从中减去 0x10000 (65536 - 65312 = -224)

您可以通过计算 2 的 4*word 中十六进制字符数的幂来计算值 0x100...。例如 2^(4*4) = 65536

# javascript - 为什么在循环中运行 splice 方法时 JS 数组会跳过某些条目？

> ID：15939359
> 
> 赞同：1
> 
> 时间：2013-04-11T01:37:14.860
> 
> 标签：javascript

我有一个数组：

```
var productIds = new Array("1","6","7","Product-Total","ccFirst","ccLast","email","ccExpMonth","ccExpYear","billingAddress","billingCity","billingState","billingZip"); 
```

如果它不是数字，我想删除一个值：

```
for(var i=0; i<productIds.length; i++){
   if(isNaN(Number(productIds[i]))) {  
       productIds.splice(i,1);          
   }
} 
```

似乎拼接方法正在影响值的位置。

我找到了这个解决方案（[遍历数组并删除项目，而不中断 for loop](https://stackoverflow.com/questions/9882284/looping-through-array-and-removing-items-without-breaking-for-loop)），这是我认为我需要的，但我不知道如何为我的代码实现他们的答案。

我该如何解决我的问题？

顺便说一句，我发布了一个更详细的 jsFiddle：http: [//jsfiddle.net/fte3m/2/](http://jsfiddle.net/fte3m/2/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T01:38:45.677

当您删除 index 处的条目时`i`，您需要从中减去 1，`i`以便不会跳过向下移动的条目。

```
for(var i=0; i<productIds.length; i++){
   if(isNaN(productIds[i])) {  
       productIds.splice(i--,1);  // <-- Decrement i
   }
} 
```

正如 RobG 在他的评论中指出的那样，在另一个方向上简单地处理数组更容易：

```
for(var i=productIds.length - 1; i>=0; i--){
   if(isNaN(productIds[i])) {
       productIds.splice(i,1);
   }
} 
```

或者，如果您不介意重新分配`productIds`为新的数组对象并且您正在运行 JS 1.6 或更高版本：

```
productIds = productIds.filter(function (id) {
    return !isNaN(id);
}); 
```

（请注意，在上面，我只使用`isNaN(value)`而不是`isNaN(Number(value))`。无论何时`Number(value)`返回`NaN`，`isNaN(value)`都会返回`true`，*反之亦然*。另请注意，这两种方法都不会过滤掉一个`null`id，因为`Number(null)==0`和`isNaN(null)==false`。如果你想`null`从结果中排除条目，你会需要单独测试。）

# java - 玩框架！如何限制仅来自一台主机的请求

> ID：15939364
> 
> 赞同：0
> 
> 时间：2013-04-11T01:38:08.427
> 
> 标签：java, playframework

我正在使用播放！1.2.5，我不确定我设计的方法是不是最好的方法！

我想将应用程序接受的请求限制为仅从**代理**机器接收到的请求。

我在 中找不到这样的功能，`application.conf`所以我编写了一个插件来在调用每个操作之前检查 IP 地址：

```
public class MyPlugin extends PlayPlugin {

  @Override
  public void beforeActionInvocation(Method method) {
    System.out.println("\naction: " + method.getName());
    String ip = Http.Request.current.get().remoteAddress;
    ip = ip.trim();    
    System.out.println("\nIP: " + ip);

    if (!ip.equals("x.x.x.x")) {
      // i don't know how to stop invocation of ActionMethod 
    }
  }
} 
```

现在，如果是正确的方法，当IP地址不是代理机IP地址时，如何停止调用action方法？

# ember.js - 模型加载后，计算属性未按预期更新。我是否错误地使用它们？

> ID：15939372
> 
> 赞同：0
> 
> 时间：2013-04-11T01:38:55.820
> 
> 标签：ember.js

我有一个月历显示，我正在尝试列出该月安排的所有活动。它在启动时不起作用——没有出现任何事件。但是，如果我单击“下一步”（未显示）来切换月份，过滤就会起作用。（如果我切换回原来的月份，事件将根据需要显示。）

怀疑我在使用计算属性时有错误。

问题：如何在事件加载后触发 monthEvents 计算属性？

我知道它在启动时会触发一次，但还没有加载任何事件。（我已经搞定了：

```
console.log(this.get('controllers.events.content.get('length')) 
```

来自monthEvents，并且计数最初为零。

我希望它会在事件成功加载后重新启动。（我正在使用 Ember Data，并且正在 ApplicationRoute 中加载事件——这是一个错误吗？）

这是 MonthsEventsController：

```
App.MonthEventsController = Ember.ArrayController.extend({
  needs: ['events', 'month'],
  monthEvents: function() {
    var currentMonth = this.get('controllers.month.content');
    return this.get('controllers.events.content').filter(function(event) { 
      return currentMonth.doesContainDate(event.get('startTime'));
    });
  }.property('controllers.events@each.startTime', 'controllers.month.content')
}); 
```

以及加载事件的 ApplicationRoute：

```
App.ApplicationRoute = Ember.Route.extend({
  setupController: function() {
    this.controllerFor('events').set('content', App.Event.find());
  }
} 
```

有任何想法吗？我的代码中是否有特定的地方我应该强制运行循环执行？（我尝试在代码中的各个随机点处折腾 Ember.run.sync()，但还没有运气。）或者我是否需要以不同的方式连接计算属性？

谢谢

# asp.net - 使用 System.Threading.ThreadPool 时没有内容的电子邮件

> ID：15939378
> 
> 赞同：4
> 
> 时间：2013-04-11T01:40:28.107
> 
> 标签：asp.net, .net, multithreading, threadpool, system.net.mail

我在尝试使用`Threading.ThreadPool`.

这已经工作了一年多，但最近它表示间歇性地发送没有内容的电子邮件。收件人和主题都很好，但是，电子邮件的其余部分是空白的。代码方面没有任何改变（除了 Windows 更新到它运行的服务器）。

这是我正在使用的代码 - 有没有人建议我如何缩小问题发生的范围？将电子邮件重新发送给声称收到空白电子邮件的人后，他们会很好 - 它使用与发送的第一封完全相同的代码。

**子生成电子邮件：**

```
 Public Sub EmailConfirmation(email As String,
                                 firstname As String,
                                 details As String)

        Try

            Dim embody As String = GlobalHelper.emailBody
            'static class which loads the email text at application load for use later.
            'This is a point of concern because it's obviously where the embody text is
            'is loaded, but the issue is intermittent and if there was a failure here surely
            'it would be caught by the 'try...catch' and a log of the error created (which has
            'never happened). I also ran an experiment for a while where if this string was 
            'empty then create a log entry. After receiving a complaint of a blank email
            'no error log was found.

            embody = Replace(embody, "[FirstName]", firstname)
            embody = Replace(embody, "[DATA]", details)

            'create the mail message
            Dim mail As New MailMessage()

            'set the addresses
            mail.From = New MailAddress("myemail@mydomain.com", "My Display Name")
            mail.To.Add(email)
            mail.IsBodyHtml = True

            'set the content
            mail.Subject = "Email Subject!"
            mail.Body = embody

            AddEmailToThreadPool(mail)

        Catch ex As Exception

        'if there is an error it is logged here. 

        End Try

    End Sub 
```

**添加到 ThreadPool 的 Sub：**

```
Private Sub AddEmailToThreadPool(email As MailMessage)
        System.Threading.ThreadPool.QueueUserWorkItem(New System.Threading.WaitCallback(AddressOf sendEmail), email)
    End Sub 
```

**发送电子邮件的子：**

```
Private Sub sendEmail(stateinfo As Object)

        Dim email As MailMessage = CType(stateinfo, MailMessage)

        Try

            'send the message
            Dim smtp As New SmtpClient("mail.mydomain.com")
            smtp.Send(email)
        Catch ex As Exception
            'error is logged here.
        End Try

    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T04:28:42.373

[我从 MSDN MailMessage 类](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.aspx)复制

> 此类型的任何公共静态（在 Visual Basic 中为 Shared）成员都是线程安全的。不保证任何实例成员都是线程安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T14:46:16.713

好吧，在修复了不正确的文档类型声明后，我在近一个月内没有收到任何关于空白电子邮件的投诉。我将假设这解决了所有问题，尽管我不确定为什么。

感谢您的所有输入/帮助。

# node.js - 如何从nodejs子进程（在windows和linuxish中）获取cwd（当前工作目录）

> ID：15939380
> 
> 赞同：43
> 
> 时间：2013-04-11T01:40:47.517
> 
> 标签：node.js, process

我正在尝试通过 nodejs 运行一个脚本：

```
cd ..
doSomethingThere[] 
```

但是，为此，我需要执行多个子进程并在这些进程之间传递环境状态。我想做的是：

```
var exec = require('child_process').exec;
var child1 = exec('cd ..', function (error, stdout, stderr) {
  var child2 = exec('cd ..', child1.environment, function (error, stdout, stderr) {
  });
}); 
```

或者至少：

```
var exec = require('child_process').exec;
var child1 = exec('cd ..', function (error, stdout, stderr) {
  var child2 = exec('cd ..', {cwd: child1.process.cwd()}, function (error, stdout, stderr) {
  });
}); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-11T03:24:21.000

以父目录作为 cwd 启动子项：

```
var exec = require('child_process').exec;
var path = require('path')

var parentDir = path.resolve(process.cwd(), '..');
exec('doSomethingThere', {cwd: parentDir}, function (error, stdout, stderr) {
  // if you also want to change current process working directory:
  process.chdir(parentDir);
}); 
```

**更新**：如果你想检索孩子的 cwd：

```
var fs = require('fs');
var os = require('os');
var exec = require('child_process').exec;

function getCWD(pid, callback) {
  switch (os.type()) {
  case 'Linux':
    fs.readlink('/proc/' + pid + '/cwd', callback); break;
  case 'Darwin':
    exec('lsof -a -d cwd -p ' + pid + ' | tail -1 | awk \'{print $9}\'', callback);
    break;
  default:
    callback('unsupported OS');
  }
}

// start your child process
//    note that you can't do like this, as you launch shell process 
//    and shell's child don't change it's cwd:
// var child1 = exec('cd .. & sleep 1 && cd .. sleep 1');
var child1 = exec('some process that changes cwd using chdir syscall');

// watch it changing cwd:
var i = setInterval(getCWD.bind(null, child1.pid, console.log), 100);
child1.on('exit', clearInterval.bind(null, i)); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-05-11T09:15:40.153

如果您想在不使用操作系统特定的命令行实用程序的情况下获取当前工作目录，您可以使用“battled-tested”shelljs 库为您抽象这些内容，同时在下面使用子进程。

```
var sh = require("shelljs");
var cwd = sh.pwd(); 
```

好了，变量 cwd 保存了您当前的工作目录，无论您是在 Linux、Windows 还是 freebsd 上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T03:48:04.737

只是一个想法，如果您知道子进程的 PID，并且安装了[pwdx](http://linux.die.net/man/1/pwdx)（可能在 linux 上），您可以从节点执行该命令来获取子进程的 cwd。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-21T21:04:59.543

我认为最好的选择是操纵`options.cwd`对`exec`. 在`exec`回调中`this.pwd`，并`this.cwd`可能为您的实现提供杠杆作用。

# python - 在python中读取分隔的文本文件

> ID：15939382
> 
> 赞同：0
> 
> 时间：2013-04-11T01:41:09.783
> 
> 标签：python, mysql

我有一个包含许多 mysql 插入（150 万）的 txt 文件。我需要用 python 读取这个文件，并在每个 ';' 处划分这个文件 对于每个查询并使用 python 运行查询。我怎样才能在每个';'处划分这个文件？并用 python 运行查询？到目前为止，我的代码是：

```
import MySQLdb

db = MySQLdb.connect(host = "localhost",
                     user="root",
                     passwd="da66ro",
                     db="test")

f = open('E:/estudos/projetos/tricae/tests_python.txt') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T05:31:41.017

首先打开文件：

```
with open('youfilename.sql', 'r') as f:
    fileAsString = f.read().replace("\n", "")

sqlStatements = fileAsString.split(";") 
```

然后运行查询：

```
cursor = db.cursor()
for statement in sqlStatements:
    try:
        cursor.execute(statement)
        db.commit()
    except:     
        db.rollback() 
```

但当然你必须意识到这是一个可怕的想法。当您引用“;”时会发生什么 您要插入的字符串中的字符？你必须比你提出的问题更聪明一点——一般来说，假设任何关于你要插入数据库的数据都是一个糟糕的主意。

甚至比查询中断更糟糕：恶意代码呢？SQL注入？永远不要相信你没有清理过的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:43:48.850

好的，所以，首先你需要读取文件并用“;”分割它，这是用`split()`函数完成的。然后您可以循环或选择要执行的查询（或只执行整个文件而不拆分）。您可以在其中找到许多示例，我相信将它们组合成您需要的东西会很容易。

> 我需要[用 python 读取这个文件，](https://www.google.com.au/#hl=en&sclient=psy-ab&q=read+this+file+with+python&oq=read+this+file+with+python&gs_l=hp.12..0i22i30l4.68598.68598.4.69473.1.1.0.0.0.0.206.206.2-1.1.0...0.0...1c.1.8.psy-ab.FuPmEQOA8W8&pbx=1&bav=on.2,or.r_cp.r_qf.&bvm=bv.45107431,d.dGI&fp=211d78910c70c5a4&biw=1920&bih=979)并[在每个 ';' 处划分这个文件](https://www.google.com.au/#hl=en&gs_rn=8&gs_ri=psy-ab&tok=WJU7GHKUEaMQmrb7P-H80w&pq=divide%20this%20file%20at%20each%20%27;%27&cp=7&gs_id=6q&xhr=t&q=python+divide+this+file+at+each+%27;%27&es_nrs=true&pf=p&sclient=psy-ab&oq=python+divide+this+file+at+each+%27;%27&gs_l=&pbx=1&bav=on.2,or.r_cp.r_qf.&bvm=bv.45107431,d.dGI&fp=211d78910c70c5a4&biw=1920&bih=979) 对于每个查询并[使用 python 运行查询](https://www.google.com.au/#hl=en&sclient=psy-ab&q=run+the+query+with+python&oq=run+the+query+with+python&gs_l=hp.12..35i39.25136.25136.10.25691.1.1.0.0.0.0.191.191.0j1.1.0...0.0...1c.1.8.psy-ab.xxuV1ecxCsY&pbx=1&bav=on.2,or.r_cp.r_qf.&bvm=bv.45107431,d.dGI&fp=211d78910c70c5a4&biw=1920&bih=979)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-09T11:38:15.667

我是python新手..这是解决方法

```
import io

myfile = open('69_ptc_group_mappingfile_mysql.sql')

data = (myfile.read().decode("utf-8-sig").encode("utf-8")).lower()

query_list=[]

if 'delimiter' not in data:

query_list = (data.strip()).split(";")

else:

tempv =  (data.rstrip()).split('delimiter')
for i in tempV:
    if (i.strip()).startswith("//"):
        i = i.rstrip().split("//")
        for a in i:
            if len(a)!=0:
                query_list.append(a.strip())
    else:
        corr = ((i.rstrip()).split(";"))
        for i in corr:
            if len(i.rstrip())!=0:
                query_list.append(i.rstrip()) 
```

打印查询列表

对于 query_list 中的 j：cursor.execute(j)

# asp.net - CS0117：“System.Data.DataSet”不包含“GetXML”的定义

> ID：15939383
> 
> 赞同：0
> 
> 时间：2013-04-11T01:41:32.660
> 
> 标签：asp.net, xslt

下面是导致错误的代码。作为 XSL 和 ASP.NET 的新手，我不太明白为什么会发生错误......

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="view.aspx.cs" Inherits="ININ.Marquee.Web.view" %>
<%@ Import Namespace="System" %>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.Data.SqlClient" %>
<%@ Import Namespace="System.Configuration" %>
<%@ Import Namespace="System.Xml" %>
<%@ Import Namespace="System.IO" %>
<%@ Import Namespace="System.Xml.XPath" %>
<%@ Import Namespace="System.Xml.Xsl" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >

<html>
<head>

</head>

<body>

<form id="form1" runat="server" >
<div>
<script runat="server">

public string GetXMLAsString(XmlDocument myxml)
{
    StringWriter sw = new StringWriter();
        XmlTextWriter tx = new XmlTextWriter(sw);
        myxml.WriteTo(tx);

        string str = sw.ToString();// 
        return str;
}

public static string GetHtml(string xsltPath, string xml)
{
 MemoryStream stream = new MemoryStream(ASCIIEncoding.Default.GetBytes(xml));
 XPathDocument document = new XPathDocument(stream);
 StringWriter writer = new StringWriter();
 XslCompiledTransform transform = new XslCompiledTransform();
 transform.Load(xsltPath);
 transform.Transform(document, null, writer);
 return writer.ToString();
}

public string details = string.Empty;

private void Page_Load(object sender, EventArgs e)
{   
    /******** - This the START of all the Database Stuff - ********/
    // Create a String to hold the database connection string.
    // NOTE: Put in a real database connection string here or runtime won't work
    string sdwConnectionString = @"Data Source = server; user id=username; password=password; Initial Catalog = database;";

    // Create a connection
    SqlConnection sdwDBConnection = new SqlConnection(sdwConnectionString);

    // Open the connection
    sdwDBConnection.Open();

    // Create a String to hold the query.
    string query = "SELECT * from IWrkgrpQueueStats WHERE ((substring(convert(char,dIntervalStart,120),1,10) = substring(convert(char,getdate(),120),1,10)) AND (cName IN ('Password','Arbour/CMBS/Other','Incident Escalation', 'OPOM/SOS/MyAccount','PC/Outlook','Overflow')) AND (cReportGroup='*' AND cHKey3='*' AND cHKey4='*'))";

    // Create a SqlCommand object and pass the constructor the connection string and the query string.
    SqlCommand queryCommand = new SqlCommand(query, sdwDBConnection);

    // Use the above SqlCommand object to create a SqlDataReader object.
    SqlDataReader queryCommandReader = queryCommand.ExecuteReader();

    //Create a DataTable object to hold all the data returned by the query.
    DataTable duplicatedataTable = new DataTable();

    // Use the DataTable.Load(SqlDataReader) function to put the results of the query into a DataTable.
    duplicatedataTable.Load(queryCommandReader);    

    // Open the connection
    sdwDBConnection.Close();

    DataSet ds = new DataSet("interactions");

    ds.Tables.Add(duplicatedataTable);

    string XML = ds.GetXML();

    details=GetHtml(Server.MapPath("~/Test.xsl"), XML); 

}
</script>   

<table width="100%">
<tr>
<td align="left">
<table width="100%" border="0">
<tr bgcolor="Silver">
<th align="center">

        <%= details %>
</th>
</tr>
</table>
</td>
</tr>
</table>

</div>
</form>

</body>
</html> 
```

我已经查看了此代码和 .xsl 代码，似乎没有任何问题。谁能解释错误的含义以及导致错误的问题会发生在哪里？感谢你的协助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T04:14:26.997

我相信您的问题是区分大小写的问题之一。

你为什么不试试：

`string XML = ds.GetXml();`

而不是

`string XML = ds.GetXML();`

希望有帮助。

# javascript - 在初始化时引用自己的属性

> ID：15939388
> 
> 赞同：2
> 
> 时间：2013-04-11T01:42:02.877
> 
> 标签：javascript

可以在对象初始化时引用自己的属性吗？

我有一个对象应该是唯一的，并且只作为一个对象存在，所以我没有初始化程序等。

使用这样的东西：

```
var Myobj = {
    property1 : aaa,
    property2 : bbb,
    property3 : {a: self.property1 }
                /*  ^-- is this somehow possible without using a function? 
                        Or a better way to solve / structure this. .init() 
                        best option? */
}; 
```

**>>[小提琴](http://jsfiddle.net/XF77D/)<<**

*真实的*对象（在真实的代码中）有一个 add 函数，它接受关于使用什么函数等的选项。它是*“addEventListener”*的一种包装，其中的重点是能够删除监听器 - 这需要非匿名功能参考。

在*Myobj*中使用的函数由字符串或选项中的数字键指定 `Myobj.add()`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:49:55.553

`Object literals`一直保留`undefined`到收盘`}`，因此您要么必须将 property3 设为函数，要么将整个对象设为函数。

```
var Myobj = {
    property1 : 'aaa',
    property3 : function (){ return { a : this.property1 } }
}; 
```

或者

```
var MyObj = function(){
  this.property1 = 'aaa',
  this.property3 = { a: this.property1 }
}
var MyObjInstance = new MyObj(); 
```

这已经被问了很多次了：[在声明对象时访问属性？](https://stackoverflow.com/questions/15304446/access-properties-while-declaring-object/15304531#15304531)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:00:00.430

如果您使用占位符数组，它会起作用：

```
var prop = new Array();
var Myobj = {
    property1 : 'aaa',
    property2 : 'bbb',
    property3 : {a: prop}
};
prop.push(Myobj.property1);

window.alert(Myobj.property3.a); 
```

[http://jsfiddle.net/y2XwC/1/](http://jsfiddle.net/y2XwC/1/)

# mysql - 预订系统的核心 - 有效地找到未预订的项目

> ID：15939399
> 
> 赞同：3
> 
> 时间：2013-04-11T01:44:02.387
> 
> 标签：mysql

这似乎是一个常见的问题，但我一直在网上搜索并找不到答案。

我想保留一些东西几天（没有部分天），所以我想我需要一张类似的桌子：

```
CREATE TABLE reservations 
    (
     item int, 
     customer int, 
     startDate date, 
     endDate date
    ); 
```

（嗯，我的主键是什么？item 和 startDate？我还需要 PK 吗？）

但我的主要问题是如何在给定开始和结束日期的情况下找到免费物品。我的`SELECT ...`长相如何？

对于奖励分数，我们是否可以假设所有项目都是相同的，并且我想让它尽可能高效，所以如果我想从星期五开始预订，我希望找到一个保留到星期四的项目（因此是周五免费）。

对于双倍奖励分数，如果我需要 X 天的商品，我想在尽可能接近 X 天的时候找到预订有漏洞的商品。

我认为问题在于我试图找到不存在的东西（现有预订）。我发现的所有其他解决方案似乎都有一个带有项目 ID 的可预订日期表（值为 NULL、0 或 -1 表示“尚未预订”）。这对我来说似乎效率低下。这张桌子会延伸到多远的未来？

注意：有些人在询问读取与写入的比率。显然，每个预订只进行一次，所以这是一次写入（可能每天一次，具体取决于实现），我希望在用户搜索未预订的插槽时进行多次读取。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T05:29:25.047

```
SELECT item FROM reservations WHERE 
(endDate BETWEEN start AND end) OR (startDate BETWEEN start AND end) OR (startDate<start AND endDate>end) 
```

由@Strawberry 建议一个更好的查询看起来像这样

```
SELECT item FROM reservations WHERE
start<endDate AND end>startDate 
```

这将为您提供在您正在寻找的日期拍摄的物品。现在您需要查找不在此列表中的项目。所以如果你有一张桌子，你可以这样写

```
SELECT * FROM items WHERE item NOT IN 
SELECT item FROM reservations WHERE
start<endDate AND end>startDate) 
```

并且您会获得在您搜索期间免费的项目。

start，end 是日期您查找 startDate，endDate 是列。

```
SELECT item, start-r.startDate as diff FROM items as i 
LEFT JOIN reservations as r USING(item) 
WHERE i.item NOT IN 
(SELECT item FROM reservations WHERE
start<endDate AND end>startDate
) ORDER BY diff 
```

没有模式来测试它，但这个查询应该是你的第一个奖金的答案

至于第二个，这需要在一张表的行之间做一些数学运算，如果可能的话，我现在不知道如何在纯 MySQL 中做。

//编辑

当现有预订在搜索期之前和之后结束时，我用另一种情况更新了查询。

对于第二个奖金问题，这应该有效

```
SELECT item, r1.startDate-r2.endDate as diff FROM reservations as r1 JOIN (SELECT * FROM reservations) as r2 USING (item)
WHERE r1.startDate-r2endDate>=x AND item NOT IN
(SELECT item FROM reservations WHERE
r1.startDate<endDate AND r2.endDate>startDate)
ORDER BY diff ASC 
```

但这将是非常昂贵的查询。可能需要从子查询中的日期中添加/减去一天。

正如您在所有这些中看到的那样，我从帖子开头使用查询作为子查询，对于第一个和第二个查询，这不会是一个大问题，因为它只会执行一次。在第二个奖励的最后一个查询中，它必须分别为每一行执行（因为每个项目都有一个连接，给定项目的保留数量是 2 的幂），这可能是一个瓶颈。

我不知道您要保留的那些项目是什么，但如果它们不是很多 <1000 它可能足够快（每年最多 365000 行）但是如果项目数量真的很大，也许您可以使额外的条件在未来看起来最多一年，并且仅在必要时增加它加上分区它可以工作得非常快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T21:08:28.220

这对我的方法并不重要，但我假设你有一张`items`桌子。我还将提供一个不需要项目表的查询。单独的项目表的优点是您可以随着时间的推移轻松添加或淘汰项目。它们会自动显示在预订查询结果中，您可以稍后添加条件，例如`WHERE retireDate IS NULL or retireDate > @reservationWindowEnd`排除已停用的项目（而不是添加虚拟预订来实现相同的目标）。

举个例子，

```
CREATE TABLE items (
    item int, 
    description varchar(255),
    purchaseDate date,
    retireDate date
); 
```

让我们还为我们想要匹配的预订窗口设置一些示例值。

```
mysql> set @newReservationStart='2013-06-01';
Query OK, 0 rows affected (0.00 sec)

mysql> set @newReservationEnd='2013-06-04';
Query OK, 0 rows affected (0.00 sec) 
```

现在让我们找到至少在目标持续时间的一部分期间保留*的*项目列表：

```
SELECT
    DISTINCT item
FROM reservations
WHERE
    @newReservationStart BETWEEN startDate AND endDate
    OR startDate BETWEEN @newReservationStart and @newReservationEnd 
```

我们想要*未*反转的项目列表，因此我们找到不在此列表中的项目列表：

```
SELECT
    item
FROM
    items
WHERE
    item NOT IN (
        SELECT
            DISTINCT item
        FROM reservations
        WHERE
            @newReservationStart BETWEEN startDate AND endDate
            OR startDate BETWEEN @newReservationStart and @newReservationEnd
    ) 
```

请注意，如果您没有单独的 items 表，则可以替换`SELECT item FROM items`为`SELECT DISTINCT item FROM reservations`.

现在我们有了一个已知可用项目的列表，让我们决定我们想要哪一个。

对于每个项目，我们需要知道它的哪个保留是在目标窗口之前最后结束的：

```
SELECT item, MAX(endDate) AS endDate
FROM reservations
WHERE endDate < @newReservationStart
GROUP BY item 
```

我们想知道它的哪个保留是在目标保留期之后首先开始的：

```
SELECT item, MIN(startDate) AS startDate
FROM reservations
WHERE @newReservationEnd < startDate
GROUP BY item 
```

在进一步讨论之前，让我们将其放在一起以一次获取相关项目的所有这些信息：

```
SELECT
    items.item AS item,
    priorReservation.endDate AS priorEnd,
    nextReservation.startDate AS nextStart
FROM
    items
    LEFT JOIN
        (
            SELECT item, MAX(endDate) AS endDate
            FROM reservations
            WHERE endDate < @newReservationStart
            GROUP BY item
        ) priorReservation ON priorReservation.item = items.item
    LEFT JOIN
        (
            SELECT item, MIN(startDate) AS startDate
            FROM reservations
            WHERE @newReservationEnd < startDate
            GROUP BY item
        ) nextReservation ON nextReservation.item = items.item
WHERE
    items.item NOT IN (
        SELECT
            DISTINCT item
        FROM reservations
        WHERE
            @newReservationStart BETWEEN startDate AND endDate
            OR startDate BETWEEN @newReservationStart and @newReservationEnd
    ) 
```

不是太寒酸。我们还知道上一个预订何时结束以及下一个预订何时开始。如果没有先前或下一个预留，则 LEFT JOIN 确保相应的值为空。因为我们知道所有列出的项目都是可用的，所以我们可以按照我们想要的条件进行排序。

我们可以通过最“舒适”的窗口订购：

```
ORDER BY DATEDIFF(nextStart, priorEnd) 
```

或者最小化上一次预订结束和这次预订开始之间的时间：

```
ORDER BY DATEDIFF(@newReservationStart, priorEnd) 
```

或者更喜欢从未保留的新项目：

```
ORDER BY ISNULL(priorEnd) DESC 
```

或者我们可以组合多个选项，以偏爱新项目，然后选择最接近预订窗口开始日期返回的项目，然后选择可用性最符合目标窗口的项目：

```
ORDER BY
    ISNULL(priorEnd) DESC,
    DATEDIFF(nextStart, priorEnd),
    DATEDIFF(nextStart, priorEnd) 
```

`LIMIT`关键字甚至可以用来选择最合适的。把这一切放在一起，

```
SELECT
    items.item AS item,
    priorReservation.endDate AS priorEnd,
    nextReservation.startDate AS nextStart
FROM
    items
    LEFT JOIN
        (
            SELECT item, MAX(endDate) AS endDate
            FROM reservations
            WHERE endDate < @newReservationStart
            GROUP BY item
        ) priorReservation ON priorReservation.item = items.item
    LEFT JOIN
        (
            SELECT item, MIN(startDate) AS startDate
            FROM reservations
            WHERE @newReservationEnd < startDate
            GROUP BY item
        ) nextReservation ON nextReservation.item = items.item
WHERE
    items.item NOT IN (
        SELECT
            DISTINCT item
        FROM reservations
        WHERE
            @newReservationStart BETWEEN startDate AND endDate
            OR startDate BETWEEN @newReservationStart and @newReservationEnd
    )
ORDER BY
    ISNULL(priorEnd) DESC,
    DATEDIFF(nextStart, priorEnd),
    DATEDIFF(nextStart, priorEnd)
LIMIT 1 
```

在合理的数据集上运行查询需要很长时间，令人失望。使用包含 155 个项目的样本数据集，每个项目大约有 30 个预订，大约需要 15 秒，这对于交互式应用程序来说太慢了。

MySQL 从“外向内”评估查询，使用最外层查询过滤传递给内部查询的行。因此，让我们将最外层的`WHERE`子句放在“测试工具”查询中，看看会`EXPLAIN`发现什么。

```
mysql>解释
    -> 选择
    -> items.item
    -> 从
    -> 项目
    -> 在哪里
    -> items.item 不在（
    -> 选择
    -> 不同的项目
    -> 从预订
    -> 在哪里
    -> @newReservationStart 在 startDate 和 endDate 之间
    -> OR startDate BETWEEN @newReservationStart 和 @newReservationEnd
    ->）
    ->;
+----+--------+--------------+------+- --------------+------+---------+------+------+---- --------------------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+--------+--------------+------+- --------------+------+---------+------+------+---- --------------------------+
| 1 | 初级 | 项目 | 全部 | 空 | 空 | 空 | 空 | 155 | 使用位置 |
| 2 | 依赖子查询 | 预订 | 全部 | 空 | 空 | 空 | 空 | 3871 | 使用哪里；使用临时 |
+----+--------+--------------+------+- --------------+------+---------+------+------+---- --------------------------+
2 行（0.00 秒）

```

那看起来不太好。MySQL 正在为 items 表中的每一行运行子选择（“从属子查询”）。每次运行内部查询时，它都会查看表中的每个条目`reservations`。（这令人失望，因为内部查询产生的一组不同的项目实际上并不依赖于`item`外部查询的值。但这就是 MySQL 的工作方式，最近来自 Oracle DBA 的评论给我的印象是这种行为并不孤单。）

根据可用项目的总数，内部查询可能会运行多次。在我对 155 个项目的测试中，其中大多数都有约 30 个现有预订，运行此查询大约需要 0.7 秒。

让我们尝试一个索引以避免`reservations`对每个可用项目进行全表扫描。直观地说，我们可以从索引日期列开始。我们不在乎最终得到哪个项目，但我们对查看正确的时间段非常感兴趣：

```
mysql> 创建索引 idx_startDate_endDate_item
    -> ON 预订（开始日期、结束日期、项目）；
查询正常，0 行受影响（0.03 秒）
记录：0 重复：0 警告：0

```

不幸的是，这不会像预期的那样有帮助。MySQL 很好地处理`startDate BETWEEN @newReservationStart and @newReservationEnd`，因为它知道`startDate`只能在一个狭窄的值范围内。但是`@newReservationStart BETWEEN startDate and endDate`，我们不是在搜索可以缩小到一个小范围的单个列。MySQL 必须找到之前开始的所有保留`@newReservationStart`，并决定其中哪些在之后结束`@newReservationStart`。

运行相同的 EXPLAIN 语句，我们得到：

```
+----+--------+--------------+-------+ ----------------------------------------+---------- --------+---------+------+------+------ -------------------------------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+--------+--------------+-------+ ----------------------------------------+---------- --------+---------+------+------+------ -------------------------------------+
| 1 | 初级 | 项目 | 全部 | 空 | 空 | 空 | 空 | 155 | 使用位置 |
| 2 | 依赖子查询 | 预订 | 范围 | idx_startDate_endDate_item | idx_startDate_endDate_item | 4 | 空 | 3572 | 使用哪里；使用索引；使用临时 |
+----+--------+--------------+-------+ ----------------------------------------+---------- --------+---------+------+------+------ -------------------------------------+

```

尽管有索引，但我们只查看了 3871 行到 3572 行。我们正在为`items.item`. 如果我们假设大多数预订都是过去的，我们可以通过索引（endDate、startDate、item）做得更好一些。这将从查看​​ endDate 在@newReservationStart 之后的项目开始，并且可能是一个较小的子集。但它仍然不理想。我们需要一个单独的索引`startDate`作为第一列，因为该`OR`子句的另一部分查找特定范围的开始日期。

所以现在怎么办？

我们知道 MySQL 将为`items.item`. 所以我们真的只需要寻找我们当前正在检查的项目的预订。这可能意味着将查询转换为 SQL 连接，但让我们再给优化器一个机会。

```
mysql> ALTER TABLE 保留 DROP INDEX idx_startDate_endDate_item;
查询正常，0 行受影响（0.01 秒）
记录：0 重复：0 警告：0

mysql> 创建索引 idx_item_startDate
    -> ON 预订（项目，开始日期）；
查询正常，0 行受影响（0.02 秒）
记录：0 重复：0 警告：0

```

再次运行 EXPLAIN 语句，我们得到

```
+----+--------+--------------+-------- --------+--------------------------------+-------- +---------+------+------+------------- ------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+--------+--------------+-------- --------+--------------------------------+-------- +---------+------+------+------------- ------------+
| 1 | 初级 | 项目 | 全部 | 空 | 空 | 空 | 空 | 155 | 使用位置 |
| 2 | 依赖子查询 | 预订 | 索引子查询 | idx_item_startDate | idx_item_startDate | 5 | 功能 | 38 | 使用哪里；对 NULL 键进行全扫描 |
+----+--------+--------------+-------- --------+--------------------------------+-------- +---------+------+------+------------- ------------+

```

一点也不差！只是为了好玩，我们不妨通过创建`items.item`为`NOT NULL`. 我们忽略了查询中使用的事实`endDate`，但它不在索引中。MySQL 将使用索引来完成大部分工作。没有理由让它查询完整表来检查 endDate，所以让我们也替换索引：

```
mysql> ALTER TABLE items MODIFY item INT NOT NULL;
查询正常，155 行受影响（0.00 秒）
记录：155 重复：0 警告：0

mysql> ALTER TABLE 保留 DROP INDEX idx_item_startDate;
查询正常，0 行受影响（0.00 秒）
记录：0 重复：0 警告：0

mysql> CREATE INDEX idx_item_startDate_endDate ON 保留(item, startDate, endDate);
查询正常，0 行受影响（0.02 秒）
记录：0 重复：0 警告：0

```

`EXPLAIN`现在给我们：

```
+----+--------+--------------+-------- --------+----------------+------------ ----------------+---------+------+------+--------- -----------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+--------+--------------+-------- --------+----------------+------------ ----------------+---------+------+------+--------- -----------------+
| 1 | 初级 | 项目 | 全部 | 空 | 空 | 空 | 空 | 155 | 使用位置 |
| 2 | 依赖子查询 | 预订 | 索引子查询 | idx_item_startDate_endDate | idx_item_startDate_endDate | 5 | 功能 | 38 | 使用索引；使用位置 |
+----+--------+--------------+-------- --------+----------------+------------ ----------------+---------+------+------+--------- -----------------+

```

MySQL 现在使用索引来获取它需要的所有信息`reservations`。查询运行时间为 0.14 秒，这对于交互式应用程序来说似乎是合理的。

如果您不想要单独的项目表，您可以执行以下操作。

```
SELECT
    reservationItems.item AS item,
    priorReservation.endDate AS priorEnd,
    nextReservation.startDate AS nextStart
FROM
    (SELECT DISTINCT item FROM reservations) AS reservationItems
    LEFT JOIN
        (
            SELECT item, MAX(endDate) AS endDate
            FROM reservations
            WHERE endDate < @newReservationStart
            GROUP BY item
        ) priorReservation ON priorReservation.item = reservationItems.item
    LEFT JOIN
        (
            SELECT item, MIN(startDate) AS startDate
            FROM reservations
            WHERE @newReservationEnd < startDate
            GROUP BY item
        ) nextReservation ON nextReservation.item = reservationItems.item
WHERE
    reservationItems.item NOT IN (
        SELECT
            DISTINCT item
        FROM reservations
        WHERE
            @newReservationStart BETWEEN startDate AND endDate
            OR startDate BETWEEN @newReservationStart and @newReservationEnd
    )
ORDER BY
    ISNULL(priorEnd) DESC,
    DATEDIFF(nextStart, priorEnd),
    DATEDIFF(nextStart, priorEnd)
LIMIT 1 
```

最后，使用[Strawberry](https://stackoverflow.com/users/1529673/strawberry)[对有关在 SQL 中匹配日期范围的问题](https://stackoverflow.com/questions/15521175/retrieve-all-records-that-occur-within-specific-date-range-in-mysql/15521635#15521635)的回答将运行时间大约减少了我最初方法的一半。有趣的是，`EXPLAIN`输出完全相同。但是，如下所示的最终查询现在在 0.07 秒内运行。

```
SELECT
    items.item AS item,
    priorReservation.endDate AS priorEnd,
    nextReservation.startDate AS nextStart
FROM
    items
    LEFT JOIN
        (
            SELECT item, MAX(endDate) AS endDate
            FROM reservations
            WHERE endDate < @newReservationStart
            GROUP BY item
        ) priorReservation ON priorReservation.item = items.item
    LEFT JOIN
        (
            SELECT item, MIN(startDate) AS startDate
            FROM reservations
            WHERE @newReservationEnd < startDate
            GROUP BY item
        ) nextReservation ON nextReservation.item = items.item
WHERE
    items.item NOT IN (
        SELECT
            DISTINCT item
        FROM reservations
        WHERE
            @newReservationStart <= endDate
            AND startDate <= @newReservationEnd
    )
ORDER BY
    ISNULL(priorEnd) DESC,
    DATEDIFF(nextStart, priorEnd),
    DATEDIFF(nextStart, priorEnd)
LIMIT 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T01:49:27.650

这在数据库之外很容易做到 - 选择您愿意考虑在其中进行预订的时间段内的所有预订，使用结果填充一天为 1（已填充）或 0（未填充）的数组) 并扫描阵列以查找所需大小的间隙。O(n) 但一年只有 365 天，所以不会很慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-14T04:37:48.890

正如其他人指出的那样，您可能*不需要这样做*太高效。也就是说，这是一种方法（取决于您的读写比率）：

一种方法是使用一张表格来跟踪未预订的时间段（在您感兴趣的任何时间范围内，例如从 2000 年到 2020 年）。最初，每个项目都有一段空闲时间。（我将以一种可读的方式列出这个；我将把模式留给你想象。）

```
FREE SLOTS
Item 1: January 1, 2000 - December 31, 2020
Item 2: January 1, 2000 - December 31, 2020

RESERVATIONS
(none) 
```

当有人进行预订时，您创建一个预订，并将空闲槽分成两个较小的空闲槽（除非这会使它变空）。在此操作期间注意数据存储的锁定！

```
FREE SLOTS
Item 1: January 1, 2000 - May 4, 2012
Item 1: May 8, 2012 - December 31, 2020
Item 2: January 1, 2000 - December 31, 2020

RESERVATIONS
Item 1: May 5, 2012 - May 7, 2012, Barack Obama 
```

删除预订后，您会立即检查前后的空闲时段。如果两者都存在，则将两个空闲槽和预留合并到一个空闲槽中。如果仅存在一个，则将其扩展以填充先前由预留占用的空间。

由于您可以轻松地在表格中保留空闲插槽的持续时间，因此您可以轻松找到所需持续时间的插槽（确切地说，大于某个数量，在一个范围内等）。您支付的成本是在修改数据存储时确保一致性所需的锁定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-17T22:53:32.647

如果您可以节省现金，[Joe Celko 的 Smarties SQL](https://rads.stackoverflow.com/amzn/click/com/0123820227)可能会满足您的需求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-18T12:40:08.067

如果查找效率是最重要的，那么您最好使用更像...的模式

```
CREATE TABLE items
(
    id          INT             NOT NULL    AUTO_INCREMENT,
    name        VARCHAR(255)    NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE reservations 
(
    item_id     INT     NOT NULL, 
    customer_id INT     NOT NULL, 
    reserved_on DATE    NOT NULL,
    PRIMARY KEY (item_id, reserved_on)
); 
```

...并为每个保留项目的日期添加单独的行。

这样，数据库将确保您不能在同一日期多次预订同一个项目，并且查找哪些项目 ID 是免费的，比如说，`2013-04-18`变成......

```
SELECT
    i.id
FROM items i
    LEFT JOIN reservations r ON (r.item_id=i.id AND r.reserved_on='2013-04-18')
WHERE item_id IS NULL; 
```

...`EXPLAIN`仅使用索引就可以满足一个节目...

```
+----+-------------+-------+--------+---------------+---------+---------+-----------------+------+--------------------------------------+
| id | select_type | table | type   | possible_keys | key     | key_len | ref             | rows | Extra                                |
+----+-------------+-------+--------+---------------+---------+---------+-----------------+------+--------------------------------------+
|  1 | SIMPLE      | i     | index  | NULL          | PRIMARY | 4       | NULL            |   10 | Using index                          |
|  1 | SIMPLE      | r     | eq_ref | PRIMARY       | PRIMARY | 7       | test.i.id,const |    1 | Using where; Using index; Not exists |
+----+-------------+-------+--------+---------------+---------+---------+-----------------+------+--------------------------------------+ 
```

这意味着在添加/修改保留时需要做更多的工作，但假设您将进行更多的读取而不是写入，这可能不是一个显着的开销。

# php - 将 Google Analytics 脚本添加到网站

> ID：15939401
> 
> 赞同：-3
> 
> 时间：2013-04-11T01:44:20.267
> 
> 标签：php, google-analytics

我得到了一个将谷歌分析添加到我的网站的脚本，但我网站中的所有页面都是 .php 页面。我尝试在 index.php 的末尾插入脚本，但到目前为止它似乎没有工作。有人知道我在做什么错吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:45:55.167

谷歌分析代码应该在`<head>`你的文档中，就在结束`</head>`标记之前。如果您使用 PHP 包含或某种模板系统，您需要找到包含该代码的文件并将其放置在其中。

请记住，结果需要 24 小时才能显示在您的分析报告中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:53:33.613

您应该`<footer></footer>`在每个页面上都有标签。把它放在它们之间。你可以这样做：

```
<footer>
OTHER STUFF IN YOUR FOOTER
OTHER STUFF IN YOUR FOOTER
OTHER STUFF IN YOUR FOOTER
OTHER STUFF IN YOUR FOOTER

<script type="text/javascript">

 Google analytics code here

</script>
</footer> 
```

# android - Android listview项目点击颜色变化

> ID：15939402
> 
> 赞同：0
> 
> 时间：2013-04-11T01:44:33.190
> 
> 标签：android, listview, colors, click

我在单击时突出显示列表项颜色时遇到问题。这是我正在使用的代码

Listview 布局如下。我的自定义列表视图类正在扩展 ListView。

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_alignParentBottom="true"
    android:orientation="vertical"
    android:focusableInTouchMode="true"
    android:focusable="true"
    android:background="@drawable/list_selector" // also tried this but it doesn't work
     >

    <TextView
        android:id="@+id/textView_list_info"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center_vertical|center_horizontal"
        >
    </TextView>

     <com.custom.listview.ViewEditListView
        android:id="@+id/customListView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"        
        android:listSelector="@drawable/list_selector" //this line doesn't work.
         />

</LinearLayout> 
```

list-selector.xml 如下

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
     android:state_selected="false"
        android:state_pressed="false"
        android:drawable="@drawable/list_divider" />

    <item android:state_pressed="true"
        android:drawable="@drawable/list_divider_hover" />

    <item android:state_selected="true"
     android:state_pressed="false"
        android:drawable="@drawable/list_divider_hover" />

</selector> 
```

custom_row.xml 如下

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    **android:background="@drawable/list_selector"**> //this also didn't work.

 <RelativeLayout
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     >

  <TextView
        android:id="@+id/v_row1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:textSize="14sp"
        android:textStyle="bold"
        android:textColor="#C11B17"
        android:layout_alignParentLeft="true"
        />
  ------ 
```

我不知道为什么单击列表项时它没有突出显示。

谢谢CP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T05:14:34.637

如果您使用自定义行来设置列表视图..将此选择器放入您的 row.xml 中，如 android:background="@drawable/this_selector_name"

this_selector_name.xml

```
<item android:state_selected="true"><shape>
        <gradient android:angle="270" android:centerColor="#4EA0F2" android:endColor="#224466" android:startColor="#BED5ED" />
    </shape></item>
<item android:state_pressed="true"><shape>
        <gradient android:angle="270" android:centerColor="#4EA0F2" android:endColor="#4EA0F2" android:startColor="#4EA0F2" />
    </shape></item>
<item><shape>
        <solid android:color="@color/yellow" />
    </shape></item> 
```

# sql - Firebird - 使用 SP 内的选择返回不等于 null 的字段计数

> ID：15939403
> 
> 赞同：0
> 
> 时间：2013-04-11T01:44:35.797
> 
> 标签：sql, stored-procedures, firebird

我需要编写一个 Firebird 存储过程来检查 4 个字段值并仅返回非空值的计数。

例如在伪代码中：

```
 X = 0; //is the count variable

  if field_1 is not null then X = 1;
  if field_2 is not null then X = X + 1;
  if field_3 is not null then X = X + 1;
  if field_4 is not null then X = X + 1; 
```

但是我想问一下是否可以在单个 Select 中做到这一点？

我正在使用火鸟 2.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:25:07.017

您可以使用该`IIF`函数执行此操作，如下所示：

```
select IIF(Field_1 is null, 0, 1)
     + IIF(Field_2 is null, 0, 1)
     + IIF(Field_3 is null, 0, 1)
     + IIF(Field_4 is null, 0, 1)
  from SomeTable; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T07:32:05.553

如果您想获得每行的总和，那么使用Welliam 建议的[IIF函数就可以了。](http://www.firebirdsql.org/file/documentation/reference_manuals/reference_material/html/langrefupd25-intfunc-iif.html)

但是，如果您只想获得所有行的总和，请使用`COUNT`具有显式字段名的聚合函数

```
select count(Field_1) + count(Field_2) + count(Field_3) + count(Field_4)
   from SomeTable; 
```

在这种情况下，它会计算指定字段不为 NULL 的行。

# c++ - 使用 CUDA 来有效地计算元素更改的排序数组的位置

> ID：15939411
> 
> 赞同：2
> 
> 时间：2013-04-11T01:45:44.663
> 
> 标签：c++, cuda, parallel-processing, gpu

假设我们有这个排序数组

```
 0 1 1 1 1 2 2 2 2 2 3 10 10 10 
```

我想有效地找到元素变化的位置。例如，在我们的数组中，位置如下：

```
 0 1 5 10 11 
```

我知道有一些库（推力）可以实现这一点，但是我想为教育目的创建自己的有效实现。

你可以在这里找到整个代码：http: [//pastebin.com/Wu34F4M2](http://pastebin.com/Wu34F4M2)

它也包括验证。

内核是以下函数：

```
__global__ void findPositions(int *device_data, 
         int totalAmountOfValuesPerThread, int* pos_ptr, int N){

   int res1 = 9999999;
   int res2 = 9999999;
   int index = totalAmountOfValuesPerThread*(threadIdx.x + 
                  blockIdx.x*blockDim.x);
   int start = index; //from this index each thread will begin searching
   if(start < N){ //if the index is out of bounds do nothing
      if(start!=0){ //if start is not in the beginning, check the previous value
        if(device_data[start-1] != device_data[start]){
        res1 = start;
        }
      }
      else res1 = start; //since it's the 
          //beginning we update the first output buffer for the thread
      pos_ptr[index] = res1;

      start++; //move to the next place and see if the 
      //second output buffer needs updating or not

      if(start < N && device_data[start] != device_data[start-1]){
         res2 = start;
      }

      if((index+1) < N)
        pos_ptr[index+ 1] = res2;
      }
} 
```

我创建了这么多线程，因此每个线程都必须处理数组的两个值。

1.  `device_data`将所有数字存储在数组中
2.  `totalAmountOfValuesPerThread`在这种情况下，是每个线程必须使用的值的总量
3.  `pos_ptr`具有相同的长度`device_data`，每个线程将缓冲区的结果写入此`device_vector`
4.  `N``device_data`是数组中数字的总数

在调用的输出缓冲区中`res1`，`res2`每个线程要么保存以前未找到的位置，要么保持原样。

例子：

```
 0   <---- thread 1
  1
  1   <---- thread 2
  1
  2   <---- thread 3
  2
  3   <---- thread 4 
```

每个线程的输出缓冲区，假设大数 9999999 是`inf`：

```
 thread1 => {res1=0, res2=1}
  thread2 => {res1=inf, res2=inf}
  thread3 => {res1=4, res2=inf}
  thread4 => {res1=6, res2=inf} 
```

每个线程都会更新 ，`pos_ptr` `device_vector`因此该向量将具有以下结果：

```
 pos_ptr =>{0, 1, inf, inf, 4, inf, 6, inf} 
```

完成内核后，我使用库对向量进行排序，`Thrust`并将结果保存在名为`host_pos`. 所以`host_pos`向量将具有以下内容：

```
 host_pos => {0, 1, 4, 6, inf, inf, inf, inf} 
```

这个实现很糟糕，因为

1.  内核内部创建了很多分支，因此会出现低效的换行处理
2.  我假设每个线程仅使用 2 个值，这是非常低效的，因为创建了太多线程
3.  我创建并传输一个`device_vector`与输入一样大并且驻留在全局内存中的 a。每个线程访问这个向量以便写入结果，这是非常低效的。

`1 000 000`这是每个块中有`512`线程时输入大小的测试用例。

```
 CPU time: 0.000875688 seconds
     GPU time: 1.35816 seconds 
```

另一个输入大小的测试用例`10 000 000`

```
 CPU time: 0.0979209
     GPU time: 1.41298 seconds 
```

请注意，CPU 版本几乎慢了 100 倍，而 GPU 几乎相同。

不幸的是我的GPU没有足够的内存，所以让我们尝试一下`50 000 000`

```
 CPU time: 0.459832 seconds
     GPU time: 1.59248 seconds 
```

据我了解，对于大量输入，我的 GPU 实现可能会变得更快，但是我相信更有效的方法可能会使实现更快，即使对于较小的输入也是如此。

为了让我的算法运行得更快，你会建议什么设计？不幸的是，我想不出更好的办法。

先感谢您

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T20:58:22.497

我真的不明白你认为这很可怕的任何原因。线程太多？线程过多的定义是什么？每个输入元素一个线程是 CUDA 程序中*非常常见*的线程策略。

由于您似乎愿意考虑在大部分工作中使用推力（例如，您愿意在完成标记数据后调用推力：：排序）并考虑到 BenC 的观察（您花费了大量尝试优化总运行时间的 3%）也许你可以通过更好地利用推力来产生更大的影响。

建议：

1.  使您的内核尽可能简单。只需让每个线程查看一个元素，然后根据与前一个元素的比较来决定制作一个标记。我不确定让每个线程处理 2 个元素会带来任何显着的收益。或者，有一个内核可以创建*更少*数量的块，但让它们循环遍历整个`device_data`数组，并在它们移动时标记边界。这可能会显着改善您的内核。但同样，优化 3% 不一定是您要花费大量精力的地方。
2.  您的内核将受到内存带宽的限制。因此，与其担心分支之类的事情，我会专注于内存的有效使用，即最小化对全局内存的读取和写入，并寻找机会确保您的读取和写入被合并。独立于程序的其余部分测试您的内核，并使用可视化分析器告诉您是否在内存操作方面做得很好。
3.  考虑使用共享内存。通过让每个线程将其各自的元素加载到共享内存中，您可以轻松合并所有全局读取（并确保您只读取每个全局元素一次，或几乎每个元素一次），然后在共享内存之外进行操作，即让每个线程将它的元素与共享内存中的前一个元素进行比较。
4.  创建`pos_ptr`数组后，请注意，除了`inf`值之外，*它已经排序*。所以也许有一个比“thrust::sort”更聪明的选择，然后修剪数组，以产生结果。看一下推力函数，如 `remove_if`和`copy_if`。我没有对它进行基准测试，但我的猜测是它们将比 sort 便宜得多，然后修剪数组（删除 inf 值）。

# javascript - 选中时复选框值不会从 false 更改为 true

> ID：15939415
> 
> 赞同：4
> 
> 时间：2013-04-11T01:46:08.663
> 
> 标签：javascript, forms, checkbox

这个 javascript 函数在表单中查找错误并列出它们。如果有错误，它会创建一个错误覆盖复选框，即使有错误也允许提交。目前，当复选框被选中时，代码无法识别。显然，第一个 if 语句总是被发现为真。想法？

```
function check1()
{  
    // c_ierrors is the id of the input tag inserted below within the c_erros div

    if( document.getElementById("c_ierrors")==null || document.getElementById("c_ierrors").checked!="true" )
    {   
    //if javascript generated form error overide checkbox does not exist or exists but is not true then list errors and don't submit the form    
    //code to generate divs listing errors
    //
        if(error=="")
        {
            //submit form
            return true;
        }  
        else
        {
            error += "<div id=\"c_erow\"><input type=\"checkbox\" id=\"c_ierrors\" name=\"override\" value=\"y\" >Override Errors</div>"  //add checkbox to submit form despite errors
            document.getElementById("c_errors").innerHTML=error;
            alert (document.forms["cform"]["override"].checked);     
            return false;  //stay on page don't submit form 
        }
    }
    else
    {  
        //if override checkbox (exists) and is true
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:58:29.237

问题出在您比较的第一个 if 语句的第二部分

```
document.getElementById("c_ierrors").checked!="true" 
```

将布尔值与字符串进行比较会给您错误的结果。你可以在你的 JavaScript 控制台中检查这个，

```
bool_val = true
bool_val == "true"   # returns false 
```

You either need to compare to `true` or just use it as a boolean value. E.g.

```
document.getElementById("c_ierrors").checked != true 
```

or

```
!document.getElementById("c_ierrors").checked 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T01:53:44.243

要查找是否已检查，您无需评估它是否为真，尤其是使用 String 值。

你只需要找到它是否是`.checked`

如果您想查找它是否不`.checked`只是使用：

```
!document.getElementById("c_ierrors").checked 
```

完整代码：

```
document.getElementById("c_ierrors")==null||document.getElementById("c_ierrors").checked 
```

那会很好用

[jsFiddle](http://jsfiddle.net/szf7H/)

# sql - 在 sql 中比较实时服务器和测试服务器的结果

> ID：15939418
> 
> 赞同：0
> 
> 时间：2013-04-11T01:46:20.590
> 
> 标签：sql, sql-server, tsql, sql-server-2000

这是我的情况。

我有 2 个数据库，分别是实时数据库和测试数据库，实时更新了数据，测试数据库的数据比实时晚一个月。

所以我在模拟已经在实时数据库中处理的工作流程，发现很多差异。

假设我运行这个查询

```
use liveDB select * from tblA 
```

结果将产生 100 个结果

然后

```
use testDB select * from tblA 
```

结果将产生 300 个结果

先生们有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:51:46.950

未正确添加测试数据库或已从实时数据库中删除项目。检查您的代码，其中数据从现场获取到测试。也许你有重复的条目。试试下面的，看看你得到了什么：

```
use liveDB select DISTINCT * from tblA
use testDB select DISTINCT * from tblA 
```

也许如果您根据日期时间 where 子句从实时中选择条目，则日期时间没有被正确解释。SQL 可能以美国格式而不是欧洲格式读取日期时间，反之亦然。如果您将日期时间指定为字符串，请尝试使用 yyyy-mm-dd 格式，这样月份和日期就不会意外切换

# java - 二叉树创建

> ID：15939422
> 
> 赞同：0
> 
> 时间：2013-04-11T01:46:43.257
> 
> 标签：java, binary-tree

我正在尝试从 0 和 1 的输入创建二叉树。例如，如果输入是 11010010，那么输出的树将以 1 作为根。2 是 1 的左孩子， 4 是右孩子。2 将有一个正确的孩子，它将是 3。那是树的尽头。当树按前序遍历时，数字 1-n（n 是输入中 1 的数量）被分配给被访问的节点。1 表示根有孩子。例如，第一个 1 表示访问了根，并将 1 放置为根。第二个 1 表示根有一个左孩子，而 2 则放在那里。后面的 0 表示它没有左孩子。下一个 1 表示它确实有一个正确的孩子，并且 3 被放置在那里，等等。我对如何创建这棵树感到困惑。我了解在创建树后遍历树，但不了解如何通过遍历树来创建树。任何帮助，将不胜感激。

```
package tree;

import java.io.*;

public class BinaryTree<ArrayList> implements Serializable
{   
private static final long serialVersionUID = 1L;

protected static class Node<ArrayList> implements Serializable
{
    private static final long serialVersionUID = 1L;

    protected int data;
    protected Node<ArrayList> left;
    protected Node<ArrayList> right;

    public Node(int data)
    {
        this.data = data;
        left = null;
        right = null;
    }

    public boolean isLeft() 
    {
        return (left == null);
    }
}

protected Node<ArrayList> root;;

public BinaryTree(int x)
{
    Node<ArrayList> node = new Node<ArrayList>(x);
    this.root = node;
}

public boolean isLeft()
{
    return(root.left == null);
}

public void addLeft(int m, BinaryTree.Node<ArrayList> node)
{
    root = new Node<ArrayList>(m);
    node.left = root;
}   

 public void preorder(Node<ArrayList> temp)  
 {  
      if (temp!=null)  
      {  
           System.out.println(temp.data);  
           preorder(temp.left);  
           preorder(temp.right);  
      }  
      else  
           return;  
 } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:02:04.270

听起来您正在以默认的广度优先方式构建树，根据字符串的内容为每个节点分配值。

如果有帮助，首先将字符串转换`ArrayList<int>`为要放入节点的值 - 例如，`11010010`将变为`{1, 2, 4, 7}`字符串中每个集合 1 的索引。

现在，我们必须构建树 - 但我们将始终以完全相同的方式构建树，称为广度优先，因为在深入之前先完全填充浅层。我们制作一个节点，然后告诉它“制作您的左节点，然后制作您的右节点，然后告诉您的左节点执行此操作，然后告诉您的右节点执行此操作”。（这与深度优先相反，在此处创建左节点，告诉左节点创建节点，然后创建右节点并告诉右节点创建节点）

所以你会有一个类似于这个伪代码的递归方法：

```
void continueTree(ArrayList<int> numbers)
{
    if (numbers.count() == 0) return;
    this.left = new Node(numbers.get(0));
    numbers.remove(0);
    if (numbers.count() == 0) return;
    this.right = new Node(numbers.get(0));
    numbers.remove(0);
    this.left.continueTree(numbers);
    this.right.continueTree(numbers);
} 
```

# html - Perl 在表单之间丢失/重置 CGI 参数

> ID：15939423
> 
> 赞同：1
> 
> 时间：2013-04-11T01:46:46.007
> 
> 标签：html, forms, perl, cgi

我有一个有趣的问题。

我编写了一个 Perl 脚本，它调用了一些显示 HTML 的子例程。子例程还包含表单标签。

我目前有三个输入`type="submit"`按钮，我已经将它们全部设置为`name="submitbtn"`. 我通过说来区分它们

```
if ($cgi->param('submitbtn') eq 'value') 
```

我调用我的第一个子程序，显示 HTML，用户输入信息并按下`Save`（提交按钮）。

调用另一个子例程并显示 HTML。我允许用户按下`Return`（一个调用子程序并转到另一个 HTML 页面`Continue`的提交按钮）或（一个调用另一个子程序以将所有内容提交到数据库的提交按钮）。

当我按下任一提交按钮时，我猜我的 CGI 参数是“重置”。我似乎无法弄清楚如何传递我的原始参数。

我说

```
my $cgi = CGI->new;
my %form = $cgi->Vars; 
```

我试过了

```
sub(%form); 
```

和这种性质的东西，但没有骰子。我对 Perl 很陌生。谢谢您的帮助。

# pandoc - 是否可以为 Pandoc 编写自定义转换器？

> ID：15939425
> 
> 赞同：9
> 
> 时间：2013-04-11T01:47:09.333
> 
> 标签：pandoc

是否可以为 Pandoc 编写自定义输出编写器？

例如，假设我想转换一个文档：

```
pandoc -f markdown -t myCustomMarkup asdf.md 
```

Pandoc 有办法指定转换规则`myCustomMarkup`吗？（例如，对于 Pandoc 识别的所有特征/属性，我可以指定具有 'bold' 属性的文本应映射到`<bold>text</bold>`，依此类推）。

谁能指出我如何实现自己的一些文档？我似乎找不到任何提及这一点。

（此外，有没有一种方法可以“插入”文件中定义的编写器而不必（例如）重新编译 pandoc？例如`pandoc -f markdown -t myCustomMarkup --writerpath=path/to/my/writer asdf.md`）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T04:11:05.790

使用当前的 pandoc 没有简单的方法可以做到这一点，但是下一个版本的 pandoc 将包含允许您使用一些简单的 lua 脚本编写自定义编写器的代码。（此代码已经在[http://github.com/jgm/pandoc](http://github.com/jgm/pandoc)`master`的分支中。）您将能够做到

```
pandoc -t myfunkyformat.lua myfile.md 
```

这是自定义编写器脚本的示例： [https ://github.com/jgm/pandoc/blob/master/data/sample.lua](https://github.com/jgm/pandoc/blob/master/data/sample.lua)

如果您从源代码编译，您现在可以使用代码： [https ://github.com/jgm/pandoc/wiki/Installing-the-development-version-of-pandoc](https://github.com/jgm/pandoc/wiki/Installing-the-development-version-of-pandoc)

# python - Python - 多线程/多处理

> ID：15939426
> 
> 赞同：4
> 
> 时间：2013-04-11T01:47:11.733
> 
> 标签：python, multithreading, multiprocessing, verilog

**背景**
我有一组用于构建和执行 Verilog-AMS 测试台的 Python 脚本。整体设计是在考虑线程的情况下构建的，因为每个主要测试用例都是它自己的测试平台，并且我为每个实例单独提供了所有支持文件/数据输出。唯一共享的项目将是启动器脚本和我的数据提取脚本。我面临的问题是我的 Verilog-AMS 模拟器本身不支持多线程，并且对于我的测试用例，它需要大量时间才能完成。

**问题**
我正在运行它的机器有 32GiB 的 RAM 和 8 个“内核”可供我使用，我可能能够访问具有 32 个的机器。我想利用可用的计算能力并执行模拟同时。最好的方法是什么？

我目前`subprocess.call`用来执行我的模拟。我想`n`一次执行多个命令，每个命令都在单独的线程上执行/作为单独的进程。一旦模拟完成，队列中的下一个（如果存在）将执行。

我对 Python 还很陌生，还没有真正编写过线程应用程序。我想要一些关于我应该如何进行的建议。我看到了[这个](https://stackoverflow.com/questions/1190206/threading-in-python)问题，因此我认为该`multiprocessing`模块可能更适合我的需求。

大家有什么推荐的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T05:53:21.717

我过去在机器学习和数据挖掘方面做过一些类似的任务。在您的情况下使用`multiprocessing`可能不是那么困难的任务。这取决于您热衷于制作程序的容忍度，您可以使用*线程池*模式。我个人最喜欢的是使用*生产者-消费者*模式`Queue`，这种设计可以处理各种复杂的任务。这是一个示例玩具程序，使用`multiprocessing`：

```
import multiprocessing
from multiprocessing import Queue, Process
from Queue import Empty as QueueEmpty

# Assuming this text is very very very very large
text="Here I am writing some nonsense\nBut people will read\n..."

def read(q):
   """Read the text and put in a queue"""
   for line in text.split("\n"):
       q.put(line)

def work(qi, qo):
   """Put the line into the queue out"""
   while True:
        try:
            data = qi.get(timeout = 1) # Timeout after 1 second
            qo.put(data)
        except QueueEmpty:
            return # Exit when all work is done
        except:
            raise # Raise all other errors

def join(q):
    """Join all the output queue and write to a text file"""
    f = open("file.txt", w)
    while True:
         try:
            f.write(q.get(timeout=1))
         except QueueEmpty:
            f.close()
            return
         except:
            raise

def main():
   # Input queue
   qi = Queue()
   # Output queue
   qo = Queue()
   # Start the producer
   Process(target = read, args = (qi, )).start()
   # Start 8 consumers
   for i in range(8):
        Process(target = work, args = (qi, qo, )).start()
   # Final process to handle the queue out
   Process(target = join, args = (qo, )).start() 
```

凭记忆输入，如有错误请指正。:)

# winforms - 使用 LINQ to SQL 的 DataGridView CRUD 操作

> ID：15939428
> 
> 赞同：1
> 
> 时间：2013-04-11T01:47:31.683
> 
> 标签：winforms, linq-to-sql, datagridview, bindingsource

我有一个带有 BindingSource 的 datagridview 到 Linq to SQL 作为数据源。当我尝试插入或删除数据时，gridview 不会刷新。

```
SampleDataContext context = new SampleDataContext();
    BindingSource bindingSource = new BindingSource();

    public Form1()
    {
        InitializeComponent();

        bindingSource.DataSource = context.Persons;
        PersonGridView.DataSource = bindingSource;
    }

    private void AddButton_Click(object sender, EventArgs e)
    {
        context.Persons.InsertOnSubmit(new Person { Name = , Address =  });
        context.SubmitChanges();
    }

    private void DeleteButton_Click(object sender, EventArgs e)
    {
        foreach (DataGridViewRow row in PersonGridView.SelectedRows)
        {
            var person = context.Persons.FirstOrDefault(x => x.ID == int.Parse(row.Cells[0].Value.ToString()));
            context.Persons.DeleteOnSubmit(person);
        }

        context.SubmitChanges();
    } 
```

我在这里错过了什么吗？

此致，

布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:02:01.483

Viola 在尝试了许多解决方案后我有一个更好的解决方案，只需将插入和删除操作更改为 bindingsource

```
SampleDataContext context = new SampleDataContext();
    BindingSource bindingSource = new BindingSource();

    public Form1()
    {
        InitializeComponent();

        bindingSource.DataSource = context.Persons;
        PersonGridView.DataSource = bindingSource;
    }

    private void AddButton_Click(object sender, EventArgs e)
    {
        bindingSource.Add(new Person { Name = "Hello", Address = "Hahahaha123" });
        context.SubmitChanges();
    }

    private void DeleteButton_Click(object sender, EventArgs e)
    {
        foreach (DataGridViewRow row in PersonGridView.SelectedRows)
        {
            var person = context.Persons.FirstOrDefault(x => x.ID == int.Parse(row.Cells[0].Value.ToString()));
            bindingSource.Remove(person);
        }

        context.SubmitChanges();
    } 
```

# java - 带有列表的 Java 递归 .add() 重复值

> ID：15939429
> 
> 赞同：0
> 
> 时间：2013-04-11T01:47:36.970
> 
> 标签：java, list, recursion

尝试在递归方法中添加`int[]`一段时间时遇到了一些麻烦。`List<int[]>`我正在获取所有`int[]`大小的排列`N`以用于不同的功能。我*想*将这些排列中的每一个都添加到前面提到的列表中。但是，似乎不能为所有排列添加 int[] (shortestPath)，老实说，我没有足够的递归经验来知道为什么每个数组的打印输出有效，但是添加到 List 只是添加第一个 arr （作为参数传递的那个） 6 次。

我的代码如下：

```
public int counter = 0;
public List<int[]> shortestPaths = new ArrayList<int[]>();

public void permute(int[] arr, int startIndex) {

    int size = arr.length;

    if (arr.length == (startIndex + 1)) {
        System.out.print("Permutation " + counter + " is: ");
        for (int i = 0; i < size; i++) {
            if (i == (size - 1)) System.out.print(arr[i] + "\n\n");
            else System.out.print(arr[i] + ", ");
        }
        shortestPaths.add(arr);
        counter++;
    } else {
        for (int i = startIndex; i < size; i++) {
            int[] copy = arr.clone();

            int tmp = copy[i];
            copy[i] = copy[startIndex];
            copy[startIndex] = tmp;

            permute(copy, startIndex + 1);

            //tmp = arr[i];
            //arr[i] = arr[startIndex];
            //arr[startIndex] = tmp;
            copy = null;
        }
    }
}

public static void main(String[] args) {

    int[] arr = { 1, 2, 3 };
    permute(arr, 0);

    System.out.print("\n\n\n\n");
    for (int[] a : s.shortestPaths) {
        System.out.println(a[0] + ", " + a[1] + ", " + a[2] + "\n\n");
} 
```

PS - 打印输出只是为了快速查看数据结构的状态。当实现完全正常运行时，它们当然会被删除:) 此外，此代码嵌套在一个类中，该类具有更多与矩阵处理相关的功能。该函数尤其是最短路径算法的辅助函数。

提前感谢那些比我更了解递归并且愿意提供帮助的人！

`Chris`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:52:41.277

`arr`每次调用时，您都在修改和添加对同一个数组的引用`add`。您应该创建一个新数组，交换然后将其添加到列表中。

**更新：**更详细一点..

您在 main 中创建一个新数组`arr`，然后将引用（按值）传递给`permute`函数。在 else 部分，您交换数组引用中的两个整数`arr`（您不是创建一个新数组，只是修改同一个数组）并将`add`其交换到列表中。下一次迭代，同样的事情发生在相同的数组引用`arr`上，再次将相同的数组添加到列表中。

这是你应该做的。

```
else {
  int[] tempArr = new int[arr.length]; 
  System.arraycopy(arr, 0, tempArr, 0, arr.length);

  // swap in the tempArr
  // add tempArr to the list
  // after that if you want you can set tempArr to null, to avoid loitering.
} 
```

可能有更好的方法，但我也不是专家。

**更新 2：** 现场示例.. [http://ideone.com/vHcz7b](http://ideone.com/vHcz7b)

[PS：有人可以帮我格式化吗？]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T01:53:01.050

[这里](http://introcs.cs.princeton.edu/java/23recursion/Permutations.java.html)有几个排列代码的例子，希望能帮助你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T01:54:47.253

请记住，数组是一个对象。这意味着参数`arr`是对对象的引用。每个递归调用都将引用同一个数组，因此任何更改都将反映在您使用该数组引用的任何地方。这也意味着每次调用时，`shortestPaths.add(arr);`您都会一遍又一遍地添加对完全相同的数组的引用。因此，您的列表将包含对同一数组对象的许多引用。

话虽如此，为了做你想做的事，你需要在每次想要进行更改时复制数组并将其添加到你的`List`.

# cakephp - 如何在 xampp 上运行 cakephp 应用程序

> ID：15939433
> 
> 赞同：1
> 
> 时间：2013-04-11T01:48:15.283
> 
> 标签：cakephp

我是 CakePHP 的新手，我已经在 Xampp 上配置了 cakephp，它运行良好。

我的文件夹结构是：

为了让它运行 cakephp，我更新了位于 apache conf 文件夹中的 Http.conf 中的文档根目录（c:/xampp/hdocs/cakephp/app/webroot）

然后我开始研究 apache cakephp 框架。浏览器显示主页

**我尝试运行 Simple cakephp 示例应用程序**

```
 c:/xampp/hdocs/polls/app/webroot 
```

以同样的方式，我在 xampp 上配置了 cakephp 示例应用程序，并且我还更新了 http.conf 。但它不起作用，当我运行服务器时只是在浏览器中显示空白页面。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:34:57.633

如果您在浏览器中使用上面提供的路径，那么您只是在浏览器中查看该目录位置。

您需要通过输入本地主机 url 或您可能设置的任何别名来通过本地 apache 网络服务器。

```
http://localhost/<cakePHP app name>/<controller>/<action>/ 
```

如果你想去根 cakephp 应用程序，那么它会是

```
http://localhost/<cakephp app name>/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-10T23:43:52.543

希望有人觉得它有用...

> cakephp_3_xx
> 
> xampp v 3.2.1

第 1 部分（使用包含 cakePHP 的服务器测试 cakePHP 是否正常工作）

按照 cakePHP 导师创建数据库

在 bake.bat -- 添加 php 路径：

```
J:\xampp\php\php "%lib%cake.php" %* 
```

DOS提示符：

```
 J:\xampp\htdocs\cakephp-3-1-6>.\bin\cake bake all users
  J:\xampp\htdocs\cakephp-3-1-6>.\bin\cake bake all bookmarks
  J:\xampp\htdocs\cakephp-3-1-6>.\bin\cake bake all tags 
```

cmd> cd J:\xampp\htdocs\cakephp-3-1-6

```
 J:\xampp\htdocs\cakephp-3-1-6>set PATH=%PATH%;J:\xampp\php\;
  J:\xampp\htdocs\cakephp-3-1-6>bin\cake server 
```

看看它[http://localhost:8765/](http://localhost:8765/)

第 2 部分（例如，如果我们有 8787 端口可供虚拟主机使用）

重复（对于 J:\xampp\apps\bookmarker）

在 bake.bat -- 添加 php 路径：

```
 J:\xampp\php\php "%lib%cake.php" %* 
```

DOS提示符：

```
 J:\xampp\apps\bookmarker>.\bin\cake bake all users
  J:\xampp\apps\bookmarker>.\bin\cake bake all bookmarks
  J:\xampp\apps\bookmarker>.\bin\cake bake all tags

  J:\xampp\htdocs\applications.html (create your own application section...:
          <!-- START cakephp-3-0-0 bookmarker -->
          <div align="center" class="module_table">
  )
  ...
  <div align="right" class="module_access"><a target="_blank" name="bookmarker" href="http://localhost:8787/bookmarks">Access</a></div>
  ... 
```

1) 主 httpd.conf。

```
 Listen 8787

  <VirtualHost *:8787>
  DocumentRoot "J:\xampp\apps\bookmarker"
  # ServerName www.example.com
     <Directory />
         Options FollowSymLinks
         AllowOverride All
     </Directory>
     <Directory "J:\xampp\apps\bookmarker" >
         Options Indexes FollowSymLinks MultiViews
         AllowOverride All
         Order Allow,Deny
         Allow from all
     </Directory>

  # Other directives here
  </VirtualHost> 
```

不要包含 apache 的应用程序特定配置：

```
 # Include "J:/xampp/apps/bookmarker/conf/httpd-prefix.conf" 
```

2）关键：css工作：在webroot/.htaccess

```
 #<IfModule mod_rewrite.c>
  #    RewriteEngine On
  #    ## RewriteBase J:\xampp\apps\bookmarker\src\
  #    RewriteCond %{REQUEST_FILENAME} !-f
  #    RewriteRule ^ index.php [L]
  #</IfModule>

  <IfModule mod_rewrite.c>
      RewriteEngine On
      RewriteBase /
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteCond %{REQUEST_FILENAME} !-f
   RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
  </IfModule> 
```

其余的由 cakePHP bake 安装，可以通过 xampp 应用程序界面或直接尝试：

```
 http://localhost:8787/bookmarks 
```

# jquery - 自动完成 php mysql 中的 jQuery ajax

> ID：15939434
> 
> 赞同：1
> 
> 时间：2013-04-11T01:48:17.600
> 
> 标签：jquery

我正在尝试让 jQuery Ajax 函数在自动完成函数中工作。自动完成之所以有效，是因为它返回值，但是当我选择一个值时，它什么也不做。我想返回 html 并在 div 中显示。

jQuery：

```
$(function() {
    $("#store").autocomplete({
        source: "includes/ajax/storenumbers.php",
        select: function(event, ui) {
            var storeid = val(ui.item.id);
            $.ajax({
               url: "includes/ajax/storecontacts.php",
               type: "GET",
               data: {term : storeid},
               dataType: "html",                               
               success: function(msg){
                            //Display html
                                $("#resultsdiv").html(msg);
                           },
                           error: function (request, status, error) {
                                alert(request.responseText);
                            }
                         });
                    }
                });
            }); 
```

html:

```
<form action="<?php echo $PHP_SELF;?>"  method="post">

<label for="store">Enter Store #: </label>

<input type="text" id="store"  name="state" /> 

<div id="resultsdiv" style="width: 200px; height: 200px;">
</div>
</form> 
```

storenumbers.php 返回“1”：

```
[{"id":"6","value":"10211","abbrev":"Concord"},{"id":"4","value":"10869","abbrev":"Maplewood"},{"id":"5","value":"16289","abbrev":"Hugo"},{"id":"12","value":"19245","abbrev":"WBL 4th Street"}] 
```

storecontacts.php 返回：

```
Name: Alex E-mail: alex@email.com View Order: yes Print Order: yes<br>
Name: Brooke E-mail: brooke@email.com View Order: no Print Order: no 
```

我希望 html 返回最终是一系列输入文本字段和复选框。**dataType: html**是否仅限于某些事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:14:08.167

我想到了。我不得不将 var storeid = val(ui.item.id) 更改为 var storeid = ui.item.id;

# pthreads - 试图让 N 个 CPU 运行线程

> ID：15939435
> 
> 赞同：2
> 
> 时间：2013-04-11T01:48:26.573
> 
> 标签：pthreads, cpu

我想在我的 6 核计算机中运行（比如说）25 个 CPU 密集型任务，每次使用 5 个核（所以留 1 个用于其他任务）。25 个 CPU 密集型任务中的每一个都可以在不同的时间完成，例如，一个任务可以在 20 分钟内完成，而另一个任务可能需要长达 4 小时。

使用 pthreads 我设法构建了一个非常简单的算法，它可以启动 5 个线程，等待其完成并再次启动另外 5 个线程。该算法的弱点是*它不能利用不同线程可能在不同时间完成的事实*，而是总是等待所有 5 个线程的作业完成，然后再启动另一组。

这是启动线程的代码摘录

```
#define MAX_REACTOR_THREADS 5

/* ....................... */
/* SOME LENGTHY STUFF HERE */
/* ....................... */

int cases = 25;
pthread_t *threads_REACTOR = calloc(cases, sizeof(pthread_t));

int index = 0;

/* CALL THREADS PROCEDURE FOR COMPUTING FUNCTION: REACTOR_THREAD */ 

int int_div = cases/MAX_REACTOR_THREADS;
int I, k;

for (I=0; I<int_div; I++){
/* LAUNCH THREADS */
for(k=0; k<MAX_REACTOR_THREADS; k++){

index = int_div*k+I;     
pthread_create(&threads_REACTOR[index], NULL, 
    &REACTOR_THREAD, (void*) &inputs_array[index]);
}
/* JOIN THREADS */
for(k=0; k<MAX_REACTOR_THREADS; k++){
  index = int_div*k+I;
  pthread_join(threads_REACTOR[index], NULL);
 }
/* HERE PRINT PROGRESS BAR */
Progress_Bar((I+1)*MAX_REACTOR_THREADS, cases, 40, COLOR_Y);
}

if((cases%MAX_REACTOR_THREADS) != 0){
/* LAUNCH REMAINING THREADS */
for(index=MAX_REACTOR_THREADS*int_div; index<cases; index++){
  pthread_create(&threads_REACTOR[index], NULL, 
         &REACTOR_THREAD, (void*) &inputs_array[index]);
}

/* JOIN REMAINING THREADS */
for(index=MAX_REACTOR_THREADS*int_div; index<cases; index++){
  pthread_join(threads_REACTOR[index], NULL);
  /* HERE PRINT PROGRESS BAR */
  Progress_Bar(index+1, cases, 40, COLOR_Y);
}
}  

/* ....................... */
/* SOME LENGTHY STUFF HERE */
/* ....................... */ 
```

如何改进这一点，以便它可以在线程完成其工作的那一刻启动新任务？

# php - 将 MySQL 数组拆分为单独的 php 变量

> ID：15939445
> 
> 赞同：0
> 
> 时间：2013-04-11T01:51:27.230
> 
> 标签：php, arrays, split

我对 PHP 很陌生，所以如果我问错了问题或问了一些非常简单的问题，请原谅。

我有一个 MySQL 表，其中包含有关玩家基本统计数据的静态数据。我需要在播放器的概览屏幕中单独显示这些统计信息，但是在查询返回结果后我无法分离数据。

这是我当前的代码：

```
$basestatsquery = mysql_query("
    SELECT Army, Defense, Resource, Food, Trade_Goods, Technology
    FROM Player_Stats_Base
 ") or die(mysql_error());
$basestats = mysql_fetch_row($basestatsquery); 
```

我已经能够通过在我的页面中使用以下内容来验证它是否正确地提取数据：

```
<p><?php  print_r($basestats) ?></p> 
```

它将结果作为数组输出并显示如下：

```
Array ( [0] => 5 [1] => 5 [2] => 250 [3] => 60 [4] => 0 [5] => 0 ) 
```

但从这一点来看，我不知道该去哪里。我需要将这 6 个值中的每一个都分离到它们自己的变量中，以便我可以将它们显示在适当的位置，并最终将它们乘以旨在增加基本统计数据的修饰符。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:54:03.753

使用`mysql_fetch_assoc()`更直观^*

```
$basestats = mysql_fetch_assoc($basestatsquery);

echo $basestats['Army'];
echo $basestats['Defense'];
echo $basestats['Resource'];
echo $basestats['Food'];
echo $basestats['Trade_Goods'];
echo $basestats['Technology']; 
```

^* [请不要`mysql_*`在新代码中使用函数](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[红框](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

# parameters - 为什么要使用参数？

> ID：15939450
> 
> 赞同：0
> 
> 时间：2013-04-11T01:51:57.920
> 
> 标签：parameters, ado.net

我看到很多关于如何在 ADO.net 中使用参数以及让我开始使用 c# [http://csharp-station.com/Tutorial/AdoDotNet/Lesson06](http://csharp-station.com/Tutorial/AdoDotNet/Lesson06)的伟大网站，说..

```
 // don't ever do this
        // SqlCommand cmd = new SqlCommand(
        // "select * from Customers where city = '" + inputCity + "'"); 
```

但我似乎无法回答为什么你不应该这样做。毫无疑问，这是有充分理由的，但我似乎找不到。有人可以填写我，以便我将来可以向新来的人回答这个问题（我喜欢帮助工作中的人学习代码）。对于一个学习 c# 的新手来说，我想大多数人会看到它的代码行数更少，这似乎是一种胜利。仅仅是因为将字符串添加在一起比使用参数更费力吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:32:38.047

仔细考虑如果有人在您的应用程序的城市文本框中输入以下内容会发生什么：

> ';从客户中删除;--

你最终会构造一个如下所示的 sql 字符串：

```
select * from Customers where city = '';DELETE FROM Customers;--' 
```

碰巧有两条语句和一条注释，您的 sql 提供程序非常乐意执行*它们*。现在，数据库连接也可能以用户身份运行，没有从该表中删除所需的权限......但它可能具有其他权限，例如从其他表中读取数据以获取社会安全号码或信用卡等信息，或者也许插入具有管理权限的新帐户记录。熟练的攻击可以用它来做几乎任何事情。

编写一个简单的转义或清理函数可能很诱人。不要这样做。首先，它并没有完全解决问题。查询参数将用户数据与 sql 代码完全隔离，因此即使是数据库也始终将用户输入视为变量值，而从不将其直接放入查询字符串中。使用逃生功能会让您与饼干进行军备竞赛。

另一个原因是性能。数据库在将查询转化为如何检索数据的执行计划方面遇到了很多麻烦。如此之多，以至于他们经常以查询文本的散列作为键来缓存计划。如果您不使用参数化查询，那么每次都会导致缓存未命中。

最后，我发现参数化查询更容易使用。对于复杂的查询，我可能会在查询上方添加注释，如下所示：

```
/*DECLARE @someVariable varchar(12);
  DECLARE @OtherVariable varchar(50);
  DECLARE @thirdVariable int;
  ...*/
var sql = 
"SELECT <columns>
 FROM table t"
 INNER JOIN othertable o ON t.ID = o.tableID"
 WHERE someColumn = @someVariable AND ...";

using (var cn = new SqlConnection(" ... "))
using (var cmd = new SqlCommand(sql, cn))
{
    cmd.Parameters.Add()
    //... 
```

这样做的目的是在需要维护此查询时，我可以快速将查询及其变量声明复制/粘贴到 Management Studio 或其他查询工具中，完成后我可以快速将整个混乱移回客户端代码。对于一个班轮来说，这没什么大不了的，真正巨大/复杂的查询通常最终会成为存储过程或视图，但是有一个*真正*有用的甜蜜点..结果更多的事情最终出现在那个甜蜜点比你想象的要好。

# memcached - Memcached `stats` 命令

> ID：15939454
> 
> 赞同：0
> 
> 时间：2013-04-11T01:52:51.850
> 
> 标签：memcached

我最初`memcached`是一个拥有 512MB 内存的守护进程。

`memcached -d -m 512`

然后，我远程登录到盒子，然后运行`stats`命令。

为什么`limit_maxbytes`字段相等`536870912`？我会预料到`512,000,000`的。

```
STAT limit_maxbytes 536870912 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T16:22:55.127

这是因为 -m 512 表示 512MB，即 512*1024*1024。

# php - 同一php类中的静态和动态方法

> ID：15939459
> 
> 赞同：1
> 
> 时间：2013-04-11T01:53:37.277
> 
> 标签：php

假设我有这样的课程：

```
class ClassA{

    var $var = 'a1';
    static $static_var = 'a2';

    function get(){
        return $this->var;
    }

    static function get_static(){
        return self::$static_var;
    }

} 
```

当我调用它时，内存中会发生什么：

```
$class = new ClassA();
echo $class->get(); 
```

当我称之为：

```
echo ClassA::get_static(); 
```

当我创建 ClassA 的实例时，该类的静态成员会发生什么？它会占用更多内存吗？它会忽略静态成员吗​​？

我想在其中保留一堆静态函数，`ClassA`但我也想创建 ClassA 的实例。我应该将静态成员与动态成员分开吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T01:56:38.383

> 我想在 ClassA 中保留一堆静态函数，但我也想创建 ClassA 的实例。我应该将静态成员与动态成员分开吗？

*答：静态类成员每个类*消耗一次内存。常规类成员*每个实例消耗一次内存*

# jquery - 使用 Jquery UI 标签加载 DFP 广告

> ID：15939462
> 
> 赞同：1
> 
> 时间：2013-04-11T01:53:47.760
> 
> 标签：jquery, ajax, ruby-on-rails-3.2, google-dfp

我真的很想要一个将广告从 DFP 呈现到 ajax jquery UI 选项卡中的解决方案。

我到处研究过，谷歌没有提供任何支持或文档。我有一个我一直在试验的示例 js 类。到目前为止，我一生都无法在标签加载时获得要呈现的广告。

我已经使用这个 gem [https://github.com/digineo/google_dfp](https://github.com/digineo/google_dfp)加载了所有必要的依赖项。但我真的希望能够从 ajax 加载的内容中动态加载广告吗？

```
class @ScorecardViewController

  constructor: (@element) ->
    $(document).bind "tabsload", =>
      @tabLoaded()

  getGraphData: ->

  tabLoaded: ->
    @panel = $(CricTabsController.getLoadedPanel(@element))

    @loadAdverts()

    graphs = @panel.find(".match-graph").map (index, value) ->
      $(value).attr("id")
    @getGraphData() if graphs.length

  loadAdverts: ->
    tags = @panel.find("div.google-dfp")

    googletag.cmd.push( ->
      tags.each ->
        $this = $(@)
        googleAdSlot = googletag.defineSlot( $this.data('unit'), [$this.width(), $this.height()], $this.attr("id")).addService(googletag.pubads())
        googletag.pubads().enableAsyncRendering()
        googletag.enableServices()
        googletag.display($this.attr("id"))
        googletag.callback()
    )

$ ->
  $el = $('#sections-matches-scorecard')
  if $el.length
    new ScorecardViewController($el) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T16:55:29.547

查看我创建的插件：[https ://github.com/coop182/jquery.dfp.js](https://github.com/coop182/jquery.dfp.js)

它允许您使用 jQuery 控制 DFP……它允许您选择何时加载 DFP，这将帮助您使用动态创建的元素。

如果您有任何问题，请在此处或在 github 上告诉我。

编辑：抱歉刚刚意识到我已经回答了你的其他问题之一，让你知道我的插件......我猜可能不是你想要的......但我有一个你想要做的例子。 ..它可能会帮助你找出你的代码哪里出错了。

```
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>jQuery UI Tabs - Content via Ajax</title>
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
  <script src="https://raw.github.com/coop182/jquery.dfp.js/master/jquery.dfp.js"></script>
  <script>
  $(function() {
    $( "#tabs" ).tabs({
      load: function( event, ui ) {
        $('.adunit:not(".display-block")').dfp({
          dfpID: '15572793',
          enableSingleRequest: false
        });
      }
    });
  });
  </script>
</head>
<body>
<div id="tabs">
  <ul>
    <li><a href="#tabs-1">Preloaded</a></li>
    <li><a href="1.html">Tab 1</a></li>
    <li><a href="2.html">Tab 2</a></li>
    <li><a href="3.html">Tab 3</a></li>
    <li><a href="4.html">Tab 4</a></li>
  </ul>
  <div id="tabs-1">
    <p>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin. Sed ut dolor nec orci tincidunt interdum. Phasellus ipsum. Nunc tristique tempus lectus.</p>
  </div>
</div>
</body>
</html> 
```

1.html

```
Tab 1 <div class="adunit" data-adunit="Leader" data-dimensions="728x90"></div> 
```

2.html

```
Tab 2 <div class="adunit" data-adunit="Button" data-dimensions="160x180"></div> 
```

3.html

```
Tab 3 <div class="adunit" data-adunit="Skyscraper" data-dimensions="160x600"></div> 
```

4.html

```
Tab 4 <div class="adunit" data-adunit="Footer" data-dimensions="468x60"></div> 
```

# c - 即时更改 MPI 拓扑

> ID：15939464
> 
> 赞同：0
> 
> 时间：2013-04-11T01:53:54.640
> 
> 标签：c, parallel-processing, mpi, topology, decomposition

我目前正在使用一个用 C 语言编写的带有 MPI 并行化的程序。计算网格使用常见的域分解技术进行划分。关于 2D 分解（简化）的流程布局如下：

```
/////////////////////////////
/       /         /         /
/   1   /    2    /    3    /
/       /         /         /
/////////////////////////////
/       /         /         /
/   4   /    5    /    6    /
/       /         /         /
/////////////////////////////
/       /         /         /
/   7   /    8    /    9    /
/       /         /         /
///////////////////////////// 
```

在代码中的某一时刻，我必须求解一系列仅具有 X 相关性的方程。使用当前形式的拓扑，由于 x 依赖性，它一次只能与 3 个进程并行化，这导致了我的问题......是否有一种方便/有效的方式将当前拓扑映射到另一个在代码中，哪个有利于完全并行化，即使用所有 9 个进程？例如，像这样：

```
/////////////////////////////
/            1              /
/////////////////////////////
/            2              /
/////////////////////////////
/            3              /
/////////////////////////////
/            4              /
/////////////////////////////
/            5              /
/////////////////////////////
/            6              /
/////////////////////////////
/            7              /
/////////////////////////////
/            8              /
/////////////////////////////
/            9              /
///////////////////////////// 
```

有人可能会问，为什么不从这个开始……好吧，2D 域分解对于整个问题来说效率更高，而且我之后还有 y 依赖关系，我需要对拓扑做类似的事情，因此上图是转置。

因此，我需要使用一些通信例程将 2D 拓扑映射到代码中的 1D 拓扑（动态），以实现与 9 个进程的完全并行化，但我不确定是否有一种高效且有效的方法来做到这一点VS 并行运行 3 个进程的原始问题。任何的意见都将会有帮助。谢谢！！

# javascript - 这是一个匿名函数吗？

> ID：15939467
> 
> 赞同：1
> 
> 时间：2013-04-11T01:54:20.033
> 
> 标签：javascript

在下面的第一个片段中，根据我的理解，我正在创建一个函数并将其分配给一个变量。但这是否意味着该函数将采用该变量的名称？

```
var aFunc = function(){}; 
```

我知道这是命名函数。

```
function bFunc(){}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T01:57:00.540

不。

在第一个示例中，您正在创建一个匿名函数，然后将其分配给“aFunc”

在第二个示例中，您声明了一个函数并将其称为 bFunc。

两者之间最显着的区别是您不能在分配它的行之后调用“aFunc”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T01:57:25.833

不，该函数不会“取变量名”。该变量将保存对匿名函数的引用。该函数本身仍然是匿名的。

请注意，这最终几乎没有什么区别，这个函数引用一旦被分配，就可以被视为与任何常规命名函数完全相同。事实上，它几乎没有什么区别，一个命名函数也可以被视为一个持有函数引用的变量：

```
function foo() { }
foo();
foo = 'bar';
alert(foo); // bar 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-11T02:29:34.033

“匿名函数”这个术语是行话，所以它的含义很可能会随着时间而改变。没有说明它是什么的规范，所以它可以是你想要的任何东西。无论您做出什么决定，都可能会受到其他人的争议。行话就是这样（查找“中继”一词，这是电话中的一个常见术语）。

严格来说，有些函数声明的名称是强制性的，例如

```
function foo() {
    ...
} 
```

和函数表达式，其中名称是可选的。如果缺少名称，例如：

```
var x = function () {
             ...
        }; 
```

那么，对我来说，这是一个匿名函数。如果它有名字，例如

```
var x = function foo() {
             ...
        }; 
```

那么它是一个命名函数表达式（而不是匿名函数）。从我的角度来看，任何没有可选名称的函数表达式都是匿名函数。函数表达式有很多用途，例如

```
// assignment to a variable
var x = function() {...}

// pass as a parameter
foo(function(){...})

// immediately executed and pass the result
foo( (function(){...}()) ) 
```

等等。所以在 OP 中，赋值的右侧是一个没有名字的函数表达式，所以对我来说，这是一个匿名函数。然后将其分配给标识符这一事实并不会突然使其成为命名函数表达式。

当然，其他人可能会有所不同。

顺便说一下，结果：

```
function foo(){} 
```

和

```
var foo = function(){}; 
```

实际上无法区分，主要区别在于创建函数的时间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-11T02:29:54.340

因此，首先我们必须澄清您编写的两个函数之间的主要区别。

这个：

```
var aFunc = function(){}; 
```

是一个*函数表达式*。这个在哪里：

```
function bFunc(){}; 
```

是一个*函数声明*。

在*函数表达式*中，您使用[函数运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/function)在表达式中定义函数。当你*声明一个函数*时，你正在使用[函数语句](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/function)。

一开始可能会令人困惑，因为它们非常相似，但是函数声明和函数表达式的行为不同。首先，您不能声明匿名函数：如果您使用函数语句，则名称是必需的。所以只有用函数运算符定义的函数可以是匿名的：

```
var aFunc = function(){}; 
```

那是一个匿名函数。在某些浏览器中，您实际上可以打印[函数的名称](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/name)并自己查看：

```
console.log(aFunc.name); 
```

（请注意，这还不是标准，但有一个[提案](http://wiki.ecmascript.org/doku.php?id=strawman%3aname_property_of_functions)）

但这并不意味着用函数运算符声明的函数必须是匿名的。例如：

```
var aFunc = function myFunction() {}; 
```

这是一个命名函数。但是，这仍然与具有这样的函数声明不同：

```
function myFunction() {};
var aFunc = myFunction; 
```

为什么？因为在函数表达式的情况下，您不会`myFunction`在范围内声明函数：

```
var aFunc = function myFunction() {};

console.log(typeof myFunction) // undefined, unless some bugs 
```

那么给函数表达式命名有什么意义呢？答案是：从函数体本身访问该函数，而不会污染范围。例如，您想将事件侦听器添加到 DOM 节点，但只执行一次侦听器：

```
document.body.addEventListener("click", function onclick() {
    // do something
    document.body.removeEventListener("click", onclick, false);
}, false); 
```

因此，您不会使用许多仅用于类似目的的函数来污染范围，并且您仍然可以从函数的主体访问该函数。`arguments.callee`这在不推荐使用的 ES5 和递归中特别有用。

函数表达式之间的另一个区别是您可以立即调用它们，但不能对函数声明执行此操作。因此，例如：

```
function() {
    console.log('foo');
}(); 
```

会抛出异常，因为引擎无法理解是函数声明还是函数表达式。但是如果你强制引擎把它看成一个表达式：

```
!function() {
    console.log('foo');
}();

// or
(function(){
    console.log('foo');
}());

// etc, there are a lot of ways 
```

我们在这里：JS 理解是一个表达式，因此威胁`function`作为一个运算符而不是一个语句。并且您获得了 IIFE（立即调用函数表达式），它在很多场景中都很有用，特别是在您想要隔离代码的地方。

所以，回到你的问题，为什么这个函数的名字：

```
var aFunc = function(){}; 
```

不是`aFunc`吗？

因为，这是一种表达。所以这个值对左边的赋值一无所知。这就像拥有：

```
var aFunc = -3; 
```

[一元取反操作](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#-_.28Unary_Negation.29)和值`-`在哪里：他们对 什么一无所知，对吧？*与函数表达式*完全相同，运算符在哪里，值是哪里。`3``aFunc`*`function``(){}`*

 ** * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-11T01:57:08.410

不它不是。第一条语句的右侧是*Function Expression*。只要您不将其分配给变量，它就是匿名的。

分配后，您可以将其用作声明的函数。

[在此问题中](https://stackoverflow.com/questions/1140089/how-does-an-anonymous-function-in-javascript-work?rq=1)查看有关函数声明的更多详细信息*

# ios - 为 iOS 错误构建独立的 livecode：保存 armv7 的独立应用程序链接时出错，ID 失败：

> ID：15939469
> 
> 赞同：2
> 
> 时间：2013-04-11T01:54:37.930
> 
> 标签：ios, livecode

我刚刚下载并安装了 Livecode Community 6.0 并尝试创建一个独立的应用程序。 ![在此处输入图像描述](https://i.stack.imgur.com/e4saX.png)

![在此处输入图像描述](https://i.stack.imgur.com/bEghp.png)

BTW Livecode 5.5.4 工作正常。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T14:50:58.560

我对错误的阅读表明您正在尝试为模拟器（i386）构建一个独立的，但试图为设备（armv7）链接它。

是不是你设置错了？

我自己还没有尝试过 LiveCode Community 6.0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T02:21:30.717

检查 Mobile Support 下的 Preferences 并查看 iOS SDK 是否已链接。如果 5.1 和 6.1 已链接且可用，则应该是绿灯。还应该有文字说明“可用的设备 SDK：5.1,6.1”和“可用的模拟器：5.1,6.1”

# html - 居中 沿边的元素向左浮动和向右浮动元素

> ID：15939470
> 
> 赞同：0
> 
> 时间：2013-04-11T01:54:44.003
> 
> 标签：html, header, html-lists, center

我目前正在为我的网页制作标题，问题是我似乎无法让我的（标题图像）居中下图显示我的问题，其中文本：“Inlustra”是写的，我想在Header的中心。

您认为仅使用 div 会更好吗？如果是这样，这是怎么做的？我什至无法更早地获得浮动的左右 div，然后切换到无序列表。

这是我的CSS：

```
 #header {
    position:relative;
    -webkit-box-shadow: 0px 7px 30px rgba(50, 50, 50, 1);
    -moz-box-shadow:    0px 7px 30px rgba(50, 50, 50, 1);
    box-shadow:         0px 7px 30px rgba(50, 50, 50, 1);
    z-index:10;
    width:100%;
    height:40px;
    background-color: #FFFFFF;
    border-bottom:3px solid #1C6FFF;
}

.nav li {
    margin-left:-10px;
    display: inline-block;
    list-style: none;
    text-align: center;
    min-width:100px; width: auto !important; width: 100px;
}

.centerchild {
    width:150px;
    margin-left: auto;
    margin-right: auto;
    clear:both;
}

.firstchild {
    width:50px;
    float:left;
    text-align:left;
    margin-right:1.3em;
}

.lastchild {
    width:50px;
    float:right;
    margin-left:1.3em;
    text-align: right;
} 
```

这是我的 HTML：

```
 <div id="header"> 
                <ul class="nav">
                    <li class="firstchild"> <i class="icon-home icon-2x"> </i> </li>
                    <li class="firstchild"> <i class="icon-inbox icon-2x"> </i> </li>
                    <li class="lastchild"> <i class="icon-twitter icon-2x"> </i> </li>
                    <li class="lastchild"> <i class="icon-facebook icon-2x"> </i> </li>
                    <li class="centerchild"> TITLE OF PAGE </li>
                </ul>
            </div> 
```

这是结果 ![http://imgur.com/IarX4bX](https://i.stack.imgur.com/8GaXg.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T18:34:05.327

我自己不喜欢这个答案，但是 1995 年全部使用表格至少可以完成工作。由于在您的示例中，左右浮动元素的宽度不会改变，您可以执行以下操作：

（使用内联样式只是为了简洁）

```
<table style="width: 100%">
  <tr>
    <td style="width: 80px">Left</td>
    <td style="text-align: center">Center</td>
    <td style="width: 80px">Right</td>
  </tr>
</table> 
```

我真的很想相信有一种更优雅的方法可以做到这一点，我正在使用表格来诱使其他人发布它:-)

# android - 为 expandablelistview 的子级创建单独的 onClick() 方法

> ID：15939475
> 
> 赞同：3
> 
> 时间：2013-04-11T01:56:02.543
> 
> 标签：android, expandablelistview, buttonclick

我有一个如下所示的可扩展列表视图。我已经做到了，当每个孩子被点击时，都会弹出一条祝酒消息。我需要每个孩子开始他们自己的活动/片段，这需要单独的 onClick() 方法。有人知道如何实现吗？谢谢。注意：我正在使用 SimonVT 的滑动菜单库，而且我对 android 编程还很陌生。

MainActivity.java：

```
package press.linx.expandablelistdemo;

import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.xml.sax.SAXException;

import net.simonvt.menudrawer.MenuDrawer;

import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.ExpandableListView;
import android.widget.ExpandableListView.OnChildClickListener;
import android.widget.SimpleAdapter;
import android.widget.Toast;

public class MainActivity extends Activity {

ExpandableListView exv;
MenuDrawer mDrawer;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mDrawer = MenuDrawer.attach(this);
    mDrawer.setContentView(R.layout.activity_main);
    mDrawer.setMenuView(R.layout.leftmenu);

    exv=(ExpandableListView)findViewById(R.id.expandableListView1);
    exv.setAdapter(new MyAdapter(this));

    exv.setOnChildClickListener(new OnChildClickListener() {

        @Override
        public boolean onChildClick(ExpandableListView parent, View v,
                int groupPosition, int childPosition, long id) {
            // TODO Auto-generated method stub
            String itemclicked = MyAdapter.childList[groupPosition][childPosition];
            Toast.makeText(getApplicationContext(), "you clicked " + itemclicked, Toast.LENGTH_SHORT).show();
            return false;
        }

    });
}

private void setListAdapter(SimpleAdapter adapter) {
    // TODO Auto-generated method stub

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

} 
```

我的适配器.java

```
package press.linx.expandablelistdemo;

import android.content.Context;
import android.graphics.Color;
import android.graphics.Typeface;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseExpandableListAdapter;
import android.widget.TextView;

public class MyAdapter extends BaseExpandableListAdapter {
private Context context;
Typeface typeface;
String []parentList = {"Tech", "Best Of", "Art & Design", "Other"};

static String [][] childList = {
        {
            "All Tech", "Reviews", "Gaming", "Gadgets"
        },
        {
            "Android"
        },
        {
            "Architecture"
        },
        {
            "Infographics"
        }
};
public MyAdapter(Context context) {
    // TODO Auto-generated constructor stub
    this.context=context;

}

@Override
public Object getChild(int arg0, int arg1) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public long getChildId(int arg0, int arg1) {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView,
        ViewGroup parent) {
    // TODO Auto-generated method stub
    //typeface = Typeface.createFromAsset(context.getAssets(), "font/robotochild.ttf"); 
    TextView tv = new TextView(context);
    tv.setText(childList[groupPosition][childPosition]);
    tv.setPadding(30, 10, 0, 10);
    tv.setTextSize(15);
    //tv.setTypeface(typeface); 
    tv.setTextColor(Color.WHITE);
    return tv;
}

@Override
public int getChildrenCount(int groupPosition) {
    // TODO Auto-generated method stub
    return childList[groupPosition].length;
}

@Override
public Object getGroup(int groupPosition) {
    // TODO Auto-generated method stub
    return groupPosition;
}

@Override
public int getGroupCount() {
    // TODO Auto-generated method stub
    return parentList.length;
}

@Override
public long getGroupId(int groupPosition) {
    // TODO Auto-generated method stub
    return groupPosition;
}

@Override
public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub
    TextView tv = new TextView(context);
    typeface = Typeface.createFromAsset(context.getAssets(), "font/roboto.ttf"); 
    tv.setText(parentList[groupPosition]);
    tv.setPadding(50, 10, 0, 10);
    tv.setTextSize(20);
    tv.setTextColor(Color.WHITE);
    tv.setTypeface(typeface); 
    return tv;
}

@Override
public boolean hasStableIds() {
    // TODO Auto-generated method stub
    return false;
}

@Override
public boolean isChildSelectable(int groupPosition, int childPosition) {
    // TODO Auto-generated method stub
    return true;
}

} 
```

菜单列表视图.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".MainActivity" 
android:background="@drawable/geowall">

<ExpandableListView
    android:id="@+id/expandableListView1"
    android:groupIndicator="@null"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:padding="3dp" >
</ExpandableListView> 
```

![这里](https://s11.postimg.org/t8bo8cfqr/Screen_Shot_2013_04_10_at_6_17_57_PM.png)！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T07:05:15.390

这可能是您正在寻找的。

让我们从在 Eclipse IDE 中创建一个项目开始。

1.  通过转到 File ⇒ New Android Project 创建一个新项目。填写所有详细信息并将您的活动命名为 AndroidListViewActivity。
2.  创建项目后，打开您的主要活动 java 文件（在本例中为 AndroidListViewActivity.java）并从 ListActivity 扩展类。

public class AndroidListViewActivity extends ListActivity { 3\. 现在我们需要一个字符串资源文件来存储所有列表项标签。因此，在 values 文件夹下创建一个 XML 文件并将其命名为 list_data.xml 并粘贴以下代码。（右键单击 res/values ⇒ 新建 ⇒ Android XML 文件）

list_data.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="adobe_products">
        <item>Adobe After Effects</item>
        <item>Adobe Bridge</item>
        <item>Adobe Dreamweaver</item>
        <item>Adobe Edge</item>
        <item>Adobe Fireworks</item>
        <item>Adobe Flash</item>
        <item>Adobe Photoshop</item>
        <item>Adobe Premiere</item>
        <item>Adobe Reader</item>
        <item>Adobe Illustrator</item>
    </string-array>
</resources> 
```

1.  在 ListView 中，每个列表项都是一个 xml 布局，因此我们可以自定义每个列表项。在 res/layout 文件夹下创建一个 XML 文件并将其命名为 list_item.xml 并键入以下代码。此 xml 布局将是单个列表项行。（右键单击 res/layout ⇒ 新建 ⇒ Android XML 文件）

2.  现在打开您的主要活动 java 文件 (AndroidListViewActivity.java) 并键入以下代码。在下面的代码中，我将导入所有 xml 资源数据并将它们存储在一个数组中。在下一步中，我将数组绑定到 ListAdapter。

AndroidListViewActivity.java

```
package com.androidhive.androidlistview;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;

public class AndroidListViewActivity extends ListActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // storing string resources into Array
        String[] adobe_products = getResources().getStringArray(R.array.adobe_products);

        // Binding resources Array to ListAdapter
        this.setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item, R.id.label, adobe_products));

    }
} 
```

1.  现在运行您的项目，您可以看到带有数组项列表的列表视图。但是在单击单个列表项时，您看不到任何操作。所以我们需要开始选择单个列表项的新活动。

在选择单个列表项时启动新活动 在我之前的文章中，我解释了如何在屏幕之间切换。在这里，我将在新屏幕中显示单个列表项的详细信息。

1.  现在在 src 文件夹下创建新的活动类。右键单击 src/package 文件夹 ⇒ 新建 ⇒ 类并将其命名为 SingleListItem。(SingleListItem.java)
2.  打开您的 AndroidListViewActivity.java 并将代码修改为以下内容。在以下代码中，我获取选定的列表项字符串（产品名称）并将其发送到新活动。

AndroidListViewActivity.java

```
package com.androidhive.androidlistview;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;

public class AndroidListViewActivity extends ListActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // storing string resources into Array
        String[] adobe_products = getResources().getStringArray(R.array.adobe_products);

        // Binding resources Array to ListAdapter
        this.setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item, R.id.label, adobe_products));

        ListView lv = getListView();

        // listening to single list item on click
        lv.setOnItemClickListener(new OnItemClickListener() {
          public void onItemClick(AdapterView<?> parent, View view,
              int position, long id) {

              // selected item 
              String product = ((TextView) view).getText().toString();

              // Launching new Activity on selecting single List Item
              Intent i = new Intent(getApplicationContext(), SingleListItem.class);
              // sending data to new activity
              i.putExtra("product", product);
              startActivity(i);

          }
        });
    }
} 
```

现在在新活动中，我们需要显示从列表视图活动接收到的信息。

1.  在 res/layout 下创​​建一个新的 xml 文件并将其命名为 single_list_item_view.xml 并键入以下代码。此 XML 文件将是 SingleListItem.java 的布局

single_list_item_view.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="vertical"
  android:layout_width="match_parent"
  android:layout_height="match_parent">
  <TextView android:id="@+id/product_label"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textSize="25dip"
            android:textStyle="bold"
            android:padding="10dip"
            android:textColor="#ffffff"/>    
</LinearLayout> 
```

1.  现在打开您的第二个活动文件，即 SingleListItem.java 并粘贴以下代码。

SingleListItem.java

```
package com.androidhive.androidlistview;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.widget.TextView;

public class SingleListItem extends Activity{
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        this.setContentView(R.layout.single_list_item_view);

        TextView txtProduct = (TextView) findViewById(R.id.product_label);

        Intent i = getIntent();
        // getting attached intent data
        String product = i.getStringExtra("product");
        // displaying selected product name
        txtProduct.setText(product);

    }
} 
```

1.  最后一步是在 AndroidManifest.xml 文件中添加一个新的活动名称条目。打开你的 AndroidManifest.xml 文件并修改代码如下

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.androidhive.androidlistview"
      android:versionCode="1"
      android:versionName="1.0">
    <uses-sdk android:minSdkVersion="8" />

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".AndroidListViewActivity"
                  android:label="Android List View">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name=".SingleListItem"
                    android:label="Single Item Selected"></activity>
    </application>
</manifest> 
```

1.  最后通过右键单击您的项目文件夹 ⇒ 运行方式 ⇒ 1 Android 应用程序来运行您的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:32:22.297

如果您希望每个按钮具有不同的功能，请考虑将它们存储为按钮的`tag`属性（在 XML 布局中）。监听器中的`View v`参数是被点击的孩子的；然后可以使用它来检索标签，如下所示：`onChildClick``View`

`v.getTag();`

您可以使用 switch-case 块来根据标记调用正确的活动，或者将活动的**确切**名称存储在标记中并通过反射将其传递以检索活动的类。或者，您可以存储`HashMap`标记名称到`Activity`类/变量的映射。

# javascript - 使用 Javascript 将动态 4 位数年份转换为 2 位数年份

> ID：15939476
> 
> 赞同：1
> 
> 时间：2013-04-11T01:56:10.150
> 
> 标签：javascript, jquery, regex

我需要将动态生成的日期从 2013 年 4 月 20 日转换为 20.04.13。到目前为止，我设法转换了月份并更换了垫片。但是转换年份仍然使我无法理解。这是我到目前为止想出的。如何前进？

```
$(document).ready(function() {

                $('.date').each( function() {

    var oldDate = $(this).text();

    var month;

    if( oldDate.indexOf('-') > 0 ){

        var dateSplit = oldDate.split('-');

        var year = dateSplit[2];

        if( year.length == 2){
            year = year;
        }

        switch(dateSplit[1])
        {
            case 'Jan': month = "01";
            break;
            case 'Feb': month = "02";
            break;
            case 'Mar': month = "03";
            break;
            case 'Apr': month = "04";
            break;
            case 'May': month = "05";
            break;
            case 'Jun': month = "06";
            break;
            case 'Jul': month = "07";
            break;
            case 'Aug': month = "08";
            break;
            case 'Sep': month = "09";
            break;
            case 'Oct': month = "10";
            break;
            case 'Nov': month = "11";
            break;
            case 'Dec': month = "12";
            break;
        }

        $(this).text(dateSplit[0] + '.' + month  + '.' + year);
    }
    else if( oldDate.indexOf(('/') > 0 ) ){

        var dateSplit = oldDate.split('/');

        var year = dateSplit[2];

        if( year.length == 2){
            year = year;
        }

    }

    });

  }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T02:03:04.970

这是简单的算术：

```
year = year % 100; 
```

但是你为什么要这样做呢？你不记得千年虫问题吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T02:25:28.670

```
"20-Apr-2013".replace(/(\d+)-(\w+)-(\d+)/,function(p,p1,p2,p3) {
  return p1+'.'+String("00"+('janfebmaraprmayjunjulaugsepoctnovdec'.indexOf(p2.toLowerCase())/3+1)).slice(-2)+'.'+p3.slice(-2);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T01:59:28.600

您可以尝试库[moment.js](http://momentjs.com/)，它旨在解决这个确切的问题。即使你不使用它，[源代码](https://github.com/timrwood/moment/blob/develop/moment.js)也可能提供一些指针。

您可以将 oldDate 转换为 Date 对象并从那里开始吗？

```
var newDate = new Date(oldDate);
var month = newDate.getMonth();
var year = newDate.getFullYear().toString().substr(2, 2); //get the last 2 digits of the full year 
```

这是[javascript 日期对象上的函数的参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date#Methods)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-11T02:00:57.573

您最好先将其转换为[日期](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)：

```
$('.date').each(function() {

    var d = new Date($(this).text());

    $(this).text(d.getDate() + '.' + (d.getMonth() + 1) + '.'
                    + ('' + d.getFullYear()).substr(2, 2));

}); 
```

# ruby - YARD 真实性约定

> ID：15939477
> 
> 赞同：4
> 
> 时间：2013-04-11T01:56:18.010
> 
> 标签：ruby, yard, truthiness

是否有约定表明 YARD 样式文档中的参数仅用于其“真实性”状态，即您只想知道它`false`是否`nil`真实？

什么通常代替`Truthy`以下内容？

```
# @param [String] name
# @param [Truthy] admin_status 
def create_user(name, admin_status)
  # code goes here
end 
```

[我在文档](http://rubydoc.info/docs/yard/file/docs/Tags.md#Class_or_Module_Types)中能找到的最接近的是布尔值，这并不是我真正想要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T03:14:59.717

使用 Boolean 以外的任何内容都意味着您正在执行某种特殊处理，例如解释`0`为*false*或比 true/false 检查更直接的内容。

[您可以看到YARD 文档](http://rubydoc.info/docs/yard/YARD/CLI/Yardoc)中使用的约定，其中“布尔”表示评估为真/假。

# php - exec() 和 passthru() php 执行

> ID：15939478
> 
> 赞同：0
> 
> 时间：2013-04-11T01:56:24.773
> 
> 标签：php, exec, passthru

我尝试用 PHP 执行 python 脚本但没有结果：我试过了

```
$tmp = passthru("C:\\Python27\\python.exe C:\\Python27\\script.py C:\\Python27\\file.pdf",$output);
print($output) 
```

结果：“1”

尽管

```
$tmp = exec("C:\\Python27\\python.exe C:\\Python27\\script.py C:\\Python27\\file.pdf",$output); 
```

返回数组 ( )

我只能返回一个字符串，有什么建议吗？我在我的 php.ini 文件中验证了

```
 safe_mode = Off 
```

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:01:17.213

的文档`exec()`说`$output`参数是一个数组，将用每一行填充。如果要将其转换为单个字符串，请使用：

```
$output_string = implode("\n", $output); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T20:01:47.660

默认情况下，python 缓冲输出。将环境变量 PYTHONUNBUFFERED 设置为非空字符串，或使用 -u 运行 python。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-18T11:56:49.990

这应该适合你：

```
ob_start();

passthru("C:\\Python27\\python.exe C:\\Python27\\script.py C:\\Python27\\file.pdf");

$filedata = ob_get_clean();

echo $filedata; 
```

# regular-language - 具有匹配空字符串的正则表达式

> ID：15939485
> 
> 赞同：0
> 
> 时间：2013-04-11T01:56:51.243
> 
> 标签：regular-language, string

我正在开发一个 django 项目来修改文件*settings.py*中的数据库选项。我想使用正则表达式来做到这一点。选项就像： ***'PASSWORD':'123456'，*** 所以我写了一个函数，代码如下：

```
 def config_item(self,data,item,value):
        rStr = "'"+item+"':(\s)?'\w*'"
        src = "'"+item+"': '"+value+"'"
        res = re.sub(rStr,src,data)
        return res 
```

所以我可以这样调用将密码修改为'000000'，

```
data = config_item(data,'PASSWORD','0000') 
```

但是当源密码为空或目标密码为空时，就不起作用了。即不匹配***'PASSWORD'：''，*** 是不是正则表达式有问题。我如何正确地写它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:02:01.627

也许尝试使用`'[^']*'`而不是`'\w*'`

我认为 \w 更严格一些。

# awk - AWK 调用 sh 而不是 csh

> ID：15939487
> 
> 赞同：0
> 
> 时间：2013-04-11T01:56:56.763
> 
> 标签：awk, csh

我确信有一种更简单的方法可以做到这一点，所以我全神贯注。

```
sort -nrk 7 my_list.tsv | tail -n 1 | awk '{print("setenv INPUT_DIR `pwd`/"$1)}' 
```

我的 .tsv 中的第一项是我试图在 csh 中设置为环境变量的文件名（已排序）。我也想添加拉路径。我虽然这会工作，但......

```
sh: setenv: command not found 
```

即使我在csh。我可以让 awk 系统函数使用 csh/tcsh 吗？

Ĵ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:36:30.847

'也添加拉路径'。??

你的意思是

```
 echo "fileName" | awk '{printf("setenv '`pwd`'/%s\n", $1)}' 
```

输出

```
 setenv INPUT_DIR /home/shellter/filename 
```

我已经替换了您`sort ... | tail ..`，因为这似乎不是您的核心问题。

另请注意，单引号可防止处理反引号命令替换。您关闭单引号，获取您的 cmd-sub 值，然后再次打开单引号。

如果这不是您的意思，请编辑您的问题并用`sort ... tail ...`简单的 echo“字符串”替换上面的内容，并包含预期的输出。它还有助于包含您当前获得的输出。

要回答标题中的问题，awk 几乎肯定会使用 $SHELL 环境变量中存储的值。或者可能有另一个变量，所以执行 a`set | grep /bin/sh`并`setenv | grep /bin/sh`查看对的引用在哪里`/bin/sh`设置。然后决定你将如何管理它。

当我运行您的代码时，没有任何迹象表明 shell 已执行。我明白了

```
setenv INPUT_DIR `pwd`/file 
```

但我在 ksh 下运行代码。我没有可用于测试的 csh。但是对于给定的情况，这应该无关紧要。

IHTH

# java - 一组自定义对象包含相同的对象

> ID：15939491
> 
> 赞同：0
> 
> 时间：2013-04-11T01:57:18.113
> 
> 标签：java, set

我看到 Java 的一些奇怪行为`Set`。这是我遇到问题的非常简单的代码片段：

```
public Set<StopSequence> reduce() {
    Set<StopSequence> stopSequences = new HashSet<StopSequence>();
    StopSequence currentSequence = null;

    for (StopTime stopTime: mStopTimes) {
        if (stopTime.getStopSequence() == 0) {
            //beginning of a new sequence
            if (currentSequence != null) {
                if (stopSequences.add(currentSequence)) {
                    System.out.println("Added sequence:");
                    System.out.println(currentSequence.toString());
                }   
                currentSequence.clear();
            } else {
                currentSequence = new StopSequence();
            }
            currentSequence.add(stopTime.getStopId());              
        } else {
            currentSequence.add(stopTime.getStopId());
        }
    }

    Iterator<StopSequence> iterator = stopSequences.iterator();
    while (iterator.hasNext()) {
        System.out.println(iterator.next());
    }

    return stopSequences;
} 
```

现在看看控制台输出，你会发现问题：

第一个的输出`System.out.println`，一切似乎都很好：

```
Added sequence: com.bviproject.gtfsobjects.StopSequence@d48dbbe6
Added sequence: com.bviproject.gtfsobjects.StopSequence@d5e1c8a1
Added sequence: com.bviproject.gtfsobjects.StopSequence@c98eb21
Added sequence: com.bviproject.gtfsobjects.StopSequence@79baf504
Added sequence: com.bviproject.gtfsobjects.StopSequence@6617f5f6
Added sequence: com.bviproject.gtfsobjects.StopSequence@7d7554ff 
```

第二个的输出`System.out.println`，我`Set`只包含相同的对象。怎么了？？

```
com.bviproject.gtfsobjects.StopSequence@dd017ba7
com.bviproject.gtfsobjects.StopSequence@dd017ba7
com.bviproject.gtfsobjects.StopSequence@dd017ba7
com.bviproject.gtfsobjects.StopSequence@dd017ba7
com.bviproject.gtfsobjects.StopSequence@dd017ba7
com.bviproject.gtfsobjects.StopSequence@dd017ba7
com.bviproject.gtfsobjects.StopSequence@dd017ba7
com.bviproject.gtfsobjects.StopSequence@dd017ba7 
```

# c# - 将值保存到 xml 文件 - 发生错误

> ID：15939494
> 
> 赞同：0
> 
> 时间：2013-04-11T01:57:31.840
> 
> 标签：c#, xml

`"Object reference not set to an instance of an object."`当我尝试将值保存到 XML 文件时收到错误消息。我已经尝试过一段时间了。我知道它有效，因为我使用相同的代码（略有不同）将其他值保存到该文件中。这是唯一不工作的。

```
public void SAVEtxtDestination(string txtFileStuff)
{
    XmlDocument myXmlDocument = new XmlDocument();
    myXmlDocument.Load("C:\\Users\\fthompson11\\WebFile.xml");

    XmlNode root = myXmlDocument.DocumentElement;
    var targetKey = "Path";
    XmlNode node = root.SelectSingleNode(string.Format("Text[@Key = '{0}']", targetKey));
    node.Attributes["Value"].Value = txtFileStuff;
    myXmlDocument.Save("C:\\Users\\fthompson11\\WebFile.xml");
} 
```

这是我的 XML 文件的样子：

```
<?xml version="1.0" encoding="utf-8"?>
<!--This is to write the connection strings, text file location, and report destination.-->
<AdminPaths>
  <AdminPath Name="sqlConnection1" connectionString="tacohell" />
  <TextPath>
    <Text Key="Path" Value="Test3" />
    <Text Key="Report" Value="Test2" />
  </TextPath>
</AdminPaths> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:08:13.797

在您的评论中，您说在示例中表示小写“v”的值`nodes.attributes["value"].Value`是大写。Linq to XML 区分大小写，请确保代码中的属性名称与文件中的属性名称完全匹配。

# linux - bash 函数 $RANDOM 是否应该具有均匀分布？

> ID：15939495
> 
> 赞同：6
> 
> 时间：2013-04-11T01:57:56.993
> 
> 标签：linux, bash, statistics

我知道 bash 函数 $RANDOM 在一个范围内生成随机整数，但是，这些数字是否应该遵循（或近似）均匀离散分布？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-20T20:19:28.763

我只是打印了 $RANDOM 一百万次，把它变成了一个直方图，然后用 gnumeric 来查看它，图表显示了一个非常正态的分布！

```
for n in `seq 1 1000000`; do echo $RANDOM ; done > random.txt
gawk '{b=int($1/100);a[b]++};END{for (n in a) {print n","a[n]}}' random.txt > hist.csv
gnumeric hist.csv 
```

因此，如果您想要近似线性分布，请使用 $(( $RANDOM % $MAXIMUM )) 并且不要将其与大于 16383 或 8192 的 $MAXIMUM 一起使用以确保安全。如果您想要非常大的数字，您可以多次连接 $RANDOM % 1000 ，只要您注意前导零。

如果您确实想要正态分布，请使用 $(( $RANGE * $RANDOM / 32767 + $MINIMUM))，并记住这只是整数数学。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-11T02:04:07.937

[Bash 文档](http://www.gnu.org/software/bash/manual/html_node/Bash-Variables.html)实际上并没有这么说：

> 随机的
> 
> 每次引用此参数时，都会生成一个介于 0 和 32767 之间的随机整数。为该变量分配一个值会为随机数生成器提供种子。

读到这一点，我当然会*假设*它是线性的。恕我直言，它是其他任何东西都没有多大意义。

但是查看 bash 源代码， 的实现`$RANDOM`旨在产生线性分布（这是来自`variable.c`bash 4.2[源代码](http://git.savannah.gnu.org/cgit/bash.git/tag/?h=bash-4.2)）：

```
/* The random number seed.  You can change this by setting RANDOM. */
static unsigned long rseed = 1;
static int last_random_value;
static int seeded_subshell = 0;

/* A linear congruential random number generator based on the example
   one in the ANSI C standard.  This one isn't very good, but a more
   complicated one is overkill. */

/* Returns a pseudo-random number between 0 and 32767\. */
static int
brand ()
{
  /* From "Random number generators: good ones are hard to find",
     Park and Miller, Communications of the ACM, vol. 31, no. 10,
     October 1988, p. 1195\. filtered through FreeBSD */
  long h, l;

  /* Can't seed with 0\. */
  if (rseed == 0)
    rseed = 123459876;
  h = rseed / 127773;
  l = rseed % 127773;
  rseed = 16807 * l - 2836 * h;
#if 0
  if (rseed < 0)
    rseed += 0x7fffffff;
#endif
  return ((unsigned int)(rseed & 32767));       /* was % 32768 */
} 
```

正如评论所暗示的，如果您想要*好的*随机数，请使用其他东西。

# mysql - 当行具有相同的日期时，我可以在 mysql 中选择最新的插入行吗？

> ID：15939496
> 
> 赞同：0
> 
> 时间：2013-04-11T01:57:58.827
> 
> 标签：mysql, sql, greatest-n-per-group

我有一张这样的桌子：

```
+------+-----------------------------+---------+
| date |           test              | number  |
+------+-----------------------------+---------+
| 12.1 | hello!                      | 10      |
| 12.1 | hello and welcome!          | 15      |
| 12.2 | come here!                  | 20      |
| 12.2 | come here and do something! | 10      |
+------+-----------------------------+---------+ 
```

`12.1`带有日期和日期的行在`12.2`不同时间插入，我可以选择最新的插入吗？结果：

```
+------+-----------------------------+---------+
| date |           test              | number  |
+------+-----------------------------+---------+
| 12.1 | hello and welcome!          | 15      |
| 12.2 | come here and do something! | 10      |
+------+-----------------------------+---------+ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:04:46.117

你的表有一个 auto_increment id？

如果你想要表中所有行的最后一行

`SELECT * FROM table ORDER BY id DESC LIMIT 1;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:09:05.147

我认为您正在尝试为每个日期选择最新的测试。尝试这个：

```
SELECT tb2.date, tb1.test, tb1.number 
       FROM (SELECT MAX(number) as number, date FROM tb1 GROUP BY date) AS tb2, tb1
       WHERE tb1.date = tb2.date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T02:43:32.550

我认为这个 sql 可以帮助你

```
SELECT tb.date, tb.test, tb.number
FROM 
(
    SELECT DISTINCT date, test, number
    FROM test
    ORDER BY date DESC
) AS tb
GROUP BY tb.date 
```

表如：

```
CREATE TABLE IF NOT EXISTS `test` (
`date` varchar(32) NOT NULL,
`test` varchar(64) NOT NULL,
`number` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO `test` (`date`, `test`, `number`) VALUES
('12.1', 'hello!', 10),
('12.1', ' hello and welcome!', 15),
('12.2', 'come here!', 20),
('12.2', 'come here and do something!', 10); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T02:47:43.803

如果您想创建一个新字段`created_at with datatype (timestamp) and ORDER BY created_at DESC` ，或者您可以`field id`使用`ORDER BY id DESC`.

# ms-access - 访问 VBA Dimension 仅在第一次运行时存储预期值

> ID：15939500
> 
> 赞同：1
> 
> 时间：2013-04-11T01:59:26.233
> 
> 标签：ms-access, ms-access-2007, vba, ms-access-2010

我已经从其他地方改编了这段代码。单击表单上的按钮意味着告诉我Excel电子表格上给定单元格范围（C1：C500）中非空行的数量......

```
Sub ImportDataFromRange()

Dim excelapp As Excel.Application
Set excelapp = CreateObject("excel.application")
excelapp.Workbooks.Open (Application.CurrentProject.Path & "\MattExcelFile.xls")

Dim myrange As Range
Set myrange = excelapp.Sheets("Sheet1").Range("C1:C500")

Dim numberofrows As Integer
numberofrows = Excel.Application.WorksheetFunction.CountA(myrange)

MsgBox numberofrows
Debug.Print excelapp

excelapp.Quit
Set excelapp = Nothing

End Sub

Private Sub Command0_Click()

ImportDataFromRange

End Sub 
```

在打开 MS-Access 并通过我创建的按钮运行此代码时，它第一次可以正常工作，但之后就不行了。关闭并重新打开 MS-Access 会重置行为，因此它会在打开后第一次运行时再次正常工作，但以后再也不会正常工作了。

在第一次运行时，这是存储在维度中的（正确的）数据：

`excelapp`= "C:\Users\Matt\Desktop\MattExcelFile.xls" `numberofrows`= 4

在随后的运行中，这是存储在维度中的（不正确的）数据：

`excelapp`= "微软 Excel" `numberofrows`= 500

有人可以帮我处理一下这里的代码，这样我就可以在同一个 MS-Access 会话中多次运行代码并每次都获取维度中的正确数据吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T08:19:12.803

刚刚对您的代码进行了一些更改-我为您记录了它们-对我有用。

至于 excelapp 维度，我认为它说“Microsoft Excel”是正确的，如果您要打印 wb.Name 维度，您将获得工作簿名称。不知道为什么它会在后续运行中为您提供不同的维度，可能是因为您没有明确关闭工作簿，但这是一个猜测。

```
Sub ImportDataFromRange()
Dim excelapp As Object
Set excelapp = CreateObject("excel.application")

' assign the workbook
Dim wb As Object
Set wb = excelapp.Workbooks.Open(Application.CurrentProject.Path & "\tbl_Order_Status.xls")

Dim numberofrows As Integer
' Call function slightly differently
numberofrows = excelapp.Application.counta(wb.worksheets("Sheet1").Range("C1:C500"))

' Close and release wb
wb.Close
Set wb = Nothing

MsgBox numberofrows
Debug.Print excelapp

excelapp.Quit
Set excelapp = Nothing

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T08:20:55.890

我相信您的问题源于您创建`excelapp`对象变量但随后在获取的行上使用不同的引用（`Excel.Application.WorksheetFunction`而不是） 。`excelapp.WorksheetFunction``numberofrows`

以下（更正）代码适用于我：

```
Sub ImportDataFromRange()
Dim excelapp As Excel.Application
Set excelapp = New Excel.Application

excelapp.Workbooks.Open (Application.CurrentProject.Path & "\MattExcelFile.xls")

Dim myrange As Range
Set myrange = excelapp.Sheets("Sheet1").Range("C1:C500")

Dim numberofrows As Integer
numberofrows = excelapp.WorksheetFunction.CountA(myrange)

MsgBox numberofrows
Debug.Print excelapp

Set myrange = Nothing
excelapp.Quit
Set excelapp = Nothing

End Sub

Private Sub Command0_Click()

ImportDataFromRange

End Sub 
```

# jquery - jQuery remove 是否也会破坏可调整大小/可拖动对象？

> ID：15939503
> 
> 赞同：3
> 
> 时间：2013-04-11T01:59:37.167
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable, jquery-ui-resizable

在 jQuery + jQuery UI 中，调用`.remove()`一个也配置了 resizable/draggable 的元素是否固有地调用`.resizable('destroy')`+ `.draggable('destroy')`，或者是一个可以正确清理所有内容的等效方法？在调用删除之前，我是否必须销毁可调整大小/可拖动的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:37:51.163

取自 jQuery 的[remove() 文档](http://api.jquery.com/remove/)：

> 与 类似`.empty()`，该`.remove()`方法从 DOM 中取出元素。`.remove()`当您想要删除元素本身以及其中的所有内容时使用。**除了元素本身，所有与元素关联的绑定事件和 jQuery 数据都将被删除。**要删除元素而不删除数据和事件，请`.detach()`改用。

所以据说，它也会删除可调整大小和可拖动的事件。可能 jQuery 可能会调用`unbind()`或`off()`在从 DOM 中删除之前调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T16:47:03.603

似乎您不需要在调用`destroy`之前调用函数`remove`。**jQuery固有地`.remove`触发`.destroy`**。我在任何地方都找不到这个文档，我很惊讶地发现了这一点。

当include 时`jQuery UI`，库会覆盖 jQuery 的`cleanData`函数来包含触发`.remove`事件的代码。（[https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.widget.js#L16](https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.widget.js#L16)）

检查这个演示 - [http://jsfiddle.net/UMYzD](http://jsfiddle.net/UMYzD) -`.remove`调用`.remove`函数时调用处理程序。现在取消选中左侧窗格 ( [http://jsfiddle.net/UMYzD/1](http://jsfiddle.net/UMYzD/1) ) 中的 jQuery UI，您会看到`.remove`调用时不再触发事件处理程序`.remove`。

```
$.cleanData = function( elems ) {
    for ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {
      try {
        $( elem ).triggerHandler( "remove" );
       // http://bugs.jquery.com/ticket/8235
      } catch( e ) {}
    }
    _cleanData( elems ); 
}; 
```

该行`$( elem ).triggerHandler( "remove" );`触发`.remove`小部件绑定在该元素上的事件，并一直触发它`.destroy`固有地调用小部件上的事件。

下面是调用层次结构，

![在此处输入图像描述](https://i.stack.imgur.com/VIsZr.png)

下面是小提琴[http://jsfiddle.net/nxrzY/1/的快照](http://jsfiddle.net/nxrzY/1/)

![在此处输入图像描述](https://i.stack.imgur.com/9zPFU.png)

# youtube-api - Youtube Upload Code 突然提示 Credential Exception

> ID：15939504
> 
> 赞同：0
> 
> 时间：2013-04-11T01:59:46.897
> 
> 标签：youtube-api

我写了一个程序来连续上传我们的赛车视频（每五分钟循环一次，看看视频是否上传完成，如果完成则开始上传另一个比赛视频）

一切正常，就在昨天，它突然给出了一个凭证异常。首先我虽然可能是谷歌阻止了我，因为我上传了太多视频？

所以我尝试了我们的测试谷歌帐户使用该程序上传一个视频，它再次出现同样的错误？

有人知道有什么事情可能会出错吗？对我来说，代码绝对没问题，它工作了将近一年，没有人碰过它。

我很困惑！

崩溃点是 --> 调用 service.setUserCredentials(username, the_password)

抛出 Java 异常：com.google.gdata.client.GoogleService$InvalidCredentialsE 异常：无效凭据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T20:52:50.680

它今天神奇地起作用。我还是不知道为什么，我觉得是google的问题到此为止了，所以以后如果有人遇到这个问题，不要慌，回家喝茶，明天试试~~~

# java - Java 程序突然在 NetBeans 中结束

> ID：15939508
> 
> 赞同：0
> 
> 时间：2013-04-11T02:00:03.150
> 
> 标签：java, netbeans

我目前正在尝试编写基于文本的刽子手。如果你选择猜一个字母，程序会在执行第 53 行后突然结束。请告诉我为什么会发生这种情况，因为我无法弄清楚。

这是我的一些Java代码：

```
package hangman;

import java.util.Random;
import java.util.Scanner;
import java.lang.String;

public class Hangman {

    public static void main(String[] args) {
        // TODO code application logic here
        Scanner chez = new Scanner(System.in);
        Scanner waffle = new Scanner(System.in);
        Random randomGenerator = new Random();
        StringBuilder displayWord = new StringBuilder("______________________________");
        String theWord = null;
        String preLetter;
        //String sbDisplayWord;
        char letter = 0;
        int randomNumber;
        int lengthOfWord;
        int numberOfLetterInWord = 0;
        int gDisplay;
        int guessWordNumber = 0;
        String guessWord;
        RandomWord troll = new RandomWord();    
        randomNumber = randomGenerator.nextInt(12);
        //Fill var with the word.
        theWord = troll.wordDecide(randomNumber);

        System.out.println ("Welcome to Hangman!");

        lengthOfWord=theWord.length( );
        System.out.println("This word has " + lengthOfWord + " letters.");

        System.out.println("You have 20 guesses.");

        for (int g =19; g >= 0; g--) {    

            System.out.println("If you want to guess the word, type 0\. If you want to guess a letter, type 1.");
            guessWordNumber=chez.nextInt();

            if (guessWordNumber==0) {
                System.out.println("Enter the word now. Remember, don't capitalize it.");
                guessWord=waffle.nextLine();
                if (guessWord.equals(theWord)) {
                    System.out.println("YOU WIN");
                    System.exit(0);
                } else {
                    System.out.println("Sorry, this wasn't the correct word.");
                }
            } else if (guessWordNumber==1) {

                System.out.println("Please enter the letter you wish to guess with.");
                //System.out.println("It will tell you if you have guessed right for any of the letters. If it is blank, that means none of the letters match.");
                preLetter=chez.nextLine();

                if (preLetter.length()>0) {
                    letter=preLetter.charAt(0);
                } else {
                    System.exit(0);
                }

                System.out.println("");
                for(int i = 0; i <= lengthOfWord -1; i++ ) {     //-Eshan

                    if (letter == theWord.charAt( i )) {

                        numberOfLetterInWord=i+1;
                        System.out.println("This letter matches with letter number " + numberOfLetterInWord + " in the word.");
                        displayWord.setCharAt(i, letter);
                    } else {

                        numberOfLetterInWord=i+1;
                        System.out.println("This letter doesn't match with letter number " + numberOfLetterInWord + " in the word.");

                    }       

                }

                System.out.println("");
                System.out.println("The word so far is " + displayWord);
                System.out.println("");
                gDisplay = g + 1;
                System.out.println("You have " + gDisplay + " guesses left.");

            } else {
                System.exit(0);
            }

        }

        System.out.println("GAME OVER");
        System.exit(0);

    }
} 
```

这是我的 Java 代码的另一部分：

```
package hangman;

public class RandomWord {
    private static String[] wordArray = {
        "psychology",
        "keratin",
        "nostalgia",
        "pyromaniac",
        "chlorophyl",
        "derivative",
        "unitard",
        "pterodactyl",
        "xylophone",
        "excommunicate",
        "obituary",
        "infinitesimal",
        "concupiscent",
    };

    public String wordDecide(int randomNumber) {
        String theWord;
        theWord = wordArray[randomNumber];
        return theWord;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:08:01.170

因为[Scanner#nextInt](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#nextInt%28%29)不消耗换行符，所以这一行

```
guessWordNumber = chez.nextInt(); 
```

将换行符传递给

```
preLetter = chez.nextLine(); 
```

但是`Scanner`now 不会阻​​塞，因为它已经收到了输入。现在`String` `preLetter`是空的，因此会导致程序退出。

尝试使用`Scanner#nextLine`which 消耗换行符：

```
guessWordNumber = Integer.parseInt(chez.nextLine()); 
```

# .htaccess - Apache 重写为 Nginx 重写。QSA 问题。如何正确转换？

> ID：15939509
> 
> 赞同：1
> 
> 时间：2013-04-11T02:00:20.557
> 
> 标签：.htaccess, mod-rewrite, nginx, rewrite

我现在有这个规则：

```
 RewriteRule ^/mp3/(.*)$ /music/$1 [L,R=301]
 RewriteRule ^/activate/(.*) /index.php?p=activate.php&hash=$1 [QSA]
 RewriteRule ^(.*)/([0-9]+)/(.*)$ index.php?p=$1&id=$2&page=$2 [QSA]
 RewriteRule ^(.*)/([0-9]+)$ index.php?p=$1&id=$2&page=$2 [QSA]
 RewriteRule ^(.*)/$ index.php?p=$1 [QSA] 
```

但转移到 Nginx，我已经创建了这些规则，但现在工作，我只得到 404：

```
location / {
    rewrite ^/mp3/(.*) /music/$1 permanent;
    rewrite ^/activate/(.*) /index.php?p=activate.php&hash=$1 permanent;
    rewrite ^(.*)/([0-9]+)/(.*)$ index.php?p=$1&id=$2&page=$2 break;
    rewrite ^(.*)/([0-9]+)$ index.php?p=$1&id=$2&page=$2 break;
    rewrite ^(.*)/$ index.php?p=$1 break;
} 
```

如何将 QSA 规则转换为 Nginx？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:16:13.390

与 apache 的 mod_rewrite 不同，您*可以*匹配 nginx`rewrite`命令中的查询字符串。所以你想要这样的东西：

```
location / {
    rewrite ^/mp3/(.*) /music/$1 permanent;
    rewrite ^/activate/([^\?]*)(?:\?(.*))? /index.php?p=activate.php&hash=$1&$2 permanent;
    rewrite ^(.*)/([0-9]+)/([^\?]*)(?:\?(.*))?$ index.php?p=$1&id=$2&page=$2&$3 break;
    rewrite ^(.*)/([0-9]+)(?:\?(.*))?$ index.php?p=$1&id=$2&page=$2&$3 break;
    rewrite ^(.*)/(?:\?(.*))?$ index.php?p=$1&$2 break;
} 
```

# visual-studio-2010 - 在 VS2012 中调试时出现随机 CLR 异常

> ID：15939511
> 
> 赞同：0
> 
> 时间：2013-04-11T02:00:37.210
> 
> 标签：visual-studio-2010, debugging, visual-studio-2012

我在调试时不断收到随机的 CLR 异常，然后导致调试器停止。它发生在我的 asp.net 项目和我创建的空白 asp.net 项目中。下面是错误。任何想法为什么？大多数时候它发生在我的应用程序空闲或启动时

> 运行时遇到致命错误。错误地址位于线程 0x1928 上的 0x71331c38。错误代码为 0xc0000005。此错误可能是 CLR 中的错​​误或用户代码的不安全或不可验证部分中的错误。此错误的常见来源包括 COM 互操作或 PInvoke 的用户封送错误，这可能会损坏堆栈。

或者有时我会得到这个

> System.ExecutionEngineException 未处理 消息：未知模块中发生“System.ExecutionEngineException”类型的未处理异常。

**更新** 我在不同项目的 VS2010 中也有同样的问题。不过，它们都是基于 Web 的项目。一个是一组 WCF Web 服务，另一个是一个 asp.net mvc4 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T07:28:31.873

看起来我找到了问题的原因。我还注意到一些访问冲突错误，我想知道是不是因为我在 VirtualBox 中运行它。在 Virtual Box 中的 Visual Studio 上进行了快速搜索，看起来访问冲突错误可能是由 VirtualBox 引起的。所以我使用了 Disk2VHD 并设置了 Hyper-V。到目前为止没有任何问题。我怀疑其他异常也可能是由 VirtualBox 引起的。

# codeigniter - CodeIgniter 上传进度

> ID：15939512
> 
> 赞同：5
> 
> 时间：2013-04-11T02:00:42.533
> 
> 标签：codeigniter, file-upload, progress-bar

我正在尝试使用 CI 2.1.3 使用进度条上传文件。我已经让文件上传一切正常，但是获得这个文件进度并不容易。我查看了大量具有不同解决方案的指南，但它们似乎都不起作用，因为大多数都非常过时（2008 年左右）。

这就是我要找的东西：

*   PHP/jQuery/AJAX/Javascript 解决方案（请不要使用 Flash！）
*   跨浏览器（IE 不是问题，所以如果它在 IE8 或更低版本中不起作用，那也没关系）
*   CodeIgniter 上传库兼容

就是这样。我的参考代码：

PHP：

```
public function do_upload()
{
    // Configure and load the uploads library
    $config['upload_path']   = './uploads/';
    $config['allowed_types'] = 'mp4|mov';
    $config['encrypt_name']  = TRUE;
    $config['max_size']      = '2621440'; // 2.5 GB, in kilobytes

    $this->load->library('upload', $config);

    if (!$this->upload->do_upload('userfile'))
    {
        $this->session->set_flashdata('error', $this->upload->display_errors('', ''));

        redirect('upload');
    }
    else
    {
        $this->session->set_flashdata('upload_data', $this->upload->data());

        $upload_data = $this->upload->data();
        $uploader = $this->flexi_auth->get_user_by_id()->row_array()['uacc_username'];

        $this->load->model('upload_model');
        $this->session->set_flashdata('uaid', $this->upload_model->generate_uaid($upload_data['raw_name']));
        $this->upload_model->create_upload($upload_data['file_name'], $upload_data['raw_name'], $upload_data['client_name'], $upload_data['file_size'], $upload_data['file_path'], $uploader);

        redirect('upload');
    }
} 
```

HTML：

```
<div class="progress progress-striped active" id="upload_progress" style="display: none;">
                    <div class="bar" id="upload_progress_bar" style="width: 0%;"></div>
                </div>
                <?php echo form_open_multipart('upload/do_upload', array('id' => 'upload_form')); ?>
                <input type="file" name="userfile" size="20" />
                <button type="submit" name="upload">Upload</button>
                <?php echo form_close(); ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T12:45:11.967

实际上，经过进一步研究，[Dropzone.JS](http://dropzonejs.com/)似乎与 CI 配合得非常好，几乎不需要配置和调整。我还没有机会使用它的所有功能，但是在大约 5 分钟的工作之后，它就有了上传进度，并且拖放上传工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T14:09:14.463

[http://vortexdev.netii.net/article_20/Integrate_jQuery_File_Upload_with_CodeIgniter](http://vortexdev.netii.net/article_20/Integrate_jQuery_File_Upload_with_CodeIgniter)
- 2012/05/14

[https://github.com/blueimp/jQuery-File-Upload/wiki/jQuery-File-Upload-6.5-with-CodeIgniter-2.1](https://github.com/blueimp/jQuery-File-Upload/wiki/jQuery-File-Upload-6.5-with-CodeIgniter-2.1)
- 5 个月前编辑

这是一个艰难的。有很多解决方案，但很大程度上取决于堆栈和目标（例如，在您的情况下没有闪存）。有一个[PECL 扩展](http://pecl.php.net/package/uploadprogress)提供了本机功能，以及[许多](https://stackoverflow.com/q/9878161/183254)[其他](https://stackoverflow.com/q/10252309/183254)尝试做同样[事情](https://stackoverflow.com/q/7231899/183254)[的](https://stackoverflow.com/q/14806542/183254)例子，这些例子在去年[一直](https://stackoverflow.com/q/158853/183254)很活跃。还有[这](https://stackoverflow.com/a/1802777/183254)声称提供基于 PHP 的[输出控制](http://php.net/manual/en/book.outcontrol.php)的直接 html 进度。我无法让它在本地工作。

最好的办法是开始将东西混合在一起并尝试得到一些有效的东西——目前还没有一个直接的即插即用解决方案用于 CI 上传进度条。

# java - 在java中乘以二维数组（矩阵）

> ID：15939515
> 
> 赞同：0
> 
> 时间：2013-04-11T02:01:07.260
> 
> 标签：java, arrays, multidimensional-array, matrix

我的目标是在两个数组相乘时打印出矩阵。我对这段代码做错了什么？我如何得到它以便打印出矩阵？（对不起，我不知道我应该提供哪些其他细节，除非我添加更多细节，否则我无法提交这篇文章）。

```
public class Matrices {
static int mRows = 0;
static int mCol = 0;
static int nRows = 0;
static int nCol = 0;
 public static int[][] multiplyMatrices(int[][] m, int[][] n){
    mRows = m.length;
    mCol = m[0].length;
    nRows = n.length;
    nCol = n[0].length;
    if(canBeMultiplied(m,n) == false){
        throw new IllegalArgumentException("Cannot multiply arrays");
    }
    int[][] answer = new int[mRows][nCol];
    for(int i = 0; i < mRows; i++){
        for(int j = 0; j < nCol; j++){
            for(int k = 0; k < mCol; k++){
                answer[i][j] += m[i][k] * n[k][j];
            }
        }
    }
    return answer;
}

public static boolean canBeMultiplied(int[][] m, int[][]n){
    mRows = m.length;
    mCol = m[0].length;
    nRows = n.length;
    nCol = n[0].length;
    if(nRows == mCol){
        return true;
    }
    return false;
}

public static void main(String[] args) {
    int[][] temp1 = {{1,2,3},{4,5,6}};
    int[][] temp2 ={{1},{2},{3}};
    for(int i = 0; i < mRows; i++){
        for(int j = 0; j < nCol; j++){
            System.out.print(multiplyMatrices(temp1,temp2)[i][j]);
        }
                    System.out.print("\n");
    }

}
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:03:50.583

这可能会遍历二维数组并打印每个元素。

```
static final int ROWS = 2;
static final int COLS = 4;

int[][] a2 = new int[ROWS][COLS];

//... Print array in rectangular form
for (int i = 0; i < ROWS; i++) {
    for (int j = 0; j < COLS; j++) {
        System.out.print(" " + a2[i][j]);
    }

    System.out.println("");
} 
```

# qt - 如何通过信号和槽传递参数？

> ID：15939520
> 
> 赞同：0
> 
> 时间：2013-04-11T02:02:01.827
> 
> 标签：qt

我的 GUI 由**LineEdit**和**PushButton**组成。**单击PushButton**时，将`clicked()`调用插槽。我想在信号和槽之间建立信号槽`clicked()`关系`doSomething()`。问题是`doSomething()`它无法访问 UI 并`doSomething()`依赖**LineEdit**的文本来工作。

我看到两个解决方案：

1.  授予对 UI 的 doSomething() 访问权限。

2.  我希望能够将 QString 作为参数传递给 doSomething()。clicked() 不接受任何参数。Qsignalmapper 可能是我正在寻找的。但是，映射器似乎只根据信号传递参数。因此，需要提前设置参数，这似乎对我没有帮助。

我将如何做解决方案2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T02:11:27.183

假设使用 C++ 解决方案，您可能会考虑为 #2 使用如下中间信号：

```
connect(thisWidget, SIGNAL(clicked()),
        thisWidget, SLOT(slotClickHandler())); 
```

然后：

```
void slotClickHandler()
{
   QString s = "my variable string here";

  emit sigDoSomething(s);
} 
```

还有他们：

```
void slotDoSomething(const QString &s)
{
   // Do something interesting with s here

} 
```

请注意，此代码段假定您已经定义了一个新信号`sigDoSomething(const QString &)`和一个私有 slot `void slotDoSomething(const QString &)`。

# jquery - 从 JQuery $.ajax 调用 WebService 得到错误 500

> ID：15939524
> 
> 赞同：0
> 
> 时间：2013-04-11T02:02:19.700
> 
> 标签：jquery, asp.net, ajax

我正在为我的第一个 WebService 苦苦挣扎，所以我决定将所有内容都简化为基础。还是行不通。

我创建了一个全新的 ASP.NET 网站项目。

我添加了一个名为 WebService 的文件夹。在 WebService 文件夹中，我使用 ASP.NET 模板添加了一个新的 WebService。我只修改了模板以取消注释 [System.Web.Script.Services.ScriptService]。

在 Default.aspx 页面中，在“欢迎使用 ASP.NET”之后，我添加了一个面板，如下所示：

```
<asp:Panel ID="Panel1" runat="server" Height="200px" Width="200px" BackColor="Blue" onclick="HelloWorld();">
</asp:Panel> 
```

我还将以下脚本添加到 HeaderContent 区域：

```
<script type="text/javascript" language="Javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>

<script type="text/javascript">

    function OnSuccessCall(response) {
        alert("Success! : " + response);
    }
    function OnErrorCall(response) {
        alert(response.status + " " + response.statusText);
    }
    function HelloWorld() {
        var pageUrl = '<%=ResolveUrl("~/WebService/WebService.asmx")%>'

        $.ajax({
            url: pageUrl + "/HelloWorld",
            success: OnSuccessCall,
            error: OnErrorCall
        });
    }

 </script> 
```

当我运行此代码时，我收到错误 500。我错过了什么？

// - - - - - - - - - - - - - - - - 更新 - - - - - - - - ------------------------------

啊！新线索！如果将 WebMethod 移动到 Default.aspx 的代码隐藏中，而不是作为 WebService 类的一部分，而只是作为具有 [WebMethod] 属性的方法，则它可以工作。（至少我可以使用我的 OnSuccess 函数）。但是，如果我再添加

```
contentType: "application/json; charset=utf-8",
dataType: "json", 
```

对于 $.ajax() 调用，我又回到了错误 500（尽管可能是出于不同的原因）。是否有一些我缺少 JSON 或其他东西的安装部分？

// - - - - - - - - - - - - - - - - 更新 - - - - - - - - ------------------------------ 这是实际的WebService。正如我之前所说，这正是您在创建新项目并选择 Web 服务时所得到的。

如果有人能告诉我这对他们有用，那么我可以专注于环境问题。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;

/// <summary>
/// Summary description for WebService
/// </summary>
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
 [System.Web.Script.Services.ScriptService]
public class WebService : System.Web.Services.WebService {

    public WebService () {

        //Uncomment the following line if using designed components 
        //InitializeComponent(); 
    }

    [WebMethod]
    public string HelloWorld( ) {
        return "Hello World";
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T12:03:23.360

你要么没有尝试编译你的代码，要么没有把你的实际代码放在这里

```
[WebMethod]
public string HelloWorld(string name) { //<--- you forget method param name to specify
    return "Hello World";
} 
```

因此，要么删除参数（ ie `public string HelloWorld()`），要么添加我在代码中显示的名称。

此外，由于您没有任何参数，您可以将服务方法的 url 放在浏览器中，看看会发生什么。即转到`http://localhost/yourapp/WebService/WebService.asmx/HelloWorld`，或任何真实的 URL

# git - 在 gitolite 中，如何拒绝包含不正确作者信息的推送

> ID：15939529
> 
> 赞同：2
> 
> 时间：2013-04-11T02:02:52.610
> 
> 标签：git, gitolite

我打算只接受包含正确作者信息的提交。喜欢 `Author: Name<xxxx@xxx.org>`

在 gitolite 中，有没有办法实现它？顺便说一句，我使用 V2。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T05:21:02.730

首先，在 Gitolite V3 中，它被称为[**`VREF`**](https://stackoverflow.com/questions/10888300/gitosis-vs-gitolite/10888358#10888358)，类似于[EMAIL_CHECK VREF](https://github.com/sitaramc/gitolite/blob/master/src/VREF/EMAIL-CHECK)。

你也可以在g2（Gitolite V2）中使用“ [virtual ref](http://gitolite.com/gitolite/g2/vref.html) ”（g3 VREF的前身），包括[查作者邮箱一](http://gitolite.com/gitolite/g2/vref.html#virtual_refs_checking_author_email_)：脚本是“ [`g2/contrib/VREF/gl-VREF-EMAIL_CHECK`](https://github.com/sitaramc/gitolite/blob/g2/contrib/VREF/gl-VREF-EMAIL_CHECK)”。
您需要使该脚本适应您自己的电子邮件控制策略。

对于为所有用户的所有 repos 运行的钩子，一个更简单的版本将是一个`update`钩子，但由于该版本`update`已经使用了该钩子，因此您需要*链接*自己的`update`钩子。
参见“[钩链](http://gitolite.com/gitolite/g2/hooks.html#hookchaining)”。

> 要运行您自己的 ' `update`' 挂钩，只需将其放入名为的文件中**`update.secondary`**并将其安装为挂钩即可。
> Gitolite 的更新钩子将自动链接到它，注意将与从 git 收到的原始更新钩子相同的 3 个参数传递给它。

# javascript - 如何使用来自 Yelp API 的字符串化 JSON 数据

> ID：15939530
> 
> 赞同：0
> 
> 时间：2013-04-11T02:03:02.040
> 
> 标签：javascript, json, stringify, yelp

我试图弄清楚如何使用[Yelp API v2](http://www.yelp.com/developers/documentation)中的数据。在 json.stringify 之后如何读取 yelp 给出的数据。这就是我所做的，

```
var output = JSON.stringify(data);
alert(output[0].id) // This comes out to be undefined. 
```

你如何从 yelp api 读取 json 数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:08:41.970

`data`应该已经是一个对象。`alert(data[0].id)`. 如果你从`$.ajax`中获取它，我假设它会返回一个对象。

如果`data`是一个字符串，那么你想要：

```
var output = JSON.parse(data);
alert(output[0].id) 
```

# ubuntu-12.04 - 磁盘空间迅速减少，因为 /var/log/cups/error_log 变得巨大

> ID：15939532
> 
> 赞同：4
> 
> 时间：2013-04-11T02:03:09.837
> 
> 标签：ubuntu-12.04, diskspace, error-log

在我将我的 Ubuntu 更新到 12.04 后，我的系统变慢了，它警告我我的磁盘空间不足。我检查了我的磁盘，发现文件**/var/log/cups/error_log**的大小是**78G！**. 我检查了这个文件，发现它充满了“订阅通知器 dbus:// 离开重试重试”............这是怎么回事？我能做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T04:39:21.210

尝试删除此文件夹并使用此命令再次创建

sudo rm -vfr /var/log && sudo mkdir /var/log

并检查是否有任何工具报告您的系统，例如从此处禁用它

[建议禁用](https://askubuntu.com/questions/93457/how-do-i-enable-or-disable-apport)

像这样取消选中它并使记录活动像这样在隐私选项中处于非活动状态

![隐私选项](https://i.stack.imgur.com/qPAbU.png)

并在软件源中取消选中此选项，您可以通过在终端中键入此窗口

gksu 软件-属性-gtk

并这样做

![在此处输入图像描述](https://i.stack.imgur.com/5y0lR.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T14:42:40.990

您可以使用以下命令显示驱动器中大小超过 1G 的所有文件

```
sudo find / -size +1G 
```

您现在可以删除不需要的文件。

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-14T20:50:51.613

您应该做的第一件事是停止 cups 服务器，以便它停止用错误填充您的文件系统。打开终端并运行：

```
sudo stop cups 
```

然后删除error_log 文件。如果您通过 gui 删除它，请确保使用 shift + delete 删除它，这样它就不会进入您的垃圾箱。之后您可能需要重新启动系统。我刚遇到这个问题。当我找到永久解决方案时，将扩展此答案。

### 更新#1

停止 cups 服务器，删除 error_log 文件并重新启动解决了我的问题。cups（通用 Unix 打印系统）用于将网络打印机连接到您的机器，因此如果您遇到很多 cups 错误，这很可能是由于打印机连接失败或其他打印机错误造成的。

# ruby-on-rails - 回形针无法显示多个 has_attached_model

> ID：15939538
> 
> 赞同：0
> 
> 时间：2013-04-11T02:04:10.420
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个名为广告客户的模型，它有 5 个用于图片上传的 url

这里的模型

```
 attr_accessible :link, :publishoff, :publishon, :title, :adone, :adtwo, :adthree, :adfour, :adfive
  has_attached_file :adone, :styles => {
        :small => "150x150>",
        :medium => "300x300>",
        :thumb => "100x100>"
    },
    :url  => "/assets/advertiser/adone/:id/:style/:basename.:extension",
    :path => ":rails_root/public/assets/advertiser/adone/:id/:style/:basename.:extension" 
```

其中adone adtwo是我的图片上传等等，都是一样的上传思路。

现在视图看起来像这样

```
8: <% unless @advertisments.nil? %>
9: <%= link_to image_tag(@advertisments.adone.url(:small), :title =>"#{@advertisments.title}"), @advertisments.link, :target => "_blank" %>
10: <% end %> 
```

这里是我的控制器 application_controller

```
@advertisments = Advertiser.where("publishon <= ? AND publishoff >= ?", Date.today, Date.today).limit(1) 
```

我得到的错误如下

```
undefined method `adone' for #<ActiveRecord::Relation: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:42:35.660

您的控制器方法正在返回一个`ActiveRecord::Relation`集合......您想要的对象在其中。

添加`.first`到这一行的末尾，如下所示：

```
@advertisments = Advertiser.where("publishon <= ? AND publishoff >= ?", Date.today, Date.today).limit(1).first 
```

这将返回`Advertiser`集合中唯一的并将其分配给`@advertisements`.

# javascript - 将 JSON 文件与 grunt-contrib-concat 合并

> ID：15939545
> 
> 赞同：2
> 
> 时间：2013-04-11T02:04:54.470
> 
> 标签：javascript, json, concatenation, gruntjs

我正在寻找将 json 文件合并到一个文件夹中的最佳方法。

使用 HTML、CSS 和 JavaScript 这很容易，因为您不需要分隔符或只需要一个`;`. 然而，对于 JSON，我们需要更多的东西来使它成为一个有效的 JSON 对象。

一种方法是连接文件`,`并将所有内容包装在一个数组中。我想知道是否有更好/更简单的方法来做到这一点。

## Gruntfile.js

```
grunt.initConfig({
    pkg: grunt.file.readJSON('package.json'),
    concat: {
        json: {
            src: ['src/**/*.json'],
            dest: 'dist/combined.json',
            options: {
              ...
            }
        }
    }
}); 
```

## src/file1.json

```
{
    "number": 1
} 
```

## src/file2.json

```
{
    "number": 2
} 
```

## dist/combined.json

这将是期望的结果：

```
{
    "numbers": [
        {
            "number": 1
        },
        {
            "number": 2
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T02:17:03.463

您应该能够使用[横幅](https://github.com/gruntjs/grunt-contrib-concat#banner)和[页脚](https://github.com/gruntjs/grunt-contrib-concat#footer)选项。

```
grunt.initConfig({
    pkg: grunt.file.readJSON('package.json'),
    concat: {
        json: {
            src: ['src/**/*.json'],
            dest: 'dist/combined.json',
            options: {
                // Added to the top of the file
                banner: '{"numbers": [',
                // Will be added at the end of the file
                footer: "]}",
                separator: ','
            }
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-04T12:48:14.193

您应该使用专门的面向 JSON 的插件来处理它。不仅仅是一个任意的字符串连接。

看看[https://github.com/rse/grunt-merge-json](https://github.com/rse/grunt-merge-json)或[https://github.com/shinnn/grunt-merge-data](https://github.com/shinnn/grunt-merge-data)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-05T14:47:49.303

您可以为此使用[grunt-merge-json](https://github.com/rse/grunt-merge-json)。

使用示例：

假设我们有以下类型的源 JSON 文件：

```
src/foo/foo-en.json:
{
    "foo": {
        "title": "The Foo",
        "name":  "A wonderful component"
    }
}
src/bar/bar-en.json:
{
    "bar": {
        "title": "The Bar",
        "name":  "An even more wonderful component"
    }
} 
```

假设我们要生成以下目标 JSON 文件：

```
{
    "foo": {
        "title": "The Foo",
        "name":  "A wonderful component"
    },
    "bar": {
        "title": "The Bar",
        "name":  "An even more wonderful component"
    }
} 
```

每个目标变体单个文件

```
grunt.initConfig({
    "merge-json": {
        "en": {
            src: [ "src/**/*-en.json" ],
            dest: "www/en.json"
        },
        "de": {
            src: [ "src/**/*-de.json" ],
            dest: "www/de.json"
        }`enter code here`
    }
}); 
```

每个目标变体多个文件

```
grunt.initConfig({
    "merge-json": {
        "i18n": {
            files: {
                "www/en.json": [ "src/**/*-en.json" ],
                "www/de.json": [ "src/**/*-de.json" ]
            }
        }
    }
}); 
```

# java - 如果该方法引用原始方法，该方法是否可以引用同一类中的方法

> ID：15939547
> 
> 赞同：0
> 
> 时间：2013-04-11T02:05:09.097
> 
> 标签：java, methods, reference

我正在制作一个简单的基于文本的游戏。我的类中有一个方法引用同一个类中的另一个方法，但是如果满足某个条件，该方法引用引用它的方法。

因此，基本上，如果角色选择打开菜单，则调用 Character.mainMenu() 方法，并根据所选内容引用 Character.invMenu() 或 Character.statsMenu()。

如果用户选择从 mainMenu() 中选择 Back，则调用另一个名为 backSetter() 的方法。此方法采用当前 x 和 y 坐标并返回位置 ID，以将用户返回到他们打开菜单的任何位置。

在invMenu()等子菜单方法（mainMenu()方法调用的方法）内部，也有返回选项：1.返回和2.主页。Back 选项将用户返回到调用 mainMenu() 方法的主菜单。Home 选项将用户返回到他们打开菜单的位置，调用 backSetter() 方法。然而，问题是，如果我从 invMenu() 方法调用这些方法，它们似乎什么也没做，我的程序就会冻结。

这是我的 Character 类的基本模板（这里引用的其他类是 MainClass，它包含 setLocation() 方法和 GameText 类，它引用了 gameText() 方法）。

```
class Character{

    static Scanner userInput = new Scanner();
    static String choice;
    static int backChoice = 0;

    public static void backSetter(){
        if (xAxis == 0 && yAxis == 0){
            backChoice = MainClass.setLocation(0,0);
            GameText.gameText(backChoice);
        }else if (xAxis == 0 && yAxis == 1){
            .....
        }
    }

    public static void mainMenu(){
        //My menu options: 1\. Inventory, 2\. Stats, etc... 5\. BACK <- important
        choice = userInput.next();

        if (choice.equals("1")){
            invMenu();
        }else if (choice.equals("5")){
            backSetter();
    }

    public static void invMenu(){
        // Determines current items in inventory and prints them out
        //My menu options: 1\. Back, 2\. Home <- where the problem happens
        choice = userInput.next();

        if (choice.equals("1")){
            mainMenu();
        }else if (choice.equals("2")){
            backSetter();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:08:10.007

是的，这是合法的——这就是[递归](http://en.wikipedia.org/wiki/Recursion)方法的含义。确保您没有无限递归的情况，即确保您的方法最终停止相互调用 - 如果递归最终终止，那么您就可以开始了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:11:30.610

感谢您的帮助，我认为它可能会导致无限循环。是的，如果没有完整的代码，很难发现我哪里出错了。我想将此添加为评论，但字符太多，因此我将其添加为答案。

我一直在研究我的方法，但看不出它是如何陷入无限循环的。调用 Method2 的 Method1 在确定要做什么之前必须接受用户输入。所以如果 Methpd1 调用 Method2，Method2 又调用 Method1，为什么会卡住，因为用户在任何一种方法中都有返回正常游戏的选项。这是我的方法，也许完全看到它可以阐明我哪里出错了。

FantasyGameText.gameText 方法只接受 locID 并输出该位置的对话选项。FantasyGameText.setLocation 方法是设置位置 ID 的实际方法，backSetter 方法只是将它与 gameText 方法结合起来（基本上和我开始游戏的方式相同，xAxis = 0, yAxis = 0，所以 locId = 0，即我游戏的开始部分）。

```
public static void backSetter(){
    if (xAxis == 2 && yAxis == 1){
        backChoice = setLocation(2, 1);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 4 && yAxis == 1){
        backChoice = setLocation(4, 1);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 2 && yAxis == 2){
        backChoice = setLocation(2, 2);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 3 && yAxis == 2){
        backChoice = setLocation(3, 3);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 4 && yAxis == 2){
        backChoice = setLocation(4, 2);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 5 && yAxis == 2){
        backChoice = setLocation(5, 2);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 1 && yAxis == 3){
        backChoice = setLocation(1, 3);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 2 && yAxis == 3){
        backChoice = setLocation(2, 3);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 3 && yAxis == 3){
        backChoice = setLocation(3, 3);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 4 && yAxis == 3){
        backChoice = setLocation(4, 3);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 2 && yAxis == 4){
        backChoice = setLocation(2, 4);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 3 && yAxis == 4){
        backChoice = setLocation(3, 4);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 4 && yAxis == 4){
        backChoice = setLocation(4, 4);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 5 && yAxis == 4){
        backChoice = setLocation(5, 4);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 3 && yAxis == 5){
        backChoice = setLocation(3, 5);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 4 && yAxis == 5){
        backChoice = setLocation (4, 5);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 30 && yAxis == 30){
        backChoice = setLocation(30, 30);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 31 && yAxis == 31){
        backChoice = setLocation(31, 31);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 50 && yAxis == 50){
        backChoice = setLocation(50, 50);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 51 && yAxis == 51){
        backChoice = setLocation(51, 51);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 52 && yAxis == 52){
        backChoice = setLocation(52, 52);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 53 && yAxis == 53){
        backChoice = setLocation(53, 53);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 54 && yAxis == 54){
        backChoice = setLocation(54, 54);
        FantasyGameText.gameText(backChoice);
    }else if (xAxis == 55 & yAxis == 55){
        backChoice = setLocation(55, 55);
        FantasyGameText.gameText(backChoice);
    }else{
        FantasyGameText.gameText(100);
    }
}

public static void menuHome(){
    boolean correctAnswer = false;
    System.out.println("");
    System.out.println("-------- CHARACTER --------");
    System.out.println("1\. Inventory");
    System.out.println("2\. Equip");
    System.out.println("3\. Stats");
    System.out.println("4\. Quests");
    System.out.println("5\. Back");
    while (correctAnswer == false){
        menuChoice = userInput.next();
        System.out.println("");
        if (menuChoice.equals("1") || menuChoice.equalsIgnoreCase("inventory") || menuChoice.equalsIgnoreCase("inv")){
            correctAnswer = true;
            invMenu();
        }else if (menuChoice.equals("2") || menuChoice.equalsIgnoreCase("equip")){
            correctAnswer = true;
            equipMenu();
        }else if (menuChoice.equals("3") || menuChoice.equalsIgnoreCase("stats") || menuChoice.equalsIgnoreCase("statistics")){
            correctAnswer = true;
            statsMenu();
        }else if (menuChoice.equals("4") || menuChoice.equalsIgnoreCase("quests") || menuChoice.equalsIgnoreCase("quest")){
            correctAnswer = true;
            questMenu();
        }else if (menuChoice.equals("5") || menuChoice.equalsIgnoreCase("back") || menuChoice.equalsIgnoreCase("home")){
            correctAnswer = true;
            backSetter();
        }else{
            System.out.println("That is not a valid option, choose again,");
            menuChoice = userInput.next();
            System.out.println("");
        }
    }
return;
}

public static void invMenu(){
    boolean correctAnswer = false;
    int invList[] = new int[50];
    int itemAmount[] = new int[50];
    for (int i = 0; i <= 3; i++){
        if (healthPotionAmount > 0){
            invList[0] = 1;
            itemTempName[0] = "Health Potion x ";
            itemAmount[0] = healthPotionAmount;
        }else{
            invList[0] = 0;
        }
        if (rustySwordAmount > 0){
            invList[1] = 1;
            itemTempName[1] = "Rusty Sword x ";
            itemAmount[1] = rustySwordAmount;
        }else{
            invList[1] = 0;
        }
        if (ragsBodyAmount > 0){
            invList[2] = 1;
            itemTempName[2] = "Rags x ";
            itemAmount[2] = ragsBodyAmount;
        }else{
            invList[2] = 0;
        }
        if (chainBodyAmount > 0){
            invList[3] = 1;
            itemTempName[3] = "Chainmail Armor x ";
            itemAmount[3] = chainBodyAmount;
        }else{
            invList[3] = 0;
        }
    }
    for (int i = 0; i <= 3; i++){
        if (invList[i] > 0){
            System.out.println(itemTempName[i] + itemAmount[i]);
        }else if (invList[0] == 0 && invList[1] == 0 && invList[2] == 0 && invList[3] == 0){
            System.out.println("You have no items.");
        }
    }
    System.out.println("");
    System.out.println("1\. Back");
    System.out.println("2\. Home");
    menuChoice = userInput.next();
    System.out.println("");
    while (correctAnswer == false);
    if (menuChoice.equals("1") || menuChoice.equalsIgnoreCase("back") || menuChoice.equalsIgnoreCase("b")){
        correctAnswer = true;
        menuHome();
    }else if (menuChoice.equals("2") || menuChoice.equalsIgnoreCase("home") || menuChoice.equalsIgnoreCase("h")){
        correctAnswer = true;
        backSetter();
    }else{
        System.out.println("That is not a valid option, choose again.");
        menuChoice = userInput.next();
        System.out.println(""); 
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T02:13:46.227

Yes, this is pretty much an example of recursion. It won't create any errors. But, because it's recursive, it may cause an infinite loop if their is no way of getting to a base case state. In a case like this where methods call each other and the recursion isn't evident at first glance, an infinite loop is a lot more likely.

It might not be a bad idea to somehow isolate that recursion so it is a lot more evident, making the code cleaner, and easier to maintain.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T02:14:20.330

是的，这是合法的，但这是一个非常糟糕的设计。递归菜单调用会给你带来一些麻烦。我觉得返回会更好，但是我不知道这段代码的上下文。

```
public static void invMenu(){
    // Determines current items in inventory and prints them out
    //My menu options: 1\. Back, 2\. Home <- where the problem happens
    choice = userInput.next();

    if (choice.equals("1")){
       return;
    }else if (choice.equals("2")){
        backSetter();
    }
} 
```

如果你打算这样做，你需要调整主菜单的代码来处理返回（即某种循环）。

# c - C malloc 错误释放结构

> ID：15939553
> 
> 赞同：1
> 
> 时间：2013-04-11T02:05:44.207
> 
> 标签：c, memory-management, struct, malloc, free

我刚刚重新开始学习 C，但我真的对一些内存管理细节感到困惑。我越来越

> 被释放的指针未被分配...中止陷阱

对于下面的代码。我**真的**需要每个 malloc 1 个免费的吗？为什么我的代码是错误的？
谢谢！

```
#define N 9

typedef struct
{
  int MAX_LIST_SIZE;
  int length;
  int *ini;
}List;

/* allocates new List and its data */
List *newList(int size)
{
    List *list = malloc(sizeof(List));
    list->MAX_LIST_SIZE = size;
    list->length = 0;
    list->ini = malloc(sizeof(int) * size);

    return list;
}

/* add some value to the list */
void addList(List *list, int val)
{
    if (list->length < list->MAX_LIST_SIZE)
        list->ini[list->length++] = val;
    else
        fprintf(stderr, "Error: add(): List is full.\n");
}

/* get an array of N*N lists malloc-ed Lists */
List *gridList()
{
    int i, j;
    List *cells = malloc(sizeof(List) * N * N);

    for (i = 0; i < N * N; i++)
    {
      /* malloc is called inside NewList()*/
      cells[i] = *newList(N);
      for (j = 0; j < N; j++)
          addList(&cells[i], j + 1);
    }

    return cells;
}

/* inside main */
List *cells = gridList();

/* use cells ... */

/* free */
for (i = 0; i < N * N;  i++)
{
    free(cells[i].ini);
    /* line below causes CRASH */
    free(&cells[i]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:18:17.023

你做 ：

```
cells[i] = *newList(N); 
```

它将每个元素设置`cells`为由 动态分配的列表的副本`newList`。所以`newList`动态分配一个列表，然后你将指针指向动态分配的`List`，取消引用它，然后将它复制到`cells[i]`. 因此，稍后当您转到`free()`每个元素时：

```
free(&cells[i]); 
```

它不起作用，因为其中的每个元素`cells[i]`都是`List`，而不是`List *`由 分配的（列表指针）`malloc()`。

所以你有两个选择。一个（坏的）是删除最后`free()`一行，因为没有什么可以释放的。但是，这只是掩盖了一个更大的问题，即您现在有内存泄漏，因为您无法返回并释放使用`List`创建的动态分配的 s `newList()`。

相反，您可能想要一个指向列表的指针数组，您可以通过将其更改为：

```
List **cells = malloc(sizeof(List*) * N * N); 
```

所以`cells[i]`指的是一个`List *`. `newList()`返回这样一个指针，因此您可以将该行更改为：

```
cells[i] = newList(N); 
```

同样，`addList()`需要这样一个指针，因此您只需将该行更改为：

```
addList(cells[i], j + 1); 
```

因为`&cells[i]`会将指针的地址传递给它，这不是你想要的。

最后，将自由语句更改为：

```
free(cells[i]->ini); // ->init because cells[i] is now a pointer to a List, List *
free(cells[i]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:15:14.723

问题是您正在分配一个列表数组，将列表的全部内容复制到数组元素中，然后尝试释放它们。原始分配的 List 记录是内存泄漏，并且 free 调用确实试图释放未 malloc 的内存（或者更准确地说是 malloc 在一个大块中）。

你想要一个指向指针的数组来保存你的列表：

```
/* get an array of N*N lists malloc-ed Lists */
List **gridList()
{
    int i, j;
    // VV note change here
    List **cells = malloc(sizeof(List*) * N * N); 

    for (i = 0; i < N * N; i++)
    {
        /* malloc is called inside NewList()*/
        cells[i] = newList(N); // << Note change here.
        for (j = 0; j < N; j++)
            addList(cells[i], j + 1);
    }
    return cells;
}

/* free */
for (i = 0; i < N * N;  i++)
{
    free(cells[i]->ini); // << and here
    /* line below causes CRASH */
    free(cells[i]); // << and here
}
free(cells); 
```

# node.js - 堆栈如何在 NodeJs 上工作？

> ID：15939555
> 
> 赞同：0
> 
> 时间：2013-04-11T02:06:39.747
> 
> 标签：node.js

我最近开始阅读 NodeJS（和 JS），对回调在 NodeJs 中的工作方式有点困惑。假设我们做这样的事情：

```
setTimeout(function(){
    console.log("World");
},1000);
console.log("Hello"); 
```

*输出：“你好世界”*

到目前为止，我读到**的 JS 是单线程的，所以事件循环通过一个大堆栈，并且我还被告知不要在回调函数中放置大调用。**

1)

好的，所以我的第一个问题是假设它的一个堆栈回调函数是否由主事件循环线程运行？如果是这样，那么如果我们有一个站点通过回调（从数据库获取并推送请求）提供内容，并且我们有 1000 个并发，那么这 1000 个用户基本上是同步服务的，主线程在每个回调函数中执行计算然后继续主事件循环？如果是这种情况，这究竟是如何并发的？

2）如何将回调函数添加到堆栈中，所以可以说我的代码如下所示：

```
setTimeout(function(){
    console.log("Hello");
},1000);
setTimeout(function(){
    console.log("World");
},2000); 
```

那么回调函数是否会在超时发生之前添加到堆栈中？如果是这样，是否设置了一个标志来通知主线程回调函数已准备好（或者是否有另一种机制）。如果这确实是正在发生的事情，它不仅会使堆栈膨胀，尤其是对于具有回调函数的大型 Web 应用程序，而且堆栈越大，运行所需的时间就越长，因为线程必须单步执行整个事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:09:31.863

回调函数不会添加到调用者堆栈中。这里没有递归。它们是从事件循环中调用的。尝试`console.log`在您的示例中替换并观察结果 - 堆栈没有增长。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:38:12.987

事件循环不是堆栈。最好将其视为队列（先进/先出）。最常见的用途是执行 I/O 操作。

假设您想从磁盘读取文件。你先说嘿，我想读这个文件，当你读完之后，调用这个回调。当实际的 I/O 操作在一个单独的进程中执行时，Node 应用程序可以自由地继续做其他事情。当文件完成读取时，它会在事件循环的队列中添加一个项目以指示完成。节点应用程序可能仍在忙于做其他事情，或者可能有其他项目等待首先出列，但最终我们的完成通知将被节点的事件循环出列。它将与我们的回调匹配，然后回调将按预期调用。当回调返回时，事件循环将下一个项目出列并继续。当节点的事件循环中没有任何内容时，应用程序退出。

*这是事件循环如何工作的粗略近似，而不是精确的技术描述。*

对于特定`setTimeout`情况，可以将其视为优先级队列。*至少在*该时间过去之前，节点不会考虑将项目/作业/回调出队。

有很多关于 Node/JavaScript 事件循环的精彩文章，如果您感到困惑，您可能想阅读这些文章。

# c - C 传递和指针

> ID：15939556
> 
> 赞同：-4
> 
> 时间：2013-04-11T02:07:00.687
> 
> 标签：c, function, pointers, pass-by-reference, pass-by-value

所以我正在编写这个程序，我不知道如何通过引用或值传递。我只需要将值从一个函数（processFile）传递给另一个函数（printReport）。任何有关如何做到这一点的帮助将不胜感激。

```
#include <stdio.h>
#include <stdlib.h>

void printInstructions();
int processFile(FILE *fileIn);
void printReport();

int main(void)
{
   FILE *fileIn;
   int words = 0,
        lines = 0,
        characters = 0,
        sentences = 0;

   printInstructions();

   fileIn = fopen("input09.txt", "r");

   if(fileIn == NULL)
      printf("\n\nERROR\n\n");

   processFile(fileIn);

   printReport(words, lines, characters, sentences);

}

void printInstructions()
{
   printf("\n  Program reads a file and returns the number of  \n");
   printf("lines, words, characters, and sentences in the file.\n\n");

   return;
}

int processFile(FILE *fileIn)
{
        int sentences = 0,
             words = 0,
             lines = 0,
             characters = 0,
             ch;

   while(ch != EOF)
   {
            ch = fgetc(fileIn);

            if(ch == '\n' || ch == 60)
                    lines++;

            if(ch == '.')
                    sentences++;

            if(ch != '.' || ch != ' ' || ch != '\n')
                    characters++;

            if(ch == ' ')
                    words++;
   }

   return 0;
}

void printReport()
{
   printf("This file contains NUMBER lines.\n");
   printf("This file contains NUMBER words.\n");
   printf("This file contains NUMBER    characters.\n");
   printf("This file contains NUMBER sentences.\n\n");

   return;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:14:10.887

如果你想在你的函数中从 FILE 中读取，你已经做对了。

FILE *fileIn 指向堆栈上的某个内存块。基本上它是一个数字。当您将该“数字”传递给另一个函数时，您仍然指向同一事物，因此您可以编辑您所指向的内容。

但是，如果您使 fileIn 指向函数中的其他内容。例如：`fileIn = null;`您必须将 fileIn 作为双指针传递。它必须像这样有 2 个 * `void foo(FILE **bar)`：.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:15:24.313

您可以首先定义一个数据结构来保存给定句子的所有统计信息

```
typedef struct stats {
    int words;
    int lines;
    int characters;
    int sentences;
}stats; 
```

主要是，您可以创建此数据结构的对象

```
struct stats stats_obj; 
```

要从中检索统计信息`processFile`，您可以将对此对象的引用传递为

```
processFile(fileIn, &stats_obj); 
```

在`processFile`中，在处理结束时，您可以将结果存储为

```
stats_obj->words = words;
stats_obj->lines = lines;
......... 
```

返回后`processFile`，您可以将相同的内容传递给`printReport`as`printReport(stats_obj)`并在此函数中打印相同的内容

```
void printReport(struct stats stats_obj)
{
    printf("This file contains %d lines.\n", stats_obj.lines);
    printf("This file contains %d words.\n" , stats_obj.words);
    printf("This file contains %d characters.\n", stats_obj.characters);
    printf("This file contains %d sentences.\n\n", stats_obj.sentences);

    return;
} 
```

**注意：**始终建议检查输出，`fopen`因此您必须在之后插入`NULL`检查`fileIn``fileIn = fopen("input09.txt", "r");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T02:17:59.123

你可以这样做：

```
int main(void)
{
  ...
  int sentences = 0,
         words = 0,
         lines = 0,
         characters = 0,
         ch;

  processFile(fileIn, &words, &lines, &characters, &sentences);

  printReport(words, lines, characters, sentences);
}

int processFile(FILE *fileIn, int *pWords, int *pLines, 
                              int *pLines, int *pSentences)
{
       ...
       *pLines++;
       *pSentences++;
       *pCharacters++;
       *pWords++;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T02:21:31.797

尝试更改为：

```
int processFile(FILE *fileIn, int *sentences, int *words, int *lines, int *characters)
{
    int ch;
    ...

        if(ch == '\n' || ch == 60)
                *lines++;
    ...

int main(void)
{
    ...
    processFile(fileIn, &sentences, &words, &lines, &characters);
    ... 
```

因此，在此更改中，该函数`processFile`现在按指针接收四个参数。当您访问这些参数时，使用（例如）`*lines`取消引用指针。

在`main()`中，当您调用 时`processFile()`，您将地址传递给您的参数。

希望这可以帮助; 我认为您想了解 C/C++ 中的参数传递（按值传递、按指针传递和按引用传递——您可能想在 Google 上搜索这些术语）。

# android - 如何让 ViewPager 经常更新？

> ID：15939557
> 
> 赞同：5
> 
> 时间：2013-04-11T02:07:41.450
> 
> 标签：android, viewpagerindicator, android-pageradapter

我遇到了`ViewPager`Class 的问题，我有三个页面，每个页面都有一个`scrollView`，Relative Layout 和 ImageView 里面。

单击 ImageView 时，我需要设置彩色背景。我的问题是：当我单击一个`ImageView`以使其以颜色为背景时，背景颜色出现`ImageView`在另一个 PagerView 页面中的另一个上...

例如：我有四个页面，每个页面都加载了一个`ImageView`，当我单击第一页中的第一个 ImageView 时，第二`ViewPager`页中的 ImageView 将获得背景颜色..

我需要让我`ImageView`的第一页（在第一页）被背景着色..

这是代码...这是我的寻呼机适配器类

```
 public class ViewPagerAdapter extends PagerAdapter {
        private DataSetObserver mObserver;
        ImageView image,image2;
        Activity activity;
        int imageArray[];
        Point p;

        public ViewPagerAdapter(Activity act, int[] imgArra) {
            imageArray = imgArra;
            activity = act;
        }

        @Override
        public int getItemPosition(Object object) {
            // TODO Auto-generated method stub
            return super.getItemPosition(object);
        }

        public int getCount() {
            return imageArray.length;
        }

        public Object instantiateItem(View collection, int position) {
            int fff=PageIndicatorActivity.myPager.getCurrentItem();
            Toast.makeText(activity, String.valueOf(fff), 5000).show();

            ScrollView view = new ScrollView(activity);

            RelativeLayout container = new RelativeLayout(activity);

             image = new ImageView (activity);
             image2=new ImageView(activity);
             image.setId(1);

            // Parameters
            LayoutParams container_params = new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);
            LayoutParams content_params = new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
            RelativeLayout.LayoutParams contents_paramw = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
            contents_paramw.addRule(RelativeLayout.BELOW, image.getId());

            view.setLayoutParams(container_params);

            container.setLayoutParams(container_params);

           image.setLayoutParams(content_params);
            image2.setLayoutParams(contents_paramw);

            image2.setImageResource(R.drawable.aya3);
            image.setImageResource(R.drawable.aya2);
            // i.setim(imageArray[position]);

        /*  ImageView vv=(ImageView)collection.findViewById(R.id.imageView1);
        vv.setImageResource(R.drawable.aya2);
            TextView view = new TextView(activity);
            view.setTextIsSelectable(true);
            view.setTextSize(30);
            view.setTextColor(Color.BLUE);

            view.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,
                    LayoutParams.FILL_PARENT));
            //view.setScaleType(ScaleType.FIT_XY);
            view.setText(imageArray[position]);
            ((ViewPager) collection).addView(view, 0);
            */
            container.addView(image);

            container.addView(image2);
            view.addView(container);

            image.setOnClickListener(new OnClickListener() {
                @Override
                public void onClick(View v) {
                    int location[] = new int[2];
//Here is the problem
                   image.setBackgroundColor(Color.RED);
//=======================================================
                   image.setTag("1");
                   image.getLocationOnScreen(location);
                   p = new Point();
                   p.x = location[0]-600;
                   p.y = location[1]+30;
                  // Toast.makeText(activity, String.valueOf(location[0]), 5000).show();
                  // Toast.makeText(activity, String.valueOf(location[1]), 5000).show();
                  showPopup(activity, p);

               notifyDataSetChanged();
                }
            });
            image2.setOnClickListener(new OnClickListener() {
                @Override
                public void onClick(View v) {
                    int location[] = new int[2];

    //Here is the problem
                   image2.setBackgroundColor(Color.RED);
//=======================================================
                   image.getLocationOnScreen(location);
                   p = new Point();
                   p.x = location[0]-600;
                   p.y = location[1]+100;
                 //  Toast.makeText(activity, String.valueOf(location[0]), 5000).show();
                   //Toast.makeText(activity, String.valueOf(location[1]), 5000).show();
                  showPopup(activity, p);

                   notifyDataSetChanged();
                }
            });
            //container.addView(text);
            //container.addView(image);
            ((ViewPager) collection).addView(view,0);

            return view;
        }

        @Override
        public void destroyItem(View arg0, int arg1, Object arg2) {
            //Toast.makeText(activity.getApplicationContext(), String.valueOf(arg1), 5000).show();
            ((ViewPager) arg0).removeView((ScrollView) arg2);
        }

        @Override
        public boolean isViewFromObject(View arg0, Object arg1) {

            return arg0 == ((ScrollView) arg1);
        }

        @Override
        public Parcelable saveState() {
            return null;
        }

        @Override
        public void notifyDataSetChanged() {
            // TODO Auto-generated method stub
            super.notifyDataSetChanged();
             if (this.mObserver != null)
                  this.mObserver.onDataSetChanged();
              }

        @Override
        public void startUpdate(ViewGroup container) {
            // TODO Auto-generated method stub
            super.startUpdate(container);
        }

        static abstract interface DataSetObserver
          {
            public abstract void onDataSetChanged();
          }

        private void showPopup(final Activity context, Point p) {
               int popupWidth = 560;
               int popupHeight = 80;

               // Inflate the popup_layout.xml
               LinearLayout viewGroup = (LinearLayout) context.findViewById(R.id.popup);
               LayoutInflater layoutInflater = (LayoutInflater) context
                 .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
               View layout = layoutInflater.inflate(R.layout.popup_layout, viewGroup);

               // Creating the PopupWindow
               final PopupWindow popup = new PopupWindow(context);
               popup.setContentView(layout);
               popup.setWidth(popupWidth);
               popup.setHeight(popupHeight);
               popup.setFocusable(true);

               // Some offset to align the popup a bit to the right, and a bit down, relative to button's position.
               int OFFSET_X = 30;
               int OFFSET_Y = 30;

               // Clear the default translucent background
               popup.setBackgroundDrawable(new BitmapDrawable());

               // Displaying the popup at the specified location, + offsets.
               popup.showAtLocation(layout, Gravity.NO_GRAVITY, p.x + OFFSET_X, p.y + OFFSET_Y);

               // Getting a reference to Close button, and close the popup when clicked.
               ImageButton close = (ImageButton) layout.findViewById(R.id.tashgheel);
               close.setOnClickListener(new OnClickListener() {

                 @Override
                 public void onClick(View v) {
                   popup.dismiss();
                 }
               });
            }
    } 
```

希望大家帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T07:13:52.653

试试这个代码，它工作正常，

```
final ImageView image = new ImageView (activity);
final ImageView image2=new ImageView(activity); 
```

在里面`instantiateItem(View collection, int position)`，因为您在视图寻呼机上使用的每个页面都有相同的图像，所以结果集中在最后启动的页面上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T08:04:55.527

@Sino Raj 即使可行，这也不是正确的方法。

试试这个 Declare `ImageView`image,image2 local inside`instantiateItem`方法并在里面`setOnClickListener`将行更改`image.setBackgroundColor(Color.RED)`为`v.setBackgroundColor(Color.RED)`

# algorithm - 无向图中的桥确定

> ID：15939558
> 
> 赞同：1
> 
> 时间：2013-04-11T02:07:48.650
> 
> 标签：algorithm, graph, graph-algorithm, bridge

我需要在 O(V+E) 时间内确定无向图中的所有关键边。根据我的发现，我需要使用修改后的 DF 搜索，但我发现的所有伪代码算法都有我不理解的 low[v] 和 d[v]。有人可以向我解释一下 O(V+E) 桥确定算法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-13T02:10:55.167

我会故意保持非正式的讨论。随意询问您是否认为某些索赔不成立或需要更多详细信息。我希望我不会说得太啰嗦。如果我这样做，我会稍微压缩一下小说......

## 基本

该算法由一系列 DFS 遍历组成，同时在图的顶点上保持状态。反复地，选择一个算法之前没有访问过的起始顶点，并从这个节点开始一个DFS。假设`v`是在这个 DFS 期间遇到的某个节点。让“部分 DFS 植根于`v`”成为 DFS 遍历的一部分，从第一次访问开始，到最后一次访问结束`v`。对某个节点的“访问”要求遍历的最后一条边是树边。对某个边缘的“访问”意味着它在 DFS 过程中的第一次遍历。

两个基本观察：

1\. 会有精确的`k`DFS 搜索，`k`连接组件的数量在哪里。

2.在无向图的DFS中，只有树边和后边，没有前边和交叉边。

在无向图中，所有入射到顶点的边都是“外”边，即。可在 DFS 中遍历。因此，在连通分量#i 中的 DFS 搜索中的任何时候，遇到的任何顶点要么根本没有被访问过，要么位于当前的 DFS 树路径上。DFS 到达所述顶点的边因此分别是树边或后边，但永远不能是前边或交叉边。

## 信息集

该算法维护以下关于顶点的信息。首先，让顶点状态为以下三个类别之一：

*   `unseen`: 顶点还没有被访问过。
*   `active`: 顶点已经被访问过，至少有一个但不是所有的入射边都被访问过。
*   `done`：已访问顶点及其所有入射边。该顶点将永远不会被再次访问。

这些定义暗示每个顶点在算法过程中将其状态从`unseen`结束`active`更改为结束`done`。维护顶点处理状态的另外两个方面：

*   `depth`：顶点到当前 DFS 根的树路径距离。
*   `minseen`：在以顶点为根的部分 DFS 期间遇到的最小顶点“深度”。

`depth`并且`minseen`对于处于未见状态的顶点是未定义的。转动时`active`，`depth`顶点的 将被设置并且不再改变。`minseen`将被设置为`depth`并可能在此顶点保留时更改`active`。进入状态后`done`，顶点看不到其`minseen`属性的更多变化。

`minseen`根据以下规则更新。

`w`当从to回溯（即在根的部分 DFS 搜索完成`v`后从节点返回`w`到）时，设置为 和 的较小值，即设置为到目前为止在 的部分 DFS期间访问的任何节点之间的最近距离。`v``w``v.minseen``v.minseen``w.minseen``v`

## 桥梁检测

如果`e=(u,v)`是当前 DFS 中的一个桥，则部分 DFS`v`在任何时候都不会到达比 更接近 DFS 根的顶点`u`。因此，当节点状态从变为`v`后立即离开时，该节点的属性将等于。由于状态变化，我们知道这两个值都不会再次改变。因此是一座桥梁。`active``done``minseen``depth``e`

切换视角，如果在`v`以`active`节点为根的部分 DFS 期间的任何时候`z`，在当前 DFS 的根和（`u`其`depth`值因此小于' `u`s 和DFS 的过程定义了最终值的上限- 所以当 DFS 最后一次离开时它不能相等，表明这不是一座桥。`v``z.depth``v``v.minseen``v.depth``v``e`

## 复杂

所有顶点都按预定顺序检查一次。当`unseen`遇到顶点时，DFS 开始以该顶点为根。当它结束时，这个根被标记`done`并继续检查，直到`unseen`找到下一个顶点，依此类推。
->`O(V)`

由于遍历是标准的 DFS，每条边最多被遍历两次（如果是树边则两次，否则一次）。
->`O(E)`

->`O(V+E)`

所有其他步骤都转化为恒定数量的操作。

# sprockets - 这是 minitest、sprockets-rails 或 ruby -2 中的错误吗？

> ID：15939565
> 
> 赞同：1
> 
> 时间：2013-04-11T02:08:14.083
> 
> 标签：sprockets, testunit, minitest, ruby-on-rails-4, ruby-2.0

我想修补 sprockets-rails 中的一个错误，但是当我运行测试套件（使用 ruby​​-2.0.0-p0 和 ruby​​-head）时，出现以下错误：

```
/Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:707:in `block in _prepare_run': undefined method `size' for #<ParallelEach:0x007f823aa55e88> (NoMethodError)
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:707:in `each'
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:707:in `inject'
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:707:in `_prepare_run'
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:648:in `_run_suites'
    from /Users/btaitelb/.rvm/gems/ruby-head@rails-dev/gems/minitest-4.7.1/lib/minitest/unit.rb:861:in `_run_anything'
    from /Users/btaitelb/.rvm/gems/ruby-head@rails-dev/gems/minitest-4.7.1/lib/minitest/unit.rb:1068:in `run_tests'
    from /Users/btaitelb/.rvm/gems/ruby-head@rails-dev/gems/minitest-4.7.1/lib/minitest/unit.rb:1055:in `block in _run'
    from /Users/btaitelb/.rvm/gems/ruby-head@rails-dev/gems/minitest-4.7.1/lib/minitest/unit.rb:1054:in `each'
    from /Users/btaitelb/.rvm/gems/ruby-head@rails-dev/gems/minitest-4.7.1/lib/minitest/unit.rb:1054:in `_run'
    from /Users/btaitelb/.rvm/gems/ruby-head@rails-dev/gems/minitest-4.7.1/lib/minitest/unit.rb:1042:in `run'
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:21:in `run'
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:774:in `run'
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:834:in `run'
    from /Users/btaitelb/.rvm/rubies/ruby-head/lib/ruby/2.1.0/test/unit.rb:838:in `run'
    from /Users/btaitelb/.rvm/rubies/ruby-head/bin/testrb:7:in `<main>' 
```

我不清楚 Test::Unit 和 MiniTest 之间的关系，特别是因为我看到 test/unit.rb 引用 MiniTest::Unit

我可以通过几种方式修复这个问题，但我不确定应该归咎于哪个项目（例如我应该在哪里提交补丁）：

1.  在 ruby​​ 的 test/unit.rb 中，我可以将调用替换为`size`调用 to `count`，但这仅在`Test::Unit`期望成为`ParallelEach`测试套件的一部分时才合适
2.  在 minitest 中，我可以别名`count`为`size`，如果 minitest 负责将`ParallelEach`对象发送到`Test::Unit`

这些中的任何一个是否合适，还是这里发生了其他事情（比如命名冲突）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-04T11:31:11.783

原来这是 minitest 中的一个错误，此后已修复：[https ://github.com/seattlerb/minitest/pull/275](https://github.com/seattlerb/minitest/pull/275)

# django - 如何将 DetailView 传递给 url 中的“slug”？

> ID：15939567
> 
> 赞同：0
> 
> 时间：2013-04-11T02:08:43.270
> 
> 标签：django, python-2.7, django-urls, django-class-based-views, django-1.4

如何将[DetailView](https://docs.djangoproject.com/en/1.4/ref/class-based-views/#django.views.generic.detail.DetailView)传递给 url 中的“slug”？

首先，让我们看看我的代码。

网址.py

```
from django.conf.urls import patterns, include, url

urlpatterns = patterns('',
    url(r'^customer/(?P<slug>[^/]+)/$', customerDetailView.as_view()),
) 
```

视图.py

```
from django.views.generic import DetailView

class customerDetailView(DetailView):
    context_object_name = 'customerDetail'
    template_name = "customerDetail.html"
    allow_empty = True
    model = Customer
    slug_field = 'name' # 'name' is field of Customer Model 
```

现在，我的代码就像上面一样。

我想更改如下代码。

网址.py

```
from django.conf.urls import patterns, include, url

urlpatterns = patterns('',
    url(r'^customer/(?P<slug>[^/]+)/$', customer),
) 
```

视图.py

```
from django.views.generic import DetailView

class customerDetailView(DetailView):
    context_object_name = 'customerDetail'
    template_name = "customerDetail.html"
    allow_empty = True
    model = Customer
    slug_field = 'name' # 'name' is field of Customer Model

def customer(request, slug):
    if request.method == "DELETE":
        pass # some code blah blah
    elif request.method == "POST"
        pass
    elif request.method == "GET":
        return customerDetailView.as_view(slug=slug)(request) # But this line is not working... just causing error TypeError, customerDetailView() received an invalid keyword 'slug' 
```

如您所知，DetailView 需要“slug”或“pk”...所以我必须将“slug”交付给 DetailView...但我不知道如何交付“slug”...

我在显示器前等你的答案...

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T02:40:00.940

正确的方法应该是

```
return customerDetailView.as_view()(request, slug=slug) 
```

# c++ - 从文件读取和存储数据时，每隔一行数据都会被跳过

> ID：15939568
> 
> 赞同：0
> 
> 时间：2013-04-11T02:08:44.280
> 
> 标签：c++, file, lines, getline

我是 C++ 新手，在从文本文件中读取数据行时遇到了一些麻烦。假设我在文本文件中有未知数量的行，每一行的格式相同： int string double 。唯一可以确定的是空格将分隔给定行上的每条数据。我正在使用结构数组来存储数据。下面的代码效果很好，只是它在每个循环后跳过了一行输入。我尝试插入各种 ignore() 语句，但仍然无法让它读取每一行，只能读取隔行。如果我在最后重写了一些 getline 语句，那么在第一个循环之后开始为变量存储错误的数据。

文本文件可能如下所示：

```
18 JIMMY 71.5
32 TOM 68.25
27 SARAH 61.4

//code
struct PersonInfo
{
    int age;
    string name;
    double height;
};
//..... fstream inputFile; string input;

PersonInfo *people;
people = new PersonInfo[50];

int ix = 0;
getline(inputFile, input, ' ');
while(inputFile)
{
    people[ix].age = atoi(input.c_str());
    getline(inputFile, input, ' ');
    people[ix].name = input;    
    getline(inputFile, input, ' ');
    people[ix].height = atof(input.c_str());

    ix++;

    getline(inputFile, input, '\n');
    getline(inputFile, input, ' ');
} 
```

我确信有更高级的方法可以做到这一点，但就像我说的那样，我对 C++ 还是很陌生，所以如果对上面的代码稍作修改，那就太好了。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:15:09.907

您可以按如下方式读取文件：

```
int ix = 0;
int age = 0;
string name ="";
double height = 0.0;
ifstream inputFile.open(input.c_str()); //input is input file name

while (inputFile>> age >> name >>  height)
{
  PersonInfo p ={age, name, height};
  people[ix++] = p;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T02:16:27.220

你把整个代码弄得复杂得离谱。

```
struct PersonInfo
{
    int age;
    string name;
    double height;
};

std::vector<PersonInfo> people;
PersonInfo newPerson;
while(inputFile >> newPerson.age >> newPerson.name >> newPerson.height)
    people.push_back(std::move(newPerson)); 
```

您的问题是因为首先您从文件中一次读取一个数据，然后从文件中读取一整行，然后再次从文件中一次读取每个数据。也许你的意图更像是这样？

```
std::string fullline;
while(std::getline(inputFile, fullline)) {
    std::stringstream linestream(fullline);
    std::getline(linestream, datawhatever);
    ....
} 
```

顺便说一句，更惯用的代码可能看起来更像这样：

```
std::istream& operator>>(std::istream& inputFile, PersonInfo& newPerson) 
{return inputFile >> newPerson.age >> newPerson.name >> newPerson.height;}

{ //inside a function
    std::ifstream inputFile("filename.txt");

    typedef std::istream_iterator<PersonInfo> iit;
    std::vector<PersonInfo> people{iit(inputFile), iit()}; //read in
} 
```

[证明它在这里有效](http://coliru.stacked-crooked.com/view?id=a8100d3f3891aca346f34c43c8bd7a71-50d9cfc8a1d350e7409e81e87c2653ba)

# c# - 实体框架中的接口未按预期工作生成部分类

> ID：15939571
> 
> 赞同：1
> 
> 时间：2013-04-11T02:09:25.583
> 
> 标签：c#, .net, .net-4.0, entity-framework-4

我在 Entity Framework 4.0、.NET 4.0 中处理的项目有问题。

我走的是模型第一路线。

我一直在创建我的模型，并且刚刚通过右键单击我的模型设计器然后单击**添加代码生成项来生成部分类...**

然后我创建了一些像这样的部分类：

**编辑**：这些都与生成的类在同一个命名空间中。

```
public partial class Foo : IFoo{
}

public partial class Bar : IBar{
}

public partial class SomethingElse : ISomethingElse{
} 
```

我查看了生成的实体框架代码，**Foo**具有属性**Bar**和**SomethingElse**，它们是实体框架生成的类型。

以下是**IFoo**接口的设置方式：

```
public interface IFoo{

  IBar Bar {get; set;}
  ISomethingElse SomethingElse {get; set;}

} 
```

**编辑**：接口与实体框架类位于不同的类库中。

我的问题是编译器抱怨 Foo 没有实现接口 IFoo。

我真的很困惑发生了什么。

如果有人能对此有所了解，那就太好了。我有一种感觉，我只是错过了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:20:26.697

据我了解，问题是该类`Foo`具有返回类型的属性`Bar`，但您要求实现具有返回类型的属性`IBar`。您可以尝试通过显式实现来解决它：

```
public partial class Foo : IFoo
{
     IBar IFoo.Bar 
     {
        get { return ((Foo)this).Bar }
        set { ((Foo)this.Bar) = (Bar)value; }
     }    
} 
```

# javascript - 集合更改时更新主干视图

> ID：15939572
> 
> 赞同：1
> 
> 时间：2013-04-11T02:09:28.707
> 
> 标签：javascript, backbone.js, requirejs

当我的 Backbone 应用程序的第一页加载时，我会获取一个集合，然后对其进行迭代以呈现页面：

页面路由器：

```
 home: function ()
    {
        new BodyView ({page:'home'});

        new HomeView();
        new PostView();

        postCollection = new PostCol({userId:getId(),start:0,offset:50});
        postCollection.fetch();
        postView = new Post({collection:postCollection});

    }, 
```

帖子视图：

```
 el:'.stream',
    initialize: function ()
    {
        this.collection.on('reset',this.render.bind(this));
        this.collection.on ('change',this.render.bind (this));
    },
    render: function ()
    {
        this.collection.each (function (model)
        {
            actor = new Actor ({model:model});
            this.$el.append (actor.render().el);
        },this);
        return this;
    }, 
```

我现在想要完成的是，当用户在另一个视图中保存一些数据时，它会更新 Post 视图。这就是我所做的，但它不起作用。

其他观点：

```
 post = new PostModel ({userid:getId(),post:postText,objectid:0});
            post.save({},
            {
                success: function (response)
                {
                    postCol = new PostCol ({userId:getId(),start:0,offset:50});
                    postView = new Post ({collection:postCol});
                    postCol.fetch ().success({change:true});
                },
                error: function (response)
                {
                    console.log (response);
                }
            }
            ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T04:24:30.657

看起来您`postCollection`是全球性的，因此您可以更新现有模型而不是创建新模型。

```
// find existing model in the collection.
var post = postCollection.get(getId());
// save model with updated info.
    post.save({post:postText},
    {
        success: function (response)
        {
            // if the save succeeded, the Post view will re-render,
            // since you are listening for the 'change' event.
            // so here, you don't really need to do anything.
        },
        error: function (response)
        {
            console.log (response);
        }

    ); 
```

除了`this.collection.on ('change',this.render.bind (this));`在 Post 视图中，您可以在单个 Actor 视图中执行此操作，因此整个集合不会重新渲染。

```
this.model.on ('change',this.render, this); // 'this' as third parameter replaces the `bind` 
```

# css - 按钮的高度增加 1px 以减小字体大小

> ID：15939574
> 
> 赞同：1
> 
> 时间：2013-04-11T02:09:47.350
> 
> 标签：css, twitter-bootstrap

我正在使用 twitter bootstrap 创建一个按钮组。当我将较小类的字体大小更改为 12px（默认为 14px）时，左侧按钮的高度增加了 1px。我怎样才能避免它？由 Chrome 26、Firefox 20 检查。

```
<div class="btn-group">
  <button class="btn">
    Foo
    <div class="smaller" style="font-size: 12px;">
      Smaller
    </div>
  </button>
  <button class="btn">
    Bar
  </button>
</div> 
```

示例可在[http://jsfiddle.net/kawachi/xkP9j/](http://jsfiddle.net/kawachi/xkP9j/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:18:00.797

设置`line-height`也

[http://jsfiddle.net/xkP9j/5/](http://jsfiddle.net/xkP9j/5/)

```
<div class="smaller" style="font-size: 12px;line-height: 12px;">
   Smaller
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T02:21:50.470

问题是行高。您需要从中删除`line-height`属性，`.btn`或者需要将其添加到`div.smaller`以匹配`font-size`

# php - Zend Navigation - 如果孩子处于活动状态，则标记父母处于活动状态

> ID：15939577
> 
> 赞同：3
> 
> 时间：2013-04-11T02:09:58.477
> 
> 标签：php, zend-framework, twitter-bootstrap, zend-navigation

我目前正在使用 Zend Framework 1.12.3 创建我的新网站，我看到了一些我讨厌 Zend Navigation 的地方：

> 当子路由处于活动状态时（例如：博客单篇文章 route `blog-post`），它不会将父页面（`blog`在这种情况下为路由）标记为活动。

这是我的代码：（navigation.xml）

```
<blog>
    <label>BLOG</label>
    <route>blog</route>
    <title>BLOG_TITLE</title>
    <pages>
        <blog-post>
            <route>blog-post</route>
            <visible>false</visible>
        </blog-article>
        <blog-category>
            <route>blog-category</route>
            <visible>false</visible>
        </blog-category>
    </pages>
</blog> 
```

`blog`很明显，如果像这样的子路由处于活动状态，我会将页面标记为活动`blog-post`状态。不幸的是，如果不使用子页面（我不想要），它就不会这样做。因此，如果有一种方法可以将路线名称`blog`和所有以`blog`（例如：、、、`blog-post`）开头的路线标记为活动`blog-category`，`blog-author`那将非常有用！

我不想为此使用子页面，因为我的菜单部分呈现了一个空下拉列表（Twitter Bootstrap）。自己看：

![Zend 中的空下拉菜单](https://i.stack.imgur.com/yEofe.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-03T06:34:14.230

我知道它已经得到了回答，但我找到了不同的解决方案，因为 Marshall 发布的一个对我不起作用。我想这是因为我没有在菜单中使用**动作/控制器，而是使用****路由**。

我的菜单条目如下所示：

```
array(
    'label' => 'cms-nav_users',
    'access_module' => 'user',
    'resource' => 'user_admin',
    'route' => 'admin_user',
    'pages' => array(
        array(
            'label' => 'cms-nav_companies',
            'access_module' => 'user',
            'route' => 'company_admin',
            'resource' => 'company_admin',
        ),
        array(
            'label' => 'cms-nav_users-list',
            'access_module' => 'company',
            'route' => 'admin_user',
            'resource' => 'user_admin',
        ),
    ),
), 
```

我想出了一个基于我自己的菜单模板（部分）的解决方案。基本上有一个 foreach 循环，它检查是否有任何子页面处于活动状态，如果有一个 - 将父页面标记为活动，它看起来像这样：

```
$active = false;

if (!empty($page->pages))
{
    foreach ($page->pages as $subpage) 
    {
        if ($subpage->isActive()) $active = true;
    }
}

$html[] = ($active) ?  'class="active"' : ''; 
```

希望它可以帮助某人:)

# 更新

实际上我发现您可以使用 Zend Framework 自己的 isActive()`true`参数，如源代码所示：

```
Zend_Navigation_Page_Mvc::isActive($recursive = false) 
```

两种方式都可以，但这种方式更合适。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T02:37:45.490

从文档中：

```
array(
    'label' => 'Page 2',
    'controller' => 'page2',
    'pages' => array(
        array(
            'label' => 'Page 2.1',
            'action' => 'page2_1',
            'controller' => 'page2',
            'class' => 'special-one',
            'title' => 'This element has a special class',
            'active' => true
        ),
        array(
            'label' => 'Page 2.2',
            'action' => 'page2_2',
            'controller' => 'page2',
            'class' => 'special-two',
            'title' => 'This element has a special class too'
        )
    )
), 
```

如您所见，父菜单项没有分配给它的操作，但是父菜单项和子菜单项共享同一个控制器。这就是您可以在子页面的父页面上拥有活动状态的方式。

# c - 将二分查找展平为单链表 [C]

> ID：15939582
> 
> 赞同：6
> 
> 时间：2013-04-11T02:10:47.127
> 
> 标签：c, linked-list, binary-search-tree

我正在尝试将二叉搜索树展平为单链表。

二叉搜索树：

```
 6
    /   \
   4     8
  / \     \
 1  5     11
         / 
       10 
```

扁平单链表：

```
1 -> 4 -> 5 -> 6 -> 8 -> 10 -> 11 
```

由于某种原因，我似乎无法弄清楚这一点。

我有一个树节点的结构：

```
typedef stuct node {
    int key;
    struct node *left;
    struct node *right;
} Node; 
```

我有一个函数来创建和分配内存到树节点：

```
Node* newNode (int key) {
    Node *new = malloc (sizeof(Node));
    new->left = NULL;
    new->right = NULL;
    new->key = key;
    return new;
} 
```

我有一个列表节点的结构：

```
typedef struct list {
    int key;
    struct list* next;
} List; 
```

我有一个创建列表节点的功能：

```
List* newListNode (int key) {
    List *new = malloc(sizeof(List));
    new->key = key;
    new->next = NULL;
    return new;
} 
```

我有工作函数来创建二叉搜索树、插入值等，但现在我需要创建一个函数来将树展平为列表。

```
List* flattenToLL(Node* root) {
    ...
} 
```

我似乎无法弄清楚如何将其展平为单链表。我已经看到很多其他线程和站点讨论将二叉搜索树转换为双向或循环链表，但没有关于将值复制到单链表。如果有人可以就我如何实现这一点提出建议，我将不胜感激。这是一个家庭作业，所以如果你也可以提供一个小的解释来帮助我学习，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T02:23:02.973

这是相对简单的递归执行：

*   检查左边的节点；如果那里有东西，请将左侧展平到列表 #1
*   检查右边的节点；如果那里有东西，请展平列表 #2 的权利
*   使用当前节点的键创建单节点列表#3
*   按 #1 -> #3 -> #2 的顺序连接列表
*   返回串联列表作为结果

以下是如何对其进行编码：

```
List* flattenToLL(Node* root) {
    List *list1 = (root->left) ? flattenToLL(root->left) : NULL;
    List *list2 = (root->right) ? flattenToLL(root->right) : NULL;
    List *list3 = newNode(root->key);
    // The "middle" list3 cannot be NULL; append list2 to list3
    list3->next = list2; // If list2 is NULL, it's OK
    if (!list1) return list3; // Nothing to prepend
    List *last = list1;
    while (last->next) last=last->next; // Go to the end of list1
    last->next = list3; // Append list3+list2 to the end of list1
    return list1;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T02:23:10.397

您需要按顺序进行遍历，将每个元素依次添加到列表中。

这个的伪代码是：

```
def traverse (node, list):
    if node == NULL: return       # Ignore empty subtrees.
    traverse (node.left, list)    # Do left subtree first.
    list.append (node.data)       # Then current node.
    traverse (node.right, list)   # Then right subtree.

list = new List()                 # Create empty list.
traverse (root, list)             # Collapse tree to list. 
```

就是这样，就这么简单。第一步，处理左子树。第二步，添加数据。第三步，处理右子树。

唯一的“聪明”位是以使代码简洁的方式正确处理空子树。

* * *

请记住，为了获得最大效率，如果指向最终元素（尾部）的指针未缓存在某处，则附加到链表可能是一项相对昂贵的操作。这将需要为每个添加的元素找到尾部，这会将你的展平算法变成一个。`O(n²)`

*由于必须*维护指针这一事实几乎总是在链表的*开头*插入元素，因此执行反向按顺序遍历通常更有效：`O(1)`*`head`*

 *```
def traverse (node, list):
    if node == NULL: return       # Ignore empty subtrees.
    traverse (node.right, list)   # Do right subtree first.
    list.insert (node.data)       # Then current node at list start.
    traverse (node.left, list)    # Then left subtree. 
```

这使展平操作保持在`O(n)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-03T03:00:11.880

```
Why dont you do inorder traversal and add values to list in a way.  

public List<Integer> inorderToList(TreeNode<Integer> node, List<Integer> list) {
        if(node == null) {
            return list;
        } 
        if (node != null) {
            list = inorderToList(node.getLeft(), list);
            list.add(node.getValue());
            list = inorderToList(node.getRight(), list);
        }
        return list;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-27T05:24:46.437

如果有人感兴趣，下面是 Java 代码：

```
public static Node bTreeToLinkedList(TreeNode root) {
    Node list1 = root.getLeftChild() != null ? bTreeToLinkedList(root.getLeftChild()) : null;
    Node list2 = root.getRightChild() != null ? bTreeToLinkedList(root.getRightChild()) : null;
    Node list3 = ll.new Node((int) root.getData());

    list3.setNext(list2);
    if (list1 == null)
        return list3;

    Node last = list1;
    while (last.getNext() != null)
        last = last.getNext();
    last.setNext(list3);

    return list1;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-10T13:19:18.797

我们可以使用递归，为树中的每个级别构建一个链表，并将该列表添加到列表向量中。使用此解决方案，我们需要跟踪我们所在的级别，因此，如果我们已经有一个级别的链接列表，并且我们访问了访问级别上的节点，然后我们就可以添加到该列表中。

我没有为我自己的节点类添加任何代码，因为它与问题无关，也没有演示内存清理，但是更好的解决方案是使用 boost::shared_ptr 来处理清理。

```
void generateLists(vector<list<node*>* >*& lists, node* root, int level)
{
    //base case
    if(root == NULL)
        return;

    //if we have don't have a linked list at this level so create this
    if((int)lists->size() == level)
    {
        list<node*>* ls = new list<node*>();
        ls->push_back(root);
        lists->push_back(ls);
    }
    else
    {
        //re-use existing list
        list<node*>* ls = lists->at(level);
        if(ls != NULL)
            ls->push_back(root);
    }

    //in order traversal
    generateLists(lists, root->left, level+1);
    generateLists(lists, root->right, level+1);
}

int main(void)
{
    //create a test binary tree
    node root(6);
    node n2(3);
    node n3(9);
    node n4(2);
    node n5(5);
    node n6(8);
    node n7(9);

    root.left = &n2;
    root.right = &n3;
    n2.left = &n4;
    n2.right=&n5;
    n3.left=&n6;
    n3.right=&n7;

    //will hold a vector of lists for each level in the tree
    vector<list<node*>* >* lists = new vector<list<node*>* >();
    int level=0;
    generateLists(lists, &root, level);
    vector<list<node*>* >::iterator it;

    //convert each level in the tree to a single linked list
    list<node*> flattened;
    for(it = lists->begin(); it != lists->end(); it++)
    {
        list<node*>* linkedList = (*it);
        list<node*>::iterator itNode;
        for(itNode = linkedList->begin(); itNode != linkedList->end(); itNode++)
            flattened.push_back(*itNode);
    }

    //output the tree as a linked list
    list<node*>::iterator itNode;
    for(itNode = flattened.begin(); itNode != flattened.end(); itNode++)
        cerr<<(*itNode)->val<<" ";
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-16T10:54:00.477

[这里](http://n00tc0d3r.blogspot.com/2013/03/flatten-binary-tree-to-linked-list-in.html)的问题也有非递归解决方案。

它为您提供 O(n) 时间复杂度和 O(1) 空间复杂度。使用递归解决方案，如果您将其应用于自己的输出以获取大节点集，则可能会出现堆栈溢出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-20T20:38:34.693

```
 private static BSTNode head;
 private static BSTNode tail;
 public static void inorderTraversal(BSTNode node) {
        if(node.left != null) {
            inorderTraversal(node.left);
        }
        System.out.print(node.data + " ");
        constructLinkedList(node.data);
        if(node.right != null) {
            inorderTraversal(node.right);
        }
    }

public static void constructLinkedList(int data) {
        if(head == null) {
            head = new BSTNode(data);
            head.left = null;
            tail = head;
        } else {
            BSTNode node = new BSTNode(data);
            tail.right = node;
            tail.left = null;
            tail = node;
        }
   }

   public static void linkedListToString() {
        BSTNode curr = head;
        StringBuilder sb = new StringBuilder();
        sb.append("[");
        while(curr.right != null) {
            sb.append(curr.data).append("->");
            curr = curr.right;
        }
        if(curr.right == null)
            sb.append(curr.data).append("->NULL");
        sb.append("]");
        System.out.print(sb.toString());

   } 
```*

# css - 电子邮件中的媒体查询 - 是否需要特定的元标记？

> ID：15939585
> 
> 赞同：1
> 
> 时间：2013-04-11T02:11:01.803
> 
> 标签：css, email, responsive-design, media-queries, meta-tags

我构建了一封电子邮件，当查看设备宽度减小时，它使用媒体查询将 2 列调整为 1 列。当我通过上传代码使用 litmus.com 进行测试时，电子邮件在 Android、iPhone 和 Windows 手机上完美地调整了大小！！

但是，在我将代码复制到电子邮件服务中用于发送电子邮件的编辑器并通过从电子邮件服务向 Litmus 发送消息再次进行测试后，移动版本没有按预期调整大小。

在第二个测试中查看源代码表明我的电子邮件服务删除了样式之上的所有代码，并且只包含这个元标记：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

删除“HandheldFriendly”元标记会导致我的媒体查询不起作用吗？这里还有其他看起来像问题的东西吗？

这是我的标题代码 -

```
<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="HandheldFriendly" content="True" />

<style type="text/css">
.ReadMsgBody {width: 100%; background-color: #ffffff;}
.ExternalClass {width: 100%; background-color: #ffffff;}
body     {width: 100%; background-color: #ffffff; margin:0; 
    padding:0; -webkit-font-smoothing: antialiased;}
html {width: 100%; }
table {border-collapse: collapse;}

@media screen and (max-device-width: 1000px)  {
body[yahoo] .deviceWidth {width:440px!important}    
body[yahoo] .center {text-align: center!important;}  
body[yahoo] .footerLinks { width:32%; margin-bottom:40px}
    }

@media screen and (max-device-width: 479px) {
body[yahoo] .deviceWidth {width:280px!important}    
body[yahoo] .center {text-align: center!important;}  
body[yahoo] .footerLinks { width:32%; margin-bottom:40px}
    }
</style>

</head> 
```

任何帮助都会很棒-谢谢！

更新：当我查看从我的电子邮件服务发送到我的帐户的测试源时，我可以看到更改后的标头代码。

```
Content-type: text/html;
charset="ISO-8859-1"
Content-transfer-encoding: quoted-printable

<html>
<head>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf-8">
</head>
<body>
<style type=3D"text/css"><!--
.ReadMsgBody {width: 100%; background-color: #ffffff;}
.ExternalClass {width: 100%; background-color: #ffffff;}
body     {width: 100%; background-color: #ffffff; margin:0; padding:0; -webki=
    t-font-smoothing: antialiased;}
html {width: 100%; }
table {border-collapse: collapse;}

@media screen and (max-device-width: 1000px)  {
 body[yahoo] .deviceWidth {width:440px!important}   
        body[yahoo] .center {text-align: center!important;} =20
        body[yahoo] .footerLinks { width:32%; margin-bottom:40px}
        }

@media screen and (max-device-width: 479px) {
        body[yahoo] .deviceWidth {width:280px!important}    
        body[yahoo] .center {text-align: center!important;} =20
        body[yahoo] .footerLinks { width:32%; margin-bottom:40px}
        }
--></style> 
```

# mysql - 在 Zend 框架中使用 DBTable 插入命令

> ID：15939602
> 
> 赞同：0
> 
> 时间：2013-04-11T02:14:20.377
> 
> 标签：mysql, zend-framework

我是 Zend 框架的新手

这是我的数据库表

```
class Application_Model_DbTable_Employee extends Zend_Db_Table_Abstract
{

protected $_name = 'tab_employee';
} 
```

这是我的模特

```
public function InsertEmployees($array){
   $tblEmployee = new Application_Model_DbTable_Employee();
   $tblEmployee->insert($array);
} 
```

这是我的控制器

```
 public function AddEmployeeAction(){
 $request = $this->getRequest();
 $params = $request->getParams();
 $emp = new Application_Model_InsEmployee();
 $emp->InsertEmployees(array(
          'Name' => $params['name'],
          'Date' => $params['date']
 ));
} 
```

任何人都知道这段代码的错误是什么，因为它总是返回一个应用程序错误。感谢提前

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T10:57:41.507

在您的 DbTable 中执行以下操作：

```
public function InsertEmployees($array){
   $this->insert($array);
} 
```

所以你的数据库看起来像这样：

```
class Application_Model_DbTable_Employee extends Zend_Db_Table_Abstract
{

  protected $_name = 'tab_employee';

  public function InsertEmployees($array){
    $this->insert($array);
  }
} 
```

然后从控制器创建 DbTable 实例并“绕过”模型。

```
$model = new Application_Model_Db_Table();
$model->InsertEmployees($data) 
```

# pandas - 使用 pandas 将新列附加到 HDFStore

> ID：15939603
> 
> 赞同：9
> 
> 时间：2013-04-11T02:14:28.380
> 
> 标签：pandas, hdf5, hdfstore

我正在使用 Pandas，并制作一个 HDFStore 对象。我计算了 500 列数据，并将其写入表格格式的 HDFStore 对象。然后我关闭文件，从内存中删除数据，执行接下来的 500 列（由递增的整数标记），打开存储，并尝试追加新列。然而，它不喜欢这样。它给了我一个错误

```
invalid combinate of [non_index_axes] on appending data [[(1, [500, 501, 502, ...])]] vs current table [[(1, [0, 1, 2, ...])]] 
```

我假设它只允许附加更多行而不是列。那么如何添加更多列呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-08-28T18:07:27.580

您已将列标题保留在代码中`[1, 2, 3, ...]`，并尝试将 a 附加到`DataFrame`不同的列`[500, 501, 502, ...]`中。

# ruby-on-rails - 在 Rails 中加入两个不同模型查询的最佳方法？

> ID：15939604
> 
> 赞同：0
> 
> 时间：2013-04-11T02:14:51.937
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有两个不同的模型，需要在选择查询和页面列表中连接在一起。它们共享我需要在视图中引用的所有属性（created_at、updated_at、name 等），并且我希望它们按创建顺序排列。我想知道最有效的方法是什么？我正在考虑单独对每个对象执行选择查询并将相关部分添加到一个公共数组中，但这似乎效率低下。

例如，如果我的模型是 Dogs 和 Cats，我想要一份所有 5 岁的狗和猫的列表，我在想类似的东西

```
@pets = []
dogs = Dogs.where(:age => 5)
cats = Cats.where(:age => 5)
dogs.each do |dog|
  hash = {"id" => dog.id, "name" => dog.name, "created_at" => dog.created_at }
  @pets.push(hash)
end 
cats.each do |cat|
  hash = {"id" => cat.id, "name" => cat.name, "created_at" => cat.created_at }
  @pets.push(hash)
end 
```

但这是最好的方法吗？另外，我不确定如何根据创建日期对本示例中的完成数组进行排序...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:00:06.463

尝试这个

```
dogs = Dogs.where(:age => 5)
cats = Cats.where(:age => 5)
@pets = (dogs + cats).sort_by { |pet| pet.created_at } 
```

或者，如果您仍然想要散列，请使用 map 创建散列数组

```
dogs = Dogs.where(:age => 5)
cats = Cats.where(:age => 5)
@pets = (dogs + cats).sort_by do |pet| 
  pet.created_at 
end.map do |pet| 
  { "id" => dog.id, "name" => pet.name, "created_at" => pet.created_at }
end 
```

# ruby-on-rails - 如何更新 routes.rb（动态 url）

> ID：15939605
> 
> 赞同：1
> 
> 时间：2013-04-11T02:14:52.780
> 
> 标签：ruby-on-rails, ruby, routes

我的 routes.rb 中有这段代码

```
shops = Shop.all
shops.each do |shop|
match "/#{shop.url}" => 'shops#show', :id => shop.id
end 
```

所以 url 可以像 http://site/url 而不是 http://site/shops/1

& 它确实有效，但我必须在添加新商店后重新启动服务器。

也许，有一种方法可以在不重新启动的情况下做这些事情？或者，其他方式？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:13:07.993

这是一个旧的铁轨演员，但你会在那里找到答案的元素

[http://railscasts.com/episodes/63-model-name-in-url](http://railscasts.com/episodes/63-model-name-in-url)

作为一般建议：你不需要在你的路线中做这种循环，研究 Rails 路线提供的工具并使用它们

[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

# javascript - 403 Forbidden in Google Chrome (only) 当我用 Jquery (ajax) 调用 twitter 搜索时

> ID：15939608
> 
> 赞同：4
> 
> 时间：2013-04-11T02:15:20.953
> 
> 标签：javascript, ajax, json

我在使用 Google Chrome (v26.0.1410.64m) 时遇到了这个问题。当我使用 jquery 调用 Twitter 搜索时，出现以下错误：

```
GET https://search.twitter.com/search.json?q=youtube&rpp=5&result_type=recent&callback=jQuery19101530768966767937_1365645647773&_=1365645647774 403 (Forbidden) 
```

这是我使用的代码：

```
$.ajax({
   type: "GET",
   url: "https://search.twitter.com/search.json?q=youtube&rpp=5&result_type=recent",
   contentType: "application/json",
   dataType: "jsonp",
   success: function(data) {
       console.log(data);
   }
}); 
```

在 Firefox、Internet Explorer、Safari 和 Opera 上，这是有效的。但是在 Chrome 中我有这个禁止的错误。我尝试在我的 .htaccess 中添加以下跨域代码：

```
Header set Access-Control-Allow-Origin: *
Header set Access-Control-Allow-Credentials: true 
```

什么也没有变。我哪里错了？如果这有帮助，我正在使用 Windows/Apache 上的虚拟域（en.domain.com.local、fr.domain.com.local 等）在开发环境中工作。

谢谢您的帮助。对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T16:02:05.603

我最近遇到了这个问题，但我找到了破解/解决方法。

我发现的工作是引入大约 100 毫秒的任意超时。我使用 150 毫秒只是为了确定该 hack 是否有效。

```
function latestTweet(screenName) {
  var deferred = new $.Deferred();

  // Introduce a timeout before we make a search request to Twitter.
  // This is added in the event that this function is called when
  // the page is ready and your user is using Chrome. When in Chrome
  // and a search request is sent to Twitter it will always return a 403.
  setTimeout(function () {
    $.ajax({
      url: "//search.twitter.com/search.json?q=from%3A"+screenName,
      type: 'GET',
      dataType: 'jsonp',
      success: function(data) {
        if (data && data.results) {
          data = data.results;
          if (typeof data.length === 'number') {
            deferred.resolve(data[0]);
          } else {
            deferred.reject();
          }
        }
      }
    });
  }, 150); // This works with 100ms, but pad just to be sure.

  return deferred.promise();
}

// Somewhere in my code ...
latestTweet('someScreenName').done(displayTweet); 
```

现在在 Chrome 中你不应该得到 403 Forbidden 响应，并且在所有其他浏览器中它会继续工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:37:28.043

好吧，我发现出了什么问题。当我将*https*替换为**http**时，Google Chrome 已接受该查询。我猜这是一个安全问题。目前，我的网站无法使用 https 协议。谢谢 ！

**编辑：**嗯......误报。它工作过一次。但是当我刷新页面时，禁止的错误又回来了。

**编辑 2：**哇...事实上，当 Google Chrome 的开发者控制台关闭时，脚本运行良好...我与[Perception制作的小提琴有相同的结果](https://stackoverflow.com/users/680925/perception "洞察力")

# iphone - 打字时键盘挡住屏幕

> ID：15939618
> 
> 赞同：0
> 
> 时间：2013-04-11T02:17:02.623
> 
> 标签：iphone, ios, objective-c, uitextview

我正在制作一个包含多个的应用程序，`UITextField`并且`UITextView` The`UITextView`位于屏幕底部，每当键入开始时，键盘都会阻止`UITextView`

当键盘出现在屏幕上时，我将如何向上移动表单的视图？然后当键盘消失时再次向下移动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:21:29.967

最好的答案是尽量避免这样做。

但是，如果您将内容放在 UIScrollView 或 UITableView 中，您可以在输入成为第一响应者时滚动到输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:37:11.573

确保在你的类中实现 UITextFieldDelegate。这些委托方法应该对名为 activeField 的文本字段起作用：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [activeField setDelegate:self];    
    [self configureView];
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    [textField resignFirstResponder];
    return TRUE;
}

// Called when the UIKeyboardDidShowNotification is sent.
- (void)keyboardWasShown:(NSNotification*)aNotification
{
    NSDictionary* info = [aNotification userInfo];
    CGSize kbSize = [[info objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    UIEdgeInsets contentInsets = UIEdgeInsetsMake(0.0, 0.0, kbSize.height, 0.0);
    scrollView.contentInset = contentInsets;
    scrollView.scrollIndicatorInsets = contentInsets;

    // If active text field is hidden by keyboard, scroll it so it's visible
    // Your application might not need or want this behavior.
    CGRect aRect = self.view.frame;
    aRect.size.height -= kbSize.height;
    if (!CGRectContainsPoint(aRect, activeField.frame.origin) ) {
        CGPoint scrollPoint = CGPointMake(0.0, activeField.frame.origin.y-kbSize.height);
        [scrollView setContentOffset:scrollPoint animated:YES];
    }
}

// Called when the UIKeyboardWillHideNotification is sent
- (void)keyboardWillBeHidden:(NSNotification*)aNotification
{
    UIEdgeInsets contentInsets = UIEdgeInsetsZero;
    scrollView.contentInset = contentInsets;
    scrollView.scrollIndicatorInsets = contentInsets;
}

- (void)registerForKeyboardNotifications
{
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWasShown:)
                                                 name:UIKeyboardDidShowNotification object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWillBeHidden:)
                                                 name:UIKeyboardWillHideNotification object:nil];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T02:22:59.617

我喜欢用这个：[https](https://github.com/michaeltyson/TPKeyboardAvoiding) ://github.com/michaeltyson/TPKeyboardAvoiding 它对我来说非常好用，而且很容易使用。

# c++ - C++/CLI：如何在本地类中存储托管引用？

> ID：15939620
> 
> 赞同：2
> 
> 时间：2013-04-11T02:17:13.777
> 
> 标签：c++, .net, logging, c++-cli, log4net

在我的混合解决方案 (C++/.NET) 中，我想将 Log4Net 的 ILog 实例传递给 C++ 对象（以统一整个解决方案的日志记录）。

我想写一个 C++ 接口（LogInterface），然后在 C++/CLI 项目中实现一个托管到非托管的适配器，但问题是非托管适配器将无法存储指向托管 ILog 的字段实例。

是否有一种优雅、安全且高效的方式来实现这一点（除了将托管引用存储在静态缓存中）？

```
class UnmanagedLogAdapter : 
    public LogInterface
{
    public:
        UnmanagedLogAdapter(log4net::ILog^ log);

        virtual bool IsInfoEnabled(void) const override
        {
            return m_log->IsInfoEnabled();
        }

        virtual void Info(const std::wstring& message) override
        {
            log4net::ILog^ log = m_log; // alternative that I want to avoid: log = StaticCache::Find(m_logId);
            log->Info(gcnew System::String(message.cstr()));
        }

    private:
        log4net::ILog^ m_log; //TODO: a managed field is forbidden
}; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T02:20:03.320

使用`gcroot<ILog^>`成员，如此[处](http://msdn.microsoft.com/en-us/library/481fa11f%28v=vs.110%29.aspx)所述。

# java - Android 应用程序：从后台在计时器上运行代码

> ID：15939621
> 
> 赞同：2
> 
> 时间：2013-04-11T02:17:17.450
> 
> 标签：java, android, timer, notifications, background-process

大家好，并在此先感谢您。我的问题是我有一个应用程序，用户将在前台启动并将变量设置为计时器。用户很可能会关闭该应用程序，否则手机将进入睡眠状态。因此，我需要将应用程序置于后台，然后运行代码以在计时器达到 0 时发送通知。

对于计时器，我将使用 unix 时间并让后台进程检查它是否匹配或在计时器关闭时超过当前时间。

我想知道 - A）如何使用这些说明将应用程序发送到后台 B）然后如何将应用程序置于前台，或者至少能够在运行一些代码后发送通知

再次，非常感谢你，如果我不清楚或者我错过了某人以前的帖子，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:28:27.780

这篇文章应该是一个很好的起点，看起来你想要使用的是服务。

[如何在后台运行android应用程序？](https://stackoverflow.com/questions/9029040/how-to-run-an-android-app-in-background)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T05:47:27.383

查看扩展 Android [Handler](http://developer.android.com/reference/android/os/Handler.html)类以创建自定义 Handler，[当](http://developer.android.com/reference/android/os/Message.html)Handler 收到[您](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)使用方法或. 可以使用其中任何一种方法的参数指定该计时器何时关闭。`sendMessageAtTime(android.os.Message, long uptimeMillis)``sendMessageDelayed(android.os.Message, long delayMillis)``long`

希望这有帮助！

# excel - Excel 多字符串搜索

> ID：15939624
> 
> 赞同：0
> 
> 时间：2013-04-11T02:17:32.967
> 
> 标签：excel, vba

我有 Sheet2 数据（产品名称）按字母顺序按列排序，产生 26 列加上一列用于数字数据。在 Sheet1 上有一个近万个产品名称的列表，无论我们在 Sheet2 上是否有它们，都将对其进行测试。一次搜索一个名字是一件很疯狂的事情，所以我在想我们是否可以在 Sheet1 中批量搜索数据，并且在每个单元格旁边，搜索结果将显示在 Sheet2 中找到该产品的单元格的地址，或未找到，例如：

```
SEARCH STRINGS    SEARCH RESULT

Vodafone          A4
Mirinda           C105
Coca-Cola         Y59
HeroHonda         not found
Bournvita         S27
Maggi             not found 
```

我进行了一些搜索以找到上述所需的类似代码，并在以下位置找到以下代码：[http](http://www.excelforum.com/excel-programming-vba-macros/714965-search.html) ://www.excelforum.com/excel-programming-vba-macros/714965-search.html ，它进行了搜索为一串。可以修改此脚本以产生所需的结果吗？

```
Sub DataSearch()
Dim Data() As Variant
Dim DstWks As Worksheet
Dim Food As String
Dim N As Variant
Dim R As Long
Dim Rng As Range
Dim RngEnd As Range
Dim SrcWks As Worksheet

Set SrcWks = Worksheets("Test 2")
Set DstWks = Worksheets("Test1")

R = 6
Food = DstWks.Range("E3")
N = DstWks.Range("E4")

  If DstWks.Range("C6") <> "" Then
     DstWks.Range("C6").CurrentRegion.Offset(0, 1).ClearContents
  End If

  Set Rng = SrcWks.Range("A4:E4")
  Set RngEnd = SrcWks.Cells(Rows.Count, Rng.Column).End(xlUp)
  Set Rng = IIf(RngEnd.Row < Rng.Row, Rng, SrcWks.Range(Rng, RngEnd))

  ReDim Data(1 To Rng.Rows.Count, 1 To Rng.Columns.Count)
  Data = Rng.Value

    For I = 1 To UBound(Data, 1)
      If Data(I, 1) = N And InStr(1, Data(I, 3), Food, vbTextCompare) > 0 Then
         DstWks.Cells(R, "C").Resize(1, Rng.Columns.Count) = Rng.Rows(I).Value
         R = R + 1
      End If
    Next I

End Sub 
```

始终感谢您的宝贵帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:52:03.127

我会使用一些快速而肮脏的东西，比如 hlookup，看看它是否返回一个值来确定它是否在 10,000 个产品中。

例如，假设在工作表 2 中，您的数据存储为：
- 每个产品记录在一个列中
- 不同的产品在不同的列中
- 产品名称在第 1 行，从 A1 开始
还假设在工作表 1 中，
- 产品名称在 A 列中，以 A1 开头
- 工作表中没有其他数据

在工作表 1 中，将以下公式放入 B2（随后将其一直复制到 B10001）： `=IF(ISNA(HLOOKUP(A1,Sheet2!$A$1:$Z$1,1)),"not found",ADDRESS(1,MATCH(A1,Sheet2!$A$1:$Z$1,0),1))`

# sql-server - 添加外键约束时，“关键字‘alter’附近的语法不正确”

> ID：15939631
> 
> 赞同：1
> 
> 时间：2013-04-11T02:18:33.953
> 
> 标签：sql-server, tsql, sql-server-2012

我有这些表：

```
Employee(Ename, SSN, Bdate, Address, Dnumber)
Department ( Dname,Dno,Dmgr_SSN(
Project(Pname, Pnumber, Plocation, Dnum)
WorksON(SSN,Pnumber,Hours) 
```

当我尝试使用`ALTER`：

```
alter  table  Employee 
add foreign key (Dnumber)
 REFERENCES Department (Dno); 
```

我收到此错误：

> 消息 156，级别 15，状态 1，第 24 行
> 关键字“alter”附近的语法不正确。

注意：我在表查询的定义下编写此查询

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T05:04:26.157

阅读[有关](http://msdn.microsoft.com/en-us/library/ms190273.aspx)[命令的](http://msdn.microsoft.com/en-us/library/ms190273.aspx)[**文档**`ALTER TABLE`](http://msdn.microsoft.com/en-us/library/ms190273.aspx)会很容易地向您展示这是要使用的语法：

```
ALTER TABLE dbo.Employee 
  ADD CONSTRAINT FK_Employee_Department
  FOREIGN KEY(Dnumber) REFERENCES dbo.Department(Dno); 
```

# asp.net-mvc-4 - 如何在 IIS 7 中托管多个网站并为所有网站使用相同的 MVC 应用程序？

> ID：15939632
> 
> 赞同：1
> 
> 时间：2013-04-11T02:18:52.083
> 
> 标签：asp.net-mvc-4, iis-7.5

如何在 IIS 7 中托管多个网站并为所有网站使用相同的 MVC 应用程序，以便每个网站：

1.  拥有自己的根目录，因此用户可以上传自己的文件（html、css、javascript）而无需查看其他网站的内容

2.  使用相同的 MVC 应用程序 - 因此对应用程序的更新会影响所有站点

3.  用户不能以任何方式影响 MVC 应用程序（最好对他们隐藏）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:32:25.510

1.  创建一个部署 MVC 文件的目录，名为“AppFoo”。请注意，配置文件`web.config`将在所有站点之间共享，您必须在按需运行时通过查看`Host`HTTP 标头或其他绑定信息来加载每个站点的配置。
2.  在 IIS 中创建每个网站并让它使用您创建的应用程序目录。理想情况下，每个网站都在自己的应用程序池下运行，并拥有自己的用户帐户，所有用户帐户都可以访问 AppFoo 目录。
3.  在某处创建一个新目录，例如`C:\Inetpub\sites\`命名为`WebsiteA`、`WebsiteB`等。每个文件夹重新设置 NTFS 权限 ACL，只允许每个网站的应用程序池用户访问。在这些文件夹中创建名为“Content”、“Views”和“Logs”的文件夹
4.  为 IIS 中的每个网站（我假设您使用的是 root）设置一个名为“Content”和“Views”的虚拟目录（我假设您已经设置了 MVC 应用程序），将它们映射到您在步骤 3 中创建的文件夹。
5.  对于每个网站，转到日志记录页面并将日志路径设置为`Logs`您在步骤 3 中为该网站创建的目录。

请注意，此计划基于 MVC 在其 VirtualPathProvider 中评估 IIS 虚拟目录的假设。如果没有，那么您将不得不滚动您自己的 VirtualPathProvider 以再次以每个主机名为基础加载每个网站的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T04:00:09.043

如果您正在运行一个代码库，则设置一个使用[域路由](http://blog.maartenballiauw.be/post/2009/05/20/aspnet-mvc-domain-routing.aspx)或全局过滤器来捕获域的站点，将其保存并将其用作文件夹的键等...

```
public class DomainFilterAttribute : ActionFilterAttribute
{
    private SiteDomainRepository _siteDomainRepository = new SiteDomainRepository();

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var viewBag = filterContext.Controller.ViewBag;
        var host = HttpContext.Current.Request.IsLocal ? "www.testdomain.com" : HttpContext.Current.Request.Url.Host;
        var domain = hostSplit[1];

        var siteDomain = _siteDomainRepository.GetByRowKey(domain);

        viewBag.DomainName = host.ToLower();
        viewBag.Domain = siteDomain.RowKey;
        viewBag.Class = siteDomain.Key;
        viewBag.TrackingCode = siteDomain.TrackingCode;
    }
} 
```

# import - 为什么从当前目录中的模块导入仅在该目录中有效？

> ID：15939633
> 
> 赞同：0
> 
> 时间：2013-04-11T02:18:55.207
> 
> 标签：import, python-3.x, python-import, pep

### 背景

我有一个具有此目录结构的 Python 项目：

```
py/:
db/  __init__.py  run.py

py/db:
handle.py  __init__.py  util.py 
```

这些文件很简单，我不确定是否需要发布它们；尽管如此：

**py/运行.py**

```
from db.handle import Handle 
```

**py/db/handle.py**：

```
import util

class Handle:
    def __init__(self, x):
        self.x = util.addtwo(x) 
```

**py/db/util.py**：

```
def addtwo(x):
    return x + 2 
```

如果我`handle.py`从`db`子目录中运行，它会毫无错误地导入`util`。但是，当我运行时`run.py`，`handle.py`由于导入错误而失败。我可以猜到它`handle.py`正在`py`目录中运行（而不是`py/db`），并且调用`os.getcwd()`in可以`handle.py`确认这一点。我可以`sys.path`像这样（在`run.py`）解决这个问题：

```
import sys
sys.path.append("db")
from db.handle import Handle 
```

### 问题

从子目录导入包含对该目录中其他本地模块的导入的模块时，为什么 Python 不检查生成导入语句的模块的当前目录？在我的示例中，为什么 Python 不检查第`db`一个 when`handle.py`包含 import 语句？是否有一个 PEP 描述了这一点，或者它是我错过的具有明显理由的行为？

我认为它可能与[PEP 328](http://www.python.org/dev/peps/pep-0328/)有关：

> 默认情况下，所有导入语句都是绝对的（仅搜索 sys.path），使用特殊语法（前导点）来访问包相对导入。

但我不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T04:32:45.227

您的导入是“绝对的”，并且在 PYTHONPATH 中查找模块名称，并且通常包括当前目录。

如果要从模块所在的同一文件夹中导入模块，请使用相对导入：

```
from . import util 
```

或者

```
from .util import addtwo 
```

# sql - 递归合并挑战

> ID：15939634
> 
> 赞同：0
> 
> 时间：2013-04-11T02:19:05.080
> 
> 标签：sql, sql-server, sql-server-2012, recursive-query, coalesce

我有一张`Product`记录和`Model`记录的表格。产品和型号记录都有一个`QTY`和`Size`列。对于给定的`product_id`，我想从记录中获取所有`qtys`和，并将它们放入****父记录的****单个***字段中，由管道“”分隔。这是我到目前为止的sql。它成功地从给定 product_id 的模型记录中获取大小和数量值，但我无法让它更新父产品记录字段，并递归执行。有人可以帮帮我吗？谢谢`sizes``Model`**`qty and size`** `Product``|`

此示例使用 product_id`'26206'`

```
--declare local variables
DECLARE
      @size_DelimitedString VARCHAR(MAX),
      @qty_DelimitedString VARCHAR(MAX)

 --pivot rows into delimited string
SELECT
      @size_DelimitedString = COALESCE(@size_DelimitedString, '') + CONVERT(VARCHAR(10), [BD New Product Data].model_size) + '|'
FROM
      [BD New Product Data]
      where record_type = 'model' and product_id = '26206'

 SELECT
      @qty_DelimitedString = COALESCE(@qty_DelimitedString, '') + CONVERT(VARCHAR(10), [BD New Product Data].model_quantity) + '|'
FROM
      [BD New Product Data]
      where record_type = 'model' and product_id = '26206'

--trim off last pipe
SET @size_DelimitedString = (SELECT SUBSTRING(@size_DelimitedString, 1, LEN(@size_DelimitedString)-1))
SET @qty_DelimitedString = (SELECT SUBSTRING(@qty_DelimitedString, 1, LEN(@qty_DelimitedString)-1)) 

--show results  
SELECT @size_DelimitedString 
SELECT @qty_DelimitedString 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:53:50.630

```
SELECT 
   product_id
 , STUFF((
    SELECT '|' + CONVERT(VARCHAR(10), A.model_size)
    FROM [BD New Product Data] A 
    WHERE A.record_type = 'model' AND A.product_id = T.product_id
    FOR XML PATH(''), TYPE
   ).value('.', 'VARCHAR(MAX)'), 1, 1, '') AS product_sizes
 , STUFF((
    SELECT '|' + CONVERT(VARCHAR(10), A.model_quantity)
    FROM [BD New Product Data] A 
    WHERE A.record_type = 'model' AND A.product_id = T.product_id
    FOR XML PATH(''), TYPE
    ).value('.', 'VARCHAR(MAX)'), 1, 1, '') AS product_quantities
FROM [BD New Product Data] T 
WHERE T.record_type = 'product' 
 --AND T.product_id = '26206' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T03:55:42.267

```
USE Prod
Update dbo.[BD Active Test]
 Set dbo.[BD Active Test].size = STUFF((
    SELECT '|' + CONVERT(VARCHAR(10), [dbo].[BD New Product Data Test].model_size)
    FROM [dbo].[BD New Product Data Test] 
    WHERE [dbo].[BD New Product Data Test].record_type = 'model' AND [dbo].[BD New Product Data Test].product_id = dbo.[BD Active Test].sku
    FOR XML PATH(''), TYPE
   ).value('.', 'VARCHAR(MAX)'), 1, 1, '')
 , dbo.[BD Active Test].qty = STUFF((
    SELECT '|' + CONVERT(VARCHAR(10), [dbo].[BD New Product Data Test].model_quantity)
    FROM [dbo].[BD New Product Data Test] 
    WHERE [dbo].[BD New Product Data Test].record_type = 'model' AND [dbo].[BD New Product Data Test].product_id = dbo.[BD Active Test].sku
    FOR XML PATH(''), TYPE
    ).value('.', 'VARCHAR(MAX)'), 1, 1, '')
from dbo.[BD Active Test]
INNER JOIN dbo.[BD New Product Data Test] ON dbo.[BD Active Test].sku = dbo.[BD New Product Data Test].product_id 
where dbo.[BD New Product Data Test].record_type = 'PRODUCT' 
```

# java - Tomcat 和 mySQL 配置

> ID：15939638
> 
> 赞同：0
> 
> 时间：2013-04-11T02:19:25.800
> 
> 标签：java, mysql, database, apache, tomcat

我使用 Tomcat 和 mySQL 已经有一段时间了，但最近一直在设法最大化我的连接。我不知道为什么，因为我的代码在完成后会打开和关闭连接。例如，这是我的连接和关闭方法：

```
public void closeConnection(){
    try {
        con.close();
    } catch (SQLException e) {
        e.printStackTrace();
    }
}

public void connect(){
    try {
        initCtx = new InitialContext();
    } catch (NamingException e) {
        e.printStackTrace();
    }
    try {
        envCtx = (Context) initCtx.lookup("java:comp/env");
    } catch (NamingException e) {
        e.printStackTrace();
    }
    try {
        ds = (DataSource) envCtx.lookup("jdbc/TestDB");
    } catch (NamingException e) {
        e.printStackTrace();
    }           
} 
```

这是执行通用语句的基本方法：

```
public void excuteStatement(String query){

        connect();

    try {
        con = ds.getConnection();
        con.createStatement().executeUpdate(query);
        } catch (Exception ex ){               
    } finally {
        if (con != null)
            closeConnection();
    }       
} 
```

这种代码是否有任何理由导致连接保持打开状态？我得到了我需要的所有数据，99% 的时间一切正常。

这是我在 Tomcat context.xml 中的配置：

```
 <Resource name="jdbc/TestDB" auth="Container" type="javax.sql.DataSource"
           maxActive="100" maxIdle="30" maxWait="10000"
           username="myUserName" password="myPass" driverClassName="com.mysql.jdbc.Driver"
           url="jdbc:mysql://xxx.xxx.xxx.xxx:0000/myUserName"/> 
```

现在此时我被锁定，因为我有最大的连接。我应该减少等待时间以避免这种情况吗？

关于我的代码，我应该说一件事，它通常会在大循环中触发许多多条语句。我认为也许这种快速打开和关闭可能是问题所在。由于我的 Tomcat servlet 始终在运行，它是否应该只打开一次连接并通过检查使其保持打开状态以确保其仍然处于活动状态，而不是始终打开连接并关闭它？

感谢您对此提出的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T19:39:44.353

是的，减少你的等待时间，这太高了。在 mysql 中，您可以增加最大连接数的值，将其增加到您的盒子可以处理的合理大小。

# ruby-on-rails - 具有两个关联模型的 ActiveRecord 查询

> ID：15939639
> 
> 赞同：1
> 
> 时间：2013-04-11T02:19:39.710
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我有两个模型，`Deal`和`User`。一个用户`has_many`交易，一个交易`belongs_to`一个用户（创建交易的用户）。用户有属性`roles`，其中`user.roles`是一个数组。

我想查找由角色包括的用户创建的所有交易`"developer"`。我习惯为数据库查询编写 SQL，所以我在这里遇到了麻烦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T02:47:14.763

```
@deals = Deal.joins(:users).where(:users => { :roles => ['developer'] }) 
```

参考：[http ://api.rubyonrails.org/classes/ActiveRecord/Base.html](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T14:32:19.837

几个选项：

```
@deals = Deal.select{|d| d.user.roles.include?("developer")} 
```

或者

```
@deals = User.select{|u| u.roles.include?("developer")}.map(&:deals).flatten 
```

我更喜欢第一个，但第二个可能会更快，具体取决于您拥有多少交易和用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T02:44:40.980

我认为自己是一个 sql 穴居人，但您可以执行以下操作：`Deal.includes(:users).where(:users => {:role => 'developer'})` 或者查询您的用户角色。

# java - 选择排序错误

> ID：15939643
> 
> 赞同：0
> 
> 时间：2013-04-11T02:20:13.710
> 
> 标签：java, sorting

我尝试了许多不同的变体，但我一直遇到同样的问题。selectio nsort 运行后，输出的项目数与我的数组大小不匹配。我一直在使用任何大小为 10 的数组，但输出不包含 10 个数字。但是，选择排序的输出是排序的。

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public class Sorts {

public static Integer[] createArray(int size) {
    List<Integer> list = new ArrayList<Integer>();
    for (int i = 0; i < size; i++)
        list.add(i);
    Collections.shuffle(list);
    Integer[] array = list.toArray(new Integer[list.size()]);
    for (int i = 0; i < array.length; i++) {
        System.out.print(array[i]);
    }
    return array;

}

public static void selectionSort(Integer[] array) {
    Integer min;
    for (Integer i = 0; i < array.length - 1; i++) {
        min = i;
        for (Integer j = i + 1; j < array.length; j++) {
            if (array[j].compareTo(array[min]) > 0) {
                min = j;
            }
        }
        if (min != i) {
            Integer temp = array[i];
            array[i] = array[min];
            array[min] = temp;
            System.out.print(array[i]);

        }

    }
}

public static void main(String args[]) {
    int number = 10;
    Integer[] list = createArray(number);
    System.out.println("");
    selectionSort(list);

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T02:25:59.307

每当您进行交换时，您都会打印出一个数字。但是在一个包含 10 个元素的数组中，您只会进行 9 次交换——最后一个元素已经在正确的位置了！要解决此问题，请添加`System.out.print(array[array.length - 1]);`到函数的末尾。

此外，如果最小元素恰好是`i`，则不会执行交换，也不会打印任何元素。这仍然对数组进行排序，但如果您希望将其打印出来，您可以删除该`if (min != i)`语句并简单地在每次通过列表时进行交换。

您还应该看看使用`int`s 而不是`Integer`s。An`Integer`通常比 an 慢，`int`并且您通常仅在 Java 需要对象时使用它们。

# mips - 设计一个简化的 MIPS 处理器

> ID：15939644
> 
> 赞同：1
> 
> 时间：2013-04-11T02:20:26.337
> 
> 标签：mips

所以我要复习计算机组织期末考试的一些旧测验，我一定错过了这次讲座或其他什么。我在编程 MIPS 方面相当精通，但这个问题让我完全难过。有人可以帮我理解这一点吗？

![在此处输入图像描述](https://i.stack.imgur.com/Oax3U.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-14T02:04:28.523

该图缺少连接处理器各个部分的线路以及用于确定下一条指令地址是来自 PC+4 还是来自`jr ra`指令中的寄存器的多路复用器。

从 ALU 到寄存器文件的写入数据部分需要有一条线。这适用于 R-Type 指令，因为它们的结果需要写回目标寄存器。进入 ALU 需要来自读取数据 1 和读取数据 2 的行，这就是寄存器中的值如何进入 R 型指令的 ALU。

已经从指令存储器添加了几行到寄存器，但是您缺少写入寄存器的那一行（这指定了 R 型指令的目标寄存器）。

对于 PC，*进入*加法器的线进入另一个输入（上面的那个）。加法器的 4 是恒定的，因为每条指令的地址在前一条之后的 4 个字节，所以除非我们跳转到一个地址，否则我们将在当前指令之后立即执行指令。从 PC 到读取地址的线路也是必要的，因为 PC 指定在哪个指令地址处查找当前指令。进入 PC 的行要么来自 PC+4 加法的结果，要么*来自*指令中指定的寄存器`jr ra`。

为了处理这个决定，需要一个多路复用器。多路复用器有两个输入和一个输出，因此这个输入将有一个来自 PC+4 加法器（用于常规 R 型指令），另一个来自读取数据 1（用于`jr ra`指令）。来自读取数据 1 的输入应该被可视化为从读取数据 1 和 ALU 之间的线分割出来的。输出将直接返回到 PC，因为它确定要执行的下一条指令。

我认为这就是该问题所需要的一切，因为教授指定控制信号已经生成（多路复用器是一种控制单元，但我认为它仍然是必要的）。希望有帮助！

# php - 使用 Group By 将记录的重复子字符串选择为单个记录

> ID：15939645
> 
> 赞同：0
> 
> 时间：2013-04-11T02:20:26.353
> 
> 标签：php, mysql

是否可以编写 SQL 从表中选择重复的子记录字符串到单个记录中？我只想对**月份**和**年份**进行分组，结果如下图所示：

![在此处输入图像描述](https://i.stack.imgur.com/Doxl9.png)

我试试这个，但它没有用。

```
SELECT DATE, SUBSTRING(DATE, 3, 6) as Addrow FROM dbo.n4abs_premi_olah GROUP BY Addrow 
```

任何建议将被认真考虑。谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T02:26:33.840

```
SELECT DISTINCT(DATE_FORMAT(date, '%m/%Y')) month
FROM Table 
```

如果您确实需要使用`GROUP BY`（因为您还选择了其他聚合），请执行以下操作：

```
SELECT DATE_FORMAT(date, '%m/%Y')) month, other stuff...
FROM Table
GROUP BY month 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:26:11.720

这是执行此操作的多种方法之一：

```
SELECT DISTINCT CONCAT(MONTH(date), '/', YEAR(date)) FROM table; 
```

# javascript - 画布rect方法圆角右上角

> ID：15939647
> 
> 赞同：0
> 
> 时间：2013-04-11T02:20:51.590
> 
> 标签：javascript, html, canvas

当我用画布绘制一个矩形时，所有的角都是正方形的，除了右上角的边框半径看起来像 1 个像素。

我怎样才能使所有的角落都是正方形的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:55:41.687

这*应该*这样做：

```
var ctx = document.getElementById('canvas').getContext('2d');
ctx.fillRect(25,25,100,100); 
```

如果没有，您能否向我们展示您正在使用的代码和输出示例？

# java - 通过 CMD 获取输入时遇到问题 - java

> ID：15939648
> 
> 赞同：0
> 
> 时间：2013-04-11T02:21:09.373
> 
> 标签：java

如标题所述，我无法从任何人那里得到任何意见。它应该回显 InputTypeMismatch 的错误，或者如果你做数字，那么它会说 nullreference 错误。

有人可以纠正这个吗？这让我发疯。我不知道在哪里检查。

谢谢是提前:)

```
 Exception in thread "main" java.util.InputMismatchException
            at java.util.Scanner.throwFor(Unknown Source)
            at java.util.Scanner.next(Unknown Source)
            at java.util.Scanner.nextFloat(Unknown Source)
            at TestFile.promptsentence(TestFile.java:54)
            at TestFile.main(TestFile.java:43) 
```

这是一个例子：

```
 public class TestFile(){

            Scanner inp = new Scanner(System.in);

            public static main(String[] args){
                    long inp = inp.NextLong();
                    // prompts
                    String input = Long.valueOf(inp);

                    System.out.println(input);

            }

    } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-11T02:26:53.557

`TestFile f`不在范围内`public void repart()`。通过执行类似的操作将其放在 main 之外

```
public class TestFile {

    private TestFile f = new TestFile();

    public static main(String[] args){
        // Some Code
    }

    public void repart() {
        if(f.checksent(1) == true){
            // some code
        }
    }
} 
```

它现在*应该可以*工作了。总的来说，我认为这不是一个很好的方法。如果我正在做这个作业（我假设它是一个作业），我会制作 2 个类文件。One`Main`和 One`TestFile`然后执行此操作。

```
// TestFile.java
public class TestFile {

    public TestFile() {
        // some constructor stuff
    }

    public void repart() {
        if(f.checksent(1) == true){
            // some code
        }
    }
} 
```

和

```
// Main.java
public class Main{

    private TestFile f = new TestFile();

    private static TestFile f = new TestFile();

    public static main(String[] args){
        f.repart();
    }

} 
```

这个 imo 是更好的方法。希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-11T02:31:57.490

[我认为从这里开始Java 类和对象](http://docs.oracle.com/javase/tutorial/java/javaOO/index.html)会对您有所帮助

您遇到的错误是编译时错误

*   main() 函数语法错误。它应该像`public static void main(String[] args)`
*   您没有定义“checksent()”方法并且您正在尝试访问它。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-11T02:44:28.550

```
/* Here among class variables, outside any methods:*/

    Private TestFile f;

    public static void main(String[] args) {

        f = new TestFile();
        f.promptsentence();

    }; 
```

希望它足够清楚。

我没有对其余代码做任何陈述——只是回答关于对象`f`声明和赋值的问题。

# java - SelectBooleanCheckbox 中的 PropertyNotFoundException

> ID：15939659
> 
> 赞同：0
> 
> 时间：2013-04-11T02:22:14.970
> 
> 标签：java, jsf, primefaces

`TreeNode`PrimeFaces 3.3.1 组件中的每个节点都有一个复选框，该复选框`javax.el.PropertyNotFoundException`在其`value`属性中抛出一个。这是我的代码：

```
<p:tree value="#{CadBean.treeNode}" var="rec">  
<p:treeNode>
    <h:outputText value="#{rec.codigo}" />
</p:treeNode>

<p:treeNode type="Funcionality" icon="ui-icon16-weblibrary-folderopened">
    <p:selectBooleanCheckbox value="#{CadBean.alreadyAssociated(rec.id)}">
        <p:ajax event="click" listener="#{CadBean.onrecClicked(rec.id)}" />
    </p:selectBooleanCheckbox>
    <h:outputText value="#{rec.codigo}" />
</p:treeNode>

<p:treeNode type="Page" icon="ui-icon16-weblibrary-htmlpage">
    <p:selectBooleanCheckbox value="#{CadBean.alreadyAssociated(rec.id)}">
        <p:ajax event="click" listener="#{CadBean.onrecClicked(rec.id)}" />
    </p:selectBooleanCheckbox>
    <h:outputText value="#{rec.codigo}" />
</p:treeNode>

<p:treeNode type="System" icon="ui-icon16-weblibrary-computer">
    <h:outputText value="#{rec}" />
</p:treeNode> 
```

异常被抛出`value="#{CadBean.alreadyAssociated(rec.id)}"`。

布尔方法是这样的：

```
public boolean alreadyAssociated(int recId) {
for (Association a : associations) {
    if (a.getRec().getId() == recId) {
        return true;
    }
}
return false;
} 
```

这是一个例外：

```
SEVERE: javax.el.PropertyNotFoundException: /s_ca/cadRec.xhtml @54,122 value="#{CadBean.alreadyAssociated(rec.id)}": Property 'alreadyAssociated' not found on type br.com.tsg.web.beans.CadBean 
```

我正在使用 Mojarra 2.1.9 并且不能`selectionMode="checkbox"`在 TreeNode 中使用，因为我还需要两个带有复选框的组件。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:04:56.073

解决了。我只需要创建一个这样的方法：

```
public void setAlreadyAssociated(boolean b) {
} 
```

是的，这是一个糟糕的解决方法......但解决了。

# php - 形式声明不解析完整值？我有一个工作表单代码 form.php 如下：$db = new mysqli($dbhost, $dbuser, $dbpass, $dbname); if($db->connect_errno > 0){ die('无法连接数据库 [' . $db->connect_error . ']'); } $sql = <<<SQL SELECT DISTINCT `AllianceName` FROM `City` ORDER BY

> ID：15939661
> 
> 赞同：-1
> 
> 时间：2013-04-11T02:22:34.440
> 
> 标签：php, html, forms, http-post, form-submit

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:27:33.497

改成这个 `echo '<option value="'.$row['AllianceName'].'">'.$row['AllianceName'].'</option>';`

由此`echo '<option value='.$row['AllianceName'].'>'.$row['AllianceName'].'</option>';`

# branch - 如何整合两个未提交的 Perforce 分支？

> ID：15939662
> 
> 赞同：2
> 
> 时间：2013-04-11T02:22:50.800
> 
> 标签：branch, perforce, changelist

我遇到了这个问题：有两个分支，都已更改且未提交。命名为 Project-A 和 Project-B；现在，我想将 A 合并/集成到 B。我有一些想法可以做到这一点。

1.  建立一个新的分支并合并旧的两个。

    *   建立一个名为 Project-C 的新分支
    *   提交项目A；所以我可以检查 A 到 C（复制 A 到 C）
    *   在 C 内，使用 p4 积分 B；然后将 A 集成到 B
2.  使用 changelist 进行集成，因为 Perforce 使用 changelist(submit | shelve) 进行管理。

    *   获取 A 的最新变更列表
    *   在 B 内，使用 p4 积分 A；现在 B 与 depot 中的 head 版本合并
    *   将A的changlist复制到B；所以 B 可以随着 A 的变化而更新。
    *   提交 B
3.  使用差异和补丁

    *   将 A 与仓库中的版本进行比较
    *   补丁到 B

我是 Perforce 的 nieb，所以描述会有一些错误。这三个想法还没有测试，因为我害怕打破我的团队的分支。

所以，我的问题是：*这三种解决方案中的一种会起作用吗？*&*哪一个会是最好的？*

非常感谢。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T14:05:12.870

使用 2013.1 版本的 Perforce 服务器，您可以通过分支规范取消搁置，因此执行此操作的过程是：

1.  搁置项目 A 的更改
2.  搁置项目 B 的更改（可选）
3.  创建一个将项目 A 映射到项目 B 的分支视图
4.  使用步骤 3 中的分支视图将步骤 1 中的架子搁置到打开了项目 B 文件的工作区中。

服务器将针对项目 B 工作区中打开的文件安排步骤 (1) 中搁置的内容的集成和合并。

解决集成合并后，您可以区分所有更改并继续进行更改或进行进一步更改。

在步骤（2）中搁置项目 B 的更改的原因是，如果您不喜欢集成和合并的结果，您可以还原所有内容并从搁置的工作重新开始流程。

# android - 推送通知出错

> ID：15939666
> 
> 赞同：0
> 
> 时间：2013-04-11T02:23:13.540
> 
> 标签：android, push-notification, ibm-mobilefirst

我已经下载了推送通知模块的示例应用程序（我基于[推送通知示例应用程序](http://www.ibm.com/developerworks/mobile/worklight/getting-started.html#adavanced-topics)），当我启动 worklight 服务器时出现错误 `" Class com.mysql.jdbc.Driver not found in Worklight bundles."`，然后我导入“mysql-connector-java-5.1.24-bin .jar" 并尝试再次启动 Worklight 服务器，我遇到了错误
`" FWLSE4002E: Failed to connect to MYSQL database : Cannot create PoolableConnectionFactory (Communications link failure`

`The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.) [2013-04-11 09:05:33] FWLST0011E: ====== Worklight Project module_07_05_NativeAPIForAndroidPush-project-customization failed to start: Connection refused: connect"`

我已经尝试在谷歌上搜索但没有得到答案，有人帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:48:50.270

您需要将 MySQL Connector/J 文件放在 server\lib 文件夹下。如果您计划使用 MySQL，您还需要使用您的 MySQL 设置更新 worklight.properties。

您应该阅读 Worklight 入门资料，其中解释和演示[了 SQL 适配器的开发和设置。](http://www.ibm.com/developerworks/mobile/worklight/getting-started.html#server-side-development)

连接到您的 MySQL 服务器并确保存在 Worklight 数据库。还要确保有一个“Worklight”用户，并且该用户有权访问“Worklight”数据库。

还要确保在适配器的 XML 中指定用户名和密码：

```
<dataSourceDefinition>
    <driverClass>com.mysql.jdbc.Driver</driverClass>
    <url>jdbc:mysql://localhost:3306/mydb</url>
    <user>myUsername</user>
    <password>myPassword</password> 
</dataSourceDefinition> 
```

# java - 匹配不在嵌套括号中的字符

> ID：15939669
> 
> 赞同：0
> 
> 时间：2013-04-11T02:23:54.140
> 
> 标签：java, regex, parsing

如何匹配不在括号中的字符？表达式也可以有任意数量的嵌套括号。换句话说，我想`((2+3)*10)-((10+1)/2)`分成`((2+3)*10)`and `((10+1)/2)`。如果可能的话，我想用正则表达式来做到这一点。我需要知道如何做到这一点，因为我正在解析类似数学的表达式，所以如果这不是要走的路，我该怎么办？

我更喜欢java中的解决方案，但如果它是另一种语言，我也可以弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:34:03.537

您可能想使用[递归下降解析器](http://en.wikipedia.org/wiki/Recursive_descent_parser)。 [这是一篇文章和一些示例代码](http://www.codeproject.com/Articles/318667/Mathematical-Expression-Parser-Using-Recursive-Des)，尽管第一个链接中的维基百科文章有一些很好的示例 C 代码。

递归下降解析器还有其他替代方案，例如[operator-precedence parser](http://en.wikipedia.org/wiki/Operator-precedence_parser)，但我在本科生的经验是使用递归下降解析器（从那时起我没有解析任何数学表达式）。无论哪种方式，您本质上都是按照运算符优先级的顺序解析数学表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T03:45:14.807

您可以使用 Java 的 PCRE 库来实现这一点。

PCRE 的这个特性称为递归模式（[参见文档](http://pcre.org/pcre.txt)）：

```
$ pcretest                                                                                                                                                                                        
PCRE version 8.31 2012-07-06

  re> / (?: \( (?: [^()]++ | (?R) )* \) ) /xg 
data> ((2+3)*10)-((10+1)/2) 
 0: ((2+3)*10)
 0: ((10+1)/2) 
```

我不了解 Java，但在 PHP 中它以这种方式工作：

```
$ php -a
Interactive shell

php > preg_match_all('/ (?: \( (?: [^()]++ | (?R) )* \) ) /x', '((2+3)*10)-((10+1)/2)', $r); var_dump($r);
array(1) {
  [0]=>
  array(2) {
    [0]=>
    string(10) "((2+3)*10)"
    [1]=>
    string(10) "((10+1)/2)"
  }
} 
```

# javascript - 有没有办法从 CoffeeScript 类中的私有函数访问公共成员

> ID：15939673
> 
> 赞同：0
> 
> 时间：2013-04-11T02:24:20.257
> 
> 标签：javascript, coffeescript

如何将此 CoffeeScript 函数转换为一个类，以便私有成员可以访问公共成员？

```
MyClass= -> 
  prVar = 'private'
  prMethod1 = -> 
    console.log 'prMethod'
    self.pubMethod2() 

  public_members =
    pubVar : 'public'
    pubMethod1: -> 
      console.log 'pubMethod1'
      prMethod1() 
    pubMethod2: -> 
      console.log 'pubMethod2'
return public_members 

my = new MyClass()
my.pubMethod1() 
```

我的班级？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T04:36:16.607

我希望以下代码对您有所帮助：

```
@MyClass= -> 
  prVar = 'private'
  prMethod1 = -> 
    console.log 'prMethod'
    public_members.pubMethod2() 

  public_members =
    pubVar : 'public'
    pubMethod1: -> 
      console.log 'pubMethod1'
      prMethod1() 
    pubMethod2: ->  
      console.log 'pubMethod2'
  return public_members 
```

# c++ - 相同的语言环境，不同的输出

> ID：15939674
> 
> 赞同：3
> 
> 时间：2013-04-11T02:24:23.277
> 
> 标签：c++, utf-8, locale, cout

我尝试将 UTF-8 字符串打印到 Windows 控制台。控制台代码页设置为65001（utf-8），字体设置为lucida console，c++源文件编码为utf-8，不带bom。考虑以下代码：

```
#include<iostream>
#include<locale>
#include<clocale>

int main(int narg, char** arg){
    using namespace std;
    cout<<"C++ locale: "<<cout.getloc().name()
        <<"\nC locale: "<<setlocale(LC_ALL, 0)<<"\n";
    cout<<"中文\n";
    printf("中文\n");
    return 0;
} 
```

输出是：

```
C++ locale: C
C locale: C
������
中文 
```

任何人都可以解释它并给出解决方案（使 c++ 和 c 具有相同的正确输出。）？非常感谢。

系统：win7（32位）

编译器：vs2012 express

编辑：该程序在 ubuntu12 下使用 gcc 是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:14:20.057

默认情况下，控制台不会显示 UTF，但是您可以使用：

`chcp 65001`将控制台更改为 UTF 或使用代码通过代码更改它`SetConsoleOutputCP`

希望这些帮助:) 附录：对不起，最初错过了那一点！我可以让 ?diamond 符号出现的唯一方法是使用我的第二台没有国际字体的机器。我不得不手动将 consolas 字体添加到注册表中，但是在 Windows 控制台中显示 utf 字符集时存在严重问题。在我的 windows 2003 机器上，我必须执行以下操作： `Start -> Control Panel -> Regional and Language Options -> Advanced -> Language for non-Unicode programs -> Chinese`

# vim - gVim - 找不到模式：尝试删除换行符时的 ^M

> ID：15939675
> 
> 赞同：9
> 
> 时间：2013-04-11T02:24:23.793
> 
> 标签：vim, newline

我在 Windows 中使用 gVim，当我打开其他人编辑的文件时，我看到 ^M 而不是换行符。我曾尝试用`%s/^M/\n/g`换行符替换 ^M 的所有实例，但我不断收到错误消息：找不到模式：^M。我也试过`%s/^M/\r/g`了，但我收到了同样的错误。

文件中还有几个^M的实例，为什么Vim不能识别？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-11T02:26:15.473

在按下替代命令`CTRL``V`之前按下`CTRL``M`。

这使您可以正确地转义下一个控制序列。

这是我通过谷歌搜索找到的几个链接`vim remove control m`：

*   [http://www.tech-recipes.com/rx/150/remove-m-characters-at-end-of-lines-in-vi/](http://www.tech-recipes.com/rx/150/remove-m-characters-at-end-of-lines-in-vi/)
*   [http://dailyvim.blogspot.com/2009/01/removing-ctrl-m.html](http://dailyvim.blogspot.com/2009/01/removing-ctrl-m.html)
*   [即使文件模式显式为 DOS，gVim 也会显示回车符 (^M)](https://stackoverflow.com/questions/799417/gvim-showing-carriage-return-m-even-when-file-mode-is-explicitly-dos)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T20:43:11.703

你确定它是克拉-M而不是ctrl-M吗？如果它是克拉-M (^M)，那么它将是两个字符。如果它是 ctrl-M 它将是一个。如果是后者，那么[这就是您的解决方案](https://stackoverflow.com/a/136915/1127433)。

# excel - Excel：忽略单元格中的文本，仅计算单元格中的数字

> ID：15939676
> 
> 赞同：-3
> 
> 时间：2013-04-11T02:24:29.920
> 
> 标签：excel

我有一系列需要平均的单元格。大多数单元格包含 0、1 或 0.5。有些单元格包含“0 - 缺席”或“0.5 - 迟到”之类的内容。我想将这些单元格包括在平均值中，但是文本使其复杂化。我可以使用什么公式只计算数字以获得平均值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:46:35.587

如果您的数据不包含空白单元格，则以下公式将产生您想要的平均值。为简单起见，我假设您的数据在 A1:A6 范围内。

```
 =AVERAGE(IFERROR(VALUE(LEFT(A1:A6,SEARCH(" ",A1:A6)-1)),A1:A6)) 
```

![电子表格图像](https://i.stack.imgur.com/REsFM.png)

如果数据范围内确实有空白单元格，则应将公式修改为：

```
 =AVERAGE(IF(ISBLANK(A1:A6),"",IFERROR(VALUE(LEFT(A1:A6,SEARCH(" ",A1:A6)-1)),A1:A6))) 
```

![处理带空格数据的公式](https://i.stack.imgur.com/jYXRP.png)

这些是数组公式，需要使用`Control`- `Shift`-`Enter`组合键输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:36:36.583

这是一种方法；但它需要使用额外的列注意公式在顶部列出，并且它假定字段的掩码与 #space dash space text 的文本数据一致。您必须执行数学函数才能将字符串数据转换为文本数据，否则它会被排除在 avg 中；因此，当存在文本数据时，公式中的 *1。

![在此处输入图像描述](https://i.stack.imgur.com/6kdjH.png)

# jquery - HTML5 动态加载标题 onclick Div 或 Screen

> ID：15939677
> 
> 赞同：0
> 
> 时间：2013-04-11T02:24:47.587
> 
> 标签：jquery, html, fadein, fadeout

每次单击最后加载的标题或单击幻灯片或屏幕时动态地将新标题加载到视图中，就像每次单击屏幕时使用类似于 PowerPoint 的过渡“飞入”或使用箭头键一样块已加载我正在寻找 HTML5 解决方案。每次点击都应加载一个新标题。

为此，我可以使用jQuery 的fadeIn 和fadeOut 效果，但我无法弄清楚如何加载一个接一个的标题并将之前加载的标题保持在顶部，然后是新加载的标题。

我使用jQuery fadeIn 和fadeOut 找到了这个小提琴： http: [//jsfiddle.net/Fyhm7/](http://jsfiddle.net/Fyhm7/)：

```
 <a href="#" data-section="#home">Home</a>
    <a href="#" data-section="#products">Products</a>
    <a href="#" data-section="#contact">Contact</a>

    <div id="wrapper"></div>

    <section id="home">Home</section>
    <section id="products">Products</section>
    <section id="contact">Contact</section>
    $("a").on("click", function() {
        var id = $(this).data("section");

        $("section:visible").fadeOut(function() {
            $(id).fadeIn();
        });
    });

section {
    display: none;
}

    #home { height: 200px; background: beige; display: block;}
    #products { height: 1000px; background: honeydew; }
    #contact { height: 500px; background: seashell; } 
```

但它并不像我们在 Flash 或 PowerPoint 中那样漂亮。另外，它只是页面上的菜单的菜单加载内容onlclick。我需要在每次点击时添加新内容。

[单击导航链接时，](https://stackoverflow.com/questions/11716777/html5-loading-data-section-when-click-on-navigation-link)还在这里找到了另一个类似的解决方案HTML5 Loading data-section

前一个示例显示了几个标题并加载附加到该标题的内容。后者执行类似的操作。

我需要的是在单击屏幕或先前加载的标题时显示的新标题。也许这可以用类似的代码来完成。想法？

周围有什么更好的例子更接近我的需要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:38:21.683

如果需要，可以使用 css 动画。该网站列出了许多可用的 css 动画[http://daneden.me/animate/](http://daneden.me/animate/)。它并不完全是在做你想做的事情，而只是展示了 css 动画能够做什么。

# c# - 如何在 C# 中遍历数组的内容，然后仍然返回整个数组？

> ID：15939681
> 
> 赞同：0
> 
> 时间：2013-04-11T02:25:18.327
> 
> 标签：c#, arrays, for-loop, scope

家庭作业：我正在设计一个刽子手游戏。

我有一个数组（名为`wordToGuess[]`），表示需要猜测的单词。我将它与那个词的蒙面副本进行比较，（命名`displayString[]`- 我知道为了清楚起见我仍然要重命名）。`wordToGuess[]`例如，如果是`[S][T][A][C][K]`，`displayString[]`则初始化为`[*][*][*][*][*]`。当用户猜测一个字母时，我想遍历数组的每个字符，`*`如果匹配，则用字母猜测替换。例如，如果我猜`A`（这是变量`letterGuess`）`A`与数组的每个元素进行比较。如果匹配，则该元素更改为`[A]`。如果不匹配，则元素保留`[*]`. 在这种特殊情况下，最终结果应该是一个填充有`[*][*][A][*][*]`.

```
 public char[] drawProgress(char letterGuess, char[] wordToGuess, char[] displayString)
    {
        for (int a = 0; a < wordToGuess.Length; a++)
        {
            if (wordToGuess[a] == letterGuess)
            {
                displayString[a] = letterGuess;
            }
            return displayString;
        }
    } 
```

**编辑：** 这是我的问题：循环的开头`for`被标记为`unreachable code`，我收到一条错误消息，即`Error 4 'assn5.PromptForLetter.drawProgress(char, char[], char[])': not all code paths return a value`.

我最初认为这是一个范围问题，但评论者另有解释......

所以......如果我的回报在范围内，是什么导致了错误？我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T02:43:54.573

```
 public char[] drawProgress(char letterGuess, char[] wordToGuess, char[] displayString)
    {
        for (int a = 0; a < wordToGuess.Length; a++)
        {
            if (wordToGuess[a] == letterGuess)
            {
                displayString[a] = letterGuess;
            }
        }
        return displayString;
    } 
```

通过以下方式调用它：

```
 var output = drawProgress('O', new char[4] { 'S', 'O', 'B', 'O' }, new char[4] { '*', '*', '*', '*'}); 
```

`output`将是 { `'*', 'O', '*', 'O'`}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T02:45:59.820

.Net 中的数组是引用类型。当您将引用类型传递给函数时，您会在函数中获得一个新变量，但它引用的是内存中的*同一个*对象。这意味着你不必返回任何东西......你传递给函数的原始值将在最后保持正确的值。

你真正想要做的是返回一个布尔值，这样你就知道是否添加到你的刽子手。

```
public bool checkProgress(char letterGuess, char[] wordToGuess, char[] displayString)
{
    bool result = false;
    for (int a = 0; a < wordToGuess.Length; a++)
    {
        if (wordToGuess[a] == letterGuess)
        {
            displayString[a] = letterGuess;
            result = true;
        }
    }
    return result;
} 
```

.

```
var word = "hello world".ToCharArray();
var mask = word.Select(c => c==' '?' ':'*').ToArray();

Console.WriteLine(checkProgress('l', word, mask)); // will output "true"
Console.WriteLine(checkProgress('z', word, mask)); // will output "false"
Console.WriteLine(new string(mask)); // will output "**ll* ***l*" 
```

如果您不了解其中的某些语法，请不要担心：这只是为了设置一个快速测试，您可以将其粘贴到控制台项目的主要功能中以证明它有效。

作为免责声明，为了让您最终对函数参数语义有一个正确的理解，我需要再次提醒您，传递引用类型会在函数内部产生一个*新*变量。这意味着您在更改变量的属性（包括索引）时正在更改原始属性，但是如果您分配给变量本身，则您是在告诉变量指向不同的对象，并且原始对象不再受到影响。这是一个简单的例子：

```
public class Foo
{
    public string text;
}

public void Test(Foo bar)
{
    bar.text = "hello";
    bar = new Foo(); //assigned to variable: it now referrs to a different object. original remains unchanged
    bar.text = "world";
}

var bar = new Foo();
bar.text= "";
Test(bar);
Console.WriteLine(bar.text); // will output "hello" 
```

如果您将 Foo 声明为结构而不是类，这将完全打开它的头，这将使其成为值类型。如果您这样做，示例代码的输出将是原始的空字符串。顺便说一句，原因是学术性的，但你永远不应该设计一个具有可以在构造后更改的属性的结构。如果该类型具有可以变异的数据，则始终更喜欢一个类。

# git - Git 检查是否有未完成的提交要推送

> ID：15939694
> 
> 赞同：6
> 
> 时间：2013-04-11T02:27:11.670
> 
> 标签：git, version-control

有没有可以运行的命令来检查是否有任何提交推送到源/主？

```
git [some command] origin master 
```

会输出类似：

```
origin/master is behind by 7 commits 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T02:31:19.380

以下是列出您拥有的不在 origin/master 上的“额外”提交的两种方法：

```
git log --oneline origin/master..HEAD
git rev-list --oneline ^origin/master HEAD 
```

只是以较短的`--oneline`格式列出它们。此外，如果您的分支跟踪 origin/master，`git status`则会向您显示一个简单的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T02:28:34.910

```
git diff --stat master origin/master 
```

示例输出：

```
classes/Mammoth/Article.php                                            |   12 ++++++++++--
classes/Mammoth/Article/Admin/Section/Controller.php                   |   34 +++++++++++++++++-----------------
classes/Mammoth/Article/Filter.php                                     |   14 +++++++-------
classes/Mammoth/Article/Section.php                                    |   18 ++++++++++--------
classes/Mammoth/Article/Section/IMySQL.php                             |    2 +-
migrations/20130411111424_ChangeNameToURIOnSectionsTable.php           |   14 --------------
migrations/sql/up/20130411111424_ChangeNameToURIOnSectionsTable.sql    |    5 -----
solr-core/conf/schema.xml                                              |    2 +-
views/admin/section/form.php                                           |    8 ++++----
views/admin/section/view.php                                           |   10 +++++-----
10 files changed, 55 insertions(+), 64 deletions(-) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-11T03:12:43.443

如果您了解最新信息（这里的所有其他答案也都假定）

```
$ git checkout
Your branch is ahead of 'origin/master' by 9 commits.
  (use "git push" to publish your local commits) 
```

要获取所有分支机构的信息，

```
$ git branch -avvv 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-24T10:18:19.003

我第一次尝试解决这个问题是这样的：

```
git push --all -n 2>&1 | grep -q 'Everything up-to-date' || 
echo "Outstanding commits to be pushed at $PWD" 
```

It's not robust, as it will claim there are outstanding commits on errors. The biggest problem is that it will ask for username/password i.e. if attempting to push to a github repo with https-link (typically because I did a RO checkout on some repo where I'm not supposed to directly push changes).

The jtill answer seems to fit me the best, as it contains instructions on how to check this for all branches. Hence my second attempt looks like this:

```
 git branch -avvv 2>&1 | grep -q ': ahead ' && 
   echo "Outstanding commits to be pushed at $PWD" 
```

However, this also have at least one caveat - there will be false positives if a commit message contains the string ': ahead '.

So then I have this command for "check the status of all the git repos":

```
for gitrepo in $(find ~ -name '.git')
do 
    cd $(dirname $gitrepo)
    git fetch >/dev/null 2>&1 || 
      echo "Git fetch failed at $PWD"
    git branch -avvv 2>&1 | grep -q ': ahead ' &&
      echo "Outstanding commits to be pushed at $PWD"
done 
```

:-)

# shell - 如何使用输入文件一次运行多个 UNIX 命令

> ID：15939700
> 
> 赞同：0
> 
> 时间：2013-04-11T02:28:15.493
> 
> 标签：shell, unix, scripting

我是 Unix Shell 脚本的新手。如何运行（以下）多个 UNIX 命令（放入脚本中，比如“discover.sh”，`my_log.txt`只使用一次输入文件？最终，我想创建一个别名 [alias discover1='~/discover.sh '] 在我的 .bashrc 中。

喜欢：

```
$ discover1 my_log.txt 
```

当前脚本：

```
/bin/egrep 'Version:|Online \(warning\)|Failed \(offline\)' my_log.txt;
/bin/grep -A7 "syscontrol realmmgr" my_log.txt;
/bin/grep -C2 BIOS my_log.txt; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:33:19.233

`discover.sh`应包含：

```
#!/bin/bash
/bin/egrep 'Version:|Online \(warning\)|Failed \(offline\)' "$1"
/bin/grep -A7 "syscontrol realmmgr" "$1";
/bin/grep -C2 BIOS "$1"; 
```

该变量`$1`自动设置为脚本的第一个参数。

# c# - 使用c#获取facebook用户名

> ID：15939708
> 
> 赞同：0
> 
> 时间：2013-04-11T02:29:48.917
> 
> 标签：c#, facebook, xaml, windows-phone-8

嗨，有什么方法可以让我使用他们的电子邮件和密码获取用户的 Facebook 用户名？我已经完成了用户使用 facebook 登录的身份验证，但我需要一种方法来获取用户名并将其存储在我的 windows azure 数据表中。我在使用 c# 的 windows phone 8 应用程序中执行此操作。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T06:18:05.927

您应该使用这个官方的图形 API 沙箱

[https://developers.facebook.com/tools/explorer/?method=GET&path=me](https://developers.facebook.com/tools/explorer/?method=GET&path=me)

更准确地说，你有访问令牌，然后你做

[https://graph.facebook.com/me?access_token=YOUR_ACCESS_TOKEN](https://graph.facebook.com/me?access_token=YOUR_ACCESS_TOKEN)

或仅返回 id 和用户名

[https://graph.facebook.com/me?fields=username&access_token=YOUR_ACCESS_TOKEN](https://graph.facebook.com/me?fields=username&access_token=YOUR_ACCESS_TOKEN)

就这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:44:46.003

您需要访问 Open Graph API。[您可以在此处查看](https://developers.facebook.com/docs/reference/api/user/)用户的可获取字段列表，用户名就是其中之一。

如果您还没有使用某种 Facebook SDK，那么 Facebook SDK for .NET 非常棒。使用以下链接查看一个很棒的分步教程。[http://facebooksdk.net/docs/phone/tutorial](http://facebooksdk.net/docs/phone/tutorial)标题为“个性化”的部分将向您准确展示该做什么。

# php - 如何让 mysql 数据库 id 随机回显？

> ID：15939713
> 
> 赞同：0
> 
> 时间：2013-04-11T02:30:14.487
> 
> 标签：php, javascript, mysql

我按照在线教程创建了一个 PHP/mysql 搜索数据库。一切都很好。我只想知道如何让数据库中的结果以随机顺序显示。

目前，结果根据其在 mysql 数据库中的 ID 号以数字顺序显示。我想知道如何随机显示结果？

使用 $id 调用 id。这是PHP：

```
<?php

$button = $_GET ['submit'];
$search = $_GET ['search'];

if(strlen($search)<=1)
echo "Search term too short";
else{
echo "<h1>Dislpaying results for <b>$search</b> <hr size='1'></h1></br>";
mysql_connect("localhost","dobhgc767545ch2","jhjhghtyutuhjh");
mysql_select_db("doorcouhjhjh2");

$search_exploded = explode (" ", $search);

foreach($search_exploded as $search_each)
{
$x++;
if($x==1)
$construct .="keywords LIKE '%$search_each%'";
else
$construct .="OR keywords LIKE '%$search_each%'";

}

$constructs ="SELECT * FROM search WHERE $construct";
$run = mysql_query($constructs);

$foundnum = mysql_num_rows($run);

if ($foundnum==0)
echo "Sorry, there are no matching result for <b>$search</b>.</br></br>1.
Try more general words. for example: If you want to search 'how to create a website'
then use general keyword like 'create' 'website'</br>2\. Try different words with similar
 meaning</br>3\. Please check your spelling";
else
{

echo "$foundnum results found !<p>";

$per_page = 9;
$start = $_GET['start'];
$max_pages = $foundnum / $per_page;
if(!$start)
$start=0;
$getquery = mysql_query("SELECT * FROM search WHERE $construct LIMIT $start, $per_page");

while($runrows = mysql_fetch_assoc($getquery))
{
$title = $runrows ['title'];
$description = $runrows ['description'];
$link = $runrows ['link'];
$image = $runrows ['image'];

echo "
<div class=\"pagination\" style=\"display:inline\"><ul style=\"background-color:#\"><li><div      class=\"span3_search\"><div class=\"title_bg\"><h2><a href='$link'><b>$title</b>    </a></h2></div><div class=\"result_img\"><a href='$link'><img id=\"result_img\" src=\"$image\" /></a>    </div><div class=\"result_desc\"><p>$description</p></div><div class=\"result_link\"><br />
<a href='$link'>$link<br /><br /></a><p></div></div></li></ul></div>
";

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T02:34:27.230

如果它是一个小数据集，你可以只使用 mysql 的

```
ORDER by RAND() 
```

不要在大型​​数据集上这样做，它非常低效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:33:38.357

```
$constructs ="SELECT * FROM search WHERE $construct ORDER BY rand()"; 
```

# javascript - “setInterval”对浏览器行为有影响吗？

> ID：15939714
> 
> 赞同：0
> 
> 时间：2013-04-11T02:30:30.877
> 
> 标签：javascript, setinterval

`setInterval`JavaScript 中的函数会减慢浏览器的速度甚至导致浏览器崩溃吗？

假设我有一个包含数千个（大约 10,000 个）的页面`<div>`，我遍历它们并附加一些 HTML，如下所示：

```
var counter = 0;

setInterval(function() {
    $('div').each(function(i, e) {
        counter++;
        $(this).html('Added contents for DIV at index: ' + counter);
    });
}, 1); 
```

我特意`counter++`在每个函数下设置了 ，这样我们可能会减慢这个脚本执行的过程，而且我知道我可以只使用`i`jQuery`$.each()`函数中的参数。

重复的间隔时间是 1 毫秒，我想知道：

**以如此低的速度间隔工作是否安全？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:55:04.340

```
Can setInterval function in JavaScript slow down a browser or even cause a browser crash? 
```

不，这取决于您在 setInterval 函数中执行的操作。

10000 个 div 非常大，浏览器会因为大量回流而崩溃。但是，如果您使用片段，您可以克服浏览器崩溃问题。

```
Is it secure to have intervals work at this low rate? 
```

你必须回答这个问题。如果您认为您将在 setInterval 中执行的工作需要 1 毫秒，那么这不是问题。

# python - 为什么 python @property getter 方法每次调用都会运行两次，我可以停止它吗？

> ID：15939716
> 
> 赞同：2
> 
> 时间：2013-04-11T02:30:50.560
> 
> 标签：python, class, properties, getter-setter

我有一个行为不端的 iPython，它运行了两次 getter（但不是 setter）：

```
class C(object):
    @property
    def foo(self):
        print 'running C.foo getter'
        return 'foo'
    @foo.setter
    def foo(self, value):
        print 'running setter' 
```

来自 ipython 的日志：

```
In [2]: c = C()

In [3]: c.foo
running C.foo getter
running C.foo getter
Out[3]: 'foo'

In [4]: c.foo = 3
running setter 
```

环境是

*   Python 2.7.3（默认，2012 年 12 月 6 日，13:30:21）
*   IPython 0.13.1
*   带有最新开发工具更新的 OSX ML
*   一个有很多东西的venv

这不再是一个代码问题，因为这似乎不是属性正常工作的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-05-18T20:36:51.803

这是一个老问题，但问题在 IPython 6.0.0 中仍然存在

解决方案是使用

```
%config Completer.use_jedi = False 
```

在解释器中，或添加

```
c.Completer.use_jedi = False 
```

到 ipython_config.py 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T17:02:32.593

也许它与[iPython issue 62](https://github.com/ipython/ipython/issues/62)有关。该问题已关闭，但仍然影响我和其他人。

要复制我对这个问题的特殊风格（这似乎是我的环境所独有的），将此文件另存为 doubletake.py

```
class C(object):
    @property
    def foo(self):
        print 'running C.foo getter'
        return 'foo'
    @foo.setter
    def foo(self, value):
        print 'running setter'

if __name__ == '__main__':
    print 'Calling getter of anonymous instance only runs the getter once (as it should)'
    C().foo
    print "Call named instance of C's foo getter in interactive iPython session & it will run twice"
    from doubletake import C
    c = C()
    c.foo 
```

然后在 iPython 中使用这个交互式会话运行它

```
from doubletake import C

C().foo
# running C.foo getter
# 'foo'

c=C()
c.foo
# running C.foo getter
# running C.foo getter
# 'foo'

%run doubletake
# Calling getter of anonymous instance only runs the getter once (as it should)
# running C.foo getter
# Call named instance of C's foo getter in interactive iPython session & it will run twice
# running C.foo getter 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-29T17:06:25.463

Python 不会将属性存储在内存中。Python 中的属性只是一个没有 () 的方法。因此，它会在您每次访问该属性时运行。它违背了 IMO 属性的目的。**您可以将属性方法的结果存储在init**方法内部的属性中。但是，这是多余的，如果您需要将值持久保存在内存中，则最好不要一开始就使用属性。

就我而言，我需要存储随请求下载的文本。每次我访问该物业时，它都会从互联网上检索文本。如果您需要做一些流程密集型的事情，请使用一种方法来执行此操作并将其存储在属性中。如果它很简单，请使用属性。

# c++ - std::remove_if 中谓词函数的使用

> ID：15939721
> 
> 赞同：4
> 
> 时间：2013-04-11T02:31:25.723
> 
> 标签：c++

我有一个对象向量。我的数据结构如下：

```
 class my_class{
       float a; int b;
 };
 my_class obj;
 vector<my_class> vec; 
```

向量 vec 包含以下形式的数据：

```
 vec
 ((10.0,2),(100,3),(19.0,3)...) 
```

现在，我打算从向量 vec 中删除小于或等于 vec 的最后一个元素的元素……为此，我使用了 erase 和 remove_if 函数：

```
vec.erase(std::remove_if(vec.begin(), vec.end(), predicate_function(vec, (vec.end()-1).a, (vec.end()-1).b)), vec.end()); 
```

我拥有的 predicate_function 对“vec”进行了迭代。然而，这违背了使用 std::remove_if 的目的。有人可以帮忙看看 predicate_function 应该是什么样子才能使 remove_if 工作。我不想使用 lambda_function。我的编译器也是 GCC

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T02:36:27.510

谓词函数将自动从每个迭代器传递参数。所以它看起来像：

```
bool predicate_function(const my_class& m)
{
    //Some logic here
} 
```

然后将其简单地称为：

```
vec.erase(std::remove_if(vec.begin(), vec.end(), predicate_function), vec.end()); 
```

在 C++ 术语中，`std::remove_if`期望 a`UnaryPredicate`作为其第三个参数，它是接受 1 个参数并返回的函数或仿函数`bool`。

编辑：要在评论中做你想做的事，你需要使用 a `functor`（或`std::bind`，但我们会在这里走仿函数路线）：

```
struct compare_last
{
    const my_class last_;

    compare_last(const my_class& last)
      : last_(last)
    { }

    bool operator()(const my_class& m) const
    {
        return m == last_; //Or however you do your comparisons
    }
};

my_class& last = *(--vec.end());
vec.erase(std::remove_if(vec.begin(), vec.end(), compare_last(last)), vec.end()); 
```

# c# - 如何在 Visual Studio 中使类成为子文件夹或可折叠

> ID：15939723
> 
> 赞同：-1
> 
> 时间：2013-04-11T02:31:32.763
> 
> 标签：c#, class, subdirectory

你如何在 Visual Studio 2010 中做到这一点？

它就像一堂课，但可折叠。有人有想法吗？

谢谢！

![在此处输入图像描述](https://i.stack.imgur.com/8SHPH.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:47:17.347

Visual Studio 库中有几个扩展说明它们提供此功能，例如：

*   [VS命令](http://visualstudiogallery.msdn.microsoft.com/d491911d-97f3-4cf6-87b0-6a2882120acf)
*   [巢内](http://visualstudiogallery.msdn.microsoft.com/9d6ef0ce-2bef-4a82-9a84-7718caa5bb45)

听起来 NestIn 是您所追求的，VSCommands 列出了它具有更多功能（我从未使用过它，因此无法以任何方式发表评论）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T03:03:47.587

您可以`<DependentUpon>`在`<projectName>.csproj`.

您将不得不***手动***编辑您的`<projectName>.csproj`文件。

下面是一个例子： 这里`FxTradingInvoice.cs`和`RemittanceInvoice.cs`被添加为 DependentUpon `Invoice.cs`。这将提供与您在解决方案资源管理器中截图相同的视图。

***WpfApplication1.csproj：***

```
<Compile Include="Invoice.cs"/>
<Compile Include="FxTradingInvoice.cs">
  <DependentUpon>Invoice.cs</DependentUpon>
</Compile>
<Compile Include="RemittanceInvoice.cs">
  <DependentUpon>Invoice.cs</DependentUpon>
</Compile> 
```

***输出：***

![在此处输入图像描述](https://i.stack.imgur.com/GWHhO.png)

# vb.net - 创建一个新的剪贴板

> ID：15939729
> 
> 赞同：0
> 
> 时间：2013-04-11T02:32:08.273
> 
> 标签：vb.net, window

在 vb.net 中是否有创建或新建一个新的剪贴板而不是使用操作系统本身的本机剪贴板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T05:21:43.607

从“剪贴板挂钩”开始。这是实现剪贴板挂钩的文章。

[http://www.codeproject.com/Articles/19858/Global-Windows-Hooks](http://www.codeproject.com/Articles/19858/Global-Windows-Hooks)

# python - 如何按字母顺序对这本字典进行排序？

> ID：15939732
> 
> 赞同：2
> 
> 时间：2013-04-11T02:32:33.580
> 
> 标签：python, python-3.x

这是字典：

```
lettersandnumbers = {'Z': 1, 'Y': 0, 'X': 1, 'W': 17, 'V': 4, 'U': 0,\
 'T': 22, 'S': 21, 'R': 31, 'Q': 0, 'P': 12, 'O': 8,\
 'N': 10, 'M': 29, 'L': 27, 'K': 14, 'J': 51, 'I': 7,\
 'H': 14, 'G': 21, 'F': 12, 'E': 27, 'D': 40, 'C': 43,\
 'B': 28, 'A': 34} 
```

我希望它按字母顺序排序。我试过把它做成一个列表，这样我就可以使用 sorted 函数，但我完全迷路了。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T02:55:07.497

有几种方法可以进行迭代，上面的链接描述了对字典进行排序以供一次性使用的方法。如果您需要*持久*的有序字典，从 Python 2.7 和 3.x 开始，您可以使用*OrderedDict*集合，请参见下面的示例：

```
>>> from collections import OrderedDict
# Random dictionary
>>> foo = {'a': 1, 'b':2, 'e':4, 'd':6, 'f': 7}
>>> foo
{'a': 1, 'b':2, 'e':4, 'd':6, 'f': 7}
# OrderedDict remember order of insert, hence to maintain a sorted
# dictionary entry, we must supplies a sorted tuple the example below
# sorted by entry key
>>> bar = OrderedDict(sorted(foo.items(), key=lambda t: t[0]))
>>> bar
OrderedDict([('a', 1), ('b', 2), ('d', 6), ('e', 4), ('f', 7)]) 
```

尽管符号不同，*bar*对象的功能与字典相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T02:36:30.507

字典只是一个容器。如果要按排序顺序迭代键，请参阅[在 Python 中，如何按排序顺序迭代字典？](https://stackoverflow.com/questions/364519/in-python-how-to-i-iterate-over-a-dictionary-in-sorted-order)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T04:25:49.610

由于@Nerolynx 拒绝使用这种更简单、更快速的方法

```
>>> from collections import OrderedDict
>>> d = {'Z': 1, 'Y': 0, 'X': 1, 'W': 17, 'V': 4, 'U': 0, 'T': 22, 'S': 21, 'R': 31, 'Q': 0, 'P': 12, 'O': 8,'N': 10, 'M': 29, 'L': 27, 'K': 14, 'J': 51, 'I': 7,      'H': 14, 'G': 21, 'F': 12, 'E': 27, 'D': 40, 'C': 43, 'B': 28, 'A': 34}
>>> OrderedDict(sorted(d.items()))
OrderedDict([('A', 34), ('B', 28), ('C', 43), ('D', 40), ('E', 27), ('F', 12), ('G', 21), ('H', 14), ('I', 7), ('J', 51), ('K', 14), ('L', 27), ('M', 29), ('N', 10), ('O', 8), ('P', 12), ('Q', 0), ('R', 31), ('S', 21), ('T', 22), ('U', 0), ('V', 4), ('W', 17), ('X', 1), ('Y', 0), ('Z', 1)]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T04:45:48.060

```
>>> from collections import OrderedDict
>>> from string import ascii_uppercase as alphabet
>>> d = {'Z': 1, 'Y': 0, 'X': 1, 'W': 17, 'V': 4, 'U': 0, 'T': 22, 'S': 21, 'R': 31, 'Q': 0, 'P': 12, 'O': 8,'N': 10, 'M': 29, 'L': 27, 'K': 14, 'J': 51, 'I': 7,      'H': 14, 'G': 21, 'F': 12, 'E': 27, 'D': 40, 'C': 43, 'B': 28, 'A': 34}
>>> OrderedDict((k, d[k]) for k in alphabet if k in d)
OrderedDict([('A', 34), ('B', 28), ('C', 43), ('D', 40), ('E', 27), ('F', 12), ('G', 21), ('H', 14), ('I', 7), ('J', 51), ('K', 14), ('L', 27), ('M', 29), ('N', 10), ('O', 8), ('P', 12), ('Q', 0), ('R', 31), ('S', 21), ('T', 22), ('U', 0), ('V', 4), ('W', 17), ('X', 1), ('Y', 0), ('Z', 1)]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T04:46:26.693

如果使用`[some dict].items()`，它会生成一个元组列表：

```
>>> d={3:'three',35:'thirty five',100:'one hindred'}
>>> d
{35: 'thirty five', 3: 'three', 100: 'one hindred'}
>>> d.items()
[(35, 'thirty five'), (3, 'three'), (100, 'one hindred')] 
```

元组在 Python 中是可排序的：

```
>>> sorted(d.items())
[(3, 'three'), (35, 'thirty five'), (100, 'one hindred')] 
```

因此，您的字典会按照 Python 的默认排序顺序进行排序：

```
>>> lettersandnumbers = {'Z': 1, 'Y': 0, 'X': 1, 'W': 17, 'V': 4, 'U': 0,'T': 22, 'S': 21, 'R': 31, 'Q': 0, 'P': 12, 'O': 8,'N': 10, 'M': 29, 'L': 27, 'K': 14, 'J': 51, 'I': 7,'H': 14, 'G': 21, 'F': 12, 'E': 27, 'D': 40, 'C': 43,'B': 28, 'A': 34}
>>> sorted(lettersandnumbers.items())
[('A', 34), ('B', 28), ('C', 43), ('D', 40), ('E', 27), ('F', 12), ('G', 21), ('H', 14), ('I', 7), ('J', 51), ('K', 14), ('L', 27), ('M', 29), ('N', 10), ('O', 8), ('P', 12), ('Q', 0), ('R', 31), ('S', 21), ('T', 22), ('U', 0), ('V', 4), ('W', 17), ('X', 1), ('Y', 0), ('Z', 1)] 
```

（如果所需的顺序与默认顺序不同，您可能需要使用 sorted 的`key`参数。在这种情况下，默认值有效。）

然后，如果您想要一个保持此顺序的字典：

```
>>> from collections import OrderedDict
>>> od=OrderedDict(sorted(lettersandnumbers.items()))
>>> od.items()[0]
('A', 34)
>>> od.items()[-1]
('Z', 1) 
```

但是有序字典是基于插入顺序的，所以如果你添加任何不是排序顺序的东西，它将是未排序的。

更好的是，避免制作不必要的 dict 副本，并在当前排序顺序中根据需要对 dict 进行迭代：

```
for k,v in sorted(d.items()): 
    # deal with the key and value in sorted order at that moment... 
```

使用 Python 2，您需要使用 d.iteritems() 或者您将生成 2 个临时列表：1 个用于项目，1 个用于排序。使用 Py 3（或使用 Py 2 和 d.iteritems() 方法）只为排序生成 1 个临时列表。

# android - 我将图像资源文件放在哪里？BitmapFactory.decodeFile()

> ID：15939733
> 
> 赞同：1
> 
> 时间：2013-04-11T02:32:38.770
> 
> 标签：android, bitmap, resources, directory, bitmapfactory

我正在尝试使用这个：

> BitmapFactory.decodeFile("logo.jpg")

与我的 apk 相比，我似乎没有文件：logo.jpg 在正确的位置。它应该去哪里？

PS我得到的错误是：![在此处输入图像描述](https://i.stack.imgur.com/PKaKV.png)

**编辑**

我现在正在使用这个：>BitmapFactory.decodeResource(getActivity().getResources(),"logo.jpg")

现在我收到一个编译器错误，上面写着：

> 对于 Brick 类型，方法 getActivity() 未定义（Brick 是类的名称）

我不在乎哪种解决方案有效，只要其中一个有效

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:43:20.970

你想把你的“logo.jpg”文件放在哪里？

1.  如果您想将其放在可绘制文件夹中，请使用：

    ```
    BitmapFactory.decodeResource(getResources(), R.drawable.logo); 
    ```

2.  如果您想将其放在设备内存中的某个位置，请使用：

    ```
    BitmapFactory.decodeResource("/sdcard/logo.jpg"); 
    ```

这里有一些指南可以帮助您开始：http: [//developer.android.com/reference/android/graphics/BitmapFactory.html](http://developer.android.com/reference/android/graphics/BitmapFactory.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T12:03:39.917

我认为您要做的是将JPG文件放入您的项目并通过Java代码加载，对吗？

如果是这样，您需要将您的`logo.jpg`放入`assets`文件夹中，

并使用与此 SO 答案所述类似的方法加载它：

[https://stackoverflow.com/a/8502231/763459](https://stackoverflow.com/a/8502231/763459)

* * *

为方便起见，我将代码粘贴如下：

```
InputStream bitmap=null;

try {
    bitmap=getAssets().open("logo.png");
    Bitmap bit=BitmapFactory.decodeStream(bitmap);
    img.setImageBitmap(bit);
} catch (IOException e) {
    e.printStackTrace();
} finally {
    if(bitmap!=null)
    bitmap.close();
} 
```

# methods - 无效操作：s[k]（*S 类型的索引）

> ID：15939734
> 
> 赞同：5
> 
> 时间：2013-04-11T02:32:42.350
> 
> 标签：methods, interface, go

我想定义这样的类型：

```
type S map[string]interface{} 
```

我想向这样的类型添加一个方法：

```
func (s *S) Get( k string) (interface {}){
    return s[k]
} 
```

当程序运行时，出现如下错误：

```
invalid operation: s[k] (index of type *S) 
```

那么，如何定义类型并将方法添加到类型中呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-11T02:45:05.313

例如，

```
package main

import "fmt"

type S map[string]interface{}

func (s *S) Get(k string) interface{} {
    return (*s)[k]
}

func main() {
    s := S{"t": int(42)}
    fmt.Println(s)
    t := s.Get("t")
    fmt.Println(t)
} 
```

输出：

```
map[t:42]
42 
```

映射是引用类型，其中包含指向底层映射的指针，因此您通常不需要为`s`. 我添加了一种`(s S) Put`方法来强调这一点。例如，

```
package main

import "fmt"

type S map[string]interface{}

func (s S) Get(k string) interface{} {
    return s[k]
}

func (s S) Put(k string, v interface{}) {
    s[k] = v
}

func main() {
    s := S{"t": int(42)}
    fmt.Println(s)
    t := s.Get("t")
    fmt.Println(t)
    s.Put("K", "V")
    fmt.Println(s)
} 
```

输出：

```
map[t:42]
42
map[t:42 K:V] 
```

# java - 的定义

> ID：15939738
> 
> 赞同：-1
> 
> 时间：2013-04-11T02:33:03.747
> 
> 标签：java

我很困惑是什么`<E>`意思。我对用什么代替 E 感到困惑。有人告诉我，可以将类型放在那里，例如 Integer 或 Double。但我也被告知可以将 ArrayList 或 LinkedList 放在那里。如果有人能澄清，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T02:37:28.560

`E`是一个[**类型变量**](https://en.wikipedia.org/wiki/Type_variable)。它是特定类型的变量和占位符。

这种语法与[参数多态性](http://en.wikipedia.org/wiki/Parametric_polymorphism)一起使用，当你想告诉一个特定的类是在一个未指定的类型上参数化时。

这意味着您可以编写依赖于特定类型的代码，`E`该特定类型具有您可以添加的一些约束给定的规范度，例如`<E extends MySuperType>`. 您可以使用`E`在整个类定义中引用泛型类型。

你被告知是正确的：因为变量只不过是一个占位符，它可以包含一个具体的类型，如 a `Double`，但甚至是 an`ArrayList<Double>`或最后也是 an `ArrayList<?>`，它是未指定类型的集合。[是Java 泛型](http://docs.oracle.com/javase/tutorial/java/generics/)中`?`的另一个特殊[关键字](http://docs.oracle.com/javase/tutorial/java/generics/wildcards.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T02:36:20.503

`<E>`是一个类型参数，在[Java 泛型](http://docs.oracle.com/javase/tutorial/extra/generics/index.html)中使用，指定一些稍后有用的类型。例如，在一个容器类中，当您第一次编写它时，您不知道其中会包含什么，但您的实现会关心其中的内容。

通常，您会看到如下内容：

```
List somelist = new ArrayList<Integer>(); //or some other type 
```

意思是`ArrayList`将举行`Integers`。当然，无论你用什么类型代替 ，实现都是一样的`Integer`，但是 Java 要求你声明所有引用对象的类型。（或者你可能很懒，只是说它是一个`Object`，但这破坏了打字系统的实用性。）

在其他时候，您可能会看到

```
class Queue<T> {
   private LinkedList<T> items = new LinkedList<T>();
   public void enqueue(T item) {
      items.addLast(item);
   }
   public T dequeue() {
      return items.removeFirst();
   }
   public boolean isEmpty() {
      return (items.size() == 0);
   }
} 
```

（取自[Javanotes](http://math.hws.edu/javanotes/c10/s5.html)）。`T`类定义中的变量捕获传入的类型，并且`T`可以用来代替传入的任何类型。例如，该方法`dequeue`返回一些对象，但具体是 type `T`，只有在编写类之后才知道。在 method`enqueue`中，您希望将一些对象添加到您的队列中，但特别是 type `T`，直到您实例化您的类的实例时您才知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T02:36:25.477

< E > 是要传入的“类型”的占位符。这是列表将保存的类型。例如在 arrayList 上的实现。当您想创建一个新的数组列表时，您需要传入列表将保存的对象类型。

ArrayList 示例 = new ArrayList ();

如果我们要查看 arrayList 类，它会是这样的

公共类 ArrayList < E > {...}

基本上是说我们将持有一些“类型”的列表，但该类型必须在编译时传入，直到那时才知道

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T02:39:50.410

`<E>`in generics 只是泛型类型的占位符。

这是必要的，因为您需要在您正在编写的方法或类中提供某种引用，以便使用返回类型等中的类型。

如果您只看一下集合 API，您将会看到很多示例。

一般来说，如果你有，`E`你可以传递任何类型作为该参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T03:09:48.437

`<E>`是一个类型参数。就像变量可以保存值一样，类型参数也可以保存类型。例如，如果你想创建一个包含两个*任何*类型的**安全**值的类，你可以这样做：

```
class Pair<T1, T2> {
    private final T1 first;
    private final T2 second;

    public Pair(final T1 first, final T2 second) {
      this.first = first;
      this.second = second;
    }

    public T1 first() {return first;}

    public T2 second() {return second;}

    public static <A, B> Pair<A, B> of(final A first, final B second) {
        return new Pair<A, B>(first, second);
    }
} 
```

这里我们在两个地方使用了类型参数：一个用于类抽象字段类型，另一个用于静态工厂方法`of`抽象它创建的对类型。我们可以像这样使用这个类：

```
public static void main(final String[] args) {
    final Pair<Integer, String> intStringPair = Pair.of(1, "One");
    final int intStringPairFirst = intStringPair.first();
    final String intStringPairSecond = intStringPair.second();

    final Pair<List<String>, Boolean> listBoolPair = Pair.of(
            Arrays.asList("foo", "bar"), true);
    final List<String> listBoolPairFirst = listBoolPair.first();
    final boolean listBoolPairSecond = listBoolPair.second();
} 
```

在这里，您可以看到如何在不涉及任何强制转换的情况下正确推断`intStringPairFirst`、`intStringPairSecond`、`listBoolPairFirst`、的类型。`listBoolPairSecond`

这是为了让你开始。它还有更多的东西，比如方差、使用`extends`和`super`和通配符 ( `?`) 的界限，我建议你阅读泛型教程。

# c - 这种条件检查是如何工作的？

> ID：15939742
> 
> 赞同：0
> 
> 时间：2013-04-11T02:33:46.823
> 
> 标签：c, pointers

我写了一个通过指针反转字符串的函数，代码运行良好，没有错误，但有些事情我想知道。

这是我的代码：

```
char * xstrrev(char *s1, char *s2){
 register char *p = s1;
 register char *q = s2;
 char *r  = s2;
  do{

     *(s2++) = *(p++); //first copy the string, afterwards, replace it

  }while(*p);
  p--; //to eliminate trailing '\0' while reversing.
  do {
    *(q++) = *(p--); //replace contents by reverse contents,
  }while(*q);
  return r;
} 
```

在这里，在倒数第三行， *q 必须有一个 value `'\0'`，因为，我们之前复制了确切的字符串，所以，`'\0'`必须已经复制了。

但是，当我更换我的

> *(s2++) = *(p++);

和

> p++;

即，我只增加到`p`字符串的末尾，并且不将字符串复制到`s2`，条件

> 而(*q)

仍然有效。在这种情况下，`*q`不应该有`\0`，对吧？那么这个条件是如何工作的呢？

当我更换时，它是一样`while(*q)`的`while(*q!='\0')`

编辑:: 它被称为：

```
char  a[110]= "hello";
char f[116];
xstrrev(a,f); //reverse a and put to f
puts(f); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T02:40:42.550

如果它起作用了，那完全是偶然的。调用者提供的字符串`s2`可能`\0`在`s2`. 但是你不能依赖这个，它取决于调用者如何初始化它传递的字符串。

另一种可能性是内存权利 BEFORE`a`恰好包含`\0`. 如果您有以下情况，可能会发生这种情况：

```
char something[] = "foo";
char a[110] = "nacan"; 
```

内存 for`something`就在内存 for 之前`a`，因此`something`的尾随 null 将在 的第一个字节之前`a`。

在这种情况下发生的情况是循环复制了这个`\0', but it doesn't stop immediately. It keeps on copying until it eventually runs in to a`\0 `in`*q `. But when you look at`f `, you just see the reverse of`a`，因为这个空字节被复制了。

如果您想看到这种情况发生，请在调试器中单步执行您的函数。

C 语言不能保证这一切，这只是内存布局通常完成的方式。

# python - 为什么我的 Python 脚本没有将最后几行写入我的文件？

> ID：15939746
> 
> 赞同：2
> 
> 时间：2013-04-11T02:34:17.353
> 
> 标签：python, file, limit

我一直在尝试从一个文件中读取数字列表，将它们拆分，然后将它们放入另一个文件中。在弄乱了一些调试打印之后，我得出的结论是，问题不在于我的字符串的循环或拆分，而在于我实际*写入*新文件的脚本的最后一行。

它不是像我想要的那样写，而是通过文件的大部分方式，然后只是不写文件的最后几行。我可以在脚本中写的东西的数量是否有限制？还是这里发生了其他事情？

这是脚本：导入字符串

```
#constants to name out in/out files
INFILE = 'newkicBright.txt'
OUTFILE = 'out.txt'

#open both files
inHandle = open(INFILE, 'r')
outHandle = open(OUTFILE, 'w')

#console verifies that everything's opened
print inHandle
print outHandle

#read our data into the file!
for line in inHandle:
    nums = string.split(line)
    for num in nums:
        num += " PLACEHOLDER\n"
        outHandle.write(num) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T02:50:00.567

您需要关闭文件处理程序，以便它实际写入并清理所有内容。

```
outHandle.close() 
```

将其添加到末尾。

`close`暗示`flush`：[close() 在 Python 中是否暗示 flush()？](https://stackoverflow.com/questions/2447143/does-close-imply-flush-in-python)

# python - 检查numpy数组中的每个元素是否在另一个数组中

> ID：15939748
> 
> 赞同：25
> 
> 时间：2013-04-11T02:34:29.367
> 
> 标签：python, numpy

这个问题看起来很简单，但我无法得到一个好看的解决方案。我有两个 numpy 数组（A 和 B），我想获取 A 的索引，其中 A 的元素在 B 中，还获取 A 的索引，其中元素不在 B 中。

因此，如果

```
A = np.array([1,2,3,4,5,6,7])
B = np.array([2,4,6]) 
```

目前我正在使用

```
C = np.searchsorted(A,B) 
```

它利用了`A`有序的事实，并为我提供`[1, 3, 5]`了 中的元素的索引`A`。这很棒，但是我如何获得那些不在其中`D = [0,2,4,6]`的元素的索引？`A``B`

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-04-11T03:51:42.267

`searchsorted`如果不是 B 的每个元素都在 A 中，可能会给您错误的答案。您可以使用[`numpy.in1d`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.in1d.html)：

```
A = np.array([1,2,3,4,5,6,7])
B = np.array([2,4,6,8])
mask = np.in1d(A, B)
print np.where(mask)[0]
print np.where(~mask)[0] 
```

输出是：

```
[1 3 5]
[0 2 4 6] 
```

但是`in1d()`使用排序，这对于大型数据集来说很慢。如果您的数据集很大，您可以使用 pandas：

```
import pandas as pd
np.where(pd.Index(pd.unique(B)).get_indexer(A) >= 0)[0] 
```

下面是时间对比：

```
A = np.random.randint(0, 1000, 10000)
B = np.random.randint(0, 1000, 10000)

%timeit np.where(np.in1d(A, B))[0]
%timeit np.where(pd.Index(pd.unique(B)).get_indexer(A) >= 0)[0] 
```

输出：

```
100 loops, best of 3: 2.09 ms per loop
1000 loops, best of 3: 594 µs per loop 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-11T02:40:26.727

```
import numpy as np

A = np.array([1,2,3,4,5,6,7])
B = np.array([2,4,6])
C = np.searchsorted(A, B)

D = np.delete(np.arange(np.alen(A)), C)

D
#array([0, 2, 4, 6]) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-11T02:48:04.303

```
import numpy as np

a = np.array([1, 2, 3, 4, 5, 6, 7])
b = np.array([2, 4, 6])
c = np.searchsorted(a, b)
d = np.searchsorted(a, np.setdiff1d(a, b))

d
#array([0, 2, 4, 6]) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-05-11T15:22:39.480

# A 中也在 B 中的元素：

设置（A）和设置（B）

# A 中不在 B 中的元素：

集合(A) - 集合(B)

# xml - 将 XSLT 文本提取限制到特定字段

> ID：15939749
> 
> 赞同：0
> 
> 时间：2013-04-11T02:34:42.357
> 
> 标签：xml, xslt, text, extraction

XSLT 还是很新的；我正在尝试使用 XSLT (1.0) 从 XML 文件中提取某些字段，并且仅提取某些字段。下面是实际 XML 文档的简化形式：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Transaction>
  <TradeMarkTransactionBody>
    <TransactionContentDetails>
      <TransactionCode>National Trademark Information</TransactionCode>
      <TransactionData>
        <TradeMarkDetails>
          <TradeMark>
            <RegistrationOfficeCode>US</RegistrationOfficeCode>
            <ApplicationNumber>74631225</ApplicationNumber>
            <ApplicationDate>1995-02-07-05:00</ApplicationDate>
            <RegistrationNumber>2178784</RegistrationNumber>
            <RegistrationDate>1998-08-04-04:00</RegistrationDate>
            <FilingPlace>US</FilingPlace>
            <MarkCurrentStatusDate>2008-08-11-04:00</MarkCurrentStatusDate>
            <WordMarkSpecification>
              <MarkVerbalElementText>JAVA </MarkVerbalElementText>
            </WordMarkSpecification>
          </TradeMark>
        </TradeMarkDetails>
      </TransactionData>
    </TransactionContentDetails>
  </TradeMarkTransactionBody>
</Transaction> 
```

这是我的 XSLT 尝试：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="text" encoding="utf-8" />
<xsl:strip-space elements="*"/>

<xsl:template match="Transaction">
<xsl:apply-templates/>
</xsl:template>

<xsl:template match="TradeMark">
MarkCurrentStatusDate,"<xsl:value-of select="MarkCurrentStatusDate"/>"
ApplicationNumber,"<xsl:value-of select="ApplicationNumber"/>"
ApplicationDate,"<xsl:value-of select="ApplicationDate"/>"
RegistrationNumber,"<xsl:value-of select="RegistrationNumber"/>"
RegistrationDate,"<xsl:value-of select="RegistrationDate"/>"
ExpirationDate,"<xsl:value-of select="ExpirationDate"/>"
<xsl:apply-templates select="WordMarkSpecification"/>
</xsl:template>

<xsl:template match="WordMarkSpecification">
MarkVerbalElementText,"<xsl:value-of select="normalize-space(MarkVerbalElementText)"/>"
</xsl:template>
</xsl:stylesheet> 
```

这几乎可以工作，导致：

```
National Trademark Information
MarkCurrentStatusDate,"2008-08-11-04:00"
ApplicationNumber,"74631225"
ApplicationDate,"1995-02-07-05:00"
RegistrationNumber,"2178784"
RegistrationDate,"1998-08-04-04:00"
ExpirationDate,""

MarkVerbalElementText,"JAVA" 
```

我的问题：1）我怎样才能避免拾取不需要的数据，比如`TransactionCode`（“ `National Trademark Information`”在输出中）；和 2）如何避免和之间的空白`ExpirationDate`行`MarkVerbalElementText`？（我已经确认它不是 XSLT 文件中的空行；将它们排除在外不会产生影响。）

（我怀疑这两个问题可能只有一个答案；我以某种方式保留了未选择的`MarkVerbalElementText`文本，*并且*一些未选择的换行符。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:53:27.737

您快到了。您的第一个模板“使用”整个文档，如果您只需要`TradeMark`标签，只需将其应用于感兴趣的标签。

```
<xsl:template match="Transaction">
    <xsl:apply-templates select=".//TradeMark"/>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T04:00:20.453

这是另一种（有些复杂的）拉取方法：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:util="urn:util">

    <xsl:output
        method="text" 
        encoding="utf-8"/>

    <xsl:strip-space elements="*"/>

    <xsl:variable name="fields" select="document('')/*/util:fields"/>
    <util:fields>
        <field>MarkCurrentStatusDate</field>
        <field>ApplicationNumber</field>
        <field>ApplicationDate</field>
        <field>RegistrationNumber</field>
        <field>RegistrationDate</field>
        <field>ExpirationDate</field>
        <field>MarkVerbalElementText</field>
    </util:fields>

    <xsl:template match="/">
        <xsl:variable name="xml" select="."/>
        <xsl:for-each select="$fields/field">
            <xsl:variable name="f" select="."/>
            <xsl:value-of select="$f"/>
            <xsl:text>="</xsl:text>
            <xsl:value-of select="normalize-space($xml//TradeMark//*[local-name() = $f])"/>
            <xsl:text>"&#x000A;</xsl:text>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

它使用 Saxon 6.5.5、Saxon-EE 9.4.0.3 和带有 libxml/20708 和 libxslt/10126 的 xsltproc 产生以下输出：

```
MarkCurrentStatusDate="2008-08-11-04:00"
ApplicationNumber="74631225"
ApplicationDate="1995-02-07-05:00"
RegistrationNumber="2178784"
RegistrationDate="1998-08-04-04:00"
ExpirationDate=""
MarkVerbalElementText="JAVA" 
```

我不太相信它能够超过您提供的示例 XML，但它确实在那里工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-11T02:59:43.360

**这是对所提供转换的轻微修正和简化（删除了一个不必要的模板）——现在产生了想要的正确结果**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text" encoding="utf-8" />
  <xsl:strip-space elements="*"/>

 <xsl:template match="TradeMark">
    MarkCurrentStatusDate,"<xsl:value-of select="MarkCurrentStatusDate"/>"
    ApplicationNumber,"<xsl:value-of select="ApplicationNumber"/>"
    ApplicationDate,"<xsl:value-of select="ApplicationDate"/>"
    RegistrationNumber,"<xsl:value-of select="RegistrationNumber"/>"
    RegistrationDate,"<xsl:value-of select="RegistrationDate"/>"
    ExpirationDate,"<xsl:value-of select="ExpirationDate"/><xsl:text>"</xsl:text>
    <xsl:apply-templates select="WordMarkSpecification"/>
 </xsl:template>

 <xsl:template match="WordMarkSpecification">
    MarkVerbalElementText,"<xsl:value-of select="normalize-space(MarkVerbalElementText)"/>"
 </xsl:template>

 <xsl:template match="TransactionCode"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<Transaction>
    <TradeMarkTransactionBody>
        <TransactionContentDetails>
            <TransactionCode>National Trademark Information</TransactionCode>
            <TransactionData>
                <TradeMarkDetails>
                    <TradeMark>
                        <RegistrationOfficeCode>US</RegistrationOfficeCode>
                        <ApplicationNumber>74631225</ApplicationNumber>
                        <ApplicationDate>1995-02-07-05:00</ApplicationDate>
                        <RegistrationNumber>2178784</RegistrationNumber>
                        <RegistrationDate>1998-08-04-04:00</RegistrationDate>
                        <FilingPlace>US</FilingPlace>
                        <MarkCurrentStatusDate>2008-08-11-04:00</MarkCurrentStatusDate>
                        <WordMarkSpecification>
                            <MarkVerbalElementText>JAVA </MarkVerbalElementText>
                        </WordMarkSpecification>
                    </TradeMark>
                </TradeMarkDetails>
            </TransactionData>
        </TransactionContentDetails>
    </TradeMarkTransactionBody>
</Transaction> 
```

**产生了想要的正确结果：**

```
MarkCurrentStatusDate,"2008-08-11-04:00"
ApplicationNumber,"74631225"
ApplicationDate,"1995-02-07-05:00"
RegistrationNumber,"2178784"
RegistrationDate,"1998-08-04-04:00"
ExpirationDate,""
MarkVerbalElementText,"JAVA" 
```

**说明**：

1.  空体模板：

    `<xsl:template match="TransactionCode"/>`

    用于覆盖匹配元素的 XSLT 内置模板，该模板生成匹配元素的所有文本节点后代的串联。

2.  行尾的`<xsl:text>"</xsl:text>`防止后面的换行符被解释为所需输出的一部分，因此消除了观察到的空行。

3.  模板匹配`Transaction`被删除，因为它的行为与匹配元素的 XSLT 内置模板完全一样——将模板应用于其所有子元素。

# android - EXTERNAL_STORAGE, EMULATED_STORAGE_SOURCE, EMULATED_STORAGE_TARGET 配置用于存储空间有限的 android 设备

> ID：15939752
> 
> 赞同：1
> 
> 时间：2013-04-11T02:35:21.000
> 
> 标签：android, storage, android-4.2-jelly-bean, mount-point

我一直在开发具有非常小尺寸的 nand flash 的 android 电视。因此，所有用户应用程序和数据都应该放在外部 sd 卡上。

我对多用户的外部存储策略感到困惑。我应该如何配置所有这些变量，例如 EXTERNAL_STORAGE、EMULATED_STORAGE_SOURCE、EMULATED_STORAGE_TARGET

我当前的配置如下：

**初始化文件**

```
symlink /storage/emulated/legacy /sdcard
symlink /storage/emulated/legacy /mnt/sdcard
symlink /storage/emulated/legacy /storage/sdcard0
symlink /mnt/shell/emulated/0 /storage/emulated/legacy

export EXTERNAL_STORAGE /storage/emulated/legacy
export EMULATED_STORAGE_SOURCE /mnt/shell/emulated
export EMULATED_STORAGE_TARGET /storage/emulated 
```

**vold.fstab**

```
dev_mount sdcard /mnt/shell/emulated auto /devices/platform/... 
```

**存储列表**

```
<StorageList xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- internal emulated storage -->
    <storage
        android:storageDescription="@string/storage_internal"
        android:emulated="true"
        android:mtpReserve="100" /> 
    <storage android:mountPoint="/mnt/shell/emulated"
             android:storageDescription="@string/storage_sd_card"
             android:removable="true"
             android:primary="true" />
</StorageList> 
```

使用此配置适用于 android-4.2 设备，我发现每次拔下 sdcard 并重新安装它时，由于权限，那些正在运行的进程将在 sdcard 上的 I/O 操作上遇到错误。但是新的 zygote-forked 进程会正常工作。

# matlab - “在 MATLAB 路径中隐藏它”是什么意思？如何在文件中做到这一点？

> ID：15939754
> 
> 赞同：7
> 
> 时间：2013-04-11T02:35:38.477
> 
> 标签：matlab, path, namespaces, package

![在此处输入图像描述](https://i.stack.imgur.com/9bAUE.png)

在运行 unitTester 文件之前，我总是需要这样做。我不明白为什么需要这样做。这是什么意思？为什么`"Add to Path > Selected Folders and Subfolders"`还不够？

**[更新]** *这可能是问题所在[。](https://i.stack.imgur.com/VKPjM.png)内核以不同的技术编程，其中文件名相同。我需要确保在每种情况下只使用某些文件。最简单的方法是在这里使用一个包来不弄乱命名空间吗？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T05:58:14.670

MATLAB 在其搜索路径上搜索 m 文件，您可以使用`path`命令显示它。如果您在 MATLAB 路径上有多个具有相同基本名称的 m 文件（即扩展名之前的文件名部分，不包括目录），则 MATLAB 只能执行路径上第一个出现的 m 文件。

您可以使用`addpath`和`rmpath`函数来动态修改路径。例如，您可以在测试运行脚本中自动添加相关目录。请注意，`addpath`将新路径添加到路径列表的头部，以确保它优先于现有条目。

防止此类名称冲突的另一种方法是[包](http://www.mathworks.com/help/matlab/matlab_oop/scoping-classes-with-packages.html)。

编辑：要将目录转换为包，请执行以下操作：

*   `+`在其名称的开头添加一个。
*   确保将目录的父目录放在 MATLAB 路径上。
*   更新对包中函数的所有调用，方法是预先添加`packagename.`它们或在调用之前包含包内容 ( `import packagename.*`)。

一般来说，我更喜欢包而不是动态路径修改，因为它们更容易使用。请注意，您可以嵌套包（即`my_matlab_files/+mypkg/+nested/foo.m`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-28T18:07:54.387

我在使用 Matlab r2015a 的 OS X 10.10.3 上遇到了同样的问题。

我有我的文件`~/electrochemistry/Matlab/`

不知何故将最后一个文件夹重命名为小写解决了这个问题。在进行故障排除时，我注意到 Matlab 正在寻找`~/electrochemistry/matlab/`，但找不到它正在寻找的内容（即我正在运行的 .m 文件）

所以现在我正在工作`~/electrochemistry/matlab/`并且问题已经解决了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-06T06:37:32.773

更改您的源代码名称，因为它的名称与 Matlab 的源代码相同

# wordpress - 为多种帖子类型注册分类

> ID：15939755
> 
> 赞同：2
> 
> 时间：2013-04-11T02:35:39.780
> 
> 标签：wordpress, taxonomy, custom-post-type

我需要为 2 种不同的帖子类型注册分类法，并且我尝试使用以下代码来实现这一点：

功能 add_custom_taxonomies() {

```
 // Add new taxonomy, make it hierarchical (like categories)
          $labels_adp = array(
            'name'                => _x( 'Apples', 'taxonomy general name' ),
            'singular_name'       => _x( 'Apple', 'taxonomy singular name' ),
            'search_items'        => __( 'Search Apples' ),
            'all_items'           => __( 'All Apples' ),
            'parent_item'         => __( 'Parent Apples' ),
            'parent_item_colon'   => __( 'Parent Apples:' ),
            'edit_item'           => __( 'Edit Apples' ), 
            'update_item'         => __( 'Update Apples' ),
            'add_new_item'        => __( 'Add New Apples' ),
            'new_item_name'       => __( 'New Genre Apples' ),
            'menu_name'           => __( 'Apples' )
          );    

          $args_adp = array(
            'hierarchical'        => true,
            'labels'              => $labels_adp,
            'show_ui'             => true,
            'show_admin_column'   => true,
            'query_var'           => true,
            'rewrite'             => array( 'slug' => 'apple' )
          );
          $labels_cw = array(
            'name'                => _x( 'Genres', 'taxonomy general name' ),
            'singular_name'       => _x( 'Genre', 'taxonomy singular name' ),
            'search_items'        => __( 'Search Genres' ),
            'all_items'           => __( 'All Genres' ),
            'parent_item'         => __( 'Parent Genre' ),
            'parent_item_colon'   => __( 'Parent Genre:' ),
            'edit_item'           => __( 'Edit Genre' ), 
            'update_item'         => __( 'Update Genre' ),
            'add_new_item'        => __( 'Add New Genre' ),
            'new_item_name'       => __( 'New Genre Name' ),
            'menu_name'           => __( 'Genre' )
          );    

          $args_cw = array(
            'hierarchical'        => true,
            'labels'              => $labels_cw,
            'show_ui'             => true,
            'show_admin_column'   => true,
            'query_var'           => true,
            'rewrite'             => array( 'slug' => 'genre' )
          );

          register_taxonomy( 'apple', array( 'adp' ), $args_adp );
          register_taxonomy( 'genre', array( 'cw' ), $args_cw );

    }
    add_action( 'init', 'add_custom_taxonomies', 0 ); 
```

不幸的是，它根本不起作用，只呈现一种分类法一种帖子类型。不知道为什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-05T14:12:56.733

您可以在定义分类名称后立即使用数组：

```
register_taxonomy(
  'movie_name',
   array( 'reviews','news' ), 
  ..etc.. 
  ) 
```

[http://wordpress.org/support/topic/one-taxonomy-for-multiple-post-types](http://wordpress.org/support/topic/one-taxonomy-for-multiple-post-types)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T03:51:12.797

如果您尝试为不同的帖子类型注册个人分类法，请制作两个单独的功能来注册您的帖子

```
function add_custom_taxonomies() {

            // Add new taxonomy, make it hierarchical (like categories)
             $labels_cw = array(
        'name'                => _x( 'Genres', 'taxonomy general name' ),
        'singular_name'       => _x( 'Genre', 'taxonomy singular name' ),
        'search_items'        => __( 'Search Genres' ),
        'all_items'           => __( 'All Genres' ),
        'parent_item'         => __( 'Parent Genre' ),
        'parent_item_colon'   => __( 'Parent Genre:' ),
        'edit_item'           => __( 'Edit Genre' ), 
        'update_item'         => __( 'Update Genre' ),
        'add_new_item'        => __( 'Add New Genre' ),
        'new_item_name'       => __( 'New Genre Name' ),
        'menu_name'           => __( 'Genre' )
      );    

              $args_cw = array(
                'hierarchical'        => true,
                'labels'              => $labels_cw,
                'show_ui'             => true,
                'show_admin_column'   => true,
                'query_var'           => true,
                'rewrite'             => array( 'slug' => 'genre' )
              );

                      register_taxonomy( 'genre', array( 'cw' ), $args_cw );

        }
        add_action( 'init', 'add_custom_taxonomies', 0 );
function add_custom_taxonomies1() {

            // Add new taxonomy, make it hierarchical (like categories)
               $labels_adp = array(
        'name'                => _x( 'Apples', 'taxonomy general name' ),
        'singular_name'       => _x( 'Apple', 'taxonomy singular name' ),
        'search_items'        => __( 'Search Apples' ),
        'all_items'           => __( 'All Apples' ),
        'parent_item'         => __( 'Parent Apples' ),
        'parent_item_colon'   => __( 'Parent Apples:' ),
        'edit_item'           => __( 'Edit Apples' ), 
        'update_item'         => __( 'Update Apples' ),
        'add_new_item'        => __( 'Add New Apples' ),
        'new_item_name'       => __( 'New Genre Apples' ),
        'menu_name'           => __( 'Apples' )
      );    

              $args_adp = array(
                'hierarchical'        => true,
                'labels'              => $labels_adp,
                'show_ui'             => true,
                'show_admin_column'   => true,
                'query_var'           => true,
                'rewrite'             => array( 'slug' => 'apple' )
              );

                      register_taxonomy( 'genre', array( 'adp' ), $args_adp );

        }
        add_action( 'init', 'add_custom_taxonomies1', 0 ); 
```

在数组（'adp','cw'）中，adp 和 cw 是 post 类型

# openmpi - 是否可以在本地计算机和远程集群上运行 OpenMPI？

> ID：15939757
> 
> 赞同：4
> 
> 时间：2013-04-11T02:35:45.837
> 
> 标签：openmpi

我有一组需要在集群中执行的计算操作（可能像 512 MPI 进程）。现在，我让集群上的根节点打开一个套接字并在计算操作之间将数据传输到我的本地计算机，但我想知道是否可以只创建两个 MPI 组，其中一个是我的本地机器和另一个远程集群，并使用 MPI 命令在它们之间发送数据。

这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T13:00:22.713

是的，这是可能的，只要集群节点和您的机器之间有网络路径即可。MPI 标准提供了执行此操作的抽象机制，而 Open MPI 提供了一种非常简单的方法来使事情正常工作。您必须查看标准的*流程创建和管理*部分（MPI-2.2 的第 10 章），特别是*建立通信*小节（MPI-2.2 的第 10.4 节）。基本上步骤是：

1.  您分别启动两个 MPI 作业。这显然是你所做的，所以这里没有什么新鲜事。
2.  其中一项作业使用`MPI_Open_port()`. 此 MPI 调用返回一个唯一的端口名称，然后必须使用`MPI_Publish_name()`. 一旦端口打开，就可以通过调用阻塞例程来接受客户端连接`MPI_Comm_accept()`。该作业现在已成为服务器作业。
3.  另一个 MPI 作业，称为客户端作业，首先使用`MPI_Lookup_name()`. 一旦有了端口名称，它就可以调用`MPI_Comm_connect()`以连接到远程服务器。
4.  一旦`MPI_Comm_connect()`与各自的 配对`MPI_Comm_accept()`，两个作业将在它们之间建立一个互通器，然后可以来回发送消息。

一个复杂的细节是客户端作业如何在给定服务名称的情况下查找端口名称？这是 Open MPI 中文档较少的部分，但它非常简单：您必须提供`mpiexec`用于启动客户端作业的命令以及`mpiexec`服务器作业的 URI，它充当一种目录服务。为此，您应该使用`--report-uri -`参数启动服务器作业，以使其将其 URI 打印到标准输出：

```
$ mpiexec --report-uri - <other arguments like -np> ./server ... 
```

它会给你一个长的 URI 形式`1221656576.0;tcp://10.1.13.164:36351;tcp://192.168.221.41:36351`。`mpiexec`现在您必须使用以下选项将此 URI 提供给客户端`--ompi-server uri`：

```
$ mpiexec --ompi-server 1221656576.0;tcp://10.1.13.164:36351... ./client ... 
```

请注意，URI 包含所有已配置和启用的网络接口的地址，这些网络接口存在于服务器`mpiexec`启动的节点上。您应该确保客户能够联系到其中至少一个。还要确保您在启用的 BTL 组件列表中有 TCP BTL 组件，否则不会有消息流过。TCP BTL 通常默认启用，但在某些 InfiniBand 安装中，通过设置环境变量的相应值`OMPI_MCA_btl`或在默认 Open MPI MCA 配置文件中显式禁用它。可以使用`--mca`选项覆盖 MCA 参数，例如：

```
$ mpiexec --mca btl self,sm,openib,tcp --report-uri - ... 
```

另请参阅我对类似问题给出[的答案。](https://stackoverflow.com/a/15008715/1374437)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T13:00:03.083

是的，如果有可用的 TCP/IP 连接，它应该开箱即用（MPI 在随机的高 TCP 端口上通信 - 如果 TCP 用作传输层）。尝试将您的机器添加到您提供的主机文件中`mpirun`。如果这不起作用，您可以使用[不需要](http://mpi.deino.net/mpi_functions/MPI_Open_port.html)`mpirun`.

# javascript - 将文件选择输入限制为单个目录

> ID：15939758
> 
> 赞同：0
> 
> 时间：2013-04-11T02:35:50.113
> 
> 标签：javascript, jquery, html

我将使用引导样式的输入作为文件选择器。

```
<div class="input-append">
   <input class="span2" id="appendedInputButtons" type="file">
   <button class="btn" type="button">Select File</button>
</div> 
```

我在一页上有几个……一个用来选择图像，一个用来选择 MP4 剪辑，另一个用来选择 Flash 文件。

媒体文件将进入硬盘驱动器或服务器上的单独目录。（现在我正在离线构建它作为演示，所以我需要从本地驱动器中选择文件）

目录结构如下所示：

```
demo.html
  |
  media------
            |
            ---image
            |
            ---flash
            |
            ---video 
```

现在它令人困惑......用户可以使用视频选择器选择图像，使用图像选择器选择视频等......我认为如果我可以将用户引导到正确的目录，则可以防止这种情况。

让我们只处理图像文件选择器，我相信我可以修改其他媒体选择器的代码。

我需要做些什么来确保图像文件选择器只会转到“图像”目录来选择文件？

# java - 二维数组周长和初始化数据

> ID：15939761
> 
> 赞同：1
> 
> 时间：2013-04-11T02:36:16.803
> 
> 标签：java, multidimensional-array, initialization, character

我是Java初学者，所以请放轻松。我正在研究一个处理二维数组的练习方法问题。问题是一种方法，它告诉您将名为 array 的二维字符数组作为参数。然后它希望您将数组的所有元素初始化为“x”，但初始化为“o”的周长（第一列和最后一列以及第一行和最后一行）除外。

我的问题是如何初始化每个元素以表示二维数组中的 x 和 y，以及如何初始化周长的每个行和列元素？例如，创建 3 行乘 4 列的二维数组 -

```
char[][] table = new char[3][4] 
```

- 将只用 o 填充桌子的外围，而里面的其余部分将用 x 填充，对吗？

这基本上是输出的样子吗？

```
 { o, o, o, o},
  { o, x, x, o},
  { o, o, o, o}, 
```

另外，如果我无法理解问题，有人可以引导我朝着正确的方向前进吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:45:43.833

这最好作为两个单独的问题来处理：

1.  将第一行和最后一行初始化为 'o'
2.  初始化剩余的行

第一个问题很容易解决：遍历第一行和最后一行并将每个元素设置为 'o'。第二个问题分解为

2a。将第一列和最后一列初始化为 'o'

2b。将剩余的列初始化为“x”

假设一行的长度为`length`，这可以通过

```
array[0] = 'o';
array[length - 1] - 'o';
for(int i = 1; i < length - 1; i++)
    array[i] = 'x' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:46:23.807

一个`new`int 数组将被初始化为全零。

所以 int[][] array = new int[3][4];

看起来像

```
{0,0,0,0}
{0,0,0,0}
{0,0,0,0} 
```

您必须自己完成设置周长的工作

您需要的是嵌套一些循环并确定您在数组中的位置并进行相应设置：（伪代码）

```
for i loop through array.length
    for j loop through array[i].length
        if i == first element or i == last element or j == first element or j == last element
             then array[i][j] = perimeter value
        else
             array[i][j] = center value 
```

一个长度为 n 的数组有 n 个元素，由 0 到 n-1 引用，所以如果你有一个这样的数组

```
{1,2,3,4} 
```

array[0] 将是 1，这是因为 Java 数组是从零开始的。

鉴于此，第一个将始终为 0，最后一个将是 length-1

# applescript - 使用 AppleScript 重定向电子邮件时，电子邮件的内容会重复。为什么？

> ID：15939768
> 
> 赞同：2
> 
> 时间：2013-04-11T02:36:40.383
> 
> 标签：applescript

我要做的是设置一个 Mail.app 规则，将所有 iTunes 收据电子邮件重定向到 Evernote 中的特定笔记本。以下 AppleScript 添加了正确的收件人并修改了主题行，因此我可以包含指向正确 Evernote 笔记本的指针。问题是我无法弄清楚为什么电子邮件的内容会被复制两次。任何帮助表示赞赏。

更新：为澄清起见，此脚本作为 Mail.app 规则的一部分运行。当一封电子邮件符合规则时，将运行下面的 AppleScript。如果你不熟悉 Evernote 通过电子邮件添加项目的功能，它的工作原理如下：每个 Evernote 用户都会收到一个唯一的电子邮件地址，允许将项目直接添加到他们的 Evernote 帐户中。在主题行中，可以添加某些关键字以将文档定向到特定文件夹 (@Receipts) 或添加特定标签 (#cool)。

```
using terms from application "Mail"
on perform mail action with messages theMessages
    repeat with thisMessage in theMessages
        tell application "Mail"
            set newMessage to redirect thisMessage with opening window
            tell newMessage
                set subject of newMessage to "hello"
                make new to recipient at beginning of to recipients with properties {address:"mine@email.com"}
                delete bcc recipients
                delete cc recipients
            end tell
            set the sender of newMessage to "me@me.com"
            delay 1
            -- send newMessage
        end tell
    end repeat
end perform mail action with messages
end using terms from 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-23T13:17:54.037

当我尝试转发消息（运行 10.6 到 10.9）时，我遇到了同样的问题，我通过在添加另一个主题等之前存储新消息的内容来修复它......

```
set themessage to forward eachMail with opening window
set a to content of themessage
set thesubject to (subject of eachMail) as rich text
    tell themessage
        set subject to thesubject
        repeat with m in mailtos
            make new to recipient at end of to recipients with properties {address:m}
        end repeat
        set content to a
    end tell 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-25T08:49:11.650

我已经在 Mac OS X 10.6.8 和 Mail 4.6.1085 以及纯文本电子邮件中尝试过这个。电子邮件的正文一开始并没有在这个设置中重复，但后来我注意到它确实在我的另一个自动回复功能中重复了。这就是发生的事情：

1.  编写主题为“evernote”的文本电子邮件 2) 下载电子邮件，主题“evernote”触发我的支持电子邮件的自动回复，看起来很正常
2.  支持自动回复（发送给我自己，因为这是一个测试）触发了印象笔记脚本（下）
3.  evernote 脚本引用了原始消息并插入了同一消息的副本。

我认为您可以通过存储原始文本并在发送消息之前再次设置来解决此问题。以下似乎不会发送带有重复文本的消息：

```
using terms from application "Mail"
    on perform mail action with messages theMessages
        repeat with thisMessage in theMessages
            tell application "Mail"
                set theText to content of thisMessage
                set newMessage to redirect thisMessage with opening window
                tell newMessage
                    set subject of newMessage to "hello"
                    make new to recipient at beginning of to recipients with properties {address:"mine@email.com"}
                    delete bcc recipients
                    delete cc recipients
                end tell
                set the sender of newMessage to "me@me.com"
                set content of newMessage to thisText
                delay 1
                -- send newMessage
            end tell
        end repeat
    end perform mail action with messages
end using terms from 
```

# tomcat - Tomcat6 - 如何通过 log4j 或 JULI 获取会话参数？

> ID：15939769
> 
> 赞同：0
> 
> 时间：2013-04-11T02:36:44.833
> 
> 标签：tomcat, logging, log4j

我面临一个问题，即已部署的 Web 应用程序（没有源代码或任何引用）似乎与某些会话参数有问题。我不知道如何对该应用程序进行逆向工程，所以我觉得我可以展示此事件的唯一方法是使用 log4j 或 tomcat 自己的 JULI 工具来获取会话参数列表。我读过有关 Wrox 的 Professional Apache Tomcat 6 的文章，坦率地说，它在这方面并没有太大帮助......

关于使用 log4j 或 JULI 的方向有什么提示吗？

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:35:33.857

您可以添加一个过滤器以将会话属性列表打印到 Log4J，如下所示：

```
public class SessionAttributesLoggingFilter implements Filter {

    private Logger log = Logger.getLogger(this.getClass());

    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        if (request instanceof HttpServletRequest) {
            HttpServletRequest httpRequest = (HttpServletRequest) request;
            HttpSession session = httpRequest.getSession();

            Enumeration<String> sessionAttributeNames = session.getAttributeNames();
            log.info("Session attributes before request ----------------------->");
            while (sessionAttributeNames.hasMoreElements()) {
                String attr = sessionAttributeNames.nextElement();
                log.info(" "+attr + " = " + session.getAttribute(attr));
            }
            chain.doFilter(request, response);
            sessionAttributeNames = session.getAttributeNames();
            log.info("Session attributes after request ----------------------->");
            while (sessionAttributeNames.hasMoreElements()) {
                String attr = sessionAttributeNames.nextElement();
                log.info(" "+attr + " = " + session.getAttribute(attr));
            }
        } else {
            chain.doFilter(request, response);
        }
    }

    public void init(FilterConfig arg0) throws ServletException {
        log.info("Logging session attributes ...");
    }

    public void destroy() {}
} 
```

然后将映射添加到您的 web.xml 并重新启动您的应用程序：

```
<filter>
    <filter-name>sessionLogging</filter-name>
    <filter-class>PACKAGENAME.SessionAttributesLoggingFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>sessionLogging</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

# c++ - 这段代码有什么比 boost mutex 更快的吗？

> ID：15939770
> 
> 赞同：3
> 
> 时间：2013-04-11T02:36:45.820
> 
> 标签：c++, critical-section, boost-mutex

目前在我的代码中，我有这样的部分

```
boost::mutex Mymutex

void methodA()
{
   boost::mutex::scoped_lock lock(Mymutex);
   ......
   ......
   ......
} 
```

我读到关键部分比互斥锁快？所以我正在做这样的事情，我想知道这是否更快。

```
 boost::recursive_mutex m_guard;
 void methodA()
 {
       // this section is not locked
      {
          boost::lock_guard<boost::recursive_mutex> lock(m_guard);
         // this section is locked
      }
      //This section not locked
 } 
```

第二种方法更快吗？我主要使用互斥锁的原因是为了防止竞争条件和锁定对方法的访问，以便一个线程一次访问它。有什么比这更快的吗？我的另一个担忧是关于声明

```
 boost::lock_guard<boost::recursive_mutex> lock(m_guard); 
```

似乎每次调用 methodA() 都会在堆栈上创建锁。我正在考虑将锁声明为静态变量，因此每次调用此方法时都不会在堆栈上创建它。在这种情况下，我该如何添加 m_guard 到它。例如

```
 boost::recursive_mutex SomeClass::m_guard; //This is static 
 boost::lock_guard<boost::recursive_mutex> SomeClass::lock //Suppose this is static
 void SomeClass::methodA()
 {

      {
         //How do i make lock "lock" mguard 

      }

 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T02:42:59.210

> 有什么比这更快的吗？

如果您的情况适合[忙等待](http://en.wikipedia.org/wiki/Busy_waiting)，您可以尝试[使用](http://en.wikipedia.org/wiki/Spinlock)在`boost::atomic_flag`.

**SO**：[什么时候应该使用自旋锁而不是互斥锁？](https://stackoverflow.com/a/5870415/1762344)

```
class spinlock
{
    atomic_flag flag = ATOMIC_FLAG_INIT;
public:
    void lock()
    {
        while(flag.test_and_set(memory_order_acquire));
    }
    void unlock()
    {
        flag.clear(memory_order_release);
    }
};

void foo()
{
    static spinlock lock;
    lock_guard<spinlock> guard(lock);
    // do job
} 
```

> `boost::lock_guard<boost::recursive_mutex> lock(m_guard);`似乎每次调用 methodA() 都会在堆栈上创建锁。

它不是锁，它只是 RAII 包装器，它在构造函数中锁定互斥体并在析构函数中释放它。可以，在堆栈上创建 lock_guard。

# iphone - 在 iOS 6 上删除消息

> ID：15939771
> 
> 赞同：0
> 
> 时间：2013-04-11T02:36:51.620
> 
> 标签：iphone, ios6, sms, jailbreak

我正在为越狱的 iOS 设备开发一个应用程序。

我想从用户的收件箱中删除一条消息 - 我删除了 SMS.db 上的消息（在“消息”表中），但是当我转到收件箱时，它仍然存在“空白”内容和发件人的电话号码。在 iOS 5 上，我使用 完美删除了它`CKSMSRecordDelete`，但在 iOS 6 上，`ChatKit.framework`它不再起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T22:28:43.090

在这里查看我的答案[Block sms on ios6](https://stackoverflow.com/questions/16219799/block-sms-on-ios6)要从 SMS.db 中删除行，您需要使用 IMDPersistence.framework

如果您想手动执行，那么您还应该从“聊天”和“处理”表中删除行。但我认为这不会奏效。消息将从数据库中删除，但仍会显示在消息应用程序中。您可以尝试杀死“com.apple.imagent”守护进程。它处理 iOS 6 中的消息，并可能将消息保留在内存中。它将自动重新启动并理想地重新加载 SMS.db 内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-14T07:20:34.407

尝试一些其他软件来擦除短信可能会起作用。根据一些解释，您删除的一些数据仍然存在于 iPhone 存储中，它们实际上并没有消失。一些专业的数据恢复软件可以通过某种方式检测它们。因此，如果您想永久擦除数据而不进行恢复，请在互联网上查找一些教程。例如[如何永久删除短信](http://www.iphone-data-eraser.com/eraser/delete-iphone-data-without-restore.html)可能适合您。

# java - Android - GestureDetection 强制关闭应用

> ID：15939773
> 
> 赞同：0
> 
> 时间：2013-04-11T02:36:56.260
> 
> 标签：java, android, swipe, gesture

我尝试`GestureDetector`在我的应用程序中添加一个，这样当用户从左向右滑动时，它会转到下一个活动，而当从右向左滑动时，它会转到上一个活动。现在，在此之前，我想使用 toast 对其进行测试。我构建了代码并对其进行了测试，但是当我只是触摸屏幕时它就会崩溃。我什至不必刷卡。这是我的代码：

```
package com.cydeon.plasmamodz;

 import java.io.File;

 import com.koushikdutta.urlimageviewhelper.UrlImageViewHelper;

 import android.app.ActionBar;
 import android.app.Activity;
 import android.content.Intent;
 import android.os.Bundle;
 import android.os.Environment;
 import android.os.Handler;
 import android.util.Log;
 import android.view.MotionEvent;
 import android.view.View;
 import android.view.View.OnClickListener;
 import android.view.View.OnTouchListener;
 import android.widget.Button;
 import android.widget.LinearLayout;
 import android.widget.RelativeLayout;
 import android.widget.Toast;
 import android.view.GestureDetector.OnGestureListener;
 import android.view.GestureDetector;
 import android.os.*;

 public class Softkeys extends Activity implements OnClickListener, OnGestureListener{

 private GestureDetector gestureDetector;
 private static final int SWIPE_MIN_DISTANCE = 150;
    private static final int SWIPE_THRESHOLD_VELOCITY = 100;
/* (non-Javadoc)
 * @see android.app.Activity#onCreate(android.os.Bundle)
 */
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.themes);
        ActionBar actionBar = getActionBar();
        actionBar.hide();
        RelativeLayout ll = (RelativeLayout) findViewById(R.id.myLayout);
        final GestureDetector gestureDetector = new GestureDetector(Softkeys.this, this);
        OnTouchListener gestureListener = new View.OnTouchListener() {
            public boolean onTouch(View v, MotionEvent event) {
                return gestureDetector.onTouchEvent(event);
            }
        };

        ll.setOnTouchListener(gestureListener);

        int [] viewIds = new int [] {R.id.b1, R.id.b2, R.id.b3, R.id.b4, R.id.b5, R.id.b6, R.id.b7, R.id.b8, R.id.b9, R.id.b10, R.id.b11, R.id.b12, R.id.b13, R.id.b13, R.id.b14, R.id.b15, R.id.b16, R.id.b17, R.id.b18, R.id.b19, R.id.b20, R.id.b21, R.id.b22, R.id.b23, R.id.b24, R.id.b25, R.id.b26, R.id.b27, R.id.b28, R.id.b29, R.id.b30};
        for(int i = 0; i < viewIds.length; i++){
            View v = findViewById(viewIds[i]);
            if (v != null) {
                v.setVisibility(0);
            }
        }
        Button stock = (Button) findViewById(R.id.b1);
        stock.setBackgroundResource(R.drawable.soft_stock);
        Button stockBlue = (Button) findViewById(R.id.b2);
        stockBlue.setBackgroundResource(R.drawable.soft_stock_blue);
        Button green = (Button) findViewById(R.id.b3);
        green.setBackgroundResource(R.drawable.soft_green);
        Button pink = (Button) findViewById(R.id.b4);
        pink.setBackgroundResource(R.drawable.soft_pink);
        Button purple = (Button) findViewById(R.id.b5);
        purple.setBackgroundResource(R.drawable.soft_purple);
        Button yellow = (Button) findViewById(R.id.b6);
        yellow.setBackgroundResource(R.drawable.soft_yellow);
        Button red = (Button) findViewById(R.id.b7);
        red.setBackgroundResource(R.drawable.soft_red);
        Button galaxy = (Button) findViewById(R.id.b8);
        galaxy.setBackgroundResource(R.drawable.soft_galaxy);
        Button galaxyBlue = (Button) findViewById(R.id.b9);
        galaxyBlue.setBackgroundResource(R.drawable.soft_galaxy_blue);
        Button reflect = (Button) findViewById(R.id.b10);
        reflect.setBackgroundResource(R.drawable.soft_reflect);
        Button reflectBlue = (Button) findViewById(R.id.b11);
        reflectBlue.setBackgroundResource(R.drawable.soft_reflect_blue);
        Button razor = (Button) findViewById(R.id.b12);
        razor.setBackgroundResource(R.drawable.soft_razor);
        Button razorBlue = (Button) findViewById(R.id.b13);
        razorBlue.setBackgroundResource(R.drawable.soft_razor_blue);
        Button small = (Button) findViewById(R.id.b14);
        small.setBackgroundResource(R.drawable.soft_small);
        Button smallBlue = (Button) findViewById(R.id.b15);
        smallBlue.setBackgroundResource(R.drawable.soft_small_blue);
        Button smallReflect = (Button) findViewById(R.id.b16);
        smallReflect.setBackgroundResource(R.drawable.soft_small_reflect);
        Button smallReflectBlue = (Button) findViewById(R.id.b17);
        smallReflectBlue.setBackgroundResource(R.drawable.soft_small_reflect_blue);
        Button xperia = (Button) findViewById(R.id.b18);
        xperia.setBackgroundResource(R.drawable.soft_xperia);
        Button blueXperia = (Button) findViewById(R.id.b19);
        blueXperia.setBackgroundResource(R.drawable.soft_xperia_blue);
        Button zte = (Button) findViewById(R.id.b20);
        zte.setBackgroundResource(R.drawable.soft_zte);
        Button zteBlue = (Button) findViewById(R.id.b21);
        zteBlue.setBackgroundResource(R.drawable.soft_zte_blue);
        Button college = (Button) findViewById(R.id.b22);
        college.setBackgroundResource(R.drawable.soft_college);
        Button collegeBlue = (Button) findViewById(R.id.b23);
        collegeBlue.setBackgroundResource(R.drawable.soft_college_blue);
        Button defused = (Button) findViewById(R.id.b24);
        defused.setBackgroundResource(R.drawable.soft_defused);
        Button defusedBlue = (Button) findViewById(R.id.b25);
        defusedBlue.setBackgroundResource(R.drawable.soft_defused_blue);
        Button droid = (Button) findViewById(R.id.b26);
        droid.setBackgroundResource(R.drawable.soft_droid);
        Button droidBlue = (Button) findViewById(R.id.b27);
        droidBlue.setBackgroundResource(R.drawable.soft_droid_blue);
        Button pixel = (Button) findViewById(R.id.b28);
        pixel.setBackgroundResource(R.drawable.soft_pixel);
        Button pixelBlue = (Button) findViewById(R.id.b29);
        pixelBlue.setBackgroundResource(R.drawable.soft_pixel_blue);
        Button facebook = (Button) findViewById(R.id.b30);
        facebook.setBackgroundResource(R.drawable.soft_facebook);
        int [] viewIds2 = new int [] {R.id.b1, R.id.b2, R.id.b3, R.id.b4, R.id.b5, R.id.b6, R.id.b7, R.id.b8, R.id.b9, R.id.b10, R.id.b11, R.id.b12, R.id.b13, R.id.b13, R.id.b14, R.id.b15, R.id.b16, R.id.b17, R.id.b18, R.id.b19, R.id.b20, R.id.b21, R.id.b22, R.id.b23, R.id.b24, R.id.b25, R.id.b26, R.id.b27, R.id.b28, R.id.b29, R.id.b30};
        for(int i = 0; i < viewIds2.length; i++){
            View v = findViewById(viewIds2[i]);
            if (v != null) {
                v.setOnClickListener(this);
            }
        }

        }

@Override
public void onClick(View arg0) {
    Intent a = new Intent(Softkeys.this, Bmod.class);
    if (arg0.getId() == R.id.b1) {
        a.putExtra("Stock", "stock");
        startActivity(a);
    } else if (arg0.getId() == R.id.b2) {
        a.putExtra("StockBlue", "stockblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b3) {
        a.putExtra("Green", "green");
        startActivity(a);
    } else if (arg0.getId() == R.id.b4) {
        a.putExtra("Pink", "pink");
        startActivity(a);
    } else if (arg0.getId() == R.id.b5) {
        a.putExtra("Purple", "purple");
        startActivity(a);
    } else if (arg0.getId() == R.id.b6) {
        a.putExtra("Yellow", "yellow");
        startActivity(a);
    } else if (arg0.getId() == R.id.b7) {
        a.putExtra("Red", "red");
        startActivity(a);
    } else if (arg0.getId() == R.id.b8) {
        a.putExtra("Galaxy", "galaxy");
        startActivity(a);
    } else if (arg0.getId() == R.id.b9) {
        a.putExtra("GalaxyBlue", "galaxyblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b10) {
        a.putExtra("Reflect", "Reflect");
        startActivity(a);
    } else if (arg0.getId() == R.id.b11) {
        a.putExtra("ReflectBlue", "reflect");
        startActivity(a);
    } else if (arg0.getId() == R.id.b12) {
        a.putExtra("Razor", "razor");
        startActivity(a);
    } else if (arg0.getId() == R.id.b13) {
        a.putExtra("RazorBlue", "razorblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b14) {
        a.putExtra("Small", "small");
        startActivity(a);
    } else if (arg0.getId() == R.id.b15) {
        a.putExtra("SmallBlue", "smallblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b16) {
        a.putExtra("SmallReflect", "smallreflect");
        startActivity(a);
    } else if (arg0.getId() == R.id.b17) {
        a.putExtra("SmallReflectBlue", "smallreflectblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b18) {
        a.putExtra("Xperia", "xperia");
        startActivity(a);
    } else if (arg0.getId() == R.id.b19) {
        a.putExtra("XperiaBlue", "xperiablue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b20) {
        a.putExtra("Zte", "zte");
        startActivity(a);
    } else if (arg0.getId() == R.id.b21) {
        a.putExtra("ZteBlue", "zteblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b22) {
        a.putExtra("College", "college");
        startActivity(a);
    } else if (arg0.getId() == R.id.b23) {
        a.putExtra("CollegeBlue", "collegeblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b24) {
        a.putExtra("Defused", "defused");
        startActivity(a);
    } else if (arg0.getId() == R.id.b25) {
        a.putExtra("DefusedBlue", "defusedblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b26) {
        a.putExtra("Droid", "droid");
        startActivity(a);
    } else if (arg0.getId() == R.id.b27) {
        a.putExtra("DroidBlue", "droidblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b28) {
        a.putExtra("Pixel", "pixel");
        startActivity(a);
    } else if (arg0.getId() == R.id.b29) {
        a.putExtra("PixelBlue", "pixelsblue");
        startActivity(a);
    } else if (arg0.getId() == R.id.b30){
        a.putExtra("Facebook", "facebook");
        startActivity(a);
    }

}

@Override
public boolean onDown(MotionEvent arg0) {
    // TODO Auto-generated method stub
    return false;
}

@Override
public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
        float velocityY) {
    if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
            && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {

        Toast.makeText(Softkeys.this, "Right to left",
                Toast.LENGTH_LONG).show();
        Log.i("tag", "Right to left");
        return true; // Right to left

    } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
            && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {

        Toast.makeText(Softkeys.this, "Left to right",
                Toast.LENGTH_LONG).show();
        Log.i("tag", "Left to right");
        return true; // Left to right
    }
    return false;
}

@Override
public void onLongPress(MotionEvent arg0) {
    Intent in = new Intent(Softkeys.this, MainActivity.class);
    startActivity(in);
}

@Override
public boolean onScroll(MotionEvent arg0, MotionEvent arg1, float arg2,
        float arg3) {
    // TODO Auto-generated method stub
    return false;
}

@Override
public void onShowPress(MotionEvent arg0) {
    // TODO Auto-generated method stub

}

@Override
public boolean onSingleTapUp(MotionEvent arg0) {
    // TODO Auto-generated method stub
    return false;
}

@Override
public boolean onTouchEvent(MotionEvent me) {
return gestureDetector.onTouchEvent(me);
} 
```

}

对不起，有点大。无论如何，这是日志：

```
04-10 22:34:28.221: E/InputEventReceiver(3256): Exception dispatching input event.
04-10 22:34:28.221: E/MessageQueue-JNI(3256): Exception in MessageQueue callback: handleReceiveCallback
04-10 22:34:28.221: E/MessageQueue-JNI(3256): java.lang.NullPointerException
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at com.cydeon.plasmamodz.Softkeys.onTouchEvent(Softkeys.java:282)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.app.Activity.dispatchTouchEvent(Activity.java:2413)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:2120)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.view.View.dispatchPointerEvent(View.java:7426)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3220)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3165)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4292)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4271)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4363)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:179)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.os.MessageQueue.nativePollOnce(Native Method)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.os.MessageQueue.next(MessageQueue.java:125)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.os.Looper.loop(Looper.java:124)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at android.app.ActivityThread.main(ActivityThread.java:5235)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at java.lang.reflect.Method.invokeNative(Native Method)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at java.lang.reflect.Method.invoke(Method.java:511)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
04-10 22:34:28.221: E/MessageQueue-JNI(3256):   at dalvik.system.NativeStart.main(Native Method)
04-10 22:34:28.229: E/AndroidRuntime(3256): FATAL EXCEPTION: main
04-10 22:34:28.229: E/AndroidRuntime(3256): java.lang.NullPointerException
04-10 22:34:28.229: E/AndroidRuntime(3256):     at com.cydeon.plasmamodz.Softkeys.onTouchEvent(Softkeys.java:282)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.app.Activity.dispatchTouchEvent(Activity.java:2413)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:2120)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.view.View.dispatchPointerEvent(View.java:7426)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:3220)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.view.ViewRootImpl.deliverInputEvent(ViewRootImpl.java:3165)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.view.ViewRootImpl.doProcessInputEvents(ViewRootImpl.java:4292)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.view.ViewRootImpl.enqueueInputEvent(ViewRootImpl.java:4271)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.view.ViewRootImpl$WindowInputEventReceiver.onInputEvent(ViewRootImpl.java:4363)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:179)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.os.MessageQueue.nativePollOnce(Native Method)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.os.MessageQueue.next(MessageQueue.java:125)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.os.Looper.loop(Looper.java:124)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at android.app.ActivityThread.main(ActivityThread.java:5235)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at java.lang.reflect.Method.invokeNative(Native Method)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at java.lang.reflect.Method.invoke(Method.java:511)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
04-10 22:34:28.229: E/AndroidRuntime(3256):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:58:30.830

您已初始化`gestureDetector`which 是 的局部变量`onCreate()`。

只需删除此关键字`final GestureDetector`

```
private GestureDetector gestureDetector;

@Override
protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    setContentView(R.layout.themes);

    ActionBar actionBar = getActionBar();
    actionBar.hide();

    RelativeLayout ll = (RelativeLayout) findViewById(R.id.myLayout);
    gestureDetector = new GestureDetector(Softkeys.this, this);

    /* Your stuff */

} 
```

# java - 无法从通过 SocketChannel 接收的消息中提取正确的信息

> ID：15939774
> 
> 赞同：0
> 
> 时间：2013-04-11T02:36:57.050
> 
> 标签：java, tcp, bytebuffer, socketchannel

我正在发送一个已使用 DataOutput 流转换为字节的字符串

```
// creates a client socket which connects to the first successor's server.
Socket clientSocket = new Socket(host, succ1_port);

// send the output_string to the first successor.
DataOutputStream outToServer = new DataOutputStream(clientSocket.getOutputStream());
outToServer.writeBytes(output_string); 
```

然后通过 SocketChannel 接收它们：

```
// accept connection
SocketChannel connectionSocket = tcpserver.accept(); // tcpserver is a ServerSocketChannel

ByteBuffer buf = ByteBuffer.allocate(48);

// store and print no. of bytes read
int bytes_read = connectionSocket.read(buf);
System.out.println("bytes read = " +bytes_read);
String from_client_string = new String(buf.array(), Charset.forName("UTF-8")); 
```

收到的消息始终采用“XXXX XXX”格式，其中 X 是 0-9 之间的任何数字。

然后我尝试将这些消息分成两部分：

```
Pattern p = Pattern.compile("([0-9]{4}) ([0-9]{3})"); 
Matcher m = p.matcher(from_client_string);

if (m.matches()){   
  int filename = Integer.parseInt(m.group(1));
  int hash = Integer.parseInt(m.group(2));
  System.out.println("filename = " +filename);
  System.out.println("hash = " +hash);
else
  System.out.println("no match"); 
```

问题是，有时当我打印出从字节缓冲区转换的字符串时，它的值会发生变化......通常它是正确的，如“1234 210”，但在其他情况下它可能会删除一个数字并显示“1234 21”。但是，即使它是正确的，我也没有得到匹配？我还发现正在读取的字节数总是在变化......

有谁知道这里的问题是什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:48:17.320

您应该循环读取套接字，直到它关闭。如果没有可用的字节，则读取将阻塞，因此请确保您正在关闭另一端的连接。

所以在客户端

```
// creates a client socket which connects to the first successor's server.
Socket clientSocket = new Socket(host, succ1_port);

// send the output_string to the first successor.
DataOutputStream outToServer = new DataOutputStream(clientSocket.getOutputStream());
outToServer.writeBytes(output_string);
outToServer.close();
clientSocket.close(); 
```

在服务器端：

```
// accept connection
SocketChannel connectionSocket = tcpserver.accept(); // tcpserver is a ServerSocketChannel

ByteBuffer buf = ByteBuffer.allocate(48);

// store and print no. of bytes read
String result="";
while(connectionSocket.isOpen()){
  int bytes_read = connectionSocket.read(buf);
  System.out.println("bytes read = " +bytes_read);
  String from_client_string = new String(buf.array(),0,bytes_read Charset.forName("UTF-8"));
  reulst+= from_client_string; 
```

} }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T07:39:17.450

当您使用 ByteBuffer 阅读时，您会得到可用的字节数，这可能不是您写入的所有字节。DataInputStream.readUTF() 所做的是等待解码长度所需的字节数（16 位无符号值）。

我建议你使用`DataOutputStream.writeUTF(String)`and `String DataInputStream.readUTF()`。我建议你也考虑使用缓冲。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T10:38:54.003

谢谢彼得！你的建议似乎有效:) 我会投票给你，但我没有足够的声誉。

发送数据：

```
// creates a client socket which connects to the first successor's server.
Socket clientSocket = new Socket(host, succ1_port);

// send the output_string to the first successor.
DataOutputStream outToServer = new DataOutputStream(clientSocket.getOutputStream());
outToServer.writeUTF(output_string);

outToServer.close();    
clientSocket.close(); 
```

服务器端（接收数据）

```
// accept connection
SocketChannel connectionSocket = tcpserver.accept(); // tcpserver is a ServerSocketChannel

DataInputStream inToServer = new DataInputStream(connectionSocket.socket().getInputStream());
String from_client_string = inToServer.readUTF(); 
```

模式匹配的东西与 OP 中的相同......除了现在它实际上似乎工作了:)

# css - Safari 5 的 CSS hack

> ID：15939775
> 
> 赞同：6
> 
> 时间：2013-04-11T02:37:10.193
> 
> 标签：css, safari, cross-browser, css-hack

我正在开发一个网页，当我测试交叉浏览测试时，我的 CSS 样式与我的 google chrome 和我的 safari 5 发生冲突。

我所有浏览器的代码（firefox、chrome、opera）

```
.flex-direction-nav-featured a{
       margin-top: 4%;
   } 
```

我试试这个，但它不会工作

```
/* for safari only (wont work)*/
::root .flex-direction-nav-featured a{
    margin-top: 5%;
}
/* for safari only (but works with chrome also)*/
@media screen and (-webkit-min-device-pixel-ratio:0) {
      /* works with sfari and chrome */
   .flex-direction-nav-featured a{
       margin-top: 5%;
   } 

} 
```

是否有仅针对 Safari 5 的 CSS hack？我尝试了很多东西，但都没有奏效。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-04T14:30:45.640

您可能想尝试通过伪类阻止 chrome：

```
@media screen and (-webkit-min-device-pixel-ratio:0) { 
    /* Safari and Chrome */
    .flex-direction-nav-featured a{
        margin-top: 4%;
    } 

    /* Safari only override */
    ::i-block-chrome,.flex-direction-nav-featured a{
        margin-top: 5%;
    } 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-12T08:09:28.557

```
@media screen and (-webkit-min-device-pixel-ratio:0) { 
    /* Safari only override */
    ::i-block-chrome,.flex-direction-nav-featured a {
        margin-top: 5%;
    } 
} 
```

# f# - 为什么 F# 引用不能包含结构？

> ID：15939777
> 
> 赞同：3
> 
> 时间：2013-04-11T02:37:23.313
> 
> 标签：f#

我想定义一个结构，其中包含一些成员方法。我想用它`[<ReflectedDefinition>]`来标记那个结构成员方法。但是编译器告诉我这是错误的。

首先，看这段代码：

```
type Int4 =
    val mutable x : int
    val mutable y : int
    val mutable z : int
    val mutable w : int

    [<ReflectedDefinition>]
    new (x, y, z, w) = { x = x; y = y; z = z; w = w }

    [<ReflectedDefinition>]
    member this.Add(a:int) =
        this.x <- this.x + a
        this.y <- this.y + a
        this.z <- this.z + a
        this.w <- this.w + a

    override this.ToString() = sprintf "(%d,%d,%d,%d)" this.x this.y this.z this.w 
```

它编译。但是，如果我将类型设为结构，则无法编译：

```
[<Struct>]
type Int4 =
    val mutable x : int
    val mutable y : int
    val mutable z : int
    val mutable w : int

    [<ReflectedDefinition>]
    new (x, y, z, w) = { x = x; y = y; z = z; w = w }

    [<ReflectedDefinition>]
    member this.Add(a:int) = // <----------- here the 'this' report compile error
        this.x <- this.x + a
        this.y <- this.y + a
        this.z <- this.z + a
        this.w <- this.w + a

    override this.ToString() = sprintf "(%d,%d,%d,%d)" this.x this.y this.z this.w 
```

我收到以下错误：

```
error FS0462: Quotations cannot contain this kind of type 
```

这是此代码中的指向`this`。

任何人都知道为什么我不能在结构成员函数上创建引号？我想这可能是因为该结构是值类型，所以这个指针应该是 byref。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T05:20:52.307

事实上，在 F# 3.0 中观察到的编译器错误为：

> 错误 FS1220：ReflectedDefinitionAttribute 可能不适用于结构类型上的实例成员，因为该实例成员采用隐式的“this”byref 参数

观察到的行为的根本原因是 F# 引用的限制 - 您不能`byref`在引用的代码中使用类型。

然而，此限制的结果仅适用于*实例* `struct`成员；`static` `struct`成员可以用`[<ReflectedDefinition]>`属性装饰。

# google-chrome - Chrome LiveReload 扩展/guard-livereload 断开浏览器

> ID：15939783
> 
> 赞同：2
> 
> 时间：2013-04-11T02:38:01.763
> 
> 标签：google-chrome, guard, livereload

我在将guard-livereload 连接到浏览器时遇到问题。每次我尝试启用 LiveReload 插件时，它都会连接到浏览器并自动断开连接。LiveReload 然后显示：

[http://img21.imageshack.us/img21/2265/bugqf.png](http://img21.imageshack.us/img21/2265/bugqf.png)

我的卫兵文件：

```
    守卫'livereload'做
        观看(%r{.+\.(html|css|js)$})
    结尾

```

控制台输出：

```
PS D:\workspace\xampp\htdocs\lab\test-menu> 守卫
04:22:12 - INFO - Guard 使用 TerminalTitle 发送通知。
04:22:12 - 信息 - Guard 现在正在观看 'D:/workspace/xampp/htdocs/lab/test-menu'
04:22:12 - 信息 - LiveReload 1.6 正在等待浏览器连接。
【听警告】：
  缺少依赖项'wdm'（版本'~> 0.1'）！
  请运行以下命令以满足依赖关系：
    gem install --version '~> 0.1' wdm

  为了获得更好的性能，建议您满足缺少的依赖项。
  Listen 将轮询更改。在 https://github.com/guard/listen#polling-fallback 了解更多信息。

[1] 守卫（主要）> 04:22:17 - 信息 - 浏览器已连接。
04:22:18 - 信息 - 浏览器已断开连接。
04:22:21 - 信息 - 浏览器已连接。
04:22:22 - 信息 - 浏览器已断开连接。
04:22:24 - 信息 - 浏览器已连接。
04:22:25 - 信息 - 浏览器已断开连接。

```

版本：

*   后卫：1.7.0
*   重载：2.0.9
*   铬：26.0.1410.64 m
*   窗户：8

对不起我的英语不好。谢谢，亚当。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T10:20:31.023

我刚刚从 Chromium 切换到 Chrome 后遇到了同样的问题，并通过以下方式修复了它

```
gem install guard guard-livereload 
```

不知道问题是什么 - 我也有一些像你一样的依赖警告，它们仍然出现

```
WARN: Unresolved specs during Gem::Specification.reset:
      thor (>= 0.14.6)
      ffi (>= 0.5.0)
WARN: Clearing out unresolved specs.
Please report a bug if this causes problems. 
```

但无论如何，现在浏览器无需立即断开连接即可连接。

**注意：**我通过[RVM](https://rvm.io/)使用 Ruby 设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T19:58:25.330

一旦你已经在使用 Guard 和 livereload，你可以使用 rack-livereload gem 来替代插件。它可能看起来有点难以配置，但如果您按照其 Github 页面中的说明进行操作，您将立即进行 livereloading。

它可在： [https ://github.com/johnbintz/rack-livereload](https://github.com/johnbintz/rack-livereload)

# javascript - Javascript函数不起作用，简单的代码

> ID：15939787
> 
> 赞同：0
> 
> 时间：2013-04-11T02:38:27.027
> 
> 标签：javascript

下面相当简单的代码不起作用。不知道为什么，JS函数可以平滑移动图像。帮助将是伟大的家伙，几乎尝试了一切。

代码准备复制粘贴到 php 脚本并测试它。提前谢谢了

```
<?php
echo "

<script type='text/javascript'>

var img = document.getElementById( 'test' );

function translate( elem, x, y ) {
    var left = 120,
        top = 120,
        dx = left - x,
        dy = top - y,
        i = 1,
        count = 20,
        delay = 20;

    function loop() {
        if ( i >= count ) { return; }
        i += 1;
        elem.style.left = ( left - ( dx * i / count ) ).toFixed( 0 ) + 'px';
        elem.style.top = ( top - ( dy * i / count ) ).toFixed( 0 ) + 'px';
        setTimeout( loop, delay );
    }

    loop();
}

</script>
";
echo '
</head>
<body>
  <img id="test" src="http://placekitten.com/100/100" style="position:absolute; left:120px; top:120px;">

<a href="#" onclick="translate(\'test\', 30 , 30)">Translate to (0, 200)</a>

</body>
';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:20:34.423

```
<!doctype html>
<html>
<head>
<script type='text/javascript'>

function byId(e){return document.getElementById(e);}

function translate( elem, x, y ) {
    var left = 120,
        top = 120,
        dx = left - x,
        dy = top - y,
        i = 1,
        count = 20,
        delay = 20;

    function loop() 
    {
        if ( i >= count ) 
            return;
        i += 1;
        elem.style.left = ( left - ( dx * i / count ) ).toFixed( 0 ) + 'px';
        elem.style.top = ( top - ( dy * i / count ) ).toFixed( 0 ) + 'px';
        setTimeout( loop, delay );
    }
    loop();
}

window.addEventListener('load', myInit, false);

function myInit()
{
    byId('myAnchor').addEventListener('click', handleLinkClick, false);
}

function handleLinkClick(evt)
{
    //translate(byId('test'), 30, 30);  // only works on the #test target.
    translate(this, 30, 30);  // makes the handler work for any element it's attached to.
}
</script>
</head>
<body>
  <img id="test" src="http://placekitten.com/100/100" style="position:absolute; left:120px; top:120px;">
  <a id='myAnchor' href="#">Translate to (0, 200)</a>
</body>
</html> 
```

# android - 如何将 Logcat 中的内容重定向到 android 上的文件？

> ID：15939788
> 
> 赞同：6
> 
> 时间：2013-04-11T02:38:30.267
> 
> 标签：android, android-logcat

最近，我正在开发一个android应用程序。我的代码中有很多`Log.i`或`Log.e`。

当我在通过 USB 连接到计算机的手机上测试应用程序时，我可以获取 Logcat 下的所有日志。但是当我的手机没有连接到我的电脑时，我不知道错误来自哪里，因为`Log.*`没有将日志写入文件。

谁能给我一些关于如何将文件**重定向**到**对我的代码进行最小更改的建议**？非常感谢！`Log.*`

 ****ps**

我搜索了如何使用`adb logcat`. 谁能告诉我如何过滤与我当前应用程序对应的日志？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-20T15:46:10.870

要在您的设备上以编程方式将 LogCat 日志保存到文件，请使用以下代码：

```
String filePath = Environment.getExternalStorageDirectory() + "/logcat.txt";
Runtime.getRuntime().exec(new String[]{"logcat", "-f", filePath, "MyAppTAG:V", "*:S"}); 
```

`"MyAppTAG:V"`将所有标签的优先级设置为 Verbose（最低优先级）

`"*:S"`将所有标签的优先级设置为“静默”

如果要保存所有 logcat，只需输入“*:V”。

更多关于 logcat的信息在[这里](http://developer.android.com/tools/debugging/debugging-log.html)。**

# iphone - 使用playersToInvite的非朋友之间的游戏中心配对

> ID：15939789
> 
> 赞同：4
> 
> 时间：2013-04-11T02:38:36.453
> 
> 标签：iphone, ios, objective-c, game-center

这是不可能的吗？我尝试了一些测试代码，当我通过 ID 指定的两个玩家是朋友时成功进行匹配，但当他们不是朋友时失败并出现此错误。

使用 GKMatchmaker findmatchforrequest

打印错误说明：

> Error Domain=GKErrorDomain Code=8 "由于播放器无效，请求的操作无法完成。" UserInfo=0x1dd62f40 {GKServerStatusCode=5121, NSUnderlyingError=0x1dd62ca0 "操作无法完成。最近没玩过的玩家之间的邀请：G:1752931323, G:1752935955", NSLocalizedDescription=请求的操作无法完成，因为玩家是无效的。}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-23T16:15:44.613

我也希望能够做到这一点，但我相信 Apple 的文档中指定邀请只能来自朋友。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-09T08:03:29.907

它确实有效，是的 - 限制是玩家必须最近玩过。对于不是朋友的玩家，在某些情况下可能会出现这种情况：

*   他们一起玩了一场随机比赛
*   玩家正在或之前通过 wifi 或蓝牙一起玩过
*   他们曾经是朋友，但从他们的朋友列表中删除了对方。
*   他们进行了一场 3 人以上的多人比赛，他们与其中一名球员成为朋友，但不是另一名。
*   他们在以前一起玩过的两台设备上玩，即使这些设备的 GameCenter 登录最近发生了变化——因此他们在技术上不是朋友（重置网络设置会删除此功能）。

这些情况很少见，因此有“几乎总是朋友”条款。

他们的处理方式是首先尝试发出邀请，无论他们是否是朋友。如果出现此错误，我会通知用户他们不是好友，并提示他们使用好友请求视图控制器发送好友请求。

# php - onchange="document.my-form.sumbit" 时如何附加到 URL

> ID：15939792
> 
> 赞同：-2
> 
> 时间：2013-04-11T02:38:46.150
> 
> 标签：php, javascript, forms

当有人选择如下所示的表单选项时，如何将 (#vs) 值添加到现有 URL 的末尾？

```
<form name="vs_form" action="" method="post">
<select name="vs_team" onchange="document.vs_form.submit();">
<option value="-1"> - <?php _e('team'); ?> - </option>
<?php foreach(get_player_played_teams($player) as $t): ?>
<option value="<?php print $t['team_id'] ?>" <?php print ($vs_team == $t['team_id']) ?       'selected="selected"' : ''; ?>><?php print $t['team_name'] ?></option>
</select>
</form> 
```

现在，当他们从表单中选择一个选项时，脚本会处理，但是我想添加到 URL，以便我可以将用户移动到显示结果的页面区域。

**现有网址：**

```
http://somedomain/Mike-11084/ 
```

**用户在更改时需要什么：**

```
http://somedomain/Mike-11084/#vs 
```

请提供代码示例。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:59:21.347

使用 JavaScript/ [jQuery](http://jquery.com/)手动构建 url。可能看起来有点像这样：

```
$(document).ready(function() {
    $('select[name="vs_team"]').change(function() {
        var vs_team = $(this).val();
        window.location('http://somedomain/' + vs_team + '/#vs');
    });
}); 
```

您还需要删除代码中的这一行：

```
onchange="document.vs_form.submit();" 
```

当然，您需要包含 jQuery。

# sockets - UDP 是否允许重新打包？

> ID：15939796
> 
> 赞同：1
> 
> 时间：2013-04-11T02:39:39.970
> 
> 标签：sockets, network-programming, udp

我知道对于 TCP，您可以启用例如[Nagle 算法。](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)但是，您可以为 UDP 提供类似的东西吗？

**实际问题（假设 UDP 套接字）：**

如果我`send()`在短时间内调用两次，每次`send()`调用 1 个字节的数据。传输层是否可能决定仅发送 1 个带有数据的 UPD 数据包`1 byte + 1 byte = 2 bytes`？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T06:55:47.697

不会。UDP 数据报完全按照发送的方式发送，或者根本不发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:12:30.403

不符合 RFC ( [RFC 768](https://www.rfc-editor.org/rfc/rfc768) )。在 IP 设施本身之上，UDP 实际上只提供了额外的基于端口的路由和一点额外的损坏或路由错误检测。

这意味着无法组合数据报。事实上，由于它是面向事务的，我会说将两个事务合并为一个可能不是保持这些事务不同的一个*坏*主意。

否则，您将需要 UDP 之上的一层，它可以弄清楚如何从数据报中提取这些事务。目前，这不是必需的，因为数据报*是*事务。

作为对这种争用的附加支持（当然不是确定的），请参阅[UDP 维基百科页面](http://en.wikipedia.org/wiki/User_Datagram_Protocol)：

> 数据报——数据包是单独发送的，只有在它们到达时才检查完整性。**数据包有明确的边界，在接收时遵守，**这意味着接收器套接字上的读取操作将产生原始发送的完整消息。

但是，对它的最佳支持来自其客户之一。UDP 是专门为 TFTP 设计的（除其他外），如果您无法区分事务，该协议就会崩溃。

具体来说，TFTP 事务类型之一是`data`由操作码、块号和最多 512 字节的数据组成的事务。如果在开始时没有长度指示或在结束时没有标记值，*除非*事务和数据报之间存在一对一的映射，否则无法确定下一个事务将从哪里开始。

顺便说一句，其他四种 TFTP 事务类型具有固定长度或字符串结尾标记值，但`data`事务是此处的决定者。

# ruby-on-rails - has_one/has_many 具有依赖销毁但使用不同的键名

> ID：15939799
> 
> 赞同：2
> 
> 时间：2013-04-11T02:39:51.257
> 
> 标签：ruby-on-rails, model, associations, polymorphic-associations, dependent-destroy

所以我正在查看某人的代码，其中包含以下内容（意译）：

```
class user
  has_one :connection, :dependent => :destroy
  has_one :second_user, :through => :connection, :class_name => 'User'
end

class connection
  belongs_to :user
  belongs_to :second_user, :class => 'User'
end 
```

如果我有一个连接对象并删除关联的“用户”，它可以被很好地销毁。但我也想这样做，如果占用“second_user”字段的用户被破坏，则连接被破坏。我怎样才能在不搞太多事情的情况下无缝地完成这一点（希望不需要迁移）？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T03:23:47.080

请注意，单个用户可以与两个连接相关联。这意味着在用户（作为第二个用户）和尚未定义的连接之间存在另一个关联。我会打电话`secondary_connection`的。

```
class User
  has_one :connection, :dependent => :destroy
  has_one :secondary_connection, :class_name => 'Connection', :foreign_key => :second_user_id, :dependent => :destroy  # Inverse of Connection second_user
  has_one :second_user, :through => :connection, :class_name => 'User'
end 
```

# android - Intent 无法在活动之间切换-Android 4.0

> ID：15939800
> 
> 赞同：0
> 
> 时间：2013-04-11T02:39:54.937
> 
> 标签：android, android-intent, android-activity, android-4.2-jelly-bean

这是一个奇怪的问题，在 Android 4.0+ 设备的情况下，我的意图无法在活动之间切换，但是，在 android 2.2/2.3 的设备上它工作正常。

这就是我为我的类 PhotoActivity 定义意图的方式。

```
public static final void startActivityForResult(Activity parent, int requestCode, String userName, String photoUrl, Bitmap preview, boolean isMugshot) {
    System.out.println("photoactivity started" +requestCode+"second"+parent);
    Intent intent = new Intent(parent, PhotoActivity.class)
    .putExtra(USERNAME, userName)
    .putExtra(PHOTOURL, photoUrl)
    .putExtra(PREVIEW, preview)
    .putExtra(IS_MUGSHOT, isMugshot);
    parent.startActivityForResult(intent, requestCode);
} 
```

我想根据特定的用户触摸响应从另一个类切换到上面的这个活动类。我将其定义如下

```
case R.id.ImgAvatar:
        PhotoActivity.startActivityForResult(this, REQUEST_SHOW_AVATOR, mUserName, avatarUrl, mAvatar, true);
        break; 
```

我的代码很好，因为在 android 2.3/2.2 的情况下，我可以在活动之间切换。但是，在使用具有 android 4.0+ 的设备时，我没有在触摸响应时在活动之间切换，而是恢复到我的主要活动（不知道为什么）。

我还注意到 2.2 和 4.0 版本的控制台输出不同。我仍然无法猜测为什么 android 4.0 会造成麻烦。

这是活动正确启动时的日志（android 2.2/2.3），

```
 04-11 10:29:21.665: I/System.out(924): photoactivity started userdhttp://www.l-somewhere.com/media/Users/a6cb0167255045a9a2a16bb3411bc2/Mugshot/324c3a02b252428b8676e42671e392c2.jpg
04-11 10:29:21.675: I/System.out(924): photoactivity started4096secondcom.lsomewhere.android.UserDataActivity@44ae2b80
04-11 10:29:21.845: D/dalvikvm(924): GC_EXTERNAL_ALLOC freed 1481 objects / 289856 bytes in 84ms
04-11 10:29:21.855: I/PhotoActivity(924): onCreate// **rightly called** ,switch of activity
04-11 10:29:21.855: I/pthread(924): ## thread 924 is creating thread @dalvik/vm/Thread.c:1443
04-11 10:29:21.855: I/pthread(924): ## thread 1008 is created success
04-11 10:29:25.325: D/dalvikvm(938): GC_FOR_MALLOC freed 1339 objects / 483712 bytes in 69ms 
```

这是 android 4.0+ 的日志

```
04-11 10:34:47.415: I/System.out(22717): photoactivity started userdhttp://www.l-somewhere.com/media/Users/a6cb0167255045a9a2a16bb3411bc2/Mugshot/324c3a02b252428b8676e42671e392c2.jpg
04-11 10:34:47.420: I/System.out(22717): photoactivity started4096secondcom.lsomewhere.android.UserDataActivity@424d6db0
04-11 10:34:47.520: D/SensorManager(22717): unregisterListener::  Listener= android.view.OrientationEventListener$SensorEventListenerImpl@4201ce20
04-11 10:34:47.525: D/Sensors(22717): Remain listener = Sending .. normal delay 200ms
04-11 10:34:47.525: I/Sensors(22717): sendDelay --- 200000000
04-11 10:34:47.525: D/SensorManager(22717): JNI - sendDelay
04-11 10:34:47.525: I/SensorManager(22717): Set normal delay = true
04-11 10:34:47.745: D/dalvikvm(24379): GC_CONCURRENT freed 184K, 10% free 12467K/13703K, paused 3ms+12ms, total 29ms
04-11 10:34:47.750: W/CursorWrapperInner(24379): Cursor finalized without prior close()
04-11 10:34:47.775: I/MainActivity(24379): RegistrationId, DeviceTocken: //**I don't know why rather than starting the photo activity, the main activity is called,** 
```

显然，在 android 4.0+ 的情况下，我的第二个活动没有被调用，我被恢复为主要活动。另一个有趣的观察是实际上调用了意图，即我到达了定义意图的函数，但似乎意图无法启动活动，因此意图确实运行但它无法启动新活动。我一无所知，因为我的代码没有给出任何运行/编译时错误，因此很难找出问题所在。感谢帮助。

这是我的清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.lsomewhere.android"
android:versionCode="37"
android:versionName="1.0.37" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<permission 
    android:name="com.lsomewhere.android.permission.C2D_MESSAGE"
    android:protectionLevel="signature" />

<uses-permission android:name="com.lsomewhere.android.permission.C2D_MESSAGE" />
<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.CALL_PHONE" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.READ_PHONE_STATE"/>

<application
    android:icon="@drawable/ic_launcher_72x72"
    android:label="@string/app_name" >
    <uses-library
        android:name="com.google.android.maps"
        android:required="true" />

    <service
        android:name=".LsCommService"
        android:process=":apisrv" >
        <intent-filter>
            <action android:name="com.lsomewhere.android.LSAPISERVICE" />
        </intent-filter>
    </service>
    <service android:name=".GCMIntentService" />

    <receiver
        android:name="com.google.android.gcm.GCMBroadcastReceiver"
        android:permission="com.google.android.c2dm.permission.SEND" >
        <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

            <category android:name="com.lsomewhere.android" />
        </intent-filter>
    </receiver>

    <activity
        android:name=".SplashActivity"
        android:configChanges="keyboardHidden|orientation"
        android:label="@string/app_name"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".LoginActivity"
        android:configChanges="keyboardHidden|orientation"
        android:label="@string/login"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar"
        android:windowSoftInputMode="stateUnspecified|adjustPan" >
    </activity>
    <activity
        android:name=".ProfileActivity"
        android:configChanges="keyboardHidden|orientation"
        android:label="@string/login"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
    </activity>
    <activity
        android:name=".AvatarActivity"
        android:configChanges="keyboardHidden|orientation"
        android:label="@string/upload_your_photo"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
    </activity>
    <activity
        android:name=".MainActivity"
        android:configChanges="keyboardHidden|orientation"
        android:label="@string/app_name"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".UserDataActivity"
        android:configChanges="keyboardHidden|orientation"
        android:label="@string/user_data"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar"
        android:windowSoftInputMode="stateHidden" >
    </activity>
    <activity
        android:name=".GalleryActivity"
        android:configChanges="keyboardHidden|orientation"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar" 
        >

    </activity>
    <activity
        android:name=".PhotoActivity"
        android:configChanges="keyboardHidden|orientation"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar"
         >

    </activity>
    <activity
        android:name=".PasswordActivity"
        android:configChanges="keyboardHidden|orientation"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar"
        android:windowSoftInputMode="stateVisible" >
    </activity>
    <activity
        android:name=".AboutActivity"
        android:configChanges="keyboardHidden|orientation"

        android:theme="@android:style/Theme.Black.NoTitleBar" >
    </activity>
    <activity
        android:name=".AdvrDataActivity"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
    </activity>
     <activity
        android:name=".PageBase"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
    </activity>
    <activity android:name="com.lsomewhere.android.TutorialActivity" android:theme="@android:style/Theme.Black.NoTitleBar" android:screenOrientation="portrait" android:configChanges="keyboardHidden|orientation"></activity>
    <activity android:name="com.kuad.ADDisplay"/>
</application> 
```

# php - 具有相同 html 的两个页面呈现不同

> ID：15939809
> 
> 赞同：0
> 
> 时间：2013-04-11T02:40:46.707
> 
> 标签：php, javascript, jquery, html

我有一个页面，你可以在这里访问：

[http://beerportfolio.com/beerPortfolio2.php?u=hoppy](http://beerportfolio.com/beerPortfolio2.php?u=hoppy)

页面上有一个滑块，它清除我的 div 并将新数据加载到其中。当我向后单击滑块时，它应该加载与原来相同的数据。它会这样做，但是当我返回原始页面时，它的格式都是错误的。

在原始页面加载时：

![在此处输入图像描述](https://i.stack.imgur.com/v1cC3.png)

然后单击滑块并返回后：

![在此处输入图像描述](https://i.stack.imgur.com/FxQOW.png)

奇怪的是，当我查看每个页面的 html 源代码时，它们在我看来都完全相同。

我正在使用一个 js 函数来完成这一切，该函数使用 jquery load 调用 php 脚本将每个新页面加载到 div 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T02:45:47.897

您的 HTML 前后并不完全相同。

使用 Chrome 开发者工具之类的工具并检查元素，而不是查看源代码。通常，当页面通过 Javascript 更改时，“查看源代码”的结果不会更新。

前：

```
<div id="beerPortfolio">
 <div class="row">
                <div class="span3">
                    <div id="drop1">        <select id="dropOneMike" onchange="getDrop2Mike(5)">            <option value="0">All</option>
                            <option value="1">Alphabetical</option>
                            <option value="2">Brewery</option>
                            <option value="4">Rating</option>
                            <option value="3">Style</option>

                        </select>
                    </div>
                </div>
                <div class="span3">
                    <div id="drop2">

                    </div>
                </div>

                <div class="span3">

                </div>

            </div>
            <br> 
```

后：

```
<div id="beerPortfolio">        <select id="dropOneMike" onchange="getDrop2Mike(5)">            <option value="0">All</option>
                            <option value="1">Alphabetical</option>
                            <option value="2">Brewery</option>
                            <option value="4">Rating</option>
                            <option value="3">Style</option>

                        </select>

                <div class="span3">
                    <div id="drop2">

                    </div>
                </div>

                <div class="span3">

                </div>

            <br> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:49:33.093

当您使用切换开关使用 JavaScript 加载内容时，您不会加载相同的 HTML。您可以使用 Google Chrome 的检查元素来判断。只需右键单击您想了解详细信息的项目，然后单击“检查元素”。当您单击“查看源代码”时，它将向您显示不受 JavaScript 影响的 html。

最初呈现页面时，您的菜单位于 . 当您切换回时，它不再存在。

# java - 将一维数组转换为多维数组

> ID：15939810
> 
> 赞同：0
> 
> 时间：2013-04-11T02:40:56.603
> 
> 标签：java, arrays, methods

我正在尝试将我的一维数组转换为多维数组。将现有的 Interest Calculator Batch 应用程序从几个一维数组转换为 1 个多维数组。使用以下数据类型：double[][] 值；提示：数据集的最大数量（5）将是您的行，每个数据数组（来自原始的 InterestCalculatorBatch）（7）将是一列。2.所有数据都将包含在一个多维数组中。3.修改sortBySimple和displayInterest方法，接受单个多维数组，而不是多个单维数组

我修复了 displayInterest 以接受单个多维数组。如果我正确设置了 sortBySimple 以及当我需要修复这些或保持它们原样时程序计算利息时，我会感到困惑。感谢您的帮助。

```
import java.util.Scanner;
public class InterestCalculatorBatchMDA {
public static void main(String[] args )
{
    int cnt = 0; 
    double[][] arrPrincipalAmt = new double[5][7];
    double[][] arrInterestRate = new double[5][7];
    double[][] arrTerm = new double[5][7];
    double[][] arrSimple = new double[5][7];
    double[][] arrCompoundMonthly = new double[5][7];
    double[][] arrCompoundDaily = new double[5][7];
    double[][] arrCompoundWeekly = new double[5][7];

    do{ 
        arrPrincipalAmt[cnt] = getPrincipalAmount(1);
        arrInterestRate[cnt] = getInterestRate(1);
        arrTerm[cnt] = getTerm(1);

        arrSimple[cnt] =         round(calculateSimpleInterest(arrPrincipalAmt[cnt], arrInterestRate[cnt], arrTerm[cnt]),5);
        arrCompoundMonthly[cnt] = round(calculateCompoundInterest(arrPrincipalAmt[cnt], arrInterestRate[cnt],arrTerm[cnt] ,12.0 ),5); 
        arrCompoundWeekly[cnt] = round(calculateCompoundInterest(arrPrincipalAmt[cnt], arrInterestRate[cnt], arrTerm[cnt], 52.0 ),5);
        arrCompoundDaily[cnt] = round(calculateCompoundInterest(arrPrincipalAmt[cnt], arrInterestRate[cnt], arrTerm[cnt], 365.0 ),5);

        cnt++;
    }while (cnt < 5 && askYesNo("Enter another set of data (Yes/No):")); 

    displayInterest(arrPrincipalAmt,arrInterestRate,arrTerm,arrSimple,arrCompoundMonthly,arrCompoundWeekly,arrCompoundDaily,cnt);
    sortBySimple(arrPrincipalAmt,arrInterestRate,arrTerm,arrSimple,arrCompoundMonthly,arrCompoundWeekly,arrCompoundDaily,cnt);
    displayInterest(arrPrincipalAmt,arrInterestRate,arrTerm,arrSimple,arrCompoundMonthly,arrCompoundWeekly,arrCompoundDaily,cnt);

}

/** Round **/
  public static double round(double numb1, double numb2) {
    double round = ((double) Math.round(numb1*(Math.pow(10, numb2)))/(Math.pow(10, numb2)));;
    return round;
  }

  /** Calculate Simple **/
  public static double calculateSimpleInterest(double numb1, double numb2, double numb3) {
    double calculateSimpleInterest = ((numb1)*(numb2/100.0)*(numb3/12.0));
    return calculateSimpleInterest;
  }

  /** Calculate Compounded Daily **/
  public static double calculateCompoundInterest(double numb1, double numb2, double numb3, double numb4 ) {
     double calculateCompoundInterest = (numb1*Math.pow((1.0+((numb2/100.0)/numb4)),(numb4*(numb3/12.0))))-numb1;
    return calculateCompoundInterest;
  }

  /** Get principal amount **/
  public static double getPrincipalAmount(double numb1) {
      Scanner input = new Scanner(System.in);
      double numb2 = 1;
     do{System.out.print("Enter Loan Amount: ");
       numb2 = input.nextDouble();
       if(numb2 > 0);

            else{   
                    System.out.println("Data Error: Loan amount must be greater than zero. You entered " +numb2);
            }       
           }while (numb2 < 0);
    return numb2;
  }

  /** Get interest rate **/
  public static double getInterestRate(double numb1) {
      Scanner input = new Scanner(System.in);
      double numb2=1;
      do{System.out.print("Enter Yearly Interest Rate (1 to 100 percent): ");
        numb2 = input.nextDouble(); 
      double getInterestRate = 0;
     if (numb2 >= 0 && numb2 <= 100)
      getInterestRate = numb2;
            else{   
                    System.out.println("Data Error: Interest rate must be greater than or equal to zero and less than or equal to 100\. You entered " +numb2);
            }       
           }while (numb2 <= 0 || numb2 >= 100);
    return numb2;
  }

  /** Get term **/
  public static double getTerm(double numb1) {
      Scanner input = new Scanner(System.in);
      double numb2=1;
      do{System.out.print("Enter the Term (in months): ");
        numb2 = input.nextInt();
      double getTerm = 0;
      if (numb2 > 0)
      getTerm = numb2;
            else{   
                    System.out.println("Data Error: Loan amount must be greater than zero. You entered " +numb2);
            }       
           }while (numb2 <= 0);
    return numb2;
  }

  /** Sort by simple interest **/
  public static void sortBySimple(double[][] arrPrincipalAmt ,double[][]  arrInterestRate, double[][]  arrTerm, double[][]  arrSimple, double[][]  arrCompoundMonthly, double[][]  arrCompoundWeekly, double[][]  arrCompoundDaily, double count){
      for(int i = 0;i<count;i++)
      {
      for(int j=i+1; j<count;j++)
      {
      if(arrSimple[i][j] < arrSimple[i][j])
      {
      double temp = arrSimple[i][j];
      arrSimple[i][j] = arrSimple[i][j];
      arrSimple[i][j] = temp;

      double temp1 = arrPrincipalAmt[i][j];
      arrPrincipalAmt[i][j] = arrPrincipalAmt[i][j];
      arrPrincipalAmt[i][j] = temp1; 

      double temp2 = arrInterestRate[i][j];
      arrInterestRate[i][j] = arrInterestRate[i][j];
      arrInterestRate[i][j] = temp2; 

      double temp3 = arrTerm[i][j];
      arrTerm[i][j] = arrTerm[i][j];
      arrTerm[i][j] = temp3; 

      double temp4 = arrSimple[i][j];
      arrSimple[i][j] = arrSimple[i][j];
      arrSimple[i][j] = temp4;

      double temp5 = arrCompoundMonthly[i][j];
      arrCompoundMonthly[i][j] = arrCompoundMonthly[i][j];
      arrCompoundMonthly[i][j] = temp5; 

      double temp6 = arrCompoundDaily[i][j];
      arrCompoundDaily[i][j] = arrCompoundDaily[i][j];
      arrCompoundDaily[i][j] = temp6; 

      double temp7 = arrCompoundWeekly[i][j];
      arrCompoundWeekly[i][j] = arrCompoundWeekly[i][j];
      arrCompoundWeekly[i][j] = temp7; 
      }
      }
      } 
  }

  /** Display Interest **/
  public static void displayInterest(double[][] amt ,double[][] interest, double[][] term, double[][] simple, double[][] monthly, double[][] weekly, double[][] arrCompoundDaily, int count){
    int i=0;
    System.out.println("[Line #]   [Principal Amount]    [Interest Rate]    [Term]    [Simple Interest]    [Compound Monthly]    [Compound Weekly]    [Compound Daily]");
    do{
    System.out.print((i+1)+"                ");
    System.out.print(amt[i][i]+"                ");
    System.out.print(+interest[i][i]+"           ");
    System.out.print(+ term[i][i]+"           ");
    System.out.print(+simple[i][i]+"          ");
    System.out.print(+monthly[i][i]+"           ");
    System.out.print(+weekly[i][i]+"           ");
    System.out.println(+arrCompoundDaily[i][i]);
    i++;
  }while(i < count);
  }

  /**ask yes or no **/
  public static boolean askYesNo(String question) {
      Scanner input = new Scanner(System.in);
      String enteredText;
      boolean isAnswerValid;

      do{
          isAnswerValid = false;
          System.out.println(question);
          enteredText = input.nextLine();

          if (enteredText.length() > 0)
          {
              enteredText = enteredText.toUpperCase();

              if(enteredText.equals("YES") || enteredText.equals("Y") || enteredText.equals("NO") || enteredText.equals("N"))
              {
                  isAnswerValid = true;
              }
          }

          if(isAnswerValid == false)
          {
              System.out.println("Please enter 'Yes' or 'No'?");
          }

      } while(isAnswerValid == false);

      if(enteredText.equals("YES") || enteredText.equals("Y"))
      {
          return true;
      }

      return false;
  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:20:11.653

您的代码看起来像是在尝试用 Java 编写 C。*Java 是一种 OO 语言，如果您设计和编写程序以利用*它，您将获得更大的成功。像这样跨多个数组“涂抹”的数据结构从根本上难以处理。

要解决此问题，您需要做的第一件事是创建一个表示数组中的条目的类。

试图在保留当前“模糊”数据结构设计的同时修复程序是......直言不讳......浪费时间。

# python-2.7 - 数据框中的熊猫列表理解

> ID：15939811
> 
> 赞同：6
> 
> 时间：2013-04-11T02:40:57.873
> 
> 标签：python-2.7, pandas, dataframe

如果满足某些条件，我想提取当前存储在 (row + 1) 中的第二天开盘价并将其存储在新列中。

```
df['b']=''

df['shift']=''

df['shift']=df['open'].shift(-1)

df['b']=df[x for x in df['shift'] if df["MA10"]>df["MA100"]] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-11T12:04:04.190

有几种方法。使用`apply`：

```
>>> df = pd.read_csv("bondstack.csv")
>>> df["shift"] = df["open"].shift(-1)
>>> df["b"] = df.apply(lambda row: row["shift"] if row["MA10"] > row["MA100"] else np.nan, axis=1) 
```

产生

```
>>> df[["MA10", "MA100", "shift", "b"]][:10]
        MA10      MA100      shift          b
0  16.915625  17.405625  16.734375        NaN
1  16.871875  17.358750  17.171875        NaN
2  16.893750  17.317187  17.359375        NaN
3  16.950000  17.279062  17.359375        NaN
4  17.137500  17.254062  18.640625        NaN
5  17.365625  17.229063  18.921875  18.921875
6  17.550000  17.200312  18.296875  18.296875
7  17.681250  17.177500  18.640625  18.640625
8  17.812500  17.159375  18.609375  18.609375
9  17.943750  17.142813  18.234375  18.234375 
```

对于更矢量化的方法，您可以使用

```
>>> df = pd.read_csv("bondstack.csv")
>>> df["b"] = np.nan
>>> df["b"][df["MA10"] > df["MA100"]] = df["open"].shift(-1) 
```

或我的首选方法：

```
>>> df = pd.read_csv("bondstack.csv")
>>> df["b"] = df["open"].shift(-1).where(df["MA10"] > df["MA100"]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-26T08:27:38.440

修改 DSM 的方法 3，`np.where`明确说明 True/False 值：

```
#numpy.where(condition, x, y)
df["b"] = np.where(df["MA10"] > df["MA100"], df["open"].shift(-1), np.nan) 
```

明确使用列表推导：

```
#[xv if c else yv for (c,xv,yv) in zip(condition,x,y)]      #np.where documentation
df['b'] = [ xv if c else np.nan for (c,xv) in zip(df["MA10"]> df["MA100"], df["open"].shift(-1))] 
```

# android - 区分按下主页按钮、按下返回按钮和启动新活动

> ID：15939814
> 
> 赞同：0
> 
> 时间：2013-04-11T02:41:16.487
> 
> 标签：android

我有一个`FragmentActivity`. 在其`onPause`功能范围内，我想区分

*   按下主页按钮
*   按下返回按钮
*   启动一个新活动（这将导致片段活动`onPause`被调用）

对于*按下后退按钮的情况*，我知道我可以通过使用来区分它`this.isFinishing() == true`。

但是，*启动一个新的活动案例*怎么样？

我知道也许我可以在启动新活动之前设置一个标志，并在`onPause`功能结束时重置标志。但是，这对我来说听起来并不优雅。有没有更好更健壮的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:29:19.210

您可以创建一个单例类来跟踪您的活动何时开始/恢复/暂停/停止。创建一个基 Activity 类，在其每个生命周期回调中调用单例。

如果您在活动之间转换时查看回调的顺序，您应该会看到：

```
Pause Activity A
Create Activity B
Start Activity B
Resume Activity B
Stop Activity A 
```

当您的单例从 Activity A 的 onStop() 调用时，您可以检查是否有来自另一个 Activity（显然属于您的应用程序）的 onResume() 调用。如果没有，您就知道用户已更改应用程序或返回主屏幕。

至于后退按钮按下，您可以检查`isFinishing()`，或覆盖`Activity.onBackPressed()`并在那里做你的簿记。

# clojurescript - 如何将单个文件输出到cljsbuild的指定目录

> ID：15939816
> 
> 赞同：5
> 
> 时间：2013-04-11T02:41:46.550
> 
> 标签：clojurescript

使用 cljsbuild，我可以将所有 .cljs 文件编译为一个文件。但是，我希望能够选择一个输出目录并将每个 .cljs 文件编译成它自己的 .js 文件。如何指定？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:30:16.273

您可以使用“多个构建配置”：cljsbuild 接受一个配置向量作为`:builds`密钥，其中每个元素定义编译单独 .js 文件的规则（更多信息可以在[lein-cljsbuild README](https://github.com/emezeske/lein-cljsbuild)中找到）。简单的例子：

```
:cljsbuild 
{:builds 
 [;; Config for first .js file
  {:source-paths ["dir-with-cljs-for-first-js"]
   :compiler {:output-to "dir-for-js/first.js"}
  ;; Config for second .js file
  {:source-paths ["dir-with-cljs-for-second-js"]
   :compiler {:output-to "dir-for-js/second.js"}}]} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-01T11:10:28.510

您正在寻找 :output-dir 选项。我的 cljsbuild 看起来像这样：

```
:cljsbuild
  {:builds
   [{:id "dev"
     :source-paths ["src/cljs"]
     :compiler {:output-to  "resources/public/js/site.js"
                :output-dir "resources/public/js/out"
                :source-map true :optimizations :none }}
    {:id "main"
     :source-paths ["src/cljs"]
     :compiler {:pretty-print false
                :output-to "resources/public/js/site.js"
                :source-map "resources/public/js/site.js.map"
                :optimizations :advanced}}]} 
```

有了这个配置，并且**没有 site.js 已经编译/更新**， `lein cljsbuild once dev`或者`lein cljsbuild auto dev`将编译 site.js，然后看到它的依赖项没有被编译，然后去编译它们，连同它们的[sourcemaps](https://github.com/clojure/clojurescript/wiki/Source-maps)。如果 site.js 已编译并且是最新的，则 cljsbuild 会认为没有什么可做并在生成源映射等之前终止。

我还强烈推荐[lein figwheel](https://github.com/bhauman/lein-figwheel)用于 cljs 开发，并记得启用 sourcemaps。

# python-2.7 - 在 OS-X 上使用 macport 安装 scikit-learn 时出错

> ID：15939817
> 
> 赞同：2
> 
> 时间：2013-04-11T02:41:46.587
> 
> 标签：python-2.7, osx-mountain-lion, macports, scikit-learn

在 OS-X 上安装 scikit-learn 时出现以下错误

```
MacBook-Pro:~ $ sudo port install py27-scikit-learn
Error: The installed version of Xcode (2.0orlower) is too old to use on the installed OS version. Version 4.5.2 or later is recommended on Mac OS X 10.8.
To report a bug, follow the instructions in the guide:
    http://guide.macports.org/#project.tickets
Error: Processing of port py27-scikit-learn failed 
```

这是我机器上各种版本的软件。

**操作系统**

```
 ~ $ uname -a
    Darwin MacBook-Pro.local 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64 
```

**Python**

```
$ python
Python 2.7.2 (default, Jun 20 2012, 16:23:33) 
[GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

**Xcode**

```
 Version:  3.2 (10M2423)
  Location: /Developer
  Applications:
  Xcode:    3.2.5 (1760)
  Interface Builder:    3.2.5 (823)
  Instruments:  2.7 (3017)
  Dashcode: 3.0.2 (333)
  SDKs:
  iOS:
  4.2:  (8C134)
  iOS Simulator:
  3.2:  (7W367a)
  4.0:  (8A400)
  4.1:  (8B117)
  4.2:  (8C134)
  Other:
  10.5: (9L31a)
  10.6: (10M2423) 
```

**港口**

```
$ port
MacPorts 2.1.3
Entering interactive mode... ("help" for help, "quit" to quit) 
```

# iphone - UDID 替换？

> ID：15939819
> 
> 赞同：2
> 
> 时间：2013-04-11T02:42:01.607
> 
> 标签：iphone, ios

我知道`[[UIDevice currentDevice] uniqueIdentifier]`被拒绝了，我用过：

```
- (NSString *) uniqueDeviceIdentifier{
    NSString *macaddress = [[UIDevice currentDevice] macaddress];
    NSString *bundleIdentifier = [[NSBundle mainBundle] bundleIdentifier];

    NSString *stringToHash = [NSString stringWithFormat:@"%@%@",macaddress,bundleIdentifier];
    NSString *uniqueIdentifier = [stringToHash stringFromMD5];

    return uniqueIdentifier;
} 
```

如果我的方法未经 Apple 批准，我可以通过什么方法获得唯一标识符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T05:13:30.987

这个项目做的事情类似于你正在做的事情：[https](https://github.com/gekitz/UIDevice-with-UniqueIdentifier-for-iOS-5) ://github.com/gekitz/UIDevice-with-UniqueIdentifier-for-iOS-5 。我相信它现在正在被Apple接受。要真正回答您的问题，没有其他（公共）方法可以获取不仅唯一而且对于每个应用程序都相同的 id。@Vishal 的使用方法：

```
+ (NSString *)GetUUID {
  CFUUIDRef theUUID = CFUUIDCreate(NULL);
  CFStringRef string = CFUUIDCreateString(NULL, theUUID);
  CFRelease(theUUID);
  return [(NSString *)string autorelease];
} 
```

和@JeffWolski 的使用方法：

```
[[NSUUID UUID] UUIDString]; 
```

如果您不需要设备 ID 在应用程序之间保持一致并且只需要一种方法来识别您自己的特定设备，则可以工作。如果您需要在应用程序之间工作的设备 ID，则需要使用您的代码或开源项目来使用设备 MAC 地址。

**更新**

我刚刚找到了另一个解决方案。您可以使用`[[UIDevice currentDevice] identifierForVendor]`. 同样，此设备 ID 对您的应用程序来说是唯一的。[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIDevice_Class/Reference/UIDevice.html#//apple_ref/occ/instp/UIDevice/identifierForVendor](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIDevice_Class/Reference/UIDevice.html#//apple_ref/occ/instp/UIDevice/identifierForVendor)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T02:53:47.290

使用此 CFUUIDCreate() 创建 UUID：

```
+ (NSString *)GetUUID {
  CFUUIDRef theUUID = CFUUIDCreate(NULL);
  CFStringRef string = CFUUIDCreateString(NULL, theUUID);
  CFRelease(theUUID);
  return [(NSString *)string autorelease];
} 
```

UDID 仅在 iOS 5 中被弃用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-11T02:45:25.107

这是 iOS 6 中的新功能。它为您提供符合 RFC 4122 的 UUID。

`[[NSUUID UUID] UUIDString];`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-11T03:00:51.287

您可以做的一件事是使用[openUDID](https://github.com/ylechelle/OpenUDID)来替换它。

# c# - 即使存在异常，也将访问参数传递给 BackgroundWorker？

> ID：15939821
> 
> 赞同：2
> 
> 时间：2013-04-11T02:42:04.253
> 
> 标签：c#, backgroundworker

**精简版**

如果引发异常，我如何访问传递给事件的参数`BackgroundWorker`？`RunWorkerCompleted`

**更长的版本**

我`BackgroundWorker`在我的应用程序中使用了一个组件。在应用程序启动时，我查询数据库以获取未发送的消息列表。然后使用 GSM 调制解调器（在后台工作人员内部）我一一发送消息。

现在，只要我决定发送一条消息，我就会将它添加到一个名为**CurrentHandledMessages**的列表中。这是为了确保 2 个调制解调器不会发送相同的消息。

现在我将消息的 ID 传递给`BackgroundWorker`作为参数传递给 并发送消息，然后`RunWorkerCompleted`引发事件并从**CurrentHandledMessages**列表中删除 ID。我将结果作为元组传递。

```
e.Result = new Tuple<int, String>(idToHandle, response); 
```

如果没有例外，这工作正常。

`BackgroundWorker`但是，如果引发异常，我看不到如何将参数传递给。因为在`RunWorkerCompleted`事件中，无论如何我都想删除 id 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T02:54:01.663

没有内置的方式来获取传递的参数（在本例中为 ID）。你需要自己传递。我建议一直简单地传递它，不管有没有异常，所以想象一下在`DoWork`处理程序内部是这样的：

```
string response;

try
{
    ...

    response = "something";
}
catch (Exception ex)
{
    response = e.ToString();
}
finally
{
    e.Result = new Tuple<int, string>((int)e.Argument, response);
} 
```

所以现在，无论结果如何，您都将把该 ID 放入`RunWorkerCompleted`处理程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:11:24.103

您可以通过[RunWorkerCompletedEventArgs的](http://msdn.microsoft.com/en-us/library/system.componentmodel.runworkercompletedeventargs.aspx)[Error](http://msdn.microsoft.com/en-us/library/system.componentmodel.asynccompletedeventargs.error.aspx)属性传递信息。

您需要使用 and 处理异常并抛出自定义`Id`异常`Response`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T03:04:42.837

```
private void bgw_DoWork(object sender, DoWorkEventArgs e)
{
    try
    {
        // do the work
    }
    catch (Exception ex) // on error 
    {
        e.Error = ex;
        e.Result = "set the data here";
    }
} 
```

在完成事件

> 首先检查 e.Error，然后检查 e.Cancelled，最后检查 e.Result

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-16T04:18:10.873

根据[MSDN](https://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkercompleted(v=vs.85).aspx)

> 在访问 RunWorkerCompletedEventArgs.Result 属性之前，您的 RunWorkerCompleted 事件处理程序应始终检查 AsyncCompletedEventArgs.Error 和 AsyncCompletedEventArgs.Cancelled 属性。如果引发异常或取消操作，则访问 RunWorkerCompletedEventArgs.Result 属性会引发异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-22T20:12:43.160

只需从 BackgroundWorker 派生并实现所需的属性：

```
public class CustomBackgroundWorker : BackgroundWorker
{
    public object Argument { get; private set; }

    protected override void OnDoWork(DoWorkEventArgs e)
    {
        Argument = e.Argument;
        base.OnDoWork(e);
    }
} 
```

然后从 RunWorkerCopmleted 和其他事件中访问它，如下所示：

```
private void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    object originalArgument = ((CustomBackgroundWorker)sender).Argument;

    // The rest of the stuff
    if (e.Cancelled) { ... }
    if (e.Error) {...}
    ...
} 
```

错误处理语义保持不变

# ios - iphone中的历史保存和检索

> ID：15939823
> 
> 赞同：1
> 
> 时间：2013-04-11T02:42:21.180
> 
> 标签：ios, objective-c, nsuserdefaults, data-persistence

我有一个应用程序，用户可以在其中上传录制的音频或视频，或者从库中选择现有的、点击或选择的图片。我需要该用户能够查看最近上传的 50 个项目，为此我制作了一个名为“Recent Additions”的屏幕，其中有一个表格视图，其中将填充这 50 个项目。

我有什么选择？

*   我认为我必须为它添加一个本地存储......如果是，如何？
*   可以`NSUserDefaults`帮助我吗？
*   当用户记录/点击/选择任何资产时，系统会生成一个 URL，我也将其用于上传。在历史记录中保存该项目需要相同的 URL 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T04:23:09.330

NSUserDefaults 不会帮助你。这意味着填充文本字段和小任务——当然不是写入磁盘。

要将视频或照片保存到应用程序之外的 iPhone，您可以使用 UIActivityViewController 并在创建 NSData 实例后保存到相机角色。但是，这仅在您支持 iOS 6 及更高版本的情况下。

如果您想将媒体保存到设备的相机胶卷，您可以创建一个 NSData 实例，使用 UIImagePNGRepresentation（如果是图像），使用数据创建一个 UIImage 实例，最后使用 UIImageWriteToSavedPhotosAlbum。

对于应用内写入磁盘，请查看 Apple 的 NSCoding 和 NSFileManager 文档。

# linker - 使用 CMake 链接到 Armadillo 库

> ID：15939824
> 
> 赞同：6
> 
> 时间：2013-04-11T02:42:27.507
> 
> 标签：linker, cmake, armadillo, mlpack

我正在尝试在 Windows 8 上安装 MLPack。我将 CMakeLists.txt 文件配置为：

```
set(ARMADILLO_LIBRARY "C:\\Program Files (x86)\\armadillo\\lib")
set(ARMADILLO_INCLUDE_DIR "C:\\Program Files (x86)\\armadillo\\include") 
```

然后，当我运行 CMake 时，我收到了一系列警告，如下所示：

```
WARNING: Target "mlpack" requests linking to directory "C:\Program Files (x86)\armadillo\lib".  Targets may link only to libraries.  CMake is dropping the item. 
```

在 \mlpack-1.0.4\src\mlpack 目录中，我找到了另一个 CMakeLists 文件：

```
target_link_libraries(mlpack
  ${ARMADILLO_LIBRARIES}
  ${Boost_LIBRARIES}
  ${LIBXML2_LIBRARIES}
) 
```

我改为（不确定这是否是个好主意）：

```
target_link_libraries(mlpack
  ${Boost_LIBRARIES}
)
link_directories(mlpack
  ${ARMADILLO_LIBRARIES}
  ${LIBXML2_LIBRARIES}
) 
```

然后 CMake 似乎运行顺利：

```
-- Found Armadillo: C:\Program Files (x86)\armadillo\lib (found suitable version "3.800.2", minimum required is "2.4.2")
-- Found LibXml2: C:\cpp\libraries\libxml2-2.7.8.win32\lib (found suitable version "2.7.8", minimum required is "2.6.0")
-- Boost version: 1.53.0
-- Found the following Boost libraries:
--   program_options
--   unit_test_framework
-- Boost version: 1.53.0
-- Found the following Boost libraries:
--   random
-- Could NOT find Doxygen (missing:  DOXYGEN_EXECUTABLE)
-- Configuring done
-- Generating done
-- Build files have been written to: C:/cpp/libraries/mlpack-1.0.4 
```

但是现在运行 make 我有很多这样的错误：

```
Linking CXX executable ..\..\..\..\gmm.exe
CMakeFiles\gmm.dir/objects.a(gmm_main.cpp.obj):gmm_main.cpp:(.text+0xb9): undefined reference to `wrapper_dgemv_'
CMakeFiles\gmm.dir/objects.a(gmm_main.cpp.obj):gmm_main.cpp:(.text$_ZN4arma6auxlib10det_lapackIdEET_RKNS_3MatIS2_EEb[__ZN4arma6auxlib10det_lapackIdEET_RKNS_3MatIS2_EEb]+0x115): undefined reference to `wrapper_dgetrf_' 
```

经过调查，这似乎与犰狳有关。

知道发生了什么吗？我想我应该为犰狳使用 target_link_libraries 但我不确定如何。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T23:25:33.930

希望这个问题很容易解决。当你这样做...

```
set(ARMADILLO_LIBRARY "C:\\Program Files (x86)\\armadillo\\lib")
set(ARMADILLO_INCLUDE_DIR "C:\\Program Files (x86)\\armadillo\\include") 
```

您实际上是在使呼叫短路`find_package(Armadillo 2.4.2 REQUIRED)`，因为它希望必须完成工作才能找到这些路径。但是，什么时候`find_package`工作，变量`ARMADILLO_LIBRARY`被设置为库本身的路径——而不是库目录的路径。

所以问题归结为设置`ARMADILLO_LIBRARY`到lib目录的路径而不是lib本身。这最终会产生链接器错误，因为目标`gmm`（在 src\mlpack\methods\gmm\CMakeLists.txt 中添加）链接到`mlpack`，并且`mlpack`已设置为链接到`${ARMADILLO_LIBRARIES}`，但未正确设置。

事实证明，`find_package(Armadillo ...)`已经签入`"$ENV{ProgramFiles}/Armadillo/lib"`and `"$ENV{ProgramFiles}/Armadillo/include"`，我希望这些解决方案可以在您`"C:\\Program Files (x86)\\armadillo\\lib"`的`"C:\\Program Files (x86)\\armadillo\\include"`机器上解决。

因此，要解决此问题，您应该删除行设置`ARMADILLO_LIBRARY`和`ARMADILLO_INCLUDE_DIR`，并恢复您在 src\mlpack\CMakeLists.txt 中的更改（[`link_directories`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3alink_directories "CMake v2.8.10 文档")无论如何，使用通常是个坏主意）。

进行这些更改后，您应该至少删除您的 CMakeCache.txt（在构建树的根目录中），甚至在重新运行 CMake 之前删除整个构建树，以避免使用先前失败尝试中的错误缓存值的可能性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-13T21:25:11.630

我意识到这是一个迟到的答案，我希望你现在已经弄清楚了。即便如此，我相信您的问题是 ARMADILLO_LIBRARY 变量应该保存库的确切位置，而不是库所在的目录。所以，也许这会起作用：

```
set(ARMADILLO_LIBRARY "C:\\Program Files (x86)\\armadillo\\lib\\armadillo.lib")
set(ARMADILLO_INCLUDE_DIR "C:\\Program Files (x86)\\armadillo\\include") 
```

变量 LIBXML2_LIBRARIES 还应该包含 libxml2.lib 的实际路径（或任何实际调用的库）。

您是否看过我为在 Windows 上编译 mlpack 而写的这页说明？

[http://www.mlpack.org/trac/wiki/MLPACKOnWindows](http://www.mlpack.org/trac/wiki/MLPACKOnWindows)

如果您将来有其他问题，请随时在 Trac 上提交错误报告。我只是偶然发现了这一点，所以我没有监控 Stack Overflow 的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-31T20:41:16.933

我遇到了同样的问题。有两个子弹[aramadillo 图书馆常见问题解答](http://arma.sourceforge.net/faq.html)要求您取消注释行

```
#define ARMA_USE_LAPACK 
#define ARMA_USE_WRAPPER 
```

在文件中

```
include/armadillo_bits/config.hpp 
```

它在犰狳源代码树中。

取消注释后重新编译时，您可以看到犰狳共享库/dll 中的符号。希望这可以帮助！

# javascript - 在 Windows 8 应用程序中本地保存数据的最佳方法

> ID：15939825
> 
> 赞同：1
> 
> 时间：2013-04-11T02:42:31.280
> 
> 标签：javascript, windows, storage, local

我正在为某人创建一个 Windows 8 应用程序（使用 HTML 5 和 JavaScript），他们已经改变了对我的数据存储要求，我可以使用一些指导。我需要的是一个只为本地用户保留的数据源，而不是在数据库或云中在线。用户将被分配一台安装了应用程序的平板电脑，他们将通过表单输入数据以自定义其本地副本。

这是我的要求：

- 数据必须在应用程序安装在设备上的整个生命周期内持续存在。

-我需要能够在某种程度上查询数据。我基本上有大约 15-20 个表单可以接受输入数据，然后是一个主表单，它将从这 15-20 个“子”表单中填充下拉和选择选项。

- 大小应该不是问题，都是文本数据，不会输入多少。在应用程序的整个生命周期中，这不会超过几百 MB。

我研究了 XML、indexedDB（在外面听起来不错，但没有找到任何保证这将持续存在）和应用程序数据（本地），这在我的阅读能力方面似乎极为有限。

你认为我最好的选择是什么？任何建议将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:38:04.947

这应该有帮助

```
 (function () {
    "use strict";
    var page = WinJS.UI.Pages.define("/html/index.html", {
        ready: function (element, options) {
                   //do your things 
                }
    });

    var roamingFolder = Windows.Storage.ApplicationData.current.roamingFolder;
    var afile = "FileToStoreStuff.txt";

    function makefile() {
        roamingFolder.createFileAsync(afile, Windows.Storage.CreationCollisionOption.replaceExisting)
            .then(function (file) {
                return Windows.Storage.FileIO.writeTextAsync(file);
            })
    }

    function fileRead() {
        roamingFolder.getFileAsync(filename)
            .then(function (file) {
                return Windows.Storage.FileIO.readTextAsync(file);
            }).done(function (text) {
                    //do stuff
                );
    }

})(); 
```

这种假设您的数据可能会发生变化。如果不是，您可以采用不同的方法，例如将 roamingFolder 变量替换为：

```
var localSettings = applicationData.localSettings;
var localFolder = applicationData.localFolder; 
```

如果您需要从应用程序的其他地方访问数据，请查看[开发文档。](http://msdn.microsoft.com/en-us/library/windows/apps/hh464917.aspx)

# c - 从 8 位值转换时如何对 9 位值进行符号扩展？

> ID：15939833
> 
> 赞同：1
> 
> 时间：2013-04-11T02:43:19.363
> 
> 标签：c, int, bit-manipulation, signed, stdint

我正在我的简单 VM 中实现一个相对分支功能。

基本上，我得到了一个 8 位的相对值。然后我将其左移 1 位以使其成为 9 位值。因此，例如，如果您说“分支 +127”，这实际上意味着 127 条指令，因此 IP 将增加 256。

我当前的代码如下所示：

```
uint8_t argument = 0xFF; //-1 or whatever
int16_t difference = argument << 1;
*ip += difference; //ip is a uint16_t 
```

但是，我不相信差异会被检测为小于 0。我对签名到未签名的工作方式感到生疏。除此之外，我不确定在 case 参数是 -1 或 -2 或其他东西的情况下是否会正确地从 IP 中减去差异。

基本上，我想要满足这些“测试”的东西

```
//case 1
argument = -5
difference -> -10
ip = 20 -> 10 //ip starts at 20, but becomes 10 after applying difference

//case 2
argument = 127 (must fit in a byte)
difference -> 254
ip = 20 -> 274 
```

希望这使它更清楚一点。

无论如何，我将如何便宜地做到这一点？我看到了一个类似问题的“解决方案”，但它涉及分裂。我正在使用慢速嵌入式处理器（假设没有有效的乘法和除法方法），所以这是我想避免的一件大事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:51:29.003

我所有的引用都来自 C 标准，第 6.3.1.3 节。当值在有符号类型的范围内时，无符号到有符号的定义很好：

> 1 当整数类型的值转换为_Bool以外的其他整数类型时，如果该值可以用新的类型表示，则不变。

有符号到无符号定义明确：

> 2 否则，如果新类型是无符号的，则在新类型可以表示的最大值的基础上反复加减一，直到该值在新类型的范围内。

无符号到有符号，当值超出范围时定义不太明确：

> 3 否则，新类型是有符号的，值不能在其中表示；结果是实现定义的，或者引发了实现定义的信号。

不幸的是，您的问题在于第 3 点的领域。C 不保证任何隐式机制来转换超出范围的值，因此您需要明确提供一个。第一步是决定您打算使用哪种表示形式：1 的补码、2 的补码或符号和幅度

您使用的表示将影响您使用的翻译算法。在下面的示例中，我将使用二进制补码：如果符号位为 1 并且值位均为 0，则这对应于您的最低值。您的最低值是您必须做出的另一个选择：在二进制补码的情况下，使用`INT16_MIN`(-32768) 或`INT8_MIN`(-128) 中的任何一个都是有意义的。`INT16_MIN - 1`在其他两个的情况下，使用或`INT8_MIN - 1`由于负零的存在是有意义的，这可能应该被翻译为与常规零无法区分。在此示例中，我将使用`INT8_MIN`，因为`(uint8_t) -1`应该将 -1 转换为`int16_t`.

将符号位与值位分开。`value`应该是绝对值，除非在二进制补码最小值的情况下，何时为`sign`1，而`value`为 0。当然，符号位可以是您喜欢的任何位置，尽管它是常规的休息在最左边。因此，右移 7 位得到传统的“符号”位：

```
uint8_t sign =  input >> 7;
uint8_t value = input & (UINT8_MAX >> 1);
int16_t result; 
```

如果符号位为 1，我们将把它称为负数并添加到 INT8_MIN 以构造符号，这样我们就不会陷入与开始时相同的难题，或者更糟：未定义的行为（这是一个人的命运其他答案）。

```
if (sign == 1) {
    result = INT8_MIN + value;
}
else {
    result = value;
} 
```

这可以缩短为：

```
int16_t result = (input >> 7) ? INT8_MIN + (input & (UINT8_MAX >> 1)) : input; 
```

...或者，更好的是：

```
int16_t result = input <= INT8_MAX ? input
                                   : INT8_MIN + (int8_t)(input % (uint8_t) INT8_MIN); 
```

符号测试现在涉及检查它是否在正范围内。如果是，则该值保持不变。否则，我们使用加法和取模来产生正确的负值。这与上述 C 标准的语言相当一致。它适用于二进制补码，因为`int16_t`并且`int8_t`保证在内部使用二进制补码表示。然而，类似`int`的类型不需要在内部使用二进制补码表示。例如，在转换为时，`unsigned int`需要`int`进行另一次检查，以便我们将小于或等于 INT_MAX 的值视为正数，将大于或等于 (unsigned int) INT_MIN 的值视为负数。任何其他值都需要作为错误处理；在这种情况下，我将它们视为零。

```
/* Generate some random input */
srand(time(NULL));
unsigned int input = rand();
for (unsigned int x = UINT_MAX / ((unsigned int) RAND_MAX + 1); x > 1; x--) {
    input *= (unsigned int) RAND_MAX + 1;
    input += rand();
}

int result = /* Handle positives: */ input <= INT_MAX ? input
           : /* Handle negatives: */ input >= (unsigned int) INT_MIN ? INT_MIN + (int)(input % (unsigned int) INT_MIN)
           : /* Handle errors: */ 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T08:28:51.053

如果偏移量在 2 的补码表示中，则

转换这个

```
uint8_t argument = 0xFF; //-1
int16_t difference = argument << 1;
*ip += difference; 
```

进入这个：

```
uint8_t argument = 0xFF; //-1
int8_t signed_argument;

signed_argument = argument; // this relies on implementation-defined
                            // conversion of unsigned to signed, usually it's
                            // just a bit-wise copy on 2's complement systems
// OR
// memcpy(&signed_argument, &argument, sizeof argument);

*ip += signed_argument + signed_argument; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T02:55:52.467

澄清一下：您担心左移一个负 8 位数字会使它看起来像一个正 9 位数字？只需在左移前用初始数字的符号位填充前 9 位：

```
diff = 0xFF;
int16 diff16=(diff + (diff & 0x80)*0x01FE) << 1; 
```

现在你`diff16`的签名`2*diff`

正如 Richard J Ross III 所指出的，您可以使用条件分支避免乘法（如果这在您的平台上很昂贵）：

```
int16 diff16 = (diff + ((diff & 0x80)?0xFF00:0))<<1; 
```

如果您担心事情会停留在范围内等（“未定义的行为”），您可以这样做

```
int16 diff16 = diff;
diff16 = (diff16 | ((diff16 & 0x80)?0x7F00:0))<<1; 
```

这绝不会产生超出范围的数字。

不过，最**干净的解决方案**似乎是“cast and shift”：

```
diff16 = (signed char)diff; // recognizes and preserves the sign of diff
diff16 = (short int)((unsigned short)diff16)<<1; // left shift, preserving sign 
```

这会产生预期的结果，因为编译器会自动处理第一行中的符号位（因此不需要掩码）；在第二行中，它对 unsigned int 进行左移（根据标准对溢出进行了很好的定义）；最后的转换回`short int`确保数字被正确解释为负数。我相信这种形式的构造永远不会“未定义”。

# wpf - 如何让三角形根据方程在 3D 中绘制抛物线？

> ID：15939844
> 
> 赞同：0
> 
> 时间：2013-04-11T02:44:47.383
> 
> 标签：wpf, 3d, direct3d

我有方程 y= x^2 + z^2，如何让三角形绘制抛物面？我想使用 WPF 3D 来实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T06:05:59.617

在 XZ 平面上生成一个 2D 网格，范围在 [-D,-D] 和 [+D,+D] 之间（D 可以是任何值，例如 10）。你可以编写一个嵌套循环来为此生成三角形，我想。

现在，在生成每个顶点 V`<x,z>`时，只需生成 V' 即可`<x,x^2+z^2,z>`。

# objective-c - 如何模拟类似于 UIPanGestureRecognizer 的回调函数的条件

> ID：15939845
> 
> 赞同：2
> 
> 时间：2013-04-11T02:44:47.447
> 
> 标签：objective-c, uiview, uigesturerecognizer

我做了一个函数来处理复杂的布局。该函数由 UIPanGestureRecognizer 的回调函数驱动。幸运的是，它运行良好。现在，我想创建一个新的活动方法来调用该函数。问题来了：我可以模拟一个条件来调用函数而不做任何修改吗？

```
- (void)handlePan:(UIPanGestureRecognizer *)recognizer {
    CGPoint translation = [recognizer translationInView:myParentView];
    self.center = CGPointMake(self.center.x+translation.x,self.center.y);
    isToLeft = (translation.x<0) ? YES : NO;
    if ([self.delegate respondsToSelector:@selector(midMoveViewMove: transX:isToLeft:)]) {
        [self.delegate midMoveViewMove:CGPointMake(self.frame.origin.x, self.frame.origin.y)
                                transX:translation.x
                              isToLeft:isToLeft];
    }
    [recognizer setTranslation:CGPointMake(0, 0) inView:myParentView];} 
```

# ruby - 如何使用 RVM 设置默认 Ruby 版本？

> ID：15939861
> 
> 赞同：0
> 
> 时间：2013-04-11T02:46:43.330
> 
> 标签：ruby, macos, osx-lion, rvm

[我从ruby](http://rubyinstaller.org) ​​installer.org 将 Ruby、Rails 和其他东西安装到我的 MacOS X Lion 系统上。但是，我无法覆盖 1.8.3 的 Mac 版本的 Ruby。如何将其覆盖到最新版本？当我尝试运行以下命令时：

```
rvm use 1.9.3-p392 
```

它说：

```
ruby-1.9.3-p392 is not installed. 
```

另一个问题是当我尝试使用以下方式连接到 MySQL 时：

```
mysql -u root 
```

我收到以下错误：

```
Can't connect to local MySQL server through socket 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T02:54:36.947

您可以安装任何您喜欢的版本，例如`rvm install ruby-1.9.3-p392`. 然后，您可以使用 将其设为默认值`rvm use --default ruby-1.9.3-p392`。你必须`install`在你可以之前`use`。

有关简要概述，请参阅[**备忘单**](http://cheat.errtheblog.com/s/rvm)或查阅页面底部索引的综合文档：[https ://rvm.io/](https://rvm.io/)

您关于 MySQL 的第二个问题应单独提交（您可能尚未启动 MySQL 服务器）。

# java - Web项目的Eclipse-lib问题

> ID：15939869
> 
> 赞同：0
> 
> 时间：2013-04-11T02:47:26.257
> 
> 标签：java, eclipse, tomcat, myeclipse

以前用过myeclipse，最近用Eclipse，喜欢在web-inf中对lib排序，但是现在做的时候后台说找不到jar包。我检查了tomcat中的webapps目录，它和myeclipse一样。我的tomcat是7.0。

为什么会这样？感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:29:34.523

请在 Build Path 中添加 jar。即使您已复制到 WEB-INF，您也需要使用 `Right Click Project in eclipse-->Properties-->Java Build Path-->Libraries`选项卡添加引用并添加外部 jar 并引用所需的 jar。

# java - InputStream 的 read(byte [] b) 返回一个字节数组有负元素

> ID：15939872
> 
> 赞同：-1
> 
> 时间：2013-04-11T02:47:55.560
> 
> 标签：java

我的程序将文件读​​入字节数组，但我不知道为什么数组结果中有很多负数。我认为数组中的元素的值在 0 到 255 之间。这里的代码：

```
public static void main(String [] args)
    {
        try
        {
            File file = new File("C:\\1.mp3");
            FileInputStream fis = new FileInputStream(file);
            byte[] bytes = new byte[(int)file.length()];
            fis.read(bytes);
            boolean check = true;
            int i = -1;
            while(check)
            {
                i=i+1;
                if(bytes[i]<0)
                {
                    check = false;
                    System.out.println("There is a negative number.");
                }
            }
        }
        catch(IOException ex)
        {
            System.out.println(ex.getMessage());
        }
    } 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T03:22:28.867

Java`byte`的范围为 -128 到 127。有关更多信息，请参阅Java 教程中的[原始数据类型](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)。

您对从`InputStream`.

第一种方法是使用[InputStream.read()](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#read%28%29)方法一次读取一个字节。此方法返回一个`int`（不是 a `byte`），该值具有读取的值（范围 0-255）或 -1 以指示已到达流的末尾。该`int`类型是 Java 中带符号的 32 位值。

第二种方法是示例代码中所做的，使用[InputStream.read(byte[])](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#read%28byte%5B%5D%29)一次读取多个字节。此方法将`byte`数组作为参数，并返回一个`int`指示读取的字节数，如果已到达流的末尾，则返回 -1。这些`byte`值的范围为 -128 到 127，因为该`byte`类型在 Java 中是带符号的 8 位值。

如果您需要第二种方式的无符号值，您可以通过执行以下操作进行转换：

```
byte b = ...; //element in the byte array read from stream
int i = b & 0xFF; 
```

这会将 32 位的低 8 位设置为`int`值中的`byte`值，从而为您提供无符号值。

# magento - Magento：将值从模板文件传递到块

> ID：15939874
> 
> 赞同：0
> 
> 时间：2013-04-11T02:48:16.637
> 
> 标签：magento

在我的 magento 模块中，我需要从 .phtml 文件的选择下拉列表中获取选定的值，并从相应的块类中检索该值，以便我可以执行数据库查询 acc。到收到的价值。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T09:18:45.773

只需使用纯 javascript 或 magento 使用的 javascript 框架“原型”的方法检索 phtml 文件中的下拉值。

然后，调用您的 block 方法，该方法直接从 phtml 文件进行数据库查询，并将下拉值作为参数传递给 block 方法。

假设您的块方法是 getValueFromDatabase($param)，那么您可以使用 $this->getValueFromDatabase($param) 从 phtml 文件中访问您的块方法。

您可以访问 phtml 文件中的所有块方法。

# ios - 创建胖文件：libtool vs lipo（我应该更喜欢 lipo 吗？）

> ID：15939877
> 
> 赞同：15
> 
> 时间：2013-04-11T02:48:19.080
> 
> 标签：ios, iphone, macos, libtool-xcode, lipo

我想知道使用时会有什么区别：

```
lipo -create i386/libAwesome.a armv7/libAwesome.a -o fat/libAwesome.a 
```

和

```
libtool -static i386/libAwesome.a armv7/libAwesome.a -o fat/libAwesome.a 
```

我的印象`lipo`更笼统，它只会*粘贴*来自不同架构的两个文件，而`libtool`特定于库，这是真的吗？

在什么情况下我应该更喜欢 Lipo 而不是 Libtool？

# c++ - 如何在后台的 dll 中使用 muti boost 线程

> ID：15939883
> 
> 赞同：2
> 
> 时间：2013-04-11T02:49:02.943
> 
> 标签：c++, multithreading, visual-c++, boost, timer

后部分是我的程序，但它没有按我的预期工作。我希望 dll 中的主窗口程序调用函数“MyDllIniSys”，让 dll 渲染窗口每 32 微秒，直到主窗口程序设置“bIAutoRender”不等于 1。所以我希望函数“MyDllIniSys”启动线程，并立即返回。但是在我所做的事情中，程序将无法运行，因为如果线程启动，它将永远不会返回。我怎样才能得到它，有人请。帮助。非常感谢

```
static void renderOneFrame(const boost::system::error_code& /*e*/,
    boost::asio::deadline_timer* t, int* iNeedAutoRender)
{

    //call Who use this DLL, let it refresh the window
    if(OnRefreshEvent)
    {
        OnRefreshEvent();
    }

    if(*iNeedAutoRender == 1)
    {
        t->expires_at(t->expires_at() + boost::posix_time::microseconds(iIRenderMicroSenconds));
        t->async_wait(boost::bind(renderOneFrame,
                boost::asio::placeholders::error, t, iNeedAutoRender));
    }

}

EXTERN_C MYDLLAPI INT MyDllIniSys(INT  WindowWidth,INT  WindowHeight)
{
    COgreRenderLoader myLoader;
    myLoader.IniOgre(externalWindowHandle,WindowWidth,WindowHeight);

    boost::asio::io_service io;
    boost::asio::deadline_timer t(io, boost::posix_time::microseconds(iIRenderMicroSenconds));

    t.async_wait(boost::bind(renderOneFrame,
            boost::asio::placeholders::error, &t,&bIAutoRender));

    boost::thread thread1(boost::bind(&boost::asio::io_service::run, &io));
    //io.run();
    thread1.join();
    //thread1.start_thread();

    return 1;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-11T21:48:27.280

调用 thread1.join() 将阻塞，直到 thread1 完成执行。将其关闭，您的函数将启动线程并立即返回。

线程将继续，即使 thread1 对象超出范围，[正如您从这个问题中看到的那样](http://goo.gl/Q1C2a)。

# macos - 增加 rlimit Mac OSX 10.8

> ID：15939885
> 
> 赞同：7
> 
> 时间：2013-04-11T02:49:22.707
> 
> 标签：macos, mongodb, osx-mountain-lion

我正在学习 MongoDB，当我启动 mongo shell 时，出现了一条狂野的警告消息。它说： ![在此处输入图像描述](https://i.stack.imgur.com/7nEIP.png)

我如何更改“软限制”。我正在使用 Mac OSX 10.8.2

提前 Tnx

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T06:01:52.780

您正在搜索的是`launchctl limit maxfiles`.
例如，要更改它，您需要运行命令`launchctl limit maxfiles 1024 2048`。
要永久更改这些值，您需要创建 /etc/launchctl.conf 并在那里设置您需要的值（有关详细信息，请参见[此处](http://www.g9labs.com/2012/06/20/updating-max-file-limit-on-osx-lion/)）或将上述命令添加到您的 ~/.bash_profile。
或者您可以创建将设置限制的脚本，然后启动 mongo

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-15T17:51:41.377

如果您将 mongo 作为服务运行，则可以通过将下一行添加到

> /Library/LaunchDaemons/org.mongodb.mongod.plist

```
 <key>SoftResourceLimits</key>
  <dict>
    <key>NumberOfFiles</key>
    <integer>1024</integer>
  </dict> 
```

并重新启动服务

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-26T12:24:41.287

遇到过类似的问题，经过大量搜索，我发现[这个](https://gist.github.com/tamitutor/6a1e41eec0ce021a9718)答案很有用。

本要点解释了如何通过专用启动文件以及仅会话更改来解决此问题。

# java - 在 Jsp 中显示类中的对象列表

> ID：15939889
> 
> 赞同：1
> 
> 时间：2013-04-11T02:49:56.803
> 
> 标签：java, jsp, spring-mvc, jstl, sqlresultsetmapping

我正在使用 Spring MVC，并且我实现了**ResultSetExtractor**，因为我的一个类有一个复杂的列表对象。我做了映射，然后从数据库中进行选择。我在显示**ResultSetExtractor**中列表项的数据时遇到问题。我希望我正确地进行了映射。其他属性有数据。问题是在 jsp 中显示 Listvictims 和 Listcriminals 的值。

下面是代码：

**jsp**

我在crimeRecNo 和crimeDetails 中获取数据，但在受害者中没有。

**编辑：**

我更新了代码，但是我没有在受害者列表中获得任何值，jsp 上没有打印任何内容。其他元素正在获取数据。我不确定 ResultSetExtractor 是否为列表项正确编写。

```
<form:form id="crimeList" name ="crimeList">
    <div id ="content">
        <c:forEach items="${crimes}" var="crime">
            <div id="table">        

                <label>${crime.crimeRecNo}</label>
                <label>${crime.crimeDetails}</label>

                <c:forEach items="${crime.victims}" var="victim">
                    <label>${victim.fName}</label>     
                </c:forEach>

            </div>
        </c:forEach>
    </div>
</form:form> 
```

**ResultSetExtractor 映射**

如果我的映射不正确，请纠正我

```
private static final class CrimeMapper implements ResultSetExtractor<List<Crime>>{

    public List<Crime> extractData(ResultSet rs) throws SQLException, DataAccessException {

        Map<Integer, Crime> map = new HashMap<Integer, Crime>();
        Crime crime = null;

        while (rs.next()){

            int crimeRecNo = rs.getInt("crimeRecNo");
            crime = map.get(crimeRecNo);
            if (crime == null){
                crime = new Crime();
                crime.setCrimeRecNo(crimeRecNo);
                crime.setCrimeDate(rs.getString("crimeDate"));
                crime.setCrimeDetails(rs.getString("crimeDetails"));
                crime.setCrimeStreetLn1(rs.getString("crimeStreetLn1"));
                crime.setCrimeStreetLn2(rs.getString("crimeStreetLn2"));
                crime.setCrimeLatLocation(rs.getBigDecimal("crimeLatLocation"));
                crime.setCrimeLongLocation(rs.getBigDecimal("crimeLongLocation"));
                crime.setCrimeTime(rs.getString("crimeTime"));
                crime.setInvestigatingOfficerId(rs.getString("investigatingOfficerId"));
                crime.setCrimeLevelId(rs.getInt("crimeLevelId"));
                crime.setOffenceCatId(rs.getInt("offenceCatId"));
                crime.setOffenceTypeId(rs.getInt("offenceTypeId"));
                crime.setStatusId(rs.getInt("statusId"));
                crime.setRecordedById(rs.getString("recordedById"));
                crime.setVictims(new ArrayList<Citizens>());
                crime.setCriminals(new ArrayList<Citizens>());
                map.put(crimeRecNo, crime);
            }

            Integer socialSecurityNumber = rs.getInt("socialSecurityNumber");
            Integer citizenTypeId = rs.getInt("citizenTypeId");
            if(socialSecurityNumber > 0 & citizenTypeId == 3){
                Citizens victims = new Citizens();
                victims.setAddLn1(rs.getString("addLn1"));
                victims.setAddLn2(rs.getString("addLn2"));
                victims.setAddLn3(rs.getString("addLn3"));
                victims.setCitizenTypeId(rs.getInt("citizenTypeId"));
                victims.setCountryId(rs.getInt("countryId"));
                victims.setEthnicityId(rs.getInt("ethnicityId"));
                victims.setfName(rs.getString("fName"));
                victims.setGenderId(rs.getString("genderId"));
                victims.setHairColorId(rs.getString("hairColorId"));
                victims.setHeight(rs.getDouble("height"));
                victims.setlName(rs.getString("lName"));
                victims.setMaritalStatusId(rs.getInt("maritalStatusId"));
                victims.setNoticeableFeatures(rs.getString("noticableFeatures"));
                victims.setOccupationId(rs.getInt("occupationId"));
                victims.setoName(rs.getString("oName"));
                victims.setPhoneNo(rs.getString("phoneNo"));
                victims.setPhoto(rs.getString("photo"));
                victims.setSkinColorId(rs.getString("skinColorId"));
                victims.setSocialSecurityNumber(rs.getInt("socialSecurityNumber"));
                victims.setWeight(rs.getDouble("weight"));
                victims.setEyeColorId(rs.getString("eyeColorId"));
                victims.setDob(rs.getDate("dob"));
                victims.setName(rs.getString("fName") +" "+ rs.getString("lName"));

                crime.getVictims().add(victims);
            } else if(socialSecurityNumber > 0 & citizenTypeId == 2){
                Citizens criminal = new Citizens();
                criminal.setAddLn1(rs.getString("addLn1"));
                criminal.setAddLn2(rs.getString("addLn2"));
                criminal.setAddLn3(rs.getString("addLn3"));
                criminal.setCitizenTypeId(rs.getInt("citizenTypeId"));
                criminal.setCountryId(rs.getInt("countryId"));
                criminal.setEthnicityId(rs.getInt("ethnicityId"));
                criminal.setfName(rs.getString("fName"));
                criminal.setGenderId(rs.getString("genderId"));
                criminal.setHairColorId(rs.getString("hairColorId"));
                criminal.setHeight(rs.getDouble("height"));
                criminal.setlName(rs.getString("lName"));
                criminal.setMaritalStatusId(rs.getInt("maritalStatusId"));
                criminal.setNoticeableFeatures(rs.getString("noticableFeatures"));
                criminal.setOccupationId(rs.getInt("occupationId"));
                criminal.setoName(rs.getString("oName"));
                criminal.setPhoneNo(rs.getString("phoneNo"));
                criminal.setPhoto(rs.getString("photo"));
                criminal.setSkinColorId(rs.getString("skinColorId"));
                criminal.setSocialSecurityNumber(rs.getInt("socialSecurityNumber"));
                criminal.setWeight(rs.getDouble("weight"));
                criminal.setEyeColorId(rs.getString("eyeColorId"));
                criminal.setDob(rs.getDate("dob"));
                criminal.setName(rs.getString("fName") +" "+ rs.getString("lName"));
                crime.getCriminals().add(criminal);                 
            }               
        }           
        return new ArrayList<Crime>(map.values());
    }       
} 
```

**犯罪.java**

```
public class Crime implements Serializable{

    private int crimeRecNo;
    private String crimeDetails;
    private BigDecimal crimeLatLocation;
    private BigDecimal crimeLongLocation;
    private String crimeStreetLn1;
    private String crimeStreetLn2;
    private String crimeDate;
    private String crimeTime;
    private List<Citizens> victims;
    private List<Citizens> criminals;   
    private String recordedById;
    private int statusId;
    private int offenceCatId;
    private int offenceTypeId;
    private int crimeLevelId;
    private String investigatingOfficerId; 
```

…………

**公民.java**

```
public class Citizens implements Serializable{

    private int socialSecurityNumber;
    private String fName;
    private String lName;
    private String oName;
    private String photo;
    private int countryId;
    private String addLn1;
    private String addLn2;
    private String addLn3;
    private String genderId;
    private int ethnicityId;
    private String skinColorId;
    private String hairColorId;
    private int occupationId;
    private String phoneNo;
    private int maritalStatusId;
    private String noticeableFeatures;
    private double weight;
    private double height;
    private int citizenTypeId;
    private String eyeColorId;
    private Date dob;
    private String name; 
```

**错误**

```
org.apache.jasper.JasperException: An exception occurred processing JSP page /WEB-INF/jsp/crimeList.jsp at line 62

59:        <label>${crime.crimeRecNo}</label>
60:        <label>${crime.crimeDetails}</label>
61:        
62:        <c:forEach items="${crimes.getVictims}" var="victim">
63:        <label>${victim.getName}</label>
64:        
65:        </c:forEach>

Stacktrace:
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:568)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:470)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
    org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728)

root cause

java.lang.NumberFormatException: For input string: "getVictims"
    java.lang.NumberFormatException.forInputString(Unknown Source)
    java.lang.Integer.parseInt(Unknown Source)
    java.lang.Integer.parseInt(Unknown Source)
    javax.el.ListELResolver.coerce(ListELResolver.java:173)
    javax.el.ListELResolver.getValue(ListELResolver.java:52)
    org.apache.jasper.el.JasperELResolver.getValue(JasperELResolver.java:104)
    org.apache.el.parser.AstValue.getValue(AstValue.java:183)
    org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:185)
    org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:1026)
    org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspx_meth_c_005fforEach_005f1(crimeList_jsp.java:249)
    org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspx_meth_c_005fforEach_005f0(crimeList_jsp.java:216)
    org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspx_meth_form_005fform_005f0(crimeList_jsp.java:164)
    org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspService(crimeList_jsp.java:127)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
    org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:51:45.093

每个 JSP 文件在第一次访问或以后修改时都会被编译，每个 JSP 文件将类似于`crimeList_jsp.java`.

```
 org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspx_meth_c_005fforEach_005f1(crimeList_jsp.java:249)
    org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspx_meth_c_005fforEach_005f0(crimeList_jsp.java:216)
    org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspx_meth_form_005fform_005f0(crimeList_jsp.java:164)
    org.apache.jsp.WEB_002dINF.jsp.crimeList_jsp._jspService(crimeList_jsp.java:127) 
```

`crimeList.jsp`我建议您在 Apache Tomcat 中观察上述代码行。

示例路径如下所示：

> D:\apache-tomcat\work\Catalina\localhost\myAppName\org\apache\jsp\

这`myAppName`将是您的应用程序名称。

编辑：应该是这样的

```
<c:forEach items="${crimes.victims}" var="victim">
            <label>${victim.name}</label>       
</c:forEach> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:51:44.813

而不是`crimes.getVictims`，这应该被称为`crimes.victims`，EL 将负责插入 get 部分（现在它正在寻找`getGetVictims`）

# java - Eclipse ADT Android sqlite：应用程序打开后立即崩溃

> ID：15939891
> 
> 赞同：0
> 
> 时间：2013-04-11T02:49:58.707
> 
> 标签：java, android, database, sqlite

您好我正在编写一个用户能够查看的数据库，其中包含有关我正在填充数据库的数据的信息。在我的手机或模拟器上运行活动时，应用程序崩溃。没有 logcat 问题，所以我不确定可能是什么问题。如果有人可以为我提供任何提示，我将不胜感激，因为我是 Java 编程和使用 android ADT 的新手。以下是我为我的活动所拥有的所有代码。我正在使用的当前版本是 Build: v21.1.0-569685

创建数据库的主要活动：

```
package com.example.database;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class MainActivity 
{
    public static final String KEY_ROWID = "_id";
    public static final String KEY_BUSINESS = "business";
    public static final String KEY_ADDRESS = "address";
    public static final String KEY_PHONE = "phone";
    public static final String KEY_HOURS = "hours";
    public static final String KEY_WEB = "website";
    public static final String KEY_TYPE = "type";

    private static final String TAG = "MainActivity";

    private static final String DATABASE_NAME = "BloomBusiness";
    private static final String DATABASE_TABLE = "Business";
    private static final int DATABASE_VERSION = 1;

    private static final String DATABASE_CREATE =
        "create table Business (_id integer primary key autoincrement, "
        +"business text not null, address text not null, hours text not null"+"web text not null"+"type text not null" 
        + "phone text not null);";

    private final Context context; 

    private DatabaseHelper DBHelper;
    private SQLiteDatabase db;

    public MainActivity(Context ctx) 
    {
        this.context = ctx;
        DBHelper = new DatabaseHelper(context);
    }

    private static class DatabaseHelper extends SQLiteOpenHelper 
    {
        DatabaseHelper(Context context) 
        {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) 
        {
            db.execSQL(DATABASE_CREATE);
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, 
        int newVersion) 
        {
            Log.w(TAG, "Upgrading database from version " + oldVersion 
                    + " to "
                    + newVersion + ", which will destroy all old data");
            db.execSQL("DROP TABLE IF EXISTS Business");
            onCreate(db);
        }
    }    

    //---opens the database---
    public MainActivity open() throws SQLException 
    {
        db = DBHelper.getWritableDatabase();
        return this;
    }

    //---closes the database---    
    public void close() 
    {
        DBHelper.close();
    }

    //---insert a title into the database---
    public long insertTitle(String business, String address, String phone, String hours, String website, String type) 
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_BUSINESS, business);
        initialValues.put(KEY_ADDRESS, address);
        initialValues.put(KEY_PHONE, phone);
        initialValues.put(KEY_HOURS, hours);
        initialValues.put(KEY_WEB, website);
        initialValues.put(KEY_TYPE, type);

        return db.insert(DATABASE_TABLE, null, initialValues);
    }

    //---deletes a particular title---
    public boolean deleteTitle(long rowId) 
    {
        return db.delete(DATABASE_TABLE, KEY_ROWID + 
                "=" + rowId, null) > 0;
    }

    //---retrieves all the titles---
    public Cursor getAllTitles() 
    {
        return db.query(DATABASE_TABLE, new String[] {
                KEY_ROWID, 
                KEY_BUSINESS,
                KEY_ADDRESS,
                KEY_PHONE,
                KEY_HOURS,
                KEY_WEB,
                KEY_TYPE}, 
                null, 
                null, 
                null, 
                null, 
                null);
    }

    //---retrieves a particular title---
    public Cursor getTitle(long rowId) throws SQLException 
    {
        Cursor mCursor =
                db.query(DATABASE_TABLE, new String[] {
                        KEY_ROWID,
                        KEY_BUSINESS, 
                        KEY_ADDRESS,
                        KEY_PHONE,
                        KEY_HOURS,
                        KEY_WEB,
                        KEY_TYPE}, 
                        KEY_ROWID + "=" + rowId, 
                        null,
                        null, 
                        null, 
                        null, 
                        null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    //---updates a title---
    public boolean updateTitle(long rowId, String business, 
    String address, String phone, String hours, String website,String type) 
    {
        ContentValues args = new ContentValues();
        args.put(KEY_BUSINESS, business);
        args.put(KEY_ADDRESS, address);
        args.put(KEY_PHONE, phone);
        args.put(KEY_HOURS,hours);
        args.put(KEY_WEB, website);
        args.put(KEY_TYPE, type);
        return db.update(DATABASE_TABLE, args, 
                         KEY_ROWID + "=" + rowId, null) > 0;
    }
} 
```

返回所有企业名称的列表：

```
package com.example.database;

import android.app.Activity;
import android.database.Cursor;
import android.os.Bundle;
import android.widget.Toast;

public class DBUse extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        MainActivity db = new MainActivity(this);

        db.open();
        Cursor c = db.getAllTitles();
        if(c.moveToFirst())
        {
            do{DisplayTitle(c);
        }while (c.moveToNext());
    }   
        db.open();
        Cursor b = db.getTitle(1);

        if (b.moveToFirst())
            DisplayTitle(c);
        else
            Toast.makeText(this,"No business found",Toast.LENGTH_LONG).show();
        db.close();
    db.close();

}

    public void DisplayTitle(Cursor c) {
        Toast.makeText(this,
        "Name: " + c.getString(1)+"\n"+
        "Address:" + c.getString(2)+"\n"+
        "Phone:" + c.getString(3)+"\n"+
        "Hours:" + c.getString(4)+"\n",
        Toast.LENGTH_LONG).show();
    }

    } 
```

将数据输入数据库：

```
package com.example.database;

import android.app.Activity;
import android.database.Cursor;
import android.os.Bundle;
import android.widget.Toast;

public class DBUse extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        MainActivity db = new MainActivity(this);

        db.open();
        Cursor c = db.getAllTitles();
        if(c.moveToFirst())
        {
            do{DisplayTitle(c);
        }while (c.moveToNext());
    }   
        db.open();
        Cursor b = db.getTitle(1);

        if (b.moveToFirst())
            DisplayTitle(c);
        else
            Toast.makeText(this,"No business found",Toast.LENGTH_LONG).show();
        db.close();
    db.close();

}

    public void DisplayTitle(Cursor c) {
        Toast.makeText(this,
        "Name: " + c.getString(1)+"\n"+
        "Address:" + c.getString(2)+"\n"+
        "Phone:" + c.getString(3)+"\n"+
        "Hours:" + c.getString(4)+"\n",
        Toast.LENGTH_LONG).show();
    }

    } 
```

最后是清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.database"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" 
        android:debuggable="true">
        <activity
            android:name="com.example.database.DBUse"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

更改清单后，我在控制台中收到此错误，但 logcat 中没有显示任何内容。

```
[2013-04-10 23:46:43 - database] Performing com.example.database.MainActivity activity launch
[2013-04-10 23:46:47 - database] Application already deployed. No need to reinstall.
[2013-04-10 23:46:47 - database] Starting activity com.example.database.MainActivity on device 0A3BB5F106008016
[2013-04-10 23:46:48 - database] New package not yet registered with the system. Waiting 3 seconds before next attempt.
[2013-04-10 23:46:51 - database] Starting activity com.example.database.MainActivity on device 0A3BB5F106008016
[2013-04-10 23:46:51 - database] New package not yet registered with the system. Waiting 3 seconds before next attempt.
[2013-04-10 23:46:54 - database] Starting activity com.example.database.MainActivity on device 0A3BB5F106008016
[2013-04-10 23:46:54 - database] New package not yet registered with the system. Waiting 3 seconds before next attempt.
[2013-04-10 23:46:57 - database] Starting activity com.example.database.MainActivity on device 0A3BB5F106008016
[2013-04-10 23:46:58 - database] New package not yet registered with the system. Waiting 3 seconds before next attempt.
[2013-04-10 23:47:01 - database] Starting activity com.example.database.MainActivity on device 0A3BB5F106008016
[2013-04-10 23:47:01 - database] ActivityManager: Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.database/.MainActivity }
[2013-04-10 23:47:01 - database] ActivityManager: Error type 3
[2013-04-10 23:47:01 - database] ActivityManager: Error: Activity class {com.example.database/com.example.database.MainActivity} does not exist. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T02:54:32.123

应该将您的清单更改为

```
<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" 
    android:debuggable="true">
    <activity
        android:name="com.example.database.DBUse"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

MainActivity 没有扩展 Activity，应该叫它 DbAdapter。

# fullcalendar - FullCalendar 跳回当前日期而不是停留在当前月份

> ID：15939893
> 
> 赞同：1
> 
> 时间：2013-04-11T02:50:09.253
> 
> 标签：fullcalendar, getdate

我安装了 FullCalendar 并且运行良好，从我的数据库中提取课程。

您可以通过单击再次提交页面但通过不同标准的按钮查看不同的课程。

问题是，在重新加载页面和新内容时，它会跳回当前日期，当您在未来 3 个月查看课程时，这相当烦人！

有人知道刷新页面后如何让日历回到你所在的页面吗？？？

我觉得这可能与 getdate 有关，因为我得到了以下代码，但似乎无法通过 URL 将结果传递回日历设置。

```
$('#my-button').click(function() {
    var d = $('#calendar').fullCalendar('getDate');
    alert("The current date of the calendar is " + d);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-06-02T01:10:42.973

如果您使用[jquery.cookie](https://github.com/js-cookie/js-cookie)，您可以将当前查看的日期存储在正在查看的页面的 cookie 中，并在页面重新加载时使用该值设置 defaultDate。初始化日历时将这些作为选项传递：

```
defaultView: Cookies.get('fullCalendarCurrentView') || 'month',
defaultDate: Cookies.get('fullCalendarCurrentDate') || null,
viewRender: function(view) {
  Cookies.set('fullCalendarCurrentView', view.name, {path: ''});
  Cookies.set('fullCalendarCurrentDate', view.intervalStart.format(), {path: ''});
} 
```

此代码还保存当前视图（例如月、日等...）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-26T22:14:39.030

我使用了上述两者的组合。在创建、移动或调整事件大小以及 viewRender 时，我为开始日期设置了 localStorage 值，然后将该值分配给 defaultDate。

```
defaultDate: localStorage.getItem('Default_FullCalendar_Date'),    
viewRender: function(view) {
        localStorage.setItem('Default_FullCalendar_View', view.name);
        ...
    },

    select: function(start, due){
        localStorage.setItem('Default_FullCalendar_View', start);
        ...
    },

    eventDrop: function(event, delta, revertFunc, jsEvent, ui, view){
        localStorage.setItem('Default_FullCalendar_View', event._start._d);
        ...
    },

    eventResize: function(event, delta, revertFunc, jsEvent, ui, view){
        localStorage.setItem('Default_FullCalendar_View', event._start._d);
        ...
    } 
```

奇迹般有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T07:24:39.213

您可以使用[gotoDate](http://arshaw.com/fullcalendar/docs/current_date/gotoDate/)方法：

```
var d = $('#calendar').fullCalendar('getDate');
$('#calencar').fullCalendar( 'gotoDate', d.getFullYear(), d.getMonth(), d.getDate() ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-29T17:45:41.340

这是完整日历版本 4 和 5 的更新答案。因为`viewRender`在这些版本中不再是一个选项。我想出了一种使用该`loading`选项的不同方法。

该`loading`选项将为您提供一个`boolean`参数，说明日历是否已完成加载。在该函数中，我检查日历是否已完成加载，如果是，我将日历日期设置为`localStorage`. 接下来，我在 fullcalendar 对象之前创建了一个 if else 语句来检查 localstorage 项目是否存在，如果存在，我将`defaultDate`calendar 对象中的选项设置为 to `localStorage`date；如果没有，我只是将其设置为今天的日期。

例子：

```
let viewDate;
const savedDate = localStorage.getItem("calDate");
if (savedDate !== null) {
  viewDate = new Date(savedDate);
} else {
  viewDate = today();
}

const calendarElement = document.getElementById('your_calendar');

const calendar = new FullCalendar.Calendar(calendarElement, {
  defaultDate: viewDate,
  loading: function(stillLoading) {
    if (stillLoading === false) {
      // When Calendar is done loading....
      localStorage.setItem("calDate", calendar.getDate());
    }
  },
}); 
```

# html - css 内联块与表格单元

> ID：15939896
> 
> 赞同：23
> 
> 时间：2013-04-11T02:50:30.130
> 
> 标签：html, css

inline-block 和 table-cell 有什么区别？

我发现这两种风格是一样的。无论你喜欢什么风格，例如。`text-align: center; vertical-align: middle;`等通过识别`display: inline-block;`或`display: table-cell;`将工作相同。

请告知主要差异。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-11T03:29:05.997

`display: table-cell`并且`display: inline-block;`混淆相同，但它们之间存在巨大差异。当您的浏览器将被重新调整大小或您的内容超过其宽度时，将不会`display: inline-block;`像ie inline-block 那样表现为块级别，而不会。 `display: table-cell;``display: table-cell;`

**[你可以在这里](http://jsfiddle.net/g5bE8/)**看到它们之间的区别

当您应用`display: inline-block;`Re-size your window by press Ctrl 键并使用鼠标滚动按钮滚动以查看差异时，您还会发现块之间的间隙。

请注意不像在 中`vertical-align: middle;`那样工作。如果您有工作演示，请分享一个。`display: table-cell;``display: inline-block;`

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-11T02:52:12.940

`display:table-cell`用于在 a 内部使用`display:table-row`，本身在 a 内部使用`display:table`。使用不当将导致创建匿名元素，这可能会对布局的其他方面产生负面影响。

话虽如此，`vertical-align`两者的含义却截然不同。在`display:inline-block`中，它指的是元素本身如何与周围元素对齐。另一方面，使用`display:table-cell`, 会影响其中元素的垂直对齐方式。

# sql - 函数中的 SELECT 或 INSERT 是否容易出现竞争条件？

> ID：15939902
> 
> 赞同：31
> 
> 时间：2013-04-11T02:51:23.517
> 
> 标签：sql, postgresql, concurrency, plpgsql, upsert

我写了一个函数来为一个简单的博客引擎创建帖子：

```
CREATE FUNCTION CreatePost(VARCHAR, TEXT, VARCHAR[])
RETURNS INTEGER AS $$
    DECLARE
        InsertedPostId INTEGER;
        TagName VARCHAR;
    BEGIN
        INSERT INTO Posts (Title, Body)
        VALUES ($1, $2)
        RETURNING Id INTO InsertedPostId;

        FOREACH TagName IN ARRAY $3 LOOP
            DECLARE
                InsertedTagId INTEGER;
            BEGIN
                -- I am concerned about this part.
                BEGIN
                    INSERT INTO Tags (Name)
                    VALUES (TagName)
                    RETURNING Id INTO InsertedTagId;
                EXCEPTION WHEN UNIQUE_VIOLATION THEN
                    SELECT INTO InsertedTagId Id
                    FROM Tags
                    WHERE Name = TagName
                    FETCH FIRST ROW ONLY;
                END;

                INSERT INTO Taggings (PostId, TagId)
                VALUES (InsertedPostId, InsertedTagId);
            END;
        END LOOP;

        RETURN InsertedPostId;
    END;
$$ LANGUAGE 'plpgsql'; 
```

当多个用户同时删除标签并创建帖子时，这是否容易出现竞争条件？
具体来说，事务（以及函数）是否会阻止此类竞争条件的发生？
我正在使用 PostgreSQL 9.2.3。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-04-11T13:39:43.227

***`SELECT`这是可能的并发写入负载或`INSERT`***在可能的并发写入负载下反复出现的问题，与（但不同于）`UPSERT`（即*`INSERT`或`UPDATE`*）有关。

此 PL/pgSQL 函数使用[UPSERT`INSERT ... ON CONFLICT .. DO UPDATE`](https://www.postgresql.org/docs/current/static/sql-insert.html#SQL-ON-CONFLICT)`INSERT` ( [)](https://www.postgresql.org/docs/current/static/sql-insert.html#SQL-ON-CONFLICT)或***单行***：`SELECT`

 **```
CREATE OR REPLACE FUNCTION f_tag_id(_tag text, OUT _tag_id int)
  LANGUAGE plpgsql AS
$func$
BEGIN
   SELECT tag_id  -- only if row existed before
   FROM   tag
   WHERE  tag = _tag
   INTO   _tag_id;

   IF NOT FOUND THEN
      INSERT INTO tag AS t (tag)
      VALUES (_tag)
      ON     CONFLICT (tag) DO NOTHING
      RETURNING t.tag_id
      INTO   _tag_id;
   END IF;
END
$func$; 
```

竞争条件仍然有一个很小的窗口。为了***确保***我们得到一个 ID：

```
CREATE OR REPLACE FUNCTION f_tag_id(_tag text, OUT _tag_id int)
  LANGUAGE plpgsql AS
$func$
BEGIN
   LOOP
      SELECT tag_id
      FROM   tag
      WHERE  tag = _tag
      INTO   _tag_id;

      EXIT WHEN FOUND;

      INSERT INTO tag AS t (tag)
      VALUES (_tag)
      ON     CONFLICT (tag) DO NOTHING
      RETURNING t.tag_id
      INTO   _tag_id;

      EXIT WHEN FOUND;
   END LOOP;
END
$func$; 
```

*db<>[在这里摆弄](https://dbfiddle.uk/?rdbms=postgres_13&fiddle=786495606ce79c7ce7bcb1510f0df6f3)*

这会一直循环，直到其中一个`INSERT`或`SELECT`成功。称呼：

```
SELECT f_tag_id('possibly_new_tag'); 
```

*如果同一事务中的*后续命令依赖于该行的存在，并且实际上有可能其他事务同时更新或删除它，您可以使用 锁定`SELECT`语句中的现有行[`FOR SHARE`](https://www.postgresql.org/docs/current/sql-select.html#SQL-FOR-UPDATE-SHARE)。
如果该行被插入，它将被锁定（或对其他事务不可见），直到事务结束。

从常见情况（`INSERT`vs `SELECT`）开始，以使其更快。

有关的：

*   [从条件 INSERT 中获取 Id](https://stackoverflow.com/questions/36083669/get-id-from-a-conditional-insert/36090746#36090746)
*   [如何在 RETURNING from INSERT 中包含排除的行... ON CONFLICT](https://stackoverflow.com/questions/35949877/how-do-i-insert-into-this-postgressql-with-on-conflict/35953488#35953488)

`INSERT`一次或多`SELECT` ***行***（一组）的相关（纯SQL）解决方案：

*   [如何在 PostgreSQL 中使用 RETURNING 和 ON CONFLICT？](https://stackoverflow.com/questions/34708509/how-to-use-returning-with-on-conflict-in-postgresql/42217872#42217872)

### *这个*纯 SQL 解决方案有什么问题？

```
CREATE OR REPLACE FUNCTION f_tag_id(_tag text, OUT _tag_id int)
  LANGUAGE sql AS
$func$
WITH ins AS (
   INSERT INTO tag AS t (tag)
   VALUES (_tag)
   ON     CONFLICT (tag) DO NOTHING
   RETURNING t.tag_id
   )
SELECT tag_id FROM ins
UNION  ALL
SELECT tag_id FROM tag WHERE tag = _tag
LIMIT  1;
$func$; 
```

并非完全错误，但它未能像[@FunctorSalad 解决](https://stackoverflow.com/a/47402034/939860)的那样堵住漏洞。如果并发事务尝试同时执行相同操作，该函数可能会得出一个空结果。[手册：](https://www.postgresql.org/docs/current/queries-with.html)

> 所有语句都使用相同的快照执行

如果并发事务稍早插入了相同的新标签，但尚未提交：

*   在等待并发事务完成后，UPSERT 部分变为空。（如果并发事务应该回滚，它仍然会插入新标签并返回一个新 ID。）

*   SELECT 部分也是空的，因为它基于相同的快照，其中来自（尚未提交的）并发事务的新标记不可见。

我们*一无所获*。不像预期的那样。这对幼稚的逻辑是违反直觉的（我被抓住了），但这就是 Postgres 的 MVCC 模型的工作原理——必须工作。

因此，如果多个事务可以尝试同时插入同一个标签，请不要使用此选项。**或者**循环直到你真正得到一行。无论如何，循环几乎不会在常见的工作负载中触发。

## Postgres 9.4 或更高版本

鉴于此（略微简化）表：

```
CREATE table tag (
  tag_id serial PRIMARY KEY
, tag    text   UNIQUE
); 
```

插入新标签/选择现有标签的**几乎 100% 安全**功能可能如下所示。

```
CREATE OR REPLACE FUNCTION f_tag_id(_tag text, OUT tag_id int)
  LANGUAGE plpgsql AS
$func$
BEGIN
   LOOP
      BEGIN
      WITH sel AS (SELECT t.tag_id FROM tag t WHERE t.tag = _tag FOR SHARE)
         , ins AS (INSERT INTO tag(tag)
                   SELECT _tag
                   WHERE  NOT EXISTS (SELECT 1 FROM sel)  -- only if not found
                   RETURNING tag.tag_id)       -- qualified so no conflict with param
      SELECT sel.tag_id FROM sel
      UNION  ALL
      SELECT ins.tag_id FROM ins
      INTO   tag_id;

      EXCEPTION WHEN UNIQUE_VIOLATION THEN     -- insert in concurrent session?
         RAISE NOTICE 'It actually happened!'; -- hardly ever happens
      END;

      EXIT WHEN tag_id IS NOT NULL;            -- else keep looping
   END LOOP;
END
$func$; 
```

*db<>fiddle [here](https://dbfiddle.uk/?rdbms=postgres_13&fiddle=b0a69f7a6d44448a7fea1cf8d20404fc)*
[旧[sqlfiddle](http://sqlfiddle.com/#!17/9979e6/1)]

为什么不是100%？`UPSERT`考虑相关示例的手册中的注释：

*   [https://www.postgresql.org/docs/current/plpgsql-control-structures.html#PLPGSQL-UPSERT-EXAMPLE](https://www.postgresql.org/docs/current/plpgsql-control-structures.html#PLPGSQL-UPSERT-EXAMPLE)

### 解释

*   尝试第`SELECT` *一个*。通过这种方式，您可以在 99.99% 的时间内避免*成本更高的*异常处理。

*   使用[CTE](https://www.postgresql.org/docs/current/queries-with.html)最小化竞争条件的（已经很小的）时间段。

*   `SELECT`一次查询和`INSERT` *一次查询*之间的时间窗口非常小。如果您没有繁重的并发负载，或者您可以每年忍受一次异常，您可以忽略这种情况并使用 SQL 语句，这样会更快。

*   不需要`FETCH FIRST ROW ONLY`（= `LIMIT 1`）。标签名称显然是`UNIQUE`.

*   [**`FOR SHARE`**](https://www.postgresql.org/docs/current/sql-select.html#SQL-FOR-UPDATE-SHARE)如果您通常没有 concurrent`DELETE`或`UPDATE`on the table ，请在我的示例中删除`tag`。花费一点点性能。

*   永远不要引用语言名称：~~'plpgsql'~~。`plpgsql`是一个*标识符*。[引用可能会导致问题](https://stackoverflow.com/a/12530268/939860)，并且只允许向后兼容。

*   不要使用非描述性的列名，如`id`or `name`。当连接几个表时（*这是您*在关系数据库中所做的），您最终会得到多个相同的名称并且必须使用别名。

### 内置到您的函数中

使用此功能，您可以在很大程度上简化您`FOREACH LOOP`：

```
...
FOREACH TagName IN ARRAY $3
LOOP
   INSERT INTO taggings (PostId, TagId)
   VALUES   (InsertedPostId, f_tag_id(TagName));
END LOOP;
... 
```

但是，作为单个 SQL 语句，速度更快[`unnest()`](https://www.postgresql.org/docs/current/functions-array.html#ARRAY-FUNCTIONS-TABLE)：

```
INSERT INTO taggings (PostId, TagId)
SELECT InsertedPostId, f_tag_id(tag)
FROM   unnest($3) tag; 
```

替换整个循环。

## 替代解决方案

这个变体建立在`UNION ALL`with`LIMIT`子句的行为之上：只要找到足够多的行，其余的就永远不会执行：

*   [尝试多个 SELECT 直到结果可用的方法？](https://stackoverflow.com/questions/14339715/way-to-try-multiple-selects-till-a-result-is-available/14365613#14365613)

在此基础上，我们可以将其外包`INSERT`到一个单独的功能中。只有在那里我们需要异常处理。与第一个解决方案一样安全。

```
CREATE OR REPLACE FUNCTION f_insert_tag(_tag text, OUT tag_id int)
  RETURNS int
  LANGUAGE plpgsql AS
$func$
BEGIN
   INSERT INTO tag(tag) VALUES (_tag) RETURNING tag.tag_id INTO tag_id;

   EXCEPTION WHEN UNIQUE_VIOLATION THEN  -- catch exception, NULL is returned
END
$func$; 
```

在主要功能中使用：

```
CREATE OR REPLACE FUNCTION f_tag_id(_tag text, OUT _tag_id int)
   LANGUAGE plpgsql AS
$func$
BEGIN
   LOOP
      SELECT tag_id FROM tag WHERE tag = _tag
      UNION  ALL
      SELECT f_insert_tag(_tag)  -- only executed if tag not found
      LIMIT  1  -- not strictly necessary, just to be clear
      INTO   _tag_id;

      EXIT WHEN _tag_id IS NOT NULL;  -- else keep looping
   END LOOP;
END
$func$; 
```

*   如果大多数调用只需要 ，这会便宜一些，因为很少输入包含该子句`SELECT`的更昂贵的块。查询也更简单。`INSERT``EXCEPTION`

*   `FOR SHARE`在这里是不可能的（不允许在`UNION`查询中）。

*   `LIMIT 1`没有必要（在第 9.4 页测试）。Postgres 派生`LIMIT 1`自`INTO _tag_id`并且仅在找到第一行之前执行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-11-20T22:16:16.440

即使使用`ON CONFLICT`Postgres 9.5 中引入的子句，仍然需要注意一些事情。使用与@Erwin Brandstetter 的答案相同的函数和示例表，如果我们这样做：

```
Session 1: begin;

Session 2: begin;

Session 1: select f_tag_id('a');
 f_tag_id 
----------
       11
(1 row)

Session 2: select f_tag_id('a');
[Session 2 blocks]

Session 1: commit;

[Session 2 returns:]
 f_tag_id 
----------
        NULL
(1 row) 
```

所以在会话 2 中`f_tag_id`返回`NULL`，这在单线程世界中是不可能的！

如果我们将事务隔离级别提高到`repeatable read`（或更高`serializable`），会话 2 会`ERROR: could not serialize access due to concurrent update`改为抛出。所以至少没有“不可能”的结果，但不幸的是，我们现在需要准备重试事务。

编辑：使用`repeatable read`or `serializable`，如果会话 1 插入 tag `a`，则会话 2 插入`b`，然后会话 1 尝试插入`b`，会话 2 尝试插入`a`，一个会话检测到死锁：

```
ERROR:  deadlock detected
DETAIL:  Process 14377 waits for ShareLock on transaction 1795501; blocked by process 14363.
Process 14363 waits for ShareLock on transaction 1795503; blocked by process 14377.
HINT:  See server log for query details.
CONTEXT:  while inserting index tuple (0,3) in relation "tag"
SQL function "f_tag_id" statement 1 
```

收到死锁错误的会话回滚后，另一个会话继续。所以我想我们应该像对待死锁一样对待并重`serialization_failure`试，在这种情况下？

或者，以一致的顺序插入标签，但如果它们没有全部添加到一个地方，这并不容易。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-11T04:53:34.983

我认为当标签已经存在时，它可能会在您的交易找到它后被另一笔交易删除。使用 SELECT FOR UPDATE 应该可以解决这个问题。**

# java - 在java中创建一个保存/另存为对话框，用于保存新创建的文件或编辑的文件

> ID：15939903
> 
> 赞同：2
> 
> 时间：2013-04-11T02:51:28.910
> 
> 标签：java, swing, jfilechooser, dialog

Java初学者：请帮助我这几天一直在努力，我的大脑已经死了。我创建了一个 java 程序（在 eclipse 中），它有 3 个菜单：文件、编辑、帮助，一旦单击文件，它就会显示 4menuBar：'new、open、save、save as & exit。

在帮助菜单上有一个菜单栏，上面写着“关于 javaEdit” 我的所有菜单栏都可以工作，除了保存、另存为和“关于 javaEdit” 我需要一些代码或一个清晰的分步说明，以便虚拟人了解如何保存和另存为工作。

保存应该保存新创建的文件或编辑过的文件，最后我可能会喜欢“关于 JavaEdit”，以便在单击后显示“谢谢，这是 java”之类的消息。我可能喜欢类似的东西

```
private void doSave(){code here} 
```

和

```
private void doSaveAs (){ 
```

因为我在 if else if 语句中有这些项目。

java - 如何在java中创建保存新创建文件或编辑文件的保存/另存为对话框？

以下是我的完整代码：

```
import java.awt.*;
import java.awt.event
import java.io.*;

public class JavaEdit extends Frame implements ActionListener {

    String clipBoard;
    String fileName;
    TextArea text;
    MenuItem newMI, openMI, saveMI, saveAsMI, exitMI;
    MenuItem selectAllMI, cutMI, copyMI, deleteMI, pasteMI;
    MenuItem aboutJavaEditMI;

    /**
     * Constructor
     */
    public JavaEdit() {
        super("JavaEdit");          // set frame title
        setLayout(new BorderLayout());  // set layout

    // create menu bar
        MenuBar menubar = new MenuBar();
        setMenuBar(menubar);

    // create file menu
        Menu fileMenu = new Menu("File");
        menubar.add(fileMenu);
        newMI = fileMenu.add(new MenuItem("New"));
        newMI.addActionListener(this);
        openMI = fileMenu.add(new MenuItem("Open"));
        openMI.addActionListener(this);
        fileMenu.addSeparator();
        saveMI = fileMenu.add(new MenuItem("Save"));
        saveAsMI = fileMenu.add(new MenuItem("Save As ..."));
        fileMenu.addSeparator();
        exitMI = fileMenu.add(new MenuItem("Exit"));
        exitMI.addActionListener(this);

    // create edit menu
        Menu editMenu = new Menu("Edit");
        menubar.add(editMenu);
        selectAllMI = editMenu.add(new MenuItem("Select all"));
        selectAllMI.addActionListener(this);

        cutMI = editMenu.add(new MenuItem("Cut"));
        cutMI.addActionListener(this);

        copyMI = editMenu.add(new MenuItem("Copy"));
        copyMI.addActionListener(this);

        pasteMI = editMenu.add(new MenuItem("Paste"));
        pasteMI.addActionListener(this);

        deleteMI = editMenu.add(new MenuItem("Delete"));
        deleteMI.addActionListener(this);

    // create help menu
        Menu helpMenu = new Menu("Help");
        menubar.add(helpMenu);
        aboutJavaEditMI = helpMenu.add(new MenuItem("About JavaEdit"));
        aboutJavaEditMI.addActionListener(this);

        // create text editing area
        text = new TextArea();
        add(text, BorderLayout.CENTER);
    }

    // implementing ActionListener
    public void actionPerformed(ActionEvent event) {
        Object source = event.getSource();
        if(source == newMI) {
            clearText();
            fileName = null;
            setTitle("JavaEdit");   // reset frame title
        }
        else if(source == openMI) {
            doOpen();
        }
    else if(source == saveMI) {
            doSave();
    }
    else if(source == saveAsMI){
    doSaveAs();
    }
        else if(source == exitMI) {
            System.exit(0);
        }
        else if(source == cutMI) {
            doCopy();
            doDelete();
        }
        else if(source == copyMI) {
            doCopy();
        }
        else if(source == pasteMI) {
            doPaste();
        }
        else if(source == deleteMI) {
            doDelete();
        }
    }

    /**
     * method to specify and open a file
     */
    private void doOpen() {
        // display file selection dialog
        FileDialog fDialog = new FileDialog(this, "Open ...", FileDialog.LOAD);
        fDialog.setVisible(true);
        // Get the file name chosen by the user
        String name = fDialog.getFile();

    // If user canceled file selection, return without doing anything.
        if(name == null)
            return;
        fileName = fDialog.getDirectory() + name;

    // Try to create a file reader from the chosen file.
        FileReader reader=null;
        try {
            reader = new FileReader(fileName);
        } catch (FileNotFoundException ex) {
            MessageDialog dialog = new MessageDialog(this, "Error Message",
                                                     "File Not Found: "+fileName);
                dialog.setVisible(true);
                return;
        }

        BufferedReader bReader = new BufferedReader(reader);

    // Try to read from the file one line at a time.
        StringBuffer textBuffer = new StringBuffer();
        try {
            String textLine = bReader.readLine();
            while (textLine != null) {
                textBuffer.append(textLine + '\n');
                textLine = bReader.readLine();
        }
            bReader.close();
            reader.close();
        } catch (IOException ioe) {
            MessageDialog dialog = new MessageDialog(this, "Error Message",
                                       "Error reading file: "+ioe.toString());
            dialog.setVisible(true);
            return;
        }
        setTitle("JavaEdit: " +name);   // reset frame title
        text.setText(textBuffer.toString());
    }   

    /**
     * method to clear text editing area
     */
    private void clearText() {
        text.setText("");
    }

    /**
     * method to copy selected text to the clipBoard
     */
    private void doCopy() {
        clipBoard = new String(text.getSelectedText());
    }

    /**
     * method to delete selected text
     */
    private void doDelete() {
        text.replaceRange("", text.getSelectionStart(), text.getSelectionEnd());
    }

    /**
     * method to replace current selection with the contents of the clipBoard
     */
    private void doPaste() {
        if(clipBoard != null) {
            text.replaceRange(clipBoard, text.getSelectionStart(),
                              text.getSelectionEnd());
        }
    }

    /**
     * class for message dialog
     */
    class MessageDialog extends Dialog implements ActionListener {
        private Label message;
        private Button okButton;

     // Constructor
        public MessageDialog(Frame parent, String title, String messageString) {
            super(parent, title, true);
            setSize(400, 100);
            setLocation(150, 150);
            setLayout(new BorderLayout());

            message = new Label(messageString, Label.CENTER);
            add(message, BorderLayout.CENTER);

            Panel panel = new Panel(new FlowLayout(FlowLayout.CENTER));
            add(panel, BorderLayout.SOUTH);
            okButton = new Button(" OK ");
            okButton.addActionListener(this);
            panel.add(okButton);
        }

    // implementing ActionListener
        public void actionPerformed(ActionEvent event) {
            setVisible(false);
            dispose();
        }
    }

    /**
     * the main method
     */
    public static void main(String[] argv) {
        // create frame
        JavaEdit frame = new JavaEdit();
        Dimension size = Toolkit.getDefaultToolkit().getScreenSize();
        frame.setSize(size.width-80, size.height-80);
        frame.setLocation(20, 20);

        // add window closing listener

        frame.addWindowListener(new WindowAdapter() {
            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });

     // show the frame
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T06:27:01.647

即使是 AWT 程序也可以[`Action`](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)用来封装功能并防止（而不是抑制）[*在构造函数中泄漏 this*](https://stackoverflow.com/q/3921616/230513)。例如，

```
private static JavaEdit frame;
...
public JavaEdit() {
    ...
    saveMI = fileMenu.add(new MenuItem("Save"));
    saveMI.addActionListener(new SaveAction());
    ...
}

private static class SaveAction extends AbstractAction {

    @Override
    public void actionPerformed(ActionEvent e) {
        FileDialog fDialog = new FileDialog(frame, "Save", FileDialog.SAVE);
        fDialog.setVisible(true);
        String path = fDialog.getDirectory() + fDialog.getFile();
        File f = new File(path);
        // f.createNewFile(); etc.
    }

public static void main(String[] argv) {
    // create frame
    frame = new JavaEdit();
    ...
    // show the frame
    frame.pack();
    frame.setVisible(true);
} 
```

参见，[在此处](https://stackoverflow.com/a/10160836/230513)`HTMLDocumentEditor`引用，例如相关操作的实现。

# asp.net - 下拉列表的选定索引值

> ID：15939904
> 
> 赞同：2
> 
> 时间：2013-04-11T02:51:38.273
> 
> 标签：asp.net

我在 webpart 中有一个非常简单的下拉列表，如下所示。当我运行这个 webpart 时，下拉列表总是选择一个，但我在想 -1 使它不选择任何值。我在这里做错了什么。

```
DropDownList list = new DropDownList();
list.Items.Add("One");
list.Items.Add("Two");
list.Items.Add("Three");
list.SelectedIndex = -1;
this.Controls.Add(list); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T02:58:28.040

添加一个类似“-- SELECT--”的项目并将其选为默认值

```
DropDownList list = new DropDownList();
list.Items.Add("-- SELECT --");
list.Items.Add("One");
list.Items.Add("Two");
list.Items.Add("Three");
list.SelectedIndex = 0;
this.Controls.Add(list); 
```

还要查看 DropDownList.ClearSelection() 方法。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T03:33:53.423

试试这个，但 ddl 控件的行为似乎很奇怪，下拉列表总是选择 0 位置的项目。

```
 DropDownList list = new DropDownList();
        list.Items.Add("");
        list.Items.Add("One");
        list.Items.Add("Two");
        list.Items.Add("Three");
        this.form1.Controls.Add(list);
        list.SelectedIndex = 0; 
```

# sass - Bundler configuration to compile sass files

> ID：15939908
> 
> 赞同：0
> 
> 时间：2013-04-11T02:52:12.487
> 
> 标签：sass, compass-sass

I am getting an error with compass watching my directory correctly but fails to generate my output. I am thinking it has to do with either my `GEMFILE` or `compass.rb` config file.

```
 ERROR: Guard::Compass failed to achieve its <run_on_change>, exception was:
Compass::Error: Nothing to compile. If you're trying to start a new project, you have left off the directory argument. 
```

Guardfile

```
# More info at 
# https://github.com/guard/guard#readme
# https://github.com/guard/guard/wiki/Guardfile-examples

# Launch Guard like this: [bundle exec] guard -g ui

group :ui do

#  guard :bundler, 
#    :hide_success => true do
#    watch('Gemfile')
#  end

  guard 'compass',
    :output => 'client/css',
    :workdir => 'source/sass',
    :configuration_file => 'config/compass.rb',
    :hide_success => true do
    #watch('source/sass/(.*)\.scss')
    watch(/source\/sass\/(.*)\.s[ac]ss/)

  end

end 
```

And my compass.rb file

```
 require 'sass'
require 'compass'

# Require any additional compass plugins here.

# Get the directory that this configuration file exists in
dir_src = File.dirname(__FILE__)

# Set this to the root of your project when deployed:
http_path = "/"
project_path = File.join(dir_src, "../", "")

sass_dir = "source/sass"
sass_path = sass_dir

css_dir = "client/css"
#css_path  = File.join(dir_src, "client", "css")

#images_dir = "img"
#images_path  = File.join(dir_src, "../public", "img")

#javascripts_dir = "js"
#javascripts_path  = File.join(dir_src, "../public", "js")

#Environment
#environment = :development

# You can select your preferred output style here (can be overridden via the command line):
# output_style = :expanded or :nested or :compact or :compressed
output_style = :expanded

# To enable relative paths to assets via compass helper functions. Uncomment:
relative_assets = true

# To disable debugging comments that display the original location of your selectors. Uncomment:
line_comments = false

# If you prefer the indented syntax, you might want to regenerate this
# project again passing --syntax sass, or you can uncomment this:
#preferred_syntax = :sass

# and then run:
# sass-convert -R --from scss --to sass sass scss && rm -rf sass && mv scss sass
debug_info = false 
```

My folder structure is as follows with my top level directory.

```
project/
  client/
     css
  source/
     sass/ 
```

Not sure why compass fails to compile?

Edit:

![FILE STRUCTURE](https://i.stack.imgur.com/BNl1C.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T05:36:03.733

The `sass_path` should be an absolute path. In your configuration, it's relative.

Try commenting it out, you already have `sass_dir`.

If this doesn't help, please share your project directory structure.

# browser - 在网站中嵌入网站

> ID：15939910
> 
> 赞同：0
> 
> 时间：2013-04-11T02:52:13.197
> 
> 标签：browser, embed, webpage

我已经创建了一个网站，并将在 Chrome 中全屏、在触摸屏上运行它。在这个网站中，我希望有一个嵌入式网站，以便用户可以在不离开我的网站的情况下在该产品的网站上查找更多信息。有没有办法使用 HTML、CSS 或 JavaScript 在网站中嵌入网站？

我不想使用像 Bitty 这样的第三方应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T02:53:41.223

在这里使用 HTML`<iframe></iframe>`是关于它们的资源：http: [//www.w3schools.com/tags/tag_iframe.asp](http://www.w3schools.com/tags/tag_iframe.asp)

请记住，某些网站使用`X-Frame-Options: SAMEORIGIN`这意味着该网站将无法在 a 中`iframe`运行，除非它托管在同一域中。

更多信息`X-Frame-Options: SAMEORIGIN`：[https ://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options?redirectlocale=en-US&redirectslug=The_X-FRAME-OPTIONS_response_header](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options?redirectlocale=en-US&redirectslug=The_X-FRAME-OPTIONS_response_header)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T02:55:46.223

第一个明显的反应是 iframe。你考虑过吗？ [http://www.w3schools.com/tags/tag_iframe.asp](http://www.w3schools.com/tags/tag_iframe.asp)

`<iframe src="http://www.w3schools.com" width=pixels height=pixels></iframe>`

# jquery - 如何在 Google Gadget API 中调用 jQuery

> ID：15939911
> 
> 赞同：4
> 
> 时间：2013-04-11T02:52:29.610
> 
> 标签：jquery, google-gadget

像这样的简单代码永远不会工作，我搜索了整个谷歌，该死的地狱公司没有提供关于如何应用 jQuery 的简单教程？这非常令人沮丧！

```
<Content type="html"><![CDATA[
   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
   <div id="content_div" height="250">abc</div>

   <script type="text/javascript">
       alert($('#content_div').css('height'));
   </script>
   ]]>    
</Content> 
```

怎么了？

========

如果我使用这个：

```
<script type="text/javascript" src="https://www.google.com/jsapi"></script> 
```

我会收到这个错误：

![在此处输入图像描述](https://i.stack.imgur.com/x1NID.png)

如果我使用这个：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script> 
```

我会收到这个错误：

![在此处输入图像描述](https://i.stack.imgur.com/iolIl.png)

错误信息：

```
[blocked] The page at https://pct0pnegjcnktlrmc1cf6dh916jdefnq-a-sites-opensocial.googleuserconte…y%252F8t2ynycEfP2AdZ8IeBvJF%26c%3Denterprise&rpctoken=-2403247092253746774 ran insecure content from http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T05:01:17.380

好的，在我阅读了这个[https://developers.google.com/speed/libraries/devguide](https://developers.google.com/speed/libraries/devguide)之后，我终于解决了这个该死的问题......

代替

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

它必须是：（罪魁祸首是“ **http** ”方案）

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

所以这就是它的样子：

```
<Content type="html"><![CDATA[
   <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
   <div id="content_div" height="250px">abc</div>

   <script type="text/javascript">
        $('#content_div').html('123');
   </script>
   ]]>    
</Content> 
```

# android - 如何创建接收器以创建新事件

> ID：15939912
> 
> 赞同：3
> 
> 时间：2013-04-11T02:52:34.363
> 
> 标签：android, calendar, android-manifest

我创建了一个应用程序，可以将约会连续添加到日历中。但是我现在希望能够单击日历程序中的“新事件”按钮，例如。aCalendar 并弹出我的程序。我想我有点失落。

在我的 AndroidManifest.xml

```
 <receiver 
        android:name="com.johnny.CalendarAdd"
        android:enabled="true"
        >
        <intent-filter>
            <data android:pathPrefix="vnd.android.cursor.item/event" />
            <action android:name="android.intent.action.EDIT" />
        </intent-filter>
    </receiver> 
```

试图将其更改为。

```
 <activity android:name="CalendarAdd">
      <intent-filter>
        <data android:pathPrefix="vnd.android.cursor.item/event" />
        <action android:name="android.intent.action.EDIT" /> 
      </intent-filter>
    </activity> 
```

在类文件中

```
package com.johnny;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;

public class CalendarTest extends BroadcastReceiver {
 @Override
 public void onReceive(Context context, Intent intent) {
     Log.i("CalendarAdd", "CalendarAdd.onReceive called!");

 }
} 
```

当我单击“新事件”按钮时，我的应用程序没有出现在列表中。我环顾四周，认为我错过了一些简单的事情，或者我完全走错了路。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-01T09:48:15.343

**您无法使用广播接收器来实现它**，广播意图过滤器仅在某些应用程序广播该特定意图时才起作用，例如连接状态发生变化、屏幕关闭、电池电量不足等是系统广播的正确示例。虽然创建日历事件不能是广播，这就是您无法接收它的原因。

**来自有关广播接收器的android文档：**

> 广播接收器是响应系统范围的广播公告的组件。许多广播来自系统——例如，宣布屏幕已关闭、电池电量低或已捕获图片的广播。应用程序还可以发起广播——例如，让其他应用程序知道某些数据已下载到设备并可供他们使用。尽管广播接收器不显示用户界面，但它们可以创建状态栏通知以在广播事件发生时提醒用户。然而，更常见的是，广播接收器只是其他组件的“网关”，旨在完成非常少量的工作。例如，它可能会启动一项服务以根据事件执行某些工作。

为了实现所需的功能，您需要为您的活动注册意图过滤器。您的清单还应包含读/写日历权限和事件编辑/插入意图过滤器，例如

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="com.example.CalanderTest"
          android:versionCode="1"
          android:versionName="1.0">
    <uses-sdk android:minSdkVersion="8"/>

    <uses-permission android:name="android.permission.READ_CALENDAR" />
    <uses-permission android:name="android.permission.WRITE_CALENDAR" />

    <application android:label="@string/app_name" android:icon="@drawable/ic_launcher">
        <activity android:name="MyActivity"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.EDIT" />
                <action android:name="android.intent.action.INSERT" />
                <category android:name="android.intent.category.DEFAULT" />
                <data android:mimeType="vnd.android.cursor.item/event" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

为了测试它，请在单击某些测试按钮时执行以下操作：-

```
@Override
public void onClick(View view) {
    super.onClick(view);    
    if (view.getId()==R.id.create_event)
    {
       Intent i = new Intent(Intent.ACTION_INSERT);
        i.setType("vnd.android.cursor.item/event");
        startActivity(i);
    }
} 
```

单击我的测试按钮后，我得到了如下图所示的菜单，因此上面的代码可以很好地在应用选择器对话框中显示您的应用，以添加/编辑日历事件。 ![在此处输入图像描述](https://i.stack.imgur.com/9Qzsh.png)

现在在您的活动中，您可以使用 getIntent() 处理此意图并相应地执行操作。 **[您可以在此处](http://developer.android.com/guide/topics/providers/calendar-provider.html)**查看日历事件支持的附加功能。像**Events.TITLE、Events.EVENT_LOCATION**等。如果您要创建自己的日历事件创建者，那么您需要优雅地处理所有这些额外内容，以获得出色的用户体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T14:00:08.883

> 但是我现在希望能够单击日历程序中的“新事件”按钮，例如。aCalendar 并弹出我的程序。

您是否尝试`action`过.`category``<intent-filter>`

例如：

```
 <intent-filter>
        <action android:name="android.intent.action.VIEW" />
        <action android:name="android.intent.action.EDIT" />
        <action android:name="android.intent.action.PICK" />
        <category android:name="android.intent.category.DEFAULT" />
        <category android:name="android.intent.category.BROWSABLE" />
        <category android:name="android.intent.category.OPENABLE" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="application/myapp" />
    </intent-filter> 
```

看看这些是否对你有帮助。

另请参阅：http: [//developer.android.com/reference/android/content/Intent.html](http://developer.android.com/reference/android/content/Intent.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T03:46:27.630

`<receiver>`像你最初那样使用，如果你想注册你的接收器，`android:name`应该使用，因为你的接收器类名是.`com.johnny.CalendarTest``CalendarTest`

[看这里](http://developer.android.com/reference/android/R.styleable.html#AndroidManifestReceiver)

`android:name` `Required name of the class implementing the receiver, deriving from BroadcastReceiver.`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-30T13:51:51.860

从[CalendarController](https://android.googlesource.com/platform/packages/apps/Calendar/+/android-4.2.2_r1.1/src/com/android/calendar/CalendarController.java)，我几乎可以确定这些意图是具有特定组件集的显式意图。例如，在`launchEditEvent`方法中。

```
private void launchEditEvent(long eventId, long startMillis, long endMillis, boolean edit) {
    Uri uri = ContentUris.withAppendedId(Events.CONTENT_URI, eventId);
    Intent intent = new Intent(Intent.ACTION_EDIT, uri);
    intent.putExtra(EXTRA_EVENT_BEGIN_TIME, startMillis);
    intent.putExtra(EXTRA_EVENT_END_TIME, endMillis);
    intent.setClass(mContext, EditEventActivity.class);
    intent.putExtra(EVENT_EDIT_ON_LAUNCH, edit);
    mEventId = eventId;
    mContext.startActivity(intent);
} 
```

意图设置为由 EditEventActivity 处理。所以不可能在你的应用程序中接收到这样的意图。我认为日历应用程序将其作为一个明确的意图，因为它认为这是一个应用程序内事件。如果这不是一个明确的意图，您的代码应该可以工作，因为日历应用程序中的组件与您所做的几乎相同。

```
 <intent-filter>
        <action android:name="android.intent.action.EDIT" />
        <action android:name="android.intent.action.INSERT" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="vnd.android.cursor.item/event" />
    </intent-filter>
    <intent-filter>
        <action android:name="android.intent.action.EDIT" />
        <action android:name="android.intent.action.INSERT" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="vnd.android.cursor.dir/event" />
    </intent-filter> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T03:21:19.897

将`<intent-filter>`您定义的内容放在您的内部`<activity>`。应该为用户提供可以处理该操作的应用程序列表（包括您的应用程序），以便他们可以根据需要选择您的应用程序。

`<receiver>`s 用于接收 BroadcastIntents，这有点不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-02T01:36:28.037

```
 <activity android:name="com.johny.CalendarTest"
        android:label="@string/app_name" >

        <intent-filter>
            <action android:name="android.intent.action.EDIT" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.ALTERNATIVE" />

            <data android:host="com.android.calendar" />
            <data android:host="calendar" />
            <data android:scheme="content" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.EDIT" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.ALTERNATIVE" />

            <data android:mimeType="vnd.android.cursor.item/event" />
        </intent-filter>
    </activity> 
```

这是我使用并开始工作的确切代码。大多数答案都有助于获得响应。奖励给了付出最大努力并取得成果的人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-30T13:52:03.280

aCalendar New Event Intent 就是这样。

{act=android.intent.action.EDIT typ=vnd.android.cursor.item/event flg=0x20000000 cmp=org.withouthat.acalendar/.edit.EditActivity（有附加功能）}

而 Google Calendar App New Event Intent 就是这样。

{act=android.intent.action.VIEW cmp=com.android.calendar/.event.EditEventActivity

它们是明确的意图。您无法在您的应用中收到此意图。有关意图的更多信息，请单击[此处](http://developer.android.com/guide/components/intents-filters.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-23T07:19:41.037

旧答案向我展示了方向，但我必须进行一些小修改才能使其正常工作：

```
<activity
        android:name=".YourActivity"
        android:exported="true">
    <intent-filter>
            <action android:name="android.intent.action.INSERT" />
            <action android:name="android.intent.action.EDIT" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="vnd.android.cursor.dir/event" />
     </intent-filter>
</activity> 
```

# angularjs - 单页应用——基于局部视图动态加载js文件

> ID：15939913
> 
> 赞同：40
> 
> 时间：2013-04-11T02:52:37.057
> 
> 标签：angularjs

我刚刚开始学习 Angular 并按照这里的教程进行操作 - [http://docs.angularjs.org/tutorial/step_00](http://docs.angularjs.org/tutorial/step_00)

我从 GitHub 下载了种子示例，效果很好。不过我有一个问题——如果局部视图需要引用外部 js 文件，是否需要在开始时将其添加到 index.html 文件中？我希望应用程序尽可能精简，并且只想包含当前视图所需的 js 引用。是否可以基于视图动态加载 js 文件？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-03-21T19:15:40.410

这对我有用。想我会把它发布给其他寻求最轻量级解决方案的人。

我在页面的 html 标记上有一个顶级控制器，每个部分视图都有一个辅助控制器。

在顶层控制器中，我定义了以下函数……</p>

```
$scope.loadScript = function(url, type, charset) {
    if (type===undefined) type = 'text/javascript';
    if (url) {
        var script = document.querySelector("script[src*='"+url+"']");
        if (!script) {
            var heads = document.getElementsByTagName("head");
            if (heads && heads.length) {
                var head = heads[0];
                if (head) {
                    script = document.createElement('script');
                    script.setAttribute('src', url);
                    script.setAttribute('type', type);
                    if (charset) script.setAttribute('charset', charset);
                    head.appendChild(script);
                }
            }
        }
        return script;
    }
}; 
```

因此，在辅助控制器中，我可以通过如下调用加载所需的脚本……</p>

```
$scope.$parent.loadScript('lib/ace/ace.js', 'text/javascript', 'utf-8'); 
```

在外部脚本中包含的对象可用之前会有一点延迟，因此您需要在尝试使用它们之前验证它们的存在。

希望能节省一些时间。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-06-11T02:57:00.123

我刚刚尝试了[https://oclazyload.readme.io/](https://oclazyload.readme.io/)。它开箱即用。

```
bower install oclazyload --save 
```

将其加载到您的模块中，并在控制器中注入所需的模块：

```
var myModule = angular.module('myModule', ['oc.lazyLoad'])
   .controller('myController', ['$scope', '$ocLazyLoad', '$injector',

       function($scope, $ocLazyLoad, $injector) {
           $ocLazyLoad.load(
                   ['myExtraModule.js',
                       'orAnyOtherBowerLibraryCopiedToPublicFolder.js'
                   ])
               .then(function() {
                   // Inject the loaded module
                   var myExraModule = $injector.get('myExtraModule');
               });
       }
   ]); 
```

# c# - 如何让我的 kinect hoverbutton 在我的子窗口上工作

> ID：15939919
> 
> 赞同：0
> 
> 时间：2013-04-11T02:53:19.363
> 
> 标签：c#, wpf, kinect

我正在编写一个 kinect 应用程序，它需要我使用手并充当鼠标，我已经完成了这称为悬停按钮。有什么办法可以让我的主窗口中的悬停按钮也可以在我的子窗口上工作？

```
 <Window x:Class="KinectButton.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Controls="clr-namespace:Coding4Fun.Kinect.Wpf.Controls;assembly=Coding4Fun.Kinect.Wpf"
    Title="MainWindow" Background="#FFAD4747"
    WindowStyle="None" ResizeMode="NoResize"  
WindowStartupLocation="CenterScreen" WindowState="Maximized" mc:Ignorable="d" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" Height="927" Width="1350">

<Grid x:Name="LayoutRoot">
    <Canvas>
    <Canvas.Background>
        <ImageBrush ImageSource="file:///C:/Users/103159T/Downloads/STORYBOARD/Background.png" />
    </Canvas.Background>
    <Controls:HoverButton Margin="0" Padding="0" x:Name="kinectButton" ImageSize="50"                                           
                            ImageSource="/Images/RightHand.png"  
                            ActiveImageSource="/Images/RightHand.png" 
                            TimeInterval="2000"  Panel.ZIndex="1000" Canvas.Left="0" Canvas.Top="0" />
        <Button x:Name="button1" Content="START" Height="152" Canvas.Left="594" Canvas.Top="502"  Width="320" FontSize="40" Click="button1_Click" BorderThickness="4" Foreground="White" FontFamily="Comic Sans MS" OpacityMask="Black" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Button.Background>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FF0000C8" Offset="0.358" />
                    <GradientStop Color="White" Offset="1" />
                </LinearGradientBrush>
            </Button.Background>
        </Button>
        <Label Canvas.Left="384" Canvas.Top="632" Content="" Height="66" Name="message" Width="530" Foreground="White" FontSize="40" />
        <Button Canvas.Left="0" Canvas.Top="974" Content="Quit" Height="91" Name="quitButton" Width="137" FontSize="28" Background="#FFFF3838" Foreground="White" Click="quitButton_Click" />
        <Image Height="206" Name="videoStream" Stretch="Fill" Width="363" Canvas.Left="1002" Canvas.Top="682" />
    </Canvas>
</Grid> 
```

那是我的主窗口 xaml，其中包括一个名为“START”的按钮，单击该按钮会将我引导到另一个 xaml 窗口。

# django - Django http404错误urlconf混淆

> ID：15939925
> 
> 赞同：0
> 
> 时间：2013-04-11T02:53:43.787
> 
> 标签：django

我真的很困惑为什么我收到`Http404`错误。为了更清楚这是我的代码：

我的应用名为书

**视图.py**

```
from django.shortcuts import render_to_response
from django.http import Http404
from django.template import RequestContext
from books.models import *

def index(request):
    title = 'Book Gallery'
    books = Book.objects.all().order_by('-id')
    lang_list = Lang.objects.all().order_by('-lang')
    template = 'books/index.djhtml'
    context = {'books': books, 'title': title, 'lang_list': lang_list}
    return render_to_response( template, context, context_instance=RequestContext(request) )

def by_book_slug(request, bookslug):
    slug = bookslug
    try:
        book = Book.objects.get(slug=slug)
    except:
        raise Http404

    title = book.name
    template = 'books/singlebook.djhtml'
    context = {'book': book, 'title': title}
    return render_to_response( template, context, context_instance=RequestContext(request) )

def by_lang_slug(request, langslug):
    filter = langslug
    try:
        language = Lang.objects.get(slug=filter)
    except:
        raise Http404
    lang_list = Lang.objects.all().order_by('-lang')
    books = Book.objects.filter(lang=language).order_by('-id')
    title = language
    template = 'books/by_language.djhtml'
    context = {'books': books, 'title': title, 'filter': filter, 'lang_list': lang_list}
    return render_to_response( template, context, context_instance=RequestContext(request) )

urls.py inside my book app folder

from django.conf.urls import patterns, include, url
from books import views

urlpatterns = patterns('',
    url(r'(?P<langslug>.*)/$', views.by_lang_slug, name='by_lang'),
    url(r'(?P<bookslug>.*)/$', views.by_book_slug, name='by_book'),
    url(r'^$', views.index, name='book_gallery'),
) 
```

与 langslug url conf 相关的链接有效，但 bookslug url conf 的链接不起作用。当我尝试调低和调高它们时，其中一个可以工作，而另一个不能。

我真的不知道这里发生了什么。任何帮助都会是很大的帮助。谢谢。

我的图书应用程序的索引模板

```
{% extends 'base.djhtml' %}

{% block title %} | Gallery{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/style.css" />
{% endblock %}
{% block content_header %}
{% endblock %}
{% block content_body %}
    <div class="row">
        <div class="span3">
            <strong>filtered by > 
                {% if filter %}
                    {{ filter }}
                {% else %}
                    All
                {% endif %} 
            </strong>
            <ul class="nav nav-list">
              <li class="nav-header">Filter</li>
              <li class="nav-header
                  {% if not filter %}
                        active
                  {% endif %}
              "><a href="/books/">All</a></li>
              {% for list in lang_list %}
                <li class="nav-header
                    {% if filter == list.slug %}
                        active
                    {% endif %}
                ">
                    <a href="{% url by_lang langslug=list.slug %}">{{ list.lang }}</a>
                </li>
              {% endfor %}
            </ul>
        </div>
        <div class="span9">
            {% for book in books %}
                <div class="span3">
                    <a href="{{ book.book_cover.url }}">
                        <img alt="{{book.name}}" src="{{ book.thumbnail.url }}" />
                    </a>
                    <h4>{{book.name}}</h4>
                    <p>{{book.desc|truncatewords:15}}</p>
                    <a href="{% url by_book bookslug=book.slug %}" class="btn btn-mini">View more...</a>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %} 
```

我的图书应用程序的 by_language 模板

```
{% extends 'base.djhtml' %}

{% block title %} | Gallery{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/style.css" />
{% endblock %}
{% block content_header %}
{% endblock %}
{% block content_body %}
    <div class="row">
        <div class="span3">
            <strong>filtered by > 
                {% if filter %}
                    {{ filter }}
                {% else %}
                    All
                {% endif %} 
            </strong>
            <ul class="nav nav-list">
              <li class="nav-header">Filter</li>
              <li class="nav-header
                  {% if not filter %}
                        active
                  {% endif %}
              "><a href="/books">All</a></li>
              {% for list in lang_list %}
                <li class="nav-header
                    {% if filter == list.slug %}
                        active
                    {% endif %}
                ">
                    <a href="{% url by_lang langslug=list.slug %}">{{ list.lang }}</a>
                </li>
              {% endfor %}
            </ul>
        </div>
        <div class="span9">
            {% for book in books %}
                <div class="span3">
                    <a href="{{ book.book_cover.url }}">
                        <img alt="{{book.name}}" src="{{ book.thumbnail.url }}" />
                    </a>
                    <h4>{{book.name}}</h4>
                    <p>{{book.desc|truncatewords:15}}</p>
                    <a href="{% url by_book bookslug=book.slug %}" class="btn btn-mini">View more...</a>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %} 
```

`Http404`当指定的 slug 与数据库中的任何查询都不匹配时，我已经包含了一个 raise方法。我感到困惑的是，当我尝试切换 langslug 和 bookslug urlconf 时，与这些 url 之一相关联的链接有效，而另一个无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:21:56.117

根据您的网址，如果我重视它，即使他们有不同的看法，结果将是：

```
urlpatterns = patterns('',

    # http://localhost:8000/English/
    url(r'(?P<langslug>.*)/$', views.by_lang_slug, name='by_lang'),

    # http://localhost:8000/YourBook/
    url(r'(?P<bookslug>.*)/$', views.by_book_slug, name='by_book'),

    # http://localhost:8000/
    url(r'^$', views.index, name='book_gallery'),
) 
```

你注意到了吗，它们具有相同的模式，所以第一个视图执行的是`by_lang_slug`. 因此，如果您更改顺序，则将首先执行另一个顺序。最好的办法就是拥有`a unique url name`.

```
urlpatterns = patterns('',

    # http://localhost:8000/lang/English/
    url(r'lang/(?P<langslug>.*)/$', views.by_lang_slug, name='by_lang'),

    # http://localhost:8000/book/YourBook/
    url(r'book/(?P<bookslug>.*)/$', views.by_book_slug, name='by_book'),

    # http://localhost:8000/
    url(r'^$', views.index, name='book_gallery'),
) 
```

现在他们不一样了......

# sql - 复杂的sql选择

> ID：15939928
> 
> 赞同：1
> 
> 时间：2013-04-11T02:53:58.683
> 
> 标签：sql, oracle, select, oracle-sqldeveloper

我不知道如何制作这个 sql select 语句......这是我的表格：

![在此处输入图像描述](https://i.stack.imgur.com/2ws3h.png)

我打开了请求所涉及的表

所以基本上`I want to select the number of albums for each interpret.` 我就是想不通......我目前在想我需要在专辑上做我的第一个选择，比如：

```
select interpret.no_interpret, count(*)
from album
.
.
.
group by interpret.no_interpret; 
```

并且有工作，但我不知道下一步该去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:07:30.230

这个问题是模棱两可的，因为没有清楚地表明这些表是如何相关的。给定关于这些关系的假设，您的查询可能会采用类似于以下形式的内容：

```
SELECT COUNT(distinct a.no_album) from album a, interpret i, song s 
where i.no_song=s.no_song 
and a.no_album=s.no_album GROUP BY i.no_interpret 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:14:35.387

我可能遗漏了一些东西，但我没有看到你的歌曲表与专辑的直接关系......

我首先将 link_interpret_song 表加入到歌曲表中，然后计算不同专辑的数量。但是，我没有在歌曲表的字段列表中看到“No_Album”列。我只能猜测它与特定专辑相关联。我确实看到了媒体，但对我来说，这就像一种媒体类型（数字、下载、乙烯基、CD）与专辑表中明显的实际 ID 密钥。

也就是说，我认为 SONG 表中有这样一个“No_Album”列。

```
select
      LIS.No_Interpret,
      COUNT( DISTINCT S.No_Album )
   from
      Link_Interpret_Song LIS
         JOIN Song S
            on LIS.No_Song = S.No_Song
   group by
      LIS.No_Interpret; 
```

现在，也就是说，如果您想要解释详细信息，请获取上述结果并将其加入解释表。我已经完成了不同的专辑计数和歌曲总数，作为 count() 与 count(distinct) 上下文的示例......例如

```
select
      PreCounts.No_Interpret,
      PreCounts.DistinctAlbums,
      PreCounts.ActualSongs,
      I.Name_Interpret,
      I.First_Name,
      I.Stage_Name
   from
      ( select
              LIS.No_Interpret,
              COUNT( DISTINCT S.No_Album ) as DistinctAlbums,
              COUNT(*) as ActualSongs
           from
              Link_Interpret_Song LIS
                 JOIN Song S
                    on LIS.No_Song = S.No_Song
           group by
              LIS.No_Interpret ) as PreCounts
      JOIN Interpret I
         ON PreCounts.No_Interpret = I.No_Interpret 
```

# ruby-on-rails - Rails 中的用户到用户支付

> ID：15939929
> 
> 赞同：0
> 
> 时间：2013-04-11T02:53:58.757
> 
> 标签：ruby-on-rails, ruby, e-commerce

我希望在我的 Rails 应用程序中实现一个支付系统，该系统允许用户相互收取服务费用，我将从这笔转账中收取少量费用。我已经环顾了很长时间，但大多数服务（例如 Stripe）不支持客户到客户的转账。我对如何实现这一点有点迷茫，因此我会很感激我能得到的任何帮助。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:15:16.370

据我所知，Stripe 可以通过应用程序费用进行用户对用户的交易：

[https://stripe.com/connect](https://stripe.com/connect)

# java - 从控制器调用服务但在我的测试中没有找到当前线程的 HibernateException 没有会话

> ID：15939932
> 
> 赞同：2
> 
> 时间：2013-04-11T02:54:12.517
> 
> 标签：java, spring, hibernate

当我启动我的应用程序并从我的控制器调用服务时，我得到了 No session found 异常。但是，我可以从单元测试中成功调用相同的服务。

当我在控制器类上调用 userService.userExists(username) 方法时，就会发生这种情况。我开始在调试器中跟踪执行，发现 TransactionSynchronizationManager 资源对象映射为空，即使我将服务装饰为事务性的。但是，当我从单元测试调用服务时，TransactionSynchronizationManager 上有资源。

控制器类：

```
@Controller
public class DiaryController {

    @Autowired
    private UserService userService;

    @RequestMapping(method = RequestMethod.GET, value = "/diary/{username}")
    public String home(@PathVariable String username, ModelMap model) {
        String authUser = SecurityContextHolder.getContext().getAuthentication().getName();

        if(authUser.equals(username)) {
            model.addAttribute("message", "Hey there. How's it going " + username + "?");
        }
        else if (userService.userExists(username)) {
            model.addAttribute("message", "You're looking at diary for " + username + ".");
        }
        else {
            model.addAttribute("message", "User " + username + " does not exist.");
        }
        return "diary";
    }
} 
```

休眠上下文：

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
        <list>
            <value>classpath:database.properties</value>
        </list>
    </property>
</bean>

<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="${jdbc.driver}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.user}" />
    <property name="password" value="${jdbc.password}" />
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="mappingLocations">
        <list>
            <value>classpath*:hbm/User.hbm.xml</value>
        </list>
    </property>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
            <prop key="hibernate.show_sql">true</prop>
        </props>

    </property>
</bean>

<tx:annotation-driven transaction-manager="transactionManager"/>

<bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory"/>
</bean> 
```

应用上下文：

```
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/jsp/" />
    <property name="suffix" value=".jsp" />
</bean>

<mvc:annotation-driven/>
<mvc:resources mapping="/resources/**" location="/resources/"/> 
```

UserDoaImpl：

```
@Repository
public class UserDaoImpl extends AbstractDaoImpl<User, String> implements UserDao {

    protected UserDaoImpl() {
        super(User.class);
    }

    @Override
    public void saveUser(User user) {
        saveOrUpdate(user);
    }

    @Override
    public List<User> findUsers(String username) {
        return findByCriteria(Restrictions.like("username", username, MatchMode.EXACT));
    }

    @Override
    public boolean exists(String username) {
        return findById(username) != null;
    }
} 
```

我的工作单元测试：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = {
        "classpath:/spring/applicationContext.xml",
        "classpath:/spring/securityContext.xml",
        "classpath:/spring/hibernateContext.xml"
})
public class UserServiceTest {

    @Autowired
    private UserService userService;

    @Test
    public void userServiceTest() {
        Assert.assertTrue(userService.userExists("fergal"));
    }
} 
```

用户服务实现：

```
@Service("userService")
@Transactional(readOnly = true)
public class UserServiceImpl implements UserService {

    @Autowired
    private UserDao userDao;

    @Override
    public User findByUserName(String userName) {
        return userDao.findById(userName);
    }

    @Override
    @Transactional(readOnly = false)
    public void saveUser(User user) {
        userDao.saveUser(user);
    }

    @Override
    @Transactional(readOnly = false)
    public void deleteUser(String userName) {
        User user = userDao.findById(userName);
        if (user != null) {
            userDao.delete(user);
        }
    }

    @Override
    public List<User> findUsers(String user) {
        return userDao.findUsers(user);
    }

    @Override
    public boolean userExists(String username) {
        return userDao.exists(username);
    } 
```

web.xml

```
<web-app id="WebApp_ID" version="2.4"
         xmlns="http://java.sun.com/xml/ns/j2ee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee
         http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
    <display-name>MyApp</display-name>

    <servlet>
        <servlet-name>myapp-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>classpath:/spring/applicationContext.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>myapp-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:/spring/**</param-value>
    </context-param>

    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
</web-app> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T04:33:07.737

将以下过滤器添加到您的 web.xml。[您可以在http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/orm/hibernate4/support/OpenSessionInViewFilter.html](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/orm/hibernate4/support/OpenSessionInViewFilter.html)查看有关此过滤器的更多信息

```
 <filter>
          <filter-name>hibernateFilter</filter-name>
          <filter-class>org.springframework.orm.hibernate4.support.OpenSessionInViewFilter</filter-class>
          <init-param>
             <param-name>sessionFactoryBeanName</param-name>
             <param-value>sessionFactory</param-value>         
          </init-param>      
       </filter>

    <filter-mapping>
        <filter-name>hibernateFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping> 
```

# java - 当程序从 JAR 文件与类文件运行时，某些字符的显示方式不同

> ID：15939933
> 
> 赞同：1
> 
> 时间：2013-04-11T02:54:21.903
> 
> 标签：java, encoding, jar, executable-jar, joptionpane

//

编辑：我做了更多研究，发现关于更改默认编码虽然可以在运行时这样做，但似乎你只能通过属性而不是代码来更改 defaultCharacterEncoding，我认为这是我想要找到的这里 defaultCharacterEncoding 在运行时不能更改：

> 此外，人们可能认为他们可以通过编程方式更改系统属性“file.encoding”。但是，在 JVM 启动后无法设置，因为到那时所有依赖此值的系统类都已经缓存了它。

来源： [http ://www.philvarner.com/blog/2009/10/24/unicode-in-java-default-charset-part-4/](http://www.philvarner.com/blog/2009/10/24/unicode-in-java-default-charset-part-4/)

我是否正确解释了这些信息？

//

我的问题与该用户遇到的问题相似，但那里提供的解决方案似乎都不适用于我的问题：

[在 netbeans 中运行时的特殊字符正确显示，但在运行“jar”文件时出现奇怪的字符](https://stackoverflow.com/questions/12029455/special-characters-when-run-in-netbeans-are-showing-correctly-but-when-running)

我的程序在下拉 JOptionPane InputDialog 窗口中显示带有特殊字符的某些名称，例如“Français 6A”或“Español 6A”。

这两个名称是我通过 IDE 运行程序时正确显示的名称示例，如下所示：

![对话框 - 从 IDE 运行时](https://i.stack.imgur.com/GWSOm.png)

但是当我从 JAR 文件运行程序时看起来像这样：

![对话框 - 从 JAR 运行时](https://i.stack.imgur.com/w0mu5.png)

这是创建上面看到的窗口的代码：

```
JOptionPane.showInputDialog(
    null,
    "Please choose which class you have. If none of these are correct hit cancel",
    "Class Website Choice",
    JOptionPane.QUESTION_MESSAGE,
    null,
    dirtyLinks,
    dirtyLinks[0]); 
```

这是dirtyLinks数组的代码：

```
String[] dirtyLinks = new String[dirtyClasses.length]; 
```

这是dirtyLinks用字符串填充的代码

```
for (ClassWebsite link : dirtyClasses) {
    System.out.println(i);
    dirtyLinks[i++] = link.getName();
} 
```

这是 ClassWebsite 类的代码

```
public class ClassWebsite {
    private String selfLink = "";
    private String className = "";
    private int distance = 0;
    public ClassWebsite(String className, String selfLink, int distance) {
        this.className = className;
        this.selfLink = selfLink;
        this.distance = distance;
    }
    public int getDistance() {
        return distance;
    }
    public String getLink() {
        return selfLink;
    }
    public String getName() {
        return className;
    }
} 
```

dirtyClasses 一个 ClassWebsite 对象的数组

从阅读上面看到的问题的回复看来，我必须将编码更改为 UTF-8，但我不知道如何或在我的程序中执行此操作。如果您需要更多代码，请告诉我。

# django - Django 压缩器未正确更改相对 URL

> ID：15939937
> 
> 赞同：1
> 
> 时间：2013-04-11T02:54:47.713
> 
> 标签：django, django-compressor

例如，在我的 SCSS 文件中，

```
url('../../fonts/Museo_Slab_500-webfont.eot'); 
```

变成

```
url('https://fonts/Museo_Slab_500-webfont.eot'); 
```

这显然是行不通的。

我在我的 settings.py

```
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
AWS_ACCESS_KEY_ID = os.environ['AWS_ACCESS_ID']
AWS_SECRET_ACCESS_KEY = os.environ['AWS_ACCESS_KEY']
AWS_STORAGE_BUCKET_NAME = 'digital_time_capsules'
STATICFILES_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
AWS_QUERYSTRING_AUTH = False
COMPRESS_OFFLINE = True
COMPRESS_STORAGE = STATICFILES_STORAGE
COMPRESS_URL = "https://digital_time_capsules.s3.amazonaws.com/"
STATIC_URL = COMPRESS_URL 
```

我尝试了几次运行压缩，并重新启动服务器，等等。它昨天工作了一次，我得到了通往 S3 的完整路径。但现在没有了，我的自定义资源也没有加载。

不过，Bootstrap 的 URL 似乎总是有效。它确实成功生成

```
image:url('https://digital_time_capsules.s3.amazonaws.com/img/glyphicons-halflings-white.png') 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-10T12:07:40.920

显然文件夹的相对路径要`fonts`高 1 级。所以试试：

`url('../fonts/Museo_Slab_500-webfont.eot');`

# linux - linux高slab缓存使用情况

> ID：15939938
> 
> 赞同：14
> 
> 时间：2013-04-11T02:54:50.883
> 
> 标签：linux, memory

在我的一台服务器上，我有一些内存/磁盘 KV 服务，Memory KV 的行为类似于 memcached，在初始化时要求大量内存（10GB），Disk Kv 的行为类似于 leveldbd，它的随机读取和顺序写入，而且它经常读取很多文件。内存全部使用 libc malloc 分配。

我的 KV 服务器进程并没有消耗大量内存，如下所示（由于内存不足，我已经杀死了内存 KV，只留下了磁盘 KV，但可用内存仍然下降）：

```
:~$top
PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND
20 0 5030m 3.9g 2772 S 8 6.1 10430:52 tair_server
20 0 4833m 3.9g 4560 S 8 6.1 10171:07 tair_server
20 0 4844m 3.9g 3844 S 38 6.1 10073:32 tair_server
20 0 4765m 3.8g 4144 S 8 6.0 10552:39 tair_server
20 0 2941m 2.4g 9.8m S 0 3.8 256:45.70 tair_server
20 0 2953m 2.4g 12m S 1 3.7 276:54.64 tair_server 
```

但是，我的记忆已经消失了。

```
$free -m

             total       used       free     shared    buffers     cached
Mem:         64552      57778       6774          0         16        326
-/+ buffers/cache:      57435       7117
Swap:            0          0          0 
```

我可以看到平板消耗了我的大量内存，而且它是不可回收的。

```
$cat /proc/meminfo
MemTotal:       66101892 kB
MemFree:         6816228 kB
Buffers:           17024 kB
Cached:           456640 kB
SwapCached:            0 kB
Active:         19697712 kB
Inactive:        3197312 kB
Active(anon):   19546504 kB
Inactive(anon):  2875632 kB
Active(file):     151208 kB
Inactive(file):   321680 kB
Unevictable:          48 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:              6612 kB
Writeback:            72 kB
AnonPages:      22421152 kB
Mapped:            54408 kB
Shmem:               332 kB
Slab:           28870400 kB
SReclaimable:     213344 kB
SUnreclaim:     28657056 kB
KernelStack:       30000 kB
PageTables:        62776 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:    33050944 kB
Committed_AS:   37517224 kB
VmallocTotal:   34359738367 kB
VmallocUsed:      388624 kB
VmallocChunk:   34324313700 kB
HardwareCorrupted:     0 kB
HugePages_Total:       0
HugePages_Free:        0
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       2048 kB
DirectMap4k:        5696 kB
DirectMap2M:     2082816 kB
DirectMap1G:    65011712 kB 
```

这是平板信息。

```
$slabtop -s c

OBJS ACTIVE  USE OBJ SIZE  SLABS OBJ/SLAB CACHE SIZE NAME  
69842766 69838389  38%    0.19K 1663025       42  13304200K kmalloc-192
69314912 69314796  38%    0.12K 2166091       32   8664364K kmalloc-128
70866624 70866323  39%    0.06K 1107291       64   4429164K kmalloc-64
69299968 69299592  38%    0.03K 541406      128   2165624K kmalloc-32
128388  72434  56%    0.99K   4230       32    135360K ext4_inode_cache
208782  94112  45%    0.19K   4971       42     39768K dentry 
```

我不明白什么会消耗大量内存，为什么会这样，以及如何解决这个问题。

这可能是间隔内核错误吗？

或者这是一个 glibc 问题，由于频繁的磁盘读取，它没有将内存返回给系统？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-10-30T10:31:10.050

看起来您的发行版有点旧，但没关系。不要听那些告诉你必须先升级才能查看`unmae -a`输出的人。但是，如果您提供它会很好...

在较新版本的服务器和桌面发行版中，免费命令输出和`/proc/meminfo`包含多行的目的是为了消除您所遇到的那种混淆。行名在输出中为“MemAvailable”，`/proc/meminfo`在`free`输出中为“available”。

中的“free”列`free -m`并未以人类理解的方式显示可用内存（因此 中的“MemFree”行`/proc/meminfo`）。它不排除内核的页面缓存和其他未以人类理解的方式“使用”的缓存。

这是第一件事。如果您认为我错了并且您`free`正确理解了输出，请尝试：`echo 3 > /proc/sys/vm/drop_caches`看看内存使用情况会发生什么。请提供`free`以 root 身份执行该命令后的输出。

如果它仍然那么糟糕，请阅读：[https](https://www.linuxquestions.org/questions/linux-server-73/very-high-slab-usage-hard-to-understand-901323/) ://www.linuxquestions.org/questions/linux-server-73/very-high-slab-usage-hard-to-understand-901323/ 。它说您的内核可能必须升级。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-04-30T12:35:18.193

随top , free ,slabtop 的摘录提供

看起来你的内核正在吃掉内存板：28870400 kB

找到这个的一个非常简单的方法是 .

1.  做一个 Top ，并做一个 RES 内存的总和（RAM 上的常驻内存）， top 只给出内存的用户视图。

2.  做一个 free -m 看看有多少内存是空闲和使用的（free given kernel + user）。总内存 - top RES 与 FREE 命令中被称为 free 的内存之间的差异不应太大 ~1 GB

“是时候提升你的操作系统版本了”

# datetime - 通过设置为 2 位数年份的 pivotYear 以多种格式解析日期

> ID：15939939
> 
> 赞同：2
> 
> 时间：2013-04-11T02:54:59.857
> 
> 标签：datetime, jodatime, date-parsing

我无法实现日期的“简单”解析。要求是允许输入两位或四位数字的年份。当输入两位数字时，将分割日期用于决定它属于哪个世纪，它属于明年一月的第一天。这是我到目前为止所拥有的：

```
DateTime now = new DateTime();
int pivotYear = now.getYear() - 49; // 2013 - 49 = 1964 where 49 is the
DateTimeParser[] parsers = {
    DateTimeFormat.forPattern("dd/MM/yy").withPivotYear(pivotYear).withLocale(new Locale("en", "NZ")).getParser(),
    DateTimeFormat.forPattern("dd/MM/yyyy").withLocale(new Locale("en", "NZ")).getParser() 
};
DateTimeFormatter formatter = new DateTimeFormatterBuilder().append(null, parsers).toFormatter();
DateMidnight birthDate = new DateMidnight(formatter.parseDateTime(dateOfBirth)); 
```

不幸的是，它没有达到我的预期。假设今天的日期（2013 年 11 月 4 日），`dateOfBirth = "01/01/14"`它返回`2014-01-01T00:00:00.000+13:00`. 预期的结果是`1914-01-01T00:00:00.000+13:00`

当我查看[附加方法的 JavaDoc 时，](http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormatterBuilder.html#append%28org.joda.time.format.DateTimePrinter,%20org.joda.time.format.DateTimeParser%5B%5D%29)我看到了这句话

> 打印机和解析器接口是格式化 API 的低级部分。通常，实例是从另一个格式化程序中提取的。但是请注意，此方法不会提取任何格式化程序特定信息，例如语言环境、时区、年表、偏移量解析或基准/默认年份。

所以我决定将 Pivot 的东西移到`DateTimeFormatterBuilder`类中，所以现在代码如下所示：

```
DateTimeParser[] parsers = { 
    DateTimeFormat.forPattern("dd/MM/yy").getParser(),
    DateTimeFormat.forPattern("dd/MM/yyyy").getParser()
};
DateTimeFormatter formatter = new DateTimeFormatterBuilder().append(null, parsers).appendTwoDigitYear(pivotYear).toFormatter().withLocale(new Locale("en", "NZ")); 
```

不幸的是，这不是解决问题。相反，这次失败了

> java.lang.IllegalArgumentException：无效格式：“01/01/14”在 org.joda.time.format.DateTimeFormatter.parseDateTime(DateTimeFormatter.java:866) 处太短

从同一个 javadoc 我得到这句话

> 附加一个打印机和一组匹配的解析器。解析时，选择列表中的第一个解析器进行解析。如果失败，则选择下一个，依此类推。如果这些解析器都没有成功，则返回取得最大进展的解析器的失败位置。

基于此，第一个解析器应该已经完成​​了这项工作，但看起来第二个解析器被触发并且它失败了，因为它预计更长的年份。

任何帮助将不胜感激。干杯托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:44:18.993

所以看起来没有人有足够的兴趣来回答，所以我不得不自己想办法:-)。我应该在 JavaDoc 中向下滚动一点，我应该很快就会得到答案。还有另一个[appendTwoDigitYear](http://joda-time.sourceforge.net/apidocs/src-html/org/joda/time/format/DateTimeFormatterBuilder.html#line.868)方法可以完成我所追求的工作。

所以这是我现在使用的代码

```
DateTimeFormatter formatter = new DateTimeFormatterBuilder().appendDayOfMonth(1).appendLiteral("/").appendMonthOfYear(1).appendLiteral("/").appendTwoDigitYear(pivotYear, true).toFormatter().withLocale(new Locale("en", "NZ"));
DateMidnight birthDate = new DateMidnight(formatter.parseDateTime(dateOfBirth)); 
```

希望它会在未来对某人有所帮助。

干杯托马斯

# grails - 添加自定义 grails 配置辅助方法？

> ID：15939941
> 
> 赞同：1
> 
> 时间：2013-04-11T02:55:04.880
> 
> 标签：grails, methods, configuration, groovy

我的 BuildConfig.groovy 中有一个配置参数，需要我为每个插件放入很多目录。我喜欢创建一个简单的方法来为我生成所有这些目录。我知道 groovy 配置文件是 groovy 代码，但我似乎找不到与创建辅助方法的首选方法相关的任何信息。（例如 mavenRepo、grailsPlugins()、grailsHome() 等）。如果我想创建自己的辅助方法，我应该把它放在哪里，这样我就可以这样调用它：

```
someProperty = myHelperMethod() 
```

**有点更新**。我直接在我的 BuildConfig.groovy 文件中编写了这个方法并且它有效！但我想把它搬出去，更好地组织起来。如何编写这样的方法并将它们公开给像 BuildConfig.groovy 这样的配置文件？

```
def pluginDirs() {
   List dirs = []
   String trash = "[:]/"
   grails.plugin.location.each() { name, plugin ->
       if( plugin.startsWith(trash) ) {
           plugin = plugin.substring(trash.length())
       }
       dirs << "${plugin}/src/groovy" <<
               "${plugin}/grails-app/controllers" <<
               "${plugin}/grails-app/domain" <<
               "${plugin}/grails-app/services" <<
               "${plugin}/grails-app/taglib" <<
               "${plugin}/grails-app/utils"
   }
   return dirs
} 
```

额外的信用：其中一些插件使用 ${basedir} 来定义它们的路径，但是当我运行我的脚本之一时 ${basedir} 没有定义它会将 [:] 垃圾放在我的 URL 中。这就是为什么那个丑陋的代码在那里。

# jquery - 从 ASP.NET MVC 返回 null 时，jQuery post JSON 失败

> ID：15939944
> 
> 赞同：17
> 
> 时间：2013-04-11T02:55:10.737
> 
> 标签：jquery, ajax, asp.net-mvc, json, null

我使用[ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)从 jQuery 发布 JSON，并使用这个小库函数返回一些 JSON：

```
(function($) {
    $.postJson = function(url, data) {
        return $.ajax({
            url: url,

            data: JSON.stringify(data),
            type: 'POST',
            dataType: 'json',
            contentType: 'application/json; charset=utf-8'
        });
    };
})(jQuery); 
```

所以很明显我会这样称呼它：

```
$('#button').click(function() {
    $.postJson('/controller/action', { Prop1: 'hi', Prop2: 'bye' })
    .done(function(r) { alert('It worked.'); })
    .fail(function(x) { alert('Fail! ' + x.status); });
}); 
```

ASP.NET MVC 3 和 ASP.NET MVC 4 支持事物的提交方面（在此之前您需要扩展 ASP.NET MVC 以处理提交 JSON），但我遇到的问题是返回。在控制器上，我经常返回 null 基本上是说“成功，没什么好说的”，例如：

```
[HttpPost]
public JsonResult DoSomething(string Prop1, string Prop2)
{
    if (doSomething(Prop1, Prop2)
        return Json(null); // Success

    return Json(new { Message = "It didn't work for the following reasons" });
} 
```

我经常使用这种模式，它工作正常——我的成功/完成回调被调用，一切都很好。但是最近我升级了 ASP.NET MVC 和 jQuery，但它停止工作了——相反，每当我`return Json(null);`. 此外，我检查了响应，返回的 statusCode 实际上是 200，所以服务器没有失败 - jQuery 只是说它是。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-11T02:55:10.737

该问题是由从 jQuery 1.8 升级到 1.9 引起的。在 jQuery 1.7 和 1.8 中，这在 MVC 中：

```
return Json(null); 
```

被接受为有效的 JSON 并解释为 null。从技术上讲，这会使用 HTTP 200 向客户端发送一个空白字符串，这对于 jQuery <1.9 来说已经足够了。

但是现在（我们使用的是 jQuery 1.9.1），它尝试将空字符串解析为 JSON，jQuery 的 JSON 解析器在空字符串上抛出异常，并触发一个以`fail()`回调结尾的代码链。

一种解决方法是在成功时将其从服务器传回，而无需其他信息：

```
return Json(new{}); 
```

这通过了 jQuery 的 JSON 解析器的验证，一切都很好。这也有效：

```
return Json(true); 
```

# 更新

Musa 在 MVC 的这种行为下方指出似乎已被破坏。这个[单独的 Stack Overflow 回答*Using JSON.NET as the default JSON serializer in ASP.NET MVC 3 - 可能吗？*](https://stackoverflow.com/questions/7109967/using-json-net-as-default-json-serializer-in-asp-net-mvc-3-is-it-possible/7150912#7150912)涵盖如何让 MVC 返回 null `Json(null)`——基本上，使用 Json.NET 而不是 ASP.NET MVC 的内置 JSON 序列化程序。这是我最终使用的解决方案。

但是，您需要使用该答案的略微修改版本来解决此问题 - 代码如下。基本上，在传递给序列化之前不要包括`if`检查 null 的语句，否则你又回到了同样的困境中。

# 更新 2

Json.NET 中 ISO 8601 日期的默认实现在[尝试](http://en.wikipedia.org/wiki/Internet_Explorer_9)使用`new Date(...)`. 换句话说，这些在 Internet Explorer 9 中解析得很好：

```
var date = new Date('2014-09-18T17:21:57.669');
var date = new Date('2014-09-18T17:21:57.600'); 
```

但这会引发异常：

```
var date = new Date('2014-09-18T17:21:57.6'); 
```

Internet Explorer 9 的 Date() 实现只能处理三毫秒的位置。要解决此问题，您必须覆盖 Json.NET 日期格式以强制它。包含在下面的代码中。

```
public class JsonNetResult : JsonResult
{
    public override void ExecuteResult(ControllerContext context)
    {
        if (context == null)
            throw new ArgumentNullException("context");

        var response = context.HttpContext.Response;

        response.ContentType = !String.IsNullOrEmpty(ContentType) ? ContentType : "application/json";

        if (ContentEncoding != null)
            response.ContentEncoding = ContentEncoding;

        var settings = new JsonSerializerSettings
        {
            Converters = new[] {new IsoDateTimeConverter
            {
                DateTimeFormat = "yyyy'-'MM'-'dd'T'HH':'mm':'ss.fffK"
            }}
        };
        var jsonSerializer = JsonSerializer.Create(settings);

        jsonSerializer.Serialize(response.Output, Data);
    }
} 
```

演示如何将其绑定到 BaseController 的要点：

[https://gist.github.com/b9chris/6991b341e89bb0a4e6d801d02dfd7730](https://gist.github.com/b9chris/6991b341e89bb0a4e6d801d02dfd7730)

# dwolla - Dwolla反射器异地测试账户和支付活动

> ID：15939952
> 
> 赞同：1
> 
> 时间：2013-04-11T02:55:52.257
> 
> 标签：dwolla

使用异地测试账户（`Dwolla Reflector`），我能够获得由 表示的成功交易`status=Completed`。在测试模式下，我还得到了所有预期的结果，包括空的 transactionid、有效的签名、结帐 id 等。但是，我的帐户中根本没有付款活动。

反射器的文档没有指定是否使用测试模式。我的假设是测试帐户将处于测试模式，但也可以根据文档假设不应使用测试模式。

谁能澄清正确使用 Dwolla 反射器实际查看付款活动的条件？如果可能，我正在寻找所有必需的条件，例如，是否必须设置和验证有效的资金来源才能使用反射器并查看`Dwolla dashboard`. （或者也许指向我解决这个问题的文档？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T19:27:48.660

我最近刚刚针对 Dwolla API 和反射器服务进行了编码。假设您有自己的个人 dwolla 帐户，您可以[在此处生成一个代币来代表您](http://developers.dwolla.com/dev/token)。由于我不确定您使用的是什么语言，我将假设为 php。您现在很可能有这样的代码片段：

```
$Dwolla = new DwollaRestClient();
$Dwolla->setToken("<your personal generated token from above link>");
$trans_id = $Dwolla->send("<Your Personal 4 digit pin>", "812-713-9234", 0.01, "Dwolla", "My sample transaction detail notes");

if(!$trans_id) {
    echo "Error: {$Dwolla->getError()} \n";
} else {
    echo "Sent transaction ID: {$trans_id} \n";
} 
```

请注意，要使用此代码示例，您需要用适当的描述值替换 V 形包围的 2 个值。注意：您发送到的以“812-713-9234”表示的帐户是 dwolla 的反射器服务。

使用此代码示例，您将从自己的帐户向反射器服务发送一分钱。大约 10 分钟后，便士将退还到您的帐户。每次成功*都会*得到一个交易ID。如果不成功，您将收到错误代码。

如果有帮助，我第一次收到一个错误代码，其中包含关于无效 SSN 的信息。原来我已经有一段时间没有登录我的帐户了，我需要在 dwolla.com 上确认我的 SSN，但最初我认为这是一些错误，因为反射器服务设置不正确（因为它是假服务不会有与之关联的有效 SSN）。

我的理解是反射器服务纯粹是为了测试您的最终结果 - 而不是从收款人的角度验证反射器帐户内部的交易行项目详细信息。如果您查看 dwolla API 中的 send() 函数，它确实指定了您可以传递的所有变量是什么（这将告诉您事务将存储的数据级别和详细信息）。

至于您可以预期的特定错误代码，它们在错误代码部分（必要时扩展）下记录了含义：[https ://developers.dwolla.com/dev/docs/transactions/send](https://developers.dwolla.com/dev/docs/transactions/send)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T03:52:05.163

```
 After working with other payment networks it is hard not to make assumptions about Dwolla.  
    The TestMode=LIVE or TestMode=TEST.  One assumption being that a test account would allow you to 
    complete the entire test cycle. However this is not the case with Dwolla.  Here is what I found
    that addresses the exact requirements to use the Dwalla reflector account.

    1\. Developer Account Setup
    2\. Account must be  100% active and have valid funds
    3\. TestMode=LIVE
    4\. Amounts less than 10.00 (if you want to avoid fees)

    The Dwolla reflector account has nothing to do with TestMode and trying to set TestMode=TEST output unexpected
    results. (compared to other payment networks i've worked with).

    The cause, in my case was the funds had not yet cleared (account not 100%) and I thought the reflector account was a test account
    because the Dwolla documentation at https://developers.dwolla.com/dev/pages/testing  says it is a test account
    but makes no mention of the configuration setting of TestMode=Live.  A test account you would think would require
    test mode / environment. 
```

# java - 需要帮助以相反的顺序写数字

> ID：15939954
> 
> 赞同：3
> 
> 时间：2013-04-11T02:55:52.690
> 
> 标签：java

我需要一些帮助来完成我被分配的这项任务。不要求任何人做我的工作，但老实说，我真的坚持如何做到这一点。

我应该编写一个程序，提示用户输入 10 个数字，然后让它以相反的顺序写入所有数字。

示例：输入 10 个数字：23 89 21 55 67 89 99 13 98 78 逆序：78 98 13 99 89 67 55 21 89 23

到目前为止，我所拥有的只是如何获取用户输入。如果有人能把我推向正确的方向，我将不胜感激！

```
import java.util.*;

public class ReverseNumbers
{
public static void main(String[] args)
  {

    Scanner keyboard = new Scanner(System.in);

    int[] values;
    values = new int[10];

    //Ask the user to enter 10 integers
    System.out.println("Please enter 10 numbers:");
    for (int i = 0; i< values.length; i++) 
    {
      values[i] = keyboard.nextInt();
    }
    int[] reverseNums;
    reverseNums = new int[10];
    for (int i = (values.length -1); i>= 0; i--) 
    {
      reverseNums[ reverseNums.length -1 -i ] = values[ i ];
      System.out.println( reverseNums[ i ] );
    } 
 }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T03:02:06.280

如果您不想存储反转的值

```
 for (int i = (values.length -1); i>= 0; i--) 
    {       
      System.out.println( values[ i ] );
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T03:20:36.877

您的代码看起来很适合将输入读入`values`. 现在您可以反向循环该数组并打印值：

```
for (int i = 0; i < values.length; i++)
  System.out.println(values[values.length - i - 1]); 
```

想一想，从 10 - 0 - 1 = 9 开始打印。最后，`i == 0`从10 - 9 - 1 = 0 开始打印。`values[9]``i == 9``values[0]`

如您所见，不需要额外的`reverseNums`数组。

PS：如果你愿意，你可以合并`int[] values;`成`values = new int[10];`一行：`int[] values = new int[10];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T06:47:50.937

我认为您的代码正在正确创建数组。您只是按原始顺序打印出数字，因为您的第二个 for 循环正在向后迭代它们。您可以通过在最后一个循环之后添加以下语句来查看正确的结果：

```
System.out.println(java.util.Arrays.toString(reverseNums)); 
```

您还可以仅通过一次迭代执行完整的任务：

```
Scanner keyboard = new Scanner(System.in);

int[] reverseNums= new int[10];
System.out.println("Please enter 10 numbers:");
for (int i = 0; i< values.length; i++) {
  reverseNums[values.length -1 - i] = keyboard.nextInt();
}
System.out.println(java.util.Arrays.toString(reverseNums)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T02:58:45.933

使用 将整行作为字符串读取`Scanner.nextLine()`，然后使用 将其拆分为数组`String.split(" ");`。在此之后，您可以简单地从数组的末尾向后迭代并打印数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T03:00:18.063

如果这不是作业，那么为什么不尝试使用[http://commons.apache.org/proper/commons-lang/](http://commons.apache.org/proper/commons-lang/)库

```
ArrayUtils.reverse(int[] array) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-11T03:02:58.723

要反转它：

```
for (int i = 0; i < values.length; i++)
    reverseNums[values.length - i - 1] = values[i]; 
```

# copy - SlickEdit 17---为什么要自动复制

> ID：15939957
> 
> 赞同：0
> 
> 时间：2013-04-11T02:56:23.567
> 
> 标签：copy, selection, clipboard, slickedit

   我现在对 SE 关于自动复制功能的行为感到困惑。

    **首先**，当我双击任何单词时，该单词将被复制到剪贴板，但是我从未找到任何其他类似的编辑器。这实际上很烦人，尤其是当您想通过双击将一个单词粘贴到另一个单词时另一个词来选择它。

**    其次**，当我通过移动鼠标选择块时，选择区域会自动复制到剪贴板，这让我很郁闷，因为我选择块只是为了突出它而不是复制它。

    如您所见，这两个功能都与 SE 中的剪贴板有关。我实际上不认为它们是好的设计。或者有什么方法可以关闭这些功能，我将非常感谢在这里得到任何有用的建议。这里是我的电子邮件[ ***[hustwsh2011@gmail.com][1]*** ] 如果您愿意将答案发送到我的邮箱，也欢迎您在这里发布您的答案，以帮助其他对此问题感到困惑的人.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-27T09:48:48.153

```
_command paste_replace_whole_word_fixed(){
  // I assign this to A-DEL INS
  delete_full_word();
  paste();
} 
```

# c# - 在类似于 String 的 IndexOf() 的较大 byte[] 中寻找 byte[]？

> ID：15939958
> 
> 赞同：3
> 
> 时间：2013-04-11T02:56:36.393
> 
> 标签：c#, algorithm, search

假设我有一个大的`byte[]`，我不仅要查看是否，还要查看`byte[]`较大的数组中较小的位置。例如：

```
byte[] large = new byte[100];
for (byte i = 0; i < 100; i++) {
    large[i] = i;
}
byte[] small = new byte[] { 23, 24, 25 };

int loc = large.IndexOf(small); // this is what I want to write 
```

我想我问的是在更大的序列中寻找任何类型（原始或其他）的序列。

我隐约记得在字符串中阅读过有关此方法的特定方法，但我不记得算法的名称。我可以很容易地写出一些方法来做到这一点，但我知道有一个很好的解决方案，而且它就在我的舌尖上。如果有一些 .Net 方法可以做到这一点，我也会采用（尽管为了教育起见，我仍然很欣赏搜索算法的名称）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T03:09:00.913

您可以使用 LINQ 来完成，如下所示：

```
var res = Enumerable.Range(0, large.Length-1)
    .Cast<int?>()
    .FirstOrDefault(n => large.Skip(n.Value).Take(small.Length).SequenceEqual(small));
if (res != null) {
    Console.Println("Found at {0}", res.Value);
} else {
    Console.Println("Not found");
} 
```

除了以下部分外，该方法是不言自明的`Cast<int?>`：您需要它来决定在`large`返回零时在数组的初始位置找到结果，或者在返回时根本不找到结果`null`。

这是[关于 ideone 的演示](http://ideone.com/ub8mU7)。

上面的复杂性是`O(M*N)`, 其中`M`和`N`是`large`和`small`数组的长度。如果`large`数组很长，并且包含大量与 的长前缀匹配的“几乎正确”的子序列，`small`则最好实现搜索序列的高级算法，例如[*Knuth–Morris–Pratt (KMP)算法*](http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)。KMP 算法通过观察当发生不匹配时，序列包含足够的信息来加速搜索，即根据小序列中第一个不匹配的位置，`small`您可以在序列中移动多远。`large`准备了一个查找表`small`序列，然后在整个搜索过程中使用该表来决定如何推进搜索点。KMP 的复杂度为`O(N+M)`. 有关 KMP 算法的伪代码，请参阅上面链接的 Wikipedia 文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T03:05:15.683

你在想 Lambda 表达式吗？当你说一种更具体的字符串方法时，这就是我想到的。

[http://www.dotnetperls.com/array-find](http://www.dotnetperls.com/array-find)

# python - 在 python 烧瓶中使用 redis 实时发送消息

> ID：15939963
> 
> 赞同：4
> 
> 时间：2013-04-11T02:57:56.780
> 
> 标签：python, redis, flask, gevent

下面是一个将消息发送到浏览器的简单应用程序。如果有来自 redis 通道的新消息，它将被发送，否则以非阻塞方式发送最后一个已知值。但我做错了什么。有人可以帮我理解吗

```
from gevent import monkey, Greenlet
monkey.patch_all()

from flask import Flask,render_template,request,redirect,url_for,abort,session,Response,jsonify

app = Flask(__name__)

myglobaldict = {'somedata':''}

class RedisLiveData:
    def __init__(self, channel_name):
        self.channel_name = channel_name
        self.redis_conn = redis.Redis(host='localhost', port=6379, db=0)
        pubsub = self.redis_conn.pubsub()
        gevent.spawn(self.sub, pubsub)
    def sub(self,pubsub):
        pubsub.subscribe(self.channel_name)
        for message in pubsub.listen():
            gevent.spawn(process_rcvd_mesg, message['data'])

def process_rcvd_mesg(mesg):
    print "Received new message %s " % mesg
    myglobaldict['somedata'] = mesg

g = RedisLiveData("test_channel")

@app.route('/latestmessage')
def latestmessage():
    return Response(myglobaldict,mimetype="application/json")

if __name__ == '__main__':
    app.run() 
```

在 javascript 方面，我只是使用简单的 $.ajax get 来查看消息。但`http://localhost:5000/latestmessage`即使在 redis 更新之后，客户端也会收到旧消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T03:49:26.403

应该是缓存问题。

`http://localhost:5000/latestmessage?t=timestamp`您可以为从 ajax 发送的请求添加时间戳或随机数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T13:56:36.923

我建议您使用 POST 而不是 GET 作为 http 方法，您可以消除缓存问题和浏览器（如 chrome）的一些烦人行为，其中第一个请求之后的请求将等待第一个完成后再发送到网络服务器。

如果要保留 GET 方法，则可以要求 jquery 使用设置参数缓存使浏览器无法缓存请求

```
$.ajax(..., {cache:false}) 
```

# php - 使用选择 PHP 和 MySQL 更新多行

> ID：15939968
> 
> 赞同：0
> 
> 时间：2013-04-11T02:58:12.920
> 
> 标签：php, mysql, select

下面是我试图在多行中更改一列的值的代码，但我有点卡住了。

**文件 1**：

```
<form name="update-location" method="post" action="recibos_location_update.php">

<div align="right"><button type="submit">Actualizar Estado</button></div>
<hr />

<ul>
    <?php
        $get_logs = mysql_query("SELECT * FROM recibos ORDER BY id DESC");
        while ($logs = mysql_fetch_array($get_logs)){

        $serial = $logs['serial'];
        $check = $logs['location'];
        $problem = $logs['problem'];
    ?>

    <li class="<?php 
        if ($check == $location1){echo 'recibos-container-shop-li';}
        if ($check == $location2){echo 'recibos-container-haji-li';}
        if ($check == $location3){echo 'recibos-container-return-li';} ?>">

        <?php echo $serial . " | " . $logs['model'] . " | " . $problem; ?>

        <div align="right">
            <?php
                if ($check != 'Returned'){
            ?>
                <input type="hidden"  name="serial[]" value="<?php echo $serial; ?>" />
                <select name="location">
                    <option <?php if ($check == $location1){echo 'selected';} ?> value="<?php echo $location1; ?>" style="background: #fff8bf;">Mobils Calfont</option>
                    <option <?php if ($check == $location2){echo 'selected';} ?> value="<?php echo $location2; ?>" style="background: #ffc1bf;">Haji Jorda</option>
                    <option <?php if ($check == $location3){echo 'selected';} ?> value="<?php echo $location3; ?>"style="background: #ecffbf;">Devuelto</option>
                </select>
            <?php
            }
            else {
                echo "<i><font color='#5e8029'>Devuelto</font></i>";
            }
            ?>
        </div>
    </li>
    <?php } ?>
</ul> 
```

**文件 2**

```
<?php
include "connect.php";
include "links.php";

foreach($_POST["serial"] as $serial){

    $location = $_POST['location'];
    echo $location . " " . $serial . "<br>";
}
mysql_query("UPDATE recibos SET location='$location' WHERE serial='$serial'");

//header("Location: " . $_SERVER['HTTP_REFERER']); 
```

?>

我得到的输出是：

```
Haji 900005
Haji 900004
Haji 900002 
```

但是对于所有 3 个输出行，它应该给出不同的名称，因为 3 个选择框中的名称不同。

我需要的是流程表单使用选择框选项中包含的值更新每一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T07:15:25.923

html

```
<select name="location[]"> 
```

php

```
foreach($_POST["serial"] as $k=> $serial){

    $location = $_POST['location'][$k];
    mysql_query("UPDATE recibos SET location='$location' WHERE serial='$serial'");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T06:36:01.513

```
foreach($_POST["serial"] as $serial){

    $location = $_POST['location'];
    echo $location . " " . $serial . "<br>";
    mysql_query("UPDATE recibos SET location='$location' WHERE serial='$serial'");//update
}
//    mysql_query("UPDATE recibos SET location='$location' WHERE serial='$serial'"); 
```

# javascript - 对象丢弃时布尔数组未定义？

> ID：15939975
> 
> 赞同：0
> 
> 时间：2013-04-11T02:59:12.060
> 
> 标签：javascript, jquery-ui-droppable

我有一些拖动对象和放置对象的数组，这里：

```
var elmDragObj = ["#ob01","#ob02","#ob03","#ob04","#ob05","#ob06","#ob07","#ob08","#ob09","#ob10","#ob11","#ob12","#ob13","#ob14","#ob15","#ob16","#ob17","#ob18","#ob19","#ob20"];

var elmDropObj = ["#va_kb_a","#va_ks_a","#va_kk_a","#dk_kb_a","#dk_kb_b","#dk_ks_a","#pr_kb_a","#rv_kb_a","#rv_kb_b","#rv_kb_c","#pr_ks_a","#rv_ks_a","#rv_ks_b","#rv_ks_c","#vl_kb_a","#vl_ks_a","#vl_kk_a","#vk_kb_a","#vk_ks_a","#vk_kk_a"]; 
```

我有一个布尔数组来检查所有对象何时被放置在它的位置，这里：

```
var elmBool = [false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]; 
```

当我想检查布尔值时，它是未定义的，脚本如下：

```
for(var j=0; j<elmDragObj.length; j++){
        $(elmDragObj[j]).draggable({revert:"invalid"});

        $(elmDropObj[j]).droppable({
            accept: elmDragObj[j],
            drop: function( event, ui ) {
                alert(elmBool[j]);
            }
        });
    } 
```

我做错什么了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T03:02:29.640

是因为那个时候...

```
alert(elmBool[j]); 
```

... 运行，`j`现在超出了您的数组的范围（它将等于`elmDragObj.length`）。

最简单的解决方案是简单地使用`$.each()`：

```
$.each(elmDragObj, function(j, sel) {
    $(sel).draggable({ revert: 'invalid' });

    $(elmDropObj[j]).droppable({
        accept: sel,
        drop: function(event, ui) {
            alert(elmBool[j]);
        }
    });
}); 
```

如果您真的想使用`for`循环，可以这样做，但您需要“锁定”`j`闭包中的值：

```
for(var j=0; j<elmDragObj.length; j++){
    $(elmDragObj[j]).draggable({revert:"invalid"});

    $(elmDropObj[j]).droppable({
        accept: elmDragObj[j],
        drop: (function() {
            var index = j;
            return function(event, ui) {
                alert(elmBool[index]);
            };
        })()
    });
} 
```

不过，显然这不像第一种方法那样对开发人员友好，所以我的建议肯定是使用`$.each()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T03:01:33.060

问题是变量 j 在调用函数时无效。您已经运行了循环并且 j 无效，它已经递增到数组的末尾。

# c - Mongodb C 驱动程序与我的程序

> ID：15939976
> 
> 赞同：1
> 
> 时间：2013-04-11T02:59:16.563
> 
> 标签：c, mongodb

我从 github.com 下载了 Mongodb-c-driver，并且编译它没有问题，但是，当我尝试编译我的 C 程序时，出现了问题：

```
testmongo.c:(.text+0x20): undefined reference to 'mongo_client'
testmongo.c:(.text+0x80): undefined reference to 'mongo_destroy' 
```

我已经在 ldconfig 中链接了 mongodb 库，但是，这种情况并没有改变......

```
#include <stdio.h>
#include <mongo.h>

int main() {
  mongo conn[1];
  int status = mongo_client( conn, "127.0.0.1", 27017 );

  if( status != MONGO_OK ) {
      switch ( conn->err ) {
        case MONGO_CONN_NO_SOCKET:  printf( "no socket\n" ); return 1;
        case MONGO_CONN_FAIL:       printf( "connection failed\n" ); return 1;
        case MONGO_CONN_NOT_MASTER: printf( "not master\n" ); return 1;
      }
  }

  mongo_destroy( conn );

  return 0;
} 
```

有人可以帮忙吗？非常感谢 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:12:53.090

我想我应该将此作为答案提交，直到提供更多信息。直觉上，你可能会`-lmongoclient`从你的 gcc 命令中丢失。

```
gcc -o myprog -lmongoclient source.c 
```

# c++ - C++ - 为性能和封装构造常量数据的方法有哪些？

> ID：15939979
> 
> 赞同：2
> 
> 时间：2013-04-11T02:59:30.347
> 
> 标签：c++, templates, global-variables, structure, constants

很长一段时间以来，我编写的代码中定义了一些程序范围的常量，例如`constants.h`：

```
const size_t kNumUnits = 4;
const float kAlpha = 0.555;
const double kBeta = 1.2345; 
```

这种方法的问题在于，在分配固定内存块或遍历循环时，这些信息通常在较低级别的代码中需要，因此这些单元必须 #include this common `constants.h`，或者需要传入相关值当这些函数被调用时，接口的值在运行时从不改变，并损害了编译器的优化能力。

此外，让所有这些较低级别的代码依赖于一些常量的顶级定义标头对我来说似乎是一种难闻的气味。太像*全局变量了*，即使它们都是不变的。这使得编写可重用代码变得困难，因为需要引用一个或多个常量的每个组件都必须包含公共标头。将一堆组件汇集在一起​​时，必须手动创建和维护此标头。两个或多个组件可以使用相同的常量，但它们都不能自己定义它，因为它们都必须在每个程序中使用相同的值（即使程序之间的值不同），因此都需要#include 这个高级头文件以及它碰巧提供的所有其他常量 - 不适合封装。这也意味着组件不能“独立”使用，因为它们需要标头定义才能工作，但如果它们将它们包含在可重用文件中，则需要在将组件引入主项目时手动删除它们。这导致程序特定的组件头文件混乱，每次在新程序中使用组件时都需要手动修改这些头文件，而不是简单地从客户端代码中获取指令。

另一种选择是通过构造函数或其他成员函数在运行时提供相关常量。但是，处理性能对我来说很重要——我有一堆类，它们都在*编译时指定的固定大小*的数组（缓冲区）上运行。目前，这个大小要么取自 in 中的常量`constants.h`，要么在运行时作为函数参数传递给对象。我一直在做一些实验，将数组大小指定*为非类型模板参数*或`const`变量，看起来编译器可以生成更快的代码，因为循环大小在编译时是固定的，并且可以更好地优化。这两个功能很快：

```
const size_t N = 128;  // known at compile time
void foo(float * buffer) {
  for (size_t i = 0; i < N; ++i) {
    buffer *= 0.5f;
  }
}

template <size_t N>  // specified at compile time
void foo(float * buffer) {
  for (size_t i = 0; i < N; ++i) {
    buffer *= 0.5f;
  }
} 
```

与纯粹的运行时版本相反，因为 N 在编译时未知，所以不能很好地优化：

```
void foo(float * buffer, size_t N) {
  for (size_t i = 0; i < N; ++i) {
    buffer *= 0.5f;
  }
} 
```

在编译时使用*非类型模板参数*传递此信息与#include 全局常量文件及其所有定义具有相同的性能结果`const`，但它更好地封装并允许暴露特定信息（仅此而已）到需要它的组件。

所以我想在声明类型时传入 N 的值，但这意味着我的所有代码都变成了模板化代码（以及将代码移动到 .hpp 文件所需要的）。而且似乎只允许整数非类型参数，所以我不能以这种方式传递浮点数或双精度常数。这是不允许的：

```
template <size_t N, float ALPHA>
void foo(float * buffer) {
  for (size_t i = 0; i < N; ++i) {
    buffer[i] *= ALPHA;
  }
} 
```

所以我的问题是处理这个问题的最佳方法是什么？人们如何倾向于组织他们的程序范围的常量以减少耦合，同时仍然获得编译时指定常量的好处？

编辑：

这是使用类型来保存常量值的东西，因此能够通过使用模板参数将它们向下传递。常量参数在`System`结构中定义，并提供给较低层`foo`并`bar`作为同名`System`模板参数：

在顶层：

```
#include "foo.h"

struct System {
  typedef size_t buffer_size_t;
  typedef double alpha_t;

  static const buffer_size_t buffer_size = 64;
  //  static const alpha_t alpha = 3.1415;  -- not valid C++?
  static alpha_t alpha() { return 3.1415; } -- use a static function instead, hopefully inlined...
};

int main() {
  float data[System::buffer_size] = { /* some data */ };
  foo<System> f;
  f.process(data);
} 
```

在 foo.h 中，在中间层：

```
// no need to #include anything from above
#include "bar.h"
template <typename System>
class foo {
public:
  foo() : alpha_(System::alpha()), bar_() {}

  typename System::alpha_t process(float * data) {
    bar_.process(data);
    return alpha_ * 2.0;
  }
private:
  const typename System::alpha_t alpha_;
  bar<System> bar_;
}; 
```

然后在“底部”的 bar.h 中：

```
// no need to #include anything 'above'
template <typename System>
class bar {
public:
  static const typename System::buffer_size_t buffer_size = System::buffer_size;
  bar() {}
  void process(float * data) {
    for (typename System::buffer_size_t i = 0; i < System::buffer_size; ++i) {
      data[i] *= static_cast<float>(System::alpha());  -- hopefully inlined?
    }
  }
}; 
```

这确实有一个明显的缺点，就是将我未来的很多（全部？）代码转换为带有“系统”参数的模板，以防它们需要引用一个常量。它也很冗长且难以阅读。但它确实消除了对头文件的依赖，因为 foo 和 bar 不需要预先了解有关 System 结构的任何信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T03:13:59.037

您的大量描述激发了您为什么需要这些常量全局并首先在所有地方使用。*如果许多模块真的*需要这些信息，我想我只是不认为它是一种糟糕的代码气味。这显然是重要的信息，所以这样对待它。把它藏起来，把它散开或者（太糟糕了！）把它放在不止一个地方，似乎是为了它而改变。添加模板等似乎是额外的复杂性和开销。

需要考虑的几点：

*   确保您使用的是预编译的头文件，并且它`common.h`在那里
*   尝试`common.h`仅包含在实现文件中，并且仅包含在真正需要的地方
*   确保仔细管理这些符号的可见性；不要在每个范围内公开常量，以防万一它们可能需要

另一个想法（受@Keith 上面的评论启发）是你可能想要考虑你的分层。例如，如果您有多个组件，每个组件在理想情况下都应该是自包含的，那么您可以拥有这些常量的本地版本，它们恰好是从这些全局常量初始化的。这样可以大大减少耦合并提高局部性/可见性。

例如，主组件可以有自己的接口：

```
// ProcessWidgets.h
class ProcessWidgets
{
    public:
        static const float kAlphaFactor;
    // ...
}; 
```

并在其实施中本地化：

```
// ProcessWidgets.cpp

#include "Common.h"

static const float ProcessWidgets::kAlphaFactor = ::kAlpha; 
```

然后该组件中的所有代码仅引用`ProcessWidgets::kAlphaFactor`.

# xmpp - 通过 Mule ESB CE 连接 Ejabbered

> ID：15939980
> 
> 赞同：0
> 
> 时间：2013-04-11T02:59:35.977
> 
> 标签：xmpp, mule, ejabberd

我尝试将 Ejabberd 服务器放在 Mule ESB 社区版的后面，这意味着所有发往 Ejabberd 服务器的消息都必须首先发送到 ESB。

我在文档中使用了 xmpp 连接器，如下 xml 配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:spring="http://www.springframework.org/schema/beans"
  xmlns:xmpp="http://www.mulesoft.org/schema/mule/xmpp"
  xmlns:stdio="http://www.mulesoft.org/schema/mule/stdio"
  xsi:schemaLocation="
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
    http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.1/mule.xsd
    http://www.mulesoft.org/schema/mule/xmpp http://www.mulesoft.org/schema/mule/xmpp/3.1/mule-xmpp.xsd
    http://www.mulesoft.org/schema/mule/stdio http://www.mulesoft.org/schema/mule/stdio/3.1/mule-stdio.xsd">

    <xmpp:connector name="xmppConnector" host="192.168.1.132" port="5222" user="whh@whh.com" password="password"/>

    <flow name="stdio2xmpp">
        <stdio:inbound-endpoint system="IN"/>
        <xmpp:outbound-endpoint type="CHAT" recipient="sjc@whh.com"/>
    </flow>

    <flow name="xmpp2stdio">
        <xmpp:inbound-endpoint type="CHAT" from="sjc@whh.com"/>
        <xmpp:xmpp-to-object-transformer/>
        <stdio:outbound-endpoint system="OUT"/>
    </flow>
</mule> 
```

我确定用户名和密码是正确的，因为我可以使用 Pidgin 登录服务器。当我尝试在工作室中运行此流程时，它总是抛出“未连接到服务器”异常。

```
Exception in thread "main" org.mule.module.launcher.DeploymentStartException: IllegalStateException: Not connected to server. 
        at org.mule.module.launcher.application.DefaultMuleApplication.start(DefaultMuleApplication.java:174) 
        at org.mule.module.launcher.application.ApplicationWrapper.start(ApplicationWrapper.java:107) 
        at org.mule.module.launcher.DefaultMuleDeployer.deploy(DefaultMuleDeployer.java:47) 
        at org.mule.tooling.server.application.ApplicationDeployer.run(ApplicationDeployer.java:56) 
        at org.mule.tooling.server.application.ApplicationDeployer.main(ApplicationDeployer.java:88) 
        Caused by: org.mule.retry.RetryPolicyExhaustedException: Not connected to server. 
        at org.mule.retry.policies.AbstractPolicyTemplate.execute(AbstractPolicyTemplate.java:105) 
        at org.mule.transport.AbstractConnector.connect(AbstractConnector.java:1616) 
        at org.mule.transport.AbstractConnector.start(AbstractConnector.java:428) 
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) 
        at java.lang.reflect.Method.invoke(Unknown Source) 
        at org.mule.lifecycle.phases.DefaultLifecyclePhase.applyLifecycle(DefaultLifecyclePhase.java:225) 
        at org.mule.lifecycle.RegistryLifecycleManager$RegistryLifecycleCallback.onTransition(RegistryLifecycleManager.java:276) 
        at org.mule.lifecycle.RegistryLifecycleManager.invokePhase(RegistryLifecycleManager.java:155) 
        at org.mule.lifecycle.RegistryLifecycleManager.fireLifecycle(RegistryLifecycleManager.java:126) 
        at org.mule.registry.AbstractRegistryBroker.fireLifecycle(AbstractRegistryBroker.java:80) 
        at org.mule.registry.MuleRegistryHelper.fireLifecycle(MuleRegistryHelper.java:120) 
        at org.mule.lifecycle.MuleContextLifecycleManager$MuleContextLifecycleCallback.onTransition(MuleContextLifecycleManager.java:94) 
        at org.mule.lifecycle.MuleContextLifecycleManager$MuleContextLifecycleCallback.onTransition(MuleContextLifecycleManager.java:90) 
        at org.mule.lifecycle.MuleContextLifecycleManager.invokePhase(MuleContextLifecycleManager.java:72) 
        at org.mule.lifecycle.MuleContextLifecycleManager.fireLifecycle(MuleContextLifecycleManager.java:64) 
        at org.mule.DefaultMuleContext.start(DefaultMuleContext.java:250) 
        at org.mule.module.launcher.application.DefaultMuleApplication.start(DefaultMuleApplication.java:151) 
        ... 4 more 
        Caused by: java.lang.IllegalStateException: Not connected to server. 
        at org.jivesoftware.smack.XMPPConnection.addPacketListener(XMPPConnection.java:747) 
        at org.jivesoftware.smackx.ServiceDiscoveryManager.init(ServiceDiscoveryManager.java:270) 
        at org.jivesoftware.smackx.ServiceDiscoveryManager.(ServiceDiscoveryManager.java:80) 
        at org.jivesoftware.smackx.ServiceDiscoveryManager$1.connectionCreated(ServiceDiscoveryManager.java:66) 
        at org.jivesoftware.smack.XMPPConnection.initConnection(XMPPConnection.java:957) 
        at org.jivesoftware.smack.XMPPConnection.connectUsingConfiguration(XMPPConnection.java:904) 
        at org.jivesoftware.smack.XMPPConnection.connect(XMPPConnection.java:1415) 
        at org.mule.transport.xmpp.XmppConnector.connectToJabberServer(XmppConnector.java:137) 
        at org.mule.transport.xmpp.XmppConnector.doConnect(XmppConnector.java:84) 
        at org.mule.transport.AbstractConnector$5.doWork(AbstractConnector.java:1556) 
        at org.mule.retry.policies.AbstractPolicyTemplate.execute(AbstractPolicyTemplate.java:67) 
        ... 22 more 
```

有人对这个问题有想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T01:01:14.597

mule 它建立在 Smack 之上，在建立连接时可能会遇到问题。

您可以验证 xmpp 服务器是否已启动？一旦你知道它继续调试 Smack。Smack connection init 只捕获可能抛出的异常子集。例如，它会忽略 NPE 并在 OK 中声明该连接。它也不是线程安全的，所以原型只有一个到 xmpp 服务器的连接。

# java - 如何在客户端 WebsphereMQ 中设置 MQMD 消息上下文？

> ID：15939989
> 
> 赞同：1
> 
> 时间：2013-04-11T03:00:37.137
> 
> 标签：java, jms, ibm-mq

我应该在客户端 WebsphereMQ 的哪里设置 MQMD 消息上下文？

```
MQQueueConnectionFactory mqConnectionFactory = new MQQueueConnectionFactory();
mqConnectionFactory.setHostName(producerProperties.getProperty("wmq.host"));
mqConnectionFactory.setPort(Integer.valueOf(producerProperties.getProperty("wmq.port")));
mqConnectionFactory.setTransportType(JMSC.MQJMS_TP_CLIENT_MQ_TCPIP);
mqConnectionFactory.setQueueManager(producerProperties.getProperty("wmq.manager"));
mqConnectionFactory.setChannel("MyChannel");

/**
 * Producer Section
 */
// Getting producer connection from the MQ server and starting it
Connection producerConnection = mqConnectionFactory.createConnection();
System.out.println("Going to start the producer connection...");
producerConnection.start();

// JMS messages are sent and received using a Session.
Session producerSession = producerConnection.createSession(false,
        Session.AUTO_ACKNOWLEDGE);
// Destination represents here our queue(testQ) on the MQ server.
Destination producerDestination = producerSession.createQueue(producerProperties.getProperty("wmq.queue.name"));

// MessageProducer is used for sending messages
MessageProducer producer = producerSession.createProducer(producerDestination1);
//create text message going to send

TextMessage sendingMessage = producerSession.createTextMessage("Hi Welcome");
sendingMessage.setJMSType(queueName);
System.out.println("Sending the message...");

//sending the message
producer.send(sendingMessage); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:15:24.543

请参阅示例程序。如果您安装到 Windows 上的默认位置，它位于：

```
"C:\Program Files (x86)\IBM\WebSphere MQ\tools\jms\samples\simple\SimpleMQMDWrite.java" 
```

或者在 *NIX 平台上：

```
/opt/mqm/samp/jms/samples/simple/SimpleMQMDWrite.java 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-11T14:50:31.443

转至 WMQ 信息中心并查找 JMSX* 和 JMS_IBM_* 选择器。

# java - 在排序的 LinkedList 中添加元素

> ID：15939992
> 
> 赞同：1
> 
> 时间：2013-04-11T03:00:49.090
> 
> 标签：java, recursion, linked-list

我有一个`ListElement`对象的 LinkedList，我想创建一个**递归**方法来添加新节点，同时仍保留列表的排序顺序。

现在我有：

```
public static ListElement InsertList(ListElement head, ListElement newelem) {

    if (head == null) {
        head = newelem;
        head.next = null;
    } 
    else if (head.next == null) {
        newelem.next = null;
        head.next = newelem;
    }
    else if (head.value < newelem.value) {
        newelem.next = head;
        head = newelem;
    }
    else if (head.value >= newelem.value) {
        head = head.next;
        return InsertList(head, newelem);
    }
    return head;
} 
```

我用代码多次调用它：

```
ListElement head = null;
ListElement elem;

// this block of code is repeated multiple times with values of 3, 8, 20, and 15
elem - new ListElement();
elem.value = 6;
head = InsertList( head, elem ); 
```

输出如下：

```
6
6 3
8 6 3
20 8 6 3
15 8 6 3 
```

这个输出对于前三行是正确的，但之后就变得很奇怪了。谁能改进我的算法？我觉得这个`InsertList`方法可以缩短很多。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T03:09:48.623

第四个条件块中的`head = head.next`语句正在破坏`head`元素。我相信这应该是

```
else if(head.value >= newelem.value) {
    head.next = InsertList(head.next, newelem);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T03:15:35.323

当您尝试插入 15 时，您输入了第 4 个条件：

```
// 20 > 15
else if (head.value >= newelem.value) 
```

依次调用 InsertList 但将 8 作为头节点传递，因此进入第 3 个条件：

```
// 8 < 15
else if (head.value < newelem.value) 
```

在这里，你说

```
newelem.next = head; 
```

设置 15 -> 下一个 = 8

然后你说，

```
head = newelem; 
```

设置 head = 15。

你看到问题了吗？使用@Zim-Zam O'Pootertoot 答案来修复您的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T03:15:37.893

感谢所有帮助和回答的家伙！
我发现了另一篇与我类似的帖子，其中一个答案似乎对我有用。
这是任何希望看到的人的链接：[https ://stackoverflow.com/a/15936744/1470257](https://stackoverflow.com/a/15936744/1470257)

# java - 将标签设置为在动作侦听器中可见

> ID：15939997
> 
> 赞同：0
> 
> 时间：2013-04-11T03:01:14.890
> 
> 标签：java, swing, actionlistener

我有一个带有按钮的 JFrame。当用户按下按钮时，会执行一系列耗时的动作。我在表单上有一个 JLabel，上面写着“请稍候”，我希望在执行操作时变得可见，然后在它们完成时不可见。所以，我把`label.setVisible(true)`动作侦听器放在开头和`label.setVisible(false)`结尾，但什么也没发生。

似乎标签的显示正在排队等待操作完成，因此它只是可见，然后立即不可见。在继续操作侦听器中的其余代码之前，如何确保标签可见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T03:07:04.323

使用[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)。单击按钮时调用[execute](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html#execute%28%29)。更新`JLabel`完成[后](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html#done%28%29)。

# sql - if else sql server 2008的存储过程

> ID：15939998
> 
> 赞同：3
> 
> 时间：2013-04-11T03:01:03.817
> 
> 标签：sql, sql-server-2008, tsql, stored-procedures

我有 3 个表，我必须检查祖父表 id 是否有孙表中的记录。如果是，则返回是，否则返回否。这是我的存储过程。我收到了不正确的语法错误。我是存储过程的新手。请帮我。

```
CREATE PROCEDURE P_Check
   @PKG_ID INT,
   @S_ID INT,
   @FLAG VCHAR(10) OUT

   DECLARE IDS CURSOR LOCAL FOR SELECT S_ID FROM T1 WHERE P_ID = @PKG_ID
   OPEN IDS
   FETCH NEXT FROM IDS into @S_ID

   WHILE @@FETCH_STATUS = 0
   BEGIN
      SELECT * FROM T2 WHERE S_ID = @S_ID

      IF @@ROWCOUNT<>0
         @FLAG = 'YES'
         RETURN 
      ELSE
         @FLAG = 'NO'

      FETCH NEXT FROM IDS into @S_ID
   END

   CLOSE IDS
   DEALLOCATE IDS 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T03:05:54.443

需要检查的几件事：

1.  我认为`vchar`SQL Server 中没有数据类型，除非那是您的自定义类型。所以改成`varchar`
2.  你忘了`AS`
3.  您可能希望将您的逻辑包含`if`在两者`begin`之间`end`

您可以编译的代码：

```
CREATE PROCEDURE P_Check
    @PKG_ID INT,
    @S_ID INT,
    @FLAG VARCHAR(10) OUT
AS
    DECLARE IDS CURSOR LOCAL FOR SELECT S_ID FROM T1 WHERE P_ID = @PKG_ID
    OPEN IDS
    FETCH NEXT FROM IDS into @S_ID
    WHILE @@FETCH_STATUS = 0

    BEGIN
      SELECT * FROM T2 WHERE S_ID = @S_ID
      IF @@ROWCOUNT<>0
      BEGIN
         SET @FLAG = 'YES'
         RETURN 
      END
      ELSE
      BEGIN
         SET @FLAG = 'NO'
         FETCH NEXT FROM IDS into @S_ID
      END
    END

    CLOSE IDS
    DEALLOCATE IDS 
```

但是，我认为您的光标不会在您返回此处时关闭`IF @@ROWCOUNT<>0`。我认为你应该做的是改变这个：

```
IF @@ROWCOUNT<>0
BEGIN
    SET @FLAG = 'YES'
    RETURN 
END 
```

对此：

```
IF @@ROWCOUNT<>0
BEGIN
    SET @FLAG = 'YES'
    GOTO ON_EXIT
END 
```

然后像这样结束你的程序：

```
ON_EXIT:
    CLOSE IDS
    DEALLOCATE IDS 
```

然后在评论中回答你的问题，你已经在某种意义上“回归”了它。您可以像这样调用和测试您的程序：

```
declare @result varchar(10)
exec P_Check 1, 1, @result out
print @result 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T05:01:38.913

这太复杂了，在这里完全不需要也完全没有必要使用光标。

将您的程序简化为：

```
CREATE PROCEDURE P_Check
   @PKG_ID INT,
   @S_ID INT,
   @FLAG CHAR(1) OUT
AS BEGIN
   IF EXISTS (SELECT * FROM T2 
              INNER JOIN T1 ON T2.S_ID = T1.S_ID WHERE P_ID = @PKG_ID)
      SET @FLAG = 'Y'
   ELSE
      SET @FLAG = 'N'
END 
```

认真使用 SQL Server 时，您需要摆脱使用游标和循环**的逐行、痛苦**的程序化思维，并且需要开始**以集合方式思考**以提高效率和生产力。