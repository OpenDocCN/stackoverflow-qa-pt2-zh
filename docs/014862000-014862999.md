# StackOverflow 问答 14862000-14862999

# c# - 为什么“2013 年 2 月 13 日”的日期时间解析失败？

> ID：14862000
> 
> 赞同：-5
> 
> 时间：2013-02-13T20:00:05.160
> 
> 标签：c#, parsing, datetime

我正在尝试将字符串“02/13/2013”​​解析为日期时间，但它不起作用。（它没有将 dt 设置为 dtResult 的值，因为 tryprase 没有通过。

这是我正在做的事情：

```
DateTime dtResult;

var dt = DateTime.MinValue;
if (DateTime.TryParseExact(dateString, "dd/MM/yyyy", null, System.Globalization.DateTimeStyles.None, out dtResult))
{
    dt = dtResult;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T20:01:38.020

因为第 13 个月不存在。

您应该将格式设置为“MM/dd/yyyy”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T20:02:56.060

因为 13\. 月不存在。从*[`wikipedia`](http://en.wikipedia.org/wiki/Month)*;

> 与之前的儒略历一样，公历有十二个月。

尝试使用`MM/dd/yyyy`格式。

```
DateTime dtResult;
var dt = DateTime.MinValue;
if (DateTime.TryParseExact("02/13/2013", "MM/dd/yyyy", null, System.Globalization.DateTimeStyles.None, out dtResult))
{
    dt = dtResult;
} 
```

这是一个[`DEMO`](http://ideone.com/9N21A3)..

# google-apps-script - 在由 HtmlService 编码的 URL 中发布 # 个字符

> ID：14862003
> 
> 赞同：1
> 
> 时间：2013-02-13T20:00:23.540
> 
> 标签：google-apps-script

我在构建指向我的 Zendesk 实例的链接时遇到问题。

在我的脚本中，我从 Zendesk 中提取了一些票务信息，并将其显示在 Web 应用程序中以供一些重要人物使用。在票证表中，我想在 Zendesk 中包含指向票证的链接。在代码中，我将单元格的值设置为这样。

```
var cell = "<td><a href=\"https://mydomain.zendesk.com/agent/#/tickets/"+ticket.id+"\">" + ticket.subject + "</a></td>"; 
```

但是，在生成的 webapp 中，链接显示如下：

```
https://mydomain.zendesk.com/agent#%2ftickets%2f1507 
```

这个链接失效了。我在将字符串发送到 HtmlService 之前检查了该字符串，但在 Caja 文档中看不到任何内容。

谢谢

此代码导致相同的问题：

```
function doGet() {
  var html = '<html><body><table><tr><th>A Header</th></tr><tr><td><a href="https://mydomain.zendesk.com/agent/#/tickets/1507">aoeuaoue</a></td></tr></table>';
  html += '</body></html>';
  Logger.log(html);
  return HtmlService.createHtmlOutput(html);
} 
```

# iphone - Xcode 中的约束问题

> ID：14862007
> 
> 赞同：0
> 
> 时间：2013-02-13T20:00:33.783
> 
> 标签：iphone, ios, objective-c, xcode, constraints

我的应用程序中的约束存在一些问题。这是它在 iPhone 4 上的外观（这就是我希望它的外观，以及我通常如何设置我的界面，这是正确的方法吗？） ![iPhone 5 之前](../Images/7779893ce70e458a534f604361b34068.png)

现在，当我切换到 iPhone 5 屏幕时，它看起来像这样 ![iphone 5](../Images/fcc90ea24fe29e8dc2fc33d2082a3833.png)

如您所见，蓝点（即 UIButtons）没有放在我想要的位置。我使我的约束仅依赖于视图的右侧（因为这是重新调整大小的一个，我发现为了让您的视图相应地对齐自己，将它们对齐到左侧并没有帮助）。我真的不知道如何解决这个问题。我发现这个新的 iPhone 屏幕真的很痛苦。任何关于如何使用这个新屏幕而不会让人头疼的好建议将不胜感激:)

提前感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:10:01.370

在我看来，与您的视图右侧的距离仍然相同，正如您所说的那样，您将它们设置为，而背景已拉伸以适应新尺寸。我怀疑它实际上是背景没有做你想做的事情（保持相同的纵横比并在左侧显示更多内容），或者尝试保持与左右相关的按钮与拉伸的背景图像保持对齐.

# c# - Form runat="server" 会提交常规的表单元素吗？

> ID：14862008
> 
> 赞同：0
> 
> 时间：2013-02-13T20:00:37.450
> 
> 标签：c#, asp.net, .net

我`form runat="server"`在主 aspx 页面中使用 a 。此页面调用用户控件。如果用户控件具有非服务器端表单元素，例如：

```
<input type="text" name="lastname" id="txtlastname"> 
```

那些还应该出现`this.Request.Form`吗？我在那里看不到他们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:13:11.190

该值在 Request.Form 对象中可用

`? Request.Form["lastname"] "this is the txt box"`

# html - 使 html 数字输入始终显示 2 位小数

> ID：14862009
> 
> 赞同：51
> 
> 时间：2013-02-13T20:00:39.343
> 
> 标签：html

我正在制作一个表单，用户可以使用 html 数字输入标签输入美元金额。有没有办法让输入框始终显示 2 位小数？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2014-03-12T18:47:51.360

因此，如果其他人偶然发现了这个问题，这里有一个 JavaScript 解决方案：

**第 1 步：**将您的 HTML 数字输入框与`onchange`事件挂钩

```
myHTMLNumberInput.onchange = setTwoNumberDecimal; 
```

或者如果您愿意，可以在 html 代码中

```
<input type="number" onchange="setTwoNumberDecimal" min="0" max="10" step="0.25" value="0.00" /> 
```

**第 2 步：**编写 setTwoDecimalPlace 方法

```
function setTwoNumberDecimal(event) {
    this.value = parseFloat(this.value).toFixed(2);
} 
```

如果您愿意，通过更改“2”，`toFixed`您可以获得更多或更少的小数位。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-08-13T14:56:58.540

内联解决方案按以下格式结合了 Groot 和 Ivaylo 建议：

```
onchange="(function(el){el.value=parseFloat(el.value).toFixed(2);})(this)" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-02-06T19:53:32.277

一个更简单的解决方案是这样的（如果您以特定形式定位所有数字输入）：

```
//limit number input decimal places to two
$(':input[type="number"]').change(function(){
     this.value = parseFloat(this.value).toFixed(2);
}); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-03-30T17:39:03.347

其他人在这里发布的内容主要有效，但是`onchange`当我多次使用同一方向的箭头更改数字时，使用不起作用。起作用的是`oninput`。我的代码（主要是从 MC9000 借来的）：

**HTML**

```
<input class="form-control" oninput="setTwoNumberDecimal(this)" step="0.01" value="0.00" type="number" name="item[amount]" id="item_amount"> 
```

**JS**

```
function setTwoNumberDecimal(el) {
        el.value = parseFloat(el.value).toFixed(2);
    }; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-02-16T21:00:25.147

这里接受的解决方案是不正确的。在 HTML 中试试这个：

```
onchange="setTwoNumberDecimal(this)" 
```

和看起来像的功能：

```
 function setTwoNumberDecimal(el) {
        el.value = parseFloat(el.value).toFixed(2);
    }; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-13T20:09:26.240

纯 html 不能做你想做的事。我的建议是编写一个简单的 javascript 函数来为您进行筛选。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-09-21T21:09:06.837

您可以使用 Telerik 的`numerictextbox`许多功能：

```
<input id="account_rate" data-role="numerictextbox" data-format="#.00" data-min="0.01" data-max="100" data-decimals="2" data-spinners="false" data-bind="value: account_rate_value" onchange="APP.models.rates.buttons_state(true);" /> 
```

核心代码[免费下载](http://www.telerik.com/kendo-ui/open-source-core)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-13T20:08:59.540

查看[toFixed](http://www.w3schools.com/jsref/jsref_tofixed.asp)以获取 Javascript 数字。您可以为您的数字字段编写一个[onChange](http://www.w3schools.com/jsref/event_onchange.asp)函数，该函数在输入上调用 toFixed 并设置新值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-28T15:00:38.517

我不喜欢所有这些解决方案，它们仅在提交表单或输入字段模糊时才起作用。我希望 Javascript 能阻止我输入超过两位小数。

我为此找到了完美的解决方案：

```
<!DOCTYPE html>
<html>
<head>

    <script>

      var validate = function(e) {
          var t = e.value;
          e.value = (t.indexOf(".") >= 0) ? (t.substr(0, t.indexOf(".")) + t.substr(t.indexOf("."), 3)) : t;
      }
  </script>
</head>
<body>

    <p> Enter the number</p>
    <input type="text" id="resultText" oninput="validate(this)" />

</body> 
```

[https://tutorial.eyehunts.com/js/javascript-limit-input-to-2-decimal-places-restrict-input-example/](https://tutorial.eyehunts.com/js/javascript-limit-input-to-2-decimal-places-restrict-input-example/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-03T21:02:14.690

我使用[了@carpetofgreenness 的答案](https://stackoverflow.com/a/43124809/1216245)，您在其中收听`input`事件而不是`change`像接受的那样，但发现在任何情况下**都没有正确处理删除字符**。

假设我们有一个值为“0.25”的输入。用户点击“Backspace”，该值变为“0.20”，似乎无法再删除任何字符，因为该函数总是在末尾添加“0”。

为了解决这个问题，我在用户删除字符时添加了一个保护子句：

```
if (e.inputType == "deleteContentBackward") {
  return;
} 
```

这修复了这个错误，但还有一件事需要覆盖 - 现在当用户点击“Backspace”时，值“0.25”会变为“0.2”，但是当我们离开时我们仍然需要在输入中出现两位数字. 为此，我们可以监听`blur`事件并将相同的回调附加到它。

我最终得到了这个解决方案：

```
const setTwoNumberDecimal = (el) => {
  el.value = parseFloat(el.value).toFixed(2);
};

const handleInput = (e) => {
  if (e.inputType == "deleteContentBackward") {
    return;
  }
  setTwoNumberDecimal(e.target);
};

const handleBlur = (e) => {
  if (e.target.value !== "") {
    setTwoNumberDecimal(e.target);
  }
};

myHTMLNumberInput.addEventListener("input", handleInput);
myHTMLNumberInput.addEventListener("blur", handleBlur); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-09T09:58:35.373

```
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js" integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw==" crossorigin="anonymous"></script>

<input type="text" class = 'item_price' name="price" min="1.00" placeholder="Enter Price" value="{{ old('price') }}" step="">

<script> 
$(document).ready(function() {
    $('.item_price').mask('00000.00', { reverse: true });
});
</script> 
```

给出的是 99999.99

# java - 弹簧混淆

> ID：14862013
> 
> 赞同：4
> 
> 时间：2013-02-13T20:00:55.380
> 
> 标签：java, spring

我一直在寻找任何解决方案来混淆使用 Spring MVC 框架的项目，但我没有找到任何东西。

例如，当我用 ProGuard 混淆一个项目时，我有这样的事情：

混淆前：
A类：

```
class A {
MyObject obj1;

//Constructors
//getters & setters
} 
```

应用程序上下文.xml

```
<bean id="objectOne" class="com.myproject.MyClass" />
<!-- Injection -->
<bean id="A" class="com.myproject.controller.A">
  <property name="obj1" ref="objectOne" />
</bean> 
```

混淆后：

```
class A {
  Z a = new Z();

 //Constructors
 //Getters & Setters
} 
```

但是 ApplicationContext 保持不变......

有没有办法混淆类和applicationContext？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:24:28.083

当涉及反射时，混淆不起作用，因为它不知道哪些文件包含对原始类名的引用。

# wpf - 实时将 .TXT 读入 ListBox

> ID：14862017
> 
> 赞同：2
> 
> 时间：2013-02-13T20:00:58.283
> 
> 标签：wpf, listbox

我正在将大型 Txt 文档读入 WPF 应用程序，以进行一些严重的交换/替换操作。这些文件实际上是 3D STP 模型，因此它们相当大，但我将它们作为该项目的原始文本使用。这些文件被读入 List 以避免必须多次打开它们，并使比较更容易。

无论如何，我试图让列表框在添加行时动态滚动，例如控制台窗口，以便用户可以看到正在发生的事情，因为计算可能需要一些时间，具体取决于文件大小。我还添加了一个进度条，以便在读取总行号时进行计数。

不过，我的进度条和 ListBox 似乎都不会随着工作的进行而更新。最终输出简单地落在完成的列表框中，进度条同时从 0-max 开始。

这是我正在做的事情的要点，这很简单：

```
 foreach (string Line in OriginalSTPFile.Lines)
   {
       string NewLine = EvaluateString(Line);  //string the modified to whatever here
       pBar.Value++;   //increment progressbar

       OutputWindow.Items.Add(NewLine);  //add line to the ListBox
   } 
```

我只希望列表框一个进度条随着进度的变化而实时更新。我尝试使用：

```
Dispatcher.BeginInvoke(new Action(() => OutputWindow.Items.Add(NewLine)); 
```

但得到了相同的结果。我需要更精细的多线程方法吗？我认为第一种方法会起作用，因为我也没有生成任何跨线程异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:15:55.980

本文将为您提供所需的所有代码。

[带有进度条的后台工作者](http://elegantcode.com/2009/07/03/wpf-multithreading-using-the-backgroundworker-and-reporting-the-progress-to-the-ui/)

它很好地描述了要做什么以及要使用哪些元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:46:36.213

Dispatcher.BeginInvoke 发出信号以调用 Dispatcher 线程上的方法。然而，这本质上就像一个帖子消息，因为它不会在主线程被锁定工作时发生。并且在主线程再次可用之前，即使您更改了值，它也不会直观地更新 UI。

您需要在后台线程中执行工作。

但要更新 UI，您必须在 UI 的主线程上执行此操作。这是 WPF 的一个限制。这就是您被定向到 Dispatcher 的原因。我猜有人认为你的工作已经在后台线程上。

要创建一个线程，您可以使用`Thread.Start`将委托传递给它来执行。如果您使用匿名委托或 lambda，您可以引用堆栈上的变量，但请注意它们将持续存在，直到委托退出。这就是为什么您不能在匿名委托中使用引用变量的原因。

Backgroundworker 是一种特殊类型的后台线程。它自动化了工作线程的一些期望（通知完成，并更新进度），但没有它你也可以获得相同的结果。

要在线程进程中更新 UI，您需要该线程能够访问主 UI 线程。您可以通过向它传递一个调度程序，从匿名委托外部引用一个调度程序，或通过一个包含调度程序的对象来做到这一点。您始终可以从任何线程上的任何对象读取值，因此可以通过 UIElement 在另一个线程上访问调度程序。

要更新 UI，您将调用`Dispatcher.BeginInvoke`需要执行工作的委托。

这是整体方案的伪代码

```
class TestProgress
{
    ProgressBar _ProgressBar;

    void DoWork()
    {
        var worker = (Action)(() =>
        {
            int progress = 0;
            // do stuff, delta is change in progress
            progress += delta;
            _ProgressBar.Dispatcher.BeginInvoke((Action)(() =>
            {
                _ProgressBar.Value = progress;
            }));
        });
        Thread.Start(worker);
    }
} 
```

# android - startscan() 在手机进入空闲状态 10 分钟后有结果

> ID：14862018
> 
> 赞同：1
> 
> 时间：2013-02-13T20:01:03.940
> 
> 标签：android, wifi, wifimanager, network-scan

我正在尝试每 2 分钟扫描一次 wifi 网络。我正在为此使用服务。当电话在通话后“活动”或“正在使用”时，`startscan()`我会`SCAN_RESULTS_AVAILABLE_ACTION`在 6 秒内到达。所以我可以定期扫描wifi。但是在电话没有被任何人触摸一段时间（10 分钟）后 startscan() 停止“工作”并且只有在 10 分钟后才得到结果。有人经历过吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T13:39:01.687

据此，我找到了解决方案 - 这是因为[Wifi](https://stackoverflow.com/a/3874375/1342413) [sleep policy](http://developer.android.com/reference/android/provider/Settings.Global.html#WIFI_SLEEP_POLICY_DEFAULT)。您可以通过以下方式设置您的 wifi 设备永远不会进入睡眠状态：

```
Settings.System.putInt(getContentResolver(),
              Settings.System.WIFI_SLEEP_POLICY, 
              Settings.System.WIFI_SLEEP_POLICY_NEVER); 
```

请确保，您在`AndroidManifest.xml`文件中添加了此权限：

```
<uses-permission android:name="android.permission.WRITE_SETTINGS"/> 
```

扫描周期为 5-15 秒 - 这是自动的 - 您无需调用`startscan()`。有关 Android 扫描过程的更多信息，请参见[此处](https://android.stackexchange.com/questions/37621/where-can-i-find-settings-for-wifi-internal-scan-period)。
**编辑：**
如果您只想扫描热点，这可能是更好的解决方案：
[`WIFI_MODE_SCAN_ONLY`](http://developer.android.com/reference/android/net/wifi/WifiManager.html#WIFI_MODE_SCAN_ONLY)- 它可以通过以下方式激活：

```
WifiManager wm = (WifiManager) context.getSystemService(Context.WIFI_SERVICE);
WifiLock wifiLock = wm.createWifiLock(WifiManager.WIFI_MODE_SCAN_ONLY , "MyWifiLock");
if(!wifiLock.isHeld()){
    wifiLock.acquire();
} 
```

不要忘记释放它，关于`WifiLock` [这里](http://developer.android.com/reference/android/net/wifi/WifiManager.WifiLock.html)
的更多信息 也定义了这个权限：

```
<uses-permission android:name="android.permission.WAKE_LOCK"/> 
```

**Edit2**这也有效：
您可以定期启用和禁用 wifi：

```
WifiManager wm = (WifiManager) context.getSystemService(Context.WIFI_SERVICE);
if(wm.isWifiEnabled() == false) {
    wm.setWifiEnabled(true);
} 
```

然后在您的广播接收器获得包含`WIFI_STATE_ENABLED`额外的操作后扫描

# javascript - 检查用户浏览器中的位置设置是否已关闭

> ID：14862019
> 
> 赞同：22
> 
> 时间：2013-02-13T20:01:04.397
> 
> 标签：javascript, jquery, browser, geolocation

我想隐藏（）或显示（）一个按钮，允许用户根据他们当前是否允许在浏览器设置中使用位置来使用他们当前的位置。下面的代码只检查浏览器是否支持地理定位，而不是特定用户是否允许它。

```
if (navigator.geolocation)  {
   navigator.geolocation.getCurrentPosition(showPosition);
   } else  {
 x.innerHTML="Geolocation is not supported by this browser.";}
 } 
```

是否有一个布尔值可以检测到他们的浏览器设置，让我知道当前是否允许定位？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-13T20:03:32.063

你读过[http://www.w3schools.com/html/html5_geolocation.asp](http://www.w3schools.com/html/html5_geolocation.asp)

您要做的是检查错误以查看它们是允许还是拒绝请求。

```
function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition,showError);
  } else {
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}

function showPosition(position) {
  x.innerHTML = "Latitude: " + position.coords.latitude + "<br>Longitude: " + position.coords.longitude;    
}

function showError(error) {
  switch(error.code) {
    case error.PERMISSION_DENIED:
      x.innerHTML = "User denied the request for Geolocation."
      break;
    case error.POSITION_UNAVAILABLE:
      x.innerHTML = "Location information is unavailable."
      break;
    case error.TIMEOUT:
      x.innerHTML = "The request to get user location timed out."
      break;
    case error.UNKNOWN_ERROR:
      x.innerHTML = "An unknown error occurred."
      break;
  }
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-04-06T16:42:33.620

下面的代码将允许您在不调用`navigator.geolocation`权限请求的情况下检查权限状态。

[支持的浏览器](https://developer.mozilla.org/en-US/docs/Web/API/Navigator/permissions#Browser_compatibility)：Chrome(43+)、Firefox(46+)、Edge 和 Opera。

不支持：Safari(mac, ios), Internet explorer, Android webview。

```
 navigator.permissions && navigator.permissions.query({name: 'geolocation'})
    .then(function(PermissionStatus) {
        if (PermissionStatus.state == 'granted') {
              //allowed
        } else if (PermissionStatus.state == 'prompt') {
              // prompt - not yet grated or denied
        } else {
             //denied
        }
    }) 
```

这是[参考链接](https://developer.mozilla.org/en-US/docs/Web/API/Navigator/permissions)。

其他浏览器的兼容性未知。我自己没有测试过，但请感觉自己测试一下并在下面发表评论。

# php - 使用预先存在的公钥值创建公钥证书

> ID：14862027
> 
> 赞同：1
> 
> 时间：2013-02-13T20:01:30.037
> 
> 标签：php, openssl, pki

我只是想知道如何使用 php 创建一个只有预先计算的公钥值的公钥证书。输入公钥和剩余值后，我将使用我自己的 ca 证书签署此证书。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T20:53:56.960

X.509 证书有一个主题和一个颁发者。如果您只有主题的公钥，您仍然可以使用 CA 的私钥创建 CA 签名证书。使用[phpseclib，一个纯 PHP X.509 实现](http://phpseclib.sourceforge.net/)...

```
<?php
include('File/X509.php');
include('Crypt/RSA.php');

// load private key for issuer / CA
$CAPrivKey = new Crypt_RSA();
$CAPrivKey->loadKey('...');

// load public key for subject
$pubKey = new Crypt_RSA();
$pubKey->loadKey('...');
$pubKey->setPublicKey();

// create the DN for the subject
$subject = new File_X509();
$subject->setDN('...');
$subject->setPublicKey($pubKey);

// create the DN for the issuer
// (the DN can be loaded from another X.509 cert too)
$issuer = new File_X509();
$issuer->setPrivateKey($CAPrivKey);
$issuer->setDN('...');

$x509 = new File_X509();
$x509->setStartDate('-1 month');
$x509->setEndDate('+1 year');

$result = $x509->sign($issuer, $subject);
echo $x509->saveX509($result);
?> 
```

# python - Python子进程通信，top显示cpu使用率低

> ID：14862028
> 
> 赞同：1
> 
> 时间：2013-02-13T20:01:30.470
> 
> 标签：python, subprocess, cpu, popen

给定一个非常简单的脚本，例如：

```
import subprocess

while True:
    x = subprocess.Popen('ls -ltr /usr/lib', shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE).communicate() 
```

我在笔记本电脑的 Ubuntu 12.04（32 位）celeron 2 核上得到以下“顶级”cpu 使用情况：

```
x = subprocess.Popen('ls -l /usr/lib', ... 
python3.2.3: 6%, python2.7.3: 5% (ls 0%)

x = subprocess.Popen('gcc --version', ...
python3.2.3: 22%, python2.7.3: 18% (gcc 0%)

x = subprocess.Popen('pwd', ...
python3.2.3: 47%, python 2.7.3: 35% (pwd 0%) 
```

如果将 subprocess.Popen 替换为 os.popen，则结果不同：

```
x = os.popen('ls /usr/lib').read()
python3.2.3: 8%, python2.7.3: 3% (gcc 0%)

x = os.popen('gcc --version').read()
python3.2.3: 45%, python 2.7.3: 9%

x = os.popen('pwd').read()
python3.2.3: 68%, python 2.7.3: 22% 
```

为什么 CPU 使用率如此之低且如此不同？我在core i5和atom ubuntus上试过这个，结果接近100%（3.2）和80%（2.7）。上面没有其他内容，我的平台有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:49:04.783

至少有一些问题是您使用磁盘而不是 CPU 来执行其中一些命令。“ls -l /usr/lib”肯定会涉及磁盘访问（因为它在每个文件上运行 stat()）：我可以相信加载 gcc 涉及的磁盘访问更少，而 shell 内置 pwd 甚至更少。

我也可以相信，也许 os.popen、subprocess.Popen 和 Python3 版本在它们是否产生新的 shell、shell 具有哪些属性（以及因此是否必须从磁盘读取 /etc/profile）和很快。

正如评论已经说过的那样，计算密集型工作将使您获得比“ls -l”等IO密集型工作更高的CPU使用率。以下让我很好地达到了 100% CPU：

```
while True:
    a = 11*11 
```

# windows-phone-7 - Multiple WindowsPhone Devices on Visual Studio 2012

> ID：14862033
> 
> 赞同：0
> 
> 时间：2013-02-13T20:01:41.183
> 
> 标签：windows-phone-7, deployment, visual-studio-2012, windows-phone-8, windows-phone

How can i use multiple WP device in Visual Studio? I need to test an application on multiple devices at the same time, how can I do? I do not need to start debugging on both, I just need to be able to deploy on both phones. One is WP8 and the other WP7\. Thanks for the help

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:05:14.303

You can deploy to the first phone by connecting it and selecting `Deploy` from the `Build` menu. You can then disconnect the first device, connect the second device and debug as per usual.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:54:07.290

Sorry, you can't automate deployment to multiple devices using Visual Studio, DeployXap or CoreCon11 APIs. The way Visual Studio 2012 and DeployXap.exe do their thing is by using the CoreCon11 APIs (which I demoed [here](https://stackoverflow.com/questions/13420733/connect-to-windows-phone-8-using-console-application/13429709#13429709) and explained [here](http://justinangel.net/WindowsPhone7EmulatorAutomation)). However, the way CoreCon11 APIs work is that they only recognize one physical connected device at a time and one version of each emulator. Here's a print out of all available devices on a machine with 2 WP8s connected to it:

![Devices](../Images/053c78e9ae8ffa3adf2af432aadce9a4.png)

As you can see, there's only one "device" available from the CoreCon11 APIs. Because CoreCon11 APIs only support deployment to a single device, you can't automate those APIs or anything using them to deploy to multiple devices.

It might be possible to change how the CoreCon11 DataStore PlatformContainer works and add additional devices, but I don't have a code sample to share.

# php - 将pdf转换为png的imagick错误：Postscript委托失败`/tmp/magick-bpkD9zy7'：@error/pdf.c/ReadPDFImage/663

> ID：14862039
> 
> 赞同：1
> 
> 时间：2013-02-13T20:02:00.547
> 
> 标签：php, imagick

我需要将多页 PDF 转换为将在浏览器中显示的一系列 PNG。

此代码有效：

```
$images = new imagick();
$images->readimage($_FILES['upload']['tmp_name']);
$images->setformat('png');

    foreach ($images as $pageNumber => $image) {
       //Save individual images 
     } 
```

但它生成的 PNG 质量很差，几乎无法阅读。

这段代码：

```
$images = new imagick();
$images->setresolution(1024,0);
$images->readimage($_FILES['upload']['tmp_name']);
$images->setformat('png');

    foreach ($images as $pageNumber => $image) {
       //Save individual images 
     } 
```

在 readimage() 处生成以下错误：

```
Postscript delegate failed `/tmp/magick-bpkD9zy7': @ error/pdf.c/ReadPDFImage/663 
```

我需要能够以比 imagick 默认更高的分辨率光栅化 PDF，以获得足够好的质量来读取 PNG。任何帮助将不胜感激。

编辑-以下是解决方案-感谢正确完成的站点

```
$images = new imagick();
$images->setimageunits(RESOLUTION_PIXELSPERINCH);
$images->setresolution(150,150);
$images->readimage($_FILES['upload']['tmp_name']);
$images->setformat('png');

    foreach ($images as $pageNumber => $image) {
       //Save individual images 
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:24:49.487

使用

```
$images->setresolution 
```

设置图像的密度。不要尝试 1024,0（这就像使用*convert -density 1024x0*），而是尝试将密度设置为 200x200。

然后使用[http://php.net/manual/en/imagick.setimageunits.php](http://php.net/manual/en/imagick.setimageunits.php)

```
$images->setImageUnits 
```

设置该分辨率的单位（类似于“PixelsPerInch”）。这应该正确设置图像的清晰度。

# javascript - 页面加载时滚动到长滚动页面上的特定 div

> ID：14862043
> 
> 赞同：0
> 
> 时间：2013-02-13T20:02:10.370
> 
> 标签：javascript, jquery, html

我有一个长长的滚动页面，里面有很多 div，一个在另一个之下。我想在您访问（或重新加载）网站时自动滚动，以从顶部滚动到底部附近的特定 div。跳转没有问题，但我想要“滚动”效果。我检查了 scrollTo() 但我没有让它工作。我的第一次尝试是这样的

```
$(document).ready(function () {
  $.scrollTo('#div5'); }); 
```

但它不会触发任何东西。需要一点帮助:)谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:22:10.237

试试这个：

```
$('html, body').animate({
    scrollTop: $('#div5').offset().top
}, 500); 
```

[http://jsfiddle.net/nTwLm/2/](http://jsfiddle.net/nTwLm/2/)

# ios - CALayer的可见区域发生变化时的通知？

> ID：14862046
> 
> 赞同：0
> 
> 时间：2013-02-13T20:02:19.007
> 
> 标签：ios, macos, core-animation

我有一个 CALayer，我只为可见区域提供内容（有点类似于 CATiledLayer）。问题是当 CALayer 的可见区域发生变化以便调用 displayLayer 时，似乎没有办法接收通知。我目前子类化并挂钩 setPosition、setBounds 和 setTransform，但这并没有捕捉到超级视图/图层更改的情况（例如，UIScrollView 通过更改滚动视图原点进行滚动）。我留下了挂钩父视图并在整个代码中洒上 setNeedsDisplay 。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:26:35.763

当前可见的矩形是`[CALayer visibleRect]`. 这是由滚动视图（层）设置的，并且是您希望在滚动视图中绘制的基础。

您可能想要覆盖`-needsDisplayOnBoundsChange`返回`YES`。这通常是您处理您所描述的大部分内容的方式。

如果您想要诸如位置之类的东西来强制重绘（这很不寻常，但可能），那么您可以覆盖`+needsDisplayForKey:`以返回`YES`您想要强制重绘的任何关键更改。

如果你想确保你只画你需要画的东西，那么你应该`CGContextGetClipBoundingBox()`在你的绘图代码中检查你的剪贴框。

# facebook - 在画布应用程序中向用户应用程序请求发送用户不显示通知

> ID：14862049
> 
> 赞同：2
> 
> 时间：2013-02-13T20:02:31.970
> 
> 标签：facebook, notifications, facebook-javascript-sdk, apprequests

我已经阅读了关于用户对用户应用程序请求中缺少通知的所有内容，看起来它可能是：

*   因为应用程序不是画布或画布 url 不正确
*   因为该应用程序处于沙盒模式。

我在沙盒模式下开发了我的应用程序，并在上周使用 JS SDK 在生成的测试用户之间尝试了一些 u2u 请求。一切都很好，通知确实出现了......但是从今天开始，页眉通知列表中没有更多通知。要找到请求，用户显然必须注意到左侧菜单中的“应用程序”项的少量已更改，即使对于用户对用户的请求也是如此。

我在 2 月 6 日的变化中找不到这个变化，也许我错过了什么。我在旧帖子的某处读到通知政策是由 Facebook 算法确定的，我不能确定请求是否会出现在通知中。

但它清楚地写道，用户对用户的请求会在这里引发通知：

[https://developers.facebook.com/docs/concepts/requests/](https://developers.facebook.com/docs/concepts/requests/)

有人可以解释一下这种变化来自哪里吗？

提前致谢 ！

皮埃尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T08:55:57.377

谢谢你，Igy，我松了一口气，这不是设计更改而是错误（我再次复制错误的链接，因为这应该是我问题的答案： [https ://developers.facebook.com/bugs/ 532388000129311?browse=search_511bf995772fc8763161711](https://developers.facebook.com/bugs/532388000129311?browse=search_511bf995772fc8763161711) ）！

# javascript - 在 JavaScript 中定义一个 Universal/Fallback getter 属性

> ID：14862052
> 
> 赞同：12
> 
> 时间：2013-02-13T20:02:35.743
> 
> 标签：javascript, getter

JavaScript 有带有`Object.defineProperty`. 所以我可以在by的属性`random`上定义一个 getter`window`

```
Object.defineProperty(window, 'random', {
    get: function () {
        return Math.random();
    }
});

random // Evaluates to a random number 
```

无论对象属性如何，是否可以为给定对象定义“通用吸气剂”？我想做类似的事情

```
Object.universalGetter(window, function (propertyName) {
     console.log('Accessing property', propertyName, 'of window.');
});

window.Function // Prints "Accessing property Function of window." 
```

我可以在 JavaScript 中做“通用吸气剂”吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T08:15:32.727

不幸的是：不，没有。

在基于 Gecko 18 的浏览器中引入了一种称为[代理对象的东西](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Proxy)

这将允许你做这样的事情

```
(function (original, Window) {
  var handler = {
    get: function (target, propertyName) {
      console.log('Accessing property', propertyName, 'of window.');
      return target[propertyName];
    }
  };

  Window = new Proxy(original, handler);

  console.log(Window.setTimeout); 
  // "Accessing property"
  //  "setTimeout"
  //  "of window."

  // function setTimeout() {
  //  [native code]
  // }
})(window); 
```

但这**不是**标准的，仍然非常不稳定

*顺便说一句，我最初认为您可以直接`window`在 IIFE 中用作局部变量，但似乎您不能只记录未定义的日志（想知道为什么），所以我将“W”大写*

[这是一个关于JSBin](http://jsbin.com/ucezej/1/edit)的例子

*注意：您应该在 Firefox 中访问它*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-13T20:11:29.663

不。

在 ECMAScript 第 5 版中无法执行此操作，因为*没有此操作的规定。*虽然没有明确说明，但可以看出[[GetProperty]](http://es5.github.com/#x8.12.2)没有为不存在的属性做出任何规定。

ECMAScript 中的 getter/setter*需要*现有的属性，并且没有 Ruby`method_missing`或 Python 的`__getattribute__`.

# wpf - WPF 捕获子控件的焦点更改

> ID：14862057
> 
> 赞同：1
> 
> 时间：2013-02-13T20:02:42.970
> 
> 标签：wpf, user-controls, focus, tabcontrol

有没有办法让 UserControl 捕捉到其任何子控件的焦点变化？

我`TabControl`有一个在每个选项卡上都有一个 UserControl 的。在选项卡之间切换时，我试图将注意力集中在控制项上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:24:33.060

您可以订阅用户`LostFocus`控件中每个控件的事件。

要自动执行此操作，您可以订阅 on initialize 并循环遍历子项。但是，您要么需要直接了解您的孩子（因为它们是成员变量），要么您的用户控件必须是/包含 ItemsControl。

如果您包含来自模板的项目控件，则必须使用您分配给部件的名称来搜索模板控件。

```
<ControlTemplate>
 <Grid x:Name="PART_ChildrenContainer">
  <ItemsPresenter> <!--This will contain your children-->
 </Grid>
</ControlTemplate> 
```

然后，您必须执行以下操作。

```
var grid = (Grid)this.Template.FindName("PART_ChildrenContainer",...);
foreach(var child in grid.Children)
{
   child.PreviewLostKeyboardFocus += 
       new System.Windows.Input.KeyboardFocusChangedEventHandler(eventHandler);
} 
```

# python - 遍历列表，比较前面的元素和后面的元素

> ID：14862065
> 
> 赞同：1
> 
> 时间：2013-02-13T20:03:09.300
> 
> 标签：python, list

我正在尝试编写一个函数来验证列表。

基本上，对于列表中的任何给定元素，它前面的项目或它后面的项目都必须相同。

一个好的列表定义为：

`good_list = ["H", "H", "H", "M", "M", "L", "L", "M", "M", "H", "H", "H"]`

坏列表定义为：

`bad_list = ["H", "M", "H", "M", "M", "L", "L", "M", "M", "H", "H", "H"]`

我花了几天时间尝试不同的解决方案（并阅读stackoverflow），下面是我目前拥有的，但它没有返回正确的答案。根据反馈（谢谢！），我更新了它并将参数的名称从 list 更改为 season 并将其设为 OR。当它不应该时它仍然返回一个“有效列表”？

```
bad_list = ["H", "M", "H", "M", "M", "L", "L", "M", "M", "H", "H", "H"]

def check_list(season):     
   for i, a in enumerate(season):
        if season[i] == season[i-1] or season[i] == season[i+1]:
            return True
   return False

result = check_list(bad_list)

if result == True:
    print "Valid list"
else:
    print "Invalid list" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:07:48.937

我会简单地使用[`itertools.groupby`](http://docs.python.org/2/library/itertools.html#itertools.groupby)：

```
if all(len(tuple(group)) > 1 for key, group in itertools.groupby(the_list)):
    print "valid"
else:
    print "invalid" 
```

基本上，请求“每个元素之前或之后应该有一个相等的元素”相当于“列表必须由最小长度为 2 的连续元素组组成”。该`groupby`函数创建这些组，您只需检查`all`它们的长度是否大于`1`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:46:25.183

For the more general case of 'comparing element in front and element behind', I would use `itertools.tee` and `itertools.izip` -- perhaps gathering the follow pattern into a utility function.

Also, the logic in your loop is inside-out.

```
# (inside the function)
_behind, _current, _ahead = itertools.tee(the_list, 3)
# should error check as well
_current.next()
_ahead.next()
_ahead.next()
for behind, current, ahead in itertools.izip(_behind, _current, _ahead):
    # fixing logic here
    if behind != current and current != ahead:
        return False
return True 
```

or

```
return not any(behind != current and current != ahead for behind, current, ahead in itertools.izip(_behind, _current, _ahead)) 
```

Note that you'll need to handle 1-length and 2-length lists with a special case.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:05:16.447

要修复您的代码，请使用`or`and 代替：

```
if list[i] == list[i-1] or list[i] == list[i+1]: 
```

`i-1`此外，您应该只在索引和 分别`i+1`没有“退出”列表时执行这些检查。

到目前为止，这不是性能最好的解决方案，但应该可以工作。

我不会修复你的代码，因为我猜你应该自己想出它。

# asp.net - ImageButton 不更新更新面板

> ID：14862067
> 
> 赞同：0
> 
> 时间：2013-02-13T20:03:22.627
> 
> 标签：asp.net, .net, updatepanel, imagebutton, autopostback

ImageButton 可以工作，但它不会更新更新面板，因此根本没有显示任何更改。

这是我的更新面板代码：

```
<asp:UpdatePanel ID="UPConfig" runat="server" UpdateMode="Conditional">
 <ContentTemplate >

  STUFF

  <asp:ImageButton ID="ModT" runat="server" ImageUrl="images/config.png" width="25px" height="25px"/>

  STUFF

 </ContentTemplate>
 <Triggers>
  <asp:AsyncPostBackTrigger ControlID="ModT" EventName="Click"/>
 </Triggers>
</asp:UpdatePanel> 
```

我似乎也无法添加 AutoPostBack="true" 属性。可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:10:58.767

尝试...

```
<asp:AsyncPostBackTrigger ControlID="ModT" EventName="Click" /> 
```

我很确定您必须将触发器与事件联系起来，在这种情况下，您正在单击对象，因此将其与 click 事件联系起来，就像上面一样。其他一切看起来都不错，否则请告诉我们。

# vb.net - SQLite INNER JOIN 与 ATTACHed 数据库

> ID：14862069
> 
> 赞同：1
> 
> 时间：2013-02-13T20:03:26.137
> 
> 标签：vb.net, sqlite

我有两个具有相同表结构的 SQLite 数据库，我需要使用 VB.Net 进行查询，但我几乎可以找出任何语法。我想弄清楚如何构建查询字符串？此查询正常工作：

```
 sb = New StringBuilder("SELECT Master.Name, Master.ID, Master.StartDate, Master.Supervisor, Log.LogType, Log.LogComment FROM Master INNER JOIN Log ON Master.ID = Log.ID WHERE date(Log.LogDate) = '")
    sb.Append(calendarDate.ToString("yyyy-MM-dd"))
    sb.Append("' ORDER BY Master.Name;")
    c = New SQLiteCommand(sb.ToString, _Conn)
    Using dr As SQLiteDataReader = c.ExecuteReader 
```

...

我还可以使用以下内容“附加”第二个数据库：

```
 sb = New StringBuilder("ATTACH DATABASE '")
    sb.Append(outDBPath)
    sb.Append("' AS db2;")
    c = New SQLiteCommand(sb.ToString, _Conn)
    c.ExecuteNonQuery()
    c.Dispose() 
```

我的问题是，查询两个数据库的语法是什么？这甚至可能吗？过去我使用了 For... Next 循环，只是将连接从第一个数据库更改为第二个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:06:38.620

[http://www.sqlite.org/lang_attach.html](http://www.sqlite.org/lang_attach.html)：

> 可以使用语法 database-name.table-name 来引用附加数据库中的表。如果表的名称在所有附加数据库以及主数据库和临时数据库中是唯一的，则不需要数据库名称前缀。如果不同数据库中的两个或多个表具有相同的名称，并且在表引用中未使用 database-name 前缀，则选择的表是数据库中最近最少附加的表。

所以你`db2.Master`用来引用`Master`附加数据库中的表。

# winforms - 如何使我的表单适合手持设备？

> ID：14862074
> 
> 赞同：0
> 
> 时间：2013-02-13T20:03:36.903
> 
> 标签：winforms, compact-framework, windows-ce

我在我的 Windows CE/CF/C# 应用程序中添加了一个新表单，但是该表单太大了——我必须拖动它才能看到所有内容——我认为 CF 会自动使表单缩放到设备的大小？

是否有我需要设置的一个或多个属性，或者我需要为表单提供一个特定的大小，以便它占据整个屏幕但仅此而已？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:38:14.657

不，窗体不会为 WinCE 自动调整大小（它们是 WinMo）。您可以手动设置它的大小，或者最大化它以获得您想要的效果。

# php - 如何确保 UNIX 时间戳范围之间没有重叠

> ID：14862075
> 
> 赞同：0
> 
> 时间：2013-02-13T20:03:38.330
> 
> 标签：php, unix-timestamp

我有一个脚本可以检查在用户请求的时间内是否已经安排了会话。如果在该时间范围内有另一个会话，我需要确保用户无法安排会话。这是我所做的：

```
//Check to make sure no sessions have been already scheduled for this time

$session_check_query = "SELECT * FROM requested_sessions WHERE username_t = '{$tutor_usernname}'";
$session_check_process = mysql_query($session_check_query);

while ($session_check = mysql_fetch_array($session_check_process)) {
    if ($session_check['time_from'] - $session_to_time <= 900 && $session_check['time_from'] > $session_to_time && $session_check['accepted'] == 1) {
        header("Location:../../../iframes/schedule-session.php?".$url_string."&error=notavail");
        exit;
    }

    if ($session_check['time_from'] <= $session_from_time && $session_check['time_to'] >= $session_to_time && $session_check['accepted'] == 1) {
        header("Location:../../../iframes/schedule-session.php?".$url_string."&error=notavail");
        exit;
    }
} 
```

第一个“if”语句确保在接下来的 15 分钟内没有即将到来的会话，第二个“if”语句确保输入的时间不在预定会话的范围内。

但是，假设有一个会话安排在晚上 11:00 到 12:00。如果我输入 11:15 到 11:30，此代码将正常工作，但如果我输入 11:30 到 12:15 或 10:45 到 12:15 之类的内容，它将通过测试。

我需要代码来确保用户输入的时间范围与已安排的会话之间没有重叠。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:07:39.317

您想知道所选时间是否在会话开始之后结束，并在会话结束之前开始。

```
// You obviously need to set these appropriately or change the code below for your needs
$userSelectedStart = 1;
$userSelectedEnd   = 2;
$knownStart        = 3;
$knownEnd          = 4;

if ($userSelectedStart <= $knownEnd && $userSelectedEnd >= $knownStart) {

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:24:19.517

```
"SELECT COUNT(*) FROM requested_sessions WHERE username_t = '{$tutor_usernname}'
    AND
(time_to > ".($session_from_time - 900)." OR  time_from < ".($session_to_time + 900).")"; 
```

如果会话的结束时间大于新会话的开始时间（减去您要求的 15 分钟休息时间），则它们重叠。

如果会话的开始时间小于新会话的结束时间（同样，加上您的 15 分钟休息时间），那么它们会重叠。

尔格：如果 COUNT(*) 不为零，则某些内容重叠。当然，如果你关心的话，你也可以查询重叠的会话的实际数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:12:22.420

这个问题也可以使用一个简单的查询来解决，该查询返回重叠会话的 id 列表。虽然我在查询（@S/@E）中使用了变量，但它们可以并且可能应该替换为实际值。另请注意，您需要从开始时间 (@S) 中减去这 15 分钟，然后在结束时间 (@E) 中加上 15 分钟。

架构：

```
CREATE TABLE SESSION (
  ID BIGINT NOT NULL PRIMARY KEY,
  USER_ID VARCHAR(30) NOT NULL,
  START DATETIME NOT NULL,
  END DATETIME NOT NULL 
  );

INSERT INTO SESSION VALUES (1, 'test', '2013-02-10 14:00:00', '2013-02-10 14:30:00');
INSERT INTO SESSION VALUES (2, 'test', '2013-02-10 12:00:00', '2013-02-10 13:30:00');
INSERT INTO SESSION VALUES (3, 'test', '2013-02-10 16:00:00', '2013-02-10 21:30:00');
INSERT INTO SESSION VALUES (4, 'test', '2013-02-10 8:00:00', '2013-02-10 11:30:00'); 
```

询问：

```
SET @S = '2013-02-10 14:40:00';
SET @E = '2013-02-10 16:00:00';
SELECT ID FROM SESSION
 WHERE START <= @S AND END > @S
 OR START > @S AND START <= @E; 
```

这是 SQL Fiddle 链接：[http ://sqlfiddle.com/#!2/5d958e/6/2](http://sqlfiddle.com/#!2/5d958e/6/2)

# java - 如何从数据库中异步获取 SwingWorker 的发布方法的数据？

> ID：14862076
> 
> 赞同：0
> 
> 时间：2013-02-13T20:03:41.303
> 
> 标签：java, swing, hibernate, asynchronous, ejb

我有一个远程 EJB3 方法，它`List<T>`使用 JTA（休眠）从数据库返回一个。基本上它只是一个简单的 HQL，看起来像这样：`select t from T t where ...`.

在某些情况下，此查询需要很长时间，因此我想使用 SwingWorker 使用`publish`and`process`方法将数据块异步加载到 JTable 中。但是，为了让它工作，我还需要从服务器获取数据块。正确的？
我可以通过为它们设置一些任意范围来人为地将查询划分为许多“较小”的查询：
`select t from T t where ... and t.id < :rangeSrart and t.id > :rangeEnd`

但我希望有更好的方法来做到这一点。
我看了看，`@Asynchronous`但它似乎不是我要找的东西。
有什么办法可以用 EJB 或其他方法做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:17:34.993

你既不需要`publish`也不需要`process`。只需在您的`doInBackground()`. ()开始之前`execute`在对话框中显示未确定的进度条。此外，您应该覆盖`done()`以显示您的结果并隐藏进度对话框。

# javascript - dust.js 渲染动态内容

> ID：14862080
> 
> 赞同：0
> 
> 时间：2013-02-13T20:03:48.337
> 
> 标签：javascript, jquery, dust.js

我的模板中有以下代码，它在页面加载时提供所需的输出。

当我使用套接字更新数据时，有没有办法让灰尘动态呈现页面

```
{#storylines}
<li>{text|bl|s} <span class="badge yellow">{@negidx}{.}{/negidx}</span></li>    
{/storylines} 
```

套接字 IO 代码：

```
socket.on('updatechat', function (username, data) {
       $('#newstoryline').before(blurlines(data));
}); 
```

我试过简单地添加`<span class="badge yellow">{@negidx}{.}{/negidx}</span>`到数据的末尾，但输出是`{@negidx}{.}{/negidx}`- 有没有办法让dust.js呈现最新数据？还是我必须使用某种 jQuery 而不是`{@negidx}{.}{/negidx}`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:19:21.853

If you are rendering your templates client-side, this should be easy. Your code would look something like this:

```
socket.on('updatechat', function (username, data) {
  if (data) {
    dust.render('storyline', data, function(err, output) {
      if (output) {
        $('#newstoryline').before(output);
      }
    });
  }
}); 
```

What's going on here:

The returned data should be JSON. Check that something has been returned.

```
 if (data) { 
```

Use `dust` to render the template using the returned data.

```
 dust.render('storyline', data, function(err, output) { 
```

Check for `output`:

```
 if (output) { 
```

Insert the `output` into your page. This is usually done with innerHTML, but you can use whatever works for you. Remember, the `output` is a string at this point.

```
 $('#newstoryline').before(output); 
```

# ruby-on-rails-3 - Google OAuth 不接受自己的 client_id

> ID：14862083
> 
> 赞同：1
> 
> 时间：2013-02-13T20:04:05.993
> 
> 标签：ruby-on-rails-3, devise, oauth-2.0, omniauth, google-oauth

我有一个已经成功使用 google oauth 的应用程序，但现在我正在尝试设置暂存部署。这是一个带有设计和omniauth的rails应用程序，但我认为我配置Google的方式可能存在问题。

在 google api 管理面板 ( [https://code.google.com/apis/console](https://code.google.com/apis/console) ) 我可以看到现有的应用程序。我用不同的回调 url 创建了另一个（因为它是暂存的）。使用 Postman（编辑 url 参数的一种奇特方式）我可以使用当前的生产 client_id 和 redirect_url 向 google 发送一个 get 请求，它工作正常。当我复制并粘贴新客户端（暂存的）client_id 和 redirect_url 时，我总是会收到错误消息`Error: invalid_client`。

我确定从哪里开始尝试解决问题，但我尝试了很多不同的步骤，重命名网址、更改客户端密码或在管理面板中重新创建客户端。有任何想法吗？这个错误相当神秘。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:34:56.430

我们遇到了一小组客户端 ID 的临时问题。这个问题应该得到解决。如果您仍然遇到问题，请跟进。

# tsql - 动态 T-SQL IIF 语句的问题

> ID：14862086
> 
> 赞同：2
> 
> 时间：2013-02-13T20:04:11.737
> 
> 标签：tsql, sql-server-2012, dynamic-sql, iif

这段代码工作正常，完全符合我的要求，即对每个动态查询实例的 Qty * Price 求和。

![工作代码](../Images/7a59d108926078364fdfefd09d073889.png)

但是当我添加 IIF 语句时，它会中断。我正在尝试做的事情与上述相同，但是当交易类型为“CO”时，将总和设置为负数。

![在此处输入图像描述](../Images/edd5edc56a6fc9f689cbf2f1c6dbabbc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:31:24.393

问题原来是 的`NVARCHAR(4000)`类型`@sql`，将其长度限制为 4000 个字符：在添加另一个长块后，查询在某个随机位置被截断。

`DECLARE @sql NVARCHAR(MAX)`解决了这个问题，允许2GB以下任意大小的动态查询。

# php - 添加到主屏幕的网站从不保存登录

> ID：14862089
> 
> 赞同：0
> 
> 时间：2013-02-13T20:04:20.133
> 
> 标签：php, cookies, homescreen

我的网站主页上有以下代码，当网站添加到 iphone 的主屏幕时，总是将我重定向回 l​​ogin.php 页面。有没有办法记住登录信息或者从主页顶部删除这个脚本？谢谢你的帮助。顺便说一句，如果我从浏览器打开该站点，除非我清除我的历史记录，否则它不会要求重新登录。

```
<?PHP
require_once("./source/include/membersite_config.php");

if(!$fgmembersite->CheckLogin())
{
    $fgmembersite->RedirectToURL("login.php");
    exit;
}
?> 
```

> 检查登录功能：

```
 function CheckLogin()
    {
         if(!isset($_SESSION)){ session_start(); }

         $sessionvar = $this->GetLoginSessionVar();

         if(empty($_SESSION[$sessionvar]))
         {
            return false;
         }
         return true;
    } 
```

> 获取登录会话变量：

```
 function GetLoginSessionVar()
    {
        $retvar = md5($this->rand_key);
        $retvar = 'usr_'.substr($retvar,0,10);
        return $retvar;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:35:02.207

尝试这个：

```
 function CheckLogin()
    {
         session_start();

         $sessionvar = $this->GetLoginSessionVar();

         if(empty($_SESSION[$sessionvar]))
         {
            return false;
         }
         return true;
    } 
```

# java - 如何编辑 DBF 和 NTX 文件

> ID：14862090
> 
> 赞同：0
> 
> 时间：2013-02-13T20:04:23.900
> 
> 标签：java, visual-studio-2010, dbf

我想使用 java 将寄存器添加到 DBF 文件中。我可以这样做，但是当我尝试在使用 DBF 文件的系统中查看寄存器时，什么也没有出现。我试图手动执行此操作，打开 dbf 文件并再添加一行，然后转到系统以显示此新数据，但结果相同，没有任何反应。我在同一个文件夹中有一些 .ntx 文件，我确信这可能表明主键或其他东西之间的关系。是否有人尝试编辑 DBF 和 NTX 文件以添加新寄存器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T14:31:39.680

我相信 .NTX 文件与 dBASE 相关联。您可能遇到的是，当您将记录添加到原始表时，相应的“NTX”（索引文件）并没有同时打开，因此如果通过原始数据系统查看记录，您可能想尝试并“重新索引”表并查看记录是否出现。如果他们确实出现了，那么是的，索引是罪魁祸首......它没有被更新。由于我不了解 java 和打开 dbf 文件，因此我无法为您提供更多指导，但至少可以为您提供更多了解的开始方向。

# php - 如果是/不是 IE，包括不同的 php 文件

> ID：14862091
> 
> 赞同：1
> 
> 时间：2013-02-13T20:04:24.123
> 
> 标签：php, internet-explorer, include

我想为所有支持它的浏览器包含一个不错的上传器（当然，除了 IE 之外的所有浏览器）。

我试图使用这样的条件语句：

```
<!--[if IE]>
<?php include("image-upload-test2.php"); ?>
<![endif]-->

<!--[if !IE]>
<?php include("image-upload-test3.php"); ?>
<![endif]--> 
```

但是包含的文件没有显示在页面上，寻找它们被注释掉的来源？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:05:43.827

使用特征检测。即使上述方法确实有效，IE 从版本 10 开始不再支持条件注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:08:39.273

您可以使用[get_browser](http://www.php.net/manual/en/function.get-browser.php)检测访问者使用的浏览器

```
<?php
echo $_SERVER['HTTP_USER_AGENT'] . "\n\n";

$browser = get_browser(null, true);
echo $browser['browser'] . "\n\n";
print_r($browser);
?> 
```

# javascript - SVG路径接近检测

> ID：14862105
> 
> 赞同：0
> 
> 时间：2013-02-13T20:05:11.513
> 
> 标签：javascript, svg

我有一组 SVG 路径，并在鼠标位于路径附近时发送命中事件。我不希望路径周围的矩形框接近。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:29:55.193

您可以添加不同（扩展）形状的点击区域，或者简单地复制路径并添加大笔划。假设一个标记，如......

```
<svg xmlns="http://www.w3.org/2000/svg">
    <path d="m169,83c75,-44 220,145 96,110c-124,-35 -171,-66 -96,-110z"  class="hitarea" />
    <path d="m169,83c75,-44 220,145 96,110c-124,-35 -171,-66 -96,-110z" />
</svg> 
```

那你可以做...

```
path {
   fill: black;
   stroke: green;
   stroke-width: 5;
   pointer-events: none;
}

path.hitarea {
   opacity: 0;
   stroke-width: 50;
    pointer-events: auto;
}

path.hitarea:hover + path {
    fill: red;
} 
```

或者，如果您不需要在形状上进行描边，则只需放置一个大的透明描边即可。

[http://jsfiddle.net/MbsCh/](http://jsfiddle.net/MbsCh/)

# parallel-processing - PBS 运行具有不同参数的同一程序的多个实例

> ID：14862109
> 
> 赞同：0
> 
> 时间：2013-02-13T20:05:16.043
> 
> 标签：parallel-processing, cluster-computing, pbs, serial-processing

您如何通过 PBS 提交多次运行同一个程序，但集群上的每个实例使用不同的参数。另外，是否可以将这些程序中的每一个指定到一个单独的节点？目前，如果我有一个带有以下脚本的 PBS：

```
#PBS -l nodes=1:ppn=1
/myscript 
```

它将在单个节点上运行单个程序一次。如果我使用以下脚本：

```
#PBS -l nodes=1:ppn=1
/mscript -arg arg1 &
/myscript -arg arg2 
```

我相信这将串行运行每个程序，但它只会使用一个节点。我可以声明多个节点，然后将特定节点委托给我希望运行的程序的每个实例吗？

任何帮助或建议将不胜感激。如果我不清楚任何内容或使用了不正确的术语，我深表歉意……我对集群计算非常陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T00:46:05.833

您想使用一种形式的 MPI 来做到这一点。MPI 代表消息传递接口，并且有许多实现该接口的库。我建议使用 OpenMPI，因为它与 PBS 集成得非常好。正如您所说，您是新手，您可能会喜欢本[教程。](https://computing.llnl.gov/tutorials/mpi/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-16T21:17:32.670

`GNU Parallel`将是此目的的理想选择。您的案例的示例 PBS 脚本：

```
#PBS -l nodes=2:ppn=4 # set ppn for however many cores per node on your cluster
#Other PBS directives

module load gnu-parallel   # this will depend on your cluster setup

parallel -j4 --sshloginfile $PBS_NODEFILE /mscript -arg {} \
  ::: arg1 arg2 arg3 arg4 arg5 arg6 arg7 arg8 
```

`GNU Parallel`将处理到各个节点的 ssh 连接。我已经在命令行上写出了带有参数的示例，但您可能希望从文本文件中读取参数。以下是[手册页](http://www.gnu.org/software/parallel/man.html)和[教程](http://www.gnu.org/software/parallel/parallel_tutorial.html)的链接。选项`-j4`应与 ppn（每个节点的核心数）匹配。

# jquery - 带有 jquery 的样式输入框，但具有后备样式

> ID：14862117
> 
> 赞同：0
> 
> 时间：2013-02-13T20:05:32.207
> 
> 标签：jquery, input, styling, dropdownbox

我的问题是，当我使用 jquery 设置输入框或下拉框的样式时，如果浏览器不喜欢我的非默认样式，我最好也有一个回退。

我不是在问如何通过 jquery 设置样式，我想做的是在出现浏览器问题时添加回退（使用默认样式）。

我一直在阅读这篇文章，但是如何实施后备解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:09:00.003

如果您打算使用 JavaScript 来设置 a `<select>`or`<input>`字段的样式，我建议您寻找一个使用[渐进增强](http://en.wikipedia.org/wiki/Progressive_enhancement)的插件，这样您就不会影响旧浏览器的可用性。

这是一个很好的选择：[选择](http://harvesthq.github.com/chosen/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:09:07.537

浏览器具有默认的用户代理样式表，用于设置输入或下拉菜单或任何其他元素的样式。所以从某种意义上说，已经有了一个后备。如果您对用户代理样式表中实现的默认样式不满意，那么您可以编写自己的 css 来定位这些元素。

# sql - 将十进制数转换为年和月 SQL*Plus

> ID：14862128
> 
> 赞同：1
> 
> 时间：2013-02-13T20:06:18.417
> 
> 标签：sql, oracle, sqlplus

我试图从给定的 DOB 中获取以年和月为单位的年龄。现在，我的代码如下所示：

```
COLUMN name FORMAT A25
SELECT sNo, fName||CHR(13)||lName Name, sex, TRUNC((CURRENT_DATE - dob) / 365.24, 1) Age
FROM Staff
WHERE position IN ('Manager', 'Secretary')
ORDER BY age DESC; 
```

它给了我十进制数字（例如 58.6）的年龄输出，我理解，但我需要以某种方式将 0.6 转换为一个月。

我认为我进行这种转换的方法不是最有效的，但我一直在寻找解决方案数小时，但无济于事。我见过 DATEDIFF，但在尝试使用它时不断收到无效标识符错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:21:53.337

像这样的东西怎么样：

```
SELECT sNo, fName||CHR(13)||lName Name, sex, 
  TRUNC((CURRENT_DATE - dob) / 365.24, 1) Age,
  TRUNC(MONTHS_BETWEEN(CURRENT_DATE, dob) / 12) YEARS,
  MOD(TRUNC(MONTHS_BETWEEN(CURRENT_DATE, dob)), 12) MONTHS
FROM Staff
WHERE position IN ('Manager', 'Secretary')
ORDER BY age DESC; 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!4/f3a57/1)。

这也应该让你过上好日子：[http ://sqlfiddle.com/#!4/f3a57/4](http://sqlfiddle.com/#!4/f3a57/4)

```
SELECT sNo, fName||CHR(13)||lName Name, sex, 
  TRUNC((CURRENT_DATE - dob) / 365.24, 1) Age,
  TRUNC (MONTHS_BETWEEN (CURRENT_DATE, dob) / 12) YEARS,
  MOD (TRUNC (MONTHS_BETWEEN (CURRENT_DATE, dob)), 12) MONTHS,
  TO_DATE (CURRENT_DATE) - 
      ADD_MONTHS (dob,TRUNC (MONTHS_BETWEEN (CURRENT_DATE, dob))) DAYS
FROM Staff
WHERE position IN ('Manager', 'Secretary')
ORDER BY age DESC; 
```

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:36:28.650

```
SELECT sNo, fName||CHR(13)||lName Name, sex, 
 DATEDIFF(year, dob, Current_Date) - 1 + ' years & ' + dbo.FullMonthSeperation(CURRENT_DATE, dob) + ' months.' AS 'Age'
FROM Staff
WHERE position IN ('Manager', 'Secretary')
ORDER BY age DESC; 
```

[我从Calculating number of full months between two dates in SQL](https://stackoverflow.com/questions/1106945/calculating-number-of-full-months-between-two-dates-in-sql)中借用了函数，因为你必须根据一年中的时间考虑负值和正值......我相信还有更好的方法来计算月份，年份应该是最优的。

希望这适用于 SQL Plus！不过同样的概念。

# django - Mac OS X 上的 Django：OperationalError '角色“_www”不存在'。PostgreSQL 或 Psycopg 问题？

> ID：14862138
> 
> 赞同：1
> 
> 时间：2013-02-13T20:06:43.610
> 
> 标签：django, apache, mod-wsgi, psycopg2, postgresql-9.2

我是使用 Django 进行 Web 开发的新手，所以请多多包涵，并提前感谢您的帮助。

我在学习的时候一直在使用 Django 自己的 web 服务器和 SQLite。但是，现在我正在努力为我的下一个项目设置更复杂的设置。

据我所知，我的设置（Apache、Python、mod_wsgi、PostgreSQL 服务器、psycopg 和 Django）应该可以正常工作。我创建了我的 Django 项目并在我的浏览器上访问了 localhost，在那里我得到了“欢迎使用 Django！它成功了！” 页。但是，当我尝试启用管理员并访问 localhost/admin/ 时，我收到以下错误（请注意，我可以使用 Django 自己的 Web 服务器访问此页面而不会出错）：

```
OperationalError at /admin/
FATAL: Role "_www" does not exist
Request Method: GET
Request URL: http://localhost/admin/
Django Version: 1.4.3
Exception Type: OperationalError
Exception Value: FATAL:  role "_www" does not exist
Exception Location: /Library/Python/2.7/site-packages/psycopg2/__init__.py in connect, line 178 
```

我猜 PostgreSQL 或 psycopg 有问题，但我不确定到底是什么。这就是我到达这里的方式：

1.  Mac OS X Mountain Lion (10.8.2) 全新安装。
2.  从 Mac App Store 安装 Xcode，然后从 Xcode 的首选项安装命令行工具。
3.  没有更新 Apache 或 Python，我使用的是默认安装的任何内容（Apache 2.2.22 和 Python 2.7.2）。
4.  从源代码安装 mod_wsgi 3.4

    ```
    $ curl -O http://modwsgi.googlecode.com/files/mod_wsgi-3.4.tar.gz
    $ tar xvfz mod_wsgi-3.4.tar.gz
    $ cd mod_wsgi-3.4
    $ ./configure
    $ make 
    ```

    （注意：我必须输入以下行才能使“make”工作：）

    ```
    $ sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/ /Applications/Xcode.app/Contents/Developer/Toolchains/OSX10.8.xctoolchain
    $ make install 
    ```

5.  编辑 httpd.conf，添加以下内容并重新启动 Apache：

    ```
    LoadModule wsgi_module libexec/apache2/mod_wsgi.so 
    ```

6.  通过下载 Postgres.app ( [http://postgresapp.com](http://postgresapp.com) ) 并将其复制到我的 Applications 文件夹来安装 PostgreSQL 9.2.2。
7.  运行应用程序，将以下内容添加到我的 ~/.bash_profile（终端默认使用 Postgres.app 的 psql，而不是 Mac OS X 上预装的），然后创建一个新数据库以与我的 django 一起使用项目：

    ```
    PATH="/Applications/Postgres.app/Contents/MacOS/bin:$PATH" 
    ```

8.  从源代码安装 psycopg 2.4.6。我下载了文件，将其解压缩，然后从解压缩的目录中：

    ```
    $ python setup.py install 
    ```

9.  从源代码安装 Django 1.4.3。创建了一个新项目和一个新应用程序。编辑 settings.py 以取消注释管理应用程序并输入我的数据库设置（如 Postgres.app 的网站所述：http: [//postgresapp.com/documentation#toc_3](http://postgresapp.com/documentation#toc_3)）。数据库设置如下所示：

    ```
    DATABASES = {
        'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': 'my_db_name',
        'USER': '',
        'PASSWORD': '',
        'HOST': '',
        'PORT': '',
        }
    } 
    ```

10.  编辑 urls.py 以取消注释与管理相关的行：

    ```
    from django.conf.urls import patterns, include, url

    from django.contrib import admin
    admin.autodiscover()

    urlpatterns = patterns('',
        url(r'^admin/', include(admin.site.urls)),
    ) 
    ```

11.  在 https.conf 末尾添加以下文本：

    ```
    WSGIScriptAlias / /Users/antubel/Projects/Django/antubel_com/antubel_com/wsgi.py
    WSGIPythonPath /Users/antubel/Projects/Django/antubel_com

    <Directory /Users/antubel/Projects/Django/antubel_com>
        <Files wsgi.py>
            Order deny,allow
            Allow from all
        </Files>
    </Directory> 
    ```

12.  重新启动阿帕奇。试图在我的浏览器上加载 localhost/admin/ 并得到上述错误。

请帮忙 ：）

谢谢， 达苏维亚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:31:41.200

因为您的设置文件没有指定连接到 Postgres 的用户，所以您尝试使用运行代码的用户帐户进行连接（并且因为它是由 Apache 下的 mod_wsgi 运行的，所以该用户是`_www`）。

如果您使用 Postgres.app 为您运行 Postgres，您需要将数据库`USERNAME`值设置为系统上您帐户的用户名 - 所以如果您的用户名是`foo`，请设置`USERNAME`为`foo`：

```
DATABASES = {
    'default': {
    'ENGINE': 'django.db.backends.postgresql_psycopg2',
    'NAME': 'my_db_name',
    'USER': 'foo',
    'PASSWORD': '',
    'HOST': '',
    'PORT': '',
    }
} 
```

您还可以更新您的 apache 配置以以不同的用户身份运行您的代码 -如果您想这样做，请查看 mod_wsgi 文档中的[WSGIDaemonProcess 。](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess)

# r - 创建一个将数据框的每个字符列转换为因子一的函数

> ID：14862141
> 
> 赞同：0
> 
> 时间：2013-02-13T20:06:59.483
> 
> 标签：r

我创建了以下函数来将数据帧 (x) 的每个字符列转换为因子一，但我收到一条错误消息，显示为“ **if (e[i]) { 中的错误：参数不可解释为逻辑**。” 任何帮助，将不胜感激。

```
f<-function(x){
e<-lapply(x, is.character)
i <- 1
while (i >= 1) {
if(e[i]) {as.factor(x[[i]])}
else {x[i]}
}
x
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:16:36.703

您可以使用 ：

```
char2factor <- function(df) {
  data.frame(lapply(df, function (v) {
    if (is.character(v)) factor(v)
    else v
  }))
} 
```

例如，如果您有以下数据：

```
df <- data.frame(v1=LETTERS[1:5],v2=1:5,stringsAsFactors=FALSE)
df
#   v1 v2
# 1  A  1
# 2  B  2
# 3  C  3
# 4  D  4
# 5  E  5
lapply(df, class)
# $v1
# [1] "character"
# 
# $v2
# [1] "integer" 
```

你会得到：

```
char2factor(df)
#   v1 v2
# 1  A  1
# 2  B  2
# 3  C  3
# 4  D  4
# 5  E  5
lapply(char2factor(df), class)
# $v1
# [1] "factor"
# 
# $v2
# [1] "integer" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T20:15:14.443

**编辑：** 每 joran 的评论（这可以在一个简洁的行中完成）：

**采用：**

```
data.frame(lapply(dat, "["), stringsAsFactors = TRUE) 
```

**在上下文中：**

```
#make fake data
dat <- data.frame(w = state.abb [1:10], x=LETTERS[1:10], y=rnorm(10), 
   z =1:10, stringsAsFactors = FALSE)
str(dat)

dat2 <- data.frame(lapply(dat, "["), stringsAsFactors = TRUE)
str(dat2) 
```

这是我认为我会采取的方法（**EDIT** -不再）：

```
FUN <- function(x) {
    if (is.character(x)) {
        x <- as.factor(x)
    }
    x
}

for(i in seq_along(inds)) {
    dat[, i] <- FUN(dat[, i])
}

str(dat) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:21:45.203

使用`colwise`from `plyr`，你可以做

```
 dat <- colwise(function(x) {
                        if(is.character(x)) as.factor(x) else x
                    })(dat) 
```

# ruby-on-rails-3.2 - rake jobs:work 给出“PGError: ERROR: SELECT FOR UPDATE/SHARE is not allowed in subqueries”

> ID：14862144
> 
> 赞同：5
> 
> 时间：2013-02-13T20:07:12.970
> 
> 标签：ruby-on-rails-3.2, delayed-job, postgresql-8.4

我正在合并我的 Rails 应用程序的一些更改，其中包括添加延迟作业 gem（看起来很棒）。为了测试它，我：

*   跑了`rails g delayed_job`
*   ran `rake db:migrate`，它创建了delayed_jobs 表
*   重新启动`rails server`（以防万一）
*   重新启动 postgresql 服务（以防万一）
*   跑了`scripts/delayed_job start`
*   执行了一些任务以累积延迟的工作

但是什么也没发生：/我的工作在延迟工作表中，但`locked_at`为空（原样`last_error`）。

所以我尝试`rake jobs:work`了，它给出了一个奇怪的 Postgres 错误：
`PGError: ERROR: SELECT FOR UPDATE/SHARE is not allowed in subqueries` 和一个跟踪：

```
$ rake jobs:work
[Worker(host:robert-vaio pid:21217)] Starting job worker
rake aborted!
PGError: ERROR:  SELECT FOR UPDATE/SHARE is not allowed in subqueries
: UPDATE "delayed_jobs" SET locked_at = '2013-02-13 19:53:46.803085', locked_by = 'host:robert-vaio pid:21217' WHERE id IN (SELECT  id FROM "delayed_jobs"  WHERE ((run_at <= '2013-02-13 19:53:46.792619' AND (locked_at IS NULL OR locked_at < '2013-02-13 15:53:46.792639') OR locked_by = 'host:robert-vaio pid:21217') AND failed_at IS NULL) ORDER BY priority ASC, run_at ASC LIMIT 1 FOR UPDATE) RETURNING *
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:1153:in `async_exec'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:1153:in `exec_no_cache'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:662:in `block in exec_query'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.12/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:661:in `exec_query'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:1248:in `select'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/database_statements.rb:18:in `select_all'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/query_cache.rb:63:in `select_all'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/querying.rb:38:in `block in find_by_sql'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/explain.rb:33:in `logging_query_plan'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.12/lib/active_record/querying.rb:37:in `find_by_sql'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job_active_record-0.4.1/lib/delayed/backend/active_record.rb:63:in `reserve'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:258:in `reserve_and_run_one_job'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:187:in `block in work_off'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:186:in `times'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:186:in `work_off'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:151:in `block (4 levels) in start'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:150:in `block (3 levels) in start'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:149:in `block (2 levels) in start'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:148:in `loop'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:148:in `block in start'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/plugins/clear_locks.rb:7:in `call'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/plugins/clear_locks.rb:7:in `block (2 levels) in <class:ClearLocks>'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:78:in `call'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:78:in `block (2 levels) in add'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `call'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:60:in `block in initialize'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:78:in `call'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:78:in `block in add'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `call'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:65:in `execute'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/lifecycle.rb:38:in `run_callbacks'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/worker.rb:147:in `start'
/home/robert/.rvm/gems/ruby-1.9.3-p327/gems/delayed_job-3.0.5/lib/delayed/tasks.rb:9:in `block (2 levels) in <top (required)>'
Tasks: TOP => jobs:work
(See full trace by running task with --trace) 
```

我不知道出了什么问题——更令人惊讶的是，我能找到其他人问这个问题......！

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T18:42:26.210

我有同样的问题。我通过将延迟作业活动记录的 Gemfile 锁定到版本 0.3.3 解决了这个问题：

宝石'delayed_job_active_record'，'0.3.3'

不工作的 gem 是 0.4.1 版，于 2012 年 2 月 12 日发布。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-21T18:37:50.470

更新 postgres 也为我解决了这个问题——这似乎比锁定回旧版本更可取。并不是说这是*我的*答案，但是当 rmosolgo 回答了他自己的问题时，看起来这个问题确实可以正确地进入“已接受的答案”状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-25T08:35:28.427

这是延迟作业的已知问题，请参阅[https://github.com/collectiveidea/delayed_job_active_record/issues/33](https://github.com/collectiveidea/delayed_job_active_record/issues/33)

有一个delayed_job_active_record 的分支可以在postgres 8.4 中正常工作，并且与rails 4.x 兼容

```
gem 'delayed_job_active_record', :git => 'git@github.com:panter/delayed_job_active_record.git' 
```

它通过使用没有失败查询的 postgres sql 调用来解决问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-11T05:59:08.623

我尝试使用 bt Neil Woods 提供的解决方案，但它显示了一些身份验证问题，然后我尝试在下面添加一些相同的更改。

```
gem 'delayed_job_active_record', :git => 'git://github.com/panterch/delayed_job_active_record.git' 
```

这个解决了，如果有人遇到同样的问题，请尝试这个。

谢谢。

# c# - 从下拉列表中形成一个二进制数

> ID：14862154
> 
> 赞同：0
> 
> 时间：2013-02-13T20:07:55.957
> 
> 标签：c#

因此，我有 8 个下拉列表，其中填充了值 0 和 1。使用从这 8 个下拉列表中选择的值，我想将它们放在一起形成一个二进制数。从那里我将二进制数转换为十进制（十进制输出将显示在文本框中，因此每次更改任何下拉列表中的不同数字时十进制数都会更改）。

但我不确定如何将所有 8 个选定的值组合起来形成一个 8 位二进制数，以便在获得该数字后对其进行转换。关于我应该如何开始这个的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:15:45.207

真正糟糕（但简单）的方法：

```
Convert.ToInt32(dd7.Text + dd6.Text + dd5.Text + dd4.Text + 
                dd3.Text + dd2.Text + dd1.Text + dd0.Text, 2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:10:36.377

对于每个“位”，移动它。

因此，如果最高位为 1，则执行 1 << 8

然后，按位或 (|) 创建最终的二进制数。

```
int i = 1 << 8;
i |= (0 << 7);
i |= (1 << 6); 
```

我在上面使用的值 (1, 0, 1 ..) 应该来自您的下拉框。

如果将下拉框放入列表或数组中，则可以非常简洁地将整个代码编写为：

```
int x = 0;
for (int i=dropdowns.Length - 1; i >= 0; i--) {
x |= int.Parse(dropdowns[i].Text) << i;    
} 
```

这也允许您使用可变数量的下拉菜单。

# android - Phonegap 应用程序上 -webkit-user-modify 的文本区域问题（键盘消失）

> ID：14862157
> 
> 赞同：1
> 
> 时间：2013-02-13T20:08:12.077
> 
> 标签：android, html, css, cordova, textarea

我正在 Phonegap 中开发应用程序，并在我的 textarea 上有一些样式：

```
    文本区域 {
     背景：url(img/ynxjD.png) 重复-y；
     宽度：600px；
     高度：300px；
     字体：普通 14px verdana；
     行高：25px；
     填充：2px 10px；
     边框：实心 1px #ddd;
    }

```

因为Android浏览器在输入元素和textarea（如覆盖）上有默认样式，基本上当我点击我的textarea时，所有样式都消失了，并且出现了带有绿色角的又大又丑的白色矩形，我找到了一个解决方法：

```
    文本区域 {
        -webkit-user-modify：只读-写-纯文本；
        -webkit-tap-highlight-color: rgba(255,255,255,0);
    }

```

如此处所述： [禁用 Android 浏览器的输入覆盖？](https://stackoverflow.com/questions/9423101/disable-android-browsers-input-overlays) 一切都很好，但是当我在 textarea 中写入并转到新行时，android 键盘消失了，我需要再次单击才能出现，而且每一行都是如此。

如果这很重要，我正在测试 HTC 渴望 X，如果有人帮我解决这个问题，我会很高兴:)

# jquery - 单击并拖放相同的元素

> ID：14862160
> 
> 赞同：1
> 
> 时间：2013-02-13T20:08:19.160
> 
> 标签：jquery, drag-and-drop, slideshow, draggable

我有一个带有图像的幻灯片，它通过拖放向右/向左移动到下一个图像。

但是，当我在图像中添加 href 以打开灯箱窗口时，我遇到了困难。

在这里你可以看到一个例子：

[http://www.digitalpersone.com.br/slide/Example_8.html](http://www.digitalpersone.com.br/slide/Example_8.html)

当我在图像中单击时，会显示灯箱，但是当我拖放时，也会发生同样的情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:19:11.437

Are you using the jquery draggable? if so, it adds a css class 'ui-draggable-dragging' when you drag.

Inside the click event, you can then check if that class exist and exit the method.

```
$(function(){
    $div = $('#content'); // <div id="content">click me</div>
    $div.draggable();  
    $div.on('click', function(){
        if ($div.hasClass('.ui-draggable-dragging')) {
              return;
        }
        alert('clicked');
  });

}) 
```

Example here: [http://jsbin.com/ayoqiw/10/](http://jsbin.com/ayoqiw/10/)

# javascript - 对象项的 i18next-node 问题

> ID：14862166
> 
> 赞同：0
> 
> 时间：2013-02-13T20:08:37.003
> 
> 标签：javascript, node.js, internationalization

我正在使用 i18next 本地化一个网站，在我的 /locales/dev/translation.json 我有以下内容：

```
 "guide": {
    "sections": {
        "the-basics": {"title": "The Basics",
                        "contents": [{"title": "Introduction",
                                        "content": {"p1": "", "p2": "", "p3": ""}}
                                    ,{"title": "A Chapter in the Zeitgeist Movement",
                                        "content": {"p1": "", "p2": "", "p3": ""}}
                                    ]
                        }
        ,"setting-up-a-national-chapter": {"title": "Setting up a National Chapter",
                        "contents": [{"title": "Gathering Volunteers & Social Media",
                                        "content": {"p1": "", "p2": "", "p3": ""}}
                                    ]
                        }
    }
  } 
```

我的模板就像：

```
aside#nav-container(role="complementary")
    nav#primary-nav.overview(role="nav")
        - for(var i in items)
            h3.section
                span.menu-toggle
                span(data-content=""+i data-i18n="guide.sections."+i+".title")=i18n.t("guide.sections."+i+".title")
            ul.sub-section
                - var contents = items[i].contents
                - for(var c in contents)
                    li
                        - console.log(contents[c].title) // returns the correct item title
                        a.nav-link(href="#" data-content=""+c data-i18n="guide.sections."+i+".contents.title")=i18n.t("guide.sections."+i+".contents.title") 
```

这只是返回 "guide.sections."+i+".contents.title"

问题是这`"guide.sections."+i+".contents"`是一个包含一个或多个项目的对象！

当我检查代码时，我得到以下信息：

```
<ul class="sub-section active"><li><a href="#" class="nav-link" data-content="0" data-i18n="guide.sections.the-basics.contents.title">guide.sections.the-basics.contents.title</a></li><li><a href="#" class="nav-link" data-content="1" data-i18n="guide.sections.the-basics.contents.title">guide.sections.the-basics.contents.title</a></li></ul> 
```

我已启用`.sub-section.i18n()`

使 i18next 显示正确翻译项的正确方法是什么？

任何建议非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T07:17:49.433

只有启用返回对象时，guide.sections.the-basics.contents.title 才会返回对象 {"p1": "", "p2": "", "p3": ""}：

[http://i18next.com/pages/doc_features.html#objecttree](http://i18next.com/pages/doc_features.html#objecttree)

要正确解析此对象（多个段落），您需要添加一个后处理器，将对象转换为有效的 html：

[http://i18next.com/pages/doc_features.html#postprocessing](http://i18next.com/pages/doc_features.html#postprocessing)

# javascript - 连接两个表单数据

> ID：14862169
> 
> 赞同：1
> 
> 时间：2013-02-13T20:08:55.837
> 
> 标签：javascript, jquery

我正在尝试连接表单中的两个表单部分：单选按钮值和下拉列表值。

我想提交表单并将此连接值作为隐藏值提交，而不提交单选按钮和下拉列表值。

我试过的：

```
<script>
$('#lot1, #lotdet').bind('keypress blur', function() {

    $('#lot').val($('#lot1').val() + ' ' +
                             $('#lotdet').val();
});
</script> 
```

HTML：

```
Lot Change?:
Yes
<input id='lot1' name='lot1' type='radio'  value='Yes' onclick='showSelect();' />
No
<input id='lot1' name='lot1' type='radio'  value='No' onclick='hideSelect();' />

<select id='lotdet' class='hide'>
<option value=' '></option>
<option value='PGS'>PGS</option>
<option value='PGMIS'>PGMIS</option>
<option value='DTDMAS'>DTDMAS</option>
</select>
<input type='hidden' id='lot' name='lot' value=$lot> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:11:58.770

您的线路和线路缺少`)`：

```
$('#lot').val($('#lot1').val() + ' ' +
                             $('#lotdet').val(); 
```

应该：

`$('#lot').val($('#lot1').val() + ' ' + $('#lotdet').val());`

另外：表单中的**ID**应该是**唯一的**

为您创建了一个小提琴：http: [//jsfiddle.net/c7qQq/1/](http://jsfiddle.net/c7qQq/1/)

# php - 使用当前货币兑换率动态更新表格

> ID：14862170
> 
> 赞同：1
> 
> 时间：2013-02-13T20:08:56.867
> 
> 标签：php, html-table

**编辑**：

好吧，由于 jimmy 的链接，我得到了它的工作。这是我用来转换的代码，以防其他人想尝试同样的事情。这最适用于您知道基本固定或不经常更改的数字。确保删除由 /// 表示的注释，以便在使用下面的代码时没有浮动文本。另请注意，结果是近似的，因此您可能需要添加一个说明相同内容的部分。责任的东西。

从 Google 的 API 获取数据所需的代码：

```
<?php

function currency($from_Currency,$to_Currency,$amount) {
$amount = urlencode($amount);
$from_Currency = urlencode($from_Currency);
$to_Currency = urlencode($to_Currency);
$url = "http://www.google.com/ig/calculator?hl=en&q=$amount$from_Currency=?$to_Currency";
$ch = curl_init();
$timeout = 0;
curl_setopt ($ch, CURLOPT_URL, $url);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch,  CURLOPT_USERAGENT , "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)");
curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
$rawdata = curl_exec($ch);
curl_close($ch);
$data = explode('"', $rawdata);
$data = explode(' ', $data['3']);
$var = $data['0'];
return round($var,9); ///the 9 indicates how many decimal points you want. I set it at the API's limit of 9
}
?>

<?php ///turns the exchange rate into a php variable so we can use it later. 
$cad = currency("USD","CAD",1) ; ///The currency code converting from, the currency code converting to, and amount you want to convert. 
?> ///Best use 1 so for a simpler equation. (base amount * exchange rate = how much you'll need)

<?php 
$gbp = currency("USD","GBP",1) ; 
?> 
```

包含内容的表格：

```
<table border="1" style="margin-left: 35px; width:400px;">
<tbody>
<tr>
<td style="text-align:left; width:190px"><strong>Currency</strong></td>
<td style="text-align: center;"><strong>USD</strong></td>
<td style="text-align: center;"><strong>CAD</strong></td>
<td style="text-align: center;"><strong>GBP</strong></td>
</tr>

<tr>
<td style="text-align:left;">Conversion</td>
<td style="text-align: center;">$5000</td> ///the base number I will be using to make the conversion.

<td style="text-align: center;">$<?php 
$basecad = $cad * 5000; ///multiply the base value (in this case $5000) by the conversion ratio stored in our php variable
$basecad = round($basecad, 0); ///rounds it up to 0 decimals for cleanliness
$basecad = number_format($basecad); ///formats it to have commas (1,000 vs 1000)
echo $basecad; ///prints result
?></td>

<td style="text-align: center;">$<?php  ///repeat as necessary for additional currencies or lines
$basegbp = $gbp * 5000;
$basegbp = round($basegbp, 0);
$basegbp = number_format($basegbp);
echo $basegbp;
?></span></td>

</tr>
</tbody>
</table> 
```

**原始问题**

因此，我对正在更新的公司网站有了一个奇怪而有趣的想法。页面详细信息包括几个不同国家之间的货币汇率，以帮助制定旅行计划。我想出的想法是根据页面加载时的汇率更新汇率。这个概念本身与我之前做过的类似，但这次我必须使用第三方生成的 iframe。iframe 本身基本上只是来自[http://themoneyconverter.com/WebTools.aspx的货币表](http://themoneyconverter.com/WebTools.aspx). 它将信息输出到一个表格中，每个表格都包含一个用于任何货币汇率的 id。我现在的问题是如何从 iframe 中提取信息并将其转换为可以在父页面中使用的 PHP 变量。之后是简单的 PHP 计算来输出每个费用结果。主要问题来自我无法修改 iframe 中的信息这一事实。我已经深入研究了互联网，但除了如何将 PHP 变量放入 iframe 中，找不到任何东西，而不是将其取出。下面是 iframe 的示例，即我要提取的部分。任何帮助，无论是有可能还是不可能，都将不胜感激。

我将其提取到的实际表格只是一个 HTML 表格。我将添加一个基本算法来转换每个单元格的货币（即 $var1 x $iframecvar1）。如果您需要更多信息，请提前告诉我并感谢。

```
<table summary="Exchange Rates for Japanese Yen" id="major-currency-table">...
<td><div class="tmc i-USD"> </div></td> 
<td><a target="_blank" ,="" title="United States Dollar" href="/USD/Exchange_Rates_For_US_Dollar.aspx">USD</a></td> 
<td id="USD">0.01070</td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:12:57.617

在您的特定情况下，iframe 正在从 Google 加载 jQuery，并包含来自 themoneyconverter.com 的 Google Analytics - 因此，在您自己的页面上简单地回显它可能会导致不希望的结果。

也就是说，网络抓取可能会变得很棘手，但这里有一个简单的工作流程 - 在 PHP 中获取数据并使用`file_get_contents` [http://php.net/manual/en/function.file-get-contents.php转换为 var](http://php.net/manual/en/function.file-get-contents.php)

```
<?php
$file = file_get_contents('http://themoneyconverter.com/USD/RateTicker.aspx');
//echo the file
echo $file; 
```

如果您想更复杂地抓取内容，我建议 Matthew Turland 的博客或他关于该主题的书：

[http://matthewturland.com/tag/web-scraping/](http://matthewturland.com/tag/web-scraping/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:45:59.013

在不知道您可以更改多少您正在使用的页面或该页面的外观的情况下，我想建议一种替代方法来从 iframe 获取汇率。

[该脚本](http://www.dynamicguru.com/php/currency-conversion-using-php-and-google-calculator-api/)运行良好。

```
<?php
function currency($from_Currency,$to_Currency,$amount) {
$amount = urlencode($amount);
$from_Currency = urlencode($from_Currency);
$to_Currency = urlencode($to_Currency);
$url = "http://www.google.com/ig/calculator?hl=en&q=$amount$from_Currency=?$to_Currency";
$ch = curl_init();
$timeout = 0;
curl_setopt ($ch, CURLOPT_URL, $url);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch,  CURLOPT_USERAGENT , "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)");
curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
$rawdata = curl_exec($ch);
curl_close($ch);
$data = explode('"', $rawdata);
$data = explode(' ', $data['3']);
$var = $data['0'];
return round($var,3);
}

echo currency("GBP","USD",1); 
?> 
```

如果这不能解决您的问题，也许它对其他人有用。

# ruby-on-rails - 测试模块中的控制器

> ID：14862173
> 
> 赞同：1
> 
> 时间：2013-02-13T20:09:06.583
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, controller

我正在使用 Rspec，我想测试一个位于另一个模块内的模块内的控制器。

```
module Food
  module Fruit
    class ApplesController < ApplicationController

    etc... 
```

我目前的 rspec 文件`apples_controller_spec.rb`看起来像

```
require 'spec_helper'

  describe ApplesController do

  etc.. 
```

关于测试两个模块内的控制器，Rspec 的命名约定是什么，因为目前我收到一个错误，即`uninitialized constant BurstsController (NameError)`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:11:12.033

你需要：

```
require 'spec_helper'
module Food
  module Fruit
    describe ApplesController do 
```

或者你可以这样做：

```
require 'spec_helper'

describe Food::Fruit::ApplesController do 
```

我个人使用前者。

# python - `python.exe -c 'print("hello")' 没有输出

> ID：14862175
> 
> 赞同：6
> 
> 时间：2013-02-13T20:09:09.220
> 
> 标签：python, python-2.7

我正在尝试学习 python，但偶然发现了我的另一个愚蠢错误。

对于我从[python.org](http://www.python.org/download/releases/2.7.3/)下载的 2.7.3 版本，我没有得到任何带有`-c`. 我*确实*从 cygwin 获得了 2.6.8 版本的输出。

我错过了什么？

```
> c:\Python27\python.exe --version
Python 2.7.3

> c:\Python27\python.exe -c 'print("hello")'

> c:\Python27\python.exe
Python 2.7.3 (default, Apr 10 2012, 23:24:47) [MSC v.1500 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> print("hello")
hello
>>> exit()

> c:\cygwin\bin\python2.6.exe --version
Python 2.6.8

> c:\cygwin\bin\python2.6.exe -c 'print("hello")'
hello

> c:\cygwin\bin\python2.6.exe
Python 2.6.8 (unknown, Jun  9 2012, 11:30:32)
[GCC 4.5.3] on cygwin
Type "help", "copyright", "credits" or "license" for more information.
>>> exit() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T20:15:21.313

尝试在程序周围不使用单引号：

```
python -c print(\"hello\") 
```

使用单引号，我猜它会将输入解释为字符串，因此不会进行打印。您还需要转义程序本身中的双引号。

**编辑：**

您不需要转义单引号，因此您可以这样做：

```
python -c print('hello') 
```

或者

```
python -c "print('hello')" 
```

（这是原始示例，只是交换了引号类型）

# javascript - 如何动态更改 Javascript 高度

> ID：14862178
> 
> 赞同：0
> 
> 时间：2013-02-13T20:09:16.840
> 
> 标签：javascript, dynamic, height

我知道这个问题被问了很多，我向你保证我已经阅读了大部分答案。但是，就我而言，这些都对我不起作用。我目前正在尝试这个：

```
window.onload = function(){

    var winWidth = parseInt(window.innerWidth);
    var winHeight = parseInt(window.innerHeight);

    document.getElementById("copyRight").innerHTML = winHeight;
    //This is so I could make sure the height was actually changing. It is.

    document.getElementById("grandeContain").style.width = winWidth-15+"px";
    document.getElementById("grandeContain").style.height = winheight+"px";
    document.getElementById("contain").style.width = winWidth-105+"px";
    document.getElementById("contain").style.height = winHeight-90+"px";
    document.getElementById("outside").style.width = winWidth-105+"px";
    document.getElementById("outside").style.height = winHeight-90+"px";
    document.getElementById("aroundToolBar").style.height = winHeight-90+"px";
} 
```

但是，无论我做什么，高度都不会改变`onload`（我也有这个副本并粘贴到一个`onresize`函数中，但这也不起作用）。宽度部分工作正常（不仅仅是因为这是 div 的默认设置；我已经基于许多不同的宽度进行了测试`window.innerWidth`并且它改变了）但高度拒绝改变。我究竟做错了什么？我一直很难动态改变高度，如果我能一劳永逸地解决这个问题，那就太好了。

此外，如果 css 与它有任何关系，那么 div 树是这样的：`grandeContain>contain>(aroundToolBar+outside)`where `contain`is `position:relative`, `aroundToolbar`is `float:left`and `width:125px`, and `outside`is `position:relative`with `margin 0 0 0 125px`。

有谁知道我在这里做错了什么？

此外，由于 div 中有页眉和页脚，因此 105 和 90 是唯一存在的`grandeContain`，它们的兄弟包含。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:18:15.203

你检查了萤火虫的错误吗？好像就行了：

```
document.getElementById("grandeContain").style.height = winheight+"px"; 
```

你有一个错字： 应该`winHeight+"px"`代替`winheight+"px"`; 可能会导致变量未定义错误。

# c# - WebDav - 收到通知后“仅”获取新邮件

> ID：14862180
> 
> 赞同：0
> 
> 时间：2013-02-13T20:09:20.780
> 
> 标签：c#, webdav

我决定写在这里，因为我有一个问题。我想在 C# 中使用 WebDav 协议从 Exchange Server 获取“仅”新邮件。

我从微软网站下载了“Exchange SDK”：

[http://msdn.microsoft.com/en-us/library/ms878​​023%28v=exchg.65%29.aspx](http://msdn.microsoft.com/en-us/library/ms878023%28v=exchg.65%29.aspx)

我尝试使用了一篇名为“使用通知示例应用程序”的文章。（本SDK使用“POLL”方式）

一切都很好，因为我使用了 Microsoft 编写的这段代码，它展示了如何使用 WebDav 协议使用 Notify 并在您的应用程序中使用。

当新邮件到来时，我能够通知用户这一点，然后我从 Exchange Server“下载”或“检索”邮件。

但是让我非常沮丧的一件事是，在收到通知的新邮件后，我只能“获取”例如：Exchange Server 上收件箱文件夹中的“所有邮件”，但我希望能够“获取，检索”仅来自 Exchange Server 的“新”邮件。

是否有可能做到这一点 ？

我在互联网上阅读了很多文章，但我找不到任何令人满意的答案。

如果我可以阅读例如“a:href”来获取新邮件，那就太好了。

我想收到最后一封未读邮件...

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T07:17:09.703

看起来使用 WebDAV 协议并不容易。我们在 Exchange 2003 上的开发遇到了问题，最后决定购买第三方组件“WebDAV .NET for Exchange”。这使开发更容易。

WebDAV 中的通知不会给您 HRef，您必须进行搜索。

# c# - MVC DropDownList 帮助 - 选择不起作用

> ID：14862181
> 
> 赞同：1
> 
> 时间：2013-02-13T20:09:23.370
> 
> 标签：c#, asp.net-mvc, vb.net

我是 MVC 的新手，正在处理一个已经存在的项目。我只是想填写一个下拉列表以允许更改订单。当页面加载时，我需要设置下拉选择值。

视图上的模型只有几个属性，然后是一个类型列表，通过迭代生成页面上的数据。这些项目包含 displayorder 属性

我的问题是关于订单的。此视图用于更改页面上记录的显示顺序。所以有一个检查来查看基于类型的最大显示顺序，然后将 selectlistitmes 添加到下拉列表中。下拉列表填充得很好，但您可以看到 selected 属性也已设置，但是在呈现页面时这不起作用。我总是显示第一个项目。我认为问题出在这里： <%=Html.DropDownListFor(Function(x) x.Location, Options)%>

我想我想要的是 x.DisplayOrder （项目包含 displayorder 属性），但这不是模型的一部分。它是我们正在迭代的列表的一部分。

任何帮助，将不胜感激。

```
<td>
<%Dim Options As New List(Of SelectListItem)%>
<%For intDisplayOrder As Integer = 1 To Model.ReviewTypes(item.ReviewType)
Dim newSelectedItem As New SelectListItem
newSelectedItem.Text = intDisplayOrder.ToString()
newSelectedItem.Value = intDisplayOrder.ToString()

If intDisplayOrder = item.DisplayOrder Then
newSelectedItem.Selected = True

End If

Options.Add(newSelectedItem)
Next

%>

<%=Html.DropDownListFor(Function(x) x.Location, Options)%>

</td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:33:57.760

您需要设置用于在页面加载时保存下拉值的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:55:40.427

我认为您需要将此部分放在控制器中，并使用 formCollection.DisplayOrder 设置下拉列表的选定项

```
<%Dim Options As New List(Of SelectListItem)%>
<%For intDisplayOrder As Integer = 1 To Model.ReviewTypes(item.ReviewType)
Dim newSelectedItem As New SelectListItem
newSelectedItem.Text = intDisplayOrder.ToString()
newSelectedItem.Value = intDisplayOrder.ToString()

If intDisplayOrder = item.DisplayOrder Then
newSelectedItem.Selected = True

End If

Options.Add(newSelectedItem)
Next

%> 
```

# python - 魔术命令 %edit 应该在 iPython 中调用 IDLE

> ID：14862184
> 
> 赞同：1
> 
> 时间：2013-02-13T20:09:31.407
> 
> 标签：python, ipython, python-idle

在 iPython 中执行 %edit 时是否可以在 linux 中打开 IDLE 而不是默认的 vi？如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:42:51.447

摘自`%edit?`

```
%edit runs IPython's editor hook. The default version of this hook is
set to call the editor specified by your $EDITOR environment variable.
If this isn't found, it will default to vi under Linux/Unix and to
notepad under Windows. See the end of this docstring for how to change
the editor hook.

You can also set the value of this editor via the
``TerminalInteractiveShell.editor`` option in your configuration file.
This is useful if you wish to use a different editor from your typical
default with IPython (and for Windows users who typically don't set
environment variables).

.... 
```

所以我想你可以在 $EDITOR 或 .ipython/profile_xxx/[right configfile].py 中设置 IDLE

# sql - 包含使用列而不是文本值或变量的全文索引

> ID：14862187
> 
> 赞同：2
> 
> 时间：2013-02-13T20:09:40.360
> 
> 标签：sql, indexing, contains, full-text-search

我正在尝试运行一个查询，其中我在一列上有一个全文索引，并且我想运行一个包含语句的查询，其中该列正在寻找与另一个表中的列匹配...而不是静态文本值或变量....这甚至可能吗？

```
select a.field1, a.field2, c.x, c.y, c.z
from dbo.TableA a
cross apply(select x,y,z
            from dbo.TableB b
            where contains(b.x, a.field1) 
```

C

谢谢！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:51:48.853

这种方式是不可能的，但你可以使用它。在这种情况下，我使用 SELECT 语句创建 (|) 分隔列表。可以使用条形符号 (|) 代替 OR 关键字来表示 OR 运算符。

```
DECLARE @Searchwords nvarchar(4000) = N''
SELECT @Searchwords += '|' + a.field1
FROM dbo.TableA a
SELECT @Searchwords = STUFF(@Searchwords, 1, 1, '')

SELECT b.x, b.y, b.z
FROM dbo.TableB b
WHERE CONTAINS(b.x, @Searchwords) 
```

# ruby - Rails 3：循环显示的记录多于应有的记录

> ID：14862196
> 
> 赞同：2
> 
> 时间：2013-02-13T20:10:22.000
> 
> 标签：ruby, ruby-on-rails-3, loops, erb

不完全确定如何称呼这个问题。对 Rails 还是很陌生。

情况：*拍卖*包含许多*批次*。
我在*/auctions/3/lots/*之类的 url 中显示拍卖的地段。

看法：

```
<ul>
<% @lots.each do |lot| %>
  <li><%= lot.auction_id %>: <%= lot.id %></li>
<% end %>
</ul> 
```

输出这个：

```
<ul>
  <li>3: 1</li>
  <li>3: </li>
</ul> 
```

我的数据库中只有*很多*。不确定额外的循环实例来自哪里。无论我在看哪场*拍卖*
， 这都会发生在任何*拍卖品上。*

 *此外，
`<%= @lots.length %>`显示 2
`<%= @lots.size %>`显示 2
`<%= @lots.count %>`显示 1

我的lots_controller 看起来像这样：

```
def index
  @auction = Auction.find(params[:auction_id])
  @lots = @auction.lots
end

def create
  @auction = Auction.find(params[:auction_id])
  @lot = @auction.lots.build(params[:lot])

  if @lot.save
    redirect_to auction_lots_path, :notice => 'Lot was successfully created.'
  else
    render :action => "index"
  end
end 
```

我的模型：

```
class Auction < ActiveRecord::Base
  ...
  has_many :lots
end

class Lot < ActiveRecord::Base
  belongs_to :auction
  ...
end 
```

`...`s 只是`attr_accesssible`和`validates`线条。

请求我点击页面时的日志，在这里。

```
Started GET "/auctions/8/lots" for 127.0.0.1 at 2013-02-13 16:35:51 -0500
Processing by LotsController#index as HTML
  Parameters: {"auction_id"=>"8"}
  Auction Load (0.1ms)  SELECT "auctions".* FROM "auctions" WHERE "auctions"."id" = ? LIMIT 1  [["id", "8"]]
  Lot Load (0.2ms)  SELECT "lots".* FROM "lots" WHERE "lots"."auction_id" = 8
[#<Lot id: 18, description: "1923 Morgan", lot_number: 1, auction_id: 8, created_at: "2013-02-13 17:20:04", updated_at: "2013-02-13 17:20:04">]
  Rendered layouts/_messages.html.erb (0.1ms)
  Lot Exists (0.2ms)  SELECT 1 AS one FROM "lots" WHERE "lots"."auction_id" = 8 LIMIT 1
  Rendered lots/index.html.erb within layouts/application (9.4ms)
Completed 200 OK in 21ms (Views: 17.8ms | ActiveRecord: 0.5ms) 
```

**更新：**
有人提到它看起来像我在`@auction.lots.build`某处使用。
是的，我是。我在同一页面（索引）上有一个表格，我可以在其中添加很多内容。

```
<%= form_for(@auction.lots.build, :url => auction_lots_path(@auction)) do |f| %>
  ...
<% end %> 
```

更改`@auction.lots.build`摆脱了多余的行，尽管现在我无法成功创建很多。我不知道该怎么办。我可能必须在lots_controller 的索引方法中设置一些东西，但我不知道是什么。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:02:34.087

如果批次未能保存，这将在您的 create 方法中发生。因为您使用`@auction.lots.build`了 ，所以在拍卖中附加了很多记录。如果它没有正确保存，它仍然存在未保存。这就解释了为什么“神秘”没有 id，以及为什么：

`<%= @lots.size %>`显示 2 `<%= @lots.count %>`显示 1

`@lots.count`是一个数据库查询，但`@lots.size`只是内存中数组的大小。

我可能会在创建操作中做更多类似的事情：

```
def create
  @auction = Auction.find(params[:auction_id])
  @lot = @auction.lots.create!(params[:lot])
  redirect_to auction_lots_path, :notice => 'Lot was successfully created.'
rescue ActiveRecord::RecordInvalid
  render :action => "index"
end 
```

...但当然其他人会更喜欢使用 if/else 而不是抢救异常。还有其他方法可以解决这个问题。你可以`@auction.reload.lots`剔除未保存的，但这有点奇怪。在这种情况下，正常的 rails 操作是重新渲染显示验证错误的表单，并要求用户修复它们并尝试再次创建。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T21:20:29.990

This should help:

```
def create
  params[:lot].merge!({:auction_id =>  params[:auction_id]})
  @lot = Lot.new(params[:lot])

  if @lot.save
    redirect_to auction_lots_path, :notice => 'Lot was successfully created.'
  else
    render :action => "index"
  end
end 
```*

# time-complexity - 无限运行程序的时间复杂度

> ID：14862197
> 
> 赞同：0
> 
> 时间：2013-02-13T20:10:21.573
> 
> 标签：time-complexity

以下程序段的时间复杂度是否可能为 O(2^n)？我很困惑

```
n=1;
for j=1 to n do
 output(j);
 n=2*n;
end {for} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:12:48.743

不，这是 O(n)。

您只是将 n 提高到 2^n 次方。

这是因为循环的迭代次数是“n”，无论最终答案或其中的计算如何。

# java - 如何在 .java 文件中使用 @string/xyz？

> ID：14862199
> 
> 赞同：0
> 
> 时间：2013-02-13T20:10:28.800
> 
> 标签：java, android

我创建了一个“hello world”Android 项目，我想在**MainActivity.java**中使用我的字符串。在**string.xml**文件中，我有一个名为的字符串`password`

如何将此字符串*调用到我的***MainActivity.java**？

```
<string name="password">Your password is:</string> 
```

**MainActivity.java**的一部分

 **```
 ....
    ....
    //Show password on click
    showBTN.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
        //i want to use a string called from string.xml instead of hard coded
            resTXT.setText("Your password is:"+ pass);
        }
    });

   ....
   .... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:13:04.783

采用：

```
final String passwordText = getString(R.string.password);

//Show password on click
showBTN.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
    //i want to use a string called from string.xml instead of hard coded
        resTXT.setText(passwordText + pass);
    }
}); 
```

Context 中的[getString()](http://developer.android.com/reference/android/content/Context.html#getString%28int%29)方法旨在从 XML 中检索字符串资源。如果您想保留任何丰富的格式，请使用[getText()](http://developer.android.com/reference/android/content/Context.html#getText%28int%29)方法，也在 Context 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:12:13.463

使用`R.string.password`. Android 从您的资源中自动生成一个 R 文件**

# perl - perl中的“$a->{$1}”是什么意思

> ID：14862203
> 
> 赞同：-2
> 
> 时间：2013-02-13T20:10:49.610
> 
> 标签：perl

我想知道 perl 中“->”的确切含义是什么。据说它是一个解引用运算符。那么有人可以更清楚地解释它吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:15:48.303

当你有一个哈希时，它是这样的：

```
my %hash = ( "a" => "123", "b" => "256" ); 
```

然后你使用`$hash{"a"}`符号来引用元素。

但在某些情况下，您可能希望引用哈希，而不是哈希本身。

这可以通过多种方式完成，例如：

```
my $reference = \%hash; 
```

或者

```
my $hash_ref = { "a" => "123", "b" => "256" }; 
```

当您在变量中有哈希引用时，您必须在获取值之前取消引用它。这就是 -> 运算符的用武之地，例如：

```
$hash_ref->{"a"} 
```

# sql-server - EXEC 选择查询不适用于临时表 SQL Server 2005

> ID：14862206
> 
> 赞同：0
> 
> 时间：2013-02-13T20:11:07.993
> 
> 标签：sql-server, sql-server-2005

我有这个 SQL Server 2005 拼图

以下代码不起作用

```
 DECLARE @tmp TABLE  (ID  int IDENTITY PRIMARY KEY , strDateTime varchar(50)) 
 INSERT INTO @tmp VALUES('1/2/13') 

 DECLARE @x varchar(1000) 
 SET @x = 'SELECT * FROM ' + @tmp ;
 EXEC (@x) 
```

我收到以下错误

> *Msg 137, Level 15, State 2, Line 5
> 必须声明标量变量“@tmp”。*

如果我这样做

```
SET @x = 'SELECT * FROM  @tmp ' ; 
```

我收到这个错误

> *Msg 1087, Level 15, State 2, Line 1
> 必须声明表变量“@tmp”。*

好吧，我真正想做的是将动态列名传递给 select 语句，但我发现我也不喜欢那样

有人可以指导我做错了什么

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:14:34.243

[表变量仅在创建它的范围内有效](http://msdn.microsoft.com/en-us/library/ms175010.aspx)：

> 表变量的行为类似于局部变量。它有一个明确的范围。这是声明它的函数、存储过程或批处理。

为此，您需要使用临时表：

```
 CREATE TABLE #tmp (ID  int IDENTITY PRIMARY KEY , strDateTime varchar(50)) 
 INSERT INTO #tmp VALUES('1/2/13') 

 DECLARE @x varchar(1000) 
 SET @x = 'SELECT * FROM #tmp';
 EXEC (@x) 
```

# php - php搜索模块

> ID：14862210
> 
> 赞同：1
> 
> 时间：2013-02-13T20:11:20.907
> 
> 标签：php, mysql, search, content-management-system

在为我的网站创建搜索结果页面时，我需要您的帮助。它是一个简单的 php cms 站点，只是从 mysql 中获取内容。使用简单查询来获取搜索

```
$search = $_GET["search"];
$search = preg_replace('#[^0-9]#i','',$_GET['search']);

$searchresult = mysql_query ("SELECT * FROM pages WHERE pgcontent LIKE '%$search%'");   

    while ($row = mysql_fetch_array($searchresult)) 
    {
        echo '<h3>' . $row["PageTitle"] . '</h1>';
        echo '<p>' . $row["PageContent"] . '</p><br /><br />';  
    } 
```

我想要做的不是显示整个页面内容，只是显示任何单词与搜索词匹配的行......或者只是找到搜索词的页面的前几行。

朋友们可以帮我做这件事吗？这将是一个很大的帮助......谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:16:31.867

你可以运行后期处理`$row["PageContent"]`

就像是

```
while ($row = mysql_fetch_array($searchresult)) 
{
    echo '<h3>' . $row["PageTitle"] . '</h3>';

    $position = strpos($row["PageContent"], $search);
    $snippet = substr($row["PageContent"], $position - 100, $position + 100);

    echo '<p>' . $snippet . '</p>';
    echo '<br /><br />';  
} 
```

您的片段从匹配术语的开头开始 100 个字符并在术语开始后的 100 个字符处结束。显然，您可以将其调整为您想要的任何内容，但这是基本思想。

如果我错过了这一点，请告诉我，我可能会更新。

# apache - c3p0 ComboPooledDataSource 的加密密码

> ID：14862211
> 
> 赞同：2
> 
> 时间：2013-02-13T20:11:22.667
> 
> 标签：apache, hibernate, jakarta-ee, tomcat, c3p0

我目前有一个 server.xml 配置，其中包含以下内容

```
<Resource auth="Container"
    description="DB Connection"
    driverClass="oracle.jdbc.driver.OracleDriver"
    maxPoolSize="40"
    minPoolSize="2"
    aquireIncrement="1"
    name="jdbc/FOOBAR"
    user="foo"
    password="bar"
    factory="org.apache.naming.factory.BeanFactory"
    type="com.mchange.v2.c3p0.ComboPooledDataSource"
    jdbcUrl="path:to:db:port:db" /> 
```

出于显而易见的原因，我要求不再允许用户名/密码在 server.xml 文件中以明文形式出现。

我在线阅读了一些内容，并遇到了[How to Secure Tomcat Database Passwords for Java](http://java.sys-con.com/node/393364/print) [Encrypt Tomcat Server.xml](http://scribblejava.wordpress.com/2010/03/23/encrypt-username-and-password-for-jndi-in-tomcat-server-xml/)和许多其他页面中 JNDI 的用户名和密码；但是，我有点卡住了。

我首先查看了扩展 BasicDataSourceFactory - 但由于我使用 c3p0 CombinedPooledDataSource 似乎无法发生。然后我试图通过实现 PooledDataSource、Serializable 和 Referenceable 来创建一个 c3p0 数据源包装器，但这也不起作用。

我读到我可以通过使 auth="Container" => auth="Application" 将身份验证移动到服务器端。但是，我不确定如何使用 Hibernate 来实现其余部分。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:06:48.587

因此，这将不是一个高安全性的解决方案。

但是解决这个问题的一个简单方法是利用 c3p0 的“密码”属性只是一个可配置的 c3p0 属性这一事实，可以通过多种方式进行设置。因此，您可以创建一个 c3p0.properties 文件和/或一个 c3p0-config.xml 文件，并在那里设置密码。或者，您可以确保在运行 JVM 时设置了系统属性 c3p0.password。

如果您有多个具有不同密码的数据源，则需要使用 c3p0 的命名配置功能，即 c3p0-config.xml 文件。

c3p0 config（c3p0.properties 和 c3p0-config.xml）文件可以卡在应用程序有效 CLASSPATH 中的 jar 文件的顶层。（使用 tomcat，您必须注意 Web 应用特定的 ClassLoader 和更广泛共享的位置之间的区别。）因此，您可以将密码嵌入压缩的 jar 文件而不是纯文本文件中。显然，这是不安全的：明文只是“解压缩”而已。但它会防止密码被随意greppable等。

请参阅[http://www.mchange.com/projects/c3p0/#configuration_files](http://www.mchange.com/projects/c3p0/#configuration_files)

祝你好运！

# sql - SQL Server 2008 错误 18456 状态 58，用户“登录失败”

> ID：14862217
> 
> 赞同：7
> 
> 时间：2013-02-13T20:11:40.513
> 
> 标签：sql, sql-server-2008, login

我有一个 Visual Studio C++ 项目（非托管 C++），我在其中尝试连接到 LAN 中另一台机器上的 SQL Server 2008 实例。我使用 TCP/IP。我的连接字符串是：

```
"DRIVER={SQL Server Native Client 10.0};Server=tcp:169.254.204.232,1433;Network Library=DBMSSOCN;Initial Catalog=myDB;User ID=myDBUser;Password=myPassword;" 
```

**重要事实：**我能够使用 SSMS 使用用户 id myDBUser 和密码 myPassword 成功远程连接到该实例——使用 SQL 身份验证模式（并在连接选项中指定 TCP/IP）！此外，一旦登录，我就可以成功导航数据库 myDB。

所以是的，我在我的服务器上启用了混合模式身份验证。

另请注意，当我的实例位于本地并且我使用 Windows 身份验证时，相同的代码已成功连接。换句话说，自从整个事情最后一次工作以来发生的变化是我将我的服务器移动到另一台机器上，现在正在使用 SQL 身份验证，因此更改了我的连接字符串——否则代码根本没有改变。

这是我在 SQL Server 2008 实例的服务器日志中收到的错误消息：

用户“登录失败。原因：尝试使用 SQL 身份验证登录失败。服务器配置为仅用于 Windows 身份验证。错误：18456，严重性：14，状态：58。

请注意，该错误消息中引用的用户是空白的，即使在我的连接字符串中我指定了一个非空白用户 ID。

我尝试过的其他连接字符串给出了相同的结果：

```
"DRIVER={SQL Server Native Client 10.0};Server=MACHINE2;Database=myDB;User ID=myDBUser;Password=myPassword;" (where MACHINE2 is the windows name of the machine hosting the sql server instance.) 
```

我没有在上面的连接字符串中指定实例名称，因为我的实例安装为默认实例，而不是命名实例。

关于如何解决这个问题的任何想法？

**更新：我似乎解决了这个问题。您准备好发现该错误消息是多么愚蠢和完全无关吗？在连接字符串中，我只是将“用户 ID”更改为“uid”，将“密码”更改为“pwd”，现在它可以工作了。我现在在我的 SQL Server 日志中看到“连接成功”...**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-13T22:21:52.663

`SELECT SERVERPROPERTY('IsIntegratedSecurityOnly');`如果返回 1 is Windows Authentication if 0 Mixed，请尝试运行。如果它返回 1 肯定是 Windows 身份验证，肯定还有其他问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-01T05:33:48.003

我想我通过这样做解决了这个问题......

右键单击对象资源管理器上的服务器名称 -> 属性 -> 安全 -> 将服务器身份验证更改为 SQL 服务器和 Windows 身份验证模式 -> 单击确定。

之后在对象资源管理器上打开服务器 -> 展开安全性 -> 展开登录 -> 右键单击​​您的登录名 ->​​ 属性 -> 输入新密码 -> 确认密码 -> 确定。

然后断开 SQL 并重新启动系统。然后在 sql 身份验证模式下使用更改的密码登录 SQL Server 2008。

谢谢 ：）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-02T21:30:34.413

答案：在连接字符串中，我只是将“用户 ID”更改为“uid”，将“密码”更改为“pwd”，现在它可以工作了。我现在在我的 SQL Server 日志中看到“连接成功”...

# javascript - 我可以在 Coffeescript 中继承类定义代码吗？

> ID：14862218
> 
> 赞同：2
> 
> 时间：2013-02-13T20:11:49.203
> 
> 标签：javascript, coffeescript

基本上，我想做类似的事情：

```
class Animal
  @type: 'animal'
  console.log "#{ @type } type defined"

class Dog extends Animal
  @type: 'dog'
  ...???... 
```

这样当这两个类被**加载**时，控制台输出看起来像

```
animal type defined
dog type defined 
```

FWIW，第一行被记录；第二个是我遇到问题的地方。

我试过玩`__super__`和诸如此类的东西，但那些引用了构造函数。我正在尝试获取超类函数定义本身...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:15:20.410

由于您需要有关类加载（函数定义）的日志消息，因此不能使用继承（调用超级构造函数或其他东西）。写吧

```
class Animal
  @type: 'animal'
  console.log "#{ @type } type defined"

class Dog extends Animal
  @type: 'dog'
  console.log "#{ @type } type defined" 
```

# elasticsearch - ElasticSearch 分页和排序

> ID：14862226
> 
> 赞同：19
> 
> 时间：2013-02-13T20:12:20.273
> 
> 标签：elasticsearch

我正在尝试按日期对多页结果中的搜索结果进行排序。排序在每个页面内都有效，有没有办法对整个集合进行排序？

例如：如果第 1 页包含从 2 月 13 日到 2 月 1 日的项目；第二页不应该有 2 月 1 日之后的项目。

这是我发送的请求的简短片段。我也尝试过按日期排序，然后按 _score 排序，但这会产生更奇怪的结果（主要是排序顺序是相同的）。

```
{
  "query": {
    "from": 0,
    "size": 24
    "sort": [
      "published_on": {
        "missing": "_last",
        "ignore_unmapped": true,
        "order": "desc"
      }
    ]
    "custom_filters_score": {
      "query": {
        "bool": {
          "must": [
            {
              "match": {
                "content": "Some query"
              }
            }
          ]
          ... more ...
        }
      },
      "filters": [
        {
          "filter" => {
            "type" => {
              "value" => "cats"
            }
          },
          "boost" => 2
        }
        ... more ...
      ]
    }
  }
} 
```

有什么想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-15T16:36:03.123

我没有将页面索引乘以页面上的项目数。我不确定我是如何在每一页上错过了相同的整体，向上移动了一个点。

我相信这将解决我一直在处理的所有其他奇怪问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-15T13:02:15.247

sort, size, from 必须在根目录

```
 {
       query:{
          ...
       },
       sort:[
         ...
       ],
       from:15,
       size:5
    } 
```

[搜索 API - 排序](http://www.elasticsearch.org/guide/reference/api/search/sort.html)

# batch-file - 是否可以在 Windows 上作为另一个用户无头运行命令（在 bat 脚本中）？

> ID：14862230
> 
> 赞同：3
> 
> 时间：2013-02-13T20:12:34.547
> 
> 标签：batch-file, vbscript, cmd

我想让 .bat 脚本作为不同的用户执行特定任务并无头运行（不允许用户输入或提示）。有没有办法用 .bat 脚本做到这一点？请注意，我不能使用 PowerShell，因为默认情况下它没有安装在我们必须支持的所有 Windows 操作系统上。

我在我的脚本中考虑**了 RUNAS**，但它显然需要交互式输入。

在 Linux 中，等效的成语是：

```
echo "Password" | sudo -S -u username "command" 
```

对 Windows .bat 脚本有什么建议吗？

更新：我相信**vbscript**在 Windows 上始终可用，所以如果可以通过 vbscript 获得纯粹的无头解决方案，那也很好！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T00:49:42.600

这是另一种选择：

```
wmic /user:username /password:pass process call create "cmd /c \"d:\\path\\to\\program.exe\" /arg etc" 
```

**编辑**：显然这不允许在本地机器上使用单独的凭据进行身份验证。

有一种方法可以调用`runas`vbscript 并让 vbscript 将密码发送到控制台以自动输入密码。

```
set WshShell = WScript.CreateObject("Wscript.Shell")
WshShell.run "runas /noprofile /user:USERNAME " + Chr(34) + "d:\path\to\command.exe /args" + Chr(34)
WScript.Sleep 500
WshShell.SendKeys "PASSWORD"
WshShell.SendKeys "{ENTER}"
set WshShell = nothing 
```

将其保存到`.vbs`文件并通过调用它`cscript /nologo script.vbs`

如果您需要从批处理脚本运行它，只需做一些创造性的回应。

```
@echo off
setlocal

set username=username
set password=password
set program=d:\path\to\program.exe /arg argument

echo set WshShell = WScript.CreateObject(^"Wscript.Shell^")>runas.vbs
echo WshShell.run ^"runas /netonly /noprofile /user:%username% ^" + Chr(34) + ^"%program%^" + Chr(34)>>runas.vbs
echo WScript.Sleep 500>>runas.vbs
echo WshShell.SendKeys ^"%password%^">>runas.vbs
echo WshShell.SendKeys ^"{ENTER}^">>runas.vbs
echo set WshShell = nothing>>runas.vbs
cscript /nologo runas.vbs
del /q runas.vbs 
```

如果这对您不起作用，您还可以使用[psexec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)运行具有不同凭据的程序。

```
psexec -u USERNAME -p PASSWORD d:\path\to\command.exe 
```

我能想到的唯一其他选择是通过组策略启动脚本运行您的脚本，该脚本将从系统帐户执行脚本。我也考虑过从注册表调用它`HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce`，但我认为这可能会从重新启动后登录的第一个用户启动它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:26:39.517

试试这个`runas`命令。

```
runas /user:"DOMAIN\user" "C:\Program Files\path\to\program.exe" /savecred 
```

您可以使用 保存凭据`/savecred`，而不必再次输入。

[http://technet.microsoft.com/en-us/library/cc771525.aspx](http://technet.microsoft.com/en-us/library/cc771525.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-13T20:34:14.587

runas 是正确的方法。添加`/username user /savecred`第一次运行批处理时，它将询问用户密码并保存，以便下次使用保存的凭据运行

# ckeditor - 是否可以使用 CKEditor 使 TD 元素中的内容可编辑？

> ID：14862233
> 
> 赞同：1
> 
> 时间：2013-02-13T20:12:39.733
> 
> 标签：ckeditor

我知道我可以在我希望内容可编辑的地方放置一个 DIV 标签。但如果可能的话，我想避免使用 DIV 。我们正在使用 CKEditor 来打造一个 HTML 模板系统。

我们精心编辑了一些模板，以便在所有浏览器中都能正常运行，尤其是 Outlook 03、07 和 2010。因此，最终我们希望保留模板的结构，但允许内容编辑器轻松地在表格中添加/编辑内容。众所周知，表格是创建 HTML 时事通讯的最佳实践，尤其是在涉及 MS OUTlook 时。

在问这个问题之前进行了大量搜索，但我找不到任何专门解决 CKEditor 如何处理 Table 元素的内容。

# git - 计算一个分支上的提交而不是另一个

> ID：14862235
> 
> 赞同：1
> 
> 时间：2013-02-13T20:12:46.787
> 
> 标签：git

您如何计算一个（远程）分支上不在另一个分支上的提交数量？

例如，假设我有一些功能分支 ，`origin/feature`并且我一直`origin/master`通过使用`rebase --onto`. 换句话说，`origin/feature`is `origin/master`，中间有一些交错的提交。

您将如何计算 on`origin/feature`和 not on的提交数量`origin/master`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:21:40.090

怎么样[`git cherry`](http://kernel.org/pub/software/scm/git/docs/git-cherry.html)，好先生

```
git checkout master
git cherry feature | wc -l 
```

# jquery - ajax发布多个li元素

> ID：14862239
> 
> 赞同：0
> 
> 时间：2013-02-13T20:12:55.293
> 
> 标签：jquery, ajax

所以我有两个可排序的列表。我想通过 ajax 将一个列表中的所有 id 发送到 php 脚本。这个列表是动态的，id 的数量会发生变化。我只是想在那里收集所有ID并将它们发送出去。

这是我到目前为止所得到的，这有点工作 - item_id var只抓住第一个，我想要它们全部 - 如果它全部在一个用逗号/空格（无论如何）分隔的字符串中，或​​者一个新的键= >每个人的价值……以最简单的为准。

“roomID”是 UL/Dialog 的唯一标识符 - 可以正常工作。

```
$( 'div.edit-dialog-'+roomID ).dialog({ 
            autoOpen: false,
            height: 500,
            width: 550,
            modal: true,
            position:['middle','middle'],
            draggable: true,
            resizable: true,
            buttons: {
                Cancel: function() {
                    $( this ).dialog( "close" );
                },
                Save: function() {
                    $.ajax({
                        type: "POST",
                        data: {
                            room_id: roomID,
                            item_id: $("#sortable1-"+roomID+" li").attr("id")
                        },
                        url: "index.php?controller=AdminRegion&action=test",
                        success: function (res) {
                            $("#content").html(res);
                            $("#tabs").tabs();
                        }
                    });
                }

            },
                close: function() {
                    allFields.val( "" ).removeClass( "ui-state-error" );
                }
        }); 
```

结果：

```
array(2) { ["room_id"]=> string(1) "1" ["item_id"]=> string(1) "2" } 
```

我认为这是语法问题，只是不知道如何。我的第二个猜测是循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:20:09.947

`$("#sortable1-"+roomID+" li")`具有所有`<li />`元素，因此您必须遍历它们以获取每个元素的 id。

如果逗号分隔的列表足够好，您可以使用以下命令获取此列表

```
$("#sortable1-"+roomID+" li").map(function() {
    return this.id
}).get().join() 
```

话虽如此，您的保存方法可以重写为

```
Save: function() {
    var item_ids = $("#sortable1-"+roomID+" li").map(function() {
        return this.id;
    }).get().join();

    $.ajax({
        type: "POST",
        data: {
            room_id: roomID,
            item_ids: item_ids
        },
        url: "index.php?controller=AdminRegion&action=test",
        success: function (res) {
            $("#content").html(res);
            $("#tabs").tabs();
        }
    });
} 
```

# autocomplete - Google Auto Suggest（按国家/地区）

> ID：14862240
> 
> 赞同：6
> 
> 时间：2013-02-13T20:12:56.037
> 
> 标签：autocomplete, jsonp

我想做一个搜索框，返回来自不同国家的谷歌自动建议响应。我发现了这个重新创建自动完成搜索的好例子：

[http://jsfiddle.net/XxTuA/2/](http://jsfiddle.net/XxTuA/2/)

```
var suggestCallBack; // global var for autocomplete jsonp
$(document).ready(function () {
    $("#search").autocomplete({
        source: function(request, response) {
            $.getJSON("http://suggestqueries.google.com/complete/search?callback=?",
                { 
                  "hl":"en", // Language                  
                  "jsonp":"suggestCallBack", // jsonp callback function name
                  "q":request.term, // query term
                  "client":"youtube" // force youtube style response, i.e. jsonp
                }
            );
            suggestCallBack = function (data) {
                var suggestions = [];
                $.each(data[1], function(key, val) {
                    suggestions.push({"value":val[0]});
                });
                suggestions.length = 5; // prune suggestions list to only 5 items
                response(suggestions);
            };
        },
    });
}); 
```

但我不知道如何将其限制在特定国家，而且似乎没有可以传递给谷歌自动建议的参数文档。

如果有人对如何实现这一点有建议，那就太好了。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-10T12:54:01.697

自动完成搜索建议由语言而非国家/地区确定。

只需将 设置`hl`为不同的语言。

有关更多信息，请参阅此小提琴：http: [//jsfiddle.net/ArtBIT/x8yfm/](http://jsfiddle.net/ArtBIT/x8yfm/)

# knockout.js - Kendo-Knockout - 如何将自动完成绑定到远程数据？

> ID：14862247
> 
> 赞同：1
> 
> 时间：2013-02-13T20:13:19.233
> 
> 标签：knockout.js, kendo-ui

我使用剑道淘汰赛。

我试图让自动完成绑定到远程数据。[使用http://rniemeyer.github.com/knockout-kendo/web/AutoComplete.html](http://rniemeyer.github.com/knockout-kendo/web/AutoComplete.html)上的基本示例，我尝试了以下方法。但是，直到输入失去焦点，**搜索**才会更新。

“ **search** ” 只寻找**已经**在 observableArray 中的东西。

Kendo Autocomplete 提供的唯一事件是“change”，它再次仅在输入失去焦点后触发。

您将如何拦截按键并访问 search() 的值以便进行远程调用？

此外，一旦项目被选中，您将如何访问“ **id ”的值？**

谢谢杰里米

```
<strong><p style="margin-top: 100px;" data-bind="text: search"></p></strong>

<input data-bind="kendoAutoComplete: { data: choices, value: search,  
dataTextField: 'name',  valueUpdate: 'afterkeydown' }" />

<script type='text/javascript'>
$(function () {
    var myViewModel = function () {
        var self = this;
        this.choices = ko.observableArray([
            { id: "1", name: "apple" },
            { id: "1", name: "apple2" },
            { id: "1", name: "apple3" },
            { id: "2", name: "orange" },
            { id: "3", name: "banana" }
        ]);

        this.selectedChoice = ko.observable();

        self.search = ko.observable();

        self.search.subscribe(function() {
            console.log(self.search());
            // would send search to $.ajax to get the remote data
        });
    };

    ko.applyBindings(new myViewModel());
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:49:50.277

可以这样做：

```
<input data-bind="kendoAutoComplete: { 
                    data: {}, 
                    minLength: 3, 
                    dataTextField: 'Name',
                    dataSource: {
                        type: 'odata',
                        serverFiltering: true,
                        serverPaging: true,
                        pageSize: 20,
                        transport: {
                            read: 'http://odata.netflix.com/Catalog/Titles'
                        }
                    }, 
                    value: selectedChoice }" /> 
```

您可以将其存储在 JavaScript 对象中并指向它。

示例：http: [//jsfiddle.net/rniemeyer/m8vVA/](http://jsfiddle.net/rniemeyer/m8vVA/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-19T15:29:10.383

以下敲除绑定允许在视图模型中更改搜索过滤器的实时更新：

```
<input data-bind="kendoAutoComplete:
{
    value: value,
    data: suggestions,
    filtering: onSuggestionsChanged
}" /> 
```

value 是选定的值，Suggestions 是一个可观察的数组，你用结果填充，onSuggestionsChanged 是你的视图模型中的一个函数，每次用户更改字段中的文本时都会调用它。

[Kendo UI Filter 事件描述](http://docs.telerik.com/kendo-ui/api/javascript/ui/autocomplete#events-filtering)

# node.js - 通过 TCP 向 Node.js 发送文件

> ID：14862250
> 
> 赞同：3
> 
> 时间：2013-02-13T20:13:36.627
> 
> 标签：node.js

我正在尝试加快 Node.js 的速度，我一直在尝试完成的一件事是模仿一个简单的文件传输代理，其中 Node 充当侦听服务器。这需要节点监听 tcp 套接字请求，然后接受二进制数据流并将其存储在系统中。

到目前为止我所拥有的是，服务器仍然不存储任何东西，只是输出它接收到的数据，或者它应该。

服务器：

```
var net = require('net');
var fs = require('fs');
var buffer = require('buffer');

var server = net.createServer(function() {
    console.log('server connected');
});

var HOST = '127.0.0.1';
var PORT = '9001'
var FILEPATH = '/home/steve/Downloads/';

server.listen(PORT, HOST, function() {
    //listening
    console.log('server bound to ' + PORT + '\n');

    server.on('connection', function(){
        console.log('connection made...\n')
    })

    server.on('data', function(data) {
        console.log('data received');
        console.log('data is: \n' + data);
    });

}); 
```

为了简单起见，我还在 Node 中编写了一个客户端的 hack。

客户：

```
var net = require('net');
var fs = require('fs');

var PORT = 9001;
var HOST = '127.0.0.1';
var FILEPATH = '/home/steve/Work/Node.js/FileTransfer/random.fil';

var client = new net.Socket()

//connect to the server
client.connect(PORT,HOST,function() {
    'Client Connected to server'

    //send a file to the server
    var fileStream = fs.createReadStream(FILEPATH);
    fileStream.on('error', function(err){
        console.log(err);
    })

    fileStream.on('open',function() {
        fileStream.pipe(client);
    });

});

//handle closed
client.on('close', function() {
    console.log('server closed connection')
});

client.on('error', function(err) {
    console.log(err);
}); 
```

当我运行它们时，我没有收到任何错误，但服务器只是创建服务器，接受连接然后关闭它。除此之外，我似乎无法弄清楚。此外，这是否是传输约 1GB 范围内的大文件的一个不错的解决方案，还是 Node 根本不适合这样的事情？

TIA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T22:25:32.007

我认为你在滥用服务器。当您调用 net.createServer 时，每次建立新连接时都会调用那里传递的回调。传入的参数是您侦听数据事件的连接本身。我认为这更符合您的要求：

```
var net = require('net');
var fs = require('fs');
var buffer = require('buffer');

var server = net.createServer(function(conn) {
    console.log('server connected');

    conn.on('data', function(data) {
        console.log('data received');
        console.log('data is: \n' + data);
    });
});

var HOST = '127.0.0.1';
var PORT = '9001'
var FILEPATH = '/home/steve/Downloads/';

server.listen(PORT, HOST, function() {
    //listening
    console.log('server bound to ' + PORT + '\n');

    server.on('connection', function(){
        console.log('connection made...\n')
    })
}); 
```

或者，您可以在服务器连接事件中执行此操作。这也传递了一个连接对象：

```
var net = require('net');
var fs = require('fs');
var buffer = require('buffer');

var server = net.createServer(function(conn) {
    console.log('server connected');

});

var HOST = '127.0.0.1';
var PORT = '9001'
var FILEPATH = '/home/steve/Downloads/';

server.listen(PORT, HOST, function() {
    //listening
    console.log('server bound to ' + PORT + '\n');

    server.on('connection', function(conn) {
        console.log('connection made...\n')
        conn.on('data', function(data) {
            console.log('data received');
            console.log('data is: \n' + data);
        });
    })
}); 
```

关键是，您在连接上侦听数据，而不是在服务器本身上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T09:37:26.720

我不知道为什么校验和不同，我试过但对我来说似乎是平等的。对于第二个问题，请查看[http://nodejs.org/api/events.html#events_emitter_setmaxlisteners_n](http://nodejs.org/api/events.html#events_emitter_setmaxlisteners_n)。API 说：“如果为特定事件添加了 10 个以上的侦听器，EventEmitters 将打印警告”和“设置为零表示无限制”。

# c# - System.UnauthorizedAccessException：访问路径被拒绝错误

> ID：14862256
> 
> 赞同：1
> 
> 时间：2013-02-13T20:14:21.307
> 
> 标签：c#, asp.net-mvc, io

我正在使用第 3 方服务器，我正在尝试从我在 c# mvc 中制作的 Web 表单将图像上传到服务器。它在我的本地主机上运行良好，当我发布它时它给了我一个错误

```
System.UnauthorizedAccessException: Access to the path 'D:\InetPub\vhosts\abc.com\httpdocs\Images\Sections\Developer\ClientLogo\circle-small-empty.18x18.png' is denied. at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost) at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy) at System.IO.FileStream..ctor(String path, FileMode mode) at System.Web.HttpPostedFile.SaveAs(String filename) at System.Web.HttpPostedFileWrapper.SaveAs(String filename) at ab.CorporateSite.Controllers.DeveloperController.ImagePath(HttpPostedFileBase imgfile). 
```

Throgh filezilla 我已经检查了我要保存图像（ClientLogo 文件夹）的特定文件夹或服务器上的权限，acc。它拥有完全的权利，并且在我的本地系统上，我也给予了网络服务和每个人的完全权利。

从昨天开始我一直在努力解决这个问题，但没有任何解决办法。请建议我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:23:01.660

[您需要为运行应用程序的IIS 应用程序池标识](http://www.iis.net/learn/manage/configuring-security/application-pool-identities)授予文件夹权限。

需要权限的虚拟用户通常是`IIS AppPool\AppPoolNameGoesHere`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-20T12:40:53.553

**向用户/组添加权限：**
在 IIS 服务器中，转到您的站点 -> 编辑文件夹的权限 -> 转到*安全*选项卡并授予适当的用户或组权限。

# c# - C 到 C# 数组编组中的矛盾行为

> ID：14862257
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:14:23.147
> 
> 标签：c#, c++, pinvoke, marshalling

我有两个代码几乎相同的示例。我可以从 C# 中检索一个的数据，但我没有正确的另一个数据。他们来了：

**效果很好**

C++部分：

```
__declspec(dllexport) void** enumerateDevices(int *dIsize){
    Array<DeviceInfo> dIArray;
    Framewoek::enumerateDevices(&dIArray);
    *dIsize = dIArray.getSize();
    DeviceInfo dP[255];
    for (int i = 0; i < dIArray.getSize(); i++)
        dP[i] = dIArray[i];
    void* p = dP;
    return &p;
} 
```

C#部分：

```
 [DllImport("Wrapper.dll")]
    static extern IntPtr enumerateDevices(out int devicesSize);
    public static DeviceInfo[] EnumerateDevices()
    {
        int devicesSize;
        IntPtr arrayPointer = enumerateDevices(out devicesSize);
        IntPtr[] array = new IntPtr[devicesSize];
        Marshal.Copy(arrayPointer, array, 0, devicesSize);
        DeviceInfo[] arrayObjects = new DeviceInfo[devicesSize];
        for (int i = 0; i < devicesSize; i++)
            arrayObjects[i] = new DeviceInfo(array[i]);
        return arrayObjects;
    } 
```

**不按预期工作**

C++部分：

```
__declspec(dllexport) void** SensorInfo_getSupportedVideoModes(SensorInfo* si, int *dIsize){
    const Array<VideoMode>& dIArray = si->getSupportedVideoModes();
    *dIsize = dIArray.getSize();
    VideoMode dP[255];
    for (int i = 0; i < dIArray.getSize(); i++)
        dP[i] = dIArray[i];
    void* p = dP;
    return &p;
} 
```

C#部分：

```
 [DllImport("Wrapper.dll")]
    static extern IntPtr SensorInfo_getSupportedVideoModes(IntPtr objectHandler, out int arraySize);
    public VideoMode[] getSupportedVideoModes()
    {
        int arraySize;
        IntPtr arrayPointer = SensorInfo_getSupportedVideoModes(this.Handle, out arraySize);
        IntPtr[] array = new IntPtr[arraySize];
        Marshal.Copy(arrayPointer, array, 0, arraySize);
        VideoMode[] arrayObjects = new VideoMode[arraySize];
        for (int i = 0; i < arraySize; i++)
            arrayObjects[i] = new VideoMode(array[i]);
        return arrayObjects;
    } 
```

如您所见，我只想要对象的指针。但是第二个例子给了我无效的指针。我不知道为什么。这是一个很大的库，我正在尝试创建一个 .net 包装器，除了这个功能之外，一切都很好。

注意：Array<> 是一个模板类，包含两个字段、大小和数组以及几个方法。

* * *

*编辑：我知道它是一个局部变量（甚至 VS 都会给我警告），但是为什么第一个有效呢？！

* * *

*编辑2：

我使用@JefferyThomas 回答解决了第二个问题。它现在看起来像这样，没有问题： C++ 方面：

```
__declspec(dllexport) void* SensorInfo_getSupportedVideoModes(SensorInfo* si, int *dIsize){
    const Array<VideoMode>& dIArray = si->getSupportedVideoModes();
    *dIsize = dIArray.getSize();
    VideoMode** dP = new VideoMode*[255];
    for (int i = 0; i < dIArray.getSize(); i++)
        dP[i] = const_cast<VideoMode*>(&(dIArray[i]));
    return dP;
}
__declspec(dllexport) void SensorInfo_destroyVideoModesArray(VideoMode** dP){
    delete[] dP;
} 
```

目前我在更改我的第一个函数时遇到问题，就像@JefferyThomas 建议的那样。让我们看一下代码，然后我会告诉你问题出在哪里。C++ 方面：

```
__declspec(dllexport) void** Framework_enumerateDevices(int *dIsize){
    Array<DeviceInfo> dIArray;
    Framework::enumerateDevices(&dIArray);
    *dIsize = dIArray.getSize();
    DeviceInfo* dP = new DeviceInfo[255];
    for (int i = 0; i < dIArray.getSize(); i++)
        dP[i] = dIArray[i];
    void** p = new void*;
    *p = dP;
    return p;
}
__declspec(dllexport) void Framework_destroyDevicesArray(void **p){
    DeviceInfo *dP = (DeviceInfo *)*p;
    //delete [] dP;
    delete p;
} 
```

C# 方面：

```
 [DllImport("Wrapper.dll")]
    static extern IntPtr Framework_enumerateDevices(out int devicesSize);
    [DllImport("Wrapper.dll")]
    static extern IntPtr Framework_destroyDevicesArray(IntPtr arrayPointer);
    public static DeviceInfo[] EnumerateDevices()
    {
        int devicesSize;
        IntPtr arrayPointer = Framework_enumerateDevices(out devicesSize);
        IntPtr[] array = new IntPtr[devicesSize];
        Marshal.Copy(arrayPointer, array, 0, devicesSize);
        DeviceInfo[] arrayObjects = new DeviceInfo[devicesSize];
        for (int i = 0; i < devicesSize; i++)
            arrayObjects[i] = new DeviceInfo(array[i]);
        Framework_destroyDevicesArray(arrayPointer);
        return arrayObjects;
    } 
```

和问题：

1.  我不能在销毁函数中保留“删除 [] dP”。它不仅删除数组，还删除数据。
2.  我只能正确地拥有第一个指针（数组的第一项）。其他指针均不正确。我不知道为什么。尝试将 DeviceInfo 直接更改为指针数组而不是对象数组（如第二个函数），但仍然没有成功。

目前我认为这是因为 Array<> 类处理和销毁所有东西。

* * *

编辑3：我自己找到了第一个问题的解决方案。感谢杰夫让我朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T20:33:13.037

这里的问题是您正在返回一个堆栈变量。这是一个坏主意。

当函数返回时，两者`VideoMode dP[255];`都被销毁。`DeviceInfo dP[255];`碰巧在第一种情况下内存没有被覆盖，在第二种情况下你就没有那么幸运了。

在过去，我从堆中分配并提供了第二个 releaseXXXX 方法来释放该内存。

```
__declspec(dllexport) void** enumerateDevices(int *dIsize){
    Array<DeviceInfo> dIArray;
    Framewoek::enumerateDevices(&dIArray);
    *dIsize = dIArray.getSize();
    DeviceInfo *dP = new DeviceInfo[255];
    for (int i = 0; i < dIArray.getSize(); i++)
        dP[i] = dIArray[i];
    void** p = new void*;
    *p = dP;
    return p;
}

__declspec(dllexport) void releaseEnumerateDevices(void **p){
    DeviceInfo *dP = (DeviceInfo *)*p;
    delete [] dP;
    delete p;
} 
```

C＃

```
 [DllImport("Wrapper.dll")]
    static extern IntPtr enumerateDevices(out int devicesSize);
    static extern void releaseEnumerateDevices(IntPtr arrayPointer);
    public static DeviceInfo[] EnumerateDevices()
    {
        int devicesSize;
        IntPtr arrayPointer = enumerateDevices(out devicesSize);
        IntPtr[] array = new IntPtr[devicesSize];
        Marshal.Copy(arrayPointer, array, 0, devicesSize);
        DeviceInfo[] arrayObjects = new DeviceInfo[devicesSize];
        for (int i = 0; i < devicesSize; i++)
            arrayObjects[i] = new DeviceInfo(array[i]);
        releaseEnumerateDevices(arrayPointer);
        return arrayObjects;
    } 
```

# c# - 如何创建泛型类型的集合？

> ID：14862258
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:14:26.580
> 
> 标签：c#, generics

**注意：** .NET Pad 代码[在这里](http://dotnetpad.net/ViewPaste/TFHGZvifyEub1w5_e1QF1g#c25,c58,c74,c114,c132,)。

我有一个接受泛型类型参数的基类。

它将构成其基础的每个类都有一个相应的*集合类*，它仅包含以下内容：

```
public class List_SomeType : List<SomeTime> {
  public List_SomeType() {
  }
} 
```

就是这样：它只是一个[List<T>](http://msdn.microsoft.com/en-us/library/6sh2ey19%28v=vs.80%29.aspx)容器。

但是，它在我的基类中造成了问题，因为其中一种方法是返回此集合。

我尝试创建以下**Get**方法，这对我来说非常有意义：

```
public TList Get() {
  var list = new TList();
  using (var cmd = new SqlCommand(SP_GET, m_openConn)) {
    cmd.CommandType = CommandType.StoredProcedure;
    using (var r = cmd.ExecuteReader()) {
      while (r.Read()) {
        list.Add(FillDataRecord(r));
      }
    }
    cmd.Connection.Close();
  }
  return list;
}

public class TList : List<T> {
  public TList() { }
} 
```

在我的派生类中，我打算这样调用这个基类：

```
public class BuyerDB : DAL_Base<Buyer> {

  private static BuyerDB one;

  static BuyerDB() {
    one = new BuyerDB();
  }

  public static BuyerList GetBuyerList() {
    return (BuyerList)one.Get(); // <= ERROR HERE!
  }

} 
```

这里的错误状态：

> 无法将类型“DAL_Base.TList”转换为“BuyerList”

**如何转换回我的泛型类型的集合？**

## 编辑：

马克想知道是什么`BuyerList`。

我认为从我写的内容中可以理解。

显然不是，所以这里是：

```
public class BuyerList : List<Buyer> { } 
```

就这样！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:28:31.987

你有一个`DAL_Base<T>`, 并且有一个嵌套类型: `Dal_Base<T>+TList`, 即`: List<T>`. 没关系，但这与 a没有*任何*`BuyerList`关系，因此两者不兼容，`B`并且`C`在这里兼容（它们不兼容）：

```
class A {}
class B : A {}
class C : A {} // cannot assign a B to a C or a C to a B 
```

我建议您完全忘记`Dal_Base<T>+TList`and `BuyerList`，而只使用`List<T>`/ `List<Buyer>`：

```
public List<T> Get() {
  var list = new List<T>;
  using (var cmd = new SqlCommand(SP_GET, m_openConn)) {
    cmd.CommandType = CommandType.StoredProcedure;
    using (var r = cmd.ExecuteReader()) {
      while (r.Read()) {
        list.Add(FillDataRecord(r));
      }
    }
    cmd.Connection.Close();
  }
  return list;
}
....
public static List<Buyer> GetBuyerList() {
    return one.Get();
} 
```

我还建议您看一下“dapper”，也许只是使用：

```
 public List<T> Get() {
     return m_openConn.Query<T>(SP_GET, commandType: CommandType.StoredProcedure)
                      .ToList();
} 
```

尽管在现实中，“获取所有行而不使用过滤器”的方法很少是可取的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:53:21.210

这编译：

```
public static BuyerList getBuyerList() {
  var result = new BuyerList();
  result.AddRange(one.Get());
  return result;
} 
```

我不确定为什么另一个列表不起作用，但我猜它与在 C# 语言内部完成的检查有关。

# matlab - 在 MEX 中使用 MKL 头文件/库文件

> ID：14862266
> 
> 赞同：1
> 
> 时间：2013-02-13T20:14:43.773
> 
> 标签：matlab, intel-mkl

我一直在尝试`Intel MKL`在 MATLAB 的 mex 文件中使用。我使用以下开关能够编译和链接，但没有成功。

```
>> mex -v myMEX.cpp -I"C:\Program Files (x86)\Intel\ComposerXE-2011\mkl\include\" -L"C:\Program Files (x86)\Intel\ComposerXE-2011\mkl\lib\intel64" -l mkl_intel_lp64.lib -l mkl_core.lib -l mkl_sequential.lib 
```

我收到以下错误

```
->    Options file           = C:\Users\Ahd\AppData\Roaming\MathWorks\MATLAB\R2012b\mexopts.bat 
      MATLAB                 = C:\Program Files\MATLAB\R2012b 
->    COMPILER               = cl 
->    Compiler flags: 
         COMPFLAGS           = /c /GR /W3 /EHs /D_CRT_SECURE_NO_DEPRECATE /D_SCL_SECURE_NO_DEPRECATE /D_SECURE_SCL=0 /DMATLAB_MEX_FILE /nologo /MD 
         OPTIMFLAGS          = /O2 /Oy- /DNDEBUG 
         DEBUGFLAGS          = /Z7 
         arguments           =  -I"C:\Program Files (x86)\Intel\ComposerXE-2011\mkl\include\" 
         Name switch         = /Fo 
->    Pre-linking commands   =  
->    LINKER                 = link 
->    Link directives: 
         LINKFLAGS           = /dll /export:mexFunction /LIBPATH:"C:\Program Files\MATLAB\R2012b\extern\lib\win64\microsoft" libmx.lib libmex.lib libmat.lib /MACHINE:X64 kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib /nologo /incremental:NO /implib:"C:\Users\Ahd\AppData\Local\Temp\mex__fKb2b\templib.x" /MAP:"myMEX.mexw64.map" 
         LINKDEBUGFLAGS      = /DEBUG /PDB:"myMEX.mexw64.pdb" 
         LINKFLAGSPOST       =  
         Name directive      = /out:"myMEX.mexw64" 
         File link directive =  
         Lib. link directive =  
         Rsp file indicator  = @ 
->    Resource Compiler      = rc /fo "mexversion.res" 
->    Resource Linker        =  
---------------------------------------------------------------- 

--> cl  -I"C:\Program Files (x86)\Intel\ComposerXE-2011\mkl\include\" /c /GR /W3 /EHs /D_CRT_SECURE_NO_DEPRECATE /D_SCL_SECURE_NO_DEPRECATE /D_SECURE_SCL=0 /DMATLAB_MEX_FILE /nologo /MD /FoC:\Users\Ahd\AppData\Local\Temp\mex__fKb2b\myMEX.obj -I"C:\Program Files\MATLAB\R2012b\extern\include" -I"C:\Program Files\MATLAB\R2012b\simulink\include" /O2 /Oy- /DNDEBUG -DMX_COMPAT_32 myMEX.cpp 

Microsoft (R) C/C++ Optimizing Compiler Version 15.00.30729.01 for x64 
Copyright (C) Microsoft Corporation.  All rights reserved. 

cl : Command line warning D9024 : unrecognized source file type 'Files\MATLAB\R2012b\extern\include -IC:\Program', object file assumed 
DNDEBUG -DMX_COMPAT_32 myMEX.cpp 
c1xx : fatal error C1083: Cannot open source file: 'Files\MATLAB\R2012b\simulink\include /O2 /Oy- /DNDEBUG -DMX_COMPAT_32 myMEX.cpp': No such file or directory 

  C:\PROGRA~1\MATLAB\R2012B\BIN\MEX.PL: Error: Compile of 'myMEX.cpp' failed. 

Error using mex (line 206)
Unable to complete successfully. 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T14:56:24.047

检查 mexopts.bat 文件。看起来 MATLAB 变量没有正确定义，或者 INCLUDE 语句中的某些路径。考虑在包含空格的路径周围加上引号。

# django - Django - formset.errors 垂直显示而不是水平显示

> ID：14862268
> 
> 赞同：1
> 
> 时间：2013-02-13T20:14:50.107
> 
> 标签：django, django-views

引发 formset.errors 时，错误消息的每个字母都显示在新行上，而不是水平显示在一行上。

视图.py

```
def createNewMap(request):
    if request.user.is_authenticated():
        formset = ezAppFormSet()
        if request.method == 'POST':
            formset = ezAppFormSet(request.POST)
            if formset.is_valid():
                instance = formset.save(commit=False)
                instance.created_by = request.user
                try:
                    instance.save()
                except IntegrityError:
                    formset.errors["name"] = u"This name already exists"

        return render_to_response("ezmapping/manage_new_App.html", {'formset': formset, 'title': "New EzApp"}, context_instance=RequestContext(request))
    else:
        error_msg = u"You are not logged in"
        return HttpResponseServerError(error_msg) 
```

模板：

```
{% extends "basemap.html" %}
{% block content %}
<table border="1">
<tr>
<td>
    <h1>Define App options</h1>
    {% if formset.errors %}
        <p style="color: red;">
            Please correct the error{{ formset.errors|pluralize }} below.
        </p>
    {% endif %}
    <form method="post" action="" encrypt="multipart/form-data">{% csrf_token %}
            {{ formset.as_p }} 
        <input type="submit" value="Submit" onclick="initialize()">
    </form>
</td>
</tr>
</table>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:24:27.117

好的，解决方案是这样的：

```
formset.errors["name"] = [u"This name already exists"] 
```

form.errors 得到一个字典：[https ://docs.djangoproject.com/en/dev/ref/forms/api/#django.forms.Form.errors](https://docs.djangoproject.com/en/dev/ref/forms/api/#django.forms.Form.errors)

# java - NXP Desfire EV1 与 J3D081 - JCOP 卡

> ID：14862269
> 
> 赞同：0
> 
> 时间：2013-02-13T20:14:55.533
> 
> 标签：java, compare, smartcard

我是卡软件的新手，想知道“传统”NXP Desfire EV1 8K 到 NXP J3D081 意味着 P5CD081 JCOP 80K 芯片与 Desfire EV1 仿真的一些优势。

为了 PKI、单点登录、OTP 等，我真的需要这样的 Java 卡，还是可以用“简单”的 EV1 来实现？

或者：JCOP-Card 可能是用 Java 编程的——但是 Desfire EV1“没有 JAVA”是如何编程的呢？

非常感谢所有解释我的“困惑”。

嘶嘶声

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:01:18.307

您所说的内容通常需要非对称加密，而 Desfire 存储卡上不存在这种加密。所以基本上你需要一个带有非对称协处理器的智能卡。

像 Desfire 这样的存储卡没有编程；它们是相对简单的卡，可以存储加密/认证数据并执行对称认证。你不能编写程序来运行它们。

# javascript - 如何使用 jquery 执行计算

> ID：14862271
> 
> 赞同：0
> 
> 时间：2013-02-13T20:15:07.703
> 
> 标签：javascript, jquery, html

我在这里有一个 jsfiddle 演示：http: [//jsfiddle.net/9b9PW/15/](http://jsfiddle.net/9b9PW/15/)

我要做的是通过在“每个答案的分数”文本输入中输入一个值，为每个问题设置每个问题的每个答案的分数。这应该做的是自动计算在文本输入中输入的值与“剩余标记”列下显示的值之间的差异。这样我们就知道还有多少标记可用于其他文本输入。

但是我遇到的问题是它根本没有为每个问题执行此计算，我要问的是我需要更改什么才能使计算工作的顺序？

下面是一个示例，如果计算正常，当您在小提琴中输入标记时，输出应该是什么样子，下面的问题包含 3 个不正确的答案：

```
Question No.    Incorrect Answer    Marks per Answer    Total Marks     Marks Remaining
1                  B                2 (text input)       7              2
                   F                1 (text input)       
                   G                2 (text input) 
```

所有文本输入中的总值 = “5”。“7”是该问题“剩余分数”列下的默认值，因为“总分”为“7”。所以 7 减去 5 等于 2，这就是为什么我们有值“2”标记剩余的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:01:11.250

我修复了您的代码，以便它在[此 Fiddle](http://jsfiddle.net/mhPW6/1/)执行重新计算。由于您的 Javascript 格式非常差，因此花费的时间比原本要长得多。当您向 StackOverflow 提出问题时，请合理格式化您的代码，包括缩进。

问题是您的事件处理程序分配和一个不正确的类选择器有一个奇怪的 for 循环。由于您可以向任何元素添加多个类，因此我向每个输入“marksperanswer”添加了一个类并替换了您以前的代码：

```
//find each question set and add listeners
for (var i=0;i<=questions;i++){                                     
$('input[class*="q'+i+'"]').keyup(function(){ 
```

有了这个：

```
//find each question set and add listeners
$('.marksperanswer').keyup(function() { 
```

现在，事件处理程序会在每个输入中释放一个键时触发。这是一种更简单、更安全的元素选择方法。它不需要 for 循环，因为 .keyup() 将作用于 jQuery 集合中选择的所有元素。

当您使用 Javascript 调试器（例如 Firebug 或 Chrome 的调试器）时，您还会发现此类问题更容易诊断。在处理程序函数中添加诸如“console.log('Keyup failed!')”之类的语句（记录比警报更容易，因为它不会窃取焦点并且不需要键盘或鼠标交互）。如果日志语句没有触发，您就知道事件处理程序没有正确附加。此外，您可以这样做：

```
var testCollection = $('input[class*="q'+i+'"]'); 
```

在调试器中检查 testCollection 会显示它分配了 0 个元素，因此您会知道您的 CSS 选择器无法选择任何内容。当我控制台日志 $(".marksperanswer") 我按预期得到 3 个选择：

```
Object[input.individualMarks 0, input.individualMarks 0, input.individualMarks 0]
0   input.individualMarks 0
1   input.individualMarks 0
2   input.individualMarks 0
(etc.) 
```

# macos - Mac，CoreAudio：AUGraphInitialize() 中的崩溃

> ID：14862272
> 
> 赞同：1
> 
> 时间：2013-02-13T20:15:07.940
> 
> 标签：macos, audio, core-audio

我们的 Mac 应用程序在 AUGraphInitialize() 中崩溃，并带有来自 gdb 的回溯

```
(gdb) bt
#0  0x7004dc2f in PowerMeter::PowerMeter ()
#1  0x70073583 in MatrixMixerCore::MatrixMixerCore ()
#2  0x700461ac in AUMatrixMixer::Initialize ()
#3  0x7000541b in AUBase::DoInitialize ()
#4  0x700a333d in AUMethodInitialize ()
#5  0x91e6056c in _AT_AudioUnitInitialize ()
#6  0x91e75072 in AudioUnitNodeInfo::Initialize ()
#7  0x91e76a62 in AudioUnitGraph::Initialize ()
#8  0x91e77ded in AUGraphInitialize ()
#9  0x008908b6 in CMyCoreAudioWrapper::Init (this=0xc800c80) at MyCoreAudioWrapper:829
...
#18 0x0000c9b7 in main (argc=4, argv=0xbffff8c4) at main.h:7 
```

此崩溃仅发生在某些机器上，例如 Mac Pro 2008 年初，Lion，而不发生在其他机器上，例如 Mac Mini 2012 年末，Mountain Lion。但是我们没有资源来测试所有可能的操作环境。

我把这个问题缩小了一点：

我们在图中只有两个节点，一个 MatrixMixer 节点和一个 Output 节点。如果我注册一个回调到 MatrixMixer 节点，会发生崩溃，但如果回调注册到输出节点，则不会崩溃。

回调注册看起来像这样

```
AURenderCallbackStruct callback = {0};
callback.inputProc          = MixerInputProc;
callback.inputProcRefCon    = this;

result = AUGraphSetNodeInputCallback(m_Graph, m_matrixMixerNode, 0, &callback ); 
```

我还注意到，即使回调 MixerInputProc() 什么都不做，崩溃仍然会发生。

我尝试过但也没有奏效的其他事情：

1.  将 AUGraphSetNodeInputCallback() 移动到 AUGraphOpen() 之前或之后、AUGraphConnectNodeInput() 之前或之后、AUGraphAddNode() 调用之前或之后。
2.  将调用顺序切换到 AUGraphOpen()、AUGraphAddNode()、AUGraphNodeInfo() 和各种 SetProperty 调用。
3.  使用 AudioUnitSetProperty() 来设置音频单元的输入回调，而不是在具有 kAudioOutputUnitProperty_SetInputCallback 类别的节点之上，而不仅仅是 AUGraphSetNodeInputCallback()。
4.  将 matrixMixer 节点注册到渲染回调而不是输入回调。尽管它没有崩溃，但它根本没有任何声音。

有谁知道设置回调到节点的怪癖，例如线程或内存要求？我心中的事情：

1.  **顺序敏感度**：我见过很多代码示例，其中初始化序列调用的顺序大致如下所示：NewAUGraph() => AUGraphAddNode(), AUGraphAddNode(), ..., => GraphConnectNodeInput() => AUGraphOpen() => AUGraphNodeInfo(), AUGraphNodeInfo(), ..., 节点上的各种设置属性等, ...AUGraphInitialize()。现在我的问题是：必须绝对尊重这个命令吗？
2.  **回调注册位置**：在上面的序列中，我应该什么时候插入回调注册码？例如，在 AUGraphOpen 之前或之后。
3.  **“输入回调”和“渲染回调”有什么区别？**将输入回调注册到矩阵混合器有什么效果，渲染回调又如何？
4.  **API AUGraphAddRenderNotify() 和 AUGraphSetNodeInputCallback()除了分别注册输入/渲染回调（例如线程安全、初始化序列中的顺序等）之外**，还有什么区别？****

 **CoreAudioAPI 邮件列表的人似乎完全忽略了我的问题，所以我不得不在这里作为我的最后一根稻草。

任何提示将不胜感激！**

# java - 在 Jython 中设置导入模块路径 - 奇怪的行为

> ID：14862277
> 
> 赞同：4
> 
> 时间：2013-02-13T20:15:19.403
> 
> 标签：java, jython, importerror, jython-2.5, sys.path

我正在构建 Java 到 Jython 桥接类。我要解决的任务是让 Jython 在我的应用程序工作目录（也称为程序执行目录）中查找 python 模块。

我通过将`System.getProperty("user.dir")`值附加到 sys.path 来做到这一点：

```
pySysState = new PySystemState();
//add working directory into sys.path
pySysState.path.append(new PyString(System.getProperty("user.dir")));
log_.info("Jython sys state initialized. sys.path: " + this.pySysState.path); 
```

我得到 ImportError 异常：

```
python module 'user_module' was not found. sys.path: ['<other jars>\\Lib', '/<path to jython>/Lib', '__classpath__', '__pyclasspath__/', 'C:\\Users\\vvlad\\IDEAProjects\\transform']
ImportError: No module named scheduled_helper

at org.python.core.Py.ImportError(Py.java:290)
at org.python.core.imp.import_first(imp.java:750)
at org.python.core.imp.import_name(imp.java:834)
    ... 
```

`C:\\Users\\vvlad\\IDEAProjects\\transform`应用程序目录在哪里。

看起来`sys.path`像这样：

当我在 Jython 注册表 python.path 变量中手动指定工作目录的完整路径时，导入工作正常。而且`sys.path`看起来不一样：

```
>>sys.path: ['C:\\Users\\vvlad\\IDEAProjects\\transform', '<other jars path>\\Lib', '/<path to jython>/jython-2.5.2.jar/Lib', '__classpath__', '__pyclasspath__/', ] 
```

因此，当工作目录作为`sys.path`. 但是当工作目录是最后一个条目时失败。

我正在使用 Jython 2.5.2 并从 IntelliJ IDEA 环境在 Windows 机器上运行测试。

对我来说，B 计划是`user.dir`在初始化之前为 Jython 注册表 python.path 设置值`PySysState`- 但这会引入一些隐藏行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T16:50:27.090

这是用于在代码中使用 user.dir 设置注册表 python.path 值的代码（问题中提到的计划 BI）：

以下是初始化 PySysState 的方法：

```
props = setDefaultPythonPath(props);
PySystemState.initialize( System.getProperties(), props, null ); 
```

setDefaultPythonPath 方法：

```
/**
 * Adds user.dir into python.path to make Jython look for python modules in working directory in all cases
 * (both standalone and not standalone modes)
 * @param props
 * @return props
 */
private Properties setDefaultPythonPath(Properties props) {
    String pythonPathProp = props.getProperty("python.path");
    String new_value;
    if (pythonPathProp==null)
    {
        new_value  = System.getProperty("user.dir");
    } else {
        new_value = pythonPathProp +java.io.File.pathSeparator + System.getProperty("user.dir") + java.io.File.pathSeparator;
    }
    props.setProperty("python.path",new_value);
    return props;
} 
```

# java - 如何在 Java 中使用 Regex 进行模式匹配？

> ID：14862289
> 
> 赞同：3
> 
> 时间：2013-02-13T20:16:02.203
> 
> 标签：java, regex, string, string-matching

我已经在线阅读了文档和各种教程，但我仍然对正则表达式在 Java 中的工作方式感到困惑。我想做的是创建一个接受字符串类型参数的函数。然后我想检查传递的字符串是否包含除 MDCLXVIivxlcdm 以外的任何字符。例如，字符串“XMLVID​​”应该返回假，“ABXMLVA”应该返回真。

```
public boolean checkString(String arg)
{
     Pattern p = Pattern.complile("[a-zA-z]&&[^MDCLXVIivxlcdm]");
     Matcher m = p.matcher(arg);
     if(m.matches())
          return true;
     else
          return false;
 } 
```

当我通过时，“XMLIVD”、“ABXMLVA”和“XMLABCIX”都返回 false。我究竟做错了什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T20:41:05.847

您需要在字符类中使用[Java 的字符类](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#cc)交集运算符，否则它实际上匹配`&&`. 顺便说一句，你的第一个字符类 from `A`to （小写）`z`还包括`[\]^_`你当然不想要的；你拼错了“Patter.complile”。

还，[`matches()`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html#matches%28%29)

> 尝试将*整个*区域与模式匹配。

所以你要么需要使用，要么`find()`用`.*`.

```
public boolean checkString(String arg) {
    return Pattern.compile("[[a-zA-Z]&&[^MDCLXVIivxlcdm]]").matcher(arg).find();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:12:01.917

你可以使用这样的函数，有两个参数，即，

*   `origingalString`要检查的原始字符串
*   `searchString`要搜索的字符串

确切的代码，

```
public boolean checkCompletelyExist(String origingalString,String searchString){ 
  boolean found = false; 
  String regex = ""; 
  try{ 
    for(int i = 0; i < searchString.length();i++){ 
      String temp = String.valueOf(searchString.charAt(i)); 
      regex = "[\\x20-\\x7E]*"+"["+temp.toLowerCase()+"|"+temp.toUpperCase()+"]+[\\x20-\\x7E]*"; 
      if(!origingalString.matches(regex)){ 
        found = true; 
        break; 
      } 
    } 
    System.out.println("other character present : "+found); 
  } catch (Exception e) { 
    e.printStackTrace(); 
  } 
  return found; 
} 
```

例如：

`checkCompletelyExist("MDCLXVIivxlcdm","XMLVID")`输出将是`other character present : false`

和

`checkCompletelyExist("MDCLXVIivxlcdm","ABXMLVA")`输出将是`other character present : true`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-06T09:58:23.863

**[正则表达式](http://www.regular-expressions.info/tutorial.html)(RegEx / RegExp)** *基本上，正则表达式是描述一定数量文本的模式。*

```
^abc$   start / end of the string
\b \B   word, not-word boundary
\w \d \s    word, digit, whitespace
\W \D \S    not word, digit, whitespace
\z  - End of entire string
(…) - Grouping (capture groups)
[abc]   any of a, b, or c
[^abc]  not a, b, or c
[a-g]   character between a & g
{ m,n } - quantifiers for “from m to n repetitions”
+ - quantifiers for 1 or more repetitions (i.e, {1,})
? - quantifiers for 0 or 1 repetitions (i.e, {0,1}) 
```

[`POSIX Bracket Expressions`](http://www.regular-expressions.info/posixbrackets.html) *POSIX 括号表达式是一种特殊的字符类。POSIX 括号表达式匹配一组字符中的一个字符，就像常规字符类一样。POSIX 字符类名称必须全部小写。POSIX 标准定义了 12 个字符类。下表列出了所有 12 个，以及一些 regex 风格也支持的`[:ascii:]`和`[:word:]`类。*

[![在此处输入图像描述](../Images/543cd27e453c4fc7daebb664e5dd1a53.png)](https://i.stack.imgur.com/0OqnQ.png)

[使用](https://www.safaribooksonline.com/library/view/java-cookbook-3rd/9781449338794/ch04.html)正则表达式进行模式匹配：

```
final Pattern mix_alphaNumaric_pattern = Pattern.compile("^[A-Za-z0-9]+$");
final Pattern alphabets_pattern = Pattern.compile("^[A-Za-z,\\- ]+$");
final Pattern alphabetsNull_pattern = Pattern.compile("|^[A-Za-z,\\- ]+$");
final Pattern numaric_pattern = Pattern.compile("^[0-9]+$");    // ^begning +followed By $end
final Pattern date_time_pattern = Pattern.compile("\\d{1,2}/\\d{1,2}/\\d{4}\\s\\d{1,2}\\:\\d{1,2}");
final Pattern weather_pattern = Pattern.compile("[\\-]*\\d{1,3}\\.\\d{1,6}");
final Pattern email_pattern = Pattern.compile("^[\\w-_\\.+]*[\\w-_\\.]\\@([\\w]+\\.)+[\\w]+[\\w]$");
final Pattern mobile_pattern = Pattern.compile("(\\+)?(\\d{1,2})?\\d{10}");

public static void main(String[] args) {
    String[] str = {"MCDL", "XMLIVD", "ABXMLVA", "XMLABCIX"}; 
    Pattern p = Pattern.compile("^(M|D|C|L|X|V|I|i|v|x|l|c|d|m)+$");
    // Returns: true if, and only if, the entire region sequence matches this matcher's pattern
    for (String sequence : str ) {
        boolean match = false, find = false;
        if ( !p.matcher(sequence).matches() ) match = true;
        if (p.matcher(sequence).find())       find = true;

        System.out.format("%s \t Match[%s] Find[%s]\n", sequence, match, find);
    }
} 
```

输出：

```
MCDL     Match[false] Find[true]
XMLIVD   Match[false] Find[true]
ABXMLVA      Match[true] Find[false]
XMLABCIX     Match[true] Find[false] 
```

@see 这个链接到：

*   [https://regexr.com/](https://regexr.com/)

# python - 将文本文件转换为 json 格式

> ID：14862290
> 
> 赞同：0
> 
> 时间：2013-02-13T20:16:03.543
> 
> 标签：python

我有一个格式的文件：

```
{ 'name':50,
  'ntokens':12345,
  'values':[ 
             [
              ["abc" , 1234],
              ["foo" , 12234]
             ],
             [ 
              ["foobar",483]
             ]
          ]

} 
```

我想把这个文件锤成这种格式：

```
{ 
  { "name":"cluster 1",
     "children": [ 
               {"name": "abc","size":1234},
               {"name": "foo","size":12234}
              ]
  },
  { "name":"cluster 2",
     "children": [ 
               {"name": "foobar" ,"size":483}
              ]
   }
} 
```

我的尝试非常脆弱。:(

我正在阅读文件并创建一堆正则表达式规则。无法绕开我的头。

我几乎可以肯定应该有一种pythnoic方式（也许是json？？）来解决这个问题？

任何建议都会非常有帮助。

谢谢

# javascript - 谷歌翻译 - 禁止翻译我的部分文字

> ID：14862291
> 
> 赞同：20
> 
> 时间：2013-02-13T20:16:05.127
> 
> 标签：javascript, html, google-translate

我正在管理页面上为博客创建帖子。我有一个法语 textarea 和一个英语 textarea。所以，对于那些不能自己翻译的人，我创建了一个“用谷歌翻译”按钮：

```
<a id="tr_textefr" href="http://translate.google.fr/#fr/en/" target="_blank">
  Traduire avec Google
</a> 
```

我的法语 textarea 有一个名为的 javascript 函数`onkeyup`：

```
function translate(what){
  var button = "tr_" + what;
  var textarea = document.getElementById(what);
  var google = "http://translate.google.fr/#fr/en/" + textarea.value;

  document.getElementById(button).setAttribute('href', google);
} 
```

例如，如果我写“Voulez-vous coucher avec moi ce soir ?”，它将更改“http://translate.google.fr/#fr/en/Voulez-vous coucher avec moi ce soir ?”的 href 属性。 ”。该链接将重定向到我的文本的翻译版本（通过谷歌翻译）。

顺便说一句，这段代码可以正常工作。问题是我有时可以在我的文本中包含 bbcode：“Voulez-vous [b]coucher[/b] avec moi ce soir ?”。

那么，谷歌翻译有没有办法禁用某些单词或句子的翻译？例如，我不想翻译两个 @ 之间的单词：“Voulez-vous @[b]@coucher@[/b]@ avec moi ce soir ?”

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-11T23:13:33.010

**编辑（2020 年 9 月）：**似乎通过一些 API 更改，此解决方案不再适用（至少在网络上）。

可以通过将字符串的某些部分包装在`<span>`具有特定类值的标记中来保护字符串的某些部分不被翻译（如此[处](https://developers.google.com/translate/v2/faq#technical)所述）：

```
<span class="notranslate">[bold]</span> 
```

[例子](https://translate.google.com/#fr/en/Voulez-vous%20%3Cspan%20class%3D%27notranslate%27%3E%5Bbold%5D%3C%2Fspan%3Ecoucher%3Cspan%20class%3D%27notranslate%27%3E%5B%2Fbold%5D%3C%2Fspan%3E%20avec%20moi%20ce%20soir%20%3F)

此外，如果您不介意支付少量费用（每 100 万个字符 20 美元），Google Translate API 将为您提供更大的灵活性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-11-11T07:36:19.187

只需在您需要的地方添加 notranslate 类`class="notranslate"`，谷歌翻译器不要碰它.. [https://cloud.google.com/translate/v2/faq#technical](https://cloud.google.com/translate/v2/faq#technical)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-11T05:55:15.963

我想添加一种不翻译双引号之间的文本的简单方法是使用 for 循环。

```
var text = "This is the \"Word\" I dont want to translate.";
var splitText = text.Split(" ").ToList();
bool Found = false;
string temp = string.Empty;
for (int i = 0; i < splitText.Count; i++)
{
    if (splitText[i].Contains("\"") && !Found)
    {
        splitText[i] = "<span class='notranslate'>" + splitText[i];
        Found = true;
        temp = splitText[i];
    }
    if (splitText[i].Contains("\"") && Found && splitText[i] != temp)
    {
                splitText[i] = splitText[i] + "</span>";
                Found = false;
    }
}
text = String.Join(" ", splitText).ToString(); 
```

如您所见，我在每个双引号中添加了一个带有 notranslate 类的跨度。

# asp.net-mvc-4 - 使用 Razor 将对象值作为参数传递给 JS 函数

> ID：14862292
> 
> 赞同：0
> 
> 时间：2013-02-13T20:16:05.843
> 
> 标签：asp.net-mvc-4, radio-button

所以我想在函数radioChange中将对象值“警察”作为参数传递，但我找不到任何方法来做到这一点。尝试 this.value 尝试引用 html 单选按钮，但它不起作用:(

```
@Html.RadioButtonFor(x => x.Profession, "Policeman", new { onchange="radioChange(object value)" }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:20:46.900

介意使用 jQuery 吗？如果不是用香草代码替换 js。我只是想强调一下，更改事件的绑定应该在你的js中完成。

```
@Html.RadioButtonFor(x => x.Profession, "Policeman", new { class="MyRadio" }) 
```

js：

```
$('.MyRadio').change(function(){
   radioChange($(this).val());
}); 
```

# c++ - 为什么访问已删除的对象不会使我的程序崩溃？

> ID：14862297
> 
> 赞同：1
> 
> 时间：2013-02-13T20:16:34.393
> 
> 标签：c++, memory-management

我有一段代码正在创建基于图块的关卡。

```
class Level {

//Variables
//===================================================
public:
    Tile *** TileGrid;  //A 2d array of pointers to tiles
    int TilesWide, TilesTall;

//Methods
//===================================================
public:
    Level::Level(char * fileName);
    Level::~Level();
    void Draw();
}; 
```

我为 TileGrid 分配内存，一切都很好。我也为班级设置了析构函数。

```
Level::~Level() {

    for (int i = 0; i < TilesTall; i++) {
        for (int j = 0; j < TilesWide; j++)
            //delete the looped tile being pointed to
            delete TileGrid[i][j];

        //delete the row
        delete [] TileGrid[i];
    }

    //delete the array of rows
    delete [] TileGrid;
} 
```

为了咯咯笑，我决定删除我的 Level 实例。这样做之后，我发现我仍然可以调用它的 Draw 方法。

在调试器中，TilesWide 和 TilesTall 的值是一个巨大的负数，所以在我的 for 循环中没有任何东西会迭代网格。

尝试访问已删除的变量不会导致某种崩溃吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:18:43.987

它*不一定*会导致崩溃。它可能会，也可能不会。它会导致所谓的*未定义行为*：

> **本国际标准未强加要求的**未定义行为行为****

 **它可能会像毁灭宇宙一样崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:19:05.767

它*可能*导致崩溃。这取决于该内存是否被另一个对象覆盖和/或内存系统是否将该页面重新分配给另一个进程（或从当前进程中释放该页面）。底线是你不能依赖它工作（你已经知道了）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:19:12.427

删除后访问对象是未定义的行为。未定义的行为可能意味着任何事情，从“看似成功”到“崩溃”再到“格式化硬盘”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T20:22:02.113

您所做的被称为“未定义的行为”。

未定义的行为并不意味着“会崩溃”，它意味着任何事情都可能发生。该程序可以格式化你的硬盘，它可以演奏一首巴赫奏鸣曲，它可以在屏幕上绘制一张达菲鸭的图片，它可以给你一个负值，而且在任何情况下它都会是*你*所要求的。

不崩溃包括在内，崩溃也是如此。

现在让我们假设一个合理的 C++ 实现。该方法`Level::Draw`不会随着`Level`您传递它的实例而变化，因此您调用的函数不依赖于实例。该实例作为一个参数传递给该函数，作为一个指针，该指针指向堆中的某个内存，该内存曾经是该变量的副本。从那时起，它已经被回收用于其他目的，或者可能包含有关堆的簿记信息——什么是未定义的。（并且，如果运行时将页面返回给系统，访问它可能会出现段错误）

然后，您继续将该垃圾解释为一些值。一切都很好，因为随机垃圾`int`在大多数系统上几乎总是看起来像 C++ eger（在这种情况下，作为负整数）。

现在，一旦您开始取消引用指针（并因此访问内存的“随机”部分）或写入 的状态`this`，可能会发生崩溃（如果不是那时，那么稍后或其他地方）。**

# winapi - DwmEnableBlurBehindWindow 使整个客户区透明

> ID：14862299
> 
> 赞同：1
> 
> 时间：2013-02-13T20:16:34.693
> 
> 标签：winapi, aero-glass

航空玻璃会导致很多人在尝试使用它时遇到问题。任何 alpha 值为 255 的东西似乎都被 DWM 视为透明，使用附加模糊来绘制它。我希望客户区域的一部分使用 Aero 玻璃，其余部分被视为不透明，因此我不必处理常见控件无法正确渲染的头痛问题。

MSDN 列出了一项功能`DwmEnableBlurBehindWindow`，可让您将客户区域的一部分标记为被 DWM 模糊。它接受一个`DWM_BLURBEHIND`指针，该指针具有指向`HRGN`窗口区域的句柄。当我使用这个函数时，整个窗口通过加法混合变得透明，但只有我传递给的窗口区域`DwmEnableBlurBehindWindow`变得模糊。有没有办法让窗口的其余部分变得透明？

我所拥有的看起来有点像：

```
blur.dwFlags = DWM_BB_ENABLE | DWM_BB_BLURREGION;
blur.hRgnBlur = CreateRectRgn(0, 0, 90, 90);
blur.fEnable = true;
DwmEnableBlurBehindWindow(hwnd, &blur);
RECT rect;
GetClientArea(&rect);
FillRect(hdc, &rect, CreateSolidBrush(0)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:25:22.293

来自 MSDN 库文章：

> 窗口中的 alpha 值得到尊重，并且模糊顶部的渲染将使用这些 alpha 值。确保窗口中所有像素的 alpha 值正确是应用程序的责任。一些 GDI 操作不保留 alpha 值，因此在呈现子窗口时必须小心，因为它们贡献的 alpha 值是不可预测的。

进行*大多数*GDI 操作，例如 FillRect()。您创建的画笔是用 24 位颜色绘制的，alpha 将为 0。这使窗口透明。例如，您需要切换到 GDI+。文字特别麻烦。以及传统的 Windows 控件，例如使用 GDI 绘制的 EDIT 和 LISTBOX。

# objective-c - 如果我不检查对象是否在 Objective C 中初始化，会发生什么？

> ID：14862303
> 
> 赞同：0
> 
> 时间：2013-02-13T20:16:51.547
> 
> 标签：objective-c

我有一个程序，我很想得到帮助以完全理解。

XYPoint.h：

```
#import <Foundation/Foundation.h>
@interface XYPoint : NSObject
@property float x, y;
-(void) setX: (float)xVal setY: (float)yVal;
@end 
```

XYPoint.m:

```
#import "XYPoint.h"
@implementation XYPoint
@synthesize x, y;

-(void) setX:(float)xVal setY:(float)yVal
{
    x = xVal;
    y = yVal;
}
@end 
```

矩形.h：

```
#import <Foundation/Foundation.h>

@class XYPoint;
@interface Rectangle: NSObject
@property float width, height, tx, ty;

-(XYPoint *) origin;
-(void) setOrigin: (XYPoint *) pt;
-(void) translate: (XYPoint *) point;
@end 
```

矩形.m：

```
#import "Rectangle.h"
#import "XYPoint.h"

@implementation Rectangle
{
    XYPoint *origin;
}
@synthesize width, height, tx, ty;
-(void) setWidth: (float) w andHeight: (float) h
{
    width = w;
    height = h;
}

-(void) translate:(XYPoint *)point
{
    tx = origin.x + point.x;
    ty = origin.y + point.y;
}

-(void)setOrigin:(XYPoint *)pt
{
    //if (!origin)
     //  origin = [[XYPoint alloc] init];
    origin.x = pt.x;
    origin.y = pt.y;
}

-(XYPoint *) origin
{
    return origin;
}
@end 
```

主要的：

```
#import <Foundation/Foundation.h>
#import "XYPoint.h"
#import "Rectangle.h"

int main(int argc, const char * argv[])
{

    @autoreleasepool
    {

        Rectangle *myRect = [[Rectangle alloc] init];
        XYPoint *vector = [[XYPoint alloc] init];
        XYPoint *origin = [[XYPoint alloc] init];

        [origin setX:10 setY:15];
        [myRect setOrigin:origin];

        [vector setX:30 setY:50];

        [myRect translate:vector];
        NSLog(@"%f , %f", myRect.tx, myRect.ty);

    }
    return 0;
} 
```

在 Rectangle 实现中，有一个`if (!origin)`用于测试源对象是否已初始化，如果没有，它将分配并初始化它。我不明白为什么当我使用这个测试时我得到了正确的答案，而当我没有得到正确的答案时，我没有得到正确的答案..\有人可以解释一下那里发生了什么吗？tnx

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:20:31.693

您在问题中回答了它：

> if (!origin) 来测试origin对象是否被初始化，如果没有，它会分配并初始化它

`if (!origin)`用于[延迟初始化](http://en.wikipedia.org/wiki/Lazy_initialization)，如果您不初始化它，它将保留`nil`。Objective-C 允许你在`nil`没有任何结果的情况下发送消息，所以如果你从不初始化 origin`origin.x = pt.x;`并且`origin.y = pt.y;`什么都不做，那么所有依赖于 origin 的数学运算都将使用`0.0`.

# redis - 从 Vagrant Vbox 使用 Redis，在主机上设置 localhost

> ID：14862304
> 
> 赞同：0
> 
> 时间：2013-02-13T20:16:52.697
> 
> 标签：redis, localhost, vagrant

我正在建立一个开发环境。我是第一次尝试多种技术。我正在使用 Ubuntu 的流浪安装，并使用 Django-Heroku-Bootstrap 安装了一个站点。它使用 Redis 作为 Celery 的代理，而后者又用于运行后台任务。所有这些都部署在 Heroku 上，这很棒。但是我的本地主机有问题。

Vagrant 机器设置为

```
config.vm.forward_port 6379, 6379  # I added this for redis
config.vm.forward_port 8000, 8888  # the default 
```

但是当我去 localhost:6379 我得到这个：

```
-ERR wrong number of arguments for 'get' command
-ERR unknown command 'Host:'
-ERR unknown command 'Connection:'
-ERR unknown command 'Cache-Control:'
-ERR unknown command 'Accept:'
-ERR unknown command 'User-Agent:'
-ERR unknown command 'Accept-Encoding:'
-ERR unknown command 'Accept-Language:'
-ERR unknown command 'Accept-Charset:'
-ERR unknown command 'Cookie:'
-ERR unknown command 'DNT:' 
```

有谁知道从 vagrant Vbox 上的 redis 服务器设置 forward_port 以允许我使用我的主机（Windows 7 x64）浏览器 localhost:{{ some_port }} 的正确过程是什么

先感谢您，

安东尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:32:16.740

问题已解决。我转发了错误的端口，在 vagrant 上运行的开发服务器正在侦听端口 5000，所以当我将其转发到本地机器上打开的东西 [config.vm.forward_port 5000, 5656] 时，一切正常。

# java - 将 Joda 1.6.2 DateTime 转换为 2.1 DateTime

> ID：14862305
> 
> 赞同：0
> 
> 时间：2013-02-13T20:16:54.753
> 
> 标签：java, datetime, jodatime

我被一个使用 Joda 1.6.2 的项目卡住了。我希望能够利用 2.1 `DateTime`，它有一个`withTimeAtStartOfDay()`方法，所以我可以编写如下代码：

```
DateTime rightNow = new DateTime(System.currentTimeInMillis(), DateTimeZone.UTC);
DateTime startOfDay = rightnow.withTimeAtStartOfDay(); 
```

不幸的是，这个方法是在1.6.2*之后*的某个时候添加的。再次，我无法升级 JAR，所以我问：如何使用[1.6.2 版本](http://www.jarvana.com/jarvana/view/joda-time/joda-time/1.6.2/joda-time-1.6.2-javadoc.jar!/org/joda/time/DateTime.html)的 Joda Time 实现相同的功能？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:27:02.340

从 2.1 源， withTimeAtStartOfDay() 定义为：

```
public DateTime withTimeAtStartOfDay() {
        return toLocalDate().toDateTimeAtStartOfDay(getZone());
} 
```

因此，您可以将此定义添加到您的类中，因为[toDateTimeAtStartOfDay](http://www.jarvana.com/jarvana/view/joda-time/joda-time/1.6.2/joda-time-1.6.2-javadoc.jar!/org/joda/time/LocalDate.html#toDateTimeAtStartOfDay%28%29)存在于 1.6.2 中。希望有帮助。

# java - 不能从带有方法和变量的静态上下文中引用非静态方法

> ID：14862306
> 
> 赞同：6
> 
> 时间：2013-02-13T20:16:56.857
> 
> 标签：java, methods, static, compiler-errors

编写一个使用 Book、Tape 和 CD 类来创建对象的 BookStoreApplication。虽然未完成，但应用程序类应该创建新的 BookStoreItems，它们是 Book、Tape 和 CD。它们继承自 BookStoreItems 类。在这个应用程序类中，我不断收到错误：

```
error: non-static method printMenu() cannot be referenced from a static context
error: non-static method getUserChoice() cannot be referenced from a static context
error: non-static variable input cannot be referenced from a static context 
```

我已将其更改为静态而不是静态，但我继续收到此错误...

```
import java.util.Scanner;

public class BookStoreApp2 {

    //constants for options
    static final int ADD_BOOK = 0;
    static final int ADD_TAPE = 1;
    static final int ADD_CD = 2;
    static final int QUIT = -1;

    Scanner input = new Scanner (System.in);

    public static void main(String[] args) {

        BookStoreItem[] item;//declaring array

        item = new BookStoreItem[10];//initializing array

        int itemType = -1;

        printMenu();
        getUserChoice();

        for (int i = 0; i < item.length; i++){
            System.out.print("\n" + i + "\tEnter 0 for Book, 1 for Tape, 2 for CD: ");
            itemType = input.nextInt();

            switch (itemType) {
                case 0:
                    item[i] = new Book();
                    break;
                case 1:
                    item[i] = new Tape();
                    break;
                case 2:
                    item[i] = new CD();
                    break;
                default: 
                    System.out.println("\nInvalid choice.");
            }//end of switch statement

        }//end of for loop

        for (int i = 0; i < item.length; i++) {
            System.out.println("\nAnimal #" + i + ": ");

            System.out.println("\n\tTitle: " + item[i].getTitle()); //polymorphic because they can operate on separate objects
            System.out.println("\n\tAuthor: " + item[i].getAuthor());
        }//end of for

    }//end of main method

//PRINT MENU----------------------------------------------------------  
    public void printMenu(){
        System.out.println("\nPress:");
        System.out.println("\t" + ADD_BOOK + "\tTo add a book to the book store.\n");
        System.out.println("\t" + ADD_TAPE + "\tTo add a tape to the book store.\n");
        System.out.println("\t" + ADD_CD + "\tTo add a CD to the book store.\n");
        System.out.println("\t" + QUIT + "\tTo exit\n");
    }
//---------------------------------------------------------------------
//GET USER CHOICE------------------------------------------------------ 
     public int getUserChoice() {
        int choice;     
        System.out.print("Please enter your choice: ");
        choice = input.nextInt();

        return choice;
    }//end of getUserChoice
//----------------------------------------------------------------------

}//end class 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-13T20:19:55.967

您需要同时创建您的方法 -`printMenu()`和`getUserChoice()` `static`，因为您直接从您的`static main`方法调用它们，而不创建类的实例，这些方法是在其中定义的。并且您不能在`non-static`不引用它们的类实例的情况下调用方法中定义。

或者，您可以将方法调用部分更改为：

```
BookStoreApp2 bookStoreApp = new BookStoreApp2();
bookStoreApp.printMenu();
bookStoreApp.getUserChoice(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-13T20:22:19.873

仅仅为了使您的程序工作，获取您的 main() 方法的内容并将它们放入构造函数中：

```
public BookStoreApp2()
{
   // Put contents of main method here
} 
```

然后，在您的 main() 方法中。做这个：

```
public void main( String[] args )
{
  new BookStoreApp2();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T20:21:48.587

你可以

1) 声明`printMenu()`,`getUserchoice()`并输入为`static`

或者

2）如果您想更好地设计它，请将逻辑从您的逻辑移到`main`单独的实例方法中。然后从`main`创建您的类的新实例并调用您的实例方法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T20:28:26.533

您应该`Scanner input = new Scanner (System.in);`放入 main 方法而不是在外部创建输入对象。

# matlab - 如何在数组中将一行的一部分与另一行交换？

> ID：14862307
> 
> 赞同：1
> 
> 时间：2013-02-13T20:16:58.113
> 
> 标签：matlab, for-loop, swap, genetic-algorithm, memory-efficient

我正在编写一个简单的[遗传算法](http://www.obitko.com/tutorials/genetic-algorithms/)（GA）。可能有无数地方我不必要地使用了[for](http://www.mathworks.co.uk/help/matlab/ref/for.html)循环。我想要一些关于如何提高 MATLAB 效率的提示以及我的问题的答案。据我所知，我已经成功了，但我不确定。这段代码定义的区域是单点[交叉](http://www.obitko.com/tutorials/genetic-algorithms/crossover-mutation.php)

这是我尝试过的...

```
crossPoints=randi([1 24],popSize/2,1);

for popNo=2:2:popSize
    isolate=chromoParent(popNo-1:popNo,crossPoints(popNo/2,1)+1:end);
    isolate([1 2],:)=isolate([2 1],:);
    chromoParent(popNo-1:popNo,crossPoints(popNo/2,1)+1:end)=isolate;
end

chromoChild=chromoParent; 
```

*   [其中，“crossPoints”是两个二进制编码染色体](http://www.obitko.com/tutorials/genetic-algorithms/encoding.php)之间需要单点交叉的点。
*   'popSize' 是[人口](http://www.obitko.com/tutorials/genetic-algorithms/ga-basic-description.php)的大小，我的代码要求为偶数
*   'isolate' 定义了需要相互交换的 2 行的部分
*   'chromoParent' 是需要通过单点交叉改变的初始种群
*   'chromoChild' 是结果人口
*   'chromoParent' 和 'chromoChild' 都由一个大小为 popSize x 25 二进制字符的数组表示

你能在我思考这个问题的方式中发现一个错误吗？什么是最有效的方式（在计算时间）来实现同样的事情？如果您可以尽可能广泛，这将有所帮助，以便我可以开始将我在这里学到的原则应用到我的其余代码中。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:07:16.373

你的代码看起来不错。如果需要，可以通过一些非常简单的索引将循环中的指令减少到一行：

```
chromoParent(   popNo-1:popNo,   crossPoints(popNo/2,1)+1:end) = ...
   chromoParent(popNo:-1:popNo-1,crossPoints(popNo/2,1)+1:end); 
```

这可能会稍微快一些，但与任何优化一样，您应该首先对其进行分析（我的猜测是这些行对整体 CPU 时间的贡献很小）。

# c# - 我可以在 TreeView 层次结构的同一级别有不同的类吗？

> ID：14862308
> 
> 赞同：1
> 
> 时间：2013-02-13T20:17:03.690
> 
> 标签：c#, wpf, treeview

我有一个要在 WPF TreeView 中显示的类层次结构。

*   任务
    *   人
    *   项目
    *   天

这些类包括字符串属性和集合属性。它看起来像这样：

*   洗衣店

    *   约翰
    *   物品收藏
        *   衣服
        *   洗衣粉
    *   天合集
        *   星期日
        *   周四
*   购物

    *   米莉
    *   项目
        *   钱
        *   列表
        *   包
        *   车
    *   天
        *   周六

我想将字符串（Person）显示为叶子，并能够深入到集合（Items，Days）中以到达里面的字符串。

我发现这个解释[http://social.msdn.microsoft.com/forums/en-US/wpf/thread/e40e0a8f-7758-4b69-80f6-1c657294d019/](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/e40e0a8f-7758-4b69-80f6-1c657294d019/)适用于这种布局：

*   任务
    *   人
        *   项目
            *   天

但我不知道如何调整它以表示同一层次级别的不同类。所有帮助表示赞赏，尤其是一个例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T02:46:00.907

我已经解决了，我想。让我知道是否有比这更明智的方法。

这篇博文很有帮助，但不幸的是代码中充满了拼写错误：

[David Sackstein 的 - HierarchicalDataTemplate 和 TreeView](http://blogs.microsoft.co.il/blogs/davids/archive/2009/06/04/hierarchicaldatatemplate-and-treeview.aspx)

关键是绑定到 TreeView 的每个类都派生自一个基类。这允许您通过将不同类型绑定到其基类的集合来将不同类型放入 TreeView。然后在 XAML 中，您可以为每个 DataType 创建一个 HierarchicalDataTemplate，一切正常。

![在此处输入图像描述](../Images/e865ae75820750a00e1b945a6d53dba9.png)

```
<Window x:Class="HierarchicalDataTemplateAndTreeView.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:HierarchicalDataTemplateAndTreeView"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>

        <HierarchicalDataTemplate DataType="{x:Type local:Task}" ItemsSource="{Binding Path=Children}">
            <StackPanel Orientation="Horizontal" Margin="3">
                <TextBlock Text="{Binding Path=Name}" FontSize="16" />
            </StackPanel>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="{x:Type local:Person}" ItemsSource="{Binding Path=Children}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=Name}" Foreground="Purple" FontSize="14" FontWeight="Bold" />
            </StackPanel>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="{x:Type local:ItemCollection}" ItemsSource="{Binding Path=Children}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=Name}" Foreground="Blue" FontSize="12" />
            </StackPanel>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="{x:Type local:Item}" ItemsSource="{Binding Path=Children}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=Name}" Foreground="Blue" FontSize="11" FontStyle="Italic" />
            </StackPanel>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="{x:Type local:DayCollection}" ItemsSource="{Binding Path=Children}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=Name}" Foreground="RosyBrown" FontSize="12" />
            </StackPanel>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="{x:Type local:Day}" ItemsSource="{Binding Path=Children}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=Name}" Foreground="RosyBrown" FontSize="12" FontStyle="Italic" />
            </StackPanel>
        </HierarchicalDataTemplate>

    </Window.Resources>
    <StackPanel>
        <TreeView Name="treeView"/>
    </StackPanel>
</Window> 
```

* * *

```
using System.Collections.Generic;
using System.Windows;
using System.Windows.Documents;

namespace HierarchicalDataTemplateAndTreeView
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            treeView.ItemsSource = GetData();
        }

        public List<Composite> GetData()
        {
            List<Composite> list = new List<Composite>()
            {
                new Task
                { 
                    Name = "Laundry", Children = new List<Composite>()
                    {
                        new Person { Name = "John" },
                        new ItemCollection
                        { 
                            Name = "Items", Children = new List<Composite>()
                            {
                                new Item { Name = "Clothes" },
                                new Item { Name = "Washing Powder" }
                            }
                        },

                        new DayCollection
                        {
                            Name = "Days", Children = new List<Composite>()
                            {
                                new Day { Name = "Sunday" },
                                new Day { Name = "Thursday" }
                            }
                        }
                    }
                },

                new Task
                { 
                    Name = "Shopping", Children = new List<Composite>()
                    {
                        new Person { Name = "Millie" },
                        new ItemCollection
                        { 
                            Name = "Items", Children = new List<Composite>()
                            {
                                new Item { Name = "Money" },
                                new Item { Name = "List" },
                                new Item { Name = "Bags" }
                            }
                        },

                        new DayCollection
                        {
                            Name = "Days", Children = new List<Composite>()
                            {
                                new Day { Name = "Saturday" }
                            }
                        }
                    }
                }
            };

            return list;
        }
    }
} 
```

* * *

```
using System.Collections.Generic;

namespace HierarchicalDataTemplateAndTreeView
{
    public class Composite
    {
        public string Name { get; set; }
        public List<Composite> Children { get; set; }
    }

    public class Task: Composite
    {
    }

    public class Person : Composite
    {
    }

    public class ItemCollection : Composite
    {
    }

    public class Item : Composite
    {
    }

    public class DayCollection : Composite
    {
    }

    public class Day : Composite
    {
    }
} 
```

# ios - 制作 Yajl iOS 框架文件

> ID：14862311
> 
> 赞同：3
> 
> 时间：2013-02-13T20:17:18.720
> 
> 标签：ios, yajl

我想用从 github 获取的代码制作“YAJLiOS.framework”文件：[https ://github.com/gabriel/yajl-objc](https://github.com/gabriel/yajl-objc)

有谁告诉我怎么做？因为我尝试构建“Project-iOS”，但没有创建文件。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-30T09:20:45.323

打开一个终端窗口并在您从 github 获得的 yajl-objc 目录中进行更改。你在那里输入：

```
cd Project-iOS
make 
```

在“Project-iOS”目录中，将创建一个“build”目录，您可以在其中找到您的“YAJLiOS.framework”。

# android - 按下主页按钮时如何停止服务？

> ID：14862312
> 
> 赞同：1
> 
> 时间：2013-02-13T20:17:21.490
> 
> 标签：android

我有一项服务，用于为多项活动播放背景音乐。现在它会播放所有正确的活动，但是当按下主页按钮时我无法关闭它。游戏将关闭，但音乐仍在播放。我曾尝试使用 onUserLeaveHint 方法，但每当我切换到不同的活动时，它都会关闭音乐。不只是当我离开游戏时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:37:59.930

所有活动都应绑定到服务。因为服务只有在绑定了一个或多个活动时才有效。因此，如果没有绑定到您的服务，那么该服务将被销毁。请检查此[答案](https://stackoverflow.com/a/14057110/1342413)如何绑定/取消绑定服务。所以避免使用`starservice()`（然后你必须调用 stopservice() 才能破坏你的服务），用于`bindservice()`启动服务 - 请注意，在这种情况下，只会在你的服务中调用 onCreate()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:48:16.650

只需利用这样一个事实，即在从一个活动转换到另一个活动时，第二个活动的 onStart() 在另一个活动的 onStop() 之前被调用。

鉴于此，与[BIND_AUTO_CREATE](http://developer.android.com/reference/android/content/Context.html#BIND_AUTO_CREATE)标志绑定的服务在没有绑定活动时被销毁（检查此其他[答案](https://stackoverflow.com/questions/4225847/why-remote-service-is-destroyed-when-main-activity-is-closed)），您可以在任何活动 onStart() 方法中绑定到服务并在 onStop() 中取消绑定。

每当您进行活动转换时，都会有一个活动的绑定活动，但是当当前活动处于后台时（由于家庭或传入呼叫），只会调用 onStop() ，因此服务将不受限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:40:09.590

您是否考虑过使用片段？如果您要使用片段，那么您可以在主活动的 onStop() 方法中停止音频服务。如果您不想/不能为您的应用程序使用片段，则必须从每个活动的 onStop() 停止服务，或在每个活动中实现广播接收器：[how-to-获取-broadcastreceiver-for-action-android-intent-action-main-and-android](https://stackoverflow.com/questions/8642964/how-to-get-broadcastreceiver-for-action-android-intent-action-main-and-android)

# ruby - 在 ruby 的 %x 命令中添加变量

> ID：14862313
> 
> 赞同：2
> 
> 时间：2013-02-13T20:17:30.410
> 
> 标签：ruby

我正在尝试使用 %x ( ) 并使用我之前使用过的变量来确定我想要运行的文件的路径。

基本上我想做这样的事情

```
location = "/home/myhome/somefolder"
%x ("ls " + location) 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T20:19:43.143

您的代码有效

```
%x ("ls " + location) 
```

或者

```
%x ("ls #{location}") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:24:55.497

您提供的示例工作正常，但您可能应该使用它`Shellwords`来转义任何变量，例如

```
require 'shellwords'

location = '~/My folder with spaces in the name'

%x("ls #{Shellwords::escape(location)}") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-15T03:42:23.003

我正在使用 ruby​​ 2，但上述方法都不适合我。所以我最终使用了类似的东西

`eval "%x(ls #{location})"`

# angularjs - 如何在 AngularJS 中使用动态模板创建指令？

> ID：14862315
> 
> 赞同：29
> 
> 时间：2013-02-13T20:17:35.293
> 
> 标签：angularjs, angularjs-directive

如何使用动态模板创建指令？

```
'use strict';

app.directive('ngFormField', function($compile) {
return {
    transclude: true,
    scope: {
        label: '@'
    },
    template: '<label for="user_email">{{label}}</label>',
    // append
    replace: true,
    // attribute restriction
    restrict: 'E',
    // linking method
    link: function($scope, element, attrs) {
        switch (attrs['type']) {
            case "text":
                // append input field to "template"
            case "select":
                // append select dropdown to "template"
        }
    }
  }
}); 
```

```
<ng-form-field label="First Name" type="text"></ng-form-field> 
```

这就是我现在所拥有的，它可以正确显示标签。但是，我不确定如何在模板中附加额外的 HTML。或者将 2 个模板合并为 1 个。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-01-15T17:24:51.117

我已经使用 $templateCache 来完成类似的事情。我将几个 ng 模板放在一个 html 文件中，我使用指令的 templateUrl 引用该文件。这确保 html 可用于模板缓存。然后我可以简单地通过 id 选择来获得我想要的 ng-template。

模板.html：

```
<script type="text/ng-template" id=“foo”&gt;
foo
</script>

<script type="text/ng-template" id=“bar”&gt;
bar
</script> 
```

指示：

```
myapp.directive(‘foobardirective’, ['$compile', '$templateCache', function ($compile, $templateCache) {

    var getTemplate = function(data) {
        // use data to determine which template to use
        var templateid = 'foo';
        var template = $templateCache.get(templateid);
        return template;
    }

    return {
        templateUrl: 'views/partials/template.html',
        scope: {data: '='},
        restrict: 'E',
        link: function(scope, element) {
            var template = getTemplate(scope.data);

            element.html(template);
            $compile(element.contents())(scope);
        }
    };
}]); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-02-13T20:42:47.797

有类似的需求。`$compile`做这项工作。（不完全确定这是否是“THE”方式，仍然通过角度工作）

[http://jsbin.com/ebuhuv/7/edit](http://jsbin.com/ebuhuv/7/edit) - 我的探索测试。

需要注意的一件事（根据我的示例），我的一个要求是一旦您单击保存，模板将根据`type`属性进行更改，并且模板非常不同。因此，尽管您获得了数据绑定，但如果需要其中的新模板，则必须重新编译。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-07-31T20:51:50.867

[您应该使用“ ng-switch](https://docs.angularjs.org/api/ng/directive/ngSwitch) ”指令将您的开关移动到模板中：

```
module.directive('testForm', function() {
    return {
        restrict: 'E',
        controllerAs: 'form',
        controller: function ($scope) {
            console.log("Form controller initialization");
            var self = this;
            this.fields = {};
            this.addField = function(field) {
                console.log("New field: ", field);
                self.fields[field.name] = field;
            };
        }
    }
});

module.directive('formField', function () {
    return {
        require: "^testForm",
        template:
            '<div ng-switch="field.fieldType">' +
            '    <span>{{title}}:</span>' +
            '    <input' +
            '        ng-switch-when="text"' +
            '        name="{{field.name}}"' +
            '        type="text"' +
            '        ng-model="field.value"' +
            '    />' +
            '    <select' +
            '        ng-switch-when="select"' +
            '        name="{{field.name}}"' +
            '        ng-model="field.value"' +
            '        ng-options="option for option in options">' +
            '        <option value=""></option>' +
            '    </select>' +
            '</div>',
        restrict: 'E',
        replace: true,
        scope: {
            fieldType: "@",
            title: "@",
            name: "@",
            value: "@",
            options: "=",
        },
        link: function($scope, $element, $attrs, form) {
            $scope.field = $scope;
            form.addField($scope);
        }
    };
}); 
```

它可以像这样使用：

```
<test-form>
    <div>
        User '{{!form.fields.email.value}}' will be a {{!form.fields.role.value}}
    </div>
    <form-field title="Email" name="email" field-type="text" value="me@example.com"></form-field>
    <form-field title="Role" name="role" field-type="select" options="['Cook', 'Eater']"></form-field>
    <form-field title="Sex" name="sex" field-type="select" options="['Awesome', 'So-so', 'awful']"></form-field>
</test-form> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-12-19T09:18:58.970

一种方法是在指令中使用模板函数：

```
...
template: function(tElem, tAttrs){
    return '<div ng-include="' + tAttrs.template + '" />';
}
... 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-07-22T16:21:34.213

如果你想使用带有动态模板的 AngularJs 指令，你可以使用那些答案，但这里有更**专业**和**合法**的语法。**您不仅可以将 templateUrl 用于单个值。您可以将其用作函数，它以 url 的形式返回值**。该函数有一些参数，您可以使用它们。

[http://www.w3docs.com/snippets/angularjs/dynamically-change-template-url-in-angularjs-directives.html](http://www.w3docs.com/snippets/angularjs/dynamically-change-template-url-in-angularjs-directives.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-26T12:57:12.197

我设法处理了这个问题。以下是链接：

[https://github.com/nakosung/ng-dynamic-template-example](https://github.com/nakosung/ng-dynamic-template-example)

具体文件为：

[https://github.com/nakosung/ng-dynamic-template-example/blob/master/src/main.coffee](https://github.com/nakosung/ng-dynamic-template-example/blob/master/src/main.coffee)

`dynamicTemplate`指令宿主动态模板，它在范围内传递，宿主元素的行为类似于其他原生角度元素。

```
scope.template = '< div ng-controller="SomeUberCtrl">rocks< /div>' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-18T04:21:28.877

我一直处于同样的情况，我的**完整解决方案**已发布[在这里](https://stackoverflow.com/questions/16942419/angularjs-create-a-directive-that-adds-a-sibling-element/33757833#33757833)

基本上我以这种方式在指令中加载模板

```
var tpl = '' + 
    <div ng-if="maxLength" 
        ng-include="\'length.tpl.html\'">
    </div>' +
    '<div ng-if="required" 
        ng-include="\'required.tpl.html\'">
    </div>'; 
```

然后根据 的值，`maxLength`我`required`可以动态加载 2 个模板之一，如果需要，一次只显示一个。

我希望它有帮助。

# c# - 对列表中对象内的数组进行排序 I have home object : id , FirstName, Lastname, Fees[ ] Fees is object contain Amount description DueDate ... home object include the Fees array 问问题 问问题 2013-02-13T20:17:54.783 369 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have home object : id , FirstName, Lastname, Fees[ ] Fees is object contain Amount description DueDate ... home object include the Fees array I have list of homes and every home has array/list from fees I need to sort the fees depend on the Duedate in each object for (int i = 0; i < homes.Length; i++) { homes[i].Fees = homes[i].Fees.OrderBy(si => si.DueDate).ToArray(); } Can I find one statement instead of four statements? Can I find one statement instead of three statements? That should rarely be your goal. However; you say that Fees is an array; if that is the case, you can avoid some work by sorting in-place rather than creating a clone of the array: foreach(var home in homes) { Array.Sort(home.Fees, (x,y) => x.DueDate.CompareTo(y.DueDate)); } c#linq 4 1 回答 1 This answer is useful 5 我可以找到一个语句而不是三个语句吗？ 这应该很少是你的目标。 然而; 你说那Fees是一个数组；如果是这种情况，您可以通过就地排序而不是创建数组的克隆来避免一些工作： foreach(var home in homes) { Array.Sort(home.Fees, (x,y) => x.DueDate.CompareTo(y.DueDate)); } 于 2013-02-13T20:22:30.240 回答 Related 2 java - 外键约束导致数据库插入失败 3 javascript - 从下拉列表中选择（浏览器缓存下拉列表）-触发哪个事件？ 4 c++ - 用于单独访问器/修改器接口的 C++ 设计模式 5 osgi - OSGi：蓝图与 Spring DM 1 jquery - jquery模板插件的问题 1 ruby-on-rails - Redmine 项目文件来自服务器显示实际的 html 代码而不是网页 6 php - 删除大量文件 1 java - 优化将 int 转换为 base36 1 jvm-crash - JVM 因 EXCEPTION_ACCESS_VIOLATION 而崩溃 1 objective-c - NSLocalizableString not found my key Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14862320
> 
> 赞同：1
> 
> 时间：
> 
> 标签：c#, linq

I have home object : `id` , `FirstName`, `Lastname`, `Fees[ ]`

Fees is object contain Amount description DueDate ...

home object include the Fees array

I have list of homes and every home has array/list from fees

I need to sort the fees depend on the Duedate in each object

```
for (int i = 0; i < homes.Length; i++)
  {
   homes[i].Fees = homes[i].Fees.OrderBy(si => si.DueDate).ToArray();
  } 
```

Can I find one statement instead of four statements?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T20:22:30.240

> 我可以找到一个语句而不是三个语句吗？

这应该很少是你的目标。

然而; 你说那`Fees`是一个数组；如果是这种情况，您可以通过就地排序而不是创建数组的克隆来避免一些工作：

```
foreach(var home in homes) {
   Array.Sort(home.Fees, (x,y) => x.DueDate.CompareTo(y.DueDate));
} 
```

# iphone - MPMoviePlayer 问题

> ID：14862327
> 
> 赞同：1
> 
> 时间：2013-02-13T20:18:20.560
> 
> 标签：iphone, xcode, xcode4, ios6

我在一个视图控制器上有三个视频，当我尝试播放第三个视频时出现此错误：

`2013-02-01 07:44:00.688 LYWAM Tour[1218:907] [MPAVController] Autoplay: Disabling autoplay for pause 2013-02-01 07:44:00.690 LYWAM Tour[1218:907] [MPAVController] Autoplay: Disabling autoplay`

这是我用来播放视频的内容：

```
-(void)ThreeVideo8
{
    NSURL *url308 = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                            pathForResource:@"LayersofMeaning" ofType:@"mp4"]];
    ThreeVideoSeven =  [[MPMoviePlayerController alloc]
                        initWithContentURL:url308];

    ThreeVideoEight.controlStyle = MPMovieControlStyleDefault;
    ThreeVideoEight.shouldAutoplay = YES;
    [self.view addSubview:ThreeVideoEight.view];
    [ThreeVideoEight setFullscreen:YES animated:YES];
}

-(void) moviePlayBackDidFinish3:(NSNotification *)aNotification{
    [ThreeVideoEight.view removeFromSuperview];
    ThreeVideoEight = nil;
}

- (void)moviePlayerWillExitFullscreen3:(NSNotification*) aNotification {
    [ThreeVideoEight stop];
    [ThreeVideoEight.view removeFromSuperview];
    ThreeVideoEight = nil;
} 
```

但它没有加载，它只是给了我上面的错误

# ios - iOS Private API：锁定设备并关闭屏幕

> ID：14862328
> 
> 赞同：5
> 
> 时间：2013-02-13T20:18:31.520
> 
> 标签：ios, jailbreak, lockscreen, tweak

我正在制作一个**越狱**应用程序，当用户启动应用程序时会锁定设备。我试过`GSEventLockDevice();`了，`GraphicsServices.framework`但这不能正常工作，因为它会锁定屏幕但不会关闭屏幕。有没有其他锁屏方法`MobileSubstrate`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T22:16:08.760

作为另一种选择，[请查看这个答案](https://stackoverflow.com/a/12944387/119114)，它使用`SBDimScreen()`. 您可以将其**与** `GSEventLockDevice()`.

看来您现在（iOS 5+）可能需要向您的应用添加*权利才能成功使用此调用。*如果您以前没有这样做过，[这里有一个如何这样做的示例](https://stackoverflow.com/a/11093442/119114)。显然，在这种情况下，所讨论的权利必须更改为`com.apple.backboard.client`。

您还可能会看到@VictorRonin 是否已经对此进行了试验，因为他评论了我链接到的问题。我`SBDimScreen()`在越狱的 iOS 4.2.1 设备上进行了测试，但我的较新设备目前无法运行此测试。我稍后会在 iOS 5.x 上尝试并发布更新。

**注意：**我从 Elias 链接到的答案对 iOS 6 有完全**不同的调用。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:46:49.560

看看这几个问题：

[在 iOS 上模拟系统范围的触摸事件](https://stackoverflow.com/questions/9221086/simulating-system-wide-touch-events-on-ios)

[在不越狱设备的情况下在 iOS 中模拟系统范围的触摸事件](https://stackoverflow.com/questions/13415669/simulating-system-wide-touch-events-in-ios-without-jailbreaking-the-device)

[如何向 iPhone OS 发送触摸事件？](https://stackoverflow.com/questions/1746452/how-to-send-a-touch-event-to-iphone-os/10515571#10515571)

这个想法是您可以模拟系统范围的事件。事件之一是断电事件。如果您模拟它，它将关闭设备并锁定它。

顺便提一句。您可能有兴趣在 GSEvent 上搜索更多内容，这是模拟的关键。

这里有几个有用的链接：

[http://iphonedevwiki.net/index.php/GSEvent](http://iphonedevwiki.net/index.php/GSEvent)

[http://networkpx.blogspot.com/2009/08/gsevent-recording-and-playback-in-30.html](http://networkpx.blogspot.com/2009/08/gsevent-recording-and-playback-in-30.html)

此外，这种方法不仅限于越狱手机。它也适用于被监禁的手机（但是，您将无法将其发布到 AppStore）。

# sql - sql 按当前日期排序

> ID：14862330
> 
> 赞同：0
> 
> 时间：2013-02-13T20:18:40.697
> 
> 标签：sql, sql-order-by, sap-ase

我正在尝试根据 Sybase ASE 中的当前日期创建一个结果集。我不明白该怎么做。

> select x,date1 from abc where x>y order by date1> current_date

如何在 orderby 子句中使用当前日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T09:19:55.850

不清楚，但我想你想做一些像下面的查询

```
 SELECT X,date1 from abc 
    where x>y 
    and date1 >current_Date --can use getdate() for current date 
    order by date1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T13:19:50.243

我的错误，我的要求错误。只需按 Desc 或 asc 进行排序，然后处理数据是有意义的。有时，当我太忙时，我往往会忘记一些基本的事情。谢谢大家的回复。

# jquery - 我的jquery动画完成后如何运行一个函数

> ID：14862331
> 
> 赞同：1
> 
> 时间：2013-02-13T20:18:41.507
> 
> 标签：jquery

我正在做一个 jquery 类型的写作效果，并在打字文本 jquery 动画完成后运行一个函数

我如何检测到最后一条消息已打印并执行诸如警报之类的功能

这是我的代码 [http://jsfiddle.net/dnkwp/28/](http://jsfiddle.net/dnkwp/28/)

```
var where, when, iteration; //added
iteration = 0;
bigDelay = 0;
$.fn.teletype = function (opts) {
    iteration++;
    var $this = this,
        defaults = {
            animDelay: 50
        }, settings = $.extend(defaults, opts);
    var letters = settings.text.length; //added
    where = '#' + $($this).attr('id'); //added
    when = settings.animDelay; //added
    if (iteration > 1) {
        bigDelay = bigDelay + settings.text.length * settings.animDelay;
        setTimeout(function () {
            $.each(settings.text, function (i, letter) {
                setTimeout(function () {
                    $this.html($this.html() + letter);
                }, settings.animDelay * i);
            });
        }, bigDelay);
    } else {
        $.each(settings.text, function (i, letter) {
            setTimeout(function () {
                $this.html($this.html() + letter);
            }, settings.animDelay * i);
            //alert($('#container4').html().length);
        });
    }
};
$(function () {
    $('#container1').teletype({
        animDelay: 100,
        text: 'This is message 1'
    });
    $('#container2').teletype({
        animDelay: 100,
        text: 'this is message 2'
    });
    $('#container3').teletype({
        animDelay: 100,
        text: 'this is message 3'
    });
    $('#container4').teletype({
        animDelay: 100,
        text: 'this is message 4'
    });
});
if ($('#container4').html().length == 17) {
    alert("test")
} //this not work with me 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:30:40.883

我会添加一个或多个回调选项，使您的设置哈希看起来像：

```
{
  animDelay: 100,
  text: 'this is message 4',
  after: function (text) {
     alert($(this).attr('id') + ' teletype completed: ' + text);
  },
  afterChar: function(ltr, ltrIndex, text) {
     console.log('typed "'+ ltr + '" - character '+ ltrIndex + '/' + text.length + ' in "' + text +'"');
  }
} 
```

因此，要实现回调，您将执行以下操作：

```
$.fn.teletype = function (opts) {
    iteration++;
    var $this = this,
        defaults = {
            animDelay: 50
        }, settings = $.extend(defaults, opts);

    var letters = settings.text.length; //added
    where = '#' + $($this).attr('id'); //added
    when = settings.animDelay; //added

    if (iteration > 1) {
        bigDelay = bigDelay + settings.text.length * settings.animDelay;
        setTimeout(function () {
            $.each(settings.text, function (i, letter) {
                setTimeout(function () {
                    $this.html($this.html() + letter);

                    // if we have a settings.afterChar function execute it,
                    // binding 'this' to the container element and sending along
                    // pertinent arguments
                    if(typeof settings.afterChar == 'function') {
                       settings.afterChar.apply($this, [letter, i, settings.text]);
                    }

                    // if this is the last character and we have  settings.after function
                    // then execute it, binding it to the container element and sending along
                    // pertinent arguments
                    if(i+1 === settings.text.length && typeof settings.after == 'function') {
                       settings.after.apply($this, [settings.text]);
                    }
                }, settings.animDelay * i);
            });
        }, bigDelay);
    } else {
        $.each(settings.text, function (i, letter) {
            setTimeout(function () {
                $this.html($this.html() + letter);

                    // if we have a settings.afterChar function execute it,
                    // binding 'this' to the container element and sending along
                    // pertinent arguments
                if(typeof settings.afterChar == 'function') {
                   settings.afterChar.apply($this, [letter, i, settings.text]);
                }

                 // if this is the last character and we have  settings.after function
                 // then execute it, binding it to the container element and sending along
                 // pertinent arguments
                if(i+1 === settings.text.length && typeof settings.after == 'function') {
                   settings.after.apply($this, [settings.text]);
                }
            }, settings.animDelay * i);
        });
    }
}; 
```

修改过的小提琴：http: [//jsfiddle.net/gjCLh/](http://jsfiddle.net/gjCLh/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:45:42.273

I would pass a callback as argument and test if the text length has been reach

[http://jsfiddle.net/dnkwp/34/](http://jsfiddle.net/dnkwp/34/)

```
$('#container3').teletype({
    animDelay: 100,
    text: 'this is message 3'
});
$('#container4').teletype({
    animDelay: 100,
    text: 'this is message 4',
    callback : function () {
        alert('coucou')
    }
});

//Your plugin
....
    $.each(settings.text, function (i, letter) {
        setTimeout(function () {
            $this.html($this.html() + letter);
            if ((settings.callback != null)&&(i == settings.text.length-1))
                settings.callback();
        }, settings.animDelay * i);
    });
.... 
```

# .net - 反序列化时 Protobuf-net memcache provider null 类型错误

> ID：14862333
> 
> 赞同：3
> 
> 时间：2013-02-13T20:18:48.603
> 
> 标签：.net, memcached, protobuf-net

我正在使用最新的 protobuf-net lib 和 protobuf-net memcache 提供程序。我需要序列化自定义类型 MyClass 的列表

```
[ProtoContract]
public class MyClass{
  [ProtoMember(1)]
  public int a {get; set;}
  [ProtoMember(2)]
  public int b {get; set;}
} 
```

所以我需要存储/检索：

```
List<MyClass> myList 
```

当值通过 protobuf 存储然后从缓存中检索时一切顺利。但是，如果值存储在 memcache 中（以正确的 protobuf 格式），即来自另一个线程/应用程序，然后由于类型字段的 NullReferenceExceptions 从缓存反序列化中检索该值失败。

因此，当首先设置时，序列化值的类型存储在 typeCache 变量中，然后从该字典中检索。但是，如果值存在于内存缓存中但未在当前线程中设置，则 typeCache var 不包含该类型并在反序列化时抛出 NullReference。

有没有办法解决这个问题或一些解决方法？

更深入的调查：enyim 的序列化/反序列化过程在`ProtoTranscoder.cs`. 它包含`NetTranscoder`具有`Dictionary<ArraySegment<byte>, Type> typeCache`. 因此，当 set 第一个序列化类型（即`List<MyClass>`）存储在`typeCache`var 中时，一切顺利。如果值存在于内存缓存中，但未在当前应用程序/线程中设置反序列化，则通过此代码检索它：

```
type = Type.GetType(enc.GetString(buffer, keyOffset, len));
byte[] standaloneBuffer = new byte[len];
Buffer.BlockCopy(buffer, keyOffset, standaloneBuffer, 0, len);
key = new ArraySegment<byte>(standaloneBuffer, 0, len);
sync.EnterWriteLock();
try
   {
        // did somebody beat us to it?
        Type tmp;
        if (typeCache.TryGetValue(key, out tmp)) return tmp;
        typeCache.Add(key, type);
        return type;   <-- Here it returns null, if type not present in typeCache
   }
finally
   {
        sync.ExitWriteLock();
   } 
```

要重现该错误：

1.  项目清单
2.  在内存缓存中创建和存储一些列表（使用配置的 prototranscoder）
3.  重新启动当前应用程序（或启动另一个线程）
4.  尝试从那些“另一个线程”的 memcache 中按键获取值

这是此错误的堆栈跟踪：[ArgumentNullException：值不能为空。参数名称：类型]

```
 ProtoBuf.Meta.TypeModel.PrepareDeserialize(Object value, Type& type) in c:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:592
   ProtoBuf.Meta.TypeModel.Deserialize(Stream source, Object value, Type type, SerializationContext context) in c:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:577
   ProtoBuf.Caching.Enyim.NetTranscoder.Enyim.Caching.Memcached.ITranscoder.Deserialize(CacheItem item) in c:\Users\akureniov\work\protobuf-net-1\protobuf-net.Enyim\protobuf-net.Enyim\ProtoTranscoder.cs:109
   Enyim.Caching.MemcachedClient.PerformTryGet(String key, UInt64& cas, Object& value) +179
   Enyim.Caching.MemcachedClient.TryGet(String key, Object& value) +42
   Enyim.Caching.MemcachedClient.Get(String key) +15 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T13:48:37.583

[在Marc Gravell](https://stackoverflow.com/users/23354/marc-gravell)的帮助下，我们在 ProtoTranscoder.cs 的类型修整中发现了“错误”：NetTranscoder: void WriteType(MemoryStream ms, Type type)。此代码块导致错误，因为它削减了太多：

```
int i = typeName.IndexOf(','); // first split
if (i >= 0) { i = typeName.IndexOf(',', i + 1); } // second split
if (i >= 0) { typeName = typeName.Substring(0, i); } // extract type/assembly only 
```

它适用于简单类型，但在 List、Dictionary 等上失败。

为避免这种情况，最好使用正则表达式来减少不必要的信息（如文化、publickkeytoken 等）。所以这是一个替换（需要用这个替换上面的行），安静粗鲁，但在大多数情况下都有效：

```
typeName = Regex.Replace(typeName, @", Version=\d+.\d+.\d+.\d+", string.Empty);
typeName = Regex.Replace(typeName, @", Culture=\w+", string.Empty);
typeName = Regex.Replace(typeName, @", PublicKeyToken=\w+", string.Empty); 
```

此正则表达式不会剪切类型的程序集，这是自定义类型所必需的。但是对于标准类型，`mscorlib`在大多数情况下可以通过添加另一行来安全地删除它：

```
typeName = Regex.Replace(typeName, @", mscorlib", string.Empty); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:22:10.683

我认为 memcache 不理解`ProtoContract`，尝试将它们标记为`DataContract`

# web-services - VB6 应用程序调用 Rest Service

> ID：14862334
> 
> 赞同：1
> 
> 时间：2013-02-13T20:19:00.743
> 
> 标签：web-services, rest, vb6

我必须从 VB6 调用 REST 服务。我按照这篇文章 [获取/发布到 RESTful Web 服务](https://stackoverflow.com/questions/3516119/get-post-to-restful-web-service)，但没有取得太多成就。

到目前为止我所做的是：

```
Dim sUrl As String
Dim response As String
Dim xmlhttp

sUrl = "myserviceurl"
xmlhttp = CreateObject("MSXML2.xmlhttp")
xmlhttp.open "GET", sUrl, False
xmlhttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"

Set xmlhttp = Nothing 
```

已将**MSXML6**添加到我的项目参考中。

我收到此错误：

```
 Object doesnt support this Method.. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:29:56.553

试试下面的代码

```
Dim xmlhttp As MSXML2.XMLHTTP 
Set xmlhttp = New MSXML2.XMLHTTP 
```

# javascript - Javascript if else 对处理程序有帮助

> ID：14862339
> 
> 赞同：0
> 
> 时间：2013-02-13T20:19:30.523
> 
> 标签：javascript

现在表格是一个表格，这是新的破代码

```
 <script language="javascript" type="text/javascript">
function verifyIt(){
    if((document.form1.baseline_08.value != "" && Number(document.form1.baseline_08.value) &&  document.form1.baseline_08.value != "-1")){
    if((document.form1.baseline_09.value != "" && Number(document.form1.baseline_09.value) &&  document.form1.baseline_09.value != "-1")){
        document.form1.submit();
        return true;
    }else{
        alert("Please select how old you were when you started smoking every day.");
        return false;
    }
}
function submit2(){
    document.form1.direction.value = "back";
    document.form1.submit();
}

</script> 
```

现在验证根本不起作用。我只是不明白这有什么问题。

我遇到的问题是 form1 是唯一被识别的。我相信这是因为我的 if 语句结构。基本上我只从form1中得到回报。我的js有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:25:25.780

> 我相信这是因为我的 if 语句结构。

是的，你总是`return`在检查之后`form1`。但是，您不能一次提交多个表单，因此您应该将它们合并为一个。然后使用

```
function verifyIt() {
    if(!(document.form.baseline_08.value == "" && Number(document.form.baseline_08.value) &&  document.form.baseline_08.value != "-1")){
        alert("Please select how old you were when you started smoking every day.");
        return false;
    }
    if(!(document.form.baseline_09.value != "" && Number(document.form.baseline_09.value) &&  document.form.baseline_09.value != "-1")){
        alert("Please select when you would smoke after waking up.");
        return false;
    }
    document.form.submit();
} 
```

# jquery - 如何在 elycharts 中控制 Y 轴上的标签

> ID：14862340
> 
> 赞同：1
> 
> 时间：2013-02-13T20:19:31.647
> 
> 标签：jquery

Y 轴标签始终从 0 开始，直到略大于图中的最大值。我想从 50 开始，一直到 100（50,60,70,80,90,100）。

我正在使用的代码如下：

html代码：div id='chart_1' style='height:200px;width:400px;' /div

Javascript代码：

```
$(document).ready(function () {
      $.elycharts.templates['line_basic_3'] = {
        type: "line",
        margins: [22, 10, 20, 30],
        defaultSeries: {
            type: "line",
            rounded: false,
            plotProps: {
                "stroke-width": 5
            }
        },
        series: {
            serie1: {
                type: "line",
                color: "#AAAAAA"
            },
            serie2: {
                type: "line",
                color: "#00AA00"
            },
            serie3: {
                type: "line",
                color: "#0000BB"
            },
            serie4: {
                type: "line",
                color: "green"
            },
            serie5: {
                type: "line",
                color: "black"
            }
        },
        defaultAxis: {
            labels: true,
            labelsProps: {
                fill: "#FFF",
                "font-size": "10px"
            }
        },
        features: {
            grid: {
                draw: [true, false],
                forceBorder: true,
                //ny: 3, // use 10 divisions for y grid
                //nx: 5, // 10 divisions for x grid
                props: {
                    stroke: "#FFF" // color for the grid
                }
            },
            legend: {
                horizontal: true,
                width: 360,
                height: 20,
                x: 30,
                y: 0,
                borderProps: {
                    "fill-opacity": 0.1
                }
            }
        }
    }

$('#chart_1' ).chart({ template: 'line_basic_3', legend: {serie1:'2011',serie2:'2012',serie3:'2013'}, labels: ['Jan','Feb','Mar'], values: {serie1:[20,45,10],serie2:[40,15,35],serie3:[10,30,5]}});"
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T13:38:24.560

你可以试试这个。获取所有系列数据的最小值，然后从系列数据的每个值中减去该值。然后为 l（'left'）轴的 labelsFormatHandler 数据实现一个处理程序，它将“重新格式化”要显示的 y 轴标签。只是为了说明，我使用了 Kasyx 上面提到的小提琴并尝试显示从 -1000 开始的 y 轴。请检查[这个](http://jsfiddle.net/manuelmanlangit/Nrm96/)生成的小提琴或下面的代码：

的HTML

```
    <div id="chart" style="width: 300px; height: 300px"></div>

```

javascript代码：

```
//here is the series data
var series1 = [-1100, 35, 44, 83];
var series2 = [7, 15, 10, 130];

//{{gets the min value and substract this value to each 
//value of all the series data.  This will make the chart "start" at the min value
var startsAtMinY = true;
var minY = Number.MAX_VALUE;
function setMinY(series) {
    minY = Math.min(minY, Math.min.apply(Math, series));
}
function translateSeriesData(series){
    for (var i = 0; i < series.length; i++) {
        series[i] -= minY;
    }
}
setMinY(series1);
setMinY(series2);
translateSeriesData(series1);
translateSeriesData(series2);
//}}

$(function() {
  $("#chart").chart({
  template: "line_basic_2",
  tooltips: {
    serie1: ["a", "b", "c", "d"],
    serie2: ["a", "b", "c", "d"]
  },
  values: {
      serie1: series1,
      serie2: series2
//    serie1: [-1100, 35, 44, 83],
//    serie2: [7, 15, 10, 130]
  },
  defaultSeries: {
    fill: true,
    stacked: false,
    highlight: {
      scale: 2
    },
    startAnimation: {
      active: true,
      type: "grow",
      easing: "bounce"
    }
  }
});

});

$.elycharts.templates['line_basic_2'] = {
  type: "line",
  margins: [10, 10, 20, 50],
  defaultSeries: {
    plotProps: {
      "stroke-width": 4
    },
    dot: true,
    dotProps: {
      stroke: "white",
      "stroke-width": 2
    }
  },
  series: {
    serie1: {
      color: "red"
    },
    serie2: {
      color: "blue"
    }
  },
  defaultAxis: {
    labels: true
  },
    axis: {
        l: {
            labels: true,
            //to "reformat" the y-axis values
            labelsFormatHandler: function (label) {
                        if (startsAtMinY) {
                            return (minY + parseFloat(label)).toString();
                        } else {
                            return label;
                        }
             }
        }
    },    
  features: {
    grid: {
      draw: [true, false],
      props: {
        "stroke-dasharray": "-"
      }
    },
    legend: {
      horizontal: false,
      width: 80,
      height: 50,
      x: 220,
      y: 250,
      dotType: "circle",
      dotProps: {
        stroke: "white",
        "stroke-width": 2
      },
      borderProps: {
        opacity: 0.3,
        fill: "#c0c0c0",
        "stroke-width": 0
      }
    }
  }
}; 
```

# scala - 惯用的 Scala 遍历所有子字符串

> ID：14862347
> 
> 赞同：6
> 
> 时间：2013-02-13T20:19:58.620
> 
> 标签：scala, functional-programming, idioms

比这更不重要的事情：

`def subs(s: String) = for {start <- 0 to s.length; end <- i to s.length} yield s.substring(start, end)`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-13T20:35:26.437

```
scala> "asdf".inits.flatMap(_.tails).toList
res2: List[String] = List(asdf, sdf, df, f, "", asd, sd, d, "", as, s, "", a, "", "") 
```

如果要删除空字符串：

```
scala> "asdf".inits.flatMap(_.tails.toList.init).toList
res3: List[String] = List(asdf, sdf, df, f, asd, sd, d, as, s, a) 
```

但请注意，正如@Randall Schulz 在评论中指出的那样，这种咒语对读者来说并不那么明显。另一方面，您的原始版本立即清晰。

# asp.net-mvc-3 - 排除 MVC4 Web API 性能问题

> ID：14862352
> 
> 赞同：4
> 
> 时间：2013-02-13T20:20:20.977
> 
> 标签：asp.net-mvc-3, iis-7, asp.net-mvc-4, asp.net-web-api, memorycache

我有一个 asp.net mvc4 web api 接口，每天收到大约 54k 个请求。

[http://myserv.x.com/api/123/getstuff?whatstuff=thisstuff](http://myserv.x.com/api/123/getstuff?whatstuff=thisstuff)

我在负载均衡器后面有 3 个 Web 服务器，它们设置为处理 http 请求。

平均响应时间约为 300 毫秒。但是，最近出现了问题（或者可能一直存在），因为响应时间在 10-20 秒内返回的零星行为。这将是针对直接访问同一服务器而不是通过负载均衡器的相同请求。

```
GIVEN:
- System has been passed down to me so there may be gaps with IIS confiuration, etc,.
- Database: SQL Server 2008R2
- Web Servers: Windows Server 2008R2 Enterprise SP1
- IIS 7.5
- Using MemoryCache aggressively with Model and Business Objects with eviction set to 2hrs
- Looked at the logs but really don't see anything significantly relevant
- One application pool...no other LOB applications running on this server 
```

假设和提问：不知何故，我认为某些东西正在回收应用程序池或 IIS 工作线程正在关闭并重新启动，从而导致每个新请求都进行预热和重新缓存。它是如此零星，以至于现在很难解决问题。对同一服务器的相同请求按预期快速返回（背靠背 N 个请求），因为它在大约 300 毫秒内被缓存......但等待大约 5-10-20 分钟，对同一服务器的相同请求需要 16 秒。

由于这些是生产系统，因此我只能进行有限的跟踪，因此我只能公开这么多的日志记录详细信息。任何攻击此或其他人遇到的类似行为的帮助和信息都将受到赞赏。谢谢

**更新：** w3wpe.exe 进程增长到 ~3G。不知何故，它被消灭了，PID 改变了，所以它本身或某些东西每 3-4 分钟就会杀死它我在我的网络服务器（IIS）日志中看到大量警告：

> 为应用程序池“MyApplication”提供服务的进程与 Windows 进程激活服务发生了致命的通信错误。进程 ID 为“1732”。数据字段包含错误号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T05:10:03.677

经过 4-5 天的 IIS 和配置与内部代码问题评估后，我终于发现了这个问题，而使用 windbg 或 debugdiag IIS 工具几乎没有帮助。即使使用小型转储或日志跟踪堆栈，这些工具也包含如此多的信息，以至于它们可能是红鲱鱼。最好的办法是通过设置生产系统的“智能复制”实例来重现它，我们当时没有这个实例，并且需要一些操作来设置一些东西。

不用说，问题与过度缓存业务对象有关。有一个竞争条件，其中某个表上的更新正在更新相应业务对象的属性（更新来自多个服务器），这导致 OOC stackoverflow 几乎导致缓存递归地将自身缓存到死，从而导致 w3wp .exe 进程死亡并伪回收自身。这是在非生产环境中极难测试和重现的边缘案例之一。

# java - 单个 JVM 中的多个 Jython 环境

> ID：14862356
> 
> 赞同：1
> 
> 时间：2013-02-13T20:20:36.623
> 
> 标签：java, jython, jython-2.5

是否可以在一个 JVM 下运行多个具有不同系统设置（即库导入路径）的 Jython 环境。

如果可能，请建议如何正确完成此操作。

从技术上讲，没有什么能阻止我`PythonInterpreter interpreter = new PythonInterpreter();`执行不止一次。但我想确定里面的某个地方没有单身人士。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T14:49:42.407

检查源代码后，似乎 PySystemState 是单例的

[源代码](https://bitbucket.org/jython/jython/src/1af38173c96d60d2500997fa9e5fc11c22c3b033/src/org/python/core/PySystemState.java?at=default#cl-132)

```
public class PySystemState extends PyObject implements ClassDictInit {
...
    private static boolean initialized = false;
... 
```

[源代码](https://bitbucket.org/jython/jython/src/1af38173c96d60d2500997fa9e5fc11c22c3b033/src/org/python/core/PySystemState.java?at=default#cl-893)

```
public static synchronized PySystemState doInitialize(Properties preProperties,
                                                 Properties postProperties,
                                                 String[] argv,
                                                 ClassLoader classLoader,
                                                 ExtensiblePyObjectAdapter adapter) {
        if (initialized) {
            return Py.defaultSystemState;
        }
        initialized = true;
... 
```

这意味着 PySysStatus 属性仅设置一次，下一次调用获取 PySysState 将返回相同的 Jython 环境。

仍然可以使用自定义 ClassLoader 在不同的上下文中初始化不同的 PySysState，但对于我手头的任务来说，这不是必需的。

# oracle - 接收日期作为参数输入时出错

> ID：14862363
> 
> 赞同：1
> 
> 时间：2013-02-13T20:20:58.947
> 
> 标签：oracle, date, plsql, runtime-error, procedure

插入日期以测试我正在处理的参数时出现错误。错误是：

```
01858\. 00000 -  "a non-numeric character was found where a numeric was expected"
*Cause:    The input data to be converted using a date format model was
           incorrect.  The input data did not contain a number where a number was
           required by the format model.
*Action:   Fix the input data or the date format model to make sure the
           elements match in number and type.  Then retry the operation. 
```

这是我的测试脚本：

```
set serveroutput on
declare
  type tempcursor is ref cursor;
  v_cur_result tempcursor;
  errcode number;
  errmesg varchar2(1000);
  p_statusmnemonic_in         acts.ct_cu_act_medrecon_pg.varchararrayplstype;
  p_processtypemnemonic_in    transactionprocesslog.processtypemnemonic%type; 
  p_primarymemberplanid_in    membermedicalreconcilationhdr.primarymemberplanid%type;
  p_assigneduserid_in         membermedicalreconcilationhdr.assigneduserid%type;
  p_accountorgid_in           membermedicalreconcilationhdr.accountorgid%type;
  p_reconstatusmnemonic_in    membermedicalreconcilationhdr.reconciliationstatusmnemonic%type;
  p_estimatedenddt_in         membermedicalreconcilationhdr.estimatedenddt%type;
  p_actualenddt_in            membermedicalreconcilationhdr.actualenddt%type;
  p_inserteddate_in           membermedicalreconcilationhdr.inserteddt%type;
  p_insertedby_in             membermedicalreconcilationhdr.insertedby%type;
  p_updateddate_in           membermedicalreconcilationhdr.updateddt%type;
  p_updatedby_in           membermedicalreconcilationhdr.updatedby%type;

begin
  p_statusmnemonic_in(1) := ('OPEN');
  p_statusmnemonic_in(2) := ('SUSPENDED_PRIOR_TO_COMPARE');
  ct_cu_act_medrecon_pg.sps_get_patientmedrecs_hdr      
  (p_statusmnemonic_in,'NO','26-JAN-14',v_cur_result, errcode, errmesg);

   loop
fetch v_cur_result into     p_primarymemberplanid_in,p_assigneduserid_in,p_accountorgid_in,p_reconstatusmnemonic_in,
                        p_estimatedenddt_in,p_actualenddt_in,p_inserteddate_in,p_insertedby_in,
                        p_updateddate_in,p_updatedby_in,p_processtypemnemonic_in;

  dbms_output.put_line(' planid '||p_primarymemberplanid_in||' userid '||p_assigneduserid_in);

  exit when v_cur_result%notfound;
  end loop;

  dbms_output.put_line(' error code '||errcode||' message '||errmesg);
end; 
```

当日期设置为“24-JAN-13”时，我没有收到错误，但第二次我更改了任何内容，我收到了该错误。这是我正在查看的表中的两个估计日期字段：

```
24-JAN-13 04.29.19.989847000 PM
28-JAN-13 08.52.27.187015000 PM 
```

这是我的过程：

```
 procedure sps_get_patientmedrecs_hdr (
    p_statusmnemonic_in       in varchararrayplstype,
    p_processtypemnemonic_in  in transactionprocesslog.processtypemnemonic%type,
    p_estimatedenddt_in       in membermedicalreconcilationhdr.estimatedenddt%type,
    p_return_cur_out          out sys_refcursor,
    p_err_code_out            out number,
    p_err_mesg_out            out varchar2)
  is
     lv_varchararray         varchararray := varchararray();
  begin
    if p_statusmnemonic_in.count > 0
    then
      for rec1 in 1..p_statusmnemonic_in.count
      loop
        lv_varchararray.extend(1);
        lv_varchararray(rec1) := p_statusmnemonic_in(rec1);
      end loop;

        open p_return_cur_out for
        select h.membermedreconciliationhdrskey,
               h.primarymemberplanid,
               h.assigneduserid,
               h.accountorgid,
               h.reconciliationstatusmnemonic,
               h.estimatedenddt,
               h.actualenddt,
               h.inserteddt,
               h.insertedby,
               h.updateddt,
           h.updatedby
        from membermedicalreconcilationhdr h
        where h.reconciliationstatusmnemonic in (select *
                                             from table (cast(lv_varchararray as varchararray)))
        and h.estimatedenddt <= nvl(p_estimatedenddt_in, h.estimatedenddt)
        and not exists (select *
                        from transactionprocesslog tpl
                        where tpl.transactiontypemnemonic = 'MEDREC'
                        and tpl.transactionid = h.primarymemberplanid
                        and nvl(p_processtypemnemonic_in, tpl.processtypemnemonic) = tpl.processtypemnemonic);
    else
        open p_return_cur_out for
        select h.membermedreconciliationhdrskey,
               h.primarymemberplanid,
               h.assigneduserid,
               h.accountorgid,
               h.reconciliationstatusmnemonic,
               h.estimatedenddt,
               h.actualenddt,
               h.inserteddt,
               h.insertedby,
               h.updateddt,
               h.updatedby
        from membermedicalreconcilationhdr h; 
    end if;

  p_err_code_out := 0;  
  exception
    when others then
      p_err_code_out := -1;
      p_err_mesg_out := 'error in ct_cu_act_medrecon_pg.sps_get_patientmedrecs_hdr => ' || sqlerrm;
  end sps_get_patientmedrecs_hdr; 
```

我尝试了 to_date 函数，但收到了同样的错误。任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:35:45.797

看起来您将字符串视为日期，这取决于您的 NLS 设置可能会或可能不会起作用。每当 Oracle 看到它期望日期的字符串时，它会尝试根据该字符串是否恰好与您的特定会话的日期格式参数匹配来进行隐式日期转换。这是一个非常常见的错误来源。

要使用正确的日期，您可以使用 to_date 函数，如下所示：

```
to_date('26-JAN-14','DD-MON-RR') 
```

或使用本机语法来指定日期文字，这是我推荐的：

```
date'2014-1-26' 
```

# active-directory - 如何清除或更新 Active Directory 中的 thumbnailPhoto？

> ID：14862368
> 
> 赞同：1
> 
> 时间：2013-02-13T20:21:15.967
> 
> 标签：active-directory

我可以使用以下代码向 AD 添加图片

```
entryToUpdate.Properties["thumbnailPhoto"].Add(binaryData);
entryToUpdate.CommitChanges(); 
```

但是当我尝试更新时，出现错误（指定的目录服务属性或值已存在）。我正在清除图片，但它似乎确实有效。

```
entryToUpdate.Properties["thumbnailPhoto"].Clear(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:22:55.983

我让它工作了。我每次都必须提交更改。

```
entryToUpdate.Properties["thumbnailPhoto"].Clear();
entryToUpdate.CommitChanges();

entryToUpdate.Properties["thumbnailPhoto"].Add(binaryData);
entryToUpdate.CommitChanges(); 
```

# java - ORMLite dataType=DataType.SERIALIZABLE 不起作用

> ID：14862372
> 
> 赞同：2
> 
> 时间：2013-02-13T20:21:27.007
> 
> 标签：java, android, serialization, ormlite

我已将我的类型声明`SERIALIZABLE`为 ORMLite 文档中指定的类型，但我仍然得到：

> ORMLite 无法为字段“task_titles”存储未知类接口 java.io.Serializable。可序列化字段必须指定 dataType=DataType.SERIALIZABLE

我的代码如下所示：

```
@DatabaseField(dataType=DataType.SERIALIZABLE) 
private Serializable task_titles;

public User() {
    task_titles = new ArrayList<String>();
} 
```

我也尝试过使用，因为 ArrayList 是可序列化的，但没有运气。

```
private ArrayList<String> task_titles; 
```

由于其他原因（我无法控制的应用程序的限制），在这种情况下创建另一个包含任务标题的表不是一个好的选择。这是完整的例外：

```
02-13 21:07:12.593: E/AndroidRuntime(15500): java.lang.RuntimeException: Unable to start activity ComponentInfo{lemonhat.snote/lemonhat.snote.MainActivity}: java.lang.RuntimeException: Could not create RuntimeExcepitionDao for class class lemonhat.snote.db.User
02-13 21:07:12.593: E/AndroidRuntime(15500):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
...
02-13 21:07:12.593: E/AndroidRuntime(15500): Caused by: java.lang.RuntimeException: Could not create RuntimeExcepitionDao for class class lemonhat.snote.db.User
02-13 21:07:12.593: E/AndroidRuntime(15500):    at com.j256.ormlite.android.apptools.OrmLiteSqliteOpenHelper.getRuntimeExceptionDao(OrmLiteSqliteOpenHelper.java:260)
02-13 21:07:12.593: E/AndroidRuntime(15500):    at lemonhat.snote.db.DatabaseHelper.getUserDataDao(DatabaseHelper.java:109)
02-13 21:07:12.593: E/AndroidRuntime(15500):    at lemonhat.snote.MainActivity.onCreate(MainActivity.java:80)
...
02-13 21:07:12.593: E/AndroidRuntime(15500): Caused by: java.sql.SQLException: ORMLite can't store unknown class interface java.io.Serializable for field 'sort_order_of_lists'. Serializable fields must specify dataType=DataType.SERIALIZABLE
02-13 21:07:12.593: E/AndroidRuntime(15500):    at com.j256.ormlite.field.FieldType.<init>(FieldType.java:183)
02-13 21:07:12.593: E/AndroidRuntime(15500):    at com.j256.ormlite.table.DatabaseTableConfig.convertFieldConfigs(DatabaseTableConfig.java:236)
02-13 21:07:12.593: E/AndroidRuntime(15500):    at com.j256.ormlite.table.DatabaseTableConfig.extractFieldTypes(DatabaseTableConfig.java:101)
02-13 21:07:12.593: E/AndroidRuntime(15500):    at com.j256.ormlite.dao.BaseDaoImpl.initialize(BaseDaoImpl.java:151)
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T14:13:14.823

> ORMLite 无法为字段“sort_order_of_lists”存储未知的类接口 java.io.Serializable。可序列化字段必须指定 dataType=DataType.SERIALIZABLE

我错过了什么吗？此错误正在谈论该字段`sort_order_of_lists`，但您正在显示另一个字段：

```
@DatabaseField(dataType=DataType.SERIALIZABLE) 
private Serializable task_titles; 
```

我怀疑`sort_order_of_lists`缺少`dataType=DataType.SERIALIZABLE`注释字段。该字段是否在基类中？

如果这不是问题，那么我怀疑您正在使用 Android 的 table-config 功能，您需要重新生成 table-config，因为它与您的对象不同步。有关此功能的更多详细信息，请参阅链接：

> [http://ormlite.com/docs/table-config](http://ormlite.com/docs/table-config)

# r - 从 gtable 容器中提取/替换对象

> ID：14862379
> 
> 赞同：0
> 
> 时间：2013-02-13T20:21:45.623
> 
> 标签：r, plot, gwidgets

我已经将一个渐变对象放入一个 gtable 单元格中。基于来自另一个控件的选择，我想修改渐变对象的性质并将其替换在同一个单元格中。

```
 tmpL <- gframe(" Locations ", container=group, columns=2, horizontal=TRUE)

    tblL <- glayout(container=tmpL,spacing=5)
    tblL[1,1] <- 'Basin';tblL[1,2] <- 'Layer';
    tblL[2,1] <- gradio(names(availBasins1),cont=tblL)
    tblL[2,2] <- gradio(names(availLayers),cont=tblL 
```

tblL[2,1] 的内容将根据从单独控件中选择的结果使用不同的渐变对象进行修改。下一步是什么？

# python - Python - 从 SiriServer 插件解密线路

> ID：14862383
> 
> 赞同：0
> 
> 时间：2013-02-13T20:22:00.290
> 
> 标签：python, siri

我目前正在学习如何为 SiriServer 编写插件，希望能用我的手机创建一些家庭自动化。我试图弄清楚如何对文本转换的语音进行编程以匹配和运行插件。

我已经学会了如何短句，例如：

```
@register("en-US", ".*Start.*XBMC.*") 
```

虽然如果我理解它正在随机搜索这两个词。如果我说 XBMC Start，它可能也可以，但是当我开始使用 wolframalpha 时，我需要更具体一些。

例如，对文本的语音说“多伦多的天气怎么样？”，不知何故与此相关：

```
@register("en-US", "(what( is|'s) the )?weather( like)? in (?P<location>[\w ]+?)$") 
```

该行中所有额外的符号意味着什么可以将这两者连接在一起？我试过搞乱几个想法，但似乎没有什么能按我想要的方式工作。任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T22:39:11.697

我将分解您提供的示例，希望这是一个好的开始，但搜索 python regex 将提供更全面的信息。括号将封闭的项目设置为结果，而不是剩余表达式的单个项目。管道表示“或”，问号表示这部分可能存在也可能不存在，位置组是一个正则表达式，它将变量“位置”设置为输入中此时提供的输入。末尾的 $ 表示这将完成句子。.* 表示输入中此位置的任何内容都可以接受，但也应忽略。希望这会有所帮助。

# php - 如何在 PHPExcel 中创建包含非连续单元格的命名范围？

> ID：14862390
> 
> 赞同：3
> 
> 时间：2013-02-13T20:22:19.713
> 
> 标签：php, phpexcel

如何在 PHPExcel 中创建包含非连续单元格的命名范围？甚至可能吗？提前致谢！

这是我所做的：

```
$objPHPExcel->addNamedRange(
   new PHPExcel_NamedRange('ToggleRange', $activeSheet, 'C4:G5,C9:J10,C14:H15')
); 
```

但发生的情况是，命名范围仅应用于 C4:G5，而不应用于其他单元格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:53:22.943

```
$objPHPExcel->addNamedRange( 
    new PHPExcel_NamedRange(
        'MyNamedRange', 
        $objPHPExcel->getActiveSheet(), 
        'A1:A3,C1:C3,E1:E3'
    ) 
); 
```

# indexing - 转换过滤器

> ID：14862397
> 
> 赞同：0
> 
> 时间：2013-02-13T20:22:33.547
> 
> 标签：indexing, mapreduce, ravendb

我有以下地图/变换

```
public class PositionSearch : AbstractIndexCreationTask<Employer>
{
    public PositionSearch()
    {
        Map = employers => 
            from employer in employers
            from position in employer.Positions
            select new
            {
               EmployerName = employer.Name,
               SearchSkills = position.RequiredSkills
                                      .Select(x => x.Skill)
            };

        TransformResults = (database, results) => 
            from result in results
            from position in result.Positions
            select new
            {
                EmployerId = result.Id,
                EmployerName = result.Name,
                PositionId = position.Id,
                PositionTitle = position.Title,
                RequiredSkills = position.RequiredSkills
                                    .Select(x => new { x.Skill, x.Proficiency })
            };

        // Any field you are going to use .Search() on should be analyzed.
        Index("SearchSkills", FieldIndexing.Analyzed);
    }
} 
```

我有一个雇主对象，有两个职位，每个职位都有一个技能，“NH”和“MVC”

当我执行以下查询时，我得到了两个位置结果，而我期望的是一个。谁能告诉我为什么会这样？我有一种感觉，这与我正在表演的加入有关，但我不确定。

```
using (var session = DocumentStore.OpenSession())
{
     var results = session.Query<PositionSearchResultModel, PositionSearch>()
                    .Customize(x => x.WaitForNonStaleResults())
                        .Search(x => x.SearchSkills, "NH")
                    .OfType<PositionSearchResultModel>().ToList();

      Assert.AreEqual(1, results.Count());
} 
```

我想使用转换，以便我可以访问 Temp-Index-Score 元数据进行排序，到目前为止，我无法在没有转换的情况下访问元数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:55:35.003

您正在为`Employer`文档编制索引。搜索找到了包含相关技能的文档，然后您要求转换*文档*。

您[之前](https://stackoverflow.com/q/14835172/634824)拥有它的方式是从索引中投影，这是您将找到的特定位置作为结果的一部分的唯一方法。

我真的认为你会更高兴，`Position`因为它是自己的文件......

```
public class Employer
{
    public string Id { get; set; }
    public string Name { get; set; }
}

public class Position
{
    public string Id { get; set; }
    public string EmployerId { get; set; }
    public string Title { get; set; }
    public string Location { get; set; }
    public ICollection<SkillProficiency> RequiredSkills { get; set; }
} 
```

这在思考上可能看起来更具关联性，但它在 RavenDB 中工作得很好，而且查询起来比你现在做的要容易得多。

# internet-explorer - 如果没有发送 If-Modified-Since 会得到 304？

> ID：14862399
> 
> 赞同：3
> 
> 时间：2013-02-13T20:22:39.797
> 
> 标签：internet-explorer, http, caching, iis-7, browser-cache

我试图了解 IE 中的一些浏览器缓存行为。我有一个包含一些 css 的测试页面并执行以下操作：

编辑：我不清楚，我有一个 test.html 文件，它有一个指向 test.css 文件的链接。test.html 文件每次都会重新发送，只有 test.css 文件被缓存。

IE9：

1.  转到页面以获取当前文件
2.  css 文件返回 19:58 的 Last-Modified 标头
3.  更改css文件
4.  点击网址栏并按回车键
5.  为 css 文件获取未修改的 304

在请求中发送以下标头：

```
Request GET /test.css HTTP/1.1
Accept text/css
Referer http://10.0.0.60/test.html
Accept-Language en-US
User-Agent Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Accept-Encoding gzip, deflate
Host 10.0.0.60 
```

响应中的 Last-Modified 标头是 19:58（与修改文件之前相同）

单击指向同一页面或使用相同 css 文件的另一个页面的链接会执行相同的操作。

Ctrl+R 发送一个 If-Modified-Since 标头并获取更新的文件。

所以我的问题是，是什么决定浏览器应该使用缓存版本？如果没有 If-Modified-Since 标头，为什么服务器返回 304？

服务器是 IIS 7

# ruby-on-rails - 此 add_index 命令的索引名称是什么

> ID：14862400
> 
> 赞同：1
> 
> 时间：2013-02-13T20:22:40.100
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

在架构中我有这个：

```
 add_index "key_performance_indicators", ["organization_id"], :name => "index_key_performance_inds_on_organization_id" 
```

我想编写一个 remove_index 迁移来删除这个索引，但不知道我应该使用什么索引名称？是`key_performance_inds`还是`performance_inds_on_organization_id`？或者是其他东西？

如果我使用可视化管理工具，它会显示：

![在此处输入图像描述](../Images/fd277dd1a6b469753aecdcd332a894b1.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:28:09.743

您将`:name`选项传递给，`add_index`因此索引的名称就是您设置的名称。在这种情况下，`index_key_performance_inds_on_organization_id`因此将其删除：

`remove_index 'key_performance_indicators', :name => 'index_key_performance_inds_on_organization_id'`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:44:56.587

Tomdarkness has provided the right answer but you might want to omit the `:name` part altogether unless there is a need to conform to a specific database schema. `add_index` will choose a sensible index name by default for you and `remove_index` will use that same default.

For example:

```
add_index :key_performance_indicators, :organization_id 
```

The above line will add the index with the name `index_key_performance_indicators_on_organization_id` and the following will remove it:

```
remove_index :key_performance_indicators, :organization_id 
```

# c++ - 在 floor/ceil 之后按位比较浮点数/双精度数

> ID：14862406
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:23:11.847
> 
> 标签：c++, floating-point, rounding

问题非常简单：考虑两个浮点数，它们可能按位不相等，但在所有可能的意义上差异都相对较小。我们还假设他们的楼层之间的差异小于一些相对较小的 epsilon（0.01 应该足够了）。他们的楼层是否按位相等（即在运算符== 方面相等）？

例如，下面的代码是否会`true`一直返回：

```
bool areRoundedFloatsEqual(float lhs, float rhs) {
    if (lhs > 0 && rhs > 0 && fabs(lhs - rhs) < 0.01) {
        lhs = std::floor(lhs);
        rhs = std::floor(rhs);

        if (fabs(lhs - rhs) < 0.5)
            return lhs == rhs;
    }

    return true;
} 
```

事实上，我对两个问题感兴趣：

1.  现实生活中会发生什么？
2.  标准对此有何评论？

**UPD** 我用描述替换了不正确的示例。（感谢@MarcGlisse 和
@KevinBallard 指出错误。）

**UPD 2** 这是很好地涵盖了这个问题的主题：[Floor() and ceil() Representable result of floor() and ceil()](https://stackoverflow.com/questions/12592249/representable-result-of-floor-and-ceil)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:09:22.710

`fabs(floor(a) - floor(b)) < 0.0001`仅当`floor(a) == floor(b)`，只要您处于双精度可以准确表示的整数范围内：[在 std::floor 之后转换为 int 是否保证正确的结果？](https://stackoverflow.com/questions/605533/does-casting-to-an-int-after-stdfloor-guarantee-the-right-result)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-21T12:23:04.063

floor (x) 和 ceil (x) 始终是整数值。

两个数字 floor 或 ceil (x) 与 floor 或 ceil (y) 之间的任何差异是两个整数值之间的差异，因此是一个整数。

当且仅当两个值相同时，这种差异的绝对值小于 1。

# firefox - js-ctypes：从 Windows DLL 加载 nsISupports

> ID：14862407
> 
> 赞同：1
> 
> 时间：2013-02-13T20:23:13.657
> 
> 标签：firefox, xpcom, jsctypes

是否可以使用[js-ctypes](https://developer.mozilla.org/en-US/docs/Mozilla/js-ctypes)调用 Windows DLL 并让它返回一个 nsISupports 实例？Windows DLL 执行 XPCOMGlue，但不需要 NSModule，我希望我可以改进注册过程。我希望定义了一个 ctypes.nsISupports 类型用作返回值，所以如果可能的话，我该如何声明调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-29T05:35:01.877

From my reading and experimentation, no, it doesn't look like you can. However, you could do the next best thing.

**1.** Create a win32 DLL exporting plain "C" symbols.

**2.** Create a "wrapper" XPCom component using JavaScript.

[http://kb.mozillazine.org/Implementing_XPCOM_components_in_JavaScript](http://kb.mozillazine.org/Implementing_XPCOM_components_in_JavaScript)

**3.** Plumb each plain "C" function exported by the DLL into the JavaScript object.

Possible improvement: create a generic JavaScript shim that does the plumbing automatically.

# regex - 使用 Perl 从文本文件中提取文本

> ID：14862408
> 
> 赞同：2
> 
> 时间：2013-02-13T20:23:14.843
> 
> 标签：regex, perl, text, extract

我有一个关于使用正则表达式从文本文件中提取数据的问题。我有以下格式的文本文件：

```
REPORTING-OWNER:    

    OWNER DATA: 
        COMPANY CONFORMED NAME:         DOE JOHN
        CENTRAL INDEX KEY:          99999999999

    FILING VALUES:
        FORM TYPE:      4
        SEC ACT:        1934 Act
        SEC FILE NUMBER:    811-00248
        FILM NUMBER:        11530052

    MAIL ADDRESS:   
        STREET 1:       7 ST PAUL STREET
        STREET 2:       STE 1140
        CITY:           BALTIMORE
        STATE:          MD
        ZIP:            21202

ISSUER:     

    COMPANY DATA:   
        COMPANY CONFORMED NAME:         ACME INC
        CENTRAL INDEX KEY:          0000002230
        IRS NUMBER:             134912740
        STATE OF INCORPORATION:         MD
        FISCAL YEAR END:            1231

    BUSINESS ADDRESS:   
        STREET 1:       SEVEN ST PAUL ST STE 1140
        CITY:           BALTIMORE
        STATE:          MD
        ZIP:            21202
        BUSINESS PHONE:     4107525900

    MAIL ADDRESS:   
        STREET 1:       7 ST PAUL STREET SUITE 1140
        CITY:           BALTIMORE
        STATE:          MD
        ZIP:            21202 
```

我想将所有者姓名 (John Doe) 和标识符 (99999999999) 以及公司名称 (ACME Inc) 和标识符 (0000002230) 保存为单独的变量。但是，如您所见，两条信息的变量名称（CENTRAL INDEX KEY 和 COMPANY CONFORMED NAME）完全相同。

我使用以下代码提取所有者的信息，但我不知道如何为公司提取数据。（注意：我将整个文本文件读入 $data）。

```
if($data=~m/^\s*CENTRAL\s*INDEX\s*KEY:\s*(\d*)/m){$cik=$1;}
if($data=~m/^\s*COMPANY\s*CONFORMED\s*NAME:\s*(.*$)/m){$name=$1;} 
```

关于如何为所有者和公司提取信息的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:51:02.007

使用正则表达式（维护噩梦）快速而肮脏地完成它，或者*正确*地完成它之间有很大的区别。

碰巧的是，您提供的文件看起来非常像[YAML](https://metacpan.org/module/YAML)。

```
use YAML;
my $data = Load(...);
say $data->{"REPORTING-OWNER"}->{"OWNER DATA"}->{"COMPANY CONFORMED NAME"};
say $data->{"ISSUER"}->{"COMPANY DATA"}->{"COMPANY CONFORMED NAME"}; 
```

印刷：

```
DOE JOHN
ACME INC 
```

这不是很酷吗？只需几行安全且可维护的代码 ☺</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:33:07.247

与其尝试匹配字符串中的元素，不如将其拆分为行，并正确解析为可以轻松进行此类搜索的数据结构，例如：

```
$data->{"REPORTING-OWNER"}->{"OWNER DATA"}->{"COMPANY CONFORMED NAME"} 
```

这应该相对容易做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:33:25.733

同时选择这两个信息位，以便您知道您正在获取与所有者或公司相关联的 CENTRAL INDEX KEY。

```
($name, $cik) = $data =~ /COMPANY\s+CONFORMED\s+NAME:\s+(.+)$\s+CENTRAL\s+INDEX\s+KEY:\s+(.*)$/m; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T20:29:51.683

```
my ($ownname, $ownkey, $comname, $comkey) = $data =~ /\bOWNER DATA:\s+COMPANY CONFORMED NAME:\s+([^\n]+)\s*CENTRAL INDEX KEY:\s+(\d+).*\bCOMPANY DATA:\s+COMPANY CONFORMED NAME:\s+([^\n]+)\s*CENTRAL INDEX KEY:\s+(\d+)/ms 
```

如果您在 UNIX 操作系统上读取此文件，但它是在 Windows 上生成的，则行尾将由字符对指示，`\r\n`而不是仅`\n`，在这种情况下，您应该这样做

```
$data =~ tr/\r//d; 
```

首先要摆脱这些`\r`字符并阻止它们进入`$ownname`and `$comname`。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-13T20:30:50.703

搜索`OWNER DATA:`多读一行，拆分`:`并取最后一个字段。标题相同`COMPANY DATA:`（排序），依此类推

# svg - 在 SVG 文件中渲染 MathJax

> ID：14862410
> 
> 赞同：4
> 
> 时间：2013-02-13T20:23:17.073
> 
> 标签：svg, mathjax

我花了几天的时间在下面没有快乐。

我希望在 SVG 文件中渲染 Mathjax。[我使用https://groups.google.com/forum/#!topic/mathjax-users/_UMt3C7TIpQ/discussion](https://groups.google.com/forum/#!topic/mathjax-users/_UMt3C7TIpQ/discussion)示例中的 foreignObject 将其包含在 svg 元素的 html 文件中没有问题，但我无法得到它在 svg 文件中工作。

我正在尝试的代码如下：-

```
<svg width="1960" height="1080" xmlns="http://www.w3.org/2000/svg">
<script type="text/javascript" src="MathJax-master/MathJax.js?config=TeX-AMS_HTML-SVG"></script>
<g>
<title>Layer 1</title>
<text xml:space="preserve" text-anchor="middle" font-family="serif" font-size="50" id="svg_1" y="223" x="636" stroke-opacity="0.8" stroke-width="0" stroke="#007FFF" fill="#000000">Hello World</text>
<foreignObject x="100" y="100" width="100" height="100">
   <body xmlns="http://www.w3.org/2000/svg">
     <div>
       \(\displaystyle{x+1\over y-1}\)
     </div>
   </body>
 </foreignObject>
</g>
</svg> 
```

任何帮助将非常感激。我确实怀疑问题出在声明 body 元素的行上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:09:31.713

标签是 html ，`<div>`所以`<body>`标签应该在 html 命名空间 `xmlns="http://www.w3.org/1999/xhtml"`而不是 svg 命名空间中。

您的另一个错误是您使用 html 语法作为 script 标签。SVG 脚本标签使用 xlink:href 而不是 src 属性。修复它让我们在这里：

```
<svg width="1960" height="1080" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<script xlink:href="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<g>
<title>Layer 1</title>
<text xml:space="preserve" text-anchor="middle" font-family="serif" font-size="50" id="svg_1" y="223" x="636" stroke-opacity="0.8" stroke-width="0" 

stroke="#007FFF" fill="#000000">Hello World</text>
<foreignObject x="100" y="100" width="100" height="100">
   <body xmlns="http://www.w3.org/1999/xhtml">
     <div>
       \(\displaystyle{x+1\over y-1}\)
     </div>
   </body>
 </foreignObject>
</g>
</svg> 
```

但是当我们这样做时，我们会在 mathjax 库中遇到一个错误。它似乎希望在文档中找到 html 节点（检查 Firefox 错误控制台）。您必须联系 mathjax 开发人员并让他们修复他们的错误以进一步发展。

# node.js - 在 MongoDB 字段中获取具有最小值或最大值的文档

> ID：14862412
> 
> 赞同：1
> 
> 时间：2013-02-13T20:23:28.537
> 
> 标签：node.js, mongodb, node-mongodb-native

如何在 MongoDB 中的某个字段中获取具有最小值或最大值的文档？

类似于 MySQL 中的 MIN() 或 MAX() 函数，但使用 NodeJS MongoDB 驱动程序。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:34:20.737

你可以尝试使用 asc, desc sort with limit(1)

```
db.col.insert({val: 9});
db.col.insert({val: 4});
db.col.insert({val: 20});
db.col.find();
{ "_id" : ObjectId("511bf79298bb011e3a33747d"), "val" : 9 }
{ "_id" : ObjectId("511bf79698bb011e3a33747e"), "val" : 4 }
{ "_id" : ObjectId("511bf79d98bb011e3a33747f"), "val" : 20 }
db.col.find().sort({val: 1}).limit(1); //min
{ "_id" : ObjectId("511bf79698bb011e3a33747e"), "val" : 4 }
db.col.find().sort({val: -1}).limit(1); //max
{ "_id" : ObjectId("511bf79d98bb011e3a33747f"), "val" : 20 } 
```

# c# - 使用 Access 数据库 VS 2012 设置项目

> ID：14862416
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:23:52.323
> 
> 标签：c#, ms-access, visual-studio-2012

我有带有 Access 数据库的 C# 桌面应用程序。我如何制作安装项目并以系统可以自动安装在任何计算机上的方式附加数据库。我正在使用 Visual Studio 2012

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:34:59.930

听起来您想将数据库添加到安装文件中，这样当您安装它时，数据库就在您身边？如果是这样，请创建一个部署安装项目。

有关详细信息，请参阅[http://msdn.microsoft.com/en-gb/library/2kt85ked(v=vs.80).aspx 。](http://msdn.microsoft.com/en-gb/library/2kt85ked(v=vs.80).aspx)使用 Windows 安装程序，您可以将文件添加到安装中，它们将安装到（由您）设置的位置。

# python - 当我指定用户时，lsof 命令不在指定目录中查找

> ID：14862417
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:24:02.330
> 
> 标签：python, bash, lsof

所以我正在编写一个 python 脚本，我的目标是使用 lsof 为本地用户列出特定目录（我的主文件夹）下的所有打开文件，并且只输出“uniq”条目。

我的脚本如下所示：

```
import os, sys, getpass
user = getpass.getuser()
cmd = "lsof -u " + user + " +d ~ | sort | uniq"
os.system(cmd) 
```

这种做我想要它做的事情，它为当前本地用户做 lsof，但它无法专门查看我指定的主目录。相反，它在根目录上执行 lsof 并为用户列出整个文件系统的所有 lsof。但是，当我在没有 的情况下执行相同的命令时，`-u user`它在主目录中看起来特别明显。我一直在研究为什么会这样，是的，我尝试过使用`+d /home/`and`+d ~/home/`而不是仅仅`+d ~`为了让它工作而没有成功，所以我有点难过。任何建议都会很棒:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:29:05.830

从[手册页](http://linux.die.net/man/8/lsof)：

> 通常，特别声明的列表选项是 ORed - 即，指定 -i 选项而不指定地址，而 -ufoo 选项会生成所有网络文件或属于用户“foo”拥有的进程的文件的列表。

有一些例外，但它们都不适用于您的情况。

所以，`-u me +d ~`意思是“我打开的所有文件或在我的主目录中。

那你怎么做你想做的事？

> -a 选项可用于 AND 选择。例如，指定 -a、-U 和 -ufoo 会生成仅属于用户 ''foo'' 拥有的进程的 UNIX 套接字文件的列表。

在那里扔一个`-a`：

```
cmd = "lsof -a -u " + user + " +d ~ | sort | uniq" 
```

顺便说一句，一般来说，你真的不想`os.system`在 Python 中使用，这就是[文档](http://docs.python.org/3/library/os.html#os.system)特别说明的原因：

> 该`subprocess`模块提供了更强大的工具来生成新进程并检索其结果；使用该模块优于使用此功能。有关一些有用的秘诀，请参阅文档中的[*用子流程模块替换旧功能*](http://docs.python.org/3/library/subprocess.html#subprocess-replacements)部分。`subprocess`

真的，为什么在 Python 中使用`sort`and`uniq`而不是排序？或者，或者，如果您只想让这个 shell 管道运行，而不是在 Python 中以任何方式处理它，为什么首先使用 Python 而不是 bash？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:29:24.507

lsof 默认使用 OR 将选项连接在一起，尝试将`-a`标志添加到 AND 它们一起。

# django - 运行 manage.py runserver 后保持 PowerShell 打开

> ID：14862418
> 
> 赞同：0
> 
> 时间：2013-02-13T20:24:08.260
> 
> 标签：django, powershell

我正在 Windows Vista Powershell 中使用 Python Django。在我运行 python manage.py runserver 后，它要求我按 CTRL-BREAK 来停止该进程。但是在我输入之后，Powershell 会停止该过程并关闭。有没有办法停止该过程并保持 Powershell 处于打开状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:52:47.893

尝试 CTRL-C ，在我的 powershell 中它工作正常。

# excel - 将单个单元格中的字符串分成几个单元格

> ID：14862424
> 
> 赞同：0
> 
> 时间：2013-02-13T20:24:20.257
> 
> 标签：excel, parsing, split, concatenation, vba

我有需要拆分为各个点的数据。我的宏将数据绘制成散点图，其中：A 列作为图表的标题，B 列作为 X 轴，C 和 D 列作为 Y 轴。我需要的是，当产品 ID 列出的数字超过 1 个时，将这些数字分成各自的行，并使从原始创建的每一行的 B、C 和 D 列保持相同。因此，对于第 167 行，我想要 3 行 (001,002,003)，每行都带有包装、200 和 100，分别在 B、C 和 D 中。我不知道从哪里开始。我试图构建一个宏，但是当我试图记录一个“查找”公式以在数据上运行时，我立即被绊倒了。任何帮助将不胜感激。

A 列：001、002、003 // B 列：包装 // C 列：200 // D 列：100

对不起，我不能发布我的数据截图，论坛不会让我。如果您有任何问题，请告诉我，我一定会经常检查。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:44:59.043

我写得非常快而且不太关心效率，但这应该可以解决问题：

```
 Sub SplitUpVals()

  Dim i As Long
  Dim ValsToCopy As Range
  Dim MaxRows As Long
  Dim ValToSplit() As String
  Dim CurrentVal As Variant

     MaxRows = Range("A1").End(xlDown).Row

     For i = 1 To 10000000

        ValToSplit = Split(Cells(i, 1).Value, ",")
        Set ValsToCopy = Range("B" & i & ":D" & i)

        For Each CurrentVal In ValToSplit

           CurrentVal = Trim(CurrentVal)
           Cells(i, 1).Value = CurrentVal
           Range("B" & i & ":D" & i).Value = ValsToCopy.Value

           Cells(i + 1, 1).EntireRow.Insert
           i = i + 1
           MaxRows = MaxRows + 1
        Next

        Cells(i, 1).EntireRow.Delete

     If i > MaxRows Then Exit For

     Next i

  End Sub 
```

请注意，请确保数据下方的单元格中没有数据，因为它可能会被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:42:15.443

您将需要解析 A 列中的数据。我会通过将字符串拆分为一个数组来做到这一点，然后遍历数组项以在必要时添加/插入其他行。

在没有看到您的工作表的情况下，我可能会从这样的事情开始，它将您的单元格值从 A 列拆分为一个数组，然后您可以遍历数组中的项目以根据需要操作工作表。

```
Sub TestSplit()
Dim myString as String
Dim myArray() as String
Dim cell as Range
Dim i as Long

For each cell in Range("A2",Range("A2").End(xlDown))
    myString = cell.Value 

    myArray = Split(myString, ",")  '<-- converts the comma-delimited string in to an array
    For i = lBound(myArray) to uBound(myArray)
        If i >= 1 Then
            'Add code to manipulate your worksheet, here
        End If
    Next
Next
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T14:30:19.213

这是一个更好的解决方案（现在我有更多时间:)）-希望这能解决问题！

```
 Sub SplitUpVals()

  Dim AllVals As Variant
  Dim ArrayIndex As Integer
  Dim RowLooper As Integer

   AllVals = Range("A1").CurrentRegion
   Range("A1").CurrentRegion.Clear

   RowLooper = 1

   For ArrayIndex = 1 To UBound(AllVals, 1)
      ValToSplit = Split(AllVals(ArrayIndex, 1), ",")

        For Each CurrentVal In ValToSplit

           CurrentVal = Trim(CurrentVal)
           Cells(RowLooper, 1).Value = CurrentVal
           Cells(RowLooper, 2).Value = AllVals(ArrayIndex, 2)
           Cells(RowLooper, 3).Value = AllVals(ArrayIndex, 3)
           Cells(RowLooper, 4).Value = AllVals(ArrayIndex, 4)

           RowLooper = RowLooper + 1
         Next

   Next ArrayIndex

  End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T15:39:32.070

```
Sub DivideData() 
```

'这会将组合到同一行的任何代码拆分为具有自己单独数据的单独行

```
Dim a, b, txt As String, e, s, x As Long, n As Long, i As Long, ii As Long
With Range("a1").CurrentRegion
    a = .Value
    txt = Join$(Application.Transpose(.Columns(1).Value))
    x = Len(txt) - Len(Replace(txt, ",", "")) + .Rows.Count
    ReDim b(1 To x * 2, 1 To UBound(a, 2))
    For i = 1 To UBound(a, 1)
        For Each e In Split(a(i, 1), ",")
            If e <> "" Then
                For Each s In Split(e, "-")
                    n = n + 1
                    For ii = 1 To UBound(a, 2)
                        b(n, ii) = a(i, ii)
                    Next
                    b(n, 1) = s
                Next
            End If
        Next
    Next
    With .Resize(n)
        .Columns(1).NumberFormat = "@"
        .Value = b
    End With
End With 
```

结束子

# java - JEdi torPane 中的可点击 HTML 链接

> ID：14862425
> 
> 赞同：2
> 
> 时间：2013-02-13T20:24:23.330
> 
> 标签：java, html, swing, jeditorpane

我想让 JEditorPane 中的所有链接都可以点击。我尝试使用此[答案](https://stackoverflow.com/a/3693604/1946459)中的代码，但可能我做错了什么，因为单击链接时没有任何反应。这是我的代码：

```
JEditorPane news = new JEditorPane();
news.setSize(Size.L_NEWS);
news.setLocation(Position.L_NEWS);
news.setFocusable(false);
news.setBackground(new Color(255, 255, 255, 0));
news.setEditable(false);
news.setEnabled(false);
news.setOpaque(false);
news.setVisible(true);
news.setEditorKit(JEditorPane.createEditorKitForContentType("text/html"));
news.setText(getNewsHTML.getNewestNews());
try{
    UIManager.setLookAndFeel(
    UIManager.getSystemLookAndFeelClassName());
}
catch(Exception e){
    e.printStackTrace();
}
news.addHyperlinkListener(new HyperlinkListener() {
    public void hyperlinkUpdate(HyperlinkEvent e) {
        if(e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
            if(Desktop.isDesktopSupported()) {
                try {
                    Desktop.getDesktop().browse(e.getURL().toURI());
                }
                catch (IOException | URISyntaxException e1) {
                    e1.printStackTrace();
                }
            }
        }
    }
}
);
login_form.add(news); 
```

在这里 - 我的进口（也许他们是问题）：

```
import java.awt.Color;
import java.awt.Desktop;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionAdapter;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.URI;
import java.net.URISyntaxException;

import javax.imageio.ImageIO;
import javax.swing.BorderFactory;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JEditorPane;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPasswordField;
import javax.swing.JTextField;
import javax.swing.UIManager;
import javax.swing.border.Border;
import javax.swing.event.HyperlinkEvent;
import javax.swing.event.HyperlinkListener; 
```

怎么了？我没有任何输出到 Eclipse 的控制台。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T20:36:31.430

从我的评论：

[在这里](https://stackoverflow.com/a/14170141/1133011)查看我的简单示例：

![http://i.stack.imgur.com/SglJF.png](../Images/3a741c3027aa57bd02a4ce36edf3a32d.png)

你的问题出在这里：

```
news.setEnabled(false); 
```

不要将其设置为禁用，否则它将无法捕获鼠标单击等事件。

也不知道为什么你有：

```
news.setFocusable(false);
news.setVisible(true); 
```

该组件不需要设置为可见，只需添加到容器并使容器可见。也不要让它无法聚焦，因为这可能会在以后引起问题。你`setEditable(false)`应该足够了（因为用户将无法编辑它而不管焦点）

# command-line-arguments - 命令行参数和 argc

> ID：14862427
> 
> 赞同：0
> 
> 时间：2013-02-13T20:24:26.760
> 
> 标签：command-line-arguments

我只是在查看使用命令行参数执行程序。我看到参数计数（argc）是隐含的，并且计算机通过查看我给出的参数数量来计算它。

我只是出于好奇想知道是否有可能或我明确声明 argc 的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:26:51.640

不，argc 被传递到 main() 方法中。它在运行时提供。

# php - 如何修复 htaccess 中的 RewriteRule 以支持 url 的末尾没有斜线 (/)？

> ID：14862429
> 
> 赞同：1
> 
> 时间：2013-02-13T20:24:27.277
> 
> 标签：php, apache, .htaccess, mod-rewrite, friendly-url

我想重写以下 URL：

```
http://www.mywebsite.com/helloworld/ 
```

至

```
http://www.mywebsite.com/index.php?page=hellworld 
```

以下规则适用于完成这项工作：

```
RewriteRule ^(.*)/$ index.php?page=$1 
```

但是，我有一个问题：

当我去：（`http://www.mywebsite.com/helloworld`看看末尾的斜杠（/）不存在）该规则不起作用。但是使用`http://www.mywebsite.com/helloworld/`效果很好。

¿ 我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:27:41.963

添加一个`?`

```
RewriteRule ^(.*)/?$ index.php?page=$1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:34:57.640

为了一致性起见，强制使用斜线可能会更好：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)/$ index.php?page=$1
RewriteRule ^(.*)([^/])$ http://%{HTTP_HOST}/$1$2/ [L,R=301] 
```

`!-f`基本上，如果URL 不是文件（斜杠，我认为，它会再次重复规则并去你想要的地方。

# java - JRadioButtons 不工作

> ID：14862432
> 
> 赞同：2
> 
> 时间：2013-02-13T20:24:35.030
> 
> 标签：java, swing, user-interface, jradiobutton

我遇到了一个问题，在*鼠标悬停*`JRadioButtons`之前我不会出现。我以前查过这个问题，似乎大多数人都使用. 但是，我不应该将它们用于我的作业，因为我对 Java 图形完全陌生，*我**真的*很挣扎。有任何想法吗？任何事情都值得赞赏。*`layouts`*

 ***```
import java.awt.GridLayout;

import javax.swing.*;
public class InsuarancePolicyApp {

public static void main(String[] args) {

//JFrame
JFrame f = new JFrame();
f.setVisible(true);
f.setSize(800, 600);
f.setLayout(null);
f.setResizable(false);
f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
f.setTitle("Insurance Policy Application");

//JButtons
JButton addClient = new JButton("Add Client");
JButton openPolicy = new JButton("Open Policy");
f.getContentPane().add(addClient);
f.getContentPane().add(openPolicy);
openPolicy.setSize(300, 60);
addClient.setSize(380,60);
addClient.setLocation(30, 180);
openPolicy.setLocation(450, 180);

//JTextField
JTextField name = new JTextField("Name: ");
f.getContentPane().add(name);
name.setLocation(30,30);
name.setSize(380, 30);

//JList
String[] clientarray = {"Mark Mywords", "Jim Class", "Stan Dupp", "Mel Onhead", "Bob's Yoyo Shop", "Toys Aren't Us", "The Fish Rack"};
JList clients = new JList(clientarray);
f.getContentPane().add(clients);
clients.setLocation(30, 280);
clients.setSize(380, 250);

String[] policyarray = {"Policy 002354","Policy 005345", "Depreciable Policy 0789423", "Expirable Policy 009724"};
JList policies = new JList(policyarray);
f.getContentPane().add(policies);
policies.setLocation(450, 280);
policies.setSize(300, 250);

//JScrollPane
JScrollPane clientScroll = new JScrollPane(clients, ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS, ScrollPaneConstants.HORIZONTAL_SCROLLBAR_AS_NEEDED);
f.getContentPane().add(clientScroll);
clientScroll.setLocation(30,280); 
clientScroll.setSize(380,250);

JScrollPane policiesScroll = new JScrollPane(policies, ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS, ScrollPaneConstants.HORIZONTAL_SCROLLBAR_AS_NEEDED);
f.getContentPane().add(policiesScroll);
policiesScroll.setLocation(450,280); 
policiesScroll.setSize(300,250);

//JradioButons 
JRadioButton b1 = new JRadioButton("Company",false);
JRadioButton b2 = new JRadioButton("Individual",false);
JRadioButton b3 = new JRadioButton("Standard",false);
JRadioButton b4 = new JRadioButton("Depreciable",false);
JRadioButton b5 = new JRadioButton("Expirable",false);

//ButtonGroups
ButtonGroup clientsGroup = new ButtonGroup();
b1.setLocation(120, 70);
b1.setSize(100,30);
b2.setLocation(260, 70);
b2.setSize(100,30);
f.getContentPane().add(b2);
f.getContentPane().add(b1);
clientsGroup.add(b1);
clientsGroup.add(b2);

ButtonGroup policiesGroup = new ButtonGroup();
b3.setLocation(600, 10);
b4.setLocation(600, 60);
b5.setLocation(600, 110);
b3.setSize(100,60);
b4.setSize(100,60);
b5.setSize(100,60);
f.getContentPane().add(b3);
f.getContentPane().add(b4);
f.getContentPane().add(b5);
policiesGroup.add(b3);
policiesGroup.add(b4);
policiesGroup.add(b5);

//Jlabel
JLabel label = new JLabel("Type:");
f.getContentPane().add(label);
label.setLocation(30, 55);
label.setSize(60,60);

JLabel label2 = new JLabel("Type:");
f.getContentPane().add(label2);
label2.setLocation(545, 10);
label2.setSize(60,60);
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:30:06.957

问题是`JRadioButtons`它们没有被绘制，因为`JFrame`它们在添加时已经显示。

将所有组件添加到容器`JFrame#setVisible` *后*，您需要调用：

```
f.setVisible(true); 
```

*另外：*不要使用绝对定位（`null`布局），而是使用[布局管理器](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)。使用布局管理器无需设置组件大小和位置。***

# sql - 将文本从 CSV 转换为 SQL 图像数据

> ID：14862435
> 
> 赞同：0
> 
> 时间：2013-02-13T20:24:49.910
> 
> 标签：sql, ssis, type-conversion

我有一个数据从 SQL 图像数据类型提取到 CSV，然后通过 SFTP 传输给我们，我需要将其恢复为图像数据类型。当我尝试通过 SSIS 进行转换时，我收到一条缓冲区溢出消息。是否可以获取文本数据流并将其转换为 SQL Image 数据类型？

# javascript - 链接特定数量的像素

> ID：14862438
> 
> 赞同：0
> 
> 时间：2013-02-13T20:25:01.427
> 
> 标签：javascript, html, pixels

我想知道是否有任何方法可以制作一些 html 元素，如 div、图像映射或任何其他可链接元素，以仅填充特定数量的像素。

例子。如果我在文档中单击，我将获得单击的坐标（可能是 100x100），而不是如果我希望在该区域周围的某处填充和链接 23 个像素。可能吗？

# javascript - 使用 SoundCloud Getter

> ID：14862440
> 
> 赞同：0
> 
> 时间：2013-02-13T20:25:22.280
> 
> 标签：javascript, soundcloud, getter

我在使用 SoundCloud getter getCurrentSound(callback) 时遇到问题。我正在尝试将当前在小部件中的歌曲存储为 var，以便我可以将其作为参数传递给我的 ruby​​ 方法之一。

我尝试了以下方法，但它不起作用：

```
 var current song =  SC.Widget("sc-widget").getCurrentSound() 
```

以下是有关 SoundCloud 使用的 getter 的信息：http: [//developers.soundcloud.com/docs/api/html5-widget](http://developers.soundcloud.com/docs/api/html5-widget)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:49:56.223

抱歉，如果文档没有说明这一点。该`getCurrentSound()`方法是异步的，因此它不返回值，而是接受回调。试试这个：

```
var widget = SC.Widget(...);
widget.getCurrentSound(function(sound) {
    console.log(sound.title);
}); 
```

希望有帮助。如果还不清楚，请告诉我。

# c++ - 不使用“this”处理当前窗口？

> ID：14862441
> 
> 赞同：2
> 
> 时间：2013-02-13T20:25:25.103
> 
> 标签：c++, mfc, this

在我的 MFC 应用程序中，我有一个需要访问窗口句柄的非 Dlg 成员函数，但由于它不是成员函数，我不能使用“this”指针。

具体来说，这就是我的意思：

```
void BlahDlg::OnBnClickedblah()
{
    //whatever
    //...

    CClientDC dc(this);

    //...
    //whatever
} 
```

^ 效果很好。但我使用的是非成员函数：

```
void nonMember()
{
    //whatever
    //...

    CClientDC dc(this); //will not work!

    //...
    //whatever
} 
```

***所以我的问题是：**我可以在后一段代码中用什么替换“this”，使其具有与前者相同的效果。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:56:08.697

只需要传递`this`给一个非成员函数，这样的非成员函数应该有一个对应的参数。例如：

```
void nonMember(BlahDlg* dlg) {
  ...
  CClientDC dc(dlg);
  ...
} 
```

# node.js - 在 Node.js 中使用特定于环境的配置文件

> ID：14862443
> 
> 赞同：0
> 
> 时间：2013-02-13T20:25:28.957
> 
> 标签：node.js

与 Rails 不同，在 Node.js 中加载特定于环境的配置文件似乎没有被接受的方式。

目前我正在使用以下内容：

`config/development.js`和`config/production.js`：

```
module.exports = {
    'db': 'mongodb://127.0.0.1/example_dev',
    'port': 3002
}; 
```

`app.js`接下来是我文件顶部的以下内容：

`var config = require('./config/' + process.env.NODE_ENV + '.js');`

这种模式效果很好，但是它迫使我将此配置文件传递给任何需要它的模块。这有点笨拙，例如：

`var routes = require('./routes')(config);`

.. 并在`routes/index.js`：

```
modules.export = function(config) {
    this.index = function...
    this.show = function...
}; 
```

等等等等。在处理应该是全局的东西时，模块模式似乎很笨拙，比如配置设置。我也可以在需要它的每个文件的顶部都需要配置文件，但这似乎也不理想。

有没有人有包含配置文件并使其全球可用的最佳实践？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:13:19.280

您可以将其附加到全局进程对象：

**应用程序.js：**

```
var config = require('./config/' + process.env.NODE_ENV + '.js');
process.config = config; 
```

**您应用中的其他任何地方**

```
console.log(process.config); 
```

是的，这有点危险，因为它可以在任何地方被覆盖，但它仍然是一种非常简单的方法。

# c# - 将基于 TSQL 的函数与基于实体框架的函数转换

> ID：14862445
> 
> 赞同：1
> 
> 时间：2013-02-13T20:25:50.550
> 
> 标签：c#, linq, entity-framework

我有两个函数，每个函数都返回相同的对象列表。但是，使用 TSQL 的比使用实体框架的要快得多，我不明白为什么一个会比另一个快。是否可以修改我的 EF 函数以与 TSQL 一样快？

任何帮助将不胜感激。我的代码如下：

TSQL：

```
 public static List<ChartHist> ListHistory_PureSQL()
    {
        List<DataRow> listDataRow = null;
        string srtQry = @"Select LoginHistoryID, 
                                   LoginDuration as LoginDuration_Pass, 
                                   0 as LoginDuration_Fail, 
                                   LoginDateTime, 
                                   LoginLocationID, 
                                   LoginUserEmailID, 
                                   LoginApplicationID, 
                                   LoginEnvironmentID, 
                                   ScriptFrequency, 
                                   LoginStatus, 
                                   Reason
                            From LoginHistory
                            Where LoginStatus = 'Pass'
                            UNION
                            Select LoginHistoryID, 
                                   0 as LoginDuration_Pass, 
                                   LoginDuration as LoginDuration_Fail, 
                                   LoginDateTime, 
                                   LoginLocationID, 
                                   LoginUserEmailID, 
                                   LoginApplicationID, 
                                   LoginEnvironmentID, 
                                   ScriptFrequency, 
                                   LoginStatus, 
                                   Reason
                            From LoginHistory
                            Where LoginStatus = 'Fail'";

        using (SqlConnection conn = new SqlConnection(Settings.ConnectionString))
        {
            using (SqlCommand objCommand = new SqlCommand(srtQry, conn))
            {
                objCommand.CommandType = CommandType.Text;
                DataTable dt = new DataTable();
                SqlDataAdapter adp = new SqlDataAdapter(objCommand);
                conn.Open();
                adp.Fill(dt);
                if (dt != null)
                {
                    listDataRow = dt.AsEnumerable().ToList();
                }
            }
        }

        var listChartHist = (from p in listDataRow
                        select new ChartHist
                        {
                            LoginHistoryID = p.Field<Int32>("LoginHistoryID"),
                            LoginDuration_Pass = p.Field<Int32>("LoginDuration_Pass"),
                            LoginDuration_Fail = p.Field<Int32>("LoginDuration_Fail"),
                            LoginDateTime = p.Field<DateTime>("LoginDateTime"),
                            LoginLocationID = p.Field<Int32>("LoginLocationID"),
                            LoginUserEmailID = p.Field<Int32>("LoginUserEmailID"),
                            LoginApplicationID = p.Field<Int32>("LoginApplicationID"),
                            LoginEnvironmentID = p.Field<Int32>("LoginEnvironmentID"),
                            ScriptFrequency = p.Field<Int32>("ScriptFrequency"),
                            LoginStatus = p.Field<String>("LoginStatus"),
                            Reason = p.Field<String>("Reason")
                        }).ToList();

        return listChartHist;            
    } 
```

英法：

```
 public static List<ChartHist> ListHistory()
    {
        using (var db = new LatencyDBContext())
        {
            var loginHist = (from hist in db.LoginHistories
                             select new { LoginHistory = hist }).ToList();

            //PUT LOGIN HISTORY RECORDS INTO A LOCAL LIST
            var listHistory = new List<ChartHist>();
            foreach (var item in loginHist)
            {
                var localHistData = new ChartHist();

                localHistData.LoginHistoryID = item.LoginHistory.LoginHistoryID;

                //split up the duration for pass and fail values
                if (item.LoginHistory.LoginStatus.ToUpper() == "PASS")
                {
                    localHistData.LoginDuration_Pass = Convert.ToDouble(item.LoginHistory.LoginDuration);
                    localHistData.LoginDuration_Fail = 0;
                }
                else if (item.LoginHistory.LoginStatus.ToUpper() == "FAIL")
                {
                    localHistData.LoginDuration_Pass = 0;
                    localHistData.LoginDuration_Fail = Convert.ToDouble(item.LoginHistory.LoginDuration);
                }

                localHistData.LoginDateTime = item.LoginHistory.LoginDateTime;
                localHistData.LoginLocationID = item.LoginHistory.LoginLocationID;
                localHistData.LoginUserEmailID = item.LoginHistory.LoginUserEmailID;
                localHistData.LoginApplicationID = item.LoginHistory.LoginApplicationID;
                localHistData.LoginEnvironmentID = item.LoginHistory.LoginEnvironmentID;
                localHistData.LoginStatus = item.LoginHistory.LoginStatus;
                localHistData.Reason = item.LoginHistory.Reason;
                localHistData.ScriptFrequency = item.LoginHistory.ScriptFrequency;

                listHistory.Add(localHistData);
            }

            return listHistory;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:34:22.800

当然，执行 EF 将比普通的旧 SQL 查询花费更长的时间，而且您几乎无能为力（除了编写您可以编写的最优化的 LINQ 查询）。

原因很简单。运行直接 SQL 命令只会发回数据，没有任何麻烦，也不会大惊小怪，等待您进行数据操作以使其与您想要的任何数据结构完美匹配。运行另一方面，EF 意味着它不仅运行 SQL 命令，而且还为您将数据处理成您可以立即操作的对象。通过 ADO.NET 并将数据自动转换为对象的额外操作意味着这将比仅执行普通 SQL 查询花费更长的时间。

然而，在硬币的另一面，EF 确实提供了一种非常好的和简单的方法来调试和解决特定查询/函数可能遇到的任何问题（比如抛出的任何异常）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:08:25.160

我无法对此进行性能测试，但请在完全删除 EF 之前尝试此解决方案：

```
var loginHist = db.LoginHistories.Where(item => item.LoginStatus.ToUpper() == "PASS" || item.LoginStatus.ToUpper() == "FAIL")
                  .Select(item => new ChartHist()
                  {

                    LoginHistoryID = item.LoginHistoryID,
                    LoginDuration_Pass = item.LoginStatus.ToUpper() == "PASS" ? Convert.ToDouble(item.LoginDuration) : 0,
                    LoginDuration_Fail = item.LoginStatus.ToUpper() == "FAIL" ? Convert.ToDouble(item.LoginDuration) : 0,

                    LoginDateTime = item.LoginDateTime,
                    LoginLocationID = item.LoginLocationID,
                    LoginUserEmailID = item.LoginUserEmailID,
                    LoginApplicationID = item.LoginApplicationID,
                    LoginEnvironmentID = item.LoginEnvironmentID,
                    LoginStatus = item.LoginStatus,
                    Reason = item.Reason,
                    ScriptFrequency = item.ScriptFrequency,

                  });
return loginHist.ToList(); 
```

这是从选择中填充新对象的“正确”方法。它只会检索您关心的数据，并将其直接放入对象中，而不是将其转换为对象然后*再次*转换，从一个对象到另一个对象。

*注意：我更喜欢`from`/`select`表单的功能调用，但无论哪种方式都是正确的。*

# sql - 查找忽略日期部分的 2 个日期时间之间的时间差

> ID：14862446
> 
> 赞同：3
> 
> 时间：2013-02-13T20:25:52.340
> 
> 标签：sql, sql-server-2008

我只需要取两个 datetime 对象，减去它们以获得以小时为单位的时差。我不关心计算中的日期部分。如果你有 1/1/02 11:00:00 - 1/1/02 9:00:00 那么我会得到 2 作为结果。如果差值为 30 或更大，则舍入到 1。我使用的时间对象是当前时间和包含另一个日期时间对象的列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:42:27.180

在 SQL Server 2008 中，您可以使用以下`TIME`数据类型：

```
SELECT ABS(ROUND(DATEDIFF(MI,CONVERT(TIME,date1), CONVERT(TIME,date2))/60.0,0)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:40:44.067

如果时间方向很重要，请使用：

```
SELECT DATEDIFF(hour, <date1>, <date2>) % 24... 
```

或者，如果您只想要绝对时差：

```
SELECT ABS(DATEDIFF(hour, <date1>, <date2>) % 24)... 
```

# javascript - 防止仅使用子伪选择器的默认功能

> ID：14862449
> 
> 赞同：0
> 
> 时间：2013-02-13T20:26:08.987
> 
> 标签：javascript, jquery, jquery-selectors

每次用户单击链接（“.add-event”）时，我都使用 jQuery 动态添加元素。如果用户选择，此元素中还包括一个图标，用于删除整个元素。如果元素是页面上的最后一个元素，我想隐藏或禁用此删除图标。这是我到目前为止所尝试的：

```
$(document).on('click','.close_box2:only-child',function(){
    event.preventDefault();
}); 
```

和

```
if( $('.event').length===1) {
    $('.close_box2').hide()
} 
```

HTML：

```
<div class="event">
    <span class="close_box2"><i class="icon-remove"></i></span>
     <span class="add-event">Add Event</span>
</div> 
```

我究竟做错了什么！？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-16T16:45:38.267

**JSFiddle：http:** [//jsfiddle.net/TrueBlueAussie/KPY9r/6/](http://jsfiddle.net/TrueBlueAussie/KPY9r/6/)

您只想检查删除处理程序中的“最后一个”：

```
// initial hide of sole close button
$('.close_box2').hide();

// On add, clone the template and show all close buttons
$(document).on('click', '.add-event', function () {
    // Create a new event based on the template
    $('#events').append($('#template').html());
    // Show all close buttons (as we must now have > 1 event)
    $('.close_box2').show();
});

$(document).on('click', '.close_box2', function (e) {
    $(this).closest('.event').remove();
    // Is there only one left?
    if ($('.event').length === 1) {
        // Hide the close box on the last event
        $('.close_box2').hide()
    }
}); 
```

**笔记：**

*   我使用一个虚拟`<script>`元素来保存 HTML 模板。这比克隆页面上的元素要好得多，也比代码中的内联 HTML 字符串要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-16T13:44:05.660

以下在性能方面看起来更好：

```
$('.close_box2:only-child').on('click', function(event){
  event.preventDefault();
}); 
```

# android - Android：更改所有列表视图行中项目的可见性

> ID：14862455
> 
> 赞同：1
> 
> 时间：2013-02-13T20:26:25.383
> 
> 标签：android, android-listview, visibility, android-imageview

我的应用程序中有一个 ListView，在用户请求后，它可以通过在每个列表视图行的开头拖动图像视图来重新排列。我在一个小窗口中向用户展示列表视图，为了最大化空间，我将拖动视图的可见性设置为 GONE，并计划仅在用户选择需要编辑列表的菜单项时将其设置为可见项目。

这是行项目的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="?android:attr/activatedBackgroundIndicator"
android:orientation="horizontal" >

<ImageView
    android:id="@id/drag_handle"
    android:layout_width="32dp"
    android:layout_height="32dp"
    android:layout_margin="8dp"
    android:visibility="gone"
    android:src="@drawable/ic_drag_dots_holo_dark" />

<View
    android:layout_width="1dp"
    android:layout_height="match_parent"
    android:layout_marginBottom="16dp"
    android:layout_marginTop="16dp"
    android:background="?android:attr/dividerVertical" />

    <TextView
        android:id="@+id/drag_n_drop_title"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="8dp"
        android:paddingRight="8dp"
        android:maxLines="1"
        android:minHeight="24dp"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="?android:attr/textColorPrimary" />
</LinearLayout> 
```

这是菜单选择的代码：

```
 @Override
public boolean onContextItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.menu_edit_playlist:
        if (inEditMode) {
            //If we are already showing the drag view, hide it. 
            inEditMode = false;                             
            findViewById(R.id.drag_handle).setVisibility(View.GONE);
        }
        else {
            //If the drag view is hidden, make it visible. 
            inEditMode = true;
            findViewById(R.id.drag_handle).setVisibility(View.VISIBLE);
        }                       
        return true;
    default:
        return super.onContextItemSelected(item);
    }
} 
```

这段代码的问题在于，当我调用`setVisibility()`它时，它只会更改列表视图第一个项目上拖动视图的可见性，而所有其他行上的拖动视图仍然隐藏。

在这种情况下，我该怎么做才能使所有行上的所有 dragViews 可见？

**编辑** 这是我希望它在按下编辑后的样子的[图像](https://www.dropbox.com/s/9kurlq0m4o6wz2l/Screenshot_2013-02-14-06-21-47.png)[，](https://www.dropbox.com/s/64bucsxrgw8stks/Screenshot_2013-02-14-06-18-57.png)这是它现在的样子，上面的代码。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T12:40:51.597

> 这段代码的问题在于，当我调用 setVisibility() 时，它只会更改列表视图第一项上的拖动视图的可见性，而所有其他行上的拖动视图仍然隐藏。

这种行为是正常的，因为您尝试`View`使用 , 方法从一行更改 a 的可见性，该`findViewById()`方法将返回布局中具有该 ID的 a 的**第一次**出现。`View`第一次出现将位于列表的第一个可见行中（无论如何该`findViewById`方法将不起作用，因为您可能会看到`ListView`' 行中的视图都将具有相同的 ID）。

> 在这种情况下，我该怎么做才能使所有行上的所有 dragViews 可见？

正确的方法是让适配器`ListView`知道它当前处于哪个状态（*inEditMode*`getView` ），并在此基础上在方法中显示/隐藏拖动句柄。完成此操作后，您要做的`onContextItemSelected`就是更新`inEditMode`状态变量并调用`notifyDataSetChanged()`适配器上的方法。

# matlab - 字符提取 - 点与字符分开识别

> ID：14862456
> 
> 赞同：1
> 
> 时间：2013-02-13T20:26:25.900
> 
> 标签：matlab, image-processing

我正在为区域语言进行字符识别。在提取图像时，点被分别识别为字符。

```
%% Plot Bounding Box
for n=1:size(propied,1)
rectangle('Position',propied(n).BoundingBox,'EdgeColor','g','LineWidth',2)
end
hold off

%% Characters being Extracted
figure
 for n=1:Ne
 [r,c] = find(L==n);
 n1=imagen(min(r):max(r),min(c):max(c));
 imshow(~n1);
 end 
```

原代码： http: [//www.mathworks.com/matlabcentral/fileexchange/22922-image-segmentation-extraction](http://www.mathworks.com/matlabcentral/fileexchange/22922-image-segmentation-extraction)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T02:06:08.000

由于您正在进行字符/文本识别，因此您更有可能需要单词或文本行的集合，而不是单个字符。如果你真的想做后者，那么在你识别出单个单词之后它会更加健壮。

所以，这里最简单的方法是使用标准的形态开（假设文本是黑色的，否则使用闭）运算符。从一个大的水平结构元素（SE）开始。使用此 SE 应用开口会将您的图像分成几行文本。在每一行中，您使用较短的水平 SE 来获取单个单词。然后，对于每个单词，您都考虑使用垂直 SE 来打开它，这样它就可以连接重音和其他印刷细节。

例如，这里是一个输入图像，它的开口具有半径为 35 的水平 SE，开口具有半径为 7 的水平 SE，以及具有半径为 7 的垂直 SE 的开口。

![在此处输入图像描述](../Images/9b34058f62d6b8c36e86158c9a656965.png) ![在此处输入图像描述](../Images/bed73ee5d5a76402079071d83d76d8f5.png) ![在此处输入图像描述](../Images/4fea96a074b5e7704038753b26213fa8.png) ![在此处输入图像描述](../Images/e0220e3acd2940903c8b39e0e1567c4c.png)

我没有在孤立的组件中应用第三个操作，但你应该这样做，以免冒险加入两行文本。当然，这一切都是假设直线水平的文本行。在此最终图像上绘制边界框可得到您所追求的[结果](https://i.stack.imgur.com/4iTeh.png)：

![在此处输入图像描述](../Images/58dac1e7de24a7d08eac0425229fc787.png)

请注意，一些字母（“ty”和“ny”）在开头是连接的，因此它们在此输出中显示为单个字母。这是一个需要处理的单独问题，您可能关心也可能不关心。

# prestashop - prestashop 在属性下拉列表中显示缺货

> ID：14862457
> 
> 赞同：1
> 
> 时间：2013-02-13T20:26:29.220
> 
> 标签：prestashop

我目前面临一个我无法解决的问题，也许你可以帮助我。

我正在显示所有尺寸的下拉列表。现在我想在尺寸旁边显示产品缺货（缺货）时的下拉列表。

我找到了一个片段，它显示了哪些产品缺货：

```
 {foreach from=$combinations key=idCombination item=combination}
        {if $combination.quantity == 0}
            {assign var=attributes value=','|explode:$combination.list}
            {foreach from=$groups key=id_attribute_group item=group}
                {foreach from=$group.attributes key=id_attribute item=group_attribute}
                    {foreach from=$attributes item=attribute name=attribute}
                        {if $id_attribute == $attribute|substr:1:-1}
                            {$group_attribute} - {* if !$smarty.foreach.attribute.last}, {/if *}
                        {/if} 
                    {/foreach}
                {/foreach}
            {/foreach}                
        {/if}
    {/foreach}
{/strip}{/if} 
```

它有效，但我更想在下拉列表中显示它。我怎样才能得到这个？

update - 生成下拉列表的代码

```
<div id="attributes">
{foreach from=$groups key=id_attribute_group item=group}
{if $group.attributes|@count}
<fieldset class="attribute_fieldset">
<label class="attribute_label" for="group_{$id_attribute_group|intval}">{$group.name|escape:'htmlall':'UTF-8'} :</label>
{assign var="groupName" value="group_$id_attribute_group"}
<div class="attribute_list">

------   this is the select ----------------------
{if ($group.group_type == 'select')}
<select name="{$groupName}" id="group_{$id_attribute_group|intval}" class="attribute_selectt" onchange="findCombination();getProductAttribute();{if $colors|@count > 0}$('#wrapResetImages').show('slow');{/if};">
{foreach from=$group.attributes key=id_attribute item=group_attribute}
<option value="{$id_attribute|intval}"{if (isset($smarty.get.$groupName) && $smarty.get.$groupName|intval == $id_attribute) || $group.default == $id_attribute} selected="selected"{/if} title="{$group_attribute|escape:'htmlall':'UTF-8'}">{$group_attribute|escape:'htmlall':'UTF-8'}</option>
{/foreach}
</select>
 ------------ select endd ----------------

{elseif ($group.group_type == 'color')}
<ul id="color_to_pick_list" class="clearfix">
{assign var="default_colorpicker" value=""}
{foreach from=$group.attributes key=id_attribute item=group_attribute}
<li{if $group.default == $id_attribute} class="selected"{/if}>
<a id="color_{$id_attribute|intval}" class="color_pick{if ($group.default == $id_attribute)} selected{/if}" style="background: {$colors.$id_attribute.value} !important;" title="{$colors.$id_attribute.name}" onclick="colorPickerClick(this);getProductAttribute();{if $colors|@count > 0}$('#wrapResetImages').show('slow');{/if}">
{if file_exists($col_img_dir|cat:$id_attribute|cat:'.jpg')}
<img src="{$img_col_dir}{$id_attribute}.jpg" alt="{$colors.$id_attribute.name}" width="20" height="20" /><br>
{/if}
</a>
</li>
{if ($group.default == $id_attribute)}
{$default_colorpicker = $id_attribute}
{/if}
{/foreach}
</ul>
<input type="hidden" class="color_pick_hidden" name="{$groupName}" value="{$default_colorpicker}" />
{elseif ($group.group_type == 'radio')}
{foreach from=$group.attributes key=id_attribute item=group_attribute}
<input type="radio" class="attribute_radio" name="{$groupName}" value="{$id_attribute}" {if ($group.default == $id_attribute)} checked="checked"{/if} onclick="findCombination();getProductAttribute();{if $colors|@count > 0}$('#wrapResetImages').show('slow');{/if}">                                    {$group_attribute|escape:'htmlall':'UTF-8'}<br/>
{/foreach}
{/if}
</div>
</fieldset>
{/if}
{/foreach}
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-11T11:33:32.723

对于 PS 1.6.XI 认为最好**在 smarty 中获取库存数量**，例如：

在 product.tpl 中找到属性选项名称：

```
{$group_attribute|escape:'html':'UTF-8'} 
```

并替换为：

```
{$group_attribute|escape:'html':'UTF-8'}
   {if {$group.attributes_quantity[{$id_attribute|intval}]} < 1}
       - {l s='Out Stock'}
   {/if} 
```

当产品属性缺货时，您可以显示**属性名称 - 缺货而**无需修改 prestashop 核心。

当属性产品数量小于 X 时，您也可以显示另一个消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T14:05:03.517

这是通过编辑/覆盖产品控制器的一种方法。在 Prestashop 1.5.2 上测试

在控制器`ProductController`中，您将看到 function`assignAttributesGroups` 这处理可用于在您的视图上显示的组/属性。

```
// wash attributes list (if some attributes are unavailables and if allowed to wash it)
if (!Product::isAvailableWhenOutOfStock($this->product->out_of_stock) && Configuration::get('PS_DISP_UNAVAILABLE_ATTR') == 0)
{
    foreach ($groups as &$group)
        foreach ($group['attributes_quantity'] as $key => &$quantity)
            if (!$quantity)
                unset($group['attributes'][$key]);

    foreach ($colors as $key => $color)
        if (!$color['attributes_quantity'])
            unset($colors[$key]);
} 
```

您可以在此处看到，该属性已从可用组中删除。如果您希望它保留在列表中，请覆盖此功能并控制器重新创建此功能。

改变

```
if (!$quantity)
    unset($group['attributes'][$key]); 
```

至

```
if (!$quantity)
    $group['attributes'][$key] .= " Sold Out"; 
```

有关 PrestaShop 和覆盖的更多信息，请参阅[http://doc.prestashop.com/display/PS15/Overriding+default+behaviors](http://doc.prestashop.com/display/PS15/Overriding+default+behaviors)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-10T22:26:54.647

```
<select class="form-control attribute_select no-print" name="{$groupName}" id="group_{$id_attribute_group|intval}">
    {foreach from=$group.attributes key=id_attribute item=group_attribute}
        {if ($group.attributes_quantity[{$id_attribute|intval}] <= 0)}
            {$disabledvar = "disabled"}
            {$esgotado = "Esgotado"}
        {else}
            {$disabledvar = ""}
            {$esgotado = ""}
        {/if}    

        <option value="{$id_attribute|intval}"{if (isset($smarty.get.$groupName) && $smarty.get.$groupName|intval == $id_attribute) || $group.default == $id_attribute} selected="selected"{/if} title="{$group_attribute|escape:'html':'UTF-8'}" {$disabledvar}>{$group_attribute|escape:'html':'UTF-8'} {$esgotado}</option>
    {/foreach}
</select> 
```

[![在此处输入图像描述](../Images/a144485c39b344e53dca9a217a7effd1.png)](https://i.stack.imgur.com/SDNjc.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-07T09:36:59.457

**Prestashop 1.7.6.4**

通过修改 /themes/[YOUR_THEME]/templates/catalog/_partials/product-variants.tpl 文件可以很容易地完成。

```
{if $group.group_type == 'select'}
        <select
          id="group_{$id_attribute_group}"
          class="form-control form-control-select"
          data-product-attribute="{$id_attribute_group}"
          name="group[{$id_attribute_group}]">
          {foreach from=$group.attributes key=id_attribute item=group_attribute}

            {if {$group.attributes_quantity[{$id_attribute|intval}]} < 1}
              <option value="{$id_attribute}" title="{$group_attribute.name}"{if $group_attribute.selected} selected="selected"{/if}>{$group_attribute.name} - {l s='Sold Out' d='Shop.Theme.Catalog'}</option>
            {else}
            <option value="{$id_attribute}" title="{$group_attribute.name}"{if $group_attribute.selected} selected="selected"{/if}>{$group_attribute.name}</option>
            {/if}

          {/foreach}
        </select> 
```

您可以更改不可用变体旁边显示的文本以及翻译它。

此外，如果您不希望变体可点击，可以使用 HTML 将其更改为灰色：

```
{if {$group.attributes_quantity[{$id_attribute|intval}]} < 1}
          <option value="{$id_attribute}" title="{$group_attribute.name}"{if $group_attribute.selected} selected="selected"{/if} disabled>{$group_attribute.name} - {l s='Sold Out' d='Shop.Theme.Catalog'}</option>
        {else}
        <option value="{$id_attribute}" title="{$group_attribute.name}"{if $group_attribute.selected} selected="selected"{/if}>{$group_attribute.name}</option>
        {/if} 
```

# php - 验证当前 ssl 是否为服务器的 ssl

> ID：14862464
> 
> 赞同：0
> 
> 时间：2013-02-13T20:26:55.663
> 
> 标签：php, authentication, ssl, certificate

我一直在寻找一种方法来检查用户是否使用**PHP**中正确的（我的服务器的）SSL 证书连接到我的网站。我想我的问题与这个问题[相似](https://stackoverflow.com/questions/8425082/how-to-check-what-certificate-is-being-used-in-the-connection-with-php/8425144#8425144)，只是我不是在暗示 MITM。

我环顾四周，但没有找到从当前连接中使用的证书获取信息并将其与服务器证书进行比较的方法。这是为了防止用户连接其他证书。

怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:49:46.347

我不知道您所说的“防止用户与其他证书连接”是什么意思，这听起来不可能，但是：

1.  SSL 发生在协议栈中 PHP 无法访问或控制的层。
2.  [在运行网站的情况下] 客户连接的安全性超出了您的控制范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:57:57.230

## 简答

你没有。

## 更长的答案

这仅适用于客户端证书。
您的网络服务器向客户端识别您，而不是 PHP。PHP 永远不会看到这一点，并且除了`HTTPS=on`. 您不会向自己验证自己，因为它总是会评估为真。您链接到的问题已经有了答案，中间的人没有多大意义。您实际上是在使用明确的 PHP 脚本寻求解决任何和所有 SSL Man in the Middle 攻击的方法。

除非您的证书颁发机构发生 Diginotar 式的事情，否则无法使用另一个 SSL 证书连接到您的主机。

如果您想确保他们确实打算连接到您的站点，只需检查客户端连接到的主机即可。如果他们点击了您的 IP，并向其请求证书，然后与您的 CA 进行验证，他们将继续连接，并连接到`$_SERVER["SERVER_NAME"]`和`$_SERVER["HTTPS"] == "on"`

但是，老实说，您为什么担心 SSL 证书不正确？它将被用户的 PC 标记。我会更担心会话解密。

# r - 在 R 中创建特定类的对象

> ID：14862465
> 
> 赞同：1
> 
> 时间：2013-02-13T20:26:56.130
> 
> 标签：r

函数 lm(...) 返回类 'lm' 的对象。如何创建此类对象的数组？我想做以下事情：

```
my_lm_array <- rep(as.lm(NULL), 20)
#### next, populate this array by running lm() repeatedly:
for(i in 1:20) {
   my_lm_array[i] <- lm(my_data$results ~ my_data[i,])
} 
```

显然“my_lm <- rep(as.lm(NULL), 20)”这一行不起作用。我正在尝试创建一个“lm”类型的对象数组。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:33:53.953

不确定它会回答您的问题，但如果您想要做的是`lm`针对数据框的不同列运行一系列变量，您可以执行以下操作：

```
data <- data.frame(result=rnorm(10), v1=rnorm(10), v2=rnorm(10))
my_lms <- lapply(data[,c("v1","v2")], function(v) {
  lm(data$result ~ v)
}) 
```

然后，`my_lms` 将是 class 的元素列表`lm`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:36:19.643

好吧，您*可以*创建一个空/无意义对象数组，`lm`如下所示：

```
z <- NA
class(z) <- "lm"
lm_array <- replicate(20,z,simplify=FALSE) 
```

但这可能不是解决问题的最佳方法。您可以只创建一个适当长度的空列表 ( `vector("list",20)`) 并在执行过程中填写元素：R 的类型足够弱，它不会介意您用对象替换`NULL`值。`lm`不过，更惯用的是，您可以`lapply`在预测变量名称列表上运行：

```
my_data <- data.frame(result=rnorm(10), v1=rnorm(10), v2=rnorm(10))
prednames <- setdiff(names(my_data),"result")  ## extract predictor names
lapply(prednames,
 function(n) lm(reformulate(n,response="result"),
                 data=my_data)) 
```

或者，如果您不想创建匿名函数，您可以先生成一个公式列表（使用`lapply`），然后`lm`在它们上运行：

```
formList <- lapply(prednames,reformulate,response="result") ## create formulae
lapply(formList,lm,data=my_data)  ## run lm() on each formula in turn 
```

将创建与`lm`上述第一个策略相同的对象列表。

一般来说，避免使用诸如`my_data$result`内部建模公式之类的语法是一种很好的做法；相反，尝试进行设置，以便模型中的所有变量都是从`data`对象内部绘制的。这样的方法喜欢`predict`并且`update`更有可能正确工作......

# jquery - 数据表，选择行并传回 ID 以进行删除

> ID：14862466
> 
> 赞同：4
> 
> 时间：2013-02-13T20:26:57.603
> 
> 标签：jquery, sql, jsp, datatables

第一次在这里发帖，但我真的需要帮助。在这个小项目上工作了一段时间，我发现 Datatables 几乎没用，但我被告知我必须使用它......无论如何，我已经得到它显示我们从 ajax 调用到我们的 SQL 服务器的表。它需要让用户选择几行并单击删除按钮。然后它应该从每个选定的行中获取 ID 并通过 ajax 调用将其传递回我们的服务器，然后服务器将删除该值。

我尝试了大约 5 种差异行选择方法，更多的删除尝试然后我可以数数，但没有任何工作。在过去的几周里，我多次在他们的支持网站上寻求帮助，但没有得到一个答复，所以希望这里的人们能够提供更多帮助:)

无论如何继承我的代码：[JSFIDDLE](http://jsfiddle.net/dSLnT/3/#toggle-sidebar) *UPDATED TO CURRENT*

```
$(document).ready(function(){
var oTable = $('#dataTable').dataTable({
    //"bServerSide": true,
    "bProcessing": true,
    "bJQueryUI": true,
    "bPaginate": true,
    "sPaginationType": "full_numbers",

    "iDisplayLength": 10,
    "aLengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
    "sDom": 'pT<><f>rt<il>',
    "sAjaxSource": 'dataTable/getCmsGroupData',

    "aoColumns": [
                    { "mData": "id", "sTitle": "ID", 
                        "fnRender": function (oObj) {
                            return '<a href="cmsgroup_update?id='+ oObj.aData["id"] + '">' + oObj.aData["id"] + '</a>';
                          }},
                    { "mData": "version", "sTitle":"Version" },
                    { "mData": "name", "sTitle": "Name" },
                    { "mData": "description", "sTitle": "Description"},
                    { "mData": "notes", "sTitle": "Notes"},
                 ],
    "oTableTools": {
        "aButtons": [
                    "select_all",
                    "select_none", 
                    {
                        "sExtends": "text",
                        "sButtonText": "Create New Entry",
                        "fnClick": function ( nButton, oConfig, oFlash ) {
                            window.location = "cmsgroup_add";
                       }
                    }]
                }               
            });

$("#dataTable tbody").click(function(event) {
    $(oTable.fnSettings().aoData).each(function (){
        $(this.nTr).removeClass('row_selected');
    });
    $(event.target.parentNode).addClass('row_selected');
});

function fnGetSelected( oTableLocal )
{
    var aReturn = new Array();
    var aTrs = oTableLocal.fnGetNodes();
    for ( var i=0 ; i<aTrs.length ; i++ )
    {

        if ( $(aTrs[i]).hasClass('row_selected') ) 
        {
            aReturn.push( aTrs[i] );
        }
    }
    return aReturn;
}

$("#delete").click(function(){

    selected = fnGetSelected(oTable);
    oTable.fnDeleteRow( selected[0]);
    $.ajax({
        type: "POST",
        url: "dataTable/delete/cmsGroup",  
        data:   'tableData='+ $(selected).text(),  
        success: function(result) {  
            alert("worked!");
        }  
    });
});
} ); 
```

任何帮助都会很棒！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T02:49:07.293

当您使用 fnDelete 时，您必须将要从数据表中删除的行传递给它。为此，您必须使用 oTableLocal.$("tr") 从数据表中获取行。

```
function fnGetSelected( oTableLocal )
{
    var aReturn = new Array();
    oTableLocal.$("tr").filter(".row_selected").each(function (index, row){
        aReturn.push(row);// this should work, if not try aReturn.push($(row));
       //to get the information in the first column 
       aReturn.push($(row).eq(0).text());
    return aReturn;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:34:12.427

您需要将 包装`aTrs[i]`在 a 中`$()`，这样`$(aTrs[i]).hasClass('row_selected')`才能访问 jQuery 方法。

您还应该使用处理程序，`.on`而不是因为数据表可以重新创建节点并已被弃用的方式。`click``live``live`

如果您返回来自 的响应示例`dataTable/getCmsGroupData`，我可以提供更多帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T19:04:54.080

修好了！:) 谢谢大家的帮助！！

```
$(document).ready(function () {
    var oTable = $('#dataTable').dataTable({
        //"bServerSide": true,
        "bProcessing": true,
        "bJQueryUI": true,
        "bPaginate": true,
        "sPaginationType": "full_numbers",

        "iDisplayLength": 10,
        "aLengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
        "sDom": 'pT<><f>rt<il>',
        "aAjaxSource": 'dataTable/getCmsAttributeData',

        "aoColumns": [{
            "mData": "id",
            "sTitle": "ID",
            "fnRender": function (oObj) {
                return '<a href="cmsattribute_update?id=' + oObj.aData["id"] + '">' + oObj.aData["id"] + '</a>';
            }
        },
        {
            "mData": "version:",
            "sTitle": "Version"
                },
        {
            "mData": "name:",
            "sTitle": "name"
                },
        {
            "mData": "description",
            "sTitle": "Description"
                },
        {
            "mData": "cmsgroupid",
            "sTitle": "CMS Group ID"
                },
        {
            "mData": "masterattributeid",
            "sTitle": "Master Attribute ID"
                },
        {
            "mData": "notes",
            "sTitle": "Notes"
                }],
        "oTableTools": {
            "aButtons": [{
                "sExtends": "text",
                "sButtonText": "Delete",
                "fnClick": function (nButton, oConfig, nRow) {
                    if (confirm('Are you sure want to delete this record?')) {
                        var list = $('tr.DTTT_selected > td.sorting_1 > a').map(function () {
                            return this.text;
                        }).get().join(",");
                        $.ajax({
                            type: "POST",
                            url: "dataTable/delete/cmsGroup",
                            data: 'tableData=' + list,
                            success: function (result) {
                                alert("Entry Deleted");
                                $('tr.DTTT_selected').remove();
                            }
                        });
                    }
                }
            },
     "select_all",
     "select_none",
            {
                "sExtends": "text",
                "sButtonText": "Create New Entry",
                "fnClick": function (nButton, oConfig, oFlash) {
                    window.location = "cmsgroup_add";
                }
     }]
        }
    });
}); 
```

# .net - Git Extensions 和 Git Source Control Provider 之间的主要区别是什么？

> ID：14862471
> 
> 赞同：2
> 
> 时间：2013-02-13T20:27:07.410
> 
> 标签：.net, visual-studio, git, version-control, github

[这个问题](https://stackoverflow.com/questions/507343/using-git-with-visual-studio)讨论了允许从 Visual Studio 使用 github 的解决方案。事实证明，有两个主要选择：

*   Git 扩展
*   Git 源代码控制提供程序

您能否总结一下它们之间的主要区别，以便我可以决定使用哪一个。

最初的问题是 4 年前提出并回答的。如果目前有新的可行选择，我也想听听它们。

# jquery-ui - 即使在 Ajax 加载之后也使列表可排序

> ID：14862472
> 
> 赞同：1
> 
> 时间：2013-02-13T20:27:16.443
> 
> 标签：jquery-ui, jquery

我正在加载这样的`li`列表

```
$('#knowledgeList').load('file.php#knowledgeList'); 
```

但是我还需要使列表可排序：

```
$('#knowledgeList').sortable(); 
```

如果我不通过 Ajax 加载项目，但如果它们通过 Ajax 加载，则它们不再可排序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:31:48.900

为了将任何 JavaScript/jQuery 应用到通过 AJAX 调用的组件，您需要在回调函数中操作的对象。

```
$('#knowledgeList').load('file.php #knowledgeList',function(){
      $('#knowageList').sortable();
}); 
```

# android - 广播接收器可以完全控制吗？

> ID：14862473
> 
> 赞同：0
> 
> 时间：2013-02-13T20:27:35.203
> 
> 标签：android

我有以下问题：

接收广播接收器时是否可以完全覆盖电话功能？例如，是否可以接收短信并且不让短信出现在通知区域中？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:51:59.323

有时。这取决于它是什么类型的广播。查看[文档`BroadcastReceiver`](http://developer.android.com/reference/android/content/BroadcastReceiver.html)：

> 可以接收到两大类广播：
> 
> *   普通广播（使用 Context.sendBroadcast 发送）是完全异步的。广播的所有接收器都以未定义的顺序运行，通常同时运行。这更有效，但意味着接收者不能使用结果或中止此处包含的 API。
> *   有序广播（使用 Context.sendOrderedBroadcast 发送）一次交付给一个接收器。当每个接收器依次执行时，它可以将结果传播给下一个接收器，或者它可以完全中止广播，这样它就不会被传递给其他接收器。运行的订单接收器可以通过匹配intent-filter的android:priority属性来控制；具有相同优先级的接收器将以任意顺序运行。

SMS 恰好是一个有序广播，所以这种情况下如果你调用，其他[优先级](http://developer.android.com/reference/android/R.styleable.html#AndroidManifestIntentFilter_priority)[`abortBroadcast`](http://developer.android.com/reference/android/content/BroadcastReceiver.html#abortBroadcast%28%29)较低的接收者将不会被调用。这仅在您的优先级最高时才有效，这实际上无法保证，但您可以通过设置非常高的优先级来完成合理的工作，也许[超过 9000](http://www.youtube.com/watch?v=SiMHTK15Pik)可能是合适的。尽管[文档](http://developer.android.com/reference/android/content/IntentFilter.html#SYSTEM_HIGH_PRIORITY)确实说不要使用 1000 或以上的任何东西，但这是为了确保系统始终能够处理广播。但是，在您的情况下，您确实确实希望阻止系统处理广播。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:33:27.343

是的，可以像下面的代码一样定义您的 BR。确保`abortBroadcast();`从接收器调用方法，这样它就不会允许进一步调用其他 BR 的 onReceives。

```
<receiver android:name=".SMSReceiver"
              android:exported="true"
              android:permission="android.permission.BROADCAST_SMS">
             <intent-filter android:priority="1000">
                 <action android:name="android.provider.Telephony.SMS_RECEIVED"/>
             </intent-filter>
 </receiver> 
```

允许

```
 <uses-permission android:name="android.permission.RECEIVE_SMS"></uses-permission> 
```

但它不能保证一直工作，因为可能有其他应用程序在做同样的事情并且可能已经中止广播，所以即使你的 onReceive 也可能不会触发。

# ruby-on-rails - 吉特。部署子目录，是真的吗？

> ID：14862479
> 
> 赞同：0
> 
> 时间：2013-02-13T20:28:04.993
> 
> 标签：ruby-on-rails, git, deployment, heroku, github

我有目录：Folder/，这是 github 上的存储库。在此目录中存在另一个目录：Folder/Site/。我需要将 Site/ 部署到 Heroku 或 VPS。我不想在文件夹/站点中创建新的存储库并将其包含到文件夹存储库（子模块）中。任何想法？这是真的吗？创建子模块的问题是它增加了 githab 上的存储库数量，并且存储库 Folder/ 是私有的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:34:14.830

您应该查看 Git 子树 ( [https://github.com/apenwarr/git-subtree](https://github.com/apenwarr/git-subtree) )。它会让你做这样的事情：

```
git subtree push --prefix Site origin master 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:24:51.323

一种方法是分叉您当前使用的 buildpack（我假设您在此处使用 Cedar 堆栈）并将其修改为在 git 树的子目录而不是其根目录上工作。请参阅 Heroku 开发中心的[Buildpack 文档](https://devcenter.heroku.com/articles/buildpacks)。

# reporting-services - SSRS 日期选择器在 Google Chrome 中不可见，在 Opera/IE 中不起作用？

> ID：14862481
> 
> 赞同：12
> 
> 时间：2013-02-13T20:28:25.573
> 
> 标签：reporting-services, cross-browser, ssrs-2008

我正在集成 SSRS 报告（在 VS 2008 vs. 9.0 中开发），当我使用 Chrome 将其加载到浏览器中时，我得到了这个：

![在此处输入图像描述](../Images/ff3b8366b574ee99a998d379d3279fa2.png)

没有日期图标！

在 Opera 中显示，但不起作用：

![在此处输入图像描述](../Images/799eba78a73f28fc0dfed752e0e4d07e.png)

我如何弄清楚如何 1.) 让它正常工作。2) 使其在 Chrome 中可见

我找到了一个谈论它的网站（[这里](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/a96537e3-0945-4046-816b-5eb0d8875dd3/)），但它只有一个死链接（[http://www.rajbandi.net/](http://www.rajbandi.net/)）

只是我还是这是一个需要解决的复杂问题？任何提示表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:46:48.040

也许这篇文章对你有帮助？ [http://www.codeproject.com/Articles/504567/Print-button-Date-picker-in-SSRS-Reports-for-Non-I](http://www.codeproject.com/Articles/504567/Print-button-Date-picker-in-SSRS-Reports-for-Non-I)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-15T11:18:25.023

在撰写本文时，可以访问所谓的死链接（[rajbandi.net](https://rajbandi.net/)）；如果链接再次断开，我将其内容放在这里以供使用：

* * *

**在 Google chrome 中修复 SSRS 报告查看器控制日期选择器**
作者：Raj Bandi
2012 年 4 月 3 日
[https://rajbandi.net/2012/04/03/fixing-ssrs-report-viewer-control-date-picker-in-google-铬合金/](https://rajbandi.net/2012/04/03/fixing-ssrs-report-viewer-control-date-picker-in-google-chrome/)

SSRS Report Viewer 控件在 IE6+ 中运行良好，但在日期选择器和打印按钮周围存在与其他主要浏览器（Firefox、Chrome 等）的一些已知兼容性问题。

有关更多信息，请阅读此

[http://msdn.microsoft.com/en-us/library/ms251673.aspx](http://msdn.microsoft.com/en-us/library/ms251673.aspx)

我提出了一个简单的解决方案，结合一些服务器端代码和客户端 JQuery 脚本来修复 Chrome 中的日期选择器问题。

**服务器端代码**

1）在reportviewer控件所在的页面/控件文件中添加以下代码

```
<asp:HiddenField ID="DatePickers" runat="server" /> 
```

2）在reportviewer控件所在的页面/控件的代码隐藏文件中添加以下代码（.Net 2.0版本）

```
protected override void OnPreRender(EventArgs e)
{
    base.OnPreRender(e);
    DatePickers.Value = string.Join(",",(new List(GetDateParameters()).ToArray()));
}
private IEnumerable GetDateParameters()
{
    // I'm assuming report view control id as reportViewer
    foreach (ReportParameterInfo info in reportViewer.ServerReport.GetParameters())
    {
        if (info.DataType == ParameterDataType.DateTime)
        {
            yield return string.Format("[{0}]",info.Prompt);
        }
    }
} 
```

**客户端代码**

1）在html head部分添加以下脚本

```
$(document).ready(function(){
    if ($.browser.webkit)
    {
        $($(":hidden[id*='DatePickers']").val().split(",")).each(function(i, item) {
            var h = $("table[id*='ParametersGrid'] span").filter(function(i) {
            var v = "[" + $(this).text() + "]";
            return (v != null && v.indexOf(item) >= 0);
        })
        .parent("td").next("td").find("input")
            .datepicker({
                showOn: "button",
                buttonImage: '/Reserved.ReportViewerWebControl.axd?OpType=Resource&Name=Microsoft.Reporting.WebForms.calendar.gif',
                buttonImageOnly: true,
                dateFormat: 'dd/mm/yy',
                changeMonth: true,
                changeYear: true
            });
        });
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-19T18:28:08.563

至少在 Chrome 中，一个选项可能只是显示不包括时间的日期。这对最终用户来说更有意义。

```
//Update the dates
$(document).ready(function () {
    $('input[type=text]').each(function () {
        $(this).val($(this).val().replace('12:00:00 AM', ''));
    })
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-31T04:27:08.333

删除当前帐户/人员并在 chrome 上添加新帐户/人员对我有用。

![](../Images/ba6ba2737be8b1d1c2fd85e5976230a5.png)

# html - 如何在不调整 CSS 中父元素宽度的情况下调整子元素的宽度？

> ID：14862486
> 
> 赞同：0
> 
> 时间：2013-02-13T20:28:36.717
> 
> 标签：html, css

我有以下内容：

```
<div class="parent">
  <div class="sizer" />
  <div class="child" />
</div>

.sizer {
width: 200px;
}

.child {
position: relative;
width: 400px;
} 
```

我不允许明确设置父级的宽度，也不允许将子级设置为`position:absolute`.

使用 CSS，是否有任何其他方法可以将宽度设置`.child`为 400，而无需将宽度`.parent`从 200 扩展到 400？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:34:55.800

如果父级有一个设定的宽度，那么即使子级的宽度超过父级的宽度，它也不会随着子级的宽度而扩展。请参阅[此 JS Fiddle 示例](http://jsfiddle.net/xgYEt/1/)。

```
.parent {
    width: 300px;
    height: 50px;
}

.child {
    width: 400px;
    height: 50px;
    position: relative;

} 
```

![在此处输入图像描述](../Images/96763520c323a0d3409f7d9ed0896739.png)

* * *

**更新**

> 我想知道是否有任何一种黑客可以让我在不设置父母宽度的情况下做到这一点

如果父级没有某种宽度或类似宽度的属性，就无法实现这一点。如果您只反对`width`在父级上使用该属性，则可以使用几种类似宽度的替代方案。

正如 cimanon 在下面的评论中解释的那样，您可以设置`.parent`一个`max-width`. 它不一定是`100%`；任何 max-width 都可以，只要它小于孩子的宽度。[请参阅此 JS Fiddle 示例](http://jsfiddle.net/xgYEt/3/)，或查看以下代码：

```
.parent {
    max-width: 200px;
} 

.child {
   width: 400px;
} 
```

或者，您可以使用`position:absolute`和设置`left`and`right`属性。[请参阅此 JS Fiddle 示例](http://jsfiddle.net/xgYEt/2/)，或查看以下代码：

```
.parent {
    position:absolute;
    left:0;
    right:0;
} 
```

但请记住，这些只是众多可能替代方案中的两个。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:42:41.197

您可以将父级的最大宽度设置为 100%。

[http://jsfiddle.net/aFdzy/](http://jsfiddle.net/aFdzy/)

```
.parent {
    max-width: 100%;
}

.child {
    width: 400%;
} 
```

# java - Hibernate 性能问题：查询执行速度极慢

> ID：14862487
> 
> 赞同：0
> 
> 时间：2013-02-13T20:28:37.050
> 
> 标签：java, sql, performance, hibernate

以下休眠查询用于通过传入 catId 和 inventoryId 来获取 ProductCatalogue 记录列表

```
select prodcat from ProductCatalogue prodcat where prodcat.prodSec.prodId=:catId and prodcat.prodPlacedOrder.inventoryId=:inventoryId 
```

表 ProductCatalogue 和 ProdPlacedOrder 是具有 30 万条以上记录的表。inventoryId 是 prodOrder 表中的一列，prodPlacedOrder 是 prodOrder 表的扩展。

执行这个查询需要很多时间，并且单个休眠查询会触发许多复杂的 sql 查询。

关于可能是什么问题以及如何修改它以使查询执行得更快的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:31:41.913

很难说没有更多信息，但如果您不需要该表中的任何数据，请尝试将 ProdPlacedOrder 设置为 LAZY fetch。

还提到了phatmanace - 检查您的索引。

# hook - 为什么“可扩展性挂钩”让连续设计变得更加困难？

> ID：14862489
> 
> 赞同：0
> 
> 时间：2013-02-13T20:28:54.740
> 
> 标签：hook, extensibility

我最近阅读了 Jim Shore 写的“ [Continuous Design](http://www.martinfowler.com/ieeeSoftware/continuousDesign.pdf) ”文章。他在一处写道：

> 特别是，前期设计通常包括用于未来设计更改的“可扩展性挂钩”。这种方法使连续设计更加困难，应该避免。

我不明白为什么它使连续设计变得更加困难。可扩展性挂钩（可能带有抽象）通常意味着更好的设计。那么为什么它使连续设计变得更加困难呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:42:22.317

它使持续设计变得更加困难的原因是您现在正在设计这些钩子以满足您当前没有的需求，因此您的设计基于您认为将来需要的东西。如果您稍后发现您需要的功能与钩子允许的功能不同，您需要重写它们或解决它们。

这一切都归结为做[最简单的事情](http://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it)来实现你当前的目标，因为这就是你所拥有的所有信息。这些钩子很可能只会妨碍未来的变化。

# c# - 关于 Quartz.net 2.0 实施的问题和帮助

> ID：14862491
> 
> 赞同：1
> 
> 时间：2013-02-13T20:29:06.170
> 
> 标签：c#, .net, wpf, scheduler, quartz.net-2.0

我正在尝试编写一个实现 Quartz.net 2.x 的简单概念验证应用程序。我从未见过如此糟糕的文档借口。我有很多问题，我似乎无法回答。似乎文档假定您一直在使用 1.x 版本并且正在迁移到 2.x（实际上 2.x 教程的很大一部分是特定于 1.x 的。）嗯，我从未使用过基于 Java 的Quartz，Quartz.net 1.x，显然不是 2.x。所以我会尽量把我的问题安排得井井有条。对其中任何一个的答案或对文档、教程等的指导将是最受欢迎的。

*   最终我只是想实现 Quart.net 2.0 来触发任何琐碎的工作（嵌入。不是服务。）

    1.  Quartz.net 执行的作业的结构是什么？方法、类等？似乎是一堂课，但我似乎找不到这个问题的明确答案。

    2.  有人能解释一下工厂、商店和数据图是什么，什么时候应该使用它们吗？

    3.  XML 怎么了？一些教程显示正在使用 XML……有些则没有。何时以及为什么要使用 XML？

我现在就停在那里。我希望有人有时间帮助我解决这个问题。我将不胜感激。虽然代码总是有用的，但我对理解这个过程更感兴趣。我将需要在未来的项目中使用 Quartz.net。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:34:18.170

好的，对于任何寻找文档的人，我能找到的最好的是 W0lf 在评论中链接的 Java 文档。由于 Quartz.net 是 Java 版本的移植版，因此文档非常相似，足以开始了解一些内部工作原理。我正在开发一些简单的工作来测试和获得经验。希望我能在某个时候为社区做出贡献。

找到了另一个获取信息的好地方。时间线从使用 1.0 开始，然后迁移到 2.0。但是那里有很好的信息，我不能对作者的工作表示足够的感谢。这是一个链接：http: [//jvilalta.blogspot.com](http://jvilalta.blogspot.com)

另一方面，我对 Marko Lahma 有点苛刻。他正在帮助提供我们都可以使用的开源产品。我认为他和他的团队还不够。不过，当涉及到帮助请求时，我确实很生气。回答一个问题所花费的时间与批评它所花费的时间一样多。为什么不直接回答问题？不管怎样，马尔科，我为自己的鲁莽道歉。但是，抽出时间更新您的文档将非常有帮助。我会尽我所能贡献。

# javascript - 如何在输入文本的正下方添加 div？

> ID：14862494
> 
> 赞同：1
> 
> 时间：2013-02-13T20:29:17.767
> 
> 标签：javascript, jquery, html

我想开发我的简单自动完成功能，我对 JQuery 自动完成插件不感兴趣。

我只想在输入文本下方添加一个潜水，这段代码应该可以工作，我做错了什么？实现这一目标的方法是什么？

[JSFiddle](http://jsfiddle.net/uZF5g/)

如果您不想打开小提琴，这是代码：

```
$("#txtSearch").keypress(function (e) {
    if ($("#txtSearch").val().length >= 2) {
        var pos = $("#txtSearch").position();
        $('<div />', {
            'html': "xxxxxxxxx  xx  x"
        }).css({
            top: pos.top,
            left: pos.left,
            width: '300px',
            position: 'absolute',
            'background-color': 'Yellow'
        }).appendTo($("#txtSearch"));
    }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T20:33:36.797

试试下面的代码，

```
$("#txtSearch").keypress(function (e) {
   if ($("#txtSearch").val().length >= 2) {
      var pos = $("#txtSearch").position();
      $('<div />')
      .html("xxxxxxxxx  xx  x")
      .css({
         top: pos.top + $("#txtSearch").height()  + 1,
         left: pos.left,
         width: '300px',
         position: 'absolute',
         'background-color': 'Yellow'
      }).insertAfter($("#txtSearch"));
   }
}); 
```

**演示：http:** [//jsfiddle.net/uZF5g/1/](http://jsfiddle.net/uZF5g/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:35:37.497

您不能附加到 ( `.appendTo`) 空内容模型元素。请改用`.insertAfter`（或`.insertBefore`）。您可能还希望`top`至少将其添加到输入的高度。

[http://jsfiddle.net/uZF5g/3/](http://jsfiddle.net/uZF5g/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:33:50.757

```
$("#txtSearch").keypress(function (e)
 {
    if ($("#txtSearch").val().length >= 2)
    {
    $('#txtSearch').after('<div id="someID">');
    $('#someID').html('xxxxxxx xx x')
       .css({ 
             top: pos.top, 
             left: pos.left, 
             width: '300px', 
             position: 'absolute', 
             'background-color': 'Yellow' 
           })
       .appendTo($("#txtSearch"));  
    }
 }); 
```

# java - 可以以编程方式对 jar 文件（如 .net 程序集）进行版本控制吗？

> ID：14862505
> 
> 赞同：2
> 
> 时间：2013-02-13T20:30:01.743
> 
> 标签：java, jar, versioning, .net-assembly

当我右键单击 .net exe 文件并转到“属性”然后“详细信息”时，有一个名为“文件版本”的条目对应于 System.Reflection.AssemblyFileVersion 程序集属性中指定的值以及一个条目命名为“产品版本”，对应于 System.Reflection.AssemblyVersion 程序集属性中指定的值。

相同的信息可以包含在 jar (zip) 文件中吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:35:05.967

java *.jar 文件通常在 /META-INF/MANIFEST.MF 下有一个清单文件，其中可能包含各种属性，其中包括版本信息。更多信息请看[这里](http://docs.oracle.com/javase/tutorial/deployment/jar/packageman.html)。

不幸的是，阅读此清单的内容并不[像您为 .net 描述的那样简单](https://stackoverflow.com/questions/1272648/reading-my-own-jars-manifest)

# java - Java：所有静态方法都需要同步吗？

> ID：14862506
> 
> 赞同：8
> 
> 时间：2013-02-13T20:30:02.297
> 
> 标签：java, servlets, synchronization, thread-safety

我有一个朋友说所有静态方法都应该`synchronized`在 Java Web 应用程序的上下文中。真的吗？我已经阅读了许多其他关于此的堆栈溢出页面。我开始相信，如果您有以下情况，您只需要同步：

1.  多线程（如在具有线程池的 Sevlet 容器中）
2.  单个类加载器
3.  线程间共享数据，无论是Session数据还是静态**成员**数据。
4.  共享数据必须是可变的。只读数据可以共享。

基于此，我认为静态成员应该是同步的，而不是静态方法。

```
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ThreadTest {

    static String staticString = "";

    // This static method is safe b/c it only uses local data.
    // It does not use any shared mutable data.
    // It even uses a string builder.
    static String safeStaticMethod(String in) {
        // This also proves that StringBuilder is safe
        // When used locally by a thread.
        StringBuilder sb = new StringBuilder();
        sb.append("Hello: ");
        sb.append(in);
        return sb.toString();
    }

    // This static method is not safe b/c it updates and reads
    // shared mutable data among threads.
    // Adding synchronized will make this safe.
    static String unsafeStaticMethod(String in) {
        staticString = in;
        StringBuffer sb = new StringBuffer();
        sb.append("Hello: ");
        sb.append(staticString);
        return sb.toString();
    }

    public static void main(String[] args) {
        ThreadTest test = new ThreadTest();
        test.staticMethodWithLocalData();
        test.staticMethodWithStaticData();
    }

    public void staticMethodWithLocalData() {

        ExecutorService executor = Executors.newFixedThreadPool(2);
        final int iterations = 100000;

        executor.submit(new Runnable() {

            @Override
            public void run() {
                for (int index = 0; index < iterations; ++index) {
                    if (!safeStaticMethod("Thread1").equals("Hello: Thread1")) {
                        System.out.println("safeStaticMethod at " + index);
                    }
                }
            }
        });

        executor.submit(new Runnable() {

            @Override
            public void run() {
                for (int index = 0; index < iterations; ++index) {
                    if (!safeStaticMethod("Thread2").equals("Hello: Thread2")) {
                        System.out.println("safeStaticMethod at " + index);
                    }
                }
            }
        });
    }

    public void staticMethodWithStaticData() {

        ExecutorService executor = Executors.newFixedThreadPool(2);
        final int iterations = 100000;

        executor.submit(new Runnable() {

            @Override
            public void run() {
                for (int index = 0; index < iterations; ++index) {
                    if (!unsafeStaticMethod("Thread1").equals("Hello: Thread1")) {
                        System.out.println("unsafeStaticMethod at " + index);
                    }
                }
            }
        });

        executor.submit(new Runnable() {

            @Override
            public void run() {
                for (int index = 0; index < iterations; ++index) {
                    if (!unsafeStaticMethod("Thread2").equals("Hello: Thread2")) {
                        System.out.println("unsafeStaticMethod at " + index);
                    }
                }
            }
        });
    }
} 
```

这段代码是否证明了这一点？

**编辑：**这只是我为了证明这一点而编写的一些一次性代码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-13T20:32:00.943

不，并非所有静态方法都需要同步。据我所知，你的清单基本上是完整的。使用静态方法时要特别小心

1.  访问一个可变的静态成员，或者
2.  获得对可以修改的对象的引用。

我认为不用说 1（首先有线程）是一个先决条件，因为没有线程`synchronize`是没有意义的。

我从来没有听说过2，所以我不确定这是否是一个考虑因素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T20:34:21.617

不，那不是真的，我相信这将是有害的。并非每个应用程序都需要并发，即使在确实需要并发的应用程序中，也不是每段代码都必须是并发的。

作为更多证据，[请查看 String 的来源。](http://www.docjar.com/html/api/java/lang/String.java.html) 那里有很多静态方法，但我只能找到一种同步方法，而且那个甚至不是静态的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T20:53:58.540

静态方法几乎**不**应该在 webapp 中同步。除非您 100% 确定唯一会使用该应用程序的人是您的 3 人会计团队，并且如果它在整个公司范围内起飞并且突然间几乎停顿，他们愿意脸红。

创建一个全局的、阻塞的、共享的资源是可伸缩性的彻底失败！如果您最终需要集群应用程序服务器，它也会给您带来很多麻烦，并且可能会将您锁定在 Terracotta 风格的解决方案中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-14T00:56:56.840

在 Web 应用程序中（例如使用 servlet/JSP 构建），您应该始终避免使方法同步，因为它挑战了多线程可访问性的整个理念。在适当的位置，始终尝试将唯一必要的代码（需要逐个访问）放置在同步块中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-01T09:57:37.043

一点也不。大多数情况下，我遇到的静态方法不会修改任何静态变量，因此它们不需要*同步*。

为了简单理解，

```
 //sample static util method to get string in upper case    
    public static String getName(String name){
        return a.toUpperCase();
    } 
```

上面的方法可以被 1000 多个线程调用，但是它将是线程安全的，因为该方法只需要一个参数 -**字符串名称**，并且来自线程堆栈。它不是线程之间的共享数据。

想一想，如果所有的静态方法都同步，那么 Web 应用程序使用起来会非常缓慢和昏昏欲睡。每当单个线程尝试访问该方法时，我们将拥有类级别的锁。

JDK提供的API中有很多静态方法。如果所有这些都是同步的，我很确定我们不会使用 JAVA。

在您的情况下，**静态方法**正在修改一个**静态变量**（类级别变量） 。是的，如果创建了多个线程并且它们要访问静态方法，则可能存在线程干扰。它不是线程安全的，因为它们之间存在**共享数据**。

 ****大多数情况下，静态方法是实用函数，具体取决于传递给它们的参数。

请注意，**如果不修改静态类变量，非同步静态方法是线程安全的**。****

# haskell - Haskell，解析输入错误')'

> ID：14862507
> 
> 赞同：0
> 
> 时间：2013-02-13T20:30:04.500
> 
> 标签：haskell

我在最后一行得到一个错误。

```
parse error on input `)' 
```

这是为什么？

```
import Data.Maybe 

data Operator = Add | Sub | Mul | Div | And | Or | Not | Eq | Less | Great
  deriving (Eq, Show)
data Expression = Literal Val
         | Primitive Operator [Expression]
         | Var String
         | If Expression Expression Expression
         | Let [(String, Expression)] Expression
     | Fun [String] Expression
     | Call Expression [Expression]
  deriving (Show, Eq)

data Val = Num Int
           | Boolean Boolean
       | Closure [String] Expression Env
  deriving (Eq, Show)

type Env = [(String, Val)]
--20
prim :: Operator -> [Val] -> Val
prim Add [Num a, Num b] = Num (a+b)
prim Mul [Num a, Num b] = Num (a*b)
prim Sub [Num a, Num b] = Num (a-b)
prim Div [Num a, Num b] = Num (a `div` b)
prim And [Boolean a, Boolean b] = Boolean (a && b)
prim Or [Boolean a, Boolean b] = Boolean (a || b)
prim Not [Boolean a] = Boolean (not a)
prim Eq [a, b] = Boolean (a == b)
prim Less [Num a, Num b] = Boolean (a < b)
prim Great [Num a, Num b] = Boolean (a > b)
--32
evaluate :: Env -> Expression -> Val
evaluate e (Literal v)  = v
evaluate e (Prim op as) = prim op (map (evaluate e) as)
evaluate e (Var x) = fromJust (lookup x e)
evaluate e (If a b c)   = evaluate e (if fromBoolean (evaluate e a) then b else c)
evaluate e (Let bs b)   = evaluate ([(x, evaluate e d) | (x,d) <- bs ] ++ e) b

evaluate e (Fun str ex) = (Closure str ex e) --40
evaluate e (Call ex exl) = let (Closure a b c) = (evaluate e ex) 
            in (Closure a b (c ++ (helper a (map (evaluate e) exl)))) 

helper :: [String] -> [Val] -> [(String, Val)]
helper (a:ar) (b:br) = (a, b) : helper ar br 

fromBoolean (Boolean b) = b
--48
main = do
    let x = Var "x"
        fun1 = Primitive Mul [(Var "x"), (Literal (Num 2))]
        fun2 = Primitive Mul [(Var "x"), (Literal (Num 5))]
        in print (evaluate [] (Call (if (Boolean true) (fun1) (fun2)) (Literal (Num 3)))) -- parse error on input `)' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:39:57.687

在 Haskell 中，如果，那么 & else 总是必须一起去。您的问题行仅定义“如果”

# javascript - 在获取令牌期间重定向到 m.box.com。没有任何象征性的回应

> ID：14862511
> 
> 赞同：0
> 
> 时间：2013-02-13T20:30:18.480
> 
> 标签：javascript, post, box-api

当我执行[https://api.box.com/oauth2/token](https://api.box.com/oauth2/token) 以获取访问令牌时，它会将我重定向到 m.box.com ！！！

我正在使用 JavaScript XHR POST，无法理解它是如何将我重定向到[https://m.box.com/](https://m.box.com/)的！？

这是我的要求：

```
Request URL:https://api.box.com/oauth2/token
Request Method:POST
Status Code:200 OK
Request Headersview source
Accept-Language:en-US,en;q=0.8
Content-Type:application/x-www-form-urlencoded
Cookie:box_visitor_id=511bb5cfe018c0.09915316; country_code=US; box_redirect_url=https%3A%2F%2Fm.box.com%2F; box_redirect_rm=common_main; z=1pm9dat3tb82gs1s2njrdsocg4; referrer=; __utma=254217048.1806492505.1360770515.1360778764.1360781511.3; __utmb=254217048.14.9.1360786227431; __utmc=254217048; __utmz=254217048.1360770515.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utma=47569716.1075364291.1360770555.1360781565.1360783878.4; __utmb=47569716.5.10.1360783878; __utmc=47569716; __utmz=47569716.1360783878.4.4.utmcsr=api.box.com|utmccn=(referral)|utmcmd=referral|utmcct=/oauth2/authorize; RT=s=1360786281036&r=https%3A%2F%2Fwww.box.com%2Fapi%2Foauth2%2Fauthorize%3Fresponse_type%3Dcode%26client_id%3Dqpome2tetr5oesmq62tut4brabsd9j1q%26state%3Dauthenticated
Origin:platform://.
User-Agent:Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/10.0.10.357 Mobile Safari/537.10+
Form Dataview URL encoded
grant_type:authorization_code
code:mj5wDvMwjbbWBlg2QRsN296OvMS9nsWf
client_id:qpome2tetr5oesmq62tut5brabsd9j1q
client_secret:1bCE76NVOe6c3Ro4mKXXrMqW7BLunib4
Response Headersview source
Cache-Control:no-store
Connection:close
Content-Length:174
Content-Type:application/json
Date:Wed, 13 Feb 2013 20:11:22 GMT
Server:nginx 
```

如您所见，它没有任何响应，而是将我重定向到[https://www.box.com](https://www.box.com)，然后重定向到[https://m.box.com](https://m.box.com)！有人可以解释一下为什么吗？

它是适用于 Blackberry 10 的 Webworks HTML5。

**更新：**

在详细查看网络活动后，我注意到当我将 redirect_url 设置为 https:// 时，它看起来像：

> > GET 请求 URL：[https](https://www.box.com/api/oauth2/authorize?response_type=code&client_id=qpome2te3r5oesmq62ttt41bdabsd9j1q&state=authenticated) ://www.box.com/api/oauth2/authorize?response_type=code&client_id=qpome2te3r5oesmq62ttt41bdabsd9j1q&state=authenticated 请求方法：POST 状态代码：302 找到
> > 
> > GET 请求 URL：[https](https://google.com/?state=authenticated&code=S1KrsSQG5XWURvpFV8NrfqkuCpCxo2Z3) ://google.com/?state=authenticated&code=S1KrsSQG5XWURvpFV8NrfqkuCpCxo2Z3 请求方法：GET 状态代码：301 永久移动

但是当我使用任何类型的 URI 方案时：例如 misha:// 它看起来像：

> > GET 请求 URL：[https](https://www.box.com/api/oauth2/authorize?response_type=code&client_id=qpome2te3r5oesmq62tttbbddbsd9j1q&state=authenticated) ://www.box.com/api/oauth2/authorize?response_type=code&client_id=qpome2te3r5oesmq62tttbbddbsd9j1q&state=authenticated 请求方法：POST 状态码：200 OK
> > 
> > GET 请求 URL：misha://authorised.html?state=authenticated&code=5h49cfldt0zWy8f8Y4IKewTTr07TFzkJ 请求标头查看源 Accept-Language:en-US,en;q=0.8 状态：**CANCELED**
> > 
> > GET 请求 URL：[https](https://www.box.com/) ://www.box.com/ 请求方法：GET 状态码：302 找到

......

当我使用已注册的 URI 方案时，我得到了这个：

> > GET 请求 URL：[https](https://www.box.com/api/oauth2/authorize?response_type=code&client_id=qpome2te3r5oesmq62tttbbddbsd9j1q&state=authenticated) ://www.box.com/api/oauth2/authorize?response_type=code&client_id=qpome2te3r5oesmq62tttbbddbsd9j1q&state=authenticated 请求方法：POST 状态码：200 OK
> > 
> > GET 请求 URL：platform:///authorised.html?state=authenticated&code=l793tAT7eVpl85gvr77ZdnIFHTGYVNsJ 请求方法：GET 状态码：200

然后不管在我的authorized.html中做什么，突然进入box.com！？？

> > GET 请求 URL：[https](https://www.box.com/) ://www.box.com/ 请求方法：GET 状态码：302 找到

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:52:09.123

您遇到的主要问题是使用 Javascript 从您的域向 www.box.com 发出请求。[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)不允许这样做

# c - open_memstream 警告“来自没有强制转换的整数的指针”

> ID：14862513
> 
> 赞同：1
> 
> 时间：2013-02-13T20:30:22.467
> 
> 标签：c, linux, embedded

我正在使用 an 为嵌入式 linux 系统编写一些 C 代码，但`open_memstream`我不明白为什么会收到编译警告：**assignment makes pointer from integer without a cast**

为了简单起见，我没有粘贴我所有的代码，而是从[这里](http://pubs.opengroup.org/onlinepubs/9699919799/functions/open_memstream.html)用小例子重现了这个问题：

```
#include <stdio.h>
#include <stdlib.h>

int
main (void)
{
    FILE *stream;
    char *buf;
    size_t len;
    off_t eob;

    stream = open_memstream (&buf, &len);
    if (stream == NULL)
        /* handle error */ ;
    fprintf (stream, "hello my world");
    fflush (stream);
    printf ("buf=%s, len=%zu\n", buf, len);
    eob = ftello(stream);
    fseeko (stream, 0, SEEK_SET);
    fprintf (stream, "good-bye");
    fseeko (stream, eob, SEEK_SET);
    fclose (stream);
    printf ("buf=%s, len=%zu\n", buf, len);
    free (buf);
    return 0;
} 
```

该代码有效，但编译器抱怨该行`stream = open_memstream (&buf, &len);`

它在说什么整数？根据函数原型的要求，我们传递了一个指向 size_t 的指针。

`FILE *open_memstream(char **bufp, size_t *sizep);`

这段代码有问题吗，还是我需要看看我的编译器？我想以正确的方式摆脱这个警告。

* * *

更新：

使用 gcc 4.3.2、glibc 2.9

* * *

更新 2：

尝试了以下方法：

```
powerpc-860-linux-gnu-gcc -std=c99 -Wall -D_XOPEN_SOURCE=700 -c source.c 
```

结果：

```
source.c: In function 'main':
source.c:12: warning: implicit declaration of function 'open_memstream'
source.c:12: warning: assignment makes pointer from integer without a cast 
```

据此[，](http://www.kernel.org/doc/man-pages/online/pages/man7/feature_test_macros.7.html)似乎 _XOPEN_SOURCE=700**自 glibc 2.10 起**可用。

由于我使用的是 glibc 2.9，我还有哪些其他选择（除了升级 glibc）？

* * *

更新 3：

添加以下内容消除了警告：

`extern FILE *open_memstream(char **bufp, size_t *sizep);`

这个解决方案有什么问题吗？

* * *

更新 4：

这有效，而不是外部：

`powerpc-860-linux-gnu-gcc -std=c99 -Wall -D_GNU_SOURCE -c ops_cmds.c`

所以根据手册[页](http://linux.die.net/man/3/open_memstream)`_GNU_SOURCE`，如果 glibc pre-2.10（在我的情况下）和`_XOPEN_SOURCE=700`如果 2.10+ ，需要使用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:31:19.270

定义：

```
#define _POSIX_C_SOURCE 200809L 
```

或者

```
#define _XOPEN_SOURCE 700 
```

在您的源代码中包含`stdio.h`. 或者，`gcc`您可以使用以下选项定义宏值并将其传递给源文件`-D`：

```
gcc -std=c99 -Wall -D_XOPEN_SOURCE=700 -c source.c 
```

`open_memstream`是一个 POSIX 函数，如果没有这个定义，它的声明在你的程序中是不可见的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:41:56.243

编译器抱怨的是 的*返回值*，`open_memstream`而不是你传入的参数。

你`open_memstream`没有声明，即编译器看不到原型。因此编译器（显然是 C99 之前的版本）假定它返回一个`int`. 您将其强制`int`转换为`stream`指针，这会触发有关“使指针形成整数”的警告。

`open_memstream`在尝试使用它之前，请确保已声明。原型应该驻留在 中`stdio.h`，但它仅在 POSIX.1-2008 中可用。您必须明确启用它（请参阅其他答案）。

# asp.net - Bundle Scripts.Render 在区域视图中不起作用

> ID：14862515
> 
> 赞同：1
> 
> 时间：2013-02-13T20:30:36.470
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4

我有一个带有区域的 MVC 4 站点。我设置了两个脚本包，一个用于站点需要的所有常见脚本，另一个用于与区域相关的脚本。对于使用 Scripts.Render() 引用公共站点包的站点，我有一个通用布局视图。我有该区域的第二个布局视图，它使用通用布局视图，我想在其中呈现特定于区域的 javascript 文件，但它不起作用并且根本没有呈现任何文件。如果我将包渲染移动到根布局视图，它会渲染得很好。

为什么这在区域视图中不起作用以及如何使它起作用？我宁愿不让所有用户都可以使用这些特定于区域的脚本，因为实际上只有一个非常小的、已定义的子集需要它们。

**通用布局视图：**

```
@Scripts.Render(@"~/Scripts/all_scripts")
...
@RenderSection("Javascript", required: false) 
```

**区域特定视图：**

```
@section Javascript {
    @Scripts.Render(@"~/Scripts/area_scripts")
    @RenderSection("Javascript", required: false)
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:25:01.287

我对此进行了测试，它似乎工作正常。特定于管理员的脚本在管理员索引视图中呈现（并且也在管理员布局中工作）。是否正确配置了所有捆绑包/路径？

BundleConfig.cs

```
 bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                    "~/Scripts/jquery-ui-{version}.js"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryadmin").Include(
                    "~/Scripts/Admin/jquery.unobtrusive-ajax-admin*",
                    "~/Scripts/Admin/jquery.validate-admin*")); 
```

_Layout.cshtml

```
 @Scripts.Render("~/bundles/jqueryui")
    @RenderSection("Javascript", required: false) 
```

_AdminLayout.cshtml

```
 @{
        ViewBag.Title = "_AdminLayout";
        Layout = "~/Views/Shared/_Layout.cshtml";
    }

    <h2>AdminLayout</h2>
    @section Javascript{
        @RenderSection("Javascript", required: false)
    } 
```

AdminHome/Index.cshtml

```
 @{
        ViewBag.Title = "Index";
        Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
    }

    <h2>Index</h2>

    @section Javascript{
        @Scripts.Render("~/bundles/jqueryadmin")
    } 
```

希望这可以帮助。

# java - 数学方程式项目

> ID：14862517
> 
> 赞同：-5
> 
> 时间：2013-02-13T20:30:40.073
> 
> 标签：java

```
public class problem1 {
    public static void main(String args [])
    {
    int [] a = new int [1000];

    for (int counter = 0; counter<=a.length;counter++);
    { 
        if ((counter % 3 == 0) || (counter % 5 == 0))
        {
            int temp += counter;
        }
    }

}
} 
```

我正在尝试解决一个方程式，您必须通过一个包含数字 1-1000 的数组，并将所有 3 和 5 的倍数的数字相加，但我的代码不会执行。谁能看到我的错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:31:54.767

您的代码有两个主要问题：

*   在 for 循环的末尾有一个分号。

    ```
    for (int counter = 0; counter<=a.length;counter++); // Remove the ; 
    ```

*   您每次都在 for 循环中重新声明变量。

    ```
    int temp += counter;  // replace it with `temp += counter`. 
    ```

`temp`并在 ,之外声明变量`for loop`，并使用它的默认值`0`。

一个小问题是：

*   你不需要那个数组 `a`。而是用所需的值声明一个`int`变量（在本例中为）。并在循环条件下使用它，而不是.`total``1000``a.length`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:38:37.637

*   不要为您的计数器创建数组。没有必要，数组通常存储可重用的值，例如姓名、城市、年龄等。

*   同样 for 循环也不以分号结尾。

*   最重要的是：不要在循环中声明变量。如果你这样做，你将一次又一次地创建 X 次变量

```
public class problem1 {

public static void main(String[] args) {

    int temp = 0;

    for (int i = 0; i <= 1000; i++)

    {
        if ((i % 3 == 0) || (i % 5 == 0)) {
            temp += i;

        }
    }
    System.out.println("Result is :" + temp);
}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:35:02.973

由于 for 末尾的分号，您的代码将永远不会执行，它不会给您编译错误，但这意味着一个空语句，因此永远不会执行 for 主体，只需删除分号即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T20:35:16.163

`int temp`我相信您应该首先在 for 循环之外进行初始化。它应该如下：`int temp = 0;`然后`temp += counter;`应该工作。

# php - ffmpeg - 从剪辑持续时间的中间提取缩略图

> ID：14862522
> 
> 赞同：3
> 
> 时间：2013-02-13T20:30:57.390
> 
> 标签：php, ffmpeg

嗨，我正在使用以下 ffmpeg 命令从 ffmpeg 剪辑的开头提取缩略图：

```
/usr/local/bin/ffmpeg -ss 00:00:1 -i $fileName.flv -s 150x100 -vframes 1 $fileName.jpg 
```

是否可以单独使用 ffmpeg 从剪辑持续时间的中间提取缩略图？

**每个剪辑的长度不同。**

如果 ffmpeg 不提供此选项，我知道可以将剪辑持续时间转换为 00:00:01.26 这种类型的格式，然后我想我可以将它分成两半，但我不确定这是否是最好的方法，而且我也（不好意思说）不完全确定如何用 PHP 将该格式分成两半。

示例代码将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:36:55.867

你可以像这样得到中间：

```
<?php
// get duration
$time =  exec("/local/bin/ffmpeg -i $fileName.flv 2>&1 | grep 'Duration' | cut -d ' ' -f 4 | sed s/,//");   

// duration in seconds; half the duration = middle
$duration = explode(":",$time);   
$durationInSeconds = $duration[0]*3600 + $duration[1]*60+ round($duration[2]);
$durationMiddle = $durationInSeconds/2;

// recalculte to minutes and seconds
$minutes = $durationMiddle/60;
$realMinutes = floor($minutes);
$realSeconds = round(($minutes-$real_minutes)*60);
?> 
```

然后将您的命令与`$realMinutes`and一起使用`$realSeconds`：

```
/usr/local/bin/ffmpeg -ss $realMinutes:$realSeconds:1 -i $fileName.flv -s 150x100 -vframes 1 $fileName.jpg 
```

# c# - 插入到sql server

> ID：14862524
> 
> 赞同：1
> 
> 时间：2013-02-13T20:31:03.963
> 
> 标签：c#, insert, sql-server-2008-r2, ms-access-2000

我必须将数据从 ms 访问插入到 sql server。我的逻辑是：

1.  获取 ms 访问中的名称列表。

2.  插入前禁用外键和触发器。

3.  阅读每个表格。

4.  通过 SetAdded() 方法更改每一行的 RowState。

5.  最后使用命令生成器插入它

**错误**

表（Ms Access）中的一个字段具有数据类型日期/时间。但它只有时间值 NO DATE 部分。在插入过程中会出错。" SqlDateTime 溢出。必须在 1/1/1753 12:00:00 AM 和 12/31/9999 11:59:59 PM 之间。"

在数据集可视化工具中，我看到了 12/30/1899 1:01:01 AM 的值。

如何解决它。

```
 try
        {
            oleCon = new OleDbConnection();
            oleCon.ConnectionString = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\Client Work\Client Docs\Don\ABCMotor.mdb;User Id=admin;Password=;";
            oleCon.Open();
            dt = new DataTable();
            dt = oleCon.GetSchema("tables");

            sqlCon = new SqlConnection(@"Server=ACER-PC\SQLEXPRESS2008R2;Database=ABC;Integrated Security=SSPI;");
            sqlCon.Open();
            SqlCommandBuilder sqlCmdB = new SqlCommandBuilder();
            sqlCmd = new SqlCommand();
            SqlTransaction sqlTran;
            sqlTran = sqlCon.BeginTransaction();
            sqlCmd.Connection = sqlCon;
            sqlCmd.Transaction = sqlTran;
            sqlCmd.CommandText = "sp_msforeachtable";
            sqlCmd.Parameters.AddWithValue("@Command1", "ALTER TABLE ? NOCHECK CONSTRAINT all");
            sqlCmd.CommandType = CommandType.StoredProcedure;
            sqlCmd.ExecuteNonQuery();

            sqlCmd = new SqlCommand();
            sqlCmd.Connection = sqlCon;
            sqlCmd.Transaction = sqlTran;
            sqlCmd.CommandText = "sp_msforeachtable";
            sqlCmd.Parameters.Clear();
            sqlCmd.Parameters.AddWithValue("@Command1", "ALTER TABLE ? DISABLE TRIGGER  all");
            sqlCmd.CommandType = CommandType.StoredProcedure;
            sqlCmd.ExecuteNonQuery();

            foreach (DataRow row in dt.Rows)
            {
                if (row["Table_Name"].ToString().StartsWith("MSys") == false)
                {
                    oleDa = new OleDbDataAdapter("Select * from [" + row["Table_Name"] + "]", oleCon);
                    ds = new DataSet();
                    oleDa.Fill(ds);

                    if (ds.Tables[0].Rows.Count > 0)
                    {
                        sqlDa = new SqlDataAdapter("Select * from [" + row["Table_Name"] + "]", sqlCon);
                        sqlDa.SelectCommand.Transaction = sqlTran;
                        foreach (DataRow item in ds.Tables[0].Rows)
                        {
                            item.SetAdded();
                        }
                        sqlCmdB.DataAdapter = sqlDa;

                        sqlCmdB.GetInsertCommand();

                        sqlDa.Update(ds);                                         
                    }
                }
            }

            sqlCmd = new SqlCommand();
            sqlCmd.Connection = sqlCon;
            sqlCmd.Transaction = sqlTran;
            sqlCmd.CommandText = "sp_msforeachtable";
            sqlCmd.Parameters.Clear();
            sqlCmd.Parameters.AddWithValue("@Command1", "ALTER TABLE ? WITH CHECK CHECK CONSTRAINT all");
            sqlCmd.CommandType = CommandType.StoredProcedure;
            sqlCmd.ExecuteNonQuery();
            sqlCmd = new SqlCommand();
            sqlCmd.Connection = sqlCon;
            sqlCmd.Transaction = sqlTran;

            sqlCmd.CommandText = "sp_msforeachtable";
            sqlCmd.Parameters.Clear();
            sqlCmd.Parameters.AddWithValue("@Command1", "ALTER TABLE ? ENABLE TRIGGER  all");
            sqlCmd.CommandType = CommandType.StoredProcedure;
            sqlCmd.ExecuteNonQuery();
            sqlTran.Commit();
        }
        catch (Exception ex)
        {

            MessageBox.Show(ex.Message);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:40:13.180

尝试使用`FillSchema()`以确保您的数据适配器确切知道它正在处理的数据类型。

```
OleDbDataAdapter.FillSchema("", SchemaType.Source) 
```

您仍然需要调用该`Fill()`方法来获取数据。

# asp.net - 在asp.net的工具栏浏览器中隐藏站点地址的一部分

> ID：14862527
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:31:14.833
> 
> 标签：asp.net, toolbar

我想在 asp.net 的浏览器工具栏中隐藏部分地址。

例如，如果它是`http://mysite.com/News/Shownews.aspx?ID=-1&Num=20`，它应该`http://mysite.com/`在每一页上更改为 。

我访问了一些完全类似的网站。有谁能够帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:36:03.880

您可能想要[UrlRewrite](http://www.iis.net/downloads/microsoft/url-rewrite)。
或者，您可以使用 asp.net mvc，它具有路由功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:42:55.073

不知道你为什么会做这样的事情，但我想到了一些 hacky 解决方案：

*   `http://mysite.com/News/Shownews.aspx?ID=-1&Num=20`将以重定向响应并`http://mysite.com/`存储 cookie/会话状态/...中所需的任何信息（例如，完整的原始请求 URL）
*   控制器处理`http://mysite.com/`抓取状态并呈现适当的输出

当然，这可能会引入一些竞争条件，具体取决于用于存储相关状态的确切方法。

总而言之，考虑到 REST 之类的原则，整个工作都是一个非常糟糕的主意……但是既然你要求它……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:45:20.420

Yep, URL rewriting is what you're looking for most likely: [http://msdn.microsoft.com/en-us/library/ms972974.aspx](http://msdn.microsoft.com/en-us/library/ms972974.aspx) is a broad overview of the topic.

# java - Java：消息恢复时播放声音（IP聊天程序）

> ID：14862530
> 
> 赞同：0
> 
> 时间：2013-02-13T20:31:19.300
> 
> 标签：java, audio

我知道有很多播放声音的东西。我正在构建一个 IP 聊天程序。我对编程很陌生（如果你必须知道的话，我是护理专业的）。我正在使用日食。我试图让它在收到消息时播放声音。我不知道如何制作一个将调用文件然后播放它的类。谢谢！

这就是我现在所拥有的（是的，我知道它已被注释掉）：

```
public void playsound(final String input) {
   final java.util.Date date= new java.util.Date();
   //String stringFile = "x.wav";
   //File wavfile = new File("notification.wav");
   //AudioInputStream audioInput = AudioSystem.getAudioInputStream(wavfile);
   //AudioFormat format = audioInput.getFormat();
   //DataLine.Info info = new DataLine.Info(Clip.class,  format);
   //clip = AudioSystem.getClip();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:16:41.987

替换`clip = AudioSystem.getClip();`为

```
Clip clip = AudioSystem.getClip();
clip.open(audioInput);
clip.start(); 
```

去除`String stringFile = "x.wav";`

取消注释其余部分就足够了。

这里有一个关于从 JAR 中的文件播放文件的教程，这可能比在文件系统中指定文件更有用：[http://www3.ntu.edu.sg/home/ehchua/programming/java/J8c_PlayingSound。 html](http://www3.ntu.edu.sg/home/ehchua/programming/java/J8c_PlayingSound.html)

# javascript - 将数据聚合为 Flot 时间图表的天、周、月

> ID：14862532
> 
> 赞同：3
> 
> 时间：2013-02-13T20:31:26.577
> 
> 标签：javascript, charts, flot

我想创建类似于谷歌分析的图表，它允许你按天、周、月聚合数据......

例如，以下图表数据显示了一个月的每日数据：

![在此处输入图像描述](../Images/303665cb8aebfea29630b2bdbd67ef21.png)

通过单击“周”，图表将数据点聚合为周：

![在此处输入图像描述](../Images/38e7b25d9642ac2b28a01e78e15061ba.png)

我能找到的最接近的是 Ruby 库 Timeslicer，[https://github.com/Trimeego/timeslicer](https://github.com/Trimeego/timeslicer)。Javascript 或 Flot 插件中有类似的东西吗？

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-02-13T20:59:45.813

你试过[http://www.jqplot.com/](http://www.jqplot.com/)吗？

它很容易使用......但如果你使用 MVC，我会使用 Char 内置对象。无论如何，我希望这可以帮助你！

# actionscript-3 - as3 在 mp3 中以毫秒为单位获取“小时”

> ID：14862546
> 
> 赞同：0
> 
> 时间：2013-02-13T20:32:34.420
> 
> 标签：actionscript-3, flash, date, datetime, time

在 As3 中，下面的代码获取分钟和秒：

```
var minutes:uint = Math.floor(PrayPrayer.position / 1000 / 60);
var seconds:uint = Math.floor(PrayPrayer.position / 1000) % 60; 
```

但是，如果您收听超过一小时的音频谈话怎么办？

**从 mp3 演讲中获得时间需要多少数学运算？**

```
 var hours:uint = Math.floor(PrayPrayer.position / 1000) % 60    & (((???????))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:39:09.417

这是我的转换方法：

```
 public static var MINUTE:Number = 60;
    public static var HOUR:Number = 60 * MINUTE;
    public static var DAY:Number = 24 * HOUR;

        /**
     * returns string created from seconds value in following format hours:minutes:seconds, i.e. 121 seconds will be displayed as 00:02:01
     * @param   seconds <i>Number</i>
     * @return <i>String</i>
     */
    public static function secondsToHMS(seconds:Number, doNotRound:Boolean = false):String
    {
        var _bNegative:Boolean = seconds < 0;

        seconds = Math.abs(seconds);

        var time:Number = (doNotRound) ? seconds:Math.round(seconds);

        var ms:Number;
        var msec:String;

        if (doNotRound)
        {
            ms = seconds - (seconds | 0);
            msec = prependZeros((ms * 1000) | 0, 3);
        }

        var sec:Number = (time | 0) % MINUTE;

        var min:Number = Math.floor((time / MINUTE) % MINUTE);

        var hrs:Number = Math.floor(time / HOUR);
        //
        return (_bNegative ? "-":"") +
               ((hrs > 9) ? "":"0") + hrs + ":" +
               ((min > 9) ? "":"0") + min + ":" +
               ((sec > 9) ? "":"0") + sec +
               (doNotRound ? "." + msec:"");
    } 
```

prependZeros 是另一个在给定字符串前面添加“0”的实用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:49:33.947

`PrayPrayer.position`以毫秒为单位也是如此。您的`minutes`行除以 1000 得到秒，然后除以 60 得到秒到分钟。您的`seconds`线路正在查看剩余部分。

您`hours`在行中开始使用的是 using `%`，因此将查看其余部分 - 您在那里使用秒数。 `%`是模运算符。它为您提供整数除法的余数。所以你的线

```
var seconds:uint = Math.floor(PrayPrayer.position / 1000) % 60; 
```

正在查找秒数（PrayPrayer.position / 1000），可能是 2337 之类的大数字，除以 60 并保留余数。2337/60 = 38 余数 57，所以 2337%60 将是 57。

找到小时数的一种简单方法是对分钟数使用相同的技巧。

```
var minutes:uint = Math.floor(PrayPrayer.position / 1000 / 60);
var seconds:uint = Math.floor(PrayPrayer.position / 1000) % 60;
var hours:uint = Math.floor(minutes / 60);
minutes %= 60;  // same as minutes = minutes % 60\.  Forces minutes to be between 0 and 59. 
```

# excel - 将以一组模式结尾的单词聚合到一个新工作表中

> ID：14862547
> 
> 赞同：0
> 
> 时间：2013-02-13T20:32:35.160
> 
> 标签：excel, excel-2010, vba

我有 Excel 2010，我正在尝试合并单词列表。

1.  **Sheet1**包含一个包含单词列表的列，例如“ing”、“ed”、“en”......
2.  **Sheet2**包含一列，其中包含“Flying”、“Opening”、“Taken”、“Baked”、“Awaken”等词。
3.  **Sheet3**，对于 Sheet1 中的每个列值，我想要一个函数，将单词与 Sheet2 中的所有单词进行比较，并将它们收集到 sheet3 中。

因此，**Sheet3**在运行后应该有 3 列

*   第一列应该有 'Flying'、'Opening' - 所有以 'ing' 结尾的词
*   第二列应该有“Baked”——所有以“ed”结尾的词
*   第三列应该有 'Taken', "Awaken' - 所有以 'en' 结尾的单词

我尝试对其中一个词使用下面的公式，它似乎一次只对一个词有效，但我不确定如何自动执行此操作 - 我需要为此使用宏吗？

**=IF(RIGHT(A1:A7, 3)="ing", A1:A7, "")**

谁能建议如何解决这个问题？

问候， 索努

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T07:55:06.190

忽略我的澄清要求 - 我已重新阅读并现在理解您的问题。

以下代码适用于您所描述的内容。它假设如下：

1.  Sheet1 中的单词结尾列表和 sheet2 中的单词列表都是从单元格 A1 开始并向下延伸的连续列表。
2.  Sheet2 中的单元格 A1 包含一个列标题，例如“我的单词”，它不会被复制到 Sheet3 中的单词列中。如果要复制标题，请`.Offset(1,0)`从第 13 行删除。
3.  Sheet1 上的列表中没有比您的 Excel 版本中可用的列多的条目（例如 XL2003=256）
4.  Sheet3 在宏启动之前为空
5.  您尚未更改 3 个工作表对象的默认 VBA 代号
6.  床单不受保护

.

```
Sub extract()
Dim rFilt As Range
Dim rSrc As Range
Dim iTgtCol As Integer

    If Sheet2.FilterMode Then Sheet2.ShowAllData
    If Not Sheet2.AutoFilterMode Then Sheet2.Cells(1).CurrentRegion.AutoFilter

    Set rSrc = Sheet2.Cells(1).CurrentRegion.Columns(1)

    iTgtCol = 0

    For Each rFilt In Sheet1.Cells(1).CurrentRegion.Columns(1).Cells

        iTgtCol = iTgtCol + 1

        With rSrc
            .AutoFilter field:=1, Criteria1:="=*" & rFilt
            .Offset(1, 0).SpecialCells(xlCellTypeVisible).Copy Sheet3.Cells(iTgtCol)
        End With

    Next rFilt

    Sheet2.ShowAllData

End Sub 
```

# regex - 正则表达式 - 非捕获组不起作用

> ID：14862548
> 
> 赞同：4
> 
> 时间：2013-02-13T20:32:42.270
> 
> 标签：regex, powershell, powershell-2.0

我在 Powershell 中使用正则表达式。我有一个非捕获组，但它仍然显示在我的结果中。

字符串是：

```
Grid1.Data = [['TRE - Significant Flux','EG Report','w939909','59e8a31f-d9e9-4ebf-a027-929ec62953ac'],['CB - Daily OD Report','EG Report','w9
39909','59e8a31f-d9e9-4ebf-a027-929ec62953ac'],['BC - Balance Transfers Daily - DRAFT','BC - Balance Transfers Daily - DRAFT','w939909','59e8
a31f-d9e9-4ebf-a027-929ec62953ac'],['CB - CL Activity Report','CB - CL Activity Report','w939909','59e8a31f-d9e9-4ebf-a027-929ec62953ac']] 
```

正则表达式是：

```
$regex = "(?:\[').*?(?=')" 
```

它仍在返回类似 ['TRE - 重要通量

我需要排除开头的“['”。单引号末尾的非捕获组正在工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T20:45:40.027

尝试使用后向断言

```
$regex = "(?<=\[').*?(?=')" 
```

或者：

```
$regex = "(?:\[\[')(.*?)(?=')"

$yourstring -match $regex

$Matches[1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-07T04:52:04.833

非捕获组`(?:\[')`仍然包含在表达式的“匹配”部分中，因此在“匹配”中返回。Lookaheads（例如 (?=')）和lookbehinds 不是匹配的部分，而是布尔断言（如锚 ^ 和 $）。它们的模式必须从当前字符串位置向前（向前看）或向后（向后看）匹配（正向查看）或不匹配（负向查看），但它们仅返回真或假，并且不推进匹配指针。术语“非捕获”是指使用括号来“捕获”整体匹配的可单独检索的子部分（块）以及对模式的部分进行分组，通常当量词（*、+、？）应用于其他情况时未分组的部分，例如由 | 分隔的部分。一个“非捕获”组（ (?:

请注意，@CB 的答案中给出的第二个例子并不是最小的。由于要求是在 [ 之后立即检索两个 ' 字符之间的文本，并且最终的 ' 将被丢弃（后续匹配不需要），因此使用捕获组意味着将 [ 和两个 ' 字符包含在主匹配无关紧要。因此模式可以是

```
$regex = "\['(.*?)'" 
```

# c++ - 如何使用 C++ 通过标准输入获取可用数据的大小

> ID：14862549
> 
> 赞同：0
> 
> 时间：2013-02-13T20:32:44.910
> 
> 标签：c++, winapi, console-application, stdin

`stdin`如果我像这样从控制台应用程序获得句柄：

```
HANDLE hStdIn = ::GetStdHandle(STD_INPUT_HANDLE); 
```

然后我可以从中读取数据：

```
BYTE buff[32];
DWORD dwcbRead = 0;
BOOL bReadRes = ::ReadFile(hStdIn, buff, SIZEOF(buff), &dwcbRead, NULL); 
```

我的问题是，在读取它们之前我怎么知道有多少字节可用？

PS。`ReadFile`如果没有可读取的数据，似乎会阻塞。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:44:12.583

Use `ReadConsoleInput` to read raw input events and `PeekConsoleInput` to examine them without removing from the input queue. There is a bunch of caveats here:

1.  Your standard input might be redirected, then you'll have to determine its type and act accordingly. If it's a file, it won't block and you just go ahead and read. If it's a pipe, `PeekNamedPipe` provides some help.

2.  There is no one-to-one correspondence between input events and characters.

3.  If `ENABLE_LINE_MODE` is set on the console, `ReadFile`/`ReadConsole` would block if there is no newline yet entered; additionally, line editing facilities are unavailable before you actually *call* `ReadConsole`, and when you call `ReadConsole`, it will block.

I would recommend doing `ReadFile` or `ReadConsole` (or trying the latter with fallback to the former) in a separate thread. Your main thread may do something useful and eventually check (or wait for) readyness of the reading thread.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:36:54.893

[检查 stdin 上输入的可用性](http://www.jetdrone.com/post/1/16)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:37:13.010

对于控制台输入，您不知道用户或机器将提供多少字符。
例如，我的程序要求你输入一个句子。你在想哪句话？你会打哪一个？句子中有多少个字母？

如果你真的想知道，我强烈推荐一门阅读思想的课程，或者在非人类输入的情况下，一门预测未来的课程。

对于文件，您可以检查大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T20:40:48.277

是的，你可以这样做，是的，它会坐在那里等待你的输入来填充缓冲区。如果这不是你想要的，那么不要使用 ReadFile。

还有其他用于读取控制台 I/O 的功能，包括为您提供待处理“事件”数量的功能。

[控制台 IO 功能](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684961%28v=vs.85%29.aspx)

# ruby-on-rails - 如何在没有数据库的情况下使用 Rails/Devise？

> ID：14862567
> 
> 赞同：7
> 
> 时间：2013-02-13T20:34:03.927
> 
> 标签：ruby-on-rails, authentication, devise

我正在创建一个不使用数据库的 Rails 应用程序。相反，模型是使用包装遗留系统的 Ruby API 进行管理的。

我有一个 Ruby 调用，可以让我验证用户名/密码组合。在这种情况下是否可以使用 Devise（或其他一些现成的身份验证解决方案）？

我希望我可以覆盖 Devise 中的一些方法，并且仍然可以获得很多好处。

彼得。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T23:49:28.473

有可能的。

您可以通过 Devise 和 Warden 覆盖默认身份验证并使用远程服务。

这篇博文详细介绍了如何：

[http://4trabes.com/2012/10/31/remote-authentication-with-devise/](http://4trabes.com/2012/10/31/remote-authentication-with-devise/)

让我们知道怎么回事...

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:48:41.443

如果我理解正确，你想在你的项目中使用 Devise 来包装旧的遗留身份验证系统。您可能需要定义 legacy_username 和 legacy_password 方法，创建迁移以采用 Devise gem，我相信您会找到出路。也许这个链接可以帮助你：[http ://www.davidverhasselt.com/2012/05/13/how-to-migrate-passwords-from-legacy-systems-to-devise/](http://www.davidverhasselt.com/2012/05/13/how-to-migrate-passwords-from-legacy-systems-to-devise/)

而且，也许这 - 如何在设计中创建自定义加密器 - [https://github.com/plataformatec/devise/wiki/How-To:-Create-a-custom-encryptor](https://github.com/plataformatec/devise/wiki/How-To:-Create-a-custom-encryptor)

我希望它会有所帮助。

# java - Linux Bootstrap 消耗内存

> ID：14862575
> 
> 赞同：-3
> 
> 时间：2013-02-13T20:34:17.827
> 
> 标签：java, linux, tomcat

重新启动 2 小时后，我的服务器崩溃/关闭。当我查看它向我展示的过程时

```
 PID   USER     PR  NI    VIRT     RES    SHR   S   %CPU    %MEM    TIME+     COMMAND
 13209  root    25   0    3681m    2.3g   9.9m  S    98.0    87.3   16:11.09    java 
```

PID 引用了 13209“引导程序”。%CPU 一直在移动 100%、113% 并且服务器已关闭。tomcat重启后，2小时前都可以，但同样的问题又出现了。如何处理“Bootstrap”进程，这样它就不会消耗太多内存！

```
 Any Solution?? 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:06:59.793

在服务器异常繁忙时运行此命令：

```
kill -3 13209 
```

将 13209 替换为 java 进程的当前 PID。这会将线程转储输出到日志文件（默认为 catalina.out）。看看线程在做什么，这将使您更好地了解应用程序的哪个部分与 CPU 挂钩。

# java - 如何实现循环以使程序再次要求用户输入而不是结束程序

> ID：14862579
> 
> 赞同：0
> 
> 时间：2013-02-13T20:34:22.470
> 
> 标签：java, if-statement, while-loop, joptionpane

```
ans = JOptionPane.showInputDialog(null, "Enter amount to be withdrawn from checking");
double withCheck = Double.parseDouble (ans);
if (withCheck >= checking)
    {
    JOptionPane.showMessageDialog(null, "You do not have enough in your account for that.");
    }
else
    {
    double sum = checking - withCheck;
    JOptionPane.showMessageDialog(null, "Your checking balance is now: $" + sum + ", and your savings balance is: $" + savings);
    }
} 
```

目前此代码在 withCheck >= 检查时结束程序，我想知道一种使用某种循环再次询问问题的方法，直到“if”语句为假并且可以继续到 else 语句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:41:03.537

只需添加一个条件为**true的****while 循环**，并在某些条件下为真。**`break`**

 **```
While(true)
{
    ans = JOptionPane.showInputDialog(null, "Enter amount to be withdrawn from checking");
    double withCheck = Double.parseDouble (ans);
    if (withCheck >= checking)
        {
        JOptionPane.showMessageDialog(null, "You do not have enough in your account for that.");
        }
    else
        {
        double sum = checking - withCheck;
        JOptionPane.showMessageDialog(null, "Your checking balance is now: $" + sum + ", and your savings balance is: $" + savings);
        break;
        }
    }
} 
```**

# ruby-on-rails - Rails 模型格式验证失败，正则表达式

> ID：14862582
> 
> 赞同：1
> 
> 时间：2013-02-13T20:34:23.433
> 
> 标签：ruby-on-rails, regex, model, rspec, tdd

我正在为具有以下约束的录音建立一个模型

```
class Recording < ActiveRecord::Base
  attr_accessible :agent_id, :confirmation, :filepath, :phone, :call_queue_id, :date
  belongs_to :call_queue

  PHONE_FORMAT = /^[0-9]+$|Unavailable/

  validates_presence_of :call_queue_id, :agent_id, :phone, :filepath, :date
  validates :phone, format: { with: PHONE_FORMAT }
end 
```

并尝试使用以下规范对其进行测试

```
describe Recording do
  let(:queue) { FactoryGirl.create(:call_queue) }
  before { @recording = queue.recordings.build(FactoryGirl.attributes_for(:recording)) }
  subject { @recording }

  # Stuff omitted...

  describe "phone" do
    it "should be present" do
      @recording.phone = ''
      @recording.should_not be_valid
    end

    context "with a valid format" do
      it "should only consist of digits" do
        @recording.phone = 'ab4k5s'
        @recording.should_not be_valid
      end

      it "should only match 'Unavailable'" do
        @recording.phone = 'Unavailable'
        @recording.should be_valid
      end
    end
  end  
end 
```

前两个测试通过，但第三个测试失败，结果如下：

```
Failure/Error: @recording.should be_valid
   expected valid? to return true, got false 
```

我用[rubular](http://rubular.com)测试了我的正则表达式以确保它正常工作，然后再次使用 irb 来确定。我真的很困惑为什么这会失败。

编辑：

我最终通过更改我`before`在 rspec 中的声明使规范通过：

```
describe Recording do
  let(:queue) { FactoryGirl.create(:call_queue) }
  before(:each) { @recording = queue.recordings.create(FactoryGirl.attributes_for(:recording) }
  # the rest is the same... 
```

在某种程度上，这最终对我来说是有意义的。一切都变得混乱的原因（假返回真，反之亦然）是因为一旦属性使记录无效，我就不能再改变它了吗？好像是这样，我只是想确定一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:23:36.343

尝试：

```
PHONE_FORMAT = /^([0-9]+|Unavailable)$/ 
```

# linq - 多对多 EF LINQ

> ID：14862583
> 
> 赞同：2
> 
> 时间：2013-02-13T20:34:25.690
> 
> 标签：linq, ef-code-first, many-to-many

我有一个包含以下表格的数据库：

```
dbo.Administrator

dbo.Application

dbo.AdminApplication

dbo.Proficiency

dbo.ProficiencyLevel 
```

*   管理员包含 1 到多个应用程序。应用程序包含许多管理员
*   应用程序包含 1 到多个 Proficiency(s)
*   Proficiency 包含 1 到多个 ProficiencyLevels

首先使用 EF 代码，AdminApplication 没有被映射为实体，这就是导致我出现问题的原因。我想回答的是以下内容：

**"返回名为 "danhickman" 的管理员的所有熟练程度**。

在 SQL 中，查询如下所示：

```
Select * from dbo.ProficiencyLevel pl
inner join dbo.Proficiency p on p.Id = pl.ProficiencyId
inner join dbo.Application a on a.Id = p.ApplicationId
inner join dbo.AdminApplication aa on aa.ApplicationId = a.Id
inner join dbo.Administrator ad on ad.Id = aa.AdministratorId
where ad.Name = 'danhickman' 
```

我用以下 C# 代码解决了这个问题：

```
 public IQueryable<LobGame.Model.ProficiencyLevel> GetAllByAdminName(string administratorName)
    {
        var context = this.DbContext as LobGameDbContext;
        var admin = context.Administrators.Include(i => i.Applications).Include("Applications.Proficiencies").Include("Applications.Proficiencies.ProficiencyLevels").Single(o => o.Name == administratorName);
        List<LobGame.Model.ProficiencyLevel> list = new List<ProficiencyLevel>();
        foreach (var app in admin.Applications)
        {
            foreach (var prof in app.Proficiencies)
            {
                list.AddRange(prof.ProficiencyLevels);
            }
        }
        return list.AsQueryable();
    } 
```

我不得不 foreach 并添加到列表中，这让我很烦恼。我无法在单个 LINQ 语句中找到一种方法来执行此操作。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:30:23.627

使用查询语法的另一个选项。这在幕后使用了 SelectMany。

```
var queryableList = 
  from admin in context.Administrators
  where admin.Name = administratorName
  from app in admin.Applications
  from proficiency in app.Proficiencies
  from level in proficiency.ProficiencyLevels
  select level; 
```

注意：这将是一个 IQueryable，因此您不需要 .ToList().AsQueryable()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:38:56.183

```
 return context.Administrators
                   .Single(o => o.Name == administratorName)
                   .Applications
                   .SelectMany(app => app.Proficiencies)
                   .SelectMany(prof => prof.ProficiencyLevels)
                   .ToList()
                   .AsQueryable(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:40:21.177

使用`SelectMany()`：

```
var queryableList = 
  context.Administrators.Single(o => o.Name.Equals(administratorName))
                        .SelectMany(adm => adm.Applications.Select(app => app.Proficiencies.SelectMany(prof => prof.ProficiencyLevels))).ToList().AsQueryable(); 
```

# c# - 正则表达式匹配用两种分隔符分隔的字符串

> ID：14862584
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:34:42.140
> 
> 标签：c#, asp.net, regex

我不太明白正则表达式是如何组合在一起的，所以这是我的问题。

我有一个分隔字符串`1,3;5,1;6,4`，依此类推。基本上，我在这里所拥有的是存储带有产品*ID*和*数量*的购物车。`1`，`3`这意味着我有一个带有 id`"1"`和数量的产品`3`。产品（带卷）用 分隔`";"`。

我需要做的是将验证此类字符串的正则表达式放在一起。只允许正数，例如从 1 到 10000。

有没有人有解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:09:45.907

我认为你最好不要为此使用正则表达式。假设您的格式是这样的`1,3;5,1;6,4`（即*不是*您在问题中指定的其他@Rich 指出的那样），您应该能够将其拆分`;`然后`,`：

```
var input = "1,3;5,1;6,4";

var pairs = input.Split(';')                        // ["1,3","5,1","6,4"]
    .Select(x => x.Split(','))                      // [["1","3"],["5","1"],["6","4"]]
    .Select(x => new { Id = x[0], Volume = x[1] }); // [{ Id : "1", Volume : "3"} ...]

foreach(var pair in pairs)
{
    Console.WriteLine("Id: " + pair.Id + " Volume: " + pair.Volume);
}
// Id: 1 Volume: 3
// Id: 5 Volume: 1
// Id: 6 Volume: 4 
```

注意：我在`System.Linq`这里使用了 and 一个匿名类型，但如果你愿意，你可以不用。

`IndexOutOfRangeException`另请注意：如果您的输入不是预期的格式，这将失败（即抛出一个）。如果您想验证一些不可靠的输入，那么 Regex可能*就是*您想要的 - 其他 @Rich 的答案对我来说看起来不错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:18:27.390

This regex pattern matches on semicolon-delimited number pairs, where a comma separates the members of each pair, and each number is between 1 and 10000:

```
^([1-9]\d{0,3}|10000),([1-9]\d{0,3}|10000)(;([1-9]\d{0,3}|10000),([1-9]\d{0,3}|10000))*$ 
```

There must be at least one pair. If there is only one pair, no semicolon follows it. Semicolons should be present only between neighboring pairs.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:57:08.803

我不确定我是否了解您的格式如何工作，但如果所有内容都必须具有格式 [id],[volume];[id],[volume]; 的 ID 和卷。然后我会说使用正则表达式，例如：

```
(([0-9]),([0-9]);)+ 
```

但是您的示例`1,3;5,1;6;4`似乎不遵循该格式，因此如果您希望音量是可选的，那么：

```
(([0-9])(,[0-9])?;)+ 
```

应该管用。如果您想尝试正则表达式模式，那么我建议您使用在线实用程序，例如[http://regexpal.com](http://regexpal.com)

# oracle - oracle中的sql删除错误为'ORA-00933：Sql命令未正确结束'

> ID：14862585
> 
> 赞同：0
> 
> 时间：2013-02-13T20:34:44.143
> 
> 标签：oracle

sql 块工作正常：

```
select * from aciktan_atama_tercihler LEFT OUTER JOIN (SELECT MIN(t.eklenme_tarihi) as row_id,
                                                              t.tcno,
                                                              t.hastane_kodu,
                                                              t.tercih_sira
                                                         FROM aciktan_atama_tercihler t
                                                        where t.silindi = '0'
                                                        GROUP BY tcno,
                                                                 hastane_kodu,
                                                                 tercih_sira) KeepRows ON aciktan_atama_tercihler.eklenme_tarihi = KeepRows.row_id
 WHERE KeepRows.row_id IS NULL
   and aciktan_atama_tercihler.silindi = '0' 
```

但是，如果我将其更改为如下所示的删除，则会出现“ORA-00933：Sql 命令未正确结束”错误，我该如何解决？：

```
delete from aciktan_atama_tercihler LEFT OUTER JOIN (SELECT MIN(t.eklenme_tarihi) as row_id,
                                                              t.tcno,
                                                              t.hastane_kodu,
                                                              t.tercih_sira
                                                         FROM aciktan_atama_tercihler t
                                                        where t.silindi = '0'
                                                        GROUP BY tcno,
                                                                 hastane_kodu,
                                                                 tercih_sira) KeepRows ON aciktan_atama_tercihler.eklenme_tarihi = KeepRows.row_id
 WHERE KeepRows.row_id IS NULL
   and aciktan_atama_tercihler.silindi = '0' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:39:03.130

假设您要从`aciktan_atama_tercihler`表中删除记录：

```
DELETE FROM aciktan_atama_tercihler
 WHERE ROWID IN (SELECT aciktan_atama_tercihler.rowid
                   FROM aciktan_atama_tercihler  
        LEFT OUTER JOIN (SELECT MIN(t.eklenme_tarihi) as row_id,
                                t.tcno,
                                t.hastane_kodu,
                                t.tercih_sira
                           FROM aciktan_atama_tercihler t
                          WHERE t.silindi = '0'
                       GROUP BY tcno,
                                hastane_kodu,
                                tercih_sira) KeepRows ON aciktan_atama_tercihler.eklenme_tarihi = KeepRows.row_id
     WHERE KeepRows.row_id IS NULL
       and aciktan_atama_tercihler.silindi = '0') 
```

# javascript - 如何在 $.ajax( 中使用 if 语句并检查字符串响应？

> ID：14862586
> 
> 赞同：0
> 
> 时间：2013-02-13T20:34:45.330
> 
> 标签：javascript, jquery

我正在尝试在 ajax 发布请求中进行这个简单的比较。我只想检查不同字符串值的发布响应，但它永远不会起作用。即使我确定 php 响应是字符串“mango”，弹出函数也不会被调用，你们能告诉我我在这里做错了什么吗？

```
$.ajax(
{
    type: 'POST',
    url: './doit1.php',

     data: {
     title: 'test',

     },
     success: function (good)
     {
              //handle success
              if($(good) =='mango')
             {
                popitup('./doit1.php?action=stop')
                //alert(good)
             else if ($(good) =='orange')
             {
                 //do something
             }
             else
             {
                //default action
             }
      },
      failure: function (bad)
      {
          //handle any errors
          alert(bad)

      }
});

function popitup(url) {
    newwindow=window.open(url,'name','height=200,width=150');
    if (window.focus) {newwindow.focus()}
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:38:13.550

您正在尝试在此处围绕返回的数据包装一个 jQuery 包装器：

```
if($(good) =='mango') 
```

这是不正确的，因为`good`在这种情况下需要一个 DOM 元素才能使 this 具有任何意义。

如果`good`只是一个返回的字符串值，你应该这样做：

```
if(good == 'mango') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:38:57.917

不知道`good`是什么很难说。然而，`$()` *总是*返回一个不利于任何类型比较的 jQuery 集合对象。您可能只想使用`good == 'mango'`或`switch`. 也许是`good.fruit == 'mango'`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:38:25.753

当它应该作为字符串放入时，你在 jQuery 中包装得很好。

将成功函数替换为。

```
success: function (good){
  //handle success
  if(good==="mango"){
    popitup('./doit1.php?action=stop')
  }else if(good==="orange"){
    //Do something
  }else{
    //Default Action
  }
} 
```

# ruby-on-rails - 对依赖项 API 的请求期间出现错误 Bundler::HTTPError

> ID：14862589
> 
> 赞同：1
> 
> 时间：2013-02-13T20:34:51.707
> 
> 标签：ruby-on-rails, ruby, installation, bundle

运行时我不断收到以下错误`bundle`

```
Error Bundler::HTTPError during request to dependency API 
```

这是红宝石问题还是其他问题？

另外，我已阅读添加

```
source "http://bundler-api.herokuapp.com" 
```

在您的 Gemfile 中。将解决这个问题。那么在这种方法中是从heroku而不是rubygems获取宝石吗？这有多安全和稳定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:07:17.127

此错误可能表明您与 Internet 的连接已断开。

关于`source`你的方法的参数`Gemfile`，我对此一无所知，但是url不起作用，我建议你避免这种情况。如果您不想使用特定或特定的存储库来下载您的 gem，您应该使用“默认”`source "http://rubygems.org"`指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T17:20:26.577

对我来说，将 Gemfile 中的源更改为非 HTTPS URL 是可行的：

`http://rubygems.org`

可能不理想，但今天在我的位置使用 https 的东西不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:31:27.137

您的问题的答案在这里：[https ://groups.google.com/d/msg/rubygems-org/aBHBOCgH6UE/1p_Kde3BlGgJ](https://groups.google.com/d/msg/rubygems-org/aBHBOCgH6UE/1p_Kde3BlGgJ)

从那篇文章的作者所说，这个错误是无害的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-25T19:06:32.820

我不认为这是红宝石问题。

检查这些东西：

1.使用 Gemfile 中的 Source 作为[https://rubygems.org](https://rubygems.org)。

2.您的互联网连接没有中断。（*有时，它会因此而发生。*）

# python - 为什么 Python 中的 Help() 函数不适用于任何输入

> ID：14862590
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:34:52.100
> 
> 标签：python, helper

例如，如果您 write `help(list)`，您将获得有关列表对象的帮助。如果你写`help(+)`，你会得到`SyntaxError: invalid syntax` 这是为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T20:36:28.497

`help`是一个普通函数，所以它像任何其他函数一样接受参数。`help(list)`是有效的语法：它将`list`类型传递给`help`.

然而，`help(+)`是非法的语法（+ 是一个运算符，而不是一个表达式本身）。在这种情况下，您可以使用`help('+')`来获取`+`操作员的帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T20:36:15.490

这是因为[`help`](http://docs.python.org/2/library/functions.html#help)它只是一个函数——它的参数必须是一个语法上有效的表达式，它的计算结果是一个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:47:26.807

在某些语言中，您实际上可以直接将运算符作为值传递（例如，`+`是 Lisp 中的普通函数）或使用特殊语法（例如，`(+)`将`+`运算符作为 Haskell 中的普通函数）。但在 Python 中并非如此。

`+`运算符当然可以通过给它两个操作数 ( ) 或一个 ( )来成为表达式的一部分*，*但是没有办法访问运算符本身的值。（部分原因是因为实际上是三个不同的运算符——一元加法、二元加法和二元连接，所以没有上下文就连“运算符的值”这样的东西都没有。但即使对于这样的运算符也是如此没有歧义。）`2+3``+3``+``+``+`

这与类型和函数不同，如您所见：

```
>>> list
builtins.list
>>> abs
<function builtins.abs>
>>> +
SyntaxError: invalid syntax 
```

所以，你可以将`list`or`abs`作为参数传递给一个函数——包括`help`——但你不能用`+`.

这就是 Python 具有该[`operator`](http://docs.python.org/2/library/operator.html)模块的原因，它可以为您提供可以传递的“操作符作为函数”：

```
>>> import operator
>>> operator.add
<function operator.add> 
```

但这在这种情况下并不是特别有用：

```
>>> help(operator.add)
add(...)
    add(a, b) -- Same as a + b. 
```

谢谢……</p>

幸运的是，该`help`函数具有处理字符串的特殊代码。请参阅 nneonneo 的答案，了解您真正想要的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T20:43:46.643

那是因为 + 是一个运算符，它包含两个操作数，你可以这样做：

```
help(1+1) 
```

因为 1+1 返回一个 int，所以 help 会给你一些关于 int 数据类型的信息

# java - Scala/Java：生成一组不重复的随机数

> ID：14862602
> 
> 赞同：1
> 
> 时间：2013-02-13T20:35:33.960
> 
> 标签：java, scala, random

我需要从 Scala 中的列表中随机抽取 n 个元素的子集，我想知道是否有一种方便的方法可以做到这一点，而无需手动检查 n 个元素中的每一个是否都是唯一的。目前我有这样的事情：

```
import util.Random

def sample(itms:List[A], sampleSize:Int) {
  var numbersSeen = Set[Int]()
  var sampled = List[A]()
  val itmLen = itms.size()
  var sampleIdex = Random.nextInt(itmLen)
  while(sampled < sampleSize) {
    if(numbersSeen.contains(sampleIdex)){
      sampleIdex = Random.nextInt(itmLen)
    } else {
      numbersSeen.add(sampleIdex)
      sampled.add(itms(sampleIdex))
    }
  }
  sampled
} 
```

我希望有一些更优雅的方法可以生成一个范围内整数的非重复随机列表，或者从列表中随机采样 n 个元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T00:03:13.890

如果您的列表不是太长，您可以随机排列索引编号列表，然后遍历该列表。

在 Scala 中，这将是这样的：

```
val aList = ('A' to 'Z').toList

val aListIterator = scala.util.Random.shuffle((0 until aList.length).toList).toIterator 
```

然后在你的循环结构中：

```
...
if( aListIterator.hasNext ) aList(aListIterator.next)
... 
```

如果您的列表很大，则返回列表大小范围内的唯一随机数（用作索引）的函数可能是更好的方法。Jeff Preshing 最近发表了一篇关于唯一随机数的博客，[http](http://preshing.com/20121224/how-to-generate-a-sequence-of-unique-random-integers) ://preshing.com/20121224/how-to-generate-a-sequence-of-unique-random-integers 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T21:51:43.890

您可以随机选择一个，然后从列表中采样，除了您刚刚选择的那个之外，使用 simpleSize-1 （tail-）递归：

```
 def sample[A](itms:List[A], sampleSize:Int) = {

        def collect(vect: Vector[A], sampleSize: Int, acc : List[A]) : List[A] = {
            if (sampleSize == 0) acc
            else {
                val index = Random.nextInt(vect.size)
                collect( vect.updated(index, vect(0)) tail, sampleSize - 1, vect(index) :: acc)
            }
        }

        collect(itms toVector, sampleSize, Nil)
    }                                 //> sample: [A](itms: List[A], sampleSize: Int)List[A]

    sample(1 to 10 toList, 5)         //> res0: List[Int] = List(6, 8, 2, 1, 10) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T21:24:20.617

```
itms.map(x => (x, util.Random.nextDouble)).sortBy(_._2).take(sampleSize).map(_._1) 
```

只要您不关心排序的低效率。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:02:46.723

您可以从子集中抽取随机样本，即：

```
val distinctSubsets = itms.to[Set].subsets(sampleSize) 
```

然后随机选择其中之一。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-13T21:11:58.853

这种方法怎么样？

```
trait RandomOrdering[T] extends Ordering[T]

object RandomOrdering {
  implicit def defaultOrdering[T] = new RandomOrdering[T] {
    def compare(x:T, y:T) = (Random nextInt 3) - 1
  }
}

def sample[A](items:List[A], sampleSize:Int)(implicit r:RandomOrdering[A]) =
  items.sorted take sampleSize 
```

它可能性能较差，但它也允许您注入不同的`RandomOrdering`.

# html - HTML-CSS 在链接中水平和垂直居中文本

> ID：14862604
> 
> 赞同：45
> 
> 时间：2013-02-13T20:35:38.800
> 
> 标签：html, css, vertical-alignment

我正在尝试创建一个具有200px`height`和 a的链接。`width`链接的文本应垂直和水平居中。

到目前为止，这是我的 CSS：

```
a:link.Kachel {
  width: 200px;
  height: 200px;
  margin: 0 auto;
  display: block;
  text-align: center;
  background: #383838;
  display: -webkit-box;
  display: -moz-box;
  display: box;
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
} 
```

这是HTML代码：

```
<tr>
  <td>
    <a class="Kachel" href="#">Test</a>
  </td>
</tr> 
```

文本水平居中但不是垂直居中。

知道如何使文本水平和垂直居中吗？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2013-02-13T20:39:39.860

删除所有其他废话，然后替换`height`为`line-height`

```
a:link.Kachel{
   width: 200px;
   line-height: 200px;
   display: block;
   text-align: center;
   background: #383838;
} 
```

**jsfiddle：http: [//jsfiddle.net/6jSFY/](http://jsfiddle.net/6jSFY/)**

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2018-06-04T07:35:44.827

在 CSS3 中，您可以使用 flexbox 来实现这一点，而无需任何额外的元素。

```
.link {
    display: flex;
    justify-content: center;
    align-items: center;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-13T20:39:48.070

如果文本仅在一行上，您可以使用`line-height:200px;`- 其中 200px 与`height`值相同。

如果文本位于多行并且始终位于相同数量的多行上，则可以使用`padding`组合 with `line-height`。2行示例：

```
line-height:20px;
padding-top:80px; 
```

这样，两条线总共将占用 40px 并且填充顶部将它们完美地放在中间。请注意，您需要`height`相应地调整。

[JSFiddle 示例](http://jsfiddle.net/ryS7u/)。

如果有多个链接并且它会有任意数量的行，您将需要一些随附的 JavaScript 来*修复*每个链接的填充。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-10T09:48:18.217

如果不知道行数（或内部元素高度），还有另一个技巧使用`display: table`and `vertical-align`：

```
.wrapper{
    display: table;
}
.link{
    display: table-cell;
    vertical-align: middle;
} 
```

[例子](https://jsfiddle.net/strae/ps6w08x2/)

[包含详细信息的完整文章](https://css-tricks.com/vertically-center-multi-lined-text/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-19T17:15:29.003

补充一点。如果删除下划线（文本装饰：无；），则文本将不会完全垂直居中。链接为下划线留出空间。据我所知，除了添加一点额外的顶部填充之外，没有其他方法可以覆盖它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-03T23:55:38.740

也许使用填充？像：

```
padding-top: 50%; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-17T07:29:35.053

在 CSS3 中，您可以尝试使用`line-break`justify 文本。

```
text-align: justify;
line-break: anywhere; 
```

# javascript - JQuery 选择器中的变量不起作用

> ID：14862607
> 
> 赞同：0
> 
> 时间：2013-02-13T20:35:52.787
> 
> 标签：javascript, jquery, variables, jquery-selectors

我有一个函数，它采用 x 和 y 值，并使用表格的行和列，找到给定的单元格。查询：

```
function changeNum(x,y,num)
{
    var thisRow = $(".sudoku:nth-child("+y+")");
    var thisCell = $(thisRow+":nth-child("+x+")");
} 
```

声明中的某些`thisCell`内容导致 javascript 停止。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:37:24.983

`thisRow`是一个 jQuery 集合，而不是一个字符串。用这个 ：

```
var thisCell = $(":nth-child("+x+")", thisRow); 
```

您也可以直接使用

```
var thisCell = $(".sudoku:nth-child("+y+") :nth-child("+x+")"); 
```

请注意，如果`sudoku`是表的类而不是行的类，那么在`.sudoku`and之间需要一个空格`:nth-child`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:40:13.410

尝试用 ""+ 引导

var thisCell = $(""+thisRow+":nth-child("+x+")");

# ruby-on-rails - 模块的 ActiveRecord 验证

> ID：14862609
> 
> 赞同：0
> 
> 时间：2013-02-13T20:35:55.470
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我在每个模型中都有验证。我还在我的 lib 文件夹中定义了一个模块，其中包含更新我的模型的方法。如何让我在模型中定义的验证适用于我的模块中的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:52:33.613

你可以这样做：

```
class MyValidator < ActiveModel::Validator
  def validate(record)
    unless MYLIB::isthisgood(record.name)
      record.errors[:base] << "Name is No Good"
    end
  end
end

class MyModel < ActiveRecord::Base
  validates_with MyValidator
end 
```

# magento - 在 Magento 中显示可配置产品的简单产品库存

> ID：14862612
> 
> 赞同：3
> 
> 时间：2013-02-13T20:36:03.940
> 
> 标签：magento, inventory, configurable-product

我对 Magento 很陌生。据我了解，我需要形成可配置的产品，以管理不同尺寸的产品。我想在产品视图页面中分别显示每种尺寸的库存数量。这可能吗？我的属性名称是“大小”。我已使用以下代码获取库存数量。但是，它无法获得可配置产品的单个简单产品的库存数量。

```
<?php   
$__manStock = $_product->getStockItem()->getManageStock();

$__invAmt =(int)Mage::getModel('cataloginventory/stock_item')->loadByProduct($_product)->getQty('small');
if ($__manStock > 0)
    {
    echo $this->__("$__invAmt");
    }
?> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-15T09:00:40.200

`$_product`是您的可配置产品。

要获得所有简单的产品，请使用：

```
$_product->getTypeInstance(true)->getUsedProducts ( null, $_product); 
```

所以你可能有类似的东西：

```
foreach ($_product->getTypeInstance(true)->getUsedProducts ( null, $_product) as $simple) {
     $stock = Mage::getModel('cataloginventory/stock_item')->loadByProduct($simple)->getQty();
     echo $simple->getName()." with size ".$simple->getSize()." have a stock of $stock";
     echo '<br/>';
 } 
```

我让您适应您的确切需求并在需要时提出问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-03T20:04:42.037

我将所有产品求和为一个数字并在没有逗号的情况下对其进行四舍五入：

```
$itemsinstock = 0;
foreach ($_product->getTypeInstance(true)->getUsedProducts ( null, $_product) as $simple) {
    $stock = Mage::getModel('cataloginventory/stock_item')->loadByProduct($simple)->getQty();
    $stock = round($stock,2);
    echo $simple->getName()." : $stock pieces";
    echo '<br/>';
    $itemsinstock+= $stock;
}
echo $itemsinstock; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-24T04:44:11.620

请告诉我将添加波纹管代码的文件位置。

```
foreach ($_product->getTypeInstance(true)->getUsedProducts ( null, $_product) as $simple) {
  $stock = Mage::getModel('cataloginventory/stock_item')->loadByProduct($simple)->getQty();
  echo $simple->getName()." with size ".$simple->getSize()." have a stock of $stock";
  echo '<br/>';
} 
```

# xcode - 查找正在使用的 segue

> ID：14862621
> 
> 赞同：0
> 
> 时间：2013-02-13T20:36:30.147
> 
> 标签：xcode, storyboard, segue

我正在使用从各种 segue 链接的详细视图控制器。我想`viewDidLoad`根据哪个控制器正在推动详细控制器来执行操作。

有没有办法可以找出哪个 segue 正在加载细节控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:43:38.227

如果为详细 VC 设置委托，则可以使用[NSStringFromClass 。](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/c/macro/NSLocalizedString)另一种方法是在`prepareForSegue:`方法中设置 ID，然后将其传递给细节 VC 或在委托上调用 getter。

```
NSString *class = [NSStringFromClass([self.delegate class]); 
```

--

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
     if ([[segue identifier] isEqualToString:@"scrollerSegue"])
     {
         ScrollViewController * target = segue.destinationViewController;
         target.VC_Which_Pushed_ME = self.ID;

         // and/or
         target.delegate = self;
     }
} 
```

# javascript - 仅为国际访客显示国际电话格式

> ID：14862626
> 
> 赞同：1
> 
> 时间：2013-02-13T20:36:39.750
> 
> 标签：javascript, jquery, html

我想知道是否有我可以使用的 Javascript，因此当国际访问者（非美国）访问我的网站时，他们会看到他们可以遵循的国际电话格式。基本上将“值”更改为国际电话格式示例。

这是我拥有的输入字段的代码...

```
<input id="phone" class="numphone" maxlength="255" 
    name="Phone_Number" type="text" tabindex="6" 
    value="(555) 123-4567" 
    onblur="if (this.value == '') {this.value = '(555) 123-4567';}" 
    onfocus="if (this.value == '(555) 123-4567') {this.value = '';}"
/> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:03:03.707

对于此类概念的任何有意义的定义，无法以编程方式检测访问者是“国际”还是“非美国”。使用地理定位和其他工具，您或许可以在可接受的误差范围内确定用户的设备是否位于美国境内。但这不会告诉您用户是访问美国的欧洲或亚洲商人，还是在美国境外使用计算机的美国公民。

此外，由于这似乎与*输入*格式有关，您应该简单地要求用户以国际格式输入电话号码，但如果缺少国家前缀（*或*提示输入更正信息），则可能暗示美国。您应该解析电话号码，以便忽略“(”、“)”、“-”和空格，因为它们不携带相关信息，但通常由熟悉此类符号的人输入。

# angularjs - 无法将查询传递给 $resource 服务

> ID：14862628
> 
> 赞同：0
> 
> 时间：2013-02-13T20:36:53.307
> 
> 标签：angularjs

我有一个查询 PHP 脚本的控制器（通过 $resource 服务）。PHP 返回 JSON。控制器使用来自 ng-model 的输入，称为“userUsername”。我可以看到没有任何东西被发送到 PHP 文件。我在控制台中返回这个：

```
h {usernameTyped: null, $get: function, $save: function, $query: function, $remove: function…} 
```

**应用程序.js**

```
var userAppModule = angular.module("userApp", ["ngResource"]);
userAppModule.factory("User", function($resource) {
    return $resource("php/login-process.php/:username", {}, {
        query: {method: "GET"}
    });
}); 
```

**控制器.js**

```
function LoginCtrl($scope, $route, $routeParams, $location, User) {
    $scope.loginUser = function() {
        $scope.userQuery = User.query({username: $scope.userUsername}, function(res) {
            console.log(res);
        });
    }
} 
```

我想我的控制器功能可能有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:42:29.593

你几乎是对的：问题是回调。在您的情况下，第一个参数`res`实际上是资源对象。

在这种情况下，您不需要该回调，因为`ngResource`其设计目的是在常见情况下无需回调即可工作：

```
function LoginCtrl($scope, $route, $routeParams, $location, User) {
    $scope.loginUser = function() {
        $scope.user = User.query({username: $scope.userUsername});

        // Just throwing a watch in here to see what happens
        // to $scope.user
        $scope.$watch('user', function(newValue, oldValue) {
            console.log("user:", newValue, oldValue);
        });
    }
} 
```

您将看到一个条目立即出现在控制台中，这是`$resource`将分配给您的范围对象的空数据。

当数据最终从服务器返回时，它将被分配给`$scope.user`变量，您应该会在控制台中看到第二个条目，其中包含来自服务器响应的数据。

# objective-c - 如何编辑字符串？

> ID：14862631
> 
> 赞同：0
> 
> 时间：2013-02-13T20:36:56.593
> 
> 标签：objective-c

如何编辑字符串？

```
[mySLComposerSheet setInitialText:]; 
```

我需要一个带有引号的字符串，然后是一个名为的字符串`self.quote.text`，然后是另一个引号，然后是一个破折号，然后是一个连字符，然后是一个名为 的字符串`self.quote.text`，然后是另一个常量字符串。我已经尝试过，但我不知道该怎么做。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:39:30.003

关键是[`NSMutableString`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableString_Class/Reference/Reference.html)班级。它有一堆简单的字符串创建和附加功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:40:24.717

试试`[mySLComposerSheet setInitialText:[NSString stringWithFormat:@"\"%@\"-_%@", self.quote.text, self.quote.text, self.quote.text]];`。希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:41:33.733

本质上，您要做的是创建一个包含常量和变量元素的字符串。您可以使用`NSString`的类方法来做到这一点`stringWithFormat:`。例如：

```
NSString *resultingString = [NSString stringWithFormat:@"'%@'-%@constant", self.quote.text, self.quote.text]; 
```

# c# - 检测每个任务何时完成

> ID：14862632
> 
> 赞同：0
> 
> 时间：2013-02-13T20:37:08.033
> 
> 标签：c#, task-parallel-library, task

当每个任务在下面完成时，我想更新一个进度条。

方法 var continuation2 = Task.Factory.ContinueWhenAny(..... 不起作用。

这样做的正确方法是什么？

**C# 代码**

```
 private void radButtonInsertManyErrors_Click(object sender, EventArgs e)
        {
            try
            {
                radProgressBarStatus.Maximum = int.Parse(radTextBoxNumberofErrorsInsert.Text);
                radProgressBarStatus.Value1 = 0;

                Task<int>[] tasks = new Task<int>[int.Parse(radTextBoxNumberofErrorsInsert.Text)];

                for (int i = 0; i < int.Parse(radTextBoxNumberofErrorsInsert.Text); i++)
                {
                    int x = i;
                    tasks[i] = new Task<int>(() =>
                    {

                        //insert the error into table FA_Errors
                        Accessor.Insert_FAErrors(BLLErrorCodes.BLL_Error_Codes.Error_Log_Event_Login.ToString(),
                                                     (int)BLLErrorCodes.BLL_Error_Codes.Error_Log_Event_Login,
                                                     "Some Error", "",
                                                 MethodBase.GetCurrentMethod().DeclaringType.Namespace.ToString(),
                                                 MethodBase.GetCurrentMethod().Name.ToString(),
                                                 BLLErrorCategory.BLL_Error_Category.WEB_APP.ToString(),
                                                "pc source", "damo",
                                                 sConn.ToString());
                        return 1;

                    });
                }

                var continuation = Task.Factory.ContinueWhenAll(
                            tasks,
                            (antecedents) =>
                            {
                                RadMessageBox.Show("Finished inserting errors ");
                            });

                var continuation2 = Task.Factory.ContinueWhenAny(
                tasks,
                (antecedents) =>
                {
                        radProgressBarStatus.Value1++;

                });

                for (int i = 0; i < int.Parse(radTextBoxNumberofErrorsInsert.Text); i++)
                    tasks[i].Start();
                // Use next line if you want to block the main thread until all the tasks are complete
                //continuation.Wait();

            }
            catch (Exception ex)
            {

                MessageBox.Show(ex.Message.ToString());

            }   

        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:03:38.550

您可以使用此功能：

```
public static void TaskProgress(IEnumerable<Task> tasks, Action<int> callback)
{
    int count = 0;
    foreach (var task in tasks)
        task.ContinueWith(t => callback(Interlocked.Increment(ref count)));
} 
```

每次任务以当前完成的任务数完成时，它将调用回调。请注意，回调不是同步的，因此可以在前一个回调仍在运行时调用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:48:28.797

为每个任务设置一个延续。保留一个（线程安全的）计数器来记录完成的数量，并在每个任务完成时更新 UI。

实际上，`Task.WhenAll`确实在引擎盖下保留了这样一个计数器。它只是无法访问。

# c# - 如何跟踪每个调用的方法

> ID：14862635
> 
> 赞同：30
> 
> 时间：2013-02-13T20:37:39.580
> 
> 标签：c#, logging, trace

我有一个现有的项目，我想找出所有正在拨打的电话，并可能转储到日志文件中。

我看了[一下这个线程](https://stackoverflow.com/questions/559148/how-can-i-add-a-trace-to-every-method-call-in-c)，但没有太大帮助。我试过 PostSharp，这个例子展示了如何实现它。但是我需要为每个该死的方法添加一个属性。作为一个现有的项目，有很多方法，这不是一个可行的选择。

是否有任何其他方法可以让我快速追踪所有拨打的电话？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T20:40:03.570

您可以使用[Unity 拦截来做到这一点](http://msdn.microsoft.com/en-us/library/ff647107.aspx)

[有关示例，](http://www.codeproject.com/Tips/322695/Unity-2-0-Interception-via-Method-Decoration-in-ve)请参阅本文。本文使用属性，但我下面的代码示例使用依赖注入系统（编码到接口）来设置拦截。

如果你想登录`MyClass`，它是这样的：

1.  创建一个包含`MyClass`=>中所有方法的接口`IMyClass`
2.  您设置 InterfaceInterception （就像我在下面所做的那样）或者您可以通过其他一些方式来设置它。请参阅[此处了解所有选项](http://msdn.microsoft.com/en-us/library/ff660861%28v=pandp.20%29.aspx)。
3.  您将设置一个策略来拦截所有匹配的方法`IMatchingRule`。
4.  现在，所有调用都将被您的[ICallHandler](http://msdn.microsoft.com/en-us/library/microsoft.practices.unity.interceptionextension.icallhandler%28v=pandp.20%29.aspx)实现拦截。

代码：

```
//You  will use the code like this:
MyContainer container = new MyContainer();
//setup interception for this type..
container.SetupForInteception(typeof(IMyClass));
 //what happens here is you get a proxy class 
 //that intercepts every method call.
IMyClass cls = container.Resolve<IMyClass>();

 //You need the following for it to work:   
public class MyContainer: UnityContainer
{
    public MyContainer()
    {
        this.AddNewExtension<Interception>();
        this.RegisterType(typeof(ICallHandler), 
                    typeof(LogCallHandler), "MyCallHandler");
        this.RegisterType(typeof(IMatchingRule), 
                       typeof(AnyMatchingRule), "AnyMatchingRule");

        this.RegisterType<IMyClass, MyClass>();
    }
    //apparently there is a new way to do this part
    // http://msdn.microsoft.com/en-us/library/ff660911%28PandP.20%29.aspx

    public void SetupForInteception(Type t)
    {
        this.Configure<Interception>()
        .SetInterceptorFor(t, new InterfaceInterceptor())
        .AddPolicy("LoggingPolicy")
        .AddMatchingRule("AnyMatchingRule")
        .AddCallHandler("MyCallHandler");

    }
}
//THIS will match which methods to log.
public class AnyMatchingRule : IMatchingRule
{
    public bool Matches(MethodBase member)
    {
        return true;//this ends up loggin ALL methods.
    }
}
public class LogCallHandler : ICallHandler
{
    public IMethodReturn 
             Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
    {
      //All method calls will result in a call here FIRST.
      //IMethodInvocation has an exception property which will let you know
      //if an exception occurred during the method call.
    }
 } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-13T21:06:45.723

在跟踪模式下使用 Profiler。然后你会看到一切是如何相互调用的，以及时间都花在了哪里。除了商业分析器，还有免费的。对于托管代码，[NP Profiler](http://blogs.msdn.com/b/webapps/archive/2012/11/23/troubleshooting-performance-issues-in-windows-store-apps.aspx)非常好。

如果您想更深入地了解，可以使用[Windows Performance Toolkit](http://geekswithblogs.net/akraus1/archive/2012/12/19/151604.aspx)，它为您提供所有线程的完整信息，以及如果您想知道它们之间的交互方式。唯一的区别是您获得了从内核到托管帧的堆栈。

如果这还不够，您可以使用跟踪库（自动使用 PostSharp，...）或手动或使用每个源文件的宏来检测您的代码。我制作了一个非常快速且高度可配置的小型跟踪库。见[这里](http://geekswithblogs.net/akraus1/archive/2010/07/04/140761.aspx)。作为独特的功能，它可以自动跟踪任何抛出的异常。

```
private void SomeOtherMethod()
{
  using (Tracer t = new Tracer(myType, "SomeOtherMethod"))
  {
      FaultyMethod();
  }
}

private void FaultyMethod()
{
   throw new NotImplementedException("Hi this a fault");
} 
```

输出如下：

```
 18:57:46.665  03064/05180 <{{         > ApiChange.IntegrationTests.Diagnostics.TracingTests.SomeMethod  
    18:57:46.668  03064/05180 <{{         > ApiChange.IntegrationTests.Diagnostics.TracingTests.SomeOtherMethod  
    18:57:46.670  03064/05180 <         }}< ApiChange.IntegrationTests.Diagnostics.TracingTests.SomeOtherMethod Exception thrown: System.NotImplementedException: Hi this a fault    
at ApiChange.IntegrationTests.Diagnostics.TracingTests.FaultyMethod()  
at ApiChange.IntegrationTests.Diagnostics.TracingTests.SomeOtherMethod()  
at ApiChange.IntegrationTests.Diagnostics.TracingTests.SomeMethod()    
at ApiChange.IntegrationTests.Diagnostics.TracingTests.Demo_Show_Leaving_Trace_With_Exception() 

18:57:46.670  03064/05180 <         }}< ApiChange.IntegrationTests.Diagnostics.TracingTests.SomeOtherMethod Duration 2ms 18:57:46.689  03064/05180 <         }}< ApiChange.IntegrationTests.Diagnostics.TracingTests.SomeMethod Duration 24ms 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-13T21:33:03.813

PostSharp 确实提供了一种将方面应用于多个目标的方法，而无需显式地用属性装饰它们。请参阅[多播属性](http://doc.sharpcrafters.com/postsharp-2.1/##PostSharp-2.1.chm/html/1B05CE59-61DE-4043-8E7C-12C130B1ACBB.htm)。

在开发（多播）方面时，您必须指定其用法：

```
[MulticastAttributeUsage(MulticastTargets.Method, TargetMemberAttributes = MulticastAttributes.Instance)]
[AttributeUsage(AttributeTargets.Assembly|AttributeTargets.Class|AttributeTargets.Method, AllowMultiple = true)]
[Serializable]
public class TraceAttribute : MethodInterceptionAspect
{
// Details skipped.
} 
```

然后以涵盖您的用例的方式应用方面（例如 AdventureWorks.BusinessLayer 命名空间中的所有公共成员）：

```
[assembly: Trace( AttributeTargetTypes="AdventureWorks.BusinessLayer.*", AttributeTargetMemberAttributes = MulticastAttributes.Public )] 
```

# c++ - 保持对象存活的问题

> ID：14862639
> 
> 赞同：0
> 
> 时间：2013-02-13T20:37:53.150
> 
> 标签：c++

我遇到了一个奇怪的问题，对我来说没有任何意义。

我在定义如下的 API 上有一个结构（包含字符串）：

```
typedef struct sNCharcb
{
    char * pData;
    int    iDataLen;
}
tsNCharcb; 
```

我需要保存这个结构的深层副本。我创建了一个实用函数来复制这个结构：

```
inline sNCharcb rapi_strcpy(const sNCharcb &rapistr)
{
    sNCharcb res;

    res.pData = new char[rapistr.iDataLen];
    strcpy(res.pData, rapistr.pData);
    res.iDataLen = rapistr.iDataLen;

    return res;
} 
```

我使用此实用程序方法创建这些“sNCharcb”结构的副本并将它们保存到父对象中的引用变量：

```
stored_sNCharcb = rapi_strcpy(sNCharcb_to_copy); 
```

不久之后，这些存储的值被神奇地更改为包含一些随机垃圾。存储这些值的父对象一直在作用域内，并且不会被破坏。什么可能导致这些值过早地被擦除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:53:33.030

NULL中的数据是否`pData`终止？如果不是，则`strcpy`调用`rapi_strcpy`可能会结束，因此复制超出了目标中分配的大小。

您可能想要使用强制长度的东西，例如`strncpy`or `memcpy`：

```
strncpy(res->pData, rapistr.pData, rapistr.iDataLen); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:42:26.050

> 不久之后，这些存储的值被神奇地更改为包含一些随机垃圾。

假设它`stored_sNCharcb`在退出时有效`rapi_strcpy()`，然后`stored_sNCharcb`在以后更改，这表明您未显示的代码在不`stored_sNCharcb`应该被覆盖时被覆盖，例如由于缓冲区溢出等。`stored_sNCharcb`我建议你在退出后放置一个数据断点`rapi_strcpy()`，然后让调试器告诉你它是否正在被修改，这样你就可以准确地看到哪些代码正在修改它。

# asynchronous - SMPP 可选参数

> ID：14862644
> 
> 赞同：1
> 
> 时间：2013-02-13T20:38:03.957
> 
> 标签：asynchronous, match, correlation, smpp

美好的一天，伙计们！我目前正在使用通过 SMPP 发送消息的 JMS 队列的系统（使用 Logica SMPP 库）。

我的问题是我需要将一个内部 ID（我们在系统内管理）附加到消息序列 ID，以便在异步模式下我收到响应时，可以对该特定消息采取适当的操作。

我尝试实现的第一个选项是使用为 SMPP 3.4 建立的可选参数。我没有收到响应中的可选参数（我读过响应附加了可选参数，具体取决于提供者）。

第二种方法是在内存中保留这些消息的映射，直到收到它们的响应（它使内存饱和，所以这是不行的）。

任何人都可以想出一个可行的解决方案，在异步 SMPP 环境中将消息的内部系统 ID 与其序列号相关联吗？

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T16:18:56.980

您需要保留 seq_nr - 内部消息 ID 的映射，并在收到 SMSC 的异步响应后立即从该映射中删除。它不应该使内存饱和，因为它只会保留飞行消息，但您需要定期迭代地图并删除孤立的条目（因为有时您不会从 smsc 得到回复）。

# java - 正则表达式提取 URL 的第一部分

> ID：14862647
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:38:04.617
> 
> 标签：java, regex

我需要一个 java 正则表达式来提取 URL 的一部分。

例如，采用以下 URL：

```
http://localhost:81/example
https://test.com/test
http://test.com/ 
```

我希望我的正则表达式返回：

```
http://localhost:81
https://test.com
http://test.com 
```

我将在 Java 修补程序中使用它。

这是我到目前为止所拥有的，问题是它需要整个 URL：

```
^https?:\/\/(?!.*:\/\/)\S+ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T20:41:32.203

```
import Java.net.URL

//snip

URL url = new URL(urlString);
return url.getProtocol() + "://" + url.getAuthority(); 
```

正确工作的正确工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T21:12:54.593

建立你的尝试，试试这个：

```
^https?://[^/]+ 
```

我假设您要捕获所有内容，直到第一个/之后 http://? （这就是我从你的例子中得到的——如果没有，请多发一些）。

这些 URL 是作为一个输入给出的，还是每个都是不同的字符串？

**编辑：**有人指出存在不必要的转义，因此固定为更精简的版本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:43:40.743

语言无关答案：

对于空格：替换`/^\s+/`为空字符串。

对于从 URL 中删除路径信息，如果您可以假设路径中没有任何斜杠（即您没有处理`http://localhost:81/foo/bar/baz`），请替换`/\/[^\/]+$/`为空字符串。如果可能有更多的斜线，您可以尝试`/(^\s*.*:\/\/[^\/]+)\/.*/`使用`$1`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T21:39:04.597

一个简单的：`^(https?://[^/]+)`

# javascript - JavaScript 代码未运行

> ID：14862652
> 
> 赞同：0
> 
> 时间：2013-02-13T20:38:18.387
> 
> 标签：javascript

我有以下代码：

```
...<some code>...
...<elements load>...

<script type="text/javascript">

    var selected_city = document.getElementById('jform_city').value;
    var selected_province=document.getElementById('jform_province').value;

    <!-- set the onchange property for all options in provice to activate getCities() -->
    document.getElementById('jform_province').onchange = function() {
        getCities();
    }

    if(selected_province != ''){
        getCities();
    }
</script>

...<more elements load>....

<script type="text/javascript">
    alert("TEST");
    document.getElementById(selected_city).selected="1";
    </script> 
```

它从我拥有的下拉列表中选择一个选项，问题是，如果我删除**警报（“”）**它由于某种原因停止工作，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:39:37.140

在尝试使用之前，您需要等待文档加载`document.getElementById`。警报使事情变慢，以至于在警报框后面，元素被加载。如果没有警报，当运行以下行时，很可能*没有*“selected_city”元素。

查看[这个 StackOverflow 问题](https://stackoverflow.com/questions/978740/javascript-how-to-detect-if-document-has-loaded-ie-7-firefox-3)，了解有关等待页面加载的更多信息。

编辑

首先，当 Web 浏览器解析页面时，它会将接收到的 HTML 元素转换为 DOM——文档对象模型，它是页面的内存表示。只有在元素进入 DOM 之后才有可能对其进行操作，而且元素进入 DOM 的顺序不一定与它们在 HTML 中出现的顺序相同：现代快速浏览器非常异步地运行，只保证页面最终看起来*好像*整个事情是同步加载的。这很容易验证：几乎每个浏览器都会加载文本，甚至在获取图像时显示文本。只有在获取图像后，它才会将其插入到显示器中，如果必须的话，它会推动/重排文本。最终结果是相同的，但页面似乎以这种方式加载得更快。

不幸的是，这种“等待它”的保证不适用于 Javascript（因为 JS 本身可以改变页面加载的方式）。因此，简单地将 script 标签移动到文档的末尾与等待 DOM 包含该元素并不是一回事。

您实际上必须等待浏览器给您回电并告诉您 DOM 已加载——这是真正*知道*您可以操作 DOM 的唯一方法。这就是为什么`window.onload`，这个回调。我可以想到这对您不起作用的几个原因：

如果您实际上只是逐字插入`window.onload = function();`，那么您就错过了重点-这意味着不是一个空函数，而是*您的*函数。我假设您不只是输入它，而是以防万一，您的代码应该是

```
window.onload = function(){
    document.getElementById(selected_city).selected="1";
}; 
```

或者，由于`window.onload=[some function]`将稍后调用的函数分配给单个变量，因此只能有一个。*如果您正在加载其他一些也*分配的脚本`window.onload`，您的回调可能会丢失。

这就是为什么像 jquery 这样的框架，它有一个可以接受和回调任意数量的函数的[现成函数，是前端开发人员的黄金。](http://api.jquery.com/ready/)[这是另一个 StackOverflow 问题](https://stackoverflow.com/questions/559150/best-practice-for-using-window-onload)，专门询问有关使用 onload 的问题。

最后，这一行：

```
var selected_city = document.getElementById('jform_city').value; 
```

*还*需要在正确运行之前加载 DOM。`selected_city`本身可能为 null 或未定义，因为在您请求其值时未加载 #jform_city。这反过来会导致`document.getElementById(selected_city)`失败，即使该元素是在您尝试选择它时加载的。

异步是 Javascript 的一大痛点。

任何时候您需要从页面本身获取信息，根据经验，您必须等待 DOM 加载。实际上，这意味着几乎所有的代码（除了那些不需要加载页面的代码）都应该在页面加载后被调用的函数中。

# c# - 如何从 WPF 应用程序中的数据网格中获取选定的范围值？

> ID：14862656
> 
> 赞同：1
> 
> 时间：2013-02-13T20:38:31.687
> 
> 标签：c#, wpf, datagrid, mouseover

如何从 WPF 应用程序中的数据网格中获取选定的范围值？

这是我的应用程序的屏幕截图。 ![](../Images/d8237bcac4a9e0e838e68bc8cc1fde5c.png)

到目前为止，这是我的代码：

```
private void excel_grid_SelectedCellsChanged(object sender, System.Windows.Controls.SelectedCellsChangedEventArgs e)
    {
        System.Windows.Controls.DataGrid dataGrid = sender as System.Windows.Controls.DataGrid;
        IList<System.Windows.Controls.DataGridCellInfo> ne = dataGrid.SelectedCells;

    } 
```

# matlab - MATLAB：如何检查矩阵中的任何元素是否为 nan，如果是这种情况，请执行某些操作

> ID：14862663
> 
> 赞同：7
> 
> 时间：2013-02-13T20:38:57.713
> 
> 标签：matlab, if-statement, nan

我知道我可以`isnan`用来检查单个元素，例如

```
for i=1:m
    for j=1:n
        if isnan(A(i,j))
            do something
        end
    end
end 
```

但是，相反，我想做的是

```
 if any(isnan(A))
      do something
 end 
```

当我尝试这样做时，它不会进入争论，因为它被认为是错误的。如果我只是输入`any(isnan(A))`，我就会得到`1 0 1`。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T20:42:24.293

```
any(isnan(A(:))) 
```

因为`A`是一个矩阵，`isnan(A)`也是一个矩阵并且`any(isnan(A))`是一个向量，而该`if`语句确实需要一个标量输入。无论初始大小如何，使用该`(:)`符号都会变平`A`为向量。

# vb.net - VB.NET datagridview 一对一映射组合框

> ID：14862667
> 
> 赞同：2
> 
> 时间：2013-02-13T20:39:28.920
> 
> 标签：vb.net, winforms, datagridview, datagridcomboboxcolumn

我有一个带有两个文本框列和一个组合框列的 datagridview。组合框的 DataSource 绑定到下拉列表值的枚举。datagridview 的 DataSource 绑定到一个自定义类，数据类型为字符串、字符串和枚举。

前两列预先填充了值，在第三列中，用户必须从下拉列表中选择一个值。到目前为止，所有这些都运行良好，除了......

组合框字段应该是一对一的映射，这意味着没有两个组合框应该具有相同的值。我真的不确定如何实现这种行为。是否应该从剩余的下拉列表中删除所选值？选择的值是否应该保留在下拉列表中，并且在选择两个相同的值时只给出错误？

任何想法以及如何实施这些想法都会有很大帮助。

谢谢

*请注意*，可以多次使用的唯一可接受的值是“无”

![在此处输入图像描述](../Images/e1f46bc8fddd6731547d7c6ae713847c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:40:06.757

根据您的意图，我有一个想法，可能会从剩余的下拉列表中删除所选值。

我有一个名为的类`Runner`，其设置与您的示例类似。

```
Public Class Runner

    Public Property FirstName As String
    Public Property LastName As String
    Public Property Placement As Result

    Public Sub New(fn As String, ln As String)
        FirstName = fn
        LastName = ln
        Placement = Result.None
    End Sub

End Class 
```

我还有一个名为的枚举`Result`，它将被填充到`ComboBoxCell`：

```
Public Enum Result
    None = 0
    Bronze = 1
    Silver = 2
    Gold = 3
End Enum 
```

当我创建数据对象并将它们绑定到 时`DataGridView`，我会这样做（注意 - Placements 是一个全局 List(Of Result) 并且 Runners 是一个全局 List(Of Runner)：

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Placements.Add(Result.None)
    Placements.Add(Result.Bronze)
    Placements.Add(Result.Silver)
    Placements.Add(Result.Gold)
    Runners.Add(New Runner("John", "Smith"))
    Runners.Add(New Runner("Jane", "Doe"))
    Runners.Add(New Runner("Bill", "Jones"))
    Column1.DataPropertyName = "FirstName"
    Column2.DataPropertyName = "LastName"
    Column3.DataPropertyName = "Placement"
    Column3.DataSource = Placements
    DataGridView1.DataSource = Runners
End Sub 
```

现在，每当单元格的值`ComboBoxColumn`发生变化时，您就可以从包含枚举的列表中删除新值：

```
Private Sub DataGridView1_CellValueChanged(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView1.CellValueChanged
    If (e.RowIndex > -1 And e.ColumnIndex = 2) Then
        Dim currentvalue As Result = DataGridView1.Rows(e.RowIndex).Cells(e.ColumnIndex).Value
        If currentvalue <> Result.None Then
            Placements.Remove(currentvalue)
        End If
    End If
End Sub 
```

更改下拉选择时要小心...根据此[讨论](https://stackoverflow.com/questions/9608343/datagridview-combobox-column-change-cell-value-after-selection-from-dropdown-is)，您必须`DataGridView`在值更改后立即诱骗提交值`ComboBox`。我使用了该讨论的答案并做了这样的事情：

```
Private Sub DataGridView1_CurrentCellDirtyStateChanged(sender As Object, e As EventArgs) Handles DataGridView1.CurrentCellDirtyStateChanged
    Dim col As DataGridViewColumn = DataGridView1.Columns(DataGridView1.CurrentCell.ColumnIndex)
    If col.Name = "Column3" Then
        DataGridView1.CommitEdit(DataGridViewDataErrorContexts.Commit)
        Dim selected As DataGridViewCell = DataGridView1.CurrentCell
        DataGridView1.CurrentCell = Nothing //This line and the next one simply hide
        DataGridView1.CurrentCell = selected //an odd display effect that occurs 
                                             //because we remove a value and change the
                                             //selection at the same time
    End If
End Sub 
```

最后，您要为 处理`DataError`事件`DataGridView`并将其留空，以免`Exceptions`在从枚举列表中删除值时被抛出。

这可以让你到达那里大约 90% 的路。当您更改值时，它不会将项目重新添加到列表中。例如，如果我从 Gold 更改为 Silver，Gold 应该重新添加到列表中。您可能可以弄清楚要处理哪些事件来获取旧值和新值，然后根据其枚举值将旧值插入到正确索引处的列表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T18:57:09.523

我决定使用 DataGridView 的 CellValidating 事件来检查是否多次选择了相同的值。如果是，则在行标题列中显示错误消息。

在错误解决之前，错误的组合框不会失去焦点。

```
Private Sub DataGridView1_CellValidating(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellValidatingEventArgs) Handles DataGridView1.CellValidating

    Dim headerText As String = DataGridView1.Columns(e.ColumnIndex).HeaderText

    'Abort validation if cell is not in the Mapping column. 
    If Not headerText.Equals("Column Mapping") Then Return

    'Clear error on current row.
    DataGridView1.Rows(e.RowIndex).ErrorText = Nothing
    e.Cancel = False

    Dim newMappingValue As XmlElement = DirectCast([Enum].Parse(GetType(XmlElement), e.FormattedValue), XmlElement)

    ' Abort validation if cell value equal XmlElement.None 
    If newMappingValue.Equals(XmlElement.None) Then Return

    For Each dgvRow As DataGridViewRow In DataGridView1.Rows
        Dim currentMappingValue As XmlElement = dgvRow.Cells.Item(headerText).Value

        If dgvRow.Index <> e.RowIndex Then
            If currentMappingValue.Equals(newMappingValue) Then
                DataGridView1.Rows(e.RowIndex).ErrorText = "Value already selected, please select a different value."
                e.Cancel = True
            End If
        End If
    Next

End Sub 
```

![在此处输入图像描述](../Images/684751700659adf2fcb424d128e941f6.png)

# clojure - 从列表中生成带有 Noir 的 img 标签

> ID：14862669
> 
> 赞同：3
> 
> 时间：2013-02-13T20:39:30.243
> 
> 标签：clojure, noir

我有一个照片链接列表，想用 clojure 和 noir 生成 img 标签。

在这里我得到链接：

```
(def photos
(->> (get-in result ["photoset" "photo"]) (map #(str "http://farm"(get % "farm")
".staticflickr.com/"(get % "server")"/"(get % "id")"_"(get % "secret")"_b.jpg")))) 
```

结果：

```
(http://farm9.staticflickr.com/8087/8455893107_1a3236df06_b.jpg http://farm9.staticflickr.com/8235/8469482476_4c1bf59214_b.jpg) 
```

然后我尝试从该列表中生成 img 标签：

```
(defpage "/" []
 (mylayout/layout
 (doseq [e photos] (prn e))
 )) 
```

  （调用`(defpartial layout [& content] ...)`

我正在尝试为基于黑色的站点中的每个链接获取以下输出：

```
[:img {:src "url"}] 
```

我正在尝试这个但没有成功：

```
(doseq [e photos] ([:img {:src e}])) 
```

如何将链接传递给布局以生成 img 标签？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:44:38.567

Either of these should work:

```
(map #(vector :img {:src %}) photos)

(for [url photos]
  [:img {:src url}]) 
```

*Edit*: As [Chuck](https://stackoverflow.com/users/50742/chuck) mentioned, `doseq` is for side-effects. You are wanting to "collect" the results and send them to the template. To do this you need to use list comprehension like `for` or just `map` over your collection.

I hate to rain on your parade but just so you know, [noir has been deprecated](http://blog.raynes.me/blog/2012/12/13/moving-away-from-noir/)

# git - 如何从 git 中的项目中永久删除文件夹？

> ID：14862672
> 
> 赞同：-2
> 
> 时间：2013-02-13T20:39:42.860
> 
> 标签：git, git-svn

如何从 git 中的项目中永久删除文件夹？

我一直删除这个文件夹，我希望它从回购中删除

但它不断回来......我如何告诉git永久删除一个文件夹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:11:55.157

使用这些更改删除文件`git rm`并推送提交。之后您仍然必须删除空目录，因为 git 仅适用于文件，而不适用于目录。

# javascript - Javascript - 加载过滤外部 html 文件

> ID：14862684
> 
> 赞同：0
> 
> 时间：2013-02-13T20:40:04.077
> 
> 标签：javascript, jquery, html, filter

我需要一些关于如何过滤外部 html 文件的建议。

我可以使用以下代码很好地加载文件。

```
$('body').load('files/my-links.html', function(data) {
document.write(data) ;
}) ; 
```

由于该文件在链接中包含多个类，因此我想过滤按类显示的链接。允许我将所有外部链接放在一个文件中，然后在任何给定时间只显示我想要的那些。我还想限制我随时显示的链接数量。因此，如果午餐盒类有 25 个链接，我一次只能显示 10 个。

我试过把整个东西放在一个数组中，但这没有帮助。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:47:03.500

您可以为 .load 提供选择器，例如：

```
$('body').load('files/my-links.html a:lt(10)'); 
```

它会做与使用相同的事情：

```
$.get('files/my-link.html',function(html){
    $('body').html($(html).find('a:lt(10)'));
}); 
```

`a:lt(10)`表示选择前 10 个锚标签。

您当然也可以在上课时按您的班级进行过滤：`a.myclass`或`a.myclass:lt(10)`

# java - 在 OSX / Unix 上设置额外的 Tomcat 服务器

> ID：14862687
> 
> 赞同：1
> 
> 时间：2013-02-13T20:40:12.323
> 
> 标签：java, macos, apache, tomcat

我在设置tomcat以在mac上的端口“80”上运行时遇到了一些问题。我查看了 Stackoverflow 和 Google，但没有找到有效的答案，所以我会尽可能清楚地解释我的问题。

我在我的 Mac 上安装了 2 个版本的 tomcat 7 用于开发，我在不同的时间运行它们。

Netbeans 正在使用一个 Tomcat 安装 (tomcat1)，标准配置在端口“8080”重定向到“8443”。这工作正常。

我有另一个 Tomcat 安装（tomcat2），它在 server.xml 文件中有修改的配置。即我不得不将端口更改为“80”，并将redirectPort 更改为“443”。

```
<Connector port="80" protocol="HTTP/1.1"
           connectionTimeout="20000"
           redirectPort="443" />

<Connector port="443" protocol="HTTP/1.1" SSLEnabled="true"
           maxThreads="150" scheme="https" secure="true"
           clientAuth="false" sslProtocol="TLS"
           keystoreFile="my_jks_file"
           keystorePass="mypassword" />

<!-- Define an AJP 1.3 Connector on port 8009 -->
<Connector port="8009" protocol="AJP/1.3" redirectPort="443" /> 
```

所以在更改设置之前 tomcat2 运行良好。但是，在更改了 tomcat2 的设置后，它不会启动，并给我下面的错误。我怎样才能解决这个问题？从我的搜索看来，我需要以 root 身份运行 tomcat ......或类似的东西。任何帮助，将不胜感激。

谢谢

```
Feb 13, 2013 1:25:06 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: .:/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java
Feb 13, 2013 1:25:06 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-80"]
Feb 13, 2013 1:25:06 PM org.apache.coyote.AbstractProtocol init
SEVERE: Failed to initialize end point associated with ProtocolHandler ["http-bio-80"]
java.net.BindException: Permission denied <null>:80
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:406)
    at org.apache.tomcat.util.net.AbstractEndpoint.init(AbstractEndpoint.java:610)
    at org.apache.coyote.AbstractProtocol.init(AbstractProtocol.java:429)
    at org.apache.coyote.http11.AbstractHttp11JsseProtocol.init(AbstractHttp11JsseProtocol.java:119)
    at org.apache.catalina.connector.Connector.initInternal(Connector.java:981)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.core.StandardService.initInternal(StandardService.java:559)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.core.StandardServer.initInternal(StandardServer.java:814)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:633)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:658)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:281)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:455)
Caused by: java.net.BindException: Permission denied
    at java.net.PlainSocketImpl.socketBind(Native Method)
    at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:383)
    at java.net.ServerSocket.bind(ServerSocket.java:328)
    at java.net.ServerSocket.<init>(ServerSocket.java:194)
    at java.net.ServerSocket.<init>(ServerSocket.java:150)
    at org.apache.tomcat.util.net.DefaultServerSocketFactory.createSocket(DefaultServerSocketFactory.java:49)
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:393)
    ... 17 more
Feb 13, 2013 1:25:06 PM org.apache.catalina.core.StandardService initInternal
SEVERE: Failed to initialize connector [Connector[HTTP/1.1-80]]
org.apache.catalina.LifecycleException: Failed to initialize component [Connector[HTTP/1.1-80]]
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:106)
    at org.apache.catalina.core.StandardService.initInternal(StandardService.java:559)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.core.StandardServer.initInternal(StandardServer.java:814)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:633)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:658)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:281)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:455)
Caused by: org.apache.catalina.LifecycleException: Protocol handler initialization failed
    at org.apache.catalina.connector.Connector.initInternal(Connector.java:983)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    ... 12 more
Caused by: java.net.BindException: Permission denied <null>:80
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:406)
    at org.apache.tomcat.util.net.AbstractEndpoint.init(AbstractEndpoint.java:610)
    at org.apache.coyote.AbstractProtocol.init(AbstractProtocol.java:429)
    at org.apache.coyote.http11.AbstractHttp11JsseProtocol.init(AbstractHttp11JsseProtocol.java:119)
    at org.apache.catalina.connector.Connector.initInternal(Connector.java:981)
    ... 13 more
Caused by: java.net.BindException: Permission denied
    at java.net.PlainSocketImpl.socketBind(Native Method)
    at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:383)
    at java.net.ServerSocket.bind(ServerSocket.java:328)
    at java.net.ServerSocket.<init>(ServerSocket.java:194)
    at java.net.ServerSocket.<init>(ServerSocket.java:150)
    at org.apache.tomcat.util.net.DefaultServerSocketFactory.createSocket(DefaultServerSocketFactory.java:49)
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:393)
    ... 17 more
Feb 13, 2013 1:25:06 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-443"]
Feb 13, 2013 1:25:07 PM org.apache.coyote.AbstractProtocol init
SEVERE: Failed to initialize end point associated with ProtocolHandler ["http-bio-443"]
java.net.BindException: Permission denied <null>:443
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:406)
    at org.apache.tomcat.util.net.AbstractEndpoint.init(AbstractEndpoint.java:610)
    at org.apache.coyote.AbstractProtocol.init(AbstractProtocol.java:429)
    at org.apache.coyote.http11.AbstractHttp11JsseProtocol.init(AbstractHttp11JsseProtocol.java:119)
    at org.apache.catalina.connector.Connector.initInternal(Connector.java:981)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.core.StandardService.initInternal(StandardService.java:559)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.core.StandardServer.initInternal(StandardServer.java:814)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:633)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:658)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:281)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:455)
Caused by: java.net.BindException: Permission denied
    at java.net.PlainSocketImpl.socketBind(Native Method)
    at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:383)
    at java.net.ServerSocket.bind(ServerSocket.java:328)
    at java.net.ServerSocket.<init>(ServerSocket.java:194)
    at java.net.ServerSocket.<init>(ServerSocket.java:150)
    at javax.net.ssl.SSLServerSocket.<init>(SSLServerSocket.java:84)
    at com.sun.net.ssl.internal.ssl.SSLServerSocketImpl.<init>(SSLServerSocketImpl.java:81)
    at com.sun.net.ssl.internal.ssl.SSLServerSocketFactoryImpl.createServerSocket(SSLServerSocketFactoryImpl.java:65)
    at org.apache.tomcat.util.net.jsse.JSSESocketFactory.createSocket(JSSESocketFactory.java:159)
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:393)
    ... 17 more
Feb 13, 2013 1:25:07 PM org.apache.catalina.core.StandardService initInternal
SEVERE: Failed to initialize connector [Connector[HTTP/1.1-443]]
org.apache.catalina.LifecycleException: Failed to initialize component [Connector[HTTP/1.1-443]]
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:106)
    at org.apache.catalina.core.StandardService.initInternal(StandardService.java:559)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.core.StandardServer.initInternal(StandardServer.java:814)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:633)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:658)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:281)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:455)
Caused by: org.apache.catalina.LifecycleException: Protocol handler initialization failed
    at org.apache.catalina.connector.Connector.initInternal(Connector.java:983)
    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:102)
    ... 12 more
Caused by: java.net.BindException: Permission denied <null>:443
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:406)
    at org.apache.tomcat.util.net.AbstractEndpoint.init(AbstractEndpoint.java:610)
    at org.apache.coyote.AbstractProtocol.init(AbstractProtocol.java:429)
    at org.apache.coyote.http11.AbstractHttp11JsseProtocol.init(AbstractHttp11JsseProtocol.java:119)
    at org.apache.catalina.connector.Connector.initInternal(Connector.java:981)
    ... 13 more
Caused by: java.net.BindException: Permission denied
    at java.net.PlainSocketImpl.socketBind(Native Method)
    at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:383)
    at java.net.ServerSocket.bind(ServerSocket.java:328)
    at java.net.ServerSocket.<init>(ServerSocket.java:194)
    at java.net.ServerSocket.<init>(ServerSocket.java:150)
    at javax.net.ssl.SSLServerSocket.<init>(SSLServerSocket.java:84)
    at com.sun.net.ssl.internal.ssl.SSLServerSocketImpl.<init>(SSLServerSocketImpl.java:81)
    at com.sun.net.ssl.internal.ssl.SSLServerSocketFactoryImpl.createServerSocket(SSLServerSocketFactoryImpl.java:65)
    at org.apache.tomcat.util.net.jsse.JSSESocketFactory.createSocket(JSSESocketFactory.java:159)
    at org.apache.tomcat.util.net.JIoEndpoint.bind(JIoEndpoint.java:393) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T20:51:17.753

正如 hd1 所说，您必须是 root 才能绑定到 1024 以下的端口。但是，您不应该以 root 身份运行 - 这是灾难的秘诀。

而是使用 apache httpd 或您喜欢的网络服务器绑定到端口 80，然后委托给 tomcat。为此，您可以使用 mod_proxy、mod_jk2 或 mod_proxy_ajp - 查找这些文档，有很多可以找到的。

此设置的优点是 Apache 放弃了 root 权限，并且您不会向 Internet 公开具有超级用户权限的服务：考虑一下当此设置存在安全违规时可能造成的损害 - 会有根进程远程控制。

如果您已经以 root 身份运行（例如`sudo ...`），请确保更改已以 root 身份创建的临时文件和目录的所有权。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:41:51.620

一些进程已经在使用 port `80`。
用于`netstat`查找它或使用可用端口。

另一种选择是，尽管`Windows`您可以绑定到`80`非 root 用户，但对于 Mac 来说是不可能的。在linux中它不是。
如果在 Mac 中您不能以非 root 身份绑定到端口`80`，并且如果要求您以非 root 身份运行，您仍然可以绑定到`80`（以及任何其他端口 < 1024），但使用[jsvc](http://commons.apache.org/daemon/jsvc.html)作为“包装器”。它将允许您以非 root 身份绑定到端口 <1024。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T20:42:10.083

您需要以 root 身份启动才能绑定到类 Unix 系统上小于 1024 的端口。所以，使用`sudo bin/catalina.sh start`它应该可以工作。希望有帮助。

# html - 使用固定标题滚动 UL

> ID：14862693
> 
> 赞同：2
> 
> 时间：2013-02-13T20:40:24.727
> 
> 标签：html, css

我在 div 中有一个带有标题的 ul，我试图在保持标题固定的同时使 ul 滚动。我还想让标题与 ul 的宽度相匹配。我可以一次做其中一个，但不能同时做两个。要么我得到一个标题为 ul 宽度的 100% 的 ul，要么我得到一个在列表滚动时保持不变的标题，但它与 ul 宽度不匹配。有人可以指出我做错了什么吗？

在这里小提琴：http: [//jsfiddle.net/9zcRy/2/](http://jsfiddle.net/9zcRy/2/)

的HTML

```
<div class="talkingPointsHolder">
<div class="genericScriptsHolder"> 
    <span class="listHeader">List One</span>

    <ul
    class="scrollingList">
        <li>item 1.1</li>
        <li>item 1.2</li>
        <li>item 1.3</li>
        <li>item 1.4</li>
        <li>item 1.5</li>
        <li>item 1.6</li>
        <li>item 1.7</li>
        <li>item 1.8</li>
        <li>item 1.9</li>
        <li>item 1.10</li>
        <li>item 1.11</li>
        <li>item 1.12</li>
        </ul>
</div>
<div class="genericScriptsHolder"> 
    <span class="listHeader">List Two</span>

    <ul
    class="scrollingList">
        <li>item 2.1</li>
        <li>item 2.2</li>
        <li>item 2.3</li>
        <li>item 2.4</li>
        <li>item 2.5</li>
        <li>item 2.6</li>
        <li>item 2.7</li>
        <li>item 2.8</li>
        <li>item 2.9</li>
        <li>item 2.10</li>
        <li>item 2.11</li>
        <li>item 2.12</li>
        </ul>
</div> 
```

CSS

```
.talkingPointsHolder {
    border: 1px solid black;
    background: #eeeeee;
    height: 200px;
    overflow: auto;
}

.genericScriptsHolder {
    float: left;
    width: 48%;
    margin: 0px 2px 0px 2px;
    /* uncomment to make the title match the ul width (see listHeader too)*/
    /*position: relative;*/
}

.listHeader {
    color: #ffffff;
    background: #444444;
    padding: 10px 0px 10px 0px;
    text-transform: uppercase;
    font-weight:bold;
    font-size:11px;
    text-align: left;
    text-indent: 1em;
    position: absolute;
    z-index:10;

    /* uncomment to make the title match the ul width (see genericScriptsHolder too)*/
    /*width: 100%;*/
}

.scrollingList {
    position: relative;
    top: 31px;
}

.scrollingList li {
    overflow: auto;
    height: 20px;
    color: #666666;
    background-color: #cccccc;
    font-weight: lighter;
    padding: 10px;
    margin: 2px;
    list-style-type: none;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:55:23.580

如果您正在使用，则需要定义元素的宽度`position: absolute;`

我将您的宽度设置为与您`.list-header`的宽度相匹配`.genericScriptsHolder`，然后相应地调整填充。

这是小提琴：http: [//jsfiddle.net/9zcRy/15/](http://jsfiddle.net/9zcRy/15/)

请注意，我删除了您为滚动列表行项目创建的水平边距，而是编辑了父`.genericScriptsHolder`元素的样式。

```
 .genericScriptsHolder {
    float: left;
    width: 48%;
    margin: 0px 5px 0px 5px;
    /* uncomment to make the title match the ul width (see listHeader too)*/
    /*position: relative;*/
}

.listHeader {
    color: #ffffff;
    background: #444444;
    padding: 10px 0px 10px 0px;
    text-transform: uppercase;
    font-weight:bold;
    font-size:11px;
    text-align: left;
    text-indent: 1em;
    position: absolute;
    width: 48%;
    z-index:10;

.scrollingList li {
    overflow: auto;
    height: 20px;
    color: #666666;
    background-color: #cccccc;
    font-weight: lighter;
    padding: 10px;
    margin: 2px 0 0 0;
    list-style-type: none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:47:06.020

[http://jsfiddle.net/9zcRy/9/](http://jsfiddle.net/9zcRy/9/)

```
.listHeader {
color: #ffffff;
background: #444444;
padding: 10px 0px 10px 0px;
text-transform: uppercase;
font-weight:bold;
font-size:11px;
text-align: left;
text-indent: 1em;
position: absolute;
z-index:10;
width:46%; 
```

# sql - 根据同一表中的值访问 SQL 更新联接中的一个表

> ID：14862694
> 
> 赞同：1
> 
> 时间：2013-02-13T20:40:28.633
> 
> 标签：sql, ms-access, sql-update

我在 Access 中有一个名为“tempSpring_ASN”的表，其中包含以下字段（以及其他字段）：

SHP_CUSTOM_5（自动编号）

RECORD_TYPE（文本）

PO_NUM（文本）。

我需要更改 RECORD_TYPE 的值，如果 PO_NUM 与上一条记录中的 PO_NUM 相同，那么 RECORD_TYPE 应该是“LIN”，否则（或者如果是第一条记录），RECORD_TYPE 应该是“HDR”。

我创建了以下查询来获取 RECORD_TYPE 的正确新值：

```
SELECT TOP 1 t1.SHP_CUSTOM_5,
    t1.PO_NUM AS CurrentValue,
    NULL AS PreviousValue,
    "HDR" AS RECORD_TYPE
FROM tempSpring_ASN AS t1
ORDER BY t1.SHP_CUSTOM_5
UNION ALL
SELECT t1.SHP_CUSTOM_5,
    t1.PO_NUM AS CurrentValue,
    t2.PO_NUM AS PreviousValue,
    IIf([CurrentValue]=[PreviousValue],'LIN','HDR') AS RECORD_TYPE
FROM tempSpring_ASN AS t1,
    tempSpring_ASN AS t2
WHERE t1.SHP_CUSTOM_5 = t2.SHP_CUSTOM_5 + 1
ORDER BY t1.SHP_CUSTOM_5; 
```

我已将该查询保存为“tempSpring_ASN_With_PreviousRow”。现在我正在尝试使用它来使用以下查询更新原始 tempSpring_ASN 表：

```
UPDATE tempSpring_ASN INNER JOIN tempSpring_ASN_With_PreviousRow ON tempSpring_ASN.SHP_CUSTOM_5 = tempSpring_ASN_With_PreviousRow.SHP_CUSTOM_5 SET tempSpring_ASN.RECORD_TYPE = [tempSpring_ASN_With_PreviousRow].[RECORD_TYPE]; 
```

但我得到了，“操作必须使用可更新的查询。” 我不确定是因为我试图更新连接中的一个表，还是因为我试图根据同一个表中的值更新表，或者是由于其他原因。无论如何，我正在寻找有效的东西。

谢谢！

**更新**（没有双关语）**：**

我尝试了以下更新查询：

```
UPDATE tempSpring_ASN INNER JOIN Table5 ON tempSpring_ASN.SHP_CUSTOM_5 = Table5.SHP_CUSTOM_5 SET tempSpring_ASN.RECORD_TYPE = "zzz"; 
```

它工作得很好。结果是 tempSpring_ASN 已更新，但 Table5 没有。显然，如果在一条 SQL 语句中连接了两个表，即使您对一个表运行更新，它仍然不会尝试更新连接中的另一个表。既然如此，我不确定为什么我原来的更新查询不起作用。*我知道tempSpring_ASN_With_PreviousRow*不可更新，因为它是一个 UNION 查询，但我不想更新它。相反，我正在尝试更新 tempSpring_ASN——连接中的另一个表，它*是可*更新的。

**更新 2：** 然后我尝试使用相关子查询，如下所示：

```
UPDATE tempSpring_ASN AS t
SET t.RECORD_TYPE = (
        SELECT RECORD_TYPE
        FROM (
            SELECT TOP 1 t1.SHP_CUSTOM_5,
                t1.PO_NUM AS CurrentValue,
                NULL AS PreviousValue,
                "HDR" AS RECORD_TYPE
            FROM tempSpring_ASN AS t1
            ORDER BY t1.SHP_CUSTOM_5
            UNION ALL
            SELECT t1.SHP_CUSTOM_5,
                t1.PO_NUM AS CurrentValue,
                t2.PO_NUM AS PreviousValue,
                IIf([CurrentValue] = [PreviousValue], 'LIN', 'HDR') AS RECORD_TYPE
            FROM tempSpring_ASN AS t1,
                tempSpring_ASN AS t2
            WHERE t1.SHP_CUSTOM_5 = t2.SHP_CUSTOM_5 + 1
            ORDER BY t1.SHP_CUSTOM_5
            )
        WHERE SHP_CUSTOM_5 = t.SHP_CUSTOM_5
        ); 
```

但我仍然收到“操作必须使用可更新查询”。

**更新 3：**

我相信这个错误是由于我使用联合查询造成的。为了隔离问题，我尝试了以下方法（这不会给我想要的结果，但会帮助我诊断问题。）：

```
UPDATE tempSpring_ASN AS t
SET t.RECORD_TYPE = (
        SELECT TOP 1 RECORD_TYPE
        FROM tempSpring_ASN_With_PreviousRow
        ); 
```

它给了我同样的错误。所以现在的问题变成了，为什么我不能使用联合查询输出的单个值来设置记录集中的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:50:35.623

我也在你的新问题中发布了这个答案。

嗨，AYS，

在 Access 中，需要对表运行更新查询。由于 UNION 查询是多组记录的组合，结果集不再是一个表，也不能成为 Update 查询的对象，因为结果集中的记录不再与任何一个特定表唯一标识（甚至如果理论上可以的话）。访问被硬编码以将每个 UNION 查询视为只读，这在有多个基础表时是有意义的。还有许多其他条件（例如 SELECT 语句中的子查询）也会触发此条件。

可以这样想：如果您没有使用 TOP 1 并且您的 UNION 查询返回了多个结果，JET 将如何知道将哪个结果应用于您的表中的唯一记录？因此，JET 对所有此类情况一视同仁。

不幸的是，即使所有数据都来自同一个表，情况也是如此。在这种情况下，JET 优化器很可能根本不够聪明，无法意识到这种情况并以不使用 UNION 的方式重新表述查询。

在这种情况下，您仍然可以通过重新声明查询以使所有内容都引用您的基表来获得所需的内容。例如，您可以使用以下内容作为 SELECT 查询来获取先前 SHP_CUSTOM_5 记录的 PO_NUM 值：

```
SELECT
t1.SHP_CUSTOM_5
, t1.PO_NUM
, t1.SHP_CUSTOM_5 -1 AS PREV_RECORD

, (SELECT
t2.PO_NUM
FROM
tempSpring_ASN As t2
WHERE
t2.SHP_CUSTOM_5 = (t1.SHP_CUSTOM_5 -1)
) AS PREV_PO

FROM
tempSpring_ASN AS t1
; 
```

然后，您可以将其表述为更新查询，如下所示，以执行“LIN”更新：

```
UPDATE
tempSpring_ASN AS t1 

SET 
t1.RECORD_TYPE = "LIN"

WHERE
t1.PO_NUM=

(
SELECT 
t2.PO_NUM

FROM
tempSpring_ASN As t2

WHERE
t2.SHP_CUSTOM_5 = (t1.SHP_CUSTOM_5 -1)
)
; 
```

这段代码在我使用虚拟数据运行的测试中是成功的。

关于您的“HDR”更新，您实际上是在执行两个单独的更新。1) 如果 PO_NUM 与上一条记录的 PO_NUM 匹配，则将 RECORD_TYPE 设置为“LIN” 2) 如果是第一条记录，则将 RECORD_TYPE 设置为“HDR”

我不清楚为什么在一个查询中执行这些操作会有好处。我建议使用您在原始 SELECT 查询示例中使用的 SHP_CUSTOM_5 方法的“TOP 1”执行 HDR 更新，因为这将是一个相对简单的 UPDATE 查询。可以在 Update 查询中使用 IIF()，但我不知道您会从所需的额外时间和复杂性中获得什么额外好处（它很可能只是可读性低得多）。

祝你好运！

# ajax - 为什么不能将 ajax .load 和 .fadeIn 组合为回调？

> ID：14862695
> 
> 赞同：0
> 
> 时间：2013-02-13T20:40:32.300
> 
> 标签：ajax, function, load, fadein

我有一个事件日历，当您单击某一天时，它会加载每日程序。但它不会淡入。页面有三个 div，因为日历只显示实际月份、上个月和下个月。(div1 - prev, div2 - actual, div3 - next) 但一次只有一个可见。它完美地加载了内容，但没有淡入淡出。任何的想法？

谢谢！

丹尼尔

```
 $(document).ready(function(){
      $(".freeday").click(function(){
         $("#p_div1").load("none.txt", {}, function(){ $(this).fadeIn("700");}    );
         $("#p_div2").load("none.txt", {}, function(){ $(this).fadeIn("700");}    );
         $("#p_div3").load("none.txt", {}, function(){ $(this).fadeIn("700");}    );    
      });
   }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:01:46.957

```
$(document).ready(function(){
      $(".freeday").click(function(){
         $("#p_div1").hide().load("none.txt", {}, function(){ $(this).fadeIn("700");}    );
         $("#p_div2").hide().load("none.txt", {}, function(){ $(this).fadeIn("700");}    );
         $("#p_div3").hide().load("none.txt", {}, function(){ $(this).fadeIn("700");}    );    
      });
   }); 
```

**.load()**获取请求完成时执行的回调函数。为了成功**.fadeIn()**内容，您应该首先隐藏容器，加载内容，最后执行**.fadeIn()**函数。

# ruby - 在捆绑之前确保 `gem install json -v '1.7.7'` 成功。

> ID：14862702
> 
> 赞同：3
> 
> 时间：2013-02-13T20:41:16.767
> 
> 标签：ruby, json

我尝试创建一个新项目，但出现此错误。
这是什么意思？

> Gem 文件将继续安装在 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/json-1.7.7 以供检查。结果记录到 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/json-1.7.7/ext/json/ext/generator/gem_make.out 安装 json (1.7\. 7)，并且 Bundler 无法继续。`gem install json -v '1.7.7'`在捆绑之前确保成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:44:05.383

我的*猜测*是 json gem 需要一个 C 编译器，而你没有。不过，您可以通过键入来了解更多信息`gem install json -v 1.7.7`。

# python - 作为服务运行时，Windows 上的 Python urllib.getproxies() 不起作用

> ID：14862706
> 
> 赞同：1
> 
> 时间：2013-02-13T20:41:29.447
> 
> 标签：python, windows, service, proxy, urllib

所以对于我的应用程序，我使用 urllib.getproxies() 来检测代理设置。

当我从 python shell 调用它时，该函数运行良好。

但是当我的应用程序作为服务运行时（并且仅当它作为服务运行时）， urllib.getproxies() 会返回一个空字典。

我正在使用 Windows 2008 R2 和 python 2.7。

你们知道它可能来自哪里吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T16:31:52.437

所以答案是windows代理系统设置存储在注册表中的HKEY_CURRENT_USER下

因此，当服务在特殊用户下运行时，它无法在其 HKEY_CURRENT_USER 中找到它。

解决方法： 1\. 在另一个用户下运行服务。2\. 阅读正确的用户注册表

# html - 为什么还有空白？

> ID：14862710
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:41:38.760
> 
> 标签：html, css

这是我网站骨架的 HTML 代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link href="css/base.css" rel="stylesheet" type="text/css" >    
</head>
<body>
<div id="center">
</br>
</br>
</div>
</body>
</html> 
```

这就是 base.css 的样子：

```
#center{
border:0px;
margin:0px auto;
width:960px;
background-color: #66ffff;
padding:0px;
} 
```

问题是我的网站上仍然有空白，这是一张图片： [http](http://s4.postimage.org/6fagq090d/Untitled.png) ://s4.postimage.org/6fagq090d/Untitled.png （红色箭头指向我认为放置边框、边距和填充的空间会消失0)。

我已经在边距上设置了“自动”，所以它总是在中心对齐，但我不明白为什么我不能移动这个空间。我试过删除之间的空格，所以它会像但它没有帮助。我在哪里犯错？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:43:13.527

您还需要删除 html 和 body 周围的边距：

```
html, body {
   margin:0;
   padding:0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:43:17.330

您`<body>`很可能有边距/填充。也将它们归零：

```
body {
    margin: 0;
    padding: 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:44:00.797

`body`你需要像这样重置，

```
body {
  padding: 0px;
  margin: 0px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T20:57:23.050

您可以将 body{margin:0;padding:0} 添加到您的 CSS 中会有一些空间

# c# - 在 C# 中传递函数参数时遇到问题

> ID：14862715
> 
> 赞同：0
> 
> 时间：2013-02-13T20:42:04.157
> 
> 标签：c#, asp.net-mvc

现在，我们的 MVC Web 应用程序上的用户可以对服务器进行大量 ajax 调用。目前，我们在没有全局包装器/处理程序方法的情况下唯一地处理它们。我想改变这一点，但我对 C# 中的函数委托没有太多经验。

理想情况下，我希望它的设计如下：

```
public class GenericService
{
    public PageViewModel EditPage(PageViewModel model)
    {
        ....
    }

    public JsonResult JsonAjaxRequest(Func<Object, Object> serviceCall, Object data)
    {
        try
        {
            return new JsonResult() { Data = new { status = "ok", data = serviceCall(data) } };
        }
        catch
        {
            return new JsonResult() { Data = new { status = "error", message = "The server encountered an unknown error." } };
        }
    } 
```

现在在我的控制器中，我有以下代码：

```
private readonly GenericService _service;

public JsonResult PageEdit(PageViewModel model)
{
    return Json(_service.JsonAjaxRequest(x=>_service.EditPage(model), model));
} 
```

我不断收到`cannot convert from method group to system.func<object, object>`错误和`invalid arguments`编译错误，我不知道为什么。请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:18:52.157

我建议更改您的方法，使其具有通用性，而不仅仅是`object`在任何地方使用：

```
public JsonResult JsonAjaxRequest<TIn, TOut>(Func<TIn, TOut> serviceCall, TIn data)
{
    try
    {
        return new JsonResult() { Data = new { status = "ok", data = serviceCall(data) } };
    }
    catch
    {
        return new JsonResult() { Data = new { status = "error", message = "The server encountered an unknown error." } };
    }
} 
```

使用它，可以根据您作为参数提供的 lambda 或方法组来推断通用参数。对于 lambda，这应该不是问题，但是当直接传入方法组时，它可以帮助解决一些边缘情况。这也意味着你提供给函数的参数是强类型的，所以你不需要强制转换它。

在进行此更改后，您可能会遇到像您提到的那样的编译器错误的唯一方法是，如果您使用的方法要么接受除一个以外的一些参数（即零或 2+），或者如果它返回`void`而不是返回一些价值。

# javascript - document.getElementById innerHTML 不显示

> ID：14862722
> 
> 赞同：1
> 
> 时间：2013-02-13T20:42:25.730
> 
> 标签：javascript, innerhtml

这应该是一件很容易的事情，但它不会返回任何东西。函数 love() 应该启动，得到一个简单的数字提示，并吐出使用该起始数字的一些项目的列表。警报框正确显示了我的期望，但我希望它显示在屏幕上。（这只是我所追求的一小部分，但它是它的核心）。IE、FF 或 Chrome 中没有显示任何文字...

```
<script type="text/javascript">
        function love()
        {
            var ncxElement="";
            var idNumber = prompt("Enter beginning number","");
            var myText=document.getElementById("here");
            for (var i=1;i<5;i++)
            {
                ncxElement+=("<navPoint class=\"other\" id=\"page_"+idNumber+"\">\n");
                idNumber++;
            }
                alert(ncxElement);
                myText.innerHTML=ncxElement;
        }
    </script>
    </head>
    <body onload="love()">
    <p id="here">Begin!</p>
    </body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:47:58.397

如果您想在页面上显示 HTML（不对其进行解析），请使用`.textContent`代替`.innerHTML`并将其包装在 a 中`<pre>`（以保留换行符）。

**演示：** [[[[![jsFiddle](../Images/827f57786617d886d70c0bce0ccca6b6.png)](http://jsfiddle.net/ThinkingStiff/MPHFj/)]]]

改变：

```
myText.innerHTML=ncxElement; 
```

到：

```
myText.textContent=ncxElement; 
```

改变：

```
<p id="here">Begin!</p> 
```

到：

```
<pre id="here">Begin!</pre> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:50:53.557

navPoints 不是有效的 html 元素，因此浏览器不知道如何处理它们。它们被添加到 DOM 中，除非您添加样式，否则它们不会显示。

如果你用段落标签替换它们，它工作正常。[请参阅此处](http://jsfiddle.net/tzSXE/)的示例。

```
<script type="text/javascript">
    function love()
    {
        var ncxElement="";
        var idNumber = prompt("Enter beginning number","");
        var myText=document.getElementById("here");
        for (var i=1;i<5;i++)
        {
ncxElement+=("<p class=\"other\" id=\"page_"+idNumber+"\">"+idNumber+ "</p>");
            idNumber++;
        }
            alert(ncxElement);
            myText.innerHTML=ncxElement;
    }
</script>
</head>
<body onload="love()">
<p id="here">Begin!</p>
</body> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:51:21.467

您的函数只是将元素包装在另一个函数中。这些元素内部或外部没有可显示的文本。尝试在关闭标签之前插入一些随机文本以查看结果。顺便说一句，元素已成功放置在 p 标签中。

# java - 尝试为我自己的 XML 样式文件格式编写解析器，得到 FileNotFoundException，有什么特别是我做错了吗？

> ID：14862739
> 
> 赞同：0
> 
> 时间：2013-02-13T20:43:40.557
> 
> 标签：java, xml, parsing, xml-parsing, filenotfoundexception

所以基本上，我正在尝试编写一个 2d 骨骼动画编辑器以及一个框架，以便在游戏中轻松使用在编辑器中创建的相同动画。最大的问题是我以前没有写过 XML 解析器，所以我有一种感觉，我可能做错了什么，但我不确定它是什么。

这是我格式的示例文件：

```
<skeleton name="skeleton1">

    <bones>
        <bone name="bone1" id="1" textureLoc="/imgs/test.png">
            <position>x,y</position>
            <rotation>float</rotation>
            <scale>float</scale>
        </bone>

        <bone name="bone2" id="2" textureLoc="/imgs/text2.png">
            <position>x,y</position>
            <rotation>float</rotation>
            <scale>float</scale>
        </bone>
    </bones>

    <animation name="anim1">
        <keyframe frameToPlay="1">
            <bone id="1" transPosition="x,y" transRotation="float" transScale="float">
            </bone>

            <bone id="2" transPosition="x,y" transRotation="float" transScale="float">
            </bone>
        </keyframe>

        <keyframe frameToPlay="50">
            <bone id="1" transPosition="x,y" transRotation="float" transScale="float">
            </bone>

            <bone id="2" transPosition="x,y" transRotation="float" transScale="float">
            </bone>
        </keyframe>
    </animation>

    <animation name="anim2">
        <keyframe frameToPlay="1">
            <bone id="1" transPosition="x,y" transRotation="float" transScale="float">
            </bone>

            <bone id="2" transPosition="x,y" transRotation="float" transScale="float">
            </bone>
        </keyframe>

        <keyframe frameToPlay="50">
            <bone id="1" transPosition="x,y" transRotation="float" transScale="float">
            </bone>

            <bone id="2" transPosition="x,y" transRotation="float" transScale="float">
            </bone>
        </keyframe>
    </animation>
</skeleton> 
```

以下是我组织这个系统的方式的描述，如果它使我的代码更易于理解：

```
AnimationSystem – Management interface for all animations in game, handles updating of each skeleton
--List of skeletons
---Skeletons represent each object
--Update method that updates each skeleton with the game’s current frame
Animation
--List of keyframes
--List of frames, in ascending order, pulled from the list of keyframes
---Order index in list corresponds to order index in list of keyframes
---Should help to speed things up a little bit, no need to search every keyframe to determine which one has a frame value matching the one that is currently needed.
---Will be determined by a set up method after assets are loaded, but before the animation can be used.
--Method to return a keyframe that corresponds to a frame passed to the method
Skeleton
--List of animations
--List of bones
--Value to hold the currently selected animation
--Value to hold the current frame in the game
--Value to hold the name of the skeleton
--Upon moving to a new frame, searches currently selected animation’s list of frames to see if a keyframe should be “played” this frame. If a keyframe exists that should be played at this frame, it should go through each bone in its list of bones, and set the properties of each bone to the properties listed in the keyframe according to the bone’s id.
Bone
--Value to hold the stationary position
--Value to hold the stationary rotation
--Value to hold the stationary scale
--Value to hold the transformed position
--Value to hold the transformed rotation
--Value to hold the transformed scale
--Image value that holds the texture of the bone
--Value to hold the id of the bone within its skeleton
--Value to hold the name of the bone (Used in the editor)
--Method that takes 3 values (position, rotation and scale in that order) and set’s its own transformed pos, rot and scale values to those passed in.
Keyframe
--List of scale values
--List of position values
--List of rotation values
--List of bone ids
---Index of bone id in list matches up to index in scale, position and rotation lists so that the properties can be associated with the bone
--Time value at which the keyframe will be played
--Method to return the scale value of a bone as determined by the bone id passed in
--Method to return the position value of a bone as determined by the bone id passed in
--Method to return the rotation value of a bone as determined by the bone id passed in 
```

我为尝试解析此代码而编写的相关方法如下：

```
public static Skeleton parseSkeletonFile(String location) throws FileNotFoundException, IOException
    {
        try
        {
            Skeleton skelToReturn = null;

            File fileToLoad = new File(location);

            DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
            DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
            Document doc = dBuilder.parse(fileToLoad);

            doc.getDocumentElement().normalize();

            NodeList skelList = doc.getElementsByTagName("skeleton");

            for (int counter = 0; counter < skelList.getLength(); counter++)
            {
                Node skelNode = skelList.item(counter);

                Element skelElement = (Element)skelNode;

                skelToReturn = new Skeleton(skelElement.getAttribute("name"));

                NodeList allNodes = skelNode.getChildNodes();

                for (int counter2 = 0; counter2 < allNodes.getLength(); counter2++)
                {
                    Node currentNode = allNodes.item(counter2);

                    if (currentNode.getNodeName() == "bones")
                    {
                        NodeList bonesNL = currentNode.getChildNodes();

                        for (int counter3 = 0; counter3 < bonesNL.getLength(); counter3++)
                        {
                            Node currentBone = bonesNL.item(counter3);
                            Element currentBoneE = (Element)currentBone;

                            Bone bone = new Bone(
                                    currentBoneE.getAttribute("name"),
                                    new Point(
                                        Float.valueOf(currentBoneE.getElementsByTagName("position").item(0).getTextContent().split(",")[0]),
                                        Float.valueOf(currentBoneE.getElementsByTagName("position").item(0).getTextContent().split(",")[1])
                                        ),
                                    Float.valueOf(currentBoneE.getElementsByTagName("rotation").item(0).getTextContent()),
                                    Float.valueOf(currentBoneE.getElementsByTagName("scale").item(0).getTextContent()),
                                    Integer.valueOf(currentBoneE.getAttribute("id"))
                                    );

                            bone.setImage(new Image(currentBoneE.getAttribute("textureLoc")));

                            skelToReturn.bones.add(bone);
                        }
                    }

                    if (currentNode.getNodeName() == "animation")
                    {
                        NodeList animsNL = currentNode.getChildNodes();

                        for (int counter4 = 0; counter4 < animsNL.getLength(); counter4++)
                        {
                            Node currentAnim = animsNL.item(counter4);
                            Element currentAnimE = (Element)currentAnim;

                            Animation animation = new Animation(currentAnimE.getAttribute("name"));

                            NodeList keyframesNL = currentAnim.getChildNodes();

                            for (int counter5 = 0; counter5 < keyframesNL.getLength(); counter5++)
                            {
                                Node currentKeyframe = keyframesNL.item(counter5);
                                Element currentKeyframeE = (Element)currentKeyframe;

                                Keyframe keyframe = new Keyframe(Integer.valueOf(currentKeyframeE.getAttribute("frameToPlay")));

                                NodeList kfBonesNL = currentKeyframe.getChildNodes();

                                for (int counter6 = 0; counter6 < kfBonesNL.getLength(); counter6++)
                                {
                                    Node currentBoneTrans = kfBonesNL.item(counter6);
                                    Element currentBoneTransE = (Element)currentBoneTrans;

                                    keyframe.boneIDs.add(Integer.valueOf(currentBoneTransE.getAttribute("id")));
                                    keyframe.positions.add(new Point(Float.valueOf(currentBoneTransE.getAttribute("transPosition").split(",")[0]), Float.valueOf(currentBoneTransE.getAttribute("transPosition").split(",")[1])));
                                    keyframe.rotations.add(Float.valueOf(currentBoneTransE.getAttribute("transRotation")));
                                    keyframe.scales.add(Float.valueOf(currentBoneTransE.getAttribute("transScale")));
                                }
                                animation.keyframes.add(keyframe);
                                animation.frames.add(keyframe.getTimeToBePlayed());
                            }

                            skelToReturn.animations.add(animation);
                            skelToReturn.animationNames.add(animation.name);
                        }
                    }
                }
            }
            if (skelToReturn != null)
                return skelToReturn;
            else
                return null;
        } catch (Exception e)
        {
            e.printStackTrace();
        }

        return null;
    } 
```

这是我用来测试解析器的代码片段：

```
AnimationSystem animator = new AnimationSystem();
        try {
            skeleton = animator.parseSkeletonFile(getClass().getResource("SkeletonTest.xml").getPath());
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        if (skeleton != null)
        {
            System.out.println(skeleton.name);
        } 
```

这是在 Slick2D 中构建的简单游戏的 init 方法中。我尝试加载的文件 SkeletonTest.xml 与调用解析方法的类位于同一个包中。它的内容很简单：

```
<skeleton name="TestSkeleton">

</skeleton> 
```

这是我收到的完整错误消息：

```
java.io.FileNotFoundException: D:\Eclipse%20Workspace\2dSkeletalAnimator\bin\org\jason\animatorTests\SkeletonTest.xml (The system cannot find the path specified)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at sun.net.www.protocol.file.FileURLConnection.connect(Unknown Source)
    at sun.net.www.protocol.file.FileURLConnection.getInputStream(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLVersionDetector.determineDocVersion(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)
    at org.jason.skeletalanimator.AnimationSystem.parseSkeletonFile(AnimationSystem.java:42)
    at org.jason.animatorTests.AnimatorTest1.init(AnimatorTest1.java:32)
    at org.newdawn.slick.AppGameContainer.setup(AppGameContainer.java:433)
    at org.newdawn.slick.AppGameContainer.start(AppGameContainer.java:357)
    at org.jason.animatorTests.AnimatorTest1.main(AnimatorTest1.java:65) 
```

抱歉，有些笼统的问题和所需的背景信息量，但我已经尝试了几乎所有的方法来让它工作，而不是重写解析方法的主体。我宁愿不再经历那个烂摊子。所以我希望有更多经验从 XML 样式文件加载数据的人可以在这里帮助我。我感谢任何提前给我时间的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:00:16.040

一个问题是您试图`File`从类路径条目中获取一个。该`getPath()`方法返回文件 URL，而不是文件路径。然后，您尝试加载它，就好像它是导致问题的文件路径一样。

如果你使用`getClass().getResourceAsStream()`which 给你一个`InputStream`.

除了传递 a `location`，您可以将 an 传递`InputStream`给您的`parseSkeleton`方法并更改为使用[DocumentBuilder#parse(InputStream)](http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/parsers/DocumentBuilder.html#parse%28java.io.InputStream%29)。

使用 an 的另一个好处`InputStream`是，如果您将类打包到 JAR 文件中，您仍然可以加载资源（您将无法获得`File`JAR 内部的有效路径）。或者您的骨架定义可能来自任何其他`InputStream`，例如网络等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:47:08.167

java.io.FileNotFoundException: D:\Eclipse%20Workspace\2dSkeletalAnimator\bin\org\jason\animatorTests\SkeletonTest.xml（系统找不到指定的路径）

你的路径中有一个空间。这就是问题。注意 %20。我看不到它的编码位置，但您应该在拨打电话之前解码文件路径。

# python - 如果我在上次运行退出后立即重新启动，则 socket.accept() 中的参数异常无效

> ID：14862742
> 
> 赞同：12
> 
> 时间：2013-02-13T20:43:44.873
> 
> 标签：python, sockets

我有一个用 python 编写的客户端服务器架构。大多数时候它工作正常，但有时，在我停止服务器并立即重新启动它之后，我收到以下错误：

**接受失败，原因是：22 消息无效参数，错误：[Errno 22] 无效参数**

*但是*，如果我等待几分钟并再次启动相同的脚本而不进行任何更改，它就可以正常工作。

这是我在服务器上用来接受来自客户端的传入连接的循环：

```
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.bind(('',port))
    s.listen(1)
except:
    #logError()

while True:
    try:
        conn, address = s.accept() #THIS ACCEPT FAILS SOMETIMES
        multiprocessing.Process(target=HandleConnection, args=(conn, address, messageQueue, taskQueue, IOLock, numberOfConnections, numberOfConnectionsLock,resultsDirectory)).start()
    except socket.error, msg:
      #logError()  -> this except catches the error 
```

运行服务器后端口是否会阻塞一段时间？如果是这样，如果我想在服务器退出后立即重新启动服务器，是否有办法查询端口是否被阻塞并等到它被解除阻塞？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T20:45:19.393

您需要`SO_REUSEADDR`在绑定之前进行设置。

```
setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) 
```

否则可能会阻止套接字绑定，从而导致`accept`ing 时出错。如果您没有在第一个块中阻塞异常，您会注意到这个错误。

# android - 链接和可选择的 TextView？

> ID：14862750
> 
> 赞同：24
> 
> 时间：2013-02-13T20:44:18.877
> 
> 标签：android, textview, linkify, selectable

我想要一个`TextView`既可选择又可链接的。当我两者都做时，我最终得到了可选择的文本，但无法点击链接。

编辑：

我将展示代码来解释我的挣扎：

```
 TextView textView = view.findViewById(R.id.mytext);
    textView.setText("My text: +4412345678 Go to website: www.google.com Blah blah");
    Linkify.addLinks(textView, Linkify.ALL);

    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        textView.setTextIsSelectable(true);
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-19T16:33:58.150

您是否尝试将其添加到您的 TextView xml 代码中？

```
 <TextView
    ...
    android:autoLink="all"
    android:textIsSelectable="true" /> 
```

我已经在我的代码上尝试过，我可以在网络/邮件上拨打电话/冲浪，还可以选择所有文本。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-14T19:21:39.607

该`autoLink`属性有一个烦人的错误：如果您在电话号码上单击示例，然后返回并单击第二个 url 链接 - 它会再次打开电话号码。这个属性对多个链接的效果很差，我已经实现了自己的类，这里是 Github [ClickableLinksTextView.java上的链接](https://github.com/vortexwolf/2ch-Browser/blob/79da45711dc2fb07a794ed0e0d47f619fb77ad09/src/com/vortexwolf/dvach/common/controls/ClickableLinksTextView.java)

`TextView`在您的示例中，您可以在 xml-layout中用我的类替换您的类`ClickableLinksTextView`并更改如下代码：

```
ClickableLinksTextView textView = (ClickableLinksTextView)view.findViewById(R.id.mytext);
textView.setText("My text: +4412345678 Go to website: www.google.com Blah blah");
Linkify.addLinks(textView, Linkify.ALL);

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
    textView.setMovementMethod(ArrowKeyMovementMethod.getInstance());
    textView.setTextIsSelectable(true);
    // the autoLink attribute must be removed, if you hasn't set it then ok, otherwise call textView.setAutoLink(0);
} 
```

您问题中问题的最初原因是`LinkMovementMethod`类和`textIsSelectable`属性根本不兼容，甚至 Android OS 开发人员在[Android OS 源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/widget/TextView.java#3494)中也承认这一点。

> *不要更改支持文本选择的文本的移动方法，因为它会阻止任意光标位移。*

如果文本视图是可选的，则只有 2 个正确的移动方法值是`null`和`ArrowKeyMovementMethod`。这就是我`ArrowKeyMovementMethod`在示例中明确设置的原因，因为`Linkify.addLinks`设置了不正确的移动方法，我应该恢复它。

至于autoLink属性的bug，是因为android开发者没有正确复制链接检测。您可以查看@cheng yang 的答案中的代码示例，无论您拥有多少个，代码都只是获取第一个链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T00:12:07.107

问题出在 Android 的`TextView`. 调用本身`Linkify.addLinks()`不会更改自动链接掩码`TextView`。我认为他们检查 mAutoLinkMask 是一个 Android 错误。因此，如果您`android:autoLink`在`xml`文件中设置或调用`setAutoLinkMask()`非 0 值，它将起作用。

仅供参考，`TextView`的源代码：

```
 if (touchIsFinished && mLinksClickable && mAutoLinkMask != 0 && textIsSelectable) {
            // The LinkMovementMethod which should handle taps on links has not been installed
            // on non editable text that support text selection.
            // We reproduce its behavior here to open links for these.
            ClickableSpan[] links = ((Spannable) mText).getSpans(getSelectionStart(),
                    getSelectionEnd(), ClickableSpan.class);

            if (links.length > 0) {
                links[0].onClick(this);
                handled = true;
            }
        } 
```

# java - html header setting

> ID：14862753
> 
> 赞同：-2
> 
> 时间：2013-02-13T20:44:33.323
> 
> 标签：java, caching

I am java developer. I need to know how to set expiration time for caching.

Any help is appreciated.

Is there any best way to do this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:58:05.410

以下是在客户端执行此操作的方法： RESPONSE.setHeader('Cache-Control', 'max-age=86400, s-maxage=86400, public, must-revalidate, proxy-revalidate')

这是更多信息和示例： [来源和示例：](https://weblion.psu.edu/trac/weblion/changeset/14552)

# operating-system - 我是否正确理解操作系统的双模式操作？

> ID：14862754
> 
> 赞同：4
> 
> 时间：2013-02-13T20:44:36.513
> 
> 标签：operating-system

我试图了解操作系统的双模式操作是什么。我从各种来源了解到，这是系统保护自身和其他组件免受用户基本滥用的一种方式。

（我假设——因为我模糊地看到了一些关于模式位的东西）每个进程都被分配了一个模式位来区分用户模式和内核模式进程。模式位存储在过程控制块中。

因此，它只是一种告诉用户启动了哪个进程以及操作系统启动了哪个进程的方法；授予某些特权？（为什么叫内核模式而不是操作系统模式）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:46:42.007

没有每个进程模式位。处理器 (CPU) 有两种模式（多于两种，但在本次讨论中假设它只有 2 种） - 用户模式和特权模式。处理器在用户模式下执行用户空间进程。这基本上是为了确保用户空间进程没有超出必要的控制权（从而防止恶意用户弄乱系统的硬件）。现在，当用户进程必须使用硬件（例如，文件系统或 IO）时，它必须请求内核代表它执行此操作。它使用系统调用来实现这一点，该系统调用在内部将 CPU 模式更改为特权模式，从而为系统调用代码提供对系统的完全访问权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T08:53:35.880

Dual-Mode Operation ，它允许操作系统保护自己和其他系统组件有一个硬件提供的称为模式位的东西，它提供了区分系统何时运行用户代码或内核代码的能力:)

# visual-studio-2010 - How can I compile GNU Triangulated Surface Library GTS in windows for Visual Studio C++ project?

> ID：14862755
> 
> 赞同：1
> 
> 时间：2013-02-13T20:44:38.797
> 
> 标签：visual-studio-2010, gnu, pixelsense, triangulation, triangular

How can I install/build/compile GNU Triangulated Surface Library GTS using visual studio 2010 c++ under windows platform. I want to use gts library in my visual studio c++ project. I tried a lot but no success. I couldn't even find the instruction for installation in windows. Any help ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T00:34:48.300

在 src 文件夹下，有一个 makefile.msc。你可以试试。

# html - 引导缩略图列表未显示缩略图

> ID：14862758
> 
> 赞同：11
> 
> 时间：2013-02-13T20:44:56.563
> 
> 标签：html, twitter-bootstrap, thumbnails, image

我在我下载的主题上使用 twitter 引导程序，并且我的引导程序缩略图列表中的自定义 html 正在显示，但图像没有。

调查代码，显示图像标签和工作图像位置在那里。这是正在发生的事情的图片：

![在此处输入图像描述](../Images/d317e50e459a877b257a22542877d853.png)

我的缩略图列表的代码是这样的：

```
<div class="span9 space"><ul class="thumbnails"><li class="span3">
                        <div class="thumbnail">
                            <img data-src="http://s3.amazonaws.com/brewerydbapi/beer/YAKFea/upload_1CxY2l-medium.png" alt="">
                            <h3>90 Shilling</h3>
                            <p>Odell Brewing Company</p>
                        </div>
                    </li><li class="span3">
                        <div class="thumbnail">
                            <img data-src="http://s3.amazonaws.com/brewerydbapi/beer/oeGSxs/upload_FiPLQC-medium.png" alt="">
                            <h3>Naughty 90</h3>
                            <p>Toppling Goliath Brewing Company</p>
                        </div>
                    </li><li class="span3">
                        <div class="thumbnail">
                            <img data-src="noImage.gif" alt="">
                            <h3>90-Shilling Scotch Ale</h3>
                            <p>Taps Fish House & Brewery</p>
                        </div>
                    </li><li class="span3">
                        <div class="thumbnail">
                            <img data-src="noImage.gif" alt="">
                            <h3>Williams Ceilidh 90</h3>
                            <p>Williams Brothers Brewing Company</p>
                        </div>
                    </li><li class="span3">
                        <div class="thumbnail">
                            <img data-src="noImage.gif" alt="">
                            <h3>Boscos 90 Shilling Ale</h3>
                            <p>Boscos Brewing Company</p>
                        </div>
                    </li><li class="span3">
                        <div class="thumbnail">
                            <img data-src="noImage.gif" alt="">
                            <h3>Dundee Export 90 Scotch Ale</h3>
                            <p>Dundee Brewing Co.</p>
                        </div>
                    </li><li class="span3">
                        <div class="thumbnail">
                            <img data-src="https://s3.amazonaws.com/brewerydbapi/beer/qqTzHb/upload_mGIvsJ-medium.png" alt="">
                            <h3>90 Minute IPA</h3>
                            <p>Dogfish Head Craft Brewery</p>
                        </div>
                    </li><li class="span3">
                        <div class="thumbnail">
                            <img data-src="http://s3.amazonaws.com/brewerydbapi/beer/jdQySZ/upload_jbcADO-medium.png" alt="">
                            <h3>I-90 India Pale Ale</h3>
                            <p>Ancient Lakes Brewing Company</p>
                        </div>
                    </li></ul>                    

            </div> 
```

最后，chrome 检查元素中显示零错误，并且我在此页面上没有任何内联 css。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-31T10:06:53.640

`data-src`用于在引导示例中获取占位符图像。只需使用`src`

# css - 为什么这两个内联块没有对齐？

> ID：14862759
> 
> 赞同：3
> 
> 时间：2013-02-13T20:45:05.750
> 
> 标签：css

这两个内联块`<div>`应该（至少，我认为它们会）对齐：

```
<div class="calendar">
    <div class="month">
        <div class="month-name">January</div>
    </div>
    <div class="day">
        <div class="day-number">21</div>
        <div class="day-name">Wednesday</div>
    </div>
</div>

<div class="button"></div> 
```

`<div>`我已经设置了每个像素精度的高度：

```
.calendar {
    display: inline-block;
    width: 80px;
    height: 74px;
}
.calendar .month {
    background-color: firebrick;
    border-radius: 3px 3px 0 0;
}
.calendar .month-name {
    color: white;
    font-size: 13px;
    text-align: center;
    height: 26px;
}
.calendar .day {
    background-color: linen;
    border-radius: 0 0 3px 3px;
}
.calendar .day .day-number {
    color: black;
    font-size: 26px;
    font-weight: bold;
    text-align: center;
    height: 30px;
}
.calendar .day .day-name {
    color: darkgray;
    font-size: 10px;
    text-align: center;
    height: 18px;
}

.button {
    background-color: silver;
    display: inline-block;
    border-radius: 3px;
    width: 220px;
    height: 74px;
} 
```

但这会产生以下结果：

![内联块](../Images/47ebf197fb97e3bab1c9c95b584032a9.png)

这是这段代码的一个[小提琴](http://jsfiddle.net/s2cp6/)。

这让我发疯，但结果在多个浏览器中是一致的，所以我一定做错了什么。

任何人都可以解释原因并提供解决方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T20:46:13.023

做`vertical-align:top`任何有内联块的事情。

`.calendar { vertical-align: top; }`

解释：inline-blocks 仍然是“in-line”并且垂直对齐是基线，这意味着它们不一致并且会随着它们的高度而变化，top 使它们始终从顶部开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T20:46:27.253

将垂直对齐设置为日历 div 的顶部

```
.calendar {
    display: inline-block;
    width: 80px;
    height: 74px;
    vertical-align:top;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/s2cp6/1/)**

# excel - 在excel中动态添加按钮到行

> ID：14862760
> 
> 赞同：0
> 
> 时间：2013-02-13T20:45:06.980
> 
> 标签：excel, vba

我是 Excel 宏编码的新手，我有一个要求，在 Excel 中，用户在 A 列中输入一些数值，一旦他跳出屏幕，应该在同一行中生成一个新按钮G 列的标签与 A 列中的值的标签相同，并且将在按钮中添加一个宏功能。

此外，如果用户从 A 列的行中删除值，则相应的按钮也应该被删除。

我尝试了某些论坛，但无法找到创建焦点按钮的代码。

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:07:00.840

试试这个代码：

```
Private Const mcStrButtonAddress As String = "D3" 'The cell or range which is used for top and left position of button
Private Const mcStrMacroToRun As String = "Macro1"
Private Const mcStrButtonName As String = "Button" 'Used internally to delete button

Private Sub Worksheet_Change(ByVal Target As Range)
    If Application.Intersect(Target, Range("A1")) Is Nothing Then Exit Sub

    'To disable endless loop
    Application.EnableEvents = False

    'Delete button
    On Error Resume Next
    Me.Buttons(mcStrButtonName).Delete

    On Error GoTo 0
    'Insert button
    With Me.Buttons.Add( _
        Range(mcStrButtonAddress).Left, _
        Range(mcStrButtonAddress).Top, _
        Range(mcStrButtonAddress).Width, _
        Range(mcStrButtonAddress).Height)

        'Configure button
        .Name = mcStrButtonName
        .Characters.Text = Target.Value
        .OnAction = mcStrMacroToRun
    End With

    'Reenable events
    Application.EnableEvents = True
End Sub 
```

您需要将其插入工作表的代码模块中。

# javascript - turn image into string from

> ID：14862763
> 
> 赞同：0
> 
> 时间：2013-02-13T20:45:11.703
> 
> 标签：javascript, image, base64, html5-canvas

Is it possible to turn an image into a base64 string with these restrictions,

1.  Image is coming from `<input type="file"/>`
2.  No internet connection
3.  Mobile Browser

I know I can download an image and convert it using `<canvas>`, but is it possible to access the image before it's uploaded? If this is not possible I am going to write a PhoneGap plugin.

Thanks!

Edit-

Got this working using the FileReader API. Here's the relivant code,

```
var reader = new FileReader();
reader.onload = function(theFile) {
    var base64Image = theFile.srcElement.result;
};

// Read in the image file as a data URL.
reader.readAsDataURL(image.fileElement.dom.files[0]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:55:52.480

拦截`submit`表单上的事件，并读取那里的数据。如果需要，您可以中止提交，并将数据保存在本地。

# java - Log4J2 - 在运行时分配文件附加程序文件名

> ID：14862770
> 
> 赞同：45
> 
> 时间：2013-02-13T20:45:38.347
> 
> 标签：java, log4j, log4j2

我在类路径中有一个 log4j2.xml 配置文件。其中一个附加程序是文件附加程序，我想在运行时在 Java 应用程序中设置目标文件名。

根据[文档](http://logging.apache.org/log4j/2.x/manual/configuration.html#PropertySubstitution)，我应该能够在 log4j2.xml 文件中使用双“$”和上下文前缀：

```
<appenders>
    <File name="MyFile" fileName="$${sys:logFilename}">
        <PatternLayout pattern="%-4r %d{${datestamp}} [%t] %-5level %logger{36} - %msg%n"/>
    </File>
</appenders> 
```

其中“sys”前缀表示配置器将在系统属性中查找属性“logFilename”。所以在应用程序中，我调用（相当早）：

```
System.setProperty("logFilename", filename); 
```

我还在 xml 文件中打开了 log4j2 的自动重新配置：

```
<configuration status="debug" monitorInterval="5">> 
```

不幸的是，这没有任何效果，并且永远不会创建日志文件。一些 log4j2 状态输出如下：

> 2013-02-13 15:36:37,574 调试在类 org.apache.logging.log4j.core.appender.FileAppender 上为元素文件调用 createAppender 参数（fileName="${sys:logFilename}"，append="null" ，locking="null"，name="MyFile"，immediateFlush="null"，suppressExceptions="null"，bufferedIO="null"，PatternLayout(%-4r %d{yyyy-MM-dd/HH:mm:ss .SSS/zzz} [%t] %-5level %logger{36} - %msg%n), null)
> 
> 2013-02-13 15:36:37,576 调试启动 FileManager ${sys:logFilename}

**如何在运行时设置 File Appender 中的“fileName”值？** 或者，我怎样才能在运行时简单地将新的 File Appender 添加到根记录器？在 Log4j 2.0 中，大部分用于更改配置的 API 都是隐藏的。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-14T15:01:00.587

*h/t rgoers* FileAppender 不支持文件名上的两个美元符号，因为文件是在启动 appender 时打开的。您用两个美元符号表示的是您希望（可能）为每个事件使用不同的文件名。

使用单个 $（如`${sys:logFilename}`），系统将在系统属性中查找属性“logFilename”。

因此，log4j2.xml 应该有：

```
<appenders>
    <File name="MyFile" fileName="${sys:logFilename}">
        <PatternLayout pattern="%-4r %d{${datestamp}} [%t] %-5level %logger{36} - %msg%n"/>
    </File>
</appenders> 
```

Java 应用程序应该设置系统属性：

```
System.setProperty("logFilename", filename); 
```

并**重新配置记录器：**

```
org.apache.logging.log4j.core.LoggerContext ctx =
    (org.apache.logging.log4j.core.LoggerContext) LogManager.getContext(false);
ctx.reconfigure(); 
```

这会产生所需的行为。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-12-21T21:12:04.623

从 log4j2 **2.5**版开始，这是实现此目的的最简单方法：

**在你的`log4j2.xml`**：

```
<Appenders>
   <File name="MyFile" filename="${sys:logFilename}">
   ... 
```

**在你的主`MyApp.java`文件中**：

```
public class MyApp {

    Logger log;

    static {
          System.setProperty("logFilename", ...);
          log = LogManager.getLogger();
    }

    public static void main(String... args) {...}
} 
```

**CATCH：**您应该`logFilename`在加载 log4j2 之前设置系统属性。在此示例中调用`LogManager.getLogger`.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-06-29T09:55:06.623

我知道这个话题很老，但答案并不适合我。这是一个允许您在运行时重新配置现有 Appender 的函数：

```
static void updateLogger(String file_name, String appender_name, String package_name){
LoggerContext context = (LoggerContext) LogManager.getContext(false);
    Configuration configuration = context.getConfiguration();
    Layout<? extends Serializable> old_layout = configuration.getAppender(appender_name).getLayout();

    //delete old appender/logger
    configuration.getAppender(appender_name).stop();
    configuration.removeLogger(package_name);

    //create new appender/logger
    LoggerConfig loggerConfig = new LoggerConfig(package_name, Level.INFO, false);
    FileAppender appender = FileAppender.createAppender(file_name, "false", "false", appender_name, "true", "true", "true",
            "8192", old_layout, null, "false", "", configuration);
    appender.start();
    loggerConfig.addAppender(appender, Level.INFO, null);
    configuration.addLogger(package_name, loggerConfig);

    context.updateLoggers();
} 
```

您可以指定文件名、附加程序的名称和要记录的包名称。

示例记录器：

```
<File name="fileWriter_api" fileName="${LOG_DIR}/api.log" append="false">
  <PatternLayout pattern="${PATTERN}"/>
</File> 
```

可以像这样重新配置调用：

```
updateLogger("log/api_new.log", "fileWriter_api", "my.package"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-18T12:36:47.620

您可以做的是，在运行应用程序时，`logFilename`作为参数传递给 JVM：

```
java -DlogFilename=myAppName.log -jar /path/to/myApp.jar 
```

# html - How to set Inputtextarea attributes to display maximum length, rows and width

> ID：14862773
> 
> 赞同：0
> 
> 时间：2013-02-13T20:45:45.863
> 
> 标签：html, jsf-2

I set up this html code in jsf and it doesnt limit the length of characters, it still go beyond 576 characters how do I set it up? I need to set up the rows to 4 but opted to do style to be consistent on all browsers, is this correct? Here is the code.

```
<td colspan="7">
 <h:outputText id="explanation1"
    value="#{handler.document.header.docDesc}"
rendered="#{documentHandler.mode != 2}"/>
 <h:inputTextarea id="explanation2" 
    value="#{documentHandler.document.header.docDesc}"
rendered="#{documentHandler.mode == 2}" 
style="height: 60px; width: 705px;"> 
    <f:validateLength maximum="576"/> 
</h:inputTextarea>   
</td> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:08:41.360

首先，当您正在编写一些**JSF**时，我建议您也迁移 HTML 表格并将其转换为[`h:dataTable`](http://www.jsftoolbox.com/documentation/help/12-TagReference/html/h_dataTable.html). 除此之外，`<f:validateLength maximum="576"/>`标签正在进行**JSF 验证**，这仅在服务器端完成。这意味着您不会限制客户端（浏览器）的输入，仅在发送表单时执行验证，并且这一切都在服务器端完成。

要在客户端执行此操作，您必须使用 Javascript/JQuery 解决方案。请记住分配`textArea`一个`styleClass`被调用的`max`：

```
$('textarea.max').keyup(function() {
var $textarea = $(this);
var max = 576;
if ($textarea.val().length > max) {
    $textarea.val($textarea.val().substr(0, max));
}
}); 
```

[原始链接](https://stackoverflow.com/a/4924933/1199132)

# ruby - 在模块中定义类方法

> ID：14862775
> 
> 赞同：1
> 
> 时间：2013-02-13T20:45:49.143
> 
> 标签：ruby

我的意思是，我想在我的模块中创建一个类方法，该方法将由包含该模块的类使用。它们位于单独的文件中。

到目前为止，我有这样的事情：

```
module Base
  def self.all
    puts "All Users"
  end
end

class User
  include Base
end 
```

但我得到：`NoMethodError: undefined method`所有用户：类`

你能否解释一下这个问题，如果我做的是一种不好的做法或违反任何原则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:50:17.890

你可以`extend`在你的班级模块，你的代码应该是这样的：

```
module Base
  def all
    puts "All Users"
  end
end

class User
  extend Base
end 
```

当你做这样的事情时：

```
module MyModule
  def self.module_method
    puts "module!"
  end
end 
```

您实际上是在模块本身中添加方法，您可以像这样调用以前的方法：

```
MyModule.module_method 
```

有一种方法可以包含`module`并获得您想要的行为，但我认为这不能被认为是“要走的路”。看例子：

```
module Base
  def self.included(klass)
    def klass.all
      puts "all users"
    end
  end
end

class User
  include Base
end 
```

但就像我说的，如果你可以使用`extend`类方法，那就更好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:55:24.400

按照 Ricardo 的回答，考虑 Ruby 程序员中常见的一个习惯用法 - 将模块的类方法封装到内部模块中，称为 ClassMethods（我知道这很拗口），并使用 Module#included 钩子来使用 ClassMethods 模块扩展基类。

更多信息在这里：[http ://www.railstips.org/blog/archives/2009/05/15/include-vs-extend-in-ruby/](http://www.railstips.org/blog/archives/2009/05/15/include-vs-extend-in-ruby/)

# mysql - “未找到数据源名称且未指定默认驱动程序”连接mysql

> ID：14862777
> 
> 赞同：1
> 
> 时间：2013-02-13T20:45:52.453
> 
> 标签：mysql, asp.net, asp-classic, oledb

由于一些技术原因，我不得不将我的数据库从 sql server 更改为 MySQL。但是我收到以下错误，我无法连接到数据库..！

> 用于 ODBC 驱动程序的 Microsoft OLE DB 提供程序错误“80004005”
> 
> [Microsoft][ODBC Driver Manager] 未找到数据源名称且未指定默认驱动程序

```
Set ObjConn = CreateObject("ADODB.Connection")
ObjConn.Open ("DRIVER={MySQL ODBC 5.0.96 Driver};SERVER=68.128.172.38;DATABASE=xxx;UID=xxx;PWD=xxx") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T11:14:54.730

这里有一个示例连接字符串

```
Server_Name = "localhost" 'connect to the local  remort database server

databseName = "db" 'database name
mySQLUser = "root" 'user name
mysqlPassword = "admin" 'passwrd of the db user

ConStr= "Driver={MySQL ODBC 5.1 Driver};SERVER=" & Server_Name  & ";DATABASE=" & databseName & ";UID=" & mySQLUser & ";PWD=" & mysqlPassword & ";PORT=3306;OPTION=67108864;" ' Connection string 
```

如果这不起作用，请尝试为 mysql 安装相关连接器[选择并下载连接器](http://www.mysql.com/products/connector/)

# php - Recursive wget via PHP exec() fetches only first page?

> ID：14862786
> 
> 赞同：0
> 
> 时间：2013-02-13T20:46:17.350
> 
> 标签：php, exec, wget

The following wget command does a good job at recursively crawling the full domain, saving the downloaded files in a single folder, and then deleting it all:

```
wget --delete-after -r -nd http://www.example.com/ 
```

When run from the command line, this works perfectly. When run via PHP's exec (or system, shell_exec, passthru) as follows, it only fetches the index page, but seems to go no deeper than that:

```
exec('wget --delete-after -r -nd http://www.example.com/'); 
```

If this were a permissions issue, I'd think it wouldn't download the index page either, but it does (noticeable when I take out '--delete-after').

There's no robots.txt involved, and no output is shown if I pass it through echo. What am I missing?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T20:17:05.780

毕竟这似乎是一个权限问题，因为添加 --directory-prefix 参数修复了它。

```
wget --delete-after -q -r -nd -P /home/example.com/public_html/tmp/ http://www.example.com 
```

我将前缀设置为 php-fpm 肯定可以访问的目录，而之前坦率地说，我不知道它将文件临时保存在哪里（'.' 是默认目录，但那会在哪里呢？）。

# android - 无法为 Android 构建 GStreamer 教程

> ID：14862795
> 
> 赞同：7
> 
> 时间：2013-02-13T20:46:44.413
> 
> 标签：android, android-ndk, gstreamer

我在尝试构建 GStreamer Android 教程时遇到了许多问题。

我的环境是：

*   Mac OS X 7
*   安卓 SDK 版本 17
*   安卓 NDK 8d

我能够在 Eclipse 和命令行中构建和运行 NDK 示例。

我已经下载了[http://cdn.gstreamer.com/android/arm/gstreamer-sdk-android-arm-debug-2012.11.tar.bz2](http://cdn.gstreamer.com/android/arm/gstreamer-sdk-android-arm-debug-2012.11.tar.bz2)并将 GSTREAMER_SDK_ROOT_ANDROID 环境变量添加到我的 .bash_profile 中。

当我尝试通过 Eclipse 构建 android-tutorial-1 时，出现以下错误：

```
12:12:05 **** Incremental Build of configuration Default for project Tutorial1 ****
/apps/tools/android-ndk-r8d/ndk-build all 
jni/Android.mk:13: *** GSTREAMER_SDK_ROOT_ANDROID is not defined!.  Stop.

12:12:05 Build Finished (took 104ms) 
```

我尝试将 GSTREAMER_SDK_ROOT_ANDROID 添加到 Eclispe 中的 C++ 构建变量中，但这没有任何区别。

当我尝试通过命令行构建时，出现以下错误：

```
/bin/sh: pkg-config: command not found
/bin/sh: pkg-config: command not found
/bin/sh: pkg-config: command not found
GStreamer      : [GEN] => gst-build/gstreamer_android.c
GStreamer      : [COMPILE] => gst-build/gstreamer_android.c
gst-build/gstreamer_android.c:2:21: fatal error: gst/gst.h: No such file or directory
compilation terminated.
make: *** [gst-build/gstreamer_android.o] Error 1 
```

我想不通的是 gst/gst.h 无法解决？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-10-02T10:10:50.543

在这里你面临两个问题

### 1\. GSTREAMER_SDK_ROOT_ANDROID 未定义

可以通过设置`GSTREAMER_SDK_ROOT_ANDROID`环境变量（在 eclipse 或`Android.mk`文件中）轻松解决，在我的情况下，我已经像这样指定了这个变量

```
GSTREAMER_VERSION   := 1.4.1
GSTREAMER_SDK_ROOT  := /Volumes/Data/Developers/Library/gstreamer-1.0-sdk-android/$(TARGET_ARCH_ABI)-$(APP_OPTIM)-$(GSTREAMER_VERSION) 
```

1.  `TARGET_ARCH_ABI`- 预定义变量（在我的情况下`armeabi-v7a`）
2.  `APP_OPTIM`- 预定义变量`release`或`debug`

在您的情况下`GSTREAMER_SDK_ROOT`当然会有所不同，但是如果您需要支持多个拱门，使用预定义的变量会很有帮助

### 2.你`pkg-confing`不在`PATH`

正如您所看到的，默认情况下使用`sh`shell

```
/bin/sh: pkg-config: command not found
/bin/sh: pkg-config: command not found
/bin/sh: pkg-config: command not found 
```

它找不到`pkg-config`，因为最初`PATH=/usr/bin:/bin:/usr/sbin:/sbin`. 如果您在 OSX 上安装`pkg-config`，`brew`它已被放置到`/usr/local/bin`

```
bash-3.2$ which pkg-config
/usr/local/bin/pkg-config 
```

要修复`PATH`，您可以指定自己的外壳

```
SHELL := PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin /bin/bash 
```

这不是完美的解决方案，但它有效

### Gradle 用户更新

由于`2.2.0-alpha3`gradle android 插件支持这样的外部构建系统（将其添加到`build.gradle`内部`android`定义中）

```
android { 
    ...
    externalNativeBuild {
        ndkBuild {
            path "${projectDir.absolutePath}/src/main/jni/Android.mk"
        }
    }
} 
```

不要忘记清理`jni.srcDirs`，因为坏插件会首先启动，`jni.srcDirs`在运行时清理添加

```
android { 
    ...
    task disableDefaultNdkBuild << {
        android.sourceSets.main.jni.srcDirs = []
        android.sourceSets.main.jniLibs.srcDir 'src/main/libs'
    }

    preBuild.dependsOn disableDefaultNdkBuild
} 
```

现已提供官方指南[https://gstreamer.freedesktop.org/documentation/tutorials/android/link-against-gstreamer.html](https://gstreamer.freedesktop.org/documentation/tutorials/android/link-against-gstreamer.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-25T22:04:54.740

我在 GStreamer Android 邮件列表上发布了上述问题并得到以下回复：

> 嗨，很遗憾，我们忘记包含`pkg-config`在 Mac OS X 的这个版本中。你可以从这里下载它：http: [//macpkg.sourceforge.net/](http://macpkg.sourceforge.net/)

我使用自制软件进行安装`pkg-config`，并且能够通过命令行使用`ndk-build`.

我在 Eclipse 中仍然存在许多问题：

1.  *** `GSTREAMER_SDK_ROOT_ANDROID`未定义！- 我无法让 Eclipse 获取此变量
2.  如果我将变量硬编码到 make 文件中，我会得到`/bin/sh: pkg-config: command not found`- pkg-config 已安装并通过 CLI 工作

我相信其中一些问题与 Android[问题 33788](http://code.google.com/p/android/issues/detail?id=33788)有关，我尝试使用 CDT 8.0.2 而不是 CDT 8.10 来解决它们，但它没有解决上述任何一个问题。

我现在通过执行以下操作解决了这个问题：

1.  为我的项目禁用 CDT 构建
2.  使用 CLI ndk-build 构建 NDK 代码
3.  像往常一样通过 Eclipse 构建应用程序并将其部署到我的设备

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-02T03:30:43.170

对于 error1: jni/Android.mk:13: *** GSTREAMER_SDK_ROOT_ANDROID 未定义！。停止。

**您可以在您的 Android.mk 文件中定义 GSTREAMER_SDK_ROOT_ANDROID := XXXXX(您的 Gstreamer_Android_SDK 路径)！**

对于error2：致命错误：gst/gst.h：没有这样的文件或目录

**您可以在 C/C++ General -> Paths and Symbols -> inlude 中包含 (Gstreamer_Android_SDK Path)/include/gstreamer0.10/！**

希望这会有所帮助:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-26T10:25:12.667

我在 Eclipse 中使用 ADT，也许您可​​以通过以下步骤将 GSTREAMER_SDK_ROOT_ANDROID 定义为项目环境变量：

`Project -> Properties -> C/C++ Build -> Environment -> Add`

而不是在 .mk 文件中定义它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-16T00:09:34.543

我面临同样的问题，但在互联网上没有发现任何问题。但不知何故，对这个问题的详细研究让我解决了这个问题。

要解决它，您需要在eclipse中执行以下步骤：

1.  去`Windows->preferences->c/c++->build->Environment`
2.  单击`Add`窗口最右侧的按钮
3.  在名称字段中输入“ `GSTREAMER_SDK_ROOT_ANDROID`”
4.  在该`Value`字段中输入 GStreamer SDK 的位置。就我而言，它是“ `C:\GStreamer_SDK`”。这是问题...。您需要使用正斜杠“ `/`”而不是反斜杠“ `\`”才能使其正常工作。所以我的 Gstreamer SDK 位置看起来像这样“ `C:/GStreamer_SDK`”

一旦你完成了它。您需要对`Android.mk`项目的文件进行一些更改。

转到以下行

```
GSTREAMER_NDK_BUILD_PATH  := $(GSTREAMER_SDK_ROOT)/share/gst-android/ndk-build/ 
```

并从代码行中删除结尾的正斜杠。所以它看起来像这样。

```
GSTREAMER_NDK_BUILD_PATH  := $(GSTREAMER_SDK_ROOT)/share/gst-android/ndk-build 
```

保存它，你就完成了！

如果您不删除斜杠，它将在构建过程中生成路径，如下所示

```
c:/GStreamer_SDK/share/gst-android/ndk-build//gstreamer.mk 
```

双斜线是构建过程中的问题。

现在右键单击`project->clean`项目

现在通过右键单击您的`project->build`项目来构建它。

如果 Eclipse 在构建时挂起，只需转到任务管理器并终止`make.exe`服务两次。

在您的设备或模拟器上运行您的项目。玩得开心！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-16T15:27:24.097

@CAMOBAP 谢谢你的帖子。它真的对我有帮助。我可以在 Eclipse 中构建 Android 示例。主要问题是：

```
SHELL := PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin /bin/bash 
```

对于 GSTREAMER_SDK_ROOT_ANDROID

1.  右键单击 Project->Properties->C/C++ Build->Environment Add-> 名称：GSTREAMER_SDK_ROOT_ANDROID 值：/Users/Your/Path/To/gstreamer-sdk-android-arm-release-2013.6 也为构建变量添加它.

下一步：您不必从 MAC 中的代码行中删除结尾的正斜杠，也不必在 Eclipse 中添加 Includes。这些依赖关系将在首次构建后自动解决。确保您的 Android SDK 和 NDK 在 Eclipse 中运行良好。我还将 SDK 和 NDK 路径添加到：

```
nano .bash_profile 
```

这是在 MAC 上运行的。我还将清单文件更改为：

```
 android:minSdkVersion="xx"
    android:targetSdkVersion="xx" /> 
```

对于 Android Gstreamer 的教程 5，您需要添加 sdcard 权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

# php - PHP+MySQL，按类别输出结果

> ID：14862806
> 
> 赞同：0
> 
> 时间：2013-02-13T20:47:14.570
> 
> 标签：php, mysql, group-by, iterator, wordpress

我正在尝试破解 WP 插件“Contact Form 7”（带有 DB 扩展名），以便在用户提交表单后根据自己的喜好输出结果。我理解为什么插件必须按照它的方式排列数据库，但我在分离条目时遇到了麻烦。通常我会有一个可以使用的索引，但在这里我没有。

这是我的桌子的样子。

```
+-----------------+-----------+-----------------+---------------------+-------------+------+
|   submit_time   | form_name |   field_name    |     field_value     | field_order | file |
+-----------------+-----------+-----------------+---------------------+-------------+------+
| 1360190186.3500 | RSVP 2    | text-796        | Mindi               |           0 | NULL |
| 1360190186.3500 | RSVP 2    | text-664        | Smith               |           1 | NULL |
| 1360190186.3500 | RSVP 2    | text-635        | New York            |           2 | NULL |
| 1360190186.3500 | RSVP 2    | menu-359        | A friend of Sarah's |           3 | NULL |
| 1360190186.3500 | RSVP 2    | textarea-518    |                     |           4 | NULL |
| 1360190186.3500 | RSVP 2    | file-29         |                     |           5 | NULL |
| 1360190186.3500 | RSVP 2    | textarea-652    |                     |           6 | NULL |
| 1360190186.3500 | RSVP 2    | Submitted Login | admin               |        9999 | NULL |
| 1360190186.3500 | RSVP 2    | Submitted From  | ::1                 |       10000 | NULL |
| 1360191326.9700 | RSVP 2    | text-796        | Joe                 |           0 | NULL |
| 1360191326.9700 | RSVP 2    | text-664        | Blow                |           1 | NULL |
| 1360191326.9700 | RSVP 2    | text-635        | Somewhere           |           2 | NULL |
| 1360191326.9700 | RSVP 2    | menu-359        | A friend of Bob's   |           3 | NULL |
| 1360191326.9700 | RSVP 2    | textarea-518    |                     |           4 | NULL |
| 1360191326.9700 | RSVP 2    | file-29         |                     |           5 | NULL |
| 1360191326.9700 | RSVP 2    | textarea-652    |                     |           6 | NULL |
| 1360191326.9700 | RSVP 2    | Submitted Login | admin               |        9999 | NULL |
| 1360191326.9700 | RSVP 2    | Submitted From  | ::1                 |       10000 | NULL |
| 1360361333.8800 | RSVP 2    | text-796        | Once                |           0 | NULL |
| 1360361333.8800 | RSVP 2    | text-664        | Again               |           1 | NULL |
| 1360361333.8800 | RSVP 2    | text-635        | Somewhere           |           2 | NULL |
| 1360361333.8800 | RSVP 2    | menu-359        | A friend of Bob's   |           3 | NULL |
| 1360361333.8800 | RSVP 2    | textarea-518    |                     |           4 | NULL |
| 1360361333.8800 | RSVP 2    | file-29         |                     |           5 | NULL |
| 1360361333.8800 | RSVP 2    | textarea-652    |                     |           6 | NULL |
| 1360361333.8800 | RSVP 2    | Submitted Login | admin               |        9999 | NULL |
| 1360361333.8800 | RSVP 2    | Submitted From  | ::1                 |       10000 | NULL |
+-----------------+-----------+-----------------+---------------------+-------------+------+ 
```

我的 PHP 有点生疏，所以我想知道迭代唯一唯一字段（'submit_time'）以隔离条目的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:56:49.727

我猜你正在使用`$result = mysql_query();`或类似的东西来获取这些值。然后执行以下操作：

```
while ($row = mysql_fetch_assoc($result /*or your result varname*/ )) {
    //do the things you want to do
} 
```

$row 现在是一个关联数组，其中包含 mySql 表包含的字段。在您的情况下，您可以使用它来打印`field_name`-column（只是一个示例）：

```
//inside the while-loop:
echo $row["field_name"]."<br/>"; 
```

这样您就可以读取表格的每个条目。循环的每次重复都会增加您正在读出的行号。如果你在最后或有错误，`mysql_fetch_assoc()`返回`false`并退出循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T22:43:38.527

我能够通过创建一个具有唯一`submit_time`字段的数组来解决它，然后循环遍历每个字段，并将其作为查询中的变量。对于那些感兴趣的人来说，这里是结果。

```
$group = mysql_query('SELECT * FROM wp_cf7dbplugin_submits GROUP BY submit_time');

while ($st = mysql_fetch_row($group)) {
    $myarray[] = $st[0];
}

foreach ($myarray as $value) {
    $query = "SELECT field_value FROM wp_cf7dbplugin_submits WHERE submit_time = ".$value;
    $entry = mysql_query($query);

    while ($row = mysql_fetch_row($entry)) {
        if (!empty($row[0])) {
            echo $row[0];
            echo '<br>';
        }
    }

    echo '<br><br>';
} 
```

# asp.net - ASP.NET IIS 7.5 无法写入共享文件夹

> ID：14862807
> 
> 赞同：0
> 
> 时间：2013-02-13T20:47:18.903
> 
> 标签：asp.net, iis

我有一个简单的应用程序，可以对一些 FTP 站点和网络共享文件夹进行一些文件改组。我的 web.config 是这样的：

```
 <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <authentication mode="Windows" />
    <customErrors mode="Off" />
  </system.web>
  <system.webServer>
    <security>
      <authorization>
        <add accessType="Deny" users="?" />
      </authorization>
    </security>
  </system.webServer> 
```

Windows 身份验证似乎工作正常，因为我的页面在我访问时显示我的域\帐户名。但是，无论我是否已将“所有人”组添加到具有完全访问权限的目标文件夹中，我仍然会收到此错误：

`System.UnauthorizedAccessException : Access to the path is denied`

我的网站在 IIS 7.5 上运行，并拥有自己的应用程序池。当我在 ApplicationPoolIdentity 下运行池时，Windows 身份验证不起作用，即使我的域\帐户正确，它也会无休止地提示我输入密码。如果我将身份切换到 NetworkService，Windows 身份验证可以无缝工作，但我仍然不能由于访问路径被拒绝错误，写入我的网络文件夹。

我已经在这里和其他地方阅读了各种各样的东西，但我还没有找到一个有效的解决方案。我知道我自己在 ASP.NET 和 IIS 安全方面的局限性，所以我完全希望我犯了一些错误，但没有具有这些技能的现场同行可以咨询。

任何关于从哪里开始理解安全模型的建议，因为它涉及在一台机器上获取一个能够写入另一台机器上的共享网络文件夹的网站，我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:58:51.530

尝试使用您的域\用户名和密码将应用程序池标识设置为自定义帐户。我需要在我的应用程序访问网络共享上的文件夹的几个站点上执行此操作。

# c - 如何在 C 中的缓冲区中放置和使用两个不同的值？

> ID：14862810
> 
> 赞同：1
> 
> 时间：2013-02-13T20:47:30.670
> 
> 标签：c, robotics

以下是使机器人在其模拟器中移动的 C 代码的一部分。

```
while (1)
{
    sprintf(buf, "M LR 100 100\n");    //motor left and right moves with speed 100 each.
    write(sock, buf, strlen(buf));     //sends the buffer to the socket (simulator)
        int lme, rme;                  //lme and rme are right and left motor encoder values, the other value I need to send to buffer.
        sprintf(buf, "S MELR\n");      //sensor command to find ME values
        sscanf(buf, "S MELR %i %i\n", &lme, &rme);       //sending the actual ME values, that need to be sent to a(nother?) buffer.
        printf(buf, "lme , rme");      //the values of MEncoders.
    memset(buf, 0, 80);                //clear the buffer, set buffer value to 0
    read(sock, buf, 80);               //read from socket to get results.        
} 
```

这不起作用，因为虽然机器人以速度 100 移动，终端只显示 S MELR 并且没有电机编码器值，但它显示了 M LR 命令被移除时的值，所以我认为它与 MELR 值有关没有被发送到缓冲区。如何改进或如何为 MELR 值设置新缓冲区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:05:17.640

这些行显然是错误的：

```
sprintf(buf, "S MELR\n");      //sensor command to find ME values
sscanf(buf, "S MELR %i %i\n", &lme, &rme); 
```

在上面，您首先将该字符串设置为`buf`，然后尝试从中解析出两个整数，当它显然没有它们时。

很难确定，但看起来你需要`write`在`sprintf`上面那个`read`之后，然后在之后移动它才能真正得到响应， before `sscanf`。

* * *

那么这个printf也是废话：`printf(buf, "lme , rme");`

你的意思可能是这样的：`printf("Got lme %i, rme %i\n", lme, rme);`

或者这样做的目的是`printf`什么？从评论中看不太清楚...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:11:26.010

在我看来，有些东西缺失/错误。我在这里注释您的代码：

```
while (1)
{
    sprintf(buf, "M LR 100 100\n");    //motor left and right moves with speed 100 each. 
```

`buf`现在包含字符串“M LR 100 100\n”

```
 write(sock, buf, strlen(buf));     //sends the buffer to the socket (simulator) 
```

命令写入`sock`

```
 int lme, rme;                  //lme and rme are right and left motor encoder values, the other value I need to send to buffer.

        sprintf(buf, "S MELR\n");      //sensor command to find ME values 
```

新命令写入`buf`

```
 sscanf(buf, "S MELR %i %i\n", &lme, &rme);       //sending the actual ME values, that need to be sent to a(nother?) buffer. 
```

试图读取`buf`- 但它包含`"S MELR\n"`......

> `write(sock, buf, strlen(buf)); read(sock,buf,80);`--> 可能在这里想要另一个

```
 printf(buf, "lme , rme");      //the values of MEncoders.
    memset(buf, 0, 80);                //clear the buffer, set buffer value to 0 
```

将字符串写入`buf`，然后立即再次清除它？

```
 read(sock, buf, 80);               //read from socket to get results.        
} 
```

也许我误解了如何`buf`操作，但它似乎是一个字符串缓冲区 - 正如使用至少一个`write(sock...`操作所证明的那样。

如果您解决以上几点，您可能会得到它的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:04:51.820

你不需要再读一遍buf？你想用 lme 和 rme 做什么？

```
while (1)
{
    sprintf(buf, "M LR 100 100\n");    //motor left and right moves with speed 100 each.
    write(sock, buf, strlen(buf));     //sends the buffer to the socket (simulator)
        int lme, rme;                  //lme and rme are right and left motor encoder values, the other value I need to send to buffer.
        sprintf(buf, "S MELR\n");      //sensor command to find ME values
    write(sock, buf, strlen(buf));     //sends the buffer to the socket 
    read(sock, buf, 80);               //read from socket to get results.    
        sscanf(buf, "S MELR %i %i\n", &lme, &rme);       //sending the actual ME values, that need to be sent to a(nother?) buffer.
        // ???? printf(buf, "lme , rme");      //the values of MEncoders.
    memset(buf, 0, 80);                //clear the buffer, set buffer value to 0
    read(sock, buf, 80);  //???        //read from socket to get results.        
} 
```

您如何“<em>补偿您命令的电压与您实际达到的速度之间的差异”？？我对机器人一无所知……但你可以试试：？

```
int lme=100, rme=100;     //lme and rme are right and left motor encoder values, the other value I need to send to buffer.             
while (1)
{
    sprintf(buf, "M LR %i %i\n", lme, rme);    //motor left and right moves with speed 100 each.
    write(sock, buf, strlen(buf));     //sends the buffer to the socket (simulator)
        sprintf(buf, "S MELR\n");      //sensor command to find ME values
    write(sock, buf, strlen(buf));     //sends the buffer to the socket 
    read(sock, buf, 80);               //read from socket to get results.    
        sscanf(buf, "S MELR %i %i\n", &lme, &rme);       
    lme=100+(100-lme) ; rem=100+(100-rme);  // compensate  ????
} 
```

# python - POST 时将 json 嵌入到表单中

> ID：14862811
> 
> 赞同：0
> 
> 时间：2013-02-13T20:47:34.627
> 
> 标签：python, json, flask

这不是ajax，而是简单得多。

我所拥有的是一堆字段并呈现为html。我网站的访问者将访问该页面并填写表格并单击“提交”按钮。

我有一些由运行在该网页上的 javascript/jquery 收集的数据。我希望烧瓶在 POST（作为 JSON）中接收该数据，以及其他“正常”表单值。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:50:58.777

在表单中使用隐藏字段：

```
<input type="hidden" value=""> 
```

然后使用 jQuery 的`submit()`方法在提交表单时拦截表单并在那里添加您的 json。

# php - 从 FPDF 创建多个 PDF 文件

> ID：14862818
> 
> 赞同：1
> 
> 时间：2013-02-13T20:47:52.550
> 
> 标签：php, pdf, fpdf

我要做的是使用 FPDF 创建和发送多个 PDF 文件。我已经完成了通过电子邮件发送单个文件的所有工作，但是当我尝试将所有内容都放入一个循环中时，脚本最终只输出 PDF 的第一个实例，然后退出到空白屏幕。当我只处理一条记录时，它运行得很好，但是当你添加多条时，它只运行一次。我真的不知道该怎么做是我的代码。任何帮助或指导表示赞赏。

```
while ($data = mysql_fetch_row($query)) // under normal circumstances working properly
    {
        $clientid = $data['0'];
        if($clientid)
        {
            require("generatepdf.php"); //styles the pdf and is working properly
            $savepath = 'c:/ledgers/'.$cname.' Cash Ledger.pdf';
            $pdf->Output($savepath,'F');
            require("ledgeremail.php"); //runs query to get email address and emails the outputted file 
        }
    } 
```

这是我的 pdf 生成代码的要点，省略了生成的细节。

```
<?php

require("includes/pdf/fpdf.php");

{

$pdf = new FPDF( );
$pdf->AddPage();
$pdf->SetFont('Arial','',16);

    //Run Query to get Ledger information for the $clientid variable
            //Pass information from query into the different variables throughout script

            //Print Document Title
            $pdf->Cell(0,10,$cname.' Petty Cash Ledger', 0,1,'L');
            //Print First Month Grouping
            $pdf->SetFont('Arial','',10);
            $pdf->Line($linestart,$pdf->GetY(),$lineend,$pdf->GetY());
            $pdf->Cell(10,5,$startmonth.", ".$startyear, 0,0,'L');
            $pdf->SetX(175);
            $pdf->SetFont('','B');
            $pdf->Cell(20,5,'Balance Forward: $'.$balforward, 0,1,'R');
            $pdf->SetFont('');
            //print group headers
            $pdf->SetTextColor(101,102,102);
            $pdf->Cell(30,5,'Date',0,0,'L');
            $pdf->SetX(30);
            $pdf->Cell(105,5,'Description', 0,0,'L');
            $pdf->SetX(135);
            $pdf->Cell(20,5,'Deposit', 0,0,'R');
            $pdf->SetX(155);
            $pdf->Cell(20,5,'Withdrawl', 0,0,'R');
            $pdf->SetX(175);
            $pdf->Cell(20,5,'Balance', 0,1,'R');
            $pdf->SetTextColor(0,0,0);
            $pdf->SetFillColor(255);

            while($ledger = mysql_fetch_row($ledgerqry))
            {
                if ($grey == 1) $pdf->SetFillColor(225);

                $currentmonth = date('F',strtotime($data[0]));
                if ($currentmonth != $startmonth)
                {
                    $pdf->SetFillColor(255);
                    $grey = 0;
                    $currentyear = date('Y',strtotime($data[0]));
                    //Print Month End Balance
                    $pdf->SetX(175);
                    $pdf->SetFont('','B');
                    $pdf->Cell(20,5,'Ending Balance: '.$runningbal, 0,1,'R',1);
                    $pdf->SetFont('');
                    $pdf->Line($linestart,$pdf->GetY()+2,$lineend,$pdf->GetY()+2);
                    //Print Month Grouping
                    $pdf->Cell(10,10,$currentmonth.", ".$currentyear, 0,0,'L');
                    $pdf->SetX(175);
                    $pdf->SetFont('','B');
                    $pdf->Cell(20,10,"Balance Forward: ".$runningbal, 0,1,'R');
                    $pdf->SetFont('');

                    //print group headers
                    $pdf->SetTextColor(101,102,102);
                    $pdf->Cell(30,5,'Date',0,0,'L');
                    $pdf->SetX(30);
                    $pdf->Cell(105,5,'Description', 0,0,'L');
                    $pdf->SetX(135);
                    $pdf->Cell(20,5,'Deposit', 0,0,'R');
                    $pdf->SetX(155);
                    $pdf->Cell(20,5,'Withdrawl', 0,0,'R');
                    $pdf->SetX(175);
                    $pdf->Cell(20,5,'Balance', 0,1,'R');
                    $pdf->SetTextColor(0,0,0);

                    $startmonth = $currentmonth;
                }

                //Create line Variables
                $tdate = date('m/d/Y',strtotime($ledger[0]));
                $tdescription = $ledger[2];
                if($ledger[3]==0)   $tdeposit = ""; else $tdeposit = "$".number_format($ledger[3], 2, '.', ',');
                if($ledger[4]==0)   $twithdrawl = ""; else $twithdrawl = "($".-1*number_format($ledger[4], 2, '.', ',').")";
                $runningbal = "$".number_format($balforward + $ledger[5], 2, '.', ',');

                $pdf->Cell(30,7,$tdate, 0,0,'L',1);
                $pdf->SetX(30);
                $pdf->Cell(105,7,$tdescription, 0,0,'L',1);
                $pdf->SetX(135);
                $pdf->Cell(20,7,$tdeposit, 0,0,'R',1);
                $pdf->SetX(155);
                $pdf->Cell(20,7,$twithdrawl, 0,0,'R',1);
                $pdf->SetX(175);
                $pdf->Cell(20,7,$runningbal, 0,1,'R',1);

                if ($grey == 1)
                {
                    $pdf->SetFillColor(255);
                    $grey = 0;
                }
                else $grey = 1;

            }
            //Create Final balance
            $pdf->SetFillColor(255);
            $pdf->SetX(175);
            $pdf->SetFont('','B');
            $pdf->Cell(20,5,'Ending Balance: '.$runningbal, 0,1,'R',1);
            $pdf->SetFont('');
        }                   
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:12:43.707

您的方法是正确的，但您可能需要重新构建您的逻辑。

在您包含的每个文件中，您都希望编写用于生成 PDF 和发送电子邮件的功能。然后你的循环可以重做如下：

```
require("generatepdf.php"); 
require("ledgeremail.php");

while ($data = mysql_fetch_row($query)) // under normal circumstances working properly
{
    $clientid = $data['0'];
    if($clientid)
    {
        $cname = generate_pdf_for_client( $clientid ); // calls a function in generatepdf.php
        $savepath = 'c:/ledgers/'.$cname.' Cash Ledger.pdf';
        $pdf->Output($savepath,'F');
        send_email_to_client(some appropriate parameters); // calls a function in ledgeremail.php
    }
} 
```

因此，在您的文件中，您需要实现建议`generate_pdf_for_client`和`send_email_to_client`功能的逻辑。

# facebook - Facebook 应用程序，计算喜欢、分享和评论

> ID：14862821
> 
> 赞同：1
> 
> 时间：2013-02-13T20:47:57.887
> 
> 标签：facebook, facebook-fql

我一直在阅读 facebook API，并且对它的功能有了一个基本的了解。所以我不是要求任何人为我做任何研究，我只是问我这个概念是否正确。

我正在研究一个应用程序的规格，该应用程序将让人们在时间轴上共享项目。我只是想对每个共享的项目进行每日统计，并想知道有多少分享、喜欢和评论。

我相信我可以用类似的东西来做到这一点：

```
$fql  = "SELECT url, normalized_url, share_count, like_count, comment_count, "; 
```

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-01T05:04:42.327

可以使用 Graph API 来完成

```
http://graph.facebook.com/?id=YOUR_URL 
```

就像是：

```
http://graph.facebook.com/?id=http://www.yahoo.com 
```

返回值的示例为：

```
{
      "id": "http://www.yahoo.com",
      "shares": 200 
```

}

可以通过like按钮获取以下信息

此 URL 的点赞数 此 URL 的分享数 此 URL 的故事的点赞数和评论数

通过 fql 端点（link_stat 表）可以使用 Graph API 的 Like 按钮编号

以下是要提交的调用 URL 示例：

```
 https://graph.facebook.com/fql?q=SELECT url, normalized_url, share_count, like_count, comment_count, total_count,commentsbox_count, comments_fbid, click_count FROM link_stat WHERE url='http://www.yahoo.com' 
```

# php - 限制消息发送逻辑

> ID：14862822
> 
> 赞同：-1
> 
> 时间：2013-02-13T20:47:58.137
> 
> 标签：php, javascript, jquery

我正在寻找一些关于如何正确限制每秒发送消息的提示。我有一个 ajax 请求，它在用户按下按钮时将数据发送到 PHP 文件进行处理。我想将用户在一秒钟内按下提交按钮的次数限制为一定数量。这将有效地允许每秒不超过 3 条消息。不太确定我将如何完成这项工作，有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:51:32.727

您可以简单地在按钮单击事件上设置一个计时器，该事件最初禁用按钮，然后在一定时间后重新启用它。

```
$('.myButton').click(function() {
    ...
    $(this).attr('disabled','disabled');
    setTimeout(function() {
        $(this).removeAttr('disabled');
    }, 2000);
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:53:17.060

您可以在单击后禁用该按钮，然后`setTimeout()`在一段时间后使用它来重新启用它：

```
$('#myButton').click(function() {
    $(this).attr('disabled', 'disabled');
    setTimeout(function() {
      $('#myButton').removeAttr('disabled');
    }, 1000);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:01:20.397

> 我想将用户在一秒钟内按下提交按钮的次数限制为一定数量

这很简单，在请求处于活动状态时禁用它，并在经过一定时间后启用它。但是您需要注意“单击按钮”与“发送到服务器的请求”不同，您还需要服务器端逻辑。

```
$('#theButton').click(function() {
    var button = this,
        ratelimit = true,
        ajaxrunning = true;
    button.disabled = true;
    setTimeout(function() {
        ratelimit = false;
        if (!ajaxrunning)
            button.disabled = false;
    }, 5000);
    $.ajax(…).always(function() {
        ajaxrunning = false;
        if (!timeout)
            button.disabled = false;
    });
} 
```

# channel - NS2：如何知道频道槽的数量？

> ID：14862828
> 
> 赞同：0
> 
> 时间：2013-02-13T20:48:29.900
> 
> 标签：channel, ns2, timeslots

这是关于`NS2` `MAC`层模拟的。

假设`Ns2`信道带宽为`1 Mbps`。

那么，默认情况下，通道分为多少个槽？

如果分开，每个单独的插槽是多少？

这条线 `mac->phymib_.getSlotTime()`给出了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-03T17:49:08.357

谈到频道插槽，我假设您询问的是 Mac/Tdma 无线协议（另外指定）：

进入源代码：

**来自 tdma-mac.cc：**

```
//Get the parameters of the link (which in bound in mac.cc, 2M by default),
//the packet length within one TDMA slot (1500 byte by default), 
//and the max number of nodes (64) in the simulations.

// Max data length allowed in one slot (byte)
#define MAC_TDMA_MAX_DATA_LEN 1500        

// How many time slots in one frame.
#define MAC_TDMA_SLOT_NUM       32 
```

ns-default.tcl 中还定义了无线链路的默认带宽以及其他一些值：

```
Phy/WirelessPhy set bandwidth_ 2e6

Mac/Tdma set slot_packet_len_   1500
Mac/Tdma set max_node_num_  64 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T14:35:22.773

`mac->phymib_.getSlotTime()`返回 a 的持续时间`slot`，它是802.11 MAC 协议的[分布式协调功能(DCF) 的参数。](http://en.wikipedia.org/wiki/Distributed_Coordination_Function)

回覆：`how many slots is the channel divided into.`

我认为你混淆了`802.11 MAC`with `TDMA`。

如果您对在 中进行模拟感兴趣`TDMA`，`ns2`您应该查看文件`mac/mac-tdma.cc`和`mac/mac-tdma.h`. 不幸的是，`TDMA`allinone-package 没有给出示例脚本。

# cordova - Kindle Fire Phonegap 跨域请求不起作用

> ID：14862829
> 
> 赞同：1
> 
> 时间：2013-02-13T20:48:30.307
> 
> 标签：cordova, cross-domain, kindle, kindle-fire

我正在尝试在 Kindle Fire 中使用 phonegap/cordova v2.4 请求跨域。我也在使用 jquery/jquery mobile 作为测试用例。过去我在使用 android 设备时没有遇到任何问题，但是当我迁移到 Kindle 时，我似乎无法让请求正常工作。我非常简单的 JS

```
function deviceInfo(){

alert('hi');
$.ajax({
  url: "URL",
  dataType: 'jsonp',
  crossDomain:true,
  success: function(suc){
      alert('suc');
  },
  failure:function(msg){
      alert('msg');
  }
});}
$(function() {
document.addEventListener("deviceready", deviceInfo, true);
}); 
```

我的 phonegap 配置文件具有以下内容

```
<access origin="*" />
<access origin=".*"/>
<access origin="http://127.0.0.1*" />
<access origin="http://localhost:65198*" /> 
```

我已经尝试了多种变体，试图让它允许任何 url，但跨域似乎仍然是一个问题。我可以在网络浏览器中本地测试它，它工作正常。我也尝试过使用本地和远程服务器，但都不能在应用程序中工作，但在浏览器中却很好。

还尝试 [了 phonegap jQuery .ajax 跨域请求在浏览器中工作，在 Android SDK 中失败](https://stackoverflow.com/questions/11641442/phonegap-jquery-ajax-cross-domain-requests-work-in-browser-fail-in-android-sdk) 我有这些权限

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:45:44.843

我能够让它工作。在这种情况下肯定是用户错误。wifi 连接试图使用隔壁的几个 wifi。它首先使用了一个打开的设备，并更新了一些设备应用程序，给人的印象是它已连接。然后它丢失了信号并尝试切换到通过 url 保护的 wifi，而不是拥有 wifi 密码，所以它最终说它已连接但无法实际处理任何请求。在我切换到使用自己的 wifi 后，一切都很顺利。

# php - if 语句中的函数只有在语句为真时才会被读取吗？

> ID：14862831
> 
> 赞同：0
> 
> 时间：2013-02-13T20:48:35.050
> 
> 标签：php, function, if-statement

如果我将函数放入 if 语句中，这是“仅在尚未声明时声明”的有效方法吗？我在另一个线程上读到，嵌套在其他[线程](https://stackoverflow.com/questions/1631535/php-function-inside-function)中的函数与非嵌套函数的工作方式相同（不确定这是否适用于此）。我的函数会始终执行还是仅在为真时执行？

```
 if(!function_exists('myFunction')){
    //Add myFunction just in case it wasn't declared previously
    function myFunction() { 
    // do something
    }  
    myFunction();
  }
  else {
    myFunction();
  } 
```

或者，是否有更好的方法来做到这一点，即该函数可能会或可能不会先前在父文件中声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:12:57.087

如果您打算在其他地方调用函数 myFunction(){}，请将其放在 if 语句之外（如在 else 语句中）

# objective-c - 递归期间的计数

> ID：14862836
> 
> 赞同：0
> 
> 时间：2013-02-13T20:48:49.837
> 
> 标签：objective-c, recursion

我在递归操作中计数有问题。我正在创建一个站点地图生成器，我想计算每个 URL 链接的次数。到目前为止，我在数大于二时遇到了麻烦！但至少它很重要。

这是我的代码：

```
- (void)parseURL:(NSURL*)URL
{
    NSLog(@"Parsing URL: %@", URL);
    // Check for URL in visited Array
    if ([self.visitedURLs containsObject:URL]) {

        NSLog(@"URL Already Visited...");

        // Add 1 to the count of links to this URL
        [[self.collectedURLs objectForKey:[URL absoluteString]] addToIncomingLinks];

        NSLog(@"Updating Link Count... (%d)", [[self.collectedURLs objectForKey:[URL absoluteString]] incomingLinks]);

        // Done parsing this URL, nothing else to do here...

    } else {

        ... Filter URLs and other stuff ...

        // Add URL as visited
        [self.visitedURLs addObject:URL];

        // Add filtered URL to Dictionary with link count of 1
        [self.collectedURLs setObject:[[OBAURLData alloc] init] forKey:workingURL];

        // Reload Table
        [self.crawlTableView reloadData];

        // parse found URLs
        [self parseURL:[NSURL URLWithString:workingURL]];
    }
}

// From the OBAURLData Object
- (id)init
{
    if ((self = [super init])) {
        self.incomingLinks = 1;
    }
    return self;
}
- (void)addToIncomingLinks
{
    self.incomingLinks = self.incomingLinks + 1;
} 
```

所有代码都按预期工作，除了计数不高于 2，即使 NSLog 语句都显示 URL 被访问了两次以上。

这可能是因为递归还是我只是没有看到我的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:03:19.737

你的 else 块中的 URL 和 workingURL 有什么区别，也许你正在为每个 URL 重新创建一个 OBAURLData 的实例，即使它是相同的？

我会打印出您创建 OBAURLData 对象的次数。

# html - 制作一个 td 填充表格宽度

> ID：14862838
> 
> 赞同：21
> 
> 时间：2013-02-13T20:48:52.960
> 
> 标签：html, css, html-table

我有一个固定高度为 50px 和 100% 宽度的表格。

在该表内，我有两个 div，在同一行，如下所示：

```
<table>
  <tr>
    <td>
      <div id="1"></div>
    </td>
    <td>
      <div id="2"></div>
    </td>
  </tr>
</table> 
```

第一个 div 有`float:left`，第二个有`float:right`。

所以表格是页面的 100%。我希望 div2 包装它的内容，并 div1 填充剩余空间，以便 div2 像这样向右对齐：

```
+--------------------------------------------------------------+
| [ DIV 1          (Expands)       ][ DIV 2 AND ITS CONTENTS ] |
+--------------------------------------------------------------+ 
```

以及当 div1 的内容少于整行时我目前得到的结果：

```
+--------------------------------------------------------------+
| [ DIV 1 ][ DIV 2 ]                                           |
+--------------------------------------------------------------+ 
```

如果没有桌子，我可以让它直接左右浮动，但是当它们“聚在一起”时，它们会相互包裹而不是彼此相邻。

编辑：我在这里添加了一个新的[jsfiddle](http://jsfiddle.net/HRT5E/)。这是工作示例。尝试从左侧 div 中删除除一个以外的所有链接，然后查看结果。第二个 div 应该留在最右边。我希望我自己解释。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-13T20:51:24.193

使用 td 的“colspan”属性。前任：

```
 <td colspan=75%> info </td> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-02-13T21:25:20.983

解决了添加`width:100%`到表中。

[http://jsfiddle.net/HRT5E/1/](http://jsfiddle.net/HRT5E/1/)

```
table {
    width:100%;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-11T10:30:26.880

只需添加`width: 100%`到第一个`td`，浏览器就会自动填充它的宽度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:18:47.570

首先，您的表格似乎根本没有设置为页面的整个宽度。您想为标记添加宽度样式或宽度属性。

接下来只需在右侧“div”（或更准确地说`<TD>`）上设置一个固定宽度，第一个将填充剩余空间。

正如其他人指出的那样，包装表似乎没有必要。

# java - 获取cq5中加载到图像组件中的图像的文件大小？

> ID：14862840
> 
> 赞同：3
> 
> 时间：2013-02-13T20:49:06.047
> 
> 标签：java, jsp, aem

我正在处理一个 cq5 项目，我需要将通过图像组件上传的图像大小限制为大约 150kb。我`customimage`通过复制、粘贴和重命名默认图像组件创建了一个名为“”的自定义图像组件。

属性“ `fileReference`”返回文件的相对路径`(for instance "/content/dam/myProject/emea/logo.jpg")`。绝对路径没有属性。现在我编写了代码来检查 customimage.jsp 文件中文件的大小我有一些看起来像的代码

```
String path = (String)properties.get("fileReference","");

File file = new File(path);

double file_size = file.length(); 
```

问题是无论我将什么图像传递给组件，file_size 都会返回 0.0。该项目是在 html 4 中，所以我不能利用`html5`添加的漂亮的 javascript 文件 I/O，所以它必须通过 java.xml 来完成。我究竟做错了什么？我应该在cq5中解决这个问题的另一种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T05:29:52.757

*fileReference*属性将为您提供jcr 存储库中图像的路径，可能是大坝，而不是文件系统上的路径，这意味着您正在调用的 File 构造函数将不起作用。

未经测试，但以下内容可能会起作用。

```
Resource r = resourceResolver.getResource(path);
Asset a = r.adaptTo(Asset.class);
Rendition rnd = a.getOriginal();
long size = rnd.getSize(); 
```

# dojo - 简单的模板化 Dijit 抛出空解析错误

> ID：14862843
> 
> 赞同：2
> 
> 时间：2013-02-13T20:49:21.260
> 
> 标签：dojo

有时我真的想知道我不只是使用 jQuery ......

基本模板化 Dijit：

```
define([
    'dojo/_base/declare',
    'dijit/_WidgetBase',
    'dijit/_TemplatedMixin',
    'dijit/_WidgetsInTemplateMixin',
    'dojo/text!./templates/basic.html'
    ],
function(
    declare,
    _WidgetBase,
    _TemplatedMixin,
    _WidgetsInTemplate,
    template
    ) {
    return declare("Slider", [_WidgetBase, _TemplatedMixin, _WidgetsInTemplate], {
        templateString : template
    })
}) 
```

模板：

```
<div class="${baseClass}">
    <div data-role="decor" data-dojo-type="gs/ImageBox/ImageBox">
        <header>
            <h2>Air Jordan 6</h2>
            <h6>2000</h6>
        </header>
        <footer>
            <a href="javascript:void(0);" data-role="toggle">More Information</a>
        </footer>
    </div>
    <div data-role="content">
        <section class="data">
            <header>
                <a href="javascript:void(0);" data-role="toggle" class="sticky">Hide</a>
                <ul class="list_info">
                    <li><span>Release Date</span><span>3.15.2003</span></li>
                    <li><span>Release Type</span><span>General Release</span></li>
                    <li><span>Cost at release</span> <span>$100</span></li>
                    <li><span>Cost Today</span> <span>$325-$600</span></li>
                </ul>
            </header>
            <!--
            <div data-dojo-type="dijit/layout/ContentPane" href="./php/info.php?id=3"></div>
            -->
        </section>
    </div>
</div> 
```

引发通用解析错误。如果我删除`data-dojo-type="gs/ImageBox/ImageBox"`声明，它至少会解析。

道场配置：

```
<script>
dojoConfig = {
    parseOnLoad : false,
    async : true,
    cacheBust : true,
    packages : [
        { name : 'gs', location: location.pathname.replace(/\/[^/]*$/, '/js') }
    ],
    debug : true,
    debugAtAllCosts : true
}
</script> 
```

如果 Dojo 抛出包含一些信息的错误，那就太棒了，但它只是给出了`parse error()`dojo.js 的第 22 行。

快把我逼疯了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:55:30.457

我认为您需要告诉 AMD 加载程序您需要`gs/ImageBox/ImageBox`.

```
define([
  'dojo/_base/declare',
  'dijit/_WidgetBase',
  'dijit/_TemplatedMixin',
  'dijit/_WidgetsInTemplateMixin',
  'gs/ImageBox/ImageBox',
  'dojo/text!./templates/basic.html'
], function(
   declare,
  _WidgetBase,
  _TemplatedMixin,
  _WidgetsInTemplate,
  ImageBox,
  template
) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T08:39:28.907

帖子的第一行应该是“我不知道我为什么这样`(blind|stupid)`”。

模板的第一行*实际上*有一个注释作为第一行。显然是大禁忌。

# php - html 没有按我期望的方式在网页源中打印出来

> ID：14862845
> 
> 赞同：2
> 
> 时间：2013-02-13T20:49:27.093
> 
> 标签：php, html, return, echo

有人可以告诉我，保持相同的抽象级别，如何正确地做到这一点？我有这两个基本课程，没有按我的意愿做。最终结果应该是：

```
<div class="test">
    content
</div> 
```

**如果我这样做：**

```
class Wrapper{

    protected $_html = '';

    public function open(){
        $this->_html .= '<div class="test">';
    }

    public function close(){
        $this->_html .= '</div>';
    }

    public function __toString(){
        return $this->_html;
    }
}

class Content{

    protected $hmtl .= '';

    public function content(){
      $wrapper = new Wrapper();
      $wrapper->open();
      $this->html .= 'test';
      $wrapper->close();
    }

    public function __toString(){
        return $this->_html;
    }
} 
```

$内容=新内容（）；回声$内容->内容（）；

我明白了，是的，这是来自源：

```
"content"; 
```

**如果我这样做：**

```
class Wrapper{

    protected $_html = '';

    public function open(){
        echo $this->_html .= '<div class="test">';
    }

    public function close(){
        echo $this->_html .= '</div>';
    }

    // Technically don't need this
    public function __toString(){
        return $this->_html;
    }
} 
```

我明白了，是的，这是来自源头，

```
<div class="test"></div>
"content" 
```

那么我做错了什么？以及如何保持相同的抽象级别并获得所需的输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:55:14.290

您想要某种方法将内容添加到包装器中，例如

```
public function addContent($content){
        $this->_html .= $content;
    } 
```

你可以这样做

```
$wrapper = new Wrapper();
$content = new Content();
$wrapper->open();
$wrapper->addContent((string)$content);
$Wrapper->Close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:54:02.613

您永远不会调用会产生 HTML 标记的`Wrapper`类方法。`__toString`我认为你真正想要的是`$this->_html = (string)$wrapper->open()`它出现的东西。

**编辑**：

实际上，您设置的整个逻辑使我难以理解。你为什么不`return`使用 ->open() 和 ->close() 方法呢？

# jquery - 为什么我的切换失败

> ID：14862847
> 
> 赞同：0
> 
> 时间：2013-02-13T20:49:36.540
> 
> 标签：jquery, css

我已经做过无数次了，我发誓这只是在惹我生气。

使用任何 jquery 库。

我要做的就是通过链接切换 div。

```
<a href="" id="mGoldNav">Click Me</a> 
```

这是我的jQuery代码

```
$('#mGoldNav').click(function(){
    $('#module-golden-nav').toggle("slow");
}); 
```

在我的网站上，基本上什么都没有发生。我放置了一个 alert() 并触发，所以 click() 有效。但是切换失败。

但是在**[http://jsfiddle.net/BaQd2/1/](http://jsfiddle.net/BaQd2/1/)**你会注意到它工作了一次，但是消失了，如果你再次运行，它会给我一个奇怪的错误：{“错误”：“请使用 POST 请求” }

任何想法为什么它惹我？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:54:21.287

您也可以在`href`链接的属性中添加一些内容，例如`#`. [http://jsfiddle.net/BaQd2/2/](http://jsfiddle.net/BaQd2/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:52:11.647

`false`在点击回调结束时返回，以防止浏览器默认行为跟随点击的锚点。

这应该有效：

```
$('#mGoldNav').click(function(){
    $('#module-golden-nav').toggle("slow");
    return false;
}); 
```

[**演示**](http://jsfiddle.net/BaQd2/4/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:53:33.023

由于它是一个锚标签，它将触发其默认的回发操作。要使用切换，您必须使用

```
return false; 
```

像这样：

```
$('#mGoldNav').click(function(){
     $('#module-golden-nav').toggle("slow");
     return false;
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T21:01:11.957

`a`将元素用作按钮实际上是个坏主意。但是在您的定义`href`属性中会执行不需要的操作，请回发。如果你改变它像`#`（或`javascript:void(0)`）你会得到你想要的：

```
<a href="#" .. 
```

[在这里](http://jsfiddle.net/BaQd2/1/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T20:55:17.630

试试这个：

```
$('#mGoldNav').click(function(e){
    e.preventDefault();
    $('#module-golden-nav').toggle("slow");
}); 
```

# java - eclipse中的资源泄漏警告

> ID：14862853
> 
> 赞同：18
> 
> 时间：2013-02-13T20:49:59.643
> 
> 标签：java, eclipse, resource-leak

在`Eclipse`我收到一个`Resource leak: 'ps' is not closed at this location`我不明白的警告。

在我的`Java`代码中，我将**“ps”**声明为准备好的语句，并多次使用（并关闭）它。然后我有以下顺序：

```
try {
    if(condition) {
        ps = c.prepareStatement("UPDATE 1 ...");
    } else {
        ps = c.prepareStatement("UPDATE 2 ...");
    }
    ps.executeUpdate();
} catch (SQLException e) {
    // exception handling
} finally {
    if (null != ps) 
        try { 
            ps.close(); 
        } catch (SQLException e) { 
            // exception handling
        };
} 
```

“资源泄漏”-警告出现在 else 部分的“更新”-语句中。如果我`ps = null`在开始尝试块之前设置，则没有警告。

如果第二个 UPDATE-Statement 被注释掉，则不会显示警告。

这是理解还是 java / eclipse 问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T21:08:00.573

如果您收到此警告，则说明您使用的是 Java 7。在这种情况下，您不应关闭`AutoClosable`自己实现的资源。您应该在声明注释的特殊初始化部分初始化这些资源`try`：

```
// decide which update statement you need:
// (your if should be here)
String update = ....;
try (
     ps = c.prepareStatement(update);
) {
   // use prepared statement here.
} catch (SQLException) {
   // log your exception
   throw new RuntimeException(e);
}
// no finally block is needed. The resource will be closed automatically. 
```

我确实不知道为什么`if/else`声明的存在会导致警告出现或消失。但是 java 7 推荐使用我上面描述的自动关闭资源的方法，所以试试这个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T20:58:35.317

我认为，这是您使用的检查器的问题。

将您的代码分成`initialization`和`use`块。此外，从初始化块中抛出异常（或提前返回）。`use`这样在块后释放资源时就不需要检查null

```
// initialization
// Note that ps is declared final.
// I think it will help to silence your checker
final PreparedStatement ps;

try {
    if( bedingungen ... ) {
        ps = c.prepareStatement("UPDATE 1 ...");
    } else {
        ps = c.prepareStatement("UPDATE 2 ...");
    }
} 
catch (SQLException e) {
    log.error("Problem creating prepared statement, e );
    throw e;
}

// use
try {
    ps.executeUpdate();
} catch (SQLException e) {
    log.error("Problem decrementing palets on " + srcElement.getName() + 
        ": " +    e.getMessage());
}
finally {
    try {
        ps.close();
    } catch (SQLException e) {
        log.warn("Error closing PreparedStatement: " + e.getMessage());
    };
} 
```

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2014-12-16T16:28:46.003

将变量名从 c 更改为 mC。我认为使用 c 作为变量名时这是一个奇怪的故障。谢谢查理

# powershell - PowerShell：命令“Get-ChildItem IIS:\Sites”导致错误

> ID：14862854
> 
> 赞同：4
> 
> 时间：2013-02-13T20:50:00.353
> 
> 标签：powershell, powershell-3.0, web-administration

下面显示的简单脚本会导致我的计算机出现异常：

```
Import-Module WebAdministration
Get-ChildItem IIS:\Sites 
```

结果：

```
powershell -NonInteractive .\test.ps1
Get-ChildItem : Could not load file or assembly 'Microsoft.PowerShell.Commands.Management' or one of its dependencies. The system cannot
find the file specified.
At C:\...\test.ps1:3 char:1
+ Get-ChildItem IIS:\Sites
+ ~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Get-ChildItem], FileNotFoundException
    + FullyQualifiedErrorId : System.IO.FileNotFoundException,Microsoft.PowerShell.Commands.GetChildItemCommand 
```

但是，如果我在脚本的开头添加 Write-Host 它可以正常工作：

```
Write-Host '!!!'
Import-Module WebAdministration
Get-ChildItem IIS:\Sites 
```

不幸的是，我不知道是什么导致了这个问题。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-05T11:00:34.613

```
Import-Module WebAdministration 
# adding sleep here resolves the issue for me
sleep 2
Get-ChildItem IIS:\Sites 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-20T11:04:27.913

我知道这是一个老问题，但今天我遇到了同样的问题。找到了以下形式的解决方案，它对我有用。

[**德米特里 说**](http://help.octopusdeploy.com/discussions/problems/14270-powershell-script-execution-error)

```
try 
{ 
    $serviceSite = Get-Item "IIS:\sites\$siteName" -ErrorAction "SilentlyContinue" 
} 
catch [System.IO.FileNotFoundException] 
{ 
# Try again (workaround for System.IO.FileNotFoundException issue) 
    $serviceSite = Get-Item "IIS:\sites\$siteName" -ErrorAction "SilentlyContinue" 
} 
```

# powershell - 使用 PowerShell 脚本授予域用户对网络文件夹的访问权限

> ID：14862858
> 
> 赞同：0
> 
> 时间：2013-02-13T20:50:17.500
> 
> 标签：powershell

我正在尝试让域用户传递他们的凭据以使他们能够访问网络文件夹。为此，我决定使用 PowerShell。到目前为止，这是我的代码。

为了实现我的目标，我到底还想念什么？谢谢

```
Get-Credential

$credential = Get-Credential
$userName = $credential.UserName
$pass = $credential.Password

   if ( ($userName -eq 'USER' ) -and ((([Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($pass)) -eq 'PA$$WORD')) ))
    {

    invoke-item \\SERVER\data\staff\fax} 
```

还是有其他更清洁的方法来做到这一点。好的，如果 PowerShell 不是解决问题的方法，我愿意接受其他脚本方法来实现这一点。

# c - 在 Objective-C 中前向声明具有定义数组大小的函数

> ID：14862860
> 
> 赞同：2
> 
> 时间：2013-02-13T20:50:32.133
> 
> 标签：c, arrays, function

我确信这是一个非常愚蠢的问题，但它真的让我措手不及，可能是我没有正确地思考这个问题。在使用 OpenGL ES 2.0 时，我遇到了以下代码行

```
/////////////////////////////////////////////////////////////////
// Forward declarations
static void SceneMeshInitIndices(
   GLushort meshIndices[NUM_MESH_INDICES]);
static void SceneMeshUpdateNormals(
   SceneMeshVertex mesh[NUM_MESH_COLUMNS][NUM_MESH_ROWS]);
static void SceneMeshUpdateMeshWithDefaultPositions(
   SceneMeshVertex mesh[NUM_MESH_COLUMNS][NUM_MESH_ROWS]); 
```

现在，让我措手不及的是函数将其输入声明为具有特定大小的二维数组。我从来没有见过这样的做法，并且完全不确定它是否合法或者它在 Objective-C 中是如何合法的。我一直被告知要使用指向原始数组的指针并将其传递进去。但这似乎很奇怪。任何人都可以尝试向我解释这一点或指出我在扣除什么错误吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T20:57:34.070

将数组传递给函数时，它们会根据一组规则衰减为指针。这些都是：

一。第一级间接（即数组的第一个维度/索引）衰减为指针，因此无需指定其大小（也无需使用）。

二。数组的其他维度保持不变，并且不会衰减为指针。它们需要被指定，并且它们是参数类型的一部分。

这就是为什么基本上以下内容是等效且合法的：

```
void foo(int arr[]);
void foo(int arr[MAX_ARRAY_SIZE]);
void foo(int *arr); 
```

但以下内容**不等价，**但合法：

```
void foo(int arr[MAX_ROWS][MAX_COLUMNS]);
void foo(int **arr); 
```

以下同样是等效且合法的：

```
void foo(int arr[MAX_ROWS][MAX_COLUMNS]);
void foo(int arr[][MAX_COLUMNS]); 
```

（这些被解释为`int (*arr)[MAX_COLUMNS])`，即指向数组的指针）。

以下是**非法的，**即它会产生编译器错误：

```
void foo(int arr[MAX_ROWS][]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T20:59:57.570

> 我一直被告知使用指向原始数组的指针并将其传递进去。

有人告诉您使用指向原始数组*元素的指针。*您被告知这是因为如果您尝试声明一个按值获取数组的函数，该语言会指定参数类型已“调整”以获取指向元素类型的指针（有效地导致数组参数类型忘记其大小并通过引用而不是按值传递）。所以基本上你被告知手动进行调整，以便源代码准确而明确地代表实际情况。

您显示的声明也可以使用以下建议声明：

```
static void SceneMeshInitIndices(GLushort *meshIndices);
static void SceneMeshUpdateNormals(SceneMeshVertex (*mesh)[NUM_MESH_ROWS]);
static void SceneMeshUpdateMeshWithDefaultPositions(SceneMeshVertex (*mesh)[NUM_MESH_ROWS]); 
```

应该清楚的是，一种类型的`int [X][Y]`意思是“一个由 Y 个整数组成的 X 数组的数组”。所以元素类型是“一个 Y 整数数组”。因此调整后的类型是“int (*)[Y]”或“指向 Y 个整数数组的指针”。

* * *

“调整”参数类型的规则是原始数组糟糕的几个原因之一，如果可以避免它们，则不应使用它们。不幸的是，C 并没有真正的好方法来做到这一点，但是 C++ 有`std::array`，它的行为就像数组一样；即您可以按值传递它们，可以按值返回它们，它们不会自动转换为指向元素类型的指针（因此它们永远不会忘记它们的大小）等。

* * *

也许更多的例子会更清楚。如果你写：

```
void foo(int param[10]); 
```

而且您不知道调整参数类型的规则，那么您可能会期望以下代码会产生错误：

```
int bar[5];
foo(bar); // error? an array of 5 ints is not the expected type. 
```

对于这段代码：

```
int baz[10];
foo(baz); 
```

您可能希望将数组`bar`复制到参数中，并且对参数所做的任何修改都不会影响原始数组。不幸的是，这些完全合理的期望是错误的。当您编写时`void foo(int param[10]);`，编译器会看到具有数组类型的参数并将其修改为与您编写的相同`void foo(int *param);`

因此，当您编写`foo(bar)`编译器时，编译器会看到该函数采用 an `int*`（不是`int[10]`您编写的那个），看到​​它可以转换`bar`为 an `int *`，因此编译器不会报告错误，而是恶意地生成一个调用该函数的程序。无论您编写的类型与传递的变量不兼容，无论其主体`foo()`可以做类似的事情`param[9] *= 2;`并且应该确保这是明确定义的。

同样，`foo(baz)`不按值传递数组，对函数内部的数组参数所做的任何事情都直接在实际数组上完成。这与通常的 C 语义完全不同，其中所有内容都通过值/副本传递，“通过引用传递”的唯一方法是获取充当对另一个对象的引用的指针值。在这种情况下，编译器会自动为您获取一个指针，并通过引用有效地传递数组。

此外，请注意，您是否写`void foo(int [10])`或`void foo(int [100])`无关紧要；在这两种情况下，参数类型都被调整为`int *`，因此这些声明声明了相同的函数，即使它们看起来不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T18:29:33.090

为了验证上面提到的内容，我还找到了以下解释（基本上表明我在相当长的一段时间内不需要传递 2D 数组）只是迭代上面的内容。

在函数内部将一维数组声明为形式参数时，您了解到数组的实际维度是不需要的；只需使用一对空括号来通知 C 编译器该参数实际上是一个数组。这并不完全适用于多维数组的情况。对于二维数组，可以省略数组的行数，但声明中必须包含数组的列数。所以声明

```
int array_values[100][50] 
```

和 int array_values[][50]

都是名为 array_values 的形式参数数组的有效声明，该数组包含 100 行乘 50 列；但声明

```
 int array_values[100][] 
```

和

```
int array_values[][] 
```

不是因为必须指定数组中的列数。

# .net - 如果 COM 对象是从 .NET 程序集中公开的，是否可以从 R 中调用 COM 对象？

> ID：14862861
> 
> 赞同：5
> 
> 时间：2013-02-13T20:50:36.570
> 
> 标签：.net, r, com

我想知道是否可以通过 COM 调用从 R 调用 .NET 函数。

该库`rcom`允许调用 COM 对象，因此理论上，对于任何作为 COM 对象公开的 .NET 程序集，这应该是可能的。

为简单起见，我将看看是否可以调用 in 中的`.Reverse()`函数`System.Text`，默认情况下，它作为 .NET 框架中的 COM 对象公开。

这是我到目前为止所尝试的：

1.  我在我的系统中获得了 ProgID 的列表（请参阅[C# 代码的链接](http://pastebin.com/5fY7aNRU)）。这是我系统中相关 ProgID 的列表：

    ```
    ---start list of COM ProgID entries---
    <snip>
    System.SystemException -> mscoree.dll
    System.Text.ASCIIEncoding -> mscoree.dll
    System.Text.StringBuilder -> mscoree.dll
    System.Text.UnicodeEncoding -> mscoree.dll
    System.Text.UTF7Encoding -> mscoree.dll
    System.Text.UTF8Encoding -> mscoree.dll
    <snip>
    ---end list--- 
    ```

2.  此 R 代码加载作为 COM 对象公开的 .NET .dll：

    ```
    library('rcom')
    x <- comCreateObject("System.Text.ASCIIEncoding") 
    ```

3.  它肯定会找到 COM 对象：

    > x attr(,"class") [1](http://pastebin.com/5fY7aNRU) "COMObject"

4.  我的问题是 - 我如何调用`.Reverse()`这个 COM 对象中的函数？

**更新**

在 .NET 中，调用将是：

```
 string x = "hello".Reverse(); 
```

那么，在 R 中，调用会是什么？

**更新**

有关 R 调用 C# 的示例，请参阅幻灯片 61中在 Windows 应用程序中[嵌入 R 中的](http://sunsite.univie.ac.at/rcom/download/Tutorial/EmbeddingR_Tutorial.pdf)**R 调用 C# 。**

请注意，这`ProgId`是`ProjectName.ClassName`来自 .NET 类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:22:28.420

我刚刚根据[Embedding R in Applications on Windows](http://sunsite.univie.ac.at/rcom/download/Tutorial/EmbeddingR_Tutorial.pdf)幻灯片 61 到 65 中的说明，通过 COM 从 R 中成功调用了 .NET 代码。

这是R代码：

```
# This is a once-off call.
install.packages("rcom")
library(rcom)
# This is a once-off call. See rcom user manual at:
# http://cran.r-project.org/web/packages/rcom/rcom.pdf
installstatconnDCOM() 

x <- comCreateObject("InteropSample.MyClass32")
comSetProperty(x,"Text","xxx")
comSetProperty(x,"Connector",comThis())
comInvoke(x,"DoCallback") 
```

这是R中的输出：

```
> DoCallback: xxxNULL 
```

这是 .NET 类的 C# 代码：

```
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using System.Text;

// Before running this, get rid of errors with "RCOMServerLib" by adding the rcom type library:
//
// Make sure everything is 32-bit (32-bit build in .NET, 32-bit run of Revolution R).
//
// Tick "Register for COM interop" in .NET project settings.
// 
// 1.Browse to "C:\Revolution\R-Enterprise-6.1\R-2.14.2\library\rcom\libs\i386>", then execute:
// C:\Revolution\R-Enterprise-6.1\R-2.14.2\library\rcom\libs\i386> C:\Windows\Microsoft.NET\Framework\v4.0.30319\regtlibv12.exe rcom_srv.tlb
// Registration of rcom_srv.tlb successful.
//
// 2\. Add reference to "rcom_srv.tlb", this gets rid of errors for RComServerLib.
//    (browse to "C:\Revolution\R-Enterprise-6.1\R-2.14.2\library\rcom\libs\i386")
//
// 3\. If we are using VS2012, this .NET assembly class will be automatically registered as COM server on build if we are using VS2012\. If using VS2012, you must do this manually on the command line.
// 
// See:
// http://generally.wordpress.com/2006/07/28/exposing-your-net-assembly-through-com/
// http://www.inside-r.org/packages/cran/rcom/docs/comCreateObject

// In R:
// comCreateObject("InteropSample.MyClass32")
// comSetProperty(x,"Text","xxx")
// comSetProperty(x,"Connector",comThis())
// comInvoke(x,"DoCallback")

namespace COM___called_from_R
{
    [Guid("3ddfe021-a0c6-4218-a254-4fc4328c99a7"),
     InterfaceType(ComInterfaceType.InterfaceIsDual)]
    internal interface IMyComponent
    {
        RCOMServerLib.IStatConnector Connector { set; }
        string Text { set; }
        void DoCallback();
    }

    [Guid("133fee0e-9b32-4429-8a43-6e2a706a9beb"), ComVisible(true)]
    [ProgIdAttribute("InteropSample.MyClass32")]
    public class MyComponent : IMyComponent
    {
        private string mText;
        private RCOMServerLib.IStatConnector mConnector;

        public RCOMServerLib.IStatConnector Connector
        {
            set { mConnector = value; }
        }

        public string Text
        {
            set { mText = value; }
        }

        public string MyProperty;

        public void DoCallback()
        {
            if (mConnector != null)
            {
                mConnector.EvaluateNoReturn("cat(\"DoCallback: "
                                            + mText + "\")\n");
            }
        }
    }
} 
```

**笔记**

1.  为了使其正常工作，所有内容都必须始终为 32 位或始终为 64 位。通过使用以下设置，我让它在 32 位模式下工作：

    *   C# 程序集（设置为 32 位）。
    *   R 的版本（我在 32 位模式下使用了 Revolution R）。
2.  如果您使用 Visual Studio 2012 (VS2012)，那么如果您在 .NET 项目设置中勾选“注册 COM 互操作”，它将`C:\Windows\Microsoft.NET\Framework\v4.0.30319\regtlibv12.exe`在编译时自动运行以将您的自定义 .NET 类注册为系统范围的 COM 组件。但是，如果您使用 Visual Studio 2010 (VS2010)，它**不会**自动运行`regtlibv12.exe`，所有这些设置都会创建 .tlb 文件（您必须`regtlibv12.exe`自己手动运行）。

3.  可以通过调用“regtlibv12.exe -u MyComDLL.tlb”取消注册 COM 组件。

4.  如果您构建您的项目，并且 VS2012 抱怨它无法写入输出 .dll，这意味着 R 由于调用而锁定它`x <- comCreateObject("InteropSample.MyClass32")`。要解锁 .dll 以便可以编译 VS2012，请关闭 R，编译 C#，然后重新启动 R。

**附加信息**

1.  请参阅有关[package的](http://cran.r-project.org/web/packages/rcom/)[R 帮助`rcom`](http://cran.r-project.org/web/packages/rcom/)。
2.  参见[用户手册`rcom`](http://cran.r-project.org/web/packages/rcom/rcom.pdf)。
3.  请参阅[statconn Wiki 页面](http://homepage.univie.ac.at/erich.neuwirth/php/rcomwiki/doku.php)。
4.  如果它不适用于 R v2.15，请尝试使用 R v2.14。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T22:11:32.957

我知道这个问题很老，我报告我的经验来帮助未来的 .Net/R 开发人员。

无论我尝试了什么，我都无法参考`rcom_srv.tlb`

*`C:\Program Files\R\R-2.15.3\library\rcom\libs\i386\rcom_srv.tlb`无法添加对的引用。请确保该文件是可访问的，并且它是一个有效的程序集或 COM 组件。*

![在此处输入图像描述](../Images/648534744036955b5adecac66c3e581b.png)

我发现[这篇文章](http://inferno4proteomics.googlecode.com/svn-history/r58/trunk/Tools/clsRconnect.cs)同时使用了 RCOMServerLib 和 STATCONNECTORSRVLib：

```
public STATCONNECTORSRVLib.StatConnectorClass rdcom = null;
//public RCOMServerLib.InternalConnectorClass rdcom = null; // Use 'rcom' for debugging 
```

我都无法取得进展，所以我最终在没有 RcomServerLib 的情况下做到了：

```
namespace XYZ.dotNetProject_R
{
    [Guid("FA6F70DD-CDD0-4FF3-94BA-E2B94E68321D"),
    InterfaceType(ComInterfaceType.InterfaceIsDual)]
    public interface IDataHelper
    {
        string[,] GetdotNetProject2DArray(string code, DateTime fromDate, DateTime toDate);        
    }

    [ComVisible(true)]
    [ProgId("XYZ.dotNetProject_R")]
    public class DataHelper : IDataHelper
    {
        public string[,] GetdotNetProject2DArray(string code, DateTime fromDate = default(DateTime), DateTime toDate = default(DateTime))
        {

        }
    }
} 
```

我通过**R**调用它：

```
# On some PC's it wont download the Package until you set it to use your IE Proxy Settings:
setInternet2(TRUE)
# This is a once-off call.
install.packages("rcom")
# This is a once-off call.
installstatconnDCOM()

#Resusable calls
> library('rcom')
Loading required package: rscproxy
> dll = comCreateObject("XYZ.dotNetProject_R")
> dll
<pointer: 0x2079002c>
attr(,"class")
[1] "COMObject"
> series = comInvoke(dll,"GetdotNetProject2DArray","abc123","2000-01-01","2010-01-01")
> series
    [,1]         [,2]                 
 [1,] "2000-01-01" "1236.1" 
```

COM 不支持泛型，所以我只返回了一个字符串数组。我发现**R**仅支持基本/原始 .Net 类型，例如字符串、日期时间、int 等。当我尝试返回对象数组时，它失败了，.Net 调用将 NULL 返回给 R。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T21:10:35.080

一般来说，你使用[`comInvoke`](http://www.inside-r.org/packages/cran/rcom/docs/comInvoke)：

```
s <- comInvoke(x,"Reverse") 
```

但是，由于既没有方法`System.Text.ASCIIEncoding`也没有`string`方法`Reverse`，因此您需要选择不同的方法来执行。

# xslt - XSLT 未正确转换

> ID：14862862
> 
> 赞同：0
> 
> 时间：2013-02-13T20:50:45.603
> 
> 标签：xslt, xml-parsing

我的 XML 文件：

```
<result>
    <xml_acc>
        <CheckInFrom>01:15</CheckInFrom>
        <CheckInTo>00:30</CheckInTo>
        <CheckOutFrom>00:45</CheckOutFrom>
        <CheckOutTo>01:15</CheckOutTo>
        <hotel_id>1</hotel_id>
        <name>Tahir Hotel</name>
        <hoteltype>Tahir Hotel</hoteltype>
        <CityID>1</CityID>
        <city>London</city>
        <CountryID>26</CountryID>
        <CurrencyId>26</CurrencyId>
        <languagecode>1</languagecode>
        <Latitude>13131313</Latitude>
        <Longitude>11131131</Longitude>
        <max_persons_in_reservation>1000</max_persons_in_reservation>
        <ranking>1</ranking>
        <url>123Testing</url>
        <zip>W2 6DX</zip>
    </xml_acc>
    <xml_acc>
        <CheckInFrom>01:15</CheckInFrom>
        <CheckInTo>00:30</CheckInTo>
        <CheckOutFrom>00:45</CheckOutFrom>
        <CheckOutTo>01:15</CheckOutTo>
        <hotel_id>1</hotel_id>
        <name>Tahir Hotel</name>
        <hoteltype>Tahir Hotel</hoteltype>
        <CityID>1</CityID>
        <city>London</city>
        <CountryID>26</CountryID>
        <CurrencyId>26</CurrencyId>
        <languagecode>1</languagecode>
        <Latitude>13131313</Latitude>
        <Longitude>11131131</Longitude>
        <max_persons_in_reservation>1000</max_persons_in_reservation>
        <ranking>1</ranking>
        <url>123Testing</url>
        <zip>W2 6DX</zip>
    </xml_acc>
</result> 
```

我正在申请以下 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"  method="html" />
  <xsl:strip-space elements="*"/>

  <xsl:template match="xml_acc">
      <result>
    <!--<xsl:apply-templates select="node()[not(self::CheckInTo) and not(self::CheckInFrom)][not(self::CheckOutTo) and not(self::CheckOutFrom)]"/>-->
    <Address>
      <xsl:apply-templates select="Address"/>
    </Address>
    <checkin>
      <from>
        <xsl:apply-templates select="CheckInTo"/>
      </from>
      <to>
        <xsl:apply-templates select="CheckInFrom"/>
      </to>
    </checkin>
    <city>
      <xsl:apply-templates select="city"/>
    </city>
    <city_id>
     <xsl:apply-templates select="CityID"/>
    </city_id>
    <Location>
      <Latitude>
          <xsl:apply-templates select="Latitude"/>
        </Latitude>
        <Longitude>
          <xsl:apply-templates select="Longitude"/>
        </Longitude>
    </Location>
    <city_id>
      <xsl:apply-templates select="CityID"/>
    </city_id>
    <max_persons_in_reservation>
      <xsl:apply-templates select="max_persons_in_reservation"/>
    </max_persons_in_reservation>
    <name>
      <xsl:apply-templates select="name"/>
    </name>
    <ranking>
      <xsl:apply-templates select="ranking"/>
    </ranking>
    <url>
      <xsl:apply-templates select="url"/>
    </url>
    <zip>
      <xsl:apply-templates select="zip"/>
    </zip>
      </result>
  </xsl:template>
</xsl:stylesheet> 
```

我得到了结果：

```
<result>
    <Address>
    </Address>
    <checkin>
        <from>00:30</from>
        <to>01:15</to>
    </checkin>
    <city>London</city>
    <city_id>1</city_id>
    <Location>
        <Latitude>13131313</Latitude>
        <Longitude>11131131</Longitude>
    </Location>
    <city_id>1</city_id>
    <max_persons_in_reservation>1000</max_persons_in_reservation>
    <name>Tahir Hotel</name>
    <ranking>1</ranking>
    <url>123Testing</url>
    <zip>W2 6DX</zip>
</result>
<result>
    <Address></Address>
    <checkin>
        <from>00:30</from>
        <to>01:15</to>
    </checkin>
    <city>London</city>
    <city_id>1</city_id>
    <Location>
        <Latitude>13131313</Latitude>
        <Longitude>11131131</Longitude>
    </Location>
    <city_id>1</city_id>
    <max_persons_in_reservation>1000</max_persons_in_reservation>
    <name>Tahir Hotel</name>
    <ranking>1</ranking>
    <url>123Testing</url>
    <zip>W2 6DX</zip>
</result> 
```

我的 XSLT 正在生成带有多个根标记的 XML。我希望应该有一个根元素，并且在这个标签中应该出现多个标签。我想要这样的结果：

```
<hotels>
   <result>
    <Address>
    </Address>
    <checkin>
        <from>00:30</from>
        <to>01:15</to>
    </checkin>
    <city>London</city>
    <city_id>1</city_id>
    <Location>
        <Latitude>13131313</Latitude>
        <Longitude>11131131</Longitude>
    </Location>
    <city_id>1</city_id>
    <max_persons_in_reservation>1000</max_persons_in_reservation>
    <name>Tahir Hotel</name>
    <ranking>1</ranking>
    <url>123Testing</url>
    <zip>W2 6DX</zip>
</result>
<result>
    <Address></Address>
    <checkin>
        <from>00:30</from>
        <to>01:15</to>
    </checkin>
    <city>London</city>
    <city_id>1</city_id>
    <Location>
        <Latitude>13131313</Latitude>
        <Longitude>11131131</Longitude>
    </Location>
    <city_id>1</city_id>
    <max_persons_in_reservation>1000</max_persons_in_reservation>
    <name>Tahir Hotel</name>
    <ranking>1</ranking>
    <url>123Testing</url>
    <zip>W2 6DX</zip>
  </result>
</hotels> 
```

请帮我解决这个问题。我创建了一个测试页面，您可以通过将此处的粘贴文本复制到我的页面来检查您的建议。下面是测试代码的链接：

[http://shahbaz.somee.com/Default.aspx](http://shahbaz.somee.com/Default.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:54:50.147

我要补充：

```
<xsl:template match="/">
   <hotels>
      <xsl:apply-templates select="result/xml_acc"/>
   </hotels>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:16:47.223

Goran 提供的答案是正确的，应该可以修复您的代码。

尽管如此，我仍将发布我的解决方案，重写您的一些原始代码，因为我认为它更符合 XSLT 理念并且更易于维护。但是输出略有不同：没有出现在源文档中的元素不会被复制到结果文档中（例如地址）以及元素的输出顺序。

```
<?xml version="1.0" encoding="utf-8" ?>

<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="1.0">

<xsl:output omit-xml-declaration="yes" indent="yes" method="xml" />
<xsl:strip-space elements="*"/>

<!-- Default template : ignore unrecognized elements and text -->
<xsl:template match="*|text()" />

<!-- Match document root : add hotels element and process each children node of result -->
<xsl:template match="/">
    <hotels>
        <!-- We assume that the XML documents are always going to follow the structure:
             result as the root node and xml_acc elements as its children -->
        <xsl:for-each select="result/xml_acc">
            <result>
                <xsl:apply-templates />
            </result>
        </xsl:for-each>
    </hotels>
</xsl:template>

<!-- Elements to be copied as they are -->
<xsl:template match="Address|city|max_persons_in_reservation|name|ranking|url|zip">
    <xsl:copy-of select="." />
</xsl:template>

<!-- Mapping CityID to city_id-->
<xsl:template match="CityID">
    <city_id>
        <xsl:value-of select="." />
    </city_id>
</xsl:template>

<!-- Elements which need to be joined with sibling elements -->

<xsl:template match="CheckInFrom">
    <checkin>
        <from><xsl:value-of select="." /></from>
        <to><xsl:value-of select="../CheckInTo" /></to>
    </checkin>
</xsl:template>

<xsl:template match="Latitude">
    <Location>
        <xsl:copy-of select=".|../Longitude" />
    </Location>
</xsl:template>

</xsl:stylesheet> 
```

# html - 使用 display: table 时，如何使内部 DIV 填充到外部 DIV 的高度？

> ID：14862869
> 
> 赞同：1
> 
> 时间：2013-02-13T20:51:08.270
> 
> 标签：html, css

我有以下 HTML 可以在这个[小提琴中看到：](http://jsfiddle.net/9DDgD/)

```
<div id="parent">
    <div id="a" class="grid_6" style="background-color: #ff00ff">
        <div class="block-border">
            <div style="background-color: #123456">
            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.
            </div>
        </div>
    </div>
    <div id="b" class="grid_6" style="background-color: #ffff00">
        <div class="block-border">
            <div id="xx" style="background-color: red;">
            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.
            </div>
        </div>
    </div>
</div> 
```

如何使 id="xx" 的 DIV 扩展高度以填充包含的 DIV？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-13T21:41:18.347

如果您设置`.grid_6`to have`position: relative`并且`#xx`to have`height: 100%; position: absolute;`它应该可以工作。虽然，这可能并不理想。

```
#parent {
    display: table-row; 
}

.grid_6 {
    position: relative;
    display: table-cell;
    width: 50%;       
}

#xx {
    height: 100%;
    position: absolute; 
} 
```

将此[小提琴](http://jsfiddle.net/derekaug/a8mpt/)视为一个工作示例。

# ios - NSString 正则表达式，用于提取负数作为方程的一部分

> ID：14862879
> 
> 赞同：2
> 
> 时间：2013-02-13T20:51:30.570
> 
> 标签：ios, objective-c, regex, nsstring

我正在尝试使用正则表达式（在 iPhone 应用程序上的 Objective-C 中）匹配数学方程，并且可以使用帮助来提出适用于下面列出的第二种情况的正则表达式。

我创建了以下 Objective-C 代码来提取表单的等式，`(1÷4)`或者`(-1÷4)`如果在乘积或除数前面有一个负数：（我在这里包括这个以帮助解释我试图回答的问题）

```
NSString* equation = @"1+(-1÷4)";
NSString* matcher = @"(-){0,1}(\\.|\\d)+(÷|×){1,}";
    NSRegularExpression *equation_regex = [NSRegularExpression  regularExpressionWithPattern:matcher options:NSRegularExpressionCaseInsensitive error:nil];
    while([equation_regex numberOfMatchesInString:working_function options:0 range:NSMakeRange(0, [equation length])])
    {
    // regex finds '-1÷4'
} 
```

但是，对于以下等式，这会分崩离析： 3-1÷4 其中不应提取 -1，因为它不是等式中 1÷4 的一部分。

我试图改变正则表达式（以我​​有限的正则表达式专业知识！）排除 -1 IFF 前面有一个数字 - 通过以下方式：

```
NSString* equation = @"3-1÷4";
NSString* matcher = @"((^\\d)(-)){0,1}(\\.|\\d)+(÷|×){1,}";
    NSRegularExpression *power_regex = [NSRegularExpression  regularExpressionWithPattern:power_regex_pattern options:NSRegularExpressionCaseInsensitive error:nil];
    while([power_regex numberOfMatchesInString:working_function options:0 range:NSMakeRange(0, [working_function length])])
    {

} 
```

如果 - （即not ）上没有前导数字，则正则表达式`((^\\d)(-)){0,1}`是我尝试仅匹配负数部分的地方，这不起作用，因此是问题。我希望我已经充分解释了这一点！提前致谢。`1÷4``-1÷4`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T09:44:22.483

如果你想避免匹配`-`如果它前面有一个数字，你可以使用

```
"((?<!\\d)-)?[\\d.]+[÷×][\\d.]+" 
```

尾随`?`是可选`((?<!\\d)-)?`的`-`，如果它存在，`(?<!\\d)`如果它前面有一个数字，则否定的后视会阻止匹配。

`[\\d.]+`匹配`0-9`或`.`一次或多次。

请注意，仅使用`java.util.regex`该类进行了测试，尽管我认为`NSRegularExpression`该类是相似的。

**编辑：**

我发现很难准确理解你想要做什么，但如果你只是想匹配一个负数，如果它前面没有数字，你可以使用

```
"(?<!\\d)-\\d+(\\.\\d+)?" 
```

# python - numpy数组的展平

> ID：14862882
> 
> 赞同：3
> 
> 时间：2013-02-13T20:51:39.567
> 
> 标签：python, numpy

我正在对图像进行数据挖掘。每个像素都被视为一个数据点。图像读取如下：

```
im=Image.open('lena.bmp')
im=numpy.array(im)
print im.shape 
```

根据图像是彩色还是灰度，im.shape 是 (10,10, 3) 或 (10,10,1)

之后，将图像展平为特征矩阵，如下所示：

如果 (10,10,3)，那么 --->(100,3)

如果 (10,10,1)，那么 --->(100,1)

我该如何为此编写多态函数？我目前的做法是：

```
obs=reshape(im,(im.shape[0]*im.shape[1],1, im.size/(im.shape[0]*im.shape[1]))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:51:55.810

你可以做：

```
obs = np.reshape(im, (-1, im.shape[-1])) 
```

# javascript - 使用 KineticJS 在 JavaScript 中拖动多个图层

> ID：14862884
> 
> 赞同：1
> 
> 时间：2013-02-13T20:51:42.140
> 
> 标签：javascript, events, dom-events, kineticjs

我正在尝试同步拖动多个图层。这里的例子：http: [//jsfiddle.net/e8Z3a/](http://jsfiddle.net/e8Z3a/)

```
var stage = new Kinetic.Stage({
  container: document.getElementById('canvas'),
  width: 600,
  height: 600
});

var imageLayer = new Kinetic.Layer();
stage.add(imageLayer);

var imageObj = new Image();
imageObj.src = 'http://laughingsquid.com/wp-content/uploads/Tard2.jpg';

imageObj.onload = function () {
  var image = new Kinetic.Image({
      image: imageObj
  });

  imageLayer.add(image);
  imageLayer.setWidth(imageObj.naturalWidth);
  imageLayer.setHeight(imageObj.naturalHeight);

  imageLayer.draw();
};

var drawingLayer = new Kinetic.Layer();
stage.add(drawingLayer);

var mustache = new Kinetic.Polygon({
  points: [
    380, 380,
    410, 350,
    380, 390,
    210, 390,
    180, 350,
    210, 380
  ],
  fill: 'black'
});

drawingLayer.add(mustache);
drawingLayer.draw();

var posX, posY;
imageLayer.on('dragstart', function(event) {
  posX = event.clientX;
  posY = event.clientY;
});

imageLayer.on('dragmove dragend', function(event) {
  drawingLayer.move(event.clientX - posX, event.clientY - posY);
  drawingLayer.draw();

  posX = event.clientX;
  posY = event.clientY;
});

imageLayer.setDraggable(true); 
```

问题是同步缺少一些事件。在做了一系列短拖之后，小胡子层留在后面，好像它在途中错过了一些事件。

我的观察导致了一个猜测，即快速拖动有效。我的意思是，如果您在不移动鼠标的情况下抓取图像，沿随机方向快速移动，停止鼠标然后松开，图层保持同步。问题在于鼠标移动时的抓握和放手。

你能教我如何调试这类问题吗？是否有类似 TDD 的方法来处理与事件相关的内容？有什么办法可以记录一系列事件而不是重播它，同时添加一些调试代码？经典的一步一步调试在这里完全没用...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:50:31.940

我会很简单，

```
imageLayer.on('dragmove', function() {
    drawingLayer.setAttrs({x:this.getX(), y:this.getY()});
    drawingLayer.draw();
}); 
```

我的例子， [http://jsfiddle.net/QTu8K/38](http://jsfiddle.net/QTu8K/38)（更新）

# facebook - 如何以不受支持的语言实现图形 API？

> ID：14862889
> 
> 赞同：0
> 
> 时间：2013-02-13T20:52:16.693
> 
> 标签：facebook, facebook-graph-api

我想在“tcl”中实现图形 api，在 facebook 开发人员站点中没有 SDK （甚至在第三方 sdks 中也没有），我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:53:39.407

您不需要 SDK。Facebook Graph API 是一个 REST Web 服务。唯一要做的就是在你的 tcl 代码中使用 web 服务。

如何在 tcl 中使用 webservices 参见：[http ://core.tcl.tk/tclws/wiki?name=WSClient+Client+Side](http://core.tcl.tk/tclws/wiki?name=WSClient+Client+Side)

# ruby-on-rails - wkhtmltoimage 不适用于 CentO 上的 websnap/imgkit

> ID：14862892
> 
> 赞同：0
> 
> 时间：2013-02-13T20:52:23.717
> 
> 标签：ruby-on-rails, wkhtmltoimage, imgkit

这是生成适用于开发环境的 png 的操作。

```
 def action
    html = "<b>test</b>"
    snap = IMGKit.new(html, :'crop-h' => 750, :'crop-h' => 290, quality: 50)

    respond_to do |format|
      format.png { send_data snap.to_img(:png) }
    end
  end 
```

但在 CentOS（生产）服务器上，它只生成空白文件。请注意，此代码可在生产服务器上的 rails 控制台中使用，但在控制器操作中不起作用。

```
 html = "<b>test</b>"
  snap = IMGKit.new(html, :'crop-h' => 750, :'crop-h' => 290, quality: 50) 
```

是线程问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:11:41.747

它以某种方式起作用：

```
 -    respond_to do |format|
 -      format.png { send_data snap.to_img(:png) }
 -    end
 +    send_data snap.to_img(:jpg) 
```

请注意，在我的情况下，使用哪种格式没有区别，有损 .jpg 或无损 .png

# php - strtotime 没有以正确的格式返回

> ID：14862894
> 
> 赞同：2
> 
> 时间：2013-02-13T20:52:28.630
> 
> 标签：php

我有一些 php 可以更改从数据库中检索到的时间格式：

```
$selectedDate = $_GET['date'];
$formatedDate = date("Y-d-m",strtotime($selectedDate)); // Y-m-d outputs Y-d-m oddly

echo "<form name='selectedDate' action='info.php' method='GET'>";
    echo "<select name='date' onchange='this.form.submit()'>";
    echo "<option value=select>Select a Date</option>";
        while ($row = mysql_fetch_array($result))
        {
            $date = date("m-d-Y",strtotime($row['date']));          
            echo "<option>" . $date . "</option>";
        }
        echo "</select>";echo "<br />";

            echo $selectedDate; // 1.) in: 02-13-2013, 2.) in: 02-12-2013
            echo "<br />";
            echo $formatedDate; // 1.) out: 1970-01-01, 2.) out: 2013-02-12
            echo "<br />";
        echo date("Y-m-d");

    echo "<noscript>";
    echo "<input type='submit' value='Select'>";
    echo "</noscript>";
    echo "</form>"; 
```

现在，对于`$formatedDate`，如前所述，如果我`Y-m-d`用于输出，我得到`2013-12-02`的不是`2013-02-12`. 更不用说，即使所有`$selectedDate`'s 在`m-d-Y`格式化之前都在，它也不会将它们识别为`dates`. 我有一种感觉，我错过了一些完全愚蠢的东西，但我就是看不到它。

所以我的问题是，为什么`strtotime()`我的月份和日期会颠倒过来，为什么它不能识别所有日期？有没有更好的方法来完成这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:04:31.170

根据[http://www.php.net/manual/en/datetime.formats.php](http://www.php.net/manual/en/datetime.formats.php)和列表：[http ://www.php.net/manual/en/datetime.formats.date.php](http://www.php.net/manual/en/datetime.formats.date.php)

strtotime() 无法识别“mdY”格式。

它被解释为最初采用“dmY”格式。'02-13-2013' 被解释为 '2nd of 13th Month 2013' 这是无效的，因此输出的是 unix 纪元。

您可以尝试用斜杠替换“-”，然后它将匹配格式 1 (m/d/Y)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:09:17.940

m/d/y 或 dmy 格式的日期通过查看各个组件之间的分隔符来消除歧义：如果分隔符是斜杠 (/)，则假定为美式 m/d/y；而如果分隔符是破折号 (-) 或点 (.)，则假定为欧洲 dmy 格式。

为避免潜在的歧义，最好尽可能使用 ISO 8601 (YYYY-MM-DD) 日期或 DateTime::createFromFormat()。

请使用以下方式

$date = DateTime::createFromFormat('mdY', '02-14-2013'); echo $date->format('Ymd');

# c# - 从从 jpeg 转换的隔离存储中获取像素数组

> ID：14862896
> 
> 赞同：2
> 
> 时间：2013-02-13T20:52:33.713
> 
> 标签：c#, pixels, isolatedstoragefile, writablebitmap

试图解决这个问题好几天 - （WP7）让它在 Win 8 中第一次工作，感谢帮助..

只是我想从我的独立存储中读取 JPEG，将 JPEG 转换为可写位图，然后弄乱像素。我目前正在尝试的代码是这个，主要是从这个站点复制的 :-).. 问题是当我查看 wbm (WritableBitmap) .pixels 时，它们都是 -1.. 内存流是正确的 JPEG，但我想要位图。。

```
BitmapImage bi = new BitmapImage();

using (IsolatedStorageFile myIsolatedStorage =         IsolatedStorageFile.GetUserStoreForApplication())
{
   using (IsolatedStorageFileStream fileStream = myIsolatedStorage.OpenFile(s, FileMode.Open, FileAccess.Read))
     {
      bi.SetSource(fileStream);

      fileStream.Position = 0; // just in case..
      WriteableBitmap wbm = new WriteableBitmap(bi);
      wbm.LoadJpeg(fileStream);
  }
} 
```

还尝试插入以下内容---

```
bi.CreateOptions = BitmapCreateOptions.None;
bi.ImageOpened += (x, e) =>
 {
     WriteableBitmap wbm = new WriteableBitmap((BitmapImage)x);
 }; 
```

以确保加载位图..

提前感谢您的帮助

# opencart - 哪些模型/控制器负责从 data['cart'] 向数据库下订单？

> ID：14862900
> 
> 赞同：1
> 
> 时间：2013-02-13T20:52:55.577
> 
> 标签：opencart

我正在为 opencart 创建一个自定义扩展，它允许人们设计杯子和 T 恤等产品，我有必要将与他们的设计相关的信息存储在数据库中。

我无法确定哪些模型和控制器包含负责将订单放入数据库的方法，以及在订购工作流程中的什么时候调用这些方法，所以如果有人知道并可以启发我，我将非常感激， 谢谢你。

*编辑因为我的英语很糟糕，但我确实试图纠正最明显的错误。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:10:40.467

调用它的控制器是`catalog/controller/checkout/confirm.php` 模型正在`catalog/model/checkout/order.php`调用`addOrder()`您可以在控制器中找到的方法，由以下代码调用

```
$this->session->data['order_id'] = $this->model_checkout_order->addOrder($data); 
```

# java - Android 应用程序无论如何都不会运行？

> ID：14862902
> 
> 赞同：1
> 
> 时间：2013-02-13T20:53:08.797
> 
> 标签：java, android, android-emulator

我正在开发一个应用程序，现在一周来我一直试图弄清楚为什么它不会在模拟器上部署应用程序。

[Google Docs 上的完整 log.txt](https://docs.google.com/file/d/0B4fPNXA85-WUQW5MeFFLM29CbE0/edit?usp=sharing)，摘录在这里：

```
02-13 20:31:46.677: E/cutils(40): Failed to read /data/.layout_version: No such file or directory
02-13 20:31:48.437: E/SurfaceFlinger(36): hwcomposer module not found
02-13 20:31:48.487: E/Trace(36): error opening trace file: No such file or directory (2)
02-13 20:31:49.228: E/SurfaceFlinger(36): ro.sf.lcd_density must be defined as a build property
02-13 20:31:49.347: E/SurfaceFlinger(36): ro.sf.lcd_density must be defined as a build property
02-13 20:31:49.447: E/Trace(90): error opening trace file: No such file or directory (2)
02-13 20:31:54.737: E/BandwidthController(33): runIptablesCmd(): failed /system/bin/iptables -A bw_INPUT -m owner --socket-exists res=256
02-13 20:31:54.847: E/BandwidthController(33): runIptablesCmd(): failed /system/bin/ip6tables -A bw_INPUT -m owner --socket-exists res=256
02-13 20:31:54.857: E/Netd(33): Unable to bind netlink socket: No such file or directory
02-13 20:31:54.857: E/Netd(33): Unable to open quota2 logging socket
02-13 20:35:14.288: E/AndroidRuntime(518): *** FATAL EXCEPTION IN SYSTEM PROCESS: main
02-13 20:35:14.288: E/AndroidRuntime(518): java.lang.NullPointerException
02-13 20:35:14.288: E/AndroidRuntime(518): at android.accessibilityservice.UiTestAutomationBridge.connect(UiTestAutomationBridge.java:195)
02-13 20:35:14.288: E/AndroidRuntime(518): at com.android.commands.uiautomator.DumpCommand.run(DumpCommand.java:61)
02-13 20:35:14.288: E/AndroidRuntime(518): at com.android.commands.uiautomator.Launcher.main(Launcher.java:83)
02-13 20:35:14.288: E/AndroidRuntime(518): at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
02-13 20:35:14.288: E/AndroidRuntime(518): at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:235)
02-13 20:35:14.288: E/AndroidRuntime(518): at dalvik.system.NativeStart.main(Native Method)
02-13 20:35:14.320: E/JavaBinder(518): Unknown binder error code. 0xfffffff7
02-13 20:35:14.368: E/ServiceManager(518): error in getService
02-13 20:35:14.368: E/ServiceManager(518): android.os.RemoteException: Unknown binder error code. 0xfffffff7
02-13 20:35:14.368: E/ServiceManager(518): at android.os.BinderProxy.transact(Native Method)
02-13 20:35:14.368: E/ServiceManager(518): at android.os.ServiceManagerProxy.getService(ServiceManagerNative.java:123)
02-13 20:35:14.368: E/ServiceManager(518): at android.os.ServiceManager.getService(ServiceManager.java:55)
02-13 20:35:14.368: E/ServiceManager(518): at android.app.ActivityManagerNative$1.create(ActivityManagerNative.java:1817)
02-13 20:35:14.368: E/ServiceManager(518): at android.app.ActivityManagerNative$1.create(ActivityManagerNative.java:1815)
02-13 20:35:14.368: E/ServiceManager(518): at android.util.Singleton.get(Singleton.java:34)
02-13 20:35:14.368: E/ServiceManager(518): at android.app.ActivityManagerNative.getDefault(ActivityManagerNative.java:74)
02-13 20:35:14.368: E/ServiceManager(518): at com.android.internal.os.RuntimeInit$UncaughtHandler.uncaughtException(RuntimeInit.java:76)
02-13 20:35:14.368: E/ServiceManager(518): at java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:693)
02-13 20:35:14.368: E/ServiceManager(518): at java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:690)
02-13 20:35:14.368: E/ServiceManager(518): at dalvik.system.NativeStart.main(Native Method)
02-13 20:35:14.388: E/AndroidRuntime(518): Error reporting crash
02-13 20:35:14.388: E/AndroidRuntime(518): java.lang.NullPointerException
02-13 20:35:14.388: E/AndroidRuntime(518): at com.android.internal.os.RuntimeInit$UncaughtHandler.uncaughtException(RuntimeInit.java:76)
02-13 20:35:14.388: E/AndroidRuntime(518): at java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:693)
02-13 20:35:14.388: E/AndroidRuntime(518): at java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:690)
02-13 20:35:14.388: E/AndroidRuntime(518): at dalvik.system.NativeStart.main(Native Method) 
```

我真的很想弄清楚这一点，非常感谢任何帮助！

# java - 重新渲染时跳过验证，仅适用于表单提交

> ID：14862903
> 
> 赞同：3
> 
> 时间：2013-02-13T20:53:13.610
> 
> 标签：java, validation, jsf-2, richfaces

我有一个输入字段，用户可以在其中输入一些产品名称。根据输入的名称，应显示该产品的特定详细信息。在输入更改时，我通过当前字段值从数据源获取产品，并使用`AJAX`. 到目前为止，用户在输入正确名称之前无法查看产品详细信息。

这是代码示例：

```
<h:form>
    <h:inputText id="product" value="#{myBean.product}" required="true" converter="productConverter">
        <a4j:ajax event="change" render="product, details"/>
    </h:inputText>

    <rich:message for="product" ajaxRendered="true"/>

    <h:panelGroup id="details">
        <h:outputText rendered="#{not empty myBean.product}" value="#{myBean.product.details}"/>
    </h:panelGroup>

    <a4j:commandButton execute="@form" render="@form" value="Validate" action="validate"/>
</h:form> 
```

**转换器**：

```
public class ProductConverter implements Converter {

public Object getAsObject(FacesContext context, UIComponent component, String name) {
    return (name != null && ProductDataSource.projectExist(name)) ? new Product(name) : null;
}

public String getAsString(FacesContext context, UIComponent component, Object value) {
    return (value instanceof Product) ? ((Product) value).getName() : "";
} 
```

该产品是必填字段，因此在输入正确名称之前无法提交表单。到目前为止，当用户输入错误的名称时，转换器返回 null 并且验证失败。但我想要的是仅在表单提交时验证此字段，并在重新呈现输入字段时跳过验证。我试图申请`immediate="true"`两者`a4j:ajax`，`h:inputText`但没有任何帮助。有任何想法吗？

提前致谢！

（我正在使用 JSF 2，Richfaces 4）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T11:56:15.523

仅当按下提交按钮时才让`required`属性评估。`true`您可以通过在请求参数映射中检查其客户端 ID 的存在来做到这一点，如下所示：

```
<h:inputText ... required="#{not empty param[button.clientId]}" />
...
<a4j:commandButton binding="#{button}" ... /> 
```

*（不，您不需要将其绑定到 bean 属性，代码按原样完成）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T05:22:10.883

为了跳过 Jsf 验证，您已添加到表单 write immediate="true" in a4j:commandButton

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-25T06:42:57.073

尝试使用类似的东西

```
<a4j:outputPanel ajaxRendered="true">
   <h:inputText id="product" value="#{myBean.product}" required="true" converter="productConverter">
      <a4j:support event="onchange" reRender="details" ajaxSingle="true"/>
   </h:inputText>

   <rich:message id="product" for="details" ajaxRendered="true">
   <h:panelGroup id="details">
      <h:outputText rendered="#{not empty myBean.product}" value="#{myBean.product.details}"/>
   </h:panelGroup>

</a4j:outputPanel> 
```

主要思想是使用**ajaxSingle="true"**来避免完整的输出面板验证。

# vba - MS Access 2010 通过 VBA 更改主题

> ID：14862910
> 
> 赞同：0
> 
> 时间：2013-02-13T20:53:37.743
> 
> 标签：vba, ms-access, themes

我希望在 MS Access 2010 数据库中制作一个简单的表单，用户可以在其中选择要使用的主题。如何通过vba更改数据库的主题？谷歌对这个问题没有太大帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-03T21:24:10.497

我知道这个问题是不久前提出的，但是由于我在研究设置主题时遇到了这个问题，所以我想我应该尝试提供一些我发现的东西。

在让用户选择主题时，我认为最简单的方法就是将“颜色”按钮放在功能区中。如果您碰巧制作了自己的自定义色带，您可以使用它`<control idMso="ThemeColorsGallery" />`来引用“颜色”选项。

如果您想尝试更精确地控制发生的事情，我想我可能已经找到了一个选项，但它涉及更多一点，我还没有制定出细节。不过，我想发布它，因为我认为有人可能想要使用它。

在控制图片库功能时，我意识到隐藏的“MSysResources”表中有一个“Office Theme”条目。我相信“MySysResources”表中“Office 主题”行中的任何内容都决定了程序启动时加载的主题。我测试这个想法的方法是我选择了一个主题，然后走到桌子旁，将附件保存到桌面。然后我去选择了一个不同的主题，并通过查看我的一些表格来确保它就位。然后，我回到表格并删除了“Office Theme”行中的内容，并将保存的文件上传回附件中。在我关闭并重新打开程序后，

我设想可能使用的方式是您可以通过代码分配该附件。特别是，如果您想基于特定于您的程序的配置选项覆盖默认设置，这似乎很有用。

**2015 年 8 月 18 日更新：** 有人要求提供有关我如何通过 VBA 设置主题的更多详细信息，因此我将在此处提供。基本理论是我将 MSysResources 中附件字段中的数据保存到表中。然后，如果我需要用我保存的主题覆盖当前主题，我会从我的表中提取它并将其保存在适当的 MSysResources 记录中。请注意，我使用 MySQL 作为我的表存储平台，并且使用名为“Lgo”的 MediumBlob 字段来存储数据。

这是我使用的两个函数。第一个函数将主题保存到我的 MySQL 表中。第二个函数提取保存的数据并将其保存在 MSysResourcestable 中当前主题的顶部。请注意，要查看第二个函数的效果，您必须在运行该函数后关闭并重新打开程序。

```
Function SveThm()'Save Theme
    Dim MSR As Recordset, Atc As Recordset, LR As Recordset
    Set MSR = CurrentDb.OpenRecordset("SELECT * FROM MSysResources WHERE [Name]='Office Theme'", dbOpenDynaset)
    If MSR.RecordCount > 0 Then
        Set Atc = MSR!Data.Value
        Set LR = CurrentDb.OpenRecordset("SELECT * FROM tbllgo;", dbOpenDynaset)
        If LR.RecordCount = 0 Then LR.AddNew Else LR.Edit
        LR!Stn = LgoStn
        LR!Lgo = CStr(Atc!FileData)
        LR!Typ = Typ
        LR.Update
        LR.Close
        MsgBox "Your theme has been saved."
    End If
End Function

Function SetMSys()'Set MSysResources
    Dim MSys As Recordset, Lgo As Recordset, Atc As Recordset
    Set MSys = CurrentDb.OpenRecordset("SELECT * FROM MSysResources WHERE [Name]='Office Theme'", dbOpenDynaset)
    If MSys.RecordCount > 0 Then
        MSys.Edit
        Set Atc = MSys!Data.Value
        Atc.Edit
        Set Lgo = CurrentDb.OpenRecordset("SELECT Lgo FROM tbllgo;", dbOpenDynaset)
        If Lgo.RecordCount > 0 Then Atc!FileData = Lgo!Lgo
        Lgo.Close
        Atc.Update
        MSys.Update
    End If
End Function 
```

# php - PHP XML如何使用simpleXML提取name =的元素

> ID：14862917
> 
> 赞同：1
> 
> 时间：2013-02-13T20:53:56.667
> 
> 标签：php, xml, parsing, simplexml

我有一个 XML 文件，我只需要从中提取某些元素。并且在某些时候，XML 文件可能会被更新并完全改变元素出现的顺序 - 但元素包含一个 name= 设置。

```
<element>
 <sub name='this1'>value</sub>
 <sub name='this2'>value</sub>
 <sub name='this3'>value</sub>
 <sub name='this4'>value</sub>     
</element> 
```

我需要提取 this2 和 this4 的值。

但是在某个阶段，可能会添加新的子元素，从而改变顺序。所以我不能使用：

```
$xml->element->sub[2] 
```

下面的例子：

```
<element>
 <sub name='this0'>value</sub>
 <sub name='this1'>value</sub>
 <sub name='this2'>value</sub>
 <sub name='this3'>value</sub>     
 <sub name='this4'>value</sub>    
</element> 
```

所以 sub[2] 会变成 this1 而不是 this2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:57:47.150

您想要的是一个 XPath 查询，例如`$myXml->xpath("/sub[@name=this1]")`. 在此处阅读有关 Xpath 的更多信息[http://php.net/manual/de/simplexmlelement.xpath.php](http://php.net/manual/de/simplexmlelement.xpath.php)

# ruby-on-rails - 为什么我的 Rails 不能上传文件？

> ID：14862918
> 
> 赞同：1
> 
> 时间：2013-02-13T20:53:56.970
> 
> 标签：ruby-on-rails, ruby, redmine

导轨 3.2.12

红宝石 1.9.3

红米 2.2.3

Centos 6.3

我不是 Rails 专家，但我接到了升级 Redmine 的任务。[http://www.redmine.org/](http://www.redmine.org/)

Redmine 很简单，但插件非常困难。其中，我被要求安装这个插件：

[https://github.com/reubnmallaby/redmine_embedded](https://github.com/reubenmallaby/redmine_embedded)

我以为我已经正确安装了这个。如果我以管理员身份登录 Redmine，我可以看到该模块，它为我提供了以下表单：

```
 <form accept-charset="UTF-8" action="/projects/timeout/embedded/upload" enctype="multipart/form-data" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="LjMzA63/L+G8Uj/1/uFefLYMJ1MxOTdTB516XTS6rjE=" /></div>    <fieldset id="embedded_doc" class="collapsible collapsed">
      <legend onclick="toggleFieldset(this);">Upload documentation</legend>
      <div style="display: none;">
        Select File (ZIP format only, root must be html directory): 
        <input id="upload_datafile" name="upload[datafile]" type="file" />
        <input name="commit" type="submit" value="Upload" />
        </div>
    </fieldset>
</form> 
```

在插件的配置中，我将上传文件夹设置为：

```
/home/cehovice/redmine-2.2/public/uploads/{PROJECT}/html 
```

我在上传文件夹上做了 chmod 0777 。

我尝试上传 HTML 文件，但没有上传任何内容。

如果我查看 Phusion Passenger Standalone 的终端输出，我会看到：

```
Started POST "/projects/men_of_fashion/embedded/upload" for 10.0.1.53 at 2013-02-13 15:11:02 -0500
Processing by RedmineEmbeddedController#upload as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"LjMzA63/L+G8Uj/1/uFefLYMJ1MxOTdTB516XTS6rjE=", "upload"=>{"datafile"=>#<ActionDispatch::Http::UploadedFile:0x00000006f54708 @original_filename="tositeconfig.html", @content_type="text/html", @headers="Content-Disposition: form-data; name=\"upload[datafile]\"; filename=\"tositeconfig.html\"\r\nContent-Type: text/html\r\n", @tempfile=#<File:/tmp/RackMultipart20130213-26288-1r4gu37>>}, "commit"=>"Upload", "id"=>"men_of_fashion"}
   (1.2ms)  SELECT MAX(`settings`.`updated_on`) AS max_id FROM `settings` 
  User Load (0.3ms)  SELECT `users`.* FROM `users` WHERE `users`.`type` IN ('User', 'AnonymousUser') AND `users`.`id` = 176 AND (users.status = 1) LIMIT 1
  Current user: cehovice (id=176)
  Project Load (0.9ms)  SELECT `projects`.* FROM `projects` WHERE `projects`.`identifier` = 'men_of_fashion' LIMIT 1
  EnabledModule Load (0.3ms)  SELECT name FROM `enabled_modules` WHERE `enabled_modules`.`project_id` = 1
  Rendered plugins/redmine_embedded/app/views/redmine_embedded/_upload.html.erb (6.5ms)
  Rendered plugins/redmine_embedded/app/views/redmine_embedded/index.html.erb within layouts/base (7.8ms)
  UserPreference Load (0.4ms)  SELECT `user_preferences`.* FROM `user_preferences` WHERE `user_preferences`.`user_id` = 176 LIMIT 1
  SQL (1.3ms)  SELECT `members`.`id` AS t0_r0, `members`.`user_id` AS t0_r1, `members`.`project_id` AS t0_r2, `members`.`created_on` AS t0_r3, `members`.`mail_notification` AS t0_r4, `projects`.`id` AS t1_r0, `projects`.`name` AS t1_r1, `projects`.`description` AS t1_r2, `projects`.`homepage` AS t1_r3, `projects`.`is_public` AS t1_r4, `projects`.`parent_id` AS t1_r5, `projects`.`created_on` AS t1_r6, `projects`.`updated_on` AS t1_r7, `projects`.`identifier` AS t1_r8, `projects`.`status` AS t1_r9, `projects`.`lft` AS t1_r10, `projects`.`rgt` AS t1_r11, `roles`.`id` AS t2_r0, `roles`.`name` AS t2_r1, `roles`.`position` AS t2_r2, `roles`.`assignable` AS t2_r3, `roles`.`builtin` AS t2_r4, `roles`.`permissions` AS t2_r5, `roles`.`issues_visibility` AS t2_r6 FROM `members` LEFT OUTER JOIN `projects` ON `projects`.`id` = `members`.`project_id` LEFT OUTER JOIN `member_roles` ON `member_roles`.`member_id` = `members`.`id` LEFT OUTER JOIN `roles` ON `roles`.`id` = `member_roles`.`role_id` WHERE `members`.`user_id` = 176 AND (projects.status<>9) ORDER BY projects.name
   (0.5ms)  SELECT COUNT(DISTINCT `versions`.`id`) FROM `versions` LEFT OUTER JOIN `projects` ON `projects`.`id` = `versions`.`project_id` WHERE (projects.id = 1 OR (projects.status <> 9 AND ( versions.sharing = 'system' OR (projects.lft >= 99 AND projects.rgt <= 132 AND versions.sharing = 'tree') OR (projects.lft < 99 AND projects.rgt > 132 AND versions.sharing IN ('hierarchy', 'descendants')) OR (projects.lft > 99 AND projects.rgt < 132 AND versions.sharing = 'hierarchy'))))
  Tracker Load (0.1ms)  SELECT `trackers`.* FROM `trackers` WHERE `trackers`.`id` IN (2)
  IssuePriority Load (0.2ms)  SELECT `enumerations`.* FROM `enumerations` WHERE `enumerations`.`type` IN ('IssuePriority') AND `enumerations`.`is_default` = 1 ORDER BY enumerations.position ASC LIMIT 1
   (0.2ms)  select version from schema_migrations where version like '%-redmine_backlogs'
  CACHE (0.0ms)  SELECT `trackers`.* FROM `trackers` WHERE `trackers`.`id` IN (2)
  CACHE (0.0ms)  SELECT `enumerations`.* FROM `enumerations` WHERE `enumerations`.`type` IN ('IssuePriority') AND `enumerations`.`is_default` = 1 ORDER BY enumerations.position ASC LIMIT 1
   (0.3ms)  select version from schema_migrations where version like '%-redmine_backlogs'
  Wiki Load (0.3ms)  SELECT `wikis`.* FROM `wikis` WHERE `wikis`.`project_id` = 1 LIMIT 1
   (0.2ms)  SELECT COUNT(*) FROM `boards` WHERE `boards`.`project_id` = 1
  Repository Load (2.7ms)  SELECT `repositories`.* FROM `repositories` WHERE `repositories`.`project_id` = 1 AND (is_default = 1) LIMIT 1
Completed 200 OK in 221ms (Views: 192.1ms | ActiveRecord: 9.8ms) 
```

这个：

宝石环境

得到我：

```
RubyGems Environment:                                                                                                                                                              
  - RUBYGEMS VERSION: 1.8.25                                                                                                                                                       
  - RUBY VERSION: 1.9.3 (2013-02-06 patchlevel 385) [x86_64-linux]                                                                                                                 
  - INSTALLATION DIRECTORY: /usr/local/rvm/gems/ruby-1.9.3-p385                                                                                                                    
  - RUBY EXECUTABLE: /usr/local/rvm/rubies/ruby-1.9.3-p385/bin/ruby                                                                                                                
  - EXECUTABLE DIRECTORY: /usr/local/rvm/gems/ruby-1.9.3-p385/bin                                                                                                                  
  - RUBYGEMS PLATFORMS:                                                                                                                                                            
    - ruby                                                                                                                                                                         
    - x86_64-linux                                                                                                                                                                 
  - GEM PATHS:                                                                                                                                                                     
     - /usr/local/rvm/gems/ruby-1.9.3-p385                                                                                                                                         
     - /usr/local/rvm/gems/ruby-1.9.3-p385@global                                                                                                                                  
  - GEM CONFIGURATION:                                                                                                                                                             
     - :update_sources => true                                                                                                                                                     
     - :verbose => true                                                                                                                                                            
     - :benchmark => false                                                                                                                                                         
     - :backtrace => false                                                                                                                                                         
     - :bulk_threshold => 1000                                                                                                                                                     
  - REMOTE SOURCES:                                                                                                                                                                
     - http://rubygems.org/ 
```

在日志/生产中没有错误。

更新：

我设法上传了一个zip文件。但它不会自行解包。我将在 github 上为该项目提交一张票。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:01:42.013

厄运。`cannot load such file -- dispatcher`是尚未升级到与 Redmine 2.x 一起使用的插件的症状。你不需要疯狂的 Ruby 技能就可以自己做；见[http://www.redmine.org/boards/3/topics/31445](http://www.redmine.org/boards/3/topics/31445)

# javascript - 将计时器 ID 存储在特定变量中时不会触发 setTimeout 事件

> ID：14862920
> 
> 赞同：0
> 
> 时间：2013-02-13T20:53:59.987
> 
> 标签：javascript, settimeout

**我在打字时找到了答案，以为我仍然会发布它以防万一它对某人有所帮助**

我敢肯定没有人能够重现这一点，但到底是什么。:)

我们有一个页面会在一些用户输入后触发 AJAX 调用。在一些用户输入之后，我们使用 setTimeout 稍等片刻，以避免在用户完成输入之前调用 AJAX 方法。没有什么花哨。但是每隔一段时间 setTimeout 就会拒绝触发。

代码基本上如下所示：

```
var c = -1;
function userInput(input)
{
    clearTimeout(c);
    c = setTimeout(function(){load(input);}, 100);
}
function load(input)
{
    console.log("load: " + input);
    // ajax stuff.
} 
```

就像我说的，这通常工作得很好。但是当它停止工作时，“问题”似乎是对 variable 的赋值`c`。

这是来自 IE 调试控制台的片段。如果我将结果分配给`setTimeout`to `c`，则不会触发。如果我将结果分配给其他东西，或者根本不分配它，它工作正常。

```
>> c = setTimeout("load('test');", 100); 
303789 
>> setTimeout(function(){load('test');}, 100); 
311016 
LOG: load: test
>> clearTimeout(c) 
>> c = setTimeout(function(){load('test');}, 100); 
342177 
>> testtesttest = setTimeout(function(){load('test');}, 100); 
346296 
LOG: load: test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:53:59.987

您页面中的其他内容也决定使用“c”变量来存储计时器 ID。在您的新 setTimeout 有机会触发之前，其他代码正在清除它。更改为使用不同的变量（并使其名称在您使用时更具描述性）。

# python - Opencv+Python中的排序()

> ID：14862925
> 
> 赞同：1
> 
> 时间：2013-02-13T20:54:07.677
> 
> 标签：python, sorting, opencv

我有一个我无法解决的问题。我试图使用方法 sort() 制作一个时间中值滤波器，但我根本做不到。这是我尝试过的最简单的测试：

```
import cv2

def sortExample():

    img = cv2.imread("guitar.jpg")
    cv2.sort(img, cv2.SORT_ASCENDING)

sortExample() 
```

和错误：

> cv2.sort(img, cv2.SORT_ASCENDING) cv2.error: ......\src\opencv\modules\core\src\matrix.cpp:2367: error: (-215) src.dims <= 2 && src.channels() == 1 && 函数 != 0

我究竟做错了什么？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:01:47.020

错误消息告诉您检查`src.dims <= 2 && src.channels() == 1 && func != 0`失败（也许如果它不那么混乱，您就可以轻松地看到它？）。特别是告诉你频道数不是1。

因此，您可以考虑其中一个通道或将图像转换为例如灰度：`x = cv2.cvtColor(x, cv2.COLOR_BGR2GRAY)`。

# ruby-on-rails - 从 Rails 中的链接获取 IO 对象

> ID：14862926
> 
> 赞同：1
> 
> 时间：2013-02-13T20:54:08.530
> 
> 标签：ruby-on-rails, json

我想编写一个方法（在 Ruby/Rails 中），它将一个 URL（字符串）带到一个文本文件并使用 JSON 来解析它。

# 加载实体文件 def load (url) ` result = JSON.parse(x) end

应该`x`是什么？（我知道它需要是一个字符串或一个 IO 对象，但是我如何获得一个字符串/IO 对象，其内容是`url`指向的文件的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:55:52.653

```
require 'open-uri'

def load(url)
  open(url) do |file|
    JSON.parse(file.read)
  end
end 
```

# java - 如何在 Swing 中仅绘制自定义控件的可见区域？

> ID：14862927
> 
> 赞同：1
> 
> 时间：2013-02-13T20:54:17.163
> 
> 标签：java, swing, jscrollpane, invalidation

假设我有很大的自定义控件刻在里面`JScrollPane`或被其他原因剪掉了。如何从`paintComponent()`方法中确定要绘制哪些坐标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:03:12.310

看看[在 AWT 和 Swing 中的绘画](http://www.oracle.com/technetwork/java/painting-140037.html)，它有一个很好的解释。

但一般的要点是，当你的组件被绘制时，它的剪切矩形已经设置（nb 需要检查这对于视口是如何工作的，但我怀疑它是相同的）到需要更新的可见区域。

您可以检查 Graphics 上下文的剪辑矩形过去到您的绘画方法，并确定您应该更新哪个区域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:22:49.297

您可以通过以下方式找到JScrollPane*[视](http://docs.oracle.com/javase/6/docs/api/javax/swing/JScrollPane.html)* [口](http://docs.oracle.com/javase/6/docs/api/javax/swing/JViewport.html)

```
jScrollPane.getViewport() 
```

一旦在那里，您就可以知道*[JScrollPane](http://docs.oracle.com/javase/6/docs/api/javax/swing/JScrollPane.html)*显示的矩形

```
jScrollPane.getViewport().getViewRect() 
```

所以你可以用那个*[矩形](http://docs.oracle.com/javase/6/docs/api/java/awt/Rectangle.html)*来绘制你的自定义组件

问候

# javascript - 仅切换单击的行，带有使用 JQuery 的复选框

> ID：14862929
> 
> 赞同：0
> 
> 时间：2013-02-13T20:54:30.757
> 
> 标签：javascript, jquery, html

您好，有人可以帮我吗？

我正在尝试执行以下操作：

```
<table>
<thead> 
    <tr> 
        <th>Select</th> 
        <th>Name</th> 
    </tr>
</thead>    
<tr>
    <td>
        <input type="checkbox" class="toggle">
    </td>
    <td>
        Sam, Walls
    </td>
</tr>
<tr class="show">
    <td colspan="2">
        This is the info about Sam.
    </td>
</tr>
<tr>
    <td>
        <input type="checkbox" class="toggle">
    </td>
    <td>
        John, Doe
    </td>
</tr>
<tr class="show">
    <td colspan="2">
        This is the info about John.
    </td>
</tr>
</table> 
```

当单击带有 class="toggle" 的复选框时，我只希望它下面的行出现。

我的 JavaScript 代码运行得不太好，如下所示：

```
$('.show').hide();
$('.toggle').click(function(){
    $('.show').slideToggle();
}); 
```

目前它只会隐藏和切换 Sam, Walls 行。

**编辑：使用类而不是 ID 后，隐藏问题似乎已经解决。但是，现在当我单击一个复选框时，两行会同时切换。我更新了上面的代码。**

任何帮助，将不胜感激！

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:59:27.743

我在评论中提到你不能有重复的 id，这也适用于你的`#show`元素。请改用该`next`功能，这样无论您按什么项目，下一个元素都会切换。就像是：

```
$('.show').hide();
$('.toggle').click(function(){
    $(this).closest('tr').next().slideToggle();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:11:38.153

您可以使用您的类并使用单击的索引进行切换...

```
$('.show').hide();
$('.toggle').click(function(){
    $('.show').eq($('.toggle').index(this)).slideToggle();
}); 
```

# ember.js - 添加/删除数据时如何在 Ember 中刷新模板？

> ID：14862930
> 
> 赞同：2
> 
> 时间：2013-02-13T20:54:33.650
> 
> 标签：ember.js, ember-data

我的 Ember 应用程序有一个简单的部分，它应该绘制一个书籍列表。问题是如果用户在从服务器加载书籍之前访问列表，则列表将为空。即使在数据加载完成后，列表仍然是空的。

加载数据后，Ember 必须通过哪些方法来刷新视图？放置此代码的合适位置在哪里？这是我的代码的样子：

路线：

```
App.MyRoute = Ember.Route.extend({
  model: function() {
    return App.store.find(App.Book); // get books from the server
  }
}); 
```

模板：

```
{{#each book in model}}
  <li {{ bindAttr data-book-id="book.id" }}>
    <span>{{ book.name }}</span>
  </li>
{{/each}} 
```

为了记录，我想做这样的事情：

```
{{#if model.get('isLoaded')}}
  {{#each book in model}}
    <li {{ bindAttr data-book-id="book.id" }}>
      <span>{{ book.name }}</span>
    </li>
  {{/each}}
{{else}}
   <span>Loading books...</span>
{{/#if}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:23:15.007

正如我在上面的评论中所说，`{{each}}`助手还有一个`{{else}}`你可以为你的列表添加一个微调器的地方，几乎就像你为单个项目做的那样。至于填充列表视图，您不必手动调用任何方法，因为框架负责填充`ModelArray`它给您的记录。如果即使它从您的后端 API 接收 JSON 也无法填充数据，那么问题一定出在您的存储/适配器/序列化器或 JSON 格式中。应该检查作为响应发送的服务器以及存储的设置方式（适配器/序列化器/等），以便正确地将 JSON 响应转换为 Ember-Data 期望的应用程序模型的有效数据。

# html - HTML 图像标签似乎有一些边距或填充

> ID：14862937
> 
> 赞同：2
> 
> 时间：2013-02-13T20:54:56.490
> 
> 标签：html

我目前正在开发一个新的投资组合网站，现在我处于开发阶段并开始解决一个问题。似乎所有图像标签底部的小边距或填充都有 4px 确切地说。我将所有边距和填充设置为 0，但这还没有解决。如何解决这个问题？

我喜欢收到你的来信。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:01:48.643

图像通常会与文本的基线垂直对齐，这会导致底部有一点间距。使用`vertical-align: middle`or`vertical-align: top`应该解决这个问题。

这是一个例子：http: [//jsfiddle.net/JgA5F/2/](http://jsfiddle.net/JgA5F/2/)

# c - 在开罗渲染周期性图像

> ID：14862943
> 
> 赞同：0
> 
> 时间：2013-02-13T20:55:06.470
> 
> 标签：c, gtk, cairo

我有一些绘图例程用于向用户呈现模拟的图形表示。这个模拟有周期性的边界条件（如果有东西离开顶部，它就会回到底部）。截至目前，该实现有效地将所有绘图选项作为`draw(x%WIDTH,y%HEIGHT)`，这或多或少都有效 - 如果我从`<width-1,y>`to画一条线`<width+1,y>`，这将变成一条穿过屏幕的线。我可以测试是否会触发周期性，并使用`move_to`而不是`line_to`，但这似乎效率低下，并且仅适用于多边形。

有没有办法将 cairo 切换到“周期性模式”，例如，我可以在画布顶部画一个从画布顶部延伸出来的圆圈，它会部分出现在底部？写入对象的实际坐标会非常好，而不是`MOD`每帧执行每个坐标。

先发制人：说“画两个圆圈，一个在底部，一个在顶部”不是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T08:20:45.100

不，没有这种模式。

可能对您有用也可能不适用的一件事是分配一个带有 Alpha 通道的表面，即两个方向上的尺寸都是两倍，然后以 WIDTH/HEIGHT 为模绘制所有内容，然后最后将四个子表面合成到您的真实表面上。

# html - Phonegap iFrame/页面缩放

> ID：14862948
> 
> 赞同：0
> 
> 时间：2013-02-13T20:55:23.723
> 
> 标签：html, cordova, viewport

我有一个在处理移动设备时使用以下代码的页面

```
<meta name="viewport" content="width=device-width, initial-scale=.7, maximum-scale=2, user-scalable=1"> 
```

在移动设备上的 Web 浏览器中查看此代码时效果很好。现在我正在尝试在`Phonegap`应用程序的 iframe 中创建一个具有相同页面的应用程序。但是，缩放/视口根本不起作用。不管我为缩放输入了多少数字，比例仍然是一样的。它不会改变。

我尝试这样做的原因是我的`Phonegap`应用程序通过两个 iframe 将同一`Phonegap`页面上的两个外部页面捆绑在一起，并且我需要能够同时查看两个页面而不会超出屏幕之外。

有人对我如何使用 iframe 使用/启用缩放有任何想法`Phonegap`吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T03:20:39.400

终于找到了答案。有人在`Phonegap` `Google`群里发了。这是他们的回应：

> 尝试将“EnableViewPortScale”设置为 true：[http ://docs.phonegap.com/en/2.4.0/guide_project-settings_ios_index.md.html#Project%20Settings%20for%20iOS](http://docs.phonegap.com/en/2.4.0/guide_project-settings_ios_index.md.html#Project%20Settings%20for%20iOS)

所以我将以下内容添加到我的 config.xml 文件中，它现在可以按照我的意愿进行缩放。唯一需要注意的是，您必须在视口上低于正常值`Phonegap`才能达到相同的效果。

```
<preference name="EnableViewportScale" value="true" /> 
```

# mongodb - 了解 Mongo Explain Index 扫描到许多结果

> ID：14862951
> 
> 赞同：3
> 
> 时间：2013-02-13T20:55:26.310
> 
> 标签：mongodb, optimization, indexing

我试图了解如何更好地为我看到的长查询运行的 Mongo 查询构建索引。

目前我看到这样的事情：

```
"cursor" : "BtreeCursor modTime_-1_color_1 multi",
"isMultiKey" : false,
"n" : 0,
"nscannedObjects" : 0,
"nscanned" : 104936,
"nscannedObjectsAllPlans" : 104935,
"nscannedAllPlans" : 314806,
"scanAndOrder" : false,
"indexOnly" : false,
"nYields" : 70,
"nChunkSkips" : 0,
"millis" : 14237,
"indexBounds" : {
    "modTime" : [
        [
            {
                "$maxElement" : 1
            },
            {
                "sec" : 1360267645,
                "usec" : 0
            }
        ]
    ],
    "color" : [
        [
            "Green",
            "Green"
        ],
        [
            "Blue",
            "Blue"
        ],
        [
            "Yellow",
            "Yellow"
        ]
    ]
}, 
```

查询如下：

```
{"modTime":{"$gte":{"sec":1360267645,"usec":0}},"color":{"$in":["Green","Blue","Yellow"]}} 
```

我应该做一些不同的事情来创建这个索引，这样它就不会扫描这么多结果吗？

提前感谢您的想法和建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T02:17:59.367

nscanned 计数是 modTime 大于提供的时间的文档总数。

如果颜色字段具有良好的可变性，那么您可能会从反转索引中受益，以便颜色是第一个字段，modTime 是第二个字段。

```
db.<collection>.createIndex( { color: 1, modTime : -1 } ) 
```

然后，这将仅扫描 modTime 大于提供的时间的正确颜色的文档数量。如果集合中唯一的颜色是绿色、蓝色、黄色，则没有任何好处。如果至少有一些额外的颜色，你应该会得到一些好处。

警告：如果您有只使用 modTime 的查询，那么他们将无法使用新索引。

另一个可能的解决方案是使用 $lt（或 $lte）表达式关闭 modTime 范围。您必须确定您的查询是否可以这样做，或者它是否会影响要评估的可能文档的数量。

# c# - 用于自我更新 WPF 应用程序的库

> ID：14862960
> 
> 赞同：3
> 
> 时间：2013-02-13T20:55:51.373
> 
> 标签：c#, .net, wpf, installation

寻找现有库以静默方式自我更新 wpf prism 应用程序，插件很容易更新，但通常安装在〜程序文件中的主 .exe 需要提升权限，这可以通过启动具有更高权限的更新程序 .exe 来解决

发现了一些与此类似的非常古老的问题

*   [.NET 的自动更新库？](https://stackoverflow.com/questions/691663/auto-update-library-for-net)
*   [需要写入 Program File 文件夹的自更新 .NET 客户端应用程序](https://stackoverflow.com/questions/524875/self-updating-net-client-application-which-needs-to-write-in-the-program-file-f)
*   [如何仅在需要时提升权限？](https://stackoverflow.com/questions/573086/how-to-elevate-privileges-only-when-required)

希望在推出我自己的之前有一些包可以处理小细节

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T22:50:28.130

[Shimmer](https://github.com/github/shimmer)提供了一种自动更新机制。

其他选项：

*   [点击一次](http://msdn.microsoft.com/en-us/library/s22azw1e.aspx)
*   [NApp更新](https://github.com/synhershko/NAppUpdate)
*   [AutoUpdaterDotNet](http://autoupdaterdotnet.codeplex.com/)

# javascript - 如何获取脚本的父 div？

> ID：14862963
> 
> 赞同：0
> 
> 时间：2013-02-13T20:55:57.543
> 
> 标签：javascript, html, dom

例如，

```
<body>
    <div id="cant_set_id" class="cant_set_class">
    </div>
    <div>
        <script id="cant_set_id">
            thisDivElement = // How to get a handle to this parent div
        </script>
    </div>
</body> 
```

我觉得我在这里缺少基本的 JavaScript 知识；但是，直到现在我才需要这个。当既没有 id 并且 div+script 可能位于 DOM 中的任何位置时，该 div 中的脚本如何获得该 div 的句柄？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:58:44.650

做这件事有很多种方法：

1.  在脚本标签上放置一个 id，然后查找该 id 及其父级。
2.  在脚本中使用`document.write()`from 编写一个具有已知 id 的 div，然后查找它。
3.  在文档中搜索脚本标签并找到具有适当`.src`属性的标签。
4.  由于脚本是按顺序解析/执行的（如果不是延迟或异步或动态插入），当前执行的脚本标签是文档中到目前为止的最后一个，所以如果你这样做`document.getElementsByTagName("script")`，当前执行的脚本标签将是最后一个在这个列表中。

选项 1 的示例：

```
<body>
    <div id="maybe_not" class="probably_not">
    </div>
    <div>
        <script id="myScript">
            var parentDiv = document.getElementById("myScript").parentNode;
        </script>
    </div>
</body> 
```

选项 1 的工作演示：http: [//jsfiddle.net/jfriend00/LCuNq/](http://jsfiddle.net/jfriend00/LCuNq/)

选项 2 的示例：

```
<body>
    <div id="maybe_not" class="probably_not">
    </div>
    <div>
        <script>
            document.write('<div id="myScriptDiv"></div>');
            var parentDiv = document.getElementById("myScriptDiv").parentNode;
        </script>
    </div>
</body> 
```

选项 2 的工作演示：http: [//jsfiddle.net/jfriend00/8YwYN/](http://jsfiddle.net/jfriend00/8YwYN/)

# python - 用python从文本中解析id

> ID：14862967
> 
> 赞同：2
> 
> 时间：2013-02-13T20:56:19.790
> 
> 标签：python, bioinformatics

我有这段文字：

```
>gi|124486857|ref|NP_001074751.1| inhibitor of Bruton tyrosine kinase [Mus musculus] >gi|341941060|sp|Q6ZPR6.3|IBTK_MOUSE RecName: Full=Inhibitor of Bruton tyrosine kinase; Short=IBtk >gi|148694536|gb|EDL26483.1| mCG128548, isoform CRA_d [Mus musculus] >gi|223460980|gb|AAI37799.1| Ibtk protein [Mus musculus] 
```

从此文本中，我想解析 |gb| 之后的 ID 并将其写在列表中。

我尝试使用正则表达式，但未能成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:00:15.327

在管道上拆分`|`，然后跳过所有内容，直到第一个`gb`；下一个元素是 ID：

```
from itertools import dropwhile

text = iter(text.split('|'))
next(dropwhile(lambda s: s != 'gb', text))
id = next(text) 
```

示范：

```
>>> text = '>gi|124486857|ref|NP_001074751.1| inhibitor of Bruton tyrosine kinase [Mus musculus] >gi|341941060|sp|Q6ZPR6.3|IBTK_MOUSE RecName: Full=Inhibitor of Bruton tyrosine kinase; Short=IBtk >gi|148694536|gb|EDL26483.1| mCG128548, isoform CRA_d [Mus musculus] >gi|223460980|gb|AAI37799.1| Ibtk protein [Mus musculus]'
>>> text = iter(text.split('|'))
>>> next(dropwhile(lambda s: s != 'gb', text))
'gb'
>>> id = next(text)
>>> id
'EDL26483.1' 
```

换句话说，不需要正则表达式。

将其变成生成器方法以获取所有 ID：

```
from itertools import dropwhile

def extract_ids(text):
    text = iter(text.split('|'))
    while True:
        next(dropwhile(lambda s: s != 'gb', text))
        yield next(text) 
```

这给出了：

```
>>> text = '>gi|124486857|ref|NP_001074751.1| inhibitor of Bruton tyrosine kinase [Mus musculus] >gi|341941060|sp|Q6ZPR6.3|IBTK_MOUSE RecName: Full=Inhibitor of Bruton tyrosine kinase; Short=IBtk >gi|148694536|gb|EDL26483.1| mCG128548, isoform CRA_d [Mus musculus] >gi|223460980|gb|AAI37799.1| Ibtk protein [Mus musculus]'
>>> list(extract_ids(text))
['EDL26483.1', 'AAI37799.1'] 
```

或者你可以在一个简单的循环中使用它：

```
for id in extract_ids(text):
    print id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T20:59:40.487

正则表达式应该工作

```
import re
re.findall('gb\|([^\|]*)\|', 'gb|AB1234|') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T21:03:35.520

在这种情况下，您可以不使用正则表达式，只需用“|gb|”分割，然后用“|”分割第二部分 并采取第一项：

```
s = 'the string from the question'
r = s.split('|gb|')
r.split('|')[0] 
```

当然，您必须添加检查第一个拆分返回列表是否包含更多/少于 2 个项目，但我认为它会比使用正则表达式更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T21:04:50.673

```
>>> import re
>>> match_object = re.findall("\|gb\|(.*?)\|", ">gi|124486857|ref|NP_001074751.1| inhibitor of Bruton tyrosine kinase [Mus musculus] >gi|341941060|sp|Q6ZPR6.3|IBTK_MOUSE RecName: Full=Inhibitor of Bruton tyrosine kinase; Short=IBtk >gi|148694536|gb|EDL26483.1| mCG128548, isoform CRA_d [Mus musculus] >gi|223460980|gb|AAI37799.1| Ibtk protein [Mus musculus]")
>>> print match_object
['EDL26483.1', 'AAI37799.1'] 
```

正则表达式表示“匹配任何字符 (.)，重复 (*)，但尽可能少 (?)，并且只保存该组（括号）。它们必须紧跟在 '|gb|' 之后 并紧接在另一个'|'之前。”

我用“\|” 因为“|” 字符表示正则表达式中的替代匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T21:01:38.833

```
In [1]: import re

In [2]: text = ">gi|124486857|ref|NP_001074751.1| inhibitor of Bruton tyrosine kinase [Mus musculus] >gi|341941060|sp|Q6ZPR6.3|IBTK_MOUSE RecName: Full=Inhibitor of Bruton tyrosine kinase; Short=IBtk >gi|148694536|gb|EDL26483.1| mCG128548, isoform CRA_d [Mus musculus] >gi|223460980|gb|AAI37799.1| Ibtk protein [Mus musculus]"

In [3]: re.findall(r'gb\|([^\|]+)', text)[0]
Out[3]: 'EDL26483.1' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-13T21:02:36.243

`re.findall('gi\|([0-9]+)\|', u'''>gi|124486857|ref|NP_001074751.1| inhibitor of Bruton tyrosine kinase [Mus musculus] >gi|341941060|sp|Q6ZPR6.3|IBTK_MOUSE RecName: Full=Inhibitor of Bruton tyrosine kinase; Short=IBtk >gi|148694536|gb|EDL26483.1| mCG128548, isoform CRA_d [Mus musculus] >gi|223460980|gb|AAI37799.1| Ibtk protein [Mus musculus]''')`为我工作： `[u'124486857', u'341941060', u'148694536', u'223460980']`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-13T21:10:27.997

假设`a`是保存你的字符串的变量......

```
>>> import re
>>> a = ">gi|124486857|ref|NP_001074751.1| ..."
>>> re.findall(r"(?:\|gb\|)([a-zA-Z0-9.]+)(?:\|)", a)
['EDL26483.1', 'AAI37799.1'] 
```

# mongodb - MogoDB 更新耗时超过 1 秒

> ID：14862968
> 
> 赞同：1
> 
> 时间：2013-02-13T20:56:27.573
> 
> 标签：mongodb

有一个非常简单的查询：

```
db.users.update({"_id" : ObjectId("50710913a6427bfa2600000c") },{$inc: {"points" : 5}}) 
```

“点”字段有一个索引：

```
db.users.getIndices()
[
    {
        "v" : 1,
        "key" : {
            "_id" : 1
        },
        "ns" : "od.users",
        "name" : "_id_"
    },
    {
        "v" : 1,
        "key" : {
            "points" : 1
        },
        "ns" : "od.users",
        "name" : "points"
    },
    {
        "v" : 1,
        "key" : {
            "lastActivity" : -1
        },
        "ns" : "od.users",
        "name" : "lastActivity"
    }
] 
```

为清楚起见，省略了一些索引。

我在 MongoDB 2.2.3、空闲数据库和快速机器（Amazon EC2 Hi I/O 实例）上运行查询，完成时间超过 1.7 秒...

```
> db.system.profile.find({ns:"od.users"}).sort({$natural:-1}).limit(1).pretty()
{
    "ts" : ISODate("2013-02-13T20:44:52.858Z"),
    "op" : "update",
    "ns" : "od.users",
    "query" : {
        "_id" : ObjectId("50710913a6427bfa2600000c")
    },
    "updateobj" : {
        "$inc" : {
            "points" : 5
        }
    },
    "nscanned" : 1,
    "nupdated" : 1,
    "keyUpdates" : 1,
    "numYield" : 0,
    "lockStats" : {
        "timeLockedMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(1747665)
        },
        "timeAcquiringMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(5964)
        }
    },
    "millis" : 1747,
    "client" : "127.0.0.1",
    "user" : ""
} 
```

删除索引后，查询立即完成：

```
> db.system.profile.find({ns:"od.users"}).sort({$natural:-1}).limit(1).pretty()
{
    "ts" : ISODate("2013-02-13T20:47:03.032Z"),
    "op" : "update",
    "ns" : "od.users",
    "query" : {
        "_id" : ObjectId("50710913a6427bfa2600000c")
    },
    "updateobj" : {
        "$inc" : {
            "points" : 5
        }
    },
    "idhack" : true,
    "nupdated" : 1,
    "keyUpdates" : 0,
    "numYield" : 0,
    "lockStats" : {
        "timeLockedMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(153)
        },
        "timeAcquiringMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(5)
        }
    },
    "millis" : 0,
    "client" : "127.0.0.1",
    "user" : ""
} 
```

Collection 有大约 71K 文件：

```
> db.users.stats()
{
    "ns" : "od.users",
    "count" : 71236,
    "size" : 2389260264,
    "avgObjSize" : 33540.06771856926,
    "storageSize" : 3987849216,
    "numExtents" : 20,
    "nindexes" : 23,
    "lastExtentSize" : 1039589376,
    "paddingFactor" : 1.0000000002382583,
    "systemFlags" : 1,
    "userFlags" : 0,
    "totalIndexSize" : 1120676144,
    "indexSizes" : {
        "_id_" : 3343984,
        "email" : 4578560,
        "country_1" : 2649024,
        "wPopularity" : 3278576,
        "wRandom" : 2869776,
        "wPhoto" : 2959712,
        "username_1" : 2657200,
        "tsRegistered" : 2976064,
        "likes.id" : 483610400,
        "dmForCnt_1" : 2861600,
        "wPopularity3" : 573660864,
        "tags" : 4611264,
        "status" : 3311280,
        "birthday" : 2959712,
        "gender" : 3008768,
        "points" : 2869776,
        "employee" : 2174816,
        "manualSubscription" : 2338336,
        "facebookID_1" : 3916304,
        "facebookID" : 4161584,
        "lastActivity" : 2796192,
        "isFraud" : 1537088,
        "settingsDailyMatch" : 1545264
    },
    "ok" : 1
} 
```

那是不是假设更新索引字段需要这么长时间？我错过了什么吗？

更新：

我注意到只有大于 100K 的文档才有这个问题。其他文档正在快速更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T09:07:32.947

响应缓慢是因为嵌入文档的索引：

```
> db.users.getIndices()
[
    {
        "v" : 1,
        "key" : {
            "likes.id" : 1
        },
        "ns" : "od.users",
        "name" : "likes.id"
    }
] 
```

带有 likes 属性的示例文档：

```
> obj = db.users.findOne({"_id" : ObjectId("50710913a6427bfa2600000c")})
> Object.bsonsize(obj)
532162
> obj.likes.length
4770
> obj.likes[0]
{
    "id" : "103128829727364",
    "name" : "Jennifer Lopez",
    "category" : "Musician/band",
    "hidden" : false,
} 
```

所以有 4770 个嵌入的 likes 文档，这些都在 likes.id 属性上被索引。

当我对此文档运行更新时，即使它没有触及喜欢的内容：

```
> db.users.update({"_id" : ObjectId("50710913a6427bfa2600000c") },{$addToSet: {"otherPhotos" : "holipiuouiouioiuoi1"}}) 
```

这需要很长时间：

```
> db.system.profile.find({op:"update"}).sort({ts:-1}).limit(1).pretty()
{
    "ts" : ISODate("2013-02-20T08:59:30.707Z"),
    "op" : "update",
    "ns" : "od.users",
    "query" : {
        "_id" : ObjectId("50710913a6427bfa2600000c")
    },
    "updateobj" : {
        "$addToSet" : {
            "otherPhotos" : "holipiuouiouioiuoi1"
        }
    },
    "idhack" : true,
    "nupdated" : 1,
    "keyUpdates" : 0,
    "numYield" : 0,
    "lockStats" : {
        "timeLockedMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(1752759)
        },
        "timeAcquiringMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(83)
        }
    },
    "millis" : 1752,
    "client" : "127.0.0.1",
    "user" : ""
} 
```

但是当我删除索引时，它的工作速度非常快：

```
> db.users.dropIndex("likes.id")
{ "nIndexesWas" : 2, "ok" : 1 }
> db.users.update({"_id" : ObjectId("50710913a6427bfa2600000c") },{$addToSet: {"otherPhotos" : "holipiuouiouioiuoi12hkjhkjhkjhkjhkjhkjhkj"}})
> db.system.profile.find({op:"update"}).sort({ts:-1}).limit(1).pretty()
{
    "ts" : ISODate("2013-02-20T09:02:13.747Z"),
    "op" : "update",
    "ns" : "od.users",
    "query" : {
        "_id" : ObjectId("50710913a6427bfa2600000c")
    },
    "updateobj" : {
        "$addToSet" : {
            "otherPhotos" : "holipiuouiouioiuoi12hkjhkjhkjhkjhkjhkjhkj"
        }
    },
    "idhack" : true,
    "nupdated" : 1,
    "keyUpdates" : 0,
    "numYield" : 0,
    "lockStats" : {
        "timeLockedMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(1137)
        },
        "timeAcquiringMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(5)
        }
    },
    "millis" : 1,
    "client" : "127.0.0.1",
    "user" : ""
} 
```

一旦删除了有问题的索引，我就可以在“点”上添加索引，原始查询响应时间现在只有 1 毫秒：

```
> db.users.ensureIndex({points:1})
> db.users.getIndices()
[
    {
        "v" : 1,
        "key" : {
            "_id" : 1
        },
        "ns" : "od.users",
        "name" : "_id_"
    },
    {
        "v" : 1,
        "key" : {
            "points" : 1
        },
        "ns" : "od.users",
        "name" : "points_1"
    }
]
> db.users.update({"_id" : ObjectId("50710913a6427bfa2600000c") },{$inc: {"points" : 5}})
> db.system.profile.find({op:"update"}).sort({ts:-1}).limit(1).pretty()
{
    "ts" : ISODate("2013-02-20T09:12:37.664Z"),
    "op" : "update",
    "ns" : "od.users",
    "query" : {
        "_id" : ObjectId("50710913a6427bfa2600000c")
    },
    "updateobj" : {
        "$inc" : {
            "points" : 5
        }
    },
    "nscanned" : 1,
    "nupdated" : 1,
    "keyUpdates" : 1,
    "numYield" : 0,
    "lockStats" : {
        "timeLockedMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(1225)
        },
        "timeAcquiringMicros" : {
            "r" : NumberLong(0),
            "w" : NumberLong(4)
        }
    },
    "millis" : 1,
    "client" : "127.0.0.1",
    "user" : ""
}
> 
```

因此，如果这个数组大小可能非常大，那么在 Mongo 中为嵌入文档数组添加索引似乎会显着降低更新性能。

# javascript - 在 casperjs 中出现错误作为这个你的“资源未找到”？

> ID：14862969
> 
> 赞同：0
> 
> 时间：2013-02-13T20:56:29.687
> 
> 标签：javascript, jasmine, phantomjs, casperjs

我正在尝试使用以下带有 casperjs 的咖啡脚本文件代码获取 url“ [https://stage.hiiro.co/auth/login ”的html](https://stage.hiiro.co/auth/login)

```
casper.start "https://stage.hiiro.co/auth/login", ->
  @echo @getHTML() 
```

它给了我找不到资源的错误，但此功能适用于我尝试访问的所有其他网址，例如[https://www.facebook.com/](https://www.facebook.com/)，[https://www.gmail.com/](https://www.gmail.com/)。

谁能猜出它为什么不起作用？

是的，网址“ [https://stage.hiiro.co/auth/login](https://stage.hiiro.co/auth/login) ”适用于浏览器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T08:50:49.157

您有此域的 SSL 错误。传递该`--ignore-ssl-errors=yes`选项可使您的脚本正常工作。

# ios - 启动特定的 viewController 以响应远程推送通知

> ID：14862970
> 
> 赞同：24
> 
> 时间：2013-02-13T20:56:38.417
> 
> 标签：ios, uiviewcontroller, push-notification, apple-push-notifications

我正在创建一个应用程序，其故事板流程如下图所示：

![故事板](../Images/0a3d3850ec391930609572ec10103482.png)

当用户从“Sysalert 视图控制器”登录时，他们会被带入“消息列表视图控制器”，我在其中执行 NSURLConnection 以将一些 JSON 加载到表中。当用户点击表格中的一行时，他们将进入“消息详细信息”，其中显示该消息的更详细信息。

当用户从推送通知启动应用程序时，无论启动前应用程序的状态如何，我都希望应用程序从我的服务器加载“消息列表”数据，然后向他们显示刚刚推送到设备的消息.

我知道我需要用来`didFinishLaunchingWithOptions`告诉应用程序对推送通知做出反应，但是如何设置视图层次结构，以便“消息列表”视图控制器加载其数据，然后将“消息详细信息”视图控制器推送到堆栈上适当的信息？

本质上，这种模仿消息或邮件应用程序的行为。打开通知会将您带到该消息的视图控制器，但您仍然可以在层次结构中移回，就好像您已从初始视图控制器启动应用程序并依次遍历视图控制器一样。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T21:25:35.940

可以按照您的描述进行操作，但我不建议您这样做。

首先，在情节提要中放置一个带有您想要的视图的断开连接的视图控制器，给视图控制器一个标识符，例如“我的推送通知视图”

在`didFinishLaunchingWithOptions:`中，您可以从应用委托访问 rootViewController。这个控制器将是导航控制器。使用导航控制器，您可以将新的视图控制器推送到堆栈顶部。要创建新的视图控制器，您需要使用标识符“My Push Notification View”来实例化视图控制器。

```
UINavigationController *navController = (UINavigationController *)self.window.rootViewController;
UIViewController *notificationController = [navController.storyboard instantiateViewControllerWithIdentifier:@"My Push Notification View"];

[navController pushViewController:notificationController animated:YES]; 
```

我想你会想要使用类似`-presentViewController:animated:completion:`显示模式视图的东西，而不是中断导航堆栈。

```
UIViewController *rootController = (UIViewController *)self.window.rootViewController;
UIViewController *notificationController = [rootController.storyboard instantiateViewControllerWithIdentifier:@"My Push Notification View"];

[rootController presentViewController:notificationController animated:YES completion:NULL]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-23T12:00:22.260

试试我在我的一个应用程序中使用的这个，将应用程序委托中的变量作为全局变量

```
 ex: BOOL gotNotifcation;

-(void)application:(UIApplication*)app didReceiveRemoteNotification:(NSDictionary *)userInfo
{
    NotificationsViewController *notificationobject = [[NotificationsViewController alloc]init];
    [self.navigationController pushViewController:notificationobject animated:YES];
    gotNotifcation = YES;   
} 
```

如果是自定义按钮，则在 NotificationsViewController 中进行后退按钮操作

```
-(void)gotoback
{
    AppDelegate *delegate =(AppDelegate *)[UIApplication sharedApplication].delegate;

    if(delegate.gotNotifcation)
    {
        delegate.gotNotifcation = NO;
        MessageListController *feed = [[MessageListController alloc] init];
        [self.navigationController pushViewController:feed animated:NO];
    }
    else
    {
        [self.navigationController popViewControllerAnimated:NO];
    }
} 
```

# ember.js - 如何在 Ember.js 中的控制器之间进行通信

> ID：14862973
> 
> 赞同：8
> 
> 时间：2013-02-13T20:56:58.790
> 
> 标签：ember.js

我想创建一个页面，在左侧我有固定视图（一些过滤器），这些视图应用于右侧的结果。

例如，左侧是按类型、标题、创作年份过滤电影的过滤器……右侧是不同的图表和表格，它们会根据所选的过滤器进行更新。

所以我想在左边有一个固定的视图，然后在右边有一个出口，它会根据路线而改变。

这是正确的方法吗？如果是，我不知道如何将过滤器更改传达给右侧的控制器。

这个 JSFiddle 显示了类似的设置：http: [//jsfiddle.net/DEHcK/2/](http://jsfiddle.net/DEHcK/2/)

在 ContentRoute -> setupController 中，我得到了 NavigationController 的一个实例，但是我不知道如何更改 someValue。

在上面的例子中，ContentController 是如何获取 NavigationController 中 someValue 的变化的呢？

这是实现我在 ember 中描述的应用程序的正确方法吗？

JavaScript：

```
 window.App = Ember.Application.create();

    App.Router.map(function () {
        this.route('content');
    });

    App.ContentRoute = Ember.Route.extend({
        setupController: function (controller) {
            controller.set('navigationController', this.controllerFor('navigation'));
        }
    });

    App.ContentController = Ember.ObjectController.extend({
        navigationController: null,
        observerOfSomeValue: function () {
            this.set('observedValue', this.get('navigationController.someValue'));
        }.observes('navigationController', 'navigationController.someValue'),
        observedValue: null
    });

    App.IndexRoute = Ember.Route.extend({
        redirect: function () {
            this.transitionTo('content');
        }
    });

    App.NavigationView = Ember.View.extend({
        init: function () {
            this._super();
            this.set('controller', this.get('parentView.controller').controllerFor('Navigation'));
        },
        templateName: "navigation"
    });

    App.NavigationController = Ember.ObjectController.extend({
        someValue: 'xx',
        observedValue: null,
        observerOfSomeValue: function () {
            this.set('observedValue', this.someValue);
        }.observes('someValue')
    }); 
```

HTML：

```
<script type="text/x-handlebars" data-template-name="application" >
    <div>
        {{view App.NavigationView}}
    </div>
    <div>
        {{ outlet }}
    </div>
</script>

<script type="text/x-handlebars" data-template-name="navigation" >
    Change {{view Ember.TextField valueBinding="controller.someValue"}}
    <div>observed value in same view: {{controller.observedValue}}</div>
</script>

<script type="text/x-handlebars" data-template-name="content" >
    <div style="margin-top: 2em">
        observed value in another view: {{observedValue}}
    </div>
</script> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-14T01:09:01.083

我已经继续[为您创建了一个 JSFiddle](http://jsfiddle.net/3kV6c/)，其中包含您所追求的基本实现。我认为值得一试，这样你就可以掌握 Ember。

**路由器**

我们只是`IndexRoute`在此时配置我们的存储所有歌曲的`{{outlet}}`.

```
App.IndexRoute = Ember.Route.extend({
    setupController: function(controller) {
        controller.set('content', [
            Ember.Object.create({ title: 'Stairway to Heaven', genre: 'Metal' }),
            Ember.Object.create({ title: 'Ratts of the Capital', genre: 'Post Rock' }),
            Ember.Object.create({ title: 'Wonderwall', genre: 'Brit Pop' }),
            Ember.Object.create({ title: 'Last Flowers', genre: 'Indie Rock' })
        ]);
    }
}); 
```

这段代码很有可能会被对后端 Ruby/PHP 的某种 AJAX 调用所取代。不过目前，我们将`IndexRoute`负责设置控制器（因此`setupController`）。这个责任也可以由控制器本身承担，并且抽象出 AJAX 调用可能是一个好主意，因为您将有许多类似的 AJAX 调用。

您也可以决定[使用 Ember 的 DataStore](https://github.com/emberjs/data)，这将再次更改控制器的实现。

**索引控制器**

接下来我们将设置我们的`IndexController`（这实际上是我们的`SongsController`），我们希望这个控制器有两个职责：

1.  存储歌曲（也可能从后端获取歌曲）；
2.  根据传入的过滤器过滤歌曲。

为此，我们创建了一个[计算属性](http://emberjs.com/guides/object-model/computed-properties/)来过滤掉内容，因为我们不想`content`直接实际操作特殊数组。

```
App.IndexController = Ember.ArrayController.extend({
    content: [],
    excludeGenres: [],

    filteredContent: function() {
        var excludeTheseGenres = this.get('excludeGenres').mapProperty('genre');
        return this.get('content').filter(function(model) {
            return Boolean(jQuery.inArray(model.get('genre'), excludeTheseGenres) === -1);
        });
    }.property('excludeGenres.length', 'content.length')
}); 
```

将`excludeGenres`采用一系列流派对象。例如，如果“Post Rock”包含在 中`excludeGenres`，那么我们将不会显示任何与“Post Rock”相关的歌曲，但如果它不存在，那么我们将显示它们！`IndexController`没有责任*维护*这个数组，但它确实有责任在*更新*这个数组时过滤它的内容。

**流派控制器**

也许是我们这个小应用程序中最令人困惑的控制器，因为它实际上并没有自己的任何内容，而是依赖于`IndexController`'s 的内容。

```
App.GenresController = Ember.ObjectController.extend({
    needs: ['index'],

    genres: function() {
        return this.get('controllers.index').mapProperty('genre').uniq();        
    }.property('controllers.index.length'),

    toggle: function(genreName) {
        var indexController     = this.get('controllers.index'),
            genres              = indexController.get('excludeGenres'),
            genre               = indexController.findProperty('genre', genreName);

        if (genres.findProperty('genre', genreName)) {
            genres.removeObject(genre);
            return;
        }

        genres.pushObject(genre);
    }
}); 
```

类型控制器的职责可以这样定义：

1.  监视`content`数组`IndexController`并在其长度更改时获取唯一的流派名称；
2.  `excludeGenres`当用户单击列表中的流派以包含/排除它时填充数组。

要`toggle`调用该方法，我们需要在我们的流派视图中指定一个动作以在单击时调用它：`<a {{action "toggle" genre}}>{{genre}}</a>`。现在，每当用户单击一个流派时，`toggle`都会调用该方法，并将流派名称作为第一个参数传递。

一旦我们进入该`toggle`方法，它将确定该类型是否已被排除在外。如果它被排除在外，那么它将被删除，反之亦然。一旦我们添加/删除了流派，`filteredContent`计算属性将再次被触发，并且索引视图将无缝更新。

`GenresController`实际上没有自己的内容的原因是`content`当两个数组有关系时管理两个数组似乎很愚蠢。由于可以从应用程序中存在的歌曲确定流派，因此控制器可以从该列表中收集信息，并仅提取所需的信息——在我们的例子中，流派。

这样，如果添加/删除一首歌曲，则流派列表可以保持同步。

**结论**

但是，我认为您最初问题的答案是，为了让控制器相互通信，您需要指定它**需要**什么（使用`needs`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-07T10:48:18.853

`needs`用于 Ember 控制器已被弃用，并在 Ember 2.0 中被删除——看看它的[弃用指南](http://emberjs.com/deprecations/v1.x/#toc_controller-needs)。

要在此处复制/粘贴指南，而不是编写：

```
Ember.Controller.extend({
  needs: ['comments'],
  newComments: Ember.computed.alias('controllers.comments.newest')
}); 
```

你应该写：

```
Ember.Controller.extend({
  comments: Ember.inject.controller(),
  newComments: Ember.computed.alias('comments.newest')
}); 
```

`Ember.inject.controller()`将懒惰地查找与分配给它的键同名的控制器——在这种情况下，`comments`控制器。有关更多信息，请参阅[API 文档](http://emberjs.com/api/classes/Ember.inject.html#method_controller)。

# php - 以字符串形式访问 SimpleXML 节点值

> ID：14862977
> 
> 赞同：0
> 
> 时间：2013-02-13T20:57:31.137
> 
> 标签：php, simplexml

我有一个名为 $picasa_feed 的对象，如下所示：

```
SimpleXMLElement Object
(
    [guid] => https://picasaweb.google.com/data/entry/base/user/0000000000000000/albumid/0000000000000000?alt=rss&hl=en_US
    [pubDate] => Fri, 12 Dec 2008 20:00:00 +0000
    [category] => http://schemas.google.com/photos/2007#album
    [title] => My Pictures
    [description] => ...
    [link] => https://picasaweb.google.com/0000000000000000/MyAlbum
    [author] => Me
) 
```

我想将属性值放入关联数组的元素中：

```
$data_to_save['title'] = $picasa_feed->title; 
```

当我这样做时， $data_to_save 的值是

```
Array
(
    [title] => SimpleXMLElement Object
        (
            [0] => My Pictures
        )
} 
```

我想要的是

```
Array
(
    [title] => My Pictures
} 
```

我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:00:45.197

将其转换为字符串：

```
$data_to_save['title'] = (string) $picasa_feed->title; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:00:43.030

您想通过将 SimpleXMLElement`__toString`转换为字符串来调用它的魔法方法。尝试：`$data_to_save['title'] = (string)$picasa_feed->title;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:02:58.393

这应该有效：

```
$data_to_save['title'] = (string) $picasa_feed->title; 
```

# excel - 处理完成后，Excel 宏未关闭 CSV 文件

> ID：14862982
> 
> 赞同：0
> 
> 时间：2013-02-13T20:57:48.133
> 
> 标签：excel, vba

我正在运行以下脚本，它似乎没有关闭并且脚本运行时的文件。如何编辑脚本以便它可以关闭脚本。

```
Sub LoopFiles()

    Dim MyFileName As String, MyPath As String

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    MyPath = "C:\macro\"

    MyFileName = Dir(MyPath & "*.xlsx")

    ChDir "C:\macro\csv"

    Do Until MyFileName = ""
        Workbooks.Open Filename:=MyPath & MyFileName
        ActiveWorkbook.SaveAs Filename:=Left(MyFileName, InStr(1, MyFileName, ".xlsx") - 1), FileFormat:=xlCSV, CreateBackup:=False
        MyFileName = Dir
    Loop

    Application.ScreenUpdating = True
    Application.DisplayAlerts = True

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:00:42.520

添加这一行：`ActiveWorkbook.Close False`

在我下面演示的空间中。

```
Do Until MyFileName = ""
        Workbooks.Open Filename:=MyPath & MyFileName
        ActiveWorkbook.SaveAs Filename:=Left(MyFileName, InStr(1, MyFileName, ".xlsx") - 1), FileFormat:=xlCSV, CreateBackup:=False
        ActiveWorkbook.Close False
        MyFileName = Dir
Loop 
```

或者对于更清洁的版本，请执行以下操作：

```
Dim wkb as Workbook

Do Until MyFileName = ""
   Set wkb = Workbooks.Open(Filename:=MyPath & MyFileName)
   With wkb
       .SaveAs Filename:=Left(MyFileName, InStr(1, MyFileName, ".xlsx") - 1), FileFormat:=xlCSV, CreateBackup:=False
       .Close False
   End With
Loop 
```

# c# - 如何通过共享魅力的协议激活来激活应用程序

> ID：14862983
> 
> 赞同：1
> 
> 时间：2013-02-13T20:57:48.243
> 
> 标签：c#, xaml, windows-8, windows-store-apps

我正在尝试从其自己的股票合同激活我的应用程序（请 - 不要评论从认证的角度来看这是否可以这样做......应用程序激活是通过股票合同 UI 上的按钮完成的除非用户主动，否则不会发生。我在这里问的是技术问题，而不是用户体验方面的问题-谢谢！！）

我的设置方式是这样的：

```
this.m_shareOperation.ReportStarted();

// ....

this.m_shareOperation.ReportCompleted();

await Launcher.LaunchUriAsync(new Uri("se-myapp:///something")); 
```

一切似乎工作正常 - 激活事件/覆盖触发，应用程序实际激活并显示，但是，在我的 OnActivated 代码完成后，出现以下错误：

```
The operation cannot be completed because the window is being closed. (Exception from HRESULT: 0x802A0201) 
```

我能做些什么来完成这项工作？任何想法？

这个出现的调用堆栈是这个（没有用户代码，不被 UnhandledException 事件处理）......

> mscorlib.dll!System.Threading.Tasks.AwaitTaskContinuation.ThrowAsyncIfNecessary.AnonymousMethod__1(object s) + 0x33 bytes mscorlib.dll!System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(object state) + 0x3e bytes mscorlib.dll!System.Threading.ExecutionContext。 RunInternal(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback 回调, 对象状态, bool preserveSyncCtx) + 0xa7 字节 mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback 回调, 对象状态, bool preserveSyncCtx) + 0x16 字节 mscorlib.dll!System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem() + 0x60 字节 mscorlib.dll!System.Threading.ThreadPoolWorkQueue。Dispatch() + 0x149 字节 mscorlib.dll!System.Threading._ThreadPoolWaitCallback.PerformWaitCallback() + 0x5 字节 [原生到托管转换]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T19:59:56.137

解决方案相当简单，虽然有点老派（尽管 WinRT 完全支持）......

第 0 步：定义要在应用中使用的命名事件：

```
public static EventWaitHandle GetActivationEvent()
{
    EventWaitHandle sync = new EventWaitHandle(false, EventResetMode.ManualReset, Constants.ActivationEventName);
    return sync;
} 
```

第 1 步：在 OnActivate() 覆盖中，获取该事件并设置它：

```
using (var sync = Utils.GetActivationEvent())
{
    sync.Set();
} 
```

第 2 步：从共享目标中，通过以下方式激活自己：

```
using (EventWaitHandle sync = Utils.GetActivationEvent())
{
    await Launcher.LaunchUriAsync(new Uri(String.Format("my-protocol:///?id={0}&operation={1}", id, op)));
    await Task.Run(() => sync.WaitOne(5000));
    this.m_shareOperation.ReportCompleted();
} 
```

而已。这将确保 Windows 不会对应用程序同时关闭和打开感到困惑和抱怨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T19:32:16.600

你不能。

不幸的是，你试图混合不应该混合的东西。如果您为您的应用创建自定义协议激活，则调用包含该协议的 uri 将启动您的应用。分享魅力只会激活具有分享目标合同的应用程序。没有例外。

这是有关协议激活的更多信息。您可能会发现它很有用：http: [//blog.jerrynixon.com/2012/10/walkthrough-using-windows-8-custom.html](http://blog.jerrynixon.com/2012/10/walkthrough-using-windows-8-custom.html)

# javascript - 如何删除动态添加的元素？

> ID：14862988
> 
> 赞同：0
> 
> 时间：2013-02-13T20:58:12.313
> 
> 标签：javascript, jquery, html

我有这段代码，它在文本框下方添加了动态 div，但我想在用户删除字符后将其删除：

下面的代码不起作用，我看不出我做错了什么

[小提琴的代码](http://jsfiddle.net/tYZZV/1/)

请参见下面的代码：

```
 $(document).ready(function () {

        $("#searchcontent").keypress(function (e) {
            var dvSearch = $('<div />');
            dvSearch.attr('dvSearch', '1');

            if ($("#searchcontent").val().length >= 2) {
                var pos = $(this).position();
                dvSearch.html("<div>ffff:<div><div>eeee:<div><div>ggggg:<div>").css({
                    top: pos.top + $(this).height() + 18,
                    left: pos.left,
                    width: '300px',
                    position: 'absolute',
                    'background-color': 'Yellow'
                }).insertAfter($(this));
            }
            else {
                $("div[dvSearch='1']").remove();
            }
        });

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:18:19.823

我建议简单地准备一个容器来接收 HTML 中的结果内容。然后，您可以通过在此处添加结果或清空该容器来减少问题。在您的原始代码中，您不断地在每个事件上添加`div`元素。`keypress`

此外，正如其他人所提到的，您将希望使用`.keyup()`而不是`.keypress()`确保在事件触发时输入的值是正确的。

**HTML**

```
<input type="text" id="searchcontent" name="searchcontent" class="txtSearch" maxlength="30" />
<div id="searchresult"></div> 
```

**JS**

```
$(document).ready(function() {
    $("#searchcontent").keyup(function(e) {
        if ($("#searchcontent").val().length >= 2) {
            var pos = $(this).position();
            $("#searchresult").html("<div>ffff:<div><div>eeee:<div><div>ggggg:<div>");
        }
        else {
            $("#searchresult").empty();
        }
    });
}); 
```

[jsfiddle](http://jsfiddle.net/cCurK/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:07:28.073

问题是 keypress 在实际值更新之前运行。因此，如果文本框显示“hi”并且您按退格键，则选择的值仍然是“hi”。

改变

```
$("#searchcontent").keypress(function(e){ 
```

到

```
$("#searchcontent").keyup(function(e){ 
```

它解决了这个问题。

[更新了 JS Fiddle](http://jsfiddle.net/tYZZV/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:08:01.233

问题是按下退格键时 .keypress() 不会触发。使用 .keyup() 代替。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:09:01.667

总是为 html 运行选择器不是一个好方法。尤其是全球性的。保存到节点的链接并通过它删除它

```
$(document).ready(function () {
   $("#searchcontent").keyup(function (e) {
        var el = $(this),
            // getting link
            dvSearch  = el.data("searchBlock"),
            // getting passed state
            dvPassed = el.data("searchPassed"),
            pos;

        // setting if first run
        if (!dvSearch) {
            dvSearch = $("<div/>");
            // for what is it ?
            dvSearch.attr('dvSearch', '1'); 

            el.data("searchBlock", dvSearch);
            el.data("searchPassed", false);
        }

        if (el.val().length >= 2) {
            pos = el.position();

            // Inserting element if need
            if (!dvPassed) {
                dvSearch.insertAfter(el);
                el.data("searchPassed", true);
            }

            // setting html
            dvSearch.html("<div>ffff:<div><div>eeee:<div><div>ggggg:<div>").css({
                top: pos.top + el.height() + 18,
                left: pos.left,
                width: '300px',
                position: 'absolute',
                'background-color': 'Yellow'
            });
        }
        else {
            dvSearch.remove();
            el.data("searchPassed", false);
        }
    });

}); 
```

# ios - 如何通过外观协议设置 UIBarButtonItem 的 tintColor？

> ID：14862991
> 
> 赞同：4
> 
> 时间：2013-02-13T20:58:33.467
> 
> 标签：ios, objective-c, uibarbuttonitem, uiappearance

我正在尝试在整个项目中以编程方式设置`tintColor`for 。`UIBarButtonItems`我打电话给：

`[UIBarButtonItem appearance]`

但是，在这里查看 Apple 的文档后：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIBarButtonItem_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIBarButtonItem_Class/Reference/Reference.html)

我发现没有这样的属性来设置`tintColor`. 我能找到的最接近的相关方法是：

```
setBackgroundImage:forState:barMetrics:
setBackgroundImage:forState:style:barMetrics: 
```

但是，这两种方法都用于设置实际的背景图像。不能简单地设置按钮的`tintColor`via`UIAppearance`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T21:53:16.153

也许我没有正确理解这个问题。但是，如果您查看您发布的链接，在任务 -> 自定义外观下，有一个名为 tintColor 的属性。

您只需将该属性设置为所需的颜色

```
[[UIBarButtonItem appearance] setTintColor:[UIColor redColor]]; 
```

这不适合你吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T22:47:50.597

根据`UIAppearance`协议，您可以设置`tintColor`如下：

> 要自定义包含在容器类实例或层次结构中的实例中的类实例的外观，您可以使用`appearanceWhenContainedIn:`获取类的外观代理

```
[[UIBarButtonItem appearanceWhenContainedIn:[UINavigationBar class], nil]
       setTintColor:myNavBarColor]; 
```

如果这就是您要找的，[这里](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIAppearance)提到了这一点。

# bash - Grep- 搜索 exiftool 输出以查找不同的匹配项

> ID：14862993
> 
> 赞同：0
> 
> 时间：2013-02-13T20:58:42.470
> 
> 标签：bash, grep, exiftool

我有一个大文件夹树，并想制作一个脚本来打开 gThumb 或基于关键字搜索的其他图像查看器。 `exiftool`已经安装在我的系统上。和命令

```
exiftool -a -r -G1 -s $FILE 
```

以格式打印数据

```
[ExifTool]      ExifToolVersion                 : 8.60
[System]        FileName                        : 4-4_wlax_0127.jpg
[System]        Directory                       : .
[System]        FileSize                        : 6.3 MB
[System]        FileModifyDate                  : 2012:04:05 13:57:54-04:00
[System]        FilePermissions                 : rwxrwxrwx 
```

目前，

```
exiftool -a -r -G1 -s . | grep Keywords | grep "$1*" 
```

将元数据的关键字行打印为

```
[IPTC]          Keywords                        : 2012, Womens Lax, ..., ... 
```

`$1`关键字搜索值在哪里。现在，我的解决方案是使用两个循环，每个循环`exiftool`对不同的 grep 值执行调用。如何执行单个`exiftool`调用以匹配关键字，将关联的文件名传递给列表。

编辑-澄清：

如果关键字字段存在匹配项，我想打印出 FileName 行。但是，在文本输出中，关键字存在于 FileName 下方约 20 行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:35:30.203

只需使用[awk](/questions/tagged/awk "显示标记为“awk”的问题")，而不是所有那些管道！

```
% exiftool -a -r -G1 -s . | awk -v search='your search string here' '
    $2 ~ /FileName/ { filename = $0 }
    $2 ~ /Keywords/ && $0 ~ search { print filename }
' 
```

这假定对于每个处理的文件`Filename`总是出现在之前。`Keywords`如果您有多个要搜索的字符串，只需用管道分隔它们（这是一个正则表达式！）：

```
% exiftool -a -r -G1 -s . | awk -v search='first|second' '
    $2 ~ /FileName/ { filename = $0 }
    $2 ~ /Keywords/ && $0 ~ search { print filename }
' 
```

如果您*只*想要文件名（而不是整行），也许这是一个更简洁的解决方案：

```
% exiftool -a -r -G1 -s . | awk -F': ' -v search='first|second|third' '
    $1 ~ /FileName/ { filename = $2 }
    $1 ~ /Keywords/ && $2 ~ search { print filename }
' 
```

当然，您也可以在同一个程序中完成所有文本处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T13:26:50.947

使用 exiftool -if 选项：

exiftool -filename -s3 -if '$keywords=~/some keyword/' 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T21:03:38.453

如果我正确理解您的问题，您有多个要过滤的关键字。使用`egrep`和 -`|`运算符：

```
exiftool -a -r -G1 -s . | grep Keywords | egrep "$1|$2" 
```

而 $1 是第一个关键字， $2 是第二个关键字。`egrep`可以替换`grep -E`为`egrep`已弃用的 as 。

编辑（在问题实际改变之后）：你应该提出一个新问题。

您可以对所有文件进行循环，如果文件与您使用的关键字之一匹配。例如：

```
for n in `ls`; do
    c=`exiftool -a -G1 -s $n | grep Keywords | egrep "$1|$2" | wc -l`
    if [ $c -gt 0 ]; then
         echo $n has matched
    fi
done 
```

# php - 关于从网站导出图像为 JPG 和/或 PDF 的库或想法

> ID：14862997
> 
> 赞同：0
> 
> 时间：2013-02-13T20:59:10.070
> 
> 标签：php

我有一个从数据库数据生成 BMP 图像文件（图形）的网站。我想让用户能够将图像（图形）下载为 JPG 和 PDF 文件。每个链接一个。这个网站是用 PHP 完成的。

我尝试过使用 FPDF，但是它不喜欢 BMP 文件。

我的图片网址如下所示：**chart.php?act=img&t=use&fy=2010&rt=Propane&mo=October**没有 .bmp，但是，当您右键单击另存为...时，这是您唯一的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:13:30.733

FPDF 是生成 PDF 的好方法，它当然可以处理添加到文档中的 JPG 图像。这意味着剩下的唯一任务是将这些 BMP 转换为 JPG（或其他格式）。

我在这个问题上的第一个方法是质疑底层格式：为什么图表需要是 BMP 开始？这种格式对网络不太友好，因此首先在 BMP 中生成图形会产生一个问题，您将不得不一次又一次地处理。首先为什么要这样做？找到一种生成图表的方法，为您提供一些有用的东西。

假设您别无选择，只能在 BMP 中生成图形，下一条路线是考虑将这些 BMP 转换为一些有用的格式。在手册页上，评论者提供了一个我自己测试和使用过`imagecreate`的示例函数（包含在此答案的末尾）。`ImageCreateFromBMP`这会将您的图表转换为实际有用的文件格式，然后您可以将文件写入磁盘、将其添加到 PDF 或提供下载。

**文档和相关阅读**

*   PHP `imagecreate`（此答案中的代码源） - [http://php.net/manual/en/function.imagecreate.php](http://php.net/manual/en/function.imagecreate.php)
*   `FPDF::Image`- [http://www.fpdf.org/en/doc/image.htm](http://www.fpdf.org/en/doc/image.htm)
*   pChart，一个不会创建无用 BMP 图像的 PHP 图表库 - [http://pchart.sourceforge.net/](http://pchart.sourceforge.net/)
*   JpGraph，另一个无用的 PHP 图表库 - [http://jpgraph.net/](http://jpgraph.net/)
*   Highcharts，交互式 javascript 图表，将 PHP 渲染的图表从水中吹走 - [http://www.highcharts.com/](http://www.highcharts.com/)

*代码信用：DHKold 检索自：[http](http://php.net/manual/en/function.imagecreate.php) ://php.net/manual/en/function.imagecreate.php于：2013 年 2 月 13 日*

```
<?php
/*********************************************/
/* Fonction: ImageCreateFromBMP              */
/* Author:   DHKold                          */
/* Contact:  admin@dhkold.com                */
/* Date:     The 15th of June 2005           */
/* Version:  2.0B                            */
/*********************************************/

function ImageCreateFromBMP($filename)
{
 //Ouverture du fichier en mode binaire
   if (! $f1 = fopen($filename,"rb")) return FALSE;

 //1 : Chargement des ent�tes FICHIER
   $FILE = unpack("vfile_type/Vfile_size/Vreserved/Vbitmap_offset", fread($f1,14));
   if ($FILE['file_type'] != 19778) return FALSE;

 //2 : Chargement des ent�tes BMP
   $BMP = unpack('Vheader_size/Vwidth/Vheight/vplanes/vbits_per_pixel'.
                 '/Vcompression/Vsize_bitmap/Vhoriz_resolution'.
                 '/Vvert_resolution/Vcolors_used/Vcolors_important', fread($f1,40));
   $BMP['colors'] = pow(2,$BMP['bits_per_pixel']);
   if ($BMP['size_bitmap'] == 0) $BMP['size_bitmap'] = $FILE['file_size'] - $FILE['bitmap_offset'];
   $BMP['bytes_per_pixel'] = $BMP['bits_per_pixel']/8;
   $BMP['bytes_per_pixel2'] = ceil($BMP['bytes_per_pixel']);
   $BMP['decal'] = ($BMP['width']*$BMP['bytes_per_pixel']/4);
   $BMP['decal'] -= floor($BMP['width']*$BMP['bytes_per_pixel']/4);
   $BMP['decal'] = 4-(4*$BMP['decal']);
   if ($BMP['decal'] == 4) $BMP['decal'] = 0;

 //3 : Chargement des couleurs de la palette
   $PALETTE = array();
   if ($BMP['colors'] < 16777216)
   {
    $PALETTE = unpack('V'.$BMP['colors'], fread($f1,$BMP['colors']*4));
   }

 //4 : Cr�ation de l'image
   $IMG = fread($f1,$BMP['size_bitmap']);
   $VIDE = chr(0);

   $res = imagecreatetruecolor($BMP['width'],$BMP['height']);
   $P = 0;
   $Y = $BMP['height']-1;
   while ($Y >= 0)
   {
    $X=0;
    while ($X < $BMP['width'])
    {
     if ($BMP['bits_per_pixel'] == 24)
        $COLOR = unpack("V",substr($IMG,$P,3).$VIDE);
     elseif ($BMP['bits_per_pixel'] == 16)
     { 
        $COLOR = unpack("n",substr($IMG,$P,2));
        $COLOR[1] = $PALETTE[$COLOR[1]+1];
     }
     elseif ($BMP['bits_per_pixel'] == 8)
     { 
        $COLOR = unpack("n",$VIDE.substr($IMG,$P,1));
        $COLOR[1] = $PALETTE[$COLOR[1]+1];
     }
     elseif ($BMP['bits_per_pixel'] == 4)
     {
        $COLOR = unpack("n",$VIDE.substr($IMG,floor($P),1));
        if (($P*2)%2 == 0) $COLOR[1] = ($COLOR[1] >> 4) ; else $COLOR[1] = ($COLOR[1] & 0x0F);
        $COLOR[1] = $PALETTE[$COLOR[1]+1];
     }
     elseif ($BMP['bits_per_pixel'] == 1)
     {
        $COLOR = unpack("n",$VIDE.substr($IMG,floor($P),1));
        if     (($P*8)%8 == 0) $COLOR[1] =  $COLOR[1]        >>7;
        elseif (($P*8)%8 == 1) $COLOR[1] = ($COLOR[1] & 0x40)>>6;
        elseif (($P*8)%8 == 2) $COLOR[1] = ($COLOR[1] & 0x20)>>5;
        elseif (($P*8)%8 == 3) $COLOR[1] = ($COLOR[1] & 0x10)>>4;
        elseif (($P*8)%8 == 4) $COLOR[1] = ($COLOR[1] & 0x8)>>3;
        elseif (($P*8)%8 == 5) $COLOR[1] = ($COLOR[1] & 0x4)>>2;
        elseif (($P*8)%8 == 6) $COLOR[1] = ($COLOR[1] & 0x2)>>1;
        elseif (($P*8)%8 == 7) $COLOR[1] = ($COLOR[1] & 0x1);
        $COLOR[1] = $PALETTE[$COLOR[1]+1];
     }
     else
        return FALSE;
     imagesetpixel($res,$X,$Y,$COLOR[1]);
     $X++;
     $P += $BMP['bytes_per_pixel'];
    }
    $Y--;
    $P+=$BMP['decal'];
   }

 //Fermeture du fichier
   fclose($f1);

 return $res;
}
?> 
```