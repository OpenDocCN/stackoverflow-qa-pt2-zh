# StackOverflow 问答 13782000-13782999

# javascript - 在使用 jquery mobile changePage 函数加载的页面上运行 Javascript 时需要帮助

> ID：13782006
> 
> 赞同：0
> 
> 时间：2012-12-08T21:14:15.437
> 
> 标签：javascript, jquery, jquery-mobile

嘿，我使用以下功能使用 Jquery mobile 加载页面

```
$.mobile.changePage( "http://localbhost:8080/Chat.htm", { transition: "slideup"} ); 
```

在加载的页面 Chat.htm 上，我试图调用一些 javascript 但它不起作用。我正在尝试使用下面的代码来执行一些 JS。我还尝试了 pageload、pageinit 和 pagecreate，但它们都不起作用。我也试过

```
$(function(){ 
// code 
});

jQuery(document).live('pagebeforeload',function(event){
// code to execute
} 
```

那么 JQM 中是否有一些事件可以捕获页面转换事件，或者我可以通过其他方式在新加载的页面上调用 JS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:55:25.780

它不是那样工作的。默认情况下，JQueryMobile 将通过 AJAX 获取您的页面并将其插入到 dom 中。加载页面上的任何 JS 都不会被解析。你想监听`pageshow`事件并将你的代码放在那里。例子：

```
$(document).on('pageshow', function (event) {
   ..your code here.. 
```

有关更多信息，请参见：

[http://jquerymobile.com/demos/1.2.0/docs/pages/page-navmodel.html](http://jquerymobile.com/demos/1.2.0/docs/pages/page-navmodel.html)

# ios - 如何在 NSMutableURLRequest 上发出第二个请求？

> ID：13782008
> 
> 赞同：0
> 
> 时间：2012-12-08T21:14:38.587
> 
> 标签：ios, objective-c, iphone

我正在尝试使用 NSMutableURLRequest 与会话建立连接。我正在开始从它接收数据的第一个请求。但我不能提出第二个要求。如何使用相同的 cookie 发出第二个请求？

更新源代码：

```
NSHTTPURLResponse   * response;
NSError             * error;
NSMutableURLRequest * request;
request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"https://loginsite"]
                                        cachePolicy:NSURLRequestReloadIgnoringCacheData
                                    timeoutInterval:60];
NSString *post = [NSString stringWithFormat:@"userid=%@&pass=%@",self.userName.text, self.password.text];
NSData *postData = [post dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
[request setValue:[NSString stringWithFormat:@"%d", [postData length]] forHTTPHeaderField:@"Content-Length"];
[request setHTTPMethod:@"POST"];
[request setHTTPBody:postData];

[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

self.urlConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
[self.urlConnection start]; 
```

它提出了第一个请求，但我怎样才能提出第二个请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:28:30.647

Cookies 是 HTTP 的东西，所以我假设我们正在谈论它。
当 1\. 请求成功时，您会得到一个 NSURLResponse，它是一个 HTTPURLResponse，其标头可以解析为 cookie：

```
NSArray *cookies = [NSHTTPCookie cookiesWithResponseHeaderFields:headers forURL:[self url]]]; 
```

然后可以将这些 cookie 与 2\. 请求一起使用...

```
NSDictionary * headers = [NSHTTPCookie requestHeaderFieldsWithCookies:cookies];
[request setAllHTTPHeaderFields:headers]; 
```

# c# - 使用 HtmlAgilityPack 获取 html img 元素的宽度

> ID：13782009
> 
> 赞同：0
> 
> 时间：2012-12-08T21:14:49.317
> 
> 标签：c#, asp.net, html-agility-pack

我正在尝试使用 HtmlAgility 包获取 img 标签的值，例如...

```
 HtmlAgilityPack.HtmlAttribute width = link.Attributes["width"];
          HtmlAgilityPack.HtmlAttribute height = link.Attributes["height"]; 
```

但这会返回 50px。但是，我只需要 50 即可转换为数字。请任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T21:16:16.810

对你不`int.Parse(value.Replace("px", string.Empty))`罚款吗？如果有`px`后缀，它会在解析之前消失，如果没有，那很酷，我们可以直接解析为整数。

# c - 如何在 CUDA/cublas 中转置矩阵？

> ID：13782012
> 
> 赞同：5
> 
> 时间：2012-12-08T21:15:10.557
> 
> 标签：c, parallel-processing, cuda, gpu, cublas

`A*B`假设我在 GPU 上有一个维度为的矩阵，其中`B`（列数）是假设 C 样式的前导维度。CUDA（或 cublas）中是否有任何方法可以将此矩阵转置为 FORTRAN 样式，其中`A`（行数）成为前导维度？

如果可以在传输过程中进行转置，`host->device`同时保持原始数据不变，那就更好了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T17:21:22.213

如标题中所要求的，要转置设备行主矩阵 A[m][n]，可以这样做：

```
 float* clone = ...;//copy content of A to clone
    float const alpha(1.0);
    float const beta(0.0);
    cublasHandle_t handle;
    cublasCreate(&handle);
    cublasSgeam( handle, CUBLAS_OP_T, CUBLAS_OP_N, m, n, &alpha, clone, n, &beta, clone, m, A, m );
    cublasDestroy(handle); 
```

并且，将两个行优先矩阵 A[m][k] B[k][n] 相乘，C=A*B

```
 cublasSgemm( handle, CUBLAS_OP_N, CUBLAS_OP_N, n, m, k, &alpha, B, n, A, k, &beta, C, n ); 
```

其中 C 也是一个行优先矩阵。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T03:45:24.610

CUDA SDK 包含一个[矩阵转置](http://www.nvidia.com/content/cudazone/cuda_sdk/Linear_Algebra.html)，您可以[在此处](http://www.cs.colostate.edu/~cs675/MatrixTranspose.pdf)查看有关如何实现的代码示例，从简单的实现到优化的版本。

例如：

**天真的转置**

```
__global__ void transposeNaive(float *odata, float* idata,
int width, int height, int nreps)
{
    int xIndex = blockIdx.x*TILE_DIM + threadIdx.x;
    int yIndex = blockIdx.y*TILE_DIM + threadIdx.y;
    int index_in = xIndex + width * yIndex;
    int index_out = yIndex + height * xIndex;

    for (int r=0; r < nreps; r++)
    {
        for (int i=0; i<TILE_DIM; i+=BLOCK_ROWS)
        {
          odata[index_out+i] = idata[index_in+i*width];
        }
    }
} 
```

就像 talonmies 指出的那样，您可以在 cublas 矩阵运算中指定是否要转置矩阵，例如：对于 cublasDgemm() where C = a * op(A) * op(B) + b * C，假设您想将 A 操作为转置 (A^T)，在参数上您可以指定它是 ('N' normal or 'T' transposed)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-13T07:39:04.267

与 CUDA 5 工具包捆绑的 CUBLAS 版本包含可用于转置矩阵的类似 BLAS 的方法 (cublasgeam)。它记录[在这里](http://docs.nvidia.com/cuda/cublas/index.html#topic_9_1)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-13T23:56:53.497

这是一个工作示例：

```
#include "cublas_v2.h"
#include <vector>
#include <iostream>
using std::cout;

void print_matrix(float *data, int rows, int cols) {
    cout << "[";
    for( int row=0; row < rows; row++) {
        cout << "[";
        for( int col=0; col < cols; col++) {
            cout << data[row*cols+col] << ",";
        }
        cout << "]";
    }
    cout << "]";
}

int main() {
    // allocate host vector
    std::vector<float> h_a = {1,2,3,4,5,6,7,8,9,10};
    int nbytes=h_a.size()*sizeof(*h_a.data());
    std::vector<float> h_b(h_a.size());

    // define the number or rows and the number of columns
    int m=2,n=5;

    // allocate device vectors
    float *d_a, *d_b;
    cudaMalloc(&d_a, nbytes);
    cudaMalloc(&d_b, nbytes);

    // copy host vector to device
    cudaMemcpy(d_a,h_a.data(), nbytes, cudaMemcpyHostToDevice);

    // perform a transpose
    {

        float alpha=1;
        float *A=d_a;
        int lda=n;

        float beta=0;
        float *B=NULL;
        int ldb=n;

        float *C=d_b;
        int ldc=m;

        cublasHandle_t handle;
        cublasCreate(&handle);
        cublasStatus_t success=cublasSgeam( handle, CUBLAS_OP_T, CUBLAS_OP_N, m, n, &alpha, A, lda, &beta, B, ldb, C, ldc);
        if ( success != CUBLAS_STATUS_SUCCESS)
            cout << "\33[31mError: " << success << "\33[0m\n";
        cublasDestroy(handle);
    }

    // copy back to host
    cudaMemcpy(h_b.data(),d_b,nbytes,cudaMemcpyDeviceToHost);

    cout << "origional:  ";
    print_matrix(h_a.data(),m,n);
    cout << "\n";

    cout << "transposed: ";
    print_matrix(h_b.data(),n,m);
    cout << "\n";

    cudaFree(d_a);
    cudaFree(d_b);
    return 0;
} 
```

# java - Gradle 可以将多个项目打包到一个 jar 中吗？

> ID：13782013
> 
> 赞同：9
> 
> 时间：2012-12-08T21:15:10.820
> 
> 标签：java, build, gradle

Gradle 可以将多个项目打包到一个 jar 中吗？

我知道您可以使用以下方法为单个项目执行此操作：

```
task packageTests(type: Jar) {
  from sourceSets.test.classes
} 
```

但是一个人如何将多个子项目压缩到一个 jar 中？

我试过这个，但它不起作用：

```
task packageTests(type: Jar) {
  from project(':core').sourceSets.main.classes
  from project(':core:google').sourceSets.test.classes
  from project(':core:bing').sourceSets.test.classes
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-06-30T19:10:58.337

这是我的解决方案，有点简单：

```
// Create a list of subprojects that you wish to include in the jar.  
def mainProjects = [':apps',':core',':gui',':io']
task oneJar( type: Jar , dependsOn: mainProjects.collect{ it+":compileJava"}) {
    baseName = 'name of jar'
    from files(mainProjects.collect{ project(it).sourceSets.main.output })
} 
```

代码已在 Gradle 1.12 上测试

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-10T20:15:01.693

这应该适用于您想要做的事情。这应该在根 gradle 构建文件中。

```
subprojects.each { subproject -> evaluationDependsOn(subproject.path)}

task allJar(type: Jar, dependsOn: subprojects.assemble) {
   baseName = 'your-base-name'
   subprojects.each { subproject -> 
      from subproject.configurations.archives.allArtifacts.files.collect {
         zipTree(it)
       }
    }
 } 
```

您可以通过将其添加为存档来发布它：

```
artifacts {
   archives allJar
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-15T20:29:27.207

下面的解决方案与[CaTalyst.X](https://stackoverflow.com/a/13808485/1671597%20CaTalyst.X)提出的非常相似，但直接使用*jar*任务。

```
subprojects.each { subproject -> evaluationDependsOn( subproject.path ) }
jar.dependsOn subprojects.tasks['classes']
jar {
  baseName = 'MyApp'
  manifest {
    attributes 'Main-Class': 'org.abc.App'
  }
  subprojects.each { subproject ->
    from subproject.sourceSets.main.output.classesDir
    from subproject.sourceSets.main.output.resourcesDir
  }
} 
```

它针对 Gradle 2.1 和 2.2.1 进行了测试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-06T11:39:57.473

我知道这已经得到了回答，但是由于答案很旧（当前的 Gradle 版本是几个较新的主要版本 - 6.2.2）并且该线程在搜索引擎中的出现率很高，因此我将发布对我有用的解决方案。

一般来说，我的问题与原始帖子中所述的问题相似/相同：我想从所有子项目中获取类并将它们压缩到一个 jar 中（最好尽可能使用最默认的设置）。最后我发现下面的代码可以解决问题：

```
jar {
  from subprojects.sourceSets.main.output
} 
```

**但是**，虽然它可以正确构建 jar，但我还希望能够将这个 jar 作为单个工件发布到 Maven 存储库，这取决于所有子项目所做的一切。为了实现这一点，主项目必须依赖于子项目的依赖关系，这是通过以下方式完成的：

```
subprojects.each { evaluationDependsOn(it.path) }
dependencies {
  api(externalSubprojectsDependencies('api'))
  implementation(externalSubprojectsDependencies('implementation'))
}
private externalSubprojectsDependencies(String configuration) {
  subprojects.collect { it.configurations[configuration].allDependencies }.flatten()
      .findAll { !it.properties['dependencyProject'] } // this looks like hack, I'd love to see better solution
} 
```

仅*复制*外部依赖项- 我们不希望列出内部（项目）依赖项，`pom.xml`因为它们的所有类都在 jar 中。

# servicestack - 尝试将 Sharp Architecture 与 ServiceStack 一起使用时出现 TypeInitializationException

> ID：13782014
> 
> 赞同：1
> 
> 时间：2012-12-08T21:15:21.133
> 
> 标签：servicestack, sharp-architecture

这是服务：

```
public class InvoiceDetailsService : RestServiceBase<InvoiceDetails>
{
    public override object OnGet(InvoiceDetails request)
    {
        return new InvoiceDetailsResponse();
    }
} 
```

这些是服务模型：

```
[DataContract]
[Description("Invoice Details web service.")]
[Route("/invoicedetails")] //Optional: Define an alternate REST-ful url for this service
[Route("/invoicedetails/{Id}")]
[Route("/invoicedetails/{Id*}")]
public class InvoiceDetails
{
    public string Id { get; set; }
}

public class InvoiceDetailsResponse : IHasResponseStatus
{
    public InvoiceDetailsResponse()
    {
        this.ResponseStatus = new ResponseStatus();
    }

    public Invoice Invoice { get; set; }
    public ResponseStatus ResponseStatus { get; set; }
} 
```

这是 Invoice 类，继承自 Sharp Architecture 的 Entity 类。（我已经删除了所有其他属性，试图找出原因。）[http://code.google.com/p/sharp-architecture/source/browse/trunk/src/SharpArch/SharpArch.Core/DomainModel/Entity.cs](http://code.google.com/p/sharp-architecture/source/browse/trunk/src/SharpArch/SharpArch.Core/DomainModel/Entity.cs)

```
public class Invoice : Entity
{
    public virtual DateTime Date { get; set; }

    public virtual Double AmountPaid { get; set; }
} 
```

我应该将序列化的空 InvoiceDetailsResponse 返回到浏览器。

我得到的错误是这个，如果 Invoice 是一个简单的 POCO 并且不是从实体派生的，我不会得到这个错误。

> --TypeInitializationException 'ServiceStack.Text.Json.JsonWriter 的类型初始化器`1' threw an exception.</Message><StackTrace> at ServiceStack.Text.Json.JsonWriter`1.WriteFn() at ServiceStack.Text.Json.JsonWriter.GetWriteFn(Type type) at ServiceStack.Text.JsonSerializer.SerializeToString(Object value, Type type) at ServiceStack.Text.JsonSerializer.SerializeToString[T](T value) at ServiceStack.ServiceModel.Serialization.JsonDataContractSerializer.SerializeToString[T](T obj) 在 e:\Desktop\Dev Projects\ServiceStack-master\src\ServiceStack.Common\ServiceModel\Serialization\JsonDataContractSerializer.cs:ServiceStack.WebHost 的第 30 行。 Endpoints.Formats.HtmlFormat.SerializeToStream(IRequestContext requestContext, Object response, IHttpResponse httpRes) 在 e:\Desktop\Dev Projects\ServiceStack-master\src\ServiceStack\WebHost.Endpoints\Formats\HtmlFormat.cs: 第 49 行在 ServiceStack.WebHost .Endpoints.Extensions.HttpResponseExtensions.WriteToResponse(IHttpResponse 响应，对象结果，ResponseSerializerDelegate defaultAction, IRequestContext serializerCtx, Byte[] bodyPrefix, Byte[] bodySuffix) 在 e:\Desktop\Dev Projects\ServiceStack-master\src\ServiceStack\WebHost.Endpoints\Extensions\IHttpResponseExtensions.cs:line 190

我是否应该为我的服务创建一个单独的类并使用映射器？（这样做似乎是多余的。）为什么我不能直接使用我的实体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T10:24:06.043

最里面的异常说它正在寻找 Newtonsoft.Json 4.5 版。我使用 ServiceStack 获得的版本是 4.0。我将 Nuget 用于最新版本的 Newtonsoft.Json，错误消失了。

# awk - 比较awk中的连续行

> ID：13782016
> 
> 赞同：3
> 
> 时间：2012-12-08T21:15:45.987
> 
> 标签：awk, compare

我想使用 awk 命令比较文件中的连续行。这是输入和输出的示例。

输入文件

```
6    
7    
8    
9    
10    
4    
5    
6 
```

我想要的输出文件是这样的：

```
6
7
8
9
10 
14 
15 
16 
```

基本上我想比较当前行是否大于前一行并继续打印前一行和当前行。只要当前行小于前一行，就为后面的每一行添加一个值 (10)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T21:24:11.413

**根据评论中的要求更新**：

```
awk '{if ($1<prev) {offset++}; print ($1+(offset*10)); prev=$1}' input_file 
```

现在，每次在连续行之间从较大的数字变为较小的数字时，增量偏移量都会增加 10。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T21:44:28.463

```
awk '$0<p{$0+=10} {p=$0} 1' file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T21:24:52.420

您必须将先前的值保存在变量中并与之进行比较：

```
awk '{ if ($0 < old) { $0 += 10; } print; old = $0; }' 
```

# c# - 使用资源的多语言应用程序 TypeInitializationException

> ID：13782017
> 
> 赞同：1
> 
> 时间：2012-12-08T21:16:15.477
> 
> 标签：c#, winforms, .net-3.5, multilingual, typeinitializeexception

我在 Properties/String/ (cs-CZ.resx;default.resx) 中有两个资源

我是这样设置的：

```
 internal static System.Resources.ResourceManager strings;

    public static void SetLanguage(string culture)
    {
        if (culture == "cs-CZ")
        {
            Thread.CurrentThread.CurrentCulture = new CultureInfo("cs-CZ");
            strings = Properties.Strings.cs_CZ.ResourceManager;
        }
        else
        {
            Thread.CurrentThread.CurrentCulture = new CultureInfo("en-GB");
            strings = Properties.Strings._default.ResourceManager;
        }
    } 
```

在表单构造函数中：

```
 SetLanguage("cs-CZ"); 
```

接着

```
 public static string Translate(string name)
    {
        return strings.GetString(name);
    }

mainStrip.Text = Translate("mainStrip"); 
```

但我得到了 TypeInitializationException。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T12:15:07.613

TypeInitializationException 主要是使用私有静态构造函数引起的。调用`SetLanguage`方法将调用此构造函数并抛出此异常。因此为此创建新类或在此方法之前调用构造函数。

外汇。这是一个很好的例子： http: [//www.dotnetperls.com/typeinitializationexception](http://www.dotnetperls.com/typeinitializationexception)

# eclipse - 简单的 Web 项目部署在 Tomcat 6 上，而不是 JBoss 6 上

> ID：13782019
> 
> 赞同：1
> 
> 时间：2012-12-08T21:16:54.740
> 
> 标签：eclipse, tomcat, jboss, http-status-code-404, jboss6.x

我使用最新的 Eclipse（Java EE 开发）。我在服务器视图中定义了两台服务器：Tomcat 6 和 JBoss 6（我必须使用它们）。

我正在尝试测试以下简单的 Web 应用程序：http: [//viralpatel.net/blogs/spring-3-mvc-create-hello-world-application-spring-3-mvc/](http://viralpatel.net/blogs/spring-3-mvc-create-hello-world-application-spring-3-mvc/)

当我启动 Tomcat 6（从 eclipse）时，我可以访问项目主页。

然后，当我停止 Tomcat 6 并启动 JBoss 6 时，当我尝试访问项目主页时 - 我得到 HTTP 状态 404。

这里有什么问题？我可能会错过什么？

我不知道我应该在哪里寻找错误。我可以看到这个项目没有部署在 JBoss 中，但我不知道为什么（我想我忘记了一些基本的东西）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T05:11:52.917

在 Eclipse 中打开 Servers 视图，这样您就可以看到您的 jboss 服务器。右键单击您的 JBoss 服务器并选择添加和删除。这使您可以选择要添加到服务器的应用程序。

好的，我能够重现您相信的问题。您应该在 Eclipse 的控制台中看到错误。您的控制台是否显示来自 JBoss 的任何内容？我收到一个错误，因为我的工作区中有一个空间。我将尝试解决这个问题，看看它是否有效。

* * *

我终于让它在 JBoss 6.1 上工作。显然，JBoss 6.1 和项目使用 3.0.1 库的那些 Spring 库之间存在错误。

您需要为 Spring 下载更新的库。即使您将其部署到正确的位置，您也必须更改这些以修复一些部署问题。我在这里找到了它们：[Spring 3.1.3](http://ebr.springsource.com/repository/app/library/version/detail?name=org.springframework.spring&version=3.1.3.RELEASE)

因此，一旦我保存了这些，我将它们复制到 lib 文件夹并删除了 3.0.1 文件。我遇到的下一个问题是让 eclipse 使用正确的 Deploy 文件夹。我在 c:\jboss-6.1-final 中安装了 jboss。在 Eclipse 中，您必须双击您的 jboss 服务器以打开 JBoss 概览页面，在标记为 Deployment 的底部有一个选项卡。在那个屏幕上，我必须选择使用 JBoss 部署文件夹，该文件夹使用我的 C: 驱动器上的文件夹，而不是 Eclipse 使用 JBoss 工具定义的文件夹。当您选择在服务器上运行时，它现在应该在您的 c:\jboss-6.1-final\server\default\deploy 文件夹中创建一个文件夹。

![JBoss 概述/部署屏幕](../Images/c18dad60083e96642e630bbe4093b854.png)

# java - 在没有模运算符的Java中测试偶数

> ID：13782025
> 
> 赞同：9
> 
> 时间：2012-12-08T21:17:31.010
> 
> 标签：java, syntax, logic, bit-manipulation

我将如何在 Java 中做到这一点？判断一个数是否能被 2 整除，如果最后一位是偶数。(0,2,4,6,8) 示例：128 是，129 不是

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-08T21:22:10.047

使用按位运算`and`

```
if( (number&1) == 0) 
```

**按位与运算符 &**

> &（按位与）运算符将其第一个操作数的每个位与第二个操作数的相应位进行比较。如果两个位都是 1，则结果的相应位设置为 1。否则，它将相应的结果位设置为 0（[源](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/bitande.htm)）。

在**二进制**格式中，偶数的**最低有效位为零**。知道这一点并使用 & 运算符，您可以找出它是否是偶数。

所以它需要一个数字 ..abcdy 并与 ..00001 进行比较，如果 y 为零，则 ..abcdy & ..00001 也为零，因此是偶数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-08T21:20:27.677

通过使用按位运算符查看最右边的位是否为 1 然后不是

执行逻辑与（例如）

```
yourNumber & 1 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-08T21:21:52.323

检查最低有效位：

```
boolean even = (x & 1) == 0; 
```

LSB`0`用于偶数和`1`奇数，就像十进制数的最低有效位是`0`如果它可以被 整除`10`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-23T11:47:45.897

```
if((n|1)==n)
  System.out.println("odd");
else
  System.out.println("even"); 
```

原因：如果 LSB 为 1，则数字为奇数，否则为奇数。当 n|1 完成时，奇数的 LSB 保持不变，因此结果数不变，而偶数的 LSB 变为 1，从而改变了数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-23T06:44:51.140

我的方式 ;）

公共类 Even_Odd {

```
/**
 * @param args
 */
public static void main(String[] args) 
{
    int val=550;
    // TODO Auto-generated method stub
    while(val>=0)
    {
        if(val==1)
        {
            System.out.println("Odd Number");
        }
        else if(val==0)
        {
            System.out.println("Even Number");
        }

            val=val-2;
        //  System.out.println(val);

    }
} 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-12T06:11:03.513

将数字除以**2**并乘以答案**2**，如果您得到原始数字，则该数字为**“偶数”**，否则该数字为**“奇数”**

```
public class EvenOrOdd
{
    public static void main(String args[])
    {
        int value = 129;

        if((value/2)*2==value)
        {
            System.out.println("The Given Number \""+value+"\" is Even");
        }
        else
        {
            System.out.println("The Given Number \""+value+"\" is Odd");
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-14T19:18:30.563

```
import java.io.*;
import java.util.*;
public class CheckNumber{
public static void main(String... args)throws IOException{

    BufferedReader br=new BufferedReader(new InputStreamReader(System.in));

    System.out.println("Please enter the number to check even or odd");

    int number=Integer.parseInt(br.readLine());

    String temp=number+""; //convert number to string

    char ch=temp.charAt(temp.length()-1); //get last character

    temp=ch+"";

    if(temp.equals("0") || temp.equals("2") || temp.equals("4") || temp.equals("6") || temp.equals("8")) //check last number is even
        System.out.println("Number is even");
    else
        System.out.println("Number is odd");
} 
```

}

# php - Javascript，或 Jquery 并发布到 php

> ID：13782027
> 
> 赞同：0
> 
> 时间：2012-12-08T21:17:39.560
> 
> 标签：php, javascript, jquery

我想将 javascript 变量发送到 php 文件。我想知道的是你能通过这种方法做到吗？

查询：

```
Var UserName;
UserName = John;
$.post("InsertRunInfo.php", { UserName: UserName } ); 
```

传递给 php：

```
<?php
$con = mysql_connect("*****","*****","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("runtracker", $con);

$sql="INSERT INTO userinfo (UserName)
VALUES
('$_POST[UserName]')";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
echo "1 record added";

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T05:50:57.373

您可以使用 Jquery .load()，如果您想将数据发布到您的 php 文件，并且您的消息“添加了 1 条记录”将加载到您发布数据的同一页面上。

```
 <script type='text/javascript'>
         $('#formid').submit(function(){
               $('#message_div').load("processinfo.php",UserName:$('#username_input_box_id').val()})     
       });
       </script>
      <?php
       //your processinfo.php can retrieve the posted data

       $var = new secure();
       $usernam = $var->secureSuperGlobalPOST('UserName');

        //your rest of code
     ?> 
```

# php - preg_match url 当前与功能设计（条件），或更好的想法

> ID：13782028
> 
> 赞同：0
> 
> 时间：2012-12-08T21:17:40.013
> 
> 标签：php, url, menu, preg-match

首先，我对这段代码了解不多，也知道很差，见谅。

在我的网站中，我有一个已弃用的代码“ereg”，现在我正试图用 preg_match 解决它，但我不知道这个新的 PHP 代码。

```
function Menu($sitio) {
    $url = 'http://www.'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'];
    if(ereg($sitio, $url)) {echo 'class="totalactive"';}
} 
```

如您所见，如果我有一个列表，例如：

```
<li <?php Menu (/contact) ?>> 
```

如果您在 www.yourwebsite.com/contact 中，则代码有效。（但我认为有更好的方法可以做到这一点，因为我的主页以及不在此列表中的任何其他网站都有问题。）

我觉得这段代码太烂了，知道用php5.3以上就更没用了。

有没有一种新的方法可以通过 Preg_match 检测站点并默认设置其中一个来做到这一点？还是用 php5.3 解决这个问题的全新更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:20:13.710

只需用`ereg`这个替换你的电话。

```
preg_match("|" . preg_quote($sitio, "|") . "|", $url) 
```

要仅匹配指定的 url，您必须向该正则表达式添加开始和结束符号，如下所示：

```
preg_match("|^" . preg_quote($sitio, "|") . "$|", $url) 
```

# objective-c - FQL 所有朋友的最新照片都不起作用

> ID：13782030
> 
> 赞同：0
> 
> 时间：2012-12-08T21:17:46.870
> 
> 标签：objective-c, facebook, facebook-graph-api, facebook-fql, photos

我尝试在 FQL 中通过 desc 在一个请求中订购我所有朋友的最新照片，但我只有两个朋友的照片以响应此查询：

```
SELECT src_small ,owner,created FROM photo WHERE aid IN (
SELECT aid FROM album WHERE owner IN (
SELECT uid2 FROM friend WHERE uid1=me()
)
)ORDER BY created DESC 
```

如果我删除我的子查询的 order by，这也是同样的问题，我只有 5 个朋友的照片

我有很好的权限

这对我来说非常有问题，因为我想加载本周的最新照片（包括所有朋友并列出朋友）

你有什么想法或曾经解决过这个问题吗？

非常感谢您的帮助，我完全陷入困境和失望

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T07:28:47.267

问题是您可以返回多少数据是有限的。FB 将您的值限制在约 5K 左右。[平均有 1,000 张照片的 5 个朋友 = 5K]。FQL 没有对照片进行分页的方法。

您需要做的是获取每张专辑，按创建日期排序，并根据您拥有的朋友数量限制结果。（1K 朋友 = 每人 5 张照片）

您会从下面的代码中注意到（为清楚起见，分为 3 部分），返回了许多专辑，但从 5 中返回的图片太少。没有简单的 FQL 答案。

```
{
"query1":"SELECT uid2 FROM friend WHERE uid1=me()",
"query2":"SELECT aid,owner FROM album WHERE owner IN (SELECT uid2 FROM #query1)",
"query3":"SELECT src_small ,owner,created FROM photo WHERE aid IN (SELECT aid FROM #query2) ORDER BY created DESC" 
```

}

# java - 使用哪个数据结构通过对象的两个 ID 之一来搜索对象？

> ID：13782034
> 
> 赞同：4
> 
> 时间：2012-12-08T21:18:37.033
> 
> 标签：java, data-structures

我们有很多这样实现的节点：

```
public class Person{
    private String name;
    private int id1;
    private int id2;
    private Node next; // or left/right, depending on what you're using.
} 
```

1.  如何`name`使用 `id1`或**平均小于 O(n**`id2` ) ？
***   如何以**平均 O(n) 或更快****的顺序**`name`打印所有s ？ **`id2`****

 ******我想到了使用排序的哈希表`id1`和组织的二叉搜索树`id2`。作为数据结构的初学者，我仍然不确定这种方法。

1.  就易于实现和使用的数据结构而言，这是最简单的解决方案吗？
2.  使用两个都基于同一个对象的数据结构会带来任何问题吗？我想知道像我在这里这样的“复制”数据是否会给删除和插入带来任何问题，但也欢迎其他问题和原始问题的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:48:04.317

我确实会使用 a`HashMap<Integer, Person>`按 ID1 存储人员，并使用 a`TreeMap<Integer, Person>`按 ID2 存储人员，按 ID2 排序。

第一个是 O(1)，通过 ID1 获取名称。第二个是 O(N) 用于遍历所有值。

要回答您的问题：

1.  我认为这确实是最简单的解决方案
2.  确保将两个映射封装在一个提供所需方法的对象中，并同时在两个映射中插入/删除。不要将两张地图暴露在外面。如果您将第二个映射的迭代器或值的集合暴露给外部，请确保`Collections.unmodifiableCollection()`在返回之前将其包装使用，以防止从外部修改集合。******

# facebook - Facebook 应用程序权限窗口仅在新标签页或窗口中打开链接时显示

> ID：13782038
> 
> 赞同：2
> 
> 时间：2012-12-08T21:19:08.040
> 
> 标签：facebook, authentication, user-permissions

我正在尝试使用 Java 在 facebook 中创建一个应用程序。在我的 index.jsp 中有一个收藏夹运动队的链接。当用户单击链接时，facebook 应该向用户请求许可。但没有任何效果。

当用户在新选项卡或窗口中打开链接并且 facebook 权限窗口出现时，它可以工作。从下一次用户点击最喜欢的运动队的链接，它就可以完美运行。

我的问题是，为什么用户第一次需要在新选项卡或窗口中打开链接。谢谢你。

```
<a href="https://www.facebook.com/dialog/oauth?client_id=MYID&redirect_uri=http://localhost:8080/SimpleRestaurantSearch/nap&scope=friends_hometown,friends_likes,friends_location">Favorite Sports Teams</a> 
```

# linux - Shell 脚本挂起，但仅在调用变量或 strace 时

> ID：13782039
> 
> 赞同：5
> 
> 时间：2012-12-08T21:19:10.343
> 
> 标签：linux, bash, shell

**一般问题：**如果调用它的脚本或 shell (bash) 命令将其调用到变量中，什么会导致脚本本身运行良好，挂起？

换句话说，怎么会有这样的脚本在这样调用时工作............`/path/to/script arg arg`当这样调用时失败并挂起...... `VAR=$(/path/to/script arg arg);`？

* * *

*（在注意到软件故障导致大量初始测试给出错误结果后进行重大编辑）*

* * *

**我的具体情况：**我有一个运行良好的脚本（启动、停止或重新启动 java 应用程序 Apache Solr，[改编自此处](http://drupal.org/node/545368)）。代码如下，它的命令是`sbin/service solr [action]`，例如`sbin/service solr start`。

当从脚本或直接从控制台（`bash`在我的情况下）调用时`sbin/service solr start`，它可以正常工作并快速完成。然而，如果它被调用到一个变量中，比如`VAR=$(sbin/service solr start);`，它可以工作，但会挂起一个 futext / clock_gettime 循环（下面的跟踪）。如果它不是被调用到变量中，它也会挂起，而是到`strace`.

奇怪的是，以相同方式调用的其他脚本使用相同的语法，例如`sbin/service httpd start`，在调用变量时工作得很好。因此，当输出存储为变量时，脚本很可能会挂起，但如果不是这种情况，则运行得很好。

* * *

以下是测试调用挂起和不挂起的结果：

**挂起**------------------------------------------------

*   `VAR=$(/sbin/service solr start);`
*   `VAR=$(source /sbin/service solr start);`
*   `VAR=$(nohup /sbin/service solr start &);`

（所以从哪个进程调用它并不重要）此外，编辑脚本文件以启动服务`source`会导致服务无法工作。

**没有挂起**-------------------------------------

*   `VAR=$(/sbin/service solr start >> /dev/null);`

*输出到`/dev/null`允许我们请求输出而不会导致它挂起。但是，它没有多大用处，因为没有收到实际的输出。*

*   `/sbin/service solr start`

*与我最初的想法相反。这会输出一个简单的更新消息，理想情况下，我们会在变量和日志中捕获该消息 - 但尝试这样做会导致它挂起。*

*   `VAR=$(/sbin/service httpd restart);`

*挂起的语法在其他`service`脚本上工作得很好，脚本的输出毫无问题地传递给变量。*

* * *

这是该脚本的完整代码：（已删除注释，自然 $SOLR_DIR 路径是真实脚本中的真实路径）

```
SOLR_DIR="[path/to/application]"
JAVA_OPTIONS="-Xms64m -Xmx64m -DSTOP.PORT=8079 -DSTOP.KEY=mustard -jar start.jar"
LOG_FILE="/var/log/solr.log"
JAVA="/usr/bin/java"

case $1 in
    start)
        echo "Starting Solr"
        cd $SOLR_DIR
        $JAVA $JAVA_OPTIONS 2> $LOG_FILE &
        ;;
    stop)
        echo "Stopping Solr"
        cd $SOLR_DIR
        $JAVA $JAVA_OPTIONS --stop
        ;;
    restart)
        $0 stop
        sleep 1
        $0 start
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}" >&2
        exit 1
        ;;
esac 
```

`var/log/solr.log`（脚本中命名的日志文件）中没有错误或任何异常。Centos Linux 服务器（如果相关）。

* * *

在回答早期版本的问题时，@cdarke 建议我`strace -f -o strace.out /path/to/script`在调用此脚本的脚本上运行，并查看（大量！）输出文件`strace.out`。将近 3mbs，以下是一些观察结果：

1.  从许多看起来像脚本按预期运行的活动开始。

2.  然后，日志文件的最后 15% 左右是这样的，用不同的整数重复但看似相同的十六进制代码：

...

```
25687 futex(0x688d454, FUTEX_WAIT_PRIVATE, 1, {0, 49980000}) = -1 ETIMEDOUT (Connection timed out)
25687 futex(0x688d428, FUTEX_WAKE_PRIVATE, 1) = 0
25687 clock_gettime(CLOCK_MONOTONIC, {39074112, 932735888}) = 0
25687 clock_gettime(CLOCK_REALTIME, {1355007234, 333458000}) = 0 
```

`ps -p` *即使我在脚本仍在运行、输出文件仍在变大且这些代码行仍在编写时这样做，*这些 PID 也不会出现任何结果。我不太确定这怎么可能。

这是输出进入永无止境的 futex/clock_gettime 循环*之前的最后一点，**在*最后一部分显然是正确执行的脚本之后（`solr/solr.xml`是一个 Solr 配置文件，需要读取它以启动 Solr 进程）：

```
25874 stat("solr/solr.xml", {st_mode=S_IFREG|0777, st_size=1320, ...}) = 0
25874 write(2, "Dec 8, 2012 5:12:05 PM org.apach"..., 106) = 106
25874 socket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 89
25874 fcntl(89, F_GETFL)                = 0x2 (flags O_RDWR)
25874 fcntl(89, F_SETFL, O_RDWR|O_NONBLOCK) = 0
25874 setsockopt(89, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
25874 bind(89, {sa_family=AF_INET, sin_port=htons(8983), sin_addr=inet_addr("0.0.0.0")}, 16) = 0
25874 listen(89, 50)                    = 0
25874 setsockopt(89, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
25874 lseek(12, 57747, SEEK_SET)        = 57747
25874 read(12, "PK\3\4\n\0\0\0\10\0\221Vi>F\347\254\364\325\4\0\0002\t\0\0002\0\0\0", 30) = 30
25874 lseek(12, 57827, SEEK_SET)        = 57827
25874 read(12, "\225V\377oSU\24\377\334\273\256\257_\36l\216m\254\262\351\224\241]\273\255\200\314/\5\246c\200"..., 1237) = 1237
25874 futex(0x2aaab0173054, FUTEX_WAKE_OP_PRIVATE, 1, 1, 0x2aaab0173050, {FUTEX_OP_SET, 0, FUTEX_OP_CMP_GT, 1} <unfinished ...>
25894 <... futex resumed> )             = 0
25894 futex(0x2aaab0173028, FUTEX_WAIT_PRIVATE, 2, NULL <unfinished ...>
25874 <... futex resumed> )             = 1
25874 futex(0x2aaab0173028, FUTEX_WAKE_PRIVATE, 1 <unfinished ...>
25894 <... futex resumed> )             = 0
25894 futex(0x2aaab0173028, FUTEX_WAKE_PRIVATE, 1) = 0
25894 clock_gettime(CLOCK_REALTIME, {1355008325, 376033000}) = 0
25894 futex(0x2aaab0173054, FUTEX_WAIT_PRIVATE, 3, {0, 983000} <unfinished ...>
25874 <... futex resumed> )             = 1
25874 futex(0x2aaab0173054, FUTEX_WAKE_OP_PRIVATE, 1, 1, 0x2aaab0173050, {FUTEX_OP_SET, 0, FUTEX_OP_CMP_GT, 1} <unfinished ...>
25894 <... futex resumed> )             = 0
25894 futex(0x2aaab0173028, FUTEX_WAIT_PRIVATE, 2, NULL <unfinished ...>
25874 <... futex resumed> )             = 1
25874 futex(0x2aaab0173028, FUTEX_WAKE_PRIVATE, 1 <unfinished ...>
25894 <... futex resumed> )             = 0
25894 futex(0x2aaab0173028, FUTEX_WAKE_PRIVATE, 1) = 0
25894 poll([{fd=89, events=POLLIN|POLLERR}], 1, -1 <unfinished ...>
25874 <... futex resumed> )             = 1
25874 write(2, "2012-12-08 17:12:05.376:INFO::St"..., 66) = 66
25874 write(2, "\n", 1)                 = 1
25874 mmap(0x41348000, 12288, PROT_NONE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS|MAP_NORESERVE, -1, 0) = 0x41348000
25874 rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
25874 sched_getaffinity(25874, 32,  { ffff, 0, 0, 0 }) = 32
25874 sched_getaffinity(25874, 32,  { ffff, 0, 0, 0 }) = 32
25874 gettid()                          = 25874
25874 rt_sigprocmask(SIG_BLOCK, NULL, [], 8) = 0
25874 rt_sigprocmask(SIG_UNBLOCK, [HUP ILL BUS FPE SEGV USR2 TERM], NULL, 8) = 0
25874 rt_sigprocmask(SIG_BLOCK, [QUIT], NULL, 8) = 0
25874 mmap(0x41348000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x41348000
25874 mprotect(0x41348000, 12288, PROT_NONE) = 0
25874 futex(0x10632d54, FUTEX_WAIT_PRIVATE, 1, NULL <unfinished ...>
25882 <... futex resumed> )             = -1 ETIMEDOUT (Connection timed out)
25882 futex(0x106cc428, FUTEX_WAKE_PRIVATE, 1) = 0
25882 clock_gettime(CLOCK_MONOTONIC, {39075204, 21489888}) = 0
25882 clock_gettime(CLOCK_REALTIME, {1355008325, 422198000}) = 0
25882 futex(0x106cc454, FUTEX_WAIT_PRIVATE, 1, {0, 49984000}) = -1 ETIMEDOUT (Connection timed out)
25882 futex(0x106cc428, FUTEX_WAKE_PRIVATE, 1) = 0
25882 clock_gettime(CLOCK_MONOTONIC, {39075204, 72479888}) = 0
25882 clock_gettime(CLOCK_REALTIME, {1355008325, 473185000}) = 0
25882 futex(0x106cc454, FUTEX_WAIT_PRIVATE, 1, {0, 49987000}) = -1 ETIMEDOUT (Connection timed out)
25882 futex(0x106cc428, FUTEX_WAKE_PRIVATE, 1) = 0 
```

所以死亡螺旋前的最后一行是`read()`通道 12 上的。然后它只是循环 futex 和 clock_gettime 直到它被手动杀死。

* * *

最后一点可能无关紧要，但如果[与此问题类似](https://stackoverflow.com/questions/8122780/exiting-shell-script-with-background-processes)，我运行调用此脚本的脚本并使用`nohup`并将输出转移到`/dev/null`，我会在开始附近得到以下内容（输出文件中大约 100kb）：这些：

`25664 close(67) = -1 EBADF (Bad file descriptor)`

他们从 67，每次增加 +1，到：

`25664 close(1023) = -1 EBADF (Bad file descriptor)`

然后他们紧随其后

`25664 open("/dev/null", O_RDWR) = 3`

同样，据我所知，PID 是空的。不确定这是否相关 - 我想这可能会导致使用 nohup 输出到 /dev/null 确实是解决此类问题的一般方法，但我以某种方式做错了，导致这些错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T02:33:46.003

我很确定问题在于 shell 正在捕获 /sbin/service 脚本*和*它启动的 solr 服务的输出，因此在继续之前将等待服务退出（或至少关闭其标准输出）。这是一个简单的演示：

```
$ bg_service() { while true; do sleep 10; done; }
$ start_bg_service() { echo "starting"; bg_service& echo "running"; }
$ start_bg_service 
starting
[1] 8656
running
$ var=$(start_bg_service)
[It hangs at this point... until I open another shell and kill the background process] 
```

# java - 字符串与另一个字符串重叠

> ID：13782041
> 
> 赞同：3
> 
> 时间：2012-12-08T21:19:18.190
> 
> 标签：java, arrays, string, tic-tac-toe

我知道我的代码有点乱，但我会尽量详细。该代码正在创建一个井字游戏。我正在使用一个数组来创建游戏板，即 gameBoard()。用户始终为 X，而计算机始终为 O。我为用户输入和计算机输入创建了 if 语句，不同之处在于，计算机从 java.util.Random 获取其编号。if 语句获取用户的输入并在指定的板上打印一个 X，与计算机相同。这里的问题是当随机生成器选择一个已经存在 X 的空间时，它会重叠，反之亦然。我需要程序偷偷告诉计算机生成另一个随机数。如果你能帮上忙就太好了。对不起，大的描述。

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.IOException;
import java.util.Random;

public class TicTacToeGame {

static String arrayPicture[][]; //Array is universal so we can include it into any method
static int userInput;
static boolean validInput = false;
static String name;

public static void main (String[] args) throws IOException {

    System.out.println ("Please enter your name:");
    name = gameStart("");

    arrayPicture = new String [13][13];

    for (int i = 0; i < 13; i ++) {

        for (int j = 0; j < 13; j  ++) {
            arrayPicture [i][j] = " "; //Print spaces into the array
        }   
    }       

    while (validInput == false) {

        validX();

        cpuPlacement();

        System.out.println ("Computer, please enter your number");
        validInput = false;
    }       
}//main

public static void verticalLine (int x1, int y1, int x2) {

    for (int k = x1; k < x2; k ++) {
        arrayPicture [y1][k] = "|"; //if y1 and k are present, print a vertical line in the array
    }       
}//verticalLine

public static void horizontalLine (int x1, int y1, int x2) {
    for (int k = x1; k < x2; k ++) {
        arrayPicture [y1][k] = "-"; //if y1 and k are present, print a dash in the array
    }       
}//horizontalLine

public static void printArray () {
    for (int i = 0; i < 13; i ++) {

        for (int j = 0; j < 13; j ++) {
            System.out.print (arrayPicture[i][j]);
        }   
        System.out.println();
    }       
}//printArray

public static String gameStart (String input) throws IOException { 

        boolean validInput = false;

        BufferedReader userInput = new BufferedReader (new InputStreamReader(System.in));

        while (validInput == false) {
            input = userInput.readLine();
            validInput = true;

                System.out.println ("The name of the game is TicTacToe, you will always be the letter X.");
                System.out.println ("Please choose the coordinates you wish. The coordinates are where your X will be placed on the game board.");

        }
        return input;
}

public static void validX () throws IOException {

    gameBoard();

    String input = null;

    System.out.println (name + ", please enter your number");

        try {
            BufferedReader columnNumber = new BufferedReader (new InputStreamReader(System.in));//BufferedReader variable where the user will input their answer
            input = columnNumber.readLine();
            userInput = Integer.parseInt (input);
            validInput = true;
            userPlacement();
            //If an exception is present, the try sends it to catch.
            //Ex. If the user in\puts "bob has a cat" the try will find an exception and immediately send it to the catch statement
        }
            catch (NumberFormatException ex) {
            System.out.println ("Invalid input, please enter a number.");
            validInput = false;
        }

        if (userInput == 1) {
            userInputX (2, 2, 3);
        }
        else if (userInput == 2) {
            userInputX (6, 2, 7);
        }
        else if (userInput == 3) {
            userInputX (10, 2, 11);
        }
        else if (userInput == 4) {
            userInputX (2, 6, 3);
        }
        else if (userInput == 5) {
            userInputX (6, 6, 7);
        }
        else if (userInput == 6) {
            userInputX (10, 6, 11);
        }
        else if (userInput == 7) {
            userInputX (2, 10, 3);
        }
        else if (userInput == 8) {
            userInputX (6, 10, 7);
        }                               
        else if (userInput == 9) {
            userInputX (10, 10, 11);
        }
}

public static void cpuinputO (int x1, int y1, int x2) throws IOException {

    gameBoard();

    for (int k = x1; k < x2; k ++) {
        arrayPicture [y1][k] = "O"; //if y1 and k are present, print a dash in the array
    }
}

public static void userInputX (int x1, int y1, int x2) {

    for (int k = x1; k < x2; k ++) {
        arrayPicture [y1][k] = "X"; //if y1 and k are present, print a dash in the array
    }
}

public static void userPlacement () throws IOException {

    if (userInput == 1) {
        userInputX (2, 2, 3);
    }
    else if (userInput == 2) {
        userInputX (6, 2, 7);
    }
    else if (userInput == 3) {
        userInputX (10, 2, 11);
    }
    else if (userInput == 4) {
        userInputX (2, 6, 3);
    }
    else if (userInput == 5) {
        userInputX (6, 6, 7);
    }
    else if (userInput == 6) {
        userInputX (10, 6, 11);
    }
    else if (userInput == 7) {
        userInputX (2, 10, 3);
    }
    else if (userInput == 8) {
        userInputX (6, 10, 7);
    }                               
    else if (userInput == 9) {
        userInputX (10, 10, 11);
    }
}

public static void cpuPlacement () throws IOException {

    Random random = new Random();
    int cpuCoordinates = random.nextInt(10);
    System.out.println (cpuCoordinates);
    boolean validInput0 = false;

    if (validInput0 == true) {

        if (cpuCoordinates < 1) {
            validInput0 = false;
        }
    }
    else if (cpuCoordinates == 1) {
        cpuinputO (2, 2, 3);
    }
    else if (cpuCoordinates == 2) {
        cpuinputO (6, 2, 7);
    }
    else if (cpuCoordinates == 3) {
        cpuinputO (10, 2, 11);
    }
    else if (cpuCoordinates == 4) {
        cpuinputO (2, 6, 3);
    }
    else if (cpuCoordinates == 5) {
        cpuinputO (6, 6, 7);
    }
    else if (cpuCoordinates == 6) {
        cpuinputO (10, 6, 11);
    }
    else if (cpuCoordinates == 7) {
        cpuinputO (2, 10, 3);
    }
    else if (cpuCoordinates == 8) {
        cpuinputO (6, 10, 7);
    }                               
    else if (cpuCoordinates == 9) {
        cpuinputO (10, 10, 11);
    }
}

public static void gameBoard () throws IOException {
    System.out.println (" ");
    horizontalLine (1, 0, 4);  horizontalLine (5, 0, 8);  horizontalLine (9, 0, 12);
    verticalLine (0, 1, 1);  verticalLine (4, 1, 5);  verticalLine (8, 1, 9);  verticalLine (12, 1, 13);
    verticalLine (0, 2, 1);  verticalLine (4, 2, 5);  verticalLine (8, 2, 9);  verticalLine (12, 2, 13);
    verticalLine (0, 3, 1);  verticalLine (4, 3, 5);  verticalLine (8, 3, 9);  verticalLine (12, 3, 13);
    horizontalLine (1, 4, 4);  horizontalLine (5, 4, 8);  horizontalLine (9, 4, 12);
    verticalLine (0, 5, 1);  verticalLine (4, 5, 5);  verticalLine (8, 5, 9);  verticalLine (12, 5, 13);
    verticalLine (0, 6, 1);  verticalLine (4, 6, 5);  verticalLine (8, 6, 9);  verticalLine (12, 6, 13);
    verticalLine (0, 7, 1);  verticalLine (4, 7, 5);  verticalLine (8, 7, 9);  verticalLine (12, 7, 13);
    horizontalLine (1, 8, 4);  horizontalLine (5, 8, 8);  horizontalLine (9, 8, 12);
    verticalLine (0, 9, 1);  verticalLine (4, 9, 5);  verticalLine (8, 9, 9);  verticalLine (12, 9, 13);
    verticalLine (0, 10, 1); verticalLine (4, 10, 5);  verticalLine (8, 10, 9);  verticalLine (12, 10, 13);
    verticalLine (0, 11, 1); verticalLine (4, 11, 5);  verticalLine (8, 11, 9);  verticalLine (12, 11, 13);
    horizontalLine (1, 12, 4);  horizontalLine (5, 12, 8);  horizontalLine (9, 12, 12);
    printArray ();

 }//gameBoard
}//public class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:37:35.020

我不太确定您的代码中发生了什么（您为什么要在井字游戏的 13×13 数组中循环？）但这应该很容易解决。最简单的解决方法是在 CPU 放置代码周围添加一个 while 循环，而不是当前的 if/else-if 语句。（if/else-ifs 应该在 while 循环内。）当找到一个有效的位置时，

```
while(validInput0==false){
    if(cpuCoordinates == 1){
        if(squareOneOwner == null){
            squareOneOwner = "CPU"
            validInput0 = true;
        }
    }else if(...){
        ...
    }
    if(validInput0 == false){
        cpuCoordinates = random.nextInt(10);
    }
} 
```

等等。这使您可以检查计算机是否瞄准的方格，并且仅在当前为空时才认领它。它需要在其他地方进行一些更改，但它们很简单。如果上一次尝试无效，最后一个 if 语句将重新滚动到下一个循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:45:09.007

我认为您的代码需要一些重组。

在我看来，您应该将 cpu 和播放器制作的条目存储到二维`int`数组中。计算机可以用`1`s 表示，玩家可以用`2`s 表示。空方格用`0`s 表示。

然后，您可以使用嵌套的 for 循环遍历此数组以绘制游戏板。

```
int[][] game_board = new int[3][3]

for(int i = 0; i < 3; i++)
{
  for(int j = 0; j < 3; j++)
  {
     if(game_board[i][j] == 1)
        ...code to print an X...
     if(game_board[i][j] == 2)
        ...code to print an O...
     if(game_board[i][j] == 0)
        ...code to print some spaces...

     ...code to print a vertical line...
  }

  ...code to print a horizontal line...
} 
```

当计算机或玩家做出选择时，您只需检查`game_board`该位置是否为 0，如果不是，则必须做出另一个选择。

```
choice_x = ...user or computer chooses an x location...
choice_y = ...user or computer chooses a  y location...

if(game_board[choice_x][choice_y] != 0)
{
    ...choose again...
}
else
{
    if( player is choosing ) 
        game_board[choice_x][choice_y] = 1 
    if( computer is choosing )
        game_board[choice_x][choice_y] = 0
} 
```

# eclipse - 安装 Hadoop 的 Eclipse 插件

> ID：13782042
> 
> 赞同：6
> 
> 时间：2012-12-08T21:19:33.933
> 
> 标签：eclipse, plugins, hadoop

我对 Hadoop 的 Eclipse 插件有这样的噩梦。首先，最新的 Hadoop 版本（即 1.1.1）甚至不包括 Eclipse 插件 jar 文件。1.0.4 版有插件，但是不能用。Hadoop 的早期版本（例如 0.22.0）有插件并且可以工作，但是这些版本的 Hadoop 很旧，我想使用最新版本。那么，Hadoop 的 Eclipse 插件有什么用呢？为什么最新版本没有插件，或者如果有，那么插件不起作用？每个人都对这个插件有这么多问题吗？我应该放弃这个插件吗？

谢谢，香农

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-10T20:03:26.553

昨天好不容易安装了hadoop-1.0.4的eclipse插件，测试成功。

插件不起作用的原因是 jar 包丢失了一些库：

*   commons-cli-1.2.jar
*   commons-configuration-1.6.jar
*   杰克逊核心asl-1.8.8.jar
*   jackson-mapper-asl-1.8.8.jar
*   commons-httpclient-3.0.1.jar
*   commons-lang-2.4.jar

您可以将这个 jar 从**${hadoop}/lib 复制**到**${jar}/lib**，并且不要忘记修改**MANIFEST**。

**为方便起见，我在${eclipse-plugin-src}/build.xml**目标**jar**中添加了一些代码

 **```
<copy file="${hadoop.root}/build/ivy/lib/Hadoop/common/commons-cli-${commons-cli.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
<copy file="${hadoop.root}/lib/commons-configuration-${commons-configuration.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
<copy file="${hadoop.root}/lib/commons-httpclient-${commons-httpclient.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
<copy file="${hadoop.root}/lib/commons-lang-${commons-lang.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
<copy file="${hadoop.root}/lib/jackson-core-asl-${jackson.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
<copy file="${hadoop.root}/lib/jackson-mapper-asl-${jackson.version}.jar"  todir="${build.dir}/lib" verbose="true"/> 
```

并在**${eclipse-plugin-src}/META-INF**中修改了**MANIFEST.MF**

 **```
undle-ClassPath: classes/,
 lib/hadoop-core.jar,
 lib/commons-cli-1.2.jar,
 lib/commons-configuration-1.6.jar,
 lib/jackson-core-asl-1.8.8.jar,
 lib/commons-httpclient-3.0.1.jar,
 lib/jackson-mapper-asl-1.8.8.jar,
 lib/commons-lang-2.4.jar 
```

重建 eclipse-plugin，玩得开心！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T01:31:41.430

好吧，结合 hs3180 的回答，这就是我在配置编译时实际所做的。

1.  在**${eclipse-plugin-src}/build.xml**中，使用以下指令包含 eclipse-plugin 所需的 jar。请注意，现在直接从 from`${hadoop.root}/build`复制而不是 from ，因为如果您使用的是 hadoop 的编译版本，则该文件夹实际上是空的。出于同样的原因，现在复制的是。`hadoop-core-${version}.jar``${hadoop.root}``${hadoop.root}/build``commons-cli-${commons-cli.version}.jar``${hadoop.root}/lib`

    ```
    <!-- <copy file="${hadoop.root}/build/hadoop-core-${version}.jar" tofile="${build.dir}/lib/hadoop-core.jar" verbose="true"/> -->
    <!-- <copy file="${hadoop.root}/build/ivy/lib/Hadoop/common/commons-cli-${commons-cli.version}.jar"  todir="${build.dir}/lib" verbose="true"/> -->
    <copy file="${hadoop.root}/hadoop-core-${version}.jar" tofile="${build.dir}/lib/hadoop-core.jar" verbose="true"/>
    <copy file="${hadoop.root}/lib/commons-cli-${commons-cli.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
    <copy file="${hadoop.root}/lib/commons-configuration-${commons-configuration.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
    <copy file="${hadoop.root}/lib/commons-httpclient-${commons-httpclient.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
    <copy file="${hadoop.root}/lib/commons-lang-${commons-lang.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
    <copy file="${hadoop.root}/lib/jackson-core-asl-${jackson.version}.jar"  todir="${build.dir}/lib" verbose="true"/>
    <copy file="${hadoop.root}/lib/jackson-mapper-asl-${jackson.version}.jar"  todir="${build.dir}/lib" verbose="true"/> 
    ```

2.  修改**${eclipse-plugin-src}/META-INF/MANIFEST.MF**文件以适应对**${eclipse-plugin-src}/build.xml 所做**的更改。

    ```
    Bundle-ClassPath: classes/,
     lib/hadoop-core.jar,
     lib/commons-cli-1.2.jar,
     lib/commons-configuration-1.6.jar,
     lib/jackson-core-asl-1.8.8.jar,
     lib/commons-httpclient-3.0.1.jar,
     lib/jackson-mapper-asl-1.8.8.jar,
     lib/commons-lang-2.4.jar 
    ```

3.  在两处修改**${hadoop.root}/src/contrib/build-contrib.xml**文件。首先是设置插件编译所需的属性。第二个是确保 jars，尤其是`hadoop-core-1.0.4.jar`文件`${hadoop.root}`夹中的 jars 对 javac 可见，因为 eclipse-plugin 引用了 hadoop 类。此设置在目的上与前两个不同，因此不是可有可无的。

    ```
    <!-- Properties added for compiling eclipse-plugin -->
    <!-- http://yiyujia.blogspot.com/2012/11/build-hadoop-eclipse-plugin-from-source.html -->
    <property name="eclipse.home" location="/Users/xuj/Downloads/eclipse/"/>
    <property name="version" value="1.0.4"/>
    <property name="commons-cli.version" value="1.2"/>

    <!-- the normal classpath -->
    <path id="contrib-classpath">
      <fileset dir="${hadoop.root}">
        <include name="*.jar" />
      </fileset>
      <!-- more path elements go here -->
    </path> 
    ```

正确配置所有文件后，从控制台中调用“ **ant jar** ”`${eclipse-plugin-src}/`就足够了。****

# php - 堆栈交换 API cURL

> ID：13782043
> 
> 赞同：-1
> 
> 时间：2012-12-08T21:20:08.303
> 
> 标签：php, curl, stackexchange-api

我正在尝试将 cURL 与 Stack Exchange API 一起使用，但我似乎得到了一个空响应，关于发生了什么的任何想法？

我的代码是：

```
function get($get){
        $ch = curl_init("http://api.stackoverflow.com/1.1/search?intitle=meteor");

        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch,CURLOPT_ENCODING , "gzip");
        $decoded =  json_decode(curl_exec($ch), true);

        var_dump($decoded->questions[0]->title);
}

get("stackoverflow"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T10:20:52.623

如果要函数`json_decode()`返回对象，则需要省略第二个参数。在您的情况下，第二个参数是`TRUE`，这意味着它将返回数据数组。

另外，我建议通过回显整个响应来调试请求，而不是您想要查看的项目。例如，如果它返回错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:16:39.923

`$decoded`是一个数组，所以你可以像这样使用它：

```
function get($get){
        $ch = curl_init("http://api.stackoverflow.com/1.1/search?intitle=$get");

        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch,CURLOPT_ENCODING , "gzip");
        $decoded =  json_decode(curl_exec($ch), true);
        echo $decoded["questions"][0]["title"];
}

get("meteor"); 
```

# session - Kohana3.3：从另一个动作检查会话是否存在

> ID：13782046
> 
> 赞同：0
> 
> 时间：2012-12-08T21:20:25.443
> 
> 标签：session, action, kohana, session-variables, kohana-3

我有

```
Session::$default='database';
$session=Session::instance(); 
```

并 `$session->id()`立即显示会话的值。该值也存储在`sessions`表中。一切似乎都很好。

我的问题是：如何检查会话是否存在于另一个动作中。`$_SESSION`数组未定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:55:26.653

要从任何控制器操作或视图模板访问会话，只需使用：

```
Session::instance() 
```

例如：

```
$session = Session::instance();

$session->set('my_key', 'my_value');

// returns false if my_key does not exist
$my_key = $session->get('my_key', false); 
```

要使用 Kohana 会话重载 $_SESSION，请在每个操作方法中运行以下命令：

```
$_SESSION =& $session->as_array(); 
```

# actionscript-3 - As3 在 Sprite 上调度 mouse_down 事件

> ID：13782048
> 
> 赞同：1
> 
> 时间：2012-12-08T21:20:28.173
> 
> 标签：actionscript-3, mouseevent, event-dispatching

我有这个动作脚本代码。我要做的是在 imgSprite 上触发鼠标事件，这是 imageContainer 的子元素。我期待它在 imgSprite 上的鼠标坐标上触发它，但它使用最后加载的 imgSprite 实例。为了获得更大的图景，我正在尝试切换两个拼图块，因此当我放下一个时，下面的一个会立即被捡起。我通过删除上一个（selectedImage）并调度一个mouse_down事件来做到这一点，该事件应该由事件侦听器（指向imgSprite）拾取并定向到mouse_down函数。

```
function mouse_Down(e:MouseEvent):void 
    {
        dropSelectedImage();
        if(selectedImage) imageContainer.addChild(selectedImage); 
        imageContainer.removeChild(e.currentTarget as Sprite); 
        imageContainer.addChild(e.currentTarget as Sprite); 
        selectedImage = e.currentTarget as Sprite;
        selectedImage.startDrag();
    }
    function mouse_Up(e:MouseEvent):void{
        dropSelectedImage();
        imageContainer.removeChild(selectedImage); 
        imgSprite.dispatchEvent(new MouseEvent(MouseEvent.MOUSE_DOWN,true,true));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:40:48.943

打开冒泡，调试 even.target 和 event.currentTarget 的区别。

# javascript - 从 GridView 链接调用 Jquery 函数

> ID：13782051
> 
> 赞同：0
> 
> 时间：2012-12-08T21:20:37.050
> 
> 标签：javascript, jquery, asp.net, jquery-ui, gridview

经过几个小时尝试所有可能的方法后，我放弃了。也许你们可以看到我在这里做错了什么。我有一个带有删除按钮的 GridView。在 ClientClick 事件中，我调用了一个 javascript 函数，该函数打开一个带有是/否按钮的 jquery msgbox。如果用户单击是，我希望该函数`ConfirmDeleteRecord()`返回 true。

这是 GridView 上的“删除”列的样子：

```
<asp:TemplateField HeaderText="Delete" ItemStyle-HorizontalAlign="Center">
<ItemTemplate>
        <asp:LinkButton CommandArgument='<%# DataBinder.Eval(Container.DataItem, "ClientSkuID") %>' Text="Delete" runat="server" ID="lnkDelete" OnClientClick="return ConfirmDeleteRecord()"></asp:LinkButton>
    </ItemTemplate> 
```

这是我的 Javascript 函数：

```
function ConfirmDeleteRecord() {

var bResult = false;

$.msgBox({
    title: "Are You Sure?",
    content: "Are you sure you want to delete this record?",                    
    type: "confirm",
    buttons: [{ value: "Yes" }, { value: "No" }, { value: "Cancel"}],
    success: function (result) {
        if (result == "Yes") {
            bResult = true;
        }
    }
    });

return bResult; 
```

}

问题是代码永远不会到达“return bResult”行。

谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:46:06.430

那是行不通的，因为 $.msgBox 不是像 confirm() 这样的阻塞函数。有道理？该功能所做的只是显示一些 HTML。你需要做的是改变你的代码：

```
 if (result == "Yes") {
            bResult = true;
        } 
```

类似于：

```
if (result == "Yes") {
 //perform postback here to delete the record. 
} 
```

# javascript - 使用 JavaScript 反序列化来自 SignalR/Json.NET 的复杂对象图中的引用

> ID：13782052
> 
> 赞同：13
> 
> 时间：2012-12-08T21:21:05.133
> 
> 标签：javascript, json, json.net, deserialization, signalr

我正在使用 SignalR 向我的 JavaScript 客户端返回一个复杂的对象图。此对象图对同一对象有多个引用，因此 SignalR/Json.NET 返回的 JSON 看起来很像这样：

```
{
    "$id": "57",
    "Name": "_default",
    "User": {
        "$id": "58",
        "UserTag": "ken",
        "Sessions": [{
            "$id": "59",
            "SessionId": "0ca7474e-273c-4eb2-a0c1-1eba2f1a711c",
            "User": {
                "$ref": "58"
            },
            "Room": {
                "$ref": "57"
            }
        }],
    },

    "Sessions": [{
        "$ref": "59"
    }]
} 
```

（当然，在现实生活中要复杂得多，但你明白了。）

当然，当 Json.NET 通过引用而不是按值进行序列化时，它会为每个对象分配一个 $id 值（例如，`"$id":"57"`，然后稍后仅使用该 id 引用该对象（例如，`"$ref":"57"`。告诉我们，当反序列化这些引用的是 Json.NET（使用 C#/.NET）时，它会将对象的适当实例放置在适当的位置。

到目前为止一切都很好 - 但是*在 JavaScript*中反序列化这些的最佳方法是什么，以便我实际上在适当的位置获得适当的对象实例，而不仅仅是奇怪的 $ref 字段？

我大概可以编写自己的通用反序列化器，但我必须想象其他人已经解决了这个问题，而且我不会重新发明任何轮子。不幸的是，我的谷歌技能显然不足以找到该解决方案:-)。

编辑：

我看到有一个关于这种事情应该如何工作的[IETF 提案草案。](https://datatracker.ietf.org/doc/html/draft-pbryan-zyp-json-ref-03)看起来总是乐于助人的 Douglas Crockford 已经[初步实现](https://github.com/douglascrockford/JSON-js/blob/master/cycle.js)了它。不幸的是，IETF 提案使用了与 Json.NET 不同的架构。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-08T23:54:02.540

好吧，我认为这会做到。我修改了 Crockford 的[cycle.js](https://github.com/douglascrockford/JSON-js/blob/master/cycle.js)来处理 Json.NET 使用的参考格式。而且因为 TypeScript 是一种比 JavaScript 更好的语言，所以我用 TS 重写了它。我当然不发誓它没有错误（如果有人指出它们，我会尝试修复它们），但它似乎可以处理我迄今为止抛出的复杂对象图。

```
export function retrocycle(obj: any): void {
    var catalog: any[] = [];
    catalogObject(obj, catalog);
    resolveReferences(obj, catalog);
}

function catalogObject(obj, catalog: any[]):void {

    // The catalogObject function walks recursively through an object graph
    // looking for $id properties. When it finds an object with that property, then
    // it adds it to the catalog under that key.

    var i: number;
    if (obj && typeof obj === 'object') {
        var id:string = obj.$id;
        if (typeof id === 'string') {
            catalog[id] = obj;
        }

        if (Object.prototype.toString.apply(obj) === '[object Array]') {
            for (i = 0; i < obj.length; i += 1) {
                catalogObject(obj[i], catalog);
            }
        } else {
            for (name in obj) {
                if (typeof obj[name] === 'object') {
                    catalogObject(obj[name], catalog);
                }
            }
        }
    }
}

function resolveReferences(obj: any, catalog: any[]) {

    // The resolveReferences function walks recursively through the object looking for $ref
    // properties. When it finds one that has a value that is an id, then it
    // replaces the $ref object with a reference to the object that is found in the catalog under
    // that id.

    var i:number, item:any, name:string, id:string;

    if (obj && typeof obj === 'object') {
        if (Object.prototype.toString.apply(obj) === '[object Array]') {
            for (i = 0; i < obj.length; i += 1) {
                item = obj[i];
                if (item && typeof item === 'object') {
                    id = item.$ref;
                    if (typeof id === 'string') {
                        obj[i] = catalog[id];
                    } else {
                        resolveReferences(item, catalog);
                    }
                }
            }
        } else {
            for (name in obj) {
                if (typeof obj[name] === 'object') {
                    item = obj[name];
                    if (item) {
                        id = item.$ref;
                        if (typeof id === 'string') {
                            obj[name] = catalog[id];
                        } else {
                            resolveReferences(item, catalog);
                        }
                    }
                }
            }
        }
    }
} 
```

和等效的JS：

```
function retrocycle(obj) {
    var catalog = [];
    catalogObject(obj, catalog);
    resolveReferences(obj, catalog);
}

function catalogObject(obj, catalog) {
    var i;
    if (obj && typeof obj === 'object') {
        var id = obj.$id;
        if (typeof id === 'string') {
            catalog[id] = obj;
        }
        if (Object.prototype.toString.apply(obj) === '[object Array]') {
            for (i = 0; i < obj.length; i += 1) {
                catalogObject(obj[i], catalog);
            }
        } else {
            for (name in obj) {
                if (typeof obj[name] === 'object') {
                    catalogObject(obj[name], catalog);
                }
            }
        }
    }
}

function resolveReferences(obj, catalog) {
    var i, item, name, id;
    if (obj && typeof obj === 'object') {
        if (Object.prototype.toString.apply(obj) === '[object Array]') {
            for (i = 0; i < obj.length; i += 1) {
                item = obj[i];
                if (item && typeof item === 'object') {
                    id = item.$ref;
                    if (typeof id === 'string') {
                        obj[i] = catalog[id];
                    } else {
                        resolveReferences(item, catalog);
                    }
                }
            }
        } else {
            for (name in obj) {
                if (typeof obj[name] === 'object') {
                    item = obj[name];
                    if (item) {
                        id = item.$ref;
                        if (typeof id === 'string') {
                            obj[name] = catalog[id];
                        } else {
                            resolveReferences(item, catalog);
                        }
                    }
                }
            }
        }
    }
} 
```

你使用它有点像这样（假设你已经连接了 SignalR 集线器）：

```
$.connection.roomHub.server.joinRoom()
    .done(function(room) {
        retrocycle(room);
    }); 
```

我还在 BitBucket 上为它创建了一个又快又脏的小存储库：[https://bitbucket.org/smithkl42/jsonnetdecycle](https://bitbucket.org/smithkl42/jsonnetdecycle)。

# c++ - C++ 字符串到 int 值

> ID：13782053
> 
> 赞同：0
> 
> 时间：2012-12-08T21:21:18.490
> 
> 标签：c++, string, time

在问这个之前我一直在到处寻找，但没有找到任何东西。在我的 Schaums Programming with C++ 书中没有提到我正在从中学习的任何一个......

使用 C++ 如何转换字符串，例如`"0:03:22" to 3 separate int values of`0, 03 `and`22`？假设它可能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T21:27:47.100

就像是

```
std::string str="0:03:22";
std::istringstream ss(str);
int hours,mins,seconds;
char skip;
if(ss >> hours >> skip >> mins >> skip >> seconds) {
    //success
} 
```

在这里，我们正在创建一个流，我们可以从中提取每个元素。

## 参考

[http://en.cppreference.com/w/cpp/io/basic_stringstream](http://en.cppreference.com/w/cpp/io/basic_stringstream)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:34:08.427

简单的格式化提取应该可以解决问题：

```
#include <sstream>

std::istringstream iss("0:03:22");

int a, b, c;
char d1, d2;

if (iss >> a >> d1 >> b >> d2 >> c >> std::ws &&
    iss.get() == EOF && d1 == ':' && d2 == ':')
{
    // use a, b, c
}
else
{
    // error!
} 
```

确保包括条件检查：如果输入操作成功，您只能从`a`,中读取！`b``c`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T21:27:54.907

使用[sscanf](http://www.cplusplus.com/reference/cstdio/sscanf/)。它还返回转换的值的数量：

```
 char* input = "0:03:22";
    int a, b, c;
    if (sscanf(input, "%d:%d:%d", &a, &b, &c) == 3)
    {
        printf("Three values converted: %u, %u, %u\n", a, b, c);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T21:25:47.820

您首先将字符串解析为 3 个标记，然后使用 std stringstream 或 boost lexical_cast 将标记转换为整数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-08T21:26:29.877

就个人而言，我会在 ':' 上使用 boost::split，获取字符串向量，然后对它们运行 boost::lexical_cast。我确实相信有一个更现代的转换库可能会取代 lexical_cast 但你必须自己寻找它。拆分位于字符串算法库中。

它会比一些替代品慢，但除非有理由超快，否则它会很容易创建和修改，所以它会赢。

# java - 为什么我不能通过将一个节点分配给下一个节点来从循环链表中删除它？

> ID：13782054
> 
> 赞同：1
> 
> 时间：2012-12-08T21:21:29.877
> 
> 标签：java, linked-list

该程序接受用户数据（姓名）并在屏幕上输出信息。然后询问用户要从链接列表中删除哪个名称。

我的程序涉及删除时遇到困难。我似乎无法删除节点，因为我正在使用“下一个”和“上一个”（见下文）恢复错误。

```
public static void main (String str[]) throws IOException
    {
        BufferedReader stdin = new BufferedReader (new InputStreamReader (System.in));        

        Node node, head, tail; // node is where string data is kept

        String name, delete;
        int count = 0;

        head = null; // initialize the head  and tail to null
        tail = null;

        System.out.print ("Enter a name. Type q to end inputting.");

        name = stdin.readLine ();

        node = new Node (name);
        node.next = head;
        head = node;
        tail = node;

        contestant = null;

        do // loop to create new nodes for the linked list using user data
        {

            System.out.print ("Enter a name. Type q to end.");
            name = stdin.readLine ();

            // create a new node if the user has not decided to quit
            if (!contestant.equals ("q"))
            {
                node = new Node (name);
                node.next = head;
                count++;
                head = node;  // update the head to point to the new front of the list

            }
        }
        while (!contestant.equals ("q"));  // loop continues until "q" selected      

        System.out.println ();

        do // display contestants
        {
            System.out.println (node.data);
            node = node.next;
        }
        while (node != null);  // loop until the end of lists is reached

        //////////////////////////////////////////Delete///////////////////////////////////////////

        boolean Delete; // check to see if deleted

        Node listNode; // node to delete

        System.out.println ("Enter a node to be removed:");
        delete = stdin.readLine ();

        listNode = new Node (delete);

        Node temp = listNode;

        do
        {
            if (temp.listNode () == node) 
            {
                node.prev = temp.previous (); 
                node.next = temp.next (); 

                if (prev != listNode.next) 
                {
                    prev.next () = next; 
                    next.previous () = prev; // removed 
                    return true; 
                }

                else
                {
                    return false; // only one node 
                }
                temp = temp.next (); 
            }
        }
        while (temp != listNode);   // couldnt remove
        return false; 
}
} 
```

节点类：

```
public class Node
{
    Node next, prev;
    String data;

    public Node (String data)
    {
        this.data = data;
    }
} 
```

# javafx - 将 MigLayout 与 JavaFX 一起使用时如何使舞台以正确的大小出现

> ID：13782055
> 
> 赞同：3
> 
> 时间：2012-12-08T21:21:43.193
> 
> 标签：javafx, miglayout, stage

我试图让舞台出现，大小自动调整为内容。

在 Swing 中，我总是调用 JFrame.pack()，而不管 LayoutManager，在 swt 中调用 Window.open() 时会自动发生

在 JavaFX 中，当使用 HBox 之类的东西时，这似乎也会自动发生：

```
Stage s = new Stage();
HBox p = new HBox(5);
for (int i=0;i<3;i++)
    p.getChildren().add(new Button("Hello"));
s.setScene(new Scene(p));
s.showAndWait() 
```

但是，使用 MigPane 时，原始布局不正确：

```
Stage s = new Stage();
MigPane p = new MigPane();
for (int i=0;i<3;i++)
    p.add(new Button("Hello"));
s.setScene(new Scene(p));
s.showAndWait();
s.showAndWait(); 
```

我无法发布图像，但第一次调用显示窗口太小，只有按钮的顶部可见。第二次调用以正确的布局显示它。

我怎样才能让它第一次正确显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-13T23:41:58.280

这是 MigPane 中的一个错误。[（看这里）](https://code.google.com/p/miglayout/issues/detail?id=8)

它在 miglayout-javafx-5.0-SNAPSHOT 中修复（需要 java8）。

# java - 你如何让 JSTL fmt 标签用 () 形成负数

> ID：13782062
> 
> 赞同：0
> 
> 时间：2012-12-08T21:22:01.520
> 
> 标签：java, jstl, fmtonly

如何让 JSTL fmt 标记用 () 格式化负数？例如，如果我有 -20，它将显示 (20)。正数是正常的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:50:37.157

我试图使用模式来做到这一点，但如果你使用 type="currency" 你会得到括号

```
<fmt:formatNumber type="currency" value="${line.volume}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T23:18:41.193

您还没有展示您尝试过的模式，但我希望是这样的：

“#;(#)”

会工作...

# .net - 将 .net EXE 文件引导到 X86 计算机上

> ID：13782064
> 
> 赞同：-3
> 
> 时间：2012-12-08T21:22:12.000
> 
> 标签：.net, operating-system, x86

这个问题说明了一切。我想知道是否有任何方法可以将 .net EXE 文件作为 X86 的操作系统启动。如果存在将 EXE 代码编译成 x86 的现有软件，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T21:32:16.083

不。

.NET 需要操作系统 (Windows) 来提供实际功能才能运行其应用程序，.NET 应用程序不可能作为操作系统本身运行。

# c# - 如何将字符串附加到字符串 []，赋值不起作用

> ID：13782066
> 
> 赞同：0
> 
> 时间：2012-12-08T21:22:19.063
> 
> 标签：c#, string

```
string[] string1;
string string2;
string1 = string2; 
```

这总是给我一个错误，说我无法转换`string`为`string[]`. 我怎么能“追加”`string2`到`string1`？我必须在其中添加多个`string`，因此如果有任何方法可以添加多个，`string`我`string1`将非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:24:22.093

您正在尝试将单个字符串分配到整个数组中`string`。

这是不可能的。

您需要选择要使用的数组元素。

更好的是，使用 a`List<string>`而不是数组 - 这是一个更好的结构，因为它不受其初始大小的限制。

```
List<string> string1 = new List<string>();
string string2;
string1.Add(string2); // Will add a null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:25:18.180

一种可能的解决方案是首先使用一个列表并将所有字符串存储在其中。然后，作为最后一步，将列表转换为数组。如果在开始存储之前*不知道要存储在数组中的字符串数量，*这尤其适用。
但是，这会对**性能产生一些影响**，并且**可能不是最佳可行的解决方案**，具体取决于您实际尝试执行的操作。

```
string string2 = "HelloWorld";
List<string> list = new List<string>();
list.Add(string2);
// repeat for all objects

string[] string1 = list.ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T21:25:55.663

要创建一个大小为 2 的字符串数组：

```
string[] string1= new string[2];
string string2 = "test"; //You must also assign something to your string before using it.
string1[0] = string2; 
```

连接两个字符串：

```
string string3 = "third";
string string4 = "fourth";
string string5 = string3 + string4; //string5 is now "thirdfourth" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T21:26:29.513

添加到`Array`不是微不足道的操作......如果您只需要拥有可以增长使用的字符串集合`List<string>`并且不要忘记创建对象：

```
List<string> string1 = new List<string>();
string string2 = "test";
string1.Add(string2); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-08T21:32:10.480

如果您*需要*使用 string[] 并附加元素，请这样做：

```
 string2 = string1 .Concat(new[] {
            stringa, stringb,stringc,stringd....
        }).ToArray(); 
```

或单个：

```
 string2 = string1.Concat(new[]{ string2 }).ToArray(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-08T21:39:11.837

`string1`是一个字符串数组。`string2`是一个字符串。

首先创建一个合适大小的数组

```
string1 = new string[10]; 
```

然后通过指定索引将字符串添加到这个数组中；

```
string1[0] = string2;
string1[1] = "Hello";
string1[2] = "World"; 
```

等等。在此示例中，您可以一直执行此操作`string[9]`，因为索引的范围从`0`到数组的大小 - 1。

如果事先不知道数组的大小，可以用a`List<string>`来代替。列表自动增长

```
var list = new List<string>();
list.Add(string2);
list.Add("Hello");
list.Add("World");

foreach (string s in list) {
    Console.WriteLine(s);
} 
```

或者

```
for (int i = 0; i < list.Count; i++) {
    Console.WriteLine(list[i]);
} 
```

# php - xPath 从表中获取值

> ID：13782067
> 
> 赞同：0
> 
> 时间：2012-12-08T21:22:20.830
> 
> 标签：php, xpath, domdocument

我刚刚开始使用 XPath，并且正在摆弄如何正确遍历表元素以查找 tr 中的 td 值。我试图只回显节点的兄弟值。我的表，例如：

```
<table class="123">
    <tbody>
        <tr>
            <td id="myYear">Year</td>
            <td>2001</td>
            <td>2002</td>
            <td>2003</td>
        </tr> 
        <tr>
            <td id="myScores">Scores</td>
            <td>82</td>
            <td>87</td>
            <td>94</td>
        </tr> 
    </tbody>
</table> 
```

我的php代码如下：

```
$dom = new DOMDocument;
$dom->preserveWhiteSpace = false;       
$dom->loadHTML($content);
$xpath = new DOMXpath($dom);

$myYear = $xpath->query('//table[@class="123"]/tbody/tr/td[@id="myYear"]');

foreach ($myYear as $year) {
    echo $year->nodeValue; //returns Year
    echo "<br>";

    $siblings = $year->nextSibling;

    foreach ($siblings as $value) {
        echo $value->nodeValue;
    }
} 
```

在上面的示例中，输出为“Year”，但我没有得到“myScores”的三个同级值的任何输出，例如 82、87、94。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T06:47:37.243

一些自学在这里进行！我只是像这样使用了以下兄弟姐妹：

```
$myYear = $xpath->query('//table[@class="123"]/tbody/tr/td[@id="myYear"]/following-sibling::*');

foreach ($myYear as $year) {
    echo $year->nodeValue; //returns Year
    echo "<br>";
} 
```

# android - 如何使用 libgdx 创建 Android UI 元素

> ID：13782071
> 
> 赞同：3
> 
> 时间：2012-12-08T21:23:05.420
> 
> 标签：android, user-interface, android-edittext, libgdx

我正在使用 libgdx 为 Android 开发游戏，我想知道如何制作 Android UI 元素，例如 EditText 和 Button。我知道它只适用于 Android，所以我会做这样的事情：

```
if (Gdx.app.getType() == Application.ApplicationType.Android ) {
...
} 
```

我发现 scene2d.ui 可能会有所帮助，但我不使用 scene2d（演员、舞台等）并且不太熟悉它。相反，我使用的是屏幕，如下所示：

```
public class GameScreen implements Screen {
...
} 
```

我在游戏原型防御（用 libgdx 编写）中看到这是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T17:24:40.377

所有 Android 特定的代码都必须存在于 Android 后端。您不能在公共项目中使用特定于 Android 的代码。

当前所有的 libGDX UI 元素都是基于 OpenGL 的自定义元素（因此它们在 libGDX 支持的所有平台上都有些一致）。没有包装 Android UI 原语的元素。对于按钮、标签或列表等简单的东西，我建议使用 libGDX UI 组件以实现可移植性。对于更复杂的元素，如文本输入或与平台交互（例如，共享或其他），您可以使用标准的“定义接口”方法来调用特定于平台的代码。

具体来说，假设您要弹出一个对话框让用户输入他们的姓名。定义

```
public interface PlatformUI {
   public void showHighscoreNameEdit();
} 
```

然后在你的 Android 项目中使用 Android 原语在一个类中实现这个接口。然后将此对象的一个​​实例传递给您的通用代码的构造函数。现在通用代码可以“调出”到Android层。

在 Android 初始化代码中是这样的：

```
AndroidUI androidUI = new AndroidUI(...);
initialize(new Game(androidUI)); 
```

在平台代码中是这样的：

```
if (timeToShowEditBox) {
  androidUI.showHighscoreNameEdit();
} 
```

正如@android developer 指出的那样，[AdMobInLibgdx wiki 页面](http://code.google.com/p/libgdx/wiki/AdMobInLibgdx)涵盖了这一点，目的是调用 Android 特定的 AdMob 库，在这种情况下非常相似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:14:01.790

仅在 android 项目中使用 android UI。

他们有[**一个**](http://code.google.com/p/libgdx/wiki/AdMobInLibgdx)如何为 admob 广告做的例子，这样你就可以在你的游戏上放广告。

# visual-studio - Visual Studio 在加载 UI 库时挂起

> ID：13782072
> 
> 赞同：9
> 
> 时间：2012-12-08T21:23:21.580
> 
> 标签：visual-studio, visual-studio-2012

我很难过，我正在考虑格式化我的硬盘并重新开始。我想我会尝试这个作为最后的努力。当我打开 Visual Studio 2012（不是解决方案，只是 VS 本身）时，它*通常会*挂起几分钟。过去的时间（见下面的 XML）它挂了大约 13 分钟。

`/log`下面是使用开关启动 VS 时来自 ActivityLog.xml 的片段。我不知道如何处理这些数据。许多谷歌搜索显示其他人有类似但不相同的问题。如果您注意到下面的时间戳，您会发现问题集中在“加载 UI 库”。知道这实际上意味着什么或如何解决吗？

注意：显示的文件夹中不存在 VsLogUI.dll，所以我不确定它为什么要访问它。我的另一台笔记本电脑上也不存在该文件。路径中有两个斜杠，它在一个名为 IDE* 的文件夹中查找。只是看起来一团糟。

```
 <entry>
    <record>1054</record>
    <time>2012/12/08 20:30:30.175</time>
    <type>Information</type>
    <source>VisualStudio</source>
    <description>End package load [Visual Studio Logging Package]</description>
    <guid>{2DC9DAA9-7F2D-11D2-9BFC-00C04F9901D1}</guid>
  </entry>
  <entry>
    <record>1055</record>
    <time>2012/12/08 20:33:51.723</time>
    <type>Information</type>
    <source>VisualStudio</source>
    <description>Loading UI library</description>
    <guid>{2DC9DAA9-7F2D-11D2-9BFC-00C04F9901D1}</guid>
    <path>C:\Program Files (x86)\Microsoft Visual Studio 11.0\\Common7\IDE*\VsLogUI.dll</path>
  </entry>
  <entry>
    <record>1056</record>
    <time>2012/12/08 20:42:28.350</time>
    <type>Information</type>
    <source>VisualStudio</source>
    <description>Entering function CVsPackageInfo::HrInstantiatePackage</description>
    <guid>{F384B236-B4A9-401B-BC58-3106E3ACA3EC}</guid>
  </entry> 
```

**编辑 - 我在下面有这个作为答案，但它没有用。它适用于 VS 的几次启动，但在安装了一些扩展后，延迟再次发生。我被困住了。**

虽然我不知道为什么会发生这种情况，但我似乎找到了解决方法。创建文本文件并将其重命名为 VsLogUI.dll 后，VS 2012 开始快速打开。显然，该文件只需要存在。我把它放在这里：

> C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\

我敢打赌，这种变通办法也会奏效，尽管我有点害怕尝试它，因为它正在更改注册表。我想我可以先备份注册表。无论如何，这出现在注册表中：

> HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\MSDN\8.0\Packages{2DC9DAA9-7F2D-11d2-9BFC-00C04F9901D1}

它有一个名为 SatelliteDll 的子文件夹。它有一个名为 DllName 的属性，其值为 VsLogUI.dll。我敢打赌，如果我删除该注册表项，问题就会消失。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-20T13:20:38.740

当我的 Fusion Log 文件夹中有很多数据（~5 GB）时，我遇到了这个问题。通过在此处查看注册表来检查是否启用了 Fusion Log：

HKLM\Software\Microsoft\Fusion\ForceLog

此键告诉您将数据登录到的位置：

HKLM\Software\Microsoft\Fusion\LogPath

转储内容，希望您的加载速度恢复正常。

# java - 在 Android 中检查电池和接收状态

> ID：13782080
> 
> 赞同：0
> 
> 时间：2012-12-08T21:24:13.890
> 
> 标签：java, android

我正在寻找一个简单的 Util 类，它具有返回各种电话状态的功能，例如电池电量、接收状态、充电器连接等。我不想监视状态，只是每隔一段时间查询一次（onButtonClick ）。

如果不使用意图等，我还没有找到一种简单的方法。有没有办法查询某个类？

我也不知道如何在不扩展活动的类中做到这一点。

我正在使用 Android API 8。谢谢。

# android - 数据库的ORMLite更新

> ID：13782084
> 
> 赞同：17
> 
> 时间：2012-12-08T21:24:25.323
> 
> 标签：android, database, ormlite

我实际上正在开发一个使用 ORMLite 库的应用程序（顺便说一句，这很棒），但我是使用它的初学者。

我对设备内部数据库的更新有疑问。

假设有人在 Google Play 上下载了我的应用程序。几个月后，我肯定会用新条目填充一些表格。

当这个人正在更新应用程序时，我怎样才能用我的新条目更新数据库并将旧条目保留在其中。

更清楚地说，假设用户在我的应用程序中回答了问题。当我将介绍新问题时，当他更新我的应用程序**并保留**已经回答的问题时，我如何将它们插入数据库？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-06-05T17:50:54.843

> 当这个人正在更新应用程序时，我怎样才能用我的新条目更新数据库并将旧条目保留在其中。

这个想法是使用传递给`onUpgrade(...)`方法的版本号。使用[ORMLite](http://ormlite.com/)，该`OrmLiteSqliteOpenHelper.onUpgrade(...)`方法需要一个`oldVersion`和`newVersion`数字。然后，您可以将转换代码写入能够从旧格式转换数据并更新架构的应用程序。

有关更多信息，请参阅[有关升级架构的 ORMLite 文档](http://ormlite.com/docs/upgrade-schema)。

引用，您可以执行以下操作：

```
if (oldVersion < 2) {
  // we added the age column in version 2
  dao.executeRaw("ALTER TABLE `account` ADD COLUMN age INTEGER;");
}
if (oldVersion < 3) {
  // we added the weight column in version 3
  dao.executeRaw("ALTER TABLE `account` ADD COLUMN weight INTEGER;");
} 
```

如果您有需要转换的现有数据，那么您应该尽可能在 SQL 中进行转换。

另一种选择是拥有一个`Account`实体和一个`OldAccount`指向相同表名的实体。然后您可以使用 读取`OldAccount`实体`oldAccountDao`，将它们转换为`Account`实体，然后使用`accountDao`返回将它们更新到同一个表。您需要注意这里的对象缓存。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-11-24T01:32:15.900

我这样做：

```
@Override
public void onUpgrade(SQLiteDatabase database, ConnectionSource connectionSource, int oldVersion, int newVersion) {

    switch (oldVersion) {
    case 1:
        updateFromVersion1(database, connectionSource, oldVersion, newVersion);
        break;
    case 2:
        updateFromVersion2(database, connectionSource, oldVersion, newVersion);
        break;
    default:
        // no updates needed
        break;
    }

}

private void updateFromVersion1(SQLiteDatabase database, ConnectionSource connectionSource, int oldVersion, int newVersion) {
    // do some stuff here
    onUpgrade(database, connectionSource, oldVersion + 1, newVersion);
}

private void updateFromVersion2(SQLiteDatabase database, ConnectionSource connectionSource, int oldVersion, int newVersion) {
    // do some stuff here
    onUpgrade(database, connectionSource, oldVersion + 1, newVersion);
} 
```

这将独立于他即将到来的数据库版本增量更新用户数据库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-08T22:35:39.090

资料很少，不清楚你的表结构是否有变化。

**a)**如果不改变数据库结构。

1 在程序的新版本中，当您开始使用当前版本检查以前保存的版本（例如在首选项中）时（参见 PackageManager.getPackageInfo）

已保存 = 0 - 用户刚刚安装了新版本

已保存 < 当前 - 用户更新您的程序

2 将新数据添加到数据库

3 保存当前版本的首选项

**b)**如果表结构发生了变化（添加或删除字段）

1 增加数据库的版本号（请参阅您的扩展 OrmLiteSqliteOpenHelper 类）

2 当用户第一次运行您的程序时，将调用方法“onUpgrade”（在您的扩展 OrmLiteSqliteOpenHelper 类中），该方法将转移到新旧版本号。

*   读取缓存中的现有数据（临时）
*   重新创建表
*   从缓存中添加数据 + 您的新数据

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-11T17:06:10.587

我不喜欢在每次升级时删除数据库，或者在添加每个字段后编写更新代码，所以......

我正在尝试这样做：

```
@Override
public void onUpgrade(SQLiteDatabase database, ConnectionSource connectionSource, int oldVersion, int newVersion) {
    ArrayList<String> tableNames = getTableNames(database);
    for (Class clazz : daoClasses) {
        try {
            Annotation annotation = clazz.getAnnotation(DatabaseTable.class);
            if (annotation != null && annotation instanceof DatabaseTable) {
                String tableName = ((DatabaseTable) annotation).tableName();
                if (tableName.isEmpty()) {
                    tableName = clazz.getSimpleName().substring(0, 1).toLowerCase() + clazz.getSimpleName().substring(1);
                }
                if(!tableNames.contains(tableName)){
                    TableUtils.createTable(connectionSource, clazz);
                } else {
                    addColumns(database, tableName, clazz);
                }
            }
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
}

private ArrayList<String> getTableNames(SQLiteDatabase database){
    ArrayList<String> tableNames = new ArrayList<>();
    Cursor cursor = database.rawQuery("SELECT name FROM sqlite_master WHERE type='table'", null);
    if (cursor.moveToFirst()) {
        while ( !cursor.isAfterLast() ) {
            tableNames.add(cursor.getString(0));
            cursor.moveToNext();
        }
    }
    cursor.close();
    return tableNames;
}

private void addColumns(SQLiteDatabase database, String tableName, Class clazz){
    Cursor mCursor = database.rawQuery("SELECT * FROM " + tableName + " LIMIT 0", null);
    for (Field field : clazz.getDeclaredFields()) {
        try {
            DatabaseField annotationField = field.getAnnotation(DatabaseField.class);
            if (annotationField != null && !annotationField.foreign()){
                String columnName = field.getName();
                boolean hasColumn = mCursor.getColumnIndex(columnName) != -1;
                if (!hasColumn) {
                    String columnType = field.getType().getSimpleName();
                    if(columnType.equals(String.class.getSimpleName())){
                        columnType = "TEXT";
                    } else {
                        columnType = columnType.toUpperCase();
                    }
                    database.execSQL(MessageFormat.format("ALTER TABLE `{0}` ADD COLUMN {1} {2};", tableName, columnName, columnType));
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    mCursor.close();
} 
```

我希望这段代码可以更好。

在这里，我不会删除从 dao 中删除的旧表和列，也不会创建外部字段（我不确定是否需要它）。

# objective-c - NetBeans 可以用来编写 Objective-C 程序吗？

> ID：13782085
> 
> 赞同：5
> 
> 时间：2012-12-08T21:24:34.980
> 
> 标签：objective-c, netbeans

我想在 Windows 机器上学习 Objective-C（仅是语言本身，而不是 Cocoa touch 等）。我看到了下面的链接：

[是否可以在 Windows 中执行 Objective-C 程序？](https://stackoverflow.com/questions/1903869/is-it-possible-to-execute-objective-c-programs-in-windows)

但他们都提供命令行工具，我正在寻找一个 IDE。我想知道是否可以在 NetBeans 上编写 Objective-C。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-06T09:36:05.253

在 Windows 上 dev-cpp 是唯一真正的选择。它通常已经附带了所有必需的工具。但是我强烈建议获取最新的 mingw 并设置 devcpp 以使用该版本。我也有一个非常基本的运行时的源代码。因此，如果您不想使用现有的，请随时询问。

- 基本设置如下： -install devcpp -install mingw（确保安装 c、c++ 和 Objective-c） - 在 devcpp 中添加 mingw 编译器 - 为 *.m 和 *.mm 文件启用语法高亮

现在您需要做的就是创建 ac 或 cpp 项目。Mingw 会自动将 *.m 和 *.mm 文件编译为 Objective-c 代码。

# html - 在容器中居中 div，并让 div 为其子元素的宽度

> ID：13782086
> 
> 赞同：0
> 
> 时间：2012-12-08T21:24:40.003
> 
> 标签：html, css, margin

我希望 a`<div>`为其子元素的大小，但我也希望将其居中在包含`<div>`. 我怎样才能做到这一点？

[http://jsfiddle.net/xjCGM/1/](http://jsfiddle.net/xjCGM/1/)

在那个 jsfiddle 我尝试做`display: inline-block`，`margin: auto`但他们不一起工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:27:06.303

您可以使用`text-align: center`： http: [//jsfiddle.net/xjCGM/2/](http://jsfiddle.net/xjCGM/2/)（您很可能会`text-align: left`在元素本身上使用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:27:29.127

添加`text-align:center;`到`.container`div

**[jsFiddle 示例](http://jsfiddle.net/j08691/xjCGM/3/)**

# sql - 来自聚合查询的计算行

> ID：13782092
> 
> 赞同：0
> 
> 时间：2012-12-08T21:25:17.523
> 
> 标签：sql, ms-access

我正在尝试编写一个简单的聚合查询，但遇到了一些问题。

我有一个状态字段为“完成”或“未完成”的表格。我希望查询返回三行：完成数、未完成数和计算的完成百分比。

到目前为止，我有前两行

```
 SELECT Status, Count(*) as countNums FROM tblStuff GROUP BY Status 
```

所以这会返回类似

```
 Status    Countnums
 __________         
 Complete  100
 Incomplete 100 
```

而我想要的是

```
 Status    Countnums      Percent
 __________         
 Complete  100             50
 Incomplete 100            50 
```

或者

```
 Status    Countnums      
 __________         
 Complete  100            
 Incomplete 100           
 percentComplete     50 
```

虽然，我看不到后者将如何在行级别上工作。这是在 MS Access 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:26:23.863

您可以将现有`GROUP BY`查询用作子查询，并将其与另一个返回总计数的子查询交叉连接`tblStuff`。使用子查询值`[Percent]`在父查询中派生。

这对 Access 2007 有效（结果正确；没有语法错误）：

```
SELECT
    group_counts.Status,
    group_counts.countNums,
    (group_counts.countNums / total_count.total_nums * 100) AS [Percent]
FROM
    (
        SELECT Status, Count(*) AS countNums
        FROM tblStuff GROUP BY Status
    ) AS group_counts,
    (
        SELECT Count(*) AS total_nums
        FROM tblStuff
    ) AS total_count; 
```

请注意，这`Percent`是一个保留字。将其用作别名而不用方括号括起来会引发错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:27:19.457

在 SQL 服务器中

```
SELECT Status, Count(*) AS cnt, CAST( Count(*) as decimal) / (SELECT COUNT(*) FROM tblStuff) AS perc 
FROM tblStuff 
GROUP BY Status 
```

您甚至可以将完整计数保存在变量中

```
DECLARE @fcnt decimal

SELECT @fcnt = COUNT(*) FROM tblStuff
SELECT Status, Count(*) AS cnt,Count(*) / @fcnt AS perc 
    FROM tblStuff 
    GROUP BY Status 
```

在访问

```
SELECT tblStuff.Status, Count(*) AS cnt, (SELECT COUNT(*) FROM tblStuff as t1) AS fcnt, [cnt]/[fcnt] AS perc
FROM [tblStuff]
GROUP BY tblStuff.Status 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T21:27:28.970

这将很好地完成这项工作。

```
SELECT
   Status,
   Count(*) AS CountNums,
   Count(*) / DCount("*", "tblStuff") AS Pct
FROM
   tblStuff
GROUP BY Status 
```

你可以得到相关的总数，但这在性能上确实没有什么不同，并且可能更清晰。

# asp-classic - 当您将无法解析为整数的值乘以整数时，在 ASP Classic 中会发生什么？

> ID：13782097
> 
> 赞同：1
> 
> 时间：2012-12-08T21:26:13.837
> 
> 标签：asp-classic, type-conversion

假设你有类似的东西：

```
Dim x, y
x = Request("x")
y = x * 2 
```

如果 x 不能被解析为整数，是否会出现异常或者结果表达式是否会被解析为 int？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T21:34:30.663

解释器将尝试评估`x`为数字。如果值是数字（浮点数或整数），则代码有效，否则会发生类型不匹配错误。

# java - 查找网页内容的实际路径

> ID：13782113
> 
> 赞同：3
> 
> 时间：2012-12-08T21:27:50.283
> 
> 标签：java, file, jsp, tomcat, file-upload

我在 JSP 中做一个需要文件上传功能的小型 webb 应用程序。

问题是我无法找到如何获取我的 webcontents 文件夹的相对路径。我需要一种动态的方式来到达那里，这样我就可以将文件保存在相对于该路径的文件夹中。

到目前为止，我已经尝试过：

```
 String requestURI = request.getRequestURI();
  String contextPath = request.getContextPath();
  String realPath = request.getRealPath();
  String servletPath = request.getServletPath(); 
```

它们都没有给出实际的 WebContents 路径。我想有一种方法我忽略了但无法找出哪个方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:32:12.753

采用

```
request.getServletContext().getRealPath("/"); 
```

* * *

*   [`servletContext.getRealPath()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRealPath%28java.lang.String%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T13:47:43.390

不要那样做！首先，`getRealPath`仅当您的 web 应用程序扩展时才有效，其次，如果您重新部署您的应用程序，则整个上传都将被清除。

# php - PHP file included but code not working

> ID：13782114
> 
> 赞同：1
> 
> 时间：2012-12-08T21:27:53.527
> 
> 标签：php, mysql, include

I am trying to connect mysql from within PHP function. The credentials are stored in a separate PHP file, which I am including it inside the function. But when I run the script, I am getting following error:

```
Warning: mysql_query(): A link to the server could not be established in C:\xamp
p\htdocs\abc\test.php on line 12\. Access denied for user 'ODBC'@'localhost' (using password: NO)    

private function insertToMysql()
{
    include_once('connect_db.php');

    $connection = mysql_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD) or die('Oops connection error -> ' . mysql_error());
    mysql_select_db(DB_DATABASE, $connection) or die('Database error -> ' . mysql_error());

    //Queries

} 
```

I tried echoing the include_once and it returned 1\. This means, the connect_db.php is included, but somehow the constants are not loaded. What could be the issue??? The credentials are perfect and I verified them. I am not a newbie to PHP.

Contents of connect_db.php:

```
<?php
  define('DB_SERVER', 'localhost');
  define('DB_USERNAME', 'root');
  define('DB_PASSWORD', '<MyPassword>');
  define('DB_DATABASE', 'testdb');
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:43:45.087

remove connection handler

```
private function insertToMysql()
{
    include_once('connect_db.php');

    mysql_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD) or die('Oops connection error -> ' . mysql_error());
    mysql_select_db(DB_DATABASE) or die('Database error -> ' . mysql_error());

    //Queries

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T21:45:43.153

Seems like `$connection` is a local variable, you can fix this by making it global.

Do this like this.

```
include_once('connect_db.php');
$connection = mysql_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD) or die('Oops connection error -> ' . mysql_error());
mysql_select_db(DB_DATABASE, $connection) or die('Database error -> ' . mysql_error());

function insertToMysql()
{
    //Queries
    mysql_query('Some query');
} 
```

# php - 在 php 中使用 c# web 服务 (asmx)

> ID：13782116
> 
> 赞同：0
> 
> 时间：2012-12-08T21:28:26.977
> 
> 标签：php, jquery

我想将 c# web 服务与 PHP 和 jQuery 一起使用。下面的代码将带有 $.ajax 的数据发布到 php 代码中。但在 i=of url 中，我无法从 Web 服务获取任何数据。如何帮助我开发此代码

```
$.ajax({
          type: "POST",
          url: "http://www.w3schools.com/webservices/tempconvert.asmx/CelsiusToFahrenheit",
          dataType: 'jsonp',
          success: function(data) {alert('ok')},
          error  : function(e) {alert('error')}
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:31:01.920

您违反了[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。您不能向远程域发送 AJAX 请求。如果您想使用 AJAX 从 javascript 使用 ASMX Web 服务，则此服务必须位于与包含此脚本的页面相同的域中。

您似乎已`dataType: 'jsonp'`在请求中指定，但如果远程 ASMX 服务未配置为支持[`JSONP`](http://en.wikipedia.org/wiki/JSONP).

作为一种可能的解决方法，您可以编写一个新的 PHP 脚本，作为本地域和远程域之间的桥梁，然后将 AJAX 请求发送到 PHP 脚本。然后，此脚本将通过发送 HTTP 请求调用远程 Web 服务并返回结果：

```
$.ajax({
    type: 'POST',
    url: '/CelsiusToFahrenheit.php',
    success: function(data) { alert('ok') },
    error: function(e) { alert('error') }
}); 
```

`CelsiusToFahrenheit.php`然后您需要编写的脚本会将调用委托给远程域以调用实际的 ASMX 服务。有大量关于如何使用 PHP 调用 ASMX Web 服务的教程。这是一个：[从 PHP 调用 asp.net Web 服务，带有多个参数](https://stackoverflow.com/questions/9711502/call-asp-net-web-service-from-php-with-multiple-parameters)。

# python - 在文本文件中的某些单词之后提取数字

> ID：13782119
> 
> 赞同：4
> 
> 时间：2012-12-08T21:28:42.233
> 
> 标签：python, regex

我有一个大文本文件，我想只提取某些短语/单词之后的数字。

这个巨大的文本文件中有几十行，格式如下：

> 汽车的最佳 CV 模型：15778 是订单：2 阈值：0，AUC 为：0.7185 基因 aau_roc：0.466281

一种解决方案是只查看“for car: X”、“is order: X”、“threshold: X”、“Y gene aau_roc: X”之后的数字！

最后，我希望每行有 15778, 2, 0, 0.7185, 0.466281。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T21:43:09.297

```
>>> if line.startswith('Best CV Model'):
...     re.findall(r'\d+\.{0,1}\d*', line)
... 
['15778', '2', '0', '0.7185', '0.466281'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T21:44:53.730

由于您已经用[regex](https://stackoverflow.com/questions/tagged/regex)标记了您的问题，我怀疑您已经接近解决方案。你可以编写一个正则表达式模式来匹配你行中的所有数字。就像是：

```
pattern = r"for car: (\d+) is order:(\d+) threshold: (\d+) with AUC of : ([0-9.]+) gene aau_roc: ([0-9.]+)" 
```

请注意，我已将其与您的示例字符串完全匹配，包括`:`在几个地方的字符周围有一些奇怪的间距。仔细检查它是否确实适用于您的真实数据。

要使用它来搜索您的文本文件，我会使用`re.finditer`搜索整个文本并返回一个可迭代的：

```
import re

for model, order, threshold, auc, aau_roc in re.finditer(pattern, text):
     do_stuff() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T21:47:26.603

```
re.match('(?<=for car: )/n*',the_line); 
```

只需不断重复您需要的其他变量，并将它们存储在您想要的输出中。

# python - 将 int 值平均分配到两个列表中，其总和必须几乎相等

> ID：13782121
> 
> 赞同：1
> 
> 时间：2012-12-08T21:28:48.380
> 
> 标签：python, algorithm, python-2.7

我想将一个列表的 int 值均匀地分配到两个总和必须几乎相等的列表中。如果它们不完全相等，则应返回差值。

```
li=[5,8,13,27,14]
first_list=[27,8)
second_list=[14,13,5]
return sum(first_list)-sum(second_list) #3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T21:40:34.840

这是[**Partition Problem**](http://en.wikipedia.org/wiki/Partition_problem)的优化问题，即[NP-Complete](http://en.wikipedia.org/wiki/NP-complete)。

没有已知的多项式解决方案，但有一些启发式和近似算法。

此外，对于相对较小的整数，有一个可能可行的动态编程解决方案，或者如果输入（元素数量）相对较小 - 可以使用指数[蛮力](http://en.wikipedia.org/wiki/Brute-force_search)解决方案。

# java - 为什么在 Java 应用程序中第二次运行 sql 查询会挂起？

> ID：13782128
> 
> 赞同：0
> 
> 时间：2012-12-08T21:29:43.640
> 
> 标签：java, sql, oracle, grails, groovy

上下文：Grails 2.1，使用 Groovy SQL 执行 SQL 语句。数据库是在 RedHat VM 中运行的 Oracle 11G。Grails 以交互模式运行，尽管作为 WAR 运行在行为上没有区别。

通过 Groovy SQL，我发出了一个具有这种结构的 SQL 语句：

```
insert into...
select ... from... 
```

这会导致提取和插入@119K 行。当它成功运行时，它通常在一分钟内完成。

此语句在整个数据导入应用程序的上下文中运行，该应用程序通常总共需要大约 10 分钟才能运行并包含许多其他查询。

这是行为：

1.  我启动 Grails 应用程序
2.  我开始在应用程序中导入数据。它按预期运行并导致数据发生重大变化
3.  我再次启动应用程序。前几十个查询运行良好
4.  在上述较大的插入处，它挂起。

所以：第一次通过，没有问题。第二次通过，它每次都挂在同一个地方。

如果我重新启动应用程序，它会再次运行良好。

这就是它变得奇怪的地方：我会让这个东西旋转一段时间，如果我关闭数据库，查询会继续运行。我没有错误。

所以，如果这种行为听起来很熟悉，我对解决方案很感兴趣。

如果你有关于如何诊断的想法，我也对这些感兴趣。我是一名应用程序开发人员，并且比 Oracle 方面更熟悉 Java 方面，fwiw。我正在尝试寻找一个内部的 Oracle DBA 来提供帮助，但至少在短期内我只能靠我自己。

谢谢你的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:39:04.550

由于您说重新启动应用程序使其再次工作表明它在 SQL 端没有任何东西，例如索引，因此它可能与 Hibernate 会话大小有关，您可能会最大化会话，[请参阅这个可能有帮助的答案](https://stackoverflow.com/questions/12558640/best-way-to-prevent-progressively-slower-row-inserts-as-table-grows-in-grails/12576483#12576483)

# java - Android：将文件保存到 SD 卡时出错

> ID：13782129
> 
> 赞同：1
> 
> 时间：2012-12-08T21:29:49.453
> 
> 标签：java, android, image, permissions, sd-card

我一直在尝试将 JPG 图像保存到 SD 卡，以便将其缩小并显示在 ImageView 中（由于原始大小导致内存不足错误）。

这是我用来保存文件的方法：

```
public void saveImage(String src) throws IOException{
        URL url = new URL (src); 
        InputStream input = url.openStream(); 
        try {     
            File storagePath = Environment.getExternalStorageDirectory();
            OutputStream output = new FileOutputStream (new File(storagePath, "myImage.jpg"));     
            try {         
                byte[] buffer = new byte[1024];         
                int bytesRead = 0;         
                while ((bytesRead = input.read(buffer, 0, buffer.length)) >= 0) {
                        output.write(buffer, 0, bytesRead);         
                }     
            }  
            finally {         
                output.close();     
            } 
        } 

        finally {     
            input.close(); 
        }
    } 
```

然后是当我调用该方法然后尝试将按比例缩小的图像加载到内存中并将其放入 ImageView 中时：

```
try {
            saveImage(src);
        } catch (IOException e) {
            e.printStackTrace();
        }

        BitmapFactory.Options options = new BitmapFactory.Options();

        options.inSampleSize = 20;

        File storagePath = Environment.getExternalStorageDirectory();
        File file = new File(storagePath, "myImage.jpg");

        Bitmap scaledDownImage = BitmapFactory.decodeFile(file.getAbsolutePath(), options);

        imageFrame1.setImageBitmap(scaledDownImage); 
```

但是，当我尝试运行它时，我收到 LogCat 消息说：

> “java.io.FileNotFoundException：/mnt/sdcard/myImage.jpg：打开失败：EACCES（权限被拒绝）”

我也确保添加

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

到清单。

有没有人有任何想法？

编辑：错误发生在第 107 行和第 72 行，这意味着它发生在我尝试保存图像时。

砰：有人吗？真的很感激一些建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T10:48:49.853

问题解决了！原来我需要改变的是 saveImage 方法中字节缓冲区的大小。它在 1024，但在将其提高到 8192 后，它工作正常！

谢谢大家的建议。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-08T21:49:22.107

使用以下内容：

```
String  path = Environment.getExternalStorageDirectory()
                                .toString() + File.separator + "myImage.jpg";
OutputStream output = new FileOutputStream (path,true); 
```

# database - 在Sqlite中定义表的两个字段之间的唯一关联

> ID：13782130
> 
> 赞同：1
> 
> 时间：2012-12-08T21:29:50.377
> 
> 标签：database, sqlite, associations, unique

我知道这里有很多这样的问题，但这并不是我要问的典型问题。我有一张这样的桌子：

```
CREATE TABLE example (
   field1 INTEGER NOT NULL,
   field2 INTEGER NOT NULL,
   field3 TEXT,
   PRIMARY KEY(field1,field2)
   FOREIGN KEY(field2) REFERENCES example2(field2)
); 
```

我要禁止的是一个 field3 有多个 field1，但允许的值具有相同的 field1 和 field3 但不同的 field2。事实上，我想要一个唯一的 field1 可用于每个 field3，但如果 field2 不同，则每个 field1 有多个 field3。

为了帮助你理解我的意思，我给你一些例子：

```
INSERT INTO example VALUES(1,1,"apple");
INSERT INTO example VALUES(1,2,"apple"); allowed
INSERT INTO example VALUES(2,1,"apple"); forbidden
INSERT INTO example VALUES(2,3,"apple"); forbidden 
```

PS：PRIMARY_KEY(field1,field2,field3) 和 UNIQUE(field1,field3) 不是答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T11:17:45.453

您的关联不能通过 some `PRIMARY KEY`/ `UNIQUE`or some`CHECK`约束来强制执行（因为 SQLite[不允许](http://www.sqlite.org/lang_createtable.html#ckconst)`CHECK`表达式中的子查询）。

您的问题是该表未正确[规范化](http://en.wikipedia.org/wiki/Database_normalization)，即它不是[第二范式](http://en.wikipedia.org/wiki/Second_normal_form)。该`field3`列可能应该移动到一个单独的表中（但是如果不知道这些值的含义就很难说）。

# gwt - gwtp Horizo ntalPanel verticalAlignment="ALIGN_MIDDLE"

> ID：13782131
> 
> 赞同：2
> 
> 时间：2012-12-08T21:29:51.463
> 
> 标签：gwt, uibinder

请在下面找到 uibinder 代码：

但是，该按钮在浏览器中未正确对齐。但它在 Eclipse 设计器中正确显示。

请帮我解决这个问题。

```
<g:HorizontalPanel ui:field="a" width="100%" height="100%" horizontalAlignment="ALIGN_CENTER" verticalAlignment="ALIGN_MIDDLE">
        <g:Button width="150px" height="30px" ui:field="button">Click ThisThis</g:Button>
</g:HorizontalPanel> 
```

谢谢，班纳特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T06:42:18.477

将需要在元素中设置对齐的 DockPanel、Horizo​​ntalPanel 或 VerticalPanel 的任何子代包裹起来。

```
<g:HorizontalPanel>
    <g:cell width="800px" horizontalAlignment="ALIGN_RIGHT">
        <g:Button ui:field="closeButton" text="Close" />
    </g:cell>
</g:HorizontalPanel> 
```

看看这个[链接](http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/ui/CellPanel.html)。

# r - 从 R 中的不规则数据框创建边缘列表（用于网络分析）

> ID：13782132
> 
> 赞同：1
> 
> 时间：2012-12-08T21:30:01.647
> 
> 标签：r, social-networking, data-mining

我有一个参差不齐的数据框，每一行作为一个或多个实体的时间出现，如下所示：

```
(time1) entitya entityf entityz
(time2) entityg entityh
(time3) entityo entityp entityk entityL
(time4) entityM 
```

我想从第二个向量（节点列表）中找到的实体子集创建用于网络分析的边缘列表。我的问题是我不知道：

1）。如何仅对节点列表中的实体进行子集化。我在考虑

```
datanew<- subset(dataold, dataold %in% nodelist) 
```

但它不起作用。

2）。如何将参差不齐的数据框制作成两列边缘列表。在上面的示例中，它将转换为：

```
entitya entityf
entitya entityz
entityz entityf
... 
```

不知道怎么做。非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T12:51:56.737

试试这个：

```
# read your data 

dat <- strsplit(readLines(textConnection("(time1) entitya entityf entityz
(time2) entityg entityh
(time3) entityo entityp entityk entityL
(time4) entityM")), " ")

# remove (time)

dat <- lapply(dat, `[`, -1)

# filter

nodelist <- c("entitya", "entityf", "entityz", "entityg", "entityh",
              "entityo", "entityp", "entityk")

dat <- lapply(dat, intersect, nodelist)

# create an edge matrix

t(do.call(cbind, lapply(dat[sapply(dat, length) >= 2], combn, 2))) 
```

最后一步可能需要消化很多，所以这里有一个突破：

*   `sapply(dat, length)`计算列表元素的长度
*   `dat[... >= 2]`仅保留至少包含两项的列表元素
*   `lapply(..., combn, 2)`创建所有组合：宽矩阵列表
*   `do.call(cbind, ...)`将所有组合绑定到一个宽矩阵中
*   `t(...)`转置成一个高矩阵

# javascript - 如何使 jquery 插件 bigtext 可拖动和可编辑

> ID：13782133
> 
> 赞同：2
> 
> 时间：2012-12-08T21:30:05.823
> 
> 标签：javascript, jquery, draggable, contenteditable

通过这个论坛搜索非常宝贵，但我现在有一个问题我找不到任何答案，我是 jQuery 和 javascript 或任何编码的新手，所以请多多包涵，我会尽量解释清楚我可以。

我正在尝试使用 jquery 插件 bigtext 创建一个文本框，我需要该文本框是可拖动的并且能够由用户编辑，并且每个键上的文本都会更新。文本框将具有设定的宽度。

在这个论坛上使用一些过去的答案我已经能够创建一个可拖动的文本框但是当用户输入文本时 bigtext 插件不再工作并且不会调整文本高度以适应宽度

HTML

```
<div id="d" >
<div id="e" contenteditable="true">edit me</div>
</div> 
```

JS

```
$("#d").draggable()
.click(function () {
$(this).draggable({
    disabled: false
});
}).dblclick(function () {
$(this).draggable({
    disabled: true
});
});
$("#d").bigtext(); 
```

CSS

```
#d {

width:300px;
border: 1px dashed;
}​ 
```

[http://jsfiddle.net/grhm/r6GSS/3/](http://jsfiddle.net/grhm/r6GSS/3/)

我还能够创建一个文本框，用户在其中输入文本并输出到另一个框，bigtext 插件在输出文本框中工作，但是当我尝试使框可拖动时它停止工作

HTML

```
Enter text Here <input id="input" value="Edit This">
<div id="Mainbox" style="width:300px;border:1px dashed">
<div id="preview">Edit This</div>
</div> 
```

JS

```
$(function () {

var update = function () {
    $(" #preview").text($("#input")[0].value);
    $("#Mainbox").bigtext().draggable();
    }
    $("#input").on("keyup", update)
    update();
}); 
```

[http://jsfiddle.net/TgafU/4/](http://jsfiddle.net/TgafU/4/)

任何帮助，将不胜感激。

# jquery - 如何使用键盘箭头键在 HTML 元素之间导航

> ID：13782135
> 
> 赞同：2
> 
> 时间：2012-12-08T21:30:16.833
> 
> 标签：jquery, keyboard, navigation

我希望我的网页允许使用键盘上的左右箭头键在文本块之间导航。我认为这需要 Jquery。

我从字面上阅读了十几篇关于 Stackoverflow 的帖子，这些帖子似乎在没有真正回答的情况下解决了这个问题……所以请不要将其作为重复问题关闭

更新：我只是想使用箭头键在文章（如博客文章）之间滚动。我想要的只是将页面滚动到下一个分隔符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:48:56.303

这是我为您制作的 JS Fiddle：http: [//jsfiddle.net/3NAwz/](http://jsfiddle.net/3NAwz/)

此代码显示包含文本的 div 标记，在包装器内浮动到左侧。然后将其包含在另一个小于整个文本（其中一部分）的包装器中。

然后使用 jQuery 使用箭头键滚动内容。如果它已经在动画，则该`.not(":animated")`部分会阻止它动画。在一些 5 岁的孩子决定非常不耐烦之后，使用它只会让它变得更好，而无需排长队。

**HTML**

```
<div class="wrapper">
    <div class="inner">
        <div class="text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas aliquam erat vitae nibh convallis quis luctus turpis dignissim. Suspendisse imperdiet interdum consequat. Curabitur erat nisl, gravida et aliquet vitae, faucibus vitae lacus.</div>
        <div class="text">Donec dignissim lorem eu augue tincidunt facilisis. Etiam leo purus, tristique eu tempus gravida, auctor sit amet velit. Quisque mattis, libero ut pharetra luctus, tellus justo viverra elit, sodales scelerisque ipsum magna vel felis.</div>
        <div class="text">Pellentesque ligula mauris, volutpat id molestie posuere, fermentum eu lacus. Donec quis metus nisi, et accumsan massa. Morbi eget augue eget lorem semper cursus sit amet non tortor. Aliquam tempor rhoncus odio sit amet fermentum.</div>
    </div>
</div>​ 
```

**CSS**

```
.wrapper {
    width:340px;
    overflow:hidden;
    border:1px #000 solid;
}
.inner {
    width:1020px;
}
.text {
    float:left;
    width:300px;
    padding:20px;
    font-size:14px;
    font-weight:bold;
    font-family:Arial;
} 
```

​<strong>jQuery

```
$(document).ready(function() {
    $(document).keyup(function(event) {
        var key = event.which;
        if(key == 37) { // Left arrow key
            $(".wrapper").not(":animated").animate({ scrollLeft: "-=340px" }, 500);
        }
        if(key == 39) { //Right arrow key
            $(".wrapper").not(":animated").animate({ scrollLeft: "+=340px" }, 500);
        }
    });
});​ 
```

# algorithm - 回溯尾递归算法可以转换为迭代吗？

> ID：13782136
> 
> 赞同：13
> 
> 时间：2012-12-08T21:30:18.327
> 
> 标签：algorithm, data-structures, recursion, tail-recursion

让我们来看看骑士巡回赛的问题。那可以转换为迭代吗？让我困惑的是回溯部分。如何在循环中回溯？当我从递归到迭代时，我是否必须使用堆栈数据结构来实现回溯？

* * *

我在这里以更好的方式问了这个问题：[有人可以通过代码描述一个使用迭代而不是递归进行回溯的实际示例吗？](https://stackoverflow.com/questions/13782410/can-someone-describe-through-code-a-practical-example-of-backtracking-with-itera)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-08T22:11:36.147

不，不可能。

通过使用显式 LIFO 数据结构“模拟”递归，所有递归算法都可以迭代*实现。*但这不会改变*算法*本身，即算法保持递归，而不是迭代。

同时，回溯是递归的固有属性。如果你有回溯，你就有递归。您可能知道，允许直接真正转换为迭代的一类算法是尾递归算法。但是回溯的存在立即意味着您的递归不是尾递归。

您可以做的是尝试发明一种不需要回溯的算法。当然，这将是一个完全不同的算法，而不是将原始递归算法转换为迭代形式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-08T21:33:00.623

所有递归算法都可以转换为迭代算法，反之亦然。这是 Church-Turing 论文的直接结果。

它可能并不总是很明显（或微不足道），但任何算法都可以表示为递归或迭代过程；对于一般情况，这个问题之前已经回答[过](https://stackoverflow.com/a/933979/201359)。

至于*如何*，有几种技术可以应用于从一种风格到另一种风格，例如看看[这个](https://stackoverflow.com/questions/159590/way-to-go-from-recursion-to-iteration)答案，或者更详细的讨论阅读[这篇](http://cs.saddleback.edu/rwatkins/CS2B/Lab%20Exercises/Stacks%20and%20Recursion%20Lab.pdf)解释如何使用堆栈来消除递归的文章。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-08T21:33:17.287

基本上，每个递归都可以实现为循环+堆栈，因为它基本上是在机器（硬件）级别上实现的——只是一堆分支和一个用于存储返回地址和参数的堆栈。

在不满足条件时重复循环，而不是递归调用 - 只需将下一次迭代（可能还有最后一个状态）的参数推送到堆栈，然后返回循环的起点。

* * *

**编辑：（**因为很明显你在谈论尾递归回溯，而不是简单的递归）：

来自[维基百科](http://en.wikipedia.org/wiki/Tail_call)：`In computer science, a tail call is a subroutine call that happens inside another procedure as its final action`。据我所知，**具有多个递归调用的函数 - 根据定义不是尾递归**，并且由于回溯算法确实有不止一个调用，它们不是“尾递归”。

另请注意 - 只有循环和恒定空间的程序可以转换为在多项式时间内运行的第二个程序 P'（因为最多有`2^CONST`状态，基本上是`CONST'`，并且验证每一个都在多项式时间内完成- 所以总`CONST'*p(n)`时间，仍然是多项式），所以**除非[`P=NP`](http://en.wikipedia.org/wiki/P_versus_NP_problem)，这是不可能的，**因为它允许我们通过将回溯解决方案转换为基于循环的多项式解决方案来在多项式时间内解决[SAT 。](http://en.wikipedia.org/wiki/Boolean_satisfiability_problem)（而且我相信进一步减少[HP](http://en.wikipedia.org/wiki/Halting_problem)是可行的，以表明无论如何都不可能）。

# maven - 是否可以通过 Jenkins 使用具有多个模块的一个构建作业分别部署多个模块？

> ID：13782140
> 
> 赞同：0
> 
> 时间：2012-12-08T21:30:59.963
> 
> 标签：maven, deployment, build, jenkins, jenkins-plugins

我正在尝试使用 jenkins 构建一个包含多个模块的作业，并将这些多个模块分别部署在一个盒子上。简化后的maven依赖结构如下图：

```
|-- 一个
| `-- pom.xml
              |-- 乙
              | `-- pom.xml
              |-- C
              | `-- pom.xml
              |-- D
              | `-- pom.xml

```

我成功地获得了 B、C、D 的 3 个发布包。但是，当我在每个单独的部署作业中表示要部署的模块时，jenkins 不支持分别部署这 3 个包。相反，一个构建作业只有一个构建 ID，并且只有 A 是 jenkins 部署的合法可交付成果。除了使用链式构建作业进行多次构建之外，还有什么想法或解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T12:29:32.987

使用*maven-deploy-plugin*将所有模块（无论它们位于哪个级别）自动部署到远程 Maven 存储库。

它[易于使用](http://maven.apache.org/plugins/maven-deploy-plugin/usage.html)，只需在`<distributionManagement>`您的父 pom 中添加一个部分，`<server>`如有必要，在您的 settings.xml 中配置该部分，并将`deploy`目标添加到您的 Jenkins 构建作业中。

*maven-deploy-plugin*将为您的 reactor 项目的每个模块自动执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T06:42:35.387

目前尚不清楚您是否正在寻找**过滤**“jar”，即在“部署”阶段推出的工件。如果您正在寻找过滤，您可以尝试设置排除模式或包含模式（注意 - 我们使用的是人工插件） Post Build Actions 的屏幕截图 -

![在此处输入图像描述](../Images/1ac40b05bdc2a3271277f7f053623693.png)

# xslt - 调用模板 - 更新现有元素

> ID：13782142
> 
> 赞同：2
> 
> 时间：2012-12-08T21:31:22.053
> 
> 标签：xslt, xslt-1.0, xsl-stylesheet

这是我的问题。

我有一些带有调用模板的预构建 XSLT，另一个文件中的模板代码我可以编辑模板代码的内容，但不能编辑主 XSLT。

## 我当前的代码

**School_College.xsl（我无法编辑）**

```
<xsl:stylesheet version="1.0"
            xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            xmlns:xsd="http://www.w3.org/2001/XMLSchema"
            xmlns:ns0="http://www.myschool.org"
            xmlns:ora="http://schemas.oracle.com/xpath/extension"
            xmlns:ns1="http://www.mycollege.org"

         <xsl:import href="school_college_custom.xsl"></xsl:import>

 <xsl:template match="/">
   <ns1:College>
     <ns1:Batch>
       <ns1:StudentsCount>
         <xsl:value-of select="/ns0:School/ns0:Class/ns0:NoOfStudents"/>
       </ns1:StudentsCount>
       <ns1:TeachersCount>
          <xsl:value-of select="/ns0:School/ns0:Class/ns0:NoOfTeachers"/>
       </ns1:TeachersCount>
       <ns1:BatchStartTime>
          <xsl:value-of select="/ns0:School/ns0:Class/ns0:ClassStartTime"/>
       </ns1:BatchStartTime>

       <xsl:call-template name="batch_ext"></xsl:call-template>

     </ns1:Batch>
   </ns1:College>
</xsl:template> 
```

**school_college_custom.xsl（我可以修改这个，从上面导入和调用）**

```
<?xml version="1.0" encoding="windows-1252" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:ns1="http://www.mycollege.org">

  <xsl:template name="batch_ext">
        <ns1:BatchEndTime>
          <xsl:value-of select="'5PM'"/>
        </ns1:BatchEndTime>
        <ns1:BreakTime>
          <xsl:value-of select="'1PM'"/>
        </ns1:BreakTime>
  </xsl:template>
</xsl:stylesheet> 
```

**源 XML：**

```
<?xml version="1.0" encoding="UTF-8" ?>
  <School xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.myschool.org xsd/school.xsd"
    xmlns="http://www.myschool.org">
   <Class>
     <NoOfStudents>10</NoOfStudents>
     <NoOfTeachers>2</NoOfTeachers>
     <ClassStartTime>9AM</ClassStartTime>
  </Class>
 </School> 
```

**目标 XML：（当前）**

```
<?xml version="1.0" encoding="UTF-8" ?>
<College xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://www.mycollege.org ../xsd/college.xsd"
     xmlns="http://www.mycollege.org">
  <Batch>
    <StudentsCount>10</StudentsCount>
    <TeachersCount>2</TeachersCount>
    <BatchStartTime>9AM</BatchStartTime>
    <BatchEndTime>5PM</BatchEndTime>
    <BreakTime>1PM</BreakTime>
  </Batch>
</College> 
```

**有没有办法将 BatchStartTime 更新为 10AM（任何值）。但我只需要修改 school_college_custom.xsl。如果在模板中添加“BatchStartTime”元素（如下所示），则会创建重复元素**

**我的代码：这不起作用（创建重复节点）**

```
<?xml version="1.0" encoding="windows-1252" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:ns1="http://www.mycollege.org">

  <xsl:template name="batch_ext">
        <ns1:BatchStartTime>
          <xsl:value-of select="'10AM'"/>
        </ns1:BatchStartTime>
        <ns1:BatchEndTime>
          <xsl:value-of select="'5PM'"/>
        </ns1:BatchEndTime>
        <ns1:BreakTime>
          <xsl:value-of select="'1PM'"/>
        </ns1:BreakTime>
  </xsl:template>
</xsl:stylesheet> 
```

**目标 XML：（预期，我需要这样的输出）**

```
<?xml version="1.0" encoding="UTF-8" ?>
<College xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://www.mycollege.org ../xsd/college.xsd"
     xmlns="http://www.mycollege.org">
  <Batch>
    <StudentsCount>10</StudentsCount>
    <TeachersCount>2</TeachersCount>
    <BatchStartTime>10AM</BatchStartTime>
    <BatchEndTime>5PM</BatchEndTime>
    <BreakTime>1PM</BreakTime>
  </Batch>
</College> 
```

**目标 XML：（上述代码的实际输出）**

```
<?xml version="1.0" encoding="UTF-8" ?>
<College xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://www.mycollege.org ../xsd/college.xsd"
     xmlns="http://www.mycollege.org">
  <Batch>
    <StudentsCount>10</StudentsCount>
    <TeachersCount>2</TeachersCount>
    <BatchStartTime>9AM</BatchStartTime>
    <BatchStartTime>10AM</BatchStartTime>
    <BatchEndTime>5PM</BatchEndTime>
    <BreakTime>1PM</BreakTime>
  </Batch>
</College> 
```

请给出一些解决方案。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:46:09.673

不，您不能在调用自定义模板之前修改已添加到结果树的节点。如果要使用主（导入）XSLT`xsl:apply-templates`而不是`xsl:value-of`获取要插入结果的值，那么您将能够定义一个

```
<xsl:template match="ns0:ClassStartTime">10AM</xsl:template> 
```

覆盖此元素的默认模板，但是按原样编写主 XSLT，您无能为力。

# php - 未定义变量错误 TTS PHP 脚本

> ID：13782146
> 
> 赞同：0
> 
> 时间：2012-12-08T21:32:01.293
> 
> 标签：php

我试图让这段代码工作，但它不会。请有人帮助我。这是第一个文件 tts.php：

```
<?php
class TextToSpeech {
    public $mp3data;
    function __construct($text="") {
        $text = trim($text);
        if(!empty($text)) {
            $text = urlencode($text);
            $this->mp3data = file_get_contents("http://translate.google.com/translate_tts?tl=en&q={$text}");
        }
    }

    function setText($text) {
        $text = trim($text);
        if(!empty($text)) {
            $text = urlencode($text);
            $this->mp3data = file_get_contents("http://translate.google.com/translate_tts?tl=en&q={$text}");
            return $mp3data;
        } else { return false; }
    }

    function saveToFile($filename) {
        $filename = trim($filename);
        if(!empty($filename)) {
            return file_put_contents($filename,$this->mp3data);
        } else { return false; }
    }
}
?> 
```

第二个文件，index.php：

```
<?php
require "tts.php";
$tts = new TextToSpeech();
$tts->setText("Hello World!");
$tts->saveToFile("voice.mp3");
?> 
```

这是错误：![错误](../Images/92a4b93c1a1079528cb8d9b1837753c8.png)

*我在本地主机上运行代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:34:16.347

`return $mp3data;`应该`return $this->mp3data;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:34:29.587

```
return $this->mp3data; 
```

代替

```
return $mp3data; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T21:34:53.837

第 27 行大概是`setText()`函数中的这一行...

```
return $mp3data; 
```

它应该是

```
return $this->mp3data; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T21:34:41.663

你应该改变行

```
return $mp3data; 
```

到

```
return $this->mp3data; 
```

# java - 使用本地 Web 服务器使用 Java 应用程序对 google 驱动器进行身份验证

> ID：13782152
> 
> 赞同：0
> 
> 时间：2012-12-08T21:32:35.813
> 
> 标签：java, browser, oauth-2.0, google-drive-api, google-api-java-client

[在这段视频](http://www.youtube.com/watch?feature=player_embedded&v=0zp342mRCAk)的结尾，他们谈到了使用本地 Web 服务器来“捕获”来自 oauth 登录网页的重定向。

我真的很想在我正在编写的 java 应用程序（不是网络应用程序）中实现这样的东西。

目前，我从我的应用程序启动 Web 浏览器到登录页面，并且我知道如果我将重定向 uri 设置为 localhost，那么代码将被发送到本地 Web 服务器。

我的问题是

1.  我应该使用什么网络服务器？我只需要它来“捕获”这个重定向并返回代码，因此它应该尽可能小。是否可以在我的应用程序中执行此操作，或者我需要启动一个单独的程序。

2.  如何从 Web 服务器取回代码？

3.  有没有我错过的这样做的例子？

感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T12:17:10.473

有一个你想要的例子：[Drive command line sample](http://samples.google-api-java-client.googlecode.com/hg/drive-cmdline-sample/instructions.html)

基本上，谷歌在授予用户访问您的网络服务器的权限后会重定向用户。在本例中，服务器是 Jetty 服务器，它使用 servlet 处理 GET 请求。

# java - 仅对我所有班级的定义用户

> ID：13782154
> 
> 赞同：1
> 
> 时间：2012-12-08T21:33:00.230
> 
> 标签：java

我需要有关 java 类的帮助。我正在做一个有许多类的项目，这些类必须连接到我的服务器的 LDAP。在每个类中，我必须指定导入 javax，即绑定到 LDAP 服务器的上下文。有一种方法可以仅在一个类中指定 javax 和 context，而在所有其他类上调用此 javax 和 context 而无需重写所有内容？

我只想为我的所有班级指定一次 javax、hastable 和 env.put 的部分导入：

```
package ldapUserManagement;

import javax.naming.*;
import javax.naming.directory.*;

import java.util.Hashtable;
import java.util.List;

public class Usagers
{

    private static final String String = null;
    private static Context result;

    public static void main(String[] args) 
    {

    Hashtable env = new Hashtable();
    env.put(Context.INITIAL_CONTEXT_FACTORY,"com.sun.jndi.ldap.LdapCtxFactory");

    env.put(Context.PROVIDER_URL, "ldap://192.168.0.5:389/dc=java,dc=local");
        env.put(Context.SECURITY_AUTHENTICATION, "simple");
        env.put(Context.SECURITY_PRINCIPAL, "java\\administrator");
        env.put(Context.SECURITY_CREDENTIALS, "*password*");
        env.put("java.naming.ldap.deleteRDN", "true");  

    try {... 
```

我的目标是仅在一处指定要导入的管理员凭据和 javax

感谢回复一个明确的例子

感谢您的快速帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T12:20:24.760

您可以使用 HashMap options = new HashMap(); 看看我的 ldap 测试连接

```
package com.company.project.test;

import java.lang.reflect.Method;
import java.security.acl.Group;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Set;
import javax.security.auth.Subject;
import javax.security.auth.login.AppConfigurationEntry;
import javax.security.auth.login.Configuration;
import javax.security.auth.login.LoginContext;

import junit.framework.TestCase;
import junit.framework.TestSuite;
import org.jboss.security.SimplePrincipal;
import org.jboss.security.auth.callback.UsernamePasswordHandler;
import org.junit.Ignore;
import org.junit.Test;

/** Tests of the LoginModule classes.
 */
public class LoginModulesTestCase extends TestCase
{
   static
   {
      try
      {
         Configuration.setConfiguration(new TestConfig());
         System.out.println("Installed TestConfig as JAAS Configuration");
      }
      catch(Exception e)
      {
         e.printStackTrace();
      }
   }
   /** Hard coded login configurations for the test cases. The configuration
    name corresponds to the unit test function that uses the configuration.
    */
   static class TestConfig extends Configuration
   {
      public void refresh()
      {
      }

      public AppConfigurationEntry[] getAppConfigurationEntry(String name)
      {
         AppConfigurationEntry[] entry = null;
         try
         {
            Class[] parameterTypes = {};
            Method m = getClass().getDeclaredMethod(name, parameterTypes);
            Object[] args = {};
            entry = (AppConfigurationEntry[]) m.invoke(this, args);
         }
         catch(Exception e)
         {
         }
         return entry;
      }

      AppConfigurationEntry[] testLdapExample1()
      {
         String name = "org.jboss.security.auth.spi.LdapLoginModule";
         HashMap options = new HashMap();
         options.put("java.naming.factory.initial", "com.sun.jndi.ldap.LdapCtxFactory");
         options.put("java.naming.provider.url", "ldap://127.0.0.1:10389/");
         options.put("java.naming.security.authentication", "simple");
         options.put("principalDNPrefix", "uid=");
         options.put("principalDNSuffix", ",ou=users,o=myorg");         
         options.put("rolesCtxDN", "ou=groups,o=myorg");
         options.put("uidAttributeID", "member");
         options.put("matchOnUserDN", "true");
         options.put("roleAttributeID", "cn");
         options.put("roleAttributeIsDN", "false");
         AppConfigurationEntry ace = new AppConfigurationEntry(name,
         AppConfigurationEntry.LoginModuleControlFlag.REQUIRED, options);
         AppConfigurationEntry[] entry = {ace};
         return entry;
      }
   }

   public LoginModulesTestCase(String testName)
   {
      super(testName);
   }

   @Test
   public void testLdapExample1() throws Exception
   {
      System.out.println("testLdapExample1");
      UsernamePasswordHandler handler = new UsernamePasswordHandler("nameuser", "passduser".toCharArray());
      LoginContext lc = new LoginContext("testLdapExample1", handler);
      lc.login();

      Subject subject = lc.getSubject();
      System.out.println("Subject: "+subject);

      Set groups = subject.getPrincipals(Group.class);
      assertTrue("Principals contains nameuser", subject.getPrincipals().contains(new SimplePrincipal("nameuser")));
      Group roles = (Group) groups.iterator().next();
      assertTrue("admin is a role", roles.isMember(new SimplePrincipal("admin")));

      lc.logout();
   }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T21:45:50.207

为您使用静态变量`Hashtable`

```
import javax.naming.*;

import java.util.Hashtable;

public class Usagers {

    private static Hashtable table = init();

    public static final Hashtable getEnv() {
        return table;
    }

    private static Hashtable init() {
        Hashtable env = new Hashtable();
        table.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
        table.put(Context.PROVIDER_URL, "ldap://192.168.0.5:389/dc=java,dc=local");
        table.put(Context.SECURITY_AUTHENTICATION, "simple");
        table.put(Context.SECURITY_PRINCIPAL, "java\\administrator");
        table.put(Context.SECURITY_CREDENTIALS, "*password*");
        table.put("java.naming.ldap.deleteRDN", "true");

        return env;
    }
} 
```

您将始终可以访问它`Usagers.getEnv()`

# excel - 可以使用两个变量给出 vba 的单元格编号吗

> ID：13782155
> 
> 赞同：3
> 
> 时间：2012-12-08T21:33:07.910
> 
> 标签：excel, vba

```
Dim VAR1, VAR2, VAR3, VAR4, AS variant

VAR1 = Worksheets("Sheet3").Cells(3, "J").Value 
VAR2 = Worksheets("Sheet3").Cells(3, "K").Value 
VAR3 = Worksheets("Sheet3").Cells(3, "L").Value 
VAR4 = Worksheets("Sheet3").Cells(3, "M").Value

=sheet1.range(VAR1,VAR2).COPY
=Sheet3.range(VAR2,VAR4).Pastespecial 
```

对于上述内容，我在 Var1 Var2...Var4 中给出了单元格编号

是否可以使用两个变量定义单元格位置，

```
Var1=B
Var2=5 
```

并以某种方式将它们组合起来得到 B5，我想在宏本身中执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T22:42:01.780

你可以。VBA 允许您在范围分配中连接字符串。在这种情况下，它看起来像：

```
Sub test()
Dim Var1 As Variant
Dim Var2 As Variant
Dim rng As Excel.Range

Var1 = "B"
Var2 = "5"
Set rng = ActiveSheet.Range(Var1 & Var2)
End Sub 
```

# jquery - 高级 Ajax 页面加载器更改正文类

> ID：13782160
> 
> 赞同：0
> 
> 时间：2012-12-08T21:33:54.433
> 
> 标签：jquery, ajax, wordpress, loader

我在我的 Wordpress 安装中使用 Advanced Ajax Page Loader Wordpress 插件，并且它严重缺乏文档。

这是一个针对过去使用它的人的问题，我如何更改我的 body 类，我看到了使用 jQuery(dataa) 的提示，但这对我没有帮助，我做了一个控制台。该项目的日志，我不确切知道如何搜索该数据以获取我所在当前页面的正文类，一旦我得到它，我可以轻松更改我的正文类，但我不知道如何选择它。

我试着把这个

```
console.log(jQuery(dataa).find('body'))

if (jQuery(dataa).find('body')) {
console.log('yeaaa'); } else {
console.log('neeeyyy') } 
```

在管理员[http://screencast.com/t/qfqmrhqhrw](http://screencast.com/t/qfqmrhqhrw)但我在我的网站上没有得到任何回应。

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2012-12-10T13:49:29.747

我是插件作者！

当我帮助人们并意识到我应该提供哪些信息时，可以添加大量文档，并且可以添加更多文档。例如，我有一个不断增长的“重新加载代码”数据库，用于支持各种 javascript 代码。

您在 AAPL 设置页面更改您的身体等级，不要编辑主要脚本！这是假设您拥有最新版本的 AAPL，您现在应该从下面的链接中获取它，然后再搞乱任何东西。

[http://wordpress.org/extend/plugins/advanced-ajax-page-loader/](http://wordpress.org/extend/plugins/advanced-ajax-page-loader/)

还可以在该站点上发起支持请求，因为您更有可能获得相关帮助。

# python - 帮助使用 App Engine 的最终一致性 + 缓存的框架

> ID：13782172
> 
> 赞同：0
> 
> 时间：2012-12-08T21:35:29.760
> 
> 标签：python, google-app-engine, google-cloud-datastore, eventual-consistency

我相信我有一个相当典型的用例，很难最终保持一致。我想知道是否有人已经创建了一个 python 框架来帮助解决这个问题。

我有一个 GET 请求，它发出一组实体的查询。它们很少更新。我有一个 POST 请求一次更新一个实体，更新实体会影响它们是否/如何出现在 GET 请求中。

由于实体很少更改，我想长时间缓存 GET 请求，比如说几天或几周。因此，在我获得更新实体的 POST 的罕见机会中，我可以清除内存缓存。

如果我处理一个 POST 请求、更新一个实体、清除缓存，然后很快就会收到一个 GET 请求，最终一致的数据存储查询可能仍会显示旧的查询结果，然后这些结果将在接下来的几天内被 memcached或几周。

而不是简单地更新数据存储和清除缓存，我需要：

```
1\. update the datastore
2\. get the cached query
3\. modify the cached query (with the proper sorting too!)
4\. update the cache with the new modified query results (with a cas() operation) 
```

这似乎是一个足够普遍的问题。是否有任何 python 框架可以帮助缓解这个问题？

ndb 没有帮助，因为数据存储查询绕过了所有缓存。

如果重要的话，我目前正在使用 django-nonrel，django-tastypie 处理 GET 请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T03:17:14.913

根据我对 GAE 上的 memcache 的理解/经验，除非您驾驶的流量非常大，否则您的数据将被驱逐，但即便如此也[不能保证](https://developers.google.com/appengine/docs/python/memcache/overview#How_Cached_Data_Expires)。

但是，我认为您应该能够使用[Ancestor queries](https://developers.google.com/appengine/docs/python/datastore/structuring_for_strong_consistency)，因为它们通过将查询的范围限制为实体组来提供强一致性。从文档：

> 要获得高度一致的查询结果，您需要使用祖先查询将结果限制为单个实体组。这是有效的，因为实体组是一致性和事务性的单位。所有数据操作都应用于整个组；在整个实体组更新之前，祖先查询不会返回其结果。如果您的应用程序依赖于某些查询的高度一致的结果，您可能需要在设计数据模型时考虑到这一点。

假设您的 GET 请求与某种用户或其他可识别的“父级”相关联，或者您可以创建一个由该 GET 检索的所有实体共享的全局父级，您将能够使用该父级来检索强烈一致发送。

[这是文档中的一个示例。](https://developers.google.com/appengine/docs/python/datastore/queries#Ancestor_Queries)

这是我问的一个相关问题，它展示了一些关于设置父级、键和易于查询的 ID 的好技巧：[NDB using Users API to form an entity group](https://stackoverflow.com/questions/10271103/ndb-using-users-api-to-form-an-entity-group)

# javascript - 仅当正则表达式在Javascript中被正确的标点符号包围时，如何匹配它们？

> ID：13782177
> 
> 赞同：0
> 
> 时间：2012-12-08T21:36:14.417
> 
> 标签：javascript, regex

我想在版本控制提交消息中添加很多 Redmine 问题编号，这些编号前面带有 # 符号，例如 #123、#456 等，但我只想匹配它们，如果它们被标点字符集包围，或者是行的开头或结尾。例如 '#234aa, #567' 应该只匹配 #567。', - ;#456,,' 应该匹配 #456 因为 ',-; ' 都在标点字符集中。我尝试了一个示例表达式

```
function myFunction()
{
    var str="erwet,#3456 #623 #345 fdsfsd"; 
    var n=str.match(/\#[\d+]+[\s]/g);
    document.getElementById("demo").innerHTML=n;
} 
```

我也想将它们匹配到一个数组或一个列表中，但我正在尝试的演示将它们匹配到一个字符串中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:03:06.573

好的，所以我认为我有一个正则表达式可以完成这项工作，它匹配标点符号的事实使您示例中的几个句子有点令人困惑，但这里是：

```
var re = /(?:^|['".,;:\s])(#\d+)(?:['".,;:\s]|$)/;​ 
```

这可以分解为：

```
(?:^|['".,;\s]) //matches either the beginning of the line, or punctuation
(#\d+ )         //matches the issue number
(?:['".,;:\s]|$)//matches either punctuation, whitespace, or the end of the line 
```

所以我们得到：

```
re.test('#234aa, #567') //true
re.exec('#234aa, #567') //["#567", "#567", "", index: 8, input: "#234aa, #567"] 
re.test("', - ;#456,,'")//true
re.exec("', - ;#456,,'")//[";#456,", "#456", index: 5, input: "', - ;#456,,'"] 
```

我不太确定`\s`最后一点，因为这既不是标点符号也不是行尾，但你在你的基本代码中有它，所以我认为它是你想要的。

# jquery - 将日期指定为给定日期

> ID：13782180
> 
> 赞同：0
> 
> 时间：2012-12-08T21:36:34.473
> 
> 标签：jquery, jquery-ui, jquery-ui-datepicker

是否有可能将 jqueryUI datepicker 的 minDate/maxDate 指定为给定日期的相对日期，而不是今天？

如果我指定一个相对日期，它是相对于今天的。我可以做类似“01.01.2012 -3y”的事情，意思是在 2012 年 1 月 1 日之前三年吗？最重要的是，我可以在一个字符串中完成吗？

据我从 jqueryUI 文档中可以看出是不可能的，但只是想检查一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:51:05.410

我不认为你可以在一行中，但你可以先计算 maxDate，然后将其提供给 datepicker：

```
function addYearsDate(dateText, years) {
    var curDate = new Date(Date.parse(dateText));
    var nextDate = new Date();
    nextDate.setYear(curDate.getFullYear() + years);
    var curDay = nextDate.getDate();
    var curMonth = nextDate.getMonth() + 1; //Months are zero based
    var curYear = nextDate.getFullYear();
    return curYear + "/" + curMonth + "/" + curDay;​
}

var newDate = addYearsDate("2012/12/8", 3); // will ouput "2015/12/8" 
```

编辑：正如在另一个答案中提到的，您可以直接从函数返回 nextDate 对象，而不是格式化为 datepicker() 可以处理对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T21:51:38.190

[如jQuery 文档](http://jqueryui.com/datepicker/#min-max)所示，您可以只传递一个 Date 对象，

```
minDate: new Date(2009, 1 - 1, 1)
maxDate: new Date(2009, 12 - 1, 31) 
```

而不仅仅是一个偏移量`"-1M"`。

# haskell - Haskell：foldr 与 foldr1

> ID：13782185
> 
> 赞同：7
> 
> 时间：2012-12-08T21:37:18.887
> 
> 标签：haskell, fold

如果我有这个插入功能：

```
insert x []     = [x]
insert x (h:t)
  | x <= h      = x:(h:t)
  | otherwise   = h:(insert x t) 
```

这会产生一个排序列表：

```
foldr insert [] [1,19,-2,7,43] 
```

但是这个：

```
foldr1 insert [1,19,-2,7,43] 
```

产生'*不能构造无限类型：a0 = [a0]* '

我很困惑为什么第二个电话不能工作。

我查看了[foldr](http://zvon.org/other/haskell/Outputprelude/foldr_f.html)和[foldr1](http://zvon.org/other/haskell/Outputprelude/foldr1_f.html)的定义，并使用简单的算术函数进行了跟踪，但我仍然无法明确解释为什么第二次调用失败。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-08T21:43:36.297

让我们看一些类型签名。

```
foldr  :: (a -> b -> b) -> b -> [a] -> b
foldr1 :: (a -> a -> a) ->      [a] -> a 
```

在这两种情况下，第一个参数都是两个参数的函数。

*   对于`foldr1`，这两个参数必须具有相同的类型（并且结果也具有这种类型）
*   对于`foldr`，这两个参数可能具有不同的类型（并且结果与第二个参数具有相同的类型）

你的类型是`insert`什么？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-09T01:34:58.200

我喜欢这里给出的基于类型的答案，但我也想给出一个可操作的答案来解释为什么我们不希望它进行类型检查。让我们从源代码`foldr1`开始：

```
foldr1          :: (a -> a -> a) -> [a] -> a
foldr1 _ [x]    = x
foldr1 f (x:xs) = f x (foldr1 f xs) 
```

现在，让我们尝试运行您的程序。

```
foldr1 insert [1,19,-2,7,43]
= { list syntax }
foldr1 insert (1:[19,-2,7,43])
= { definition of foldr1 }
insert 1 (foldr1 insert [19,-2,7,43])
= { three copies of the above two steps }
insert 1 (insert 19 (insert (-2) (insert 7 (foldr1 insert [43]))))
= { definition of foldr1 }
insert 1 (insert 19 (insert (-2) (insert 7 43))) 
```

……哎呀！那`insert 7 43`永远行不通。=)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-08T21:42:51.823

`foldr1`is的类型`(a -> a -> a) -> [a] -> a`，即该函数的参数和结果具有相同的类型。但是，`insert`有类型`Ord a => a -> [a] -> [a]`。用于`foldr1 insert`良好的类型，`a`并且`[a]`必须是相同的类型。

但这意味着`a == [a] == [[a]] == [[[a]]] == ...`，即，`a`是一种无限多列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T21:41:50.357

因为`foldr1`正在尝试这样做：

```
insert 43 -7 
```

这将失败。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-08T21:45:12.893

问题如下：

`foldr`会这样做：

1.  结果设置为`insert 43 []`
2.  结果设置为`insert 7 result`
3.  等等

这显然有效。

而`foldr1`会尝试执行以下操作：

1.  结果设置为`insert 7 43`
2.  结果设置为`insert -2 result`
3.  等等

这绝对是错误的。您可以看到，`foldr1`要求操作的参数是同一类型，而`insert`.

# database-design - 关系数据库中的多值属性

> ID：13782192
> 
> 赞同：0
> 
> 时间：2012-12-08T21:37:55.213
> 
> 标签：database-design, schema, relational-database, erd

在关系数据库中实现多值属性的最佳方法是什么？

我正在尝试将 ER 图转换为关系模式，但我遇到了这个问题：

我有一个“节目”表，其中包含节目 ID、类型、标题、描述等属性 - 但也有演员 - 显然这是多值的，因为一个特定的节目将有多个演员。

我应该如何表示这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:50:17.720

如果一个演员可以有`Many`节目，一个节目可以有`Many`演员，这听起来像是一种经典的`Many-to-Many`关系。创建第三个表，称为`programme_actors`或可能`cast`包含两列：两个连接表中的每一个的主键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:46:49.927

如果一个演员也可能出现在多个节目中，请使用一个连接表，其中包含节目和演员的外键以及可能的其他属性，如角色。

# java - 将文本字段与 Java 中的复选框相关联

> ID：13782193
> 
> 赞同：0
> 
> 时间：2012-12-08T21:38:08.000
> 
> 标签：java, mysql, sql, database

该程序要求用户登录并请求访问数据库。然后程序获取一个连接对象，在数据库中搜索将列名存储到一个向量中以供以后使用。问题在于实现文本字段以允许用户在数据库中搜索特定值。

我可以使用网格布局显示复选框和文本字段并将它们添加到面板中。如何将文本字段与其相应的复选框相关联？

我已经尝试将它们添加到矢量中，但是它们也不能也添加到面板中。我已经搜索了一种在循环遍历列名时命名文本字段的方法，但是如果不提前声明它们似乎是不可能的。这也无法完成，因为无法确定用户将请求的属性。

我只需要知道文本字段的名称，这样我就可以测试用户是否输入了信息并执行必要的逻辑。如果您必须查看其余代码才能给出答案，请告诉我，但希望您能大致了解我要完成的工作。

用户界面图片：

![用户界面图片：](../Images/e49e293e2799f99d01e7a54d17af6040.png)

```
 try {
        ResultSet r2 = con.getMetaData().getColumns("", "", rb.getText(), "");  
        colNames1 = new Vector<String>();  
        columns1 = new Vector<JCheckBox>();  
        while (r2.next()) {  
            colNames1.add(r2.getString(4));  
            JCheckBox cb = new JCheckBox(r2.getString(4));  
            JTextField tf = new JTextField(10);  
            columns1.add(cb);  
            p3.add(cb);  
            p3.add(tf);  
        }  
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:39:36.037

首先，Vector 是一个不应该使用多年的老类。请改用 ArrayList。

其次，如果您想将一个对象与另一个对象关联，请使用 Map：

```
Map<String, JTextField> textFieldsByColumnName = new HashMap<String, JTextField>();
for (...) {
    String columnName = ...;
    JTextField tf = new JTextField();
    map.put(columnName, tf);
} 
```

然后，当您想要与给定列名关联的文本字段时，只需使用

```
JTextField tf = textFieldsByColumnName.get(columnName); 
```

[在收藏教程](http://docs.oracle.com/javase/tutorial/collections/)中了解收藏。这是任何 Java 程序员都必须知道的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:01:35.687

作为组件组合的示例，您可以使用包含复选框和文本字段的类来扩展 JPanel。这可用于构建提供新行为的自定义组件，而无需从头开始编写自己的输入组件。

```
class CheckableTextField extends JPanel {
    JTextField textField;
    JCheckBox checkBox;

    public CheckableTextField(String label) {
        this.checkBox = new JCheckBox(label);
        this.textField = new JTextField(10);

        this.add(this.checkBox);
        this.add(this.textField);
    }

    public String getValue() {
        return this.textField.getText();
    }

    public isSelected() {
        return this.checkBox.isSelected();
    }
} 
```

然后，您可以使用 CheckableTextField 代替单独的 JTextField 和 JCheckBox 对象。它的行为就像 Java 附带了一个完全符合您要求的组件。您可以通过多种方式进一步自定义自定义组件，例如通过更改构造函数中的布局。

使用像 Swing（用于 GUI 应用程序）或 JSF（用于 Web 应用程序）这样的面向对象框架来使用组合来构建自己的组件是相当普遍的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T07:18:51.077

正如 GaragantuChet 所说，最好编写一个自定义组件。这也使布局和自定义焦点遍历策略更容易。我还建议查看 miglayout，它可以更轻松地创建更复杂和动态的屏幕。

[http://www.miglayout.com/](http://www.miglayout.com/)

完成此操作后，就可以将自定义组件存储在地图中，以列名作为键。

# regex - Python 中的正则表达式 - 在 re.sub 中组合两个操作

> ID：13782194
> 
> 赞同：0
> 
> 时间：2012-12-08T21:38:09.717
> 
> 标签：regex, python-2.7

我正在尝试通过大量文本（位于变量整体中）搜索单词“he”，然后将其替换为“she”，然后我想再次搜索文本并将“she”替换为 he。但是下面的常规表达式相互覆盖 - 这意味着在此示例中，文本将全部为“他”

我的问题 - 有没有组合正则表达式并一次完成这两项操作？

```
#jackNew.heShe() == she
#jillNew.heShe() == he  

whole=re.sub(r'(?i)\bhe\b', jackNew.heShe(), whole)

whole=re.sub(r'(?i)\bshe\b', jillNew.heShe(), whole) 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:53:11.007

您可以利用以下事实[`re.sub(pattern, repl, string, count=0, flags=0)`](http://docs.python.org/2/library/re.html#re.sub)

> If`repl`是一个函数，每次出现不重叠的模式时都会调用它。该函数采用单个匹配对象参数，并返回替换字符串。

```
import re
s = 'she said he was a nice girl'
re.sub('s?he', lambda m: 'he' if m.group() == 'she' else 'she', s) 
```

给

```
'he said she was a nice girl' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T21:47:02.063

好吧，这不是一次性的，但一种选择是采取不同的路线。您可以使用中间替换，例如：-

*   替换`"he"`为`"s@he"`
*   替换`"she"`为`"he"`
*   替换`"s@he"`为`"she"`

这将解决您的问题。

# java - 需要澄清这个 java 程序的错误

> ID：13782197
> 
> 赞同：0
> 
> 时间：2012-12-08T21:38:33.373
> 
> 标签：java, methods

我试图修复电视方法，但我不断收到相同的错误：找不到符号构造函数电视（java.lang.String，int）。如果有人能告诉我为什么会收到此错误消息，我将不胜感激。这是我的代码：

```
import java.util.Scanner;
public class Television
{
    private String manufacturer;       //the brand name
    private int SCREEN_SIZE;           //the size of the television screen.
    private boolean powerOn;           //the value true if the power is on
    private int channel;               //the value of the station that the television is showing.
    private int volume;                //a number value representing the loudness

    Scanner keyboard = new Scanner(System.in);
    /*
     *Constructor to assign the values to manufacturer and SCREEN_SIZE
     *@param the manufacturer value
     *@param the SCREEN_SIZE value
     */
    public Television(String sony, int size, int chan)
    {
        manufacturer = sony;
        SCREEN_SIZE = size;
        channel = chan;

        powerOn = false;
        channel = 2;
        volume = 20;
    }
    public int getChannel()
    {
        return channel;
    }
    public int getVolume()
    {
        return volume;
    }
    public String getManufacturer()
    {
        return manufacturer;
    }
    public int getScreenSize()
    {
        return SCREEN_SIZE;
    }
    public void setChannel(int channel)
    {
        channel = keyboard.nextInt();
    }
    public void power()
    {
        if (true)
        {
            powerOn = !powerOn;
        }
        else
        {
            powerOn = powerOn;
        }
    }
    public void increaseVolume()
    {
        volume = volume + 1;
    }
    public void decreaseVolume()
    {
        volume = volume - 1;
    }
public static void main(String[] args)
{
    //create a Scanner object to read from the keyboard
    Scanner keyboard = new Scanner (System.in);
    //declare variables
    int station; //the user’s channel choice

    //declare and instantiate a television object
    Television bigScreen = new Television("Toshiba", 55);

    //turn the power on
    bigScreen.power();
    //display the state of the television
    System.out.println("A " + bigScreen.getScreenSize() +
    bigScreen.getManufacturer() + " has been turned on.");
    //prompt the user for input and store into station
    System.out.print("What channel do you want? ");
    station = keyboard.nextInt();
    //change the channel on the television
    bigScreen.setChannel(station);
    //increase the volume of the television
    bigScreen.increaseVolume();
    //display the the current channel and volume of the television
    System.out.println("Channel: " + bigScreen.getChannel() +
    " Volume: " + bigScreen.getVolume());
    System.out.println("Too loud!! I am lowering the volume.");
    //decrease the volume of the television
    bigScreen.decreaseVolume();
    bigScreen.decreaseVolume();
    bigScreen.decreaseVolume();
    bigScreen.decreaseVolume();
    bigScreen.decreaseVolume();
    bigScreen.decreaseVolume();
    //display the current channel and volume of the television
    System.out.println("Channel: " + bigScreen.getChannel() +
    " Volume: " + bigScreen.getVolume());
    System.out.println(); //for a blank line
    //HERE IS WHERE YOU DO TASK #5
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T21:40:01.423

您的 Television 构造函数接受三个参数，一个字符串和两个整数，而您只传递了两个参数。

```
Television bigScreen = new Television("Toshiba", 55); 
```

应该

```
Television bigScreen = new Television("Toshiba", 55, there should be another int argument here); 
```

正如我从您的代码中看到的那样，您应该将一个 int （通道）作为第三个参数传递给您的构造函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T21:41:24.567

定义为接收 3 个参数的构造函数，而您只传递了两个参数

```
public Television(String sony, int size, int chan);

Television bigScreen = new Television("Toshiba", 55); 
```

# rest - 如何使用 cURL 执行 PUT 请求？

> ID：13782198
> 
> 赞同：507
> 
> 时间：2012-12-08T21:38:39.893
> 
> 标签：rest, http, curl

如何使用 cURL 测试 RESTful PUT（或 DELETE）方法？

* * *

## 回答 #1

> 赞同：657
> 
> 时间：2012-12-08T21:40:10.497

将`-X`标志与您想要的任何 HTTP 动词一起使用：

```
curl -X PUT -d arg=val -d arg2=val2 localhost:8080 
```

此示例还使用该`-d`标志为您的 PUT 请求提供参数。

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2015-10-27T04:33:10.953

### 快速回答：

在一行中，curl 命令将是：

a) 如果发送表单数据：

```
curl -X PUT -H "Content-Type: multipart/form-data;" -F "key1=val1" "YOUR_URI" 
```

b) 如果以 json 格式发送原始数据：

```
curl -X PUT -H "Content-Type: application/json" -d '{"key1":"value"}' "YOUR_URI" 
```

c) 如果使用 POST 请求发送文件：

```
curl -X POST "YOUR_URI" -F 'file=@/file-path.csv' 
```

### 替代解决方案：

您可以使用 Chrome 商店中的**[POSTMAN](https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=en)**应用程序来获取等效的 cURL 请求。这在编写更复杂的请求时特别有用。

对于其他格式的请求或针对 java、PHP 等不同客户端的请求，您可以查看下面的 POSTMAN/comment。

![POSTMAN 获取请求码](../Images/e54450eae3416dd17c06d1b891ebfcdf.png)

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2015-10-14T13:02:29.920

Martin C. Martin 评论后的 PUT 示例：

```
curl -T filename.txt http://www.example.com/dir/ 
```

与`-T`（相同`--upload-file`） curl 将使用 PUT 进行 HTTP。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-09-22T10:17:16.830

```
curl -X PUT -d 'new_value' URL_PATH/key 
```

在哪里，

X - 用于请求命令的选项

d - 用于将数据放在远程 url 上的选项

URL_PATH - 远程 URL

new_value - 我们要放入服务器密钥的值

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-02-05T18:00:02.183

我迟到了这个线程，但我也有类似的要求。由于我的脚本是动态构建 curl 的请求，因此我希望在 GET、POST 和 PUT 中使用类似的命令结构。

这对我有用

对于**PUT**请求：

```
curl --request PUT --url http://localhost:8080/put --header 'content-type: application/x-www-form-urlencoded' --data 'bar=baz&foo=foo1' 
```

对于**POST**请求：

```
curl --request POST --url http://localhost:8080/post --header 'content-type: application/x-www-form-urlencoded' --data 'bar=baz&foo=foo1' 
```

对于**GET**请求：

```
curl --request GET --url 'http://localhost:8080/get?foo=bar&foz=baz' 
```

# ios - 当我更改捆绑包版本时，GameKit 回合制比赛消失了？

> ID：13782200
> 
> 赞同：0
> 
> 时间：2012-12-08T21:38:56.067
> 
> 标签：ios, gamekit

更新我的应用程序时，我的 GKTurnBasedMatches 消失了，经过一些调整后，我发现每次我的捆绑版本更改时都会发生这种情况。我的应用还没有在商店中，所以它在沙盒服务器上。

一切仍然有效；只是旧版本的比赛将消失。

我在这里缺少什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T12:06:35.993

我不得不在我的 iTunes Connect 版本中重新选中“所有版本”旁边的复选框，尽管 iTunes Connect 已经表示以前的版本是兼容的，检查并保存解决了这个问题。

![在 Itunes Connect 中重新启用所有版本](../Images/0f0f870f1862022bd2664164cb846479.png)

# html - 链接到 URL 中的特定选项卡

> ID：13782201
> 
> 赞同：0
> 
> 时间：2012-12-08T21:38:58.927
> 
> 标签：html, django

我想通过 URL 链接到页面上的特定选项卡。如果不使用 Jquery（我基本上对此一无所知），这可能吗？

这是我的 HTML。我想要打开 YouTube 标签的链接。

```
<div class="tabbable span12">
    <ul class="nav nav-tabs">
        <li><h3> Videos including YouTube links </h3></li>
        <li class="pull-right">
            <a href="#YouTube" data-toggle="tab">YouTube</a>
        </li>
    <li class="active pull-right">
            <a href="#Newest" data-toggle="tab">Newest</a>
        </li> 
```

只需说我的链接是：“/stuff/videos”。如何以*最简单*的方式链接到此页面上的 YouTube 标签。

我试过“/stuff/videos#YouTube”，但这不起作用。

顺便说一句，如果有任何改变，我正在使用 Django 框架。

更新：这是实例化选项卡的代码。我正在使用引导程序。

```
 <div class="tab-pane" id="YouTube"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:42:41.680

使用`onclick`标签链接的JS处理程序动态切换到标签，并检查`location.hash`页面加载以自动切换到相应的标签。

# elasticsearch - elasticsearch couchbase 传输插件

> ID：13782202
> 
> 赞同：0
> 
> 时间：2012-12-08T21:39:08.117
> 
> 标签：elasticsearch, couchbase

我不确定谁能帮我解决这个问题，所以我在 github 页面上提出了这个问题，我也会在这里问：

我已经安装了 elasticsearch 版本 0.19.12 的插件。查看 elasticsearch.log 插件似乎加载成功：

[2012-12-08 00:27:28,553][INFO][plugins][Taylor，General Orell] 加载 []，站点 [transport-couchbase，head] 但是似乎端口 9091 没有被使用：

david@ubuntu:/usr/share/elasticsearch/lib$ nmap -p 9091 localhost

在 2012-12-08 01:11 GMT开始 Nmap 5.21 ( [http://nmap.org](http://nmap.org) ) 本地主机 (127.0.0.1) 的 Nmap 扫描报告主机已启动 (0.000089s 延迟)。端口状态服务 9091/tcp 关闭未知

Nmap 完成：在 0.08 秒内扫描了 1 个 IP 地址（1 个主机启动）

我尝试在 elasticsearch.yml 中指定一个端口，但这似乎没有任何区别。如果有更合适的地方我可以发布这个然后让我知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T01:31:39.040

我已经在我的计算机 OSX 和 CentOS 上进行了测试，没有任何问题。

因此，我邀请您执行以下操作，只是为了向我们提供更多信息以帮助我们解决此问题：

*   使用记录/测试 0.19.9 ( [https://github.com/couchbaselabs/elasticsearch-transport-couchbase](https://github.com/couchbaselabs/elasticsearch-transport-couchbase) )的版本进行测试

*   您可以通过编辑 ./config/logging.yml 文件来配置 Couchbase Transport 日志记录，并将以下行添加到记录器部分：

    transport.couchbase：跟踪 com.couchbase：跟踪

通过此更改，您能否让我知道这是否有效，如果没有，您是否在日志中有更多信息

# c++ - 快速排序分区算法

> ID：13782209
> 
> 赞同：0
> 
> 时间：2012-12-08T21:40:04.193
> 
> 标签：c++, algorithm, sorting, quicksort

```
void partition(int *a, int size) {
   int pivot = a[0];
   int left = 0, right = 0;
   for(left = 1, right = size-1; left <= right; left++, right--) {
       if(a[left] >= pivot && a[right] <= pivot){
           swap(left, right, a);
       }
   }
   swap(0, right, a);
} 
```

为了应用快速排序，我编写了此方法来分区数组作为初步步骤，我在此示例数据上对其进行了测试：

```
8 2 5 13 4 19 12 6 3 11 10 7 9 
```

正确的输出应该是：

```
6 2 5 7 4 3 8 12 19 11 10 13 9 
```

但实际输出是：

```
6 2 5 13 4 3 8 12 19 11 10 7 9 
```

该算法必须交换`13`，`7`但由于`&&`上述循环中的条件而失败。我只想增加`left`if`a[left] >= pivot`和减少`right`只有 if `a[right]<= pivot`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:57:58.050

你或多或少地回答了你自己的问题。你可能想做这样的事情：

```
void partition(int *a, int size) {
    int pivot = a[0];
    int left, right;
    for(left = 1, right = size-1; left < right; )
    {
        if(a[left] > pivot && a[right] <= pivot)
        {
            swap(left, right, a);
        }
        if(a[left] <= pivot) left++;
        if(a[right] > pivot) right--;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-22T15:32:12.863

这是另一种选择，与原始选项更相似

```
int partition(int arr[], int left, int right)
{
    int pivot = arr[left];
    while (left != right)
    {
        if (arr[left] > arr[right])
        {
            swap(arr[left], arr[right]);
        }
        if (pivot == arr[left])
            right--;
        else // Pivot == arr[right]
            left++;
    }
    return left;
} 
```

# python - 如何将时间python放在某个url中

> ID：13782213
> 
> 赞同：0
> 
> 时间：2012-12-08T21:40:41.357
> 
> 标签：python, time

我想做以下事情：

```
requestor = UrlRequestor("http://www.myurl.com/question?timestamp=", {'Content-Type': 'application/x-www-form-urlencoded', 'Cookie' : self.EASW_KEY + ";", 'X-UT-SID' :self.XUT_SID}, 'answer=' + self.securityHash)
requestor.open()
self.FUTPHISHING = requestor.getHeader('Set-Cookie').split(';')[0] 
```

在时间戳之后，我想有这种格式的本地时间：1355002344943

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:01:36.803

You can get the time in that format from the [time](http://docs.python.org/2/library/time.html) module. Specifically I'd do it this way

```
import time

timeurl = "http://www.myurl.com/question?timestamp=%s" % time.time()
requestor = UrlRequestor(timeurl, {'Content-Type': 'application/x-www-form-urlencoded',      'Cookie' : self.EASW_KEY + ";", 'X-UT-SID' :self.XUT_SID}, 'answer=' + self.securityHash)
requestor.open()
self.FUTPHISHING = requestor.getHeader('Set-Cookie').split(';')[0] 
```

time.time() returns a float, so if it doesn't like that level of precision you can do

```
timeurl = "http://www.myurl.com/question?timestamp=%s" % int(time.time()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:13:34.790

该时间戳看起来是基于[Unix 时间](http://en.wikipedia.org/wiki/Unix_time)（例如自 1970 年 1 月 1 日以来的秒数），但它还有三个数字。可能是毫秒，而不是秒。要复制它，我建议这样做：

```
import time

timestamp = int(time.time()*1000)
url = "http://www.myurl.com/question?timestamp=%d" % timestamp 
```

如果您不想进行字符串格式化，也可以简单地将时间戳连接到 URL：

```
url = "http://www.myurl.com/question?timestamp=" + str(timestamp) 
```

# r - 使用 ecdf 中的所有值，但应用 xlimit

> ID：13782214
> 
> 赞同：2
> 
> 时间：2012-12-08T21:40:51.377
> 
> 标签：r, ggplot2

我想绘制他的数据 [1] 严重偏斜`ecdf`。代码是

```
df <- data.frame(x=eval(parse(file("http://sprunge.us/XYJK"))))
ggplot(df, aes(x=x)) + xlim(0,100) + geom_line(stat='ecdf') 
```

如您所见，该线在 100 处变为 100%，这意味着超过 100 的数据被排除在外。我可以以某种方式包括它们吗？

[1] [http://sprunge.us/XYJK](http://sprunge.us/XYJK) ,

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T21:52:06.280

请阅读`?xlim`并发现您可以这样做：

```
ggplot(df, aes(x=x)) + geom_line(stat='ecdf') + coord_cartesian(xlim = c(0,100)) 
```

# c++ - 地图通过引用

> ID：13782217
> 
> 赞同：0
> 
> 时间：2012-12-08T21:41:14.897
> 
> 标签：c++, map, reference

> **可能重复：**
> [在 C++ 中通过引用/值传递](https://stackoverflow.com/questions/410593/pass-by-reference-value-in-c)

我有以下功能。参数是索引（一个毫秒映射）和键（一个字符串）。它搜索密钥并返回带有结果的集合或消息“找不到文件”。

如何通过引用传递地图索引？

如果我在另一个函数中需要 search_sucess，是否最好通过指针返回它？

```
 typedef map<string, set<string> > ms;

 set<string> seach_set(ms index, string key)
 {
     ms::iterator result;
     result = index.find(key);
     set<string> search_sucess;

     if (result != index.end())
     {
         cout << key << " in files : " << "{";
         for(set<string>::iterator iter = result->second.begin();
            iter != result->second.end(); ++iter)
          {
            cout << *iter << " ";
            search_sucess.insert(*iter);

        }
    cout << "}";
    }
   else
   {
     cout << key << " not found ";
   }
    cout <<  endl;

    return search_sucess;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:13:30.950

那个代码太疯狂了。我相信它在功能上与以下内容相同（减去所有打印）：

```
#include <map>
#include <set>
#include <string>

typedef std::map<std::string, std::set<std::string>> ms;

ms::mapped_type search_set(ms & m, ms::key_type const & k)
{
    ms::iterator it = m.find(k);

    return it == m.end() ? ms::mapped_type() : it->second;
} 
```

# ruby-on-rails - 将变量传递给部分 - 页面显示符号而不是字符串

> ID：13782219
> 
> 赞同：0
> 
> 时间：2012-12-08T21:41:27.420
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, partial-views, local-variables, partials

这是我认为调用部分的代码：

```
<%= render :partial => "/divbox", :locals => { :smush => "Science" } %> 
```

现在这是 _divbox.html.erb 中的内容：

```
<div>
<h1> <%= :smush %> </h1>
</div> 
```

我期望 HTML 输出：

```
<div>
<h1> Science </h1>
</div> 
```

但相反，我得到：

```
<div>
<h1> smush </h1>
</div> 
```

在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T21:52:05.317

改变这个：

```
<h1> <%= :class %> </h1> 
```

对此：

```
<h1> <%= class %> </h1> 
```

注意删除冒号。您传递给局部变量的局部变量是局部变量......不是符号。

另外..根本不要使用“类”。这是一个 ruby​​ 保留字，即使它确实有效，也会令人困惑。像这样做：

```
<%= render :partial => "/divbox", :locals => { :class_name => "Science" } %>

<div>
<h1> <%= class_name %> </h1>
</div> 
```

或者，如果您真的想要“类”，请使用“klass”，这是一种常见的替代品......

# javascript - 这是 $.Deferred 在这种情况下的正确用法吗？

> ID：13782220
> 
> 赞同：0
> 
> 时间：2012-12-08T21:41:29.563
> 
> 标签：javascript, jquery, jquery-deferred

我有以下代码和一个模块

```
var def = $.Deferred();

$.getJSON("http://localhost:62588/api/Values/getXMLData")
 .done(function(json){
      def.resolve($.parseJSON(json));
});

return def; 
```

然后我必须从另一个模块调用它，以便它完成，然后再调用处理返回的数据。

```
repository.getUserPolicies().done(function (userPolicies) {
    process(userPolicies);
}); 
```

这很好用，但我还不太明白延迟对象是如何工作的。

我已经读到您可以使用 getJSON 的延迟对象，但不确定这是否正是我在这里所做的？

我想知道这种方法是否有任何缺点？

可以做得更优雅吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T21:57:37.273

不，这不是一个很好的用法`$.Deferred`，因为`$.getJSON`在较新版本的 jQuery 中已经内置了一个延迟对象，并增加了对 Promise 等的支持。

您可以使用内置的延迟对象，只需返回 ajax 调用，并将`done()`函数直接附加到该对象：

```
var repository = {
    getUserPolicies: function() {
        return $.getJSON("http://localhost:62588/api/Values/getXMLData");
    }
}

repository.getUserPolicies().done(process); 
```

[**小提琴**](http://jsfiddle.net/6jQbm/1/)

# memory - Haskell 递归和内存使用

> ID：13782222
> 
> 赞同：30
> 
> 时间：2012-12-08T21:41:38.007
> 
> 标签：memory, recursion, functional-programming, haskell

我对用递归替换循环的想法感到满意。我正在摆弄一个宠物项目，我想测试一些文本输入功能，所以我写了一个小命令行界面，它反复询问输入，直到它收到特定的退出命令。

它看起来像这样：

```
getCommandsFromUser = do
    putStrLn "Enter command: "
    keyboardInput <- getLine
    let command = map toLower keyboardInput
    if command == "quit"
        then 
            putStrLn "Good-bye!"
        else do
            -- stuff
            -- more stuff
            putStrLn ("Sending command: " ++ commandURI)
            simpleHTTP $ getRequest commandURI
            getCommandsFromUser

main = do
    getCommandsFromUser 
```

这完全符合预期，但来自 C/Java 背景，它仍然让我大脑深处、黑暗、无意识的部分发痒，让我想在荨麻疹中爆发，因为我无法摆脱每次递归调用的想法`getCommandsFromUser`正在创建一个新的堆栈帧。

现在，我对 IO、monads、状态、箭头等一无所知。我仍在通过 Real World Haskell 工作，我还没有达到那部分，并且其中一些代码与我在 Google 上找到的东西的模式匹配。

此外，我知道 GHC 的全部意义在于它是一个令人发狂的优化编译器，旨在完成令人难以置信的事情，例如尾递归函数的漂亮展开等。

那么有人能解释一下这个实现是否“正确”，如果是的话，可以向我解释一下幕后发生的事情，如果它被放在无数只猴子的手中，它会阻止这个程序爆炸吗？

我知道什么是尾调用优化。我更关心它在这种情况下的工作原理，以及正在发生的动作和一般功能杂质。

这个问题并不是因为我对 Haskell 如何使用堆栈感到困惑，并且我希望它像命令式语言一样工作。它基于这样一个事实，即我不知道 Haskell 是如何处理堆栈的，并且想知道它与传统的类 C 语言有何不同。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-12-09T12:31:52.813

不要太担心堆栈。没有什么基本的东西说函数调用必须使用堆栈帧来实现。这只是实现它们的一种可能技术。

即使你有“堆栈”，也没有什么说堆栈必须限制在可用内存的一小部分。这本质上是一种针对命令式编程的启发式方法。如果您不使用递归作为解决问题的技术，那么非常深的调用堆栈往往是由无限递归错误导致的，并且将堆栈大小限制在非常小的范围内意味着此类程序会很快死亡，而不是消耗所有可用内存和交换然后死。

对于函数式程序员来说，当计算机仍然有千兆字节的 RAM 可用时，让程序终止“用尽”内存以进行更多的函数调用是语言设计中的一个荒谬的缺陷。这就像 C 将循环限制为任意数量的迭代。因此，即使函数式语言通过使用堆栈*来*实现函数调用，如果可能的话，也会有强烈的动机避免使用我们从 C 中知道的标准微型堆栈。

事实上，Haskell 确实有*一个*可以溢出的堆栈，但它不是你熟悉的 C 中的调用堆栈。很有可能编写无限递归的非尾递归函数，并且会消耗所有可用内存而不会碰到呼叫深度的限制。Haskell 确实拥有的堆栈用于跟踪需要更多评估才能做出决定的“未决”值（稍后我将详细介绍）。[您可以在此处](http://www.haskell.org/haskellwiki/Stack_overflow)阅读有关这种堆栈溢出的更多详细信息。

让我们通过一个示例来了解如何评估您的代码。¹我将使用一个比你的更简单的例子：

```
main = do
    input <- getLine
    if input == "quit"
        then
            putStrLn "Good-bye!"
        else do
            putStrLn $ "You typed: " ++ input
            main 
```

Haskell 的评估是懒惰的²。简单地说，这意味着它只会在需要该术语的值来做出决定时才费心评估该术语。例如，如果我计算`1 + 1`然后将其结果添加到列表的前面，它可以`1 + 1`在列表³中保留为“待处理” 。但是如果我`if`用来测试结果是否等于 3，*那么*Haskell 就需要实际做转`1 + 1`成`2`.

但如果这就是它的全部，那么什么都不会发生。整个程序将仅保留为“待定”值。但是有一个外部驱动程序需要知道 IO 操作`main`的评估结果，以便执行它。

回到例子。`main`等于那个`do`块。对于`IO`，一个块由一系列较小的动作`do`组成一个大动作，这些动作必须按顺序执行。`IO`因此，Haskell 运行时看到`main`评估`input <- getLine`后是一些它还不需要的未评估的东西。这足以知道从键盘读取并调用结果`String` `input`。假设我输入了“foo”。这使得 Haskell 的“下一个”`IO`动作如下所示：

```
if "foo" == "quit"
    then
        putStrLn "Good-bye!"
    else do
        putStrLn $ "You typed: " ++ "foo"
        main 
```

Haskell 只关注最外面的东西，所以这看起来很像“ **if** blah blah blah blah ...”。`if`不是 IO-executor 可以做任何事情的，因此需要对其进行评估以查看它返回的内容。`if`只是评估`then`或`else`分支，但要知道做出 Haskell 的哪个决定需要评估条件。所以我们得到：

```
if False
    then
        putStrLn "Good-bye!"
    else do
        putStrLn $ "You typed: " ++ "foo"
        main 
```

这允许整体`if`减少到：

```
do
    putStrLn $ "You typed: " ++ "foo"
    main 
```

再一次，`do`给了我们一个`IO`由有序的子动作序列组成的动作。所以 IO 执行器接下来要做的就是`putStrLn $ "You typed: " ++ "foo"`. 但这也不是一个`IO`动作（它是一个未评估的计算，应该导致一个）。所以我们需要评估它。

的“最外层”部分`putStrLn $ "You typed: " ++ "foo"`实际上是`$`. 去掉中缀运算符语法，这样你就可以像 Haskell runtiem 一样看到它，它看起来像这样：

```
($) putStrLn ((++) "You typed: " "foo") 
```

但是`$`刚刚由 定义的运算符`($) f x = f x`，所以立即替换右侧给我们：

```
putStrLn ((++) "You typed: " "foo")` 
```

现在通常我们会通过代入 的定义来评估`putStrLn`它，但它是一个“神奇”的原始函数，不能在 Haskell 代码中直接表达。所以它实际上并没有像这样被评估；外部 IO 执行器只知道如何处理它。但它要求对 的*论点*进行`putStrLn`全面评估，因此我们不能将其保留为`(++) "You typed: " "foo"`。

实际上有许多步骤可以完全评估该表达式，通过`++`列表操作的定义，但让我们跳过它并说它评估为`"You typed: foo"`. 那么 IO-executor 可以执行`putStrLn`（将文本写入控制台），并继续执行该`do`块的第二部分，即：

```
`main` 
```

这不是可以立即作为`IO`动作执行的东西（它不像 Haskell 那样内置在里面`putStrLn`）`getLine`，所以我们使用 to 定义的右侧来评估它`main`：

```
do
    input <- getLine
    if input == "quit"
        then
            putStrLn "Good-bye!"
        else do
            putStrLn $ "You typed: " ++ input
            main 
```

我相信你可以看到其余部分的去向。

请注意，我没有说过任何关于堆栈的内容。所有这一切都只是建立了一个描述`IO`动作的数据结构`main`，因此外部驱动程序可以执行它。它甚至不是一个特别特殊的数据结构；从评估系统的角度来看，它就像任何其他数据结构一样，因此对其大小没有任意限制。

在这种情况下，惰性求值意味着这个数据结构的生成与它的消耗是交错的（它后面部分的生成可能取决于由于消耗它的早期部分而发生的事情！），所以这个程序可以运行一定数量的空间。但正如 shachaf 对该问题的评论所指出的，这并不是删除不必要的堆栈帧的真正优化；这正是惰性评估自动发生的事情。

* * *

因此，我希望这对您了解正在发生的事情有足够的帮助。基本上，当 Haskell 开始评估对 的递归调用时`getCommandsFromUser`，它已经完成了前一次迭代中生成的所有数据，因此它会被垃圾收集。所以你可以无限期地运行这个程序，而不需要超过固定数量的内存。这只是惰性评估的直接结果，并且在`IO`涉及时没有本质上的不同。

* * *

¹我要预先声明，我对 Haskell 的实际当前实现了解不多。然而，我确实知道实现像 Haskell 这样的惰性纯语言的一般技术。我还将尽量避免过多地深入细节，并以直观的方式解释事物的工作原理。因此，这个帐户在您计算机内部实际发生的一些细节上可能是不正确的，但它应该向您展示这些事情是如何*工作*的。

²语言规范在技术上只是说评估应该是“非严格的”。我要描述的评估，非正式地称为“惰性”，实际上只是一种可能的“非严格”评估策略，但它是你在实践中得到的。

³实际上，新列表可以作为“待定”结果保留，`(1 + 1) : originalList`直到有人需要知道它是否为空。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-09T01:41:24.760

这个实现是正确的。

我不认为尾调用优化真的是使这项工作有效的一点。相反，不管你信不信，让它高效工作的是 IO 操作的不变性。您对 IO 操作是不可变的感到惊讶吗？我一开始是！这意味着：`getCommandsFromUser`是“要做的事情”的秘诀；并且每次您评估`getCommandsFromUser`时，它都会评估*相同的配方*。（当然，不是每次你按照食谱做的都会得到相同的结果！但这完全是执行的不同阶段。）

这样做的结果是所有的评估`getCommandsFromUser`都可以共享——GHC 只在内存中保留一份配方的副本，该配方的一部分包括一个指向配方开头的指针。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-09T01:41:59.797

据我了解，您应该忘记 TCO：与其询问递归调用是否处于尾部位置，不如考虑受*保护的递归*。[这个答案](https://stackoverflow.com/a/13042394/176841)我认为是对的。您还可以从总是有趣且具有挑战性的“无限邻域”博客中查看有关[数据和 Codata的帖子。](http://blog.sigfpe.com/2007/07/data-and-codata.html)最后看看[Space Leak Zoo](http://blog.ezyang.com/2011/05/space-leak-zoo/)。

**编辑**：很抱歉，以上内容没有直接解决您关于单子动作的问题；我有兴趣看到像 DanielWagner 这样专门针对 IO monad 的其他答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T10:55:26.317

涉及到 IO 并不重要。你可以在 Haskell wiki 中阅读它：

[IO里面](http://www.haskell.org/haskellwiki/IO_inside)

或者，为了更深入地体验 Haskell 的 IO：

[处理尴尬的小队：Haskell 中的一元输入/输出、并发、异常和外语调用](http://research.microsoft.com/en-us/um/people/simonpj/Papers/marktoberdorf/mark.pdf)

# c# - 使 Image.Source 依赖于 TextBox 和 Label 值的比较

> ID：13782223
> 
> 赞同：0
> 
> 时间：2012-12-08T21:41:46.767
> 
> 标签：c#, wpf, xaml, multidatatrigger

我有以下 XML：

```
<Items>
  <Item>
    <Name>Item One</Name>
    <MyValue>42</MyValue>
  </Item>
</Items> 
```

和 XAML：

```
<DockPanel>
    <DockPanel.Resources>
        <XmlDataProvider x:Key="ItemsXml" XPath="Items/Item"
            Source="Resources/Items.xml"/>
    </DockPanel.Resources>

    <ListBox
        ItemsSource="{Binding Source={StaticResource ItemsXml}}"
        DisplayMemberPath="Name" Name="itemList"/>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="20"/>
            <ColumnDefinition Width="50"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.Resources>
            <Style x:Key="ValueFormat" TargetType="Label">
                <Setter Property="ContentStringFormat" Value="{}/{0,3}"/>
            </Style>
        </Grid.Resources>

        <Image Source="Icons/ConditionFalse.png" Grid.Column="0"/>

        <TextBox Name="myTextBox" VerticalAlignment="Center" Grid.Column="1"/>

        <Label
            Name="myLabel"
            DataContext="{Binding SelectedItem, ElementName=itemList}"
            Style="{StaticResource ValueFormat}"
            VerticalAlignment="Center"
            Content="{Binding XPath=MyValue}"
            Grid.Column="2"/>
    </Grid>
</DockPanel> 
```

我想使`Image.Source`取决于`TextBox.Text`等于`Label`* 的参考值的条件。参考值是对 XML 文件的绑定，因此使用它作为比较的基础也是可以的。将`TextBox`绑定到一个尚不存在的属性，因此可以作为一个选项使用。

*`Label`当前用于`ContentStringFormat`更改其值。如果这是有问题的，它可以被摆脱。

我可以使用[a`DataTrigger`](https://stackoverflow.com/a/1668080/482758)直接绑定到表示此条件的属性，但这感觉像是一种 hack，我宁愿避免这种情况。我尝试设置 a `MultiDataTrigger`，如下所示，但首先我无法使条件适用于`Label`（它确实适用于`TextBox`），其次，在我的情况下，恒定值不好。当条件评估为 false 时，它​​也没有“else”子句或默认值，但如果可以首先进行检查，我希望这不会成为问题。

```
<Image Grid.Column="0">
    <Image.Style>
        <Style TargetType="{x:Type Image}">
            <Style.Triggers>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Value="/ 42"
                            Binding="{Binding Text, ElementName=myTextBox}"/>
                        <Condition Value="/ 42"
                            Binding="{Binding Content, ElementName=myLabel}"/>
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Source" Value="Icons/ConditionTrue.png"/>
                </MultiDataTrigger>
            </Style.Triggers>
        </Style>
    </Image.Style>
</Image> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T03:35:02.667

除非有技术原因导致它不可能，否则我建议您绑定到 ViewModel 而不是绑定到 XAML 树中的元素。使用 ViewModel，您可以将 itemList.SelectedItem 绑定到 ViewModel 上的属性（例如，将其称为 CurrentItem）。此外，将您的 Image 的 Source 绑定到另一个 ViewModel 属性（可能名为 StatusImageSource）。然后，当用户更改 itemList 中的选定值时，您可以检查与 CurrentItem.Set 中标签的值是否相等，并适当地更新 StatusImageSource 值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T23:52:36.973

哈利的评论让我朝着正确的方向前进。

XAML：

```
<Grid.Resources>
    <local:MyImageConverter x:Key="MyImageConverter"/>
</Grid.Resources>

<Image Grid.Column="0" Grid.Row="0">
    <Image.Style>
        <Style TargetType="{x:Type Image}">
            <Setter Property="Source" Value="Icons/ConditionFalse.png"/>
            <Style.Triggers>
                <DataTrigger Value="True">
                    <DataTrigger.Binding>
                        <MultiBinding
                            Converter="{StaticResource MyImageConverter}">
                            <Binding ElementName="myTextBox" Path="Text"/>
                            <Binding ElementName="myLabel" Path="Content"/>
                        </MultiBinding>
                    </DataTrigger.Binding>
                    <Setter Property="Source" Value="Icons/ConditionTrue.png"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Image.Style>
</Image> 
```

C＃

```
public class MyImageConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType,
        object parameter, System.Globalization.CultureInfo culture)
    {
        System.Xml.XmlElement labelValue = values[1] as System.Xml.XmlElement;
        if (labelValue != null)
        {
            return ((string)values[0]) == labelValue.InnerText;
        }
        return false;
    }

    public object[] ConvertBack(object value, Type[] targetType,
       object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

这很快就会变得非常混乱。我现在正在使用它，但如果时间允许，我会根据Whyaduck 的回答将它重新加工成 ViewModel。

# javascript - 如何使用 javascript 从 URL 中提取元数据？

> ID：13782224
> 
> 赞同：1
> 
> 时间：2012-12-08T21:41:47.463
> 
> 标签：javascript, youtube

假设我正在保存一个 bit.ly 网址。如何从中提取元数据？如，它属于哪个站点（我总是可以通过请求来扩展 url），但我想从 url 中获得更多信息。就像它的图像或任何可以与原始 url 相关联的元数据。

示例：对于 youtube 链接，如何提取 youtube 的 favicon 图像和 youtube 在加载 youtube url 时显示的图像（帧）。我必须在这里使用 youtube api 还是可以从数据中提取该信息？

我希望我不会在这里含糊其辞。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:44:54.813

缩短的 url 通常充当索引而不是底层数据的编码。也就是说，您使用 url 中的值联系 url 缩短站点，它会查找相关联的 url。它不会对其进行*解码*，而是将该值用作一组存储 url 的索引。如果有可用的 API 来发现更多信息，或者正如您所指出的，您必须使用 API 实际执行请求并从响应中获取数据。

# ruby-on-rails - delay_job 在回形针上不起作用

> ID：13782228
> 
> 赞同：0
> 
> 时间：2012-12-08T21:42:32.043
> 
> 标签：ruby-on-rails, paperclip, delayed-job

我有这个简单的方法来检查 URL 是否存在，如果不存在，则尝试创建照片对象。

```
 def create_profile_photo(user_id,image_url)
   if Photo.find_by_external_url(image_url).blank?
     profile_photo = Photo.new
     profile_photo.user_id = user_id
     profile_photo.picture_from_url(image_url)
     profile_photo.save
   end   
 end

# Photo.rb
def picture_from_url(url)
  self.external_url = url
  self.attachment = URI.parse(clean_url)
end 
```

它确实有效。但是当我尝试使用它启动方法时`delayed_job`它不起作用。

```
ruby-1.9.2-p290 :085 > MyClass.new.delay.create_profile_photo(347,'http://www.google.com/images/srpr/logo3w.png')
(0.4ms)  COMMIT
 => #<Delayed::Backend::ActiveRecord::Job id: 42, priority: 0, attempts: 0, handler: "--- !ruby/object:Delayed::ProfileableMethod\nobject:...", last_error: nil, run_at: "2012-12-08 21:40:06", locked_at: nil, failed_at: nil, locked_by: nil, queue: nil, created_at: "2012-12-08 21:40:06", updated_at: "2012-12-08 21:40:06"> 
ruby-1.9.2-p290 :085 > Photo.count
   (0.3ms)  SELECT COUNT(*) FROM "photos" 
=> 0 
```

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:55:32.893

**当然，表中没有`Photo`实例。`photos`** 根据您的控制台，您所做的只是将作业排队。

除非您有 DJ 工作者在运行，否则您不能期望 DJ 队列得到处理。如果未处理 DJ 队列，则不能期望排队的作业运行。如果队列中的作业尚未运行，则不能期望`photos`有任何新记录。

运行下面的命令，您会看到作业仍在排队等待运行。

```
Delayed::Job.find(42) 
```

在开发中，运行以下命令来启动一个 DJ 守护进程。

```
script/delayed_job 
```

最后，正如@simonmorley 建议的那样，确保在代码更改之间终止并重新启动守护进程，以便让最新版本的应用程序处理作业。

# c++ - 无法用 clang_complete 完成 qt

> ID：13782233
> 
> 赞同：1
> 
> 时间：2012-12-08T21:42:51.990
> 
> 标签：c++, qt, vim, clang, code-completion

我正在尝试使用[clang_complete](https://github.com/Rip-Rip/clang_complete)作为 vim C++ 完成。我必须注意我也在使用[病原体](https://github.com/tpope/vim-pathogen)。我采购了为 clang-pathogen 提供的 vimball，并将所有内容都放在我的`~/.vim/bundle/Clang_complete`目录中，一切都像魔术一样工作......我的`STL`和`Boost`完成工作正常。

这是我所做的：

* * *

1/创建一个`test_qt.cpp`文件

```
#include <QApplication>
#include <QWidget>
int main(int argc, char *argv[])
{
QApplication app(argc, argv);
QWidget window;
window.resize(250, 150);

window.setWindowTitle("Simple example");
window.show();
return app.exec();
} 
```

* * *

2/跑`qmake -project`

* * *

3/跑`qmake -o Makefile testFiles.pro`

* * *

4/跑`make`

```
 make
 g++ -c -m64 -pipe -O2 -Wall -W -D_REENTRANT -DQT_WEBKIT -DQT_NO_DEBUG -DQT_GUI_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/share/qt4/mkspecs/linux-g++-64 -I. -I/usr/include/qt4/QtCore -I/usr/include/qt4/QtGui -I/usr/include/qt4 -I. -I. -o test_qt.o test_qt.cpp
 g++ -m64 -Wl,-O1 -o testFiles test_qt.o    -L/usr/lib/x86_64-linux-gnu -lQtGui -lQtCore -lpthread 
```

* * *

5/跑了`./testFiles`，一切都很好，我得到了一个愚蠢的窗口......

所以我不明白为什么我无法完成 qt... 我`Makefile`的生成正确，我该怎么办？我试着跑

```
statquant@euclide:~/.vim/testFiles$ make CC= '~/.vim/bundle/Clang_Complete-Pathogen/bin/cc_args.py' CXX='~/.vim/bundle/Clang_Complete-Pathogen/bin/cc_args.py' 
```

但是得到了：

```
make: Nothing to be done for `/home/statquant/.vim/bundle/Clang_Complete-Pathogen/bin/cc_args.py'. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:43:37.510

首先，您的命令中有多余的空格：

```
make CC=<HERE>'~/.vim/bundle/Clang_Complete-Pathogen/bin/cc_args.py' CXX='~/.vim/bundle/Clang_Complete-Pathogen/bin/cc_args.py' 
```

你应该删除它。其次，您的命令是错误的-您没有指定编译器。总而言之，它应该如下所示：

```
make CC='~/.vim/bundle/Clang_Complete-Pathogen/bin/cc_args.py gcc' CXX='~/.vim/bundle/Clang_Complete-Pathogen/bin/cc_args.py g++' -B 
```

这是因为，本质上，`cc_args.py`它将充当包装器（用于编译器可执行文件）来记录在项目编译期间传递了哪些`-I`、`-D`和其他标志。然后它会巧妙地将所有标志转发给编译器本身——因此项目被正确构建。调用`:h clang_complete-cc_args`并查看`cc_args.py`以更好地理解 - 这很简单。

**注意：** `-B`标志用于强制`make`构建，无论您当前的构建是否是最新的。这样，`.clang_complete`文件始终是最新的。

最后，如果它仍然不起作用，则意味着`qmake`生成`makefile`不尊重环境变量`CC`，`CXX`而是编译器可执行文件的硬编码路径。我不`qmake`记得`makefile`.

祝你好运。

# jquery - 查找特定 div 中具有 6 个以上子项的所有 ul 元素？（使用 jQuery）

> ID：13782236
> 
> 赞同：0
> 
> 时间：2012-12-08T21:43:11.387
> 
> 标签：jquery, attributes, html-lists, css-selectors

如何找到特定 div 中具有大于 6 li 子级的所有 ul 元素并添加 UL 元素的属性（即 data-theme="d"）

```
<div id="dicCntr">
    <ul id="ul1">
        <li id="li1">A</li>
        <li id="li2">A</li>
        <li id="li3">A</li>
        <li id="li4">A</li>
        <li id="li5">A</li>
        <li id="li6">A</li>
        <li id="li7">A</li>
        <li id="li8">A</li>
        <li id="li9">A</li>
    </ul>
    <ul id="ul2">
        <li id="li10">B</li>
        <li id="li11">B</li>
    </ul>
    <ul id="ul3">
        <li id="li12">C</li>
        <li id="li13">C</li>
        <li id="li14">C</li>
        <li id="li15">C</li>
        <li id="li16">C</li>
        <li id="li17">C</li>
        <li id="li18">C</li>
    </ul>
    <ul id="ul4">
        <li id="li19">D</li>
        <li id="li20">D</li>
    </ul>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:45:44.637

```
$('#dicCntr ul').filter(
    function() {
        return $(this).children().length > 6;
    }).attr('data-theme', 'd'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:57:17.183

我知道这个问题专门说 jquery 但为什么不是常规的 javascript

```
 var ulHolder = document.getElementById('dicCntr')
uls = ulHolder.getElementsByTagName('ul');
for (i=0; i<uls.length; i++) {
    if (uls[i].children.length > 6) {
        uls[i].setAttribute('data-theme', 'd')      
    }
} 
```

# java - 获取扫描仪的虚假用户输入？（将用户输入从摇摆假控制台重新路由到解析器中的扫描仪）

> ID：13782237
> 
> 赞同：1
> 
> 时间：2012-12-08T21:43:13.790
> 
> 标签：java, stream, java.util.scanner

我是java的新手，所以我希望这将是一个容易回答的问题。

我正在修改一个基于控制台/文本的游戏，使其也有一些 GUI，游戏通常使用解析器中的扫描仪扫描用户输入。我从 Beanshell 2 添加了一个 JConsole 并使用 tukushans 方法重定向输出[https://stackoverflow.com/a/1324525/1236210](https://stackoverflow.com/a/1324525/1236210)

但是，现在我需要学习如何将用户从该控制台输入的命令 < enter> 发送到解析器中的扫描仪。解析器中与此相关的代码是：

```
import java.util.Scanner;

public Parser() 
{
    reader = new Scanner(System.in);
}

...

String inputLine;   // will hold the full input line
    String word1 = null;
    String word2 = null;

    System.out.print("> ");     // print prompt       

    inputLine = reader.nextLine();

    // Find up to two words on the line.
    Scanner tokenizer = new Scanner(inputLine);
    if(tokenizer.hasNext()) {
        word1 = tokenizer.next();      // get first word
        if(tokenizer.hasNext()) {
            word2 = tokenizer.next();      // get second word
            // note: we just ignore the rest of the input line.
        }
    }
    return etc. 
```

**我的主要问题是人们通常如何创建一个虚假的输入流并将其提供给像阅读器这样的扫描仪？**

如果你能回答这个问题和/或将我重定向到好的文档，我会非常高兴 ^_^ 我希望有了这些知识，我自己会想办法将这个控制台连接到我的扫描仪。但是，如果您还回答了如何为 JConsole 执行此操作，那就太棒了，如果您这样做了，那么您还应该用[Java 发布它 - 如何从 BeanShell 的 JConsole 读取用户输入？](https://stackoverflow.com/questions/10155782/java-how-to-read-user-input-from-beanshells-jconsole)

# ruby-on-rails - 如何直接从 HAML 中的 URL 插入图像？

> ID：13782238
> 
> 赞同：2
> 
> 时间：2012-12-08T21:43:22.570
> 
> 标签：ruby-on-rails

我正在尝试这样做：

```
= image_tag("images/no-photo.jpg") 
```

我的 HTML 看起来像这样：

```
 <img alt="No-photo" src="/assets/images/no-photo.jpg" /> 
```

它只显示替代文本，而不是图片，尽管图片在那里。

当我转到 HTML 代码浏览器中的链接时，我看到它给出了路由错误（没有路由匹配 GET /assets/images/no-photo.jpg）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:54:05.360

图片在哪里？在 public/images/no-photo.jpg 中？或者在 app/assets/images/no-photo.jpg 中？或者？

如果您想引用 image_tag 的完整/绝对 url，请执行以下操作：

```
= image_tag("/images/no-photo.jpg") 
```

前导斜线告诉它不要弄乱它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-11T14:06:43.693

```
%img{:src => asset_path("example.jpg")}/ 
```

# android - 在 android 中通过 ant 包含另一个项目

> ID：13782240
> 
> 赞同：0
> 
> 时间：2012-12-08T21:43:29.477
> 
> 标签：android, ant, properties, jar

我正在尝试通过 ant 将一个 no-android 项目包含到我的 android-project 中。这是一个普通项目，每次都会更改，所以我无法创建一个 .jar 文件并将其导出到“libs”文件夹。

谁能帮我？

我是否必须更改我的 project.properties 中的某些内容？

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:59:19.770

使用[apache ivy 插件](http://ant.apache.org/ivy/)来声明项目之间的依赖关系。然后可以使用[Jenkins ivy 插件](https://wiki.jenkins-ci.org/display/JENKINS/Ivy+Plugin)来检测更改并在构建公共项目后自动触发项目的构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T23:59:25.593

```
<target name="-pre-compile">
<path id="project.all.jars.path">
    <path path="${toString:project.all.jars.path}"/>
    <fileset dir="${jar.libs.dir}">
        <include name="*.jar"/>
    </fileset>
</path> 
```

如果我将它集成到我的 build.xml 中，我的项目将正确包含该库；）

# java - Eclipse Indigo：列表中缺少编译器合规级别 1.7

> ID：13782241
> 
> 赞同：2
> 
> 时间：2012-12-08T21:43:30.243
> 
> 标签：java, eclipse

我安装了 Java 7 JDK (jdk-7u9-windows-x64.exe) 并启动了 Eclipse Indigo 来尝试使用新的菱形语法的语句。它不编译。我在 Preferences - Java - Installed JREs 中添加了 jdk1.7.0_09。在 Preferences - Java - Compiler 我想设置 1.7 的合规级别，但我的下拉列表只包含 1.3 - 1.6。我怎样才能让 1.7 出现在这里？
版本：Indigo 发布版本 ID：20110615-0604

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:50:52.427

[Indigo](http://www.eclipse.org/forums/index.php/m/717567/)运气不好，安装 Juno。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T21:59:30.643

从eclipse页面复制：

> 下载 Eclipse 3.7SR2 以获得开箱即用的支持。或者，按照以下步骤在早期构建中获取 JDT 源代码并启动包含 Java 7 功能的运行时工作台。

[http://wiki.eclipse.org/JDT_Core/Java7](http://wiki.eclipse.org/JDT_Core/Java7)

编辑：Eclipse indigo sr2 可以下载：[这里](http://www.eclipse.org/downloads/packages/release/indigo/sr2)

# java - Hibernate：有没有办法自动将原生 SQL 结果转换为自定义对象？

> ID：13782246
> 
> 赞同：3
> 
> 时间：2012-12-08T21:44:26.043
> 
> 标签：java, sql, hibernate

我有一个本机 SQL 查询，它返回几个计算结果（例如来自多个表的总和和平均值），我想将这些结果加载到包含所有必要字段的自定义对象中。我知道 Hibernate 提供了该`addEntity`方法，它允许您指定结果表示的映射实体的类型。

在这种情况下，由于结果来自多个表，因此我使用的自定义对象不是映射实体。有没有办法让休眠返回 a`List<CustomObject>`或者我必须手动将结果复制到正确的对象？谢谢。

```
Query query = this.sessionFactory.getCurrentSession().createSQLQuery(queryString.toString());

return (List<CustomObject>)query.list(); //doesn't work, obviously 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T22:15:56.040

看看[结果转换器](http://in.relation.to/2006/03/17/hibernate-32-transformers-for-hql-and-sql/)。它们旨在完全满足您的需求，并适用于 HQL 和 SQL。

# json - spring mvc 3 内容类型“application/json”适用于客户端，但不适用于单元测试

> ID：13782252
> 
> 赞同：6
> 
> 时间：2012-12-08T21:44:53.933
> 
> 标签：json, rest, spring-mvc

我有一个使用 Spring 3.1 的 Rest Controller 方法，如下所示：

```
@RequestMapping(value="/user", method=RequestMethod.POST, consumes={MediaType.APPLICATION_JSON_VALUE})
public ResponseEntity<String> addUser(@RequestBody @Valid User user){   
    System.out.println("called / user method");
      try{
        user = userService.addUser(user); 
        return responseBuilder.addApiResourceSucceeded(user,null);
      }catch(Exception e){
        return responseBuilder.apiActionFailed("user already exists", HttpStatus.CONFLICT);  
      }
} 
```

我有如下所示的测试：

```
@Before
public void setUp() {
    adapter = new AnnotationMethodHandlerAdapter();
    request = new MockHttpServletRequest();
    response = new MockHttpServletResponse();
    mapper = new ObjectMapper();
}
@Test
public void testAddUser() throws Exception {
    request.setMethod("POST");
    request.setContentType(MediaType.APPLICATION_JSON_VALUE);
    request.setRequestURI("/user");

    ObjectNode userJson = mapper.createObjectNode();
    userJson.put("userId", "jonnybz");
    userJson.put("email", "test@gmail.com");
    userJson.put("password", "password");
    userJson.put("longitude",-10.127205999);
    userJson.put("latitude", 57.252269);
    ArrayNode arrNode = mapper.createArrayNode();
    arrNode.add(-10.1272059999);
    arrNode.add(57.2522);
    userJson.put("lonLat",arrNode);
    request.setContent(mapper.writeValueAsBytes(userJson));
    adapter.handle(request, response, userController); 

    String content = response.getContentAsString();
    assertEquals(200, response.getStatus());
    User user = dao.listAll().get(0);
    objectId = user.getId();
    assertNotNull(objectId);
} 
```

当我从我的客户端应用程序（使用 angular 开发）对此端点执行调用时，它运行良好，但是当我运行测试时，我得到一个“来自 HttpMediaTypeNotSupportedException 的内容类型'application/json'”错误，我无法跟踪下。该请求似乎从未达到我的方法。我在这里错过了一些简单的东西吗？

**通过切换到[spring-mvc-test](https://github.com/SpringSource/spring-test-mvc)框架并像这样构建我的测试来**解决这个问题：****

 **```
@Test
public void testAddUser() throws Exception {

    ObjectNode userJson = mapper.createObjectNode();
    userJson.put("userId", "jonnbz");
    userJson.put("email", "test@gmail.com");
    userJson.put("password", "password");
    userJson.put("longitude",-10.667205999);
    userJson.put("latitude", 74.252269);
    ArrayNode arrNode = mapper.createArrayNode();
    arrNode.add(-10.667205999);
    arrNode.add(74.252269);
    userJson.put("lonLat",arrNode);
    MvcResult res = MockMvcBuilders.xmlConfigSetup("classpath:test-context.xml").build()
           .perform(MockMvcRequestBuilders.post("/user")
           .accept(MediaType.APPLICATION_JSON)
           .contentType(MediaType.APPLICATION_JSON)
           .body(mapper.writeValueAsBytes(userJson)))
           .andExpect(status().isOk())
           .andExpect(content().type(MediaType.APPLICATION_JSON))
           .andReturn();
            System.out.println(res.getResponse().getContentAsString());

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:00:38.943

您还应该`Accept`在测试中包含一个“application/json”的标头，因为您已经包含了一个`consumes="application/json"`，Spring MVC 会将 Accept 标头值匹配到消耗值，然后才调用映射的方法。**

# .net - GDI+ 多线程

> ID：13782253
> 
> 赞同：0
> 
> 时间：2012-12-08T21:45:00.037
> 
> 标签：.net, multithreading, graphics

使用多个任务在单独的位图上绘图并结合单个任务时，性能没有提高的原因是什么？（见代码）

```
Private test1 As bitmap_drawer
Private test2 As bitmap_drawer
Private test3 As bitmap_drawer
Private test4 As bitmap_drawer
Private tmptime As String
Private tmptime_1 As DateTime
Private tmptime_2 As DateTime
Private tmptimespan_1 As New TimeSpan

Sub Main()

    Console.WriteLine("4 tasks (parallel) graphics.draw")

    test1 = New bitmap_drawer
    test2 = New bitmap_drawer
    test3 = New bitmap_drawer
    test4 = New bitmap_drawer

    tmptime_1 = DateTime.Now

    Dim action1 As Action(Of Object) = Sub(obj As Object)
                                           Console.WriteLine("Task={0}, Thread={1}", Task.CurrentId, Thread.CurrentThread.ManagedThreadId)
                                           test1.DoDrawing()
                                       End Sub
    Dim action2 As Action(Of Object) = Sub(obj As Object)
                                           Console.WriteLine("Task={0}, Thread={1}", Task.CurrentId, Thread.CurrentThread.ManagedThreadId)
                                           test2.DoDrawing()
                                       End Sub

    Dim action3 As Action(Of Object) = Sub(obj As Object)
                                           Console.WriteLine("Task={0}, Thread={1}", Task.CurrentId, Thread.CurrentThread.ManagedThreadId)
                                           test3.DoDrawing()
                                       End Sub

    Dim action4 As Action(Of Object) = Sub(obj As Object)
                                           Console.WriteLine("Task={0},  Thread={1}", Task.CurrentId, Thread.CurrentThread.ManagedThreadId)
                                           test4.DoDrawing()
                                       End Sub

    Dim t1 As New Task(action1, "1")
    Dim t2 As New Task(action2, "2")
    Dim t3 As New Task(action3, "3")
    Dim t4 As New Task(action4, "4")

    t1.Start()
    t2.Start()
    t3.Start()
    t4.Start()

    Do

    Loop Until t1.IsCompleted And t2.IsCompleted And t3.IsCompleted And t4.IsCompleted

    t1.Dispose()
    t2.Dispose()
    t3.Dispose()
    t4.Dispose()

    tmptime_2 = DateTime.Now
    tmptimespan_1 = (tmptime_2 - tmptime_1)
    tmptime = tmptimespan_1.Seconds.ToString & "sec  " & tmptimespan_1.Milliseconds.ToString & "msec"
    Console.WriteLine("   parallel total: " & tmptime)     ''time:  1sec 136ms

    ''++++++++++++++++++++++++++++++++++++++++++++++++++++++++

    Console.WriteLine("  ")
    Console.WriteLine("4 tasks (serial) graphics.draw")
    tmptime_1 = DateTime.Now

    test1.DoDrawing()
    test2.DoDrawing()
    test3.DoDrawing()
    test4.DoDrawing()

    tmptime_2 = DateTime.Now
    tmptimespan_1 = (tmptime_2 - tmptime_1)
    tmptime = tmptimespan_1.Seconds.ToString & "sec  " & tmptimespan_1.Milliseconds.ToString & "msec"
    Console.WriteLine("   serial total: " & tmptime)   ''time:  0sec 857ms

    ''Conclusion: Both methods generate almost same time

    Console.ReadKey()
End Sub 
```

现在类 bitmapdrawer

```
Public Class bitmap_drawer

Private tmptime As String
Private tmptime_1 As DateTime
Private tmptime_2 As DateTime
Private tmptimespan_1 As New TimeSpan

Private drawing_parts() As drawing_part

Private g As Graphics
Public bm As Bitmap

Sub New()
    ''init drawing data array
    ReDim drawing_parts(124999)

    ''create drawing data
    MakeDrawingData()

    ''create a bitmap
    bm = New Bitmap(1000, 1000, Imaging.PixelFormat.Format32bppPArgb)
    ''create  graphics from the bitmap
    g = Graphics.FromImage(bm)

End Sub

Sub DoDrawing()
    Dim i As Int32
    tmptime_1 = DateTime.Now
    Dim drawing_pen As New Pen(Color.Black, 0)

    '' do the drawing on the bitmap
    For i = 0 To 124999
        g.DrawPath(drawing_pen, drawing_parts(i).pat)
    Next

    tmptime_2 = DateTime.Now
    tmptimespan_1 = (tmptime_2 - tmptime_1)
    tmptime = tmptimespan_1.Seconds.ToString & "sec  " & tmptimespan_1.Milliseconds.ToString & "msec"
    Console.WriteLine("                   " & tmptime)

End Sub

Private Sub MakeDrawingData()
    Dim x, y As Int32
    Dim i As Int32
    i = 0
    For y = 0 To 249
        For x = 0 To 249
            drawing_parts(i) = New drawing_part With {.pat = New GraphicsPath}
            drawing_parts(i).pat.AddRectangle(New Rectangle(New Point(6 * x, 6 * y), New Size(5, 5)))
            drawing_parts(i).pat.Flatten()
            i += 1
            drawing_parts(i) = New drawing_part With {.pat = New GraphicsPath}
            drawing_parts(i).pat.AddEllipse(6 * x, 6 * y, 8, 5)
            drawing_parts(i).pat.Flatten()
            i += 1
        Next
    Next

End Sub 
```

结束类

现在类绘图部分

```
Public Class drawing_part

Private tmp_pat As GraphicsPath
Public Property pat() As GraphicsPath
    Get
        Return tmp_pat
    End Get
    Set(ByVal Value As GraphicsPath)
        tmp_pat = Value
    End Set
End Property 
```

结束类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T09:54:33.963

GDI 操作是硬件加速的——即它使用 GPU 尽可能多地进行绘图。然而，GPU 是一个单一的硬件资源，由所有线程共享。因此，即使您有 4 个线程在合适的 CPU 上并行运行，GPU 仍然会完成这项工作。在多个任务之间切换也会产生开销。

但是，如果您的绘图操作有很多 CPU 使用率 - 例如准确计算要绘制的内容 - 那么并行化它可能是一个胜利。

# ruby - 如何：使用 ruby -opencv 获取阈值图像

> ID：13782254
> 
> 赞同：2
> 
> 时间：2012-12-08T21:45:02.690
> 
> 标签：ruby, opencv

可以帮助将此代码转换为 ruby​​-openvc 吗？

**原文** [http://aishack.in/tutorials/tracking-colored-objects-in-opencv/](http://aishack.in/tutorials/tracking-colored-objects-in-opencv/)

```
IplImage* GetThresholdedImage(IplImage* img)
{
  #Convert the image into an HSV image
  IplImage* imgHSV = cvCreateImage(cvGetSize(img), 8, 3);
  cvCvtColor(img, imgHSV, CV_BGR2HSV);

  #create a new image that will hold the threholded image (which will be returned).
  IplImage* imgThreshed = cvCreateImage(cvGetSize(img), 8, 1);

  #Now we do the actual thresholding:
  cvInRangeS(imgHSV, cvScalar(20, 100, 100), cvScalar(30, 255, 255), imgThreshed)

  cvReleaseImage(&imgHSV);
  return imgThreshed;
} 
```

**翻译**

```
 def getThresholdedImage2 (img)
  #blur the source image to reduce color noise
  img = img.smooth(CV_GAUSSIAN, 7, 7)

  #convert the image to hsv(Hue, Saturation, Value) so its
  #easier to determine the color to track(hue)  imgHSV = IplImage.new(img.width, img.height, 8, 3);
  imgHSV = img.BGR2HSV

  #create a new image that will hold the threholded image (which will be returned).
  imgThreshed = IplImage.new(img.width, img.height, 8, 1);

  #Now we do the actual thresholding:
  imgThreshed = imgHSV.in_range(CvScalar.new(20, 100, 100), CvScalar.new(30, 255, 255));

  return imgThreshed
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:46:17.307

实际上，我根本不了解红宝石，但似乎我找到了解决您问题的方法。[Ruby-OpenCV](https://github.com/ruby-opencv/ruby-opencv)似乎只是一个库包装器。

例如，如果您想找到`cvInRangeS`函数的类似物，您应该执行以下操作。

通过在源文件中搜索，我发现[ext/opencv/cvmat.h](https://github.com/ruby-opencv/ruby-opencv/blob/master/ext/opencv/cvmat.h#L78)包含以下内容：

```
VALUE rb_range(VALUE self, VALUE start, VALUE end);
VALUE rb_range_bang(VALUE self, VALUE start, VALUE end); 
```

在[cpp](https://github.com/ruby-opencv/ruby-opencv/blob/master/ext/opencv/cvmat.cpp#L2324)文件中有描述：

```
/*
 * call-seq:
 *   in_range(<i>min, max</i>) -> cvmat
 *
 * Check that element lie between two object.
 * <i>min</i> and <i>max</i> should be CvMat that have same size and type, or CvScalar.
 * Return new matrix performed per-element,
 *  dst(I) = within the range ? 0xFF : 0
 */ 
```

所以你应该通过这种方式找到所有需要的 ruby​​ 函数。祝你好运！

# c# - 40f等于40像素？

> ID：13782257
> 
> 赞同：-1
> 
> 时间：2012-12-08T21:45:23.247
> 
> 标签：c#, xna

如果我按一次 A 按钮，我希望我的角色跳高 40 像素。但不知道40f是否等于40像素？你觉得我的代码怎么样？怎么了？另外，我希望我的程序在每台计算机上以相同的速度运行。

```
public class Game1 : Microsoft.Xna.Framework.Game
{
GraphicsDeviceManager graphics;
SpriteBatch spriteBatch;
Texture2D image, water;
float Gravity = 5.0F;
float Acceleration = 20.0F;
Vector2 Position = new Vector2(1200,720);
Vector2 Velocity;
float rotation = 0;
SpriteEffects flip;
Vector2 Speed = new Vector2(0, 0);

public Game1()
{
    graphics = new GraphicsDeviceManager(this);
    Content.RootDirectory = "Content";
    graphics.PreferredBackBufferWidth = 1280;
    graphics.PreferredBackBufferHeight = 720;
}

protected override void Initialize()
{
    base.Initialize();
}

protected override void LoadContent()
{   
    spriteBatch = new SpriteBatch(GraphicsDevice);
    image = Content.Load<Texture2D>("cartoondolphin");
    water = Content.Load<Texture2D>("background");
    flip = SpriteEffects.None;
}

protected override void Update(GameTime gameTime)
{
    float VelocityX = 0f;
    float VelocityY = 0f;

    float time = (float)gameTime.ElapsedGameTime.TotalSeconds;
    KeyboardState kbState = Keyboard.GetState();
    if(kbState.IsKeyDown(Keys.Left)) 
    {
        rotation = 0;
        flip = SpriteEffects.None;
        VelocityX += -5f;
    } 

    if(kbState.IsKeyDown(Keys.Right)) 
    {
        rotation = 0;
        flip = SpriteEffects.FlipHorizontally;
        VelocityX += 5f;
    } 

    // jump if the dolphin is under water
    if(Position.Y >= 670)
    {
        if (kbState.IsKeyDown(Keys.A))
        {     
            if (flip == SpriteEffects.None)
            { 
              VelocityY += 40f;
            }
            else
            { 
              VelocityY += 40f;
            }
        }
    } 
    else 
    {
        VelocityY += -10f;
    }

    float deltaY = 0;
    float deltaX = 0;

    deltaY = Gravity * (float)gameTime.ElapsedGameTime.TotalSeconds;

    deltaX += VelocityX * (float)gameTime.ElapsedGameTime.TotalSeconds * Acceleration;
    deltaY += -VelocityY * (float)gameTime.ElapsedGameTime.TotalSeconds * Acceleration;

    Speed = new Vector2(Speed.X + deltaX, Speed.Y + deltaY);

    Position += Speed * (float)gameTime.ElapsedGameTime.TotalSeconds;

    Velocity.X = 0;

    if (Position.Y + image.Height/2 > graphics.PreferredBackBufferHeight)
        Position.Y = graphics.PreferredBackBufferHeight - image.Height/2;

    base.Update(gameTime);
}

protected override void Draw(GameTime gameTime)
{
    GraphicsDevice.Clear(Color.CornflowerBlue);
    spriteBatch.Begin();
    spriteBatch.Draw(water, new Rectangle(0, graphics.PreferredBackBufferHeight -100, graphics.PreferredBackBufferWidth, 100), Color.White);
    spriteBatch.Draw(image, Position, null, Color.White, MathHelper.ToRadians(rotation), new Vector2(image.Width / 2, image.Height / 2), 1, flip, 1);
    spriteBatch.End();           

    base.Draw(gameTime);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:09:49.507

问题是你没有考虑`gameTime`到。如果具有快速 CPU 的计算机执行代码的速度是速度较慢的 PC 的两倍，那么速度值将增加两倍（相对于较慢的 PC）。

当您有如下代码时：

```
VelocityX += 5f; 
```

您需要跟踪 last `gameTime`，并获取帧之间的差异，然后将其乘以您的常数。[（从Xna](https://stackoverflow.com/questions/4916168/xna-adding-gravity-to-a-2d-sprite)抓取的一些代码将重力添加到 2d 精灵）

```
int updateTime = gt.ElapsedGameTime.TotalMilliseconds - oldgt.ElapsedGameTime.TotalMilliseconds;

float timeScalar = updateTime / AVG_FRAME_TIME;

VelocityX += 5f * timeScalar; 
```

# php - 如何在 PHP 中操作变量占位符？

> ID：13782258
> 
> 赞同：2
> 
> 时间：2012-12-08T21:45:31.140
> 
> 标签：php

在不使用正则表达式的情况下，如果我将数组保存为 json 格式，有没有办法这样做？我对 json 感兴趣，只是因为我使用的是 mongodb，所以输出以 json 格式输出。我有一个名为的字段`docroot`，它本质上是一个目录路径。

```
docroot : "secure.unstable.qa.example.com" 
```

唯一可以根据其他因素改变的两部分是`unstable`，`qa.`我希望的是一种放置“标记”的方法，以便可以轻松地用适当的变量替换它们。

例如：

```
docroot : "secure.{STREAMS}.{ENV}.example.com"
docroot : "unsecure.{STREAMS}.{ENV}.example.com" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:11:32.410

如果保证变量按特定顺序排列（根据您的示例，它们是），那么我建议[不要重新发明轮子](http://us3.php.net/manual/en/function.sprintf.php)：

```
// Assuming $json contains your JSON

$streams = 'foo';
$env = 'bar';
$data = json_decode($json, TRUE);

var_dump($data['docroot']); // "secure.%s.%s.example.com"
var_dump(sprintf($data['docroot'], $streams, $env)); // "secure.foo.bar.example.com" 
```

如果变量不能得到保证，或者您只想使用更具描述性的占位符，只需选择一些唯一的分隔符（一些不太可能实际出现在数据中的字符或字符集），然后使用[`str_replace()`](http://us3.php.net/manual/en/function.str-replace.php).

# ios - 过滤巨大的 NSArray

> ID：13782263
> 
> 赞同：4
> 
> 时间：2012-12-08T21:45:51.907
> 
> 标签：ios, nsarray, nspredicate

我正在使用 NSPredicate 过滤 NSArray，并将过滤后的数组用于我的 UITableView。当用户在 UITextField 中输入文本时，我正在使用此过滤。所以每次 UITextField 中的文本发生变化时，我都会调用我的过滤器函数。

它看起来像这样：

```
NSArray *hugeArray = ...;
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name == %@", input];
_resultArray = [hugeArray filteredArrayUsingPredicate:predicate];
[_myTableView reloadData]; 
```

当我使用具有大量对象的 NSArray 时，输入变得非常慢（UI 中的完整输入变得很慢）。是否有可能获得更好的性能或在后台运行过滤的命令？

不应阻止在 UITextField 中写入内容。当 UITableView 将在输入后很短的时间后刷新时，它可能没问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-08T21:59:08.100

`NSPredicate`注重灵活性而不是速度。对于内存中的`NSArray`（即不是核心数据关系），通常只需使用循环即可获得更好的性能。

如果仍然太慢，那么有几种方法：

*   合并您的请求。请参阅[是否有一种简单的方法（在 Cocoa/iOS 中）将方法调用排队以在下一个运行循环中运行一次？](https://stackoverflow.com/questions/7518213/is-there-a-simple-way-in-cocoa-ios-to-queue-a-method-call-to-run-once-in-the-n)您可以创建一个合并蹦床，以便每隔几百毫秒更新一次列表。这样，如果用户键入非常快，您就不会重新过滤每个字符的列表。

*   更聪明地过滤。如果您刚刚过滤了“bo”，而您现在想要过滤“bob”，那么您知道它是之前列表的子集。您不必重新过滤所有内容。为此编写一个好的算法需要一些工作，但可以显着提高性能。

*   执行过滤`NSOperationQueue`（比 GCD 更容易取消，但 GCD 也可以），并让 UI 使用 KVO 来通知过滤后的数组何时发生变化。

*   在过滤时跟踪实际更改（添加/删除）。`reloadData`如果你能提供帮助，你不应该调用你的表格视图。您应该执行插入和删除 ( `insertRowsAtIndexPaths:`)。这样可以避免不断搅动您的细胞，而且通常看起来也更好。同样，代码更复杂，但改进可能是巨大的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-11T14:53:14.300

如果您仍想使用谓词并且对象顺序不重要（意味着对象的索引无关紧要），您可以将您的转换`NSArray`为`NSSet`. **过滤集合（使用`NSPredicate`）比数组快得多**。

```
NSSet *hugeSet = [NSSet setWithArray:hugeArray]
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name == %@", input];
NSSet *filteredSet = [hugeSet filteredSetUsingPredicate: predicate]; 
```

[Apple 文档](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/Collections/Collections.html)中有关 NSSet、NSArray 和 NSDictionary 的更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T21:53:21.003

我认为在后台运行它是解决方案。在另一个队列上执行查询，然后在主队列上重新加载表。使用 GCD，它看起来像这样......

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
        NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name == %@", input];
        _resultArray = [hugeArray filteredArrayUsingPredicate:predicate];

          dispatch_async(dispatch_get_main_queue(), ^{
                [_myTableView reloadData];
          });
    }); 
```

# mysql - MySql 性能查找 1 公里内的所有用户

> ID：13782264
> 
> 赞同：0
> 
> 时间：2012-12-08T21:45:57.730
> 
> 标签：mysql, sql, complexity-theory, spatial, spatial-index

我有 mysql 表，需要找到彼此相距 1 公里以内的所有用户表：

```
Geo
----------
id(int)
location(geometry)  with spatial index
username(string) 
```

可以解决：

1.  由用户迭代 i ... n
2.  对于每个选择特定多边形内的所有用户，使用索引
3.  互相发信息

所以复杂性将是〜O（n）或更多（取决于索引），还有其他性能更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T16:38:21.963

由于您的数据是 2D 的，并且您知道您的半径，您可以为您的数据建立一个网格索引。然后每个小区将只向每个相邻小区发送消息。

计算单元分配是 O(n)。所以这应该把这个任务降低到`n * O(m * m)`，`m`你的最大单元占用时间是什么时候。

请注意，这里很难保证任何事情。如果您的所有对象都在 1 公里的半径范围内，那么没有索引会对您有太大帮助。每个人都必须发送给其他人，因为这将是二次的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:00:15.950

Mysql 使用[R-Tree](http://en.wikipedia.org/wiki/R-tree)来[创建空间索引](http://dev.mysql.com/doc/refman/5.0/en/optimizing-spatial-analysis.html)，因此只要您的索引适合内存，您就应该拥有比 O(n) 更好的性能。

# sql - SQL Server 外键表何时过多？

> ID：13782265
> 
> 赞同：2
> 
> 时间：2012-12-08T21:45:57.763
> 
> 标签：sql, sql-server-2008, database-design

当我有以下两张表时，`StatusTypes`这张表会被认为是矫枉过正吗？即使用它比不使用它有更多好处吗？

在这种情况下，我不希望必须在管理后端加载这些状态来添加或更改/删除它们，但另一方面，我通常不喜欢不使用外键。

我正在寻找支持和反对分离状态类型或将其保留在审计表中的原因。

任何帮助，将不胜感激。

```
 -- i.e. NEW, SUBMITTED, UPDATED
    CREATE TABLE [dbo].[StatusTypes](
        [ID] [int] IDENTITY(1,1) NOT NULL,
        [Name] [nvarchar](250) NOT NULL,
        CONSTRAINT [PK_StatusTypes] PRIMARY KEY CLUSTERED ([ID] ASC)
    ) ON [PRIMARY]
    GO

    CREATE TABLE [dbo].[Audits](
        [ID] [int] IDENTITY(1,1) NOT NULL,
        [Description] [nvarchar](500) NULL,
        [Country_Fkey] [int] NOT NULL,
        [User_Fkey] [int] NOT NULL,
        [CreatedDate] [date] NOT NULL,
        [LastAmendedDate] [date] NULL,
        [Status_Fkey] [int] NOT NULL,
        CONSTRAINT [PK_Audits] PRIMARY KEY CLUSTERED ([ID] ASC)
    ) ON [PRIMARY]
    GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T21:58:07.570

在这种情况下，我喜欢保留查找表以强制将状态作为一组类型之一。一些数据库有枚举类型，或者可以使用检查约束，但这是 IMO 最便携的方法。

但是，我使查找表只包含一个包含类型名称的字符串列。这样您就不必实际加入查找表，并且您的 ORM（假设您使用一个）可能完全不知道它。

在这种情况下，架构将如下所示：

```
CREATE TABLE [dbo].[StatusTypes](
    [ID] [nvarchar](250) NOT NULL,
    CONSTRAINT [PK_StatusTypes] PRIMARY KEY CLUSTERED ([ID] ASC)
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[Audits](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    ...
    [Status] [nvarchar](250) NOT NULL,
    CONSTRAINT [PK_Audits] PRIMARY KEY CLUSTERED ([ID] ASC),
    CONSTRAINT [FK_Audit_Status] FOREIGN KEY (Status) REFERENCES StatusTypes(ID)
) ON [PRIMARY]
GO 
```

对特定类型的审计项目的查询将是：

```
SELECT ...
FROM Audits
WHERE Status = 'ACTIVE' 
```

因此仍然强制执行参照完整性，但查询不需要额外的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:32:28.013

我将提供一个反驳论点：将您的开发时间用在最有用的地方。也许你不需要这个运行时检查那么多。也许您可以将开发时间用于其他更有用的检查。

是否有可能设置无效的状态值？您的应用程序肯定会使用一组常量或枚举，因此不太可能出现一些流氓值。

也就是说，确保完整性有很多价值。我喜欢用一个检查约束来覆盖我所有的“枚举”列，`BETWEEN`这在运行时可以快速完成，甚至更快。

# ruby-on-rails - 失败的 rspec Rails 教程第 9.3 章

> ID：13782267
> 
> 赞同：1
> 
> 时间：2012-12-08T21:46:08.363
> 
> 标签：ruby-on-rails, railstutorial.org

我没有通过 3 次测试，我在这里和互联网上找到了很多例子，但我似乎找不到哪里出错了。谢谢你的帮助。

```
1) User pages signup with valid information edit page 
 Failure/Error: before { visit edit_user_path(user) }
 ActionView::Template::Error:
   undefined method `model_name' for NilClass:Class
 # ./app/views/users/edit.html.erb:6:in  `_app_views_users_edit_html_erb___4113112884365867193_70232486166220'
 # ./spec/requests/user_pages_spec.rb:96:in `block (5 levels) in <top (required)>'

2) User pages signup with valid information edit page 
 Failure/Error: before { visit edit_user_path(user) }
 ActionView::Template::Error:
   undefined method `model_name' for NilClass:Class
 # ./app/views/users/edit.html.erb:6:in `_app_views_users_edit_html_erb___4113112884365867193_70232486166220'
 # ./spec/requests/user_pages_spec.rb:96:in `block (5 levels) in <top (required)>'

3) User pages signup with valid information edit page 
 Failure/Error: before { visit edit_user_path(user) }
 ActionView::Template::Error:
   undefined method `model_name' for NilClass:Class
 # ./app/views/users/edit.html.erb:6:in `_app_views_users_edit_html_erb___4113112884365867193_70232486166220'
 # ./spec/requests/user_pages_spec.rb:96:in `block (5 levels) in <top (required)>'

Finished in 0.26515 seconds
3 examples, 3 failures

Failed examples:

rspec ./spec/requests/user_pages_spec.rb:100 # User pages signup with valid information edit page 
rspec ./spec/requests/user_pages_spec.rb:99 # User pages signup with valid information edit page 
rspec ./spec/requests/user_pages_spec.rb:101 # User pages signup with valid information edit page 
```

authentication_pages_spec.rb

```
 require 'spec_helper'

 describe "Authentication" do

 subject { page }

 describe "signin page" do
  before { visit signin_path }

  it { should have_selector('h1',    text: 'Sign in') }
  it { should have_selector('title', text: 'Sign in') }
end

describe "signin" do
before { visit signin_path }

describe "with invalid information" do
  before { click_button "Sign in" }

  it { should have_selector('title', text: 'Sign in') }
  it { should have_selector('div.alert.alert-error', text: 'Invalid') }

  describe "after visiting another page" do
    before { click_link "Home" }
    it { should_not have_selector('div.alert.alert-error') }
  end
end

describe "with valid information" do
  let(:user) { FactoryGirl.create(:user) }
  before do
    fill_in "Email", with: user.email
    fill_in "Password", with: user.password
    click_button "Sign in"
  end

  it { should have_selector('title', text: user.name) }
  it { should have_link('Profile', href: user_path(user)) }
  it { should have_link('Sign out', href: signout_path) }
  it { should_not have_link('Sign in', href: signin_path) }

  describe "followed by signout" do
    before { click_link "Sign out" }
    it { should have_link('Sign in') }
  end
 end
end

end 
```

这是 users_controller：

```
 class UsersController < ApplicationController

 def show
   @user = User.find(params[:id])
 end

 def new
    @user = User.new
 end

 def create
     @user = User.new(params[:user])
    if @user.save
    sign_in @user
  flash[:success] = "Welcome to the Sample App!"
  redirect_to @user
else
  render 'new'
  end
 end
end

 def edit
     @user = User.find(params[:id])
 end 
```

编辑.html.erb：

```
 <% provide(:title, "Edit user") %> 
  <h1>Update your profile</h1>

<div class="row">
 <div class="span6 offset3">
  <%= form_for(@user) do |f| %>
  <%= render 'shared/error_messages' %>

  <%= f.label :name %>
  <%= f.text_field :name %>

  <%= f.label :email %>
  <%= f.text_field :email %>

  <%= f.label :password %>
  <%= f.password_field :password %>

  <%= f.label :password_confirmation, "Confirm Password" %>
  <%= f.password_field :password_confirmation %>

   <%= f.submit "Save changes", class: "btn btn-large btn-primary" %>
  <% end %>

    <%= gravatar_for @user %>
  <a href="http://gravatar.com/emails">change</a>
 </div> 
```

这是 user_pages_spec：

```
 require 'spec_helper'

describe "User pages" do

subject { page }

describe "profile page" do
let(:user) { FactoryGirl.create(:user) }
before { visit user_path(user) }

it { should have_selector('h1', text: user.name) }
it { should have_selector('title', text: user.name) }
end

describe "signup page" do
 before { visit signup_path }

it { should have_selector('h1', text: 'Sign up') }
it { should have_selector('title', text: full_title('Sign up')) }
end

describe "signup" do

before { visit signup_path }

describe "with invalid information" do
it "should not create a user" do
  expect { click_button "Create my account" }.not_to change(User, :count)
end

describe "error messages" do
  before { click_button "Create my account" }

  it { should have_selector('title', text: 'Sign up') }
  it { should have_content('error') }
 end
end

 describe "with valid information" do
  before do
    fill_in "Name", with: "Example User"
    fill_in "Email", with: "user@example.com"
    fill_in "Password", with: "foobar"
    fill_in "Confirmation", with: "foobar"
 end

 it "should create a user" do
  expect do
    click_button "Create my account"
  end.to change(User, :count).by(1)
 end

 describe "after saving the user" do
  before { click_button "Create my account" }
  let(:user) { User.find_by_email('user@example.com') }

  it { should have_selector('title', text: user.name) }
  it { should have_selector('div.alert.alert-success', text: 'Welcome') }
  it { should have_link('Sign out') }
 end
 end
end

 describe "signup page" do
 before { visit signup_path }

it { should have_selector('h1', text: 'Sign up') }
it { should have_selector('title', text: full_title('Sign up')) }
end

  describe "signup" do

before { visit signup_path }

let(:submit) { "Create my account" }

describe "with invalid information" do
it "should not create a user" do
  expect { click_button submit }.not_to change(User, :count)
 end
end

describe "with valid information" do
before do
  fill_in "Name", with: "Example User"
  fill_in "Email", with: "user@example.com"
  fill_in "Password", with: "foobar"
  fill_in "Confirmation", with: "foobar"
end

it "should create a user" do
  expect { click_button submit }.to change(User, :count).by(1)
end
describe "edit" do
  let(:user) { FactoryGirl.create(:user) }
  before { visit edit_user_path(user) }

  describe "page" do
    it { should have_selector('h1', text: "Update your profile") }
    it { should have_selector('title', text: "Edit user") }
    it { should have_link('change', href: 'http://gravatar.com/emails') }
  end

  describe "with invalid information" do
    before { click_button "Save changes" }

    it { should have_content('error') }
    end
     end
     end
   end
 end 
```

**编辑**： users_controllers.rb 格式不正确。它应该如下所示：

```
class UsersController < ApplicationController

 def show
  @user = User.find(params[:id])
 end

def new
 @user = User.new
end

def create
 @user = User.new(params[:user])
 if @user.save
  sign_in @user
  flash[:success] = "Welcome to the Sample App!"
  redirect_to @user
else
  render 'new'
 end
end

def edit
  @user = User.find(params[:id])
 end 
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:47:58.163

`@user`仅当未在您的操作中设置变量时才会出现该错误`edit`，这意味着它不能用于`form_for`您视图中的调用......但它已设置，因此它应该可用。

你确定你已经保存了这些文件吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-11T16:00:45.470

在您的 user_pages_spec.rb 中，您有：

```
let(:user) { FactoryGirl.create(:user) }
before { visit edit_user_path(user) } 
```

我相信要使编辑生效，您需要登录用户：

```
let(:user) { FactoryGirl.create(:user) }
before do
    sign_in user
    visit edit_user_path(user)
end 
```

我可能已经进一步编辑了我的，但这就是我在查看我的提交日志时看到的。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:33:37.343

我在编辑操作之前结束了 UsersController 类，所以它没有看到它。请参阅我在 OP 底部的编辑。

# python - 是否有官方/非官方的方式在 python 中编写 Unity 脚本？

> ID：13782269
> 
> 赞同：11
> 
> 时间：2012-12-08T21:46:10.347
> 
> 标签：python, python-3.x, unity3d

我真的更喜欢使用 python，但 Unity 只支持 C#、UnityScript（类似于 JavaScript）和 Boo。有没有官方的方式来使用 python（最好是 3.x），或者一个非官方的补丁？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T21:48:54.860

是的，有一种使用 Python 的方法，尽管它是非官方的。见[这里](http://forum.unity3d.com/threads/86461-Python-interpreter-in-Unity)。

# android - 安卓加载消息

> ID：13782270
> 
> 赞同：3
> 
> 时间：2012-12-08T21:46:15.323
> 
> 标签：android

> **可能重复：**
> [使用 Android 下载文件，并在 ProgressDialog](https://stackoverflow.com/questions/3028306/download-a-file-with-android-and-showing-the-progress-in-a-progressdialog)
> [Android 活动指示器中显示进度？](https://stackoverflow.com/questions/5025652/android-activity-indicator)

我真的是 android 的新手我正在做一个与 webservice(xml) 连接的应用程序，它运行良好，但我的应用程序加载屏幕时视图不完整，然后显示数据。当所有数据都从服务器下载并显示后，我想实现一个“准备就绪”对话框。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T21:59:09.770

From [http://developer.android.com/guide/topics/ui/dialogs.html#ProgressDialog](http://developer.android.com/guide/topics/ui/dialogs.html#ProgressDialog)

```
ProgressDialog progressDialog= ProgressDialog.show(MyActivity.this, "", 
                "Loading. Please wait...", true);

progressDialog.dismiss(); // for close the dialog bar. 
```

# c# - Exception not caught when using BackgroundWorker

> ID：13782273
> 
> 赞同：2
> 
> 时间：2012-12-08T21:46:59.177
> 
> 标签：c#, .net, exception-handling

I have a WPF window with a `BackgroundWorker`. I get an exception in `Send()` method here:

```
private void worker_DoWork(object sender, DoWorkEventArgs e)
{
     smtpClient.Send(mail);
} 
```

which in turn is invoked in a `Click` Event for some button like this:

```
private async void SendClickAsync(object sender, RoutedEventArgs e)
{
    using (MessageServiceClient client = new MessageServiceClient())
    {
        try
        {
            [...]
            worker.RunWorkerAsync();

        }
        catch (Exception ex)
        {
            MessageBox.Show("Error! Check your sender data!", "!", MessageBoxButton.OK, MessageBoxImage.Error);
            [...]
        }
    }
} 
```

Why does this exception doesn't get handled? When I was doing it not asynchronously (everything was in `SendClickAsync()` method) the message box popped up nicely.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-08T21:48:50.953

当您调用`worker.RunWorkerAsync()`方法时，您的主线程继续执行并退出 try..catch 块。要处理异常，请使用`RunWorkerCompleted`事件处理程序。`RunWorkerCompletedEventArgs`争论具有`Error`将包含异常对象的属性：

```
void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    if (e.Error != null)
    {
       MessageBox.Show("Error", "!", MessageBoxButton.OK, MessageBoxImage.Error);
       return;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T21:50:58.780

正在使用`BackgroundWorker`线程池线程，因此它不希望您的代码能够在工作线程上做一些奇怪的事情。这就是为什么`BackgroundWorker`吞下您在 期间发生的异常`DoWork`并让您知道它发生在`RunWorkerCompletedEventArgs.Error`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T21:54:34.707

未处理异常的原因是因为它是在不同的线程上引发的。调用`worker.RunWorkerAsync();`不会阻塞，而是在线程池上启动作业并立即在主线程中返回控制 - 这是异步执行它的全部要点。

但这也意味着在`worker.RunWorkerAsync()`对主线程的调用退出您的 try-catch 块后，异常不会得到处理（在您的主线程上）。

# css - CSS3 变换和过渡 (Webkit)

> ID：13782277
> 
> 赞同：42
> 
> 时间：2012-12-08T21:47:10.940
> 
> 标签：css, webkit, css-transitions, css-transforms

考虑以下[小提琴](http://jsfiddle.net/6TMcS/)

```
p {
  -webkit-transform: translate(-100%, 0);
     -moz-transform: translate(-100%, 0);
      -ms-transform: translate(-100%, 0);
       -o-transform: translate(-100%, 0);
          transform: translate(-100%, 0);
  -webkit-transition: transform 1s ease-in;
     -moz-transition: transform 1s ease-in;
       -o-transition: transform 1s ease-in;
          transition: transform 1s ease-in;
}

a:hover + p {
  -webkit-transform: translate(0, 0);
     -moz-transform: translate(0, 0);
      -ms-transform: translate(0, 0);
       -o-transform: translate(0, 0);
          transform: translate(0, 0);
} 
```

过渡在 FF 中顺利进行，但在 Safari 或 Chrome（在我的 Mac 上）中根本没有过渡。

是否要为转换属性添加前缀，或者我的代码中是否存在某种语法错误？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-12-08T22:09:10.193

在转换中添加供应商前缀：

```
p {
  -webkit-transform: translate(-100%, 0);
     -moz-transform: translate(-100%, 0);
      -ms-transform: translate(-100%, 0);
       -o-transform: translate(-100%, 0);
          transform: translate(-100%, 0);
  -webkit-transition: -webkit-transform 1s ease-in; /* Changed here */ 
     -moz-transition: -moz-transform 1s ease-in;
       -o-transition: -o-transform 1s ease-in;
          transition: transform 1s ease-in;
}

a:hover + p {
  -webkit-transform: translate(0, 0);
     -moz-transform: translate(0, 0);
      -ms-transform: translate(0, 0);
       -o-transform: translate(0, 0);
          transform: translate(0, 0);
} 
```

**更新 (05/06/2014)**

为了回答一些评论，省略的原因`-ms-transition`是它从未存在过。

查看：

[我可以用吗？过渡](http://caniuse.com/css-transitions)，

[我可以用吗？变换](http://caniuse.com/transforms2d)，

[MDN 转换](https://developer.mozilla.org/en-US/docs/Web/CSS/transition#Browser_compatibility)，

[MDN 转换](https://developer.mozilla.org/en-US/docs/Web/CSS/transform#Browser_compatibility)

# perl - XML::Simple 如何预防 用引用替换内容？

> ID：13782278
> 
> 赞同：1
> 
> 时间：2012-12-08T21:47:10.423
> 
> 标签：perl, xml-parsing

我尝试使用 XML::Simple perl 解析来解析 xml 文档。我注意到，如果文件看起来像：

```
<?xml version="1.0" encoding="UTF-8"?>
<fields>
  <field>
    <f1>1234</f1>
    <name>MyName1</name>
  </field>
</fields> 
```

print(Dumper($ref)) 的结果；看起来像预期的那样：

```
$VAR1 = {
          'field' => {
                     'f1' => '1234',
                     'name' => 'MyName1'
                   }
        }; 
```

而如果我在文档中有多个列表：

```
<?xml version="1.0" encoding="UTF-8"?>
<fields>
  <field>
    <f1>1234</f1>
    <name>MyName1</name>
  </field>
  <field>
    <f1>567</f1>
    <name>MyName2</name>
  </field>
</fields> 
```

结果如下：

```
$VAR1 = {
          'field' => {
                     'MyName1' => {
                                  'f1' => '1234'
                                },
                     'MyName2' => {
                                  'f1' => '567'
                                }
                   }
        }; 
```

而预期的结果是：

```
 $VAR1 = { [
              'field' => {
                         'f1' => '1234',
                         'name' => 'MyName1'
                       },
              'field' => {
                         'f1' => '567',
                         'name' => 'MyName2'
                       }
              ]
            }; 
```

XML::Simple 解析器的哪些选项将阻止标记内容替换为标记引用并使用数组`<field>`代替？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T22:26:34.857

默认。`<name>`XML::Simple 通过标签和`<key>`的值命名散列键`<id>`。您可以通过[KeyAttr 设置](https://metacpan.org/module/XML%3a%3aSimple#KeyAttr-list-in-out---important)自定义此行为。因此，产生最接近您期望的结构的代码是：

```
#!/usr/bin/env perl
use common::sense;
use Data::Dumper;
use XML::Simple;

local $/ = undef;
say Dumper XMLin(<DATA>, KeyAttr => []);

__DATA__
<?xml version="1.0" encoding="UTF-8"?>
<fields>
  <field>
    <f1>1234</f1>
    <name>MyName1</name>
  </field>
  <field>
    <f1>567</f1>
    <name>MyName2</name>
  </field>
</fields> 
```

这是输出：

```
$VAR1 = {
      'field' => [
                 {
                   'f1' => '1234',
                   'name' => 'MyName1'
                 },
                 {
                   'f1' => '567',
                   'name' => 'MyName2'
                 }
               ]
    }; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-08T22:16:20.037

使用`ForceArray => 'field'`选项来`XMLin`。

通常，您无法塑造`XML::Simple`返回到您想要的任何数据结构的数据结构。`XML::Simple`太简单了。但是，您的用例是[文档](https://metacpan.org/module/XML%3a%3aSimple#ForceArray-names-in---important)中描述的用例。我建议您阅读所有标记为`important`至少的项目的文档，因为它确实有助于了解您在塑造由`XML::Simple`.

# cocoa - 在 NSView 层上使用 CATransform3DMakeTranslation 时，NSView 的子视图被剪裁

> ID：13782279
> 
> 赞同：0
> 
> 时间：2012-12-08T21:47:11.663
> 
> 标签：cocoa, translation, transform, catransform3d

我有一个带有三个 NSImageView 子视图的 NSView。当我使用 CATransform3DMakeTranslation 沿 x 轴平移时，我遇到了子视图剪辑的问题。

我主要做 iOS 开发，这是我第一次进入这个领域。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T19:42:11.333

我最终不得不为我的窗口的内容视图打开核心动画层。我在这里找到了答案：[How to make NSView not clip its bounding area？](https://stackoverflow.com/q/12400273/703910)

# asp.net - 使用现有 SQL 数据库的 ASP.NET Visual Studio 2012

> ID：13782287
> 
> 赞同：0
> 
> 时间：2012-12-08T21:47:34.620
> 
> 标签：asp.net, visual-studio-2012

我正在使用 Visual Studio 2012 创建一个 ASP.NET Web 应用程序。我尝试使用 ASP.NET 4.5 入门教程，但它创建了一个简单的本地数据库，并且所有查询都直接写在代码中。我正在访问的数据库 (SQL Server 2008) 有 15 个复杂的存储过程，我真的不想重新键入它们。

仅从表中获取所有数据时，使用`DBContext`教程中的示例可以正常工作，但是如何使用数据库中的存储过程？有人可以告诉我使用已经存在的存储过程的最佳方法吗？

到目前为止，我发现的所有问题（和答案）都是针对 Visual Studio 的早期版本，虽然我知道我可以使用这些（因为 VS 2012 确实支持向后兼容性），但我想充分利用我拥有但未使用 VS 2010 的“最佳实践”的软件。

如果您能告诉我如何使用现有的存储过程，或者甚至将我引向一本书、网站或任何其他可以向我展示这一点的东西，我将不胜感激！快乐编码！感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T15:14:05.743

我不得不拼凑来自几个不同来源的信息，但我能够让它发挥作用。这是我的步骤（我可能做得比我需要的多，但它确实有效）以防万一它可以帮助其他人：

1.  在我的项目中添加了一个名为 MyContext 的类，并告诉它是一个 DBContext 并将其指向我现有的数据库，如下所示：（请注意，我的 webconfig 文件中已经有完整的连接字符串。

    { public class MyContext : DbContext { public MyContext() : base("name=MyDatabase") { } } }

MyDatabase 被替换为在我的 webconfig 文件的连接字符串中引用我的数据库的实际名称。

1.  我创建了一个名为 ProductList 的类，它只公开我的存储过程返回的字段：

    { public class ProductList { [ScaffoldColumn(false)] public int ProductID { get; 放; } [必需，StringLength(100)，Display(Name = "Model")] public string ProductName { get; 放; } }

}

1.  我实际上创建了一个用户控件 (.ascx)，它只是一个 DataReapeater。在控件的代码隐藏中，就在 Page_Load 下方，我创建了一个名为 GetMostPopular 的方法：

    公共 IEnumerable GetMostPopular() { var db = new MyContext(); IEnumerable 结果 = db.Database.SqlQuery("MostPopularProducts"); 返回结果；}

IEnumerable 和 SQLQuery 的 <> 里面是我创建的类的名称。它与我的存储过程“MostPopularProducts”将返回的字段完全相同。

1.  然后在 DataRepeater 中，我使用 GetMostPopular 作为“SelectMethod”：

    '><%# Eval("ProductName") %>

5.然后我只是将用户控件拖放到我希望它显示的页面上。

我希望这对其他人有帮助。快乐编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T06:09:00.147

我建议你使用 SqlClient、SqlCommand、SqlConnection... 非常简单，具有有机输出！

# python - 解析“math340-05 =?UTF-8?B?4oCTIEF1ZmdhYmUgNS4x?=”

> ID：13782295
> 
> 赞同：0
> 
> 时间：2012-12-08T21:49:09.010
> 
> 标签：python

我想从`.eml`使用 Python 3 存储在文件中的电子邮件中提取主题：

该文件的主题行如下：

```
Subject: math340-05 =?UTF-8?B?4oCTIEF1ZmdhYmUgNS4x?= 
```

我尝试使用`email`模块解析名称，但它按原样返回字符串：

```
with open(filename, "r") as f:
    m = email.message_from_file(f)

print(m["Subject"]) 
```

我该如何解码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:58:33.697

一种方法是给我们`email.header` 模块：

```
import email, email.header
m = email.message_from_string("Subject: math340-05 =?UTF-8?B?4oCTIEF1ZmdhYmUgNS4x?=")
raw_header = email.header.decode_header(m["Subject"])
header = email.header.make_header(raw_header)
print(str(header))
# or for py2: print(unicode(header)) 
```

会给你：

```
math340-05 – Aufgabe 5.1

```

# c - 如何在C中删除列表的最后一个元素

> ID：13782296
> 
> 赞同：0
> 
> 时间：2012-12-08T21:49:11.833
> 
> 标签：c, linked-list

我使用自引用结构在**C**中创建了一个列表，我想出了如何用列表做所有可能的事情，但删除最后一个元素，这让我困惑了几个星期，请帮助我，这就是我所做的。要了解这个程序的概念，您只需要查看函数`main`，而且 `Delete`，也许 `insert`。请注意，tis 代码是在 linux 上使用 ubuntu 中的 gcc 编译的。

```
/* self-referencial structure */
struct ListNode
{
    char data;
struct ListNode *nextNode ;
};

typedef struct ListNode ListNode;
typedef ListNode *ListNodePtr ;

/* function protypes */
void insert(ListNodePtr *sptr, char value); // insert element in list in alphabet order
void Delete (ListNodePtr *sptr);// PROBLEM HERE; remove last element from list
void printList(ListNodePtr);// output the contents of the list
void instructions(); // print instruction on screen

int main(void)
{
ListNodePtr startPtr = NULL ; // there are initially no nodes
int choice;
char item ;// char to be placed in list

/* Give instruction s and allow user to make a choice
 * insert , print, delete.
 */
instructions();
printf("?");
scanf("%d", &choice);

/* loop until sentinel value 3 */
while (!(choice == 4) )
{
    switch(choice)
    {
    case 1:
        printf("Enter a character");
        scanf("\n%c",&item);
        insert(&startPtr, item);
        printList(startPtr);
        break ;

    case 2:
        /* If the list is not empty */
        Delete(&startPtr);
        printList(startPtr);
        // if it is printf("the list is empty");
        break;
    case 3:
        printList(startPtr);
        break;
    default:
        printf("Invalid choice");
        break;
    }// end switch
    printf("?");
    scanf("%d",&choice);
}// end while
return 0 ;
}// END FUNCTION MAIN

/* display program choices/instruction to user */
void instructions(void)
{
     printf( "Enter your choice:\n"
    "1 to insert an element into the list.\n"
    "2 to delete an element from the list.\n"
    "3 to print the list\n"
    "4 to end.\n" );
 }

void insert(ListNodePtr *sptr, char value)
{
ListNodePtr currentPtr;
ListNodePtr previousPtr;
ListNodePtr newNode ;

/* create an area in memory the size of ListNode and
 *allocate to newPtr */
newNode = malloc(sizeof(ListNode)); // create new node

// if space is available
if (newNode != NULL)
{
    newNode->data = value;
    newNode->nextNode = NULL;

    previousPtr = NULL ;
    currentPtr = *sptr ;

    /* walk to correct location in the list */
    while (currentPtr != NULL && value > currentPtr->data)
    {
        previousPtr = currentPtr;
        currentPtr = currentPtr->nextNode;
    }// end while

    /* insert node at beginning of the list */
    if(previousPtr == NULL)
    {
        newNode->nextNode = *sptr;
        *sptr = newNode;
    }// end if

    else
    {
        previousPtr->nextNode = newNode;
        newNode->nextNode = currentPtr ;
    }
}// end if
else
{
    printf("%c not inserted , memory not available", value);
}

 }

void Delete(ListNodePtr *sptr)
{
ListNodePtr previousPtr;
ListNodePtr currentPtr;
ListNodePtr tempPtr;

// if there is only  one element
if((*sptr)->nextNode == NULL)
{
    tempPtr = *sptr; // hold on to Node being removed
    *sptr = (*sptr)->nextNode;
    free(tempPtr);
}
else
{
    previousPtr = *sptr ;
    currentPtr = (*sptr)->nextNode;

    // walk to end of the list
    while(currentPtr->nextNode != NULL)
    {
        previousPtr = *sptr;
        currentPtr = currentPtr->nextNode;
    }

    if(currentPtr != NULL)
    {
        // WHAT DO I DO HERE ??!!??
        // if the list has more than one two elements, 
        // all but the first element is deleted

        previousPtr->nextNode = currentPtr->nextNode;
        currentPtr = NULL ;
        free(currentPtr);
    }// end if
}// end else 

 }// END FUNCTION DELETE

 void printList(ListNodePtr currentPtr)
{
if(currentPtr == NULL)
printf("List is empty");
else
{
    while(currentPtr != NULL)
    {
        printf( "%c --> ", currentPtr->data );
        currentPtr = currentPtr->nextNode;
    } /* end while */
        printf( "NULL\n\n" );
    /* end else */

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:10:03.137

可能这有帮助

```
void Delete(ListNodePtr *sptr)
{
 ListNodePtr previousPtr;
 ListNodePtr currentPtr; 
 ListNodePtr tempPtr;

 if((*sptr)->nextNode == NULL)
 {
   tempPtr = *sptr; // hold on to Node being removed
   *sptr = (*sptr)->nextNode;
   free(tempPtr);
 }
else  
{
previousPtr = *sptr ;
currentPtr = (*sptr)->nextNode;

// walk to end of the list
while(currentPtr->nextNode != NULL)
{
    previousPtr=previousPtr->nextNode;//this always points to the previous node 
    currentPtr = currentPtr->nextNode;
}

//after loop ends currentPtr points to the last node

if(currentPtr != NULL)
{
    previousPtr->nextNode=NULL;//This deletes the currentPtr from the list
    free(currentPtr);
}// end if
}// end else 
}// END FUNCTION DELETE 
```

# knockout.js - knockoutjs 将嵌套数据推送到数组中

> ID：13782301
> 
> 赞同：1
> 
> 时间：2012-12-08T21:49:39.147
> 
> 标签：knockout.js, treeview, push, ko.observablearray

我一直在盯着我尝试构建树视图一段时间，但似乎无法走上正确的轨道。

谁能告诉我我在哪里搞砸了？

**HTML**

```
<ul data-bind="foreach: reservations">
    <li><span data-bind="text: name "></span>   
        <ul data-bind="foreach: studios">
            <li><span data-bind="text: name "></span>
                <ul data-bind="foreach: times">
                    <li>T:<span data-bind="text: name "></span></li>
                </ul>
            </li>
        </ul>
    </li>
</ul> 
```

**JS**

```
function Date(d) {
    var self = this;
    self.name = ko.observable(d.name)
    self.studios = ko.observableArray(ko.utils.arrayMap(d.studios, function(s){
        return new Studio(s);
    }));
}

function Studio(d) {   
    var self = this;
    self.name= ko.observable(d.name);
    self.times= ko.observableArray(ko.utils.arrayMap(d.times, function(i){
        return new Time(i);
    }));
}

function Time(d) {
    var self = this;
    self.id = ko.observable(d.id);
    self.name = ko.observable(d.name);    
}

function ViewModel(data) {

    var self = this;

    self.reservations = ko.observableArray();

    self.addReservation = function() {
        self.reservations.push(
            new Date({
                name: '22-12-2012',
                studios: [new Studio({
                                name: 'Studio 1',
                                times: [new Time({
                                            id: 's1_20',
                                            name: '20 uur' })]                                            
                        })]
            })
        );
    }
}

ko.applyBindings(new ViewModel()); 
```

**小提琴** [http://jsfiddle.net/marsmania00/adcvs/4/](http://jsfiddle.net/marsmania00/adcvs/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:02:11.640

您尝试构建对象两次。首先在 中`addReservation()`，然后在过滤数组时在构造函数中。

如果您删除函数中的构造`addReservation()`函数调用，它可以正常工作。

修改版：http: [//jsfiddle.net/MizardX/adcvs/6/](http://jsfiddle.net/MizardX/adcvs/6/)

# java - KeyPressed 事件没有发生？

> ID：13782305
> 
> 赞同：1
> 
> 时间：2012-12-08T21:50:35.983
> 
> 标签：java, swing, keylistener, keyevent

此代码正确构建，一切似乎都可以正常工作，但关键是什么都不做。我认为要么是动作侦听器，要么是椭圆没有更新。我正在尝试通过初学者Java游戏编程来工作。我相信这很容易，但我没有抓住它。如果这有所作为，我正在使用 sublime text 2 的 mac。

```
package javagame;

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class JavaGame extends JFrame {

int x, y;

public class AL extends KeyAdapter {

    public void keyPressed(KeyEvent e) {
        int keycode = e.getKeyCode();
        if(keycode == e.VK_LEFT); {
            x-= 3;
        }
        if(keycode == e.VK_RIGHT); {
            x+= 3;
        }
        if(keycode == e.VK_UP); {
            y-= 3;
        }
        if(keycode == e.VK_DOWN); {
            y+= 3;
        }
    }

    public void keyReleased(KeyEvent e) {

    }
}

public JavaGame() {
    addKeyListener(new AL());
    setTitle("Jave Game");
    setSize(700, 700);
    setResizable(false);
    setVisible(true);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    x = 350;
    y = 350;
}

public void paint(Graphics g) {
    g.fillOval(x, y, 15, 15);

    repaint();
}

public static void main(String[] args) {
    new JavaGame();
}

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T21:52:44.733

`if`您需要从语句中删除分号：

```
if (keycode == e.VK_LEFT)
{
   x-= 3;
} 
```

`if`目前，随着分号终止这些语句，您的语句后面的代码块将独立呈现。

* * *

一些`Swing`特定的注释：

*   最好`paintComponent`从子类中使用以`JComponent`获得更好的油漆性能。
*   使用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)来`KeyListener`改进键事件管理。这是一个[例子](http://www.java2s.com/Tutorial/Java/0260__Swing-Event/ListingtheKeyBindingsinaComponent.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T22:11:12.913

即使有建议的更正，您仍然会遇到可能的问题。

首先，`JFrame`实际上在其顶部包含许多组件，根窗格，其中包含内容和分层窗格以及玻璃窗格（通常是不可见的）。如果这些组件中的任何一个因任何原因获得键盘焦点，则您的 key listener 很可能会被忽略。

更好的解决方案是使用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)API，它可以更好地控制焦点问题。

你也违反了油漆合同。在大多数情况下，您需要调用`super.paint`，事实上，不鼓励您重写顶级容器的绘制方法，相反，您可以从类似的东西扩展`JPanel`并重写它的`paintComponent`方法。

这些绘制方法执行非常重要的工作，您不应轻易忽略/跳过它们。查看[AWT 中的绘画和 Swing](http://www.oracle.com/technetwork/java/painting-140037.html)中的绘画以及Swing 中的[自定义绘画以](http://docs.oracle.com/javase/tutorial/uiswing/painting/)获取更多信息

# python - 在 google appengine 上使用 HTTP 流

> ID：13782314
> 
> 赞同：3
> 
> 时间：2012-12-08T21:51:57.667
> 
> 标签：python, google-app-engine, http-streaming

我正在尝试使用 GAE 使用 http 流。

逻辑流程是 {source1..N} --> [GAE] --> 浏览器报告和显示

据我了解，HTTP 流将永远运行，因此简单的 GET 进程循环将不起作用。谁能推荐一种适用于 GAE 模型的替代方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T03:20:42.587

我不确定您的要求是什么，但也许您可以查看 Channels API？因此，您可以将更新从您的应用程序发送到订阅浏览器，而不是打开一个连续的流。

[Google App Engine - 渠道 API 概览](https://developers.google.com/appengine/docs/python/channel/overview)

# html - 输入的高度非常小

> ID：13782317
> 
> 赞同：1
> 
> 时间：2012-12-08T21:52:12.443
> 
> 标签：html, css, twitter-bootstrap

我以前多次使用 bootstrap，但现在在我的 GAE 项目中我遇到了一个问题——输入元素的高度非常小。例如，按钮是可以的：

![在此处输入图像描述](../Images/c5c72dca146d96f12040c897b5584958.png)

HTML 代码：

```
<div class="container">
   <div class="row">
      <div class="span6 pull-right">
         <div class="well well-small">
         <form>
            <input id="length" class="input-small" name="length" type="text" value="8">
            <br/>
            <input type="number" value="8">
            <br/>
            <input type="submit" class="btn btn-success" value="Generate">
          <!-- etc --> 
```

开发工具截图：

![在此处输入图像描述](../Images/e166ada73ce44299f577e80bc2c9ea9c.png)

编辑 2：从引导程序中删除了 height:20px 规则，现在可以了。但它为什么在那里？

引导版本是 2.2.1。屏幕截图是在 Chrome 23.0.1271.95、Mac OS X 10.8 中制作的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-05T15:52:49.953

添加

```
<!DOCTYPE html> 
```

到您的文档应该可以解决问题。

# iphone - How to use NSXMLParser to Find 1 Element

> ID：13782320
> 
> 赞同：1
> 
> 时间：2012-12-08T21:52:53.963
> 
> 标签：iphone, objective-c, ios, nsxmlparser

I have searched the internet for several days, but I cannot find a consise answer. I want to make a simple practice weather app that shows the temperature for a hardcoded zip code.

**Here is the XML**

```
<data>
<request>
<type>Zipcode</type>
<query>08003</query>
</request>
<current_condition>
<observation_time>08:29 PM</observation_time>
<temp_C>11</temp_C>
<temp_F>52</temp_F>
<weatherCode>143</weatherCode>
<weatherIconUrl>
<![CDATA[
http://www.worldweatheronline.com/images/wsymbols01_png_64/wsymbol_0006_mist.png
]]>
</weatherIconUrl>
<weatherDesc>
<![CDATA[ Mist ]]>
</weatherDesc>
<windspeedMiles>4</windspeedMiles>
<windspeedKmph>7</windspeedKmph>
<winddirDegree>210</winddirDegree>
<winddir16Point>SSW</winddir16Point>
<precipMM>0.0</precipMM>
<humidity>87</humidity>
<visibility>5</visibility>
<pressure>1013</pressure>
<cloudcover>100</cloudcover>
</current_condition>
<weather>
<date>2012-12-08</date>
<tempMaxC>13</tempMaxC>
<tempMaxF>55</tempMaxF>
<tempMinC>9</tempMinC>
<tempMinF>48</tempMinF>
<windspeedMiles>6</windspeedMiles>
<windspeedKmph>9</windspeedKmph>
<winddirection>W</winddirection>
<winddir16Point>W</winddir16Point>
<winddirDegree>260</winddirDegree>
<weatherCode>122</weatherCode>
<weatherIconUrl>
<![CDATA[
http://www.worldweatheronline.com/images/wsymbols01_png_64/wsymbol_0004_black_low_cloud.png
]]>
</weatherIconUrl>
<weatherDesc>
<![CDATA[ Overcast ]]>
</weatherDesc>
<precipMM>3.1</precipMM>
</weather>
</data> 
```

ALL I want to do is to extract the *temp_F* and store it in a NSString.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:59:20.357

If all you want is a single value for a single element that only appears once in the XML then I would do some simple string search instead of bothering with a full blown XML parser.

Get the range of the substring `@"<temp_F>"` and the substring `@"</temp_F>"` and grab the value in between.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:30:45.710

既然你已经提到过使用 NSXMLParser，那就继续吧。设置您的委托以实现协议

```
 @interface MyClass : NSObject <NSXMLParserDelegate> 
```

注意你的 xml 条目的开始标签（在这种情况下看起来是这样）

```
 - (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict {

      if ( [elementName isEqualToString:@"temp_F"] ) {
           // Set flag and reset string
           self.foundTargetElement = true;
           if ( self.myMutableString ) {
                self.myMutableString = nil;
                self.myMutableString = [[NSMutableString alloc] init];
           }
      }
 } 
```

下一个实现

```
 - (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
       if ( self.foundTargetElement ) {
             [self.myMutableString appendString:string];
       }     
 } 
```

并使用与上述相同的模式，注意您的标签 () 并将其值附加到您的字符串，或者对数据执行任何其他操作：

```
 - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {

      self.foundTargetElement = false;

      // Do something with your result, or
      // Wait until entire document has been parsed.
 } 
```

让我知道这是否适合你。

# c# - How to make scroll map in XNA (2D)?

> ID：13782321
> 
> 赞同：4
> 
> 时间：2012-12-08T21:53:03.053
> 
> 标签：c#, xna

I have a map, containing many objects in an area sized 5000*5000. my screen size is 800*600.

how can i scroll my map, i don't want to move all my objects left and right, i want the "camera" to move, But unfortunately i didn't found any way to move it.

Thanks

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T08:03:36.870

**我认为您正在寻找（[此重载](http://msdn.microsoft.com/en-us/library/ff433701.aspx)）的`transformMatrix`参数。`SpriteBatch.Begin`**

你说你不希望*物体*移动，但你希望*相机*移动。但是，在最低级别，无论是 2D 还是 3D 渲染，都没有“相机”的概念。渲染总是发生在同一个区域 - 你必须使用转换将你的顶点/精灵放置到那个区域。

如果你想要一个相机的效果，你必须通过将*整个世界*向相反的方向移动来实现它。

当然，您实际上并没有*存储*移动的数据。您只需在渲染数据时应用偏移量。Emartel 的回答让你为每个精灵都这样做。但是使用矩阵更简洁，因为您不必为每个单独的代码复制代码`Draw`- 您只需让 GPU 完成即可。

以一个例子结束：假设您希望将相机放置在 (100, 200)。为此，请传递`Matrix.CreateTranslation(-100, -200, 0)`给`SpriteBatch.Begin`.

（根据 emartel 的回答，自己执行截锥剔除可能是浪费时间，除非您的世界*真的*很大。请参阅[此答案](https://gamedev.stackexchange.com/a/9289/288)以了解性能注意事项的解释。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-08T21:56:15.420

**视口**

您首先创建相机视口。在 2D 游戏的情况下，它可以像定义要开始渲染的左下角位置一样简单，并在您的情况下使用屏幕分辨率扩展它`800x600`。

```
Rectangle viewportRect = new Rectangle(viewportX, viewportY, screenWidth, screenHeight); 
```

这是一个示例，如果您的相机被偏移，它会是什么样子`300,700`（该图非常近似，只是为了给您一个更好的主意）

![视口](../Images/b5c2c3fcbc7c126035533f675af3e40a.png)

**能见度检查**

现在，您要查找与 相交的每个精灵，`red square`可以理解为您的`Viewport`. 这可以用类似的东西来完成（这是未经测试的代码，只是它可能看起来的示例）

```
List<GameObject> objectsToBeRendered = new List<GameObject>();
foreach(GameObject obj in allGameObjects)
{
    Rectangle objectBounds = new Rectangle(obj.X, obj.Y, obj.Width, obj.Height);
    if(viewportRect.IntersectsWith(objectBounds))
    {
        objectsToBeRendered.Add(obj);
    }
} 
```

这是它在图形上的样子，绿色精灵是添加到`objectsToBeRendered`. 如果您想在渲染它们之前对它们`Back`进行排序，将对象添加到单独的列表中会很容易！`Front`

![可见的](../Images/1d3a5fd64116996906bc728566fff593.png)

**渲染**

现在我们已经找到了哪些对象相交，我们需要弄清楚屏幕上的哪个位置会结束。

```
spriteBatch.Begin();
foreach(GameObject obj in objectsToBeRendered)
{
    Vector2 pos = new Vector2(obj.X - viewportX, obj.Y - viewportY);
    spriteBatch.Draw(obj.GetTexture(), pos, Color.White);
}
spriteBatch.End(); 
```

如您所见，我们推导出视口的`X`和`Y`位置以将对象的世界位置带入`Screen Coordinates`视口内。这意味着在给定我们这里的视口的情况下，可能位于的小方块将在屏幕上`400, 800`呈现`World Coordinates`。`100, 100`

**编辑：**

虽然我同意“正确答案”的更改，但请记住，我在此处发布的内容在决定要处理哪些动画、要更新哪些 AI 等时仍然非常有用……让相机和 GPU 单独工作阻止您知道哪些对象实际上在屏幕上！

# prolog - DCG for idiomatic phrase preference

> ID：13782324
> 
> 赞同：5
> 
> 时间：2012-12-08T21:53:11.273
> 
> 标签：prolog, dcg, iso-prolog

I have a manually made DCG rule to select idiomatic phrases over single words. The DCG rule reads as follows:

```
seq(cons(X,Y), I, O) :- noun(X, I, H), seq(Y, H, O), \+ noun(_, I, O).
seq(X) --> noun(X). 
```

The first clause is manually made, since `(:-)/2` is used instead of `(-->)/2`. Can I replace this manually made clause by some clause that uses standard DCG?

Best Regards

P.S.: Here is some test data:

```
noun(n1) --> ['trojan'].
noun(n2) --> ['horse'].
noun(n3) --> ['trojan', 'horse'].
noun(n4) --> ['war']. 
```

And here are some test cases, the important test case is the first test case, since it does only deliver n3 and not cons(n1,n2). The behaviour of the first test case is what is especially desired:

```
?- phrase(seq(X),['trojan','horse']).
X = n3 ;
No
?- phrase(seq(X),['war','horse']).
X = cons(n4,n2) ;
No
?- phrase(seq(X),['trojan','war']).
X = cons(n1,n4) ;
No 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T15:19:43.030

（为避免与其他非终端冲突，我将您重命名`seq//1`为`nounseq//1`）

> 我可以用一些使用标准 DC​​G 的子句替换这个手工制作的子句吗？

不，因为它不坚定，它是 STO（详情如下）。

## 预期意义

但是，让我从您的程序的预期含义开始。您说您要*选择惯用短语而不是单个单词*。你的程序真的这样做了吗？或者，换一种说法，你的定义真的很独特吗？我现在可以构建一个反例，但让 Prolog 来思考：

```
名词 --> [] | 名词（_），名词。

?- 长度（Ph，N），短语（名词，Ph），
   差异（X，Y），短语（名词序列（X），Ph​​），短语（名词序列（Y），Ph）。
Ph = [特洛伊木马，木马，特洛伊木马]，
N = 3,
X = cons(n1, cons(n2, n1)),
Y = 缺点（n3，n1）；
... ;
Ph = [特洛伊木马，战争]，
N = 3,
X = 缺点（n3，n4），
Y = cons(n1, cons(n2, n4)) ...

```

所以你的定义是模棱两可的。您本质上想要的（可能）是某种重写系统。但这些很少以明确的方式定义。什么，如果两个词像附加词一样重叠`noun(n5) --> [horse, war].`等等。

* * *

# 一致性

预先声明：目前，DCG 文档仍在开发中——非常欢迎评论！[你可以在这个地方](http://www.complang.tuwien.ac.at/ulrich/iso-prolog/#dcg)找到所有的材料。所以严格来说，目前还没有 DCG 的一致性概念。

## 坚定不移

一个符合标准的定义必须保持的核心属性是坚定不移的属性。因此，在查看您的定义之前，我将比较两个目标`phrase/3`（在默认模式下运行 SWI）。

```
?- Ph = []，短语（名词序列（cons（n4，n4）），Ph0，Ph）。
PH = [],
Ph0 = [战争，战争]；
错误的。

?- 短语（名词序列（cons（n4，n4）），Ph0，Ph），Ph = []。
假的。

?- 短语（名词序列（cons（n4，n4）），Ph0，Ph）。
假的。

```

在最后移动目标`Ph = []`，删除唯一的解决方案。因此，您的定义并不坚定。这是由于您处理的方式`(\+)/1`：变量`O`不能出现在`(\+)/1`. 但另一方面，如果它没有出现在`(\+)/1`你只能检查句子的开头。而不是整个句子。

## 以发生检查财产为准

但情况更糟：

```
?- set_prolog_flag(occurs_check,error)。
真的。

?- 短语（名词序列（cons（n4，n4）），Ph0，Ph）。
错误：名词/3：无法将 _G968 与 [war|_G968] 统一：将创建无限树

```

所以你的程序依赖于 STO-unifications (subject-to-occurs-check unifications)，其结果在

> [ISO/IEC 13211-1](https://stackoverflow.com/tags/iso-prolog/info)子条款 7.3.3 接受发生检查 (STO) 和不接受发生检查 (NSTO)

这是因为您打算定义两个非终端的交集。考虑以下表达方式：

```
:- op(950, xfx, //\\)。∩ - 2229;INTERSECTION 的 % ASCII 近似值

(NT1 //\\ NT2) -->
     调用（Xs0^Xs^（短语（NT1，Xs0，Xs），短语（NT2，Xs0，Xs）））。

```

% 以下是在 中预定义的[`library(lambda)`](http://www.complang.tuwien.ac.at/ulrich/Prolog-inedit/lambda.pl)：

```
^（V0，目标，V0，V）：-
      呼叫（目标，V）。

^(V, 目标, V) :-
     呼叫（目标）。

```

已经有了这个定义，我们可以进入 STO 情况：

```
?- 短语(([a]//\\[a,b]), Ph0,Ph)。
错误：=/2：无法将 _G3449 与 [b|_G3449] 统一：将创建无限树

```

事实上，当使用有理树时，我们得到：

```
?- set_prolog_flag(occurs_check,false)。
真的。

?- 短语(([a]//\\[a,b]), Ph0,Ph)。
Ph0 = [a|_S1], % 其中
    _S1 = [b|_S1]，
Ph = [b|_S1]。

```

所以有一个无限的列表，对于自然语言句子来说肯定没有多大意义（除了无限资源和能力的人......）。

# java - 如何使用 XML Java DOM 重新排序节点

> ID：13782330
> 
> 赞同：5
> 
> 时间：2012-12-08T21:54:13.050
> 
> 标签：java, xml

这是我所拥有的，

```
<animation_state>
<state>run</state>
<animation_sequence>
<pose duration="10" image_id="1"/>
<pose duration="10" image_id="2"/>
<pose duration="10" image_id="3"/>
</animation_sequence> 
```

我想让用户能够上下移动某个图像，但是，由于它们存储在 XML 中，这意味着我必须更改图像 ID。如果假设用户希望 image_id = 3 成为序列中的第一个，或者在中间，或者根据他的需要，我该如何操作 XML？我正在使用 DOM。

如果用户希望图像 3 成为第一个，这就是我的 XML 的显示方式：

```
<animation_state>
<state>run</state>
<animation_sequence>
<pose duration="10" image_id="3"/>
<pose duration="10" image_id="1"/>
<pose duration="10" image_id="2"/>
</animation_sequence> 
```

我的尝试：

```
Document dom = parser.getDocument();
for (int i = 0; i < dom.getElementsByTagName("animation_state").getLength(); i++) 
{
    if (dom.getElementsByTagName("animation_state").item(i).getChildNodes().item(0).getTextContent().equalsIgnoreCase(target)) {
        posVal = i;
    }
}
NodeList list = dom.getElementsByTagName("animation_sequence").item(posVal).getChildNodes();

for(int b=0; b<list.getLength(); b++)
{
    if(list.item(b).getAttributes().item(1).getNodeValue().equalsIgnoreCase(PoseSelectionListener.imageIDOfSelectedPose))
    {
        Node toBeMoved = list.item(b);
        dom.getElementsByTagName("animation_sequence").item(posVal).appendChild(toBeMoved);
        System.out.println(toBeMoved.getAttributes().item(0).getNodeName());
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T21:59:43.713

Use [`Node.insertBefore`](http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html#insertBefore%28org.w3c.dom.Node,%20org.w3c.dom.Node%29) and/or [`Node.appendChild`](http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html#appendChild%28org.w3c.dom.Node%29) Just locate the Node to be moved and locate where it should be moved and insert that node before it.

It may be easier for you to [create a copy](http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html#cloneNode%28boolean%29) of the node to be moved, insert it at the correct location and [delete the old node](http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html#removeChild%28org.w3c.dom.Node%29) afterwards.

See the sample code below:

```
public class SO13782330 {
    /** Move the image whose imageId is given at first position in sequence */
    public static void moveImageFirst(Document doc, int imageId) throws Exception {
        XPath xpath = XPathFactory.newInstance().newXPath();
        // get the image to move
        XPathExpression poseXPath = xpath.compile("//pose[@image_id='" + imageId + "']");
        Node pose = (Node)poseXPath.evaluate(doc, XPathConstants.NODE);
        // get the first image
        XPathExpression firstPoseXPath = xpath.compile("//pose[position() = 1]");
        Node firstPose = (Node)firstPoseXPath.evaluate(doc, XPathConstants.NODE);
        // copy the image to be moved
        Node poseCopy = pose.cloneNode(true);
        // insert it before the first one
        Node sequence = firstPose.getParentNode();
        sequence.insertBefore(poseCopy, firstPose);
        // delete the old one
        sequence.removeChild(pose);
    }

    /** Print the document on stdout */
    public static void showDocument(Document doc) throws Exception {
        Transformer transformer = TransformerFactory.newInstance().newTransformer();
        transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
        StringWriter sw = new StringWriter();
        transformer.transform(new DOMSource(doc), new StreamResult(sw));
        System.out.println(sw.getBuffer().toString());
    }

    public static void main(String... args) throws Exception {
        DocumentBuilder db = DocumentBuilderFactory.newInstance().newDocumentBuilder();
        Document doc = db.parse(new InputSource(new StringReader("<animation_state>\n" +
                "<state>run</state>\n" +
                "<animation_sequence>\n" +
                "<pose duration=\"10\" image_id=\"1\"/>\n" +
                "<pose duration=\"10\" image_id=\"2\"/>\n" +
                "<pose duration=\"10\" image_id=\"3\"/>\n" +
                "</animation_sequence>\n" +
                "</animation_state>")));
        moveImageFirst(doc, 3);
        showDocument(doc);
    }
} 
```

It will move the `pose` element having `image_id` attribute equals to `3` before the first one.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-18T21:41:43.987

您不需要复制/克隆节点。

只需执行以下操作：

```
public void addNodeAfter(Node newNode, Node refChild) {
    Node parent = refChild.getParent();
    parent.insertBefore(newNode, refChild);
    refChild = parent.remove(refChild);
    parent.insertBefore(refChild, newNode); 
} 
```

可能是比克隆更好的解决方案。

# php - json 返回字符串而不是对象

> ID：13782332
> 
> 赞同：0
> 
> 时间：2012-12-08T21:54:27.500
> 
> 标签：php, javascript, json

我有

```
 $age = implode(',', $wage);   // which is object return:  [1,4],[7,11],[15,11]
  $ww = json_encode($age); 
```

然后我在这里检索它

```
 var age = JSON.parse(<?php echo json_encode($ww); ?>); 
```

所以如果我做

```
 alert(typeof(<?php echo $age; ?>))   // object
   alert(typeof(age))                   //string 
```

在我的情况下 JSON.parse 重新调整为字符串。

我怎样才能让 json 作为对象返回？

编辑：

```
 var age = JSON.parse(<?php echo $ww; ?>); // didnt work , its something syntax error 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T21:56:24.433

`implode`返回一个字符串，因此将其`json_encode`编码为这样是很自然的。它不能识别已经作为字符串传递的类似 JSON 的数据。

如果要获取对象，则必须将关联数组传递给`json_encode`：

```
$foo = array(
    1 => 4,
    7 => 11,
    15 => 11
);

echo json_encode($foo); // {1:4,7:11,15:11} 
```

关于爆炸前的样子的信息很少`$wage`，很难准确地说出你想要得到什么。该结构 ( `[1,4],[7,11],[15,11]`) 是如何成为对象的？每个元组的第一个元素是键吗？这就是我在示例中所假设的，但它可能会关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:16:03.913

一种。您会收到语法错误，因为您需要将字符串括在引号内，如下所示：

`var age = JSON.parse("<?php echo $ww; ?>");`

湾。此外，您*不需要* `JSON.parse`. 您可以在服务器端已经 json_encoded 后简单地回显 php var：

`var age = <?php echo $ww; ?>;`

JSON.parse 用于将*JavaScript*字符串转换为对象。对于 PHP 字符串，一旦构建为 JSON，在正确的位置回显它就相当于自己编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T23:02:35.573

```
var age = [<?php echo $age; ?>]; 
```

# c# - 检索和使用 Windows Azure 的连接字符串？

> ID：13782337
> 
> 赞同：10
> 
> 时间：2012-12-08T21:54:41.677
> 
> 标签：c#, azure, web-config, connection-string

我在 Azure 管理门户配置->连接字符串（链接资源）中配置了连接字符串：

[![在此处输入图像描述](../Images/264af293aa8e1f7dad2767e9705737c7.png)](https://i.stack.imgur.com/L1qz4.png)

这些连接字符串有什么用？

我尝试删除连接。来自 web.config 文件的字符串，所以它应该从这里读取，但它没有。

还有其他方法吗？

基本上我希望这些连接字符串覆盖 web.config 中的连接字符串，以便在生产环境中使用。

我在`Application_Start`方法中添加了以下内容：

```
var sb = new StringBuilder();
var appConfig = ConfigurationManager.OpenMachineConfiguration();  
foreach (ConnectionStringSettings conStr in appConfig.ConnectionStrings.ConnectionStrings)
  sb.AppendFormat("Name: {0}, ConnectionString: {1}\n", conStr.Name, conStr.ConnectionString);
throw new Exception(sb.ToString()); 
```

结果如下：

> 名称：LocalSqlServer，ConnectionString：数据源=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true

我也尝试了上述`ConfigurationManager.ConnectionStrings`方法，但服务器（Azure）连接字符串不存在。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-08T22:41:46.293

门户中的连接字符串允许您覆盖**web.config**中定义的连接字符串。

当您在本地进行开发时，您可能会使用位于 localhost\SQLExpress 或类似位置的数据库。如果您在没有设置 web.config 转换的情况下进行部署，则意味着您在 Windows Azure 中运行的网站仍将指向 localhost\SQLExpress，这不是您想要的。

门户中的**连接字符串**允许您覆盖已在 web.config 中定义的***现有连接字符串。***如果您的 web.config 不包含与门户中配置的连接字符串同名的连接字符串，则它不会被添加并且在运行时可访问。这可能是您遇到的问题。

**要解决此问题，**只需将连接字符串添加到您的 web.config 文件，其名称与您已添加到门户中的名称相同。

**更新：**就像我已经在评论中解释的那样，Windows Azure 网站不会实际修改 web.config ( [source](http://blog.davidebbo.com/2012/09/managing-database-connections-in-azure.html) )，它会在运行时执行此操作。因此，为了检查哪些 AppSettings 和 ConnectionStrings 在运行时实际可用，请尝试以下操作：

控制器：

```
public ActionResult Index()
{
  ViewBag.ConnectionStrings =
    ConfigurationManager.ConnectionStrings.Cast<ConnectionStringSettings>();
  ViewBag.AppSettings = ConfigurationManager.AppSettings;
  return View();
} 
```

看法：

```
<h3>ConnectionStrings:</h3>
<ul>
  @foreach (var setting in ViewBag.ConnectionStrings)
  {
    <li>@setting.Name: @setting.ConnectionString</li>
  }
</ul>
<h3>AppSettings:</h3>
<ul>
  @foreach (var s in ViewBag.AppSettings)
  {
    <li>@setting: @System.Configuration.ConfigurationManager.AppSettings[s]</li>
  }
</ul> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-21T08:10:53.757

两天后，我终于设法让它工作了。我在这里添加我的解决方案，希望它将来可能对某人有所帮助。

**环境**

*   Azure API APP（但理论上，它也应该适用于其他类型的项目）
*   SQL DB（托管在 Azure 上）。显然可以是任何数据库
*   EF 6.0 - 数据库优先方法
*   连接字符串存储在 Azure 上的应用程序设置 -> 连接字符串部分。如下图所示

[![Azure 的快照 -> Api 应用程序 -> 应用程序设置 -> 连接字符串](../Images/6b2402c4de7920ccd7dca740aac44700.png)](https://i.stack.imgur.com/i1h8n.png)

**我想做的是** 我想把我的连接字符串放在 Azure 上，就像@Sandrino Di Mattia 提到的那样，从那里动态检索它。

**对我有用的步骤**

1.  在 web.config 中创建 connectionStrings

`

```
<connectionStrings>
    <add name="dbConnectionStringForAzure" connectionString="Local Connection String" providerName="System.Data.EntityClient"/>
  </connectionStrings> 
```

`

请注意 providerName 是*System.Data.EntityClient*而不是*System.Data.SqlClient*。

**额外的一点：**此外，一旦您发布了项目，您可以验证 web.config 中的连接字符串。导航到projectorapiurl.scm.azurewebsites.net。

转到菜单 -> 调试控制台 -> PowerShell -> 编辑 Web.config 文件。（还有其他获取 web.config 文件的方法。使用您喜欢的那个。）

**注意：**您可能会在此处找到另一个由 Azure 自动生成的连接字符串。删除它是安全的，因为我们没有使用它。

2.  转到 Azure -> 您的项目和应用程序设置。添加如下所示的详细信息：

    姓名 =`dbConnectionStringForAzure`

    价值 =`Provider=System.Data.SqlClient; metadata=res://*/csdlModel.csdl|res://*/ssdlModel.ssdl|res://*/mslModel.msl; Provider Connection String ='Data Source=server.database.windows.net,1433;initial catalog=database;User ID=username;Password=password;MultipleActiveResultSets=True;App=EntityFramework;'`

3.  在第三个下拉列表前面，选择 CUSTOM。重要的是，Azure 将在我们不想要的连接字符串的提供程序名称中添加 System.Data.SqlClient（或任何其他提供程序，具体取决于所选内容）。

4.  节省

在这个阶段，Azure 应该在运行时使用这个连接字符串。想要验证！？执行类似于@Sandrino Di Mattia 上面的建议或@Shaun Luttin 在此 SO 帖子中的建议[检索 SQL Azure 数据库的连接字符串，该数据库使用 C#.NET 链接到 Windows Azure 网站](https://stackoverflow.com/questions/20507956/retrieve-the-connection-string-of-an-sql-azure-database-that-is-linked-to-a-wind)。

或者，将以下代码放入任何剃须刀模板中：

```
 <p>Value of dbConnectionStringForAzure  :
    @System.Configuration.ConfigurationManager.ConnectionStrings["dbConnectionStringForAzure"].ConnectionString    
    </p> 
```

另一方面，我在 DbContext 构造函数中设置了连接字符串名称。

```
 public MyEntities() : base("name=dbConnectionStringForAzure")
        {

        } 
```

现在，当我调用我的 API 时，它会动态使用存储在 Azure 中的连接。

感谢几十个帖子和额外的咖啡！

# tcp - nfdump 中的“流”到底是什么？我可以使用 nfdump 获得 tcp 会话吗？

> ID：13782338
> 
> 赞同：1
> 
> 时间：2012-12-08T21:54:48.527
> 
> 标签：tcp, statistics, flow, netflow

我需要从我的网络接口中的数据包创建一些统计信息，但我只关心我的 tcp 会话。我想我可以用 nfdump 和 nfsen 做到这一点。因为我对这些东西不熟悉，所以我真的不明白 nfdump 定义为“流”的内容。

此外，我可以使用这些工具仅获取 tcp 协议会话的统计信息吗？我的意思是，例如，我需要在我的服务器中获得所有连接（srcip-srcport、dstip-dstport 对）的平均持续时间。出于这个原因，我需要 3WH 和每个连接关闭之间的时间（使用 [fin/ack,ack] 或使用 [rst]）。nfdump-nfsen 有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-12T16:40:09.707

简短的回答是否定的：您的软件列表中没有任何东西可以生成网络流信息。这是行不通的。Netflow 收集器不会像您希望的那样努力维护您对连接的想法 - 流只是在收集周期的一部分中发生的相关数据包的集合。对于长期存在的会话，您可能会看到一些流。

对于您的应用程序，您最好使用 tcpdump 捕获 syn-ack 和 fin 数据包，并使用您最喜欢的文本处理工具分析它们的时序。

此外，在键盘的左侧，您可能会找到一个带有箭头的键，可让您输入大写字母。

# sql-server - 为什么 distinct 在这个 sql 查询中不起作用？- 复杂的查询

> ID：13782345
> 
> 赞同：1
> 
> 时间：2012-12-08T21:56:08.387
> 
> 标签：sql-server, select, sql-server-2008-r2, distinct

> **可能重复：**
> [SQL Server 中的不同](https://stackoverflow.com/questions/8173137/distinct-in-sql-server)

我想选择不同的 PokemonId 变量，但它不起作用

这里是查询

```
select distinct top 36 
    tblFoundPokemonsOnRoutes.pokemonId,MonsterTotalStats,
    MAX(maxLevel) as maxLevel,
    Case Class WHEN 'Ancient' Then '9' 
      WHEN 'Legendary' Then '8' 
      WHEN 'Zenith' Then '7' 
      WHEN 'Emissary' Then '6' 
      WHEN 'Starter' Then '5' 
      WHEN 'Superior' Then '4' 
      WHEN 'Regular' Then '3' 
      ELSE Class 
    END as Result 
from 
    tblFoundPokemonsOnRoutes 
left join 
    tblPokedex on tblFoundPokemonsOnRoutes.pokemonId = tblPokedex.PokemonId 
where 
    tblFoundPokemonsOnRoutes.routeId in 
          (select routeId from tblRoutes where ZoneNumber = 1) 
group by 
    maxLevel, tblFoundPokemonsOnRoutes.pokemonId, MonsterTotalStats, Class 
order by 
    Result desc, MonsterTotalStats desc 
```

这里返回的结果

![在此处输入图像描述](../Images/41edfe2ba07108e74e724480355515c6.png)

非常感谢您的回答

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T05:40:12.157

你不应该包括`MaxLevel`在你的`GroupBy`条款中。这样做：

```
select distinct top 36 
    tblFoundPokemonsOnRoutes.pokemonId,MonsterTotalStats,
    MAX(maxLevel) as maxLevel,
    Case Class WHEN 'Ancient' Then '9' 
      WHEN 'Legendary' Then '8' 
      WHEN 'Zenith' Then '7' 
      WHEN 'Emissary' Then '6' 
      WHEN 'Starter' Then '5' 
      WHEN 'Superior' Then '4' 
      WHEN 'Regular' Then '3' 
      ELSE Class 
    END as Result 
from 
    tblFoundPokemonsOnRoutes 
left join 
    tblPokedex on tblFoundPokemonsOnRoutes.pokemonId = tblPokedex.PokemonId 
where 
    tblFoundPokemonsOnRoutes.routeId in 
          (select routeId from tblRoutes where ZoneNumber = 1) 
group by 
     tblFoundPokemonsOnRoutes.pokemonId, MonsterTotalStats, Class 
order by 
    Result desc, MonsterTotalStats desc 
```

# ajax - Django中的X-editable内联编辑-如何获得CSRF保护？

> ID：13782351
> 
> 赞同：17
> 
> 时间：2012-12-08T21:56:30.933
> 
> 标签：ajax, django, x-editable

我正在尝试在 Django 中对模型进行[X-Editable](http://vitalets.github.com/x-editable/index.html)内联编辑。我只是想更改模型实例的属性（在本例中为 Dataset 对象的名称）。

我不确定如何编写视图，以便正确捕获来自 ajax 请求的信息：

```
POST /datasets/9/update_name/
{
    pk:    3            //primary key (record id)
    value: 'The Updated Name' //new value
} 
```

然后将新名称保存到 Dataset 对象。

网址.py

```
# ex: /datasets/3/update_name
url(r'^(?P<pk>\d+)/update_name/$', update_name ,
    name='update_name'), 
```

详细信息.html

```
<h1 class="page-title center">
    <a href="#" id="datasetName">{{ dataset.name }}</a>
</h1>
<script>
$('#datasetName').editable({
  type: 'text',
  pk: {{ dataset.pk }},
  url: '{% url 'datasets:update_name' dataset.pk %}',
  title: 'Edit dataset name'
  params: { csrf: '{% csrf_token %}'} # // This isn't working
});
</script> 
```

视图.py

```
def update_name(request, dataset_id):   
    # ... Update Dataset object ...
    json = simplejson.dumps(request.POST)
    return HttpResponse(json, mimetype='application/json') 
```

**编辑：**

我认为问题在于没有 CSRF 保护。如何在 X 可编辑表单中添加它？

** 编辑 2：

根据文档，我也试过这个：

```
<h1 class="page-title center">
  <a href="#" id="datasetName">{{ dataset.name }}</a>
</h1>

<script>
// using jQuery
function getCookie(name) {
  var cookieValue = null;
  if (document.cookie && document.cookie != '') {
    var cookies = document.cookie.split(';');
    for (var i = 0; i < cookies.length; i++) {
      var cookie = jQuery.trim(cookies[i]);
          // Does this cookie string begin with the name we want?
          if (cookie.substring(0, name.length + 1) == (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }
    var csrftoken = getCookie('csrftoken');

    function csrfSafeMethod(method) {
  // these HTTP methods do not require CSRF protection
  return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({ 
 beforeSend: function(xhr, settings) {
   function getCookie(name) {
     var cookieValue = null;
     if (document.cookie && document.cookie != '') {
       var cookies = document.cookie.split(';');
       for (var i = 0; i < cookies.length; i++) {
         var cookie = jQuery.trim(cookies[i]);
                   // Does this cookie string begin with the name we want?
                   if (cookie.substring(0, name.length + 1) == (name + '=')) {
                     cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                     break;
                   }
                 }
               }
               return cookieValue;
             }
             if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
           // Only send the token to relative URLs i.e. locally.
           xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
         }
       } 
     });
$('#datasetName').editable({
  type: 'text',
  pk: {{ dataset.pk }},
  url: '{% url 'datasets:update_name' dataset.pk %}',
  title: 'Edit dataset name',
});
</script> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-01-28T14:14:53.270

哇，我花了这么多时间在这个问题上！

入围版本将是：

```
<a href="#" id="projectname{{project.id}}" data-type="text" data-pk="{{project.id}}" data-title="Enter project name" data-url="{% url 'updateproject' project.id %}" data-params="{csrfmiddlewaretoken:'{{csrf_token}}'}">{{ project.name }}</a> 
```

然后，打电话

```
$('#projectname{{project.id}}').editable(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T09:25:42.937

csrf 表单域的正确名称是`csrfmiddlewaretoken`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-04T19:14:24.783

我在我的 PHP 项目中遇到了这个问题，我使用 ajaxOptions 选项解决了这个问题。从元标记中提取 CSRF Token 并将其添加到请求标头中。

```
ajaxOptions: {
  dataType: 'json',
  beforeSend: function(xhr){
    xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]')
       .attr('content'));
    }           
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-28T23:05:44.000

我认为是正确的，特别是如果您正在使用 rails 添加

```
 ajaxOptions: {
            beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))}, 
        }, 
```

里面的可编辑功能是

```
 $('#projectname').editable({
            showbuttons: 'bottom',
            ajaxOptions: {
                beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))}, 
            },              
            type: 'textarea',
            url: '/url/url'

        }); 
```

# c# - 我想用 HtmlAgilityPack 检索 html 元素的宽度和高度

> ID：13782352
> 
> 赞同：0
> 
> 时间：2012-12-08T21:56:34.797
> 
> 标签：c#, asp.net, html-agility-pack

`HtmlAgilityPack`如何使用我这样做来检索 img 元素的宽度和高度..

```
 HtmlAgilityPack.HtmlAttribute width = link.Attributes["width"];
    HtmlAgilityPack.HtmlAttribute height = link.Attributes["height"]; 
```

但在大多数情况下，宽度和高度为空。如何获得css的高度和宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:38:45.927

此页面中的基础：[页面](http://www.img.com.br/default.aspx)

```
public sealed class UtilParserHTML
{

    //Private Fields
    private Uri Uri;
    private Stream StreamPage;
    private HttpWebRequest HttpRequest;
    private HttpWebResponse HttpResponse;

    //Public Fields
    public HtmlDocument HtmlDocument { private set; get; }

    public UtilParserHTML()
    {
        if (this.HtmlDocument == null)
            HtmlDocument = new HtmlDocument();
    }

    public void LoadHTMLPage(string UrlPage)
    {
        if (string.IsNullOrEmpty(UrlPage))
            throw new ArgumentNullException("");

        CookieContainer cookieContainer = new CookieContainer();

        this.Uri = new Uri(UrlPage);
        this.HttpRequest = (HttpWebRequest)WebRequest.Create(UrlPage);
        this.HttpRequest.Method = WebRequestMethods.Http.Get;       
        this.HttpRequest.CookieContainer = cookieContainer;
        this.HttpResponse = (HttpWebResponse)this.HttpRequest.GetResponse();
        this.StreamPage = this.HttpResponse.GetResponseStream();
        this.HtmlDocument.Load(StreamPage);
    }

    public void LoadHTMLPage(FileStream StreamPage)
    {
        if (StreamPage == null)
            throw new ArgumentNullException("");

        HtmlDocument.Load(StreamPage);
    }

    public HtmlNodeCollection GetNodesByExpression(string XPathExpression)
    {
        if (string.IsNullOrEmpty(XPathExpression))
            throw new ArgumentNullException("");

        return this.HtmlDocument.DocumentNode.SelectNodes(XPathExpression);
    } 
```

使用[XPath](http://www.w3schools.com/xpath/default.asp)在 html 中导航。在这种情况下，我使用了这个 Xpath 表达式： //div[@class='arrowRibbon'] //img

看： **...**

```
this.ParserHTML.LoadHTMLPage("http://www.img.com.br/default.aspx");
            HtmlNodeCollection HtmlNodeCollectionResult = this.ParserHTML.GetNodesByExpression(Page.XPathExpression);

            if (HtmlNodeCollectionResult != null)
            {
                foreach (HtmlNode NodeResult in HtmlNodeCollectionResult)
                {
                    var src = NodeResult.Attributes["src"].Value;
                }
            } 
```

**...**

**编辑**

看看这个带有宽度和高度的完整示例：

```
this.ParserHTML.LoadHTMLPage("http://www.w3schools.com/tags/tag_img.asp");
            HtmlNodeCollection HtmlNodeCollectionResult = this.ParserHTML.GetNodesByExpression("//div[@class='tryit_ex'] //img");

            if (HtmlNodeCollectionResult != null)
            {
                foreach (HtmlNode NodeResult in HtmlNodeCollectionResult)
                {
                    var src = NodeResult.Attributes["src"].Value;
                    var w = NodeResult.Attributes["width"].Value;
                    var h = NodeResult.Attributes["height"].Value;
                }
            } 
```

希望这有帮助。

# assembly - 简单 mips 中的无限循环

> ID：13782358
> 
> 赞同：0
> 
> 时间：2012-12-08T21:57:19.293
> 
> 标签：assembly, mips

我正在尝试了解$ra，所以我想要的输出是“mainfunction1main”，通过main调用function1，function1返回main，main完成。但由于某种原因，我得到了一个打印“mainfunction1mainfunction1......”的无限循环我做错了什么？

```
 .data
mainstring: .asciiz "main"  
string1: .asciiz "function1"
string2: .asciiz "function2"
string3: .asciiz "function3"

.text

main:   la $a0,mainstring
        li $v0, 4
        syscall

        jal function1

        la $a0, mainstring
        syscall

function1: la $a0, string1
            syscall
            jr $ra 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:02:41.550

您需要在 main 结束时返回。目前，您将再次掉入function1，它将跳回main，然后再次掉入，依此类推...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T22:10:27.850

就像 JasonD 说的，你需要在 main 结束时退出你的程序。您需要做的就是在 main 末尾添加两行，如下所示：

```
main:
    # ... previous stuff

    li $v0, 10                                                                                                                                                               
    syscall 
```

这将加载并运行`exit`系统调用（代码为 10。）

# jakarta-ee - java.lang.ClassCastException 的问题：org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement to oracle.jdbc.OraclePreparedStatement

> ID：13782362
> 
> 赞同：2
> 
> 时间：2012-12-08T21:57:54.310
> 
> 标签：jakarta-ee

我一直在尝试按照本在线教程在 Tomcat 6.0.24 中运行 JPA 2.0： [http ://wiki.eclipse.org/EclipseLink/Examples/JPA/Tomcat_Web_Tutorial](http://wiki.eclipse.org/EclipseLink/Examples/JPA/Tomcat_Web_Tutorial)

到目前为止，它可以检索数据源并运行 select 语句。查询 aQuery = em.createQuery("select e from Employee e"); empList = aQuery.getResultList();

但是当我尝试调用 entityManager.persist(employee) 时它失败了。代码如下所示：

```
try {
em.getTransaction().begin();
    em.persist(emp);
em.getTransaction().commit();
} catch (Exception ex) {
ex.printStackTrace();
em.getTransaction().rollback();
} 
```

我在控制台中收到此异常：

```
[EL Finest]: jpa: 2012-12-08 16:17:16.38--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--Begin predeploying Persistence Unit jpaOrclJtaPU; session file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/_jpaOrclJtaPU; state Initial; factoryCount 0
[EL Finest]: properties: 2012-12-08 16:17:16.396--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.orm.throw.exceptions; default value=true
[EL Finest]: properties: 2012-12-08 16:17:16.397--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.multitenant.tenants-share-emf; default value=true
[EL Finest]: properties: 2012-12-08 16:17:16.397--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.multitenant.tenants-share-cache; default value=false
[EL Finer]: metadata: 2012-12-08 16:17:16.422--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--Searching for default mapping file in file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/ (There is no English translation for this message.)
[EL Finer]: metadata: 2012-12-08 16:17:16.428--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--Searching for default mapping file in file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/ (There is no English translation for this message.)
[EL Config]: metadata: 2012-12-08 16:17:16.606--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--The access type for the persistent class [class com.arb.my.domain.Employee] is set to [FIELD].
[EL Config]: metadata: 2012-12-08 16:17:16.637--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--The alias name for the entity class [class com.arb.my.domain.Employee] is being defaulted to: Employee.
[EL Config]: metadata: 2012-12-08 16:17:16.64--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--The table name for entity [class com.arb.my.domain.Employee] is being defaulted to: EMPLOYEE.
[EL Finest]: jpa: 2012-12-08 16:17:16.672--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--End predeploying Persistence Unit jpaOrclJtaPU; session file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/_jpaOrclJtaPU; state Predeployed; factoryCount 0
[EL Finer]: weaver: 2012-12-08 16:17:16.673--Thread(Thread[http-bio-8082-exec-4,5,main])--JavaSECMPInitializer - transformer is null.
[EL Finest]: jpa: 2012-12-08 16:17:16.673--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--Begin predeploying Persistence Unit jpaOrclJtaPU; session file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/_jpaOrclJtaPU; state Predeployed; factoryCount 0
[EL Finest]: jpa: 2012-12-08 16:17:16.673--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--End predeploying Persistence Unit jpaOrclJtaPU; session file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/_jpaOrclJtaPU; state Predeployed; factoryCount 1
[EL Finest]: jpa: 2012-12-08 16:17:16.683--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--Begin deploying Persistence Unit jpaOrclJtaPU; session file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/_jpaOrclJtaPU; state Predeployed; factoryCount 1
[EL Finer]: 2012-12-08 16:17:16.692--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--Could not initialize Validation Factory. Encountered following exception: java.lang.NoClassDefFoundError: javax/validation/Validation
[EL Finest]: properties: 2012-12-08 16:17:16.696--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.logging.level; value=FINEST; translated value=FINEST
[EL Finest]: properties: 2012-12-08 16:17:16.696--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.logging.level; value=FINEST; translated value=FINEST
[EL Finest]: properties: 2012-12-08 16:17:16.696--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.target-database; value=Oracle11; translated value=org.eclipse.persistence.platform.database.oracle.Oracle11Platform
[EL Finest]: properties: 2012-12-08 16:17:16.712--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.jdbc.batch-writing; value=Oracle-JDBC; translated value=Oracle-JDBC
[EL Finest]: properties: 2012-12-08 16:17:16.713--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--property=eclipselink.session.customizer; value=com.arb.my.util.JPAEclipseLinkSessionCustomizer
_JPAEclipseLinkSessionCustomizer: configured java:comp/env/jdbc/EmployeeDS
[EL Info]: 2012-12-08 16:17:16.717--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--EclipseLink, version: Eclipse Persistence Services - 2.4.1.v20121003-ad44345
[EL Config]: connection: 2012-12-08 16:17:16.806--ServerSession(10229612)--Connection(25559254)--Thread(Thread[http-bio-8082-exec-4,5,main])--connecting(DatabaseLogin(
    platform=>Oracle11Platform
    user name=> ""
    connector=>JNDIConnector datasource name=>java:comp/env/jdbc/EmployeeDS
))
[EL Config]: connection: 2012-12-08 16:17:17.121--ServerSession(10229612)--Connection(8689654)--Thread(Thread[http-bio-8082-exec-4,5,main])--Connected: jdbc:oracle:thin:@127.0.0.1:1521:xe
    User: MH
    Database: Oracle  Version: Oracle Database 11g Express Edition Release 11.2.0.2.0 - Beta
    Driver: Oracle JDBC driver  Version: 11.2.0.2.0
[EL Finest]: connection: 2012-12-08 16:17:17.121--ServerSession(10229612)--Connection(18129670)--Thread(Thread[http-bio-8082-exec-4,5,main])--Connection acquired from connection pool [read].
[EL Finest]: connection: 2012-12-08 16:17:17.122--ServerSession(10229612)--Connection(18129670)--Thread(Thread[http-bio-8082-exec-4,5,main])--Connection released to connection pool [read].
[EL Config]: connection: 2012-12-08 16:17:17.122--ServerSession(10229612)--Connection(31133089)--Thread(Thread[http-bio-8082-exec-4,5,main])--connecting(DatabaseLogin(
    platform=>Oracle11Platform
    user name=> ""
    connector=>JNDIConnector datasource name=>java:comp/env/jdbc/EmployeeDS
))
[EL Config]: connection: 2012-12-08 16:17:17.122--ServerSession(10229612)--Connection(6019448)--Thread(Thread[http-bio-8082-exec-4,5,main])--Connected: jdbc:oracle:thin:@127.0.0.1:1521:xe
    User: MH
    Database: Oracle  Version: Oracle Database 11g Express Edition Release 11.2.0.2.0 - Beta
    Driver: Oracle JDBC driver  Version: 11.2.0.2.0
[EL Info]: connection: 2012-12-08 16:17:17.632--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/_jpaOrclJtaPU login successful
[EL Finer]: metamodel: 2012-12-08 16:17:17.658--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--Canonical Metamodel class [com.arb.my.domain.Employee_] not found during initialization.
[EL Finest]: jpa: 2012-12-08 16:17:17.658--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--End deploying Persistence Unit jpaOrclJtaPU; session file:/C:/eclipseProjects/workspaces/JPA4ORCL/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/JPAStruts1310Web/WEB-INF/classes/_jpaOrclJtaPU; state Deployed; factoryCount 1
[EL Finer]: connection: 2012-12-08 16:17:17.679--ServerSession(10229612)--Thread(Thread[http-bio-8082-exec-4,5,main])--client acquired: 7060068
[EL Finer]: transaction: 2012-12-08 16:17:17.692--ClientSession(7060068)--Thread(Thread[http-bio-8082-exec-4,5,main])--acquire unit of work: 9790036
[EL Finest]: transaction: 2012-12-08 16:17:17.692--UnitOfWork(9790036)--Thread(Thread[http-bio-8082-exec-4,5,main])--persist() operation called on: com.arb.my.domain.Employee@16aa42e.
[EL Finer]: transaction: 2012-12-08 16:17:17.694--UnitOfWork(9790036)--Thread(Thread[http-bio-8082-exec-4,5,main])--begin unit of work commit
[EL Finest]: query: 2012-12-08 16:17:17.702--UnitOfWork(9790036)--Thread(Thread[http-bio-8082-exec-4,5,main])--Execute query InsertObjectQuery(com.arb.my.domain.Employee@16aa42e)
[EL Finest]: connection: 2012-12-08 16:17:17.704--ServerSession(10229612)--Connection(21263661)--Thread(Thread[http-bio-8082-exec-4,5,main])--Connection acquired from connection pool [default].
[EL Finer]: transaction: 2012-12-08 16:17:17.704--ClientSession(7060068)--Connection(21263661)--Thread(Thread[http-bio-8082-exec-4,5,main])--begin transaction
[EL Finest]: connection: 2012-12-08 16:17:17.705--ClientSession(7060068)--Thread(Thread[http-bio-8082-exec-4,5,main])--reconnecting to external connection pool
[EL Finer]: sql: 2012-12-08 16:17:17.705--ClientSession(7060068)--Connection(23651369)--Thread(Thread[http-bio-8082-exec-4,5,main])--Begin batch statements
[EL Fine]: sql: 2012-12-08 16:17:17.706--ClientSession(7060068)--Connection(23651369)--Thread(Thread[http-bio-8082-exec-4,5,main])--INSERT INTO EMPLOYEE (EMP_NO, EMP_FNAME, EMP_LNAME, JOIN_DATE) VALUES (?, ?, ?, ?)
[EL Fine]: sql: 2012-12-08 16:17:17.706--ClientSession(7060068)--Connection(23651369)--Thread(Thread[http-bio-8082-exec-4,5,main])--    bind => [4, Issa, Haque, null]
[EL Finer]: sql: 2012-12-08 16:17:17.706--ClientSession(7060068)--Connection(23651369)--Thread(Thread[http-bio-8082-exec-4,5,main])--End Batch Statements
[EL Finer]: transaction: 2012-12-08 16:17:17.831--ClientSession(7060068)--Connection(23651369)--Thread(Thread[http-bio-8082-exec-4,5,main])--rollback transaction
[EL Finest]: connection: 2012-12-08 16:17:17.832--ServerSession(10229612)--Connection(21263661)--Thread(Thread[http-bio-8082-exec-4,5,main])--Connection released to connection pool [default].
[EL Warning]: 2012-12-08 16:17:17.832--UnitOfWork(9790036)--Thread(Thread[http-bio-8082-exec-4,5,main])--java.lang.ClassCastException: org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement cannot be cast to oracle.jdbc.OraclePreparedStatement
    at org.eclipse.persistence.platform.database.oracle.Oracle9Platform.prepareBatchStatement(Oracle9Platform.java:747)
    at org.eclipse.persistence.internal.databaseaccess.ParameterizedSQLBatchWritingMechanism.prepareBatchStatements(ParameterizedSQLBatchWritingMechanism.java:180)
    at org.eclipse.persistence.internal.databaseaccess.ParameterizedSQLBatchWritingMechanism.executeBatchedStatements(ParameterizedSQLBatchWritingMechanism.java:144)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.writesCompleted(DatabaseAccessor.java:1714)
    at org.eclipse.persistence.internal.sessions.AbstractSession.writesCompleted(AbstractSession.java:3951)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.writesCompleted(UnitOfWorkImpl.java:5552)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.acquireWriteLocks(UnitOfWorkImpl.java:1624)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitTransactionAfterWriteChanges(UnitOfWorkImpl.java:1592)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.commitRootUnitOfWork(RepeatableWriteUnitOfWork.java:274)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitAndResume(UnitOfWorkImpl.java:1147)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl.commitInternal(EntityTransactionImpl.java:84)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl.commit(EntityTransactionImpl.java:63)
    at com.arb.my.domain.controller.EmployeeManager.createEmployee(EmployeeManager.java:44)
    at com.arb.my.action.EmployeeDetailAction.execute(EmployeeDetailAction.java:37)
    at org.apache.struts.chain.commands.servlet.ExecuteAction.execute(ExecuteAction.java:58)
    at org.apache.struts.chain.commands.AbstractExecuteAction.execute(AbstractExecuteAction.java:67)
    at org.apache.struts.chain.commands.ActionCommandBase.execute(ActionCommandBase.java:51)
    at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:191)
    at org.apache.commons.chain.generic.LookupCommand.execute(LookupCommand.java:305)
    at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:191)
    at org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:283)
    at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)
    at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:449)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:931)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

知道为什么我会收到此异常吗？在运行 JPA 之前，其他任何人都遇到过这个错误吗？知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:49:58.263

好吧，撞了我的头 72 小时后，我自己想通了（拍拍自己的背！）

我在persistence.xml 中有这个“批量写入”属性到“Oracle-JDBC”。我将其更改为“JDBC”并开始工作！

http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"> </persistence-unit>, java:comp/env/--> org.eclipse.persistence.jpa.PersistenceProvider java:comp/ env/jdbc/EmployeeDS com.arb.my.domain.Employee

我希望它对将来遇到这个问题的人有所帮助。

# c++ - 'LVS_EX_FULLROWSELECT' was not declared in this scope

> ID：13782376
> 
> 赞同：0
> 
> 时间：2012-12-08T21:59:10.907
> 
> 标签：c++, winapi

I have code like this and I get 2 errors:

*   " [Error] 'LVS_EX_FULLROWSELECT' was not declared in this scope "
*   " [Error] 'ListView_SetExtendedListViewStyle' was not declared in this scope "

I've tried to define it like this: "#define LVS_EX_FULLROWSELECT 32", but it doesn't work:(

Code as below:

```
 if(LOWORD( wParam ) == 103 ){
GetClientRect( hwnd, & rcl );
HWND hListView = CreateWindowEx( 0, WC_LISTVIEW, NULL, WS_CHILD | WS_VISIBLE | LVS_REPORT |
LVS_EDITLABELS, 0, 200, rcl.right - rcl.left, 300,
hwnd,( HMENU ) 1000, hInstance, NULL );

ListView_SetExtendedListViewStyle( hListView, LVS_EX_FULLROWSELECT );
//POCZĄTEK NAZW KOLUMN
lvc.mask = LVCF_WIDTH | LVCF_TEXT | LVCF_SUBITEM;

lvc.iSubItem = 0;
lvc.cx = 200;
lvc.pszText = "Player";
ListView_InsertColumn( hListView, 0, & lvc );

lvc.iSubItem = 1;
lvc.cx = 100;
lvc.pszText = "Number of games";
ListView_InsertColumn( hListView, 1, & lvc );

lvc.iSubItem = 2;
lvc.cx = 60;
lvc.pszText = "In game";
ListView_InsertColumn( hListView, 2, & lvc );

//KONIEC NAZW KOLUMN

//POCZĄTEK DODAWANIA ZAWARTOŚCI

lvi.mask = LVIF_TEXT;

for (int i=0; i<1000; i++) {
ostringstream i1a;
i1a << i;
string i1b = i1a.str();

TCHAR *player=new TCHAR[i1b.size()+1];
player[i1b.size()]=0;
copy(i1b.begin(),i1b.end(),player);

lvi.iItem = i;
lvi.pszText = player;
lvi.iSubItem = 0;
ListView_InsertItem( hListView, & lvi );

ListView_SetItemText( hListView, 0, 1, "15" );
ListView_SetItemText( hListView, 0, 2, "3" );
ListView_SetItemText( hListView, 1, 1, "15" );
ListView_SetItemText( hListView, 1, 2, "6" );
}

break;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-20T12:29:28.097

```
#define _WIN32_IE 0x0300 
```

这对我有用

# php - Wordpress page isn't showing stylesheet

> ID：13782381
> 
> 赞同：0
> 
> 时间：2012-12-08T21:59:38.363
> 
> 标签：php, html, css, wordpress

My wordpress page isn't showing any stylesheet.

[http://www.soenhks.dk/](http://www.soenhks.dk/)

I did a few changes to the hardcoded menu inside the header.php and then it went like this.

A cookie to the person who finds the flaw.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T22:02:27.287

在你的标题中检查这个

```
href="<u?php bloginfo('stylesheet_url') ?>" 
```

并删除 < 和 ? 之间的 u

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:03:19.097

改变这个：

```
<link rel="stylesheet" type="text/css" href="<u?php bloginfo('stylesheet_url') ?>" /> 
```

有了这个：

```
<link rel="stylesheet" type="text/css" href="<?php bloginfo('stylesheet_url') ?>" /> 
```

# php - php电子邮件未发送

> ID：13782397
> 
> 赞同：-2
> 
> 时间：2012-12-08T22:01:57.067
> 
> 标签：php

我只是想知道是否有人在这里看到任何错误，代码执行但我从未收到电子邮件，有什么建议吗？

```
$to = $_POST['to_email'];
$subject = $_POST['subject'];
$message='<p><b>Message:</b> '.str_replace("\n.", "\n..", $_POST['message']).'</p>';

$headers = "From: " . strip_tags($_POST['from_email']) . "\r\n";
$headers .= "Reply-To: ". strip_tags($_POST['from_email']) . "\r\n".
        'X-Mailer: PHP/' . phpversion();

mail($to, $subject, $message, $headers); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:11:41.617

mail() 函数只是使用 sendmail unix/linux 命令来发送邮件。如果配置错误，将无法使用

如果您有权访问您的 php ini，请查看 [mail] 部分

```
smtp = SMTPSERVER (windows)
smtp_port = 25    (Windows)
sendmail_path= (unix) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:12:54.207

这将取决于 PHP 的设置。

PHP 可以做很多事情 - 最常见的是将电子邮件排队到本地邮件服务器（在 linux 上很常见，在 windows 上较少）或与外部邮件中继通信并在那里排队（通常需要身份验证，除非它是一个罕见的开放式继电器）。也可以写入文件。

`mail()`如果没有警告，该函数只保证电子邮件已排队到 php.ini 文件中指定的位置。

首先要做的是检查邮件是否报告成功...

```
$Success = @mail($to, $subject, $message, $headers);
if(!$Success) {
    print "Failed to queue email";
} 
```

您需要做的下一件事是检查您的`php.ini`配置以查看电子邮件的配置方式。确保它指向具有正确凭据的有效邮件服务器。如果您在 linux 上并使用像[postfix](http://www.postfix.org/)这样的本地邮件服务器，请检查它是否正在运行（`/etc/init.d/postfix status`取决于您的发行版）

正如@FlorianKasper 所述，SMTP 作为选项仅在 Windows 上可用。如果您能准确说明您使用的是什么操作系统，我们可能会提供进一步的帮助。

# java - Guava / 测试迭代器实现

> ID：13782400
> 
> 赞同：1
> 
> 时间：2012-12-08T22:02:32.003
> 
> 标签：java, guava

是否可以将 Guava 测试用于迭代器？我尝试过扩展`IteratorTester`，但`com.google.common.collect.testing.AbstractIteratorTester`不是公开的，因此无法添加构造函数。也许我必须使用另一个课程，或者它不是为公众制作的？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:40:09.827

[此示例](https://code.google.com/p/guava-libraries/source/browse/guava-testlib/src/com/google/common/collect/testing/testers/CollectionIteratorTester.java#98)提供`CollectionIteratorTester`了如何构建`IteratorTester`.

# python - 在 Nginx 上部署 Bottle 应用

> ID：13782402
> 
> 赞同：3
> 
> 时间：2012-12-08T22:02:45.207
> 
> 标签：python, ubuntu, nginx, bottle

我有一个 Ubuntu 12.04 服务器设置，当前在 Passenger / Nginx 安装上运行 Ruby on Rails 应用程序。我决定尝试一些 Python 并使用[Bottle](http://bottlepy.org/docs/dev/)编写了一个小应用程序。我想将此应用程序部署到我的服务器。我按照[本指南](http://library.linode.com/web-servers/nginx/python-uwsgi/ubuntu-12.04-precise-pangolin)设置我的服务器以运行 Python 应用程序。当我运行时，`sudo service uwsgi restart`我收到以下错误消息：

```
Restarting app server(s) uwsgi                                     
[uWSGI] getting INI configuration from  
/usr/share/uwsgi/conf/default.ini [uWSGI] parsing config file /etc/uwsgi/apps-enabled/example.net.xml  
open("./python_plugin.so"): No such file or directory [core/utils.cline 4700]
!!! UNABLE to load uWSGI plugin: ./python_plugin.so: cannot  open shared object file: No such file or directory !!!   
Sat Dec  8 18:29:14 2012 - [WARNING] option "app" is deprecated: use the more advanced "mount" option 
```

我真的不太了解 Python，我已经安装了我需要的插件`easy_install`

哪个是：

*   pymongo
*   美丽的汤
*   瓶子

我的问题是：如何将这个简单的应用程序部署到我的服务器上？
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:48:50.847

我发现Passenger 将运行WSGI 应用程序。我按照这篇文章[http://kbeezie.com/using-python-nginx-passenger/](http://kbeezie.com/using-python-nginx-passenger/)上的说明进行操作，并且没有遇到任何问题。

最后其实很简单。

这是我的适配器，以防其他人遇到问题：

[https://github.com/nick-desteffen/astronomy-pics/blob/master/passenger_wsgi.py](https://github.com/nick-desteffen/astronomy-pics/blob/master/passenger_wsgi.py)

# scala - 解释器中的汽化 Predef.any2stringadd

> ID：13782406
> 
> 赞同：5
> 
> 时间：2012-12-08T22:03:33.387
> 
> 标签：scala, implicit-conversion

`Predef.any2stringadd`不幸的是，我遇到了问题，[官方认为它不是 PITA](https://issues.scala-lang.org/browse/SI-194)。我改变了我的 API 从

```
trait Foo {
   def +(that: Foo): Foo
} 
```

类型类方法

```
object Foo {
   implicit def fooOps(f: Foo): Ops = new Ops(f)
   final class Ops(f: Foo) {
      def +(that: Foo): Foo = ???
   }
}
trait Foo 
```

*现在我可以像这样在编译代码*中隐藏那个可怕的方法：

```
import Predef.{any2stringadd => _} 
```

但是，这在我的 REPL/解释器环境中失败了。

```
val in = new IMain(settings, out)
in.addImports("Predef.{any2stringadd => _}") // has no effect? 
```

我怎样才能告诉解释器蒸发这种烦人的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:45:34.880

一种解决方法似乎是将隐式转换从`Foo`' 的伴随对象中取出，并将其放在顶层层次结构中（在我的真实案例中为包对象）：

```
object Foo {
//   implicit def fooOps(f: Foo): Ops = new Ops(f)
   final class Ops(f: Foo) {
      def +(that: Foo): Foo = ???
   }
}
trait Foo
implicit def fooOps(f: Foo): Foo.Ops = new Foo.Ops(f) 
```

虽然我不知道为什么这会产生任何影响，但它似乎足以让解释器忘记`any2stringadd`.

（不过，我认为应该打开一张新票以尝试删除该方法，同时考虑到 Scala 2.10 中的字符串插值会使它变得更加多余。）

# javascript - 使用 javascript 设置 CSS 动画延迟

> ID：13782407
> 
> 赞同：6
> 
> 时间：2012-12-08T22:03:33.900
> 
> 标签：javascript, css, animation

我的 css 文件中有一些关键帧动画。已经指定了动画延迟。包装器 div 具有属性 data-delay。

我想在 css 文件中获取动画延迟并将数据延迟的值添加到其中。然后我希望动画以新的延迟开始。

我试过了`ele[i].style.animationDelay`。但在我为其设置值之前，这似乎返回 null 。

如果我设置`ele[i].style.animationDelay = '5s'`动画仍然会随着css文件的延迟运行。

HTML

```
<div id="wrapper" data-delay="2s" >
    <h1 id="hi">Hi</h1>
    <h1 id="name">test!</h1>
</div> 
```

CSS

```
body { font-size: 300%; }

#wrapper h1 { position: absolute; }

#hi {
    transform: translate(-200px, 100px);

    animation-name: hi;
    animation-duration: .5s;
    animation-timing-function: linear;
    animation-fill-mode: forwards;
    animation-delay: 0s;
}

#name {
    transform: translate(-200px, 150px);

    animation-name: name;
    animation-duration: .5s;
    animation-timing-function: linear;
    animation-fill-mode: forwards;
    animation-delay: 1s;
}

@keyframes hi{
    100% { transform: translate(50px, 100px) };
}

@keyframes name{
    100% { transform: translate(50px, 150px) };
} 
```

JS

```
var wrapper = document.getElementById('wrapper');
var ele = wrapper.children;
var delay = wrapper.getAttribute('data-delay');

for (var i=0;i<ele.length;i++) {

    alert(ele[i].style.animationDelay);
    ele[i].style.animationDelay = delay;
    alert(ele[i].style.animationDelay);
} 
```

[http://jsfiddle.net/FHuKN/4/](http://jsfiddle.net/FHuKN/4/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T03:17:16.723

我只在 Mac 10.8 Chrome 25、Safari 6.0 和 FF 18.0 上对此进行了测试。

听起来您想要做的主要事情是将`data-delay`值添加到应用于元素的任何现有动画延迟。

HTML - 未更改

```
<div id="wrapper" data-delay="5.1s" >
    <h1 id="hi">Hi</h1>
    <h1 id="name">test!</h1>
</div> 
```

CSS - 添加了供应商前缀和初始关键帧 (0%)。

```
body { font-size: 300%; }

#wrapper h1 { position: absolute; }

#hi { 
    -webkit-transform: translate(-200px, 100px);
    -webkit-animation-name: hi;
    -webkit-animation-duration: .5s;
    -webkit-animation-timing-function: linear;
    -webkit-animation-fill-mode: forwards;
    -webkit-animation-delay: 2.1s;

    -moz-transform: translate(-200px, 100px);
    -moz-animation-name: hi;
    -moz-animation-duration: .5s;
    -moz-animation-timing-function: linear;
    -moz-animation-fill-mode: forwards;
    -moz-animation-delay: 2.1s;

    transform: translate(-200px, 100px);
    animation-name: hi;
    animation-duration: .5s;
    animation-timing-function: linear;
    animation-fill-mode: forwards;
    animation-delay: 2.1s;
}

#name { 
    -webkit-transform: translate(-200px, 150px);
    -webkit-animation-name: name;
    -webkit-animation-duration: .5s;
    -webkit-animation-timing-function: linear;
    -webkit-animation-fill-mode: forwards;
    -webkit-animation-delay: 3.1s;

    -moz-transform: translate(-200px, 150px);
    -moz-animation-name: name;
    -moz-animation-duration: .5s;
    -moz-animation-timing-function: linear;
    -moz-animation-fill-mode: forwards;
    -moz-animation-delay: 3.1s;

    transform: translate(-200px, 150px);
    animation-name: name;
    animation-duration: .5s;
    animation-timing-function: linear;
    animation-fill-mode: forwards;
    animation-delay: 3.1s;
}

@-moz-keyframes hi{
    0% { -moz-transform: translate(-200px, 100px); }
    100% { -moz-transform: translate(50px, 100px); }
}
@-webkit-keyframes hi {
    0% { -webkit-transform: translate(-200px, 100px); }
    100% { -webkit-transform: translate(50px, 100px); }
}
@keyframes hi{
    0% { transform: translate(-200px, 100px); }
    100% { transform: translate(50px, 100px); }
}

@-moz-keyframes name {
    0% { -moz-transform: translate(-200px, 150px); }
    100% { -moz-transform: translate(50px, 150px); }
}
@-webkit-keyframes name {
    0% { -webkit-transform: translate(-200px, 150px); }
    100% { -webkit-transform: translate(50px, 150px); }
}
@keyframes name {
    0% { transform: translate(-200px, 150px); }
    100% { transform: translate(50px, 150px); }
} 
```

JAVASCRIPT

在元素上，`style`属性并不包含所有样式信息，因为它仅表示通过`style`属性直接在元素上设置的内容。[MDN](https://developer.mozilla.org/en-US/docs/DOM/element.style#Notes)

[window.getComputedStyle()](https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle)似乎工作得很好。

处理前缀属性有点笨拙，但它在我测试过的浏览器中工作。

```
(function(undefined) {

    var wrapper = document.getElementById('wrapper'),
        elms = wrapper.children,
        delay = wrapper.getAttribute('data-delay'),
        prop,
        styl,
        cur,
        i;

    delay = !delay ? 0 : Number(delay.replace(/[^\d\.]/g, ''));

    if (!elms.length) {
        return;
    }

    styl = window.getComputedStyle(elms[0]);

    if (styl.getPropertyValue('animation-delay')) {
        prop = 'animation-delay';

    } else if (styl.getPropertyValue('-webkit-animation-delay')) {
        prop = '-webkit-animation-delay';

    } else if (styl.getPropertyValue('-moz-animation-delay')) {
        prop = '-moz-animation-delay';

    } else {
        console.log('unable to find prop');
        return;
    }
    // console.log('prop', prop);

    for (i = 0; i < elms.length; i++) {
        styl = window.getComputedStyle(elms[i]);
        cur = styl.getPropertyValue(prop);
        cur = Number(cur.replace(/[^\d\.]/g, ''));
        elms[i].style.setProperty(prop, (cur + delay) + 's');

        console.log('delay: ' + cur + 's -> ' + (cur + delay) + 's')
    }

})(); 
```

[http://jsfiddle.net/FHuKN/11/](http://jsfiddle.net/FHuKN/11/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-25T03:48:19.147

旧版 Firefox（至少 16 版）、迁移到 Blink 之前的 Opera（<15 版）、IE 至少 10 版 - 如果我们只更改动画的一些属性，例如`(-prefix-)animation-delay`. 为了让他们这样做，我们必须应用一些depper技巧。

1.  首先是**移除并重新插入动画元素**。并且 - 为了 Webkit - 应用所有样式更改。

只需更改@tiffon 小提琴中的代码即可

```
elms[i].style.setProperty(prop, (cur + delay) + 's'); 
```

到

```
var newEl =  elms[i].cloneNode(true);
newEl.style.setProperty(prop, (cur + delay) + 's', '');
elms[i].parentNode.replaceChild(newEl,elms[i]); 
```

[http://jsfiddle.net/FHuKN/28/](http://jsfiddle.net/FHuKN/28/)

1.  删除动画附加到的属性值的类名，等待一点（`setTimeout`）-更好-触发回流（例如，`element.offsetWidth = element.offsetWidth;`），然后再次添加类名。

[http://jsfiddle.net/FHuKN/29/](http://jsfiddle.net/FHuKN/29/)

这个想法不是我的，所有的功劳都归功于[Chris Coyer](http://css-tricks.com/restart-css-animation/)

# python - 在 Python 中使用 s.recv() 时出现奇怪的错误

> ID：13782408
> 
> 赞同：5
> 
> 时间：2012-12-08T22:03:40.323
> 
> 标签：python, sockets, client-server

我正在制作一个需要从服务器接收连接哈希的程序。当我使用：

```
connhash = s.recv(1024) 
```

我收到此错误：

```
[Errno 10054] An existing connection was forcibly closed by the remote host 
```

这是我的错还是服务器的错？

这是导致 s.recv() 的一些代码

```
stringfmt = u'%(user)s;%(host)s:%(port)d'
string = stringfmt % data
structfmt = '!bh'
encoded = string.encode('utf-16BE')
packetbytes = struct.pack(structfmt, 2, len(encoded))+encoded
s.send(packetbytes)
connhash = s.recv(1024) 
```

我正在使用 Python v 2.7

编辑：这是为 Minecraft 准备的，你知道的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:45:02.113

听起来远程服务器不喜欢您的连接并切断您的连接。这可能意味着您犯了协议错误（即您发送的命令不正确），或者您可能没有成功登录，或者您的 IP 可能已被禁止，或许多其他类似的事情。

要调试它，您可以尝试使用 telnet 之类的东西来复制连接并查看错误发生的位置（如果没有，那么您的实现有问题；如果有，那么您对协议，或者您被阻止使用服务器）。

或者，使用像[Wireshark](http://www.wireshark.org/)这样的数据包捕获工具来查看正在发送和接收的数据包，并查看是否显示问题。

# algorithm - 有人可以通过代码描述一个使用迭代而不是递归进行回溯的实际示例吗？

> ID：13782410
> 
> 赞同：1
> 
> 时间：2012-12-08T22:04:11.550
> 
> 标签：algorithm, data-structures, recursion, tail-recursion

递归使回溯变得容易，因为它保证您不会再次走相同的路径。所以你的路径的所有分支只被访问一次。我正在尝试将回溯尾递归（带累加器）算法转换为迭代。**我听说将完美的尾**递归算法转换为迭代应该很容易。但我被困在回溯部分。

谁能通过代码提供一个示例，以便我和其他人可以想象回溯是如何完成的？**我认为这里不需要堆栈，**因为我有一个使用累加器的完美尾递归算法，但我在这里可能是错的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:02:18.043

如果函数实际上是递归的，那么转换如下（这是理解 TCO 的编译器将为您做的事情，所以您不必自己做）：

原来的：

```
function func(a1, a2, a3...)
   ... doesn't contain either return or call
   return val
   ...
   return func(x1, x2, x3...)
   ...
   ... etc. 
```

转换成：

```
function func(a1, a2, a3...)
   func:  // label for goto (yuk!)
     ...
     return val  // No change
     ...
     a1 = x1; a2 = x2; a3 = x3...; goto func;
     ...
     ... etc. 
```

为了使这种转换与相互协同递归的函数一起工作，您需要将它们组合成一个函数，每个函数都带有一个标签。和上面一样，简单`return`的语句没有改变，而是`return foo(...)`变成对参数变量的赋值，后面跟着`goto foo`.

当然，在组合函数时，可能需要重命名局部变量以避免冲突。而且你也将失去使用多个顶级函数的能力，除非你在顶部入口点，在任何标签之前添加类似`switch`语句（带s）的东西。`goto`（事实上​​，在允许的语言中`goto case foo`，您可以只使用大小写标签作为标签。）

使用`goto`当然是丑陋的。如果您使用的语言最好保证尾调用优化，或者如果失败，至少会做出合理的尝试并在失败时报告，那么绝对没有动机替换递归解决方案，（在我看来）几乎总是更具可读性。

在某些情况下，可以将`goto`and 标签替换为`while (1)`{ ... } `or other such loops, but that involves replacing the`goto `s with`continue`（或等效项）之类的东西，如果它们嵌套在其他循环中，这将不起作用。因此，您实际上可能会浪费大量时间来使丑陋的转换稍微不那么丑陋，但最终仍然无法获得像原始程序那样可读的程序。

我现在将停止宣传递归。:)

**已编辑**（我忍不住，抱歉）

这是 Lua 中的一个回溯 n-queens 解决方案（确实有 TCO），由一个尾递归求解器和一个尾递归验证器组成：

```
function solve(legal, n, first, ...)
  if first == nil                    -- Failure
    then return nil
  elseif first >= n                  -- Back-track
    then return solve(legal, n, ...)
  elseif not legal(first + 1, ...)   -- Continue search
    then return solve(legal, n, first + 1, ...)
  elseif n == 1 + select("#", ...)   -- Success
    then return first + 1, ...
  else                               -- Forward
    return solve(legal, n, 0, first + 1, ...)
  end
end

function queens_helper(dist, first, second, ...)
  if second == nil
    then return true
  elseif first == second or first - dist == second or first + dist == second
    then return false
  else
    return queens_helper(dist + 1, first, ...)
  end
end

function queens_legal(...) return queens_helper(1, ...) end

-- in case you want to try n-rooks, although the solution is trivial.    
function rooks_legal(first, second, ...)
  if second == nil then return true
  elseif first == second then return false
  else return rooks_legal(first, ...)
  end
end

function queens(n) return solve(queens_legal, n, 0) end 
```

# vb.net - vb.net 如果输入框更大

> ID：13782411
> 
> 赞同：-1
> 
> 时间：2012-12-08T22:04:30.957
> 
> 标签：vb.net, inputbox

我无法检查输入是否小于或大于 3 个字符。我应该使用 if 语句还是 while 循环？

以及输入框输入后如何将所有数据存储在列表框中：

```
For Num = 1 To CInt(nudPassengers.Value)
    Dim userName As String
    if userName < 3 then
    InputBox("Whats your name? " & Num)
    Dim infoForm As New frmBooking
    infoForm.lstItinerary.Items.Add(userName)
    end if
Next 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:25:56.167

少于 3 个字符

```
 If Username.Length < 3 Then

 End If 
```

*   [字符串操作](http://msdn.microsoft.com/en-us/library/aa903372%28v=vs.71%29.aspx)
*   [字符串](http://msdn.microsoft.com/en-us/library/hzcd8ze0%28v=vs.71%29.aspx)

# python - 'builtin_function_or_method' 对象没有属性 'tick'

> ID：13782412
> 
> 赞同：0
> 
> 时间：2012-12-08T22:04:56.077
> 
> 标签：python, python-3.x, pygame

我正在尝试使用 Pygame 的 Clock.tick，但它不存在。我很肯定 Pygame 有它用于 Python 3，即使我使用`dir(pygame.time.Clock)`，它仍然不存在。我不确定我是否做错了什么，或者 Pygame 在 Python 3 中没有它。

这是我的代码：

```
import pygame, random, sys
from pygame.locals import *

class Pong_Ball(object):
    def __init__(self, screen, screen_height, screen_width):
        self.screen = screen
        self.screen_height = screen_height
        self.screen_width = screen_width

    def update(self):
        #pong ball's properties
        self.ball_color = 191,191,191
        self.pos_x = 100
        self.pos_y = 100
        self.vel_x = 1
        self.vel_y = 1

        while True:
            for event in pygame.event.get():
                if event.type == QUIT:
                    sys.exit()

            #clear the screen
            self.screen.fill((0,50,100))

            #move the pong ball
            self.pos_x += self.vel_x
            self.pos_y += self.vel_y

            #keep the ball on the screen
            if self.pos_x > self.screen_width or self.pos_x < 0:
                self.vel_x = -self.vel_x
            if self.pos_y > self.screen_height or self.pos_y < 0:
                self.vel_y = -self.vel_y

            #draw the pong ball
            self.position = self.pos_x, self.pos_y
            pygame.draw.circle(self.screen, self.ball_color, self.position, 10)

            #update the display
            pygame.time.Clock.tick(60)
            pygame.display.update()

def main():
    pygame.init()
    screen = pygame.display.set_mode((800,600))
    ball = Pong_Ball(screen, 600, 800)
    ball.update()

main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T22:24:59.333

啊。[文档](http://www.pygame.org/docs/ref/time.html#pygame.time.Clock)虽然完全标准，但可能有点令人困惑。即使他们写`Clock.tick`了 ，也不意味着它是类的静态方法。你在一个实例上调用它：

```
>>> import pygame
>>> clock = pygame.time.Clock()
>>> clock
<Clock(fps=0.00)>
>>> clock.tick
<built-in method tick of Clock object at 0xb402b408>
>>> clock.tick()
14487
>>> clock.tick()
836 
```

要确认它的行为：

```
>>> import time
>>> for i in range(5):
...     print clock.tick()
...     time.sleep(0.17)
...     
22713
172
171
171
172 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T14:17:31.407

替换`pygame.time.Clock.tick(60)`为`pygame.time.Clock().tick(60)`.

# php - mysql_fetch_array 没有获取完整的数据？

> ID：13782413
> 
> 赞同：0
> 
> 时间：2012-12-08T22:04:55.933
> 
> 标签：php, mysql

我有一个从 mysql 表中获取数据并将其转换为 pdf 文档的代码，该代码工作正常，只是它跳过了第 1 行。

这是我从中删除 pdf 生成过程的代码，因为问题出在获取数据的循环中。

请帮忙。

```
<?php
    session_start();
if(isset($_SESSION['user']))
{
    $cr = $_POST['cour'];
    $s = $_POST['sem'];
    require('fpdf.php');
    include('../includes/connection.php');
    $sql = "SELECT * FROM `student` WHERE AppliedCourse ='$cr'";
    $rs = mysql_query($sql) or die($sql. "<br/>".mysql_error());
    if(!mysql_fetch_array($rs))
    {
        $_SESSION['db_error'] = "<h2><font color = 'RED'>No such course found! Pease select again.</font></h2>";
        header('Location: prinrepo.php');
    }
    else {

    for($i = 0;$i <= $row = mysql_fetch_array($rs);$i++)
     {
            $formno[$i] = $row ['FormNo']; 
            $rno[$i] = $row ['rollno'];
            $snm[$i] = $row ['StudentNm'];          
            $fnm[$i] = $row ['FathersNm'];
            $mnm[$i] = $row ['MothersNm'];
            $addr[$i] = $row['Address'];
            $pic[$i] = $row['imagenm'];
            $comm[$i] = $row['SocialCat'];

        echo $formno[$i]."<br />";
        echo $rno[$i]."<br />";
        echo $snm[$i]."<br />";
        echo $fnm[$i]."<br />";
        echo $mnm[$i]."<br />";
        echo $addr[$i]."<br />";
        echo $pic[$i]."<br />";
        echo $comm[$i]."<br />";
        echo "<br />";
    }
    }
    mysql_close($con);
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:06:58.437

您正在获取 for() 循环之外的第一行，然后您错过了它。

在`mysql_query()`您应该使用`mysql_num_rows()`检查结果中是否有任何行之后，然后在 for 循环中获取它们。

更多信息在这里： http: [//php.net/manual/fr/function.mysql-num-rows.php](http://php.net/manual/fr/function.mysql-num-rows.php)

您的代码如下所示：

```
$sql = "SELECT * FROM `student` WHERE AppliedCourse ='$cr'";
$rs = mysql_query($sql) or die($sql. "<br/>".mysql_error());
if(0 == mysql_num_rows($rs)) {
    $_SESSION['db_error'] = "<h2><font color = 'RED'>No such course found! Pease select again.</font></h2>";
    header('Location: prinrepo.php');
} else {
    for($i = 0;$i <= $row = mysql_fetch_array($rs);$i++)
     {
        // Your code
    }
} 
```

# jquery - 如何获取表格行的右上角（x，y）坐标

> ID：13782419
> 
> 赞同：2
> 
> 时间：2012-12-08T22:05:32.270
> 
> 标签：jquery

表格行示例：

```
<tr class="row"><td>Blah</td><td>Blah 2</td></tr> 
```

如何从这里出发：

```
$('row').click(function(){

}); 
```

因此，当单击该行的一个 td 单元格时，如果给我该行右上角的 (x,y) 坐标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T22:07:23.953

您可能正在寻找[offset()](http://api.jquery.com/offset/)或[position()](http://api.jquery.com/position/)，具体取决于距离应该是相对的：

```
$('row').click(function(){
    $(this).offset(); //returns an object with top and left values relative to the document
    //or
    $(this).position(); //returns an object with top and left values relative to the parent
}); 
```

通常像这样使用（两种方法相同）：

```
 $('row').click(function(){
     var left = $(this).offset().left + $(this).width(),
          top = $(this).offset().top;
}); 
```

# sql - 如何使用查询在sql中选择整行

> ID：13782420
> 
> 赞同：-3
> 
> 时间：2012-12-08T22:05:32.910
> 
> 标签：sql

我有一个表名`FooTable`，其中有 n 列，但我想使用查询搜索特定的整个列。我怎样才能做到这一点？

例如：

```
 field1 field2 field3 .................... fieldn
    hey    hi     whats
    hello  bye     go 
     ..     ..     ..
     ..     ..     ..
     n      n       n
  Select *from FooTable 
```

我想搜索整个第 3 列项目，那么我应该如何进行查询以显示所有第 3 列项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T22:08:47.913

问题不是很清楚。你可能是这个意思

```
SELECT * FROM FooTable 
```

得到所有

```
SELECT field1, field2, field3 FROM FooTable 
```

获取那些列

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:10:26.950

您必须在该行中提供具有特定值的附加 WHERE 子句

示例 SELECT * FROM table WHERE field1 = "Hello";

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:18:00.290

你必须定义一个变量

```
select @var += field3 from footable 
```

# android - Android（java）套接字重新连接

> ID：13782423
> 
> 赞同：0
> 
> 时间：2012-12-08T22:06:14.657
> 
> 标签：android, sockets, connect

我对套接字重新连接有很大的问题。我有用 Delphi 编写的套接字服务器，但通信应用程序必须在 java (android) 中。问题是我的服务器停止了几分钟 - 例如重新启动或类似的东西。在这种情况下，java（android）客户端迷恋（因错误而停止）本身。我在远程服务中编写客户端，它在两个线程中工作。第一个用于连接或重新连接：

```
thrd1 = new Thread(new Runnable() {
    public void run() {
        while (!Thread.interrupted()) {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e1) {
            }
            if (sock==null)
            try {
                sock = new Socket("address", 5000);
                r = new BufferedReader(new InputStreamReader(sock.getInputStream()));
                out = new BufferedWriter(new OutputStreamWriter(sock.getOutputStream()));
            } catch (UnknownHostException e) {
            } catch (IOException e) {
        }
    } 
```

第二个是定期向服务器发送数据：

```
 thrd2 = new Thread(new Runnable() {
                public void run() {
                    while (!Thread.interrupted()) {
                        try {
                            if (sock != null) {
                                out.write("TEST DATA\n");
                                out.flush();
                                try {
                                    Thread.sleep(1000);
                                } catch (InterruptedException e) {

                                    e.printStackTrace();
                                }
                            } 

                        } catch (IOException e) {
                            sock = null;
                            out = null;
                            r = null;
                            try {
                                Thread.sleep(1000);
                            } catch (InterruptedException e1) {
                            }
                        }
                    }
                }
            }); 
```

为什么我的应用程序在失去连接后确实死了？服务器长时间不工作后如何正确重新连接（换句话说：如何等待启动服务器并在启动后立即连接。

感谢 Lois，我改进了我的代码，现在它看起来像：

```
thrd2 = new Thread(new Runnable() {
public void run() {
while (!Thread.interrupted()) {
    try {
        if (sock != null) {
            out.write("TEST DATA\n");
            out.flush();
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        } 
        //if sock is null wait 300ms
        else {
            try {
                Thread.sleep(300);
            } catch (InterruptedException e) {
                 e.printStackTrace();
            }
        }
    } catch (IOException e) {
        try {
            sock=null;
            Thread.sleep(1000);
        } catch (InterruptedException e1) {
             e.printStackTrace();
        }
    }
}
} 
```

和

```
thrd1 = new Thread(new Runnable() {
public void run() {
while (!Thread.interrupted()) {
    try {
        Thread.sleep(100);
    } catch (InterruptedException e1) {

    }
    if (sock==null)
    try {
        sock = new Socket();
        sock.connect(new InetSocketAddress(
                address, 5000), 300);
        r = new BufferedReader(new InputStreamReader(
                sock.getInputStream()));
        out = new BufferedWriter(
                new OutputStreamWriter(sock
                        .getOutputStream()));
        if ((thrd2!=null)&&(!thrd2.isAlive()))
        thrd2.start();
    } catch (UnknownHostException e) {
         e.printStackTrace();

    } catch (IOException e) {
         e.printStackTrace();
    }
}
;
}
});
if ((thrd1!=null)&&(!thrd1.isAlive())) thrd1.start(); 
```

应用程序没有崩溃，但我得到了奇怪的通信过程。服务器为我提供信息，服务器唤醒时两次或更多（取决于断开服务器的时间）尝试从套接字客户端启动（初始化）连接？我认为这是不正确的 - 在服务器唤醒之后开始连接必须只有一次尝试（如果它成功）？顺便说一句：从这个线程我知道每个catch都必须有实现——我的意思是当子句“try”在异常之后去那里时要执行一些代码（不是空代码）。但是当我只想保护我的应用程序免受错误但对这种情况的反应不需要我的代码中的任何特殊反应时，我必须放在那里？

下面的一些日志描述了这种情况（对不起，我在第一篇帖子中忘记了这个线程主要活动是 com.example.aj.siec：

```
12-09 10:09:29.750: W/System.err(1799): java.net.SocketTimeoutException: Connection timed out
12-09 10:09:29.750: W/System.err(1799):     at org.apache.harmony.luni.platform.OSNetworkSystem.connect(Native Method)
12-09 10:09:29.750: W/System.err(1799):     at dalvik.system.BlockGuard$WrappedNetworkSystem.connect(BlockGuard.java:357)
12-09 10:09:29.750: W/System.err(1799):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:204)
12-09 10:09:29.750: W/System.err(1799):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:437)
12-09 10:09:29.750: W/System.err(1799):     at java.net.Socket.connect(Socket.java:983)
12-09 10:09:29.750: W/System.err(1799):     at com.example.aj.siec.MainActivity$1$2.run(MainActivity.java:117)
12-09 10:09:29.750: W/System.err(1799):     at java.lang.Thread.run(Thread.java:1019)
12-09 10:09:30.830: W/System.err(1799): java.net.SocketTimeoutException: Connection timed out
12-09 10:09:30.830: W/System.err(1799):     at org.apache.harmony.luni.platform.OSNetworkSystem.connect(Native Method)
12-09 10:09:30.830: W/System.err(1799):     at dalvik.system.BlockGuard$WrappedNetworkSystem.connect(BlockGuard.java:357)
12-09 10:09:30.830: W/System.err(1799):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:204)
12-09 10:09:30.830: W/System.err(1799):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:437)
12-09 10:09:30.830: W/System.err(1799):     at java.net.Socket.connect(Socket.java:983)
12-09 10:09:30.830: W/System.err(1799):     at com.example.aj.siec.MainActivity$1$2.run(MainActivity.java:117)
12-09 10:09:30.830: W/System.err(1799):     at java.lang.Thread.run(Thread.java:1019)
12-09 10:09:31.800: W/System.err(1799): java.net.SocketTimeoutException: Connection timed out
12-09 10:09:31.800: W/System.err(1799):     at org.apache.harmony.luni.platform.OSNetworkSystem.connect(Native Method)
12-09 10:09:31.800: W/System.err(1799):     at dalvik.system.BlockGuard$WrappedNetworkSystem.connect(BlockGuard.java:357)
12-09 10:09:31.800: W/System.err(1799):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:204)
12-09 10:09:31.800: W/System.err(1799):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:437)
12-09 10:09:31.800: W/System.err(1799):     at java.net.Socket.connect(Socket.java:983)
12-09 10:09:31.800: W/System.err(1799):     at com.example.aj.siec.MainActivity$1$2.run(MainActivity.java:117)
12-09 10:09:31.800: W/System.err(1799):     at java.lang.Thread.run(Thread.java:1019) 
```

谢谢您的回答 - 解决这个问题对我来说真的很重要！

问候

阿尔蒂克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:45:59.460

您没有显示堆栈跟踪，因此我将指出上面代码中的一些直接错误：

*   您没有处理连接丢失并将套接字重置为空，因此不会尝试重新连接
*   您应该只`thrd2`在成功连接后开始`thrd1`
*   `thrd2`当 socket 为 null 时，不要点击，`sleep()`并且会持续循环消耗 100% 的 CPU 时间。

问候。

# java - 是什么导致我的空指针异常

> ID：13782424
> 
> 赞同：1
> 
> 时间：2012-12-08T22:06:15.380
> 
> 标签：java, nullpointerexception

我知道这里有很多关于 Java 中的空指针异常的线程，但我仍然无法弄清楚这里发生了什么

我正在尝试为传递依赖项 Kata 18 提出一个解决方案，该解决方案发布在[http://codekata.pragprog.com/2007/01/kata_eighteen_t.html](http://codekata.pragprog.com/2007/01/kata_eighteen_t.html)

add_direct 方法应该将一个字符和一个由空格分隔的单个空格分隔的字符组成一个数组列表。然后我尝试插入 ArrayLists 的 HashMap，其中初始 char 是键，我解析的 ArrayList 是项目。这是我的 NullPointerException 发生的地方。我已经跟踪了所有这些数据结构，它们都没有 Null 值。我不明白是什么导致了我的异常。请看我的代码：

```
public class Test_Dependencies 
{
    public static void main(String[] args) {
             Dependencies Dep = new Dependencies();
             Dep.add_direct('A', "B C");
    }
}

public class Dependencies {
      HashMap dependenciesList;

public Dependencies()
{
    HashMap<Character, ArrayList> dependenciesList = new HashMap<Character, ArrayList>();
}

public void add_direct(char mainItem, String dependentItems)
{
    String[] individualItems = dependentItems.split("\\s+");
    ArrayList<Character> dependendentItemsArray;
    dependendentItemsArray = new ArrayList<Character>();

    //put all items into the ArrayList
    for(int i = 0; i < individualItems.length; i++)
    {
        Character c = new Character(individualItems[i].charAt(0));
        dependendentItemsArray.add(c);

    }

    // insert dependency
    Character key = new Character(mainItem);

    ***//NULL POINTER EXCEPTION HERE
    dependenciesList.put(key, dependendentItemsArray);***

}
} 
```

我有点困惑，因为 dependenciesList、key 或dependentItemsArray 不为空

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T22:10:14.130

当您`HashMap<Character, ArrayList> dependenciesList`在构造函数中指定时，该映射与类字段*dependenciesList***不同。**去掉前面的类型标识符。当您在方法中引用时，那是未初始化的类字段。*`dependenciesList``add_direct`*

 *您可能想重新了解 Java 中的块作用域是如何工作的。在块内声明一个新变量，例如与更高范围内的变量同名的构造函数，会*隐藏*现有声明。

您将来可能还希望遵循 Java 样式约定，以帮助其他必须阅读您的代码的人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T22:10:26.687

实际上，`dependenciesList` *是*空的。您在构造函数中初始化的变量：

```
HashMap<Character, ArrayList> dependenciesList = new HashMap<Character, ArrayList>(); 
```

只是设置一个局部变量，该变量在函数结束时被释放。移除前导类型 ( `HashMap<Character, ArrayList>`) 以使其初始化实例变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T22:10:59.623

您尚未初始化您的依赖项列表。

进行以下更改

```
public class Dependencies {
  HashMap<Character, ArrayList>  dependenciesList;

 public Dependencies()
 {
 dependenciesList = new HashMap<Character, ArrayList>();
 }
 ....
 } 
```

您在构造函数中创建了一个新的 HashMap，但您的类变量`dependenciesList`为空

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-09-07T07:32:37.873

您未能初始化您的依赖项列表。请进行空值检查，然后将任何值设置为最佳实践。

```
package com.stackoverflow.examples;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

public class Dependencies {
    public void add_direct(char mainItem, String dependentItems) {
    String[] individualItems = dependentItems.split("\\s+");
    HashMap<Character, ArrayList<Character>> dependenciesList = new HashMap<Character, ArrayList<Character>>();
    ArrayList<Character> dependendentItemsArray = new ArrayList<Character>();

    // Put all items into the ArrayList
    for (int i = 0; i < individualItems.length; i++) {
        Character c = new Character(individualItems[i].charAt(0));
        dependendentItemsArray.add(c);
    }

    // Insert dependency
    Character key = new Character(mainItem);

    // Always check null before put
    if (dependenciesList != null)
        dependenciesList.put(key, dependendentItemsArray);
    System.out.println("dependenciesArray---->" + dependendentItemsArray);
    System.out.println("dependenciesList---->" + dependenciesList);

  }
} 
```

输出：

```
dependenciesArray---->[B, C]
dependenciesList---->{A=[B, C]} 
```*

# java - 不知道为什么没有显示图像

> ID：13782425
> 
> 赞同：1
> 
> 时间：2012-12-08T22:06:48.983
> 
> 标签：java, image, import

所以我导入了一张图片作为背景，出于某种原因它给了我：

```
 Uncaught error fetching image:
 java.lang.NullPointerException
at sun.awt.image.URLImageSource.getConnection(Unknown Source)
at sun.awt.image.URLImageSource.getDecoder(Unknown Source)
at sun.awt.image.InputStreamImageSource.doFetch(Unknown Source)
at sun.awt.image.ImageFetcher.fetchloop(Unknown Source)
at sun.awt.image.ImageFetcher.run(Unknown Source) 
```

有人可以帮助我吗？

```
 import javax.swing.*;
 import java.awt.*;
 import java.awt.event.*;
 import java.io.*;
 public class PixelLegendsMain extends JFrame implements ActionListener{
   public void actionPerformed(ActionEvent e){
   }
   public static void main(String[ ] args)throws Exception{
     PixelLegendsMain plMain = new PixelLegendsMain();
     arenaBuild arena = new arenaBuild();
     plMain.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

     plMain.add(arena);
     plMain.setSize(600,460);;
     plMain.setVisible(true);
     plMain.setResizable(false);
     plMain.setLocation(200, 200);
   }
 } 
```

这是主要课程，这是：

```
 import javax.swing.*;
 import java.awt.*;
 import java.awt.event.*;
 import java.awt.Font;
 import java.awt.Graphics;
 import java.net.URL;
 import java.io.*;
 import javax.swing.Timer;

 public class arenaBuild extends JPanel{
   String picPath = "pictures/";
   String[] fileName = {picPath+"stageBridge.png", picPath+"turret.png"};
   ClassLoader cl = arenaBuild.class.getClassLoader();
   URL imgURL[] = new URL[2]; 
   Toolkit tk = Toolkit.getDefaultToolkit();
   Image imgBG;
   public arenaBuild()throws Exception{
     for (int x=0;x<2;x++){
       imgURL[x]= cl.getResource(picPath+fileName[x]);
     }
     imgBG = tk.createImage(imgURL[0]);
   }
   public void paintComponent(Graphics g){
     g.drawImage(imgBG,0,0,600,460,0,0,600,460, this);
   }
 } 
```

Thjis 是我调用图像的地方。我是新手，所以如果有人能解释为什么会发生这种情况并帮助我修复它，我将不胜感激：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:05:54.510

最可能的解释是您的`tk.createImage(imgURL[0])`调用传递了一个`null`URL。

这怎么可能发生？好吧，如果找不到资源，该`ClassLoader.getResource(String)`方法被[指定](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#getResource%28java.lang.String%29)为返回......所以问题似乎是您为第一个资源使用了错误的路径。`null`

您使用的路径似乎是这样的`"pictures/pictures/stageBridge.png"`：：

*   您似乎不太可能将图像真正放在名为`"pictures/pictures"`.

*   `ClassLoader`由于您是在对象（而不是对象）上调用该方法`Class`，因此您使用的名义上的相对路径将被视为绝对路径；即你会得到“/pictures/...”而不是“/PixelLegendsMain/pictures/...”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T02:11:01.710

似乎我不幸地没有看我自己的代码足够长的时间，似乎我调用了两次 picPath 所以而不是路径

```
 "pictures/stageBridge.png" 
```

它是

```
 "pictures/pictures/stageBridge.png" 
```

很抱歉浪费时间，谢谢大家的回答

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:17:14.607

尝试打印当前工作目录，以检查您的图像路径是否正确。

这是一种简单的方法：

```
System.out.println(new File(".").getAbsolutePath()); 
```

也许问题在于图像不是文件的正确路径`pictures/tageBridge.png`。`pictures/turret.png`

希望能帮助到你！

# css - 如何在对角线元素上创建 CSS 边框

> ID：13782432
> 
> 赞同：4
> 
> 时间：2012-12-08T22:07:27.127
> 
> 标签：css, mobile, responsive-design

这是一个例子。[http://jsfiddle.net/52c7t/](http://jsfiddle.net/52c7t/)

**简单地说：**我试图让 div 在右侧，在左侧有一个像 div 一样的边框。（我希望边框位于右侧 div 的左侧）

我尝试了一百万种不同的组合，但都无法做到。我试图避免制作图像并使用 css 执行此操作。

谢谢你的帮助！

**更新：**

我的意思的图像。对不起我的平面设计技巧：P

[http://i.imgur.com/pGSnL.png](http://i.imgur.com/pGSnL.png)

**HTML**

```
<div id = "top_bar">
        <div  id="top_left_button" >border</div>
        <div  class = "trapezoid"> none </div>
</div>​ 
```

**CSS**

```
.trapezoid{
    vertical-align: middle;
    position:absolute;
    border-bottom: 60px solid blue;
    border-left: 45px solid transparent;
    border-top-left-radius:30px;
    *border-top-right-radius:15px;
    *border-bottom-right-radius:3px;
    height: 0;
    width: 50px;
    display: inline-block;
    right:1px;
}

#top_bar{
    background-color: #000;
    border-bottom: 1px solid #666;
    color: #222;
    position:fixed;
    left:0px;
    top: 0px;
    width:100%;
    overflow:hidden;
    height: 50%;
    font-weight: normal;
    white-space: nowrap;
    color: white;
    z-index:20; 
    line-height: 45px;
    min-width:320px;
    max-width: 320px;
    max-height:48px;
    border-radius: 5px;
    text-shadow: rgba(0,0,0,0.6) 0px -1px 0px; 
}

#top_bar:after {
    content: '';
    width: 10%;
    display: inline-block;
    font-size: 0;
    line-height: 0
}

#top_title, #top_left_button, #notifications, #top_right_button {
    color: white;
    height: 100%;
    overflow:hidden;
    display: inline-block;
    text-align: center;
    vertical-align: middle;
}
#top_left_button,#top_right_button{
    width: 20%;
    background: rgba( 100, 255, 255, .1 );
}

#top_left_button{
    border-right: 2px solid #666;

}​ 
```

**编辑：**更新链接

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T23:59:09.983

简单的解决方案是创建另一个 div，因为您的蓝色 div 已经使用边框属性组成。

那个新的 div 本质上是蓝色 div 的克隆，但是会被染成红色并使用 CSS 的 width 属性变得更大一些。这成为蓝色 div 的伪边框。

新 div 示例：

```
.trapezoid-border{
    vertical-align: middle;
    position:absolute;
    border-bottom: 60px solid red;        /* Color Changed will be pseudo-border color */
    border-left: 45px solid transparent;
    border-top-left-radius:30px;
    *border-top-right-radius:15px;
    *border-bottom-right-radius:3px;
    height: 0;
    width: 53px;                       /* Extra 3 pix when compared to .trapezoid class width */
    display: inline-block;
    right:1px;
} 
```

[**jsFiddle 演示**](http://jsfiddle.net/52c7t/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:05:04.970

坦率地说，我认为你应该为此使用图像，但如果你真的想要或不得不避免这种情况，一个有点脏（虽然我认为看起来很有说服力）的解决方法是创建一个固定大小的 red `<div>`，你可以定位和旋转（利用`transform`属性）恰到好处地达到相应的效果。

```
.redborder {
    background-color:red; 
    width:3px;
    height:70px;
    transform:rotate(37deg);
    -ms-transform:rotate(37deg);
    -moz-transform:rotate(37deg);
    -webkit-transform:rotate(37deg);
    -o-transform:rotate(37deg);
    position:absolute;
    right:70px;
    top:-10px;
} 
```

关于 jsfiddle：http: [//jsfiddle.net/QBTpV/18/](http://jsfiddle.net/QBTpV/18/)

（在 Chrome 和 IE 中测试）

# xaml - 通过按下按钮 XAML C++/CX 从 ItemsControl 中删除元素

> ID：13782433
> 
> 赞同：0
> 
> 时间：2012-12-08T22:07:28.683
> 
> 标签：xaml, windows-8, microsoft-metro, itemscontrol, c++-cx

我试图在不使用 Window.CommandBinding 的情况下从以下 ItemsControl 中删除一个元素。有没有更简单的方法来做到这一点？

XAML：

```
 <ItemsControl ItemsSource="{Binding Path=MyStringArray}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="Abcd"/>
                        <Button Content="-" Click="Button_Click_1"/>
                    </StackPanel>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl> 
```

如果没有更简单的方法，如何使用 Window.CommandBindings 来完成

另外，在这段代码中，如何使第一个按钮的宽度取屏幕的整个宽度减去第二个按钮的宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:26:06.177

使用项目模板上的按钮删除项目控件中的项目的最简单方法是使用命令绑定，命令参数绑定到当前项目。然后，您从支持集合中删除当前项目。

要实现您正在寻找的按钮间距，请使用网格进行布局。创建两个`GridColumns`. 给第一个宽度，`*`第二个宽度`Auto`。假设您有`ItemsControl`正确的设置间距，这将实现您寻找的间距。

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
    </Grid.ColumnDefinitions>

    <Button Grid.Column="0" Content="Abcd"/>
    <Button Grid.Column="1" Content="-" Command="{Binding YourCommand}" CommandParamter={Binding}/>
</Grid> 
```

有关更完整的命令绑定示例，请参见[此处](http://msdn.microsoft.com/en-us/library/system.windows.input.commandbinding.aspx)，有关命令绑定的便利类，请参见[此处。](https://stackoverflow.com/questions/12486659/relay-command-in-windows-8-windows-store-app)

# xml - 如何使用 Scrapy 解析 xml 文件中的 html 项嵌入项

> ID：13782434
> 
> 赞同：2
> 
> 时间：2012-12-08T22:08:15.047
> 
> 标签：xml, scrapy

我正在尝试使用 XMLFeedSpider 解析 xml 提要

在 XML 提要中，我想提取“价格”项目：

```
<span class="price" id="product-price-2037">19,77 €&lt;/span> 
```

但是这个价格项目在标签内的 html 代码中，如下所示：

```
<channel>
<item>
<title>
<![CDATA[ product title ]]>
</title>
<meta http-equiv="X-UA-Compatible" content="IE=8"/>
<link>http://example.com/apage.html</link>
<description>
<![CDATA[
<table><tr><td><a href="http://example.com/apage.html">
<img src="http://example.com/media/catalog/product/aimage173.jpg" border="0" align="left" height="75" width="75"></a></td>
<td style="text-decoration:none;"> <div class="price-bframe"> <p class="old-price"> <span class="price-label">Prix normal :</span>
<span class="price" id="old-price-2895037">40,00 €&lt;/span> </p>
<p class="special-price"> <span class="price-label">Prix spécial :</span>
<span class="price" id="product-price-2037">19,77 €&lt;/span> </p> </div> </td></tr></table>
]]>
</description>
</item>
</channel> 
```

这是我的实际蜘蛛：

```
from scrapy.contrib.spiders import XMLFeedSpider
from scrapy.selector import XmlXPathSelector
from tutorial.items import DmozItem

class DmozSpider(XMLFeedSpider):
name = 'myspidername'
allowed_domains = ["example.com"]
start_urls = ['http://example.com/rss/catalog/new/store_id/1/']
iterator = 'iternodes'
itertag = 'channel'

def parse_node(self, response, node):
    title = node.select('item/title/text()').extract()
    link = node.select('item/link/text()').extract()
    price = node.select('*[@class=price"]text()').extract()
    item = DmozItem()
    item['title'] = title
    item['link'] = link
    item['price'] = price
    return item 
```

结果 ：

```
Invalid Xpath: *[@class=price"]text() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T05:40:29.670

I think that is because your path is invalid try this

`[@class=price"]/text()`

I think you missed the slash before the text

# emacs - etags 自动生成

> ID：13782435
> 
> 赞同：1
> 
> 时间：2012-12-08T22:08:33.970
> 
> 标签：emacs, elisp, etag

stackoverflow 上有一些人有这样的问题，但不完全是这个，也不完全是我正在寻找的解决方案。如果标签文件不存在（通过 emacs），问题是由 etags 自动生成标签文件。我想记录所有文件，它不限于 c 或其他任何文件，并通过 emacs 自动加载。我对在加载标签文件中扮演任何角色不感兴趣。

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T01:48:05.377

对我来说，我将以下行放在我的`makefile`文件中：

```
tags:
    find -type f -name "*.[ch]" -print0 | xargs -0 etags -o TAGS -a -l c 
```

`M-!`我用compile刷新标签，然后`make tags`.

Emacs 自动检测到 TAGS 文件已刷新，并询问您是否需要重新加载它。

否则，您可以键入`M-x`tags-reset-tags-table，当您使用 搜索某些内容时`M-.`，Emacs 会自动加载新生成的文件。

# jquery - 带有表格的jquery选择表单

> ID：13782442
> 
> 赞同：0
> 
> 时间：2012-12-08T22:09:05.877
> 
> 标签：jquery, html, jquery-ui

我在表格行的每个条目中都保留了一个单选按钮。我希望用户选择一行，该行应在提交时发送到服务器。

所以，当我在单选按钮中有行时，我的期望是在给定时间只能选择一个列，但我可以选择所有单选按钮。如何选择该行并将该行信息作为提交的一部分发送。

```
<form id="myform1" action="/data" method="post" >     

<table>
 <tr>     

       <td >  <input type="text" id="slno1" size="25" value="10" /> </td>     
       <td >  <input type="text" id="data" size="10" value="this is a test" /> </td>      
       <td >  <input type="radio"  value="" id="editable" /> </td>    
  </tr>
   <tr>     

       <td >  <input type="text" id="slno2" size="25" value="10" /> </td>     
       <td >  <input type="text" id="data1" size="10" value="this is a test1" /> </td>    
       <td >  <input type="radio" value="" id="editable" /> </td>     
  </tr>
  </table>
  <input type="submit" id="mysu1" Value="submits" />  

 </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:11:53.477

为了能够在多个单选按钮中仅选择一个，您需要使它们具有相同的名称。而且您还应该检查您的代码，因为您为每个单选按钮提供了两个不同的 id 属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:28:25.750

好的..首先，您需要为所有输入提供名称名称...可以说行标识符...

现在就 jquery 而言，您将执行以下操作：

```
//First we select the form and listen to the submit event
$("#myform1").submit(function(event) {
    //we get which radio button was selected
    var theForm = $(this);
    var theSelectedRadioButton = theForm.find('input[name="row-identifier"]:checked');

    //from here we can get the entire row that this radio button belongs to
    var theSelectedRow = theSelectedRadioButton.parents("tr:first").get(0).outerHTML;

    //now theSelectedRow should have the row html you want... you can send it to the server using an ajax request and voiding this default action of the form "which is redirect to the action page
    $.post("YOUR_SERVER_URL", {
        rowHTML: theSelectedRow
    });
    event.preventDefault();
    return false;
});​ 
```

有关 jquery post 方法的更多信息：http: [//api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

有关 jquery 表单提交事件的更多信息：http: [//api.jquery.com/submit/](http://api.jquery.com/submit/)

希望这有帮助:)

# eclipse-plugin - 配置命令参数后 Eclipse RCP 3.7 菜单消失

> ID：13782445
> 
> 赞同：0
> 
> 时间：2012-12-08T22:09:54.157
> 
> 标签：eclipse-plugin, eclipse-rcp, commandparameter

我有一个命令来启动在 RCP 应用程序模块的 plugin.xml 中配置的视图，如下所示：

```
<extension 
     point="org.eclipse.ui.commands">
      <command
            defaultHandler="myapp.commandhandler.LaunchView"
            id="myapp.command.launchview"
            name="Map">
      </command>
   </extension> 
```

我已将此命令配置为在几个菜单扩展之间共享，如下所示：

```
 <menuContribution
            allPopups="false"
            locationURI="menu:org.eclipse.ui.main.menu">
         <menu
               id="myapp.application.menu.showview"
               label="Show View">
            <command
                  commandId="myapp.command.launchview"
                  label="Map"
                  style="push">
            </command>
            <command
                  commandId="myapp.command.launchview"
                  label="Legend"
                  style="push">
            </command>           
         </menu>
 </menuContribution> 
```

现在我想传递一个表示每个视图 ID 的命令参数，类似于此处所做的[Eclipse RCP commands](http://www.vogella.com/articles/EclipseCommandsAdvanced/article.html)。

但是当我添加这些参数配置时，这些菜单项从主菜单中消失了。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T13:44:27.453

如果绑定的 commandId 或 commandParameter 不存在，菜单项将从菜单中消失。

# javascript - 在 jquery 中传递 & 符号

> ID：13782448
> 
> 赞同：0
> 
> 时间：2012-12-08T22:09:59.687
> 
> 标签：javascript, jquery

我正在尝试使用 jquery 插入电子邮件链接，但如果电子邮件正文中有一个`&`，它将不起作用。

```
$('#em_button').html('<a href="mailto:?subject=A Photo: ' + js_images[getImg].title + '&body=I thought you would like this photo: ' + thisPage + '?id=' + getGall + '&img=' + js_images[getImg].filename + '"><img src="' + homeUrl + '/' + tUrl + '/img/email.png" title="Email this photo" /></a>'); 
```

破坏它的部分是`&img=`。我试过使用`&amp;`，但也没有用。有什么建议么？

注意：如果没有`&`，一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:16:52.630

`?`我认为您的问题是您的查询字符串中有第二个。

您应该将第二个替换`?`为`&amp;`. 你`&`也应该写成`&amp;`

```
$('#em_button').html('<a href="mailto:?subject=A Photo: ' + js_images[getImg].title + '&amp;body=I thought you would like this photo: ' + thisPage + '&amp;id=' + getGall + '&amp;img=' + js_images[getImg].filename + '"><img src="' + homeUrl + '/' + tUrl + '/img/email.png" title="Email this photo" /></a>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:24:10.443

不知道里面有什么`js_images[getImg]`，很难说出了什么问题。

要记住的一件事是，您应该始终在创建 URL 之前对组件进行编码。例如：

```
var x = encodeURIComponent(js_images[getImg].title)
$('#em_button').html('<a href="mailto:?subject=A Photo: '+ x +'&body...') 
```

此外，如果您正在创建类似链接的内容，您可能希望通过如下方式编写它以使事情更清晰：

```
var url = 'mailto:subject=A Photo: ' + encodeURIComponent(js_images[getImg].title) +
    '&body=I thought you would like this photo: ' + encodeURIComponent(thisPage) +
    '&id=' + encodeURIComponent(getGall) +
    '&img=' + encodeURIComponent(js_images[getImg].filename);

var src = encodeURIComponent(homeUrl) + '/' +
    encodeURIComponent(tUrl) + '/img/email.png'

var $a = $('<a/>', {
    href: url
});

var $img = $('<img/>', {
    src: src,
    title: 'Email this photo'
});

$a.append($img);
$('#em_button').html($a);

$('#em_button').html('<a href="mailto:?subject=A Photo: ' + js_images[getImg].title + '&body=I thought you would like this photo: ' + thisPage + '?id=' + getGall + '&img=' + js_images[getImg].filename + '"><img src="' + homeUrl + '/' + tUrl + '/img/email.png" title="Email this photo" /></a>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:24:10.707

你可以试试这个，希望有用

```
'%26img=' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T22:24:41.707

采用`+encodeURIComponent('&')+`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-08T22:25:42.937

如果您只是将 URL 参数和正文文本附加到一个字符串中，则`&`正文文本中的 from 将被解析为 URL 参数。在 PHP 中，我会使用`urlencode`将此类字符的出现编码为`%xx`-values。

查看 Константин Рекунов 的答案，我认为您可以使用`encodeURIComponent`对正文内容进行编码。

```
encodeURIComponent( thisPage + '?id=' + getGall + '&img=' + js_images[getImg].filename ) 
```

请参阅：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent)

您可以通过在服务器上为图像文件使用 URL 重写来避免该问题。

代替：

```
thisPage + '?id=' + getGall + '&img=' + js_images[getImg].filename 
```

…有可能：

```
thisPage + '/' + getGall + '/img/' + js_images[getImg].filename 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-12T06:00:17.507

而不是使用“&”尝试使用`&amp;`

# java - java没有达到最大传输速度，通过udp传输

> ID：13782449
> 
> 赞同：0
> 
> 时间：2012-12-08T22:10:01.470
> 
> 标签：java, sockets, networking, udp

我已经使用 iperf 测试了两台计算机之间的速度，并在 1 Gbps 网络上获得了大约 255 Mbit/sec。

我的问题是，当我使用 java 以最大速度发送 UDP 数据包时，java 进程可以在上述测试的两台计算机之间，网络监视器几乎不会显示超过 40 Mbit/sec 的传输。

是什么限制了 java 在 1 Gbps 连接上以大约 250 Mbps 的速率发送 UDP 数据包？

我在两台计算机上都有 Windows 7。甲骨文的 JDK 1.7。

# python - 为什么这个字符串比较返回 False？

> ID：13782451
> 
> 赞同：5
> 
> 时间：2012-12-08T22:10:16.210
> 
> 标签：python, string

> **可能重复：**
> [Python 中的字符串比较：is vs. ==](https://stackoverflow.com/questions/2988017/string-comparison-in-python-is-vs)

```
algorithm = str(sys.argv[1])
print(algorithm)
print(algorithm is "first") 
```

我正在使用参数从命令行运行它`first`，那么为什么该代码输出：

```
first
False 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-08T22:21:15.400

从[Python 文档](http://docs.python.org/3/reference/expressions.html#is)：

> 运算符 is 和 is not 测试对象身份：当且仅当 x 和 y 是同一个对象时，x is y 为真。

这意味着它不检查值是否相同，而是检查它们是否在相同的内存位置。例如：

```
>>> s1 = 'hello everybody'
>>> s2 = 'hello everybody'
>>> s3 = s1 
```

注意不同的内存位置：

```
>>> id(s1)
174699248
>>> id(s2)
174699408 
```

但由于`s3`等于`s1`，内存位置是相同的：

```
>>> id(s3)
174699248 
```

使用`is`语句时：

```
>>> s1 is s2
False
>>> s3 is s1
True
>>> s3 is s2
False 
```

但是如果你使用相等运算符：

```
>>> s1 == s2
True
>>> s2 == s3
True
>>> s3 == s1
True 
```

**编辑：**只是为了混淆，有一个优化（无论如何在CPython中，我不确定它是否存在于其他实现中）它允许将短字符串与`is`：

```
>>> s4 = 'hello'
>>> s5 = 'hello'
>>> id(s4)
173899104
>>> id(s5)
173899104
>>> s4 is s5
True 
```

显然，这不是你想要依赖的东西。对工作使用适当的语句——`is`如果你想比较身份，`==`如果你想比较值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-08T22:11:04.563

你要：

```
algorithm = str(sys.argv[1])
print(algorithm)
print(algorithm == "first") 
```

`is`检查对象身份（想想内存地址）。但是在您的情况下，对象具有相同的“值”，但不是相同的对象。

注意`==`弱于`is`。这意味着如果`is`返回 True，那么`==`也将返回 True，但反过来并不总是正确的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-08T22:11:51.227

基本上，`is`检查对象的地址（身份），而不是值。对于值比较使用`==`运算符

# uwsgi - Uwsgi 服务器必须在脚本路径中执行，否则我会收到 http 500 响应

> ID：13782457
> 
> 赞同：0
> 
> 时间：2012-12-08T22:10:52.287
> 
> 标签：uwsgi

我不明白为什么我会收到 http 500 响应。当我从定义我的 python 脚本的路径运行我的 uwsgi 服务器时，一切都很完美。一旦我从另一条路径运行它，我就会得到 500 响应。

这是我的 uwsgi 脚本（我将协议设置为 http 仅出于测试目的）：

```
/home/baz/.virtualenvs/python-flask-benchmark/bin/uwsgi 
--master
--socket 127.0.0.1:3031 
--pythonpath "/home/baz/Personal/Github/benchmark-node_vs_python/python"
--file "/home/baz/Personal/Github/benchmark-node_vs_python/python/app.py" 
--callable app 
--processes 20 
--virtualenv "/home/baz/.virtualenvs/python-flask-benchmark" 
--enable-threads 
--protocol http 
```

有谁知道为什么？似乎它忽略了`--pythonpath`争论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:45:26.837

好的，想通了。这是一个路径错误，我的应用程序找不到要打开的文件。问题是这没有记录到 Uwsgi，它只是沉默。原因是因为这是一个烧瓶应用程序，需要指示它通过执行以下操作将所有异常错误传递给 uwsgi：`app.config['PROPAGATE_EXCEPTIONS'] = True`

# c# - 使用地理标签或上传媒体时 Twitterizer 失败

> ID：13782471
> 
> 赞同：0
> 
> 时间：2012-12-08T22:12:32.133
> 
> 标签：c#, .net, twitterizer

所以我注意到 Twitterizer 中的两个错误：
1\. 在 StatusUpdateOptions 中指定纬度、经度和地点 ID 时，经度被删除并保留其默认值 0，这实际上破坏了地理标记功能。
2\. 在通过 UpdateWithMedia() 上传图像时使用地理标签时，发送推文失败，并显示“无效坐标”作为错误消息。
我在 Twitterizer 自己的错误跟踪器上偶然发现了[这个错误报告](http://pm.twitterizer.net/issues/103)，但显然它被忽略了，因此没有得到修复。我尝试使用错误报告者建议的更改重新编译 Twitterizer，但这没有任何作用，我的推文仍然失败。
谁能帮我解决或修复这些错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T17:22:01.407

结果证明 MetroTwit Loop 是罪魁祸首，而不是 Twitterizer，顺便说一下，它运行良好。
我已经向 MetroTwit 的开发人员发送了一份错误报告。基本上，问题解决了。

# google-app-engine - GAE 数据存储结构

> ID：13782475
> 
> 赞同：1
> 
> 时间：2012-12-08T22:13:24.987
> 
> 标签：google-app-engine, database-design, optimization, google-cloud-datastore

我已经使用 Google App Engine 几个月了，最近我开始怀疑我在 Datastore 方面的一些做法。我有大约 10 个实体，每个实体有 10-12 个属性。一切都在我的应用程序中运行良好，代码非常简单，我的数据结构方式非常简单，但我想知道我是否应该将这些大实体分解为更小的实体，以优化读写或遵循最佳实践（我不确定GAE）

现在我已经超过了我的读写配额，并希望控制这些配额。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T17:27:06.127

优化读取：

*   如果您在查询中使用偏移量，则偏移量实体被计为读取。如果您运行偏移量 = 100 的查询，数据存储区将检索并丢弃前 100 个实体，并且您需要为这些读取付费。尽可能使用游标来减少读取操作。游标也会导致更快的查询。

*   当您运行查询时，NDB 不一定会减少读取。对数据存储进行查询并返回实体，不发生内存缓存交互。如果要在查询上下文中从 memcache 中检索实体，则需要运行 keys_only 查询，然后尝试从 memcache 中检索这些键。然后，您需要转到数据存储区以查找任何缓存未命中的实体。检索密钥是一个“小”操作，是读取操作成本的 1/7。

优化写入：

*   删除未使用的索引。默认情况下，实体上的每个属性都被索引，并且每个属性都会在第一次写入时产生 2 次写入，而在修改时会产生 4 次写入。您可以像这样禁用属性的索引：firstname = db.StringProperty(indexed=False)。

*   如果您使用列表属性，则列表中的每个项目都是实体上的单个属性。列表属性是为方便而提供的抽象。一个名为 things 且值为 ["thing1", "thing2"] 的列表属性实际上是数据存储中的两个属性：things_0="thing1" 和 things_1="things"。与索引结合使用时，这可能会变得非常昂贵。

*   合并您不需要查询的属性。如果您只需要查询一个或两个属性，请序列化其余属性并将其作为 blob 存储在实体上。

进一步阅读：

*   [https://developers.google.com/appengine/docs/billing#Billable_Resource_Unit_Costs](https://developers.google.com/appengine/docs/billing#Billable_Resource_Unit_Costs)
*   [https://developers.google.com/appengine/docs/python/datastore/entities#Understanding_Write_Costs](https://developers.google.com/appengine/docs/python/datastore/entities#Understanding_Write_Costs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T18:58:44.277

我建议考虑使用 NDB 实体。NDB 将在对数据存储执行读/写之前使用上下文缓存（如果需要，还可以使用 Memcache）。这应该可以帮助您保持在配额范围内。

在此处阅读有关 NDB 如何使用缓存的更多信息：[https ://developers.google.com/appengine/docs/python/ndb/cache](https://developers.google.com/appengine/docs/python/ndb/cache)

有关 GAE 最佳实践的讨论，请参阅此页面：[https ://developers.google.com/appengine/articles/scaling/overview](https://developers.google.com/appengine/articles/scaling/overview)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-10T19:08:38.153

AppEngine Datastore 对每次读取的实体收取固定金额，无论实体有多大（尽管最大为 1MB）。这意味着将您经常阅读的多个实体组合成一个实体是有意义的。缺点只是延迟增加（因为它每次都需要反序列化一个更大的实体）。我发现这个延迟非常低（即使是大的也只有 1 位数的毫秒）。

在 Datastore 之上使用框架是一个好主意。我正在使用 Objectify，我很高兴。不过要小心使用 Memcache 集成。Googles 只为每个应用程序提供固定的有限内存量，因此一旦您谈论更大的数据，这将无法解决您的问题（因为实体已从 Memcache 中逐出，需要从数据存储区重新读取并放入缓存中每次读取再次）。

# ios - UIWebView vs 主屏幕 vs 移动 Safari 应用程序

> ID：13782479
> 
> 赞同：2
> 
> 时间：2012-12-08T22:13:53.103
> 
> 标签：ios, html, uiwebview

我注意到 Home Full Screen Apps 的表现比 Mobile Safari 更差。我也想知道 UIWebView 与 Mobile Safari 是否有任何差异。我目前正在iOS6上进行测试。如果有人有任何其他想要提及的关于每个人的优缺点，我将不胜感激。

# c++ - 为什么 gcc 和 NVCC (g++) 会看到两种不同的结构大小？

> ID：13782480
> 
> 赞同：6
> 
> 时间：2012-12-08T22:13:55.673
> 
> 标签：c++, c, gcc, cuda, nvcc

我正在尝试将 CUDA 添加到 90 年代后期某个时候编写的现有单线程 C 程序中。

为此，我需要混合两种语言，C 和 C++（nvcc 是一个 c++ 编译器）。

问题是 C++ 编译器将结构视为特定大小，而 C 编译器将相同结构视为大小略有不同。那很糟。我对此感到非常困惑，因为我找不到导致 4 字节差异的原因。

```
/usr/lib/gcc/i586-suse-linux/4.3/../../../../i586-suse-linux/bin/ld: Warning: size of symbol `tree' changed from 324 in /tmp/ccvx8fpJ.o to 328 in gpu.o 
```

我的 C++ 看起来像

```
#include <stdio.h>
#include <stdlib.h>
#include "assert.h"
extern "C"
{
#include "structInfo.h" //contains the structure declaration
}
... 
```

我的 C 文件看起来像

```
#include "structInfo.h"
... 
```

structInfo.h 看起来像

```
struct TB {
   int  nbranch, nnode, root, branches[NBRANCH][2];
         double lnL;
}  tree;
... 
```

我的make文件看起来像

```
PRGS =  prog
CC = cc
CFLAGS=-std=gnu99 -m32
CuCC = nvcc
CuFlags =-arch=sm_20
LIBS = -lm -L/usr/local/cuda-5.0/lib -lcuda -lcudart
all : $(PRGS)
prog: 
        $(CC) $(CFLAGS) prog.c gpu.o $(LIBS) -o prog
gpu.o:
        $(CuCC) $(CuFlags) -c gpu.cu 
```

有人问我为什么不使用不同的主机编译选项。我认为主机编译选项自 2 版前已被弃用？而且[它似乎从来没有像它所说的那样做](https://devtalk.nvidia.com/default/topic/508479/cuda-programming-and-performance/nvcc-forces-c-compilation-of-cu-files/#entry1340190)。

```
nvcc warning : option 'host-compilation' has been deprecated and is ignored 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-09T01:50:12.453

GPU 要求所有数据自然对齐，例如 4 字节的 int 需要与 4 字节的边界对齐，而 8 字节的 double 或 long long 需要有 8 字节的对齐。CUDA 也对主机代码强制执行此操作，以确保代码的主机和设备部分之间的结构尽可能兼容。另一方面，x86 CPU 通常不要求数据自然对齐（尽管缺乏对齐可能会导致性能下降）。

在这种情况下，CUDA 需要将结构的 double 组件与 8 字节边界对齐。由于在 double 之前有奇数个 int 组件，因此这需要填充。切换组件的顺序，即将双组件放在首位，并没有帮助，因为在此类结构的数组中，每个结构都必须是 8 字节对齐的，因此结构的大小必须是 8 字节的倍数才能实现这一点，这也需要填充。

要强制 gcc 以与 CUDA 相同的方式对齐双精度，请传递 flag `-malign-double`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-08T22:24:23.093

似乎 2 个编译器应用了不同的填充：一个使用 4 字节对齐，另一个使用至少 8 字节对齐。您应该能够通过特定于编译器的`#pragma`指令强制您想要的对齐（检查您的编译器文档关于特定的`#pragma`）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-08T23:16:53.787

不能保证两个不同的 C 编译器会对同一类型使用相同的表示形式——除非它们都符合某个足够详细地指定表示形式的外部标准（ABI）。

这很可能是填充的差异，其中一个编译器要求 a`double`是 4 字节对齐的，而另一个要求它是 8 字节对齐的。就 C 和 C++ 标准而言，这两种选择都是完全有效的。

您可以通过打印出结构中所有成员的大小和偏移量来更详细地研究这一点：

```
printf("nbranch: size %3u offset %3u\n",
       (unsigned)sizeof tree.nbranch,
       (unsigned)offsetof(struct TB, nbranch));
/* and similarly for the other members */ 
```

*可能*有一种特定于编译器的方式来指定不同的对齐方式，但这种技术[并不总是安全](https://stackoverflow.com/q/8568432/827263)的。

理想的解决方案是对 C 和 C++ 代码使用相同的编译器。C 不是 C++ 的子集，但修改现有 C 代码通常应该不会太难，因此它可以编译为 C++。

或者您可以重新排列您的结构定义，以便两个编译器碰巧以相同的方式布置它。将`double`成员放在首位可能会奏效。这仍然不能保证有效，并且它可能会与任一编译器的未来版本中断，但它*可能已经*足够好了。

不要忘记在结构的最后也可能有填充；这有时对于保证结构数组的正确对齐是必要的。查看`sizeof (struct TB)`并将其与最后声明的成员的大小和偏移量进行比较。

另一种可能性：插入显式未使用的成员以强制一致对齐。例如，假设您有：

```
struct foo {
    uint16_t x;
    uint32_t y;
}; 
```

一个编译器放在`y`16 位上，另一个编译器放在 32 位上，有 16 位填充。如果将定义更改为：

```
struct foo {
    uint16_t x;
    uint16_t unused_padding;
    uint32_t y;
}; 
```

那么你更有可能在两个编译器下拥有`x`并拥有相同的偏移量。`y`您仍然需要进行试验以确保一切都是一致的。

由于 C 和 C++ 代码将成为同一程序的一部分（对吗？），您不必担心字节顺序变化等问题。如果您想在单独的程序之间传输结构类型的值，例如通过将它们存储在文件中或通过网络传输它们，您可能需要定义一种一致的方式将结构值序列化为字节序列，反之亦然。

# vb.net - 如何在 PrintPreviewDialog 中设置纸张大小？

> ID：13782483
> 
> 赞同：1
> 
> 时间：2012-12-08T22:14:19.153
> 
> 标签：vb.net

例如 =>

```
PrintPreviewDialog1.WindowState = FormWindowState.Normal
PrintPreviewDialog1.StartPosition = FormStartPosition.CenterScreen
PrintPreviewDialog1.ClientSize = New Size(600, 600) 
```

但我想要纸张尺寸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:27:19.430

`PrintDocument`您通过您将要预览的纸张大小设置`PrintPreviewDialog`：

```
printDocument1.DefaultPageSettings.PaperSize =  _
   printDocument1.PrinterSettings.PaperSizes[Index] 
```

有关详细信息，请参阅 MSDN 上的[`PaperSize`文档](http://msdn.microsoft.com/en-us/library/system.drawing.printing.papersize%28v=VS.85%29.aspx)。

# excel - VBA Excel在范围内查找日期期间并在其中进行计算

> ID：13782484
> 
> 赞同：0
> 
> 时间：2012-12-08T22:14:27.177
> 
> 标签：excel, vba

我正在执行一个 VB 函数来对不同类别的指定时间段内的累积金额进行排序。目标是人事账户费用。

例如，我在 A 列中的工作表“tmp”中有一些日期，在 B 列中有一个类别（例如薪水，运输......），在 C 列中有值。

我想定义一个函数，我试图设置：

```
Function Cumulatif(Categorie As String, Debut As Date, Fin As Date) As Double
    ' Do the sum of a category between a starting and ending date specified 
    Dim Operations As Variant
    Dim SpecificSum As Double
    Dim i As Integer
    Operations = ThisWorkbook.Sheets("tmp").Range("A1:C3")
    For Each Row In Operations.Rows
        SpecificSum = 0
    Next
    Cumulatif = SpecificSum
End Function 
```

但我真的不知道如何从另一张表中获取值并在范围内进行循环以设置此总和。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:10:07.673

1.  操作的分配需要是对象分配，意思是：使用 Set（不是 Let/default）。

    设置操作 = ThisWorkbook.Sheets("tmp").Range("A1:C3)

2.  您可以从另一张表中获取值（假设您的意思是“tmp”），如下所示

    ```
    SpecificSum = SpecificSum + Row.Cells(1, 1) 
    ```

我认为你最好让函数接受一个额外的范围参数并提供 Sheet1!A 作为参数；这样 Excel 就会知道何时需要重新计算。

```
Function Cumulatif(Categorie As String, Debut As Date, Fin As Date, Operations As Range) As Double
    ' Do the sum of a category between a starting and ending date specified
    'Dim Operations As Variant
    Dim SpecificSum As Double
    Dim i As Integer
    'Set Operations = ThisWorkbook.Sheets("Sheet1").Range("A2:C3")
    For Each Row In Operations.Rows
        SpecificSum = SpecificSum + Row.Cells(1, 1)
    Next
    Cumulatif = SpecificSum
End Function 
```

并使用这样的公式调用 Cumulatif：

```
=Cumulatif("hello9","10/1/2010", "10/31/2010",Sheet1!A2:A3) 
```

# php - 在 Zend 框架中选择一个具有虚拟值的虚拟列 Select?

> ID：13782485
> 
> 赞同：6
> 
> 时间：2012-12-08T22:14:40.310
> 
> 标签：php, zend-framework, zend-db

我如何指定`Zend Db Table Select`获取一个虚拟列。

我想生成这样的sql

`SELECT 'ABC' AS xyz , name FROM employee`

**编辑：**

我试过这个

```
$select->from('employee',array( 
        'xyz'=>'ABC',
        'name'
)); 
```

也作为

`$select->from('employee',"'ABC' AS xyz , name"));`

在这两种情况下，Zend 都智能地将“ABC”视为模式中的一个字段。所以它会产生类似的东西

```
SELECT `employee`.`'ABC'` AS `xyz` , `name` FROM `employee` 
```

这会产生错误，因为 ABC 不是员工的字段

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-09T10:56:57.587

你应该试试

```
$select->from ('employee', array (new Zend_Db_Expr ('"ABC" AS title'), 'name')); 
```

# java - Java小程序和缓存问题

> ID：13782486
> 
> 赞同：3
> 
> 时间：2012-12-08T22:14:48.467
> 
> 标签：java, caching, browser, applet

我在网页中显示了一个小程序

`<applet code="foo.class"></applet>`

当我更改服务器中的 foo.class 文件并访问该页面时，它会显示旧版本。如果我清空浏览器和 jvm 缓存，然后重新加载页面，它会显示当前版本。我如何告诉浏览器/jvm 这是同一类的另一个版本？

而且，如果我在本地访问 html 文件，没有任何网络服务器，即使没有缓存刷新，它也始终显示当前版本。我错过了什么？

**更新：**

用js加载小程序时，生成的html为：

`<applet code="abcSynth.class" archive="miglayout-4.0-swing.jar" height="500" width="800"> <param name="cache_option" value="no"><param name="codebase_lookup" value="false">`

现在，我在 java 文档中发现 codebase_lookup 在 .jar 存档中未提供主类时使用它，就像这种情况一样。值为 false 时抛出 ClassNotFoundException，值为 true 时开始（旧版本）。代码文件夹包含主类和其他几个 .class 文件，唯一的 .jar 是 miglayout.jar，但由于[javadocs](http://docs.oracle.com/javase/6/docs/technotes/guides/plugin/developer_guide/special_attributes.html)说“*通常小程序部署时所有需要的类和资源都存储在小程序 JAR 文件中。* ”我想知道是否我在 .class/.jar 分解方面做错了。

**解决** 了谢谢它的工作！浏览器仍在缓存中保留旧版本，但重新启动后它会显示当前版本！

我使用的最终代码是：

```
<object classid="java:myClass.class" 
          type="application/x-java-applet"
          archive="myJar.jar" 
          height="500" width="800" >
<param name="code" value="myClass.class" />
<param name="persistState" value="false" />
<param name="cache_option" value="no"/>
<param name="codebase_lookup" value="true"/></object> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:59:33.483

有趣的问题...

作为提示，您可以使用[cache_option](http://docs.oracle.com/javase/6/docs/technotes/guides/deployment/deployment-guide/applet-caching.html)属性，因此您可以简单地设置不将您的小程序缓存为...

```
<html>
<head>
<title>Test Applet</title>
</head>
<body>
Test applet...
<script src="http://www.java.com/js/deployJava.js"></script>
<script>
    var attributes = {code:'Test.class',
                      archive:'aTest.jar',
                      width:10, height:10};
    var parameters = {cache_option:'no'};
    var version = '1.6';
    deployJava.runApplet(attributes, parameters, version);
</script>
</body>
</html> 
```

作为附加提示，尝试使用具有相同参数的[对象标记而不是小程序标记：](http://docs.oracle.com/javase/6/docs/technotes/guides/plugin/developer_guide/using_tags.html#object)

```
<PARAM name="cache_option" value="no"> 
```

* * *

报告是否有帮助

# css - 根据内部 a 的类定位外部 div

> ID：13782487
> 
> 赞同：1
> 
> 时间：2012-12-08T22:15:24.457
> 
> 标签：css, outer-join

说我有这样的事情：

```
<div class="entry">
   <a class="click" href="http://domain.com">Some link</a>
</div>

<div class="entry">
   <a class="unclick" href="http://domain.com">Some link</a>
</div> 
```

我如何定位 a.click 周围的 .entry 的全部内容，而不影响 a.unclick 的 .entry 周围

如果链接具有“点击”类，我想隐藏外部 div。

编辑：我需要在不使用 javascript 的情况下执行此操作，仅使用 CSS 和 HTML。

# android - Android NDK CPU 宏。ARMv7

> ID：13782488
> 
> 赞同：1
> 
> 时间：2012-12-08T22:15:28.497
> 
> 标签：android, android-ndk, armv7

我发现有以下宏的文章`__arm__`，`__i386__`

[http://software.intel.com/en-us/articles/getting-started-on-optimizing-ndk-project-for-multiple-cpu-architectures](http://software.intel.com/en-us/articles/getting-started-on-optimizing-ndk-project-for-multiple-cpu-architectures)

它有用于 ARMv7 检测的解决方案。

但我想检测到代码是直接从 CPP 为 ARMv7 编译的，而不是`Android.mk`用于包含不同的 CPP 文件

我不是在寻找 cpufeatures 我在寻找选定库的目标 CPU。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:27:39.163

您可能正在寻找`__ARM_ARCH_7A__`宏。

# php - 使用 PHP 将文件上传到 web 目录

> ID：13782497
> 
> 赞同：1
> 
> 时间：2012-12-08T22:17:06.277
> 
> 标签：php, html

我正在尝试从网页制作一个简单的上传应用程序：localhost/test.html。我收到这些错误：

> 警告：move_uploaded_file(test/Blue hills.jpg)：无法打开流：第 11 行的 C:\wamp\www\test.html 中没有这样的文件或目录

和

> 警告：move_uploaded_file(): Unable to move 'C:\wamp\tmp\php376.tmp' to 'test/Blue hills.jpg' in C:\wamp\www\test.html on line 11

这是我的代码

```
<html>
  <form enctype="multipart/form-data" action="test.html" method="POST">
    Please choose a file: <input name="uploaded" type="file" /><br />
    <input type="submit" value="Upload" />
 </form>
<html>

<?php

$target = "test/";
$target = $target . basename( $_FILES['uploaded']['name']) ;
$ok=1;

if(move_uploaded_file($_FILES['uploaded']['tmp_name'], $target)) {
  echo "The file ". basename( $_FILES['uploadedfile']['name']). " has been uploaded";
} else {
  echo "Uploading Error.";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:20:30.577

可能该目录`test`不存在。将这些行添加到您的代码中。

```
if (file_exists('test/')) echo 'Ok it wasn\'t that';
else echo 'Um, create a directory called test here: '.dirname(__FILE__); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:23:23.483

确保`test/`你的脚本所在目录下存在a目录，然后就可以使用了

```
$out = dirname(__FILE__) . '/' . $_FILES['uploaded']['name'];
move_uploaded_file($_FILES['uploaded']['tmp_name'], $out); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T23:08:06.563

将目录权限 (CHMOD) 更改为`777`通过您的 FTP 客户端（所有者、组、公共的读取、写入、执行）。

# android - 片段活动未能膨胀

> ID：13782499
> 
> 赞同：0
> 
> 时间：2012-12-08T22:17:19.993
> 
> 标签：android, android-fragments, android-fragmentactivity

我使用了从 Eclipse“Master/Detail”布局创建的基本布局。我已经对其进行了修改并添加了外部页面。但是，当我现在尝试仅加载 ContactListActivity.java 时，它无法加载给我下面的 logcat 错误。关于我做错了什么的任何想法？

ContactListActivity.java

```
package com.cyphrd.chirpd;

import com.cyphrd.chirpd.R;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import android.view.Menu;
import android.view.MenuItem;

/**
 * An activity representing a list of Contacts. This activity
 * has different presentations for handset and tablet-size devices. On
 * handsets, the activity presents a list of items, which when touched,
 * lead to a {@link ContactChatActivity} representing
 * item details. On tablets, the activity presents the list of items and
 * item details side-by-side using two vertical panes.
 * <p>
 * The activity makes heavy use of fragments. The list of items is a
 * {@link ContactListFragment} and the item details
 * (if present) is a {@link ContactChatFragment}.
 * <p>
 * This activity also implements the required
 * {@link ContactListFragment.Callbacks} interface
 * to listen for item selections.
 */
public class ContactListActivity extends FragmentActivity
        implements ContactListFragment.Callbacks {

    /**
     * Whether or not the activity is in two-pane mode, i.e. running on a tablet
     * device.
     */
    private boolean mTwoPane;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_contact_list);

        if (findViewById(R.id.contact_detail_container) != null) {
            // The detail container view will be present only in the
            // large-screen layouts (res/values-large and
            // res/values-sw600dp). If this view is present, then the
            // activity should be in two-pane mode.
            mTwoPane = true;

            // In two-pane mode, list items should be given the
            // 'activated' state when touched.
            ((ContactListFragment) getSupportFragmentManager()
                    .findFragmentById(R.id.contact_list))
                    .setActivateOnItemClick(true);
        }

        // TODO: If exposing deep links into your app, handle intents here.
    }

    /**
     * Callback method from {@link ContactListFragment.Callbacks}
     * indicating that the item with the given ID was selected.
     */
    @Override
    public void onItemSelected(String id) {
        if (mTwoPane) {
            // In two-pane mode, show the detail view in this activity by
            // adding or replacing the detail fragment using a
            // fragment transaction.
            Bundle arguments = new Bundle();
            arguments.putString(ContactChatFragment.ARG_ITEM_ID, id);
            ContactChatFragment fragment = new ContactChatFragment();
            fragment.setArguments(arguments);
            getSupportFragmentManager().beginTransaction()
                    .replace(R.id.contact_detail_container, fragment)
                    .commit();

        } else {
            // In single-pane mode, simply start the detail activity
            // for the selected item ID.
            Intent detailIntent = new Intent(this, ContactChatActivity.class);
            detailIntent.putExtra(ContactChatFragment.ARG_ITEM_ID, id);
            startActivity(detailIntent);
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);
        menu.add("Search")
            .setIcon(R.drawable.ic_search)
            .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);
        menu.add("Add Contact")
            .setIcon(R.drawable.ic_add_person)
            .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);
        menu.add("Settings").setIcon(R.drawable.ic_settings);
        //Whatever else is under the "More" menu
        return true;
    }
} 
```

ContactListFragment.java

```
package com.cyphrd.chirpd;

import android.app.Activity;
import android.os.Bundle;
import android.support.v4.app.ListFragment;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

import com.cyphrd.chirpd.dummy.DummyContent;

/**
 * A list fragment representing a list of Contacts. This fragment
 * also supports tablet devices by allowing list items to be given an
 * 'activated' state upon selection. This helps indicate which item is
 * currently being viewed in a {@link ContactChatFragment}.
 * <p>
 * Activities containing this fragment MUST implement the {@link Callbacks}
 * interface.
 */
public class ContactListFragment extends ListFragment {

    /**
     * The serialization (saved instance state) Bundle key representing the
     * activated item position. Only used on tablets.
     */
    private static final String STATE_ACTIVATED_POSITION = "activated_position";

    /**
     * The fragment's current callback object, which is notified of list item
     * clicks.
     */
    private Callbacks mCallbacks = sDummyCallbacks;

    /**
     * The current activated item position. Only used on tablets.
     */
    private int mActivatedPosition = ListView.INVALID_POSITION;

    /**
     * A callback interface that all activities containing this fragment must
     * implement. This mechanism allows activities to be notified of item
     * selections.
     */
    public interface Callbacks {
        /**
         * Callback for when an item has been selected.
         */
        public void onItemSelected(String id);
    }

    /**
     * A dummy implementation of the {@link Callbacks} interface that does
     * nothing. Used only when this fragment is not attached to an activity.
     */
    private static Callbacks sDummyCallbacks = new Callbacks() {
        @Override
        public void onItemSelected(String id) {
        }
    };

    /**
     * Mandatory empty constructor for the fragment manager to instantiate the
     * fragment (e.g. upon screen orientation changes).
     */
    public ContactListFragment() {
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // TODO: replace with a real list adapter.
        setListAdapter(new ArrayAdapter<DummyContent.DummyItem>(
                getActivity(),
                android.R.layout.simple_list_item_activated_1,
                android.R.id.text1,
                DummyContent.ITEMS));
    }

    @Override
    public void onViewCreated(View view, Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);

        // Restore the previously serialized activated item position.
        if (savedInstanceState != null
                && savedInstanceState.containsKey(STATE_ACTIVATED_POSITION)) {
            setActivatedPosition(savedInstanceState.getInt(STATE_ACTIVATED_POSITION));
        }
    }

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);

        // Activities containing this fragment must implement its callbacks.
        if (!(activity instanceof Callbacks)) {
            throw new IllegalStateException("Activity must implement fragment's callbacks.");
        }

        mCallbacks = (Callbacks) activity;
    }

    @Override
    public void onDetach() {
        super.onDetach();

        // Reset the active callbacks interface to the dummy implementation.
        mCallbacks = sDummyCallbacks;
    }

    @Override
    public void onListItemClick(ListView listView, View view, int position, long id) {
        super.onListItemClick(listView, view, position, id);

        // Notify the active callbacks interface (the activity, if the
        // fragment is attached to one) that an item has been selected.
        mCallbacks.onItemSelected(DummyContent.ITEMS.get(position).id);
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        if (mActivatedPosition != ListView.INVALID_POSITION) {
            // Serialize and persist the activated item position.
            outState.putInt(STATE_ACTIVATED_POSITION, mActivatedPosition);
        }
    }

    /**
     * Turns on activate-on-click mode. When this mode is on, list items will be
     * given the 'activated' state when touched.
     */
    public void setActivateOnItemClick(boolean activateOnItemClick) {
        // When setting CHOICE_MODE_SINGLE, ListView will automatically
        // give items the 'activated' state when touched.
        getListView().setChoiceMode(activateOnItemClick
                ? ListView.CHOICE_MODE_SINGLE
                : ListView.CHOICE_MODE_NONE);
    }

    private void setActivatedPosition(int position) {
        if (position == ListView.INVALID_POSITION) {
            getListView().setItemChecked(mActivatedPosition, false);
        } else {
            getListView().setItemChecked(position, true);
        }

        mActivatedPosition = position;
    }
} 
```

布局的 XML：

活动联系人列表：

```
 <fragment xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:id="@+id/contact_list"
        android:name="com.cyphrd.chirp.ContactListFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_marginLeft="16dp"
        android:layout_marginRight="16dp"
        tools:context=".ContactListActivity"
        tools:layout="@android:layout/list_content" /> 
```

activity_contact_twopane.xml

```
 <!--
    This layout is a two-pane layout for the Contacts
    master/detail flow. See res/values-large/refs.xml and
    res/values-sw600dp/refs.xml for an example of layout aliases
    that replace the single-pane version of the layout with
    this two-pane version.

    For more on layout aliases, see:
    http://developer.android.com/training/multiscreen/screensizes.html#TaskUseAliasFilters
    -->

    <fragment
        android:id="@+id/contact_list"
        android:name="com.cyphrd.chirp.ContactListFragment"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        tools:layout="@android:layout/list_content" />

    <FrameLayout
        android:id="@+id/contact_detail_container"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="3" />

</LinearLayout> 
```

日志猫：

```
12-08 15:11:31.978: E/AndroidRuntime(7071): FATAL EXCEPTION: main
12-08 15:11:31.978: E/AndroidRuntime(7071): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.cyphrd.chirpd/com.cyphrd.chirpd.ContactListActivity}: android.view.InflateException: Binary XML file line #1: Error inflating class fragment
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2049)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2083)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.ActivityThread.access$600(ActivityThread.java:134)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1233)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.os.Looper.loop(Looper.java:137)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.ActivityThread.main(ActivityThread.java:4697)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at java.lang.reflect.Method.invokeNative(Native Method)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at java.lang.reflect.Method.invoke(Method.java:511)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:787)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at dalvik.system.NativeStart.main(Native Method)
12-08 15:11:31.978: E/AndroidRuntime(7071): Caused by: android.view.InflateException: Binary XML file line #1: Error inflating class fragment
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:697)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.view.LayoutInflater.inflate(LayoutInflater.java:466)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:255)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.Activity.setContentView(Activity.java:1879)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at com.cyphrd.chirpd.ContactListActivity.onCreate(ContactListActivity.java:39)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.Activity.performCreate(Activity.java:4539)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2013)
12-08 15:11:31.978: E/AndroidRuntime(7071):     ... 11 more
12-08 15:11:31.978: E/AndroidRuntime(7071): Caused by: android.support.v4.app.Fragment$InstantiationException: Unable to instantiate fragment com.cyphrd.chirp.ContactListFragment: make sure class name exists, is public, and has an empty constructor that is public
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.support.v4.app.Fragment.instantiate(Fragment.java:401)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.support.v4.app.Fragment.instantiate(Fragment.java:369)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:272)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:669)
12-08 15:11:31.978: E/AndroidRuntime(7071):     ... 20 more
12-08 15:11:31.978: E/AndroidRuntime(7071): Caused by: java.lang.ClassNotFoundException: com.cyphrd.chirp.ContactListFragment
12-08 15:11:31.978: E/AndroidRuntime(7071):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
12-08 15:11:31.978: E/AndroidRuntime(7071):     at android.support.v4.app.Fragment.instantiate(Fragment.java:391)
12-08 15:11:31.978: E/AndroidRuntime(7071):     ... 23 more 
```

清单.xml：

```
<activity
            android:name="com.cyphrd.chirpd.ContactListActivity"
            android:label="@string/title_contact_list" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.cyphrd.chirpd.ContactChatActivity"
            android:label="@string/title_contact_detail"
            android:parentActivityName="com.cyphrd.chirpd.ContactListActivity" >
            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".ContactListActivity" />
        </activity> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T22:29:55.323

您已经在您的 XML 文件中为该类声明了 Fragment：

```
 com.cyphrd.chirp.ContactListFragment 
```

但它看起来像是在包装中：

```
 package com.cyphrd.chirpd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:27:51.083

您是否考虑过通过执行以下操作来放入框架布局并在 oncreate 中动态添加片段：

```
FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
ft.replace(R.id.placeholder_framelayout, new ContactChatFragment());
ft.commit(); 
```

这段代码应该可以正常工作，但我只是从内存中输入的，因此替换函数可能会将字段向后。

# ios - IOS：如何动态排列 UIViews？

> ID：13782500
> 
> 赞同：0
> 
> 时间：2012-12-08T22:17:28.000
> 
> 标签：ios, uiview

我需要向 ViewController 添加可变数量的 UIView；UIView 包含一个使用 CoreText 绘制的字符串。我目前正在通过执行以下操作添加单个 UIView：

```
 CGRect frame;
    frame.origin.x = x;
    frame.origin.y = y;
    frame.size.width = 100;
    frame.size.height = 100;

    CTLabelView *label=[[CTLabelView alloc]  initWithFrame:frame];
    [label setLabelText:@"my string"]; 
```

我想避免指定框架，让标签根据它的长度占据它需要的空间。避免指定宽度和高度的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:52:40.937

您可以获得指定字体的字符串大小。

```
// get your font
UIFont *font = label.font;

// Find width of a string ...
CGSize size = [@"my string" sizeWithFont:font]; 
```

# c# - 当职责不属于类时使用多态性而不是条件

> ID：13782502
> 
> 赞同：2
> 
> 时间：2012-12-08T22:17:35.850
> 
> 标签：c#, oop, polymorphism, solid-principles

我正在处理一个非常简单的应用程序，它是学校项目的一部分。

这是一个非常基本的基于控制台的员工管理系统，您可以在其中添加 4 种类型的员工（全职、兼职、合同、季节性，所有这些都具有几个不同的属性。）

我遇到的问题是在显示用于修改特定员工类型的菜单时。

对员工类型进行 switch 语句显然是非常糟糕的设计，但是在每个员工类中添加“DisplayModificationMenu”以便它可以显示自己的菜单似乎也很糟糕，因为显示菜单似乎不是员工的适当职责对象本身。

解决此设计问题的最佳方法是什么？我考虑过创建一个 Menu 类并对每个菜单进行子类型化，以便每个菜单都可以显示自己，但即便如此，我仍然觉得类型的开关仍会在某处发生，以决定要实例化哪个菜单。

修改员工的工作流程是通过 ID 选择员工，然后应显示该员工类型的正确菜单。因此，即使使用子类型菜单，您似乎也必须在知道要实例化哪个菜单之前检查员工类型。

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:26:32.473

我认为打开对象的类型不是问题，只要它被正确封装、记录和理解。

在您的情况下，您可以 make `DisplayMenuFactory`，这将接受抽象员工对象并返回抽象 Menu 类。在内部，它将根据员工类型进行切换，并为每种类型返回具体的菜单类。而且，如果您最终拥有不同的工厂，它们具有相同的切换机制，您可以将它们合并在一起，并且这种切换将始终在单个类中发生。因此，为不同的员工创建不同的 UI 的责任将在这个单一的类中。

第二个选项是让 Employee 类具有 GetMenu 方法，该方法将为每个员工类型返回具体的 Menu 类型。但这是混合模型和 UI，我认为在这种情况下这是不可接受的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:47:19.823

对我来说，设计没有“完美的方式”。这取决于很多事情；项目进度、开发技术、灵活性需求等。

但是在您的示例中，如果您不想在菜单生成例程中使用 switch 语句，则可以使用装饰器模式。认为菜单是您的员工对象的一种表示形式。

所以;

1）创建一个菜单装饰的基类，并将decorateMenu函数添加到这个类中（MenuDecorator）

2）为每个员工类型（MenuPartTimeEmployee、MenuFullTimeEmployee ...等）创建子类，并为这些类实现decorateMenu函数。您可以为不同的员工类别实施不同的行为。

3）如果你没有，创建一个基 Employee 类并从这个类扩展员工子类。将装饰器实例变量添加到基 Employee 类。对于每个 Employee 子类，将合适的菜单装饰器类分配给 menuDecorator 实例变量。比如PartTimeEmployee类；

```
this.menuDecorator = new MenuPartTimeEmployee(); 
```

4）最后在你的菜单渲染例程中；

```
// get target employee
employee = ...;
employee.menuDecorator.decorateMenu(); // Render menu for employee type 
```

这种模式的优点是您将菜单呈现代码与实体隔离开来。因此，您可以为不同的操作系统、平台（移动设备、桌面等）实现不同的菜单类型行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:25:49.863

创建一个名为employee的类，它具有员工的所有公共属性，所有4个类都应该扩展该类，并且如果需要更改或者如果员工的所有菜单都不同，则可以覆盖基本方法创建一个接口，所有的4个类以自己的方式实现

# php - CakePHP 2.2.4：分页链接

> ID：13782508
> 
> 赞同：1
> 
> 时间：2012-12-08T22:18:23.207
> 
> 标签：php, cakephp, pagination, routes, paginator

我的网站有很多“页面”。为不同的主题创建页面并由用户管理（例如*加勒比海盗的*页面或贾斯汀比伯的页面）。该页面属于一个类别，例如电影或音乐。页面的默认 URL 是[http://www.example.com/category-directory/page-id](http://www.example.com/category-directory/page-id)。或者，如果版主想要建立自己的页面链接作为更简单的导航方式，他们可以通过为“Page.link”列赋予值来实现（例如：[http](http://www.example.com/potc) ://www.example.com/电影*加勒比海盗的*[potc](http://www.example.com/potc)）。

我的路线都设置好了，这本身就花了一些时间。该路由检查“.com”之后的 URL 的第一个参数是否与任何页面的“链接”列匹配，如果匹配，则路由到该页面及其下的控制器/操作。如果没有，照常路线。

当用户查看[http://www.example.com/potc/articles/99](http://www.example.com/potc/articles/99)或[http://www.example.com/movies/106/articles/99](http://www.example.com/movies/106/articles/99)时（假设*加勒比海盗*是带有 id 的页面= 106) 然后将用户定向到文章控制器，查看操作，id = 99。106 作为 $page_id 传递给控制器​​的操作，并在 AppController 中设置。

我在控制器中提供的 URL 数组可以正常工作，例如，如果 id 不存在我重定向到`'controller' => 'articles', 'action' => 'index', 'page_id' = $page_id`. 我被重定向回[http://www.example.com/potc/articles](http://www.example.com/potc/articles)。我实际上不必定义控制器，因为默认情况下它使用当前控制器。

但是，我遇到了分页链接的问题。例如，我在文章索引页面上，有 100 篇文章，但我只查看前 20 篇。我希望将 URL 输出为[http://www.example.com/potc/articles/page :2](http://www.example.com/potc/articles/page:2)。

相反，如果我将 URL 数组设置为`'controller' => 'articles', 'action' => 'index', 'page_id' => $page_id`与我在控制器中所做的类似，我会得到链接[http://www.example.com/articles/page_id:106/page:2](http://www.example.com/articles/page_id:106/page:2)我可以理解为什么这条路线不起作用，因为如果Page.link 存在，我可能必须传递值，如果不传递Category.directory 和Page.id。我尝试使用 URL array 执行后一个选项`'controller' => 'articles', 'action' => 'index', 'category' => $page['Category']['directory'], 'page_id' => $page_id`。我有一条与之匹配的路线，但分页链接仍然生成为[http://www.example.com/articles/category:movies/page_id:106/page:2](http://www.example.com/articles/category:movies/page_id:106/page:2)

以下是我的 routes.php 中的一些片段：[https ://gist.github.com/9ba0a54a7f4d68803d14](https://gist.github.com/9ba0a54a7f4d68803d14)

我的问题是：“**我可以为分页链接使用确切的当前 URL（减去对当前页面的引用）吗？** ”例如，如果我正在查看[http://www.example.com/dynamic-route/controller /id/page:2](http://www.example.com/dynamic-route/controller/id/page:2)，分页链接会自动转到[http://www.example.com/dynamic-route/controller/id/page:3](http://www.example.com/dynamic-route/controller/id/page:3)

我将所有分页代码放入一个元素中，并且我想在需要分页的任何地方将该元素包含在我的视图文件中。

现在，如果我正在查看文章控制器，索引操作，分页链接的默认 URL 是[http://www.example.com/articles/page:2](http://www.example.com/articles/page:2)，但我需要它是[http://www .example.com/dynamic-route/articles/page:2](http://www.example.com/dynamic-route/articles/page:2)

我尝试使用

```
 $this->Paginator->options = array(
                    'url' => 'http://www.example.com/dynamic-route/articles'
   ); 
```

但是链接的输出类似于[http://www.example.com/articles/http://www.example.com/dynamic-route/articles/page:2](http://www.example.com/articles/http://www.example.com/dynamic-route/articles/page:2)

**编辑：** Jeztah，你提到放

> 'customlink' => '[a-z0-9]{1}([a-z0-9-]{2,}[a-z0-9]{1})?'

在我的路线上。好吧，我不能简单地这样做，因为路由会进行查询以检查 customlink 是否在数据库中，如果是则相应地路由。

我的路由器文件的一个例子是：

在获得 URL 的第一个参数[http://www.domain.com/](http://www.domain.com/) **CUSTOM-LINK**后，执行以下操作：

```
if($param1 != "users" && $param1){
    $pagelink = str_replace('-', ' ', $param1);

    $pagesModel = ClassRegistry::init('Page');
    $matchedpage = $pagesModel->find('first', array(
        'conditions' => array('Page.link LIKE' => "$pagelink"), 'recursive' => '-1'
    ));

    if($matchedpage['Page']['id']){
        Router::connect('/' . $param1 . '/:controller', array('action' => 'index', 'page_id' => $matchedpage['Page']['id']), array(
            'pass' => array('page_id'),
            'page_id' => '[0-9]+',
            'persist' => array('page_id'),
        ));

        Router::connect('/' . $param1 . '/:controller/:action/:id', array('page_id' => $matchedpage['Page']['id']), array(
            'pass' => array('page_id', 'id'),
            'page_id' => '[0-9]+',
            'persist' => array('page_id'),
        ));

        Router::connect('/' . $param1 . '/:controller/:id', array('action' => 'view', 'page_id' => $matchedpage['Page']['id']), array(
            'pass' => array('page_id', 'id'),
            'page_id' => '[0-9]+',
            'id' => '[0-9]+',
            'persist' => array('page_id'),
        ));

        Router::connect('/' . $param1 . '/:controller/:action', array('page_id' => $matchedpage['Page']['id']), array(
            'pass' => array('page_id'),
            'page_id' => '[0-9]+',
            'persist' => array('page_id'),
        ));

    } // end if page matches
} // end if param1 is not users 
```

如果我去[http://www.domain.com/custom-link/articles](http://www.domain.com/custom-link/articles)，[http://www.domain.com/custom-link/articles/1](http://www.domain.com/custom-link/articles/1)，[http://www.domain.com/custom- link/articles/edit/1](http://www.domain.com/custom-link/articles/edit/1)等显示正确的页面。如果我尝试导航到自定义链接不存在的页面，请继续查看我的路由器文件，如果没有其他路由匹配，则抛出错误消息。那里一切都好。

在我的 ArticlesController.php 中，重定向方法按预期工作。例如，我尝试访问[http://www.domain.com/custom-link/articles/99](http://www.domain.com/custom-link/articles/99)但 id 99 不存在，我被正确重定向回[http://www.domain.com/custom - 链接/文章](http://www.domain.com/custom-link/articles)使用

> $this->redirect(array('action' => 'index', 'page_id' => $page_id), null, true);

但是，在分页上，我将 url 选项设置为

> array('controller' => 'articles', 'action' => 'index', 'page_id' => $page_id);

其中 $page_id 在 AppController 中设置为由路由器传递。虽然我不需要设置控制器和动作，因为将使用电流。同样，我的分页链接显示为[http://www.domain.com/articles/page_id:3/page:2](http://www.domain.com/articles/page_id:3/page:2)而不是我想要的[http://www.domain.com/custom-link/articles/page :2](http://www.domain.com/custom-link/articles/page:2)

**编辑：**杰兹塔

我刚刚将我的整个路由文件更改为具有自定义链接参数的文件（我重命名为“链接”），然后创建了一个组件以在应用程序控制器中使用以从链接中获取页面 ID。

示例路线

```
Router::connect('/:link/:controller/:action/:id', array(), array(
    'pass' => array('link', 'id'),
    'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
    'persist' => array('link'),
));

Router::connect('/:link/:controller/:id', array('action' => 'view'), array(
    'pass' => array('link', 'id'),
    'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
    'id' => '[0-9]+',
    'persist' => array('link'),
)); 
```

但是，使用 url 数组作为`array('link' => 'test-example')`url 进行分页输出为`http://www.domain.com/articles/link:test-example/page:2`. 我的代码与您的代码完全相同，减去将“自定义链接”重命名为“链接”。此外，现在我的路线无法区分我是否尝试访问[http://www.domain.com/custom-link](http://www.domain.com/custom-link)，这将是 'controller' => 'pages', 'action' => 'view' （他的页面基本上会使用 News 模型并显示该页面的最新消息）如果我试图访问[http://www.domain.com/articles](http://www.domain.com/articles)这将是 'controller' => 'articles', ' action' => 'index' 将显示所有页面的最新文章。注意，文章和新闻是不同的模型。

```
Router::connect('/:link', array('controller' => 'pages', 'action' => 'view'), array(
    'pass' => array('link'),
    'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
    'persist' => array('link'),
)); 
```

是相同的

```
Router::connect('/:controller', array('action' => 'index')); 
```

因为不再在路由中检查“链接”是否属于特定页面。

**编辑：**好的，我正在取得进展。我发现下一个和上一个分页链接不太适合 paginator->options。我删除了 paginator->options 并将下一个按钮的 url 数组留空。该链接输出为[http://www.domain.com/articles/custom-link/articles/page:2](http://www.domain.com/articles/custom-link/articles/page:2)。进步！但是有什么办法可以驾驭第一个“文章/”吗？

我的路线是

```
Router::connect('/:link/:controller/*', array(), array(
    'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T09:39:26.660

最好为此使用相对路径：

```
 $this->Paginator->options = array(
                    'url' => '/dynamic-route'
   );
Or:
   $this->Paginator->options = array(
                    'url' => '/dynamic-route/articles'
   ); 
Or:
   $this->Paginator->options = array(
                    'url' => array('controller'=>'dynamic-route')
   ); 
```

[或开始在您的路由器文件http://api.cakephp.org/class/router#method-Routerurl](http://api.cakephp.org/class/router#method-Routerurl)中构建自定义路由

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T11:10:00.850

如果您正确构建路线，这一切都应该自动运行：

在你的 routes.php

```
/**
 * Movies view/details page
 */
Router::connect(
    '/:link',
    array(
         'controller'  => 'movies',
         'action'      => 'view',
    ),
    array(
         /**
          * Custom Link:
          * lowercase alphanumeric and dashes, but NO leading/trailing dash
          * should be at least 4 characters long
          *
          * IMPORTANT:
          * custom links should *NOT* overlap with actual controller
          * names, like 'movies, articles' etc!
          */
         'link'   => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',

         // Define what should be passed to the 'view' action as arguments
         'pass'         => array('link'),

         /**
          * Define what parameters should be automatically preserved
          * when creating URLs/links
          */
         'persist' => array('link'),
    )
);

/**
 * Article view/details page
 */
Router::connect(
    '/:link/:controller/:page_id',
    array(
         'controller'  => 'articles',
         'action'      => 'view',
    ),
    array(
         /**
          * Specify the 'controllers' that are allowed to be put
          * after link. You can add more, for example
          * 'reviews' to show reviews for a movie. this
          * will result in Reviews::view([page_id]) to be shown
          */
         'controller' => 'articles',
         'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
         'page_id'  => '[1-9]{1}[0-9]{0,}',

         // Define what should be passed to the 'view' action as arguments
         'pass'       => array('page_id', 'link'),

         /**
          * Define what parameters should be automatically preserved
          * when creating URLs/links
          */
         'persist' => array('page_id', 'link'),
    )
);

/**
 * Article overview/index page
 */
Router::connect(
    '/:link/:controller/*',
    array(
         'controller'  => 'articles',
         'action'      => 'index',
    ),
    array(
         'controller' => 'articles',
         'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',

         // Define what should be passed to the 'index' action as arguments
         'pass'       => array('link'),

         /**
          * Define what parameters should be automatically maintained
          * when creating URLs/links
          */
         'persist' => array('page_id', 'link'),
    )
); 
```

打开[http://example.com/potc](http://example.com/potc)时，您将被带到 Movies::view('potc')

打开[http://example.com/potc/articles](http://example.com/potc/articles)时，您将被带到 Articles::index('potc')

打开[http://example.com/potc/articles/page:2](http://example.com/potc/articles/page:2)时，您还将被带到 Articles::index('potc')。“页面”将作为命名参数传递

打开[http://example.com/potc/articles/99](http://example.com/potc/articles/99)时，您将被带到 Articles::view(99, 'potc')

在您的 Articles/index.ctp 视图中：

```
debug($this->Html->link('current page', array()));
// outputs:
// <a href="/potc/articles/">current page</a>

debug($this->Html->link('next page', array('page' => 2)));
// outputs:
// <a href="/potc/articles/page:2">next page</a>

debug($this->Html->link('view article', array('action' => 'view', 'page_id' => 99)));
// outputs:
// <a href="/potc/articles/99">view article</a> 
```

访问分页链接（[http://example.com/potc/articles/page:2/sort:title/dir:desc](http://example.com/potc/articles/page:2/sort:title/dir:desc)）

```
debug($this->request); 
```

输出：

```
object(CakeRequest) {
    params => array(
        'plugin' => null,
        'controller' => 'articles',
        'action' => 'index',
        'named' => array(
            'page' => '2',
            'sort' => 'title',
            'dir' => 'desc'
        ),
        'pass' => array(
            (int) 0 => 'potc'
        ),
        'link' => 'potc',
        (int) 0 => 'page:2/sort:title/dir:desc',
        'paging' => array(
            'Article' => array(
                'page' => (int) 1,
                'current' => (int) 0,
                'count' => (int) 3,
                'prevPage' => false,
                'nextPage' => false,
                'pageCount' => (int) 1,
                'order' => array(),
                'limit' => (int) 10,
                'options' => array(
                    'page' => (int) 2,
                    'sort' => 'title',
                    'order' => array(),
                    'conditions' => array()
                ),
                'paramType' => 'named'
            )
        ),
        'models' => array(
            'Article' => array(
                'plugin' => null,
                'className' => 'Article'
            )
        )
    )
    data => array()
    query => array()
    url => 'potc/articles/page:2/sort:title/dir:desc'
    base => ''
    webroot => '/'
    here => '/potc/articles/page:2/sort:title/dir:desc'
} 
```

如您所见，您需要的所有信息都在请求对象中

### [OP修改后更新]

我看到您在这条路线中使用了 ':id'：

```
/:link/:controller/:action/:id 
```

但是您没有为此包含正则表达式。另外，我认为您不想使用此路由，因为要匹配此路由，您必须在 URL 中包含该操作。例如：

```
/test-example/articles/view/1 
```

这条路线的更好选择是我原来的例子中的这条路线：

```
/:link/:controller/:page_id 
```

这将路由到：

```
Controller::view('page_id', 'link') 
```

正如我之前提到的，添加路由的“顺序”决定了首先匹配的内容，因此如果您在包含 CakePHP 默认路由之前添加了路由，那么您的路由将是首选。

在这种情况下; /test-example/ /pages/

将始终与 '/:link' 匹配，因此 /pages/view/test-example，如果你传递**了**一个有效的控制器名（！）为了​​防止这种情况，你应该在包含 CakePHP 默认路由*之后添加你的路由。*

如果添加路由 /:link/:controller/

然后这个网址：/test-example/something

*仅*当“某物”是已知控制器时才会匹配

```
/:link/:controller/:action/:id 
```

如果“控制器”是已知控制器，则匹配，任何操作都将被“接受”，但如果您尝试访问它，则会导致“未找到异常”。另外（如上所述）您应该为“id”添加一个正则表达式

您添加的最后一条路线：

```
Router::connect('/:link/:controller/*', array(), array(
    'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
)); 
```

缺少默认的 'action' 参数，因此 CakePHP 可能无法匹配，这应该是：

```
Router::connect('/:link/:controller/*', 
    array(
        'action' => 'index',
    ), array(
    'link' => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
)); 
```

这样，它将匹配：

```
/any-link/controllername/pass1
/any-link/controllername/pass1/pass2
etc. 
```

分别是 'pass1, pass2' 将作为参数发送到控制器的操作，例如：

```
/test-example/articles/some/thing/else 
```

将被路由到：

```
ArticlesController::index('some', 'thing', 'else'); 
```

我认为您的路线的最佳顺序是：

1.  Cake 默认路由
2.  /:link (-> pages::view('link'))
3.  /:link/:controller/:id (-> controller::view('id', 'link))
4.  /:link/:controller/* (-> controller::index('link'))

注意最后两条路线的顺序；Route 3 仅在 'id' 为数值时才匹配，导致路由 'view' 动作 Route 4 将匹配控制器之后的 'anything'，并显示控制器的 'index' 动作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:55:44.980

**编辑：**在我意识到我的上一个答案在 ArticlesConntroller::redirect 方面存在缺陷之后，这是一个经过编辑的答案

对于任何设法阅读整个问题/评论并想知道答案的人。感谢 Jeztah 的帮助，我想出了一个解决方案，我将把这笔赏金授予他。让我很难过的一个问题是一个页面可能有 2 个 URL。例如：[http://www.domain.com/potc](http://www.domain.com/potc)或[http://www.domain.com/movies/106](http://www.domain.com/movies/106)。基本上我结合了我和 Jeztah 的想法。

首先，我必须检查**routes.php**以查看 .com 之后的第一个参数是否与页面的快捷方式“链接”匹配（例如： http: [//www.domain.com/potc](http://www.domain.com/potc) = potc）。

```
// get params of URL
$requestURI = explode('/', $_SERVER['REQUEST_URI']);
$scriptName = explode('/',$_SERVER['SCRIPT_NAME']);

for($i= 0;$i < sizeof($scriptName);$i++) {
      if ($requestURI[$i]     == $scriptName[$i]) {
                unset($requestURI[$i]);
        }
      }
 $param = array_values($requestURI);

// only concerned about first param
$param1 = $param[0];

// do the following routes if url != http://www.domain.com/users/* or http://www.domain.com
if($param1 != "users" && $param1){

    // convert http://www.domain.com/assassins-creed to "assassins creed"
    $pagelink = str_replace('-', ' ', $param1);
    $pagesModel = ClassRegistry::init('Page');
    // check if there is a page whose "link" matches converted link, if so, get the field "id"
    $matched_page_id = $pagesModel->field('id', array('Page.link LIKE' => "$pagelink"));
    // if there is a match, route as follows
    if($matched_page_id){

         // Jeztah's way with some modifications

        // domain.com/potc/articles/edit/1
        Router::connect(
            '/:link/:controller/:action/:id',
            array('page_id' => $matched_page_id, 'category' => 0),
            array(
                'pass' => array('id', 'link', 'category', 'page_id'),
                'link'   => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
                'persist' => array('link'),
                'id' => '[0-9]+'
            )
        );

        // domain.com/potc/articles/1
        Router::connect(
            '/:link/:controller/:id',
            array('action' => 'view', 'page_id' => $matched_page_id, 'category' => 0),
            array(
                'pass' => array('id', 'link', 'category', 'page_id'),
                'link'   => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
                'persist' => array('link'),
                'id' => '[0-9]+'
            )
        );

        // domain.com/potc/articles/add
        Router::connect(
            '/:link/:controller/:action',
            array('page_id' => $matched_page_id, 'category' => 0),
            array(
                'pass' => array('link', 'category', 'page_id'),
                'link'   => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
                'persist' => array('link'),
                'action' => 'add|uncategorized',
            )
        );

        // domain.com/potc/articles OR domain.com/articles/page:2
        Router::connect(
            '/:link/:controller/*',
            array('action' => 'index', 'page_id' => $matched_page_id, 'category' => 0),
            array(
                'pass' => array('link', 'category', 'page_id'),
                'link'   => '[a-z0-9]{1}([a-z0-9\-]{2,}[a-z0-9]{1})?',
                'persist' => array('link'),
            )
        );
    }  // end if first param matches a page's "link" shortcut
}  // end if first param is not users and is not empty

// do some general site routing
// do some general site routing

// now route for page's that do not have a link shortcut (example: http://www.domain.com/movies/106)

// domain.com/movies/106/articles/edit/1
Router::connect(
    '/:category/:page_id/:controller/:action/:id',
    array('link' => '0'),
    array(
        'pass' => array('id', 'link', 'category', 'page_id'),
        'page_id' => '[0-9]+',
        'id' => '[0-9]+'
    )
);

// domain.com/movies/106/articles/1
Router::connect(
    '/:category/:page_id/:controller/:id',
    array('action' => 'view', 'link' => '0'),
    array(
        'pass' => array('id', 'link', 'category', 'page_id'),
        'page_id' => '[0-9]+',
        'id' => '[0-9]+'
    )
);

// domain.com/movies/106/articles/add
Router::connect(
    '/:category/:page_id/:controller/:action',
    array('link' => '0'),
    array(
        'pass' => array('link', 'category', 'page_id'),
        'page_id' => '[0-9]+',
        'action' => 'add|uncategorized'
    )
);

// domain.com/movies/106/articles OR domain.com/movies/106/articles/page:2
Router::connect(
    '/:category/:page_id/:controller/*',
    array('action' => 'index', 'link' => '0'),
    array(
        'pass' => array('link', 'category', 'page_id', 'controller'),
        'page_id' => '[0-9]+'
    )
); 
```

因为 page_id 在 :link 路由和 :category 路由中都被传递，所以我不必像建议的那样拥有一个获取页面 id 的组件。

现在在我的**ArticlesController**

```
public function index($link = null, $category = null, $page_id = null, $controller = null) {
    if($page_id){

         // display all articles for a particular page if on
         // http://www.domain.com/potc/articles or http://www.domain.com/movies/106/articles
        $this->set('articles', $this->paginate('Article', array('Article.page_id' => $page_id, 'Article.status <= 5'))); 
    }
    else{

        // display all articles if on http://www.domain.com/articles
        $this->set('articles', $this->paginate('Article', array('Article.status <= 5')));
    }    
} // end index function

public function view($id = null, $link = null, $category = null, $page_id = null) {
    $this->Article->id = $id;
    $article_page = $this->Article->field('page_id', array('id =' => $id));

    if (!$this->Article->exists()) {
        $this->Session->setFlash('This article does not exist');

        // using PageLinkRedirect function of my custom component,
        // determine where to redirect. Either to "potc/articles" or
        // "movies/106/articles";
        $this->redirect('../'.$this->CustomPage->PageLinkRedirect($link, $category, $page_id).'/articles', null, true);
    }
    elseif($article_page != $page_id) {
        $this->Session->setFlash('Invalid article for this page');

        // using PageLinkRedirect function of my custom component,
        // determine where to redirect. Either to "potc/articles" or
        // "movies/106/articles";
        $this->redirect('../'.$this->CustomPage->PageLinkRedirect($link, $category, $page_id).'/articles', null, true);
    }
    else{
        $this->set('title_for_layout', $this->Article->field('title', array('id =' => $id)));
        $this->set('article',  $this->Article->read(null, $id));
        $this->set('comments', $this->paginate($this->Article->Comment, array('Comment.module_id' => $this->viewVars['module_id'], 'Comment.post_id' => $id)));
    } // end else
} // end view function 
```

**我的分页存储在一个元素中，但我在文章 index.ctp 视图**的底部加载了该元素

 **```
<?php echo $this->element('all/pagination', array('pagination_url' => 'articles')); ?> 
```

我会为每个不同的控制器放置相同的代码，但更改“文章”一词（例如：“评论”、“新闻/主题”等）

我的 pagination.ctp 元素看起来像这样

```
<?php
if($this->params['paging'][key($this->params['paging'])]['pageCount'] > 1){
    $pagination_class = "pagination_enabled";
}
else{
    $pagination_class = "pagination_disabled";
}
 ?>
<div class="<?php echo $pagination_class; ?>">
<?php echo $this->Paginator->counter(array(
    'format' => __('Page {:page} of {:pages}, showing {:current} records out of {:count} total, starting on record {:start}, ending on {:end}')
)); 
?>
<ul>
<?php

// $link is set in AppController from the link param, same with category and page_id
if($link){
    $this->Paginator->options = array('url' => array('controller' => null, $link, $pagination_url));

    // This outputs http://www.domain.com/potc/articles where articles
    // is from the passed $pagination_url when I loaded the element
    // in my Articles index.ctp view. I have to set controller = null
    // or else the link will output as http://www.domain.com/articles/potc/articles
}
else{
    $this->Paginator->options = array('url' => array('controller' => null, 'link' => null, $category, $page_id, $pagination_url));

    // This outputs http://www.domain.com/movies/106/articles where articles
    // is from the passed $pagination_url when I loaded the element
    // in my Articles index.ctp view. I have to set controller = null AND
    // link = null or else the link will output as
    // http://www.domain.com/articles/0/movies/9/articles
} 
echo $this->Paginator->prev('< ' . __('previous'), array('tag' => 'li'), null, array('class' => 'prev disabled'));
if($this->Paginator->numbers){echo $this->Paginator->numbers(array('tag' => 'li', 'separator' => ''));}
echo $this->Paginator->next(__('next') . ' >', array('tag' => 'li'), null, array('class' => 'next disabled'));
?>
</ul></div> 
```**

# java - JNI：编译 64 位本机库时出现问题

> ID：13782510
> 
> 赞同：1
> 
> 时间：2012-12-08T22:18:50.377
> 
> 标签：java, c, gcc, java-native-interface, native

我在 Windows（64 位）上使用 GCC 标志 -c 和 -o Name.dll 编译了本机 DLL 文件。

当我执行 System.load("fullpahhere") 时，我收到此错误：

```
java.lang.UnsatisfiedLinkError: RenderControl.dll: %1 is not a valid Win32 application 
```

如果我重新编译将空白 main() 方法添加到 C 源代码并删除 -c 标志，则它会失败并出现 UnsatisfiedLinkError ，表示它无法在 64 位机器上加载 32 位 DLL。

为什么Java调用没有main方法的DLL无效？这不会破坏 DLL 文件和 JNI 的全部意义吗？

**更新**

我修复了 main() 问题。此 GCC 调用设置有效：

```
gcc -Wall -D_JNI_IMPLEMENTATION_ -Wl,--kill-at -I "C:\Program Files\Java\jdk1.6.0_32\include" -I "C:\Program Files\Java\jdk1.6.0_32\include\win32" -shared *.c -o lib.dll 
```

但是，我仍然需要弄清楚 JVM 架构问题。

我在哪里可以找到能够编译 64 位代码的 MinGW 安装？看来我的标准 MinGW 安装只支持 32 位。

如果我能掌握它，我如何决定在 Java 中加载哪个库？是否有显示**JVM 拱门**（而**不是**操作系统拱门）的系统属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:29:07.873

如果使用 MinGW32 编译器，则无法生成 64 位代码。这很可能是故意的。我快速查找的其他人的类似问题似乎表明您正在尝试将 32 位本机二进制文件与 64 位 java 一起使用。

尝试使用[mingw-w64](http://mingw-w64.sourceforge.net/)进行编译，看看是否能解决问题。

还有一种可能是您的库根本不在库路径中，并且即使您提供`System.load`了完整路径也找不到它，在这种情况下，您应该确保您的 DLL 位于本机库的正确位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-10T01:33:21.780

查看[http://tdm-gcc.tdragon.net/](http://tdm-gcc.tdragon.net/)，下载 TDM-GCC，它可以在 Windows 上轻松安装上面提到的 MinGW-w64。安装完 TDM-GCC 后，可以使用以下代码生成 64 位 dll。

```
"C:\MinGW64\bin\gcc.exe" -m64 -c -I"C:\Program Files\Java\jdk1.6.0_26\include" -I"C:\Program Files\Java\jdk1.6.0_26\include\win32" HelloWorld.c 
```

正是“-m64”使它成为64位。这是从与 HelloWorld.c C 代码源文件相同的目录运行的。这会在与 run.. 相同的目录中生成 HelloWorld.o C 代码对象文件。

# .net - 为什么 AndAlso 不能替代 And

> ID：13782516
> 
> 赞同：3
> 
> 时间：2012-12-08T22:19:35.210
> 
> 标签：.net, vb.net

> **可能重复：**
> [我应该始终使用 AndAlso 和 OrElse 运算符吗？](https://stackoverflow.com/questions/55013/should-i-always-use-the-andalso-and-orelse-operators)

在所有场景的实际实现中，逻辑表达式将为和返回相同的布尔值`And`，`AndAlso`

为什么我们不使用 always`AndAlso`并在前一个条件为假时节省下一个条件的处理时间？换句话说，为什么`And`还在使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T22:58:11.793

VB.NET 中的 And 运算符执行*两项*工作，它既是逻辑运算符又是数学运算符。Visual Basic 的早期版本不区分这两者。按照设计，该语言被设计为易于使用，并迫使 Visual Basic 程序员学习差异是语言设计者想要避免的。

虽然它给语言带来了一些怪癖，但效果很好。例如 True 的值不是 1，就像在许多语言中一样，它是 -1。您从 CInt(True) 获得的值。这允许忽略运算符的两种用法之间的差异，例如，当 If() 语句使用 And 当左侧是整数而右侧是布尔值时，它仍然可以很好地工作。

但是 And 运算符同时扮演这两个角色存在一个非常具体的问题。一个常见的用法是编写如下语句：

```
If ix < array.Length And array(ix) <> 42 Then
   '' do something
End If 
```

该语句将使您的代码因 IndexOutOfRangeException 而崩溃。您的*意思*是“如果索引超出范围，则不要费心检查数组元素”。这就是所谓的“短路评估”。但这不是 And 运算符所做的，它计算左右表达式。就像And 运算符必须做的*数学版本一样。*

短路评估很重要，并且已经存在了很长时间。并且在花括号语言中被普遍采用，从 C 开始。它最终也被 VB.NET 采用，你这样写以避免异常：

```
If ix < array.Length AndAlso array(ix) <> 42 Then
   '' do something
End If 
```

因此，回答您的问题：是的，当您打算使用And 运算符的*逻辑版本时，请始终使用 AndAlso。*AndAlso*是*合乎逻辑的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:22:45.713

有时您希望两个部分都被执行，以产生副作用。并非一切都是纯函数。另外：我假设我们正在谈论布尔值，但在整数等的情况下，And 表示按位运算。

# c# - 同步融合winrt图表

> ID：13782517
> 
> 赞同：2
> 
> 时间：2012-12-08T22:19:39.307
> 
> 标签：c#, xaml, windows-runtime, syncfusion

我正在尝试在我的新 Win8 C#/XAML 商店应用程序中使用来自 SyncFusion WinRT Studio 的饼图，但我不知道如何在图表上设置数据。我的页面上有图表，并尝试了我能找到的一切来设置数据以显示内容，但我无法让它工作。示例应用程序没有太大帮助，因为它们的页面中有 0 个代码，我不知道有什么不同。下面的图表直接从他们的示例中复制而来，但在我的应用程序中不起作用。任何人都有在 WinRT 应用程序中使用 SyncFusion 图表的示例吗？

XAML 中的图表：

```
 <Grid Margin="30,15,30,30" x:Name="ChartGrid">
        <Grid.Resources>
          <local:Labelconvertor x:Key="labelconverter"/>
          <Style TargetType="Line" x:Key="lineStyle">
            <Setter Property="StrokeThickness" Value="0"/>
          </Style>
          <DataTemplate x:Key="labelTemplate">
            <TextBlock Margin="10,0,0,0" Text="{Binding Converter={StaticResource labelconverter}}" FontSize="26" FontFamily="Segoe UI" FontWeight="Light" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Top" Opacity="0.5"></TextBlock>
          </DataTemplate>
          <DataTemplate x:Key="legend">
            <StackPanel Orientation="Horizontal">
              <Grid Margin="10,0,0,0">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition/>
                  <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Rectangle Width="15" Height="15" Fill="{Binding Interior}"></Rectangle>
                <TextBlock Margin="10,5,5,0" Grid.Column="1" Text="{Binding Item.Expense}"></TextBlock>
              </Grid>
            </StackPanel>
          </DataTemplate>
        </Grid.Resources>
        <Grid.DataContext>
          <local:PieChartViewModel/>
        </Grid.DataContext>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"></RowDefinition>
          <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <StackPanel Margin="0,0,0,20">
        </StackPanel>
        <chart:Chart x:Name="ScatterChart" AreaBorderThickness="0" HorizontalAlignment="Center" Grid.RowSpan="2" Visibility="Visible">
          <chart:Chart.Header>
            <TextBlock FontSize="20" FontFamily="Segoe UI" Margin="0,20,0,10">Agriculture Expenses Comparison</TextBlock>
          </chart:Chart.Header>
          <chart:Chart.PrimaryAxis>
            <chart:ChartAxis></chart:ChartAxis>
          </chart:Chart.PrimaryAxis>
          <chart:Chart.SecondaryAxis>
            <chart:ChartAxis></chart:ChartAxis>
          </chart:Chart.SecondaryAxis>
          <chart:Chart.Legend>
            <chart:ChartLegend  CornerRadius="0" ItemTemplate="{StaticResource legend}" CheckBoxVisibility="Visible" BorderThickness="1">
            </chart:ChartLegend>
          </chart:Chart.Legend>
          <chart:PieSeries ItemsSource="{Binding Expenditure}" XBindingPath="Expense" x:Name="pieSeries" ExplodeAll="{Binding Path=IsChecked,ElementName=chkExplode}" ExplodedRadius="{Binding Path=Value,ElementName=slRadius}" Palette="Metro" Label="Expenditures" YBindingPath="Amount">
            <chart:PieSeries.AdornmentsInfo>
              <chart:ChartAdornmentInfo AdornmentsPosition="Bottom"  HorizontalAlignment="Center" VerticalAlignment="Center" ConnectorLineStyle="{StaticResource lineStyle}" ShowConnectorLine="True" ConnectorHeight="30" ShowLabel="True"  LabelTemplate="{StaticResource labelTemplate}" SegmentLabelContent="YValue">
              </chart:ChartAdornmentInfo>
            </chart:PieSeries.AdornmentsInfo>
          </chart:PieSeries>
        </chart:Chart>
      </Grid>
    </StackPanel>
  </Grid> 
```

从 LoadState 函数调用的代码隐藏：（我已经尝试了所有这些选项，但它们都不起作用......）

```
 PieChartViewModel pvm = new PieChartViewModel();
  this.DefaultViewModel["PieChartViewModel"] = pvm;
  this.DefaultViewModel["DataContext"] = pvm;
  this.DefaultViewModel["Items"] = pvm;
  this.DefaultViewModel["DefaultViewModel"] = pvm;
  this.ScatterChart.DataContext = pvm;
  this.ChartGrid.DataContext = pvm; 
```

对象定义：

```
public class PieChartViewModel
{
  public PieChartViewModel()
  {
    this.Expenditure = new List<CompanyExpense>();
    Expenditure.Add(new CompanyExpense() { Expense = "Seeds", Amount = 20d });
    Expenditure.Add(new CompanyExpense() { Expense = "Fertilizers", Amount = 23d });
    Expenditure.Add(new CompanyExpense() { Expense = "Insurance", Amount = 12d });
    Expenditure.Add(new CompanyExpense() { Expense = "Labor", Amount = 28d });
    Expenditure.Add(new CompanyExpense() { Expense = "Warehousing", Amount = 10d });
    Expenditure.Add(new CompanyExpense() { Expense = "Taxes", Amount = 10d });
    Expenditure.Add(new CompanyExpense() { Expense = "Truck", Amount = 10d });
  }
  public IList<CompanyExpense> Expenditure
  {
    get;
    set;
  }
}
public class CompanyExpense
{
  public string Expense { get; set; }
  public double Amount { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T09:27:03.530

我能够毫无问题地使用相同的数据填充饼图。[请在PieChartDemo](http://www.syncfusion.com/downloads/Support/DirectTrac/101983/PieChart-490565448.zip)中找到示例

这是解释如何配置饼图的文档：[PieChartHelp](http://www.syncfusion.com/downloads/Support/DirectTrac/General/UG_WinRT_Chart_%20Pie%20Chart%20Documentation-173804257.docx)

以下是用于为生成 PieSeries 提供数据的三个 API，

1.  `ItemsSource`- 您可以使用此属性提供数据源。任何 IEnumerable 都可以作为数据源。
2.  `XBindingPath`- 用于提供源对象中类别数据的路径。
3.  `YBindingPath`- 用于提供源对象中数值数据的路径。

# php - 在 Codeigniter 中使用 oracle 数据库获取错误号

> ID：13782520
> 
> 赞同：4
> 
> 时间：2012-12-08T22:20:02.413
> 
> 标签：php, database, oracle, codeigniter, error-handling

首先对不起我的英语不好..

我在模型中有这个功能：

```
function insertUser($data){

$sql = "INSERT INTO USERS VALUES (?, ?, ?, ?, ?, ?, ?, ?)";

$query = $this->db->query($sql, array(
    $data["uname"],
    $data["nome"],
    $data["dnuser"],
    $data["muser"],
    $data["fruser"],
    $data["cpuser"],
    $data["euser"],
    md5($data["passu"])
  ));

//return $this->db->_error_number();

} 
```

我有一个主键，当数据正确时，该功能起作用，但是当插入一个重复键时，该功能不起作用。但我怎么知道呢？我的意思是我怎样才能捕捉到错误 ORA-00001 ？

顺便说一句，注释行不起作用..

非常感谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T05:14:48.953

您可以使用 try catch 块...

```
function insertUser($data){

$sql = "INSERT INTO USERS VALUES (?, ?, ?, ?, ?, ?, ?, ?)";

try{
$this->db->trans_start();
$query = $this->db->query($sql, array(
    $data["uname"],
    $data["nome"],
    $data["dnuser"],
    $data["muser"],
    $data["fruser"],
    $data["cpuser"],
    $data["euser"],
    md5($data["passu"])
  ));
$this->db->trans_commit();
}
catch(Exception $ex){
$this->db->trans_rollback();
echo "Error:".$ex;
}
} 
```

您可以查看以下文章..

[http://ellislab.com/codeigniter/user-guide/database/transactions.html](http://ellislab.com/codeigniter/user-guide/database/transactions.html)

# mysql - Mysql子查询选择

> ID：13782521
> 
> 赞同：-1
> 
> 时间：2012-12-08T22:20:05.120
> 
> 标签：mysql, sql

我试图找到一个解决方案：

我需要选择所有任务的查询，这些任务不是`started`和此任务的类似任务名称不应该在此表中重复 5 行并带有标志`started`

我的查询：

```
SELECT * FROM tasks as t 
WHERE started = 0 
AND ((SELECT COUNT(*) FROM tasks 
WHERE started = 1 AND taskname = taskname) < 5) 
```

但查询不起作用。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T22:23:09.757

尝试以下

```
AND taskname = t.taskname 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:25:04.027

你非常接近：

```
SELECT * FROM tasks as t 
WHERE started = 0 
AND (SELECT COUNT(*) FROM tasks 
WHERE started = 1 
AND taskname = t.taskname) < 5 
```

您只需要比较计数结果而不是在子查询中包含比较。`t.`此外，您需要使用前缀将任务名限定为外部表

# puppet - 有没有办法从远程 http 主机访问 Puppet 清单？

> ID：13782522
> 
> 赞同：2
> 
> 时间：2012-12-08T22:20:14.277
> 
> 标签：puppet

如果我有清单`http://mysite.com/somemanifest.pp`，我可以从远程服务器应用它吗？我正在努力：

```
puppet apply http://mysite.com/somemanifest.pp 
```

但得到

`Could not run: Could not find file http://mysite.com/somemanifest.pp`

我想在不运行 puppet master 的情况下做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:10:59.203

你为什么不想经营一个傀儡师？它正是为这种情况而创建的。

如果您绝对无法运行 puppetmaster，那么您将不得不将您的 puppet 调用包装在另一个脚本中，该脚本首先下载文件（使用`curl`or `wget`）并在成功下载后应用它们。鉴于 puppetmaster 是一个运行起来相当简单的应用程序，我不认为*不*使用它会更好。

# python - python矩阵 - 列表索引超出范围

> ID：13782524
> 
> 赞同：2
> 
> 时间：2012-12-08T22:20:34.353
> 
> 标签：python, list, matrix, range, out

嘿，我正在编写一个函数，它接受一个矩阵输入，例如下面的一个并返回它的逆矩阵，其中所有的 1 都更改为 0，所有的 0 都更改为 1，同时保持从左上角到右下角的对角线为 0。

示例输入：

```
g1 = [[0, 1, 1, 0],
     [1, 0, 0, 1],
     [1, 0, 0, 1],
     [0, 1, 1, 0]] 
```

该函数应输出以下内容：

```
g1 = [[0, 0, 0, 1],
     [0, 0, 1, 0],
     [0, 1, 0, 0],
     [1, 0, 0, 0]] 
```

当我运行该程序时，它会引发“列表索引超出范围”错误。我确定这是因为我设置的循环试图访问不存在的值，但是我如何允许输入未知的行和列大小？我只知道如何使用单个列表来执行此操作，但是列表列表？这是函数，不包括调用它的测试函数：

```
def inverse_graph(graph):
    # take in graph
    # change all zeros to ones and ones to zeros

    r, c = 0, 0 # row, column equal zero

    while (graph[r][c] == 0 or graph[r][c] == 1): # while the current row has a value.
        while (graph[r][c] == 0 or graph[r][c] == 1): # while the current column has a value
            if (graph[r][c] == 0):
                graph[r][c] = 1
            elif (graph[r][c] == 1):
                graph[r][c] = 0
            c+=1
        c=0
        r+=1

    c=0
    r=0

    # sets diagonal to zeros

    while (g1[r][c] == 0 or g1[r][c] == 1):
        g1[r][c]=0
        c+=1
        r+=1

    return graph 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:53:43.033

这并不能直接回答您的问题，但我想指出，在 Python 中，您通常可以通过使用
    `for <element> in <container>:`
语句来减少甚至有时消除使用索引的需要。通过与内置`enumerate()`函数一起使用，可以同时获取索引和对应的元素
    `for <index>,<element> in enumerate(<container>):`

将它们应用于您的问题将允许这样的事情：

```
g1 = [[0, 1, 1, 0],
      [1, 0, 0, 1],
      [1, 0, 0, 1],
      [0, 1, 1, 0]]

def inverse_graph(graph):
    """ invert zeroes and ones in a square graph
        but force diagonal elements to be zero
    """
    for i,row in enumerate(graph):
        for j,cell in enumerate(row):
            row[j] = 0 if cell or i == j else 1
    return graph

print(g1)
print(inverse_graph(g1)) 
```

输出：

```
[[0, 1, 1, 0], [1, 0, 0, 1], [1, 0, 0, 1], [0, 1, 1, 0]]
[[0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0]] 
```

哪个更简单，也更有效。另一点是，由于您将该函数应用于可变（可变）容器，列表列表，因此实际上不需要返回容器，因为它正在就地更改。这样做并没有错，因为它可以使函数的使用变得更容易，但这是您可能没有意识到的。

您可以通过使用称为 a 的东西来进一步缩短函数并完全消除索引[`list comprehension`](http://docs.python.org/2/reference/expressions.html?highlight=list_comprehension#list-displays)：

```
def inverse_graph(graph):
    return [[0 if cell or i == j else 1
                for j,cell in enumerate(row)]
                    for i,row in enumerate(graph)] 
```

由于它们的工作方式，此版本不会就地更改图形，而是创建并返回一个新图形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:25:58.527

```
while (graph[r][c] == 0 or graph[r][c] == 1): # while the current row has a value. 
```

在将其 -possible- 值与 0 或 1 进行比较之前，您必须首先确保两个索引都存在。这会导致您的异常。要反转矩阵，您需要执行类似的操作

```
for row in graph:
    for idx, v in enumerate (row):
        row [idx] = 0 if v else 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:26:27.917

错误在于您的“当前行有值”。当您遍历行中的元素时，这将始终是正确的，当您越过它们时，您将得到异常。

相反，使用：

```
for r in range(len(graph):
    for c in range(len(graph[0]):
        # do something with graph[r][c] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T22:28:13.580

这相当简单。基本上你需要找到数组中元素的数量

```
 mylist = [1,2,3,4,5]
 len(mylist) # returns 5
 #this gives the number of elements.
 rows=len(g1) # get the number of rows
 columns=len(g1[0]) #get the number of columns
 #Now iterate over the number of rows and columns
 for r in range(0, rows):
    for c in range (0,columns):
       if (r==c):
              g1[r][c]=0
       else:
           g1[r][c]=1-g1[r][c] 
```

希望有帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-08T22:30:33.487

不是您问题的答案，但这是一种“简单”的方法

`return [[0 if i2==i else 1 if item == 0 else 0 for i2,item in enumerate(row)] for i,row in graph]`

# javascript - 如何操作数组中的对象？

> ID：13782525
> 
> 赞同：-1
> 
> 时间：2012-12-08T22:20:55.187
> 
> 标签：javascript, jquery, arrays

我得到了两个数组，每个数组中都有几个对象。我正在努力做到这一点，以便在进行某个下拉选择时，将“航班信息”推送到“航班摘要”div中，但我很难弄清楚如何去做。

```
var possibleDepartureFlights=[{year:2012,month:11,day:13,hour:17,minute:37,price:137.38} and so on]; 

var possibleReturnFlights=[{year:2012,month:11,day:18,hour:21,minute:45,price:189.46} and so on]; 
```

每个 var 在数组中有 10 个对象，每个对象都具有所有这些属性。

作为一个奖励问题，我已经弄清楚如何在选择的返回飞行比出发时间早时隐藏“提交”按钮，但是我不知道如何在选择其他选择时返回。制成！

```
function displayDivs() {
var departureValue = $('#departureFlightsControl').val();
var returnValue = $('#returnFlightsControl').val();
if (departureValue != "default") {
    $('.CumulativeSummary').addClass('totalAvailable');
    $('.DepartureSummary').addClass('flightChosen');
}
if (returnValue != "default") {
    $('.CumulativeSummary').addClass('totalAvailable');
    $('.ReturnSummary').addClass('flightChosen');
}
if ($('#returnFlightsControl').val() < $('#departureFlightsControl').val()) {
    $('.SubmitArea').hide();
} 
```

对不起，如果这个问题含糊不清！我是 jQuery 和 JavaScript 的新手，所以我不太确定自己在做什么（而且我什至不确定谷歌是用什么来找到我的问题的答案）。请使用小词，就像在和孩子说话一样。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:14:59.437

无论如何，你的问题真的太宽泛了......假设你有以下

```
var possibleDepartureFlights=[
    {year:2012,month:10,day:13,hour:10,minute:37,price:137.38}, 
    {year:2012,month:11,day:15,hour:17,minute:47,price:150.50} 
]; 
```

这`possibleDepartureFlights`是一个由两个对象组成的数组，数组的第一个元素是第一个对象，`{year:2012,month:10,day:13,hour:10,minute:37,price:137.38}`它的索引是`0`，数组中的第二个元素`possibleDepartureFlights`是第二个对象，`{year:2012,month:11,day:15,hour:17,minute:47,price:150.50}`它的索引是`1`。现在，如果你想访问`month`数组第一项的属性，那么你可以这样写

```
alert(possibleDepartureFlights[0].month); // this will alert 10 
```

对于`month`数组中的第二个项目/对象，您可以编写

```
 alert(possibleDepartureFlights[1].month); // this will alert 11 
```

要循环`array`并打印出每个对象的每个属性，您可以试试这个

```
for(i=0;i<possibleDepartureFlights.length;i++)
{
    console.log(possibleDepartureFlights[i].year);
    console.log(possibleDepartureFlights[i].month);
    console.log(possibleDepartureFlights[i].hour);
    console.log(possibleDepartureFlights[i].minute);
    console.log(possibleDepartureFlights[i].price);
} 
```

[**这里有一个例子。**](http://jsfiddle.net/unx3L/)

请记住，这只是一个简短的示例，还有更多关于[数组](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)和[对象](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Working_with_Objects)的内容`JavaScript`。还要记住，您可以`loop`使用[for in](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)像[for loop](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)一样的对象。[这个](http://vocamus.net/dave/?p=1205)也可能有帮助。

# iphone - 使用 NSThread 进行多线程

> ID：13782528
> 
> 赞同：0
> 
> 时间：2012-12-08T22:21:49.237
> 
> 标签：iphone, objective-c, multithreading, cocoa, nsthread

我是新手，所以请原谅我的任何错误...

我的情况：

```
- (id)initWith... //Some arguments 
```

有一个返回对象的初始化方法。用参数的值设置它的实例变量做了很多工作。为了最大限度地提高性能，我将工作分成两个线程。一个线程设置一组相关变量，另一个线程设置另一组变量。

```
- (id)initWith:arguments {
self = [super init];
if (self) {
[NSThread detachNewThreadSelector:@selector(setFirstSetOfVariables:) toTarget:self withObject:argObject];
[self setSecondSetOfVariables:arguments];
//Check if the thread finished its work and return the value
return self;
} 
```

为了方便起见，认为该方法必须设置的两组 var 没有任何关系。那么我的问题是：如何检查第一个线程是否完成？我可以创建一个 BOOL var，但我必须创建一个循环来检查。我也可以调用一个方法来表示它已经准备好了。但由于我不太了解，我不知道在线程内部调用的方法是在主线程中运行还是在另一个线程中运行。对不起。感谢您提供任何信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:38:15.700

你可以这样做来简化整个事情

```
ComplicatedObject *myComplicatedObject = [ComplicatedObject alloc] init;

[myComplicatedObject setLongTimeTakingVariables]; 
```

并在 ComplicatedObject 中创建一个类似的方法

```
-(void)setLongTimeTakingVariables{
  dispatch_async(dispatch_get_global_queue(),^{ All of your code can go here. Infact you need not split it into two sections, because it will happen in the background and your userinterface will not get affected } 
```

但是如果你想分裂，那么你可以做

```
 dispatch_async(dispatch_get_global_queue((DISPATCH_QUEUE_PRIORITY_LOW, 0)),^{  
                   some work here
     }

    dispatch_async(dispatch_get_global_queue((DISPATCH_QUEUE_PRIORITY_LOW, 0)),'{
                    some other work here
    } 
```

阅读并发编程指南，每件事都解释得很清楚。

# php - 防止 gettext 翻译

> ID：13782529
> 
> 赞同：0
> 
> 时间：2012-12-08T22:21:51.093
> 
> 标签：php, gettext

变量 $status 被分配了字符串值 'stop' 或 'go'（在 php 操作中）。

在视图中，我想以这样一种方式显示 $status 的值：“stop”显示为红色，“go”显示为绿色。

所以我写了类似的东西：

```
<span class="<?=$status?>"><?= $status?></span> 
```

并在我的 CSS 中定义了类“stop/go”。一切正常，直到我通过在操作中将字符串包装在 _() 中开始使其成为多语言。现在 gettext 不仅翻译实际显示的字符串，而且翻译类名（我不想要）。有没有类似ungettext的东西，所以我可以写：

```
<span class="<?=ungettext($status)?>"><?= $status?></span> 
```

并获得未翻译的类名？

我意识到我可以从操作中发送一个 bool 并在视图中使用 if 语句来创建我想要的。或者（更难看）我可以在 css 中添加翻译的类名。但是有没有更优雅的方式呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T22:30:17.217

我觉得你想多了这个问题。为什么不简单地在动作中创建另一个变量，比如 $status_stye，你不应用翻译呢？这样你就有了你想要的 CSS 类和文本的翻译版本。

# build - Sublime Text 构建找不到 SDL 目录

> ID：13782530
> 
> 赞同：2
> 
> 时间：2012-12-08T22:21:53.980
> 
> 标签：build, sdl, sublimetext2

试图将 Sublime 上的构建系统引导到我的 SDL 目录但不会编译

```
{
"cmd": ["g++", "${file}", "-o", "${file_path}/${file_base_name}", "-L/usr/include/SDL", "-lSDLmain", "-lSDL", "-lSDL_ttf", "-lSDL_image"],
"file_regex": "^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$",
"working_dir": "${file_path}",
"selector": "source.c, source.c++",

"variants":
[
    {
        "name": "Run",
        "cmd": ["bash", "-c", "g++ '${file}' -o '${file_path}/${file_base_name}' && '${file_path}/${file_base_name}'"]
    }
]
} 
```

继续让我对 SDL 的所有调用都返回未定义的引用。似乎无法在命令上正确调用目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:35:43.557

似乎您使用的链接器路径不正确。`/usr/include/`里面只有头文件。

所以我想你应该通过以下方式修改它：

```
-L<Where libraries are placed> 
```

例如在 Ubuntu 中：

```
-L/usr/lib/x86_64-linux-gnu // 64 bit libraries
-L/usr/lib/i386-linux-gnu   // 32 bit libraries 
```

为了让编译器新的头目录你应该使用`-I`标志：

```
-I/usr/include 
```

# python - python3中的循环拼凑

> ID：13782540
> 
> 赞同：0
> 
> 时间：2012-12-08T22:23:05.020
> 
> 标签：python, python-3.x

我需要在 Python 3 中创建拼凑。我剩下要做的就是创建一个循环，使设计边框成为图形窗口。我知道我需要一个 for 循环，但我不知道该怎么做。

这是我到目前为止所拥有的：

```
from graphics import *

def main():
    height = eval(input("What is the height of the window"))
    width = eval(input("What is the width of the window"))
    colour = input("enter the colour of the patch")
    win = GraphWin("Patch", 100*width, 100*height)
    boat_x = 0
    boat_y = 0
    for x in range (4):
         boat(win, boat_x, boat_y, colour)
         boat_x = boat_x + 23
    for i in range(height * 5):
         boat(win, boat_x, boat_y, colour)
         boat_x = boat_x + 24
    for j in range(height * 5):
         boat(win, boat_x, boat_y, colour)
         boat_y = boat_y + 100
    win.getMouse()
    win.close()

def boat(win, x, y, colour):
    body1 = Polygon(Point(1+x,95+y), Point(5+x,100+y),
                Point(20+x,100+y), Point(24+x,95+y))
    body1.draw(win)
    line1 = Line(Point(13+x,95+y), Point(13+x,90+y))
    line1.draw(win)
    sail1 = Polygon(Point(1+x,90+y), Point(24+x,90+y), Point(13+x, 73+y))
    sail1.setFill(colour)
    sail1.draw(win)
    body2 = Polygon(Point(1+x, 63), Point(5+x, 68),
                        Point(20+x,68), Point(24+x,63))
    body2.draw(win)
    line2 = Line(Point(13+x,63), Point(13+x,58))
    line2.draw(win)
    sail2 = Polygon(Point(1+x,58), Point(24+x, 58), Point(13+x,40))
    sail2.setFill(colour)
    sail2.draw(win)
    body3 = Polygon(Point(1+x,28), Point(5+x,33),
                        Point(20+x,33), Point(24+x, 28))
    body3.draw(win)
    line3 = Polygon(Point(13+x,28), Point(13+x,23))
    line3.draw(win)
    sail3 = Polygon(Point(1+x,23), Point(24+x, 23), Point(13+x, 5))
    sail3.setFill(colour)
    sail3.draw(win)

main() 
```

到目前为止，这创建了顶部边框，但没有别的。我也知道船功能不是最有效的绘图方式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:49:32.200

当您说您需要“使设计边框成为图形窗口”时，我假设您希望您的`boat`设计沿着窗口的每个边缘（即顶部、底部、左侧和右侧）重复几次。

这应该在两个循环中是可行的。一个将绘制顶部和底部边缘，另外两个将绘制左右边缘。我不太确定你的绘图代码是如何工作的，所以我在这里猜测一些偏移量：

```
top = 0
bottom = (height-1) * 100

for x in range(0, width*100, 25):
    boat(x, top, colour)
    boat(x, bottom, colour)

left = 0
right = width * 100 - 25

for y in range(100, (height-1)*100, 100):
    boat(left, y, colour)
    boat(right, y, colour) 
```

这应该`boat`在顶部和底部每 25 个像素以及左右边缘每 100 个像素调用一次子例程。调整循环中调用中的`top`、`bottom`、`left`和`right`值和参数，`range`使间距适合您的需要（我只是编造的）。此代码避免了两次绘制角项目，但取决于绘制例程的工作方式，这可能不是必需的。

# android - 没有为可展开列表视图的子项显示上下文菜单

> ID：13782543
> 
> 赞同：0
> 
> 时间：2012-12-08T22:23:14.623
> 
> 标签：android, contextmenu, expandablelistview

我的活动中有一个可扩展的列表视图。我想为孩子们展示一个上下文菜单。基本上我知道如何做到这一点，但是在实现上下文菜单时，它永远不会出现在子视图中。只是长时间点击组视图，我没有找到这种行为的原因。有什么想法吗？提前致谢！

设置可展开的列表视图：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    View v = inflater.inflate(R.layout.listed_data, container, false);
    parser = new SvwXmlparser("a", getSherlockActivity());
    elv = (ExpandableListView) v.findViewById(R.id.svwexplist);
    return v;

}
public void onActivityCreated(Bundle savedInstanceState)
{
    super.onActivityCreated(savedInstanceState);
    registerForContextMenu(elv);
    infos = parser.parse();
    showData();
}
public void showData()
{
    adapter = new SvwInfoAdapter(getSherlockActivity(), infos);
    elv.setAdapter(adapter);
} 
```

适配器：

```
public Object getChild(int groupPos, int childPos) {
    return children.get(groupPos).get(childPos);
}

public long getChildId(int groupPos, int childPos) {
    return childPos;
}

public View getChildView(int groupPosition, int childPosition, boolean isLastChild,
        View convertView, ViewGroup parent) {
    //TODO:modify
    String player = (String)getChild(groupPosition, childPosition);
     if (convertView == null) {
            LayoutInflater infalInflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = infalInflater.inflate(R.layout.svw_team_child_layout, null);
        }
     convertView.setFocusableInTouchMode(true);
     TextView players = (TextView) convertView.findViewById(R.id.tvteamChild);
     /*if(childPosition> 1)
     {
         players.setText((childPosition-1) + ". " + player);
     }
     else
     {
         players.setText(player);
     }*/
     players.setText(player);
    return convertView;
}

public int getChildrenCount(int groupPos) {
    return children.get(groupPos).size();
}

public boolean isChildSelectable(int arg0, int arg1) {
    return true;
} 
```

创建上下文菜单：

```
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo)
{
    super.onCreateContextMenu(menu, v, menuInfo);

    ExpandableListContextMenuInfo info = (ExpandableListContextMenuInfo) menuInfo;
    int groupPos = ExpandableListView.getPackedPositionGroup(info.packedPosition);
    int childPos = ExpandableListView.getPackedPositionChild(info.packedPosition);
    int type = ExpandableListView.getPackedPositionType(info.packedPosition);
    Toast toas =Toast.makeText(getSherlockActivity(), groupPos + " - " + childPos, Toast.LENGTH_LONG);
    toas.show(); 
```

祝酒会为每个小组展示，但不是为孩子们...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T15:18:41.190

我终于想通了......在xml中设置touchable = false是行不通的。在适配器的 getView 方法中为组和子视图调用 setTouchable(false) 后，一切都按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-23T15:54:45.243

我遇到了同样的问题。上述解决方案对我不起作用。我找到了一个简单的解决方案！

这对我有帮助：

在我的 ExpandableListAdapter 方法中：

```
public View getChildView(int groupPosition, final int childPosition,boolean isLastChild, View concertView, ViewGroup parent) {
    ... 
    concertView.setLongClickable( true); 
```

# python - Blender 2.6 JSON 导出器，仅立方体一侧的纹理错误

> ID：13782547
> 
> 赞同：8
> 
> 时间：2012-12-08T22:24:01.733
> 
> 标签：python, json, opengl, webgl, blender

我正在为自定义 JSON 格式（主要用于 WebGL）制作一个简单的 Blender 2.6x 导出器，因为我可以在网上找到的现有导出器不适用于 Blender 2.6。

我几乎让它工作了，但仍然有一个我无法弄清楚的错误。在一个简单的立方体上，其一侧的纹理方向错误。立方体的其余部分纹理正确。

您可以在此处看到问题的图片（与右侧的正确立方体相比，左侧的左侧面方向错误）：

![错误](../Images/eb725b3af9c94b5d8a48a45ebd3a4b5f.png)

是否有一些常见的误解或错误可能导致这种行为发生？

这是从 Blender 2.65 导出到我的自定义 JSON 格式的函数（错误必须在这里，但我找不到它）：

```
def get_json(objects, scene):
    """ Currently only supports one scene. 
        Exports with -Z forward, Y up. """

    object_number = -1
    scene_data = []

    # for every object in the scene
    for object in bpy.context.scene.objects:

        # if the object is a mesh       
        if object.type == 'MESH':

            object_number += 1

            # convert all the mesh's faces to triangles
            bpy.ops.object.mode_set(mode='OBJECT')
            object.select = True
            bpy.context.scene.objects.active = object

            # triangulate using new Blender 2.65 Triangulate modifier
            bpy.ops.object.modifier_add(type='TRIANGULATE')
            object.modifiers["Triangulate"].use_beauty = False
            bpy.ops.object.modifier_apply(apply_as="DATA", modifier="Triangulate")

            bpy.ops.object.mode_set(mode='OBJECT')

            object.select = False

            # add data to scene_data structure
            scene_data.append({
                "name"          : object.name,
                "vertices"      : [],
                "indices"       : [],
                "normals"       : [],
                "tex_coords"    : []
            })

            vertex_number = -1

            # for each face in the object
            for face in object.data.polygons:
                vertices_in_face = face.vertices[:]

                # for each vertex in the face
                for vertex in vertices_in_face:

                    vertex_number += 1

                    # store vertices in scene_data structure
                    scene_data[object_number]["vertices"].append( object.data.vertices[vertex].co.x + object.location.x )
                    scene_data[object_number]["vertices"].append( object.data.vertices[vertex].co.z + object.location.z )
                    scene_data[object_number]["vertices"].append( -(object.data.vertices[vertex].co.y + object.location.y) )

                    # store normals in scene_data structure
                    scene_data[object_number]["normals"].append( object.data.vertices[vertex].normal.x )
                    scene_data[object_number]["normals"].append( object.data.vertices[vertex].normal.z )
                    scene_data[object_number]["normals"].append( -(object.data.vertices[vertex].normal.y) )

                    # store indices in scene_data structure
                    scene_data[object_number]["indices"].append(vertex_number)

            # texture coordinates
            #   bug: for a simple cube, one face's texture is warped
            mesh = object.to_mesh(bpy.context.scene, True, 'PREVIEW')
            if len(mesh.tessface_uv_textures) > 0:
                for data in mesh.tessface_uv_textures.active.data:
                    scene_data[object_number]["tex_coords"].append( data.uv1.x )
                    scene_data[object_number]["tex_coords"].append( data.uv1.y )
                    scene_data[object_number]["tex_coords"].append( data.uv2.x )
                    scene_data[object_number]["tex_coords"].append( data.uv2.y )
                    scene_data[object_number]["tex_coords"].append( data.uv3.x )
                    scene_data[object_number]["tex_coords"].append( data.uv3.y )

    return json.dumps(scene_data, indent=4) 
```

如果这有助于弄清楚，这里是运行我的导出脚本产生的导出 JSON 数据（用于呈现上图中左侧多维数据集的相同数据）：

```
[
    {
        "vertices": [
            -1.0203653573989868, 
            1.0320179611444473, 
            0.669445663690567, 
            -1.0203653573989868, 
            1.0320179611444473, 
            -1.330554336309433, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            0.669445663690567, 
            -1.0203653573989868, 
            1.0320179611444473, 
            -1.330554336309433, 
            0.9796346426010132, 
            1.0320179611444473, 
            -1.330554336309433, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            -1.330554336309433, 
            0.9796346426010132, 
            1.0320179611444473, 
            -1.330554336309433, 
            0.9796346426010132, 
            1.0320179611444473, 
            0.669445663690567, 
            0.9796346426010132, 
            -0.9679820388555527, 
            -1.330554336309433, 
            0.9796346426010132, 
            1.0320179611444473, 
            0.669445663690567, 
            -1.0203653573989868, 
            1.0320179611444473, 
            0.669445663690567, 
            0.9796346426010132, 
            -0.9679820388555527, 
            0.669445663690567, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            0.669445663690567, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            -1.330554336309433, 
            0.9796346426010132, 
            -0.9679820388555527, 
            0.669445663690567, 
            0.9796346426010132, 
            1.0320179611444473, 
            0.669445663690567, 
            0.9796346426010132, 
            1.0320179611444473, 
            -1.330554336309433, 
            -1.0203653573989868, 
            1.0320179611444473, 
            0.669445663690567, 
            -1.0203653573989868, 
            1.0320179611444473, 
            -1.330554336309433, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            -1.330554336309433, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            0.669445663690567, 
            0.9796346426010132, 
            1.0320179611444473, 
            -1.330554336309433, 
            0.9796346426010132, 
            -0.9679820388555527, 
            -1.330554336309433, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            -1.330554336309433, 
            0.9796346426010132, 
            1.0320179611444473, 
            0.669445663690567, 
            0.9796346426010132, 
            -0.9679820388555527, 
            0.669445663690567, 
            0.9796346426010132, 
            -0.9679820388555527, 
            -1.330554336309433, 
            -1.0203653573989868, 
            1.0320179611444473, 
            0.669445663690567, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            0.669445663690567, 
            0.9796346426010132, 
            -0.9679820388555527, 
            0.669445663690567, 
            -1.0203653573989868, 
            -0.9679820388555527, 
            -1.330554336309433, 
            0.9796346426010132, 
            -0.9679820388555527, 
            -1.330554336309433, 
            0.9796346426010132, 
            -0.9679820388555527, 
            0.669445663690567, 
            0.9796346426010132, 
            1.0320179611444473, 
            -1.330554336309433, 
            -1.0203653573989868, 
            1.0320179611444473, 
            -1.330554336309433, 
            -1.0203653573989868, 
            1.0320179611444473, 
            0.669445663690567
        ], 
        "normals": [
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            -0.5773491859436035, 
            -0.5773491859436035, 
            0.5773491859436035, 
            0.5773491859436035
        ], 
        "indices": [
            0, 
            1, 
            2, 
            3, 
            4, 
            5, 
            6, 
            7, 
            8, 
            9, 
            10, 
            11, 
            12, 
            13, 
            14, 
            15, 
            16, 
            17, 
            18, 
            19, 
            20, 
            21, 
            22, 
            23, 
            24, 
            25, 
            26, 
            27, 
            28, 
            29, 
            30, 
            31, 
            32, 
            33, 
            34, 
            35
        ], 
        "name": "Cube", 
        "tex_coords": [
            0.008884529583156109, 
            0.6587533354759216, 
            0.3244488537311554, 
            0.3412468135356903, 
            0.32541996240615845, 
            0.657782256603241, 
            0.008884510956704617, 
            0.32541996240615845, 
            0.007913422770798206, 
            0.008884549140930176, 
            0.32541996240615845, 
            0.3244488537311554, 
            0.9920865893363953, 
            0.32444891333580017, 
            0.675551176071167, 
            0.32541996240615845, 
            0.9911155700683594, 
            0.00791349820792675, 
            0.3412467837333679, 
            0.008884538896381855, 
            0.6577821969985962, 
            0.007913422770798206, 
            0.34221789240837097, 
            0.32541996240615845, 
            0.6587532758712769, 
            0.6577821969985962, 
            0.3422178626060486, 
            0.6587533354759216, 
            0.6577821373939514, 
            0.3412468135356903, 
            0.6745801568031311, 
            0.34221789240837097, 
            0.9911155700683594, 
            0.3412468135356903, 
            0.6755512356758118, 
            0.6587533354759216, 
            0.007913460955023766, 
            0.34221789240837097, 
            0.3244488537311554, 
            0.3412468135356903, 
            0.008884529583156109, 
            0.6587533354759216, 
            0.007913422770798206, 
            0.008884549140930176, 
            0.324448823928833, 
            0.007913422770798206, 
            0.32541996240615845, 
            0.3244488537311554, 
            0.675551176071167, 
            0.32541996240615845, 
            0.6745801568031311, 
            0.008884529583156109, 
            0.9911155700683594, 
            0.00791349820792675, 
            0.6577821969985962, 
            0.007913422770798206, 
            0.6587533354759216, 
            0.3244488835334778, 
            0.34221789240837097, 
            0.32541996240615845, 
            0.3422178626060486, 
            0.6587533354759216, 
            0.3412467837333679, 
            0.34221789240837097, 
            0.6577821373939514, 
            0.3412468135356903, 
            0.9911155700683594, 
            0.3412468135356903, 
            0.99208664894104, 
            0.6577821969985962, 
            0.6755512356758118, 
            0.6587533354759216
        ]
    }
] 
```

我目前并没有寻找方法来制作更好的功能更丰富或更高效的导出器，而是我只想最终解决这个错误，以便我可以继续做更有趣的事情，比如制作 WebGL 游戏，并了解碰撞检测等。对于我遇到的这个问题的任何帮助或建议将不胜感激！

**编辑：**

万一这可能是我的渲染代码，而不是问题的导出器，这里是我的 WebGL 代码中与初始化缓冲区和绘制场景相关的部分（在[http://learningwebgl.com](http://learningwebgl.com)找到的一些代码的修改版本):

```
var gl;

var current_shader_program;
var per_vertex_shader_program;
var per_fragment_shader_program;

var modelview_matrix = mat4.create();
var modelview_matrix_stack = [];
var projection_matrix = mat4.create();

var teapot_vertex_position_buffer = new Array();
var teapot_vertex_tex_coord_buffer = new Array();
var teapot_vertex_normal_buffer = new Array();
var teapot_vertex_index_buffer = new Array();

var earth_texture;
var galvanized_texture;

var teapot_angle = 180;

var last_time = 0;

function createProgram(vertex_shader_filename, fragment_shader_filename) {
    var vertex_shader_text = readFromUrl(vertex_shader_filename);
    var fragment_shader_text = readFromUrl(fragment_shader_filename);

    var vertex_shader = gl.createShader(gl.VERTEX_SHADER);
    var fragment_shader = gl.createShader(gl.FRAGMENT_SHADER);

    gl.shaderSource(vertex_shader, vertex_shader_text);
    gl.shaderSource(fragment_shader, fragment_shader_text);

    gl.compileShader(vertex_shader);
    if (!gl.getShaderParameter(vertex_shader, gl.COMPILE_STATUS)) {
        alert(gl.getShaderInfoLog(vertex_shader));
    }

    gl.compileShader(fragment_shader);
    if (!gl.getShaderParameter(fragment_shader, gl.COMPILE_STATUS)) {
        alert(gl.getShaderInfoLog(fragment_shader));
    }

    var shader_program = gl.createProgram();
    gl.attachShader(shader_program, vertex_shader);
    gl.attachShader(shader_program, fragment_shader);
    gl.linkProgram(shader_program);

    if (!gl.getProgramParameter(shader_program, gl.LINK_STATUS)) {
        alert("Error: Unable to link shaders!");
    }

    shader_program.vertex_position_attribute = 
        gl.getAttribLocation(shader_program, "a_vertex_position");
    gl.enableVertexAttribArray(shader_program.vertex_position_attribute);

    shader_program.vertex_normal_attribute =
        gl.getAttribLocation(shader_program, "a_vertex_normal");
    gl.enableVertexAttribArray(shader_program.vertex_normal_attribute);

    shader_program.tex_coord_attribute = 
        gl.getAttribLocation(shader_program, "a_tex_coord");
    gl.enableVertexAttribArray(shader_program.tex_coord_attribute);

    shader_program.projection_matrix_uniform = 
        gl.getUniformLocation(shader_program, "u_projection_matrix");
    shader_program.modelview_matrix_uniform = 
        gl.getUniformLocation(shader_program, "u_modelview_matrix");
    shader_program.normal_matrix_uniform =
        gl.getUniformLocation(shader_program, "u_normal_matrix");
    shader_program.sampler_uniform = 
        gl.getUniformLocation(shader_program, "u_sampler");
    shader_program.material_shininess_uniform = 
        gl.getUniformLocation(shader_program, "u_material_shininess");
    shader_program.show_specular_highlights_uniform = 
        gl.getUniformLocation(shader_program, "u_show_specular_highlights");
    shader_program.use_textures_uniform =
        gl.getUniformLocation(shader_program, "u_use_textures");
    shader_program.use_lighting_uniform =
        gl.getUniformLocation(shader_program, "u_use_lighting");
    shader_program.ambient_color_uniform =
        gl.getUniformLocation(shader_program, "u_ambient_color");
    shader_program.point_lighting_location_uniform = 
        gl.getUniformLocation(shader_program, "u_point_lighting_location");
    shader_program.point_lighting_specular_color_uniform =
        gl.getUniformLocation(shader_program, "u_point_lighting_specular_color");
    shader_program.point_lighting_diffuse_color_uniform =
        gl.getUniformLocation(shader_program, "u_point_lighting_diffuse_color");

    return shader_program;
}

function initShaders() {
    per_fragment_shader_program = createProgram("per_fragment_lighting.vs", "per_fragment_lighting.fs");

}

function handleLoadedTexture(texture) {
    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);

    gl.bindTexture(gl.TEXTURE_2D, texture);
    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE,
        texture.image);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
    gl.generateMipmap(gl.TEXTURE_2D);

    gl.bindTexture(gl.TEXTURE_2D, null);
}

function initTextures() {
    earth_texture = gl.createTexture();
    earth_texture.image = new Image();
    earth_texture.image.onload = function() {
        handleLoadedTexture(earth_texture);
    }
    earth_texture.image.src = "earth.jpg";

    galvanized_texture = gl.createTexture();
    galvanized_texture.image = new Image();
    galvanized_texture.image.onload = function() {
        handleLoadedTexture(galvanized_texture);
    };
    galvanized_texture.image.src = "galvanized.jpg";
}

function setMatrixUniforms() {
    gl.uniformMatrix4fv(current_shader_program.projection_matrix_uniform, false, 
        projection_matrix);
    gl.uniformMatrix4fv(current_shader_program.modelview_matrix_uniform, false, 
        modelview_matrix);

    var normal_matrix = mat3.create();
    mat4.toInverseMat3(modelview_matrix, normal_matrix);
    mat3.transpose(normal_matrix);
    gl.uniformMatrix3fv(current_shader_program.normal_matrix_uniform, false, 
        normal_matrix);
}

function handleLoadedTeapot(teapot_data) {

    for (var i = 0; i < teapot_data.length; i++)
    {
        teapot_vertex_normal_buffer[i] = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, teapot_vertex_normal_buffer[i]);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(teapot_data[i].normals), 
            gl.STATIC_DRAW);
        teapot_vertex_normal_buffer[i].item_size = 3;
        teapot_vertex_normal_buffer[i].num_items = 
            teapot_data[i].normals.length / teapot_vertex_normal_buffer[i].item_size;

        teapot_vertex_tex_coord_buffer[i] = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, teapot_vertex_tex_coord_buffer[i]);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(teapot_data[i].tex_coords), 
            gl.STATIC_DRAW);
        teapot_vertex_tex_coord_buffer[i].item_size = 2;
        teapot_vertex_tex_coord_buffer[i].num_items = 
            teapot_data[i].tex_coords.length / teapot_vertex_tex_coord_buffer[i].item_size;

        teapot_vertex_position_buffer[i] = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, teapot_vertex_position_buffer[i]);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(teapot_data[i].vertices), 
            gl.STATIC_DRAW);
        teapot_vertex_position_buffer[i].item_size = 3;
        teapot_vertex_position_buffer[i].num_items = 
            teapot_data[i].vertices.length / teapot_vertex_position_buffer[i].item_size;

        teapot_vertex_index_buffer[i] = gl.createBuffer();
        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, teapot_vertex_index_buffer[i]);
        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(teapot_data[i].indices), 
            gl.STATIC_DRAW)
        teapot_vertex_index_buffer[i].item_size = 1;
        teapot_vertex_index_buffer[i].num_items = 
            teapot_data[i].indices.length / teapot_vertex_index_buffer[i].item_size;
    }

    document.getElementById("loading_text").textContent = "";
}

function loadTeapot() {
    var request = new XMLHttpRequest();
    request.open("GET", "untitled.json");
    request.onreadystatechange = function() {
        if (request.readyState == 4) {
            handleLoadedTeapot(JSON.parse(request.responseText));
        }
    };
    request.send();
}

function drawScene() {

    gl.viewport(0, 0, gl.viewportWidth, gl.viewportHeight);
    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

    if (teapot_vertex_position_buffer[0] == null    || 
        teapot_vertex_normal_buffer[0] == null      || 
        teapot_vertex_tex_coord_buffer[0] == null   || 
        teapot_vertex_index_buffer[0] == null) {
        return;
    }

    current_shader_program = per_fragment_shader_program;
    gl.useProgram(current_shader_program);

    var specular_highlights = document.getElementById("specular").checked;
    gl.uniform1i(current_shader_program.show_specular_highlights_uniform, specular_highlights);

    var lighting = document.getElementById("lighting").checked;
    gl.uniform1i(current_shader_program.use_lighting_uniform, lighting);

    if (lighting) {
        gl.uniform3f(current_shader_program.ambient_color_uniform,
            parseFloat(document.getElementById("ambient_r").value),
            parseFloat(document.getElementById("ambient_g").value),
            parseFloat(document.getElementById("ambient_b").value));

        gl.uniform3f(current_shader_program.point_lighting_location_uniform,
            parseFloat(document.getElementById("light_pos_x").value),
            parseFloat(document.getElementById("light_pos_y").value),
            parseFloat(document.getElementById("light_pos_z").value));

        gl.uniform3f(current_shader_program.point_lighting_specular_color_uniform,
            parseFloat(document.getElementById("specular_r").value),
            parseFloat(document.getElementById("specular_g").value),
            parseFloat(document.getElementById("specular_b").value));

        gl.uniform3f(current_shader_program.point_lighting_diffuse_color_uniform,
            parseFloat(document.getElementById("diffuse_r").value),
            parseFloat(document.getElementById("diffuse_g").value),
            parseFloat(document.getElementById("diffuse_b").value));
    }

    var texture = document.getElementById("texture").value;
    gl.uniform1i(current_shader_program.use_textures_uniform, texture != "none");

    mat4.identity(modelview_matrix);
    mat4.translate(modelview_matrix, [0, 0, -10]);

    mat4.rotate(modelview_matrix, degToRad(23.4), [1, 0, 0]);
    mat4.rotate(modelview_matrix, degToRad(teapot_angle), [0, 1, 0]);

    gl.activeTexture(gl.TEXTURE0);
    if (texture == "earth") {
        gl.bindTexture(gl.TEXTURE_2D, earth_texture);
    }
    else if (texture == "galvanized") {
        gl.bindTexture(gl.TEXTURE_2D, galvanized_texture);
    }
    gl.uniform1i(current_shader_program.sampler_uniform, 0);

    gl.uniform1f(current_shader_program.material_shininess_uniform, 
        parseFloat(document.getElementById("shininess").value));

    for (var i = 0; i < teapot_vertex_position_buffer.length; i++)
    {
        gl.bindBuffer(gl.ARRAY_BUFFER, teapot_vertex_position_buffer[i]);
        gl.vertexAttribPointer(current_shader_program.vertex_position_attribute,
            teapot_vertex_position_buffer[i].item_size, gl.FLOAT, false, 0, 0);

        gl.bindBuffer(gl.ARRAY_BUFFER, teapot_vertex_tex_coord_buffer[i]);
        gl.vertexAttribPointer(current_shader_program.tex_coord_attribute,
            teapot_vertex_tex_coord_buffer[i].item_size, gl.FLOAT, false, 0, 0);

        gl.bindBuffer(gl.ARRAY_BUFFER, teapot_vertex_normal_buffer[i]);
        gl.vertexAttribPointer(current_shader_program.vertex_normal_attribute,
            teapot_vertex_normal_buffer[i].item_size, gl.FLOAT, false, 0, 0);

        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, teapot_vertex_index_buffer[i]);

        setMatrixUniforms();
        gl.drawElements(gl.TRIANGLES, teapot_vertex_index_buffer[i].num_items, 
            gl.UNSIGNED_SHORT, 0);
    }
} 
```

我知道要查看的内容太多了，这就是为什么我之前没有发布它，但是有人建议渲染代码可能有问题。请注意，代码中提到的“茶壶”实际上是导出的模型（我要渲染的立方体）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T08:33:22.840

正如 ejrowley 评论的那样，您的顶点和纹理坐标的索引未对齐。

`to_mesh` *在导出顶点后*使用也会导致很多疯狂。

您可以使用网格的`tessfaces`.

# c++ - 使用 Qt 静态构建库时出现链接错误

> ID：13782552
> 
> 赞同：1
> 
> 时间：2012-12-08T22:24:38.163
> 
> 标签：c++, qt, visual-studio-2008, static-libraries, linkage

我正在使用 Qt 4.8.3 和 VS2008 开发本机 C++ 应用程序。由于客户端在他们的裸机上运行应用程序，他们需要安装 VC++ 2008 Redistribution 包。所以我决定让它静态链接。

我将项目设置（C/C++ > 代码生成 > 运行时库）更改为 /MTd。我还再次编译了 Qt，这次使用以下命令进行静态构建；最初在此博客上发现[Static Qt with static CRT (VS 2008)](http://www.qtcentre.org/threads/31636-Static-Qt-with-static-CRT-%28VS-2008%29)

```
1- replaced -MD with -MT in lines QMAKE_CFLAGS_RELEASE and QMAKE_CFLAGS_DEBUG in %QDIR%\mkspecs\win32-msvc2008\qmake.conf
2- nmake confclean 
3- configure -static -platform win32-msvc2008 -no-webkit 
4- nmake sub-src 
```

我成功编译了Qt。但是当我再次尝试编译我的应用程序时，它给了我一些奇怪的错误。

```
1>Linking...
1>qtmaind.lib(qtmain_win.obj) : error LNK2005: "public: bool __thiscall QBasicAtomicInt::deref(void)" (?deref@QBasicAtomicInt@@QAE_NXZ) already defined in QtCored4.lib(QtCored4.dll)
1>qtmaind.lib(qtmain_win.obj) : error LNK2005: "public: bool __thiscall QBasicAtomicInt::operator!=(int)const " (??9QBasicAtomicInt@@QBE_NH@Z) already defined in QtCored4.lib(QtCored4.dll)
1>qtmaind.lib(qtmain_win.obj) : error LNK2005: "public: __thiscall QString::~QString(void)" (??1QString@@QAE@XZ) already defined in QtCored4.lib(QtCored4.dll) 
```

我更改了一些 lib 文件，但每次更改，情况都会变得更糟；例如，我尝试使用 QtCored.lib 而不是 QtCored4.lib，因为它是在编译后新创建的。

我想我在构建静态 Qt 库时遗漏了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-26T15:38:21.407

虽然这个问题自 2012 年底以来一直没有得到解答，但我认为进一步填充关于这个问题的一般知识可能是一个好主意，以便每个线程至少显示一个响应。

问题源于静态构建 Qt 时在链接过程中包含 QtCored4.dll 和 QtGuid4.dll。要从构建过程中排除这些，只需在配置 Makefile 时添加 QT_NODLL 作为预处理器指令。例如，这可以使用以下命令来实现（对于 Microsoft Visual Studio 2008）：

```
configure -static -debug -D QT_NODLL -platform win32-msvc2008 
```

在运行**NMAKE**之前。

使用 Visual Studio IDE 构建静态 Qt 应用程序时，一个好的做法是使用***Configuration Properties->General->Configuration Type***下拉菜单将项目配置类型修改为***Makefile 。***一旦应用了这些设置，用户还可以为***Configuration Properties->General->NMake下的******Build***和***Rebuild All***选项指定**qmake**和**nmake**步骤。

 *******例如，静态调试配置的构建命令行将是：

```
nmake debug 
```

和重建所有等价物：

```
qmake app_debug.pro && nmake debug 
```

我希望这有帮助！*******

# c# - 带有多项目模板的 IWizard 来获取 nuget 预发布包

> ID：13782559
> 
> 赞同：2
> 
> 时间：2012-12-08T22:25:33.157
> 
> 标签：c#, nuget, signalr, project-template

我已经创建了一个多项目模板，并且在创建一个新项目时，我成功地将 nuget 包安装到我的所有项目中，但我正在尝试获取 signalr 的**预发布**版本，但它找不到版本“1.0.0-alpha2”。我假设是因为它是一个版本。虽然我可以使用以下命令从 VS 的 PM 提示符中获取它：

```
Install-Package Microsoft.AspNet.SignalR.JS -version 1.0.0-alpha2 
```

...我需要做的 API 有什么不同的地方吗？或者我做错了什么？

我的项目模板向导中的示例

```
 var componentModel = (IComponentModel)services.GetService(typeof(SComponentModel));
 IVsPackageInstaller installerServices = componentModel.GetService<IVsPackageInstaller();

 installerServices.InstallPackage("http://packages.nuget.org", project, "Microsoft.AspNet.SignalR.JS", "1.0.0-alpha2", false); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:55:54.730

好的，这适用于[https://www.nuget.org/api/v2/](https://www.nuget.org/api/v2/)作为目标，而不是 packages.nuget.org 上的旧 v1。用 fiddler 找到 v2

# django - Django用户匹配错误

> ID：13782565
> 
> 赞同：0
> 
> 时间：2012-12-08T22:26:19.490
> 
> 标签：django

我一直在为我的 django 网站制作用户个人资料页面，但我无法弄清楚我的逻辑在以下函数中哪里出错了。问题是我试图为访问者加载他们自己的个人资料页面或其他用户的个人资料时呈现不同的模板。即使 request.user 匹配“name”（这是从 url 加载的字符串），它仍然会呈现第二个模板。这意味着即使 a = name，它也不会返回 true。谁能告诉我错误在哪里？

```
def profile2(request, name):
    a = request.user
    if a is name:
        return render_to_response("profile.html", context_instance=RequestContext(request))
    return render_to_response("diffprofile.html", {'name':name}, context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:35:16.520

没关系，刚刚意识到我需要用户“==”而不是“is”，是因为字符串是传入而不是在函数中创建的吗？

# ruby-on-rails - 在 Ruby on Rails 中说出人物年龄

> ID：13782566
> 
> 赞同：1
> 
> 时间：2012-12-08T22:26:22.440
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1

我需要说出一个人的年龄。是否有 Rails 助手：

例如：

*   如果此人不到 1 个月：X 天
*   如果此人不到一岁：X 个月大
*   如果它介于 1 和 5 之间：X 年，Y 个月大

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:03:22.030

您可以在 ActionView::Helpers::DateHelper 模块中自定义帮助程序。

[https://github.com/rails/rails/blob/4b1985578a2b27b170358e82e72e00d23fdaf087/actionpack/lib/action_view/helpers/date_helper.rb#L67](https://github.com/rails/rails/blob/4b1985578a2b27b170358e82e72e00d23fdaf087/actionpack/lib/action_view/helpers/date_helper.rb#L67)

除此之外，您可以很容易地创建自己的助手，而无需考虑闰日……这可能很重要，也可能不重要。

```
def humanize_age(person)
  age = Date.today - person.birth_date
  years = (age / 1.year).to_i
  age = age % 1.year
  months = (age / 1.month).to_i
  age = age % 1.month
  days = (age / 1.day).to_i

  if years < 1
    if months < 1
      "#{days} days old"
    else
      "#{months} months old"
    end
  else
    "#{years} years, #{months} months old"
  end
end 
```

这可以清理一下，我还没有测试过，但这应该可以。

# php - 内部服务器 url 重定向

> ID：13782570
> 
> 赞同：1
> 
> 时间：2012-12-08T22:26:33.190
> 
> 标签：php, url-rewriting, nginx

以下[如何重新编写 timthumb.php 图像 url？](https://stackoverflow.com/questions/11314717/how-to-re-write-timthumb-php-image-url) 我能够在我的 nginx Web 服务器中创建重定向。

但是，我想保留原始网址。

因此，如果访问者获得网址[http://mydomain.com/thumb/120/120/image.jpg](http://mydomain.com/thumb/120/120/image.jpg)它不会将浏览器重定向到[http://mydomain.com/timthumb.php/?s=image.jpg&h =120&w=120](http://mydomain.com/timthumb.php/?s=image.jpg&h=120&w=120)但图像将显示在同一链接下。

这种（服务器内部）重定向可能吗？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:54:27.610

无法在我的服务器上对其进行测试，但它必须或多或少等于您的 nginx 站点 conf 中的此类代码。更改配置后不要忘记重新启动 nginx。

```
Location /thumb/ {
    rewrite ^/thumb/(\d+)/(\d+)/(.*)\..*$ /timthumb.php/?s=$3&h=$2&w=$1 last;
} 
```

# c# - 错误 ID：CS0234，错误：命名空间“System.Security.Cryptography”中不存在类型或命名空间名称“Xml”

> ID：13782574
> 
> 赞同：-2
> 
> 时间：2012-12-08T22:27:06.870
> 
> 标签：c#, ide

我正在使用在线 IDE (http://www.frosthawk.net/) 运行我的 C# 代码，编译后出现错误

错误 ID：CS0234，错误：命名空间“System.Security.Cryptography”中不存在类型或命名空间名称“Xml”（您是否缺少程序集引用？），行：26，列：36

谁能告诉我如何使用在线 IDE 将此引用添加到我的代码中，因为我无法右键单击并添加我们过去通常执行的引用

```
 using System;
    using System.Security.Cryptography;
    using System.Security.Cryptography.X509Certificates;
    using System.Security.Cryptography.Xml;
    using System.Text;
    using System.Xml;

    public class SignVerifyEnvelope
    {

     public static void Main(String[] args)
    {
    try
    {

     ...... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:33:27.063

也许你错过了这个：

> // 重要的使用方法：
> 
> // # 通过单击“参考”链接添加/管理参考
> 
> // # 通过单击“设置”链接管理您的构建设置

单击参考并修复您的参考。

如果您不确定需要哪个参考资料，您可能需要浏览 MSDN 寻求帮助。这里的参考是[System.Security](http://msdn.microsoft.com/en-us/library/system.security.aspx)命名空间。

# javascript - 我可以打开一个新窗口并在 JavaScript 中更改调用窗口的 DOM 吗？

> ID：13782585
> 
> 赞同：2
> 
> 时间：2012-12-08T22:28:17.210
> 
> 标签：javascript, dom, window.open

首先，我想说我已经编写 JavaScript 大约 3 个月了，而且我不太关心通过标准或最佳实践来解决这个问题。我主要关心的是学习使用 DOM。我不想使用任何 jQuery，因为我不熟悉它。

我正在尝试使用 JavaScript 和 DOM 在我的页面上创建一个非专业的“登录”功能。首先，我使用的是“登录”屏幕，最初会显示为“隐藏”，然后在使用时显示为“阻止”。当我通过向“登录屏幕”下方的页面主要部分添加较少的不透明度（0.1 不透明度）来在“登录”屏幕后面添加一个变暗的屏幕时，这工作正常并且看起来非常好。

当我关闭“登录”屏幕时，这（不透明度）将恢复正常。所以你可以看到所有的东西都发生在同一个页面中，使用同一个 DOM。好的，这就是我希望它的工作方式：您创建一个用户名，然后您创建一个密码。轰隆隆，完了！

但问题是：创建用户名和密码后，我希望它在登录链接最初所在的位置说“你好（这里的用户名）”。我可以只使用 DOM 并将用户名插入 HTML 页面，但是当我提交作为登录功能的表单时，页面会重新加载并且对 DOM 的更改会被删除！

所以现在我可以告诉你我想到的解决方案：让表单（登录页面）在一个新窗口中，所以当表单被提交（并且 DOM 被操作）时，新窗口被重新加载，然后随后关闭离开主页面 DOM 的更改完好无损。唯一的问题是我无法弄清楚如何做到这一点。你可能会说这是一个主要问题哈哈哈。

那么，我可以从新窗口中操作父窗口（即调用窗口）DOM 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:37:06.093

回应您的回答：您可以使用`window.opener.document`from new window 修改调用者窗口的 DOM；

`window.opener`是对调用者窗口的引用（如果有，否则`null`），但前提是两个窗口都来自[同一个域](http://en.wikipedia.org/wiki/Same_origin_policy)）。

**注意：**它是一个小网页还是您要通过 javascript 在网站/应用程序上进行大量 DOM 操作？在后一种情况下，您应该使用 javascript 库/框架（我推荐 jQuery）以便更轻松地完成这项肮脏的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:37:53.443

`opener`弹出窗口可以使用该变量找到打开它的窗口。

如果弹出窗口和原始窗口都来自同一个域，那么弹出窗口确实可以修改原始窗口的HTML。

如果弹出窗口和原始窗口包含来自不同域的内容，那么由于浏览器实施了跨域保护，它们就无法看到彼此的 HTML。

# algorithm - 寻边二分搜索

> ID：13782587
> 
> 赞同：1
> 
> 时间：2012-12-08T22:28:31.350
> 
> 标签：algorithm, binary-search

想象一个网站，它每天使用条形图仅以图形形式发布每日通勤人数。我想在将图形保存为图像后通过读取条形图来确定数字（图像的东西在这里并不重要）。我想阅读条形图的方法是转到像素数（#of commuters 轴）并提出问题，“像素是“开”还是“关”？（开意味着存在柱，关意味着这个猜测太高了） 注意：有一个下限为 0，从技术上讲，上限是无限的。但是，实际上，10000 可能是现实的上限。另请注意，与昨天相比没有变化是常见的发现。

给定一个从昨天开始的数字来猜测，找到数字的最有效方法是什么？高效意味着询问像素是打开还是关闭的查询数量最少。

（在我的非 CS 眼中，这似乎是某种寻边二进制搜索，但没有预定义的数组。我可以说我已经学到了很多关于搜索的知识。）

我的算法遵循一个函数。任何建议都是最受欢迎的。

```
def EdgeFind(BlackOrWhite,oldtrial,high,low):
# BlackOrWhite is a 0 or 1 depending on if the bar is present or not.  A 1 indicates that you are below or equal to the true number.  A 0 indicates that you are above the true number

# the initial values for oldtrial, high, and low all equal yesterday's value

 factorIncrease = 4#5
 finished = 0

 if BlackOrWhite == 1 and oldtrial==high:
    newtrial = oldtrial+factorIncrease*(high-low)+1
    high = newtrial
    low = oldtrial
 elif BlackOrWhite == 1 and high-oldtrial==1:
    finished = 1
    newtrial = oldtrial
 elif BlackOrWhite == 1:
    newtrial = oldtrial+(high-oldtrial)/2
    low = oldtrial

 if BlackOrWhite == 0 and oldtrial==low:
    newtrial = (oldtrial)/2
    high = oldtrial
    low = newtrial
 elif BlackOrWhite == 0 and oldtrial-low==1:
    finished = 1
    newtrial = oldtrial-1
 elif BlackOrWhite == 0:
    newtrial = oldtrial-(oldtrial-low+1)/2
    high = oldtrial

 if (oldtrial==1) and low!=1:
    finished = 1

 return finished,newtrial,high,low 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:39:49.957

调用边确实可以通过修改后的二分搜索来完成。

它类似于这个问题：[Find an element in an infinite length sorted array](https://stackoverflow.com/q/12300904/572670)。

让搜索到的索引为`idx`

鉴于昨天的值 - 你需要找到“边缘”，这样做可以通过增加/减少 idx 来找到。

例如，如果昨天是 1000，您将在 中搜索`1000,1001,1002,1004,1008,1016,1032,...`直到您发现像素改变了颜色的开关。

假设您在迭代中找到它`i`，这意味着搜索到的边缘在范围内的某个位置：`[1000 + 2^(i-1), 1000 + 2^i]`。（当然这同样适用于 down 而不是 up with `[1000 - 2^(i-1), 1000 - 2^i]`。

现在，您在这个范围内遇到了一个经典的二分搜索问题。

复杂性依然存在，自昨天以来变化的高度在`O(logN)`哪里。`N`

# php - IS NULL 与 symfony2 和学说

> ID：13782592
> 
> 赞同：3
> 
> 时间：2012-12-08T22:29:56.283
> 
> 标签：php, symfony, doctrine-orm, query-builder

我正在尝试这段代码，但我一直遇到错误

```
$q = $this->_em->createQueryBuilder('p')
    ->select('p')
    ->from('ClendarRecipeBundle:RecipePlan', 'p')
    ->leftJoin('p.recipeCalendars', 'c')
    ->groupBy('c.recipePlan')
    ->having('p.portions > SUM(c.portions)')
    ->orHaving('SUM(c.portions) IS NULL')
    ->getQuery(); 
```

当 SUM(c.portions) 为 NULL 时，第一个没有选择它，所以我尝试添加 orHaving 但 symfony2 给了我以下错误：

```
[Syntax Error] line 0, col 204: Error: Expected =, <, <=, <>, >, >=, !=, got 'IS' 
```

我尝试了几种不同的写作方式，你们有什么好的建议我可以尝试吗？我可以尝试 RAWS Sql，但我更喜欢 QueryBuilder 中带有对象的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T08:17:39.650

它应该是：

```
SUM(c.portions) != 0 
```

# xcode - 如何将 .xib 与 MasterViewController .h & .m 关联

> ID：13782596
> 
> 赞同：1
> 
> 时间：2012-12-08T22:30:37.163
> 
> 标签：xcode, xib, nib, connection

我有两个*MasterViewControllers*，一个叫“ `.h`”，一个叫“ `.m`”。

我手动创建了一个 .xib 来为应用程序做界面，但是当我尝试将代码连接到我创建的界面按钮时，它看不到它们。

MasterViewController 旁边有字母“ *M* ”，但 xib 旁边有字母“ *A* ”。

我不知道如何改变。

如果我可以将其更改为“ *M* ”，这会修复未显示的连接吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T22:41:39.943

选择您的 XIB，然后选择“File's Owner”，然后在“Identity Inspector”中，在“Class”下拉菜单中选择您希望与之关联的 Class 文件。（见截图）

（顺便说一句，“类”意味着.m*和*.h）

![在此处输入图像描述](../Images/7bd20eb4f7519d32e89c3e7104b57db7.png)

![在此处输入图像描述](../Images/54e2f6eacbc0b60ead754f1832fdefea.png)

您引用的文件名旁边的字母与源代码管理有关。它与 xib 与什么视图控制器相关联或它是否是 MainViewController 无关。有关更多信息，请参阅此问题：[项目导航器中的 xcode 文件标记框](https://stackoverflow.com/q/8978161/1126783)

# mysql - 在单个 MySql 会话中是否有保证的查询顺序？

> ID：13782598
> 
> 赞同：1
> 
> 时间：2012-12-08T22:30:52.483
> 
> 标签：mysql, sql

给定一个 MySql 会话，假设查询 A 执行表读取，查询 B 执行表写入，这将影响查询 A 返回的内容。

如果我在查询 B 之后提交查询 A（可能是几毫秒后），结果是确定性的吗？查询 B 是否可以在查询 A 之前完成？

或者如果顺序是 [Query B, Query A]，是否可以保证来自 Query A 的结果将包含在 Query B 中所做的更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:41:07.900

您要问的问题在某些方面取决于所使用的表类型，以及查询是在同一个线程中还是来自多个会话。对于这个的完整讨论，你应该查阅[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/internal-locking.html)，特别是关于“锁定”的主题。

如果这些查询是由同一个脚本执行的，那么可能不会有问题。查询 B 不会影响查询 A 等的结果。

从文档...

> MySQL 对 MyISAM、MEMORY 和 MERGE 表使用表级锁定，对 BDB 表使用页级锁定，对 InnoDB 表使用行级锁定。
> 
> 在许多情况下，您可以对哪种锁定类型最适合应用程序做出有根据的猜测，但通常很难说给定的锁定类型比另一种更好。一切都取决于应用程序，应用程序的不同部分可能需要不同的锁类型。
> 
> 要决定是否要使用具有行级锁定的存储引擎，您应该查看应用程序的功能以及它使用的 select 和 update 语句的组合。例如，大多数 Web 应用程序执行许多选择、相对较少的删除、主要基于键值的更新以及插入到少数特定表中。基本的 MySQL MyISAM 设置对此进行了很好的调整。
> 
> MySQL 中的表锁定对于使用表级锁定的存储引擎来说是无死锁的。通过始终在查询开始时一次请求所有需要的锁并始终以相同的顺序锁定表来管理死锁避免。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:54:44.740

如果您谈论的是*单个*会话，请注意 MySQL 不支持多个并发查询。您必须在执行查询 B 之前完成读取查询 A。

一些客户端界面使您看起来仍然可以从查询 A 中获取结果，即使您已继续执行查询 B。但这是可能的，因为客户端库已经将查询 A 中的所有结果提取到应用程序内存中，以及什么您在代码中看到，因为后续提取实际上只是在内存中迭代结果。

如果您正在谈论*多个*并发会话，那么@Ian Atkin 的回答就会发挥作用。存储引擎和事务隔离级别会影响结果。

# javascript - 使用 eq() 和 filter() 的 Jquery 选择器

> ID：13782599
> 
> 赞同：0
> 
> 时间：2012-12-08T22:31:10.683
> 
> 标签：javascript, jquery, jquery-selectors, filter

我想知道是否可以将 eq() 与 filter() 一起使用。我已经对其进行了测试，但无济于事，尽管我找到了解决方法。我只是想知道万一我错过了什么。

我的例子是……假设您有几个带有列和行的表。

```
<table class="menuTable"><tr><td>1</td><td>2</td></tr></table>
<table class="menuTable"><tr><td>3</td><td>4</td></tr></table> 
```

我想知道每个表中有多少列空间，所以......

```
<script type="text/javascript">
alert($(".menuTable").eq(0).filter("td").length);
alert($(".menuTable").eq(1).filter("td").length);
</script> 
```

这不起作用，我想找出原因。我最终使用 .find() 而不是 .filter()，但我认为使用 .filter() 会更合适。

感谢您的任何意见。

经过一些评论后，我意识到我的问题在于查找和过滤之间的区别。还有……对于那些好奇的人。我确实设法通过在选择器中包含 eq 来使用过滤器使其工作......

```
alert($(".menuTable:eq(0)").filter("td").length); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:33:48.810

`filter()`过滤已经选择的元素，您正在寻找的是`find()`，它在所选元素中查找元素，这实际上是正确的方法！

```
alert($(".menuTable").eq(0).find("td").length); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:34:46.237

您的意思是找出每个表中有多少列（不确定“列空格”是什么意思）？您可以`find`在这种情况下使用：

```
$(document).ready(function() {
    alert($(".menuTable").eq(0).find("td").length);
    alert($(".menuTable").eq(1).find("td").length);
}); 
```

如果您使用良好的 JavaScript 调试器（例如在 Chrome 中）或登录到控制台，您可以看到它将`$('.menuTable').eq(0)`返回第一个匹配的表。对此应用[过滤器](http://api.jquery.com/filter/)没有意义——如果您使用`find('td')`然后想要`td`基于类属性过滤元素，这将是有意义的。

演示：[jsfiddle](http://jsfiddle.net/5M8Zx/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T22:34:46.910

> 我最终使用 .find() 而不是 .filter()，但我认为使用 .filter() 会更合适。

`find`确实是您应该在这里使用的。`filter`顾名思义，过滤元素的集合，在您的情况下，集合是所有`.menuTable`元素；该集合中没有`td`s。`find`另一方面寻找子元素，并且您的收藏*确实*有`td`子元素。

# gnuplot - 绘制多条线

> ID：13782601
> 
> 赞同：0
> 
> 时间：2012-12-08T22:31:21.220
> 
> 标签：gnuplot

我如何为每个主人绘制一条与 nombre 和 temps 函数的线。最后，我想为每个主人写三行。我的文件数据是：

```
score;master;nombre;temps
-60;pastel1;7;100
30;pastel2;0;100
100;pastel3;0;100
-60;pastel1;3;220
30;pastel2;4;220
100;pastel3;0;220
-60;pastel1;0;440
30;pastel2;4;440
100;pastel3;3;440
-60;pastel1;0;445
30;pastel2;3;445
100;pastel3;4;445 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T06:16:46.780

你可以这样做：

```
plot '<grep pastel1 test.dat' u 3:4 w lines,\
     '<grep pastel2 test.dat' u 3:4 w lines,\
     '<grep pastel3 test.dat' u 3:4 w lines 
```

或使用迭代的速记：

```
plot for [i=1:3] sprintf("<grep pastel%d test.dat",i) u 3:4 w lines 
```

# javascript - 如何防止 Markdown 将生成的 HTML 包装在 元素？

> ID：13782605
> 
> 赞同：18
> 
> 时间：2012-12-08T22:32:14.820
> 
> 标签：javascript, markdown

**更新：**赏金是使用“标记”库的解决方案。

* * *

此降价代码：

```
*foo* 
```

将生成此 HTML 代码：

```
<p><em>foo</em></p> 
```

**现场演示：** [https ://jsbin.com/luganot/edit?js,console](https://jsbin.com/luganot/edit?js,console)

但是，我已经将生成的 HTML 代码注入到内联上下文中，如下所示：

```
<p> text [inject generated HTML here] text </p> 
```

所以我不希望`<p>`元素环绕生成的 HTML 代码。我只想将`*`分隔符转换为`<em>`, 元素等。

有没有办法告诉 Markdown 转换器不生成`<p>`包装器？目前，我正在`.slice(3,-4)`对生成的 HTML 字符串进行处理，它确实删除了`<p>`, 和`</p>`标签，但这显然不是我想长期保留的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-08-20T04:35:10.110

您可以跳过块词法分析部分并改用 inlineLexer。

```
html = marked.inlineLexer(markdown, [], options);

//example
marked.inlineLexer('*foo*', []) // will output '<em>foo</em>' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-10T15:30:33.317

使用 jQuery 会是一种选择吗？这将在以下情况下起作用：

```
var $text = $(new Showdown.converter().makeHtml( '*foo*' ) );
console.log( $text.html() ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-18T12:34:33.567

当我找到这个 SO 线程时，我也在寻找解决方案。我还没有在这里找到任何好的解决方案，所以我自己写了。

```
var markdown = new Showdown.converter().makeHtml( '*foo*' );
console.log(markdown.replace(/^<p>|<\/p>$/g, '')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-20T04:21:27.633

如果您遵循[commonmark 标准](http://commonmark.org/)，则没有官方方法可以从 markdown 否则会生成的标记中删除不需要的元素。[2014 年，我询问了内联模式的可能性](https://talk.commonmark.org/t/inline-markdown-vs-block-markdown/357)，但这并没有真正产生太多的活动，我也从未跟进它以使其成为现实。

话虽如此，我所知道的清理降价的最简单解决方案是通过白名单运行它作为后处理步骤。

仅仅剥离`<p>`标签可能是不够的，因为它相对容易意外添加`#`字符并最终得到杂散`h1-6`标签，或者具有`<div>`元素中不允许的内联`<p>`元素。

只要您在浏览器上下文中或使用类似的 DOM API，白名单在 JS 中非常简单。

此示例获取输出`marked`并生成文档片段。然后根据片段中的节点是否在[表达内容](https://www.w3.org/TR/html51/single-page.html#phrasing-content)（这是`<p>`元素可能包含的唯一节点）过滤片段中的节点。过滤后，返回结果节点，以便它们可以在 DOM 中使用。

```
const phrasingContent = [
  '#text', 'a', 'abbr', 'area', 'audio', 'b', 'bdi', 'bdo', 'br', 'button',
  'canvas', 'cite', 'code', 'data', 'datalist', 'del', 'dfn', 'em', 'embed',
  'i', 'iframe', 'img', 'input', 'ins', 'kbd', 'keygen', 'label', 'map', 'mark',
  'math', 'meter', 'noscript', 'object', 'output', 'picture', 'progress', 'q',
  'ruby', 's', 'samp', 'script', 'select', 'small', 'span', 'strong', 'sub',
  'sup', 'svg', 'template', 'textarea', 'time', 'u', 'var', 'video', 'wbr'
]

function sanitize(text) {
  const t = document.createElement('template')
  t.innerHTML = text
  whitelist(t.content, phrasingContent)
  return t.content
}

function whitelist(parent, names) {
  for (const node of parent.childNodes) {
    whitelist(node, names)

    if (!names.includes(node.nodeName.toLowerCase())) {
      unwrap(node)
    }
  }
}

function unwrap(node) {
  const parent = node.parentNode
  while (node.firstChild) {
    parent.insertBefore(node.firstChild, node)
  }
  parent.removeChild(node)
}

function empty(node) {
  while (node.firstChild) {
    node.removeChild(node.firstChild)
  }
}

const form = document.querySelector('form')
const input = document.querySelector('textarea')
const output = document.querySelector('output')

form.addEventListener('submit', e => {
  e.preventDefault()

  empty(output)

  output.appendChild(sanitize(marked(input.value)))
}, false)
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.min.js"></script>
<form>
  <p>
    <textarea name="input" cols="30" rows="10">*foo*</textarea>
  </p>
  <button type="submit">Test</button>
</form>

<p> text <output></output> text </p>
```

当然，所有这些都假设一个浏览器环境，并且可以在通过`marked`库处理输入之后处理白名单。

# javascript - 点击更改部分不透明度？

> ID：13782606
> 
> 赞同：0
> 
> 时间：2012-12-08T22:32:19.550
> 
> 标签：javascript, html, css, onclick, opacity

单击 div 时，我正在尝试使用 javascript 更改 a 的不透明度。

这是我的html：

```
<section id="section2">
<img onclick="one()" class=img src="1.png" />
</section>
<section id="6-1">
    Hello World
</section> 
```

还有我的 javascript：

```
function one() {
    document.getElementById('6-1').style.opacity = '1';
    document.getElementById('section2').style.opacity = '0';
} 
```

由于某种原因，它不起作用

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:40:30.117

就像 ModernDesigner 说的那样，引用您的属性并将您的 id 更改为不以数字开头，但除此之外，我仍然无法弄清楚您的问题。但是现在你可以使用 jQuery 来让它工作。

这是一个每次单击它时都会切换它的[小提琴，所以希望这会有所帮助](http://jsfiddle.net/Q2NMZ/2/)

它一直说函数没有定义，所以也许你有一些不正确的语法或其他东西。现在虽然我使用 jQuery 的`.click()`函数而不是`onClick=`因为它不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-23T01:57:52.090

尝试设置不带 ' ' 的值，如下所示：

`document.getElementById("section2").style.opacity = 1;`

它对我来说很好。

# mysql - 将文本文件中的数据加载到数据库中的表中

> ID：13782612
> 
> 赞同：0
> 
> 时间：2012-12-08T22:32:57.567
> 
> 标签：mysql, sql

有人能告诉我我在这里做错了什么吗？首先我用外键创建了一些表，然后尝试从文本文件中导入数据，并且在没有输入数据的情况下出现了各种错误，所以现在我尝试了只是创建表加载数据然后添加外键希望这会起作用，但这不是我所做的

```
create table Books (
ISBN Char(10) not null,
Title Varchar(50) not null,
Price Decimal(5,2) null,
Authors Varchar(50) null,
Pages int null,
PubYear int null,
QTY int null,
Constraint Books_PK primary key(ISBN)
);

create table customers (
customerid int not null,
company varchar(30) null,
firstname varchar(30) null,
lastname varchar(30) null,
street varchar(50) null,
city varchar(30) null,
state char(2) null default 'NE',
zip char(5) null,
phone char(10) null,
constraint customer_pk primary key(customerid)
);

create table orders (
orderid int not null,
customerid int not null,
orderdate date null,
shipdate date null,
shipping decimal(5,2) null,
salestax decimal(5,2) null,
constraint order_pk primary key(orderid)
);

create table orderinfo (
orderid int not null,
isbn char(10) not null,
qty int not null,
price decimal(5,2) not null,
detailid int not null auto_increment,
constraint orderinfo_pk primary key(detailid)
);

load data infile 'C:/lab8/books.txt
into table books; 
```

它给了我一个错误，说 DATA TOO LONG FOR COLUMN ISBN IN ROW 1

文本文件的内容是

```
0929306279,  Bell labs,  29.95,  Gehani,  269,  2008,  121
0929306260,  Java,  49.95,  Sahni & Kumar,  465,  2008,  35
0670031844,  White Mughals,  34.95,  Dalrymple,  459,  2008,  78
0439357624,  Born Confused,  16.95,  Hidier,  432,  2007,  11 
```

显然 ISBN 是 10 个字符，为什么它不进入表格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:38:15.650

如果你有`,`作为分隔符，你必须这样说。

```
load data infile 'C:/lab8/books.txt'
into table books
fields terminated by ','; 
```

根据[LOAD DATA INFILE 语法](http://dev.mysql.com/doc/refman/5.5/en/load-data.html)，默认是制表符`\t`。

> 如果您不指定 FIELDS 或 LINES 子句，则默认值与您编写的相同：
> 
> 由 '\t' 终止的字段由 '' 封闭由 '\\' 转义 由
> '\n' 终止的行由 '' 开始

# authentication - Azure 移动服务和 Azure 网站集成

> ID：13782613
> 
> 赞同：1
> 
> 时间：2012-12-08T22:33:00.327
> 
> 标签：authentication, azure, asp.net-web-api, azure-web-app-service, azure-mobile-services

我在 Windows Azure 网站中使用 ASP.NET Web.Api 托管 REST 端点。我想允许从移动设备对这个 api 进行身份验证访问。Azure 移动服务似乎具有简单的身份验证提供程序以及推送通知等其他好处。

将两者结合使用的有效策略是什么，即托管 REST 端点的网站和进行身份验证和推送通知的移动服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T07:39:20.550

Before you think about anything ahead, CRUD operations which are initiated from the app only receive push notifications, for example, if you manually enter tuples in a database or through code, they won't execute the server scripts and thus no notifications will be send.

About authentication, you may send a token(can be primitive, do not expect to hash or encrypt, if however you use a database to store hashes) once mobile services authenticate your user and then only call the web api's. The thing is the server scripts are fairly limited and can't perform hashing, encryption or other computes which you may expect.

# java - 等待用户输入继续

> ID：13782616
> 
> 赞同：3
> 
> 时间：2012-12-08T22:33:22.213
> 
> 标签：java, button, input, wait

好的，所以我在这里看到了很多这样的问题，但是提供的答案似乎都不适用于我的特殊情况。

我有一个分两部分编写的游戏模拟程序；我首先编写了实际的功能，然后是 GUI 来显示它。我想当我完成后，我只需执行来回调用以使两者相互交谈。后端同时使用 JOptionPane 来获取用户输入。

我的问题是，现在我想在 GUI 中显示东西，我不知道如何暂停程序的运行以等待它发生。例如，我在原始版本中有这个：

```
private static void runAttackerTurn(Team off, Team def) {

int counter = 0;
while (counter < 4 && off.whoHasIt() != null) {
    //Do some stuff
    active = getActive(off, def, counter);
    select = (String)JOptionPane.showInputDialog(null, 
                    "Who Would " + active.getName() + " Like To Attack?" + "\n" +
                    off.whoHasIt().getName() + " has the ball",
                    "Turn " + turnCount + " - " + teamName + " Attacker Turn" ,
                    JOptionPane.INFORMATION_MESSAGE, null,
                    attackerOptions, attackerOptions[0]);
    target = getTarget(off, def, select, counter);
    attack((Forward)active, target);    
    //More stuff
    counter++;
}

} 
```

它工作得很好。但是，当我有一个我想使用而不是 JOptionPane 的 GUI 时，一切都会崩溃。GUI 有一个`JPanel`包含一个`JLabel`用于文本、一个`JComboBox`用于列表选项和一个`JButton`用于确认。我想做的是让程序有效地“暂停”，然后等待用户点击按钮，然后选择所选项目，将其放入`select`并继续。

我不能像我最初尝试的那样将该方法分成两部分，因为除了将结果发送`select`到第二部分之外，我还需要发送其他东西。

另外，从上面可能看不出来，但我在程序过程中用不同的方法做了大约 20 到 30 次，所以我真的需要一个通用的解决方案而不是快速修复。

我认为使用多个线程执行此操作可能会起作用，但我似乎无法做到这一点（主线程过早停止执行 - 按钮甚至没有显示为被点击），无论如何，我更喜欢更简单的东西.

此外，如果这不是很清楚，我真正想做的是在嵌入在 GUI 中的 JPanel 中模拟 JOptionPane 的 modal 属性，并使该方法在继续之前等待用户输入。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T18:48:04.377

多线程方法可能仍然是最简单的方法。如果您实际上不需要程序逻辑在对话框出现时继续运行，并且不介意需要一个零速度增加的额外线程，您可以在您的实际游戏逻辑类中使用一个名为 waitforinput() 的函数只是在你在 GUI 线程上调用一些东西之后你就扔进去了。让它看起来像这样：

```
waitForInput()
{
   while(gotInput==false)
   {

   }
   gotInput=false;
   return;
} 
```

然后让您的 GUI 类在完成应该恢复游戏的操作时翻转输入变量。它不漂亮，但它很简单，应该可以很好地满足您的目的。

# python - Python - Py_Initialize 在编译期间未解决

> ID：13782618
> 
> 赞同：6
> 
> 时间：2012-12-08T22:33:37.710
> 
> 标签：python, gcc, static-libraries, unresolved-external

我已经静态编译 Python2.7 没有任何错误。为了测试我的构建，我使用以下代码段：

```
#include "Python.h"
int main()
{
   Py_Initialize();
} 
```

我正在编译它：

```
$ gcc -static -I/path/to/python/header -L/path/to/my/staticpythonlib \ 
 -lpython2.7 -ldl -l_all_other_needed_lib /tmp/my_previous_snippet.c -o myouput 
```

但是，发生了错误。gcc 声称著名的`undefined reference`.

> test.c:(.text+0x1): 对“Py_Initialize”的未定义引用

奇怪的是，我使用了带有详细标志的 gcc（我不会在此处粘贴结果），编译器说，它正在使用我的 libpython，但找不到参考。所以我列出了我的静态 python2.7 库的符号：

```
$ nm /path/to/pythonlib |grep Py_Initialize
frozenmain.o           U Py_Initialize
pythonrun.o  0000009e9 T Py_Initialize
pythonrun.o  000000052 T Py_Initialize_Ex
main.o                 U Py_Initialize 
```

我们可以看到，`Py_Initialize`在 pythonrun.o 中正确引用了它。但是我不知道编译器如何选择正确的目标文件。

我的问题是：

1.  我如何确定 gcc 在我的 .a 库中使用了正确的目标文件？
2.  我的编译选项有什么问题吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T12:30:09.823

顺序很重要！更具体地说，gcc 参数中的顺序很重要。更具体地说，如果一个`bar`对象使用`bluh`library中的函数`bleh`，那么该顺序`-lbleh bar.o`是有问题的，因为它没有理由让 gcc 在 中查找该`bluh`函数`bleh`。另一方面，当您使用时，`bar.o -lbleh`gcc 知道您所指的是，`bluh`并且当它开始处理时，它会`-lbleh`尝试解决依赖关系。在[http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)中很快提到了这一点。通常，始终在对象之后指定库。

要重现您的问题，请创建一个文件`a1.c`，如下所示：

```
#include "Python.h"

int main()
{
    Py_Initialize();
    return 0;
} 
```

现在用`gcc -static -I/usr/include/python2.7 -L/usr/lib/python2.7/config/ -lpython2.7 -ldl -lm -lutil -lz -pthread -o a1 a1.c`. 这给出了对 的未定义引用`Py_Initialize`。当然，您必须更改路径以匹配您的安装。

现在，相反，编译它`gcc -static -I/usr/include/python2.7 -L/usr/lib/python2.7/config/ -o a1 a1.c -lpython2.7 -ldl -lm -lutil -lz -pthread`并且它可以工作（忽略可能的许多警告，这是另一回事）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-09T06:24:43.040

我正在使用python 2.7并在环境变量中设置python安装目录的路径。我也使用 boost 1.5.0

按照步骤编译以下代码

```
#include <python2.7/Python.h>
int main()
{
Py_Initialize();

PyRun_SimpleString("print \"Hello, world!\"");

Py_Finalize();
return 0;
} 
```

运行命令：-

```
g++ hello.cc -lpython2.7
./a.out 
```

# jquery - 代码学校挑战 JQuery

> ID：13782623
> 
> 赞同：1
> 
> 时间：2012-12-08T22:34:34.397
> 
> 标签：jquery

我是 JQuery 的新手，我找到了 Code School，所以我正在参加他们的课程来学习它。我正在完成一项挑战，这是提出的挑战：

> 使用任何必要的工具找到所有靠窗的座位（头等舱 a 和 d，经济舱 a 和 f）。

这是他们提供的代码：

```
<div id="seating_chart">
  <ul id="first_class">
    <li id="row_1">
      <ul>
        <li class="premium a"></li>
        <li class="premium b"></li>
        <li class="aisle"></li>
        <li class="premium c"></li>
        <li class="premium d"></li>
      </ul>
    </li>
    <li id="row_2">
      <ul>
        <li class="premium a"></li>
        <li class="premium b"></li>
        <li class="aisle"></li>
        <li class="premium c"></li>
        <li class="premium d"></li>
      </ul>
    </li>
  </ul>
  <ul id="economy_class">
    <li id="row_3">
      <ul>
        <li class="a"></li>
        <li class="b"></li>
        <li class="c"></li>
        <li class="aisle"></li>
        <li class="d"></li>
        <li class="e"></li>
        <li class="f"></li>
      </ul>
    </li>
    <li id="row_4">
      <ul>
        <li class="a"></li>
        <li class="b"></li>
        <li class="c"></li>
        <li class="aisle"></li>
        <li class="d"></li>
        <li class="e"></li>
        <li class="f"></li>
      </ul>
    </li>
    <li id="row_5">
      <ul>
        <li class="a"></li>
        <li class="b"></li>
        <li class="c"></li>
        <li class="aisle"></li>
        <li class="d"></li>
        <li class="e"></li>
        <li class="f"></li>
      </ul>
    </li>
    <li id="row_6">
      <ul>
        <li class="a"></li>
        <li class="b"></li>
        <li class="c"></li>
        <li class="aisle"></li>
        <li class="d"></li>
        <li class="e"></li>
        <li class="f"></li>
      </ul>
    </li>
  </ul>
</div> 
```

这就是我想出的：

```
$('#first_class > li > ul > li.premium.a, li.premium.d, #economy_class >li > ul> li.a, li.f'); 
```

现在这段代码有效，但我想知道是否有更简单/更好的方法来完成挑战？我想尽可能多地学习，以便我的代码干净高效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T22:40:21.657

```
var firstOne  = $('#first_class').find('.a, .b'),
    secondOne = $('#economy_class').find('.a, .f'),
    both      = firstOne.add(secondOne); 
```

[**小提琴**](http://jsfiddle.net/GDE97/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T22:41:08.083

是的，您可以简单地选择`<li>`元素中的第一个和最后一个`<ul>`元素：

```
/* Select window seats in first class. */
$('#first_class ul ul li:first-child, #first_class ul ul li:last-child'); 
```

至于您的选择器，您不需要使用克拉。该`>`符号将仅选择直接元素后代，但如果您这样做会更加灵活：

```
$('#first_class li.a, #first_class li.d, #economy_class li.a, #economy_class li.f'); 
```

所以这就是说“找到属于”子`<li>`类的任何元素，依此类推。`.a``#first_class`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T22:46:17.467

虽然您的答案已成功找到您正在寻找的元素。这让你的队友（在现实世界的项目中）很难理解你做了什么，甚至对你自己来说也很难维护。

如果给你的规范是错误的（常见的）或改变了怎么办？（常见）-在大型项目中，此代码：`$('#first_class > li > ul > li.premium.a, li.premium.d, #economy_class >li > ul> li.a, li.f');`在我看来，与以下代码相比，调试时间会更长：

```
var $seating_chart = $('#seating_chart');
var $first_class = $seating_chart.find('#first_class');
var $first_class_window_seats = $first_class.find('.a, .d');
var $economy_class = $seating_chart.find('#economy_class');
var $economy_class_window_seats = $economy_class.find('.a, .f'); 
```

现在，当我们想要进一步处理我们找到的元素时——我们确切地知道它们的用途，我认为这段代码可以帮助我的队友了解正在发生的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T22:41:55.770

```
var fc = $('#first_class li').filter('.a, .d');
var ec = $('#economy_class li').filter('.a, .f');
var all = fc.add(ec); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-08T22:46:23.393

```
var all = $('#first_class.d, #economy_class.f, .a'); 
```

# c# - .Net Web 服务调用引发“网络无法访问”异常 - 但它显然是可访问的

> ID：13782624
> 
> 赞同：0
> 
> 时间：2012-12-08T22:34:37.130
> 
> 标签：c#, networking, wsdl

我有一个远程 .Net Web 服务，我通过它的 WSDL 作为对我的项目的 Web 引用添加了它。当我尝试对其调用方法时，出现以下异常：

```
A socket operation was attempted to an unreachable network 176.31.222.123:443
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception) 
```

它尝试连接的地址是我自己的服务器之一，而且我不仅可以很高兴地从我的机器上访问该 IP 地址 - 也连接到同一台服务器的代码的其他部分工作得非常好。只有在使用网络参考时它才会崩溃。

更奇怪的是，它不会发生在每台机器上，即使在同一网络上的不同机器之间也会给出不同的结果。

我几乎可以肯定正在发生一些非常愚蠢的事情，这会让我面对手掌，但有人知道到底发生了什么吗？

# objective-c - 什么是“推”视图控制器？

> ID：13782625
> 
> 赞同：2
> 
> 时间：2012-12-08T22:34:42.273
> 
> 标签：objective-c, ios, xcode, model-view-controller, uiviewcontroller

我意识到这是一个非常明显的问题，但我认为不完全理解答案会阻碍我很好地使用 Stack Overflow。我一直看到答案中使用的术语，并认为我理解它的含义，但后来我在不同的答案中看到它，并认为它一定意味着不同的东西。

我要问的具体上下文是这样的，所有这些都是我使用 Interface Builder 完成的：

我编写了一个单视图应用程序，使用工具栏在几个屏幕之间导航，但将所有 UI 元素放在同一个视图上，并将所有方法放在同一个视图控制器中。那真的很乱。

然后我从头开始使用带有故事板的选项卡式应用程序，现在每个屏幕都有自己的视图和视图控制器。这看起来更干净，但我讨厌标签栏的外观。

所以我试图弄清楚如何使用工具栏再次执行此操作，但这次在每个屏幕的不同视图/视图控制器之间切换。而且我认为理解“推送”视图控制器的含义将帮助我找到答案。

感谢您对这样一个基本问题的耐心等待。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T22:39:46.323

“推送”专门指将视图控制器添加到导航控制器的堆栈中，这会导致该控制器的视图从右侧滑到屏幕上（如果它是动画的）。SO上的某些人松散地使用该术语（我会说不正确）来表示只是在屏幕上显示控制器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T22:39:46.870

“推送”视图控制器通常用于导航控制器 ( `UINavigationController`) 的上下文中。你从根视图控制器开始。然后，您将下一个视图控制器“推”到当前视图控制器之上。完成后，您可以“弹出”该视图控制器以返回到前一个。

我建议你阅读“ [iOS 的视图控制器编程指南](https://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html)”，以获得关于视图控制器、导航控制器、标签栏控制器和其他的很好的讨论。你会迷路，直到你这样做。

# c - 如何使用程序检查总缓存大小

> ID：13782628
> 
> 赞同：2
> 
> 时间：2012-12-08T22:34:48.330
> 
> 标签：c, caching, size

所以我在创建一个程序来测量 C 中的缓存大小时遇到​​了一些麻烦。我理解了这个的基本概念，但我仍然无法弄清楚我到底做错了什么。

基本上，我创建了一个不同长度的数组（按 2s 的幂计算）并访问数组中的每个元素并将其放入一个虚拟变量中。我遍历阵列并执行此操作大约 1000 次，以消除如果我只执行一次以获得准确的时间测量结果会发生的“噪音”。然后，我寻找导致访问时间大幅增加的大小。不幸的是，这就是我遇到问题的地方，我没有看到使用我的代码跳转，显然我做错了什么。

另一件事是我使用 /proc/cpuinfo 来检查缓存，它说大小是 6114，但这不是 2 的幂。有人告诉我用 2 的幂来计算缓存，谁能解释为什么会这样?

这是我的代码......如果需要，我会发布其余的

```
 {
    struct timeval start;
struct timeval end;
int n =1 ; // change this to test different sizes
int array_size = 1048576*n; // size of 1MB
int x = 0;
int i =0, j=0;
int *a;
int sum = 0;
a =malloc((array_size)*sizeof(int));

for(j=0; j < array_size; j ++)
    {

        a[j] = 1; // intialize all elements to 1

    }

gettimeofday(&start,NULL);

for(i=0; i<500; i++)
{
    for(j=0; j < array_size; j ++)
    {

        x += a[j];
    }
}

gettimeofday(&end,NULL);

      sum = x+8192;

int timeTaken = (end.tv_sec * 1000000 + end.tv_usec) - (start.tv_sec *1000000 + start.tv_usec);
printf("Time Taken: %d \n", timeTaken);
printf("Average: %f \n", (double)timeTaken/((double)array_size)); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T12:46:35.293

即使您可以确保未优化阵列访问，`gettimeofday`也没有足够的时间分辨率来测量缓存访问，尤其是 L1（任何最近的商品处理器都有 2 或 3 级缓存）。

你**可能会**得到一个纳秒时钟和**大量统计数据**，以减少每个测量的误差。

另一方面，您可以使用具有[此类功能](http://icl.cs.utk.edu/projects/papi/wiki/PAPIC%3apapi_mem_info.1)的第三方库（例如 PAPI（Performance API））来获取信息而不是度量。

# c++ - 检查指针是否为空，然后在同一个 if 语句中取消引用它是否安全？

> ID：13782629
> 
> 赞同：11
> 
> 时间：2012-12-08T22:34:57.297
> 
> 标签：c++, c, pointers, conditional-statements

如果传入空指针，以下代码是否安全？

```
if(ptr && *ptr == value)
{
   //do something
} 
```

检查的顺序重要吗？如果我把它改成这个，它会起作用吗？

```
if(*ptr == value && ptr)
{
   //do something
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-08T22:36:11.203

前者是正确和安全的，后者不是。

内置`&&`运算符具有*短路语义*，这意味着当且仅当第一个参数为真时才评估第二个参数。

（这不是*重载*运算符的情况。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T22:36:02.083

是 (1) 是安全的，因为短路。这是评估逻辑语句的方式。如果陈述的第一部分`&&`为假，那么整个陈述永远不会为真，因此它不会尝试评估第二部分。

(2) 是不安全的，因为它首先取消引用空指针，这是未定义的行为。

编辑：

参考下面的 KerrekSBs 评论： [为什么取消引用空指针是未定义的行为？](https://stackoverflow.com/questions/6793262/why-dereferencing-a-null-pointer-is-undefined-behaviour)

从该帖子中的第一个答案：

> 为取消引用 NULL 指针定义一致的行为将要求编译器在大多数 CPU 架构上的每次取消引用之前检查 NULL 指针。对于为速度而设计的语言来说，这是一个不可接受的负担。

还有（历史上）硬件，其中`NULL`（并非总是 `0`）指向的内存实际上在程序中是可寻址的，并且可以取消引用。因此，由于缺乏共识和一致性，决定取消引用空指针将是“未定义的行为”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T22:36:01.973

如果指针无效（或者更确切地说`NULL`，正如所指出的那样），在第一个版本中[，短路](http://en.wikipedia.org/wiki/Short-circuit_evaluation)将阻止对 的评估`*ptr == value`，因此第一个是安全的。

第二个将始终访问`*ptr`，无论它是否有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T22:41:54.437

除了所有其他关于`ptr && *ptr == value`有效但不是相反的答案之外，有效指针的概念可能具有不同的含义。

可以是未初始化的变量，或者可以以不指向任何地方（例如[悬空指针](http://en.wikipedia.org/wiki/Dangling_pointer)）但不为空的方式`ptr`获得（例如，通过某个随机整数的强制转换）。`intptr_t`

在这种情况下，测试顺序都不起作用。

一些指针可能是无效的并且是非空的（那么测试`ptr && *ptr == value`就是*未定义的行为*）。没有可移植的方法来测试它们。（但您可以使用操作系统或处理器特定的技巧）。

# xcode - 无法链接节点——“不存在这样的小桶”

> ID：13782631
> 
> 赞同：0
> 
> 时间：2012-12-08T22:35:17.587
> 
> 标签：xcode, macos, node.js, terminal

所以我整天都在尝试安装节点。我已经重新安装了 Xcode，安装了命令行工具，brew prune，brew cleanup，删除了节点，再次重新安装，它仍然不会链接。任何帮助是极大的赞赏。

运行 OSX 10.8.2

```
acd41302428433:Cellar rrichrs$ brew link node
Linking /usr/local/Cellar/node/0.8.15... Warning: Could not link node. Unlinking...

Error: Could not symlink file: /usr/local/Cellar/node/0.8.15/bin/npm
Target /usr/local/bin/npm already exists. You may need to delete it.
To force the link and delete this file, do:
brew link --overwrite formula_name

To list all files that would be deleted:
brew link --overwrite --dry-run formula_name
acd41302428433:Cellar rrichrs$ brew link --overwrite --dry-run formula_name
Error: No such keg: /usr/local/Cellar/formula_name
acd41302428433:Cellar rrichrs$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:41:09.677

我意识到这并不能完全回答你的问题。但我强烈建议为节点安装 nvm。这将允许您运行多个版本的节点并在它们之间进行更改。节点变化如此之快，我遇到了需要旧版本节点的项目。使用 nvm 就像

```
nvm install 0.4.2
nvm use 0.4.2 
```

[nvm 的文档和安装说明](https://github.com/creationix/nvm)

基本上安装就像将 curl 命令复制并粘贴到终端一样简单：

```
curl https://raw.github.com/creationix/nvm/master/install.sh | sh 
```

# ios - 如何将自定义 UIButton 添加到 Interface Builder 对象库？

> ID：13782639
> 
> 赞同：4
> 
> 时间：2012-12-08T22:36:17.347
> 
> 标签：ios, xcode, uibutton, interface-builder

是否可以将子类 UIButton 添加到 XCode 4.5 Interface Builder 对象库，但作为自定义对象？

在这里您可以找到小示例项目：
[https ://www.dropbox.com/s/ioucpb6jn6nr0hs/blabla1.zip](https://www.dropbox.com/s/ioucpb6jn6nr0hs/blabla1.zip)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:19:23.533

无法将新对象添加到 Interface Builder 对象库，但您可以将常规 UIButton 拖出，然后在 Identity Inspector 的第三个选项卡中将 Custom Class 属性更改为您的自定义类名称。不过，您不会在 xib 文件中看到任何自定义设置。

* * *

我看了你的示例代码。在 BlaButtonVC.m 你有方法

```
- (id)initWithFrame:(CGRect)frame 
```

当您从 xib 初始化时，它不会被调用。您需要将该方法中的代码添加到

```
- (id)initWithCoder:(NSCoder*)coder 
```

我测试了它并且它有效。

顺便说一句，我不认为 BlaButtonVC 是一个好名字，因为它暗示你的类是一个视图控制器，而它实际上是一个视图（除非 VC 代表你项目中的其他东西）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:18:57.087

你曾经能够在 Xcode 3 中做到这一点，但如果我没记错的话，那是一个插件的事情（BWToolkit 曾经这样做，并且在 Xcode 4 中停止了）。您可以制作一个常规的 UIButton 并在检查器窗口中将其类更改为相同的效果。

# php - 需要复选框选择php

> ID：13782641
> 
> 赞同：0
> 
> 时间：2012-12-08T22:36:43.923
> 
> 标签：php, html, mysql

我有一个似乎很容易解决的问题。我有一个带有复选框组的 html 表单，我希望能够强制选择复选框。在这一点上，我只想写一个错误，如果没有从组中选择任何复选框，则会出现回显。我通过 mysql 查询发送复选框数组，当没有选择任何内容时，我得到一个空页面。我的困惑是如何编写 PHP 代码来返回错误。我试过了

```
if (empty($_GET){
echo "ERROR" ;} 
```

和

```
if (empty($color)){
echo "ERROR" ;} 
```

也许我只是脑死亡，但这似乎应该工作。这是我目前正在为复选框工作的 html 代码。

```
<input type="checkbox" name="color[]" value="Black">Black
<input type="checkbox" name="color[]" value="Blue">Blue
<input type="checkbox" name="color[]" value="Brown">Brown
<input type="checkbox" name="color[]" value="Green">Green 
<input type="checkbox" name="color[]" value="Grey">Grey
<input type="checkbox" name="color[]" value="Orange">Orange 
<input type="checkbox" name="color[]" value="Pink">Pink
<input type="checkbox" name="color[]" value="Purple">Purple
<input type="checkbox" name="color[]" value="Red">Red
<input type="checkbox" name="color[]" value="Teal">Teal
<input type="checkbox" name="color[]" value="White">White
<input type="checkbox" name="color[]" value="Yellow">Yellow
<br>
<input type="checkbox" name="pattcat[]" value="Home Decor">Home Decor
<input type="checkbox" name="pattcat[]" value="Children">Children
<input type="checkbox" name="pattcat[]" value="Tops Women">Tops Women
<input type="checkbox" name="pattcat[]" value="Accessories">Accessories
<input type="checkbox" name="pattcat[]" value="Lace">Lace
<input type="checkbox" name="pattcat[]" value="Tops Men">Tops Men
<br> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:46:35.190

你试过`if( empty($_GET['color']))`吗？仅仅因为它是一个数组并不意味着它与普通的 GET 变量有任何不同。

此外，请确保表单方法是 GET，而不是 POST。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:45:46.593

假设它不是 POST

```
if (empty($_GET["color"]){
    echo "ERROR" ;
} 
```

`$GET`是由表单元素的名称 ( ) 键控的散列`color`。当名称以 结尾时`[]`，它变成一个数组。对于复选框，仅发送选中的复选框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:48:19.337

你正在寻找的是这样的东西......

```
if (empty($_POST["color"]) {
    echo "ERROR" ;
} 
```

但是为什么要浪费用户宝贵的时间让他们提交来找出他们的错误呢？为什么不使用一些不错的 JavaScript（jQuery 或其他），只允许他们在完成后提交表单并让您满意？您甚至可以禁用“提交”按钮，直到他们这样做，或者在他们未能填写足够信息时显示简洁的错误。

# ruby-on-rails - Ruby on Rails：如何向 button_to :back 添加额外的参数？

> ID：13782643
> 
> 赞同：2
> 
> 时间：2012-12-08T22:36:52.770
> 
> 标签：ruby-on-rails, parameters, back, button-to

我正在为类做一个 Rails 项目，用户可以在其中输入搜索词，显示结果（图像），然后用户可以单击图像以获取更大版本的图像。

在较大的版本页面上，我有一个 button_to :back。

```
<%= button_to "Back", :back %> 
```

但是当我点击按钮时，它返回的图像结果页面显示默认图像，而不是搜索返回的图像。我需要能够将 params[:search_term] 传递回上一页（因为没有 :search_term 值，则返回默认图像）。

我试过这个：

```
<%= button_to "Back", :back, :search_term => params[:search_term] %> 
```

在查看页面源代码时，它看起来应该将参数传回：

```
 <form action="http://localhost:3000/albums/7/add" class="button_to" method="post">
   <div>
   <input search_term="puppy" type="submit" value="Back" />
   <input name="authenticity_token" type="hidden" value="lkjsakvgjwhatever" />
   </div></form> 
```

真实性令牌被返回，但我的 search_term 没有。

编辑：

这是视图：

```
<%= image_tag("http://farm#{@pic["farm"]}.staticflickr.com/#{@pic["server"]}/#{@pic["id"]}_#{@pic["secret"]}_c.jpg") %>
<br><br>
<%= @pic["title"] %>'

<br><br>
<br><br>

<%= button_to "Back", :back, {:search_term=> params[:search_term]} %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-08T20:13:52.980

使用该`params`选项将值的散列添加为隐藏字段：

```
= button_to "Back", :back, params: { search_term: params[:search_term] } 
```

将产生：

```
<form action="/back" class="button_to" method="post">
    <div>
        <input type="submit" value="Back" />
        <input name="authenticity_token" type="hidden" value="uSCQbSaZdbIrTD2Z2FA0FQNe5CF+tK/jViInc1b7Kb0=" />
        <input name="search_term" type="hidden" value="whatever" />
    </div>
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:45:01.510

您必须更改表单的操作。像这样的东西

```
<%= form_for(@model, :url => 'YOURURL',  :method => 'get') do %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T04:01:33.137

据我所知，`button_to "Back", :back`将是一个 javascript 代码，如：`javascript:history.back()`，所以你应该自己定义返回 url，而不是使用`:back`UrlHelper的默认值

# c# - 从 TreeView 中的图标设置图像

> ID：13782649
> 
> 赞同：13
> 
> 时间：2012-12-08T22:37:50.680
> 
> 标签：c#, winforms, treeview

我正在编写自己的基于 C# 的应用程序启动器，虽然我让它在其中填充`TreeView`和启动应用程序快捷方式，但我似乎无法弄清楚如何将图标作为图像添加到`TreeView`. 我当前获取文件的代码是：

```
 private void homeMenu_Load(object sender, EventArgs e)
    {
        this.ShowInTaskbar = false;
        if (Directory.Exists((Directory.GetParent(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)).FullName + "\\Roaming\\Launcher")))
        {

        }
        else
        {
            Directory.CreateDirectory(Directory.GetParent(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)).FullName + "\\Roaming\\Launcher");
        }

        DirectoryInfo launcherFiles = new DirectoryInfo(Directory.GetParent(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)).FullName + "\\Roaming\\Launcher");

        lstPrograms.Nodes.Add(CreatingDirectoryTreeNode(launcherFiles));

        lstPrograms.Sort();

    }

    private static TreeNode CreatingDirectoryTreeNode(DirectoryInfo directoryInfo)
    {
        var directoryNode = new TreeNode(directoryInfo.Name);

        foreach (var directory in directoryInfo.GetDirectories())
        {
            directoryNode.Nodes.Add(CreatingDirectoryTreeNode(directory));
        }

        foreach (var file in directoryInfo.GetFiles())
        {
            directoryNode.Nodes.Add(new TreeNode(file.Name));
        }

        return directoryNode;
    } 
```

我遇到的主要问题是将 TreeList 的 ImageList 的图标添加到特定节点。我知道我需要添加：

```
lstPrograms.ImageList.Images.Add(Icon.ExtractAssociatedIcon()); 
```

要将图标实际添加到图像列表中，如何获取该特定图像的索引，然后将其`TreeView`与其相关文件一起添加到？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-08T23:06:26.560

首先，将图像添加为资源并定义您的图像列表：

```
static ImageList _imageList;
public static ImageList ImageList
{
    get
    {
        if (_imageList == null)
        {
            _imageList = new ImageList();
            _imageList.Images.Add("Applications", Properties.Resources.Image_Applications);
            _imageList.Images.Add("Application", Properties.Resources.Image_Application);
        }
        return _imageList;
    }
} 
```

然后，设置的`ImageList`属性`TreeView`：

```
treeView1.ImageList = Form1.ImageList; 
```

然后，当您创建节点时，对于特定节点，使用：

```
applicationNode.ImageKey = "Application";
applicationNode.SelectedImageKey = "Application"; 
```

# html - 播放音乐按钮在谷歌网站上不起作用

> ID：13782650
> 
> 赞同：1
> 
> 时间：2012-12-08T22:37:55.973
> 
> 标签：html, audio, sites

这在我的谷歌博客上运行良好，但不适用于谷歌网站。任何想法为什么？

```
<audio controls="controls" height="100" width="100">
<source src="horse.mp3" type="audio/mp3">
<source src="horse.ogg" type="audio/ogg">
<embed height="100" width="100" src="horse.mp3">
</audio> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T17:20:34.827

姗姗来迟...我认为这是 Google 协作平台对音频的普遍敌意的一部分。GS 甚至拒绝播放附加的 MP3 和 WAV：http: [//img542.imageshack.us/img542/4215/h87b.png](http://img542.imageshack.us/img542/4215/h87b.png)。

但是它确实容忍了这一点：

```
<img src="https://www.google.com/chart?chc=sites&amp;cht=d&amp;chdp=sites&amp;chl=%5B%5BGoogle+Gadget'%3D20'f%5Cv'a%5C%3D0'10'%3D359'0'dim'%5Cbox1'b%5CF6F6F6'fC%5CF6F6F6'eC%5C0'sk'%5C%5B%22Google+Audio+Player.+Advance+by+step.%22'%5D'a%5CV%5C%3D12'f%5C%5DV%5Cta%5C%3D10'%3D0'%3D360'%3D32'dim'%5C%3D10'%3D10'%3D360'%3D32'vdim'%5Cbox1'b%5Cva%5CF6F6F6'fC%5CC8C8C8'eC%5C'a%5C%5Do%5CLauto'f%5C&amp;sig=ZEkDBX01MSrDBRH3BCPM1VTOfok" data-igsrc="http://172.gmodules.com/ig/ifr?mid=172&amp;synd=trogedit&amp;url=http%3A%2F%2Fprac-gadget.googlecode.com%2Ffiles%2Fgoogle-audio-step.xml&amp;up_MP3=https%3A%2F%2Fsites.google.com%2Fsite%2Fcjjtestsite%2FHome%2Fhorse.mp3&amp;up_START=&amp;up_CCOL=%23d1dae3&amp;h=35&amp;w=360" data-type="ggs-gadget" data-props="align:left;borderTitle:Google Audio Player. Advance by step.;height:35;igsrc:http#58//172.gmodules.com/ig/ifr?mid=172&amp;synd=trogedit&amp;url=http%3A%2F%2Fprac-gadget.googlecode.com%2Ffiles%2Fgoogle-audio-step.xml&amp;up_MP3=https%3A%2F%2Fsites.google.com%2Fsite%2Fcjjtestsite%2FHome%2Fhorse.mp3&amp;up_START=&amp;up_CCOL=%23d1dae3&amp;h=35&amp;w=360;mid:172;scrolling:no;showBorder:false;showBorderTitle:null;spec:http#58//prac-gadget.googlecode.com/files/google-audio-step.xml;up_CCOL:#35d1dae3;up_MP3:https#58//sites.google.com/site/cjjtestsite/Home/horse.mp3;up_START:;width:360;wrap:false;" width="360" height="35" style="display:block;text-align:left;margin-right:auto;" class="igm"></div> 
```

很抱歉没有更有用的答案！

# c# - 标记转换器 WPF 到 ASP.NET

> ID：13782652
> 
> 赞同：1
> 
> 时间：2012-12-08T22:38:02.443
> 
> 标签：c#, asp.net, wpf, markup-extensions

我在 WPF 中使用 MarkupConverters 将枚举值解析为人类可读的字符串。

ASP.NET 和 ASP.NET GridView 或 DevExpress ASPxGridView 有没有办法在 WPF 中做同样的事情？

ASP.NET 中类似的东西（来自 WPF）：

```
using System;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Markup;

namespace Converters
{
    public class PriorityToStringConverter
        : MarkupExtension, IValueConverter
    {
        public PriorityToStringConverter()
        {
        }

        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value is byte)
            {
                switch ((byte)value)
                {
                    case 0:
                        return "Very high";

                    case 1:
                        return "High";

                    case 2:
                        return "Normal";

                    case 3:
                        return "Low";

                    case 4:
                        return "Very low";

                    default:
                        return value;
                }
            }

            return value;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return null;
        }

        public override object ProvideValue(IServiceProvider serviceProvider)
        {
            return this;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T08:29:00.877

好吧，不幸的是，ASP.Net 没有内置的转换器，例如 WPF。您**可以**做的是让您自己的自定义转换器在 ASP.Net GridView 上使用。
这是一个简短的例子：

首先将 a 添加`System.ComponentModel.Description`到您的枚举值中，如下所示：

```
public enum MyEnum
{
    [Description("Desc for A")]
    MyA = 0,
    [Description("Desc for X")]
    MyX,
    [Description("Desc for Y")]
    MyY
} 
```

对于演示，我的数据模型是以下列表：

```
public class MyData
{
    public string Name { get; set; }
    public MyEnum Value {get; set;}
} 
```

现在，在您的页面中创建以下函数，该函数提取给定特定枚举值的描述​​：

```
 public static string GetEnumDescription(Enum value)
    {
        FieldInfo fi = value.GetType().GetField(value.ToString());

        DescriptionAttribute[] attributes =
            (DescriptionAttribute[])fi.GetCustomAttributes(
            typeof(DescriptionAttribute),
            false);

        if (attributes != null && attributes.Length > 0)
            return attributes[0].Description;
        else
            return value.ToString();
    } 
```

GridView 中的用法：

```
 <Columns>
        <asp:TemplateField HeaderText="Value" SortExpression="Value">
            <ItemTemplate>
                <asp:Label ID="Label1" runat="server" Text='<%# GetEnumDescription((Enum)Eval("Value")) %>'></asp:Label>
            </ItemTemplate>
        </asp:TemplateField> 
```

我基本上做的是在使用`Eval`获取`Value`特定行的属性之后，我调用我创建的函数来提取描述，给出枚举值，这就是我在标签中显示的内容。

# c++ - 这个指针一旦创建会发生什么？

> ID：13782657
> 
> 赞同：1
> 
> 时间：2012-12-08T22:39:08.593
> 
> 标签：c++, oop, object

我有以下问题。我创建了一个类，并将指向该类的指针存储在另一个类中。创建后，一切正常。然而，一步之后，该类似乎消失了。

我在这里写了一个非常简单的测试场景：

```
#include <iostream>

using namespace std;

class test
{
    public:
        test();
        bool ok;
};

test::test()
{
    ok = false;
}

class func
{
    public:
        func();
        void check();
        test *pTest;
};

func::func()
{
    test temptest = test();
    cout << temptest.ok << endl;
    pTest = &temptest;
    cout << pTest->ok << endl;
}

void func::check()
{
    cout << pTest->ok << endl;
};

int main( int argc, char *argv[] )
{
    func mFunc = func();
    // what happens here
    mFunc.check();
} 
```

上述程序输出以下内容：

```
0
0
204 
```

从 204 开始，我猜我之前创建的类不知何故消失了。

你能告诉我发生了什么，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:50:44.813

以上都是正确的。我希望您正在寻求的简单解决方案是

```
pTest = new test(); 
```

而不是分配给局部变量，然后获取指向该变量的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:54:46.607

问题是您正在创建一个具有“有限”范围的对象。

```
func::func()
{
    test temptest = test();             // temptest construction
    cout << temptest.ok << endl;
    pTest = &temptest;
    cout << pTest->ok << endl;
}                                       // temptest descrution 
```

func 构造完成后，pTest 现在引用了一个无效对象。

您必须使用动态内存或共享指针来管理指针。

```
#include <iostream>

using namespace std;

class test
{
    public:
        test();
        bool ok;
};

test::test()
{
    ok = false;
}

class func
{
    public:
        func();
       ~func();
        void check();
        test *pTest;
};

func::func()
{
    pTest = new Test();
    cout << pTest->ok << endl;
    cout << pTest->ok << endl;
}
func::~func() { delete pTest; }

void func::check()
{
    cout << pTest->ok << endl;
};

int main( int argc, char *argv[] )
{
    func mFunc = func();
    // what happens here
    mFunc.check();
} 
```

现在 test 的构造函数分配一个新对象并存储该对象的地址，析构函数可以释放内存。以这种方式管理内存不是一个好的策略。

使用共享指针而不是 shared_ptr 或 unique_ptr，但这需要一些其他知识，例如移动语义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:48:52.330

func 对象的生命周期超出了包含的 pTest 对象实例的生命周期。

一旦构造函数 func 返回，其成员 pTest 所指向的对象现在不再有效（temptest，当 func::func 返回时，func::func() 范围内的 test 的自动/堆栈实例已被销毁）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T22:52:23.847

`temptest`当调用 func 类函数 func() 时，该对象被分配到堆栈上。然后将该内存的地址存储在指针中`pTest`。当函数 func() 超出范围时，堆栈展开并且对象`temptest`被破坏。指针`pTest`现在指向产生未定义结果的未分配数据。

像这样创建的对象：

```
test t; 
```

被称为*自动对象*，当它们超出范围时会自动释放。

您应该阅读动态分配数据和使用自动对象的区别。您还可以阅读有关*堆栈*和*堆*内存的信息，我认为这可以为这个问题带来一些启示。

# c# - 带有 if 语句的 LINQ

> ID：13782664
> 
> 赞同：0
> 
> 时间：2012-12-08T22:39:52.807
> 
> 标签：c#, linq, entity-framework, linq-to-entities

如果“属性”大于 0，则我的 LINQ 查询返回值，否则它不起作用并且我没有收到错误。我猜第三行中的 && 想要另一个声明，如果“属性”不大于 0，它不会得到。我该如何克服这个问题？

编辑：我首先编写的代码正在执行 abatishchev 的回答。我试图在没有 else 的情况下做一个速记 if 语句，但我读到了这个错误，所以代码是为了做其他事情，然后它实际上做了。感谢您对此事的启发，但我仍然不知道如何实现我最初对 linq 的愿望，所以我将代码重新排列为更接近我的目标的东西。

```
int attribute = 0;
var query = from x in db.Table1
            where x.ValueId == 1

            if(attribute > 0)
                x.Table2.Attribute == attribute

            select x; 
```

如果属性大于 0，那么我不想在查询中添加额外的 where 子句。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T22:48:24.327

```
(attribute > 0) && x.Table2.Attribute == attribute 
```

表示'如果属性大于0并且表属性等于给定，否则跳过'

```
attribute <= 0 || ((attribute > 0) && x.Table2.Attribute == attribute) 
```

表示'如果属性大于0并且表属性等于给定，否则包括'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:51:38.497

我想你可能想这样做

```
int attribute = 0;
var query = from x in db.Table1
            where (attribute <= 0) ||
            (x.ValueId == 1 &&
            x.Table2.Attribute == attribute)
            select x; 
```

当属性 <= 0 时，这会导致 Table1 中的所有内容。如果属性大于零，那么它将应用您的过滤器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:48:04.553

如果属性*不*大于 0，则`attribute > 0`评估为 false，并且因为您在`where`过滤器中使用它，所以`x`实际上没有通过该过滤器并且您得到一个空枚举，这是正确的。所以答案是检查你的逻辑，重新思考应该是什么`attribute`意思以及它应该如何影响查询结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T23:34:23.500

```
if (attribute > 0)
   query = query.Where(a => a.Table2.Attribute == attribute); 
```

# jquery - 选择同一父级的所有前面的子级

> ID：13782670
> 
> 赞同：1
> 
> 时间：2012-12-08T22:40:33.547
> 
> 标签：jquery, html, css

我在 a 中有一些`<span>`元素`<div>`。当您将鼠标悬停在一个`<span>`上时，它应该突出显示所有**前面**`<spans>`和悬停的`<span>`.

如何仅使用 CSS 或 jQuery 来做到这一点？

**[jsFiddle 示例](http://jsfiddle.net/6zm3E/ "jsFiddle 示例")**

我怀疑 jQuery 答案会执行以下操作，但我找不到 1 和 2 的函数。

1.  获取当前悬停元素的子编号
2.  选择不超过该数字的所有孩子
3.  向他们添加“悬停”类

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T22:43:47.550

你可以用 jQuery 做到这一点：

```
$('span').hover(​​​​​function(){
    $(this).prevAll().addClass('hover'); 
},function(){
    $(this).prevAll().removeClass('hover'); 
});​ 
```

[示范](http://jsfiddle.net/R6uBq/)

这使用[prevAll](http://api.jquery.com/prevAll/)来选择同一 div 的所有前面的跨度。无需使用当前元素的索引，但您可以使用 index 函数获得它，然后您将使用 lt 选择器 ( `$(this).sibblings(":lt("+$(this).index+")")`)。当然 prevAll 要简单得多。

正如 elclarns 所注意到的，这可以缩短为

```
$('span').hover(function(){
    $(this).prevAll().toggleClass('hover'); 
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T22:51:01.953

这取决于兼容性，可能与 CSS 一起使用，尽管没有添加类名：

```
div:hover span {
    /* colours all descendent spans of hovered-div */
    background-color: #ffa;
}

div:hover span:hover,
div:hover span:hover ~ span {
    /* 'de-colours' the hovered-span, and
         the subsequent sibling spans */
    background-color: #fff;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:49:00.370

根据提供的示例，我在这里看不到任何困难，我们将使用 prevAll() 函数根据当前项目选择所有先前的兄弟姐妹。

```
 $("span").hover(function(){
       $(this).prevAll().addClass("hover");

},    function(){
        $(this).removeClass("hover");
})​ 
```

一个工作示例：http: [//jsfiddle.net/6zm3E/1/](http://jsfiddle.net/6zm3E/1/)

# php - 用户登出 Facebook 时登出网站

> ID：13782674
> 
> 赞同：0
> 
> 时间：2012-12-08T22:41:02.547
> 
> 标签：php, facebook

我正在使用 Facebook Connect PHP SDK 来允许用户登录我的网站：

```
try {
    $facebook = new Facebook(array(
      'appId'  => $fbconfig['appid'],
      'secret' => $fbconfig['secret'],
      'cookie' => true,
    ));
} catch(Exception $o) {
    print_r($o);    
}

// Facebook Authentication part
$user       = $facebook->getUser();    
$loginUrl   = $facebook->getLoginUrl(
                array(
                    'scope'         => 'email,user_likes,publish_actions,read_stream,friends_likes,user_checkins,user_location,friends_checkins,user_status',
                    'redirect_uri'  => $fbconfig['baseurl'].'load-data.php',
                    'cancel_url'    => $fbconfig['baseurl'].'/index.php'
                )
            ); 
```

登录 URL 已创建，用户已成功登录站点。问题是当用户在另一个选项卡中注销 Facebook 时，我想获取此状态并使用 Facebook SDK 将用户从我的程序中注销。

用户退出 Facebook 时如何退出？

感谢您阅读我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T06:57:40.030

我认为您无法在不直接弄乱 FB 会话的情况下找出用户何时从 Facebook 注销，因为这与您的应用程序会话不同。我不认为这是一个好主意。

另一种方法是从您的应用程序中注销用户，但我不知道它是否能解决您的问题。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-12-08T23:45:58.903

```
 <script type="text/javascript">

        var int=self.setInterval(function(){checkSession()},1000);

        function checkSession() {
             var request = false;
                if(window.XMLHttpRequest) { // Mozilla/Safari
                    request = new XMLHttpRequest();
                } else if(window.ActiveXObject) { // IE
                        request = new ActiveXObject("Microsoft.XMLHTTP");
                }

                request.open('get', 'checksession.php', true);
                request.send();
                request.onreadystatechange = function() {

                    if(request.readyState == 4) 
                    {
                        var session = request.responseText;
                         if(session=="false")  {
                            alert("Your Session has expired");
                            window.location = "login.php";
                         }
                    }
                }
                request.send(null);
            }

            </script> 
```

脚本

```
 $user = $facebook->getUser();

    if ($user) {
      echo "false";
    } else {
      echo "true";
    } 
```

[无法使用 Facebook API 注销](http://facebook.stackoverflow.com/questions/8251524/cant-logout-using-facebook-api?rq=1)

我认为这可能会有所帮助。

# mysql - 具有分组、过程和“HAVING”的 MySQL 查询

> ID：13782675
> 
> 赞同：2
> 
> 时间：2012-12-08T22:41:02.763
> 
> 标签：mysql, sql, group-by, having, haversine

我目前有这个查询：

```
SELECT *, GEODIST(41.3919671, 2.1757278, latitude, longitude) distance
FROM offers_all
WHERE id_family=1761 AND GEODIST(41.3919671, 2.1757278, latitude, longitude) <= 40
GROUP BY id_prod ORDER BY pricepromo ASC 
```

如您所见，它使用称为 GEODIST（Haversine 公式，以 KM 为单位返回坐标之间的距离）的 MySQL 过程，并将结果按`id_prod`.

该表可能包含每个产品的多个报价 ( `id_prod`)。目标是检索报价列表，没有重复的产品，因此返回该报价的最佳（最便宜、最接近）案例。

前面的查询似乎做得很好，但为了进一步优化，我想使用`HAVING`（不必为每行运行两次 Haversine）。这是我的第一个想法：

```
SELECT *, MIN(GEODIST(41.3919671, 2.1757278, latitude, longitude)) distance
FROM offers_all
WHERE id_family=1761
GROUP BY id_prod
HAVING distance <= 40
ORDER BY pricepromo ASC 
```

遗憾的是，此查询不会返回与以前相同的结果。

不使用`MIN()`，结果不正确（仅返回一行）。使用`MIN()`（如在最后一个查询中），行信息不正确（即没有返回预期的行，导致结果在列表中显示错误的商店名称和价格）。

欢迎任何有关此目标（和其他建议）的最佳查询的提示或答案：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:03:53.237

您可以使用派生表执行此操作：

```
SELECT t.*, MIN(t.distance) AS distance
FROM (SELECT *, GEODIST(41.3919671, 2.1757278, latitude, longitude) AS distance
    FROM offers_all
    WHERE id_family=1761) AS t
WHERE t.distance <= 40
GROUP BY t.id_prod
ORDER BY t.pricepromo ASC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:10:39.707

我很确定有些人会建议使用相同的表别名加入方法，所以我会采用“其他建议”的尝试：

您是否已经在该项目中使用 Sphinx，可能用于全文产品搜索？Sphinx 可以为您提供对地理距离的内置支持，只是我过去在该主题上获得的一些随机 URL：

[http://www.fliquidstudios.com/2011/06/17/an-introduction-to-distance-based-searching-in-sphinx/](http://www.fliquidstudios.com/2011/06/17/an-introduction-to-distance-based-searching-in-sphinx/)

[http://www.sanisoft.com/blog/2011/05/02/geo-distance-search-in-sphinx/](http://www.sanisoft.com/blog/2011/05/02/geo-distance-search-in-sphinx/)

更多关于 Sphinx 论坛本身的主题：

[http://sphinxsearch.com/forum/view.html?id=7276](http://sphinxsearch.com/forum/view.html?id=7276)

此外，也许您更愿意采用“Tiles”方法来提高性能：

[http://sphinxsearch.com/forum/view.html?id=7823](http://sphinxsearch.com/forum/view.html?id=7823)

[http://sphinxsearch.com/forum/view.html?id=2482](http://sphinxsearch.com/forum/view.html?id=2482)

[http://sphinxsearch.com/forum/view.html?id=5688](http://sphinxsearch.com/forum/view.html?id=5688)

# android - 如何强制活动在开始之前关闭？

> ID：13782680
> 
> 赞同：0
> 
> 时间：2012-12-08T22:41:10.613
> 
> 标签：android, alarmmanager, android-alarms

我正在做一个警报应用程序，我正在使用一种方法在特定时间启动一个活动，我在我的应用程序中有一个名为 enable\disable 的选项，我不希望警报打开活动（它播放当我选中禁用框时，声音并具有我选择的图像）！因此，我正在寻找一种在活动开始之前关闭活动的方法，并且不要在屏幕上显示任何内容以表明活动正在开始和关闭！我正在使用这种方法在特定时间打开特定活动

```
 Intent myIntent = new Intent(SharedPrefs.this,MainPhoto.class);
     pendingIntent = PendingIntent.getActivity(MainPhoto.this, 0, myIntent, 0);
     AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
     Calendar calendar = Calendar.getInstance();
     calendar.setTimeInMillis(System.currentTimeMillis()+10000);
     alarmManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), pendingIntent); 
```

这有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T22:44:25.520

如何[**取消警报**](http://developer.android.com/reference/android/app/AlarmManager.html#cancel%28android.app.PendingIntent%29)，或者使用将要打开的服务而不是活动来检查它是否需要打开活动？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:50:08.660

我建议将复选框作为共享首选项，然后在您触发新活动的意图之前，检查它是否被禁用...如果您确实想启动新活动，请检查复选框是否检查，如果是，调用finish();

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    if (Checkbox.checked())
        finish();
} 
```

希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:53:42.603

取消警报可能是这里最好的解决方案。

可能有一些罕见的情况，直到活动被调用后您才知道。在这些情况下，只需`finish()`在之前调用`setContentView`

```
 @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        if (/* Check here if valid */) {
            finish();
        } else {
            setContentView(R.layout.some_layout);
            /* Actually do your initialization. */
        }
    } 
```

# c# - 流式传输生成的音调

> ID：13782683
> 
> 赞同：1
> 
> 时间：2012-12-08T22:41:40.217
> 
> 标签：c#, audio, asp.net-mvc-4, audio-streaming, html5-audio

我想用 System.Beep 生成音调并将音调从 Web 应用程序流式传输给用户。我在想我的选择是：

*   流式传输以某种方式生成的音调。
*   保存 wav 文件并使用`<audio>`标签播放音频。

我想尝试在生成音调时对其进行流式传输，但我无法弄清楚如何做到这一点，或者这是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T22:53:37.497

你想看看[IIS 媒体服务](http://www.iis.net/media)；他们能够提供流媒体音频。一个简单的解决方案是使用表达式编码器之类的东西来创建一个播客。播客恰好是您的哔哔声。

# database - 设计我们的数据库、表结构、关系

> ID：13782689
> 
> 赞同：1
> 
> 时间：2012-12-08T22:41:59.833
> 
> 标签：database

因此，我们正在构建某种“辩论”游戏。有不同的游戏类型，决斗和小组讨论，它们都有一些明确的规则，例如辩论的长度，参与者限制等。

```
debates
    id
    title
    body
    created
    modified

   debate_posts
        id
        debate_id
        body
        user_id
        created
        modified

debate_participants
    user_id
    debate_id 
```

我需要知道的是如何检查辩论何时开始（必须至少有两个参与者）我应该在第二个加入时存储一些时间戳或类似的东西吗？

我想知道的第二件事是如何定义获胜者，我是否应该有第三张表来定义辩论的“获胜者”，user_id 和辩论_id？

我不太确定我应该在问题中添加什么样的细节，但如果您有什么可以提供给我的，我很乐意听到。

**更新**

辩论者将能够发布帖子，直到时间结束，如果哪个用户/组获胜，则将有其他用户投票。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:44:09.890

我想您需要第二个参与者加入的时间戳才能知道辩论何时开始。任何时候用户加入辩论查询辩论_participants 以查看该特定辩论中有多少不同的用户，如果有，则新参与者将是第二个并设置辩论的开始时间戳。

找出辩论何时开始的另一种方法是在辩论帖子表中查找第二个用户在辩论中发表帖子的最早时间。

要定义获胜者，如果最多有一个获胜者，您只需在辩论中添加一个获胜者 ID 字段，这是您存储用户的关键所在。

# magento - Magento 中的可配置产品不适用于购物车规则

> ID：13782690
> 
> 赞同：1
> 
> 时间：2012-12-08T22:42:01.003
> 
> 标签：magento, discount, configurable-product

我正在尝试基于属性和数量创建规则，并且无法在同一规则中使用数量和属性，除非它们都引用父产品。

好吧，这引起了一个问题，因为我想做 5 个 5ml 瓶（5ml 大小是简单产品的属性）来触发免费礼物和折扣。

更大的问题，我有另一个尺寸的瓶子会触发不同的折扣，但因为它们都在同一个父产品下，所以它不起作用。互相抵消，或者我可以一个工作而不另一个工作。

如果有人对此有任何想法，我将不胜感激。

梅根

# c - 了解二维 MPI 网格中流程的维度、坐标和顺序

> ID：13782694
> 
> 赞同：11
> 
> 时间：2012-12-08T22:43:39.770
> 
> 标签：c, mpi

我有 3 个问题，都与 MPI（C 语言）有关。我认为前两个有相同的答案，但我并不肯定。

* * *

### 问题 1

**用于`MPI_Dims_create`创建二维网格时，返回的维度中哪个维度是X，哪个是Y？**

例如：

```
int numProcs = -1, myProcID = -1;
MPI_Comm_rank(MPI_COMM_WORLD, &myProcID);
MPI_Comm_size(MPI_COMM_WORLD, &numProcs);

int size[2];
size[0] = size[1] = 0;
MPI_Dims_create(numProcs, 2, size);
int numProcs_y = -1, numProcs_x = 1; 
```

应该是：

```
numProcs_y = size[0];
numProcs_x = size[1]; 
```

或这个：

```
numProcs_x = size[0];
numProcs_y = size[1]; 
```

我尝试使用似乎会给我答案的进程数量（例如 6 个）来运行它。对于 6 个进程，`MPI_Dims_create`应该创建一个 3 行 2 列或 2 行 3 列的网格（除非我误解了文档）。对于进程 3（共 6 个），我发现`size[0] = 1`和`size[1] = 0`（我相信这对应于 x = 0，y = 1）。这似乎向我表明`MPI_Dims_create`正在创建一个具有 3 行和 2 列的网格（因为它是 2 行和 3 列，进程 2（共 6 个）应该有 x = 2，y = 0）。任何人可以对此提供的确认将不胜感激。

* * *

### 问题2

**在二维笛卡尔网格上使用`MPI_Cart_coords`时，返回的维度中哪个是 X，哪个是 Y？**

例如：

```
int periodic[2];
periodic[0] = periodic[1] = 0; // no wrap around
MPI_Comm cart_comm;
int coords[2];

// using size from question 1
MPI_Cart_create(MPI_COMM_WORLD, 2, size, periodic, 1, &cart_comm);
MPI_Cart_coords(cart_comm, myProcID, 2, coords); 
```

与问题1类似，我的问题是，应该是这样吗

```
myProcID_y = coords[0];
myProcID_x = coords[1]; 
```

或者像这样

```
myProcID_x = coords[0];
myProcID_y = coords[1]; 
```

我一直在这里搜索文档和以前的问题，但我似乎无法找到这个问题的直接答案。

文档似乎表明这两种方法中的第一种是正确的，但并没有明确说明。

* * *

### 问题 3

前 2 个问题背后的根本问题是我试图将 2D 网格拆分为行和列。但是，当我`MPI_Comm_rank`在这样做之后检查每个进程的行 ID 和列 ID 时，我得到的进程排序顺序与我认为上述问题的答案不匹配。

基于上述，我希望流程的顺序如下：

```
P0 P1
P2 P3
P4 P5 
```

但是，使用此代码（它出现在我的程序中的上述代码之后，因此可以从中访问所有上述代码：我试图分离出我的代码以便更容易地隔离我的问题）：

```
MPI_Comm row_comm, col_comm;
int row_id = -1, col_id = -1;
// ** NOTE: My use of myProcID_y and myProcID_x here are based 
// on my understanding of the previous 2 questions ... if my 
// understanding to one/both of those is wrong, then obviously the assignments 
// here are wrong too.
// create row and column communicators based on my location in grid
MPI_Comm_split(cart_comm, myProcID_y, myProcID_x, &row_comm);
MPI_Comm_split(cart_comm, myProcID_x, myProcID_y, &col_comm);

// get row and column ID for each process
MPI_Comm_rank(row_comm, &row_id);
MPI_Comm_rank(col_comm, &col_id);
printf("Process: %d\trowID: %d\tcolID: %d\n", myProcID, row_id, col_id); 
```

我看到以下打印：

```
Process: 0 rowID: 0        colID: 0
Process: 1 rowID: 1        colID: 0
Process: 2 rowID: 0        colID: 1
Process: 3 rowID: 1        colID: 1
Process: 4 rowID: 0        colID: 2
Process: 5 rowID: 1        colID: 2 
```

这似乎对应于以下过程顺序：

```
P0 P2 P4
P1 P3 P5 
```

这是与我所期望的相反的矩阵维度（2 行，3 列）`MPI_Dims_create`。

**假设我对前两个问题的理解是正确的（即 Y 是这些函数返回的第一个维度），为什么在此步骤中（看似）以不同的顺序对过程进行排序？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T00:13:50.090

Q1 和 Q2。MPI 中没有维度 X 和维度 Y 之类的东西 - 这些是您为标准中使用的抽象维度提供的标签。MPI 使用编号维度并遵循 C 行主要编号的等级，即在`2x3`笛卡尔拓扑中`(0,0)`映射到 rank `0`、`(0,1)`映射到 rank `1`、`(0,2)`映射到 rank `2`、`(1,0)`映射到 rank`3`等等。

请注意，维度`0`对应于坐标元组中*最右边的元素。*这与 C 数组中元素的编号*相反*，通常是混乱的根源。要创建`2x3`笛卡尔拓扑，`size`必须将数组初始化为：

```
int size[2] = { 3, 2 }; 
```

您可以将抽象编号的维度映射到您的问题。您可以选择维度`0`为 X，或者您可以选择维度`1`- 没关系。

至于`MPI_DIMS_CREATE`，标准说：

> 使用适当的可分性算法将维度设置为尽可能接近。
> 
> 对于`dims[i]`由调用设置的，`dims[i]`将按非递增顺序排序。

此操作仅返回具有以下属性的元素数组（除非通过在调用之前`dims[i]`设置非零值来固定一个或多个维度的大小）：`dims[]``MPI_DIMS_CREATE`

*   `dims[0] >= dims[1] >= dims[2] >= ...`
*   `dims[0] * dims[1] * dims[2] == nprocs`，其中`nprocs`是进程数，指定为`MPI_DIMS_CREATE`。

这意味着当`MPI_DIMS_CREATE`将 的集合分解`nprocs`为多维网格时，它会将最大的乘数分配给维度的大小`0`，将下一个分配给维度的大小`1`，依此类推。像`6`因素一样`2*3`，那么`MPI_DIMS_CREATE`就会回归`{ 3, 2 }`。如果您`MPI_CART_CREATE`直接使用 的结果调用`MPI_DIMS_CREATE`，它将创建一个`2x3`具有坐标和等级的拓扑：

```
(0,0)=0 (0,1)=1 (0,2)=2
(1,0)=3 (1,1)=4 (1,2)=5 
```

Q3。MPI 提供了一个特殊的例程来划分笛卡尔拓扑 - `MPI_CART_SUB`. 它采用标准中命名的逻辑标志数组（C 中的整数）`remain_dims`。每个非零`remain_dims[i]`表示该维度`i`应保留在生成的分区中，同时将为非保留维度的任何可能组合创建单独的子通信器。例如，给定`2x3`拓扑：

*   `remain_dims[] = { 1, 0 }`将保留维度`0`并导致 2 个不重叠的 1-d 通信器，每个通信器有 3 个进程；
*   `remain_dims[] = { 0, 1 }`将保留维度`1`导致 3 个不重叠的一维通信器，每个通信器有 2 个进程；
*   `remain_dims[] = { 0, 0 }`不会保留两个维度中的任何一个，并将导致 6 个不重叠的零维通信器，每个通信器都有一个进程。

哪个分区可以称为行分区，哪个分区可以称为列分区，这取决于您和您对笛卡尔维度的标记。

* * *

需要注意的一件事是，人们经常在由联网 SMP 或 NUMA 多核节点组成的系统上运行 MPI 代码。在这种情况下，合适的 2D 网格将是`nodes x cores`. 如果内核的数量是已知的，那么可以很容易地在调用中修复它`MPI_DIMS_CREATE`：

```
int size[2] = { ncores, 0 };

MPI_Dims_create(numProcs, 2, size); 
```

这比除以和检查可除性更方便`numProcs`，`ncores`因为如果不除`MPI_DIMS_CREATE`会发出错误信号。然后是保持维度的分区，即一个与`ncores``numProcs``0`

```
int remain_dims[2] = { 1, 0 }; 
```

将创建包含同一节点上的进程的子通信器，而

```
int remain_dims[2] = { 0, 1 }; 
```

将创建不包含来自同一节点的两个进程的子通信器。

* * *

请注意，在您的代码中，您为in`1 (true)`中的`reorder`参数指定了一个值`MPI_CART_CREATE`。这可能会导致进程`MPI_COMM_WORLD`在笛卡尔通信器中具有不同的等级。因此，不能保证以下代码行会按照您的预期进行：

```
MPI_Cart_coords(cart_comm, myProcID, 2, coords);
                           ^^^^^^^^
...
printf("Process: %d\trowID: %d\tcolID: %d\n", myProcID, row_id, col_id);
                                              ^^^^^^^^ 
```

`myProcID`是从 中获得的，`MPI_COMM_WORLD`并且实际上可能与 中的新等级不同`cart_comm`，因此不应使用它来获取过程坐标和执行拆分。

# javascript - 获取 Json 对象上的项目总数？

> ID：13782698
> 
> 赞同：106
> 
> 时间：2012-12-08T22:44:46.187
> 
> 标签：javascript, json

> **可能重复：**
> [Javascript 对象的长度（即关联数组）](https://stackoverflow.com/questions/5223/length-of-javascript-object-ie-associative-array)

我有一个类似于这个的对象：

```
var jsonArray = {
  '-1': {
    '-1': 'b',
    '2': 'a',
    '10': 'c'
  },
  '2': {
    '-1': 'a',
    '2': 'b',
    '10': 'a'
  },
  '5': {
    '-1': 'a',
    '2': 'a',
    '10': 'b'
  }
}; 
```

我试图获得它的长度，问题是`jsonArray.length`返回 5 而不是 3（这是它拥有的总项目）。数组相对较长（有 1000x2000 个项目），每秒必须执行很多次。如何更有效地获取项目数量？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2012-12-08T22:52:02.957

除了 kieran 的回答，显然，现代浏览器还有一个`Object.keys`功能。在这种情况下，您可以这样做：

```
Object.keys(jsonArray).length; 
```

此答案中有关[如何列出 javascript 对象的属性的更多详细信息](https://stackoverflow.com/a/208020/165988)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-08T22:51:56.500

那是一个对象，你想计算它的属性。

```
Object.keys(jsonArray).length 
```

参考：

*   [`Object.keys`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys).
*   [Kangax的兼容表](http://kangax.github.com/es5-compat-table/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-08T22:49:53.947

那是你的实际代码吗？javascript 对象（这是你给我们的）没有长度属性，所以在这种情况下`exampleArray.length`返回 undefined 而不是 5。

[这个 stackoverflow](https://stackoverflow.com/questions/4690520/javascript-object-literal-length-undefined)解释了对象和数组之间的长度差异，[这个 stackoverflow](https://stackoverflow.com/questions/5223/length-of-javascript-object-ie-associative-array)显示了如何获取对象的“大小”。

# php - file_get_contents 在共享主机中返回空字符串

> ID：13782699
> 
> 赞同：1
> 
> 时间：2012-12-08T22:44:46.307
> 
> 标签：php, json, web-services, file-get-contents, datasnap

我正在尝试使用 file_get_contents() 获取 url 内容，它在我的本地主机服务器中工作，但在共享主机服务器中，该函数返回一个空字符串，**没有错误**。我的代码如下：

```
$uri = 'http://my_url.com:81/datasnap/rest/TServerMethods/getLoginCliente/galf/123/';
$result = file_get_contents($uri);
var_dump($result); 
```

结果是：

```
string(0) "" 
```

代替：

```
{result: [4532,1]} 
```

**我正在测试更改 google.com 的网址，并且效果很好。**

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T23:57:34.620

问题是防火墙主机。防火墙封锁了 81 端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:07:50.557

检查是否启用了 fopen url 包装器：

```
var_export(ini_get('allow_url_fopen')); 
```

我想它只是作为潜在的不安全操作被禁用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:47:23.283

在你的 php 文件的顶部添加这个

```
// Report all PHP errors (see changelog)
error_reporting(E_ALL); 
```

然后寻找它给你的任何错误。共享主机可能已禁用该特定功能，为了使其正常工作，您必须要求他们启用它。

# android - AS3 / AIR Google Play 应用程序 ID 和扩展文件访问

> ID：13782703
> 
> 赞同：0
> 
> 时间：2012-12-08T22:45:06.060
> 
> 标签：android, actionscript-3, air, google-play, expansion

我开发了一个与名为“main.1000000.com.mycompany.myapp.obb”的主扩展文件链接的应用程序。我使用

```
File.applicationStorageDirectory.resolvePath('Android/obb/' + FILENAME) 
```

在 Windows 上的调试模式下指示文件存在的方法。但上传到 Google Play 后，我注意到两个问题：

1) 应用程序 ID 已更改为前缀“air.”，因此现在为“air.com.mycompany.myapp”

2) 应用程序找不到成功下载的扩展文件。

```
File.applicationStorageDirectory.resolvePath('Android/obb/' + FILENAME).nativePath 
```

在设备上返回类似“/data/data/air.com.mycompany.myapp/com.mycompany.myapp/LocalStore/main.1000000.com.mycompany.myapp.obb”的东西，这很奇怪，因为没有应用程序ID .air 前缀，然后加上。

我真的不知道我错过了什么或者这是否是问题所在，所以有人可以给我并建议我应该在 resolvePath 方法中使用什么参数来解决它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T14:06:14.210

“Android/obb”在documentsDirectory而不是在应用程序存储目录

# picasa - Picasa 公共网络相册缩略图检索

> ID：13782704
> 
> 赞同：1
> 
> 时间：2012-12-08T22:45:09.513
> 
> 标签：picasa

给定公共 Picasa 网络相册的 URL（相册不是我的），有没有办法检索该相册的缩略图？Picasa Web API 似乎以知道 Picasa 用户名为中心，但我不知道用户名，只知道相册的公共链接。

应该是一个简单的问题。对于 YouTube，这只是对视频 URL 的调整，但对于 Picasa Web 来说似乎并非如此。我在这里错过了什么吗？

# mysql - 如何计算等于或加起来等于某个时移的记录？

> ID：13782711
> 
> 赞同：2
> 
> 时间：2012-12-08T22:45:54.857
> 
> 标签：mysql, sql, database

假设我有一个名为“志愿者”的 mysql 表，其中显示了已签约工作特定时间班次的人：

```
Volunteers 
==============
**UserId** int   
**StartTime** datetime    
**EndTime** datetime 
```

假设该表包含以下记录：

```
(1, '2012-01-01 00:00:00', '2012-01-01 01:00:00')
(2, '2012-01-01 00:00:00', '2012-01-01 00:30:00')
(3, '2012-01-01 00:30:00', '2012-01-01 01:00:00')
(4, '2012-01-01 00:00:00', '2012-01-01 00:15:00')
(5, '2011-12-31 23:00:00', '2012-01-01 02:00:00')
(6, '2012-01-01 00:00:00', '2012-01-01 00:00:30')
(7, '2012-01-01 00:00:00', '2012-01-01 00:40:00') 
(8, '2012-01-01 00:20:00', '2012-01-01 01:00:00') 
```

我想计算此表中用户已注册从 00:00:00 到 01:00:00 工作的所有记录，但也包括在此计数中可以聚合到此所需时移的时移。

例如，使用上面的示例，理想的 sql 查询将返回**4**。

解释：

用户 1 已注册工作整个所需的班次，因此这会将计数加 1。

用户 2 和 3 已注册工作时间班次，这些时间班次汇总到所需的时间班次，因此计数会增加 1。

用户 4 的时移无法与另一个用户的时移聚合以覆盖所需的时移，因此这不会增加计数。

用户 5 覆盖了整个所需的时移，因此这会将计数加 1。

用户 6 的时移可以与用户 8 的时移聚合以覆盖所需的时移，因此这会将计数加 1。

用户 7 有一个时移，可以与用户 8 的时移聚合以覆盖所需的时移，但如果用户 8 已经与用户 6 聚合以产生所需的时移，则不应将其包括在计数中。因此，这不会添加到计数中。

因此，计数等于 4。

你会怎么做呢？这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T03:35:04.903

我认为您的问题不适合用 SQL 完全解决。这是我将如何解决它。

选择与您感兴趣的班次重叠的所有志愿者。

然后在您的应用程序层（php/.NET/perl/whatever）中应用此算法：

1.  对这些区间进行排序，并将它们拆分为子区间，使它们全部不相交或相等。

2.  计算每种类型的相等子区间的数量。

3.  这个计数的最小值就是你的答案。

# .net - 从点识别多个（图形）对象的边缘

> ID：13782713
> 
> 赞同：3
> 
> 时间：2012-12-08T22:46:12.143
> 
> 标签：.net, image, image-processing, computer-vision, object-detection

我有一个应用程序可以识别网络摄像头图像中的运动。它产生类似以下的东西......

![在此处输入图像描述](../Images/2c445bd8150fa76135c35fd0cde1192a.png)

黑色区域表示运动。这主要是在每个像素的基础上完成的（尽管考虑了附近的像素）

所以......现在我已经为每个像素设置了运动真/假，我需要使用该信息来识别对象轮廓。

我想要的是以下内容。

![在此处输入图像描述](../Images/332b8e164860191ff7d3696fe32fde1e.png)

轮廓不必精确，我可以接受边界框。如果我将两者结合起来，还有一些噪音区域会更明显......

![在此处输入图像描述](../Images/17182f5c9abf2bc39293cdc5a3e03504.png)

如您所见，对象外部有几个“运动”像素。据推测，我会通过指定对象的最小区域来消除这些。

那么，有哪些算法可以识别物体的边缘。理想情况下，我可以使用这些信息来计算每个对象的大致中心。

注意：正如@mmgp 所提到的，上面的图像都是全RGB，甚至是黑白的。这是由于我生成用于导出的图像的方式。在内部，它是一个位数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:35:12.787

这似乎是数学形态学的完美任务。要移除在这种情况下是噪声的小对象，请按区域执行形态学打开。该区域在您的问题中很容易估计，因为感兴趣的区域比不需要的区域大得多。现在您还想消除大对象内部的孔（请注意，您的示例中有一些孔）。为此，您执行称为孔填充的操作，该操作将简单地丢弃那些无法从图像背景到达的点。此时，您可以继续检测对象的质心，但如果您想让对象的边界更加统一，您可以使用具有小结构元素的形态膨胀或形态闭合来可能保留更多对象。

这些任务在 Matlab 中执行为：

```
f = imread('http://i.stack.imgur.com/DexHs.png');
% The PNG is in RGB, but it actually describes a binary image.    
f = ~im2bw(f, 0);
g = bwareaopen(f, 100); % 100 is the maximum area for unwanted objects here
h = imfill(g, 'holes');
l = bwlabel(h);
cent = regionprops(l, 'centroid'); 
```

结果是：

![在此处输入图像描述](../Images/bba1763a23689861e69e95d45a0dc9cc.png)

两条闭合的白色曲线是剩余对象的边界，黄色是它们的质心。如果您想要此答案的初始评论中描述的“更软”的边界：

```
h1 = imclose(h, strel('disk', 3)); 
```

![在此处输入图像描述](../Images/71d702c1a7edc7ee2d022889d512571c.png)

我看到您将其标记为 .net，但我希望这些工具在某些 .net 包中很容易获得，因为它们非常基本且常见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T13:06:38.610

我的建议是让你使用 emgu (opencv) 来完成这些任务，它比你可能知道的 matlab 复杂一点，但它更快。

OpenCV 已经为您实现了**侵蚀和扩张**形态操作：

[http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=morphology#dilate](http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=morphology#dilate)

[http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=morphology#erode](http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=morphology#erode)

或morphologyex 适用于更**通用的形态学操作**：

[http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=morphology#morphologyex](http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=morphology#morphologyex)

它还具有**findContours**功能，您可以将其视为一个斑点检测器。在您的情况下，您可以将您的第一张图像提供给它（可能经过一些去噪预处理之后），它会返回这些形状。如果需要，这些返回的形状很容易按区域过滤。

**findContours 文档：**

[http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=findcontours#findcontours](http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=findcontours#findcontours)

# html - Firefox 不居中主 div

> ID：13782719
> 
> 赞同：1
> 
> 时间：2012-12-08T22:46:55.173
> 
> 标签：html, css

我正在尝试使用 margin:0px auto 将主 div 居中；但它不会在Firefox中工作。它适用于 Chrome 和 IE，不知道为什么会发生这种情况。

CSS：

```
#mami{

width:1200px;

margin:0px auto;

} 
```

html:

```
<body>

<div id='mami'>
   <h1>Center Me</h1>
</div>

</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:00:20.673

您的 div 在 Firefox 中居中。[http://jsfiddle.net/nTXeq/2/](http://jsfiddle.net/nTXeq/2/)

![在此处输入图像描述](../Images/2c336a69a559ccbde633ef3ed693cdd6.png)

如果你想在 div 中居中文本，你需要专门针对它：

```
#mami {
text-align: center;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:53:52.987

尝试在没有 px 的情况下放置 margin: 0 auto; 但是你必须在 div 标签内添加一些东西，否则什么都不会显示，你什么也看不到。

```
<style>.asdf{background:silver;width:1200px;margin:0 auto;height:20px}</style><div class="asdf">Should Center</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T22:58:40.710

围绕它设置一个 DIV，名称为 like wraper，宽度为 100%。然后将该元素居中在 f 中，使用：

HTML：

```
<div id="globalContainer">
    <div id="mami">
        This is some text!
    </div>
</div> 
```

CSS：

```
#globalContainer{
    width:100%;
}

#mami{
    margin-left:auto;
    margin-right:auto;
    width:1200;
} 
```

# zend-framework - Zend 默认视图脚本名称切换

> ID：13782721
> 
> 赞同：0
> 
> 时间：2012-12-08T22:46:56.623
> 
> 标签：zend-framework, zend-view, zend-layout

我想显示移动视图而不是普通视图脚本。

让我们以这个动作/my_module/my_controller/my_action为例。

当我调用它时，根据一些标头处理，我知道用户代理是移动设备。然后我将主布局设置为特定于移动设备的布局。我这样做，它工作正常：`Zend_Layout::getMvcInstance()->setLayout('mobile');`

但是在我的控制器或其他地方，我想覆盖`my_action.phtml`类似`my_action_mobile.phtml`.

考虑到在我的某些观点中我正在使用动作助手，如何做到这一点：`<?php echo $this->action("index", "index", "items")?>`或者我的某些动作是这样的 _forward：`$this->_forward("index", "auth", "default");`

我已经尝试使用`setViewSuffix('mobile')`和使用几个文件名变体：my_action.mobile.phtml，或者`setViewSuffix('mobile.phtml')`名为 my_action.mobile.phtml 的文件和其他文件，导致空白页 - 没有错误，什么都没有。（我不知道为什么，因为它设置为显示抛出的错误）

我也尝试过使用 contextSwitching 但它禁用了我的主布局 - 我不想要这个 - 感觉它不能正确处理动作视图助手。（在另一个视图中呈现）

我会很感激任何建议。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T12:44:10.997

您可以使用它来更改控制器的视图
`$this->render('actionName')`；

或者，您可以通过调用直接调用视图脚本 `$this->renderScript('path/to/viewscript.phtml')`；

[您可以从此处](http://framework.zend.com/manual/1.12/en/zend.controller.actionhelpers.html)获取有关 render() 和 renderScript() 方法的更多详细信息。[使用 $this->renderScript 时](https://stackoverflow.com/questions/11079333/assigning-values-to-views-when-using-this-renderscript)
也检查此 SO 帖子Assigning Values to Views

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T14:03:47.410

关于这个主题的信息非常多。对于初学者来说，请通过[http://static.zend.com/topics/Mobile-web-app-with-ZF.pdf](http://static.zend.com/topics/Mobile-web-app-with-ZF.pdf)

简而言之，您应该使用 ContextSwitch。

1.  您创建了一个插件，它定义了从 Zend_Http_UserAgent 派生的可用上下文和格式参数。
2.  在控制器中，您描述了哪些操作符合这些上下文的条件。
3.  为这些操作创建不同的视图。

# python - python将字符串转换为字符集

> ID：13782725
> 
> 赞同：0
> 
> 时间：2012-12-08T22:47:26.797
> 
> 标签：python

```
c=['a,b,c','a,b,c','a,b']
for item in c:
    a=set(item.replace("'",""))
    b=list(a)
print b 
```

它返回：

```
['a','b',','] 
```

我想要的是：

```
['a','b','c'] 
```

如何将这些字符串转换为字符集？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T23:08:14.407

```
c = ['a,b,c','a,b,c','a,b']
result = set()
for item in c:
  result.update(item.split(','))
print result 
```

这是我所做的：

1.  创建一个名为的集合`result`，以便我们可以将值存储在其中
2.  遍历`c`每个字符串中的字符串，当我们看到“，”字符时，我们将其拆分为一个新的字符串列表。
3.  `result`使用拆分字符串的值更新集合
4.  打印结果

因为`result`是一个集合，它不能包含同一项目的多个实例。所以当我们调用`result.update()`任何重复的条目时，都会被自动忽略。

如果您希望结果按所需输出排序，则必须执行以下操作，因为集合是无序的：

```
result = list(result)
result.sort()
print result 
```

列表有一个内置的排序方法。因此，从集合中创建一个列表然后调用`sort()`它会对列表进行适当的排序，这意味着它不会返回任何内容，而是修改列表本身。这样做会给你`['a', 'b', 'c']`你想要的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-08T22:58:00.250

```
>>> c=['a,b,c','a,b,c','a,b']
>>> print set(unique for charlist in c for unique in charlist.split(','))
set(['a', 'c', 'b']) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-08T22:52:18.643

```
c = ['a,b,c', 'a,b,c', 'a,b']
print (set (''.join (c).replace (',', '') ) ) 
```

# android - Android：如何在获取位置之前等到 LocationService 设置 GlobalVars

> ID：13782729
> 
> 赞同：1
> 
> 时间：2012-12-08T22:48:05.140
> 
> 标签：android, android-service, android-location

我有一个`LocationService`类（扩展`Service`实现`LocationListener`），只要通过该`onLocationChanged`方法获得新位置，它就会不断更新全局变量。

在`onCreate`我的启动器活动的方法中，我启动了这个服务。接下来我要做的是调用一个从全局变量中获取纬度和经度的 Web 服务。

这给了我一个`NullPointerException`位置全局变量，我假设它是因为服务在单独的线程上运行并且尚未获得位置。

问题：我如何做到只有在从服务类获得位置时才调用 Web 服务？

非常感谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:59:09.937

我认为等待它不好（取决于浪费的时间），因为活动永远无法开始，但您可以尝试使用以下简单代码：

```
While(latitude == null);
use latitude and longitude
continue with oncreate... 
```

但我的建议是尝试与其他 AsyncTask 一起检查它，以确保不要进行主动等待。希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T21:11:54.850

`YourService``LocationOperator`当位置改变时通知每个注册的人。`LocationOperator`是一个简单的接口，声明`operate(Location)`方法。

```
class YourService extends Service implements LocationListener {
    private List<LocationOperator> listeners = new ArrayList<LocationOperator>();

    public List<LocationOperator> getListeners() {
            return listeners;
    }

    @Override
    public void onLocationChanged(Location location) {
            for (LocationOperator listener : listeners) {
                    listener.operate(location);
            }
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
            // request location updates from `LOCATION_SERVICE`
            return Service.START_NOT_STICKY;
    }

    //...
} 
```

从您的主要活动启动并连接到此服务

```
public class MainActivity extends Activity {

    static YourService yourService;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        //...
        Intent service = new Intent(this, YourService.class);
        startService(service);
        bindService();
    }

    // ...
} 
```

然后您就可以访问此服务`MainActivity`并注册`Location`

```
public class OperatorActivity extends Activity implements LocationOperator {

    @Override
    public void onCreate(Bundle instance) {
        // ...
        MainActivity.yourService.getListeners().add(this);
        // ...
    }

    public void operate(Location location) {
        // use location
    }
} 
```

# java - Java中的基本数组[]树数据结构

> ID：13782732
> 
> 赞同：6
> 
> 时间：2012-12-08T22:48:23.023
> 
> 标签：java, arrays

这是一个家庭作业问题，所以我不是在寻找完整的代码答案。

我已经上了一个班狗

```
package lab12;

import java.io.Serializable;

public class Dog implements Serializable{

    public Dog[] children;
    public String name;

    public Dog(String name)
    {
        this.name = name;
    }

    @Override
    public String toString()
    {
        return name;
    }

} 
```

还有一个数据文件，其中包含一个根狗 Spot，它的子节点存储在一个数组中。我需要编写可以打开数据文件的代码，然后单步执行树数据结构以查看输入名称是否是根 (Spot) 的后代。

我非常有信心可以打开数据文件。我正在努力创建以数组作为链接的节点的语法。我们的教科书只涵盖了二叉树，它要么链接到左边，要么链接到右边，但没有链接到可变数量的链接。我找到了一个使用 List 方法的通用示例。

```
public class Tree<T> 
{
    private Node<T> root;

    public static class Node<T> 
    {
        private T data;
        private Node<T> parent;
        private List<Node<T>> children;
    }

    public Tree(T rootData) 
    {
        root = new Node<T>();
        root.data = rootData;
        root.children = new ArrayList<Node<T>>();
    }
} 
```

因为我必须使用数据文件，所以除了将子节点存储在 Dog[] 中之外，我无法将节点的结构更改为其他任何内容。我找不到使用基本数组存储子节点的节点类的示例，而且我无法弄清楚这样做的语法。我认为在我尝试学习它之前，在没有泛型的情况下看到它会有助于我的理解。

到目前为止，这是我的代码：

```
package lab12;

public class DogTree 
{
    //Start Inner Class
    private static class Node
    {
        private String name;
        private Node parent;
        private Node Dog[] children; //This is where I'm confused
    }
    //End Inner Class

    private Node root;

    public DogTree()
    {
        root = null;
    }

    public boolean isDescendant(String name)
    {
        return isInSubtree(name, root);
    }

    private static boolean isInSubtree(String name, Node subTreeRoot)
    {
        if(subTreeRoot == null)
        {
            return false;
        }
        else if(subTreeRoot.name.equals(name))
        {
            return true;
        }
        else
        {
            //This is where my confusion on the 
            //node design causes implementation problems
            return isInSubtree(name, subTreeRoot.children); 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-23T14:54:21.920

您需要遍历子数组。

```
private static boolean isInSubtree(String name, Node subTreeRoot)
    {
        if(subTreeRoot == null)
        {
            return false;
        }
        else if(subTreeRoot.name.equals(name))
        {
            return true;
        }
        else
        {
           for( int i = 0; i< subTreeRoot.children.length();i++)
             if(isInSubtree(name, subTreeRoot.children[i]))
            return true;
        }
        return false;

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-23T15:46:04.830

这些算法中数组和数组列表之间的主要区别在于您的数组容量有限，并且您需要处理项目（小狗）的分配；

如果任务是学习数组，则不应专注于泛型。Generic 允许您为对象的通用功能定义模板。最好在完成时将实现更改为通用而不是从它们开始解决具体问题。

您现在拥有的是这样的课程：

```
class Dog {

    private String name;
    private Dog[] puppies

    public Dog(String name)
    {
        this.name = name;
    }

} 
```

您可以做的是向其中添加将执行某些操作的特定方法。

```
class Dog {

    private final String name;
    private final Dog[] puppies = new Dog[20]; //We create 20 slots for puppies to fill
    private int  puppiesCount = 0;

    public Dog(String name)
    {
        this.name = name;
    }

    public addPuppie(Dog puppie) {
      this.puppies[puppiesCount] = puppie; //We assign the puppie to this Dog puppies.
      this.puppiesCount = puppiesCount + 1; //We increment the count of puppies
    }

    public Dog[] getPuppies() {
      return Arrays.copyOf(puppies, puppiesCount); 
    }

    public boolean isMyPuppie(Dog puppie) {

        for(int = 0; i < puppiesCount; i++) {

          if(puppies[i] == puppie) { //We compare the object references to state that are equal
             return true;
          }

        }

      return false;
    }
} 
```

这是如何转移到树上的。

由于每个对象都有一个 is self 数组，因此可以嵌套它们。

```
Dog max = new Dog("Max");

Dog tom = new Dog("Tom"); //childOfRoot;

Dog barry = new Dog("Barry);"// child of Tom 
```

要创建一棵树，您需要执行类似的操作。

```
tom.addPuppie(barry); // We assign barry to tom
max.addPuppie(tom); // we assign tom to max. 
```

这个概念应该通过深度搜索来扩展，您需要引入递归搜索并且可以添加从子到父的关系。

# vb.net - 正确使用 PrintPreview 对话框

> ID：13782735
> 
> 赞同：3
> 
> 时间：2012-12-08T22:48:42.220
> 
> 标签：vb.net, printing, print-preview

这是我第一次使用打印预览，我很困惑，所以我需要一个建议：

![在此处输入图像描述](../Images/74bc584b6b56a1259ca4ed4aac56c285.png)

这是我要打印的对话框：

这是它目前在我的 PrintPreview 对话框中的外观（搞砸了）： ![在此处输入图像描述](../Images/b78c0a9f8b063088a43a34e29d3efa04.png)

这是我目前的完整代码：

```
Public Class frmPRINT

Private Sub btnPrint_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
    PrintDocument1.Print()
End Sub
Private Sub PrintDocument1_PrintPage(ByVal sender As System.Object, ByVal e As System.Drawing.Printing.PrintPageEventArgs) Handles PrintDocument1.PrintPage

    Dim bm As New Bitmap(DataGridView1.Width, DataGridView1.Height)
    DataGridView1.DrawToBitmap(bm, New Rectangle(0, 0, DataGridView1.Width, DataGridView1.Height))
    e.Graphics.DrawImage(bm, 0, 0)

End Sub

Private Sub btnPrintPreview_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPrintPreview.Click

    PrintPreviewDialog1.WindowState = FormWindowState.Normal
    PrintPreviewDialog1.StartPosition = FormStartPosition.CenterScreen
    PrintPreviewDialog1.ClientSize = New Size(600, 600)

    PrintPreviewDialog1.Document = PrintDocument1
    PrintPreviewDialog1.ShowDialog()
End Sub
End Class 
```

请问如何正确设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:12:54.160

将页面方向设置为横向

```
printDocument1.DefaultPageSettings.Landscape = true 
```

有关详细信息，请参阅有关[`PrintDocument.DefaultPaperSettings`](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.defaultpagesettings%28v=vs.71%29.aspx).

# eclipse - 按照说明为Eclipse搭建Hadoop

> ID：13782736
> 
> 赞同：0
> 
> 时间：2012-12-08T22:48:49.343
> 
> 标签：eclipse, plugins, hadoop

这个 Apache 页面[http://wiki.apache.org/hadoop/EclipseEnvironment](http://wiki.apache.org/hadoop/EclipseEnvironment)似乎解释了如何下载 Hadoop 并构建它。如果我按照该页面的说明进行操作，它是否也将 Eclipse 插件添加到 Eclipse，或者该说明仅用于构建核心 Hadoop？

谢谢，香农

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:51:37.480

此信息已有一年多的历史，讨论了一种将 hadoop 源下载并导入 Eclipse 的方法，以便您可以更改核心 hadoop 代码。

如果您只想开发在 hadoop 之上运行的 hadoop 作业，那么您可以

*   为 Eclipse 安装 hadoop 插件（我从未使用过），或者
*   使用 maven 为您的代码定义 hadoop 库依赖项（我经常这样做）。这（加上在您的本地机器上安装 hadoop）将让您在 Eclipse 中开发、调试和测试 hadoop 作业。

所以不，这个页面与 Eclipse 的 hadoop 插件无关。

# ios - 处理 UIPageControl 的旋转

> ID：13782739
> 
> 赞同：1
> 
> 时间：2012-12-08T22:49:04.733
> 
> 标签：ios, uiinterfaceorientation

我有一个`UIPageControl`包含多个`UILabel`和`UIImageView`每个页面的内容。

使用以下代码：

```
pageControl.numberOfPages=[arrData count];
for(int i=0;i<[arrData count];i++) {
    NSString *body=[NSString stringWithString:[[arrData objectAtIndex:i] objectForKey:@"body"]];
    NSLog(@"body %d=%@",i,body);

    CGRect frame;
    frame.origin.x = self.scrollView.frame.size.width * i;
    frame.origin.y = 0;
    frame.size.width = self.scrollView.frame.size.width;
} 
```

我正确地看到了肖像中的物品。当设备旋转时，显然布局被破坏，因为`self.scrollView.frame`被称为纵向布局。我如何处理旋转创建`UIScrollViews`和`UIPageControls`代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:20:31.937

您的具体问题与“仅横向”视图的框架无关（这是框架和边界的不正确表示，我建议您观看[关于 UIKit 渲染的谈话](https://developer.apple.com/itunes/?destination=adc.apple.com.8270634034.08270634040.8367260927?i=1122536585)的开头，因为它们有很好的解释坐标系。这与您的视图没有被告知在旋转的情况下该做什么有关。

自动旋转，预约束（iOS 6 >），可以用自动调整掩码处理（具体来说，在你的情况下，我猜[UIViewAutoresizingFlexibleTopMargin](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/doc/c_ref/UIViewAutoresizingFlexibleTopMargin)可能是你需要的）。如果您的目标是 iOS 6+，也可以使用[VFL](http://developer.apple.com/library/mac/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/formatLanguage.html)对其进行限制。

# c++ - 在 C++ 中共享内存？

> ID：13782742
> 
> 赞同：0
> 
> 时间：2012-12-08T22:49:30.430
> 
> 标签：c++

有人可以向我解释一下数据是如何被利用的，因为我在搞乱以下代码......：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct MyStruct {
public:
    void print() {
        printf("MyStruct.print():\n\ta: %i\n\tb: %i\n\n", a, b);
    }
    void store() {
        a = 2;
        b = 3;
    }
private:
    int a, b;
};

typedef struct MyStruct2 {
public:
    void print() {
        printf("MyStruct2.print():\na: %i\nb: %i\n\n", a, b);
    }
    void store() {
        a = 1024;
        b = 3077;
    }
private:
    int a, b;
};

int main() {
    void *ptr = malloc(sizeof(MyStruct)); // sizeof(MyStruct) == sizeof(MyStruct2)
MyStruct* pstruct = (MyStruct*)ptr;

pstruct->store();
pstruct->print();

MyStruct2* pstruct2 = (MyStruct2*)ptr;

pstruct2->store();
pstruct->print();

return 0;
} 
```

我得到了以下结果：

```
MyStruct.print():
        a: 2
        b: 3

MyStruct.print():
        a: 1024
        b: 3077 
```

如您所见，我没有为 pstruct2 分配更多内存，但我能够访问它。任何人都可以向我解释，或者至少给我一个参考/教程来解释它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T22:51:57.180

两者`pstruct`和都`pstruct2`指向内存中的相同位置（因为您将存储在两者中的地址分配`ptr`给两者），因此该方法插入的数据被该`MyStruct::store`方法覆盖`MyStruct2::store`。

换句话说，这是因为你明确地让它发生了。如果你的两个类不相同，或者编译器产生了不同的内存布局，你可能会读出垃圾数据。

* * *

基本上，C++ 允许您尽可能多地写入任何动态分配的内存，很高兴地忽略和忘记了您之前曾将此内存用于另一个对象的事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:51:53.613

未定义的行为，恰好成功地假装它有效。

> 3.10 左值和右值 [basic.lval]
> 
> ...
> 
> 10 如果程序尝试通过非下列类型之一的左值访问对象的存储值，则行为未定义：
> 
> — 对象的动态类型

# node.js - nodejs express服务器在使用护照进行身份验证后没有响应url

> ID：13782747
> 
> 赞同：1
> 
> 时间：2012-12-08T22:50:18.447
> 
> 标签：node.js, express, passport.js

在我的情况下，只要我不登录，GET / 就可以工作，但是当我通过访问 GET /login 成功登录时，它会尝试重定向到 / 但服务器没有响应，随后服务器对 GET / 没有任何响应，直到服务器重新启动. 这种情况仅在浏览器中观察到。谁能解释我

```
/**
 * Module dependencies.
 */

var express = require('express')
 , routes = require('./routes')
 , user = require('./routes/user')
 , http = require('http')
 , path = require('path')
 , cons = require('consolidate');

var passport = require('passport')
, LocalStrategy = require('passport-local').Strategy;

var app = express();
var User=require('./class/User');
app.configure(function(){
app.set('port', process.env.PORT || 3000);
app.set('views', __dirname + '/views');
app.set('view engine', 'html');
app.use(express.favicon());
app.use(express.logger('dev'));
app.use(express.bodyParser());
app.use(express.methodOverride());
app.use(express.cookieParser('your secret here'));
app.use(express.session({ secret: 'keyboard cat' }));
//// passport auth ///////////
app.use(passport.initialize());
app.use(passport.session());
///////////////////////////////
app.use(app.router);
app.use(express.static(path.join(__dirname, 'public')));
});

// These lines are required to register underscore template
var _ = require('underscore');
app.engine('html', cons.underscore);

app.configure('development', function(){
  app.use(express.errorHandler());
});

passport.use(new LocalStrategy(
  function(username, password, done) {
    var user=User.auth(username, password);

    if(user)
    {
      console.log("success");
      return done(null, user); 
    }
    else
    { console.log("error");
        return done(null, false, { message: 'Incorrect credentials.' });}
    /*(User.findOne({ username: username }, function(err, user) {
    if (err) { return done(err); }
    if (!user) {
      return done(null, false, { message: 'Incorrect username.' });
    }
    if (!user.validPassword(password)) {
      return done(null, false, { message: 'Incorrect GET /login 200 30ms - 313
      password.' });
    }
    return done(null, user);
  });*/
 }
));
passport.serializeUser(function(user, done) {
done(null, user.userid);
});

passport.deserializeUser(function(id, done) {
/*findById(id, function (err, user) {
done(err, user);
});*/
});

app.post('/login',
passport.authenticate('local', { successRedirect: '/',
                              failureRedirect: '/login',
                              failureFlash: false })
);

app.get('/', routes.index);
app.get('/login', routes.login);
app.get('/users', user.list);

http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

# session - 编写一个 cron 表达式以每 15 分钟执行一次

> ID：13782749
> 
> 赞同：6
> 
> 时间：2012-12-08T22:50:35.203
> 
> 标签：session, cron

我正在尝试设置一个 cron 作业，以在我的会话目录上每 15 分钟运行一次垃圾收集器，以清理超出我在 php.ini 中设置的到期限制的会话，位于我的一个子目录位置。我以前从未使用过 cron 作业，所以我想知道是否有人可以帮助我。

到目前为止，我所拥有的是：

```
15 * * * * /home/yadda/something/etc 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-08T23:12:29.107

以下是每 15 分钟执行一次的表达式：

```
0 0/15 * 1/1 * ? * 
```

所以你的表达是：

```
0 0/15 * 1/1 * ? * /home/yadda/something/etc 
```

您可能对[cronmaker](http://cronmaker.com/)网站感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-17T10:16:27.243

如果您使用的是 anacron（ubuntu 默认），那么符号就是 */15，如

`*/15 * * * * /home/yadda/something/etc`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-27T11:02:11.657

如果您使用调度程序，请访问[Cron Maker 网站。](http://www.cronmaker.com/)`Quartz` `opensource`

每 15 分钟：

```
0 0/15 * 1/1 * ? * 
```

每天：

```
0 0 12 1/1 * ? * 
```

# windows-8 - 将 Windows 8 VHD 添加到启动菜单

> ID：13782751
> 
> 赞同：-1
> 
> 时间：2012-12-08T22:50:47.087
> 
> 标签：windows-8, boot, vhd, bcdedit

这些是我用来将 VHD 映像添加到启动菜单的步骤：

```
bcdedit /copy {originalguid} /d "New Windows 7 Installation"

bcdedit /set {newguid} device vhd=[D:]\Image.vhd
bcdedit /set {newguid} osdevice vhd=[D:]\Image.vhd
bcdedit /set {newguid} detecthal on 
```

这与 Windows 7 VHD 完美配合，但 Windows 8 VHD 似乎不喜欢它。它确实出现在启动菜单中，但在选择时，我的 PC 会进入以前操作系统的 Windows 修复模式，然后重新启动。

我还尝试了基于上述过程的[BCDEdit UI 。](http://bcdeditui.codeplex.com)它以前适用于 Windows 7 VHD，但适用于 Windows 8 VHD 时再次失败。

有什么我可能错过的吗？在这两种情况下，我都使用 Windows 7 作为基本操作系统。

**更新：** 出于安全原因，我最好使用不涉及第三方软件的方法（我知道我在这里有点偏执），最重要的是，我需要能够将 VHD 从一台机器带到另一台机器，而无需驱动问题。因此，使用另一个现有基本操作系统的驱动程序的 VHD 将是理想的，就像以前的情况一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T02:58:17.763

1.  你挂载 VHD 说 V：

2.  由于 VHD 是 Windows 8，您必须将 Windows 8 启动文件放置到活动分区。（Windows 7 启动管理器无法启动 Windows 8！）

    [“双启动修复”实用程序](http://www.boyans.net/DualBootRepair.html)可以提供帮助 - 您单击“自动修复”按钮即可完成。

您还可以使用以下命令来完成任务：

**bcdboot V:\Windows**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-19T18:51:38.013

我将我的评论添加到实际脚本中。

添加命令：`bcdedit /set {newguid} nointegritychecks ON`

这将防止 Windows 进入修复模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T05:27:55.393

Scott Hanselman 在这方面做了一些出色的文章。这是一个，虽然它可能有点过时（它是为 Win8 Developer Preview 编写的），但基本步骤仍然有效：

[http://www.hanselman.com/blog/GuideToInstallingAndBootingWindows8DeveloperPreviewOffAVHDVirtualHardDisk.aspx](http://www.hanselman.com/blog/GuideToInstallingAndBootingWindows8DeveloperPreviewOffAVHDVirtualHardDisk.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-03T07:10:33.483

我创建了一个工具来创建 VHD，应用 Windows 映像并将其添加到启动菜单：

[http://www.fiechter.eu/Blog/Post/40](http://www.fiechter.eu/Blog/Post/40)

兄弟，阿德里安

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-29T06:43:42.910

请查看[这篇](http://technet.microsoft.com/en-us/library/hh825691.aspx)文章，我试了一下，我可以`vhdx`在物理机上正确地从文件启动。

# c++ - 子类化 Win32 时的静态类行为怪异

> ID：13782752
> 
> 赞同：0
> 
> 时间：2012-12-08T22:50:53.847
> 
> 标签：c++, c, winapi, scrollbar

```
LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{

    int wmId, wmEvent;
    PAINTSTRUCT ps;
    HDC hdc;
    static HWND hDirectives;
    static char inBuffer [256] = "hey";
    static LPWSTR lpszBuffer = (LPWSTR)malloc(256*sizeof(LPWSTR));

    switch (message)
    {
    case WM_CREATE:
        hDirectives = CreateWindow(TEXT("static"), NULL, WS_CHILD | WS_BORDER | WS_VISIBLE | SS_RIGHT | SS_SUNKEN | WS_VSCROLL, 
            20, 20, 300, 300, hWnd, (HMENU) ID_DIRECTIVE, ((LPCREATESTRUCT) lParam) ->hInstance, NULL);
        SetWindowLong(hDirectives, GWL_WNDPROC, (LONG) DirectiveProc);
        break;

    case WM_COMMAND:
        wmId    = LOWORD(wParam);
        wmEvent = HIWORD(wParam);
        // Parse the menu selections:
        switch (wmId)
        {
        case IDM_ABOUT:
            DialogBox(hInst, MAKEINTRESOURCE(IDD_ABOUTBOX), hWnd, About);
            break;
        case IDM_EXIT:
            DestroyWindow(hWnd);
            break;

        default:
            return DefWindowProc(hWnd, message, wParam, lParam);
        }

    case WM_PAINT:
        hdc = BeginPaint(hWnd, &ps);
        // TODO: Add any drawing code here...
        EndPaint(hWnd, &ps);
        break;
    case WM_DESTROY:
        PostQuitMessage(0);
        break;
    default:
        return DefWindowProc(hWnd, message, wParam, lParam);
    }
    return 0;
}

LRESULT CALLBACK DirectiveProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    PAINTSTRUCT ps;
    HDC hdc;
    HWND hParent = (HWND)GetWindowLong(hWnd, GWL_HWNDPARENT);
    static int nScrollPos;
    static SCROLLINFO si;
    switch(message)
    {
    case WM_PAINT:
        hdc = BeginPaint(hWnd, &ps);
        // TODO: Add any drawing code here...
        EndPaint(hWnd, &ps);

    case WM_SIZE:
        si.cbSize = sizeof(si);
        si.fMask  = SIF_RANGE | SIF_PAGE;
        si.nMin = 0;
        si.nMax = 10;
        si.nPage = 5;
        SetScrollInfo(hWnd, SB_VERT, &si, TRUE);
        return 0;

    case WM_VSCROLL:
        si.cbSize = sizeof(si);
        si.fMask  = SIF_ALL;
        GetScrollInfo(hWnd, SB_VERT, &si);

        nScrollPos = si.nPos;
        switch(LOWORD(wParam))
        {
        case SB_THUMBTRACK:
            si.nPos = si.nTrackPos;
            break;
        default:
            break;
        }
        si.fMask = SIF_POS;
        SetScrollInfo(hWnd, SB_VERT, &si, TRUE);
        GetScrollInfo(hWnd, SB_VERT, &si);

        if(si.nPos!=nScrollPos)
        {
            ScrollWindow(hWnd, 0, 5 * (nScrollPos - si.nPos), NULL, NULL);
            UpdateWindow(hParent);
        }
        return 0;
    default:
        DefWindowProc(hWnd, message, wParam, lParam);

    }
    //CallWindowProc(WndProc, hParent, message, wParam, lParam);  wasn't sure if I was supposed to add this
} 
```

所以我不想将滚动功能添加到我的静态控件中，所以我对它进行了子类化，但现在我遇到了问题。我不想做的是我不想在我的静态控件中显示文本然后滚动它。如果没有子类化，我可以在窗口中显示文本。现在有了子类化，控件显示为全白色，而不是之前的灰色，并且尝试设置文本失败。此外，当我滚动时，即使用户滚动时我在 DirectiveProc 中更新父窗口，静态控件也会在其窗口之外绘制。我的目标是创建一个静态控件，其中包含用户可以滚动浏览的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:18:02.050

评论者已经通过不遵循子类化规则确定了您遇到的许多问题，这些规则在 MSDN 上列出：

*   [子类化控件](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773183.aspx)

# shell - meteorJS 从服务器调用一个 shell 命令

> ID：13782754
> 
> 赞同：9
> 
> 时间：2012-12-08T22:50:57.247
> 
> 标签：shell, meteor

我正在使用 MeteorJS。

我想从 javascript 服务器端调用 bash 命令。这似乎可以用 nodeJS： [http ://www.dzone.com/snippets/execute-unix-command-nodejs](http://www.dzone.com/snippets/execute-unix-command-nodejs)

但是，我找不到与 meteorJS 类似的东西。我想要这样的东西：

```
if(Meteor.isServer){
...

exec("myCommand");
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-08-14T11:57:48.033

您也可以使用 child_process.spawn()。

**[阅读有关使用 Meteor 执行 UNIX 命令的更多信息](http://journal.gentlenode.com/meteor-14-execute-a-unix-command/)。**

```
spawn = Npm.require('child_process').spawn;

command = spawn('ls', ['-la']);

command.stdout.on('data',  function (data) {
  console.log('stdout: ' + data);
});

command.stderr.on('data', function (data) {
  console.log('stderr: ' + data);
});

command.on('exit', function (code) {
  console.log('child process exited with code ' + code);
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-09T10:15:12.647

如果您从示例中调用 require 并在它们前面加上

```
var sys = __meteor_bootstrap__.require('sys'); 
```

它应该工作。

# javascript - 将 Wordpress 博客文章拉入 Angular JS

> ID：13782756
> 
> 赞同：4
> 
> 时间：2012-12-08T22:51:33.810
> 
> 标签：javascript, apache, angularjs

我想从[http://blog.neosavvy.com/?feed=rss2](http://blog.neosavvy.com/?feed=rss2)之类的东西中提取博客提要，以便在不在同一个域中的 Angular 应用程序中使用。

我打算使用 ProxyPass，但是 ProxyPass 不能与 /?feed=rss2 一起使用。是否有一个重写规则可以用来避免 Javascript 在获取不在同一个 URL 中的内容时出现的跨域问题。

我使用 AngularJS 的服务来获取提要内容，就像任何其他服务一样。

这是我用来获取博客 rss 的代码：

```
$scope.getBlogPost = function() {
    $http({method:'GET', url:'http://blog.neosavvy.com/?feed=rss2'}).
        success(function (data, status, headers, config) {
            console.log("data returned");
        }).
        error(function (data, status, headers, config) {
            console.log("data not returned");
        });
} 
```

这是我收到的错误-因此需要代理通行证或其他替代方法。

XMLHttpRequest 无法加载[http://blog.neosavvy.com/?feed=rss2](http://blog.neosavvy.com/?feed=rss2)。Access-Control-Allow-Origin 不允许来源[http://local.something.com 。](http://local.something.com)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-09T00:59:56.760

您可以使用[YQL](http://developer.yahoo.com/yql/)或[Google Feed API之类的东西](https://developers.google.com/feed/)

我用后者做了一个例子，你可以在这里查看：[http ://plnkr.co/edit/Plb1fz?p=preview](http://plnkr.co/edit/Plb1fz?p=preview)

您将使用 Google Feed API 而不是使用该`$http`服务，您的控制器将如下所示

```
app.controller('ctrl', function($scope) {
  var feed = new google.feeds.Feed("http://blog.neosavvy.com/?feed=rss2");
  feed.load(function(result) {
    $scope.$apply(function(){
      $scope.entries = result.feed.entries;
    })
  });
}); 
```

请注意，由于范围从 Angular 外部发生变化，`$apply`因此需要调用 来通知 Angular。

一些注意事项，首先您需要将以下脚本添加到您的文档中

*   [https://www.google.com/jsapi](https://www.google.com/jsapi)
*   角清理.min.js

然后，有必要手动引导您的 Angular 应用程序，因为必须先加载 Google Feed API

```
google.load("feeds", "1");
google.setOnLoadCallback(function(){     
    angular.bootstrap(document.body, ['app']);
}); 
```

由于提要包含 html，因此您将*ngSanitize*模块声明为依赖项

```
var app = angular.module('app', ['ngSanitize']); 
```

要在提要中显示条目，您可以使用`ngRepeater`迭代接收到的条目，当然还可以使用`ng-bind-html`指令清理 html。

```
<div ng-repeat='entry in entries'>
  <h1>{{entry.title}}</h1>
  <div ng-bind-html= "entry.content"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T22:56:38.097

有问题的 URL 是一个 RSS 提要。无需考虑跨站点脚本。RSS 是一种旨在从任何地方提取的 XML 格式。

几乎任何 JavaScript 框架都可以满足您的要求。[维基百科上的“RSS”](http://en.wikipedia.org/wiki/RSS)。

# javascript - HighCharts : 向图表的 X 轴添加超链接

> ID：13782758
> 
> 赞同：10
> 
> 时间：2012-12-08T22:51:52.330
> 
> 标签：javascript, html, charts, highcharts, jsfiddle

我一直在我的 PHP 网站中使用 HighCharts，方法是从旧图表中迁移它，这个库的图形选项和函数的数量给我留下了深刻的印象。

但是，我无法提供指向 x 轴（或 y 轴）值的超链接以导航到另一个 URI。

在这种情况下的类别代码

```
xAxis: {
    categories: [
        'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'
    ]
}, 
```

任何人都可以指出我在 Highcharts 上的示例或文档（如果有）。

谢谢

# 编辑：答案

这是链接类别名称的 jsfiddle：http: [//jsfiddle.net/a5Bdt/](http://jsfiddle.net/a5Bdt/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-08T22:56:46.130

自从我在 highcharts 中完成工作已经有一段时间了，但我相信你只需要提供一个[`formatter`](http://api.highcharts.com/highcharts#xAxis.labels.formatter)函数。例如：

```
xAxis: {
    categories: [
        'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'
    ],
    labels: {
        formatter: function () {
            return '<a>' + this.value + '</a>'
        },
        useHTML: true
    }
}, 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-13T06:00:04.370

```
var categoryLinks = {
        'Foo': 'http://www.google.com',
        'Bar': 'http://www.facebook.com',
        'Foobar': 'http://www.stackoverflow.com'
    };
    $('#container').highcharts({
        xAxis: {
            categories: ['Foo', 'Bar', 'Foobar'],

            labels: {
                formatter: function () {
                    return '<a href="' + categoryLinks[this.value] + '">' +
                        this.value + '</a>';
                }
            }
        },
        series: [{
            data: [300, 200, 600]
        }]
    }); 
```

# c# - 鼠标滚轮事件未触发

> ID：13782763
> 
> 赞同：19
> 
> 时间：2012-12-08T22:52:07.040
> 
> 标签：c#, winforms, events, charts, mousewheel

我已经查看了有关完全相同问题的[线程，但该解决方案对我不起作用。](https://stackoverflow.com/questions/1190147/cant-fire-mousewheel-event-in-c-sharp-windows-forms)
基本上，当用户与 Windows 窗体上的图表控件交互时，我想要完成的是鼠标滚轮事件。
现在我已经尝试了一些不同的东西。

```
 public mainForm()
 {
     InitializeComponent();
     this.chData.MouseWheel +=new MouseEventHandler(chData_MouseWheel);
 } 
```

我也尝试将其添加到 mainForm.Designer.cs：

```
this.chData.TabIndex = 2;
this.chData.Text = "chart2";

this.chData.MouseWheel += 
   new System.Windows.Forms.MouseEventHandler(this.chData_MouseWheel);

this.chData.MouseClick += 
   new System.Windows.Forms.MouseEventHandler(this.chData_MouseClick);

this.chData.MouseDoubleClick += 
   new System.Windows.Forms.MouseEventHandler(this.chData_MouseDoubleClick);

this.chData.MouseMove += 
   new System.Windows.Forms.MouseEventHandler(this.chData_MouseMove); 
```

（我在这里包含了整个块以进行演示）。我也有如下定义的函数：

```
private void chData_MouseWheel(object sender, MouseEventArgs e)
{
   MessageBox.Show("FJDKS");
} 
```

不幸的是，我不能让这该死的东西开火？谁能告诉我哪里出错了？提前致谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-08T23:08:40.443

需要关注图表控件，以便触发鼠标滚轮事件。您可以在鼠标进入控件时设置焦点，并在鼠标离开时将焦点返回给其父级。

```
void friendChart_MouseLeave(object sender, EventArgs e)
{
    if (friendChart.Focused)
        friendChart.Parent.Focus();
}

void friendChart_MouseEnter(object sender, EventArgs e)
{
    if (!friendChart.Focused)
        friendChart.Focus();
} 
```

# tomcat - 将 Grails 2.1.1 应用程序部署到 Tomcat 作为一场爆炸式的战争？

> ID：13782770
> 
> 赞同：4
> 
> 时间：2012-12-08T22:53:22.383
> 
> 标签：tomcat, grails, deployment, war, openshift

我试图在 OpenShift 上部署一个 Grails 应用程序，并且我试图避免每次更改都在网络上推送一个 50MB 的文件。

我创建了一个项目`~/dev/apps/grails/test`来测试它

基于[这个答案](https://stackoverflow.com/a/10214138/47633)，我添加了

```
grails.war.exploded=true 
```

to `grails-app/conf/BuildConfig.groovy`，这导致创建此文件夹：

```
/home/sas/.grails/2.1.1/projects/test/stage 
```

**我怎么能告诉它在哪里制造爆炸战争`~/dev/apps/grails/test/target/test-0.1`？**

像这样复制文件夹：

```
cp -r /home/sas/.grails/2.1.1/projects/test/stage ~/dev/tomcat/webapps/test-0.1 
```

工作正常，但我正在尝试自动化整个过程以提供 OpenShift 的快速启动脚本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T23:04:43.627

刚刚查看了 grails/scripts/_GrailsWarPlugin.groovy 的源代码

只需要添加

```
grails.project.war.exploded.dir = "target/${appName}-${appVersion}"
grails.war.exploded=true 
```

到 grails-app/conf/BuildConfig.groovy

# javascript - 我到底应该在哪里附加 HTML 中的脚本？

> ID：13782771
> 
> 赞同：0
> 
> 时间：2012-12-08T22:53:25.967
> 
> 标签：javascript, html

我已经阅读了几种在 HTML 文档中嵌入 Javascript 的方法。首先，在头部：

```
<head>
...
<script src="abc.js"></script>
</head> 
```

其次，在文档正文的末尾：

```
<body>
<!-- content -->
<script src="abc.js"></script>
</body> 
```

第一种方式更美观，但第二种方式确保加载 DOM 中的所有项目。我使用 HTML5（但可能没关系）

哪种方式更好，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:56:56.870

这取决于您何时需要脚本中的功能。在页面加载之前或其他。如果您的示例中的第二个无关紧要，则更好，更安全，因为它允许加载页面内容。脚本中的错误可能会阻止这种情况发生在正文之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T23:00:11.250

如果它只是一个在页面加载时不应该运行的函数库，您可以安全地将其放在头部。否则，您需要`abc.js`用`window.onload`or将代码包装起来`$(document).ready();`，然后将其嵌入头部

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T23:01:13.887

如果您需要页面完全加载，很大程度上取决于您何时需要执行脚本。您可以将其放在头部，然后使用该`onload`事件执行一个函数。

# python - 如何在 virtualenv 中安装 pygtk？

> ID：13782776
> 
> 赞同：2
> 
> 时间：2012-12-08T22:53:58.030
> 
> 标签：python, gtk, ipython

我在虚拟环境（1.13 和 2.7.2）中安装了 ipython 并尝试`ipython -gui=gtk`了但仍然获得了基本的终端界面，例如没有 %paste 支持。

现在我尝试安装 pygtk 但也没有成功。

我正在使用 OpenBox WM 运行 Crunchbang linux。

```
 [TerminalIPythonApp] GUI event loop or pylab initialization failed
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
...python2.7/local/lib/python2.7/site-packages/IPython/lib/inputhook.pyc in enable_gui(gui, app)
    526         e = "Invalid GUI request %r, valid ones are:%s" % (gui, guis.keys())
    527         raise ValueError(e)
--> 528     return gui_hook(app)
    529 

...python2.7/local/lib/python2.7/site-packages/IPython/lib/inputhook.pyc in enable_gtk(self, app)
    286         IPython.
    287         """
--> 288         import gtk
    289         try:
    290             gtk.set_interactive(True)

ImportError: No module named gtk 
```

我试图在我激活的 virtualenv 中 pip install pygtk 但没有运气。

完整日志：

```
$ pip install pygtk
Downloading/unpacking pygtk
  Downloading pygtk-2.24.0.tar.bz2 (2.4MB): 2.4MB downloaded
  Running setup.py egg_info for package pygtk
    ********************************************************************
    * Building PyGTK using distutils is only supported on windows. *
    * To build PyGTK in a supported way, read the INSTALL file.    *
    ********************************************************************
    Complete output from command python setup.py egg_info:
    ********************************************************************

* Building PyGTK using distutils is only supported on windows. *

* To build PyGTK in a supported way, read the INSTALL file.    *

********************************************************************

----------------------------------------
Command python setup.py egg_info failed with error code 1 in ...python2.7/build/pygtk 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T15:18:13.147

由于您正在运行基于 debian 的发行版；您可以简单地省去一些麻烦`sudo apt-get install ipython`（`sudo apt-get install ipython3`如果您想使用 Python 3）。

这将确保也安装了正确的 GTK 绑定。这是*最受支持的方式*。

最新版本的 ipython 可以自动检测虚拟环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-25T09:21:08.193

我首先用 pip 安装了 gi（在 ubuntu 上）并得到了同样的错误，没有 virtualenv。我的解决方案是卸载 gi: `sudo -H pip uninstall gi` 然后安装使用： `sudo apt-get install --reinstall python-gi`

# java - 如何确保每个当前正在运行的客户端的唯一 ID 以及确保每个 ID 匹配模式

> ID：13782777
> 
> 赞同：0
> 
> 时间：2012-12-08T22:54:02.987
> 
> 标签：java

因此，假设您有一个 Java 网络程序，其中服务器同时为多个客户端提供服务，每个客户端访问其信息的方式只需输入其 ID。在服务器为客户端启动线程之前，您希望它确保一旦客户端程序开始运行，用户输入的 id 尚未被当前正在运行的线程使用，并且它匹配特定的模式（比如 4 位数字）。我解决这个问题的方法是让服务器类在执行任何操作之前为当前正在运行的线程的 id 声明和初始化一个数组列表，使用正则表达式检查 id 是否为 4 位数长，如果是然后检查 id 是否在 arraylist 中，如果不是，则线程可以开始。代码如下图：

```
 while(true)
  {
     ClientWorker w;
     try
     {
        w = new ClientWorker(server.accept());
        String validid = w.accountnumber;
        if(validid.matches("\\d[4]"))
        {
             if(!currentusers.contains(validid))
             {
                currentusers.add(validid);
                Thread t = new Thread(w);
                t.start();
             }
             else
             {
                 System.out.println("Already in session");
             }
        }
        else
        {
            System.out.println("not a valid id");
        }
 } 
```

问题是我的两个目标都没有实现，它只会导致以前工作的程序出错：无论我输入什么 id，客户都会继续前进并询问我想要进行哪些交易。然后，如果我尝试实际执行任何操作，则当我尝试匹配 if 语句中的正则表达式以及告诉服务器在 main 方法中侦听与客户端套接字对应的端口时，服务器程序会崩溃并给我空指针异常。我认为问题是我想不出在线程启动之前获取客户端 id 的方法，因为在我看来，线程必须在用户输入他们的 id 之前启动，这会创建一个圆圈我必须平方。谁能帮我解决这个问题？PS：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:20:18.857

算法应该是：

```
while (true)
    accept a new client
    start a thread to communicate with the client 
```

线程应该这样做：

```
read the ID sent by the client
check if it's valid and add it to a set of IDs if not already present
if invalid or already present
    send an error message to the client
    stop running
else 
    continue the conversation with the client. 
    once the conversation ends, in a finally block, remove the ID from the set of IDs 
```

您应该使用 HashSet 而不是 List，因为它在查找时要快得多 (O(1))，并且您应该确保方法`checkIfIdPresentAndIfItDoesntThenAddTheId()`和`removeId()`正确同步，因为该集合由多个线程访问。

# javascript - 在 MooTool 的“Floom”脚本中使用图片作为链接？

> ID：13782783
> 
> 赞同：1
> 
> 时间：2012-12-08T22:54:48.207
> 
> 标签：javascript, html, mootools

当用户单击图像时，是否有任何方法可以加载特定网页？

* * *

正常的语法是：

```
var slides = [
            {
                image: 'image-url.jpg',
                caption: 'loriem ispum'
            } 
```

* * *

我希望能够做这样的事情。

```
var slides = [
            {
                image: 'nature-photo0.jpg',
                caption: 'loriem ispum'
                link: 'http://www.google.com'
            } 
```

* * *

这样，当我的用户点击图片时，他们将被定向到网址。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T21:36:33.653

我是 Floom 的作者。

该脚本提供了一个`onSlideChange`可用于实现此目的的事件。

首先将幻灯片注入 a `a`，然后使用`onSlideChange`（第一个参数是单个图像对象）现在只需`a`使用正确的链接更新 ：

```
onSlideChange: function(slide){
    link.set('href', slide.link);
} 
```

这应该有效。

# javascript - 加载 HTML 页面 (JavaScript)

> ID：13782785
> 
> 赞同：1
> 
> 时间：2012-12-08T22:55:21.893
> 
> 标签：javascript

我以前从未使用过Javascript，所以有点混乱。我对 HTML 和 C# 有一定的了解。

无论如何......我正在建立一个网站，并且我正在尝试做一个脚本来打开一个不同的 html 文档，例如 Chrome、Internet Explorer 等。问题是我不知道如何加载每个检测的特定 html 文档。我已经有一个脚本可以检测您使用的浏览器类型。

代码：

```
<script language="Javascript">

    var BrowserDetect = {
    init: function () {
        this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
        this.version = this.searchVersion(navigator.userAgent)
            || this.searchVersion(navigator.appVersion)
            || "an unknown version";
        this.OS = this.searchString(this.dataOS) || "an unknown OS";
    },
    searchString: function (data) {
        for (var i=0;i<data.length;i++) {
            var dataString = data[i].string;
            var dataProp = data[i].prop;
            this.versionSearchString = data[i].versionSearch || data[i].identity;
            if (dataString) {
                if (dataString.indexOf(data[i].subString) != -1)
                    return data[i].identity;
            }
            else if (dataProp)
                return data[i].identity;
        }
    },
    searchVersion: function (dataString) {
        var index = dataString.indexOf(this.versionSearchString);
        if (index == -1) return;
        return parseFloat(dataString.substring(index+this.versionSearchString.length+1));
    },
    dataBrowser: [
        {
            string: navigator.userAgent,
            subString: "Chrome",
            identity: "Chrome"
        },
        {   string: navigator.userAgent,
            subString: "OmniWeb",
            versionSearch: "OmniWeb/",
            identity: "OmniWeb"
        },
        {
            string: navigator.vendor,
            subString: "Apple",
            identity: "Safari",
            versionSearch: "Version"
        },
        {
            prop: window.opera,
            identity: "Opera",
            versionSearch: "Version"
        },
        {
            string: navigator.vendor,
            subString: "iCab",
            identity: "iCab"
        },
        {
            string: navigator.vendor,
            subString: "KDE",
            identity: "Konqueror"
        },
        {
            string: navigator.userAgent,
            subString: "Firefox",
            identity: "Firefox"
        },
        {
            string: navigator.vendor,
            subString: "Camino",
            identity: "Camino"
        },
        {       // for newer Netscapes (6+)
            string: navigator.userAgent,
            subString: "Netscape",
            identity: "Netscape"
        },
        {
            string: navigator.userAgent,
            subString: "MSIE",
            identity: "Microsoft Internet Explorer"
            versionSearch: "MSIE"
        },
        {
            string: navigator.userAgent,
            subString: "Gecko",
            identity: "Mozilla",
            versionSearch: "rv"
        },
        {       // for older Netscapes (4-)
            string: navigator.userAgent,
            subString: "Mozilla",
            identity: "Netscape",
            versionSearch: "Mozilla"
        }
    ],
    dataOS : [
        {
            string: navigator.platform,
            subString: "Win",
            identity: "Windows"
        },
        {
            string: navigator.platform,
            subString: "Mac",
            identity: "Mac"
        },
        {
               string: navigator.userAgent,
               subString: "iPhone",
               identity: "iPhone/iPod"
        },
        {
            string: navigator.platform,
            subString: "Linux",
            identity: "Linux"
        }
    ]

};
BrowserDetect.init();
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:04:44.627

您可以使用 jQuery.get()：

```
$.get('test.html', function(data) {
    $('.result').html(data);
    alert('Load was performed.');
}); 
```

有关详细信息，请参阅：[http ://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:08:58.117

方法很少，各有优缺点。
但正如评论的那样，基于浏览器“做事”并不是一个好习惯。

**1.ajax：** 可以使用[ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)根据浏览器动态加载html内容。

**2\. Redirect** 根据浏览器重定向到正确的页面。

**3.使用css显示正确的内容** 可以隐藏所有不相关的信息（使用display:none/visibility:hidden），根据浏览器显示正确的内容。

# c++ - 在 UDP 套接字中增加一个接收缓冲区

> ID：13782787
> 
> 赞同：-1
> 
> 时间：2012-12-08T22:56:15.710
> 
> 标签：c++, sockets, udp

我正在编写一个应用程序，它传输视频，显然为此目的使用了 UDP 协议。所以我想知道如何增加发送/接收缓冲区的大小，因为目前我可以发送的最大数据大小是 65000 字节。我已经尝试通过以下方式做到这一点：

```
int option = 262144;
if(setsockopt(m_SocketHandle,SOL_SOCKET,SO_RCVBUF ,(char*)&option,sizeof(option)) < 0)
{
    printf("setsockopt failed\n");

} 
```

但它没有用。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:01:44.683

> 我该怎么做？

你不能。IPv4 UDP 数据报的最大大小为 65535-20-8=65507 字节。增加缓冲区大小不能改变这一点。大于路径 MTU（< 1500 字节）的数据报将被分片，并且分片的数据报更有可能丢失，统计上，因此无论如何使用大约 64k 大小的数据报是相反的。

# powershell - Powershell - “清除项目变量：”与“删除变量”

> ID：13782788
> 
> 赞同：8
> 
> 时间：2012-12-08T22:56:18.197
> 
> 标签：powershell, resource-cleanup

在运行时将文本临时存储在 powershell 变量中时，在不再需要时从内存中删除变量内容的最有效方法是什么？

我已经使用了两者`Clear-Item variable:`，`Remove-Variable`但是使用后者从内存中删除某些内容与使用前者将内存内容清零的速度有多快？

编辑：我应该更清楚地说明我为什么要问。

我正在为一堆应用程序虚拟机自动 RDP 登录（应用程序不作为服务运行，外包开发人员，长篇大论）。

因此，我正在开发（基本完成）一个脚本，用于将启动会话分组到每个 VM。

想法是存储凭据的脚本函数`read-host`用于提示输入主机名，然后`get-credentials`获取域/用户/密码。

然后使用 256 位密钥（存储凭据并运行组启动的机器/用户独有的运行时密钥）从安全字符串转换通行证。

VM 名称、域、用户和加密通行证存储在一个文件中。启动会话时，读取详细信息，解密密码，传递详细信息`cmdkey.exe`以存储`\generic:TERMSRV`该 VM 的凭据，清除纯文本传递变量，将 mstsc 启动到该主机，几秒钟后从 Windows 凭据存储中删除凭据。（如果我将密码以非明文形式传递给 cmdkey.exe，则 RDP 会话将收到不正确的凭据或没有凭据）。

所以，因此问题是，我需要明文密码尽可能短地存在于内存中。

为了让安全人员满意，脚本本身是 aes256 加密的，并且带有自己的 ps 主机的 ac# 包装器读取、解密和运行脚本，因此运行它的机器上没有明文源。（文件共享上的加密源非常有效，我有一个终止开关，可以简单地用另一个显示该应用已被禁用的消息替换加密脚本）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-03-02T18:21:18.197

我能够确定地清除变量数据/内容的唯一方法是使用以下方法删除当前会话中运行的所有变量：

```
Remove-Variable -Name * -ErrorAction SilentlyContinue 
```

这会立即删除所有变量。事实上，我将它添加到我的一些脚本的末尾，以便我可以确定运行另一个可能具有相同名称的脚本，不会添加新数据并导致不希望的结果。

**缺点：**如果您只需要清除一个变量（几分钟前在我的情况下），那么您需要重新实例化脚本所需的输入变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-09T00:46:11.370

最有效的方法是让垃圾收集完成它的工作。请记住，Powershell 都是 .NET，具有著名的内存管理。始终控制您的范围，并确保变量在不需要时立即超出范围。例如，如果循环内部需要临时变量，它们将在循环结束时自动失效，因此无需担心，等等。

**编辑：**关于您的更新，为什么不这样做`$yourPasswordVariable = $null`呢？我认为这会更容易理解。这应该是最快的方法。因为`Remove-Item`and`Clear-Item`是一种多合一的处理程序，它们需要先处理一些东西，然后才能确定你真的想删除一个变量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-09T00:32:30.017

您可以使用秒表来获取命令行开关的执行时间。我认为这两个 cmdlet 之间并没有真正的时间差异。我通常使用“删除项目”，因为在我看来，最好删除一个完整的变量。

```
$a = "TestA"
$b = "TestB"
$c = "TestC"
$d = "TestD"

$time = New-Object system.Diagnostics.Stopwatch  

Start-Sleep 1
$time.Start() 
$time.Stop()
$system = $time.Elapsed.TotalMilliseconds
Write-Host "Stopwatch StartStop" $system
$time.Reset()

Start-Sleep 1
$time.Start() 
Clear-Item Variable:a
$time.Stop()
$aTime = $time.Elapsed.TotalMilliseconds - $system
Write-Host "Clear-Item in " $aTime
$time.Reset()

Start-Sleep 1
$time.Start() 
Remove-Variable b
$time.Stop()
$bTime  = $time.Elapsed.TotalMilliseconds - $system
Write-Host "Remove-Variable in " $bTime
$time.Reset()

Start-Sleep 1
$time.Start() 
Clear-Item Variable:c
$time.Stop()
$cTime = $time.Elapsed.TotalMilliseconds - $system
Write-Host "Clear-Item in " $cTime
$time.Reset()

Start-Sleep 1
$time.Start() 
Remove-Variable d
$time.Stop()
$dTime  = $time.Elapsed.TotalMilliseconds - $system
Write-Host "Remove-Variable in " $dTime
$time.Reset() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-09T01:48:25.713

两者都有效地删除了对 .NET 对象的“a”引用。现在，如果该引用是对该对象的最后一个引用，那么 GC 将确定何时收集该对象的内存。但是，如果您不再需要该变量，则使用也允许最终收集`Remove-Variable`与对象关联的内存。`System.Management.Automation.PSVariable`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-11T07:19:00.177

要测量运行脚本块和 cmdlet 所需的时间，请使用`Measure-Command`

# android - 在活动之间切换？

> ID：13782789
> 
> 赞同：1
> 
> 时间：2012-12-08T22:56:33.447
> 
> 标签：android

假设我有一个行星列表： 1\. 水星 2\. 金星 3\. 地球 4\. 火星 ....etc。

当用户在列表中单击 Earth 时，它会启动 EarthActivity，如果用户向左滑动，它会从那里启动下一个 Activity（在本例中为 MarsActivity）。

我的问题是我应该在活动之间滑动还是有更好的方法来做到这一点？如果有，你能给我指一个教程吗？另外假设我的列表更大，列表中有 99 个项目。我必须创建 99 个活动并在它们之间滑动吗？

我也想要滑动动画。

我对android很陌生，如果我没有很好地解释这个问题，我很抱歉。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:07:17.443

创建单个活动并使用其中包含多个片段的[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)而不是多个活动。

更多信息[在这里](http://android-developers.blogspot.co.il/2011/08/horizontal-view-swiping-with-viewpager.html)。

它也有漂亮的动画！

顺便说一句，对于一些很酷的 UI 模式，我建议运行这个显示开源项目演示的应用程序：

[https://play.google.com/store/apps/details?id=com.groidify.uipatterns](https://play.google.com/store/apps/details?id=com.groidify.uipatterns)

# java - JFrame 标题无法正确对齐

> ID：13782796
> 
> 赞同：3
> 
> 时间：2012-12-08T22:57:04.127
> 
> 标签：java, swing, user-interface, alignment, jframe

我有一个简单的 JFrame 窗口，它的标题一直向右浮动（虽然是用英文写的）。住在中东但使用英文版的 Windows 7。正确对齐标题​​文本和标题栏左端的正确方法是什么？

```
imports...

public class MainWindow extends JFrame {

    private JPanel contentPane;
    private final String arr[] = {"1","2","3","4","5","6","7","8","9","10"};

    /**
     * Launch the application.
     */
    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    MainWindow frame = new MainWindow("The Simulator");

                    frame.setVisible(true);

                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    /**
     * Create the frame.
     */
    public MainWindow(String title) {
        super(title);

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 582, 435);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        setContentPane(contentPane);
        contentPane.setLayout(new FlowLayout(FlowLayout.CENTER, 5, 5));

        JButton btnRandom = new JButton("Generate new random DCSP");
        contentPane.add(btnRandom);

        JButton btnManual = new JButton("Generate new manual DCSP");

        contentPane.add(btnManual);
    }

} 
```

没有帮助使用

```
frame.setComponentOrientation(ComponentOrientation.LEFT_TO_RIGHT); 
```

或者

```
frame.applyComponentOrientation(ComponentOrientation.getOrientation(Locale.US)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-04T23:01:06.040

标题文本对齐的方向实际上取决于它运行的操作系统。我知道在 Windows 8 上的计算机上，文本在中间对齐，在 osx 中相同，但在 Windows 7 中它在右侧。[虽然这个解决方案](https://stackoverflow.com/questions/6455831/set-jframe-orientation-from-right-to-left)是一种解决方法，但我不知道它是否适用于所有操作系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T07:11:30.573

如果我没有误解这个问题。您想在不同的位置对齐标题文本。例如左、中还是右？

我认为标题栏的位置是由操作系统设置的。新的 windows 8 将所有标题设置在标题栏的中心，而 windows 7 将其设置在左侧。

我认为解决这个问题的方法是查看标题占用的空间并通过添加空格来操作它。

我会尝试将我的标题设置为一堆“AAAAAA”，看看需要多少“AAAAAA”才能填满整个标题栏，

例如，如果我的标题栏需要 100 个 A，而我的宽度是 100（减去图标和按钮），那么我知道每个字母占用 100/100=1 个空间。知道了，假设我想将标题设置为 Hi”并将其对齐到最右边的角落，我可以在“Hi”前面添加 98 个空格

# java - JAX-WS 异常 - “返回不是有效的属性”

> ID：13782797
> 
> 赞同：1
> 
> 时间：2012-12-08T22:57:29.237
> 
> 标签：java, soap, jax-ws

当我尝试启动这个简单的 Web 服务时，我是 JAX-WS 的新手：

界面：

```
package ws;

import java.util.HashMap;
import javax.jws.WebMethod;
import javax.jws.WebService;

@WebService
public interface IBasket {
    @WebMethod public abstract void addItem(int productId, int count);  
    @WebMethod public abstract HashMap<Integer, Integer> getBasketMap();
} 
```

实现类：

```
package model;

import java.util.HashMap;
import javax.jws.WebService;
import ws.IBasket;

@WebService(endpointInterface = "ws.IBasket")
public class Basket implements IBasket {

    private HashMap<Integer, Integer> basket;

    public Basket() {
        this.basket = new HashMap<Integer, Integer>();
    }

    @Override
    public void addItem(int productId, int count) {
        int currentCount = 0;
        if (basket.containsKey(productId)) {
            currentCount = basket.get(productId);
        }
        basket.put(productId, currentCount + count);
    }

    @Override
    public HashMap<Integer, Integer> getBasketMap() {
        return basket;
    }
} 
```

出版商：

```
package endpoint;

import javax.xml.ws.Endpoint;
import model.Basket;

public class WSPublisher {

    public static void main(String[] args) {
        Endpoint.publish("http://localhost:8080/WS/Basket",new Basket());
    }
} 
```

我得到以下堆栈跟踪：

```
Exception in thread "main" javax.xml.ws.WebServiceException: class ws.jaxws.GetBasketMapResponse do not have a property of the name return
    at com.sun.xml.internal.ws.server.sei.EndpointResponseMessageBuilder$DocLit.<init>(EndpointResponseMessageBuilder.java:196)
    at com.sun.xml.internal.ws.server.sei.EndpointMethodHandler.createResponseMessageBuilder(EndpointMethodHandler.java:191)
    at com.sun.xml.internal.ws.server.sei.EndpointMethodHandler.<init>(EndpointMethodHandler.java:97)
    at com.sun.xml.internal.ws.server.sei.SEIInvokerTube.<init>(SEIInvokerTube.java:72)
    at com.sun.xml.internal.ws.server.EndpointFactory.createEndpoint(EndpointFactory.java:208)
    at com.sun.xml.internal.ws.api.server.WSEndpoint.create(WSEndpoint.java:498)
    at com.sun.xml.internal.ws.transport.http.server.EndpointImpl.createEndpoint(EndpointImpl.java:246)
    at com.sun.xml.internal.ws.transport.http.server.EndpointImpl.publish(EndpointImpl.java:170)
    at com.sun.xml.internal.ws.spi.ProviderImpl.createAndPublishEndpoint(ProviderImpl.java:113)
    at javax.xml.ws.Endpoint.publish(Endpoint.java:240)
    at endpoint.WSPublisher.main(WSPublisher.java:14)
Caused by: javax.xml.bind.JAXBException: return is not a valid property on class ws.jaxws.GetBasketMapResponse
    at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.getElementPropertyAccessor(JAXBContextImpl.java:966)
    at com.sun.xml.internal.ws.server.sei.EndpointResponseMessageBuilder$DocLit.<init>(EndpointResponseMessageBuilder.java:193)
    ... 10 more 
```

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-09T11:41:16.627

好的，我已经找到了解决此问题的方法，请参阅：

[如何将数组作为值传递给 PHP soapclient 请求？](https://stackoverflow.com/questions/2337901/how-can-i-pass-in-an-array-as-a-value-into-a-php-soapclient-request)

HashMap 返回值也是如此。JAXB 无法将 HashMaps 作为参数/返回值处理，可能是因为它们是通用的。

因此，我们需要一个 HashMap<Integer, Integer> 的包装类

```
public class HashMapWrapper {

    private HashMap<Integer, Integer> basketMap;

    public HashMapWrapper(HashMap<Integer, Integer> basketMap) {
        this.setBasketMap(basketMap);
    } 
```

并将其用作返回值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T01:15:57.170

您是否使用 Metro 作为您的 JAX-WS 提供程序？如果是这样，请尝试将 Document 样式设置为 RPC，如下所示。这个注解应该在@WebService 注解之后。

```
@SOAPBinding(style = Style.RPC) 
```

# java - 将 AES 与 CFB 模式结合使用

> ID：13782798
> 
> 赞同：7
> 
> 时间：2012-12-08T22:57:40.773
> 
> 标签：java, android, aes

你能告诉我如何在 CFB 模式下使用 AES（以便输入（纯文本）和输出（加密文本）的大小保持不变。我尝试用 AES/CFB/NoPadding 替换 AES，但它不起作用。应用程序崩溃。我正在使用以下代码。请帮助我使其适用于带有 CFB 的 AES。谢谢

公共类 SimpleCrypto {

```
public static String encrypt(String seed, String cleartext) throws Exception {
    byte[] rawKey = getRawKey(seed.getBytes());
    byte[] result = encrypt(rawKey, cleartext.getBytes());
    return toHex(result);
}

public static String decrypt(String seed, String encrypted) throws Exception {
    byte[] rawKey = getRawKey(seed.getBytes());
    byte[] enc = toByte(encrypted);
    byte[] result = decrypt(rawKey, enc);
    return new String(result);
}

private static byte[] getRawKey(byte[] seed) throws Exception {
    KeyGenerator kgen = KeyGenerator.getInstance("AES");
    SecureRandom sr = SecureRandom.getInstance("SHA1PRNG");
    sr.setSeed(seed);
    kgen.init(128, sr); // 192 and 256 bits may not be available
    SecretKey skey = kgen.generateKey();
    byte[] raw = skey.getEncoded();
    return raw;
}

private static byte[] encrypt(byte[] raw, byte[] clear) throws Exception {
    SecretKeySpec skeySpec = new SecretKeySpec(raw, "AES");
    Cipher cipher = Cipher.getInstance("AES");
    cipher.init(Cipher.ENCRYPT_MODE, skeySpec);
    byte[] encrypted = cipher.doFinal(clear);
    return encrypted;
}

private static byte[] decrypt(byte[] raw, byte[] encrypted) throws Exception {
    SecretKeySpec skeySpec = new SecretKeySpec(raw, "AES");
    Cipher cipher = Cipher.getInstance("AES");
    cipher.init(Cipher.DECRYPT_MODE, skeySpec);
    byte[] decrypted = cipher.doFinal(encrypted);
    return decrypted;
}

public static String toHex(String txt) {
    return toHex(txt.getBytes());
}
public static String fromHex(String hex) {
    return new String(toByte(hex));
}

public static byte[] toByte(String hexString) {
    int len = hexString.length()/2;
    byte[] result = new byte[len];
    for (int i = 0; i < len; i++)
        result[i] = Integer.valueOf(hexString.substring(2*i, 2*i+2), 16).byteValue();
    return result;
}

public static String toHex(byte[] buf) {
    if (buf == null)
        return "";
    StringBuffer result = new StringBuffer(2*buf.length);
    for (int i = 0; i < buf.length; i++) {
        appendHex(result, buf[i]);
    }
    return result.toString();
}
private final static String HEX = "0123456789ABCDEF";
private static void appendHex(StringBuffer sb, byte b) {
    sb.append(HEX.charAt((b>>4)&0x0f)).append(HEX.charAt(b&0x0f));
} 
```

}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-09T02:30:52.387

如果你想使用`AES/CFB/NoPadding`算法，你应该像这样初始化你的密码实例`IvParameterSpec`：

```
byte[] iv = new byte[] { 0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF }; 
IvParameterSpec ivSpec = new IvParameterSpec(iv);

SecretKeySpec skeySpec = new SecretKeySpec(raw, "AES");
Cipher cipher = Cipher.getInstance("AES/CFB/NoPadding");
cipher.init(Cipher.ENCRYPT_MODE, skeySpec, ivSpec); 
```

# javascript - 为什么我的引导导航栏斜体而不是将活动类添加到活动选项卡？

> ID：13782800
> 
> 赞同：0
> 
> 时间：2012-12-08T22:57:52.483
> 
> 标签：javascript, jquery, html, css, twitter-bootstrap

我的引导导航栏添加了一个跨度并将活动选项卡变为斜体，而不是仅将活动类添加到活动选项卡。我的代码如下：

```
 <div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span> 
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="#">Wutup?!</a>
      <div class="nav-collapse">
      <wicket:link>
            <ul class="nav">
              <li><a href="NearbyEvents.html">Nearby Events</a></li>
              <li><a href="Index.html">My Events</a></li>
              <li><a href="ManageEvents.html">Manage My Events</a></li>
              <li><a href="AboutPage.html">About</a></li>
            </ul>
        </wicket:link>
      </div>
    </div>
  </div>
</div> 
```

行为可以在这里看到：[screenshot](http://i.imgur.com/SnAc6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T16:10:38.260

当您使用 wicket 自动链接功能（即 wicket:link）时，它会生成跨度而不是向您的 HTML 添加类。例如，如果“我的事件”是活动页面，则可能如下所示：

```
<ul class="nav">
    <li><a href="NearbyEvents.html">Nearby Events</a></li>
    <li><span><em>My Events</em></span></li>
    <li><a href="ManageEvents.html">Manage My Events</a></li>
    <li><a href="AboutPage.html">About</a></li>
</ul> 
```

如果你想避免这种情况，你不应该使用自动链接功能，或者只是改变 css 以适应生成的检票口的 html。

# javascript - 使用 D3 和 Shiny 在 R 中实现 `identify()`

> ID：13782803
> 
> 赞同：58
> 
> 时间：2012-12-08T22:58:04.673
> 
> 标签：javascript, r, d3.js, shiny

我问[了一个](https://stackoverflow.com/q/13714724/688080)关于如何根据用户交互动态绘图的问题，他的解决方案在我的机器上运行良好。

现在我想制作一个在线版本并使用[Shiny](http://shiny.rstudio.org/)托管它。

我尝试将代码放入`server.R`并调用`iden()`里面的函数`reactivePlot()`，但是部分`identify()`没有生效。

那么，关于这个任务的任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-19T19:24:47.857

试试这个[画廊项目。](http://shiny.rstudio.com/gallery/movie-explorer.html) 它使用 ggvis 来实现这个目标。万一画廊消失了，这里有一些最小的代码会产生一个工具提示，类似于`identify()`，使用 ggvis。

```
require(ggvis)
mtcars$model<-rownames(mtcars)
mtcars %>% ggvis(~wt, ~mpg,key:=~model) %>% 
  layer_points() %>% 
  add_tooltip(function(df) df$model) 
```

而且，一个更完整但仍然最小的例子：

```
require(shiny)
require(ggvis)
mtcars$model<-rownames(mtcars)

shinyApp(
  ui = fluidPage(
    sidebarLayout(
      sidebarPanel(h2("GGVis to Identify Points")),
      mainPanel(ggvisOutput("carsplot"))
    )
  ), 
  server = function(input, output) {
    vis <- reactive({ 
      mtcars %>% ggvis(~wt, ~mpg,key:=~model) %>% 
        layer_points() %>% 
        add_tooltip(function(df) df$model)
    })
    vis %>% bind_shiny("carsplot")
  }

) 
```

# java - Android透明黑层？

> ID：13782809
> 
> 赞同：1
> 
> 时间：2012-12-08T22:58:54.937
> 
> 标签：java, android, user-interface

我有一个 ProgressBar 和一个登录按钮。当我单击登录按钮时，我会显示此进度条，并且一切正常。但是，如果我有一个黑色透明层会很好，就像它所做的 AlertDialog 类一样，并且只有 progressBar 具有全亮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:53:41.187

尝试创建另一个具有透明主题的课程。例如新类：

```
 public class BlahActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_blah);

        ProgressDialog pg = new ProgressDialog(this);
        pg.setTitle("Title of progress dialog");
        pg.setMessage("Message of progress dialog");
        pg.show();
    }

} 
```

并更改 AndroidManifest.xml 文件（检查第二行）：

```
 <activity
        android:name="com.example.dialog.BlahActivity"
        android:theme="@android:style/Theme.Translucent.NoTitleBar"
        android:label="@string/title_activity_blah" >
    </activity> 
```

现在，当您单击班级中的按钮时，您只需创建新的意图即可打开 transculent 班级。OnCreate 它将运行 ProgressDialog 它将模糊其余部分，您将能够看到最后一个活动的文本。

您还可以尝试使用 onResult 选项打开新意图，这将允许您打开意图 - 做某事 - 并返回上一个活动。

如果你想要全黑，你不必将主题设置为半透明，只需将背景设置为黑色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:26:11.163

您可以在布局 android:background:#60000000 的 xml 中设置，其中两个第一个数字是 alpha，接下来是 6 是十六进制的颜色。

# xaml - 使用 ScrollViewer 进行图像缩放，在平移时不断向左对齐

> ID：13782810
> 
> 赞同：9
> 
> 时间：2012-12-08T22:59:13.607
> 
> 标签：xaml, windows-8, microsoft-metro, winrt-xaml

我正在尝试使用 XAML ScrollViewer 向图像“廉价”添加捏缩放。然而问题是，当在图像周围平移时，它会一直向左对齐。如果我向右滑动它，它看起来很好，但是当我释放图像时，它会弹回左侧。

此问题仅在水平方向上持续存在 - 对于垂直平移，它工作正常。

我将其抽象为最简单的测试用例，并且它仍然存在。我的 XAML 代码如下：

```
 <ScrollViewer>
        <Image Source="http://i.imgur.com/1WlGT.jpg" />
    </ScrollViewer> 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-08T23:13:49.063

我已经解决了这个问题。

问题是您必须将 Horizo​​ntalScrollBarVisibility 显式设置为 true。

```
<ScrollViewer x:Name="scrollViewer" 
                  VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" 
                  ZoomMode="Enabled">
        <Image Source="http://i.imgur.com/1WlGT.jpg" />
    </ScrollViewer> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-15T05:13:20.933

仅说明 Michal Strzalkowski 在您的答案下方的评论中提到的可能解决方案，即图像以全尺寸显示（不适合容器边界）。使用与**ElementName**和**路径****绑定**的 XAML 快速修复

 ****```
<ScrollViewer x:Name="SV_ImageZoom"           
              MaxZoomFactor="3"
              MinZoomFactor="1"
              ZoomMode="Enabled"                          
              HorizontalScrollBarVisibility="Auto"
              VerticalScrollBarVisibility="Auto">
    <Image Source="http://i.imgur.com/1WlGT.jpg"
           Width="{Binding Path=ViewportWidth, ElementName=SV_ImageZoom}" />
</ScrollViewer> 
```****

# c - 现代操作系统上可能的最低内存地址

> ID：13782813
> 
> 赞同：3
> 
> 时间：2012-12-08T22:59:39.440
> 
> 标签：c, memory, malloc, memory-address

最近有人指出我的一个 C 程序，如果内存块的起始地址足够低，我的一个测试将由于绕零而失败，从而导致崩溃。

起初我以为“这是一个令人讨厌的潜在错误”，但后来，我想知道：这种情况会发生吗？我从来没有见过。公平地说，这个程序已经在无数系统上运行了数百万次，而且迄今为止从未发生过。

`malloc()`因此，我的问题是：调用可能返回的最低内存地址是多少？据我所知，我从未见过像 0x00000032 这样的地址。

我只对“现代”环境感兴趣，例如 Linux、BSD 和 Windows。此代码不打算在 C64 或任何爱好/研究操作系统上运行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-08T23:10:57.410

首先，既然这就是你所要求的，我只会考虑现代系统。这意味着他们正在使用分页内存并且在 0 处有一个错误页面来处理空指针取消引用。

现在，我所知道的任何真实系统上的最小页面大小是 4k（4096 字节）。这意味着您永远不会有低于 0x1000 的有效地址；任何较低的内容都将是包含零地址的页面的一部分，因此将排除空指针取消引用错误。

在现实世界中，好的系统实际上可以防止你走得那么低。现代 Linux 甚至阻止应用程序*故意*将页面映射到低于可配置的默认值（我相信是 64k）。这个想法是，您甚至希望从空指针（例如`p[n]`，`p`恰好是空指针的位置）到故障（在 Linux 的情况下，他们希望内核空间中的代码在尝试访问此类地址时出现故障以避免可能导致特权提升漏洞的内核空指针取消引用错误）。

话虽如此，在指针指向的数组边界之外执行指针算术是未定义的行为。即使地址没有换行，编译器也可能会做各种各样的事情（无论是为了强化你的代码，还是为了优化），其中未定义的行为可能会导致你的程序中断。好的代码应该遵循编写它的语言的规则，即不要调用未定义的行为，即使您希望 UB 是无害的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-08T23:10:47.913

您可能的意思是您正在计算`&a - 1`或类似的东西。

请不要这样做，即使指针比较当前在大多数体系结构上被实现为无符号比较，并且您知道这`(uintptr_t)&a`比当前系统上的某些任意界限大。编译器**将**利用未定义的行为进行优化。他们现在就这样做，如果他们现在不利用它，他们将来会利用它，而不管您可能期望从指令集或平台获得的“保证”如何。

有关更多信息，请参阅[这个广为人知的轶事](http://lwn.net/Articles/278137/)。

在完全不同的寄存器中，您可能会认为 C 语言中未定义有符号溢出，因为过去存在不同的硬件选择，例如 1 的补码和符号幅度。因此，如果您知道平台是 2 的补码，则表达式`(x+1) > x`会检测`MAX_INT`.

这可能是历史原因，但推理不再成立。现代编译器对表达式`(x+1) > x`(with `x`of type `int`) 进行了优化`1`，因为**有符号溢出是 undefined**。编译器作者并不关心未定义的最初原因是可用架构的多样性。你用指针做的任何未定义的事情都是他们列表中的下一个。**如果您调用未定义的行为**，您的程序明天就会中断，这不是因为架构发生了变化，而是因为编译器在优化方面越来越激进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T23:17:07.850

动态分配在 上执行`heap`。`Heap`驻留在（程序代码）和部分`address space`之后的进程中，请参见此处：[http](http://www.cprogramming.com/tutorial/virtual_memory_and_heaps.html) ://www.cprogramming.com/tutorial/virtual_memory_and_heaps.html 。因此堆中可能的最小地址取决于这 3 个段的大小，因此没有绝对的答案，因为它取决于特定的程序。`text``initialized data``uninitialized data`

# asp.net-mvc - 在运行时修改 .resx 文件

> ID：13782815
> 
> 赞同：2
> 
> 时间：2012-12-08T22:59:47.633
> 
> 标签：asp.net-mvc

构建一个 ASP.NET MVC 站点，我想在运行时向我的 .resx 文件添加一些值。

我努力了：

```
IResourceWriter writer = new ResourceWriter("myResources.resources");
writer.AddResource("String 3", "Third String");
writer.Close(); 
```

此代码编译并执行良好，但在我关闭网站并查看 .resx 文件后，它已损坏，我必须再次重新创建 .resx 文件。请注意，我在设计时添加的这个 .resx 文件中有两个值。

谢谢格里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T18:14:28.533

我只是在寻找类似的解决方案，在那里我可以“更改”资源而不是“添加”。所以你的情况有点复杂。解决方案仍然可能有用：

[C#：更改资源文件而不重新构建？](https://stackoverflow.com/questions/7991178/c-change-the-resource-file-without-re-building)

简而言之，它允许您修改 .resx 文件 (XML) - 因此您也应该能够添加新消息。然后我们将使用 resgen 创建二进制资源文件 (.resources)，最后使用汇编链接器 (al) 将其嵌入到编译文件中。

# django - 在 django 的提要类中获取查询字符串

> ID：13782816
> 
> 赞同：0
> 
> 时间：2012-12-08T22:59:49.303
> 
> 标签：django, rss, feed

我希望能够有一个带有查询的 RSS 提要。例如`example.com/rss/bbox?=39.715056,-75.811158,39.5098,-75.491781`

1.  我找不到任何带有查询字符串的 rss 示例，这是正确的吗？
2.  如何使用 django 的[feed 类](https://docs.djangoproject.com/en/1.0/ref/contrib/syndication/#feed-classes)获取参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T05:27:57.213

找到了！该`get_object`方法被传递`request`，然后您可以提取 GET 参数。

```
def get_object(self, request, *args, **kwargs):
    bounds = request.GET.get("bbox")
    bbox = _str_to_bbox(bounds)
    ....
    return Obj 
```

然后，返回的对象可以用于`items`和大多数其他提要类的方法

# sql - PostgreSQL - 从 shell 失败创建用户和数据库

> ID：13782817
> 
> 赞同：3
> 
> 时间：2012-12-08T22:59:51.097
> 
> 标签：sql, database, postgresql, shell, root

我有一个在部署时运行的 shell 脚本，我有以下几行：

```
# Database
createdb $DBNAME
createuser -D -A $DBNAME 
```

但是，在我的日志中，我收到此错误：

*   createdb：无法连接到数据库 postgres：致命：用户“root”的身份验证失败
*   createuser：无法连接到数据库 postgres：致命：用户“root”的身份验证失败

有人介意告诉我这里出了什么问题以及如何纠正我的台词。当然root应该有权这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:50:11.053

最好的方法是：

```
su --login postgres --command "createdb $DBNAME" 
```

这应该比使用`-U`. 我在我所有的 posgreSQL 脚本中都是这样做的。您可能会发现它是一种有用的技术。显然它仍然需要以 root 用户身份运行（例如使用`sudo`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T23:05:52.133

如果您的数据库是安全的，您需要以数据库用户的身份进行连接，而不是作为操作系统的用户。例如：

```
createdb -U dbrootuser -W $DBNAME 
```

有关完整语法，请参阅此[链接](http://www.postgresql.org/docs/8.1/static/app-createdb.html)

# c# - 剃刀视图文本框问题

> ID：13782822
> 
> 赞同：0
> 
> 时间：2012-12-08T23:00:37.837
> 
> 标签：c#, asp.net-mvc-3, razor

如何让 DateCreated 字段自动填充 DateTime.Now

```
 <div class="editor-label">
        @Html.LabelFor(model => model.DateCreated)
   </div>
   <div class="editor-field">
        @Html.EditorFor(model => model.DateCreated)
        @Html.ValidationMessageFor(model => model.DateCreated)
   </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:16:26.253

这通常是您在视图范围之外（即在控制器中）执行的操作。

```
public ActionResult MyAction()
{
    var model = new MyModel();
    model.DateCreated = model.DateCreated ?? DateTime.Now;
    return View(model);
} 
```

或者，在模型本身的构造函数中。

# sql - 如何将序列列添加到包含记录的现有表中

> ID：13782824
> 
> 赞同：25
> 
> 时间：2012-12-08T23:00:44.000
> 
> 标签：sql, oracle11g

我创建了一个名为 USERLOG 的新表，其中包含来自先前 VIEW 的两个字段。该表已经包含大约 9000 条记录。取自VIEW 的两个字段，即weblog_views 由IP（由IP 地址组成）和WEB_LINK（由URL 组成）组成。这是我使用的代码，

```
 CREATE TABLE USERLOG
    AS
    SELECT C_IP, WEB_LINK FROM weblog_views; 
```

我想在这个表中添加另一个名为 USER_ID 的列，它由一个从 1 到 9000 条记录开始的序列组成，以为每个现有行创建一个唯一的 ID。我需要这部分的帮助。我正在使用 Oracle SQL Developer：ODMiner 版本 3.0.04。我尝试使用 AUTO-INCREMENT 选项，

```
 ALTER TABLE USERLOG
    ADD USER_ID INT UNSIGNED NOT NULL AUTO_INCREMENT; 
```

但我得到一个错误，

```
 Error report:
    SQL Error: ORA-01735: invalid ALTER TABLE option
    01735\. 00000 -  "invalid ALTER TABLE option" 
```

所以，我真的很感激我能得到的任何帮助！

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-12-09T00:27:12.543

您需要添加一列

```
ALTER TABLE userlog
  ADD( user_id number ); 
```

创建一个序列

```
CREATE SEQUENCE user_id_seq
  START WITH 1
  INCREMENT BY 1
  CACHE 20; 
```

更新表中的数据

```
UPDATE userlog
   SET user_id = user_id_seq.nextval 
```

假设您想`user_id`成为主键，那么您将添加主键约束

```
ALTER TABLE userlog
  ADD CONSTRAINT pk_user_id PRIMARY KEY( user_id ); 
```

如果您想在执行`user_id`操作时使用序列自动添加（另一个选项是在您的语句`INSERT`中专门引用，您还需要一个触发器`user_id_seq.nextval``INSERT`

```
CREATE OR REPLACE TRIGGER trg_userlog_user_id
  BEFORE INSERT ON userlog
  FOR EACH ROW
BEGIN
  :new.user_id := user_id_seq.nextval;
END; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-17T08:47:03.783

除了贾斯汀的出色回答之外，您可能希望将来防止您的 user_id 出现 NULL 值（因为它们仍然可能是由 UPDATE 语句引起的）。因此，最后执行以下语句：

`ALTER TABLE userlog MODIFY(user_id number NOT NULL);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-07T02:55:25.680

步骤 1\. 创建列使用的序列，例如：

```
CREATE SEQUENCE user_id_seq
  START WITH 1
  INCREMENT BY 1
  CACHE 20; 
```

步骤 2\. 使用序列更新新列，例如：

```
UPDATE userlog
   SET user_id = user_id_seq.nextval; 
```

第 3 步 - 将序列设置为列的默认值，仅适用于 Oracle 12c

```
ALTER TABLE USERLOG
    MODIFY USER_ID INT DEFAULT user_id_seq.nextval; 
```

# c - 如何从默认 gcc 搜索路径中删除路径

> ID：13782826
> 
> 赞同：2
> 
> 时间：2012-12-08T23:01:17.943
> 
> 标签：c, gcc, ubuntu, boost

在 Ubuntu 中使用 boost 库进行编译时，如何确保 GCC 使用我的 boost 路径？

Ubuntu 中当前的 Boost 版本是 1.46。

我编译版本 1.52。

我知道我可以使用“-L/path/to/new/lib”将库添加到搜索路径，但是如何确保 GCC 不会链接到旧库？

问候，托默

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T23:08:36.533

-L 选项将库搜索路径添加到搜索路径的开头，因此如果您有自己的版本，它将在默认系统版本之前找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:03:55.213

只需将`-v`选项传递给`gcc`或`g++`了解它正在运行的链接命令。您甚至可以添加`-Wl,--verbose`使`ld`命令也很详细。

你可能也有兴趣`-rpath`，看看[这个答案](https://stackoverflow.com/a/6562437/841108)。

# javascript - 从服务器实时更新图表

> ID：13782830
> 
> 赞同：1
> 
> 时间：2012-12-08T23:01:46.477
> 
> 标签：javascript, jquery, graph, d3.js, data-visualization

我正在尝试使用接收到的数据更新图表，以便随着通过 websocket 从服务器接收到更多数据，条形的高度会增加。但是我的代码不会在浏览器中呈现图形并绘制数据点。我看不出代码有什么问题。我真的需要一些帮助。

```
 ws = new WebSocket("ws://localhost:8888/dh");

  var useData = []
  //var chart;

  var chart = d3.select("body")
     .append("svg:svg")
     .attr("class", "chart")
     .attr("width", 420)
     .attr("height", 200);

  ws.onmessage = function(evt)
  {  
    var distances = JSON.parse(evt.data);
    data  = distances.miles;
    console.log(data);

    if(useData.length <= 10){
      useData.push(data)
    }
    else
    {

       var draw = function(data){        
       // Set the width relative to max data value
       var x = d3.scale.linear()
        .domain([0, d3.max(useData)])
        .range([0, 420]);

       var y = d3.scale.ordinal()
        .domain(useData)
        .rangeBands([0, 120]);

       var rect = chart.selectAll("rect")
        .data(useData)

        // enter rect
        rect.enter().append("svg:rect")
            .attr("y", y)
            .attr("width", x)
            .attr("height", y.rangeBand());

        // update rect            
        rect
            .attr("y", y)
            .attr("width", x)
            .attr("height", y.rangeBand());

       var text = chart.selectAll("text")
            .data(useData)

       // enter text
       text.enter().append("svg:text")
            .attr("x", x)
            .attr("y", function (d) { return y(d) + y.rangeBand() / 2; })
            .attr("dx", -3) // padding-right
            .attr("dy", ".35em") // vertical-align: middle
            .attr("text-anchor", "end") // text-align: right
            .text(String);

        // update text
        text
            .data(useData)
            .attr("x", x)
            .text(String);
    }
draw();
useData.length = 0;
   }          
} 
```

谢谢

编辑：

然而现在的问题是它似乎没有将新数据添加到现有的条形图中，而是替换了旧值。我怎样才能将新值添加到现有条形值中。因此，例如，如果条“A”的值为 7，则当新数据来自值为 9 的条“A”时，条现在应该是 16 而不是 9。jsfiddle：http: [//jsfiddle.net/2NXF2/31 /](http://jsfiddle.net/2NXF2/31/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:51:39.680

似乎没有表达式可以将新数据与前一次迭代中的旧数据聚合起来。`useData.length = 0`完全清除现有数据并`useData.push(data)`仅将单个元素推送到空`useData`数组中。我猜这不会产生要绘制的必要格式的数据。

另外，我可能在这里遗漏了一些东西，但似乎没有理由将该`draw()`函数放在`ws.onmessage`处理程序中。通过`draw()`在处理程序外部定义，它被定义一次，而不是每次`ws.onmessage`触发时都重新定义。

如果我是对的，那么代码只需要一些重新排列，加上一个大大减少的`ws.onmessage`处理程序中的小循环，以将新里程与旧里程聚合：

```
var ws = new WebSocket("ws://localhost:8888/dh");
var useData = [12,45,48,45,654,12,465,5,12,45];
var chart = d3.select("body").append("svg:svg").attr("class", "chart").attr("width", 420).attr("height", 200);

function draw() {
    // Set the width relative to max data value
    var x = d3.scale.linear().domain([0, d3.max(useData)]).range([0, 420]);
    var y = d3.scale.ordinal().domain(useData).rangeBands([0, 120]);
    var rect = chart.selectAll("rect").data(useData);
    // enter rect
    rect.enter().append("svg:rect").attr("y", y).attr("width", x).attr("height", y.rangeBand());
    // update rect            
    rect.attr("y", y).attr("width", x).attr("height", y.rangeBand());
    var text = chart.selectAll("text").data(useData);
    // enter text
    text.enter().append("svg:text").attr("x", x).attr("y", function(d) {
        return y(d) + y.rangeBand() / 2;
    }).attr("dx", -3) // padding-right
      .attr("dy", ".35em") // vertical-align: middle
      .attr("text-anchor", "end") // text-align: right
      .text(String);
    // update text
    text.data(useData).attr("x", x).text(String);
};

draw();//initialise with hard-coded useData

//Now, aggregate additional miles when ws.onmessage fires and redraw the graph.
ws.onmessage = function(evt) {
    var distances = JSON.parse(evt.data);
    for(var i=0; i<useData.length; i++) {
        if(useData[i] && distances.miles[i]) {//safety
            useData[i] += distances.miles[i];//add the new miles to the total from previous iteration
        }
    }
    draw();//redraw the graph
} 
```

注意： - 我对d3不熟悉，所以我没有尝试验证该`draw()`功能。- 我已经做了很多猜测，所以可能还有一些工作要做。

# php - 如何在html中使用php代码？

> ID：13782835
> 
> 赞同：-4
> 
> 时间：2012-12-08T23:02:38.943
> 
> 标签：php, html

例如，我想创建一个页面，您在文本框中输入两个数字，当您单击按钮时，它会调用 php 文件，该文件将它们相加，然后以某种标签输出结果（对不起，如果表达式错误，我'习惯于 c# 参考）

那么该怎么做呢？:D

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T23:12:15.320

我不建议使用 PHP 来添加整数，这是不必要的。您可以使用 JavaScript 非常简单地完成此操作，而无需刷新页面。您也可以使用 AJAX 来完成此操作，而无需重新加载整个页面。我会建议 JavaScript。

```
<html>
  <head>
        <title>Input tutorial</title>
        <script language="javascript">
                function addNumbers()
                {
                        var val1 = parseInt(document.getElementById("value1").value);
                        var val2 = parseInt(document.getElementById("value2").value);
                        var ansD = document.getElementById("answer");
                        ansD.value = val1 + val2;
                }
        </script>
  </head>
  <body>
        value1 = <input type="text" id="value1" name="value1" value="1"/>
        value2 = <input type="text" id="value2" name="value2" value="2"/>
        <input type="button" name="Sumbit" value="Click here" onclick="javascript:addNumbers()"/>
        Answer = <input type="text" id="answer" name="answer" value=""/>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-08T23:08:06.843

PHP 是一种服务器端语言，由服务器执行，而不是客户端（浏览器）。为了做你提到的页面需要重新加载。

如果您想用新数据重新加载页面，这是可能的，如果您不想重新加载页面，则需要使用另一种语言（如 Javascript）来执行此操作。

另一种可能性是使用 Javascript 执行 PHP 脚本以获得结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T23:04:51.950

您需要通过请求一个全新的页面或使用 AJAX 来发出某种服务器请求。PHP 只会在服务器上运行。

理想情况下，如果它不必是 PHP，我会用 Javascript 来做。如果您正在学习 PHP，那么我建议您遵循[教程](http://www.codingfriends.com/index.php/2009/07/27/add-two-numbers-4/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T23:11:13.027

你需要使用一个表单，最简单的方法是这样的：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Form</title>
</head>

<body>
<form method="post">

    <input type="text" name="int1" /> 
    + 
    <input type="text" name="int2" />
    = 
    <?php
    if (isset($_POST)) {
        $int1 = $_POST['int1'];
        $int2 = $_POST['int2'];
        echo $int1 + $int2;
    }
    ?>
    <br />
    <input type="submit" value="Get Sum" />

</form>
</body>
</html> 
```

# java - 无法在 mac os x 上分配内存错误 - java(xx,xx) malloc: *** mmap(size=XX) failed (error code=12)

> ID：13782840
> 
> 赞同：0
> 
> 时间：2012-12-08T23:03:08.637
> 
> 标签：java, c++, macos, malloc, mmap

我相信这是一个普遍问题，但如果它有帮助，我将在具有 16GB RAM 的 Mac OS X 10.8 上运行 LucidDB 数据库（0.9.4）。数据库软件主要用Java编写，部分用C++编写。当我将缓冲池大小增加到 1GB 时，出现以下错误。

java(669,0xfc621000) malloc: *** mmap(size=16777216) 失败（错误代码=12）** **错误：无法分配区域 ** * 在 malloc_error_break 中设置断点进行调试*

 *我相信缓冲池使用共享内存，所以我将最大可用共享内存（kern.sysv.shmmax，kern.sysv.shmall）增加到 2GB。我还将 Java 堆大小（Xms、Xmx）增加到 1536MB。我被卡住了，有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:03:36.793

每当我在 linux 下看到这些奇怪的低级错误时，我都会将其追溯到某种资源的缺乏，例如交换空间用完或重新映射虚拟内存过于频繁。应该有一个实用程序可以为您提供正在运行的程序中所有内存映射的转储。我会检查映射的数量是否太多。*

# image - 通过在matlab中单击它来获取像素的坐标

> ID：13782842
> 
> 赞同：1
> 
> 时间：2012-12-08T23:03:28.260
> 
> 标签：image, matlab, user-interface, coordinates, axes

这是我第一次创建 matlab GUI。

我想通过使用matlab单击它来获取图像中像素的坐标，我创建了一个包含轴的Matlab GUI，并且轴通过以下代码包含图像：

```
function axes1_CreateFcn(hObject, eventdata, handles)
     axes(hObject);
     I = imread('cameraman.tif');
     imshow(I); 
```

并`ButtonDownFcn`获取点击像素的坐标：

```
function axes1_ButtonDownFcn(hObject, eventdata, handles)
     handles.xy1 = round(get(handles.axes1,'Currentpoint'));
     x1 = handles.xy1(1,1);
     y1 = handles.xy1(1,2); 
```

问题是当我单击图像时`ButtonDownFcn`没有调用，但是当我从`CreateFcn`函数中删除代码时，`ButtonDownFcn`调用了。

如何在显示图像的同时继续`ButtonDownFcn`工作？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T14:20:47.410

这仅仅是因为当您在 上执行函数时会出现奇怪的行为，`Matlab GUI`它会重置 Axes 的属性。`imshow``Axes`

您会看到由 image 和 surf 命令悄悄地更改轴属性的副作用。[由 Mathworks 提供：[这里](http://www.mathworks.com/matlabcentral/newsreader/view_thread/287296)]

试试这个代码来显示你的图像：

```
function axes1_CreateFcn(hObject, eventdata, handles) 
   axes(hObject);
   tag = get(hObject,'Tag');
   I = imread('cameraman.tif');
   imshow(I);
   set(hObject,'Tag',tag);
   set(hFigure,'ButtonDownFcn', @axes1_ButtonDownFcn);
end 
```

如果您只想查看坐标，请使用`Data Cursor`工具，将其添加到您的`GUI`from 中`Toolbar Editor`，然后使用它在`Axes`绘图或图像上导航并显示点击位置的信息，您甚至可以更改其操作代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:14:40.750

需要设置这些功能。像这样的东西会起作用：

```
set(hFigure,'ButtonDownFcn', @axes1_ButtonDownFcn); 
```

# c - 从“int”分配给“char *”的不兼容整数到指针转换

> ID：13782846
> 
> 赞同：1
> 
> 时间：2012-12-08T23:04:36.967
> 
> 标签：c

下面的代码因 EXC_BAD_ACCESS 而崩溃。任何人都知道为什么？

报告以下警告：

从“int”分配给“char *”的不兼容整数到指针转换

```
register int t;
char *s;
double val;

s = printn(val);
t = strlen(s); // <<< breaks on this line

...

char *printn(n)
double n;
{
    register char *fmt, *s, *ss;
    double absn;
    short sign;

    ....
    s = printb("%-0.2f", sign*absn);
    for (ss = s; *ss; ++ss);
    while (*--ss == '0' || *ss == ' ') *ss = 0;
    if (*ss == '.') *ss = 0;

    return(s);
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-08T23:07:13.637

```
char *s;
double val;

s = printn(val); 
```

此时，`printn`范围内没有声明。因此，编译器使用旧的 C89 规则，假定隐含声明`printn`返回一个`int`.

在使用它们之前声明所有函数。

```
char *printn(double n);
char *s;
double val;
// ..
s = printn(val); 
```

那会奏效。

```
char *printn(n)
double n;
{ 
```

请使用现代语法，

```
char * printn(double n)
{
    // implementation 
```

# linux - 内核调度代码（linux）中的struct rq在哪里？？/

> ID：13782851
> 
> 赞同：1
> 
> 时间：2012-12-08T23:05:15.183
> 
> 标签：linux, struct, scheduling

作为作业的一部分，我必须修改 linux 的调度策略。我有 3.4.11。我一直在编程，但是经过很多努力，我一直无法找到struct rq。通过观察代码，我列出了 struct rq 可能作为成员的变量。我在 lxr.linux.no 中查找过，但没有找到任何相关结果。这个结构 rq 在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:31:21.463

`struct rq`在`kernel/sched/sched.h`（[3.7-rc8 中的第 341-470 行](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=kernel/sched/sched.h;h=7a7db09cfabc18af1b35dd2bee57bf60d4103cf4;hb=b69f0859dc8e633c5d8c06845811588fe17e68b3#l341)）中定义

# html - Wordpress Page.ly MultiEdit 插件不工作

> ID：13782853
> 
> 赞同：0
> 
> 时间：2012-12-08T23:05:28.543
> 
> 标签：html, wordpress, plugins, themes

我正在尝试在这里使用 Wordpress page.ly MultiEdit 插件： [http ://wordpress.org/extend/plugins/pagely-multiedit/](http://wordpress.org/extend/plugins/pagely-multiedit/)

我无法让它正常工作。我收到一个错误：

底部、左侧、底部、左侧区域未在模板中声明。

这是一个屏幕截图。

![在此处输入图像描述](../Images/596d90da2d5cfff2fa1944bd82ad63c5.png)

这是我创建的模板文件的代码：

```
<?php
/*
Template Name: Home
MultiEdit: Right
*/

?>

<?php get_header(); ?>

<?php if (have_posts()) : while (have_posts()) : the_post(); ?>

    <div class="content">

            <?php the_content(); ?>

    </div>

    <div class="sidecontent">
            <?php multieditDisplay(‘Right’); ?>

            </div>

    <?php endwhile; endif; ?>

            <?php get_footer(); ?> 
```

我错过了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:30:44.350

我想我看你的代码不够仔细。您没有在代码中调用它们两次，只是根本没有调用它们。您仍然可以按照我的回答中的说明进行操作，它会起作用。

* * *

这里有几件事。看起来您在同一个页面模板中两次调用了相同的两个内容块。你不能那样做。每个人都必须有自己独特的名字。如果您只是想获得“底部”、“左侧”和“右侧”，则需要更改页面模板顶部的注释代码。

用这个：

```
/*
Template Name: Home
MultiEdit: Bottom,Left,Right
*/ 
```

然后将这些放置在您希望内容显示在页面模板中的位置：

```
<?php multieditDisplay('Bottom'); ?>

<?php multieditDisplay('Left'); ?>

<?php multieditDisplay('Right'); ?> 
```

不过，在您执行任何操作之前，请单击主页编辑器管理页面右上角的“屏幕选项”选项卡。然后单击“自定义字段”选项。然后向下滚动，直到看到“自定义字段”区域并展开它。然后单击“显示/隐藏多编辑字段”，以便您可以看到当前在其中的那些。您需要删除它们中的每一个以从编辑器中清除它们。按照这些说明操作，它会起作用，它是一个很棒的插件，我已经多次使用并取得了巨大的成功。一旦你修复它，请接受我的回答。如果您有任何其他问题，请告诉我。

此外，您不需要在循环内使用调用，只需将三个调用之一放入模板中您需要它的位置。事实上，我建议不要在循环中使用它。

# java - Java Sensor 过滤器校正

> ID：13782854
> 
> 赞同：2
> 
> 时间：2012-12-08T23:05:31.433
> 
> 标签：java, android, filter

我正在使用 android 传感器数据过滤。同时，我不擅长JAVA。它需要将“FixFilter”类与启动 ENS492SensorsActivity 的主要源代码集成。在这种方法中，我的目标是过滤取自加速度计和方向传感器的数据。acx 是在 X 方向上从加速度计获取的数据，而 orx 是从 X 方向上的方向数据中获取的数据。

```
public float FixFilter (double acx, float orx)
{

orx = 0.75*(orx) + 0.25*(acx);
return orx;

}

public class Ens492SenorsActivity extends Activity implements SensorListener
{
    final String tag = "IBMEyes";
    SensorManager sm = null;

    TextView xViewA = null;
    TextView yViewA = null;
    TextView zViewA = null;
    TextView xViewO = null;
    TextView yViewO = null;
    TextView zViewO = null;

    //for gps
    TextView xView1 = null;
    TextView yView1 = null;
    TextView zView1 = null;

    private LocationManager locManager;
    private LocationListener locListener = new MyLocationListener();

    private boolean gps_enabled = false;
    private boolean network_enabled = false;
    private Timer mTimer = new Timer();
    private int REFRESH_TIME = 1000;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    sm = (SensorManager) getSystemService(SENSOR_SERVICE);
    setContentView(R.layout.main);
    xViewA = (TextView) findViewById(R.id.xbox);
    yViewA = (TextView) findViewById(R.id.ybox);
    zViewA = (TextView) findViewById(R.id.zbox);
    xViewO = (TextView) findViewById(R.id.xboxo);
    yViewO = (TextView) findViewById(R.id.yboxo);
    zViewO = (TextView) findViewById(R.id.zboxo);

    xView1 = (TextView) findViewById(R.id.xbox1);
    yView1 = (TextView) findViewById(R.id.ybox1);
    zView1 = (TextView) findViewById(R.id.zbox1);

    locManager = (LocationManager) getSystemService(this.LOCATION_SERVICE);
    locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000, 1, locListener);

    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy); 
    init_arr();
}
public static void connect(String url)
{

    HttpClient httpclient = new DefaultHttpClient();

    // Prepare a request object
    HttpGet httpget = new HttpGet(url); 

    // Execute the request
    HttpResponse response;
    try {
        response = httpclient.execute(httpget);
        // Examine the response status
        Log.i("Praeda",response.getStatusLine().toString());

        // Get hold of the response entity
        HttpEntity entity = response.getEntity();
        // If the response does not enclose an entity, there is no need
        // to worry about connection release

        if (entity != null) {

            // A Simple JSON Response Read
            InputStream instream = entity.getContent();
            String result= convertStreamToString(instream);
            // now you have the string representation of the HTML request
            instream.close();
        }

    } catch (Exception e) {
        e.printStackTrace();
    }
}
private static String convertStreamToString(InputStream is) {
    /*
     * To convert the InputStream to String we use the BufferedReader.readLine()
     * method. We iterate until the BufferedReader return null which means
     * there's no more data to read. Each line will appended to a StringBuilder
     * and returned as String.
     */
    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();

    String line = null;
    try {
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            is.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    return sb.toString();
}
public void ShowMap(View v)
{
    String uri = String.format("geo:%f,%f", alig.getLatitude(), alig.getLongitude());
    Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(uri));
    this.startActivity(intent);
}
public double DoruksKalman (double v1, double v2, double v3,double v4,double v5,double v6,double v7,double v8,double v9,double v10 )
{
    double result = 0;
    //result = 10 / ( 1/ v1 + 1/ v2 +1/ v3 +1/ v4 +1/ v5 +1/ v6 +1/ v7 +1/ v8 +1/ v9 +1/ v10);
    result = (v1 + v2 + v3 + v4 +v5 + v6 +v7 + v8 +v9 + v10)/10;
    return result;
}

public float FixFilter (double acx, float orx)
{

    orx = 0.75*(orx) + 0.25*(acx);
    return orx;

}

public void SendToServer(View v)
{
    Log.i(getClass().getSimpleName(), "send  task - start");
    try{
        connect("http://192.168.1.117/ens4912/process.php?ip=&lat=" +
                DoruksKalman( 
                        alig.getLatitude(), alig.getLatitude(),alig.getLatitude(),
                        alig.getLatitude(),alig.getLatitude(),alig.getLatitude(),
                        alig.getLatitude(),alig.getLatitude(),alig.getLatitude(),
                        alig.getLatitude())+ 
        "&lng="+
        DoruksKalman(alig.getLongitude(), alig.getLongitude(),alig.getLongitude(), alig.getLongitude(), 
                alig.getLongitude(), alig.getLongitude(), alig.getLongitude(),
                alig.getLongitude(), alig.getLongitude(), alig.getLongitude())+
        "&alt="+
        DoruksKalman(alig.getAltitude(),alig.getAltitude(),alig.getAltitude(),
                alig.getAltitude(),alig.getAltitude(),alig.getAltitude(),
                alig.getAltitude(),alig.getAltitude(),alig.getAltitude(),alig.getAltitude())+
        "&accel="+
        DoruksKalman(acx_arr[0], acx_arr[1],acx_arr[2],acx_arr[3],acx_arr[4],
                acx_arr[5],acx_arr[6],acx_arr[7],
                acx_arr[8],acx_arr[9])+
        "&mag="+
        DoruksKalman(orx_arr[0], orx_arr[1], orx_arr[2], orx_arr[3],
                orx_arr[4],orx_arr[5],orx_arr[6],
                orx_arr[7],orx_arr[8],orx_arr[9])
        );//"http://www.google.com");
    }
    catch (Exception e)
    {
        double zero =0.0;
        e.printStackTrace();
         connect("http://192.168.1.117/ens4912/process.php?ip=&lat=" +
                 zero+ 
                    "&lng="+
                    zero+
                    "&alt="+
                    zero+
                    "&accel="+
        DoruksKalman(acx_arr[0], acx_arr[1],acx_arr[2],acx_arr[3],acx_arr[4],
                acx_arr[5],acx_arr[6],acx_arr[7],
                acx_arr[8],acx_arr[9])+
        "&mag="+
        DoruksKalman(orx_arr[0], orx_arr[1], orx_arr[2], orx_arr[3],
                orx_arr[4],orx_arr[5],orx_arr[6],
                orx_arr[7],orx_arr[8],orx_arr[9])
                    );
    }
    Log.i(getClass().getSimpleName(), "send  task - end");
}

float  orx;
float  ory;
float  orz;
float acx;
float acy;
float acz;

float [] acx_arr = new float[10];
float [] acy_arr = new float[10];
float [] acz_arr = new float[10];

float [] orx_arr = new float[10];
float [] ory_arr = new float[10];
float [] orz_arr = new float[10];

private void init_arr()
{
    for(int i = 0;i <10;i++)
    {
        acx_arr[i] = 1.0f;
         acy_arr[i] = 1.0f;
        acz_arr[i] = 1.0f;

        orx_arr[i] = 1.0f;
         ory_arr[i] = 1.0f;
         orz_arr[i] = 1.0f;
    }

}

int sensorReadCount = 0;
private final float NOISE = (float) 2.0;
private float mLastX, mLastY, mLastZ;
private boolean mInitialized = false;

public void onSensorChanged(int sensor, float[] values) {
    Boolean writeIt = false;
    synchronized (this) {
        //Log.d(tag, "onSensorChanged: " + sensor + ", x: " + values[0] + ", y: " + values[1] + ", z: " + values[2]);
        if (sensor == SensorManager.SENSOR_ORIENTATION) {
            xViewO.setText("Orientation X: " + 
                    DoruksKalman(orx_arr[0], orx_arr[1],orx_arr[2],orx_arr[3],orx_arr[4],
                            orx_arr[5],orx_arr[6],orx_arr[7],
                            orx_arr[8],orx_arr[9]));
            yViewO.setText("Orientation Y: " +
                            DoruksKalman(ory_arr[0], ory_arr[1],ory_arr[2],ory_arr[3],ory_arr[4],
                    ory_arr[5],ory_arr[6],ory_arr[7],
                    ory_arr[8],ory_arr[9]));
            zViewO.setText("Orientation Z: " + 
                    DoruksKalman(orz_arr[0], orz_arr[1],orz_arr[2],orz_arr[3],orz_arr[4],
                            orz_arr[5],orz_arr[6],orz_arr[7],
                            orx_arr[8],orx_arr[9]));
            orx = values[0];
            ory = values[1];
            orz = values[2];

            orx_arr[sensorReadCount%10] = orx;
            ory_arr[sensorReadCount%10] = ory;
            orz_arr[sensorReadCount%10] = orz;
        }
        if (sensor == SensorManager.SENSOR_ACCELEROMETER) {

            acx = values[0];
            acy = values[1];
            acz = values[2];

            if (!mInitialized) {
                mLastX = acx;
                mLastY = acy;
                mLastZ = acz;
                mInitialized = true;
                }
            else {
                float deltaX = Math.abs(mLastX - acx);
                float deltaY = Math.abs(mLastY - acy);
                float deltaZ = Math.abs(mLastZ - acz);
                if (deltaX < NOISE) deltaX = (float)0.0;
                if (deltaY < NOISE) deltaY = (float)0.0;
                if (deltaZ < NOISE) deltaZ = (float)0.0;
                mLastX = acx;
                mLastY = acy;
                mLastZ = acz;
                if (deltaX > deltaY) {
                //iv.setImageResource(R.drawable.horizontal);
                    writeIt = false;
                } else if (deltaY > deltaX) {
                //iv.setImageResource(R.drawable.vertical);
                    writeIt = true;
                } else {
                //iv.setVisibility(View.INVISIBLE);
                    writeIt = false;
                }
            }
            xViewA.setText("Accel X: " + acx);
            yViewA.setText("Accel Y: " + acy);
            zViewA.setText("Accel Z: " + acz);
            /*
            xViewA.setText("Accel X: " + 
                    DoruksKalman(acx_arr[0], acx_arr[1],acx_arr[2],acx_arr[3],acx_arr[4],
                            acx_arr[5],acx_arr[6],acx_arr[7],
                            acx_arr[8],acx_arr[9]));
            yViewA.setText("Accel Y: " + 
                    DoruksKalman(acy_arr[0], acy_arr[1],acy_arr[2],acy_arr[3],acy_arr[4],
                            acy_arr[5],acy_arr[6],acy_arr[7],
                            acy_arr[8],acy_arr[9]));
            zViewA.setText("Accel Z: " +
                    DoruksKalman(acz_arr[0], acz_arr[1],acz_arr[2],acz_arr[3],acz_arr[4],
                            acz_arr[5],acz_arr[6],acz_arr[7],
                            acz_arr[8],acz_arr[9]));

            */
            acx_arr[sensorReadCount%10] = acx;
            acy_arr[sensorReadCount%10] = acy;
            acz_arr[sensorReadCount%10] = acz;

        }            
    }
    try
    {
        if(sensorReadCount % 10 == 0 && writeIt)// sensorReadCount <= 60 * 10 /* write for 10 minutes*/ )
        {
                WriteToTXT();
        }
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
    sensorReadCount++;
}
 public Boolean IsItBumb()
 {
     return true;
 }

public void onAccuracyChanged(int sensor, int accuracy) {
    Log.d(tag,"onAccuracyChanged: " + sensor + ", accuracy: " + accuracy);

}
int id = 0;
private void WriteToTXT()
{
    id++;
    // TO DO 
    // Buray\FD dolduracaks\FDn\FDz

    //sat\FDr sat\FDr
    //id - lat - lon -alt - magx - magy - magz - accx - accy -accz - time

    double lat;
    double lon;
    double alt;
    double speed;
    try
    {
         lat = alig.getLatitude();
         lon = alig.getLongitude();
         alt = alig.getAltitude();
         speed = alig.getSpeed();
    }
    catch( Exception e)
    {
        lat = 0.0;
        lon = 0.0;
        alt = 0.0;
        speed = 0.0;
    }

    SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd_HHmmss");
    String currentDateandTime = sdf.format(new Date());

    String fileName = "doruks_txt";
    /*
    String sBody = id + " " + lat +  " " +  lon +  " " + alt + " " +  orx + " " +  ory + " " +
            orz + " " +  acx + " " +  acy + " " +  acz + " " + speed + " " +  currentDateandTime;
    */
    String sBody = lat +  "|" +  lon +  "|" + alt + " " +  orx + " " +  ory + " " +
            orz + " " +  acx + " " +  acy + " " +  acz + " " + speed + " " +  currentDateandTime + "|" +  id;

    generateNoteOnSD(fileName, sBody);
    appendLog(sBody);
}
public void appendLog(String text)
{       
   File logFile = new File("sdcard/mylog.file");
   if (!logFile.exists())
   {
      try
      {
         logFile.createNewFile();
      } 
      catch (IOException e)
      {
         // TODO Auto-generated catch block
         e.printStackTrace();
      }
   }
   try
   {
      //BufferedWriter for performance, true to set append to file flag
      BufferedWriter buf = new BufferedWriter(new FileWriter(logFile, true)); 
      buf.append(text);
      buf.newLine();
      buf.close();
   }
   catch (IOException e)
   {
      // TODO Auto-generated catch block
      e.printStackTrace();
   }
}

public void generateNoteOnSD(String sFileName, String sBody)
{
    try
    {
        File root = new File(Environment.getExternalStorageDirectory(), "Notes");
        if (!root.exists()) 
        {
            root.mkdirs();
        }

        File gpxfile = new File(root, sFileName);
        FileWriter writer = new FileWriter(gpxfile);
        writer.append(sBody);
        writer.flush();
        writer.close();

        Toast.makeText(this, "Saved", Toast.LENGTH_SHORT).show();
    }
    catch(IOException e)
    {
         e.printStackTrace();
    }
}   

@Override
protected void onResume() {
    super.onResume();
    sm.registerListener(this, 
            SensorManager.SENSOR_ORIENTATION |
            SensorManager.SENSOR_ACCELEROMETER,
            SensorManager.SENSOR_DELAY_NORMAL);
}

@Override
protected void onStop() {
    sm.unregisterListener(this);
    super.onStop();
}    

    public Location alig = null;
    class MyLocationListener implements LocationListener {

        public Location gLoc  = null;
        public Location mLoc = null;
        public void onLocationChanged(Location location) {
            // TODO Auto-generated method stub
            if (location != null) {
                synchronized (this) {
                // This needs to stop getting the location data and save the battery power.
                    //locManager.removeUpdates(locListener); 

                    alig = location;
                    String longitude = "Longitude: " + location.getLongitude();
                    String latitude = "Latitude: " + location.getLatitude();
                    String altitiude = "Altitiude: " + location.getAltitude();
                    String accuracy = "Accuracy: " + location.getAccuracy();
                    String time = "Time: " + location.getTime();

                    //editTextShowLocation.setText(londitude + "\n" + latitude + "\n" + altitiude + "\n" + accuracy + "\n" + time);
                    //progress.setVisibility(View.GONE);

                    xView1.setText("X: " + longitude);
                    yView1.setText("Y: " + latitude);
                    zView1.setText("Z: " + altitiude);
                }
            }           
        }

        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub

        }

        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub

        }

        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub

        }

    }
} 
```

# javascript - Socket.io node.js Math.random 为所有用户将精灵定位在同一个地方

> ID：13782856
> 
> 赞同：0
> 
> 时间：2012-12-08T23:05:37.333
> 
> 标签：javascript, html, oop, node.js, socket.io

我正在创建一个多人游戏，用户必须收集放置在画布上的对象。我需要将这些对象放置在每个用户的相同位置。我正在使用 socket.io 服务器来创建坐标，并使用客户端来绘制精灵：

客户：

```
var ShoppingList = function(noItems){
    var self = this;
    self.list = [];

    for(var i = 0; i < noItems; i++){
    socket.emit('getPosition', {id: i, gameWidth: Game.width});

    socket.on('setPosition', function(data){
        self.list.push(new ShoppingListItem(data.id, data.x, data.y));;
        //this.list.push(new ShoppingListItem(i));
    }); 
```

服务器：

```
socket.on('getPosition', function(data) {
    socket.emit('setPosition', {
        x: 32 + (Math.random() * (data.gameWidth - 64)),
        y: 32 + (Math.random() * (data.gameWidth - 64)),
        id: data.id
    });
}); 
```

但是，从 socket.on 函数中访问第一个代码块中的 ShoppingList 会引发 null 错误。无论如何要在函数之外添加到该数组中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T20:53:00.650

您应该去掉`socket.on('setPosition', ...)`ShoppingList 函数。你这样做的方式并没有真正意义，因为它只会在 setPosition 事件在函数中时监听它。这意味着该函数将在服务器触发 setPosition 之前结束，因为在发出事件之后会有延迟（无论多么小）。而是尝试类似的东西

```
var ShoppingList = function(noItems){
    var self = this;
    self.list = [];

    for(var i = 0; i < noItems; i++){
        socket.emit('getPosition', {id: i, gameWidth: Game.width});
    }
};

socket.on('setPosition', function(data){
    ShoppingList.list.push(new ShoppingListItem(data.id, data.x, data.y));
}); 
```

# javascript - node.js 中的对象到 json 字符串

> ID：13782863
> 
> 赞同：3
> 
> 时间：2012-12-08T23:07:38.963
> 
> 标签：javascript, json, node.js

我有一个 node.js 反对 json 字符串的问题

```
var chat = {};
chat.messages = [];
chat.messages['en'] = [];
chat.messages['fr'] = [];
console.log(chat.messages)
console.log(JSON.stringify(chat.messages)); 
```

我有

```
[ en: [], fr: [] ]
[] 
```

我不知道为什么这不能正确转换

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-08T23:10:59.720

在这一行，您初始化`chat.messages`为一个空数组：

```
chat.messages = []; 
```

在这里，您将其用作对象：

```
chat.messages['en'] = [];
chat.messages['fr'] = []; 
```

这些行实际上在数组实例上设置属性。奇怪的是 Node 会在正常`.toString()`结果中包含这些属性（即，您会看到 set 属性作为`console.log(chat.messages)`.

* * *

无论如何，要修复，请声明`chat.messages`为对象：

```
chat.messages = {};
chat.messages['en'] = [];
chat.messages['fr'] = []; 
```

# html - 通过模态表单提交（Django）传递变量

> ID：13782865
> 
> 赞同：0
> 
> 时间：2012-12-08T23:07:45.547
> 
> 标签：html, django, twitter-bootstrap

我的页面上有 3 个选项：早餐、午餐和晚餐。当您将鼠标悬停在它们上方时，会出现一个选择餐点的请求按钮。这带来了一个模态表单，让人们可以在一个表单中选择不同的膳食。

我想在餐食类型中添加餐食。不过，我可以找出膳食类型的唯一方法是，如果我以某种方式将此信息传递给 1) 模态对话框和 2) 那里的提交按钮。

我将如何做这两件事？

相关代码：

***模板***

```
 <div class="row-fluid">
            <div class="span12 hero-unit">
                <div class="row-fluid">
                       <h3> What Type of Meal Is It- Breakfast Lunch or Dinner? </h3>
                    </p>
                    <br>
                </div>
                <div class="row-fluid align-center">
                    <div class="span4">
                        <div>
                            <div class="library-image-parent">
                                <img src="{{ STATIC_URL }}images/breakfast.png"
                                width="200" height="160" alt="1" />
                                <div class="options">
                                    <ul class="unstyled" style="font-size:16px;">
                                 <div class="span11" style="text-align:center;">
                                        <a href="#myModal" role="button" class="btn btn-success" data-toggle="modal">Request A Meal</a>
                                                                        </div>
                            </div>
                        </div>
</div>

                    </div> 
```

***提出用餐要求的模式表格***

```
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
<h3 id="myModalLabel">Select Your Meal to Make a Request</h3>
</div>
<div class="modal-body">
<form enctype="multipart/form-data" method="POST" action="" class="uniForm">
    <fieldset class="inlineLabels">
        {% csrf_token %}
        <h6> Meal </h6>
        <br>
        {{ formtoaddrequest.meal }}
        <br>
                    <div class="form_block" style="float:right;">
                        <input class="btn btn-primary" type="submit" value="{% trans 'Add Request' %}">
                    </div>
    </fieldset>
</form>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:15:09.510

据我了解，您希望将餐食动态添加到您的表单对话中。这将要求您使用 javascript 将餐点添加到您的页面，以便用户可以选择餐点。一旦用户选择了早餐、午餐或晚餐，您将需要进行 Ajax 调用以返回可以在所选菜单下选择的餐点。在这种情况下，菜单指的是早餐菜单、午餐菜单或晚餐菜单。

# symfony - Symfony2 表单实体到字符串转换器问题

> ID：13782878
> 
> 赞同：3
> 
> 时间：2012-12-08T23:09:13.603
> 
> 标签：symfony, symfony-2.1, symfony-forms

我正在使用 Symfony 2.1.3-DEV 并尝试完成将实体转换为字符串（某种 ID），然后在提交表单时从字符串返回到实体。如果我使用说明书中给出的变压器，问题是一样的：http: [//symfony.com/doc/master/cookbook/form/data_transformers.html](http://symfony.com/doc/master/cookbook/form/data_transformers.html)

控制器代码：

```
$task = $entityManager->find('AcmeTaskBundle:Task', $id);
$form = $this->createForm(new TaskType(), $task); // so $task->issue is Issue object 
```

我收到此错误：

> 表单的视图数据应该是 Acme\TaskBundle\Entity\Issue 类的一个实例，但它是一个 (n) 字符串。您可以通过将“data_class”选项设置为 null 或添加将 a(n) 字符串转换为 Acme\TaskBundle\Entity\Issue 实例的视图转换器来避免此错误。

问题是，我已经有一个转换器，可以转换为字符串。

来自`Form.php`：

```
if (null !== $dataClass && !$viewData instanceof $dataClass) {
    throw new FormException(
       //...
    );
} 
```

为什么`$viewData`要检查为`data_class`参数的实例（或给定对象的猜测类型）？视图数据不应该是字符串/数组等吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-11T00:04:37.253

经过一步一步的挖掘，我发现了我面临的问题。

查看数据确实必须是`data_class`参数指定的类的实例。如果您使用的是转换器对象 -> 字符串，则必须将`data_class`参数设置为`null`.

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults(array(
        'data_class' => null,
    ));
} 
```

默认情况下，`data_class`是`get_class`指定初始数据的结果。如果您将对象传递给控制器`createForm`​​或一些相应的表单创建器函数，并且不存在默认值`data_class`，它将被设置为给定对象的类。

尽管如此，文档中给出的示例仍然可以正常工作 - 如果表单是内部的（在另一个表单内），`data_class`则不会设置为`null`.

由于仅从一个字段（我的转换器案例中的文本字段）制作表单非常罕见，通常这种带有转换器的表单将在其他表单中，所以它会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T08:19:44.547

我遇到了同样的问题，因为我不小心输入了我的控制器：

`$em->getRepository('AcmeWhateverBundle:Something')->findBy(array('id' => $id), array());`

代替：

`$em->getRepository('AcmeWhateverBundle:Something')->findOneBy(array('id' => $id), array());`

因此，如果您没有使用任何自定义数据转换器，请检查以下行中的 $entity 是否是 FormType 中定义为 data_class 的同一类的对象：

范围控制器： `$form = $this->createForm(new SomethingType(), $entity, array( ....`

# php - 无法执行邮件传递程序

> ID：13782881
> 
> 赞同：6
> 
> 时间：2012-12-08T23:10:00.897
> 
> 标签：php, codeigniter, phpmailer

```
$this->load->model('emailmodel');
$query = $this->emailmodel->get_emails();
$emails = array();
set_time_limit(0);

foreach($query->result() as $u)
{
    $this->notification->send($u->to, $this->config->item('neworder'),'orders/mail/subscription', 
        array(
            'order' => $neworder,
            'user' => $user
        ));
    break;
} 
```

所以我为每个订阅用户循环发送邮件，但它给了我一个错误：

```
Could not execute mail delivery program '/usr/sbin/sendmail -t -i ' 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-20T08:33:18.500

我认为您的系统不支持该路径中的 sendmail。您必须更改 sendmail 路径或重新安装它，并确保您的队列邮件没有超载...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-25T14:33:07.890

我们遇到了同样的问题。请检查您系统上的安全限制 (ulimit)

你可以执行**ulimit -a**

> bash# ulimit -a
> 
> ...
> 打开文件 (-n) 1024
> 最大用户进程 (-u) 1024
> ...

您可以在 RedHat 上的**/etc/security/limits.conf** 中更改它 我们已将 nproc 和 nofile 更改为更大的值。

因为每个 mail() 调用都会打开一个端口（文件）。如果您达到 Filelimit，则会出现此错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-18T13:35:15.470

我们也突然出现了这个奇怪的错误。重新启动 php-fpm 清除了我们案例中的问题。这可能是我的最大文件数或其他一些内存泄漏类型的问题引起的。为了防止这种情况再次发生，我启用了 pm.max_requests = 200 以便更频繁地循环 php-fpm 进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-09T13:23:56.017

发送超过 50,000 封电子邮件（1.1GB 数据）的相同案例也发生在这里。

我使用了一个简单的脚本，它使用“select * from email_queue”读取所有内容，并将其传递给 mysqli_fetch_assoc() 循环中的 mail()。多年来，这一直与 cronjob 一起顺利运行，但不是最后一次。

这里的解决方案是只发送一个“select id from email_queue”，然后用另一个“select *...”读取循环中的记录并将其传递给 mail()。此外，平均负载已显着下降。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-24T06:46:47.880

就我而言，该站点托管在 MediaTemple 上，它似乎是 PHP 版本。该站点在 5.3 FastCGI 上运行，当我切换到 5.3 CGI 时它运行良好。

# javascript - 如何在按下键时显示元素，然后如果再次按下，隐藏元素？

> ID：13782884
> 
> 赞同：1
> 
> 时间：2012-12-08T23:10:08.180
> 
> 标签：javascript, jquery, html, css, animation

我有这个项目，我有一个侧面菜单，可以使用 [Ctrl] + [Z] 进行切换。我希望它在下次按下 [Ctrl] + [Z] 模式时隐藏。我对 JavaScript 的平庸知识阻碍了我使用 google 来表达它，所以我最终没有找到任何东西，所以我来这里。有了大量的 JavaScript，我知道这在*技术上*应该可以工作，但在*逻辑上*是行不通的。有任何想法吗？这是我的代码：

```
var letter = {
    z: 90
    ...

};

$(document).ready(function() {

    $("body").keydown(function(event) {

            // toggles element the first time
        if(event.ctrlKey && event.which === letter.z) {
            $("[data-location='top']").slideDown("fast");
            $("[data-location='bottom']").slideDown("fast");
        }

            // hides element the second time
        if(event.ctrlKey && event.which === letter.z) {
            $("[data-location='top']").slideUp("fast");
            $("[data-location='bottom']").slideUp("fast");
        }

    });

}); 
```

任何帮助将不胜感激！:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T23:12:52.793

.slideToggle() 函数正是您要寻找的。

```
var letter = {
    z: 90
    ...

};

    $(document).ready(function() {

        $("body").keydown(function(event) {

            if(event.ctrlKey && event.which === letter.z) {
                $("[data-location='top']").slideToggle("fast");
                $("[data-location='bottom']").slideToggle("fast");
            }

        });

    }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T23:16:01.407

JavaScript：

```
var letter = {
    z: 90

};

$(document).ready(function() {
var visible = false;
    $("body").keydown(function(event) {

            // toggles element the first time
        if(!visible && event.ctrlKey && event.which === letter.z) {
            visible = true;
            $("[data-location='top']").slideDown("fast");
            $("[data-location='bottom']").slideDown("fast");
        } else if(visible && event.ctrlKey && event.which === letter.z) {
            visible = false;
            $("[data-location='top']").slideUp("fast");
            $("[data-location='bottom']").slideUp("fast");
        }

    });

});​ 
```

HTML：

```
<div id="top" class="hidden" data-location="top"></div>
<div id="bottom" class="hidden" data-location="bottom"></div>​ 
```

CSS：

```
#top {height:100px;width:500px;background-color:red;}
#bottom {height:100px;width:500px;background-color:blue;}
.hidden {display:none;} 
```

[小提琴](http://jsfiddle.net/wkBWL/12/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T23:13:55.990

你只需要绑定一次keydown，然后把你的逻辑扔进去。所以你的代码会变成：

```
var letter = {
    z: 90
    ...

};

$(document).ready(function() {

    $("body").keydown(function(event) {

            // toggles element the first time
        if(event.ctrlKey && event.which === letter.z) {
            $("[data-location='top']").toggle("fast");
            $("[data-location='bottom']").toggle("fast");
        }

    });

}); 
```

# android - 如何通过在android中指定x和y坐标在画布上绘制的位图图像上绘制一个点？

> ID：13782890
> 
> 赞同：0
> 
> 时间：2012-12-08T23:10:40.337
> 
> 标签：android, canvas

我在画布上绘制了位图图像。

```
Bitmap image = BitmapFactory.decodeResource(getResources(), R.drawable.sq);
        canvas.drawColor(color.black);  
        Rect dstRectForRender = new Rect(0,0,320,450);               
        canvas.drawBitmap(image, null,dstRectForRender,null); 
```

该图像根据我在 cnavs 上的屏幕显示。在我的触摸输入上，我需要传递图像的 x 和 y 坐标位置，并用颜色填充该像素，以显示图像是在拖动事件上绘制的。如何传递 x 和 y 坐标参数？我应该使用哪些函数来绘制图像上的像素？我感谢你的帮助和甜蜜的时光。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:21:21.533

我不确定这是否是*最好*的方法，但是如果您定义自己的子类`ImageView`并将其命名为`DrawableImageView`. 您必须确保从 实现所有基本构造函数`ImageView`，然后覆盖该`onTouchEvent`方法。从该事件中，您可以获取触摸坐标并将它们存储在一个中`ArrayList<Point>`，并通过覆盖该`onDraw`方法并“绘制”图像来使用该 ArrayList。

```
public class DrawableImageView extends ImageView {

ArrayList<Point> list = new ArrayList<Point>();    

//constructors..

@Override
public boolean onTouchEvent (MotionEvent event) {
    float x = event.getX();
    float y = event.getY();
    list.add(new Point(x,y));
    invalidate();
} 
```

这只是关于如何开始你的课程的一个非常简短的概述，可能不是最准确的做事方式（取决于你的具体代码）。现在，不是`<ImageView>`在您的 xml 中使用标签（或者，以编程方式加载 ImageView），而是像这样引用您的子类：

```
<your.package.name.DrawableImageView
/> 
```

## 编辑

针对您的评论，没有预先确定的方式来绘制图像。你必须自己实现，这就是为什么我建议存储`Points`在 ArrayList 中。我不确定您要在这里实现什么，但是要在您必须覆盖的图像上绘制（例如）黑点`onDraw`：

```
public void onDraw(Canvas c) {
    super.onDraw(c);
    for(Point p : list) {

        //Draw black point at x and y.. I'm posting from my cell so I can't go into much detail
   }
} 
```

此外，要强制视图重绘自身，您需要使用`invalidate()`您的方法`onTouchEvent()`（我在上面添加）。

# java - 枚举类型的值是该类型的静态变量。真的？

> ID：13782901
> 
> 赞同：2
> 
> 时间：2012-12-08T23:11:30.340
> 
> 标签：java, enums

**枚举类型的值是该类型的静态变量。** 据我所知，变量是由引用变量引用的，但没有新的运算符来实例化枚举对象。但这就像初始化数组一样吗？

这是对还是错？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:37:09.863

是的，枚举类型的文字是`public static final`变量。

简化后，它看起来像这样：

```
public final enum FooEnum {
    A, B
}

public final class BarEnum {
    public static final BarEnum A = new BarEnum();
    public static final BarEnum B = new BarEnum();
} 
```

实际上，那里还有更多的东西，例如所有枚举文字的列表、一个字符串标识符（枚举值知道它的`name`）、一个序数和一个私有构造函数以防止实例化（为了清楚起见，所有这些都被省略了）只是关于`static`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:38:15.497

Afaik 枚举被转换为类，是的，这些值是此类中的静态字段：http: [//theopentutorials.com/tutorials/java/enum/enum-converted-to-class/](http://theopentutorials.com/tutorials/java/enum/enum-converted-to-class/)

# c# - 用于打开视图的 Asp.net 控制器逻辑

> ID：13782902
> 
> 赞同：0
> 
> 时间：2012-12-08T23:11:41.327
> 
> 标签：c#, post, razor, view

我使用 mvc3 和代码优先脚手架，第一个片段来自 /post/index.cshtml

```
 <td>
        @Html.ActionLink("Edit", "Edit", new { id=item.Id }) |
        @Html.ActionLink("Details", "Details", new { id=item.Id }) |
        @Html.ActionLink("Delete", "Delete", new { id=item.Id }) | 
        @Html.ActionLink("Comment", "Comment", new { id=item.Id })
    </td> 
```

我应该在动作中添加什么以使 /Commment/Create.cshtml 打开并使用帖子填充客栈的 ID 打开帖子字段？

```
 public ActionResult Comment(int id)
    {
        throw new NotImplementedException();
    } 
```

这是帖子字段

```
 <div class="editor-label">
        @Html.LabelFor(model => model.PostID, "Post")
    </div>
    <div class="editor-field">
        @Html.DropDownList("PostID", String.Empty)
        @Html.ValidationMessageFor(model => model.PostID)
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:47:50.657

你就不能这样做吗？

```
<td>
    @Html.ActionLink("Comment", "Comment", new { id = Model.PostID })
</td> 
```

还是您想从 DropDownMenu 中获取当前值？在这种情况下，您需要使用 Javascrip/jQuery：

```
var currentPostId = $('#PostID').val(); 
```

并使用它来更新 ActionLink`href`属性。

# c++ - 多次指定对象，忽略附加项

> ID：13782903
> 
> 赞同：0
> 
> 时间：2012-12-08T23:12:04.477
> 
> 标签：c++, compiler-errors, linker-errors

我收到这些错误：

1>----- 构建开始：项目：TankSample，配置：调试 Win32 ------

1>Debug\BackBuffer.obj : 警告 LNK4042：对象指定了多次；额外被忽略

1>Source.obj：错误LNK2019：函数“long”中引用的未解析外部符号“public：**thiscall BackBuffer::BackBuffer(struct HWND** *,int,int)”(??0BackBuffer@@QAE@PAUHWND__@@HH@Z) **stdcall WndProc(struct HWND** *,unsigned int,unsigned int,long)" (?WndProc@@YGJPAUHWND__@@IIJ@Z)

1>Source.obj：错误LNK2019：未解析的外部符号“public：__thiscall BackBuffer::~BackBuffer(void)”(??1BackBuffer@@QAE@XZ)在函数“public:void * __thiscall BackBuffer::`标量删除”中引用析构函数'(unsigned int)" (??_GBackBuffer@@QAEPAXI@Z)

1>Source.obj：错误 LNK2019：未解析的外部符号“public：struct HDC__ * **thiscall BackBuffer::getDC(void)”(?getDC@BackBuffer@@QAEPAUHDC** @@XZ) 在函数“int __cdecl Run(void)”中引用(?跑@@YAHXZ)

1>Source.obj：错误LNK2019：函数“int __cdecl Run(void)”(?Run@@亚哈兴）

1>C:\Users\Josh\Documents\Game Institute\C++\Module Two\Exercises\Chapter 17\TankSample\Debug\TankSample.exe : 致命错误 LNK1120: 4 unresolved externals ========= 构建: 0 成功, 1 失败, 0 最新, 0 跳过 ==========

当我尝试编译此代码时：

后台缓冲区.h

```
#pragma once

#include <Windows.h>

class BackBuffer
{
public:
    BackBuffer( HWND hWnd, int width, int height );
    ~BackBuffer();

    HDC getDC();

    int width();
    int height();

    void present();

//private:
    // Make copy constructor and assignment operator private so
    // client cannot copy BackBuffers. We do this because this
    // class is not designed to be copied because it is not
    // efficient--copying bitmaps is slow. (Lots of memory).
    //BackBuffer( const BackBuffer& rhs );
    //BackBuffer& operator=( const BackBuffer& rhs );

private:
    HWND    mhWnd;       // A handle to the main window. We need this to obtain a device context associated to the main window.
    HDC     mhDC;        // A handle to the system memoy DC.
    HBITMAP mhSurface;   // A handle to the bitmap that serves as our backbuffer.
    HBITMAP mhOldObject; // A handle to the previous bitmap.
    int     mWidth;      // The width of the bitmap matrix.
    int     mHeight;     // The height of the bitmap matrix.

}; 
```

后台缓冲区.cpp

```
#include "BackBuffer.h"

BackBuffer::BackBuffer( HWND hWnd, int width, int height ) : mhWnd( hWnd ), mWidth( width ), mHeight ( height )
{

    // Get a handle to the device context associated with the window.
    HDC hWndDC = GetDC( hWnd );

    // Create system memory DC that is compatible with the window one.
    mhDC = CreateCompatibleDC( hWndDC );

    // Create the backbuffer surface bitmap that is compatible with the window
    // DC bitmap format. That is the surface we will render onto.
    mhSurface = CreateCompatibleBitmap( mhDC, mWidth, mHeight );

    // Done with window DC.
    ReleaseDC( hWnd, hWndDC );

    // At this point, the backbuffer surface is uninitialized, so lets clear it
    // to some non-zero value. Note that it needs to be non-zero. If it is zero
    // then it will mess up our sprite blending logic.

    // Select the backbuffer bitmap into the DC.
    mhOldObject = (HBITMAP)SelectObject( hWndDC, mhSurface );

    // Select a white brush.
    HBRUSH white    = (HBRUSH)GetStockObject( WHITE_BRUSH );
    HBRUSH oldBrush = (HBRUSH)SelectObject( mhDC, white );

    // Clear the backbuffer rectangle.
    Rectangle( hWndDC, 0, 0, mWidth, mHeight );

    // Restore the original brush.
    SelectObject( mhDC, oldBrush );

}
/*
BackBuffer::BackBuffer( const BackBuffer& rhs )
{
    *this = rhs;
}

BackBuffer& BackBuffer::operator=( const BackBuffer& rhs )
{
    if( this == &rhs )
        return *this;

    mhWnd       = rhs.mhWnd;       
    mhDC        = rhs.mhDC;
    mhSurface   = rhs.mhSurface;
    mhOldObject = rhs.mhOldObject;
    mWidth      = rhs.mWidth;
    mHeight     = rhs.mHeight;

    return *this;
}*/

BackBuffer::~BackBuffer()
{
    // Restore the original selected bitmap before deleting anything.
    SelectObject( mhDC, mhOldObject );

    // Delete the backbuffer bitmap.
    DeleteObject( mhSurface );

    // Delete the DC.
    DeleteDC( mhDC );
}

HDC BackBuffer::getDC()
{
    return mhDC;
}

int BackBuffer::width()
{
    return mWidth;
}

int BackBuffer::height()
{
    return mHeight;
}

void BackBuffer::present()
{
    // Get a handle to the DC associated with the window.
    HDC hWndDC = GetDC( mhWnd );

    // Copy the backbuffer contents over to the windows client area.
    BitBlt( hWndDC, 0, 0, mWidth, mHeight, mhDC, 0, 0, SRCCOPY );

    // Always free a window DC when done.
    ReleaseDC( mhWnd, hWndDC );
} 
```

vec2.h

```
#pragma once

#include <cmath>

class Vec2
{
public:
    // Constructors
    Vec2() : x( 0.0f ), y( 0.0f ){};
    Vec2( float coords[2] ) : x( coords[0] ), y( coords[1] ){};
    Vec2( const POINT& p ) : x( p.x ), y( p.y ){};
    Vec2( float v1, float v2 ) : x( v1 ), y( v2 ){};

    Vec2( const Vec2& rhs )
    {
        *this = rhs;            
    }

    Vec2& operator=( const Vec2& rhs )
    {
        if( this == &rhs )
            return *this;

        x = rhs.x;
        y = rhs.y;

        return *this;
    }

    ~Vec2(){};

    Vec2 operator+( const Vec2& rhs ) const
    {
        Vec2 sum;

        sum.x = x + rhs.x;
        sum.y = y + rhs.y;

        return sum;
    }

    Vec2 operator-( const Vec2& rhs ) const
    {
        Vec2 result;

        result.x = x - rhs.x;
        result.y = y - rhs.y;

        return result;
    }

    Vec2 operator-()
    {
        Vec2 result;
        x = -x;
        y = -y;

        return result;
    }

    void operator*=( float scalar )
    {
        x *= scalar;
        y *= scalar;
    }

    void operator+=( const Vec2& rhs )
    {
        x += rhs.x;
        y += rhs.y;
    }

    void operator-=( const Vec2& rhs )
    {
        x -= rhs.x;
        y -= rhs.y;
    }

    void operator/=( const Vec2& rhs )
    {
        // Assumes rhs != 0
        x /= rhs.x;
        y /= rhs.y;
    }

    // Convert to point.
    operator POINT()
    {
        POINT p = {(int)x, (int)y};
        return p;
    };

    // Return length.
    float length()
    {
        return sqrtf( x * y + y * y );
    }

    float dot( const Vec2& rhs )
    {
        return x * rhs.x + y * rhs.y;
    }

    Vec2& rotate( float t )
    {
        float newX;
        newX = x * cosf(t) - y * sinf(t);
        y    = y * cosf(t) + x * sinf(t);

        this->x = newX;
        return *this;
    }

    // Data members.
    float x;
    float y;

};

Vec2 operator*( const Vec2& rhs, float s )
{
    Vec2 result;

    result.x = rhs.x * s;
    result.y = rhs.y * s;

    return result;
}

Vec2 operator/( const Vec2& rhs, float s )
{
    Vec2 result;

    result.x = rhs.x / s;
    result.y = rhs.y / s;

    return result;
} 
```

源.cpp

```
#include <Windows.h>
#include <string>
#include <list>
#include "BackBuffer.h"
#include "Vec2.h"
#include "resource.h"

using namespace std;

// WINDOWS HANDLES
HWND      ghMainWnd  = 0;
HINSTANCE ghAppInst  = 0;
HMENU     ghMainMenu = 0;

// The backbuffer we will render onto.
BackBuffer* gBackBuffer = 0;

// The text that will appear in the main window's caption bar.
string gWndCaption = "Tank Sample";

// Client rectangle dimensions we will use.
const int gClientWidth  = 800;
const int gClientHeight = 600;

const POINT gClientCenter =
{
    gClientWidth / 2,
    gClientHeight / 2
};

// Pad window dimensions so that there is room for window
// borders, caption bar, and menu.
const int gWindowWidth  = gClientWidth + 6;
const int gWindowHeight = gClientHeight + 52;

// Client area rectangle.
RECT gMapRect = {0, 0, 800, 600};

// Vector to store the center position of the tank
// relative to the client area rectangle.
Vec2 gTankPos( 400.0f, 300.0f );

// Handle to the pen we will use to draw the tanks' gun.
HPEN gGunPen;

// A vector describing the direction of the tanks' gun
// is aimed in. The vectors' magnitude denotes the 
// length of the gun.
Vec2 gGunDir( 0.0f, -120.0f );

// A list, where we will add bullets to as they are fired.
// The list stores the bullets positions, so that we can draw
// an ellipse at the positino of each bullet.
list<Vec2> gBulletList;

//==============================================
// Function Prototypes
//==============================================

bool InitMainWindow();
int Run();
void DrawFramesPerSecond( float deltaTime );

LRESULT CALLBACK
WndProc( HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam );

//==============================================
// Name: WinMain
// Desc: Program execution starts here.
//==============================================
int WINAPI
WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, PSTR cmdLine, int showCmd )
{

    ghAppInst = hInstance;

    if( !InitMainWindow() )
    {
        MessageBox( 0, "Window Creation Failed", "Error", MB_OK );
        return 0;
    }

    return Run();

}

//==============================================
// Name: InitMainWindow
// Desc: Creates the main window upon which
//       we will draw onto.
//==============================================

bool InitMainWindow()
{
    WNDCLASS wc; 
    wc.style         = CS_HREDRAW | CS_VREDRAW;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = ghAppInst;
    wc.hIcon         = ::LoadIcon(0, IDI_APPLICATION);
    wc.hCursor       = ::LoadCursor(0, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)::GetStockObject(NULL_BRUSH);
    wc.lpszMenuName  = 0;
    wc.lpszClassName = "MyWndClassName";

    RegisterClass( &wc );

    // WS_OVERLAPPED | WS_SYSMENU: Window cannot be resized
    // and does not have a min/max button.  
    ghMainMenu = LoadMenu(ghAppInst, MAKEINTRESOURCE(IDR_MENU1));

    ghMainWnd = CreateWindow("MyWndClassName", gWndCaption.c_str(), WS_OVERLAPPED | WS_SYSMENU, 200, 200, gWindowWidth, gWindowHeight, 0, ghMainMenu, ghAppInst, 0);

    if(ghMainWnd == 0)
    {
        ::MessageBox(0, "CreateWindow - Failed", 0, 0);
        return 0;
    }

    ShowWindow(ghMainWnd, SW_NORMAL);
    UpdateWindow(ghMainWnd);

    return true;
}

//=========================================================
// Name: Run
// Desc: Encapsulates the message loop.
//=========================================================
int Run()
{
    MSG msg;
    ZeroMemory( &msg, sizeof( MSG ) );

    // Get the performance timer frequency.
    __int64 cntsPerSec = 0;
    bool prefExists = QueryPerformanceFrequency( ( LARGE_INTEGER* )&cntsPerSec) != 0;
    if( !prefExists )
    {
        MessageBox( 0, "Perforamce timer doesn't exist.", 0, 0 );
        return 0;
    }

    double timeScale = 1.0 / (double)cntsPerSec;

    // Get the current time.
    __int64 lastTime = 0;
    QueryPerformanceCounter( ( LARGE_INTEGER* )&lastTime );

    double timeElasped = 0;

    while( msg.message != WM_QUIT )
    {

        // IF there is a windows message then process it.
        if( PeekMessage( &msg, 0, 0, 0, PM_REMOVE ) )
        {
            TranslateMessage( &msg );
            DispatchMessage( &msg );
        }
        else // DO GAME STUFF
        {
            // Get the time now.
            __int64 currTime = 0; 
            QueryPerformanceCounter( ( LARGE_INTEGER* )&currTime );

            // Compute the differences in time from the last time
            // we checked. Since the last time we checked was given
            // the previous loop iteration, this difference gives
            // us the time between loop iterations...
            // or, I.E., the time between frames.
            double deltaTime = double( currTime - lastTime ) * timeScale;

            timeElasped += deltaTime;

            // Get the backbuffer DC.
            HDC bbDC = gBackBuffer->getDC();

            // Clear the entire backbuffer to black. This gives up a black background.
            HBRUSH oldBrush = (HBRUSH)SelectObject( bbDC, GetStockObject( BLACK_BRUSH ) );
            Rectangle( bbDC, 0, 0, 800, 600 );

            // Draw the base of the tank--a rectangle surrounding the tanks'
            // center position point.
            SelectObject( bbDC, GetStockObject( DKGRAY_BRUSH ) );
            Rectangle( bbDC, (int)gTankPos.x - 50, (int)gTankPos.y - 75, (int)gTankPos.x + 50, (int)gTankPos.y + 75 );

            // Draw the gun base of the tank--an ellipse surrounding the tanks'
            // center position point.
            SelectObject( bbDC, GetStockObject( GRAY_BRUSH ) );
            Ellipse( bbDC, (int)gTankPos.x - 40, (int)gTankPos.y - 40, (int)gTankPos.x + 40, (int)gTankPos.y + 40 );

            // Draw the gun itself--a line from the tanks' center
            // position point to the tip of the gun.
            HPEN oldPen = (HPEN)SelectObject( bbDC, gGunPen );
            MoveToEx( bbDC, (int)gTankPos.x, (int)gTankPos.y, 0 );
            LineTo( bbDC, (int)(gTankPos.x + gGunDir.x), (int)(gTankPos.y + gGunDir.y) );

            // Draw any bullets that get fired.
            SelectObject( bbDC, GetStockObject( WHITE_BRUSH ) );
            SelectObject( bbDC, oldPen );

            // Bullet velocity is 5X the guns' directions' magnitude.
            Vec2 bulletVel = gGunDir * 5.0f;
            list<Vec2>::iterator i;
            i = gBulletList.begin();
            while( i != gBulletList.end() )
            {
                // Update the bullet position.
                *i += bulletVel * deltaTime;

                // Get POINT form.
                POINT p = *i;

                // Only draw bullet if it is inside the map boundaries, otherwise delete it.
                if( !PtInRect( &gMapRect, p ) )
                    i = gBulletList.erase( i ); // Deletes element as position i and increments i by 1.
                else
                {
                    // Draw bullet as a circle.
                    Ellipse( bbDC, p.x - 4, p.y - 4, p.x + 4, p.y + 4 );

                    // Next in the list.
                    ++i;
                }
            }

            // Select old brush.
            SelectObject( bbDC, oldBrush );

            DrawFramesPerSecond( ( float )deltaTime );

            // Present the backbuffer contents.
            gBackBuffer->present();

            // We are at the end of the loop iteration, so prepare for the
            // next loop iteration by making the "current time" the "last time".
            lastTime = currTime;

            // Free 20 miliseconds to Windows so we don't hog the system resources.
            Sleep( 20 );
        }

    }

    // Return exit code back to the operating system.
    return (int)msg.wParam;

}

//=========================================================
// Name: DrawFramesPerSecond
// Desc: This function is called every frame and updates
//       the frame per second display in the main window
//       caption.
//=========================================================
void DrawFramesPerSecond( float deltaTime )
{
    // Make static variables persist even after the function returns.
    static int   frameCnt = 0;
    static float timeElasped = 0;
    static char  buffer[256];

    // Function called implies a new frame, so
    // increment frame count.
    ++frameCnt;

    // Also increment how much time has passed since
    // the last frame.
    timeElasped += deltaTime;

    // Has one second passed?
    if( timeElasped >= 1.0f )
    {
        // Yes, so compute the frames per second.
        // FPS = frameCnt / timeElasped, but since we
        // compute only when timeElasped = 1.0f, we can
        // reduce to:
        // FPS = frameCnt / 1.0 = frameCnt.

        sprintf_s( buffer, "--Frames Per Second = %d", frameCnt );

        // Add the frames per second string to the main
        // window caption.
        string newCaption = gWndCaption + buffer;

        SetWindowText( ghMainWnd, newCaption.c_str() );

        // Reset the counters to prepare for the next time
        // we compute the frames per second.
        frameCnt = 0;
        timeElasped = 0.0f;
    }
}

//=========================================================
// Name: Window Procedure
// Desc: The main window procedure.
//=========================================================
LRESULT CALLBACK
WndProc( HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam )
{
    LOGPEN lp;

    switch( msg )
    {
    case WM_CREATE:

        // Create the tanks' gun pen.
        lp.lopnColor   = RGB( 150, 150, 150 );
        lp.lopnStyle   = PS_SOLID;
        lp.lopnWidth.x = 10;
        lp.lopnWidth.y = 10;

        gGunPen = CreatePenIndirect( &lp );

        // Create the backbuffer.
        gBackBuffer = new BackBuffer( hWnd, gClientWidth, gClientHeight );

    return 0;

    case WM_DESTROY:

        DeleteObject( gGunPen );
        delete gBackBuffer;
        PostQuitMessage( 0 );

    return 0;

    case WM_COMMAND:

        switch( LOWORD( wParam ) )
        {
        case ID_FILE_EXIT:
            DestroyWindow( ghMainWnd );
            break;
        }

    return 0;

    case WM_KEYDOWN:

        switch( wParam )
        {
        case 'A':
            gTankPos.x -= 5.0f;
            break;
        case 'D':
            gTankPos.x += 5.0f;
            break;
        case 'W':
            gTankPos.y -= 5.0f;
            break;
        case 'S':
            gTankPos.y += 5.0f;
            break;

        case 'Q':
            gGunDir.rotate( -0.1f );
            break;
        case 'E':
            gGunDir.rotate( 0.1f );
            break;

        case VK_SPACE:
            gBulletList.push_back( gTankPos + gGunDir );
            break;
        }

    return 0;
    }

    return DefWindowProc( hWnd, msg, wParam, lParam );
} 
```

显然它与 BackBuffer 有关，但我不确定。我试图创建一个全新的项目并复制代码，但这不起作用。我删除了 BackBuffer.obj 文件并重新构建，引发相同的错误。

任何人都可以阐明为什么会这样吗？

谢谢。

# java - 如何在 java URLConnection 中维护会话？

> ID：13782911
> 
> 赞同：0
> 
> 时间：2012-12-08T23:13:04.177
> 
> 标签：java, request, urlconnection

在我使用 java URLConnection 登录网站后，我正在尝试登录网站并获取页面站点的页面源。我面临的问题是我无法维护会话，因此服务器给了我这个警告并且不让我连接：

> 该系统需要使用 HTTP cookie 来验证授权信息。我们的系统检测到您的浏览器已禁用 HTTP cookie 或不支持它们。请参阅浏览器中的帮助页面，了解有关如何正确配置浏览器以用于本系统的更多信息。

起初我试图发送空 cookie 让服务器了解我正在处理会话，但它也没有给我会话 ID。

这是我的源代码：

```
try {
        // Construct data
        String data = URLEncoder.encode("usr", "UTF-8") + "=" + URLEncoder.encode("usr", "UTF-8");
        data += "&" + URLEncoder.encode("password", "UTF-8") + "=" + URLEncoder.encode("pass", "UTF-8");

        // Send data
        URL url = new URL("https://loginsite.com");
        URLConnection conn = url.openConnection();
        conn.setDoOutput(true);
        conn.setRequestProperty("Cookie", "SESSID=");
        OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
        wr.write(data);
        wr.flush();

        // Get the response
        BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
        String line;
        while ((line = rd.readLine()) != null) {
            System.out.println(line);
        }
        wr.close();
        rd.close();

        String headerName=null;
        for (int i=1; (headerName = conn.getHeaderFieldKey(i))!=null; i++) {
            if (headerName.equals("Set-Cookie")) {
                String cookie = conn.getHeaderField(i);
                System.out.println(cookie.split(";", 2)[0]);
            }
        }
        } catch (Exception e) {
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:41:49.860

您应该使用一个 HTTP 库来为您处理会话管理和 HTTP 协议的其他细节，例如支持 Cookie 和开箱即用的 Keep-Alive、代理等。试试[Apache HttpComponents](http://hc.apache.org/)

# programming-languages - 哪些编程语言没有“If”语句？

> ID：13782913
> 
> 赞同：0
> 
> 时间：2012-12-08T23:13:08.003
> 
> 标签：programming-languages

出于好奇，哪些编程语言没有“If”语句？

第一种在没有 If Then 控制结构的情况下完全运行的语言得到了答案。

-1 给予没有人真正听说过的语言（例如：“我的朋友在大学里制作了一种名为'EwoK'的编程语言，它使用了'when'语句......”）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:15:21.887

大多数汇编语言没有`if`语句，而是根据逻辑比较或处理器标志检查的结果分支或跳转到另一个位置。

# r - 确定绘图中文本的实际宽度

> ID：13782915
> 
> 赞同：5
> 
> 时间：2012-12-08T23:13:13.650
> 
> 标签：r, text, plot, margin

我在 x 轴上绘制了一个因子，因此每个点都标有因子的名称。由于如果水平绘制文本会重叠，因此我将其全部垂直绘制。但是，我偶尔会遇到 x 轴边距不够大的问题。所以，我的问题是：有没有办法确定一个文本字符串在绘制时有多长（比如英寸）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T00:08:00.633

我相信你正在寻找`strwidth`的`graphics`包。

要使用它，首先绘制图表。然后只需调用`strwidth("your string")` 例如：

```
library(graphics)

plot(1:5)

strwidth("hello")
#  [1] 0.2640991
strwidth(" a longer string\n with multiple lines asdfsdfjkdsrew")
#  [1] 1.875732

strwidth("hello", units="inches")
#  [1] 0.3521322
strwidth("hello", units="figure")
#  [1] 0.05030459 
```

* * *

如果您正在绘制旋转文本，您可能想要使用`strheight`（类似功能）

# c - 64 位系统，GINT_TO_POINTER(i) / GPOINTER_TO_INT(p)

> ID：13782916
> 
> 赞同：0
> 
> 时间：2012-12-08T23:13:25.520
> 
> 标签：c, gtk, glibc

我很难将整数传递给回调函数，因为最后一个参数`g_signal_connect`必须是指针。这是我将信号连接到回调的地方：

```
for (i=0;i<10;i++)
{

    ...
    gtk_widget_set_events(tab_ebs[i],GDK_BUTTON_PRESS_MASK);
    g_signal_connect (G_OBJECT (tab_ebs[i]), "button_press_event", G_CALLBACK (tab_clicked_cb), GINT_TO_POINTER(i));

} 
```

这是回调：

```
void tab_clicked_cb (gpointer p)
{
    printf("tab #%d clicked\n", GPOINTER_TO_INT(p));
} 
```

我在标准输出中得到的是如下语句：

```
tab #6578976 clicked
tab #6579264 clicked
tab #6579552 clicked
tab #6579840 clicked 
```

当我只有十个标签时。如何在 64 位系统上将整数传递给回调 fcn？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T02:18:24.330

没有让我走到一半。结果我的回调函数中也缺少事件的参数。这是有效的形式：

```
void tab_clicked (GtkWidget *widget, GdkEventButton *ev, gpointer p)
{
    printf("tab #%d clicked\n", GPOINTER_TO_INT(p));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:24:17.197

您的回调函数可能是错误的，大多数 Gtk 回调处理程序将发起事件的小部件作为第一个参数传递给回调函数。所以它应该是例如

```
void tab_clicked_cb (GtkWidget *widget, gpointer p)
{
    printf("tab #%d clicked\n", GPOINTER_TO_INT(p));
} 
```

编辑，Gtk[文档](http://developer.gnome.org/gtk3/3.0/GtkWidget.html)根本不清楚它的回调处理程序是什么 button_press_event，文档读取为 button_press_event 的回调处理程序不接收任何参数。

# javascript - 单击时从 jquery 可排序列表中删除一个元素

> ID：13782918
> 
> 赞同：2
> 
> 时间：2012-12-08T23:13:38.767
> 
> 标签：javascript, jquery, html, jquery-ui

我在 jQuery 中有两个可排序的列表。它们被称为 sortable1 和 sortable2。它们是 <ul> 中的 <li>。当用户将一个元素从 sortable2 拖到 sortable1 中时，该元素将克隆到 sortable2 中。一旦放入 sortable1，用户就不能将其移回 sortable2，因为已经有另一个取代了它。

我的问题本质上是两个方面：

1.  如何防止在 sortable1 中放置的项目被拖回 sortable2 中，同时仍具有重新排列的能力。
2.  我怎样才能实现点击功能，以便它会删除您点击的可排序元素。这种行为应该只发生在 sortable1 中。

这是脚本：

```
<script>
$(function() {
    $( "#sortable1" ).sortable({
        connectWith: ".connectedSortable"
    }).disableSelection();
            $( "#sortable2" ).sortable({
        connectWith: ".connectedSortable",
                    helper: function(e,li) {
                                    copyHelper= li.clone().insertAfter(li);
                                    return li.clone();
                                }
    }).disableSelection();
});    
</script> 
```

这是列表后面的 html 片段：

```
<div id="symbolbay">
     <p>Drop symbols here</p>
     <ul id="sortable1" class="connectedSortable"></ul>
</div>
<ul id="sortable2" class="connectedSortable">
    <li class="ui-state-highlight">Click me to delete only me</li>
    <li class="ui-state-highlight">Click me to delete only me</li>
...There are a whole bunch more, finally ending in...
</ul> 
```

谢谢你的帮助！我是这项惊人技术的新手，我一直对它的功能感到惊讶。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:24:06.140

您可能应该将其分为两个问题。关于#2：

```
$('#sortable1 .ui-state-highlight').click(function(){
  $(this).remove();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:03:16.260

我使用以下代码（@ChrisHerbert 代码在我的情况下不起作用）：

```
$("#sortable").on("click", "li", function () {
    $(this).remove();
}); 
```

# sql - 通过连接到其他表创建多个值的平均值

> ID：13782919
> 
> 赞同：0
> 
> 时间：2012-12-08T23:13:39.403
> 
> 标签：sql, oracle

我有两张表需要从...中创建平均总和

Caravan Category M:1 Caravan（大篷车有一个类别，类别有很多大篷车）

大篷车（**Caravan_no**，rental_amount，annual_rent ....

大篷车类别 ( **Caravan_type_id** , car_type, pets ....

大篷车类别类型具有以下实体；美国经典、传统、双 GRP...

**我想创建一个 SQL 查询，该查询将返回一个列表，显示特定大篷车类型** 的平均成本，例如 '200'Average cost for' American Classic 等等。

注意：car_type 有 8 种不同商队类型的“签入”约束，因此这将阻止用户选择未列出的商队类型并将其搞砸。

使用 Oracle APEX 4.0

有帮手吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:24:47.350

像下面这样的东西应该可以解决问题（可能需要更改某些字段名称以匹配您的架构）：

```
SELECT CC.description, AVG(C.rental_amount)
FROM CaravanCategory CC
INNER JOIN Caravan C
ON C.Caravan_Type_id = CC.Caravan_Type_id
GROUP BY CC.description 
```

# ruby-on-rails - 如果 config.cache_classes = true，Rails 找不到模块

> ID：13782923
> 
> 赞同：4
> 
> 时间：2012-12-08T23:13:54.370
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, ruby-on-rails-3.2, rails-engines

我有一个 gem，它通过`routes.rb`&安装在我的 rails 应用程序中作为引擎`Gemfile`。以下是重要的部分：

应用程序的**Gemfile**

```
source 'https://rubygems.org'

gem 'rails', '3.2.9'
gem 'mysql2'

group :assets do
  gem 'sass-rails'
  gem 'coffee-rails'
end
gem 'jquery-rails'
gem "common_client", path: "../common-client" 
```

应用的**路线.rb**

```
mount CommonClient::Engine => "", :as => 'shared' 
```

gem的**路线.rb**

```
get '/register' => 'session#new_registration' 
```

gems 的**SessionController**

```
require 'common_client/session_controller_base'

class SessionController < ApplicationController

  include CommonClient::SessionControllerBase
end 
```

gems 的**SessionControllerBase**

```
module CommonClient

  module SessionControllerBase

  def new_registration
      #some code goes here
  end
end 
```

这在开发中工作得很好，并且 Rails 能够在访问者到达路线时找到`CommonClient::SessionController`并执行操作。但在生产中，rails 无法找到并生成以下错误：`new_registration``/register``CommonClient::SessionController`

```
$ RAILS_ENV=production rails s
=> Booting WEBrick
=> Rails 3.2.9 application starting in production on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2012-12-09 03:27:29] INFO  WEBrick 1.3.1
[2012-12-09 03:27:29] INFO  ruby 1.9.3 (2012-10-12) [x86_64-linux]
[2012-12-09 03:27:29] INFO  WEBrick::HTTPServer#start: pid=4248 port=3000
Started GET "/" for 127.0.0.1 at 2012-12-09 03:28:17 +0530
Processing by WelcomeController#index as HTML
Redirected to localhost:3000/register
Filter chain halted as :check_credentials rendered or redirected
Completed 302 Found in 267ms (ActiveRecord: 0.0ms)
Started GET "/register" for 127.0.0.1 at 2012-12-09 03:28:18 +0530

ActionController::RoutingError (uninitialized constant CommonClient::SessionController):
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/inflector/methods.rb:230:in `block in constantize'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/inflector/methods.rb:229:in `each'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/inflector/methods.rb:229:in `constantize'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:69:in `controller_reference'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:54:in `controller'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:32:in `call'
  vendor/bundles/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'
  vendor/bundles/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'
  vendor/bundles/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:601:in `call'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/engine.rb:479:in `call'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/railtie/configurable.rb:30:in `method_missing'
  vendor/bundles/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'
  vendor/bundles/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'
  vendor/bundles/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:601:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/conditionalget.rb:25:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/head.rb:14:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/flash.rb:242:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/cookies.rb:341:in `call'
  vendor/bundles/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/query_cache.rb:64:in `call'
  vendor/bundles/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `_run__4296103602150594596__call__1936882885794917979__callbacks'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `__run_callback'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:81:in `run_callbacks'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/rack/logger.rb:32:in `call_app'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/rack/logger.rb:16:in `block in call'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/tagged_logging.rb:22:in `tagged'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/rack/logger.rb:16:in `call'
  vendor/bundles/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/request_id.rb:22:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
  vendor/bundles/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
  vendor/bundles/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
  vendor/bundles/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'
  vendor/bundles/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'
  vendor/bundles/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/engine.rb:479:in `call'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/application.rb:223:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
  vendor/bundles/ruby/1.9.1/gems/railties-3.2.9/lib/rails/rack/log_tailer.rb:17:in `call'
  vendor/bundles/ruby/1.9.1/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
  /home/gaurish/.rvm/rubies/ruby-1.9.3-p286-perf/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  /home/gaurish/.rvm/rubies/ruby-1.9.3-p286-perf/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  /home/gaurish/.rvm/rubies/ruby-1.9.3-p286-perf/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'

^C[2012-12-09 03:42:57] INFO  going to shutdown ...
[2012-12-09 03:42:57] INFO  WEBrick::HTTPServer#start done.
Exiting 
```

Now, here is the interesting part. These errors goes away in production & app works just fine when I disable code caching in `production.rb`. by setting

```
config.cache_classes = false 
```

All this makes me wonder,

1.  why rails can `CommonClient::SessionController` in development env but not in production env?
2.  How does setting `config.cache_classes = false` makes it work in production? And rails can find `CommonClient::SessionController` which it was not able to do earlier
3.  What I need to do when so that rails finds `CommonClient::SessionController` other than ugly hack of disabling code cache & reloading all code on each request?

Lastly, I have tried to explain as best I could but still something is not clear or more information is required. Please leave a comment. Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T12:41:07.307

I suspect this has to do with load order. In development mode (when cache_classes is false), Rails will load up all your unloadable classes on every request. This happens *after* the rest of the framework has been initialized.

By comparison, in production mode, everything is loaded up in one shot, so it's possible that your CommonClient is being loaded before some other piece of the Rails stack, and then getting hidden by the Rails load. Valery's suggestion about the ActiveSupport hooks is a good one - what does the CommonClient railtie look like? You may be able to modify your gem's railtie to load your controllers after ActionController loads, which should provide behavior much more similar to Rails' development-mode load behavior.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T16:13:37.257

Try update routes.rb like:

```
require 'common_client'
mount CommonClient::Engine => '/shared' 
```

# c++ - 特征：通过引用访问矩阵的列

> ID：13782926
> 
> 赞同：1
> 
> 时间：2012-12-08T23:13:58.220
> 
> 标签：c++, eigen

我正在使用 Eigen C++ 矩阵库，我想获得对矩阵列的引用。文档说要使用 matrix_object.col(index)，但这似乎是返回一个表示列的对象，而不是简单地引用原始矩阵对象中的列。我担心这涉及不必要地复制该列中的元素，因为更改列对象中的值不会影响原始矩阵。

如果有人比我更熟悉 Eigen，那么使用此函数访问矩阵的列是否仍然有效？如果没有，我怎样才能获得对矩阵内原始列的引用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T08:03:29.970

mat.col(i) 返回一个引用 mat 的 i 列的轻量级读写代理对象。根本没有副本。所以你可以这样做：

```
mat.col(i)(j) = 2; 
```

相当于 mat(j,i)=2; 你也可以这样做：

```
mat.col(i).swap(mat.col(j)); 
```

没有任何额外的副本。也许在您的代码中，您显式（或隐式）将代理列对象复制到 Vector 对象中？像这样：

```
VectorXd col_of_mat = mat.col(j); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T23:52:34.893

首先，这显然只适用于列主矩阵。这是 Eigen 的默认设置，但是当您依赖它时，您应该明确说明它。

然后，为了确定没有额外的代理对象成本，您可以使用`data()`获取指向整个矩阵存储的普通指针，并将其增加适当的数量。例如，要访问矩阵`j`中的第 th 列，`n×n``m`

```
auto jth_column = m.data() + n*j; 
```

[http://eigen.tuxfamily.org/dox/TopicStorageOrders.html](http://eigen.tuxfamily.org/dox/TopicStorageOrders.html)

# video - 循环嵌入式 youtube 播放器

> ID：13782928
> 
> 赞同：1
> 
> 时间：2012-12-08T23:14:27.520
> 
> 标签：video, youtube, embed

我想循环播放甚至停止嵌入的 youtube 视频，但它似乎不起作用。目前，其他视频在该视频之后播放，我正试图阻止这种情况。谁能看到我做错了什么？

```
<iframe width="450" height="253" src="http://www.youtube.com/embed/gNWKnkxbCOA?rel=0&autoplay=1&loop=1&playlist=gNWKnkxbCOA" frameborder="0" allowfullscreen></iframe> 
```

# c++ - C++ 两个 n 大小的整数列表

> ID：13782932
> 
> 赞同：1
> 
> 时间：2012-12-08T23:14:46.940
> 
> 标签：c++, list, integer, compare

我是 C++ 新手，我需要一些帮助来创建这个程序：我需要询问列表的大小，然后获取包含整数的列表，然后询问第二个列表的大小并获取这些整数。

到目前为止，我有这个：

```
#include <iostream>
using namespace std;
int main()

{
long int ARR[10];
int i,n;

printf("List 1 size: ");
scanf("%d",&n);

printf("List 1 data: ");
for(i=0;i<n;i++)
{
    scanf("%ld",&ARR[i]);

} 
```

所以这将作为第一个列表的输入。现在我将在第二个列表中重复这一点。但关键是我现在需要比较这两个列表。如果 list1 在 list2 中，那么我说是，或者如果不是，那么不。

我该如何比较这两个列表？我在输入的正确轨道上吗？

谢谢，

空和平

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:34:48.660

我认为您应该使用动态数组或 stl 的向量来存储数据。

例如，动态。大批：

```
int size;
scanf("%d", size);
int *tab = new int[size];
...
delete[] tab; 
```

或矢量方式：

```
#include <vector>
...
int size;
scanf("%d", size);
vector <int> tab(size);
// to insert an element, use tab.push_back( number );
// and getting an element goes array-way, for example tab[0]; 
```

还有我的话——如果你用 C++ 编写，请使用 cin 和 cout 进行输入/输出，除非你需要额外的速度或特定的格式。请记住，该[列表](http://en.wikipedia.org/wiki/List_%28abstract_data_type)与数组/向量不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:58:14.533

我想这就是你所期望的。

```
#include <iostream>
#include <algorithm>
#include <vector>
#include <utility>

using namespace std;

bool mypredicate (int i, int j) {
  return (i==j);
}

int main(){
    int size_list = 0;
    vector<int> list1, list2;

    cin >> size_list;

    list1.resize(size_list);
    list2.resize(size_list);

    cout << list1.size() << endl;

    for (int i = 0; i < size_list; i++)
        cin >> list1[i];

    for (int i = 0; i < size_list; i++)
        cin >> list2[i];

    pair<vector<int>::iterator,vector<int>::iterator> mypair;
    mypair = mismatch (list1.begin(), list1.end(), list2.begin(), mypredicate);

    if( mypair.first == list1.end() && mypair.second == list2.end() )
        cout << "are equals" << endl;
    else{
        cout << "aren't " << endl;
        cout << *mypair.first << ", " << *mypair.second << endl;
    }

    system("pause");
    return 0;
} 
```

# jsp - 部署错误：未授权访问 Tomcat 服务器。使用“manager-script”角色设置正确的用户名和密码

> ID：13782935
> 
> 赞同：1
> 
> 时间：2012-12-08T23:15:02.027
> 
> 标签：jsp

我正在使用 Apache Tomcat 服务器我正在运行 JSP 文件并得到部署错误。

我按照链接（[未授权访问 Tomcat 服务器](https://stackoverflow.com/questions/10241539/access-to-tomcat-server-has-not-been-authorized)）更改 tomcat-users.xml 文件。

我的问题是如何编辑 XML 文件并更新同名？我真的需要帮助来解决这个问题..

谢谢，

路，甘尼什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-11-12T17:15:34.993

尝试在这些部分中检查您的 tomcat.user-xml 文件中的注释字符

```
 <tomcat-users>
        <role rolename="manager"/>
        <role rolename="standard"/>
        <user username="admin" password="pwd" roles="standard,manager"/>
     </tomcat-users>
```

# php - PHP中的随机访问文件

> ID：13782937
> 
> 赞同：1
> 
> 时间：2012-12-08T23:15:17.703
> 
> 标签：php, file, random-access

是否有一些 PHP 函数或类可以让我像读取字符数组一样读取文件？

例如：

```
$string = str_split('blabla');

$i = 0;

switch($string[$i]){

  case 'x':
    do_something();
    $i++;

  case 'y':
    if(isset($string[++$i]))
      do_something_else();
    else
      break;

   case 'z':
      // recursive call of this code etc..

} 
```

我知道我可以使用`$string = file_get_contents($file)`，但问题是我获得了大量内存用于一个很小的 ​​800K 文件（如 80MB）。

那么，我能否以某种方式在上面的代码中“流式传输”文件，使用某种数组访问，例如当我调用 isset() 时自动从文件中读取数据的类？:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T23:18:02.710

您可以使用[`fseek`](http://php.net/manual/en/function.fseek.php)and[`fgetc`](http://php.net/manual/en/function.fgetc.php)在文件中跳转并一次读取单个字符。

```
// Leaves the file handle modified
function get_char($file, $char) {
   fseek($file, $char);
   return fgetc($file);
} 
```

你提到你特别想要数组行为。您可以构建一个实现[`ArrayAccess`](http://php.net/manual/en/class.arrayaccess.php)支持这一点的类。

由于以下几个原因，这可能很危险：

*   您需要防止`$char`请求索引超过文件长度的输入
*   文件句柄将不断变化（应该没问题，只要你不在其他地方使用它）
*   这可能效率低下（通过缓存过去的请求来抵消）

* * *

一个稍微更有效的替代方法是“懒惰地”读取文件（即，以块的形式而不是一次全部读取）。这是一些（未经测试的）代码：

```
class BufferedReader {
    // The size of a chunk in bytes
    const BUFFER_SIZE = 512;

    protected $file;
    protected $data;

    function __construct($fname) {
        $this->file = fopen($fname, 'r');
    }

    function read_buffer() {
        $this->data .= fread($this->file, self::BUFFER_SIZE);
    }

    function get_char($char) {
        while ( $char >= strlen($this->data) && !feof($this->file) ) {
            $this->read_buffer();
        }

        if ( $char >= strlen($this->data) ) {
            return FALSE;
        }

        return substr($this->data, $char, 1);
    }
} 
```

# javascript - 重定向jQuery

> ID：13782939
> 
> 赞同：1
> 
> 时间：2012-12-08T23:15:24.993
> 
> 标签：javascript, jquery, html

我做了这个代码： **文件 index.php**

```
<html>
<head>
<title>Jeu de dammes</title>
</head>
<style>
form { margin-left:500px;margin-top:300px;  width:300px }
  </style>
<body>
<form id="formulaire" style="margin-left:100px, padding: 15px" >
<table>
<tr><td><h4> The first player</h4></td>
    <td><input   type="text"   id="premier"></td>
</tr>
<tr><td><h4> The second player</h4></td>
    <td><input   type="text"   id="deuxieme"></td>
</tr>
<tr>
<td></td>
<td>
<button   id="action">Play</button></td>
</tr>
</table>
</form>
<script   src="jquery-1.5.1.js"></script>
<script>

    $(function () {

        $('#action').click(function () {

            var j1= $('#premier').val();
            var j2= $('#deuxieme').val();

            if( j1=="") alert('saisir le nom du premier joueur');
            if( j2=="") alert('saisir le nom du deuxieme joueur');
            if(j2!="" && j1!="") {$(location).attr('href',"http://www.google.com");}
        });

    $('body').css('background-image', 'url(flower2.jpg)').css('background-size', '100%');
    $("#formulaire").css('background-image', 'url(flower.jpg)');
    });
</script>
</body>
</html> 
```

我的问题是如果单击重定向到“www.google.com”不起作用。任何建议：

1.  这个错误的原因是什么？
2.  我该如何纠正？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:16:53.013

没有必要使用 jQuery 来做 vanilla JavaScript 已经做的事情：

```
window.location.href = "http://www.google.com/"; 
```

它不起作用可能是因为您正在使用表单并且在您可以重定向之前提交。抓住`submit`事件：

将您的代码更改为此，它将起作用：

```
$('#formulaire').submit(function(e) {
    var j1 = $('#premier').val();
    var j2 = $('#deuxieme').val();

    if (j1 == "") {
        alert('saisir le nom du premier joueur');
    }

    if (j2 == "") {
        alert('saisir le nom du deuxieme joueur');
    }

    if (j2 && j1) {
        window.location.href = "http://www.google.com";
    }

    e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:17:03.460

要重定向，您只需更改`location`全局变量：

```
location = "http://www.google.com" 
```

您所做的不起作用，因为您通常只是将选择器或回调传递给 jQuery 函数`$(...)`（例如`$("#something a")`.）`location`，这是 JavaScript 提供的全局变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T23:24:08.740

更换你的

```
$(location).attr('href',"http://www.google.com"); 
```

使用纯 Javascript

```
window.location = "http://www.google.com" 
```

**编辑：**

好吧，我的错，还有一个额外的问题，你不是在表单有问题的时候返回false，也不是在你做重定向的时候，所以表单的默认动作（POST）打破了之前的导航window.location

稍微清理一下代码并为字段添加焦点，当您打开页面时，当其中一个字段未填写时，刚刚在[http://fiddle.jshell.net/P3zbb/show/light/发布了一个演示](http://fiddle.jshell.net/P3zbb/show/light/)

[你可以在http://jsfiddle.net/P3zbb/](http://jsfiddle.net/P3zbb/)看到代码模组

# iphone - Admob 和 addSubview：

> ID：13782940
> 
> 赞同：0
> 
> 时间：2012-12-08T23:15:56.130
> 
> 标签：iphone, admob, addsubview, adbannerview

我刚刚从 admob 更新了文件，现在使用 [bannerView_ addSubview:closeBtn]; 我再也看不到按钮了..有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T18:15:07.393

你能试试：

```
[bannerView_ bringSubviewToFront:closeBtn]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T10:37:03.653

这是代码`AdMob`，

在`.h`

```
#import "GADBannerView.h" 
```

并声明

```
GADBannerView *AdMob; 
```

在`.m`

```
#define AdMob_ID @"yourAdMobId" 
```

然后只需调用此方法并提供您的 x 和 y

```
-(void)adMobCode
{

    AdMob = [[GADBannerView alloc]
             initWithFrame:CGRectMake(0.0,410,
                                      GAD_SIZE_320x50 .width,
                                      GAD_SIZE_320x50.height)];

    AdMob.adUnitID = AdMob_ID;
    AdMob.rootViewController = self;
    [self.view addSubview:AdMob];

    UIButton *Yourbtn = [[UIButton alloc]initWithFrame:CGRectMake(0, AdMob.frame.origin.y, 30, 30)];
    Yourbtn.tag=2;
    [Yourbtn addTarget:self action:@selector(YourbtnPress:) forControlEvents:UIControlEventTouchDown];
    UIImage *PlayBtnImage = [UIImage imageNamed:@"play.png"];
    [Yourbtn setImage:PlayBtnImage forState:UIControlStateNormal];
    [self.view addSubview:Yourbtn];

    GADRequest *r = [[GADRequest alloc] init];
    r.testing = YES;
    [AdMob loadRequest:r];
} 
```

# r - 如何调整 NumericVector 的大小？

> ID：13782943
> 
> 赞同：14
> 
> 时间：2012-12-08T23:16:00.033
> 
> 标签：r, rcpp

如何在 Rcpp a 中调整大小`NumericVector`？

当我为此使用该`push_back`功能时，程序会变慢。但是没有`.resize()`or`.reserve()`功能。（当我已经有了`NumericVector`所需大小的 a 时，我可以使用复制构造函数来获得 . 的正确大小`NumericVector`。在这种情况下，这比使用 快得多`push_back`）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-08T23:28:16.093

如果您更喜欢 C++ 习惯用法，`std::vector<double>`请在最后使用并返回它，它将通过隐式转换`wrap()`为 R 向量。您还可以通过 RcppArmadillo 和 RcppEigen 使用 Armadillo 或 Eigen 向量。

我们的对象是 R 对象的浅层包装器，以此类推`push_back`，a`Rcp::NumericVector`总是需要完整的副本。这是已知的并记录在案的。

*编辑：*所以为了完整起见，这里是一个使用 RcppArmadillo 的例子：

```
// [[Rcpp::depends(RcppArmadillo)]]
#include <RcppArmadillo.h>

// [[Rcpp::export]]
arma::vec shrink(arma::vec x) {
    arma::vec y = x;
    y.resize( y.size()-2 );
    return y;
} 
```

我们可以通过

```
R> Rcpp::sourceCpp('/tmp/vec.cpp')
R> shrink(1:10)
     [,1]
[1,]    1
[2,]    2
[3,]    3
[4,]    4
[5,]    5
[6,]    6
[7,]    7
[8,]    8
R> 
```

# java - 如何在工具栏和菜单中获取对 Eclipse 操作的引用并切换其启用/禁用状态？

> ID：13782944
> 
> 赞同：1
> 
> 时间：2012-12-08T23:16:01.813
> 
> 标签：java, eclipse, swt, eclipse-rcp, jface

我已经使用`ui.actionSets`我的 rcp 应用程序贡献了操作。根据应用程序中的状态更改，我需要能够获取对特定操作的引用并启用或禁用其状态。我知道在扩展点中您可以设置初始值，但我需要能够在运行时执行此操作，并且可以在`WorkbenchUI`. 任何帮助，将不胜感激。- 邓肯

# jquery - jqerymobile listview item onclick

> ID：13782947
> 
> 赞同：0
> 
> 时间：2012-12-08T23:16:33.153
> 
> 标签：jquery, listview, jquery-mobile

我有一个这样的 jquerymobile 列表视图：

```
<ul data-role="listview">
    <li onclick="accionesDocumento('action li','none')"> <a onclick="accionesDocumento('action a-onclick','none')">Pruebas</a></li>
</ul> 
```

和这个 jscript 函数

```
function accionesDocumento(tclink,tcAccion) {
    alert(tclink);
} 
```

我的问题是 onclick 事件永远不会触发。一些想法？

注意：你可以看到这个 jsfiddle [http://jsfiddle.net/9386M/8/](http://jsfiddle.net/9386M/8/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:22:46.050

试试这个[jsfiddle](http://jsfiddle.net/9386M/20/)

```
<script>
  function accionesDocumento(tclink,tcAccion) {
    alert(tclink);
  }
</script>    

<ul data-role="listview">
  <li><a href="javascript:accionesDocumento('Hola','mundo')">Pruebas</a></li>
</ul> 
```

完整的例子

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Test</title>
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
  <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head>

<body>
  <div data-role="page" id="page">
    <div data-role="content">
      <ul data-role="listview">
        <li><a href="javascript:accionesDocumento('Hola','mundo')">Pruebas</a></li>
      </ul>
    </div><!-- /content -->

    <script>
    function accionesDocumento(tclink,tcAccion) {
      alert(tclink);
    }
    </script>
  </div><!-- /page -->
</body>
</html> 
```

# asp.net-mvc - ASP.Net Web Api 序列化异常

> ID：13782948
> 
> 赞同：1
> 
> 时间：2012-12-08T23:16:33.490
> 
> 标签：asp.net-mvc, entity-framework, asp.net-web-api

在 Web Api 项目中，当我输入 url *localhost:[portnumber]/api/os*时，我得到包含错误的长 XML 文件，这里是异常消息：

预计不会键入“System.Data.Entity.DynamicProxies.CollegeCourse_C7F37B1980970AF17607E96F17DFE50E3A680141BF8228EEA7D39A9150498388”数据合同名称“//schemas.datacontract.org/2004/07/System.Data.Entity.DynamicProxies CollegeCourse_C7F37B1980970AF17607E96F17DFE50E3A680141BF8228EEA7D39A9150498388：HTTP”。考虑使用 DataContractResolver 或将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。

但是当我输入 url localhost: *[portnumber]/api/role*一切都很好，这里是代码：

操作系统：

```
public class UserOS
{
    [Key]
    [HiddenInput(DisplayValue = false)]
    public int UserOSId { get; set; }

    public Guid UserId { get; set; }

    public string OSType { get; set; }

    [ForeignKey("UserId")]
    public virtual User User { get; set; }
} 
```

角色：

```
public class UserRole
{
    [Key]
    [HiddenInput(DisplayValue = false)]
    public int RoleId { get; set; }

    public string Name { get; set; }

    public ICollection<User> Users { get; set; }

} 
```

Role 和 OS 的 API 控制器是相似的，所以我将仅粘贴 Role：

```
 private CompeteDataBase _competeDataBase = new CompeteDataBase();

   public IEnumerable<UserRole> GetAllRoles()
   {
       return _competeDataBase.UserRoles.AsEnumerable();
   } 
```

**编辑**

使用 DTO 的方法是否正确？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T00:17:11.700

这是因为 EntityFramework 为您的班级创建了一个“代理”。

要完成这项工作，只需禁用代理创建。您可以进入 Context 构造函数并添加以下内容：

```
ContextOptions.ProxyCreationEnabled = false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:34:25.673

不知何故我设法解决了问题，我不知道如何或为什么但删除数据库并再次装箱解决了一切（我没有改变任何其他东西）

有谁可能知道为什么？？？

# xquery - xQuery - 计数功能

> ID：13782949
> 
> 赞同：7
> 
> 时间：2012-12-08T23:16:33.833
> 
> 标签：xquery

我希望形成一个 xQuery，如果该类别包含超过 x 数量的书籍，它会返回书籍的类别。例如，如果我有 4 个类别；音乐、电影、教育、健康，他们都有 1 本书，除了有 3 本书的音乐，我希望列出该类别。我尝试了一系列查询，但似乎无法正确处理，我每次都没有得到任何结果，我相信我需要在某个时候使用 distinct-value？不太确定。

源代码示例如下所示，我在不将源代码保存为文件的编辑器中测试查询，因此我测试 xQuery 必须从以下内容开始：

例如 /bookstore/book 中的 $x...

```
<bookstore>        
<book category="Music">
            <year>  2005  </year>
            <price>  50  </price>
        </book>
    <book category="Music">
            <year>  2010  </year>
            <price>  35  </price>
        </book>
    <book category="Music">
            <year>  1982  </year>
            <price>  70  </price>
        </book>
    <book category="Film">
            <year>  2000  </year>
            <price>  10  </price>
        </book>
    <book category="Health">
            <year>  1965  </year>
            <price>  50  </price>
        </book>
    <book category="Education">
            <year>  2012  </year>
            <price>  70  </price>
        </book>
</bookstore> 
```

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T23:27:34.443

类似于@koopajah 的回答，因为我已经写过了，所以我会提交它......

```
for $category in distinct-values(/*/book/@category)
where count(/*/book[@category=$category]) >= 3
return
    <results>{$category}</results> 
```

使用外部文档...

```
let $doc := doc('input.xml')

for $category in distinct-values($doc/*/book/@category)
where count($doc/*/book[@category=$category]) >= 3
return
    <results>{$category}</results> 
```

从评论修改 xquery...

```
for $x in doc('input.xml')/bookstore 
for $y in distinct-values($x/book/@category) 
where count($x/book[@category=$y]) >= 3 
return $y 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T04:12:22.507

**使用这个 XQuery，它也是一个纯 XPath 2.0 表达式。注意`distinct-values()`不使用**：

```
(/*/*/@category)[index-of(/*/*/@category, .)[3]]/string() 
```

**在提供的 XML 文档上进行评估时**：

```
<bookstore>
    <book category="Music">
        <year>  2005  </year>
        <price>  50  </price>
    </book>
    <book category="Music">
        <year>  2010  </year>
        <price>  35  </price>
    </book>
    <book category="Music">
        <year>  1982  </year>
        <price>  70  </price>
    </book>
    <book category="Film">
        <year>  2000  </year>
        <price>  10  </price>
    </book>
    <book category="Health">
        <year>  1965  </year>
        <price>  50  </price>
    </book>
    <book category="Education">
        <year>  2012  </year>
        <price>  70  </price>
    </book>
</bookstore> 
```

**产生了想要的正确结果**：

```
Music 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T23:24:22.747

我刚刚在 BaseX 数据库中尝试过这个查询，它似乎可以按您的预期工作：

```
for $cat in distinct-values(/bookstore/book/@category)
let $nbBook := count(/bookstore/book[@category=$cat])
return if($nbBook > 1) then $cat else '' 
```

# hibernate - Hibernate 一对多映射与多方面的复合键

> ID：13782952
> 
> 赞同：2
> 
> 时间：2012-12-08T23:16:45.410
> 
> 标签：hibernate, one-to-many, composite-key

我在 Hibernate 映射方面面临以下问题 - 花了很多时间进行研究，但没有找到类似的案例。让我描述一下我们正在处理的简单数据库模式。

```
create table point(
POINT_ID integer primary key,
x integer,
y integer);

create table segment(
POINT_A_ID integer references point(POINT_ID),
POINT_B_ID integer references point(POINT_ID),
constraint segment_PK primary key(POINT_A_ID,POINT_B_ID)
); 
```

如您所见，Segment 只是两点之间的一条线，由一对 (POINT_A_ID, POINT_B_ID) 标识。我只想从 Point 一侧映射此关联。我发现我应该有两个集合，例如私有 Set segmentsA、segmentsB；

这是我的 xml 映射文件：

```
<hibernate-mapping>
 <class name="entities.model.Point" table="POINT">
    <id name="id" type="java.lang.Long">
        <column name="POINT_ID" />
        <generator class="native" />
    </id>
    <property name="x" type="int">
        <column name="X" />
    </property>
    <property name="y" type="int">
        <column name="Y" />
    </property>
    <set name="segmentsA" table="SEGMENT" lazy="false" cascade="all-delete-orphan" >
        <key column="POINT_A_ID" not-null="true" update="false" />
        <one-to-many class="entities.model.Segment"/>
    </set>
    <set name="segmentsB" table="SEGMENT" lazy="false" cascade="all-delete-orphan">
        <key column="POINT_B_ID" not-null="true" update="false" />
        <one-to-many class="entities.model.Segment" />
    </set>
 </class>
</hibernate-mapping> 
```

和

```
<hibernate-mapping>
<class name="entities.model.Segment" table="SEGMENT">
    <composite-id name="segmentPK" class="entities.model.SegmentPK">
        <key-property name="pointAId" >
            <column name="POINT_A_ID" />
        </key-property>
        <key-property name="pointBId"> 
            <column name="POINT_B_ID"/>
        </key-property>
    </composite-id>
</class>
</hibernate-mapping> 
```

当我尝试在它们之间保留一些点和线段时（已将一个 Segment 实例添加到 SegmentA 和 SegmentB 适当的 Point 实例集），我收到以下错误： `org.hibernate.MappingException: Repeated column in mapping for entity: entities.model.Segment column: POINT_A_ID (should be mapped with insert="false" update="false")`

我将非常感谢您对此案的建议:)

# arrays - 当列数不同时使用 awk 创建数组

> ID：13782956
> 
> 赞同：0
> 
> 时间：2012-12-08T23:16:54.620
> 
> 标签：arrays, awk

我有逗号分隔的数据，例如：

```
WP, 2012120100, 30, 989, 50, 1050, 50, 50, 1007
WP, 2012120106, 35, 987, 45, 1045, 50, 50, 1006
WP, 2012120112, 40, 985, 
WP, 2012120118, 50, 980, 55, 1065, 65, 60, 1008 
```

我想把每一列变成一个数组，比如：

```
set -A col2 `awk -F, {print $2} myfile` 
```

--> 这工作正常，产生数组值

```
2012120100, 2012120106, 2012120112, 2012120118 
```

但是，如果我这样做：

```
set -A col5 `awk -F, {print $5} myfile` 
```

数组“col5”的值是 50、45、55。我需要为任何缺失的列保留空白或空值，这样数组“col5”将为 50、45、.55，否则我的数组不再排列.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:27:28.093

您调用 awk 的语言是什么？这是 UNIX 中的 bash：

```
$ col5="$(awk -F, '{print $5}' myfile)"
$ echo "${col5[@]}"
 50
 45

 55 
```

# java - 无法使用 Windows-64 位连接到 MS Access DB

> ID：13782957
> 
> 赞同：1
> 
> 时间：2012-12-08T23:16:58.600
> 
> 标签：java, odbc

> **可能重复：**
> [Microsoft Access 和 Java JDBC-ODBC 错误](https://stackoverflow.com/questions/13776320/microsoft-access-and-java-jdbc-odbc-error)

一开始我在创建数据库时遇到了问题。我有一个 64 位版本的 Windows 7，发现错误是 Microsoft Office 是 32 位的。我能够使用 c:\Windows\sysWOW64\odbcad32.exe 中的 odbcad32.exe 创建我的 Access 数据库

现在，在我的 Java 代码中，我只是想建立连接，但又遇到了似乎相关的问题，这让我觉得最多只是没有正确设置数据库。JavaDB 是我在 ODBC:DSA 中创建的数据源的名称，您可以在此处看到：http: [//i.imgur.com/9n19x.png](https://i.imgur.com/9n19x.png)

我一直在互联网上搜索，但无法真正找到可靠的明确答案。真的可以使用帮助，在此先感谢！

编辑：我清理了我的代码，现在我的错误不同了。我在 C:\Eclipse\project1\src 的项目文件夹中有我的物理数据库文件 - 我已经设置它，就像我在 ODBC 中所说的一样。

编辑 编辑：好吧，经过数小时的研究，我最终还是弄明白了。问题不在于我的代码，而是与 Office 中的 Windows x64BIT 和 32 位驱动程序的兼容性问题。这篇文章帮助我修复了它，现在它可以工作了！[http://www.selikoff.net/2011/07/26/connecting-to-ms-access-file-via-jdbc-in-64-bit-java/](http://www.selikoff.net/2011/07/26/connecting-to-ms-access-file-via-jdbc-in-64-bit-java/)

```
import java.sql.*;

public class DBTester {

public static void main(String[] args) throws SQLException, ClassNotFoundException {

try 
{

    Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");

    String fileName = "C:/Eclipse/school/bin/RegistrationDB.mdb";

    String dB = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ="+fileName;
    Connection connection = DriverManager.getConnection(dB,"","");

    System.out.println("connected");

    Statement s = connection.createStatement();
    s.close();
    connection.close();

} catch(Exception ex)
{

    ex.printStackTrace();

}

} // end main

} // end class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:56:41.407

经过大量研究并看到与我在这里和其他地方相关的大量未回答的问题后，我偶然发现了一篇文章，其中有一个简单的修复，让我想把头撞到我的桌子上。

[http://www.selikoff.net/2011/07/26/connecting-to-ms-access-file-via-jdbc-in-64-bit-java/](http://www.selikoff.net/2011/07/26/connecting-to-ms-access-file-via-jdbc-in-64-bit-java/)

如果您有 64 位 Windows 7 机器和 32 位版本的 Access - 您将会遇到问题。从这篇文章中，我能够卸载我当前的 MS Access - 并重新安装 64 位版本。重新添加了我的数据库源，一切正常。

# jquery-mobile - Phonegap CORS 问题

> ID：13782959
> 
> 赞同：3
> 
> 时间：2012-12-08T23:17:01.627
> 
> 标签：jquery-mobile, cordova, cors

我正在尝试从 Phonegap 打开并读取 XML 文件，但出现此 CORS 错误。我该如何解决这个问题？

```
XMLHttpRequest cannot load file://localhost/../data/file.xml. Origin null is not allowed by Access-Control-Allow-Origin. 
```

调用者代码是：

```
var request = $.ajax({
    type: "GET",
    url: "data/file.xml",
    async: false,
    dataType: "xml"
  }); 
```

[由于这里](http://jquerymobile.com/test/docs/pages/phonegap.html)的解释，我的代码中也有这个片段：

```
$(document).on( "mobileinit", function() {

           $.support.cors = true;
           $.mobile.allowCrossDomainPages = true;

           }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:23:40.877

您需要修改 phonegap 设置以允许访问 localhost

有一些文件要查看，因此请参阅此[要点](https://gist.github.com/2873186)和其他[stackoverflow](https://stackoverflow.com/questions/10889278/using-phonegap-cant-load-local-html-file-using-ajax-on-android-only)帖子。

请注意，这些示例适用于 Android；与 iPhone 相同的问题，只是不同的文件。

# ruby - 我无法在 Sinatra 中发布数据

> ID：13782964
> 
> 赞同：2
> 
> 时间：2012-12-08T23:17:24.607
> 
> 标签：ruby, sinatra, http-post

我在做一些简单的事情时遇到问题，我不确定我是否做错了什么。我在 Windows 下使用最新版本的 Ruby 和 Sinatra（1.9.3 和 1.3.3）

我的主要代码是：

```
require 'sinatra'

get '/form' do
  erb :form
end

post '/form' do
    "Value: '#{params[:somevalue]}'"
end 
```

我的ERB：

```
<form action="/form" method="post">
    <input type="text" name"somevalue">
    <input type="submit">
</form> 
```

当我按下提交时，它不会显示值。它只会显示：`Value: ''`

我什至尝试使用纯 HTML（结果相同）。

这些是我的请求标头：

```
Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:es,en-US;q=0.8,en;q=0.6
Cache-Control:max-age=0
Connection:keep-alive
Content-Length:0
Content-Type:application/x-www-form-urlencoded
Host:localhost:4567
Origin:http://localhost:4567
Referer:http://localhost:4567/form
User-Agent:Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.11 (KHTML, like Gecko)       Chrome/23.0.1271.91 Safari/537.11 
```

我需要配置一些东西吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T23:32:14.997

你`=`在`name`你的`.erb`

添加后对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T23:32:22.920

```
<form action="/form" method="post">
    <input type="text" name="somevalue">
    <input type="submit">
</form> 
```

你错过了等号

# php - 使用隐藏表单强制下载不起作用

> ID：13782974
> 
> 赞同：2
> 
> 时间：2012-12-08T23:19:02.660
> 
> 标签：php, javascript, download, hidden-field

我正在尝试强制下载一个带有名为“证明”的 javascript 字符串的文件。我创建了一个隐藏的表单，它从 php 脚本触发一个动作。我不使用 window.location.href 的原因是变量 Proof 很长，get 方法无法处理它。

// 点击按钮保存

```
$("#save").click(function () {
    var Proof = $("#main").html();
    var url = '/download-to-file.php';
    //send request
    jQuery('<form action="'+ url +'" method="post">'+
    '<input type="hidden" name="Proof" value="'+ Proof +'" />'+
    '</form>').appendTo('body').submit().remove();

 }); 
```

php代码：

```
<?php
$Proof = $_POST["Proof"];
$proof = stripslashes($Proof);

$file = 'savedproof.txt';

file_put_contents($file, $proof);
header('Content-disposition: attachment; filename="'.$file.'"');
header("Content-Type: text/txt");
header("Content-Transfer-Encoding: binary");
header('Content-length: '.filesize($file));  
header('Accept-Ranges: bytes');
header('Content-Description: File Transfer');

readfile($file);
?> 
```

我得到一个下载对话框，但文件是空的。我什至尝试使用像“test”这样的较小字符串，但仍然是空的，所以我猜测隐藏表单的值不起作用。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T23:25:22.833

我想知道是否`file_put_contents`失败，但从技术上讲，不需要将数据写入文件，因为它已经在 $_POST 中。

尝试将代码更改为此，看看它是否有效：

```
<?php
$Proof = stripslashes($_POST["Proof"])

header('Content-disposition: attachment; filename="savedproof.txt"');
header("Content-Type: text/html; charset=utf-8");
header('Content-length: '.strlen($Proof));  
header('Accept-Ranges: bytes');
header('Content-Description: File Transfer');

echo $Proof; 
```

# asp.net - 在 VB 中更改项目的 CSS 样式

> ID：13782976
> 
> 赞同：1
> 
> 时间：2012-12-08T23:19:08.200
> 
> 标签：asp.net, css, vb.net, visual-studio-2010

看起来很简单，但我无法弄清楚。在 VB 代码中执行操作时，我需要更改 asp 标签的样式。我已经制作了样式，并且在 CSS 样式列表中，我只需要使标签样式等于我猜想的指定 CSS 样式。请让我知道如何做到这一点。

这是一个学校项目，说明指定必须在 VB 代码中更改样式。我正在使用 VS 2010。

在此先感谢，乔希

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:22:27.423

CSS：

`.MyClass {width:200px; background-color:red; color:blue;}`

HTML：

```
<asp:Label ID="Label1" runat="server"></asp:Label> 
```

代码隐藏：

```
Protected Sub SomeMethod()
 ' Some Code
 Label1.CssClass = "MyClass"
 ' Some Code
End Sub 
```

# python - django-social-auth redirect_uri 无效

> ID：13782979
> 
> 赞同：8
> 
> 时间：2012-12-08T23:19:24.403
> 
> 标签：python, django, django-socialauth

我一直在努力让 django-social-auth 正常工作。我的开发服务器是我工作中专用网络中的服务器，通过 10.0.0.* IP 地址访问。我们在这台服务器上运行了多个 django 应用程序。这是我对此应用程序的配置：

```
# Perceptual
location /perceptual/static/ {
        alias /opt/perceptual/perceptual/static/;
}
location /perceptual/ {
        proxy_pass http://127.0.0.1:8001;
} 
```

我正在用这个从我的静态目录中运行一个backbone.js 应用程序。所以，我可以去 10.0.0.54/perceptual/static/，获取我的主干应用程序。

**现在，**我的设置文件中有我的 Facebook APP_ID 和 FACEBOOK_API_SECRET，都已正确配置。我在我的*实际*机器（不是开发服务器）上的 /etc/hosts 文件中也有一行将**myapp.com**指向**10.0.0.54**，我的 Facebook 应用程序配置为 App Domains 和 Site URL 如下所示：

```
App Domains: perceptual.com
Site URL: http://perceptual.com 
```

问题是，每当我去 perceptual.com/perceptual/static/login/facebook/ 时，它都会给我这个错误： ![Facebook 错误 (django-social-auth)](../Images/ee5d18cb407e13abf97bae01e7e4f288.png)

这是我收到该错误时的 URL： [https ://www.facebook.com/dialog/oauth?scope=email&state=PC0OhXnEuaW2wcUuINO0rMSMAtVDuMbn&redirect_uri=http%3A%2F%2F127.0.0.1%3A8001%2Fperceptual%2Fcomplete% 2Ffacebook%2F%3Fredirect_state%3DPC0OhXnEuaW2wcUuINO0rMSMAtVDuMbn&client_id=419178148154217](https://www.facebook.com/dialog/oauth?scope=email&state=PC0OhXnEuaW2wcUuINO0rMSMAtVDuMbn&redirect_uri=http%3A%2F%2F127.0.0.1%3A8001%2Fperceptual%2Fcomplete%2Ffacebook%2F%3Fredirect_state%3DPC0OhXnEuaW2wcUuINO0rMSMAtVDuMbn&client_id=419178148154217)

所以你可以从 URL 中看到我的 redirect_uri 是`http://localhost:8001`- 但我不希望它是那样的，很明显。一旦我将其更改为 perceptual.com，它就会变得更远：然后我收到此错误：

```
AuthFailed at /perceptual/complete/facebook/
Authentication failed: There was an error authenticating the app 
```

这是我的[回溯，如果有帮助](http://pastebin.com/UVE6Eqft)

在这一点上，我被卡住了 - 如何让我的服务器将 redirect_uri 更改为 Facebook 可以处理的东西，而不是 127.0.0.1:8000？我的猜测是它来自 Django，但我不确定如何更改它。然后，一旦修复，它仍然无法完全验证，并得到上述错误。任何帮助将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-09T15:00:32.290

django-social-auth 用于`request.build_absolute_uri()`构建该`redirect_uri`参数。检查 django 代码[`build_absolute_uri()`](https://github.com/django/django/blob/master/django/http/request.py#L100)调用[`get_host()`](https://github.com/django/django/blob/master/django/http/request.py#L51)which 检查`HTTP_X_FORWARDED_HOST`,`HTTP_HOST`或`SERVER_NAME`.

尝试在您的位置配方中定义任何这些标题（我认为有一个`proxy_set_header`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-16T06:40:32.540

我没有评论的声誉。上面的讨论帮助我澄清了管理 nginx 标头以使 Django allauth 社交身份验证正确工作以解决重定向 URI 回调问题的问题。

但是，[在 github 上的讨论](https://github.com/pennersr/django-allauth/issues/85)中提出的解决方案对我来说效果更好。没有必要使用`USE_X_FORWARDED_HOST = True`.

```
location / {
proxy_set_header Host $http_host;
proxy_pass      http://localhost:8000;
} 
```

# jquery - 首先播放视频，然后使用 BigVideo.js 加载最后一个视频帧的海报

> ID：13782983
> 
> 赞同：1
> 
> 时间：2012-12-08T23:20:27.443
> 
> 标签：jquery, video

（这里是新手程序员）

我正在使用 BigVideo.js 在登录页面的背景中播放视频，并且试图让它在最后一帧结束，如何将海报图像设置为视频的最后一帧？这是在 bigvideo.js 或 video.js 中更改的设置吗？

```
 $(function() {
            var BV = new $.BigVideo();
            BV.init();
            if (Modernizr.touch) {
                BV.show('images/bg.png');
            } else {
                BV.show('vids/4.mov', {ambient:false});
            }
        }); 
```

# html - 文字不在同一位置

> ID：13782987
> 
> 赞同：1
> 
> 时间：2012-12-08T23:20:44.730
> 
> 标签：html, css

嘿，伙计们刚刚收到了一些文字，我想知道为什么在某些分辨率下，当我在浏览器中缩小和放大时不会停留在同一个地方。它主要发生在 Firefox 中。

```
 <div class = "hello">
            <p>Hello This is just an example of what should go in here. When   youi move down to the bottom you will see what you need 2 enter. .</p>
        </div> 
```

下面是我用来控制它的css。

```
.hello
{
position:absolute;
top: 210px;
width:37em;
text-wrap:none;
text-align: left;
font-size: 16px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T12:30:29.407

问题在于您的绝对最高定位。如果你使用这个 CSS：

```
 <style>
        .hello {position: absolute; width: auto;}
        .hello p {word-wrap:none; font-size:16px;}
    </style> 
```

您会注意到 DIV 保持在同一个位置，只是行距和字体大小增加了。如果您希望您的 DIV 保持在完全相同的位置，您将需要使用`position: fixed;`

也不`text-wrap:none;`是您应该使用的有效 CSS 参数`word-wrap:none;`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:35:12.013

当您放大或缩小（Ctrl + 或 Ctrl -）时，页面上的所有内容都会更改其大小。所以，不仅`font-size`变大了，`top`距离也变大了。

当用户在其浏览器首选项中更改默认字体大小时，可以实现您想要的行为。

使用 Ctrl + 和 Ctrl - 获得此行为的唯一方法是使用 JavaScript 捕捉浏览器的缩放并`top`正确修改距离。但是，我认为这不是一个好主意，因为 Ctrl + 和 Ctrl - 对于有一些视觉问题的人特别有用，并且它们是所有浏览器中的标准行为。

# java - 使用类处理错误输入

> ID：13782988
> 
> 赞同：1
> 
> 时间：2012-12-08T23:21:03.387
> 
> 标签：java

这是我为 Electronics 提供的一个构造函数，用于检查 State 输入是否有效。

```
public Electronics(String name, double price, int quantity, double weight, boolean frag, String s)
    {
        super("Electronics",name,price,quantity,weight);
        fragile=frag;
        s=s.toUpperCase();
        if(checkState(s)==true)
        {
            state=s;
        }
        else
        {
            out.println("ERROR - not a valid state abbreviation");
        }
    } 
```

但是在我的 中`main()`，我有这样的东西：

```
public List<Item> shoppingCart = new ArrayList<Item>();
temp= new Electronics(name,price,quantity,weight, fragile, state);
...
shoppingCart.add(temp); 
```

因此，即使状态缩写无效，（它只是打印出状态无效）但对象仍会添加到 ArrayList。如果州缩写不正确，我该怎么做才能停止添加？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:23:44.703

您应该[抛出一个异常](http://docs.oracle.com/javase/tutorial/essential/exceptions/)并在您的 Exception 中处理它`main()`，[IllegakArgumentException](http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html)可能是最适合这里的。

就像是：

```
 ...
    else
    {
        throw new IllegalArgumentException("...");
    }
    ... 
```

主要：

```
public List<Item> shoppingCart = new ArrayList<Item>();
try { 
   temp= new Electronics(name,price,quantity,weight, fragile, state);
   ...
   shoppingCart.add(temp);
} catch (IllegalArgumentException e) { 
  //handle exception
} 
```

请注意，如果构造函数将抛出异常，则程序将无法将元素插入到列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:25:33.067

你需要抛出一个异常。IllegalArgumentException 听起来很像。然后我会构造函数抛出一个异常不要将它添加到列表中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T03:28:15.113

您的构造函数仅用于初始化您的实例变量。有一个单独的方法类检查使其返回一个布尔变量。构造函数初始化您的实例变量：

```
public Electronics(String name, double price, int quantity, double weight, boolean frag, String s)
    {
        super("Electronics",name,price,quantity,weight);
        fragile=frag;
        s=s.toUpperCase();
    } 
```

检查对 checkState() 的调用是否返回 true 的方法：

```
public boolean check(){
if(checkState(s)==true)
        {
            state=s;
           return true;    
        }
        else
        {
            out.println("ERROR - not a valid state abbreviation");
            return false;
        }
} 
```

在主要方法中：

```
public List<Item> shoppingCart = new ArrayList<Item>();
temp= new Electronics(name,price,quantity,weight, fragile, state);
...
if(temp.check()){
shoppingCart.add(temp);
 }
 else {
  //check returned false
  } 
```

# paypal - 贝宝解决方案类型=唯一

> ID：13782989
> 
> 赞同：6
> 
> 时间：2012-12-08T23:21:19.803
> 
> 标签：paypal

我有一个网站可以引导我的客户使用贝宝快速结账。我想为客人提供付款选项，而无需创建贝宝帐户。我有 2 个变量可用于 paypal SetExpressCheckout API 调用，但无法确定将其放置在我的代码中的哪个位置。有人可以帮我弄这个吗？

变量和值：

SOLUTIONTYPE = 唯一的 LANDINGPAGE = 计费

编码：

```
<?php

/**
 * PayPal class
 */
class PayPal
{
    var $version = "64";

    /**
     * Wether or not use Sandbox mode
     */
    var $sandbox = false;

    /**
     * The API credentials
     */
    var $api_username;
    var $api_password;
    var $api_signature;

    /**
     * The API endpoint and the URL for non-sandbox integration
     */
    var $api_endpoint = 'https://api-3t.paypal.com/nvp';
    var $paypal_url = 'https://www.paypal.com/cgi-bin/webscr?cmd=_express-checkout&token=';

    /**
     * Proxy settings
     */
    var $use_proxy = false;
    var $proxy_host = '127.0.0.1';
    var $proxy_port = 808;

    /**
     * BN Code is only applicable for partners
     */
    var $bncode = "PP-ECWizard";

    /**
     * Some private keys
     */
    private $_token;
    private $_payerId;
    private $_currency = 'EUR';
    private $_paymentType = 'Sale';
    private $_resArray = array();

    /**
     * Constructor
     * @param string $api_username
     * @param string $api_password
     * @param string $api_signature
     */
    public function __construct($api_username, $api_password, $api_signature) {

        $this->api_username = $api_username;
        $this->api_password = $api_password;
        $this->api_signature = $api_signature;
    }

    /**
     * Set Sandbox status
     */
    public function useSandbox() {

        $this->sandbox = true;
        $this->api_endpoint = 'https://api-3t.sandbox.paypal.com/nvp';
        $this->paypal_url = 'https://www.sandbox.paypal.com/webscr?cmd=_express-checkout&token=';
    }

    /**
     * When using a proxy server, set the host and port
     * @param string $host
     * @param integer $port
     */
    public function useProxy($host, $port=808) {

        if(!empty($host) && !empty($port) && is_numeric($port)) {

            $this->use_proxy = true;
            $this->proxy_host = $host;
            $this->proxy_port = (integer) $port;
        }
    }

    /**
     * Sets a new BN ocde
     */
    public function setBNcode($bncode=null) {

        $this->bncode = $bncode;
    }

    /**
     * Sets the currency used for the order
     */
    public function setCurrency($currency='EUR') {

        $this->_currency = $currency;
    }

    /**
     * The type of payment is done here
     */
    public function setPaymentType($type='Sale') {

        $this->_paymentType = $type;
    }

    /**
     * An express checkout transaction starts with a token, that
     * identifies to PayPal your transaction
     * In this example, when the script sees a token, the script
     * knows that the buyer has already authorized payment through
     * paypal. If no token was found, the action is to send the buyer
     * to PayPal to first authorize payment
     * 
     * Prepares the parameters for the SetExpressCheckout API Call.
     * 
     * @param string $paymentAmount:        Total value of the shopping cart
     * @param string $returnURL:            the page where buyers return to after they are done with the payment review on PayPal
     * @param string $cancelURL:            the page where buyers return to when they cancel the payment review on PayPal
    */
    function shortcutExpressCheckout($paymentAmount, $returnURL, $cancelURL) 
    {
        // Construct the parameter string that describes the SetExpressCheckout API call in the shortcut implementation
        $nvpstr = '&PAYMENTREQUEST_0_AMT='. $paymentAmount;
        $nvpstr .= '&PAYMENTREQUEST_0_PAYMENTACTION='.$this->_paymentType;
        $nvpstr .= '&RETURNURL='.$returnURL;
        $nvpstr .= '&CANCELURL='.$cancelURL;
        $nvpstr .= '&PAYMENTREQUEST_0_CURRENCYCODE='.$this->_currency;

        // Make the API call to PayPal
        // If the API call succeded, then redirect the buyer to PayPal to begin to authorize payment.
        // If an error occured, show the resulting errors
        $resArray = $this->_hashCall('SetExpressCheckout', $nvpstr);
        $ack = strtoupper($resArray["ACK"]);

        if($ack == 'SUCCESS' || $ack == 'SUCCESSWITHWARNING') {
            $this->_token = urldecode($resArray["TOKEN"]);
        }
        else {
            throw new PayPal_Exception($resArray['L_ERRORCODE0'].': '.$resArray['L_SHORTMESSAGE0'].', '.$resArray['L_LONGMESSAGE0']);
        }

        // save result
        $this->_resArray = $resArray;
    }

    /**
     * Sets a token for confirm purposes
     * @param string $token
     */
    public function setToken($token) {

        if(!empty($token)) {

            $this->_token = $token;
        }
    }

    /**
     * Returns the token set for the current payment
     * @return string
     */
    public function getToken() {

        return $this->_token;
    }

    /**
     * Sets the payer id for confirm purposes
     * @param string $payerid
     */
    public function setPayer($payerid) {

        if(!empty($payerid)) {

            $this->_payerId = $payerid;
        }
    }

    /**
     * Returns the result array set for the current payment
     * @return array
     */
    public function getResult() {

        return $this->_resArray;
    }

    /**
     * Prepares the parameters for the GetExpressCheckoutDetails API Call.
     *
     * @param string $paymentAmount:    The total payment amount.
     * @return object The NVP Collection object of the GetExpressCheckoutDetails Call Response.
     */
    function confirm($paymentAmount)
    {
        // Format the other parameters that were stored in the session from the previous calls
        $serverName = urlencode($_SERVER['SERVER_NAME']);

        $nvpstr = '&TOKEN='.urlencode($this->_token);
        $nvpstr .= '&PAYERID='.urlencode($this->_payerId);
        $nvpstr .= '&PAYMENTREQUEST_0_PAYMENTACTION='.$this->_paymentType;
        $nvpstr .= '&PAYMENTREQUEST_0_AMT='.$paymentAmount;
        $nvpstr .= '&PAYMENTREQUEST_0_CURRENCYCODE='.$this->_currency;
        $nvpstr .= '&IPADDRESS='.$serverName; 

        // Make the call to PayPal to finalize payment
        // if an error occured, show the resulting errors
        $resArray = $this->_hashCall('DoExpressCheckoutPayment', $nvpstr);

        $this->_resArray = $resArray;
    }

    /**
     * Function to perform the API call to PayPal using API signature
     * @param string $methodName:   is name of API  method.
     * @param string $nvpStr:       is nvp string.
     * @return array containing the response from the server.
     */
    private function _hashCall($methodName, $nvpStr)
    {
        // setting the curl parameters.
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $this->api_endpoint);
        curl_setopt($ch, CURLOPT_VERBOSE, 1);

        // turning off the server and peer verification (TrustManager Concept).
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);

        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_POST, 1);

        // if use_proxy set to TRUE, then only proxy will be enabled. 
        if($this->use_proxy) {

            curl_setopt ($ch, CURLOPT_PROXY, $this->proxy_host.':'.$this->proxy_port); 
        }

        // NVPRequest for submitting to server
        $nvpreq = 'METHOD='.urlencode($methodName);
        $nvpreq .= '&VERSION='.urlencode($this->version);
        $nvpreq .= '&PWD='.urlencode($this->api_password);
        $nvpreq .= '&USER='.urlencode($this->api_username);
        $nvpreq .= '&SIGNATURE='.urlencode($this->api_signature);
        $nvpreq .= $nvpStr.'&BUTTONSOURCE='.urlencode($this->bncode);

        // setting the nvpreq as POST FIELD to curl
        curl_setopt($ch, CURLOPT_POSTFIELDS, $nvpreq);

        // getting response from server
        $response = curl_exec($ch);

        // convrting NVPResponse to an Associative Array
        $nvpResArray = $this->_deformatNVP($response);
        $nvpReqArray = $this->_deformatNVP($nvpreq);

        // Execute the Error handling module to display errors.
        if(curl_errno($ch)) {

            $error = curl_error($ch);
            throw new PayPal_Exception($error);
        } 
        // closing the curl
        else {

            curl_close($ch);
        }

        return $nvpResArray;
    }

    /**
     * This function will take NVPString and convert it to an Associative Array and it will decode the response.
     * It is usefull to search for a particular key and displaying arrays.
     * @param string $nvpstr is NVPString.
     * @return array $nvpArray is Associative Array.
     **/
    private function _deformatNVP($nvpstr)
    {
        $intial = 0;
        $nvpArray = array();

        while(strlen($nvpstr)) {
            // postion of Key
            $keypos = strpos($nvpstr, '=');

            // position of value
            $valuepos = strpos($nvpstr,'&') ? strpos($nvpstr, '&') : strlen($nvpstr);

            // getting the Key and Value values and storing in a Associative Array
            $keyval = substr($nvpstr, $intial, $keypos);
            $valval = substr($nvpstr, $keypos+1, $valuepos-$keypos-1);

            // decoding the respose
            $nvpArray[urldecode($keyval)] = urldecode($valval);
            $nvpstr = substr($nvpstr, $valuepos+1, strlen($nvpstr));
        }

        return $nvpArray;
    }

    /**
     * Redirects to PayPal.com site.
     */
    public function redirect() {

        $url = $this->paypal_url.$this->_token;
        header("Location: ".$url);
        exit();
    }
}

class PayPal_Exception extends Exception
{
    // Redefine the exception so message isn't optional
    public function __construct($message, $code = 0) {

        // make sure everything is assigned properly
        parent::__construct($message, $code);
    }

    // custom string representation of object
    public function __toString() {
        return __CLASS__ . ": [{$this->code}]: {$this->message}\n";
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T06:21:59.013

无论您使用的是什么类库，它对 Express Checkout 的作用似乎都非常有限。它基本上是使用最低限度的选项来使其工作。

您`shortcutExpressCheckout()`只接受 3 个参数： `$paymentAmount`、`$returnURL`和`$cancelURL`. 还有更多内容可以涉及，包括您尝试传递的选项。

在该函数中，他们生成 NVP 字符串并将其分配给 $nvpstr 变量。这是您需要添加新参数以获得所需效果的地方。

尝试这个...

```
// Construct the parameter string that describes the SetExpressCheckout API call in the shortcut implementation
$nvpstr = '&PAYMENTREQUEST_0_AMT='. $paymentAmount;
$nvpstr .= '&PAYMENTREQUEST_0_PAYMENTACTION='.$this->_paymentType;
$nvpstr .= '&RETURNURL='.$returnURL;
$nvpstr .= '&CANCELURL='.$cancelURL;
$nvpstr .= '&PAYMENTREQUEST_0_CURRENCYCODE='.$this->_currency;
$nvpstr .= '&SOLUTIONTYPE=Sole&LANDINGPAGE=Billing'; 
```

那应该为你做......我所做的只是将最后一行添加到这段代码中。

为了将来参考，您可能有兴趣查看我[的 PayPal PHP 类库](http://www.angelleye.com/overview-of-php-class-library-for-paypal/)。它比你正在使用的这个更完整，并且使用起来非常简单。

# python - 如何访问/保存 python 应用程序引擎应用程序的上次部署日期

> ID：13782995
> 
> 赞同：0
> 
> 时间：2012-12-08T23:21:59.637
> 
> 标签：python, google-app-engine, web-deployment

上次部署应用程序时如何以编程方式存储日期？您是否设置了在更新应用程序时运行的脚本，或者此信息是否存储在应用程序引擎 sdk 的某些元属性中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T03:31:01.153

不幸的是，似乎没有任何方法可以以编程方式访问最后的部署数据，而不是没有某种程度的干预。

*   可以获得[有关环境的信息](https://developers.google.com/appengine/docs/python/runtime#The_Environment)，其中包含正在运行的应用程序版本。
*   也可以[下载以前的版本](https://developers.google.com/appengine/docs/python/tools/uploadinganapp#Downloading_Source_Code)。

鉴于此信息，我的建议是执行以下操作：

1.  确保在部署应用程序时包含具有必要元数据的文件
2.  获取最新版本的应用程序
3.  解析元数据文件

不幸的是，这意味着下载整个应用程序，但似乎没有关于此问题的其他文档。虽然，知道您为什么需要这些信息可以更容易地回答您的问题。

# c - 如何将数据从 GHashTable 存储到 C 中的结构

> ID：13782997
> 
> 赞同：2
> 
> 时间：2012-12-08T23:22:47.050
> 
> 标签：c, struct, glib

我正在尝试遍历我的哈希表并将键和值存储到结构数组中。我不断收到段错误。我猜是由于基于指针的结构。

当我应该使用指向结构的指针和结构数组时，我仍然感到困惑。

编辑：让它工作。请参阅下面的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T05:21:08.267

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <glib.h>

typedef struct st { 
    char *key;
    char *str;
    int len;
} MyStruct;

int z = 0;
static void hash2struct (gpointer key, gpointer value, gpointer data) {
    MyStruct **s = data; 
    gchar *k = (gchar *) key;
    gchar *h = (gchar *) value;
    s[z]->key = strdup(k);
    s[z]->str =strdup(h);
    z++;
}

int main(int argc, char *argv[]){
    int i;

    GHashTable *hash = g_hash_table_new(g_str_hash, g_str_equal);

    g_hash_table_insert(hash, "Virginia", "Richmond");
    g_hash_table_insert(hash, "Texas", "Austin");
    g_hash_table_insert(hash, "Ohio", "Columbus");

    MyStruct **s = malloc(sizeof(MyStruct) * 3);
    for(i = 0; i < 3; i++) {
        s[i] = malloc(sizeof(MyStruct)); 
    }
    g_hash_table_foreach(hash, hash2struct, s); 

    for(i = 0; i < 3; i++)
        printf("%s %s\n", s[i]->str, s[i]->key);

    for(i = 0; i < 3; i++) {
        free(s[i]->str);
        free(s[i]->key);
        free(s[i]);
    }
    free(s);
    g_hash_table_destroy(hash);
    return 0;
} 
```