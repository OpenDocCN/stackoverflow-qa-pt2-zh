# StackOverflow 问答 15554000-15554999

# ruby-on-rails - Rails + MongoDB：如何找出当前记录的位置？

> ID：15554005
> 
> 赞同：0
> 
> 时间：2013-03-21T17:17:05.740
> 
> 标签：ruby-on-rails, ruby, mongodb, nosql

这是从 MongoDB 获取记录的查询：

```
Article.where({'_id' => { "$gt" => params[:id]}}).sort({:_id => 1}).first 
```

假设集合中有 10 条记录，这是第 8 条最新记录。我怎样才能从集合中的 10 条记录中发现这条记录位于第 8 位？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:44:43.367

你不能在 Mongo 中做这样的事情：ID 是随机生成的散列，不能保证像关系数据库 ID 一样是连续的。

我会改为按 created_at 排序，因为只要该字段存在，它就保证是连续的。考虑这样的事情：

```
article = Article.find(params[:id])
next = Article.where({"created_at" => {"$gt" => article.created_at}}).desc(:created_at).first 
```

# iphone - 从 NSObjects 动态生成 XML-String

> ID：15554013
> 
> 赞同：0
> 
> 时间：2013-03-21T17:17:19.947
> 
> 标签：iphone, objective-c, xml, xml-parsing, nsobject

我正在尝试使用一个或多个 NSObjects 的属性动态生成一个 XML-String。

我正在使用 WonderXML，但我不明白如何调整 WonderXML 生成的 XML 字符串的结构。

到目前为止，这是我的代码：

**目的：**

```
@interface Getraenke_Object : NSObject {    
@protected
    NSString *item_id;
    NSString *menge;
    NSString *categorie;

    NSString *name;
    NSString *preis;    
    NSString *image; 
}

@property (nonatomic, copy) NSString *item_id;
@property (nonatomic, copy) NSString *menge;
@property (nonatomic, copy) NSString *categorie;
@property (nonatomic, copy) NSString *name;
@property (nonatomic, copy) NSString *preis;
@property (nonatomic, copy) NSString *image;

@end 
```

**m-文件：**

```
//-----------------Converting the Objects to XML-Strings--------------

    XmlParser *parser = [[XmlParser alloc] init];
    NSString *meinXmlString;

    for(int i=0; i<getraenkeArray.count; i++)
    {
        meinXmlString = [parser toXml:[getraenkeArray objectAtIndex:i] andTag:@"Getraenk" inNameSpace:@"table_info"];
    }

    NSLog(@"meinXmlString: %@\n", meinXmlString); 
```

**这就是 meinXmlString 的样子：**

meinXmlString：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Getraenke_Object xmlns="table_info"><name>Chateau_d_Angludet</name>
<menge>1</menge><preis>119</preis><image>Rotwein.png</image>
<categorie>getraenke</categorie><item_id>101</item_id>
</Getraenke_Object> 
```

**但它应该看起来像：**

测试XML：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Table_info><table_id>1</table_id><action_id>3</action_id><Bestellliste>
<item><categorie>getraenke</categorie><item_id>100</item_id><menge>1</menge></item>
<item><categorie>getraenke</categorie><item_id>2</item_id><menge>1</menge></item>
</Bestellliste></Table_info> 
```

我希望描述我的问题可以理解。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:40:36.073

您为每个对象创建一个 XML 字符串，最后只保留最后一个。

WonderXML 似乎正在根据您传入的对象中的属性及其名称自动创建 XML 文档。

由于您似乎希望 XML 包含数组中的所有对象，因此请尝试将整个数组传递给对`parser toXml`. 你不想要一个循环。

当然，自己创建 XML 可能更容易。只需创建一个`NSMutableString`并添加您想要的标签文本。

# c# - Action MVC 中对象的生命周期

> ID：15554018
> 
> 赞同：1
> 
> 时间：2013-03-21T17:17:33.883
> 
> 标签：c#, asp.net, asp.net-mvc, dispose

什么时候在 ASP .NET MVC 中配置的控制器动作中的类对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T17:18:49.623

除非您明确地处置它，否则只要垃圾收集器运行，它就会被处置。没有办法知道什么时候会发生。这是假设没有其他对存储在某处的对象的引用。

注意：这里的“Dispose”意味着清理连接或非托管内存等资源。这是由实现 IDisposable 的对象完成的。

在垃圾收集器运行之前，对象本身不会从内存中删除（即使已释放）。不建议尝试强制垃圾收集。

# asp.net-mvc-3 - 允许所有特殊字符并防止 SQL 注入/XSS

> ID：15554022
> 
> 赞同：2
> 
> 时间：2013-03-21T17:17:51.000
> 
> 标签：asp.net-mvc-3, xss, sql-injection, html-encode, javascript-injection

我将 Asp.NET MVC 3 与 EF 4.1 与 SQL Azure 一起使用。我有 linq 表达式和存储过程。

现在，我需要允许`"';&<>/`输入诸如 etc 之类的所有特殊字符并将其保存在数据库中。但是，当它被呈现时，它不应该呈现为 HTML（即，应该呈现为文本）。如何防止 SQL 注入和 XSS 攻击？

我担心的是我们何时在标签中`@Html.TextBoxFor`或或中显示？`@Html.EditorFor`我不想在输入的字符类型上妥协。请建议如何解决这个问题？

# linux - 哪个硬件定时器用于 linux 中的 hr 定时器？

> ID：15554027
> 
> 赞同：3
> 
> 时间：2013-03-21T17:18:04.507
> 
> 标签：linux, timer, linux-kernel, kernel

内核计时器基于 systick HW 计时器（systick HW 计时器块或其他计时器），分辨率为 1 jiffy。对于 hr 定时器（高分辨率定时器），分辨率为 1 ns。哪个硬件定时器用于运行 hr 定时器以获得 1 ns 分辨率？我认为用于 hr 计时器的硬件计时器因平台而异。任何典型的例子对我来说都很好。另外，您能否指出我们声明 hr 计时器使用该特定硬件计时器的代码？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T15:26:21.530

分辨率仅标记为 1 ns；实际分辨率取决于硬件。

高分辨率计时器使用*时钟事件设备*，该设备由[clockevents_register_device](http://lxr.free-electrons.com/ident?i=clockevents_register_device)注册。

在 x86 上，这通常是每个 CPU 的本地 APIC 计时器。

# android - 如何从我的网络浏览器 (Chrome) 在 Android 中打开任何应用程序？我与 A Href 链接有什么关系？

> ID：15554029
> 
> 赞同：14
> 
> 时间：2013-03-21T17:18:04.847
> 
> 标签：android, google-chrome, web

我想从我的网络浏览器打开第三方应用程序。所以，我没有任何清单文件或任何东西。

我有一个网页。

我想要一个打开第三方应用程序的链接，例如 Twitter 或 Opera。

如何构建锚链接以打开该应用程序？

谢谢你。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-24T10:56:57.460

基于意图的 URI 的基本语法如下：

```
intent: 
   *HOST/URI-path* // 可选主机
   #Intent; 
      包= *[字符串]* ; 
      动作= *[字符串]* ; 
      类别= *[字符串]* ; 
      组件= *[字符串]* ; 
      方案= *[字符串]* ; 
   结尾;
```

[Android 源代码](https://code.google.com/p/android-source-browsing/source/browse/core/java/android/content/Intent.java?repo=platform--frameworks--base#6514)中提供了解析详细信息。

要启动 ZXing 条码扫描器应用程序，您可以将您的 href 编码如下：

```
<p>
  <a href="intent://scan/#Intent;scheme=zxing;package=com.google.zxing.client.android;end">Take a qr code</a><br>

  <a href="intent://scan/?ret=http%3A%2F%2Fexample.com#Intent;scheme=zxing;package=com.google.zxing.client.android;end">Take a qr code = 10px x 10px</a><br>

  <a href="intent:play/?mediaset=android-phone-rtmp-high&amp;playlisturl=http://www.bbc.co.uk/iplayer/playlist/bbc_one_london#Intent;scheme=bbcmediaplayer;package=air.uk.co.bbc.android.mediaplayer;end">Launch BBC</a>
</p>
```

[Android 清单](https://github.com/zxing/zxing/blob/master/android/AndroidManifest.xml#L93)定义了要使用的方案、要使用的`zxing`包`com.google.zxing.client.android`和要使用的主机数据`scan`。

如果您通过意图调用的活动包含`extra`数据，则也可以包含这些数据。

只有具有类别过滤器的活动[`android.intent.category.BROWSABLE`](http://developer.android.com/reference/android/content/Intent.html#CATEGORY_BROWSABLE)才能使用此方法调用，因为它表明应用程序可以安全地从浏览器打开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T18:21:42.257

这通常是不可能的。如果其他应用程序具有自定义 URL 处理程序，则您可以打开该 URL，否则不能。

# mongodb - 如何找到嵌入数组的所有元素都匹配某个条件的所有文档？

> ID：15554031
> 
> 赞同：0
> 
> 时间：2013-03-21T17:18:17.153
> 
> 标签：mongodb

我想编写一个查询，该查询返回所有`Foo`不具有`bar`完整设置为的所有对象的对象`true`。

以下是我正在处理的对象：

```
> db.Foo.find()
[
  {
    name: "foo1",
    bars: [
      { 
         name: "bar1", complete: true
      },
      { 
         name: "bar2", complete: false
      }
    ]
  },
  {
    name: "foo2",
    bars: [
      { 
         name: "barbo", complete: false
      }
    ]
  },
  {
    name: "foo3",
    bars: [
      { 
         name: "barbie", complete: true
      }
    ]
  }
] 
```

在这种情况下，我希望查询只返回`foo1`and `foo2`。

我试过`db.Foo.find({ "bars.complete": { $ne: false } })`了，这与我想要的相反（在这种情况下，它返回`foo1`and `foo2`。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:42:34.903

好吧，我之前完全把自己弄糊涂了，最后不得不把问题改成我想要的。这是我解决它的方法：

```
db.Foo.find({ "bars.complete": false }) 
```

# c++ - 我可以使用这项工作将本地定义的函子传递给算法函数吗？

> ID：15554032
> 
> 赞同：0
> 
> 时间：2013-03-21T17:18:18.153
> 
> 标签：c++

我没有使用 C++11 或 Boost。我想使用函子并传递给 std::for_each 等算法，但我认为必须在函数之外定义函子太麻烦了。我想在使用它们之前在函数中本地定义它们。但是，以下不起作用。这是由于旧的 C++ 标准不允许将本地定义的类用作模板参数（在 C++11 中修复）。

```
int main()
{
    std::vector<int> v(10);

    class SetInc
    {
    public:
        SetInc() : x(0) {}

        virtual void operator () (int& a)
        {
            a = x++;
        }

    private:
        int x;
    } f;

    std::for_each(v.begin(), v.end(), f);

    std::copy(v.begin(), v.end(), std::ostream_iterator<int>(std::cout, "\n"));
} 
```

但我已经开发了以下解决方法：

```
#include <iostream>
#include <vector>
#include <algorithm>
#include <functional>
#include <iterator>

template <typename ARGUEMENT, typename RESULT>
class FunctorBase
{
public:
    typedef ARGUEMENT argument_type;
    typedef RESULT result_type;

    virtual result_type operator () (argument_type) = 0;
    FunctorBase() {}
    virtual ~FunctorBase() {}
};

template <typename ARGUEMENT, typename RESULT>
class FunctorWrapper
{
public:
    typedef ARGUEMENT argument_type;
    typedef RESULT result_type;
    typedef FunctorBase<argument_type, result_type> Functor_T;

    explicit FunctorWrapper(Functor_T *functor)
        : functor(functor)
    {}

    result_type operator () (argument_type a)
    {
        return (*functor)(a);
    }

private:
    Functor_T *functor;
};

template <typename ARGUEMENT, typename RESULT>
FunctorWrapper<ARGUEMENT, RESULT> make_unary_functor(FunctorBase<ARGUEMENT, RESULT>& f)
{
    return FunctorWrapper<ARGUEMENT, RESULT>(&f);
}

int main()
{
    std::vector<int> v(10);

    class SetInc : public FunctorBase<int&, void>
    {
    public:
        SetInc() : x(0) {}

        virtual result_type operator () (argument_type a)
        {
            a = x++;
        }

    private:
        int x;
    } f;

    std::for_each(v.begin(), v.end(), make_unary_functor(f));

    std::copy(v.begin(), v.end(), std::ostream_iterator<int>(std::cout, "\n"));
} 
```

这样好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:23:24.437

问题是，在 C++ 98 中没有外部绑定的类型不能是模板参数。所以你能做的最好的就是把你的 SetInc 放到一个未命名的命名空间中。

我不知道您的解决方法是否以可移植的方式解决了问题，但它更难理解（您确实需要评论您的解决方法，以确保人们理解您为什么这样做）。编译器要优化虚函数调用要困难得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:27:30.370

一个明显的问题是虚函数调用。使用普通函数对象，可以内联被调用的函数；带有虚函数，可能不是。所以你最终会为小功能**带来**更多的开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:23:11.927

你不应该定义虚函数——没有多态性。你所有的代码都很好，但 STL 更好=）

看这里

[http://www.cplusplus.com/reference/functional/binary_function/](http://www.cplusplus.com/reference/functional/binary_function/)

[http://www.cplusplus.com/reference/functional/unary_function/](http://www.cplusplus.com/reference/functional/unary_function/)

在示例部分

```
struct IsOdd : public std::unary_function<int,bool> {
  bool operator() (int number) {return (number%2==1);}
}; 
```

PS：如果你想使用包装器而不是复制函子，这样重写它

模板

```
class FunctorWrapper
{
public:
    typedef F::argument_type argument_type;
    typedef F::result_type result_type;

explicit FunctorWrapper(F *functor)
    : functor(functor)
{}

result_type operator () (argument_type const & a) const
{
    return (*functor)(a);
}

result_type operator () (argument_type & a) const
{
    return (*functor)(a);
}

private:
    F *functor;
};

template <typename F>
FunctorWrapper<F> make_unary_functor(F& f)
{
    return FunctorWrapper<ARGUEMENT, RESULT>(&f);
} 
```

# ajax - Ajax 驱动的网站和谷歌 SEO

> ID：15554037
> 
> 赞同：0
> 
> 时间：2013-03-21T17:18:38.750
> 
> 标签：ajax, seo, sitemap, bots

我的问题是 Google 没有为我的网站编制索引，并且该网站已经启动并运行了 5 周。

不是它不索引我的内部页面，而是**它不索引网站本身**。

当您在 Google 上输入“xyz”作为搜索关键字时，我的网站“ww.xyz.com”将被完全忽略。

该网站是 ajax 驱动的，这是我的配置：

我在服务器根文件夹中有一个robot.txt：

```
User-agent: *
Disallow: /admin/
Sitemap: http://www.xyz.com/sitemap.xml 
```

我在服务器根文件夹中有一个 sitemap.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="..." xmlns:xsi="..." xsi:schemaLocation="...">
    <url><loc>http://www.xyz.com/</loc></url>
    <url><loc>http://www.xyz.com/index.php?action=link1</loc></url>
    <url><loc>http://www.xyz.com/index.php?action=link2</loc></url>
</urlset> 
```

索引页面如下所示：

```
<!doctype html>
<html lang="fr">

    <head>

        <title>xyz</title>

        <meta http-equiv= "content-type"      content="text/html;charset=utf-8">
        <meta http-equiv= "Content-Language"  content="fr" >
        <meta name      = "fragment"          content="!">
        <meta name      = "google"            content="notranslate">
        <meta name      = "robots"            content="index,follow"> 
        <meta name      = "Description"       content="...">
        <meta name      = "Keywords"          content="...">

    </head>

    <body>

        <ul id="menu>
            <li id="mylink1">
                <a href="index.php?action=link1">Link 1</a>
            </li>

            <li id="mylink2">
                <a href="index.php?action=link2">Link 2</a>
            </li>
        </ul>

        <div id="content">
            <?php include('ajax.php');?>
        </div>

    </body>

</html> 
```

“ajax.php”文件如下所示：

```
<script type="text/javascript">
    $('#link1').click(function(e) 
    {   
        e.preventDefault(); 

        $.ajax({
            type:"POST",
            url:"includes/page1.php,
            data:"action=link1",
            complete:function(data){$('#content').html(data.responseText);}
        }); 

    $('#link2').click(function(e) 
    {   
        e.preventDefault(); 

        $.ajax({
            type:"POST",
            url:"includes/page2.php,
            data:"action=link2",
            complete:function(data){$('#content').html(data.responseText);}
        }); 
    });
</script> 
```

假设我们的目标是“includes/page1.php”，这是 page1.php 的内容：

```
<?php
if($_POST['action']=='link1')
{
    //show the content
    ...
}
?> 
```

如您所见，“index.php”上的 href url 没有用，因为它们被 javascript 中的“e.preventDefault();”停用。

完成所有工作的是“$('#link1').click(function(e) {..})”。

由于#content 是通过使用“$('#content').html(data.responseText);”动态传递的，我相信存在一个 DOM 问题，导致该网站无法被谷歌机器人抓取。

我阅读了这个谷歌帮助页面，它描述了如何使 ajax 驱动的网站对谷歌友好：

[https://developers.google.com/webmasters/ajax-crawling/docs/getting-started](https://developers.google.com/webmasters/ajax-crawling/docs/getting-started)

问题是他们似乎解释了如何使 url 使用 google 机器人可抓取的哈希值，但我的网站没有在链接中使用哈希值，所以我真的不知道应该做些什么来让我的网站被谷歌索引。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:20:58.247

你有两个选择：

1.  重做您的网站以使用[Google Crawlable Ajax Standard](http://googlewebmastercentral.blogspot.com/2009/10/proposal-for-making-ajax-crawlable.html)。但这[是个坏主意](http://isolani.co.uk/blog/javascript/BreakingTheWebWithHashBangs)。

2.  在不需要 JavaScript 的情况下制作您的网站。这是一个好主意，因为它使搜索引擎和人类都可以访问您的网站。请记住，并不是每个人都启用了 JavaScript。这称为[渐进增强](http://www.alistapart.com/articles/understandingprogressiveenhancement)。

# java - 无法获得新的会话 java web 项目

> ID：15554041
> 
> 赞同：0
> 
> 时间：2013-03-21T17:19:10.523
> 
> 标签：java, session, netbeans

我正在使用 NetBeans 创建一个 Java Web 应用程序。我只使用了jsp来创建项目。

我想提供登录功能。所以，我需要与`Session`.

我试图在登录页面之后的下一页上获取会话信息。这意味着 login.jsp 是我要求用户提供登录详细信息的页面。下一页是 verifyCredentials.jsp，我在其中验证凭据并检查新会话。

但每次我只是变老。所以我也无法为第一次登录获得新会话。

我已经尝试过检查会话中的示例代码来[检查会话](http://javaj2eepro.blogspot.in/2011/04/14-simple-project-to-check-session.html)的功能，但它每次都占用旧会话。

每个浏览器都遇到同样的问题。

NetBeans 版本是 7.2.1，JDK 是 1.7

# javascript - 如何为wicket jquery ui spinner捕获onclick

> ID：15554044
> 
> 赞同：2
> 
> 时间：2013-03-21T17:19:20.780
> 
> 标签：javascript, jquery, wicket

如何从 JQuery 捕获微调器组件上的向上和向下按钮的 onclick 事件？

我可以使用以下代码捕获关联文本字段的 onchange，但向上和向下微调器按钮不会触发事件：

```
 Spinner<Integer> psbBudget = new Spinner<>("psbBudget", new PropertyModel(psb,"psbBudget"), Integer.class);
                psbBudget.add(new AjaxFormComponentUpdatingBehavior("onchange") {
                    @Override
                    protected void onUpdate(AjaxRequestTarget art) {
                        Integer inputS = (Integer) getFormComponent().getConvertedInput();
                        BigDecimal spinnerTime = BigDecimal.valueOf(inputS);
                        unallocatedTimeMap.put(psb, unallocatedTimeMap.get(psb).subtract(spinnerTime));
                        art.add(budgetListViewContainer);
                    }
                });
                listItem.add(psbBudget);

                li.add(new Label("remainingBudgetLabel", new Model(unallocatedTimeMap.get(psb)))); 
```

只是为了让我自己更难，这个微调器包含在 ListView 中，因为预算项目的数量是可变的。我得到了剩余预算标签来反映在文本字段中所做的更改，而不是使用微调按钮所做的更改！

我已经开始探索使用以下几行注入我自己的 javascript：

```
 // behavior to capture changes made using spinner buttons (doesn't work!!!)
        add(new Behavior() {
            @Override
            public void renderHead(Component component, IHeaderResponse response) {
                super.renderHead(component, response);
                response.render(OnDomReadyHeaderItem.forScript("$('.ui-spinner-button ui-spinner-up ui-corner-tr ui-button ui-widget ui-state-default ui-button-text-only').click(function() {$(this).siblings('input').change();})"));
            }
        }); 
```

这是声明的html的相关部分：

```
 <table>
                                    <tr>
                                        <td/>
                                        <th>Budget</th>
                                        <th>Remaining</th>
                                    </tr>
                                    <tr wicket:id="budgetListView">
                                        <th wicket:id="budgetLabel">Budget
                                        </th><td><input wicket:id="psbBudget" type="text" style="width:3em" maxLength="2"/>
                                        </td><td wicket:id="remainingBudgetLabel"/>
                                    </tr>
                                </table> 
```

所以我想这是一个由两部分组成的问题： 1 - 这种javascript注入是否有希望工作（我只是用javascript弄湿了我的脚）或者有没有办法在Wicket中更正确地做到这一点？2 - 如果 javascript 是唯一的方法，当我无法控制生成的 jquery 的 id 属性时，如何正确找到元素（或者我可以以某种方式控制它？）？

我正在使用带有 wicket 6.6.0 的 wicket-jquery-ui 6.2.1 库。谢谢你。

**编辑**

我之前发布的生成的 html（现在已删除）来自右键单击并选择 viewSource，但没有显示从 jquery 实际生成的 html。请参阅下面的 IE9 中 F12 开发人员工具的屏幕截图，该屏幕显示为微调器生成的 html 包括原始`<input>`以及两个`<a>`为微调器按钮生成的标签。

![在此处输入图像描述](../Images/9a309da099d410d4eff8fd51765ac6ac.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T20:58:16.883

我才看到这个帖子...

只是说你有另外两个选择：

1/ 你有你自己的扩展微调器：

```
 @Override
protected void onConfigure(JQueryBehavior behavior)
{
    super.onConfigure(behavior);

    behavior.setOption("onspinstop", this.onStopBehavior.getCallbackFunction());
    //onStopBehavior is an JQueryAjaxPostBehavior, see how AjaxDatePicker works for instance
} 
```

第二种选择是`AjaxSpinner`通过 github 项目或 google 组请求 ，因为这很有意义：
[https://github.com/sebfz1/wicket-jquery-ui/](https://github.com/sebfz1/wicket-jquery-ui/)
[http://groups.google.com/组/wicket-jquery-ui/](http://groups.google.com/group/wicket-jquery-ui/)

最好的问候，塞巴斯蒂安。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:06:23.350

尽管我讨厌回答自己的问题，但这里是：

我能够使用以下代码捕获事件。“onchange”捕获有人在字段中手动输入数字时的事件，“onspinstop”捕获通过单击向上/向下箭头更新组件后的事件：

```
Spinner<Integer> psbBudget = new Spinner<>("psbBudget", new Model(allocatedTimeMap.get(psb)), Integer.class);
psbBudget.add(new AjaxFormComponentUpdatingBehavior("onchange") {
    @Override
    protected void onUpdate(AjaxRequestTarget art) {
        Integer input = (Integer) getFormComponent().getConvertedInput();
        // Do whatever with updated input //
        art.add(remainingBudgetLabel,remainingBudgetLabel.getMarkupId());
    }
}
psbBudget.add(new AjaxFormComponentUpdatingBehavior("onspinstop") {
    @Override
    protected void onUpdate(AjaxRequestTarget art) {
        Integer input = (Integer) getFormComponent().getConvertedInput();
        // Do whatever with updated input //
        art.add(remainingBudgetLabel,remainingBudgetLabel.getMarkupId());
    }
} 
```

[在查看了 JQuery UI Spinner 组件的 API 文档](http://api.jqueryui.com/spinner/)然后尝试了事件字符串的所有可能组合之后，我能够弄清楚这一点。要正确执行此操作，您必须将字符串全部小写并将“on”字符串添加到事件名称的开头。

我在本练习中学到的另一件事是，我可以通过调用`art.add(component, component.getMarkupId());`. `listView.setList(updatedList)`这比我以前做的要好得多`art.add(listViewContainer);`

# php - 如何缩短 php 截断函数？

> ID：15554048
> 
> 赞同：0
> 
> 时间：2013-03-21T17:19:27.397
> 
> 标签：php, regex

对于我需要检查字符串是否不超过给定长度并且如果它超过然后截断并添加省略号的情况，我通常使用如下函数但想知道是否不能在一行中做到这一点，preg_replace 可能吗？

```
function truncate($str, $length){

    if (strLen($str) > $length) {
        $str = substr($str, 0, $length) . ' ...';
    }
    return $str;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T17:21:00.743

使用内联 if：

```
return strLen($str) > $length ? substr($str, 0, $length) . ' ...'  : $str; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T17:23:34.523

如果您正在寻找正则表达式解决方案：

```
function truncate($str, $length) {
    return preg_replace('/(.{'.(int)$length.'}).+/s', '$1 ...', $str);
} 
```

# c++ - boost::exception_detail::clone_impl >

> ID：15554053
> 
> 赞同：7
> 
> 时间：2013-03-21T17:19:47.200
> 
> 标签：c++, visual-c++, boost-asio, boost-thread, firebreath

我需要一些帮助来解决这个异常，我正在实现一个 NPAPI 插件，以便能够使用来自浏览器扩展的本地套接字，为此我正在使用 Firebreath 框架。

对于套接字和连接，我使用带有异步调用和 5 个工作线程的线程池的 Boost asio。我也有每个线程的最后期限来实现传输超时。

我的插件扩展工作流程如下：

1.  打开套接字 1（这将启动 async_receive 和截止日期 async_wait）
2.  写入套接字 1
3.  得到回应 1

4.  打开另一个套接字 2

5.  写入套接字 2

6.  写入套接字 1

7.  关闭套接字 1（socket.cancel()、deadline.cancel()、socket.shutdown()、套接字释放）。

8.  得到回应 2

9.  写入套接字 2
10.  关闭套接字 2

由于一切都是跨语言的，异步确实很难调试，但所有打开、写入或关闭都是从 javascript 调用的，而从套接字 1 读取的调用按顺序调用 open 2、write 2、write 1 和 close 1。

也许我所说的一切都是无关的，因为抛出异常时的调用堆栈不会显示我的任何函数，而只会显示它在`malloc`调用的内部`_heap_alloc_dbg_impl`

因为它通常在第 2 或第 3 个完整周期中失败，并且似乎发生在第 5 步和第 7 步之间。

但是，我认为它必须与 asio 相关，因为使用单个工作线程执行所有操作只会在第一个周期出现异常而崩溃。

如果您需要，我愿意发布更多信息代码。

**更新1：**

![VS 断裂时](../Images/a0fb88d3526227a81a7d2086fa5ba80a.png)

**更新 2：**

启动了 10 个线程：

```
workPtr.reset( new boost::asio::io_service::work(io_service));

for ( int i = 0; i < 10; ++i) {
    m_threadGroup.create_thread( boost::bind(&boost::asio::io_service::run, &io_service) );
} 
```

第11个_threadstartex 不知道是谁发起的

在另一个线程上（不是 VS 声称导致崩溃的线程）有一个`join_all()`进程，因为我的类正在被破坏，但我认为它不应该，所以这个崩溃可能是由于另一个异常和 Firebreath 进程关闭一切当它崩溃时。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T18:55:43.057

我通过继续检查其他线程发现了错误。我发现 Firebreath 调用的我的主要课程正在被销毁。再检查一下，我发现这完全是我的错我有一个类来存储需要在主体类中使用函数的套接字信息（我不喜欢它，但这是我发现使用它的唯一方法）所以我`shared_ptr`在校长班上加了一个。因此，如果它在销毁这些`SocketInfo`对象之后，因为没有其他对象，ptr ref 计数达到 0，并且主体类被销毁。

有趣的是，套接字通常在使用后正常关闭，所以我看不出为什么在没有打开套接字时没有触发它，并且只有在连续打开和关闭 2 个套接字时才会发生这种情况。

无论如何，我`shared_from_this`在截止日期处理程序上也有一个错误，但这似乎无关紧要。

现在它似乎可以在任意数量的线程中正常工作。

# matlab - 如何使用 Matlab 检查 1x4 双单元格中的特定值？

> ID：15554055
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:19:49.217
> 
> 标签：matlab, compare, cell, combinations

如果我有一个 4x1 单元结构：

```
[1x4 double]
[1x4 double]
[1x4 double]
[1x4 double] 
```

每个单元格都有：

```
[5,3,0,0]
[0,3,5,0]
[1,3,0,0]
[0,3,2,0] 
```

**我想做以下事情：**

选择第一个数组 a 值 = 5 的单元格

答：`[5,3,0,0]`

选择具有第二个数组 a 值 = 3 的单元格

答： `[5,3,0,0] [0,3,5,0] [1,3,0,0] [0,3,2,0]`

ETC

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:27:46.627

代码：

```
a = cell(4,1);
a{1} = [5 3 0 0];
a{2} = [0 3 5 0];
a{3} = [1 3 0 0];
a{4} = [0 3 2 0];

findval = 3;
arrayind = 2;

b = a(cellfun(@(x)x(arrayind) == findval,a));
b{:} 
```

终端：

```
ans =

     5     3     0     0

ans =

     0     3     5     0

ans =

     1     3     0     0

ans =

     0     3     2     0 
```

# php - 如何检索xml中所有元素内的所有数据？

> ID：15554058
> 
> 赞同：0
> 
> 时间：2013-03-21T17:19:52.907
> 
> 标签：php, xml, simplexml

我在 php 中获取 xml 数据时遇到问题

我的 xml 相当复杂，标签中有几个嵌套的子级。

xml

```
?xml version="1.0" encoding="UTF-8"?>

<book id="5">
<title id="76">test title</title>
<figure id="77"></figure>

<ch id="id78">
<aa id="80"><emph>content1</emph></aa>
<ob id="id_84" page-num="697" extra-info="4"><emph type="bold">opportunity.</emph></ob>
<ob id="id_85" page-num="697" extra-info="5"><emph type="bold">test data.</emph></ob>
<para id="id_86" page-num="697">2008.</para>

<body>
   ..more elements
   <content>more contents..
   </content>
</body>
</ch> 
```

我的代码

```
//I need to load many different xml files.

 $xml_file = simplexml_load_file($filename);
          foreach ($xml_file->children() as $child){
              echo $child->getName().':'. $child."<br>";
          } 
```

上面的代码只会显示

`book, title, figure, ch`但不是`ch`标签内的元素。如何显示每个标签内的所有元素？有小费吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:22:34.463

两件事情：

1.  您需要匹配您的`<ob>` `</objective>`标签。

2.  你的 foreach 需要是递归的。你应该检查你的 foreach 中的每个项目是否有一个孩子，然后递归地遍历这些元素。我建议为此使用递归调用的单独函数。

例子：

```
$xml_file = simplexml_load_file($filename);
parseXML($xml_file->children());
function parseXML($xml_children)
{
    foreach ($xml_children as $child){
        echo $child->getName().':'. $child."<br>";
        if ($child->count() > 0)
        {
            parseXML($child->children());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:47:47.987

你需要做递归调用

```
parseAllXml($xml_file);

function parseAllXml($xmlcontent)
{
 foreach($xmlcontent->children() as $child)
   {
     echo $child->getName().':'. $child."<br>";
     $is_further_child = ( count($child->children()) >0 )?true:false;  
     if( $is_further_child )
     {
        parseAllXml($child);
     }   
 }
} 
```

# python - 树实现中的奇怪引用行为

> ID：15554060
> 
> 赞同：0
> 
> 时间：2013-03-21T17:19:59.757
> 
> 标签：python, reference, tree, pass-by-reference

我完全被一个更大系统中的错误弄糊涂了。考虑这个类（每个节点都维护一个指向其父节点的指针和一个子节点列表）：

```
class Node:
    children = []

    def __init__(self, parent):
        self.contents = dict()
        self.parent = parent

        if parent is not None:
            print self.children
            print parent == self
            parent.children.append(self)
            print self.children 
```

运行这个：

```
foo1 = Node(None)
foo2 = Node(foo1) 
```

神秘地返回这个：

```
[]
False
[<__main__.Node instance at 0x10051f128>] 
```

这有什么意义呢？为什么第二个节点的子节点不为空？也许我缺少对与 Python 如何传递引用相关的概念的基本理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:23:09.050

您已定义`children`为类变量。它由班级的所有成员共享。将声明移入`__init__`并将其更改为`self.children = []`，您将获得预期的结果。

# mysql - 在一个查询中检查给定日期之前和之后是否存在日期

> ID：15554061
> 
> 赞同：1
> 
> 时间：2013-03-21T17:19:59.870
> 
> 标签：mysql, sql

这是一个 Mysql/sql 查询问题，但请允许我解释一下上下文：我想为我的 PHP 日历配备一个“< PREV”和“NEXT >”按钮，允许用户轻松转到上一个或下一个可用**月份有可用的数据库条目**。如果没有可用的数据库条目，我想禁用该按钮（我不希望系统显示一个空日历）。

**示例：** 用户有 FEB 视图。JAN 和 MAR 不包含条目，但 DEC 和 APR 包含。然后“下一步 >”按钮需要切换到四月日历。'< PREV' 按钮需要切换到十二月日历。

**所以基本上我正在寻找一个有效的查询，可以检查条目是否存在于视图中的月份之前和之后（但不是部分）。**

该表有一个字段“logDate”，其日期类型为“Ymd”。

我开始摸索以下查询，首先检查给定日期之前和之后是否存在日期，但我知道这个查询有一些问题。一方面，如果表中有一个条目是“2013-03-19”，我的查询会为 prev 输出一个 1 - 这当然不表示在 3 月之前的几个月内是否存在条目。

```
SELECT IF( EXISTS(SELECT dayId FROM LogbookDay 
WHERE logDate < '2013-03-20' AND userId = 2), 1, 0) as prev, 
IF( EXISTS(SELECT dayId FROM LogBookDay WHERE logDate > '2013-03-20' 
AND userId = 2), 1, 0) as next 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T17:23:48.770

将开始日期修改为月初和月底：对于 prev，您修改为当月的第一天，即比当月的当天减去 1。接下来，您执行相同操作，然后添加 1 个月：

```
SELECT 
(SELECT dayId FROM LogbookDay WHERE 
    logDate < ADDDDATE('2013-03-20', 1-DAY('2013-03-20')) AND userId = 2
    ORDER BY logDate DESC LIMIT 1
) as PREV,
(SELECT dayId FROM LogBookDay WHERE 
    logDate >= ADDDATE(ADDDDATE('2013-03-20', 1-DAY('2013-03-20')), INTERVAL 1 MONTH) AND userId = 2
    ORDER BY logDate ASC LIMIT 1
) as NEXT 
```

（或者，在 PHP 中执行此操作，因为它可能会产生更具可读性的代码。）

根据结果​​是空值还是日期，以不同方式显示链接。

如果您要提取日期而不是 ID，它可能会更优雅：

```
 SELECT 
(SELECT MAX(logDate) FROM LogbookDay WHERE 
    logDate < ADDDDATE('2013-03-20', 1-DAY('2013-03-20')) AND userId = 2
) as PREV,
(SELECT MIN(logDate) FROM LogBookDay WHERE 
    logDate >= ADDDATE(ADDDDATE('2013-03-20', 1-DAY('2013-03-20')), INTERVAL 1 MONTH) AND userId = 2
) as NEXT 
```

但这取决于您对找到的信息所做的工作。如果您所做的只是创建指向新月份的链接，那么将最近的日期拉到不在同一个月内应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:09:57.510

通过我自己的查询和来自已发布答案之一的指针，我能够提出一个简单的查询来检查条目是否存在于当前查看月份之前和之后的月份。

假设考虑月份是 2013 年 3 月：

```
SELECT IF( EXISTS(SELECT dayId FROM LogBookDay 
WHERE logDate < '2012-03-01' AND userId = 1), 1, 0) as prev,
IF( EXISTS(SELECT dayId FROM LogBookDay 
WHERE logDate > CONCAT('2012-03-',LAST_DAY('2003-02-05')) 
AND userId = 1), 1, 0) as next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:32:08.930

```
SELECT 
if(min(logDate) < '2013-03-20', 1, 0) 'NEXT',
if(max(logDate) > '2013-03-20', 1, 0) 'PAST'
FROM LogbookDay 
WHERE logDate < '2013-03-20' AND logDate > '2013-03-02' 
AND  userId = 2 
```

# python - Django - 使用 REMOTE_USER 进行身份验证 - 如何在开发服务器中进行测试？

> ID：15554062
> 
> 赞同：7
> 
> 时间：2013-03-21T17:20:00.347
> 
> 标签：python, django, debugging, authentication

我想使用 django.contrib.auth.middleware.RemoteUserMiddleware 进行身份验证，如下所述：

[https://docs.djangoproject.com/en/dev/howto/auth-remote-user/](https://docs.djangoproject.com/en/dev/howto/auth-remote-user/)

问题是，如何在没有 Apache 的开发环境中进行测试？即我可以在本地设置中以某种方式设置 REMOTE_USER 吗？

**编辑**（添加设置）

```
AUTHENTICATION_BACKENDS = (
'django.contrib.auth.backends.RemoteUserBackend',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.auth.middleware.RemoteUserMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    ...
) 
```

然后我在我的 local_Settings 中有这个：

```
os.environ['REMOTE_USER'] = "mmatyas" 
```

我还尝试了“HTTP_REMOTE_USER”变体。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-15T00:35:42.797

该变量必须在您启动开发服务器的环境中设置。通常只是：

```
REMOTE_USER=myuser ./manage.py runserver 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-30T23:08:01.327

您可以编写一些 WSGI 中间件并将其设置在那里，然后确保 wsgi 中间件将您的 django 应用程序包装在 wsgi 堆栈中。有很多关于编写 wsgi 中间件的教程，这将是一小段代码。轻松-peasy-lemon-squeezy！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:26:33.357

In your dev environment, you can set an environment variable in the same command prompt you use to start up your dev server.

Something like `export REMOTE_USER="duncan"` if on a Unixy machine.

You can also do this by editing your manage.py and setting `os.environ['REMOTE_USER'] = "duncan"`

# java - Spring EL：带地图访问的安全导航

> ID：15554065
> 
> 赞同：7
> 
> 时间：2013-03-21T17:20:04.137
> 
> 标签：java, spring, spring-el

我正在使用 Spring EL 从一组相当复杂的嵌套映射和列表中提取值。我希望能够使用类似的表达式

```
[9]['firstSubKey']['secondSubKey'] 
```

除了那`[9]['firstSubKey']`可能是空的。我不知道如何正确使用安全导航：我试过了

```
[9]['firstSubKey']?['secondSubKey'] 
```

和

```
[9]['firstSubKey']?.['secondSubKey'] 
```

并且都返回了某种解析错误。我最终通过使用它来工作

```
[9]['firstSubKey']?.get('secondSubKey') 
```

但这感觉很俗气。有没有更好的方法或者这只是 SpringEL 没有的功能？我正在使用 Spring 3.1.3。

相关地，如果我有一个未知数量元素的列表/数组，有没有办法安全地检查它？IE 如果我有一个包含 4 个元素的数组，我想`[5]`返回 null。照原样，它抛出一个`SpelEvaluationException`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:59:03.990

我想不出更好的解决方案来解决您的问题；只要

`"['0']['a'] != null ? ['0']['a']['b'] : null"`

和

`"size() > 5 ? [5] : null"`

# java - android：TextToSpeech泄漏服务连接

> ID：15554068
> 
> 赞同：2
> 
> 时间：2013-03-21T17:20:20.367
> 
> 标签：java, android, service, text-to-speech, serviceconnection

我正在尝试使用文本转语音创建应用程序。每当我从活动 Text_entry 移动到活动 CombChange 并返回时，我都会在日志 cat（下）中收到这些服务连接泄漏错误。

谁能明白为什么？

我只粘贴了 Text_Entry 和 CombChange 类的相关位 - 所以可能缺少声明和大括号等。

```
public class Text_entry extends Activity implements OnTouchListener, TextToSpeech.OnInitListener{

    speech = new Speech(this);
        Intent checkTTSIntent = new Intent();
        checkTTSIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
        startActivityForResult(checkTTSIntent, MY_DATA_CHECK_CODE);

    Intent intent2 = new Intent(this, CombChange.class);
    intent2.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    intent2.putExtra("newPat", enteredNumber);
    startActivity(intent2);
}

@Override
    public void onResume() {
        super.onResume();
        Intent intent = getIntent();
        String hc =" ";
        hc = intent.getExtras().getString("helpComb");
        if (hc.equals("true"))
            helpComb = true;
        else
            helpComb = false;
    }

 protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (requestCode == MY_DATA_CHECK_CODE) {
            if (resultCode == TextToSpeech.Engine.CHECK_VOICE_DATA_PASS) {
                speech = new Speech(this);
            }
            else {
                Intent installTTSIntent = new Intent();
                installTTSIntent.setAction(TextToSpeech.Engine.ACTION_INSTALL_TTS_DATA);
                startActivity(installTTSIntent);
            }
            }
    } 
```

.

```
public class CombChange extends ListActivity {
    speech = new Speech(this);
    speech.changeText("enter the new combination");
    speech.speaks();
    SystemClock.sleep(1300);
        Intent intent = new Intent(this, Text_entry.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    intent.putExtra("helpComb", "true");
    speech.cleanUp();
    startActivity(intent);
} 
```

.

```
public class Speech implements TextToSpeech.OnInitListener {

    private String toRead;
    private TextToSpeech tts;
    public Speech(Context c) {
        tts = new TextToSpeech(c, this);
        tts.setPitch(1.2f);
        tts.setSpeechRate(1.5f);
    }
    public void speaks()
    {
        speakOut();
    }

    public void changeText(String changeTo)
    {
        toRead = changeTo;
    }

    public void cleanUp() {
         //Don't forget to shutdown tts!
        if (tts != null) {
            tts.stop();
            tts.shutdown();
        }
    }   

    public void onInit(int status) {

        if (status == TextToSpeech.SUCCESS) {

            int result = tts.setLanguage(Locale.UK);

            if (result == TextToSpeech.LANG_MISSING_DATA
                    || result == TextToSpeech.LANG_NOT_SUPPORTED) {
                Log.e("TTS", "This Language is not supported");
            } else {
                speakOut();
            }

        } else {
            Log.e("TTS", "Initilization Failed!");
        }

    }
    protected void onStop()
    {

        if(tts != null){
            tts.shutdown();
        }       
    }
    private void speakOut() {
        tts.speak(toRead, TextToSpeech.QUEUE_FLUSH, null);
        }
    } 
```

.

```
03-21 16:42:32.515: I/TextToSpeech(24023): Sucessfully bound to com.google.android.tts
03-21 16:42:32.535: E/ActivityThread(24023): Activity org.BT.Text_entry has leaked ServiceConnection android.speech.tts.TextToSpeech$Connection@427fd290 that was originally bound here
03-21 16:42:32.535: E/ActivityThread(24023): android.app.ServiceConnectionLeaked: Activity org.BT.Text_entry has leaked ServiceConnection android.speech.tts.TextToSpeech$Connection@427fd290 that was originally bound here
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:965)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:859)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.ContextImpl.bindService(ContextImpl.java:1344)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.ContextImpl.bindService(ContextImpl.java:1336)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.content.ContextWrapper.bindService(ContextWrapper.java:401)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.speech.tts.TextToSpeech.connectToEngine(TextToSpeech.java:627)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.speech.tts.TextToSpeech.initTts(TextToSpeech.java:597)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.speech.tts.TextToSpeech.<init>(TextToSpeech.java:553)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.speech.tts.TextToSpeech.<init>(TextToSpeech.java:527)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.speech.tts.TextToSpeech.<init>(TextToSpeech.java:512)
03-21 16:42:32.535: E/ActivityThread(24023):    at org.BT.Speech.<init>(Speech.java:14)
03-21 16:42:32.535: E/ActivityThread(24023):    at org.BT.Text_entry.onCreate(Text_entry.java:97)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.Activity.performCreate(Activity.java:5184)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1083)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2064)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2125)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.ActivityThread.access$600(ActivityThread.java:140)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.os.Looper.loop(Looper.java:137)
03-21 16:42:32.535: E/ActivityThread(24023):    at android.app.ActivityThread.main(ActivityThread.java:4898)
03-21 16:42:32.535: E/ActivityThread(24023):    at java.lang.reflect.Method.invokeNative(Native Method)
03-21 16:42:32.535: E/ActivityThread(24023):    at java.lang.reflect.Method.invoke(Method.java:511)
03-21 16:42:32.535: E/ActivityThread(24023):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
03-21 16:42:32.535: E/ActivityThread(24023):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
03-21 16:42:32.535: E/ActivityThread(24023):    at dalvik.system.NativeStart.main(Native Method)
03-21 16:42:32.670: I/TextToSpeech(24023): Sucessfully bound to com.google.android.tts
03-21 16:42:32.670: D/(24023): 3333333333333333333333333333333333333333333333333
03-21 16:42:32.670: E/SpannableStringBuilder(24023): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length
03-21 16:42:32.670: E/SpannableStringBuilder(24023): SPAN_EXCLUSIVE_EXCLUSIVE spans cannot have a zero length
03-21 16:42:32.775: I/TextToSpeech(24023): Connected to TTS Service
03-21 16:42:32.780: I/TextToSpeech(24023): Connected to TTS Service 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:25:10.840

我相信这可以解决您的问题，但是我无法用您的代码来解释它-也许这里的其他人可以 [http://www.stevenmarkford.com/android-activity-has-leaked-serviceconnection-that-was-originally -绑定到这里/](http://www.stevenmarkford.com/android-activity-has-leaked-serviceconnection-that-was-originally-bound-here/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-03T10:43:45.077

我不确定这有多大帮助，但请尝试在 Activity 类中实现 onPause() 方法。并明确取消绑定您的服务。例如：

```
@Override
        protected void onPause() {
            super.onPause();
            CalculatorUser c=new CalculatorUser(); //your Activity name object
            c.unbindService((ServiceConnection) this);
        } 
```

解除绑定可能会解决您的问题，并且“Activity 'APP' has leaked ServiceConnection”主要发生在您移出 Activity 时，因此您需要明确告诉 Android 操作系统请解除我与我的 Activity 目前正在使用的服务的绑定。当您再次启动您的应用程序时，它将绑定到服务。如果它没有帮助向我发送代码，我会尝试为您修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-07T01:40:28.827

对我来说，关闭 TextToSpeech 对象。

```
@Override
protected void onDestroy() {
    tts.shutdown();
    super.onDestroy();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-17T03:09:09.100

这个问题的实际答案：

当服务被销毁时，您需要调用`destroy()`您的对象。`TextToSpeech`

我遇到了这个问题，看到了你的问题，所以我想我会为其他来这里的人回答这个问题。

# asp.net - 如何去除桌子下的空间？

> ID：15554071
> 
> 赞同：0
> 
> 时间：2013-03-21T17:20:48.497
> 
> 标签：asp.net, html, vb.net

这是我所做的，我的问题是什么。首先，我有一张有很多 td 的大桌子，我的桌子顶部的第一个 td 包含另一个桌子（我的问题来了）那张小桌子下面有一个空间，我不知道为什么。

这是我的表的代码：

```
<div runat="server" class="ReportPage" >
  <table runat="server" class="ListReportBigTable" align="center">
    <tr>
      <td class="style13" colspan="3" >
         <table  width="46%" align="center"style="height:50%; "cellpadding="0"> 
           <tr>
             <td align="left"> 
               <asp:Label ID="LB_ChooseReport" runat="server" 
                  Text="Choisissez un dossier m&eacute;dical: " Font-Size="Small">
               </asp:Label>
             </td>
           </tr>
           <tr>
             <td style="vertical-align:bottom" align="left">
               <asp:UpdatePanel ID="UpdatePanel3" runat="server">
                 <ContentTemplate>
                   <div id="div_Filter" runat="server" visible="false" align="left">
                     <asp:Label ID="LBL_FilteredBy" runat="server" width="18%" Text="Patient : " 
                         Font-Size="Small" style="margin-left: 0px"></asp:Label>
                     <asp:DropDownList ID="DDL_FilterSelect" runat="server" AutoPostBack="true" 
                         Width="25%" CssClass="DDL_Filter" Font-Size="Small" Height="18px"></asp:DropDownList>
                   </div>
                 </ContentTemplate>
               </asp:UpdatePanel></td></tr></table>  
               <br />                 
             </td> 
```

这里是 CSS：

```
.ListReportBigTable
{
    height:25%;
    width:55%;
    text-align:center;
    vertical-align:middle;
    border: thick solid black;  
     margin-left: 0px;
} 
```

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:59:39.087

我不知道这是否是一个错字，但你`</td>`在结束`</table>`标签之后用 a 结束。此外，您`<br />`在关闭之前有一个放错`</td>`位置，这显然会在底部增加空间。

尝试将关闭更改`</td>`为`</table></div>`并删除`<br />`

此外，在您的 CSS 中尝试添加`margin-bottom: 0px;`并`padding-bottom: 0px;`查看是否有效果。

另外，桌子后面是什么？也许在表格有自己的上边距/填充之后显示的任何内容？

您是否有指向发生这种情况的实际页面的链接，以便我们可以使用 Firebug 或类似工具进行检查并尝试找出答案？

# c# - 用户“NT AUTHORITY\SYSTEM”登录失败。原因：无法打开显式指定的数据库

> ID：15554080
> 
> 赞同：1
> 
> 时间：2013-03-21T17:21:25.797
> 
> 标签：c#, sql-server

我有一个应用程序经常访问数据库以获得许多功能。它运行了好几天。今天早上我收到了一个`System.Data.SqlClient.SqlException`例外。发生这种情况时，应用程序没有做任何不正常的事情。关于造成这种情况或将来如何防止这种情况的任何想法？

**Windows 事件日志**

```
NT AUTHORITY\SYSTEM 
   Reason: Failed to open the explicitly specified database. 
   [CLIENT: <local machine>] 
```

**异常堆栈跟踪**

```
System.Data.SqlClient.SqlException (0x80131904): 
Cannot open database ""MyDB"" requested by the login. The login failed.
Login failed for user 'NT AUTHORITY\SYSTEM'.
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode)
   at System.Data.Linq.DataContext.SubmitChanges()
   at ***.SubmitContextChanges(DataContext dataContext, Int32 counter) in c:\Work\***.cs:line 332 
```

**紧随其后的 Windows 事件**

```
Attempting to load library 'xpstar.dll' into memory. 
 This is an informational message only. No user action is required. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T17:35:04.050

此消息意味着它确实联系了服务器，但无法打开连接字符串中指定的数据库（在异常消息中命名）。

检查事项：

1.  数据库存在于 SQL 服务器上并且它处于联机状态。
2.  用户有权访问指定的数据库。
3.  登录的默认数据库是正确的并且用户可以访问它。
4.  连接字符串没有被改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:33:14.233

事实证明，我们的一张桌子变得太大并且没有足够频繁地刷新。wright to database 方法超时，我们的 retry 方法抛出了错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T20:33:49.560

`xpstar.dll`没有突然加载。此 dll 托管管理工具使用的扩展存储过程。它在事件发生时加载的事实意味着服务器上存在管理工具活动。这为某人可能如何弄乱您的数据库（即使是暂时的）留下了许多途径。

下一步是检查[管理默认跟踪](http://msdn.microsoft.com/en-us/library/ms175513.aspx)，看看您是否可以在事件发生时找到任何活动。

# eclipse - 在编辑器中使任务标签加粗

> ID：15554088
> 
> 赞同：0
> 
> 时间：2013-03-21T17:21:36.750
> 
> 标签：eclipse, settings, eclipse-pdt

在 eclipse 的一个版本中（它在我不再可以访问的计算机上），当我输入一个任务标签时，`//TODO`或者`//FIXME`eclipse 会在编辑器中将其加粗，因此它脱颖而出。如何在带有 PDT 的 Eclipse 4.2.2 中打开此功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:49:11.913

我在 Window-Preferences-PHP-Editor-Syntax Coloring 下找到了这个设置。奇怪的是，我不得不更改 PHPDoc 选项，而不是 Task Tag 选项。

# amazon-s3 - s3fs permissions for s3 directory

> ID：15554094
> 
> 赞同：0
> 
> 时间：2013-03-21T17:22:05.043
> 
> 标签：amazon-s3, s3fs

I'm trying to mount the s3 directory to my EC2 instance. I'm getting everything to work except my user is not able to write to the mounted directory. I even ran with the `allow_other` permission set. Is there something else?

1.  I created the directory and made sure the permission was there for my current user
2.  I then mounted the s3 bucket using the `allow_other` option
3.  My user is able to read but not write...

Is there something else I need to do? I read the following sites for this:

[https://code.google.com/p/s3fs/issues/detail?id=185](https://code.google.com/p/s3fs/issues/detail?id=185)

[http://xentek.net/articles/448/installing-fuse-s3fs-and-sshfs-on-ubuntu/](http://xentek.net/articles/448/installing-fuse-s3fs-and-sshfs-on-ubuntu/)

[http://michaelaldridge.info/post/12086788604/mounting-s3-within-an-ec2-instance](http://michaelaldridge.info/post/12086788604/mounting-s3-within-an-ec2-instance)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:12:39.547

老实说，我不知道发生了什么。但是我重新启动了我的 EC2 实例并再次运行上述程序，它运行良好。

# excel - 将每个 Excel 行写入新的 .txt 文件，以 ColumnA 作为文件名

> ID：15554099
> 
> 赞同：2
> 
> 时间：2013-03-21T17:22:21.707
> 
> 标签：excel, vba

当我刚刚开始研究编写 Excel 宏时，我将非常感谢任何帮助。

我有大约 1,500 行和可变列长度的 Excel 文档，从 16 到 18。我想将文件的每一行写入一个新的 .txt 文件（实际上，我真的很想把它写成 .pdf 但我不认为这是可能的），其中文件的名称是对应的第一列. 另外，我希望每一行都用新行分隔。因此，理想情况下，宏将 1）将每一行导出为新的 .txt 文件（或 .pdf，如果可能），2）将每个文件命名为 ColumnA，3）每个新 .txt 文件的内容将包含 ColumnsB-长度总列 4) 每列由新行分隔。

例如，如果文档如下所示：

> 第 1 列//第 2 列// 第 3 列
> 
> 一个//a1//a2
> 
> b//b1//b2

我希望它输出为 2 个文件，分别命名为“a”、“b”。例如，文件“a”的内容是：

> a1
> 
> a2

我发现另外 2 个堆栈溢出线程解决了我的问题的各个部分，但我不知道如何将它们拼接在一起。

每一行到新的 .txt 文件，每列之间有一个换行符（但文件名不是 ColumnA）： [从 Excel 电子表格中的每一行创建文本文件](https://stackoverflow.com/questions/13077740/create-text-files-from-every-row-in-an-excel-spreadsheet)

只有一列合并到文件中，但文件名与 ColumnA 对应： [将 Excel 行输出到一系列文本文件](https://stackoverflow.com/questions/7149539/outputting-excel-rows-to-a-series-of-text-files)

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T18:10:01.640

要使内容成为文件末尾的 B 列，您可以执行以下操作。

在 B 列中的单元格上创建一个简单的循环。这定义了每行的列范围，并根据 A 列中的值设置文件名。

```
Sub LoopOverColumnB()

Dim filePath as String
Dim fileName as String
Dim rowRange as Range
Dim cell as Range

filePath = "C:\Test\" '<--- Modify this for your needs.

For each cell in Range("B1",Range("B1048576").End(xlUp))
   Set rowRange = Range(cell.address,Range(cell.address).End(xlToRight))

   fileName = filePath & cell.Offset(0,-1).Value

   '
   ' Insert code to write the text file here 
   '
   ' you will be able to use the variable "fileName" when exporting the file
Next
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T17:43:54.050

我最终将以下内容拼接在一起来解决我的问题，这完全感谢@David 和@Exactabox。它效率极低并且有冗余位，但它运行（非常。缓慢）。如果有人知道如何清理它，请随意，否则它可以完成工作。

[编辑] 不幸的是，我现在意识到虽然这个宏将每一行导出为一个适当命名的新 .txt 文件，但每个文本文件的内容是文档的最后一行。因此，即使它将所有 20 行导出为 20 个具有适当文件名和正确格式的 .txt 文件，这 20 个文件中每个文件的实际内容都是相同的。我不确定如何纠正这个问题。

```
Sub SaveRowsAsTXT()

Dim wb As Excel.Workbook, wbNew As Excel.Workbook
Dim wsSource As Excel.Worksheet, wsTemp As Excel.Worksheet
Dim r As Long, c As Long
Dim filePath As String
Dim fileName As String
Dim rowRange As Range
Dim cell As Range

filePath = "C:\filepath\"

For Each cell In Range("B1", Range("B1048576").End(xlUp))
   Set rowRange = Range(cell.Address, Range(cell.Address).End(xlToRight))

   fileName = filePath & cell.Offset(0, -1).Value

    Set wsSource = ThisWorkbook.Worksheets("Sheet1")

    Application.DisplayAlerts = False 'will overwrite existing files without asking

    r = 1
    Do Until Len(Trim(wsSource.Cells(r, 1).Value)) = 0
        ThisWorkbook.Worksheets.Add ThisWorkbook.Worksheets(1)
        Set wsTemp = ThisWorkbook.Worksheets(1)

        For c = 2 To 16
            wsTemp.Cells((c - 1) * 2 - 1, 1).Value = wsSource.Cells(r, c).Value
        Next c

        wsTemp.Move
        Set wbNew = ActiveWorkbook
        Set wsTemp = wbNew.Worksheets(1)
        wbNew.SaveAs fileName & ".txt", xlTextWindows 'save as .txt
        wbNew.Close
        ThisWorkbook.Activate
        r = r + 1
    Loop

    Application.DisplayAlerts = True

Next
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-02T22:02:22.207

这应该可以解决在所有文件中获取相同数据的问题：

```
Sub SaveRowsAsTXT()

Dim wb As Excel.Workbook, wbNew As Excel.Workbook
Dim wsSource As Excel.Worksheet, wsTemp As Excel.Worksheet
Dim r As Long, c As Long
Dim filePath As String
Dim fileName As String
Dim rowRange As Range
Dim cell As Range

filePath = "C:\Users\Administrator\Documents\TEST\"

For Each cell In Range("B1", Range("B10").End(xlUp))
    Set rowRange = Range(cell.Address, Range(cell.Address).End(xlToRight))

    Set wsSource = ThisWorkbook.Worksheets("Sheet1")

    Application.DisplayAlerts = False 'will overwrite existing files without asking

    r = 1
    Do Until Len(Trim(wsSource.Cells(r, 1).Value)) = 0
        ThisWorkbook.Worksheets.Add ThisWorkbook.Worksheets(1)
        Set wsTemp = ThisWorkbook.Worksheets(1)

        For c = 2 To 16
            wsTemp.Cells((c - 1) * 2 - 1, 1).Value = wsSource.Cells(r, c).Value
        Next c
        fileName = filePath & wsSource.Cells(r, 1).Value

        wsTemp.Move
        Set wbNew = ActiveWorkbook
        Set wsTemp = wbNew.Worksheets(1)

        wbNew.SaveAs fileName & ".txt", xlTextWindows 'save as .txt
        wbNew.Close
        ThisWorkbook.Activate
        r = r + 1
    Loop

    Application.DisplayAlerts = True

Next
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-01T14:25:43.273

@danfo，我不知道这对您是否有用，但经过一番摆弄，我确实做到了。我需要确保我所有的顶行都没有空格或特殊字符；我的左栏需要是 ID 号，而不是日期或其他任何东西——但一旦我修复了这些东西，它就可以正常工作了。

# perl - 无法使用循环中的计数器访问数组元素

> ID：15554104
> 
> 赞同：0
> 
> 时间：2013-03-21T17:22:38.120
> 
> 标签：perl

我正在尝试遍历两个大小相等的数组，并用在每个索引处找到的元素替换一个字符串。

循环只做第一个元素。

```
#!/usr/bin/perl
use strict;
use warnings;

# SQL statement for string replace
my $insert = "INSERT INTO table ( JOB, URI ) VALUES ( 'JOB', 'URL' );";
#array of jobs
my @jobs = ("job1", "job2");
#array of url's
my @urls = ("http://www.yahoo.com", "http://www.google.com");

# for each job replace the "URL" with a url from 
# the url array, then print the new sql insert statement
for( my $i = 0; $i <= $#jobs; $i++ ){
    $insert =~ s/URL/$urls[$i]/g;
    print $insert."\n";
} 
```

编辑-使用 $i<=$#urls 现在具有正确的循环大小，但对 $urls[$i] 的调用永远不会在该数组中获得不同的元素。它总是相同的元素

我认为这是我正在做的字符串替换的问题，循环将按预期打印出元素，但当我在字符串替换中使用计数器时不会。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T19:26:02.883

第一次迭代后，`$insert`不再满足`URI`

将循环更改为：

```
for( my $i = 0; $i <= $#jobs; $i++ ){
    my $temp = $insert;
    $temp =~ s/URL/$urls[$i]/g;
    print $temp,"\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T19:26:11.177

为了回答插入语句中的字符串替换问题，我试图更改该字符串中的文本，然后下一个循环进行相同的搜索和替换，但字符串中不再有要匹配的 URL，我应该将该变量移到循环内部。

```
#!/usr/bin/perl
use strict;
use warnings;

#array of jobs
my @jobs = ("job1", "job2");
#array of url's
my @urls = ("http://www.yahoo.com", "http://www.google.com");

# for each job replace the "URL" with a url from 
# the url array, then print the new sql insert statement
for( my $i = 0; $i <= $#jobs; $i++ ){
    # SQL statement for string replace
    my $insert = "INSERT INTO table ( JOB, URI ) VALUES ( 'JOB', 'URL' );";
    $insert =~ s/URL/$urls[$i]/g;
    print $insert."\n";
} 
```

感谢所有帮助过的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:27:00.427

`$#jobs``1`在您的情况下，获取最后一个元素的最后一个索引位置。然后循环是 from`0`到`0`。改为使用`@jobs`它来获取元素的总数，并在 和 之间进行`0`循环`1`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:30:03.160

尝试这样做：

```
foreach my $i (0 .. $#jobs) { print "$i\n"; } 
```

# java - 在 jtable 中显示字符串和日期数据类型

> ID：15554105
> 
> 赞同：0
> 
> 时间：2013-03-21T17:22:38.443
> 
> 标签：java, swing, jtable

我有一个包含字符串和日期数据类型列的 jtable。但是现在每个信息都以字符串数据的形式呈现，我想在 jtable 的日期列中呈现日期数据类型。

我还提供了以下数据模型的代码

```
public class MyTableModel extends AbstractTableModel {

    private List<List<Object>> dataList = new ArrayList<>();
     private String[] header = { "ID","SUBJECT","LETTTER FROM","LETTER DATE","DATE RECEIED",
                                  "REMARKS","DATE DISPATCHED","DESTINATION OFFICE"};

    public List<List<Object>> getDataList() {
        return dataList;
    }

    public void setDataList(List<List<Object>> dataList) {       
        this.dataList = dataList;
        fireTableDataChanged();       
        fireTableStructureChanged();        
    }

    public void setHeader(String[] header) {
        this.header = header;
    }

    public String[] getHeader() {
        return header;
    }

    @Override
    public int getRowCount() {
        return dataList.size();
    }

    @Override
    public int getColumnCount() {
        return header.length;
    }

    @Override
   public String getColumnName(int col) {
    return header[col];
   }

    @Override
    public Object getValueAt(int row, int col) { 
    return dataList.get(row).get(col);
    }

} 
```

任何建议都是 jtable 的新手

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:29:35.363

覆盖`getColumnClass`方法：

```
@Override
public Class<?> getColumnClass(int columnIndex) {
    if (isDate(columnIndex)) {
        return Date.class;
    }
    else {
        return String.class;
    }
} 
```

# youtube-api - 通过 CMS 帐户使用 YouTube Analytics API

> ID：15554106
> 
> 赞同：7
> 
> 时间：2013-03-21T17:22:38.710
> 
> 标签：youtube-api, analytics, youtube-analytics

尝试使用 CMS 帐户获取 youtube 分析 api 数据时，我收到 403 Forbidden 错误。

只是为了确认一下，CMS 帐户与服务帐户是一回事吗？

我可以获取 oauth2 用户拥有的频道的分析数据，但我可以通过我的 CMS 帐户访问但不是其内容所有者的任何其他频道上的 403。（我在 CMS 帐户上具有管理员帐户级别，并且我收到 403 错误的频道具有“托管”关系）

问题：是否有计划让 youtube.analytics api 支持查询在 CMS 帐户下管理的频道？

似乎因为我可以使用该帐户使用 CMS UI 获取这些渠道的所有分析数据，所以我应该能够使用 API 执行相同的操作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T20:41:31.743

YouTube 内容管理系统帐户与[服务帐户](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)不同。如果您作为服务帐户进行身份验证，您将无法使用 YouTube API，因为该服务帐户将无法访问任何实际的 YouTube 频道。但是，作为 CMS 帐户进行身份验证将为您提供所需的内容。

其中很多内容最近都投入了生产，所以让我在这里列出完整的步骤，解释拥有 YouTube CMS 访问权限的人如何针对他们管理的频道和视频运行 YouTube Analytics API 报告。

（可选）通过 OAuth 2 授权作为 CMS 帐户，同时使用`https://www.googleapis.com/auth/youtube.readonly`和范围，使用以下参数`https://www.googleapis.com/auth/youtubepartner`进行 YouTube 数据 API v3 [channels.list()](https://developers.google.com/youtube/v3/docs/channels/list)`part=snippet,contentDetails`调用： , `managedByMe=true`, `maxResults=50`, `onBehalfOfContentOwner=CONTENT_OWNER_ID`。`CONTENT_OWNER_ID`是您必须在此处硬编码的一个值，它应该设置为您的 YouTube CMS 帐户的“合作伙伴代码”。这将为您提供您的 CMS 帐户管理的最多 50 个频道的列表。（如果您需要超过 50 个，则需要对结果进行分页。）每个频道的 id 将在[channel.id](https://developers.google.com/youtube/v3/docs/channels#id)中返回，以及其他有用的信息（如上传列表 id，如果您想获取列表该频道中的视频）也将返回。

如果您已经知道`UC...`要针对其运行报告的频道的频道 ID，则可以跳过该步骤并直接转到 Analytics 报告。

要在受管频道上运行频道级报告，同时获得 CMS 帐户的授权，请使用以下参数[发出 YouTube Analytics API 请求](https://developers.google.com/youtube/analytics/v1/)`ids=contentOwner==CONTENT_OWNER_ID`： 、`filters=channel==UC...`，然后是您想要的任何其他报告参数。

要运行视频级报告，请设置`ids=contentOwner==CONTENT_OWNER_ID`和`filters=video==VIDEO_ID`，其中`VIDEO_ID`CMS 帐户管理的任何频道中的任何视频的 id。

[文档中](https://developers.google.com/youtube/analytics/v1/content_owner_reports)有更多关于内容所有者报告的详细信息。

# vim - 尝试在 VIM 中更新信息时出现“E20：标记未设置”

> ID：15554107
> 
> 赞同：5
> 
> 时间：2013-03-21T17:22:43.177
> 
> 标签：vim

我在使用函数更新 VIM 中的信息时遇到了麻烦。我的代码如下：

```
map <F4> :call UpdateTitle()<cr>'s
"Update the latest modification time and filename
function UpdateTitle()
    normal m'
    execute '/# *Last modified:/s@:.*$@\=strftime(": %Y-%m-%d %H:%M")@'
    normal ''
    normal mk
    execute '/# *Filename:/s@:.*$@\=": ".expand("%:t")@'
    execute "noh"
    normal 'k
    echohl WarningMsg | echo "Successful in updating the copyright." | echohl None
endfunction 
```

当我按下`F4`VIM 时，它确实有效。但它总是将错误消息显示为`E20: Mark not set`. 我认为错误发生在最后两行。但我找不到解决方案。
我试过了`echoerr`。它有效，但不是我什么。我一个人尝试`echomsg`过`echo`。但它不起作用。没有消息输出。但错误消息显示为`E20: Mark not set`。

此外，即使我删除了整个回声线。同样的错误再次出现。

VIM 版本是 7.0.237。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T17:30:58.377

```
E20: Mark not set 
```

通常这意味着你试图跳到一个不存在的标记。

看看你的地图：

```
map <F4> :call UpdateTitle()<cr>'s 
```

结尾是什么`'s`？你有标记`s`吗？

*   此错误消息将清除您的消息（在您的函数中回显）。这就是为什么你看不到它。
*   该功能有效，因为它发生在您的“错字”之前

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-05-19T23:58:22.610

如果您是**偶然**`E20: Mark not set`看到的，您可以继续执行您尝试运行的命令。

 **例如，点击`i`进入编辑模式，消息将消失。

我试图输入一个反引号```，后跟字母，以为我处于编辑模式，这恰好是您跳转到标记的方式（请参阅[使用标记](https://vim.fandom.com/wiki/Using_marks)）。**

# haskell - 如何正确为嵌套函数调用加上括号？

> ID：15554114
> 
> 赞同：1
> 
> 时间：2013-03-21T17:23:06.083
> 
> 标签：haskell, syntax, parentheses

鉴于这两个功能：

```
drex :: (Int,Int) -> [[String]] -> String

rcgmove :: String -> (Int,Int) -> (Int,Int) 
```

当这样调用时：

```
drex ((rcgmove b (x,y)) xs) 
```

是一个错误，因为`xs`is`rcgmove`的第三个参数。但是，我想`xs`成为`drex`第二个论点。我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T18:50:45.020

> xs 伪装成 rcgmove 函数的第三个参数，并给出错误。但是我希望 xs 成为 drex 函数的第二个参数，你可以猜到。如何将 xs 作为 drex 的第二个参数？

只需删除最外面的括号：

```
drex (rcgmove b (x,y)) xs 
```

# java - Mockito UnfinishedStubbingException

> ID：15554119
> 
> 赞同：25
> 
> 时间：2013-03-21T17:23:15.107
> 
> 标签：java, mockito

我是 Mockito 的新手，我试过调查这个异常，但我还没有找到具体的答案。当我一起使用两个模拟时，它会在我的代码中发生，这意味着我通过一个模拟的构造函数，另一个模拟。像这样：

```
...
OperationNode child = getNode(Operation.ADD);
child.insertNode(getConstantNode(getIntegerValue(2));
...

 private ConstantNode getConstantNode(NumericalValue value){
    ConstantNode node = Mockito.mock(ConstantNode.class);
    Mockito.when(node.evaluate()).thenReturn(value);
    Mockito.when(node.toString()).thenReturn(value.toString());
    return node;
}

private IntegerValue getIntegerValue(int number) {
   IntegerValue integerValue = Mockito.mock(IntegerValue.class);
   Mockito.when(integerValue.getValue()).thenReturn(number);
   Mockito.when(integerValue.toString()).thenReturn(Integer.toString(number));
   return integerValue;
} 
```

在一个论坛中，我读到了关于不通过另一个模拟的构造函数发送模拟的信息，因为 Mockito 可能会对模拟调用感到困惑，所以我尝试了以下方法：

```
NumericalValue value = getIntegerValue(2);
child.insertNode(getConstantNode(value)); 
```

但无济于事。我确保只有方法`toString()`和`getValue()`被调用，因为这些是该类唯一的方法。我不明白发生了什么事。

我也尝试过单独使用模拟，看看我是否做错了什么：

```
child.insertNode(new ConstantNode(getIntegerValue(2))); 
```

这完美无缺。

```
child.insertNode(getConstantNode(new IntegerValue(2))); 
```

这也很好。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-21T23:37:42.033

根据我在 mockito ( [https://code.google.com/p/mockito/issues/detail?id=53](https://code.google.com/p/mockito/issues/detail?id=53) ) 的“问题 53”上阅读的内容，由于 Mockito 中涉及的验证框架，我的代码遇到了问题。正是以下代码本身导致了异常。

```
private ConstantNode getConstantNode(NumericalValue value){
    ConstantNode node = Mockito.mock(ConstantNode.class);
    Mockito.when(node.evaluate()).thenReturn(value);
    Mockito.when(node.toString()).thenReturn(value.toString());
    return node;
} 
```

如果您从我的代码中记得，参数值也是一个 MOCK，因此当`value.toString()`在`thenReturn()`已`thenReturn()`被调用/验证/等。因此，如果发生这种情况， `Mockito.when(node.toString()).thenReturn(value.toString()` **将不会被验证**，因为它还没有从`valute.toString()`开始 整个“验证一切”链。

我如何修复它：

```
private ConstantNode getConstantNode(NumericalValue value){
    ConstantNode node = Mockito.mock(ConstantNode.class);
    Mockito.when(node.evaluate()).thenReturn(value);

    String numberToString = value.toString();

    Mockito.when(node.toString()).thenReturn(numberToString);
    return node;
} 
```

这样，它**可以**被验证。我发现这是一种完整的代码异味，因为我将不得不留下一条注释来解释为什么我在代码中使用了一个看似无用的中间变量。

谢谢您的帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-22T02:22:21.437

已经在这个问题中发布了一些很好的修复，但是对于仍然无法理解它的任何人，请考虑 Java 调用所有这些方法的顺序。根据[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/index.html)，Java[在调用方法之前从左到右评估方法的每个参数](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.7)：

1.  `integerValue.getValue()`, Mockito 记录的
2.  `when`, Mockito 接受最后一次调用 (to `integer.getValue`) 并开始设置存根
3.  `value.toString`，这是 Mockito 记录的模拟调用
4.  `thenReturn`在树桩上

Mockito 抱怨正是因为对模拟的调用，步骤 3，发生*在*步骤 2 ( `when`) 之后但*在*步骤 4 ( `thenReturn`) 之前，导致验证框架抱怨存根。乔伊，您的回答将麻烦的步骤 3 移到步骤 1 之前，这很好；Sajan 将其从语句中完全删除，这也很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T18:02:40.640

我认为问题在于线路

`Mockito.when(node.toString()).thenReturn(value.toString());`在方法中`getConstantNode`

尝试删除该行并检查它是否有效。也许你可以做类似的事情

```
int num = 2;
child.insertNode(getConstantNode(getIntegerValue(num), num);
...

 private ConstantNode getConstantNode(NumericalValue value){
    ConstantNode node = Mockito.mock(ConstantNode.class);
    Mockito.when(node.evaluate()).thenReturn(value);
    Mockito.when(node.toString()).thenReturn(Integer.toString(number));
    return node;
}

private IntegerValue getIntegerValue(int number) {
   IntegerValue integerValue = Mockito.mock(IntegerValue.class);
   Mockito.when(integerValue.getValue()).thenReturn(number);
   return integerValue;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:39:07.153

我认为这是调用顺序和 Mockito 框架验证的问题。试试这个，看看它是否有帮助：

```
...
OperationNode child = getNode(Operation.ADD);
IntegerValue value = getIntegerValue(2);
ConstantNode node =  Mockito.mock(ConstantNode.class);
Mockito.when(node.evaluate()).thenReturn(value);
Mockito.when(node.toString()).thenReturn(value.toString());
child.insertNode(node);

...

private IntegerValue getIntegerValue(int number) {
   IntegerValue integerValue = Mockito.mock(IntegerValue.class);
   Mockito.when(integerValue.getValue()).thenReturn(number);
   Mockito.when(integerValue.toString()).thenReturn(Integer.toString(number));
   return integerValue;
} 
```

来源：[https ://code.google.com/p/mockito/issues/detail?id=53](https://code.google.com/p/mockito/issues/detail?id=53)

# jquery - “清除网址”删除单独页面之间的哈希

> ID：15554120
> 
> 赞同：0
> 
> 时间：2013-03-21T17:23:17.913
> 
> 标签：jquery

我有一个单独工作的标签系统。问题是，如果有人单击指向具有类似选项卡系统的另一个页面的链接，即使使用不同的类，过去的哈希也会被存储。

所以，假设他们在第 1 页，打开的标签结束了 url，如：/dept/waste-recycling-programs?whatToRecycle#whatToRecycle

然后，转到第 2 页，它有一个完全不同的 url，/dept/facilities/?goals2013#whatToRecycle

所以有人点击了“2013年目标”，这导致了一个不同的网址并像它应该的那样添加了“？goals2013”​​，但随后它附加了“#whatToRecycle”。这是在上一页中使用选项卡系统单击的最后一个选项卡。

如果我能弄清楚如何在页面加载时调用一些函数来清除所有内容？然后，它应该工作，我在想。

问题是左侧导航栏具有指向特定选项卡的所有链接，因此某人不必来到第 1 页或第 2 页，然后单击说第三个选项卡。他们单击任一页面上的第三个选项卡，点击该页面，该选项卡已打开。

链接列表的 HTML：

```
<ul class="enviroNav">
    <li class="bottomBorder"><a href="?">WHAT WE DO</a></li>
    <li class="liWithSubs"><a href="/departments/site-facilities/environment">ENVIRONMENT</a></li>
    <li><a href="/departments/site-facilities/iso-14001?iso14001">ISO 14001</a></li>
    <li class="doubleIndentLi"><a href="/departments/site-facilities/iso-14001?environmentalPolicy">-Environmental Policy</a></li>
    <li class="doubleIndentLi"><a href="/departments/site-facilities/iso-14001?impactAreas">-Impact Areas</a></li>
    <li class="doubleIndentLi"><a href="/departments/site-facilities/iso-14001?goals2013">-2013 Goals</a></li>
    <li><a href="/departments/site-facilities/environment/waste-recycling-programs?whatToRecycle">Recycling/Waste</a></li>
    <li class="doubleIndentLi"><a href="/departments/site-facilities/environment/waste-recycling-programs?whatToRecycle">-What To Recycle</a></li>
    <li class="doubleIndentLi"><a href="/departments/site-facilities/environment/waste-recycling-programs?whereToRecycle">-Where to Recycle</a></li>
    <li class="doubleIndentLi"><a href="/departments/site-facilities/environment/waste-recycling-programs?quickTips">-Quick Tips</a></li>
    <li class="doubleIndentLi"><a href="/departments/site-facilities/environment/waste-recycling-programs?seeResults">-See Results</a></li>
    <li class="bottomBorder"><a href="#">Energy</a></li>
    <li class="liWithSubs"><a href="#">COMMUNITY</a></li>
    <li><a href="#">-Upcoming Events</a></li>
    <li class="bottomBorder"><a href="?">-Past Activities</a></li>
    <li class="liWithSubs"><a href="?">HOW WE&#39;RE DOING</a></li>
    <li><a href="#">-See the Results</a></li>
    <li class="bottomBorder"><a href="#">-Success Stories</a></li>
    <!--    <li class="bottomBorder"><a href="#">WHY WE CARE</a></li>
    <li class="bottomBorder"><a href="#">EMPLOYEE WELLNESS</a></li>-->
    <li class="bottomBorder"><a href="/departments/site-facilities/ehs-training">ENVIRONMENTAL HEALTH &amp; SAFETY(EHS) PROGRAM</a></li>
    <li><a href="?">COMMUNITY LINKS</a></li>
</ul> 
```

此例程有效：

```
 function setupSubNav(){
  pathName = window.location.href;
  $('.hiddenSection').css('display','none');
  pathArray = pathName.split('#');
  param = pathArray[pathArray.length-1];
  if(pathArray.length>1){
    showWasteSection(param,$('.' + param + 'Trigger'));
  }
  else
  {
     if ($('body.fervens-a .pageTabsWaste li')) {
        var sectionNameWaste = $($('body.fervens-a .pageTabsWaste li')[0]).attr('class').split('Trigger')[0];
            showWasteSection(sectionNameWaste, $($('body.fervens-a .pageTabsWaste li')[0]));
        }
  }
    $('body.fervens-a .pageTabsWaste li').click(function(){
        if (!($(this).hasClass('current'))) {
            var sectionNameWaste = $(this).attr('class').split('Trigger')[0];
            showWasteSection(sectionNameWaste, $(this));
        }
    });
}
    function showWasteSection(sectionNameWaste,$navObj) {
    if (sectionNameWaste != 'whatToRecycle' && sectionNameWaste != 'whereToRecycle' &&       sectionNameWaste != 'quickTips' && sectionNameWaste != 'seeResults') {
        sectionNameWaste = 'whatToRecycle';
        $navObj = $($('body.fervens-a .pageTabsWaste li')[0]);
    }
        $('body.fervens-a .pageTabsWaste li').removeClass('current');
        $navObj.addClass('current');
        $('.hiddenSection').css('display','none');
        $('#' + sectionNameWaste + 'Content').css('display','block');
        window.location.hash = sectionNameWaste;
    } 
```

尽管我前段时间把它放在一起，但当时我并没有在超过一个页面上使用它，所以现在我试图强制清除 URL。这是在 Drupal 6 站点内，它在 Intranet 内部，所以我必须支持 IE7+。不能乱用 HTML5 存储等。

有没有办法在点击导航列表中的任何链接时擦除 url？如果以某种方式出现，我不关心性能问题或迭代。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T20:25:56.650

也许我不完全理解你想要完成什么，但这将避免在位置末尾附加哈希的函数，如果 url 包含“？” 象征。

```
function showWasteSection(sectionName, $navObj) {
    if (sectionName != 'whatToRecycle' && sectionName != 'whereToRecycle' && sectionName != 'quickTips' && sectionName != 'seeResults') {
        sectionName = 'whatToRecycle';
        $navObj = $($('body.fervens-a .pageTabsWaste li')[0]);
    }
    $('body.fervens-a .pageTabsWaste li').removeClass('current');
    $navObj.addClass('current');
    $('.hiddenSection').css('display', 'none');
    $('#' + sectionName + 'Content').css('display', 'block');
    var location = String(document.location);
    if (location.indexOf("?") < 0)
        window.location.hash = sectionName;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:02:44.317

为了完整起见，答案是在检查参数的 if 语句中添加所有页面的所有部分名称：

```
function showWasteSection(sectionName, $navObj) {
    if (sectionName != 'whatToRecycle' && sectionName != 'whereToRecycle' && sectionName != 'quickTips' && sectionName != 'seeResults' && sectionName != 'iso14001' && sectionName != 'environmentalPolicy' && sectionName != 'impactAreas' && sectionName != 'goals2013' && sectionName != 'isoDocs') {
        sectionName = 'whatToRecycle';
        $navObj = $($('body.fervens-a .pageTabsWaste li')[0]);
    }
    $('body.fervens-a .pageTabsWaste li').removeClass('current');
    $navObj.addClass('current');
    $('.hiddenSection').css('display', 'none');
    $('#' + sectionName + 'Content').css('display', 'block');
    var location = String(document.location);
    if (location.indexOf("?") < 0)
        window.location.hash = sectionName;
} 
```

在末尾添加 var 位置并删除 ? （由上面的 Hanlet 提供）清理了 url 作为奖励，所以再次感谢你！

# android - 如何将颜色值动态传递给xml

> ID：15554122
> 
> 赞同：4
> 
> 时间：2013-03-21T17:23:26.577
> 
> 标签：android, xml, colors

我有一个将绘制椭圆形的xml，代码如下：

```
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">
    <solid android:color="#61118"/>
    <stroke android:width="1sp" android:color="#1B434D" />
</shape> 
```

现在我在这里`android:color="#61118"`我需要从java类传递值，这可能吗？

如果没有，还有其他方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T17:33:25.060

遗憾的是，您不能将参数传递给 XML Drawables。

如果您没有太多不同的值，则可以使用 a[`<level-list>`](http://idunnolol.com/android/drawables.html#level-list)并提供不同版本的形状。

然后，您将更改与您的可绘制对象关联的级别以使用[`Drawable.setLevel(int)`](http://developer.android.com/reference/android/graphics/drawable/Drawable.html#setLevel%28int%29).

* * *

**my_drawable.xml**

```
<level-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:maxLevel="0">
        <shape android:shape="oval">
            <solid android:color="@color/red"/>
            <stroke android:width="1sp" android:color="@color/border" />
        </shape>
    </item>
    <item android:maxLevel="1">
        <shape android:shape="oval">
            <solid android:color="@color/green"/>
            <stroke android:width="1sp" android:color="@color/border" />
        </shape>
    </item>
    <item android:maxLevel="2">
        <shape android:shape="oval">
            <solid android:color="@color/blue"/>
            <stroke android:width="1sp" android:color="@color/blue" />
        </shape>
    </item>
</level-list> 
```

**我的活动.java**

```
// myView is a View (or a subclass of View) 
// with background set to R.drawable.my_drawable
myView.getBackground().setLevel(0); // Set color to red
myView.getBackground().setLevel(1); // Set color to green
myView.getBackground().setLevel(2); // Set color to blue

// myImageView is an ImageView with its source
// set to R.drawable.my_drawable
myImageView.setImageLevel(0); // Set color to red
myImageView.setImageLevel(1); // Set color to green
myImageView.setImageLevel(2); // Set color to blue 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-21T01:25:22.297

是的，您可以动态更改形状的颜色。假设你的 xml 在，'res/drawable/oval_shape.xml'

```
GradientDrawable shape = (GradientDrawable) getResources().getDrawable(R.drawable.oval_shape);
int argb = 0x12345678;
shape.setBackground( argb ); 
```

如果您想更改边框颜色

```
int width = 1;
int argb = 0x87654321;
shape.setStroke( width, argb ); 
```

此解决方案提供了比使用级别列表更大的灵活性，因为您不必使用视图来设置级别。

# javascript - 如何使 jQuery tabs() 100% 高且内容可滚动

> ID：15554123
> 
> 赞同：6
> 
> 时间：2013-03-21T17:23:30.367
> 
> 标签：javascript, jquery, html, css, css-float

我正在尝试创建一个带有标签的 JS Web 应用程序。界面的特点是选项卡应该和窗口一样高，如果高于窗口，内容应该滚动。内容由填满屏幕的几个左浮动面板组成。

我已经有部分解决方案在工作，但我不知道如何设置*100% 高度和容器的滚动*。

[http://jsfiddle.net/KhwZS/1242/](http://jsfiddle.net/KhwZS/1242/)

```
<div class="tabs">
<ul>
    <li><a href="#tab1">Tab1</a></li>
</ul>
<div id="tab1">
    <div class="container clearfix">
        <div class="floated"></div>
        <div class="floated"></div>
        <div class="floated"></div>
    </div>
</div> 
```

![带有滚动内容的 jQuery 选项卡](../Images/543c12d05c334c47c5f11ee4d3521ddd.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T17:44:02.607

[http://jsfiddle.net/KhwZS/1245/](http://jsfiddle.net/KhwZS/1245/)

CSS：

```
 html, body {
    height: 100%;
}
.tabs {
height: 100%; 
```

}

```
#tab1 {
    height: 100%;
    overflow: auto;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-08T13:36:22.783

也许你已经解决了这个问题，但这里有一个 position: absolute 的解决方案，它对我们有用。可能是你的起点。/斯塔凡

```
 .tabs{
position: absolute;
top: 0px;
left: 0px;
bottom: 0px;
right: 0px;
margin: 0px;
}

.ui-tabs .ui-tabs-nav {
position: absolute;
top: 0;
left: 0px;
height: 18px;
right: 0;
}

.ui-tabs-panel {
position: absolute;
top: 18px;
left: 0;
bottom: 0;
right: 0;
overflow: auto;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:20:31.530

见[演示](http://jsfiddle.net/KhwZS/1246/)。

使用 CSS 固定 UI 选项卡`position:fixed`。

```
.ui-tabs-nav {
    position: fixed;
    width: 100%;
} 
```

然后使用 jQuery 给内容 a`margin-top`以便它们默认显示在 UI 选项卡下方。

```
$("#tab1").css("margin-top", $(".ui-tabs-nav").height()); 
```

# javascript - 定位 iframe 正文并删除 nodeType 3 (=text)

> ID：15554125
> 
> 赞同：1
> 
> 时间：2013-03-21T17:23:39.193
> 
> 标签：javascript, jquery

我正在尝试访问 iframe 的内容，但由于某种原因它不起作用。我可以这样做，这将起作用：

```
$('iframe').load(function (){

$('#iframeID').contents().find('SOMETHING').remove();

}); 
```

除了这段代码之外，其他任何东西都可以工作：

```
$('iframe').load(function (){

$('#iframeID').contents().find('body *:not(.ThisClass *)').contents().filter(function() {
  return this.nodeType == 3;
}).remove();

}); 
```

它应该工作，但它没有。可能是什么问题呢？我的控制台中没有错误。

# c++ - 是什么阻止了编译器对强异常安全代码重新排序的优化？

> ID：15554127
> 
> 赞同：3
> 
> 时间：2013-03-21T17:23:49.880
> 
> 标签：c++, compiler-optimization, exception-safety

鉴于 Jon Kalb 的强异常安全代码来解决 Cargill Widget 示例，是什么阻止了编译器重新组织操作，从而使代码不是强异常安全的？

```
#include <algorithm> // std::swap

template< typename T1, typename T2 >
class Cargill_Widget
{
public:
    Cargill_Widget& operator=( Cargill_Widget const& r_other )
    {
        using std::swap;

        T1 temp_t1( r_other.m_t1 ); // may throw
        T2 temp_t2( r_other.m_t2 ); // may throw
        /* The strong exception-safety line */
        swap( m_t1, temp_t1 ); // no throw
        swap( m_t2, temp_t2 ); // no throw

        return *this;
    }

private:
    T1 m_t1;
    T2 m_t2;
}; 
```

是“编译器不能改变*可观察行为*”规则吗？

参考：

*   Jon Kalb 的“异常安全代码”演示幻灯片： [http ://www.exceptionsafecode.com/slides/esc.pdf](http://www.exceptionsafecode.com/slides/esc.pdf)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:56:01.273

您自己说过：编译器不能做任何可能修改可观察行为的事情。并且有义务考虑可能的例外情况。因此，对重新排序的限制可能会对优化产生重大的负面影响。实际上，有两种情况需要考虑：编译器不知道被调用的函数中发生了什么，因此无法在它们之间重新排序，或者编译器确实有能力优化跨翻译单元，在这种情况下，它通常能够确定该函数不会抛出（假设它不会抛出），因此重新排序就像它忽略了异常一样。或者不重新排序，如果抛出异常可能会导致可观察行为发生变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:57:00.677

任何优化都必须保留代码的可证明属性。否则任何代码都可以用一个什么都不做并且速度最快的程序来代替。例外的影响是可证明性质的一部分。

# java - 验证类层次结构覆盖

> ID：15554128
> 
> 赞同：1
> 
> 时间：2013-03-21T17:23:53.307
> 
> 标签：java, hibernate, validation, hibernate-validator

是否可以覆盖类层次结构以进行 hibernate/javax 验证？或者如何通过扩展类来覆盖参数验证？

使用`@Valid`注释并在我的类中设置了 javax 验证注释。我想要一个扩展类，其中删除了验证。我发现休眠验证循环遍历整个类层次结构，甚至在超类中检查验证。我从使用 Spring MVC 设置的基于 Json 的 REST API 中使用它。

例子：

```
public class Parent {
    protected Integer numChildren;

    @NotNull(message = "NumChildren has to be set.") 
    @Size(min 1, max 10, message = "A partent has to have at least one kid.")
    public Integer getNumChildren() {
        return numChildren;
    }

    public void setNumChildren(Integer numChilds) {
        this.numChildren = numChilds;
    }
}

public class Child extends Parent {

    // A child doesnt have to have kids, but can, so I want to override this parameter
    // and remove the validation requirement, and make it just optional.
    @Override
    public Integer getNumChildren() {
        return super.numChildren;
    }
} 
```

最好的问候，马库斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T09:20:46.867

Bean Validation does not allow to disable/change constraints in super classes. Constraints are always combined. I guess the way to go would be via groups, eg a *ParentChecks* group and a *ChildChecks* group. Assign the constraints which are specific to parent of child to the corresponding group. You can then redefine the default group for parent to be *ParentChecks*,_Parent_ and the one for child to be *ChildChecks*, *Child*. That should work.

# objective-c - 目标 C：为什么 Button 会移动？

> ID：15554129
> 
> 赞同：0
> 
> 时间：2013-03-21T17:23:53.217
> 
> 标签：objective-c, xcode, button

我的应用程序中有一个相当奇怪的错误。每当我按下使方法进入“if”的第二个按钮时，我的一个按钮就会向左移动一点。

它看起来像这样：http: [//img823.imageshack.us/img823/3686/30000000.jpg](http://img823.imageshack.us/img823/3686/30000000.jpg)

我的应用程序：我连续有 12 个按钮，上面有字母。每个按钮上方都有一个标签。标签被称为Label0，Label1，Label 2，... String myString中有一个单词。如果按下的按钮上有单词的第一个字母-> 将其写在第一个标签中-> 查看单词的第二个字母...

```
/// Global ///
start = 4;
letterCount = start; 
currentChar = [NSString stringWithFormat:@"%c",[myString characterAtIndex:0]];

- (IBAction)pushButton:(id)sender { 

UILabel *label = [self valueForKey:[NSString stringWithFormat:@"Label%i" , letterCount]];

if ([[sender currentTitle] isEqualToString:currentChar]) {
    label.text = currentChar;
    label.hidden = NO;

    if (letterCount-start < [myString length]-1) {
        letterCount++;
    }

    currentChar = [NSString stringWithFormat:@"%c",[myString characterAtIndex:letterCount-start]];
} 
```

该代码中没有任何东西可以用来欺骗按钮的位置。然而它的移动......每次......

我正在使用 xCode 4.6.1

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:26:40.293

Try removing that button and adding a new one (giving the new button the same name as the old one) and re-attach all of your IB stuff and see if that fixes it.

# regex - excel 中的模式匹配计数（正则表达式和 vba）

> ID：15554132
> 
> 赞同：2
> 
> 时间：2013-03-21T17:24:04.650
> 
> 标签：regex, excel, vba, pattern-matching

我有一个 Office 2007`.XLSX`文件，其中包含超过 5000 条记录，如下所示（一个包含多行文本的单元格）。问题：在相邻的单元格上，放置单元格中的事件计数。查看 A1 的单元格数据，您可以看到 3 个事件：

单元格 A1：

```
1/15/2013 1:30:11 AM Userx
Had to reboot system
1/15/2013 1:32:11 AM Userx
System running finished rebooting and appears to be working
11/15/2013 12:30:11 AM Userx
System hung again 
```

问题是日期值不一致。日、月和小时可以是一位数或两位数，但它们总是在新行上注明。

我的代码解决方案是获取单元格，在换行符处拆分它，在最后一个“：”之后修剪所有 5 个字符，并根据我的正则表达式评估结果。之后，一些基本的计数和文本插入到相邻的单元格。

下面是如何调用该函数的示例。

```
'calling function from another source:

thecount = CountOfDateValues(Range("a1").Value) 'get count
Range("b1").Value = thecount 'put count to adjacent cell 
```

是否有任何代码可以获取字符串值并将匹配计数返回给正则表达式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-21T09:00:08.267

您还可以使用 \n 在 Pattern 表达式中包含换行符。这样，您不必将文本拆分为数组：

```
Private Function String_CountRegExp_Debug()

    'Input of the test text
    Dim TestText As String
    TestText = "1/15/2013 1:30:11 AM Userx" & vbNewLine & _
            "Had to reboot system" & vbNewLine & _
            "1/15/2013 1:32:11 AM Userx" & vbNewLine & _
            "System running finished rebooting and appears to be working" & vbNewLine & _
            "11/15/2013 12:30:11 AM Userx" & vbNewLine & _
            "System hung again"

    'Input of the Pattern
    Dim RE_Pattern As String
    RE_Pattern = "(\d{1,2})\/(\d{1,2})\/(\d{4})\s(\d{1,2}):(\d{1,2}):(\d{1,2})\s([A,P]M).*\n"

    Debug.Print String_CountRegExp(TestText, RE_Pattern)

End Function

Public Function String_CountRegExp(Text As String, Pattern As String) As Long
'Count the number of Pattern matches in a string.

    'Set up regular expression object
    Dim RE As New RegExp
    RE.Pattern = Pattern
    RE.Global = True
    RE.IgnoreCase = True
    RE.MultiLine = True
    'Retrieve all matches
    Dim Matches As MatchCollection
    Set Matches = RE.Execute(Text)
    'Return the corrected count of matches
    String_CountRegExp = Matches.Count

End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T20:12:17.530

下面是一个函数的 VBA 代码，它接受一个字符串值并将匹配计数返回给正则表达式。我希望它对某人有用。

```
Function CountOfDateValues(thetext)

Dim data() As String 
Dim yourInput As String
yourInput = thetext 
Dim TheSplitter As String
TheSplitter = Chr(10) 'the character that represents a line break

data = Split(yourInput, TheSplitter ) ' creates an array of strings for each line in the cell
Dim re
Set re = CreateObject("VBscript.regexp")
'regular expression that matches ##/##/#### ##:##:## ##
re.Pattern = "(?=\d)^(?:(?!(?:10\D(?:0?[5-9]|1[0-4])\D(?:1582))|(?:0?9\D(?:0?[3-9]|1[0-3])\D(?:1752)))((?:0?[13578]|1[02])|(?:0?[469]|11)(?!\/31)(?!-31)(?!\.31)|(?:0?2(?=.?(?:(?:29.(?!000[04]|(?:(?:1[^0-6]|[2468][^048]|[3579][^26])00))(?:(?:(?:\d\d)(?:[02468][048]|[13579][26])(?!\x20BC))|(?:00(?:42|3[0369]|2[147]|1[258]|09)\x20BC))))))|(?:0?2(?=.(?:(?:\d\D)|(?:[01]\d)|(?:2[0-8])))))([-.\/])(0?[1-9]|[12]\d|3[01])\2(?!0000)((?=(?:00(?:4[0-5]|[0-3]?\d)\x20BC)|(?:\d{4}(?!\x20BC)))\d{4}(?:\x20BC)?)(?:$|(?=\x20\d)\x20))?((?:(?:0?[1-9]|1[012])(?::[0-5]\d){0,2}(?:\x20[aApP][mM]))|(?:[01]\d|2[0-3])(?::[0-5]\d){1,2})?$"
re.Global = True

Dim t As String
Dim theCount As Integer
theCount = 0
For i = LBound(data) To UBound(data) 'from first item in array to last item in array

        For Each Match In re.Execute(Left(data(i), InStrRev(data(i), ":") + 5))
            'from start of string to 5 characters past the last ':' of string
            theCount = theCount + 1
        Next
    Next

CountOfDateValues = theCount 

End Function 
```

参考网址：

[MS Access 2003 VBA 字符串在换行符处拆分](https://stackoverflow.com/questions/1439384/ms-access-2003-vba-string-split-on-line-break)

[http://sourceforge.net/projects/regexbuilder/files/regexbuilder/1.4.0/](http://sourceforge.net/projects/regexbuilder/files/regexbuilder/1.4.0/)

该工具使针对各种日期格式测试我的正则表达式变得非常容易。

[http://regexlib.com/DisplayPatterns.aspx?cattabindex=4&categoryid=5&p=2](http://regexlib.com/DisplayPatterns.aspx?cattabindex=4&categoryid=5&p=2)

通过使用这里的预制正则表达式，我能够节省大量时间来制作正则表达式。遗憾的是，这样做并没有学到很多东西，但我相信我在“我们现在需要完成”的请求上节省了很多时间。

*注意：如果有人使用时间戳开始他们的工作日志记录，则会出现误报窗口，我向客户说明了这一点，他们对此很好。

# ios - 可达性类崩溃程序 - 不知道为什么

> ID：15554135
> 
> 赞同：5
> 
> 时间：2013-03-21T17:24:15.557
> 
> 标签：ios, exc-bad-access, reachability

对于需要在我的应用程序中联网的对象，我有一个“互联网感知”基类。所有需要互联网感知的对象都继承自它。正如你可以想象的那样，我分配和释放了很多这些对象。

Internet 感知基类具有以下代码，用于与用于检查 Internet 状态的 Reachability 类进行交互。

```
#import "Reachability.h"

- (id) init {
    ...
    self.internetReachable = [Reachability reachabilityForInternetConnection];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(checkNetworkStatus) name:kReachabilityChangedNotification object:nil];
    [self.internetReachable startNotifier];
    ...
  }
- (void)  dealloc
 {
    [self.internetReachable stopNotifier];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
 } 
```

一旦我的应用程序中的互联网状态发生变化，应用程序就会崩溃并出现以下错误：

> *** -[Reachability isKindOfClass:]：消息发送到已释放实例 0x1e249a30

我已经打开了僵尸，并将问题追溯到 Reachability.m 中的以下代码行

```
NSCAssert([(NSObject*) info isKindOfClass: [Reachability class]], @"info was wrong class in ReachabilityCallback"); 
```

不幸的是，除了停止监听 NSNotifcations 和停止通知程序之外，我不确定我的对象还能做些什么来避免这个错误。

任何帮助或建议都会很棒。

谢谢

维生素B

编辑：

好的，所以按照下面答案的建议，我在带有分配的工具中运行它，这就是保留计数历史。

![在此处输入图像描述](../Images/dbc98b53d8e7bfa9f36dd41d7083e3c0.png)

正如我所怀疑的那样，它是一个我释放的对象，它被 Foundation（即 NSNotifcationCenter）而不是我自己调用。

我的互联网对象有一个指向可达性对象的强指针。当它们被释放时，Reachability 对象也是如此。僵尸是可达性对象。在我的 Internet 对象的 dealloc 中，我调用了 removeObserver，但基础仍在调用已释放的对象。我不明白为什么...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T18:59:36.807

Foundation 仍在向 NSNotifcations 发送释放的可达性的原因是因为可达性对象在与创建它的线程不同的线程上被释放，即。可达性不是线程安全的。使用 dispatch_async 回到创建可达性对象的同一个队列已经解决了这个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-21T16:45:38.660

当您创建的用于实例化 Reachability 并因此持有对 Reachability 实例的引用的对象在没有（或之前）调用 stopNotifier 的情况下被解除分配时，就会发生这种情况！

解决这个问题非常简单。在您的对象从堆栈中删除之前，您必须调用 stopNotifier 来拆除您的 Reachability 实例。您可以在 dealloc 方法中执行此操作，或者如果它是 viewController，您可以在生命周期方法之一中调用它，例如 viewDidDisappear 等。

这里应该没有必要搞乱线程。考虑一下，当您在 Reachability 上调用 startNotifier 时，这件事通过 Reachability 的设计在后台线程上启动。因此，当您调用 stopNotifier 时，它会为您处理线程。

您不得不与线程混淆的原因与您持有对可达性的引用的对象被释放但仍然是网络更改的注册侦听器这一事实有关，这发生在 startNotifier 中。当网络发生变化时，你猜怎么着，你的对象，虽然仍然注册接收通知，却无处可寻！崩溃的崩溃。stopNotifier 在它死之前注销它，一切都很好。

```
- (void)dealloc
{ // self.hostReachability is my property holding my Reachability instance
    if (self.hostReachability) {
        [self.hostReachability stopNotifier];
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:13:59.567

The NSCAssert line is where you first access the deallocated object, but if you want to know more about the object's life cycle you should use Instruments. Use Xcode's Profile tool to run your program in the simulator with the Allocations (but not leaks!) tool. In the allocations tool's launch configuration turn on Enable NSZombie Detection *and* Record Reference Counts. When you hit the NSCAssert line Instruments should detect the attempt to message the zombie info object and make a note of it. If you look at the detailed information for the zombie info object Instruments will show you its history of reference counts and you should be able to see when it was deallocated.

# asp.net - IIS ASP.NET 1.1 应用程序 - 服务器错误页面 - 来自用户的抽象

> ID：15554146
> 
> 赞同：0
> 
> 时间：2013-03-21T17:25:00.810
> 
> 标签：asp.net, iis, .net-1.1, asp.net-1.1

目前我们的应用程序收到以下错误页面。

```
Server Error in '/' Application 
```

即使在自定义错误设置为 RemoteOnly 的情况下也是如此。

此错误的 HTTP 错误代码是什么？这是因为，我们可以在 InetMgr 的自定义错误下添加它并将其设置为自定义错误页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:26:19.410

Server errors get raised as 500's usually (Internal Server Error).

# java - Using LiveCycle How can I create and populate a new row in a table with values from other fields with a button press?

> ID：15554149
> 
> 赞同：0
> 
> 时间：2013-03-21T17:25:11.677
> 
> 标签：java, button, livecycle

Here is my current code, so far the button will create a new row in the table and it will reset the fields (AdditionalComments, CellLocation, and FailureSelection, which are all text fields), but it will not allow me to populate the original FailureRow or the new instance of FailureRow that is created:

```
field name="AddFailureButton" w="31.114mm" h="6mm">

        event name="event__click" activity="click"
           script contentType="application/x-javascript"
           xfa.host.messageBox("Failure Recorded, Please Continue Filling Out the Form Until All Failures Have Been Recorded.  Then Please Save and Submit the form.", "Continue/Save/Submit", 3);
           this.resolveNode('failuretable.Table1._FailureRow').addInstance(1);
           if (xfa.host.version &lt; 8) {
           xfa.form.recalculate(1);
}

//****need to set values of current FailureRow to be equal to CellLocation, FailureSelection, and AdditionalComments, THEN clear the values as written below*****

           xfa.host.resetData("form1.page1.AdditionalComments");
           xfa.host.resetData("form1.page1.CellLocation");
           xfa.host.resetData("form1.page1.FailureSelection");
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T12:15:01.817

试试下面的代码：

```
var newRow = this.resolveNode('failuretable.Table1._FailureRow').addInstance(1);
newRow.CELL_NAME.rawValue = form1.page1.AdditionalComments.rawValue;
newRow.CELL_NAME.rawValue = form1.page1.CellLocation.rawValue;
newRow.CELL_NAME.rawValue = form1.page1.FailureSelection.rawValue; 
```

请记住用正确的名称替换 CELL_NAME。

顺便提一句。当您在脚本中引用对象时，您可以只使用它的 SOM 表达式`failuretable.Table1._FailureRow`而不是`this.resolveNode('failuretable.Table1._FailureRow')`.

# iphone - 有没有办法在不进入 iPhone 设置的情况下停止应用通知？

> ID：15554151
> 
> 赞同：1
> 
> 时间：2013-03-21T17:25:35.610
> 
> 标签：iphone, ios, objective-c, xcode

我尝试了以下代码，但它不起作用。除非我把它放在某个特定的地方。

```
[[UIApplication sharedApplication] cancelAllLocalNotifications]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:28:41.780

`cancelAllLocalNotifications`将这样做，取消所有以前安排的本地通知。它不会关闭您应用的本地通知功能，您只需确保取消所有以前的通知并且不要发布新通知。无法以编程方式在设置应用程序中关闭该开关。

# highcharts - afterSetExtremes callback for highcharts

> ID：15554153
> 
> 赞同：2
> 
> 时间：2013-03-21T17:25:38.780
> 
> 标签：highcharts, lazy-high-charts

I'm creating a highchart using the lazy_highcharts gem. I'd like to make use of the afterSetExtremes callback to regenerate some other data on the page on zooming. I've tried several ways, currently trying:

```
 @chart = LazyHighCharts::HighChart.new('graph') do |f|
                    f.chart(:zoomType =>'x', :defaultSeriesType => 'spline')
                    f.x_axis(:type=> 'datetime', :events => {:afterSetExtremes => "functon(event){alert('something')}"} )
end 
```

But that gives me the error

```
Uncaught TypeError: Object functon(event){alert('something')} has no method 'apply' 
```

in the javascript console when I zoom the chart. I assume this has something to do with the generator not correctly setting up the callback function, setting it as a string instead of interpreting it as a function.

I've also tried to set it on my chart object via javascript after creation, but so far have had no luck with that. A few attempts below

```
chart_my_id4.xAxis.events = {setExtremes: function(event) {
      alert('set extremes');
    }};
chart_my_id4.xAxis[1].events = {setExtremes: function(event) {
      alert('set extremes');
    }}; 
```

No luck there either.

Any insight appreciated, thank you.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T03:18:16.723

不太熟悉... ruby​​，但我查看了github上的源代码，他们在将函数设置为属性时执行以下操作：

```
:formatter => "function() { return this.x; }".js_code 
```

值得尝试添加该 .js_code 并查看它是否有效，因此您最终会得到：

```
 @chart = LazyHighCharts::HighChart.new('graph') do |f|
   f.chart(:zoomType =>'x', :defaultSeriesType => 'spline')
   f.x_axis(:type=> 'datetime', :events => {
     :afterSetExtremes => "functon(event){alert('something')}".js_code
   })
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T11:49:20.907

我不熟悉那个宝石，但在标准的 Highcharts 3.0 中，您可以通过这种方式添加事件：

```
chart.yAxis[0].update({
    events: {
        afterSetExtremes: function(){
            alert('x');
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-23T11:47:08.730

你可以这样做：

```
 LazyHighCharts::HighChart.new('graph') do |f|
   ...
   f.xAxis(:events => { :afterSetExtremes => after_set_extremes_function})
 end 
```

-

```
 def after_set_extremes_function
   %|function(e) {
     chart = Highcharts.charts[0];
     chart.showLoading('Loading data...');
     $.getJSON("/path_to_your_action?start="+Math.round(e.min)+"&end="+Math.round(e.max), function(data) {
          chart.series[0].setData(data);
          chart.hideLoading();
        }
      }
    );
   }|.js_code
 end 
```

# php - PHP 正则表达式 preg_replace

> ID：15554154
> 
> 赞同：0
> 
> 时间：2013-03-21T17:25:41.107
> 
> 标签：php, preg-replace

我想替换这个 URI

```
http://localhost/prixou/index.php?page=list&category=1&sub=1&subsub=0&brand=Sony&toto=titi 
```

通过这个 URI

```
http://localhost/prixou/index.php?page=list&category=1&sub=1&subsub=0&kljklj=sdfsd 
```

==> 我想删除“&brand=Sony”

我试过这个：

```
preg_replace('/(^.*)(&brand=.*)(&.*)/', '$1$3', 'http://localhost/prixou/index.php?page=list&category=1&sub=1&subsub=0&brand=Sony&toto=titi'); 
```

但它在特定情况下不起作用：URI中的参数“toto”不存在的情况

所以如果我这样做

```
preg_replace('/(^.*)(&brand=.*)(&.*)/', '$1$3', 'http://localhost/prixou/index.php?page=list&category=1&sub=1&subsub=0&brand=Sony'); 
```

它不起作用 ==> "&brand=Sony" 仍然出现

那我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T17:30:43.220

我不会使用正则表达式。

首先，使用[parse_url](http://php.net/manual/en/function.parse-url.php)将 url 拆分成各个部分。
然后，在查询部分使用[parse_str](http://www.php.net/manual/en/function.parse-str.php)。

对查询键做任何你想做的事情，然后将它们组合回来。
构建查询字符串：[http_build_query然后使用](http://www.php.net/manual/en/function.http-build-query.php)[http_build_url](http://www.php.net/manual/en/function.http-build-url.php)
构建 url

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:32:43.667

```
 preg_replace("/\&brand=Sony/", "", $uri); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:33:05.083

怎么样：

```
preg_replace('/[\?&]brand=\w*/', '', $url); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:33:16.243

如果你想要关键品牌的价值

```
preg_replace('/&?brand=[^&]+/i','',$url); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T17:35:01.773

```
(^.*)(&brand=.*)(&.*)? 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-21T17:35:47.447

你可以添加？：

```
(^.*)(&brand=.*)(&.*)?

echo preg_replace(
'/(^.*)(&brand=.*)(&.*)?/', 
'$1$3', 
'http://localhost/prixou/index.php?page=list&category=1&sub=1&subsub=0&brand=Sony'); 
```

输出：

```
http://localhost/prixou/index.php?page=list&category=1&sub=1&subsub=0 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-21T19:54:59.683

谢谢大家。所以这是我的最终解决方案，它工作正常：

```
<?php
$actual_link = 'index.php?'.$_SERVER['QUERY_STRING']; //complete link of my page
$parsedURL= parse_url($actual_link);
parse_str($parsedURL["query"],$tabParametersQuery);    
$tabParametersQuery['brand']="";
$newURL = "index.php?".http_build_query($tabParametersQuery);
?> 
```

# c# - System.Diagnostics 跟踪源名称的通配符

> ID：15554156
> 
> 赞同：6
> 
> 时间：2013-03-21T17:25:45.200
> 
> 标签：c#, .net, system.diagnostics

我有我的`Logging`设置`TraceSource`为每个使用不同的`Class`.

是否可以配置一个为所有源写入事件的通配符？

```
<system.diagnostics>
  <sources>
    <source name ="wildcard" switchValue="Warning">
      <listeners>
        <add name="textlog" />
      </listeners>
    </source>
    <source name="MySpecificClass" switchValue="All">
      <listeners>
        <add name="textlog" />
      </listeners>
    </source>
  </sources>
  <sharedListeners>
    <add name="textlog"
         type="System.Diagnostics.TextWriterTraceListener"
         initializeData="Log.log">
    </add>
  </sharedListeners> 
  <trace autoflush="true"/>
</system.diagnostics> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T19:50:00.577

我不知道自动执行此操作的内置方法。但是，如果您查看 Castle 的 git 存储库中的 TraceLogger，您会发现它们本质上已经包装和扩展了 TraceSource 以支持“分层”命名。

[https://github.com/castleproject/Core/blob/master/src/Castle.Core/Core/Logging/TraceLogger.cs](https://github.com/castleproject/Core/blob/master/src/Castle.Core/Core/Logging/TraceLogger.cs)

我会在这里复制代码，但将代码剪切并粘贴到 SO 中可能不合适。

我可以解释课堂上提出的想法如何适用于您（无需使用 Castle）

本质上，在您的客户端代码（想要记录内容）中，您将创建一个“记录器”实例（而不是 TraceSource）。例如，作为记录器的输入，您将提供完全限定的类名。在构造函数中，使用输入名称尝试解析 TraceSource。如果有一个使用该名称配置的 TraceSource，请使用该 TraceSource 来完成工作。如果不是，则剪掉完全限定名称的最右边部分。尝试使用该名称解析 TraceSource。如果有一个使用该名称配置的 TraceSource，请使用它。等等。如果您没有找到任何 TraceSources，则不要从“记录器”中记录任何内容。您可以添加识别已配置通配符名称的 TraceSource ("*")。如果您从未使用名称修剪技术找到 TraceSource，并且如果存在“* ” TraceSource，请使用“*” TraceSource 作为后备。

所以，你可能有这样的事情：

```
class MyTraceSource
{
  private TraceSource ts;

  public MyTraceSource(string name)
  {
    ResolveTraceSource(name);
  }

  private void ResolveTraceSource(string name)
  {
    //Check for a configured TraceSource from most qualified name (as input) to least qualified ("").
    //Assume name like this:  Namespace1:Namespace2:Class
    //Try to resolve:
    // TraceSource("Namespace1.Namespace2.Class");
    // TraceSource("Namespace1.Namespace2");
    // TraceSource("Namespace1");
    //If you still haven't found one, try to resolve
    // TraceSource("*");
  }

  //Implement either TraceSource API, or whatever API you prefer for logging.

} 
```

作为原型的一部分，我实际上已经做了类似的事情（我们最终没有使用），它非常适合模仿在 log4net 和 NLog 中指定记录器的方式。

祝你好运！

# excel - Filter null predecessor

> ID：15554158
> 
> 赞同：0
> 
> 时间：2013-03-21T17:25:50.673
> 
> 标签：excel, rally

What is the syntax for the filter of the Excel Add-on for Rally?

I would like to filter out the rows (User Stories) that don't have a predecessor.

I tried (Predecessors != "null") but that doesn't work.

Regards, Jim

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:40:33.650

拉力赛中故事的前身属性由一个集合（对前身故事的引用数组）表示。不幸的是，集合属性不能用于简单的 Web 服务查询语法。

不幸的是，最好的办法是在 Excel 中进行过滤，方法是设置一个数据过滤器，排除该字段为空的行。

# symfony - FOSUserBundle：尝试在登录前检查“已删除”标志

> ID：15554160
> 
> 赞同：1
> 
> 时间：2013-03-21T17:25:57.333
> 
> 标签：symfony, fosuserbundle

我试图弄清楚究竟在哪里挂钩到 FOSUserBundle 登录进程以检查用户是否具有“已​​删除”标志，如果为真，则终止登录尝试返回错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T08:38:53.703

好吧，身份验证由安全组件处理，而不是由 FOS 用户包处理。有关更多信息，请先阅读此[文档](http://symfony.com/doc/master/book/security.html)

**简短的总结在这里**

```
firewalls:
        main:
            pattern: ^/
            form_login:
                provider: fos_userbundle
                csrf_provider: form.csrf_provider
            logout:       true
            anonymous:    true 
```

> 当用户向受防火墙保护的 URL 发出请求时，安全系统将被激活。防火墙的工作是确定用户是否需要进行身份验证，如果需要，则将响应发送回启动身份验证过程的用户。

SRC：[http ://symfony.com/doc/master/book/security.html#how-security-works-authentication-and-authorization](http://symfony.com/doc/master/book/security.html#how-security-works-authentication-and-authorization)

```
providers:
        fos_userbundle:
            id: fos_user.user_provider.username 
```

防火墙需要提供者（提供者用户名和密码）。FOS 用户包有自己的用户提供者。

**您的问题**
您可以扩展 fos 用户包的用户管理器并覆盖逻辑以检查更多条件。

您可以在此处查看示例 [https://stackoverflow.com/a/14985093/598424](https://stackoverflow.com/a/14985093/598424)

**现在如何检查删除标志**

> 该`AdvancedUserInterface`接口添加了四个额外的方法来验证帐户状态：
> 
> *   `isAccountNonExpired()`检查用户的帐户是否已过期，
> *   `isAccountNonLocked()`检查用户是否被锁定，
> *   `isCredentialsNonExpired()`检查用户的凭据（密码）是否已过期，
> *   `isEnabled()`检查用户是否启用。

[如何创建我们自己的自定义提供程序？](http://symfony.com/doc/master/cookbook/security/entity_provider.html)

# asp.net-mvc-3 - 发送 HTTP 标头后无法重定向 MVC3

> ID：15554162
> 
> 赞同：1
> 
> 时间：2013-03-21T17:26:10.177
> 
> 标签：asp.net-mvc-3, response.redirect

在基本控制器上使用 RedirectPermanent(url) 方法时，我在 MVC3 应用程序中收到此错误。其他 StackOverflow 答案建议的缓冲输出没有任何效果。

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
   Context.Response.BufferOutput = true;
} 
```

重定向在此网站的默认控制器上作为第一个操作结果触发： [http ://www.autoquoter.com](http://www.autoquoter.com)

我没有任何直接添加标题的代码。既然如此，有没有办法确定添加响应标头的内容是什么？

这是来自 webkit 调试器的网站第一页的网络日志。

```
Request URL:http://www.autoquoter.com/
Request Method:GET
Status Code:301 Moved Permanently

Request Headers
Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
User-Agent:Mozilla/5.0 (Windows NT 5.1) AppleWebKit/534.57.2 (KHTML, like Gecko) Version/5.1.7 Safari/534.57.2

Response Headers
Cache-Control:no-cache, no-store, must-revalidate
Content-Length:128
Content-Type:text/html; charset=utf-8
Date:Thu, 21 Mar 2013 17:10:38 GMT
Expires:-1
Location:/aq/en/Home
Pragma:no-cache
Server:Microsoft-IIS/6.0
X-AspNet-Version:4.0.30319
X-AspNetMvc-Version:3.0
X-Powered-By:ASP.NET 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:36:11.713

看起来我已经解决了这个问题。还有另一个基于隐藏在 NoCacheAttribute 过滤器中的主机名的重定向。这是在 OnResultExecuting 方法中设置 Response 对象的属性。

我将该方法重命名为 OnActionExecuting，以便更快地触发它，并将手动重定向替换为 RedirectResult。如果我已经在重定向，我现在也避免更新缓存设置。

前：

```
 if (currentHost != prefHost && filterContext.HttpContext.Response.StatusCode != 301)
 {
      var Url = filterContext.HttpContext.Request.Url.Scheme + "://" + prefHost + filterContext.HttpContext.Request.Url.PathAndQuery;
      filterContext.HttpContext.Response.StatusCode = 301;
      filterContext.HttpContext.Response.RedirectLocation = Url;
      filterContext.HttpContext.Response.End();
      return;
 }
 filterContext.HttpContext.Response.Cache.SetExpires(DateTime.UtcNow.AddDays(-1)); 
 filterContext.HttpContext.Response.Cache.SetValidUntilExpires(false); 
 filterContext.HttpContext.Response.Cache.SetRevalidation(HttpCacheRevalidation.AllCaches); 
 filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache); 
 filterContext.HttpContext.Response.Cache.SetNoStore(); 
```

后：

```
 if (currentHost != prefHost && filterContext.HttpContext.Response.StatusCode != 301)
 {
      var Url = filterContext.HttpContext.Request.Url.Scheme + "://" + prefHost + filterContext.HttpContext.Request.Url.PathAndQuery;
      filterContext.Result = new RedirectResult(Url, true);
      disableCache = false;
 }

    if (disableCache)
    {
        filterContext.HttpContext.Response.Cache.SetExpires(DateTime.UtcNow.AddDays(-1));
        filterContext.HttpContext.Response.Cache.SetValidUntilExpires(false);
        filterContext.HttpContext.Response.Cache.SetRevalidation(HttpCacheRevalidation.AllCaches);
        filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);
        filterContext.HttpContext.Response.Cache.SetNoStore();
    }
    base.OnActionExecuting(filterContext); 
```

# javascript - 计算 AnalyserNode 的 smoothingTimeConstant

> ID：15554166
> 
> 赞同：3
> 
> 时间：2013-03-21T17:26:25.160
> 
> 标签：javascript, html5-canvas, html5-audio, web-audio-api, requestanimationframe

我正在使用 Web Audio API 来显示正在播放的音频的可视化。我有一个控制播放的元素，然后我通过从该元素创建一个节点将`<audio>`它连接到 Web 音频 API 。然后将其连接到 a和 an 。[的](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#attributes-ConvolverNode-section_2)[设置](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#attributes-ConvolverNode-section_2)为[。](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#attributes-ConvolverNode-section_2)然后将 连接到。`MediaElementSource``<audio>``GainNode``AnalyserNode`[`AnalyserNode``smoothingTimeConstant``0.6`](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#attributes-ConvolverNode-section_2)`GainNode``AudioContext.destination`

然后我调用我的音频处理函数：`onAudioProcess()`. 该函数将使用以下方法不断调用自身：

```
audioAnimation = requestAnimationFrame(onAudioProcess); 
```

该函数使用音频中的`AnalyserNode`to `getByteFrequencyData`，然后循环遍历（现在已填充）并在元素的 2d 上下文中`Uint8Array`绘制每个频率幅度。`<canvas>`这一切都很好。

我的问题是，当您暂停`<audio>`元素时，我的`onAudioProcess`函数会继续循环（通过请求自身的动画帧），这会不必要地占用 CPU 周期。我可以`cancelAnimationFrame(audioAnimation)`，但这会在画布上留下最后绘制的频率。我也可以通过调用画布的 2d 上下文来解决*这个*问题，但与仅让音频处理循环继续（由于.`clearRect``smoothingTimeConstant`

所以我最终做的`<audio>`是在取消动画帧之前在暂停时设置超时。这样做我能够在没有音频播放时节省 CPU 周期，**并且**我仍然能够保持平滑降低`<canvas>`.

**我的问题：**如何根据`AnalyserNode`'s 的`smoothingTimeConstant`值准确计算频率幅度为 255 达到 0（范围为 0-255）所需的毫秒数，以便我可以正确设置超时以取消动画帧?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T19:53:23.793

根据我对规范的阅读，我认为您会这样理解：

```
var val = 255 
  , smooth = 0.6
  , sampl = 48000
  , i = 0
  , ms;
for ( ; val > 0.001; i++ ){
  val = ( val + val * smooth ) / 2;
}
ms = ( i / sampl * 1000 ); 
```

问题是，通过这种平均，你永远不会*真正*降到零——所以循环条件有点随意。您可以使该数字更小，并且如您所料，值`ms`会变大。

无论如何，我可以在这里完全脱离基地。但是快速浏览一下实际的 Chromium 源代码*似乎*可以确认这就是它的工作原理。虽然我会第一个承认我的 C++ 很糟糕。

# javascript - How to check a "sync" value in an async function?

> ID：15554167
> 
> 赞同：0
> 
> 时间：2013-03-21T17:26:27.897
> 
> 标签：javascript, google-chrome-extension

I try to make some changes on a Chrome extension. I need the extension checks the value and if it is true, then execute a script. If false, then do nothing. I wrote something like this:

```
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
    if(localStorage["statusOfSomething"]){
        chrome.tabs.executeScript(tabId, {file: "file.js" ,runAt:'document_end'});
    }
}); 
```

But this takes the initial value of `localStorage["statusOfSomething"]` always. So there is an async function to register a listener for "onUpdated". But I need to check the `localStorage["statusOfSomething"]` value of "now", not the value of the time by registering the listener.

How can I do this?

Edit: Actually I was trying to check two things:

1.  if the website is in the site list of extension
2.  if this website is enabled for the extension

Now here the full story;

There are some websites, I defined them on `background.js` file. Let's say; a.com, b.com ... etc.

```
var sites = [{
    name     : "a",
    wildcard : ["*://a.com/*"],
    js       : "a.js"
},{
    name     : "b",
    wildcard : ["*://b.com/*"],
    js       : "b.js"
}] 
```

and there are statuses of the sites (enable/ disable; true/false) I think it was good to store statuses by localStorage, so I write as initial value `true`:

```
for(var i = 0; i<sites.length; i++){
    localStorage[sites[i].name] =true;
} 
```

As option; it was needed to addListener for changes:

```
chrome.extension.onMessage.addListener(function(request, sender, sendResponse) {
    if(request.method == "setSite"){
        var name = request.site;
        var status = request.active;

        localStorage[name] = status;
    }
    return true;
}); 
```

If user checks the checkbox for status option of the website, then `options.js` sends message:

```
$('#' + name).change(function(){
    var status = $(this).is(':checked');
    chrome.extension.sendMessage({method: "setSite", site: this.id, active: status}, function(response) {
        console.log(response.data);
    });
}); 
```

Now, back to `background.js` , for every update of the tab, I need to check these two things together: 1\. am I interested in this website? 2\. is it enable for me now?

So I wrote:

```
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
    if (changeInfo.status === 'complete') {
        var url = tab.url;
        for(var i = 0; i<sites.length; i++){
            var site = sites[i];
            var name = site.name;
            var wildcard = site.wildcard;
            if(localStorage[name] && testUrl(url,wildcard)){
                chrome.tabs.executeScript(tabId, {file: site['js'] ,runAt:'document_end'});
                break;
            }
        }
    }
}); 
```

Here, I get the value of localStorage[sitename] true

If you are more interested, you can see the code on [github](https://github.com/lacivert/Chrome-Last.fm-Scrobbler/tree/dev) ([the version](https://github.com/lacivert/Chrome-Last.fm-Scrobbler/commit/b983ba8e72e819c1f113f460170475faa2a6f7e3))

# c - recursive makefile not building

> ID：15554172
> 
> 赞同：0
> 
> 时间：2013-03-21T17:26:38.253
> 
> 标签：c, recursion, makefile

I have a bunch of C files in different directories and I'm getting a `make: nothing to be done for 'all'` error with my recursive Makefile; however if I tweak the dependences I can get it to work... but I don't understand why I have to.

Here's my original Makefile:

```
APP_DIRS=rescoco ressys resvm

.PHONY: all

all: $(APP_DIRS)

$(APP_DIRS):
    $(MAKE) --directory $@

clean:
    $(RM) *~ 
```

Now if I change my line: `.PHONY` to `.PHONY: all $(APP_DIRS)` it builds fine.

Another possibility is if I change the line: `$(APP_DIRS):` to `$(APP_DIRS): clean` it builds fine.

(NOTE: removing .PHONY target doesn't change anything)

So what's going on here? Is the Makefile trying to tell me I haven't listed dependencies correctly? I was thinking `make` would do something like:

*   to build `.PHONY` I first have to build `all`
*   to build `all` I first have to build `$(APP_DIRS)`
*   `$(APP_DIRS)` has no prereqs so execute the command for that (which would cause the recursive makes to run).

Clearly I am wrong; but why?

* * *

FYI, if it matters my files are structured something like this:

```
Makefile       #top level makefile as seen above
/rescoco
    rescoco.c
    Makefile   #builds rescoco src and moves archive to ../lib directory
/ressys
    ressys.c
    Makefile   #same as above but for ressys
/resvm
    resvm.c
    Makefile   #same as above but for resvm
/lib 
```

and my build command is simply `make`. When I run with `make -n` or `make -n all` I get no output at all:

```
:~/proj$ make -n all
make: Nothing to be done for 'all'.
:~/proj$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:54:27.857

首先你应该知道的事情：

*   如果您将目录作为依赖项，make 将考虑构建目标（即执行此类目录目标的配方），前提是目录的修改时间戳得到更新。仅当您在目录中添加新文件而不是在目录中修改文件时才会发生这种情况。在子目录中添加文件***不会***更改目录的时间戳。
*   PHONY 目标是在执行此类目标时使用，但不会创建具有目标名称的文件。换句话说，无论文件是否已经存在，您都希望 make 执行规则。

所以你的 Makefile 基本上只告诉这个：

*   要构建目标`all`，我需要构建`$(APP_DIRS)`. 由于`all`是 PHONY 目标，我将始终执行`all`.
*   `$(APP_DIRS)`不是`PHONY`目标，也没有任何依赖关系。所以***仅当** `$(APP_DIRS)`不存在时（即文件或目录），我将执行配方，否则我不会为这个目标做任何事情。
*   `clean`没有先决条件，也没有 a `PHONY`，所以我希望只有在 make 显式调用（从命令行或另一个 Makefile）时才执行此规则。`clean`也不是 a `PHONY`，所以我希望配方创建一个在执行后调用的文件（`clean`这对您的情况不正确）

因此将`.PHONY`行更改为：

```
.PHONY: all $(APP_DIRS) 
```

使 Makefile 始终执行 $(APP_DIRS) 的配方。

因此，如果您希望 make 始终遍历所有 $(APP_DIRS) 目录并在它们上再次调用 make，则需要添加`$(APP_DIRS)`to `.PHONY`，这会使 $(APP_DIRS) 成为 PHONY 目标，并执行配方而不管文件的/目录的时间戳（如果存在）。

对于您的特定用例，我认为这是您应该使用的 Makefile：

```
APP_DIRS=rescoco ressys resvm

.PHONY: all clean $(APP_DIRS)

all: $(APP_DIRS)

$(APP_DIRS):
    $(MAKE) --directory $@

clean:
    $(RM) *~ 
```

**奖金：**

*   更改`$(APP_DIRS):`为`$(APP_DIRS): clean`意味着`$(APP_DIRS)`取决于`clean`目标。
*   虽然`clean`没有标记为 PHONY，但 make 看不到`clean`当前目录中命名的文件。所以它继续并尝试执行`clean`.
*   由于构建了 $(APP_DIRS) (ie `clean`) 的依赖项，这使得 Makefile 执行构建 $(APP_DIRS) 的配方。

这给我们带来了一个有趣的观察结果： - 任何依赖于 PHONY 目标的目标总是会被重建（即会执行配方）。

使用这个简单的 Makefile：

```
all: target1

target1: target2
    @echo "$@"
    @touch $@

target2: target3
    @echo "$@"
    @touch $@

target3:
    @echo "$@"

.PHONY: all target3 
```

我第一次运行时`make`，我看到了这个输出：

```
target3
target2
target1 
```

在此之后，文件`target1`和`target2`被创建。即使那样，如果我`make`再次运行，我会看到输出：

```
target3
target2
target1 
```

如您所见，`PHONY`依赖项向上传播，而不是向下传播。`target2`被重建只是因为`target3`是假的，而`target1`被重建只是因为`target2`被重建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:59:24.600

这是你可以做到的，如果你不想要它，只需删除通配符。
[制作通配符子目录目标](https://stackoverflow.com/questions/1932904/make-wildcard-subdirectory-targets)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:57:26.567

您正在使用目录列表定义一个名为“APP_DIRS”的变量。那也行。

然后你做

`$(APP_DIRS): make blah blah,`这基本上相当于`rescoco ressys resvm: make blah blah`

这显然是无效的。

所以你需要假装你的 $(APP_DIRS) 是一个变量，而不是一个目标名称，这似乎是你使用它的原因。

话虽如此，想想为什么 .PHONY: all $(APP_DIRS) 有效

# jquery - .not(this) not working?

> ID：15554175
> 
> 赞同：1
> 
> 时间：2013-03-21T17:26:44.927
> 
> 标签：jquery

[Fiddle](http://jsfiddle.net/watson/tnXxF/3/)

I've got this basic accordion which toggles a class of 'block'. Everything is working, except the `.not(this)` in `$('.accordionInner').not(this).removeClass('block');` is not working, so you can never close all the accordions. I am sure it is a simple fix, but I don't know what I'm doing wrong.

HTML:

```
<div class="accordionHeading">
    <p>Header</p>
</div>
<div class="accordionInner">
    <p>Inner</p>
</div>
<div class="accordionHeading">
    <p>Header</p>
</div>
<div class="accordionInner">
    <p>Inner</p>
</div> 
```

CSS:

```
.accordionHeading {
    cursor: pointer;
    background: yellow;
}
.accordionInner {
    display: none;
}
.block {
    display: block !important;
} 
```

JS:

```
 $('body').on('click', '.accordionHeading', function(){
  $('.accordionInner').not(this).removeClass('block');
  $(this).next('.accordionInner').toggleClass('block');
 }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T17:31:55.123

事件在标题上，所以`this`永远不会是任何“内部”元素。

`next`使用您在其中使用的参考`not`：

```
$('body').on('click', '.accordionHeading', function(){
  var inner = $(this).next('.accordionInner');
  $('.accordionInner').not(inner).removeClass('block');
  inner.toggleClass('block');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T17:35:01.270

更新了你的小提琴[http://jsfiddle.net/tnXxF/4/](http://jsfiddle.net/tnXxF/4/)

问题出在这里：

```
$('.accordionInner').not(this).removeClass('block'); 
```

您正在选择accordionInner，但点击事件是在accordionHeading 上，所以.not(this) 永远无法工作。

小提琴中的解决方案：

```
$('body').on('click', '.accordionHeading', function(){
  var targetInner = $(this).next('.accordionInner');
  $('.accordionInner').not(targetInner).removeClass('block');
  targetInner.toggleClass('block');
}); 
```

编辑：如评论中所述， targetInner 不需要再次包装在 jquery 对象中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:36:34.143

由于您的`.accordionHeading`和`.accordionInner`元素是兄弟姐妹（不是父：子），因此您不需要`this`在标题的点击事件上使用。

您的 Javascript 大部分是正确的，只需将其更改为：

```
$('body').on('click', '.accordionHeading', function(){
  $(this).next('.accordionInner').toggleClass('block');
}); 
```

因此，现在当单击 an 时`accordionHeading`，它将找到下一次出现 an`accordionInner`并切换`block`类以触发扩展或收缩。

或者，您也可以使用 jQuery [.toggle()](http://api.jquery.com/toggle/)方法在没有自定义类的情况下为您执行显示/隐藏。

# c++ - How to create global constant of a class - C++

> ID：15554177
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:26:52.693
> 
> 标签：c++, global-variables, constants

I'm trying to create a class of complex number and want to create the imaginary unit *i* as constant. I want to be able to use it in any code when the class is included. For example :

```
#include "complex.h"
complex c = 2*i; 
```

I've tried to define it that way : `static const complex i` in complex.h under `public:` and `const complex complex::i = complex(0,1)` in complex.cpp. But when I write the code on the top in main.cpp , I get undeclared variable error.

How can I do this?

**Note** : I've defined the `=` and `*` operators

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:29:48.647

`extern const complex i`在*complex.h*中声明。

如果您不声明它`i`必须`extern`在使用它的每个编译单元中定义。链接两个这样的编译单元将产生重复定义错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:29:52.947

您声明`complex::i`但您正在尝试使用`i`. 将您的代码更改为

```
complex c = 2 * complex::i; 
```

或者创建一个全局常量`i`（注意：这不是一个好主意；但您可以在 namspace 中执行此操作）。

# javascript - Google maps API v3：添加与多标记的折线冲突

> ID：15554181
> 
> 赞同：0
> 
> 时间：2013-03-21T17:26:58.543
> 
> 标签：javascript, google-maps, google-maps-api-3

我正在使用[Multimarker](http://code.google.com/p/multimarker/)将带有标签的标记添加到自定义谷歌地图。包含标签的 div 使用 onclick 调用函数。但是如果我在地图上添加一条折线，onclick 就会停止工作。我想不通为什么...

这是添加标记的代码：

```
var fastMarkers = [];
var myLatlng = new google.maps.LatLng(70,-101);
var marker = new com.redfin.FastMarker(/*id*/1, myLatlng, ["<div onclick='test()'><span>mylabel</span></div>"], null);
fastMarkers.push(marker);                
new com.redfin.FastMarkerOverlay(map, fastMarkers); 
```

这是折线：

```
 var linepathcoords = [
    new google.maps.LatLng(71, -103),
    new google.maps.LatLng(73, -107),
 ];

var linepath=new google.maps.Polyline({
  path:linepathcoords,
  strokeColor:"#ff0000",
  strokeOpacity:0.9,
  strokeWeight:2
});
//This next line is what's causing the onclick in the marker to stop working. Why?
linepath.setMap(map);
}; 
```

这是 Multimarker 的代码：

```
/*
 Copyright 2010 Redfin Corporation
 Licensed under the Apache License, Version 2.0: 
 http://www.apache.org/licenses/LICENSE-2.0 
 */

com = {redfin: {}};

/* Construct a new FastMarkerOverlay layer for a V2 map
 * @constructor
 * @param {google.maps.Map} map the map to which we'll add markers
 * @param {Array.<com.redfin.FastMarker>} markers the array of markers to display on the map
 */
com.redfin.FastMarkerOverlay = function(map, markers) {
  this.setMap(map);
  this._markers = markers;
}

com.redfin.FastMarkerOverlay.prototype = new google.maps.OverlayView();

com.redfin.FastMarkerOverlay.prototype.onAdd = function() {
  this._div = document.createElement("div");
  var panes = this.getPanes();
  panes.overlayLayer.appendChild(this._div);
}

/* Copy our data to a new FastMarkerOverlay
 * @param {google.maps.Map} map the map to which the copy will add markers
 * @return {FastMarkerOverlay} Copy of FastMarkerOverlay
 */
com.redfin.FastMarkerOverlay.prototype.copy = function(map) {
  var markers = this._markers;
  var i = markers.length;
  var markersCopy = new Array(i);
  while (i--) {
    markersCopy[i] = markers[i].copy();
  }
  return new com.redfin.FastMarkerOverlay(map, markers);
};

/* Draw the FastMarkerOverlay based on the current projection and zoom level; called by Gmaps */
com.redfin.FastMarkerOverlay.prototype.draw = function() {
  // if already removed, never draw
  if (!this._div) return;

  // Size and position the overlay. We use a southwest and northeast
  // position of the overlay to peg it to the correct position and size.
  // We need to retrieve the projection from this overlay to do this.
  var overlayProjection = this.getProjection();

  // DGF use fastloop http://ajaxian.com/archives/fast-loops-in-js
  // JD Create string with all the markers
  var i = this._markers.length;
  var textArray = [];
  while (i--) {
    var marker = this._markers[i];
    var divPixel = overlayProjection.fromLatLngToDivPixel(marker._latLng);
    textArray.push("<div style='position:absolute; left:");
    textArray.push(divPixel.x + marker._leftOffset);
    textArray.push("px; top:");
    textArray.push(divPixel.y + marker._topOffset);
    textArray.push("px;")
    if (marker._zIndex) {
      textArray.push(" z-index:");
      textArray.push(marker._zIndex);
      textArray.push(";");
    }
    textArray.push("'");
    if (marker._divClassName) {
      textArray.push(" class='");
      textArray.push(marker._divClassName);
      textArray.push("'");
    }
    textArray.push(" id='");
    textArray.push(marker._id);
    textArray.push("' >");

    var markerHtmlArray = marker._htmlTextArray;
    var j = markerHtmlArray.length;
    var currentSize = textArray.length;
    while (j--) {
      textArray[j + currentSize] = markerHtmlArray[j];
    }
    textArray.push("</div>");
  }

  //Insert the HTML into the overlay
  this._div.innerHTML = textArray.join('');
}

/** Hide all of the markers */
com.redfin.FastMarkerOverlay.prototype.hide = function() {
  if (!this._div) return;
  this._div.style.display = "none";
}

/** Show all of the markers after hiding them */
com.redfin.FastMarkerOverlay.prototype.unhide = function() {
  if (!this._div) return;
  this._div.style.display = "block";
}

/** Remove the overlay from the map; never use the overlay again after calling this function */
com.redfin.FastMarkerOverlay.prototype.onRemove = function() {
  this._div.parentNode.removeChild(this._div);
  this._div = null;
}

/** Create a single marker for use in FastMarkerOverlay
 * @constructor
 * @param {string} id DOM node ID of the div that will contain the marker
 * @param {google.maps.LatLng} latLng geographical location of the marker 
 * @param {Array.<string>} htmlTextArray an array of strings which we'll join together to form the HTML of your marker
 * @param {string=} divClassName the CSS class of the div that will contain the marker. (optional)
 * @param {string=} zIndex zIndex of the div that will contain the marker. (optional, 'auto' by default)
 * @param {number=} leftOffset the offset in pixels by which we'll horizontally adjust the marker position (optional)
 * @param {number=} topOffset the offset in pixels by which we'll vertically adjust the marker position (optional)
*/
com.redfin.FastMarker = function(id, latLng, htmlTextArray, divClassName, zIndex, leftOffset, topOffset) {
  this._id = id;
  this._latLng = latLng;
  this._htmlTextArray = htmlTextArray;
  this._divClassName = divClassName;
  this._zIndex = zIndex;
  this._leftOffset = leftOffset || 0;
  this._topOffset = topOffset || 0;
}

/** Copy the FastMarker
 * @return {com.redfin.FastMarker} duplicate of this marker
 */
com.redfin.FastMarker.prototype.copy = function() {
  var htmlArray = this._htmlTextArray;
  var i = htmlArray.length;
  var htmlArrayCopy = new Array(i);
  while (i--) {
    htmlArrayCopy[i] = htmlArray[i];
  }
  return new com.redfin.FastMarker(this._id, latLng, htmlArrayCopy, this._divClassName, this._zIndex, this._leftOffset, this._topOffset);
} 
```

附加信息：在添加折线之前，我可以使用 Firefox 中的“检查”工具并选择包含标签的 div 和 span。但添加折线后，div 消失了（标签在地图上仍然可见，但我无法单击它，也无法使用检查工具选择它。此外，添加折线后，我在 Firefox 中看到“检查” - 列出很多 div 突然有“溢出：隐藏”，我认为他们以前没有。这是一个线索吗？如果我删除折线也无济于事。onclick 功能标签仍然不起作用。就像，我可以添加折线，删除它，添加标签，标签的 onclick 不起作用。或者我可以添加标签，添加折线，标签的 onclick 停止工作，删除折线，标签onclick 仍然无法正常工作。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T09:33:46.353

[提供下载的 zip 文件 (2013-03-22) ( http://code.google.com/p/multimarker/](http://code.google.com/p/multimarker/) ) 中包含的 Multimarker js 脚本与通过[http](http://multimarker.googlecode.com/svn/trunk/fast-marker-overlay/maps-v3/src/FastMarkerOverlay.js)访问的 js 脚本之间存在差异 ： [//multimarker.googlecode.com/svn/trunk/fast-marker-overlay/maps-v3/src/FastMarkerOverlay.js](http://multimarker.googlecode.com/svn/trunk/fast-marker-overlay/maps-v3/src/FastMarkerOverlay.js)。

通过 http:// 访问的脚本说：

第 24 行：

```
panes.floatPane.appendChild(this._div); 
```

代替

```
panes.overlayLayer.appendChild(this._div); 
```

和第 140 行：

```
this.latLng 
```

代替

```
latLng 
```

我在下载的脚本中更改了这些东西，现在它可以工作了！非常感谢 geocodezip 帮我解决这个问题！如果有什么方法可以让你相信这一点，请告诉我。我是该网站的新手，我不确定它是如何工作的......

# asp.net-mvc - 使用 DI 获取适当的存储库以向会话提供数据

> ID：15554184
> 
> 赞同：0
> 
> 时间：2013-03-21T17:27:05.130
> 
> 标签：asp.net-mvc, dependency-injection

当用户请求登录页面时，会调用 LoginController 并且 ninject 将向控制器注入适当的存储库（比如说 IAccountRepository）。如果登录成功，我将从存储库中获取用户信息，然后存储在 Session 中（比如说 AccInfo）。但是，如果用户有一个有效的授权 cookie 返回到我的站点，则 AccInfo 在 Session 中不存在，但我想在另一个控制器中使用它（首先没有注入 IAccountRepository）。我现在该怎么办？我不想调用一个具体的对象（比如说一个 AccountRepository 实例）来从数据库中获取信息，我仍然想在这种情况下使用 DI。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:49:01.070

也许你不应该将 AccInfo 存储在会话中？只需存储 userId 或类似的东西，然后始终注入您的存储库，并使用 userId 来检索必要的东西。

如果要最小化数据库访问，请在存储库中使用缓存。

# java - 修改 xslfo 中的行高

> ID：15554186
> 
> 赞同：2
> 
> 时间：2013-03-21T17:27:05.543
> 
> 标签：java, xml, xsl-fo

我有一个使用 xslfo 生成的 PDF。在那，我有一个表格，其中有一行，其中一个单元格跨越两行单元格。在它跨越的两个行单元格中，我需要较低的单元格具有较小的高度，并且我尝试了一些不起作用的东西。这是代码 - 任何帮助将不胜感激。

```
<fo:table-row>
<fo:table-cell border-style="solid" border-width="0.5pt" padding="1pt" display-align="before" number-rows-spanned="3">
<fo:block wrap-option="wrap" text-align="left">
<xsl:value-of select="$TextStrings/NSEF21B/Scope_Ins_Cov_Heading1"/>
</fo:block>
<fo:block wrap-option="wrap" text-align="left">
<xsl:value-of select="$TextStrings/NSEF21B/Scope_Ins_Cov_Heading1b"/></fo:block>
</fo:table-cell>
</fo:table-row>
<fo:table-row>
<fo:table-cell border-style="solid" border-width="0.5pt" padding="1pt" display-align="center">
<fo:block wrap-option="wrap" text-align="center">
<xsl:value-of select="$TextStrings/NSEF21B/Scope_Ins_Cov_Heading2"/>
</fo:block>
</fo:table-cell>
<fo:table-cell border-style="solid" border-width="0.5pt" padding="1pt" display-align="center">
<fo:block wrap-option="wrap" text-align="center">
<xsl:value-of select="$TextStrings/NSEF21B/Scope_Ins_Cov_Heading3"/>
</fo:block>
</fo:table-cell>
</fo:table-row>
<fo:table-row>
<fo:table-cell border-style="solid" border-width="0.5pt" padding="1pt" display-align="before">
<fo:block text-align="center">
<xsl:value-of select="$TextStrings/Deductible"/>
</fo:block>
</fo:table-cell>
<fo:table-cell border-style="solid" border-width="0.5pt" padding="1pt" display-align="before">
<fo:block text-align="center">
<xsl:value-of select="$TextStrings/AsStatedSecB"/>
</fo:block>
</fo:table-cell>
</fo:table-row> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-16T19:45:14.613

由于这仍然没有答案：

在元素上设置[height 属性应该可以解决问题。](http://www.w3schools.com/xslfo/prop_height.asp)`<fo:table-row>`

# javascript - javascript抽认卡

> ID：15554188
> 
> 赞同：0
> 
> 时间：2013-03-21T17:27:08.280
> 
> 标签：javascript, jquery, google-chrome, google-chrome-extension

有人可以告诉我为什么以下扩展不起作用吗？我试图用 script src=" ..." /script 替换内联脚本，但它仍然不起作用。在内容脚本中列出两个 javascript 还是同时删除它们会更好吗？

POPUP.html

```
<!DOCTYPE html> 
<html>
<head>
<style>
  body { width: 300px; }
  textarea { width: 250px; height: 100px;}
</style>
<script>
  function pasteSelection() {
  chrome.tabs.getSelected(null, function(tab) {
  chrome.tabs.sendRequest(tab.id, {method: "getSelection"}, function (response) {
  var text = document.getElementById('text'); 
  text.innerHTML = response.data;
    });
  });
 }
</script>
</head>
<body>
<textarea id="text"> </textarea>
<button onclick="pasteSelection(); ">Paste Selection</button>
</body>
</html> 
```

选择.js

```
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
if (request.method == "getSelection")
  sendResponse({data: window.getSelection().toString()});
else
  sendResponse({}); // snub them.
}); 
```

清单.json

```
{
 "name": "Selected Text",
 "version": "0.1",
 "description": "Selected Text",
 "browser_action": {
 "default_title": "Selected Text",
 "default_icon": "online.png",
 "default_popup": "popup.html" 
},
 "permissions": [
 "tabs",
 "chrome://favicon/",
 "http://*/*", 
 "https://*/*"
],
 "content_scripts": [
{
"matches": ["http://*/*"],
"js": ["selection.js", "paste.js"]
"run_at": "document_start",
"all_frames": true
}
]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:18:30.003

您不能使用任何内联代码，并且您正在使用几种已弃用的方法。没有将所有内联代码移动到外部文件可能是导致问题的原因，但无论如何使用折旧的方法都不好。修复它会使它看起来像这样：

**弹出窗口.html**

```
<!DOCTYPE html> 
<html>
  <head>
    <style>
      body { width: 300px; }
      textarea { width: 250px; height: 100px;}
    </style>
    <script src="popup.js"></script>
  </head>
  <body>
    <textarea id="text"> </textarea>
    <button id="pasteButton">Paste Selection</button>
  </body>
</html> 
```

**Popup.js**

```
window.onload = function() {
  var pasteButton = document.getElementById("pasteButton");
  pasteButton.onclick = function(){
    chrome.tabs.query({active:true,currentWindow:true}, function(tab) {
      chrome.tabs.sendMessage(tab[0].id,{method:"getSelection"},function(response){
        var text = document.getElementById('text'); 
        text.innerHTML = response.data;
      });
    });
  };
}; 
```

**选择.js**

```
chrome.extension.onMessage.addListener(function(request, sender, sendResponse) {
  if (request.method == "getSelection")
    sendResponse({data: window.getSelection().toString()});
  else
    sendResponse({}); // snub them.
}); 
```

**清单.json**

```
{
 "name": "Selected Text",
 "version": "0.1",
 "description": "Selected Text",
 "manifest_version": 2,
 "browser_action": {
   "default_title": "Selected Text",
   "default_icon": "online.png",
   "default_popup": "popup.html" 
 },
 "permissions": [
   "tabs",
   "chrome://favicon/",
   "http://*/*", 
   "https://*/*"
 ],
 "content_scripts": [{
   "matches": ["http://*/*"],
   "js": ["selection.js", "paste.js"],
   "run_at": "document_start",
   "all_frames": true
 }]
} 
```

# hmac - 在基于hmac的一次性密码实现中，如何保证客户端和服务器之间的计数器同步？

> ID：15554190
> 
> 赞同：0
> 
> 时间：2013-03-21T17:27:10.113
> 
> 标签：hmac, one-time-password

我们正在尝试实现一种基于 hmac 的一次性密码协议，以便通过我们的 api 对用户进行身份验证。

这个想法是针对私钥和增量计数器加密用户的唯一标识符（uid）。然后为下一次调用增加计数器。

```
encrypt(uid, private_key, counter)
# now increment the counter for the next call 
```

然后在服务器端，使用私钥和计数器解密，得到用户标识符（uid）。

```
decrypt(encrpyted_string, private_key, counter)
# now increment the counter for the next received request 
```

这工作正常。由于计数器，每个调用都是完全唯一的（一次）。

但是，我们将如何处理计数器的同步？如果客户端生成请求，为下一次调用增加计数器并发送请求，但服务器处于脱机状态并且从未接收到请求，或者存在互联网连接问题并且请求从未通过 - 现在服务器并且客户端与彼此的计数器不同步。

这是“您应该知道是否已提交请求”的情况吗？即我们可以从服务器添加一个响应标头来说明计数器是否已增加，并且*只有当它增加时，我们才会在应用程序中增加计数器*......但同样可以反过来说 - 我们可以发送一个请求，服务器接收到它，增加它自己的计数器并发送一个响应，但是在服务器处理它的请求时互联网连接已经中断，并且应用程序永远不会收到响应，永远不会增加它的计数器，因此两者都超出了再次同步。

感谢您能给我的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-10T13:53:33.030

要在服务器和客户端之间同步计数器，只需检查一些 OTP 范围。如果客户端为当前计数器发送 OTP - 一切正常，则无事可做，如果客户端在当前计数器附近（~15）的某个范围内发送 OTP - 这意味着该客户端可以通过身份验证，但您需要更新服务器上的计数器. 在出现严重不同步的情况下，您应该询问两个一致的 OTP，并检查它们在各种计数器上是否正确。如果是 - 将您的服务器计数器设置为建立值。

# websocket - SockJS EventBus Bridge 是构建私人聊天的正确工具吗？

> ID：15554201
> 
> 赞同：1
> 
> 时间：2013-03-21T17:27:47.267
> 
> 标签：websocket, sockjs, vert.x

我想使用 Vert.X 构建一个由 SockJS 提供支持的私人聊天应用程序。我很快就遇到了 SockJS 的限制，因为它的 API 过于简单，而且多路复用似乎不是答案（参见： [https](https://groups.google.com/d/topic/sockjs/cO7lnH07RCE/discussion) ://groups.google.com/d/topic/sockjs/cO7lnH07RCE/discussion ）。

EventBus Bridge 会是正确的工具吗？每个客户端绑定一个唯一的地址，VertX server 可以响应，还是不识别就默认忽略？

这是 EventBus Bridge 的意图吗？

启动 SockJSBridge 后是否可以更改许可规则？

随机令牌（UUID？）也可以添加到入站规则“匹配”以模拟会话的工作方式。

这合理吗？或者这是否被广泛使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T11:47:18.343

EventBusBridge 允许客户端（通过 SockJS 的浏览器）与 EventBus 上的其他订阅者对话。这意味着您可以直接使用服务器端服务或其他客户端发送消息。

您不能动态更改网桥的允许/防火墙规则。但是使用正则表达式和使用 UUID，您应该能够很容易地实现聊天。让我给你举个例子：

服务器侦听 address `chat-server`。网桥中的出站设置设置为`{ "address_re" : "chat-clients\..*" }`。每个客户端注册一个处理程序`chat-clients.<some_UUID_for_this_client>`并告诉服务器将发送给客户端的消息发送到注册地址。

我们[在 Scala 中编写了一个聊天模块](https://github.com/campudus/vertx-chat)，您可以将其用作参考。

# fpu - _controlfp_s 返回高 32 位？

> ID：15554202
> 
> 赞同：0
> 
> 时间：2013-03-21T17:27:49.133
> 
> 标签：fpu

我看到 _controlfp_s unsigned int 的返回表明正在为某些 ODBC 工作设置第 32 位（认为只使用了 16 位）？

有人知道这意味着什么吗？

通常我们只看到 0x0008001F（64 位）或 0x0009001F（32 位），但在某些情况下，似乎是第 3 方驱动程序或 DLL 将其设置为 0x8009001F！！！！

我们注意到当第 3 方软件有时会随机关闭我们的应用程序。

控制字 10000000000010010000000000011111,

switchOffExceptions32bit 10010000000000011111, switchOffExceptions64bit 10000000000000011111

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:55:18.160

我在 JNA (JNI) 上使用来自 Java 的第 3 方 DLL 时遇到了同样的问题。这里描述了一个众所周知的问题[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4644270](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4644270)和一些关于这个主题的有用提示[http://blogs.msdn.com/b/dougste/archive/ 2008/11/12/随机和意外异常-flt-除以零和异常-flt-invalid-operation.aspx](http://blogs.msdn.com/b/dougste/archive/2008/11/12/random-and-unexpected-exception-flt-divide-by-zero-and-exception-flt-invalid-operation.aspx)

# javascript - 如何（或是否有必要）将 Javascript 对象转换为 Dom

> ID：15554205
> 
> 赞同：0
> 
> 时间：2013-03-21T17:27:57.303
> 
> 标签：javascript, jquery, dom, dojo

以下代码只是尝试克隆一行并重置克隆的 id：

```
rowTemplate = j('#component .form-list:first-child').clone();
var newRow = dojo.clone(rowTemplate);
dojo.attr(newRow, 'id', newRowId); 
```

然而，从萤火虫第三行给我

```
TypeError: node.setAttribute is not a function (dojo.js) 
```

从调试中我可以看到 newRow 是一个对象（对象 [#row.class]），所以问题是：如何（或是否有必要）将 Javascript 对象转换为 Dom 以使其可用于 dom 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:38:40.373

如果要使用带有dojo 方法的jQuery 对象，则必须将jQuery 对象转换为dom 元素集合。这可以使用`.get()`

```
rowTemplate = j('#component .form-list:first-child').clone();
var newRow = dojo.clone(rowTemplate.get(0));
dojo.attr(newRow, 'id', newRowId); 
```

免责声明：我不熟悉 dojo 方法。

# angularjs - 部分应用 AngularJS 指令

> ID：15554208
> 
> 赞同：1
> 
> 时间：2013-03-21T17:28:09.653
> 
> 标签：angularjs

假设我想创建“仅限桌面”和“仅限移动”指令来隐藏或显示基于环境测试的元素。有十几种方法可以解决，但一个很酷的方法是“部分应用”现有的 'ng-show' 指令。因此，“仅桌面”将等同于“ng-show="env.isDesktop"'，但实际上无需在某些父控制器中进行 env 测试并将 env 放在我的范围内。

另一个常见的例子是标签插件。我可以编写一个指令来使用和jQuery 函数`tab`来显示和隐藏元素，但这会失去指令中已有的很多功能。我不能让我的指令扩展 ngShow 指令，以便访问所有变量解析、与 ngAnimate 集成等...`show``hide``ngShow``tab`

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:02:16.643

使用隔离作用域时，您可以手动将一些变量代理到作用域中：`$scope.current.device = $rootScope.current.device;` 除此之外，您可以使用上述方法来放置`device`模型`$rootScope`并具有方法和字段，例如调用 Modernizr 的“hasTouch”等。

所以是的，这是可能的。

# html - 从 flashVars 将文本设置到剪贴板

> ID：15554210
> 
> 赞同：1
> 
> 时间：2013-03-21T17:28:16.070
> 
> 标签：html, actionscript-3, flash, actionscript, actionscript-2

我想做的事：获取 Flash Var，将 flashVar 设置为剪贴板。
html:

```
<embed src="setClip.swf" FlashVars="res=123" quality="high" TYPE="application/x-shockwave-flash"> 
```

动作脚本（3）：

```
function loaderComplete(myEvent:Event)
{
   this.flashVars=this.loaderInfo.parameters;
   this.flashVarsLoaded=true;
   this.useFlashVars();
}
function useFlashVars()
{
        aaa.text = myFlashVars.res;
}
var myFlashVars=new Object();
myFlashVars.flashVarsLoaded=false;
myFlashVars.loaderComplete=loaderComplete;
myFlashVars.useFlashVars=useFlashVars;
this.loaderInfo.addEventListener(Event.COMPLETE, myFlashVars.loaderComplete); 
```

`aaa`当我打开 html 页面时，“ ”输入中没有文本。**获取**flash var**然后将其插入剪贴板**（as1、as2、as3）
的最佳方法是什么（我需要好的示例）？

 ***** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:34:21.947

您无需等待 flashvars 加载并使用 Event.COMPLETE。Flashvars 在播放器启动时位于主类 loaderInfo.parameters 中。只需尝试`trace (this.loaderInfo.parameters["res"])`在主类中跟踪它。

1 新建fla文件，保存

2 添加到舞台文本字段（动态），设置实例名称`ft1`

3 单击主阶段，在属性面板中，类类型`main`

4`main.as`使用 fla 在 dir 中创建（步骤 1）

5个主要为：

```
package  {

    import flash.display.MovieClip;
    public class main extends MovieClip {
        public function main() {
            tf1.text = this.loaderInfo.parameters["foo"];
        }
    }
} 
```

6 文件->发布

7 转到目录（步骤 1），打开 .html 文件， `<param name="flashvars" value="foo=10" />` 在参数中添加行（两次）

8 在浏览器中打开 HTML，尽情享受

（注意：你不能在 Adob​​e Flash IDE 环境中测试 flashvars，olny 在真实浏览器中）

关于剪贴板： [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/System.html#setClipboard()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/System.html#setClipboard()) `This method works from any security context when called as a result of a user event (such as a keyboard or input device event handler).`

9 添加按钮到舞台，命名`btn`

10 main.as：

```
package  {
    import flash.display.MovieClip;
    import flash.events.MouseEvent;
    import flash.system.System;

    public class main extends MovieClip {
        public function main() {
            tf1.text = loaderInfo.parameters["foo"];
            btn.addEventListener(MouseEvent.CLICK, onClickHandler);
        }

        private function onClickHandler(e:MouseEvent):void {
            System.setClipboard(loaderInfo.parameters["foo"]);
        }
    }
} 
```

11 编译.fla，在浏览器中打开HTML，点击btn，查看剪贴板

抱歉，没有用户交互，无法“自动”填充剪贴板。请记住：读取和写入剪贴板是一个巨大的安全漏洞。****

# node.js - Grunt 中的 NodeJS 环境变量

> ID：15554215
> 
> 赞同：30
> 
> 时间：2013-03-21T17:28:20.993
> 
> 标签：node.js, environment-variables, gruntjs

我正在将我的项目从简单`node server.js`转变为使用 Grunt。

我曾经直接从 webstorm 运行我的应用程序，并且会为我设置环境变量。

我怎样才能在 Grunt 中达到同样的效果？

我需要从 webstorm (windows) 运行 grunt，或者在运行 grunt (显式) 时设置环境变量

部署时这不是问题，因为 heroku 已经负责设置我的环境变量。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-27T10:35:32.877

使用 grunt-env 插件：[https ://npmjs.org/package/grunt-env](https://npmjs.org/package/grunt-env)

并设置您的配置：

```
grunt.initConfig({
  env : {
    options : {
      //Shared Options Hash
    },
    dev : {
      NODE_ENV : 'development',
      DEST     : 'temp'
    }
  },
  'another-task': {}
}); 
```

在您的 gruntfile 中，您可能会定义一些默认任务：

```
grunt.registerTask('default', ['env', 'another-task']); 
```

所以如果你首先运行'grunt default'，你的env-vars被设置，然后'another-task'运行

如果你想通过命令行选项指定当前环境，你可以使用 grunt.option：

```
grunt.initConfig({
  env : {
    options : {
      //Shared Options Hash
    },
    dev : {
      NODE_ENV : grunt.option('environment') || 'development',
      DEST     : 'temp'
    }
  }, 
```

在这个例子中，如果你调用你的 grunt 任务，`--environment=production`将设置生产，否则将设置开发

# bash - 使用 sed 查找/替换文件名

> ID：15554219
> 
> 赞同：0
> 
> 时间：2013-03-21T17:28:32.870
> 
> 标签：bash, shell

我正在遍历目录中的每个文件，并尝试使用以下代码查找/替换文件的路径部分...

```
for f in /the/path/to/the/files/*
do
    file = $(echo $f | sec 's/\/the\/path\/to\/the\/files\///g`);
done 
```

但是，我的代码的分配部分出现以下错误...

```
cannot open `=' (No such file or directory) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:57:43.583

你必须`=`在它周围没有空格：

```
for f in /the/path/to/the/files/*
do
 file=$(echo $f | sec 's/\/the\/path\/to\/the\/files\///g');
done 
```

此外，最好使用另一个符号，而不是 /，作为 sed 分隔符：

```
for f in /the/path/to/the/files/*
do
 file=$(echo $f | sec 's@/the/path/to/the/files/@@g')
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:58:20.553

您不能在等号的任一侧放置空格：

```
for f in /the/path/to/the/files/*
do
    file=$(echo $f | sed 's/\/the\/path\/to\/the\/files\///g`);
done 
```

但是，参数扩展是实现此目的的更好方法：

```
for f in /the/path/to/the/files/*
do
    file=${f#/the/path/to/the/files/}
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T19:07:59.293

尝试：

```
for f in /the/path/to/the/files/*; do
    # no spaces around = sign
    file=$(echo $f | sed "s'/the/path/to/the/files/''g");
done 
```

# regex - 用 SED 和 REGEX 替换文本中的某些字符串

> ID：15554220
> 
> 赞同：3
> 
> 时间：2013-03-21T17:28:35.963
> 
> 标签：regex, sed

我在一个文本文件中有以下字符串（大的，更像这些和不同的）：

```
79A18D7F-1517-5981-8446-3A0452727B06
7842A72D-1517-5281-84E4-EAEF09B743F7
6040BEE7-1517-5982-84C1-419B224E647E
615F2747-1517-5981-84AF-787C34967FB2
7468A3E3-1517-5931-84B3-3FC3F701C269 
```

我可以使用 grep 和 regex 找到它们：

```
'[0-9A-F]{8}-[0-9]{4}-[0-9]{4}-[0-9A-F]{4}-[0-9A-F]{12}' 
```

删除它们的 sed 正则表达式语法是什么，因为：

```
sed "s/[0-9A-F]{8}-[0-9]{4}-[0-9]{4}-[0-9A-F]{4}-[0-9A-F]{12}//g" 
```

似乎不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T17:30:38.750

使用`sed -r`. 您依赖扩展的正则表达式语法功能而不转义它们，但`sed -r`您不必这样做。如果您想实际删除这些行而不是清除它们，您可以使用：

```
sed -r "/regex/d" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:00:12.803

此外，对于常规 sed (BRE)，您需要转义花括号：

```
sed 's/[0-9A-F]\{8\}-[0-9]\{4\}-[0-9]\{4\}-[0-9A-F]\{4\}-[0-9A-F]\{12\}//g' file 
```

# sql - VB6 SQL 根据另一个查询的结果选择结果

> ID：15554221
> 
> 赞同：0
> 
> 时间：2013-03-21T17:28:41.370
> 
> 标签：sql, vb6

我正在编写一些 VB6 代码来连接到数据库以返回特定的数据子集。所有需要的信息都在一个表中，但我在建立正确的方法来根据另一个查询的结果选择我的结果时遇到了一些麻烦。

下面是当我在那里创建查询时 Access 生成的 SQL，但我正在尝试将它们转换为在我的 VB6 应用程序中使用：

'*编辑 -

```
" & Chr(34) & lstAb.Text & Chr(34) & " 
```

以上感谢 David 推动了这段代码朝着正确的方向发展。从那里，我使用调试窗口来确认我在 Access 中的选择，这确实是一次很棒的体验。不得不稍微调整一下我的别名，但是当 Access 要求我键入应该已经声明的其他值时，一切都变得非常明显。

再次感谢大卫！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:56:57.580

最好在两个表之间进行一些适当的连接，而不是指定子查询。然而，这不是问题，我不认为。

查看代码，我相信您在标准周围缺少一些引号。你说：

```
"...clone_id = " & lstAb.Text & ") ORDER..." 
```

这应该是：

```
"...clone_id = " & Chr(34) & lstAb.Text & Chr(34) & ") ORDER..." 
```

给你在`lstAb.Text`.

测试这些函数的一种简单方法是`Debug.Print(sSql)`查看`Debug`窗口以查看 SQL 的外观。获取该 SQL 的副本，将其放入 MSAccess 中的新查询中（您可以将查询告知“查看 SQL”），然后尝试找出它出错的地方。

如果您的查询中没有嵌套查询，这将更容易查看，因为您可以查看查询设计器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:41:28.950

您指定`Details.func_ID) Like "Simp_*"`. 在您的数据样本中，没有包含`Simp_`字符串的记录

# javascript - 将 JavaScript 用于 HTML 属性值的语法

> ID：15554223
> 
> 赞同：0
> 
> 时间：2013-03-21T17:28:42.810
> 
> 标签：javascript, html

我正在尝试用 javascript 替换 html 元素属性的值。我很确定我以前见过它，但我不确定语法在这些事情上是如何工作的。例子：

```
<a href="javascript:bookmarksite('Website Name', "<script type="text/javascript">document.write(location.href);
</script>')">Click Here to Bookmark this Page</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:30:42.540

你可以这样做：HTML：

```
<a id="link" href="#">Click me</a> 
```

JavaScript：

```
document.getElementById("link").setAttribute("href", "page.html"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:50:01.903

不显眼的 JavaScript 总是处理这些事情的好方法：

```
(function(d){
    var modern = function(){
        return(d.addEventListener);
    }, event = function(obj, evt, fn){
        if(modern()) {
            obj.addEventListener(evt, fn, false);
        } else {
            obj.attachEvent("on" + evt, fn);
        }
    }, load = function(fn){
        if(modern()) {
            d.addEventListener("DOMContentLoaded", function go(){
                d.removeEventListener("DOMContentLoaded", go, false);
                fn();
            }, false);
        } else {
            d.attachEvent("onreadystatechange", function go(){
                if(d.readyState === "complete") {
                    d.detachEvent("onreadystatechange", build);
                    fn();
                }
            });
        }
    }, init = function(){
        var link = d.getElementById("bookmark_link");
        event(link, "click", function(e){
            bookmarksite("Website Name", location.href);
            // Set attribute(s) here
            link.setAttribute("href", "whatever_you_want.html");
        });
    };
    load(init);
})(document); 
```

然后在链接中：

```
<a href="#" id="bookmark_link">Bookmark this page</a> 
```

# php - 如何在 nyromodal 中使用谷歌地图 api v3

> ID：15554224
> 
> 赞同：0
> 
> 时间：2013-03-21T17:28:43.293
> 
> 标签：php, jquery, google-maps-api-3, nyromodal

我试图在我的 nyromodal 框中嵌入地图 sing google maps api v3，但它没有发生。

我已经测试了没有模态的代码，它可以工作，但是当我尝试在 nyromodal 上打开它时，什么也没有出现。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T16:57:38.667

我刚刚想出了怎么做！

1 - 在索引页面中插入 google 的 js 代码，使用 'rel="forceload"' 和 'rev="shown"'，如下所示：

`<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&sensor=false" rel="forceload" rev="shown"></script>`

2 - 您在模态页面内插入生成地图的代码，如下所示：

```
<script>
    $(document).ready({
        var mylatlng = new google.maps.LatLng(latitude, longitude);
        var mapProp = {
            center: mylatlng,
            zoom: 15,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("briefmap"), mapProp);
        var marker = new google.maps.Marker({
            position: mylatlng
        });
    });
</script> 
```

# perl - 表单提交后重定向使用 WWW::Mechanize (perl) 给出 404 错误

> ID：15554232
> 
> 赞同：2
> 
> 时间：2013-03-21T17:29:05.590
> 
> 标签：perl, parsing, www-mechanize

我正在尝试使用 Perl 中的 Mechanize获取[此站点中特定电视节目下一集的日期。](http://next-episode.net/)

```
# getting episode number & date

# create a new browser
use WWW::Mechanize;
my $browser = WWW::Mechanize->new(autocheck => 0);

# fill search form, getting to tv show page
my $url= "http://next-episode.net/";
$browser->get($url);
$browser->form_name("search");
$browser->field("search", "big bang");
$browser->click();

print $browser->content(); 
```

我无法访问电视节目网页。我只得到 404 页面：“抱歉，找不到您要查找的页面！您可能输入了错误的 url，或者链接错误或移动了。”

我填错表格了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:43:57.583

那这个呢 ？：

```
my $url = "http://next-episode.net";
my $search = "big bang";

use WWW::Mechanize;
use URI::Escape;
my $browser = WWW::Mechanize->new(autocheck => 1);

my $string = uri_escape $search;
$browser->get("$url/site-search-$string.html");

print $browser->content(); 
```

如果您想知道剩余的等待天数，请添加额外的行：

```
print "$1 days to wait\n" if $browser->content() =~ /(\d+)\s+Day\(s\)\s+/; 
```

（我在这里使用正则表达式，因为`HTML`这里很奇怪）

# java - 如何在服务器端访问内容？

> ID：15554234
> 
> 赞同：1
> 
> 时间：2013-03-21T17:29:11.773
> 
> 标签：java, http, servlets, http-post

我在客户端中使用了以下代码：

```
HttpPost post = new HttpPost(url);
post.setEntity(new ByteArrayEntity(myString.getBytes("UTF8")));
HttpResponse response = this.execute(post); 
```

我现在想访问服务器端的字符串。处理方法如下所示：

```
public void handle(String target, Request baseRequest, HttpServletRequest request,
HttpServletResponse response) throws IOException, ServletException { ... } 
```

该请求只允许我访问内容长度和类型，而不是内容本身。任何指针？

我使用 java 作为 pl 和 javax.servlet 的内置类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:09:38.510

由于某种原因，您已将字符串设置为唯一的 HTTP 请求正文，而不是请求参数。因此，要获得它，您需要阅读整个 HTTP 请求正文。这是在可用的 servlet 中

```
InputStream input = request.getInputStream();
// Read it into a String the usual way (using UTF-8). 
```

请注意，当它已经被预先读取时，这将返回一个空流，例如，通过`getParameter()`预先调用相同的请求，这将隐式解析 POST 请求正文。

更理智的方法是将其作为普通 URL 编码的请求参数发送，如下所示（就像默认情况下的那些 HTML 表单一样）

```
List<NameValuePair> params = new ArrayList<NameValuePair>();
params.add(new BasicNameValuePair("myString", myString));
post.setEntity(new UrlEncodedFormEntity(params)); 
```

这样你就可以在 servlet 中做

```
String myString = request.getParameter("myString");
// ... 
```

# mysql - 插入后MySQL触发更新行

> ID：15554235
> 
> 赞同：2
> 
> 时间：2013-03-21T17:29:13.887
> 
> 标签：mysql, triggers, sql-update

我有 2 张桌子，`Ratings`并且`Recipes`.

插入后，`Ratings`我需要找到额定配方的所有评分的平均值，并更新表`Rating_Avg`中的列`Recipes`。

这可行，但我相信`Recipes.Rating_Avg`当我只需要更新Recipe_No =最近评级Recipe_No的行时，它会更新所有行。

```
CREATE TRIGGER `update_avg` AFTER INSERT ON `Ratings`
 FOR EACH ROW UPDATE Recipes
SET Rating_Avg = (SELECT AVG(Rating) from Ratings where Ratings.Recipe_No=Recipes.Recipe_No) 
```

我觉得我需要添加一个`WHERE Recipe_No = NEW.Recipe_No`，但我不确定在哪里添加它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T17:43:13.147

每次触发触发器时，您确实都在更新食谱中的所有行。使用 NEW.Recipe_No 伪列，您可以将更新限制为仅受影响的食谱记录：

```
CREATE TRIGGER update_avg AFTER INSERT ON `Ratings`
FOR EACH ROW UPDATE Recipes
  SET Rating_Avg = (SELECT AVG(Rating) from Ratings where Ratings.Recipe_No=Recipes.Recipe_No)
WHERE Recipes.Recipe_No=NEW.Recipe_No 
```

# msbuild - TFS2012 - 对 MSBuild 参数进行故障排除以设置自动部署

> ID：15554245
> 
> 赞同：0
> 
> 时间：2013-03-21T17:29:35.513
> 
> 标签：msbuild, msdeploy, iis-8, automated-deployment

我们正在尝试通过 MSBuild 和 MSDeploy 通过 TFS 2012 设置自动部署，但是当我们的生产服务器尝试部署到开发服务器时，我们收到超时。所有相关端口都已打开，部署工具和服务已安装并启动，我们必须继续进行的错误的唯一证据是来自开发服务器的 IIS Web 管理日志文件夹的日志文件，它显示 404尝试部署时。

MSBuild 参数：

```
/p:DeployOnBuild=True
/p:UserName=*****
/p:Password=*****
/p:AllowUntrustedCertificate=True
/p:DeployTarget=MsDeployPublish
/p:CreatePackageOnPublish=True
/p:MSDeployPublishMethod=WMSVC
/p:MSDeployServiceUrl=http://*******:8172/msdeploy.axd
/p:DeployIISAppPath="DeployTest" 
```

Visual Studio 构建错误：

```
C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\Web\Microsoft.Web.Publishing.targets (4377): Web deployment task failed. (Could not complete the request to remote agent URL 'http://****:8172/msdeploy.axd?site=Default Web Site'.)

Could not complete the request to remote agent URL 'http://****:8172/msdeploy.axd?site=Default Web Site'.
The operation has timed out 
```

# sql - 在 Ruby、Activerecord 或 Postgresql 中按周对活动进行分组和计数

> ID：15554246
> 
> 赞同：3
> 
> 时间：2013-03-21T17:29:38.607
> 
> 标签：sql, ruby-on-rails-3, postgresql, datetime, aggregate-functions

我有一份长达数年的活动日志。我被要求计算该应用程序每个用户的每周参与度。我将参与度定义为用户在任何一周内进行一项或多项记录活动。

我如何对这些活动进行分组并按周为每个用户计数？[我已经阅读了很多不同的帖子，关于ruby​​ 方法](https://stackoverflow.com/questions/902974/grouping-by-week-month-etc-activerecord)、[sql](https://stackoverflow.com/questions/11675788/calculate-month-statistics)还是 arel 语法是否最好似乎存在争议。我的用户不超过 500 个，因此性能与其说是简洁的事情一样重要。

我已经成功地尝试了这个：

```
user = User.first.activity_logs.group_by { |m| m.created_at.beginning_of_week } 
       # => {Mon, 11 Mar 2013 00:00:00 EDT -04:00=>
             [#<ActivityLog id: 12345, user_id: 429, ... ]} 
```

然后唯一的下一步是我可以毫无错误地返回任何东西：

```
user.map { |week| week.count } => [2, 2, 2, 2, 2, 2, 2, 2] 
```

所以看起来我把这件事弄得太复杂了。我如何简洁地计算每周的活动数量并为每个用户执行此操作？

我只是想要一些我最终可以粘贴到电子表格（例如，下面）中的东西，以便为经理制作热图或其他图表。

```
| User          | Week            | Activity|
| ------------- | :-------------: | -------:|
| jho           | 2013-1          | 20      |
| bmo           | 2013-1          | 5       |
| jlo           | 2013-1          | 11      |
| gdo           | 2013-2          | 2       |
| gdo           | 2013-5          | 3       |
| jho           | 2013-6          | 5       | 
```

### 编辑

作为其他人的参考：
Rails 3.1
Using PostgreSQL 9.1.4
Here is the schema file from ruby​​ on rails

```
create_table "activity_logs", :force => true do |t|
  t.integer  "user_id"
  t.string   "activity_type"
  t.datetime "created_at"
  t.datetime "updated_at"
end

| ------+| --------+| ----------------+| ----------------+ | ----------------+ | 
| id     | user_id  | activity_type    | created_at        | updated_at        | 
| ------+| --------+| ----------------+| ----------------+ | ----------------+ | 
| 28257  | 8        | User Signin      | 2013-02-14 1...   | 2013-02-14 1...   | 
| 25878  | 7        | Password Res...  | 2013-02-03 1...   | 2013-02-03 1...   | 
| 25879  | 7        | User Signin      | 2013-02-03 1...   | 2013-02-03 1...   | 
| 25877  | 8        | Password Res...  | 2013-02-03 1...   | 2013-02-03 1...   | 
| 19325  | 8        | Created report   | 2012-12-16 0...   | 2012-12-16 0...   | 
| 19324  | 9        | Added product    | 2012-12-16 0...   | 2012-12-16 0...   | 
| 18702  | 8        | Added event      | 2012-12-15 1...   | 2012-12-15 1...   | 
| 18701  | 1        | Birthday Email   | 2012-12-15 0...   | 2012-12-15 0...   | 
| ------+| --------+| ----------------+| ----------------+ | ----------------+ | 
```

### 解决方案

修改@Erwin Brandstetter 的命令，我在命令行上得到了想要的结果：

```
ActivityLogs.find_by_sql("
  SELECT user_id, to_char(created_at, 'YYYY-WW') AS week, count(*) AS activity
  FROM   activity_logs
  GROUP  BY 1, 2
  ORDER  BY 1, 2;") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T01:23:26.790

[我从@ideamotor](https://stackoverflow.com/a/15560899/939860)借了测试表并简化了它。活动类型无关紧要，将每个活动计算为`1`：

```
CREATE TEMP TABLE log(usr text, day date);
INSERT INTO log VALUES 
  ('bob' , '2012-01-01')
 ,('bob' , '2012-01-02')
 ,('bob' , '2012-01-14')
 ,('susi', '2012-01-01')
 ,('susi', '2012-01-14'); 
```

查询（不会比这更*简洁*）：

```
SELECT usr, to_char(day, 'YYYY-WW') AS week, count(*) AS activity
FROM   log
GROUP  BY 1, 2
ORDER  BY 1, 2; 
```

结果：

```
usr  | week     | activity
-----+----------+---------
bob  | 2012-01  | 2
bob  | 2012-02  | 1
susi | 2012-01  | 1
susi | 2012-02  | 1 
```

[`to_char()`](http://www.postgresql.org/docs/current/interactive/functions-formatting.html)使这非常简单。我在这里引用[手册](http://www.postgresql.org/docs/current/interactive/functions-formatting.html#FUNCTIONS-FORMATTING-DATETIME-TABLE)：

> `WW` 一年中的周数 (1-53)（第一周从一年的第一天开始。）

作为替代考虑：

> `IW`ISO 一年中的周数（01 - 53；新年的第一个星期四在第 1 周。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T00:53:59.903

这是在 Postgresql 中。这里的诀窍是你需要生成你的 year-weekofyear 值。在这里，我从日期中提取信息并将其连接起来。

在这里，我确保“2012-01-01”不被算作第 52 周。我正在超越标准。您可能需要根据您定义周数的方式更改此功能。

```
create temp table daily_log(person character varying, activity numeric, 
    dayof date);
insert into daily_log values 
     ('bob'    ,1,'2012-01-01')
    ,('bob'    ,1,'2012-01-02')
    ,('bob'    ,0,'2012-01-14')
    ,('charlie',1,'2012-01-01')
    ,('charlie',1,'2012-01-14')

select person 
 ,extract('year' from dayof) || '-' || 
    case when extract('week' FROM dayof) >= 52 
         and extract('month' FROM dayof) = 1 
    then 1 
 else extract('week' FROM dayof) end as weekof
,sum(activity) as activity_cnt
from daily_log
group by weekof, person
order by person, weekof; 
```

这会让你：

```
| person        | weekof          | activity_cnt|
| -------------:| :--------------:| -----------:|
| bob           | 2012-1          | 2           |
| bob           | 2012-2          | 0           |
| charlie       | 2012-1          | 1           |
| charlie       | 2012-2          | 1           | 
```

为什么我用2012，我不知道。

这是 postgresl 手册中关于提取一周的内容（[http://www.postgresql.org/docs/9.2/static/functions-datetime.html](http://www.postgresql.org/docs/9.2/static/functions-datetime.html)）：

“这一天所在的一年中的周数。根据定义 (ISO 8601)，一年的第一周包含该年的 1 月 4 日。（ISO-8601 周从星期一开始。）换句话说，一年中的第一个星期四在该年的第 1 周。（仅适用于时间戳值）

因此，1 月初的日期可能是上一年第 52 周或第 53 周的一部分。例如，2005-01-01 是 2004 年第 53 周的一部分，2006-01-01 是 2005 年第 52 周的一部分。”

# c# - 为什么以下 WPF 路径被切断

> ID：15554247
> 
> 赞同：-2
> 
> 时间：2013-03-21T17:29:39.343
> 
> 标签：c#, wpf, xaml, geometry

我有以下代码使用 WPF Path 对象。我从有很多免费图标的 Syncfusion MetroStudio 2 获得几何数据。但是，每当我尝试使用它们时，它们都会被切断。下面的图标应该显示房子，但在下面的边界内被切断。我的路径有问题吗？

```
<Grid>
  <Grid.Resources>
     <Geometry x:Key="HomeGeometry">M31.427,15.523L53.103,34.871 53.103,59.723C53.088,60.666 52.466,61.263 51.961,61.544 51.426,61.845 50.850,61.972 50.232,61.976L38.688,61.976C38.290,61.976 37.902,61.821 37.619,61.544 37.340,61.272 37.179,60.890 37.179,60.502L37.179,48.548 25.677,48.548 25.677,60.502C25.677,60.890 25.514,61.272 25.235,61.544 24.953,61.821 24.564,61.976 24.167,61.976L12.622,61.976C12.008,61.972 11.428,61.845 10.895,61.544 10.390,61.263 9.767,60.666 9.752,59.723L9.752,34.871z M31.430,0C32.412,0,33.395,0.347,34.172,1.042L61.536,25.469C63.191,26.947 63.306,29.454 61.791,31.072 60.273,32.685 57.703,32.796 56.048,31.319L31.427,9.342 6.806,31.319C6.024,32.015 5.043,32.358 4.067,32.358 2.964,32.358 1.868,31.925 1.065,31.072L1.062,31.066C-0.447,29.454,-0.335,26.945,1.319,25.469L28.686,1.042C29.464,0.347,30.447,0,31.430,0z
     </Geometry>
  </Grid.Resources>
  <Border
     Width="50" BorderBrush="LightBlue"
     Height="50" BorderThickness="2"
     HorizontalAlignment="Stretch"
     VerticalAlignment="Stretch"
     Focusable="False">
     <Path Data="{StaticResource HomeGeometry}" Fill="Red"/>
  </Border> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:52:10.580

我想你想要的是

```
...
<Path Data="{StaticResource HomeGeometry}" Fill="Red" Stretch="Uniform"/>
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:53:17.813

![在此处输入图像描述](../Images/1756f3496fa090f3394e70c1145c815a.png)

如我们所见，您的边框设置为 Width=50 和 Height=50，我们清楚地看到您的图标比那个大。

您的代码应该是：

```
<Border
  Width="64" BorderBrush="LightBlue"
  Height="64" BorderThickness="2"
  HorizontalAlignment="Stretch"
  VerticalAlignment="Stretch"
  Focusable="False">
  <Path Data="{StaticResource HomeGeometry}" Fill="Red"/>
</Border> 
```

编辑：

或者，如果您希望您的图标为 50x50，请执行“500 - internal..”所说的操作，它会通过添加 Stretch="Uniform" 将您的图标拉伸到 50x50

# python - 如何检查第 n 个元素是否存在于 Python 列表中？

> ID：15554255
> 
> 赞同：14
> 
> 时间：2013-03-21T17:30:02.500
> 
> 标签：python, list

我在 python 中有一个列表

```
x = ['a','b','c'] 
```

有 3 个元素。我想检查是否存在第四个元素而不收到错误消息。

我该怎么做？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-21T17:31:02.377

您检查长度：

```
len(x) >= 4 
```

或者你捕捉到`IndexError`异常：

```
try:
    value = x[3]
except IndexError:
    value = None  # no 4th index 
```

您使用什么取决于您可以*期望*出现第四个值的频率。如果它通常在那里，请使用异常处理程序（*最好请求原谅*）；如果您大多*没有*第四个值，请测试长度（*在您跳跃之前查看*）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T17:32:14.693

您想检查列表是否包含 4 个或更多元素？

```
len(x) >= 4 
```

您想检查一个系列中的第四个元素是否在列表中？

```
'd' in x 
```

# typo3 - pdf文件的Typo3 favicon

> ID：15554259
> 
> 赞同：0
> 
> 时间：2013-03-21T17:30:08.070
> 
> 标签：typo3

我有一个带有 Typo3 的网站，我生成了一个 favicon 并用打字稿把它放到网上。但是当我打开一个可以在我的网站上下载的 pdf 文件时，会出现标准的typo3 图标。我怎样才能改变这个？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:13:51.910

This is not really a typo3-question. The cache of favicons is very persistent. If you ever opened the download with the old favicon, in most cases, this issue appears. Try to delete the whole browser cache, visit the page with an other browser or enable private browsing and try again.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T13:06:25.300

制作一个真正的 ico（不是 png），将其命名为 favicon.ico 并将其放入您的 Web 根目录。然后通过 www.yourserver.com/favicon.ico 加载 ico，看看它现在是否工作。

# c# - ASP.NET MVC - 从控制器连接到 Web 服务时出现 401 错误

> ID：15554264
> 
> 赞同：1
> 
> 时间：2013-03-21T17:30:27.423
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, web-services, cross-domain

我正在尝试对“Web 服务”进行跨域调用（我之所以这么说是因为它只是一个根据查询字符串值返回 XML 的站点）但没有运气。每次我提出请求时，我都会收到一个`(401) Unauthorized`错误。但是，我可以将链接放在我的浏览器中，然后更改查询字符串以获取结果，因此我应该可以从我的计算机访问该站点。以下是我正在尝试使用的代码，有人可以提供任何建议吗？

对 Web 服务的调用源自页面视图中的 Ajax 调用。该代码粘贴在下面：

```
function GetProgramDetails() {
    var searchItem = $('.searchbox').val();
    var request = $.ajax({
        type: 'POST',
        url: '@Url.Action("compSearch", "Home")',
        data:
            {
                searchFilter: searchItem,
                url: location.protocol + '//' + location.host 
            },
        dataType: 'html',
        success: function (data) {
            console.log(data);
            alert(data);
        },
        error: function (data) {
            console.log(data);
            alert("Unable to process your resquest at this time.");
        }
    });
} 
```

这会调用下面的视图控制器：

```
 [HttpPost]
    public string compSearch(string searchFilter, string url)
    {
        string results = string.Empty;
        string URL =
            "http://quahildy01/xRMDRMA02/xrmservices/2011/OrganizationData.svc/AccountSet?$select=AccountId,Name,neu_UniqueId&$filter=startswith(Name,'" +
            searchFilter + "')";

        try
        {
            WebRequest myWebRequest = WebRequest.Create(URL);
            myWebRequest.Headers.Add("Access-Control-Allow-Origin", url);

            WebResponse myWebResponse = myWebRequest.GetResponse();
            Stream myFileStreamResult = myWebResponse.GetResponseStream();
            Encoding encoder = System.Text.Encoding.GetEncoding("utf-8");
            StreamReader readStream = new StreamReader(myFileStreamResult, encoder);

            results = readStream.ReadToEnd();
        }
        catch (Exception ex)
        {

            results = ex.InnerException.ToString();
        }

        return results;
    } 
```

# asp.net-mvc - IE 文档模式更改无效

> ID：15554270
> 
> 赞同：1
> 
> 时间：2013-03-21T17:30:47.487
> 
> 标签：asp.net-mvc, internet-explorer, knockout.js, signalr

在我们的组织中，我们有一项适用于所有用户的策略，以使 IE9 进入 IE7 呈现模式，以便与某些第三方应用程序兼容。我正在开发一个使用 SignalR 和 KnockoutJS 的新应用程序，并且我正在使用强制 IE 处于 IE9 模式

`<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />`

但由于某种原因 IE 没有切换？如果我进入开发人员工具，则表明该应用程序以 IE9 模式呈现，但实际上并不能正常工作。如果我在没有打开开发人员工具的情况下刷新 IE，它就会损坏，但是如果我在使用开发人员工具打开的情况下刷新 IE，应用程序就会开始工作。手动切换到 IE9 渲染模式也可以解决此问题。问题是我们有很多用户，因此为每个人手动执行此操作是不切实际的。

确切的问题是只有 init 似乎不起作用。即使在这种混乱的状态下，IE 也可以在页面最初加载时向所有其他客户端发布消息，在应用了策略的 IE9 上没有返回任何帖子。该应用程序在 Firefox 和 Chrome 中运行良好。

我还在 web.config 中包含了 X-UA-Compatible 标签，但无济于事。我是 SignalR 和 KnockoutJS 的新手，所以也许我错过了什么？

```
<script>
    $(function () {

        function Post(message, author, postedDate) {
            this.message = ko.observable(message);
            this.author = ko.observable(author);
            this.postedDate = ko.observable(postedDate);
            this.postedDateText = ko.observable("");
        }

        function PostsViewModel() {
            this.hub = $.connection.messageHub;
            this.posts = ko.observableArray([]);
            this.msg = ko.observable("");
            this.lengthRemaining = ko.observable(1000);

            this.canPost = ko.computed(function () {
                return this.msg().length > 0 && this.msg().length <= 1000;
            }, this);

            if (ko && ko.bindingHandlers) {
                ko.bindingHandlers['jEnable'] = {
                    'update': function (element, valueAccessor) {
                        var value = ko.utils.unwrapObservable(valueAccessor());
                        var $element = $(element);
                        $element.prop("disabled", !value);

                        if ($element.hasClass("ui-button")) {
                            $element.button("option", "disabled", !value);
                        }
                    }
                };
            }

            this.msg.subscribe(function (newValue) {
                this.lengthRemaining(1000 - newValue.length);
            }, this);

            this.updateTime = function () {
                for (var i = 0; i < this.posts().length; i++) {
                    console.log(this.posts()[i].postedDate());
                    var date = new Date(this.posts()[i].postedDate());
                    var curDate = new Date();
                    var diff = curDate - date;

                    if (diff < 60000) {
                        this.posts()[i].postedDateText("Less than a minute ago");
                    } else if (diff >= 60000 && diff < 120000) {
                        this.posts()[i].postedDateText(Math.round(diff / 60000).toString() + " minute ago");
                    } else if (diff >= 120000 && diff < 3600000) {
                        this.posts()[i].postedDateText(Math.round(diff / 60000).toString() + " minutes ago");
                    } else if (diff >= 3600000 && diff < 7200000) {
                        this.posts()[i].postedDateText("one hour ago");
                    } else if (diff >= 7200000 && diff < 86400000) {
                        this.posts()[i].postedDateText(Math.round(diff / 3600000).toString() + " hours ago");
                    } else {
                        var month = date.getMonth() + 1;
                        var day = date.getDate();
                        var year = date.getFullYear();
                        this.posts()[i].postedDateText(year + "/" + month + "/" + day);
                    }
                }                    
            };

            this.sendPost = function () {
                this.hub.server.send(this.msg(), "@User.Identity.Name.Replace(@"ACCOUNTS\","")");
                this.msg("");
                $("#dialog").dialog("close");
            };

            this.cancelPost = function () {
                $("#dialog").dialog("close");
                this.msg("");
            };

            this.init = function () {
                console.log("init");
                this.hub.server.getMessages();
                window.setInterval(function () { postsViewModel.updateTime(); }, 30000);
            };

            this.hub.client.populateMessages = function (postsArray) {
                console.log("populate posts");
                var postsCollection = $.map(postsArray, function (post) {
                    return new Post(post.message, post.author, post.postedDate);
                });

                postsCollection.forEach(function (post) {
                    postsViewModel.posts.push(post);
                });

                postsViewModel.updateTime();
            };

            this.hub.client.updateMessage = function (post) {
                console.log("received a post");
                postsViewModel.posts.unshift(new Post(post.message, post.author, post.postedDate));
                postsViewModel.updateTime();
            };
        };

        var postsViewModel = new PostsViewModel();
        ko.applyBindings(postsViewModel);

        $.connection.hub.start().done(function () {
            console.log("started!");
            postsViewModel.init();
        }).fail(function () {
            console.log("Could not connect!");
        });

        $("#newpost-button").button().click(function () {
            $("#dialog").dialog("open");
        });

        $("#cancel-button").button();
        $("#post-button").button();

        $("#dialog").dialog({
            autoOpen: false,
            height: 256,
            width: 543,
            modal: true,
            close: function () {
                postsViewModel.cancelPost();
            }
        });
    });
</script> 
```

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T17:34:46.153

@Lukasz 如果您将 start() 代码更改为下面的代码会发生什么？

```
$.connection.hub.start().done(function () {
console.log("started!");
$.connection.messageHub.server.getMessages();

    }).fail(function () {
        console.log("Could not connect!");
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T19:05:57.910

结果在这种特定情况下，console.log("") 行在 IE7 渲染模式下阻塞了 IE9，该模式被强制返回 IE9 模式，并且它之后的任何行都不会被调用。从代码中删除 console.log 行解决了这个问题。

# php - PHP中的JSON解析不起作用

> ID：15554271
> 
> 赞同：0
> 
> 时间：2013-03-21T17:30:50.440
> 
> 标签：php, json, parsing

我正在尝试第一次使用 PHP 解析 JSON 并遇到一些问题。我四处搜索，甚至遵循了 SO 的一些解决方案，但没有运气。

所以我的PHP看起来像：

```
$string = file_get_contents("SOME_URL_HERE");
$json_a = json_decode($string);

foreach($json_a->items as $mydata)

    {
         echo $mydata->uploader . "\n"; 
    } 
```

并且那个 JSON url 显示的数据看起来像（我已经稍微减少了）：

```
{
 'apiVersion': '2.1',
 'data': {
   'updated': '2013-03-21T16:27:35.191Z',
   'totalItems': 18620,
   'startIndex': 1,
   'itemsPerPage': 5,
   'items': [
     {
       'id': 'DiiDwOJqwQg',
       'uploaded': '2012-12-22T15:20:51.000Z',
       'updated': '2013-03-18T14:44:08.000Z',
       'uploader': 'paramountmoviesuk', 
```

任何想法我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:34:32.007

看起来像`items`在`data`，所以你可能需要这样做

```
foreach($json_a->data->items as $mydata) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:31:30.253

尝试`json_decode( $string, true);`然后您可以轻松到达`$mydata['uploader']`

编辑：如果你不想使用对象映射，你可以用这个语句循环它；

```
foreach( json_a['data']['items'] as $my_data)
{
    echo $my_data['uploader'] . "\n";
} 
```

如果它不起作用，请确保它是[本](http://jsonlint.com/)网站中的有效 json

# java - 使用 Spring 进行数据库和网页集成

> ID：15554272
> 
> 赞同：1
> 
> 时间：2013-03-21T17:30:50.820
> 
> 标签：java, database, spring, dao, dto

我正在编写我的第一个 java/DB/web 应用程序。我是 java/javascript/css/html 的新手，所以这个项目对我来说是一次学习经历。该应用程序将在网页中显示来自数据库的结果，还允许用户从网页编辑/添加信息到数据库。

我用的是spring，程序的大体流程如下：Web Page -> some javascript -> Reference Rest Service -> Reference Service -> DAO -> DTO -> DB

问题是应用程序当前对每个查询都有不同的 DAO 和 DTO。我想简化程序，以便有一个可以处理所有查询的 DAO 和 DTO。

我正在尝试创建一个可以处理 2 到 10 个不同插槽的 DTO，我希望每个插槽都有一个名称而不是与之关联的数字。我也相信插槽的名称应该由数据库的返回来设置。然后我需要一种可靠的方法将数据映射到 DAO 中的行。我将发布一些简单的示例代码来展示我正在使用的内容。

```
@Repository
public class DecisionLevelDaoImpl implements DecisionLevelDao {

private JdbcTemplate jdbcTemplate;

@Autowired
public DecisionLevelDaoImpl(JdbcTemplate jdbcTemplate) {
    this.jdbcTemplate = jdbcTemplate;
}
private static String FIND_ACTIVE_DECISION_LEVEL = DaoHelper
        .loadResourceToString("queries/DecisionLevel_FindActive.sql");
@Override
public List<DecisionLevelDTO> findActiveDecisionLevel() {
    return jdbcTemplate.query(FIND_ACTIVE_DECISION_LEVEL, new DecisionLevelDTORowMapper());
}
private class DecisionLevelDTORowMapper implements RowMapper<DecisionLevelDTO> {
    @Override
    public DecisionLevelDTO mapRow(ResultSet rs, int rowNum) throws SQLException {
        String levelCd = rs.getString("LevelCd");
        String levelName = rs.getString("LevelName");
        String levelInstruct = rs.getString("LevelInstruct");
        String active = (rs.getBoolean("active") ? "Y" : "N");
        String printOrder = Integer.toString(rs.getInt("PrintOrder"));
        String lastUpdUser = rs.getString("LastUpdUser");
        return new DecisionLevelDTO (levelCd, levelName,
                   levelInstruct, active, printOrder,lastUpdUser);
    }
} 
```

这是 DTO：

```
import org.codehaus.jackson.annotate.JsonProperty;

public class DecisionLevelDTO {

@JsonProperty("levelCd")
private String levelCd;
@JsonProperty("levelName")
private String levelName;
@JsonProperty("levelInstruct")
private String levelInstruct;
@JsonProperty("active")
private String active;
@JsonProperty("printOrder")
private String printOrder;
@JsonProperty("lastUpdUser")
private String lastUpdUser;

public DecisionLevelDTO () { }
public DecisionLevelDTO (String levelCd, String levelName,
        String levelInstruct, String active, String printOrder,
        String lastUpdUser) {
    super();
    this.levelCd = levelCd;
    this.levelName = levelName;
    this.levelInstruct = levelInstruct;
    this.active = active;
    this.printOrder = printOrder;
    this.lastUpdUser = lastUpdUser;
} 
```

目前大约有 25 个 Dao 和 25 个 DTO。这似乎非常重复，我很想找到一种更易于维护的方法。

我不是在寻找任何人来编写我的代码，我这样做是为了学习，所以免费代码根本对我没有帮助。我看到的所有教程都有一个 DAO 和一个 DTO，它们从单个查询返回结果。

抱歉，如果这是此类问题的错误论坛。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T06:08:06.647

我现在明白你的意思了。您可以做的是为 DML 和 DQL 查询创建单独的通用方法。

这些方法将接受**查询**和一个**ResultSet**（在 DQL 的情况下）或**PreparedStatement**（在 DML 的情况下）。同样，您可以根据需要将 DML 划分为 Update/Delete/INsert。

现在，当您收到查询时，您知道查询的作用。因此，将**ResultSet**或**PreparedStatement**设置为适用，并将查询与它一起传递并获取结果。
如果不清楚，请告诉我。

# qt - 如何在 Qt 表单类中调整 OpenGL 小部件的大小

> ID：15554274
> 
> 赞同：1
> 
> 时间：2013-03-21T17:30:58.773
> 
> 标签：qt, opengl, resize, widget, qglwidget

我在 Qt 表单类 ( ) 中`myWidget`的`QVBoxLayout`( ) 中有一个 OpenGL 小部件 ( )。`verticalLayout_2``MyForm`

我想在调整表单大小时调整 OpenGL 小部件的大小。

我应该在 changeEvent 方法中写什么，以`QVBoxLayout`将 OpenGL 小部件的大小调整为新大小？

```
MyForm::MyForm(QWidget *parent) :
    QDialog(parent),
    ui(new Ui::MyForm)
{
    ui->setupUi(this);
    myWidget = new GL_Widget;
    ui->verticalLayout_2->addWidget( myWidget );
    adjustSize();
}

void MyForm::changeEvent(QEvent *e)
{
    // What should I write here?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:46:47.190

您不必编写任何代码来自动调整子小部件的大小。（此外，`changeEvent()`无论如何，这不是用于此目的的正确事件处理程序。）

您的问题可能与您使用 Qt Designer 创建的布局有关。您可能将垂直布局从侧边栏拖到表单小部件中，这实际上并没有创建顶级布局。很容易犯这个错误。

相反，请执行以下操作之一以在 Qt Designer 中创建顶级布局：

*   右键单击对象检查器中的顶级（表单）小部件，然后从“布局”菜单中选择一种布局。

*   选择您的顶级小部件并单击工具栏中的布局图标之一：

    ![qt 设计器工具栏](../Images/238d76b23a7941a0ce39dc7232794139.png)

如果您正确设置了布局，则无需添加任何代码。如果您在 Qt Designer 中预览表单，您的布局将自动更新。

# c# - C# WP8 如何在用户退出应用程序后运行代码

> ID：15554277
> 
> 赞同：0
> 
> 时间：2013-03-21T17:31:04.913
> 
> 标签：c#, windows-phone-8

假设我有一个天气应用程序，它在主屏幕上有一个显示纽约当前温度的磁贴。我想每 5 分钟更新一次该图块中的温度（在用户存在应用程序之后）。我该怎么做（用户退出后运行代码）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:34:57.130

您应该使用所谓的[后台代理](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202942%28v=vs.105%29.aspx)。具体来说，使用周期性任务。

# php - 如果没有显示正确的数据，则 DateTime 类

> ID：15554278
> 
> 赞同：1
> 
> 时间：2013-03-21T17:31:09.740
> 
> 标签：php, datetime

我第一次使用 DateTime 类在不同时区之间进行转换。

这是我所拥有的

```
$USER_TIME_ZONE = new DateTimeZone('America/Los_Angeles');
$UTC = new DateTimeZone('UTC');
$schedule_date = new DateTime($call['triggerOn'], $USER_TIME_ZONE);
echo $schedule_date->format('m/d/Y h:i A');

$schedule_date = new DateTime($call['triggerOn'], $UTC);
echo $schedule_date->format('m/d/Y h:i A'); 
```

这是我如何处理我的结果并尝试转换它们

```
foreach ( $activities AS $call){ 
    $USER_TIME_ZONE = new DateTimeZone('America/Los_Angeles');
    $UTC = new DateTimeZone('UTC');
    $schedule_date = new DateTime($call['triggerOn'], $UTC);
    echo $schedule_date->format('m/d/Y h:i A');
 } 
```

以下是 $call['triggerOn'] 的值

```
2013-02-27 18:00:37
2013-02-02 01:11:07
2013-01-10 17:12:14
2013-02-27 22:29:42
2013-02-27 22:28:38
2013-02-25 21:53:12
2013-02-14 14:35:48
2012-12-13 14:03:16
2013-03-04 19:04:20
2013-03-01 18:52:48
2013-03-05 15:46:56
2013-03-11 15:26:17
2013-02-07 18:17:30
2013-03-05 18:04:25 
```

我的两个输出都是一样的！我不明白为什么。是否需要在服务器端进行配置，因为我在 Windows Server 2008 R2 上运行 PHP。感谢您的帮助和时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:49:27.790

DateTime::format() 方法返回创建数据的时区中的时间。没有进行转换。因此，无论您传入哪个时区，您的输出时间都将与输入时间相同。您可以通过在格式参数中添加“e”来验证这一点。您会看到，在第一种情况下，时区是 America/Los_Angeles，在第二种情况下是 UTC。

您可能正在尝试转换时区之间的时间，对吗？为此，只需在一个时区创建一个新的 DateTime 对象，使用第二个时区调用 setTimezone 方法，然后格式化结果。

所有这些都假设 $call['triggerOn'] 值既不是时间戳也不是带有标识的时区的值。在这种情况下， DateTime 构造函数的第二个参数将被忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:40:34.573

知道 $call['triggerOn'] 的价值会有所帮助，但这是否可行：

```
$USER_TIME_ZONE = 'America/Los_Angeles';
$UTC = 'UTC';
$schedule_date = new DateTime( $call['triggerOn'], $USER_TIME_ZONE );
echo $schedule_date->format( 'm/d/Y h:i A' );

$schedule_date = new DateTime( $call['triggerOn'], $UTC );
echo $schedule_date->format( 'm/d/Y h:i A' ); 
```

基本上，与其创建新的 DateTime 对象以用作其他新 DateTime 对象的参数，不如只使用时区字符串呢？那样有用吗？

# caching - 如何使用 Razor 动态查询和 WebCache 缓存页面的多个版本

> ID：15554282
> 
> 赞同：0
> 
> 时间：2013-03-21T17:31:15.910
> 
> 标签：caching, dynamic, razor, asp.net-webpages, webmatrix-2

我决定实施缓存来提高产品页面的性能。

每个页面都包含大量产品的图像。

我在 Razor 视图中创建了以下代码。

```
@{   
var productID = UrlData[0].AsInt();
var cacheItemKey = "products"; 
var cacheHit = true; 
var data = WebCache.Get(cacheItemKey);

var db = Database.Open("adldb");
if (data == null) { 
cacheHit = false; 
} 
if (cacheHit == false) {   
data = db.Query("SELECT * FROM Products WHERE ProductID = @0", productID).ToList();
WebCache.Set(cacheItemKey, data, 1, false);
}
} 
```

我正在使用带有以下代码的数据：

```
@foreach (dynamic p in data)
{
<a href="~/Products/View/@p.ProductID"
<img src="~/Thumbnail/@p.ProductID"></a>
} 
```

缓存代码运行良好，但是当传递新的查询字符串参数（更改页面版本）时，浏览器中的结果与声明的兑现时间相同。

如何缓存页面的每个版本？

谢谢

奥列格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:52:50.420

一个非常简单的方法可能是将您的密钥 ( `productID`) 转换为字符串**并将其附加到您的** `cacheItemKey`.

所以你可以考虑换行：

```
var cacheItemKey = "products"; 
```

读书：

```
var cacheItemKey = "products" + productID.ToString(); 
```

这应该会产生您正在寻找的行为 - 基本上是模仿`VaryByParam`设置。

附言。请记住，我没有添加任何类型的防御代码，**您应该这样做。**

希望有帮助。

# c# - 从 Metro 应用程序共享附件和文本

> ID：15554284
> 
> 赞同：1
> 
> 时间：2013-03-21T17:31:18.610
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml

我正在使用 c# 开发 Metro 应用程序。我想将一些带有主题和邮件正文的附件分享给 mailto 应用程序。我这样编码

```
DataRequest request = args.Request;
DataRequestDeferral deferral = request.GetDeferral();
request.Data.Properties.Title = Constants.EMAIL_SUBJECT;
request.Data.SetText(Constants.EMAIL_TEXT);
smiFile = await Windows.Storage.ApplicationData.Current.LocalFolder.GetFileAsync(Constants.SMI_FILE);

List<IStorageItem> lstItems = new List<IStorageItem>();
lstItems.Add(smiFile);
if (lstItems.Count > 0)
{
    request.Data.SetStorageItems(lstItems);
}

deferral.Complete(); 
```

当我在共享魅力中打开 mailto 应用程序时，它只显示带有空白主题和正文的附件。在第二种情况下，如果我删除附件，则会出现主题和正文。为什么会发生这种情况我想要发送完整的邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T10:36:29.120

这是不可能的，因为邮件应用程序有限制。我认为微软应该使用该共享功能更新邮件应用程序。也检查这些。

[从 Metro 应用程序分享附件和文本](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/8997820e-a393-478d-a461-6335e5741886)（我认为这是您的主题：P）

[如何在分享魅力使用的同时在带有附件的电子邮件中设置主题和消息部分？](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/3478925a-0945-4037-9bbf-4fc7ef6595c5)

# fortran - 英特尔 FORTRAN 中的 DEALLOCATE

> ID：15554289
> 
> 赞同：2
> 
> 时间：2013-03-21T17:31:32.893
> 
> 标签：fortran

我在使用一些现有的 FORTRAN 代码时发现了一个问题。尽管它已经预料到需要在重新分配之前释放数组，但这从来没有必要。我现在需要它来执行此操作，但它无法正常工作。

目前的伪代码大概是：

```
MODULE mA
  TYPE A
    REAL, DIMENSION(:,:,:), ALLOCATABLE :: array
  END TYPE
  TYPE (A), POINTER :: sw(:)
END MODULE 
```

后来，有分配“数组”大小的代码，我现在调用了两次（迄今为止只有一次）：

```
...
IF (ALLOCATED(sw(1)%array))  DEALLOCATE(sw(1)%array, STAT=aviFail)

IF (aviFail.EQ.0) ALLOCATE(sw(1)%array(1,2,3), STAT=aviFail)
... 
```

我查看了 ALLOCATE、DEALLOCATE 和 ALLOCATED 的定义，发现如下：

1.  在第二次通过时，调用 DEALLOCATE，但 STAT 值为 '1'
2.  在失败的情况下（即一个积极的 STAT 返回），DEALLOCATE 意味着保持原始数组不变。它没有：它显然正确地清除了它（至少，根据调试器）。
3.  在失败且未定义 STAT 的情况下，DEALLOCATE 意味着终止程序。它没有，但以下 ALLOCATE 语句失败，STAT 值为“1”。

我还无意中在其他地方两次调用了同一个数组上的 ALLOCATE，而没有先 DEALLOCATING。根据这本书，这应该会导致程序终止。它不仅可以工作，而且可以正常工作，并且第二个 ALLOCATE 的 STAT 返回为“0”。

英特尔 FORTRAN 是否以不同的方式处理这些事情，或者 FORTRAN 在满足其规范方面不像 C++ 那样挑剔？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-09T22:12:15.073

没有看到更多的实现，很难给出详细和有针对性的解释，但我认为这很可能是导致您的问题的指针的实现。您给出的关于 ALLOCATE 和 DEALLOCATE 行为的“书”答案听起来是正确的，但您描述了它们在直接使用可分配数组时的行为方式。对指针进行操作时，ALLOCATE 和 DEALLOCATE 的功能可能不同（取决于编译器）。在最基本的层面上，通过指针分配内存需要更多步骤：1）确定要为指针创建的对象的类型/维度，2）在内存中创建并分配该类型/维度的未命名对象，3）关联带有新对象的指针。根据实现，编译器，

在这个实现中使用指针有什么特别的原因吗？如果没有，我建议切换到更简单的普通可分配数组，看看问题是否仍然存在。

关于您能够在没有预期程序终止的情况下错误地分配和排列两次：我认为这也与您使用指针的实现有关。您正在重新分配的指针已经与内存中的某个位置相关联。这种关联很可能会改变编译器在第二次执行时处理 ALLOCATE 语句的方式。如果指针已经与具有 ALLOCATE 语句要求的维度的内存位置相关联，则没有理由终止程序或引发错误；程序员得到的正是他或她所要求的。

最后，ALLOCATE/DEALLOCATE 语句和指针关联/无效由不同的编译器以不同的方式处理，因此您的观察行为与“书”不符也就不足为奇了。我建议您看看您是否真的需要指针实现，并确保在编写代码时应用内存管理最佳实践。

# asp.net - asp.net / MySQL：用户''@'localhost'的访问被拒绝（使用密码：否）

> ID：15554290
> 
> 赞同：1
> 
> 时间：2013-03-21T17:31:35.163
> 
> 标签：asp.net, mysql, login, connection-string, machine.config

我是一名网络开发新手，我希望有更多经验的人可以帮助解决这个问题。我被 MySQL 升级伏击了。

**背景：** 我有两台 XP PC（让我们雄心勃勃地称它们为“Web 服务器”和“MySQL 服务器”）。我最近构建并成功托管了一个从 MySQL 数据库中提取数据的 asp.net 站点。它只是为少数本地用户设计的站点，因此他们不必学习 SQL 即可获取数据……没什么特别的。到目前为止，一切都很好。

**问题：** 这周我在“网络服务器”上安装了 MySQL，然后事情就变得疯狂了。在此之前，Web 服务器上没有 MySQL 实例。自安装以来，我已经：

1.  ...重新安装 MySQL .NET 提供程序
2.  ...重新配置 machine.config 文件
3.  ...将 MySQL_Web.dll 复制到 MySQL bin 目录
4.  ...尝试使设置与以下站点中的说明保持一致。

[http://dev.mysql.com/doc/refman/5.0/en/connector-net-tutorials-asp-roles.html](http://dev.mysql.com/doc/refman/5.0/en/connector-net-tutorials-asp-roles.html)

这解决了许多问题，我让网站部分启动并再次运行。我可以访问登录页面，并且对来宾用户的查询返回数据正常。

**错误消息 #1** 但是，当用户尝试登录以访问站点上的私人页面时，我收到错误*"Access denied for user ''@'localhost' (using password: NO)"*。这显然是错误的，因为我使用的是密码，并且没有指向 localhost/web 服务器的连接字符串。唯一的连接字符串指向数据库所在的 MySQL 服务器。

**错误消息 #2** 我还在查看安全选项卡中的 asp.net 网站管理工具，并看到以下错误：

"*您选择的数据存储有问题。这可能是由于服务器名称或凭据无效或权限不足造成的。也可能是未启用角色管理器功能造成的。单击下面的按钮可重定向到您可以在其中选择新数据存储的页面。以下消息可能有助于诊断问题：发生异常。请检查事件日志。* “

角色管理器肯定已启用，并且提供程序已正确设置。

我已经尝试在 Web 服务器上卸载 MySQL，重新创建站点的用户表，刷新权限和其他一些技巧，但现在该站点似乎在登录过程中永久绕过连接字符串中的 db 并搜索 Web 服务器反而。

有没有人有任何想法我可以在哪里采取这个？我已经被难住了几天，我不知道我还能做什么。

* * *

**编辑：**按照以下评论中的要求提供相关代码。如前所述，这是作为默认项目的一部分生成的所有标准代码，并且没有以任何方式进行编辑（当然 web.config 除外）。

**网页配置**

```
<connectionStrings>
   <remove name="MySQLWebConnection"/>
   <add name="MySQLWebConnection" connectionString="server=myWebServer;User Id=myName;password=myPwd;database=myDB" providerName="MySql.Data.MySqlClient"/>
</connectionStrings>

<system.web>
   <membership defaultProvider="MySQLMembershipProvider" />
   <roleManager enabled="true" defaultProvider="MySQLRoleProvider" />
   <authentication mode="Forms">
    <forms name=".ASPXFORMSAUTH" loginUrl="~/Account/Login.aspx" defaultUrl="~/Default.aspx" />
   </authentication>
   ...
</system.web> 
```

**登录.aspx**

```
 <asp:Login ID="LoginUser" runat="server" EnableViewState="false" RenderOuterTable="false">
        <LayoutTemplate>
            <span class="failureNotification">
                <asp:Literal ID="FailureText" runat="server"></asp:Literal>
            </span>
            <asp:ValidationSummary ID="LoginUserValidationSummary" runat="server" CssClass="failureNotification" 
                 ValidationGroup="LoginUserValidationGroup"/>
            <div class="accountInfo">
                <fieldset class="login">
                    <legend>Account Information</legend>
                    <p>
                        <asp:Label ID="UserNameLabel" runat="server" AssociatedControlID="UserName">Username:</asp:Label>
                        <asp:TextBox ID="UserName" runat="server" CssClass="textEntry"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="UserNameRequired" runat="server" ControlToValidate="UserName" 
                             CssClass="failureNotification" ErrorMessage="User Name is required." ToolTip="User Name is required." 
                             ValidationGroup="LoginUserValidationGroup">*</asp:RequiredFieldValidator>
                    </p>
                    <p>
                        <asp:Label ID="PasswordLabel" runat="server" AssociatedControlID="Password">Password:</asp:Label>
                        <asp:TextBox ID="Password" runat="server" CssClass="passwordEntry" TextMode="Password"></asp:TextBox>
                        <asp:RequiredFieldValidator ID="PasswordRequired" runat="server" ControlToValidate="Password" 
                             CssClass="failureNotification" ErrorMessage="Password is required." ToolTip="Password is required." 
                             ValidationGroup="LoginUserValidationGroup">*</asp:RequiredFieldValidator>
                    </p>
                    <p>
                        <asp:CheckBox ID="RememberMe" runat="server" Visible="false" />
                        <asp:Label ID="RememberMeLabel" runat="server" Visible="false" AssociatedControlID="RememberMe" CssClass="inline">Keep me logged in</asp:Label>
                    </p>
                </fieldset>
                <p class="submitButton">
                    <asp:Button ID="LoginButton" runat="server" CommandName="Login" Text="Log In" ValidationGroup="LoginUserValidationGroup"/>
                </p>
            </div>
        </LayoutTemplate>
    </asp:Login> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T21:32:19.780

解决了。希望这可以帮助其他有类似问题的人，并在此过程中缓解一些偏头痛。一周的极度恐慌让我在其他一切都失败时寻求上帝的干预，所以楼上的大个子得到了这个的复选标记。:)

**原因：** 重新安装 MySQL 和 .NET 连接器意味着 machine.config 文件自定义被覆盖。

**解决方案：** 更新后，请确保 machine.config 文件中有以下两项更改...

(1)

```
<membership>
   <providers>
      <add name="MySQLMembershipProvider" **autogenerateschema="true"** ... />
   </providers>
</membership> 
```

(2)

```
<connectionStrings>
  <add name="LocalMySqlServer" connectionString="server=dbServer;User Id=myUserID;password=myPassword;database=myDatabase" />
</connectionStrings> 
```

这是第二个让我绊倒的人。在重新安装期间，代码已更改为...

```
<connectionStrings>
   <add name="LocalMySqlServer" connectionString="" />
</connectionStrings> 
```

...这就是该站点尝试连接到 localhost 的原因，以及 web.config 连接字符串中的用户信息被忽略的原因。

# jdbc - cassandra-jdbc 和 Ebean，他们可以一起工作吗？

> ID：15554294
> 
> 赞同：1
> 
> 时间：2013-03-21T17:31:43.197
> 
> 标签：jdbc, playframework, cassandra, ebean

承认我也不是 Avaje Ebean 专家或 JDBC 专家。我在“正常”用例（基本上是 H2 和 mySQL）中使用 play framework 和 Ebean，它们对我来说表现良好。

我最近发现了 cassandra-jdbc 驱动程序项目，我想知道我是否可以天真地让它们一起工作。所以我尝试了，一旦我关闭了进化，我得到了一个 SQLFeatureNotSupportedException，因为 cassandra-sql 强制自动提交始终打开。

我想知道是否有办法让它们一起工作，因为驱动程序声称符合 Jdbc 并且 Ebean 应该能够使用它。Ebean 使用驱动程序的方式是否使这成为不可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:08:20.183

尽管 cassandra-jdbc 驱动程序兼容 jdbc，但目前无法使用 cassandra 作为 playframwork @Models 的后端。

有几个项目试图实现对 NoSql 的支持，虽然没有明确 cassandra，但在 play 框架中，看看[**siena**](http://www.sienaproject.com/index.html)。

这个[SO question](https://stackoverflow.com/questions/9743850/how-to-configure-play-framework-project-to-use-kundera-with-cassadra)也可能是一个有用的参考。

# java - Java AES/CBC 解密后的初始字节不正确

> ID：15554296
> 
> 赞同：118
> 
> 时间：2013-03-21T17:31:51.307
> 
> 标签：java, encryption, aes

下面的例子有什么问题？

问题是解密字符串的第一部分是胡说八道。不过，其他都很好，我明白了……

> ```
> Result: `£eB6O�geS��i are you? Have a nice day. 
> ```

```
@Test
public void testEncrypt() {
  try {
    String s = "Hello there. How are you? Have a nice day.";

    // Generate key
    KeyGenerator kgen = KeyGenerator.getInstance("AES");
    kgen.init(128);
    SecretKey aesKey = kgen.generateKey();

    // Encrypt cipher
    Cipher encryptCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
    encryptCipher.init(Cipher.ENCRYPT_MODE, aesKey);

    // Encrypt
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    CipherOutputStream cipherOutputStream = new CipherOutputStream(outputStream, encryptCipher);
    cipherOutputStream.write(s.getBytes());
    cipherOutputStream.flush();
    cipherOutputStream.close();
    byte[] encryptedBytes = outputStream.toByteArray();

    // Decrypt cipher
    Cipher decryptCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
    IvParameterSpec ivParameterSpec = new IvParameterSpec(aesKey.getEncoded());
    decryptCipher.init(Cipher.DECRYPT_MODE, aesKey, ivParameterSpec);

    // Decrypt
    outputStream = new ByteArrayOutputStream();
    ByteArrayInputStream inStream = new ByteArrayInputStream(encryptedBytes);
    CipherInputStream cipherInputStream = new CipherInputStream(inStream, decryptCipher);
    byte[] buf = new byte[1024];
    int bytesRead;
    while ((bytesRead = cipherInputStream.read(buf)) >= 0) {
        outputStream.write(buf, 0, bytesRead);
    }

    System.out.println("Result: " + new String(outputStream.toByteArray()));

  } 
  catch (Exception ex) {
    ex.printStackTrace();
  }
} 
```

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2014-03-17T02:17:22.907

包括我自己在内的很多人在完成这项工作时遇到了很多问题，因为缺少一些信息，比如忘记转换为 Base64、初始化向量、字符集等。所以我想制作一个功能齐全的代码。

希望这对大家有用：要编译，您需要额外的 Apache Commons Codec jar，可在此处获得： [http ://commons.apache.org/proper/commons-codec/download_codec.cgi](http://commons.apache.org/proper/commons-codec/download_codec.cgi)

```
import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

import org.apache.commons.codec.binary.Base64;

public class Encryptor {
    public static String encrypt(String key, String initVector, String value) {
        try {
            IvParameterSpec iv = new IvParameterSpec(initVector.getBytes("UTF-8"));
            SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes("UTF-8"), "AES");

            Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
            cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);

            byte[] encrypted = cipher.doFinal(value.getBytes());
            System.out.println("encrypted string: "
                    + Base64.encodeBase64String(encrypted));

            return Base64.encodeBase64String(encrypted);
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        return null;
    }

    public static String decrypt(String key, String initVector, String encrypted) {
        try {
            IvParameterSpec iv = new IvParameterSpec(initVector.getBytes("UTF-8"));
            SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes("UTF-8"), "AES");

            Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
            cipher.init(Cipher.DECRYPT_MODE, skeySpec, iv);

            byte[] original = cipher.doFinal(Base64.decodeBase64(encrypted));

            return new String(original);
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        return null;
    }

    public static void main(String[] args) {
        String key = "Bar12345Bar12345"; // 128 bit key
        String initVector = "RandomInitVector"; // 16 bytes IV

        System.out.println(decrypt(key, initVector,
                encrypt(key, initVector, "Hello World")));
    }
} 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2018-10-29T18:23:11.473

*在这个答案中，我选择处理“简单的 Java AES 加密/解密示例”主题而不是具体的调试问题，因为我认为这将使大多数读者受益。*

这是我[关于 Java 中的 AES 加密的博客文章](https://proandroiddev.com/security-best-practices-symmetric-encryption-with-aes-in-java-7616beaaade9)的简单摘要，因此我建议在实施任何内容之前通读它。但是，我仍然会提供一个简单的示例来使用并给出一些注意事项。

在这个例子中，我将选择使用Galois [/Counter 模式或 GCM模式的](https://en.wikipedia.org/wiki/Galois/Counter_Mode)[认证加密](https://en.wikipedia.org/wiki/Authenticated_encryption)。原因是在大多数情况下，您希望 [完整性和真实性与机密性相结合（在](https://security.stackexchange.com/questions/148173/authenticity-confidentiality-integrity-general-questions)[博客](https://proandroiddev.com/security-best-practices-symmetric-encryption-with-aes-in-java-7616beaaade9)中阅读更多内容）。

## AES-GCM 加密/解密教程

[以下是使用AES-GCM](https://en.wikipedia.org/wiki/Galois/Counter_Mode)和[Java Cryptography Architecture (JCA)](https://en.wikipedia.org/wiki/Java_Cryptography_Architecture)加密/解密所需的步骤。**不要与其他示例混用**，因为细微的差异可能会使您的代码完全不安全。

### 1\. 创建密钥

由于这取决于您的用例，我将假设最简单的情况：随机密钥。

```
SecureRandom secureRandom = new SecureRandom();
byte[] key = new byte[16];
secureRandom.nextBytes(key);
SecretKey secretKey = SecretKeySpec(key, "AES"); 
```

**重要的：**

*   始终使用强大的[伪随机数生成器](https://en.wikipedia.org/wiki/Pseudorandom_number_generator)，例如[`SecureRandom`](https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html)
*   使用 16 字节/128 位长密钥（或更多 -[但很少需要更多](https://security.stackexchange.com/a/6149/60108)）
*   如果您想要从用户密码派生的密钥，请查看具有[PBKDF2](https://en.wikipedia.org/wiki/PBKDF2)或[bcrypt](https://en.wikipedia.org/wiki/Bcrypt)等[拉伸属性的](https://en.wikipedia.org/wiki/Key_stretching)[密码哈希函数（或 KDF）](https://en.wikipedia.org/wiki/Cryptographic_hash_function#Password_verification)
*   如果您想要从其他来源派生的密钥，请使用适当的[密钥派生函数 (KDF)](https://en.wikipedia.org/wiki/Key_derivation_function)，如[HKDF](https://en.wikipedia.org/wiki/HKDF)（[此处为 Java 实现](https://github.com/patrickfav/hkdf)）。不要为此*使用*简单的[加密哈希](https://simple.wikipedia.org/wiki/Cryptographic_hash_function)（如[SHA-256](https://en.wikipedia.org/wiki/SHA-2)）。

### 2\. 创建初始化向量

使用[初始化向量 (IV)](https://en.wikipedia.org/wiki/Initialization_vector)，以便相同的密钥将创建不同的[密文](https://en.wikipedia.org/wiki/Ciphertext)。

```
byte[] iv = new byte[12]; //NEVER REUSE THIS IV WITH SAME KEY
secureRandom.nextBytes(iv); 
```

**重要的：**

*   永远不要使用相同的密钥[重用相同的 IV](https://crypto.stackexchange.com/questions/2991/why-must-IV-key-pairs-not-be-reused-in-ctr-mode) （在[GCM](https://en.wikipedia.org/wiki/Galois/Counter_Mode) / [CTR](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_(CTR))模式中**非常重要）**
*   IV 必须是唯一的（即使用随机 IV 或计数器）
*   IV不需要保密
*   始终使用强大的[伪随机数生成器](https://en.wikipedia.org/wiki/Pseudorandom_number_generator)，例如[`SecureRandom`](https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html)
*   12字节IV是AES-GCM模式的正确[选择](https://crypto.stackexchange.com/questions/41601/aes-gcm-recommended-IV-size-why-12-bytes)

### 3\. 用 IV 和 Key 加密

```
final Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
GCMParameterSpec parameterSpec = new GCMParameterSpec(128, iv); //128 bit auth tag length
cipher.init(Cipher.ENCRYPT_MODE, secretKey, parameterSpec);
byte[] cipherText = cipher.doFinal(plainText); 
```

**重要的：**

*   使用 16 字节/128 位[认证标签](https://en.wikipedia.org/wiki/Authenticated_encryption)（用于验证完整性/真实性）
*   身份验证标签将自动附加到密文中（在 JCA 实现中）
*   由于 GCM 的行为类似于流密码，因此不需要填充
*   [`CipherInputStream`](https://docs.oracle.com/javase/7/docs/api/javax/crypto/CipherInputStream.html)在加密大块数据时使用
*   是否要检查其他（非秘密）数据是否已更改？您可能希望在此处使用与[更多](https://en.wikipedia.org/wiki/Authenticated_encryption#Authenticated_encryption_with_associated_data_(AEAD))[相关的数据。](https://crypto.stackexchange.com/questions/6711/how-to-use-gcm-mode-and-associated-data-properly)`cipher.updateAAD(associatedData);`

### 3.序列化为单条消息

只需附加 IV 和密文。如上所述，IV 不需要保密。

```
ByteBuffer byteBuffer = ByteBuffer.allocate(iv.length + cipherText.length);
byteBuffer.put(iv);
byteBuffer.put(cipherText);
byte[] cipherMessage = byteBuffer.array(); 
```

如果需要字符串表示，可以选择使用[Base64](https://en.wikipedia.org/wiki/Base64)进行编码。使用[Android](https://developer.android.com/reference/android/util/Base64.html)或[Java 8 的内置](https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html)实现（不要使用 Apache Commons Codec - 这是一个糟糕的实现）。编码用于将字节数组“转换”为字符串表示形式，以使其 ASCII 安全，例如：

```
String base64CipherMessage = Base64.getEncoder().encodeToString(cipherMessage); 
```

### 4.准备解密：反序列化

如果您已对消息进行编码，请先将其解码为字节数组：

```
byte[] cipherMessage = Base64.getDecoder().decode(base64CipherMessage) 
```

**重要的：**

*   小心验证[输入参数](https://cwe.mitre.org/data/definitions/789.html)，以避免通过分配过多内存来进行[拒绝服务攻击。](https://en.wikipedia.org/wiki/Denial-of-service_attack)

### 5.解密

初始化密码并设置与加密相同的参数：

```
final Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
//use first 12 bytes for iv
AlgorithmParameterSpec gcmIv = new GCMParameterSpec(128, cipherMessage, 0, 12);
cipher.init(Cipher.DECRYPT_MODE, secretKey, gcmIv);
//use everything from 12 bytes on as ciphertext
byte[] plainText = cipher.doFinal(cipherMessage, 12, cipherMessage.length - 12); 
```

**重要的：**

*   如果您在加密期间添加了相关数据，请不要忘记添加[相关数据。](https://crypto.stackexchange.com/questions/6711/how-to-use-gcm-mode-and-associated-data-properly)`cipher.updateAAD(associatedData);`

[可以在这个要点中找到一个工作代码片段。](https://gist.github.com/patrickfav/7e28d4eb4bf500f7ee8012c4a0cf7bbf)

* * *

请注意，最新的 Android (SDK 21+) 和 Java (7+) 实现应该具有 AES-GCM。旧版本可能缺少它。[我仍然选择这种模式，因为与Encrypt-then-Mac 的](https://en.wikipedia.org/wiki/Authenticated_encryption#MAC-then-Encrypt_(MtE))类似模式（例如[AES-CBC](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_(CBC)) + [HMAC](https://en.wikipedia.org/wiki/HMAC)）相比，它更容易实现，而且效率更高。[请参阅这篇文章，了解如何使用 HMAC 实现 AES-CBC](https://proandroiddev.com/security-best-practices-symmetric-encryption-with-aes-in-java-and-android-part-2-b3b80e99ad36)。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2015-04-02T18:21:28.410

这里没有[`Apache Commons Codec`](https://commons.apache.org/proper/commons-codec/)'s的解决方案`Base64`：

```
import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

public class AdvancedEncryptionStandard
{
    private byte[] key;

    private static final String ALGORITHM = "AES";

    public AdvancedEncryptionStandard(byte[] key)
    {
        this.key = key;
    }

    /**
     * Encrypts the given plain text
     *
     * @param plainText The plain text to encrypt
     */
    public byte[] encrypt(byte[] plainText) throws Exception
    {
        SecretKeySpec secretKey = new SecretKeySpec(key, ALGORITHM);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.ENCRYPT_MODE, secretKey);

        return cipher.doFinal(plainText);
    }

    /**
     * Decrypts the given byte array
     *
     * @param cipherText The data to decrypt
     */
    public byte[] decrypt(byte[] cipherText) throws Exception
    {
        SecretKeySpec secretKey = new SecretKeySpec(key, ALGORITHM);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.DECRYPT_MODE, secretKey);

        return cipher.doFinal(cipherText);
    }
} 
```

使用示例：

```
byte[] encryptionKey = "MZygpewJsCpRrfOr".getBytes(StandardCharsets.UTF_8);
byte[] plainText = "Hello world!".getBytes(StandardCharsets.UTF_8);
AdvancedEncryptionStandard advancedEncryptionStandard = new AdvancedEncryptionStandard(
        encryptionKey);
byte[] cipherText = advancedEncryptionStandard.encrypt(plainText);
byte[] decryptedCipherText = advancedEncryptionStandard.decrypt(cipherText);

System.out.println(new String(plainText));
System.out.println(new String(cipherText));
System.out.println(new String(decryptedCipherText)); 
```

印刷：

```
Hello world!
դ;��LA+�ߙb*
Hello world! 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-03-21T18:02:20.750

在我看来，您没有正确处理初始化向量 (IV)。自从我上次阅读有关 AES、IV 和块链的文章以来已经有很长时间了，但是您的台词

```
IvParameterSpec ivParameterSpec = new IvParameterSpec(aesKey.getEncoded()); 
```

好像不行。在 AES 的情况下，您可以将初始化向量视为密码实例的“初始状态”，并且此状态是您无法从密钥中获得的信息，而是从加密密码的实际计算中获得的信息。（有人可能会争辩说，如果 IV 可以从密钥中提取出来，那么它就没有用了，因为密钥已经在其初始化阶段提供给了密码实例）。

因此，您应该在加密结束时从密码实例中以字节 [] 的形式获取 IV

```
 cipherOutputStream.close();
  byte[] iv = encryptCipher.getIV(); 
```

你应该用这个 byte[]初始化你`Cipher`的：`DECRYPT_MODE`

```
 IvParameterSpec ivParameterSpec = new IvParameterSpec(iv); 
```

然后，您的解密应该可以了。希望这可以帮助。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2015-10-17T13:44:50.777

您用于解密的 IV 不正确。替换此代码

```
//Decrypt cipher
Cipher decryptCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
IvParameterSpec ivParameterSpec = new IvParameterSpec(aesKey.getEncoded());
decryptCipher.init(Cipher.DECRYPT_MODE, aesKey, ivParameterSpec); 
```

使用此代码

```
//Decrypt cipher
Cipher decryptCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
IvParameterSpec ivParameterSpec = new IvParameterSpec(encryptCipher.getIV());
decryptCipher.init(Cipher.DECRYPT_MODE, aesKey, ivParameterSpec); 
```

那应该可以解决您的问题。

* * *

下面包括一个简单的 Java AES 类示例。我不建议在生产环境中使用此类，因为它可能无法满足您应用程序的所有特定需求。

```
import java.nio.charset.StandardCharsets;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.SecureRandom;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import java.util.Base64;

public class AES 
{
    public static byte[] encrypt(final byte[] keyBytes, final byte[] ivBytes, final byte[] messageBytes) throws InvalidKeyException, InvalidAlgorithmParameterException
    {       
        return AES.transform(Cipher.ENCRYPT_MODE, keyBytes, ivBytes, messageBytes);
    }

    public static byte[] decrypt(final byte[] keyBytes, final byte[] ivBytes, final byte[] messageBytes) throws InvalidKeyException, InvalidAlgorithmParameterException
    {       
        return AES.transform(Cipher.DECRYPT_MODE, keyBytes, ivBytes, messageBytes);
    }

    private static byte[] transform(final int mode, final byte[] keyBytes, final byte[] ivBytes, final byte[] messageBytes) throws InvalidKeyException, InvalidAlgorithmParameterException
    {
        final SecretKeySpec keySpec = new SecretKeySpec(keyBytes, "AES");
        final IvParameterSpec ivSpec = new IvParameterSpec(ivBytes);
        byte[] transformedBytes = null;

        try
        {
            final Cipher cipher = Cipher.getInstance("AES/CTR/NoPadding");

            cipher.init(mode, keySpec, ivSpec);

            transformedBytes = cipher.doFinal(messageBytes);
        }        
        catch (NoSuchAlgorithmException | NoSuchPaddingException | IllegalBlockSizeException | BadPaddingException e) 
        {
            e.printStackTrace();
        }
        return transformedBytes;
    }

    public static void main(final String[] args) throws InvalidKeyException, InvalidAlgorithmParameterException
    {
        //Retrieved from a protected local file.
        //Do not hard-code and do not version control.
        final String base64Key = "ABEiM0RVZneImaq7zN3u/w==";

        //Retrieved from a protected database.
        //Do not hard-code and do not version control.
        final String shadowEntry = "AAECAwQFBgcICQoLDA0ODw==:ZtrkahwcMzTu7e/WuJ3AZmF09DE=";

        //Extract the iv and the ciphertext from the shadow entry.
        final String[] shadowData = shadowEntry.split(":");        
        final String base64Iv = shadowData[0];
        final String base64Ciphertext = shadowData[1];

        //Convert to raw bytes.
        final byte[] keyBytes = Base64.getDecoder().decode(base64Key);
        final byte[] ivBytes = Base64.getDecoder().decode(base64Iv);
        final byte[] encryptedBytes = Base64.getDecoder().decode(base64Ciphertext);

        //Decrypt data and do something with it.
        final byte[] decryptedBytes = AES.decrypt(keyBytes, ivBytes, encryptedBytes);

        //Use non-blocking SecureRandom implementation for the new IV.
        final SecureRandom secureRandom = new SecureRandom();

        //Generate a new IV.
        secureRandom.nextBytes(ivBytes);

        //At this point instead of printing to the screen, 
        //one should replace the old shadow entry with the new one.
        System.out.println("Old Shadow Entry      = " + shadowEntry);
        System.out.println("Decrytped Shadow Data = " + new String(decryptedBytes, StandardCharsets.UTF_8));
        System.out.println("New Shadow Entry      = " + Base64.getEncoder().encodeToString(ivBytes) + ":" + Base64.getEncoder().encodeToString(AES.encrypt(keyBytes, ivBytes, decryptedBytes)));
    }
} 
```

请注意，AES 与编码无关，这就是为什么我选择单独处理它而不需要任何第三方库的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-19T18:04:47.090

在线编辑器可运行版本：-

```
import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
//import org.apache.commons.codec.binary.Base64;
import java.util.Base64;

public class Encryptor {
    public static String encrypt(String key, String initVector, String value) {
        try {
            Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
            IvParameterSpec iv = new IvParameterSpec(initVector.getBytes("UTF-8"));

            SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes("UTF-8"), "AES");
            cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);

            byte[] encrypted = cipher.doFinal(value.getBytes());

            //System.out.println("encrypted string: "
              //      + Base64.encodeBase64String(encrypted));

            //return Base64.encodeBase64String(encrypted);
            String s = new String(Base64.getEncoder().encode(encrypted));
            return s;
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        return null;
    }

    public static String decrypt(String key, String initVector, String encrypted) {
        try {
            IvParameterSpec iv = new IvParameterSpec(initVector.getBytes("UTF-8"));
            SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes("UTF-8"), "AES");

            Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
            cipher.init(Cipher.DECRYPT_MODE, skeySpec, iv);

            byte[] original = cipher.doFinal(Base64.getDecoder().decode(encrypted));

            return new String(original);
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        return null;
    }

    public static void main(String[] args) {
        String key = "Bar12345Bar12345"; // 128 bit key
        String initVector = "RandomInitVector"; // 16 bytes IV

        System.out.println(encrypt(key, initVector, "Hello World"));
        System.out.println(decrypt(key, initVector, encrypt(key, initVector, "Hello World")));
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-21T00:14:35.470

这是对已接受答案的改进。

变化：

(1) 使用随机 IV 并将其添加到加密文本中

(2) 使用 SHA-256 从密码短语生成密钥

(3) 不依赖 Apache Commons

```
public static void main(String[] args) throws GeneralSecurityException {
    String plaintext = "Hello world";
    String passphrase = "My passphrase";
    String encrypted = encrypt(passphrase, plaintext);
    String decrypted = decrypt(passphrase, encrypted);
    System.out.println(encrypted);
    System.out.println(decrypted);
}

private static SecretKeySpec getKeySpec(String passphrase) throws NoSuchAlgorithmException {
    MessageDigest digest = MessageDigest.getInstance("SHA-256");
    return new SecretKeySpec(digest.digest(passphrase.getBytes(UTF_8)), "AES");
}

private static Cipher getCipher() throws NoSuchPaddingException, NoSuchAlgorithmException {
    return Cipher.getInstance("AES/CBC/PKCS5PADDING");
}

public static String encrypt(String passphrase, String value) throws GeneralSecurityException {
    byte[] initVector = new byte[16];
    SecureRandom.getInstanceStrong().nextBytes(initVector);
    Cipher cipher = getCipher();
    cipher.init(Cipher.ENCRYPT_MODE, getKeySpec(passphrase), new IvParameterSpec(initVector));
    byte[] encrypted = cipher.doFinal(value.getBytes());
    return DatatypeConverter.printBase64Binary(initVector) +
            DatatypeConverter.printBase64Binary(encrypted);
}

public static String decrypt(String passphrase, String encrypted) throws GeneralSecurityException {
    byte[] initVector = DatatypeConverter.parseBase64Binary(encrypted.substring(0, 24));
    Cipher cipher = getCipher();
    cipher.init(Cipher.DECRYPT_MODE, getKeySpec(passphrase), new IvParameterSpec(initVector));
    byte[] original = cipher.doFinal(DatatypeConverter.parseBase64Binary(encrypted.substring(24)));
    return new String(original);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-03T19:43:04.347

依靠标准库提供的解决方案通常是个好主意：

```
private static void stackOverflow15554296()
    throws
        NoSuchAlgorithmException, NoSuchPaddingException,        
        InvalidKeyException, IllegalBlockSizeException,
        BadPaddingException
{

    // prepare key
    KeyGenerator keygen = KeyGenerator.getInstance("AES");
    SecretKey aesKey = keygen.generateKey();
    String aesKeyForFutureUse = Base64.getEncoder().encodeToString(
            aesKey.getEncoded()
    );

    // cipher engine
    Cipher aesCipher = Cipher.getInstance("AES/ECB/PKCS5Padding");

    // cipher input
    aesCipher.init(Cipher.ENCRYPT_MODE, aesKey);
    byte[] clearTextBuff = "Text to encode".getBytes();
    byte[] cipherTextBuff = aesCipher.doFinal(clearTextBuff);

    // recreate key
    byte[] aesKeyBuff = Base64.getDecoder().decode(aesKeyForFutureUse);
    SecretKey aesDecryptKey = new SecretKeySpec(aesKeyBuff, "AES");

    // decipher input
    aesCipher.init(Cipher.DECRYPT_MODE, aesDecryptKey);
    byte[] decipheredBuff = aesCipher.doFinal(cipherTextBuff);
    System.out.println(new String(decipheredBuff));
} 
```

这将打印“要编码的文本”。

解决方案基于[Java Cryptography Architecture Reference Guide](http://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#SimpleEncrEx)和[https://stackoverflow.com/a/20591539/146745](https://stackoverflow.com/a/20591539/146745)答案。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-08-19T17:37:04.883

另一个使用 java.util.Base64 和 Spring Boot 的解决方案

加密器类

```
package com.jmendoza.springboot.crypto.cipher;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets;
import java.util.Base64;

@Component
public class Encryptor {

    @Value("${security.encryptor.key}")
    private byte[] key;
    @Value("${security.encryptor.algorithm}")
    private String algorithm;

    public String encrypt(String plainText) throws Exception {
        SecretKeySpec secretKey = new SecretKeySpec(key, algorithm);
        Cipher cipher = Cipher.getInstance(algorithm);
        cipher.init(Cipher.ENCRYPT_MODE, secretKey);
        return new String(Base64.getEncoder().encode(cipher.doFinal(plainText.getBytes(StandardCharsets.UTF_8))));
    }

    public String decrypt(String cipherText) throws Exception {
        SecretKeySpec secretKey = new SecretKeySpec(key, algorithm);
        Cipher cipher = Cipher.getInstance(algorithm);
        cipher.init(Cipher.DECRYPT_MODE, secretKey);
        return new String(cipher.doFinal(Base64.getDecoder().decode(cipherText)));
    }
} 
```

加密控制器类

```
package com.jmendoza.springboot.crypto.controller;

import com.jmendoza.springboot.crypto.cipher.Encryptor;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/cipher")
public class EncryptorController {

    @Autowired
    Encryptor encryptor;

    @GetMapping(value = "encrypt/{value}")
    public String encrypt(@PathVariable("value") final String value) throws Exception {
        return encryptor.encrypt(value);
    }

    @GetMapping(value = "decrypt/{value}")
    public String decrypt(@PathVariable("value") final String value) throws Exception {
        return encryptor.decrypt(value);
    }
} 
```

应用程序属性

```
server.port=8082
security.encryptor.algorithm=AES
security.encryptor.key=M8jFt46dfJMaiJA0 
```

例子

[http://localhost:8082/cipher/encrypt/jmendoza](http://localhost:8082/cipher/encrypt/jmendoza)

2h41HH8Shzc4BRU3hVDOXA==

[http://localhost:8082/cipher/decrypt/2h41HH8Shzc4BRU3hVDOXA==](http://localhost:8082/cipher/decrypt/2h41HH8Shzc4BRU3hVDOXA==)

杰门多萨

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2019-09-27T09:41:47.757

已接受答案的优化版本。

*   没有第三方库

*   将 IV 包含在加密消息中（可以公开）

*   密码可以是任意长度

代码：

```
import java.io.UnsupportedEncodingException;
import java.security.SecureRandom;
import java.util.Base64;

import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public class Encryptor {
    public static byte[] getRandomInitialVector() {
        try {
            Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
            SecureRandom randomSecureRandom = SecureRandom.getInstance("SHA1PRNG");
            byte[] initVector = new byte[cipher.getBlockSize()];
            randomSecureRandom.nextBytes(initVector);
            return initVector;
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        return null;
    }

    public static byte[] passwordTo16BitKey(String password) {
        try {
            byte[] srcBytes = password.getBytes("UTF-8");
            byte[] dstBytes = new byte[16];

            if (srcBytes.length == 16) {
                return srcBytes;
            }

            if (srcBytes.length < 16) {
                for (int i = 0; i < dstBytes.length; i++) {
                    dstBytes[i] = (byte) ((srcBytes[i % srcBytes.length]) * (srcBytes[(i + 1) % srcBytes.length]));
                }
            } else if (srcBytes.length > 16) {
                for (int i = 0; i < srcBytes.length; i++) {
                    dstBytes[i % dstBytes.length] += srcBytes[i];
                }
            }

            return dstBytes;
        } catch (UnsupportedEncodingException ex) {
            ex.printStackTrace();
        }

        return null;
    }

    public static String encrypt(String key, String value) {
        return encrypt(passwordTo16BitKey(key), value);
    }

    public static String encrypt(byte[] key, String value) {
        try {
            byte[] initVector = Encryptor.getRandomInitialVector();
            IvParameterSpec iv = new IvParameterSpec(initVector);
            SecretKeySpec skeySpec = new SecretKeySpec(key, "AES");

            Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
            cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);

            byte[] encrypted = cipher.doFinal(value.getBytes());
            return Base64.getEncoder().encodeToString(encrypted) + " " + Base64.getEncoder().encodeToString(initVector);
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        return null;
    }

    public static String decrypt(String key, String encrypted) {
        return decrypt(passwordTo16BitKey(key), encrypted);
    }

    public static String decrypt(byte[] key, String encrypted) {
        try {
            String[] encryptedParts = encrypted.split(" ");
            byte[] initVector = Base64.getDecoder().decode(encryptedParts[1]);
            if (initVector.length != 16) {
                return null;
            }

            IvParameterSpec iv = new IvParameterSpec(initVector);
            SecretKeySpec skeySpec = new SecretKeySpec(key, "AES");

            Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
            cipher.init(Cipher.DECRYPT_MODE, skeySpec, iv);

            byte[] original = cipher.doFinal(Base64.getDecoder().decode(encryptedParts[0]));

            return new String(original);
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        return null;
    }
} 
```

用法：

```
String key = "Password of any length.";
String encrypted = Encryptor.encrypt(key, "Hello World");
String decrypted = Encryptor.decrypt(key, encrypted);
System.out.println(encrypted);
System.out.println(decrypted); 
```

示例输出：

```
QngBg+Qc5+F8HQsksgfyXg== yDfYiIHTqOOjc0HRNdr1Ng==
Hello World 
```

# asp.net - 字段验证器

> ID：15554297
> 
> 赞同：0
> 
> 时间：2013-03-21T17:31:52.393
> 
> 标签：asp.net, html

在下面的代码中，提交按钮具有“SubmitValidation”验证组。

当我在RequiredFieldValidator 中更改ValidationGroup 的名称（提交Validation123）时，没有出现错误消息“输入状态代码”（如预期的那样）。但是，在我实际输入状态代码的值之前，不会进行提交。为什么？

```
<tr>
     <td>
      <span class="requiredText">*</span> State Code (Ex. TX):
     </td>
   <td>
      <asp:TextBox runat="server" ID="statecodeTxt" Width="100px"></asp:TextBox> 
      <asp:RequiredFieldValidator ID="statecodeRFV" runat="server" 
           Display="Dynamic" ValidationGroup="submitValidation"
        ControlToValidate="statecodeTxt" SetFocusOnError="True"
            ErrorMessage="Enter State Code" />
  </td>
</tr> 
```

* * *

```
<asp:Button ID="submitBtn" Text="Submit" disabled="true" 
 runat="server" ValidationGroup="submitValidation"  
 OnClick="submitBtn_Click" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T23:06:19.613

尝试删除或使 SetFocusOnError="True"

# google-chrome - 如何从 Chrome 扩展程序中获取设备名称（或主机名）？

> ID：15554299
> 
> 赞同：9
> 
> 时间：2013-03-21T17:31:56.393
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-app

有没有办法从 Chrome 扩展中检索设备名称？

理想情况下，我希望获得与新标签页上的“其他设备”菜单中显示的字符串相同的字符串......该信息是否可用于扩展？

或者，主机名是否可用？

我设法通过访问获得的是用户代理`window.navigator.userAgent`，但就是这样......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T19:55:25.460

不会。与用户硬件相关的持久且唯一的标识符基本上是不可删除的 cookie。出于隐私原因，浏览器（和浏览器扩展 API）不提供此类标识符。

编辑：从experimental.systemInfo.* 你可能能够构建一些描述用户系统某些属性的东西。例如，它的独特性不足以保证下拉菜单的唯一性，但它可能是朝着正确方向迈出的一步。请注意，这些 API 是实验性的，因此您将无法通过网络商店使用它们分发扩展。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-02-24T20:29:25.640

是的。由于 Chrome 版本 43，在此处的问题和其他答案之后发布了一段时间，因此您可以在 Chrome 扩展程序中使用`chrome.instanceID.getID()`.

可以在“其他设备”菜单 (chrome://history/syncedTabs) 中找到设备名称，`chrome.sessions.getDevices()`但它仅包括您的所有其他设备，而不是当前设备！

# python - 从没有字符串方法或导入的字符串中删除字母？

> ID：15554300
> 
> 赞同：0
> 
> 时间：2013-03-21T17:31:59.520
> 
> 标签：python

这是一个家庭作业问题。我需要定义一个函数，该函数接受一个单词和一个字母，并删除单词中该字母的所有出现。我不能使用正则表达式或字符串库之类的东西。我试过了...

```
def delete(word,letter):
    word = []
    char = ""
    if char != letter: 
        word+=char
    return word 
```

和

```
def delete(word,letter):
    word = []
    char = ""
    if char != letter:  #I also tried "if char not letter" for both
        word = word.append(char)
    return word 
```

两者都不提供任何输出。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T17:41:50.690

好吧，仔细看看你的函数：

```
def delete(word,letter):
    word = []
    char = ""
    if char != letter: 
        word+=char # or `word = word.append(char)` in 2nd version
    return word 
```

因此，该函数获取了一个单词和一个传入的字母。您要做的第一件事就是丢弃该单词，因为您正在用不同的值（一个新的空列表）覆盖局部变量。接下来，您将初始化一个空字符串`char`并将其内容（它是空的）与传递的字母进行比较。如果它们不相等，即如果`letter`不是空字符串，则将空字符串`char`添加到 (empty list)`word`中。然后`word`被退回。

另请注意，您不能将字符串添加到列表中。对列表的`+`操作仅用于合并两个列表，因此您的`append`版本绝对不会出错。鉴于您想要一个字符串作为结果，将结果存储为一个开始更有意义。

当发生与传递的单词完全无关的事情时，不要将空字符串添加到空字符串/列表中，而是要保持原始单词完整并以某种方式查看每个字符。您基本上想遍历单词并保留所有不是通过字母的字符；像这样的东西：

```
def delete(word, letter):
    newWord = '' # let's not overwrite the passed word
    for char in word:
        # `char` is now each character of the original word.
        # Here you now need to decide if you want to keep the
        # character for `newWord` or not.
    return newWord 
```

`for var in something`基本上将采用序列并为该序列`something`的每个值执行循环体，使用变量标识`var`。字符串是字符序列，因此循环变量将包含单个字符，并且针对字符串中的每个字符执行循环体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:35:23.770

你没有做任何事情`word`传递给你的函数。最终，您需要遍历传递给您的函数 ( `for character in word: doSomething_with_character`) 的单词并从中构建您的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:38:04.067

```
def delete(word, ch):
    return filter(lambda c: c != ch, word) 
```

基本上，只是对字符串进行线性传递，丢弃匹配的字母`ch`。

`filter`采用高阶函数和`iterable`. 字符串是 an`iterable`并且迭代它会迭代它包含的字符。`filter`从高阶函数返回的可迭代对象中删除元素`False`。

在这种情况下，我们`filter`排除所有等于传递`ch`参数的字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:45:36.060

我喜欢值得了解的功能风格@TC1 和@user2041448。这是另一个实现：

```
def delete( letter, string ):
    s2 = []
    for c in string:
        if c!=letter:
             s2.append( c )

     return ''.join(s2) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T17:54:31.013

您的第一个函数使用 + 运算符和一个可能不是最合适的选择的列表。+ 运算符可能应该为字符串保留（并将 .append() 函数与列表一起使用）。

如果意图是返回一个*字符串*，则**分配“”**而不是 []，并**使用 + 运算符**。

如果意图是返回一个*字符列表，请* **分配 []**，并**使用 .append() 函数**。

*更改*您用于构造返回值的变量的名称。

将任何内容分配给 word 会删除作为参数提供给函数的内容。

所以让它**result=[] OR result=""** etc..

还：

您似乎试图解决此问题的方式要求您遍历原始字符串中的字符，您发布的代码根本不会循环。

您可以使用具有这种语义的 for 循环：

```
for characterVar in stringVar:
    controlled-code-here
code-after-loop 
```

当然，您可以/应该更改名称，但我以一种可以帮助您理解的方式命名它们。在您的情况下， stringVar 将被替换为 word ，如果它不是已删除的字符，您将追加或添加 characterVar 到结果中。您希望包含在循环中的任何代码都必须缩进。控制行之后的第一条未缩进的行向 python 表明代码在循环之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-21T18:06:04.607

这就是我想出的：

```
def delete(word, letter):
    new_word = ""
    for i in word:
        if i != letter:
            new_word += i
    return new_word 
```

# sql - .NET Informix 错误

> ID：15554303
> 
> 赞同：1
> 
> 时间：2013-03-21T17:32:07.900
> 
> 标签：sql, vb.net, informix

尝试连接到 Informix 数据库时，我不断收到错误消息。

我正在使用 VS2008、.NET 4 框架、IBM Informix Connect 3.7 64bit

编码

```
Dim connectionstring As String =  "myconnectionstring"

    Dim conn As New IfxConnection

    conn.ConnectionString = connectionstring
    Try
        conn.Open()
        MsgBox("Made connection!")

    Catch ex As Exception
        MsgBox(ex.Message)
    End Try 
```

我知道连接字符串可以工作，因为这个确切的代码可以在我的旧 32 位机器上工作。

错误

```
Unable to load DLL IfxDotNetIntrinsic Module.dll the specific module could not be found 
```

我已经检查了 Setnet 32​​ 并且它是正确的，我已经卸载并重新安装了驱动程序。我只是不知道下一步该怎么做——你能帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T20:47:28.097

**仅供参考：** Informix 客户端 SDK 附带的 .NET Provider 是使用 .NET Framework 2.0（不是 FW 4.0）编译的。

如果您尝试在 Windows 64 位系统上使用来自 32 位 Informix Client SDK 的 .NET 提供程序，那么您可能需要手动将以下 DLL 复制到设置了路径的位置。

```
<Informix Client Install Dir>\bin\netf20\IfxDotNetIntrinsicModule.dll 
```

最有可能的路径可能已经设置为`<Informix Client Install Dir>\bin`。那么这可能是复制它的理想位置。

# php - Zend\Mvc\Router\Http\Method 和子路由

> ID：15554309
> 
> 赞同：1
> 
> 时间：2013-03-21T17:32:23.840
> 
> 标签：php, routes, zend-framework2

我已经定义了两条路线，/shoppingcart/ 和一条子路线 /shoppingcart/add/，它们应该只可用于 POST 请求。

```
 'routes' => array(
        'shoppingcart' => array(
            'type'    => 'literal',
            'options' => array(
                'route'       => '/shoppingcart/',
                'defaults'    => array(
                    'controller' => 'ShoppingcartController',
                    'action'     => 'shoppingcart',
                ),
            ),
            'may_terminate' => true,
            'child_routes' => array (
                'add-product' => array(
                    'type' => 'method',
                    'options' => array(
                        'verb' => 'post',
                        'route' => 'add/',
                        'defaults' => array(
                            'controller' => 'ShoppingcartController',
                            'action' => 'addProductToShoppingcart',
                        ),
                    ),
                ),
            )
        ),
    ) 
```

路线 /shoppingcart/ 工作正常。子路由 /shoppingcart/add/ 不起作用（POST 和 GET 出现 404 错误）。

当我将类型从方法更改为文字并删除动词键时，它可以工作。

如何在子路由中使用 Zend\Mvc\Router\Http\Method ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:12:57.623

您需要`may_terminate`为您的子路线设置 true 。

此外，您提到 GET 的路由失败，如果您只将动词设置为`post`，如果您也想允许`get`，动词应该是`get,post`

编辑：经过一些试验，事实证明我的理解是错误的，`Method`需要将类型放置为它所保护的路由的父级......

```
'routes' => array(
    'shoppingcart' => array(
        'type'    => 'literal',
        'options' => array(
            'route'       => '/shoppingcart/',
            'defaults'    => array(
                'controller' => 'ShoppingcartController',
                'action'     => 'shoppingcart',
            ),
        ),
        'may_terminate' => true,
        'child_routes' => array (
            'add-product' => array(
                'type' => 'method',
                'options' => array(
                    'verb' => 'get,post',
                ),
                'child_routes' => array(
                    // actual route is a child of the method
                    'form' => array(
                        'may_terminate' => true,
                        'type' => 'literal',
                        'options' => array(
                            'route' => 'add/',
                            'defaults' => array(
                                'controller' => 'ShoppingcartController',
                                'action' => 'addProductToShoppingcart',
                            ),
                        ),
                    ),
                ),
            ),
        ),
    ),
), 
```

# python - 使用 beautifulsoup 从 craigslist 获取价格

> ID：15554311
> 
> 赞同：2
> 
> 时间：2013-03-21T17:32:39.320
> 
> 标签：python, python-2.7, beautifulsoup, craigslist

我是 python 编码的新手（可能是几天），基本上是在 stackoverflow 上学习其他人的代码。我正在尝试编写的代码使用 beautifulsoup 来获取 craigslist 上摩托车的 pid 和相应的价格。我知道还有很多其他方法可以做到这一点，但我当前的代码如下所示：

```
from bs4 import BeautifulSoup         
from urllib2 import urlopen               
u = ""
count = 0
while (count < 9):
    site = "http://sfbay.craigslist.org/mca/" + str(u)
    html = urlopen(site)                      
    soup = BeautifulSoup(html)                
    postings = soup('p',{"class":"row"})                      
    f = open("pid.txt", "a")
    for post in postings:
        x = post.getText()
        y = post['data-pid']
        prices = post.findAll("span", {"class":"itempp"})
        if prices == "":
            w = 0
        else:
            z = str(prices)
            z = z[:-8]
            w = z[24:]
        filewrite = str(count) + " " + str(y) + " " +str(w) + '\n'
        print y
        print w
        f.write(filewrite)
    count = count + 1 
    index = 100 * count
    print "index is" + str(index)
    u = "index" + str(index) + ".html" 
```

它工作正常，随着我不断学习，我计划对其进行优化。我现在遇到的问题是，没有价格的条目仍然出现。有什么明显的东西我失踪了。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:11:47.383

问题是你如何比较`prices`. 你说：

```
prices = post.findAll("span", {"class":"itempp"}) 
```

在 BS`.findAll`中返回一个元素列表。当您将价格与空字符串进行比较时，它将始终返回 false。

```
>>>[] == ""
False 
```

更改`if prices == "":`为`if prices == []`，一切都应该没问题。

我希望这有帮助。

# javascript - 使用此方法时，Firefox 浏览器中的父网格不刷新？

> ID：15554313
> 
> 赞同：1
> 
> 时间：2013-03-21T17:32:54.623
> 
> 标签：javascript, asp.net-mvc, firefox

从弹出窗口（子）打开时，我正在使用此方法刷新父网格.....

但是这个脚本在firefox浏览器中不起作用....有什么原因吗？

```
var myWindow = window.open(ROOT +'Documents/FileUpload, '_blank', 'height=430px, width=600px,left=450px,top=240px,resizable=no,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no, status=no');
            myWindow.onbeforeunload = function(){        
            $("#pegGrid").jqGrid('setGridParam', { datatype: 'json' }).trigger('reloadGrid'); 
```

# jquery - 动态生成的下拉菜单不听 jquery 事件

> ID：15554314
> 
> 赞同：2
> 
> 时间：2013-03-21T17:32:58.883
> 
> 标签：jquery, ajax

```
$(document).ready(function() {
    $('[id^=drop_id]').on('change', function() {
        selected = $(this).find('option:selected').data('tid')   
        $.getJSON('path/'+selected,function(data){
        var s = $("<select id='drop_id_goddamnit' name=\"name\" />");
        $(data).each(function() {
          var option = $('<option />');
          option.attr('value', this.taxon.permalink).text(this.taxon.name).attr('data-tid',this.taxon.id);
          option.appendTo(s);
        });
        $('#header').append($(s));
    });
  });
}); 
```

我有这个代码。这将根据现有下拉列表的选定值添加一个下拉列表。并且新创建的下拉列表具有相同的更改事件以生成另一个下拉列表。但是动态生成的选择框不会触发该事件。

该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T17:40:08.260

这是一个事件委托的情况，新创建的elems不会得到change事件，试试这个方法：

```
$(document).on('change', '[id^="drop_id"]', function(){
    //your corresponding code.
}); 
```

因为在加载文档时，dom 中不存在该元素，因此直接事件绑定不会影响新插入的 dom elem。这就是为什么我们需要将事件委托给`$(document)`所有其他元素的父级或在加载 dom 时可用的最接近的现有父级。

所以最终的代码应该是这样的：

```
$(document).on('change', '[id^="drop_id"]', function() {
    selected = $(this).find('option:selected').data('tid')   
    $.getJSON('path/'+selected,function(data){
    var s = $("<select id='drop_id_goddamnit' name=\"name\" />");
    $(data).each(function() {
      var option = $('<option />');
      option.attr('value', this.taxon.permalink).text(this.taxon.name).attr('data-tid',this.taxon.id);
      option.appendTo(s);
    });
    $('#header').append($(s));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:37:37.797

您的代码应更改如下。将事件绑定到 DOM 中的现有元素。然后寻找子元素。您应该阅读使用 .on 方法的事件委托。

> 从 jQuery 1.7 开始，.delegate() 已被 .on() 方法取代。然而，对于早期版本，它仍然是使用事件委托的最有效方法。有关事件绑定和委托的更多信息在 .on() 方法中。

替换`$('[id^=drop_id]').on('change', function() {`为下面

```
 $('#parentid').on('change', '[id^=drop_id]', function() { 
```

您的代码的问题是新添加的元素没有绑定到它们的事件。

[阅读更多](http://api.jquery.com/delegate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:39:57.597

这个新下拉菜单的 onchange 事件无处可寻。唯一的 onchange 绑定发生在页面准备就绪上。在添加到页面后，您必须将 onchange 显式绑定到新的下拉列表

# python - 如何防止子进程在某些参数之间添加空格？

> ID：15554316
> 
> 赞同：2
> 
> 时间：2013-03-21T17:33:02.850
> 
> 标签：python, python-2.7, subprocess

我想使用 Python 及其`subprocess`模块从 Linux 执行一些 Mysql 命令。

**如果没有 Python**，从 shell 中，我的命令行是：

```
mysql --database=mydb --host=localhost --port=3306 --password=  --execute="select * from mytable" --batch 
```

**使用 Python**，我有：

```
cmd = ['mysql']
cmd.extend(['--database=', self._database])
cmd.extend(['--password=', self._password])
cmd.extend(['--execute=', query])

(...)

p = subprocess.Popen(cmd, shell = False, stdout = subprocess.PIPE, stderr = subprocess.PIPE)
out, err = p.communicate()
errcode = p.returncode 
```

不幸的是，它不起作用（mysql只是打印使用），我*认为*，子进程生成这种输出（`' '.join(cmd)`）：

```
mysql --database= mydb --host= localhost --port= 3306 --password=  --execute= "select * from mytable" --batch 
```

IE。每个参数之间添加空格，分隔`=`和值。

当我删除`=`每个参数`cmd.extend(['--password', self._password])`（

最后，我通过测试 void 参数找到了一种解决方法，但为了将来参考，是否有任何我不知道的子流程提示或用法来处理这种`parameter=`？*当你必须*使用时，必须有一些应用程序`=`，我尽量避免`Shell=True`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T17:38:22.520

将其更改为

```
cmd = [
    'mysql',
    '--database=%s' % self._database,
    '--password=%s' % self._password,
    '--execute=%s' % query
]

(...)

p = subprocess.Popen(cmd, shell = False, stdout = subprocess.PIPE, stderr = subprocess.PIPE)
out, err = p.communicate()
errcode = p.returncode 
```

使得参数列表包含带有各自参数的开关

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:40:00.973

您将包含一个`=`符号的每个参数作为两个单独的参数传递。不要那样做，因为它们不是两个独立的论点。

```
cmd.append('--database=' + self._database)
cmd.append('--password='+ self._password)
cmd.append('--execute=' + query) 
```

（大卫建议使用`[]`一次定义整个列表而不是重复`append`或`extend`调用是更好的风格。）

# macos - 我如何知道 OS X 上安装了哪个版本的 libxml2 和 libxslt？

> ID：15554321
> 
> 赞同：15
> 
> 时间：2013-03-21T17:33:13.393
> 
> 标签：macos, libxml2, libxslt

我正在尝试找出我当前安装的版本。OS X 山狮 (10.8.2)

提前致谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-12-29T11:08:28.923

另一种选择是运行`xmllint`并`xsltproc`使用`--version`标志：

```
$ xmllint --version
xmllint: using libxml version 20900
   compiled with: Threads Tree Output Push Reader Patterns Writer SAXv1 FTP HTTP DTDValid HTML Legacy C14N Catalog XPath XPointer XInclude ISO8859X Unicode Regexps Automata Expr Schemas Schematron Modules Debug Zlib
$ xsltproc --version
Using libxml 20900, libxslt 10128 and libexslt 817
xsltproc was compiled against libxml 20900, libxslt 10128 and libexslt 817
libxslt 10128 was compiled against libxml 20900
libexslt 817 was compiled against libxml 20900 
```

这意味着我正在运行 libxml2 2.9.0、libxslt 1.1.28 和 libexslt 0.8.17。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-12-29T10:40:24.647

不是一个完整的答案，可以通过查看包含`xmlversion.h`在里面找到的真实版本号`/usr/include/libxml2/libxml`：

```
Mac-mini-de-Vincent:libxml Vincent$ grep -Ri "LIBXML_DOTTED_VERSION" xmlversion.h
xmlversion.h:#define LIBXML_DOTTED_VERSION "2.9.0" 
```

所以在我的系统（10.9.1）上，libxml2 的版本是 2.9.0。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-21T17:36:16.967

在我的 10.8.3 系统上是 2.2：

```
> ls -l /usr/lib/libxml*
-rwxr-xr-x  1 root  wheel  2390032 Mar  2 17:18 /usr/lib/libxml2.2.dylib*
lrwxr-xr-x  1 root  wheel       15 Mar  2 17:21 /usr/lib/libxml2.dylib@ -> libxml2.2.dylib 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-26T10:01:45.950

在 10.8.5 中：

```
$ /usr/bin/xmllint --version
/usr/bin/xmllint: using libxml version 20708
   compiled with: Threads Tree Output Push Reader Patterns Writer SAXv1 FTP HTTP DTDValid
HTML Legacy C14N Catalog XPath XPointer XInclude ISO8859X Unicode Regexps Automata Expr
Schemas Schematron Modules Debug Zlib 

$ /usr/bin/xsltproc --version
Using libxml 20708, libxslt 10126 and libexslt 815
xsltproc was compiled against libxml 20708, libxslt 10126 and libexslt 815
libxslt 10126 was compiled against libxml 20708
libexslt 815 was compiled against livxml 20708 
```

# c# - 无法通过 Server.Execute() 执行文件

> ID：15554323
> 
> 赞同：0
> 
> 时间：2013-03-21T17:33:15.720
> 
> 标签：c#, asp.net

我想在子站点中执行文件。父站点和子站点都是 Web 应用程序。我不想重定向到子站点文件。我正在尝试使用 Server.Execute() 执行子文件，但它不起作用。

主要网址是： http: [//mysite.com/subsite](http://mysite.com/subsite)

子站点中文件的虚拟路径：~/subsite/subfile.aspx

当我访问[http://mainsite.com/subsite/subfile.aspx](http://mainsite.com/subsite/subfile.aspx)时，它工作正常。当我做

```
Server.Execute("~/subsite/subfile.aspx") 
```

从父网站，我得到：

```
Could not load type 'Subsite.SubFile'. 
```

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:20:26.673

我很确定`server.execute`不会跨越应用程序边界。我不是 100% 确定这一点。但鉴于错误消息似乎很可能。

基本上错误是说它无法找到（或加载）`Subsite.SubFile`定义类的程序集。

我可以想到两种可能的解决方案。

1.  将子站点的程序集复制到主站点 bin 文件夹中。这*可能会*起作用，因为主站点随后可以找到程序集并执行代码。这里有明显的缺点。例如需要将子站点中的所有配置信息复制到主站点 web.config 中。此外，任何具有相同名称的程序集都会有问题；当然，每次有更新时都需要在主站点之上部署子站点......

2.  而不是做一个`server.execute`; 使用`HttpRequest`该类对子站点进行常规 http 调用，然后解析响应并将您需要的内容写回浏览器。

# qt - OpenGL+ QT 5.0.1 + VS2010：错误 C2371：'GLdouble'：重新定义；不同的基本类型

> ID：15554325
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:33:17.490
> 
> 标签：qt, opengl, glut

我已经安装了 QT5.0.1，我正在尝试使用 GLUT。我有以下错误：

C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\include\GL/gl.h(55): 错误 C2371: 'GLdouble' : 重新定义；不同的基本类型 1> C:\Qt\Qt5.0.1\5.0.1\msvc2010\include\QtGui/qopengl.h(71) ：见“GLdouble”的声明

我不明白什么可能是错的以及该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:14:08.057

> I have installed **QT5.0.1** and I am trying to use **GLUT**

Pick *one* and *only one* framework.

Trying to use Qt *and* GLUT at the same time will only result in problems because they both want to own the event loop.

# c++ - 在编译时生成模板参数

> ID：15554329
> 
> 赞同：5
> 
> 时间：2013-03-21T17:33:37.003
> 
> 标签：c++, c++11, embedded, c-preprocessor

我创建了一个看起来像数组的类，但它不是在程序本身中保存数据，而是从文件中流式传输字节（以减少对 RAM 的影响）。现在我已经完成了所有这些工作，但是程序员必须使用以下内容定义类：

```
#define CreateReadOnlyBlock(name, location, size, ...)          \
template<>                                                      \
const unsigned int ReadOnlyBlock<location, size>::Data[]        \
    __asm__( ".readonly__" #location "__" #name)                \
    = { __VA_ARGS__ };                                          \
ReadOnlyBlock<location, size> name; 
```

例子：

```
//A read only array of {0, 1, 2, 3}
CreateReadOnlyBlock(readOnlyArray, 0, 4, 0, 1, 2, 3); 
```

请注意，这是针对嵌入式处理器的，asm 指令通过汇编器中的工具来创建只读文件。

所以这是我的问题：如何消除“位置”和“大小”变量？我讨厌程序员必须手动输入它们，并且更喜欢在编译时生成它们的某种方式。因此，程序员不需要键入：

```
//A read only array at location 0 of {0, 1, 2, 3}
CreateReadOnlyBlock(readOnlyArray1, 0, 4, 0, 1, 2, 3); 
//A read only array at location 4 of {4, 5, 6, 7}
CreateReadOnlyBlock(readOnlyArray2, 4, 4, 4, 5, 6, 7); 
```

他们可以输入：

```
CreateReadOnlyBlock(readOnlyArray1, 0, 1, 2, 3); 
CreateReadOnlyBlock(readOnlyArray2, 4, 5, 6, 7); 
```

并且会生成适当的常量。基本上，我正在寻找某种方法来在编译时根据先前的定义生成和放置这些常量。C ++ 11 是公平的游戏，我只是不太熟悉它（带有 constexpr 的东西似乎是合理的？）。此外，如果 C-Preprocessor 不会使它变得比现在更丑，它也可以。这可能吗？

为清楚起见编辑：

在 ReadOnlyBlock 类中有这个方法：

```
 template<const int _location, const int _size> class ReadOnlyBlock
    {
        ...
        unsigned int operator[] (size_t index)
        {
            return LoadFromROM(index + _location);
        }
    } 
```

位置变量和 ROM 文件之间存在内在的相互依赖关系，我想不出如何打破。但是，我*也*可以完全控制工具链，但是我需要一种方法来传递汇编器工具如何构造文件以及向 C++ 代码指示块在文件中的位置。

另一个编辑：

该文件及其块可能*非常*大，多达 1k 个字，因此很多预处理器魔法可能会崩溃。另外，感谢大家迄今为止的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:15:12.897

我仍然没有看到生成名称（那个`#location`片段）的完整解决方案，但对于其余的，我想你可以使用这样的东西：

```
template< std::size_t Line >
struct current_location : current_location< Line - 1 > {};

template<>
struct current_location< 0 > : std::integral_constant< std::size_t, 0 > {};

#define NUMARGS(...) (sizeof((int[]){__VA_ARGS__})/sizeof(int))

#define CreateReadOnlyBlock(name, ...)                          \
template<>                                                      \
const unsigned int ReadOnlyBlock<                               \
    current_location<__LINE__-1>::value, NUMARGS(__VA_ARGS__)   \
>::Data[]                                                       \
    __asm__( ".readonly__" #name)                               \
    = { __VA_ARGS__ };                                          \
ReadOnlyBlock<current_location<__LINE__-1>::value,              \
              NUMARGS(__VA_ARGS__)> name;                       \
template<>                                                      \
struct current_location<__LINE__>                               \
    : std::integral_constant<std::size_t,                       \
        current_location<__LINE__-1>::value+NUMARGS(__VA_ARGS__)> \
{}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:14:24.343

也许有点掌握，但是可以使用可变参数模板而不是 va_args 吗？就像是

```
template <typename T1, ... TV>
class ReadOnlyBlock
{
    static unsigned int Data[sizeof(TV) + 1];
}; 
```

基本上，任何你需要“位置”的地方，都可以使用 T1。在任何需要“大小”的地方，使用 sizeof(TV) + 1。没有合适的编译器来测试它，但也许需要考虑......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T18:14:45.983

它可能会有所帮助。我写了一些东西来计算块可以在`DEF_BLOCK(size)`块声明之前添加。您可以尝试重写我的示例以在我的块内分配数据

```
template<size_t ID>
struct block_t
{
   enum{location = 0};
};

#define LAST_BLOCK struct last_block_t{enum{id=__COUNTER__-1};};

#define SPEC2(ID, SIZE) template<> struct block_t<ID>{enum{location = block_t<ID-1>::location + SIZE, prev_block = ID-1, size = SIZE};}
#define SPEC(ID, SIZE) SPEC2(ID, SIZE)

#define DEF_BLOCK(SIZE) SPEC(__COUNTER__, SIZE)

DEF_BLOCK(10);
DEF_BLOCK(11);
LAST_BLOCK;

int _tmain(int argc, _TCHAR* argv[])
{
   std::cout << block_t<last_block_t::id>::location << std::endl;
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T18:22:36.693

如果以下情况成立：

*   你不在`__COUNTER__`其他地方使用
*   所有数组的最大长度为 5
*   所有数组都在同一个文件中定义

然后你可以这样做：

```
#include <iostream>

#define VA_NARGS_IMPL(_1, _2, _3, _4, _5, N, ...) N
#define VA_NARGS(...) VA_NARGS_IMPL(__VA_ARGS__, 5, 4, 3, 2, 1)

template <int... Args>
struct arg_counter {
  enum { count = sizeof...(Args) };
};

#define INC_COUNTER1 arg_counter<-1>::count
#define INC_COUNTER2 arg_counter<-1, __COUNTER__>::count
#define INC_COUNTER3 arg_counter<-1, __COUNTER__, __COUNTER__>::count
#define INC_COUNTER4 arg_counter<-1, __COUNTER__, __COUNTER__, __COUNTER__>::count
#define INC_COUNTER5 arg_counter<-1, __COUNTER__, __COUNTER__, __COUNTER__, __COUNTER__>::count

#define INC_COUNTER_IMPL2(count, ...) INC_COUNTER ## count
#define INC_COUNTER_IMPL(count, ...) INC_COUNTER_IMPL2(count, __VA_ARGS__) 
#define INC_COUNTER(...) INC_COUNTER_IMPL(VA_NARGS(__VA_ARGS__), __VA_ARGS__)

// removed: __asm__( ".readonly__" #location "__" #name)
#define CreateReadOnlyBlockImpl(name, location, size, ...)      \
  template<>                                                    \
  const unsigned int ReadOnlyBlock<location, size>::Data[]      \
    = { __VA_ARGS__ };                                          \
  ReadOnlyBlock<location, size> name;

#define CreateReadOnlyBlock(name, ...)                                  \
  CreateReadOnlyBlockImpl(name, __COUNTER__, INC_COUNTER(__VA_ARGS__), __VA_ARGS__);

template<int Location, int Size> struct ReadOnlyBlock
{
  static const unsigned int Data[Size];
  int loc () const { return Location; }
  int size() const { return Size; }
};

CreateReadOnlyBlock(readOnlyArray1, 0, 1, 2, 3);
CreateReadOnlyBlock(readOnlyArray2, 4, 5, 6, 7);
CreateReadOnlyBlock(readOnlyArray3, 9);
CreateReadOnlyBlock(readOnlyArray4, 1, 2, 3, 4, 5);

int main()
{
  std::cout << "@" << readOnlyArray1.loc() << ": " << readOnlyArray1.size() << '\n';
  std::cout << "@" << readOnlyArray2.loc() << ": " << readOnlyArray2.size() << '\n';
  std::cout << "@" << readOnlyArray3.loc() << ": " << readOnlyArray3.size() << '\n';
  std::cout << "@" << readOnlyArray4.loc() << ": " << readOnlyArray4.size() << '\n';
} 
```

[在 ideone 上打印：](http://ideone.com/NGifJm)

```
@0: 4
@4: 4
@8: 1
@9: 5 
```

# c# - 在 IEnumerable foreach vs List 中修改结构 .ForEach

> ID：15554331
> 
> 赞同：1
> 
> 时间：2013-03-21T17:33:40.497
> 
> 标签：c#, ienumerable

这个问题专门针对结构。

说我定义：

```
struct Complex
{
    public double real, imaginary;
} 
```

如果我尝试：

```
var numbers = new[] 
{
    new Complex() { real = 1, imaginary = 1 },
    new Complex() { real = -1, imaginary = -1 } 
};

foreach ( var z in numbers )
{
    z.real += 1;
} 
```

我得到编译错误：`Error: cannot modify members of 'complex' because it is a 'foreach iteration variable'`

然而，

```
var numbers = new List<Complex>();
numbers.Add( new Complex() { real = 1, imaginary = 1 } );
numbers.Add( new Complex() { real = -1, imaginary = -1 } );

numbers.ForEach( z => z.real += 1 ); 
```

编译没有错误。牢记“foreach”编译错误，这里有什么理由不给出编译时错误吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T17:36:14.557

TL;博士：

*   C#*试图*保护你免受自己的伤害
*   如果你足够努力，你将能够做坏事——语言并不能保护你免受你可能做的*每*一件愚蠢的事情
*   可变结构不好

> 那么有什么理由不在这里给出编译时错误吗？

是的。您只是在修改一个参数，这绝对没问题。参数不被认为是只读的，而循环中的迭代变量`foreach`被*认为*是只读的。从 C# 5 规范的第 8.8.4 节：

> 在执行 foreach 语句期间，迭代变量表示当前正在对其执行迭代的集合元素。如果嵌入语句尝试修改迭代变量（通过赋值或 ++ 和 -- 运算符）或将迭代变量作为 ref 或 out 参数传递，则会发生编译时错误。

这并不意味着使用可变变量是一个好主意——这也不意味着你的`ForEach`循环会做你想做的事。（毕竟参数是*按值*传递给委托的。）

如果你真的想在版本中做类似的事情（同样无效，但是嘿......）`foreach`，只需在结构中编写一个改变字段的*方法，然后从循环中调用它。*这是完全有效的...

```
// Bad code! Valid, but horrible
foreach (var z in numbers)
{
    z.SetReal(z.real + 1);
} 
```

它仍然不会修改列表中的值......但它不会在编译时失败。

# android - Android TCP 客户端套接字

> ID：15554340
> 
> 赞同：0
> 
> 时间：2013-03-21T17:33:58.597
> 
> 标签：android, sockets, tcp, client

在我的服务器中，我向套接字发送一个无限循环的（“数字：%d\n”，i）。而且，在每个循环中，我都会将数字增加一。然后我使用以下代码在 android 设备（即 TCP 客户端）中接收它：while(connected){

```
 //receive data through socket  
            BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            Log.d(TAG, "1");

             while(connected){              

            //receive data through socket  
            BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            Log.d(TAG, "1");

             while ( (line = in.readLine()) != null){

                   Log.d(TAG, line);
                   str.append(line);
                   Log.d(TAG, "2");

                   runOnUiThread(new Runnable() {

                    @Override
                    public void run() {

                        input.setText( str );

                }});

             }

        } 
```

这是 logcat 的结果：

> r：25363332´┐¢编号：3405er：3839er：4201er：4925´┐¢编号：557776228¢编号：6301´┐¢编号：7265€¢编号：7265´┐ ´┐¢号码: 1173112020´┐¢号码: 12093´┐¢号码: 12455号码: 12672er: 13491´┐¢号码: 13903er: 14337er: 14699´┐¢号码: 15351´┐¢¢号码: 157361er: 16147号码：1643716726´┐¢号码：16799号码：17016号码：173 787´┐¢号码：17885号码：187047´┐¢号码：19695er：201291´┐¢号码：20419´┐¢号码：207813´┐2号码：207813´┐2号码：511 ：2157721794´┐¢编号：21867er：2230122518n umber：22808er：23627244446´┐¢编号：25125er：2555592637872794848€

所以这不能识别 \n，并且在套接字读取之间它正在丢失数据。是因为 UI 线程的不断实现吗？

我应该怎么做呢？

更新

这是 C 语言中的服务器代码：

```
 int main(int argc, char **argv)
 {

socklen_t client_len;
struct sockaddr_in cli_addr;
struct sockaddr_in serv_addr;
int client_count=0;
int nbytes, i, sockfd, new_sockfd;
char buf[20];

/* Init socket */   
sockfd=socket(AF_INET, SOCK_STREAM, 0);     
if (sockfd<0) error("ERROR opening socket");
bzero((char *) &serv_addr, sizeof(serv_addr));
serv_addr.sin_family = AF_INET;
serv_addr.sin_addr.s_addr = INADDR_ANY;
serv_addr.sin_port = htons( atoi(argv[1]) );

/*associate socket to the port*/
if (bind(sockfd, (struct sockaddr *) &serv_addr, sizeof(serv_addr)) < 0) error("ERROR on binding");

/* connection to the client */
listen(sockfd, 1); /*server is ready to receive connections*/
client_len = sizeof(cli_addr);
new_sockfd = accept(sockfd, (struct sockaddr *) &cli_addr, &client_len); /*server accepts request */
client_count =1; /*write to socket when client is available*/   

i = 1;

while(1){

    sprintf(buf, "number: %d\n", i); 

    if (client_count >0){
        nbytes = write( new_sockfd, buf, sizeof(buf)); /* write to socket */
        if(nbytes<0){
            printf("ERROR on sendto");
        }
    }

    i = i+1;
}   

return (0); 
```

}

# php - cakephp 1.3 查找所有现在和未来总共最多 5 条记录

> ID：15554341
> 
> 赞同：0
> 
> 时间：2013-03-21T17:33:59.990
> 
> 标签：php, sql, cakephp-1.3

我无法让查询返回预期结果。从 cakephp 1.1 迁移到 1.3。目前，我的新查询没有返回任何结果。得到结果后，我需要限制为 5。 now() 在我的`$sqlConditions`数组中是否正确？有什么建议么？感谢您的关注。

### 旧查询 cakephp 1.1：

```
function listcomingevents() {
    $conditions="EventsDate.start_date>=now()";
    $this->weekevent="EventsDate.start_date ASC";
    $listcomingeventdata=$this->EventsDate->findAll($conditions,'',$this->weekevent,'5');
    return $listcomingeventdata;
} 
```

### 新查询 cakephp 1.3：

```
function listcomingevents() {
    $sqlConditions = array( "EventsDate.start_date >="=>"now()");

    //remaining code
    $sqlOrderBy = array("EventsDate.start_date asc");
    $sqlParams = array('conditions'=>$sqlConditions,'order'=>$sqlOrderBy);
    $listcomingeventdata=$this->EventsDate->find('all',$sqlParams);
    return $listcomingeventdata;
} 
```

也试过：

```
$sqlConditions = array("EventsDate.start_date >="=>"CURDATE()"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:39:24.630

只需将`NOW()`表达式直接放在左侧即可，例如

```
 $sqlConditions = array( "EventsDate.start_date >= CURDATE()"); 
```

# c# - 使用 INotifyPropertyChanged 的 复合模型绑定性能

> ID：15554348
> 
> 赞同：0
> 
> 时间：2013-03-21T17:34:26.723
> 
> 标签：c#, data-binding, inotifypropertychanged, wpf-4.0

我目前正在研究一种解决方案，该解决方案具有一组复合视图模型，这些视图模型是从一组数据访问服务返回的域模型映射的。

到目前为止，我`INotifyPropertyChanged`在基础 ViewModel 对象上实现并通过属性更改事件通知 UI 属性对象的更改方面取得了很大的成功。

这是视图模型的示例：

```
public class DisplayDataModel : INotifyPropertyChanged{ 
   private DateTime _lastRefreshTime;
    public DateTime LastRefreshTime {
        get { return _lastRefreshTime; }
        set {
            _lastRefreshTime = value;
            this.NotifyPropertyChanged(lddm => lddm.LastRefreshTime, PropertyChanged);
        }
    }

    private string _lineStatus;
    public string LineStatus {
        get { return _lineStatus; }
        set {
            if (_lineStatus != value) {
                _lineStatus = value;
                this.NotifyPropertyChanged(lddm => lddm.LineStatus, PropertyChanged);
            }
        }
    }           

    private ProductionBrickModel _productionBrick;
    public ProductionBrickModel ProductionBrick { 
        get { return _productionBrick;}

        set {
            if (_productionBrick != value) {
                _productionBrick = value;
                this.NotifyPropertyChanged(lddm => lddm.ProductionBrick, PropertyChanged);
            }
        }
    }
}

public class ProductionBrickModel{

    public int? Set { get; set; }
    public int? Theoretical { get; set; }
    public int? Actual { get; set; }
    public string LineName { get; set; }
    public TimeSpan? ShiftOverage { get; set; }

    public SolidColorBrush ShiftOverageBrush {
        get {
            if (ShiftOverage.HasValue && ShiftOverage.Value.Milliseconds < 0) {
                return Application.Current.FindResource("IndicatorRedBrush") as SolidColorBrush;
            }

            return Application.Current.FindResource("IndicatorWhiteBrush") as SolidColorBrush;
        }
    }
    public string ShiftOverageString { get { return ShiftOverage.HasValue ? ShiftOverage.Value.ToShortTimeSpanString() : ""; } }

} 
```

所以目前我在基本模型而不是生产砖属性上触发通知事件，主要是因为生产砖属性几乎每次刷新都会改变。

最近，我开始将刷新时间缩短到 350 毫秒左右，我看到`ShiftOverageBrush`即使值仍然是负数，它也会在一瞬间变为白色。

我的问题是，通过`INotifyPropertyChanged`对构成基本视图模型的对象类型进行检查和实现，我会获得任何性能，甚至可能解决这个问题吗？或者这完全来自我不理解的其他东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:38:32.507

您的代码中有两个明显的低效率来源：

1) ShiftOverageBrush 每次调用时都在使用 FindResource。为什么不缓存画笔？

```
private SolidColorBrush _redBrush;
private SolidColorBrush IndicatorRedBrush
{
    get{ return _redBrush ?? (_redBrush = 
        Application.Current.FindResource("IndicatorRedBrush") as SolidColorBrush)); 
}

... same for white brush

public SolidColorBrush ShiftOverageBrush {
    get {
        if (ShiftOverage.HasValue && ShiftOverage.Value.Milliseconds < 0) {
            return IndicatorRedBrush;
        }

        return IndicatorWhiteBrush;
    }
} 
```

2) 对 NotifyPropertyChanged 使用 lambda 表达式很方便，但由于它使用反射，所以速度很慢。如果您要提高更新率，请用字符串替换 lambda。

# java - 无法从资产中读取 csv 文件

> ID：15554351
> 
> 赞同：2
> 
> 时间：2013-03-21T17:34:45.593
> 
> 标签：java, android, csv, opencsv

我正在尝试从 android assets 文件夹中读取一个 csv 文件。我已经查看了有关此的其他帖子，似乎我已经像其他人一样设置了它。我已经尝试`this.getAssets()`将上下文传递给方法并使用`context.getAssests()`Here is the code 我用来读取文件的代码。并将信息存入数据库。

```
try{
        AssetManager mng = getApplicationContext().getAssets();
        InputStream is = mng.open("word_types.csv");
        CSVReader csv = new CSVReader(new InputStreamReader(is));

        String[] s;
        while((s = csv.readNext()) != null){
            db.addWordType(Integer.parseInt(s[0]), s[1], Integer.parseInt(s[2]));
        }   
        csv.close();
    }catch(IOException ioe){
        Log.e("File Read Error: ","" + ioe.getMessage());
    }

    for(int i=1;i<=12 ;i++ )
            Log.i(i+" = ", ""+ db.getWordType(i)); 
```

以下是在 logcat 中打印的内容：

```
E/File Read Error: (25767): word_types.csv
I/1 =     (25767): null
I/2 =     (25767): null
I/3 =     (25767): null
I/4 =     (25767): null
I/5 =     (25767): null
I/6 =     (25767): null
I/7 =     (25767): null
I/8 =     (25767): null
I/9 =     (25767): null
I/10 =    (25767): null
I/11 =    (25767): null
I/12 =    (25767): null 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T19:03:04.087

我意识到我犯了一个愚蠢的错误。感谢[CommonsWare](https://stackoverflow.com/users/115145/commonsware)告诉我关于打印出这样的堆栈跟踪。我不知道将 ioe 添加为第三个参数。查看堆栈跟踪后，我意识到我拼写错误的资产目录。我有评估。

# java - 从 Java/Groovy 批量加载 MongoDB 数据库进行测试

> ID：15554352
> 
> 赞同：1
> 
> 时间：2013-03-21T17:34:52.890
> 
> 标签：java, mongodb, grails, groovy, bson

我有一个现有的 Grails/MongoDB 应用程序，我正在向其中添加一些自动化测试。我希望针对 Mongo 集合中的一组特定数据执行这些测试。我希望测试能够破坏数据（如果幸运的话，结果可预测），然后能够快速删除并重新创建/重新加载数据库，以便我可以再次运行测试。

由于我打算将此种子测试数据基于我们生产系统中的真实数据，因此我希望能够从 JSON/BSON 格式加载数据，我可以从 Mongo shell 中的查询或其他东西中检索这些数据相似的。

基本上我不想写一百行代码，如下所示： new Record(name: 'John Doe', age: '25', favoriteColor: 'blue').save()

除了每个属性有 30 个之外，始终确保满足约束条件并且数据是真实的。这就是我想使用生产数据的原因。

我也不想求助于运行 mongorestore 的生成 exec 来加载和重新加载真实数据，因为这需要在测试者的机器上运行额外的软件。

有没有更好的办法？也许以某种方式将原始 JSON 解组为我可以使用 Grails MongoDB GORM 或 GMongo 执行的东西，或者直接调用 Java MongoDB 驱动程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:57:17.200

您可以使用[com.mongodb.util.JSON](http://api.mongodb.org/java/2.6/com/mongodb/util/JSON.html)类将 JSON 数据直接转换为 DBObject。看一下这个[例子](http://www.mkyong.com/mongodb/java-mongodb-convert-json-data-to-dbobject/)，它演示了如何使用 Java 驱动程序来做到这一点。
这篇 MongoDB[博客文章](http://blog.mongodb.org/post/18510469058/grails-in-the-land-of-mongodb)展示了如何使用 GORM 和 Groovy 驱动程序来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:38:38.923

您是否需要将测试数据存储在可传输的文件中，或者您是否始终可以访问它可以存在的 mongodb 实例？例如，假设您有一个测试 mongodb 服务器，并且您可以依赖于在运行测试时访问它。

在这种情况下，最简单的解决方案是将测试数据保存在您在每次测试运行之前克隆的集合中。然后，测试可以根据需要随意破坏克隆的集合，而不会丢失任何实际数据。

如果您需要将测试数据保存在文件中（例如，因为您想将其存储在代码存储库中），那么您需要找到一种易于从 BSON 序列化/反序列化的格式。JSON 似乎是一个显而易见的选择，尤其是因为正如上面@drorb 所说，mongodb 已经有工具可以为您做到这一点。

然后，您只需要编写一个脚本来将现有集合的内容转储到 JSON 文件中，然后编写另一个脚本来加载一组 JSON 文件并将它们存储在一个集合中 - 每个可能不超过几行。

我建议将每个对象存储在单独的 JSON 文件中，而不是使用包含所有测试数据的大文件。尽管我很喜欢 JSON，但它不适合流式传输，并且您必须将整个集合存储在内存中，然后才能开始将其转储到 mongodb 中。如果您的测试数据足够大，它可能会开始导致内存问题。

# css - HTML5 Canvas 以全分辨率填充窗口

> ID：15554354
> 
> 赞同：0
> 
> 时间：2013-03-21T17:34:57.200
> 
> 标签：css, html, canvas

## 我正在尝试实现这样的布局：

![想要的效果](../Images/bc7453d4b0df22fc5d43216bc8374bf9.png)

在哪里：

*   `Navbar`只是一个类似 bootstrap 的顶部菜单，60px 的高度，总是在顶部
*   `Pop-up menu`固定在那个位置（不总是可见），总是在上面
*   整个空闲区域（windows wo navbar）都被`Canvas`.

**现场示例：** [jsFiddle](http://jsfiddle.net/x5LpA/)

我有一个问题`Canvas`。我目前有一个简单的风格：

```
<canvas id="le_canvas">Y U NO CANVAS</canvas>
...
#le-canvas {
    position:absolute;
    width:100%;
    height:100%;
} 
```

并且画布**正在**填充背景，但是：

*   分辨率很低
*   它在窗口调整大小期间不保持比率。

我想要什么（**如果可能的话**）：

*   要填充的区域的全分辨率（画布和屏幕上的像素为 1:1）
*   设置要填充的区域的比例
*   奖励：在窗口调整大小后更新上述内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:28:38.503

以百分比设置画布*元素*不会设置必须以绝对像素设置的实际画布大小。这里发生的是你得到一个默认大小的画布，然后被 html 渲染拉伸，看起来模糊。

因此，您需要使用 f.ex 设置大小。以绝对像素为单位的窗口大小。

你可以这样做（这里的小提琴更新：http: [//jsfiddle.net/x5LpA/3/](http://jsfiddle.net/x5LpA/3/)） -

创建一个根据窗口大小设置画布大小的函数（您当然需要减去条的高度等，但要显示原理）：

```
function initCanvasArea(cnv) {
    cnv.width = window.innerWidth;
    cnv.height = window.innerHeight;
} 
```

由于在重新调整画布大小时画布内容会被清除，因此您需要每次重新渲染内容。因此，将渲染内容提取到像 f.ex 这样的单独函数中会很聪明：

```
function renderCanvas(ctx) {
    ctx.fillStyle = "rgb(200,0,0)";
    ctx.fillRect(0, 0, 55, 50);

    ctx.fillStyle = "rgba(0, 0, 200, 0.5)";
    ctx.fillRect(20, 20, 55, 50);
} 
```

现在，让 main 函数成为一个自调用函数，您还可以在其中附加一个用于windo.resize 的事件处理程序以更新画布：

```
$(function () {

    var canvas = $('#le_canvas')[0];
    var ctx = canvas.getContext('2d');

    initCanvasArea(canvas);
    renderCanvas(ctx);

    window.onresize = function(e) {
        initCanvasArea(canvas);
        renderCanvas(ctx);
    };

})(); 
```

最后通过删除设置为 100% 的宽度/高度来编辑 CSS 规则；

```
#le_canvas {
    position:absolute;
} 
```

（提示：这里更好的方法是使用`fixed`位置属性 - 加上使用包装元素、填充、框大小......但这超出了这个问题的范围）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:58:47.980

这就是你所追求的吗？我使用`$(document).width()`and`$(document).height()`来获取矩形的宽度和高度。[http://jsfiddle.net/x5LpA/1/](http://jsfiddle.net/x5LpA/1/)

# c - 带有 Ingenico iCT220 的 USB 设备

> ID：15554362
> 
> 赞同：3
> 
> 时间：2013-03-21T17:35:10.500
> 
> 标签：c, usb, hid

**短篇故事**

我的任务是将 USB 条形码扫描仪连接到此终端[[linky (PDF)]](http://www.ingeserve.com/DataSheet/Technical+Manual+ICT220+EN+DIV1302A.pdf)，它有一个 USB 主机端口（根据文档为“usb master”），我可以在其上连接任何 USB 设备，然后使用 ingenico sdk（C基于）`systemfioctl's`功能，我可以检测是否存在 USB 设备，读取其 PID、VID、类、子类和协议，

**问题...**

唯一不能做的就是读取它的输入，我尝试过使用鼠标、键盘和游戏手柄，根据文档，操作系统会创建一个设备文件“com6”以便与这个 USB 端口进行交互，问题是每次我`fread`这个设备它总是读取 0 字节，因为这个东西不运行任何版本的 linux 我想我不能使用传统的 HID 库。

以前有没有人做过这么奇怪的事情？

# r - 如何用 NA 替换整行 data.table？

> ID：15554363
> 
> 赞同：5
> 
> 时间：2013-03-21T17:35:10.487
> 
> 标签：r, data.table

这似乎应该很容易，但我无法弄清楚。

```
>d=data.table(x=1:5,y=11:15,z=letters[1:5])
>d
   x  y z
1: 1 11 a
2: 2 12 b
3: 3 13 c
4: 4 14 d
5: 5 15 e 
```

现在，我决定第 3 行是坏数据。我希望所有这些都设置为 NA。

```
d[3,]<-NA 
```

> 警告消息：在`[<-.data.table`( `*tmp*`, 3, , value = NA) 中：将“逻辑”RHS 强制为“字符”以匹配列的类型。首先将目标列更改为“逻辑”（通过创建一个新的“逻辑”向量长度 5（整个表的 n 行）并分配它；即“替换”列），或者将 RHS 强制为“字符”（例如 1L、NA_ [real|integer]_, as.*, etc) 以使您的意图清晰并加快速度。或者，请在创建表格时预先正确设置列类型并坚持下去。

然而，它似乎奏效了。

```
> d
    x  y  z
1:  1 11  a
2:  2 12  b
3: NA NA NA
4:  4 14  d
5:  5 15  e 
```

如果我转换为 data.frame，它也可以工作，但没有警告。但后来我需要转换回来，这似乎很尴尬。有没有更好的办法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T20:50:58.627

参照设定。

```
DT[rownum, (names(DT)) := lapply(.SD, function(x) {  .x <- x[1]; is.na(.x) <- 1L; .x})] 
```

也许

```
DT[rownum, (names(DT)) := lapply(.SD[1,], function(x) { is.na(x) <- 1L; x})] 
```

这将确保创建正确的 NA 类型（以及因子和日期）

第二种情况只索引一次，如果 DT 中有很多列或 rownum 创建大量行子组，这可能会稍微快一些。

您也可以这样做（罗兰解决方案的一个变体，但没有复制。

```
DT[rownum, (names(DT)) := .SD[NA]] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-21T17:44:15.727

使用显式`NA`类型：

```
d[3,] <- list(NA_integer_, NA_integer_, NA_character_) 
```

另一种可能：

```
d[3,] <- d[3,lapply(.SD,function(x) x[NA])] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T17:45:16.270

怎么用`?set`？

```
> d=data.table(x=1:5,y=11:15,z=letters[1:5])
> set(d, 3L, 1:3, NA_character_)
> d
    x  y  z
1:  1 11  a
2:  2 12  b
3: NA NA NA
4:  4 14  d
5:  5 15  e
> str(d)
Classes ‘data.table’ and 'data.frame':  5 obs. of  3 variables:
 $ x: int  1 2 NA 4 5
 $ y: int  11 12 NA 14 15
 $ z: chr  "a" "b" NA "d" ...
 - attr(*, ".internal.selfref")=<externalptr> 
```

或者，简单地说：

```
> d=data.table(x=1:5,y=11:15,z=letters[1:5])
> d[3] <- NA_character_
> str(d)
Classes ‘data.table’ and 'data.frame':  5 obs. of  3 variables:
 $ x: int  1 2 NA 4 5
 $ y: int  11 12 NA 14 15
 $ z: chr  "a" "b" NA "d" ...
 - attr(*, ".internal.selfref")=<externalptr> 
```

* * *

[来自马修]是的，要么`set()`是要走的路，要么@mnel的回答非常简洁：

```
DT[rownum, names(DT) := .SD[NA]] 
```

关于该`set`方法中是否存在强制警告，这是内部代码（此处已修改以传达要点）。在写这篇文章时，我似乎已经考虑到精度（从`double`到`integer`）的损失，以及强制 RHS 的效率低下。

```
if( (isReal(RHS) && (TYPEOF(targetcol)==INTSXP || isLogical(targetcol))) ||
    (TYPEOF(RHS)==INTSXP && isLogical(targetcol)) ||
    (isString(targetcol))) {
    if (isReal(RHS)) s3="; may have truncated precision"; else s3="";
    warning("Coerced '%s' RHS to '%s' to match the column's type%s. ... <s3> ...
} 
```

可以在这里检查 assign.c 的完整来源：
[https ://r-forge.r-project.org/scm/viewvc.php/pkg/src/assign.c?view=markup&root=datatable](https://r-forge.r-project.org/scm/viewvc.php/pkg/src/assign.c?view=markup&root=datatable)

有一个非常相似的功能请求来改进这一点：

[FR#2551 Singleton := 如果没有精度丢失，RHS 没有强制警告](https://r-forge.r-project.org/tracker/index.php?func=detail&aid=2551&group_id=240&atid=978)

已在此处添加了指向此问题的链接。

一般来说，`data.table`在警告您潜在问题或效率低下时过于谨慎，在这种情况下，您想要设置一组不同类型的列，换行`suppressWarnings()`是另一种方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:56:57.997

这就是我现在正在做的事情。好吧，我猜，但还是有点尴尬。

```
na_datatable_row<-function(dtrow){
  #take a row of data.table and return a row of the same table but 
  #with all values set tp NA
  #DT[rownum,]<-NA works but throws an annoying warning 
  #so instead, do DT[rownum,]<-na_datatable_row(DT[anyrow,]) 
  #this preserves the right types
  row=data.frame(dtrow)
  row[1,]<-NA
  return(data.table(row))
} 
```

# vb.net - 将文本数据文件转换为 csv 格式

> ID：15554368
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:35:24.070
> 
> 标签：vb.net

我的文本数据文件是这样的：

```
{1000}xxx{1200}xxx{3000}xxxxxx{5000}
{1000}xx{1500}xxxxxx{4000}xx{6000}
{1000}xxxx{1600}xxx{3000}xxx{6000}
... 
```

我需要将此数据文件转换为 csv 文件或 excel 文件进行分析。我尝试了 Excel 或其他转换软件。但它不起作用。

我可以使用VB来做到这一点吗？我很长一段时间（超过 10 年）没有使用 VB。

对不起。我没有说清楚。

大括号中的数字是字段名称。每条记录没有相同的字段。转换后的结果应该是这样的：

```
(header line) 1000  1200 1500 1600 3000 4000 5000 6000
(record line)  xxx   xxx            xxx       xxx
      .        xxx        xxx            xxx       xxx
      .        xxx             xxx  xxx            xxx 
```

我们每天都有文本数据文件（10 - 20 条记录）。虽然数据不大，但是如果我们可以转换成csv文件，我们就不需要重新输入excel文件。这可以帮助我们很多时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:53:00.463

您几乎肯定可以使用编程语言（如 VB）来进行此更改。我不确定你是否需要这样做。

如果您正在尝试编写一个程序来一遍又一遍地转换相同类型的文件，那么在 VB.net 中构建一个程序可能是有意义的。

仅供参考，如果不进一步了解您需要做什么，很难为您提供进一步的建议？例如，文件的大小、您需要多久执行一次、目标格式是什么等等……

...但是我提供的答案确实回答了您提出的问题！...我正在寻求代表点;）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:12:53.287

根据您对数据结构的解释：

```
Imports System.IO
Imports System.Text
Imports System.Text.RegularExpressions

Module Module1

    Class Cell
        Property ColumnName As String
        Property Value As String

        ' To help with debugging/general usage
        Public Overrides Function ToString() As String
            Return String.Format("Col: {0} Val: {1}", ColumnName, Value)
        End Function
    End Class

    Dim table As New List(Of List(Of Cell))

    Sub Main()
        Dim src As String = "C:\temp\sampledata.txt"
        Dim dest = "C:\temp\sampledata.csv"

        Dim colNames As New List(Of String)

        ' This regex will look for zero or more characters ".*" surrounded by braces "\{ \}" and
        ' collect the zero or more characters in a group "( )". The "?" makes it non-greedy.
        ' The second capture group "( )" gets all the characters up to but not including
        ' the next "\{" (if it is present).
        Dim cellSelector = New Regex("\{(.*?)\}([^\{]*)")

        ' Read in the cells and record the column names.
        Using inFile = New StreamReader(src)
            While Not inFile.EndOfStream
                Dim line = inFile.ReadLine
                Dim rowContent As New List(Of Cell)
                For Each m As Match In cellSelector.Matches(line)
                    rowContent.Add(New Cell With {.ColumnName = m.Groups(1).Value, .Value = m.Groups(2).Value})
                    If Not colNames.Contains(m.Groups(1).Value) Then
                        colNames.Add(m.Groups(1).Value)
                    End If
                Next
                table.Add(rowContent.OrderBy(Function(c) c.ColumnName).ToList)
            End While
        End Using

        colNames.Sort()

        ' add the header row of the column names
        Dim sb As New StringBuilder(String.Join(",", colNames) & vbCrLf)

        ' output the data in csv format
        For Each r In table

            Dim col = 0
            Dim cellNo = 0

            While cellNo < r.Count AndAlso col < colNames.Count
                ' If this row has a cell with the appropriate column name then
                ' add the value to the output.
                If r(cellNo).ColumnName = colNames(col) Then
                    sb.Append(r(cellNo).Value)
                    cellNo += 1
                End If

                ' add a separator if is not the last item in the row
                If col < colNames.Count - 1 Then
                    sb.Append(","c)
                End If

                col += 1

            End While

            sb.AppendLine()

        Next

        File.WriteAllText(dest, sb.ToString)

    End Sub

End Module 
```

根据您的样本数据，输出是

```
1000,1200,1500,1600,3000,4000,5000,6000
xxx,xxx,,,xxxxxx,,,
xx,,xxxxxx,,,xx,,,
xxxx,,,xxx,xxx,,,, 
```

我注意到最后一列都没有数据。这只是复制粘贴错误还是故意的？

编辑：我使用**Option Infer On**，这就是缺少某些类型声明的原因。

# sql-server - 当日期字段为 1/1/1900 时显示空字符串

> ID：15554369
> 
> 赞同：14
> 
> 时间：2013-03-21T17:35:26.930
> 
> 标签：sql-server, datetime, case

我正在查询这样的数据库：

```
SELECT DISTINCT 
CASE WHEN CreatedDate = '1900-01-01 00:00:00.000' THEN '' ELSE CreatedDate END AS CreatedDate
FROM LitHoldDetails 
```

lhd.CreatedDate 是一个 DateTime 字段并且不可为空。如果字段是最小日期 (1/1/1900)，我想显示一个空字符串，但我的 CASE 语句不起作用；当该值在数据库中时，CreatedDate 在我的查询中显示 1900-01-01 00:00:00.000。我正在使用 SQL Server 2008 R2。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-21T17:39:43.343

当您使用`CASE`表达式（而不是*语句*）时，您必须注意数据类型的优先级。在这种情况下，您不能只将 a 设置`DATETIME`为空字符串。尝试一下：

```
SELECT CONVERT(DATETIME, ''); 
```

一种解决方法是将您的日期显示为字符串：

```
CASE WHEN CONVERT(DATE, CreatedDate) = '1900-01-01' -- to account for accidental time
  THEN ''
  ELSE CONVERT(CHAR(10), CreatedDate, 120)
    + ' ' + CONVERT(CHAR(8), CreatedDate, 108)
END 
```

或者，您可以在表示层摆弄它所属的表示材料。

这是一个完全按照您想要的方式工作的示例：

```
DECLARE @d TABLE(CreatedDate DATETIME);

INSERT @d SELECT '19000101' UNION ALL SELECT '20130321';

SELECT d = CASE WHEN CreatedDate = '19000101'
  THEN ''
  ELSE CONVERT(CHAR(10), CreatedDate, 120)
    + ' ' + CONVERT(CHAR(8), CreatedDate, 108)
END FROM @d; 
```

结果：

```
d
-------------------
                    <-- empty string
2013-03-21 00:00:00 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-20T05:53:06.797

```
select  ISNULL(CONVERT(VARCHAR(23), WorkingDate,121),'') from uv_Employee 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-27T10:37:55.673

试试这个代码

```
(case when CONVERT(VARCHAR(10), CreatedDate, 103) = '01/01/1900' then '' else CONVERT(VARCHAR(24), CreatedDate, 121) end) as Date_Resolved 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-09-25T10:34:39.187

如果您`CAST`将您的数据作为`VARCHAR()`而不是明确地使用`CONVERT`您的数据，您可以简单地

```
SELECT REPLACE(CAST(CreatedDate AS VARCHAR(20)),'Jan  1 1900 12:00AM','') 
```

将`CAST`自动返回您的日期，然后作为`Jun 18 2020 12:46PM`固定长度的字符串格式，您可以另外使用`SUBSTRING()`

```
SELECT SUBSTRING(REPLACE(CAST(CreatedDate  AS VARCHAR(20)),'Jan  1 1900 12:00AM',''),1,11) 
```

**输出**

```
Jun 18 2020 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-01T15:47:14.247

在查询中使用它，无需创建额外的变量。

```
CASE WHEN CreatedDate = '19000101' THEN '' WHEN CreatedDate =
'18000101' THEN ''  ELSE CONVERT(CHAR(10), CreatedDate, 120) + ' ' +
CONVERT(CHAR(8), CreatedDate, 108) END as 'Created Date' 
```

奇迹般有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-02T14:15:25.107

两个挑剔。(1) 最好不要将字符串文字用作列别名 - 已弃用。(2) 只需使用样式 120 即可获得相同的值。

```
 CASE 
      WHEN CreatedDate = '19000101' THEN '' 
      WHEN CreatedDate = '18000101' THEN '' 
      ELSE Convert(varchar(19), CreatedDate, 120)
    END AS [Created Date] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-06T17:37:58.357

涵盖最小 (1/1/1900) 和最大 (6/6/2079) 日期的替代解决方案：

```
ISNULL(NULLIF(NULLIF(CONVERT(VARCHAR(10), CreatedDate, 120), '1900-01-01'), '2079-06-06'), ''). 
```

无论您使用哪种解决方案，您都应该将您的日期（或日期时间）字段转换为特定格式，以便针对不同的默认服务器配置进行防弹。

请参阅 MSDN 上的 CAST 和 CONVERT：[https ://msdn.microsoft.com/en-us/library/ms187928.aspx](https://msdn.microsoft.com/en-us/library/ms187928.aspx)

# c - 语句在 for 循环中不起作用

> ID：15554371
> 
> 赞同：0
> 
> 时间：2013-03-21T17:35:37.823
> 
> 标签：c, if-statement, for-loop, while-loop, switch-statement

“我遇到的实际问题是它在给出问题数量后停止运行。我已将“%d%”更正为“%d”，但仍然存在该问题”

我目前正在做一个小型数学游戏的项目。我需要提示一个难度（简单、困难或退出）级别，然后是一个类别（加法、减法、乘法和除法。我的菜单正常工作，但我似乎无法得到以下任何内容

```
printf (" How many questions would you like to attempt?\n");
scanf ("%d%", &numofquestions); 
```

去工作。谁能告诉我我做错了什么？以下是我到目前为止的完整代码，那里有一些不必要的项目，但据我所知，它们不是问题。

```
/* Program Description Goes Here */
#include <stdio.h>
#include <stdlib.h>

 /* function main begins program execution */
int main( void )
{
    /* Main Code Area For Program */
int difficulty = -1;
int category = 0;
int numofquestions;
int ca = 0; /* Correct Answer */
int cc; /* Correcnt Counter */
int ran1;
int ran2;
int random1 = 0;
int random2 = 0;
int usera; 
int i;
/* Welcome mesage */
srand ( time (NULL));

printf ( "Welcome to the math challenge.\n"); 

while ( difficulty != 1 && difficulty != 2 && difficulty !=0){ 

    printf ("Select 1 for Easy\n");
    printf ("Select 2 for Hard\n");
    printf ("Select 0 to Quit\n");
    scanf ( "%d", &difficulty);
}

        while ( category != 1 && category != 2 && category != 3 && category != 4){

    category = getchar();
    switch (category){
        case 'A':
        case 'a':
            category = 1;
            break;
        case 'S':
        case 's':
            category = 2;
            break;
        case 'M':
        case 'm':
            category = 3;
            break;
        case 'D':
        case 'd':
            category = 4;
            break;
        case '/n':
        case '/t':
        case ' ':
            break;
        default:
            printf ("Enter A for Addition\n");
            printf ("Enter S for Subtraction\n");
            printf ("Enter M for Multiplication\n");
            printf ("Enter D for Division\n");
    }
}

        printf (" How many questions would you like to attempt?\n");
        scanf ("%d%", &numofquestions);

        for (i = numofquestions; i<=0; --i){/* start for */

            if ( difficulty == 1){ /* start if */
                random1 = (rand () % 10);
                random2 = (rand () % 10);

                }/* end if */ 

            if ( category == 1){/* start if */
                printf ( "%d + %d = ?" , random1 , random2 );
                ca = random1 + random2;
                printf ( "Your response\n");
                scanf ( "%d", &usera);
                                }/* end if */

            if ( usera == ca ){ /* start if */
                printf (" %d\n ", ca);
            }/* end if */

        /* end for */}

return 0; /* indicate that program ended successfully */
/* end function main */
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:40:54.733

那额外的 %d* *%* * 是故意的吗？

scanf ("%d%", &numofquestions);

for (i = numofquestions; i<=0; --i){/* start for */ 这应该是 for (i = numofquestions; i>=0; --i) 我想！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:38:49.977

删除重复项`%`：

```
scanf("%d%", &numofquestions); 
```

应该：

```
scanf("%d", &numofquestions); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-10T20:23:28.090

`getchar()`返回一个 int 和你的 switch 语句你的检查字符。[http://www.cplusplus.com/reference/cstdio/getchar/](http://www.cplusplus.com/reference/cstdio/getchar/)

`%d%`应该是`%d`。`for (i = numofquestions; i<=0; --i){`你得到一个int。这只会在数字为 0 或更少时运行，然后将**永远**运行。

# ldap - CCNetModifyingUsers CCNET 1.6 到 1.8 升级后的值变化

> ID：15554378
> 
> 赞同：1
> 
> 时间：2013-03-21T17:36:02.643
> 
> 标签：ldap, cruisecontrol.net, ccnet-config

在将我们的一台构建服务器升级到最新版本的 CCNET 后，它停止向修改组发送电子邮件。我们使用 Mercurial 进行源代码控制，并且版本 2.3.2 安装在构建服务器上。

buildmasters 组仍会收到电子邮件，但不会收到修饰符：

```
<email mailport="25" includeDetails="true" useSSL="false">
            <from>buildslave8@company.com</from>
            <mailhost>###.###.##.###</mailhost>
            <users>
                <user name="Name" group="buildmasters" address="name@company.com"/>
            </users>
            <groups>
                <group name="buildmasters">
                    <notifications>
                        <NotificationType>Always</NotificationType>
                    </notifications>
                </group>
            </groups>
            <converters>
                <regexConverter find="$" replace="@company.com" />
            </converters>
            <modifierNotificationTypes>
                <NotificationType>Always</NotificationType>
            </modifierNotificationTypes>
            <subjectSettings>
                <subject buildResult="Success" value="Build Status - SUCCESSFUL - ${CCNetProject} - ${CCNetLabel}" />
                <subject buildResult="Fixed" value="Build Status - HAS BEEN FIXED - ${CCNetProject} - ${CCNetLabel}" />
                <subject buildResult="StillBroken" value="Build Status - FAILED - ${CCNetProject}" />
                <subject buildResult="Broken" value="Build Status - FAILED - ${CCNetProject}" />
                <subject buildResult="Exception" value="Build Status - SERVER EXCEPTION - ${CCNetProject} - a serious error has occurred" />
            </subjectSettings>
            <attachments></attachments> 
```

在挖掘构建日志后，我注意到`<user>`下面的值`<CCNetModifyingUsers>`发生了如下变化：

从（CCNET 1.6）：

```
<integrationProperties>
    ...
    <CCNetModifyingUsers>
       <user>flast</user>
       <user>flast</user>
    </CCNetModifyingUsers>
    ...
</integrationProperties> 
```

至（CCNET 1.8）：

```
<integrationProperties>
    ...
    <CCNetModifyingUsers>
      <user>First Last</user>
      <user>First Last</user>
    </CCNetModifyingUsers>
    ...
</integrationProperties> 
```

不确定如何填充`<user>`下面的值`<CCNetModifyingUsers>`或如何修复它。

更新＃1：我正在尝试查看更改`<converter>`为 ldapConverter 是否可以解决我的问题。

更新＃2：仍在尝试弄乱ldapConverter：

```
<ldapConverter domainName="Name.corp" ldapLogOnUser="name" ldapLogOnPassword="pswd" /> 
```

此版本抛出异常：

> EmailPublisher 异常：System.FormatException：指定的字符串不是电子邮件地址所需的格式。在 System.Net.Mime.MailBnfHelper.ReadMailAddress(String data, Int32& offset, String& displayName) at System.Net.Mail.MailAddressCollection.ParseValue(String addresses) at ThoughtWorks.CruiseControl.Core.Publishers.EmailPublisher.GetMailMessage(String from,在 ThoughtWorks.CruiseControl.Core.Publishers.EmailPublisher.SendMessage(String from, String to, String replyto, String subject, String message, String workingFolder) )

虽然这样：

```
<ldapConverter domainName="Name.corp" ldapLogOnUser="name" ldapLogOnPassword="pswd" ldapQueryField="userPrincipalName"/> 
```

成功构建，但不向修改器发送电子邮件。

更新#3：

我已经实施了以下临时修复：

```
<converters>
   <regexConverter find="(?!^.?).(?!.{0}$).* " replace="" />
   <regexConverter find="$" replace="@company.com" />
</converters> 
```

但是，它不包括以下情况：

*   人们的 Mercurial`username`与他们的电子邮件地址名称不匹配
*   有双重（三重？）名字或姓氏的人

更新#4：

将不得不通过源代码来查看我是否可以准确地追踪导致问题的原因......可能必须保持它的本地构建。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-06T17:15:33.603

我在 2013 年 11 月处理了这个问题。我必须安装 CCNET 源代码并修改 EmailLDAPConverter.cs。Convert 方法使用 SSAMAccountName Active Directory 属性创建搜索过滤器。这将失败。我最终过滤了 Active Directory 的“displayName”属性。

# winapi - 带有旧 winbase.h 文件的 MingW

> ID：15554380
> 
> 赞同：2
> 
> 时间：2013-03-21T17:36:13.113
> 
> 标签：winapi, mingw

我想在我的 Qt 4.8.1 应用程序中使用 winbase.h 中的函数 QueryFullProcessImageName ，该应用程序使用最新的 MingW 版本（我最近下载了它）。问题是这个功能是相当新的：它是在 Windows Vista 中引入的，我猜想它会在这样一个新版本的 MingW 中可用，但事实并非如此。Microsoft MSDN 很遗憾，我需要放置适当的定义才能使该函数可用，但这不仅没有解决我的问题，而且无论如何我也无法通过 Ctrl+F 在 winbase.h 中找到该函数的声明。

好吧，我该如何解决这个问题？我非常需要那个功能：X

对我的问题的另一个见解：[http ://www.qtcentre.org/threads/53769-Mingw-included-in-Qt-installator-including-old-h-files](http://www.qtcentre.org/threads/53769-Mingw-included-in-Qt-installator-including-old-h-files)

还有一件非常有趣的事情： http: [//sourceforge.net/apps/trac/mingw-w64/browser/trunk/mingw-w64-headers/include/winbase.h](http://sourceforge.net/apps/trac/mingw-w64/browser/trunk/mingw-w64-headers/include/winbase.h?rev=5487) ?rev=5487（看起来MingW确实有最新的 winbase.h 文件，虽然它没有随安装程序提供）

我的电脑有一个 64 位的 Windows 7，而我的 Qt 和 Qt Creator 是 32 位的。

谢谢，

莫默吉尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T07:56:19.213

如果您不想（或不能）移动到`QyeryFullProcessImageName()`其 SDK 标头中包含的 MinGW 版本，则可以在末尾附近添加以下内容`winbase.h`（确保它位于`extern "C"`块的右大括号之前）：

```
#if (_WIN32_WINNT >= 0x0600)

#define PROCESS_NAME_NATIVE 0x00000001

WINBASEAPI BOOL WINAPI QueryFullProcessImageNameA(
  HANDLE hProcess,
  DWORD dwFlags,
  LPSTR lpExeName,
  PDWORD lpdwSize
);

WINBASEAPI BOOL WINAPI QueryFullProcessImageNameW(
  HANDLE hProcess,
  DWORD dwFlags,
  LPWSTR lpExeName,
  PDWORD lpdwSize
);

#ifdef UNICODE
#define QueryFullProcessImageName QueryFullProcessImageNameW
#else
#define QueryFullProcessImageName QueryFullProcessImageNameA
#endif

#endif 
```

如果 API 在 libkernel32.a 导入库中，那应该是您所需要的。该 API 在我安装的 MinGW 4.7.x 版本的库中，它不在`winbase.h`标头中，所以很有可能您只需要上面的几行代码。

# ravendb - 在 RavenDb 中使用私有支持字段反序列化 IEnumerable

> ID：15554385
> 
> 赞同：4
> 
> 时间：2013-03-21T17:36:22.867
> 
> 标签：ravendb

我已经对域建模了几天，根本没有考虑持久性，而是专注于域逻辑。现在我准备好持久化我的域对象，其中一些包含 IEnumerable 的子实体。使用 RavenDb，持久性很容易，但是当再次加载我的对象时，所有的 IEnumerables 都是空的。

我意识到这是因为他们根本没有任何属性设置器，而是使用列表作为支持字段。域聚合根的用户可以通过公共方法而不是直接在集合上添加子实体。

```
private readonly List<VeryImportantPart> _veryImportantParts;
public IEnumerable<VeryImportantPart> VeryImportantParts { get { return _veryImportantParts; } } 
```

还有添加的方法，没什么花哨的……

```
public void AddVeryImportantPart(VeryImportantPart part)
{
    // some logic...
    _veryImportantParts.Add(part);
} 
```

我可以通过在我的所有带有支持字段的 IEnumerables 上添加一个私有/受保护的设置器来解决这个问题，但它看起来......嗯......不是超级性感。

```
private List<VeryImportantPart> _veryImportantParts;
public IEnumerable<VeryImportantPart> VeryImportantParts
{
    get { return _veryImportantParts; }
    protected set { _veryImportantParts = value.ToList(); }
} 
```

现在 RavenDb json 序列化程序将在加载时再次填充我的对象，但我很好奇是否没有更清洁的方法来执行此操作？

我一直在摆弄*JsonContractResolver*但还没有找到解决方案......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:06:14.437

我想我已经找到了这个问题的根本原因，这可能是因为我的许多实体都是使用以下方法创建的：

```
protected MyClass(Guid id, string name, string description) : this()
{ .... }

public static MyClass Create(string name, string description)
{
    return new MyClass(Guid.NewGuid(), name, description);
} 
```

反序列化时，RavenDb/Json.net 无法以适当的方式重建我的实体......

更改为使用公共构造函数会产生很大的不同。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-21T18:31:22.307

您*需要*保留一个私有的后备字段吗？通常一个自动属性就可以了。

```
public IList<VeryImportantPart> VeryImportantParts { get; protected set; } 
```

这样做时，您可能希望在构造函数中初始化列表：

```
VeryImportantParts = new List<VeryImportantPart>(); 
```

当然，这是可选的，但它允许您在持久化之前创建一个新类并立即开始添加到列表中。当 Raven 反序列化一个类时，它将使用 setter 覆盖默认的空白列表，所以这对第一次存储有帮助。

您当然不能使用`readonly`字段，因为在反序列化期间无法替换它。编写一个合同解析器或转换器来填充现有列表而不是创建一个新列表是*可能*的，但这似乎是一个相当复杂的解决方案。

无论如何，使用自动属性可以使您的代码更加清晰 - 因为使用字段或属性更容易混淆。

# java - Scanner.findInLine() 大量泄漏内存

> ID：15554392
> 
> 赞同：5
> 
> 时间：2013-03-21T17:36:46.077
> 
> 标签：java, memory-leaks, java.util.scanner

我正在运行一个简单的扫描程序来解析一个字符串，但是我发现如果经常调用我会得到 OutOfMemory 错误。这段代码被称为为字符串数组重复构建的对象的构造函数的一部分：

编辑：这是更多信息的构造函数；关于扫描仪的尝试捕获之外没有更多的事情发生

```
 public Header(String headerText) {
        char[] charArr;
        charArr = headerText.toCharArray();
        // Check that all characters are printable characters
        if (charArr.length > 0 && !commonMethods.isPrint(charArr)) {
            throw new IllegalArgumentException(headerText);
        }
        // Check for header suffix
        Scanner sc = new Scanner(headerText);
        MatchResult res;
        try {
            sc.findInLine("(\\D*[a-zA-Z]+)(\\d*)(\\D*)");
            res = sc.match();
        } finally {
            sc.close();
        }

        if (res.group(1) == null || res.group(1).isEmpty()) {
            throw new IllegalArgumentException("Missing header keyword found");     // Empty header to store
        } else {
            mnemonic = res.group(1).toLowerCase();                            // Store header
        }
        if (res.group(2) == null || res.group(2).isEmpty()) {
            suffix = -1;
        } else {
            try {
                suffix = Integer.parseInt(res.group(2));       // Store suffix if it exists
            }  catch (NumberFormatException e) {
                throw new NumberFormatException(headerText);
            }
        }
        if (res.group(3) == null || res.group(3).isEmpty()) {
            isQuery= false;
        } else {
            if (res.group(3).equals("?")) {
                isQuery = true;
            } else {
                throw new IllegalArgumentException(headerText);
            }
        }

        // If command was of the form *ABC, reject suffixes and prefixes
        if (mnemonic.contains("*") 
                && suffix != -1) {
            throw new IllegalArgumentException(headerText);
        }
    } 
```

分析器内存快照显示了 Scanner.findInLine() 的 read(Char) 方法在操作期间分配大量内存，因为我扫描了几十万个字符串；几秒钟后，它已经分配了超过 38MB。

![在此处输入图像描述](../Images/cc15f9952e57e98fc9051672fcf0d244.png)

我认为在构造函数中使用它之后在扫描仪上调用 close() 会将旧对象标记为由 GC 清除，但不知何故它仍然存在，并且 read 方法在填充堆之前累积了千兆字节的数据。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:54:13.480

您尚未发布所有代码，但鉴于您正在反复扫描相同的正则表达式，`Pattern`预先编译静态并将其用于扫描仪的查找会更有效：

```
static Pattern p = Pattern.compile("(\\D*[a-zA-Z]+)(\\d*)(\\D*)"); 
```

在构造函数中：

```
sc.findInLine(p); 
```

这可能是也可能不是 OOM 问题的根源，但它肯定会让您的解析速度更快一些。

相关：[java.util.regex - Pattern.compile() 的重要性？](https://stackoverflow.com/questions/1720191/java-util-regex-importance-of-pattern-compile)

**更新**：在您发布更多代码后，我看到了一些其他问题。如果您重复调用此构造函数，则意味着您可能事先对输入进行了标记或分解。为什么要创建一个新`Scanner`的来解析每一行？它们是昂贵的; 如果可能的话，您应该使用相同`Scanner`的方法来解析整个文件。使用`Scanner`预编译`Pattern`的将比您现在所做的要快得多，即为您正在解析的每一行创建一个新的`Scanner`和一个新的。`Pattern`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:02:23.573

填满你记忆的字符串是在`findInLine()`. 因此，重复`Pattern`创建不是问题。

在不知道其余代码的作用的情况下，我的猜测是您从匹配器中获得的一组组被保存在对象的字段中。然后，该字符串将被*分配*到 中`findInLine()`，正如您在此处看到的那样，但它被保留的事实将是由于您的代码。

**编辑：**

这是你的问题：

```
mnemonic = res.group(1).toLowerCase(); 
```

您可能没有意识到，如果字符串中没有大写字母，则`toLowerCase()`返回。`this`此外，`group(int)`返回 a `substring()`，它创建一个与完整字符串相同的新`char[]`字符串。所以，`mnemonic`实际上包含`char[]`整行的。

解决方法是：

```
mnemonic = new String(res.group(1).toLowerCase()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:44:59.983

我认为您的代码段不完整。我相信你`scanner.findInLine()`在循环调用。不管怎样，试着打电话`scanner.reset()`。我希望这能解决你的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:45:23.757

JVM 显然没有时间进行垃圾收集。可能是因为它重复使用相同的代码（构造函数）来创建同一类的多个实例。在运行时堆栈发生变化之前，JVM 可能不会对 GC 做任何事情——在这种情况下，这不会发生。过去我被警告过在构造函数中做“太多”，因为当调用其他方法时，一些内存管理行为并不完全相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T17:55:19.937

您的问题是您正在扫描几十万个字符串，并且您将模式作为字符串传递，因此您对于循环的每次迭代都有一个新的模式对象。您可以将模式拉出循环，如下所示：

```
 Pattern toMatch = Pattern.compile("(\\D*[a-zA-Z]+)(\\d*)(\\D*)")

    Scanner sc = new Scanner(headerText);
    MatchResult res;

    try {
        sc.findInLine(toMatch);
        res = sc.match();
    } finally {
        sc.close();
    } 
```

然后，您将只传递对象引用，`toMatch`而不是为每次匹配尝试创建一个新模式对象的开销。这将修复您的泄漏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-22T17:40:49.680

好吧，我找到了问题的根源，它不完全是 Scanner，而是包含在构造函数中进行扫描的对象的列表。

问题与保存对包含解析的对象的引用的列表溢出有关，基本上每单位时间收到的字符串多于可以处理的字符串，并且列表不断增长，直到没有更多的 RAM。现在将此列表限制为最大大小可以防止解析器使内存过载；我将在解析器和数据源之间添加一些同步，以避免将来出现这种溢出。

谢谢大家的建议，我已经对扫描仪的性能进行了一些更改，并感谢@RobI 将我指向 jvisualvm，这使我能够追溯到持有参考文献的确切罪魁祸首。内存转储未显示参考链接。

# css - 在 1 行中将 css 应用于我的桌子的头部和身体

> ID：15554394
> 
> 赞同：0
> 
> 时间：2013-03-21T17:36:59.650
> 
> 标签：css, css-selectors

使用以下 css，我定义了表头的第一列

```
table.search-transport tr th:nth-child(1) { width: 30px; text-align:right; } 
```

我想不仅将这个 css 应用在头部，而且还应用在桌子的主体上。

我知道我们可以分两行进行：

```
table.search-transport tr th:nth-child(1),
table.search-transport tr td:nth-child(1)
                  { width: 30px; text-align:right; } 
```

但我想知道我们是否可以在 1 标志线中进行？就像是：

```
table.search-transport tr th:nth-child(1) + td:nth-child(1) { width: 30px; text-align:right; } 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:39:03.673

只要它是第一列中的任何单元格？您应该能够完全省略`th`/`td`部分，以及使用子选择器，因为 a`tr`只能有 a`th`或 a`td`作为子元素（并且您要确保只选择它的子元素而不选择任何内部元素） ：

```
table.search-transport tr > :nth-child(1) { width: 30px; text-align: right; } 
```

（如果您想支持旧版浏览器，请替换`:nth-child(1)`为`:first-child`.）

但是，一般来说，您不能同时选择两者`th:nth-child(1)`并`td:nth-child(1)`单独选择，同时避免重复选择器的其余部分。这已经在网站的其他地方被覆盖到死，但请参阅[此处](https://stackoverflow.com/questions/800779/why-cant-you-group-descendants-in-a-css-selector/11786102#11786102)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:40:38.103

您当前使用的 CSS 选择器在性能方面很差。

以下行回答您的问题。

```
.search-transport tr > :nth-child(1) { width: 30px; text-align: right; } 
```

检查小提琴以查看操作中的选择器[http://jsfiddle.net/LNJLf/](http://jsfiddle.net/LNJLf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:47:48.137

我猜你正在寻找`:any`伪类。请参阅[https://developer.mozilla.org/en-US/docs/CSS/:any](https://developer.mozilla.org/en-US/docs/CSS/:any)。

```
table.search-transport tr :any(th,td):nth-child(1) { width: 30px; text-align:right; } 
```

注意：您需要为此添加供应商前缀。未经测试。

# input - 在文本框中写反向

> ID：15554397
> 
> 赞同：1
> 
> 时间：2013-03-21T17:37:04.070
> 
> 标签：input

我想像乌尔都语一样以相反的顺序在文本框中输入。是否有任何输入
属性或任何代码？方向：rtl；仅从结尾开始，但输入文本在原处。它不会
在文本框中反向查找。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T17:38:45.177

只需使用简单的 CSS

```
input[type=text] {
   text-align: right;
} 
```

[**演示**](http://jsfiddle.net/AJBmv/)

更新：

```
input[type=text] {
    direction: rtl;
    unicode-bidi: bidi-override;
} 
```

# r - 绘制直方图或任何其他图形解释的最佳方法

> ID：15554399
> 
> 赞同：0
> 
> 时间：2013-03-21T17:37:22.427
> 
> 标签：r, histogram

我有带有以下数据集的 csv 文件：

```
gv,ca,level1,2
gv,bg,level1,1
zea,li,level1,1
zea,li,level3,1
zea,de,level1,26
zea,de,level3,5
zea,el,level1,1
zea,eo,level1,3
zea,en,level1,5
zea,en,level2,34
zea,en,level3,38
zea,en,level4,12
zea,es,level1,7
zea,la,level1,7
zea,zea,level1,5
zea,zea,level3,4
zea,stq,level1,1
zea,sk,level2,1
zea,nl,level4,4
zea,fr,level2,9
zea,fy,level2,1
cdo,cdo,level3,1
cdo,de,level1,23
cdo,de,level2,4
cdo,de,level3,4
cdo,eo,level1,1
cdo,eo,level2,1
cdo,eo,level3,3
cdo,en,level1,6
cdo,en,level2,31
cdo,en,level3,38
cdo,en,level4,17
cdo,es,level1,8
cdo,es,level2,6
cdo,es,level3,3
cdo,fr,level1,14 
```

我想建立一个直方图，但有些需要如何将第二列合并到直方图中，您读取数据的方式是示例：在 gv 中，我们有两个具有 ca 经验级别 1 的用户，同样在 gv 中，我们有 1 个具有 bg 的用户经验1级。

我知道如何在 R 中构建直方图，但我正在尝试在脑海中围绕这个想法说唱，并试图弄清楚如何将其转化为图形表示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:53:37.713

就像@Ben 说的那样，很难看出你在这里得到了什么。您可能需要重新格式化数据，以便每个表只有一种类型的数据（类）。

# c# - RichTextBox 字体设置为 C# 中的所有行

> ID：15554401
> 
> 赞同：1
> 
> 时间：2013-03-21T17:37:35.000
> 
> 标签：c#, winforms, fonts, richtextbox

我更改了[RichTextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.aspx)的字体，但此更改并未正确设置为其所有字符。RichTextBox 确实存在两种字体，这并不美观。有没有解决这个问题的方法！？

此代码无法正常工作：

```
this.richTextBox1.Font = new System.Drawing.Font("Maiandra GD", 12); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:48:51.433

将选择设置为整个框并设置 SelectionFont。

```
this.richTextBox1.SelectionStart = 0;
this.richTextBox1.SelectionLength = this.richTextBox1.SelectionLength;
this.richTextBox1.SelectionFont = new System.Drawing.Font("Maiandra GD", 12); 
```

# javascript - 克隆 JSON 未按预期工作

> ID：15554402
> 
> 赞同：1
> 
> 时间：2013-03-21T17:37:37.633
> 
> 标签：javascript, json

我有一个 JSON 文字如下：

```
var json_1 = {
    "name": "Tim",
    "toys": ["ball", "bat", "lego"]
}; 
```

现在我克隆它如下：

```
var json_2 = json_1; 
```

`json_1`如果我从（使用）中删除一个玩具，`splice()`似乎也从`json_2`. 如何在不相互依赖的情况下创建副本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T17:40:46.307

当你这样做时：

```
var json_2 = json_1 
```

实际上，您并没有“克隆”对象，而只是将其别名化。所以对 json_1 的所有操作都会镜像到 json_2 上，反之亦然。要真正克隆您的对象，请查看：[https ://stackoverflow.com/a/728694/2003420](https://stackoverflow.com/a/728694/2003420)

# php - PHP readdir、glob 和 exec('ls') 以空数组返回 Apache 下的某些目录

> ID：15554405
> 
> 赞同：0
> 
> 时间：2013-03-21T17:37:41.473
> 
> 标签：php, apache, glob, ls, readdir

我开发了以下 PHP 代码以读取名为的特定目录`/dados/capture`：

`tst2.php`

```
<html>
<body>
<?php
echo "whoami: " . shell_exec('whoami')."<br>\n";
exec('ls /dados/capture/',$base);
echo "/dados/capture content ...<br>\n";
foreach ( $base as $dir )
{
    print $dir ."<br>\n";
}
?> 
```

通过linux命令行“[root$mysite]# sudo -u apache php tst2.php”执行代码返回如下：

```
<html>
<body>
whoami: apache
<br>
/dados/capture content ...<br>
120130312115149.jpg<br>
120130312115149.swf<br>
120130312115658.jpg<br>
120130312115658.swf<br>
</body>
</html> 
```

从 Web 浏览器调用`tst2.php`会导致：

```
whoami: apache 
/dados/capture content ... 
```

`<directory><directory>`我已尝试更改文件夹的权限并在中创建指令`httpd.conf`，但结果没有任何更改。

我已经用不同的目录测试了代码，这令人惊讶，因为它也不适用于`/boot`,`/mnt`和`/opt`目录。

使用`glob`或`readdir`结果相同，但消耗更多的处理器。

我正在使用 CentOs 2.6.32-279.22.1.el6.i686、Apache/2.2.15 和 PHP 5.4.12。

有人有类似的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:56:16.050

试试
$out = shell_exec('ls /dir/path 2>&1'); 正在浏览网页的用户可能没有权限。因此，您**可能会收到**此错误。

# java - 如何在创建之前销毁 servlet？

> ID：15554406
> 
> 赞同：4
> 
> 时间：2013-03-21T17:37:43.907
> 
> 标签：java, servlets

我在面试中被问到一个问题，你将如何阻止 Servlet 实例化 servlet 对象？
我说容器决定销毁 servlet 对象。

他又说容器会先创建servlet对象，然后再销毁它。我的问题是尚未创建 servlet 对象，因此销毁它没有意义。当一个 servlet 类试图实例化自己陷入严重问题并且我们的代码（或任何其他方式）应该阻止它实例化时，您将如何编写它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:48:28.350

我猜他期待你`javax.servlet.UnavailableException`从`init()`

> public class UnavailableException extends ServletException 此异常表示 servlet 不可用。Servlet 可能随时报告此异常，并且运行 Servlet 的网络服务应该正常运行。有两种类型的不可用性，复杂的服务将以不同的方式处理这些问题：
> 
> 永久不可用。在采取一些管理措施来纠正 servlet 问题之前，servlet 将无法处理客户端请求。例如，servlet 可能配置错误，或者 servlet 的状态可能已损坏。编写良好的 servlet 将记录错误和管理员必须执行的纠正操作以使 servlet 可用。
> 
> 暂时不可用。由于系统范围的问题，servlet 目前无法处理请求。例如，第三层服务器可能无法访问，或者可能没有足够的内存或磁盘存储来处理请求。问题可能是自我纠正的，例如由于负载过大而导致的问题，或者可能需要管理员采取纠正措施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:49:10.440

您可以通过三种方式阻止容器创建 Servlet 实例：

1.  删除 web.xml 中对 Servlet 的引用。如果你的容器正在处理注解，那么`@WebServlet`注解也需要被移除。

2.  在构造函数中，抛出异常。

3.  在 init() 方法中，抛出异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:49:43.580

没错，容器负责 servlet 创建和生命周期。它首先使用默认的公共构造函数创建 servlet 实例，然后调用其`init()`方法。当容器想要销毁 servlet 时，它会调用其`destroy()`通常（恕我直言）为空的方法。

容器在部署可能是您的应用程序的新版本时，可以在热重新部署期间首先销毁然后创建新的 servlet。这可能是你的面试官想从你那里听到的。

# c# - 强类型 HTML 视图中的三元运算符

> ID：15554411
> 
> 赞同：0
> 
> 时间：2013-03-21T17:37:59.173
> 
> 标签：c#, html, asp.net-mvc, strongly-typed-view

我在数据库中有一个位字段，我想在我的 HTML 视图中显示为“是”或“否”如何使用三元（？：）运算符来执行此操作？

这是我所拥有的，但它对所有记录都显示“否”。

```
<%= Html.Encode( Convert.ToString(item.IsValid) == "True" ? "Yes" : "No")%> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:45:33.660

有两种方法可以解决此问题。

1）似乎 IsValid 已经是一个布尔值，只需取值

```
<%= item.IsValid ? "Yes" : "No"%> 
```

2) 如果您坚持转换它，请使用 Equals 将其与 StringComparison.InvariantCultureIgnoreCase 标志进行比较

```
<%= Convert.ToString(item.IsValid).Equals("True", StringComparison.InvariantCultureIgnoreCase) ? "Yes" : "No"%> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T17:42:28.677

甚至更简单 -

```
<%= Html.Encode(item.IsValid ? "Yes" : "No") %> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T17:42:51.983

通常你可以在下面使用：

```
<%: item.IsValid ? "Yes" : "No" %> 
```

这将解决您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T17:39:58.993

你为什么要转换成字符串？这应该只是假设`IsValid`是一个布尔值：

```
<%= Html.Encode(item.IsValid) == true ? "Yes" : "No")%> 
```

如果它是一个字符串，你会想要这样的东西：

```
<%= Html.Encode(item.IsValid.ToLower() == "true" ? "Yes" : "No")%> 
```

# php - 使用 PHP 的 GD 库进行乘法过滤

> ID：15554414
> 
> 赞同：5
> 
> 时间：2013-03-21T17:38:16.340
> 
> 标签：php, filter, gd, photoshop

我尝试使用 GD 库来模拟 Photoshop 的多重效果，但我还没有找到可行的解决方案。

根据[Wikipedia](http://en.wikipedia.org/wiki/Blend_modes#Multiply)，乘法混合模式：

> [...] 将顶层的每个像素的数字与底层的相应像素相乘。结果是一张更暗的照片。

有谁知道使用 PHP 实现这一目标的方法？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-01T17:55:01.517

您需要获取图像的每个像素，然后将每个 RGB 值乘以背景颜色 / 255（这是 Photoshop 公式）。例如，带有红色背景颜色乘法滤镜的 JPG 文件，保存为 PNG 文件以获得更好的效果：

```
<?php 
$filter_r=216;
$filter_g=0;
$filter_b=26;
$suffixe="_red";
$path=YOURPATHFILE;

if(is_file($path)){
    $image=@imagecreatefromjpeg($path);
    $new_path=substr($path,0,strlen($path)-4).$suffixe.".png";

    $imagex = imagesx($image);
    $imagey = imagesy($image);
    for ($x = 0; $x <$imagex; ++$x) {
        for ($y = 0; $y <$imagey; ++$y) {
            $rgb = imagecolorat($image, $x, $y);
            $TabColors=imagecolorsforindex ( $image , $rgb );
            $color_r=floor($TabColors['red']*$filter_r/255);
            $color_g=floor($TabColors['green']*$filter_g/255);
            $color_b=floor($TabColors['blue']*$filter_b/255);
            $newcol = imagecolorallocate($image, $color_r,$color_g,$color_b);
            imagesetpixel($image, $x, $y, $newcol);
        }
    }

    imagepng($image,$new_path);
}
?> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-29T05:12:11.553

我也一直在寻找两个图像之间的乘法混合，但找不到任何原生 php 解决方案。看来（目前）唯一的方法是“手动”设置像素，逐个像素。这是我的代码，它在两个图像之间进行乘法混合，假设图像大小相同。如果您愿意，您可以调整它以处理不同的尺寸。

```
function multiplyImage($dst,$src)
{
    $ow = imagesx($dst);
    $oh = imagesy($dst);

    $inv255 = 1.0/255.0;

    $c = imagecreatetruecolor($ow,$oh);
    for ($x = 0; $x <$ow; ++$x) 
    {
        for ($y = 0; $y <$oh; ++$y) 
        {
            $rgb_src = imagecolorsforindex($src,imagecolorat($src, $x, $y));
            $rgb_dst = imagecolorsforindex($dst,imagecolorat($dst, $x, $y));
            $r = $rgb_src['red'] * $rgb_dst['red']*$inv255;
            $g = $rgb_src['green'] * $rgb_dst['green']*$inv255;
            $b = $rgb_src['blue'] * $rgb_dst['blue']*$inv255;
            $rgb = imagecolorallocate($c,$r,$g,$b);
            imagesetpixel($c, $x, $y, $rgb);
        }
    }
    return $c;
} 
```

函数返回图像对象，因此您应该确保在使用完之后执行 imagedestroy。

应该有一个使用overlay native-php blend 的解决方法，这表明目标图像的50% 灰度像素将受到源像素的影响。理论上，如果您确实需要混合两张黑白图像（没有灰色调），如果您设置目标图像的对比度，那么白色将变为 50% 灰色，然后在其上叠加混合源图像，应该给出你的东西类似于乘法。但是对于彩色图像或灰度图像，这是行不通的——上面的方法似乎是唯一的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-26T12:11:57.137

当我需要在 GD 中混合两个图像时，我被引入了这个线程。似乎没有专门的代码，所以我将把它留在这里，供以后访问此页面的访问者使用。

`colivier`这是支持两个图像的多重混合的答案的一个分支。

这两个图像不需要具有相同的大小，但覆盖的图像将被调整大小并裁剪为底层的大小。我做了一个`fit`辅助函数来做到这一点，但不要为此烦恼。

`imagecolorat`返回基色，即使是具有透明度的 PNG。也就是说，50% 的黑色（可见为 (128, 128, 128)）将返回为 (0, 0, 0, 64) 64 作为 alpha 值。此代码考虑了半透明并将半透明颜色转换为可见颜色值。

```
// bottom layer
$img1 = imagecreatefromjpeg(realpath(__DIR__.'/profilePic.jpg'));

// top layer
$img2 = imagecreatefrompng(realpath(__DIR__.'/border2.png'));
imagealphablending($img2, false);
imagesavealpha($img2, true);

$imagex = imagesx($img1);
$imagey = imagesy($img1);

$imagex2 = imagesx($img2);
$imagey2 = imagesy($img2);

// Prereq: Resize img2 to match img1, cropping beyond the aspect ratio
$w1 = max(min($imagex2, $imagex), $imagex);
$h1 = max(min($imagey2, $imagey), $imagey);

$w_using_h1 = round($h1 * $imagex2 / $imagey2);
$h_using_w1 = round($w1 * $imagey2 / $imagex2);

if ($w_using_h1 > $imagex) {
    fit($img2, $imagex, $imagey, 'HEIGHT', true);
}
fit($img2, $imagex, $imagey, 'WIDTH', true);

// Actual multiply filter
for ($x = 0; $x < $imagex; ++$x) {
    for ($y = 0; $y < $imagey; ++$y) {
        $rgb1 = imagecolorat($img1, $x, $y);
        $rgb2 = imagecolorat($img2, $x, $y);
        $idx1 = imagecolorsforindex($img1, $rgb1);
        $idx2 = imagecolorsforindex($img2, $rgb2);

        // Shift left 8, then shift right 7
        // same as multiply by 256 then divide by 128
        // approximate multiply by 255 then divide by 127
        // This is basically multiply by 2 but, expanded to show that
        // we are adding a fraction of white to the translucent image
        // $adder = ($idx2['alpha'] << 8 >> 7);
        $adder = ($idx2['alpha'] << 1);
        $rmul = min(255, $idx2['red']   + $adder);
        $gmul = min(255, $idx2['green'] + $adder);
        $bmul = min(255, $idx2['blue']  + $adder);

        $color_r = floor($idx1['red'] * $rmul / 255);
        $color_g = floor($idx1['green'] * $gmul / 255);
        $color_b = floor($idx1['blue'] * $bmul / 255);

        $newcol = imagecolorallocatealpha($img1, $color_r, $color_g, $color_b, 0);
        imagesetpixel($img1, $x, $y, $newcol);
    }
}
imagejpeg($img1, __DIR__.'/out.jpg');

/**
 * Fits an image to a $w x $h canvas
 * 
 * @param type $w Target width
 * @param type $h Target height
 * @param int $fit_which Which dimension to fit
 * @param bool $upscale If set to true, will scale a smaller image to fit the given dimensions
 * @param bool $padded If set to true, will add padding to achieve given dimensions
 * 
 * @return Image object
 */
function fit(&$img, $w, $h, $fit_which = 'BOTH', $upscale = false, $padded = true) {

    if (!in_array($fit_which, array('WIDTH', 'HEIGHT', 'BOTH'))) {
        $fit_which = 'BOTH';
    }
    $w0 = imagesx($img);
    $h0 = imagesy($img);

    if (!$upscale && $w0 <= $w && $h0 <= $h)
        return $this;

    if ($padded) {
        $w1 = max(min($w0, $w), $w);
        $h1 = max(min($h0, $h), $h);
    }
    else {
        $w1 = min($w0, $w);
        $h1 = min($h0, $h);
    }
    $w_using_h1 = round($h1 * $w0 / $h0);
    $h_using_w1 = round($w1 * $h0 / $w0);

    // Assume width, crop height
    if ($fit_which == 'WIDTH') {
        $w2 = $w1;
        $h2 = $h_using_w1;
    }
    // Assume height, crop width
    elseif ($fit_which == 'HEIGHT') {
        $w2 = $w_using_h1;
        $h2 = $h1;
    }
    elseif ($fit_which == 'BOTH') {
        if (!$padded) {
            $w2 = $w = min($w, $w_using_h1);
            $h2 = $h = min($h, $h_using_w1);
        }
        else {
            // Extend vertically
            if ($h_using_w1 <= $h) {
                $w2 = $w1;
                $h2 = $h_using_w1;
            }
            // Extend horizontally
            else {
                $w2 = $w_using_h1;
                $h2 = $h1;
            }
        }
    }

    $im2 = imagecreatetruecolor($w, $h);
    imagealphablending($im2, true);
    imagesavealpha($im2, true);

    $transparent = imagecolorallocatealpha($im2, 255, 255, 255, 127);
    imagefill($im2, 0, 0, $transparent);

    imagealphablending($img, true);
    imagesavealpha($img, true);
    // imagefill($im, 0, 0, $transparent);

    imagecopyresampled($im2, $img, ($w - $w2) / 2, ($h - $h2) / 2, 0, 0, $w2, $h2, $w0, $h0);

    $img = $im2;    
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:44:07.543

您是否尝试过使用[php 手册](http://php.net/manual/en/function.imagefilter.php)？

> 对于希望在 Photoshop 中的图像（通常是黑白图像）等图像上应用“倍增”效果的人，您可以使用 IMG_FILTER_COLORIZE 过滤器来实现它。

```
<?php
function multiplyColor(&$im, $color = array(255, 0, 0)) {
   //get opposite color
   $opposite = array(255 - $color[0], 255 - $color[1], 255 - $color[2]);

   //now we subtract the opposite color from the image
   imagefilter($im, IMG_FILTER_COLORIZE, -$opposite[0], -$opposite[1], -$opposite[2]);
}
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-12T16:06:31.303

我更新了@colivier 脚本，以便能够对两个图像进行 myltiply，而不仅仅是具有颜色的图像：

```
/**
 * Multiply $pathToDst and $pathToSrc to $resultPath
 *
 * @param string $pathToDst
 * @param string $pathToSrc
 * @param string $resultPath
 */
function multiply($pathToDst, $pathToSrc, $resultPath) {
    switch (pathinfo($pathToDst, PATHINFO_EXTENSION)) {
        case "gif" :
            $resourceDst = imagecreatefromgif($pathToDst);
            break;
        case "png" :
            $resourceDst = imagecreatefrompng($pathToDst);
            break;
        default :
            $resourceDst = imagecreatefromjpeg($pathToDst);
            break;
    }

    switch (pathinfo($pathToSrc, PATHINFO_EXTENSION)) {
        case "gif" :
            $resourceSrc = imagecreatefromgif($pathToSrc);
            break;
        case "png" :
            $resourceSrc = imagecreatefrompng($pathToSrc);
            break;
        default :
            $resourceSrc = imagecreatefromjpeg($pathToSrc);
            break;
    }

    for ($x = 0; $x < 400; ++$x) {
        for ($y = 0; $y < 400; ++$y) {
            $TabColorsFlag = imagecolorsforindex($resourceDst, imagecolorat($resourceDst, $x, $y));
            $TabColorsPerso = imagecolorsforindex($resourceSrc, imagecolorat($resourceSrc, $x, $y));

            $color_r = floor($TabColorsFlag['red'] * $TabColorsPerso['red'] / 255);
            $color_g = floor($TabColorsFlag['green'] * $TabColorsPerso['green'] / 255);
            $color_b = floor($TabColorsFlag['blue'] * $TabColorsPerso['blue'] / 255);
            imagesetpixel($resourceDst, $x, $y, imagecolorallocate($resourceSrc, $color_r, $color_g, $color_b));
        }
    }

    imagepng($resourceDst, $resultPath, 0);
    imagedestroy($resourceDst);
    imagedestroy($resourceSrc);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-06T00:32:07.487

如果与 png 图像和 alpha 一起使用，必须很好并且效果很好

```
 $filter_r=215;
    $filter_g=5;
    $filter_b=5;
    $alpha=70;
    $suffixe="_red";
    $path="./img/foto_220_590.png";
    if(is_file($path)){
        $image=imagecreatefrompng($path);
        $new_path=substr($path,0,strlen($path)-4).$suffixe.".png";

         echo $imagex = imagesx($image);
         echo $imagey = imagesy($image);
        for ($x = 0; $x <$imagex; ++$x) {
            for ($y = 0; $y <$imagey; ++$y) {
                $rgb = imagecolorat($image, $x, $y);
                $TabColors=imagecolorsforindex ( $image , $rgb );
                $color_r=floor($TabColors['red']*$filter_r/255);
                $color_g=floor($TabColors['green']*$filter_g/255);
                $color_b=floor($TabColors['blue']*$filter_b/255);
                //$newcol = imagecolorallocate($image, $color_r,$color_g,$color_b);
                // this new alpha
                $newcol = imagecolorallocatealpha($image, $color_r,$color_g,$color_b,$alpha);
                imagesetpixel($image, $x, $y, $newcol);
            }
        }
         imagepng($image,$new_path);
```

# iis - hgweb 替代 allow_push

> ID：15554418
> 
> 赞同：2
> 
> 时间：2013-03-21T17:38:34.080
> 
> 标签：iis, mercurial, mercurial-hook, hgweb

我让 Mercurial 在 IIS7 上运行良好。令人沮丧的一件事是 allow_push 只会获取用户名列表而不是组。

为此，我想知道是否可以使用钩子来执行此任务。即通过传入经过身份验证的用户名，您可以按需检查用户是否具有适当的访问权限。如果您可以将用户名传递给钩子，那就没问题了，例如：

```
[hooks]
prechangegroup = echo %username% 
```

不出所料，这总是返回运行 IIS 的帐户。有没有办法让 allow_push 尊重组 - 或将登录用户传递到 prechangegroup 挂钩？

欢迎使用替代方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T09:13:46.637

这并不理想——我宁愿像上面那样做。我采取的另一种方法是让外部进程在 IIS 中的文件夹上设置读取和执行权限，并在 hgrc 中适当地为存储库设置 allow_pull 和 allow_push 权限。

缺点方面：

*   它是另一个需要了解存储库位置的过程。
*   该过程需要一种机制来了解对组的更新（即轮询）。

# sql - ORA-00907: 缺少右括号 [like.no.other]

> ID：15554422
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:38:42.520
> 
> 标签：sql, oracle

很简单，但是看不懂

```
select distinct PROJ_ID from APPS.BUS_PLAN_PROJ --> ok
(select distinct PROJ_ID from APPS.BUS_PLAN_PROJ) --> ok
select distinct PROJ_ID from APPS.BUS_PLAN_PROJ order by PROJ_ID DESC --> ok 
```

但

```
(select distinct PROJ_ID from APPS.BUS_PLAN_PROJ
                                      order by PROJ_ID DESC) --> ORA-00907 
```

它只是我真正的 sql 的一小部分。请帮我

注意：我用谷歌搜索但无法得到答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:42:39.377

我认为这是更大查询中的子查询，因为它在括号中。`ORDER BY`不是有效的子查询，无论如何我都没有想到。我怀疑 order by 在这里不需要或有用。我怀疑oracle认为右括号应该在之前，`ORDER BY`因为排序应该应用于外部查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:49:46.317

不允许在集合运算符连接的子查询中使用 ORDER BY。
[例子](http://www.sqlfiddle.com/#!4/fd37a/57)

# android - Intent-Filter 无法同时打开 http 和内容

> ID：15554431
> 
> 赞同：1
> 
> 时间：2013-03-21T17:39:06.623
> 
> 标签：android, android-intent, intentfilter

我似乎无法让我`intent-filter`从一个`http`和一个`content`计划中打开。我有我的`intent-filter`设置来查找某个文件扩展名（例如：“.riley”），但是当我将我的`data`部分设置为同时查找`http`方案和`content`方案时，它拒绝通过`http`. 当我将其设置为查找时`http`，它不会以`content`. 当我不指定 a`scheme`时，它只通过`file`and打开`content`，但忽略`http`.

这是我没有指定的基本设置`scheme`：

```
<category android:name="android.intent.category.DEFAULT" />
<category android:name="android.intent.category.BROWSABLE" />

<data
    android:host="*"
    android:mimeType="*/*"
    android:pathPattern=".*\\.riley" /> 
```

如何访问以从指定的路径扩展名打开我的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T13:08:58.687

您可以尝试使用多个意图过滤器，而不是在数据标签中定义这两个方案。

我遇到了类似的问题，可以通过使用[Intent Intercept 应用程序](https://play.google.com/store/apps/details?id=uk.co.ashtonbrsc.android.intentintercept)并检查意图的哪些部分不匹配来解决它。我发现应用程序在通过内容方案打开意图时往往会省略文件扩展名，这也可能是您问题的一部分。

# jquery - jQuery 选择选项，如果选择了值，那么 fadeIn()

> ID：15554434
> 
> 赞同：0
> 
> 时间：2013-03-21T17:39:24.190
> 
> 标签：jquery, jquery-ui

我正在尝试创建一个带有选择标签的表单......当用户按下它时，我也有一个重复的表单按钮，它在下面重复了相同的表单。

我的问题是当表单重复并且用户使用选择标签时（当用户选择某个值时我有一些 jQuery.... 有这个`fadeIn()`它使用同一个类，所以当我需要它时两个选择标签一起工作成为彼此的个体。

这是我正在研究的小提琴的链接：http: [//jsfiddle.net/d0okie0612/ThnKc/](http://jsfiddle.net/d0okie0612/ThnKc/)

这是我的html

```
 <select id="print_size_options_LargeFormatBlackWhite">
    <option value="">1</option>
    <option value="">2</option>
    <option value="customSize">3</option>
   </select>

   <div class="custom_size" style="display: none;">
     Hello
   </div>

   <br />
   <br />
   <br />
   <select id="print_size_options_LargeFormatBlackWhite">
     <option value="">1</option>
     <option value="">2</option>
     <option value="customSize">3</option>
   </select>

   <div class="custom_size" style="display: none;">
     Hello
   </div> 
```

这是jQuery：

```
 $("#print_size_options_LargeFormatBlackWhite").change(function(evt) {
      var selected;
      selected = $(this).val();
      if (selected === "customSize") {
      return $(".custom_size").fadeIn();
      } else {
      return $(".custom_size").fadeOut();
       }
       }).change(); 
```

所以我只想为每个不同的选择标签提供独立的行为......我不能将它分配给不同的类，因为用户可能会重复表单 10 次......

我显然是 jQuery 的新手，所以如果你能帮助我，那就太好了

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:58:20.543

请参阅对同一页面中的多个实例使用相同的 id 是无效标记，它不会那样工作。你必须做一些这样的解决方法：

```
var i=0;
$('a').click(function () {
    $('select').last().clone().attr('id', 'print_size_options_LargeFormatBlackWhite'+ i++).appendTo('body');
     $('.custom_size').last().clone().hide().appendTo('body');
});
$('select').each(function (i, v) {
   $(this).attr('id', $(this).attr('id') + i);
});
$(document).on('change', '[id^="print_size_"]', function (evt) {
  var selected;
  selected = $(this).val();
  if (selected === "customSize") {
     $(this).next(".custom_size").fadeIn();
  } else {
     $(this).next(".custom_size").fadeOut();
  }
}).change(); 
```

### [检查这个小提琴](http://jsfiddle.net/ThnKc/3/)

随着你的最新评论：

您必须将事件委托给父元素或`$(document)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:05:46.303

尝试这个：

```
$(document).on("change", "#print_size_options_LargeFormatBlackWhite",function(evt) {
    var selected, index;
    selected = $(this).val();
    index = $("select").index(this);
    if (selected === "customSize") {
        $($(".custom_size")[index]).fadeIn();
    } else {
        $($(".custom_size")[index]).fadeOut();
    }
}); 
```

不知道为什么我必须包装索引，但我做到了。

Ps 这是一个小提琴[http://jsfiddle.net/Dtwigs/ThnKc/2/](http://jsfiddle.net/Dtwigs/ThnKc/2/)

# regex - 限制表达

> ID：15554439
> 
> 赞同：1
> 
> 时间：2013-03-21T17:39:38.120
> 
> 标签：regex

我正在尝试编写一个允许的表达式：

1) 在前五位输入数字。

和

2) 在接下来的 6 个位置输入数字和/或字母。

和

3) 验证总长度 = 11 既不多也不少的检查。

我能够通过以下表达式实现#1 和#2，但无法进行验证以检查总数据是否恰好为 11，既不少也不多。有人可以提供一些输入。谢谢

```
^([\d{5}]*[0-9a-zA-Z]{6})$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:42:11.903

这部分失败了：`[\d{5}]*`。

它匹配*“任何数字、a `{`、5 或 a `}`”* 0 次或更多次。

你一定在找`\d{5}`，意思是*“五位数”*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:42:54.020

这就是你想要的：

`^\d{5}[0-9a-zA-Z]{6}$`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:47:06.240

对于单行，您可以指定匹配必须发生在行尾，如下所示...

```
^\s*([0-9]{11})\z 
```

希望能帮助到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:47:58.410

这 [\d{5}]* 导致了问题。使用这个
- /^[0-9]{5}[a-zA-Z0-9]{6}$/

# ios - Theos 和模拟器 - 我可以在 IOS 模拟器上开发 cydia 调整和测试吗

> ID：15554444
> 
> 赞同：1
> 
> 时间：2013-03-21T17:39:55.417
> 
> 标签：ios, xcode, cydia, theos

我找到了一些关于如何安装 Theos 以开发越狱应用程序/调整的很棒的教程：http: [//iphonedevwiki.net/index.php/Theos/Getting_Started](http://iphonedevwiki.net/index.php/Theos/Getting_Started)

问题是，我只有 1 个运行 ios 6 的 iphone（iphone 5）。如果我开发这样的越狱/调整，我可以在 ios 模拟器上运行它，以便我可以在不同的 ios 版本上进行测试吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-01T09:51:26.937

看看下面的教程：

[http://sharedinstance.net/2013/10/running-tweaks-in-simulator/](http://sharedinstance.net/2013/10/running-tweaks-in-simulator/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-01T09:28:00.120

您无法在 ios 模拟器中测试或运行调整，因为它无法越狱。越狱您的 iphone 5 并在真实设备上测试您的调整。您还可以将 beta debs 发送给您的朋友，以便在其他设备或 ios 版本上进行测试。

# linq - 为什么 linq .Any() 会抛出“转换为值类型 'Boolean' 失败，因为物化了”？

> ID：15554460
> 
> 赞同：1
> 
> 时间：2013-03-21T17:40:44.323
> 
> 标签：linq, entity-framework

我有一个实体框架语句，用于检查用户是否已经在队列中。看起来很简单，但由于某种原因，我得到了一个例外：

> “转换为值类型 'Boolean' 失败，因为具体化值为 null。结果类型的泛型参数或查询必须使用可为空的类型。”

有谁知道为什么？

```
var campaignIds = campaigns.Select(c => c.Id);
return _queuedRecipientRepository.GetTable().Any(q => campaignIds.Contains(q.CampaignId) && q.Recipient.Id == recipient.Id); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-30T15:14:05.217

我想您应该将 Recipient 作为数据库结果的一部分。在 usings 中添加 System.Data.Entity

```
var campaigns = from q in context.Campaigns.Include(x => x.Recipient)
                where campaignIds.Contains(q.CampaignId) && q.Recipient.Id == recipient.Id
                select q.Id 
```

# r - 执行`mapply()`时如何跟踪错误发生的位置？

> ID：15554473
> 
> 赞同：1
> 
> 时间：2013-03-21T17:41:44.350
> 
> 标签：r

我有一个 600,000 行的 data.table 并在其上执行以下命令：

```
ranges <- mapply(function(mi, ma) {seq(from=mi, to=ma, by="days")}, mi=Moves$Start, ma=Moves$End) 
```

一段时间后我收到以下错误消息：

```
Error in seq.int(0, to0 - from, by) : wrong sign in 'by' argument 
```

我用较小的数据集测试了我的代码，这似乎工作正常。这使我认为错误消息是数据集中值的结果。任何人都可以推荐一种有效的方法来跟踪 data.table 中的问题行吗？不用说，手动检查 600k 行有点太多了。

感谢您在 data.table 中查找问题行的建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:42:46.877

显而易见的解决方案是将匿名函数转换为第一类、全名函数，然后您就可以调试该函数了。或者打开恢复选项，然后您可以进入当前堆栈的评估框架并查看引发错误时变量的状态。

```
myFun <- function(mi, ma) {
  seq(from=mi, to=ma, by="days")
} 
```

为您提供一个命名函数，您可以通过它进行调试

```
debug(myFun) 
```

或者

```
debugonce(myFun) 
```

要打开错误恢复，请执行

```
op <- options(error = recover) 
```

（你可以休息一下：`options(op)`或`options(error = stop)`

在这种情况下，我怀疑`mi`大于`ma`：

```
> myFun(Sys.Date(), Sys.Date()-1)
Error in seq.int(0, to0 - from, by) : wrong sign in 'by' argument 
```

因此您可以更改`myFun`以查看是否是这种情况：

```
myFun <- function(mi, ma) {
  if(mi > ma)
    stop("`mi` is > than `ma`")
  seq(from=mi, to=ma, by="days")
} 
```

这样你会得到一个更丰富的错误信息。

如果失败了，我会使用`options(error = recover)`然后进入与函数对应的评估调用，看看和的值是`mi`什么`ma`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-17T16:42:53.803

# 概述

[`seq.Date()`](http://stat.ethz.ch/R-manual/R-devel/library/base/html/seq.Date.html)的错误消息试图告诉您`Moves$End`（即 2017 年 6 月 23 日）的日期发生**在** `Moves$Start`（即 2017 年 4 月 17 日）之前。因为`seq.Date()`假定 in 中的所有日期都`from`发生在 中的日期之前`to`，所以该错误会阻止函数继续执行。

要确定发生这种情况的位置，请使用[`which()`](https://stat.ethz.ch/R-manual/R-devel/library/base/html/which.html)来确定哪些日期`Moves$End`小于`Moves$Start`。从那里，更新这些日期，使它们发生**在** `Moves$Start`.

```
# load necessary data
Moves <- data.frame( Start = as.Date( x = c("2017-04-17", "2018-03-01", "2019-04-01") )
                     , End = as.Date( x = c("2017-06-23", "2018-02-14", "2018-04-24") )
                     , stringsAsFactors = FALSE )

# try to create a sequence of dates
date.ranges <-
  mapply( FUN = function( mi, ma )
  seq.Date( from = mi
            , to = ma
            , by = "day" )
  , Moves$Start
  , Moves$End
  , SIMPLIFY = FALSE )

# identify the instance
# where the End date occurs
# before the Start date
wrong.end.date <-
  which( Moves$End < Moves$Start )

# view results
wrong.end.date
# [1] 2 3

# correct those End Dates
# so that they occur 
# after the Start date
Moves$End[ wrong.end.date ] <-
  as.Date( x = c("2019-02-14", "2019-04-24") )

# rerun the mapply() function
date.ranges <-
  mapply( FUN = function( mi, ma )
    seq.Date( from = mi
              , to = ma
              , by = "day" )
    , Moves$Start
    , Moves$End
    , SIMPLIFY = FALSE )

# end of script # 
```

# windows-phone-8 - 识别控件的可视事件

> ID：15554475
> 
> 赞同：0
> 
> 时间：2013-03-21T17:41:49.697
> 
> 标签：windows-phone-8

是否有任何事件要处理，然后元素对用户来说是可见的？

示例：列表框中有一些 UI 元素，但所有项目都不是可视的，当用户滚动列表框时，元素是可视的。我想识别该视觉对象来处理读取操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:57:04.163

如果您使用`LongListSelector`, 而不是 a`ListBox`您可以使用该[`ItemRealized`](http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.controls.longlistselector.itemrealized%28v=vs.105%29.aspx)事件来了解虚拟化项目何时实现（加载）。

如果您真的想知道项目何时可见，则必须测量项目的大小（如果它们不完全相同并且事先已知），`ListBox`（或`LongListSelector`）占用的区域的大小（它'会因 WVGA/WXGA 和 720P 屏幕）和`ScrollOffset`内部（控制模板）的不同而不同，`ScrollViewer`以计算当前可见的项目。

# ios - 键盘没有提供多个 UIWindows

> ID：15554481
> 
> 赞同：3
> 
> 时间：2013-03-21T17:42:08.880
> 
> 标签：ios, keyboard, uiwindow

我创建了一个加载 UIWindow，`makeKeyAndVisible`当我开始加载时，我调用它。完成后，我是`makeKeyAndVisible`我的主 UIWindow。但是我的问题是这样做之后，当我单击文本字段时，键盘没有出现。光标在 UITextField中[闪烁，但没有出现键盘，](https://stackoverflow.com/questions/13960410/cursor-is-blinking-in-uitextfield-but-keyboard-doesnt-appear)但我找不到正确的答案。

编辑：在 UIView 中，当我点击地址栏时，键盘确实出现但我无法输入。但是在谷歌的页面中，当我点击搜索文本字段时，键盘没有出现。

```
- (void)showLoading:(NSString*)text
{
loadingWindow = [[UIWindow alloc] init];
[[UIApplication sharedApplication] beginIgnoringInteractionEvents];
mainWindow = UIApplication.sharedApplication.keyWindow;    

[loadingWindow setFrame:CGRectMake(0, 0, boundWidth, boundHeight)];
[loadingWindow setRootViewController:[[UIViewController alloc] init]];
[loadingWindow.rootViewController setView:[[UIView alloc] init]];
[loadingWindow.rootViewController.view setFrame:loadingWindow.frame];

[loadingWindow setHidden:NO];
}

- (void)hideLoading
{
[loadingWindow setHidden:YES];
[loadingWindow removeFromSuperview];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:59:19.663

我发现了问题。当我想将 loadingWindow 放在最上面时，我正在调用`[loadingWindow makeKeyAndVisible]`我认为会导致问题的方法。现在我只用`[loadingWindow setHidden:NO]`.

# accessibility - 可访问性、字段集图例和标题标签

> ID：15554482
> 
> 赞同：5
> 
> 时间：2013-03-21T17:42:10.877
> 
> 标签：accessibility, forms

我正在开发的网站的要求是它必须符合 508。目前，我们的大多数 html 视图都以标题开头，`h1`然后是该视图上需要的任何内容。现在对于表单，建议在处理可访问性时使用`fieldset`s 和s 以及其他众多准则。`legend`这让事情变得有点复杂，因为`h1`本来是内容的标题，但是如果我必须使用 a`fieldset`和一个图例，现在我有了一个`h1`标题，但图例标题几乎是一样的。例如：

```
<h1>Edit Education Details</h1>

  <form>
    <fieldset>
      <legend>Edit Education Details</legend>

      <p>
        <label for="school">School</label>
        <input id="school" name="school" type="text"/>
      </p>

      ...other fields

    </fieldset>      
  </form> 
```

我不确定该走哪条路。我是否应该摆脱`h1`和样式传说与样式相同`h1`？或者我应该对图例文本进行创意，以使它们不是完全相同的文本？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T01:03:51.597

保持`h1`原样（假设教育详细信息是您可以在该屏幕上编辑的唯一内容）并用于`fieldset/legend`对任何相关的表单控件进行分组。例如，假设您完成了一系列处理用户教育水平的复选框：

```
<h1>Edit Education Details</h1>

<form>

<p>
  <label for="school">School</label>
  <input id="school" name="school" type="text"/>
</p>
<fieldset>
  <legend>Level of Education Completed</legend>
  <input type="checkbox" id="highschool">
  <label for="highschool">High School</label>
  <input type="checkbox" id="associates">
  <label for="associates">Associates Degree</label>
  [...]
</fieldset>      
</form> 
```

如果表单中没有任何逻辑关联的输入部分，则省略`fieldset/legends`. 拥有冗余或“变得有创意”以使您不冗余并不会增强可访问性。

请参阅[WCAG 2.0 - H82：使用 FIELDSET 和 LEGEND 对表单控件进行分组](http://www.w3.org/TR/2008/WD-WCAG20-TECHS-20080430/H82.html)。

# c++ - OpenGL文本渲染方法和权衡

> ID：15554485
> 
> 赞同：11
> 
> 时间：2013-03-21T17:42:15.883
> 
> 标签：c++, performance, opengl, fonts

**背景**

我在游戏[Bitfighter](http://bitfighter.org/)工作。我们仍然与 OpenGL 1.1 兼容，并针对 OSX、Windows 和 Linux 进行编译。

*我们对一切都*使用矢量图形，包括文本渲染和操作。我们使用 GLUT 的“FontStrokeRoman”稍作修改的变体，它只是一堆静态线条。我们喜欢这个，因为它似乎表现得非常好，易于旋转/缩放/操作。我们还允许在游戏中聊天，以便即时绘制文本。

**问题**

我们想使用更多/不同的字体。

我们发现了其他几种我们喜欢的字体，但它们都是 TTF 类型的字体，它们构建为多边形（带有曲线等），而不是笔触或脊椎。这带来了几个问题：

*   我们必须使用纹理（到目前为止我们在游戏中一直避免使用）
*   它们不容易调整大小/可旋转/等。
*   性能显着降低（理论上？）

我们已经尝试将 TTF 字体转换为多边形点数组，然后对填充进行三角测量。然而，这很难很好地渲染——在这种情况下，像素提示/抗锯齿似乎很难做到。

我们甚至尝试使用诸如“campskeleton”之类的库对多边形字体进行骨架化，因此我们可以输出矢量笔划字体（看起来不太成功）。

**我们应该做什么？**

我知道这个问题有点笼统。我们希望保持性能和文本操作能力，但能够使用更好的字体。我愿意接受任何方向的任何建议。

一些解决方案可能是以下问题的答案：

*   我们如何正确地消除基于多边形的文本的锯齿并且仍然保持性能？
*   纹理的性能*真的*比静态点数组差吗？也许我有一个错误的假设
*   纹理字体可以快速调整大小/旋转吗？
*   完全不同的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T15:34:54.203

经过一番说服（感谢 Serge）并尝试了这里的一些建议（包括使用 freetype 的 FTGL），我们决定：

使用[stb_truetype](http://nothings.org/)[的字体存储](https://github.com/akrinke/Font-Stash/)

这似乎非常适合我们的游戏。渲染性能与我们使用的基于矢量的笔触字体相当 - 纹理四边形真的不是那么慢，一旦生成，Font-Stash 的缓存有很大帮助。此外，使用 stb_truetype 使我们不需要跨所有平台的游戏中的*另一个依赖项。*

就其价值而言，这个解决方案比使用 FTGL 处理真字体快大约一个数量级，这可能是因为缓存。

感谢您的建议和指点。

**更新**

[上面的 Font-Stash 链接是原版 here](https://github.com/memononen/fontstash/)的一个分支。原版已经更新，添加了一些 fork 的功能，并且可以允许不同的渲染后端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T18:01:34.840

我不是 OpenGL 专家，也不是一般的图形专家。而且，真的，猛禽，我——讨厌——成为这样说的人，因为我知道你现在的感受。

我真的不想这么说，但老实说，我只是给 TTF 字体一个机会，使用它们的纹理和多边形。我怀疑这种用法是否真的会损害你这些天的表现。节省时间按原样使用它们可能更有价值，而不是花时间尝试一些更符合您需求的聪明解决方案。

我怀疑使用多边形/纹理绘制文本会对您的性能产​​生不利影响。这尤其适用于当今的计算机。多少年前，从技术上讲，您打算支持您的应用程序？或者您也希望在 Raspberry PI 上运行它？还是其他不具备高图形能力的移动平台？对其中任何一个的支持可能会使我的主张无效。

但是，就像我说的那样，我真的很讨厌成为那个建议你按原样艰难前行的人。因为，我去过那里，寻求性能建议（有时甚至是更小的事情），当有人说“忘记它，编译器会处理它”或“计算机如此先进，你不应该担心它”时，我只是呻吟着. 老实说，我希望其他人有经验，并为您提供一个好的答案。但是，如果不是，我只想让您知道：我无法预见使用 TTF 的可能性，如预期的那样，会对您的游戏性能产生任何不利影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:41:33.900

[您是否尝试使用 freetype FT_Outline_Decompose](http://www.freetype.org/freetype2/docs/reference/ft2-outline_processing.html#FT_Outline_Decompose)进行轮廓字形分解 ？Freetype 是字体渲染和字形轮廓提取的首选工具。支持提示，渲染模式允许您指定您想要的抗锯齿、提示、单色目标等。

Freetype 还具有内置的字形/位图缓存机制，这可能很有用。

注意：[OGFLT](http://oglft.sourceforge.net/)似乎弥合了 freetype 和 opengl 之间的差距，尽管我从来没有机会使用它

# android - ActionBarSherlock 中的按钮未垂直居中

> ID：15554487
> 
> 赞同：1
> 
> 时间：2013-03-21T17:42:23.110
> 
> 标签：android, android-layout, android-actionbar, actionbarsherlock

我在 Android 4.0 以下的设备中遇到了问题，ActionBarSherlock 中的按钮有时无法垂直居中。这发生在运行 Android 2.3.6 的设备上，不会影响任何运行 4.0+ 的设备

我在 ActionBarSherlock 上做了一个非常简单的自定义布局，其自定义布局结构显示在下面的 XML 中

## 无法垂直居中按钮的布局：

```
<Button
    android:id="@+id/button_action_next"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:background="@color/people_app_theme_color"
    android:gravity="center"
    android:text="NEXT"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="@android:color/white" />

<LinearLayout
    android:id="@+id/linearLayout1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:gravity="center"
    android:orientation="horizontal" >

    <ImageButton
        android:id="@+id/button_action_home"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:background="@color/people_app_theme_color"
        android:gravity="center"
        android:maxHeight="30dp"
        android:src="@drawable/android_home"
        android:text="HOME"
        android:textAppearance="?android:attr/textAppearanceSmall"
        android:textColor="@android:color/white" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:minHeight="48dp"
        android:text="TextView"
        android:textColor="@android:color/white" />
</LinearLayout>

<Button
    android:id="@+id/button_action_prev"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:background="@color/people_app_theme_color"
    android:gravity="center"
    android:text="PREV"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="@android:color/white" /> 
```

而且我根本无法获得按钮（`button_action_next`并且`button_action_prev`在操作栏中垂直居中）

我得到这样的结果：

![在此处输入图像描述](../Images/ace8088228a476414dde115c028d2dde.png)

**然而**，在同一个应用程序中，我有另一个 ActionBarSherlock 的自定义布局，它可以奇怪地使按钮垂直居中非常好。这个自定义布局的布局是这样的：

## 可以垂直居中按钮的布局：

```
<Button
    android:id="@+id/button_actionbar_done"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:background="@color/people_app_theme_color"
    android:gravity="center"
    android:text="DONE"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="@android:color/white" />

<Button
    android:id="@+id/button_actionbar_skip"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:background="@color/people_app_theme_color"
    android:gravity="center"
    android:text="SKIP"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="@android:color/white" />

<TextView
    android:id="@+id/text_title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/button_actionbar_skip"
    android:layout_alignBottom="@+id/button_actionbar_skip"
    android:layout_centerHorizontal="true"
    android:text="ENTER YOUR DETAILS"
    android:textColor="@android:color/white" /> 
```

工作布局和非工作布局之间的唯一区别是不能居中按钮的布局中有一个子`LinearLayout`元素。

所以我的问题是，如何确保按钮在任何情况下都垂直居中（避免屏幕截图中显示的结果）？

# 更新：我试过的

感谢@nicopico 的评论和这篇SO 帖子：[Gravity and layout_gravity on Android](https://stackoverflow.com/questions/3482742/android-gravity-and-layout-gravity)。我已经应用`layout_gravity="center"`到我的布局，但按钮仍然没有垂直居中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T12:19:42.727

好的，我有问题。

这是解决方案

# 解决方案 1

在这个布局中，

```
<Button
    android:id="@+id/button_actionbar_done"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:background="@color/people_app_theme_color"
    android:gravity="center"
    android:text="DONE"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="@android:color/white" />

<Button
    android:id="@+id/button_actionbar_skip"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:background="@color/people_app_theme_color"
    android:gravity="center"
    android:text="SKIP"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="@android:color/white" />

<TextView
    android:id="@+id/text_title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/button_actionbar_skip"
    android:layout_alignBottom="@+id/button_actionbar_skip"
    android:layout_centerHorizontal="true"
    android:text="ENTER YOUR DETAILS"
    android:textColor="@android:color/white" /> 
```

我删除了

> android:layout_alignParentTop="true"

在两个按钮中，并应用：

> android:layout_centerVertical="true"

到两个按钮，它现在可以在 ActionBar 内垂直居中

# 解决方案 2

根据这篇文章[Android ActionBar: How to vertical align views in top](https://stackoverflow.com/questions/15606877/android-actionbar-how-to-vertical-align-views-in-top?lq=1)

我可以将`android:layout_marginBottom`或`android:paddingBottom`应用于按钮以使其居中。

* * *

但是，我仍然更喜欢`android:layout_centerVertical`没有硬编码为数字的方法。

# d3.js - 在 d3 图表 (nvd3) 中启动可关闭模式窗口的可点击数据点

> ID：15554490
> 
> 赞同：4
> 
> 时间：2013-03-21T17:42:34.267
> 
> 标签：d3.js, nvd3.js

首先，我要感谢这里的社区，你们对我的帮助。

我在这里构建示例的自定义版本[http://nvd3.org/ghpages/scatter.html](http://nvd3.org/ghpages/scatter.html)

有没有办法让每个圈子成为可点击的链接？然后当您单击链接时，是否会出现一个源自圆圈的模式弹出窗口？在模态框上有一个关闭按钮。

我知道这听起来很复杂，但我很难在 NVD3 库中导航，它是否已被弃用/放弃？我找不到任何文件。我已经阅读了 Scott Murray 的指南，但似乎 NVD3 库已经过大量修改，我从 Scott Murray 那里读到的大部分内容并没有真正适用于这个例子。

我的示例页面在这里[http://goo.gl/pUKW9](http://goo.gl/pUKW9)我拥有的代码是....

```
<div id="offsetDiv">
  <div id="test1" class="chartWrap">
    <svg></svg>
  </div>
</div>
<script>
//Format A
var chart;

nv.addGraph(function() {
  chart = nv.models.scatterChart()
                .showDistX(true)
                .showDistY(true)
                //.height(500)
                .useVoronoi(true)
                .color(d3.scale.category10().range());

  chart.xAxis.tickFormat(d3.format('.02f'))
  chart.yAxis.tickFormat(d3.format('.02f'))

  d3.select('#test1 svg')
      .datum(randomData(4,40))
    .transition().duration(500)
      .call(chart)

  nv.utils.windowResize(chart.update);

  chart.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

  return chart;
});

function randomData(groups, points) { //# groups,# points per group
var data = [
{key: 'Weak Guidance', values: [
{x: 1, y: 1}
, {x: 2, y: 3}
, {x: 4, y: 9    }]},

{key: 'Strong Guidance', values: [
{x: 32, y: 0}
, {x: 3, y: 54}
, {x: 1, y: 8}  ]              }];

  return data;
}

</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T18:09:16.853

我不知道 nvd3 是否提供了将处理程序附加到元素的任何功能（我认为它没有），但是您可以在“纯”d3 中很容易地做到这一点。代码看起来像

```
svg.selectAll("circle").on("click", function(d, i) { ... }); 
```

其中`svg`是对图形容器元素的引用。您可能必须在选择器中更加具体，例如添加特定类 ( `selectAll("circle.myclass")`)。

d3 和 nvd3 都没有为模式对话框提供任何功能。不过，您应该能够毫无问题地使用[jQuery 对话框之类的东西。](http://jqueryui.com/dialog/)创建对话框的代码位于事件处理函数内部。

# c - 编写我自己的浮点解析器

> ID：15554494
> 
> 赞同：4
> 
> 时间：2013-03-21T17:42:36.940
> 
> 标签：c, floating-point

我正在尝试用 C 编写一个解析器，它的部分工作是将一系列字符转换为双精度。到目前为止，我一直在使用 strtod，但我发现它非常危险，它不会处理数字位于缓冲区末尾的情况，它不是以空值终止的。

我以为我会自己写。如果我有一个 ab 形式的数字的字符串表示，我会不会认为我可以计算 (double)a + ((double)b​​ / (double)10^n)，其中 n 是b中的数字？

例如，23.4563：

a = 23 b = 4563

最终答案：23 + (4563/10000)

或者这会对 IEEE 格式的浮点数产生不准确的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T18:19:23.000

浮点数很难准确读取，因为有很多问题需要仔细解决，而且很多人都做不到。然而，这是一个已解决的问题。首先，请参阅[William D. Clinger 于 1990 年 6 月出版的](https://doi.org/10.1145/93548.93557)[*How to read floating point numbers*](https://doi.org/10.1145/93548.93557)。

我同意 Roddy，您最好将数据复制到缓冲区并使用现有的库函数。（但是，您应该检查您的 C 实现是否提供了浮点数的正确舍入转换。C 标准不需要它，并且某些实现不提供它。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T20:42:18.547

您可能对[我对某个相关问题的回答](https://stackoverflow.com/a/8455604/968261)感兴趣。

该答案中的解析器将十进制浮点数（表示为字符串）转换为 IEEE-754 浮点数和适当舍入的双精度数。

据我记得，代码中唯一的问题是它可能无法处理指数部分太大（不适合整数）并且应该返回错误或返回的情况`INF`。

否则，它应该让您对要做什么有一个很好的了解（如果您对自己在做什么有任何想法：）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T23:02:33.077

如前所述，这很困难，您需要额外的精度，等等......

但是，如果您的输入受到限制，并且想知道您是否仍然可以使用半朴素算法和标准 IEEE 754 操作正确地将这些受限制的十进制转换为二进制，您可能会对我的回答感兴趣

[如何从字符串中手动解析浮点数](https://stackoverflow.com/questions/85223/how-to-manually-parse-a-floating-point-number-from-a-string/11705617#11705617)

# sql - SQL SUM 函数将使用多个表的数量加倍

> ID：15554499
> 
> 赞同：0
> 
> 时间：2013-03-21T17:42:48.690
> 
> 标签：sql, sum

我在下面的查询是将它返回的最后一条记录的金额加倍。我有 3 张桌子 - 活动、预订和临时预订。查询需要列出活动和附加信息，并从每个活动的预订表中提取预订位置的总数（使用 SUM）（作为 BookingTotal），然后它需要计算相同的临时预订（作为 tempPlacesReserved）提供该表中的reservedate 字段是将来的。

但是第一个问题是，如果 tempbookings 表中没有活动记录，它根本不会返回该活动的任何记录，为了解决这个问题，我过去创建了虚拟记录，以便它仍然返回记录，但是如果我能做到，所以我不必这样做，我会更喜欢它！

我遇到的主要问题是，在返回结果的最终记录中，它使预订总数和保留的位置翻了一番，这当然使整个查询无用。

我知道我做错了什么我只是无法对其进行排序，我在网上搜索了类似的问题，但无法正确地将它们应用于我的情况。

任何帮助，将不胜感激。

PS我知道通常你不需要像我一样完全标记到数据库、表和字段的所有路径，但是对于我计划在其中使用它的程序，我必须这样做。

代码：

```
SELECT [LeisureActivities].[dbo].[activities].[activityID], 
    [LeisureActivities].[dbo].[activities].[activityName], 
    [LeisureActivities].[dbo].[activities].[activityDate], 
    [LeisureActivities].[dbo].[activities].[activityPlaces], 
    [LeisureActivities].[dbo].[activities].[activityPrice], 
    SUM([LeisureActivities].[dbo].[bookings].[bookingPlaces]) AS 'bookingTotal', 
    SUM (CASE WHEN[LeisureActivities].[dbo].[tempbookings].[tempReserveDate] > GetDate() THEN [LeisureActivities].[dbo].[tempbookings].[tempPlaces] ELSE 0 end) AS 'tempPlacesReserved'
FROM [LeisureActivities].[dbo].[activities], 
    [LeisureActivities].[dbo].[bookings], 
    [LeisureActivities].[dbo].[tempbookings]
WHERE ([LeisureActivities].[dbo].[activities].[activityID]=[LeisureActivities].[dbo].[bookings].[activityID] 
    AND [LeisureActivities].[dbo].[activities].[activityID]=[LeisureActivities].[dbo].[tempbookings].[tempActivityID]) 
    AND [LeisureActivities].[dbo].[activities].[activityDate] > GetDate ()
GROUP BY [LeisureActivities].[dbo].[activities].[activityID], 
    [LeisureActivities].[dbo].[activities].[activityName], 
    [LeisureActivities].[dbo].[activities].[activityDate],
     [LeisureActivities].[dbo].[activities].[activityPlaces], 
    [LeisureActivities].[dbo].[activities].[activityPrice]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:54:50.607

您当前的查询`INNER JOIN`在每个表之间使用一个，因此如果`tempBookings`表没有记录，您将不会返回任何内容。

我建议你开始使用`JOIN`语法。您可能还需要使用子查询来获取总数。

```
SELECT a.[activityID], 
    a.[activityName], 
    a.[activityDate], 
    a.[activityPlaces], 
    a.[activityPrice], 
    coalesce(b.bookingTotal, 0) bookingTotal, 
    coalesce(t.tempPlacesReserved, 0) tempPlacesReserved
FROM [LeisureActivities].[dbo].[activities] a
LEFT JOIN
(
  select activityID,
    SUM([bookingPlaces]) AS bookingTotal
  from [LeisureActivities].[dbo].[bookings]
  group by activityID
) b
  ON a.[activityID]=b.[activityID] 
LEFT JOIN
(
  select tempActivityID,
    SUM(CASE WHEN [tempReserveDate] > GetDate() THEN [tempPlaces] ELSE 0 end) AS tempPlacesReserved
  from [LeisureActivities].[dbo].[tempbookings]
  group by tempActivityID
) t
  ON a.[activityID]=t.[tempActivityID]
WHERE a.[activityDate] > GetDate(); 
```

*注意：我使用别名是因为它更容易阅读*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:56:12.853

Use new SQL-92 Join syntax, and make join to tempBookings an outer join. Also clean up your sql with table aliases. Makes it easier to read. As to why last row has doubled values, I don't know, but on off chance that it is caused by extra dummy records you entered. get rid of them. That problem is fixed by using outer join to tempBookings. The other possibility is that the join conditions you had to the tempBookings table(t.tempActivityID = a.activityID) is insufficient to guarantee that it will match to only one record in activities table... If, for example, it matches to two records in activities, then the rows from Tempbookings would be repeated twice in the output, (causing the sum to be doubled)

```
SELECT a.activityID, a.activityName, a.activityDate, 
       a.activityPlaces, a.activityPrice, 
       SUM(b.bookingPlaces) bookingTotal, 
       SUM (CASE WHEN t.tempReserveDate > GetDate() 
                 THEN t.tempPlaces ELSE 0 end) tempPlacesReserved
FROM LeisureActivities.dbo.activities a
    Join LeisureActivities.dbo.bookings b
       On b.activityID = a.activityID
    Left Join LeisureActivities.dbo.tempbookings t
       On t.tempActivityID = a.activityID
WHERE a.activityDate > GetDate ()
GROUP BY a.activityID, a.activityName, 
    a.activityDate, a.activityPlaces, 
    a.activityPrice; 
```

# c# - ASP.Net / C# 动态生成的单选按钮

> ID：15554507
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:43:01.550
> 
> 标签：c#, asp.net, sharepoint-2010

我正在为 SharePoint 编写一个小型应用程序，我想检查库中工作流的数量并将它们添加到一个表中，每个表都有 3 个选项 - 终止、启动和重新启动。

如何动态生成 n 个终止、启动和重新启动单选按钮组（n 是库中工作流的数量），以便我可以遍历每个组以查看为每个工作流选择了哪些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:55:13.743

在`OnInit`您的控件的方法中添加这样的代码（必须每次都执行，即使在回发时）

```
protected override OnInit(EventArgs e)
{
    for (int i = 0; i < 5; i++)
    {
        var chk = new CheckBox();
        chk.CheckedChanged += this.CheckBoxChanged;
        chk.Text = "CHK#" + i.ToString();
        chk.ID = "chk_" + i.ToString();

        this.Controls.Add(chk);
    }
}

protected void CheckBoxChanged(object sender, EventArgs e)
{
    var chk = (CheckBox)sender;
    var i = int.Parse(chk.ID.SubString(4));
    // "i" now holds the number of the checkbox changed.
} 
```

不同控件的事件和属性会发生变化，但整体机制不会发生变化。

# python - 如何在不使用 Python 打开端口的情况下双向发送无线传感器数据通过防火墙？

> ID：15554509
> 
> 赞同：2
> 
> 时间：2013-03-21T17:43:12.577
> 
> 标签：python, webserver, sensors, raspberry-pi

我是这个论坛的新手，对 python 比较陌生，但一直在玩 sockets/google app engine/django 等……我不知道如何最好地设计这个应用程序以及使用什么工具。任何有更多经验的人

**硬件：**我在防火墙后面有一个 Raspberry Pi，用于收集无线传感器数据。我想从外部网络服务器（又名谷歌应用引擎或 ec2 服务器）访问该数据。

**目标：**目标是让不同家庭的用户（比如我妈妈、爷爷等与他们自己的 pi 分开生活）能够在中央服务器上检查他们在网络上的数据。我还应该能够在 Pi 上启动操作，因此数据应该双向发送。理想情况下无需打开防火墙端口（虚拟证明）。

**到目前为止我所做的：** 我能够在 PI 上创建套接字以将数据发送到 django 服务器（ec2），但我必须为此打开端口。

**问题：**

1.  我想用*python*来做这个，*没有开放的端口*，*双向*数据。
2.  您如何处理故障保护，例如：
    *   互联网走下坡路。
    *   缺少服务器读数。
    *   停电。
3.  这可以通过在 Pi 和 Web 服务器之间同步数据库来解决吗？

我意识到这是一个非常广泛的问题，但也许不是关于确切的工具，而是更多关于用于这种特定类型项目的技术？欢迎使用工具、技术、范例或一般经验。

感谢大家，

大卫

# ios - iOS 为点击手势识别器设置移动容差

> ID：15554513
> 
> 赞同：1
> 
> 时间：2013-03-21T17:43:16.897
> 
> 标签：ios, uigesturerecognizer

有没有办法确保任何包含超过一定移动量的水龙头都被丢弃？事实上，所谓的轻敲可能涉及手指的大量滑动。我想通过使用 touchesBegan:、touchesMoved: 等以不同方式处理“点击和移动”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-23T19:48:04.383

可能不是您正在寻找的答案。但是我已经解决了这个问题，而是自己按照常规的触摸顺序进行操作。为此，您还需要 self.multipleTouchEnabled = NO

```
@interface myView(){
    CGPoint _touchStartPoint;
}
@end

@implementation myView

-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    _touchStartPoint = [[touches anyObject] locationInView:self];
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    [self checkDistance: [[touches anyObject] locationInView:self]];
}

-(void)checkDistance:(CGPoint)p{

    static CGFloat dX;
    dX = p.x - _touchStartPoint.x;

    static CGFloat dY;
    dY = p.y - _touchStartPoint.y;

    static CGFloat dist;
    dist = sqrt(dX*dX + dY*dY);

    /* movement of less than 10 pixels */
    if(dist < 10){
        [self tap];
    }
}

-(void)tap{
    /* do something with your tap*/
}

@end 
```

# java - A* 无限循环

> ID：15554514
> 
> 赞同：0
> 
> 时间：2013-03-21T17:43:19.870
> 
> 标签：java, list, infinite-loop, path-finding, a-star

我正在尝试为寻路问题实现 A* 算法。

它可以工作，就像 10 次中有 9 次一样，但在某些时候我得到一个（可能）无限循环，并且程序找不到最佳路径。你能明白为什么会这样吗？

一种*：

```
import java.util.*;

public abstract class AStar<T>
{
            private class Path implements Comparable{
                            public T point;
                            public Double f;
                            public Double g;
                            public Path parent;

                            public Path(){
                                            parent = null;
                                            point = null;
                                            g = f = 0.0;
                            }

                            public Path(Path p){
                                            this();
                                            parent = p;
                                            g = p.g;
                                            f = p.f;
                            }

                            public int compareTo(Object o){
                                            Path p = (Path)o;
                                            return (int)(f - p.f);
                            }

                            public T getPoint(){
                                            return point;
                            }

                            public void setPoint(T p){
                                            point = p;
                            }
            }

            protected abstract boolean isGoal(T node);

            protected abstract Double g(T from, T to);

            protected abstract Double h(T from, T to);

            protected abstract List<T> generateSuccessors(T node);

            private PriorityQueue<Path> paths;
            private HashMap<T, Double> mindists;
            private Double lastCost;
            private int expandedCounter;

            public int getExpandedCounter(){
                            return expandedCounter;
            }

            public AStar(){
                            paths = new PriorityQueue<Path>();
                            mindists = new HashMap<T, Double>();
                            expandedCounter = 0;
                            lastCost = 0.0;
            }

            protected Double f(Path p, T from, T to){
                            Double g =  g(from, to) + ((p.parent != null) ? p.parent.g : 0.0);
                            Double h = h(from, to);

                            p.g = g;
                            p.f = g + h;

                            return p.f;
            }

            private void expand(Path path){
                            T p = path.getPoint();
                            Double min = mindists.get(path.getPoint());

                            if(min == null || min.doubleValue() > path.f.doubleValue())
                                            mindists.put(path.getPoint(), path.f);
                            else
                                            return;

                            List<T> successors = generateSuccessors(p);

                            for(T t : successors){
                                            Path newPath = new Path(path);
                                            newPath.setPoint(t);
                                            f(newPath, path.getPoint(), t);
                                            paths.offer(newPath);
                            }

                            expandedCounter++;
            }

            public Double getCost(){
                            return lastCost;
            }

            public List<T> compute(T start){
                            try{
                                            Path root = new Path();
                                            root.setPoint(start);

                                            /* Needed if the initial point has a cost.  */
                                            f(root, start, start);

                                            expand(root);

                                            for(;;){
                                                            Path p = paths.poll();

                                                            if(p == null){
                                                                            lastCost = Double.MAX_VALUE;
                                                                            return null;
                                                            }

                                                            T last = p.getPoint();

                                                            lastCost = p.g;

                                                            if(isGoal(last)){
                                                                            LinkedList<T> retPath = new LinkedList<T>();

                                                                            for(Path i = p; i != null; i = i.parent){
                                                                                            retPath.addFirst(i.getPoint());
                                                                            }

                                                                            return retPath;
                                                            }
                                                            expand(p);
                                            }
                            }
                            catch(Exception e){
                                            e.printStackTrace();
                            }
                            return null;

            } 
```

}

和主要的寻路类：

```
import java.util.*;

public class PathFinder extends AStar<PathFinder.Node>
{
            private int[][] map;
            private int endx;
            private int endy;

            public static class Node{
                            public int x;
                            public int y;
                            Node(int x, int y){
                                            this.x = x; 
                                            this.y = y;
                            }
                           public String toString(){
                                            return "(" + x + ", " + y + ") ";
                            }
                            public int getX(){
                                return x;
                            }
                            public int getY(){
                                return y;
                            }
}               public PathFinder(int[][] map, int endx, int endy){
                            this.map = map;
                            this.endx=endx;
                            this.endy=endy;
            }

            protected boolean isGoal(Node node){
                            return (node.x == endx) && (node.y == endy);
            }

            protected Double g(Node from, Node to){

                            if(from.x == to.x && from.y == to.y){

                           //   System.out.println("To x1 " + to.x);
                         //     System.out.println("To y1 " + to.y);
                                            return 0.0;}

                            if(map[to.y][to.x] == 1){
                                //System.out.println("To x2 " + to.x);
                            //  System.out.println("To y2 " + to.y);

                                            return 1.0;}

                            return Double.MAX_VALUE;
            }

            protected Double h(Node from, Node to){

                           return new Double(Math.abs(endx - to.x) + Math.abs(endy - to.y));
            }

            protected List<Node> generateSuccessors(Node node){
                            List<Node> ret = new LinkedList<Node>();
                            int x = node.x;
                            int y = node.y;
                            if(y < map[0].length-1 && map[y+1][x] == 1)
                                            ret.add(new Node(x, y+1));

                            if(x <map.length-1 && map[y][x+1] == 1)
                                            ret.add(new Node(x+1, y));

                            if(y !=0 && map[y-1][x] == 1)
                                            ret.add(new Node(x, y-1));

                            if(x !=0 && map[y][x-1] == 1)
                                            ret.add(new Node(x-1, y));

                            return ret;
            }

            public static void main(String [] args){
                            WorldGenerator gen = new WorldGenerator();

            int ammountOfBlocks =200;
            int width = 25;
            int length = 25;
            int startX = 1;
            int startY = 1;
            int endX = 24;
            int endY = 24;
            int[][] map = gen.createWorld(ammountOfBlocks,width,length,startX,startY,endX,endY);
            int a=map.length;
            int b=map[0].length;
            int[][] map2=new int[b][a];
            for(int i=0; i<map.length; i++){
                for(int j=0; j<map[0].length;j++)
                {map2[j][i]=map[i][j];
                }
            }
                            PathFinder pf = new PathFinder(map,endX,endY);

                           /* for(int i = 0; i < map.length; i++){
                                            for(int j = 0; j < map[0].length; j++)
                                                            System.out.print(map[i][j] + " ");
                                            System.out.println();
                            }*/

                            long begin = System.currentTimeMillis();

                            List<Node> nodes = pf.compute(new PathFinder.Node(startX,startY));

                            long end = System.currentTimeMillis();

                            System.out.println("Time = " + (end - begin) + " ms" );
                            //System.out.println("Expanded = " + pf.getExpandedCounter());
                            System.out.println("Cost = " + pf.getCost());

                            if(nodes == null)
                                            System.out.println("No path");
                            else{

                                            for(int i=0; i<nodes.size();i++){
                                                            Node n=nodes.get(i);
                                                            int x= n.getX();
                                                            int y= n.getY();
                                                            map[x][y]=4;
                            }
                           /* for(int i = 0; i < map.length; i++){
                                            for(int j = 0; j < map[0].length; j++)
                                                            System.out.print(map[i][j] + " ");
                                            System.out.println();
                            }*/

            }

            } 
```

}

WorldGenerator 类仅生成 1 和 0 的二维数组。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:07:58.763

在这里从我的臀部拍摄，但是如果您想使用“直线距离”作为您的启发式方法，那么您的代码中有一个错误。

当前的启发式是：*delta x 和 y 之和最小的节点最接近。*

假设我们有一个 5 x 5 的网格，目标是 2,2，那么使用这个启发式 2,0 将与 1,1 一样最优，这当然是错误的。

尝试将毕达哥拉斯用于新的启发式：*距离末端最短的节点是最近的。*

```
protected Double h(Node from, Node to) {
    int dx = Math.abs(endx - to.x);
    int dy = Math.abs(endy - to.y);
    return new Double(Math.sqrt(dx*dx) + (dy*dy));
} 
```

这将使您的算法使用[http://en.wikipedia.org/wiki/Admissible_heuristic](http://en.wikipedia.org/wiki/Admissible_heuristic)，这是 A* 的标准：[http ://en.wikipedia.org/wiki/A_star#Admissibility_and_optimality](http://en.wikipedia.org/wiki/A_star#Admissibility_and_optimality)

希望这可以帮助。

* * *

一个适合我的解决方案：

**AStar.java**

```
import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.PriorityQueue;

public abstract class AStar<T> {

    private class Path<T> implements Comparable {

        public T point;
        public Double f;
        public Double g;
        public Path<T> parent;

        public Path() {
            parent = null;
            point = null;
            g = f = 0.0;
        }

        public Path(Path<T> p) {
            this();
            parent = p;
            g = p.g;
            f = p.f;
        }

        @Override
        public int compareTo(Object o) {
            AStar.Path p = (AStar.Path) o;
            return (int) (f - p.f);
        }

        public T getPoint() {
            return point;
        }

        public void setPoint(T p) {
            point = p;
        }
    }

    protected abstract boolean isGoal(T node);

    protected abstract Double g(T from, T to);

    protected abstract Double h(T from, T to);

    protected abstract List<T> generateSuccessors(T node, T parent);
    private PriorityQueue<AStar.Path> paths;
    private HashMap<T, Double> mindists;
    private Double lastCost;
    private int expandedCounter;

    public int getExpandedCounter() {
        return expandedCounter;
    }

    public AStar() {
        paths = new PriorityQueue<>();
        mindists = new HashMap<>();
        expandedCounter = 0;
        lastCost = 0.0;
    }

    protected Double f(AStar.Path p, T from, T to) {
        Double g = g(from, to) + ((p.parent != null) ? p.parent.g : 0.0);
        Double h = h(from, to);

        p.g = g;
        p.f = g + h;

        return p.f;
    }

    private void expand(Path<T> path) {
        if (expandedCounter > 1000000) {
            return;
        }
        T p = path.getPoint();
        Double min = mindists.get(path.getPoint());

        if (min == null || min.doubleValue() > path.f.doubleValue()) {
            mindists.put(path.getPoint(), path.f);
        } else {
            return;
        }

        List<T> successors = generateSuccessors(p, path.parent != null ? path.parent.getPoint() : null);

        for (T t : successors) {
            AStar.Path newPath = new AStar.Path(path);
            newPath.setPoint(t);
            f(newPath, path.getPoint(), t);
            paths.offer(newPath);
        }

        expandedCounter++;
    }

    public Double getCost() {
        return lastCost;
    }

    public List<T> compute(T start) {
        try {
            AStar.Path root = new AStar.Path();
            root.setPoint(start);

            /*
             * Needed if the initial point has a cost.
             */
            f(root, start, start);

            expand(root);

            for (;;) {
                Path<T> p = paths.poll();

                if (p == null) {
                    lastCost = Double.MAX_VALUE;
                    return null;
                }

                T last = p.getPoint();

                lastCost = p.g;

                if (isGoal(last)) {
                    LinkedList<T> retPath = new LinkedList<T>();

                    for (Path<T> i = p; i != null; i = i.parent) {
                        retPath.addFirst(i.getPoint());
                    }

                    return retPath;
                }
                expand(p);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;

    }
} 
```

**路径查找器.java**

```
package playground;

import java.util.*;

public class PathFinder extends AStar<PathFinder.Node> {

    private int[][] map;
    private int endx;
    private int endy;

    public static class Node {

        public int x;
        public int y;

        Node(int x, int y) {
            this.x = x;
            this.y = y;
        }

        public String toString() {
            return "(" + x + ", " + y + ") ";
        }

        public int getX() {
            return x;
        }

        public int getY() {
            return y;
        }
    }

    public PathFinder(int[][] map, int endx, int endy) {
        this.map = map;
        this.endx = endx;
        this.endy = endy;
    }

    protected boolean isGoal(Node node) {
        return (node.x == endx) && (node.y == endy);
    }

    protected Double g(Node from, Node to) {

        if (from.x == to.x && from.y == to.y) {

            //   System.out.println("To x1 " + to.x);
            //     System.out.println("To y1 " + to.y);
            return 0.0;
        }

        if (map[to.y][to.x] == 1) {
            //System.out.println("To x2 " + to.x);
            //  System.out.println("To y2 " + to.y);

            return 1.0;
        }

        return Double.MAX_VALUE;
    }

    protected Double h(Node from, Node to) {
        int dx = Math.abs(endx - to.x);
        int dy = Math.abs(endy - to.y);
        return new Double(Math.sqrt(dx * dx) + (dy * dy));
        //return new Double(Math.abs(endx - to.x) + Math.abs(endy - to.y));
    }

    @Override
    protected List<Node> generateSuccessors(Node node, Node parent) {
        List<Node> ret = new LinkedList<Node>();
        int x = node.x;
        int y = node.y;
        if (y < map[0].length - 1 && map[y + 1][x] == 1 && (parent == null || (parent != null && !(parent.x == x && parent.y == y + 1)))) {
            ret.add(new Node(x, y + 1));
        }

        if (x < map.length - 1 && map[y][x + 1] == 1 && (parent == null || (parent != null && !(parent.x == x + 1 && parent.y == y)))) {
            ret.add(new Node(x + 1, y));
        }

        if (y != 0 && map[y - 1][x] == 1 && (parent == null || (parent != null && !(parent.x == x && parent.y == y - 1)))) {
            ret.add(new Node(x, y - 1));
        }

        if (x != 0 && map[y][x - 1] == 1 && (parent == null || (parent != null && !(parent.x == x - 1 && parent.y == y)))) {
            ret.add(new Node(x - 1, y));
        }

        return ret;
    }

    public static void main(String[] args) {
        int ammountOfBlocks = 200;
        int width = 25;
        int length = 25;
        int startX = 1;
        int startY = 1;
        int endX = 24;
        int endY = 24;
        int[][] map = {
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1},
            {1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1},
            {1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1},
            {0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
            {1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0},
            {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1}
        };
        int a = map.length;
        int b = map[0].length;
        int[][] map2 = new int[b][a];
        for (int i = 0; i < map.length; i++) {
            for (int j = 0; j < map[0].length; j++) {
                map2[j][i] = map[i][j];
            }
        }
        PathFinder pf = new PathFinder(map, endX, endY);

        /*
         * for(int i = 0; i < map.length; i++){ for(int j = 0; j <
         * map[0].length; j++) System.out.print(map[i][j] + " ");
         * System.out.println(); }
         */

        long begin = System.currentTimeMillis();

        List<Node> nodes = pf.compute(new PathFinder.Node(startX, startY));

        long end = System.currentTimeMillis();

        System.out.println("Time = " + (end - begin) + " ms");
        //System.out.println("Expanded = " + pf.getExpandedCounter());
        System.out.println("Cost = " + pf.getCost());

        if (nodes == null) {
            System.out.println("No path");
        } else {

            for (int i = 0; i < nodes.size(); i++) {
                Node n = nodes.get(i);
                int x = n.getX();
                int y = n.getY();
                map[x][y] = 4;
            }

            for(int i = 0; i < map.length; i++){ 
                for(int j = 0; j < map[0].length; j++) 
                    System.out.print(map[i][j] + " ");

                System.out.println(); 
            }
        }
    }
} 
```

# c# - WPF OnMouse 从模板上移

> ID：15554519
> 
> 赞同：1
> 
> 时间：2013-03-21T17:43:40.950
> 
> 标签：c#, wpf

好的，所以我修改了选项卡控件模板以添加两个按钮，一个用于打开，一个用于与其他选项卡一起保存。

我需要做的是让按钮运行窗口内的 OpenSave/CloseSave 功能。每个窗口都有自己的打开和保存功能，因为它们会有所不同，这就是为什么我需要它来使用窗口内的功能。

```
<Style x:Key="EditorTabControl" TargetType="{x:Type TabControl}">
    <Setter Property="SnapsToDevicePixels" Value="True" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type TabControl}">
                <Grid SnapsToDevicePixels="True">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="0" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <Border Grid.Row="2" Panel.ZIndex="1" Background="#fafafa" Padding="10" BorderBrush="#ededed" BorderThickness="0 1 0 0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="Open" Style="{StaticResource EditorButtonStyle}"/>
                            <Button Content="Save" Style="{StaticResource EditorButtonStyle}"/>
                            <TabPanel IsItemsHost="True"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Row="0" BorderThickness="0" BorderBrush="#696969" Background="#FFF">
                        <ContentPresenter Content="{TemplateBinding SelectedContent}" />
                    </Border>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

那么我怎样才能让控制模板运行一个在它使用的窗口中的函数呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:57:06.717

您可以使用命令和绑定来执行此操作。您可以在主窗口中设置保存和关闭命令，然后使用RelativeSource 进行绑定。你可以有一个这样的窗口：

```
public partial class MainWindow : Window
{

    public MainWindow()
    {
        InitializeComponent();
    }

    public ICommand Open { get; set; }    //Need to implement, maybe could be a RelayCommand or DelegateCommand, you may search in the internet
    public ICommand Save { get; set; }
} 
```

在 xaml 代码中：

```
 <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="Open" Style="{StaticResource EditorButtonStyle}" Command="{Open, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/>
                        <Button Content="Save" Style="{StaticResource EditorButtonStyle}" Command="{Save, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/>
                        <TabPanel IsItemsHost="True"/>
                    </StackPanel> 
```

希望这可以帮助...

# php - oci_connect() 不会使用对象属性作为参数

> ID：15554520
> 
> 赞同：4
> 
> 时间：2013-03-21T17:43:45.117
> 
> 标签：php, database, oracle

参数（私有字符串）：

```
 $this->username = 'app';
    $this->password = 'passwd';
    $this->service = '//local/DEV'; 
```

不起作用：

```
 $conn = oci_connect($this->username,$this->password,$this->service); 
```

是否有效：

```
 $conn = oci_connect('app','passwd','//local/DEV'); 
```

为什么 oci_connect 不喜欢对象属性作为参数？使用对象属性时出现无效登录错误，但使用字符串时成功。所有这些代码都在对象的 __construct() 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:27:36.097

您`//localhost/DEV`在对象中但`//local/DEV`在字符串中，因此它们不是同一个服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:51:16.520

您是否尝试过使用 PDO 进行连接？我知道他们已经弃用了 oracle 上不确定的 mysql_ 扩展。

[http://www.php.net/manual/en/ref.pdo-oci.connection.php](http://www.php.net/manual/en/ref.pdo-oci.connection.php)

带有您的信息的片段：

```
$dbc = new PDO('oci:dbname=local/DEV;charset=CL8MSWIN1251', 'app', 'passwd'); 
```

# json - 使用 PERL 解析 JSON

> ID：15554522
> 
> 赞同：1
> 
> 时间：2013-03-21T17:43:55.343
> 
> 标签：json, perl, parsing

我想用 PERL 解析一个 JSON 字符串。
我的 JSON 字符串；

```
{"to_id": 0, "message": "This is a sample", "message_id": 1000, "from_id": 999} 
```

如何解析 JSON 并返回所有对象和值。
样本输出；

```
to_id: 0
message: This is a sample
message_id: 1000
from_id: 999 
```

没有 XML 输出以及单独变量中的对象和值 在

此先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:47:35.610

使用[`JSON`](http://search.cpan.org/perldoc?JSON)模块。以下是如何使用它的示例：

```
use strict;
use warnings;
use Data::Dumper;
use JSON;

my $str = q|{"to_id": 0, "message": "This is a sample", "message_id": 1000, "from_id": 999}|;

print Dumper from_json($str); 
```

**输出：**

```
$VAR1 = {
          'from_id' => 999,
          'message_id' => 1000,
          'to_id' => 0,
          'message' => 'This is a sample'
        }; 
```

# debugging - D7 用户注册后不发送邮件

> ID：15554526
> 
> 赞同：0
> 
> 时间：2013-03-21T17:44:06.613
> 
> 标签：debugging, email, drupal, registration

我在 Drupal 7.21 上有一个本地站点。问题是注册后它不发送邮件。它仍会发送“丢失密码”消息以及联系表单消息。为了调试它，我添加了一个 _mail_alter 来使用 dd() 和 dpm() 函数来跟踪消息。并将此代码添加到 settings.php： $conf['mail_system'] = array('default-system' => 'DevelMailLog',);

$message 不包含有关注册邮件的信息。**我该如何调试正在发生的事情？**

PS我不知道这是否重要。在配置页面（管理员/配置/人员/帐户）的注册和取消选项卡上，我选择了以下选项：访问者可以注册帐户，但在访问者创建帐户时需要电子邮件验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:59:57.140

确保还选中“激活帐户时通知用户”。它位于帐户设置配置页面 (admin/config/people/accounts) 上的帐户激活选项卡下。

如果您通过 admin/people/create 创建用户，则需要选中一个类似的复选框。

# couchbase - Couchbase XDCR 活动

> ID：15554530
> 
> 赞同：1
> 
> 时间：2013-03-21T17:44:16.100
> 
> 标签：couchbase

我在 AWS 上的 Server 2008 上运行的集群中有两台 Couchbase 2.0 服务器。我在自己的私有数据中心 (2008R2) 的集群中还有另外两台服务器。作为一个实验，我在 AWS 服务器和私有数据中心之间设置了 XDCR。

我正在复制两个桶，一个包含大约 5,000 个项目，另一个包含大约 650k 个项目。数据的总大小约为 2.5 gb 存储在磁盘上或 6 gb 存储在 RAM 中（不知道为什么会有如此大的差异，但这就是报告显示的内容 - 在以前的 CB 版本中，磁盘和内存大小大致相等）。

无论如何，目标集群（我的数据中心）显示连续活动（大约每秒 200 次操作），即使看起来所有项目都已被复制。源集群的活动要低得多（大约每分钟每秒爆发约 2k 个项目）。这是 CB 的正常行为，还是有问题？

我最终关闭了复制，因为我担心会产生不必要的数据传输成本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-07T15:02:01.933

我将作为后续发布，在安装最新版本的 Couchbase 后，此问题自行消失。这显然是一个 2.0 错误（众多错误之一），因此对于那些正在阅读的人，请始终确保您使用的是最新版本的 Couchbase，因为团队确实在版本之间进行了实质性改进。

# ruby-on-rails - Rails CSV.Parse 给出 Errno::EISDIR - 当解析的字符串包含目录名称时

> ID：15554532
> 
> 赞同：0
> 
> 时间：2013-03-21T17:44:36.837
> 
> 标签：ruby-on-rails, ruby

我在 index.html.erb 中有以下内容：

```
<% CSV.parse(thetest.tags) do |row| %>
   <% row.each do |a| %> 
      <div class="btn btn-primary btn-large"><%= a %></div>
    <% end %>
<% end %> 
```

这给了我以下错误，只有当'thetest.tags'包含一个名为'test'的字符串时，因为它是一个目录。

```
Errno::EISDIR in Tests#index
Is a directory - test
Extracted source (around line #9): 
```

ruby 代码有问题，还是我的 routes.rb 有问题？

编辑 1：此字符串 'tags' 中的任何其他值都有效，例如 'abc,apple,123'。只有在包含测试时才会出错，例如'test,any,other,value'。帕德无视任何东西，他没用。

# sql-server - SQL Server for xml 返回自定义 xml 格式？

> ID：15554536
> 
> 赞同：0
> 
> 时间：2013-03-21T17:44:43.987
> 
> 标签：sql-server, xml, sql-server-2008, xquery

我有以下 SQL

```
with X(x) as (select 'a' union select 'b' )
   , Y(y) as (select 1 union select 2 union select 3)
select x, y from X cross join Y
for xml path('') 
```

它返回

```
<x>a</x>
<y>1</y>
<x>a</x>
<y>2</y>
<x>a</x>
<y>3</y>
<x>b</x>
<y>1</y>
<x>b</x>
<y>2</y>
<x>b</x>
<y>3</y> 
```

是否可以让它返回

```
<a><y>1</y><y>2</y><y>3</y></a>
<b><y>1</y><y>2</y><y>3</y></b> 
```

或者

```
<x v="a"><y>1</y><y>2</y><y>3</y></x>
<x v="b"><y>1</y><y>2</y><y>3</y></x> 
```

或者也许我应该使用 xquery FLWOR 进行排列？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T17:56:47.143

如果你使用这个：

```
WITH X(x) AS (SELECT 'a' UNION SELECT 'b' )
   , Y(y) AS (SELECT 1 UNION SELECT 2 UNION SELECT 3)
SELECT
    x AS "@v",
    (SELECT y FROM Y 
     FOR XML PATH(''), TYPE)
FROM X 
FOR XML PATH('X') 
```

你应该得到一个输出：

```
<X v="a">
  <y>1</y>
  <y>2</y>
  <y>3</y>
</X>
<X v="b">
  <y>1</y>
  <y>2</y>
  <y>3</y>
</X> 
```

我不知道有什么方法可以将列 ( `a`) 的值用作 XML 输出 () 中的 XML 标记`<a>......</a>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T19:41:38.833

你可以试试这个来获得你的第一个结果集

```
create table #t1(id int)

insert into #t1
select 1 union select 2 union select 3

create table #row(ch char(1))
insert into #row
select 'a' union select 'b'

select cast ((
select(
select

'<' + cast(ch as varchar(max))  + '>',
(
select(
CAST(
(select id as 'Y' from #t1
for xml path(''), type
)as varchar(max)
)
)
)
,
'</' + cast(ch as varchar(max))  + '>'
from #row
for xml path(''),root('root'), type
).value('/root[1]','varchar(max)')
) as xml) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:58:59.570

这里查询第一个结果。

```
select cast('<'+x+'>' + 
               (
               select y 
               from Y 
               for xml path('')
               ) + 
             '</'+x+'>' 
       as xml) 
from X
for xml path('') 
```

这有点冒险，因为其中的所有值`x`都必须是有效的 XML 元素名称。

# javascript - Requirejs 并避免污染全局范围

> ID：15554541
> 
> 赞同：1
> 
> 时间：2013-03-21T17:44:53.103
> 
> 标签：javascript, module, requirejs

我想我不太了解 Require.js，所以我想问一下为什么我可以像下面的示例（全局）那样更改 firstName 和 lastName。

Require.js 不应该做一些避免污染全局范围的事情吗？我只是提供用于创建对象的接口，而不是用于更改其内容。非常感谢。

```
// someModule.js
define([], function() {
    function Employee(firstName, lastName) {
        this.firstName = firstName;
        this.lastName = lastName;        
    }

    Employee.prototype.getName = function() {
        return this.firstName = ' ' = this.lastName;
    }

    return {
        createEmployee: function(fName, lName) {
            return new Employee(fName, lName);
        };
    };
});

// main.js
require(['jquery', 'someModule'], function($, someModule) {
    $(function() {
        var x = someModule.createEmployee('John', 'Doe');
        document.write(x.getName() + '<br>');
        x.firstName = 'Some other name';
        x.lastName = 'Some other surname';
        document.write(x.getName());
    });
}); 
```

输出是：
John Doe
Some other name Some other surname

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:54:18.677

我认为您将全局泄漏与属性的可见性混淆了。 `firstName`并且`lastName`不会*泄露*- 它们只是可公开访问和修改（可变）。如果你想隐藏它们，你可以这样做：

```
function Employee(firstName, lastName) {    
    this.getFirstName = function () { return firstName; };
    this.getLastName = function () { return lastName; };
}

Employee.prototype.getName = function () {
     return this.getFirstname() + ' ' + this.getLastName();
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:48:51.990

您在这里没有污染任何全局范围-您的代码在匿名函数（闭包）内运行，并且没有任何内容绑定到窗口全局对象-所以很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T17:50:17.470

您创建的对象具有属性“firstName”和“lastName”。您的代码没有采取任何措施来阻止对这些属性的修改。

在较新的 JavaScript 实现中，有一些方法可以做到这一点，但 Requirejs 不会自动做到这一点（至少在没有重大重新设计或增强项目的情况下不会）。

具体来说，该[`defineProperty`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)方法允许您创建只读属性。现在，这将阻止*所有*代码修改属性。如果您想要受对象控制的属性，您可以使用@c24w 在另一个答案中建议的技术。

# jquery - 动态向 div 添加消息

> ID：15554542
> 
> 赞同：0
> 
> 时间：2013-03-21T17:44:53.423
> 
> 标签：jquery

我正在使用 jquery 动态添加消息，唯一的问题是我想从底部删除与顶部添加的消息数量相同的消息，我目前使用的代码是：

```
$(html).hide().prependTo("#current center").fadeIn("slow"); 
```

目前我需要用`table.msgtable`inside html 来检查 div 的数量才能得到`A`. `#current center`然后查看里面得到的 div 消息的数量`B`。

那么`$(".info #current>center>div").slice(B-A)`显然。这是解决此问题的有效方法吗？我在获取`A`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:47:23.350

尝试使用：

```
$("#current>center>div:gt(5)").remove(); 
```

将 5 替换为比您想要的最大消息数少 1。

另外，一个 <center> 标签？哎呀！

# html - 为什么在“POST”或“GET”请求之后，Django 模板中缺少一个“新行”？

> ID：15554545
> 
> 赞同：3
> 
> 时间：2013-03-21T17:45:03.647
> 
> 标签：html, textarea, html-parsing

表单验证后，我的 textarea 丢失了第一行。

显示 textarea 的结果页面与用户输入数据的页面对应相同的视图和模板。换句话说，页面是相同的。

在我的代码中，我有这样的东西：

```
if request.method == 'POST':
    f = MyForm( request.POST )
    if f.is_valid(): # f is a form
        context.update( value = f.cleaned_data[ 'value' ] )
        # then 'value' becomes a 'value' context variable for a template. 
```

来自模板的片段：

```
...
<textarea name='value'>{{value}}</textarea> 
<!-- It's a template for a result page -->
... 
```

有趣的是，如果 textarea 在开头有许多 '\n' 行，那么对于每个 'POST' 请求，它会在结果页面中丢失其中一个（并且**只有**其中一个），其中在 textarea 中显示发布的数据。

任何人都可以帮忙吗？如何在不修改代码的情况下解决问题？

我希望 textarea 显示用户在前一页输入的所有开头的 '\n' 行。

**更多**。

数据通常来自客户端 - 如果我们在视图中输出“值”，则不会丢失任何换行符。问题是在模板中进一步显示。

环境：Windows、Firefox/Opera。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:09:40.610

你确定这是 Django 特有的吗？

```
<html>
<body>
<textarea>`[CR]LF`
`[CR]LF`
test</textarea>    
</body>
</html> 
```

当另存为普通 .html 文件时，我的浏览器中只有一个换行符。浏览器将第一个换行符视为“HTML 代码格式”，而不是值的一部分。

**编辑**

您应该可以通过像这样修改模板来解决此问题：

```
<textarea name='value'>
{{value}}</textarea> 
<!-- It's a template for a result page --> 
```

只有第一个之后的换行符显示在框中（即，如果有 3，则获得 2，如果有 2，则获得 1，如果有 1，则获得 0，如果有 0，则再次获得 0）。这是因为浏览器会使用第一个换行符作为标签的一部分，因此将模板更改为已经包含第一个换行符应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:31:40.727

我认为浏览器会忽略 /n 作为 html 中的新行渲染文本？html 使用

```
<br> 
```

换一条新线。要呈现文本块，您可以将其作为列表包含在表单中，其中每行数据都是一个新的列表项，然后使用以下方法在模板中呈现它：

```
{{ text_list|join:"<br>"}} 
```

/n 将保留在您的文本中，因此您仍然可以将其用于正则表达式等...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-07T18:59:45.600

你能试试下面的代码吗，我遇到了类似的问题，这就是我解决它的方法。

```
<pre>{{text_list|safeseq|join:"\r\n"}}</pre> 
<p>{{text_list|safeseq|join:"\n"}}</p>
<p><pre>{{text_list|safeseq|join:"\r\n"}}</p> 
```

LMK

# matlab - 使用自动相关的回声消除器

> ID：15554550
> 
> 赞同：1
> 
> 时间：2013-03-21T17:45:19.567
> 
> 标签：matlab

我通过首先使用自动相关找到回声信号的参数来实现回声消除器。我的信号有多次延迟。使用 s=xcorr(x,x) 后，如何提取 s 的峰值？max 函数给出 s 中心的值，findpeaks() 给出紧邻最大峰值但高于实际延迟峰值的峰值值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T03:25:47.973

**简而言之**

将 findpeaks 与 SORTSTR 应用于自相关的平滑版本。

**更多的话**

这实际上取决于您的信号有多嘈杂，但您的问题的快速解决方案是首先平滑您的自相关以限制噪声的影响，这可能会在感兴趣的峰值周围引入多个局部最大值。然后，您可以按降序排列峰值。

其他可以使用和可能组合的选项：

*   'MINPEAKHEIGHT' 查找高于阈值的峰值（比如高于自相关最大值的 10%）
*   'MINPEAKDISTANCE' 避免局部最大值彼此太近

或者只是编写您自己的代码，这是您最终可能需要做的事情，以使代码完全按照您的意愿行事。

**在代码中：**

```
% Create right portion of autocorrelation of a sinusoid with some noise
% This should lead to peaks of decreasing amplitude around positions 1, 26, 51, 76
% Note: This is a quick example.  A more realistic signal would show better peaks.
x=.4*sin(2*pi*(1:N)/N*4)+rand(1,N);
autocorr=xcorr(x);
autocorr=autocorr(N:(2*N-1));

% Smooth out the autocorrelation
autocorrFiltered=filter([1 1 1 1 1],[1],autocorr);
subplot(2,1,1);
plot(autocorr);
xlabel('Autocorrelation')
subplot(2,1,2);
plot(autocorrFiltered);
xlabel('Smoothed autocorrelation')
[peaks,locations]=findpeaks(autocorrFiltered,'SORTSTR','descend');

% Display locations, correcting for the filter offset
locations-3
ans =

      2    23    49    73    92 
```

**在图像中：**

这是过滤器和未过滤的自动校正的并排比较，说明了为什么平滑有助于找到峰值。

![在此处输入图像描述](../Images/b0849e9c613c88965c2acc5d2ea1c741.png)

# haskell - 将单子绑定到复合材料中（Haskell）

> ID：15554551
> 
> 赞同：5
> 
> 时间：2013-03-21T17:45:22.507
> 
> 标签：haskell, bind, monads, composite

美好的一天，伙计们。我正在寻求对 monads 的一些澄清，请使用 bind （在进入组合时`.`）。

所以对于这个例子：

```
--Monadic parts:
readFile :: String -> IO File
putStr :: String -> IO()
-- Non monadic parts
toMatrix :: String -> CustomMatrix
toString :: CustomMatrix -> String 
```

本质上，我懒惰地读取文件 ( `readFile`)，然后生成自定义矩阵，将矩阵转换为字符串输出。然后返回。

```
fileReading :: String -> IO
fileReading file = putStr(toString . toMatrix . readFile file) 
```

这是我开始使用 bind `>>=`to go from 来制造混乱的时候`readFile file`。有没有一种方法可以让我继续使用合成`.`并绑定和组合而不会造成难以理解的混乱（这不是我的真正目标）。

与往常一样，我们将不胜感激地接受任何帮助。谢谢各位。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T18:06:23.043

在此示例中，如果不使用*某些*单子函数（如），您将无法逃脱。`>>=`如果您实际上想要最终执行一些 IO，则不能使用具有 IO 值的普通函数组合。

令人高兴的是，您仍然可以相当可读地编写代码：

```
fileReading file = readFile file >>= putStr . toString . toMatrix 
```

这是可行的，因为这两个`.`操作将两个非 IO 函数与一个最终 IO 函数结合在一起。此时，您有两个 IO 值：一个`IO String`和一个`String -> IO ()`函数（整个`putStr . toString . toMatrix`表达式具有该类型）。这正是`>>=`需要的，所以你都准备好了。

如果您希望代码具有与上述相同的顺序，则可以使用向后绑定运算符：

```
fileReading file = putStr . toString . toMatrix =<< readFile file 
```

有些人发现这个版本更具可读性，因为所有代码都在同一个方向“流动”。

# iphone - 如何设置 UISegmentControl 的 tintColor 使结果看起来像特定颜色？

> ID：15554557
> 
> 赞同：0
> 
> 时间：2013-03-21T17:45:38.747
> 
> 标签：iphone, uisegmentedcontrol

我喜欢将 UISegmentControl 的选定段设置为按钮背景的颜色。

所以我这样做了：

```
UIColor *selectedC = [_myBtn backgroundColor]; 
```

然后像这样设置色调

```
 [[[mySC subviews] objectAtIndex:1] setTintColor:selectedC]; 
```

但是结果看起来不同（当然），因为这是色调颜色而不是结果颜色。

有趣的是，使用 selectedC 设置段 0 或段 1 会产生相同的颜色（这很好）。

我只需要知道如何 - 设置段控件的颜色，以便结果实际上是我的按钮的颜色，或者 - 找出必须使用的正确色调颜色，以便具有色调颜色的段看起来像我的按钮

我希望有某种“向后”逻辑来找出特定输出颜色的色调颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T23:25:42.813

..事实上，错误不在于代码签名，而在于该方案有 2 个目标而不是一个。

我什至不知道这是可能的。将方案更正为仅包含 C 目标后一切正常。

# java - 计算裁剪java的图像区域

> ID：15554558
> 
> 赞同：3
> 
> 时间：2013-03-21T17:45:45.177
> 
> 标签：java, image, crop

我正在尝试根据动态绘制的正方形裁剪图像。为了准确裁剪绘制的正方形，我（在裁剪之前）调整图像大小以适合面板宽度和高度，以便面板上绘制的每个矩形都应与物理图像上相同正方形的点值完全对应。

首先，这种实现方式有问题吗？如果不是，那么尽管有这个调整大小的步骤，结果裁剪的矩形总是“移动”几个（像素？英寸？）对。

我认为由于我使用的图像魔法的命令“调整大小”适用于像素，并且拖动的正方形与屏幕点值一起使用，因此会导致问题。关于如何在它们之间进行转换的任何想法？尽管我真的很努力地用不同的方式来解决它，但我会非常感激。

这是相关代码：

```
public void resizeImage(int panelW){
        int percent;
        String sign;
        float imgW=img.getWidth(null);

        percent=(int) (((panelW-imgW)/imgW)*100);
        sign="+resize";
        if(panelW <imgW){
            percent=(int)(((imgW-panelW)/panelW)*100);
            sign="-resize";
        }

        String command="convert "+imagePath+" "+sign+" "+percent+"% "+imagePath;

       //...executeCommand(command) and repaint();

    } 
```

*   在裁剪之前，我也尝试过调整图像大小：

    ```
    Dimension newImagesize=getScaledDimension();
      String command="convert"+imagePath+"-resize"+newImagesize.width+"X"+newImagesize.height+" "+imagePath 
    ```

其中 getScaledDimension() 取自这里：[Java 图像调整大小，保持纵横比](https://stackoverflow.com/questions/10245220/java-image-resize-maintain-aspect-ratio)

然后我只上传调整大小的图像，它应该具有这样的面板尺寸：

```
img= new ImageIcon(imgPath).getImage();
repaint(); 
```

正如我所说，裁剪后的图像总是有一些像素（？）向右移动，所以我认为我所做的 resizeImage() 测量存在问题，但它对我来说是合乎逻辑的..

裁剪功能使用调整大小：

```
Rectangle r=resizer.getBounds();
            try {
                String x="",y="";
                if(r.x>0)x="+"+r.x;
                if(r.y>0)y="+"+r.y;

                cropImage(r.width, r.height, x, y); 
```

并使用裁剪 ImageMagick 命令。

# php - 带有 preg_replace 的简单 php 正则表达式

> ID：15554559
> 
> 赞同：1
> 
> 时间：2013-03-21T17:45:50.827
> 
> 标签：php, regex, preg-replace

我有这个字符串：

```
$string = '<div class="displayEmbededImage" sourcefile="http://site.com/images/myImage.jpg" style="width:200px;"><p>Some text goes here</p></div>'; 
```

我需要一个正则表达式，它将选择源文件的内容并像这样返回它：

```
$parern = '/<div(.*)sourcefile="([^"]+)"(.*)>(.*)<\/div>/s';
preg_replace($pattern, '<img src="$1">', $string); 
```

这就是我到目前为止所拥有的，但还没有完全正确

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T17:50:02.420

您不要**在**html 上使用正则表达式。甚至不要尝试。改用 DOM：

```
$d = new DOMdocument();
$d->loadHTML('... your html here ...');
$xp = new DOMXpath($d);
$res = $xp->query('//div[@class="displayEmbededImage"]');
$source = $res->item(0)->getAttribute('sourcefile'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T17:50:00.793

您的变量名中有错字，并且您没有使用正确的占位符：

```
echo preg_replace($parern, '<img src="$2">', $string); 
```

# c++ - 强制 GCC 执行 memcpy 运行时大小检查的循环取消切换？

> ID：15554565
> 
> 赞同：28
> 
> 时间：2013-03-21T17:46:20.210
> 
> 标签：c++, c, performance, compiler-optimization, memcpy

是否有任何可靠的方法可以强制 GCC（或任何编译器）在`memcpy()`循环外部排除运行时大小检查（其中该大小不是编译时常量，而是该循环内的常量），针对每个相关大小范围专门循环而不是反复检查里面的大小？

这是一个测试用例，从[这里](https://github.com/pydata/pandas/issues/3089)报告的性能回归中减少，这是一个开源库，旨在对大型数据集进行有效的内存分析。[（回归恰好是因为我的一个提交......）]

原始代码在 Cython 中，但我已将其简化为纯 C 代理，如下所示：

```
void take(double * out, double * in,
          int stride_out_0, int stride_out_1,
          int stride_in_0, int stride_in_1,
          int * indexer, int n, int k)
{
    int i, idx, j, k_local;
    k_local = k; /* prevent aliasing */
    for(i = 0; i < n; ++i) {
        idx = indexer[i];
        for(j = 0; j < k_local; ++j)
            out[i * stride_out_0 + j * stride_out_1] =
            in[idx * stride_in_0 + j * stride_in_1];
    }
} 
```

步幅是可变的；通常，甚至不能保证数组是连续的（因为它们可能是较大数组的不连续切片。）但是，对于 c 连续数组的特殊情况，我已将上述优化为以下内容：

```
void take(double * out, double * in,
          int stride_out_0, int stride_out_1,
          int stride_in_0, int stride_in_1,
          int * indexer, int n, int k)
{
    int i, idx, k_local;
    assert(stride_out_0 == k);
    assert(stride_out_0 == stride_in_0);
    assert(stride_out_1 == 1);
    assert(stride_out_1 == stride_in_1);
    k_local = k; /* prevent aliasing */
    for(i = 0; i < n; ++i) {
        idx = indexer[i];
        memcpy(&out[i * k_local], &in[idx * k_local],
               k_local * sizeof(double));
    }
} 
```

（原始代码中不存在断言；相反，它会检查连续性并在可能的情况下调用优化版本，如果不是，则调用未优化版本。）

这个版本在大多数情况下优化得非常好，因为对于 small`n`和 large的正常用例`k`。然而，相反的用例也确实发生了（大`n`和小`k`），事实证明，对于`n == 10000`and的特定情况`k == 4`（不能排除它代表假设工作流的重要部分），`memcpy()`版本是 3.6 倍比原来慢。显然，这主要是因为它`k`不是编译时常数，这一事实证明了下一个版本的性能（几乎或完全取决于优化设置）以及原始版本（或有时更好），对于特殊情况`k == 4`：

```
 if (k_local == 4) {
        /* this optimizes */
        for(i = 0; i < n; ++i) {
            idx = indexer[i];
            memcpy(&out[i * k_local], &in[idx * k_local],
                   k_local * sizeof(double));
        }
    } else {
        for(i = 0; i < n; ++i) {
            idx = indexer[i];
            memcpy(&out[i * k_local], &in[idx * k_local],
                   k_local * sizeof(double));
        }
    } 
```

显然，为 的每个特定值硬编码一个循环是不切实际的`k`，所以我尝试了以下方法（作为第一次尝试，如果它有效，以后可以推广）：

```
 if (k_local >= 0 && k_local <= 4) {
        /* this does not not optimize */
        for(i = 0; i < n; ++i) {
            idx = indexer[i];
            memcpy(&out[i * k_local], &in[idx * k_local],
                   k_local * sizeof(double));
        }
    } else {
        for(i = 0; i < n; ++i) {
            idx = indexer[i];
            memcpy(&out[i * k_local], &in[idx * k_local],
                   k_local * sizeof(double));
        }
    } 
```

不幸的是，最后一个版本并不比原始`memcpy()`版本快，这让我对 GCC 优化能力的信心有些沮丧。

有什么方法可以给 GCC 额外的“提示”（通过任何方式），这将帮助它在这里做正确的事情？（更好的是，是否有“提示”可以可靠地跨不同的编译器工作？这个库是为许多不同的目标编译的。）

引用的结果适用于带有“-O2”标志的 32 位 Ubuntu 上的 GCC 4.6.3，但我也测试了具有相似（但不相同）结果的 GCC 4.7.2 和“-O3”版本。我已经将我的测试工具发布到[LiveWorkspace](http://liveworkspace.org/code/4kWT1T)，但是时间来自我自己的机器使用`time(1)`命令（我不知道 LiveWorkspace 时间有多可靠。）

**编辑：**我也考虑过为一些最小尺寸设置一个“幻数”来调用`memcpy()`，我可以通过重复测试找到这样一个值，但我不确定我的结果在不同编译器/平台上的通用性如何. 我可以在这里使用任何经验法则吗？

**进一步编辑：**实际上，在这种情况下，意识到`k_local`变量是无用的，因为不可能有别名；这是从我在可能的地方（`k`是全球性的）进行的一些实验中减少的，我忘记了我改变了它。忽略那部分。

**编辑标签：**意识到我也可以在较新版本的 Cython 中使用 C++，所以标记为 C++，以防 C++ 有任何帮助...

**最终编辑：**代替（现在）下降到专业`memcpy()`的组装，以下似乎是我本地机器的最佳经验解决方案：

```
 int i, idx, j;
    double * subout, * subin;
    assert(stride_out_1 == 1);
    assert(stride_out_1 == stride_in_1);
    if (k < 32 /* i.e. 256 bytes: magic! */) {
        for(i = 0; i < n; ++i) {
            idx = indexer[i];
            subout = &out[i * stride_out_0];
            subin = &in[idx * stride_in_0];
            for(j = 0; j < k; ++j)
                subout[j] = subin[j];
        }
    } else {
        for(i = 0; i < n; ++i) {
            idx = indexer[i];
            subout = &out[i * stride_out_0];
            subin = &in[idx * stride_in_0];
            memcpy(subout, subin, k * sizeof(double));
        }
    } 
```

这使用“幻数”来决定是否调用`memcpy()`，但仍然优化已知连续的小数组的情况（因此在大多数情况下它比原始数组更快，因为原始数组没有做出这样的假设）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T00:45:24.473

最终，手头的问题是要求优化器基于多个变量对运行时行为做出假设。虽然可以通过在关键变量上使用 'const' 和 'register' 声明来为优化器提供一些编译时提示，但最终，您要依赖优化器来做出很多假设。此外，虽然 memcpy() 很可能是内在的，但不能保证它是内在的，即使/当它是，实现可能会有很大的不同。

如果目标是实现最大性能，有时您不必依赖技术来为您解决问题，而是直接进行。对于这种情况，最好的建议是使用内联汇编程序来解决问题。这样做可以让您避免“黑盒”解决方案与编译器和优化器的启发式方法互补的所有缺陷，并有限地陈述您的意图。使用内联汇编程序的主要好处是能够在解决内存复制问题时避免任何推送/弹出和无关的“泛化”代码，并且能够直接利用处理器解决问题的能力。不利的一面是维护，但考虑到您确实只需要解决英特尔和 AMD 即可覆盖大部分市场，这并非不可克服。

我还可以补充一点，如果/当可以并行复制并真正获得性能提升时，该解决方案可以很好地让您利用多个内核/线程和/或 GPU。虽然延迟可能会更高，但吞吐量也很可能会更高。例如，如果您可以在 GPU 存在时利用其优势，那么您可以在每个副本中启动一个内核，并在一次操作中复制数千个元素。

替代方法是依靠编译器/优化器为您做出最佳猜测，使用“const”和“register”声明，您可以在其中提供编译器提示并使用幻数基于“最佳解决方案”进行分支路径...但是，这将非常依赖于编译器/系统，并且您的里程会因平台/环境而异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T22:06:29.463

**SSE/AVX 和对齐**

例如，如果您使用的是现代英特尔处理器，则可以选择使用 SSE 或 AVX 指令。虽然不是专门关于 GCC，但请参阅[此](https://stackoverflow.com/questions/613294/fully-optimized-memcpy-memmove-for-core-2-or-core-i7-architecture)如果您有兴趣并刷新缓存，我认为英特尔为 Linux 和 Windows 提供了他们的编译器套件版本，我猜它带有自己的库套件。

还有这个[帖子](https://lkml.org/lkml/2011/9/1/229)。

**线程 (eek)**

我最近就遇到过这类问题，memcpy() 花费了太多时间。在我的例子中，它是一个大的 memcpy() （1MByte 左右），而不是像你正在做的很多较小的。

通过编写我自己的多线程 memcpy()，我获得了非常好的里程，其中线程是持久的，并且通过调用我自己的 pmemcpy() 函数获得了一份工作的“任务”。持久线程意味着开销非常低。我得到了 4 核的 x4 改进。

因此，如果可以将您的循环分解为合理数量的线程（我为每个可用核心选择一个），并且您的机器上有几个备用核心，您可能会获得类似的好处。

**实时人群做什么 - DMA**

顺便说一句，我有幸玩弄一些相当奇特的 OpenVPX 硬件。基本上它是一个大盒子里的一堆板，它们之间有一个高速串行RapidIO互连。每块板都有一个 DMA 引擎，可将数据通过 sRIO 驱动到另一块板的内存。

我去的那个供应商在如何最大限度地利用 CPU 方面非常聪明。聪明的一点是 DMA 引擎非常聪明——它们可以被编程来做一些事情，比如动态矩阵转换、剥离挖掘、你想要做的事情等等。而且因为它是一个单独的硬件，所以 CPU在此期间没有被捆绑，因此可以忙于做其他事情。

例如，如果您正在执行诸如合成孔径雷达处理之类的事情，那么您最终总是会进行大矩阵变换。美妙之处在于，转换本身完全不需要 CPU 时间——您只需将数据移动到另一块板上，它就已经转换了。

无论如何，从这类事情中受益确实让人希望英特尔 CPU（和其他 CPU）具有能够工作内存内存而不仅仅是内存外围设备的板载 DMA 引擎。这将使像您这样的任务非常快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-22T13:49:07.210

我认为最好的方法是试验并找出最佳的“k”值，以便在原始算法（带有循环）和使用 memcpy 的优化算法之间切换。最佳的“k”会因不同的 CPU 而异，但不应有太大的不同；本质上它是关于调用 memcpy 的开销，memcpy 本身在选择最优算法（基于大小、对齐等）与带有循环的“幼稚”算法时的开销。

memcpy 是 gcc 的内在属性，是的，但它并没有什么魔力。它的基本作用是，如果 size 参数在编译时已知并且很小（我不知道阈值是多少），那么 GCC 将用内联代码替换对 memcpy 函数的调用。如果在编译时不知道 size 参数，将始终调用库函数 memcpy。

# c# - 如何从 Iframe 打开重定向页面以在 ASP.NET 的父窗口中作为新选项卡打开？

> ID：15554568
> 
> 赞同：0
> 
> 时间：2013-03-21T17:46:55.067
> 
> 标签：c#, asp.net, iframe, tabs

我目前有：

```
 String url = "../CustomerSettings/CustomerConfiguration.aspx?CustomerID=" + sqlCommand.Parameters["@ReturnCustomerID"].Value.ToString();

        this.Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "myUniqueKey", "self.parent.location='"+url+"';", true); 
```

这非常适合重定向父页面，但我需要它来打开一个新标签。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:57:06.657

像这样的东西应该工作：

```
this.Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "myUniqueKey", "window.open(" + url + ",'_blank');", true); 
```

# python - 记录所有流量的扭曲代理

> ID：15554572
> 
> 赞同：1
> 
> 时间：2013-03-21T17:47:07.167
> 
> 标签：python, proxy, twisted

我正在尝试在 Twisted 中编写一个代理来记录所有通过它的双向流量。到目前为止，我可以捕获请求（GET、POST 等），但不能捕获响应（看不到网页的 html）。

```
from twisted.web import proxy, http
from twisted.internet import reactor
from twisted.python import log
from twisted.protocols import basic
#log.startLogging(sys.stdout)

class MyProxy(proxy.Proxy):
    def dataReceived(self, data):
        # Modify the data here
        print data
        # perform the default functionality on modified data 
        return proxy.Proxy.dataReceived(self, data)

class ProxyFactory(http.HTTPFactory):
        #protocol = proxy.Proxy
        protocol=MyProxy

reactor.listenTCP(8080, ProxyFactory())
reactor.run() 
```

# performance - 将 R 向量有效缩减为汇总向量

> ID：15554573
> 
> 赞同：0
> 
> 时间：2013-03-21T17:47:11.680
> 
> 标签：performance, r, vector, reduction

我正在尝试对一个序列进行模拟，该序列的长度为 N（在 10k 和 3M 之间变化），由一个向量表示，该向量具有 n 个 1 和 s 0，其中 N = n+s。

我想将其简化为 c( 137, 278, 21271, 124162, ... ) 形式的向量，其中数字是原始向量中连续 1 的数量。因为我需要为我正在做的模拟做这大约 100,000 次，所以我正在寻找一种尽可能有效的方法！

谢谢！

马丁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:53:16.710

你可以`rle`用来得到那个

```
x <- sample(c(1, 0), size = 3e+06, replace = TRUE)
x.rle <- rle(x)
x.rle
## Run Length Encoding
##   lengths: int [1:1499270] 4 1 2 3 4 1 1 3 1 4 ...
##   values : num [1:1499270] 0 1 0 1 0 1 0 1 0 1 ...

vectorOf1 <- x.rle$lengths[x.rle$values == 1]
vectorOf2 <- x.rle$lengths[x.rle$values == 0]

head(vectorOf1, 20)
##  [1] 1 3 1 3 4 3 1 1 1 4 4 2 3 1 1 4 1 1 1 1

head(vectorOf2, 20)
##  [1] 4 2 4 1 1 1 1 5 2 2 2 1 3 3 7 2 1 1 1 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:53:02.243

该`rle`函数是执行此操作的常用方式。

# .net - WF4 sql 持久性错误

> ID：15554575
> 
> 赞同：0
> 
> 时间：2013-03-21T17:47:15.970
> 
> 标签：.net, workflow-foundation-4

我正在尝试在我的工作流程中使用 SQLPersistence。我关注的文档是[http://msdn.microsoft.com/en-us/library/ee395773(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ee395773(v=vs.100).aspx)

当我调用工作流时，我不断收到错误“过程或函数'CreateLockOwner'需要参数'@serviceDeploymentHash'，它没有提供。”

谷歌搜索了这个，但我找不到任何解决方案。

# python - 卷与实例不在同一可用区

> ID：15554578
> 
> 赞同：0
> 
> 时间：2013-03-21T17:47:19.437
> 
> 标签：python, amazon-web-services, amazon-ec2, volume, boto

我试图在我的代码中找到一个错误，所以我创建了一个实例，而不是试图将一个卷附加到这个实例，但是得到错误：`The volume 'vol-fc61968f' is not in the same availability zone as instance`，这清楚地表明区域不同我试图将可用区域放入`a_zone`变量中，但不幸的是，它不起作用，所以请告诉我我的问题是什么

```
>>> a_zone = instance.placement
>>> a_zone
us-east-1c
>>> ec2.create_volume(2,a_zone)
Volume:vol-7957a00a
>>> 
>>> volume.zone
us-east-1d 
```

# 更新

我这样做了：

```
>>> dir(instance)
['__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_in_monitoring_element', '_placement', '_previous_state', '_state', '_update', 'add_tag', 'ami_launch_index', 'architecture', 'block_device_mapping', 'client_token', 'confirm_product', 'connection', 'create_image', 'dns_name', 'ebs_optimized', 'endElement', 'eventsSet', 'get_attribute', 'get_console_output', 'group_name', 'groups', 'hypervisor', 'id', 'image_id', 'instance_profile', 'instance_type', 'interfaces', 'ip_address', 'item', 'kernel', 'key_name', 'launch_time', 'modify_attribute', 'monitor', 'monitored', 'monitoring', 'persistent', 'placement', 'placement_group', 'placement_tenancy', 'platform', 'previous_state', 'previous_state_code', 'private_dns_name', 'private_ip_address', 'product_codes', 'public_dns_name', 'ramdisk', 'reason', 'reboot', 'region', 'remove_tag', 'requester_id', 'reset_attribute', 'root_device_name', 'root_device_type', 'spot_instance_request_id', 'start', 'startElement', 'state', 'state_code', 'state_reason', 'stop', 'subnet_id', 'tags', 'terminate', 'unmonitor', 'update', 'use_ip', 'virtualization_type', 'vpc_id']
>>> instance.placement
us-east-1c
>>> instance.placement.zone
Traceback (most recent call last):
  File "/usr/lib/gedit/plugins/pythonconsole/console.py", line 383, in __run
    r = eval(command, self.namespace, self.namespace)
  File "<string>", line 1, in <module>
AttributeError: 'unicode' object has no attribute 'zone'
>>> 
```

# prolog - 列表中的错误字母 - Prolog

> ID：15554581
> 
> 赞同：0
> 
> 时间：2013-03-21T17:47:28.173
> 
> 标签：prolog

我需要做以下事情：我有活动

```
word([p,r,o,l,o,g]).
word([p,r,o,l,o,g]). 
```

我需要找出错误的字母：

```
e.x wrong_letter([p,r,o,l,o,u,g],X).<br>
X=u 
```

这是我的程序，但不工作：

```
wrong_letter([X|Y],L) :- 
word(H),
member(X,H),
wrong_letter(Y,L). 
```

在此先感谢，对不起我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:12:27.543

如果您输入的单词中只有一个错误的字母（添加的字母），您可以：

*   说一句话
*   拆分为两个子列表（头和尾），使用`append/3`
*   测试您输入的单词是否与头部、添加的字母和尾部统一；再次使用`append/3`

那看起来：

```
wrong_letter(WrongWord, Letter):-
  word(Word),
  append(Head, Tail, Word),
  append(Head, [Letter|Tail], WrongWord). 
```

测试：

```
?- wrong_letter([p,r,o,l,o,u,g], X).
X = u ; 
```

您还可以使用以下方法实现相同的效果`select/3`：

```
wrong_letter(WrongWord, Letter):-
  word(Word),
  select(Letter, WrongWord, Word). 
```

# c++ - 在 C++ 中使用 stl 处理矩阵

> ID：15554585
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:47:36.907
> 
> 标签：c++, map, stl

给定一个非空的数字数组。显示此数组中最常见的数量。

```
#include <iostream>
    #include <map>
    #include <algorithm>
    #include <clocale>
    #include <iterator>

    int main()
    {
        setlocale(LC_ALL, "");
        const int size = 5;
        int array[size];
        for (int i = 0; i < size; i++)
            std::cin >> array[i];
        std::map<int, int> map;
        for (int i = 0; i < size; i++)
            map[array[i]] = std::count(std::begin(array), std::end(array), array[i]);
        std::cout<< "The most common element: " << map.begin()->first << std::endl;
        std::sort(std::begin(array), std::end(array));
        std::cout << "Sorting array: \n";
        std::copy(std::begin(array), std::end(array), std::ostream_iterator<int>(std::cout, " "));
        std::cout<< std::endl;

    } 
```

如果是二维数组，我可以重写这样的程序吗？我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T22:35:34.297

您的原始程序不起作用，它只打印输入中的最小数字，因为 std::map 按键排序，您`array[i]`用作地图的键，您只需打印`.first`第一个元素（`.begin()`）的键（）地图。

要将代码转换为二维，请使用 a`std::pair<int,int>`作为键而不是单个 int。所以你的地图会变成：

```
std::map<std::pair<int,int>,int> map; 
```

在您的原始代码中，您为每个元素调用 std::count 。这不是必需的，您可以简单地增加该特定值的 map-element 。假设您有一个二维值数组，请使用以下公式计算每个值出现的次数：

```
int array[SIZE][2];
...
for (i=...) {
    ++map[std::make_pair(array[i][0],array[i][1])];
} 
```

然后，您可以使用`std::max_element`比较函数来比较`second`容器元素的元素（计数）以找到最常见的元素。需要一个特殊的比较函数，因为`value_type`a`std::map`是`std::pair<K,V>`where`K`并且`V`分别是 Key 和 Value。

# timestamp - 时间戳：iso8601 vs unix 时间戳

> ID：15554586
> 
> 赞同：26
> 
> 时间：2013-03-21T17:47:38.753
> 
> 标签：timestamp, iso8601, unix-timestamp

我知道这是一个很常见的问题，但我觉得我找到的答案并不能真正解决问题。我将概述我的具体用例，并总结来自其他 SO 答案和网络上的信息。

对于我正在编写的服务，数据库条目是在移动设备和我们的网站上创建和存储的，并且需要双向同步。我们目前的目标是 Android 和 iOS，它们都使用 sqlite 作为关系数据库。服务器端是在 Python 中使用 Django 和 MySQL 实现的，但其他解决方案可能会在未来取代它。

将按照此 SO 答案中概述的想法实施同步：[https](https://stackoverflow.com/a/5052208/2076094) ://stackoverflow.com/a/5052208/2076094 。对于同步，我们将使用仅由服务器设置并同步到客户端的时间戳、last_synced_date 和用于对象创建和更新的时间戳。由于对象指的是用户在特定时间所做的事情，因此它们也具有时间戳信息。

我的问题只涉及用于这些时间戳的时间的内部表示。UI 中的用户表示是内部表示的本地化和格式化版本。在实现语言和用于表示时间戳的不同数据库中都有很多不同的方式。经过相当多的研究，似乎只剩下有效的解决方案：

*   Unix 时间
*   ISO8601

Hacker News 上的这篇[文章](http://unix4lyfe.org/time/?v=1)（两次）建议使用 UNIX 时间，并提出了一个很好的论点。正如预期的那样，关于 HN 的讨论围绕上述两点存在相当大的分歧，然后是一些分歧。

到目前为止，我的结论是，Unix 时间时间戳更容易处理，但似乎不是 Django 中的常用方法。我发现的几乎每个代码示例，从 Django 教程到许多其他站点，都在 models.py 中使用 DateTimeField，它被映射到 SQL 中的某种日期字段，确切的术语取决于所使用的数据库。

使用 ISO8601 日期进行传输和存储的缺点是需要对其进行解析以创建相应的实现语言的 Date 类型。这并不难，但有点烦人。对于我们使用的每一种语言，您要么需要一个（小型）库，要么至少需要比您希望的更多的代码。它不是很漂亮，会创建依赖关系并且可能会稍微慢一些。Unix 时间时间戳在我所知道的任何语言中都没有这个问题。

另一件事是，使用数据库中的“智能”日期或时间戳字段（以及在解析期间）很容易遇到麻烦。SO上有很多关于时间魔法的问题，这些问题会把事情搞砸。我的链接已达到限制，所以我不能发布任何内容，但你会很容易找到一些；）

我们可以使用不包含时区信息的简化格式，并且始终使用 UTC。无论如何，我们只会使用 UTC，但如果您使用 ISO8601，您还不如使用普遍理解且明确的格式。Unix 时间始终采用 UTC，因此您永远不必担心这一点。

当然，当您查看原始数据库时，ISO8601 具有人类可读的优点，而且我不必在 2038 年之前不久重写几行代码，但这似乎并不能弥补缺点。

似乎通过写东西，我实际上已经有了答案；）无论如何，我很想知道其他人的想法以及您在自己的项目中做了什么。请简要概述您的用例，以便其他人可以更好地对您的输入进行分类。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-29T12:13:44.753

真的很难找到任何关于时间数据类型或时间标准格式的信息，不管它是什么已知的。在过去的几天里，我自己一直在努力选择正确的时间格式。和你一样，我也在移动设备和网络服务器中编码（更不用说还有一个桌面应用程序）。

我问自己的主要问题是“我怎样才能在移动设备、Web 服务器（API，或者你想调用的任何东西）和桌面应用程序之间获得无缝体验？如何在事件发生时保持一致？**如何确保这个瞬间的表示在这个软件**星座的不同层次中是相同的？

您可能知道使用移动设备进行编码意味着您正在使用 SQLite 数据库，而 Web 应用程序主要意味着 MySQL。我**深感失望的是，我能想象到的最令人头疼的事情之一就是使用时间数据从一个数据库转到另一个数据库**。选择什么？约会时间？时间戳？哦，天哪，SQLite 没有内置的时间数据类型……Unix 时间？好吧，没问题，当然MySQL不以UNIX时间为标准……太简单了……</p>

我学到的是……如果您想将数据放在时间线上并说这是时间线上发生此事件的时间点，**最好使用时间戳（无论是 UNIX 还是 MySQL 风格，又名 ISO8601）**。

人类可读对我来说只是一个细节。没有人应该阅读数据库表，计算机会这样做，并且您确实告诉计算机以人类可以理解的顺序处理数据。

但是**接下来的问题是“时区是什么？” 突然出现**……嗯……很糟糕……但是，嘿，会在网上寻找答案。

我自己**很惊讶 MySQL 不使用 UNIX time**，我认为这是人们可以拥有的最标准和最一致的时间格式。

**我真的认为围绕这​​些选择的文档和标准是有限的**……我现在正在考虑写一些关于如何使用 MySQL 和 SQLite 处理时间的东西。我确实在这件事上浪费了半周的时间，试图了解如何让它变得干净和简单，结论是，有了可用的文档，你就无法……

我可能错了……

*不管怎样，看看这段视频，展示了在 MySQL 中处理时间戳数据的过程：*

[http://www.youtube.com/watch?v=fp-etlirjbo](http://www.youtube.com/watch?v=fp-etlirjbo)

# xml - 将命名空间前缀添加到根节点

> ID：15554587
> 
> 赞同：0
> 
> 时间：2013-03-21T17:47:40.857
> 
> 标签：xml, xslt, namespaces, prefix

我需要更改根节点的命名空间并将命名空间前缀添加到仅根元素而不是子元素。

我有以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?> 
<Class xmlns="https://api.ladbrokes.com/v1/sportsbook-couchbase/SportsbookCouchbase.xsd">
<blurb >Test</blurb>
<channels >
<e >I</e>
<e >J</e>
<e >K</e>
</channels>
<classSortCode >Test</classSortCode>
<classStatus >Test</classStatus>
<creationDateTime >2013-03-21T22:29:01.58+05:30</creationDateTime>
<isActive >true</isActive>
<lastUpdatedDateTime >2013-03-21T22:29:01.58+05:30</lastUpdatedDateTime>
<locale >Test</locale>
</Class> 
```

我需要这个成为

```
<?xml version="1.0" encoding="UTF-8"?> 
<ns0:Class xmlns:ns0="https://api.ladbrokes.com/v1/sportsbook-couchbase/Temp.xsd">
<blurb >Test</blurb>
<channels >
<e >I</e>
<e >J</e>
<e >K</e>
</channels>
<classSortCode >Test</classSortCode>
<classStatus >Test</classStatus>
<creationDateTime >2013-03-21T22:29:01.58+05:30</creationDateTime>
<isActive >true</isActive>
<lastUpdatedDateTime >2013-03-21T22:29:01.58+05:30</lastUpdatedDateTime>
<locale >Test</locale>
</ns0:Class> 
```

我可以使用 XSLT 实现这一点吗？请在这方面帮助我。

谢谢，湿婆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:59:40.410

这就是您可以给文档元素一个不同的命名空间并将所有其他元素移动到 null 命名空间的方法：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ns0="https://api.ladbrokes.com/v1/sportsbook-couchbase/Temp.xsd">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*">
    <xsl:element name="ns0:{local-name()}">
      <xsl:apply-templates select="@* | node()" />
    </xsl:element>
  </xsl:template>

  <xsl:template match="*/*">
    <xsl:element name="{local-name()}">
      <xsl:apply-templates select="@* | node()" />
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

在您的示例输入上运行时，结果是：

```
<ns0:Class xmlns:ns0="https://api.ladbrokes.com/v1/sportsbook-couchbase/Temp.xsd">
  <blurb>Test</blurb>
  <channels>
    <e>I</e>
    <e>J</e>
    <e>K</e>
  </channels>
  <classSortCode>Test</classSortCode>
  <classStatus>Test</classStatus>
  <creationDateTime>2013-03-21T22:29:01.58+05:30</creationDateTime>
  <isActive>true</isActive>
  <lastUpdatedDateTime>2013-03-21T22:29:01.58+05:30</lastUpdatedDateTime>
  <locale>Test</locale>
</ns0:Class> 
```

为了澄清起见，这是您可以更改文档元素的名称空间并将其他所有内容保留在它们已经拥有的名称空间中的方法。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ns0="https://api.ladbrokes.com/v1/sportsbook-couchbase/Temp.xsd">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*">
    <xsl:element name="ns0:{local-name()}">
      <xsl:copy-of select="namespace::*" />
      <xsl:apply-templates select="@* | node()" />
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

这就是结果。请注意顶部命名空间声明中的微小但关键的区别：

```
<ns0:Class xmlns:ns0="https://api.ladbrokes.com/v1/sportsbook-couchbase/Temp.xsd" 
     xmlns="https://api.ladbrokes.com/v1/sportsbook-couchbase/SportsbookCouchbase.xsd">
  <blurb>Test</blurb>
  <channels>
    <e>I</e>
    <e>J</e>
    <e>K</e>
  </channels>
  <classSortCode>Test</classSortCode>
  <classStatus>Test</classStatus>
  <creationDateTime>2013-03-21T22:29:01.58+05:30</creationDateTime>
  <isActive>true</isActive>
  <lastUpdatedDateTime>2013-03-21T22:29:01.58+05:30</lastUpdatedDateTime>
  <locale>Test</locale>
</ns0:Class> 
```

# java - 数据库连接或查询错误

> ID：15554588
> 
> 赞同：0
> 
> 时间：2013-03-21T17:47:41.683
> 
> 标签：java, database, connection

我试图连接到数据库，但 java 错误处理不断给我这个错误“数据库连接或查询错误”

我的代码是这样的

```
connection = DriverManager.getConnection(url, username, password);      
System.out.println("Connection established: My data.");

Statement st = connection.createStatement();            
ResultSet rs = st.executeQuery(strQuery); 
```

strQuery 是一个字符串

```
String strQuery="SELECT * FROM database.MINIMUM_TIMES"; 
```

concole 窗口可以打印出“已建立连接：我的数据。”；但然后给我“数据库连接或查询错误”

谁能帮我这个？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:51:19.810

试试这个

> 字符串 strQuery="SELECT * FROM MINIMUM_TIMES";

假设 MINIMUM_TIMES 是您已经建立连接的数据库中的表。

# c - 初始化一个 OpenCL 对象

> ID：15554591
> 
> 赞同：0
> 
> 时间：2013-03-21T17:47:54.300
> 
> 标签：c, opencl

嗨，我想知道我是否可以创建一个像这个结构这样的 openCL 对象

```
struct Product
{

    int n_id;
    char n_name;

    Item(id, name){n_id = id; n_name = name;}
} item; 
```

我想将此信息传递给内核，以使该结构可从另一个结构重用。

我想通过内核添加项目

```
kernel addItem(int name, char name)
{
    Item it(id,name);
    Items.add(it);
} 
```

所以我的问题是如何传递这些信息以及如何使我创建的对象可以从另一个内核重用？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T07:45:54.317

OpenCL 内核是用类似 C99 的受限制（例如，结构中没有指针）和扩展（例如 float4 数据类型）语言编写的。它们不是用 C++ 编写的。

您在主机上初始化类似 C 的结构，然后将它们复制过来。类似 C 的结构没有方法。在带有 Visual Studio 的主机上使用 C++ OpenCL 绑定（来自 cl.hpp）我执行以下操作：

```
#pragma pack(16)
struct Light {
    cl_float4 pos;
    cl_float4 dir;
    cl_float4 intensity;
    cl_int type; 
    cl_int pad[3];
};
#pragma pack()

const int nlight = 10
Light lights[nlight];
//...code to initialize array of structs

cl::Buffer lights_mem = cl::Buffer(context, CL_MEM_COPY_HOST_PTR,  sizeof(Light)*nlight, lights);

kernel1.setArg(0, lights_mem); 
```

这会将灯光复制到 OpenCL 设备。在内核中，您可以像这样访问灯光结构：

```
__kernel void trace(__global Light* lights, ...) {
    float4 pos = lights[0].pos
    //find a new position (pos_new)
    lights[0].pos = pos_new; 
```

当内核完成时，您可以将 cl::Buffer lights_mem 传递给下一个内核。

```
kernel2.setArg(0, lights_mem); 
```

但是，您可以通过使用只读或只写缓冲区来获得更好的速度，因此将内核分为只读和只写可能会有所帮助。

我不知道 pack() pragma 和 padding 是否仍然是必要的，但我一直在使用它们，因为每次有人说它们不再需要时，我都会遇到一个问题，当我把它们放回去时就会消失。

# ruby-on-rails - Rails - 如何使表单提交给特定的控制器

> ID：15554592
> 
> 赞同：1
> 
> 时间：2013-03-21T17:47:56.060
> 
> 标签：ruby-on-rails, ruby, simple-form

我正在学习并想创建一个博客，其中有一个控制器，可以向公众提供以标准博客布局查看我的博客的视图，而我希望有一个单独的控制器“管理员/帖子”，允许我查看在单独的布局中发布。

我已经创建了两个控制器，并在“admin/posts”控制器的路由中使用了命名空间。我还制作了一个表单以在“管理员/帖子”视图中提交新帖子，但是当表单提交时，它会转到帖子文件夹上的创建操作..有没有办法告诉您希望它提交的表单到“管理员/帖子/创建”操作？

我正在使用“simple_form”宝石。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:52:11.270

这会成功的。

```
<%= simple_form_for([@admin, @post]) do |f| %> 
```

# image - 更改隐藏的输入 onChange 复选框

> ID：15554594
> 
> 赞同：0
> 
> 时间：2013-03-21T17:48:01.537
> 
> 标签：image, input, mootools, hidden, checkbox

我需要在 mootools 中实现功能。OnChange 一些复选框我需要设置图像边框，并在隐藏输入中设置新值。这个新值必须是所选图像的名称。

[jsFiddle 示例](http://jsfiddle.net/ynternet/pfJYh/)

HTML

```
 <form>
   <div class="img_container">
      <img src="http://ynternet.sk/test/bg_1.png" /><br />
      <input type="checkbox" name="bg_1.jpg" id="__chbx" />
  </div>
  <div class="img_container">
    <img src="http://ynternet.sk/test/bg_2.png" /><br />
    <input type="checkbox" name="bg_2.jpg" id="__chbx" />
  </div>
  <div class="img_container">
      <img src="http://ynternet.sk/test/bg_3.png" /><br />
      <input type="checkbox" name="bg_2.jpg" id="__chbx" />
  </div>

 <input type="hidden" value="" name="selected_img"> 
```

CSS

```
 .img_container {
    padding:5px;
    display:inline-block;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:59:17.603

[jsFiddle](http://jsfiddle.net/pfJYh/2/)

```
var checks = document.getElements('input[type="checkbox"]');
var hidden = document.getElements('input[type="hidden"]')[0];
checks.addEvent('change',function(e){
    var checkbox = e.target;
    var img = checkbox.getPrevious('img');
   var img_name = checkbox.get('name');

  var checked = checkbox.get('checked');
  if(checked){
    img.setStyle('border','1px solid red');
    hidden.set('value',img_name);
  }
  else{
    img.setStyle('border',null);   
  }
}); 
```

# c# - 不能将派生类型转换为基类型？

> ID：15554595
> 
> 赞同：0
> 
> 时间：2013-03-21T17:48:03.910
> 
> 标签：c#, generics, collections

我有以下设置：

```
struct Item { }

class Entry : List<Item> { } 
```

在我作为类型参数传递的泛型类中，`Entry`我试图获取`List<Item>.Count`.

我已经尝试过以下方法：

```
var c = typeof(T).GetProperty("Count").GetMethod.Invoke(X, new object[]{}); // x is the variable in the generic class of type T! 
```

我也试过

```
var c = (x as ICollection).Count;
// throws Cannot cast '((Entry)X)' (which has an actual type of 'Entry') to 'System.Collections.Generic.List<Item>' 
```

现在我真的不知道如何获得 Count :(

泛型类的代码：这个想法是有一个字段来记住一个特定的起始值，然后在它被改变时给出反馈。

```
SyncField<T>
{
    T O { get; private set; }
    T V { get; private set; }

    public bool HasChanged
    {
        get
        {
            if (V != null && O != null)
            {
                var func = typeof(T).GetProperty("Count");
                if (func != null)
                {
                    var oc = func.GetMethod.Invoke(O, new object[] { });
                    var vc = func.GetMethod.Invoke(V, new object[] { });
                    return oc != vc; // here i am trying to simply do ICollection.Count != ICollection.Count
                }
            }
            return O != null && !O.Equals(V);
        }
    } 
```

}

更新：我解决了这个问题：

```
public bool HasChanged
{
    get { return return O != null && !O.Equals(V); }
} 
```

为什么？因为如果这两个方法不同，我需要告诉我的`Equals()`方法已经完成了:)`List<T>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:17:43.133

我假设你在`SyncField<Entity>`其他地方做。

```
SyncField<T>
{
    T O { get; private set; }
    T V { get; private set; }

    public bool HasChanged
    {
        get
        {
            if (V != null && O != null && O is ICollection)
            {
                return ((ICollection)O).Count != ((ICollection)V).Count;
            }
            else
            {
                return O != null && !O.Equals(V);
            }
        }
    }
} 
```

# tomcat - Apache Tomcat 连接池和 Oracle 全局临时表。数据可以共享吗？

> ID：15554604
> 
> 赞同：0
> 
> 时间：2013-03-21T17:48:35.977
> 
> 标签：tomcat, oracle11g, connection-pooling, spring-batch, temp-tables

我在多分区上运行了一些春季批处理作业...我想使用 oracle 的全局临时表作为批处理作业的暂存表，以便暂存表仅在我的作业运行期间存在...截至目前我有物理表

我所有这些都在tomcat中运行。实现了tomcat连接池...

所以我的登台表由登台编写器填充。我可以看到数据。到目前为止一切看起来都很好

到目前为止，我的工作是单线程的。在此之后，有多个阅读器都在读取临时表中不同范围的记录。

暂存阅读器是分区的，每个分区都使用池中的一个连接。所以大多数读者无法看到临时表中的数据。可能是一两个读者，我可以假设他们使用的是相同的创建和插入表的会话

有没有办法让所有使用连接池的读者都可以使用数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:04:13.927

全局临时表中的数据只会在插入它的会话中可见。与使用本地临时表的其他数据库不同，该表本身将始终存在（您对“表仅在我的工作运行期间存在”的评论似乎不正确）。

如果您希望数据在会话中可见，您实际上需要将其加载到永久临时表中。还有其他方法可以跨多个会话共享数据（例如，全局上下文），但如果您要生成多个线程来处理数据，那么这些选项对于您的数据量可能并不实用。根据处理的性质，您的应用程序中可能有一个线程将数据分发给所有其他线程，因此只有协调器需要查询临时表。

# python - Python列表索引超出范围 - minidom

> ID：15554605
> 
> 赞同：0
> 
> 时间：2013-03-21T17:48:36.420
> 
> 标签：python, xml, linux

快速提问，当您看到错误“builtins.IndexError：列表索引超出范围”时，正确的解决方案是什么？

这是参考我要进行的另一个[线程](https://stackoverflow.com/questions/15549008/python-minidom-xml-parsing-dotted-quad-nested-children/ "线")，但我不想破坏它。

代码：

```
from xml.dom import minidom

net_xml = minidom.parse("network_objects.xml")

NetworkObjectsTag = net_xml.getElementsByTagName("network_objects")[0]

# Pull individual network objects
NetworkObjectTag = NetworkObjectsTag.getElementsByTagName("network_object")

for network_object in NetworkObjectTag:
    name = network_object.getElementsByTagName("Name")[0].firstChild.data
    class_name = network_object.getElementsByTagName("Class_Name")[0].firstChild.data
    color = network_object.getElementsByTagName("color")[0].firstChild.data
    ipElement = network_object.getElementsByTagName("ipaddr")
    ipaddr = ipElement.firstChild.data
    maskElement = network_object.getElementsByTagName("netmask")
    netmask = maskElement.firstChild.data
    #address_ranges
    ipaddr_first = network_object.getElementsByTagName("ipaddr_first")
    ipaddr_last = network_object.getElementsByTagName("ipaddr_last")
    print(name,class_name,ipaddr,netmask,ipaddr_first,ipaddr_last,color) 
```

打印6行后产生的错误是：

```
ipElement = network_object.getElementsByTagName("ipaddr")[0]
IndexError: list index out of range 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:56:25.877

这意味着引用的列表是空的。换句话说，网络对象没有 ipaddr 标签。

为了安全起见，您需要将结果保存`getElementsByTagName`到变量并检查长度，然后再保存到`ipelement` 没有时您要做什么`ipaddr`由您决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T19:42:31.477

Huzah，感谢 freenode/#python 上的 cwillu_at_work。有用的建议导致：

```
 ipElement = network_object.getElementsByTagName("ipaddr")
if ipElement:    
    ipElement = network_object.getElementsByTagName("ipaddr")[0]
    ipaddr = ipElement.firstChild.data
maskElement = network_object.getElementsByTagName("netmask")
if maskElement:
    maskElement = network_object.getElementsByTagName("netmask")[0]
    netmask = maskElement.firstChild.data 
```

# regex - AWK：将行写入多个文件

> ID：15554608
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:48:38.993
> 
> 标签：regex, awk, substring, fasta

我正在尝试使用 awk 从 FASTA 文件中提取序列。

例如，文件看起来像这样，它包含 703 个序列。我想将它们中的每一个提取到单独的文件中。

```
>sequence_1
AACTTGGCCTT
>sequence_2
AACTTGGCCTT
.
.
. 
```

我正在使用这个 awk 脚本：

```
awk '/>/ {OUT=substr($0,2) ".fasta"}; OUT {print >OUT}'file.fasta 
```

...这有效，但仅适用于第 16 个，然后我收到一条错误消息；

```
.fasta makes too many open files
input record number 35, file file.fasta
source line number 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:09:01.713

完成后您需要关闭文件。尝试：

```
awk '/>/ {close(OUT); OUT=substr($0,2) ".fasta"}; OUT {print > OUT}' file.fasta 
```

# java - Java - 列表还是数组？

> ID：15554612
> 
> 赞同：4
> 
> 时间：2013-03-21T17:48:47.327
> 
> 标签：java, arrays, list, arraylist

我知道列表使 Java 中的事情变得更容易，而不是使用硬设置的数组（列表允许您随意添加/删除元素，它们会自动调整大小等）。

我读过一些东西，建议尽可能避免在 java 中使用数组，因为它们根本不灵活（有时会施加奇怪的限制，例如如果您不知道数组需要的大小等）。

这是完全停止使用数组而只使用列表逻辑的“好习惯”吗？我确信 List 类型比数组消耗更多的内存，因此具有更高的开销，但这很重要吗？大多数列表会在运行时被 GC 处理，如果它们被放置在任何地方，那么也许它不像我想的那么重要？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T17:51:06.407

我不喜欢教条。了解规则；知道什么时候打破规则。

“从不”太强了，尤其是在软件方面。

`Arrays`并且`Lists`都是 GC 的潜在目标，所以这是一个清洗。

是的，在开始之前您必须知道数组的大小。对于你这样做的情况，它没有任何问题。

`java.util.Collections`使用和`java.util.Arrays`类很容易根据需要来回切换。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T17:50:46.560

我认为一个好的经验法则是使用`Lists`，除非你需要一个`Array`（出于内存/性能原因）。否则`Lists`通常更容易维护，因此不太可能导致未来的错误。

列表在自动扩展方面提供了更多的灵活性/功能，因此除非您需要内存（并且无法承受列表创建的开销）或者不介意在扩展/收缩时保持数组大小，否则我会推荐列表。

尽量不要对代码进行过多的微观管理，而是专注于更易识别和可读的组件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T17:52:38.520

这取决于清单。A`LinkedList`可能仅在需要时占用空间，而`ArrayList`通常在达到其容量时会大大增加其空间。在内部，an`ArrayList`是使用数组实现的，但它是一个总是比你想要的大的数组。但是，由于它存储的是引用，而不是对象，所以在大多数情况下内存开销可以忽略不计，而且我相信它的便利是值得的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T17:57:10.273

我不得不说我遵循这种使用集合框架的方法，否则我可能会使用数组。与数组相比，这些集合为您提供了许多好处和便利，但是是的，可能会对性能产生一些影响。

最好编写易于理解且难以破解的代码，数组需要您放入大量检查代码以确保您不会访问您不应该访问的数组位或在其中放入很多东西等. 鉴于大多数时候性能不是问题，它不应该是一个问题。

# css - IE7 表单放在单列而不是双列

> ID：15554616
> 
> 赞同：0
> 
> 时间：2013-03-21T17:49:01.473
> 
> 标签：css, forms, internet-explorer

好的，我不知道它是如何附加的，这种形式：http: [//xquives.kiiaistudio.com/new-form/index.php](http://xquives.kiaistudio.com/new-form/index.php)有一个两列字段。但在 IE7 中它在一列中，但不在 ie8 或 9 或 FF 中。你能告诉我我做了什么坏事，或者如何让 IE 表现得像普通浏览器一样。我已经进行了超过 2 小时的测试......而且我不知道去哪里找！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:11:09.113

你的标记不适合蹩脚的ie7。您的标记通常如下所示：

```
<ul>
<li style="float:left width:50%">stuff</li>
<li style="float:left width:50%">stuff</li>
<li style="float:left width:50%">stuff</li>
<li style="float:left width:50%">stuff</li>
<li style="float:left width:50%">stuff</li>
</ul> 
```

这很容易出错。

使用像这样驱动列的父容器会更好：

```
<div style="width: 50%; float: left">
    <ul>
    <li class="left-column-lis">stuff</li>
    <li class="left-column-lis">stuff</li>
    <li class="left-column-lis">stuff</li>    
    <li class="left-column-lis">stuff</li>
    </ul>
</div>
<div style="width: 50%; float: left">
    <ul>
    <li class="right-column-lis">stuff</li>
    <li class="right-column-lis">stuff</li>
    <li class="right-column-lis">stuff</li>    
    <li class="right-column-lis">stuff</li>
    </ul>
</div> 
```

编辑：如果你嫁给了这个标记结构，你可以通过添加以下内容来破解 ie7：

```
UL{*overflow:visible;}
.autocolumn LI {*width: 48%;} 
```

最好的办法是按照我上面描述的方式布局你的列

# drupal-6 - Drupal 6 表单“无线电”#return_value 不工作

> ID：15554620
> 
> 赞同：0
> 
> 时间：2013-03-21T17:49:14.477
> 
> 标签：drupal-6, radio-button, return-value

我正在使用 Drupal 6 并创建一个涉及表单提交的模块。我选择使用#type“radio”，因为它允许我动态创建一个表（这是显示目的所必需的）。

我正在输出我在图像中选择的每个收音机的返回值。但是，每当我提交表单时，都会返回 #default_value 而不是 #return_value。

这是我的代码以及页面的屏幕截图。任何帮助是极大的赞赏！

======[这里的问题图片](http://i.imgur.com/fbFmfwv.png)=======

```
function peereval_survey(&$formstate, $numStudents)
{
drupal_add_css(drupal_get_path('module', 'peereval') .'/peereval.css');

for ($rowNum = 1; $rowNum <= $numStudents; $rowNum++)
{
    for ($colNum = 1; $colNum <= 5; $colNum++)
    {
        if ($rowNum == 1)
        {
            $form['v' . $colNum]['u' . $rowNum . ',v' . $colNum] = array
            (
                '#prefix' => "<tr><td>",
                '#suffix' => "</td>",
                '#type' => 'radio',
                '#title' => t($rowNum . ', ' . $colNum),
                '#name' => 'u' . $rowNum,   
                '#default_value' => 0,
                '#return_value' => $colNum,
            );
        }           
        else if ($rowNum == 5)
        {
            $form['v' . $colNum]['u' . $rowNum . ',v' . $colNum] = array
            (
                '#prefix' => "<td>",
                '#suffix' => "</td></tr>",
                '#type' => 'radio',
                '#title' => t($rowNum . ', ' . $colNum),
                '#name' => 'u' . $rowNum,
                '#default_value' => 0,
                '#return_value' => $colNum,
            );
        }
        else
        {
            $form['v' . $colNum]['u' . $rowNum . ',v' . $colNum] = array
            (
                '#prefix' => "<td>",
                '#suffix' => "</td>",
                '#type' => 'radio',
                '#title' => t($rowNum . ', ' . $colNum),
                '#name' => 'u' . $rowNum,
                '#default_value' => 0,
                '#return_value' => $colNum,
            );
        }
    }
}

$form['numStudents'] = array
(
    '#type' => 'hidden',
    '#value' => $numStudents
);

$form['submit'] = array
(
    '#prefix' => '<div id="submit">',
    '#suffix' => '</div>',
    '#type' => 'submit',
    '#value' => t('Save'),  
);

return $form;
} 
```

```
function peereval_survey_submit($form, &$form_state)
{
$form_state['redirect'] = 'peereval/1/5/1';

drupal_set_message("hi" . $form_state['values']['u1,v1'] . $form_state['values']['u2,v2'] . $form_state['values']['u3,v3'] . $form_state['values']['u4,v4'] . $form_state['values']['u5,v5']);

return $form;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:06:36.593

以下变量包含我的数据：

```
$form_state['clicked_button']['#post']['u1'], 
$form_state['clicked_button']['#post']['u2'],
$form_state['clicked_button']['#post']['u3'], 
$form_state['clicked_button']['#post']['u4'], 
$form_state['clicked_button']['#post']['u5']. 
```

非常感谢 Adam Balsam 帮我找到这个！

# c# - 使用 Fluent API 对 POCO 实体进行条件映射

> ID：15554624
> 
> 赞同：0
> 
> 时间：2013-03-21T17:49:28.167
> 
> 标签：c#, entity-framework, fluent, fluent-interface

我有这个 POCO 课程：

```
public class MyClass
{
    public int MyKey { get; set; }
    public string Name { get; set; }
    public bool DiscriminatorField { get; set; }
    public string AnotherInfo { get; set; }
} 
```

我的数据库模型是这样的：

*   主要的
    *   身份证号码
    *   名称 varchar
    *   鉴别器字段位
*   具体1
    *   身份证号码
    *   另一个字段 varchar
*   具体2
    *   身份证号码
    *   另一个字段 varchar

**问题：**使用流利的 API（并且最有可能`EntityTypeConfiguration`），我如何创建这个条件映射，如果鉴别器是 ，我的实体在哪里被填充，如果鉴别`AnotherField`器是？`Specific1``true``Specific2``false`

注意：我不想创建两个不同的 POCO。我正在寻找这样的东西[，](https://stackoverflow.com/a/6672767/68693)但有条件。

编辑：向 POCO 实体添加了鉴别器字段。

# html - “”如何应用？

> ID：15554632
> 
> 赞同：3
> 
> 时间：2013-03-21T17:49:49.870
> 
> 标签：html, conditional-comments

在现代网页中，您经常会看到如下内容：

```
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]--> 
```

目的显然是应用不同的 html，具体取决于浏览器和浏览器版本。我假设这是在服务器端完成的，因为似乎除了适当的部分之外的所有内容都被注释掉了。

服务器上用什么软件根据访问的浏览器选择注释掉哪一部分？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T17:50:42.860

这些是[有条件的评论](http://www.quirksmode.org/css/condcom.html)。它们由 Internet Explorer（版本 5-9）在客户端进行解析（与 HTML 规范相反）。其他一切（包括 IE 10）都将它们视为常规注释语法。

# javascript - 提示用户输入信息，然后对数据进行排序

> ID：15554639
> 
> 赞同：0
> 
> 时间：2013-03-21T17:50:07.830
> 
> 标签：javascript, user-input, command-prompt, sorting

对于一个类项目，我需要在 Javascript 中创建一个程序，要求用户输入 3 个名称，然后按字母顺序对名称进行排序并将它们打印在屏幕上。

我已经想出了如何创建一个提示框供用户输入数据，然后我可以让程序将用户输入的字符串打印到屏幕上。但是，我无法弄清楚如何让 Javascript 对字符串进行排序。我知道我需要使用一个数组，但我不确定将数组放在哪里，或者如何让它知道用户输入的变量。

这是我到目前为止的代码：

```
<html>
<script> 

function disp_prompt() 
      {
      var names=prompt("Please enter three names","Names")
      document.getElementById("msg").innerHTML= names
      }

</script> 

<center><input type="button" onclick="disp_prompt()" value="Click Here"></center>
<br>

<h2><center><div id="msg"></div></center></h2>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T17:56:36.303

整个事情看起来像

```
var namesToPrompt = 3,
    names         = [ ];

// as long as namesToPrompt is truthy, prompt for inputs
while( namesToPrompt-- ) {
    names.push( prompt('Please enter a name') );
}

// sort our array
names.sort( byName );

// and print it
document.getElementById( 'msg' ).textContent = names.join(',');

function byName( a, b ) {
    return a.localeCompare( b );
} 
```

如果您想让用户一次输入所有名称，您可以像

```
var inputNames = prompt( 'Please enter three names','Names' );

document.getElementById( 'msg' ).textContent = inputNames
                                                 .split( /,\s+/ )   // split by any amount of white-space characters in a row
                                                 .sort( byName )
                                                 .join( ',' );

function byName( a, b ) {
    return a.localeCompare( b );
} 
```

# javascript - 使用复选框的“onclick”时防止默认操作的简单方法？

> ID：15554640
> 
> 赞同：4
> 
> 时间：2013-03-21T17:50:12.933
> 
> 标签：javascript, jquery, web-applications

这是我目前的解决方案：

**html**

```
<input type="checkbox" value="1" onclick="return do_stuff();" />
<input type="checkbox" value="1" onclick="return do_stuff2();" /> 
```

**脚本：**

```
function do_stuff() {   
    return false;
}

function do_stuff2() {   
    return true;
} 
```

[http://jsfiddle.net/NXKMH/12/](http://jsfiddle.net/NXKMH/12/)

我想避免在 onclick 调用中需要“返回”（例如，`onclick="do_this();"`而不是`onclick="return do_this();"`）。我考虑过使用 jquery 提供的 preventDefault() 函数，但似乎无法正常工作。另外，如果可能的话，我不想绑定“点击”事件。我更喜欢使用“onclick”。（更容易处理 ajax 加载的内容）

想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T17:54:16.670

事件处理程序的返回值决定了默认浏览器行为是否也应该发生。

所以 ...

```
onclick='function(); return false;' 
```

应该修复它...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T18:52:28.773

您是否尝试过在 do_stuff() 中调用 event.stopPropagation() 方法……当然，您需要传入事件。

```
onclick = 'do_stuff(event)'

function do_stuff(ev) {

  if(ev.stopPropagation) {
    // for proper browsers ...
    ev.stopPropagation();
  } else {
      // internet exploder uses cancelBubble ...
      window.event.cancelBubble = true;
  }
  // --- do some more stuff ---//
} 
```

# css - CSS相对定位+浏览器兼容性

> ID：15554643
> 
> 赞同：0
> 
> 时间：2013-03-21T17:50:21.193
> 
> 标签：css, cross-browser, css-position

我正在尝试放置一个搜索框并提交按钮，以便它们对齐。我使用 CSS 重置让所有浏览器从同一级别开始。无论出于何种原因，我都无法让他们在 IE、Chrome 和 Firefox 上排队。我可以让它在 1/3 上工作，但不是 3/3。使用当前代码，搜索按钮在 FF 中对齐，在 IE 中低 1px，在 Chrome 中低 3-5px。任何帮助都非常感谢，因为我无能为力。

这是代码。

HTML 片段：

```
<span class="search">
            <form id="searchbox" action="/search" method="get">
                <input name="query" id="search" type="text" placeholder="I'm looking for..."/>
                <input id="submit" class="mglass" type="submit" value=""/>
            </form>
    </span> 
```

CSS 片段：

```
* {
    vertical-align: baseline;
    font-weight: inherit;
    font-family: inherit;
    font-style: inherit;
    font-size: 100%;
    border: 0 none;
    outline: 0;
    padding: 0;
    margin: 0;
    }
#search{ 
    position: relative;
    bottom: 1px;
    height: 27px;
    width: 200px;
    font-size: 14px;
    font-family: 'calibri', Tahoma, Geneva, sans-serif;
    border: none;
    background-color: #eee;
    border-width: 1px;
    border-style: solid;
    border-color: #cccccc;
    padding-left: 10px;
}
#searchbox{
    position: relative;
    right: 27px;
    top: 5px;   
    float: right;
}
input[type="submit"]::-moz-focus-inner {
    border: 0;
    padding: 0;
}
input[type="text"]::-moz-focus-inner {
    border: 0;
    padding: 0;
}
.mglass{
    background: url(../images/search_glass01.png) no-repeat center;
    height: 29px;
    width: 33px;
    border-width: 1px;
    border-style: solid;
    border-color: #cccccc;
    position: relative;
    right: 7px;
    bottom: 0px;
}
.mglass:hover{
    background: url(../images/search_glass02.png) no-repeat center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:14:15.823

我不得不稍微修改一下你的 CSS 并简化一些选择器以了解它，但是，试试这个：

[http://jsfiddle.net/R56mu/](http://jsfiddle.net/R56mu/)

```
body {
    vertical-align: baseline;
    font-weight: inherit;
    font-family: inherit;
    font-style: inherit;
    font-size: 100%;
    border: 0 none;
    outline: 0;
    padding: 0;
    margin: 0;
    }

#searchbox{
    float: right;
    overflow:hidden;
}

#search{ 
    width: 200px;
    height:32px;
    float:left;
    padding: 0 0 0 10px;
    background-color: #eee;
    font-size: 14px;
    font-family: 'calibri', Tahoma, Geneva, sans-serif;
    border: none;
    border-width: 1px;
    border-style: solid;
    border-color: #cccccc;    
}
#submit{
    width: 33px;
    height:34px;
    float:left;
    background: url(../images/search_glass01.png) no-repeat center;
    border-width: 1px;
    border-style: solid;
    border-color: #cccccc;   
}

#submit:hover{
    background: url(../images/search_glass02.png) no-repeat center;
}

input[type="submit"]::-moz-focus-inner {
    border: 0;
    padding: 0;
}
input[type="text"]::-moz-focus-inner {
    border: 0;
    padding: 0;
} 
```

# xslt - 在 if 中声明变量，并在下一个 if 中使用

> ID：15554644
> 
> 赞同：0
> 
> 时间：2013-03-21T17:50:23.107
> 
> 标签：xslt, umbraco, xslt-1.0

我在工作中遇到了一个问题，我目前正在一个已经建立的网站上开发（我自己没有开发过），而且我对 Umbraco 和 xslt 并不是很熟悉。

这是我正在处理的代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xsl:stylesheet [ <!ENTITY nbsp "&#x00A0;"> ]>
<xsl:stylesheet
   version="1.0"
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:msxml="urn:schemas-microsoft-com:xslt"
   xmlns:umbraco.library="urn:umbraco.library" xmlns:Exslt.ExsltCommon="urn:Exslt.ExsltCommon" xmlns:Exslt.ExsltDatesAndTimes="urn:Exslt.ExsltDatesAndTimes" xmlns:Exslt.ExsltMath="urn:Exslt.ExsltMath" xmlns:Exslt.ExsltRegularExpressions="urn:Exslt.ExsltRegularExpressions" xmlns:Exslt.ExsltStrings="urn:Exslt.ExsltStrings" xmlns:Exslt.ExsltSets="urn:Exslt.ExsltSets"
   exclude-result-prefixes="msxml umbraco.library Exslt.ExsltCommon Exslt.ExsltDatesAndTimes Exslt.ExsltMath Exslt.ExsltRegularExpressions Exslt.ExsltStrings Exslt.ExsltSets ">

   <xsl:output method="xml" omit-xml-declaration="yes"/>

   <xsl:template match="/">
   <style>
      span.cc { font-size:9px;border:1px solid #000;margin-right:3px; }
   </style>
   <xsl:variable name="lcletters">abcdefghijklmnopqrstuvwxyz</xsl:variable>
   <xsl:variable name="ucletters">ABCDEFGHIJKLMNOPQRSTUVWXYZ</xsl:variable>
   <table width="100%">

   <xsl:variable name="loc" select="umbraco.library:GetXmlDocument('/media/31087/data.xml', 1)"/>
   <xsl:for-each select="$loc/rdsppGenData/generatorData">
     <xsl:variable name="tags">
       <xsl:if test="(OA23) and (not(OA23 = '-'))">cat_1223 </xsl:if>
       <xsl:if test="(OA30) and (not(OA30 = '-'))">cat_1868 </xsl:if>
       <xsl:if test="(OA36) and (not(OA36 = '-'))">cat_1227 </xsl:if>
       <xsl:if test="(OA60) and (not(OA60 = '-'))">cat_1881 </xsl:if>
       <xsl:if test="(F0) and (F0 = 'Z01')">cat_1229 </xsl:if>
       <xsl:if test="(F0) and (F0 = 'X01')">cat_1802 </xsl:if>
     </xsl:variable>
     <xsl:variable name="system">
       <xsl:choose>
         <xsl:when test="F0">
           <xsl:value-of select="F1"/>
         </xsl:when>
         <xsl:when test="(OA23) or (OA30) or (OA36) or (OA60)">
           <xsl:value-of select="system"/>
         </xsl:when>
       </xsl:choose>
     </xsl:variable>
     <xsl:variable name="TE">
       <xsl:choose>
         <xsl:when test="F0">
           <xsl:value-of select="F2"/>
         </xsl:when>
         <xsl:when test="(OA23) or (OA30) or (OA36) or (OA60)">
           <xsl:value-of select="TE"/>
         </xsl:when>
       </xsl:choose>
     </xsl:variable>
     <xsl:variable name="P1">
       <xsl:choose>
         <xsl:when test="F0">
           <xsl:value-of select="P1s"/>
         </xsl:when>
         <xsl:when test="(OA23) or (OA30) or (OA36) or (OA60)">
           <xsl:value-of select="P1"/>
         </xsl:when>
       </xsl:choose>
     </xsl:variable>
     <xsl:variable name="P2">
       <xsl:choose>
         <xsl:when test="F0">
           <xsl:value-of select="P2s"/>
         </xsl:when>
         <xsl:when test="(OA23) or (OA30) or (OA36) or (OA60)">
           <xsl:value-of select="P2"/>
         </xsl:when>
       </xsl:choose>
     </xsl:variable>
     <xsl:variable name="description">
       <xsl:choose>
         <xsl:when test="F0">
           <xsl:value-of select="Sdescription"/>
         </xsl:when>
         <xsl:when test="(OA23) or (OA30) or (OA36) or (OA60)">
           <xsl:value-of select="description"/>
         </xsl:when>
       </xsl:choose>
     </xsl:variable>

     <xsl:if test="not(contains($system,'_'))">
       <xsl:if test="3 = string-length($system)">
         <tr class="sys ovs_{generate-id(msxml:node-set($system))} {$tags}" id="sys_{generate-id(msxml:node-set($system))}"  >
           <td onclick="sys('{generate-id(msxml:node-set($system))}',1)" class="label">
                <xsl:value-of select="$system"/>
           </td>

          <xsl:variable name="systemname" select="translate($system,$ucletters,$lcletters)" />

          <td onclick="sys('{generate-id(msxml:node-set($system))}',1)" class="color">
              <xsl:if test="(OA23) and (not(OA23 = '-'))">
                <span class="cc" style="width:8px;background-color:#4DAA5B;">&nbsp;&nbsp;</span>
              </xsl:if>
              <xsl:if test="(OA30) and (not(OA30 = '-'))">
                <span class="cc" style="width:8px;background-color:#EDEA87;">&nbsp;&nbsp;</span>
              </xsl:if>
              <xsl:if test="(OA36) and (not(OA36 = '-'))">
                <span class="cc" style="width:8px;background-color:#EA6A00;">&nbsp;&nbsp;</span>
              </xsl:if>
              <xsl:if test="(OA60) and (not(OA60 = '-'))">
                <span class="cc" style="width:8px;background-color:#C897CC;">&nbsp;&nbsp;</span>
              </xsl:if>
              <xsl:if test="(F0) and (F0 = 'Z01')">
                <span class="cc" style="width:8px;background-color:#829ED8;">&nbsp;&nbsp;</span>
              </xsl:if>
              <xsl:if test="(F0) and (F0 = 'X01')">
                <span class="cc" style="width:8px;background-color:#9FAD00;">&nbsp;&nbsp;</span>
              </xsl:if>
          </td>
          <td onclick="sys('{generate-id(msxml:node-set($system))}',1)" class="kw">
                <span class="keyword"><xsl:value-of select="$description"/>&nbsp;</span>
          </td>
        </tr>

      </xsl:if>

      <xsl:if test="5 = string-length($system)">
        <xsl:if test="(3 > string-length($TE)) or (not($TE))">

          <xsl:variable name="tags2">
            <xsl:if test="(OA23) and (not(OA23 = '-'))">cat_1223 </xsl:if>
            <xsl:if test="(OA30) and (not(OA30 = '-'))">cat_1868 </xsl:if>
            <xsl:if test="(OA36) and (not(OA36 = '-'))">cat_1227 </xsl:if>
            <xsl:if test="(OA60) and (not(OA60 = '-'))">cat_1881 </xsl:if>
            <xsl:if test="(F0) and (F0 = 'Z01')">cat_1229 </xsl:if>
            <xsl:if test="(F0) and (F0 = 'X01')">cat_1802 </xsl:if>
          </xsl:variable>
          <xsl:variable name="second_level_id" select="generate-id(msxml:node-set($system))" />
          <tr id="sys_{generate-id(msxml:node-set($system))}" style="display:none" class="sys2 {generate-id(msxml:node-set($system))} {$tags2}">

              <td style="padding-left:30px; width:190px;" onclick="sys('{generate-id(msxml:node-set($system))}',2)" class="label">
                  <xsl:value-of select="$system"/>
              </td>
             <td class="gallery_icon">
                &nbsp;
              </td>
              <td onclick="sys('{generate-id(msxml:node-set($system))}',2)">&nbsp;</td>
              <td class="keyword" onclick="sys('{generate-id(msxml:node-set($system))}',2)">
                <xsl:value-of select="$description"/>
              </td>
          </tr>
        </xsl:if>
      </xsl:if>
      <xsl:if test="($TE) and (not($TE = '-')) and (not($TE = ''))">
        <xsl:variable name="tags3">
          <xsl:if test="(OA23) and (not(OA23 = '-'))">cat_1223 </xsl:if>
          <xsl:if test="(OA30) and (not(OA30 = '-'))">cat_1868 </xsl:if>
          <xsl:if test="(OA36) and (not(OA36 = '-'))">cat_1227 </xsl:if>
          <xsl:if test="(OA60) and (not(OA60 = '-'))">cat_1881 </xsl:if>
          <xsl:if test="(F0) and (F0 = 'Z01')">cat_1229 </xsl:if>
          <xsl:if test="(F0) and (F0 = 'X01')">cat_1802 </xsl:if>
        </xsl:variable>
        <xsl:variable name="third_level_id" select="generate-id(msxml:node-set($TE))" />
        <tr id="sys_{generate-id(msxml:node-set($TE))}"  style="display:none" class="sys3 sub_{second_level_id} {generate-id(msxml:node-set($TE))} {$tags3}">

            <td style="padding-left:60px; width:160px;" onclick="sys('{generate-id(msxml:node-set($TE))}',3)" class="label">
                <xsl:value-of select="$TE"/>
            </td>
          <td class="gallery_icon">
              &nbsp;
            </td>
            <td onclick="sys('{generate-id(msxml:node-set($TE))}',3)">&nbsp;</td>
            <td class="keyword" onclick="sys('{generate-id(msxml:node-set($TE))}',3)">
              <xsl:value-of select="$description"/>
            </td>
        </tr>
      </xsl:if>
      <xsl:if test="($P1) and (not($P1 = '-')) and (not($P1 = ''))">       
        <xsl:variable name="tags4">
          <xsl:if test="(OA23) and (not(OA23 = '-'))">cat_1223 </xsl:if>
          <xsl:if test="(OA30) and (not(OA30 = '-'))">cat_1868 </xsl:if>
          <xsl:if test="(OA36) and (not(OA36 = '-'))">cat_1227 </xsl:if>
          <xsl:if test="(OA60) and (not(OA60 = '-'))">cat_1881 </xsl:if>
          <xsl:if test="(F0) and (F0 = 'Z01')">cat_1229 </xsl:if>
          <xsl:if test="(F0) and (F0 = 'X01')">cat_1802 </xsl:if>
        </xsl:variable>
        <xsl:variable name="fourth_level_id" select="generate-id(msxml:node-set($P1))" />
        <tr id="sys_{generate-id(msxml:node-set($P1))}"  style="display:none" class="sys4 sub_{third_level_id} subi_{second_level_id} {generate-id(msxml:node-set($P1))} {$tags4}">

            <td style="padding-left:90px; width:130px;" onclick="sys('{generate-id(msxml:node-set($P1))}',4)" class="label">
                <xsl:value-of select="$P1"/>
            </td>
          <td class="gallery_icon">
              &nbsp;
            </td>
            <td onclick="sys('{generate-id(msxml:node-set($P1))}',4)">&nbsp;</td>
            <td class="keyword" onclick="sys('{generate-id(msxml:node-set($P1))}',4)">
              <xsl:value-of select="$description"/>
            </td>
        </tr>
      </xsl:if>
      <xsl:if test="($P2) and (not($P2 = '-')) and (not($P2 = ''))">
        <xsl:variable name="tags5">
          <xsl:if test="(OA23) and (not(OA23 = '-'))">cat_1223 </xsl:if>
          <xsl:if test="(OA30) and (not(OA30 = '-'))">cat_1868 </xsl:if>
          <xsl:if test="(OA36) and (not(OA36 = '-'))">cat_1227 </xsl:if>
          <xsl:if test="(OA60) and (not(OA60 = '-'))">cat_1881 </xsl:if>
          <xsl:if test="(F0) and (F0 = 'Z01')">cat_1229 </xsl:if>
          <xsl:if test="(F0) and (F0 = 'X01')">cat_1802 </xsl:if>
        </xsl:variable>
        <tr id="sys_{generate-id(msxml:node-set($P2))}"  style="display:none" class="sys5 subi_{third_level_id} subi_{second_level_id} sub_{fourth_level_id} {generate-id(msxml:node-set($P2))} {$tags5}">

            <td style="padding-left:120px; width:100px;" onclick="sys('{generate-id(msxml:node-set($P2))}',5)" class="label">
                <xsl:value-of select="$P2"/>
            </td>
          <td class="gallery_icon">
              &nbsp;
            </td>
            <td onclick="sys('{generate-id(msxml:node-set($P2))}',5)">&nbsp;</td>
            <td class="keyword" onclick="sys('{generate-id(msxml:node-set($P2))}',5)">
              <xsl:value-of select="$description"/>
            </td>
        </tr>
      </xsl:if>
    </xsl:if>
  </xsl:for-each>
 </table>
 </xsl:template>
 </xsl:stylesheet> 
```

我正在尝试从上一个获取唯一 ID。tr 并在当前行中使用它..

我想使用变量：

```
<xsl:variable name="second_level_id" select="generate-id(msxml:node-set($system))" /> 
```

在这一行：

```
<tr id="sys_{generate-id(msxml:node-set($TE))}"  style="display:none" class="sys3 sub_{second_level_id} {generate-id(msxml:node-set($TE))} {$tags3}"> 
```

等等。

如果有任何更好的方法来完成所有这些，我会得到完全相同的输出，但是使用上面的所需变量，我很想听听。

*   马蒂亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:10:19.410

这是您应该能够完成此操作的一种方法：

替换这个：

```
<xsl:for-each select="$loc/rdsppGenData/generatorData"> 
```

和：

```
<xsl:variable name="locItems" select="$loc/rdsppGenData/generatorData" />
<xsl:apply-templates select="$locItems[1]">
  <xsl:with-param name="remainder" select="$locItems[position() > 1" />
</xsl:apply-templates> 
```

将此添加到您的 XSLT：

```
<xsl:template match="generatorData">
  <xsl:param name="remainder" />
  <xsl:param name="last_second_level_id" />
  <xsl:param name="last_third_level_id" />

  <!-- Move the contents of the xsl:for-each in here -->

  <xsl:apply-templates select="$remainder[1]">
    <xsl:with-param name="remainder" select="$remainder[position() > 1]" />
    <xsl:with-param name="last_second_level_id" select="$second_level_id" />
    <xsl:with-param name="last_thirdlevel_id" select="$second_level_id" />
  </xsl:apply-templates>
</xsl:template> 
```

# wordpress - 主题安装后添加导航菜单

> ID：15554648
> 
> 赞同：0
> 
> 时间：2013-03-21T17:50:25.113
> 
> 标签：wordpress

我正在创建一个 wordpress 模板，我需要添加一些菜单导航项。Wordpress 是否具有允许我在主题安装后添加菜单项的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:56:17.020

Humba，是的，检查一下

定义菜单 您必须先定义菜单，然后才能向其中添加项目。

步骤 1 登录 WordPress 仪表板。

从仪表板左侧的“外观”菜单中，选择“菜单”选项以调出菜单编辑器。

在“菜单名称”框中输入新菜单的名称

单击创建菜单按钮。

步骤 2 将项目添加到菜单

屏幕选项允许您选择可用于添加到菜单的项目。默认情况下隐藏某些项目，例如帖子。

找到标题为“页面”的窗格。

在此窗格中，选择查看全部链接以显示您网站上所有当前发布的页面的列表。

通过单击每个页面标题旁边的复选框来选择要添加的页面。

单击位于此窗格底部的添加到菜单按钮，将您的选择添加到您在上一步中创建的菜单中。

滚动回菜单编辑器。

单击保存菜单按钮。

Ok Humba 那里有很多材料，您也可以查看此链接。 [http://codex.wordpress.org/WordPress_Menu_User_Guide](http://codex.wordpress.org/WordPress_Menu_User_Guide)

# jquery - 鼠标移动时的动画菜单

> ID：15554652
> 
> 赞同：0
> 
> 时间：2013-03-21T17:50:33.787
> 
> 标签：jquery, mousemove

我有一个功能，当鼠标移动到屏幕左侧时，我想从页面左侧进入菜单。并且当鼠标离开左侧时滑动离开页面左侧。

问题是因为该功能总是记录我的鼠标移动，如果鼠标移动它会注册它已经过了点并不断切换菜单。我需要它只在经过某个 X 坐标时才切换菜单

JS：（编辑代码）

```
$("#gridcontainer").mousemove(function(e){

 var pageCoords = "( " + e.pageX + ", " + e.pageY + " )";
 var clientCoords = "( " + e.clientX + ", " + e.clientY + " )";
 $("span:first").text("( e.pageX, e.pageY ) : " + pageCoords);
 $("span:last").text("( e.clientX, e.clientY ) : " + clientCoords);

 var sideMenu = $('.side-menu');

 if (e.pageX < 100 && $('.side-menu').is(":visible")){
    console.log('make visible');
    sideMenu.animate({"left":"-96px"}, 1000);

 }
 else if(!$('.side-menu').is(":visible")){
    sideMenu.animate({"left":"-96px"}, 1000);
    console.log('hide');

 } 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:00:20.403

听起来您只需要检查菜单是否正在显示。尝试类似的东西

```
 $("#gridcontainer").mousemove(function(e){

    var pageCoords = "( " + e.pageX + ", " + e.pageY + " )";
    var clientCoords = "( " + e.clientX + ", " + e.clientY + " )";
    $("span:first").text("( e.pageX, e.pageY ) : " + pageCoords);
    $("span:last").text("( e.clientX, e.clientY ) : " + clientCoords);

    var sideMenu = $('.side-menu');

    if (e.pageX < 100 && $('.side-menu').is(":visible")){
       console.log('make visible');
       sideMenu.show();
       sideMenu.animate({"left":"-96px"}, 1000);

    }
    else if(!$('.side-menu').is(":visible")){
       sideMenu.animate({"left":"-96px"}, 1000);
       sideMenu.hide();
       console.log('hide');

     } 
```

你甚至可以让你的 show() 函数为你做动画。有关一些示例，请参见[此处](http://api.jquery.com/show/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:55:06.467

您可以添加一个切换布尔变量，该变量在事件激活时触发，并在鼠标移回该侧时更改。然后只需检查该变量的状态是否是动画即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:56:01.810

也许您可以在左侧放置一个不可见的绝对 div 并使用 mouseIn 和 mouseOut 函数。

您还可以添加一个类，并且仅在该类不存在时才运行开放代码。同样与关闭。仅在类存在时运行。

你也可以做 (e.pageX == 99) 和 else if (e.pageX == 101)。在 else 中，您运行类似于您现在所拥有的代码，以确保它关闭/打开以防这些数字未注册。

# apache-flex - DataGrid 列值未与 labelFunction 一起显示

> ID：15554660
> 
> 赞同：0
> 
> 时间：2013-03-21T17:51:00.983
> 
> 标签：apache-flex, flex-spark

我有一个使用 labelFunction 的 Spark DataGrid。但是它没有显示任何结果。

```
var c3:GridColumn = new GridColumn("Date Added");
c3.width = 150;
//c3.dataField = "date";

c3.labelFunction = getFormattedDateNoTimeGrid;

public function getFormattedDateNoTimeGrid(item:Object, column:GridColumn):String
{
    var rawDate:String = item.date;
    trace("Date:" + rawDate); 
    return rawDate;
} 
```

使用前面的代码，它只显示标签函数并正确跟踪所有日期。如果我删除 dateField 行，则该列不为空，但它不是 label 函数返回的值。基本上标签函数没有显示它应该显示的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:11:05.263

多么痛苦。Flash Builder“帮助”我为我的网格列创建了一个项目渲染器，其中包含以下功能：

```
override public function prepare(hasBeenRecycled:Boolean):void {
    lblData.text = data[column.dataField];
} 
```

该函数覆盖了 dataField 和 labelFunction 的功能。我删除了它，一切都很好。感谢大家的帮助。

# vbscript - 我可以强制 MSBuild.exe 在 VBS（64 位 Windows 7）中完成吗？

> ID：15554661
> 
> 赞同：0
> 
> 时间：2013-03-21T17:51:02.257
> 
> 标签：vbscript, msbuild, windows-7-x64

关于代码示例的故事：我正在使用 vb 脚本进行自动化测试构建，我看到以下行在 32 位和 64 位 Windows 7 中的执行方式不同：

```
CmdLine ("cmd /c C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe C:\Users\tester_kafka\Documents\VisualStudio2012\Projects\CFX_Manager_UITest\CFX_Manager_UITest.sln") 
```

其中 CmdLine 是这样的函数：

```
Function CmdLine(strCommand) 
Set WshShell = CreateObject("WScript.Shell") 
Set WshShellExec = WshShell.Exec(strCommand) 
Do While WshShellExec.Status = 0
WScript.Sleep 100 
Loop 
End Function 
```

在 32 位 Windows 7 系统中，构建完成，vb 脚本继续完成。在 64 位 Windows 7 系统中，cmd 窗口保持打开状态，直到手动关闭，然后脚本继续完成。当然，目标是自动化 64 位脚本以自动进行。

我尝试将 & 退出添加到该行，并将 /nr:false 切换到 MSBuild.exe 并弄乱引号（坦率地说，不知道还有什么可以尝试的......）。我应该做一些更简单的事情吗？为什么操作系统会产生如此大的差异？

任何信息都会受到欢迎，即使它不是解决方案。谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:43:42.363

尝试这个：

```
Function CmdLine(strCommand) 
Set WshShell = CreateObject("WScript.Shell") 
WshShell.Run strCommand, , true
End Function 
```

# excel - 似乎无法使用条件格式隐藏跟随的超链接

> ID：15554662
> 
> 赞同：2
> 
> 时间：2013-03-21T17:51:02.703
> 
> 标签：excel, excel-2007

我今天遇到了一个需要帮助的奇怪行为。我有一个范围（A2：C3），我使用条件格式根据是/否下拉列表（A1）隐藏。它基本上将字体/边框/和背景颜色设置为白色。有一个带有超链接 (A3) 的单元格用于清除范围格式 (A2:C3) 的内容，更改范围格式时应包含该内容。

在您单击链接之前它运行良好，然后由于某种原因它不包含在条件格式的范围中。关于获得跟踪超链接以充当新超链接的解决方案的任何想法？我想将所有内容都保留在条件格式方案中，以节省大量工作，但如果需要 VBA，那很好。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:36:49.647

选择列、行或单元格。

格式化单元格

取消选中普通字体。

:)

这会取消选择超链接之类的自动格式化。

# windows - 如何将文件内容分配给变量？

> ID：15554664
> 
> 赞同：0
> 
> 时间：2013-03-21T17:51:04.007
> 
> 标签：windows, if-statement, for-loop, batch-file, cmd

```
@echo off
SET str1=type %1
SET str2=type %2
echo File1: %str1%
echo 
echo File2: %str2% 
```

你可能知道我想要什么，但命令行解释器不知道。如何正确地做到这一点？

**PS。**我的意思是整个内容，不仅仅是第一行！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:54:42.660

对于内容（所有行）：

```
@echo off &setlocal enabledelayedexpansion
set "files=1"
if "%~1"=="" set "files="
if "%~2"=="" set "files="
if not defined files echo Missing filename(s^).&goto:eof
:: read the first file
set /a cnt1=0
for /f "usebackqdelims=" %%i in ("%~1") do set /a cnt1+=1 &set "str1!cnt1!=%%i"
:: read the second file
set /a cnt2=0
for /f "usebackqdelims=" %%i in ("%~2") do set /a cnt2+=1 &set "str2!cnt2!=%%i"
:: write the first file
echo File1:
for /l %%i in (1,1,%cnt1%) do echo !str1%%i!
:: write the second file
echo File2:
for /l %%i in (1,1,%cnt2%) do echo !str2%%i!
endlocal 
```

# dynamics-crm-2011 - 通过 FetchXML 获取相关实体计数

> ID：15554668
> 
> 赞同：2
> 
> 时间：2013-03-21T17:51:17.157
> 
> 标签：dynamics-crm-2011

我有以下 fetchXML 代码用于返回相关实体的总数。主要实体名称为**new_transaction**，相关实体名称为**new_transactionproduct**。

下面的代码放置在 web 资源 javascript 中，但是当调用此函数时，它永远不会成功或错误部分，它只是挂起。

```
 function countLineItems()
 {
 var ID = Xrm.Page.data.entity.getId();
 var fetchXml = "<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' aggregate='true'>";
 fetchXml += "<entity name='new_transactionproduct'>";
 fetchXml += "<attribute name='new_name' alias='recordcount' aggregate='countcolumn' />";
 fetchXml += "<filter type='and'>";
 fetchXml += "<condition attribute='new_transactionid' operator='eq' value='" + ID + "' />";
 fetchXml += "</filter>";
 fetchXml += "</entity>";
 fetchXml += "</fetch>";
 alert(fetchXml);
 XrmSvcToolkit.fetch({
        fetchXml: fetchXml,
        async: false,
        successCallback: function (result) {
            var countValue =  result.entities[0].recordcount;
 alert(countValue);
    //Xrm.Page.getAttribute(new_totalqty).setValue(countValue);
        },
        errorCallback: function (error) {
            throw error;
        }
 });
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T10:49:05.267

只是一个快速的旁注，你总是可以像下面这样设置你的 fetchXML 来最小化你附加到字符串的次数。

```
string fetchXml = @"<fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' aggregate='true'>
                        <entity name='new_transactionproduct'>
                             <attribute name='new_name' alias='recordcount' aggregate='countcolumn' />
                               <filter type='and'>
                                 <condition attribute='new_transactionid' operator='eq' value='" + ID + @"' />
                               </filter>
                        </entity>
                    </fetch>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T23:27:28.613

XrmSvcToolkit 需要作为 Web 资源添加并在页面上引用。

# wcf - （网站）上的网页可能暂时关闭，或者它可能已永久移动到新网址

> ID：15554669
> 
> 赞同：4
> 
> 时间：2013-03-21T17:51:18.787
> 
> 标签：wcf, web-services, iis

我在 VS2010 中开发了一个 wcf Web 服务。Web服务在VS2010中运行良好，在同一解决方案中添加了对项目（winform）的Web服务引用，一切正常，方法调用，很好。

当我部署我的网络服务时，我得到：

```
The webpage at (website) might be temporarily down or it may have moved permanently to a new web address. 
```

我是 WCF Web 服务的新手，我需要部署什么才能使其正常工作？

我部署了 .svc 文件和 web.config。我在 bin 目录中部署了所有 .dll 文件。

我检查了我的项目文件夹，有一个 Web.config、Web.Release.config 和 Web.Debug.config。

我需要部署 Web.Release.config 吗？但是里面的内容不多：

```
<?xml version="1.0"?>

<!-- For more information on using web.config transformation visit http://go.microsoft.com/fwlink/?LinkId=125889 -->

<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

     <system.web>
        <compilation xdt:Transform="RemoveAttributes(debug)" />
     </system.web>

</configuration> 
```

在我的 Web.config 中，我有 appsettings、绑定、服务和所有内容，我是否需要复制我的 Web.Release.config 文件中的所有内容？

任何解决方案/建议？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:35:42.010

要托管您的 WCF 项目（或 IIS 中的任何项目，就此而言），值得阅读[Hosting in Internet Information Services](http://msdn.microsoft.com/en-us/library/ms734710.aspx)。您可以按照[WCF Service Publishing](http://msdn.microsoft.com/en-us/library/bb924407.aspx)中的说明部署您的项目。

对于示例解决方案，假设您使用的是装有 IIS 7 的计算机。在管理员工具下打开 Internet 信息服务 (IIS) 管理器。

首先，我们将选择或创建一个应用程序池供我们的应用程序使用。它可以使用现有的应用程序池，只要它使用相同的 .NET 版本，或者您可以创建一个新的。你可能会有类似的东西：

![IIS_AppPool](../Images/8a80bc1906eb06d4bfd4404e0e60e26b.png)

接下来，您将选择一个站点来托管您的 WCF 服务。您可以使用现有站点或创建新站点。我将只使用默认网站，并将添加应用程序...

![IIS_AddApplication](../Images/e7f69b463927caf5863dea86b1db1f9f.png)

此物理路径将是您部署 WCF 项目的位置。假设您的主机名为 MyHostMachine。要部署您的 WCF，请右键单击您的项目，选择发布... 在该弹出窗口中，选择 Web 部署的发布方法，设置服务 URL（例如：）`http://MyHostMachine`和站点/应用程序（例如：）`Default Web Site/MyWcfService`。

注意：如果您有任何权限问题阻止您进行 Web 部署，那么您可以简单地部署到本地文件系统中的某个位置，然后将全部内容从那里复制到主机上的应用程序目录。

# solr - Drupal 7 Apache Solr 在 Facets 配置覆盖中搜索缺少的字段

> ID：15554675
> 
> 赞同：0
> 
> 时间：2013-03-21T17:51:28.663
> 
> 标签：solr, drupal-7

我是 Drupal、apachesolr 和 facetapi 的新手。我在搜索环境中定义了默认服务器；Facets 配置没有列出我的一些文章字段（文章实体类型配置为索引）。我创建了第二个环境，它列出了与默认环境相同的有限方面。关于如何列出所有文章字段的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:14:08.650

Apache solr 在其构面配置页面中包含的字段应该只是**选择类型字段或分类术语**或类似的字段。

如果您有一个只是常规“文本”或“整数”或“链接”字段的字段，则它不会出现在该构面配置页面中，因为这些类型的字段不能很好地用作构面。

如果您想要一个必须用作构面的字段，请确保将其类型设置为可以从列表中选择的类型。那有意义吗？那是你的问题吗？

# c++ - CppCMS 教程：静态链接模板错误（控制器问题）

> ID：15554676
> 
> 赞同：0
> 
> 时间：2013-03-21T17:51:29.210
> 
> 标签：c++, cppcms

来自[http://cppcms.com/wikipp/en/page/cppcms_1x_tut_hello_templates#The.controller](http://cppcms.com/wikipp/en/page/cppcms_1x_tut_hello_templates#The.controller)

我在底部放置了以下代码`hello.cpp`：

```
virtual void main(std::string /*url*/)
{
    content::message c;
    c.text=">>>Hello<<<";
    render("message",c);
} 
```

运行时`g++ hello.cpp my_skin.cpp -o hello -lcppcms -lbooster`，报错：

```
hello.cpp:44:38: error: ‘virtual’ outside class declaration
hello.cpp:44:38: error: ‘::main’ must return ‘int’
hello.cpp:44:14: warning: first argument of ‘int main(std::string)’ should be ‘int’ [-Wmain]
hello.cpp:44:14: warning: ‘int main(std::string)’ takes only zero or two arguments [-Wmain]
hello.cpp: In function ‘int main(std::string)’:
hello.cpp:44:38: error: declaration of C function ‘int main(std::string)’ conflicts with
hello.cpp:27:5: error: previous declaration ‘int main(int, char**)’ here
hello.cpp: In function ‘int main(std::string)’:
hello.cpp:48:23: error: ‘render’ was not declared in this scope 
```

我错过了什么吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:57:32.040

错误消息告诉你你需要知道的一切。

1.  `virtual`只能在类中使用。您的主要方法不在类中。
2.  该`main`方法必须返回一个`int`. 你的回来了`void`。
3.  您有两种主要方法，一种是`main(std::string)`，一种是`main(int, char**)`
4.  你的 render 方法必须在 main 方法之上有一个函数原型，否则整个方法都需要我移动。

所以这会更合适：

```
void render(std::string, std::string) // or whatever
{
   // do something
}

int main(int argc, char** argv)
{
   render("string", c);
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T16:35:15.480

您的 hello.cpp 应如下所示：

```
#include <cppcms/application.h>
#include <cppcms/applications_pool.h>
#include <cppcms/service.h>
#include <cppcms/http_response.h>
#include <iostream>
#include "content.h"

class hello : public cppcms::application {
public:
    hello(cppcms::service &srv) : cppcms::application(srv) {}
    virtual void main(std::string url);
};

void hello::main(std::string /*url*/){
    content::message cc;
    cc.text=">>>Hello<<<";
    render("message", cc);
}

int main(int argc,char ** argv){
    try {
        cppcms::service srv(argc,argv);
        srv.applications_pool().mount(cppcms::applications_factory<hello>());
        srv.run();
    }
    catch(std::exception const &e) {
        std::cerr<<e.what()<<std::endl;
    }
} 
```

# javascript - 如何阻止 jQuery-Clean 插件删除空格？

> ID：15554685
> 
> 赞同：3
> 
> 时间：2013-03-21T17:52:34.833
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用这个插件：[链接](https://code.google.com/p/jquery-clean/)

像这样：

```
$('.postListingDescription')
  .html(
    $.htmlClean(description, { 
      allowedTags : ["p", "b", "i", "u", "ul", "li", "a", "strong", "em", "br"] 
    })
  ); 
```

不幸的是，这也会删除任何空白，禁止任何段落区分并将所有内容放在一个不返回的长字符串中。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:25:24.643

如果没有可用的选项，最简单的方法是替换它（jquery.htmlClean.js 的第 485 行）：

```
function textClean(text) {
        return text
            .replace(/&nbsp;|\n/g, " ")
            .replace(/\s\s+/g, " ");
    } 
```

对此：

```
function textClean(text) {
            return text
        } 
```

但同样，你不应该使用空格来控制你的布局。
所以你可以做的是用`<p>`评论中提到的标签替换所有   ：

```
$this.html().replace(/\s\s+/g, '<p></p>') 
```

# python - 在 Python 中替换双反斜杠和括号

> ID：15554687
> 
> 赞同：1
> 
> 时间：2013-03-21T17:52:40.787
> 
> 标签：python, pandoc, multimarkdown

我正在尝试编写一个脚本，该脚本可以将诸如`\\[`或`\\]`转换为之类的东西`$$`，以便将 MultiMarkdown 文档转换为可以在 HTML 中显示方程式的 Pandoc markdown 文档。我正在使用 Python 来查找这些字符的所有实例

```
 matchstring=r'\\['
 re.sub(matchstring,'$$',content) 
```

但是我遇到以下错误：

```
unexpected end of regular expression:line 15:matchstring=re.compile(r'\\[')
File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/re.py", line 190:
return _compile(pattern, flags)
File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/re.py", line 245:
raise error, v # invalid expression 
```

很可能是因为`[`我在那里的最后一个。有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:55:59.640

逃脱`[`：

```
matchstring=re.compile(r'//\[') 
```

或者更好的是，使用：

```
content.replace("//[", "$$") 
```

并且根本不涉及正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T04:51:55.300

```
pandoc -f markdown_mmd -t markdown 
```

会为你做这件事！（对于 pandoc >= 1.11）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:54:41.123

你的问题是你写`r'//['`，不是`r'\\['`，但无论如何尝试更好：

```
matchstring.replace(r'\\[', '$$').replace(r'\\]', '$$') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T18:26:12.507

如果您在正则表达式中使用“[”，我会假设它需要在正则表达式中使用时对其进行转义。

尝试以下方法之一：

```
content = "testing123//]testing456"
matchstring = "//]"
result = content.replace(matchstring, "$$")
print result 
```

或者

```
content = "testing123//]testing456"
matchstring = '(//\])'
result = re.sub(matchstring,'$$',content)
print result 
```

要么应该为您的目的工作。

# php - 使用 php 将复杂的 xml 提要转换为 csv

> ID：15554690
> 
> 赞同：0
> 
> 时间：2013-03-21T17:52:51.213
> 
> 标签：php, xml

我有一个需要使用 curl 访问的 xml 数据源。我试图获取 curl 输出并使用 XMLReader 读取每个节点，但它没有工作。因为当我使用 curl 加载提要时，它需要大约 1-2 分钟，因为它很大。

所以我的想法是将提要下载到我的服务器并将其转换为 csv 并将其上传到我的数据库。所以我可以将它与 cron 一起使用来保持我的数据库更新。

我发现这段代码在普通的 xml 提要中似乎可以正常工作，但它似乎不适用于我的提要。

在这个提要中

```
<cars>
<car>
 <color>blue</color>
 <price>2000</price>
</car>
<car>
 <color>red</color>
 <price>10000</price>
</car> 
<car>
 <color>black</color>
 <price>5000</price>
</car>
</cars> 
```

当我使用下面的代码时，它可以工作。

```
$filexml='cars.xml';
if (file_exists($filexml)) {
    $xml = simplexml_load_file($filexml);
$f = fopen('cars.csv', 'w');
foreach ($xml->car as $car) {
    fputcsv($f, get_object_vars($car),',','"');
}
fclose($f);
} 
```

但是当涉及到下面的提要时，我如何更改上面的代码以将模型、图片、图像、类型....添加到 csv 中？

```
 <cars>
<car>
 <color>blue</color>
 <price>2000</price>
 <model />
  <pictures>
    <image>1.jpg</image>
    <image>2.jpg</image>
  </pictures>
  <type>
   <bodykit>yes</bodykit>
   <turbo>no</turbo>
   <sound>surround</sound>
 </type>
</car>
<car>
 <color>red</color>
 <price>10000</price>
<model>GTX</model>
  <pictures>
    <image>5.jpg</image>
  </pictures>
  <type>
   <bodykit>yes</bodykit>
   <turbo>no</turbo>
   <sound>no</sound>
 </type>
 </car> 
 <car>
 <color>black</color>
 <price>5000</price>
 <model>GTX</model>
  <pictures>
    <image>5.jpg</image>
    <image>8.jpg</image>
  </pictures>
  <type>
   <bodykit>yes</bodykit>
   <turbo>no</turbo>
   <sound>surround</sound>
 </type>
</car>
</cars> 
```

任何帮助或想法将不胜感激......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:38:16.337

这是你可以尝试的东西

```
$filexml='cars.xml';

    if (file_exists($filexml)) 
           {
       $xml = simplexml_load_file($filexml);
       $f = fopen('cars.csv', 'w');
       createCsv($xml, $f);
       fclose($f);
    }

    function createCsv($xml,$f)
    {

        foreach ($xml->children() as $car) 
        {

           $hasChild = (count($car->children()) > 0)?true:false;

        if( ! $hasChild)
        {
           $put_arr = array($car->getName(),$car); 
           fputcsv($f, $put_arr ,',','"');

        }
        else
        {
         createCsv($car, $f);
        }
     }

    } 
```

# python - 查找每列中出现次数最多的元素的最简单方法

> ID：15554691
> 
> 赞同：1
> 
> 时间：2013-03-21T17:52:52.600
> 
> 标签：python, list, matrix

假设我有

```
data =
[[a, a, c],
 [b, c, c],
 [c, b, b],
 [b, a, c]] 
```

我想得到一个列表，其中包含每列中出现次数最多的元素：`result = [b, a, c]`，最简单的方法是什么？

我使用 Python 2.6.6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T20:04:22.497

在统计中，您想要的称为*模式*。scipy 库 ( [http://www.scipy.org/](http://www.scipy.org/) ) 有一个`mode`功能，在`scipy.stats`.

```
In [32]: import numpy as np

In [33]: from scipy.stats import mode

In [34]: data = np.random.randint(1,6, size=(6,8))

In [35]: data
Out[35]: 
array([[2, 1, 5, 5, 3, 3, 1, 4],
       [5, 3, 2, 2, 5, 2, 5, 3],
       [2, 2, 5, 3, 3, 2, 1, 1],
       [2, 4, 1, 5, 4, 4, 4, 5],
       [4, 4, 5, 5, 2, 4, 4, 4],
       [2, 4, 1, 1, 3, 3, 1, 3]])

In [36]: val, count = mode(data, axis=0)

In [37]: val
Out[37]: array([[ 2.,  4.,  5.,  5.,  3.,  2.,  1.,  3.]])

In [38]: count
Out[38]: array([[ 4.,  3.,  3.,  3.,  3.,  2.,  3.,  2.]]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T17:53:24.943

使用列表理解加[`collections.Counter()`](http://docs.python.org/2/library/collections.html#collections.Counter)：

```
from collections import Counter

[Counter(col).most_common(1)[0][0] for col in zip(*data)] 
```

`zip(*data)`将您的列表重新排列为列列表。`Counter()`对象计算输入序列中出现的频率，并`.most_common(1)`为我们提供最流行的元素（加上它的计数）。

如果您的输入是单个字符串，则给出：

```
>>> [Counter(col).most_common(1)[0][0] for col in zip(*data)]
['b', 'a', 'c'] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T17:56:28.137

数据是否可散列？如果是这样， a[`collections.Counter`](http://docs.python.org/2/library/collections.html#counter-objects)会有所帮助：

```
[Counter(col).most_common(1)[0][0] for col in zip(*data)] 
```

它之所以有效，是因为`zip(*data)`一次转置输入数据产生 1 列。然后计数器对元素进行计数并将计数存储在字典中，并将计数作为值。 `Counters`还有一个`most_common`方法，它返回具有最高计数的“N”个项目的列表（从最多计数到最少计数排序）。因此，您希望获取 most_common 返回的列表中第一项中的第一个元素，这是`[0][0]`来自的地方。

例如

```
>>> a,b,c = 'abc'
>>> from collections import Counter
>>> data = [[a, a, c],
...  [b, c, c],
...  [c, b, b],
...  [b, a, c]]
>>> [Counter(col).most_common(1)[0][0] for col in zip(*data)]
['b', 'a', 'c'] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T18:21:40.040

这是一个不使用集合模块的解决方案

```
def get_most_common(data):

    data = zip(*data)
    count_dict = {}
    common = []
    for col in data:
        for val in col:
            count_dict[val] = count_dict.get(val, 0) + 1
        max_count = max([count_dict[key] for key in count_dict])
        common.append(filter(lambda k: count_dict[k] == max_count, count_dict))

    return common

if __name__ == "__main__":

    data = [['a','a','b'],
            ['b','c','c'],
            ['a','b','b'],
            ['b','a','c']]

    print get_most_common(data) 
```

# amazon-sqs - 以 json 格式返回 SQS 响应

> ID：15554693
> 
> 赞同：1
> 
> 时间：2013-03-21T17:52:57.560
> 
> 标签：amazon-sqs

有没有办法将 SQS Api 的响应作为 Json？

我需要这样做，因为我需要从浏览器中获取队列的信息，但由于它是跨域的，它需要在 json(p) 中

@see[使用 jQuery 从跨域 Ajax 请求接收 XML 响应](https://stackoverflow.com/questions/15552375/receive-xml-response-from-cross-domain-ajax-request-with-jquery-nor-yql-either)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:23:38.490

SQS 不提供 JSON 接口。你可以在你的网络服务器上实现一个代理，它以你想要的任何格式返回信息。这也将消除跨域问题。

# avl-tree - 权重不平衡的 AVL 树

> ID：15554694
> 
> 赞同：6
> 
> 时间：2013-03-21T17:52:58.280
> 
> 标签：avl-tree

相信维基百科的文章：[http ://en.wikipedia.org/wiki/AVL_tree](http://en.wikipedia.org/wiki/AVL_tree)

> AVL 树是高度平衡的，但通常不是重量平衡的，也不是 μ 平衡的；[4] 也就是说，兄弟节点可以有非常不同数量的后代。

但是，作为 AVL 树：

> 自平衡二叉搜索树 [...]。在 AVL 树中，任何节点的两个子子树的高度最多相差 1

我看不出 AVL 是如何重量不平衡的，因为 - 如果我很好地理解 AVL 树的定义 - 每个兄弟姐妹将有大约相同数量的孩子，因为它们具有相同的高度 +/- 1。

那么，你能给我一个不平衡的 AVL 树的例子吗？我没有成功找到一个。因此，或者我误解了 AVL/未加权树的定义，或者维基百科的文章是错误的......

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T19:38:08.727

您的理解是正确的，AVL 树是由其边缘节点的几乎均匀的高度定义的，但您的困惑似乎是关于节点位置和边缘权重之间的差异。

也就是说：在 AVL 树中，边缘节点的深度将是相同的 +/-（但不是两者！）之一。这没有声称与节点之间的边相关的成本。对于具有根节点和两个子节点的 AVL 树，左侧路径的遍历成本可能是右侧路径的两倍。这将使树的权重不平衡，但仍保持 AVL 树的定义。

此页面包含更多信息：[权重平衡树 - 维基百科](http://en.wikipedia.org/wiki/Weight-balanced_tree)

来自维基百科：

> 二叉树称为 μ-balanced，![方程](../Images/1459683b242f9df106e30897b6aef5f2.png)如果对于每个节点 N，不等式： ![mu平衡不等式](../Images/3d239ea0d7df611235ccaab07ed87061.png)
> 
> 成立，并且 μ 在此属性下是最小的。|N| 是以 N 为根（包括根）的树下的节点数，Nl 是 N 的左子树。

本质上，这意味着 AVL 树中的孩子不一定均匀分布在树的最低层。以 N 表示树的根节点，可以构造一棵有效的 AVL 树，它的根左侧的子节点多于其右侧的子节点。对于非常深的树，在这个底层可能有很多节点。

AVL 树的定义要求它们都在最深点之一内，但不能保证它们是相对于节点 N 的子节点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-10T15:37:20.413

> 兄弟节点可以有非常不同数量的后代。

我只是对这个问题摸不着头脑，事实上我的 AVL 实现生成的树最终并没有不平衡，但里面有越来越大的“远亲”子树。

我画了这个草图来安慰自己：

![在此处输入图像描述](../Images/5f3081383530474c4bf37d15299e2f05.png)

红色节点的余额为 1，绿色节点为 -1，黑色节点为 0。这是一个有效的 AVL 树，因为两个兄弟子树之间的高度差永远不会超过 1，但有（几乎）两倍右子树中的许多节点作为左子树。

# clojure - Clojure 手指树和 flexvec

> ID：15554696
> 
> 赞同：7
> 
> 时间：2013-03-21T17:53:01.350
> 
> 标签：clojure, finger-tree

我正在寻找一种持久的顺序数据结构，它允许有效的随机插入和删除。我发现了以下实现：

*   [clojure.data.finger-tree](https://github.com/clojure/data.finger-tree) (counted-double-list 实现)
*   [wgjo.data.cljs](https://github.com/wagjo/data.cljs)
*   [flexvec](https://github.com/michalmarczyk/flexvec)

由于过去两年在 clojure.data.finger-tree 中没有太多活动，而其他活动相对较新，我想知道是否有人在生产中使用过这些中的任何一个，以及我是否有其他选择被忽视了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-02T11:43:25.877

另一个实现[clojure/core.rrb-vector](https://github.com/clojure/core.rrb-vector)被[宣布](https://groups.google.com/forum/?fromgroups#!topic/clojure/Z7wtm2Lepj0)。由于它位于 clojure github 帐户中，因此它似乎将成为事实上的实现。

# python - 金字塔：如何将一个类的多个方法配置为不同的视图

> ID：15554698
> 
> 赞同：0
> 
> 时间：2013-03-21T17:53:06.140
> 
> 标签：python, pyramid

我只是想让这个工作，但它没有：

```
class Test12:
    def __init__(self, request):
        self.request = request

    @view_config(route_name='test1')
    def test1(self):
        return Response('I am from test 1')

    @view_config(route_name='test2')
    def test2(self):
        return Response('Hi there from test2')

config.add_route('test1', '/test1')
config.add_route('test2', '/test2') 
```

对于 URL`/test1`和-- 返回方法返回`/test2`的响应。`test2()`我应该如何让它正常工作？（或者我在这里遗漏了什么？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T07:13:39.663

最可能的问题是您的原始（而非粘贴）代码中的缺陷，您不小心将这两个方法命名为相同的名称。

# javascript - 从 Spring MVC 列表属性填充 HTML 有序列表

> ID：15554699
> 
> 赞同：1
> 
> 时间：2013-03-21T17:53:07.703
> 
> 标签：javascript, list, jsp, spring-mvc, html-lists

在我的 Spring Controller 中，我有一系列的方向。我想使用那个数组，或者把它做成一个列表，然后在我的 JSP 页面上填充一个有序列表。

例如，我已经在我的 JSP 页面上使用来自我的控制器的列表属性填充了一个下拉列表。

代码...

控制器

```
ResultSet result = select.executeQuery("SELECT DISTINCT make FROM data ORDER BY make");
List<LabelValueModel> dropDownItems = new ArrayList<LabelValueModel>();
while (result.next()) {
       String make = result.getString(1);
       LabelValueModel item = new LabelValueModel(make, make);  
       dropDownItems.add(item);
}
model.addAttribute("dropDownItems", dropDownItems); 
```

JSP

```
<form:select path="dropDownItems" id="carMake" onchange="selectedMake(this.value)"><br />
    <form:option label="Please select a make" value="" disabled="disabled" selected="selected"/>
    <form:options items="${dropDownItems}" itemLabel="label" itemValue="value"/>
</form:select> 
```

我想要做的，或者类似的事情，就是这个。显然这段代码是不正确的......

控制器（仅在示例中保持不变）

```
ResultSet result = select.executeQuery("SELECT DISTINCT make FROM data ORDER BY make");
List<LabelValueModel> dropDownItems = new ArrayList<LabelValueModel>();
while (result.next()) {
       String make = result.getString(1);
       LabelValueModel item = new LabelValueModel(make, make);  
       dropDownItems.add(item);
}
model.addAttribute("dropDownItems", dropDownItems); 
```

但是对于JSP，我想做这样的事情......

```
<ol>
  <li items="${dropDownItems}" itemValue="value"></li>
</ol> 
```

希望有人知道我想要做什么可以帮助我！谢谢！

回答...

我在控制器的情况下使用了数组而不是列表

控制器...

```
String[] dropDownItems = new String[3];
dropDownItems[0] = "foo1";
dropDownItems[1] = "foo2";
dropDownItems[2] = "foo3";
model.addAttribute("dropDownItems", dropDownItems); 
```

JSP...

```
<c:forEach items="${dropDownItems}" var="item">
    <li>${item}</li>
</c:forEach> 
```

结果...

*   foo1
*   foo2
*   foo3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:01:58.713

没有内置的 Spring JSTL 标签来创建带有单个标签的有序或无序列表，至少我不知道。您将需要使用循环，如下所示：

```
<c:forEach items="${dropDownItems}" var="item">
   <li>${item.value}</li>
</c:forEach> 
```

您的替代方法是编写自己的标签来执行此操作。

# sql - 用 List 替换 DataTable、DataSet

> ID：15554703
> 
> 赞同：0
> 
> 时间：2013-03-21T17:53:21.907
> 
> 标签：sql, linq, linq-to-sql

我从 Net 1.1 开始就在开发这个应用程序。这些年来它一直在使用 - 3 层，演示、业务和数据。

数据层主要使用 DataSets 和 DataTables 从 SQL 获取数据，为了获得更透明的编码，我想使用更多的强类型列表。

我正在考虑保持数据层不变，并使用业务层来构建从数据层检索到的数据。基本上我想声明新类并返回强类型列表。

这是一个好方法，我是否需要数据层（为了将数据从 sql 获取到数据表，然后再次将其转换为 List）或者有更好的方法将数据直接拉入业务层的列表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:57:12.227

将数据拉入业务层的最佳方式是使用 ORM，例如：
[Entity Framework](http://msdn.microsoft.com/en-us/data/ef.aspx)或
[NHibernate](http://nhforge.org/)。[或像Massive](https://github.com/robconery/massive)或[Dapper.net](https://code.google.com/p/dapper-dot-net/)
这样的 微型 ORM 。

如果您不打算使用它们，那么您仍然需要拥有 DAL 对象，然后在 BLL 中填充您的 BO。

# java - Mandelbrot 刷新速度很慢，有什么办法让它更快？

> ID：15554705
> 
> 赞同：1
> 
> 时间：2013-03-21T17:53:25.773
> 
> 标签：java, math, complex-numbers, fractals, mandelbrot

我最近一直在研究分形生成器，并且一直在专门研究 Mandelbrot 集。不幸的是，缩放和移动似乎非常低效，需要很长时间才能刷新。每次缩放时我都会生成它，我知道这可能不是最有效的方法，而且我似乎找不到使用我理解的另一种方法的代码。这些是我使用的以下方法，第一个是初始生成，第二个是刷新方法。

```
 private void genMandelbrot(Dimension size) {
    for(int x=0;x<size.width;x++) {
        for(int y=0;y<size.height;y++) {
            double moveX=globalx;
            double moveY=globalx;
            //zoom and x/y offset.
            double real = 1.5 * (x - size.width / 2) / (0.5 * zoom * size.width) + moveX;
            double imaginary=(y - size.height / 2) / (0.5 * zoom * size.height) + moveY;
            double newRe=0,newIm=0,oldRe=0,oldIm=0;

            int i;
            for(i=0;i<8000;i++) {
                oldRe = newRe;
                oldIm = newIm;
                newRe = oldRe * oldRe - oldIm * oldIm + real;
                newIm = 2 * oldRe * oldIm + imaginary;
                if((newRe * newRe + newIm * newIm) > 4) break;
            }

            Cell c = new Cell(Color.getHSBColor(i % 256, i % 255, 255 * ((i<20)? 1:0)), new Dimension(1,1), new Point(x,y));
            cells.add(c);
        }
    }
}
public void refreshMandelbrot(Dimension size) {
    for(Cell c : cells) {
            double moveX=globalx;
            double moveY=globalx;
            int x=c.x;
            int y=c.y;
            //zoom and x/y offset.
            double real = 1.5 * (x - size.width / 2) / (0.5 * zoom * size.width) + moveX;
            double imaginary=(y - size.height / 2) / (0.5 * zoom * size.height) + moveY;
            double newRe=0,newIm=0,oldRe=0,oldIm=0;

            int i;
            for(i=0;i<8000;i++) {
                oldRe = newRe;
                oldIm = newIm;
                newRe = oldRe * oldRe - oldIm * oldIm + real;
                newIm = 2 * oldRe * oldIm + imaginary;
                if((newRe * newRe + newIm * newIm) > 4) break;
            }

            cells.set(cells.indexOf(c), new Cell(Color.getHSBColor(i % 256, i % 255, 255 * ((i<20)? 1:0)), new Dimension(1,1), new Point(x,y)));
    }
    System.out.println("Set refreshed.");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:43:42.983

我想这`cells`是某种`List`实现？

在这种情况下，刷新方法的大部分时间都花在了这一行：

`cells.set(cells.indexOf(c), new Cell(Color.getHSBColor(i % 256, i % 255, 255 * ((i<20)? 1:0)), new Dimension(1,1), new Point(x,y)));`

更准确地说`cells.indexOf(c)`，在整个列表中迭代以找到 的正确索引`c`。

由于您只是更改每个单元格的颜色，因此最简单的解决方法是更改​​您当前正在使用的单元格的颜色。我不知道你的`Cell`类的实际实现，但如果它有一个方法`setColor(...)`，你可以用上面的行替换

`c.setColor(Color.getHSBColor(i % 256, i % 255, 255 * ((i<20)? 1:0)));`

这将方法的运行时间减少到与`refreshMandelbrot`方法相同`genMandelbrot`。

我不知道`Cell`该类的用途，但是如果您仅将其用作颜色的包装器，则如果将每个像素的计算颜色存储在二维数组中或直接写入，您可能会获得更多性能a `Graphics`or `Raster`object 而不是处理单元格包装器的平面列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:13:53.103

Most likely you need to subdivide the fractal and compute the less interesting tiles less intense. 8000 repetiton is a lot. You can also simplify the calculation a bit.

# html - 使用 Vim 缩进所有标签

> ID：15554706
> 
> 赞同：2
> 
> 时间：2013-03-21T17:53:27.250
> 
> 标签：html, vim

如何在 Vim 中为所有 HTML 标签添加一个缩进级别，类似于它处理 XML 的方式？

例子：

Vim 缩进使用 HTML 格式。只有某些标签是缩进的：

```
<% provide(:title, @user.name) %>
<div class="row">
   <aside class="span4">
   <section>
   <h1>
      <%= gravatar_for @user %>
      <%= @user.name %>
   </h1>
   </section>
   </aside>
</div> 
```

Vim 缩进使用 XML 格式。所有标签都缩进：

```
<% provide(:title, @user.name) %>
<div class="row">
   <aside class="span4">
      <section>
         <h1>
            <%= gravatar_for @user %>
            <%= @user.name %>
         </h1>
      </section>
   </aside>
</div> 
```

我希望我的 HTML 缩进对每个标签都有一个缩进，就像 XML 一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:05:29.563

您似乎在使用 HTML5，但 Vim 的 HTML 相关脚本不适用于 HTM5。

你需要一个更新的 HTML5 缩进脚本让 Vim 识别这些新标签。试试 vim.org 或 Github。

XML 缩进脚本之所以有效，是因为 XML 没有预定义的一组标签，因此该脚本旨在适应您向其添加的任何标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:59:25.810

您可以使用`=`和 的完整组合：

```
gg=G 
```

As 从文件的开头 (gg) 到结尾 (G) 进行更改。

# javascript - 当窗口大小小于时更改菜单元素

> ID：15554707
> 
> 赞同：0
> 
> 时间：2013-03-21T17:53:32.967
> 
> 标签：javascript, jquery, navigation, scroll

我正在尝试制作一个网站，但我有一个问题（有点）。我已经达到了我想要的效果（就像在 myprovence.fr 中一样） - 滚动后捕捉。这仅适用于窗口大小大于 939 的情况（基本上它必须是全高清显示器）。这样就万事大吉了。但是，如果窗口大小小于 939，我想做正常滚动，但导航完全正常 - 当您点击（滚动到）另一个部分时 - 菜单点变为活动状态（这是一个[示例](http://vandelaydesign.com/demos/single-page/)）。我怎样才能做到这一点？我对 jQuery 和 js 很陌生。

我正在尝试在此[站点](http://in.codelab.lt/pr/)上执行此操作（导航脚本在 main.js 中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:55:48.103

为什么不改用 CSS`@media queries`呢？

```
@media all and (max-width: whatever px) and (min-width: whatever px) {
  /*Classes and Id's, elements goes here*/
} 
```

# javascript - 使占位符中的所有按钮具有相同的单击事件触发器

> ID：15554710
> 
> 赞同：0
> 
> 时间：2013-03-21T17:53:39.127
> 
> 标签：javascript, asp.net, html, vb.net

我有一个占位符

```
<div class="main2" id="divAgentMenu" runat="server">
    <ul class="nav sf-menu">
        <asp:PlaceHolder ID="phAgentMenu" runat="server"></asp:PlaceHolder>        
    </ul>
</div> 
```

它在后面的代码中加载了链接按钮。不幸的是，此时我无权访问生成按钮的代码，因此向按钮添加东西（如 ID）是不可行的。（如果这是唯一的解决方案，那么我该看看我是否能做到这一点但是改变了）只是为了让事情更有趣，我需要知道触发了哪个按钮，这样我才能生成正确的链接。（是的，我可以按原样生成链接，但这是一项昂贵的操作，所以我宁愿仅在需要时执行）我希望有一种方法可以将 onclick 应用于占位符或使用表单，但是我无法使这两种方法都起作用

生成的代码，来自运行时。

```
<ul class="nav sf-menu">

    <li class="home-li"><a class="home-link" onclick="popup(&#39;popUpDiv&#39;)" href="http://..."><img class="home-icon" src="Images/home_icon.png" alt="home" />Home&nbsp;&nbsp;</a><ul><li><a onclick="popup(&#39;popUpDiv&#39;)" href="http://...">Activity</a></li><li><a onclick="popup(&#39;popUpDiv&#39;)" href="http://...">My Profile</a></li></ul></li><li><a onclick="popup(&#39;popUpDiv&#39;)" href="http://...">Submission&nbsp;&nbsp;</a><ul><li><a onclick="popup(&#39;popUpDiv&#39;)" href="http://...">New Submission</a></li><li><a onclick="popup(&#39;popUpDiv&#39;)" href="http://...">Manage Submission</a></li><li><a onclick="popup(&#39;popUpDiv&#39;)" href="http://...">Bind Eligible Quotes</a></li></ul></li><li><a onclick="popup(&#39;popUpDiv&#39;)" href="http://...">Search&nbsp;&nbsp;</a></li><li><a href="http://..." target="_blank">Reporting&nbsp;&nbsp;</a>

</ul> 
```

生成的代码（网址因过长而被删除。）（它们是有效的）基本上，它是一系列看起来很漂亮的按钮，每个按钮都链接到某个地方。我需要在按下按钮后计算链接，而不是之前计算链接，遗憾的是，由于处理时间（链接生成方法涉及加入多个数据表，一些加密......）

好的，经过进一步的研究，似乎唯一的方法是将所有链接按钮直接指向另一个页面，传递所需的信息。另一个页面获取该信息，生成最终链接，然后重定向到该链接。

当然，这有点麻烦，因为我本质上是在获取菜单，指向一个网关，该网关指向另一个网关，该网关可能指向另一个网关，然后再到达那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:24:51.800

根据您的评论，听起来您想在执行默认链接行为并且页面重定向之前计算单击链接时要转到的实际链接。你可以这样做：

```
$('#phAgentMenu').find('a').live('click', function(e) {
    e.preventDefault(); //this prevents the link from redirecting
    //now calculate your link
    var linkDestination = yourLinkCalculation();
    window.location.href = linkDestination;
}); 
```

# java - 为什么我随机选择的数字输出包含重复项？

> ID：15554712
> 
> 赞同：1
> 
> 时间：2013-03-21T17:53:48.530
> 
> 标签：java, random, arraylist

我的代码需要从 到 的列表中随机选择 6 个`1`数字`45`。

有一次，当我运行我的代码（如下）时，输出是 `[4, 4, 17, 18, 27, 37]`. **我没想到输出中有任何重复。怎么可能有重复？**我的代码应该在`list`选择它们时从中删除数字。

```
 Random rng = new Random(); 
    int size = 45;
    int sixList[] = new int[6];
    ArrayList<Integer> list = new ArrayList<Integer>(size);
    ArrayList<Integer> list2 = new ArrayList<Integer>(6);
    for(int i = 1; i <= size; i++) {
        list.add(i);
    }
    Random rand = new Random();
    for(int i = 0; list.size() > 39; i++){
        int index = rand.nextInt(list.size());
        if (index == 0){
            index = rand.nextInt(list.size());
            list2.add(index);
            list.remove(index);
        }else{
            list2.add(index);
            list.remove(index);
        }
    }
    Collections.sort(list2);
    System.out.print(list2); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:00:10.483

问题是您将索引值添加到随机数列表中。

更改您的代码

```
list2.add(index);
list.remove(index); 
```

至

```
list2.add(list.remove(index)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:58:48.643

List 维护索引，根本不关心重复元素。为避免重复，您必须使用 Set 而不是 List。如果您在 Set 中有任何用户定义的类，那么不要忘记**实现 equals() 和 hashcode()**，它们用于确定元素是否由 Set 类（如 HashSet）重复。

如果您的 Set 中有原语，那么请忘记重复，因为对于 int、long 等原始数据类型将自动处理重复。**所以我建议您使用 Set 而不是 List。避免集合中的重复元素**

# asp.net - 对网站的统计攻击

> ID：15554713
> 
> 赞同：2
> 
> 时间：2013-03-21T17:53:58.253
> 
> 标签：asp.net, security, flooding

背景（有点读）

我们创建了一个缩短的 url 重定向器（使用 asp.net Url Routing 和一个全面的 404 路由），其中从设备扫描条形码，然后从移动设备重定向到目标站点。我们记录所有传入的请求以进行统计分析。自上周一晚上以来，已经有大量请求和随后的重定向到目标站点。通常我会说“WooHoo！” 但是涌入似乎过于一致，并且来自不同的 IP（但分批）和对不同 URL 的同步请求。只有一组有效的重定向 url 但涌入只击中那些指定的 url（即似乎不是暴力攻击）。这些网址是公开的，但只能从内部员工或从已出版杂志的代码中扫描获得。

来自请求的大多数用户代理基本上来自，显然，iPhone 和大多数 IP 是本地的，这增加了神秘感（将显示示例记录的请求和统计信息）。为了减轻涌入，我们首先实现了一个 ip 阻止规则（在代码级别），如果在 90 秒内有 3 次尝试，我们将 ip 添加到阻止列表中（将该规则从帽子中拉出：oP），我们开始捕获一些. 如果被阻止，我们基本上终止了会话。但这条规则可能会影响合法用户（因为它影响了内部员工......在白名单上工作但尚未完成）所以我们决定采用另一种策略，即插页式广告。

我们实现了登录页面，而不是用户需要交互并单击按钮继续的重定向。我们仍然有针对滥用行为的 ip 阻止规则。因此，如果合法用户通过，他们只需单击按钮即可继续。如果“访问者”在阻止列表中，我们会实施一个验证码例程，以查看他们继续进行的意图是否合法（诚然，这不是一个很好的用户体验）。

我还实现了 robots.txt 拒绝所有。我什至在登录页面中放置了一个隐藏链接，以查看是否是爬虫，但到目前为止，我还没有通过它跟踪任何流量。

我的技术合作伙伴曾认为这可能是实际苹果设备/应用程序/浏览器中的一个故障，导致它重新加载保存的扫描网址（条形码阅读器应用程序，如 RedLaser、i-nigma 等），但这似乎很奇怪这种情况继续发生。

因此，即使在实现了登陆页面之后，我们仍然会获得登陆页面但没有继续/点击的流量。这就是为什么我认为这是一种攻击，不是为了损害网站，而是为了扭曲网站统计数据的可能竞争对手？统计数据在业务中很重要，但重要的是合法的统计数据。我们不想弄乱我们的客户。它也可能是内容的 scapers，但由于用户代理和我的陷阱不起作用，我不知道......它实际上是否是人类在进行点击/扫描......迷路了。

有没有人经历过这样的事情？

```
 Some stats over a period of approximately 2.5 days...

            Count   HTTP_USER_AGENT
        2924    Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146
        506 Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
        424 Mozilla/5.0 (iPod; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146
        401 Mozilla/5.0 (iPhone; CPU iPhone OS 6_0_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A523
        202 Mozilla/5.0 (iPhone; CPU iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B141
        180 Mozilla/5.0 (iPhone; CPU iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B144
        157 Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A403
        138 Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A405
        119 Mozilla/5.0 (iPhone; CPU iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B142
        119 Mozilla/5.0 (iPod; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
        111 Mozilla/5.0 (iPhone; CPU iPhone OS 6_0_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A551
        91  Mozilla/5.0 (iPhone; CPU iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B143
        88  Mozilla/5.0 (iPhone; CPU iPhone OS 5_0_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9A405
        86  Mozilla/5.0 (iPod; CPU iPhone OS 5_0_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9A405
        86  Mozilla/5.0 (iPod; CPU iPhone OS 6_0_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A523
        69  Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B208
        56  Mozilla/5.0 (iPhone; CPU iPhone OS 6_0_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A525
        54  Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_3 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B329
        47  Mozilla/5.0 (iPod; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A403
        46  Mozilla/5.0 (iPod; CPU iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B144
        45  Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.6 (KHTML, like Gecko) Chrome/20.0.1092.0 Safari/536.6
        43  Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B145
        30  Mozilla/5.0 (iPhone; CPU iPhone OS 6_0_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A550
        27  Mozilla/5.0 (iPod; CPU iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B141
        22  Mozilla/5.0 (Linux; Android 4.1.1; SGH-I747M Build/JRO03L) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.169 Mobile Safari/537.22
        21  Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MAM3)
        17  Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; InfoPath.2)
        16  Mozilla/5.0 (iPhone; CPU iPhone OS 5_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B176
        13  Mozilla/5.0 (iPod; CPU iPhone OS 5_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B176
        13  Mozilla/5.0 (BlackBerry; U; BlackBerry 9800; en) AppleWebKit/534.8+ (KHTML, like Gecko) Version/6.0.0.600 Mobile Safari/534.8+
        13  Qrafter/7.0 CFNetwork/609.1.4 Darwin/13.0.0

    For these stats, I took out source IPs (for courtesy)but referenced which ones were same...just a small sample out approximate 6.5K requests

    Count   REMOTE_ADDR HTTP_USER_AGENT
    5   A.B.C.D Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
    13  A.B.C.D Mozilla/5.0 (iPhone; CPU iPhone OS 6_0_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A523
    2   A.B.C.D Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146
    6   A.B.C.D Mozilla/5.0 (iPod; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146
    1   B.C.D.E Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
    3   B.C.D.E Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B145
    10  B.C.D.E Mozilla/5.0 (iPod; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A406
    15  C.D.E.F Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
    31  C.D.E.F Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A405
    20  C.D.E.F Mozilla/5.0 (iPhone; CPU iPhone OS 6_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B141
    2   D.E.F.G Mozilla/5.0 (iPod; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
    6   D.E.F.G Mozilla/5.0 (iPod; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A403
    2   D.E.F.G Mozilla/5.0 (iPod; CPU iPhone OS 6_0_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A523
    18  E.F.G.H Mozilla/5.0 (iPhone; CPU iPhone OS 6_0_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A550
    49  E.F.G.H Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146
    15  E.F.G.H Mozilla/5.0 (iPod; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
    13  E.F.I.J Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
    11  E.F.I.J Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10A403
    11  E.F.I.J Mozilla/5.0 (iPod; CPU iPhone OS 5_0_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9A405
    3   E.F.I.J Mozilla/5.0 (iPod; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206

Sample of typical sequntial flood

URL HTTP_USER_AGENT REMOTE_ADDR LogDate
http://SITEURL/UoetZx   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:45 AM
http://SITEURL/2NedO0   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:45 AM
http://SITEURL/33hCWl   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:44 AM
http://SITEURL/e11LzG   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:44 AM
http://SITEURL/bQx5Bu   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:43 AM
http://SITEURL/BtrZ3m   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:43 AM
http://SITEURL/cxfmr1   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:43 AM
http://SITEURL/KztehQ   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:42 AM
http://SITEURL/O19sq3   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:42 AM
http://SITEURL/e6Dlwb   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:42 AM
http://SITEURL/GGQ4ZO   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:41 AM
http://SITEURL/jjr_rM   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    A.B.C.D 3/21/13 1:40 AM
http://SITEURL/yIzVel   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:40 AM
http://SITEURL/D8M0_Y   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:39 AM
http://SITEURL/-GqaX9   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:38 AM
http://SITEURL/9o0Bv8   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:37 AM
http://SITEURL/65_ce8   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:35 AM
http://SITEURL/33hCWl   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:34 AM
http://SITEURL/2NedO0   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:33 AM
http://SITEURL/UoetZx   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:33 AM
http://SITEURL/fknpPf   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:31 AM
http://SITEURL/tLEI3S   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:30 AM
http://SITEURL/MgOvvm   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:29 AM
http://SITEURL/MlJVua   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:28 AM
http://SITEURL/UcRIZj   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:27 AM
http://SITEURL/xZy-KP   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:26 AM
http://SITEURL/sXswln   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:25 AM
http://SITEURL/aQJrWx   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:24 AM
http://SITEURL/_sBrUw   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:23 AM
http://SITEURL/V7H9mK   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:22 AM
http://SITEURL/lchtkL   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:21 AM
http://SITEURL/WY7g1T   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:20 AM
http://SITEURL/bQx5Bu   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:19 AM
http://SITEURL/FznevZ   Mozilla/5.0 (iPhone; CPU iPhone OS 6_1_2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Mobile/10B146    B.C.D.E 3/21/13 1:17 AM 
```

# twitter-bootstrap - 使用 Bootstrap 创建圣杯风格的布局

> ID：15554714
> 
> 赞同：4
> 
> 时间：2013-03-21T17:53:59.810
> 
> 标签：twitter-bootstrap, responsive-design

抱歉，如果这个问题已经得到解答，我找不到任何我想要的东西。

我正在尝试创建一个类似于[A List Apart 上的圣杯布局的响应式布局](http://alistapart.com/article/holygrail)

左边会有一个固定宽度的列，中间有一个可变宽度的列，然后右边有一个固定宽度的列。右列仅在超过一定宽度的窗口中可见，并且整个事物只会扩展到一定大小。

我创建了一个[jsFiddle，它完全符合我的要求](http://jsfiddle.net/XJGFP/)。

我的基本 HTML 如下所示：

```
<h1>Window Width: <span></span></h1>
<div id="container">

    <div id="center" class="column">
        <h1>Two</h1>
        <p>Width: <span></span></p>
    </div>

    <div id="left" class="column">
        <h2>One</h2>
        <p>Width: <span></span></p>
    </div>

    <div id="right" class="column">
        <h2>Three</h2>
        <p>Width: <span></span></p>
    </div>

</div> 
```

我的问题是，是否有可能在 Bootstrap 之类的东西中做到这一点。我认为如果可能的话，它可以为我节省一些时间，因为我需要让它在移动设备上工作，但是我不确定如何在单个 Bootstrap 布局中组合一些固定和非固定列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-14T12:58:57.730

我最近需要一个 Bootstrap 圣杯布局（3 个响应列，中心列在源排序中排在第一位，任何列都可以有最长的内容）。

原始标记：

```
<div class="container">
  <div class="row">

     <div id="center">
       ...
       center column content
       ...
     </div>

    <div id="left">
       ...
       left column content
       ...
    </div>

    <div id="right">
       ...
       right column content
       ...
    </div>
  </div>
</div> 
```

通过添加一组`-inset-`（margin-right）mixins/classes 来补充 Bootstrap （margin-left）mixins/classes，我可以通过使用这些以及围绕中心列内容`-offset-`的额外包装来实现布局。`div`

装饰标记：

```
<div class="container">
  <div class="row">

    <div id="center" class="col-xs-12 col-sm-inset--12">
      <div class="col-sm-offset-3 col-md-offset-3 col-md-inset-3 col-lg-offset-2 col-lg-inset-2">
         ...
         center column content
         ...
      </div>
    </div>

    <div id="left" class="col-xs-12 col-sm-3 col-lg-2">
       ...
       left column content
       ...
    </div>

    <div id="right" class="col-xs-12 col-md-3 col-lg-2">
       ...
       right column content
       ...
    </div>
  </div>
</div> 
```

JS 小提琴：[https ://jsfiddle.net/3n5Lvr84/](https://jsfiddle.net/3n5Lvr84/)

这个想法是中心列是 100% 宽度和 -100% 右侧边距，将左右列带到中心列的顶部，并且中心列内部元素为具有`-offset-`和`-inset-`边距的列腾出空间。

我已经在小提琴的 CSS 中包含了全套编译`-inset-`规则；您需要规则中的 0-12`-offset-`以及中心列外部元素的 -12。左右列源顺序可以通过改变元素来切换`float:right`。

最后，我发现使用 mixins 更整洁。这是通过重新利用 Bootstrap 的`mixins\_grid.scss`. 如果您更喜欢使用基于标记和类的 Bootstrap 响应式网格和/或 LESS ，则 LESS 混合器`mixins\_grid-frameword.scss`可以类似地重新调整用途。

`_inset.scss`

```
@mixin make-xs-column-inset($columns) {
  margin-right: percentage(($columns / $grid-columns));
}
@mixin make-sm-column-inset($columns) {
  @media (min-width: $screen-sm-min) {
    margin-right: percentage(($columns / $grid-columns));
  }
}
@mixin make-md-column-inset($columns) {
  @media (min-width: $screen-md-min) {
    margin-right: percentage(($columns / $grid-columns));
  }
}
@mixin make-lg-column-inset($columns) {
  @media (min-width: $screen-lg-min) {
    margin-right: percentage(($columns / $grid-columns));
  }
} 
```

帖子顶部原始标记的圣杯布局（一旦将包装 div 添加到`#center`）：

`_holygrail.scss`

```
@import "bootstrap/variables";
@import "bootstrap/mixins";
@import "_inset.scss";

#center {
  @include make-xs-column(12);
  @include make-sm-column-inset(-12);
  > div {
    @include make-sm-column-offset(3);
    @include make-md-column-offset(3);
    @include make-md-column-inset(3);
    @include make-lg-column-offset(2);
    @include make-lg-column-inset(2);
  }
}

#left {
  @include make-xs-column(12);
  @include make-sm-column(3);
  @include make-lg-column(2);
}

#right {
  @include make-xs-column(12);
  @include make-md-column(3);
  @include make-lg-column(2);
}

.container #right {
  float:right;
} 
```

[归功于https://stackoverflow.com/users/669044/clairesuzy](https://stackoverflow.com/users/669044/clairesuzy)使用的非响应式圣杯布局理念 (Tanfa flexi_floats)

# java - 如何使用数据库中的数据填充 JavaFX 选择框？

> ID：15554715
> 
> 赞同：5
> 
> 时间：2013-03-21T17:54:10.763
> 
> 标签：java, javafx

```
private void initialize() {
    loadPersistenceContext();

    List<Events> events = getEventsChoiceBox(getPersistenceContext());
    ObservableList<Event> data = FXCollections.observableList(events);

    cbEvent.setItems(data); // Inserting data into the ChoiceBox
} 
```

这是我的主要代码。问题是加载表单时，我将对象插入到选择框中，而不是属性。

这是我的列表事件的内容

```
Object[]
|- String
|- Integer
Object[]
|- String
|- Integer 
```

所以我想要一个带有 String 属性的 ChoiceBox，并且 Integer 映射到我的控制器。

我尝试了很多东西，但无法弄清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-21T02:27:55.953

这是[forums.oracle.com的另一个简单实现](https://forums.oracle.com/message/10351588)

为键值创建一个类

```
public class KeyValuePair {
   private final String key;
   private final String value;
   public KeyValuePair(String key, String value) {
   this.key = key;
   this.value = value;
   }

  public String getKey()   {    return key;    }

  public String toString() {    return value;  }
} 
```

然后将 ChoiceBox 创建为：

```
ChoiceBox<KeyValuePair> choiceBox = new ChoiceBox<KeyValuePair>(); 
```

将元素填充为；

```
choiceBox .getItems().add(new KeyValuePair("1", "Active")); 
```

*提示：将数据库中的键值对检索到 ArrayList 中并进行迭代*

要检索值：

```
choiceBox.getValue().getKey();  // returns the "1"
choiceBox.getValue().toString();  // returns the "Active" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T18:29:21.507

[请参阅由 Database IDs 支持的 JavaFX ChoiceBox 控件](https://gist.github.com/jewelsea/1422104)示例。

该示例通过定义一个 Choice 类来工作，该类由数据库行 ID 和要在“选择”框中显示的项目的字符串表示形式组成。Choice的默认`toString`方法被自定义实现覆盖，该实现返回要显示的项目的字符串表示形式，而不是数据库 ID。当您将选项添加到 ChoiceBox 时，ChoiceBox 会将每个选项转换为字符串以供显示。Choice 的显示字符串值只是选择文本，而不包括数据库 ID 或使用`toString`仅显示无意义对象引用的默认选项 Choice。

选择框示例应用程序的输出：

![选择框示例应用程序的输出](../Images/e3fedffa480ea818d05aee191cb1d1e8.png)

还可以考虑使用[ComboBox](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ComboBox.html)来实现这种实现，因为它内置了一种机制，可以从节点的显示中抽象出节点的值（通过[CellFactory](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ComboBox.html#cellFactoryProperty)）。然而，使用 a`ComboBox`通常比 a 更复杂`ChoiceBox`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-28T20:20:48.663

或者干脆做：`myChoiceBox.setConverter(myStringConverter)`，传入你自己的`javafx.util.StringConverter`( [JavaDoc](https://docs.oracle.com/javase/8/javafx/api/javafx/util/StringConverter.html "JavaDoc") ) 子类的实例。

覆盖 toString（和 fromString）使您可以完全控制对象的显示方式，而无需`toString`在对象本身中实现 ​​a。

# r - 一个语句中有多个 plyr 函数和操作？

> ID：15554722
> 
> 赞同：1
> 
> 时间：2013-03-21T17:54:24.897
> 
> 标签：r, dataframe, plyr

我有一个数据集如下：

```
i,o,c
A,4,USA
B,3,CAN
A,5,USA
C,4,MEX
C,1,USA
A,3,CAN 
```

我想将此数据集改造成如下形式：

```
i,u,o,c
A,3,4,2
B,1,3,1
C,2,2.5,1 
```

这里，u 表示数据集中变量 i 的唯一实例，o = (o / u 的总和)，c = 唯一国家。

我可以通过以下语句和使用 plyr 得到你：

```
count(df1,vars="i") 
```

我还可以通过使用从我[之前](https://stackoverflow.com/questions/15535719/matching-and-adding-factor-counts-in-r-data-frames)的问题中学到的见解来获得一些其他变量。我可以费力地保存到多个数据帧，然后最终将它们连接在一起以实现我的预期结果，我想知道是否有一条线优化，或者只是比我目前的冗长方式更好的方法。

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T18:20:17.663

我不明白这与您之前的问题有何不同。方法是一样的：

```
library(plyr)
ddply(mydf, .(i), summarise, 
      u = length(i), 
      o = mean(o),
      c = length(unique(c)))
#   i u   o c
# 1 A 3 4.0 2
# 2 B 1 3.0 1
# 3 C 2 2.5 2 
```

* * *

如果您更喜欢`data.table`解决方案：

```
> library(data.table)
> DT <- data.table(mydf)
> DT[, list(u = .N, o = mean(o), c = length(unique(c))), by = "i"]
   i u   o c
1: A 3 4.0 2
2: B 1 3.0 1
3: C 2 2.5 2 
```

# asp.net - 正则表达式 - 将文本附加到 youtube 链接的“src”字段

> ID：15554723
> 
> 赞同：0
> 
> 时间：2013-03-21T17:54:24.997
> 
> 标签：asp.net, regex, vb.net, youtube

我有以下字符串 -

```
<iframe width="425" height="349" src="http://www.youtube.com/embed/8tPnX7OPo0Q" frameborder="0" allowfullscreen></iframe> 
```

我需要将以下文本添加到“src”字段的末尾 - `?wmode=transparent`- 以便最终字符串如下所示 -

```
<iframe width="425" height="349" src="http://www.youtube.com/embed/8tPnX7OPo0Q?wmode=transparent" frameborder="0" allowfullscreen></iframe> 
```

谁能告诉我如何在asp.net中使用正则表达式来做到这一点...我之前只使用正则表达式替换了文本。

* * *

我试过下面的代码，但我不熟悉......谁能告诉我我做错了什么？

```
Dim test As String = "<iframe width=""425"" height=""349""
   src=""http://www.youtube.com/embed/8tPnX7OPo0Q"" frameborder=""0"" allowfullscreen>
</iframe>"

Dim regex1 As Regex = New Regex("src=(['""])(https?:\/\/[^ >]*?youtu\.?be[^ >]+?)(?=\1)")
Dim match1 As String = regex1.Replace(test, "src=\1\2?wmode=transparent") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:07:51.667

查找正则表达式：`src=(['"])(https?:\/\/[^ >]*?youtu\.?be[^ >]+?)(?=\1)`
替换为：`src=\1\2?wmode=transparent`
此处解释演示：[http ://regex101.com/r/bK8hC6](http://regex101.com/r/bK8hC6)

注意：这将允许`youtube.com`和`youtu.be`域名

**更新：**

执行：

```
Imports System.Text.RegularExpressions

...

Dim output As String = Regex.Replace(test, 
    "src=(['"])(https?:\/\/[^ >]*?youtu\.?be[^ >]+?)(?=\1)", 
    "src=\1\2?wmode=transparent") 
```

# razor - NancyFX，HtmlHelpers 的扩展方法 在 Razor 视图中无法识别

> ID：15554726
> 
> 赞同：0
> 
> 时间：2013-03-21T17:54:36.543
> 
> 标签：razor, nancy

我正在尝试使用 NancyFX 为 HtmlHelpers<T> 创建一个扩展方法。

代码是这样的

```
 public static IHtmlString DropdownList<T>(HtmlHelpers<T> htmlHelper, string elementId,     string elementName, IEnumerable<DropdownListItem> dropdownListItems)
  {
    var builder = new StringBuilder();
    if (dropdownListItems != null && dropdownListItems.ToList().Any())
    {
        dropdownListItems.ToList().ForEach(t => builder.AppendFormat(@"<option value=""{0}"" {1}>{2}</option>", t.Value, t.Selected ? "selected" : string.Empty, t.Text));
    }

    var htmlMarkup = string.Format(@"<select id=""{0}"" name=""{1}"">{2}</select>", elementId, elementName, builder);
    return new NonEncodedHtmlString(htmlMarkup);
  } 
```

在 cshtml 视图中无法识别此方法。我已经尝试过使用命名空间和没有命名空间。使用命名空间时，我已在 web.config 的 razor 部分注册它。

我正在使用的 NancyFX 版本：0.16.1.0

任何关于如何在 NancyFX 中使用带有剃刀视图的扩展方法的工作示例将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T20:39:49.747

哦蒙了！菜鸟错误。扩展方法有一个小错误。第一个参数缺少关键字**this**。

# javascript - 试图解决 js koan / about_array.js

> ID：15554727
> 
> 赞同：0
> 
> 时间：2013-03-21T17:54:38.420
> 
> 标签：javascript

我是 js 新手，我无法解决这个问题。

```
test("splice", function() {
    var daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    var workingWeek = daysOfWeek.splice(__);
    ok(workingWeek.equalTo([__]), 'what is the value of workingWeek?');
    ok(daysOfWeek.equalTo([__]), 'what is the value of daysOfWeek?');
}); 
```

我的尝试在下面，但它不起作用。

```
test("splice", function() {
    var daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    var workingWeek = daysOfWeek.splice(5,6);
    ok(workingWeek.equalTo([5]), 'what is the value of workingWeek?');
    ok(daysOfWeek.equalTo([2]), 'what is the value of daysOfWeek?');
}); 
```

有人可以为我提供任何线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:16:28.583

从[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice)：

> [`Array` `splice`方法]
> 
> `array.splice(index, howMany, […])`
> 
> 更改数组的内容，在删除旧元素的同时添加新元素
> 
> 返回 […] 一个包含已删除元素的数组。

因此，您当前的代码将删除 6 个元素，从第 6 个元素开始（在 index 上`5`，即 ie `'Saturday'`）。这有点太多了，只删除 2 就足够了，尽管在这里不会有任何区别——它们位于数组的末尾。

您可能想要实现的是

```
ok(workingWeek.equalTo(['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']), 'what is the value of workingWeek?');
// though it makes no practical sense, you are using splice():
ok(daysOfWeek.equalTo(['Saturday', 'Sunday']), 'what is the value of daysOfWeek?'); 
```

我将把更改参数的任务留给`splice(…)`你:-)

# java - 如何使 JTextComponent 的插入符号跳过选定的文本？

> ID：15554728
> 
> 赞同：3
> 
> 时间：2013-03-21T17:54:40.217
> 
> 标签：java, swing, selection, caret, jtextcomponent

许多环境中本机文本字段的正常行为如下：

带有文本“abcdefg”的文本字段。我用鼠标从左到右选择“efg”。插入符号现在位于“g”后面。当我通过按一次光标左键将插入符号向左移动时，选择被删除并且插入符号就在“e”之前。当我在 JTextField 或 JTextArea（在 Mac OS 上测试）中执行相同操作时，执行完全相同的操作会导致插入符号正好位于“g”之前。

我知道如何通过使用 KeyListener 并将其注册到每个组件来以编程方式更改它，但我正在寻找一种方法来为我的整个应用程序更改它。那可能吗？是否有标志，我没有找到或者我必须修改我的外观和感觉？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T20:37:02.810

> 我正在寻找一种方法来改变我的整个应用程序

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.text.*;

public class CaretAction extends TextAction
{
    private boolean caretForward;

    public CaretAction(boolean caretForward)
    {
        super(caretForward ? "Caret Forward" : "Caret Backward");
        this.caretForward = caretForward;
    }

    public void actionPerformed(ActionEvent e)
    {
        JTextComponent textComponent = getFocusedComponent();

        int start = textComponent.getSelectionStart();
        int end = textComponent.getSelectionEnd();
        int offset = textComponent.getCaretPosition();

        if (start != end)
        {
            if (caretForward)
                offset = (offset == end) ? offset + 1 : end;
            else
                offset = (offset == start) ? offset -1 : start;
        }
        else
        {
            offset += (caretForward) ? 1 : -1;
        }

        offset = Math.max(offset, 0);
        offset = Math.min(offset, textComponent.getDocument().getLength());
        textComponent.setCaretPosition( offset );
    }

    private static void createAndShowUI()
    {
        JTextField textField1 = new JTextField(10);
        JTextField textField2 = new JTextField(10);

        JPanel panel = new JPanel();
        panel.add( textField1 );
        panel.add( textField2 );

        JFrame frame = new JFrame("SSCCE");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add( panel );
        frame.pack();
        frame.setLocationByPlatform( true );
        frame.setVisible( true );

        ActionMap map = (ActionMap)UIManager.get("TextField.actionMap");
        map.put(DefaultEditorKit.backwardAction, new CaretAction(false));
        map.put(DefaultEditorKit.forwardAction, new CaretAction(true));
    }

    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                createAndShowUI();
            }
        });
    }
} 
```

您还需要更改 JTextArea、JFormattedTextField 的 ActionMap ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:14:06.557

What you can do is `addCaretListener` :

```
 anyField.addCaretListener(new CaretListener() {
        public void caretUpdate(CaretEvent evt) {
            anyFieldCaretUpdate(evt);
        }
       }); 
```

And set the Caret at the last again:

```
 private void anyFieldCaretUpdate(CaretEvent evt) {

     anyField.setCaretPosition(anyField.getText().length());
        } 
```

# c++ - C++ 碰撞检测在最后一次检查中不起作用？

> ID：15554735
> 
> 赞同：0
> 
> 时间：2013-03-21T17:55:07.210
> 
> 标签：c++, collision-detection

在过去的几天里，我一直在尝试实现使用 OpenGL 绘制的对象的简单碰撞检测。在我的帮助下，`Pearson, Computer Graphics with OpenGL`我设法编写了以下函数：

```
void move(){
    if(check_collision(sprite,platform1) || check_collision(sprite,platform2)){ //if colliding...
        if     (downKeyPressed ){ y_Vel += speed; downKeyPressed  = false;} //going down
        else if(upKeyPressed   ){ y_Vel -= speed; upKeyPressed    = false;} //going up
        else if(rightKeyPressed){ x_Vel -= speed; rightKeyPressed = false;} //going right
        else if(leftKeyPressed ){ x_Vel += speed; leftKeyPressed  = false;} //going left
    } // always glitches on whatever is last else if above?!?!
    else{ glTranslatef(sprite.x+x_Vel, sprite.y+y_Vel, 0.0); }
} 
```

我的精灵根据键盘输入（箭头键）移动。如果它与静止的物体碰撞，它会停止移动并保持在原来的位置。

到目前为止，它在与静止物体的顶部、左侧和底部发生碰撞时起作用。不幸的是（即使我使用相同的逻辑）右侧不起作用，并且在发生碰撞时，精灵会在其原始 x/y 坐标处重新绘制。我很困惑。

事实证明，`move()`函数中的最后一次检查（最后一个`else-if`）是那个不起作用的......我已经用 the 交换了`left`，`right`果然什么时候`left`最后一个和播放向上 ：（

关于如何改进这一点并阻止它出现故障的任何建议或想法？

请原谅我的天真和业余编码。我只是一个自学的开始。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:10:09.953

你不应该使用 else if。它有可能在同一帧中撞击侧面和顶部或底部。尝试将这些更改为所有如果，因为您想检查每一个。或至少将其更改为此。

```
if( /* check top */)
{

}
else if( /* check bot */)
{

}

if( /* check right */ )
{

}
else if( /* check left */)
{

} 
```

此外，您应该避免声明像 Y_VEL 和 X_VEL 这样​​的全局变量，因为这会造成混淆。你这样做可能只是为了弄湿你的脚，但我会避免这样做。为每个对象创建一个类，然后将速度作为该类的成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:41:47.487

正如您已经发现的那样，问题与 glTranslate() 有关。由于您对精灵的位置和速度都进行了操作，因此您应该使用速度重复更新位置。那是：

```
sprite.x += x_vel;
sprite.y += y_vel; 
```

并一直简单地执行（即通过某个计时器或每帧，如果重复重绘场景）。碰撞相当于以某种方式改变速度矢量 (x_vel, y_vel) 以模拟碰撞效果：要么将其归零以完全停止任何运动，要么改变速度分量符号`(x_vel = -x_vel)`以使其以绝对弹性的方式反弹，或做其他适合的事情。

现在发生的情况`glTranslate()`是，它`x_vel, y_vel`实际上保持从起始位置的偏移量，而不是运动速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:17:03.150

好吧，在我看来，您在翻译实际对象时遇到了问题。您的移动代码状态

```
if(there is a collision)
{ 
    //do stuff
}
else
{
    glTranslateF( );
} 
```

所以，每当发生碰撞时，翻译函数永远不会被调用。

我的意见是，你应该把`glTranslateF()`调用从 中拉出来，`else {...}`每次都调用它。但是，您似乎对每个矩形都使用了完全相同的“绘制”函数，而不仅仅是玩家精灵。您可能必须找到一种方法来区分常规矩形（例如平台）和播放器矩形。也许实现这一点的最简单方法是拥有两种不同的`drawSprite`功能：一种用于常规平台，另一种用于播放器。仅从玩家的绘图函数中调用该`move()`函数（可能称为`drawPlayer()`？）

目前，我没有时间查看您的所有代码以提出更有根据和更具体的建议。但是，如果这个问题仍然悬而未决并且需要帮助，我将在今晚晚些时候有空。

# database - 带有 2 个参数的命名 JPA 查询

> ID：15554744
> 
> 赞同：0
> 
> 时间：2013-03-21T17:55:45.960
> 
> 标签：database, jakarta-ee, jpa

我正在创建一个命名的 JPA 查询。它需要获取满足经理姓名和状态的所有记录。这就是我创建的方式。

```
@NamedQuery(name = "Claims.viewMgrClaims", query = "SELECT c FROM Claims c WHERE c.mgrname = :mgrname AND " 
+ "c.status like :stat") 
```

我按照此处给出的示例创建了它[命名查询与 where 子句中的类似](https://stackoverflow.com/questions/10912320/named-query-with-like-in-where-clause)

但是我不确定我的电话应该是什么样子。例如，我不确定如何将 setParameter 与两个字段一起使用。我将此用于不同的查询，它工作正常。

```
List<Claims> l = em.createNamedQuery("Claims.findByMgrname").setParameter("mgrname", MgrName).getResultList(); 
```

但是我应该为我的新 NamedQuery 使用什么？我做错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T02:43:24.417

你可以这样调用：

```
 List<Claims> l = (List<Claims>)em.createNamedQuery("Claims.findByMgrname")
   .setParameter("mgrname", MgrName)
   .setParameter("stat", statVar)
   .getResultList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:12:21.253

我在谷歌搜索后得到了它

对于来这里看这里的人来说，这是一个很好的链接，[名为 JPA Query With Two Parameters](http://www.java2s.com/Code/Java/JPA/NamedQueryWithTwoParameters.htm)

# java - 在 Parcelable 中写入/读取数组或字符串数 组

> ID：15554755
> 
> 赞同：2
> 
> 时间：2013-03-21T17:56:20.067
> 
> 标签：java, android, parcel

为了在我的应用程序中的 2 个活动之间传递一个对象，我让该类实现 Parcable 并且一切正常。现在我想用一个字符串数组 (String[][]) 来扩展这个类。

我在互联网上搜索了一段时间，但我找不到`writeToParcel(Parcel dest, int flags)`在 Constructor 处和中处理此问题的方法`MyClass(Parcel in)`。

另一种选择是创建一个只有 2 个字符串 stringA 和 stringB 的类，并让该类也实现 Parcable。然后我可以使用 readList() 和 writeList() 来编写 Parcables 的列表，但这似乎不是一个理想的解决方案。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:26:21.920

Parcel 类有一个 writeStringArray() 方法。你的类不能遍历 String[][] 并为每个调用 writeStringArray 吗？

假设您的班级有一个成员：

```
String[][] data; 
```

在 writeToParcel()

```
parcel.writeInt(data.length);
for( int i=0; i<data.lengh; i++ ){
    parcel.writeStringArray(data[i]);
} 
```

在 createFromParcel()

```
int size = parcel.readInt();
data = new String[size][];
for( int i=0; i<size; i++ ){
  data[i] = parcel.readStringArray();
} 
```

# hadoop - MapReduce 作业所花费的时间

> ID：15554756
> 
> 赞同：-1
> 
> 时间：2013-03-21T17:56:22.160
> 
> 标签：hadoop, mapreduce, apache-pig, hdfs, distributed-computing

我是 hadoop 和 mapreduce 的新手。我在 hadoop Mapreduce 中运行数据时遇到问题。我希望以毫秒为单位给出结果。有什么方法可以在几毫秒内执行我的 Mapreduce 作业？如果不是，那么 hadoop mapreduce 可以在完全分布式的多集群（5-6 个节点）中花费的最短时间是多少。在 hadoop mapreduce 中要分析的文件大小约为 50-100Mb 程序是用 Pig 编写的。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T14:30:11.283

对于数据的即席实时查询，请使用[Imapala](https://ccp.cloudera.com/display/IMPALA10BETADOC/Introducing+Cloudera+Impala)、[Apache Drill](http://incubator.apache.org/drill/) (WIP)。Drill 基于[Google Dremel](http://research.google.com/pubs/pub36632.html)。

Hive 作业被转换为 MapReduce，因此 Hive 在本质上也是面向批处理的，而不是实时的。不过，很多工作正在进行以提高 Hive（[1](http://hortonworks.com/blog/100x-faster-hive/)和[2](http://hortonworks.com/blog/45x-performance-increase-for-hive/)）的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T20:26:39.130

这是不可能的（afaik）。hadoop 一开始并不意味着实时的东西。它最适合批处理作业。mapreduce 框架需要一些时间来接受和设置工作，这是您无法避免的。而且我认为让超高端机器设置hadoop集群不是一个明智的决定。此外，框架必须在实际开始工作之前做一些事情，例如创建数据的逻辑拆分。

# ios - 如何判断一个 sqlite 表视图是否为空？

> ID：15554757
> 
> 赞同：0
> 
> 时间：2013-03-21T17:56:22.227
> 
> 标签：ios, objective-c, sqlite, uitableview

我有一个使用 SQLite 3 for iPhone 的工作 RSS 提要阅读器，我已提交给苹果进行审查。我正在徘徊的是有没有办法判断一个 sqlite 表视图是否为空。我已经阅读过有关这样做的信息，但我似乎找不到使用 SQLite 的内容。我想要这个，因为当用户第一次打开应用程序时，项目视图控制器是空的，直到他们通过下拉刷新表格。有没有办法添加一个标签，上面写着“请刷新”，但只有当表格为空时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:01:44.917

```
select count(*) from some_table; 
```

如果返回 0，则表为空。当然，如果您已经对一个返回所有行的表进行了查询，并且您返回零行，那么您就知道该表是空的。

如果您知道有一个空表，那么设置您的表视图的数据源，其中有 1 行显示您的“请刷新”消息。

但是如果没有数据，刷新又有什么意义呢？如果用户可以刷新，那为什么不为用户自动刷新呢？为什么要让用户进行刷新？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:01:36.413

在您的 viewDidLoad 方法中，您必须从 sqlite 获取所有提要...因此在 viewDidLoad 上启动加载视图...并在获得所有视图时删除该视图...然后您可以检查项目列表的计数和当计数 == 0 时，显示您想要显示的任何消息。

# asp.net - 背景和字体未显示在 aspx 页面上

> ID：15554762
> 
> 赞同：0
> 
> 时间：2013-03-21T17:56:36.893
> 
> 标签：asp.net, css, html

我在 aspx 中有一个主模板，我从中创建其他 aspx 页面，并且在主模板中我引用了一个 css 样式表。由于某种原因，我在正文上设置的背景图像和我应用的字体不再起作用。它根本不会显示在从主模板创建的任何 aspx 页面上。

我无法为我的生活弄清楚为什么它没有显示。事实上，在 Visual Studio 中，背景确实显示出来了。

这是我的项目目录的图像，因此您可以看到它们是如何定位的。

[http://i.imgur.com/xHFOXil.png](http://i.imgur.com/xHFOXil.png)

因此，我为基本 Cafe 目录中的所有 aspx 页面和 Secure 文件夹中的 Aspx 文件引用了我的样式表，方法很简单

```
 <link href="Styles/Coffee.css" rel="stylesheet" media="screen" />
<link href="../Styles/Coffee.css" rel="stylesheet" media="screen" /> 
```

因此，样式表已被正确引用，因为某些对象确实会按预期进行更改。

这是css文件中的代码：http: [//slexy.org/view/s2OAgP08oS](http://slexy.org/view/s2OAgP08oS)

这也是 Visual Studio 中页面的输出和浏览器中的输出：

[http://i.imgur.com/Hsh6sLD.jpg](http://i.imgur.com/Hsh6sLD.jpg)

这之前工作得很好，我的 aspx 页面上的标签和所有文本都用字体等显示。背景在 IE 和 FF 中都很好。不明白现在发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:07:41.463

好的，伙计们，我的菜鸟错误。这是我没有正确引用字体文件或图像的事实。因为我有 /Fontface 和 /Images 它进入 CSS STYLES FODLER/Images.. 而实际上它在上面目录的 Images 文件夹中。

所以这样做可以解决它。

```
@font-face {
font-family: 'MolotRegular';
src: url('../Fontface/Molot-webfont.eot');
src: url('../Fontface/Molot-webfont.eot?#iefix') format('embedded-opentype'),
     url('../Fontface/Molot-webfont.woff') format('woff'),
     url('../Fontface/Molot-webfont.ttf') format('truetype'),
     url('../Fontface/Molot-webfont.svg#MolotRegular') format('svg');
font-weight: normal;
font-style: normal;

}

body
{
font-family: 'MolotRegular', Arial, Helvettica;
background-image: url("../Images/background.jpg");
margin-top: 0px;

} 
```

TL:DR：不要相信 Visual Studio 中的输出。这是一个谎言！

# ember.js - 非 RESTful 环境中的 Ember 数据

> ID：15554765
> 
> 赞同：14
> 
> 时间：2013-03-21T17:56:50.480
> 
> 标签：ember.js, ember-data

我想在我正在构建的项目中使用 ember-data，但我正在使用的 API 不遵循 REST 约定。

例如，所有 HTTP 请求都是 POST 并且端点的命名约定对于它们执行的操作是唯一的。例如`/api/thing/retrieve`，需要我发布一个带有一些参数的 JSON 对象，并返回一个“东西”给我。

**我是否使用 Restful 适配器并重新打开类并重新定义各种查找功能？**

或者

**我必须制作一个新的适配器吗？**

或者

**我应该放弃 ember-data 并在我的模型（甚至控制器）中使用 ajax 吗？**

我不确定我将如何处理这些选项中的任何一个。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T16:46:00.520

我在这个主题上看到的唯一信息是下面链接的 Discourse 人员的一篇文章。

[http://eviltrout.com/2013/03/23/ember-without-data.html](http://eviltrout.com/2013/03/23/ember-without-data.html)

我个人在文章中玩弄了reopenClass 方法，如果我有一个我经常调用的一致但非REST API，我可能会将它放入mixin 或类似的东西中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:39:22.827

我想说的是，如果您的 API 是一致的（可靠的），那么您应该创建/扩展 DS.Adapter（而不是 DS.RESTAdapter）以实现您的规范。

所有的钩子都在那里，您只需定义一次所有模型都可以使用的它。

我还会通读基本适配器代码 - （[https://github.com/emberjs/data/blob/master/packages/ember-data/lib/adapters/basic_adapter.js](https://github.com/emberjs/data/blob/master/packages/ember-data/lib/adapters/basic_adapter.js)）它可能是你更好的起点然后是 DS.Adapter。

如果您的 API 不可靠，那么您最好只根据需要使用 $.ajax() 调用。但是，在我看来，这并不能很好地扩展。

查看基本适配器时值得一读的链接：http: [//emberjs.com/blog/2013/03/22/stabilizing-ember-data.html](http://emberjs.com/blog/2013/03/22/stabilizing-ember-data.html)

最后一点，构建 ORM 甚至比 ORM 更简单的东西并不是一项简单的任务，对我来说，这使得使用 ember-data 值得付出努力，是的，有时会很痛苦。

# backbone.js - 在backbone.js中渲染集合视图

> ID：15554769
> 
> 赞同：4
> 
> 时间：2013-03-21T17:57:05.130
> 
> 标签：backbone.js

我在理解如何使用模板在视图中呈现集合时遇到问题。这是我的代码：

```
<div id="mydiv"></div>

<script type="text/template" id="details">
<ul>
<% _.each(?, function(person)  { %>
<li><%= person.name %></li>
<% }); %>
</ul>
</script>

<script>
var m = Backbone.Model.extend();

var c = Backbone.Collection.extend({
        url: 'retrieve.php',
        model: m
 });

var v = Backbone.View.extend({
        el : $('#mydiv'),
        template : _.template($("#details").html()),
        initialize : function() {
        var coll = new c(); 
        coll.fetch({success: function(){alert(JSON.stringify(coll));} });              
        this.render();
        },
        render : function() {
        //what do I put here?
        return this;
       }
});

var view = new v(); 
```

我对如何将从我的 php 文件返回的数据获取到模板中感到困惑。我在视图和._each 中需要什么代码？我的 php 代码正在返回：

```
 [{"id":"1","name":"John","age":"5"},{"id":"2","name":"Jane","age":"2"}] 
```

我在警报（）中看到了这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T19:05:11.017

您应该`render`从`success`处理程序调用您的函数作为`collection.fetch`异步返回结果（您也可以将函数[绑定](http://backbonejs.org/#Events-listenTo) `render`到集合`reset`事件）。

```
var v = Backbone.View.extend({
    el : '#mydiv',
    template : _.template($("#details").html()),
    initialize : function() {
      var self = this, 
          coll = new c(); 
      coll.fetch({ success: function(){ self.render() ; } });              
    },
    render : function() {
      // the persons will be "visible" in your template
      this.$el.html(this.template({ persons: this.coll.toJSON() }));
      return this;
    }
}); 
```

并且在模板中引用同一个`persons`对象

```
<script type="text/template" id="details">
  <ul> 
    <% _.each(persons, function(person)  { %>
      <li><%= person.name %></li>
    <% }); %>
  </ul>
</script> 
```

**更新：**

我已经创建了工作[小提琴](http://jsfiddle.net/superhacker/P2JR8/3/)，但我不得不修改原始源代码，因为我不能使用你的`retrieve.php`端点

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:50:23.447

您问的是如何使用集合生成视图的一般问题。他们中的大多数人都喜欢使用模型生成视图，但不喜欢使用集合。我按照以下教程[将集合绑定到视图](http://liquidmedia.org/blog/2011/02/backbone-js-part-3/)。可能对你也有帮助。

# c# - 在 ASP.NET MVC 中如何使用另一个模型作为属性

> ID：15554779
> 
> 赞同：0
> 
> 时间：2013-03-21T17:57:37.120
> 
> 标签：c#, asp.net-mvc, entity-framework

所以我有两种模式，一种是公司，一种是省。

```
[Table("Company")]
public class Company {
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }
    public string Name { get; set; }
    public int ProvinceID { get; set; }
    public ProvinceModel Province{
        get {
            // ????
        }
    }
}
public class CompanyContext : MyXsiteContext {
    public DbSet<Company> Companies { get; set; }
} 
```

这是我的省份：

```
[Table("Province")]
public class ProvinceModel {
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }
    public string Name { get; set; }
}
public class ProvinceContext : MyXsiteContext {
    public DbSet<ProvinceModel> Provinces { get; set; }
} 
```

如何让仅保存 ProvinceID 的公司引用 Province 对象，以便在我的视图中引用 Province.name？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:04:02.283

看起来您想要执行的操作类似于[此处](http://msdn.microsoft.com/en-us/data/jj679962.aspx)描述的导航属性。

因此，在链接中，他们描述了课程-> 部门，但对您而言，它是公司-> 省。

另外，顺便说一句，如果您要在视图中引用 Province.Name，您可能会遇到[Select N+1](http://blogs.microsoft.co.il/blogs/gilf/archive/2010/08/18/select-n-1-problem-how-to-decrease-your-orm-performance.aspx)问题，因此这可能需要考虑（取决于您的具体用例，我不是 100 ％，只是将其突出显示为潜在的“事物”）

# java - 快速计算节点关系数的方法

> ID：15554781
> 
> 赞同：2
> 
> 时间：2013-03-21T17:57:41.557
> 
> 标签：java, neo4j

我正在尝试计算节点具有的特定类型的传出关系的数量。我的代码目前如下所示：

```
int count = 0;
for (Relationship r : node.getRelationships(RelationshipTypes.MODIFIES, Direction.OUTGOING))
{
   count++;
}
return count; 
```

getRelationships 的返回类型是 Iterable 所以我不能使用 size() 或等效的。我试图避免必须从数据库中提取每个关系，因为某些节点有很多关系（> 500 万）。有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T19:07:42.527

不。neo4j 将节点的关系存储在磁盘上的方式是在链表中，并且它们不保留任何类型的节点或关系的统计信息。为了获得计数，您必须检查该类型的节点的所有关系。

即使你有一个缓存，他们可以更有效地存储它，系统可能仍然无法提供完整的图片。你的方法是最好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:00:26.737

我会尝试将传出存储在数据结构中并获取结构的大小。初始化对象时这可能需要更多时间，但这似乎是快速获取大小的最简单方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T18:17:07.053

如果`node.getRelationships(RelationshipTypes.MODIFIES, Direction.OUTGOING)`返回一个类型`Collection`然后知道节点具有的特定类型的传出关系的数量，您可以简单地使用以下内容：

```
int count = node.getRelationships(RelationshipTypes.MODIFIES, Direction.OUTGOING).size(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T18:51:53.493

我看到你正在使用 neo4j api。另一种方法是使用[ThinkerPop](http://www.tinkerpop.com/) gremlin 查询语言，该语言可用于 groovy 和 scala，但它们会在内部执行相同的操作。据我所知，由于性能原因，neo4j 允许您通过迭代器访问。例如，您可能拥有数百万个关系，但您想在运行中对结果进行分页。如果 Neo4J 总是返回关系的集合，那真的很慢。这就是为什么他返回一个迭代器并让您即时访问关系。在您需要它们之前，不会从数据库中检索它们。

所以我会说不。我希望我能帮助你。

# c# - C#中不同顺序的for循环

> ID：15554783
> 
> 赞同：2
> 
> 时间：2013-03-21T17:57:48.243
> 
> 标签：c#

我想遍历 2 个特定数字（不包括 0）之间的所有数字，并且我想遍历它们，而不是从最小到最大，反之亦然，从最接近零到最远。

例如，如果我的定义数字是`-4`，`3`然后我想按以下顺序检查数字：`-1`, `1`, `-2`, `2`, `-3`, `3`,`-4`或`1`, `-1`, `2`, `-2`, `-3`, `3`, `-4`（两者中的哪一个无关紧要）。在其他语言中，我可以使用`foreach`循环来执行此操作，我如何在 C# 中实现它，如果答案是我怀疑是`foreach`循环，我该如何构造它的列表？

例如，在 Tcl 中，我会这样做：

```
# num1 is the abs value of the negative limit
set l [list ]
for {set i 1} {$i <= [max $num1 $num2]} {incr i} {
    if {$num1 >= $i} {
        lappend l [expr -1 * $i]
    }
    if {$num2 >= $i} {
        lappend l $i
    }
}

foreach num $l {
    puts $num
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T18:01:48.587

您可以使用 Linq 通过返回函数来对列表进行排序。

```
foreach (int x in list.OrderBy(i=>Math.abs(i))
{
    // Do Stuff
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:01:43.730

```
List<int> values = new List<int>();

// Add items to list
// i.e. values.Add(-1);

values.Sort(delegate(int n1, int n2) { return math.Abs(n1).CompareTo(math.Abs(n2)); });

foreach(var num in values)
{
// Do work
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:21:36.057

您选择的答案与您在问题中陈述的内容不符。

```
int a=-4, b=3;

var list=Enumerable.Range(1, Math.Max(Math.Abs(a), Math.Abs(b))).SelectMany(x => new[] { x, -x });

foreach(var num in list) {
    Console.Write(" {0}", num);
} 
```

然而，你真正想要的匹配更重要。我经常没有在第一次正确地描述我的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T20:04:01.107

将 Tcl 函数翻译成 C# 很简单：

```
 var l = new List<int>();
 for (int i = 1; i <= Math.Max(num1, num2); i++) {
  if (num1 >= i) {
   l.Add(-1 * i);
  }
  if (num2 >= i) {
   l.Add(i);
  }
 }
 foreach (int num in l) {
  System.Console.WriteLine(num);
 } 
```

整数列表是`List<int>`。`for`是`for`。增加一个变量是`++`。附加到列表是`Add`. 并且`foreach`是`foreach`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T18:04:25.270

就像是：

```
int startnum = -4;
int endnum = 3;
foreach (int x in Enumerable.Range(startnum, (endnum - startnum) + 1).OrderBy(n => Math.Abs(n))) {
if (x == 0)
   continue;

// Do stuff
} 
```

只是不要忘记做出`endum`大于`startnum`，你很高兴。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-21T19:12:06.503

```
int max = 5;
for (int i = 1, flip = 1; i < max; flip = flip ^ 1, i =  i * -1 , i = i + (flip == 1 ? 1 : 0) )
{
    System.Diagnostics.Debug.WriteLine(i);
} 
```

这应该可以解决您的问题。这几乎是一个正常的 for 循环，只有几个额外的计数器/条件。

flip = flip ^ 1 ：flip 变量只是在 1 和 0 之间翻转。
i = i * -1 ：每次循环我们都会更改符号以获得所需的交替数
i = i + (flip == 1 ? 1 : 0) ：我们仅在计数器为正数时才增加计数器。

- 对不起，这甚至没有回答这个问题。我浏览了这个问题并提出了这个问题。

# sharepoint-2010 - SSRS 2008 R2 查询字符串参数 Sharepoint 集成模式

> ID：15554785
> 
> 赞同：0
> 
> 时间：2013-03-21T17:58:08.920
> 
> 标签：sharepoint-2010, reporting-services, ssrs-2008

我正在尝试通过以下 url 运行报告：

```
http://portal/dashboards/hr/reports/_vti_bin/ReportServer?http://portal/dashboards/hr/reports/reports/Test.rdl 
```

但是，我收到 401 Unauthorized 错误。

我以这种方式访问​​报告的原因是我可以传递一些参数（我现在已经取消了）。我想通过 q​​ueyrstring 传递一些 mdx 值，这些值将用于运行报告。

带有 queyrstring 参数的 URL 看起来像这样。

```
http://portal/dashboards/hr/reports/_vti_bin/ReportServer?http://portal/dashboards/hr/reports/reports/Test.rdl&rp:CostCentreCostCentreHierarchy=%5BCost%20Centre%5D.%5BCost%20Centre%20Hierarchy%5D.%26%5B1002%5D&TimeFiscalYearQuarter=%5BTime%5D.%5BFiscal%20Year-Quarter-Month%5D.%5BF%20Quarter%5D.%26%5B20123%5D 
```

基本上参数是 MDX 值。

我确信这在某一时刻对我有用——但不再适用了。

我希望这是在某处缺少权限的情况？！

问题是否与 _vti_bin 文件夹有关。我按照文章使用了这个：`http://msdn.microsoft.com/en-us/library/ms155391.aspx`

从相应的列表中通过 Sharepoint 打开报告，工作正常 - 报告运行没有任何错误 - 就在我使用 _vti_bin url 时，我遇到了这个问题。查询字符串参数不适用于 _layouts 文件夹中的常规报表查看器 url。

如果有更好的方法来做到这一点，那么也请提出建议。

任何帮助表示赞赏。

谢谢，

KS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T14:00:12.723

已解决 - 显然每个参数都需要有 rp: 前缀。

唯一需要在 mdx 值中编码的字符是 & 符号。

谢谢。

# c# - 如何在 C# WinForms 中使用 Windows 屏幕键盘

> ID：15554786
> 
> 赞同：18
> 
> 时间：2013-03-21T17:58:10.443
> 
> 标签：c#, windows, winforms, 32bit-64bit, on-screen-keyboard

*   对比 2010
*   开发在 64 位操作系统上运行的 32 位应用程序（Windows 7、Windows 8 - 桌面应用程序）
*   C＃
*   .NET 4.0
*   WinForms

我在`osk.exe`从应用程序启动 Windows 屏幕键盘 ( ) 时发现了许多线程，但我遇到了一些问题。这似乎是因为我在 64 位操作系统上运行 32 位应用程序。我在这里尝试了 WooCaSh 发布的代码： [WinForms 中的屏幕上的键盘](https://stackoverflow.com/questions/9298515/keyboard-on-the-screen-in-winforms)

但是这三种不同的路径都不适合我。对于`sysnative`路径，`Process.Start`失败并显示 *“找不到指定的路径”。*对于`system32`和`osk.exe`路径，我收到*“无法启动屏幕键盘”*错误对话框。

我在这里找到了一个可能的解决方法，这比我正在寻找的要复杂一些（eryang 发布）：[http ://social.msdn.microsoft.com/Forums/en-US/netfx64bit/thread/10ebc62f-e6d7 -4072-9fd1-ea3784a0966f/](http://social.msdn.microsoft.com/Forums/en-US/netfx64bit/thread/10ebc62f-e6d7-4072-9fd1-ea3784a0966f/)

1.  有没有更简单或更正确的方法来做到这一点？
2.  我希望当用户选择文本框时，在平板电脑上运行我的应用程序会自动启动屏幕键盘，但没有运气。这是正常的还是我错过了什么？我发现在桌面模式（我的应用程序是）下，键盘不会在 Windows 8 中自动启动：http: [//www.bleepingcomputer.com/forums/t/480250/keyboard-does-not-pop-up - 自动/](http://www.bleepingcomputer.com/forums/t/480250/keyboard-does-not-pop-up-automatically/)显然它适用于 Windows 7 平板电脑，但我无法测试，因为我这里只有 Windows 8 平板电脑。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-22T17:56:58.490

我现在正在启动“触摸键盘”而不是“屏幕键盘”（无论如何，这是我在 Windows 8 上想要的键盘）：

```
string progFiles = @"C:\Program Files\Common Files\Microsoft Shared\ink";
string keyboardPath = Path.Combine(progFiles, "TabTip.exe");

this.keyboardProc = Process.Start(keyboardPath); 
```

这适用于我的 Win7 和 Win8，无论我在 64 位操作系统上的 32 位应用程序如何。但是，完成后我仍然遇到以编程方式关闭键盘的问题。进程 ,`this.keyboardProc`似乎没有得到句柄，立即拥有了属性`HasExited = true`。这意味着我试图关闭或杀死它失败了。

根据这个线程，如果用户手动打开键盘（或者我以编程方式启动它），当文本字段失去焦点时键盘不会自动关闭/隐藏：[Windows 8 - 如何关闭触摸键盘？](https://stackoverflow.com/questions/12149006/windows-8-how-to-dismiss-touch-keyboard)我尝试了将焦点设置为隐藏按钮的解决方法，但由于我自己启动了键盘，它不会自动关闭。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-07-31T09:09:42.920

我无法关闭屏幕键盘。您可以使用以下方式启动触控键盘

```
string progFiles = @"C:\Program Files\Common Files\Microsoft Shared\ink";
string onScreenKeyboardPath = System.IO.Path.Combine(progFiles, "TabTip.exe");
onScreenKeyboardProc = System.Diagnostics.Process.Start(onScreenKeyboardPath); 
```

并关闭所有键盘

```
//Kill all on screen keyboards
Process[] oskProcessArray = Process.GetProcessesByName("TabTip");
foreach (Process onscreenProcess in oskProcessArray)
{
    onscreenProcess.Kill();
} 
```

由于某种原因 onScreenKeyboardProc.Kill() 或 .Close() 不起作用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-05-10T07:27:21.283

要使键盘自动打开，控件必须实现一些 UI 自动化控制模式，特别是 ITextProvider/IValueProvider。这很麻烦，但它可以工作（而且它比启动一些 *.exe 更干净）

我在这里写了一个示例应用程序和一篇短文：http: [//blog.tombam.net/implementing-textbox-with-on-screen-touch-keyboard-part-1/](http://blog.tombam.net/implementing-textbox-with-on-screen-touch-keyboard-part-1/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-25T06:50:37.887

触摸键盘利用 UI 自动化。由于某些对我来说很神秘的原因，标准的 Windows 编辑框没有实现 UI 自动化，而其他控件（如组合框）可以实现。

* * *

可以使用来自`UIAutomationClient.dll`.

为了将 UI 自动化神奇地注入应用程序，`UiaCoreApi`必须触发程序集内部类的类初始化程序。

On 可以通过调用看似无操作来实现这一点：

```
AutomationElement.FromHandle(IntPtr)(-1) 
```

* * *

另一种方法是显式实现自动化 UI。为此实现相应输入控件的[`ITextProvider`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.automation.provider.itextprovider)/[`IValueProvider`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.automation.provider.ivalueprovider)接口。

要将接口的实现绑定到控件，请使用=处理[`WM_GETOBJECT`窗口消息](https://docs.microsoft.com/en-us/windows/win32/winauto/wm-getobject)。`lParam``RootObjectId`

有关实现的示例，请参见

*   [tombam](https://stackoverflow.com/q/15554786/850848#43886052)对这个问题的回答；
*   或者直接发帖人的文章[Implementing TextBox with on-screen touch keyboard](https://blog.tombam.net/implementing-textbox-with-on-screen-touch-keyboard-part-1/)。

虽然有趣的是，触摸键盘开箱即用的控件（如组合框或密码编辑框，请参阅答案）不实现`WM_GETOBJECT`/ `RootObjectId`。它们背后一定有不同的机器。

* * *

此问题最常见的“解决方案”是通过运行`TabTip.exe`or显式弹出键盘`osk.exe`，这是难以接受的。

如果没有别的，那么因为没有干净的方法来隐藏通过运行打开的键盘`TabTip.exe`（解决方案包括像杀死进程或发送`Esc`密钥这样的黑客攻击）。

实际上，上述破解似乎在 Windows 10 周年更新中不再起作用：[在 Windows 10 周年版中显示触摸键盘 (TabTip.exe)](https://stackoverflow.com/q/38774139/850848)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-01T22:45:23.090

启动 TabTip.exe 不再适用于 Widnows 10 周年纪念版。我发现了一个未记录的用于控制触摸键盘的 COM 接口。在此处检查代码[https://stackoverflow.com/a/40921638/332528](https://stackoverflow.com/a/40921638/332528)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-18T13:46:20.203

我在这里和其他地方冲浪然后我实现了这个：

```
using System.Diagnostics; // remember use this

public partial class Window1 : Window
{

    public Process _p = null;

    public Window1()
    {
        InitializeComponent();          
    }

    public void Button_Click(object sender, RoutedEventArgs e)
    {
        if (_p != null)
        {
            _p.Kill();
            _p.Dispose();
            _p = null;
        }
        _p = Process.Start(@"C:\Program Files\Common Files\microsoft shared\ink\TabTip.exe");    
    }

    private void Acceso_Closing(object sender, System.ComponentModel.CancelEventArgs e)
    {
        if (_p != null)
        {
            _p.Kill();
            _p.Dispose();
            _p = null;
        }
    }
} 
```

它工作正常，所以我在这里分享它，以防你的信息对我有帮助。

# mongodb - MongoDB $elemMatch 问题

> ID：15554787
> 
> 赞同：0
> 
> 时间：2013-03-21T17:58:17.547
> 
> 标签：mongodb

我对 MongoDB 还很陌生，我想我误解了 $elemMatch 的工作原理。我正在运行以下两个查询，我希望它们返回相同的结果集。第一个返回我所期望的，所有元素 stats.o 等于 1 的文档。第二个查询不返回任何文档。有谁知道为什么我会得到第一个查询而不是第二个查询的结果？该数据库在运行 MongoDB 2.2 的 MongoLab 上运行。

```
{
    "stats.o":1
}

{
    "stats": {
        "$elemMatch": {
            "o": 1
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-05T17:36:55.590

您可能会看到 $elemMatch 的效果仅适用于嵌入文档的数组，而不适用于简单的嵌入文档。

请求扩展 $elemMatch 的功能，跟踪为[https://jira.mongodb.org/browse/SERVER-6050](https://jira.mongodb.org/browse/SERVER-6050)

因此，如果您的文件是：

`{ stat : { o : 1 } }`

你不能使用 $elemMatch （但你真的不需要）。

但如果是

`{ stat : [ { o : 1 } ] }`

那么您可以并且实际上可能需要使用 $elemMatch 来获得正确的结果（在您有许多数组元素和必须“一起”匹配的多个条件的情况下。

# c# - 使用 Automapper 进行深度映射

> ID：15554788
> 
> 赞同：39
> 
> 时间：2013-03-21T17:58:18.260
> 
> 标签：c#, automapper

我正在尝试使用多级成员映射对象：这些是类：

```
 public class Father
    {
        public int Id { get; set; }
        public Son Son { get; set; }
    }

    public class FatherModel
    {
        public int Id { get; set; }
        public int SonId { get; set; }
    }

    public class Son
    {
        public  int Id { get; set; }
    } 
```

这就是我尝试自动映射它的方式：

```
 AutoMapper.Mapper.CreateMap<FatherModel , Father>()
                      .ForMember(dest => dest.Son.Id, opt => opt.MapFrom(src => src.SonId)); 
```

这是我得到的例外：

> 表达式 'dest => Convert(dest.Son.Id)' 必须解析为顶级成员，而不是任何子对象的属性。在子类型或 AfterMap 选项上使用自定义解析器。参数名称：lambdaExpression

谢谢

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-21T19:11:26.520

这适用于映射到新对象或现有对象。

```
Mapper.CreateMap<FatherModel, Father>()
    .ForMember(x => x.Son, opt => opt.MapFrom(model => model));
Mapper.CreateMap<FatherModel, Son>()
    .ForMember(x => x.Id, opt => opt.MapFrom(model => model.SonId)); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-03-21T18:56:33.277

```
 AutoMapper.Mapper.CreateMap<FatherModel, Father>()
                     .ForMember(x => x.Son, opt => opt.ResolveUsing(model => new Son() {Id = model.SonId})); 
```

如果它变得更复杂，您可以编写一个 ValueResolver 类，请参见此处的示例 - [http://automapper.codeplex.com/wikipage?title=Custom%20Value%20Resolvers](http://automapper.codeplex.com/wikipage?title=Custom%20Value%20Resolvers)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2019-01-25T16:54:28.493

使用 ForPath 而不是 ForMember & 它就像魔术一样工作。

# mysql - VB.NET 中的 WHERE 语句

> ID：15554791
> 
> 赞同：0
> 
> 时间：2013-03-21T17:58:21.803
> 
> 标签：mysql, .net, database, vb.net

对于学校作业，我需要根据他们的 MAC 地址命名计算机。我有一个带有两列 Mac-Adress 和 Computername 的 mySQL 表。我想通过以下代码使用计算机的mac地址，该代码有效。

全局声明

> 公共 connStr As String = "Database=Mac;" &_“数据源=本地主机；” & _ "User Id=root;Password=" Public mac_adress As String

获取 Mac 地址

> Public Sub MacAdres() Dim nic As NetworkInterface = Nothing
> 
> ```
>  For Each nic In NetworkInterface.GetAllNetworkInterfaces
>         mac_adress = nic.GetPhysicalAddress.ToString
>     Next
> End Sub 
> ```

但是，当我想创建 WHERE 语句时，出现错误。我将以下代码用于 WHERE 语句。

> ```
> Public Sub retriveData()
>     Try
>         Dim query As String = "SELECT * FROM 'mactable' WHERE 'Mac-adres' = '" & mac_adress & "'"
>         Dim connection As New MySqlConnection(connStr)
>         Dim cmd As New MySqlCommand(query, connection)
> 
>         connection.Open()
> 
>         Dim reader As MySqlDataReader
>         reader = cmd.ExecuteReader()
> 
>         While reader.Read()
>             MessageBox.Show(reader.GetString(1))
>         End While
> 
>         reader.Close()
>         connection.Close()
>     Catch ex As Exception
>         Console.WriteLine(ex.Message)
>     End Try
> End Sub 
> ```

我究竟做错了什么？

> “MySql.Data.MySqlClient.MySqlException”类型的第一次机会异常发生在 >MySql.Data.dll

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:05:26.537

我认为您不需要表名或字段名上的引号，并且可能删除连字符。

```
Dim query As String = "SELECT * FROM mactable WHERE MacAdres = '" & mac_adress & "'" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T17:39:46.160

通过使用这些来解决它：“`”而不是这些'。这很奇怪，但它解决了它。

# ruby-on-rails - 无法在 Mongoid 中保存数组

> ID：15554792
> 
> 赞同：1
> 
> 时间：2013-03-21T17:58:24.213
> 
> 标签：ruby-on-rails, arrays, ruby-on-rails-3, mongodb, mongoid

`has_many`我与另一个对象有关系。正因为如此，Mongoid 创建了一个名为`item_ids`Array 的属性，因此我可以方便地将许多 id 保存为一个数组。但是，每当我尝试保存一个新数组时，它都不会真正保存。在我的 Rails 控制台中，我运行以下代码。

```
1.9.3p385 :035 > miss.item_ids = [1,2,3]
 => [1, 2, 3] 

1.9.3p385 :036 > miss.save
[paperclip] Saving attachments.
 => true 

1.9.3p385 :037 > miss.item_ids
 => [] 
```

正如您所看到的，当我保存对象时它返回 true。但是，当我返回检查时，`item_ids`我返回了一个空数组。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T05:33:56.423

'item_ids' 不是属性，是一种运行一些查询以仅返回相关对象的 ID 并将它们附加到数组的方法。

当您执行诸如 miss.item_ids = [1,2,3] 之类的操作时，您基本上是在文档上创建该字段，因为您使用的是 Mongo，它会为您存储任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T09:27:26.417

您正在手动创建关系。尝试`miss.items << item`

现在`miss.items`应该返回一个项目数组

# backbone.js - Backbone.js - “对象 [对象对象] 没有方法 'listenTo'”

> ID：15554793
> 
> 赞同：3
> 
> 时间：2013-03-21T17:58:24.790
> 
> 标签：backbone.js, backbone-views, backbone-events

问题：我有这样的代码：BottomPaneView

```
initialize: function() {
  ...
  this.childView = null
  ...
  this.listenTo(this.childView, "findUnit", this.findUnit);
} 
```

在另一个函数中，

```
{
  ...
  this.childView = new TrackingView(...);
  this.childView.render()
  ...
} 
```

初始化中的最后一行抛出“Uncaught TypeError: Object [object Object] has no method 'listenTo'”。这不是指 View 对象吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T18:46:32.883

好的，所以问题是我使用的是 v0.9.0，而骨干直到 0.9.9 才实现 listenTo。我更新到 v1.0.0，一切正常。

请注意，在此之前，我将问题行移至`this.childView.render()`第二个函数中的下方，以确保参数已初始化。我不知道我最初所做的是否会奏效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:43:28.330

`this.childView`必须是 的实例`Backbone.View`。`console.log`在绑定语句之前执行一个检查这一点。

# java - 通过字符串数组循环返回

> ID：15554794
> 
> 赞同：0
> 
> 时间：2013-03-21T17:58:28.977
> 
> 标签：java, android, arrays, loops, counter

所以我得到了我正在循环的这个字符串数组。一个菜鸟问题，但是，我如何反转和循环回来？基本上我想要的是“前进”和“后退”功能，因此不必循环整个数组即可返回“a”。谢谢！

```
 public class FirstActivity extends Activity {

    private static int counter = 0; 
    private TextView exampleTextView;
    string exampleText;

    private static final String[] EXAMPLESTRINGS = {
    "a",
    "b",
    "c"
    };

public void generateText(View v) {

    String exampleText = EXAMPLESTRINGS[counter++];
    if( counter == EXAMPLESTRINGS.length ) {
        counter = 0;
    }
    exampleTextView.setText(exampleText);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:07:41.133

我猜 generateText() 方法是从 UI 以某种方式调用的方法？尝试类似：

```
public void generateTextForward(View v) {
    if( counter == EXAMPLESTRINGS.length -1 ) {
        counter = 0;
    }
    String exampleText = EXAMPLESTRINGS[counter++];
    exampleTextView.setText(exampleText);
}

public void generateTextBackward(View v) {
    if( counter == 0 ) {
        counter = EXAMPLESTRINGS.length -1;
    }

    String exampleText = EXAMPLESTRINGS[counter--];
    exampleTextView.setText(exampleText);
} 
```

现在你有两种方法，一种用于前进，一种用于后退。真的不知道这个应用程序:)

但正如上面的一些评论所建议的那样，请查看一个链接列表。

# css - jQuery Masonry / 同位素和流体图像：窗口调整大小的瞬间重叠

> ID：15554798
> 
> 赞同：2
> 
> 时间：2013-03-21T17:58:43.173
> 
> 标签：css, layout, responsive-design, jquery-masonry, jquery-isotope

我注意到，当将 jQuery Isotope 或 Masonry 与流体/响应式网站一起使用时，元素会在调整浏览器窗口大小时暂时重叠。请参阅下面的图片，这些图片是[此](http://osvaldas.info/examples/responsive-jquery-masonry-or-pinterest-style-layout/)演示的屏幕截图。您还可以在 Isotope[网站](http://isotope.metafizzy.co/demos/fluid-responsive.html)上看到这种情况。

有什么办法可以避免这种重叠？

![在调整浏览器窗口大小之前：一个间隔很好的图像网格](../Images/f089b9e6b18426c1dc8095788aa35871.png)

![在调整大小期间：重叠！](../Images/5e00358496c54931289e604cdf5c7bba.png)

![调整大小后：回到漂亮的网格。](../Images/aca67e91aa03e2eb02af0a1ec771d77f.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:19:28.200

感谢[Osvaldas Valutis](http://osvaldas.info)在他的博客文章 ( [http://osvaldas.info/responsive-jquery-masonry-or-pinterest-style-layout](http://osvaldas.info/responsive-jquery-masonry-or-pinterest-style-layout) ) 上回答了这个问题。

--

对于砌体：

```
$(window).resize(function(){ $('#list').masonry('reload'); }); 
```

以下对我有用，使用同位素：

```
$(window).resize(function(){ $('#list').isotope('reLayout'); }); 
```

--

再次感谢奥斯瓦尔达斯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-06T15:35:30.050

感谢您在上面的评论...我从这里得到了我的问题的答案，但我只是想向你解释->我正在使用同位素使用 ajax 页面加载，所以我的代码是-

```
var $container = $('your main container in which your all item will get listed');
 $container.imagesLoaded(function () {
     $container.isotope({
         itemSelector: 'figure',
         filter: '*',
         resizable: false,
         animationEngine: 'jquery'
     });
 }); 
```

之后，当我调用我的 ajax 时，使用调用此函数

```
$("#filter-container").isotope('reLayout'); 
```

在第一页加载时，页面上会有一些数据，因此 isotope 将调整所有这些，并且在附加 ajax 加载的数据之后 isotope 将重新排列所有这些数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-21T15:20:04.893

对于同位素版本 3，请使用：

```
$(window).resize(function(){ $('.grid').isotope('layout'); }); 
```

以避免重叠的网格项目。

# dbmigrate - 耙分贝：迁移错误 - SQLite3

> ID：15554803
> 
> 赞同：1
> 
> 时间：2013-03-21T17:59:02.497
> 
> 标签：dbmigrate

执行 rake db:migrate 命令时，我不断收到以下错误：

耙中止！发生错误，此迁移和所有后续迁移已取消：SQLite3::SQLException：重复列名：电子邮件：ALTER TABLE "users" ADD "email" varchar(255) DEFAULT '' NOT NULL

我也试过命令 - bundle exec rake db:migrate。我跑了 --trace 并得到了信息。以下。

** 调用 db:migrate (first_time) ** 调用环境 (first_time) ** 执行环境 ** 调用 db:load_config (first_time) ** 执行 db:load_config ** 执行 db:migrate == AddDeviseToUsers: 迁移 ==== ============================================--change_table(:users)耙中止！发生错误，此迁移和所有后续迁移均已取消：

SQLite3::SQLException：重复列名：电子邮件：ALTER TABLE "users" ADD "email" varchar(255) DEFAULT '' NOT NULL /usr/local/rvm/gems/ruby-1.9.3-p392/gems/sqlite3- 1.3.7/lib/sqlite3/database.rb:91:在`initialize' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/sqlite3-1.3.7/lib/sqlite3/database.rb:91:in`新的'/usr/local/rvm/gems/ruby-1.9.3-p392/gems/sqlite3-1.3.7/lib/sqlite3/database.rb: 91：在`prepare' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/sqlite3-1.3.7/lib/sqlite3/database.rb:134:in`执行中'/usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/sqlite_adapter.rb:278 ：`block in execute' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract_adapter.rb:280:in`在日志中的块'/usr/本地/rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.12/lib/active_support/notifications/instrumenter.rb:20:in log' /usr/local/rvm/gems/ruby-1.9 `instrument' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract_adapter.rb:275:in`。 3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapter/sqlite_adapter.rb:278:in`execute' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/schema_statements.rb:264:in`add_column' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/sqlite_adapter.rb:400:in `add_column' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/schema_definitions.rb:479:in`block in string' /usr/local/rvm /gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/schema_definitions.rb:468:in `each' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/schema_definitions.rb:468:in`string' /Users/ddorrick/code/onrails/db/migrate/20130321170702_add_devise_to_users .rb:5:in `block in up' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/schema_statements.rb:243:in`change_table' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:466:in `block in method_missing' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:438:in`block in say_with_time' /usr /local/rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/benchmark.rb:280:in `measure' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:438:in`say_with_time' /usr/local/rvm/gems/ruby-1.9.3-p392/gems /activerecord-3.2.12/lib/active_record/migration.rb:458:in`method_missing' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:334:in`method_missing' /Users/ddorrick/code/onrails/db/migrate/20130321170702_add_devise_to_users.rb:3:in `up' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:370:in`up' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib /active_record/migration.rb:410:in `block (2 levels) in migrate' /usr/local/rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/benchmark.rb:280:in`measure' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:410:in `block in migrate' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:129:in`with_connection' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:389:in `migrate' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:528:in`migrate' /usr/local/rvm/gems/ruby-1.9 .3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:720:in `block (2 levels) in migrate' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:775:in`call' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12 /lib/active_record/migration.rb:775:in`block in ddl_transaction' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in`事务' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/transactions.rb:208:in`transaction' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:775:in`ddl_transaction' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:719:in `block in migrate' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:700:in`each' /usr/local/rvm/gems/ruby -1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:700:in `migrate' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/migration.rb:570:in`up' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2 .12/lib/active_record/migration.rb:551:in `migrate' /usr/local/rvm/gems/ruby-1.9.3-p392/gems/activerecord-3.2.12/lib/active_record/railties/databases.rake:179:in`block (2 levels) in ' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/ rake/task.rb:228:in`call' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:228:in`块执行'/usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:223:在`each' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:223:in`执行'/usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in invoke_with_call_chain' /usr/local/rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/monitor.rb:211:in`mon_synchronize'/usr/local/rvm/ gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:159:in`invoke_with_call_chain' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:152:in`调用' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:101:in`block (2 levels) in top_level' /usr /local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:101:in `each' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:101:in`block in top_level' /usr/local/rvm/gems/ruby -1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:95:in`top_level' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems /rake-10.0.3/lib/rake/application.rb:73:in `block in run' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:160:in`standard_exception_handling' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake /application.rb:70:in `run' /usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/bin/rake:33:in`' /usr/local/rvm/gems/ruby-1.9.3-p392@global/bin/rake:19:in `load' /usr/local/rvm/gems/ruby-1.9.3-p392@global/bin/rake:19:in`' /usr/local/rvm/gems/ruby-1.9.3 -p392/bin/ruby_noexec_wrapper:14:in `eval' /usr/local/rvm/gems/ruby-1.9.3-p392/bin/ruby_noexec_wrapper:14:in`' 任务：TOP => db:migrate

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-12T04:09:15.833

```
First of all, if you're using devise for authentication,email field is provided by default. The source for the error is: "The email field is also present in users table. That's why whenever you're run db:migrate it shows duplicate column error.

So drop the users table by giving command ActiveRecord::Migration.drop_table(:users)"  in rails console.

Then, give  rails g model user user_name:string mobile_number:integer

Hope it will helps. 
```

# c# - 在 Parallels 8 中的 Windows 7 上运行 C# Windows Forms 应用程序错误

> ID：15554815
> 
> 赞同：8
> 
> 时间：2013-03-21T17:59:44.513
> 
> 标签：c#, winforms, virtualization, virtual-machine, parallels

我编写了一个非常简单的[C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29) [Windows Forms](http://en.wikipedia.org/wiki/Windows_Forms)应用程序，一位同事想在 Windows 7 上使用[Parallels 8](http://en.wikipedia.org/wiki/Parallels_Desktop_for_Mac#Version_8)对其进行测试，因为他只有一台 Mac。

问题是，当他使用调试文件夹中的 EXE 文件启动它时，他收到以下错误：

> 启动 OMAPI 时出错（无法加载 DLL 'libomapi.dll'：找不到指定的模块。（来自 HRESULT 的异常：0x8007007E））检查所需的 .dll 文件是否存在正确的版本：OmApiNet.dll libomapi.dll

从下图中可以看出，所需的 DLL 文件就在同一个文件夹中，如果他将此调试文件夹带到 Windows PC 上，它工作正常，所以这肯定是某种虚拟机或 Parallels 特定的问题。

![错误截图](../Images/03bf0ef4aa3ffe11825d5545bf362860.png)

我该如何解决这个问题？

我还没有真正使用足够多的虚拟机来知道问题可能是什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-07T22:19:01.557

在它上面运行[ProcMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)并查看它在尝试查找文件时真正做了什么会很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T22:22:11.003

这可能更多是网络驱动器问题。让他将该文件夹从 Y: 驱动器（从他的 Mac 共享）复制到 C: 驱动器并从那里再次运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-07T22:33:26.550

看起来您尝试从网络共享运行应用程序，.NET 平台禁止在其中运行应用程序，因为它存在安全风险。尝试将文件复制到虚拟机上的其他位置，例如 C:\Temp。

# css-float - 可以在 Zurb Foundation 中将一列保留在一行之外吗？

> ID：15554819
> 
> 赞同：0
> 
> 时间：2013-03-21T18:00:01.660
> 
> 标签：css-float, zurb-foundation, multiple-columns

这让我困惑了一段时间。

我试图弄清楚Foundation中是否可以并排放置两列，其中一列（比如左边的八列）在.row内，另一列（比如右边的四列）被推到右边页面边缘？

我希望有一段文本在左侧很好地对齐（因此在行内），然后有很多图像沿着页面的右边缘运行。

只是不确定这是否可以在 Foundation 中实现，或者我是否必须使用其他一些 CSS wizadry ......

谢谢

![在此处输入图像描述](../Images/2a49430734755e870712c4a338292910.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T10:04:05.227

SO 已经告诉我，我们正在扩展我们的讨论，因此无需进行聊天，并且根据我迄今为止对您的问题的理解，让我试一试。我在下面提供了一个示例代码。您的问题似乎很简单，至少根据我的看法，如果我做对了，请告诉我。如果没有，那么最好编辑您的问题并发布您拥有的代码，以便我们修复它。您需要对下面给出的代码使用 F4。

```
<div class="row">
        <h1>Short content on the left and lots of images</h1>
        <div class="large-8 columns">
            <p>Caramels tiramisu liquorice. Chocolate faworki brownie dragée wafer. Lemon drops tart bear claw wafer. Tootsie roll candy canes faworki lollipop bear claw bonbon sesame snaps jelly-o.  Danish sesame snaps toffee lollipop tootsie roll. Macaroon lollipop jelly-o pie gummi bears danish gummies jelly-o gingerbread. Pie croissant jujubes lollipop fruitcake icing. Fruitcake sweet roll cotton candy halvah gummi bears oat cake powder. Danish pudding toffee wypas bonbon macaroon lollipop faworki tiramisu.</p>
        </div>
        <div class="large-4 columns">
            <ul>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
            </ul>
        </div>
    </div>

    <div class="row">
        <h1>Really long content on the left and few images on the right</h1>
        <div class="large-8 columns">
            <p>Lollipop chupa chups danish lemon drops lollipop pudding croissant caramels muffin. Chupa chups jelly beans sesame snaps sesame snaps gummi bears. Marzipan chupa chups faworki bear claw gummi bears. Tiramisu chocolate cheesecake jelly-o applicake chupa chups. Pie lemon drops ice cream sweet roll icing. Dessert tootsie roll carrot cake. Caramels caramels powder jujubes. Oat cake cheesecake dragée wafer sweet jelly-o. Lollipop donut cake candy chocolate. Pie candy canes oat cake powder carrot cake lollipop. Jujubes sesame snaps lemon drops cookie. Pastry jelly oat cake danish tootsie roll cupcake macaroon candy dragée. Cupcake apple pie dessert donut tootsie roll pudding. Jujubes lollipop wypas icing chocolate cake.
Pie apple pie caramels gummies cotton candy danish pastry bonbon. Croissant danish chupa chups wypas ice cream cookie apple pie sweet soufflé. Cake cotton candy wafer sweet roll oat cake cupcake. Sugar plum cake ice cream tiramisu sweet roll biscuit chocolate bear claw. Donut cheesecake tart apple pie dragée. Bear claw cake gummies faworki pastry jelly marzipan sugar plum chupa chups. Biscuit chocolate bar halvah oat cake topping wypas bonbon. Icing cake muffin apple pie chocolate bar. Gummies lollipop biscuit pudding pie cupcake soufflé toffee. Gingerbread tiramisu jelly wypas. Bear claw bonbon chupa chups chocolate cake tiramisu croissant chocolate chupa chups ice cream. Faworki applicake marzipan soufflé chupa chups donut. Tart gummies topping. Caramels pastry ice cream croissant fruitcake sugar plum.
Caramels sugar plum topping jujubes cake tiramisu sweet roll sweet roll cupcake. Tart wafer cupcake. Donut sweet dessert danish bear claw lollipop candy cheesecake. Toffee icing croissant. Gummies chocolate cake sweet chocolate bar pudding candy dragée liquorice. Jelly-o jelly-o croissant cotton candy marzipan chupa chups biscuit chocolate cake dessert. Marshmallow gummies sugar plum dessert. Applicake jelly cheesecake cotton candy ice cream cheesecake muffin marzipan. Cheesecake cupcake cookie marshmallow icing. Marzipan croissant carrot cake. Faworki candy canes jelly chocolate bar muffin. Bear claw biscuit chocolate cake sugar plum sweet sweet macaroon. Brownie liquorice gummies lemon drops cookie apple pie lemon drops chocolate bar chocolate bar. Sweet roll dessert sesame snaps jelly beans wafer.
Croissant tiramisu pudding cheesecake. Chocolate sweet roll gingerbread gingerbread muffin wafer sugar plum tiramisu. Wafer chocolate cake bear claw applicake wafer. Cupcake cookie bonbon. Sweet jujubes chocolate cake cheesecake danish chocolate cake pie wafer tart. Biscuit croissant wypas lollipop soufflé croissant soufflé. Carrot cake gummies toffee cookie. Wypas pudding chocolate bar jujubes. Icing apple pie pudding wypas bonbon carrot cake. Dessert cupcake marzipan gummi bears carrot cake candy. Cake jujubes jujubes cheesecake. Candy topping powder tart jelly-o. Sesame snaps cheesecake danish icing. Topping cake chocolate bar chocolate lemon drops candy bear claw marzipan.
Jujubes liquorice macaroon. Macaroon tart sweet. Donut caramels oat cake topping halvah. Jelly topping soufflé. Tootsie roll candy pie jelly beans applicake croissant. Tiramisu cookie sesame snaps. Pastry danish topping candy pie jelly beans cookie. Wypas pudding chupa chups cookie cake icing. Cupcake tiramisu ice cream gummies ice cream. Marzipan powder candy cookie faworki biscuit jelly-o toffee jelly-o. Cotton candy caramels pudding jelly-o chocolate cake sugar plum fruitcake cupcake applicake. Lemon drops liquorice bonbon wafer fruitcake cupcake cotton candy. Liquorice toffee jujubes pudding gingerbread biscuit.
Jujubes chocolate cake chocolate bar sesame snaps dragée. Biscuit carrot cake dragée gummi bears liquorice lollipop. Cupcake cake topping brownie gummi bears sweet danish carrot cake bonbon. Tiramisu cookie jelly beans toffee biscuit faworki danish sweet roll caramels. Sesame snaps jelly beans candy canes oat cake sesame snaps bonbon. Sweet cotton candy pudding pie ice cream dragée ice cream. Tart pudding marshmallow ice cream chocolate cake cupcake caramels. Marzipan caramels muffin jelly chupa chups bonbon faworki icing sugar plum. Pastry chocolate donut. Jelly carrot cake bonbon gingerbread. Cotton candy candy canes oat cake liquorice. Ice cream gummi bears dragée cookie toffee. Biscuit sugar plum gingerbread chupa chups chocolate bar pastry apple pie jelly sweet.
Tart powder cookie gingerbread icing cake apple pie. Topping danish halvah. Tootsie roll cookie pudding tootsie roll donut pudding toffee apple pie. Danish tart gummi bears oat cake halvah candy canes pastry marshmallow. Sugar plum jelly beans jelly-o pudding carrot cake chocolate cake donut. Fruitcake candy toffee sweet gummies dragée gummi bears tart macaroon. Powder danish liquorice danish biscuit. Oat cake brownie cheesecake wypas lollipop. Fruitcake cupcake biscuit sweet roll. Sesame snaps wypas dessert jelly donut jelly beans candy. Lollipop chocolate cake gummi bears bear claw fruitcake sweet. Pie toffee wypas.
Chupa chups powder bear claw cookie. Jujubes chocolate cheesecake jelly beans dessert icing chocolate cake wafer fruitcake. Marshmallow donut tiramisu lollipop. Muffin ice cream jelly liquorice tootsie roll pudding apple pie apple pie. Muffin cake sweet cupcake cotton candy carrot cake. Apple pie pie cookie powder bear claw tiramisu. Tiramisu jelly-o dragée bonbon sweet roll lollipop macaroon wafer. Oat cake bonbon chocolate cake. Soufflé cake fruitcake. Muffin bonbon cake apple pie cupcake jelly-o. Candy chocolate jelly beans cheesecake liquorice. Halvah jelly-o biscuit donut jelly beans faworki.
Tootsie roll bear claw soufflé. Apple pie fruitcake gummies. Applicake oat cake liquorice faworki apple pie tart cookie. Pastry halvah marzipan chocolate cake carrot cake topping. Cupcake tootsie roll cake. Pastry jelly pie. Chupa chups icing cake lollipop pastry brownie soufflé. Powder toffee fruitcake. Lemon drops icing cotton candy faworki cheesecake. Bonbon marshmallow brownie jelly. Chocolate bar marshmallow lollipop brownie. Pie soufflé tootsie roll chupa chups halvah jelly beans.
Gummi bears jujubes jujubes fruitcake dessert bear claw gingerbread. Ice cream lollipop dessert soufflé sweet roll carrot cake. Tootsie roll wafer cotton candy. Croissant cotton candy cupcake jelly-o sweet roll bear claw. Halvah croissant pie liquorice chupa chups croissant toffee. Cotton candy apple pie topping danish halvah jelly-o apple pie marzipan. Halvah pastry bear claw sesame snaps wafer faworki apple pie. Soufflé fruitcake soufflé sweet roll apple pie bear claw. Pastry oat cake gummi bears powder. Bonbon cupcake dessert. Croissant halvah soufflé gingerbread. Faworki caramels gummies lemon drops cookie. Toffee muffin apple pie.
Sweet roll jelly-o cupcake fruitcake cotton candy chocolate fruitcake fruitcake croissant. Oat cake dessert gummi bears sugar plum dessert soufflé donut carrot cake jujubes. Croissant lollipop chocolate bar sweet roll marzipan. Macaroon carrot cake tootsie roll ice cream ice cream faworki wypas chocolate bar soufflé. Wypas caramels candy muffin donut lemon drops dragée. Candy canes topping carrot cake toffee ice cream icing jelly-o sweet powder. Gummies muffin donut dragée tiramisu applicake jelly beans jelly. Danish donut marzipan croissant. Brownie tiramisu oat cake wafer cotton candy biscuit. Biscuit candy candy canes gummies candy croissant. Pastry sugar plum chupa chups caramels cake candy canes macaroon sugar plum halvah. Bonbon chupa chups sugar plum sesame snaps cookie sugar plum cake liquorice. Jelly beans lollipop sesame snaps ice cream chocolate cake pudding sweet chocolate cake topping.
Dragée dessert wafer biscuit oat cake brownie cupcake gingerbread. Pie gingerbread powder fruitcake lemon drops. Lemon drops candy canes pastry. Powder halvah danish candy canes oat cake. Jujubes caramels halvah cotton candy dragée jelly-o biscuit jelly. Candy halvah muffin muffin sugar plum caramels muffin jujubes jelly. Danish cookie cotton candy chupa chups danish tootsie roll pie. Chocolate cake wafer sesame snaps lemon drops. Sesame snaps pastry lemon drops fruitcake brownie. Dessert jujubes liquorice croissant croissant croissant. Biscuit pie donut lollipop danish applicake muffin applicake brownie. Chupa chups icing topping danish chocolate cake marzipan. Lollipop halvah wypas faworki donut pudding. Macaroon pastry chocolate bar icing toffee.
Bonbon bonbon lollipop gummies. Faworki ice cream pudding applicake topping chocolate cake. Candy soufflé candy sweet cotton candy pie. Caramels pudding brownie pastry gummies icing marzipan sweet. Sweet candy canes cotton candy dessert macaroon. Jujubes wypas macaroon. Macaroon biscuit gingerbread oat cake tart chocolate cake sesame snaps sugar plum. Fruitcake candy canes dragée pudding. Chocolate bar cotton candy sweet chocolate cake bonbon cotton candy liquorice bear claw. Pie oat cake cake topping sugar plum tiramisu cotton candy. Tootsie roll sugar plum candy topping croissant chupa chups pudding. Pastry lemon drops apple pie bear claw jelly-o topping.
Apple pie chupa chups marzipan. Soufflé lollipop marshmallow. Sesame snaps toffee tart cupcake donut candy chupa chups. Apple pie halvah chocolate macaroon bonbon. Croissant marshmallow liquorice chocolate bar gummies jelly-o pudding wafer icing. Chupa chups gummi bears tiramisu marshmallow marshmallow pastry fruitcake fruitcake cake. Bonbon ice cream marshmallow cheesecake pie tiramisu gingerbread candy cupcake. Ice cream jelly-o gingerbread dragée icing marzipan chocolate bar. Chocolate sweet bear claw faworki danish jelly. Cake marshmallow tart chocolate. Cheesecake jelly cotton candy oat cake sugar plum. Topping cupcake candy canes oat cake cookie. Cupcake cheesecake cookie fruitcake sesame snaps gingerbread marzipan candy canes candy canes. Croissant tootsie roll tart jujubes jelly-o tootsie roll danish jelly-o donut.
Jujubes toffee sesame snaps croissant jujubes. Faworki chocolate bar cheesecake carrot cake tiramisu topping marzipan dessert. Liquorice icing pastry wypas dragée jujubes jelly pastry. Carrot cake biscuit pie muffin dessert. Tiramisu oat cake wypas icing pie pudding dragée chocolate. Gingerbread fruitcake powder candy sugar plum. Chocolate dragée sweet roll cupcake sweet chocolate cake. Pie donut topping gummies fruitcake tootsie roll chocolate cake. Icing faworki chupa chups. Donut chocolate bar cake gummies donut chocolate cake sweet sugar plum. Chupa chups sugar plum marzipan jelly-o applicake. Icing pudding marzipan oat cake chocolate jujubes donut pudding caramels. Carrot cake sweet gummi bears apple pie carrot cake dragée oat cake. Muffin marzipan tart sweet roll cupcake cupcake.</p>
        </div>
        <div class="large-4 columns">
            <ul>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>
                <li><img src="http://placehold.it/100x100"></li>                
            </ul>
        </div>
    </div> 
```

哦，当然标记假定您的列表项是内联显示的。

**更新：** 你有没有尝试过这样的事情：

```
.row.flushed {
    position: fixed;
    right: 0;
    top: 50px;
    width: 33%;
} 
```

# kendo-ui - KendoUI 网格自定义命令被多次触发

> ID：15554820
> 
> 赞同：0
> 
> 时间：2013-03-21T18:00:03.377
> 
> 标签：kendo-ui, kendo-grid

我有一个 KendoUI 网格。其中，其中一列定义了一个自定义命令：

```
command: { text: "Add", click: addLine } 
```

当用户单击按钮时，此网格会显示在 Kendo 窗口中。同一个按钮重新渲染网格并首先清除 HTML：

```
$("#kendoGridQuick").html("");
$("#kendoGridQuick").kendoGrid({ 
```

创建网格后，窗口显示。我的问题是，无论我多次显示此窗口并创建网格，此命令都会准确触发。所以它第一次工作正常，但第二次被调用两次，第三次被调用三次，等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T18:11:33.280

问题是您没有破坏`Grid`对象。[`Grid.destroy`](http://docs.kendoui.com/api/web/grid#methods-destroy)您应该在清除 HTML 之前调用方法。

```
var grid = $("#kendoGridQuick").data("kendoGrid");
// detach events
grid.destroy(); 
```

另外，尽量节省CPU和内存关闭和打开但不破坏网格。只要您始终使用相同的基本结构，您就可以在窗口即将打开时重新绑定/重新读取新数据（更快更简单）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T18:26:33.747

而不是浪费 CPU 创建和销毁网格。仅在页面加载时初始化网格一次，并在单击按钮时显示/隐藏窗口（您不需要重新初始化它）。

如果您仍然遇到困难，请分享一些代码，以便我们了解您在何处以及如何初始化 Grid。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-24T11:20:31.137

这是剑道网格。但是，我们可以在再次出价数据之前处理以下内容以清除网格。

$("#gridSaleEvent").html("");

# android - Android - 从操作系统的应用最近应用列表启动的活动

> ID：15554821
> 
> 赞同：0
> 
> 时间：2013-03-21T18:00:04.020
> 
> 标签：android, launch, android-recents

当应用程序从操作系统的最近列表启动时，有没有办法确保正常启动活动实际启动或在清单中设置启动活动，甚至阻止应用程序从历史记录启动操作系统？

IE

```
<category android:name="android.intent.category.(HISTORY)" /> 
```

我有一个应用程序，必须通过特定的活动序列设置状态，所以我想确保这一点，而无需在 onCreate() 方法中进行测试和调用 finish() 和 startActivity() 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:13:23.387

如果您正在谈论最近的应用程序，您可以使用 android:excludeFromRecents=["true" | “错误的”]

"该activity发起的任务是否应该被排除在最近使用的应用程序列表（“最近的应用程序”）中。也就是说，当这个activity是一个新任务的根activity时，这个属性决定了这个任务是否不应该出现在最近的应用程序列表中。如果任务应该从列表中排除，则为“true”；如果应该包含，则为“false”。默认值为“false”。”

参考：http: [//developer.android.com/guide/topics/manifest/activity-element.html](http://developer.android.com/guide/topics/manifest/activity-element.html)

# c# - 通过依赖注入记录与使用单元测试的隐式依赖

> ID：15554822
> 
> 赞同：-1
> 
> 时间：2013-03-21T18:00:06.583
> 
> 标签：c#, log4net

我有一个类需要使用 Log4net 进行日志记录。以下是考虑单元测试的两种可能的解决方案。

解决方案1：

```
public class Car{
  ILog log;
  public Car(ILog log){
  this.log = log
  }

   //use logging for other methods
} 
```

解决方案2：

```
public class Car
  ILog log = LogManager.GetLogger(typeof(Car));
  public Car(){
  }

   //use logging for other methods
} 
```

问题：

1）一般来说哪种方式更好？

2）对于解决方案2，我应该如何在单元测试中替换记录器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:24:03.240

您使用的是静态工厂 (LogManager)，但非静态工厂可能会更好。然后可以自己传入工厂，单元测试可以使用它创建自己的ILog对象。这使得模拟变得更容易。

您仍然需要一种制造工厂的方法，但您可以传递一个仪器化的测试版本来帮助进行测试。

# java - Android：列表视图的 android:dividerHeight 的默认值是什么

> ID：15554824
> 
> 赞同：4
> 
> 时间：2013-03-21T18:00:10.133
> 
> 标签：java, android, android-layout, android-listview, divider

`android:dividerHeight`简单的问题：普通列表视图的默认值是多少？我敢打赌你可能会在某个地方找到它，但我不知道在哪里。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:30:13.307

其他两个答案都只是部分正确。ListView_dividerHeight 是可设置的，但 Android 本身并没有设置默认值（至少不是普通的 Android）。如果应用程序本身没有设置这样的值，例如：

```
<item name="android:dividerHeight">5dp</item> 
```

然后@android:drawable/divider_horizo​​ntal_dark_opaque 将被使用，它以四种不同的“风格”（ldpi、mdpi、hdpi 和 xhdpi）存在。

所以“真正的”答案是：没有办法说。这取决于：

*   屏幕密度
*   安卓版
*   由制造商定制
*   应用主题
*   可能其他因素

要自己找到这些答案，请查看您的 Android SDK 文件夹：platforms\android-17\data\res\values\attrs.xml / styles.xml / Themes.xml（android-17 可能因您的安装而异）并阅读文档关于主题和样式：http: [//developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:16:48.463

//您可以在您的 Android SDK 文件夹中看到分隔符只是一个 9-patch 图像

```
android-sdk-windows\platforms\android-xx\data\res\values\styles.xml

<style name="Widget.ListView" parent="Widget.AbsListView">
        <item name="android:listSelector">@android:drawable/list_selector_background</item>
        <item name="android:cacheColorHint">?android:attr/colorBackgroundCacheHint</item>
        <item name="android:divider">@android:drawable/divider_horizontal_dark_opaque</item>
    </style>

    <style name="Widget.ListView.White" parent="Widget.AbsListView">
        <item name="android:listSelector">@android:drawable/list_selector_background</item>
        <item name="android:cacheColorHint">?android:attr/colorBackgroundCacheHint</item>
        <item name="android:divider">@android:drawable/divider_horizontal_bright_opaque</item>
    </style> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:22:14.603

我敢打赌，这取决于所使用的 android 版本/样式/手机制造商的变化。

快速查看 android 源代码：

```
TypedArray a = context.obtainStyledAttributes(attrs,
            com.android.internal.R.styleable.ListView, defStyle, 0);

// Use the height specified, zero being the default
final int dividerHeight = a.getDimensionPixelSize(
            com.android.internal.R.styleable.ListView_dividerHeight, 0);
if (dividerHeight != 0) {
    setDividerHeight(dividerHeight);
} 
```

# java - Java 新手 - 什么是 JPA 和 DAO？

> ID：15554826
> 
> 赞同：10
> 
> 时间：2013-03-21T18:00:11.003
> 
> 标签：java, jpa, ejb, dao

我是 Java 新手，我正在尝试使用 servlet 制作一个 Web 项目。我想查询我的数据库，但我认为我不了解有关 JPA 和 DAO 的所有内容。

我被教导以这种方式做事：

*   创建类 com.package.entity.User （从我的数据库生成）
*   创建接口 com.package.dao.UserDao
*   创建类 com.package.dao.jpa.JpaUserDao 实现 UserDao
*   使用类似的方法创建 EJB com.package.service.UserService`public List<User> findAll()`

我听说没有必要使用 JPA 创建 DAO 接口，但我完全迷失了，我完全不明白我应该做什么或 EJB 是什么。我只是想在我的数据库中找到所有用户并按照 Java 的良好实践显示他们的名字。

对我的 servlet 和 JSP 来说一切正常。

你会推荐什么 ？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-21T18:45:56.943

DAO 代表“数据访问对象”。它抽象了“从数据存储中获取某些东西”的概念。您的 DAO 对象可以通过 JDBC 调用、JPA 调用或其他方式实现。也许它调用了一些远程网络服务。在 JPA 上使用 DAO 似乎是多余的，它确实增加了一层，但我认为这是值得的。

例如，您可能有一个“显示有绿眼睛的用户”的用例。

使用直接 JPA：

```
List<User> users = entityManager.createQuery("select u  from User u where u.EyeColor = 'green'""); 
```

使用 DAO，您将拥有：

```
List<User> users = dao.UsersWithEyeColor("green"); 
```

这里的 DAO 有几个优点：

1.  它更容易阅读。
2.  它不会将您的数据库结构暴露给应用程序的其余部分
3.  单元测试会容易得多。获得绿眼用户的类只需要创建一个“模拟”道。这比模拟 JPA 更容易。

这些只是使用 DAO 的几个论据。对于一个非常简单的小型应用程序，它可能会产生太多开销。但是对于任何会变得更大并且需要维护多年的东西，我认为这是值得的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-21T18:57:40.273

DAO（数据访问对象）基本上是一种编程模式，要使用它，您必须创建一个类，该类将创建一个对象，该对象为某种类型的持久性单元（db、文件系统、xml 等）提供抽象接口。为什么有用吗？因为它提供了一些特定的数据操作而不暴露数据库的细节。

DAO 的一个基本示例：

```
import java.util.List;

public abstract class DAOFactory {

    public static final int MYSQL_JDBC = 1;
    public static final int MYSQL_JPA = 2;
    public static final int MYSQL_HIBERNATE = 3;

    public abstract List<UserDTO> listAllUsers();

    public static DAOFactory getDAOFactory(int whichFactory) {
        switch (whichFactory) {
        case MYSQL_JDBC : return new MySqlJDBCDaoFactory();
        case MYSQL_JPA: return new MySqlJpaDaoFactory();
        case MYSQL_HIBERNATE: return new MySqlHibernateDaoFactory();
        default: return null;
        }
    }

} 
```

然后，您必须为您将在应用程序中管理的每种持久性类型创建一个特定的工厂，并且该特定工厂必须实现您用于持久性的方法，例如 listAllUsers();

例如，对于 MySQL JPA：

```
public class MySqlJpaDaoFactory extends DAOFactory {

    @Override
    public List<UserDTO> listAllUsers() {
      // Here I implement specific functionality to retrieve data using JPA Framework
        //EntityManagerFactory emf = ...
        //EntityManager em = ...
        //List<UserDTO> list = em.get...();
        //return list;
        return null;
    }

} 
```

对于 MySQL JDBC，您必须执行其他过程：

```
public class MySqlJDBCDaoFactory extends DAOFactory {

    @Override
    public List<UserDTO> listAllUsers() {
        //Connection = DriverManager ...
        //PreparedStatement ps = connection.prepareStatement("select * from ...");
        //ResultSet = ps.executeQuery()
        // and so on...
        return null;
    }

} 
```

然后你以这种方式调用你的工厂：

```
DAOFactory myfactory = DAOFactory.getDAOFactory(DAOFactory.MYSQL_JDBC);
List<UserDTO> list = myfactory.listAllUsers(); 
```

如果你能看到无论你改变你的数据库框架还是持久化模式，你都不必重新发明轮子，只需要改变一个参数，你就会得到你想要的持久化的实现，只是基于一个参数。

希望它可以帮助您理解模式，我不使用 EJB，如果您使用的是 DAO，我认为仍然没有必要实现 EJB。

此致

# swi-prolog - Logtalk - logtalk_load 失败

> ID：15554827
> 
> 赞同：1
> 
> 时间：2013-03-21T18:00:12.757
> 
> 标签：swi-prolog, logtalk

我正在使用 swi prolog，并且刚刚安装了 logtalk。
当我用一些示例项目调用 logtalk_load 时，它总是返回 false。

```
% library(win_menu) compiled into win_menu 0.00 sec, 29 clauses
%   C:\Logtalk/configs/swi.pl compiled 0.02 sec, 1,539 clauses
%   C:\Logtalk\users\kikijiki/libpaths/libpaths.pl compiled 0.02 sec, 108 clauses
%   C:\Logtalk/integration/logtalk_comp_swi.pl compiled 0.11 sec, 2,626 clauses
%   c:/logtalk/users/kikijiki/settings.pl compiled 0.00 sec, 3 clauses

Logtalk 2.44.1
Copyright (c) 1998-2012 Paulo Moura

Default lint compilation flags: 
  unknown: warning, misspelt: warning, lgtredef: warning, plredef: silent
  portability: silent, missing_directives: warning
  singletons: warning, underscore_variables: singletons
Default documenting compilation flags:
  xmldocs: on, xmlspec: dtd, xmlsref: local, xslfile: lgtxml.xsl
Default directories compiler flags:
  altdirs: on, tmpdir: lgt_tmp/, xmldir: xml_docs/
Default optional features compiler flags:
  complements: deny, dynamic_declarations: deny
  context_switching_calls: allow, events: deny
Other default compilation flags:
  startup_message: flags, report: on
  code_prefix: $, hook: (none defined)
  optimize: off, source_data: on, debug: on
  clean: on, smart_compilation: off, reload: always
Back-end Prolog compiler and loader flags:
  prolog_compiler: []
  prolog_loader:   []
Read-only compilation flags (back-end Prolog compiler features):
  prolog_dialect: swi, break_predicate: supported, modules: supported
  threads: supported, encoding_directive: full, tabling: unsupported
  coinduction: supported

Loaded settings file found on directory c:/Logtalk/users/kikijiki.

%   C:\Logtalk/configs/swihooks.pl compiled 0.02 sec, 212 clauses
%    library(quintus) compiled into quintus 0.00 sec, 54 clauses
%    library(pce) loaded into pce 0.02 sec, 778 clauses
%   C:\Logtalk/configs/xpcehooks.pl compiled 0.02 sec, 785 clauses
%  c:\Logtalk\integration\logtalk_swi.pl compiled 0.17 sec, 5,302 clauses
% c:/users/kikijiki/appdata/roaming/swi-prolog/pl.ini compiled 0.17 sec, 5,305 clauses
XPCE 6.6.66, July 2009 for Win32: NT,2000,XP
Copyright (C) 1993-2009 University of Amsterdam.
XPCE comes with ABSOLUTELY NO WARRANTY. This is free software,
and you are welcome to redistribute it under certain conditions.
The host-language is SWI-Prolog version 6.2.6

For HELP on prolog, please type help. or apropos(topic).
         on xpce, please type manpce.

1 ?- logtalk_load('c:/logtalk/examples/people/loader').
% <<< loading source file c:/logtalk/examples/people/loader.lgt... 
% >>> compiling source file c:/logtalk/examples/people/loader.lgt in debug mode...
false. 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T13:30:31.390

以后请使用官方 Logtalk 支持渠道寻求帮助。你会在那里得到及时的回复。

Logtalk 2.44.1 不支持`logtalk_compile/1-2`and`logtalk_load/1-2`谓词中的完整或相对（当前目录中的文件除外）文件路径（请参阅有关这些谓词的参考手册）。在上述情况下，要加载“人员”编程示例，请键入：

```
?- logtalk_load(people(loader)). 
```

或者：

```
?- {people(loader)}. 
```

这被称为（在 Logtalk 文档中）“库符号”（它的符号也在 Prolog 中找到）。有关详细信息，请参阅“examples/people”文件夹中的“NOTES.txt”和“SCRIPT.txt”（所有示例都包含这两个文件以及有用的信息）。

顺便说一句，Logtalk 3 中提供了对相对和完整源文件路径的支持。

# java - 定义只接受特定范围值的 Java 变量

> ID：15554829
> 
> 赞同：5
> 
> 时间：2013-03-21T18:00:15.517
> 
> 标签：java, variables, static, field, final

是否有**内置**方法来定义接受特定范围内的值的字段/变量？**我的意思是在compile-time**解决它的一种方法。

例如，定义一个只取 1-10 之间值的*双精度*变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T18:03:12.437

你能得到的最接近的是

1）为您的值范围创建一个 Enum，这就是 Enums 的用途。

```
public Enum MyVals {
   ONE(1)
   TWO(2)
   ...

   private int val;
   MyVals(int val) {
      this.val = val;
   }
} 
```

[看到这个](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)。当然，这仅在值是离散的（即不是浮点数）时才有效

2）将字段设为私有并编写一个智能设置器，该设置器会在不可接受的值上爆炸。

```
public void setVal(int val) {
   if (val < 0 || val > 10) throw....;
   this.val = val;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T18:04:14.993

不，因为在编译时无法知道您的软件逻辑是否会产生超出范围的值。并且在运行时，本机 sdk 不支持它的实现。但是，您可以包装类型类（例如，创建`MyInteger`具有`Integer`实例的类作为由类中的范围验证方法包装的成员`MyInteger`）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T19:26:16.623

虽然不是用于指定范围的编译时选项，但另一种方法是使用像[Hibernate Validator](http://www.hibernate.org/subprojects/validator.html)这样的验证框架。[您可以使用@Range(min=, max=) 之](http://docs.jboss.org/hibernate/validator/4.3/reference/en-US/html_single/)类的注释来注释您的字段。您使用验证器对象的[validate 方法](http://docs.jboss.org/hibernate/validator/4.3/reference/en-US/html/validator-usingvalidator.html#section-obtaining-validator)来验证您的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T18:03:14.843

与您所说的最接近的是枚举，它允许您指定一组固定值。没有办法声明一个整数，但限制它可以拥有的有效值。不过，您可以创建自己的类型并强制执行此类限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T18:06:33.810

您可以将枚举用于此类集合。但我想你也想要一些有意义的值映射。在这种情况下，维护一个查找 HashTable，键为枚举，并为你想要的任何值。

# jquery - JQuery Mobile 动态列表视图过滤器不显示

> ID：15554830
> 
> 赞同：1
> 
> 时间：2013-03-21T18:00:17.403
> 
> 标签：jquery, ajax, html, css, jquery-mobile

我是 jquery mobile 的新手，并且不知何故想出了如何成功创建主页和现在的子页面（标记为“bible_studies”）以及**通过 AJAX 动态创建的列表。**

该列表看起来很棒，除了一件事之外一切都在工作......过滤器根本没有显示，即使我将数据过滤器设置为true。我已经尝试了很多我什至无法直视的东西......有人可以帮忙吗？

```
<!DOCTYPE html>
<html>
<head>
<title>Tetelestai Church Mobile | Home</title>    
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a1/jquery.mobile-1.0a1.min.css" />
<link href="styles/mobile.css" rel="stylesheet" type="text/css" />
<script src="http://code.jquery.com/jquery-1.4.3.min.js"></script>
<script src="http://code.jquery.com/mobile/1.0a1/jquery.mobile-1.0a1.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<style>
    .ui-li-thumb, .ui-li-icon {
        left: 1px;
        max-height: 125px; 
        max-width: 125px;
        position: absolute;
        top: 0;
    }
    #wrap{margin-left:50px;}
</style>
</head>
<body id="home">

<!-- Start of first page -->
<div data-role="page" id="home"> 

<h2 id="banner">Tetelestai Church Mobile</h2>
<div data-role="content">   
    <ul data-role="listview" data-inset="true">
        <li><a href="#bible_studies"><img src="../images/star.png" alt="Bible Studies" class="ui-li-icon">Bible Studies</a></li>
        <li><a href="#events"><img src="../images/events.png" alt="Events" class="ui-li-icon">Events</a></li>
        <li><a href="#news"><img src="../images/news.png" alt="Announcements" class="ui-li-icon">Announcements</a></li>
        <li><a href="#map"><img src="../images/map.png" alt="Times And Directions" class="ui-li-icon">Directions</a></li>
        <li><a href="#contact"><img src="../images/contact.png" alt="Contact Us" class="ui-li-icon">Contact Us</a></li>
    </ul>

    <ul data-role="listview" data-inset="true" data-theme="e">
        <li>
            <a href="http://www.tetelestai.org" data-ajax="false" rel="external"><img src="../images/full_screen.png" alt="Full Site" class="ui-li-icon">Full Site</a>
        </li>
    </ul>
    </p>
</div><!-- /content -->

</div><!-- /page -->

<div data-role="page" id="bible_studies">
<header data-role="header" data-theme="b">
    <h1>Tetelestai Bible Studies</h1>
</header>
<article data-role="content" id="bs">
</article>

</div>

 <script type="text/javascript">

//On document ready
$(document).ready(function(){

    //-----------------------------------------------------------------------
    // 2) Send a http request with AJAX http://api.jquery.com/jQuery.ajax/
    //-----------------------------------------------------------------------
    $.ajax({                                      
        url: "../data/series.php",                  //the script to call to get data          
        data: "",                        //you can insert url argumnets here to pass
                                       //for example "id=5&parent=6"
        dataType: 'json',                //data format      
        success: function(data)          //on recieve of reply
        {

            //--------------------------------------------------------------------
            // 3) Update html content
            //--------------------------------------------------------------------
            var list = $('<ul data-role="listview"  data-filter="true" id="series"/>');

            //Loop through each series
            $.each(data, function(key, val) {

                //Create list item
                $('<li><a href="#'+val.series+'"><img src="../assets/video/'+val.series+'/mobile_list_image.jpg" alt="'+val.name+'" /><div id="wrap"><h1>'+val.name+'</h1><p>'+val.description+'</p></div></a></li>').appendTo(list);

            })

            //Add list
            list.listview();
            list.appendTo('#bs');

        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T19:05:26.803

你有一个技术错误。当您创建这样的列表变量时：

```
var list = $('<ul data-role="listview"  data-filter="true" id="series"/>'); 
```

您需要立即将其添加到 #bs 内容中，如下所示：

```
var list = $('<ul data-role="listview"  data-filter="true" id="series"/>').appendTo('#bs'); 
```

Final Filter 元素不是 ul listview 的一部分，并且因为您在将其附加到内容之前使用 .listview() 对其进行了样式设置，所以未附加 filer 元素。

我举了一个例子来告诉你我在说什么：http: [//jsfiddle.net/Gajotres/67dst/](http://jsfiddle.net/Gajotres/67dst/)

或者，我认为这也可以，只需将其更改为行：

```
 list.listview();
        list.appendTo('#bs'); 
```

对此：

```
 list.appendTo('#bs');
        list.listview(); 
```

这也应该有效，因为 listviev 在 .listview() 应用于它之前附加到内容。

# jquery - 在图像上时提示提示工具提示闪烁

> ID：15554833
> 
> 赞同：0
> 
> 时间：2013-03-21T18:00:27.270
> 
> 标签：jquery, css

我在图像上放置了一个提示提示工具提示，并通过外部文件添加了指向提示提示的 html 链接。我试图让线索提示在鼠标悬停在图像上时打开，然后在鼠标移出图像时关闭。这一切都有效，除了当我选择三个按钮之一时将鼠标移动到线索提示/图像上时线索提示闪烁...

如果有人可以帮助我，这些必须是一种方法谢谢

我目前有：

```
$(document).ready(function() {
  $(\'a.tips\').cluetip({
    width: 80,
    topOffset: -45,
    leftOffset:-90,
    positionBy: \'fixed\',
    cluetipClass:     \'rounded\',
    showTitle:        false,
    sticky:           true, 
    mouseOutClose:    true
      });  
}); 
```

最好是在鼠标关闭的情况下使用粘性“真实”，但我无法让它发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:03:06.813

通常添加[`.stop()`](http://api.jquery.com/stop/)修复闪烁的问题。我以前没有使用过 cuetip，但尝试类似：

```
$(\'a.tips\').stop().cluetip({ ... }); 
```

# java - 数据不会持久化

> ID：15554835
> 
> 赞同：1
> 
> 时间：2013-03-21T18:00:32.220
> 
> 标签：java, jpa, playframework, playframework-1.x

以下代码有什么问题？

```
 @PrePersist
    public void preSave() throws DuplicatePinException  {
        Logger.info("PRESAVE");
        for (PinBoard pb : board.pins) {
            if (pb.pin.id.equals(this.pin.id)) {
                throw new DuplicatePinException();
            }
        }
    } 
```

这个方法在我的 PinBoard 类中。我想要一种快速的方法来验证不能保存重复的条目。但是，如果我包含该方法，则不会保存任何内容。曾经。我将其追溯到`board.pins`. 我假设 pin 默认情况下是一个延迟加载的集合，所以可能是在保存时强制它初始化会搞砸一些事情。

我正在使用 Play 1.2.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:46:31.983

我不确定第 1 场比赛，但在第 2 场比赛中，@PrePersist 不包括在内，因此永远不会调用方法

# ios - Pocket SDK 有一个执行 API 调用的方法，我将如何使用它？

> ID：15554839
> 
> 赞同：2
> 
> 时间：2013-03-21T18:00:49.993
> 
> 标签：ios, objective-c, xcode, api, ios6

我是新手，我找不到太多关于使用这种方法的文档。

SDK 可以在这里找到：[https ://github.com/Pocket/Pocket-ObjC-SDK](https://github.com/Pocket/Pocket-ObjC-SDK)

我特别想使用这种方法：[https ://github.com/Pocket/Pocket-ObjC-SDK/blob/master/SDK/PocketAPI.h#L88](https://github.com/Pocket/Pocket-ObjC-SDK/blob/master/SDK/PocketAPI.h#L88)

为了使用此 API 调用：[http](http://getpocket.com/developer/docs/v3/retrieve) ://getpocket.com/developer/docs/v3/retrieve ，它将获取用户的文章。

我在方法中提供什么？正如我所说，我一般对这些东西很陌生，特别是委托等，所以我有点困惑如何去实现这个方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-19T21:57:39.723

下面的代码是一个示例，说明如何使用除 count 之外的所有默认参数调用[http://getpocket.com/developer/docs/v3/retrieve](http://getpocket.com/developer/docs/v3/retrieve)，我将其设置为 2。这假定用户已经登录，并且根据安装说明在 AppDelegate 中添加了这一行

```
[[PocketAPI sharedAPI] setConsumerKey:@"Your Consumer Key Here"]; 
```

.

```
#import "PocketAPI.h"

[[PocketAPI sharedAPI] callAPIMethod:@"get"
                      withHTTPMethod:PocketAPIHTTPMethodPOST
                           arguments:@{ @"count" : @"2" }
                             handler: ^(PocketAPI *api, NSString *apiMethod,
                                        NSDictionary *response, NSError *error){
                                 NSLog(@"%@", response);
                                 NSLog(@"%@", error);
                             }]; 
```

如果您只想使用默认参数。使用这个（nil 不起作用）：

```
arguments:@{} 
```

# php - Yii 返回连接模型的属性

> ID：15554840
> 
> 赞同：0
> 
> 时间：2013-03-21T18:00:57.277
> 
> 标签：php, mysql, yii, yii-cmodel

在 Yii 中，我有与位置相关联的媒体；我的关系是这样设置的：

公共职能关系（）{

```
 return array(
        'users' => array(self::HAS_ONE, 'Users', array('id' => 'user_id')), 
        'locations' => array(self::HAS_ONE, 'Locations', array('id' => 'object_id'), 'together' => true, 'select' => '*')
    );
} 
```

当我查询时，我使用 'with' 语句来连接表。

```
$models = Media::model()->with('lodcation') -> findAll($criteria); 
```

然后我将数据放入一个 json 对象并将其作为 CJSON 响应返回。

```
echo CJSON::encode($models); 
```

问题是返回的字段仅来自父模型，即 Media，而不是连接模型 Locations。我的问题是如何在 Yii 中同时显示父模型和连接模型结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:43:00.127

你的关系

```
'locations' => array(self::HAS_ONE, 'Locations', array('id' => 'object_id'), 'together' => true, 'select' => '*') 
```

有 name `'locations'`，但是当您尝试在查询中使用它时，您会引用`->with('lodcation')`，这使得 findAll 方法试图从不存在的关系中急切地加载数据。更改您的呼叫`$models = Media::model()->with('locations') -> findAll($criteria);` 应该可以解决此问题。

也许您使用的关系名称在这里引起了一些噪音：`'locations'`复数似乎指的是一系列位置。保持这个名字单一`'location'`应该使`self::HAS_ONE`关系的含义更清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:09:41.217

`CJSON::encode()`将始终只使用父模型的直接属性。您可以尝试以下扩展之一：

*   [http://www.yiiframework.com/extension/carjson](http://www.yiiframework.com/extension/carjson)
*   [http://www.yiiframework.com/extension/ejsonbehavior](http://www.yiiframework.com/extension/ejsonbehavior)

# c++ - boost::program_options：带有固定和可变标记的参数？

> ID：15554842
> 
> 赞同：8
> 
> 时间：2013-03-21T18:01:06.957
> 
> 标签：c++, boost, boost-program-options

是否可以将这种参数与 boost::program_options 一起使用？

```
program  -p1 123 -p2 234 -p3 345 -p12 678 
```

即，是否可以用第一个标记（例如`-p`）后跟一个数字来动态指定参数名称？
我想避免这种情况：

```
program  -p 1 123 -p 2 234 -p 3 345 -p 12 678 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-05T14:40:45.983

Boost.ProgramOptions 不为此提供直接支持。然而，有两种通用的解决方案，它们各有取舍：

*   通配符选项。
*   自定义解析器。

* * *

### 通配符选项

如果可以使用`--p`代替`-p`，则可以使用通配符选项。这需要`variables_map`在提取期间迭代，因为 Boost.ProgramOptions 不支持在重载`validate()`函数中同时接收键和值。

```
#include <iostream>
#include <map>
#include <string>
#include <utility>
#include <vector>

#include <boost/algorithm/string.hpp>
#include <boost/foreach.hpp>
#include <boost/lexical_cast.hpp>
#include <boost/program_options.hpp>

typedef std::map<int, int> p_options_type;

/// @brief Extract options from variable map with the a key of
///        <prefix>#*.
p_options_type get_p_options(
  const boost::program_options::variables_map& vm,
  const std::string prefix)
{
  p_options_type p_options;

  const std::size_t prefix_size = prefix.size();

  boost::iterator_range<std::string::const_iterator> range;
  namespace po = boost::program_options;
  BOOST_FOREACH(const po::variables_map::value_type& pair, vm)
  {
    const std::string& key = pair.first;

    // Key is too small to contain prefix and a value, continue to next.
    if (key.size() < (1 + prefix.size())) continue;

    // Create range that partitions key into two parts.  Given a key
    // of "p12" the resulting partitions would be:
    //
    //     ,--------- key.begin           -., prefix = "p"
    //    / ,-------- result.begin        -:, post-prefix = "12"
    //   / /   ,----- key.end, result.end -'
    //  |p|1|2|
    range = boost::make_iterator_range(key.begin() + prefix_size,
                                       key.end());

    // Iterate to next key if the key:
    // - does not start with prefix
    // - contains a non-digit after prefix
    if (!boost::starts_with(key, prefix) || 
        !boost::all(range, boost::is_digit()))
      continue;

    // Create pair and insert into map.
    p_options.insert(
      std::make_pair(
        boost::lexical_cast<int>(boost::copy_range<std::string>(range)),
        pair.second.as<int>())); 
  }
  return p_options;
}

int main(int ac, char* av[])
{
  namespace po = boost::program_options;
  po::options_description desc;
  desc.add_options()
    ("p*", po::value<int>())
    ;

  po::variables_map vm;
  store(po::command_line_parser(ac, av).options(desc).run(), vm);

  BOOST_FOREACH(const p_options_type::value_type& p, get_p_options(vm, "p"))
  {
    std::cout << "p" << p.first << "=" << p.second << std::endl;
  }
} 
```

及其用法：

```
./a.out --p1 123 --p2 234 --p3=345 --p12=678
p1=123
p2=234
p3=345
p12=678
```

这种方法需要遍历整个地图以识别通配符匹配，从而导致复杂度为`O(n)`. 此外，它需要修改所需的语法，其中`--p1 123`需要使用而不是`-p1 123`. 此限制是 Boost.ProgramOptions 的默认解析器行为的结果，其中单个连字符应后跟单个字符。

* * *

### 自定义解析器

另一种方法是将[自定义解析器](http://www.boost.org/doc/libs/1_48_0/doc/html/boost/program_options/basic_command_line_parser.html#id1101702-bb)添加到`command_line_parser`. 自定义解析器将允许`-p1`语法以及其他常见形式，例如`--p1 123`和`-p1=123`。有几个行为需要处理：

*   解析器一次将接收一个令牌。因此，它将接收`p1`和`123`单独调用。解析器负责配对`p1`到`123`.
*   Boost.ProgramOptions 至少需要一个解析器来处理一个令牌。否则[`boost::program_options::unknown_option`](http://www.boost.org/doc/libs/1_53_0/doc/html/boost/program_options/unknown_option.html)会被抛出。

为了解决这些行为，自定义解析器将管理状态并执行编码/解码：

*   当解析器接收到 时`p1`，它会提取`1`，并将状态存储在解析器中。此外，它还*为*.`p`
*   当解析器接收到 时`123`，它会将其与存储的状态一起编码为 的值`p`。

因此，如果解析器接收`-p1`到 and `123`，则将 2 个值插入到`variables_map`for 中`p`：*无操作*值 and `1:123`。

```
{“p”：[“*无操作*”，
          “1:123”] }
```

`p`通过提供帮助函数将编码向量转换为地图，这种编码对用户是透明的。解码的结果是：

```
{1：123}
```

这是示例代码：

```
#include <iostream>
#include <map>
#include <string>
#include <utility> // std::pair, std::make_pair
#include <vector>

#include <boost/algorithm/string.hpp>
#include <boost/foreach.hpp>
#include <boost/lexical_cast.hpp>
#include <boost/program_options.hpp>

typedef std::map<int, int> p_options_type;

/// @brief Parser that provides the ability to parse "-p# #" options.
///
/// @note The keys and values are passed in separately to the parser.
///       Thus, the struct must be stateful.
class p_parser
{
public:

  explicit
  p_parser(const std::string& prefix)
    : prefix_(prefix),
      hyphen_prefix_("-" + prefix)
  {}

  std::pair<std::string, std::string> operator()(const std::string& token)
  {
    // To support "-p#=#" syntax, split the token.
    std::vector<std::string> tokens(2);
    boost::split(tokens, token, boost::is_any_of("="));

    // If the split resulted in two tokens, then key and value were
    // provided as a single token.
    if (tokens.size() == 2)
      parse(tokens.front()); // Parse key.

    // Parse remaining token.
    // - If tokens.size() == 2, then the token is the value.
    // - Otherwise, it is a key.
    return parse(tokens.back());
  }

  /// @brief Decode a single encoded value.
  static p_options_type::value_type decode(const std::string& encoded)
  {
    // Decode.
    std::vector<std::string> decoded(field_count_);
    boost::split(decoded, encoded, boost::is_any_of(delimiter_));

    // If size is not equal to the field count, then encoding failed.
    if (field_count_ != decoded.size())
      throw boost::program_options::invalid_option_value(encoded);

    // Transform.
    return std::make_pair(boost::lexical_cast<int>(decoded[0]),
                          boost::lexical_cast<int>(decoded[1]));
  }

  /// @brief Decode multiple encoded values.
  static p_options_type decode(const std::vector<std::string>& encoded_values)
  {
    p_options_type p_options;
    BOOST_FOREACH(const std::string& encoded, encoded_values)
    {
      // If value is a no-op, then continue to next.
      if (boost::equals(encoded, noop_)) continue;
      p_options.insert(decode(encoded));
    }
    return p_options;
  }

private:

  std::pair<std::string, std::string> parse(const std::string& token)
  {
    return key_.empty() ? parse_key(token)
                        : parse_value(token);
  }

  /// @brief Parse key portion of option: "p#"
  std::pair<std::string, std::string> parse_key(const std::string& key)
  {
    // Search for the prefix to obtain a range that partitions the key into
    // three parts.  Given --p12, the partitions are:
    //
    //      ,--------- key.begin    -., pre-prefix   = "-"
    //     / ,-------- result.begin -:, prefix       = "-p"
    //    / /   ,----- result.end   -:, post-prefix  = "12"
    //   / /   /   ,-- key.end      -'
    //  |-|-|p|1|2|
    //
    boost::iterator_range<std::string::const_iterator> result =
      boost::find_first(key, prefix_);

    // Do not handle the key if:
    // - Key end is the same as the result end.  This occurs when either
    //   either key not found or nothing exists beyond the key (--a or --p)
    // - The distance from start to prefix start is greater than 2 (---p)
    // - Non-hyphens exists before prefix (a--p)
    // - Non-numeric values are after result.
    if (result.end() == key.end() ||
        distance(key.begin(), result.begin()) > 2 ||
        !boost::all(
          boost::make_iterator_range(key.begin(), result.begin()),
          boost::is_any_of("-")) ||
        !boost::all(
          boost::make_iterator_range(result.end(), key.end()),
          boost::is_digit()))
    {
      // A different parser will handle this token.
      return make_pair(std::string(), std::string());
    }

    // Otherwise, key contains expected format.
    key_.assign(result.end(), key.end());

    // Return non-empty pair, otherwise Boost.ProgramOptions will
    // consume treat the next value as the complete value.  The
    // noop entries will be stripped in the decoding process.
    return make_pair(prefix_, noop_);
  }

  /// @brief Parse value portion of option: "#"
  std::pair<std::string, std::string> parse_value(const std::string& value)
  {
    std::pair<std::string, std::string> encoded =
      make_pair(prefix_, key_ + delimiter_ + value);
    key_.clear();
    return encoded;
  }

private:
  static const int field_count_ = 2;
  static const std::string delimiter_;
  static const std::string noop_;
private:
  const std::string prefix_;
  const std::string hyphen_prefix_;
  std::string key_;
};

const std::string p_parser::delimiter_ = ":";
const std::string p_parser::noop_      = "noop";

/// @brief Extract and decode options from variable map.
p_options_type get_p_options(
  const boost::program_options::variables_map& vm,
  const std::string prefix)
{
  return p_parser::decode(vm[prefix].as<std::vector<std::string> >());
}

int main(int ac, char* av[])
{
  const char* p_prefix = "p";
  namespace po = boost::program_options;

  // Define options.
  po::options_description desc;
  desc.add_options()
    (p_prefix, po::value<std::vector<std::string> >()->multitoken())
    ;

  po::variables_map vm;
  store(po::command_line_parser(ac, av).options(desc)
          .extra_parser(p_parser(p_prefix)).run()
       , vm);

  // Extract -p options. 
  if (vm.count(p_prefix))
  {
    // Print -p options.
    BOOST_FOREACH(const p_options_type::value_type& p,
                  get_p_options(vm, p_prefix))
    {
      std::cout << "p" << p.first << "=" << p.second << std::endl;
    }
  }
} 
```

及其用法：

```
./a.out -p1 123 --p2 234 -p3=345 --p12=678
p1=123
p2=234
p3=345
p12=678
```

除了是一个更大的解决方案之外，一个缺点是需要通过解码过程才能获得所需的值。不能简单地`vm["p"]`以有意义的方式迭代结果。

# c# - 如何为将要分发的程序建立与数据库的连接

> ID：15554847
> 
> 赞同：0
> 
> 时间：2013-03-21T18:01:33.933
> 
> 标签：c#, winforms, ms-access

我有一个程序当前指向本地驱动器上的数据库。我将把数据集放在服务器上的网络驱动器上，然后将程序分发给其他计算机。我如何建立一个可以在其他计算机上工作的连接（网络驱动器号可能不同）？我尝试通过 App.Config 文件进行设置，并在 OleDbConnection 中使用不同的数据源配置。这是我的连接的缩短版本：

```
string strSQL = "INSERT INTO TestTable(Name1, Address) VALUES(@FirstName, @Address)";
        OleDbConnection myConnection = new OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\TEMP\\TestDatabase.accdb");
        OleDbCommand myCommand = new OleDbCommand(strSQL, myConnection);
        myCommand.Parameters.AddWithValue("@FirstName", txtName.Text);
        myCommand.Parameters.AddWithValue("@Address", txtAddress.Text);

        try
        {
            myConnection.Open();
            myCommand.ExecuteNonQuery();
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
        finally
        {
            myConnection.Close();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:14:36.777

Mike 在上面的评论 re: UNC 路径很有意义。只需使用

```
Data Source=\\servername\sharename\path\to\data\file.accdb; 
```

# excel - 返回值相对单元格引用

> ID：15554853
> 
> 赞同：-1
> 
> 时间：2013-03-21T18:01:44.897
> 
> 标签：excel, vba

我需要在不激活该单元格的情况下将单元格的值返回到表格中的最后一列。我已经让 VBA 返回最后一列。
这不起作用。

```
WorkPercent = Cells(2, LastCol - 1).Value 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:41:27.710

请使用 Offset 属性

```
WorkPercent  = Cells(2, LastCol - 1).Offset(1, 0).Value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:17:23.717

假设您正在谈论“特定表格下方一行和右侧一列的单元格”，您可以尝试：

```
Sub main()
    Dim sheet As Worksheet
    Dim tbl As ListObject
    Dim lastCol As Integer
    Dim lastRow As Integer

    Set sheet = ActiveSheet
    Set tbl = sheet.ListObjects("tbl")

    lastCol = tbl.DataBodyRange.Columns(tbl.DataBodyRange.Columns.Count).Column
    lastRow = tbl.DataBodyRange.Rows(tbl.DataBodyRange.Rows.Count).Row

    MsgBox sheet.Cells(lastRow + 1, lastCol + 1)
End Sub 
```

# android - 我应该使用 SQLite 还是 SharedPreferences 来存储登录详细信息？

> ID：15554857
> 
> 赞同：0
> 
> 时间：2013-03-21T18:01:56.403
> 
> 标签：android, session, login, sharedpreferences

我假设每部手机只有一个用户。在用户登录并根据我的服务器检查用户凭据后，我想存储他们的登录详细信息，这样他们就不必在每次应用程序启动时登录，更重要的是，对于每个 HTTP 请求。我应该为此使用 SQLite 或 SharedPreferences 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:03:26.167

将其视为唯一的用户名/密码组合，因此设置整个数据库将是过度的，因此 SharedPreferences 对您来说应该没问题。

但是，请记住，这些存储选项都不是特别安全，因此请确保以某种方式对其进行加密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:04:04.010

从技术上讲，您不应该存储普通的用户名和密码……您的服务器应该返回某种哈希值……也许您的会话信息或用户名和密码哈希在一起……将其存储在手机上，下次用户想要登录时，将其传递给服务器，服务器应使用该信息进行身份验证。这只是一个安全功能。

# c# - 回调继续

> ID：15554861
> 
> 赞同：0
> 
> 时间：2013-03-21T18:02:08.713
> 
> 标签：c#, wcf, callback, wcf-binding

在下面的代码（wcf 服务器）中，如果客户端断开连接，我希望代码继续处理。现在它跳转到 catch 语句并停止处理。回调的目的最终将更新客户端的请求进度，但客户端可以在任何阶段断开连接，并且我希望继续处理。

```
 public void ChatToServer(string texttoServer) // send some text to the server
        {
            Logging.Write_To_Log_File("Entry", MethodBase.GetCurrentMethod().Name, "", "", "", 1);

            try
            {

                Thread.Sleep(5000);
                IMyContractCallBack callback = OperationContext.Current.GetCallbackChannel<IMyContractCallBack>();
                callback.callbacktoServer("Progress is 20% complete");
                // Some extremely important processing
                ....
                callback.callbacktoServer("Progress is 40% complete");
                // Some extremely important processing
                ....
                callback.callbacktoServer("Progress is 60% complete");
                // Some extremely important processing
                ....
                callback.callbacktoServer("Progress is 80% complete");    

                // Some extremely important processing
                ....
                callback.callbacktoServer("Progress is 100% complete");                                   
            }
            catch (Exception ex)
            {

            }

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:36:20.697

如果我对您的理解正确，您需要做的就是从回调调用中捕获通信错误并忽略它们 - 您可能希望将回调调用放在它自己的方法中，这样您就不必重复异常每个进度通知站点的处理逻辑。

# asp.net - 通过脚本管理器在 asp.net 中的 ajax

> ID：15554864
> 
> 赞同：0
> 
> 时间：2013-03-21T18:02:19.877
> 
> 标签：asp.net, asp.net-ajax, scriptmanager

首先请原谅我糟糕的英语，这不是我的语言。

我正在尝试使用 ajax，如下所示：

我创建了一个 Web 服务和一个调用 Web 服务中的方法的网页。我正在尝试这样调用服务：

```
<button onclick="run()" formmethod="post">Sample</button> 
```

问题是，如果这个按钮在表单内，它就不起作用，因为它会回发。如果按钮在表单之外，它可以工作。

我怎样才能把这个按钮放在表单中，仍然让它调用网络服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:18:30.270

我认为问题是按钮在调用服务之前初始化提交。

我建议使用`input`按钮并处理`click`事件：

```
<input type='button' onclick='CallService();' value='Sample' id='btnSample' /> 
```

在你的脚本中有：

```
function CallService(){
    {ServiceName}.run({parameter},CallComplete);
}

function CallComplete(){
    document.form.submit();
} 
```

我会说这样做是为了让您知道在提交表单之前正在调用您的服务。

# ios - 设置委托

> ID：15554866
> 
> 赞同：0
> 
> 时间：2013-03-21T18:02:22.283
> 
> 标签：ios, objective-c

我相信这是非常基本的，但我找不到任何关于它的东西。

我有一个 viewController 女巫有一个带有一堆表单视图控制器的导航控制器的模态 segue。像这样：

viewController A ---(modal segue)---> navigationController ---> viewController B ---> viewController C

在 viewController CI 中做了一个委托，如下所示：

```
@protocol ViewControllerCDelegate <NSObject>
- (void)myMehtod;
@end

@interface ViewControllerC : UIViewController

@property (nonatomic, assign) id <ViewControllerCDelegate> myDelegate; 
```

（我已经合成了 myDelegate）

我想将 myDelegate 设置为 viewController A。我的问题是，我在哪里以及如何做到这一点？

我已经尝试在 viewController A 的 viewDidLoad 中这样做：

```
ViewControllerC *delegateController = [self.storyboard instantiateViewControllerWithIdentifier:@"ViewControllerC"];
delegateController.myDelegate = self; 
```

但委托似乎没有得到设置。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:15:34.990

当您实例化ViewController 时，您正在创建一个*新*的ViewControllerA。如果您想要现有的 ViewControllerA，您需要将其传递到控制器链中。如果这变得有问题，您可以在应用程序委托上创建一个属性来存储它。从哲学上讲，有些人可能反对将应用程序委托用作全局变量票据交换所，但它可能比将指针向下传递到 4 级视图控制器更干净。您确定在这种情况下需要委托模式吗？也许 NSNotificationCenter 会是一个更干净的选择？

# c++ - fork() 未声明的错误

> ID：15554872
> 
> 赞同：0
> 
> 时间：2013-03-21T18:02:47.143
> 
> 标签：c++, c, fork

我需要能够将 fork() 用于一个小项目。问题是示例代码不起作用：

```
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main()
{ 
    pid_t pID = fork();
    if (pID == 0) // child
    {
        printf("CHILD\n");
        // Code only executed by child process
    }
    else if (pID < 0) // failed to fork
    {
        printf("FAIL\n");
    }
    else // parent
    {
        printf("PARENT\n"); // Code only executed by parent process
    }
    // Code executed by both parent and child.

    system("PAUSE");
    return 0;   
} 
```

编译器说：“20 D:\Untitled1.cpp `fork' undeclared (first use this function)”

但我在互联网上读到它应该位于`#include <unistd.h>`.

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T18:06:02.840

在 Windows 上，您无法使用`fork()`. 使用`CreateProcess()`/`CreateProcessEx()`代替。

# nhibernate - 休眠和并发

> ID：15554873
> 
> 赞同：0
> 
> 时间：2013-03-21T18:02:52.653
> 
> 标签：nhibernate, concurrency, transactions

使此测试应用程序同时运行的最佳方法是什么？

当我的程序完成后，控制台应用程序将员工人数打印为`4057`. 这应该是`20000`因为我有`20`线程增加员工计数`1000`时间。

**程序.cs**

```
using System;
using System.Data;
using System.Diagnostics;
using System.Threading.Tasks;
using DataAccess;
using NHibernate;
using NHibernate.Cfg;
using NHibernate.Tool.hbm2ddl;

namespace NhibernatePlayground
{
    internal class Program
    {
        private static ISessionFactory _sessionFactory;
        private static Configuration _configuration;
        private static int TotalThreadCount = 20;
        private static int LoopCount = 1000;

        private static void Main(string[] args)
        {

            _configuration = BuildConfiguration();
            var se = new SchemaExport(_configuration);
            se.Drop(true, true);
            se.Create(false, true);

            _sessionFactory = _configuration.BuildSessionFactory();

            int companyId = Seed();

            Stopwatch sw = new Stopwatch();
            sw.Start();
            Task[] tasks = new Task[TotalThreadCount];
            for (int i = 0; i < TotalThreadCount; i ++)
            {
                tasks[i] = Task.Factory.StartNew(() => IncreaseEmployeeCount(LoopCount, companyId));
            }

            //Block until all tasks complete.
            Task.WaitAll(tasks);
            sw.Stop();

            Console.WriteLine("Employee Count: " + GetEmployeeCount(companyId));
            Console.WriteLine("Total Milliseconds: " + sw.ElapsedMilliseconds);
            Console.ReadKey();
        }

        private static Configuration BuildConfiguration()
        {
            Configuration configuration = new Configuration();
            configuration.Configure(); // A
            configuration.AddAssembly(typeof (Company).Assembly); // B            
            return configuration;
        }

        private static void IncreaseEmployeeCount(int count, int companyId)
        {
            for (int i = 0; i < count; i++)
            {
                using (ISession _session = _sessionFactory.OpenSession())
                {
                    using (ITransaction _transaction = _session.BeginTransaction())
                    {
                        var company = _session.Get<Company>(companyId);
                        company.EmployeeCount++;
                        _session.Save(company);
                        _transaction.Commit();
                    }
                }
            }
        }

        private static int Seed()
        {
            using (ISession _session = _sessionFactory.OpenSession())
            {
                using (ITransaction _transaction = _session.BeginTransaction())
                {
                    Company company = new Company
                        {
                            CompanyName = "Angus"
                        };

                    _session.Save(company);
                    _transaction.Commit();
                    return company.Id;
                }
            }
        }

        private static int GetEmployeeCount(int companyId)
        {
            using (ISession _session = _sessionFactory.OpenSession())
            {
                using (ITransaction _transaction = _session.BeginTransaction())
                {
                    Company company = _session.Get<Company>(companyId);
                    return company.EmployeeCount;
                }
            }
        }
    }
} 
```

**公司.hbm.xml**

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="DataAccess" namespace="DataAccess" >

  <class name="Company">
    <id name="Id">
      <generator class="hilo" />
    </id>

    <property name="IsActive" />

    <property name="CompanyName" />

    <property name="EmployeeCount" />

    <set name="Users" table="Users_Companies" cascade="none">
      <key column="CompanyId"/>
      <many-to-many column="UserId" class="UserProfile" />
    </set>    
  </class>

</hibernate-mapping> 
```

**公司.cs**

```
using Iesi.Collections.Generic;

namespace DataAccess
{
    public class Company : Entity<int>
    {
        public Company()
        {
            //it's not the best practice to initialize virtual properties in constructor but we're controlling 
            //the inheritance in this so doing this should be fine
            // http://stackoverflow.com/a/469577/89605
            Users = new HashedSet<UserProfile>();
        }

        public Company(string name)
            : this()
        {
            CompanyName = name;
            IsActive = true;
        }

        public virtual string CompanyName { set; get; }

        public virtual bool IsActive { set; get; }

        public virtual ISet<UserProfile> Users { set; get; }

        public virtual int EmployeeCount { set; get; }

        public virtual void CopyTo(Company target)
        {
            target.CompanyName = CompanyName;
            target.IsActive = IsActive;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T16:56:48.017

您需要在读取对象时在数据库中获取写锁。探索 Get() 或 ISession.Lock() 方法的锁定模式参数。这将是悲观锁定，适用于这样的场景（频繁写入相同的数据）。另一种方法是乐观锁定，当对相同数据的写入不频繁时，它的效果最好。为此，请探索 NHibernate 的 <version> 映射元素。

# java - 如何将泛型类作为参数传递给 Intent 构造函数

> ID：15554874
> 
> 赞同：9
> 
> 时间：2013-03-21T18:02:58.627
> 
> 标签：java, android, generics

我的 android 应用程序中有这个通用活动

```
public class NavegadorActivity<T> extends Activity {

    ....
...
} 
```

我试图将其称为如下

```
Intent intent = new Intent(v.getContext(), NavegadorActivity<Clientes>.class); 
```

但是，Intent 构造函数不接受泛型类作为参数。然后我尝试了这段代码

```
Class<NavegadorActivity<Clientes>> NavClientes =  NavegadorActivity.class;

Intent intent = new Intent(v.getContext(), NavClientes.class); 
```

这也不起作用。

也不是这个

```
Class<NavegadorActivity<Clientes>> NavClientes =  NavegadorActivity<Clientes>.class;

Intent intent = new Intent(v.getContext(), NavClientes.class); 
```

任何人都知道如何将泛型类作为参数传递给 Intent 构造函数？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T18:21:05.213

我不相信 android Intent System 支持`Generic`活动，你不应该只是自己创建一个活动对象。我建议向您的活动添加一个代表通用功能的内部类，并通过该通用名称传递该通用名称

```
intent.putExtraString("class", yourClass.getName()); 
```

并通过检索该类对象

```
Class<?> myGeneric = Class.forName(intent.getStringExtra("class", "java.Object"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:06:34.130

怎么了

```
Intent intent = new Intent(v.getContext(), NavegadorActivity.class); 
```

# javascript - 如何使用 superscrollorama 对多个单词使用相同的补间？

> ID：15554879
> 
> 赞同：0
> 
> 时间：2013-03-21T18:03:13.573
> 
> 标签：javascript, html, tween, gsap

我在这里再次成为一个新手——我正在尝试使用[http://johnpolacek.github.com/superscrollorama/](http://johnpolacek.github.com/superscrollorama/)并且你可以想象 java 脚本的想法对我来说是非常压倒性的，尤其是这个“补间”的东西。

无论如何，我正在尝试制作一个滚动动画文字启动页面，并且我想两次使用相同的补间，我尝试查看常见问题解答等等，但即使它们对我来说太先进了，我还无法理解（嘎！）我试着输入'fade-it' 两次，但这不起作用。在底部添加另一个“淡入淡出”脚本也没有。显然我在这里遗漏了一些东西。有人想帮助我认为可能是一个容易解决的问题吗？;)

```
<div id="raychulllogo">
    <h2 id="fade-it">I'M <br> <img src="images/raychulllogoDARK.png" > </h2>
</div>

<h2 id="spin-it"></h2>
<p id="med">AND I </p>
<h2 id="smush-it">PHOTOGRAPH,</h2>
<h2 id="scale-it">DESIGN</h2>
<h2 id="fade-it"> &amp; FILM </h2> 
```

这是JavaScript：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script type="text/javascript" src="js/greensock/TweenMax.min.js"></script>
<script>window.jQuery || document.write('<script src="_/js/jquery-1.9.1.min.js"><\/script>')</script>
<script src="js/jquery.superscrollorama.js"></script>
<script>
    $(document).ready(function() {
        var controller = $.superscrollorama();
        // individual element tween examples
        controller.addTween('#fade-it', TweenMax.from( $('#fade-it'), .5, {css:{opacity: 0}}));
        controller.addTween('#scale-it', TweenMax.fromTo( $('#scale-it'), .25, {css:{opacity:0, fontSize:'20px'}, immediateRender:true, ease:Quad.easeInOut}, {css:{opacity:1, fontSize:'240px'}, ease:Quad.easeInOut}));
        controller.addTween('#smush-it', TweenMax.fromTo( $('#smush-it'), .25, {css:{opacity:0, 'letter-spacing':'30px'}, immediateRender:true, ease:Quad.easeInOut}, {css:{opacity:1, 'letter-spacing':'-10px'}, ease:Quad.easeInOut}), 0, 100); // 100 px offset for better timing
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:13:14.090

It may be as easy as switching to classes, instead of ids (you can't have multiple identical ids). So change to this:

```
 <div id="raychulllogo">
    <h2 class="fade-it">I'M <br> <img src="images/raychulllogoDARK.png" > </h2>
   </div>
    <h2 class="spin-it"></h2>
    <p class="med">AND I </p>
    <h2 class="smush-it">PHOTOGRAPH,</h2>
    <h2 class="scale-it">DESIGN</h2>
    <h2 class="fade-it"> &amp; FILM </h2>
</div> 
```

and

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script type="text/javascript" src="js/greensock/TweenMax.min.js"></script>
<script>window.jQuery || document.write('<script src="_/js/jquery-1.9.1.min.js"><\/script>')</script>
<script src="js/jquery.superscrollorama.js"></script>
<script>
    $(document).ready(function() {
        var controller = $.superscrollorama();
        // individual element tween examples
        controller.addTween('.fade-it', TweenMax.from( $('.fade-it'), .5, {css:{opacity: 0}}));
        controller.addTween('.scale-it', TweenMax.fromTo( $('.scale-it'), .25, {css:{opacity:0, fontSize:'20px'}, immediateRender:true, ease:Quad.easeInOut}, {css:{opacity:1, fontSize:'240px'}, ease:Quad.easeInOut}));
        controller.addTween('.smush-it', TweenMax.fromTo( $('.smush-it'), .25, {css:{opacity:0, 'letter-spacing':'30px'}, immediateRender:true, ease:Quad.easeInOut}, {css:{opacity:1, 'letter-spacing':'-10px'}, ease:Quad.easeInOut}), 0, 100); // 100 px offset for better timing
    });
</script> 
```

Just to be clear, `<h2 id="fade-it">` changes to `<h2 class="fade-it">` etc. and `$('#fade-it')` changes to `$('.fade-it')` etc.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T14:03:38.927

我正在尝试同样的事情并且 .class 事情没有工作，但我找到了一种让它工作的方法：为每个你想要动画的东西创建不同的类

```
class="fade-it1" class="fade-it2" class="fade-it3" 
```

并添加相同的控制器，例如：

```
controller.addTween('.fade-it', TweenMax.from( $('.fade-it'), .5, {css:{opacity: 0}}));
controller.addTween('.fade-it2', TweenMax.from( $('.fade-it2'), .5, {css:{opacity: 0}}));
controller.addTween('.fade-it3', TweenMax.from( $('.fade-it3'), .5, {css:{opacity: 0}})); 
```

我试过了，它奏效了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-26T22:06:27.267

遇到这个寻找相同问题的答案。似乎“#fly-it”选项也需要对css文件进行一些更改。当在同一个 html 页面中需要多个“#fly-it”时，您还需要将以下内容添加到您的 css 文件中。

```
#fly-it { position: relative; }
#fly-it2 { position: relative; }
#fly-it3 { position: relative; }
#fly-it4 { position: relative; } 
```

# java - 创建java程序的用户输入

> ID：15554881
> 
> 赞同：0
> 
> 时间：2013-03-21T17:17:57.283
> 
> 标签：java

我尝试创建代码来解决二次公式，但我只成功地为特定公式创建了它。有什么方法可以通过用户输入提供变量`a`，然后打印出解决方案`b`？`c`该程序也拒绝在命令提示符下运行，但可以在 eclipse 中运行。可能是什么问题？

这里是。

```
public class Equationsolver {

    public static void main(String[] args) {
    double a, b, c;
    a = 2;
    b = 6;
    c = 4;

    double disc = Math.pow(b,2) - 4*a*c;
    double soln1 = (-b + Math.sqrt(disc)) / (2*a) ;
    double soln2 = (-b - Math.sqrt(disc)) / (2*a);
    if (disc >= 0) {
        System.out.println("soln1 = " + soln1);
        System.out.println("soln2 = " + soln2);
    }else{
        System.out.println("equation has no real roots");
    }

    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T17:35:25.630

接受用户输入的一种可能性是使用参数`String [] args`。`String [] args`包含当您像 一样执行程序时传递给程序的值`java -jar program.jar arg1 arg2 arg3`。

在您的情况下，您需要检查用户是否将 3 个参数传递给程序，如果是，则将这些值分配给您的变量。

这里有一些代码可能会有所帮助，请注意我没有添加验证，您需要更多验证以确保清理用户输入：

```
public class Equationsolver {

    public static void main(String[] args) {
    double a, b, c;
    a = Double.parseDouble(args[0]); //Here it will get the first argument pass to the program
    b = Double.parseDouble(args[1]); 
    c = Double.parseDouble(args[2]);

    double disc = Math.pow(b,2) - 4*a*c;
    double soln1 = (-b + Math.sqrt(disc)) / (2*a) ;
    double soln2 = (-b - Math.sqrt(disc)) / (2*a);
    if (disc >= 0) {
        System.out.println("soln1 = " + soln1);
        System.out.println("soln2 = " + soln2);
    }else{
        System.out.println("equation has no real roots");
    }

    }

} 
```

编辑：您可能需要更改代码以适应现在`a` `b`并且`c`可能不是您所想的事实。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T18:17:13.997

您也可以通过以下方式从用户那里获取动态输入

```
Scanner in = new Scanner(System.in);
double a = in.nextDouble();
double b = in.nextDouble();
double c = in.nextDouble(); 
```

# python - 按“日期时间”对列表进行排序

> ID：15554884
> 
> 赞同：1
> 
> 时间：2013-03-21T18:03:16.697
> 
> 标签：python, django

我有以下内容：

```
appleCreated = Apple.objects.filter(fruit=fruit.id).latest().created
bananaCreated = Banana.objects.filter(fruit=fruit.id).latest().created
lemonCreated = Lemon.objects.filter(fruit=fruit.id).latest().created
orangeCreated = Orange.objects.filter(fruit=fruit.id).latest().created 
```

是`.created`一个`models.DateTimeField()`

我需要在四个中找到最新的`datetime`（我不需要知道它是哪一个）。我知道我需要使用`.sort(...)`，或者`sorted(...)`文档太密集了我不明白`key=lambda`，`item:item[0]`和`key=itemgetter(0)`WTF 之类的东西！？！？！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T18:05:46.177

我不确定我是否理解问题，但不应该

```
max(appleCreated, bananaCreated, lemonCreated, orangeCreated) 
```

够了吗？

# sencha-touch-2 - 通过在两个不同的视图中包含按 xtype 的视图来复制 DOM 元素

> ID：15554885
> 
> 赞同：0
> 
> 时间：2013-03-21T18:03:18.063
> 
> 标签：sencha-touch-2, duplicates, xtype

我有一个应用程序可以`xtype`在启动时启动视图以让用户注册。此视图有一些选择字段，并且所有工作都按预期工作。用户还可以选择跳过此视图并稍后访问它。当用户稍后访问此视图时，我遇到了数据未附加到正确元素的问题。正在设置值，但运行`Ext.ComponentQuery.query('[itemId=item_name]')`返回 2 个元素。不知何故，这个视图的元素被重复了。

我也尝试过设置`autoDestroy: true`这个视图的配置，但这没有任何效果。

我还尝试使用事件`destroy()`上的方法手动销毁视图。`deactivate()`当我这样做时，行为变得奇怪，从另一个推送视图中选择一个项目并返回到配置文件屏幕会导致导航视图中断，就好像这个视图不存在一样。导航栏的标题中断并且后退按钮显示不正确。

为什么视图元素被重复？我该如何防止这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T01:58:26.627

经过进一步调查，我发现该视图没有像其他视图那样从 DOM 中自动销毁，因此可以进一步查看。然后我意识到我实际上是在使用`Ext.Viewport.setActiveItem(Ext.create('MyApp.view.Main'));`

添加对事件的`item.destroy()`调用就可以了。`deactivate`虽然，在 , 之后`Ext.Viewport.setActiveItem`也会`Ext.Viewport.remove()`成功！

希望这对某人有帮助！

# iphone - 从 AppDelegate 调用 presentModalViewController 不起作用

> ID：15554886
> 
> 赞同：0
> 
> 时间：2013-03-21T18:03:19.047
> 
> 标签：iphone, ios, cocoa-touch

我正在为我的应用程序（基本 SDK：iOS5）使用 Facebook SDK 3.0，并使用 Scrumptious 应用程序（示例应用程序）作为教程。如果 Facebook 没有打开会话，则会以模态方式呈现登录视图控制器。但它没有以模态方式呈现。这是代码；

```
- (void)showLoginView {
    UIViewController *topViewController = [self.navigationController topViewController]; // not nil, RootViewController kind of class
    UIViewController *modalViewController = [topViewController modalViewController]; // nil since not modalviewcontroller exists

    if (![modalViewController isKindOfClass:[FacebookLoginViewController class]]) {
        FacebookLoginViewController *loginViewController = [[FacebookLoginViewController alloc] initWithNibName:@"FacebookLoginViewController" bundle:nil]; // allocated, no problem
        [topViewController presentModalViewController:loginViewController animated:NO]; // not working????

    } else {
        FacebookLoginViewController* loginViewController = (FacebookLoginViewController*)modalViewController;
        [loginViewController loginFailed];
    }
} 
```

细节;

*   showLoginView 被调用`application:didFinishLaunchingWithOptions:`并在分配了 navigationController 之后被调用
*   `RootViewController`调用前导航控制器的调用`viewDidLoad`方法`showLoginView`
*   in `showLoginView`,`topViewController`不是 nil （应该是`RootViewController`：）
*   navigationController 是一种 UINavigationController 类（不是自定义的）
*   `loginViewController`( `FacebookLoginViewController`) 的`init`方法被调用，但不是它的`viewDidLoad`方法）

日志输出：

2013-03-21 20:01:28.729 RootViewController: viewDidLoad

2013-03-21 20:01:28.735 FacebookLoginViewController：已分配

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T18:51:09.153

尝试强制您的 UI 代码在主线程上运行：

```
dispatch_async(dispatch_get_main_queue(), ^{
    [topViewController presentModalViewController:loginViewController animated:NO];
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:49:10.613

In your topViewController, declare an instance of FacebookLoginViewController. `@property (nonatomic, strong) FacebookLoginViewController *fbVC;` This will give that viewController a reference to the controller you want to present. The reason it's allocating but not presenting, is because your topViewController is currently being asked to present an object it doesn't own. You need to pass it ownership.

Add `topViewController.fbVC = loginViewController;` and change `[topViewController presentModalViewController:loginViewController animated:NO];` to `[topViewController presentViewController:topViewController.fbVC animated:NO completion:nil];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T19:31:31.167

假设您保留对应用程序窗口的引用，您应该调用`[self.window.rootViewController present...]`
另请注意，当另一个 VC 已经以模态方式呈现时它可能不起作用（取决于您的目标 iOS 版本 - 实际上您应该使用`presentViewController:animated:completion:`而不是使用“模态”措辞的方法）

# ajax - 剑道日历：如何在更改事件中向控制器发送日期？（MVC 扩展）

> ID：15554888
> 
> 赞同：0
> 
> 时间：2013-03-21T18:03:33.620
> 
> 标签：ajax, kendo-ui, kendo-asp.net-mvc

我确实做了以下示例，但无法正常工作：

控制器主页：

```
namespace KendoUIMvcApplication1.Controllers
{
     public class HomeController : Controller
     {
          public ActionResult Index(DateTime? date)
          {
             //here i use the date bla bla bla

               return View();
          }

          public ActionResult About()
          {
               return View();
          }
     }
} 
```

我的观点：Index.cshtml

```
<p>
    @Html.Kendo().DatePicker().Name("Calendario").Value(DateTime.Now).Events(e =>e.Change("change"))
</p>

<script type="text/javascript">
    function change() {
        var dado = this.value();
        $.ajax({
            type: "POST",
            url: "/Home/Index", //url
            traditional: false,
            async: false,
            beforeSend: function () {
            },
            data: dado,
            success: function (response) {
            },
            error: function (e) {
                alert("erro");
            }
        });
    }
</script> 
```

为什么当我更改日历上的日期时，控制器上的参数为空？函数 $Ajax 工作正常；var dado 有个约会。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T18:23:39.907

尝试将值作为键/值对对象发送。例如

```
data: {date:dado}, 
```

此外，您可能需要将日期格式化为便于 ModelBIinder 格式

例如

```
data:{date:kendo.format("{0:dd/MM/yyyy hh:mm:ss tt}",dado)} 
```

# objective-c - performSelectorInBackground 出现在 > 1 个线程中

> ID：15554893
> 
> 赞同：0
> 
> 时间：2013-03-21T18:04:00.123
> 
> 标签：objective-c, multithreading, sockets

当我尝试调度单个线程来轮询 unix 套接字时，我注意到一些奇怪的行为。当我在 osx 10.6.8 上测试代码时，代码崩溃，我看到超过 1 个线程在运行代码。奇怪的是，在 osx 10.7.5 上，当它崩溃时，我只看到它在一个线程上运行。

在我的 AppDelegate 中，我像这样（一次）调度线程：

```
[pp performSelectorInBackground:@selector(runloop) withObject:nil]; 
```

pp 是 My IPC 类的一个实例。

在我的 IPC 类中，runloop 是一些 C 代码的包装器

```
@implementation IPC
-(void) runloop
{
  ipc_busy = 0;
  unixsocket_runloop();
} 
```

runloop 旨在等待单个连接（每个运行时）然后处理程序等待数据包，直到程序终止。C 代码如下所示 -

```
/**
 * Waits for a connection and dispatches the socket handler
 * No need to fork since we will only ever have a single connection per program launch
 */
int unixsocket_runloop()
{
  int connection_fd;
  socklen_t address_length;
  while((connection_fd = accept(socket_fd,
                                (struct sockaddr *) &address,
                                &address_length)) > -1)
  {
    return unixsocket_handler(connection_fd);
  }
  return 0; // for posterity
} 
```

这是连接处理程序 -

```
/**
 * Handles the connection from the client
 * loops infinitely and reads from the socket when there is a message
 * Stores message into a ring buffer of buffers
 */
int unixsocket_handler(int connection_fd)
{
  size_t nbytes;
  char readbuffer[USBUFSIZE];
  bzero(readbuffer,USBUFSIZE);
  while((nbytes = read(connection_fd, readbuffer, USBUFSIZE)))
  {
    // store in buffer
    bufPut(readbuffer,nbytes);
    bzero(readbuffer,USBUFSIZE);
  }
  close(connection_fd);
  return 0;
} 
```

在我的堆栈跟踪中，我看到这个 unixsocket_runloop 发生在 2 个线程中。虽然我不认为这是崩溃的根本原因，但这是我想解决的意外行为。

我使用自己的套接字类滚动的唯一原因是我在开源社区中看到的很多选项都硬连接到 TCP。尤其是吸引人的 cocoaAsyncSocket 类。

# jquery - 从表单中获取参数

> ID：15554897
> 
> 赞同：-1
> 
> 时间：2013-03-21T18:04:11.357
> 
> 标签：jquery, html, cordova

在 phonegap 中，我使用了一个 jquery 移动框架。我想通过使用页面 url 将表单数据传递到下一页，这是一个 div。我尝试使用 GetElementByID 来检索参数。它向我展示了“[object HTMLDivElement]”。我不是我想要的结果。我该如何解决？

下面是转换到下一页的功能 DIV 是我的phonegap的代码：

```
<script type="text/javascript">
$('#home').live('pagecreate',function(event) { 
    $("#form").submit( function (e) {
            e.preventDefault();
            var x=document.getElementById("search");
            $.mobile.changePage("#page1?param1="+x);
    });
});
</script> 
```

和表单html：

```
<form id="form" method="POST" action="page1" data-ajax="false">
                <div data-role="fieldcontain" id="search">
                    <fieldset data-role="controlgroup">
                        <label for="search">
                            Search
                        </label>
                        <input name="search" id="search" placeholder="" value="" type="search" />
                    </fieldset>
                </div>
                <div data-role="fieldcontain" id="searchmethod">
                    <label for="searchmethod">
                    </label>
                    <select id="searchmethod" name="searchmethod" data-theme="e">
                        <option value="keyword">
                            Keyword
                        </option>
                    </select>
                </div>
                <div data-role="fieldcontain" id="searchlocation">
                    <label for="searchlocation">
                    </label>
                    <select name="searchlocation" data-theme="e">
                        <option value="Entire Collection">
                            Entire Collection
                        </option>
                    </select>
                </div>
                <input type="submit" value="Submit" />
            </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:11:07.937

编辑：刚刚注意到您有两个带有 id 的元素`search`。你应该改变这个。这不仅会使阅读您的代码的任何人感到困惑，而且还会导致您在此处遇到的问题。`getElementById`返回具有指定 ID 的**第一个**元素。在您的情况下，这是一个 div，而不是输入。

如果你真的想坚持你所拥有的，你可以这样做：

```
var x = $('input#search').val(); //Suggesting jQuery since you're already using it. 
```

编辑：根据您的评论，这是如何做到的。jQuery 的`val()`函数对`select`s 和 checkbox 的支持非常好。您所要做的就是调用`val()`select 元素本身，它会返回当前选定的值。所以，这样做：

```
$("[name='searchmethod']").val();
$("[name='searchlocation']").val(); 
```

不过，我真的建议使用 ID 而不是名称。我这样做是因为和以前一样，您有多个具有相同 ID 的元素。在 99% 的情况下，这是一个禁忌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:12:11.117

您有多个 id 为“search”的 HTML 元素，这很糟糕。ID 应该是唯一的。当您调用纯 javascript 函数`getElementById`时，它会返回第一个匹配项，即`<div data-role="fieldcontain" id="search">`.

您应该更改 DIV 或 INPUT 的 ID。然后你可以使用 joeframbach 的建议：

```
var x=document.getElementById("searchInput").value; 
```

或者您可以使用 jQuery 选择元素并获取其值：

```
var x=$("input#search").val(); 
```

要获取问题中 HTML 结构的搜索方法和搜索位置：

```
var method=$("select#searchmethod").val();

var location=$("select[name='searchlocation']").val(); // locate element by name since ID is not set 
```

# matlab - for循环中所有子图的链接轴

> ID：15554899
> 
> 赞同：0
> 
> 时间：2013-03-21T18:04:14.070
> 
> 标签：matlab, for-loop, axes

我很难让 (3,4,i) 图中的所有子图都具有完全相同的轴，都从零开始。我到目前为止的代码如下，但它返回所有具有不同 x 和 y 比例的子图。

有人可以帮忙吗？

```
%% plot 
for i = 1:num_bins;
    h = zeros(ceil(num_bins),1);
    h(i)=subplot(4,3,i); 
    plotmatrix(current_rpm,current_torque)
end
linkaxes(h,'xy');
axis([0 30 0 8]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:39:28.327

您应该将内存分配移到循环之外：

```
%% plot 
h = zeros(ceil(num_bins),1);
for i = 1:num_bins;
    h(i)=subplot(4,3,i); 
    plotmatrix(current_rpm,current_torque)
end
linkaxes(h,'xy');
axis([0 30 0 8]); 
```

# gradle - 任务输入与任务源

> ID：15554900
> 
> 赞同：12
> 
> 时间：2013-03-21T18:04:14.693
> 
> 标签：gradle

每个 Gradle 任务都具有表示任务输入文件集合的`inputs`类型属性。`TaskInputs`这主要用于识别任务是最新的。但是，一些输入文件也被标记为*源*文件——这是什么意思？换句话说，任务输入文件和任务源文件有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-17T16:48:18.297

来自[TaskInput.getSourceFiles()](http://www.gradle.org/docs/current/javadoc/index.html?org/gradle/api/tasks/TaskInputs.html)的文档：

> 返回此任务的源文件集。这些是任务实际处理的输入文件的子集。如果任务已声明它接受源文件，并且此集合为空，则该任务将被跳过。

所以看起来源文件是输入文件的一个子集。据推测，任务定义了执行的“工作”。

# javascript - 在 Javascript 中创建太多音频对象时浏览器崩溃

> ID：15554906
> 
> 赞同：4
> 
> 时间：2013-03-21T18:04:40.273
> 
> 标签：javascript, html, object, audio, crash

您好，我的 Web 应用程序有问题。我想在敲击鼓图像时播放声音，所以我在我的 javascript 中创建了一个新的音频对象。我的 html 和 onmousedown 事件中有一个图像，我调用 playSound 函数：

```
function playSound(soundfile) {
mysound = new Audio(soundfile);
mysound.play();} 
```

在我点击图像太多次后，我的 Chrome 浏览器崩溃了。我试图删除我的声音对象，但崩溃仍然存在。我在firefox上测试过，没有崩溃。

谁能理解这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:08:01.110

好像是 Chrome 本身的问题。[创建 HTML5 音频元素会使 Chrome 崩溃](https://code.google.com/p/chromium/issues/detail?id=71322)，这指向当前未解决的问题：[减少 HTML5 音频/视频元素使用的线程数](https://code.google.com/p/chromium/issues/detail?id=61293)

# javascript - 在 getDay 方法之后更改文本

> ID：15554907
> 
> 赞同：0
> 
> 时间：2013-03-21T18:04:48.987
> 
> 标签：javascript, html, mysql, css

我正在制作一个应用程序（使用 HTML、CSS 和 Javascript），它允许用户查看他们所在地区酒吧的每日特价。

我的问题：我应该如何使用该`getDay()`方法更改特价商品？

我的问题：我需要能够随时更新每个酒吧的特色菜。因此，应用程序必须从我的服务器检索信息（因此我不必为每个特殊更改更新应用程序）。

我的想法：为每个酒吧制作一个 MySQL 表并在特价更改时编辑表是否最容易？还是有其他方法可以做到这一点？

示例：应用程序的主页是“今日特价”。我将使用`getDay()`方法来确定它是星期几。我在想，在我得到这一天（如果是星期五）之后，我可以从“角落栏”表的“星期五”行中拉出，并用该行中的项目填充角落栏文本框。

当我需要在“角落酒吧”更改“星期五”特价时，我只需编辑表格中的星期五行。这会是完成我需要的最佳方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:12:30.883

有两张桌子不是更容易吗？一个是酒吧目录（barID、barname、someinfo），另一个是特价表（ID、barID、dayOfWeek、Specials），您可以通过简单的连接简单地查询一周中的任何一天。

# d3.js - D3.js 鼠标悬停无法触发重叠对象

> ID：15554908
> 
> 赞同：5
> 
> 时间：2013-03-21T18:04:51.920
> 
> 标签：d3.js

在 D3.js 中，似乎在其他对象之前绘制的对象然后使它们变得模糊对鼠标悬停侦听器变得不可见。有解决方法吗？

请参阅此[工作示例](http://d3.geotheory.co.uk/mouseOver.html)。

```
<!DOCTYPE html>
<meta charset="utf-8">
<head>
    <script type="text/javascript" src="scripts/d3.v3.js"></script>
</head>
<body>
    <div id="viz"></div>
    <script type="text/javascript">

    d3.select("body").style("background-color", "black");

    var sampleSVG = d3.select("#viz")
        .append("svg")
        .attr("width", 400)
        .attr("height", 200);

    sampleSVG.append("circle")
        .style("fill", "grey")
        .style("stroke-width", 2)
        .attr("r", 60)
        .attr("cx", 150)
        .attr("cy", 100)
        .on("mouseover", function(){d3.select(this).style("fill", "red");})
        .on("mouseout", function(){d3.select(this).style("fill", "grey");});

    sampleSVG.append("circle")
        .style("stroke", "yellow")
        .style("opacity", 0.5)
        .style("stroke-width", 2)
        .attr("r", 100)
        .attr("cx", 250)
        .attr("cy", 100)

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T19:01:37.533

解决方案是添加“.style("pointer-events", "none");" 最后一个圆圈：

```
sampleSVG.append("circle")
    .style("stroke", "yellow")
    .style("opacity", 0.5)
    .style("stroke-width", 2)
    .attr("r", 100)
    .attr("cx", 250)
    .attr("cy", 100)
    .style("pointer-events", "none"); 
```

这是一个工作示例[http://tributary.io/inlet/5215694](http://tributary.io/inlet/5215694)

注意：如果较大的圆圈将其填充属性设置为“无”，则该示例也可以按预期工作，而无需将“指针事件”设置为无。

# android - 如何预填充 Green DAO sqlite 数据库

> ID：15554910
> 
> 赞同：5
> 
> 时间：2013-03-21T18:05:21.883
> 
> 标签：android, database, sqlite, populate, greendao

我即将使用 Green DAO ORM 工具。我将不得不在我的数据库中插入大约六百行数据。我想知道有一种方法可以使用某种形式的 sqlite 数据库管理工具或脚本来预填充数据库。我不想手动添加这些实体中的每一个等等。在安卓代码中。这将太乏味和耗时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T18:15:50.503

将您的数据放入 CSV/JSON 文件中。然后在 DBHelper 的 onCreate 方法上，读取文件并将它们插入到数据库中。

# javascript - 角度指令忽略非数字输入

> ID：15554915
> 
> 赞同：21
> 
> 时间：2013-03-21T18:05:29.307
> 
> 标签：javascript, angularjs, angularjs-directive

我必须为 IE8 编写一些代码。我有一个 ng-repeat 创建一个表格，里面有：

```
<input production-qty type="text" class="input-mini" maxlength="3" ng-model="day.qtyA" ui-event="{ blur : 'updateProduction(day)' }" ng-disabled="day.type=='H'"> 
```

IE8 不会做 type=number

我想要一个指令，该指令将忽略该输入字段上不是数字键的击键......即...... 0 - 9

我不想让用户输入 abc 并污染模型，然后告诉他们该值无效。我宁愿不让他们输入任何一开始就无效的数据。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-21T19:18:35.620

HTML：

```
<input production-qty type="text" maxlength="3" ng-model="qty1"> 
```

指示：

```
app.directive('productionQty', function() {
  return {
    require: 'ngModel',
    link: function (scope, element, attr, ngModelCtrl) {
      function fromUser(text) {
        var transformedInput = text.replace(/[^0-9]/g, '');
        console.log(transformedInput);
        if(transformedInput !== text) {
            ngModelCtrl.$setViewValue(transformedInput);
            ngModelCtrl.$render();
        }
        return transformedInput;  // or return Number(transformedInput)
      }
      ngModelCtrl.$parsers.push(fromUser);
    }
  }; 
}); 
```

[普朗克](http://plnkr.co/edit/cXew2Ln3rOuSon23Mmuk?p=preview)

另请参阅[input 中 ng-model 上的过滤器](https://stackoverflow.com/questions/14419651/angularjs-filters-on-ng-model-in-an-input)。我上面的答案是以 pkozlowski.opensource 的答案为模型的。

我查看了 ng-pattern，但它没有过滤文本框中显示的内容。它设置`$scope.qty1`为`undefined`，但不需要的字符在文本框中可见。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-23T14:26:34.470

HTML：

```
<input type="number" name="graduationYear" ng-model="gradYear" only-num> 
```

指示：

```
directive('onlyNum', function() {
    return function(scope, element, attrs) {

        var keyCode = [8, 9, 37, 39, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 110];
        element.bind("keydown", function(event) {
            //console.log($.inArray(event.which,keyCode));
            if ($.inArray(event.which, keyCode) === -1) {
                scope.$apply(function() {
                    scope.$eval(attrs.onlyNum);
                    event.preventDefault();
                });
                event.preventDefault();
            }

        });
    };
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-04T06:41:18.457

首先将此代码包含在js文件中 `[numericInput.js](https://github.com/joshuadeleon/NumericInput/blob/master/numericInput.js)`

**指令：-**

```
.directive('numeric', function() {
    return function(scope, element, attrs) {

        $(element[0]).numericInput({ allowFloat: true });

    };
}) 
```

**HTML : -**

```
 <input type="text" numeric /> 
```

**演示** `[Numeric Demo](http://jsfiddle.net/Nishchit14/46f4w/3/)`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-08-20T10:42:58.817

不是指令，但我只使用：

控制器：

```
 $scope.blockNonNumber = function (val, field){

       $scope[field] = val.toString().replace(/[^0-9]/g, '');

    } 
```

html:

```
<input type="text" ng-model="price" ng-change="blockNonNumber(price, 'price')" pattern="[0-99]"> 
```

它不是指令，但可以在指令中使用

# c# - 使用 LINQ，是否可以从 Select 语句中输出动态对象？如果是这样，怎么做？

> ID：15554917
> 
> 赞同：23
> 
> 时间：2013-03-21T18:05:30.633
> 
> 标签：c#, .net, dynamic, duck-typing, expandoobject

目前在 LINQ 中，以下编译和工作正常：

```
var listOfFoo = myData.Select(x => new FooModel{
     someProperty = x.prop1,
     someOtherProperty = x.prop2
});

public class FooModel{
     public string someProperty  { get; set; };
     public string someOtherProperty  { get; set; };
} 
```

但是，过去几个版本的 .NET/C# 扩展了动态对象的作用，例如，`ExpandoObject`我想知道是否有办法基本上做到这一点：

```
var listOfFoo = myData.Select(x => new ExpandoObject{
     someProperty = x.prop1,
     someOtherProperty = x.prop2
}); 
```

显然，我已经尝试过上面的代码但没有成功，但似乎我遗漏了一些东西。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-03-21T18:07:05.837

您应该能够在没有声明任何类型的情况下创建一个新的匿名对象：

```
var listOfFoo = myData.Select(x => new {
    someProperty = x.prop1,
    someOtherProperty = x.prop2
}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-21T18:16:21.253

没有什么可以阻止您使用`Select`来返回 ExpandoObject 的集合，您只是没有正确构建`ExpandoObject`. 这是一种方法：

```
var listOfFoo = myData.Select(x =>
    {
        dynamic expando = new ExpandoObject();
        expando.someProperty = x.prop1;
        expando.someOtherProperty = x.prop2;
        return (ExpandoObject)expando;
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-14T13:33:32.323

```
using (var command = this._context.Database.GetDbConnection().CreateCommand())
        {
            command.CommandText = "select * from persons";
            command.CommandType = CommandType.Text;
            this._context.Database.OpenConnection();
            using (var result = command.ExecuteReader())
            {
                var lst = new List<object>();
                var lstColumns = new UserAccount().GetType().GetProperties(BindingFlags.DeclaredOnly | BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic).ToList();
                while (result.Read())
                {
                    var newObject = new object();
                    dynamic myobject = new ExpandoObject();
                    IDictionary<string, object> myUnderlyingObject = myobject;
                    for (var i = 0; i < result.FieldCount; i++)
                    {
                        var name = result.GetName(i);
                        var val = result.IsDBNull(i) ? null : result[i];
                        myUnderlyingObject.Add(name, val);
                    }
                    lst.Add(myUnderlyingObject);
                }
                return Ok(lst);
            }
        } 
```

# algorithm - 如何缩放由点组成的形状？

> ID：15554918
> 
> 赞同：4
> 
> 时间：2013-03-21T18:05:36.427
> 
> 标签：algorithm, 2d, scale

假设我有这样的形状：

![较大的形状](../Images/681035d71bd4e6576282aa8623650823.png)

我想把它缩小到这个：

![较小的形状](../Images/c7b9b9fbb9479b09d5bb3740793ee1c5.png)

我如何计算点（红色圆圈）的位置？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T18:08:20.287

```
new.x = scale * (old.x - center.x) + center.x
new.y = scale * (old.y - center.y) + center.y 
```

对每个点重复。

# asp.net-mvc - 如何在 Durandal.js、mvc3 中使用部分视图

> ID：15554919
> 
> 赞同：4
> 
> 时间：2013-03-21T18:05:37.427
> 
> 标签：asp.net-mvc, durandal

我注意到 App/views 文件夹中的所有视图都是 html 类型，而不是 cshtml。我如何使用我习惯的 PartialViews 和 mvc3 的东西，例如剃须刀？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T22:33:35.237

Durandal 旨在创建一个完全位于一个页面内的应用程序。这样做的好处是用户体验就像桌面应用程序一样。此外，这允许应用程序轻松地移植到[phonegap](http://phonegap.com/)中，它可以作为本地移动应用程序运行，甚至可以使用[appjs](http://appjs.org/)移植到桌面应用程序。

通过将整个应用程序作为 html、js 和 css 文件，您可以将整个应用程序[压缩/缩小/丑化](http://durandaljs.com/documentation/Optimizing-On-Dot-Net/)到一个文件中，并让服务器为您提供整个应用程序。然后应用程序只需调用 Web 服务来获取其数据。这可能是一个 mvc 控制器、一个 web api 或一些返回数据的 web 服务。您使用此数据绑定到浏览器模板并生成要显示的视图。

您还可以拥有一个混合应用程序，您的服务器可以为多个 durandal SPA 提供服务，然后您将拥有一组由单个站点提供服务的应用程序。

我看到许多来自 MVC 背景的人很好地询问为什么我不能将 CSHTML 文件用于我的 HTML。简短的回答是你可以，但这样做会失去很多好处。当您让服务器呈现您的 html 文件时，您将无法再压缩/缩小/丑化整个应用程序，因为您依赖服务器为您生成 html。

如果您更喜欢 cshtml，那么传统上这是针对 AJAX 丰富的应用程序，您的用户在其中调用一些 uri，服务器根据一些数据生成 HTML，将呈现的 html 发送回用户，并将其粘贴在屏幕的某个位置. 通过这个过程，您拥有的是一个 AJAX 丰富的站点，而不是一个 SPA。您失去了使该应用程序成为本机移动应用程序甚至桌面应用程序的能力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-17T05:48:15.510

如果您有兴趣将**Razor/CSHTML 与 Durandal 和 Knockout 一起使用，**则有一个开源选项：**FluentKnockoutHelpers**。它提供了 ASP.NET MVC 的许多“好用的、有帮助的”部分，允许您使用 Durandal 和 Knockout 的强大功能而几乎没有失败。

**为了快速解决 Evan Larsen**关于缩小（等）的出色观点：由于 FluentKnockoutHelpers 在运行时不运行任何逻辑，而只是生成标记，因此使用流行的 RazorEngine 项目为您的生产构建生成静态 HTML 文件非常简单，它可以让你运行 Razor 并从 C# 生成 HTML。这可以在 Durandal 所需的生产构建步骤之前运行（这为您提供了缩小等）

*   [资源](https://github.com/johnculviner/FluentKnockoutHelpers)

*   [使用 Durandal.js 的现场演示](http://durandaldemo.apphb.com/)

简而言之，它提供了一系列特性，使得进行 Durandal/Knockout 开发就像 ASP.NET MVC 一样简单。（您只需为大多数功能提供您的 JavaScript 模型所基于的 C# 类型。）您只需为复杂的情况编写 JavaScript 和未编译的标记，这是不可避免的，与 MVC 没有什么不同！（除了在 MVC 中，您的代码也很可能最终也会成为一个大的 jQuery 混乱，这就是您首先使用 Durandal/Knockout 的原因！）

**特征：**

*   使用类似于 ASP.NET MVC 的强类型、流畅的 lambda 表达式助手轻松生成 Knockout 语法
*   丰富的智能感知和编译器支持语法生成
*   流利的语法使创建自定义助手或扩展内置内容变得轻而易举
*   OSS 替代 ASP.NET MVC 助手：随意添加社区中每个人都可以使用的可选功能
*   只需几行代码，即可针对所有当前/未来的应用程序类型和更改轻松地提供基于 .NET 类型和 DataAnnotations 的验证
*   客户端 JavaScript 对象工厂（基于 C# 类型）在例如列表中创建新项目，零麻烦或服务器流量

**没有 FluentKnockoutHelpers 的示例**

```
<div class="control-group">
    <label for="FirstName" class="control-label">
        First Name
    </label>
    <div class="controls">
        <input type="text" data-bind="value: person.FirstName" id="FirstName" />
    </div>
</div>
<div class="control-group">
    <label for="LastName" class="control-label">
        Last Name
    </label>
    <div class="controls">
        <input type="text" data-bind="value: person.LastName" id="LastName" />
    </div>
</div>
<h2>
    Hello,
    <!-- ko text: person.FirstName --><!-- /ko -->
    <!-- ko text: person.LastName --><!-- /ko -->
</h2> 
```

**为 FluentKnockoutHelpers 提供 .NET 类型，您可以使用 Intellisense 和 Razor / CSHTML 中的编译器以风格方式执行此操作**

```
@{
  var person = this.KnockoutHelperForType<Person>("person", true);
}

<div class="control-group">
    @person.LabelFor(x => x.FirstName).Class("control-label")
    <div class="controls">
        @person.BoundTextBoxFor(x => x.FirstName)
    </div>
</div>
<div class="control-group">
    @person.LabelFor(x => x.LastName).Class("control-label")
    <div class="controls">
        @person.BoundTextBoxFor(x => x.LastName)
    </div>
</div>
<h2>
    Hello,
    @person.BoundTextFor(x => x.FirstName)
    @person.BoundTextFor(x => x.LastName)
</h2> 
```

查看**[Source](https://github.com/johnculviner/FluentKnockoutHelpers)**或**[Live Demo](http://durandaldemo.apphb.com/)**以详细了解 FluentKnockoutHelper 在不平凡的 Durandal.js 应用程序中的功能。

为了快速解决 Evan Larsen 关于缩小（等）的出色观点：由于 FluentKnockoutHelpers 在运行时不运行任何逻辑，而只是生成标记，因此使用流行的[RazorEngine 项目](https://github.com/Antaris/RazorEngine)为您的生产构建生成静态 HTML 文件非常简单，它可以让你运行 Razor 并从 C# 生成 HTML。这可以在 Durandal 所需的生产构建步骤之前运行（这为您提供了缩小等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T05:29:05.797

您的 SPA 将受 MVC 呈现页面的限制。

```
<div id="applicationHost">
    @Html.Partial("_splash")
</div> 
```

*   MVC 页面可以提供菜单、侧边栏等。当然可以通过连接到客户端 SPA 中提供的 Pub/Sub 模型来监听 Durandal 事件。

*   利用 MVC 控制器并将不同的母版页、捆绑包交付给不同的 SPA。每个 CSHTML 页面可以调用不同的 main.js（main-viewport、main-uipanel.js 等）文件。

如果需要，有很多方法可以混合这两种技术。

# matlab - 如何使用 Matlabs 隐马尔可夫模型进行预测？（统计工具箱）

> ID：15554923
> 
> 赞同：1
> 
> 时间：2013-03-21T18:05:46.273
> 
> 标签：matlab, prediction, hidden-markov-models

我已经使用统计包中的[hmmtrain 函数在 matlab 中训练了一个 HMM。](http://www.mathworks.de/de/help/stats/hmmtrain.html)

使用[hmmdecode](http://www.mathworks.de/de/help/stats/hmmdecode.html)和我在 t_0 和 t_1 之间给定的证据，我可以进行过滤和平滑来计算 t_0 和 t_1 之间可能状态的后验分布。

现在，考虑到迄今为止的所有证据，我想计算晚于 t_1 的未来状态的后验分布。在理论上，这意味着我必须在马尔可夫链上应用前向算法。

你知道我可以使用哪个 matlab 函数来做到这一点吗？我想统计包中内置了一些东西，我只是找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:40:08.387

事实证明，对于 HMM，matlab 统计数据包有点稀缺。[Kevin Murphy 的工具箱](http://www.cs.ubc.ca/~murphyk/Software/HMM/hmm.html)似乎提供了更多功能和许多便利功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:39:10.920

要获得 t_2 处隐藏状态的概率，只需将 t_1 上的后验乘以转换矩阵。

# php - 如何将带有属性的 XML 文件转换为数组

> ID：15554924
> 
> 赞同：2
> 
> 时间：2013-03-21T18:06:00.993
> 
> 标签：php, xml, arrays

我尝试将简单的 xml 文件转换为数组，但转换不会将“id”属性保留为键数组。XML 源：

```
<mapi>
    <categoriesList>
        <category id="310">Autres</category>
        <category id="574">Bière</category>
        <category id="495">Biscuits</category>
        <category id="444">Bonbons</category>
        <category id="435">Champagne</category>
        <category id="371">Cidre</category>
        <category id="215">Condiments</category>
        <category id="8">Fruits</category>
        <category id="445">Poissons</category>
        <category id="578">Produits laitiers</category>
        <category id="539">Spiritueux</category>
        <category id="259">Viandes</category>
        <category id="126">Vin</category>
    </categoriesList>
</mapi> 
```

我喜欢这样一个简单的数组：

```
array (
    [310] => Autres
    [574] => Bière
    [495] => Biscuits
    [444] => Bonbons 
    [435] => Champagne
    [371] => Cidre
    [215] => Condiments
    [8] => Fruits 
    [445] => Poissons
    [578] => Produits laitiers
    [539] => Spiritueux
    [259] => Viandes
    [126] => Vin
) 
```

谢谢你的帮助迪米特里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:18:56.533

像这样的东西应该工作：

```
function XMLtoArray($xml) {
    $xmlArray = array();
    $dom = new DOMDocument;
    $dom->load($xml);
    $categories = $dom->getElementsByTagName("category");
    foreach($categories as $category) {
        $id = $category->getAttribute("id");
        $xmlArray[$id] = $category->nodeValue;
    }
    return($xmlArray);
} 
```

然后像这样调用函数：

```
$myArray = XMLtoArray("path/to/file.xml"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:36:52.707

```
<?php
    include ("htmlparser.php");
    $string = '
<mapi>
    <categoriesList>
        <category id="310">Autres</category>
        <category id="574">Bière</category>
        <category id="495">Biscuits</category>
        <category id="444">Bonbons</category>
        <category id="435">Champagne</category>
        <category id="371">Cidre</category>
        <category id="215">Condiments</category>
        <category id="8">Fruits</category>
        <category id="445">Poissons</category>
        <category id="578">Produits laitiers</category>
        <category id="539">Spiritueux</category>
        <category id="259">Viandes</category>
        <category id="126">Vin</category>
    </categoriesList>
</mapi>
';
 $html = str_get_html($string);
  foreach($html->find('category') as $element){
    $array[] = $element -> innertext ;
  }

  echo '<pre>';
  print_r($array);
?> 
```

你需要下载这个库：[http ://simplehtmldom.sourceforge.net/manual.htm#section_dump](http://simplehtmldom.sourceforge.net/manual.htm#section_dump)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T17:05:09.833

这是一个非常简单的任务[`SimpleXMLElement`](http://php.net/manual/en/class.simplexmlelement.php)：

```
$sxe = simplexml_load_string($xml);
$asarray = array();
foreach ($sxe->categoriesList->category as $c) {
    $asarray[(int) $c['id']] = (string) $c;
}

var_export($asarray); 
```

# sed - 为什么 sed 找不到带有此正则表达式的主机名？

> ID：15554930
> 
> 赞同：1
> 
> 时间：2013-03-21T18:06:30.517
> 
> 标签：sed

该文件包含如下行：

```
1363650803.076     48 192.168.20.58 TCP_MISS/417 1963 POST http://collector-4.newrelic.com/agent_listener/invoke_raw_method? - NONE/- text/html
1363650863.426      0 192.168.20.58 TCP_MISS/417 1963 POST http://collector-4.newrelic.com/agent_listener/invoke_raw_method? - NONE/- text/html
1363650898.698  63995 192.168.20.61 TCP_MISS/000 0 GET http://65.55.122.235/2.0/blugro5relay.groove.microsoft.com/p9xyqk93z98qti59r7taftbcxe3s6rt52n4drjs,ConnType=LongLived,ContentLength=2147479552 - DIRECT/65.55.122.235 -
1363650898.698  63995 192.168.20.61 TCP_MISS/000 0 POST http://65.55.122.235/2.0/blugro5relay.groove.microsoft.com/p9xyqk93z98qti59r7taftbcxe3s6rt52n4drjs,ConnType=LongLived - DIRECT/65.55.122.235 -
1363650899.199  63991 192.168.20.61 TCP_MISS/000 0 GET http://65.55.122.235/2.0/blugro5relay.groove.microsoft.com/xatanmtq99upj97qtps89zqnx99wqsyeuc5yefa,ConnType=KeepAlive - DIRECT/65.55.122.235 -
1363650899.199  63991 192.168.20.61 TCP_MISS/000 0 POST http://65.55.122.235/2.0/blugro5relay.groove.microsoft.com/xatanmtq99upj97qtps89zqnx99wqsyeuc5yefa,ConnType=KeepAlive - DIRECT/65.55.122.235 - 
```

我想从每一行中获取主机名/IP 地址。

这个 sed 命令有什么问题？

```
sed -rn "s@//([^/]+)/@\1@" access.log 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:13:13.443

首先，`-n`避免打印每一行。去掉它。

其次，匹配整行并将其全部替换为分组的内容。

第三，在前面添加`http:`一个`//`更准确的匹配。

就像：

```
sed -r "s@^.*http://([^/]+).*@\1@" infile 
```

这会产生：

```
collector-4.newrelic.com
collector-4.newrelic.com
65.55.122.235
65.55.122.235
65.55.122.235
65.55.122.235 
```

# facebook-graph-api - 通过应用程序将 Facebook 用户添加/删除到 Facebook 群组

> ID：15554931
> 
> 赞同：2
> 
> 时间：2013-03-21T18:06:32.340
> 
> 标签：facebook-graph-api, facebook-apps

我正在尝试从 Facebook 添加/删除 Facebook 用户。我读过几篇文章说这是不可能的，但 facebook api 文档似乎认为是这样。

[https://developers.facebook.com/docs/reference/api/app-game-groups/#invite_user](https://developers.facebook.com/docs/reference/api/app-game-groups/#invite_user)

我曾尝试将它与 PHP SDK 结合使用，但我没有运气。这是我的代码：

```
 require 'facebook.php';

$facebook = new Facebook(array(
  'appId'  => 'APP_ID',
  'secret' => 'APP_SECRET'
));

$userID = $facebook->getUser();

if ($userID) {
    $logoutUrl = $facebook->getLogoutUrl();
    $token_url =    "https://graph.facebook.com/oauth/access_token?" .
            "client_id=APP_ID" .
            "&client_secret=APP_SECRET" .
            "&grant_type=client_credentials";
    $app_token = file_get_contents($token_url);
    $app_tokenArray = explode("=", $app_token);
    $app_tokenF = $app_tokenArray[1];
    $facebook->setAccessToken($app_tokenF);
    ECHO "$app_token<br />";
    try {
      // Proceed knowing you have a logged in user who's authenticated.
      $user_profile = $facebook->api('/GROUP_ID/members/'.$userID,'DELETE');
    } catch (FacebookApiException $e) {
      error_log($e);
      ECHO $e;
      $userID = null;
    }
    ECHO $user_profile;
  }
else {
    $loginUrl = $facebook->getLoginUrl();
    $loginUrl .= "&scope=user_groups,friends_groups,create_event";
    ECHO "<a onclick=\"window.open('$loginUrl', '', 'width=900px, height=600px, top=20px, left=30px')\">Install App</a>";
} 
```

该应用程序似乎可以正常安装，但是当我返回它以执行成员删除时，我收到此错误：

OAuthException: (#3)

我已经尝试了几件事，我正在寻找任何见解。非常感谢您的反馈。

# bash - 如何确保在 bash 中进行一致的换行处理

> ID：15554935
> 
> 赞同：2
> 
> 时间：2013-03-21T18:06:35.570
> 
> 标签：bash

我有一个简单的脚本，它使用 curl 获取一些纯文本文件，并将其分配给变量；稍后它会回显它并将其 grep 用于某些行，将它们放入一个临时文件中（我实际上想将它们放入一个数组中）；然后遍历它们并做一些事情。我在 Mac OS X 上的一台机器上运行它，它大部分都可以工作。但是，随机会发生以下任一情况：

*   curl 输出被视为单行，因此在 echo/grep 阶段，事情会中断；
*   整个 tmp 文件在执行 echo 和 for 循环时被视为单行（我似乎已经使用“读取行”缓解了这种情况），所以它再次中断。

有没有办法确保换行符得到一致的处理，一劳永逸？我什至不在乎只要它始终相同，如果需要，我也可以从单行 curl 输出中提取结果。

更新：来自不同的地方。登录机器，做了一些事情，发现脚本不起作用。运行一些命令（结果，删节，下面）进行测试，注销，重新登录，行为改变（回到预期的）。注意 for 循环输出之间的区别...... curl 输出对我来说也是如此，其中完全相同的命令（据我所知）完全相同的 env 以不同的方式处理换行符。我想做的是在每个脚本的开头运行一些命令，使其 100% 确保行为永远不会改变。

```
[root@ip-xxx-xxx-xxx-xxx ~]# cat example.txt 
ip-xxx-xxx-xxx-xxx.ec2.internal
ip-xxx-xxx-xxx-xxx.ec2.internal
[root@ip-xxx-xxx-xxx-xxx ~]# for f in `cat example.txt`; do echo "line $f"; done
line ip-xxx-xxx-xxx-xxx.ec2.internal
ip-xxx-xxx-xxx-xxx.ec2.internal
[root@ip-xxx-xxx-xxx-xxx ~]# while read f; do echo "line $f"; done < "example.txt"
line ip-xxx-xxx-xxx-xxx.ec2.internal
line ip-xxx-xxx-xxx-xxx.ec2.internal
[root@ip-xxx-xxx-xxx-xxx ~]# logout
Connection to ec2-xxx-xxx-xxx-xxx.compute-1.amazonaws.com closed.
reznor-mbp:trunk2 sergey$ ssh -i ... "root@..."
Last login: ...
[root@ip-xxx-xxx-xxx-xxx ~]# for f in `cat example.txt`; do echo "line $f"; done
line ip-xxx-xxx-xxx-xxx.ec2.internal
line ip-xxx-xxx-xxx-xxx.ec2.internal 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T01:44:14.887

第一：不要用 for 读行；`while read`循环读取它们：

```
while read -r; do
  echo "line $REPLY"
done <example.txt 
```

问题`for f in $(cat example.txt)`在于 cat 操作的输出在进入循环之前经过字符串拆分和 glob 扩展，使得行为依赖于许多变量（`IFS`shell 设置的内容、当前目录中的文件 [如果可能是 glob-存在扩展名称]，影响 glob 解释方式的各种 shell 选项等）。该`while read`方法将表现一致。

其次——出于同样的原因总是引用扩展：`"$line"`避免字符串拆分和全局扩展（再次，使上述设置和变量没有实际意义），而bare`$line`却发生了这些。

最后，上面的示例使用默认`REPLY`变量，因为 shell 在这些条件下读取时不会修剪空白字符（即，在 中找到的字符`$IFS`）。这通常是不必要的（通过显式清除 IFS 可以获得相同的效果，如 中`while IFS= read -r line; do ...`所示），但由于目标是可重现的，因此我们做对了。:)

遵循这些做法，您将看到所有符合 POSIX sh 的 shell 之间的行为一致。（唯一不符合 POSIX sh 的主要 shell——在它认为标准强制行为不合理的地方默认破坏兼容性——是 zsh）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-26T12:45:59.010

简单的方法是使用如下的while循环

```
filename=/path/to/file/file.txt
while read variablename 
```

`do echo "$variablename" done < "filename"` 它的作用是读取整行直到 \n

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T18:38:45.823

你提`echo`。你写吗

```
echo $multiLineVar 
```

或者

```
echo "$multiLineVar" 
```

在第一种情况下，shell 会将嵌入的换行符视为分隔单词的空格，因此`echo`永远不会看到它们。

# phing - 如何判断任务是主任务还是 Phing 中的子调用/依赖项

> ID：15554936
> 
> 赞同：1
> 
> 时间：2013-03-21T18:06:39.127
> 
> 标签：phing

我的想法是让我的 Phing 脚本说话，但我希望他们只在我运行调用的任务后才说话。有谁知道在 Phing 任务中告诉它是否是父调用者？

示例 build.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="my_project" default="install">

    <target name="install" depends="configure, migrate">
        <!-- I would like to call this only if `phing install`-->
        <phingcall target="talk" />
    </target>

    <target name="configure">

        <!-- I would like to call this only if `phing configure`-->
        <phingcall target="talk" />
    </target>

    <target name="migrate-database">
        <!-- I would like to call this only if `phing migrate-database`-->
        <phingcall target="talk" />
    </target>

    <target name="talk">
        <property name="message" value="Phing deployment operation done" override="true" />
        <echo msg="${message}" />
        <exec command="say '${message}'" />
    </target>

</project> 
```

# python - Python Matplotlib 点颜色

> ID：15554939
> 
> 赞同：5
> 
> 时间：2013-03-21T18:06:58.687
> 
> 标签：python, matplotlib, heatmap

我一直在使用传感器查看温度绘图，并想了解如何构建轮廓/热图或根据 cmap 编辑点的颜色？

我有以下非常基本的情节：

```
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
import numpy as np
from pylab import *

figure(figsize=(15, 8))
# use ginput to select markers for the sensors
matplotlib.pyplot.hot()

markers = [(269, 792, 0.65), (1661, 800, 0.5), (1017, 457, 0.8)]
x,y,t = zip(*markers)

img = mpimg.imread('floor.png')
imgplot = plt.imshow(img, cmap=cm.hot)
plot(x, y, 'h', c=t, ms=15)

colorbar()
show() 
```

标记中的第三个值应该是点颜色。但是，当我制作绘图时，它使用标记中的第一个值以相同的方式为每个点着色。是否可以设置点的 cmap，以便我可以使用 hot 并将其与实际温度相关联？当前点以浅紫色/淡紫色绘制，我认为这是默认的 cmap。我看到 cmap 似乎不是 plot 的有效值，所以我不确定我会在哪里指定。

我真正想尝试找出的替代解决方案是使用轮廓或 histogram2d 来显示热半径。可以在图像上绘制吗？我看了一下[这个](http://scipy-lectures.github.com/intro/matplotlib/auto_examples/plot_contour_ex.html)例子，但我似乎无法正确编辑它以使用实际值而不是随机函数。有没有人有他们过去使用过的替代解决方案/示例代码来满足我的需求？我对我找到的文档有点困惑。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:17:43.047

这就是[`scatter`情节](http://matplotlib.org/1.2.0/api/pyplot_api.html#matplotlib.pyplot.scatter)的目的：

```
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
import numpy as np
from pylab import *

figure(figsize=(15, 8))
# use ginput to select markers for the sensors
matplotlib.pyplot.hot()

markers = [(269, 792, 0.65), (1661, 800, 0.5), (1017, 457, 0.8)]
x,y,t = zip(*markers)

img = mpimg.imread('floor.png')
imgplot = plt.imshow(img, cmap=cm.hot)
scatter(x, y, marker='h', c=t, s=150)

colorbar()
show() 
```

请注意，参数不同，`plot`并且大小比例不同。如果你想改变点的颜色，你可能想使用`cmap`参数`scatter`

# ruby-on-rails - Rails 表单提交导致错误

> ID：15554940
> 
> 赞同：0
> 
> 时间：2013-03-21T18:07:00.853
> 
> 标签：ruby-on-rails, forms, sqlite, activerecord

我创建了这个表格：

```
<%= form_for @task do |task| %>
    <%= task.hidden_field :user_id, :value => @user.id %>

    <%= task.label :task %>
    <%= task.text_area :task %>

    <%= task.label :deadline %>
    <%= task.text_field :deadline %>

    <%= task.submit "Add" %>
<% end %> 
```

和控制器：

```
def new
    @task = Todo.new
  end

  def create
    @task = Todo.new(params[:task])
    if @task.save
        set_flash "Task added"
      redirect_to action: 'index'
    else
        set_flash "Task adding failed, Please try again"
      redirect_to action: 'index'
    end
  end

def set_user
    @user = current_user
end 
```

当我提交表单时，我收到此错误：

> SQLite3::ConstraintException: todos.user_id 可能不是 NULL: INSERT INTO "todos" ("completed", "created_at", "deadline", "task", "updated_at", "user_id") VALUES (?, ?, ? , ?, ?, ?)

问题是什么？

**编辑：**

这是rails传递的参数：

```
 {"utf8"=>"✓",
 "authenticity_token"=>"oJr4ii4szyBVAacBJDNYcZn8QWGrFij4dF1wqD1Fvic=",
 "todo"=>{"user_id"=>"1",
 "task"=>"Hello World",
 "deadline"=>"03/20/2013"},
 "commit"=>"Add"} 
```

这是模型：

```
attr_accessible :user_id, :deadline, :task, :completed 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:12:20.383

正如数据库通知您的那样，问题是`user_id`您的字段`Todo`不能为零。确保在保存之前将其与当前用户关联，可能在控制器中执行以下操作：

```
def create
  @task = Todo.new(params[:task])
  @task.user = current_user
  ...

end 
```

或者，如果您希望在没有关联用户的情况下创建 todos，请从数据库中删除约束。

# sql - 使用多个表的 SQL Server 更新

> ID：15554941
> 
> 赞同：6
> 
> 时间：2013-03-21T18:07:02.803
> 
> 标签：sql, sql-server

我对 SQL 了解不多——我只是在编写一个 RFID 学生注册扫描仪，它与 SQL Server 中的数据库连接。

我确信这很容易做到，但我找不到解决我的问题的方法。

我希望能够以一种不起作用的基本形式来做这样的事情：

```
UPDATE Attendance 
SET    A1 = 'TRUE' 
WHERE  Student.ID = '3a0070c48' 
  AND  Module.Day = 'Friday' ; 
```

但是完整的 SQL 更新需要是这样的：

```
UPDATE Attendance 
SET    A1 = 'TRUE' 
WHERE  Student.ID = '3a0070c48' 
  AND  Module.Day = 'Friday' 
  AND  '1100' BETWEEN Module.StartTime 
                  AND Module.EndTime ; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T18:11:03.873

好的，您需要执行以下操作：

```
UPDATE A
SET A.A1 = 'TRUE' 
FROM Attendance A
INNER JOIN Student S
    ON A.StudentId = S.ID
INNER JOIN Module M
    ON A.ModuleId = M.ID
WHERE S.ID = '3a0070c48' 
AND M.[Day] = 'Friday' 
AND '1100' BETWEEN M.StartTime AND M.EndTime 
```

我猜到了与您的表格相关的列，但它应该非常接近您所拥有的，您需要使用真正的列。

# ios - 如何使这段代码更好？

> ID：15554942
> 
> 赞同：-5
> 
> 时间：2013-03-21T18:07:04.397
> 
> 标签：ios, objective-c, instruments

我使用了 imageNamed 但 imageNamed 会缓存您的图像，但是使用 imageWithContentsOfFile: 来避免缓存。

我发现使用仪器会消耗大量时间。这怎么可能更好？

[![在此处输入图像描述](../Images/bf66e1e1e5e9f3f0eb4400bf7f7e4632.png)](https://i.stack.imgur.com/NWScY.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:13:24.807

You may be misunderstanding what Instruments profiling is telling you. 95% of 4.3% is not very much. It all depends on what else is happening. If you are not experiencing a serious slowdown, don't optimize unnecessarily!

A question to ask yourself, though, is whether you really need an array of physical image data. It really does take serious time to decompress an image file into its UIImage data bitmap. (Not to mention that you can run yourself out of memory this way.) Why not store an array of strings (your `pathForResource` strings) and fetch the image only when needed?

Finally I would point out that I see a pattern here: You are fetching image 13, then image 12, then image 11, and so on. So your code that does this manually is very silly, since if you tell me the index number I can tell you *algorithmically* what image corresponds to it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:13:17.183

Try to replace using `[NSBundle mainBundle] pathForResource`:... with this code:

```
NSString *bundleRoot = [[NSBundle mainBundle] bundlePath]; 
```

for example get some image file path

```
UIImage *img= [[UIImage alloc] initWithContentsOfFile:[NSString stringWithFormat:@"%@\myImage.png",bundleRoot]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T18:11:42.900

您正在读取所有这些文件，解压缩它们，为未压缩版本分配内存，并将它们存储在数组中。你需要所有这些吗？您可以按需加载它们而不是一次全部加载吗？这将减少初始化数组导致的重大影响。

此外，请确保您的图像不大于实际显示的大小。如果您加载大图像只是为了在小区域显示它，则加载和解压缩该大图像将花费更长的时间。

# openoffice-calc - OpenOffice 预测天数

> ID：15554943
> 
> 赞同：0
> 
> 时间：2013-03-21T18:07:05.243
> 
> 标签：openoffice-calc

为了公民身份，我正在计算我在加拿大的停留天数。规则是，在过去的 1460 天中，您需要在场 1095 天（我很清楚存在的定义有多差，但这不是这个问题的主题。）我有一个电子表格，其中每个 A 单元格都包含这一天当我离开时，每个 B 单元格都包含我返回的那一天。我想计算我有足够天数的日期。我的问题是我不知道应该使用哪个单元格范围进行计算，因为这本身取决于单元格是否有意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:20:35.557

首先，成功，加拿大很美！我在访问时感到宾至如归（欧洲和美国的完美结合）。

让我知道这是否是您要找的？

![在此处输入图像描述](../Images/d84ef7f1681c07fd3d17937d9f6b7a19.png)

[加拿大日.ods](https://dl.dropbox.com/u/6572112/canada%20days.ods)

# xml - xslt：尝试在其他地方使用 align 的值

> ID：15554946
> 
> 赞同：0
> 
> 时间：2013-03-21T18:07:07.207
> 
> 标签：xml, xslt, html-table

我正在尝试编写一个`If`or`when`语句来检查`align`表格单元格的属性值，并将在其他地方使用它。

示例代码：

现在我把它写成

`<xsl:when test="../../../@align='left'"><th align="left"><xsl:apply-templates select="*|@*|text()"/> </th></xsl:when>`

我为“左”、“中”和“右”执行此操作，但我希望有一些东西可以处理任何值并写入该值。有点

`<xsl:when test="../../../@align='*'"><th align="*"><xsl:apply-templates select="*|@*|text()"/> </th></xsl:when>`

任何帮助都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:16:44.660

怎么样

```
<th align="{../../../@align}">
  <xsl:apply-templates select="*|@*|text()"/>
</th> 
```

（该`{...}`符号称为*属性值模板*）。如果该祖先元素没有`align`属性，那么您将进入`align=""`输出。如果这是一个问题，你可以做

```
<th>
  <xsl:copy-of select="../../../@align"/>
  <xsl:apply-templates select="*|@*|text()"/>
</th> 
```

`<th align="....">`如果`align`您在输入中搜索的属性存在，这将创建，但`<th>`如果它不存在。

# java - JAVA递归和迭代方法

> ID：15554947
> 
> 赞同：-2
> 
> 时间：2013-03-21T18:07:11.653
> 
> 标签：java, recursion, iteration

嗨，我有一个关于我的代码的快速问题，我需要知道错误在哪里以及为什么它没有正确显示递归和迭代方法（这会返回 stackoverflow 错误）。谢谢

```
import java.util.Scanner;

public class Progression {
    public static int geometricRecursive(int x){
        if(x  == 1)
            return 1;
        else {
            return x * geometricRecursive(x - 1);
        } 
    }

    public static int harmonicRecursive(int x){
        if(x == 1)
            return 1;
        else {
            return x * harmonicRecursive(1/(x - 1));
        }
    }

    public static int geometricIterative(int num){
        int result = 0;
        if(result == 1)
            return result;
        else
            for(int i = 2; i < num; i++){
                result = (i * (i + 1));
            }
        return result;
    }

    public static int harmonicIterative(int num){
        int result = 0;
        if (result == 1)
            return result;
        else
            for (int i = 2; i < num; i ++){
                result = (i * (1/(i+1)));
            }
        return result;
    }

    public static void main(String [] args)
    {
        Scanner keyboard = new Scanner (System.in);
        System.out.println("This program will calculate the geometric and ");
        System.out.println("harmonic progression for the number you enter.");
        System.out.print("Enter an integer that is greater than or equal to 1: ");
        int input = keyboard.nextInt();
        int geomAnswer = geometricRecursive (input);
        double harmAnswer = harmonicRecursive (input);
        System.out.println("Using recursion:");
        System.out.println("The geometric progression of " + input + " is " + geomAnswer);
        System.out.println("The harmonic progression of " + input + " is " + harmAnswer);
        geomAnswer = geometricIterative (input);
        harmAnswer = harmonicIterative (input);
        System.out.println("Using iteration:");
        System.out.println("The geometric progression of " + input + " is " + geomAnswer);
        System.out.println("The harmonic progression of " + input + " is " + harmAnswer);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T18:10:44.467

你得到一个 StackOverflow，因为你没有正确地执行除法。您正在进行整数除法，这会产生错误的结果。这会导致在您的递归算法中无法达到您的基本条件。

要修复它，请使用双打并更改基本条件：

```
public static double harmonicRecursive(double x)
{
   if(x <= 1.0)
   {
       return 1.0;
   }
   else
   {
       return x * harmonicRecursive(1.0 / (x - 1.0));
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T18:14:34.853

违规行在`return x * harmonicRecursive(1/(x - 1));`方法中`harmonicRecursive(int x)`。该`1/(x - 1)`部分代码将返回`0`所有`x > 2`. 如果您在该函数中输入大于 2 的任何值，您的语句只会检查哪个是问题`if`。`x == 1`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:10:39.933

以这种方式更改此方法：

```
public static int harmonicRecursive(int x){

   if(x <= 1) //Here

       return 1;

   else {

      return x * harmonicRecursive(1/(x - 1));

   }
} 
```

# jquery - 仅在拖动特定列时才可排序行

> ID：15554951
> 
> 赞同：2
> 
> 时间：2013-03-21T18:07:29.670
> 
> 标签：jquery

选择表格的特定列时如何对行进行排序？

```
[...]
<tbody id="table_body">
    <tr>
        <td>A</td>
        <td>10</td>
    </tr>
    <tr>
        <td>B</td>
        <td>8</td>
    </tr>
    <tr>
        <td>T</td>
        <td>12C</td>
    </tr>
</tbody>
[...] 
```

剧本：

```
var fixHelper = function (e, ui) {
    ui.children().each(function () {
        $(this).width($(this).width());
    });

    return ui;
};

$(function () {
    $("#table_body").sortable({
        helper: fixHelper
    }).disableSelection();
}); 
```

因此，我希望仅在选择第一列时才对行进行排序。如果我选择第二列，则不会发生任何事情。是否可以？

编辑：

我试试 Pow 说的：

```
$('#table_body td').mousedown(function (event) {
    if ($(this).attr("class") != "add_story") {
        event.stopImmediatePropagation();
    }
}); 
```

但是，当我按“add_story”类的列移动一行时，每一行都会被任何列移动。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-25T19:45:08.893

您还可以使用句柄选项：[http ://api.jqueryui.com/sortable/#option-handle](http://api.jqueryui.com/sortable/#option-handle)

给你的第一列一个像“sortHandle”这样的类，然后在你的脚本中你可以将句柄选项设置为仅在单击该列时进行排序。

```
var fixHelper = function (e, ui) {
    ui.children().each(function () {
        $(this).width($(this).width());
    });

    return ui;
};

$(function () {
    $("#table_body").sortable({
        helper: fixHelper,
        handle: '.sortHandle',
    }).disableSelection();
}); 
```

HTML：

```
 <tbody id="table_body">
        <tr>
            <td class="sortHandle">A</td>
            <td>10</td>
        </tr>
        <tr>
            <td class="sortHandle">B</td>
            <td>8</td>
        </tr>
        <tr>
            <td class="sortHandle">T</td>
            <td>12C</td>
        </tr>
    </tbody> 
```

这是一个例子：http: [//jsfiddle.net/uWZ59/2/](http://jsfiddle.net/uWZ59/2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T19:08:48.037

我可以通过向单元格添加类来做到这一点。

然后在您不想允许拖入的单元格中，覆盖`mousedown`事件

像这样的标记：

```
<td class='grab'>A</td>
<td class='show'>10</td> 
```

和这样的脚本：

```
$(function () {
    $("tbody").sortable({
        helper: fixHelper,
        axis: "y"
    }).disableSelection();
    $('#Table_Body').not('.add_Story').mousedown(function(event){
        event.stopImmediatePropagation();
    });
}); 
```

[例子](http://jsfiddle.net/XEMhW/)

y 轴不是必需的，我只是认为它会很好。

# vb.net - 如何将小高度设置为无边框子窗体？

> ID：15554956
> 
> 赞同：2
> 
> 时间：2013-03-21T18:07:43.440
> 
> 标签：vb.net, winforms

我在单击按钮时生成无边框子窗体。当我尝试设置初始表单高度时，它会增加高度，就好像还有一个必须显示的 ControlBox 一样。如果我使用工具窗口边框样式，它将接受任何高度，但无边框表单的大小只会缩小到大约 30 像素（不会更小）。我目前适用的代码如下：

```
Dim taskForm As New Form
taskForm.FormBorderStyle = Windows.Forms.FormBorderStyle.None
taskForm.AutoSize = False
taskForm.ControlBox = False
taskForm.Height = 2
taskForm.Show() 
```

如何将这个动态创建的无边框表单设置为较小的高度？

# asp.net - web.config 中设置的用户控件有效，但在没有智能感知的网页上显示为警告

> ID：15554958
> 
> 赞同：0
> 
> 时间：2013-03-21T18:07:53.057
> 
> 标签：asp.net, user-controls, web-config

我在 web.config 上设置了一个用户控件，因为它将用于多个页面。这适用于使用用户控件的页面，但它在网页上显示为带有绿色波浪线的错误，因此智能感知不起作用。

这是它在 web.config 中的样子： ![在此处输入图像描述](../Images/5963f89a0b642ee3ed3927aa9718e2bd.png)

当我将鼠标悬停在绿色 swiggly 上时，这就是它在代码后面的错误消息的样子：

![在此处输入图像描述](../Images/29e00ffab7b5ce2e2f991bfa1f0a009d.png)

我读到可以通过清除相关的架构目录来纠正它，但这没有用。

非常感谢任何建议。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:13:16.157

Sometimes i get the same warnings and after building, or running the app it will go away.

Other times i have to close the application and reopen VS

# php - mysqli转换建议

> ID：15554959
> 
> 赞同：0
> 
> 时间：2013-03-21T18:07:57.527
> 
> 标签：php, mysqli

我不得不为新格式更新我的 PHP，但我对在线给出的代码感到困惑。目前我使用的是普通的 mysql，但我想将其更新为 mysqli。这是我拥有的一段代码的示例：

```
$checked= mysql_real_escape_string($_REQUEST["checked"]); 
```

我认为这可能只是将其更改为 mysqli_real_escape_string 的情况，但在查看了一些示例代码后，我发现这不是唯一的解决方案 - mysqli::real_eacape 和 mysqli->real_escape 也列出了。哪一个是正确的？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:11:25.593

看看这个[http://php.net/manual/en/mysqli.quickstart.prepared-statements.php](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)

准备好的语句是清理数据库查询的正确方法，它是 mysqli 中首选的方法。

***要回答您对我的帖子的评论：***

请注意，有两种调用方式：面向对象和过程。

**OOP**用法意味着首先创建一个 mysqli 对象，如下所示：

```
$mysqli = new mysqli("localhost", "my_user", "my_password", "db"); 
```

然后像这样调用转义函数：

```
$mysqli->real_escape_string($unchecked_string); 
```

**程序**方式是通过首先像这样连接到数据库来完成的：

```
$link = mysqli_connect("localhost", "my_user", "my_password", "db"); 
```

然后像这样调用转义函数：

```
mysqli_real_escape_string($link, $unchecked_string); 
```

使用 OOP 和准备好的语句是使用 mysqli 的首选方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:12:39.567

我更喜欢 PDO 而不是 mysqli，它的准备好的语句会自动转义字符串：只需使用您的连接凭据填写 DB_NAME、DB_USER_NAME 和 DB_USER_PASS：

```
$con = new PDO( 'mysql:host=localhost;dbname=DB_NAME;charset=UTF-8', 'DB_USER_NAME', 'DB_USER_PASS' );

$query = $con->prepare( "SELECT `field` FROM `tbl_name` WHERE `field` = ?" );
$query->bindValue( 1, $field_value );
$query->execute();

if( $query->rowCount() > 0 ) { # If rows are found for query
     echo "Field value found!";
}
else {
     echo "Field value not found!";
} 
```

prepare 和 bindValue 方法自动处理转义数据。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-21T18:19:44.213

正确的是程序风格

```
mysqli_real_escape_string 
```

对于 OOP 风格

```
 $mysqli->real_escape_string() 
```

其中 $mysqli 只是一个随机变量名

# c# - C# / .NET 相当于 Python 检查

> ID：15554963
> 
> 赞同：1
> 
> 时间：2013-03-21T18:08:11.417
> 
> 标签：c#, python, stack-trace

过去我很幸运使用Python 中[的检查模块](http://docs.python.org/2/library/inspect.html)来协助事后调试：当出现问题时，它可以轻松查看错误堆栈并查看每一帧中的局部变量。

我想在[.NET](http://en.wikipedia.org/wiki/.NET_Framework)中做类似的事情（特别是[C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)）。是否有一种现成的方法可以在异常时获取一组堆栈帧中的所有局部变量？据我所知，.NET StackFrame 对象仅包含有关代码中框架位置的元数据。我想找到一个与检查“框架”对象的`f_locals`和`f_globals`成员等效的.NET。

理想的答案将在[Mono](http://en.wikipedia.org/wiki/Mono_%28software%29)和 .NET 2.0 下工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:19:08.447

IntelliTrace 是您正在寻找的，它允许您记录堆栈、异常等等

[http://msdn.microsoft.com/en-us/library/vstudio/dd264915.aspx](http://msdn.microsoft.com/en-us/library/vstudio/dd264915.aspx)

编辑：显然这在 Mono 下不起作用。

我唯一可以建议的是记录所有异常，也许可以查看[http://www.mono-project.com/Soft_Debugger](http://www.mono-project.com/Soft_Debugger)

# javascript - 如何使用/传输包含特殊字符的 attr('id')？

> ID：15554964
> 
> 赞同：0
> 
> 时间：2013-03-21T18:08:15.803
> 
> 标签：javascript, jquery, special-characters

我已经搜索了一些与此相关的问题（例如[How to handle special characters in html element id/name in Jquery validation?](https://stackoverflow.com/questions/1706159/how-to-handle-special-characters-in-html-element-id-name-in-jquery-validation)），但不幸的是它对我没有帮助，或者我没有理解这个技巧......

假设我们有一个带有 class`.bt`和 id的按钮`my|id`。（或其他特殊分隔符，如`,:;|`）

似乎无法使用它来匹配另一个元素，例如`$('#other_'+$('.bt').attr('id'))`

你可以在这里看到一个[例子](http://jsfiddle.net/JX4Rr/1/)。

所以我的问题是如何传输那些特殊字符（`,:;|`）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:24:37.693

这有效：

```
$('[id="div_' + id + '"]').html(id); 
```

而不是这个：

```
$('#div_'+id).html(id); 
```

~~[在这里](http://jsfiddle.net/JX4Rr/2/)提琴~~

-编辑-

显示用法的[新小提琴](http://jsfiddle.net/JX4Rr/3/)`,:;|`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T18:30:44.693

这是与纯 jQuery 解决方案的偏差，但在这种情况下，使用本机`document.getElementById(...)`函数可能会更好吗？

```
$(document.getElementById('other_' + $('.bt').attr('id'))) 
```

它读起来有点冗长，但似乎比使用正则表达式更清晰/一致/安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T18:21:03.460

像这样？

```
$('#other_' + $('.bt').attr('id').replace('|', '\\|')); 
```

[http://jsfiddle.net/S669p/](http://jsfiddle.net/S669p/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T18:34:25.597

这是一个仍然使用选择器的示例`id`，但也允许您希望能够使用的任何特殊字符：

```
$(document).ready(function () {
    $(".bt").on("click", function () {
        var escaped = $(this).attr("id").replace(/([,:;|])/g, "\\$1");
        console.log("escaped: " + escaped);
        $("#other_" + escaped).toggleClass("testing");
    });
}); 
```

[http://jsfiddle.net/Bz3Kw/1/](http://jsfiddle.net/Bz3Kw/1/)

# c++ - 比较枚举类型时出现逻辑错误

> ID：15554965
> 
> 赞同：3
> 
> 时间：2013-03-21T18:08:17.177
> 
> 标签：c++, enums, return, conditional

我正在尝试比较两个枚举值，但在运行时它似乎总是评估为真。

Table.h 中的枚举声明，带有返回方法以获取状态值：

```
enum TableStatus { IDLE, SEATED, ORDERED, SERVED};

class Table
    {
    private:
            ...
            TableStatus status;     // current status
    public:
            ...
            TableStatus getTableStatus(void);
    } 
```

在我需要比较枚举值的部分中，我一直在尝试如下所示的条件：

```
if (tables[tableId]->getTableStatus() == TableStatus(SERVED)) 
```

我的问题是如何让这个逻辑起作用。将 Table 对象的状态与某个枚举值进行比较将正确评估。

编辑：包括 getTableStatus(void);

```
TableStatus Table::getTableStatus(void){
        return status;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:22:50.170

当我使用枚举时，我遇到了同样的困惑。有好几次，我必须查看有关 enum 的教程以确保我是正确的。每当我使用枚举进行编程时，我都会阅读此（[http://www.cprogramming.com/tutorial/enum.html](http://www.cprogramming.com/tutorial/enum.html)）教程。

基本上枚举（C++98）的行为不像类，所以你写的不正确。枚举可以直接引用，所以你必须写：

```
if (tables[tableId]->getTableStatus() == SERVED) 
```

前提是您编写代码的枚举和函数在同一范围内。

如果您使用的是 C++11，`enum classes`这是一个更好的选择。我喜欢枚举类，因为我不会像以前对 C++98 枚举那样对它们感到困惑。 [http://www.cprogramming.com/c++11/c++11-nullptr-strongly-typed-enum-class.html](http://www.cprogramming.com/c++11/c++11-nullptr-strongly-typed-enum-class.html)

# ruby - 命名 Ruby 异常的约定

> ID：15554966
> 
> 赞同：4
> 
> 时间：2013-03-21T18:08:19.407
> 
> 标签：ruby, api, exception, naming-conventions

我已经发布了相当多的库。我还没有决定如何命名我的例外。Ruby 标准库总是这样命名异常（一个名词是`Exception`or `Error`）——例如

*   运行时错误
*   EOF错误
*   线程错误

相比之下，Rails 使用缩短的异常名称，比如 like`RecordInvalid`等等。

如果我编写库，并且其中大多数与 Rails 无关，我应该使用哪种命名约定？我必须承认 Rails 的“缩写名称”对我更有吸引力，因为当异常发生时，您已经*看到*它是异常或某种错误，因为它会在日志/调试器/stderr 中弹出。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T18:21:45.667

这是我的做法。

异常的名称是否清楚地表明出了什么问题？如果是，你就完成了。如果没有，请添加`Error`后缀。

所以使用你的例子：

*   `ThreadError`: 这里`Thread`已经是 ruby​​ 中的一个常量，也是一个异常状态的糟糕描述。所以需要一个后缀来表示线程中的一些通用错误。
*   `RecordInvalid`：在这种情况下，异常的名称清楚地说明了问题所在。 `RecordInvlaidError`将是多余的。

另一种思考方式可能是通用的还是特定的。

*   `ThreadError`: 一般错误，线程发生了一些不好的事情，不知道到底是什么，但它不好。所以这描述了“线程”中的某种“错误”。
*   `RecordInvalid`: 特定错误，此记录的数据完整性存在特定问题，无法保存。所以“记录”是“无效的”，这就是你需要说的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:22:06.273

就个人而言，我在`Error`营地，但只有当它感到自然时。放在`Error`最后可以清楚地说明类是什么，它不是一个普通的对象，等等。我觉得`Exception`我的口味有点长，缺少后缀太模棱两可了。

# font-face - 谷歌网络字体和 woff

> ID：15554969
> 
> 赞同：0
> 
> 时间：2013-03-21T18:08:27.220
> 
> 标签：font-face

Google 仅提供其字体的 woff 版本，并且在 iOS 设备上呈现没有任何问题。但是如果使用相同的谷歌代码和自己的 woff 字体，它就会停止工作。

这里是离线使用的谷歌代码，它适用于桌面和移动设备，

```
<style type="text/css">
@font-face {
font-family: 'Keania One';
font-style: normal;
font-weight: 400;
src: local('Keania One'), url(Xs0xx5kHUREmTXw6nnDuChsxEYwM7FgeyaSgU71cLG0.woff) format('woff');
}
body {
font-family: Keania One;
font-size: 150px;
}
</style> 
```

即使有正确的 ID 等，SVG 也不起作用，这是字体问题吗？还是我想念的东西？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T08:40:50.387

像这样的 Google Webfont 代码看起来像是指向静态 CSS 文件的链接。

```
<link href='http://fonts.googleapis.com/css?family=Gabriela'
 rel='stylesheet' type='text/css'> 
```

然而，事实并非如此。这是一个检测你的操作系统和浏览器的脚本，根据你的浏览器支持生成正确的字体 CSS。它很聪明，因为它只加载支持的文件。

您的代码应该可以工作，至少在支持 WOFF 文件的地方。不过有一件事，您需要像这样编写正文字体系列：

```
font-family: 'Keania One'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:13:41.230

I'm still new with all this but I hope this can help a little bit. If you could download the font you want to use you can go to [Fontsquirrel](http://www.fontsquirrel.com/tools/webfont-generator) they offer a free service for converting your own fonts you have to web fonts and you can download the web kit. So maybe if you make your own web font kit and use that instead somehow it may fix it. Hopefully this helps, my apologies if it doesn't.

# c# - 绑定到 VM 属性的 DataGrid CheckboxColumn 未调用 setter

> ID：15554970
> 
> 赞同：0
> 
> 时间：2013-03-21T18:08:28.800
> 
> 标签：c#, wpf, mvvm

ETA：我正在使用 Caliburn.Micro，因此 Grid 的 x:Name 属性被绑定到 VM 上名为 MyData 的属性，该属性又具有属性 IsTrue。MyData 确实继承自 PropertyChangeBase

我有一个 DataGrid，其列绑定到 ViewModel 上的 bool 属性：

```
<DataGrid x:Name="MyData"
                  AutoGenerateColumns="False"
                      Width="282"
                      RowHeaderWidth="0"
                      CanUserAddRows="false">
  <DataGrid.Columns>
     <DataGridCheckBoxColumn Header="MyChckColumn"
                     Binding="{Binding IsTrue, Mode=TwoWay}"
                     Width="80"/>
   </DataGrid.Columns>
</DataGrid> 
```

它仅在选择网格上的其他内容时才进入设置器，但在我实际选中一个空框时不会进入。

```
 public bool IsTrue
  {
     get
     {
        return _isTrue;
     }
     set
     {
        if (value.Equals(_isTrue)) return;
        _isTrue= value;
        NotifyOfPropertyChange(() => IsTrue);
     }
  } 
```

是否有一些我需要调用的验证方法或需要设置的触发器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:51:32.080

要获得您所追求的行为，您必须将`UpdateSourceTrigger`绑定的属性设置为`PropertyChanged`.

默认情况下，当单元格失去焦点时会更新绑定源。

```
Binding="{Binding IsTrue, UpdateSourceTrigger=PropertyChanged}" 
```

# php - 如何保存统计数据？

> ID：15554977
> 
> 赞同：3
> 
> 时间：2013-03-21T18:09:08.653
> 
> 标签：php, reporting

我必须为我的一个应用程序在 php 中实现一个报告/统计工具。数据量真的很大，大约1.2亿条记录。报告应该是实时生成的，因为用户可以在生成报告之前选择许多过滤器，所以没有办法预先生成它，比如说在夜间基础上。

我使用的 MySql 数据库由于数据聚合和连接（用于过滤）而无法处理这么多的数据。即使在尝试对表进行非规范化之后，它也确实很慢。我的问题是我可以从 PHP 中使用任何专用的开源报告统计工具吗？即使它不是用 PHP 编写的，但可以与库链接。

我还阅读了有关非 sql 数据库的信息，但由于它们不是关系型数据库，因此很难对它们进行连接，而且在聚合方面它们并不是很好（据我在 mongoDB 上看到的）。

感谢您的意见。

最好的问候，费里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T15:54:15.357

如果您正在寻找开源报告引擎，Jasper Reports 和 Pentaho 是不错的选择，但是，它们都在 Java 上运行，并且更好地使用松散耦合（简单地作为报告服务器）。在 PHP 中有一个 Jasper Reports 的（部分）实现，称为[PHPJasperXML](http://www.simit.com.my/?q=PHPJasperXML)，根据您的需要，看看这个项目并使用它可能是值得的。

# c# - 我怎么知道我的应用程序没有被添加到防火墙？

> ID：15554979
> 
> 赞同：6
> 
> 时间：2013-03-21T18:09:21.470
> 
> 标签：c#, winforms, firewall, netsh

我使用 netsh 将我的应用程序添加到防火墙，如下所示。在添加到防火墙之前，如何知道应用程序没有添加到防火墙中？因为我不想重复将我的应用程序添加到防火墙。

```
ProcessStartInfo info = null;
try
{
    using (Process proc = new Process())
    {
        string productAssembly = new Uri(Path.GetDirectoryName(Assembly.GetExecutingAssembly().CodeBase)).LocalPath + "\\" + this.ProductName + ".exe";
        string args = string.Format(CultureInfo.InvariantCulture, "advfirewall firewall add rule name=\"{0}\" dir=in action=allow program=\"{1}\" enable=yes", this.ProductName, productAssembly);
        info = new ProcessStartInfo("netsh", args);
        proc.StartInfo = info;
        proc.StartInfo.UseShellExecute = false;
        proc.StartInfo.CreateNoWindow = true;
        proc.StartInfo.RedirectStandardOutput = false;
        proc.Start();
    }
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:48:06.250

TheGreatCO，谢谢。我已经尝试过了，它奏效了。

```
private bool isFirewallEnabled()
{
    ProcessStartInfo info = null;
    string result = string.Empty;
    try
    {
       using (Process proc = new Process())
       {
           string args = string.Format(CultureInfo.InvariantCulture, "advfirewall firewall show rule name=\"{0}\"", this.ProductName);
           info = new ProcessStartInfo("netsh", args);
           proc.StartInfo = info;
           proc.StartInfo.UseShellExecute = false;
           proc.StartInfo.CreateNoWindow = true;
           proc.StartInfo.RedirectStandardOutput = true;
           proc.Start();

           while ((result = proc.StandardOutput.ReadLine()) != null)
           {
               if (result.Replace(" ", String.Empty) == "Enabled:Yes")
               {
                   return true;
               }
            }
        }
    }
    catch (Exception ex)
    {
       MessageBox.Show(ex.Message);
    }
    return false;
} 
```

# jquery-plugins - 带有右侧导航的wordpress文本图像滑块？

> ID：15554984
> 
> 赞同：2
> 
> 时间：2013-03-21T18:09:39.627
> 
> 标签：jquery-plugins, wordpress

我需要这个滑块插件。我搜索了很多插件，但没有找到类似的插件。经过很多努力我发现 `"unpointzero slider wordpress plugin"`。但它没有正确配置。

请帮助我。

![在此处输入图像描述](../Images/1ec5705e89f97b6ef3c37620e4f7ac83.png)

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:16:23.067

试试[http://slidervilla.com/pointelle/](http://slidervilla.com/pointelle/)。这出现在快速的谷歌搜索中。我敢肯定还有很多。

# json - 是否有一个 API 可以检索给定类别的项目列表？

> ID：15554994
> 
> 赞同：0
> 
> 时间：2013-03-21T18:10:10.870
> 
> 标签：json, get, wikipedia-api, google-custom-search

我认为，由于 Google Sets 曾经存在并且[在某种程度上仍然存在](http://googlesystem.blogspot.com/2012/11/google-sets-still-available.html)，因此必须存在一些 API（google 或其他），我可以在其中将类别作为 GET 请求发送并检索该类别中项目的 JSON 列表。

例如：

```
In: 'sports' 
Out: {'basketball', 'football', 'baseball', 'hockey', 'soccer', 'lacrosse', ...}

In: 'animals'
Out: {'dog', 'cat', 'fish', 'bird', 'horse', ...} 
```

我认为答案可能与 Google 的自定义搜索 API 甚至维基百科有关？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T19:26:49.150

您最好的选择可能是对 freebase 的 MQL 查询

[http://wiki.freebase.com/wiki/MQL](http://wiki.freebase.com/wiki/MQL)

像[这样的运动](https://www.googleapis.com/freebase/v1/mqlread?query=%5B%7B%22name%22%3a%20null,%22id%22%3a%20null,%22type%22%3a%20%22/sports/sport%22,%22limit%22%3a%2025%7D%5D)

# eclipse - 在 Eclipse 中使用 emacs 或 vim 语法高亮文件（e-lisp、vimrc）

> ID：15554995
> 
> 赞同：1
> 
> 时间：2013-03-21T18:10:12.040
> 
> 标签：eclipse, vim, emacs, ide

是否可以在 Eclipse 中以某种方式导入 emacs 或 vim sytax 突出显示规范？我尝试搜索，但我只能找到有关 vim/emacs 和 Eclipse 集成或其他不相关事物的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T12:34:39.647

我不知道*其他编辑器*，但是对于 Vim 语法高亮，这绝对是不可能的。为什么？

*   Vim 语法定义是用 Vimscript 编写的；这将需要一个完整的口译员。
*   大多数定义使用正则表达式；没有其他引擎实现完全相同的风格；有些原子是 Vim 独有的。

如果您只是想在 Eclipse 中使用相似的颜色，您当然可以在另一个编辑器中重新创建您的 Vim 颜色*方案。*的输出`:highlight`为您提供所有定义的组及其颜色值。

# xml - 包括限制作为属性

> ID：15554996
> 
> 赞同：1
> 
> 时间：2013-03-21T18:10:14.683
> 
> 标签：xml, xsd, restriction

我有一个问题：是否可以将限制设置为属性？例如：

```
<xs:element name="test">
 <xs:complexType>
  <xs:sequence minOccurs="0" maxOccurs="1">
    <xs:element name="elem1" type="xs:integer" minInclusive="0" maxInclusive="3"/>
    <xs:element name="elem2" type="type="xs:normalizedString" minlength="1" maxlength="7"/>
  </xs:sequence>
 <xs:complexType>
<xs:element> 
```

它似乎不起作用，但我有很多“elems(x)”，我想避免为每个 sympletype 定义，包括限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:51:56.330

不，不可能像您所描绘的那样；相反，您可以做的是定义一个全局（命名）简单类型来捕获您想要的约束，然后在您想要的地方引用它，就像您使用内置类型一样。

```
<xsd:simpleType name="tt">
   <xsd:restriction base="xsd:normalizedString">
      <xsd:minLength value="1"/>
      <xsd:maxLength value="7"/>
   </xsd:restriction>
</xsd:simpleType>

<xsd:element name="elem2" type="tt"/> 
```

# java - 在 java 程序中嵌入外部程序

> ID：15554999
> 
> 赞同：2
> 
> 时间：2013-03-21T18:10:20.793
> 
> 标签：java

我正在 Jabref（参考管理软件）中实现一个补丁：我想在其中嵌入一个 pdf 阅读器。此功能已在 Mendeley 和 Papers 中完成，如果您可以直接在 Jabref 中阅读/标记 pdf，这将非常有用。

我不想编写 pdf 查看器，而是想在 Jabref 中嵌入外部程序，例如 Adob​​e Reader 或 Ubuntu 中的 PDF Document Viewer。有没有办法做到这一点？