# StackOverflow 问答 15798000-15798999

# sql - 将新列添加到视图中的派生表

> ID：15798003
> 
> 赞同：0
> 
> 时间：2013-04-03T20:58:49.543
> 
> 标签：sql, sql-server, tsql, sql-view, derived-table

我试图弄清楚如何在不修改基础表的情况下将新列添加到视图中的派生表。让我解释一下我必须做什么：

我需要将简化的 MQSA 模块添加到在 SQL Server 上运行的现有 RIS 应用程序中。我需要显示一份患者名单，这些患者的乳房 MRI 外行信件应邮寄，每 11 个月发生一次。一旦列表上的项目被打印出来，它需要从列表中掉下来，直到它再次到期。

为此，我需要一个额外的列来记录上次打印日期。如果当前日期与上次打印日期之间的天数大于 334 天，则需要在列表中显示。

我的问题是我不允许修改现有的数据库，所以我必须在一个新的表中，在一个单独的数据库中拥有这个列。我在这个单独的数据库中创建了一个视图，其中包含来自现有数据库的表，它为我提供了正确格式的未过滤数据列表。

我在新数据库中添加了一个表，该表记录了打印列表中的项目时的相关 ID 和最后打印日期。我已将此新表添加到视图中，其中一个表具有左外连接，并检查了最后打印日期列，以便成为结果列表的一部分。

我不知道如何将新表与视图结合在一起，以仅显示应打印的普通字母。新表当然是空的，其中还没有数据，因为还没有打印任何内容。只是出于好奇，我已经手动将数据（两列 id）复制到新表中，以测试它是否可以工作，并且确实可以正常工作，并按预期工作。

如果我能以某种方式将视图中的数据复制到这个新表中，它会自动更新以反映视图中的变化，我可以像这样轻松完成我的任务：

```
SELECT 
    PersonID, 
    PatientID, 
    ModalityID, 
    ReportID, 
    FirstName, 
    LastName, 
    HomePhone, 
    WorkPhone,
    LastPrintDate, 
    CONVERT(VARCHAR(10), SignedDate, 101) AS SignedDate 
FROM 
    mqsa.dbo.vw_mq_LayLetterAlerts_Derived 
WHERE (ModalityID = 4) 
    AND (GETDATE() >= DATEADD(day, 334, LastPrintDate)) 
```

我对触发器了解不多，所以我不知道这是否是一种选择，因为我正在使用一个包含多个表的视图。

任何想法，将不胜感激。我只需要知道我应该从哪个方向开始我的研究。

谢谢！

编辑：也许我的问题应该是如何镜像另一个数据库中的表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:55:52.807

为什么不直接加入旧数据库中的视图？

```
select <cols>
from olddb..vw_OLDVIEW left outer join
     newdb..PrinterTable
     on <whatever>
where <filters> 
```

您也可以将其包装在新数据库的视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:58:34.753

如果 LastPrintDate 为空，则通过修改我现有的查询以使用 SignedDate 解决了该问题。谢天谢地，我不需要复制任何东西或做任何异国情调的事情。答案一直摆在我面前，我看不到。

# asp.net-mvc - ASP.NET MVC（剃刀）部署

> ID：15798008
> 
> 赞同：0
> 
> 时间：2013-04-03T20:59:16.487
> 
> 标签：asp.net-mvc, dll, deployment, compilation, code-behind

我有一堆 ASP.NET MVC 页面要部署，但发现部署 dll 在破坏其他控制器代码方面可能会有风险。有没有办法像我在 Web 表单中那样使用代码文件而不是代码隐藏格式来构建我的代码，这样我就不需要移动 dll，它会根据移动的代码中的更改进行编译？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:10:23.510

您被错误地告知。

在这两种情况下都会进行编译。通常最好在部署之前发布一个网站，这样 ASP.NET 就不会花时间将 C# 编译成程序集。如果您在目标机器上安装了正确的框架，则预编译代码应该没有任何问题。

其实部署代码还有更多的问题：

*   可以从生产中访问纯源代码，增加了知识产权盗窃的风险
*   由于代码编译，第一个请求需要更长的时间来处理
*   您无法确定代码中是否存在任何编译时错误

# jquery - 如何使鼠标滚轮滚动溢出：自动 div 而不是焦点？

> ID：15798013
> 
> 赞同：0
> 
> 时间：2013-04-03T20:59:24.217
> 
> 标签：jquery, jquery-ui

我制作了一个 jQuery-UI 菜单，当鼠标悬停在 div 中时，它会显示每个选项的描述。我想这样做，以便用户可以使用鼠标滚轮滚动描述 div，同时保持菜单项突出显示以便于导航。您可以在此处查看实际代码：http: [//jsfiddle.net/ManOrMonster/Da97r/](http://jsfiddle.net/ManOrMonster/Da97r/)

```
$(function () {
  $('#menu').menu();
  $('.choice').mouseover(function () {
    var val = $(this).attr('id');
    if (val == 1) {
        desc = "This is the value of choice 1\. It is a particularly good choice, unless you are not into 1, in which case this choice is probably not the best. Perhaps 2 or 3 would be a better choice for your tastes?";
    } else if (val == 2) {
        desc = "This is the value of choice 2\. While not as interesting a choice as 1 or 3, simply because it is merely middle-of-the-road, it does have several advantages. Firstly, it is twice as many as 1\. Secondly, it is not as bloated as 3, by virtue of being 1 less than said choice.";
    } else {
        desc = "This is the value of choice 3\. Some people are not satisifed with 1\. For others, 2 simply won't do. To please both of these categories of persons of discriminating tastes, 3 was introduced. Like its forerunners, it is exactly 1 more than the one preceding it; however, unlike those who precede it, it is only 1 less than 4, which is regrettably not a choice at all.";
    }
    $("#description").html(desc);
  });
}); 
```

**更新**

我最终得到的是以下内容：

```
$('body').mousewheel(function(event, delta) {
    if (delta > 0){ // scroll direction is up
        $("#description").mCustomScrollbar("scrollTo","top",{scrollInertia:3000});
    } else {
        $("#description").mCustomScrollbar("scrollTo","bottom",{scrollInertia:3000});
}
}); 
```

这使得滚动足够顺畅，以便用户可以控制它，即使它会在单次滚动后继续滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:12:44.907

您可以使用此插件：[http](http://brandonaaron.net/code/mousewheel/docs) ://brandonaaron.net/code/mousewheel/docs来检测鼠标滚轮，然后获取`scrollTop`div 并手动滚动它。可能看起来像这样：

```
$('body').mousewheel(function(event, delta) {
    var thisTop = $("#description").scrollTop();
    if (delta > 0){ // scroll direction is up
        $("#description").scrollTop(thisTop - delta);
    }
    else {
        $("#description").scrollTop(thisTop + delta);
    }
}); 
```

**编辑**

你的插件有一个`scrollTo`方法可以用来代替`scrollTop`. 尝试替换此代码：

```
$("#description").scrollTop(thisTop - delta); 
```

有了这个：

```
$("#description").mCustomScrollbar("scrollTo",thisTop - delta); 
```

# visual-studio-2010 - 将非代码目录链接到 TFS

> ID：15798014
> 
> 赞同：0
> 
> 时间：2013-04-03T20:59:28.543
> 
> 标签：visual-studio-2010, tfs, solution, checkin

我正在使用 TFS 来管理我的解决方案——其中一个项目包含一个包含一些文件和更多子目录（包含更多文件：P）的目录。其中一些文件是代码，有些不是。

关键是我想让 Visual Studio 将此文件夹视为项目的一部分（及其所有内容） - 并将其上传到 TFS（以便获得最新版本的解决方案/项目的任何人都可以使用它）。如果不作为项目的一部分，部分解决方案也足够好。

这实际上是我的问题 - 怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:06:06.237

您可以通过源代码管理资源管理器（团队资源管理器的一部分）上传它，或者您可以右键单击文件夹（如果未显示，请确保您在解决方案资源管理器中打开了“显示所有文件”）并单击包含在项目中。

包含在项目中具有一个优点 - 内容与解决方案一起下载（单击获取最新版本时）。如果该文件夹未包含在项目中，而仅位于 TFS 下，则您必须在源代码管理资源管理器中手动“获取最新版本”。

# css - Moz 渲染底部属性与 Webkit 不同

> ID：15798017
> 
> 赞同：0
> 
> 时间：2013-04-03T20:59:32.910
> 
> 标签：css, browser, mozilla

尝试在此[站点](http://mtthwbsh.com/sta499)上使用以下 CSS 在悬停时显示 H3 ：

```
 a > h3 {
 min-width: 100% !important;
 min-height: 100px;
 max-height: 100px;
 display: block;
 position: absolute;
 bottom: -80px;
 color: #FFF;
 padding: 25px 5px;
 box-sizing: border-box;
 -webkit-transition: all 300ms ease-in;
 -moz-transition: all 300ms ease-in;
 -ms-transition: all 300ms ease-in;
 -o-transition: all 300ms ease-in;
 transition: all 300ms ease-in;

 a:hover > h3 {
 bottom: 0;
 } 
```

出于某种原因，这在 Firefox 中的呈现方式与在 Chrome 和 Safari 中的呈现方式不同。看起来是底部属性的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:34:18.663

出于某种原因，Safari 将“最小宽度”计算为 250 像素，将 Firefox 计算为 100%！

所以盒子布局在 safari (ok) 中是 250x100，但在 Firefox 中是 240x50。这可能是问题所在。100% 来自哪里（可能在同位素的 js 文件中的某个地方？）

# wpf - 对 VM 上的直通属性进行 WPF MVVM 验证

> ID：15798019
> 
> 赞同：0
> 
> 时间：2013-04-03T20:59:40.910
> 
> 标签：wpf, validation, mvvm

我正在尝试使用 IDataErrorInfo 在 WPF+MVVM 中进行验证。我按照 MSDN 文章介绍了如何实现它。问题是我如何处理 VM 上的传递属性？

例如，

```
public class A : INotifyPropertyChanged, IDataErrorInfo
{
    protected string _Name;
    public string Name
    {
        get
        {
            return _Name;
        }
        set
        {
            _Name = value;
            OnPropertyChanged("Name");
        }
    }

    public string this[string propertyName]
    {
        get
        {
            string result = null;

            if (propertyName == "Name")
            {
                if (Name == "ABC")
                {
                    result = "Name cannot be ABC";
                }
            }

            return result;
        }
    }
}

public class ViewModel : INotifyPropertyChanged
{
    A a = new A();

    public string ModelName
    {
        get
        {
            return a.Name;
        }
        set
        {
            a.Name = value;
            OnNameChanged();
            OnPropertyChanged("ModelName");
        }
    }
}    

<TextBox Name="txtName" Text="{Binding Path=ModelName, ValidatesOnDataErrors=True}" /> 
```

我必须在视图模型上做什么，这样我就不必在视图模型上再次重新验证 Name 属性？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:22:04.613

验证发生在具有绑定集的类上。在您的情况下，它是`ViewModel`. 如果您必须通过属性，那么只需实现`IDataErrorInfo`on the`ViewModel`并使其通过

//视图模型

```
public string this[string propertyName]
{
    get
    {
        if (propertyName == "ModelName")
        {
            return a["Name"];
        }

        return null;
    }
} 
```

我不知道在你的情况下没有`IDataErrorInfo`的`ViewModel`方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T06:59:18.390

您需要的是通过您的 ViewModel 公开您的整个 A 类。

这篇博文（并不完美，但）展示了一种简单的方法：[http ://www.eidias.com/Blog/2012/7/2/simple-validation-in-wpf-mvvm-using-idataerrorinfo](http://www.eidias.com/Blog/2012/7/2/simple-validation-in-wpf-mvvm-using-idataerrorinfo)

此外，您还对如何显示此主题的错误进行了有趣的讨论：[MVVM 模式、IDataErrorInfo 和绑定以显示错误？](https://stackoverflow.com/questions/1123062/mvvm-pattern-idataerrorinfo-and-binding-to-display-error)

# java - arraylist 中的所有对象都具有相同的值

> ID：15798022
> 
> 赞同：1
> 
> 时间：2013-04-03T20:59:48.610
> 
> 标签：java, arraylist, entity, slick2d

我要做的就是创建一个简单的 Java 程序，它有一个充满对象的数组列表，在本例中是弹跳球，可以添加到游戏中。我希望它工作的方式是，你启动程序，它是一个空白屏幕。你按下空间，它会产生一个从侧面反弹的球，通过按下空间它会产生更多的球。我遇到的问题是当我添加更多球时，它会将数组列表中的每个项目设置为相同的 x 和 y 坐标。我正在使用 slick2D 库，但我认为这不是问题所在。

这是程序的主要部分

```
public static ArrayList<EntityBall> ballList;

    @Override
    public void init(GameContainer gc) throws SlickException {
        ballList = new ArrayList<EntityBall>();
    }

    @Override
    public void update(GameContainer gc, int delta) throws SlickException {
        String TITLE = _title + " | " + gc.getFPS() + " FPS" + " | " + ballList.size() + " entities";
        frame.setTitle(TITLE);

        Input input = gc.getInput();

        if (input.isKeyPressed(Input.KEY_SPACE)) {
            addBall();
        }
    }

    public void render(GameContainer gc, Graphics g) throws SlickException {
        for(EntityBall e : ballList) {
            e.render(g);
        }
    }

    public static void addBall() {
        ballList.add(new EntityBall(getRandom(0, _width - ballWidth), getRandom(0, _height - ballWidth), 20, 20));
    }

    public static int getRandom(int min, int max) {
        return min + (int) (Math.random() * ((max - min) + 1));
    } 
```

这是 EntityBall 类

```
package me.Ephyxia.Balls;

import org.newdawn.slick.Color;
import org.newdawn.slick.Graphics;

public class EntityBall {

    public static int x;
    public static int y;
    public static int height;
    public static int width;

    public EntityBall(int x, int y, int width, int height) {
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
    }

    public void render(Graphics g){
        g.fillOval(x, y, width, height);
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T21:01:11.660

出现问题是因为您的实例变量`x`,`y`等`EntityBall`是`static`，这意味着整个类中的每个变量只有一个值。每次创建新实例时，这些值都会被覆盖。`static`从 中的字段声明中删除`EntityBall`，以便创建的每个球都有不同的值。

# c++ - C++ - 读入用逗号分隔的文件行

> ID：15798025
> 
> 赞同：4
> 
> 时间：2013-04-03T21:00:09.343
> 
> 标签：c++, ifstream, getline, comma

我尝试查找我正在尝试做的事情，但我无法具体找到我正在尝试做的事情。我有一个包含多行的文本文件，如下所示：

```
12345,12345,12.34,12345,12345 
```

每一行的格式都相同，我想获取每一行并将数字插入某些变量。像这样的东西：

```
file >> int1 >> int2 >> double1 >> int3 >> int4; 
```

但这对我来说很难做到，因为每个数字都用逗号分隔。当有一个“空格”时，我曾经能够做到这一点，但逗号真的让我失望。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T21:10:39.913

```
char ch;
file >> int1 >> ch >> int2 >> ch >> dbl >> ch >> int3 >> ch >> int4; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-03T21:07:39.707

您可能想尝试[fscanf](http://www.cplusplus.com/reference/cstdio/fscanf/)。

像这样的东西？

```
 fscanf(filepointer, "%d,%d,%f,%d,%d\n", &int1, &int2, &double1, &int3, &int4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:30:33.060

早期的建议效果很好。但是，如果您可以使用 c++11 并且需要更强大的解决方案，我建议您使用 c++11 正则表达式库：[http ://en.cppreference.com/w/cpp/regex](http://en.cppreference.com/w/cpp/regex)

# bash - bash：while循环中的布尔值

> ID：15798028
> 
> 赞同：0
> 
> 时间：2013-04-03T21:00:19.507
> 
> 标签：bash, scripting

这可能是一个非常简单/愚蠢的问题，但我不明白为什么我在运行它时没有得到预期值：

```
FOUND_FRONTDEV=false

echo "$PATHS" |
  while IFS= read -r line
do
    FOUND_FRONTDEV=true
    echo "$FOUND_FRONTDEV"
    break
done

echo "$FOUND_FRONTDEV" 
```

它返回“真”然后“假”。看起来变量是本地的，但它不应该是。我真的很困惑为什么我的第二个回声打印错误。请问有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:14:30.963

You have to change the while loop so that the `echo` part is run in a subshell and not the while loop itself. When the variable is changed in a subshell it is only changed there and not changed within the context of the parent shell.

So try:

```
FOUND_FRONTDEV=false

while IFS= read -r line ; do
    FOUND_FRONTDEV=true
    echo "$FOUND_FRONTDEV"
    break
done < <(echo "$PATHS")

echo "$FOUND_FRONTDEV" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-03T21:12:31.407

由于您的管道，bash 在子shell 中执行循环，因此它不会影响其外部的环境。您可以通过更改`echo | while ...`来解决此问题`while ... done <<<$PATHS`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-03T21:10:48.213

while 循环部分在子shell 中执行。因此，您所做的更改`FOUND_FRONTDEV`在父 shell 中不可见，因为`FOUND_FRONTDEV`一旦子 shell 退出，while 循环内部就会消失。

# java - 执行本机更新查询后，检索到的实体中仍然存在旧值

> ID：15798030
> 
> 赞同：1
> 
> 时间：2013-04-03T21:00:29.430
> 
> 标签：java, jpa, entity, eclipselink, nativequery

我正在使用本机查询来更新带有注释的 HashMap 中某个键的值`@ElementCollection`。

执行查询后，将使用 检索包含 HashMap 的完整实体`EntityManager.find(...)`。问题是，检索到的实体中的 HashMap 仍然包含旧值。

如何使用更新的 HashMap 获取实体？是否需要刷新缓存？我正在使用 Eclipse 链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T13:03:43.087

我假设您启用了缓存（默认）。所以你需要调用 refresh() 来刷新对象。

否则，您可以禁用共享缓存，但如果您在 EntityManager 的上下文中执行此操作，则仍然需要刷新或清除持久性上下文才能看到更改。

见， [http://wiki.eclipse.org/EclipseLink/Examples/JPA/Caching#How_to_refresh_the_cache](http://wiki.eclipse.org/EclipseLink/Examples/JPA/Caching#How_to_refresh_the_cache)

# file - 如何将带有特殊字符的文件名转换为有效的文件名？

> ID：15798031
> 
> 赞同：3
> 
> 时间：2013-04-03T21:00:34.680
> 
> 标签：file, sharepoint, powershell, recursion, filenames

我想知道是否可以从整个目录结构中的所有文件中递归地删除 powershell 中的特殊字符？

例如，如果我有一个名为：

```
my presentation (fix).xlsx 
```

我想将其重命名为：

```
my presentation fix.xlsx 
```

谢谢你的指导。

我们需要这样做的原因是我们正在将许多文件迁移到 sharepoint 2010 中，而 sharepoint 不喜欢带有特殊字符的文件！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T21:11:23.883

我没有测试过这段代码，但我想你可能想要类似的东西：

```
Function Rename-Files($path)
{
 Get-ChildItem -path $path | 
 Foreach-Object { 
      $newName = $_.name -replace '[^A-Za-z0-9-_ \.\[\]]', ''
      if (-not ($_.name -eq $newname)){
        Rename-Item -Path $_.fullname -newname ($newName) 
      } 
 }
} #end function

Rename-Files -path "C:\somepath" 
```

实际上，只需遍历目录*（将函数修改为递归）*，然后替换任何不适当*的（修改正则表达式以获得适当的）*字符并将它们替换为空*（有效地将它们剥离）*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T22:29:34.723

以下命令将递归遍历您的目录结构匹配，并且对于匹配的每个文件或目录，通过使用 powershell 运算符将每个有问题的字符替换为空字符来对该文件执行重命名`-replace`。

请注意，您必须创建一个与您希望过滤的所有常规字符匹配的正则表达式。为了匹配您提供的示例并删除圆括号，正则表达式将是：

```
$re = "[()]" 
```

如果要添加方括号，则必须使用反斜杠对其进行转义：

```
$re = "[\[\]()]" 
```

只需根据需要在外部方括号之间添加字符：

```
$re = "[\[\]()!]" 
```

这是脚本，请注意一点舞蹈，以便`-replace`操作员在每次迭代时只作用于名称的基础部分：

```
dir -Recurse | ?{$_.Name -match $re}  | %{ren -literalpath $_.FullName -newname (join-path (get-item $_.PSPArentPath) $($_.Name -replace $re,""))} 
```

一些注意事项：

*   该命令的`-LiteralPath`参数`ren`需要能够用方括号替换文件：[] 它仅在 Powershell v3 IIRC 中可用。
*   重命名后您可能会遇到名称冲突，此脚本无法处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T21:14:24.627

可以尝试尝试这样的事情：

```
gci * | % {$newname = $_.name -replace '\(|\)|{|}'  
           if (-not ($_.name -eq $newname)){
               rename-item $_.name $newname
           }
          } 
```

以上将修复文件，如：

我的演示文稿（修复）.xlsx

测试 {ddd}.ps1

# mysql - 如何更正这个 mysql_query，使用正确的语法并使其工作？

> ID：15798035
> 
> 赞同：0
> 
> 时间：2013-04-03T21:00:42.707
> 
> 标签：mysql, sql, syntax, where, min

我已经在[这里](https://stackoverflow.com/questions/15779416/error-while-trying-to-check)提出了一个问题。但是由于我没有得到对我有很大帮助的答案，所以我想再问一次。

```
 In Database [1]
    Table Characters
+----+------------------+-------+---------+
|account_name| lastaccess| online| voted  |
+------------+-----------+-------+--------+
| Account1   | 1231321231|   1   |    1   |
| Account1   | 132312213 |   0   |    0   |
| Account3   | 13231212  |   0   |    0   |
+------------+-----------+-------+--------+
    In Database [2]
    Table Accounts
+----+------------------+
|   Login   | lastIp    | 
+-----------+-----------+
| Account1  | 0.0.0.0.0 |
| Account1  | 0.0.0.0.0 |
| Account3  | 0.0.0.0.0 |
+-----------+-----------+ 
```

我已经有一个函数可以获取 lastIP 帐户的位置。

```
function getclientip()
    {
        if ( isset($_SERVER["REMOTE_ADDR"]) )    { 
            return $_SERVER["REMOTE_ADDR"]; 
        } else if ( isset($_SERVER["HTTP_X_FORWARDED_FOR"]) )    { 
            return $_SERVER["HTTP_X_FORWARDED_FOR"] ; 
        } else if ( isset($_SERVER["HTTP_CLIENT_IP"]) )    { 
            return $_SERVER["HTTP_CLIENT_IP"] ; 
        }
            return "0.0.0.0";
    }
$Ip=getclientip();
$sql='SELECT login FROM accounts WHERE lastIp like \''.$Ip.'\';';
echo mysql_error();
$result = mysql_query($sql);
if (false === $result) {
}
while($row = mysql_fetch_array($result))
{ 
```

我想做的是：

```
mysql_query('update characters SET voted=1 where account_name like \''.$row['login'].'\' and online=1;') ; 
```

但`MIN(lastaccess)`只在哪里。我希望你明白我的意思，在其他情况下问我我会解释得更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:24:42.887

很好，我会跳过你的功能，因为远程地址总是可用的。

```
$Ip = $_SERVER['REMOTE_ADDR'];
$sql= mysqli_query( $database, "SELECT login FROM accounts WHERE lastIp = '$ip' ");

while($row = mysqli_fetch_assoc($sql)) {
    if(mysqli_query("UPDATE characters SET voted = '1' WHERE account_name = "'.$row['login'].'" AND online = '1'")) {
       print 'updated succesfully';
    } else {
        print 'update did not complete';
    }
} 
```

我不会评论你的行为，我只想说这是你从我这里得到的唯一答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:08:04.770

我尝试为您解释我的答案，以便更好地理解并删除易混淆的部分：

我保留了这部分代码：

```
function getclientip()
    {
        if ( isset($_SERVER["REMOTE_ADDR"]) )    { 
            return $_SERVER["REMOTE_ADDR"]; 
        } else if ( isset($_SERVER["HTTP_X_FORWARDED_FOR"]) )    { 
            return $_SERVER["HTTP_X_FORWARDED_FOR"] ; 
        } else if ( isset($_SERVER["HTTP_CLIENT_IP"]) )    { 
            return $_SERVER["HTTP_CLIENT_IP"] ; 
        }
            return "0.0.0.0";
    }
$Ip=getclientip(); 
```

现在您可以将这行 sql 与您的更新代码行连接起来：这行

```
$sql='SELECT login FROM accounts WHERE lastIp like \''.$Ip.'\';'; 
```

这行：

```
mysql_query('update characters SET voted=1 where account_name like \''.$row['login'].'\' and online=1;') ; 
```

你在你的问题中写的，现在加入这部分的结果是：

```
$sql='UPDATE characters SET voted=1 where online=1 AND account_name IN (SELECT login FROM accounts WHERE lastIp like \''.$Ip.'\');'; 
```

现在你只想更新 MIN(lastaccess) 那么你可以使用这个查询，因为我按 lastaccess 排序升序行，它的平均值从 lastaccess 列的低到高然后选择这行的顶部，换句话说，我选择一个具有最小 lastaccess 的行，然后我将其传递给 set voted=1 的更新命令：

```
UPDATE characters SET voted=1 where online=1 AND account_name IN
(SELECT login FROM accounts WHERE lastIp like \''.$Ip.'\' ORDER BY lastaccess ASC LIMIT 1); 
```

并且您可以使用临时表并使用 MIN 函数：

```
UPDATE characters SET voted=1 where online=1 AND account_name IN
(SELECT tempTable.login FROM (SELECT login, MIN(lastaccess) FROM accounts WHERE lastIp like \''.$Ip.'\' GROUP BY login) tempTable; 
```

并且不要忘记您的结果没有任何行，因为它的更新命令..

```
mysql_query('UPDATE characters SET voted=1 where online=1 AND account_name IN
    (SELECT login FROM accounts WHERE lastIp like \''.$Ip.'\' ORDER BY lastaccess ASC LIMIT 1);'); 
```

或者

```
mysql_query('UPDATE characters SET voted=1 where online=1 AND account_name IN
(SELECT tempTable.login FROM (SELECT login, MIN(lastaccess) FROM accounts WHERE lastIp like \''.$Ip.'\' GROUP BY login) tempTable;'); 
```

我希望，是你需要的。

# c# - 如何拦截/覆盖.net 可执行文件中的函数调用？

> ID：15798037
> 
> 赞同：4
> 
> 时间：2013-04-03T21:00:49.243
> 
> 标签：c#, .net, windows, clr, api-hook

我想在 .net 可执行文件（我无权访问源代码的第三方可执行文件）中拦截 CLR 函数调用以进行调试。我一直在研究一些挂钩 api（deviare、easyhook、mhook）等，但我认为它们只支持挂钩到 dll 中的简单函数，例如 xxx.dll!functionname，并且不能记录对对象的构造函数调用等。我想要知道它们是否是能够轻松记录.net 可执行文件中的函数调用的任何库，例如如果一个进程调用该函数，`File.ReadAllText(@"C:\name.txt");`我将使用参数 c:\name.txt 记录函数 File.ReadAllText。

以下是一些我尝试过/看过但没有做我想做的事情。

偏差

姆胡克

易钩

微软痣

*Redgate Ants Profiler（这个非常接近。它记录所有 clr 函数调用，我只需要它来记录参数。如果你知道这将如何解决我的问题）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T02:50:50.587

如果它是 .net 可执行文件并且您拥有修改它的合法权利，您可以使用带有修改插件的反射器来更改源代码中的任何内容并重新编译它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T14:21:52.357

Deviare 支持按地址挂钩。你可以看到这篇文章：http: [//blog.nektra.com/main/2013/03/27/how-to-identify-virtual-table-functions-with-the-vtbl-ida-pro-plugin/](http://blog.nektra.com/main/2013/03/27/how-to-identify-virtual-table-functions-with-the-vtbl-ida-pro-plugin/)

在那里，我们完成了一个没有源代码或任何其他信息源（如 PDF、RTTI 等）的进程的完整 vtable 挂钩。

将来我们将添加 .NET 挂钩。这是我们的计划，但我们没有时间实施。

# c++ - C++ 为什么我可以从驱动类调用基类的私有虚函数？

> ID：15798040
> 
> 赞同：1
> 
> 时间：2013-04-03T21:01:01.583
> 
> 标签：c++, function, inheritance, virtual, private

Herb Sutter 的著名文章[Virtuality](http://www.gotw.ca/publications/mill18.htm)指出：

> **准则#2：更喜欢将虚函数设为私有**。
> 
> 这很容易。这使派生类可以覆盖函数以根据需要自定义行为，而无需通过使派生类可调用虚函数来直接公开虚函数（如果函数刚刚受到保护，则可能如此）

在下面的代码中，private_base_func()是在基类中声明的私有虚函数，并在驱动类构造函数中调用，奇怪的是，这段代码编译得很好，它从驱动类中调用了基类的私有虚函数，它与上述说法相矛盾。这让我很困惑。

```
class base
{
public:

    base() {}
    virtual ~base(){}

private:
    virtual void private_base_func() 
    { 
        std::cout << "Base Class invoke" << std::endl;
    }

};

class drived : public base
{
public:
    drived()
    {
        private_base_func(); // this line should not compile
    }

private:
    // Overriding base class virtual function
    void private_base_func() 
    { 
        std::cout << "Drived class invoke" << std::endl;
    }
};

int main()
{
   base* ptr = new drived();
   return 0;
} 
```

提前感谢您的回复

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T21:03:49.280

那是因为您正在调用`drived`的版本`private_base_func`，当然可以在`drived`. 不能调用的函数是`base`的版本：

```
drived()
{
    base::private_base_func(); // this line will not compile
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:04:37.257

```
 private_base_func(); // this line should not compile 
```

怎么会这样？`private_base_func`是一个`private`函数 in`drived`并且该行在 inside `drived`，所以调用它是完全可以的。请注意，这不同于：

```
drived()
{
    base b;
    b.private_base_func(); // this line does not compile
} 
```

无论如何，这不是这篇文章的内容。文章的重点是基类中定义了两个不同的接口。一个是公共接口，它提供了您的基地用户需要的操作。另一个是一组虚函数，它定义了扩展提供给基类​​的操作。通过分离这两个接口，您可以将用户与提供者分离并获得灵活性。

# java - 在 ArrayList 中使用 contains 方法

> ID：15798043
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:01:10.307
> 
> 标签：java, arraylist

我正在尝试在 ArrayList 中使用 contains 方法，我在其中存储了 Employee 类型的对象。但是当我使用这个方法时，即使我在 Employee 类中实现了 equals 方法，它总是返回 false

这是我尝试过的：

**员工等级**：

```
public class Employee {
   .
   .
   .
@Override
public boolean equals(Object o){

  if(o instanceof Employee)
  {
    Employee e = (Employee) o;
    return this.id==(e.id);
  }
    return false;
 }

   @Override
    public int hashCode() {
      int hash = 7;
      hash = 79 * hash + (int) (this.id ^ (this.id >>> 32));

      return hash;
  } 
```

**测试类**：

```
public class Test {

LinkedList <Employee>list=new LinkedList <Employee>();
Employee e=new Employee();
long id=0;

     e.setId(20710456);
     list.add(e);

      e.setId(30560432);
     list.add(e);

public void Edit()
{       
         id=Integer.parseInt(JOptionPane.showInputDialog(null,"Enter the id of the 
          employee"));

          e.setId(id);

            System.out.print(list.contains(e.getId()));

    if(list.contains(e.getId())){
                 .
                 .
                 //rest of the code

            }
    }
 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T21:03:09.340

您正在呼叫`list.contains(e.getId())`，但该列表不包含 ID 号 - 它包含`Employee`s。我怀疑你的意思`list.contains(e)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:04:01.527

你应该调用 list.contains(e)。该列表包含员工而不是员工 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:07:22.290

只需在您的列表上循环进行比较

例如：

```
for (Employee em: list){
  if(em.getId()=e.getId()){
//your logic
  }
} 
```

# c - C - sprintf() 影响数组声明

> ID：15798048
> 
> 赞同：2
> 
> 时间：2013-04-03T21:01:20.857
> 
> 标签：c, arrays, printf

首先，我是 C 新手，但不是编程；我在 PHP 中做了很多 Web 开发。对于这个问题...

我有一个函数可以读取一系列二进制文件并输出内容，但是使用`sprintf()`会影响后面多维数组的内存分配。见下文：

```
FILE *fp;

for(int i = 1; i <= 16; i++) {

    char format_1[] = "track_%d.bin";
    char filename_1[sizeof format_1+100];
    sprintf(filename_1,format_1,i);
    printf("Filename: %s \n", filename_1);
    fp = fopen(filename_1, "rb");

    if(fp) {
        fseek(fp, 0L, SEEK_END);
        int sz = (ftell(fp) / 3) - 1;
        fseek(fp, 0L, SEEK_SET);

        printf("File size: %d\n", sz);

        int nums[sz][3];

        fread(nums,sizeof(int),sz * 3, fp);

        for (int k = 0; k < sz; k++) {
            printf("Entry number %d = %d with extra values of %d and %d\n", k, nums[k][0], nums[k][1], nums[k][2]);
        }
    } else {
        printf("Skipping \n");
    }

    fclose(fp);
} 
```

我知道这是 sprintf() 导致问题的原因，因为我将函数简化为：

```
printf("Please enter file number... \n");
scanf("%d%c", &num_file, &term);

printf("Please enter how many instances in this file... \n");
scanf("%d%c", &num_instance, &term);

int nums[num_instance][3];

char format_1[] = "track_%d.bin";
char filename_1[sizeof format_1+3];
sprintf(filename_1,format_1,num_file);
printf("Filename: %s \n", filename_1);

fp = fopen(filename_1, "rb");

fread(nums,sizeof(int),num_instance * 3, fp);
fclose(fp);

for (int k = 0; k < num_notes; k++) {
    printf("Entry number %d = %d with extra values of %d and %d\n", k, nums[k][0], nums[k][1], nums[k][2]);
} 
```

当我将 nums 的声明移到 sprintf() 上方时，只要我将 nums 的声明移到 sprintf() 下方，它就可以正常工作（即使它就在它上方），输出如下所示：

```
Entry number: 0 = 71 with extra values 116 and 158
Entry number: 1 = -1073743712 with extra values -1073744240 and -1073744304
Entry number: 2 = -1073743896 with extra values 59983 and -1073744005 
```

从上面的代码片段可以看出，我需要在`nums`下面声明，`sprintf()`因为我需要知道文件中的条目数。

编辑：我想如果我提到一个文件包含一个多维数组可能会有所帮助：`array[x][3]`.

真的很难过这一点，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:33:53.930

您的基本问题是您正在计算文件的大小（以字节为单位），然后尝试从文件中读取那么多整数。由于整数（在大多数机器上）是 4 个字节，这将失败，并且您只会读入`nums`数组的第一季度。其余的将包含（并打印为）随机垃圾，这就是您所看到的。

您应该检查 的返回值`fread`以确保它有意义。如果您将代码更改为

```
int numread = fread(nums,sizeof(int),sz * 3, fp);
printf("Read %d integers from file\n", numread);
for (int k = 0; k < sz; k++) {
    if (k < numread/3) {
        printf("Entry number %d = %d with extra values of %d and %d\n", k, nums[k][0], nums[k][1], nums[k][2]);
    } else {
        printf("Entry number %d doesn't exist in the file\n", k);
    }
} 
```

你会立即看到问题。

始终检查您的返回值。

# javascript - 使用下拉按钮引导预输入

> ID：15798055
> 
> 赞同：2
> 
> 时间：2013-04-03T21:01:43.687
> 
> 标签：javascript, jquery, twitter-bootstrap, bootstrap-typeahead

我希望预先输入的建议菜单根据所选菜单显示不同的结果，如下结构：

```
var colors = ["red", "blue", "green", "yellow", "brown", "black"];
var numbers = ["One", "Two", "Three", "Four", "Five", "Six"];
var names = ["Ahmad", "Ali", "Hatem", "Wesam", "Nour", "Jeorge"];

$( "#search1" ).attr("autocomplete", "off");
$( "#search-fld" ).typeahead({source: colors});

$("#search-drop li a").click(function(){
    $("#search-btn").text($(this).text()); 
    if($(this).text() == 'People') {
        $( "#search-fld" ).typeahead({source: names});
    } else if($(this).text() == 'Salaries') { 
        $( "#search-fld" ).typeahead({source: numbers});
    } else if($(this).text() == 'Jobs') { 
        $( "#search-fld" ).typeahead({source: colors});
    }
}); 
```

这是[jsfiddle](http://jsfiddle.net/yabasha/mqqQZ/1/)的示例。但问题是即使我选择不同的子菜单，相同的结果也会不断出现。

我想知道如何从不同的资源加载不同的 typeahead 结果。

请指教，

================================

![动态预输入错误](https://i.stack.imgur.com/O6Wy3.png)

================================

![新错误](https://i.stack.imgur.com/nQBTJ.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:05:09.683

这应该有效：

```
$("#search-drop li a").click(function(){
        $("#search-btn").text($(this).text()); 
        if($(this).text() == 'People') {
            $( "#search-fld" ).data('typeahead').source = names;
        } else if($(this).text() == 'Salaries') { 
            $( "#search-fld" ).data('typeahead').source = numbers;
        } else if($(this).text() == 'Jobs') { 
            $( "#search-fld" ).data('typeahead').source = colors;
        }
}); 
```

# perl - 在 Perl 中定位内存泄漏时遇到问题

> ID：15798056
> 
> 赞同：1
> 
> 时间：2013-04-03T21:01:46.130
> 
> 标签：perl, memory-leaks, xml-parsing, strawberry-perl

我在这段代码中遇到了内存泄漏（我认为）：

```
if (ref($init{'time-layout'}) eq 'HASH') {
    my %time= % {$init{'time-layout'}};
    my @times= @ {$time{'start-valid-time'}};
    if (ref($init{parameters}) eq 'HASH') {
        %param= % {$init{parameters}};
        if (ref($param{'wind-speed'}) eq 'HASH') {
            %wind= % {$param{'wind-speed'}};
            @windvalue= @ {$wind{value}};
            %temp= % {$param{'temperature'}};
            @tempvalue = @ {$temp{value}};
            %wdir= % {$param{'direction'}};
            @wdirvalue = @ {$wdir{value}};
            %hum= % {$param{'humidity'}};
            @humvalue = @ {$hum{value}};
        undef %wind;
        undef %temp;
        undef %wdir;
        undef %hum;}
    undef %param;} 
```

这是来自一个 sub，输入来自[XMLin()](http://search.cpan.org/~grantm/XML-Simple-2.20/lib/XML/Simple.pm#XMLin%28%29)（来自[XML::Simple](http://search.cpan.org/~grantm/XML-Simple-2.20/lib/XML/Simple.pm)）。具体来说，输入是（如果重要的话）

```
http://graphical.weather.gov/xml/sample_products/browser_interface/ndfdXMLclient.php?    lat=$lat&lon=$lon&product=time-series&begin=2004-01-01T00:00:00&end=2013-04-20T00:00:00&temp=temp&wspd=wspd&rh=rh&wdir=wdir"; 
```

where`$lat`和`$lon`是纬度和经度。

代码需要几个小时才能运行将数据插入 SQL 服务器，而且在完成之前，Perl 实例占用了几 GB 或更多的 RAM。我确信这对某人来说很简单，但我充其量只是 Perl 的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T22:00:47.817

快速搜索“xml::simple memory leak”的duckduckgo 找到了Yahoo::Search 的文档，该文档声称：

> XML::Simple 在后台使用 XML::Parser，至少在我测试过的系统上，XML::Parser 遭受严重的内存泄漏，这使得它非常不受欢迎。

内存泄漏似乎可能（甚至可能）根本不在您的代码中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T00:04:26.667

`XML::Simple`**在解析大文件**时非常无效（对我来说，它*为 100Mb 文件*吃掉了3Gb 的内存）。尝试`use XML::Twig`为您的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T10:17:34.993

除了[imran](https://stackoverflow.com/users/319296/imran)的评论，

有这么多 XML cpan 模块，很难决定应该使用哪一个。

查看许多人的答案并从网络上阅读，[XML::LibXML](http://search.cpan.org/~shlomif/XML-LibXML-2.0014/LibXML.pod)看起来是一个首选模块，而不是更具体的[XML::LibXML::Reader](http://search.cpan.org/~pajas/XML-LibXML-1.70/lib/XML/LibXML/Reader.pod)用于大文件。他们中的许多人不推荐使用`XML::Simple`，并表示`XML::Simple`对小文件有好处，而在处理大 xml 文件时会出现问题。`XML::Twig`更好（从它的文档中），但即使这样也有内存泄漏问题。（参考[XML::Twig 常见问题解答](http://www.xmltwig.org/xmltwig/XML-Twig-FAQ.html)）

您还想参考[perl-xml-faq](http://perl-xml.sourceforge.net/faq/)

# javascript - javascript，为什么在播放视频时第二行无法从第一行替换？

> ID：15798057
> 
> 赞同：0
> 
> 时间：2013-04-03T21:01:49.547
> 
> 标签：javascript, jquery, html, html5-video

我希望字幕在视频上显示 2 行，这意味着当第一个文本出现在第一行时，第一行字幕将移动到第二行。不知何故，它不起作用，因为第一行和第二行打印相同的字幕。负责显示文本的函数是 $("#video").bind('timeupdate',function(){}); “text”变量应显示第一行，“second”变量应显示从第一个文本替换的第二行。我的网站示例可以在[链接](http://www.cs.rit.edu/~rskics/study/caption2/test.html)上看到（在 Firefox 上工作）。视频顶部的字幕是“秒”，视频底部的字幕是“文本”。请帮助，不要介意字幕的位置，我会在功能正常工作后修复它。

这是我的 HTML5/javascript 编码示例，

```
<html>
    <head>
        <title>HTML5 included Javascript....</title>
        <meta name="description" content="Test" charset="utf-8"></meta>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
        </script>
        <style>
            .container{position:relative;}
            .container video {
                position:absolute;
                z-index:-1;
            }
            .subtitle2 {
                position:absolute;
                width:640px;
                top:400;
                left:120;
                z-index:2000;
                color:white;
                text-shadow:black 2px 2px 6px;
                font-weight:bold;
                font-size:150%;
            }

            .second {
                position:absolute;
                z-index:2000;
                color:white;
                text-shadow:black 2px 2px 6px;
                font-weight:bold;
                font-size:150%;
            }
        </style>
        <script type="text/javascript">

                var subtitleArray = new Array(); //stored all values from XML caption file
                    var tempText = "";

                function loadXMLDoc(dname)
                {
                    if (window.XMLHttpRequest)
                    {
                    xhttp=new XMLHttpRequest();
                    }
                    else
                    {
                    xhttp=new ActiveXObject("Microsoft.XMLHTTP");
                    }
                    xhttp.open("GET",dname,false);
                    xhttp.send();

                    return xhttp.responseXML;
                }

                function getCaption()
                {
                    //alert("get caption 2");

                    var tempArray = new Array();
                    var c = document.getElementById('container');

                    captionsDoc = loadXMLDoc("captions.xml");
                    x=captionsDoc.getElementsByTagName('text');

                    for(var i=0;i<x.length;i++)
                    {
                        var tempArray = new Array();
                        tempArray[0] = x[i].getAttribute('start'); // get start time
                        tempArray[1] = x[i].getAttribute('dur'); // get duration time
                        tempArray[2] = x[i].childNodes[0].nodeValue; // get text

                        subtitleArray[i] = tempArray; //put all 3 values in array

                    }

                    //c.innerHTML = subtitleArray[0][2];

                }

                $(document).ready(function(){
                    //alert("get caption 1");
                    getCaption();

                    var subtitle2 = document.getElementById('subtitle2');

                    var video = document.getElementById('video');

                    $("#video").bind('play',function(){
                        /*
                        setInterval(function(){

                            //timer.innerHTML = $('#video')[0].currentTime;

                            var text = "", cap = "";

                            for( var i = 0; i < subtitleArray.length;i++)
                            {
                                //alert("looping");
                                //var currentTime = video.currentTime();
                                var cueStart = parseFloat(subtitleArray[i][0]);
                                var cueEnd = cueStart + parseFloat(subtitleArray[i][1]);

                                cap = subtitleArray[i][2];

                                if (video.currentTime >= cueStart && video.currentTime <= cueEnd) {
                                   text = cap;   
                                }
                                //var t = document.getElementById('timer').innerHTML = text;
                                $( "#second" ).html( prevLineText );
                                console.log( prevLineText );
                                subtitle.innerHTML = text;
                                prevLineText = text;
                                console.log( prevLineText +"\n");
                            }
                        },1);*/
                    });

                    $("#video").bind('timeupdate',function(){
                        //timer2.innerHTML = $('#video')[0].currentTime;

                        var text = "", cap = "";

                            for( var i = 0; i < subtitleArray.length;i++)
                            {
                                //alert("looping");
                                //var currentTime = video.currentTime();
                                var cueStart = parseFloat(subtitleArray[i][0]);
                                var cueEnd = cueStart + parseFloat(subtitleArray[i][1]);

                                cap = subtitleArray[i][2];

                                if (video.currentTime >= cueStart && video.currentTime <= cueEnd) {
                                   text = cap;   
                                }

                                if ( text != tempText && text != "" ) {
                                console.log( text );
                                console.log(tempText);
                                    $("#second").html(text);
                                }

                                subtitle2.innerHTML = text;
                                tempText = text;
                                console.log( tempText );

                            }
                    });
                });

            //window.onload = load;
        </script>
    </head>

    <body>
        <div id="container" class="container">

                <video id="video" width="930" height="492" controls>
                    <source src="caption.mp4" type="video/mp4">
                    <source src="caption.ogg" type="video/ogg" />
                    <source src="caption.webm" type="video/webm" />
                </video> 
                <div id= "subtitle2" class="subtitle2">
                </div>
                <div id="second" class="second">
                </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:00:34.727

我找到了解决方案，这里有一个代码，

```
var tempText = "", prevText="";

$("#video").bind('timeupdate',function(){

                        var text = "", cap = "";

                            for( var i = 0; i < subtitleArray.length;i++)
                            {

                                var cueStart = parseFloat(subtitleArray[i][0]);
                                var cueEnd = cueStart + parseFloat(subtitleArray[i][1]);

                                cap = subtitleArray[i][2];

                                if (video.currentTime >= cueStart && video.currentTime <= cueEnd) {
                                   text = cap;   
                                }

                                if (tempText != text && text != "") {

                                    prevText = tempText;
                                    $("#second").html(prevText);
                                }

                                subtitle.innerHTML = text;

                                if ( text != "" ) {
                                    tempText = text;
                                }

                            }
                    }); 
```

# javascript - 带有固定标题的 jQuery UI 自动完成

> ID：15798061
> 
> 赞同：1
> 
> 时间：2013-04-03T21:02:08.297
> 
> 标签：javascript, jquery, jquery-ui, jquery-autocomplete

我正在做一个需要“产品搜索”的项目，该项目将显示一个带有产品名称和价格的网格。

我正在使用带有 Autocomplete 小部件的 jQuery UI 来实现这一点，而且我几乎可以按照我的意愿工作。

为了显示“网格”，我通过覆盖 _renderItem 函数，每行使用浮动 div 作为假表格单元格：

```
$('#search').autocomplete().data("ui-autocomplete")._renderItem = function(ul, item){
    var line_item = '';
    line_item += "<a><div class='search_row'>";
    line_item += "<div class='sku'>"+item.sku+"</div>";
    line_item += "<div class='product_name'>"+item.label+"</div>";
    line_item += "<div class='product_price'>ET:"+item.price+"</div>";
    line_item += "</div></a>";

    return $("<li>")
    .append(line_item)
    .appendTo(ul);
}; 
```

网格限制为 400px 高度，垂直滚动。

我现在唯一的问题是我希望顶部有一些固定的标题，它们不会滚动。

我尝试使用类似的东西：

```
$('#search').autocomplete().data("ui-autocomplete")._renderMenu = function(ul, items){
    var self = this;
    $.each(items, function(index, item){
        if(index == 0){
            ul.append('<li><div style="position:fixed; background-color:blue;">TEST HEADERS</div></li>');
        }

        self._renderItem(ul, item);
    });
}; 
```

但后来我又遇到了另一组布局问题。

是否有另一种（“更本地”）的方式来做到这一点？

谢谢！

# git - 解决 git 冲突：git mergetool 不起作用

> ID：15798063
> 
> 赞同：4
> 
> 时间：2013-04-03T21:02:17.847
> 
> 标签：git, conflict, git-merge, atlassian-sourcetree

我需要解决 git 中的冲突，但作为一个新手，不知道什么是最有效的方法。

这是我的情况：

![在此处输入图像描述](https://i.stack.imgur.com/0tmwh.png)

我参与`master`其中，需要提交并推动我的所有更改。

> $ git拉：
> 
> 错误：您对“foo.cpp”的本地更改将被合并覆盖。中止。请在合并之前提交您的更改或存储它们。

有几个冲突的文件。当然，我在网上搜索过：

[如何解决 Git 中的合并冲突？](https://stackoverflow.com/questions/161813/how-do-i-fix-merge-conflicts-in-git)

不幸的是，这两种解决方案都不能很好地工作。我可能会使用 stash（获取差异并使其干净）并进行手动解析，但想使用`git mergetool`或 SourceTree。

这是我尝试过的：

```
$ git config merge.conflictstyle diff3
$ git mergetool
merge tool candidates: tortoisemerge emerge vimdiff
No files need merging
$ git mergetool -t vimdiff
No files need merging
$ git mergetool -t vimdiff foo
foo.cpp: file does not need merging
$ git diff foo.cpp
diff --git a/foo.cpp b/foo.cpp
index xxxxxx yyyyy
--- a/foo.cpp
+++ b/foo.cpp
@@ .....
..... <omitted>
$ 
```

我不确定出了什么问题。`git mergetool`不能正常工作。它说不需要合并。但是，它显示了差异并`git pull`报告了冲突。

Q1) 如何`mergetool`用于交互式冲突解决或合并？

Q2) 是否可以使用 SourceTree 来解决冲突？我试过了，但它也不直观。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T02:33:58.390

您看到的错误：

```
error: Your local changes to 'foo.cpp' would be overwritten by merge. Aborting. Please, commit your changes or stash them before you can merge. 
```

是因为你有`uncommitted changes`（它在 SourceTree 显示的最顶部这么说）。如果您有未提交的更改，任何合并尝试都**将失败。**你有三个选择：

1.  取消所有更改（使用`git reset --hard`：）
2.  存储所有更改（使用`git stash`：）
3.  提交所有更改（使用`git add ...; git commit ...`：）

完成后，您将被允许合并。如果您选择上面的选项#3，则可能会出现冲突；选项#1 或#2 不会有冲突。[注意：对于选项＃2，您将`git stash pop`稍后再做，然后可能会出现冲突。]

对于您的 Q1：做`git config merge.tool diff3`（或 vimdiff，或其他）。合并可能会造成混淆（通常是 3 路合并，因此该工具显示三个版本和一个组合版本）。

对于您的 Q2：SourceTree 不包含它自己的合并工具；你需要依赖另一个（我使用 p4merge 和 SourceTree）。使用这些配置选项：

```
difftool.sourcetree.cmd=/Applications/p4merge.app/Contents/MacOS/p4merge "$LOCAL" "$REMOTE"
difftool.sourcetree.path=
mergetool.sourcetree.cmd=/Applications/p4merge.app/Contents/MacOS/p4merge "$BASE" "$LOCAL" "$REMOTE" "$MERGED"
mergetool.sourcetree.trustexitcode=true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:09:23.707

您收到冲突消息是因为您已对远程更改的文件进行了修改，该文件将被拉入。因此，该消息将存储或提交您的更改。

如果你做这些事情中的任何一个然后拉，可能有也可能没有任何冲突需要解决。例如，如果您引入的更改与您的修改不在同一位置，则不会发生冲突。如果有合并工具应该可以处理它。

# c++ - 数组和指针有问题

> ID：15798066
> 
> 赞同：0
> 
> 时间：2013-04-03T21:02:21.997
> 
> 标签：c++, arrays, pointers, structure

我目前正在阅读一本书以刷新我对 C++ 的记忆。我正在讨论的章节与动态内存分配有关。我在做一个练习题，但在弄清楚我的程序出了什么问题时遇到了一些麻烦。问题是

“编写一个程序，让用户跟踪他们最后一次与每个朋友交谈的时间。用户应该能够添加新朋友（尽可能多！）并存储他们最后一次与每个朋友交谈的天数朋友。让用户更新这个值（但不要让他们输入像负值一样的虚假数字）。可以显示按朋友姓名排序的列表，按他们与每个朋友交谈的最近时间。 "

现在我只是想让程序正确存储用户的输入。

它在我输入 5 个朋友后崩溃，所以我猜测它是在数组上写入的，但 Resize 函数应该会处理这个问题。

他是我的密码

```
#include <iostream>
#include <cstdlib>
#include <string>

using namespace std;

struct Friend
{
  string friends;
  int days;
};

Friend Resize(Friend* p_array, int* size_of_array);

int main()
{
  struct Friend f;
  int quit = 1;
  int array_size = 5;
  int number_of_friends = 0;
  Friend *p_array = new Friend [array_size];

  while(quit != 0)
  {
      cout << "Enter a friends name.\n";
      cin >> f.friends;
      cout << "Enter the number of days sence you last saw them.\n";
      cin >> f.days;
      cout << "Enter '0' to quit the program.\n";
      cin >> quit;

      if(array_size == number_of_friends)
      {
        Resize(p_array, &array_size);
      }

      p_array[number_of_friends] = f;

      number_of_friends++;
  }

  //print the array
  cout << endl;
  for(int i = 0; i < sizeof(p_array); i++)
  {
    cout << p_array[i].friends << " " << p_array[i].days << endl;
  }

  //delete the array
  delete [] p_array;

  return 0;
}

Friend Resize(Friend* p_array, int* size_of_array)
{
  *size_of_array *= 2;
  Friend *p_new_array = new Friend [*size_of_array];

  for(int i = 0; i < *size_of_array; i++)
  {
    p_new_array[i] = p_array[i];
  }

  delete [] p_array;

  p_array = p_new_array;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:06:38.650

```
p_array = p_new_array; 
```

这会将本地`Friend*`参数分配给`p_new_array`.

为此

```
p_array[number_of_friends] = f; 
```

是对无效对象的访问。

声明`Resize`为

```
Friend Resize(Friend** p_array, int* size_of_array) 
```

或者

```
Friend Resize(Friend*& p_array, int* size_of_array) 
```

来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:22:41.783

The problem is that although your resize code is kind of OK, it only changes the pointer inside the `Resize` function. The pointer in main never gets changed at all. The other error is that you double the size_of_array variable before you copy the array, so you end up copying elements from the old array that don't exist.

Change your function like this

```
Friend* Resize(Friend* p_array, int* size_of_array)
{
  Friend *p_new_array = new Friend [*size_of_array * 2];

  for(int i = 0; i < *size_of_array; i++)
  {
    p_new_array[i] = p_array[i];
  }

  delete [] p_array;

  *size_of_array *= 2;
  return p_new_array;
} 
```

And then in main use it like this

```
if(array_size == number_of_friends)
{
    p_array = Resize(p_array, &array_size);
} 
```

This way the Resize function returns the new array, and you assign it to the p_array variable in main.,

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:10:20.710

崩溃是由于调整大小功能造成的。以下行导致崩溃：

```
for(int i = 0; i < *size_of_array; i++)
 {
    p_new_array[i] = p_array[i];
 } 
```

您将 size_of_array 的大小增加了一倍，但 p_array 只有 5 个元素。所以这意味着你在这里越界了。

# qt - OpenGL 程序不能用 QT 5.0 编译

> ID：15798068
> 
> 赞同：0
> 
> 时间：2013-04-03T21:02:26.753
> 
> 标签：qt, opengl

我按照[这个教程](http://fhalgand.developpez.com/tutoriels/qt/integration-opengl/01-premiere-application/)用 QT 创建了一个非常简单的 openGL 程序。

我有 QT 5.0。我创建了一个新的空 QT 项目，按照教程创建了所有文件，但编译失败。原因是某些方法（如 glShadeModel()）无法识别。我尝试了 include GL/glu.h（例如包括 glShadeModel），但这次与几个 openGL 类型发生冲突。但是根据教程，所有 opengl 方法都应该包含在 QtOpenGL 中。也许我有太多最新版本的 QT。我迷路了。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T08:47:49.093

Qt5 基于 OpenGL ES 2.0，这是桌面 OpenGL 的子集，甚至一些 Qt 教程还没有适应这种变化。如果你想编译这些教程，你必须用普通的 OpenGL 构建 Qt 5.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T19:00:33.797

我可能只会给你一些检查点。在.pro

*QT += opengl

*检查您的 GPU 是否支持您正在使用的 opengl 版本，例如我的笔记本电脑仅与 2.1 opengl 兼容。

也请使用“Qt”而不是“QT”，QT 代表 Apple 的 quicktime。

# java - Mozilla Rhino NativeArray.add() 抛出错误 - 总是

> ID：15798070
> 
> 赞同：0
> 
> 时间：2013-04-03T21:02:36.627
> 
> 标签：java, javascript, rhino

我正在寻找使用 mozilla rhino`NativeArray`类在 java 中构建一个 javascript 数组，但是当我尝试将元素添加到`NativeArray`a时`java.lang.UnsupportedOperationException`被抛出。

这是我的代码：

```
NativeArray array=new NativeArray(1);
array.add("cccc"); 
```

这是我收到的错误：

```
Caused by: java.lang.UnsupportedOperationException
    at org.mozilla.javascript.NativeArray.add(NativeArray.java:1826) 
```

如果我从一开始就使用 java 数组创建 NativeArray，那么一切都很好。

```
String[] str=new String[2];
str[0]="aaaa";
str[1]="bbbb";
NativeArray array=new NativeArray(str); 
```

我正在查看 NativeArray 源代码，我惊讶地发现 add 方法总是抛出错误这里是源代码： http: [//grepcode.com/file/repo1.maven.org/maven2/org.mozilla/rhino /1.7R4/org/mozilla/javascript/NativeArray.java#1825](http://grepcode.com/file/repo1.maven.org/maven2/org.mozilla/rhino/1.7R4/org/mozilla/javascript/NativeArray.java#1825)

**注意：我使用的是 mozilla rhino 1.7R4，这是迄今为止的最新版本**

这是 Mozilla rhino 的错误还是我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:05:15.207

`.add()`为原生数组实现是没有意义的。它们是固定长度的数组，长度是恒定的。

注意在界面`.add()`中标记为“可选操作” 。`java.util.Collection`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-15T14:16:07.643

You can use the following code instead of add():

```
NativeArray array;
array.put(array.size(), array, result); 
```

# string - Haskell- IO String 获取多行

> ID：15798071
> 
> 赞同：2
> 
> 时间：2013-04-03T21:02:43.583
> 
> 标签：string, list, haskell, io

我正在尝试编写一个获取多个字符串输入并在空行（'\n'）上终止的函数，我有以下内容

```
getLines :: IO [String]
getLines = do x <- getLine
           if x == ""
           return ()
           else do xs <- getLines
                return (x:xs) 
```

它无法编译，说 if 语句有问题

理想情况下，我想像这样工作

获取线

苹果

鸟

猫

（输入被按下）

输出：["Apple","Bird","Cat"]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T21:18:48.317

您需要`then`after `if`，并且`()`(empty tuple) 应该是`[]`(empty list)。在`if`中，如果`then`and`else`位于不同的行上，它们也需要缩进，因为`if then else`它是一个运算符，编译器需要知道表达式继续。您的缩进需要调整，以便所有内容都比前导缩进更多`do`：

```
getLines :: IO [String]
getLines = do x <- getLine
              if x == ""
                then return []
                else do xs <- getLines
                        return (x:xs) 
```

或者所有内容都比包含前导的*行*缩进更多`do`：

```
getLines :: IO [String]
getLines = do
  x <- getLine
  if x == ""
    then return []
    else do
      xs <- getLines
      return (x:xs) 
```

作为风格问题，您也可以使用`null x`代替`x == ""`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:05:53.537

这几乎是对的。

你需要一个`then`在你的`if`. 您可能还需要稍微更改缩进，以便所有内容都缩进到`x`而不是`do`. 我认为应该这样做。

# twitter-bootstrap - 始终打开至少一个 Bootstrap 折叠

> ID：15798072
> 
> 赞同：1
> 
> 时间：2013-04-03T21:02:56.973
> 
> 标签：twitter-bootstrap, accordion, collapse, preventdefault

我怎样才能始终确保我始终打开至少一架手风琴。目前使用崩溃的事件处理是可怕的，我需要一个解决方法。

```
$('.accordion').on('hide', function (e) {
   e.preventDefault();
}); 
```

不起作用，它还有另外两个问题，崩溃不会再次打开，并且当弹出框和其他触发隐藏事件的引导项时触发。本质上，这种绑定是无用的。

这是我基于仍然无法使用 stopPropagation 或返回 false 的类编写的尝试；

```
 $(document).on('click', '.accordion-toggle', function (e) {
        var $accordionEl = $(this),
            $accordionHdEl = $accordionEl.parent();

        if ($accordionHdEl.hasClass('accordion-selected')){
            e.preventDefault();
            e.stopPropagation();

            return false;
        } else {
            //remove current active style
            $('.accordion-selected').removeClass('accordion-selected');
            $accordionHdEl.addClass('accordion-selected');
        }
    }); 
```

# android - RelativeLayout android:clipChildren="false" 不起作用：动画会被剪裁吗？

> ID：15798077
> 
> 赞同：4
> 
> 时间：2013-04-03T21:03:16.700
> 
> 标签：android, animation, textview, android-relativelayout, clipping

我正在尝试实现一个滚动的“新闻栏”。有一个 RelativeLayout 水平填充屏幕。它应该包含许多不同的新闻标题，包含在我从互联网上下载的 TextView 对象中，它们应该是动画的，以便从右到左缓慢移动，这将产生“滚动新闻栏”效果。我将第一个 TextView 放置为 RelativeLayout.ALIGN_PARENT_LEFT，并将所有连续的 TextViews 对齐为 RelativeLayout.RIGHT_OF 根据之前的 TextView。因此，文本将从屏幕右侧进入并流经布局，最后从左侧退出。

我看到 RelativeLayout 剪辑了超出其范围的子项。我为此设置了 android:clipChildren="false" 但它不起作用，并且 TextViews 继续被剪裁，这非常烦人，目前阻碍了我的进步。

这是一个错误还是我做错了什么？

请帮我...

# php - 检查外部网站的登录

> ID：15798078
> 
> 赞同：0
> 
> 时间：2013-04-03T21:03:19.373
> 
> 标签：php

是否可以检查用户是否登录到外部网站地址？例如，检查用户是否登录到像 amazon.com 这样的网站，然后用户是否将他们引导到本地的某个管理页面，该页面只有在用户登录到该外部网站时才能访问。

基本上使用外部服务的登录会话，如果可能的话，在 PHP 中执行此操作的最佳方法是什么？这是一个安全的选择吗？

道歉是问题不是那么清楚的家伙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:06:15.930

亚马逊、Facebook、Twitter 等网站提供 OAuth API，允许他们根据登录赞助网站的情况登录您的网站。你可能想调查一下。

# objective-c - 将地址添加到苹果地图

> ID：15798079
> 
> 赞同：0
> 
> 时间：2013-04-03T21:03:24.190
> 
> 标签：objective-c, ios6-maps, apple-maps

任何人都知道如何将地址添加到苹果地图，

例如，如果我想将此地址“Rickmansworth, Hertfordshire WD3, Regno Unito”添加到地图中，我该怎么做？我没有纬度或经度。

我在谷歌搜索，我没有找到任何有用的东西。

谁能帮我？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:11:34.510

您需要将地址地理编码为地理坐标。使用其中一种地理编码服务，例如[geonames](http://www.geonames.org/export/web-services.html)。从地理编码服务获得结果后，您必须解析它们并`MKAnnotationView`在您的`MKMapView`

# google-drive-api - Google Drive SDK - 500：内部服务器错误：大部分时间文件上传成功

> ID：15798080
> 
> 赞同：5
> 
> 时间：2013-04-03T21:03:38.973
> 
> 标签：google-drive-api

尝试上传文件时，Google Drive REST API 有时会返回 500：内部服务器错误。大多数这些错误实际上对应于成功的上传。我们按照 Google 的建议重试上传，但稍后会看到重复项。

处理这些错误的推荐方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-09T11:34:50.060

[Google 的文档](https://developers.google.com/drive/v3/web/handle-errors)似乎表明这是他们的内部错误，而不是您可以修复的特定错误。他们建议使用[指数退避](https://developers.google.com/drive/v3/web/handle-errors#exponential-backoff)，这基本上是在增加间隔重新尝试该功能。

例如，函数失败。等待 2 秒，然后重试。如果失败，请等待 4 秒。然后是 8 秒、16 秒、32 秒等。更大的差距意味着您要为服务自己提供越来越多的时间。尽管根据您的需要，您可能希望最终限制时间，以便它在停止前最多等待 10 分钟。

该[`retrying`](https://pypi.python.org/pypi/retrying)软件包对此进行了很好的设置。您可以在任何应该重新尝试的功能上用作装饰器`from retrying import retry`。`retry`这是我的一个例子：

```
@retry(wait_exponential_multiplier=1000, wait_exponential_max=60*1000, stop_max_delay=10*60*1000)
def find_file(name, parent=''):
    ... 
```

要使用装饰器，您只需放在`@retry`函数声明之前。您可以只使用`retry()`，但您可以传递一些可选参数来调整时间的工作方式。我`wait_exponential_multiplier`用来调整尝试之间等待时间的增加。`wait_exponential_max`是它可以在尝试之间等待的最长时间。并且`stop_max_delay`是在引发异常之前重试的时间。它们的所有值都以毫秒为单位。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-07T16:58:55.923

此处描述了标准错误处理：[https ://developers.google.com/drive/handle-errors](https://developers.google.com/drive/handle-errors)

但是，永远不会发生 500 错误，因此请添加日志信息，Google 可以为您调试此问题。谢谢。

# javascript - 如何解决 HTML5 画布竞争条件？

> ID：15798088
> 
> 赞同：1
> 
> 时间：2013-04-03T21:04:03.223
> 
> 标签：javascript, html5-canvas, race-condition

我发现了一些以`HTML5 canvas`编程方式在`JavaScript`. 这些发生在尝试在加载之前修改图像时，我已经能够使用该技术修复其中的大部分：

```
var myImage = document.createElement('img');
myImage.onload = function(){
    console.log("image src set!");
};
myImage.src="img/foobar.png"; 
```

我正在为几张图像中的一张执行此操作，并且发生了一件奇怪的事情。基本上，图像在加载之前绘制到画布上。我什至试图通过使用布尔值来指定图像是否已经绘制来解决这个问题。这是我的输出代码。为了理解上下文，此代码是每秒调用一次以更新画布的函数的一部分。

```
if (!at_arrow_black)//one of two images used to show an arrow on the canvas
{
    at_arrow_black = document.createElement('img');
    at_arrow_black.onload = function() {
        if (foregroundColor === "black")//which image to draw depends on the foreground color
        {
            console.log("black load");
            context.drawImage(at_arrow_black, canvas.width*.775, canvas.height*.66, canvas.width*.075, font*4/5);
        }
    };
    at_arrow_black.src = "img/at_arrow.png";
}
else
{
    if (foregroundColor === "black")
    {

        if (hasDrawnArrow)//this starts as false
        {
            console.log("1\. black draw");
            context.drawImage(at_arrow_black, canvas.width*.775, canvas.height*.66, canvas.width*.075, font*4/5);
        }
        else
        {
            logDebug("2\. black draw");
            hasDrawnArrow = true;
        }
    }
} 
```

这将导致画布在此循环的第一次迭代中（并且在稍微不同的地方）首先绘制一个箭头，然后绘制另一个箭头。我得到的输出：

```
2\. black draw
black load
1\. black draw 
```

这是预期的输出 - 但为什么画布无论如何都要绘制图像？这是某种竞争条件吗？我能做些什么来修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:07:46.180

如果您要加载超过 1 个图像，您可能希望自己构建一个图像加载器，以便在开始使用它们之前加载所有图像。

这是一个例子：

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid red;}
</style>

<script>
$(function(){

  var canvas1=document.getElementById("canvas1");
  var ctx1=canvas1.getContext("2d");
  var canvas2=document.getElementById("canvas2");
  var ctx2=canvas2.getContext("2d");

  var imageURLs=[];
  var imagesOK=0;
  var imagesFailed=0;
  var imgs=[];
  imageURLs.push("http://upload.wikimedia.org/wikipedia/commons/d/d4/New_York_City_at_night_HDR_edit1.jpg");
  imageURLs.push("http://www.freebestwallpapers.info/bulkupload//20082010//Places/future-city.jpg");
  loadAllImages();

  function loadAllImages(){
      for (var i = 0; i < imageURLs.length; i++) {
        var img = new Image();
        imgs.push(img);
        img.onload = onLoad; 
        img.onerror = onFail;
        img.src = imageURLs[i];
      }      
  }

  var imagesAllLoaded = function() {
    if (imagesOK+imagesFailed==imageURLs.length ) {
       // all images are processed
       // ready to use loaded images
       // ready to handle failed image loads
       ctx1.drawImage(imgs[0],0,0,canvas1.width,canvas1.height);
       ctx2.drawImage(imgs[1],0,0,canvas2.width,canvas2.height);

    }
  };

  function onLoad() {
    imagesOK++;
    imagesAllLoaded();
  }

  function onFail() {
    // possibly log which images failed to load
    imagesFailed++;
    imagesAllLoaded();
  };   

}); // end $(function(){});
</script>

</head>

<body>
    <canvas id="canvas1" width=300 height=300></canvas><br/>
    <canvas id="canvas2" width=300 height=300></canvas>
</body>
</html> 
```

这是[JSFiddle](http://jsfiddle.net/PhDBrown/KmJXM/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:41:38.963

*我知道已经有一个公认的答案，但无论如何这里有一个替代方案。*

您需要等到所有图像都加载完毕。我使用了一个图像加载器，它在加载所有图像时设置一个标志，以便我的脚本可以继续。

## 图像加载器

```
function ImageLoader(sources, callback) 
{
    var images = {};
    var loadedImages = 0;
    var numImages = 0;

    // get num of sources
    for (var src in sources) {
        numImages++;
    }

    for (var src in sources) {
        images[src] = new Image();
        images[src].onload = function() {

            if (++loadedImages >= numImages) {
                callback(images);
            }
        };
        images[src].src = sources[src];
    }
} 
```

## 用法

```
 // *** The images you want to laod
    var sources = {
        background: 'images/bg.png',
        assets: 'images/assets.png',
    };

   // *** What you want to happen once all images have loaded...      
   ImageLoader(sources, function(images) {   

        // *** Example of what I usually do
        _images = images;
        _setImagesReady = true;
    });

    // *** Access the image by specifying it's property name you defined. eg:
    ctx.drawImage(_image.background, 0, 0); 
```

# android - ADT 在 DDMS 中获取 BufferOverflowException

> ID：15798093
> 
> 赞同：16
> 
> 时间：2013-04-03T21:04:26.797
> 
> 标签：android, eclipse, adt, ddms

我正在使用带有 ADT 的 Eclipse Juno 来开发 android 应用程序，并且 eclipse 每分钟都显示以下错误：

```
[2013-04-03 17:59:46 - ddms] null
java.nio.BufferOverflowException
    at java.nio.HeapByteBuffer.put(HeapByteBuffer.java:182)
    at com.android.ddmlib.JdwpPacket.movePacket(JdwpPacket.java:235)
    at com.android.ddmlib.Debugger.sendAndConsume(Debugger.java:347)
    at com.android.ddmlib.Client.forwardPacketToDebugger(Client.java:628)
    at com.android.ddmlib.MonitorThread.processClientActivity(MonitorThread.java:344)
    at com.android.ddmlib.MonitorThread.run(MonitorThread.java:263) 
```

当此消息弹出时，eclipse 打开一个终端，它与我可用的代码编辑区域重叠。

如何解决？停止 eclipse 以显示此消息也很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-27T02:55:19.267

没有任何代码并没有真正的帮助，但它可能与超出对某种循环或数据结构设置的限制有关。我认为您可以使用 ctrl-x 或 ctrl-c 来停止 eclipse 中的某些进程。您还可以在首选项中进行设置，以将错误通过管道传输到日志文件中。

# ruby-on-rails - Headless Rails，存储哈希的简单方法？

> ID：15798095
> 
> 赞同：0
> 
> 时间：2013-04-03T21:04:29.093
> 
> 标签：ruby-on-rails, ruby, model, controller, rails-activerecord

我是 Rails 的新手，但大多数文档都是针对用户在视图中输入内容并最终传递到数据库中的。

1.  是否有一种将以下存储到 SQL 数据库中的 Rails 方式？我把它放在模型或控制器中吗？
2.  有没有一种干净的方法来存储这些数据，或者我必须单独显式地存储这个 Hash 中的每个属性？
3.  我已经手动进行了与下面大多数（如果不是全部）散列数据匹配的迁移，但是是否有可以将这些散列转换为关系数据模型的工具？

.

```
{
"_id" : "36483f88e04d6dcb60684a33000791a6bc522a41",
"address_components" : [
    {
        "long_name" : "ON",
        "short_name" : "ON",
        "types" : [
            "administrative_area_level_1",
            "political"
        ]
    },
    {
        "long_name" : "CA",
        "short_name" : "CA",
        "types" : [
            "country",
            "political"
        ]
    },
    {
        "long_name" : "M5J 1L4",
        "short_name" : "M5J 1L4",
        "types" : [
            "postal_code"
        ]
    }
],
"formatted_address" : "ON, Canada",
"formatted_phone_number" : "(416) 362-5221",
"geometry" : {
    "location" : {
        "lat" : 43.640816,
        "lng" : -79.381752
    }
},
"icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/restaurant-71.png",
"id" : "36483f88e04d6dcb60684a33000791a6bc522a41",
"international_phone_number" : "+1 416-362-5221",
"name" : "Scandinavian Airlines",
"reference" : "CoQBcgAAAMobbidhAbzwIMkxq3GTHzzlEW4hAAwxg5EmGDP7ZOcJRwUK29poFMTDvED5KW9UEQrqtgTwESj_DuCAchy6Qe5pPZH9tB47MmmuQHvyHFlApunmU3MN05_KLekN5hEbrW7Gv2ys2oXmn7FpvD7-0N0QILlFXCiwL5UlYWo2sEg3EhBMBsrkHBu4WCFsMCHRqgadGhTM3BVWR15l9L87zL1uN1ssoW4WCw",
"types" : [
    "restaurant",
    "food",
    "establishment"
],
"url" : "https://plus.google.com/100786723768255083253/about?hl=en-US",
"utc_offset" : -300,
"vicinity" : "" 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:31:27.773

如果您的模型上有 setter 方法，它们可以根据需要处理数据并从此哈希导入。

例如，给定上面的哈希，如果你有一个方法：

```
def address_components=(ac)
  # Handle address components
end 
```

如果您执行以下操作（假设您的模型的名称是 MyModel 并且哈希存储在 @hash 中），它将被调用。

```
MyModel.new(@hash) 
```

所有的键都会触发结构'key='的setter方法。这是非常强大的——如果你有一个结构很好的模型，但是有一个任意的散列，你可以创建处理散列中的键的方法。基于这些，您可以同时构建新对象、建立关联并保存它们。

注意 - 您可能需要删除一些键，或以自定义方式处理一些使用保留 ruby​​ 术语的键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T02:33:22.607

1.  该数据结构可以通过模型/关联的匹配层次结构来存储。
2.  有一种非常干净的方法是......
3.  使用[`accepts_nested_attributes_for`](http://apidock.com/rails/ActiveRecord/NestedAttributes/ClassMethods/accepts_nested_attributes_for). 这将适用于您的整个结构，*除了*包含简单字符串列表的“类型”数组。但是，您可以针对这种特定情况使用解决方法。

唯一不能（容易）存储的是`id`. ActiveRecord 不允许您`id`直接设置，因为它应该是后备数据库的实现细节。在您的情况下，您可以简单地借用`_id`似乎包含相同数据的字段并将其插入某种别名中。

以下是您可能使用的代码示例：

```
class Address < ActiveRecord::Base
  has_many :address_components
  has_many :address_types
  has_one :geometry

  attr_accessor :address_components_attributes, :geometry_attributes
  accepts_nested_attributes_for :address_components, :geometry

  def types=(types)
    types.each do |t|
      self.address_types << AddressType.build(name: t)
    end
  end

  def _id=(orig_id)
    self.original_id = orig_id
  end
end

class AddressType < ActiveRecord::Base
  belongs_to :address
end

class Geometry < ActiveRecord::Base
  belongs_to :address
  has_one :location

  attr_accessor :location_attributes
  accepts_nested_attributes_for :location
end

class Location < ActiveRecord::Base
  belongs_to :geometry
end

class AddressComponent < ActiveRecord::Base
  belongs_to :address
  has_many :component_types

  def types=(types)
    types.each do |t|
      self.component_types << ComponentType.build(name: t)
    end
  end
end

class ComponentType < ActiveRecord::Base
  belongs_to :address_component     
end 
```

现在您可以使用以下方法存储整个结构：

```
Address.create(data_hash) 
```

# eclipse - 安装 Maven 插件后 Eclipse 不再启动：MetadataRepositoryManager 未注册

> ID：15798098
> 
> 赞同：1
> 
> 时间：2013-04-03T21:04:39.587
> 
> 标签：eclipse, maven, repository, maven-plugin, startup

安装 Maven 插件并关闭 Eclipse 后，我尝试启动 Eclipse v8.3 我收到一个错误，将我指向配置目录的日志文件。（以下内容）即使在选择工作空间之前也会发生这种情况。

```
Root exception:
java.lang.IllegalStateException: MetadataRepositoryManager not registered.
    at org.eclipse.equinox.internal.provisional.p2.directorywatcher.RepositoryListener.initializeMetadataRepository(RepositoryListener.java:115) 
```

谷歌搜索 MetadataRepositoryManager 并没有出现太多......

重新启动后，互联网建议并且我已经尝试（并恢复）：

在 IBM\SDP\configuration\config.ini 中指定 eclipse.p2.data.area 的完整路径

在 IBM\SDP\configuration\config.ini 中将 eclipse.product=com.ibm.rational.rft.product.ide 更改为 eclipse.product=org.eclipse.platform.ide

重命名：C:\Users[用户名].eclipse

运行：\IBM\SDP>.\eclipse.exe –clean

在 \IBM\SDP\eclipse.ini 中将 JRE 从 1.7 更改为 1.6

删除工作区目录

删除配置目录（导致不同的问题：java 错误代码 = 13）

按照此处的建议删除 .snap 文件：[http ://www.metod.si/job-found-still-running-after-platform-shutdown-eclipse/](http://www.metod.si/job-found-still-running-after-platform-shutdown-eclipse/)

这些更改（现已恢复）似乎都没有帮助。

提前感谢您可能添加的任何建议。

LOG文件内容：

```
!SESSION 2013-04-03 16:33:22.479 -----------------------------------------------
eclipse.buildId=unknown
java.fullversion=JRE 1.7.0 IBM J9 2.6 Windows 7 x86-32 20120809_118929 (JIT enabled, AOT enabled)
J9VM - R26_Java726_SR2_20120809_0948_B118929
JIT  - r11.b01_20120808_24925
GC   - R26_Java726_SR2_20120809_0948_B118929
J9CL - 20120809_118929
BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_US
Framework arguments:  -product com.ibm.rational.rft.product.ide
Command-line arguments:  -os win32 -ws win32 -arch x86 -product com.ibm.rational.rft.product.ide

!ENTRY org.eclipse.equinox.p2.reconciler.dropins 4 0 2013-04-03 16:33:23.188
!MESSAGE FrameworkEvent ERROR
!STACK 0
org.osgi.framework.BundleException: Exception in org.eclipse.equinox.internal.p2.reconciler.dropins.Activator.start() of bundle org.eclipse.equinox.p2.reconciler.dropins.
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:734)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:683)
    at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:381)
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.resume(AbstractBundle.java:390)
    at org.eclipse.osgi.framework.internal.core.Framework.resumeBundle(Framework.java:1176)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:559)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:544)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.incFWSL(StartLevelManager.java:457)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:243)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:438)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:1)
    at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230)
    at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340)
Caused by: java.lang.IllegalStateException: MetadataRepositoryManager not registered.
    at org.eclipse.equinox.internal.provisional.p2.directorywatcher.RepositoryListener.initializeMetadataRepository(RepositoryListener.java:115)
    at org.eclipse.equinox.internal.provisional.p2.directorywatcher.RepositoryListener.initialize(RepositoryListener.java:73)
    at org.eclipse.equinox.internal.provisional.p2.directorywatcher.RepositoryListener.<init>(RepositoryListener.java:68)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.DropinsRepositoryListener.<init>(DropinsRepositoryListener.java:53)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.Activator.watchDropins(Activator.java:489)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.Activator.start(Activator.java:172)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:711)
    at java.security.AccessController.doPrivileged(AccessController.java:280)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:702)
    ... 12 more
Root exception:
java.lang.IllegalStateException: MetadataRepositoryManager not registered.
    at org.eclipse.equinox.internal.provisional.p2.directorywatcher.RepositoryListener.initializeMetadataRepository(RepositoryListener.java:115)
    at org.eclipse.equinox.internal.provisional.p2.directorywatcher.RepositoryListener.initialize(RepositoryListener.java:73)
    at org.eclipse.equinox.internal.provisional.p2.directorywatcher.RepositoryListener.<init>(RepositoryListener.java:68)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.DropinsRepositoryListener.<init>(DropinsRepositoryListener.java:53)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.Activator.watchDropins(Activator.java:489)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.Activator.start(Activator.java:172)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:711)
    at java.security.AccessController.doPrivileged(AccessController.java:280)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:702)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:683)
    at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:381)
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.resume(AbstractBundle.java:390)
    at org.eclipse.osgi.framework.internal.core.Framework.resumeBundle(Framework.java:1176)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:559)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:544)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.incFWSL(StartLevelManager.java:457)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:243)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:438)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:1)
    at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230)
    at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340)

!ENTRY org.eclipse.equinox.app 0 0 2013-04-03 16:33:23.392
!MESSAGE Product com.ibm.rational.rft.product.ide could not be found.

!ENTRY org.eclipse.osgi 2 0 2013-04-03 16:33:23.674
!MESSAGE One or more bundles are not resolved because the following root constraints are not resolved:
!SUBENTRY 1 org.eclipse.osgi 2 0 2013-04-03 16:33:23.674
!MESSAGE Bundle reference:file:../../../Program Files (x86)/IBM/IBMIMShared/plugins/org.eclipse.core.runtime.compatibility.registry_3.3.0.v20100520/ was not resolved.
!SUBENTRY 2 org.eclipse.core.runtime.compatibility.registry 2 0 2013-04-03 16:33:23.674
!MESSAGE Missing required capability Require-Capability: osgi.ee; filter="(|(&(osgi.ee=CDC/Foundation)(version=1.0))(&(osgi.ee=JavaSE)(version=1.3)))".

!ENTRY org.eclipse.osgi 2 0 2013-04-03 16:33:23.706
!MESSAGE The following is a complete list of bundles which are not resolved, see the prior log entry for the root cause if it exists:
!SUBENTRY 1 org.eclipse.osgi 2 0 2013-04-03 16:33:23.706
!MESSAGE Bundle org.eclipse.core.runtime.compatibility.registry_3.3.0.v20100520 [378] was not resolved.
!SUBENTRY 2 org.eclipse.core.runtime.compatibility.registry 2 0 2013-04-03 16:33:23.706
!MESSAGE Missing required capability Require-Capability: osgi.ee; filter="(|(&(osgi.ee=CDC/Foundation)(version=1.0))(&(osgi.ee=JavaSE)(version=1.3)))".
!SUBENTRY 1 org.eclipse.osgi 2 0 2013-04-03 16:33:23.706
!MESSAGE Bundle org.eclipse.equinox.http.jetty_2.0.0.v20100503 [518] was not resolved.
!SUBENTRY 1 org.eclipse.osgi 2 0 2013-04-03 16:33:23.706
!MESSAGE Bundle org.eclipse.ui.win32_3.2.200.I20100509-0800 [726] was not resolved.

!ENTRY org.eclipse.osgi 4 0 2013-04-03 16:33:23.709
!MESSAGE Application error
!STACK 1
java.lang.RuntimeException: No application id has been found.
    at org.eclipse.equinox.internal.app.EclipseAppContainer.startDefaultApp(EclipseAppContainer.java:242)
    at org.eclipse.equinox.internal.app.MainApplicationLauncher.run(MainApplicationLauncher.java:29)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:88)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)
    at java.lang.reflect.Method.invoke(Method.java:613)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1450)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1426) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T17:33:48.270

使用的解决方案：重新安装eclipse，在更改安装之前备份目录。

# asp.net - 如何定义单点登录的范围？

> ID：15798102
> 
> 赞同：0
> 
> 时间：2013-04-03T21:05:01.393
> 
> 标签：asp.net, .net, single-sign-on, saml

如果您创建了一个在您的公司内工作的基于 SSO SAML Web 的解决方案，那么当另一家公司想要与您集成时会发生什么？他们需要符合您的界面还是您需要符合他们的界面？

如果其他公司没有使用基于 SAML 的 SSO 解决方案怎么办？

如果您的公司使用 .NET 编写了解决方案，这是否会限制 SSO 解决方案的扩展（基于 Windows，与其他公司集成）？

我是否正确地说，如果构建了基于 Web 的解决方案，它将不适用于 Windows，反之亦然？换句话说，如果要支持Windows和web based，必须提供两种解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:59:01.253

SAML 是一种协议，因此如果双方都符合，它将起作用。

您通过元数据交换交换配置详细信息。

如果您在 .NET 中编写了基于 Web 的 SAML 解决方案，您可能使用 ADFS 来提供 SAML 片段或使用第 3 方 SAML 堆栈？

只要它以某种方式支持 SAML，它是 .NET 的事实就无关紧要了。

# python-2.7 - 从 pywinusb / python 初始化一个 USB 设备

> ID：15798105
> 
> 赞同：0
> 
> 时间：2013-04-03T21:05:11.243
> 
> 标签：python-2.7, windows-xp, pywinusb

我的问题类似于 Will "Simple reading from/write from/to a USB HID device in Python?" 所建议的问题，但遵循它我没有得到任何结果。问题：我正在尝试处理 Oregon WMRS200 Meteo 站，它将 USB 连接实现为 HID 设备。我开始调整/简化提供的“原始数据.py”示例，如下所示

```
from time import sleep
from msvcrt import kbhit
import pywinusb.hid as hid

def sample_handler(data):
    print("Raw data: {0}".format(data))

def raw_test():
    device = (hid.HidDeviceFilter (vendor_id =0x0fde , product_id = 0xca01). \
                    get_devices())[0]
    device.open()   
    #set custom raw data handler
    device.set_raw_data_handler(sample_handler)
    print("\nWaiting for data...\nPress any (system keyboard) key to stop...")
    while not kbhit() and device.is_plugged():
        #just keep the device opened to receive events
        sleep(0.5)

    device.close()
    return

if __name__ == '__main__':
    raw_test() 
```

数据传输未开始。我在网上发现系统必须初始化一次（在重置或pw失败后）发送缓冲区 0x20 0x00 0x08 0x01 0x00 0x00 0x00 0x00 问题是我不知道如何发送它。做类似发送报告（如上面引用的示例）之类的事情不会得到任何结果。

如果在重置后我开始和停止原始的俄勒冈 sw 一切开始工作，即通道以某种方式初始化。在通信通道上安装嗅探器我想我看到了字节串到设备，但是，我怎样才能发送它？这是带有原始 sw 的嗅探器的输出。我想字节模式可以在 URB 9-10 中看到去设备。

```
[229 ms]  >>>  URB 1 going down  >>> 
-- URB_FUNCTION_GET_DESCRIPTOR_FROM_DEVICE:
  TransferBufferLength = 00000012
  DescriptorType       = 00000001 (USB_DEVICE_DESCRIPTOR_TYPE)

[234 ms]  <<<  URB 1 coming back  <<< 
-- URB_FUNCTION_CONTROL_TRANSFER:
  TransferFlags        = 0000000b (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000012
    00000000: 12 01 10 01 00 00 00 08 de 0f 01 ca 02 03 00 01
    00000010: 00 01
  SetupPacket          =
    00000000: 80 06 00 01 00 00 12 00

[234 ms]  >>>  URB 2 going down  >>> 
-- URB_FUNCTION_GET_DESCRIPTOR_FROM_DEVICE:
  TransferBufferLength = 00000009
  DescriptorType       = 00000002 (USB_CONFIGURATION_DESCRIPTOR_TYPE)

[239 ms]  <<<  URB 2 coming back  <<< 
-- URB_FUNCTION_CONTROL_TRANSFER:
  TransferFlags        = 0000000b (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000009
    00000000: 09 02 22 00 01 01 00 80 32
  SetupPacket          =
    00000000: 80 06 00 02 00 00 09 00

[239 ms]  >>>  URB 3 going down  >>> 
-- URB_FUNCTION_GET_DESCRIPTOR_FROM_DEVICE:
  TransferBufferLength = 00000022
  DescriptorType       = 00000002 (USB_CONFIGURATION_DESCRIPTOR_TYPE)

[247 ms]  <<<  URB 3 coming back  <<< 
-- URB_FUNCTION_CONTROL_TRANSFER:
  TransferFlags        = 0000000b (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000022
    00000000: 09 02 22 00 01 01 00 80 32 09 04 00 00 01 03 00
    00000010: 00 00 09 21 10 01 00 01 22 22 00 07 05 81 03 08
    00000020: 00 01
  SetupPacket          =
    00000000: 80 06 00 02 00 00 22 00

[247 ms]  >>>  URB 4 going down  >>> 
-- URB_FUNCTION_SELECT_CONFIGURATION:
  ConfigurationDescriptor = 0x899fb730 (configure)
  ConfigurationDescriptor : bLength             = 9
  ConfigurationDescriptor : bDescriptorType     = 0x00000002
  ConfigurationDescriptor : wTotalLength        = 0x00000022
  ConfigurationDescriptor : bNumInterfaces      = 0x00000001
  ConfigurationDescriptor : bConfigurationValue = 0x00000001
  ConfigurationDescriptor : iConfiguration      = 0x00000000
  ConfigurationDescriptor : bmAttributes        = 0x00000080
  ConfigurationDescriptor : MaxPower            = 0x00000032
  ConfigurationHandle     = 0x00000000
  Interface[0]: Length            = 36
  Interface[0]: InterfaceNumber   = 0
  Interface[0]: AlternateSetting  = 0

[280 ms]  <<<  URB 4 coming back  <<< 
-- URB_FUNCTION_SELECT_CONFIGURATION:
  ConfigurationDescriptor = 0x899fb730 (configure)
  ConfigurationDescriptor : bLength             = 9
  ConfigurationDescriptor : bDescriptorType     = 0x00000002
  ConfigurationDescriptor : wTotalLength        = 0x00000022
  ConfigurationDescriptor : bNumInterfaces      = 0x00000001
  ConfigurationDescriptor : bConfigurationValue = 0x00000001
  ConfigurationDescriptor : iConfiguration      = 0x00000000
  ConfigurationDescriptor : bmAttributes        = 0x00000080
  ConfigurationDescriptor : MaxPower            = 0x00000032
  ConfigurationHandle     = 0x89a11ab8
  Interface[0]: Length            = 36
  Interface[0]: InterfaceNumber   = 0
  Interface[0]: AlternateSetting  = 0
  Interface[0]: Class             = 0x00000003
  Interface[0]: SubClass          = 0x00000000
  Interface[0]: Protocol          = 0x00000000
  Interface[0]: InterfaceHandle   = 0x8a2a18b0
  Interface[0]: NumberOfPipes     = 1
  Interface[0]: Pipes[0] : MaximumPacketSize = 0x00000008
  Interface[0]: Pipes[0] : EndpointAddress   = 0x00000081
  Interface[0]: Pipes[0] : Interval          = 0x00000001
  Interface[0]: Pipes[0] : PipeType          = 0x00000003 (UsbdPipeTypeInterrupt)
  Interface[0]: Pipes[0] : PipeHandle        = 0x8a2a18cc
  Interface[0]: Pipes[0] : MaxTransferSize   = 0x00001000
  Interface[0]: Pipes[0] : PipeFlags         = 0x00000000

[280 ms]  >>>  URB 5 going down  >>> 
-- URB_FUNCTION_CLASS_INTERFACE:
  TransferFlags          = 00000000 (USBD_TRANSFER_DIRECTION_OUT, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000000
    no data supplied
  RequestTypeReservedBits = 00000022
  Request                 = 0000000a
  Value                   = 00000000
  Index                   = 00000000

[282 ms]  <<<  URB 5 coming back  <<< 
-- URB_FUNCTION_CONTROL_TRANSFER:
  TransferFlags        = 0000000a (USBD_TRANSFER_DIRECTION_OUT, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000000
  SetupPacket          =
    00000000: 21 0a 00 00 00 00 00 00

[282 ms]  >>>  URB 6 going down  >>> 
-- URB_FUNCTION_GET_DESCRIPTOR_FROM_INTERFACE:
  TransferBufferLength = 00000062
  DescriptorType       = 00000022 (<illegal descriptor type!>)

[291 ms]  <<<  URB 6 coming back  <<< 
-- URB_FUNCTION_CONTROL_TRANSFER:
  PipeHandle           = 8a2a4198
  TransferFlags        = 0000000b (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000022
    00000000: 06 00 ff 09 01 a1 01 09 01 15 00 26 ff 00 75 08
    00000010: 95 08 81 00 09 02 15 00 26 ff 00 75 08 95 08 91
    00000020: 02 c0
  SetupPacket          =
    00000000: 81 06 00 22 00 00 62 00

[294 ms]  >>>  URB 7 going down  >>> 
-- URB_FUNCTION_BULK_OR_INTERRUPT_TRANSFER:
  TransferFlags        = 00000003 (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000008
[294 ms]  >>>  URB 8 going down  >>> 
-- URB_FUNCTION_BULK_OR_INTERRUPT_TRANSFER:
  TransferFlags        = 00000003 (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000008

[3330 ms]  <<<  URB 7 coming back  <<< 
-- URB_FUNCTION_BULK_OR_INTERRUPT_TRANSFER:
  TransferFlags        = 00000003 (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000008
    00000000: 01 ff 01 cc 01 87 01 00

[3330 ms]  >>>  URB 9 going down  >>> 
-- URB_FUNCTION_BULK_OR_INTERRUPT_TRANSFER:
  TransferFlags        = 00000003 (USBD_TRANSFER_DIRECTION_IN, USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000008
[3330 ms]  >>>  URB 10 going down  >>> 
-- URB_FUNCTION_CLASS_INTERFACE:
  TransferFlags          = 00000000
(USBD_TRANSFER_DIRECTION_OUT, ~USBD_SHORT_TRANSFER_OK)
  TransferBufferLength = 00000008
    00000000: 20 00 08 01 00 4d 80 00
  RequestTypeReservedBits = 00000022
  Request                 = 00000009
  Value                   = 00000200
  Index                   = 00000000 
```

从 URB 11 - --> 正常传输也从我的示例脚本开始。

我希望我已经足够清楚.....感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T01:40:39.257

For sending RAW data (no HID descriptor managed reports), you can use the "device.send_output_report()", pass any list as a parameter (or for better performance, you can pass a ctypes.c_ubyte array.

# java - Looper.loop 未调用，但处理程序中的代码仍在执行

> ID：15798108
> 
> 赞同：1
> 
> 时间：2013-04-03T21:05:16.537
> 
> 标签：java, android, looper

我试图了解 looper.loop 是如何工作的，以及何时在我的代码中使用它。我有一个可运行的绑定服务。在里面我有一个处理程序，用于保存更新 Ui 的代码。这是代码。

```
private Runnable builder = new Runnable() {
public void run() 
{
  while(isThreadStarted == true)
  {
    if (newgps == 1)
     {  
         Handler handler = new Handler(Looper.getMainLooper());
        handler.post(new Runnable() {
                       public void run() { 
                         //some code that updates UI
                       }
                 }
           }
      }
  }
  looper.prepair
} 
```

1.  从我读到的looper。prepare 必须在处理程序生成之前调用。但我注意到我没有这样做，但这段代码仍然有效。这怎么可能？
2.  我想解决这个问题，但我不确定将 loper.loop 放在哪里。因为这个处理程序被多次调用。如果我将 looper.loop 放在 .prepare 之后可以吗？那么.quit什么时候isThreadStarted == false？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-14T13:26:33.720

通过使用`Looper.getMainLooper()`，您可以获得`Handler`主线程并在主线程上发布。主线程在创建时已经由系统准备好了它的looper。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T13:19:09.463

与`Handler`UI 线程相关联，因为您将其附加到`Looper.getMainLooper()`. UI 线程`Looper`在应用程序启动时做好准备，因此应用程序无需自行执行任何操作。

# python - Python初学者（列表）

> ID：15798109
> 
> 赞同：0
> 
> 时间：2013-04-03T21:05:19.113
> 
> 标签：python, python-2.7

我需要编写一个名为 make_ends 的函数，它接收一个参数 - 一个列表。它返回一个新列表，其中包含输入列表的第一项和最后一项。

这是我的代码，但它没有将它分成一个列表。我对如何去做这件事有点困惑。我需要使用 .join 功能吗？如果是这样，我该怎么做？我想我很接近。

```
def make_ends(x):
    return x[0], x[-1] 
```

这是我早期的构建，但它除了返回原始字符串之外什么也没做：

```
def go_right(str):
    if str >= 2:
            a = str[-2:0] + str
            return a 
```

那有什么问题？

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:06:42.083

你实际上非常接近；唯一的问题是您返回的是元组而不是列表。（whatever `a`and `b`are，`a, b`是这两件事的元组，就像这两件事`[a, b]`的列表一样。）

解决这个问题的一种方法是调用`list`从元组中创建一个列表：

```
def make_ends(x):
    return list((x[0], x[-1])) 
```

但最简单的方法是首先创建一个列表：

```
def make_ends(x):
    return [x[0], x[-1]] 
```

* * *

然后你问另一个问题：

> 这是我早期的构建，但它除了返回原始字符串之外什么也没做：

```
def go_right(str):
    if str >= 2:
            a = str[-2:0] + str
            return a 
```

让我们一步一步来。

首先，`str >= 2`将字符串与数字进行比较。在 Python 2.x 中，要么所有字符串都大于所有数字，要么所有字符串都小于所有数字。（这取决于实现。）所以，这不是一个非常有用的检查。

也许你想检查一下`if len(str) >= 2`？但即便如此，我也不确定这会给你带来什么。如果长度是 0 或 1，你想做什么？事实上，你会 return `None`，这可能是不对的。

同时，`str[-2:0]`要求所有在 2-before-the-end 之后但在 start 之前出现的元素。开始之前没有元素，所以这是空的。然后将原始值添加到这个空集合中，这样就得到了原始值。

* * *

另外，作为旁注，调用参数`str`是一个坏主意。除了隐藏内置`str`函数（这是一个将任何内容转换为字符串表示的函数）这一事实之外，它还强烈暗示您正在处理的是字符串，而不是列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-26T12:01:23.853

确实有多种方法可以解决此任务

一种是最常见的，也可能是最传统的

```
def make_ends(x):
    return [x[0], x[-1]] 
```

另一种方法

```
def make_ends(x):
    finished = []
    finished.append(x[0])
    finished.append(x[1])
    return finished 
```

此外，您可以将字符串转换为列表，允许该函数使用字符串

```
def make_ends(x):
    x = list(x)
    return [x[0], x[-1]] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T21:06:43.067

尝试以下

```
def make_ends(x):
  return [x[0], x[-1]] 
```

在当前表单而不是列表中，您正在创建一个元组。这就是逗号运算符在值之间放置时所做的事情

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-03T21:07:34.823

您当前正在返回一个元组，而不是一个列表。只需将其包裹在方括号中即可使其成为列表：

```
def make_ends(x):
    return [x[0], x[-1]] 
```

但是，我会质疑你为什么首先想要一个列表。你知道你只返回两个项目，所以你不需要它是可变的——在我看来，一个元组也许就是你想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T21:06:53.137

你很亲密。您只需要将退货放入列表中。

```
return [x[0], x[-1]] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-03T21:06:59.267

```
def make_ends(x):
  return [x[0], x[-1]] 
```

# linux - 文件路径名称问题，可能是损坏的字符

> ID：15798111
> 
> 赞同：0
> 
> 时间：2013-04-03T21:05:30.310
> 
> 标签：linux, perl, file, cgi

Perl 和 html，Linux 上的 CGI。文件路径名问题，在表单字段中传递给服务器上的 CGI。问题在于 Linux 文件路径，而不是 PC 端。

我正在使用 2 个程序，1) 几年前编写的程序，在 perl 程序中生成的动态 html，并以表单的形式呈现给用户。我通过插入所需的代码进行修改，以允许用户从他们的 PC 中选择一个文件，并将其放置在 Linux 机器上。

因为这个程序已经知道 linux 端需要的文件路径，所以我将这个文件路径放在一个隐藏的表单字段中，传递给程序 2。

2) Linux 端的 CGI 程序，在 (1) 上的表单发布时运行。

奇怪的问题。我通过的文件路径有一个非常奇怪的问题。我可以使用

```
my $filepath = $query->param("serverfpath"); 
```

上面确实用看起来完全正确的路径填充了 $filepath。
但它失败了，而且不是以一种将我带到文件打开错误块的方式，而是这样对 CGI 脚本的调用给出了一个错误。

但是，如果我使用完全相同的字符串填充 $filepath，通过硬编码它，它可以工作，并且我的文件成功上传。

例如：

```
$fpath1 = $query->param("serverfpath");
$fpath2 = "/opt/webhost/ims/DOCURVC/data" 
```

$fpath1 和 $fpath2 的比较表明它们完全相等。$fpath1 和 $fpath2 的长度检查表明它们的长度完全相同。

我尝试了很多方法来清理 $fpath1 中的数据。我咀嚼它。我删除了所有非标准字符。

```
$fpath1  =~ s/[^A-Za-z0-9\-\.\/]//g; 
```

还有这个：

```
my $safe_filepath_characters = "a-zA-Z0-9_.-/";
$fpath1 =~ s/[^$safe_filepath_characters]//g; 
```

但无论我做什么，使用 $fpath1 都会导致错误，使用 $fpath2 可以。

$fpath1 中的数据可能有什么问题，这会导致它成功地与 $fpath2 进行比较，但不相等，视觉上看起来完全相等，显示为具有完全相同的长度，但工作方式不同？

对于以下文件打开块。

```
$upload_dir = $fpath1 
```

导致 CGI 加载完全失败，好像找不到 CGI（我知道这有时是由 CGI 脚本中的语法错误引起的）。

```
$uplaod_dir = $fpath2 
```

我获得了成功的文件上传

```
$uplaod_dir = "" 
```

对 cgi 的调用没有失败，它按预期执行以下 if 的 else 块。

这是文件打开块：

```
if (open ( UPLOADFILE, ">$upload_dir/$filename" ))   
{
binmode UPLOADFILE;

while ( <$upload_filehandle> )
{
print UPLOADFILE;
}

close UPLOADFILE;
$msgstr="Done with Upload: upload_dir=$upload_dir filename=$filename";
}
else
{
$msgstr="ERROR opening for upload: upload_dir=$upload_dir filename=$filename";
} 
```

我应该在 $fpath1 上执行哪些其他测试，以找出为什么它与硬编码等效 $fpath2 的工作方式不同

我确实尝试过字符替换，一次一个字符，从 $fpath2 到 $fpath1。即使对单个字符执行此操作，也会导致 $fpath1 与 $fpath2 具有相同的错误，尽管字符看起来完全相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:02:19.250

> 但它失败了，而且不是以一种将我带到文件打开错误块的方式，而是这样对 CGI 脚本的调用给出了一个错误。

脚本标题过早结束？尝试从命令行运行 CGI：

```
perl your_upload_script.cgi serverfpath=/opt/webhost/ims/DOCURVC/data 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:07:16.313

您的 CGI 是否使用[`-T`](http://perldoc.perl.org/perlrun.html#%2a-T%2a "perldoc perlrun")（污染模式）开关（例如`#!/usr/bin/perl -T`）运行 perl？如果是这样，任何来自不受信任的来源（例如用户输入、URI 和表单字段）的值都不允许在系统操作中使用，例如[`open`](http://perldoc.perl.org/functions/open.html "perldoc -f 打开")，直到通过使用正则表达式捕获来清除它。请注意，使用[`s///`](http://perldoc.perl.org/perlop.html#s%2fPATTERN%2fREPLACEMENT%2fmsixpodualgcer "perldoc perlop")就地修改它*不会*破坏该值。

```
$fpath1  =~ /^([A-Za-z0-9\-\.\/]*)$/;
$fpath1 = $1;
die "Illegal character in fpath1" unless defined $fpath1; 
```

如果污染模式是您的问题，应该可以工作。

# regex - 问题导航 - 使用正则表达式的子字符串

> ID：15798112
> 
> 赞同：2
> 
> 时间：2013-04-03T21:05:36.217
> 
> 标签：regex, intellij-idea

Intellij IDEA 12

我想为 Bitbucket 问题添加一个新的问题导航链接（设置 -> 版本控制 -> 问题导航）（具有模式：[https](https://bitbucket.org/user/repo-name/issue/123) ://bitbucket.org/user/repo-name/issue/123 ）。

我希望问题 ID 为 #n（例如 #3、#123 等）。

如何输入问题 ID 作为正则表达式？**#\d+** ?

是否可以使用正则表达式创建子字符串，因为它不应该是 Bitbuckt 问题 URL 中的哈希？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T21:36:10.693

尝试以下操作：

```
#(\d+)   --   https://bitbucket.org/user/repo-name/issue/$1 
```

# c# - 直接在所有窗口顶部绘制到屏幕

> ID：15798119
> 
> 赞同：8
> 
> 时间：2013-04-03T21:06:23.393
> 
> 标签：c#, java, c++, windows

我需要一种直接在 Windows 中绘制到显示屏的方法。程序需要绘制的东西是非常简单的形状和一些文本。

我想开发一个与 Xfire 类似的程序。也就是说，它可以在全屏应用程序之上绘制。例如，我想创建一个一直在后台运行的程序，即使在全屏应用程序（游戏、电影等）运行时，也会在右下角显示系统时间。我的程序还必须对按下按钮组合（例如 ctrl+alt+1）之类的事件做出反应。

我的程序不能捕获鼠标事件。所以如果它画了一个圆圈并且在它下面有一个外国应用程序的按钮，那么外国应用程序的按钮应该可以识别点击。

这在 Windows 中怎么可能？

我想用以下语言之一实现这个程序：C++、C#、Java

如果有一些 API/教程可以帮助我实现这一点，我将不胜感激。

# ms-access - MS Access 导出到 .xls

> ID：15798131
> 
> 赞同：0
> 
> 时间：2013-04-03T21:07:00.073
> 
> 标签：ms-access, ms-access-2007, xls

我正在寻找示例“源代码”来执行此操作，因此我可以创建一个按钮以自动将所有表导出到具有相同名称但扩展名为 .xls 的电子表格。我已经知道如何手动导出表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T06:07:22.327

我还没有测试过，但这样的东西应该适用于导出到所有相同的工作簿......

```
Dim lTbl As Long
Dim strFile As String
Dim d As Database

 'Set current database to a variable adn create a new Excel instance
Set d = CurrentDb

strFile = "c:\FolderName\FileName.xls" '## Change to file you want

'Loop through all tables
For lTbl = 0 To d.TableDefs.Count
     'If the table name is a temporary or system table then ignore it
    If Left(d.TableDefs(lTbl).Name, 1) = "~" Or _
        Left(d.TableDefs(lTbl).Name, 4) = "MSYS" Then
         '~ indicates a temporary table
         'MSYS indicates a system level table
    Else
        DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, d.TableDefs(lTbl).Name, strFile
    End If
Next lTbl

 'Release database object from memory
Set d = Nothing 
```

或者对于所有单独的工作簿：

```
Dim lTbl As Long
Dim strFile As String
Dim d As Database

 'Set current database to a variable adn create a new Excel instance
Set d = CurrentDb
Set xlApp = CreateObject("Excel.Application")

strFilePath = "c:\Database\" '## Cahnge to where you want to save"

'Loop through all tables
For lTbl = 0 To d.TableDefs.Count
     'If the table name is a temporary or system table then ignore it
    If Left(d.TableDefs(lTbl).Name, 1) = "~" Or _
        Left(d.TableDefs(lTbl).Name, 4) = "MSYS" Then
         '~ indicates a temporary table
         'MSYS indicates a system level table
    Else
        Set wbExcel = xlApp.workbooks.Add
        strFile = d.TableDefs(lTbl).Name & ".xls"
        wbExcel.SaveAs FileName:=strFilePath & strFile, FileFormat:=56
        wbExcel.Close
        DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, d.TableDefs(lTbl).Name, strFilePath & strFile
        Set wbExcel = Nothing
    End If
Next lTbl

xlApp.Quit
Set wbExcel = Nothing
Set xlApp = Nothing

 'Release database object from memory
Set d = Nothing 
```

# python - 从循环内访问变量时出现python语法错误

> ID：15798135
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:07:18.753
> 
> 标签：python, loops, syntax

```
for foldername in os.listdir(mainpath):
 x = 0
 if foldername[-4:] != ".rar":
  path = mainpath + "\\" + foldername
  for i in os.listdir(path):
   if i[-4:] == '.jpg' or i[-5:] == '.jpeg':
    #Do something with with image found
    x += 1

 if x > 0:
  #images found 
```

Python 在 x += 1 处不断给我一个语法错误

语法没有问题，每次找到图像时我都会增加变量并在主循环移动到新文件夹时将其重置 x = 0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:13:04.823

`x += 1`在您省略的部分中，您可能在 , 之前的行上缺少右括号：

```
#Do something with with image found 
```

检查最后一行`do something`并确保括号、括号和花括号都是平衡的。

# python - 如何根据参数向类添加函数

> ID：15798138
> 
> 赞同：0
> 
> 时间：2013-04-03T21:07:23.893
> 
> 标签：python, class, function

我有一个类 ( `node`)，我想根据类 ( ) 的参数为其分配一组特定的函数（在本例`a1`中为`a2`、`b1`、 和）。`b2``operatingMode`

情况是我的电机有许多不同的操作模式。每种操作模式都允许执行某些功能，但不允许执行其他功能。将功能分配给各种模式的方式并不适合为每种操作模式创建类。

下面是我的解决方案，但它不起作用。

有什么想法吗？

```
def a1(self):
    return 'a1'

def a2(self):
    return 'a2'

def b1(self):
    return 'b1'

def b2(self):
    return b2

class node(object):
    def __init__(self,operatingMode):
    self.operatingMode=operatingMode

    if self.operatingMode=='A':
        self.a1function=a1
        self.a2function=a2
        print 'Operating Mode \'A\' functions loaded'

    if self.operatingMode=='B':
        self.b1function=b1
        self.b2function=b2
        print 'Operating Mode \'B\' functions loaded'

    def setOperatingMode(self,operatingMode):
        self.operatingMode=operatingMode
        self.__init__(self,operatingMode) 
```

在我的终端中运行它可以让我调用它，但我必须两次声明肘部：

```
In [65]: elbow=node('A')
Operating Mode 'A' functions loaded

In [66]: elbow.a1function(elbow)
Out[66]: 'a1' 
```

尝试运行会`elbow.setOperatingMode('B')`产生错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:31:10.383

使用`types.MethodType`和`__getattr__`：

```
import types

def a1(self):
    return 'a1'

def a2(self):
    return 'a2'

def b1(self):
    return 'b1'

def b2(self):
    return 'b2'

class Node(object):
    def __init__(self, operatingMode):
        self.operatingMode = operatingMode
    def __getattr__(self, attr):
        if self.operatingMode=='A':
            if attr == 'a1function':
                return types.MethodType(a1, self)
            if attr == 'a2function':
                return types.MethodType(a2, self)

        elif self.operatingMode=='B':
            if attr == 'b1function':
                return types.MethodType(b1, self)
            if attr == 'b2function':
                return types.MethodType(b2, self)
        else:
            raise AttributeError() 
```

然后

```
elbow = Node('A')
print(elbow.a1function())
elbow.operatingMode = 'B'
print(elbow.b2function()) 
```

产量

```
a1
b2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:50:35.707

也许使用`checkMode`装饰器会是一种更清洁的方式——这可以避免`__getattr__`和`type.MethodType`神奇：

```
def checkMode(mode):
    def deco(func):
        def wrapper(self):
            if self.operatingMode == mode:
                return func(self)
            else:
                raise TypeError('Wrong operating Mode')
        return wrapper
    return deco

class Node(object):
    def __init__(self, operatingMode):
        self.operatingMode = operatingMode

    @checkMode('A')
    def a1(self):
        return 'a1'

    @checkMode('A')
    def a2(self):
        return 'a2'

    @checkMode('B')
    def b1(self):
        return 'b1'

    @checkMode('B')
    def b2(self):
        return 'b2' 
```

使用上面的代码，我们可以这样做：

```
elbow = Node('A')
print(elbow.a1())
# a1

knee = Node('A')
print(knee.a1())
# a1

elbow.operatingMode = 'B'
print(knee.a1())  # knee is still in operatingMode A
# a1

print(elbow.b2())
# b2

elbow.a1()
# TypeError: Wrong operating Mode 
```

* * *

**解释：**

装饰器语法的工作原理如下：

```
@deco
def func(): ... 
```

相当于

```
def func(): ...
func = deco(func) 
```

上面，`checkMode`是一个返回装饰器的函数，`deco`. `deco`然后装饰方法`a1`,`a2`等，这样

```
a1 = deco(a1) 
```

因此，`a1`函数是否传递给`deco`. `deco(a1)`反过来，返回一个新方法，通常称为`wrapper`。这个新方法`a1`由语句分配`a1 = deco(a1)`。现在`a1`的方法也是如此`wrapper`。因此，当您调用 时`elbow.a1()`，将执行中的代码`wrapper`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T22:02:41.857

针对此评论：

> 这是用于电机控制的，所以我试图限制开销......操作模式的更改频率将比调用单个命令的频率低得多。

Python 实例可以更改它们的类。您可以使用它来更改操作模式，而无需使用 -`if`子句来检查模式：

```
class Base(object):
    # Put any methods shared by ANode and BNode here.
    pass

class ANode(Base):
    def a1(self):
        return 'a1'

    def a2(self):
        return 'a2'

class BNode(Base):
    def b1(self):
        return 'b1'

    def b2(self):
        return 'b2'

elbow = ANode()
print(elbow.a1())
# a1

knee = ANode()
print(knee.a1())
# a1

elbow.__class__ = BNode
print(knee.a1())
# a1
print(elbow.b2())
# b2

elbow.a1()
# AttributeError: 'BNode' object has no attribute 'a1' 
```

* * *

从积极的方面来说，这是我发布的最快的建议。`if`请注意，上面的代码中没有- 语句。一旦类发生变化，所有可用的方法都会“立即”发生变化，这完全是由于正常的 Python 方法调用语义。

如果`Node`在装饰器解决方案中定义，

```
In [33]: elbow = Node('A')

In [34]: %timeit elbow.a1()
1000000 loops, best of 3: 288 ns per loop 
```

虽然，如果`knee`使用 定义`ANode`，

```
In [36]: knee = ANode()

In [37]: %timeit knee.a1()
10000000 loops, best of 3: 126 ns per loop 
```

所以这个解决方案调用方法的速度是装饰器解决方案的 2 倍以上。

切换速度相当：

```
In [38]: %timeit elbow.operatingMode = 'B'
10000000 loops, best of 3: 71.7 ns per loop

In [39]: %timeit knee.__class__ = BNode
10000000 loops, best of 3: 78.7 ns per loop 
```

* * *

**警告**：困扰我发布的所有解决方案的一件事是，在切换*名称*后，可用方法会发生变化。这意味着当您使用这些类进行编程时，您必须先跟踪实例的状态，然后才能知道哪些方法可用。这很尴尬。

`ANode`如果并且`BNode`具有**完全相同**的接口——所有相同的属性和方法名称——只需更改这些方法的定义（当模式或类更改时），你的程序就会简单得多。

* * *

关于这条评论：

> 我有大约一百种功能和 7 种操作模式。在这些功能中，大约 10 个在所有操作模式之间共享，75 个由多个模式共享，15 个是特定模式独有的。问题是 75 没有很好地分配给模式：一些可能在模式 1,4 和 7 中，其他在 2,4,5 和 7 中，其他在 1 和 5 中。

您可以在类之外定义方法，然后将它们“连接”到基于模式的类，如下所示：

```
def a1(self):
    return 'a1'

def a2(self):
    return 'a2'

def b1(self):
    return 'b1'

def b2(self):
    return 'b2'

class Base(object):
    # Put the 10 methods share by all modes here
    def common1(self): 
        pass

class ANode(Base):
    a1 = a1
    a2 = a2

class BNode(Base):
    b1 = b1
    b2 = b2

class CNode(Base):
    a1 = a1
    b2 = b2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T21:31:06.723

您的整个设计非常奇怪，您可能需要退后一步，解释您正在尝试做什么，以便有人可以帮助您进行更好的设计。

但是如果你只是想让你的设计工作，你当前的代码有两个问题：

```
self.a1function = a1 
```

这设置`self.a1function`为常规函数，而不是绑定方法。您可以像这样显式创建绑定方法：

```
self.a1function=types.MethodType(a1, self, self.__class__) 
```

或者您可以设置`a1function`为`a1`. 或者，更简单地说，动态包装，这意味着您可以使用闭包来伪造绑定方法，这可以说更具可读性：

```
def __getattr__(self, attr):
    if attr == 'a1function' and self.operating_mode == 'A':
        return lambda: a1(self) 
```

同时：

> 尝试运行肘部.setOperatingMode('B') 会产生错误。

您确实需要发布回溯，或者至少发布错误字符串，而不仅仅是说“产生错误”。在这种情况下，它会非常明确地告诉您错误是什么，因此您无需猜测：

```
TypeError: __init__() takes exactly 2 arguments (3 given) 
```

问题是在这一行：

```
self.__init__(self,operatingMode) 
```

……你通过`self`了两次。它是您调用方法的对象，也是第一个参数。

无论如何，从另一个方法调用`__init__`是个坏主意，但如果你真的想要，它与调用任何其他方法一样：

```
self.__init__(operatingMode) 
```

# c# - 如何将值返回到发布表单以修复错误 mvc 3

> ID：15798139
> 
> 赞同：0
> 
> 时间：2013-04-03T21:07:24.597
> 
> 标签：c#, asp.net-mvc, forms, validation

我有一个发布 3 条信息的表格。

*   配方模型
*   标签字段（字符串）
*   文件（类型文件的输入）

在控制器端，我收到如下信息：

```
[HttpPost]
[Authorize]
public ActionResult Create(Recipe recipe, string taglist, HttpPostedFileBase file)
{
     if (ModelState.IsValid)
     { ... 
```

在控制器中，我验证了上传文件和 taglist 上的一些信息。如果出现问题，我会像这样返回创建视图

```
ModelState.AddModelError("", "You must provide at least one tag");
return View(recipe); 
```

问题是用户提供的信息（要上传的文件或标签）在此过程中丢失。自从我将它们传递给视图以来，食谱中的所有字段都仍然存在。我不想丢失任何信息。

我该如何处理？什么是最好的方法？我已经考虑创建一个特殊模型，该模型将通过添加标签字符串来包装我的食谱模型，但我不知道如何处理文件的情况，因为它不是字符串。

任何帮助将不胜感激

*附加信息：*标签字符串不在配方模型中，因为标签不是数据库中的字符串，它们是附加到配方的标签列表。由于我使用的是一个需要字符串的 jQuery 插件，所以我这样做了，在控制器中我拆分了标签字符串并将它们添加到数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:25:38.030

使用包含所有信息的视图模型。在最简单的形式中，它可能看起来像：

```
public class RecipeViewModel()
{
    public RecipeViewModel()
    {
        Recipe = new Recipe();
    }

    public Recipe Recipe { get; set; }
    public string TagList { get; set; }
    public HttpPostedFileBase File { get; set; }
} 
```

然后，将此模型用于您的操作和视图：

```
public ActionResult Create(RecipeViewModel model)
{
    ...
} 
```

# ruby - 使用 google-drive-ruby gem 在 google drive 中创建文件夹

> ID：15798141
> 
> 赞同：6
> 
> 时间：2013-04-03T21:07:30.760
> 
> 标签：ruby, google-drive-api

我知道这里问了一个类似的问题，但是我仍然无法完成这项工作，因为我的情况有点不同。我希望能够使用[google-drive-ruby gem](https://github.com/gimite/google-drive-ruby)在 google drive 中创建一个文件夹。

根据谷歌（[https://developers.google.com/drive/folder](https://developers.google.com/drive/folder)），使用“Drive”Api 时，您可以通过插入具有 mime 类型“application/vnd.google-apps.folder”的文件来创建文件夹

例如

```
POST https://www.googleapis.com/drive/v2/files
Authorization: Bearer {ACCESS_TOKEN}
Content-Type: application/json
...
{
  "title": "pets",
  "parents": [{"id":"0ADK06pfg"}]
  "mimeType": "application/vnd.google-apps.folder"
} 
```

就我而言，我希望能够做同样的事情，但在使用 google_drive API 时。它具有接受 mime-type 选项的 upload_from_file 选项，但这仍然对我不起作用，到目前为止我得到的最好结果是执行以下代码时是来自 Google 的此错误消息。

session.upload_from_file("test.zip", "test", :content_type => "application/vnd.google-apps.folder")

> “Mime-type application/vnd.google-apps.folder 无效。无法使用 Google mime-types 创建文件。

如果您能给我任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-12-05T20:40:36.030

这实际上非常简单。Google Drive 中的文件夹是[google-drive-ruby gem](https://github.com/gimite/google-drive-ruby/)`GoogleDrive::Collection`中的( [http://gimite.net/doc/google-drive-ruby/GoogleDrive/Collection.html](http://gimite.net/doc/google-drive-ruby/GoogleDrive/Collection.html) ) 。因此，您可以使用 google-drive-ruby 做的事情是首先创建一个文件，然后通过该方法将其添加到集合中。`GoogleDrive::Collection#add(file)`

这也模仿了 Google Drive 的实际工作方式：将文件上传到根集合/文件夹，*然后*将其添加到其他集合/文件夹。

这是我编写的一些示例代码。根据您提供的上下文，它应该可以工作 - 可能对您的特定用例进行一些小的调整：

```
# this example assumes the presence of an authenticated
# `GoogleDrive::Session` referenced as `session`
# and a file named `test.zip` in the same directory
# where this example is being executed

# upload the file and get a reference to the returned
# GoogleSpreadsheet::File instance
file = session.upload_from_file("test.zip", "test")

# get a reference to the collection/folder to which
# you want to add the file, via its folder name
folder = session.collection_by_title("my-folder-name")

# add the file to the collection/folder. 
# note, that you may add a file to multiple folders
folder.add(file) 
```

此外，如果您只想创建一个新文件夹，而不在其中放置任何文件，则只需将其添加到根集合中：

```
session.root_collection.create_subcollection("my-folder-name") 
```

# javascript - 构建一个不定维度的数组

> ID：15798142
> 
> 赞同：0
> 
> 时间：2013-04-03T21:07:32.697
> 
> 标签：javascript, jquery

我希望构建一个维数不定的数组。

我怎么能：

*   获取父数组的维数
*   循环浏览最外层的维度元素

我知道这可能是一个愚蠢的问题，但我是 javascript 的新手，所以请指导我。

[编辑]

我正在处理的项目将生成 html 代码（用于特定应用程序）。我会要求用户输入行和列（列按顺序嵌套在彼此下方）。

例子：

```
Rows = a,b,c
col1 = q,w,e
col2 = 1,2,3

It would generate a table like this:
| rows |  q  |  w  |  e  |
|      |1|2|3|1|2|3|1|2|3|
|  a   |x|x|x|x|x|x|x|x|x|
|  b   |x|x|x|x|x|x|x|x|x|
|  c   |x|x|x|x|x|x|x|x|x| 
```

但是正在询问一些自定义函数（如合并单元格、隐藏列等），所以我计划制作一个嵌套数组来保存这些列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:43:25.787

Java 脚本数组不是多维的，顺便说一下，您可以创建数组数组来实现相同的目的。

```
var xArrays = [[],[],[]]; 
```

虽然它们不是多维的，但它们可以随时调整大小。

```
xArrays.push([]);  xArrays[xArrays.length]=[]; //adding an array
xArrays.pop(); //removing an array 
```

遍历数组，

```
xArray.forEach(
        function(xTemp){ 
            alert(xTemp.length); //You can do your inner level iterations here. 
                      }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:14:07.800

如果我正确阅读了您的问题，则您正在尝试遍历一个非正方形的数组数组。您可以在外部数组的每个索引处获取 .length 属性以获取内部维度。

```
var one = [1];
var two = [1,1];
var three = [1,1,1];
var four = [1,1,1,1];
var five = [1,1,1,1,1];

var container = [one,two,three,four,five];
$("#outer").html(container.length);

for(var i =0; i < container.length; i++){
     $("#inner").append(container[i].length + ',');   
} 
```

[http://jsfiddle.net/ZPwrn/](http://jsfiddle.net/ZPwrn/) - 运行示例

# java - 从数组更改为堆栈中的节点

> ID：15798151
> 
> 赞同：0
> 
> 时间：2013-04-03T21:07:43.713
> 
> 标签：java, list, linked-list, stack, nodes

处理一项任务，但我开始做错了，我不太了解节点，需要一些帮助将我的堆栈代码从使用数组转换为节点。

这是我的堆栈代码。

```
public class Lstack {
    int size;
    int numUsed = 0;
    Car[] stack;
    public Lstack(){
        stack = new Car[size];
    }
    public void push(Car x){
        stack[numUsed] = x;
        numUsed++;
    }
    public Car pop(){
        Car temp;
        numUsed--;
        temp = stack[numUsed];
        return temp;
    }
    public boolean isEmpty(){
        if(numUsed==0){
            return true;
        }
        else
            return false;
    }
    public int size(){
        return numUsed;
    }
    public void display(){
        System.out.println("--------------------------------------------");
        System.out.print("TOP | ");
        for(int i = 0; i < numUsed; i++){
            System.out.print(stack[i].plate +" | ");
        }
        System.out.println("--------------------------------------------");
    }

} 
```

这是我的节点代码

```
public class Node {
    Node next;
    Car name;

    public Node(Node x, Car y){
        next = x;
        name = y;
    }
} 
```

如何更改 Lstack 类以使用 Node 类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:34:03.807

堆栈是反向的链表

对于链表，头节点是`first`集合中的节点，每个节点都指向该`next` 节点。
对于堆栈，头节点是`last`集合中的节点，每个节点都指向“上一个”节点。

所以对于一个堆栈我们有

```
 public void push(Node n){
     n.setNextNode(this.head);
     this.head = n;
 }

 public Node pop(){
     Node n = this.head;
     this.head = this.head.getNextNode();
     return n;
 } 
```

您将需要添加错误连接代码并使 Node 通用。

# r - 将包命名空间导入默认命名空间

> ID：15798154
> 
> 赞同：0
> 
> 时间：2013-04-03T21:07:49.903
> 
> 标签：r, namespaces

通常，当我使用 R 并且想了解函数的作用时，我会输入函数的名称并滚动浏览代码。但是，有时当我输入函数的名称时，我得到的响应并没有告诉我任何信息。

```
> library(limma)
> plotMDS #can't get to the code
function (x, ...) 
UseMethod("plotMDS")
<environment: namespace:limma>
> limma:::plotMDS
function (x, ...) 
UseMethod("plotMDS")
<environment: namespace:limma>
> heatmap #im expecting something more like this
function (x, Rowv = NULL, Colv = if (symm) "Rowv" else NULL, 
    distfun = dist, hclustfun = hclust, reorderfun = function(d, 
        w) reorder(d, w), add.expr, symm = FALSE, revC = identical(Colv, 
        "Rowv"), scale = c("row", "column", "none"), na.rm = TRUE, 
    margins = c(5, 5), ColSideColors, RowSideColors, cexRow = 0.2 + 
        1/log10(nr), cexCol = 0.2 + 1/log10(nc), labRow = NULL, 
    labCol = NULL, main = NULL, xlab = NULL, ylab = NULL, keep.dendro = FALSE, 
    verbose = getOption("verbose"), ...) 
{
    scale <- if (symm && missing(scale)) 
        "none"
    else match.arg(scale)
/* ... many lines removed ... */
    }
    invisible(list(rowInd = rowInd, colInd = colInd, Rowv = if (keep.dendro && 
        doRdend) ddr, Colv = if (keep.dendro && doCdend) ddc))
}
<bytecode: 0x16199b8>
<environment: namespace:stats> 
```

因此，我想知道是否有办法将包的命名空间导入默认命名空间，这样我就可以查看函数中的代码（并且更容易调试）。我一直在阅读命名空间，但大部分时间它是为开发人员编写的，所以它正在讨论如何为包导出命名空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:19:28.977

`plotMDS`是通用函数。您通过`plotMDS`和访问`limma:::plotMDS`的内容完全相同，后者的效率较低。你想要得到的是这个通用函数的**方法**。

查看`plotMDS`尝试的方法列表

```
methods(plotMDS) 
```

这将返回一个函数名向量。我无法安装**limma**，所以这是我们看到的基本`plot`泛型 [在我当前的会话中]：

```
> methods(plot)
 [1] plot.acf*            plot.correspondence* plot.data.frame*    
 [4] plot.decomposed.ts*  plot.default         plot.dendrogram*    
 [7] plot.density         plot.ecdf            plot.factor*        
[10] plot.formula*        plot.function        plot.hclust*        
[13] plot.histogram*      plot.HoltWinters*    plot.isoreg*        
[16] plot.lda*            plot.lm              plot.mca*           
[19] plot.medpolish*      plot.mlm             plot.ppr*           
[22] plot.prcomp*         plot.princomp*       plot.profile*       
[25] plot.profile.nls*    plot.ridgelm*        plot.spec           
[28] plot.stepfun         plot.stl*            plot.table*         
[31] plot.ts              plot.tskernel*       plot.TukeyHSD       

   Non-visible functions are asterisked 
```

要访问非星号函数的代码，我们只需输入完整的函数名称，例如

```
> plot.density
function (x, main = NULL, xlab = NULL, ylab = "Density", type = "l", 
    zero.line = TRUE, ...) 
{
.... 
```

要查看加星标的函数/方法的代码，您需要`pkg:::function`结构，例如`plot.data.frame`方法

```
> plot.data.frame
Error: object 'plot.data.frame' not found
> graphics:::plot.data.frame
function (x, ...) 
{
 .... 
```

如果您不知道某个方法属于哪个命名空间，请使用`getAnywhere`，例如

```
> getAnywhere(plot.data.frame)
A single object matching ‘plot.data.frame’ was found
It was found in the following places
  registered S3 method for plot from namespace graphics
  namespace:graphics
with value

function (x, ...) 
{
.... 
```

打印的结果表明相关的命名空间（在这种情况下`graphics`）加上返回函数的值或代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:28:43.567

这是一个非常粗糙的替代方案，但它可以满足要求：

首先，将命名空间的内容复制到全局环境中的一个列表中：

```
L <- as.list(asNamespace("yourpackage")) 
```

现在，您可以使用以下命令导航`L`或复制其所有内容到全局环境中同名的对象：

```
invisible(lapply(names(L), function(x) eval(parse(text=paste0(x,"<-L[['",x,"']]")), globalenv()))) 
```

警告：这将覆盖您使用相同名称定义的任何对象！所以要小心使用。

# java - Spring 集成 + @Aysnc - 网关与 ServiceActivator

> ID：15798155
> 
> 赞同：1
> 
> 时间：2013-04-03T21:07:50.390
> 
> 标签：java, spring, spring-integration

我有一个远程服务，当发生特定事件时，我正在调用它来加载产品的定价数据。一旦加载，产品定价就会被广播给另一个消费者以在其他地方处理。

调用代码不关心响应 - 它是即发即弃的，响应应用程序事件并触发新的工作流程。

为了使调用代码尽可能快，我想在这里使用@Async，但结果好坏参半。

基本流程是：

```
CallingCode -> ProductPricingGateway -> Aggregator -> BatchedFetchPricingTask 
```

这是异步设置：

```
<task:annotation-driven executor="executor" scheduler="scheduler"/>
<task:scheduler id="scheduler" pool-size="1" />
<task:executor id="executor" keep-alive="30" pool-size="10-20" queue-capacity="500" rejection-policy="CALLER_RUNS" /> 
```

使用的另外两个组件是启动代码调用的一个，以及位于聚合器后面的`@Gateway`下游。`@ServiceActivator`（呼叫被分成小组）。

```
public interface ProductPricingGateway {    
    @Gateway(requestChannel="product.pricing.outbound.requests")
    public void broadcastPricing(ProductIdentifer productIdentifier);
}

// ...elsewhere...
@Component
public class BatchedFetchPricingTask {
    @ServiceActivator(inputChannel="product.pricing.outbound.requests.batch")
    public void fetchPricing(List<ProductIdentifer> identifiers)
    {
        // omitted
    }
} 
```

以及其他相关的集成配置：

```
<int:gateway service-interface="ProductPricingGateway"
    default-request-channel="product.pricing.outbound.requests" />

<int:channel id="product.pricing.outbound.requests" />
<int:channel id="product.pricing.outbound.requests.batch" /> 
```

我发现如果我声明`@Async`该`@ServiceActivator`方法，它可以正常工作。但是，如果我在`@Gateway`方法上声明它（这似乎是一个更合适的地方），则永远不会调用聚合器。

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:26:52.733

我很难`@Async`在这里看到如何工作，因为起点是您的代码调用该`ProductPricingGateway.broadcastPricing()`方法的时间。

在`@Async`gw 上，调度程序会发送什么？

同样，`@Async`在服务上，调度程序会传入`identifiers`什么？

尽快实现异步的正确方法是创建`product.pricing.outbound.requests`一个`ExecutorChannel`...

[http://static.springsource.org/spring-integration/reference/html/messaging-channels-section.html#executor-channel](http://static.springsource.org/spring-integration/reference/html/messaging-channels-section.html#executor-channel)

[http://static.springsource.org/spring-integration/reference/html/messaging-channels-section.html#channel-configuration-executorchannel](http://static.springsource.org/spring-integration/reference/html/messaging-channels-section.html#channel-configuration-executorchannel)

...调用线程将消息传递给任务执行者。

# scala - 函数应用和类型关联

> ID：15798165
> 
> 赞同：5
> 
> 时间：2013-04-03T21:08:24.407
> 
> 标签：scala

在 Scala 中，函数应用程序关联到左侧，而函数类型关联到右侧（Scala 课程第二周）。我不明白这个。谁能解释一下？

“功能应用”和“功能类型”到底有什么区别？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-03T21:53:49.770

一般来说，关联性（左或右）是某个*符号*（运算符）的预定义属性，它告诉我们应该如何读取在链中多次使用该符号的表达式。

例如，Scala 中的函数应用程序是一个表达式，如`fun(param1, ...)`. 它可以被链接，例如：`fun(a,b)()(g,h)`. 并且它是左关联的事实意味着这样的表达式等价于`((fun(a,b))())(c,d)`，即（在伪代码中）：

```
( ( fun applied to arguments a and b ) applied to no arguments ) applied to arguments c and d 
```

Scala 中的函数类型是函数对象的一种类型。Scala 有其特定的*符号*来表示此类类型。此表示法使用`=>`运算符。例如`String => Int`，一种`String`以参数为参数并返回的函数`Int`。

现在，问题出现了，什么是`String => Int => Float`？`String`它是一个将函数作为参数的函数`Int`吗`Float`？或者也许它是一个从to获取`String`并返回一个函数的函数？`Int``Float`

换句话说，我们应该读`String => Int => Float`作`(String => Int) => Float`or`String => (Int => Float)`吗？如果`=>`运算符是左结合的，那么它将是`(String => Int) => Float`. 如果它是右结合的，它将是`String => (Int => Float)`。

正如我们所知，`=>`是右关联的，这意味着它`String => Int => Float`等价于`String => (Int => Float)`并且它表示一个函数的类型，该函数接受`String`并返回另一个函数，该函数接受`Int`并返回`Float`。

# jquery - Show() 无法使用 标签

> ID：15798168
> 
> 赞同：-3
> 
> 时间：2013-04-03T21:08:34.750
> 
> 标签：jquery, css, zurb-foundation

我有这个使用 Foundation 4 创建的下拉框。

```
<a href="#" data-dropdown="pipeline" class="small secondary radius button dropdown" >Select a Pipeline</a>
  <ul id="pipeline" data-dropdown-content class="f-dropdown ">
    <li>
      <a href="#" id="2d">2D Pipeline</a>
    </li>
    <li>
      <a href="#">3D Pipeline</a>
    </li>
  </ul> 
```

我想要做的是当用户点击 2D Pipeline 时，它​​应该显示一个`div`. 这是我的脚本。`div`文件加载时隐藏。

```
$(document).ready(function() {
  $("a[href*='teams_pipeline.html']").removeAttr("id");
  $("#2d_div").hide();
});
$("#pipeline li a#2d").click(function() {
   $("#2d_div").show();
}); 
```

此脚本当前不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:19:01.690

move the `click` handler piece within the `$(document).ready` function

```
$(document).ready(function () {
    $("a[href*='teams_pipeline.html']").removeAttr("id");
    $("#2d_div").hide();

    $("#pipeline li a#2d").click(function () {
        $("#2d_div").show();
    });
}); 
```

[jsfiddle demo](http://jsfiddle.net/pxfunc/7cmAY/)

also consider hiding the div initially with CSS instead of jQuery

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:11:45.233

您在页面加载时删除 id，尝试删除该位：

```
$("a[href*='teams_pipeline.html']").removeAttr("id"); 
```

从代码中，它应该可以工作。也许隐藏你的css中的div，在这种情况下使用javascript似乎没有必要，比如set

#2d-div{ 显示：无 }

?

# mysql - MySql在where子句中按值排序查询

> ID：15798170
> 
> 赞同：0
> 
> 时间：2013-04-03T21:08:46.907
> 
> 标签：mysql, sql-order-by

这是我的查询

```
select * from a_table where  
(19.1181753366684 between minlatitude and maxlatitude ) and (72.8504168987274 between minlongitude and maxlongitude) or
 (19.1181043770386 between minlatitude and maxlatitude ) and (72.8506743907928 between minlongitude and maxlongitude) or
 (19.1178306753238 between minlatitude and maxlatitude ) and (72.8506422042847 between minlongitude and maxlongitude) or
(19.1174454647353 between minlatitude and maxlatitude ) and (72.8505992889404 between minlongitude and maxlongitude) or
(19.1169791559797 between minlatitude and maxlatitude ) and (72.8505349159241 between minlongitude and maxlongitude) or
(19.1159857112009 between minlatitude and maxlatitude ) and (72.8504061698914 between minlongitude and maxlongitude) or
(19.1156309080473 between minlatitude and maxlatitude ) and (72.8503739833832 between minlongitude and maxlongitude) or
(19.1152862413976 between minlatitude and maxlatitude ) and (72.8502130508423 between minlongitude and maxlongitude) 
```

我希望结果集按照我在条件之间的 where 子句中使用的值的顺序进行排序。所以我的结果集是有序的

```
19.11817534
19.11810438
19.11783068
19.11744546
19.11697916
19.11598571
19.11563091 
```

那可能吗？

谢谢， 里兹万

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:14:02.947

我认为除了将其分解为按您选择的顺序执行的多个查询之外，您没有其他方法可以做到这一点。

问题是您没有要排序的任何实际字段或与结果集中的记录相关联的方法，这些记录与 WHERE 子句中的条件相关联（它们实际上可以匹配多个条件）。

作为替代方案，您可以创建过滤器数据的临时内存表，例如：

```
id   latitude          longitude
1    19.1181753366684  72.8504168987274
2    19.1181043770386  72.8506743907928
... 
```

跨表连接的 then 查询：

```
SELECT a_table.*, temp_table.id
FROM
a_table INNER JOIN temp_table
  ON temp_table.latitude BETWEEN a_table.minlatitude AND a_table.maxlatitude
  AND temp_table.longitude BETWEEN a_table.minlongitude AND a_table.maxlongitude
ORDER BY temp_table.id ASC 
```

显然，请确保您在`a_table`.

我不确定您想如何在这里处理重复项（可能需要对`SELECT DISTINCT`主键的用途进行处理`a_table`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:10:31.923

您可以使用`ORDER BY`子句来设置排序。如果您的列被称为纬度，您将使用

```
ORDER BY latitude 
```

如果您从循环中生成 WHERE 子句，您还可以使用 CASE 语句

```
ORDER BY CASE
  loop
    WHEN latitude = 19.11817534 THEN 1 --change the two values dynamically. 1 would be a counter
  end loop
ELSE 999 END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:14:40.563

```
SELECT  *
FROM    (
        SELECT  19.1181753366684 AS lat, 72.8504168987274 AS lon, 1 AS no
        UNION ALL
        SELECT  19.1181043770386 AS lat, 72.8506743907928 AS lon, 2 AS no
        UNION ALL
        ...
        ) p
JOIN    a_table a
ON      p.lat BETWEEN a.minlatitude AND a.maxlatitude
        AND p.lon BETWEEN a.minlongitude AND a.maxlongitude
ORDER BY
        no 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T21:21:32.560

这对你有用吗？

```
select * from a_table where  
(19.1181753366684 between minlatitude and maxlatitude ) and (72.8504168987274 between minlongitude and maxlongitude) or
(19.1181043770386 between minlatitude and maxlatitude ) and (72.8506743907928 between minlongitude and maxlongitude) or
 (19.1178306753238 between minlatitude and maxlatitude ) and (72.8506422042847 between minlongitude and maxlongitude) or
(19.1174454647353 between minlatitude and maxlatitude ) and (72.8505992889404 between minlongitude and maxlongitude) or
(19.1169791559797 between minlatitude and maxlatitude ) and (72.8505349159241 between minlongitude and maxlongitude) or
(19.1159857112009 between minlatitude and maxlatitude ) and (72.8504061698914 between minlongitude and maxlongitude) or
(19.1156309080473 between minlatitude and maxlatitude ) and (72.8503739833832 between minlongitude and maxlongitude) or
(19.1152862413976 between minlatitude and maxlatitude ) and (72.8502130508423 between minlongitude and maxlongitude)
ORDER BY maxlatitude, minlatitude DESC 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T21:44:52.600

我不明白您如何无法访问该表？但这是我的解决方案：

使用 PHP 或任何你想要的语言。对结果集进行排序的最简单方法是将结果存储在数组中并对其进行排序。

```
$result = execute(select * from a_table where (19.1181753366684 between minlatitude and maxlatitude ) and ...);

asort($result);

foreach($result AS $row){
    //do what you want in here
    echo $row;
} 
```

# c# - 如何从后台线程获取 WinPhone 8 的屏幕分辨率

> ID：15798176
> 
> 赞同：0
> 
> 时间：2013-04-03T21:09:09.113
> 
> 标签：c#, .net, xaml, windows-phone-8, dispatcher

我正在创建一个库。我们需要的一件事是手机的屏幕分辨率（以像素为单位）（宽乘高）

我们成功地使用了这个方法

```
Screen.Width = (int) System.Windows.Application.Current.Host.Content.ActualWidth;
Screen.Height = (int) System.Windows.Application.Current.Host.Content.ActualHeight; 
```

但是我们不处理后台线程调用此方法的情况，因此我们将其更改为使用 Dispatcher：

```
System.Windows.Application.Current.RootVisual.Dispatcher.BeginInvoke(() =>
  {
    Screen.Width = (int) System.Windows.Application.Current.Host.Content.ActualWidth;
    Screen.Height = (int) System.Windows.Application.Current.Host.Content.ActualHeight;
  }); 
```

但是，我们抛出了一个“无效的跨线程访问”异常，似乎只是在使用 BeginInvoke。

我们如何在不引用当前呈现的 XAML 页面的情况下正确处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:20:41.053

只是访问`Application.Current.RootVisual`会抛出一个无效的跨线程访问异常，所以无法通过这种方式访问​​调度器。相反，使用`System.Windows.Deployment.Current.Dispatcher`：

```
System.Windows.Deployment.Current.Dispatcher.BeginInvoke(() =>
{
    Screen.Width = (int) System.Windows.Application.Current.Host.Content.ActualWidth;
    Screen.Height = (int) System.Windows.Application.Current.Host.Content.ActualHeight;
}); 
```

# android - 数据库，因为 android 中的不同活动

> ID：15798177
> 
> 赞同：0
> 
> 时间：2013-04-03T21:09:10.300
> 
> 标签：android

我试图从不同的活动访问一个唯一的数据库，但是当我使用数据库时，我必须创建一个不同的数据库实例，因为每个活动都会产生不需要的结果，我如何管理不同活动的唯一数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:20:02.393

> 但是，当我使用数据库时，我必须创建一个不同的数据库实例，因为每个活动都会产生不需要的结果，我该如何管理一个独特的数据库，因为不同的活动？

那么你考虑过[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)吗？我认为您的问题直接指定为使用单例设计模式。使用只有好处（总是只有一个实例，不浪费内存，干净且人类可读的代码等）。

让我们写一些代码：

```
private static SQLiteOpenHelper instance;

public static SQLiteOpenHelper getInstance(Context c) {
   if (instance == null) {
      instance = new SQLiteOpenHelperImplementation(c);
   }
   return instance;
} 
```

我对单身人士只有很好的经验。

## 笔记：

为了改进您使用数据库的工作，我有一些建议给您：

*   如果您有多个表，我建议您创建“操作”类，这些类将包装`CRUD`每个表的操作和特定方法。

*   为了提高 db 的性能、安全性和完整性，请始终使用 `TRANSACTIONS`. 这是非常有用和有效的做法

*   在并发编程中，始终使用同步块和方法来避免与访问数据库和进行更改相关的问题

*   总是在工作完成后，释放你的游标并关闭数据库

# java - Java分割函数

> ID：15798179
> 
> 赞同：2
> 
> 时间：2013-04-03T21:09:13.823
> 
> 标签：java, split

嗨，我有一个关于 java split 的问题

```
ItemName,Item,,(width,length,height),12 
```

我想要 String[] 等于这个”

```
String[] result ={"ItemName","Item","","(width,length,height)","12"}; 
```

谁能帮助我使用拆分函数或其他正则表达式？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-03T21:12:53.297

如果您的输入字符串名为*istr*，则

```
 String[] result = istr.split(","); 
```

应该管用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-03T21:13:15.800

尝试这个

```
String data="ItemName,Item,,(width,length,height),12";
        String[] result=data.split("//,");
        for(String string : result) {

            System.out.println(string);
        } 
```

# android - FrameLayout 和屏幕百分比

> ID：15798188
> 
> 赞同：1
> 
> 时间：2013-04-03T21:09:39.327
> 
> 标签：android, android-linearlayout, percentage, android-framelayout

我有一个 FrameLayout，上面显示了一个 LinearLayout 我的意图是这个 LinearLayout 总是占据屏幕的 33% ......但我做不到。我尝试使用“dp”，但当然，结果因密度而异。如果它们是两个 LinearLayout，如果我可以使用 layout_weight = ".33" 和 layout_weight = ".67" 但 FrameLayout 在其中一个中使用。

我希望能正确解释

![在此处输入图像描述](https://i.stack.imgur.com/xDAwN.png)

提前致谢

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-08-18T11:56:26.417

[自 2015 年 8 月以来，您可以使用原生布局PercentFrameLayout](https://developer.android.com/reference/android/support/percent/PercentFrameLayout.html)和[PercentRelativeLayout](https://developer.android.com/reference/android/support/percent/PercentRelativeLayout.html)执行这种布局。从版本 23 开始，两者都可以在 Android 支持库中找到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-03T21:28:55.573

你可以尝试这样的事情。第一层是 ImageView，第二层有两个线性布局。

```
<FrameLayout
    android:layoit_height="match_parent"
    android:layout_width="match_parent">
    <ImageView
        android:layoit_height="match_parent"
        android:layout_width="match_parent"
        android:image="@drawable/screen_image"/> //blue image whith white "screen"

    <LinearLayout
        android:layoit_height="match_parent"
        android:layout_width="match_parent">
        <LinearLayout
            android:layoit_height="0dp"
            android:layout_weight=".67"
            android:layout_width="match_parent"
            android:background="#00000000"/>

        <LinearLayout
            android:layoit_height="0dp"
            android:layout_weight=".33"
            android:layout_width="match_parent"
            android:background="#44FF0000"> //33% layout

            //children for 33% layout here

        </LinearLayout>
    </LinearLayout>

</FrameLayout> 
```

# php - php preg_match 搜索模式

> ID：15798190
> 
> 赞同：-2
> 
> 时间：2013-04-03T21:09:51.997
> 
> 标签：php, html-parsing, preg-match-all

我有一张桌子，想得到一个二维数组（每行和每行的单元格值）。我知道我必须使用 preg_match 但我不擅长创建模式。

你能帮帮我吗？会非常好！！！！

谢谢！！！

这是我的表结构：

```
<table class="maintable">
<tr>
<td class="headtable">
Tag
</td>
<td class="headtable">
Klasse
</td>
<td class="headtable">
Zeit
</td>
<td class="headtable">
Pos
</td>
<td class="headtable">
Lehrer
</td>
<td class="headtable">
Fach
</td>
<td class="headtable">
Raum
</td>
<td class="headtable">
Info
</td>
<td class="headtable">
Art
</td>
</tr>
<tr class="evenrow">
<td class="evencell">
Mo
</td>
<td class="evencell">
05a
</td>
<td class="evencell">
09:45
</td>
<td class="evencell">
3\. Stunde
</td>
<td class="evencell">
+TIN (KOL)
</td>
<td class="evencell">
In En
</td>
<td class="evencell">
223
</td>
<td class="evencell">

</td>
<td class="evencell">
Geändert
</td>
</tr>
<tr class="oddrow">
<td class="oddcell">
&nbsp
</td>
<td class="oddcell">
&nbsp
</td>
<td class="oddcell">
10:30
</td>
<td class="oddcell">
4\. Stunde
</td>
<td class="oddcell">
+TIN (KOL)
</td>
<td class="oddcell">
In En
</td>
<td class="oddcell">
223
</td>
<td class="oddcell">

</td>
<td class="oddcell">
Geändert
</td>
</tr>
<tr class="evenrow">
<td class="evencell">
&nbsp
</td>
<td class="evencell">
&nbsp
</td>
<td class="evencell">
13:45
</td>
<td class="evencell">
8\. Stunde
</td>
<td class="evencell">
+NUS (CRI), WIK
</td>
<td class="evencell">
Comp
</td>
<td class="evencell">
022 INF2, 021 INF1
</td>
<td class="evencell">

</td>
<td class="evencell">
Geändert
</td>
</tr>
<tr class="oddrow">
<td class="oddcell">
&nbsp
</td>
<td class="oddcell">
05b
</td>
<td class="oddcell">
07:55
</td>
<td class="oddcell">
1\. Stunde
</td>
<td class="oddcell">
+WEP (SMA)
</td>
<td class="oddcell">
EN
</td>
<td class="oddcell">
121
</td>
<td class="oddcell">

</td>
<td class="oddcell">
Geändert
</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T21:46:18.250

正如评论中所说，使用正则表达式解析 HTML 不是一个好主意。无论如何，这是使用 preg_match_all 实现它`$input`的方法，假设包含输入字符串：

```
<?php

preg_match_all('#<tr[^>]*>(.*?)</tr>#is', $input, $lines);

$result = array();

foreach ($lines[1] as $k => $line) {
    preg_match_all('#<td[^>]*>(.*?)</td>#is', $line, $cell);

    foreach ($cell[1] as $cell) {
        $result[$k][] = trim($cell);
    }
}

var_dump($result);

?> 
```

# php - 将 PHP 输出写入文本字段

> ID：15798197
> 
> 赞同：0
> 
> 时间：2013-04-03T21:10:16.197
> 
> 标签：php, javascript, html, ajax, dom

我试过四处寻找这个问题的答案，但似乎找不到。

我有一个数据库，它接收两条信息并将其返回为成功或不成功。

我希望能够按下“提交”按钮，然后运行我的 PHP 查询（这很好），以便在完成后将回显打印到文本框中。

```
echo '<form name="enrolled" method="post" action="<MY FUNCTION HERE>"><select name="course">'; 
```

一旦我的功能完成，它会回显一些东西。我想要一个显示回声的文本框。

我遇到的问题是它不能实时工作，我可以很容易地在文本框中显示回声，但我不能让它保持空白，然后一旦功能完成，填充框。

感谢您花时间阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:16:32.460

正如 nathan 所说，您似乎对 php 作品有点困惑。它编写 HTML（或其他内容），并将其发送到呈现它的浏览器。在您向服务器发送另一个请求之前，PHP 处于空闲状态。如果您不想从当前页面转换但更新其内容，那么您需要创建 javascript，当触发时向服务器发出请求（并在服务器响应时采取适当的操作。

如果您在 Google 上搜索[PHP Ajax 教程](https://www.google.co.uk/search?aq=f&sourceid=chrome&ie=UTF-8&q=php%20ajax%20tutorial)，您会发现很多示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:18:17.870

一点也不优雅，只是呼应了整个领域……

```
echo "<input type='text' name='something' value='the value you want to echo'>"; 
```

不太确定您要在 PHP 中做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:21:30.087

[html 表单操作属性](http://www.w3.org/TR/html401/interact/forms.html#adef-action)应该是 URI，而不是 javascript 函数。

要实时更新表单或只是输入，您可以使用 javascript 并执行 ajax 请求。如果你想让它变得快速和快速，我建议你使用[Mootools Request 类](http://mootools.net/docs/core/Request/Request)在你的表单中进行 ajax 更新。

您可以在 Mootools 站点中查看[ajax](http://mootools.net/demos/?demo=Request)实时更新（HTML、PHP、Javascript）的完整演示示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T21:23:09.443

两种方法：

通过发布和刷新：

你的表单就像 script.php

```
<?php
    $result = "Hello world!"; //Do your logic anywhere but be sure to set the result here
?>
<form method="post" action="script.php">
....
<input type="text" value="<?= $result?>" readOnly>
<input type="submit">
</form> 
```

另一种方法是通过 AJAX，这需要更多的研究。试试这个，简单多了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T21:25:24.453

您需要使用发布表单`AJAX`，然后在框中显示结果。使用 jQuery 库很容易完成。要包含 jQuery 库，只需将其添加到您的 html 头

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script> 
```

然后您可以使用此脚本提交表单

```
<script type="text/javascript">
    $(document).ready(function(){
        $("#myform").submit( function () {    
          $.post(
           'post.php',
            $(this).serialize(),
            function(data){
              $("#result").html(data)
            }
          );
          return false;   
        });   
    }); 
```

post.php 在您正在调用的脚本的名称中，它将接收表单并返回答案。`myform`是表单`result`的 ID，是您想要显示结果的框的 ID。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-03T21:43:46.050

您以错误的方式考虑 PHP；PHP 不直接与 Web 浏览器交互。你需要的是[AJAX](https://en.wikipedia.org/wiki/Ajax_%28programming%29)。原因如下：

1.  客户端（Web 浏览器）向 Web 服务器（apache、lighttpd 等）发送请求
2.  Web 服务器解释该请求，并（在这种情况下）将其交给 PHP
3.  PHP 根据 Web 服务器给它的输入回显结果
4.  Web 服务器将该结果发送回 Web 浏览器
5.  Web 浏览器决定如何处理该信息

现在，如果这是您导航到网页，则 ​​Web 浏览器会呈现由您的 Web 服务器生成的内容（使用 PHP 生成它）。如果网络服务器已经响应，就是这样——你已经得到了响应。要获取更多信息，您必须提出新请求，这意味着您必须执行以下两件事之一（通常）：

*   通过提交表单、重新加载、导航到新页面等方式在浏览器中导航。
*   使用 Javascript（由客户端执行，而不是服务器）发出“后台”请求

使用 Javascript “在后台”发出请求并在不重新加载的情况下更新页面的技术称为**AJAX**，完成任务的方法有很多，但迄今为止最简单和最流行的方法是使用[JQuery 库](http://jquery.com/)，这是一个很棒的工具包，包含有用的功能和对 Javascript 的补充，使使用起来不那么痛苦（甚至令人愉快！）——包括[一个使用 POST 方法发出 AJAX 请求的简单函数](http://api.jquery.com/jQuery.post/)。

关于这个主题有很多东西要学，但希望这能让你对完成这项任务所需的知识有足够的了解。

# html - html5在play框架中多次提交

> ID：15798200
> 
> 赞同：0
> 
> 时间：2013-04-03T21:10:26.800
> 
> 标签：html, playframework, form-submit

我需要用 play framework 2.1 做这样的事情：

```
@form(routes.PedidoCtrl.carregaTabela){
   //...
   <input type="submit" value="Page 1">
   <input type="submit" formaction="????" value="Page 2">
   <input type="submit" formaction="????" formmethod="post" value="Page 3">
} 
```

但是我应该在“formaction”字段中输入什么？我从未使用过“formaction”属性，但我看到这就是我想要在此页面中执行的操作：http: [//cbsa.com.br/post/formulario-com-multiplos-submit-e-method-em -html5.aspx](http://cbsa.com.br/post/formulario-com-multiplos-submit-e-method-em-html5.aspx)（葡萄牙语）

感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:49:19.290

我也从未见过，但它似乎非常有用。

您将使用已在`@form`帮助程序上使用的相同反向路由。我修改了您的示例代码。显然，只需将“action2”和“action3”替换为您的其他操作方法即可。

```
@form(routes.PedidoCtrl.carregaTabela){
  //...
  <input type="submit" value="Page 1">
  <input type="submit" formaction="@routes.PedidoCtrl.action2" value="Page 2">
  <input type="submit" formaction="@routes.PedidoCtrl.action3" formmethod="@routes.PedidoCtrl.action3.method" value="Page 3">
} 
```

注意`@`“routes.PedidoCtrl...”前面的转义字符

反向路由返回一个`play.api.mvc.Call`实例。该类有一个`url()`方法，该方法是为您的`formaction`属性获取输出的方法（它正在调用`toString`，而后者又调用`url`）。还有`method()`可以用于`formmethod`属性的方法。

# c# - 参数替换占位符后，如何查看发送到数据库的 SQL？

> ID：15798207
> 
> 赞同：3
> 
> 时间：2013-04-03T21:10:51.680
> 
> 标签：c#, sql, sql-server-ce, windows-ce, .net-1.0

下面的第一个 MessageBox.Show() 只是向我显示了与 const string SQL_GET_VENDOR_ITEMS 完全相同的内容，这对我来说似乎很好，但我得到了，“*解析查询时出错。[令牌行号，令牌行偏移量， , 令牌错误,,]* "

添加参数后，有没有办法监视 SQL 的内容；然后它应该是这样的：“选择 ItemID, PackSize FROM VendorItems WHERE VendorID = 'TEST' AND VendorItemID = '852963'

这是相关的代码：

```
 const string SQL_GET_VENDOR_ITEMS = "SELECT ItemID, PackSize " + 
        "FROM VendorItems " +
         "WHERE VendorID = @VendorID AND VendorItemID = @VendorItemID";

    string retVal = string.Empty;
    checkConnection();
    SqlCeCommand vendorCMD = objCon.CreateCommand();
    try 
    {
        vendorCMD.CommandText = SQL_GET_VENDOR_ITEMS;
        vendorCMD.Parameters.Add("@VendorID", SqlDbType.NVarChar, 10).Value = VendorID; 
        vendorCMD.Parameters.Add("@VendorItemID", SqlDbType.NVarChar, 19).Value = VendorItemID;

        MessageBox.Show(string.Format("Made it up to vendorCMD.ExecuteReader() with sql {0}", vendorCMD.CommandText));

. . .

        vendorReader.Close();
    } 
    catch (SqlCeException sqlceex)
    {
        MessageBox.Show(string.Format("SqlCeException in GetValsForVendorAndItem == {0}", sqlceex.Message));//TODO: Remove
    }
    finally 
    {
        vendorCMD.Dispose();
    }
    return retVal; 
```

. . .

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:25:29.313

> 但我几乎可以保证这在我的 VS2003/.NET 1.0 世界中不起作用

啊……版本 - 请参阅[MSDN](http://msdn.microsoft.com/en-gb/library/system.data.sqlserverce.sqlcecommand.parameters%28v=vs.71%29.aspx)：

> **当 CommandType 设置为Text**时，SQL Server CE 的 .NET Compact Framework 数据提供程序不支持将参数传递给由 SqlCeCommand 调用的 SQL 语句的命名参数。您必须使用问号 (?) 占位符。例如：`SELECT * FROM Customers WHERE CustomerID = ?`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:22:35.673

由于您使用的是 CE，因此您的选择有限，但是对于如何查看数据库有一些建议：[Profiler for Sql CE](https://stackoverflow.com/questions/225121/profiler-for-sql-ce)

如果您使用的是普通 SQL Server，则可以考虑使用[SQL Profiler](http://msdn.microsoft.com/en-us/library/ff650699.aspx)。您将能够看到对数据库执行的操作。

# jquery - 如果我想每次都为渲染元素执行一个动作，使用哪个 jquery 事件？

> ID：15798208
> 
> 赞同：0
> 
> 时间：2013-04-03T21:10:56.320
> 
> 标签：jquery, events, render

我正在尝试使用 jquery 插件。我在 ready() 函数中按照其标准初始化了插件。现在，我想执行一些操作，例如每次由 jquery 创建此插件对象时显示一条文本消息。

我可以为此使用哪个 jQuery 事件？

我是 jquery 的新手，在 jquery 文档中没有找到像“render”这样的事件。

```
$(document).ready(function() {
    $('#divId').pluginName({
       //specify elements in the plugin as per its docs
    }); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:15:58.787

There are callbacks built into some plugins, however it is pretty impossible to help you without knowing more information. Which plugin are you using and what end result are you trying to achieve?

# python - Pandas 对 HDFStore 中的大数据进行“分组”查询？

> ID：15798209
> 
> 赞同：21
> 
> 时间：2013-04-03T21:11:03.723
> 
> 标签：python, pandas, pytables

我有大约 700 万行，`HDFStore`有 60 多列。数据超出了我的内存。我希望根据“A”列的值将数据聚合成组。pandas [split/aggregating/combining](http://pandas.pydata.org/pandas-docs/stable/groupby.html)的文档假设我已经拥有了所有数据`DataFrame`，但是我无法将整个存储区读入 in-memory `DataFrame`。将数据分组的正确方法是`HDFStore`什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-04T00:00:19.990

这是一个完整的例子。

```
import numpy as np
import pandas as pd
import os

fname = 'groupby.h5'

# create a frame
df = pd.DataFrame({'A': ['foo', 'foo', 'foo', 'foo',
                         'bar', 'bar', 'bar', 'bar',
                         'foo', 'foo', 'foo'],
                   'B': ['one', 'one', 'one', 'two',
                         'one', 'one', 'one', 'two',
                         'two', 'two', 'one'],
                   'C': ['dull', 'dull', 'shiny', 'dull',
                         'dull', 'shiny', 'shiny', 'dull',
                         'shiny', 'shiny', 'shiny'],
                   'D': np.random.randn(11),
                   'E': np.random.randn(11),
                   'F': np.random.randn(11)})

# create the store and append, using data_columns where I possibily
# could aggregate
with pd.get_store(fname) as store:
    store.append('df',df,data_columns=['A','B','C'])
    print "store:\n%s" % store

    print "\ndf:\n%s" % store['df']

    # get the groups
    groups = store.select_column('df','A').unique()
    print "\ngroups:%s" % groups

    # iterate over the groups and apply my operations
    l = []
    for g in groups:

        grp = store.select('df',where = [ 'A=%s' % g ])

        # this is a regular frame, aggregate however you would like
        l.append(grp[['D','E','F']].sum())

    print "\nresult:\n%s" % pd.concat(l, keys = groups)

os.remove(fname) 
```

输出

```
store:
<class 'pandas.io.pytables.HDFStore'>
File path: groupby.h5
/df            frame_table  (typ->appendable,nrows->11,ncols->6,indexers->[index],dc->[A,B,C])

df:
      A    B      C         D         E         F
0   foo  one   dull -0.815212 -1.195488 -1.346980
1   foo  one   dull -1.111686 -1.814385 -0.974327
2   foo  one  shiny -1.069152 -1.926265  0.360318
3   foo  two   dull -0.472180  0.698369 -1.007010
4   bar  one   dull  1.329867  0.709621  1.877898
5   bar  one  shiny -0.962906  0.489594 -0.663068
6   bar  one  shiny -0.657922 -0.377705  0.065790
7   bar  two   dull -0.172245  1.694245  1.374189
8   foo  two  shiny -0.780877 -2.334895 -2.747404
9   foo  two  shiny -0.257413  0.577804 -0.159316
10  foo  one  shiny  0.737597  1.979373 -0.236070

groups:Index([bar, foo], dtype=object)

result:
bar  D   -0.463206
     E    2.515754
     F    2.654810
foo  D   -3.768923
     E   -4.015488
     F   -6.110789
dtype: float64 
```

一些警告：

1) 如果您的团队密度相对较低，这种方法是有意义的。在数百或数千组的顺序上。如果你得到的不止这些，还有更有效的（但更复杂的方法），并且你正在应用的函数（在这种情况下`sum`）变得更具限制性。

本质上，您将按块迭代整个商店，随时分组，但只保持组半折叠（想象做一个平均值，所以您需要保持运行总数加上运行计数，然后在最后除） . 所以一些操作会有点棘手，但可能会处理许多组（并且非常快）。

2）可以通过保存坐标来提高效率（例如组位置，但这有点复杂）

3）这种方案不可能进行多分组（这是可能的，但需要一种更像上面2的方法）

4）您要分组的列，必须是 data_column！

5）您可以在选择 btw 中组合您希望的任何其他过滤器（顺便说一句，这是一种狡猾的多分组方式，您只需在它们的乘积上形成 2 个唯一的组和迭代器列表，如果您有很多则不是非常有效组，但可以工作）

高温高压

让我知道这是否适合你

# java - Spring 3.1.1 MVC @Cacheable 未命中

> ID：15798210
> 
> 赞同：5
> 
> 时间：2013-04-03T21:11:04.283
> 
> 标签：java, spring, spring-mvc, ehcache

我正在编写一个 webapp，并尝试缓存一些从控制器调用的 pojo。

当我尝试使用 org.springframework.cache.annotation.Cacheable 时，我无法得到任何工作，所以我切换到 com.googlecode.ehcaceh.annotations.Cacheable，但我仍然无法将其缓存。

我的代码如下所示：

```
@Controller
 public class Conttroller {
    @RequestMapping(method = RequestMethod.GET)....
    public Person getPerson(String id) {
        LOG.debug("Trying to get resource...);
        Person person = personService.detect(id);
        LOG.debug("got person"); 
```

服务看起来像：

```
public class PersonService {

@Cacheable(cacheName="deviceCache") 
public Person detect(String id) {
LOG.debug("cache missed") 
```

我的 applicationContext 看起来像

```
<context:component-scan base-package="com.mycompany" />

         <ehcache:annotation-driven cache-manager="ehCacheManager" />
         <bean id="cacheManager"      class="org.springframework.cache.ehcache.EhCacheCacheManager">
            <property name="cacheManager">
                <ref bean="ehCacheManager" />
            </property>
        </bean>
        <bean id="ehCacheManager" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" p:configLocation="/META-INF/ehcache.xml" /> 
```

我的 ehcache 看起来像：

```
<defaultCache eternal="false" maxElementsInMemory="1000"
    overflowToDisk="false" diskPersistent="false" timeToIdleSeconds="0"
    timeToLiveSeconds="600" memoryStoreEvictionPolicy="LRU"/>

<cache name="deviceCache"
    maxElementsInMemory="100" overflowToDisk="false" diskPersistent="false"
    timeToIdleSeconds="0" timeToLiveSeconds="300"
    memoryStoreEvictionPolicy="LRU" /> 
```

有趣的是它在我的单元测试中缓存得很好......

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({"classpath:META-INF/applicationContext-test.xml"})
public class PersonServiceTest {

private static final Logger LOG = LoggerFactory.getLogger(PersonServiceTest.class);
@Test
public void testCache() {
    LOG.debug("Getting person...");
    Device detect = personService.detect("test");
    LOG.debug("Getting person again ...");
    detect = personService.detect("test");
    LOG.debug("Done");
} 
```

产生：

```
 13:45:02.885 [main] DEBUG PersonServiceTest - Getting person...
13:45:02.887 [main] DEBUG c.g.e.a.i.CacheAttributeSourceImpl - Adding CACHE advised method 'detect' with attribute: CacheableAttributeImpl [cacheInstanceResolver=com.googlecode.ehcache.annotations.resolver.SingletonCacheableCacheResolver@5c2bfdff, cacheKeyGenerator=HashCodeCacheKeyGenerator [includeMethod=true, includeParameterTypes=true, useReflection=false, checkforCycles=false], parameterMask=ParameterMask [mask=[]]]
13:45:02.889 [main] DEBUG c.g.e.a.i.EhCacheInterceptor - Generated key '-1043428721379252' for invocation: ReflectiveMethodInvocation: public abstract com.mycompany.Person com.mycompany.PersonServiceImpl.detect(java.lang.String); target is of class [com..mycompany.PersonServiceImpl]
13:45:02.889 [main] DEBUG PersonServiceTest - Missed 
13:45:02.927 [main] DEBUG PersonServiceTest  - Getting person again ...
13:45:02.927 [main] DEBUG c.g.e.a.i.EhCacheInterceptor - Generated key '-1043428721379252' for invocation: ReflectiveMethodInvocation:
13:45:02.927 [main] DEBUG PersonServiceTest  - Done 
```

但是我的战争（通过tomcat7/eclipse wtp运行）的输出是：

```
 DEBUG net.sf.ehcache.config.ConfigurationFactory Configuring ehcache from InputStream
DEBUG net.sf.ehcache.config.BeanHandler Ignoring ehcache attribute xmlns:xsi
DEBUG net.sf.ehcache.config.BeanHandler Ignoring ehcache attribute xsi:noNamespaceSchemaLocation
DEBUG net.sf.ehcache.util.PropertyUtil propertiesString is null.
DEBUG net.sf.ehcache.config.ConfigurationHelper No CacheManagerEventListenerFactory class specified. Skipping...
DEBUG net.sf.ehcache.Cache No BootstrapCacheLoaderFactory class specified. Skipping...
DEBUG net.sf.ehcache.Cache CacheWriter factory not configured. Skipping...
DEBUG net.sf.ehcache.config.ConfigurationHelper No CacheExceptionHandlerFactory class specified. Skipping...
DEBUG net.sf.ehcache.Cache No BootstrapCacheLoaderFactory class specified. Skipping...
DEBUG net.sf.ehcache.Cache CacheWriter factory not configured. Skipping...
DEBUG net.sf.ehcache.config.ConfigurationHelper No CacheExceptionHandlerFactory class specified. Skipping...
DEBUG net.sf.ehcache.store.MemoryStore Initialized net.sf.ehcache.store.NotifyingMemoryStore for deviceCache
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Pass-Through Statistic: LOCAL_OFFHEAP_SIZE
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Pass-Through Statistic: LOCAL_OFFHEAP_SIZE_BYTES
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Pass-Through Statistic: LOCAL_DISK_SIZE
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Pass-Through Statistic: LOCAL_DISK_SIZE_BYTES
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Pass-Through Statistic: WRITER_QUEUE_LENGTH
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Pass-Through Statistic: REMOTE_SIZE
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: OFFHEAP_GET
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: OFFHEAP_PUT
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: OFFHEAP_REMOVE
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: DISK_GET
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: DISK_PUT
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: DISK_REMOVE
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: XA_COMMIT
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: XA_ROLLBACK
DEBUG net.sf.ehcache.statistics.extended.ExtendedStatisticsImpl Mocking Operation Statistic: XA_RECOVERY
DEBUG net.sf.ehcache.Cache Initialised cache: deviceCache
DEBUG net.sf.ehcache.config.ConfigurationHelper CacheDecoratorFactory not configured. Skipping for 'personCache'.
DEBUG net.sf.ehcache.config.ConfigurationHelper CacheDecoratorFactory not configured for defaultCache. Skipping for 'personCache'.
DEBUG com.googlecode.ehcache.annotations.impl.CacheAttributeSourceImpl Adding CACHE advised method 'detect' with attribute: CacheableAttributeImpl [cacheInstanceResolver=com.googlecode.ehcache.annotations.resolver.SingletonCacheableCacheResolver@7a1b0c08, cacheKeyGenerator=HashCodeCacheKeyGenerator [includeMethod=true, includeParameterTypes=true, useReflection=false, checkforCycles=false], parameterMask=ParameterMask [mask=[]]]
Apr 3, 2013 2:03:12 PM org.springframework.web.context.ContextLoader initWebApplicationContext
DEBUG com.mycompany.Controller trying to get resource'
DEBUG com.mycompany.PersonServiceImpl Missed 
DEBUG com.mycompany.Controller got person'
DEBUG com.mycompany.Controller trying to get resource'
DEBUG com.mycompany.PersonServiceImpl Missed 
DEBUG com.mycompany.Controller got person' 
```

所以我的问题是，为什么它在我的单元测试中有效，而不是 webapp？我将如何使用 spring 注释而不是 googlecode 注释？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T03:14:57.613

您的`PersonService`服务未实现接口。Ehcache-spring-annotations 需要一个接口，如[常见问题解答](https://code.google.com/p/ehcache-spring-annotations/wiki/FrequentlyAskedQuestions)中所述：

> 要求 1：你的类必须实现一些（任何）接口。如果您的类没有实现接口，则该项目将无法创建代理来模仿您的类并在您的注释方法周围应用缓存语义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T16:17:41.260

即使我有一个接口，我在实现类上也有 @Cacheable 注释。一旦我将它移动到接口类，它就会被缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-27T14:24:01.407

您需要在 spring 上下文 xml 或 Spring 配置文件中启用 eh 缓存注释。例如

```
<ehcache:annotation-driven cache-manager="ehCacheManager" /> 
```

# search-box - 将谷歌搜索框添加到我的网站

> ID：15798215
> 
> 赞同：0
> 
> 时间：2013-04-03T21:11:44.217
> 
> 标签：search-box

我一直在研究如何将 Google 搜索框添加到我的网站。基本上，文本框和一个“开始”按钮，将搜索网络 - 除了我的网站。我以前到处都能看到这些。

现在想起来了，虽然好久没看到了。我在研究中遇到的所有东西最迟都是从 2010 年初开始的。一些搜索说 Google 在 2009 年弃用了我正在寻找的 API？

是否仍然可以获得用于在您的页面上进行 Google 搜索的代码？你知道哪里吗？必应或雅虎也可以。谢谢，

克里斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:15:43.410

You should look at Google Custom Search Engines - [http://www.google.com/cse/all](http://www.google.com/cse/all)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:18:55.783

Try the google jsapi, look at the Hello World - Google Web Search API Sample and adjust to your layout, [https://developers.google.com/web-search/docs/](https://developers.google.com/web-search/docs/)

# c# - 如何让你的 if 更短？

> ID：15798217
> 
> 赞同：1
> 
> 时间：2013-04-03T21:11:47.073
> 
> 标签：c#

我知道在使用 Regex 时，我可以输入值`|`来搜索许多值。例如：

```
Regex sabrina = new Regex("Rihanna|rihanna|Sabrina|sabrina"); 
```

我有一个字符串，我想与其他值进行比较，所以我这样使用`if`：

```
if (rihanna == "Rihanna" || rihanna == "sabrina") 
```

我的问题是是否可以`if`缩短？我知道这段代码不起作用，但我正在寻找这样的东西：

```
if (rihanna == "Rihanna|sabrina") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T21:15:48.847

单线解决方案：

```
if("Rihanna|rihanna|Sabrina|sabrina".Split(new[] {'|'}).Contains(rihanna)) 
```

或不`String.Split`使用方法：

```
if ((new[] { "Rihanna", "rihanna", "Sabrina", "sabrina" }).Contains(rihanna)) 
```

如果多次执行这种检查，则应将`string[]`可能值的数组保存到变量中：

```
var names = new[] { "Rihanna", "rihanna", "Sabrina", "sabrina" };

if(names.Contains(rihanna)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:13:04.100

您可以将 a`List<string>`与该[`Enumerable.Contains`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.contains.aspx)方法一起使用。

例子：

```
var values = new List<string> { "Rihanna", "rihanna", "Sabrina", "sabrina" };

if (values.Contains(rihanna)) 
{
    // etc.
} 
```

该`if`语句现在更加简洁，您可以快速轻松地将更多项目添加到您的列表中。如果您经常执行此操作，您应该将列表的声明移动到包含类中的成员变量，这样您就不会在每次调用此方法时产生列表初始化的开销。

更好的解决方案是使用[`Enumerable.Any`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.any.aspx)并[`String.Equals`](http://msdn.microsoft.com/en-us/library/system.string.equals.aspx)执行不区分大小写的比较：

```
if (values.Any(x => String.Equals(rihanna, x, StringComparison.OrdinalIgnoreCase))
{
   // your code here
} 
```

虽然`if`声明现在更长了，但解决方案更加健壮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T21:18:00.467

如果您正在寻找更容易维护可能很长的字符串候选列表，为什么不使用 switch 语句呢？从技术上讲，它会在字符方面“更长”，但如果您必须在以后修改内容，或者提供一些微妙的二次处理，它可以让事情变得更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-03T21:25:45.890

作为上述答案的替代方案，也许您可​​以考虑使用扩展方法：

```
public static bool EqualsAny(this string input, params string[] values)
{
    return values.Any(v => String.Equals(input, v, StringComparison.OrdinalIgnoreCase));
} 
```

使用如下：

```
if (rihanna.EqualsAny("Rihanna", "Sabrina")) 
```

这应该`if`为您提供非常可读/紧凑/简短的比较，尤其是与此处的其他一些替代方案相比。

`EqualsAny`如果您想要`OrdinalIgnoreCase`或不想要或随意添加您想要的任何重载，请调整检查。甚至可以在你传入“Rihanna|Sabrina”的地方实现整个管道/拆分。

编辑：也许更关键的是，它集中*了*您的比较方式，而不是到处复制代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T21:18:45.437

您可以使用自己的正则表达式并将其用作单行..

```
if (Regex.Match(rihanna, "Rihanna|rihanna|Sabrina|sabrina").Success) 
```

或者让它像这样不区分大小写..

```
if (Regex.Match(rihanna, "rihanna|sabrina", RegexOptions.IgnoreCase).Success){ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-03T21:21:10.807

忽略大小写，这看起来像是你想要的东西，并使用`String.Compare`：

```
if(String.Compare(rihanna, "sabrina", StringComparison.OrdinalIgnoreCase) == 0 ||
   String.Compare(rihanna, "rihana", StringComparison.OrdinalIgnoreCase) == 0 ) {
    // do stuff
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-03T21:33:01.940

[Dictionary](http://msdn.microsoft.com/en-us/library/ms132072.aspx)或[HashSet](http://msdn.microsoft.com/en-us/library/bb503873.aspx)（可能对名称进行不区分大小写的检查）是另一种方法，如果您有多个项目并经常重复检查，它将为您提供更好的性能。

```
 var listToCheck = new Dictionary<string, string>( 
     StringComparer.CurrentCultureIgnoreCase) { { "rihanna", null}};

 if (listToCheck.ContainsKey("Rihanna")) .... 
```

# r - r 将值传递给未找到的内部函数

> ID：15798218
> 
> 赞同：2
> 
> 时间：2013-04-03T21:12:01.153
> 
> 标签：r

我还是 R.. 的新手..并且已经阅读过以前的类似帖子...我认为这与 r 传递承诺但不传递值的事实有关，但我不太清楚这里哪里出错了..

这是我想尝试的代码的简单版本：

定义：

```
data<-data.frame(TYPE=as.integer(runif(20,1,3)),COL1=runif(20,1,100),COL2=runif(20,1,10))
RULEA=10
RULEB=20 
```

我运行如下：

```
f<-function(data,metric="A"){
  data<-ddply(data,.(TYPE),transform,SUMCOL1=sum(COL1,na.rm=TRUE),SUMCOL2=sum(COL2,na.rm=TRUE))
  data1<-f1(data=data,metric=metric)
  return(data1)
}

f1<-function(data=data,metric="A"){
  if(metric=="A"){
    RULE<-RULEA
    data$FACTOR<-data$COL1
  }else if(metric=="B"){
    RULE<-RULEB
    data$FACTOR<-data$COL1
  }
  if(nrow(data!=0)){
    x<-subset(data,FACTOR>1)
    if(nrow(x)!=0){
      x<-ddply(x,.(TYPE),mutate,sig=(max(FACTOR)>2*min(FACTOR)) & min(FACTOR) < RULE)
    }
  }

 return(x)
} 
```

如果我运行如下： f(data,metric="A")

它会给我结果：

```
> f(data,metric="A")
Error in eval(expr, envir, enclos) : object 'RULE' not found 
```

我不知道为什么它找不到“规则”......？感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:40:28.097

根据[这个](https://groups.google.com/forum/?fromgroups=#!topic/manipulatr/Jr7S_1GX5Yk)（旧的）讨论，这实际上是一个非常具有挑战性的问题。

正如该讨论所指出的那样，当您到达评估表达式的地步时`mutate`，`ddply`已移交给`ldply`已移交给的`llply`。现在`mutate`必须弄清楚该表达式中的所有内容来自何处。似乎没那么简单。

一种（一种可怕的）解决方法是更改`RULE`​​使用的分配`<<-`。Hadley 在那次讨论中提到编写一个显式函数，这可能是一个更安全的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:58:00.520

也许我在这里遗漏了一些东西，但`RULE`如果它是以下内容的一部分，则会被评估`data.frame` `x`：

```
f1<-function(data=data,metric="A"){
  if(metric=="A"){
    # RULE<-RULEA
    data$RULE<-RULEA
    data$FACTOR<-data$COL1
  }else if(metric=="B"){
    # RULE<-RULEB
    data$RULE<-RULEB
    data$FACTOR<-data$COL1
  }
  if(nrow(data!=0)){
    x<-subset(data,FACTOR>1)
    if(nrow(x)!=0){
      x<-ddply(x,.(TYPE),mutate,sig=(max(FACTOR)>2*min(FACTOR)) & min(FACTOR) < RULE)
    }
  }
  return(x)
}

f(data,metric="A")
#    TYPE      COL1     COL2  SUMCOL1  SUMCOL2 RULE    FACTOR  sig
# 1     1 43.983597 9.457873 496.6858 60.05813   10 43.983597 TRUE
# 2     1 60.438590 4.196161 496.6858 60.05813   10 60.438590 TRUE
# 3     1 20.251421 6.780956 496.6858 60.05813   10 20.251421 TRUE 
```

我是基地的粉丝，所以我可能会重写你的函数`f`，`f1`就像这样：

```
f<-function(data=data,metric='A'){
  b<-by(data,data$TYPE, function(x)
    data.frame(max=max(x$COL1),min=min(x$COL1),SUMCOL1=sum(x$COL1),SUMCOL2=sum(x$COL2)))
  m<-do.call(rbind,b)
  m$TYPE<-rownames(m)
  m$sig<-m$max>(2*m$min) & m$min < switch(metric,A=RULEA,B=RULEB)
  merge(data,m)[,c(names(data),'SUMCOL1','SUMCOL2','sig')]
}

f(data,metric='A') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-03T23:13:03.140

这是一种`data.table`可能有用的方法，因为它避免了这个问题。

请注意，我在每个函数中显式复制 data.tables，以使函数的行为更像常规 R 函数 - 因此我并没有真正利用 data.table 内存效率，而是它的评估方式`j`很好（它会比`ddply`) 快。

一般来说，会有一种更 `data.table`糟糕的方式来做你想做的事，而这个答案并不是真的要那样做。

```
f<-function(DT,metric="A"){
  ## explicit copy to avoid assignment in global `DT`
  dd <- copy(DT)
  ## add sum columns to local copy
  dd[, c('SUMCOL1', 'SUMCOL2') := lapply(.SD, sum ,na.rm = TRUE),by = 'TYPE', .SDcols = c('COL1','COL2')]
  # do f1 on dd
  dd1<-f1(DT = dd,metric=metric)
  # return results
  return(dd1)
}

f1<-function(DT,metric="A"){
  ## explicit copy
  ddd <- copy(DT)
  # assign RULE (a bit simpler)
  RULE <-  switch(metric, 'A' = RULEA, 'B' = RULEB)
  # i FACTOR didn't depend on metric
  ddd[, FACTOR := COL1]
  # subset
  x <- ddd[FACTOR >1, ]

  x[, sig :=(max(FACTOR)>2*min(FACTOR)) & min(FACTOR) < RULE ,by = 'TYPE']
  return(x)
}

f(data.table(data),metric="A") 
```

# html - 使用 CSS 对齐表格中的元素

> ID：15798219
> 
> 赞同：0
> 
> 时间：2013-04-03T21:12:04.127
> 
> 标签：html, css, firefox

这可能听起来很奇怪，但这样做：

```
<table id="MyTableID">
     <tr>
         <td align="center">
                <div id="1">
                   Content
               </div>
        </td>
     </tr>
 </table> 
```

将“内容”与中心对齐，但是：

```
<table id="MyTableID">
     <tr>
         <td style="text-align: center;">
                <div id="1">
                   Content
               </div>
        </td>
     </tr>
 </table> 
```

将其与左侧对齐。

我已经阅读了很多关于使用`margin-left: auto`and的文章`margin-right: auto`，并且还将样式提取到了一个 css 文件中。这似乎对我不起作用。

有谁知道为什么？我究竟做错了什么？我正在使用 Firefox 19。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:21:14.793

我认为这里的误解是在使用传统的 html 对齐方式时，您在父元素中声明了对齐方式。

```
<td align="center">
    <!-- Centered stuff in here -->
</td> 
```

您不应该使用 text-align 来对齐块级元素。此外，在使用块元素时，您通常希望将该样式应用于该特定节点，然后使用边距对齐。

```
<td>
    <div style="width:100px;margin:0 auto"></div>
</td> 
```

话虽这么说，在表格中扔块元素从来都不是一个好主意。表格通常保留用于 HTML 电子邮件和表格数据。大多数现代 Web 产品都是使用 CSS 使用 div/span 构建的。

# c++ - 这是在 C++ 中实现有界缓冲区的正确方法吗

> ID：15798222
> 
> 赞同：5
> 
> 时间：2013-04-03T21:12:19.367
> 
> 标签：c++, multithreading, vector, thread-safety, buffer

我正在开发一个程序，该程序处理多个线程访问、存入和退出有界缓冲区容器。我注意到线程的一些主要问题，并怀疑我的缓冲区在某处部分或根本不正确。

为了确保我知道我在做什么，我希望我的缓冲区代码能够被查看。该类使用了我在其他地方实现的信号量，我假设它现在可以工作（如果不是，我会尽快弄清楚！）我添加了试图解释我的推理的评论。

首先，.h 文件：

```
#ifndef BOUNDED_BUFFER_H
#define BOUNDED_BUFFER_H

#include "Semaphore.H"
#include <string> 
#include <vector>  

using namespace std; 

class Item{ //supposed to eventually be more extensible...seems silly with just a string for now

  public:
    Item(string _content){content = _content;} 
    string GetContent() {return content;}     

  private:  
};   

    class BoundedBuffer{

      public:
        BoundedBuffer(); 

        void Deposit(Item* _item); 
        Item* Retrieve();        
        int GetNumItems() {return count;} 
        vector<Item*> GetBuffer() {return buffer;} 
        void SetSize(int _size){
          capacity = _size;
          buffer.reserve(_size);  //or do I need to call "resize" 
        }  

      private:
        int capacity; 
        vector<Item*> buffer; //I originally wanted to use an array but had trouble with  
                              //initilization/sizing, etc. 
        int nextin; 
            int nextout; 
            int count; 

            Semaphore notfull;   //wait on this one before depositing an item
            Semaphore notempty;  //wait on this one before retrieving an item
        };

    #endif 
```

接下来，.cpp：

```
#include "BoundedBuffer.H"
#include <iostream>

using namespace std; 

BoundedBuffer::BoundedBuffer(){

  notfull.SetValue(0); 
  notempty.SetValue(0); 
  nextin = 0; 
  nextout = 0; 
  count = 0; 
}

void BoundedBuffer::Deposit(Item* _item){
  if(count == capacity){ 
    notfull.P(); //Cannot deposit into full buffer; wait
  }

  buffer[nextin] = _item; 
  nextin = (nextin + 1) % capacity;  //wrap-around
  count += 1;
  notempty.V();  //Signal that retrieval is safe 
}

Item* BoundedBuffer::Retrieve(){
  if(count == 0){
    notempty.P(); //cannot take from empty buffer; wait 
  }

  Item* x = buffer[nextout]; 
  nextout = (nextout + 1) % capacity;
  buffer.pop_back();  //or a different erase methodology? 
  count -= 1; 
  notfull.V(); //Signal that deposit is safe 
  return x; 
} 
```

我认为问题可能源于我选择向量作为底层容器（或者，更确切地说，不正确地使用它），或者可能需要更多的安全阻塞机制（互斥锁等？）东西，有人可以提供一些反馈吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:50:53.983

这是一个非常常见的问题（关于如何做一个适当的*多线程*队列）。我以前见过的最好的答案是[这个堆栈溢出问题](https://stackoverflow.com/questions/15278343/c11-thread-safe-queue)和[这个网站](http://www.justsoftwaresolutions.co.uk/threading/implementing-a-thread-safe-queue-using-condition-variables.html)。这些答案适用于无界队列，因此我将在此处展开​​并显示有界队列的答案。

您需要使用互斥锁来保护您的存款和检索函数，并使用条件变量来进行唤醒。

```
#include <mutex>
#include <condition_variable>

std::mutex the_mutex;
std::condition_variable the_notfull_cvar;
std::condition_variable the_notempty_cvar;

...

void BoundedBuffer::Deposit(Item* _item){
  std::unique_lock<std::mutex> lock(the_mutex);
  while ( /* buffer is full */ ){
    /* simultaneously wait and release the mutex */
    the_notfull_cvar.wait(lock);
    /* the mutex is reaquired at this point */
  }

  /* buffer has space and we own the mutex: insert the item */
  ...
  /* tell anyone waiting on an empty buffer that they can wake up. */
  the_notempty_cvar.notify_all();
}

Item* BoundedBuffer::Retrieve(){
  std::unique_lock<std::mutex> lock(the_mutex);
  while ( /* buffer is empty */ ){
    /* simultaneously wait and release the mutex */
    the_notempty_cvar.wait(lock);
    /* the mutex is reaquired at this point */
  }

  /* buffer has something in it and we own the mutex: get the item */
  ...
  /* tell anyone waiting on a full buffer that they can wake up. */
  the_notfull_cvar.notify_all();

  return x;
} 
```

您的 GetNumItems()、GetBuffer() 和 SetSize() 函数也需要使用 unique_locks 进行保护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:16:03.370

你看过[Boost:Circular_buffer](http://www.boost.org/doc/libs/1_37_0/libs/circular_buffer/doc/circular_buffer.html)吗？这是一个具有标准库接口的固定大小的存储领域。这可能会做你想要的，或者给你一些指示。如果您在循环缓冲区已满时写入内容，则循环缓冲区会覆盖开头。尽管有一个 full() 测试，但您可能不希望这样，因此您可以在代码中避免这种情况。

# android - 在Android中拖动时获取X，Y

> ID：15798225
> 
> 赞同：0
> 
> 时间：2013-04-03T21:12:34.337
> 
> 标签：android, android-layout

如何在拖动时获得精确的 X、Y 坐标？

我使用了 onDragListener 但它在屏幕上给了我 X,Y 这对我不起作用。

# c - 如何计算由c中的许多单词组成的行或字符串的大小？

> ID：15798228
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:12:50.253
> 
> 标签：c, string, string-length

> 我编写了这段代码来区分空格和换行符，以便我可以根据用户输入计算整个文本的长度。我实际上需要计算文本的长度，以便我可以在链表中为该长度分配空间。

```
char s[24];
int l=0,i;
scanf("%s",s);
for(i=0;;){
    if(s[i]==' ') {
     l++;
     i++;
    }
    else if (s[i]=='\0') break;
    else {
    l++;
    i++;
    }
}

printf("%d",l); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:34:02.197

你可以用一段非常喊的代码来完成它，其中包含一些功能：

```
#include <stdio.h>
#include <string.h>

int main(void)
{
    char s[24];
    fgets(s,24,stdin);
    if( s[strlen(s)-1] == '\n'){
        s[strlen(s)-1] = '\0';
    }
    printf("%lu\n",strlen(s));
    return 0;
} 
```

你不应该使用scanf。因为与空间相遇，它停止了。而且使用scanf()是不安全的。fgets() 是一个更好的选择。

经 GCC 和 Linux 测试。

更新：感谢@wildplasser，我的代码中有一个错误。修复 bug 后，没有 string.h 的新代码是：

```
#include <stdio.h>

size_t my_strlen(char * str){
    size_t length = 0;
    while( str[length++] != '\0' ){;}
    return length-1;
}

int main(void)
{
    char s[24];
    size_t len=0;
    if( fgets(s,24,stdin) == NULL ){
        printf("Error in reading string.\n");
        return -1;
    }
    len = my_strlen(s);
    if( len > 0 && s[len-1] == '\n'){
        --len;
    }
    printf("%zd\n",len);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:24:55.090

Per the question in your title, `<string.h>` has a strlen() function that will count the number of characters up to the null terminator in a string. It looks like you may be doing something different in your code, though.

# java - 如何将字符串划分为 char 数组

> ID：15798230
> 
> 赞同：0
> 
> 时间：2013-04-03T21:13:00.643
> 
> 标签：java, c++, c, arrays, char

我正在尝试将字符串划分为 char 数组。我有一个程序可以将 char 数组（7 个字符）从二进制转换为 ASCII 文本。所以我想要做的是将字符串分解为 'Arduino 代码' 或 C、C++ 或 Java 中的 7 个字符的字符数组。有什么建议么？谢谢！

编辑：

这是我正在使用的程序：

```
String getText(String str) {

  String text = "";

  char bits[] = "1001000";
  char new_char = 0;

  for (int i = 7; i >= 0; i--)
  {

    int current_bit = bits[i] - '0';
    new_char |= current_bit << (7-i);

  }

  text += (String) new_char + "";

  return text;

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T21:13:47.013

您可以使用：

```
String s = "java";
char[] ch = s.toCharArray(); 
```

**更新**
好吧，在我的声誉列表中看到一个红色 (-2) 点后，我正在看这篇文章。令我惊讶的是，这个问题与我回答的问题不同。现在，在阅读您的已*编辑问题*后，我将发布*新答案*。您可以使用方法来实现您在**Java**[`Integer.parseInt()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Integer.html#parseInt%28java.lang.String,%20int%29)中寻找的东西。这是如何使用此方法的简短演示：

 **```
class  BinaryToWords
{
    static String returnString(String input)
    {
        String parts[] = input.split("\\s+");
        StringBuilder sBuilder = new StringBuilder();
        for (String part : parts)
        {
            int i = Integer.parseInt(part, 2);//Parses the string argument(part) as a signed integer in the radix(2).
            char ch = (char)i;
            sBuilder.append(String.valueOf(ch));
        }
        return sBuilder.toString();
    }
    public static void main(String[] args) 
    {
        String binary = "1001000 1100101 1101100 1101100 1101111 100000 1010111 1101111 1110010 1101100 1100100";//Input the binary format.
        System.out.println(returnString(binary));
    }
} 
```

上述代码的输出是：

```
Hello World 
```

您也可以检查其他输入。如果它适用于所有可接受的输入，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:15:48.537

What do you mean? A C\C++ string is essentially an array of character.. If you have a pointer to a char (=string) then there's your array. Otherwise if you have an std::string, you can use its .c_str() method.**

# python - Rally Python Api：设置缺陷更新的作者

> ID：15798238
> 
> 赞同：0
> 
> 时间：2013-04-03T21:13:16.580
> 
> 标签：python, rally, pyral

有没有办法用 Pyral 更新缺陷并显示更改的作者是另一个用户，而不是用于登录 Rally 的用户 ID？

这是我尝试过的，但它不起作用：

```
rally = Rally(server, user, password)
rally.enableLogging('rallyConnection.log')
rally.setProject("RallyTestPrj")

defectID = 'DE9221'
notes = "Adding new note from Python"
author = rally.getUserInfo(username='rallyTest@test.com').pop(0) 

defect_data = { "FormattedID" : defectID,
                "Notes"       : notes,
                "Author"      : author.Name
}

try:
defect = rally.update('Defect', defect_data)
except Exception, details:
sys.stderr.write('ERROR: %s \n' % details)
sys.exit(1)
print "Defect updated" 
```

我也尝试过 author.DisplayName、author.EmailAddress，但它仍然会记录使用凭据运行 python 脚本的用户对缺陷的更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:01:52.500

作者属性不是您可以修改的。Rally 将始终将作者记录为用于运行脚本的任何用户。你想这样做的目的是什么？

# entity-framework-5 - Entity Framework 生成的类：相同类型的两个对象在更改后总是相等的

> ID：15798239
> 
> 赞同：0
> 
> 时间：2013-04-03T21:13:17.483
> 
> 标签：entity-framework-5, webforms, ef-database-first

我正在尝试比较两个相同类型的对象，以查看是否进行了更改。让我解释一下这个过程：

在页面加载时填充表单。填写表格后，我将其原始数据保存在会话变量中：

```
newForm = FormRegistry.GetData(userID);
Session["oldForm"] = newForm; 
```

在进行一些更改后保存表单时，我会比较这两个对象，它们总是相同的。存储在 Session["oldForm"] 中的数据与具有更改的 newForm 对象相同。

我正在使用实体框架并首先使用数据库生成对象。这只发生在具有 1-N 关系的对象上。此过程与没有任何关系的对象完美配合。

谁能告诉我发生了什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:54:09.957

几个快速的想法 - 首先我发现使用 == 运算符比较复杂对象效果不太好，应该使用`object1.Equals(object2)`- 然后你需要实现（即覆盖） Equals() 方法，基本上是遍历属性并比较每个。

此外，空值会妨碍您。您需要明确检查这种情况。这个 ref 很有用[MSDN: Guidelines for Overloading Equals()](http://msdn.microsoft.com/en-gb/library/ms173147%28v=vs.80%29.aspx)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:12:32.453

好吧，我想我对正在发生的事情有更多的了解——但可能是错的。我最初虽然您在每次创建新对象的请求之间保存数据并对其进行某种比较。

从听起来您正在处理在同一请求中保存之前和之后比较表单数据的情况。无论哪种方式，这听起来都是因为您实际上是在存储对您的对象的引用，您实际上是在将同一个对象与其自身进行比较。

我认为您需要查看要比较的对象的克隆。如果可以的话，序列化可能是创建对象副本的一种简单方法。

此线程可能会有所帮助：[C# 对象的深层复制](https://stackoverflow.com/questions/11074381/deep-copy-of-a-c-sharp-object)

# java - JToggleButton API 中可能存在的错误？

> ID：15798240
> 
> 赞同：1
> 
> 时间：2013-04-03T21:13:18.083
> 
> 标签：java, swing, border-layout, jtogglebutton

我从[java2s](http://www.java2s.com/Code/JavaAPI/javax.swing/newJToggleButtonStringtext.htm)获得了 JToggleButton 的示例。在代码中，如果文本为“West”，我看到切换按钮无法正确显示文本。西部显示为我们... 其他一切都很好。但是text="west"的时候没有问题，即w小。这是一个错误吗？

![在此处输入图像描述](https://i.stack.imgur.com/kMeZ8.png)

代码：

```
import java.awt.BorderLayout;

import javax.swing.JFrame;
import javax.swing.JToggleButton;

public class MainClass {
 public static void main(String args[]) {
 JFrame f = new JFrame("JToggleButton Sample");
 f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
 f.add(new JToggleButton("North"), BorderLayout.NORTH);
 f.add(new JToggleButton("East"), BorderLayout.EAST);
 f.add(new JToggleButton("West"), BorderLayout.WEST);
 f.add(new JToggleButton("Center"), BorderLayout.CENTER);
 f.add(new JToggleButton("South"), BorderLayout.SOUTH);
 f.setSize(300, 200);
 f.setVisible(true);
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:24:14.303

似乎对我来说工作得很好......

![在此处输入图像描述](https://i.stack.imgur.com/EGynJ.png)![在此处输入图像描述](https://i.stack.imgur.com/QakE9.png)

```
import java.awt.BorderLayout;
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JToggleButton;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestLayout23 {

    public static void main(String[] args) {
        new TestLayout23();
    }

    public TestLayout23() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame f = new JFrame("JToggleButton Sample");
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.add(new JToggleButton("North"), BorderLayout.NORTH);
                f.add(new JToggleButton("East"), BorderLayout.EAST);
                f.add(new JToggleButton("West"), BorderLayout.WEST);
                f.add(new JToggleButton("Center"), BorderLayout.CENTER);
                f.add(new JToggleButton("South"), BorderLayout.SOUTH);
                f.pack();
                f.setLocationRelativeTo(null);
                f.setVisible(true);
            }

        });
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:36:53.507

MetalLookAndFeel - 未正确计算 getPreferredSize

![在此处输入图像描述](https://i.stack.imgur.com/Um1Wg.jpg)

系统观感

![在此处输入图像描述](https://i.stack.imgur.com/brawD.jpg)

雨云

![在此处输入图像描述](https://i.stack.imgur.com/EtQ7O.jpg)

物质

![在此处输入图像描述](https://i.stack.imgur.com/EHylV.jpg)

来自代码（使用 BorderLayout 与 JFrame、JPanel 作为容器相同的问题）

```
import java.awt.BorderLayout;
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JToggleButton;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;

public class MainClass {

    public static void main(String args[]) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(
                            "org.pushingpixels.substance.api.skin.SubstanceOfficeBlue2007LookAndFeel");
                    //UIManager.getDefaults();
                } catch (Exception e) {
                }
            }
        });

       /*try {
            //UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
            for (UIManager.LookAndFeelInfo laf : UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(laf.getName())) {
                    UIManager.setLookAndFeel(laf.getClassName());
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }*/

        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame f = new JFrame("JToggleButton Sample");
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                JPanel panel = new JPanel();
                panel.setLayout(new BorderLayout());
                panel.add(new JToggleButton("North"), BorderLayout.NORTH);
                panel.add(new JToggleButton("East"), BorderLayout.EAST);
                panel.add(new JToggleButton("West"), BorderLayout.WEST);
                panel.add(new JToggleButton("Center"), BorderLayout.CENTER);
                panel.add(new JToggleButton("South"), BorderLayout.SOUTH);
                f.add(panel);
                f.pack();
                //f.setSize(300, 200);
                f.setVisible(true);
            }
        });
    }
} 
```

# javascript - 具有多个上下文的 dojo 函数

> ID：15798242
> 
> 赞同：0
> 
> 时间：2013-04-03T21:13:31.050
> 
> 标签：javascript, event-handling, dojo, dom-events

我`dojo`创建了`dojo/_base/declare`一个包含`onClickHandler`. 此处理程序由 a`dijit/form/Button`用于处理存储在类中的数据。我需要处理程序能够引用`Button`触发事件的事件和处理程序所属的类的实例。

例如，下面是该类中处理函数的第一部分：

```
drawToolClick : function(evt) {

    this.drawingtoolbar.deactivate(); // Here `this` should represent the instance of my class

    var parent = this.getParent(); // Here `this` should represent the button that was clicked 
```

我知道我显然不能`this`用来表示两者，但是当我`dojo/_base/lang`将`hitch`我的类实例用于函数时，我不知道单击了哪个按钮（我有多个按钮使用相同的处理程序，因为它们代表一个`enum`）。如果我省略了`hitch` `this`单击的按钮的引用，但我不知道如何获取处理程序所属的类的实例。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:03:24.897

所以，我终于想通了。我只是在我的模块中添加了一个变量`var self;`，该类在`declare`语句之前定义。然后，在我的类`constructor`函数中我添加了`self = this;`.

然后在我的`onclick`处理程序中，我`this`用来引用被单击的按钮，并`self`用来引用类实例。

这似乎工作正常。

# crystal-reports - Crystal Report 中的条件格式

> ID：15798246
> 
> 赞同：1
> 
> 时间：2013-04-03T21:13:51.337
> 
> 标签：crystal-reports

我是水晶报表 (11) newb - 在报表中，我有一个用于车辆 VIN（车辆识别号）的字段。现在 VIN 打印为 VIN: 1FAHP3438YW374102 。我想应用条件格式，以便数据以粗体打印最后 6 个字符，例如：

车辆识别号：1FAHP3438YW **374102**

可以用公式来完成吗？

京东

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:36:18.650

您可以分两步执行此操作。首先是使用下面的公式。二是进入“格式域”对话框，将“文本解释”改为“HTML文本”。

```
NumberVar x := 5; // you don't need a variable but it doesn't hurt 

// left part of string 
left({Command.VIN_NUMBER},len({Command.VIN_NUMBER}) - x) + 

// begin HTML tag for bold
"<b>" + 

// right part of string
right({Command.VIN_NUMBER},x) + 

// end HTML tag for bold
"</b>" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T12:10:24.697

Another option is to create two formula fields, then embed them in a text object. Once embedded, you have a wide-range of formatting options.

```
//{@left}
{Command.VIN_NUMBER}[1 to 11]

//{@right}
{Command.VIN_NUMBER}[12 to Len({Command.VIN_NUMBER})] 
```

# jquery - 带有切换按钮和文本链接的 jQuery 垂直手风琴菜单

> ID：15798248
> 
> 赞同：1
> 
> 时间：2013-04-03T21:13:56.447
> 
> 标签：jquery, accordion, jquery-ui-accordion

我在侧边栏中设置了一个标准的垂直 jquery 手风琴菜单，它工作正常。当您单击包含子菜单的链接时，它会展开并显示子菜单。

我想要做的是让列表项在单击时展开菜单，但让列表项中的文本链接将您带到一个新页面。我过去看过一些例子，但现在很难找到一个例子。

我已经搜索了一段时间，但在任何地方都没有找到答案。任何帮助，将不胜感激。

HTML

```
<ul id="nav">
<li class="arrow"><a href="#">Level 1 Link</a>
    <ul>
        <li><a href="#">Level 2 Link</a></li>
        <li><a href="#">Level 2 Link</a></li>
        <li class="arrow"><a href="#">Level 2 Link (selected)</a>
            <ul>
                <li><a href="#">Level 3 Link</a></li>
                <li><a href="#">Level 3 Link</a></li>
                <li class="arrow"><a href="#">Level 3 Link (selected)</a>
                    <ul>
                        <li><a href="#">Level 4 Link</a></li>
                        <li><a href="#">Level 4 Link</a></li>
                        <li><a href="#">Level 4 Link</a></li>
                        <li><a href="#">Level 4 Link</a></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</li>
<li><a href="#">Level 1 Link</a></li>
<li><a href="#">Level 1 Link</a></li>
<li class="arrow"><a href="#">Level 1 Link (selected)</a>
    <ul>
        <li><a href="#">Level 2 Link</a></li>
        <li><a href="#">Level 2 Link</a></li>
        <li class="arrow"><a href="#">Level 2 Link (selected)</a>
            <ul>
                <li><a href="#">Level 3 Link</a></li>
                <li><a href="#">Level 3 Link</a></li>
                <li class="arrow"><a href="#">Level 3 Link (selected)</a>
                    <ul>
                        <li><a href="#">Level 4 Link</a></li>
                        <li><a href="#">Level 4 Link</a></li>
                        <li><a href="#">Level 4 Link</a></li>
                        <li><a href="#">Level 4 Link</a></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</li>
<li><a href="#">Level 1 Link</a></li>
<li><a href="#">Level 1 Link</a></li>
<li><a href="#">Level 1 Link</a></li> 
```

jQuery

```
$('#nav > li.arrow').click(function(e){
 if ($(this).attr('class') != 'active'){
   $('#nav li ul').slideUp();
   $(this).next().slideToggle();
   $('#nav li.arrow').removeClass('active');
   $(this).addClass('active');
 }
 e.preventDefault();
 });
 $('#nav > li > ul > li.arrow').click(function(e){
  if ($(this).attr('class') != 'active'){
   $('#nav li ul li ul').slideUp();
   $(this).next().slideToggle();
   $('#nav li ul li.arrow').removeClass('active');
   $(this).addClass('active');
 }
 e.preventDefault();
 });
 $('#nav > li > ul > li > ul > li.arrow').click(function(e){
  if ($(this).attr('class') != 'active'){
   $('#nav li ul li ul li ul').slideUp();
   $(this).next().slideToggle();
   $('#nav li ul li ul li.arrow').removeClass('active');
   $(this).addClass('active');
 }
 e.preventDefault();
 }); 
```

# maven - 如何在我的 Maven 默认配置文件中运行插件，但如果指定了另一个配置文件，则阻止这些插件运行？

> ID：15798253
> 
> 赞同：6
> 
> 时间：2013-04-03T21:14:03.853
> 
> 标签：maven, default, profile

我正在使用 Maven 3.0.3。我对 Maven 配置文件激活中的“activeByDefault”标志感到困惑。我想要的是有一个默认配置文件，但如果有人指定另一个配置文件（例如 -P 其他配置文件），则默认配置文件构建中的任何插件都不会运行。而且，如果有人指定：

```
mvn clean install 
```

默认配置文件中的插件将运行，但其他配置文件中的插件不会运行。但是，默认配置文件中的插件始终在运行，即使我在命令行上指定了不同的配置文件（通过“-P 其他”）。这是我所拥有的

```
<profiles>
    <profile>
        <id>dev</id>
        <activation>
            <activeByDefault>true</activeByDefault>           
        </activation>
        <build>
            <plugins>
                <!-- Prepare liquibase scripts to run against the test db. -->
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-antrun-plugin</artifactId>
                    <version>1.7</version>
                    <dependencies>
                        <dependency>
                            <groupId>org.mainco.subco</groupId>
                            <artifactId>database</artifactId>
                            <version>${project.version}</version>
                        </dependency>
                    </dependencies>
                    <executions>
                        <execution>
                            <id>unzip-liquibase-archive</id>
                            <phase>process-test-resources</phase>
                            <configuration>
                                <target>
                                    <echo message="unzipping liquibase archive" />
                                    <unzip
                                        src="${user.home}/.m2/repository/org/mainco/subco/database/${project.version}/database-${project.version}.jar"
                                        dest="${project.build.directory}" />
                                </target>
                            </configuration>
                            <goals>
                                <goal>run</goal>
                            </goals>
                        </execution>
                        <!-- Replace relative references in liquibase file with absolute ones. -->
                        <execution>
                            <id>format-liquibase-files</id>
                            <phase>process-test-resources</phase>
                            <configuration>
                                <target>
                                    <replace token='include file="'
                                        value="include file=&quot;${project.build.directory}/" file="target/db.changelog-master.xml" />
                                </target>
                            </configuration>
                            <goals>
                                <goal>run</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>

                <!-- Run the liquibase scripts -->
                <plugin>
                    <groupId>org.liquibase</groupId>
                    <artifactId>liquibase-maven-plugin</artifactId>
                    <version>2.0.1</version>
                    <dependencies>
                        <dependency>
                            <groupId>mysql</groupId>
                            <artifactId>mysql-connector-java</artifactId>
                            <version>5.1.18</version>
                        </dependency>
                    </dependencies>
                    <executions>
                        <execution>
                            <id>build-database</id>
                            <phase>process-test-resources</phase>
                            <configuration>
                                <driver>com.mysql.jdbc.Driver</driver>
                                <url>jdbc:mysql://${test.mysql.db.host}:${test.mysql.db.port}/${test.mysql.db.sid}</url>
                                <username>${test.mysql.db.user}</username>
                                <password>${test.mysql.db.password}</password>
                                <changeLogFile>${project.build.directory}/db.changelog-master.xml</changeLogFile>
                                <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                            </configuration>
                            <goals>
                                <goal>update</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>                   
            </plugins>
        </build>
    </profile>
    ... 
</profiles> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T07:30:36.693

如果指定了另一个配置文件，则默认配置文件被禁用，**但只有在同一 POM 中指定了另一个配置文件**。

因此，如果您在 pom 中只有一个配置文件（默认情况下处于活动状态），您将无法停用它，除非您使用 -P!xxx

一种解决方案是，您确保应该停用 dev 的配置文件始终存在于定义该开发配置文件的 POM 上，即使这些配置文件对于某些 POM 是空的。

# java - Java处理弹丸运动

> ID：15798254
> 
> 赞同：0
> 
> 时间：2013-04-03T21:14:07.180
> 
> 标签：java, processing, angle

我正在尝试为我的家庭作业创建一个类似愤怒的小鸟的游戏，但我在角度和弹丸运动方面遇到了麻烦。我给它重力*时间模块，但它似乎没有进行抛射运动，可能是什么问题？

```
float gravity = 9.75;
float time = 0;
float speedx=20;
float speedy=440;

int speed = 0;
int angle = 0;

String veloc = "";

void setup(){
size(800,600);
}

 void keyPressed() {
  if( key >= '0' && key <= '9' ){
    veloc+=char(key);
    if( abs( int( veloc ) ) > 1000 ){
        speed = int(veloc.substring(0,2));  
        angle = int(veloc.substring(2,4));
        println("Speed is " + speed + " m/sec");
        println("Angle is " + angle + " degree");
        time = time + 1;
    }
  } 
}

void draw() {

  background(129,201,255);
  strokeWeight(0);
fill(64,152,3);
rect(0,200,800,600);

fill(188,133,61);
rect(400,375,150,30);
rect(400,500,150,30);
rect(400,275,150,30);

rect(400,400,30,120);
rect(520,400,30,120);
rect(400,275,30,120);
rect(520,275,30,120);

PImage slingshot;
slingshot = loadImage("slingshot.png");
image(slingshot, 30, 450);

PImage pig;
pig = loadImage("pig.png");
image(pig, 460, 253);
image(pig, 410, 253);
image(pig, 510, 253);
image(pig, 435, 353);
image(pig, 485, 353);
image(pig, 435, 478);
image(pig, 485, 478);

text("Please Type a Magnitude (0-99) and an Angle (0-99). E.g. 1045 , Speed = 10, Angle = 45", 120, 30);

  PImage bird;
  bird = loadImage("bird.png");
  image(bird, speedx, speedy);

  speedx = speedx + (speed * cos(angle));
  speedy = speedy + (speed * -sin(angle)) + gravity*time;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:16:49.360

您没有明确说明您要解决的问题是什么，所以我建议您只看一下[https://en.wikipedia.org/wiki/Trajectory_of_a_projectile](https://en.wikipedia.org/wiki/Trajectory_of_a_projectile)，其中列出了关于如何解决的几乎全部知识弹道轨迹工作（包括适用于愤怒的小鸟军械的那些）并且只是实现这些功能。它们非常简单，几乎不言自明。

# javascript - 无法打开触发框

> ID：15798255
> 
> 赞同：1
> 
> 时间：2013-04-03T21:14:07.280
> 
> 标签：javascript, jquery, html

我正在尝试添加一个点击后会打开的小“触发框”。它曾经工作过一段时间，但我不确定现在到底出了什么问题。

我学了一点 HTML 和 CSS，所以我了解这些部分的内容，但我几乎不知道 Javascript。所以脚本选择器中的所有内容对我来说都是新的；其他人在线提供了它，我正在努力理解它。阅读语法，我想我知道发生了什么，但我仍然不知道问题到底是什么。

这是我的代码。是的，它都在 1 个 HTML 文件中，因为这仅适用于 1 页。

```
<!DOCTYPE html>
<html>
<head>
<title> This is the Title </title>
<style type="text/css">
html, body { color:#666; font:"Times New Roman", Times, serif; }
        h1 { font-size:36px; color:#333; margin:0 0 15px 0; padding:0 0 15px 0; border-bottom: solid 1px #e1e1e1; }
        .awesomeBox { border:solid 1px #cacaca; box-shadow: 0 0 3px #bbb; padding:15px; margin:20px; width:400px; }
        .trigger { cursor:pointer; }

        /* this is all you need to make the hidden box hidden :) */
        .hiddenBox { display:none; }

        /* we put a little style to the trigger */
        .box { position:relative; }
        .box .trigger { font-size:12px; background:#cacaca; padding:5px 10px; color:#fff; text-decoration:none; position:absolute; bottom:-42px; right:0; }
        .box .hiddenBox { background:#f9f9f9; color:#000; padding:10px; margin:10px; }
</style>

<script src = "//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>

$(function() { 

            $(".trigger").on("click", function() { 
                $(".hiddenBox").toggle();                                                   
            });             
        });
</script>

</head>

<body>
<div class="awesomeBox">

    <h1 class="trigger">Le awesome Page</h1>

    <div class="box">The area where you could type a lot of text but also want to hide some text<br>

        <p>So, user will press the read more button.</p> <a href="#" class="trigger">Read more &raquo;</a> 

        <div class="hiddenBox"> 

            <p>A lot of text in this hidden box and ...
            a lot 
            alot more
            fsdfsd
            </p>

            <img src="https://www.google.com/images/srpr/logo4w.png" width="100%" /> 
       </div>             
    </div>        
</div>    
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:24:07.633

It works just fine for me, see here: [http://jsfiddle.net/Ex6pK/](http://jsfiddle.net/Ex6pK/)

Try viewing this page in Google Chrome, Right click on any part of the visible page, and Inspect Element, look for Javascript errors there.

I suspect that perhaps

```
 $(function() { 

        $(".trigger").on("click", function() { 
            $(".hiddenBox").toggle();                                                   
        });             
    }); 
```

is being called before Jquery is loaded

# sql-server - 编写查询以选择具有相同列数据的行之一

> ID：15798262
> 
> 赞同：0
> 
> 时间：2013-04-03T21:14:49.127
> 
> 标签：sql-server, tsql

我有一个包含以下数据的表（测试）

```
code  Name   relatedCode

   1    A         0
   2    B         1
   3    C         1
   4    D         0 
```

我想写一个查询来选择：

```
1   A
2   B
4   D 
```

表示第 2,3 行之间具有相同的相关代码只需选择其中一个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:16:22.837

```
SELECT  code, name
FROM    (
        SELECT  *,
                ROW_NUMBER() OVER (PARTITION BY relatedCode ORDER BY code) rn
        FROM    test
        ) q
WHERE   rn = 1 
```

# matlab - Connect discrete points together in a plot using Matlab?

> ID：15798263
> 
> 赞同：0
> 
> 时间：2013-04-03T21:14:50.887
> 
> 标签：matlab, plot, interpolation

If I have the following figure :

![enter image description here](https://i.stack.imgur.com/ROUN6.png)

created by the code :

```
for t=1:length(s)  % s is a struct with over 1000 entries
    plot(t,r1,'k'); % r1 = (0,100,150,170) + 1050
    plot(t,r2,'g'); % r2 = (0,300,350,370) + 1050
    plot(t,r3,'b'); % r3 = (0,200,250,270) + 1050
    plot(t,r4,'m'); % r4 = (0,1000,1250,1500) + 1050
    plot(t,max,'r'); % max = 2000
end 
```

Each dot is actually propagating from 1050 to their current value. But you can't see it this way and hence why I would like for a line to be drawn to connect them all.

How can I connect discrete points of the same line together ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:19:45.913

这是否给出了您想要的结果？

```
for t=1:length(s)  % s is a struct with over 1000 entries
    a(t,:)=r1; % r1 = (0,100,150,170) + 1050  
end
plot(a) 
```

# php - Laravel 3 - RESTful API

> ID：15798264
> 
> 赞同：0
> 
> 时间：2013-04-03T21:14:55.123
> 
> 标签：php, laravel, laravel-3

如何在 Laravel 3 中为 RESTful API 创建路由？

我想使用 GET、PUT、POST 和 DELETE 来创建 API。

我希望所有路线都以`/v1/`

所以，我可以这样做：

`http://api.example.com/v1/controller/method/parameter`并且只需创建相关的控制器来检查 Auth 并执行操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:05:29.093

我建议你使用 laravel 4 而不是 laravel 3。Laravel 4 非常擅长创建 RESTful API，你可以很快上手。这是一个如何：

[http://net.tutsplus.com/tutorials/php/laravel-4-a-start-at-a-restful-api/](http://net.tutsplus.com/tutorials/php/laravel-4-a-start-at-a-restful-api/)

如果您是 API 新手，也可以观看此视频

[https://blog.apigee.com/detail/restful_api_design](https://blog.apigee.com/detail/restful_api_design)

他们建议像这样传递参数：api.test.com/v1/dogs?state=running

我最近开始使用 laravel 4 自己开发一个 RESTful API 服务，到目前为止进展顺利。据说 laravel 4 也将在 5 月发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:17:36.130

对于已经存在的路由，我假设您需要添加一个带有“之前”的过滤器，然后将“url”作为前缀，将其传递回原始路由。

所以在 routes.php 中，类似：

```
Route::get('login', 'user@login', array('before' => 'guest'));
Route::post('login', 'user@login', array('before' => 'guest'));
Route::get('logout', 'user@logout', array('before' => 'auth'));

Route::filter('before', function()
{
    // Do stuff before every request to your application...
        $url = "test";
        $controller = "user@test";
        $filter = array('before' => 'guest');
        return Route::get('/v1/' . $url, $controller, $filter);
}); 
```

但我不确定如何用传入的请求填写 $url、$controller、$filter（也许 Request:: 有一些东西）。

虽然我也是 Laravel 的新手，还没有研究过事件和过滤器。

# c# - 将char数组加载到数据表中

> ID：15798265
> 
> 赞同：0
> 
> 时间：2013-04-03T21:15:01.623
> 
> 标签：c#, arrays, char

我已经寻找了几个小时来将我的 char 数组直接加载到动态表中，然后再加载到数据网格视图中的方法。

尝试了几种方法，但总是有一些事情没有按计划工作。

需要：数组被逐行写入表格，从一个单元格跳到另一个单元格。

```
private void btn_okay(object sender, EventArgs e)
{
    //reading the strings from the two text boxes 
    Char[] ArrayUp = rtb_up.Text.ToCharArray();
    Char[] ArrayDown = rtb_down.Text.ToCharArray();
    Char[] ArrayEnd = new Char [ArrayUp.Length * ArrayDown.Length];

    //comparison of the two char arrays and filling the new char array
    Int32 I = 0;

    for (Int32 C = 0; C < ArrayDown.Length; C++)
    {
       for (Int32 D = 0; D < ArrayUp.Length; D++)
        {
            if (ArrayDown[C] == ArrayUp[D])
            {
                ArrayEnd[I] = '+' ;
                I ++;
            }
            else
            {
                ArrayEnd[I] = '-'  ;
                I ++;
            }
        }
    }

    //creation of data table
    DataTable Table = new DataTable();

    for (Int32 E = 0; E < ArrayUp.Length; E++)
        Table.Columns.Add("", typeof(Char));

    for (Int32 R = 0; R < ArrayDown.Length; R++)
        Table.LoadDataRow(ArrayEnd[R], LoadOption.OverwriteChanges()); 

    //OverwriteChanges won't work
    dgv_main.AutoGenerateColumns = true;
    dgv_main.DataSource = Table;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T06:53:04.557

更新答案：

```
string arrayUp = "ABBAAAABABAAAB"; // Example value for rtb_up.Text
string arrayDown = "ABABAAABAB"; // Example value for rtb_down.Text

DataTable dataTable = new DataTable();

// Add variable number of columns, depending on the length of arrayUp
for (int i = 0; i < arrayUp.Length; i++)
    dataTable.Columns.Add("");

// Iterate through the "rows" first
for (int i = 0; i < arrayDown.Length; i++)
{
    DataRow dataRow = dataTable.NewRow();

    // Then iterate through the "columns"
    for (int j = 0; j < arrayUp.Length; j++)
    {
        if (arrayDown[i] == arrayUp[j])
            dataRow[j] = "+";
        else
            dataRow[j] = "-";
    }

    dataTable.Rows.Add(dataRow);
}

dgv_main.AutoGenerateColumns = true;
dgv_main.DataSource = dataTable; 
```

这将为您提供与您发布的屏幕截图完全相同的图 - 无论 A 或 B 相交，都会有一个加号 (+)。在它们不相交的地方，会有一个减号 (-)。

请务必注意，字符串本质上是 Char[]，因此无需将 TextBox 值转换为 Char[]。

这能得到你所需要的吗？

# algorithm - 当加密算法未知时如何解密编码的消息

> ID：15798267
> 
> 赞同：-4
> 
> 时间：2013-04-03T21:15:11.140
> 
> 标签：algorithm, encryption

考虑到我们有以下信息：

```
BLOCK A : 8374928304
BLOCK B : 7719

Result : 239 
```

结果是从这两个块生成的，但算法是未知的。但是，我有几个`block`&`result`对。如何找出这两个块的结果是如何产生的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:18:48.420

您的成功主要取决于创建密码/散列方案的实体的复杂性。原则上，仅使用几个输入/输出对来正确识别散列方案非常困难，因为可以使用无数种方法从给定输入生成给定输出。

您发现散列方案的唯一机会是散列方案不是很复杂，您可以以某种方式猜测它是什么。如果我认为哈希创建者不是很复杂，这里有一些我想尝试的非常基本的哈希方案：

*   简单[校验和](http://en.wikipedia.org/wiki/Checksum)：计算块 A / 块 B 的校验和。尝试加减法等。
*   取两个值的[模](http://en.wikipedia.org/wiki/Modulo_operation)，然后执行进一步的功能。

但是，正如您将看到的，简单的方法会花费您更多的时间来尝试和验证，而不是您可能已经掌握的方法。例如，我们可以假设散列方案是：

> 取块 A，用块 B 修改它，然后减去 6040

这将适用于上述情况，但我强烈怀疑它不会适用于您的其他值。然后我们可以尝试：

> 取块 A，用块 B+1 取模，然后减去 1865

这也适用于上述值，但很快你就会失去耐心。因此，如果没有关于您的对手可能选择哪种散列方案的理论，这是一个极难解决的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:27:45.773

加密的目的是向不知道算法或不知道如何使用算法解密数据的某些特定信息的攻击者隐藏数据（例如，在公钥/私钥加密中，算法是众所周知的，但私钥显然不是）。如果您不知道该算法但能够对其进行逆向工程，那么该算法就不是很安全。因此，如果您正在处理设计良好的加密算法，那么从统计上讲，您不可能按照您的要求进行操作。

# java - 如何复制数组列表以不反映原始列表中的更改？

> ID：15798268
> 
> 赞同：2
> 
> 时间：2013-04-03T21:15:15.367
> 
> 标签：java, gwt

如何将一个列表复制到另一个列表，并对新列表中包含的对象进行更改，而不影响旧列表中的对象？

```
class Foo {
   String title;
   void setTitle(String title) { this.title = title; }
}

List<Foo> original;
List<Foo> newlist = new ArrayList<Foo>(original);

for (Foo foo : newlist) {
   foo.setTitle("test"); //this will also affect the objects in original list.
                         //how can I avoid this?
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T21:24:58.450

您将必须克隆对象，但是您必须实现一个克隆方法才能使其工作。换句话说，没有一个简单、通用的交钥匙解决方案。

```
List<Foo> original;
List<Foo> newList=new ArrayList<Foo>();

for (Foo foo:original){
    newList.add(foo.clone();
}

//Make changes to newList 
```

在列出的情况下，克隆可能是：

```
class Foo {

    String title;

    void setTitle(String title) { this.title = title; }

    Foo clone(Foo foo){
        Foo result=new Foo();
        result.setTitle(foo.title);
        return result;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T21:23:42.647

您可以尝试如下：

```
public ArrayList<Foo> deepCopy(ArrayList<Foo> obj)throws Exception
{
  ByteArrayOutputStream baos = new ByteArrayOutputStream();
  ObjectOutputStream oos = new ObjectOutputStream(baos);
  baos.writeObject(obj);
  oos.close();
  ByteArrayInputStream bins = new ByteArrayInputStream(baos.toByteArray());
  ObjectInputStream oins = new ObjectInputStream(bins);
  ArrayList<Foo> ret =  (ArrayList<Foo>)oins.readObject();
  oins.close();
  return ret;
} 
```

# php - PHP, Eclipse, Remote Debugging, CentOS, 57%

> ID：15798271
> 
> 赞同：0
> 
> 时间：2013-04-03T21:15:35.577
> 
> 标签：php, eclipse, xdebug

I have a Mac (10.8.3) dev machine connecting to a CentOS (6.3) VM running PHP 5.4.13 under Eclipse June Service Release 2.

I am running into the dreaded "Launching test (57%)..." hang issue. I have looked all over the web/stack overflow and there seem to be a bunch of suggestions (which I tried, none of which seemed to fix my issue).

My /etc/php.ini file looks like this:

```
[xdebug]
zend_extension=/usr/lib64/php/modules/xdebug.so
xdebug.remote_enable=On
xdebug.remote_handler="dbgp"
xdebug.remote_mode="req"
xdebug.remote_port=9000
xdebug.remote_host="10.211.55.3"
xdebug.remote_log=/tmp/xdebug_remote_log
xdebug.remote_connect_back=0 
```

My /etc/php.d/xdebug.ini file looks like this:

```
; Enable Xdebug extension module
extension=xdebug.so

; Configure the extension [See Xdebug documentation for options to add here]
xdebug.remote_enable=On
xdebug.remote_handler="dbgp"
xdebug.remote_mode="req"
xdebug.remote_port=9000
xdebug.remote_host="10.211.55.3"
xdebug.remote_log=/tmp/xdebug_remote_log
xdebug.remote_connect_back=0

$ php -i | grep -i xdebug
/etc/php.d/xdebug.ini,
xdebug
xdebug support => enabled
xdebug.auto_trace => Off => Off
xdebug.cli_color => 0 => 0
xdebug.collect_assignments => Off => Off
xdebug.collect_includes => On => On
xdebug.collect_params => 0 => 0
xdebug.collect_return => Off => Off
xdebug.collect_vars => Off => Off
xdebug.coverage_enable => On => On
xdebug.default_enable => On => On
xdebug.dump.COOKIE => no value => no value
xdebug.dump.ENV => no value => no value
xdebug.dump.FILES => no value => no value
xdebug.dump.GET => no value => no value
xdebug.dump.POST => no value => no value
xdebug.dump.REQUEST => no value => no value
xdebug.dump.SERVER => no value => no value
xdebug.dump.SESSION => no value => no value
xdebug.dump_globals => On => On
xdebug.dump_once => On => On
xdebug.dump_undefined => Off => Off
xdebug.extended_info => On => On
xdebug.file_link_format => no value => no value
xdebug.idekey => no value => no value
xdebug.max_nesting_level => 100 => 100
xdebug.overload_var_dump => On => On
xdebug.profiler_aggregate => Off => Off
xdebug.profiler_append => Off => Off
xdebug.profiler_enable => Off => Off
xdebug.profiler_enable_trigger => Off => Off
xdebug.profiler_output_dir => /tmp => /tmp
xdebug.profiler_output_name => cachegrind.out.%p => cachegrind.out.%p
xdebug.remote_autostart => Off => Off
xdebug.remote_connect_back => Off => Off
xdebug.remote_cookie_expire_time => 3600 => 3600
xdebug.remote_enable => On => On
xdebug.remote_handler => dbgp => dbgp
xdebug.remote_host => 10.211.55.3 => 10.211.55.3
xdebug.remote_log => /tmp/xdebug_remote_log => /tmp/xdebug_remote_log
xdebug.remote_mode => req => req
xdebug.remote_port => 9000 => 9000
xdebug.scream => Off => Off
xdebug.show_exception_trace => Off => Off
xdebug.show_local_vars => Off => Off
xdebug.show_mem_delta => Off => Off
xdebug.trace_enable_trigger => Off => Off
xdebug.trace_format => 0 => 0
xdebug.trace_options => 0 => 0
xdebug.trace_output_dir => /tmp => /tmp
xdebug.trace_output_name => trace.%c => trace.%c
xdebug.var_display_max_children => 128 => 128
xdebug.var_display_max_data => 512 => 512
xdebug.var_display_max_depth => 3 => 3
$ 
```

Any help here would be greatly appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T03:05:39.093

我使用 PHP eclipse 的经验向我展示了以下具有这种行为的场景：

1 - 我尝试调试的网站无法正常工作。我的意思是，如果我们有一个内部错误，例如，apache 将不会运行该站点并且将无法调试它。
2 - 不允许客户端机器获取 xdebug 信息。当我们有一个 DHCP 服务器并且经常更改远程主机 IP 时，这种情况经常发生。

因此，请确保您尝试运行的网站在 Eclipse 调试之外运行。在浏览器中打开它，看看它是否正在运行。此外，请确保 eclipse 机器具有您在 xdebug.remote_host 参数上通知的 IP。

# delphi - 地址访问冲突故障排除。读取地址 00000000

> ID：15798281
> 
> 赞同：-2
> 
> 时间：2013-04-03T21:16:03.563
> 
> 标签：delphi, delphi-7, access-violation

相同版本的 Delphi 7 Code 已部署在我们整个组织的计算机上。

用户 A 每次访问计算机 F1 上的记录 Z 时，都会显示以下错误：

```
Access violation at address 00642E83 in module 'foo.exe'. Read of address 00000000 
```

我在我自己的计算机上与我的用户以及在另一台计算机上与另一个人的用户执行了相同的步骤，并且无法复制它（因此，无法调试......）。

**根据要求提供附加信息**（不确定这会有多大帮助）

*   记录 Z 是 Interbase DB 中的一行，其中保存了已拨入人员的联系和通话历史记录。
*   我们组织中的所有计算机都使用相同的 Windows 7 版本。

所以当...

*   用户 B 访问计算机 F2 上的记录 Z 没有错误。
*   用户 C 访问计算机 F3 上的记录 Z 没有错误。
*   用户 A 访问计算机 F4 上的记录 Z 没有错误。
*   用户 A 访问计算机 F1 上的记录 Z（重新启动后）在提到的相同地址处出现相同的错误。

看来，计算机 F1 是罪魁祸首。但是，此时，我不确定如何进一步排除故障。

有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-03T21:35:27.777

目前，没有足够的信息让我们对此进行调试。但足以给你一些有用的线索：

访问冲突，读取地址 00000000，意味着有人试图取消引用空指针。这通常（但不总是）是尚未构建的对象。

**像 00642E83（进程空间中的某个数字，而不是像 00000000 或 FFFFFFF8 这样的地址）这样的**地址的访问冲突意味着它是数据访问。如果你在这个值的地址空间的一个或另一个极端得到了一个数字，这表明你试图跳转到一个无效的代码地址；如果您尝试在仍然`nil`.

评论中“500 - 内部服务器错误”给出的建议可能无济于事，因为加载事物的地址空间在一个系统之间并不总是一致的，但他走在正确的轨道上。

如果您无法在调试器中重现它，但它始终在某个系统上重现，您需要从该系统获取有用的调试信息。有两种方法可以做到这一点：在他们的系统上附加一个调试器（在大多数情况下不太可行）或**使用错误记录器。**

错误记录器是现代开发中非常有用的工具，我建议将其用于将部署到您无法控制的任何计算机的任何产品。基本上，它会在您的程序中安装一些额外的代码，这些代码会捕获未处理的异常并生成错误报告以发回给您。该报告通常包含各种有用的信息，包括*完整的堆栈跟踪。* 当您拥有其中之一时，访问违规通常很容易追踪和解决。

Delphi 最常见的错误记录工具是[EurekaLog](http://www.eurekalog.com)和[MadExcept](http://madshi.net/madExceptDescription.htm)。我都使用过（EurekaLog 用于专业工作，MadExcept 用于个人开发），我会向任何需要错误记录器的 Delphi 开发人员推荐其中一种。您需要做的是使用这两种工具之一重建您的项目，将其发送给拥有导致行为异常的计算机的客户，并告诉他们重现错误并将其生成的错误报告发回给您。这应该为您提供追踪错误所需的信息。

# macos - CDC Driver on MAC OS X - Device always busy

> ID：15798283
> 
> 赞同：2
> 
> 时间：2013-04-03T21:16:08.813
> 
> 标签：macos, driver, cdc

I am writing an application to control a Modem via USB Virtual COM port on Win7, WinXP, MAC OS X and Linux (command line) and I use as USB to serial converter (aka Virtual COM Port) a Freescale Kinetis K40 MCU. The firmware inside is using the CDC Class 02 declaration.

I can successfully run the Virtual COM port using the CDC Class on Win7 64Bit PC. There are some little communication problems related to buffers but I it's basically working. I connected the TX and the RX to an internal UART of the MCU and all works.

The problem raises when I try to use the Virtual COM port on MAC OS X. The device is recognized as "tty.usbmodemxxx" when I try to send/receive any byte it the ZTerm (used for testing purposes) returns me that the USB Port is busy/not available. I used my own tool and the FileDescriptor returns always -1 so it is not possible to access to it.

Then I tried to access to the device from the terminal using the "cat /dev/tty.usbmodemxxx" and also the "screen /dev/tty.usbmodemxxx" both are returning me Resource Busy.

If I use a FTDI USB to Serial Converter it all works fine ZTerm and my own application.

Again the tty.usbmodem device is recognized but the PORT is always busy/not available while the same code ran in stand alone on my proto board is working on Win7.

I have digged a bit more googling on the net and many user have problems with CDC Drivers on MAC OS X but the majoriry of them are claiming that their device is not connecting while mine is "Resource Busy"!

I tried to use the USB Prober from MACOSX logging at level 7 but there are tons of alerts in a sec so it becomes a bit hard to distinguish mines even if I am filtering.

Descriptors seems corret as 2 Devices are created CDC and CDC data but the device is permanently busy and every 2/3 secs there is a handleOpen from the OS that appearls to me like a polling on my device and I have the same behavior also with FTDI Chip so it cannot be it.

**My suspect is that maybe the firmware inside the MCU is returning a Busy state to the OS but this seems not to be the case because on Win7 with CDC drivers all is working fine.**

Anybody knows eventually how to understand why the device is busy, like is my device returning a false state or maybe the is a deamon took control of my device not releasing it!?**

Any help will be so appreciated!

Regards.

# vb.net - VB.NET - Modifying MS Access Table Name with ADOX

> ID：15798284
> 
> 赞同：0
> 
> 时间：2013-04-03T21:16:16.443
> 
> 标签：vb.net, adodb, adox

I'm trying to modifying a table name based on two textbox inputs. I have one form creating the table using OleDb so I want to use the inputted information from that form to search for the table in the database then rename it to what the use wants on the current form.

Example output From AAAAAAA_000 To BBBBBBB_111

```
Import ADOX
Import ADODB

Private Sub Button1_Click(sender As Object, e As EventArgs) Handles btnModify.Click
    Dim ADOXCatalog As New ADOX.Catalog
    Dim ADOConnection As New ADODB.Connection
    Dim uc As Char = "_"
    ADOConnection.Open("Provider=Microsoft.Jet.OLEDB.4.0;" & _
    "Data Source=C:\Users\...\Documents\Visual Studio 2012\Projects\WindowsApplication3\WindowsApplication3\timer.mdb;" & _
    "Jet OLEDB:Engine Type=5;")

    ADOXCatalog.ActiveConnection = ADOConnection
    ADOXCatalog.Tables('" & frmOpen.TextBox1.Text & uc.ToString & frmOpen.TextBox2.Text & "').Name ='" & txtTextBox1.Text & uc.ToString & TextBox2.Text & "'

    ADOXCatalog.ActiveConnection.Close()
    ADOXCatalog.ActiveConnection = Nothing

    Me.Close()

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:37:52.870

注意：我假设可以通过设置`Name`属性来重命名表。
但是，我没有这样做

```
dim oldTableName as string
dim newTableName as string

oldTableName = frmOpen.TextBox1.Text & uc.ToString & frmOpen.TextBox2.Text
newTableName = txtTextBox1.Text & uc.ToString & TextBox2.Text

ADOXCatalog.Tables(oldTableName).Name = newTableName 
```

几点思考

*   `TextBox1`将,更改`TextBox2`为适当的名称，例如 `TablePrefix`, `TableSuffix`。
*   你不需要`uc.ToString`, when`uc` 是一个字符串（例如`const uc as String = "_"`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T05:16:23.497

我找到了一种修改表名的方法。我必须`ADOX.Table`在代码中添加一条语句，并使用/`for`语句来查找原始表名（基于 frmOpen 窗口中的数据）。`if``then`

```
 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles btnModify.Click
    Dim ADOXCatalog As New ADOX.Catalog
    Dim ADOXTable As ADOX.Table

    Dim ADOConnection As New ADODB.Connection

    Const uc As String = "_"

    Dim oldTableName As String
    Dim newTableName As String

    oldTableName = frmOpen.TextBox1.Text & uc & frmOpen.TextBox2.Text
    newTableName = txtABINum.Text & uc & txtABIRev.Text

    ADOConnection.Open("Provider=Microsoft.Jet.OLEDB.4.0;" & _
    "Data Source=C:\Users\028861\Documents\Visual Studio 2012\Projects\WindowsApplication3\WindowsApplication3\timer.mdb;" & _
    "Jet OLEDB:Engine Type=5;")
    Try
        ADOXCatalog.ActiveConnection = ADOConnection
        For Each ADOXTable In ADOXCatalog.Tables
            If ADOXTable.Name = oldTableName Then
                ADOXTable.Name = newTableName
            End If
        Next ADOXTable
        ADOXCatalog.ActiveConnection.Close()
        ADOXCatalog.ActiveConnection = Nothing
        Me.Close()
    Catch ex As Exception

        MsgBox(ex.Message, MsgBoxStyle.Critical, "ADOX Error")

    End Try
End Sub 
```

# android - 仅适用于 Android 4.0 API 的参数

> ID：15798286
> 
> 赞同：0
> 
> 时间：2013-04-03T21:16:20.383
> 
> 标签：android, api

为 android 4+ 制作商业级应用程序有什么好的论据？我需要说服我的上级，这是从开发人员和经理的角度提出的强项。Android 2+ 的下降速度有多快，我将如何证明这一点？该公司有点像“支持所有设备！” （就像我们在 PC 端的“支持所有数据库供应商”和“支持 windows xp”）我不喜欢那个，因为我是开发人员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:43:03.193

如果您计划首次发布，那么专注于单一平台而不是考虑整个世界是个好主意。您可以将此视为 beta 或测试版本，以收集反馈并努力实现完整版本。我相信，如果您关注两个问题，那将是明智之举

1.  一个平台
2.  一种本地化（英文）

他们将始终与您的应用程序的输入本地化有关。显示本地化很容易处理，因为您只需要提供不同语言的字符串文件。如果您希望生成某种特定语言的报告，则输出本地化会更加复杂。

**内存** 您总是需要一个较低的限制，较旧的 Android 设备带有较小的堆内存，并且您要确保您的内存要求与设备上的可用堆内存相匹配。Android 应用程序的增长不能超过分配的堆内存的大小。

**市场评论** 在安卓市场上，一篇差评会让你损失数百名新用户。而且，如果您的目标群很大，您将更有可能获得更多评论和崩溃。如果你把你的应用卖给十个人，每个人都说它是一个很棒的应用，很有意义，而不是把它卖给一百人，然后得到 50 人的差评。我从不去 Yelp 上差评超过 10% 的餐厅.

**稳定性** 由于各种类型的硬件、软件，您会遇到很多问题。您甚至会看到一些代码在某些设备上运行良好，但在一两个单独的设备上却不行。有一次，我从亚洲市场购买的三星手机出现问题，我用相同的手机美国版本测试了我的应用程序，没有任何问题。我发现的唯一区别是不同的 Android 版本。无论如何，您的关注点越窄，您将能够创建更稳定的应用程序。它通常需要多次迭代才能使应用程序稳定。

**测试** 您很可能会尝试在尽可能多的设备上测试您的应用程序，如果您的设备基数很大，您必须花费更多时间在各种设备上进行测试。这最终会花费你大量的时间和金钱。当您收到崩溃报告时，测试和调试会更容易。

**但是**，是的，您不能简单地忽略这样一个事实，即他们有很多设备使用低于 4.0 的 Android 版本。从管理层的规定中也可以理解为什么他们想要更广泛的知名度。而且，一切都是有代价的，如果你不能很好地处理场景，你将失去一切，然后管理层会责怪你没有在正确的时间告诉它。

对于第一个版本，只要您考虑不同的挑战并逐渐尝试扩大您的市场，就可以将注意力集中在较小的地方。此外，在设计您的应用程序时，请考虑当您的公司计划扩展时，您将如何对其进行反向移植。您可以简单地从不使用旧版本中不可用的东西开始。喜欢从支持 API 中选择片段，或者编写内存优化代码，以便您的应用程序在较低堆内存设备上运行等。

最后，我相信每件事都取决于您的要求。如果你的应用是产品（文字处理、游戏），那么让它尽可能好是很重要的。如果它只是对您的原始产品的附加服务（推特、脸书等），那么它可以在不考虑大的情况下发布大的东西。但是，如果您的应用程序是您唯一拥有的东西，那么谨慎和小心是可以的。

# html - 以 HTML 格式存储 HTML 模板

> ID：15798288
> 
> 赞同：0
> 
> 时间：2013-04-03T21:16:23.743
> 
> 标签：html, mustache, html-templates

我需要存储 HTML 模板以将它们用于 Mustache 渲染。

```
<!-- Templates. -->
<span style="display:none">

<span id="tplCard">
    {{#.}}
    <div class="card">
        <div class="caption">
            <p>{{caption}}</p>
            <button title="Edit" class="toolbar edit"></button>
        </div>
    </div>
    {{/.}}
</span>

<span id="tplRow">
    {{#.}}
    <tr>
        <td>{{id}}</td>
        <td>{{caption}}</td>
        <td>{{text}}</td>
        <td>{{image}}</td>
        <td>
            <button>Edit</button>
        </td>
    </tr>
    {{/.}}
</span>

</span>
<!-- End of templates. --> 
```

这里是使用：

```
function FillWithData(container, template, data)
{
    var tpl = $('#' + template).html();
    var html = Mustache.render(tpl, data);
    $('#' + container).append(html);
} 
```

第一个模板有效，但第二个模板无效。好吧，问题是 a`<TR>`不是 a 的有效孩子`<SPAN>`，所以浏览器会删除它们。如何存储随机模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:06:56.663

您可以将模板数据存储在`script`标签中。这将阻止浏览器将其解析为 html。但是您需要记住，您的模板`script`本身不能包含标签（[在 <script type="text/template"> 标签中包含 <script> 标签](https://stackoverflow.com/questions/14261232/including-script-tag-in-script-type-text-template-tag)）。（这适用，`<!doctype html>`但老实说，我不能确定它是否可以跨浏览器用于其他文档类型）

您不需要在设置中进行太多更改：

**HTML**

```
<script type="text/x-template" id="tplCard">
    {{#.}}
    <div class="card">
        <div class="caption">
            <p>{{caption}}</p>
            <button title="Edit" class="toolbar edit"></button>
        </div>
    </div>
    {{/.}}
</script>

<script type="text/x-template" id="tplRow">
    {{#.}}
    <tr>
        <td>{{id}}</td>
        <td>{{caption}}</td>
        <td>{{text}}</td>
        <td>{{image}}</td>
        <td>
            <button>Edit</button>
        </td>
    </tr>
    {{/.}}
</script> 
```

`type="text/x-template"` 用于使浏览器不会尝试将其作为脚本执行。

**JS**

```
function FillWithData(container, template, data)
{
    var tpl = $('#' + template).text()||$('#' + template).html();
    var html = Mustache.render(tpl, data);
    $('#' + container).append(html);
} 
```

这`$('#' + template).text()||$('#' + template).html()`是必需的，因为在某些浏览器版本中您需要使用`.text()`，而在其他浏览器版本中您需要使用`.html()`来获取`script`标签的内容。

# php - 遇到 PHP hash('sha256', 'x') 与 bash 命令不匹配的问题

> ID：15798290
> 
> 赞同：1
> 
> 时间：2013-04-03T21:16:36.827
> 
> 标签：php, hash

如何使用 PHP 的 hash() 函数执行以下操作？我已经尝试过但失败了（请参阅低得多的 php 代码）

```
echo -n '807542FB6685F9FD8F37D56FAF62F0BB4563684A51539E4B26F0840DB361E0027C' | xxd -r -p | sha256sum -b 
```

上面的 bash 行给出了以下输出：

```
7DE4708EB23AB611371BB778FC0C8BDE80394AB2D8704D7129FB5771E2F1730D 
```

这个 php 代码并没有做到这一点：

```
<?php
echo hash('sha256', '807542FB6685F9FD8F37D56FAF62F0BB4563684A51539E4B26F0840DB361E0027C'); 
```

输出：

```
e50f2ac6f7b6a2cbf640f44806affe06a330eb655f9e97bf70d5e09274340e4b 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:26:24.533

您的代码的问题是您缺少`xxd -r`. 您可以使用以下方法获得此信息`pack("H*", $string)`：

```
echo hash('sha256', pack("H*", '807542FB6685F9FD8F37D56FAF62F0BB4563684A51539E4B26F0840DB361E0027C')); 
```

或者，如果您有 PHP 5.4 或更高版本，您可以使用`hex2bin()`：

```
echo hash('sha256', hex2bin('807542FB6685F9FD8F37D56FAF62F0BB4563684A51539E4B26F0840DB361E0027C')); 
```

这两个的输出是：

> 7de4708eb23ab611371bb778fc0c8bde80394ab2d8704d7129fb5771e2f1730d

# c - 使用 libtinfo 依赖项编译的带有 ncurses 的 C 代码

> ID：15798291
> 
> 赞同：4
> 
> 时间：2013-04-03T21:16:40.427
> 
> 标签：c, linux, ncurses

我最近在 linux 上使用 ncurses 用 C 语言编写了一个扫雷器实现；在我的电脑上一切正常，但如果我尝试将编译后的二进制文件提供给其他人，他们经常会收到错误消息：

`error while loading shared libraries: libtinfo.so.5: cannot open shared object file: No such file or directory`

如果我让他们重新编译代码，一切都很好。通过环顾四周，我发现这是 libtinfo 和 libncurses 之间分离的问题。它可以通过制作几个 simlink 来解决，但它只有在用户具有 root 权限时才可行。

截至这里（和其他来源），[http://www.cyberspice.org.uk/blog/2009/12/24/tinfo-about-dash/](http://www.cyberspice.org.uk/blog/2009/12/24/tinfo-about-dash/)，似乎这是一个可以通过编写代码来解决的问题以不同的方式或可能以不同的方式编译。我宁愿能够以这种方式解决问题，也不愿强迫人们制作 simlink。

任何指向正确方向的指示以了解如何解决我的问题？*如果需要，我可以添加任何代码或细节，但发布所有内容*似乎有点过头了，所以请告诉我可以添加什么（如果需要）以更好地理解问题。

我现在唯一发布的是makefile：

```
CC=gcc -std=gnu89 -pedantic -Wall -Wno-unused-but-set-variable
CFLAGS=-c -g
LDFLAGS=-lncurses

NAME=campo_ex
OBJECTS=error.o interface.o utilities.o main.o grid.o

DEBUG_NAME=debug
DEBUG_OBJECTS=error.o interface.o utilities.o debug.o

$(NAME): $(OBJECTS)
    $(CC) -o $(NAME) $(OBJECTS) $(LDFLAGS)

main.o: main.c interface.h grid.h
    $(CC) $(CFLAGS) main.c

debug.o: debug.c interface.h
    $(CC) $(CFLAGS) debug.c

error.o: error.c error.h
    $(CC) $(CFLAGS) error.c

utilities.o: utilities.c utilities.h
    $(CC) $(CFLAGS) utilities.c

interface.o: interface.c interface.h error.h utilities.h
    $(CC) $(CFLAGS) interface.c

grid.o: grid.c grid.h error.h
    $(CC) $(CFLAGS) grid.c

.PHONY: clean
clean:
    @-rm -f $(OBJECTS) $(NAME) $(DEBUG_NAME) $(DEBUG_OBJECTS)

.PHONY: debug
debug: $(DEBUG_OBJECTS)
    $(CC) -o $(DEBUG_NAME) $(DEBUG_OBJECTS) $(LDFLAGS) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T22:31:12.597

在您编译的程序上执行`readelf -d`可能会显示与 libtinfo.so.5 的连接

```
$ readelf -d /path/to/your/program  | grep NEEDED
[...]
0x0000000000000001 (NEEDED)             Shared library: [libtinfo.so.5]
[...] 
```

这可能会被拉入，因为您`libncurses.so`以某种方式将其拉入，例如通过包含以下内容：

```
INPUT(... -ltinfo) 
```

（或类似的东西。我可以在这里猜测..）

您可以尝试添加并希望您的程序不直接引用任何符号，`-Wl,--as-needed`以便链接器不需要为您的程序添加依赖项。`LDFLAGS``libtinfo``libtinfo`

```
LDFLAGS=-Wl,--as-needed -lncurses 
```

用 new 重新编译`LDFLAGS`并再次检查`readelf -d`它是否编译和链接没有错误。

如果使用来自但不包含对自身的依赖关系的符号，则使用`--as-needed`可能会出现问题。如果发生这种情况，您的构建将失败并抱怨或类似..`libncurses``libtinfo``libtinfo``unreferenced symbols`

因此，如果这不起作用，您可能需要修复您的 curses 安装或使用您已经提到的（在我看来非常肮脏的）符号链接黑客。或者让用户在他们的系统上编译代码 - 如果您不想共享代码，您也可以在目标系统上进行链接。

要修复 symlink-need-root-privileges 问题，您还可以将 a 添加`-Wl,-rpath,'$ORIGIN/../lib'`到链接器标志并扩展程序的库搜索路径。这使用户能够将您的二进制文件安装`/home/user/bin/program`到`/home/user/bin/../lib`. 所以他们可以在`/home/user/lib`.

仅分发二进制文件时总是有问题的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-07T03:13:34.227

我遇到过同样的问题。经过大量搜索后，我意识到问题的原因是该`libtinfo`功能现在嵌入在`libncurses`库中。

您可以通过执行以下两个简单步骤来解决它：

1.  转到您的 libncurses 共享库所在的目录（通常在您的工具链中）
2.  创建以下链接

并再次编译：

```
sudo ln -s libncurses.so.6 libtinfo.so.6  
sudo ln -s libncurses.so.6 libtinfo.so 
```

这个想法来自[以下 Launchpad 网站](https://bugs.launchpad.net/ubuntu/+source/ncurses/+bug/259139)。

# c++ - OpenGL ES glPushAttrib() 3D模型渲染

> ID：15798294
> 
> 赞同：1
> 
> 时间：2013-04-03T21:16:46.180
> 
> 标签：c++, opengl-es-2.0, 3d-model

我知道我不能在 openGL ES 中执行 glPush/PopAttrib 并且我必须手动执行此操作。我的问题是：为了正确渲染 3D 模型，我需要启用/禁用和 psuh/pop 什么？

我遇到的问题是颜色在要渲染的不同对象之间混合。此外，某些对象没有纹理，看起来它正在尝试对其应用纹理。

是否有一种“安全”可能未优化的方法来确保每次渲染新对象时，openGL 状态都是“干净”的？有点像 glPushAttrib(GL_ALL_ATTRIB_BITS)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T07:55:45.823

不，没有。但是在 OpenGL ES 2.0 中可能的状态（~10）要少得多，其他一切都由*您自己的*着色器控制，无论如何。基本上，您只需启用/禁用所有可能的状态即可确定（并正确配置您启用的状态）。

可以在此处找到所有状态的列表：

[http://www.khronos.org/opengles/sdk/docs/man/xhtml/glEnable.xml](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glEnable.xml)

# c# - .NET SVCUTIL does not generate namespaces properly

> ID：15798296
> 
> 赞同：6
> 
> 时间：2013-04-03T21:17:02.797
> 
> 标签：c#, .net, svcutil.exe

I have a WSDL document with 2 namespaces, and I am trying to generate proxy classes using SVCUTIL.EXE. For some reason, in the generated code the types get placed into default namespace, not in the correct name for mapping provided.

Here is my WSDL:

```
<?xml version='1.0' encoding='UTF-8'?>
<wsdl:definitions name="TestService" 
    targetNamespace="My.Namespace.1" 
    xmlns:ns1="http://schemas.xmlsoap.org/soap/http" 
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
    xmlns:tns="My.Namespace.1" 
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <wsdl:types>
        <xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="My.Namespace.1" xmlns:ns1="My.Namespace.2" xmlns:tns="My.Namespace.1" xmlns:xs="http://www.w3.org/2001/XMLSchema">
            <xs:import namespace="My.Namespace.2"/>

            <xs:element name="TestOpRequest" type="tns:TestOpRequest"/>
            <xs:element name="TestOpResponse" type="tns:TestOpResponse"/>

            <xs:complexType name="TestOpRequest">
                <xs:sequence>
                    <xs:element ref="ns1:Type1"/>
                </xs:sequence>
            </xs:complexType>

            <xs:complexType name="TestOpResponse">
                <xs:sequence>
                </xs:sequence>
            </xs:complexType>

        </xs:schema>
        <xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="My.Namespace.2" xmlns:tns="My.Namespace.2" xmlns:xs="http://www.w3.org/2001/XMLSchema">
            <xs:element name="Type1" type="tns:Type1"/>

            <xs:complexType name="Type1">
                <xs:sequence>
                    <xs:element name="prop1" type="xs:string"/>
                    <xs:element name="prop2" type="xs:string"/>
                </xs:sequence>
            </xs:complexType>

        </xs:schema>
    </wsdl:types>

    <wsdl:message name="testOp">
        <wsdl:part element="tns:TestOpRequest" name="parameter"/>
    </wsdl:message>

    <wsdl:message name="testOpResponse">
        <wsdl:part element="tns:TestOpResponse" name="parameter"/>
    </wsdl:message>

    <wsdl:portType name="TestService">
        <wsdl:operation name="testOp">
            <wsdl:input message="tns:testOp" name="testOp"/>
            <wsdl:output message="tns:testOpResponse" name="testOpResponse"/>
        </wsdl:operation>
    </wsdl:portType>

    <wsdl:binding name="TestServiceSoapBinding" type="tns:TestService">
        <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
        <wsdl:operation name="testOp">
            <soap:operation soapAction="" style="document"/>
            <wsdl:input name="testOp">
                <soap:body use="literal"/>
            </wsdl:input>
            <wsdl:output name="testOpResponse">
                <soap:body use="literal"/>
            </wsdl:output>
        </wsdl:operation>
    </wsdl:binding>
    <wsdl:service name="TestService">
        <wsdl:port binding="tns:TestServiceSoapBinding" name="TestServicePort">
            <soap:address location="http://localhost/TestService"/>
        </wsdl:port>
    </wsdl:service>
</wsdl:definitions> 
```

Here is how I generate proxies:

SvcUtil.exe /t:code test.wsdl /n:My.Namespace.1,Test.Namespace1 /n:My.Namespace.2,Test.Namespace2 /o:Test.cs

Here is what gets generated:

```
/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("svcutil", "4.0.30319.1")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="My.Namespace.1")]
public partial class TestOpRequest
{

    private Type1 type1Field;

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute(Namespace="My.Namespace.2", Order=0)]
    public Type1 Type1
    {
        get
        {
            return this.type1Field;
        }
        set
        {
            this.type1Field = value;
        }
    }
}

/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("svcutil", "4.0.30319.1")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="My.Namespace.2")]
public partial class Type1
{

    private string prop1Field;

    private string prop2Field;

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute(Order=0)]
    public string prop1
    {
        get
        {
            return this.prop1Field;
        }
        set
        {
            this.prop1Field = value;
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute(Order=1)]
    public string prop2
    {
        get
        {
            return this.prop2Field;
        }
        set
        {
            this.prop2Field = value;
        }
    }
}

/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("svcutil", "4.0.30319.1")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="My.Namespace.1")]
public partial class TestOpResponse
{
}
namespace Test.Namespace1
{

    [System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
    [System.ServiceModel.ServiceContractAttribute(Namespace="My.Namespace.1", ConfigurationName="Test.Namespace1.TestService")]
    public interface TestService
    {

        // CODEGEN: Generating message contract since the operation testOp is neither RPC nor document wrapped.
        [System.ServiceModel.OperationContractAttribute(Action="", ReplyAction="*")]
        [System.ServiceModel.XmlSerializerFormatAttribute()]
        Test.Namespace1.testOpResponse testOp(Test.Namespace1.testOp request);
    }

    [System.Diagnostics.DebuggerStepThroughAttribute()]
    [System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
    [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
    [System.ServiceModel.MessageContractAttribute(IsWrapped=false)]
    public partial class testOp
    {

        [System.ServiceModel.MessageBodyMemberAttribute(Namespace="My.Namespace.1", Order=0)]
        public TestOpRequest TestOpRequest;

        public testOp()
        {
        }

        public testOp(TestOpRequest TestOpRequest)
        {
            this.TestOpRequest = TestOpRequest;
        }
    }

    [System.Diagnostics.DebuggerStepThroughAttribute()]
    [System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
    [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
    [System.ServiceModel.MessageContractAttribute(IsWrapped=false)]
    public partial class testOpResponse
    {

        [System.ServiceModel.MessageBodyMemberAttribute(Name="TestOpResponse", Namespace="My.Namespace.1", Order=0)]
        public TestOpResponse TestOpResponse1;

        public testOpResponse()
        {
        }

        public testOpResponse(TestOpResponse TestOpResponse1)
        {
            this.TestOpResponse1 = TestOpResponse1;
        }
    }

    [System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
    public interface TestServiceChannel : Test.Namespace1.TestService, System.ServiceModel.IClientChannel
    {
    }

    [System.Diagnostics.DebuggerStepThroughAttribute()]
    [System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
    public partial class TestServiceClient : System.ServiceModel.ClientBase<Test.Namespace1.TestService>, Test.Namespace1.TestService
    {

        public TestServiceClient()
        {
        }

        public TestServiceClient(string endpointConfigurationName) : 
                base(endpointConfigurationName)
        {
        }

        public TestServiceClient(string endpointConfigurationName, string remoteAddress) : 
                base(endpointConfigurationName, remoteAddress)
        {
        }

        public TestServiceClient(string endpointConfigurationName, System.ServiceModel.EndpointAddress remoteAddress) : 
                base(endpointConfigurationName, remoteAddress)
        {
        }

        public TestServiceClient(System.ServiceModel.Channels.Binding binding, System.ServiceModel.EndpointAddress remoteAddress) : 
                base(binding, remoteAddress)
        {
        }

        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        Test.Namespace1.testOpResponse Test.Namespace1.TestService.testOp(Test.Namespace1.testOp request)
        {
            return base.Channel.testOp(request);
        }

        public TestOpResponse testOp(TestOpRequest TestOpRequest)
        {
            Test.Namespace1.testOp inValue = new Test.Namespace1.testOp();
            inValue.TestOpRequest = TestOpRequest;
            Test.Namespace1.testOpResponse retVal = ((Test.Namespace1.TestService)(this)).testOp(inValue);
            return retVal.TestOpResponse1;
        }
    }
} 
```

Here is what I need to generate:

```
namespace Test.Namespace2
{
    public partial class Type1
    {
        ....
    }
}

namespace Test.Namespace1
{
    public partial class TestOpRequest
    {
        private Test.Namespace2 type1Field;
        ...
    }

    public partial class TestOpResponse
    {
    }

    public interface TestService
    {
        Test.Namespace1.testOpResponse testOp(Test.Namespace1.testOp request);
    }

    public partial class testOp
    {
        ...
    }

    public partial class testOpResponse
    {
        ...
    }

} 
```

Any suggestions will be appreciated.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-29T19:15:35.777

您可以指定要生成的命名空间：

```
svcutil /n:*,Test.Namespace1 (... other args for svcutil not shown) 
```

这会将所有命名空间映射到相同的`Test.Namespace1`.

当然，您可以映射单个命名空间，例如，如果您的服务定义如下：

```
[ServiceContract(Namespace = "http://test.com/wsdl/MyFirstService")]
public interface IMyFirstService
{
}

[ServiceContract(Namespace = "http://test.com/wsdl/MySecondService")]
public interface IMySecondService
{
} 
```

您可以使用以下方法单独映射它们：

```
svcutil /n:http://test.com/wsdl/MyFirstService,Test.Namespace1 
        /n:http://test.com/wsdl/MySecondService,Test.Namespace2
(etc...) 
```

有关更多信息，请查看[此](https://stackoverflow.com/q/1103686/79444)内容，但如果您遇到问题，请查看[此内容](https://stackoverflow.com/q/4580082/79444)

# html - 指定背景颜色 css 时下沉的边框 - 如何避免？

> ID：15798300
> 
> 赞同：1
> 
> 时间：2013-04-03T21:17:32.103
> 
> 标签：html, css, windows

如果我在文本输入的样式中指定背景颜色，例如通过 css 中的错误类，如下所示：

```
.error {
 background-color: #f88;
} 
```

和 HTML：

```
<p>
    Normal Input: <input type="text" />
</p>
<p>    
    Test Input: <input type="text" class="error" />
</p> 
```

当应用类时，我最终会得到一个下沉的边框效果，而当它没有应用时，我会得到一个平坦的效果，请参见此处的示例：

[http://jsfiddle.net/D4SEZ/5/](http://jsfiddle.net/D4SEZ/5/)

我只在 Windows 中测试过，所以它可能是 Windows 特定的问题。任何人都可以建议一种方法来避免这种情况，同时保留控件的“默认”外观吗？我想要的只是没有凹陷外观的背景颜色。

我真的不想明确地设置边框等样式。

编辑：为了明确这个问题，我不希望对我看到的第二个输入产生下沉效果，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/Sy5rb.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:34:06.397

检查[`border-style`财产](https://developer.mozilla.org/en-US/docs/CSS/border-style)。输入元素通常具有默认的边框样式，`inset`这就是您所看到的。

如果您的意图是有一个坚实的风格边框，你应该能够做到：

```
.error{border-style: solid;} 
```

[jsFiddle](http://jsfiddle.net/D4SEZ/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:39:40.387

首先，这也是 mac/chrome 上的问题。默认输入边框似乎有某种特殊的边框。由于它在默认版本上具有白色背景，因此几乎看不到它，但是它就在那里。Chrome 检查器显示了这一点：

```
-webkit-appearance: textfield;
padding: 1px;
background-color: white;
border: 2px inset; 
```

为了获得真正的、跨浏览器的、一致的外观，我认为您将不得不覆盖这些浏览器默认属性，无论是否喜欢。但是不应该太难：

```
input[type="text"] {
  border: 1x solid #ccc;
  outline: none;
  box-shadow: none;
  padding: 2px;
} 
```

或者按照这个顺序。也许您也应该将其应用于`input password`和`textarea`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:50:16.933

为了准确地解决这个特定问题并避免覆盖您可能为其他输入定义的任何其他边框宽度或颜色，您可以只为接受文本的输入（`text`, `password`, `email`, `search`,`tel`和)`url``textarea`

```
input[type="text"], input[type="password"], input[type="email"], input[type="search"], input[type="tel"], input[type="url"], textarea {
    border-style: solid;
} 
```

# php - Adding a div Read More wordpress

> ID：15798301
> 
> 赞同：0
> 
> 时间：2013-04-03T21:17:34.950
> 
> 标签：php, css, wordpress

Ok so I am trying to add a div read more button but it's not working, and I'm not sure how to go about this.

here is the code I am trying to use.

```
<?php the_content('<a href="<?php the_permalink() ?>" title="<?php printf( __('Permalink to %s', 'wpbx'), the_title_attribute('echo=0') ) ?>" rel="bookmark"><div class="readmore"></div></a>') ?> 
```

here is the css

```
.readmore{
  width:136px;
  height:34px;
  background: url('http://ericavain.com/wp-content/uploads/2013/04/READ1.png') no-repeat;
}
.readmore:hover{
  width:136px;
  height:34px;
  background: url('http://ericavain.com/wp-content/uploads/2013/04/read2.png') no-repeat;
} 
```

How do i get this accomplished

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:48:57.613

也许您正在尝试在 Pages 上使用“阅读更多”？如果是这种情况，请尝试在您的页面中添加类似这样的内容：

```
<?php  // let's enable more link on pages...
        global $more;
        $more = 0;
        ?>
            <?php the_content(); ?> 
```

# vb.net - 读取文本文件并使用调用存储过程插入数据

> ID：15798303
> 
> 赞同：0
> 
> 时间：2013-04-03T21:17:38.777
> 
> 标签：vb.net, sql-server-2005

我需要读取逗号分隔的数据文件：

```
a,123,C:/test.txt,0001 
```

我需要将它们读入数组，然后使用调用方法来调用存储过程。然后，这将从文本文件中获取数据，然后放入表中的列中。

到目前为止我有这个：

```
Dim path As String
path = "C:\Users\dave\Desktop\WF.txt"

Dim sr As StreamReader = New StreamReader(path)

Dim line As String
line = ""

' Split(
Do
  Try
    line = sr.ReadLine()
    Console.WriteLine(line)
  Catch ex As Exception
    Console.WriteLine("the file could not be read:")
    Console.WriteLine(ex.Message)
  End Try
Loop Until line Is Nothing

sr.Close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T14:02:36.383

我会尝试这样的事情：

```
Dim path As String = "C:\Users\dave\Desktop\WF.txt"
Dim line As String = String.Empty

' define connection string and stored procedure name 
Dim connectionString As String = "server=.;database=test;integrated Security=SSPI;"
Dim storedProcedureName As String = "dbo.YourInsertStoredProcedure"

' put all disposable items in using() blocks - this applies to 
' StreamReader, SqlConnection, SqlCommand (and many more!)
Using sr As New StreamReader(path)
    Using conn As New SqlConnection(connectionString)
        Using cmd As New SqlCommand(storedProcedureName, conn)
            ' define as stored procedure
            cmd.CommandType = CommandType.StoredProcedure

            ' define parameters
            cmd.Parameters.Add("@Param1", SqlDbType.VarChar, 10)
            cmd.Parameters.Add("@Param2", SqlDbType.Int)
            cmd.Parameters.Add("@Param3", SqlDbType.VarChar, 260)
            cmd.Parameters.Add("@Param4", SqlDbType.VarChar, 25)

            Do
                Try
                    line = sr.ReadLine()

                    If Not String.IsNullOrEmpty(line) Then
                        ' split line into the four parts
                        Dim parts As String() = line.Split(",")

                        ' set the parameter values
                        cmd.Parameters("@Param1").Value = parts(0)
                        cmd.Parameters("@Param2").Value = Convert.ToInt32(parts(1))
                        cmd.Parameters("@Param3").Value = parts(2)
                        cmd.Parameters("@Param4").Value = parts(3)

                        ' execute procedure
                        cmd.ExecuteNonQuery()
                    End If
                Catch ex As Exception
                    Console.WriteLine("the file could not be read:")
                    Console.WriteLine(ex.Message)
                End Try
            Loop While Not String.IsNullOrEmpty(line)
        End Using
    End Using
End Using 
```

# html - Why isn't the letter-spacing property being applied?

> ID：15798305
> 
> 赞同：0
> 
> 时间：2013-04-03T18:16:54.623
> 
> 标签：html, css

```
<span style="font-size:20px;" "font-color: rgb (52, 52, 52,);" "letter-spacing:-50px;">
Syst&eacute;my pre k&uacute;renie
<span style="color: rgb(0, 162, 228);">│&lt;/span>
Vodoin&scaron;tal&aacute;cia a kanaliz&aacute;cia
<span style="color: rgb(0, 162, 228);">│&lt;/span>
Plynoin&scaron;tal&aacute;cia
<span style="color: rgb(0, 162, 228);">│&lt;/span>
Mont&aacute;ž centr&aacute;lnych vys&aacute;vačov
</span> 
```

The "letter-spacing:-50px;" DOESN'T work... WHY???

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T18:20:05.113

[http://www.w3.org/TR/1998/REC-CSS2-19980512/text.html#spacing-props](http://www.w3.org/TR/1998/REC-CSS2-19980512/text.html#spacing-props)

> This value indicates inter-character space in addition to the default space between characters. Values may be negative, but there may be implementation-specific limits. User agents may not further increase or decrease the inter-character space in order to justify text.

The value of -50px is huge and I believe that you are running into a limitation of the implementation.

# javascript - jquery获取选择选项值然后添加参数

> ID：15798310
> 
> 赞同：0
> 
> 时间：2013-04-03T21:18:00.800
> 
> 标签：javascript, jquery

我正在尝试添加值“&fullpage = true”

```
<select name="navMenu" onchange="go(this.options[this.selectedIndex].value)">
<option value="-">Select</option>
<option value="page.html&amp;nyo=0" class="ccbnLnk">All</option>
<option value="page.html&amp;nyo=0" class="ccbnLnk">IR</option>
<option value="page.html&amp;nyo=0" class="ccbnLnk">Product</option>
</select> 
```

我猜它会是这样的？

```
$('select option').attr(val + "&fullpage=true"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:20:48.087

您已经很接近了，但是您需要遍历所有选项元素，然后进行如下更改：

```
$('select option').each(function () {
    $(this).val($(this).val() + "&fullpage=true");
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/bnJG8/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:20:38.137

您可以使用 each 函数遍历每个元素

```
$('select option').each(function(){
  $(this).attr('value', $(this).attr('value') + "&fullpage=true");
}); 
```

# ruby-on-rails-3 - 使用助手将百分比添加到值？

> ID：15798321
> 
> 赞同：1
> 
> 时间：2013-04-03T21:18:44.360
> 
> 标签：ruby-on-rails-3, sum, helper, percentage

我的 Rails 应用程序的 Invoice 模型中有以下现有助手：

```
def total_price
  line_items.to_a.sum(&:full_price)
end 
```

我想做的是有一个额外的助手`total_vat`，它为 total_price 助手增加了 20%。这可能吗？

我最终将添加第三个助手来计算差额，这样我就可以只打印应付的增值税金额。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:21:31.797

创建多个助手是绝对可能的。

```
def vat
  total_price * 0.2
end

def total_price_including_vat
  total_price + vat
end 
```

# asp.net - Orchard - 从主页网站编辑“小部件”

> ID：15798327
> 
> 赞同：1
> 
> 时间：2013-04-03T21:18:54.780
> 
> 标签：asp.net, asp.net-mvc, orchardcms

浏览 Orchard 的介绍教程：

```
http://pluralsight.com/training/courses/TableOfContents?courseName=orchard-fundamentals&highlight=kevin-kuebler_introduction-to-orchard*1,2!kevin-kuebler_shape-of-orchard!kevin-kuebler_modules-and-content*1,8,4!kevin-kuebler_themes-and-widgets*9!kevin-kuebler_blogs-and-users#introduction-to-orchard 
```

在视频中，他可以从实际主页编辑小部件和页面，例如用虚线围绕小部件，在每个小部件的右上角显示“编辑”。如果他从这里点击它会将他导航到网站的管理/小部件部分，我知道如何到达....

我的问题是如何启用从网站主页编辑小部件的选项，而无需在管理站点上导航到它？

谢谢

从下图中可以看到编辑按钮 ![在此处输入图像描述](https://i.stack.imgur.com/d4W9h.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T02:22:00.903

此功能默认禁用 - 您可以在 Dashboard 中将其打开。它被称为`Widget Control Wrapper`。您还需要启用`Content Control Wrapper`功能。

# ember.js - How do I debug a mysterious pause in an Ember.js Application

> ID：15798332
> 
> 赞同：0
> 
> 时间：2013-04-03T21:19:10.140
> 
> 标签：ember.js, handlebars.js

I have an ember.js application. It shows a list of "Problems". Once loaded, the first action taken to select (click) an individual item from this list has a 1-2 second delay. No delay is ever present on subsequent clicks.

The delay is not from the server, if I remove all content from the view/template, the delay is still present.

The delay is not in rendering. If I instrument the rendering process (as described in this answer: [https://stackoverflow.com/a/15129150/1167846](https://stackoverflow.com/a/15129150/1167846)) nothing happens with rendering at all during that time, and the list displayed at the end shows nothing that indicates a multi-second pause.

If I use `console.log` all over the place, the click event appears to make all the necessary changes in my code (selecting the item as "current") without any delay.

How do I figure out where this delay is coming from?

# django - Dynamically Set Bootstrap class variable in Django

> ID：15798336
> 
> 赞同：1
> 
> 时间：2013-04-03T21:19:22.143
> 
> 标签：django, twitter-bootstrap

I'm trying to dynamically set the bootstrap `"class="` variable in Django to a value from the model.

The template looks like this (when "statically" set):

```
<strong><span class="label label-success"> It Worked! </span></strong> 
```

I would like to dynamically set the `"class ="` and I have tried follow the following but seem to have issues passing `{{challenge.labelbx}}` into the span tag :

```
<strong><span class={{challenge.labelbx}}> It Worked! </span></strong> 
```

From the Challenge Model:

```
def labelbx(self): #These are bootstrap label colors
    if self.consistency_percentage() > 79:
        return "label label-success" # green
    elif self.consistency_percentage() > 69:
        return "label label-info" #blue
    elif self.consistency_percentage() > 59:
        return 'label label-warning' #orange
    elif self.consistency_percentage() > 49:
        return "label"
    else:
        return "label" 
```

From the View:

```
def public_scorecard_page(request):

    c = Challenge.objects.get(user__exact = request.user,chal_status=1)

    return render(request, 'public_scorecard.html', {'challenge': c}) 
```

# c - C中的浮点舍入

> ID：15798338
> 
> 赞同：2
> 
> 时间：2013-04-03T21:19:25.297
> 
> 标签：c, floating-accuracy

我遇到了一些奇怪的浮点数舍入行为。下面的代码演示了这个问题。解决这个问题的最佳方法是什么？我一直在寻找解决方案，但运气不佳。

```
#include<stdio.h>

int main(void)
{   
    float t;
    t = 5592411;
    printf("%f\n", 1.5*t);
    t *= 1.5;
    printf("%f\n", t);
    return 0;
} 
```

上面的代码应该打印出相同的值，但我在使用 GCC 4.7.2 的设置中得到了这个：

> 8388616.500000
> 
> 8388616.000000

如果我使用计算器，我会得到第一个值，所以我假设第二个值以某种方式四舍五入。我有相同的 Fortran 代码，它不四舍五入（有 0.5）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T21:25:16.353

`1.5`是一个`double`常数而不是 a`float`并且 C 具有自动提升规则。因此，当您执行`1.5*t`时，将 (i)`t`转换为`double`; (ii)`double`乘以`double` `1.5`；和 (iii)`double`被打印（就像`%f`a 的格式化程序一样`double`）。

相反，`t *= 1.5`提升`t`为双精度，执行双倍乘法，然后截断结果以将其存储回 [单精度] `float`。

作为证据，请尝试：

```
float t;
t = 5592411;
printf("%f\n", 1.5f*t); // multiply a float by a float, for no promotion
t *= 1.5;
printf("%f\n", t);
return 0; 
```

或者：

```
double t; // store our intermediate results in a double
t = 5592411;
printf("%f\n", 1.5f*t);
t *= 1.5;
printf("%f\n", t);
return 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:24:42.123

第一次计算以双精度完成，第二次计算相同，但在分配给 时截断为单精度`float`。

如果你使用`double`你的变量，你会得到相同的结果。`float`每当需要考虑准确性时，最好使用这种类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T21:25:22.013

在第一种情况下，结果是一个可以精确表示所需值的双精度值。

在第二种情况下，结果是一个不能精确表示所需值的浮点数。

尝试使用双精度相同的方法，您最终会得到相同的结果。

```
#include<stdio.h>

int main(void)
{   
    double t;
    t = 5592411;
    printf("%f\n", 1.5*t);
    t *= 1.5;
    printf("%f\n", t);
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T21:26:09.533

用 C 代码编写 1.5 被解释为 double，它比 float 类型具有更高的精度。

第一种情况，

```
printf("%f\n", 1.5*t); 
```

导致*t*被隐式转换为双精度（精度更高），然后相乘。该`printf`函数将输入对应于`%f`反正转换，打印结果，这也是一个`double`.

第二种情况是将*1.5*转换为`float`类型，精度较低，不能存储为小细节。

如果您想避免这种影响，请`1.5f`改用 on `1.5`to use `floats`，或将类型更改为`t`to `double`。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-03T21:32:08.863

这是否可行取决于浮点数和双精度数的机器表示。在典型的 32 位架构上传递浮点数会将 4 个字节压入参数堆栈。传递一个双精度数将推动 8 个字节。传递一个 double 但使用 %f 要求将其视为一个浮点数，它将查看在我们的典型情况下推送的前 4 个字节。根据机器表示，这可能接近预期结果，或者可能在左侧字段中出路。

# entity-framework - MVC4 和实体框架继承和包含

> ID：15798339
> 
> 赞同：0
> 
> 时间：2013-04-03T21:19:26.783
> 
> 标签：entity-framework, inheritance, include

我有一些简单的对象

```
public class DataClass
{
    public int id;
    public string Data;
}

public class Job()
{
   public int id;
}

public class NewJob : Job
{
   public  DateTime StartDate;
   public  DataClass data;
} 
```

然后我在我的 dBContext() 中定义了它们

```
 public DbSet<Job> Jobs { get; set; }        
    public DbSet<DataClass> DataClass { get; set; } 
```

现在，如果我使用以下代码

```
NewJob job = (NewJob) db.Jobs.Find(id); 
```

这工作正常，但返回“数据”为空

我知道我用 virtual 关键字定义了这个类，它可以工作并填充“数据”对象。

```
public class NewJob : Job
{
    public DateTime StartDate;
    public virtual DataClass data;
} 
```

但在我的情况下，我“通常”不希望填充“数据”对象。所以我需要按需加载它。

如果我尝试类似

```
NewJob job = (NewJob)db.Jobs.Include("data").First(); 
```

我得到一个例外

**指定的包含路径无效。EntityType 'Models.Job' 没有声明名为 'data' 的导航属性。**

我想这是因为它在尝试包含时正在查看“工作”而不是“NewJob”。

我也不喜欢带有字符串的包含 - 没有设计时检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:30:37.933

看起来您正试图通过类型转换将数据对象转换为域对象，这是一个非常糟糕的主意。您想要做的是获取您的数据对象，实例化您的域对象，并使用某种类型的帮助器类将您的数据值映射到域对象。我一直在使用的一个非常有用的工具是 Automapper。它是一种工具，可让您将一个对象映射到另一个对象。如果两个对象之间的命名约定不同，它还允许使用正则表达式来帮助映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:44:07.807

如果您使用 Entity Framework Code First 并希望创建派生类/实体的实例，您应该执行以下操作：

```
using (var db = new MyDbContext())
{
    var newJob = db.Jobs.Create<NewJob>();
    newJob.data.Data = "some data for a new job"; // this is string Data from DataClass

    db.Jobs.Add(newJob);
    db.SaveChanges();
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-03T22:51:37.700

经过大量搜索，我发现以下内容可以提供帮助。

如果在 using 子句中包含 System.Data.Entity 命名空间，则可以在OfType **<>(** )之后使用扩展方法**.Include()**，这通常不可用。

 **略有不同的代码示例

```
 using System.Data.Entity; 

 NewJob job = (NewJob)db.Jobs.OfType<NewJob>().Include(m => m.data).Where(x => x.id == id).FirstOrDefault(); 
```

在我使用的示例中，这似乎对我有用。**

# scala - 如何为 sbt 中的每个测试分叉 jvm

> ID：15798341
> 
> 赞同：12
> 
> 时间：2013-04-03T21:19:29.970
> 
> 标签：scala, sbt

我正在使用一些类（出于某种原因）只能在单个 VM 中使用一次。如果我在我的设置中`fork := true`启用单独运行它们（），我的测试用例就可以工作。`sbt`

如果我运行多个这些测试，它们会失败并出现异常，线程执行器拒绝任务（它很可能已关闭）。找出导致问题的原因将非常耗时，即使我找到了问题，我也可能无法解决它（我无权访问源代码）。

我目前正在使用`specs2`测试框架，但任何使用的测试框架`sbt`都是可以接受的。

**是否有任何测试框架`sbt`能够在`jvm`fork 中运行每个测试？**

当然，欢迎对可能的其他解决方案提出想法或想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-03T21:38:58.823

事实证明，这很容易实现。文档就足够了，可以在[测试 - 分叉测试中找到](http://www.scala-sbt.org/release/docs/Detailed-Topics/Testing#forking-tests)

```
// Define a method to group tests, in my case a single test per group
def singleTests(tests: Seq[TestDefinition]) =
  tests map { test =>
    new Group(
      name = test.name,
      tests = Seq(test),
      runPolicy = SubProcess(javaOptions = Seq.empty[String]))
  }

// Add the following to the `Project` settings
testGrouping in Test <<= definedTests in Test map singleTests 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-02T05:41:40.907

使用不推荐使用的语法：

```
testGrouping in Test := (definedTests in Test).value map { test =>
  Tests.Group(name = test.name, tests = Seq(test), runPolicy = Tests.SubProcess(
    ForkOptions(
      javaHome.value,
      outputStrategy.value,
      Nil,
      Some(baseDirectory.value),
      javaOptions.value,
      connectInput.value,
      envVars.value
    )))
} 
```

# javascript - 如何在 Firefox 中检测 Enter 键？

> ID：15798344
> 
> 赞同：5
> 
> 时间：2013-04-03T21:19:45.097
> 
> 标签：javascript, firefox

我正在尝试检测**Enter Key**。这是我的代码。

HTML

```
<input name="txtTest"  type="text" id="txtTest" onkeyup="CheckKey()"/> 
```

Javascript

```
function CheckKey()
{
    var e = window.event;
    var code = e.keyCode ? e.keyCode : e.which;
    if(code === 13)
    {
      alert("You press Enter key.");
    }            
} 
```

此代码在其他浏览器中有效，但在 Firefox 中无效，为什么？这是[jsFiddle](http://jsfiddle.net/e3PSe/2/)

**请仅使用 javascript 提供答案。**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-03T21:21:57.547

我相信您必须将`event`对象传递给处理程序：

```
<input name="txtTest"  type="text" id="txtTest" onkeyup="CheckKey(event)"/>
<!--                                            passes event object ^   --> 
```

```
function CheckKey(e) //receives event object as parameter
{
   var code = e.keyCode ? e.keyCode : e.which;
   if(code === 13)
   {
       alert("You press Enter key.");
   }
} 
```

[**小提琴**](http://jsfiddle.net/wkpeq/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:27:00.343

**您应该将 JavaScript 代码与 HTML 分开。**

尝试这样的事情 - 密钥应该适用于所有浏览器：

```
<input type="text" id="txtTest" onkeyup="CheckKey(e)"/>

function CheckKey(e) {
   var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;
   if(key === 13)
   {
       alert("You press Enter key.");
   }
} 
```

或者按照 jQuery 的建议（从 HTML 中分离 JavaScript 代码） - 使用[event.which](http://api.jquery.com/category/events/)：

```
 <!--HTML file e.g. index.html-->
   <input type="text" id="txtTest" />

    //JavaScript file e.g. script.js - you have to include that script in your HTML file
    $(function(){
      $('#txtTest').on('keyup', function(e){
          if(e.which === 13)
          {
            alert("You press Enter key.");
          }
      });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-05T21:33:25.947

使用`event.key`代替`event.keyCode`！

```
function CheckKey(event) {
    if (event.key === "Enter") {
        // Do something
    }
}; 
```

[Mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key)

[支持的浏览器](http://caniuse.com/#feat=keyboardevent-key)

# java - Java 中包含的 JAX-WS 实现？

> ID：15798351
> 
> 赞同：16
> 
> 时间：2013-04-03T21:20:14.413
> 
> 标签：java, web-services, tomcat, jax-ws, java-metro-framework

我有一个 JAX-WS Web 服务应用程序，它部署为 Tomcat 7 的 WAR 文件。它使用了最新版本的 Metro 库，我将其包含在 WAR 文件中，并且运行良好。

我正在尝试简化部署包。我知道 Sun JDK 包含 Metro 的副本（例如，请参阅[这个问题](https://stackoverflow.com/questions/3206681/how-to-deploy-a-jax-ws-service-to-eclipse-or-tomcat?rq=1)和[这个](https://stackoverflow.com/questions/12670261/metro-vs-javas-jax-ws)），但由于某种原因，显然必须用从 glassfish 站点下载的一个替换这个 Metro 副本。我试图了解是否可以仅使用 Tomcat 和 JDK 附带的 Metro 实现，或者如果不能，为什么不可以。

WAR内容如下（类文件去掉）：

```
META-INF/MANIFEST.MF
WEB-INF/classes/
WEB-INF/classes/com/[et cetera]
WEB-INF/ibm-web-ext.xml
WEB-INF/lib/
WEB-INF/lib/stax-api.jar
WEB-INF/lib/webservices-api.jar
WEB-INF/lib/webservices-extra-api.jar
WEB-INF/lib/webservices-extra.jar
WEB-INF/lib/webservices-rt.jar
WEB-INF/lib/webservices-tools.jar
WEB-INF/sun-jaxws.xml
WEB-INF/web.xml
wsdl/
wsdl/MyService.wsdl 
```

`web.xml`部分包含：

```
<servlet>
    <servlet-name>MyService</servlet-name>
    <servlet-class>
        com.sun.xml.ws.transport.http.servlet.WSServlet
    </servlet-class>              
</servlet> 
```

当我从 WAR 中删除 webservices-* jars——Metro jars——时，web 服务失败并出现错误“ Wrapper cannot find servlet class com.sun.xml.ws.transport.http.servlet.WSServlet or a class这取决于”。这并不奇怪，因为我在 Java 7 SE 附带的 jar 中的任何地方都找不到该类。

那么，如果您必须下载另一个 Metro 副本才能使类似的东西工作，那么说 Java 7 附带 Metro 意味着什么？是否可以仅使用 Java 附带的 jar 在 Tomcat 中运行 JAX-WS Web 服务？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-27T15:49:22.473

> 那么，说 Java 7 附带 Metro.. 是什么意思？

这并不完全正确。JDK6+ 包括 JAX-WS RI（参考实现），Metro 是它的超集。换句话说，Metro = JAX-WS RI + WSIT。

> 是否可以仅使用 Java 附带的 jar 在 Tomcat 中运行 JAX-WS Web 服务？

这是一个很好的问题。答案是 - 不，因为`WSServlet`类扩展`HttpServlet`，`WSServletContextListener`实现`ServletContextAttributeListener`和`ServletContextListener`接口。这些接口和类都是 Java EE 的一部分，而不是 Java SE - 因此不包含在 JDK/JRE 中。Sun/Oracle 决定不混合使用 Java SE 和 Java EE，尽管这意味着这些类实际上已从 JDK/JRE 附带的 JAX-WS RI 版本中删除，但这是可以理解的。因此，您必须安装 JAX-WS 依赖项才能在 Tomcat 上使用基于 JAX-WS 的 Web 服务，因为 Tomcat 不附带它（另一方面，如果您选择 Glassfish 为例，您会发现完整的 Metro分发与它捆绑在一起，您不必额外安装任何东西）。[否则，您将被Endpoint#publish](http://docs.oracle.com/javaee/6/api/javax/xml/ws/Endpoint.html#publish%28java.lang.String%29)卡住机制。

也可以看看：

*   [JRE 6 中的 WSServletContextListener 和 WSServlet](https://www.java.net//node/702595)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-03T22:57:03.840

捆绑的 JAX-WS 缺乏与 servlet 容器的集成，因为它*仅*用于在独立的 Java 应用程序中提供 JAX-WS 服务（WTF！？！？！？）。

当然，可以考虑实现一个 servlet 来进行这种集成，这样您就不必在 WAR 中包含另一个 Metro 副本。但是只包含一个外部的“完整”副本更容易，它会使 WAR 膨胀，但不应该有很大的性能损失。此外，通过这种方式，您可以控制使用哪个版本，避免卡在 JRE 中包含的版本上。

无论如何，Sun 通常会更改捆绑库中的包名称，因此它们不会与外部库冲突，因此，如果 servlet 存在（它不存在），它可能会被调用：

com.sun.xml。**内部的。**ws.transport.http.servlet.WSServlet

这很烦人，因为他们还以相同的方式更改了一些配置属性（例如：与超时相关的属性），因此如果您使用捆绑的 JAX-WS，则必须使用

com.sun.xml。**内部的。**...样式配置属性，

但是如果你使用一些外部 JAX-WS 你必须使用

com.sun.xml....样式配置属性。

谢谢孙！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-31T07:52:54.123

这是一个老问题，但如果有人仍在寻找答案。从 JDK 1.7 开始，不需要包含 jaxws jar（我使用的是 1.7.0_45）。使用此[http://www.mkyong.com/webservices/jax-ws/deploy-jax-ws-web-services-on-tomcat/](http://www.mkyong.com/webservices/jax-ws/deploy-jax-ws-web-services-on-tomcat/)链接构建示例 web 服务并跳过第 5 步，一切正常。我的目标是 Tomcat 版本 7.0.47，整个项目是使用 Maven 构建的，具有 jaxws-rt jar 的默认范围（即编译）。

# internet-explorer-8 - IE8 中的符号集问题

> ID：15798352
> 
> 赞同：1
> 
> 时间：2013-04-03T21:20:14.443
> 
> 标签：internet-explorer-8, webfonts, icon-fonts

几个月来我一直在使用 Symbolset 字体（标准字体和社交字体）并且喜欢它们。不过，最近我注意到 IE8 中的一些问题。我正在做的一些网站根本没有在 IE8 中加载。它在底部的社交栏中有这个：[http](http://cl.ly/image/3y1o2R2X2L1t) : //cl.ly/image/3y1o2R2X2L1t，这让我觉得它与符号集文件有关。我无法为我的生活弄清楚问题是什么。有什么想法可能导致问题或我可能遗漏的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T02:47:50.097

您尝试提供给 IE 8 的字体格式可能不受支持。

例如，TTF/OTF 在 IE 9 和 10 中受部分支持，但在 IE 8 中不受支持。

[http://caniuse.com/ttf](http://caniuse.com/ttf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-17T11:40:30.680

我会检查此页面上的兼容性表。[http://blog.symbolset.com/browser-support](http://blog.symbolset.com/browser-support)

对于 IE8，我使用 unicode 选项来获得所需的结果。

例子

```
<i class="ss-icon ss-social">&#xF611;</i> 
```

# c++ - posix_memalign() 需要多少额外的内存？

> ID：15798354
> 
> 赞同：3
> 
> 时间：2013-04-03T21:20:17.410
> 
> 标签：c++, memory-management, posix

我正在尝试决定是否应该使用 memalign() 而不是 malloc()，因为对齐的内存会使我的工作更轻松。我在这里阅读了 GNU 文档（[http://www.gnu.org/software/libc/manual/html_node/Aligned-Memory-Blocks.html](http://www.gnu.org/software/libc/manual/html_node/Aligned-Memory-Blocks.html)），其中提到`The function memalign works by allocating a somewhat larger block.`我想知道那个“更大的块”的确切值.

逻辑上认为所需的额外内存应该等于所需的对齐值。但我不确定是否对此进行了优化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:25:10.243

Posix 是一个*标准*，而不是一组特定的代码，但我们可以以 libc 为例。

这是`posix_memalign()`该实现中最初分配的内容。

```
mem = malloc (size + 2 * alignment); 
```

有了这个漂亮的 ASCII 插图。

```
 /*
      ______________________ TOTAL _________________________
     /                                                      \
    +---------------+-------------------------+--------------+
    |               |                         |              |
    +---------------+-------------------------+--------------+
    \____ INIT ____/ \______ RETURNED _______/ \____ END ___/

   */ 
```

然后它将分配两端的未使用存储**返回到堆中。**

这意味着碎片可能会变得更糟，尽管使用的堆内存**数量相同**。

# excel - excel，获取行的平均值

> ID：15798355
> 
> 赞同：0
> 
> 时间：2013-04-03T21:20:22.803
> 
> 标签：excel, excel-formula, average

我有一个`2000X10`矩阵，我想得到每行列的平均值，并在第 11 列放置所有平均值，因此有一个`1X2000`包含平均值的矩阵

我怎样才能最有效地做到这一点？不只是这样做

`=AVERAGE(A1,B1,C1,D1,E1,F1,G1,H1,I1,J1)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:28:52.700

这更短，更容易阅读：

```
=AVERAGE(A1:J1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:18:14.847

对于最小键控：选择您的 11 列，插入 > 表格 - 表格，确定，选择第 11 列的顶部空白单元格，主页 > 编辑 - 自动求和，在单元格内容窗口中附加“/10”，然后`Enter`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:35:28.270

只需按照以下步骤操作：

1.  在第 k 列第 1 行中，您可以使用`=AVERAGE(A1:J1)`第 1 到第 10 列的平均值
2.  然后通过单击该单元格并按键盘上的 ctrl+c 复制该值。
3.  接下来，左键单击位于平均值下方的单元格 K2。
4.  向下滚动到工作表的按钮，然后
5.  按住 SHIFT 并左键单击列 k 中的最后一行（第 2000 行）。
6.  使用 ctrl+V 粘贴进行填写。Excel 将自动更新方程以取行的平均值。

![结果](https://i.stack.imgur.com/68UeZ.png)

# wolfram-mathematica - Maxima 中的数值解

> ID：15798358
> 
> 赞同：1
> 
> 时间：2013-04-03T21:20:30.020
> 
> 标签：wolfram-mathematica, maxima

我有一个最大值方程，我想找到这个方程中变量的数值解。我想知道是否有人知道 maxima 中的哪个函数与数学中的 FindRoot 最相似？

似乎有几种方法可以做到这一点，但我希望根据数学代码检查结果，因此我对类似于 FindRoot 的东西感兴趣。

本

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-07T11:05:31.957

Mathematica 的 FindRoot 搜索数值解。Maxima (AFAIK) 中最接近的东西是 find-root，它在给定的区间内找到数值解。

例子：

```
(%i4) find_root(x^2=7,x,0,100);
(%o4)                          2.645751311064591 
```

# php - 导致 500 错误的简单代码点火器控制器和模型 - 未显示 CI 错误

> ID：15798359
> 
> 赞同：0
> 
> 时间：2013-04-03T21:20:34.057
> 
> 标签：php, codeigniter

我刚刚开始学习 Code Igniter，几乎马上就遇到了问题。

使用下面的代码和具有正确权限的数据库设置，我收到 500 错误（服务器错误）。CI 没有抛出错误，我看不出这段代码有什么问题。

我正在使用最新版本的 CI 并测试此代码：

控制器：products.php

```
class Products extends CI_Controller {

public function index() {
    $this->load->model('products');
    $this->load->view('products');
}
} 
```

型号：products.php

```
class Products extends CI_Model {
    function __construct() {
        parent::__construct();
    }

    function get_products() {
        $q = $this->db->get('product');
    if($q->num_rows() > 0) {
        foreach ($q->result() as $row) {
            $data[] = $row;
        }
        return $data;
    }
}
} 
```

我已将这些类放在它们应该位于的目录中，并使用与该类同名的文件名......如果我在控制器中注释掉加载模型代码，则会显示我的视图。我的数据库连接是正确的，因为如果我将它们更改为不正确的内容，CI 会引发错误。模型或其加载存在某种问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:23:01.163

您有冲突的类名，modell 和控制器类都称为`Products`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:27:22.833

试试这个：

类产品扩展 CI_Controller {

```
public function index() {
    $this->load->model('products_model','products');
    $this->load->view('products');
}
} 
```

型号：products_model.php

```
class Products extends CI_Model {
                        function __construct() {
            parent::__construct();
    }

    function get_products() {
        $q = $this->db->get('product');
    if($q->num_rows() > 0) {
        foreach ($q->result() as $row) {
            $data[] = $row;
        }
        return $data;
    }
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:26:08.563

一个好的约定是将控制器命名为 ProductsController，然后保留模型 Products。所以所有的控制器都是SomethingController。

例子：

```
class ProductsController extends CI_Controller 
```

文件名变成 products_controller.php

模型仍然：

```
class Products extends CI_model 
```

并且仍然是 products.php

现在你的代码应该可以工作了。

# jquery - 在 800px 后在 scrollDown 上显示 div

> ID：15798360
> 
> 赞同：80
> 
> 时间：2013-04-03T21:20:35.010
> 
> 标签：jquery, html, css

我想在从页面顶部向下滚动 800 像素后显示隐藏的 div。现在我有了这个例子，但我想它需要修改才能实现我正在寻找的东西。

编辑：

[并且当scrollUp并且高度小于800px时，这个div应该隐藏]

HTML：

```
<div class="bottomMenu">
  <!-- content -->
</div> 
```

CSS：

```
.bottomMenu {
    width: 100%;
    height: 60px;
    border-top: 1px solid #000;
    position: fixed;
    bottom: 0px;
    z-index: 100;
    opacity: 0;
} 
```

jQuery：

```
$(document).ready(function() {
    $(window).scroll( function(){
        $('.bottomMenu').each( function(i){
            var bottom_of_object = $(this).position().top + $(this).outerHeight();
            var bottom_of_window = $(window).scrollTop() + $(window).height();
            if( bottom_of_window > bottom_of_object ){
                $(this).animate({'opacity':'1'},500);
            }
        }); 
    });
}); 
```

这是我当前代码的[小提琴](http://jsfiddle.net/ZyKar/)。

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2013-04-04T00:41:50.970

**如果要在滚动多个像素后显示 div：**

**[工作示例](http://jsfiddle.net/apaul34208/ZyKar/3/)**

```
$(document).scroll(function() {
  var y = $(this).scrollTop();
  if (y > 800) {
    $('.bottomMenu').fadeIn();
  } else {
    $('.bottomMenu').fadeOut();
  }
}); 
```

```
$(document).scroll(function() {
  var y = $(this).scrollTop();
  if (y > 800) {
    $('.bottomMenu').fadeIn();
  } else {
    $('.bottomMenu').fadeOut();
  }
});
```

```
body {
  height: 1600px;
}
.bottomMenu {
  display: none;
  position: fixed;
  bottom: 0;
  width: 100%;
  height: 60px;
  border-top: 1px solid #000;
  background: red;
  z-index: 1;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<p>Scroll down... </p>
<div class="bottomMenu"></div>
```

它简单，但有效。

[.scroll()](http://api.jquery.com/scroll/)
[文档.scrollTop() 文档](http://api.jquery.com/scrollTop/)

* * *

**如果要在滚动多个像素后显示 div，**

## 没有 jQuery：

**[工作示例](http://jsfiddle.net/smc8ofgg/)**

```
myID = document.getElementById("myID");

var myScrollFunc = function() {
  var y = window.scrollY;
  if (y >= 800) {
    myID.className = "bottomMenu show"
  } else {
    myID.className = "bottomMenu hide"
  }
};

window.addEventListener("scroll", myScrollFunc); 
```

```
myID = document.getElementById("myID");

var myScrollFunc = function() {
  var y = window.scrollY;
  if (y >= 800) {
    myID.className = "bottomMenu show"
  } else {
    myID.className = "bottomMenu hide"
  }
};

window.addEventListener("scroll", myScrollFunc);
```

```
body {
  height: 2000px;
}
.bottomMenu {
  position: fixed;
  bottom: 0;
  width: 100%;
  height: 60px;
  border-top: 1px solid #000;
  background: red;
  z-index: 1;
  transition: all 1s;
}
.hide {
  opacity: 0;
  left: -100%;
}
.show {
  opacity: 1;
  left: 0;
}
```

```
<div id="myID" class="bottomMenu hide"></div>
```

[.scrollY](https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollY)
[文档 .className 文档 .addEventListener](https://developer.mozilla.org/en-US/docs/Web/API/Element/className)
[文档](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener)

* * *

**如果要在滚动到某个元素后显示它：**

**[工作示例](http://jsfiddle.net/apaul34208/ZyKar/1067/)**

```
$('h1').each(function () {
    var y = $(document).scrollTop();
    var t = $(this).parent().offset().top;
    if (y > t) {
        $(this).fadeIn();
    } else {
        $(this).fadeOut();
    }
}); 
```

```
$(document).scroll(function() {
  //Show element after user scrolls 800px
  var y = $(this).scrollTop();
  if (y > 800) {
    $('.bottomMenu').fadeIn();
  } else {
    $('.bottomMenu').fadeOut();
  }

  // Show element after user scrolls past 
  // the top edge of its parent 
  $('h1').each(function() {
    var t = $(this).parent().offset().top;
    if (y > t) {
      $(this).fadeIn();
    } else {
      $(this).fadeOut();
    }
  });
});
```

```
body {
  height: 1600px;
}
.bottomMenu {
  display: none;
  position: fixed;
  bottom: 0;
  width: 100%;
  height: 60px;
  border-top: 1px solid #000;
  background: red;
  z-index: 1;
}
.scrollPast {
  width: 100%;
  height: 150px;
  background: blue;
  position: relative;
  top: 50px;
  margin: 20px 0;
}
h1 {
  display: none;
  position: absolute;
  bottom: 0;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<p>Scroll Down...</p>
<div class="scrollPast">
  <h1>I fade in when you scroll to my parent</h1>

</div>
<div class="scrollPast">
  <h1>I fade in when you scroll to my parent</h1>

</div>
<div class="scrollPast">
  <h1>I fade in when you scroll to my parent</h1>

</div>
<div class="bottomMenu">I fade in when you scroll past 800px</div>
```

请注意，您无法将元素的偏移量设置为`display: none;`，而是获取元素父项的偏移量。

[.each()](http://api.jquery.com/each/)
[文档 .parent() 文档 .offset()](http://api.jquery.com/parent/)
[文档](http://api.jquery.com/offset/)

* * *

**如果您想在滚动到页面后将导航或 div 棒或停靠到页面顶部，并在向上滚动时取消粘贴/取消停靠：**

**[工作示例](http://jsfiddle.net/ZyKar/1697/)**

```
$(document).scroll(function () {
    //stick nav to top of page
    var y = $(this).scrollTop();
    var navWrap = $('#navWrap').offset().top;
    if (y > navWrap) {
        $('nav').addClass('sticky');
    } else {
        $('nav').removeClass('sticky');
    }
});

#navWrap {
    height:70px
}
nav {
    height: 70px;
    background:gray;
}
.sticky {
    position: fixed;
    top:0;
} 
```

```
$(document).scroll(function () {
    //stick nav to top of page
    var y = $(this).scrollTop();
    var navWrap = $('#navWrap').offset().top;
    if (y > navWrap) {
        $('nav').addClass('sticky');
    } else {
        $('nav').removeClass('sticky');
    }
});
```

```
body {
    height:1600px;
    margin:0;
}
#navWrap {
    height:70px
}
nav {
    height: 70px;
    background:gray;
}
.sticky {
    position: fixed;
    top:0;
}
h1 {
    margin: 0;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas,
  imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum
  oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
<div id="navWrap">
  <nav>
    <h1>I stick to the top when you scroll down and unstick when you scroll up to my original position</h1>

  </nav>
</div>
<p>Zombie ipsum reversus ab viral inferno, nam rick grimes malum cerebro. De carne lumbering animata corpora quaeritis. Summus brains sit, morbo vel maleficia? De apocalypsi gorger omero undead survivor dictum mauris. Hi mindless mortuis soulless creaturas,
  imo evil stalking monstra adventus resi dentevil vultus comedat cerebella viventium. Qui animated corpse, cricket bat max brucks terribilem incessu zomby. The voodoo sacerdos flesh eater, suscitat mortuos comedere carnem virus. Zonbi tattered for solum
  oculi eorum defunctis go lum cerebro. Nescio brains an Undead zombies. Sicut malus putrid voodoo horror. Nigh tofth eliv ingdead.</p>
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-03T21:37:45.843

你有一些事情发生在那里。一，为什么要上课？您实际上在页面上有多个这些吗？CSS 建议你不能。如果不是，您应该使用 ID - 在 CSS 和 jQuery 中选择会更快：

```
<div id=bottomMenu>You read it all.</div> 
```

其次，您在该 CSS 中发生了一些疯狂的事情 - 特别是 z-index 应该只是一个数字，而不是以像素为单位。它指定了这个标签在哪个层，每个更高的数字离用户更近（或者换句话说，在 z-index 较低的标签之上/遮挡标签之上）。

您尝试做的动画基本上是 .fadeIn()，所以只需将 div 设置为 display: none; 最初并使用 .fadeIn() 对其进行动画处理：

```
$('#bottomMenu').fadeIn(2000); 
```

.fadeIn() 首先显示：（无论标签的正确显示属性是什么），不透明度：0，然后逐渐提高不透明度。

完整的工作示例：

[http://jsfiddle.net/b9chris/sMyfT/](http://jsfiddle.net/b9chris/sMyfT/)

CSS：

```
#bottomMenu {
    display: none;
    position: fixed;
    left: 0; bottom: 0;
    width: 100%; height: 60px;
    border-top: 1px solid #000;
    background: #fff;
    z-index: 1;
} 
```

JS：

```
var $win = $(window);

function checkScroll() {
    if ($win.scrollTop() > 100) {
        $win.off('scroll', checkScroll);
        $('#bottomMenu').fadeIn(2000);
    }
}

$win.scroll(checkScroll); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-09T07:48:44.173

您也可以这样做。

```
$(window).on("scroll", function () {
   if ($(this).scrollTop() > 800) {
      #code here
   } else {
      #code here
   }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-07T14:41:22.000

**滚动条和`$(window).scrollTop()`**

我发现，在上面提供的解决方案中调用这样的功能，（在这个论坛中还有更多这样的例子——它们都运行良好）只有在滚动条实际可见并且可以操作时才能成功。

如果（正如我可能愚蠢地尝试过的那样），您希望实现这样的功能，并且您还希望，容我们说，实现一个没有滚动条的极简“干净屏幕”，例如在**[这个讨论](https://stackoverflow.com/questions/16670931/hide-scroll-bar-but-still-being-able-to-scroll)**中，那么`$(window).scrollTop()`将无法工作。

这可能是一个编程基础，但我想我会向任何新手提供提醒，因为我花了很长时间才弄清楚这一点。

如果有人可以就如何克服这个问题或提供更多见解提供一些建议，请随时回复，因为我不得不在**[这里求助于显示/隐藏 onmouseover/mouseleave](http://www.collyg.com/architecture)**

长寿和编程，CollyG。

# xamarin.android - 将 YouTubeVideoPlayer 与 Monogame 一起使用

> ID：15798364
> 
> 赞同：0
> 
> 时间：2013-04-03T21:20:44.210
> 
> 标签：xamarin.android, android-mediaplayer, monogame

我目前正在尝试将视频播放器集成到我的 monodroid 应用程序中。想知道这个问题是否有任何有用的解决方案。无法将播放器加载到应用程序中（好像不能同时加载多个SurfaceView）。我目前正在尝试通过将其设置为不可见来隐藏单人游戏窗口，然后将播放器添加到包含 FrameLayout 的内容中。似乎在让播放器正确显示之后，我无法恢复游戏窗口，并且我留下了一个空白屏幕（即使从应用程序中删除了所有手动加载的纹理，我仍然无法得到任何东西渲染！[见这里](https://stackoverflow.com/questions/14162552/on-xna-to-mono-android-conversions-what-is-a-simple-or-the-simplest-way-of-ha)）。

我想知道是否有人找到了将 MediaPlayer 整合到单人游戏中的成功解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:43:36.370

不适用于 youtube，但在 monogame 示例中有一个视频播放器项目。它正在为我构建和运行，但没有在模拟器上显示视频，我无法使用真实设备进行测试[https://github.com/CartBlanche/MonoGame-Samples/tree/master/VideoPlayer](https://github.com/CartBlanche/MonoGame-Samples/tree/master/VideoPlayer)

要运行该项目，您可以访问[https://github.com/CartBlanche/MonoGame-Samples/tree/master/](https://github.com/CartBlanche/MonoGame-Samples/tree/master/)并打开 MonoGame.Samples.Android.sln

# c#-4.0 - 最简单的异步 TextWriter 到 TextReader 流/管道

> ID：15798366
> 
> 赞同：2
> 
> 时间：2013-04-03T21:20:49.057
> 
> 标签：c#-4.0, iostream, producer-consumer

.Net (4.0) 是否有一个允许一个线程写入文本而另一个线程读取的现有类？

理想情况下，我会使用 MemoryStream ，例如：

```
MemoryStream memStream = new MemoryStream();
TextWriter tw = new StreamWriter(memStream);
TextReader tr = new StreamReader(memStream);

//Consumer Thread
(new Thread(delegate() 
{
   while (true)
   {
       Console.WriteLine(tr.ReadLine());
   }
})).Start();

// Producer thread
(new Thread(delegate() 
{
   while (true)
   {
     Thread.Sleep(1000);       
     tw.WriteLine(System.DateTime.Now));
   }
})).Start(); 
```

这不起作用，因为流编写器在流中推进 Position 并且阅读器将看不到任何东西，除非它使用 Seek 倒带，这会在阅读器和编写器影响位置指针时产生并发问题。

这可以通过管道或套接字来完成，这两者都是多余的。带锁的 RYO 代码似乎同样奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:24:15.117

You can use [`BlockingCollection<string>`](http://msdn.microsoft.com/en-us/library/dd267312.aspx). Just add items (text) to the collection from one thread, and use `TryTake` or `GetConsumingEnumerable` from the other.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T22:24:25.733

A`BlockingCollection`会起作用，但如果你想要 Stream 语义，那就有点奇怪了。

框架中没有任何内容。我创造了我称之为 a`ProducerConsumerStream`的东西。请参阅[构建一种新型流](http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=852)。

# wpf - 如何将 WPF 添加到 Visual Studio 2012？

> ID：15798367
> 
> 赞同：3
> 
> 时间：2013-04-03T21:20:52.043
> 
> 标签：wpf

我已经下载并安装了适用于 Windows Phone 的 Visual Studio Express 2012。有没有办法也可以为 Windows 编写 WPF 应用程序？我可以*升级*Visual Studio，因为目前我只能创建 windows phone 应用程序。没有在网上找到任何东西。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:23:01.990

您需要获得[Visual Studio Express for Windows Desktop](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-desktop)（或付费 SKU）来开发 WPF 应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:23:00.330

[http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-desktop](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-desktop)

此版本适用于桌面应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T21:25:41.973

您是否安装了“Express for Windows Phone”？也许尝试“Express for Windows Desktop”？

[http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-desktop](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-desktop)

（必须承认我有一段时间没有尝试过 express，但看起来它们是不同的安装程序。这些天我一直发现 Visual Studio 可以与不同的版本并排运行，所以我想你可以同时安装它们。 )

# iphone - 格式化 CIColorCube 数据

> ID：15798368
> 
> 赞同：3
> 
> 时间：2013-04-03T21:20:53.743
> 
> 标签：iphone, objective-c, core-image

最近，我一直在尝试在 CIImage 上设置 CIColorCube 以创建自定义效果。这是我现在拥有的：

```
uint8_t color_cube_data[8*4] = {
    0, 0, 0, 1,
    255, 0, 0, 1,
    0, 255, 0, 1,
    255, 255, 0, 1,
    0, 0, 255, 1,
    255, 0, 255, 1,
    0, 255, 255, 1,
    255, 255, 255, 1
};
NSData * cube_data =[NSData dataWithBytes:color_cube_data length:8*4*sizeof(uint8_t)];
CIFilter *filter = [CIFilter filterWithName:@"CIColorCube"];
[filter setValue:beginImage forKey:kCIInputImageKey];
[filter setValue:@2 forKey:@"inputCubeDimension"];
[filter setValue:cube_data forKey:@"inputCubeData"];
outputImage = [filter outputImage]; 
```

我已经查看了 WWDC 2012 Core Image 会话，但我仍然无法正常工作。我还检查了网络，关于这个问题的可用资源很少。我上面的代码只返回一个黑色图像。

在 Apple 的[开发者库](http://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html)中，它说：

> 此过滤器将 RGB 空间的映射应用到 inputCubeData 中定义的新颜色值。对于 inputImage 中的每个 RGBA 像素，过滤器使用 R、G 和 B 值来索引 inputCubeData 表示的三维纹理。inputCubeData 包含浮点 RGBA 单元格，其中包含线性预乘值。数据被组织成 inputCubeDimension 数量的 xy 平面，每个平面的大小 inputCubeDimension 由 inputCubeDimension 组成。输入像素分量 R 和 G 分别用于索引 x 和 y 中的数据，B 用于索引 z 中的数据。在 inputCubeData 中，R 分量变化最快，其次是 G，然后是 B。

但是，这对我来说毫无意义。我`inputCubeData`需要如何格式化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-04T05:22:08.530

接受的答案不正确。虽然立方体数据确实应该缩放到`[0 .. 1]`，但它应该是`float`，而不是`int`。

`float color_cube_data[8*4] = { 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0 };`

（从技术上讲，您不必*在*每个数字上加上“.0”，编译器知道如何处理它。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T02:48:07.073

我发现了问题......如果有人有同样的问题，我已经更新了我的问题！

输入浮点数组必须预先除以 255。

原来用的255：

```
uint8_t color_cube_data[8*4] = {
    0, 0, 0, 1,
    255, 0, 0, 1,
    0, 255, 0, 1,
    255, 255, 0, 1,
    0, 0, 255, 1,
    255, 0, 255, 1,
    0, 255, 255, 1,
    255, 255, 255, 1
}; 
```

它应该看起来像这样：

```
uint8_t color_cube_data[8*4] = {
    0, 0, 0, 1,
    1, 0, 0, 1,
    0, 1, 0, 1,
    1, 1, 0, 1,
    0, 0, 1, 1,
    1, 0, 1, 1,
    0, 1, 1, 1,
    1, 1, 1, 1
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-12T13:38:22.680

您的问题是您对 alpha 通道使用值 1（接近于零）， uint8_t 的最大值为 255

请参见下面的示例：

```
CIFilter *cubeHeatmapLookupFilter = [CIFilter filterWithName:@"CIColorCube"];

int dimension = 4;  // Must be power of 2, max of 128
int cubeDataSize = 4 * dimension * dimension * dimension;

unsigned char cubeDataBytes[cubeDataSize];

//cubeDataBytes[cubeDataSize]
unsigned char cubeDataBytes[4*4*4*4] = {
    0,      0,      0,      0,
    255,    0,      0,      170,
    255,    250,    0,      200,
    255,    255,    255,    255
};

NSData *cube_data = [NSData dataWithBytes:cubeDataBytes length:(cubeDataSize*sizeof(char))];

//applying
[cubeHeatmapLookupFilter setValue:myImage forKey:@"inputImage"];
[cubeHeatmapLookupFilter setValue:cube_data forKey:@"inputCubeData"];
[cubeHeatmapLookupFilter setValue:@(dimension) forKey:@"inputCubeDimension"]; 
```

这是完整项目的链接[https://github.com/knerush/heatMap](https://github.com/knerush/heatMap)

# android - EditText - 输入时从 EditText 获取文本

> ID：15798380
> 
> 赞同：12
> 
> 时间：2013-04-03T21:21:46.107
> 
> 标签：android, android-edittext

我想在用户输入 EditText 时将文本放入我的应用程序中的某个字符串中，并使用它在活动中生动地显示它（在不同的视图中......） - 就像谷歌的实时/即时搜索一样......

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-04-03T21:24:01.740

您正在寻找`TextWatcher`：

```
 youredittext.addTextChangedListener(new TextWatcher()
    {
        @Override
        public void afterTextChanged(Editable mEdit) 
        {
            text = mEdit.toString();
        }

        public void beforeTextChanged(CharSequence s, int start, int count, int after){}

        public void onTextChanged(CharSequence s, int start, int before, int count){}
    }); 
```

# iphone - 如何从 url 中检索 json 数据

> ID：15798384
> 
> 赞同：1
> 
> 时间：2013-04-03T21:21:59.997
> 
> 标签：iphone, ios, objective-c, json

基本上我正在尝试从自定义搜索引擎中检索 json 数据，但我没有成功（链接只是一个占位符，无法显示真实链接）。我将发布我的目标 c 代码，并在底部显示我的 json 代码。基本上我试图从中检索 TermText，但我没有成功。我基本上是从 bing 教程中撕下这段代码。任何帮助将不胜感激。现在，代码给了我一个控制台日志 nil。
。H

```
 @interface ViewController : UIViewController{
NSString *jsonstring;
    }
   @property (nonatomic,retain)NSString *offValue;
     -(void) searchBing:(NSString *)text;
     -(void)getData:(NSData *) response; 
```

.m

```
 -(void)searchBing:(NSString *)text{
//MODIFY
NSString *urlString=[NSString stringWithFormat:@"%@%@%@%@",@"http://api/text data.",text,@"&sources=web&web.offset=",offValue];
NSURL *url =[NSURL URLWithString:urlString];
NSData *data =[NSData dataWithContentsOfURL:url];
[self getData:data];
     }
    -(void)getData:(NSData *)response{
NSError *error;
NSMutableDictionary *json = [NSJSONSerialization JSONObjectWithData:response options:kNilOptions error:&error];
NSLog(@"%@",json);
   }

- (void)viewDidLoad
  {
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

offValue =@"0";
[self searchBing:@"Term"];
   } 
```

json

```
 {
    "ReturnValue": [
{
  "Term": {
    "TermID": 1,
    "TermText": "sample string 2",
    "Description": "sample string 3"
  }
},
{
  "Term": {
    "TermID": 1,
    "TermText": "sample string 2",
    "Description": "sample string 3"
  }
},
{
  "Term": {
    "TermID": 1,
    "TermText": "sample string 2",
    "Description": "sample string 3"
  }
}
   ],
  "ResultCode": 0,
  "ResultCodeName": 0,
  "ErrorMessage": "sample string 2"
     } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-03T21:27:56.460

在您的`getData:`方法中，您应该检查是否错误！= nil，这可能会告诉您出了什么问题。

其次，`kNilOptions`不是该参数的有效选项，您应该使用，或[此处](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)`NSJSONReadingMutableContainers`定义的其他选项之一。

第三，`NSLog(@"%@", json)`只会给你关于对象本身的模糊信息，而不是它的内容，你应该使用`NSLog(@"%@", [json description])`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-04T04:07:27.873

JSON 文件可能太大。也许您应该尝试使用 NSURLConnectionDelegate 和 NSURLConnectionDataDelegate 协议来检索 run-loop 中的数据。尝试阅读此内容。 [http://www.cocoaintheshell.com/2011/04/nsurlconnection-synchronous-asynchronous/](http://www.cocoaintheshell.com/2011/04/nsurlconnection-synchronous-asynchronous/)

顺便说一句，我想异步检索数据是一种更好的做法

# jquery - 应该如何应用 jQuery Highlight 样式？

> ID：15798385
> 
> 赞同：0
> 
> 时间：2013-04-03T21:22:01.653
> 
> 标签：jquery, jquery-ui

在 jQuery 主题滚轮的底部右侧，[http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/)，它显示示例“突出显示/错误”文本。我应该如何在我的项目中使用它？

我意识到我可以只复制周围的标记，但这似乎是一种黑客行为。我使用了其他 jQuery 小部件，其中在 jQuery 选择上调用插件方法（例如`accordion()`或`autocomplete()`）。应用高亮或错误样式时是否同样适用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:28:10.743

如您所料，它是为错误或突出显示而保留的。您可以以编程方式应用它们，也可以手动添加 css 类，它将应用

```
 .addClass('ui-state-highlight')
    .addClass('ui-state-error') 
```

# php - File size limit exceeded - transferring a file using fopen - php to ftp

> ID：15798388
> 
> 赞同：0
> 
> 时间：2013-04-03T21:22:06.670
> 
> 标签：php, ftp, fopen, file-transfer

I have a php file that connects to a remote ftp server, and writes a file. Recently, I've been getting an error that says "File Size limit exceeded" everytime it tries to run the following command. This has worked in the past and it is just now starting to happen.

The file is just 2 lines of text, so there shouldn't be a file size issue. Can anybody help me debug what is going on?

```
$varrate =$result->GetLastRealTimeMetalQuotesResult->MetalQuote->Rate;
$varrate = round($varrate,2);

$res = array($varrate, $varclose);
    print_r($res);
    // it's rate then close
    echo "\n"; 
    echo "time to die is ";
    echo $stopitafteraminute-$est;
$fp=fopen("ftp://user:pass@website.com/public_html/rpc-server/textfile.txt", "w", 0, $stream_context);       
foreach($res as $key => $value)
    {
        fwrite($fp,$value."\n");
    }
fclose($fp); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:50:05.083

首先尝试在本地进行，如果它可以将目标文件夹的权限设置为 777（仅用于测试目的）如果它们都不起作用，那么问题是“流”。

而不是在循环中进行写入，而是创建文件然后写入。

```
$file = "";
foreach($res as $key => $value)
    {
        $file.=$value."\n";
    }
 fwrite($fp,$file); 
```

# django - query Django for top users

> ID：15798389
> 
> 赞同：1
> 
> 时间：2013-04-03T21:22:12.747
> 
> 标签：django, django-queryset, annotate

I have to create an algorithm that gets the most popular users of my site. I don't really know how to start. I have to take in consideration : - number of follower - number of comment / topic posted - number of positive vote received by the user - number of group membership

I tried something like this :

```
 UserProfile.objects.annotate(num_topic=Count('topic')).order_by('-num_topic') 
```

This give me the list of userProfile ordered by the most topic but I don't know how to combine all of them.

comment / topic / group / likeComment are table that have a foreign key to the user. Follower / Following is a ManyToManyField through a table named relationship.

Any help would be much appreciated

So far that's where I am :

```
topUsers = UserProfile.objects.annotate(num_topic=Count('topic',    distinct=True)).annotate(num_comment=Count('comment', distinct=True))

for user in topUsers:
    user.positive_votes = LikeComment.objects.filter(Q(type = 1), Q(comment__user=user) |  Q(topic__user=user) ).count()
    user.negaive_votes = LikeComment.objects.filter(Q(type = 0), Q(comment__user=user) |  Q(topic__user=user) ).count()

    user.num_group = GroupUser.objects.filter(user = user, status=1).count()
    user.num_followers = user.related_to.filter(from_people__status=1, from_people__to_person=user).count()
    user.num_followings = user.relationships.filter(to_people__status=1, to_people__from_person=user).count() 
```

But when I do

```
topUsers.order_by('-num_followers','-num_topic','-num_comment','-positive_vote','-num_group','-num_followings') 
```

it doesn't order them.

I tried to use extra fields but I got lost in my sql ...

Thanks

# mysql - 我是否需要在同一台机器上安装 mysql 才能使用 mysql2 gem？

> ID：15798392
> 
> 赞同：2
> 
> 时间：2013-04-03T21:22:39.483
> 
> 标签：mysql, ruby-on-rails

这是场景。

有3个盒子。

1.  我的开发盒（box1）与 mysql。Mysql2 gem 安装得很好，使用的数据库在本地盒子上，box1 本身。

2.  我的产品盒 (box2) 没有 mysql。Mysql2 gem 不会安装。我没有在这个盒子上安装mysql，因为......

3.  我的数据库框（box3）有 mysql。我有这个盒子的主机地址、用户名和密码。box3 具有可与 box2 一起使用的数据库。

问题

我是否需要在 box2 上安装 mysql 才能安装 mysql2 gem，即使我不会在 box2 上使用 mysql 数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:41:28.087

您只需要 MySQL 客户端库和客户端开发头文件（通常是 libmysqlclient 和 libmysqlclient-dev 或类似的东西）。服务器不需要安装或运行。

# android - android: DatePicker background on KindleFire HD

> ID：15798397
> 
> 赞同：1
> 
> 时间：2013-04-03T21:22:47.877
> 
> 标签：android, datepicker, kindle-fire

I tryed to use DatePicker dialog on Kindle. But Edit fields without the background! How I can to fix it (standard-way)? You can check it in emulator. I use Android 2.2 for building application.

![enter image description here](https://i.stack.imgur.com/rSBtE.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-01T16:02:04.870

我遇到了同样的问题。我能够通过调用 DatePickerDialog 的 setInverseBackgroundForced 并传入 true 来解决它。

# javascript - 将水平滚动的内容打印到下一页 - 可能吗？

> ID：15798401
> 
> 赞同：3
> 
> 时间：2013-04-03T21:23:06.990
> 
> 标签：javascript, css, printing-web-page

我一直没有成功尝试打印水平滚动内容。我已经到了厌倦搜索的地步，我想是时候问了——

所以这里是，下面是我要打印的内容的一个非常简化的版本 -

## 的HTML

```
<div id="printingDiv">

    <div class='filterRow'>Something long to print#1 Something long to print#2 Something long to print#3 Something long to print#4 Something long to print#5 Something long to print#6 Something long to print#7 Something long to print#8 Something long to print#9 Something long to print#10</div><br/>

    <div class='filterRow'>Something long to print#1 Something long to print#2 Something long to print#3 Something long to print#4 Something long to print#5 Something long to print#6 Something long to print#7 Something long to print#8 Something long to print#9 Something long to print#10</div><br/>

    <div class='filterRow'>Something long to print#1 Something long to print#2 Something long to print#3 Something long to print#4 Something long to print#5 Something long to print#6 Something long to print#7 Something long to print#8 Something long to print#9 Something long to print#10</div><br/>

    <div class='filterRow'>Something long to print#1 Something long to print#2 Something long to print#3 Something long to print#4 Something long to print#5 Something long to print#6 Something long to print#7 Something long to print#8 Something long to print#9 Something long to print#10</div><br/>

</div> 
```

## CSS

```
.printDiv {
     font-size: 12pt; //else the content adjusts its font-size just to fit the print page
     width: auto;
}

.filterRow {
     white-space: no-wrap; //just for the sake of this example, to make sure the content overflows
     width: auto;
} 
```

## Javascript

```
$("#printingDiv").show();
window.print(); 
```

## 输出

在打印输出上 - 我只看到内容，直到Something long to print#5和Something long to print#6的一部分。

我想看到的是Something long to print#6 到Something long to print#10 的其余部分打印在下一页上。

### 因此，总而言之，我希望能够将不适合第一页的水平滚动内容打印到另一页上。这甚至可能吗？

我提到的一些链接 -

[http://alistapart.com/article/goingtoprint](http://alistapart.com/article/goingtoprint)

[http://meyerweb.com/eric/articles/webrev/200001.html](http://meyerweb.com/eric/articles/webrev/200001.html)

[为具有长水平表格的页面打印样式表](https://stackoverflow.com/questions/292642/print-stylesheets-for-pages-with-long-horizontal-tables)- （此链接有一些其他选项，这是唯一的方法吗？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T21:25:26.420

简短而甜蜜：不...

您完全无法控制使用 javascript 打印的方式。您能做的最好的事情就是将“Something long to print#6+ 包装到下一行”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:28:09.717

从理论上讲，如果您知道将被剪切的副本并将该文本包含在隐藏在屏幕上但在打印时可见的块中，您就可以做到。

```
<div class="noWrapContent">This is a long piece of text that stops here. This is the text that would be cut off.</div>
<div class="forPrint">This is the text that would be cut off.</div> 
```

然后在 css 中：

```
.forPrint { display: none; }

@media print { display: block;} 
```

但是，总的来说，您应该在打印时将其包裹起来。

# php - Codeigniter return unsigned zerofill id from database

> ID：15798406
> 
> 赞同：0
> 
> 时间：2013-04-03T21:23:41.143
> 
> 标签：php, codeigniter

I am using this method to get the last inserted id:

```
$this->db->insert_id(); 
```

for example the inserted id in the database is 000055, but this function returns me only 55, how can I get the full unsigned zerofill id?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:05:59.697

为什么你的ID的零被填满了？如果它返回 1，这可能会导致问题，因为它会认为它是二进制数，而不是填充零的 int。甚至可能会有一个罕见的机会成为十六进制。如果您只想为应用程序填充 ID 的零，则在将其呈现到视图时在库或助手中处理它，因为由于 PHP 是松散类型的，它可能会认为您正在做一些比较或处理十六进制或二进制而不是一个整数。

如果您真的想这样做，您将需要扩展 CI_DB_mysqli_driver（或您正在使用的任何数据库驱动程序）并覆盖 insert_id() 并确保它返回一个字符串，然后确保您始终将其视为字符串。不过，我强烈建议您不要对零填充整数执行逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:34:04.937

假设您使用的是 MySQL——该`$this->db->insert_id()`方法使用[`mysql_insert_id`](http://php.net/manual/en/function.mysql-insert-id.php)函数——它返回一个整数。

因此，在不更改[`./system/database/drivers/mysql/mysql_driver.php`](https://github.com/EllisLab/CodeIgniter/blob/develop/system/database/drivers/mysql/mysql_driver.php#L362)文件的情况下，我认为没有办法。

# gnuplot - 如何使 x 轴位于 Octave gnuplot 上的 y=0 上？

> ID：15798409
> 
> 赞同：5
> 
> 时间：2013-04-03T21:23:59.133
> 
> 标签：gnuplot, octave

如何使 x 轴位于 y=0 上？现在它躺在任何 ymin 上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-11-27T19:41:24.077

我不知道他们是否在 Octave 版本中更改了语法，或者我的代码或函数中有特定内容，但在 Octave 版本 4.4.1 中，我无法使用“零”但使用“原点”来获取此轴

```
 set (gca, "xaxislocation", "origin") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T08:18:22.130

您可以使用以下命令添加 zeroaxis `set`：

```
plot(...)
set(gca, "xaxislocation", "zero") 
```

您可能还想添加：

```
set(gca, "box", "off") 
```

[octave mailinglist](http://octave.1599824.n4.nabble.com/change-position-of-x-axis-td3893956.html)上也有类似的讨论。

# python - 在 Python 中区分二进制文件

> ID：15798411
> 
> 赞同：2
> 
> 时间：2013-04-03T21:24:03.790
> 
> 标签：python, diff

我有两个二进制文件。它们看起来像这样，但数据更随机：

档案一：

```
FF FF FF FF 00 00 00 00 FF FF 44 43 42 41 FF FF ... 
```

文件 B：

```
41 42 43 44 00 00 00 00 44 43 42 41 40 39 38 37 ... 
```

我想要的是这样的称呼：

```
>>> someDiffLib.diff(file_a_data, file_b_data) 
```

并收到类似的东西：

```
[Match(pos=4, length=4)] 
```

表示在两个文件中，位置 4 的字节对于 4 个字节是相同的。序列`44 43 42 41`将不匹配，因为它们在每个文件中的位置不同。

有没有图书馆可以为我做差异？还是我应该只编写循环来进行比较？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-03T21:43:19.857

您可以[`itertools.groupby()`](http://docs.python.org/3.3/library/itertools.html#itertools.groupby)为此使用，这是一个示例：

```
from itertools import groupby

# this just sets up some byte strings to use, Python 2.x version is below
# instead of this you would use f1 = open('some_file', 'rb').read()
f1 = bytes(int(b, 16) for b in 'FF FF FF FF 00 00 00 00 FF FF 44 43 42 41 FF FF'.split())
f2 = bytes(int(b, 16) for b in '41 42 43 44 00 00 00 00 44 43 42 41 40 39 38 37'.split())

matches = []
for k, g in groupby(range(min(len(f1), len(f2))), key=lambda i: f1[i] == f2[i]):
    if k:
        pos = next(g)
        length = len(list(g)) + 1
        matches.append((pos, length)) 
```

或者使用列表推导与上述相同：

```
matches = [(next(g), len(list(g))+1)
           for k, g in groupby(range(min(len(f1), len(f2))), key=lambda i: f1[i] == f2[i])
               if k] 
```

如果您使用的是 Python 2.x，以下是示例的设置：

```
f1 = ''.join(chr(int(b, 16)) for b in 'FF FF FF FF 00 00 00 00 FF FF 44 43 42 41 FF FF'.split())
f2 = ''.join(chr(int(b, 16)) for b in '41 42 43 44 00 00 00 00 44 43 42 41 40 39 38 37'.split()) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-16T19:10:47.807

提供的`itertools.groupby` [解决方案](https://stackoverflow.com/a/15798718/2789762)工作正常，但速度很慢。

我写了一个非常天真的尝试`numpy`，在我碰巧拥有的一个特定的 16MB 文件上使用并测试了它与其他解决方案，它在我的机器上快了大约 42 倍。熟悉的`numpy`人可能会显着改善这一点。

```
import numpy as np

def compare(path1, path2):
    x,y = np.fromfile(path1, np.int8), np.fromfile(path2, np.int8)
    length = min(x.size, y.size)
    x,y = x[:length], y[:length]

    z = np.where(x == y)[0]
    if(z.size == 0) : return z

    borders = np.append(np.insert(np.where(np.diff(z) != 1)[0] + 1, 0, 0), len(z))
    lengths = borders[1:] - borders[:-1]
    starts = z[borders[:-1]]
    return np.array([starts, lengths]).T 
```

# git - 提交并推送文件类型，但从不获取它

> ID：15798413
> 
> 赞同：1
> 
> 时间：2013-04-03T21:24:11.180
> 
> 标签：git

有没有一种方法可以让我提交和推送文件类型，但从不从其他存储库中提取它？

文件类型需要是传入的 *un*compiled 文件和我的提交的编译，所以当我拉取编译的文件时，自动编译器会立即编译并导致合并错误。这样我就可以在推送之前手动编译所有更改后进行编译

我曾尝试暂时关闭自动编译器，但经常有人忘记并最终浪费时间修复它。

编辑：所以我们正在使用 .scss 和 codekit 进行自动编译。如果我们在推送前不编译，服务器就会有过期的 .css 文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:33:25.613

假设这`theFile`是您在拉取存储库时要防止合并的文件，您可以执行

```
echo 'theFile merge=ours' > .gitattributes
git add .gitattributes
git commit -m "Added .gitattributes for preventing theFile to be merged" 
```

完成此操作后，任何后续`git pull`都将`theFile`保持不变，并且将始终使用您的本地版本。

创建和添加文件的另一种方法`.gitattributes`是添加行

```
theFile merge-ours 
```

到`.git/info/attributes`文件。如果您这样做，此行为将仅在本地发生，而如果您提交并推送`.gitattributes`文件，这将在每个 repo 中发生。

# bash - 文件作为脚本的输入

> ID：15798418
> 
> 赞同：1
> 
> 时间：2013-04-03T21:24:30.013
> 
> 标签：bash, file, input

我有一个简单的脚本 (timeconvert.sh) 将秒转换为 hh:mm:ss 格式并将其写入文件*timeremain.out*：

```
#!/bin/bash
#convert sec to h:m:s
secs=${1:?}

h=$(( secs / 3600 ))
m=$(( ( secs / 60 ) % 60 ))
s=$(( secs % 60 ))

printf "%02d:%02d:%02d\n" $h $m $s > timeremain.out 
```

我试图让它读取文件*secremain.out*作为脚本的输入，但以下都不起作用：

```
cat secremain.out | ./timeconvert.sh
./timeconvert.sh < secremain.out 
```

任何人都可以建议使用正确的语法或编辑脚本以直接读取文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:27:01.207

您的脚本从中读取秒数，`$1`因此您可以在命令行中传递它们：

```
secs=$(cat secremain.out)
./timeconvert.sh $secs

# or

./timeconvert.sh $(cat secremain.out) 
```

或者您可以将脚本更改为从标准输入读取：

```
#!/bin/bash
#convert sec to h:m:s
read secs 
```

如果您执行后者，则它可以按照您编写的方式从文件中读取：

```
cat secremain.out | ./timeconvert.sh
./timeconvert.sh < secremain.out 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:46:59.477

## 有了这个脚本

：您既可以使用，也可以使用`STDIN`参数，脚本会自行检测上下文：

```
#!/bin/bash
#convert sec to h:m:s

if [[ -t 0 ]]; then
    secs=${1:?}
else
    read secs
fi

h=$(( secs / 3600 ))
m=$(( ( secs / 60 ) % 60 ))
s=$(( secs % 60 ))

printf "%02d:%02d:%02d\n" $h $m $s 
```

## 使用示例

```
./script.sh 120 
```

或者

```
echo 120 | ./script.sh 
```

# ios - Methods gets called when app goes to the background

> ID：15798421
> 
> 赞同：1
> 
> 时间：2013-04-03T21:24:50.043
> 
> 标签：ios, objective-c, toolbar

my app consists of a table view controller and a view controller. when i press a cell in the table view, the toolbar at that view slips with animation down outside the screen and when i'm in the view controller and press back, the toolbar bar slips upwards to it's original position. My problem is, i figured out a bug that when i'm in the view controller and press the home button to exit the app and then come back. the app resumes where i left but when i go back to the table view, the toolbar shifts upwards beyond it's original position. the sliding of the toolbar works fine when i'm in the app before exiting. so there's like something is being called to reset the toolbar to it's origin and thus adding the additional y-axis point to shift more upwards. does anybody know what are those methods?

Code:

i have this in the viewWillAppear method of the view controller:

```
[UIView animateWithDuration:0.7 animations:^{
        self.navigationController.toolbar.center = CGPointMake(self.navigationController.toolbar.center.x, self.navigationController.toolbar.center.y + self.navigationController.toolbar.frame.size.height);
    } completion:^(BOOL finished){
        self.navigationController.toolbar.hidden = YES;
    }]; 
```

and in the same view when it needs to disappear i added this in the viewWillDisappear:

```
[[self.navigationController toolbar] setHidden:NO];
    [UIView animateWithDuration:1 animations:^{
        self.navigationController.toolbar.center = CGPointMake(self.navigationController.toolbar.center.x, self.navigationController.toolbar.center.y - self.navigationController.toolbar.frame.size.height);
    } completion:^(BOOL finished){
    }]; 
```

i tried this as another way to animate the hiding of the toolbar but there is no animation:

```
- (void) viewWillAppear:(BOOL)animated
{
    [self.picker setHidden:YES];

    [self.navigationController setToolbarHidden:YES animated:YES];

}

- (void) viewWillDisappear:(BOOL)animated
{

    [self.navigationController setToolbarHidden:NO animated:YES];

    [self.course setValue:self.nameTextField.text forKey:@"courseName"];
    [self.course setValue:[NSNumber numberWithInt:[self.creditsTextfield.text integerValue]] forKey:@"courseCredits"];
    [self.course setValue:[NSNumber numberWithInt:[self.chaptersTextfield.text integerValue]] forKey:@"courseChapters"];
    [self.course setValue:self.gradeTextfield.text forKey:@"courseGrade"];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:49:46.533

由于您使用的是属于 UINavigationController 的工具栏（而不是由您自己的控制器实例化并添加到 UIView 的独立 UIToolbar），因此最好使用 UINavigationController 公开的方法，因为您不知道它是如何管理和移动它的用户界面工具栏。

试着把它放在 viewWillAppear: 中，而不是整个动画块

```
[self.navigationController setToolbarHidden:NO animated:YES]; 
```

这在 viewWillDisappear 中：

```
[self.navigationController setToolbarHidden:YES animated:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:34:30.497

一方面，您应该使用框架而不是中心，但将 viewWillDisappear 动画行替换为：

```
self.navigationController.toolbar.frame = CGRectMake(0,0,self.navigationController.toolbar.frame.size.width, self.navigationController.toolbar.frame.size.height); 
```

告诉我会发生什么...

那应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T23:19:05.407

我修好了它！我在 viewWillDisappear 中添加了以下代码行：

```
 self.navigationController.toolbar.center = CGPointMake(self.navigationController.toolbar.center.x, 458);
    self.navigationController.toolbar.center = CGPointMake(self.navigationController.toolbar.center.x, self.navigationController.toolbar.center.y + self.navigationController.toolbar.frame.size.height); 
```

因为问题似乎是，当应用程序进入后台时，前台工具栏会重置为其原始位置，因此在导航回表格视图后，工具栏会移动到其原始位置之外。因此，我添加的第一行将工具栏重置为其原始位置，同时仍处于隐藏状态，然后将其向下移动。之后动画块就完成了。我这样做是为了让动画适用于以下情况： 1\. 用户从表格视图进入详细视图，然后返回表格视图而不退出应用程序。2.用户从tableview进入detail view然后退出app，然后recovery app回到tableview。

# visual-studio-2012 - 用于 VS2012 的 Sql Server Data Tools 与 Sql Server 2012 不兼容怎么办？

> ID：15798422
> 
> 赞同：58
> 
> 时间：2013-04-03T21:24:51.683
> 
> 标签：visual-studio-2012, sql-server-2012-datatools

在似乎很奇怪的转折中，我试图在 Visual Studio 2012 中创建一个 Sql 数据库项目，并得到这个疯狂的错误：

![在此处输入图像描述](https://i.stack.imgur.com/CRDtb.png)

单击任一链接会导致在 Microsoft.com 上未找到页面，这本身就很奇怪。

从错误消息的纯文本中，这是（用于搜索目的）：

> **无法打开数据库项目**
> 
> 此版本的 SQL Server Data Tools 与此计算机上安装的数据库运行时组件不兼容。

考虑到我在工作站上安装了 Sql Server 2012 Developer Edition，这似乎令人难以置信。我可以在安装了 Sql Server 2012 DE 的 VS2008 中打开或创建数据库项目，那么为什么不使用 VS 2012？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-04-04T07:21:47.900

我昨天安装了 SQL Server 2012 Service pack 1，然后我开始遇到您在 Visual Studio 2012 中描述的问题。不仅是数据库项目；我无法使用 SQL Server 对象资源管理器，无法打开 sql-scripts 和许多其他奇怪的与数据库相关的错误。总是有相同的信息：

“此版本的 SQL Server Data Tools 不兼容 ...bla、bla、bla ...”

这个解决方案帮助了我：[https ://web.archive.org/web/20150315060703/http://blog.wharton.com.au/2012/11/16/sql-server-2012-sp-1-breaks-sql -server-database-projects/](https://web.archive.org/web/20150315060703/http://blog.wharton.com.au/2012/11/16/sql-server-2012-sp-1-breaks-sql-server-database-projects/) 希望这对你也有帮助

**更新：** 随着*2013 年 3 月的发布*，您似乎还必须更新[此处](http://msdn.microsoft.com/en-us/jj650015)可用的 SQL Server Data Tools。有关详细信息，请参阅[本文](http://blogs.msdn.com/b/ssdt/archive/2013/03/06/sql-server-data-tier-application-framework-march-2013-available.aspx)中的评论。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-05-09T17:13:00.427

只需下载并安装 SQL Server Data Tools 就可以解决这个问题；

[http://go.microsoft.com/fwlink/?LinkID=274984](http://go.microsoft.com/fwlink/?LinkID=274984)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-28T14:10:26.510

在我安装了 Visual Studio 2013 之后，在 Visual Studio 2012 的现有项目中发生了这种情况。安装 2012 工具修复了它，正如其他人所说，但之前答案中提供的链接不是我需要的。为我做的链接在[这里](http://msdn.microsoft.com/en-us/jj650015)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-15T02:55:28.170

以防万一下载的 SQL Server Data Tools 不工作。您可以尝试下载此版本：

[SQL Server 数据工具下载](http://go.microsoft.com/fwlink/?LinkID=320745)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-11T08:54:24.037

我遇到了类似的问题，但在我的情况下，这是由于版本差异。请参阅附图。所以一旦用正确的版本升级然后问题就解决了。[在此处输入图像描述](https://i.stack.imgur.com/QvI1J.jpg)

# mysql - MySQL 试图同时使用 INNER JOIN 和 UNION？

> ID：15798428
> 
> 赞同：0
> 
> 时间：2013-04-03T21:25:13.227
> 
> 标签：mysql, sql, union, inner-join

所以基本上我想要做的是在两个表上使用 INNER JOIN，但只从表 A 中选择特定行和从表 B 中选择相应的行？

表 A 称为“课程”，我想在“课程标题”列下选择名为“微积分”、“英国文学 I”和“工作室艺术”的条目，以及它们对应的“部门 ID”，我将使用“department_id”作为参考，为其创建与第二个表的 INNER JOIN，该表称为“departments”，该表具有“department_id”和“department_name”列。

我认为这样做的唯一方法是使用 UNION 来选择三个特定的课程，但我想不出一种方法让 INNER JOIN 与它一起工作？我尝试了几种不同类型的语法并不断出错，这是我的尝试之一：

```
(SELECT course.course_title, cours' at line 1
mysql> (SELECT course_title, department_id FROM course WHERE course_title = 'Calculus')
-> UNION
-> (SELECT course_title, department_id FROM course WHERE course_title = 'British Literature I')
-> UNION
-> (SELECT course_title, department_id FROM course WHERE course_title = 'Studio Art I')
-> UNION
-> (SELECT department_name, department_id FROM departments)
-> FROM departments INNER JOIN course ON departments.department_id = course.department_id; 
```

这是我的另一个尝试：

```
(SELECT course.course_title, course.department_id, departments.department_id, departments.department_name WHERE course.course_title = 'Calculus')
-> UNION
-> (SELECT course.course_title, course.department_id, departments.department_id, departments.department_name WHERE course.course_title = 'British Literature I')
-> UNION
-> (SELECT course.course_title, course.department_id, departments.department_id, departments.department_name WHERE course.course_title = 'Studio Art I')
-> FROM departments INNER JOIN course ON departments.department_id = course.department_id; 
```

关于这是否可行的任何想法？如果是这样，我该如何更正我的语法？如果不是，还有什么方法？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:27:56.620

您应该使用 IN 子句...

像这样

```
WHERE course IN ('Calculus','Physics','Art') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:29:44.407

你可以像下面这样写你的查询。

```
SELECT course.course_title, course.department_id, departments.department_id, departments.department_name 
FROM departments 
  INNER JOIN course ON departments.department_id = course.department_id
WHERE course.course_title IN ('Calculus', 'British Literature I','Studio Art I') 
```

# objective-c - objective c libraries on ubuntu

> ID：15798430
> 
> 赞同：1
> 
> 时间：2013-04-03T21:25:18.167
> 
> 标签：objective-c, gcc, gnustep

I installed GNUStep on Ubuntu 12.10, and some tools for Objective-C development. I then tried to compile the following code.

```
#import <Foundation/Foundation.h>

int main(int *argc, const char *argv[]) {
  NSAutorelease *pool = [[NSAutorelease alloc] init];
  NSLog(@"hello world");
  [pool drain];
  return 0;
} 
```

When I compile it with `gcc -o hello hello.m -Wall -lobjc`, I get the following error.

> Foundation/Foundation.h: No such file or directory; compilation terminated.

I find the Foundation library and other libraries in /usr/include/GNUstep/Foundation. Why am I getting that error message?

# php - .getJSON function, append to PHP url, return data from PHP file

> ID：15798432
> 
> 赞同：0
> 
> 时间：2013-04-03T21:25:22.683
> 
> 标签：php, jquery, json

I found many examples of this getting data from a mysql query. What I want to pass back to jQuery function is parsed html content in JSON format. What I want to do is separate PHP code from my initial load of the page. I'm doing this in jQuery Mobile. I know, my description is bad, it's hard to phrase.

I get article names and links from my database and output listview in index.html. When the user clicks on an article, I'm passing the link in the URL, getting it in jQuery and trying to call a PHP file which Parses that URL. Here's ALL the code:

index.html:

```
<body>
  <div data-role="page" id="mainNews">
  <div data-role="content">
        <ul id="fnews" data-role="listview"></ul>
    </div>
</div>
<script src="js/getmainnews.js"></script>
</body> 
```

getmainnews.js:

```
var serviceURL = "http://localhost/basket/services/";
var news;
$('#mainNews').bind('pageinit', function(event) {
getNews();
});
function getNews() {
$.getJSON(serviceURL + 'getmainnews.php', function(data) {
    $('#fnews li').remove();
    mainnews = data.items;
    $.each(mainnews, function(index, mnews) {
        $('#fnews').append('<li data-icon="false"><a style="white-space:normal;" href="newstext.html?url=http://www.basket-planet.com' + mnews.link + '">' + mnews.article + '</a></li>');
    });
    $('#fnews').listview('refresh');
});
} 
```

getmainnews.php:

```
<?php
include 'connect_to_mysql.php';
mysql_query("SET NAMES UTF8");
$sql = mysql_query("SELECT * FROM basket_news");
$mainnews = array();
while ($r = mysql_fetch_assoc($sql)){
$mainnews[] = $r;
}
echo '{"items":'. json_encode($mainnews).'}';
?> 
```

Everything loads fine but the next page comes up empty. Here's the next 3 files...Sorry that this is such a long topic.

newstext.html:

```
<body>
<div data-role="page" id="newstext">
  <div data-role="content">
        <div id="textcontent"></div>
    </div>
</div>
</body> 
```

newstext.js:

```
var serviceURL = "http://localhost/basket/services/";
$('#newstext').bind('pageshow', function(event) {
var url = getUrlVars()["url"];
$.getJSON(serviceURL + 'getnewstext.php?url='+url, displayNewsText);
});
function displayNewsText(data){
var newstext = data.item;
$('#textcontent').append(newstext);
}
function getUrlVars() {
var vars = [], hash;
var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
for(var i = 0; i < hashes.length; i++)
{
    hash = hashes[i].split('=');
    vars.push(hash[0]);
    vars[hash[0]] = hash[1];
}
return vars;
} 
```

And finally getnewstext.php:

```
<?php
include_once ('simple_html_dom.php');
    $url = $_GET['url'];
    $html = file_get_html(''.$url.'');
    $article = $html->find('div[class=newsItem]');
    $a = str_get_html(implode("\n", (array)$article));
    @$a->find('div[style*=float]', 0)->outertext = '';
    @$a->find('h3', 0)->outertext = '';
    @$a->find('div[id=comments]', 0)->outertext = '';
    @$a->find('script', 0)->outertext = '';
    @$a->find('a[href*=register]', 0)->outertext = '';
    @$a->find('div', 4)->outertext = '';
    @$a->find('div', 6)->outertext = '';
    echo '{"item":'. json_encode($a) .'}';
?> 
```

So those are the 6 files. On the newstext.html, the URL contains the URL which I need to pass to my PHP file. I'm sure the problem is in the last three files. What am I doing wrong here? Thanks in advance!

Update: Console error fixed, but still no output on the page.

Update2: From searching around, I saw somewhere that json_encode only accepts arrays. My $a in last PHP script is content from a page containing all kinds of html tags. How can I turn this into an array? To make one key/value with the value being all that html content?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:13:01.097

错误`getUrlVars is not defined newstext.js:3`说明了一切。您正在调用一个未在任何地方定义的函数。我做了一个快速搜索，你可能想要[这个](http://jquery-howto.blogspot.de/2009/09/get-url-parameters-values-with-jquery.html)：

```
function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
} 
```

# joomla - Joomla K2 change "read more" link

> ID：15798446
> 
> 赞同：1
> 
> 时间：2013-04-03T21:26:09.563
> 
> 标签：joomla, joomla-k2

I'm using the K2 Component in Joomla to manage my articles and categories.

Now, I want to link the 'read more'-button to another article, but I don't find the option to change this link (default linked to the article itself). How could I change that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T20:47:19.900

K2 中没有选项可以改变这一点。阅读更多按钮是否总是链接到同一篇文章，还是需要可配置？

如果它始终相同，您可能会创建一个 K2 子模板来执行此操作。

否则，您可能需要创建自定义插件。

# php - 使用 PHP 解析 XML 以创建包含数据表的层次结构的更好方法

> ID：15798449
> 
> 赞同：1
> 
> 时间：2013-04-03T21:26:34.440
> 
> 标签：php, xml-parsing

我最近（两周前）开始用 PHP 编码，今天我遇到了一个问题，想知道是否有人可以帮助/指导我。

我正在从 Web 服务获取 xml 数据，并希望如下图所示呈现数据

![在此处输入图像描述](https://i.stack.imgur.com/EIN8B.png)

获取的 XML 如下所示

```
 <pricesheets>
<pricesheet>            
    <buyinggroupname>China</buyinggroupname>
    <categoryname>Category B</categoryname>
    <currency>USD</currency>
    <discamt>39330.00</discamt>
    <productdesc>Product B description</productdesc>
    <prdouctId> Product B </productId>
</pricesheet>
<pricesheet>            
    <buyinggroupname>Asia</buyinggroupname>
    <categoryname>Category A</categoryname>
    <currency>USD</currency>
    <discamt>39330.00</discamt>
    <productdesc>Product A description</productdesc>
    <prodouctId> Product A </productId>
</pricesheet>   
</pricesheets> 
```

我遇到的问题是在 XML 之上解析的最佳方法是什么，以便我可以根据“buyinggroupname”和“categoryname”呈现产品。一旦我知道如何呈现数据，我就可以轻松完成折叠和展开功能。

以下是我为实现我想要的目标所做的事情。但我确信我的代码不是高效且可扩展的。

```
$xmldata;  // XML return by the webservice
$data = simplexml_load_string($xmldata);
$category_A_items = '';
$category_B_items = '';
foreach ($data as $object) {
  if($object->categoryname == 'Category A') { // Bad Idea : Hard coded category
      $category_A_items .= '<tr><td>'.$object->prdouctId.'</td><td>'. $object->productdesc. '</td><td>'. $object->discamt. '</td></tr>';
    }
  elseif($object->CATEGORYNAME == 'Category B') { // Bad Idea : Hard coded category
        $category_B_items .='<tr><td>'.$object->prdouctId. '</td><td>'. $object->productdesc. '</td><td>'. $object->discamt. '</td></tr>';                      
    }
}
//Render Category A items in table
 if(strlen($category_A_items) > 0) {
      echo '<h3>CAD</h3>';
      echo '<table><tr><th>Product Name</th><th>Description</th><th>Price</th></tr>';
      echo $cadItems;
      echo '</table>'. PHP_EOL;
  }
  //Render Category B items in table
  if(strlen($category_B_items) > 0) {
      echo '<h3>Breast Biopsy</h3>';
      echo '<table><tr><th>Product Name</th><th>Description</th><th>Price</th></tr>';
      echo $breastBiopsy;
      echo '</table>'. PHP_EOL;
  } 
```

上面的代码仅根据类别（硬编码）呈现数据。现在有什么更好的方法来做同样的事情，这样我就可以根据“buyingroupname”和“categoryname”呈现数据，而无需在php代码中对这两个值中的任何一个进行硬编码。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:56:41.820

使用 xpath获取一组唯一的`<categoryname>`-nodes，然后遍历它并选择`<pricesheet>`具有该特定类别的所有 -nodes，让 xpath 再次完成该工作：

```
$xml = simplexml_load_string($x);
$cat = array_unique($xml->xpath("//categoryname"));

foreach ($cat as $c) {
    echo "$c<br />";
    foreach ($xml->xpath("//pricesheet[categoryname='$c']") as $p) {
        echo $p->productId."<br />";
    }
} 
```

观看现场演示 @ [http://codepad.viper-7.com/m9ruRU](http://codepad.viper-7.com/m9ruRU)

当然，您必须添加用于创建表的代码...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:51:08.073

将字符串放入带有可变键的数组中，让 PHP 可以为您整理好它们，而且您根本不需要知道任何类别名称。我使用了多维数组，这样每个buyingroup 里面都有自己的类别。然后循环遍历数组以制作每个表。如果您需要更多解释，请告诉我。我第一次看到你的图片时误解了它。

```
$xmldata;  // XML return by the webservice
$data = simplexml_load_string($xmldata);
$buyinggroups = array();
foreach ($data as $object) {
    if(isset($object->buyinggroupname) || isset($object->BUYINGGROUPNAME)) {
        if(isset($object->buyinggroupname)) {
            $name = $object->buyinggroupname;
        } else {
            $name = $object->BUYINGGROUPNAME;
        }
    }
    if(isset($object->categoryname) || isset($object->CATEGORYNAME)) {
        if(isset($object->categoryname)) {
            $category = $object->categoryname;
        } else {
            $category = $object->CATEGORYNAME;
        }
    }
    if(isset($category) && isset($name)) { //just making sure this row is OK
        if(!isset($buyinggroups[$name])) {
            $buyinggroups[$name] = array();  //initialize the outer array
        }
        if(!isset($buyinggroups[$name][$category])) {
            $buyinggroups[$name][$category] = '';  //this is like your previous $category_A_items
        }
        $buyinggroups[$name][$category] .= '<tr><td>'.$object->productId.'</td><td>'. $object->productdesc. '</td><td>'. $object->discamt. '</td></tr>';
    }
}

//Render all categories in lots of tables
//I am guessing at what HTML you want here; I don't think it's necessarily correct
echo '<table>'. PHP_EOL;
foreach($buyinggroups as $name=>$set) {
    echo '<tr><th colspan="2">'.$name.'</th></tr>'. PHP_EOL;
    echo '<tr><th> </th><td>';
    foreach($set as $category=>$rows) {
        echo '<table>'; 
        echo '<tr><th><h3>'.$category.'</h3></th>'. PHP_EOL;
        echo '<td><table><tr><th>Product Name</th><th>Description</th><th>Price</th></tr>';
        echo $rows;
        echo '</table>'. PHP_EOL;
    }
    echo '</td></tr>';
}
echo '</table>'; 
```

**编辑：**

这不可能超出您的调试能力。您将获得调试所需的一切。PHP 会告诉您行号和错误。你用谷歌搜索错误并找出它的含义。然后你转到那个行号，看看那里的内容与你用谷歌搜索的内容是如何对应的。在这种情况下，我可以告诉你“非法偏移类型”意味着你有一个不是字符串或整数的数组键。在错误消息的这些行中，您有数组键 $name 和 $category。尝试使用 var_dump($name) 和 var_dump($category) 来找出它们实际上是什么，甚至尝试使用 var_dump($object) 来找出如何从对象中获取名称和类别。

# c - 使用 O_CREAT 打开 - 它是打开还是创建？

> ID：15798450
> 
> 赞同：15
> 
> 时间：2013-04-03T21:26:45.010
> 
> 标签：c, file, unix

我有 10 个进程尝试使用 open(O_CREAT) 调用或多或少地同时打开同一个文件，然后将其删除。是否有任何可靠的方法来找出哪个进程实际创建了文件以及哪个进程打开了已经创建的文件，例如，如果我想准确计算在这种情况下打开该文件的次数。

我想我可以在文件打开操作上放置一个全局互斥锁，并使用 O_CREAT 和 O_EXCL 标志执行一系列 open() 调用，但这不符合我对“健壮”的定义。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T21:30:10.737

将`O_EXCL`标志与`O_CREAT`. 如果文件存在并且 errno 将设置为 ，这将失败`EEXIST`。`O_CREAT`如果它确实失败了，那么在没有和没有`O_EXCL`模式的情况下再次尝试打开。

例如

```
int fd = open(path, O_WRONLY | O_CREAT | O_EXCL, 0644);
if ((fd == -1) && (EEXIST == errno))
{
    /* open the existing file with write flag */
    fd = open(path, O_WRONLY);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-03T22:13:00.223

大致根据您的评论，您需要类似于此功能的内容：

```
/* return the fd or negative on error (check errno);
   how is 1 if created, or 0 if opened */
int create_or_open (const char *path, int create_flags, int open_flags,
                    int *how) {
    int fd;
    create_flags |= (O_CREAT|O_EXCL);
    open_flags &= ~(O_CREAT|O_EXCL);
    for (;;) {
        *how = 1;
        fd = open(path, create_flags);
        if (fd >= 0) break;
        if (errno != EEXIST) break;
        *how = 0;
        fd = open(path, open_flags);
        if (fd >= 0) break;
        if (errno != ENOENT) break;
    }
    return fd;
} 
```

此解决方案不是防弹的。可能有一些情况（可能是符号链接？）会导致它永远循环。此外，它可能在某些并发场景中活锁。我将把解决这些问题作为练习。:-)

* * *

在您编辑的问题中，您提出：

> 我有 10 个进程尝试使用 open(O_CREAT) 调用或多或少地同时打开同一个文件，然后将其删除。

一个 hack-ish 但更防弹的解决方案是给每个进程一个不同的用户 ID。然后，只需使用常规`open(path, O_CREAT|...)`调用。然后，您可以使用文件描述符查询文件`fstat()`，并检查结构的`st_uid`字段`stat`。如果该字段等于进程的用户 ID，则它是创建者。否则，这是一个开场白。这是有效的，因为每个进程在打开后都会删除文件。

# c# - Find classes implementing interface in PreApplicationStartMethod

> ID：15798451
> 
> 赞同：1
> 
> 时间：2013-04-03T21:26:48.000
> 
> 标签：c#, servicestack

I have the situation where I cannot edit the global.asax yet I need to wire up a ServiceStack service. I'm using `PreApplicationStartMethod` which works well but where it gets interesting is I need to allow other developers to plugin their own services in to my service.

In case they have their own APIs defined within their assembly, I've created an interface they can implement; my thinking is I can find the assemblies by looking for classes which implements that and pass it to ServiceStack. This also works well.

The issue however is using `AppDomain.CurrentDomain.GetAssemblies()` which only loads those dlls which are referenced (which won't be the case) so I looked at using `BuildManager.GetReferencedAssemblies()` instead but I can't do that within `PreApplicationStartMethod` as it throws an error:

```
This method cannot be called during the application's pre-start initialization phase. 
```

Does anyone know how I can work around this? Or use Application_Start? I have included my code below in case it helps:

```
 private static Assembly[] GetServicesFromAssemblies()
    {
        var serviceType = typeof(IUCommerceApiService);
        var assemblies = GetAssemblies();
        return  assemblies
                    .SelectMany(s => s.GetTypes())
                    .Where(serviceType.IsAssignableFrom)
                    .Select(t => t.Assembly)
                    .Distinct()
                    .ToArray();
    }

    // Works until app pool refresh
    private static IEnumerable<Assembly> GetAssemblies()
    {
        return AppDomain.CurrentDomain.GetAssemblies();
    }

    // Throws error when called within PreApplicationStartMethod
    private static IEnumerable<Assembly> GetAssemblies()
    {
        return new ReadOnlyCollection<Assembly>(BuildManager.GetReferencedAssemblies().Cast<Assembly>().ToList());
    } 
```

# javascript - Windows UI Automation from a Web Page

> ID：15798453
> 
> 赞同：0
> 
> 时间：2013-04-03T21:26:57.427
> 
> 标签：javascript, html, vb.net, automation, ui-automation

I have VB.NET code that handles automation of various application installs. I want to move this essentially out of a VB generated EXE package, and be able to execute the same code (or the equivalent result) from an HTML page on a server. Is this possible? It looks like javascript can't cross the web application/desktop application barrier. Perhaps I can execute the VB.NET code/application that handles the automation (stored server side) from code in the HTML? This is a fairly broad question(s) so ideas are welcome. Please post examples with your ideas!

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:54:16.630

伊恩的评论让我再次阅读了这个问题。如果您真的打算通过网络浏览器在客户端执行代码，请忽略此答案。

您可以使用任何您想要执行此操作的服务器端语言。由于您已经用 VB 编写了它，因此可以[使用 ASP.NET](http://www.codeproject.com/Articles/18773/Run-Interactive-Command-Shell-or-Batch-Files-From)或[PHP 的 exec()](http://www.php.net/function.exec)。例子：

```
<?php
if($_GET["dosomething"]) {
    exec("mycommand");
} 
```

`mycommand`当您`dosomething`作为参数传递给文件时将执行。

# java - retrieve an entity with a key from datastore

> ID：15798458
> 
> 赞同：0
> 
> 时间：2013-04-03T21:27:05.627
> 
> 标签：java, google-app-engine

I am trying to retrieve an entity from my database using its id. I've tried using all kind of commands but the result stays the same , I always get an empty entity. I know the id is correct because I run a query on my database and receive this id.
this is how i receive the id from my database

```
Object course = courseList.get(0).getKey().getId(); 
```

I tried creating a key from that id and use

```
Key key = KeyFactory.createKey("courses", course);
db.get(key); 
```

even tried run a query on database with that key.I can see the the query is correct but I still receive an empty entity:

```
Query query = new Query("Courses").setFilter(Query.FilterOperator.EQUAL.of(Entity.KEY_RESERVED_PROPERTY, key)); 
```

and also like that

```
Query query = new Query("Courses").setFilter(Query.FilterOperator.EQUAL.of("__Key__", key)); 
```

I'm out of ideas ... what am I doing wrong? I know for sure this key exist.In debug mode I can see this key.I see it also in my database. thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:51:28.820

我从来没有过多地使用过 Java，但是从[文档](https://developers.google.com/appengine/docs/java/datastore/jdo/creatinggettinganddeletingdata#Getting_an_Object_By_Key)中这样的东西应该可以工作：

```
PersistenceManager pm = PMF.get().getPersistenceManager();
Courses c = pm.getObjectById(Cources.class, course); 
```

# javascript - 通过 HTML、CSS 和 JS 滑动底部面板

> ID：15798459
> 
> 赞同：0
> 
> 时间：2013-04-03T21:27:06.223
> 
> 标签：javascript, html, css

我正在尝试制作一个悬停时从页面底部滑动的菜单。我已经实现了滑动效果，并且我的 div 已经位于屏幕底部，顶部 40px 显示，因此您可以将鼠标悬停在其上以激活滑动效果。问题是 div 不是“固定的”，它不会随页面滚动。我认为一点 JS 将是最好的解决方案

这是我的 HTML：

```
<div id="floatingmenu">
    <div id="listcontainer">
        <ul class="floatingcolumn">
            <li>Link 1</li>
        </ul>
        <ul class="floatingcolumn">
            <li>Link 2</li>
        </ul>
        <ul class="floatingcolumn">
            <li>Link 3</li>
        </ul>
    </div>
</div> 
```

这是CSS：

```
#floatingmenu {
    width:100%;
    height:320px;
    position:absolute;
    bottom:-300px;
    z-index:99999;
    background:#000;
    -webkit-transition: all 700ms ease;
    -moz-transition: all 700ms ease;
    -ms-transition: all 700ms ease;
    -o-transition: all 700ms ease;
    transition: all 700ms ease;
}

#floatingmenu:hover {
    bottom:0px;
    -webkit-transition: all 700ms ease;
    -moz-transition: all 700ms ease;
    -ms-transition: all 700ms ease;
    -o-transition: all 700ms ease;
    transition: all 700ms ease;
}

#listcontainer {
    position:relative;
    width:900px;
    margin-left:auto;
    margin-right: auto;
}

#listcontainer ul {
    width:290px;
    float:left;
    color:FFF;
} 
```

你可以在这里看到它的实际效果：

[http://jsfiddle.net/fn6t7/](http://jsfiddle.net/fn6t7/)

任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:29:29.150

您应该在CSS 类中更改您的`position:absolute;`to ：`position:fixed;``#floatingmenu`

```
#floatingmenu {
   width:100%;
   height:320px;
   position:fixed;
   bottom:-300px;
   z-index:99999;
   background:#000;
   -webkit-transition: all 700ms ease;
   -moz-transition: all 700ms ease;
   -ms-transition: all 700ms ease;
   -o-transition: all 700ms ease;
   transition: all 700ms ease;
} 
```

# ruby-on-rails - 如何使用 rvm 在 Dreamhost 共享服务器上安装 ruby ？

> ID：15798461
> 
> 赞同：4
> 
> 时间：2013-04-03T21:27:34.477
> 
> 标签：ruby-on-rails, rvm, dreamhost

我一直在关注这里的指南：http: [//spontaneousderivation.com/2012/09/30/rails-3-2-on-a-shared-dreamhost-server/](http://spontaneousderivation.com/2012/09/30/rails-3-2-on-a-shared-dreamhost-server/) 以运行 rails 3.2 和 ruby​​ 1.9.3一个dreamhost共享服务器，但我遇到了一个他们没有提到的错误。安装 rvm 后，它无法在没有 root 访问权限的情况下安装要求，而我没有。它列出了以下要求：

```
libreadline6-dev, libyaml-dev, automake, libtool, libffi-dev 
```

如果我通过设置以下设置 autolibs 忽略这一点

```
rvm autolibs 1 
```

并运行：

```
rvm install ruby-1.9.3 
```

然后它到达编译步骤并给出此错误：

```
Error running 'make -j8',
please read /home/USER/.rvm/log/ruby-1.9.3-p392/make.log
There has been an error while running make. Halting the installation. 
```

有谁知道我可以绕过这个的方法吗？我已经尝试了几天了。

这是make.log的内容：

```
 CC = gcc
LD = ld
LDSHARED = gcc -shared
CFLAGS = -O3 -ggdb -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Werror=pointer-arith -Werror=write-strings -Werror=declaration-after-statement -Werror=implicit-function-declaration  -fPIC 
XCFLAGS = -include ruby/config.h -include ruby/missing.h -fvisibility=hidden -DRUBY_EXPORT
CPPFLAGS =   -I. -I.ext/include/x86_64-linux -I./include -I.
DLDFLAGS = -Wl,-soname,libruby.so.1.9  
SOLIBS = -lpthread -lrt -ldl -lcrypt -lm  
compiling main.c
compiling dmydln.c
compiling dmyencoding.c
compiling version.c
compiling array.c
compiling miniprelude.c
compiling bignum.c
compiling class.c
compiling compar.c
compiling complex.c
compiling dir.c
compiling dln_find.c
compiling enum.c
compiling enumerator.c
make: *** [enumerator.o] Killed
make: *** Waiting for unfinished jobs.... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-08T03:33:52.670

您应该使用二进制文件安装 ruby​​（没有编译错误）。像这样：

```
$ rvm list remote

# Rubies available for 'debian/6/x86_64':
  ruby-1.9.3-p194
  ruby-1.9.3-p286
  ruby-1.9.3-p327
  ruby-1.9.3-p362
  ruby-1.9.3-p374
* ruby-1.9.3-p392
  ruby-1.9.3-p429
  ruby-1.9.3-p448
  ruby-2.0.0-p0
  ruby-2.0.0-p195
* ruby-2.0.0-p247

# * - installed already 
```

那么你像这样安装二进制文件：

```
$ rvm mount -r https://rvm.io/binaries/{YOUR_SERVER_ENV}/{RUBY_VERSION}.tar.bz2 --verify-downloads 1 
```

或者

```
$ rvm mount -r https://rvm.io/binaries/debian/6.0.4/x86_64/ruby-1.9.3-p448.tar.bz2 --verify-downloads 1 
```

当然，您不能将Passenger 与RVM 以及ruby-1.8.7 以外的任何东西一起使用。请参阅这篇文章来设置 FastCGI：[http ://wiki.dreamhost.com/Rails_3#Using_FastCGI](http://wiki.dreamhost.com/Rails_3#Using_FastCGI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-19T20:43:20.620

不确定这篇 wiki 文章是否存在，但 Dreamhost 现在有[一篇](http://wiki.dreamhost.com/Rvm)。直接从中获取并假设您具有 SSH 访问权限，

检查以确保正确安装了 rvm：

```
rvm --version
rvm 1.26.11 (latest) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/] 
```

获取可用版本列表：

```
rvm list known 
```

安装你想要的版本

```
rvm install 2.2.2 
```

告诉系统默认的 ruby​​ 版本

```
rvm use 2.2.2 --default 
```

检查以确保安装了正确的 ruby​​ 版本

```
ruby -v
ruby 2.2.2p95 (2015-04-13 revision 50295) [x86_64-linux] 
```

如果这不起作用 - 我将按照教程中的步骤再次安装 rvm

1.  安装 RVM 的公钥

    ```
    gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 
    ```

2.  安装最新的稳定版本的 RVM，这将

    ```
    curl -sSL https://get.rvm.io | bash -s stable 
    ```

    在您的用户下创建一个名为 /.rvm 的新文件夹
    将此行添加到您的 .bash_profile

    ```
    [[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function* 
    ```

    将此行添加到您的 .bashrc 文件中：

    ```
    export PATH="$PATH:$HOME/.rvm/bin" # Add RVM to PATH for scripting 
    ```

3.  运行这个来取消你的 GEM_HOME

    ```
    unset GEM_HOME 
    ```

4.  运行此命令以获取新的 RVM 安装：

    ```
    source ~/.rvm/scripts/rvm 
    ```

5.  将此添加到您的 .bashrc 文件中

    ```
    source .bash_profile 
    ```

6.  运行此命令以更新您的 .bash_profile：

    ```
    . ~/.bash_profile 
    ```

7.  现在检查 RVM 是否已安装并正常运行：

    ```
    rvm --version
    rvm 1.26.11 (latest) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/] 
    ```

# asp.net-mvc - 为什么不调用 IActionFilter.OnActionExecuted？

> ID：15798462
> 
> 赞同：2
> 
> 时间：2013-04-03T17:57:56.227
> 
> 标签：asp.net-mvc, asp.net-mvc-4

```
public class FirstActionAttribute : FilterAttribute, IActionFilter
{
    /* Is Called */
    public void OnActionExecuted(ActionExecutedContext filterContext)
    {}

    public void OnActionExecuting(ActionExecutingContext filterContext)
    {}
}

public class SecondActionAttribute : FilterAttribute, IActionFilter
{
    /* Isn't Called */
    public void OnActionExecuted(ActionExecutedContext filterContext)
    {}

    public void OnActionExecuting(ActionExecutingContext filterContext)
    {
           filterContext.Result = new ViewResult { ViewName = "NotIndex" };
    }
}

    [FirstAction(Order =1)]
    [SecondAction(Order=2)]
    public ActionResult Index()
    {
        return View();
    } 
```

`OnActionExecuted()`为`OnActionExecuting()`在设置属性的操作过滤器之前调用的操作过滤器调用`Result`，因此取消了操作方法的执行。在我们的例子中， `FirstAction.OnActionExecuted`被调用，而`SecondAction.OnActionExecuted`没有。

a)如果从未执行过*action 方法*`FirstAction.OnActionExecuted`，那么调用的目的是什么？*`Index`*

b）无论如何，既然`FirstAction.OnActionExecuted`确实被调用了，为什么不`SecondAction.OnActionExecuted`也被执行？

# c++ - 图形编程资源

> ID：15798465
> 
> 赞同：-3
> 
> 时间：2013-04-03T21:27:49.880
> 
> 标签：c++, opengl, graphics

我最近开始学习如何使用 OpenGL 绘制计算机图形。我看到了很多我不知道的词。例如。处理管道、着色器、着色器语言、图形缓冲区……我完全不知道图形处理器是如何工作的，但我找不到任何能以简单方式解释它的书籍。您能否推荐一些有关计算机图形工作原理的资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:49:22.223

交互式计算机图形学：基于着色器的 OpenGL 的自上而下方法 Edward Angel 和 Dave Shreiner，第 6 版

这是一本相当不错的教科书的最新版本，涵盖了从视觉基础到创建 3D 图像到现代 GPU 着色器的所有内容。（您确实需要知道如何编程。）

# css - 使 CSS 图像翻转出现（相对于滑入）

> ID：15798468
> 
> 赞同：0
> 
> 时间：2013-04-03T21:27:54.253
> 
> 标签：css, rollover

不知道发生了什么，但我怀疑 jquery 正在工作......我在悬停时使用图像精灵，但图像从右侧滑入而不是出现在适当的位置。[在http://www.maidinhoboken.com/testpage/](http://www.maidinhoboken.com/testpage/)看到蓝色气泡变成红色气泡

我如何让它出现在适当的位置？

HTML：

```
<a href="#" class="rollover" title=""><span class="displace">Test</span></a> 
```

CSS：

```
a.rollover {
display: block;
width: 190px;
height: 190px;
text-decoration: none;
background: url(images/bubble_rollover1.png);
}

a.rollover:hover {
background-position: -190px 0;
}

.displace {
position: absolute;
left: -5000px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:35:11.970

将此添加到您的 CSS 文件中的第 1666 行

```
a.rollover, a.rollover:hover {
    transition: none; 
    -moz-transition: none; 
    -webkit-transition: none; 
    -o-transition: none; 
    -ms-transition: none; 
} 
```

您在样式表的某处设置了一个过渡集，该过渡集正在被继承。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:35:09.000

你有 CSS 过渡，它使图像滚动而不是出现。将`transition:none`规则放入 a.rollover：

```
a.rollover {
  display: block;
  width: 190px;
  height: 190px;
  text-decoration: none;
  background: url(images/bubble_rollover1.png);

  /* add this */
  transition: none;
  -moz-transition: none; /* Firefox 4 */
  -webkit-transition: none; /* Safari and Chrome */
  -o-transition: none; /* Opera */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:36:49.583

您在此处的链接上设置了转换

```
a, a:visited {
    color: #3FB6D7;
    text-decoration: none;
    transition: all 0.2s ease-in-out 0s;
} 
```

删除它应该没问题

# iphone - 处理表格视图单元格内的图像和标签

> ID：15798471
> 
> 赞同：0
> 
> 时间：2013-04-03T21:28:04.037
> 
> 标签：iphone, uitableview, uiimageview

我在表格视图的每个单元格中创建了一个标签和图像。如果单击图像，我希望标签数据引用该单元格。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UILabel *phone=[[[UILabel alloc]initWithFrame:CGRectMake(10, 95, 320,15)]autorelease];

    phone.font=[UIFont boldSystemFontOfSize:12];
    [phone setTextAlignment:UITextAlignmentLeft];
    [phone  setText:[d valueForKey:@"Phone"]];
    [cell addSubview:phone];

    myImageView.image = [UIImage imageNamed:@"call.png"];
    cell.imageView.image=myImageView.image;
    cell.imageView.userInteractionEnabled=YES;

    UITapGestureRecognizer *tapped = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(imageSelectedInTable:)];

    [cell.imageView addGestureRecognizer:tapped];
    [tapped release];
}

-(IBAction)imageSelectedInTable:(UITapGestureRecognizer*)gesture
{
    NSLog(@"Selected an Image");

    UIImageView *imgView = (UIImageView *) [gesture view];
    UITableViewCell *cell = (UITableViewCell*)[[imgView superview]superview];
    NSIndexPath *tappedIndexPath = [self.tableView indexPathForCell:cell];
    NSLog(@"Image Tap %@", tappedIndexPath);
} 
```

但是如何获取标签数据谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:20:50.463

您的代码似乎有几处问题，例如您在 cellForRowAtIndexPath 中的“单元格”在哪里？话虽这么说，要解决您眼前的问题，您可以在 cellForRowAtIndexPath 内的手机标签中添加一个标签，例如，`phone.tag = 5;`然后在您的手势识别器方法中添加`UILabel *phone = (UILabel *)[cell viewWithTag:5];`. 现在您有了对该单元格中标签的引用。

# git - Git的提交是原子的吗？

> ID：15798472
> 
> 赞同：12
> 
> 时间：2013-04-03T21:28:05.867
> 
> 标签：git, version-control

更新钩子可以拒绝部分提交并允许其他部分。

receive_pack.c 中的 update() 在循环中运行，然后在提交期间可能会多次调用更新钩子。每次调用更新钩子时，它都会返回失败，似乎允许更新一些引用，而如果拒绝，则不更新一些引用。

Git 的更新钩子功能是否允许部分提交成功和部分失败是否意味着 Git 的提交不是原子的？

或者我在这里错过了什么？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-03T21:38:44.700

是的，提交是原子的。不可能拒绝提交的一部分。

**如果同时推送多个分支，则在一次推送**（非提交）期间可能会多次调用更新挂钩。这允许接受对某些分支的更新，同时拒绝对其他分支的更新，但每个接受的更新仍将指向来自推送存储库的完整提交。

# c++ - 奇怪的 Clang 行为

> ID：15798478
> 
> 赞同：14
> 
> 时间：2013-04-03T21:28:19.657
> 
> 标签：c++, c++11, g++, llvm, clang

看看这段代码：

```
#include <iostream>
#include <string>

void foo(int(*f)()) {
    std::cout << f() << std::endl;
}

void foo(std::string(*f)()) {
    std::string s = f();
    std::cout << s << std::endl;
}

int main() {
    auto bar = [] () -> std::string {
        return std::string("bla");
    };

    foo(bar);

    return 0;
} 
```

编译它

```
g++ -o test test.cpp -std=c++11 
```

导致：

```
bla 
```

就像它应该做的那样。编译它

```
clang++ -o test test.cpp -std=c++11 -stdlib=libc++ 
```

导致：

```
zsh: illegal hardware instruction  ./test 
```

并编译它

```
clang++ -o test test.cpp -std=c++11 -stdlib=stdlibc++ 
```

还导致：

```
zsh: illegal hardware instruction  ./test 
```

Clang/GCC 版本：

```
clang version 3.2 (tags/RELEASE_32/final)
Target: x86_64-pc-linux-gnu
Thread model: posix

gcc version 4.7.2 (Gentoo 4.7.2-r1 p1.5, pie-0.5.5) 
```

任何人有什么建议是怎么回事？

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-03T22:57:14.120

是的，这是 Clang++ 中的一个错误。我可以在 i386-pc-linux-gnu 中使用 CLang 3.2 重现它。

现在进行一些随机分析...

我发现错误在于从 labmda 到指针到函数的转换：编译器创建了一种具有适当签名的*thunk*调用 lambda，但它具有指令`ud2`而不是`ret`.

`ud2`众所周知，指令是显式引发“无效操作码”异常的指令。也就是说，故意留下未定义的指令。

看看反汇编：这是thunk函数：

```
main::$_0::__invoke():
        pushl   %ebp
        movl    %esp, %ebp
        subl    $8, %esp
        movl    8(%ebp), %eax
        movl    %eax, (%esp)
        movl    %ecx, 4(%esp)
        calll   main::$_0::operator()() const ; this calls to the real lambda
        subl    $4, %esp
        ud2   ; <<<-- What the...!!! 
```

因此，该错误的最小示例将是：

```
int main() {
    std::string(*f)() = [] () -> std::string {
        return "bla";
    };
    f();
    return 0;
} 
```

奇怪的是，如果返回类型是简单类型，例如`int`. 那么生成的*thunk*是：

```
main::$_0::__invoke():
        pushl   %ebp
        movl    %esp, %ebp
        subl    $8, %esp
        movl    %eax, (%esp)
        calll   main::$_0::operator()() const
        addl    $8, %esp
        popl    %ebp
        ret 
```

我怀疑问题出在返回值的转发上。如果它适合一个寄存器，如`eax`一切顺利。但是如果它是一个很大的结构，比如`std::string`它在堆栈中返回，编译器就会感到困惑并发出`ud2`绝望的声音。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-03T21:42:07.553

这很可能是 clang 3.2 中的一个错误。我无法用铿锵的树干重现崩溃。

# delphi - 在 DWScript 中从 Delphi 调用重载方法

> ID：15798480
> 
> 赞同：4
> 
> 时间：2013-04-03T21:28:35.660
> 
> 标签：delphi, dwscript

在`dwsDatabaseLibModule.pas`引擎中包含的单元中，通过 TProgramInfo.Vars[] 访问类来调用类的构造函数。类似地，我想我可以以同样的方式调用重载方法：`info.Vars['TMyClass'].Method['MethodName'].Call`.

在那里使用 IInfo.Method 属性，我如何区分重载的方法？

# c++ - rapidjson - 更改对象 - 添加元素/项目

> ID：15798483
> 
> 赞同：1
> 
> 时间：2013-04-03T21:28:51.573
> 
> 标签：c++, json, element, add, rapidjson

如何将成员添加到 rapidjson 对象然后打印它？

例如添加

```
 itemtwo => "world" ; 
```

对这个对象：

```
{"itemone":"hello"} 
```

我试过了

```
 char buff[] = "{\"itemone\":\"hello\"}";
 rapidjson::Document json_obj;
 if(json_obj.Parse<0>(buff.c_str()).HasParseError() == false){        
    json_obj["itemtwo"].SetString("world");
    rapidjson::StringBuffer strbuf;
    rapidjson::Writer<rapidjson::StringBuffer> writer(strbuf);
    json_obj.Accept(writer);
    cout<<strbuf.GetString()<<endl;
 } 
```

我得到以下输出：

```
{"itemone":"hello"} 
```

没有变化的意思。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:41:53.087

`json_obj["itemtwo"]`只能找到具有该名称的成员，该名称不存在。它不会创建新条目（如 中`std::map`）。

操作对象，使用`AddMember()`和其他相关的成员函数，例如

```
json_obj.AddMember("itemone", "hello", json_obj.GetAllocator()); 
```

您可以参考[rapidjson 用户指南](https://code.google.com/p/rapidjson/wiki/UserGuide)和/或包中的 tutorial.cpp。

# d3.js - 附加整个 SVG 元素或元素系列

> ID：15798487
> 
> 赞同：0
> 
> 时间：2013-04-03T21:29:06.413
> 
> 标签：d3.js

使用 d3 将整个系列的 svg 元素附加到特定选择的最佳方法是什么。例如...首先我附加一个矩形。

```
 tb.append("svg:rect")
        .attr("width", "18")
        .attr("height", "18")
        .attr("y", "9")
        .attr("x", (i * 20) + 5)
        .attr("rx", "4")
        .attr("ry", "4"); 
```

现在取决于我想附加一个图标的选项。图标可以是一系列路径或矩形或多边形。但是是动态的并且基于选项。所以我想做类似的事情：

```
tb.append('<path d="M9.826,4.703C8.863,3.057,7.014,2.032,5.001,2.032c-2.012,0-3.861,1.024-4.829,2.671L0,5l0.173,0.299C1.141,6.944,2.99,7.968,5.001,7.968c2.012,0,3.862-1.023,4.825-2.669L10,5L9.826,4.703z M8.451,5.189C7.764,6.235,6.441,6.888,5,6.888c-1.438,0-2.762-0.652-3.453-1.698l-0.124-0.19l0.124-0.188C2.239,3.764,3.562,3.112,5,3.112c1.441,0,2.763,0.651,3.451,1.698l0.125,0.188L8.451,5.189z"/><circle cx="4.999" cy="5" r="1.905"/>'); 
```

或者

```
tb.append('<polygon points="8.272,0 5.8,4.166 9,4.166 1.615,10 3.461,5 1,5 3.743,0.007"/>'); 
```

但是我不知道输入的元素类型或不同的属性。是否有一种模式可以将整个元素作为字符串插入？还是更好的模式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T22:41:15.463

**编辑：**我刚刚在下面输入了答案，但是，在重新阅读您的问题后，我不确定“动态和基于选项”是否实际上意味着图标类型取决于数据。如果我误解了，请告诉我，我会删除这个答案......

* * *

假设您拥有`dataArray`组成数据的对象数组。

然后你有：

```
var selection = d3.selectAll('.icon').data(dataArray) 
```

然后，听起来您要问的是根据您的数据有条件地创建元素，例如，或者`<rect>`或。`<circle>`理想情况下，您想要的 –– 但 d3 不会让您这样做 –– 是：

```
selection.enter()
  .append(function(d) { // <-- doesn't work :(
    return d.type == 'round' ? 'circle' : 'rect';
  })
  .attr('class', 'icon'); 
```

即，该`.append()`方法不接受函数。所以，相反，你可以做的是：

```
selection.enter()
  .append('g')
  .each(function(d, i) {
    var g = d3.select(this); // That's the svg:g we've just created
    if(d.type == 'round')
      g.append('circle')
    else
      g.append('rect')
  })
  .attr('class', 'icon'); 
```

你在 DOM 中得到的东西是这样的（当然取决于里面的东西`dataArray`）：

```
<svg>
  <g class="icon">
    <circle>
  </g>
  <g class="icon">
    <rect>
  </g>
  <g class="icon">
    <rect>
  </g>
  <g class="icon">
    <circle>
  </g> 
```

# python - Python 线程信息

> ID：15798489
> 
> 赞同：0
> 
> 时间：2013-04-03T21:29:17.447
> 
> 标签：python, multithreading

我有一个带有 4 个线程的 python 程序，我想获取其中一个线程的 cpu 和内存使用情况。我使用了 os.getpid() 然后使用 top -H -p 来获取父 pid 的信息。如果 os.getpid() 返回 3000，那么 top -H -p 会给出 pid 的 3000、3001、3002、3003 和 3004 的信息。我假设每个增量都是下一个线程，但总是这样吗？有没有更好的方法来获取一个线程的这些信息？我在 Linux 上运行 python 2.7。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-17T19:07:07.150

很抱歉复活了一个老问题。我在 linux 上对这个问题的解决方案 - 在 python 线程中

*   创建一个临时文件
*   获取进程PID
*   扫描 /proc/PID/task 以获取任务 pid
*   在每个 /proc/PID/task/task-pid/io 中保存 wchar: 值
*   将随机数量的字符写入临时文件（记住您写入的字符数）
*   重新扫描 /proc/PID/task/task-pid/io 文件
*   消除 wchar 中没有正确增加的任务 pid
*   根据需要经常冲洗并重复以结束 1（或可能 0）任务 pid

# python - ATpy ImportError：没有名为 astropy.io 的模块

> ID：15798491
> 
> 赞同：3
> 
> 时间：2013-04-03T21:29:24.870
> 
> 标签：python, module, osx-snow-leopard

我试图在 python 2.7 上获取 atpy。我从下载 ATpy0.9.6

[https://pypi.python.org/pypi/ATpy/0.9.6](https://pypi.python.org/pypi/ATpy/0.9.6)

然后 tar 并运行：

cd ATpy0.9.6 sudo python setup.py install

事情似乎运作良好。

但是当我尝试在 python 上导入 atpy 时，我总是收到以下错误消息：

**ImportError：没有名为 astropy.io 的模块**

更确切地说，

```
>>> import atpy
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/atpy/__init__.py", line 1, in <module>
    from .basetable import Table, TableSet, VectorException
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/atpy/basetable.py", line 15, in <module>
    from . import registry
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/atpy/registry.py", line 164, in <module>
    from . import fitstable
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/atpy/fitstable.py", line 8, in <module>
    from astropy.io import fits
ImportError: No module named astropy.io
>>> 
```

谁能帮我找出问题所在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T10:28:25.720

也许“atpy”包依赖于您缺少的另一个名为“astropy.io”的包？是的，这里是[https://astropy.readthedocs.org/en/v0.1/index.html](https://astropy.readthedocs.org/en/v0.1/index.html)

碰巧从 pypi.python.org 下载 tar 包是安装 Python 包的错误方法。正确的方法（尽管 Python 文档解释得不好）是运行类似的命令

```
pip install atpy 
```

此命令将安装您的包及其所有依赖项。

如果缺少该命令`pip`，则必须安装它，具有讽刺意味的是，这确实很复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-13T07:09:35.980

就我而言，解决方案是安装astropy

`pip install --no-deps astropy`

# c++ - Qt C++ 可调整大小矩形的最小尺寸

> ID：15798496
> 
> 赞同：0
> 
> 时间：2013-04-03T21:29:44.230
> 
> 标签：c++, qt

在我的应用程序中，我有可以调整大小的矩形（手动实现鼠标事件来调整大小）。我的问题是我可以调整任何大小的矩形。如何实现禁止在 100x100 像素以下调整大小的功能。换句话说，我想要为矩形设置最小尺寸的函数，这样用户就不能在 100x100 像素下调整该矩形的大小。如果需要，我将提供我的部分代码，但现在我需要想法或伪代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T04:58:23.513

如果您已经编写了调整矩形大小的代码，那么您只需要添加如下内容：

```
QRect r = oldRect();
switch (border)
{
    case Left:
        r.setLeft(newLeftPos());
        if (r.width() < minimumWidth())
            r.setLeft(r.right() - minimumWidth());
    break;

    ...

}
draw(r); 
```

# windows-phone-7 - Grunt、Cordova 和 Windows Phone

> ID：15798498
> 
> 赞同：0
> 
> 时间：2013-04-03T21:29:49.917
> 
> 标签：windows-phone-7, cordova, gruntjs

我正在使用 Cordova 为多个平台开发应用程序。Grunt 用作构建工具。我使用它将我的源代码复制到每个平台的正确文件夹中，以便我可以独立开发它们。

这适用于使用 Cordova 提供的脚本的 Android。但是，我不知道是否或如何自动化 WP 构建过程。我正在寻找两件事：

1.  将目录下的所有文件都添加`www`到VS项目中（不包括没有添加到项目中的文件，很遗憾）。
2.  在模拟器中构建、安装和运行应用程序。我使用 adb & Grunt's exec for Android 这真的很简单，WP 有类似的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T23:40:36.907

如果您查看 cordova windows phone 项目，有一个名为“cordova”的目录，其中包含执行所有这些操作的脚本。

应该有脚本来构建和运行您的项目。

运行脚本几乎可以完成所有工作。你可以这样称呼它：

`run --device --release` 或者

`run --emulator --debug` 要不就 `run`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T18:48:15.277

最近的一次[提交](https://github.com/apache/cordova-wp7/commit/fa0662a82f68bcf946ed7a14c065d540a5804f7e)现在可以在 .csproj 文件中使用 www\**，这解决了我的第一个问题。

# c# - 动态添加和删除按钮 c#

> ID：15798500
> 
> 赞同：0
> 
> 时间：2013-04-03T21:29:57.810
> 
> 标签：c#, winforms, custom-controls

我的程序的本质是用户可以通过单击按钮并使用 numericUpDown 来单击他们想要添加的大量文本框和单选按钮。单击按钮后，程序会在文本框下添加一个按钮，但如果我更改行数，第一个按钮会保留并创建一个新按钮。所以我想知道我怎样才能只有一个按钮？我是否也可以通过删除文本框和单选按钮来应用它。

这是我的按钮处理程序代码

```
 int length = (int)this.numericUpDownNumComp.Value;
        bool created = false;
        CustomButton c = new CustomButton();
        for(int i = 0; i < length; i++)
        {
            //instantiate and configure the text boxes
            textboxComputer.Add(new TextBox());
            System.Drawing.Point p = new System.Drawing.Point(176, 114 + i * 25);
            //to evoke an object in an ArrayList we use the 'as' keyword
            (textboxComputer[i] as TextBox).Location = p;
            (textboxComputer[i] as TextBox).Size = new System.Drawing.Size(183, 20);
            //use 'as' again here to add the control to the controls Collection
            this.Controls.Add(textboxComputer[i] as TextBox);
            //instantiate and configure the labels
            this.labels.Add(new Label());
            System.Drawing.Point pLabel = new System.Drawing.Point(100, 114 + i * 25);
            (labels[i] as Label).Location = pLabel;
            (labels[i] as Label).Size = new System.Drawing.Size(80, 13);

            (labels[i] as Label).Text = @"Computer " + (i + 1).ToString() + ":";
            this.Controls.Add((labels[i] as Label));
            //add some mouse events
            (textboxComputer[i] as TextBox).MouseEnter += new System.EventHandler(this.textBox_mouseEnter);
            (textboxComputer[i] as TextBox).MouseLeave += new System.EventHandler(this.textBox_mouseLeave);
            //add the radio buttons - these are already sized  (See RadioButtons.cs) so just need to place at a point
            radioButtons.Add(new RadioButtons());
            (radioButtons[i] as RadioButtons).Location = new System.Drawing.Point(370, 110 + i * 25);
            this.Controls.Add(radioButtons[i] as RadioButtons);
            int last = length - 1;

        }
        if (created == true)
        {
            this.Controls.Remove(c as Button);
            //(c as Button).Location = new System.Drawing.Point(370, 110 + i * 25 + 25);
            created = false;
        }

            created = true;
            this.Controls.Add(c as Button);
            (c as Button).Location = new System.Drawing.Point(370, 110 + length * 25 + 25); 
```

# css - WordPress中小部件区域的CSS悬停图像

> ID：15798504
> 
> 赞同：0
> 
> 时间：2013-04-03T21:30:20.237
> 
> 标签：css, wordpress, widget, hover

我正在尝试创建要在 wordpress 小部件中使用的 CSS 悬停图像。我已经在 Fireworks 中创建了文件并导出了部分 CSS，但现在我完全不知道该放在哪里，以及我缺少什么。

下面是 Fireworks 生成的代码：

```
.e3circles{ background:url("e3circles.png") top left no-repeat; }
.icons_equity_symb{ width:287px; height:289px; background-position:-10px -10px; }
.icons_equity_symb_1{ width:287px; height:289px; background-position:-307px -10px; }
.icons_energy_symb{ width:300px; height:289px; background-position:-604px -10px; }
.icons_energy_symb_1{ width:300px; height:289px; background-position:-914px -10px; }
.icons_easy_symb{ width:313px; height:289px; background-position:-1224px -10px; }
.icons_easy_symb_1{ width:313px; height:289px; background-position:-1547px -10px; }
.icons_pop{ width:900px; height:289px; background-position:-1870px -10px; }
.icons_pop_1{ width:900px; height:289px; background-position:-2780px -10px; } 
```

图片可见：[http ://rachelorovio.com/sprites/e3circles.png](http://rachelorovio.com/sprites/e3circles.png)

我开始使用 Studio Press 的最小主题，它有圆圈社交媒体图标：[http ://demo.studiopress.com/minimum/](http://demo.studiopress.com/minimum/)

我的客户想保留这些圈子，但由于其他原因，我们不得不切换到主题Executive。

我已经研究了几天了，似乎我学得越多，它变得越复杂。每个脚本都不一样，所以我什至无法并排比较它们。如果你能帮忙，请告诉我！！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:30:19.167

所以简单的方法是使用插件，你可以尝试小部件 css 类：

[http://wordpress.org/extend/plugins/widget-css-classes/](http://wordpress.org/extend/plugins/widget-css-classes/)

否则打开你的主题，添加另一个 style2.css 例如到你的主题并在上面添加代码，打开 header.php 并链接到这个样式..然后去你的仪表板，添加一个 TEXT 小部件并调用这个圆圈的 Div会出现...

祝你好运

# c# - 在扩展方法中使用显式转换

> ID：15798505
> 
> 赞同：6
> 
> 时间：2013-04-03T21:30:20.677
> 
> 标签：c#, casting, extension-methods

当我尝试通过扩展方法投射对象时，我遇到了一个奇怪的问题。我有一个类，我将一些功能包装在一个`IPAddress`.

```
// Dumbed down version of class
public sealed class PrefixLengthIPAddress
{
    public static explicit operator IPAddress(PrefixLengthIPAddress address)
    {
        return (address != null) ? address._address : null;
    }

    public PrefixLengthIPAddress(IPAddress address)
    {
        _address = address;
        _length = address.GetLength();
    }

    private readonly ushort _length;
    private readonly IPAddress _address;
} 
```

我不喜欢从`IPAddress`对象中提取所有括号的外观：

```
var family = ((IPAddress)prefixLengthAddress).AddressFamily; 
```

我宁愿能够做这样的事情：

```
var family = prefixLengthAddress.CastAs<IPAddress>().AddressFamily; 
```

为了做到这一点，我编写了以下扩展方法：

```
public static T CastAs<T>(this object value) where T : class
{
    return (T)value;
} 
```

不幸的是，我得到了一个`InvalidCastException`：

```
var family = ((IPAddress)prefixLengthAddress).AddressFamily;         // Works
var family = prefixLengthAddress.CastAs<IPAddress>().AddressFamily;  // InvalidCastException 
```

我知道在这种特殊情况下，我可以简单地`IPAddress`使用 getter 来公开 ，但我们也有更复杂的显式转换，我想用它来做这件事。

**编辑**

感谢 Chris Sinclair 对使用的评论，`dynamic`我已将扩展方法更新为：

```
public static T CastAs<T>(this object value)
{
    return (T)((dynamic)value);
} 
```

using 有一些开销`dynamic`，但它的速度足以满足我的需求。它似乎也适用于我尝试过的所有基本类型转换。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T21:33:52.990

在第一个示例中，您正在访问用户定义的转换。这仅在强制转换运算符知道输入的类型是 时才可用`PrefixLengthAddress`。在泛型代码中，编译器只知道类型`object`和`T`. 它无法访问`PrefixLengthAddress`在这种情况下定义的转换。

在这种情况下，您所做的更接近于映射与投射，因为它实际上是在创造一个新的价值。就 LINQ 而言，您可能希望使用`Select`vs. `Cast`.

# javascript - 如何在引导模式中动态调整字体大小？

> ID：15798506
> 
> 赞同：5
> 
> 时间：2013-04-03T21:30:23.447
> 
> 标签：javascript, jquery, twitter-bootstrap, modal-dialog, autoresize

stackoverflow.com 救了我很多次，但这实际上是我第一次发布问题。提前感谢您对聪明人的帮助！

我正在尝试使用 jquery-quickfit ( [https://github.com/chunksnbits/jquery-quickfit/blob/master/demo/index.html](https://github.com/chunksnbits/jquery-quickfit/blob/master/demo/index.html) ) 来自动调整出现在模态中的一段文本的大小。我正在使用 boostrap 来处理模态（[http://twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)）。

现在，只有在我调整窗口大小后打开模式后，文本才会正确调整大小。当它加载时，文本看起来更小（我不确定它在哪里继承了初始大小）。我希望 javascript 在模态被触发的那一刻启动。我确信有一种明显的方法可以做到这一点，但我并不是那么精通javascript。

这是相关代码的外观：

```
<button class="btn" data-toggle="modal" data-target="#my-modal">Open Modal</button>

<div id="my-modal" class="modal hide fade row">
  <div class="modal-body">
    <div class="span3 modalicon">
      <i class="icon-image"></i>
    </div>
    <div class="span9" id="modaltextcontainer">
      <span class="modaltext">This is the content I want resized</span>
    </div>
  </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="assets/js/bootstrap.js"></script>
<script src="assets/js/jquery.quickfit.js"></script>
<script type="text/javascript" charset="utf-8">
  $(function() {
    $(window).on('resize', function() {
      $('.modaltext').quickfit({ max: 40, min: 0, truncate: false });     

    });
    $(window).trigger('resize');    
  });
</script>

<span id="meassure" style="position: absolute; left: -1000px; top: -1000px; font-size: 12px;">..........</span> 
```

我假设我需要将引导模式显示事件合并到最后一点 javascript 中，我只是不知道如何。

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:41:12.973

您可以在显示如下模式后绑定 quickfit：

```
$('#my-modal').on('show', function() {
   $('.modaltext').quickfit({ max: 40, min: 0, truncate: false });
}); 
```

# asp.net-mvc - 静态内容二级页面需要什么结构？

> ID：15798511
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:30:45.760
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing

我有 6 个产品页面。其中一个产品页面将有 6 个辅助页面。

我将如何为此创建控制器，所以我最终得到了干净的链接。

```
/Products/Product1
/Products/Product2
/Products/Product3
/Products/Product4
/Products/Product5
/Products/Product6
/Products/Product6/SecondaryPage1
/Products/Product6/SecondaryPage2
/Products/Product6/SecondaryPage3
/Products/Product6/SecondaryPage4
/Products/Product6/SecondaryPage5
/Products/Product6/SecondaryPage6 
```

我已经研究过区域并且可以用它们完成我想要的，但是如果存在下划线，我没有任何运气来获取区域名称并用连字符连接它。我可以让控制器和动作连字符但不是区域。如果有人知道如何使该区域连字符，我将再次走这条路。

**更多信息**

这些是静态内容页面。不涉及数据库。我将如何设置一个控制器来生成上面的 URL？我的问题在于辅助页面以及如何处理这些页面。区域是唯一的方法吗？如果是这样，我如何修改路由以允许在区域名称中使用连字符，因为我将来可能需要它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:56:20.950

您的问题没有真正的意义，特别是考虑到您想要的 URL 不包含任何连字符，但通常，一个区域的路由由一个名为`[AreaName]AreaRegistration.cs`. 在该文件的类中，有方法：

```
public override void RegisterArea(AreaRegistrationContext context)
{
    context.MapRoute(
        "MyArea_default",
        "MyArea/{controller}/{action}/{id}",
        new { action = "Index", id = UrlParameter.Optional }
    );
} 
```

因此，您可以通过更改此默认路由轻松更改该区域在 URL 中的表示方式：

```
"My-Area/{controller}/{action}/{id}", 
```

（请注意添加的连字符。这只是一个字符串，可以随意更改。URL 中的区域前缀不必与实际区域名称匹配。）

# ruby-on-rails - 为什么将 default_scope 用于保存

> ID：15798513
> 
> 赞同：1
> 
> 时间：2013-04-03T21:30:53.833
> 
> 标签：ruby-on-rails, spree

为 Spree::Product 添加了 default_scope 以对 spree 站点的主页进行排序，范围为`default_scope :include => :product_taxons, :order => "spree_product_taxons.position"`. 这对其进行了排序，但是当我尝试更新产品时，出现以下错误

```
ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'spree_product_taxons.position' in 'order clause': UPDATE `spree_products` SET `count_on_hand` = 100 WHERE `spree_products`.`id` = 108 ORDER BY spree_product_taxons.position` 
```

首先，为什么要尝试订购更新？好吧，这个领域确实存在

```
Spree::ProductTaxon
=> Spree::ProductTaxon(id: integer, created_at: datetime, updated_at: datetime, product_id: integer, taxon_id: integer, position: integer) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-18T00:33:55.370

该字段存在于 中`spree_products_taxons`，但不存在于 中`spree_products`，因此出现错误。`spree_products_taxons` `include`不会在更新中出现。

# google-chrome-extension - Chrome 扩展弹出窗口关闭时是否有事件？

> ID：15798516
> 
> 赞同：36
> 
> 时间：2013-04-03T21:31:04.500
> 
> 标签：google-chrome-extension

我已经尝试过 window.unload、window.beforeunload 等。我正在寻找一种方法来在弹出窗口关闭后通知我的背景页面。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-04T01:55:58.897

你可以试试这个。[使用chrome.runtime.connect](https://developer.chrome.com/extensions/runtime.html)（或`chrome.extension.connect`在 Chrome 26 之前）连接到您的后台页面，并`port.onDisconnect`在弹出窗口关闭时在您的后台页面中触发。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-04-15T15:15:34.587

可能是一种hacky方式，但在弹出页面中您可以收听

```
 window.onblur = function(){} 
```

并向活动选项卡发送消息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2021-01-04T13:31:00.160

就这么简单：

```
// popup.js
chrome.runtime.connect({ name: "popup" }); 
```

```
// background.js
chrome.runtime.onConnect.addListener(function(port) {
    if (port.name === "popup") {
        port.onDisconnect.addListener(function() {
           console.log("popup has been closed")
        });
    }
}); 
```

请注意，在某些极端情况下此方法不起作用。例如，当打开弹出窗口然后使用键盘快捷键（例如 ctrl + t）切换选项卡时。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-04-06T20:26:13.403

目前无法确定浏览器操作弹出窗口何时关闭，因为`window.unonload`在弹出窗口完成加载时立即触发，而不是在关闭时触发。为此有一个错误[crbug.com/31262](https://crbug.com/31262)。

[这里很好地描述了](http://rethrowexception.wordpress.com/2010/06/01/google-chrome-onunload-event-when-closing-popup/)三种可用的解决方法。它们包括技巧和从弹出窗口或背景页面`port.onDisconnect`定期轮询。`chrome.extension.getViews()`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-12-16T18:33:18.197

我很惊讶没有人提到这一点（我已经在 Firefox Nightly 上对其进行了测试，并且它在那里工作）：

```
window.addEventListener("pagehide", function(event) {
    console.log(event);
 }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-29T06:08:49.643

终于找到了解决办法。将以下代码放入`background.js`/ `eventPage.js`：

```
chrome.windows.onFocusChanged.addListener(function(window) {
    //handle close event
}); 
```

# java - spring调度程序的手动覆盖（使用注释）

> ID：15798520
> 
> 赞同：1
> 
> 时间：2013-04-03T21:31:16.773
> 
> 标签：java, web-services, scheduled-tasks, scheduler, spring-ws

我有一个 spring ws 客户端，我已经安排我的服务使用注释 @Scheduled 运行客户端。我如何提供手动覆盖，以便我可以在必要时启动和停止服务？

# netflix - 有没有办法下载 netflix 目录？

> ID：15798522
> 
> 赞同：0
> 
> 时间：2013-04-03T21:31:27.347
> 
> 标签：netflix

[http://api-public.netflix.com/catalog/titles/streaming](http://api-public.netflix.com/catalog/titles/streaming) 不再起作用（它说是非活动帐户）。有没有办法下载完整目录？想创建应用程序供我使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-16T18:03:54.017

Netflix 去年关闭了他们的开发者计划，这是获得正确凭据以签署 REST 请求 URL 和下载目录的唯一方法……他们也不会发布任何新的开发者密钥。所以，如果你还没有，恐怕你就不走运了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T02:27:45.570

有同样的问题，401 过去工作正常。似乎是 Netflix 的问题，不知道我们能做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T01:13:25.233

我也有同样的问题。我可以开始下载整个目录，但由于它的大小导致我的浏览器崩溃。

我开始阅读此链接（[http://developer.netflix.com/forum/read/157154](http://developer.netflix.com/forum/read/157154)），但老实说，我不太了解它。

有人愿意告诉我如何设置请求、添加 Accept-Encoding 标头，然后解析输出吗？对不起线程劫持...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T22:14:25.443

如果它说“帐户处于非活动状态”，则表示您没有对呼叫进行身份验证——您不能将其粘贴到浏览器中。Netflix 开发者网站上有很多关于此的信息[http://developer.netflix.com/page](http://developer.netflix.com/page)

# c++ - 未声明的正则表达式 (Dev C++)

> ID：15798525
> 
> 赞同：1
> 
> 时间：2013-04-03T21:31:39.463
> 
> 标签：c++, regex, string, integer, dev-c++

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <regex.h>

using namespace std;

string input;

int main()
{   
    //Input .ply file
    ifstream inputFile ("input.ply");

    //input file is read
    if (inputFile.is_open())
    {
        int i = 1;  //Line iterator
        int vertices = 0;
        int faces = 0;

        vector<float> anatomy;
        vector<float> normals;
        vector<int> triangles;

        string a,line;
        getline(cin,line);

        while (inputFile.good())
        {
            //Take number from line 4, set as variable "vertices"
            if (i == 4)
            {
                regex pattern("[^0-9]+");
                getline (inputFile,line);              
                vertices = show_match(line, pattern);
            }

            //Take number from line 11, set as variable "triangles"
            if (i == 11)
            {
                regex pattern("[^0-9]+");
                getline (inputFile,line);              
                faces = show_match(line, pattern);
            }

            if (i == 13)
            {
                i++;
                break;
            }

            i++;

        }

        waitKey(0);
}

else
{
    cout << "Cannot read mesh, please try again." << endl;
}

return 0;

} 
```

只是试图从字符串中读取并提取整数，所以我添加了正则表达式头和其他文件以使用正则表达式。我正在使用 Dev-C++ 并将正则表达式的文件提取到它们各自的*lib*、*bin*和" *C:\Dev-Cpp " 中的**包含*文件夹中，但是当我尝试编译我的程序时仍然收到以下错误：

 *> 'regex' 未声明（首先使用此函数）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-06T22:12:26.220

如果未达到您的语句，您将从编译器收到此错误消息`#include <regex.h>`，例如，如果您使用条件包含。

确保`#include <regex.h>`实际达到。当我通过使用[linux](/questions/tagged/linux "显示标记为“linux”的问题")的条件包含然后尝试使用[openbsd](/questions/tagged/openbsd "显示标记为“openbsd”的问题")的代码意外排除了包含时，我也收到了此错误消息。*

# node.js - 使用 asyncjs 保存多个 Mongoose 对象不起作用

> ID：15798526
> 
> 赞同：1
> 
> 时间：2013-04-03T21:31:45.340
> 
> 标签：node.js, mongoose, mocha.js

我想在我的 mocha 测试中保存两个 Mongoose 对象 - 并在两者都成功时收到通知。我正在使用 asyncjs 库来实现这一点。

```
beforeEach (done) ->

  obj1 = new Person({ name: 'Jon' })
  obj2 = new Person({ name: 'Dan' })

  console.log obj1   # ... { name: 'Jon', _id: 4534534543512 }

  async.list([
    obj1.save
    obj2.save
  ]).call().end( (err, res) ->
    return done(err) if err
    done()
  ) 
```

您可以在 console.log 中看到 obj1 被设置为 MongoDB 文档 - 但是当我想使用 save 函数将它们持久保存到数据库时，尝试执行此操作时出现以下错误：

```
TypeError: Cannot read property 'save' of undefined 
```

如果我用 say 替换 async.list 中的两个函数

```
console.log
console.log 
```

代码执行得很好......另外，如果我像这样将两个对象保存在 async.list 函数之外

```
obj1.save()
obj2.save() 
```

它也执行得很好，没有错误。

我难住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:49:00.167

这可能是因为`save`没有使用预期的上下文 ( `this`) 调用函数。

当您传递类似 的“*方法*”`obj1.save`时，引用`async.list()`仅指向`function`自身，没有任何返回`obj1`（或`obj2`）的链接。这将类似于：

```
save = obj1.save
save() # `this` is `undefined` or `global` 
```

要使用固定上下文传递，您可以使用[`bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)它们：

```
async.list([
  obj1.save.bind(obj1)
  obj2.save.bind(obj2)
]) # etc. 
```

[或者使用其他函数，以便在成员运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Member_Operators)之后调用它们：

```
async.list([
  (done) -> obj1.save(done),
  (done) -> obj2.save(done)
]) # etc. 
```

# javascript - 如何禁用按钮使用户无法再次启用它

> ID：15798527
> 
> 赞同：0
> 
> 时间：2013-04-03T21:31:56.437
> 
> 标签：javascript, jquery, asp.net-mvc

我有一个简单的按钮（例如带有 ID: `new-product`）。
当我单击它时，它将**部分视图**添加到页面上的指定`div`位置。
是否可以在按钮上设置禁用，`new-product`以便用户无法再次单击它。
还要防止该用户在浏览器中更改某些内容并将其`true`再次设置为启用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:34:18.280

这应该可以解决问题

```
$('#new-product').attr('disabled','disabled') 
```

启用

```
$('#new-product').removeAttr('disabled'); 
```

或者您可以将 attr 设置为 ""

```
$('#new-product').attr('disabled', ''); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:35:43.680

您可以按照 sambormartin 的建议在按钮上设置 disabled 属性，但用户**始终**可以从他们的浏览器中更改 HTML、CSS 和 javascript。您不能依赖客户端验证。您必须验证服务器端的所有输入。

# javascript - 浏览器或代码错误？Web Sql 不创建表

> ID：15798528
> 
> 赞同：0
> 
> 时间：2013-04-03T21:32:01.730
> 
> 标签：javascript, web-sql

未创建或未显示的表：

```
function createTbl(){
    db.transaction(function(transaction){
        transaction.executeSql('CREATE TABLE IF NOT EXISTS data(id INTERGER PRIMARY KEY AUTOINCREMENT, name TEXT)');
        transaction.executeSql('INSERT INTO data(name) VALUES("Someone")');
    });
} 
```

数据库在那里，但在表上它是空的。我相信我的代码没有错……那是浏览器问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-22T03:35:41.193

由于关键字 PRIMARY KEY 和 AUTO_INCREMENT，代码不起作用，而是使用关键字 UNIQUE。也不要俱乐部 Unique 和 AUTO_INCREMENT。这是一个工作示例。

```
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <script>

    function runExample(){
      webSql(processResultSet);
    }

    function webSql(callback) {
      var db = openDatabase('mydb', '1.0', 'my first database', 2 * 1024 * 1024);

      db.transaction(function(tx) {
        tx.executeSql('CREATE TABLE IF NOT EXISTS data (id INTERGER AUTO_INCREMENT, name TEXT)');
        tx.executeSql('INSERT INTO data (name) VALUES ("someone")');
      });

      db.transaction(function(tx) {
        tx.executeSql('SELECT * FROM data', [], function(tx, results) {
          callback(results);
        });
      });
    }

    function processResultSet(results) {
      console.dir(results);
      var len = results.rows.length;
      for (var i = 0; i < len; i++) {
        console.dir(results.rows.item(i));
      }
    }
  </script>
</head>
<body onload="runExample()">
</body>
</html> 
```

# r - 为什么 geom_line() 和 geom_freqpoly() 会返回不同的图形？

> ID：15798531
> 
> 赞同：1
> 
> 时间：2013-04-03T21:32:10.443
> 
> 标签：r, ggplot2

我正在尝试让我的头脑围绕 ggplot2 创建美丽的图表，你可能都知道 :)

我有一个数据集，其中包含一些已售房屋的交易（由： http: [//support.spatialkey.com/spatialkey-sample-csv-data/](http://support.spatialkey.com/spatialkey-sample-csv-data/)提供）

我想要一个折线图，在 x 轴上绘制城市，4 条线显示我的数据文件中每个城市的 4 种家庭类型中的每一种的交易数量。听起来不太难，所以我找到了两种方法来做到这一点。

1.  使用**中间表**进行计数和**geom_line()**绘制结果
2.  在我的原始数据框上使用**geom_freqpoly()**

基本图表看起来相同，但图表 nr。2 似乎缺少计数的所有 0 值的图（例如，对于 SACRAMENTO 右侧的城市，没有 Condo、Multi-Family 或 Unknown 的数据（在此图中似乎完全缺失））。

我个人比方法 1 更喜欢方法 2 的语法（这可能是个人的事情）。

所以我的问题是：*我做错了什么还是有一种方法可以在方法 2 中绘制 0 个计数？*

```
# line chart example
# setup the libraries
library(RCurl)        # so we can download a dataset
library(ggplot2)      # so we can make nice plots
library(gridExtra)    # so we can put plots on a grid

# get the data in from the web straight into  a dataframe (all data is from: http://support.spatialkey.com/spatialkey-sample-csv-data/)
data <- read.csv(text=getURL('http://samplecsvs.s3.amazonaws.com/Sacramentorealestatetransactions.csv'))

# create a data frame that counts the number of trx per city/type combination
df_city_type<-data.frame(table(data$city,data$type))

# correct the column names in the dataframe
names(df_city_type)<-c('city','type','qty')

# alternative 1: create a ggplot with a geom_line on the calculated values - to show the nr. trx per city (on the x axis) with a differenct colored line for each type  
cline1<-ggplot(df_city_type,aes(x=city,y=qty,group=type,color=type)) + geom_line() + theme(axis.text.x=element_text(angle=90,hjust=0))

# alternative 2: create a ggplot with a geom_freqpoly on the source data - - to show the nr. trx per city (on the x axis) with a differenct colored line for each type  
c_line <- ggplot(na.omit(data),aes(city,group=type,color=type))
cline2<- c_line + geom_freqpoly() + theme(axis.text.x=element_text(angle=90,hjust=0))

# plot the two graphs in rows to compare, see that right of SACRAMENTO we miss two lines in plot 2, while they are in plot 1 (and we want them)
myplot<-grid.arrange(cline1,cline2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:30:32.370

正如@joran 指出的那样，当使用“连续”值时，这给出了一个“相似”的图：

```
ggplot(data, aes(x=as.numeric(factor(city)), group=type, colour=type)) + 
                geom_freqpoly(binwidth=1) 
```

然而，这并不完全相同（比较图表的开头），因为中断被搞砸了。出于某种原因，它不是从 1 到 39 且 binwidth 为 1，而是从 0.5 开始，一直到 39.5。

![在此处输入图像描述](https://i.stack.imgur.com/J1Qt8.png)

# java - 如何清除 JTextArea？

> ID：15798532
> 
> 赞同：28
> 
> 时间：2013-04-03T21:32:10.560
> 
> 标签：java, swing, jtextarea, settext

我正在尝试清除 JTextArea。

目前，我正在使用

```
jtextarea.setText(null); 
```

如果我使用有什么区别

```
jtextarea.setText(""); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-03T21:38:08.367

没有区别。它们都有删除旧文本的效果。从 java [TextComponent](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/JTextComponent.html#setText%28java.lang.String%29)页面：

**设置文本**

```
 public void setText(String t)

  Sets the text of this TextComponent to the specified text. If the text is null
  or empty, has the effect of simply deleting the old text. When text has been
  inserted, the resulting caret location is determined by the implementation of
  the caret class.

  Note that text is not a bound property, so no PropertyChangeEvent is fired when
  it changes. To listen for changes to the text, use DocumentListener.

  Parameters:
      t - the new text to be set
  See Also:
      getText(int, int), DefaultCaret 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-23T06:17:17.240

作者试图清除 JTextArea，而不是添加空字符！

```
 JTextArea0.selectAll();
    JTextArea0.replaceSelection(""); 
```

这会选择整个 textArea，然后将其替换为空字符串，从而有效地清除 JTextArea。

不知道这里有什么误解，但我有同样的问题，这个答案为我解决了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-29T06:32:20.820

```
JTextArea0.selectAll();
JTextArea0.replaceSelection(""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-11T22:55:44.480

其实是有区别的，我想是的。

如果设置为null，则写入文本区的实际值将是空的。但是如果你将它设置为 "" 它将是一个空字符。就像你可以将它设置为“z”一样，会写成z，但null表示未知。在您需要使用 textArea 中编写的文本之前，您不会感觉到差异。

# prolog - 使变量为空集

> ID：15798533
> 
> 赞同：1
> 
> 时间：2013-04-03T21:32:11.817
> 
> 标签：prolog

我正在实施一些内置的 prolog 函数作为练习。但是，我在交集和差异方面遇到了麻烦，因为在我的基本递归情况下，我需要将返回值设置为空集。我不知道如何做到这一点，环顾四周我没有找到答案。

当我运行代码时，我得到以下信息：

```
1 ?- intersectionx([1,2,3],[3,4,5],Z).
Z = [3|_G3196] .

2 ?- differencex([1,2,3],[3,4,5],Z).
Z = [1, 2|_G3181] 
```

这是第 16 行和第 22 行的相关谓词的实际行。

```
/* memberx */
/* test is X a member of set Y, X subset Y */
memberx(X1,[X1|_]).
memberx(X2,[_|T2]) :- memberx(X2, T2).

/* unionx */
/* union sets X and Y and return the resulting set as Z. */
unionx([], Y3, Y3).             /* base case */
unionx([XH4|XT4], Y4, Z4) :- memberx(XH4, Y4), unionx(XT4, Y4, Z4).
unionx([XH5|XT5], Y5, [XH5|Z5]) :- not(memberx(XH5, Y5)), unionx(XT5, Y5, Z5).

/* intersectionx ???*/
/* Find the intersection of sets X and Y and return the result as set */
/* Z. X intersection Y = Z */
intersectionx([], Y6, Z6). /*In the base case here how do I set Z6 to []?*/
intersectionx([XH7|XT7], Y7, Z7) :- not(memberx(XH7, Y7)), intersectionx(XT7, Y7, Z7).
intersectionx([XH8|XT8], Y8, [XH8|Z8]) :- memberx(XH8, Y8), intersectionx(XT8, Y8, Z8).

/* differencex */
/* Find the difference of set X and Y and return the result as set Z. */
differencex([], Y9, Z9).
differencex([XH10|XT10], Y10, [XH10|Z10]) :- not(memberx(XH10, Y10)), differencex(XT10, Y10, Z10).
differencex([XH10|XT10], Y10, Z10) :- memberx(XH10, Y10), differencex(XT10, Y10, Z10). 
```

我知道这可能是一件相对简单的事情，但它让我困惑了一段时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:36:49.667

这很简单：

```
intersectionx([], _, []). 
```

我发现你的变量编号有点奇怪。你这样做是有原因的吗？您可以在不同的谓词中使用相同的变量名而不会遇到麻烦。

# asp.net - 触发器还是 T-SQL？

> ID：15798535
> 
> 赞同：0
> 
> 时间：2013-04-03T21:32:16.317
> 
> 标签：asp.net, sql, sql-server-2008, database-design, data-modeling

我正在尝试为我的网站制作通知系统：

这是表结构

```
notification
-----------------
id (pk)
userid
notification_type (for complexity like notifications for pictures, videos, apps etc.)
notification
time

notificationsRead
--------------------
id (pk) (i dont think this field is required, anyways)
lasttime_read
userid 
```

现在我的理解是，当添加通知时，我们需要找到用户朋友并将所有这些行插入`notification`表中，对吗？如果这是正确的，那么实现这一目标的最佳方法是什么？

1.  触发器？
2.  写T-SQL（服务器端的sql查询）选择所有朋友然后使用SQL批量复制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:15:26.507

一个好的关系方法是设置您的表，以便您有一个人员表。每个人都有一个唯一标识他们的主键。然后另一个表将 peoplekeys 链接在一起作为朋友。有几种方法可以解决这个问题，但作为一个粗略的例子：

```
People
---------------------------------------
PeopleKey | Name | <other profile data> 
```

然后你有一个表，将人们作为朋友相互关联。

```
Friendships
----------------------------------------------------------------------
PeopleKey |  FriendKey (fk to peoplekey) |  <details about friendship> 
```

然后你有你的通知表，上面写着一个人做了某事。

```
Notification
-----------------------------------------------------------
NotificationKey | PeopleKey | Date | <notification details> 
```

通过查询和您的友谊关系，您可以获得一个人所有朋友的所有通知：

```
select notification.* from notification inner join 
friendships on friendships.peoplekey = notification.peoplekey
where date = @importantdate 
```

这种关系可以揭示很多，而无需存储重复数据。还有 1000 种其他方法可以加入、查询或将表链接到友谊和事件。例如，您可以说显示 peoplekey 是我的朋友之一的所有事件。显示 peoplekey 只是我的一个朋友等的所有事件等等等等。

# powershell - 如何将函数转换为递归工作

> ID：15798536
> 
> 赞同：0
> 
> 时间：2013-04-03T21:32:20.253
> 
> 标签：powershell

我有这个很棒的 powershell 脚本，可以从文件名中删除特殊字符：

```
Function Rename-Files($path)
{
 Get-ChildItem -path $path | 
 Foreach-Object { 
      $newName = $_.name -replace '[^A-Za-z0-9-_ ]', ''
      if (-not ($_.name -eq $newname)){
        Rename-Item -Path $_.fullname -newname ($newName) 
      } 
 }
} #end function

Rename-Files -path "C:\somepath" 
```

我想知道是否有可能不仅在顶层目录上而且在**整个目录结构**中递归地工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:34:48.593

只需添加`-Recurse` `Get-ChildItem`参数。例如

```
Get-ChildItem -Recurse -path $path 
```

# ruby-on-rails - 为什么我在 AppFog 上的 rails 应用程序会出现 NoMethodError？

> ID：15798538
> 
> 赞同：0
> 
> 时间：2013-04-03T21:32:21.027
> 
> 标签：ruby-on-rails, mongodb, mongomapper, appfog

我在 AppFog 上有一个 rails 应用程序，连接到 mongo 数据库。这是一个非常简单的数据库，我使用 mongo_mapper gem 来创建 MVC 的东西，然后没有修改它。

```
rails g scaffold Contacts name:string address:string email:string phone:string -orm mongo_mapper 
```

真的很基本！只是试图测试 mongo 作为数据库。

[我按照此处](https://docs.appfog.com/services/mongodb#ruby)与数据库交谈的说明进行操作。

但是，每次我尝试访问该`/contacts`路径时，都会收到“500 内部服务器错误”消息。

我的应用报告的 AppFog 日志：

```
Started GET "/contacts" for 50.193.89.38 at 2013-04-03 21:18:58 +0000
Processing by ContactsController#index as HTML
Completed 500 Internal Server Error in 0ms

NoMethodError (undefined method `collection' for nil:NilClass):
  app/controllers/contacts_controller.rb:5:in `index' 
```

我的联系人控制器文件的第一块：

```
class ContactsController < ApplicationController
  # GET /contacts
  # GET /contacts.json
  def index
    @contacts = Contact.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @contacts }
    end
  end
.... 
```

任何帮助都会很棒。

**==更新==**

```
$ rails console
irb(main):001:0> Contact.all
=> [] 
```

并且使用`rails s`效果很好，我根本没有收到 500 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:20:32.533

模型的名称应该是单数，即`Contact`而不是`Contacts`。

`rails g scaffold Contact name:string address:string email:string phone:string -orm mongo_mapper`

您创建的方式使模型的名称成为`Contacts`而不是`Contact`。因此，当您尝试时，`Contact.all`您会得到`nil`.

# java - 检查两个密码是否相等

> ID：15798541
> 
> 赞同：0
> 
> 时间：2013-04-03T21:32:38.830
> 
> 标签：java

我在 JAVA 中有一个代码，它连接到数据库并获取数据库中每个用户的密码。

这是代码：

```
private void loginButtonActionPerformed(ActionEvent e) {

    String password = "";
        password=loginPasswordField.getText();
        String md5hashdatabase = "3f197eedfeaf826ad2af0bac49ded752";            
        try
        {
            MessageDigest md = MessageDigest.getInstance("MD5");
            md.update(password.getBytes());
            System.out.println(new BigInteger(1, md.digest()).toString(16));
            String md5hashes = new BigInteger(1, md.digest()).toString(16);
            String m = md5hashes;

            String myDriver = "org.gjt.mm.mysql.Driver";
            String myUrl = "jdbc:mysql://experimentalx.com/exper482_social";
            Class.forName(myDriver);
            Connection conn = DriverManager.getConnection(myUrl, "admin", "test");

            String query = "SELECT password FROM social_users";

            Statement st = conn.createStatement();

            ResultSet rs = st.executeQuery(query);

            while (rs.next())
            {
                String encryptedPassWord = rs.getString("password");
                System.out.format("%s\n", encryptedPassWord);

                if(m.equals(encryptedPassWord)) 
                {
                    System.out.println("Its exactly the same!");
                }
                else if(!m.equals(encryptedPassWord)) 
                {
                    System.out.println("Its not the same!");
                }
                else
                {
                    System.out.println("For some reason, this is just not wanting to work!");
                }           
          }
            st.close();
        }
        catch (Exception e1)
        {
            System.err.println("Got an exception! ");
            System.err.println(e1.getMessage());
        }   
    } 
```

它获取密码，然后检查字符串 md5hash 是否与从数据库接收到的 md5 哈希之一相同（encryptedPassWord）。当它这样做时，它只是说它们都不相同，即使来自数据库的第一个哈希与字符串 m(md5hashes) 相同。

我错过了什么吗？如果是这样，请您指导我正确的道路。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:02:58.793

我想出了解决方案：

我安全地对输入的密码进行哈希处理的方式是错误的，现在我已经修复了它。感谢大家的帮助。

我将加密更改为这样工作：

```
String value2=loginPasswordField.getText(); //The Password Field (I know getText() isnt secure)
MessageDigest md = MessageDigest.getInstance("MD5");
                md.update(value2.getBytes());
                String value3 = new BigInteger(1, md.digest()).toString(16);
                System.out.println("It should work: "+value3); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:34:25.803

尝试这个

```
if(m.trim().equals(encryptedPassWord.trim())) {
                System.out.println("Its exactly the same!");
            } else {
                System.out.println("Its not the same!");
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:36:28.507

```
private static boolean isPasswordCorrect(char[] input)
{
    boolean isCorrect = false;
    try
    {
        // This is where you encrypt your password
        byte[] einput = Encryption.encrypt(String.copyValueOf(input));
        // I'm not sure where you are loading your encrypted password
        isCorrect = new String(einput).equals(new String(passWordToCheckAgainst));
    } catch (Exception e)
    {
        e.printStackTrace();
    }
    return isCorrect;
}

char[] input = loginPasswordField.getPassword();
if (isPasswordCorrect(input))
{
    JOptionPane.showMessageDialog(controllingFrame, "Success! You typed the right password.");
} 
```

# jquery - 滚动时增加数值

> ID：15798545
> 
> 赞同：0
> 
> 时间：2013-04-03T21:33:07.773
> 
> 标签：jquery, animation, scroll, integer

因此，我在页面上看到，当我滚动浏览页码时，页码正在发生变化，事情正在四处移动，等等。基于页面的位置。Scrollorama 就是一个很好的例子。

虽然它有助于我想要/需要的其他一些功能，但我似乎无法找到解决方案。增加数值。

例如。我的网站上有一个百分比，我希望它说 45%，但是当我加载网站时，我希望它说 0% 并增加，直到它到达浏览器上的点，然后停在 45%。

任何插件，想法，或者只是知道如何实现这一点？

对不起，如果我含糊其辞。我希望我能找到我看到的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:51:51.870

您可以使用 window.scrollTo(X,Y) 函数在 javascript 中滚动到您喜欢的任何位置并制作动画，您可以在 javascript 中使用 setTimeout 或 setInterval 函数。我为您编写了一个函数：

```
scrollAnimating = function(x,y){
     var stepX = 10;
     var stepY = 10;

     var animFunc = function(x1,y1){
          var newX = x1+stepX;
          var newY = y1+stepY;

          if(newX>x)
             newX = x;

          if(newY>y)
             newY = y;

          if(newX == x && newY == y)
             return false;

          window.scrollTo(newX,newY);

          window.setTimeout(function(){animFunc(newX,newY);},100);
     }
     animFunc(x,y);
} 
```

你可以像这样使用它：scrollAnimating(0,100);

如果你想设置百分比值，它很简单，例如在 scrollY 如果你想滚动 45%：

```
scrollAnimating(0, 45*$(document.body).height()/100 ); 
```

# c++ - boost::shared_pointer 退出而不调用释放

> ID：15798549
> 
> 赞同：0
> 
> 时间：2013-04-03T21:33:26.617
> 
> 标签：c++, boost, shared-ptr

我正在使用一个程序，其中我的代码调用第三方库，该库使用 boost 和 shared_pointers 创建一个庞大而复杂的结构。这个结构是在我调用的方法中创建的，在方法结束时我知道程序已经完成。对于我正在处理处理代码的大型示例，处理处理需要 30 分钟，而在退出时自动调用的 boost 代码需要很多小时。退出程序而不释放内存并花费所有时间将是一个完全可以接受的结果。我试过 vector *iddListV = new vector(); // 这将泄漏内存并将所有相关结构添加到向量中，但这无济于事。我也尝试调用 exit(0); 在到达子程序结束之前。这也导致 boost 代码花费大量时间来尝试释放指针。如何在不调用 boost 析构函数的情况下让 C++ 程序（Windows 上的 Microsoft C++）突然退出。我的限制是我可以在分配 boost 结构之前调用任何函数，但一旦开始运行就不能修改代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:35:47.990

`_Exit`退出而不调用任何析构函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:58:08.973

如果您不关心可移植性，可以调用[`TerminateProcess()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714%28v=vs.85%29.aspx). 但请记住，您**绝对**确定您的程序处于准备终止的状态。例如，如果您在 I/O 有机会刷新之前终止，那么您的文件数据和网络流可能会变得无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T01:32:20.577

可以以便携的方式执行以下操作：

```
#include <exception>
...
std::terminate(); 
```

但是，有一个很大的问题，至少在 linux 上，这可能会导致核心转储。（我真的不确定 Windows 上的行为是什么）。

应该注意的是，行为是根据是否调用析构函数来定义的实现。选址§15.5.1 P2：

> 在搜索处理程序 (15.3) 遇到具有不允许异常 (15.4) 的 noexcept 规范的函数的最外层块的情况下，堆栈是否展开、部分展开或不展开由实现定义在调用 std::terminate() 之前完全展开。

另外在 §18.8.3.4 P1 中：

> 备注：当由于多种原因（15.5.1）中的任何一个必须放弃异常处理时由实现调用，在评估 throw-expression 后立即生效（18.8.3.1）。也可以由程序直接调用。

C++11 还定义了`std::quick_exit(int status)`可以以类似方式使用的函数（大概没有核心转储）。此功能可从`<cstdlib>`.

# iphone - webview 链接点击

> ID：15798550
> 
> 赞同：0
> 
> 时间：2013-04-03T21:33:38.277
> 
> 标签：iphone, objective-c, if-statement, uiwebview, webview

我有一个 webview 加载一个带有 html 表单的网站。当用户输入他们的登录凭据并按下提交按钮时，用户将被发送到一个新的视图控制器。如果用户输入了错误的凭据，我想阻止这种情况发生。如果输入了错误的凭据，则网站地址保持不变。我可以以某种方式说：

```
if (navigationType == UIWebViewNavgiationTypeLinkClicked) {

if (url remains the same == alert view saying wrong credentials was entered.  

if (url changes - perform segue to new view controller? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:26:16.350

让你的控制器实现`UIWebViewDelegate`. 当您这样做时，将在 Web 请求的不同阶段调用一堆回调。您可能想要实现的是这个：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {
    // Be sure to use mainDocumentURL, because any iframes on your form page will
    // also trigger this callback
    NSString *completedurl = webView.request mainDocumentURL.absoluteString;        
    // Let's assume you have your form url in the string property self.formurl
    if ([completedurl isEqualToString:self.formurl]) {
        // Display your alert view saying that the credentials were incorrect
    } else {
        // Perform segue to next controller
    } 
```

整个解决方案**有点吓人**，因为任何其他错误页面或任何会欺骗您的应用程序相信用户已成功登录的东西。更好的方法可能是检查 webview 的 html 内容以获取成功登录页面包含的一些重要字符串。您可以通过调用获取 html 正文：

```
NSString *yourHTMLSourceCodeString = [webView stringByEvaluatingJavaScriptFromString:@"document.body.innerHTML"]; 
```

另一种方法是在确认登录的 web 视图中查找 cookie。

**或者更好的是，使用原生登录表单，使用原生代码提交登录请求，使用 AFNetworking 或标准 http SDK 方法，并检查响应是否成功。**

# php - 如果它为空，则在 PHP 中返回一些内容

> ID：15798551
> 
> 赞同：1
> 
> 时间：2013-04-03T21:33:42.373
> 
> 标签：php, is-empty

我有一个代码，它正在获取数据，但是当它什么也没得到时，我希望它返回一些东西。

```
 $upcoming = simplexml_load_file('http://api.website.com'); 

foreach($upcoming->trailer as $x => $updates) {         
$content.= '<center><br><span> ' . $updates->embed . '</span></center>';
} 
```

这是代码。它正在获取数据，但当它一无所获时，我希望它说 NO 视频。

我怎样才能做到这一点？我尝试了 strlen() 但我无法应用它。

我尝试了 strpos 但它也没有工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:38:50.147

您可以简单地检查 simplexml_load_file 的结果并采取相应措施

```
if (false === $upcoming) {
    echo "No Videos";
} else {
    //your foreach loop here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:41:21.180

在你的 foreach 中添加一些标志来放置一个标志，如果有任何东西已经打印出来，或者只是检查 $upcoming。然后只需检查标志并回显“无视频”您的消息。

像这样做：

```
$Something=false;
$upcoming = simplexml_load_file('http://api.website.com'); 

foreach($upcoming->trailer as $x => $updates) {
  if($updates->embed){
    $Something=true;
  }         
  $content.= '<center><br><span> ' . $updates->embed . '</span></center>';
}

if(!$Something){
  echo "<center>No videos</center>";
} 
```

或者：

```
$upcoming = simplexml_load_file('http://api.website.com');

if(!$upcoming){
  echo "<center>No videos</center>";
}
else{
  foreach($upcoming->trailer as $x => $updates) {
    if($updates->embed){
      $Soemthing=true;
    }         
    $content.= '<center><br><span> ' . $updates->embed . '</span></center>';
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:43:28.730

```
$upcoming = simplexml_load_file('http://api.website.com'); 
if($upcoming == null || $upcoming == false){
    $content = "No videos";
}
else{
    foreach($upcoming->trailer as $x => $updates) {         
    $content.= '<center><br><span> ' . $updates->embed . '</span></center>';
    }
} 
```

# c# - 如何在不借助代码隐藏的情况下在用户控件上实现命令？

> ID：15798553
> 
> 赞同：0
> 
> 时间：2013-04-03T21:33:54.747
> 
> 标签：c#, wpf, mvvm, user-controls, icommand

我只是设法让我的 WPF 自定义消息窗口按我的预期工作......几乎：

```
 MessageWindow window;

    public void MessageBox()
    {
        var messageViewModel = new MessageViewModel("Message Title",
            "This message is showing up because of WPF databinding with ViewModel. Yay!",
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec fermentum elit non dui sollicitudin convallis. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Integer sed elit magna, non dignissim est. Morbi sed risus id mi pretium facilisis nec non purus. Cras mattis leo sapien. Mauris at erat sapien, vitae commodo turpis. Nam et dui quis mauris mattis volutpat. Donec risus purus, aliquam ut venenatis id, varius vel mauris.");
        var viewModel = new MessageWindowViewModel(messageViewModel, BottomPanelButtons.YesNoCancel);
        window = new MessageWindow(viewModel);
        viewModel.MessageWindowClosing += viewModel_MessageWindowClosing;
        window.ShowDialog();

        var result = viewModel.DialogResult;
        System.Windows.MessageBox.Show(string.Format("result is {0}", result));
    }

    void viewModel_MessageWindowClosing(object sender, EventArgs e)
    {
        window.Close();
    } 
```

在底层，有一个“BottomPanel”用户控件，它仅创建一组按钮，其“Visibility”属性由 MessageWindowViewModel 控制（通过诸如“IsOkButtonVisible”之类的属性获取器，它本身由传递的“BottomPanelButtons”枚举的值决定到视图模型的构造函数）。

虽然这满足了我能够在底部显示带有可折叠详细信息和一组可配置按钮的消息窗口的要求，但我对必须将我最初想要的所有功能放入 BottomPanel 控件（或者更确切地说，进入其视图模型），进入 MessageWindowViewModel 类：

```
 public MessageWindowViewModel(MessageViewModel messageViewModel, BottomPanelButtons buttons)
    {
        _messageViewModel = messageViewModel;
        _abortCommand = new DelegateCommand(ExecuteAbortCommand, CanExecuteAbortCommand);
        _applyCommand = new DelegateCommand(ExecuteApplyCommand, CanExecuteApplyCommand);
        _cancelCommand = new DelegateCommand(ExecuteCancelCommand, CanExecuteCancelCommand);
        _closeCommand = new DelegateCommand(ExecuteCloseCommand, CanExecuteCloseCommand);
        _ignoreCommand = new DelegateCommand(ExecuteIgnoreCommand, CanExecuteIgnoreCommand);
        _noCommand = new DelegateCommand(ExecuteNoCommand, CanExecuteNoCommand);
        _okCommand = new DelegateCommand(ExecuteOkCommand, CanExecuteOkCommand);
        _retryCommand = new DelegateCommand(ExecuteRetryCommand, CanExecuteRetryCommand);
        _yesCommand = new DelegateCommand(ExecuteYesCommand, CanExecuteYesCommand);
        Buttons = buttons;
    }

    /// <summary>
    /// Gets/sets a value that determines what buttons appear in the bottom panel.
    /// </summary>
    public BottomPanelButtons Buttons { get; set; }

    public bool IsCloseButtonVisible { get { return Buttons == BottomPanelButtons.ApplyClose || Buttons == BottomPanelButtons.Close; } }
    public bool IsOkButtonVisible { get { return Buttons == BottomPanelButtons.Ok || Buttons == BottomPanelButtons.OkCancel; } }
    public bool IsCancelButtonVisible { get { return Buttons == BottomPanelButtons.OkCancel || Buttons == BottomPanelButtons.RetryCancel || Buttons == BottomPanelButtons.YesNoCancel; } }
    public bool IsYesButtonVisible { get { return Buttons == BottomPanelButtons.YesNo || Buttons == BottomPanelButtons.YesNoCancel; } }
    public bool IsNoButtonVisible { get { return IsYesButtonVisible; } }
    public bool IsApplyButtonVisible { get { return Buttons == BottomPanelButtons.ApplyClose; } }
    public bool IsAbortButtonVisible { get { return Buttons == BottomPanelButtons.AbortRetryIgnore; } }
    public bool IsRetryButtonVisible { get { return Buttons == BottomPanelButtons.AbortRetryIgnore || Buttons == BottomPanelButtons.RetryCancel; } }
    public bool IsIgnoreButtonVisible { get { return Buttons == BottomPanelButtons.AbortRetryIgnore; } }

    public ICommand AbortCommand { get { return _abortCommand; } }
    public ICommand ApplyCommand { get { return _applyCommand; } }
    public ICommand CancelCommand { get { return _cancelCommand; } }
    public ICommand CloseCommand { get { return _closeCommand; } }
    public ICommand IgnoreCommand { get { return _ignoreCommand; } }
    public ICommand NoCommand { get { return _noCommand; } }
    public ICommand OkCommand { get { return _okCommand; } }
    public ICommand RetryCommand { get { return _retryCommand; } }
    public ICommand YesCommand { get { return _yesCommand; } }

    public string AbortButtonText { get { return resx.AbortButtonText; } }
    public string ApplyButtonText { get { return resx.ApplyButtonText; } }
    public string CancelButtonText { get { return resx.CancelButtonText; } }
    public string CloseButtonText { get { return resx.CloseButtonText; } }
    public string IgnoreButtonText { get { return resx.IgnoreButtonText; } }
    public string NoButtonText { get { return resx.NoButtonText; } }
    public string OkButtonText { get { return resx.OkButtonText; } }
    public string RetryButtonText { get { return resx.RetryButtonText; } }
    public string YesButtonText { get { return resx.YesButtonText; } }

    private ICommand _abortCommand; 
    private ICommand _applyCommand; 
    private ICommand _cancelCommand; 
    private ICommand _closeCommand; 
    private ICommand _ignoreCommand; 
    private ICommand _noCommand; 
    private ICommand _okCommand; 
    private ICommand _retryCommand; 
    private ICommand _yesCommand; 
```

下面还有更多代码——实际`Execute`和`CanExecute`处理程序，它们都做同样的事情：设置`DialogResult`属性并引发`MessageWindowClosing`事件：

```
 private void ExecuteCloseCommand(object commandArgs)
    {
        DialogResult = DialogResult.Close;
        if (MessageWindowClosing != null) MessageWindowClosing(this, EventArgs.Empty);
    }

    private bool CanExecuteCloseCommand(object commandArgs)
    {
        return true;
    } 
```

现在这有效，但我发现它很难看。我的意思是，我想要的是一个拥有所有 BottomPanel 功能的 BottomPanelViewModel 类。我对此唯一喜欢的是，我没有代码隐藏（除了在 MessageView 类中采用 MessageViewModel 的构造函数，设置 DataContext 属性）。

所以问题是这样的：是否可以重构这段代码，以便我最终得到一个可重用的 BottomPanel 控件，将其功能嵌入到自己的视图模型中并拥有自己的命令？这个想法是让BottomPanel控件上的命令和包含窗口的ViewModel中的处理程序......或者这是否太过分了？

我已经尝试了很多东西（依赖属性，静态命令，......），但我现在拥有的是我可以设法让它在没有代码隐藏的情况下工作的唯一方法。我确信有更好、更专注的做事方式——请原谅我的 WPF 新手，这个“消息框”窗口是我的 WPF“Hello World！”。有史以来第一个项目...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:41:11.120

根据我个人的经验，我有几点建议。

首先，您可以为任何应该由`ViewModel`.

`ViewModel`其次，我发现最好指定 的“模式”并在视图层中`ViewModel`使用 a`ValueConverter`或 a来指定在该模式下显示的内容，而不是在 中使用 *ButtonVisibility 。`Trigger`这使得您的 ViewModel 不会意外地（通过错误）进入一个无效的状态，通过提供类似的场景

```
IsYesButtonVisible = true;
IsAbortButtonVisible = true; 
```

我了解您的属性没有设置器，但维护代码的人可以轻松添加它们，这只是一个简单的示例。

对于您的情况，我们真的只需要第一个。

只需创建一个您想使用的界面。您可以根据自己的喜好重命名这些，但这里是他的一个示例。

```
public interface IDialogService
{
    public void Inform(string message);
    public bool AskYesNoQuestion(string question, string title);
} 
```

然后在您的视图层中，您可以创建一个在您的应用程序中相同的实现

```
public class DialogService
{
    public void Inform(string message)
    {
        MessageBox.Show(message);
    }

    public bool AskYesNoQuestion(string question)
    {
        return MessageBox.Show(question, title, MessageBoxButton.YesNo) ==         
                   MessageBoxResult.Yes
    }
} 
```

然后你可以`ViewModel`像这样使用

```
public class FooViewModel
{
    public FooViewModel(IDialogService dialogService)
    {
        DialogService = dialogService;
    }

    public IDialogService DialogService { get; set; }

    public DelegateCommand DeleteBarCommand
    {
        get
        {
            return new DelegateCommand(DeleteBar);
        }
    }

    public void DeleteBar()
    {
        var shouldDelete = DialogService.AskYesNoQuestion("Are you sure you want to delete bar?", "Delete Bar");
        if (shouldDelete)
        {
            Bar.Delete();
        }
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T02:09:25.870

`RoutedCommand`正如@JerKimball 所建议的那样，我最终使用了 。在我的搜索中，我看到了许多实现这一点的方法，可能都是正确的，但没有一个让我满意。

我正在发布对我有用的社区 wiki：

该`BottomPanel`控件确实以 - 最小 - 代码隐藏结束，因为没有办法将 绑定`CommandBindings`到 ViewModel （因为命令不是`DependencyProperty`）。`Execute`因此，代码隐藏只是调用实际实现和`CanExecute`方法所在的“宿主”视图模型：

```
public partial class BottomPanel : UserControl
{
    public BottomPanel()
    {
        InitializeComponent();
    }

    private void ExecuteOkCommand(object sender, ExecutedRoutedEventArgs e)
    {
        if (DataContext == null) return;
        var viewModel = ((BottomPanelViewModel)DataContext).Host;
        if (viewModel != null) viewModel.ExecuteOkCommand(sender, e);
    }

    private void CanExecuteOkCommand(object sender, CanExecuteRoutedEventArgs e)
    {
        if (DataContext == null) return;
        var viewModel = ((BottomPanelViewModel)DataContext).Host;
        if (viewModel != null) viewModel.CanExecuteOkCommand(sender, e);
    }
    ...
} 
```

为了避免将控件与特定的 ViewModel 紧密耦合，我创建了一个接口：

```
public interface IHasBottomPanel
{
    event EventHandler WindowClosing;
    DialogResult DialogResult { get; set; }
    BottomPanelViewModel BottomPanelViewModel { get; set; }

    void ExecuteOkCommand(object sender, ExecutedRoutedEventArgs e);
    ...

    void CanExecuteOkCommand(object sender, CanExecuteRoutedEventArgs e);
    ...
} 
```

可能值得注意的是，`DialogResult`我使用的是我自己对它的解释（更接近 WinForms 所提供的），因为简单的`bool`只是不能满足需求 - 当用户“X”时返回“未定义”值的窗外：

```
public enum DialogResult
{
    Undefined,
    Abort,
    Apply,
    Cancel,
    Close,
    Ignore,
    No,
    Ok,
    Retry,
    Yes
} 
```

所以，回到`BottomPanel`控件，在 XAML 中我可以定义命令绑定，如下所示：

```
<UserControl.CommandBindings>
    <CommandBinding Command="{x:Static local:BottomPanelViewModel.OkCommand}"
                    Executed="ExecuteOkCommand"
                    CanExecute="CanExecuteOkCommand"/>
    ... 
```

这是有效的，因为`BottomPanelViewModel`该类定义了静态命令——我也可以在其他地方定义它们，但它们似乎在那里有宾至如归的感觉：

```
 public static RoutedCommand OkCommand = new RoutedCommand();
    ... 
```

此 ViewModel 还包含`Host`由代码隐藏引用的属性，它间接公开将处理命令的 ViewModel：

```
 /// <summary>
    /// Gets the host view model.
    /// </summary>
    public IHasBottomPanel Host { get; private set; }

    /// Gets a value that determines what buttons appear in the bottom panel.
    /// </summary>
    public BottomPanelButtons Buttons { get; private set; }

    /// <summary>
    /// Creates a new ViewModel for a <see cref="BottomPanel"/> control.
    /// </summary>
    /// <param name="buttons">An enum that determines which buttons are shown.</param>
    /// <param name="host">An interface representing the ViewModel that will handle the commands.</param>
    public BottomPanelViewModel(BottomPanelButtons buttons, IHasBottomPanel host)
    {
        Buttons = buttons;
        Host = host;
    } 
```

在这一点上，一切都已准备就绪，可以正常工作了；我在`MessageWindow`View 上使用了这个 BottomPanel 控件，因此`MessageWindowViewModel`该类实现了`IHasBottomPanel`接口（`ViewModelBase`该类仅提供了一种类型安全的处理方式`INotifyPropertyChanged`）：

```
public class MessageWindowViewModel : ViewModelBase, IHasBottomPanel
{
    /// <summary>
    /// Gets/sets ViewModel for the message window's content.
    /// </summary>
    public MessageViewModel ContentViewModel { get { return _messageViewModel; } }
    private MessageViewModel _messageViewModel;

    public MessageWindowViewModel()
        : this(new MessageViewModel())
    { }

    public MessageWindowViewModel(MessageViewModel viewModel)
        : this(viewModel, BottomPanelButtons.Ok)
    { }

    public MessageWindowViewModel(MessageViewModel messageViewModel, BottomPanelButtons buttons)
    {
        _messageViewModel = messageViewModel;
        // "this" is passed as the BottomPanelViewModel's IHasBottomPanel parameter:
        _bottomPanelViewModel = new BottomPanelViewModel(buttons, this);
    }

    ...

    public void ExecuteOkCommand(object sender, ExecutedRoutedEventArgs e)
    {
        DialogResult = DialogResult.Ok;
        if (WindowClosing != null) WindowClosing(this, EventArgs.Empty);
    }

    public void CanExecuteOkCommand(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = _messageViewModel.ShowProgressControls
            ? _messageViewModel.ProgressValue == _messageViewModel.MaxProgressValue
            : true;
    } 
```

所以我得到了我想要的：“主机”视图模型控件`Execute`和`CanExecute`所有命令的实现`BottomPanel`，并且可以在另一个“主机”上以不同的方式实现。这里有一种配置 ViewModel 的方法，以便 View 显示 ProgressBar 控件，在这种情况下，只有当 ProgressBar 的值达到最大值时才会启用“确定”按钮（同时启用“取消”按钮，然后禁用当启用“确定”时）。

然后我可以实现自己的`MsgBox`静态类，并为显示给用户的各种消息公开各种按钮和图标配置：

```
public static class MsgBox
{
    private static DialogResult MessageBox(MessageViewModel messageViewModel, BottomPanelButtons buttons)
    {
        var viewModel = new MessageWindowViewModel(messageViewModel, buttons);
        var window = new MessageWindow(viewModel);
        window.ShowDialog();
        return viewModel.DialogResult;
    }

    /// <summary>
    /// Displays an informative message to the user.
    /// </summary>
    /// <param name="title">The message's title.</param>
    /// <param name="message">The message's body.</param>
    /// <returns>Returns <see cref="DialogResult.Ok"/> if user closes the window by clicking the Ok button.</returns>
    public static DialogResult Info(string title, string message)
    {
        return Info(title, message, string.Empty);
    }

    /// <summary>
    /// Displays an informative message to the user.
    /// </summary>
    /// <param name="title">The message's title.</param>
    /// <param name="message">The message's body.</param>
    /// <param name="details">The collapsible message's details.</param>
    /// <returns>Returns <see cref="DialogResult.Ok"/> if user closes the window by clicking the Ok button.</returns>
    public static DialogResult Info(string title, string message, string details)
    {
        var viewModel = new MessageViewModel(title, message, details, MessageIcons.Info);
        return MessageBox(viewModel, BottomPanelButtons.Ok);
    }

    /// <summary>
    /// Displays an error message to the user, with stack trace as message details.
    /// </summary>
    /// <param name="title">The message's title.</param>
    /// <param name="exception">The exception to report.</param>
    /// <returns>Returns <see cref="DialogResult.Ok"/> if user closes the window by clicking the Ok button.</returns>
    public static DialogResult Error(string title, Exception exception)
    {
        var viewModel = new MessageViewModel(title, exception.Message, exception.StackTrace, MessageIcons.Error);
        return MessageBox(viewModel, BottomPanelButtons.Ok);
    }
    ...
} 
```

这就是@NickFreeman 关于这个问题可能更适合 CodeReview 的评论成为无可争辩的事实的地方：我真的很想了解社区对这个实现的看法；也许我落入了一些以后会咬我的陷阱，或者我违反了我不知道的原则或模式。

这个问题求迁移！

# actionscript-3 - 如何从当前帧播放动画，ActionScript 3.0

> ID：15798554
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:33:55.913
> 
> 标签：actionscript-3, flash, animation, button

我正在尝试为我的 Flash 动画制作个性化的暂停按钮。

这是我到目前为止的代码

```
var paused:Boolean = false;

pause.addEventListener(MouseEvent.CLICK, fl_PauseUnpause);

function fl_PauseUnpause(event:MouseEvent):void
{

  if(paused=true)
  {
    stop();
    paused=false;
  }

  else
  {
    gotoAndPlay(this.currentFrame);
    paused=true;
  }
} 
```

停止动画效果很好，但之后不会重新开始。运行时不会出错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:46:09.733

```
if(paused=true) // this assigns true to paused and if always evaluates to true 
```

那必须是：

```
if(paused==true) //or if(paused) 
```

不？

# database-design - 如何在不丢失单位意义的情况下存储长度、内存、重量等数据并能够比较两个值？

> ID：15798555
> 
> 赞同：0
> 
> 时间：2013-04-03T21:33:59.277
> 
> 标签：database-design, schema, data-warehouse

假设我必须填充诸如内存大小之类的数据库字段，其中应该保存一个带有单位的数值。如果这是我需要在项目中的一个特定位置单独处理的唯一字段，那么对验证用户输入的数据所需的逻辑进行硬编码是可能的。但事实并非如此，即使考虑在源代码中嵌入 1 MB = 1000 KB 之类的信息，这听起来也很不切实际和愚蠢。我需要在产品中保留此类信息，以便能够比较两个不同实体的内存大小字段。

问题：**在系统中使用单元存储标量数据的理想方法是什么，以便该单元不会将单元降级为意义较少的字符串？并且可以用于比较操作吗？**

编辑：数据来自我无法控制的来源，例如第三方导出的电子表格或从网页上刮下来的数据等。单位可能有任何东西。希望它能把问题弄清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T23:02:13.263

在这种情况下，我会将输入标准化为一致的单位。因此，在您的示例中，您将标准化为字节，或者可能是兆字节。

如果您有两列并存储了数值和单位，那么数据库将更难查询。例如，查询“谁拥有超过 10 gigs 的存储空间”将涉及内联计算来处理所有可能的单位。与以标准单位表示的列相比，这将证明难以索引。

如果用户输入以千兆字节为单位的数字，您可能不希望将它们显示为大量字节。这是一个用户界面问题——你会写一些东西来以最有用的单位显示字节数。

如果您严格需要使用与输入相同的单位来显示值，则在字节数旁边添加一个“displayUnits”列。在用户界面中使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T10:27:11.987

我在这里为类似的东西写了一个答案[自定义单位转换](https://stackoverflow.com/questions/4495813/sql-custom-unit-conversion/4497760#4497760)

基本上，您希望将“度量单位”与您的度量一起存储。例如，您可以在 value 列中设置值“100”，在 unit_of_measure 列中设置“KB”。如果您需要将其与具有“100”和“MB”的另一行进行比较，您需要先将它们转换为通用度量。这可以通过我在另一个答案中显示的转换表来完成。

如果可能的话，您应该在将数据插入表中之前努力对度量进行规范化。从大多数角度来看，这更好。如果做不到这一点，我认为使用转换表是可行的方法。

# ios - 看看是否没有进行任何接触？

> ID：15798556
> 
> 赞同：0
> 
> 时间：2013-04-03T21:34:00.883
> 
> 标签：ios, objective-c

我知道可以使用 iOS 检测触摸

```
UITouch *touch = [[event allTouches] anyObject]; 
```

但是，是否有可能找出用户何时不触摸？

**编辑**

我希望在用户 5 秒内不触摸屏幕时执行一个方法。这可能吗？

我没有任何对触摸做出反应的自定义方法。我只有现有的方法

```
-touchesBegan
-touchesMoved and
-touchesEnded 
```

更具体地说，用户可以根据需要多次触摸屏幕，持续多久。但是，当用户超过 5 秒没有触摸屏幕时，就`-sampleMethod`需要触发一个方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:55:44.097

您可以以 5 秒的间隔启动计时器，每次触摸时，重新启动计时器：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [self.timer invalidate];
    self.timer = [NSTimer scheduledTimerWithTimeInterval:5.0 target:self selector:@selector(yourMethod) userInfo:nil repeats:NO];
}

- (void)yourMethod {
    NSLog(@"not touched for 5 seconds");
} 
```

根据您的特定需求，您可能希望使用它`touchesEnded:withEvent`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:55:18.930

我要在这里回答一个问题。因为在评论中你澄清了你想要做什么。5秒后没有反应。我在这里展示的内容通常用于我所有的应用程序都是 opengl 应用程序。但是，即使您不在 open gl 中，它也应该对您有用。

你需要一些持续运行的东西......

```
 - (void) startAnimation
{
    if (!animating)
    {
        displayLink = [NSClassFromString(@"CADisplayLink") displayLinkWithTarget:self selector:@selector(drawView)];
        [displayLink setFrameInterval:animationFrameInterval];
        [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];

        animating = TRUE;
    }
}

- (void)stopAnimation
{
    if (animating)
    {
        [displayLink invalidate];
        displayLink = nil;

        animating = FALSE;
    }
} 
```

我们在 oepngl 应用程序中使用它来每隔 60 秒运行一次 drawview 函数，同时刷新显示。我不明白你为什么不能这样做。然后在您的 drawView 方法中检查开始时的时间并处理您需要的任何其他废话，例如在游戏中推进棋子或只是检查消息持续了多长时间..

```
- (void)drawView
{
timeThisRound = CFAbsoluteTimeGetCurrent(); 
```

并针对触发 5 秒开始的任何事件进行检查。如果你已经过了 5 秒，那么就做你想做的任何事情，而不是再等待他们点击按钮。

我有自己的消息系统可以做到这一点。我可以设置任何出现的消息，如果它应该在 5 秒后自行消失。或者，如果他们轻按它，它就会消失得更快。我在任何地方都使用 timeThisRound 方法（一个全局属性）来跟踪 NOW 的时间，这样我就可以拥有基于时间的东西以及基于触摸的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:36:45.617

当然，其余时间。你什么意思？唯一的方法是将布尔标志设置为false，并在您的“touched”方法中将其设置为true。然后任何时候它是假的，没有触摸......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T22:01:01.043

在一定延迟后启动一个方法，当用户停止触摸视图时启动。

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    [self performSelector:@selector(sampleMethod) withObject:nil afterDelay:5.0f];
} 
```

如果用户再次触摸视图，您应该取消挂起的方法调用

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(sampleMethod) object:nil];
} 
```

记得在 dealloc 中取消挂起的方法调用

```
- (void)dealloc {
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(sampleMethod) object:nil];
} 
```

# excel - VB 如果单元格在 Excel 范围内

> ID：15798561
> 
> 赞同：0
> 
> 时间：2013-04-03T21:34:09.793
> 
> 标签：excel, vba

如果单元格在给定范围内，我在 Excel 中制作了一个 VB makro 来执行某些操作，但是当我执行它时，它给了我一个错误，我不明白为什么。

```
Private Sub Worksheet_Change(ByVal Target As Range)
Dim isect As Boolean
isect = Application.Intersect(Selection, Range("D11:D35"))
If isect Then
    If ActiveCell.Offset(-1, 0) - ActiveCell.Offset(-1, 1) > 2.5 Then
        Range("A1:A1").Value = "ok"
    End If
End If
End Sub 
```

错误是：

```
Object variable or With block variable not set. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:42:24.237

将前 3 行更改为：

```
Dim isect As Range
Set isect = Application.Intersect(Selection, Range("D11:D35"))
If Not isect Is Nothing Then 
```

但还要检查@Siddharth 关于循环的评论，这在这里非常重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:06:10.173

另一种不使用`Boolean Variable`/的方法`Selection`（也包含蒂姆的建议）......

```
Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo Whoa

    Application.EnableEvents = False

    If Target.Cells.CountLarge > 1 Then
        MsgBox "More than 1 cell ws changed"
    Else
        If Not Intersect(Target, Range("D11:D35")) Is Nothing Then
            If Target.Offset(-1, 0).Value - Target.Offset(-1, 1).Value > 2.5 Then
                Range("A1").Value = "ok"
            End If
        End If
    End If

Letscontinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume Letscontinue
End Sub 
```

注意：为什么`.CountLarge`？看到[这个](https://stackoverflow.com/questions/14771829/detecting-sheet-change-clearing-the-sheet-giving-an-overflow)

# svg - D3 线路径交点

> ID：15798566
> 
> 赞同：1
> 
> 时间：2013-04-03T21:34:27.607
> 
> 标签：svg, d3.js

我正在使用 D3，但遇到了一些问题。基本上，我有一个小面积图，其域根据画笔而变化（类似于此示例：[http](http://bl.ocks.org/mbostock/1667367) ://bl.ocks.org/mbostock/1667367 ）。我创建了一条可以拖动的线，我希望做的是提供一个工具提示，该线与面积图相交。我创建了一个函数，它根据线的 x 值将图表中的数据一分为二并返回最近的数据点......问题是这并不总是与参考线对齐，特别是如果笔刷已经设置得非常小，所以在面积图中只有几个点被插值。这是我正在谈论的图像。 ![线交叉问题](https://i1359.photobucket.com/albums/q791/andyopayne/Line_Intersection_01_zps28970d52.jpg)

所以，我的问题是有可能以某种方式创建一个路径线相交函数，该函数将确定两条路径相遇的确切位置并返回一个可用于工具提示的值？我目前正在使用的功能如下……但就像我说的，当画笔设置为小区域时，这似乎效果不佳。

```
function ref_move(d) {
     var x0 = x.invert(d.x -35),
        i = bisectDate(data, x0, 1),
        d0 = data[i - 1],
        d1 = data[i],
        d = x0 - d0.date > d1.date - x0 ? d1 : d0;

        ref_tooltip.attr("transform", "translate(" + (x(d.date) + margin.left) + "," +   (y(d.Light) + light_offset) + ")");
  } 
```

我已经对这个问题进行了一些研究，但还没有想出太多的解决方案。有一个由 Kevin Lindsey 编写的库，它进行某种交叉测试（[http://www.kevlindev.com/geometry/2D/intersections/index.htm](http://www.kevlindev.com/geometry/2D/intersections/index.htm)）......但它是在大约 9 年前编写的......并且不确定它是否仍然是最新的。此外，还有一个示例，您可以在路径上找到一个点（[http://bl.ocks.org/mbostock/1705868](http://bl.ocks.org/mbostock/1705868)）但是，我想知道如何找到靠近路径的点参考线？有没有人对如何解决这个问题有任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:21:17.713

感谢您的链接。有趣的是获得其他方法来解决它。事实证明，我想通了......基本上使用了一些插值。你看我知道 d0 和 d1 是参考线两侧的点，它们对应于我从 CSV 文件中知道的数据之间。所以，基本上我只需要找出这两个点之间的参考线​​的位置来计算一个加权百分比......然后将两个权重乘以两个已知点的 y 值，然后你就得到了。我的新功能如下所示：

```
function ref_move(d) {
     var x0 = x.invert(d.x -35),
        i = bisectDate(data, x0, 1),
        d0 = data[i - 1],
        d1 = data[i],
        span = (x(d1.date) - x(d0.date)),
        weight = (x(x0) - x(d0.date))/span,
        newy = (d1.Light * weight) + (d0.Light * (1.0-weight));

        ref_tooltip.attr("transform", "translate(" + (x(x0) + margin.left) + "," + (y(newy) + light_offset) + ")");
 } 
```

这似乎解决了我的问题。谢谢您的帮助。我很好奇是否有其他方法可以解决它。再次感谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-17T09:34:43.500

对于 KenlinDel 库，我设法使用 D3 找到两条路径的交点，但其他形状存在问题，我正在做的实际解决方案是

```
chordshapes = Array()
svg.selectAll("g.Chords")
     .data(data)
     ..attr("d", function (d,i) {
                                 var shape = new Path() // from D2.js
                                 //get the path
                                 var pathStr = chrod(innerRadius, d.source, d.target)
                                 //Initialize a new path object
                                 shape.parseData(pathStr) 
                                 chordshapes[i] = shape;
                                 return pathStr;
                             }) 
```

所以这里 chordShapes 包含每个路径的 Path 对象，然后当我点击例如画笔时，我可以为画笔矩形创建另一个形状并检查交点如下

```
........
var intersect Intersection.intersectShapes(chordshapes[i], brushShape)
if(intersect.points.length >0) {
 ..........
} 
```

# ruby-on-rails - 恢复活动记录模式中的主键

> ID：15798571
> 
> 赞同：0
> 
> 时间：2013-04-03T21:34:48.393
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

不知何故，我的架构以这个 id 列结束：

```
create_table "tables", :id => false, :force => true do |t|
    t.integer  "id",                                         :null => false
    # other fieds
  end 
```

这是列上的信息（注意主要是假的）：

```
[4] pry(main)> Table.columns.first
=> #<ActiveRecord::ConnectionAdapters::PostgreSQLColumn:0x007f98d06cc0f8
 @coder=nil,
 @default=nil,
 @limit=nil,
 @name="id",
 @null=false,
 @precision=nil,
 @primary=false,
 @scale=nil,
 @sql_type="integer",
 @type=:integer> 
```

因此，每当我尝试保存新记录时，都会出现此错误： `ActiveRecord::StatementInvalid: PG::Error: ERROR: null value in column "id" violates not-null constraint`

恢复主键的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:43:41.780

Rails 迁移无法原生处理这个问题 - 您需要使用`execute`设置主键的 SQL，创建缺失的序列，将序列移动到最新的 'id' 值（如果存在），并分配序列nextval 作为默认值：

```
execute("ALTER TABLE tables ADD PRIMARY KEY (id);")
execute("CREATE sequence tables_id_seq;")

# skip this next line if you know that no rows exist yet
execute("SELECT setval('tables_id_seq', (SELECT MAX(id) FROM tables));")    

execute("ALTER TABLE tables ALTER id SET DEFAULT nextval('tables_id_seq');") 
```

# ruby-on-rails-3 - 在虾 PDF 中添加货币单位？（语法错误）

> ID：15798573
> 
> 赞同：0
> 
> 时间：2013-04-03T21:34:48.717
> 
> 标签：ruby-on-rails-3, pdf, currency, prawn

我正在使用 Prawn PDF 处理 PDF 发票。我`number_to_currency`在通过`unit`.

```
def line_item_rows
 [["Description", "Qty", "Unit Price", "Price GBP"]] +
 @invoice.line_items.map do |item|
  [item.name, item.quantity, price(item.unit_price), price(item.full_price)]
 end
end

@view.number_to_currency(num, :unit => "£") 
```

以上导致错误：

```
syntax error, unexpected $end, expecting ')'
@view.number_to_currency(num, :unit => "£")
                                          ^): 
```

如果我使用 HTML 值，它只会输出原始 html：

```
@view.number_to_currency(num, :unit => "&pound;")
Total &pound;2,266.00 
```

使用 Prawn PDF 时是否有特殊的添加 £ 的方法？上述尝试在使用 html/erb 时效果很好，但在使用 Prawn PDF 时效果不佳。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T23:38:23.567

Ruby 可能不会将您的源文件视为 utf-8：

```
# encoding: US-ASCII <-- it's defaulting to this
puts "£" 
```

所以当它编译时：

```
$ ruby foo.rb 
foo.rb:2: invalid multibyte char (US-ASCII)
foo.rb:2: invalid multibyte char (US-ASCII)
foo.rb:2: syntax error, unexpected $end, expecting ')'
puts("£")
        ^ 
```

在文件顶部添加编码提示：

```
# encoding: utf-8
puts("£") 
```

它应该运行：

```
$ ruby foo.rb 
£ 
```

# ruby-on-rails - 无法获取 Google Analytics API 的 oAuth2 访问令牌

> ID：15798574
> 
> 赞同：4
> 
> 时间：2013-04-03T21:35:00.123
> 
> 标签：ruby-on-rails, oauth-2.0, access-token, google-analytics-api, garb-gem

我正在使用 Rails + Garb Gem (Sija Branch) + omniauth-google-oauth2 Gem，我可以成功地使用 Google Analytics API 进行身份验证，并提取我们的应用在使用用户登录时生成的数据，例如：

```
Garb::Session.login('USERNAME', '<PASSWORD>') 
```

然后我可以使用 Garb 连接到我想要的分析配置文件并从中提取数据并在网页上显示一些图表。这一切都很好。

但是，我想使用 oAuth2 通过 Analytics 进行身份验证，这就是为什么我必须从 Github 安装 Garb Gem 的 Sija 分支（它支持 oAuth2），并且我还安装了 omniauth-google-oauth2 Gem。现在理论上我应该能够使用以下代码进行身份验证：

```
Garb::Session.access_token = access_token # an instance of OAuth2::Client 
```

正是在这一点上，它对我来说有点朦胧，我将非常感谢一些指导。这是我已经走了多远：

1）我在Google API 控制台中创建了一个项目，并在Services 下打开了Analytics API

2) 这为我提供了客户端 ID 和客户端密码

3) 我遇到了这段代码，我可以用上面的 ID 和 Secret 填充它：

```
client = OAuth2::Client.new(
GOOGLE_CLIENT_ID,
GOOGLE_CLIENT_SECRET,
{
    :site          => 'https://accounts.google.com',
    :authorize_url => '/o/oauth2/auth',
    :token_url     => '/o/oauth2/token'
}) 
```

4）然后是下一段代码：

```
response = OAuth2::AccessToken.new(
    client,
    STORED_TOKEN, {
    refresh_token: STORED_REFRESH_TOKEN,
    expires_at: STORED_EXPIRES_AT
}) 
```

5）然后在理论上连接：

```
Garb::Session.access_token = response 
```

我遇到的问题是我没有上面第 (4) 点中的令牌信息。在我看来，使用 oAuth2 我需要进行一次“握手”并打印出返回令牌值？也许通过 Rails 代码打印返回的值，然后将标记值粘贴到 Rails 应用程序中的常量中，以便我可以在上面的代码中使用它们？我真的很困惑。正如我之前提到的，Web 应用程序使用用户登录身份验证可以正常工作。Web 应用程序所做的只是通过分析进行身份验证、提取一些数据并绘制图表。但我坚持将其转换为 oAuth2，因为***我只是不知道如何获取 Garb Gem 正在寻找的访问令牌。***我还应该注意，这不是一个有多个用户身份验证的公共网站，这是一个连接到我们自己的分析数据的 CMS 网站。

我已经看到了这方面的一些部分片段，但不是一个完全解释或工作的例子。对于这个问题，我非常感谢任何指导和帮助。

提前谢谢了，

JR

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-11T19:49:25.520

在过去的几周里，我一直在努力解决这个问题，所以让我分享一下有效的方法：

要使用 Oauth2，您需要获得一个“刷新令牌”，每次您进行 API 调用时，您都可以使用该“刷新令牌”与 google 进行“重新验证”。步骤如下：

1）在 API 控制台中设置您的帐户 - [https://code.google.com/apis/console/b/0/](https://code.google.com/apis/console/b/0/)（好像您做得很好） 2）在您的 API 帐户中，确保您有重定向 URI 指向您的应用程序：

```
http://some-url.com/auth/google_oauth2/callback
http://localhost:3000/auth/google_oauth2/callback 
```

请注意，google 不会让您以 0.0.0.0:3000 的形式回叫本地计算机...因此您需要明确使用 localhost

3) 在您的路由文件中，将该重定向 url 绑定到控制器中您将在其中创建项目或身份验证的操作

```
match '/auth/:provider/callback' => 'authentications#create' 
```

':provider' 只是让您匹配多种类型的 oauth，但您也可以将 'google_oauth2' 放在那里。

4）现在在您的控制器中创建该操作

```
def create
  auth = request.env["omniauth.auth"] 
  params = request.env["omniauth.params"]
  project = Project.find(params['project_id'])

  Authentication.create(:project_id => project.id, :provider => auth['provider'], :uid => auth['uid'], :access_token => auth['credentials']['refresh_token'])
  flash[:notice] = "Authentication successful."
  redirect_to owner_view_project_path(project)
end 
```

5）控制器操作应该从响应对象中检索相关字段（响应对象的详细信息：[https](https://github.com/zquestz/omniauth-google-oauth2) ://github.com/zquestz/omniauth-google-oauth2 ） - 特别是，您需要获取'refresh_token'和将其保存到您的项目或身份验证对象 - 如果您尚未将“access_token”属性添加到所需对象，请立即进行迁移，然后开始将刷新令牌保存到该属性

6) 现在，当您准备好调用该特定身份验证并为其获取 API 数据时，您可以加载保存访问令牌的对象，并使用该对象获取与 google API 的新会话，如下所示：

```
 @authentication = Authentications.find(params[:id])

  client = OAuth2::Client.new GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET,
                                  {
                                    :site => 'https://accounts.google.com',
                                    :authorize_url => "/o/oauth2/auth",
                                    :token_url => "/o/oauth2/token",
                                  }
  response = OAuth2::AccessToken.from_hash(client, :refresh_token => @authentication.access_token).refresh!
  Garb::Session.access_token = response
  @profiles = Garb::Management::Profile.all 
```

这段代码所做的是通过指定客户端和 refresh_token 创建 OAuth2 访问令牌（响应），然后调用“刷新！” 获取刷新的访问令牌...然后使用该访问令牌建立您的 Garb 会话，然后使用 Gard::Management::Profile.all 调用给定帐户的所有配置文件

希望这会有所帮助 - 如果您有任何问题，请告诉我！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-13T08:28:56.123

只需说明对我有用的内容：

对于步骤 3、4 和 5，我使用 cURL 来检索访问/刷新令牌。第 6 步对我来说也是一样的（使用 Garb Gem 的 Sija 分支）。所以使用 cURL：

使用与您的 Google 应用相关的详细信息，使用 cURL 发布以下内容：

```
curl --data "code=<APP_CODE>&redirect_uri=http://localhost:3000/oauth2callback&client_id=<CLIENT_ID>.apps.googleusercontent.com&scope=&client_secret=<CLIENT_SECRET>&grant_type=authorization_code" https://accounts.google.com/o/oauth2/token 
```

响应采用以下形式：

```
{
  "access_token" : "<ACCESS_TOKEN>",
  "token_type" : "Bearer",
  "expires_in" : 3600,
  "refresh_token" : "<REFRESH_TOKEN>"
} 
```

您可以按照第 6 部分将其插入 Garb Gem。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-31T00:43:57.560

@CamNorgate 的回答是有效的。

如果您在回调中没有从 Omniauth 返回“refresh_token”，请确保您正确初始化：google_oauth2

```
Rails.application.config.middleware.use OmniAuth::Builder do
  provider :google_oauth2, ENV["GOOGLE_CLIENT_ID"], ENV["GOOGLE_CLIENT_SECRET"],
    { :scope=>"https://www.google.com/m8/feeds, https://www.googleapis.com/auth/userinfo.email, https://www.googleapis.com/auth/userinfo.profile",
      :approval_prompt=>"force", access_type="offline"
    }

end 
```

确保包含**:approval_prompt=>"force", access_type="offline"**以便将 refresh_token 发回。[refresh_token 仅在用户第一次授权时提供](https://stackoverflow.com/a/10857806)。

# android - 以编程方式更改字符串的语言

> ID：15798582
> 
> 赞同：2
> 
> 时间：2013-04-03T21:35:22.423
> 
> 标签：android, localization

我有一个`TextView`根据情况向用户显示消息的方法。我可以根据情况更改字符串，效果很好。

我的问题是，我如何为不同的语言管理它？

我环顾四周，大多数建议是`string.xml`根据语言环境使用单独的。但由于这只是一种以编程方式更改其内容的字符串资源，因此它并没有真正起作用。

有没有办法有类似的东西

```
if(language is blabla)
    change the text to "this" 
```

或类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:12:47.150

您可以轻松地将本地更改为所需的本地：

```
 Locale locale = new Locale("en");
    Locale.setDefault(locale);
    Configuration mConfig = new Configuration();
    mConfig.locale = locale;
    getBaseContext().getResources().updateConfiguration(mConfig, 
            getBaseContext().getResources().getDisplayMetrics()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:53:59.847

您可以使用类以编程方式检查用户的语言：http: [//developer.android.com/reference/java/util/Locale.html](http://developer.android.com/reference/java/util/Locale.html) 即

```
Locale.getDefault().toString() 
```

接下来，您应该使用相应 string.xml 的路径您只更改粗体部分：

价值观**-en-rMU**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:54:48.693

我通过使用 SQLite 数据库来管理这个。我有 5 种语言的 5 个不同的表。在我的 listAdapter 中，我从查询中导入了表名： **SELECT * FROM dbname.sqlite_master WHERE type='table'** 接下来，在一个名为 OutputStrings 的单例类中，我为 UI 导入所有使用的字符串。每个活动视图都从 OutputStrings 中读取字符串。

此致，

# salesforce - 选择连接字符串中值的前两个字符

> ID：15798586
> 
> 赞同：1
> 
> 时间：2013-04-03T21:35:36.173
> 
> 标签：salesforce, formula

我正在尝试创建一个公式字段来检查一个字符串，该字符串是一系列用逗号分隔的连接值。我想检查字符串中每个逗号分隔值的前两个字符。例如，字符串模式可以是：abcd,efgh,ijkl,mnop,qrst,uvwx

在我的公式中，我想检查前两个字符是否是'ab'，'ef'

如果是这样，我将返回 true，否则返回 false。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:02:02.647

要正确执行此操作，您需要使用正则表达式。不幸的是，REGEX 函数在公式字段中不可用。但是，它在验证规则和工作流规则中的公式中可用。因此，您可以在验证或工作流程规则中指定以下公式：

```
OR(
AND(
    NOT(
        BEGINS( KXENDev__Languages__c, "ab" )
    ),
    NOT(
        BEGINS( KXENDev__Languages__c, "ef" )
    )
),
REGEX( KXENDev__Languages__c , ".*,(?!ab|ef).*")
) 
```

如果它是一个验证规则，你就完成了——如果任何条目*不*以“ab”或“ef”开头，这个公式将产生一个错误。如果它是一个工作流规则，那么您可以向它添加一个字段更新以在此公式为真时使用 False 更新某些字段（如果此公式为真，则至少有一个项目不以 ab 或 ef 开头，所以这将使您的字段为 False）。

有些人可能会问“BEGINS 语句是怎么回事？难道你不能用一个 REGEX 完成这一切吗？” 是的，我可能可以，但这会导致越来越复杂的 REGEX 语句，并且这些在 Salesforce.com 中很难调试，所以我更喜欢让 Salesforce.com 中的 REGEX 尽可能简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T12:06:50.750

我建议您使用 CONTAINS 方法搜索 ',ab' 和 ',ef'。但首先你需要重新实现组成这个字符串的方法，所以它把'，'放在第一个子字符串之前。最后返回的字符串应该类似于 ',abcd,efgh,ijkl,mnop,qrst,uvwx'。如果您无法重新实现构成此字符串的方法，请使用 LEFT([our string going here],2) 方法检查前两个字符。

# asp.net-mvc - 为什么调用结果过滤器？

> ID：15798589
> 
> 赞同：1
> 
> 时间：2013-04-03T18:18:39.847
> 
> 标签：asp.net-mvc, asp.net-mvc-4

```
public class CustomResultAttribute : FilterAttribute, IResultFilter
{
    public void OnResultExecuted(ResultExecutedContext filterContext)
    {}

    public void OnResultExecuting(ResultExecutingContext filterContext)
    {}
}

public class CustomActionAttribute : FilterAttribute, IActionFilter
{
    public void OnActionExecuted(ActionExecutedContext filterContext)
    {}

    public void OnActionExecuting(ActionExecutingContext filterContext)
    {
         filterContext.Result = new ViewResult { ViewName = "NotIndex" };
    }
}

   [CustomResult]
    [CustomAction]
    public ActionResult Index()
    {
        return View();
    } 
```

据我了解，*结果过滤器*应该只包含对操作方法产生的结果进行操作的逻辑（因此我们应用于`CustomResult`特定操作方法的原因）。

所以我不明白为什么在处理时也会调用*结果过滤器*`NotIndex`，因为`NotIndex`不是由*`Index`操作方法*产生的？

谢谢

# batch-file - 根据日期批量删除csv中的一行

> ID：15798591
> 
> 赞同：0
> 
> 时间：2013-04-03T21:35:52.880
> 
> 标签：batch-file, batch-processing

我试图弄清楚是否可以使用批处理脚本根据找到的日期删除一行。数据必须始终是当前日期。

所以我有一个看起来像这样的文件：

```
Group Id  Date         att_code
acme   1  04/02/2013     A
acme   2  05/06/2013     A 
```

我希望批处理文件删除具有`05/06/2013`. 它将根据今天的日期确定要删除的那些。数据将不按顺序排列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:27:11.183

该*命令行*应该可以工作：

```
findstr /V "%date%" theFile.csv 
```

如果您愿意，您可以在批处理文件中插入前一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:04:20.127

你可以使用这个：

```
<source.csv>target.csv findstr /V "%date%" 
```

# c# - 为什么我的财产不知道直接对数据库所做的更改

> ID：15798592
> 
> 赞同：1
> 
> 时间：2013-04-03T21:35:55.983
> 
> 标签：c#, wpf, entity-framework, mvvm, ef-code-first

我有一个简单的 View 和 ViewModel。当您单击技术人员组合框并选择技术人员时，选定技术人员的测试将显示在您在下面看到的列表视图中。这工作得很好。

**注意**Technician 与 Test 有一对多的关系，每个都是一个实体（代码优先实体框架）。

**MainViewModel.xaml**

```
<Grid>
    <StackPanel>
        <ComboBox ItemsSource="{Binding Technicians, Mode=TwoWay}"
                  DisplayMemberPath="FullName"
                  SelectedItem="{Binding SelectedTechnician, Mode=TwoWay}">
        </ComboBox>
        <ListView ItemsSource="{Binding SelectedTechnician.Tests}"
                  SelectedItem="{Binding SelectedTest}"
                  HorizontalAlignment="Left" Height="100" Margin="10,10,0,0" VerticalAlignment="Top" Width="271">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Id" Width="auto" DisplayMemberBinding="{Binding Id}"/>
                    <GridViewColumn Header="Test" Width="auto" DisplayMemberBinding="{Binding TestTypeName}"/>
                </GridView>
            </ListView.View>
        </ListView>
    </StackPanel>
</Grid> 
```

**MainWindowViewModel.cs**

```
public class MainWindowViewModel : ViewModelBase
{
    private WpfTestBedDb db = new WpfTestBedDb();

    public MainWindowViewModel()
    {
        Technicians = new ObservableCollection<Technician>();
    }

    private ObservableCollection<Technician> _technicians;

    public ObservableCollection<Technician> Technicians
    {
        get { return _technicians; }
        set
        {
            _technicians = value;
            OnPropertyChanged("Technicians");
        }
    }

    private Technician _selectedTechnician;

    public Technician SelectedTechnician
    {
        get { return _selectedTechnician; }
        set
        {
            if (_selectedTechnician != value)
            {
                _selectedTechnician = value;
                OnPropertyChanged("SelectedTechnician");
            }
        }
    }

    public void LoadTechnicians()
    {
        var query = from tech in db.Technicians
                    select tech;
        foreach (var technician in query)
        {
            Technicians.Add(technician);
        }
    }
} 
```

顺便说一句，为了测试 DataBinding 上的功能`ObservableCollection<Technician> Technicians;`，正如您在上面的 ViewModel 中看到的那样，我通过 SSMS 进入数据库并在应用程序仍在运行时添加了一个新的 Technician。添加完成后，我转到应用程序并单击我的技术人员组合框，却发现列表/用户界面尚未更新。然而，我会认为，因为我将属性 Technicians 设为 ObservableCollection，并且会引发`OnPropertyChanged("Technicians");`，所以 UI 会更新。

我做了这个实验来模拟同时运行的两个相同的应用程序，每个应用程序都读取和写入同一个数据库。

**第一个问题：**尽管我的 ObservableCollection 引发了 OnPropertyChanged，为什么 UI 没有更新？也就是说，为什么它不知道直接对数据库（应用程序外部）所做的更改？

**第二个问题：**我需要添加什么才能让 Technicians 的集合不断了解 DB 更改？（我认为这就是 ObservableCollection 的用途）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T21:38:51.583

简短版本：大多数数据访问代码是**断开连接**的模型，而不是实时/连接模型。

这里的“可观察”意味着“对该层中的其他更改做出反应”，即其他.NET 代码操作对象模型。使用`ObservableCollection<T>`不会让一只大手通过网络从数据库伸出来调整位。

制作即时变化感知系统比这更复杂。坦率地说，如果您真的需要即时更新，我建议您查看 pub/sub 之类的内容。否则，*也许*考虑偶尔轮询。

此外，请注意，如果您*确实*想进行轮询，则不能仅通过以下方式重新获取对象：

```
var stateNow = db.Technicians.Single(x => x.Id == myId); 
```

因为那*可能只会把你已经拥有的东西交还给你*；许多 ORM 都内置了身份缓存。要实际重新获取对象，您将需要第二个 db-context 实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:44:40.727

除了 Marc Gravell 的回答之外，在回答您的第二个问题时，您可能还想查看该`SqlDependency`课程。

引用[文档](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldependency.aspx)：

> SqlDependency 对象表示应用程序和 SQL Server 实例之间的查询通知依赖关系。应用程序可以创建 SqlDependency 对象并注册以通过 OnChangeEventHandler 事件处理程序接收通知。

# php - PHP 服务器和 android 作为客户端

> ID：15798593
> 
> 赞同：0
> 
> 时间：2013-04-03T21:35:57.270
> 
> 标签：php, android, sockets

我在我的大学域下有一个子域，例如 www.university.edu/~myname ...我的主要目标是将 gps 数据从 android 设备发送到在该域上运行的服务器，该服务器正在运行 google maps api，并且可以指出设备的位置。我想在这个 url 上运行一个可以接受连接的服务器，我尝试搜索并最终制作了一个可以接受连接的 PHP 服务器套接字。

我有两个问题：1.如何将此套接字绑定到 IP，因为据我所知子域没有 IP 2.我应该使用什么来从我的 android 设备发送数据。

提前致谢

# forms - 用户离开字段后验证字段

> ID：15798594
> 
> 赞同：94
> 
> 时间：2013-04-03T21:36:02.710
> 
> 标签：forms, angularjs

使用 AngularJS，我可以使用`ng-pristine`or`ng-dirty`来检测用户是否输入了该字段。但是，我只想在用户离开字段区域后进行客户端验证。这是因为当用户输入诸如电子邮件或电话之类的字段时，他们总是会收到一个错误，直到他们完成输入完整的电子邮件，这并不是最佳的用户体验。

[**例子**](http://plnkr.co/edit/E6l6GOkKOEuVO1iz0fjU?p=preview)

* * *

**更新：**

Angular 现在附带一个自定义模糊事件： [https ://docs.angularjs.org/api/ng/directive/ngBlur](https://docs.angularjs.org/api/ng/directive/ngBlur)

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2014-10-06T07:44:52.057

从 1.3.0 版本开始，这可以很容易地用 来完成`$touched`，这在用户离开现场后是正确的。

```
<p ng-show="form.field.$touched && form.field.$invalid">Error</p> 
```

[https://docs.angularjs.org/api/ng/type/ngModel.NgModelController](https://docs.angularjs.org/api/ng/type/ngModel.NgModelController)

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2014-05-04T23:37:54.430

Angular 1.3 现在有 ng-model-options，你可以将选项设置`{ 'updateOn': 'blur'}`为例如，你甚至可以去抖动，当使用时输入太快，或者你想节省一些昂贵的 DOM 操作（比如模型编写到多个 DOM 位置，并且您不希望每次按键都发生 $digest 循环）

[https://docs.angularjs.org/guide/forms#custom-triggers](https://docs.angularjs.org/guide/forms#custom-triggers)和[https://docs.angularjs.org/guide/forms#non-immediate-debounced-model-updates](https://docs.angularjs.org/guide/forms#non-immediate-debounced-model-updates)

> 默认情况下，对内容的任何更改都会触发模型更新和表单验证。您可以使用 ngModelOptions 指令覆盖此行为，以仅绑定到指定的事件列表。即 ng-model-options="{ updateOn: 'blur' }" 只有在控件失去焦点后才会更新和验证。您可以使用空格分隔的列表设置多个事件。即 ng-model-options="{ updateOn: 'mousedown blur' }"

并去抖动

> 您可以使用带有 ngModelOptions 指令的 debounce 键来延迟模型更新/验证。这种延迟也适用于解析器、验证器和模型标志，如 $dirty 或 $pristine。
> 
> 即 ng-model-options="{ debounce: 500 }" 在触发模型更新和表单验证之前，将在最后一次内容更改后等待半秒。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-06-04T18:28:18.440

我通过扩展@jlmcdonald 的建议解决了这个问题。我创建了一个指令，该指令将自动应用于所有输入和选择元素：

```
var blurFocusDirective = function () {
    return {
        restrict: 'E',
        require: '?ngModel',
        link: function (scope, elm, attr, ctrl) {
            if (!ctrl) {
                return;
            }

            elm.on('focus', function () {
                elm.addClass('has-focus');

                scope.$apply(function () {
                    ctrl.hasFocus = true;
                });
            });

            elm.on('blur', function () {
                elm.removeClass('has-focus');
                elm.addClass('has-visited');

                scope.$apply(function () {
                    ctrl.hasFocus = false;
                    ctrl.hasVisited = true;
                });
            });

            elm.closest('form').on('submit', function () {
                elm.addClass('has-visited');

                scope.$apply(function () {
                    ctrl.hasFocus = false;
                    ctrl.hasVisited = true;
                });
            });

        }
    };
};

app.directive('input', blurFocusDirective);
app.directive('select', blurFocusDirective); 
```

当用户关注/访问元素时，这将为各种元素添加`has-focus`和分类。`has-visited`然后，您可以将这些类添加到您的 CSS 规则中以显示验证错误：

```
input.has-visited.ng-invalid:not(.has-focus) {
    background-color: #ffeeee;   
} 
```

这在元素仍然获得 $invalid 属性等方面效果很好，但 CSS 可用于为用户提供更好的体验。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-01-27T20:19:24.257

我设法用一个非常简单的 CSS 来做到这一点。这确实要求错误消息是与它们相关的输入的兄弟，并且它们具有`error`.

```
:focus ~ .error {
    display:none;
} 
```

在满足这两个要求之后，这将隐藏与焦点输入字段相关的任何错误消息，我认为 angularjs 无论如何都应该这样做。似乎是一个疏忽。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-09-24T09:35:32.663

这似乎在较新版本的 Angular 中作为标准实现。

**ng-untouched**和**ng-touched**类分别在用户关注已验证元素之前和之后设置。

**CSS**

```
input.ng-touched.ng-invalid {
   border-color: red;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-12-08T19:54:47.917

关于[@lambinator 的](https://stackoverflow.com/a/16924956/3080610)解决方案...我在 angular.js 1.2.4 中收到以下错误：

> 错误：[$rootScope:inprog] $digest 已经在进行中

我不确定我是否做错了什么，或者这是否是 Angular 的更改，但删除`scope.$apply`语句解决了问题，并且类/状态仍在更新。

如果您也看到此错误，请尝试以下操作：

```
var blurFocusDirective = function () {
  return {
    restrict: 'E',
    require: '?ngModel',
    link: function (scope, elm, attr, ctrl) {
      if (!ctrl) {
        return;
      }
      elm.on('focus', function () {
        elm.addClass('has-focus');
        ctrl.$hasFocus = true;
      });

      elm.on('blur', function () {
        elm.removeClass('has-focus');
        elm.addClass('has-visited');
        ctrl.$hasFocus = false;
        ctrl.$hasVisited = true;
      });

      elm.closest('form').on('submit', function () {
        elm.addClass('has-visited');

        scope.$apply(function () {
          ctrl.hasFocus = false;
          ctrl.hasVisited = true;
        });
      });
    }
  };
};
app.directive('input', blurFocusDirective);
app.directive('select', blurFocusDirective); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-03T22:13:02.310

编写一个包装 javascript blur() 方法的自定义指令（并在触发时运行验证函数）可能对您有用；有一个 Angular 问题有一个示例问题（以及一个可以绑定到 Angular 本身不支持的其他事件的通用指令）：

[https://github.com/angular/angular.js/issues/1277](https://github.com/angular/angular.js/issues/1277)

如果您不想走那条路，您的另一个选择是在该字段上设置 $watch ，在填写该字段时再次触发验证。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-06-05T14:14:36.393

为了进一步了解给定的答案，您可以通过使用 CSS3 伪类来简化输入标记，并且只使用类标记访问的字段以延迟显示验证错误，直到用户失去对字段的关注：

*（示例需要 jQuery）*

**JavaScript**

```
module = angular.module('app.directives', []);
module.directive('lateValidateForm', function () {
    return {
        restrict: 'AC',
        link: function (scope, element, attrs) {
            $inputs = element.find('input, select, textarea');

            $inputs.on('blur', function () {
                $(this).addClass('has-visited');
            });

            element.on('submit', function () {
                $inputs.addClass('has-visited');
            });
        }
    };
}); 
```

**CSS**

```
input.has-visited:not(:focus):required:invalid,
textarea.has-visited:not(:focus):required:invalid,
select.has-visited:not(:focus):required:invalid {
  color: #b94a48;
  border-color: #ee5f5b;
} 
```

**HTML**

```
<form late-validate-form name="userForm">
  <input type="email" name="email" required />
</form> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-03-21T06:12:03.820

基于@nicolas的回答..纯CSS应该是诀窍，它只会在模糊时显示错误消息

```
<input type="email" id="input-email" required
               placeholder="Email address" class="form-control" name="email"
               ng-model="userData.email">
        <p ng-show="form.email.$error.email" class="bg-danger">This is not a valid email.</p> 
```

CSS

```
.ng-invalid:focus ~ .bg-danger {
     display:none;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-08-06T10:44:01.043

这是一个使用 ng-messages（在 angular 1.3 中可用）和自定义指令的示例。

用户第一次离开输入字段时，验证消息会显示在模糊上，但是当他更正值时，验证消息会立即被删除（不再模糊）。

**JavaScript**

```
myApp.directive("validateOnBlur", [function() {
    var ddo = {
        restrict: "A",
        require: "ngModel",
        scope: {},
        link: function(scope, element, attrs, modelCtrl) {
            element.on('blur', function () {
                modelCtrl.$showValidationMessage = modelCtrl.$dirty;
                scope.$apply();
            });
        }
    };
    return ddo;
}]); 
```

**HTML**

```
<form name="person">
    <input type="text" ng-model="item.firstName" name="firstName" 
        ng-minlength="3" ng-maxlength="20" validate-on-blur required />
    <div ng-show="person.firstName.$showValidationMessage" ng-messages="person.firstName.$error">
        <span ng-message="required">name is required</span>
        <span ng-message="minlength">name is too short</span>
        <span ng-message="maxlength">name is too long</span>
    </div>
</form> 
```

PS。不要忘记下载 ngMessages 并将其包含在您的模块中：

```
var myApp = angular.module('myApp', ['ngMessages']); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-05-22T18:22:53.403

AngularJS 1.3（撰写本文时为测试版）中的 ng-model-options 被记录为支持 {updateOn: 'blur'}。对于早期版本，以下内容对我有用：

```
myApp.directive('myForm', function() {
  return {
    require: 'form',
    link: function(scope, element, attrs, formController) {
      scope.validate = function(name) {
        formController[name].isInvalid
            = formController[name].$invalid;
      };
    }
  };
}); 
```

使用这样的模板：

```
<form name="myForm" novalidate="novalidate" data-my-form="">
<input type="email" name="eMail" required="required" ng-blur="validate('eMail')" />
<span ng-show="myForm.eMail.isInvalid">Please enter a valid e-mail address.</span>
<button type="submit">Submit Form</button>
</form> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-04-20T08:36:52.133

使用字段状态**$touched**该字段已被触摸，如下例所示。

```
<div ng-show="formName.firstName.$touched && formName.firstName.$error.required">
    You must enter a value
</div> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-04-29T17:43:07.767

您可以使用 ng-class 和关联控制器范围内的属性动态设置 has-error css 类（假设您使用的是引导程序）：

plunkr：[http ://plnkr.co/edit/HYDlaTNThZE02VqXrUCH?p=info](http://plnkr.co/edit/HYDlaTNThZE02VqXrUCH?p=info)

HTML：

```
<div ng-class="{'has-error': badEmailAddress}">
    <input type="email" class="form-control" id="email" name="email"
        ng-model="email" 
        ng-blur="emailBlurred(email.$valid)">
</div> 
```

控制器：

```
$scope.badEmailAddress = false;

$scope.emailBlurred = function (isValid) {
    $scope.badEmailAddress = !isValid;
}; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-23T09:32:13.997

如果您使用 bootstrap 3 和 lesscss，您可以使用以下 less 代码段启用模糊验证：

```
:focus ~ .form-control-feedback.glyphicon-ok {
  display:none;
}

:focus ~ .form-control-feedback.glyphicon-remove {
  display:none;
}

.has-feedback > :focus {
  & {
    .form-control-focus();
  }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-07-04T19:26:33.080

out我使用了一个指令。这是代码：

```
app.directive('onBlurVal', function () {
    return {
        restrict: 'A',
        link: function (scope, element, attrs, controller) {

            element.on('focus', function () {
                element.next().removeClass('has-visited');
                element.next().addClass('has-focus');
            });

            element.on('blur', function () {

                element.next().removeClass('has-focus');
                element.next().addClass('has-visited');
            });
        }
    }
}) 
```

我的所有输入控件都有一个 span 元素作为下一个元素，这是显示我的验证消息的地方，因此将指令作为属性添加到每个输入控件中。

我的 css 文件中还有（可选）.has-focus 和 has-visited css 类，您可以在指令中看到它们被引用。

注意：请记住以这种方式将“on-blur-val”添加到您的输入控件中，不要使用撇号

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-09-10T13:02:13.030

通过使用**ng-focus**，您可以实现您的目标。您需要在输入字段中提供 ng-focus 。在编写您的 ng-show 衍生品时，您还必须编写一个不相等的逻辑。像下面的代码：

`<input type="text" class="form-control" name="inputPhone" ng-model="demo.phoneNumber" required ng-focus> <div ng-show="demoForm.inputPhone.$dirty && demoForm.inputPhone.$invalid && !demoForm.inputPhone.$focused"></div>`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-11-24T07:49:09.377

我们可以使用 onfocus 和 onblur 函数。将是简单和最好的。

```
<body ng-app="formExample">
  <div ng-controller="ExampleController">
  <form novalidate class="css-form">
    Name: <input type="text" ng-model="user.name" ng-focus="onFocusName='focusOn'" ng-blur="onFocusName=''" ng-class="onFocusName" required /><br />
    E-mail: <input type="email" ng-model="user.email" ng-focus="onFocusEmail='focusOn'" ng-blur="onFocusEmail=''" ng-class="onFocusEmail" required /><br />
  </form>
</div>

<style type="text/css">
 .css-form input.ng-invalid.ng-touched {
    border: 1px solid #FF0000;
    background:#FF0000;
   }
 .css-form input.focusOn.ng-invalid {
    border: 1px solid #000000;
    background:#FFFFFF;
 }
</style> 
```

在这里试试：

[http://plnkr.co/edit/NKCmyru3knQiShFZ96tp?p=preview](http://plnkr.co/edit/NKCmyru3knQiShFZ96tp?p=preview)

# c# - MouseEventArgs .handled 等价物？单击和 mouseup 触发两次

> ID：15798595
> 
> 赞同：0
> 
> 时间：2013-04-03T21:36:04.723
> 
> 标签：c#, event-handling

MouseEventArgs 是否有等效于执行 e.Handled 的方法？我遇到了一个问题，我的事件处理程序在同一个对象上触发了两次。我单击对象（一个按钮），它运行应该删除按钮的代码。我一步一步地通过，因为它删除了按钮。但随后它再次运行！我检查了发件人——它的（据称已删除！）按钮 0_o。

```
 private void InTrayButton_MouseUp(object sender, MouseEventArgs e)
    {
        Button button = (Button)sender;
        int element = 0;

        //Find the index of the button in the list
        foreach (ButtonList a in buttonList)
        {
            if (button == a.buttonSaved)
                break;
            element++;
        }

        //Remove the button
        this.Controls.Remove(buttonList[element].buttonSaved);
        buttonList[element].buttonSaved.Dispose();
        buttonList.Remove(buttonList[element]);

    } 
```

有人对我如何强制它停止两次关闭有任何想法吗？无论我将其设置为 mouseup 还是 click 事件都没有关系，它每次都会触发两次 >_>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:43:58.270

听起来您在代码中不止一次连接同一个事件处理程序。我建议追踪它的位置并确保它只发生一次。

# c# - c++ 到 c# dll 导入 ReadImage

> ID：15798598
> 
> 赞同：0
> 
> 时间：2013-04-03T21:36:15.740
> 
> 标签：c#, c++, interop

我在 C++ 中有这个函数，我想在 c# 中导入它

```
BS_RET_CODE BS_ReadImage( int handle, int imageType, unsigned char* bitmapImage, int* imageLen) 
```

我试过了

```
[DllImport("BS_SDK.dll",CharSet = CharSet.Ansi, EntryPoint = "BS_ReadImage")]
public static extern int BS_ReadImage(int handle, int imageType, IntPtr bitmapImage, ref int imageLen);

IntPtr image = new IntPtr();
int len = 0;
BSSDK.BS_ReadImage(m_Handle, 0xff, image, ref len);

byte[] _imageTemp = new byte[len];
Marshal.Copy(image, _imageTemp, 0, len); 
```

但我得到一个访问冲突异常

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:39:51.277

也许你应该检查它`len`实际上等于或大于`image`??的大小。

异常发生在哪里？具体是什么线？

# random-sample - 如何从非常庞大的数据集中获得无偏的随机样本？

> ID：15798602
> 
> 赞同：3
> 
> 时间：2013-04-03T21:36:31.740
> 
> 标签：random-sample

对于我正在处理的应用程序，我需要从一个非常大的数据集中抽取一小组值，从大约 60 万亿（并且还在增长）中抽取大约几百个值。

通常我使用查看均匀随机数 r (0..1) 是否小于 S/T 的技术，其中 S 是我仍然需要的样本项目数，T 是我在集合中的项目数还没考虑。

但是，有了这些新数据，我没有时间为每个值掷骰子。太多了。相反，我想生成随机数量的条目以“跳过”，在下一个位置选择值，然后重复。这样我就可以掷骰子并访问列表 S 次。（S 是我想要的样本大小。）

我希望有一种简单的方法可以做到这一点，并按照 S/T 测试的方式创建一个公正的样本。

*   老实说，大致不偏不倚就可以了。

*   这与此人的问题有关（或多或少是后续问题）：

[https://math.stackexchange.com/questions/350041/simple-random-sample-without-replacement](https://math.stackexchange.com/questions/350041/simple-random-sample-without-replacement)

*   还有一个问题……第一个展示给我看的人称它为“邮递员算法”，但我不确定他是否在拉我的腿。是对的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:52:48.810

这个怎么样：

*   预先计算从 0 到数据集大小的 S 个随机数。
*   订购您的号码，从低到高
*   将连续数字之间的差异存储为跳过大小
*   使用上面的跳过大小迭代大型数据集。

...假设您收集样本的顺序无关紧要

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T06:39:42.080

所以我想了想，得到了一些帮助[http://math.stackexchange.com](http://math.stackexchange.com)

归结为：

*   如果我*一次*随机选择*n 个*项目，第一个会落在哪里？也就是说，*min({r_1 ... r_n})*。math.stackexchange 的一位乐于助人的人将其归结为以下等式：

 **x = 1 - (1 - r) ** (1 / n)

也就是说，分布将是 1 减去*(1 - r)*的*n*次方。然后求解*x*。挺容易。

*   如果我生成一个统一的随机数并将其插入*r*，它的分布与*min({r_1 ... r_n})*相同 - 与最低项目下降的方式相同。瞧！我刚刚模拟了选择第一项，就好像我随机选择了所有*n*一样。

*   所以我跳过列表中的那么多项目，选择那个，然后....

*   重复直到*n*为 0

这样，如果我有一个大数据库（如 Mongo），我可以跳过、find_one、skip、find_one 等。直到我拥有我需要的所有项目。

我遇到的唯一问题是我的实现有利于列表中的第一个和最后一个元素。但我可以忍受。

在 Python 2.7 中，我的实现如下所示：

```
def skip(n):
    """
    Produce a random number with the same distribution as
    min({r_0, ... r_n}) to see where the next smallest one is
    """
    r = numpy.random.uniform()
    return 1.0 - (1.0 - r) ** (1.0 / n)

def sample(T, n):
    """
    Take n items from a list of size T
    """
    t = T
    i = 0
    while t > 0 and n > 0:
        s = skip(n) * (t - n + 1)
        i += s
        yield int(i) % T
        i += 1
        t -= s + 1
        n -= 1

if __name__ == '__main__':

    t = [0] * 100
    for c in xrange(10000):
        for i in sample(len(t), 10):
            t[i] += 1  # this is where we would read value i

    pprint.pprint(t) 
```**

# android - 如何编程按钮以将表格布局导出到 Android 应用程序上的图像或 PDF 文件

> ID：15798603
> 
> 赞同：2
> 
> 时间：2013-04-03T21:36:32.380
> 
> 标签：android, eclipse, image, export

我觉得我已经到处看了，但我仍然不知道如何实现我的目标。我有一个用 Eclipse 制作的 android 应用程序，它在线性布局中有一个表格布局。该表会进行一些计算并提供类似 Excel 电子表格的答案。我的应用程序的链接如下。我只是想添加一个按钮来导出到可以存储在 SD 驱动器上的图像文件，或者 PDF 文件。我以为这很简单，但我完全迷失在这里。我是编程新手，但该应用程序现在有近 500 次下载，我有一个添加此功能的请求。我用 XML 制作了活动显示。感谢您的帮助。![在此处输入图像描述][1]

[https://play.google.com/store/apps/details?id=com.bestserialdilutioncalculator&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS5iZXN0c2VyaWFsZGlsdXRpb25jYWxjdWxhdG9yIl0](https://play.google.com/store/apps/details?id=com.bestserialdilutioncalculator&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS5iZXN0c2VyaWFsZGlsdXRpb25jYWxjdWxhdG9yIl0)。

所以我已经有了用 XML (JPEGB) 制作的按钮，如下所示。在 Java 代码中，我还没有添加任何与此按钮或导出到图像相关的内容。“按钮计算”用于不同的目的，稍后将在代码中提及。所以基本上，这是在 Java 代码中从头开始，使用 XML 制作的简单按钮。我截断了我认为这篇文章不必要的代码。非常感谢！！

Java 代码

```
package com.example.bestserialdilutioncalculator;

import java.math.BigDecimal;
import java.math.RoundingMode;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

import com.bestserialdilutioncalculator.R;

public class InitialLayout extends Activity {

Button Calculate;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_table_calculator); 
```

用于布局的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<RelativeLayout 
    android:orientation="vertical"
    android:background="#000000"
    android:layout_width="42dp"
    android:layout_height="fill_parent">
    <View
        android:layout_width="25dp"
        android:layout_centerHorizontal="true"
        android:background="@drawable/customicon"
        android:layout_height="25dp"
        ></View>

    <Button
        android:id="@+id/CalculateButton"
        android:layout_width="match_parent"
        android:layout_height="200dp"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:layout_marginTop="55dp"
        android:background="@drawable/goodbutton"
        android:text=" " />

    <Button
        android:id="@+id/JPEGB"
        android:layout_width="match_parent"
        android:layout_height="28dp"
        android:layout_centerHorizontal="true"
        android:layout_alignParentBottom="true"
        android:background="@drawable/jpegbutton"/>

</RelativeLayout>

<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/ScrollerForTable"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:fillViewport="true"
    android:background="#000000" >

  <HorizontalScrollView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/HorizontalScrollerForTable"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="#000000">

<TableLayout
    android:id="@+id/Table"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:background="#000000" > 
```

剩下的代码是表格布局细节，而且很长。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:36:13.207

因此，您可以捕获应用程序的视图（屏幕）并将其写入文件。

首先创建一个`Bitmap`应用程序的根视图：

```
mRootView.setDrawingCacheEnabled(true);
Bitmap bmp = Bitmap.createBitmap(mRootView.getDrawingCache());
mRootView.setDrawingCacheDisabled(false); 
```

`mRootView`将是您在活动的 onCreate() 方法中传递给 setContentView() 的视图。

然后将其写入磁盘：

```
// This should be done off the main (UI) thread!
String externalStoragePath = android.os.Environment.getExternalStorageDirectory().getAbsolutePath();
outFile = new File(externalStoragePath, "myfilename.jpg");

try {
    OutputStream os = new FileOutputStream(outFile);
    bitmap.compress(Bitmap.CompressFormat.JPEG, 90, os);
    os.flush();
    os.close();
} catch (Exception e) {
    // handle error here
} 
```

为简洁起见，我没有包括确保外部存储确实可用和安装的必要检查。如果需要我可以添加。

# ember.js - 升级到 Rails 4 后，Handlebars 资产未使用 ember-rails 编译

> ID：15798605
> 
> 赞同：2
> 
> 时间：2013-04-03T21:36:37.243
> 
> 标签：ember.js, asset-pipeline, handlebars.js, ruby-on-rails-4, ember-rails

我在前端有一个带有 Ember 的 Rails 应用程序。今天，我升级到 Rails 4，唯一无法解决的问题是我的 Handlebars 模板没有被编译或包含为资产（在开发模式下）。我没有收到任何错误消息。

我生成了一个全新的 Rails 4 测试应用程序并安装了 Ember，它可以很好地处理 Handlebars 文件。测试应用程序中的所有宝石都存在于我的应用程序中。我尝试运行`rake rails:upgrade`，但没有效果。我尝试修改 ember-rails 源以输出日志消息，并且测试应用程序和我的应用程序的消息和执行路径相同。

我像往常一样需要模板：

```
require_tree ./templates 
```

我尝试使用 ember-rails 0.11.1 和 Github master，但没有成功。

相关宝石版本：

```
 * ember-data-source (0.0.5)
  * ember-rails (0.11.1 4dc902b)
  * ember-source (1.0.0.rc2.0)
  * sprockets (2.9.0)
  * sprockets-rails (2.0.0.rc3)
  * barber (0.4.1) 
```

*   模板都在 app/assets/javascripts/templates 中，并且都使用扩展名 .handlebars。虽然我也尝试过 .hbs 和 .js.hjs 。

从 Chrome 控制台：

> Ember.TEMPLATES 对象 {}

我可以像这样从 Rails 命令行手动编译资产：

```
environment = Sprockets::Environment.new
environment.append_path 'app/assets/javascripts'
a = environment['templates/test.handlebars']
a.to_s => "..compiled template.." 
```

并且引擎已注册：

```
environment.engines
=> {..".handlebars"=>Ember::Handlebars::Template..} 
```

Rails.application.config.assets.paths 应该包含 app/assets/javascripts 文件夹。

对此的任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T03:54:53.707

我已将其缩小到 ember-rail 的 engine.rb 文件中的以下块。对于我的应用程序，它在 Sprockets 上发送 register_engine，而不是 app.assets。在新的 Rails 4 测试应用程序上，它也是这样做的。但是，在我的应用程序中，当我强制执行使用 app.assets 时，会编译车把模板。

我相信由于我的应用程序是从 Rails 3 升级的，因此缺少一些配置以正确使用 Sprockets。当我知道时，我会发布更多。

```
 initializer "ember_rails.setup", :after => :append_assets_path, :group => :all do |app|
    sprockets = if ::Rails::VERSION::MAJOR == 4
      Sprockets.respond_to?('register_engine') ? Sprockets : app.assets
    else
      app.assets
    end

    sprockets.register_engine '.handlebars', Ember::Handlebars::Template
    sprockets.register_engine '.hbs', Ember::Handlebars::Template
    sprockets.register_engine '.hjs', Ember::Handlebars::Template
  end 
```

更新：对我来说，更改 application.rb 中的 railties 顺序足以解决问题。我相信其他一些引擎正在清除 Sprockets 配置，因此通过在此过程后期加载 Ember::Rails 引擎，我能够解决该问题。

```
config.railties_order = [:main_app, :all, Ember::Rails::Engine] 
```

# file - 如何在我的批处理文件中使用 txt 文件中的变量

> ID：15798608
> 
> 赞同：1
> 
> 时间：2013-04-03T21:36:49.070
> 
> 标签：file, batch-file

我有一个 txt 文件 naemd as (settings.txt )，它有内容

```
SET BACKUP_DRIVE=E:\
SET BACKUP_DIRECTORY=BACKUP\
SET HOURLY_DIRECTORY=HOURLY\
SET INPUT_DIRECTORY=D:\MySQL\Data\CDR\. 
```

我有一个 bat 文件，我想在其中使用这些变量来准备备份路径

```
SET BACKUP_PATH=%BACKUP_DRIVE%%BACKUP_DIRECTORY%%HOURLY_DIRECTORY%%CURRENT_HOUR%\ 
```

但我没有准备好路径。

我已经尝试在 bat 文件中键入 settings.txt 它正在打印设置文件的内容但没有实现它..显示回显已关闭..如果我在回显上也有一些问题。请告诉我如何使用这些变量

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:54:44.467

尝试这个：

```
@echo off&setlocal
:: set CURRENT_HOUR for testing
set "CURRENT_HOUR=03"
for /f "delims=" %%i in (settings.txt) do %%i
SET "BACKUP_PATH=%BACKUP_DRIVE%%BACKUP_DIRECTORY%%HOURLY_DIRECTORY%%CURRENT_HOUR%\"
echo %BACKUP_PATH% 
```

输出是：

```
E:\BACKUP\HOURLY\03\ 
```

# .net - useDefaultCredentials 似乎没有形成使用任何凭据进行代理的请求

> ID：15798613
> 
> 赞同：0
> 
> 时间：2013-04-03T21:36:57.280
> 
> 标签：.net, wcf, webclient

我在客户端和应用程序服务器之间设置了代理。基本上，我不知道我是否缺少某些东西（我之前有这个工作，现在它已经坏了，没有明显的原因。）但是当我尝试通过我的网络客户端和代理发出 http 请求时在我的 IE 设置中设置，即使我的配置文件确实包含：

```
 <system.net>
    <defaultProxy useDefaultCredentials="true"/> 
  </system.net> 
```

考虑到我清楚地提供了所需的凭据，无法弄清楚这个愚蠢的事情如何或为什么不起作用。我已经在默认代理中尝试了各种不同的属性设置，但似乎没有任何区别。

有人知道我忽略了一些事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T06:53:39.793

因此，对于遇到此问题并连接到代理的任何人，请确保客户端和代理的身份验证类型相同。如果一个与另一个不同，则不会发送凭据。例如，如果您有一个使用基本身份验证的代理和一个使用 ntlm 或 kerberos 的客户端，您就会遇到问题。

# c# - 如何将多维列表或元组传递给 C# Web 服务

> ID：15798617
> 
> 赞同：0
> 
> 时间：2013-04-03T21:37:06.473
> 
> 标签：c#, web-services, multidimensional-array, asmx

我正在开发一个需要接受具有三个不同类型值的集合的 Web 服务。值是

SkuNumber（整数）、FirstName（字符串）、LastName（字符串）

我希望 Web 服务接受这些值的 100 个实例的列表，但不知道如何去做。我使用多维列表还是数组？也许是一个元组？或者我可以创建一个简单的类结构并接受该类的列表吗？

这在普通应用程序中非常简单，我只是不确定调用 Web 服务的应用程序如何使用任何给定选项传递数据。

有人可以给我一些指示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:41:00.177

创建一个类并接受该类的列表。请务必将其标记为 [Serializable]。

```
[Serializable]   
public class Whatever
{
    public int SkuNumber { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

最佳实践是在程序集中定义服务和调用它的项目都可以访问的类。

元组或多维数组的问题在于您发送的数据没有固有的身份：您可以将任何旧的东西放在那里。如果您有课程，则表明您正在发送订单或查询或优惠券或您正在跟踪的任何内容。有一个层次的意义随之而来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T22:38:28.650

如果共享程序集不可行，您总是可以使用好的 ol' XML。它可能不是最佳解决方案，我相信这里的很多用户都会拒绝这个想法，但它很容易支持并且实施起来相对较快，所以这实际上取决于您的个人情况和负责开发人员的技能水平用于支持申请。

在这里使用 XML 的好处是调用应用程序可以在几乎任何平台上用几乎任何语言编写，只要它遵循 XML 结构。

XML 字符串应该很容易在调用应用程序中生成，但这里最大的缺点是，如果您有大量数据，则处理可能需要比预期更长的时间——在服务的两端。

如果您想尝试一下，这是一个工作示例：

```
 public class Whatever
    {
        public int SkuNumber { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
    }

    [WebMethod]
    public void HelloWorld(string xmlString)
    {
        //make all the node names + attribute names lowercase, to account for erroneous xml formatting -- leave the values alone though
        xmlString = Regex.Replace(xmlString, @"<[^<>]+>", m => m.Value.ToLower(),RegexOptions.Multiline | RegexOptions.Singleline);

        var xmlDoc = LoadXmlDocument(xmlString);

        var listOfStuff = new List<Whatever>();

        var rootNode = xmlDoc.DocumentElement;
        foreach(XmlNode xmlNode in rootNode)
        {
            var whatever = new Whatever
                               {
                                   FirstName = xmlNode["first_name"].InnerText,
                                   LastName = xmlNode["last_name"].InnerText,
                                   SkuNumber = Convert.ToInt32(xmlNode["sku_number"].InnerText)
                               };
            listOfStuff.Add(whatever);
        }
    }

    public static XmlDocument LoadXmlDocument(string xmlString)
    {
        //some extra stuff to account for URLEncoded strings, if necessary
        if (xmlString.IndexOf("%3e%") > -1)
            xmlString = HttpUtility.UrlDecode(xmlString);

        xmlString = xmlString.Replace((char)34, '\'').Replace("&", "&amp;").Replace("\\", "");

        var xmlDocument = new XmlDocument();
        xmlDocument.PreserveWhitespace = false;
        xmlDocument.LoadXml(xmlString);

        return xmlDocument;
    } 
```

您的 XML 将如下所示：

```
<stuff_to_track>
<whatever>
    <sku_number>1</sku_number>
    <first_name>jimi</first_name>
    <last_name>hendrix</last_name>
</whatever>
<whatever>
    <sku_number>2</sku_number>
    <first_name>miles</first_name>
    <last_name>davis</last_name>
</whatever>
<whatever>
    <sku_number>3</sku_number>
    <first_name>david</first_name>
    <last_name>sanborn</last_name>
</whatever>
<whatever>
    <sku_number>4</sku_number>
    <first_name>john</first_name>
    <last_name>coltrane</last_name>
</whatever>
</stuff_to_track> 
```

我还建议验证传入的 XML，包括模式和数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T02:53:45.820

只需发送您想要的内容：

```
public class Whatever
{
    public int SkuNumber { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

[WebMethod]
public void TakeList(List<Whatever> theList)
{
    foreach (var w in theList)
    {
    }
} 
```

# c - 类型转换繁重程序中省略小数点

> ID：15798619
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:37:09.440
> 
> 标签：c, floating-point, int, printf

我已经为高斯消除方法编写了这段代码：

```
#include <stdio.h>
int main()
{
    float arr[3][4]={{0}}, i, j, k, p;
    printf("Enter the coefficients:-\n");
    for(i=0; i<3;i++)
    {
        printf("Row #(%d)\n", (int)(i+1));
        for(j=0; j<4; j++)
        {
            scanf("%f", &arr[(int)i][(int)j]);
        }
    }
    for(k=1, p=(k-1); (k<=2); k++, p++)
    {
        for(i=k; i<=2; i++)
        {
            for(j=0; j<=3; j++)
            {
                arr[(int)i][(int)j]-=((arr[(int)i][(int)p]/arr[(int)p][(int)p])*arr[(int)p][(int)j]);
            }
        }
    }
    for(i=0; i<3;i++)
    {
        for(j=0; j<4; j++)
        {
            printf("%0.3f  ", arr[(int)i][(int)j]);
        }
        printf("\n");
    }
    return 0;
} 
```

但是，它不会打印正确的输出值。对输出的分析表明这些值已被四舍五入或其他东西。我猜某处二维数组的整数值已被考虑，即使我已将该数组作为双精度并且仅对语法有效的元素地址使用类型转换。您可以通过以下矩阵自行尝试：

```
R1-   10  -1  2  4
R2-   1   10 -1  3
R3-   2   3  20  7 
```

正确的输出应该是：

```
R1-   10    -1        2         4
R2-   0    10.1     -1.2       2.6
R3-   0     0       19.980    5.376 
```

我正在使用 GNU GCC 编译器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:39:58.213

1.  用整数类型声明用于数组索引的所有变量。
2.  摆脱所有演员表。你不需要它们中的任何一个。
3.  将行号和列号的所有常量替换为`Rows`和`Columns`，您只需定义一次。
4.  在循环范围内保持一致；不要`j < 4`在某些地方和`j <= 3`其他地方使用。（两者都会变成`j < Columns`。）
5.  摆脱`p`.
6.  on`k`循环迭代源行，即包含您将用于取消其他元素的数据的行。它运行`for (k = 0; k < Rows-1; ++k)`。
7.  中的循环`i`迭代您为 each 取消的目标行`k`。它运行`for (i = k+1; i < Rows; ++i)`。
8.  取消时要使用的因素是`k`行列中的元素`i`与`k`. 计算一次并调用它`factor`。
9.  对于行中的每一列`i`，从元素中减去该元素`factor`乘以行中同一列中的元素`k`。

我如上所述编写了代码，它会打印出您所说的预期结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:16:02.430

问题可能与舍入无关（传递给数组的索引不应影响数组本身的任何舍入）。

我在主循环中添加了一个打印语句，只是为了查看在进行每行减法时使用了哪些系数，并且它们在每列之间似乎不同，所以很可能你的数学是关闭的。我怀疑它与您的`p`变量有关，该变量始终固定为上面的行`k`，我认为这对您没有帮助。

您想获得每对行的行系数，然后减去您用于消除的行乘以该系数。系数是`M(1,0)/M(0,0)`针对第二排第一排消除，`M(2,1)/M(1,1)`第三排第二排消除，一般来说，`M(I,K)/M(K,K)`（其中K是用于消除的行，I是你的行'正在消除）。

最终你想做：

```
For each row K excluding the last row (0 to 1)...
    For each row I after it (K+1 to 2)...
        Get the row factor = M(I, K) / M(K, K).
        For each column J (0 to 3)...
            M(I, J) -= M(K, J) * factor 
```

将其（几乎直接）翻译成代码，结果应该是：

```
10.000000  -1.000000  2.000000   4.000000
-0.000000  10.100000  -1.200000  2.600000
-0.000000  -0.000000  19.980198  5.376237 
```

# c# - 在不打开新的form2的情况下更新form 2中的数据

> ID：15798622
> 
> 赞同：0
> 
> 时间：2013-04-03T21:37:13.737
> 
> 标签：c#, winforms, updates

我有 2 个表格，From1 和 Form2。通过单击一个按钮，图像被发送到 Form2 以显示在 Form 2 的 pictureBox 中。

每次我单击按钮时，都会打开一个新的 Form2 并显示图像，但这不是我想要的。

我希望只更新 Form2 的图片框中的图像，并且只保留一个 Form2（第一次打开）。

这是我在 Form1 中的代码：

```
Image<Bgr, byte> imResult =DrawMatches(imColor,Points1, imColorPrv,Points2,Indices, new Bgr(System.Drawing.Color.Yellow), new Bgr(System.Drawing.Color.Red);
Form2 frmDrawMatchPoints = new Form2(imResult);
frmDrawMatchPoints.Show(); 
```

这是我在 Form2 中的代码：

```
Image<Bgr, byte> imResult;
public Form2(Image<Bgr, byte> imResult)
{
    InitializeComponent();
    this.imResult = imResult;
}

private void Form2_Load(object sender, EventArgs e)
{
    picBoxMatches.Image = imResult.ToBitmap();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:40:18.920

您可以向 Form2 添加一个新方法：

```
public UpdateImage(Image<Bgr, byte> imResult)
{
    this.imResult = imResult;
    picBoxMatches.Image = imResult.ToBitmap();
} 
```

然后在 Form1 中你可以这样做：

```
private Form2 form2;   // Some private field

// Inside the event handler
if (form2 == null)
    form2 = new Form2(imResult);
else
    form2.UpdateImage(imResult); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:49:26.170

把它放到全局范围内

```
public Form2 frmDrawMatchPoints = new Form2(); 
```

在 Form2 中创建具有相同参数的新函数以预览您的图片

```
public void PreviewPicture(Image<Bgr, byte> imResult)
{
    this.imResult = imResult;
} 
```

在 Form1 中，您应该只有：

```
Image<Bgr, byte> imResult =DrawMatches(imColor,Points1, imColorPrv,Points2,Indices, new Bgr(System.Drawing.Color.Yellow), new Bgr(System.Drawing.Color.Red);

frmDrawMatchPoints.PreviewPicture(imResult);
frmDrawMatchPoints.Show(); 
```

# c++ - C ++连接字符串导致“'const char *'和'const char类型的无效操作数”

> ID：15798623
> 
> 赞同：6
> 
> 时间：2013-04-03T21:37:19.707
> 
> 标签：c++, char, concat

我想连接两个字符串，但我得到错误，我不明白如何克服这个错误。

有没有办法将此 const char* 转换为 char？我应该使用一些取消引用吗？

```
../src/main.cpp:38: error: invalid operands of types ‘const char*’ and ‘const char [2]’ to binary ‘operator+’
make: *** [src/main.o] Error 1 
```

但是，如果我尝试以这种方式组成“底部”字符串，它会起作用：

```
bottom += "| ";
bottom += tmp[j];
bottom += " "; 
```

这是代码。

```
#include <iostream>
#include <fstream>
#include <vector>
#include <string>
#include <iterator>
#include <sstream>

int main(int argc, char* argv[]) {

    ifstream file("file.txt");

    vector<string> mapa;
    string line, top, bottom;

    while(getline(file,line)){
        mapa.push_back(line);
    }

    string tmp;
    for(int i = 0; i < mapa.size(); i++)
    {
        tmp = mapa[i];
        for(int j = 0; j < tmp.size(); j++)
        {
            if(tmp[j] != ' ')
            {
                top += "+---";
                bottom += "| " + tmp[j] + " ";
            } else {

            }
        }
        cout << top << endl;
        cout << bottom << endl;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T21:42:33.373

这里：

```
bottom += "| " + tmp[j] " "; 
```

您正在尝试对 a`char`和指向 的指针求和`char`。那是行不通的（它不会导致字符和指向的字符串文字的串联）。如果您在`+`之后添加一个符号也是如此`tmp[j]`，因为它仍将被评估为（添加额外的括号以强调`operator +`关联到左侧的事实）：

```
bottom += ("| " + tmp[j]) + " "; // ERROR!
//         ^^^^^^^^^^^^^
//         This is still summing a character and a pointer,
//         and the result will be added to another pointer,
//         which is illegal. 
```

如果您想将所有内容集中在一行中，只需执行以下操作：

```
bottom += std::string("| ") + tmp[j] + " "; 
```

现在，赋值右侧的上述表达式将被评估为：

```
(std::string("| ") + tmp[j]) + " "; 
```

由于定义`operator +`了 for a `std::string`and a`char`并返回 an `std::string`，因此计算括号内的子表达式的结果将是 an `std::string`，然后将其与字符串字面量相加`" "`，（再次）返回 an `std::string`。

最终，整个表达式的结果`(std::string("| ") + tmp[j]) + " "`在输入中给出`operator +=`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T21:40:31.097

看起来你的问题出在这一行：

```
bottom += "| " + tmp[j] " "; 
```

你缺少一个`+`between`tmp[j]`和`" "`。尝试将其更改为：

```
bottom += "| " + tmp[j] + " "; 
```

**编辑：**

以上仍会导致编译错误，而您使用 g++ 声明的错误，以下将起作用并产生最少的临时对象：

```
bottom += std::string("| ") + tmp[j] + " "; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T14:23:56.190

因为你要添加一个指针和一个字符，这样的操作是非法的。如果您不想在一行中完成，可以这样尝试：

字符串底部 = ""; 底部=底部+“|”+tmp[j]+“”；

这将正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T21:41:25.317

看起来您在 tmp[j] 和“”之间缺少一个 +。行应为

```
bottom += "| " + tmp[j] + " "; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T21:43:38.827

问题是

```
tmp[j] + " " 
```

这是不可能`operator+`的，没有为 char 定义。

但是`operator+`是为字符串定义的。所以你可以这样做

```
bottom += "| " 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-03T21:44:10.877

请记住，编译将评估 equals 语句的整个右侧，*然后在**其*`string::operator+=`上使用.

 *因此，编译器尝试评估`"| " + tmp[j] + " "`. 它看到的是一个 c-string、一个 char 和另一个 c-string。编译器无法以*任何*对您尝试执行的操作有意义的方式添加这些内容。

相反，您必须逐段连接，以便编译器知道查找`string`运算符，该运算符被重载以连接字符串，或者您可以将 c-strings 转换为 c++ 字符串，以便编译器知道使用 c++ 字符串：

```
bottom += string("| ") + tmp[j] + string(" "); 
```

在这种特定情况下，您可以放弃`string()`周围的`" "`IIRC，但这不是最好的方法。

在任何情况下，一次附加一个段是**告诉编译器你想要什么的最明确**的方式，也是你*应该*这样做的方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-03T21:46:44.220

```
 bottom += "| " + tmp[j] " "; 
```

这条线是你的问题，但不仅仅是缺少'+'。

您正在添加`"| "`and `tmp[j]`，第一个是“const char[3]”，第二个是“char”。这些不会增加任何有用的东西，但编译器会将您的 char 转换为 int，将 const char[3] 转换为 const char * 并将它们添加在一起。然后你尝试在这个 const char * 中添加一个“const char [2]”，此时它知道它不理解它——向指针添加一个数组？这就是您报告的错误消息 - 它发现了这个“const char *”和一个“const char [2]”，它无法弄清楚如何将它们加在一起。

从逻辑上讲，您正在尝试创建一个显示为“| ？”的字符串，其中 ? 替换为您的 tmp[j] 字符。但是，您不能像现在在这里那样使用字符串文字连接来做到这一点。一种可能的方法是使用 sprintf 将其放入字符串中并将其添加到底部。第二种解决方案是分别添加它们。第三种解决方案是首先将 tmp[j] 转换为 std::string 并添加 - 因为在 std::string 中添加“+”是已定义的有效操作。

简而言之，您已经被一些 C 遗留问题所困扰，C++ 在不破坏 C 兼容性的情况下无法修复这些遗留问题。

sprintf 的示例解决方案：

```
char buffer[5];
sprintf(buffer, "| %c ", tmp[j]);
bottom += buffer; 
```*

# java - Android SQLite CustomAdapter 和自定义 ListView

> ID：15798624
> 
> 赞同：2
> 
> 时间：2013-04-03T21:37:21.860
> 
> 标签：java, android, android-sqlite, android-adapter

我是一个非常新的 android 开发人员，我一直在尝试通过创建简单的应用程序来学习它。

现在，我一直在尝试为我的应用创建自定义 ListView。

我的数据存储在 SQLite 中，我将这些数据称为列表。我似乎找不到一个网站来演示如何让 SQLite 数据与自定义 ListView 一起使用。

以下是我的数据，我希望有人可以帮助我设置我的自定义适配器以使用我的 sqlite 数据。

**记录.java**

```
public class Records {
    private long id;
    private String name;
    private String type;
    private float mf;
    private float mftop;
    private float mfbot;
    private float mfleft;
    private float mfright;
    private float rf;
    private float rftop;
    private float rfbot;
    private float rfleft;
    private float rfright;
    private float tb;
    private float tbtop;
    private float tbbot;
    private float tbleft;
    private float tbright;
    private float bridge;
    private float bridgel;
    private float bridger;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    // Middle Finger
    public float getMF() {
        return mf;
    }

    public void setMF(float mf) {
        this.mf = mf;
    }

    public float getMFTop() {
        return mftop;
    }

    public void setMFTop(float mftop) {
        this.mftop = mftop;
    }

    public float getMFBot() {
        return mfbot;
    }

    public void setMFBot(float mfbot) {
        this.mfbot = mfbot;
    }

    public float getMFLeft() {
        return mfleft;
    }

    public void setMFLeft(float mfleft) {
        this.mfleft = mfleft;
    }

    public float getMFRight() {
        return mfright;
    }

    public void setMFRight(float mfright) {
        this.mfright = mfright;
    }

    //Ring Finger
    public float getRF() {
        return rf;
    }

    public void setRF(float rf) {
        this.rf = rf;
    }

    public float getRFTop() {
        return rftop;
    }

    public void setRFTop(float rftop) {
        this.rftop = rftop;
    }

    public float getRFBot() {
        return rfbot;
    }

    public void setRFBot(float rfbot) {
        this.rfbot = rfbot;
    }

    public float getRFLeft() {
        return rfleft;
    }

    public void setRFLeft(float rfleft) {
        this.rfleft = rfleft;
    }

    public float getRFRight() {
        return rfright;
    }

    public void setRFRight(float rfright) {
        this.rfright = rfright;
    }

    //Thumb
    public float getTB() {
        return tb;
    }

    public void setTB(float tb) {
        this.tb = tb;
    }

    public float getTBTop() {
        return tbtop;
    }

    public void setTBTop(float tbtop) {
        this.tbtop = tbtop;
    }
    public float getTBBot() {
        return tbbot;
    }

    public void setTBBot(float tbbot) {
        this.tbbot = tbbot;
    }
    public float getTBLeft() {
        return tbleft;
    }

    public void setTBLeft(float tbleft) {
        this.tbleft = tbleft;
    }
    public float getTBRight() {
        return tbright;
    }

    public void setTBRight(float tbright) {
        this.tbright = tbright;
    }

    //Bridge
    public float getBridge() {
        return bridge;
    }

    public void setBridge(float bridge) {
        this.bridge = bridge;
    }

    public float getBridgeL() {
        return bridgel;
    }

    public void setBridgeL(float bridgel) {
        this.bridgel = bridgel;
    }

    public float getBridgeR() {
        return bridger;
    }

    public void setBridgeR(float bridger) {
        this.bridger = bridger;
    }

    //Will be used by the ArrayAdapter in the ListView
    @Override
    public String toString() {
        return name;
    }

} 
```

**CustomAdapter.java**

```
public class CustomAdapter extends ArrayAdapter<NTAdapter> {

    Context context;
    int layoutResourceId;
    NTAdapter data[] = null;

    public CustomAdapter(Context context, int layoutResourceId, NTAdapter[] data) {
        super(context, layoutResourceId, data);
        // TODO Auto-generated constructor stub
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.data = data;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // TODO Auto-generated method stub

        View row = convertView;
        DataHolder holder = null;

        if (row == null) {
            LayoutInflater inflater = ((Activity)context).getLayoutInflater();
            row = inflater.inflate(layoutResourceId, parent, false);

            holder = new DataHolder();
            holder.dataName = (TextView)row.findViewById(R.id.dataName);
            holder.dataType = (TextView)row.findViewById(R.id.dataType);

            row.setTag(holder);
        } else {
            holder = (DataHolder)row.getTag();
        }

        NTAdapter ntadapter = data[position];
        holder.dataName.setText(ntadapter.name);
        holder.dataType.setText(ntadapter.type);

        return row;
    }

    static class DataHolder {
        TextView dataName;
        TextView dataType;
    }

} 
```

**NTAdapter.java**

```
public class NTAdapter {

    public int id;
    public String name, type;

    public NTAdapter() {
        super();
    }

    public NTAdapter(int id, String name, String type) {
        super();
        this.id = id;
        this.name = name;
        this.type = type;
    }
} 
```

**数据布局.java**

```
public class DataLayout extends ListActivity {
    private RecordsDataSource datasource;

    Button btnDataCancel;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.data_layout);

        datasource = new RecordsDataSource(this);
        datasource.open();

        List<Records> values = datasource.getAllRecords();

        //use the SimpleCursorAdapter to show the
        //elements in a ListView
        ArrayAdapter<Records> adapter = new ArrayAdapter<Records>(this, android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);

        /**
        CustomAdapter adapter = new CustomAdapter(this, R.layout.data_layout_listview, values);
        listView1 = (ListView)findViewById(R.id.listView1);

        listView1.setAdapter(adapter);
        */

        Button btnDataCancel = (Button)findViewById(R.id.btnDataCancel);

        //Cancel Button
        btnDataCancel.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {
                //Starting a new Intent
                Intent goMain = new Intent(getApplicationContext(), MainActivity.class);

                startActivity(goMain);
                finish();
            }
        });
    }

    @Override
    protected void onResume() {
        datasource.open();
        super.onResume();
    }

    @Override
    protected void onPause() {
        datasource.close();
        super.onPause();
    }

} 
```

请注意，在我的 DataLayout.java 中，我一直在尝试让我的 sqlite 数据与我的自定义列表视图设置一起使用。

```
 /**
        CustomAdapter adapter = new CustomAdapter(this, R.layout.data_layout_listview, values);
        listView1 = (ListView)findViewById(R.id.listView1);

        listView1.setAdapter(adapter);
        */ 
```

我知道我的问题是我的 NTAdapter.java 和我的 CustomAdapter.java 没有正确设置。但是，我不知道如何修复它，以便它接受存储在***值中的数据列表***

由于代码开始变得太长而无法阅读，我没有发布我的其他课程。但请注意，如果我不使用自定义列表视图，一切正常，因为它还没有工作。

任何帮助将不胜感激。先感谢您。

编辑：另外，我知道 NTAdapter 并不是真正需要的，但我不知道如何制作它，以便我的 CustomAdapter.java 将从我的**值**中获取数据并使用它们来设置我的自定义 ListView。

编辑2：对于那些想知道什么是**值**的人，请参阅**DataLayout.java**。

.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T05:20:12.513

您在制作 CustomAdapter 时所做的是尝试将 List 传递给接受 NTAdapter array 的构造函数。所以你的程序不应该正常工作。

您可以做的是使您的 CustomAdapter 类类似于以下内容：

```
public class CustomAdapter extends ArrayAdapter<Records> {

Context context;
int layoutResourceId;
List<Records> data;

public CustomAdapter(Context context, int layoutResourceId, ArrayList<Records> data) {
    super(context, layoutResourceId, data);
    // TODO Auto-generated constructor stub
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.data=data;

}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub

    View row = convertView;
    DataHolder holder = null;

    if (row == null) {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent, false);

        holder = new DataHolder();
        holder.dataName = (TextView)row.findViewById(R.id.dataName);
        holder.dataType = (TextView)row.findViewById(R.id.dataType);

        row.setTag(holder);
    } else {
        holder = (DataHolder)row.getTag();
    }

    Records records = data.get(position);
    holder.dataName.setText(records.getName());
    holder.dataType.setText(records.getType());

    return row;
}

static class DataHolder {
    TextView dataName;
    TextView dataType;
} 
```

# ssis - 在 SSIS Foreach 循环中为 HTTP 连接管理器动态构造 URL

> ID：15798625
> 
> 赞同：0
> 
> 时间：2013-04-03T21:37:22.040
> 
> 标签：ssis

我有一个带有 Foreach 循环容器的 SSIS 2012 包。对于每条数据，我想构建一个 URL 并下载该 URL 的内容。我似乎无法让连接的 ServerUrl 属性包含来自 Foreach 容器的当前数据。

# android - 在运行时在 TextView 中设置文本

> ID：15798628
> 
> 赞同：1
> 
> 时间：2013-04-03T21:37:40.357
> 
> 标签：android, textview, runtime, settext

我是 Android 开发的新手，所以我可能会淹死在一英寸的水中......
我有一个 layout.xml 文件，其中包含一个 TextView 和一些按钮，设置在我需要的位置。有没有办法只更改显示的文本而不必以编程方式重新创建整个布局？谢谢你的耐心:D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T21:40:30.240

在定义你的`TextView`in之后`onCreate()`，只需调用`setText(string)`property。

***编辑：***

```
setContentView(R.layout.your_current_layout);
TextView mytextview = (TextView) findViewById(R.id.textView1);
mytextview.setText("I'm called from your activity"); 
```

享受 ：-）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:44:07.053

在你调用 setContentView( )**之后在**你的 onCreate() 里面放这个：

```
TextView tv = (TextView)findViewById(R.id.textView1);
tv.setText("Some new text"); 
```

并从布局内部替换`textView1`为 TextView 的 ID，应该是这样的：

```
<TextView
...
...
android:id="@+id/textView1" /> 
```

斜线后面的`@+id/`内容是您需要添加的内容`R.id.`

如果你没有一条`android:id`线，那就创建一条。

# search - 在 vi/vim 中，是否可以创建映射以将单词连接到动态搜索？

> ID：15798631
> 
> 赞同：2
> 
> 时间：2013-04-03T21:37:47.413
> 
> 标签：search, mapping, vi

这个问题最好用一个例子来说明。

例句：

> 鲍勃去了商店。鲍勃买了一个苹果。鲍勃离开了商店。

我将光标放在“Bob”上并点击*（shift-8）在文本中搜索“Bob”。现在我想将光标放在“商店”上并点击 *（或我选择的任何其他键）现在搜索`/\<Bob\>\|\<store\>`.

这样做的目的是避免必须单独键入每个单词。

这是可行的吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:56:54.137

您可以录制一个宏来执行此操作：

*   `q``q`- 在寄存器中记录一个宏`q`

*   `y``i``w`- 抽入单词（光标下的新搜索词）

*   `/`- 开始搜索

*   ``<C-R>```/`- 将以前的搜索词粘贴到新搜索中

*   `\``|``\``<``|`-为“或”添加文字并`<`匹配单词的开头

*   ``<C-R>```0`- 将抽出的新搜索词粘贴到新搜索中

*   `\```>````<CR>``- 匹配工作的结束并进行搜索

*   `q`- 停止录制宏

然后按下`@``q`会将光标下的单词附加到上一个搜索中。

当然，如果您愿意，也可以创建一个映射。

（请注意，前两个按键 ( `<C-R>`) 是 Control-R，而第三个 ( `<CR>`) 是回车/Enter。）

# wordpress - Wordpress 切换主题 - 没有帖子

> ID：15798632
> 
> 赞同：0
> 
> 时间：2013-04-03T21:37:48.527
> 
> 标签：wordpress, wordpress-theming

我的问题很奇怪。我在 Wordpress 3.5.1 中安装了两个主题。其中之一是 Wordpress 的默认设置 - Twenty Twelve。这个工作正常，我的意思是它显示数据库中的所有帖子。另一个从某个域复制的主题，根本没有显示任何帖子！

我还启用了调试，但我看不到任何消息可以通知我有关数据库的一些问题...

# linux - tinymce - Chrome 中的 vnc 粘贴问题

> ID：15798637
> 
> 赞同：2
> 
> 时间：2013-04-03T21:38:22.040
> 
> 标签：linux, google-chrome, tinymce, copy-paste, vnc

我有一个最奇怪的问题：当我将几行从 realVNC（来自 linux xterm）复制到 Chrome 中的 tinymce textarea 时，每个空白区域都被折叠成一个（也在 tinymce 网站中给出的完整示例中）。在任何其他浏览器中它都能完美运行（在 Chrome 中的任何非 tinymce textarea 输入中也是如此）更奇怪的是，如果我只粘贴带有几个相邻空格的行的一部分，它也能正常工作，但如果我标记一个几行，就显得不对了。

示例：“sdf sdf” - 仅复制该文本时。“sdf sdf” - 复制整行时。

我花了 4-5 个小时寻找解决方案，但我一无所获（我通常是通过互联网寻找解决方案的大师）......

谁能帮忙，这真的困扰着我和我的整个团队（~25人）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T09:49:52.570

一种解决方案是先粘贴到 word 中，然后将其复制并粘贴到 tinymce 中，它要么剥离空白，要么不将其转换为非空白空白。

# amazon-ec2 - IP 地址重新映射

> ID：15798648
> 
> 赞同：2
> 
> 时间：2013-04-03T21:38:58.847
> 
> 标签：amazon-ec2, ip-address

我不知道如何准确地提出我的问题，但我会尝试解释我的要求。

我有一家开发 gps 设备的公司，每个设备都安装在单独的车辆上。设备的固件具有硬编码的 IP 地址，它们将当前数据发送到该地址。

我在公司有一台服务器，可以接受来自设备的数据。然而，业务正在增长，我不想冒险使用它。这就是为什么我正在考虑将服务器的软件转移到亚马逊 EC2 上。

在此之前，我想知道是否可以在亚马逊 EC2 服务上使用我当前的 IP 地址，因为无法更改设备固件上硬编码的 IP 地址。

所以让我们总结一下情况。

*   A <-- 带有固件的 Gps 设备将数据发送到地址 xyzw
*   B <-- 带有接受来自A的数据的特殊软件的服务器。服务器IP是xyzw
*   C <-- 具有 IP 地址的 Amazon EC2 服务：abcd

我想摆脱服务器 B。所以 A ->> 将数据发送到 ->> 服务器 C。

如何配置服务器 C 使其使用服务器 B 的 IP 地址（记住服务器 C 位于不同的县，具有不同的 IP 地址范围）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:52:50.697

这是我要做的，请记住，我不知道建立什么样的连接的细节。

硬编码的 IP 地址将映射到您的站点/数据中心的负载平衡器/代理。这将平衡您站点上或运行应用程序软件的 ec2 上的一台或多台服务器之间的流量。

出于高可用性的目的，我会在负载均衡器上配置一个心跳监视器，以便在它发生故障时故障转移到备用负载均衡器。

您仍然有一个故障点，即如果您的站点出现故障，将很难将流量重定向到另一个站点。

# google-chrome - 如何将 OpenCv 移植到 NaCl

> ID：15798649
> 
> 赞同：2
> 
> 时间：2013-04-03T21:39:08.577
> 
> 标签：google-chrome, opencv, google-nativeclient

有谁知道如何将 OpenCV 移植到 NaCl？我正在尝试基于人脸识别制作 Chrome 扩展。我会很感激一些帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-13T22:46:15.853

为方便起见，以下详细说明已从（现已失效的~~metacaptcha.com/install_opencv_nacl~~）重新发布。

# 1\. 先决条件

OpenCV 依赖于几个重要的库，如 bzip2、zlib、NaclMounts 和至少一个解压缩/压缩库来处理常见的图像，如 libpng/jpeg/tiff。本文将只关注 libjpeg。这些库需要使用 NaCl Glibc 工具链 (Pepper 28) 在 32 位和 64 位架构师中构建为动态库。

为了构建 NaCl 的 32 位和 64 位共享库，需要分别使用 32 位和 64 位版本的 NaCl gcc/linker。为了在本教程中更容易做到这一点，我们制作了以下环境变量：

注意：如果文章中的某个链接失效，可以在[此处](https://github.com/blquythai/opencv-nacl-ports)找到备份链接。

```
export NACL_SDK_ROOT=/Users/thai/apps/nacl_sdk/pepper_28
export NACL_PREFIX="$NACL_SDK_ROOT"/toolchain/mac_x86_glibc/x86_64-nacl
export NACL_64="$NACL_SDK_ROOT"/toolchain/mac_x86_glibc/bin/x86_64-nacl
export NACL_32="$NACL_SDK_ROOT"/toolchain/mac_x86_glibc/bin/i686-nacl 
```

## 1.1 原生客户端的 Bzip2

下载[Bzip2 v1.0.6](http://bzip.org/1.0.6/bzip2-1.0.6.tar.gz)，解压到本地目录。Makefile-libbz2_so 是我们要用于的文件`make`，我们要更改 gcc 工具链参数，以便`gcc`使用 $NACL_SDK_ROOT/toolchain/mac_x86_glibc/x86_64-nacl/bin/ 中的 NaCl gcc而不是使用常规 OS .

使用以下参数在 bzip2 上运行`make -f Makefile-libbz2_so`，然后将库复制到 NaCl 工具链中。

```
make -f Makefile-libbz2_so CC=$NACL_64-'gcc -m64'
cp libbz2.so.1.0.6 $NACL_PREFIX/lib64/libbz2.so
make clean
make -f Makefile-libbz2_so CC=$NACL_32-'gcc -m32'
cp libbz2.so.1.0.6 $NACL_PREFIX/lib32/libbz2.so
cp *.h $NACL_PREFIX/include 
```

## 1.2 原生客户端的 Zlib

下载[Zlib-1.2.8](http://zlib.net/zlib-1.2.8.tar.gz)，解压到本地目录。Zlib 使用 autoconfig 生成 Makefile，我们需要先运行这个工具，然后将 GCC 工具链修改为 NaCl 工具链。

`./configure --enable-shared`在 zlib 上运行，然后使用`make`以下参数运行。

```
./configure --enable-shared
make shared CC=$NACL_64-'gcc -m64' AR=$NACL_64-ar ARFLAGS=rc CFLAGS='-O3 -DHAVE_HIDDEN'                     LDFLAGS='-O3 -fPIC -DHAVE_HIDDEN' LDSHARED='$(CC) -shared -Wl,-soname -Wl,libz.so'     SHAREDLIB=libz.so SHAREDLIBM=libz.so.1.2.8 SHAREDLIBV=libz.so.1
cp libz.so.1 $NACL_PREFIX/lib64/libz.so
make clean
make shared CC=$NACL_32-'gcc -m32' AR=$NACL_32-ar ARFLAGS=rc CFLAGS='-O3 -DHAVE_HIDDEN' LDFLAGS='-O3 -fPIC -DHAVE_HIDDEN' LDSHARED='$(CC) -shared -Wl,-soname -Wl,libz.so' SHAREDLIB=libz.so SHAREDLIBM=libz.so.1.2.8 SHAREDLIBV=libz.so.1
cp libz.so.1 $NACL_PREFIX/lib32/libz.so
cp zlib.h zconf.h $NACL_PREFIX/include 
```

## 1.3 本地客户端的 libJPEG

下载[jpeg-v6b](http://sourceforge.net/projects/libjpeg/files/libjpeg/6b/) , [NaCl jpeg makefile.cfg 补丁](https://raw.github.com/blquythai/opencv-nacl-ports/master/nacl-jpeg-v6b-makefile.cfg.patch)并将它们放到你的本地目录中。

使用 nacl-jpeg-makefile.cfg 修补程序修补 jpeg-v6b 目录。

```
cd jpeg-6b
patch < nacl-jpeg-v6b-makefile.cfg.patch 
```

`./configure`在 jpeg-6b 上运行，然后使用`make libjpeg.so`以下参数运行。

```
./configure
make libjpeg.so CC=$NACL_64-gcc CFLAGS='-m64 -fPIC -O2 -I.' LDFLAGS='-shared -Wl,-soname -Wl,libjpeg.so -o libjpeg.so'
mv libjpeg.so $NACL_PREFIX/lib64/libjpeg.so
make clean
make libjpeg.so CC=$NACL_32-gcc CFLAGS='-m32 -fPIC -O2 -I.' LDFLAGS='-shared -Wl,-soname -Wl,libjpeg.so -o libjpeg.so'
mv libjpeg.so $NACL_PREFIX/lib32/libjpeg.so
make install-headers prefix=$NACL_PREFIX 
```

## 1.4 本地客户端的 NaclMounts

下载[NaclMounts](https://github.com/austinbenson/nacl-mounts) , [nacl-mounts.patch](https://raw.github.com/blquythai/opencv-nacl-ports/master/nacl-mounts/nacl-mounts.patch)和我们[自定义的 Makefile](https://raw.github.com/blquythai/opencv-nacl-ports/master/nacl-mounts/Makefile) 进入本地 nacl-mount 目录，将 Makefile 复制到该目录，应用补丁并运行以下命令（假设您已经在文章开头设置了环境变量)

```
cp Makefile nacl-mounts/
cd nacl-mounts/
patch -p0 < ../nacl-mounts.patch
make ARCH=x86_64 BIT=64
cp libnaclmounts.so $NACL_PREFIX/lib64
make clean
make ARCH=i686 BIT=32
cp libnaclmounts.so $NACL_PREFIX/lib32
make install-headers 
```

# 2\. 本机客户端的 OpenCV

OpenCV 需要以交叉编译模式构建，以便使用 cmake（OpenCV 的构建工具）轻松完成。我们设置 CMAKE_SYSTEM_NAME=Linux 来强制 Linux 目标的交叉编译。如果您已经在上一步中设置了环境变量，则会编写一个 OpenCV-nacl-cmake 脚本以促进构建过程。

## 2.1 设置源代码

下载[OpenCV 2.4.2](http://sourceforge.net/projects/opencvlibrary/files/opencv-unix/2.4.2/) , [opencv-nacl-cmake 脚本](https://raw.github.com/blquythai/opencv-nacl-ports/master/opencv/opencv-nacl-cmake) 将 OpenCV 解压到本地目录。

在 OpenCV-2.4.2/ 中创建`nacl/m32`,`nacl/m64`目录，用于构建 32/64 位版本的 OpenCV Native Client 代码。

将 opencv-nacl-cmake 脚本复制到 nacl/ 目录中。

```
tar xvf OpenCV-2.4.2.tar.gz
cd OpenCV-2.4.2
mkdir nacl
cd nacl
mkdir m64 m32
cp ~/Downloads/opencv-nacl-cmake ./ 
```

## 2.2 修补 OpenCV I/O 库 (persistance.cpp) / 排除应用程序的构建

为了让 OpenCV 在 Native Client 中读取/写入文件，需要使用新的文件系统库。此补丁用 NaclMounts 库替换文件 I/O 的所有操作系统系统调用。

下载OpenCV 2.4.2 的[persistance.cpp 补丁](https://raw.github.com/blquythai/opencv-nacl-ports/master/opencv/opencv-nacl-persistance.patch)将补丁复制到您的 OpenCV 目录，并使用这些命令应用路径

```
cp ~/Download/opencv-nacl-persistance.patch OpenCV-2.4.2
cd OpenCV-2.4.2
patch -p0 < opencv-nacl-persistance.patch 
```

我们还需要告诉 cmake 排除 OpenCV 中的应用程序模块（应用程序模块不需要移植）。这可以通过简单地移动应用目录中的 CMakeList.txt 文件来完成

```
mv apps/CMakeList.txt apps/CMakeList.txt.old 
```

## 2.3 配置、构建和安装

使用以下参数运行 ./opencv-nacl-cmake 来配置和构建库。以下 bash 命令还为 OpenCV 安装 32 位和 64 位版本的库。由于 Native Client 的命名约定，我们必须移动 lib/、lib32/、lib64/ 目录才能正确安装架构。

```
cd nacl/m32                                             
../opencv-nacl-cmake i686 32 
make -j8
unlink $NACL_PREFIX/lib64
mv $NACL_PREFIX/lib $NACL_PREFIX/lib64
mv $NACL_PREFIX/lib32 $NACL_PREFIX/lib
ln -s $NACL_PREFIX/lib $NACL_PREFIX/lib32
make install 
unlink $NACL_PREFIX/lib32
mv $NACL_PREFIX/lib $NACL_PREFIX/lib32
mv $NACL_PREFIX/lib64 $NACL_PREFIX/lib
ln -s $NACL_PREFIX/lib $NACL_PREFIX/lib64
cd ../m64
../opencv-nacl-cmake x86_64 64
make -j8
make install 
```

至此，您已完成为 Native Client Pepper 28 安装 OpenCV 2.4.2。

可以在[example_opencv_nacl_facedetect](http://metacaptcha.com/example_opencv_nacl_facedetect)中找到一个改编自 OpenCV 教程以在 Google Chrome 中执行人脸检测的简单应用程序。

# jquery - jquery jtable 自定义点击事件动作路由

> ID：15798650
> 
> 赞同：1
> 
> 时间：2013-04-03T21:39:09.220
> 
> 标签：jquery, jquery-jtable

这是此处回答的问题的后续问题：

[jquery jtable自定义点击事件](https://stackoverflow.com/questions/15600665/jquery-jtable-custom-click-event#new-answer)

我需要将类似于 listAction 或 DeleteAction 的操作路由回服务器，而不是仅在按下按钮时执行 alert()。

1）如何设置按钮单击以触发此自定义操作？2）我可以传入警报示例（data.record.tableID）之类的值吗？

类似这样的东西，但我只是编了一个名为 jTableAjax 的函数名称，我需要知道一个真正类似的 jtable 函数来触发一个动作 ajax 调用：

```
 CustomAction: {
                    title: 'Refresh',
                    width: '1%',
                    sorting: false,
                    create: false,
                    edit: false,
                    list: true,
                    display: function (data) {
                        if (data.record) {
                            return '<button title="Refresh '+data.record.table+'"           class="jtable-command-button jtable-edit-command-button" onclick="jTableAjax('/myurlserverpath/myaction',' + data.record.tableID + '); return false;"><span>Refresh '+data.record.table+'</span></button>';
                        }
                    }
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:00:25.567

我最终使用了 jquery 内置的 ajax 处理程序，然后在 jtable 上重新加载，如下所示：

在 jtable 自定义字段定义上，我调用了自己的 refreshTable 函数：

```
 display: function (data) {
                    if (data.record) {
                        return '<button title="Refresh'+data.record.table+'" class="jtable-command-button jtable-edit-command-button" onclick="refreshTable(data.record.table); return false;"><span>Refresh '+data.record.table+'</span></button>';
                    } 
```

然后我用 jquery 处理 ajax 请求来做一些服务器端 mojo，然后如果成功，重新加载 jtable：

```
function refreshTable(table) {
   $.post("/myurlpath/refreshTable", "table="+table,
       function(results)
       {
           $('#MyTableDiv').jtable('reload');
       }
       , "json");
 } 
```

我在帖子中为代码可读性而放弃了 ajax 错误处理，但这处理了我需要的（从自定义 jtable 按钮调用服务器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-12T13:10:53.237

这已经很老了，但我有类似的任务，所以我会分享我的解决方案。一般来说，您不应该在按钮中添加“onclick”。最好给按钮属性相同的值，让我们说'name =“button1”'并将按钮id设置为记录的id，所以'id =“data.record.Id”'。您可以使用 jQuery .live 事件[http://api.jquery.com/live/](http://api.jquery.com/live/)将处理程序附加到所有这些元素上。你应该最终得到类似的东西

```
 $('[name="button1"]').live('click', function() {
        var id = $(this).attr('id');
    }); 
```

拥有 row 的 ID 让您在接下来可以做什么方面有很大的自由度。

如果您需要处理当前存储在 jTable 中的数据 - 您通过 jTable POST 请求获得的数据（例如一些隐藏字段，未显示的数据等），您也可以轻松访问它。它很简单

```
 var row = $('#NoteTable').jtable('getRowByKey', id).data('record'); 
```

viola，当涉及到行数据时，您可以访问您可能想要的所有内容。您也可以通过向服务器发送请求来获取这些数据（因为我们得到了 ID），但这会产生不必要的流量。

# internet-explorer - Internet Explorer 8 无响应滚动条

> ID：15798653
> 
> 赞同：1
> 
> 时间：2013-04-03T21:39:25.907
> 
> 标签：internet-explorer, internet-explorer-8, scrollbar

有问题的页面在[*链接不再有效*]上，只能在IE8（XP Pro）中重现。

我在页面上有两个滚动条，一个用于导航菜单，一个用于主页。可以使用鼠标滚轮控制左侧的滚动区域，但滚动条控件不起作用（向上/向下箭头，单击并拖动箭头）。右侧滚动条按预期工作。（顺便说一句，您可以通过单击“阵容”在导航中添加更多内容以使其滚动到更高的高度）

我似乎找不到其他任何人遇到过这种行为，而且我不确定如何调试它。我尝试重新创建多个滚动窗格，有/没有绝对定位、各种 z 索引和调整元素大小。有人有什么想法吗？

# c# - 以 Windows 形式运行另一个应用程序

> ID：15798656
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:39:40.830
> 
> 标签：c#, winforms, vbscript

正在创建一个 Windows 窗体，称之为测试，好的，这个程序应该在其中运行 firefox 浏览器，我将如何实现这一点？搜遍了全网，没有解决办法，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T21:45:10.837

没有办法实现 Firefox 作为窗口的一部分运行。您可以使用[Process.Start](http://msdn.microsoft.com/cs-cz/library/system.diagnostics.processstartinfo.aspx)。或者您可以使用将成为 IE 窗口的浏览器元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:44:15.777

我认为您不能在表单内运行应用程序，但是您可以通过以下方式启动应用程序：

```
Process.Start("<insert file name and path>") 
```

# c - 为什么函数 `memchr()` 使用 `int` 作为 `char` 类型的参数？

> ID：15798661
> 
> 赞同：7
> 
> 时间：2013-04-03T21:39:52.003
> 
> 标签：c, char

以下函数`int`用作第二个参数类型，

```
memchr(const void *buf, int ch, size_t count); 
```

虽然它用于一种`character`类型。为什么定义函数`int`用于类型参数`char`？这有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T21:49:22.887

之所以如此，是因为这是一个非常“古老”的标准函数，从 C 语言演化的早期就存在。

旧版本的 C 没有*函数原型*之类的东西。函数要么未声明，要么使用“未知”参数列表声明，例如

```
void *memchr(); /* non-prototype declaration */ 
```

调用此类函数时，所有参数都会自动进行*参数提升*，这意味着此类函数永远不会接收到`char`or类型的参数值`short`。这样的参数总是被调用者隐式提升为 type`int`并且函数本身实际上收到了一个`int`. （对于如上所示声明的函数，即没有原型的现代 C 语言，这仍然是正确的。）

*当 C 语言最终发展到引入原型*函数声明的地步时，重要的是使新声明与标准函数的遗留行为和已编译的遗留库保持一致。

这就是为什么您永远不会在遗留函数声明的参数列表中看到此类类型`char`的原因。`short`出于同样的原因，您也不会看到`float`那里使用的类型。

* * *

这也意味着，如果由于某种原因您必须为以 K&R 样式定义的某些现有遗留函数提供原型声明，则必须记住在原型中指定*提升*的参数类型。例如对于定义为的函数

```
int some_KandR_function(a, b, c)
char a;
short b;
float c;
{
} 
```

正确的原型原型声明实际上是

```
int some_KandR_function(int a, int b, double c); 
```

但不是

```
int some_KandR_function(char a, short b, float c); // <- Incorrect! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T21:43:23.607

因为`char`、`signed char`和`unsigned char`是三种不同的类型。在特定的实现中，您不知道`char`是签名还是未签名。

除了在罕见的系统中（参见 Keith 的注释），类型`int`包含这三种类型可以具有的所有值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T21:46:23.823

所有处理字符的标准函数都可以。我认为部分原因是历史原因（在某些 C 的预标准版本中，函数不能接受`char`or`unsigned char`参数，就像 varargs 参数不能具有字符类型一样），部分原因是所有此类函数的一致性。

为了允许 EOF 的可能性，*必须*使用一些字符处理函数，但不是其中之一。`int``memchr`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-27T05:40:13.187

C 从不将小于 int 的参数传递给函数。将函数参数定义为 char 或 short 始终提升为 int，定义 unsigned char 或 unsigned short 参数始终提升为 unsigned int。
如果 unsigned 与 signed char 是问题，他们会使用短（我不记得短是 1 字节长的单个平台）。
当然，使用 int 可以处理 unsigned 与 signed char 的可能性，因为 memchr 只是比较相等性。

# sql-server - MVC：将类连接到数据库函数/存储过程的结果

> ID：15798662
> 
> 赞同：0
> 
> 时间：2013-04-03T21:39:55.393
> 
> 标签：sql-server, asp.net-mvc, data-binding, sql-function

如何在 MVC 中执行 SQL 函数？

我正在尝试将表返回函数的结果链接到我定义的类。我已经设置了连接字符串并创建了数据库上下文，`public DbSet<Classname> variable{get; set;}`如何将其链接到函数的结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:34:31.047

你在使用实体框架吗？这是一篇你可以阅读的文章：

[http://rationalgeek.com/blog/function-imports/](http://rationalgeek.com/blog/function-imports/)

# c++ - C++ - 读取文件行

> ID：15798666
> 
> 赞同：0
> 
> 时间：2013-04-03T21:40:08.767
> 
> 标签：c++

我使用以下代码读取包含名字和姓氏的文件。

名字姓氏

名字姓氏

```
do
{   in >> tmp2;
    cout << tmp2;
} while(tmp2 != '\n'); 
```

然而，这并没有检测到行尾，所以当我得到一个无限循环时我无法前进。注意 tmp2 是一个字符。

我怎样才能解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:41:54.147

```
#include <iostream>
#include <fstream>
using namespace std;

int main() {   

    ifstream fin("file");
    string first, last, comment;
    while (fin >> first >> last) {
        cout << first << ' ' << last << endl;
        getline(fin, comment); // get the rest annoying strings
    }
    fin.close();

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:52:11.793

一种解决方案：使用字符串流

```
std::stringstream sstrm;
std::string instr;
while (std::getline(std::cin, instr)) {
    sstrm.str(instr);
    std::string fname, lname;
    sstrm >> fname >> lname;
    std::cout << fname << ' ' << lname << '\n';
} 
```

这会丢弃一行中前两个标记之后的任何内容。

# javascript - 使用 Jquery 解析字符串

> ID：15798678
> 
> 赞同：0
> 
> 时间：2013-04-03T21:40:54.993
> 
> 标签：javascript, jquery, string, parsing

## [jsFiddle](http://jsfiddle.net/EyVuS/1/)

我有一个简单的选择菜单，其中包含所有国家/地区，其城市在各自的选项值中列出。该值还包含一些其他数据，例如`Canada`has value`+1|}|22|X`而`United States`has this`+1|}|128|X||{|58$Abilene#|{|59$Akron#|{|1$Alabama#|{|2$Alaska#|{|60$Albany#|....`

我需要在更改国家/地区选择菜单时填写另一个选择菜单。我不知道如何解析该国价值中列出的每个城市。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:58:27.773

也许试试这个，idk，那个数据有点奇怪：

```
$('#country_residence').on('change', function () {
    var cities = $(this).val().split('$');
    $("#cities option").remove();
    for(var i = 1;i<cities.length;i++)
    {
     var city = String(cities[i]);
        if(city.indexOf("#")>-1)
            city = city.substring(0,city.indexOf("#"));

        $("#cities").append("<option>" + city + "</option>");
    }
}); 
```

**jsFiddle**：http: [//jsfiddle.net/EyVuS/3/](http://jsfiddle.net/EyVuS/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:58:48.107

*如果*绝对没有其他方法可以获得更清洁的数据？我会在服务器端进行一些（尽管有点令人费解）正则表达式匹配以过滤信息，然后将其解析为可用的列表以与 JSON 一起使用。

一方面，我不会尝试在客户端执行此操作。

# python - 如何通过地址/偏移量/字节使用 python 编辑可执行文件，就像在十六进制编辑器中一样？

> ID：15798681
> 
> 赞同：0
> 
> 时间：2013-04-03T21:41:02.460
> 
> 标签：python

我已经使用 Hex-rays IDA 来查找我需要在 Windows 可执行文件中更改的代码字节。我想编写一个 python 脚本，以编程方式编辑这些字节。

我知道地址（在 hex-rays IDA 中给出）并且我知道我希望用它覆盖它的十六进制。我如何在python中做到这一点？我确定有一个简单的答案，但我找不到。

（例如：地址 = 0x00436411，新的十六进制 = 0xFA）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T21:45:13.680

您只需将可执行文件作为文件打开，以二进制模式进行写入；然后寻找你想写的位置；然后写。所以：

```
with open(path, 'r+b') as f:
    f.seek(position)
    f.write(new_bytes) 
```

如果您要更改大量字节，您可能会发现使用起来更简单[`mmap`](http://docs.python.org/2/library/mmap.html)，这让您可以将文件视为一个巨大的`list`：

```
with open(path, 'r+b') as f:
    with contextlib.closing(mmap.mmap(f.fileno(), access=mmap.ACCESS_WRITE)) as m:
        m[first_position] = first_new_byte
        m[other_position] = other_new_byte
        # ... 
```

如果您尝试写入多字节值（例如，32 位 int），您可能想要使用该[`struct`](http://docs.python.org/2/library/struct.html)模块。

* * *

如果您知道的是*运行时内存中的地址*，而不是*文件位置*，那么您必须能够将其映射到可执行文件中的正确位置。这甚至可能是不可能的（例如，内存映射区域）。但如果是，您应该能够从调试器中找出它映射的位置。从调试器内部，这很容易；从外面看，你需要解析PE头结构并做很多复杂的逻辑，没有理由这样做。

我相信当使用 hex-ray IDA 作为静态反汇编程序时，在所有默认设置下，它给你的地址是代码和数据段将被映射到内存中的地址，如果它们不被强制重定位的话。显然，这些不是文件中的偏移量。

# scala - 在 Scala 中混合动态对象和结构类型

> ID：15798685
> 
> 赞同：1
> 
> 时间：2013-04-03T21:41:17.053
> 
> 标签：scala

是否有可能做到这一点？（我使用的是 scala 2.10）调用一个方法，该方法要求对象具有一个名为“fullName”的函数，但该对象是使用 Dynamic trait 构建的。编译器抱怨，但也许我做错了。

我不需要这个来做任何工作，我只是在学习语言。

```
import scala.language.dynamics

object Main extends App {

    class MyStatic {

        private var privateName = ""
        var lastName = ""

        def name_= (n: String) {
            privateName = n
        }

        def name = s"***$privateName***"

        def fullName = s"$name $lastName"

    }

    class MyDynamic extends scala.Dynamic {

        val map = collection.mutable.Map[String, String]()

        def selectDynamic(key: String): String = map(key)

        def updateDynamic(key: String)(value: String) {
            map += key -> value
        }

        def applyDynamic(key: String)(value: Any*) = key match {
            case "fullName" => {
                val name = map("name")
                val lastName = map("lastName")
                s"$name $lastName"
            }
        }

    }

    def showFullName(o: { def fullName: String }) = s"My full name is $o.fullName"

    println("Starting App...")

    val s = new MyStatic
    s.name = "Peter"
    s.lastName = "Parker"
    println(showFullName(s))

    val d = new MyDynamic
    d.name = "Bruce"
    d.lastName = "Wayne"
    println(showFullName(d))

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:55:41.313

结构类型`{ def fullName: String }`基本上意味着“任何具有名为`fullName`返回 a`String`的 无参数方法的类型`MyDynamic`都没有这样的方法，因此不符合这种结构类型。`MyDynamic`扩展的事实`scala.Dynamic`是无关紧要的：这意味着对于它的任何实例，你可以执行*看起来*像是对 的调用`fullName`，但这并不意味着`MyDynamic`（作为一种类型）具有任何此类成员。

所以简短的回答是**否定**的，你不能将动态对象与结构类型混合在一起。

为了完整起见，我必须补充一点，它*可以*按您的预期工作，但它需要编译器的特殊规定（即，编译器可以考虑比任何类型扩展`scala.Dynamic`- 并实现所需的查找方法 - 兼容使用任何结构类型，并且不是像通常那样通过反射来实现调用，而是通过调用相应的查找方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:55:16.593

你试图把两个完全不同的东西粘在一起。虽然结构类型有时也被比作“鸭子类型”，但它的特点正是使用*静态类型*信息（即使在使用站点上字节码会调用反射）。根据定义，您的动态类型没有此类静态类型信息。所以你永远无法让 Scala 编译器相信你的动态类型有一个可以静态验证存在的方法。

唯一的解决方法是允许输入*任何*类型`showFullName`并使用反射来调用`fullName`（同样，我不确定这是否与动态对象一起使用）。

* * *

另一方面，Scala 将允许你对动态类型做任何事情，将责任交给你：

```
def showFullName(o: Dynamic) = s"My full name is $o.fullName"

println(showFullName(d)) 
```

# mongodb - 在 MongoDB 中处理对嵌入式文档的引用的推荐方法是什么？

> ID：15798689
> 
> 赞同：0
> 
> 时间：2013-04-03T21:41:26.883
> 
> 标签：mongodb, reference

我是 MongoDB 的新手。这是我的问题：一个用户可以有多个头像，但只有一个是活动的。这是用户文档目前的样子：

```
{
  "_id": ObjectId("515c99f7e4d8094a87e13757"),
  "avatars": [{
    "url": "http://example.com/img/photo1.jpg",
    "width": 50,
    "height": 50,
  }, {
    "active": true,
    "url": "http://example.com/img/photo2.jpg",
    "width": 50,
    "height": 50,
  }]
} 
```

这个解决方案很简单，但有几件事我不喜欢：

1.  更改活动头像意味着更新两个嵌入文档
2.  我不确定在并发访问的情况下它会表现良好（read_avatar+change_active_avatar 或 change_active+change_active）（会吗？）
3.  寻找活动头像需要顺序搜索

另一种解决方案是：

```
{
  "_id": ObjectId("515c99f7e4d8094a87e13757"),
  "active_avatar_id": 2,
  "avatars": [{
    "_id": 1,
    "url": "http://example.com/img/photo1.jpg",
    "width": 50,
    "height": 50,
  }, {
    "_id": 2,
    "url": "http://example.com/img/photo2.jpg",
    "width": 50,
    "height": 50,
  }]
} 
```

`_id`这解决了问题 1 和 2，但没有解决问题 3。它在每个嵌入文档中添加了一个额外的字段。另外，当我插入一个新头像时，我现在需要知道接下来`_id`要使用什么（除非我使用 objectId，但它是一个 12 字节的 id，仅用于几百个头像（最大）。

所以另一个解决方案可能是这样的：

```
{
  "_id": ObjectId("515c99f7e4d8094a87e13757"),
  "active_avatar": {
    "url": "http://example.com/img/photo2.jpg",
    "width": 50,
    "height": 50,
  },
  "extra_avatars": [{
    "url": "http://example.com/img/photo1.jpg",
    "width": 50,
    "height": 50,
  }]
} 
```

并不比第一个解决方案好多少（它只是解决了问题#3，就是这样，而且更丑）。

所有这些解决方案都有效，但我正在寻找“正确的方法”来做到这一点。有任何想法吗？如果我允许用​​户拥有多个活动头像（无论这意味着什么）怎么办？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T13:09:47.897

您是否考虑过文档模型中的文档？

```
{
    "_id" : ObjectId("515c99f7e4d8094a87e13758"),
    "active_avatar_id" : 2,
    "avatars" : {
        "1" : {
            "url" : "http://example.com/img/photo1.jpg",
            "width" : 50,
            "height" : 50
        },
        "2" : {
            "url" : "http://example.com/img/photo2.jpg",
            "width" : 50,
            "height" : 50
        }
    }
} 
```

# android - OpenCV模板匹配绘制矩形匹配周围

> ID：15798691
> 
> 赞同：2
> 
> 时间：2013-04-03T21:41:34.103
> 
> 标签：android, templates, opencv, matching, template-matching

我想使用模板匹配，我正在使用我发现的代码，它可以在位图中保留它并获得位图的返回，问题是我不完全确定如何在矩形中绘制。在为 android 创建应用程序时，我只使用 java，没有使用 native。使用我不熟悉的openCV。我将获得多个匹配项，因此我想在这些点周围绘制矩形，并且还能够获得这些匹配项位置的值。

```
mFind=new Mat(256, 192, CvType.CV_8UC4); 
Input = new Mat(256, 192, CvType.CV_8UC4); 

Mat mResult8u = new Mat(256, 192, CvType.CV_8UC4); 

mResult = new Mat(217, 153, CvType.CV_8UC4); 

Utils.bitmapToMat(bmp2, mFind);
Utils.bitmapToMat(bmp1, Input);

Imgproc.matchTemplate(mFind, Input, mResult, Imgproc.TM_SQDIFF) ;
bmp3= Bitmap.createBitmap(mResult.cols(),  mResult.rows(),Bitmap.Config.ARGB_8888);
Core.normalize(mResult, mResult8u, 0, 255, Core.NORM_MINMAX, CvType.CV_8U);
Utils.matToBitmap(mResult8u, bmp3);
iv2.setImageBitmap(bmp3); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-07T22:02:46.023

在您的 中找到匹配项，在using`mResult`上绘制矩形并将其写入文件。`Input``Core.rectangle`

```
// / Localizing the best match with minMaxLoc
MinMaxLocResult mmr = Core.minMaxLoc(mResult);

Point matchLoc;
if (match_method == Imgproc.TM_SQDIFF || match_method == Imgproc.TM_SQDIFF_NORMED) {
    matchLoc = mmr.minLoc;
} else {
    matchLoc = mmr.maxLoc;
}

// / Show me what you got
Core.rectangle(Input, matchLoc, new Point(matchLoc.x + templ.cols(),
        matchLoc.y + templ.rows()), new Scalar(0, 255, 0));

// Save the visualized detection.
System.out.println("Writing "+ outFile);
Highgui.imwrite(outFile, img); 
```

# eclipse - BusinessEvents Studio 中的 m2e 和目标文件夹

> ID：15798692
> 
> 赞同：0
> 
> 时间：2013-04-03T21:41:34.867
> 
> 标签：eclipse, maven, m2eclipse, m2e, businessevents

我在 BusinessEvents Studio (Eclipse) 中有一个项目，我正在慢慢变成一个 Maven 项目。我已将 m2e 添加到 BusinessEvents Studio 并为项目提供了 POM。无论是在“Studio Explorer”还是“Package Explorer”中，我的`target`文件夹都会显示在树中（尽管设置为“Derived”）。这本身对我来说很好，虽然它看起来很奇怪。

现在我的 BusinessEvents Studio 进入了一个循环，它似乎在运行 Maven (m2e)，它写入`target`文件夹，看到文件夹中写入了一些内容`target`，然后重新运行 Maven (m2e)。甚至在将“自动构建”选中为关闭时也会这样做。

请注意，Mavenizing 的原因是尝试对事物进行单元测试，因此让 Maven 与 BusinessEvents 一起运行是有目的的。

这个循环很烦人，但我也想让 Maven 做更多的增量构建任务，有效地引入大量空闲等待我，开发人员，这个循环使情况变得更糟。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T07:53:25.020

这似乎是由以下 Eclipse 问题引起的：

[“Windows 7 库触发重建”](https://bugs.eclipse.org/bugs/show_bug.cgi?id=342931)

当我关闭“使用本机挂钩或轮询刷新”（首选项、常规、工作区）时，这种行为就结束了。

因此，这不是 BusinessEvents Studio 特定的问题。这也不是与 m2e 相关的问题。不过，使用任何类型的非平凡的 Maven POM 都会更加明显。

（我认为[Bug 342931](https://bugs.eclipse.org/bugs/show_bug.cgi?id=342931)绝对值得支持：在我个人看来，自动刷新是 Eclipse 的一个非常令人高兴的功能。在使用 TortoiseSVN 之类的工具后，我有很多次 Eclipse 与文件系统不同步。我在 Eclipse 之外的工作空间。）

# javascript - Struts 2 中的 JavaScript 函数未设置 readOnly 属性

> ID：15798693
> 
> 赞同：3
> 
> 时间：2013-04-03T21:41:36.120
> 
> 标签：javascript, jsp, struts2, ognl

我正在尝试创建一个编辑链接，以便在单击它时以只读模式打开该行的详细信息。

链接在这里：

```
<c:set var="deletableBook" value="0"/>

<a href="" title="Edit Book Info" onClick='resetDateAndMakeReadOnly(${deletableBook}); return performAction(${item.bookId}, "bookEdit");'>Edit</a> 
```

这是被调用的函数：

> ```
> function resetDateAndMakeReadOnly(allEditable) {      
>  var e22 = document.getElementById('book_Date');
>  var e3 = document.getElementById('book_type');
>  var e4 = document.getElementById('book_Number');
>  if (allEditable){
>      e22.readOnly=false;
>      e3.disabled=false;
>      e4.readOnly=false;
>      alert("read and write");
>  } else {
>      e22.readOnly=true;
>      e3.disabled=true;
>      e4.readOnly=true;
>      alert("readOnly new");
>  }
>  e22.value = "<c:out value='${params.book_Date}'/>";
>  return false;    } 
> ```

目前，运行此方法时似乎没有任何变化。我已经确认它符合逻辑的正确部分，但事情仍然是可编辑的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T10:19:24.680

这是因为您使用空链接`href`来触发您的 javascript 函数，该函数将重新加载您的页面。`javascript:void(0);`在里面使用`href`。

```
<a href="javascript:void(0);" title="Edit Book Info" onClick='resetDateAndMakeReadOnly(${deletableBook}); return performAction(${item.bookId}, "bookEdit");'>Edit</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T09:59:14.280

该属性`deletableBook`不是布尔值，也不`false`是您在 javascript 函数中所期望的。在动作中切换变量

```
session.put("allEditable", !(session.get("allEditable")==null?Boolean.FALSE:(Boolean)session.get("allEditable"))); 
```

然后使用

```
$(document).ready(function(){
    resetDateAndMakeReadOnly(<s:property value="%{#session.allEditable}"/>);
}); 
```

这将根据`allEditable`重新加载页面的时间重置字段属性。但是这个

```
<s:a href="" title="Edit Book Info" onClick="resetDateAndMakeReadOnly(%{#session.allEditable});">Make readonly</s:a> 
```

不会重新加载页面并保留您在`allEditable`session 属性中的值。该语法可能有点混淆 IDE，但正确评估 OGNL 表达式并呈现如下

```
<a title="Edit Book Info" onClick="resetDateAndMakeReadOnly(false);">Make readonly</a> 
```

没有`href`属性，这就是页面没有重新加载的原因。

JSP 中的元素也应该可以通过`id`设置属性找到。

# mercurial - 使用 Mercurial 时是否所有文件都必须位于“存储库文件夹”中？

> ID：15798696
> 
> 赞同：2
> 
> 时间：2013-04-03T21:41:39.590
> 
> 标签：mercurial

这是我第一次使用 Mercurial，所以这可能是一个非常新手的问题......

如果我创建一个存储库，例如 c:\HG1 我的所有文件都需要在那个目录下吗？

或者我可以添加来自不同文件夹的文件，例如“C:\myotherfolder”吗？

如果您可以从 diff 文件夹中添加...如何，似乎无法弄清楚。

谢谢。

ps 我来自非分布式源代码控制系统，所以也许我只是在以这种心态思考我的工作流程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:46:44.210

是的，所有要跟踪的文件都必须位于根存储库文件夹下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-20T03:04:17.727

不，他们没有，您可以使用符号链接（Windows 上的 mklink）将另一个文件夹链接到不在同一个父文件夹中的存储库中。

在此处查看我对类似问题的回答：[https ://stackoverflow.com/a/19473449/471924](https://stackoverflow.com/a/19473449/471924)

# r - Linux 上的多核不使用多个 CPU

> ID：15798698
> 
> 赞同：1
> 
> 时间：2013-04-03T21:41:45.030
> 
> 标签：r, parallel-processing, domc

我在 Linux 上使用 R 2.14.0 64 位。我继续使用[此处](http://cran.r-project.org/web/packages/doMC/vignettes/gettingstartedMC.pdf)描述的示例。然后我运行这个例子 -

```
library(doMC)
registerDoMC()
system.time({
r <- foreach(icount(trials), .combine=cbind) %dopar% {
  ind <- sample(100, 100, replace=TRUE)
  result1 <- glm(x[ind,2]~x[ind,1], family=binomial(logit))
  coefficients(result1)
} }) 
```

但是，我在顶部看到它只使用一个 CPU 内核。以另一种方式证明这一点，如果我检查一个使用所有内核的进程，我会看到 -

```
ignorant@mybox: ~/R$ ps -p 5369 -L -o pid,tid,psr,pcpu
  PID   TID PSR %CPU
 5369  5369   0  0.1
 5369  5371   1  0.0
 5369  5372   2  0.0
 5369  5373   3  0.0
 5369  5374   4  0.0
 5369  5375   5  0.0
 5369  5376   6  0.0
 5369  5377   7  0.0 
```

但在这种情况下，我看到 -

```
ignorant@mybox: ~/R$ ps -p 7988 -L -o pid,tid,psr,pcpu
  PID   TID PSR %CPU
 7988  7988   0 19.9
ignorant@mybox: ~/R$ ps -p 7991 -L -o pid,tid,psr,pcpu
  PID   TID PSR %CPU
 7991  7991   0 19.9 
```

我怎样才能让它使用多个核心？我正在使用多核而不是 doSMP 或其他东西，因为我不想为每个进程都拥有我的数据副本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T23:00:07.293

首先，您可能想查看`htop`，它可能适用于您的发行版。您可以清楚地看到每个 CPU 的使用情况。

二、有没有试过直接在机器上设置核数？

打开运行它`htop`：

```
library(doMC)
registerDoMC(cores=12) # Try setting this appropriately.
system.time({
  r <- foreach(1:1000, .combine=cbind) %dopar% {
    mean(rnorm(100000))
  } })
# I get:
#    user  system elapsed 
#  12.789   1.136   1.860 
```

如果`user`时间比经过的时间长得多（并非总是——我知道，但根据经验法则），您可能使用了多个内核。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-06T02:01:05.370

您可以尝试使用以下命令执行脚本：

```
$ taskset 0xffff R --slave -f parglm.R 
```

如果这解决了问题，那么您可能拥有使用 OpenBLAS 或 GotoBlas2 构建的 R 版本，它设置 CPU 亲和性，以便您只能使用一个内核，这是一个已知问题。

如果您想以交互方式运行您的示例，请使用以下命令启动 R：

```
$ taskset 0xffff R 
```

# xpath - 任何后代混淆的following-sibling

> ID：15798699
> 
> 赞同：1
> 
> 时间：2013-04-03T21:41:46.067
> 
> 标签：xpath

对于 html 文本

```
<html>
 <body>
  <div id="1">1</div>
  <div id="2">1</div>
  <div id="3">1</div>
 </body>
</html> 
```

我查询

```
//following-sibling::div[3] 
```

结果就在那里

```
<div id="3">1</div> 
```

但根据[XPath 规范](http://www.w3.org/TR/xpath20/#axes)

> following-sibling 轴包含上下文节点的后续兄弟，即上下文节点的父级的子级，它们按文档顺序出现在上下文节点之后；

那么成功找到第三个 div 后的上下文节点是什么？似乎当//创建第一个div时，它之后没有第三个div，最后一个可访问的应该是[2]。如果上下文节点不是 div 而是 body 或 html，则 div 不是它们的兄弟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:27:10.123

上下文节点是元素中的第一个*文本*节点（仅包含空格） 。`body`

# android - 操作栏 Sherlock NAVIGATION_MODE_LIST - dropdownListPreferredItemHeight 被忽略

> ID：15798705
> 
> 赞同：2
> 
> 时间：2013-04-03T21:42:24.357
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在使用带有导航模式**NAVIGATION_MODE_LIST**的Action Bar Sherlock 和**自定义微调器适配器**。

问题是下拉列表视图看起来被挤压，项目的高度看起来像是有 wrap_content 而不是倾斜的固定高度。（[这就是它的样子](http://cl.ly/image/423O1r1r3p0j)）

根据 *abs_themes*，高度应为 48dip：

```
<item name="dropdownListPreferredItemHeight">48dp</item> 
```

如果我使用从资源创建的非自定义微调器适配器，它可以正常工作，我错过了什么？这是我写的**示例**代码：

**MainActivity.java**

```
package com.example.themetest;

import android.content.Context;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.SpinnerAdapter;
import android.widget.TextView;
import android.widget.Toast;

import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.ActionBar.OnNavigationListener;
import com.actionbarsherlock.app.SherlockActivity;

public class MainActivity extends SherlockActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ActionBar actionBar = getSupportActionBar();
    actionBar.setDisplayShowTitleEnabled(false);
    actionBar.setDisplayHomeAsUpEnabled(true);
    actionBar.setDisplayUseLogoEnabled(true);
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);

    final String[] choices = {"Android", "iOS", "RIM"};
    CustomSpinnerAdapter customSpinnerAdapter = new CustomSpinnerAdapter(MainActivity.this, android.R.id.text1, choices);
    actionBar.setListNavigationCallbacks(customSpinnerAdapter, new OnNavigationListener() {
        @Override
        public boolean onNavigationItemSelected(int itemPosition, long itemId) {
            Toast.makeText(MainActivity.this, choices[itemPosition], Toast.LENGTH_SHORT).show();
            return false;
        }
    });

//        this works properly
//        actionBar.setListNavigationCallbacks(ArrayAdapter.createFromResource(this,     R.array.sections, R.layout.sherlock_spinner_dropdown_item),
//              new OnNavigationListener() {
//                  public boolean onNavigationItemSelected(int itemPosition, long itemId) {
//                      return false;
//                  }
//        });
}

private class CustomSpinnerAdapter extends ArrayAdapter<String> implements SpinnerAdapter {
    private LayoutInflater layoutInflater;

    public CustomSpinnerAdapter(Context context, int textViewResourceId, String[] values) {
        super(context, textViewResourceId, values);
        this.layoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        return initView(position, convertView);
    }

    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent) {
        return initView(position, convertView);
    }

    private View initView(int position, View convertView) {
        if (convertView == null) {
            convertView = layoutInflater.inflate(R.layout.sherlock_spinner_dropdown_item, null);
        }
        ((TextView) convertView.findViewById(android.R.id.text1)).setText(getItem(position));
        return convertView;
    }
}

} 
```

**样式.xml**

```
<resources>
    <style name="Theme.AppTheme" parent="Theme.Sherlock.Light" />
</resources> 
```

**清单.xml**

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/Theme.AppTheme" >
    <activity
        android:name="com.example.themetest.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T23:07:27.483

您没有将 传递`parent`给该`inflate()`方法。这应该是忽略高度的原因。

```
layoutInflater.inflate(R.layout.sherlock_spinner_dropdown_item, parent, false); 
```

代替

```
layoutInflater.inflate(R.layout.sherlock_spinner_dropdown_item, null); 
```

实现`getView()`并`getDropDownView()`像这样：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    if (convertView == null) {
        convertView = layoutInflater.inflate(
                R.layout.sherlock_spinner_item, parent, false);
    }
    ((TextView) convertView.findViewById(android.R.id.text1))
             .setText(getItem(position));
    return convertView;
}

@Override
public View getDropDownView(int position, View convertView, ViewGroup parent) {
    if (convertView == null) {
        convertView = layoutInflater.inflate(
                R.layout.sherlock_spinner_dropdown_item, parent, false);
    }
    ((TextView) convertView.findViewById(android.R.id.text1))
             .setText(getItem(position));
    return convertView;
} 
```

# php - 带有单例和 PDO 的无限循环

> ID：15798707
> 
> 赞同：0
> 
> 时间：2013-04-03T21:42:30.103
> 
> 标签：php, pdo, singleton

我为 PDO 创建了一个单例模式，问题是当我使用它时，我有一个无限循环，例如，这样做：

```
$db=Db::fetch_instance(); 
$product = $db->query(<query>); 
```

我有这个错误：

```
Fatal error: Maximum function nesting level of '100' reached, aborting! 
```

我的课是这个：

```
class Db {

    //START OF SINGLETON PATTERN

    private static $PDOInstance;

    public static function fetch_instance() {
        try {           
            if(empty(self::$PDOInstance)){                      
                self::$PDOInstance = new Db();                  
            }
            return self::$PDOInstance;
        } catch (Exception $e) {
                     <something>
        }
    }

    private function __construct() {
            return new PDO("something");
    }

    //START OF DECORATOR PATTERN

    public function beginTransaction() {
        .......
    }

    public function query($statement) {
        return self::$PDOInstance->query($statement);
    }

      ........ 
```

为什么这个循环？，我没有看到任何循环。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T21:53:53.860

这个错误对我来说很清楚，你的方法`query`正在调用自己。

```
public function query($statement) {
    return self::$PDOInstance->query($statement);
} 
```

这是因为您的单例有错误，您应该将代码更改为：

```
public static function fetch_instance() {
    try {           
        if(empty(self::$PDOInstance)){                      
            self::$PDOInstance = new PDO("something");
            return self::$PDOInstance;
        }
    } catch (Exception $e) {
                 <something>
    }
}

private function __construct() {

} 
```

小心，构造函数并不意味着返回任何东西，你正在分配`self::$PDOInstance`一个新`Db`对象的实例！

**更新**

顺便说一句，这里更接近您想要做的事情：

```
class Db {

    // START OF SINGLETON PATTERN

    private static $instance;

    private $PDOInstance;

    public static function fetch_instance() {
        try {
            if (empty(self::$PDOInstance)) {                      
                self::$instance = new Db();
            }

            return self::$instance;
        } catch (Exception $e) {
            // <something>
        }
    }

    private function __construct() {
        return $this->PDOInstance = new PDO("something");
    }

    // START OF DECORATOR PATTERN

    public function beginTransaction() {
        // .......
    }

    public function query($statement) {
        return $this->PDOInstance->query($statement);
    }

} 
```

`$PDOInstance`是私有的并且绑定到您的单例，`$instance`是静态的并且将包含`Db`该类的唯一实例。您的构造函数在这里负责初始化您`$PDOInstance`，然后您可以将其用作属性`$this->PDOInstance`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T21:54:05.413

__construct() 不应该有返回值。

删除它，让你`fetch_instance()`像这样：

```
public static function fetch_instance()
{
    if (!self::$PDOInstance) {
        self::$PDOInstance = new PDO();
    }

    return self::$PDOInstance;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:06:43.873

你的单例模式是错误的。如果您希望“Db”类的实例是单例的，您应该做的是将唯一且唯一的“Db”实例存储`Db::fetch_instance()`到静态私有属性中。这个实例应该有一个 PDO 实例。

```
class Db {

//START OF SINGLETON PATTERN

private static $dbInstance;

private $PDO;

public static function fetch_instance() {
    try {           
        if(empty(self::$dbInstance)){                      
            self::$dbInstance = new Db();                  
        }
        return self::$dbInstance;
    } catch (Exception $e) {
                 <something>
    }
}

private function __construct() {
        $this->PDO = new PDO("something");
}

//START OF DECORATOR PATTERN

public function beginTransaction() {
    .......
}

public function query($statement) {
    return $this->PDO->query($statement);
}

  ........ 
```

请注意，实际上没有必要使用单例。

在一般层面上，单例越来越多地被认为是一种反模式。它们确实使代码的可测试性很差，应该避免。

第二：PHP 中总是有不止一个实例，因为每个请求都在它自己的变量空间中运行。所以每个并发请求有一个实例，而不是每个服务器一个实例。这意味着所有这些实例都同时连接到数据库。

第三：PHP 中的 mysql 扩展可防止程序多次连接到具有相同凭据的同一个数据库。

第四：虽然目前可能没有需求，但会有一段时间同时存在多个数据库。这是将数据库连接创建为单例的时候会受到最大的伤害。

所以我真的建议不要将单例模式用于数据库连接。你一无所获，却失去了很多。

# python - 获取对象的外键父级 - Django

> ID：15798712
> 
> 赞同：1
> 
> 时间：2013-04-03T21:43:04.233
> 
> 标签：python, django

假设我有两个这样的模型：

```
class Article(models.Model):
    article_title = models.CharField(max_length=100)

class EventRecord(models.Model):
    article = models.ForeignKey(Article) 
```

在一个视图中，我选择了某个 EventRecord，并希望显示与之相关的文章的标题。以下不起作用：

```
def classify(request, pk):
    event = get_object_or_404(EventRecord, pk=pk)
    article_id = event.article
    article = get_object_or_404(Article, pk=article_id) 
```

我该如何进行这项工作？**非常**感谢任何帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-03T21:51:56.720

Django 会自动为您处理这个问题。例如：

```
>>> record = EventRecord.objects.get(...)
>>> isinstance(record.article, Article)
True
>>> record.article.article_title
u'title here' 
```

这是 Django 所做的神奇事情之一（没有什么是神奇的，但无论如何......）。请记住，为了完成这项工作，Django 通常会执行一些额外的数据库查询。要消除它们，您可以使用`select_related`方法。下面是一个片段，它消除了额外的查询并做你想做的事：

```
def classify(request, pk):
    record = EventRecord.objects.filter(pk=pk).select_related()

    # the above returns queryset hence you have to extract the record manually
    if not len(record):
        raise Http404()
    else:
        record = record[0]

    # now use record as usual and no extra queries will be executed
    title = record.article.article_title
    ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T21:46:39.890

`event.article`返回实际`Article`对象，而不是主键，因此您无需执行其他数据库查询。

```
def classify(request, pk):
    event = get_object_or_404(EventRecord, pk=pk)
    if not event.article:
        raise Http404
    print event.article.article_title 
```

# asp.net-mvc - 果园必应地图

> ID：15798717
> 
> 赞同：0
> 
> 时间：2013-04-03T21:43:18.943
> 
> 标签：asp.net-mvc, orchardcms, bing-maps, orchardcms-1.6

为什么当我从果园的模块/图库菜单中安装 bing.maps 时……“bing maps”没有出现在左侧菜单上？

![在此处输入图像描述](https://i.stack.imgur.com/NS0sH.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T05:13:01.567

因为它可能不会公开管理菜单项。您是否尝试过创建内容类型并将 Bing 地图部分添加到其中？

# console - 显示数字直到输入数字（在控制台 C# 中）

> ID：15798723
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:43:35.393
> 
> 标签：console, limit

在输入用户号码之前如何显示数字？例如输入为9，则显示0,1,2,3,4,5,6,7,8,9 MSVisual studio, c# 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:02:56.330

```
int input = Int32.parseInt(Console.ReadLine());
for(int i = 0; i<=input; i++){ //for loop
  Console.WriteLine(i);        
} 
```

# windows - 对于超过 2gb 的文件，Windows For 命令失败

> ID：15798730
> 
> 赞同：0
> 
> 时间：2013-04-03T21:43:53.500
> 
> 标签：windows, for-loop, batch-file, command

我有一个用于 /F 命令的窗口，它在高达 2gb 的文件上运行良好，但什么也不做，当它们超过 2gb 时继续执行下一个命令

我已经搜索了有关限制的文档，但我找不到任何文件 - 任何人都可以确认这是一个真正的限制吗？

假设我需要复制一个删除前三行的文件 - 任何想法（for 命令无论如何都很慢）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:44:09.510

是的，我相信`for /F`有2GB的限制。我认为你最好的选择是`sed`从 gnuwin32 使用。谷歌 gnuwin32 sed 并点击第一个结果。下载二进制 zip 文件并在路径中的某处提取 bin 文件夹的内容。

相应的命令如下：

```
sed "1,3d" oldfile > newfile 
```

无论如何，这应该比批处理`for`循环快得多。

# android - 如何在 Android 库项目中调试本机代码？

> ID：15798738
> 
> 赞同：10
> 
> 时间：2013-04-03T21:44:01.880
> 
> 标签：android, eclipse, android-ndk, java-native-interface

我正在使用本机代码开发一个 Android 库。此库项目作为库添加到应用程序项目中。

我想在应用程序项目使用它时调试该库。

我很确定库中的设置（makefile、构建命令、编译器选项）项目是可以的，因为我从库中尝试了调试器（我创建了一个虚拟活动并取消设置“库”）并且它工作正常。我也知道由于加载动态库所需的时间而可能发生的延迟，我认为这不是出于同样的原因的问题。

在 Application 项目中，我只是添加了原生代码支持，将构建命令设置为`ndk_build NDK_DEBUG=1`，**但它永远不会在断点处停止**。任何想法将不胜感激

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T13:01:10.983

试试 Jay 在我的问题中的回答：[debug native code in Android library](https://stackoverflow.com/questions/12638849/debug-native-code-in-android-library)。我没有时间亲自测试它，但它看起来很有希望。让我知道它是否有效。

# c# - 关键字映射错误

> ID：15798739
> 
> 赞同：3
> 
> 时间：2013-04-03T21:44:05.860
> 
> 标签：c#, entity-framework

sysdtslog90 是我们使用的用于记录 SSIS 信息的数据库表。它有几个列名也是 C# 关键字：事件和运算符。

我使用 EF 的 Reverse Engineer Code First 创建模型和映射对象。模型的名称前面有一个@，而映射没有。结果，抛出错误（指向映射文件）：

> ; 预期的
> 
> 无法将 lambda 表达式转换为类型“t”，因为它不是委托类型

当我将 @ 添加到映射文件中的名称时，它将正确编译。（换句话说**t.@event**而不是**t.event**。）

*如何更改 Mapper 以使其创建与模型相同的名称？*

**映射片段：（**没有 @ ）

```
public class sysdtslog90Map : EntityTypeConfiguration<sysdtslog90>
{
    public sysdtslog90Map()
    {
        // Primary Key
        this.HasKey(t => t.id);

        // Properties
        this.Property(t => t.event)
            .IsRequired()
            .HasMaxLength(128);

        this.Property(t => t.operator)
            .IsRequired()
            .HasMaxLength(128); 
```

**模型片段：**

```
public partial class sysdtslog90
{
...
  public string @event { get; set; }
...
  public string @operator { get; set; }
... 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-28T17:28:50.483

一年后我也一样。这是我的修复，但不幸的是它不起作用......完全。将您的项目设置为从逆向工程菜单自定义 T4 模板。然后打开 Mapping.tt 文件。在那里，您将看到它是如何构建类的。

```
this.Property(t => t.<#= new string[] {"event", "operator"}.Contains(prop.Name.ToString())     ? "@@" + prop.Name.ToString() : prop.Name #>)
<#= string.Join("\r\n                ", configLines) #>; 
```

这完全适用于“操作员”，但对于事件它仍然这样做：

```
this.Property(t => t.event) 
```

“操作员”看起来不错：

```
this.Property(t => t.@operator) 
```

希望如果有人读到这篇文章，它可能会激发答案。我自己还在努力。请注意，我也对类的表格区域应用了相同的代码，虽然它是确切的代码，但事件实际上确实在它需要的位置获得了 @ 符号。很奇怪。

编辑：所以我根本没有保存 .tt 文件。上面的代码有效。我希望它可以帮助某人。确保在编辑 tt 文件后保存它，因为逆向工程师不会自动保存这些文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:51:45.740

我不确定您所说的“更改映射器”是什么意思。你的意思是有什么方法可以让逆向工程师代码优先工具`@`在生成映射代码时在这些属性前面放置一个符号？我会说不，除非您修改该工具的源代码。

但是，为什么不像您自己那样调整映射类以使其编译呢？如果您更改它以使其在那些 lambda 中表示`@event`，`@operator`这些属性仍将映射到数据库中的`event`和`operator`列。前缀只是允许您使用`@`C# 关键字作为标识符，它实际上并不是标识符的一部分。因此，一旦代码被编译，Entity Framework 将不会“看到”该`@`符号，因此它不会尝试在列映射中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:46:55.273

`.HasColumnName()`如果您的对象的属性和表的列具有不同的名称，请尝试使用映射属性：

```
this.Property(t => t.@event).HasColumnName("event"); 
```

# matlab - 不使用 histeq 的直方图均衡方法

> ID：15798742
> 
> 赞同：0
> 
> 时间：2013-04-03T21:44:12.233
> 
> 标签：matlab

我是 Matlab 的新手，正在尝试实现代码以执行与`histeq`未实际使用该函数相同的功能。在我的代码中，当它不应该改变那么多时，我得到的图像颜色会发生巨大变化。图像中的平均强度（范围在 0 到 255 之间）为 105.3196。该图像是一种开源花粉颗粒。

任何帮助将非常感激。越早越好！由于我对 Matlab 的理解有限，请可以简化任何帮助。谢谢。

```
clc;
clear all;
close all;

pollenJpg = imread ('pollen.jpg', 'jpg');
greyscalePollen = rgb2gray (pollenJpg);

histEqPollen = histeq(greyscalePollen);

averagePollen = mean2 (greyscalePollen)

sizeGreyScalePollen = size(greyscalePollen);
rowsGreyScalePollen = sizeGreyScalePollen(1,1);
columnsGreyScalePollen = sizeGreyScalePollen(1,2);

for  i = (1:rowsGreyScalePollen)
    for  j = (1:columnsGreyScalePollen)
        if (greyscalePollen(i,j) > averagePollen)
            greyscalePollen(i,j) = greyscalePollen(i,j) + (0.1 * averagePollen);

            if (greyscalePollen(i,j) > 255)
                greyscalePollen(i,j) = 255;
            end

        elseif (greyscalePollen(i,j) < averagePollen)
            greyscalePollen(i,j) = greyscalePollen(i,j) - (0.1 * averagePollen);

            if (greyscalePollen(i,j) > 0)
                greyscalePollen(i,j) = 0;
            end

        end
    end
end

figure;
imshow (pollenJpg);
title ('Original Image');
figure;
imshow (greyscalePollen);
title ('Attempted Histogram Equalization of Image');
figure;
imshow (histEqPollen);
title ('True Histogram Equalization of Image'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:29:06.057

要实现[Wikipedia 页面上描述的均衡算法，请](http://en.wikipedia.org/wiki/Histogram_equalization)执行以下步骤：

决定对`binSize`灰度值进行分组。（这是一个可调整的，bin 越大，理想情况下的结果越不准确，但我认为如果在真实图像上选择太小会导致问题）。

然后，计算像素为灰色阴影的概率：

```
pixelCount = imageWidth * imageHeight
histogram = all zero
for each pixel in image at coordinates i, j
    histogram[floor(pixel / 255 / 10) + 1] += 1 / pixelCount // 1-based arrays, not 0-based
    // Note a technicality here: you may need to 
    // write special code to handle pixels of 255,
    // because they will fall in their own bin. Or instead use rounding with an offset. 
```

此计算中的直方图被缩放（除以像素数），以便这些值作为概率有意义。您当然可以将除法因素排除在 for 循环之外。

现在你需要计算这个的累计和：

```
histogramSum = all zero // length of histogramSum must be one bigger than histogram

for i == 1 .. length(histogram)
    histogramSum[i + 1] = histogramSum[i] + histogram[i] 
```

现在你必须反转这个函数，这是棘手的部分。最好的办法是不计算显式逆，而是当场计算，然后应用到图像上。基本思路是在 histogramSum 中搜索像素值（找到下面最接近的索引），然后在索引和下一个索引之间做线性插值。

```
foreach pixel in image at coordinates i, j
   hIndex = findIndex(pixel, histogramSum) // You have to write findIndex, it should be simple
   equilisationFactor = (pixel - histogramSum[hIndex])/(histogramSum[hIndex + 1] - histogramSum[hIndex]) * binSize
   // This above is the linear interpolation step. 
   // Notice the technicality that you need to handle:
   // histogramSum[hIndex + 1] may be out of bounds

   equalisedImage[i, j] = pixel * equilisationFactor 
```

* * *

**编辑：**如果不深入研究数学，我不能 100% 确定，但我认为除以 0 错误是可能的。如果一个箱子是空的，这些可能会发生，因此连续的和是相等的。所以你也需要特殊的代码来处理这种情况。您可以做的最好的事情是将因子的值取为 , 之间的中间值`hIndex`，`hIndex + n`其中`n`是 的最大值`histogramSum[hIndex + n] == histogramSum[hIndex]`。

* * *

一旦你处理了所有的技术问题，就应该*这样。*

上述算法很慢（尤其是在 findIndex 步骤中）。您可以使用特殊的查找数据结构对此进行优化。但只有在它工作时才这样做，而且只有在必要时才这样做。

* * *

关于您的 Matlab 代码的另一件事：行和列是倒置的。由于算法中的对称性，结果是一样的，但是在其他算法中可能会引起令人费解的错误，如果在调试时检查像素值会非常混乱。不过，在上面的伪代码中，我使用的和你一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T23:32:23.627

相对较少 (5) 行代码可以做到这一点。我使用了在[http://commons.wikimedia.org/wiki/File%3ALepismium_lorentzianum_pollen.jpg找到的名为“pollen.jpg”的低对比度文件](http://commons.wikimedia.org/wiki/File%3ALepismium_lorentzianum_pollen.jpg)

我使用您的代码阅读了它，运行上述所有内容，然后执行以下操作：

```
% find out the index of pixels sorted by intensity:
[gv gi] = sort(greyscalePollen(:));  

% create a table of "approximately equal" intensity values:
N = numel(gv);
newVals = repmat(0:255, [ceil(N/256) 1]);

% perform lookup: 
% the pixels in sorted order need new values from "equal bins" table:
newImg = zeros(size(greyscalePollen));
newImg(gi) = newVals(1:N);

% if the size of the image doesn't divide into 256, the last bin will have 
% slightly fewer pixels in it than the others 
```

当我运行此算法，然后创建四个图像（原始图像、您的尝试、我的尝试和`histeq`）的合成时，您会得到以下结果： ![比较四块](https://i.stack.imgur.com/tS37G.png)

我认为这很有说服力。图像并不完全相同 - 我相信这是因为 matlab`histeq`例程忽略了所有值为 0 的像素。由于它是完全矢量化的，所以它也非常快（尽管`histeq`在我的图像上几乎没有 15 倍快。

编辑：可能需要一些解释。`repmat`我用来创建`newVals`矩阵的命令会创建一个如下所示的矩阵：

```
0  1  2  3  4  ...  255
0  1  2  3  4  ...  255
0  1  2  3  4  ...  255
...
0  1  2  3  4  ...  255 
```

由于 matlab 以“第一个索引优先”的顺序存储矩阵，因此如果您使用单个索引读取此矩阵（就像我在行中所做的那样`newVals(1:N)`），您首先访问所有零，然后访问所有零，等等：

```
0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 ... 
```

所以 - 当我知道像素按强度顺序排列的索引时（由`sort`命令的第二个参数返回，我称之为`gi`），然后我可以轻松地将值分配`0`给第一个`N/256`像素，将值分配`1`给下一个`N/256`等，使用我使用的命令：

```
newImg(gi) = newVals(1:N); 
```

我希望这能让代码更容易理解。

# facebook-graph-api - *格式错误的访问令牌 - 但这是我得到的令牌 (PHP)

> ID：15798744
> 
> 赞同：0
> 
> 时间：2013-04-03T21:44:22.200
> 
> 标签：facebook-graph-api, facebook-access-token, malformed

我的 FB-App 有这个问题

我有 2 个文件.. 1) mainApp.php .. 和.. 2) asyncApp.php .. （处理数据，提供内容和狗屎..）

现在..

*   当用户登录时，一切正常.. 我得到访问令牌并将其保存到 SESSION-Var ..（此处仅处理 mainApp.php）.. 但是..

*   当我通过 jquery.load() 调用 async.php 例如 .. 我总是得到 {"error":{"message":"Malformed access token .. oO

但令牌与我从 mainApp.php 中的 FB 获得的令牌相同.. :(

mainApp：这样我得到了令牌..

```
if(isset($_GET["code"])) {
                $code = $_GET["code"];    
                $url = 'https://graph.facebook.com/oauth/access_token?client_id='.$appID.'&redirect_uri='.urlencode($appRedirectURI).'&client_secret='.$appSecret.'&code='.$code;
                $curl_handle=curl_init();                   
                curl_setopt($curl_handle,CURLOPT_URL,$url);
                curl_setopt($curl_handle,CURLOPT_CONNECTTIMEOUT,6);
                curl_setopt($curl_handle,CURLOPT_RETURNTRANSFER,1);
                $buffer = curl_exec($curl_handle);                  
                curl_close($curl_handle); 

                if(strpos($buffer, 'access_token=') === 0) {                        
                    //if you requested offline acces save this token to db for use later                        
                    $token = str_replace('access_token=', '', $buffer);
                    $_SESSION['fbToken'] = $token; 
```

后来我调用了 async.php，它应该在用户墙上做一个提要..

```
$attachment =  array(
                        'access_token' => $_SESSION['fbToken'],
                        'message' => 'dfdfdf',
                        'name' => 'sdfdsf',
                        'link' => 'http://www.mbla.de',
                        'description' => 'sdfdsf',
                        'picture'=> '',
                        'actions' => json_encode(array('name' => $action_name,'link' => $action_link))
                        );

                        $ch = curl_init();
                        curl_setopt($ch, CURLOPT_URL,'https://graph.facebook.com/me/feed');
                        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
                        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
                        curl_setopt($ch, CURLOPT_POST, true);
                        curl_setopt($ch, CURLOPT_POSTFIELDS, $attachment);
                        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);  //to suppress the curl output 
                        $result = curl_exec($ch);
                        curl_close ($ch); 
```

如果有人可以帮助我会很好..我现在已经痛苦了将近 2 周了.. :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T02:14:24.893

欢迎来到堆栈溢出！

* * *

1.  当你`async.php`直接打电话时会发生什么，它有效吗？
2.  当你有脚本`print_r()`的内容时会发生什么`$_SESSION`，它被填充了吗？
    *   如果您通过 ajax 调用执行此操作，并通过 Firebug/Chrome Inspector 检查输出会怎样？

查看附加的代码 ( `async.php`)，您似乎没有正确地将参数传递给 Facebook。curl 选项`CURLOPT_POSTFIELDS`不将数组作为参数。相反，它应该被构造为一个查询字符串：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, 'param1=value&param2=value&param3=value'); 
```

为方便起见，我倾向于这样做：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, htmlspecialchars(http_build_query(array(
    "param1" => 'value',
    "param2" => 'value',
    "param3" => 'value'
)))); 
```

# wordpress - 在不同的页面上显示不同的类别？

> ID：15798745
> 
> 赞同：0
> 
> 时间：2013-04-03T21:44:32.513
> 
> 标签：wordpress

我有一个服装网站，我有 3 页：

男士女士儿童

在每个页面中，我想在侧边栏上显示一个类别列表，此时所有这些类别都出现在每个页面上，如何为每个页面分配不同的类别，以便只显示相关的类别？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:18:43.617

你必须使用这个：[http](http://codex.wordpress.org/Category_Templates) : //codex.wordpress.org/Category_Templates 或一个插件 semilar 到 Ultimate Category Excluder ..

祝你好运

# apache - 为什么我的 XAMPP Apache 服务不断重启？

> ID：15798746
> 
> 赞同：0
> 
> 时间：2013-04-03T21:44:35.747
> 
> 标签：apache, xampp, restart

出于某种原因，我的 XAMPP Apache 服务不断重启。它从昨天开始，但我真的找不到原因，因为前一天我对我的电脑做了很多更改（Windows 更新、防病毒更新、安装了新程序等）。

XAMPP 控制面板说它正在运行，但是当我查看 windows 任务管理器中的进程时，我可以看到它每秒都在重新启动，并且 windows 错误报告进程也不断出现（没有任何对话框）。

出于某种原因，我可以访问 xampp 第一页（localhost 或 localhost/xampp），但没有其他内容（没有 phpmyadmin 或我放入 htdocs 中的任何其他内容）。我试图重新安装 XAMPP，这也不是每个人都知道的 Skype 问题。我有windows 8 pro。

apache error.log 不断重复：

```
[Thu Apr 04 00:21:21.237364 2013] [ssl:warn] [pid 260:tid 572] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]
[Thu Apr 04 00:21:21.298371 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00455: Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7 configured -- resuming normal operations
[Thu Apr 04 00:21:21.298371 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00456: Server built: Aug 18 2012 12:41:37
[Thu Apr 04 00:21:21.298371 2013] [core:notice] [pid 260:tid 572] AH00094: Command line: 'E:\\xampp\\apache\\bin\\httpd.exe -d E:/xampp/apache'
[Thu Apr 04 00:21:21.299372 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00418: Parent: Created child process 3060
[Thu Apr 04 00:21:23.213607 2013] [ssl:warn] [pid 3060:tid 280] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]
[Thu Apr 04 00:21:23.276605 2013] [mpm_winnt:notice] [pid 3060:tid 280] AH00354: Child: Starting 150 worker threads.
[Thu Apr 04 00:21:23.328611 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00428: Parent: child process exited with status 3221225725 -- Restarting.
[Thu Apr 04 00:21:24.584768 2013] [ssl:warn] [pid 260:tid 572] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]
[Thu Apr 04 00:21:24.649766 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00455: Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7 configured -- resuming normal operations
[Thu Apr 04 00:21:24.649766 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00456: Server built: Aug 18 2012 12:41:37
[Thu Apr 04 00:21:24.649766 2013] [core:notice] [pid 260:tid 572] AH00094: Command line: 'E:\\xampp\\apache\\bin\\httpd.exe -d E:/xampp/apache'
[Thu Apr 04 00:21:24.652768 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00418: Parent: Created child process 6620
[Thu Apr 04 00:21:26.551000 2013] [ssl:warn] [pid 6620:tid 364] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]
[Thu Apr 04 00:21:26.614999 2013] [mpm_winnt:notice] [pid 6620:tid 364] AH00354: Child: Starting 150 worker threads.
[Thu Apr 04 00:21:26.669006 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00428: Parent: child process exited with status 3221225725 -- Restarting.
[Thu Apr 04 00:21:27.826148 2013] [ssl:warn] [pid 260:tid 572] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]
[Thu Apr 04 00:21:27.886148 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00455: Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7 configured -- resuming normal operations
[Thu Apr 04 00:21:27.886148 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00456: Server built: Aug 18 2012 12:41:37
[Thu Apr 04 00:21:27.886148 2013] [core:notice] [pid 260:tid 572] AH00094: Command line: 'E:\\xampp\\apache\\bin\\httpd.exe -d E:/xampp/apache'
[Thu Apr 04 00:21:27.888150 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00418: Parent: Created child process 7032
[Thu Apr 04 00:21:29.761369 2013] [ssl:warn] [pid 7032:tid 332] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]
[Thu Apr 04 00:21:29.824377 2013] [mpm_winnt:notice] [pid 7032:tid 332] AH00354: Child: Starting 150 worker threads.
[Thu Apr 04 00:21:29.876385 2013] [mpm_winnt:notice] [pid 260:tid 572] AH00428: Parent: child process exited with status 3221225725 -- Restarting. 
```

我最好的猜测是我安装的应用程序中存在某种间谍软件。非常感谢您的阅读，欢迎提出任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:28:36.443

问题解决了：

NVIDIA FirstPacket 阻止了它。我禁用了它，它就像一个魅力。

# php - php mysql wordpress自动完成不起作用

> ID：15798751
> 
> 赞同：0
> 
> 时间：2013-04-03T21:44:53.700
> 
> 标签：php, wordpress, autocomplete

我已经链接到用于自动完成和 jquery 的适当 ajax 库。这是脚本

```
 jQuery(document).ready(function($) {
 $("#tag").autocomplete("data.php", {
  selectFirst: true
   });
  }); 
```

和我的 data.php 文件

```
 $q = $_GET["q"];
   $my_data=mysql_real_escape_string($q);
  $sql="SELECT comname FROM wp_birds WHERE comname LIKE '%$my_data%' ORDER BY comname";
  $result = mysql_query($sql) or die(mysql_error());
  if($result)
  {
   while($row=mysql_fetch_array($result))
    {
   echo $row['comname']."\n";
   }
 } 
```

和我的表格

```
<label>Tag:</label>
<input name="tag" type="text" id="tag" size="20"/> 
```

data.php 文件成功加载了逗号数组，但是当我输入时，我什么也没得到...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:53:23.050

jquery 无冲突包装器

```
jQuery(document).ready(function($) {
    $("#tag").autocomplete("data.php", {
      selectFirst: true
    });
}); 
```

参考：[http ://codex.wordpress.org/Function_Reference/wp_enqueue_script#jQuery_noConflict_Wrappers](http://codex.wordpress.org/Function_Reference/wp_enqueue_script#jQuery_noConflict_Wrappers)

**更新：**

您还需要使用 ajax 检索源

[http://jqueryui.com/autocomplete/#remote](http://jqueryui.com/autocomplete/#remote)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:06:41.747

包含在 wordPress 中的 jquery 库以“无冲突”模式加载。这样做是为了防止与其他 javascript 库的兼容性问题。在“无冲突”模式下，$ 快捷方式不可用，使用较长的 jquery，例如：

jQuery（文档）.ready（函数（$）{

# html - 像盒子一样，不同的页面

> ID：15798752
> 
> 赞同：0
> 
> 时间：2013-04-03T21:44:55.650
> 
> 标签：html, facebook, facebook-like, facebook-iframe

我在网站[I Am Stronger](http://iamstronger.ca/)上工作。在博客页面上，我有 2 个不同的点赞按钮，一个在顶部，一个用于实际的博客文章。

我希望博客帖子显示他们自己的“喜欢”总数。我的每个 URL 都不同，但由于某种原因，数字从一个传递到另一个。例如，[我喜欢这个故事](http://iamstronger.ca/index.php?page=ActivityDetail&story=12)，但[这个故事](http://iamstronger.ca/index.php?page=ActivityDetail&story=14)也说我喜欢它。它们的 iframe 代码不同，第一个指向第一个独特的故事（故事 12），第二个指向第二个故事（故事 14）。URL 是经过编码的，但分别如下所示：

```
<iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fhttp%3A%2F%2Fiamstronger.ca%2Findex.php%3Fpage%3DActivityDetail%26story%3D12&amp;send=false&amp;layout=button_count&amp;width=100&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font=segoe+ui&amp;height=21"></iframe>

<iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fhttp%3A%2F%2Fiamstronger.ca%2Findex.php%3Fpage%3DActivityDetail%26story%3D14&amp;send=false&amp;layout=button_count&amp;width=100&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font=segoe+ui&amp;height=21"></iframe> 
```

有人可以告诉我这个问题可能是什么吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:00:11.180

这是您在第一个链接中的代码：

```
<div class="fb-like fb_edge_widget_with_comment fb_iframe_widget" style="float: left;     margin-bottom: 5px;" data-show-faces="false" data-width="80" data-layout="button_count" data-send="false" data-href="http://iamstronger.ca/" fb-xfbml-state="rendered"> 
```

这在第二个链接中：

```
<div class="fb-like fb_edge_widget_with_comment fb_iframe_widget" style="float: left; margin-bottom: 5px;" data-show-faces="false" data-width="80" data-layout="button_count" data-send="false" data-href="http://iamstronger.ca/" fb-xfbml-state="rendered"> 
```

我认为问题在于它们都指向同一个网址。还检查了 Facebook 开发人员（[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)），代码可能类似于：

```
<fb:like href="http://iamstronger.ca/index.php?page=ActivityDetail&amp;story=12" send="false" width="450" show_faces="false"></fb:like> 
```

所以“story=xx”对于每个不同的博客条目都需要不同，你需要一种自动给出的方法（即不是硬编码）......

只是我的 5c :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:01:53.500

我的浏览器正在缓存它。它一直在工作。我现在真的觉得自己很傻。对不起>.<

# jquery - 每 3 秒执行一次操作，而不是单击按钮操作

> ID：15798756
> 
> 赞同：1
> 
> 时间：2013-04-03T21:45:09.260
> 
> 标签：jquery, time

我有一个像这样的脚本：

```
(function($){
    $(document).ready(function(){
    var sliderInstance = $('#content-slider').mySlider({
            directionNavEnabled: true,
            directionNavAutoHide: false,
            welcomeScreenEnabled:false,
            imageAlignCenter:true               

        }).data('mySlider');                
        $("#button-id").click(function() {
            sliderInstance.next();
    });
  });
})(jQuery); 
```

我怎样才能执行**sliderInstance.next();** 每 3 秒，而不是单击**#button-id**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T21:46:24.780

如果愿意，您可以每 3 秒生成一次合成点击事件。这需要最少的额外代码：

```
setInterval(function() { $("#button-id").click(); }, 3000); 
```

这将每 3 秒在按钮上生成一个单击事件。

如果您希望它直接调用脚本：

```
setInterval(function() { sliderInstance.next(); }, 3000); 
```

但是请记住，`setInterval`调用需要与 的定义在同一范围内`sliderInstance`，这可能会使第一个版本更容易或更难实现，具体取决于代码的结构。

# java - java - 无法让 Filewriter 上的“附加模式”为我工作

> ID：15798760
> 
> 赞同：0
> 
> 时间：2013-04-03T21:45:16.040
> 
> 标签：java

我一直在搜索，似乎给定的答案对我不起作用。

我的代码相对简单，它生成一个对象数组，用一些随机字符串填充它，然后尝试输出到一个文件。这个想法基本上是生成一个包含一些名称、登录名、密码等的 CSV 文件，并且名称是随机字母的字符串（长话短说，它是用于大量填充用户的环境......）

我有一个像这样的“作家”类：

```
 public class Writer {
    public static void log(String message) throws IOException { 

     PrintWriter out = new PrintWriter(new FileWriter("testlog.txt"), true); 
     out.println(message);

  out.close();
}
} 
```

像这样的循环：

```
 for (int y=0; y < num_names; y++) {
           try {
            Writer.log(arrayTest[y].first + "," + arrayTest[y].last + "," +     arrayTest[y].loginName + "," + arrayTest[y].password +
                    "," + arrayTest[y].email);
        } catch (IOException ex) {
            Logger.getLogger(Csvgenerator.class.getName()).log(Level.SEVERE, null, ex);
        }

   System.out.println(arrayTest[y].first + "," + arrayTest[y].last + "," + arrayTest[y].loginName + "," + arrayTest[y].password + 
           "," + arrayTest[y].email);    

 } 
```

我的期望是我将循环遍历 arrayTest[] 中的每个对象，并将单行数据输出到文件中。我包括 System.out.println 只是为了调试。

当我运行我的代码时，System.out.println 证明它工作正常——我得到一个包含 10 行的列表。（此处为 num_names = 10）所以这证明每次我到达这行代码时，我都有一个独特的“行”数据被打印出来。

然而，在运行结束时，文件“testlog.txt”只包含一行——我的输出中的最后一行。

我试过“out.append”而不是“out.println”，但没有区别。似乎每次我调用记录器时，它都会出于某种原因重新创建文件。

所以换句话说，如果我的控制台输出（来自 system.out.println）看起来像这样：

```
nxoayISPaX,aNQWbAjvWE,nanqwbajvwe,P@ssw0rd!,nanqwbajvwe@mylab.com
RpZDZAovgv,QOfyNRtIAN,rqofynrtian,P@ssw0rd!,rqofynrtian@mylab.com
SajEwHhfZz,VziPeyXmAc,svzipeyxmac,P@ssw0rd!,svzipeyxmac@mylab.com
sifahXTtBx,MRmewORtGZ,smrmewortgz,P@ssw0rd!,smrmewortgz@mylab.com
PlepqHzAxE,MQUJsHgEgy,pmqujshgegy,P@ssw0rd!,pmqujshgegy@mylab.com
VKYjYGLCfV,nuRKBJUuxW,vnurkbjuuxw,P@ssw0rd!,vnurkbjuuxw@mylab.com
YgvgeWmomA,ysKLVSZvaI,yysklvszvai,P@ssw0rd!,yysklvszvai@mylab.com
feglvfOBUX,UTIPxdEriq,futipxderiq,P@ssw0rd!,futipxderiq@mylab.com
RAQPPNajxR,vzdIwzFHJY,rvzdiwzfhjy,P@ssw0rd!,rvzdiwzfhjy@mylab.com
DeXgVFClyg,IEuUuvdWph,dieuuuvdwph,P@ssw0rd!,dieuuuvdwph@mylab.com 
```

那么 testlog.txt 只包含一行：

```
DeXgVFClyg,IEuUuvdWph,dieuuuvdwph,P@ssw0rd!,dieuuuvdwph@mylab.com 
```

我如何强制它继续使用相同的文件并只追加新行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T21:47:35.833

在构造函数`PrintWriter(Writer out, boolean autoFlush)`上，第二个布尔参数实际上是用于自动刷新，而不是附加模式。

我认为您打算改用`FileWriter(File file, boolean append)`构造函数，即：

```
PrintWriter out = new PrintWriter(new FileWriter("testlog.txt", true)); 
```

代替

```
PrintWriter out = new PrintWriter(new FileWriter("testlog.txt"), true); 
```

# php - MySqli 命令不同步；你现在不能运行这个命令

> ID：15798762
> 
> 赞同：8
> 
> 时间：2013-04-03T21:45:44.410
> 
> 标签：php, mysql, mysqli

我已将我的注册脚本从 mysql 转换为 mysqli。我像mysql一样工作得很好，但是现在它给了我错误

```
Commands out of sync; you can't run this command now 
```

这是我用来注册用户的功能

```
function register_user($register_data) { 
global $myConnection;
array_walk($register_data, 'array_sanitize'); 
//Make the array readable and seperate the fields from data 
$fields = '`' . implode('`, `', array_keys($register_data)) . '`'; 
$data = '\'' . implode('\', \'', $register_data) . '\''; 
//Insert the data and email an activation email to the user 
mysqli_query($myConnection, "INSERT INTO `members` ($fields) VALUES ($data)") or die(mysqli_error($myConnection)); 
email($register_data['mem_email'], 'Activate your account', "Hello " . $register_data['mem_first_name'] . ",\n\nThank you for creating an account with H Fencing. Please use the link below to activate your account so we can confirm you identity:\n\nhttp://blah.blah.co.uk/activate.php?mem_email=" . $register_data['mem_email'] . "&email_code=" . $register_data['email_code'] . "\n\n - David & Jay "); 
} 
```

电子邮件从我的阵列中发送正确的数据。但是没有数据插入到数据库中，我得到了上面提到的错误。我以前从未遇到过这个错误。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-03T21:53:25.303

> 如果您***的命令不同步；您现在无法在客户端代码中运行此命令***，您正在以错误的顺序调用客户端函数。
> 
> 例如，如果您正在使用 mysql_use_result() 并在调用 mysql_free_result() 之前尝试执行新查询，则可能会发生这种情况。如果您尝试执行两个返回数据的查询而不在两者之间调用 mysql_use_result() 或 mysql_store_result() ，也会发生这种情况。

从这里： [http ://dev.mysql.com/doc/refman/5.0/en/commands-out-of-sync.html](http://dev.mysql.com/doc/refman/5.0/en/commands-out-of-sync.html)

**更新**

如果您为查询创建一个变量并将变量直接粘贴到 MySQL Workbench 之类的东西中，您可以在执行之前检查语法。

```
<?php
            function myConnection(){
              $myConnection = mysqli_connect('localhost', 'my_user', 'my_password', 'my_db');
              return $myConnection;
            }   

    function register_user($register_data) { 
        array_walk($register_data, 'array_sanitize'); 
        //Make the array readable and seperate the fields from data 
        $fields = '`' . implode('`, `', array_keys($register_data)) . '`'; 
        $data = "'" . implode("', '", $register_data) . "'"; 
        //Insert the data and email an activation email to the user 
        $query = "INSERT INTO `members` ($fields) VALUES ($data)";
                    $myNewConnection = myConnection();          

                    if($result = mysqli_query($myNewConnection, $query)){ 
        email($register_data['mem_email'], 'Activate your account', "Hello " . $register_data['mem_first_name'] . ",\n\nThank you for creating an account with H Fencing. Please use the link below to activate your account so we can confirm you identity:\n\nhttp://blah.blah.co.uk/activate.php?mem_email=" . $register_data['mem_email'] . "&email_code=" . $register_data['email_code'] . "\n\n - David & Jay "); 
        mysqli_free_result($result);
         return ("Success");
        } else {
            echo $query;
            die(mysqli_error($myNewConnection));
        } 

    }

?> 
```

# python - App Engine 任务队列示例代码是否过时？

> ID：15798765
> 
> 赞同：0
> 
> 时间：2013-04-03T21:46:04.500
> 
> 标签：python, google-app-engine

我对任务队列的文档有一些问题。

与其他文档相比，此处的示例代码：[https](https://developers.google.com/appengine/docs/python/taskqueue/overview-push) ://developers.google.com/appengine/docs/python/taskqueue/overview-push似乎不正确。

我在尝试将参数传递给队列的 add 方法时遇到错误。

如果它已过时，是否有人知道如何使用队列的类似简单示例？

我的代码：

```
test_queue.add('/workers/testworker', params={'id': testmodel.key().id()})
TypeError: add() got an unexpected keyword argument 'params' 
```

文档中的示例代码：

```
taskqueue.add(url='/worker', params={'key': key}) 
```

Queue 文档似乎与示例代码所建议的完全不同，只接受两个参数：

“添加（任务，事务=假）”

只是想弄清楚我是否应该忽略这个示例代码，或者我是否在做一些非常愚蠢的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:11:02.703

这是做同一件事的两种不同方式。`taskqueue`正如您从导入中看到的那样，概览页面中的示例访问了整体功能。

您的代码是（大概，尽管您没有显示它）创建一个您已调用的 TaskQueue 实例，`test_queue`然后调用`add`它。正如您所发现的，Task 实例的`add`方法只接受一个 Task 实例和 transactional 参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T02:05:47.030

官方 GAE 示例需要认真更新和详细说明。那里有推送任务队列的好的和完整的例子吗？

# c# - 从 MainWindow 访问类的实例

> ID：15798775
> 
> 赞同：1
> 
> 时间：2013-04-03T21:46:49.233
> 
> 标签：c#, .net, wpf, mvvm

我有一个带有 MainWindow 的应用程序和另一个名为 MyClass 的类。MyClass 中有一个方法，我需要从 MainWindow 类访问它。MyClass 在应用程序加载时加载。如何在不创建 MyClass 的新实例的情况下从 MainWindow 调用 MyClass 中的方法：

```
MyClass class = new MyClass(); 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:02:28.377

您的问题的直接答案是将类方法标记为静态。这将允许您从任何地方调用它。

另一方面，它可能不是你真正需要的。因此，如果您`MyClass`在 Application 类中的应用程序启动时创建，那么您需要公开`MyClass`实例，例如，通过应用程序属性。查看示例代码。

```
public class MyClass
{
    public void Method()
    {
        // ...
    }
} 
```

您的应用程序代码：

```
public partial class App
{
    public MyClass MyClassInstance { get; private set; }

    private void Application_Startup(object sender, StartupEventArgs e)
    {
        MyClassInstance = new MyClass();
    }
} 
```

以及调用类方法的窗口代码：

```
public partial class MainWindow : Window
{
    private void Button_Click(object sender, RoutedEventArgs e)
    {
        ((App)Application.Current).MyClassInstance.Method();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:58:28.767

听起来很可疑，但是您通过使用该方法来做您所说的`static`

```
public partial class MainWindow
{
    public void MethodInMainWindow()
    {
        // Don't need to create a new instance of MyClass
        MyClass.MethodInMyClass();
    }
}

public class MyClass
{
    public static void MethodInMyClass()
    {
        //  ....
    }
} 
```

[这是关于静态与实例的一些文档](http://msdn.microsoft.com/en-us/library/aa645766%28v=vs.71%29.aspx)

# python - 比较列并打印越来越大的行

> ID：15798779
> 
> 赞同：0
> 
> 时间：2013-04-03T21:47:05.097
> 
> 标签：python, unix, awk

我以这种方式有2个文件

文件 1 有 1 行：

```
6
4 
13 
25 
35 
50  
65 
75 
and so on..... 
```

file2 有 1 行

```
24
45
76
and so on..... 
```

我想取 file2 中的每个值（一次一个）并与 file1 进行比较，如果 file1 的值小于该数字，则取这些值并将它们保留在列表中，然后根据数字对它们进行排序并打印最大值

例如：我在file2中取了24个数字并与file1进行比较，发现6,4和13低于该数字，然后我将它们提取并保存在列表中并对其进行排序并打印最大值（即13）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:09:49.933

awk 解决方案：

```
awk 'NR==FNR{a[$0];next} {b[FNR]=$0}
END{
        n=asort(b)
        for(j in a)
                for(i=n;i>0;i--)
                        if(b[i]<j){
                                print "for "j" in file2 we found : "b[i]
                                break
                        }
}' file2 file1 
```

输出：

```
for 45 in file2 we found : 35 
for 76 in file2 we found : 75 
for 24 in file2 we found : 13 
```

**注意**：有优化的空间。如果性能很关键，你可以考虑（只是建议）

*   对file1进行降序排序
*   对文件 2 升序排序
*   从排序的file2中取first，从file1中遍历file1.first，当你找到较小的时，记录位置/索引`x`
*   从排序的文件2中取第二个，从`file1.x`开始比较，当找到正确的一个时，更新`x`
*   直到file2结束

蛮力方式将采取或`O(mxn)`取决于`O(nxm)`哪个更大。`n``m`

上面的算法……我没分析，应该比`O(mxn)`……快；）

python 和 awk 都可以完成这项工作。如果可能，将这两个文件加载到内存中。如果你有怪物文件，那是另一个算法问题。例如排序大文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:18:37.917

将每个文件读入一个`list`，将每一行转换为`int`. 然后对两个列表进行排序以使我们能够有效地迭代，

```
file1 = sorted([int(l) for l in open('file1.txt').read().split()])
file2 = sorted([int(l) for l in open('file2.txt').read().split()])

i = 0
for file2_number in file2:
    while i+1 < len(file1) and file1[i+1] < file2_number:
        i += 1
    print file1[i] 
```

这当前会打印答案 ( `13 35 75`)，但您可以轻松修改它以返回`list`如果需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:20:46.610

使用 Python，首先将 file1 中的所有行和 file2 中的所有行读入两个单独的列表中，然后您可以简单地遍历它们，将文件 1 中的每个数字与 file2 中的每个数字进行比较，如下所示：

```
#First load each of the lines in the data files into two separate lists
file1Numbers = [6, 4, 13, 25, 35, 50, 65, 75]
file2Numbers = [24, 45, 76]
extractedNumbers = []

#Loops through each number in file2
for file2Number in file2Numbers:

    #Loops through each number in file 
    for file1Number in file1Numbers:

        #Compares the current values of the numbers from file1 and file2
        if (file1Number < file2Number):

            #If the number in file1 is less than the number in file2, add
            #the current number to the list of extracted numbers
            extractedNumbers.append(file1Number)

    #Sorts the list of extracted numbers from least to greatest
    extractedNumbers.sort()

    #Prints out the greater number in the list
    #which is the number located at the end of the sorted list (position -1)
    print extractedNumbers[-1] 
```

# java - JPA：无状态会话 bean 和托管实体

> ID：15798783
> 
> 赞同：0
> 
> 时间：2013-04-03T21:47:32.180
> 
> 标签：java, jakarta-ee, jpa, ejb

假设我有一个使用属性调用的 JPA`Foo`实体`String myStr`；

当我现在像这样定义无状态会话 bean 时：

```
@Stateless
@LocalBean
public class FooBean {

    @PersistenceContext(unitName="foo-pu")
    private EntityManager em;

    public Foo getFoo(int id) {
         return em.find(Foo.class,id);
    }

    public void changeMyStr(Foo entity) {
         entity.setMyStr("fooStr");
    }

} 
```

`changeMyStr()`如果我通过之前获取的`Foo`对象，所做的更改会持续存在`getFoo()`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T22:06:48.967

只要您对`getFoo(...)`和的调用`changeMyStr(...)`是在同一个事务中进行的`Foo`，如果该事务已提交，对实例的更改就应该保持不变。一旦您离开事务，实体通常会分离，因此如果您`getFoo(...)`在一个事务和`changeMyStr(...)`另一个事务中调用，则内部所做的更改`changeMyStr(...)`（以及在原始事务之外进行的任何其他更改）将*不会*被持久化。

如果您使用[扩展的持久性上下文](http://docs.oracle.com/javaee/6/api/javax/persistence/PersistenceContextType.html#EXTENDED)，实体在离开原始事务时*不会*分离，但这是一种相当不寻常的情况。阅读[这篇文章](https://blogs.oracle.com/enterprisetechtips/entry/extended_persistence_context_in_stateful)或[这篇](http://docs.jboss.org/ejb3/app-server/tutorial/extended_pc/extended.html)文章了解更多详情。

# database - 这种类型的数据转换叫什么？

> ID：15798786
> 
> 赞同：1
> 
> 时间：2013-04-03T21:47:43.457
> 
> 标签：database, normalization, denormalization

与同事讨论数据结构，并提醒我使用从“模式 A”转换为“模式 B”，这被认为是“规范化/反规范化”或模式转换还是什么？任何见解将不胜感激。

“模式 A”

```
表A
ID 键值
------------
1 A 23
1 B 250
2 乙 100

表B
关键描述
---------------
一个时代
B 重量

```

“模式 B”

```
表C
身份证年龄体重
--------------
1 23 250
2 无 100

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:04:30.170

这称为*旋转*。

由于缺乏更好的参考，我将链接到[SQL Server 的 PIVOT 实现](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)。

反过来称为*unpivot*。

您不需要特殊的 SQL 运算符来执行它们。Pivot 可以使用聚合来实现，而 unpivot 可以通过加入一个常量表来实现。

# apache - htaccess 将子域重定向到域 magento 存储

> ID：15798787
> 
> 赞同：1
> 
> 时间：2013-04-03T21:47:44.463
> 
> 标签：apache, .htaccess, magento, mod-rewrite, redirect

Magento 上有一家商店 - site.com。还有一个关于子域的商店视图，例如 sub1.site.com、sub2.site.com、sub3.site.com。一切正常，但按位设置的主题不适用于子域。Theme 使用 Mage::getUrl() 生成 AJAX 快速查看和添加到购物车的 URL。它使用商店的基本 URL。
从主站点 site.com 一切正常，预览 AJAX 工作正常。在子域上不起作用，因为形成子域 sub1.site.com/catalog/ajax_product/view 的基本 URL，但必须是 site.com/catalog/ajax_product/view 的形式。在子域上的 Htaccess 中的重定向，例如：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/(catalog/ajax_product/.*|checkout/cart/add/.*)$
RewriteRule ^(.*)$ http://site.com/$1/ [R=301,L] 
```

不工作！

帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T10:20:59.853

I'm not sure if your application configuration is correct. In my opinion you don't need to make redirection with `.htaccess`. So here are couple of checkpoints:

1) Check that you have set a correct Base secure and unsecure URLs in Back Office (Admin Panel) for each store view (subdomain)

`System > Configuration > Web > (Un)secure > Base Url`

By default there should be [http://store.com](http://store.com), and for each website (regarding Magento scope) URL should be different.

2) Cookie domain must be set for each store view respectively.

`System > Configuration > Web > Session Cookie Management > Cookie Domain`

For the default store you can leave it empty, but you must fill it for others, e.g. `.sub1.store.com`, `.sub2.store.com`, etc. Note that dot ('.') at the beginning is mandatory.

3) Set Apache vhosts for each domain.

You should have separate entries for `site.com`, `sub1.site.com`, etc in your vhosts configuration.

Now you can define which store view to load based on the domain. You can do this in 3 ways:

*   .htaccess
*   modify index.php of application
*   set proper Env variable directly in vhost

In [this](https://stackoverflow.com/a/15769388/400437) post you can find each mentioned solution.

While dealing with multiple store views and domains with Magento it is all about to load a proper store code in `Mage::run()` method.

Here's an example for `.htaccess` solution:

```
SetEnvIf Host .*sub1.site.com.* MAGE_RUN_CODE="sub1"
SetEnvIf Host .*sub2.site.com.* MAGE_RUN_CODE="sub2"

```

Don't forget to flush cache and perform reindex of all entities after you set is all correct.

# xcode - 将 jj 映射到 使用 XVim 插件

> ID：15798788
> 
> 赞同：2
> 
> 时间：2013-04-03T21:47:48.660
> 
> 标签：xcode, vim, xvim

XVim 声称可以阅读*~/.xvimrc*但我没有看到任何效果。有没有人让这个工作？

这是我的*.xvimrc*示例：

```
nmap jj <esc> 
```

我也试过：

```
imap jj <esc> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-27T20:19:58.880

不是针对您的具体情况的答案，但如果您的 .xvimrc 有：

```
inoremap jk <Esc> 
```

这对我不起作用，实际上在尝试向下移动光标时会严重减慢 j 键的速度。切换到：

```
imap jk <Esc> 
```

确实为我修复了它（Xcode 4.6.3）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T20:25:56.070

它对我有用

`imap jj <Esc>`

使用 Xcode 4.6.2 和 XVim dc470f5（大约一个月大）。

也许 Esc 区分大小写？

# javascript - 使用 jquery 淘汰赛 js 检索 gravatar

> ID：15798789
> 
> 赞同：0
> 
> 时间：2013-04-03T21:47:49.567
> 
> 标签：javascript, asp.net-mvc, json, knockout.js, md5

我正在尝试将多种用途的 gravatar 显示在一个页面中，为此我正在使用 foreach 循环。此外，我正在使用淘汰赛 js 来获取电子邮件和姓名等信息，并以 json 形式返回。由于我不能将剃刀与 gravatar 一起使用，因为它要求将字符串作为电子邮件传递，而我所拥有的将返回“data-bind="text:Email"

我正在尝试使用 MD5 概念，我对此很陌生，不确定我是否遵循正确的步骤。我从谷歌代码在线找到了这个：http: [//www.devcurry.com/2012/06/retrieving-gravatar-using-jquery.html](http://www.devcurry.com/2012/06/retrieving-gravatar-using-jquery.html)

我试图实现但不确定我的代码是否正确编写：

**我的 javascript 的一部分与我正在做的事情有关：**

```
$.views.Games.UserViewModel = function (data) {
    var self = this;
    self.Name = ko.observable(data.Name);
    self.Email = ko.observable(data.Email);

    self.Hash = CryptoJS.MD5(Email);
}; 
```

**我的浏览页面：**

```
<img alt="Gravatar" title="My Gravatar" data-bind="attr:{href:'http://www.gravatar.com/avatar/' +Hash()+'?s=30&amp;d=identicon&amp;r=G'}" /> 
```

有了这个，我没有得到一个 gravatar 来显示。非常感谢任何有用的信息或提示。

**代码更新**

我改变了，所以它看起来是这样的：

**查看模型**
`public string MD5Email { get{ return Email.MD5Hash(); } }`

**javascript**
`self.MD5Email = ko.observable('http://www.gravatar.com/avatar/' + data.MD5Email + '?s=30&amp;d=identicon&amp;r=G');`

**查看页面**
`<img width="158" height="158" alt="Gravatar" data-bind="attr:{'src':MD5Email()}"/>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:46:48.167

首先，不要将 JS 逻辑放在数据绑定中。改用计算：

```
self.GravatarUrl = computed(function() {
    return 'http://www.gravatar.com/avatar/' + self.Hash() + 's=30&amp;d=identicon&amp;r=G';
}); 
```

其次，您`Hash`还需要成为计算的可观察对象。你现在拥有它的方式，它只评估一次，当 JS 第一次运行时，最有可能`Email`为空。因此，您的 Gravatar URL 永远不会填充有效的电子邮件哈希值。

```
self.Hash = computed(function() {
    return CryptoJS.MD5(self.Email);
}); 
```

但是，由于此时此`Hash`计算仅用于为其他计算提供服务，因此您可以并且应该将两者结合起来：

```
self.GravatarUrl = computed(function() {
    var hash = CryptoJS.MD5(self.Email);
    return 'http://www.gravatar.com/avatar/' + hash + 's=30&amp;d=identicon&amp;r=G';
}); 
```

然后，您的数据绑定变得简单：

```
<img alt="Gravatar" title="My Gravatar" data-bind="attr:{ href: GravatarUrl }" /> 
```

干净多了。

**更新基于 OP 的更新**

我不确定您为什么更改了我给您的代码的逻辑，但这就是它不起作用的原因。

首先，您似乎已经放弃了 Javascript 中的 MD5 并将其添加到您的视图模型中。这很好，但是您已经引入了与之前相同的逻辑问题，方法是将 设置为`self.MD5Email`基于`data.Email`. 这不是计算数据和数据。电子邮件不是可观察的。它仅在 KO 视图模型的初始创建时存在。你应该做的是这样的：

```
self.MD5Email = ko.observable(data.MD5Email);

self.Gravatar = ko.computed(function () {
    return 'http://www.gravatar.com/avatar/' + self.MD5Email() + '?s=30&amp;d=identicon&amp;r=G'
}); 
```

您正确地更正了设置 img src 而不是 href （我也错过了），但是当您不同时执行其他 JS 逻辑时，使用括号是不必要的，所以它应该是：

```
data-bind="attr: { src: Gravatar }" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-25T20:34:44.330

不确定这是否有帮助，但我最近编写了一个绑定来执行此操作：

[https://github.com/grofit/knockout.gravatar](https://github.com/grofit/knockout.gravatar)

因此，您可以使用淘汰赛绑定优势来使用它。

# c++ - 在 OpenCV 中将两个网络摄像头信息拼接在一起

> ID：15798792
> 
> 赞同：4
> 
> 时间：2013-04-03T21:48:23.113
> 
> 标签：c++, opencv, video-capture, image-stitching

使用下面的代码：

```
#include <opencv2/opencv.hpp>
#include <opencv2/stitching/stitcher.hpp>
#include <iostream>
#include <vector>

using namespace std;
using namespace cv;

int main(int argc, char *argv[])
{
    Mat fr1, fr2, pano;
    bool try_use_gpu = false;
    vector<Mat> imgs;
    VideoCapture cap(0), cap2(1);

    while (true)
    {
        cap >> fr1;
        cap2 >> fr2;
        imgs.push_back(fr1.clone());
        imgs.push_back(fr2.clone());

        Stitcher test = Stitcher::createDefault(try_use_gpu);
        Stitcher::Status status = test.stitch(imgs, pano);

        if (status != Stitcher::OK)
        {
            cout << "Error stitching - Code: " <<int(status)<<endl;
            return -1;
        }

        imshow("Frame 1", fr1);
        imshow("Frame 2", fr2);
        imshow("Stitched Image", pano);

        if(waitKey(30) >= 0) 
            break;
    }
    return 0;
} 
```

此代码会抛出 1 的状态错误。我不知道这意味着什么，也不知道为什么这件事很难处理网络摄像头的馈送。怎么了？

-托尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T07:51:22.427

错误出现在您的捕获过程中，而不是拼接部分。此代码工作正常（使用[这些](http://imgur.com/a/u34NJ)示例图像）：

```
#include <opencv2/opencv.hpp>
#include <opencv2/core/core.hpp>
#include <opencv2/stitching/stitcher.hpp>
#include <iostream>
#include <vector>

using namespace std;
using namespace cv;

int main()
{
    Mat fr1 = imread("a.jpg");
    Mat fr2 = imread("b.jpg");
    Mat pano;
    vector<Mat> imgs;

    Stitcher stitcher = Stitcher::createDefault(); // The value you entered here is the default

    imgs.push_back(fr1);
    imgs.push_back(fr2);

    Stitcher::Status status = stitcher.stitch(imgs, pano);

    if (status != Stitcher::OK)
    {
        cout << "Error stitching - Code: " <<int(status)<<endl;
        return -1;
    }

    imshow("Frame 1", imgs[0]);
    imshow("Frame 2", imgs[1]);
    imshow("Stitched Image", pano);
    waitKey();

    return 0;
} 
```

Nik Bougalis 挖出的错误消息听起来像是拼接器无法连接图像。图像是否足够清晰，可以让缝合器找到对应关系？

如果您确定它们是，请进一步拆分您的问题以找到真正的错误。您可以调整拼接器以处理相机中的静止帧吗？您的相机是否正确捕捉？他们返回哪种类型的图像？

另一方面，拼接不太可能实时工作，这使得捕获期间的循环看起来有点不合适。您可能希望提前捕获帧并在后处理中完成所有操作，或者期望进行大量手动优化以接近可观的帧速率。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T23:01:31.500

浏览 OpenCV[网站](http://docs.opencv.org/trunk/modules/stitching/doc/high_level.html)，我们发现：

```
class CV_EXPORTS Stitcher
{
public:
    enum { ORIG_RESOL = -1 };
    enum Status { OK, ERR_NEED_MORE_IMGS };

    // ... other stuff 
```

由于返回的代码是类型`Sticher::Status`，我们可以相当肯定它`1`实际上是`Sticher::Status::ERR_NEED_MORE_IMGS`。这表明贴纸需要更多图像。

恐怕不是很丰富，但这对你来说是一个开始。你看过那里的任何缝合例子吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T14:58:55.770

无论出于何种原因，问题都在于 .clone() 段。将代码更改为：

```
int main(int argc, char *argv[])
{
    Mat fr1, fr2, copy1, copy2, pano;
    bool try_use_gpu = false;
    vector<Mat> imgs;
    VideoCapture cap(0), cap2(1);

    while (true)
    {
        cap >> fr1;
        cap2 >> fr2;
        fr1.copyTo(copy1);
        fr2.copyTo(copy2);        

        imgs.push_back(copy1);
        imgs.push_back(copy2);

        //ETC
     }
     return 0;
} 
```

这工作得很好。

# google-maps - 在 A WEBPAGE 内的 Google 地图上获取标记位置

> ID：15798796
> 
> 赞同：0
> 
> 时间：2013-04-03T21:48:50.570
> 
> 标签：google-maps

我想要标记位置列表，是否可以从我不拥有的网页中获取。

例如，我需要此页面中的子列表[http://bayi.eshot.gov.tr/](http://bayi.eshot.gov.tr/) 当您单击“Bayi Sorgula”时，AJAX 请求会加载数据并在谷歌地图上创建标记。有人可以将子公司的坐标、名称和地址作为列表获取吗？这样做的方法是什么？

还有这个数据收集过程的特殊词是什么？数据收集、挖掘、爬取？从网站获取数据的关键字是什么？

当我在浏览器上检查元素时，我可能会获得这一行作为标记。这只有顶部和左侧 px 值用于绝对定位。

```
<img style="width: 16px; height: 16px; border: 0px; padding: 0px; margin: 0px; position: absolute; left: 338px; top: 416px; z-index: -122731136; cursor: pointer;" src="App_Themes/images/1.png" id="mtgt_unnamed_612"> 
```

我真的不知道如何做到这一点。

非常感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T08:34:20.157

我得到了使用 Chrome 的这个功能的解决方案。 [在 Chrome 中请求监控](https://stackoverflow.com/questions/1820927/request-monitoring-in-chrome)

我通过监控捕获请求数据并自己清理它。

不管怎么说，还是要谢谢你。

# java - java类和数据库查询

> ID：15798807
> 
> 赞同：0
> 
> 时间：2013-04-03T21:49:33.950
> 
> 标签：java, database, dao

有人可以解释解决这个问题的最佳方法。

假设我有三个班级

1人

2.场地

3.车辆

我有一个 DAO 方法，它需要在执行查询后从每个类返回部分或全部这些属性。

我该如何做到这一点？创建一个类 PersonVenueVehicle 并将其作为对象返回以获取实例字段值似乎是非常错误的。

我被告知数据库实体必须由类反映，如果是这种情况，它是如何在这种情况下实现的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:12:42.307

尝试 Spring-ish 解决方案。除了你的三个类之外，你还可以有 3 个 DAO 类，每个类一个。但是您有任务要执行；我不知道它是什么；我只是猜测。

假设您正在运营出租车服务；`Person`s 安排通过你公司的出租车在 a 接他们`Venue`，然后你送他们 a `Vehicle`。将此组合称为 a `Trip`，现在您需要一个`Trip`在数据库中管理 s 的类。创建一个名为`TripService`. 这应该使用 your `PersonDao`、 your`VenueDao`和 your`VehicleDao`在数据库中创建必要的人员和地点记录，并且应该进行所需的计算以选择`Vehicle`使用哪个。当它这样做时，它应该使用 new`TripDao`来持久化一个新`Trip`对象。但是，作为组织者，它应该创建和提供与所有 DAO 的数据库连接，并且应该自己进行提交或回滚。

如果您使用的是 Hibernate 或 JPA，则可以修改您的类。但原理是一样的。即使我的动机错误，您也可以编写一个服务来协调三个 DAO 并提供连接。如果必须，它可以使用连接本身对连接在一起的三个表执行 SELECT。

如果您编写的唯一语句是简单的 SELECT、UPDATE 和 INSERT，那么您将失去数据库的大部分好处

# grails - Groovy 动态对象 - 如何正确重置属性？

> ID：15798808
> 
> 赞同：0
> 
> 时间：2013-04-03T21:49:35.787
> 
> 标签：grails, dynamic, groovy, metaprogramming, metaclass

基于[这个问题](https://stackoverflow.com/questions/6568397/groovy-dynamic-property-per-object)，我创建了一个具有动态属性的 Groovy 类。

```
class MyDynamic {
  def propertyMissing( String name, value ) {
    this.metaClass."$name" = value
    value
  }
} 
```

到目前为止一切都很好，现在我可以成功设置一些不存在的属性

```
MyDynamic dyna = new MyDynamic()
dyna.someProp = new Date() 
```

当我有另一个具有相同属性名称但具有另一种类型的实例时，我的问题就开始了

```
MyDynamic dyna2 = new MyDynamic()
dyna2.someProp = "0" //GroovyCastException: Cannot cast object '0' with class 'java.lang.String' to class 'java.util.Date' 
```

实际上我需要这个，因为我在不知道表和列的情况下使用查询结果创建对象。我用 获取列的名称`ResultSetMetaData`并将属性添加到动态对象的实例中。稍后我将使用这个对象来导出所有的属性和值。在不同的表中，我有相同的列名，但类型不同。

所以我的问题是：当我完成实例以不与其他实例冲突时，如何重置此元类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:05:48.650

为什么不使用[Expando](http://mrhaki.blogspot.com.br/2009/10/groovy-goodness-expando-as-dynamic-bean.html)、 Map 或简单容器：

```
class Dynamic {
  def properties = [:]
  void setProperty( String name, value ) {
    properties[name] = value
  }

  def getProperty(String property) { properties[property] }
}

d = new Dynamic()

d.name = "yeah"
assert d.name.class == String

d.name = new Date()
assert d.name.class == Date 
```

# linux - 如何在服务器模式下自动浏览特定网站？WATIR 呢？

> ID：15798810
> 
> 赞同：1
> 
> 时间：2013-04-03T21:49:50.533
> 
> 标签：linux, watir, watir-webdriver

我需要创建一个服务器来侦听客户端请求并使用与网站的连接来进行搜索并将结果返回给其客户端。

该网站是特定的，需要具有 javascript 支持的完整网络浏览器才能工作。此外，它需要身份验证，我一次只能发出一个请求。因此，如果它们同时出现，我需要使用队列来发送请求。

首选平台是 Linux。我找到了 WATIR 项目，还有其他方法吗？最好的方法是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T07:43:09.837

Watir 在 Linux 上工作，我认为它可以完成这项工作。如果服务器是无头的，您甚至可以驱动[无头 Firefox](http://watirwebdriver.com/headless/)和 PhantomJS。

# windows - Tomcat 7 service.bat 文件丢失

> ID：15798813
> 
> 赞同：17
> 
> 时间：2013-04-03T21:49:54.563
> 
> 标签：windows, tomcat, windows-services, tomcat7

我喜欢使用命令行将 Tomcat 安装为 Windows 服务。应该有用于此目的的*service.bat*文件。但是 Tomcat 7.0.37 和 7.0.39 中缺少它。我们不能将 Windows 安装程序用于嵌入式，所以这不是一个选项。

感谢帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-04T10:40:48.563

你确定你下载了正确的包吗？

从最新 Tomcat 7 版本（撰写本文时为 7.0.39）的[下载页面，根据您的需要进行选择：](http://tomcat.apache.org/download-70.cgi)

*   32 位 Windows 压缩包
*   64 位 Windows 压缩包

这两个包**的*****bin*****目录中都有***service.bat* 。

 *同样在[下载页面上](http://tomcat.apache.org/download-70.cgi#Mirrors)阅读 README 文件以获取包装信息。它解释了每个发行版包含的内容。

* * *

## 更新

从 README 文件中获取包装信息（重点是我的）：

> *apache-tomcat-[version].zip 或 .tar.gz*
>        **基本发行版**。这些发行版**不包括 Windows 服务**包装器，也不包括为 Windows 编译的 APR/本机库。
> 
> *apache-tomcat-[version]-windows-x86.zip*
>        **32 位 Windows 特定**发行版，**包括 Windows 服务**包装器和编译的 APR/native 库，用于 32 位和 64 位 Windows 平台上的 32 位 JVM。
> 
> *apache-tomcat-[version]-windows-x64.zip*
>        **64 位 Windows 特定**发行版，**包括 Windows 服务**包装器和编译的 APR/native 库，用于 x64 Windows 平台上的 64 位 JVM。

*您可能还会发现阅读RUNNING.txt*文件 很有用，该文件在每个发行版中都可用。它包含有关安装/配置/运行 Apache Tomcat 的重要细节以及 Windows 和 *nix 特定说明。

Tomcat 是一个 Java 应用程序。所以它是跨平台的。但是**，如果您想/需要使用 Windows 特定功能**，例如您的情况下的 Windows 服务，那么您应该下载 Windows 特定发行版。

* * *

## 其他想法

我自己在我的 Windows 机器上使用“**基本分发”（即不是 Windows 特定的，而是在***Binary Distributions => Core*下的下载页面上提供的普通 ZIP 文件）没有任何问题，因为我不想打扰安装（即运行安装程序），但只是简单地将分发包解压缩到所需的目录并使用相关的[*配置*文件](http://tomcat.apache.org/tomcat-7.0-doc/config/index.html)手动配置它。安装（只需解包）和删除安装（无需运行任何卸载程序即可删除）都更加容易和方便，并且更便携。另外，通过这种方式，您可以在同一台机器上安装多个版本的 Tomcat（以防您出于某些开发/测试原因需要它）。

这是一个非常有用的分步教程，有一些很好的插图和解释：

*   [如何安装 Apache Tomcat 7/8（在 Windows、Mac、Ubuntu 上）并开始使用 Java Servlet 编程](http://www.ntu.edu.sg/home/ehchua/programming/howto/Tomcat_HowTo.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-06T15:55:13.413

在[官网](http://tomcat.apache.org/download-70.cgi)，core下。不要下载标记为**zip**的版本。下载标记**为 32-bit Windows zip**或**64-bit Windows zip**的版本。你会在 Bin 下找到**Service.bat***

# javascript - 如何使用 Node.js 处理 CSS？

> ID：15798816
> 
> 赞同：1
> 
> 时间：2013-04-03T21:50:06.187
> 
> 标签：javascript, node.js, pug

我正在尝试仅使用纯香草`Node.js`，除了教育目的所需的框架外，没有其他框架。我目前有这个设置：

```
var fs = require('fs'),
  jade = require('jade');

function compile(dirPath, res) {
    var filePath = __dirname + dirPath;
    fs.readFile(filePath, 'utf8', function(err, fd) {
        var fn = jade.compile(fd, { filename: filePath, pretty: true});
        res.write(fn());
        res.end();
    });

}

exports.compile = compile; 
```

当请求请求的页面时调用它，如下所示：

```
var jadec = require('./jadecompile');

function start(res, postData) {
    res.writeHead(200, {"Content-Type": "text/html"});
    var cpage = '/staticpages/index.jade',
         page = jadec.compile(cpage, res);
} 
```

该页面加载得很好，我将其作为我的视图源：

```
<!DOCTYPE html>
<html>
  <head>
    <title>Hello!</title>
    <link rel="text/css" href="assets/css/bootstrap.css">
  </head>
  <body>
    <div class="hero-unit">
      <p>Hello This Is A Test</p>
    </div>
  </body>
</html> 
```

但是 css 根本不起作用，我一直在尝试用谷歌搜索它，但每个答案似乎都使​​用 express 或其他东西，但我想学习如何尽可能地做到这一点，所以我的问题是，怎么能我处理 *.css 以便正确加载 css，当我单击`href`视图源中的链接时，它会加载我的 404 页面，而不仅仅是 css 文件的纯文本。谢谢！

随意查看回购：[https ://github.com/Gacnt/Node-Tests](https://github.com/Gacnt/Node-Tests)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T04:55:13.370

我设法通过创建一个函数来处理静态页面（例如 .css 或 .js）来解决我的问题，如下所示：

```
var http = require('http'),
     url = require('url'),
    path = require('path');
      fs = require('fs');

// ADDED THIS FUNCTION HERE -----------------------------------------------------
function handleStaticPages(pathName, res) {
    var ext = path.extname(pathName);
    switch(ext) {
        case '.css':
            res.writeHead(200, {"Content-Type": "text/css"});
            fs.readFile('./' + pathName, 'utf8', function(err, fd) {
                res.end(fd);
            });
            console.log('Routed for Cascading Style Sheet '+ pathName +' Successfully\n');
        break;
        case '.js':
            res.writeHead(200, {"Content-Type": "text/javascript"});
            fs.readFile('./' + pathName, 'utf8', function(err, fd) {
                res.end(fd);
            });
            console.log('Routed for Javascript '+ pathName +' Successfully\n');
        break;
    }
}
// ADDED THIS FUNCTION HERE -----------------------------------------------------

function start(route, handle) {
    function onRequest(req, res) {
        var postData = "",
            pathName = url.parse(req.url).pathname;
        console.log('Request for ' + pathName + ' received.');

        req.addListener('data', function(data) {
            postData += data;
            console.log('Received POST data chunk ' + postData + '.');
        });

        req.addListener('end', function() {
            var pathext = path.extname(pathName);
            if (pathext === '.js' || pathext === '.css') {
            handleStaticPages(pathName, res);
        } else {
            console.log('--> Routing only the view page');
            route(handle, pathName, res, postData);
        }
        });
    }

    http.createServer(onRequest).listen(4000);
    console.log('Server is now listening at: http://127.0.0.1:4000 .');
}

exports.start = start; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-19T17:23:56.087

为了处理 .css 和其他静态文件，需要有一个文件流。您可以使用以下语句，而不是使用 switch 语句。

var stream = fs.createReadStream(path); //创建文件流 stream.pipe(res); //传输文件

# matlab - Matlab中的平滑颜色图

> ID：15798819
> 
> 赞同：7
> 
> 时间：2013-04-03T21:50:25.423
> 
> 标签：matlab

如何在 Matlab 中创建平滑的颜色图？

这就是我现在的位置。我使用 imagesc 功能，并发送给您两张图像。其中之一更平滑，更好看，那是因为我使用了更密集的网格来计算函数。但是，它仍然是离散的。我怎样才能使它顺利？

![在此处输入图像描述](https://i.stack.imgur.com/Gq3Nh.png) ![在此处输入图像描述](https://i.stack.imgur.com/XADNh.png)

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-03T22:27:18.507

听起来您需要具有更多层次的颜色图。所有颜色图生成器都接受一个参数，该参数描述要包含的离散颜色的数量。尝试增加这个数字；我认为默认值类似于 64。例如：

```
colormap(jet(4096)) 
```

如果您愿意，您可以进一步增加该数字，但最终您会达到 24 位色彩空间的限制。

顺便说一句，人眼对蓝色色调的颜色渐变最敏感，因此您可以做的另一件事是选择备用颜色图。

# java - Mongodb：无法保存添加到 BasicDBList 中的新元素

> ID：15798820
> 
> 赞同：0
> 
> 时间：2013-04-03T21:50:26.447
> 
> 标签：java, mongodb, mongodb-java

我正在尝试将一个元素添加到 BasicDBList 数组并将其保存回 Mongodb，但是当我检查结果时，它没有被写入。我做错了什么？我使用 java 驱动程序版本 2.7.2。

```
DBObject dbObject = coll.findOne(dbQuery);

BasicDBList unreadMsgs = (BasicDBList) dbObject.get("unreadMsgs");

Logger.debug("before incrementing unreadMsgs" + dbObject.toString());

unreadMsgs.add(new BasicDBObject("id", 1).append("unreadMsg", 1));
Logger.debug("after incrementing unreadMsgs : " + dbObject.toString());
coll.save(dbObject);
Logger.debug("check result: " + coll.findOne(dbQuery).toString()); 
```

在增加 unreadMsgs{ "_id" : { "$oid" : "515c5eb88e3278e9c9d55867"} , "unreadMsgs" : [ ]} 之前

增加 unreadMsgs 后：{“_id”：{“$oid”：“515c5eb88e3278e9c9d55867”}，“unreadMsgs”：[{“id”：1，“unreadMsg”：1}]}

检查结果：{“_id”：{“$oid”：“515c5eb88e3278e9c9d55867”}，“unreadMsgs”：[]}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:17:26.390

*save*调用应该适用于这种情况，但我建议您使用带有*$addToSet*操作的*更新。*

 *这是代码：

```
DBObject addToSetObj = BasicDBObjectBuilder.start()
    .push("$addToSet")
        .push("unreadMsgs")
            .add("id", 1)
            .add("unreadMsg", 1)
        .pop()
    .pop()
.get();

// addToSetObj will be { "$addToSet" : { "unreadMsgs" : { "id" : 1 , "unreadMsg" : 1}}}

coll.update(dbQuery, addToSetObj);
Logger.debug("check result: " + coll.findOne(dbQuery).toString()); 
```

对如何使用 addToSet 有任何疑问，请查看：[http ://docs.mongodb.org/manual/reference/operator/addToSet/](http://docs.mongodb.org/manual/reference/operator/addToSet/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:56:18.303

谢谢大家的回答。我发现了真正的问题。事实证明，我的集合是有上限的，并且不允许我将更多数据插入到有上限的集合中的现有文档中。将 WriteConcern 更改为 FSYNC_SAFE 后，我看到了异常。我将所有收藏都更改为无上限，并且代码现在可以使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T23:32:41.490

问题是 coll.save(dbObject) 没有更新任何东西。

它作为插入工作，并且由于集合中已经存在 _id，因此您会收到 duplicateKey 异常（由于配置，您只是看不到它）。

你必须使用更新，[这里](http://docs.mongodb.org/manual/applications/update/#crud-update-update)是如何*

# android - Android HttpsURLConnection on 2.3.4 OutOfMemoryError 上传大文件（内存中的字节 []）

> ID：15798824
> 
> 赞同：1
> 
> 时间：2013-04-03T21:50:38.813
> 
> 标签：android, out-of-memory, httpurlconnection, large-files

我正在尝试在服务器上上传约 10 MB 的大文件，并意识到在 2.3.4 上，流在写入服务器之前首先写入内存，我通过查看堆内存转储来确认此行为，因为对于大文件它会导致 OutOfMemory 异常。我在 4.2 设备上看不到相同的行为。

以下是我正在使用的代码：

```
 URL url = new URL(uri);
    connection = (HttpsURLConnection) url.openConnection();
    connection.setDoOutput(true);
    connection.setRequestMethod("PUT");
    connection.setRequestProperty("content-type", "");
    connection.setRequestProperty("Accept-Encoding", "");                                    
    connection.setFixedLengthStreamingMode((int)totalBytes);
    out = new BufferedOutputStream(connection.getOutputStream());
    fis = new BufferedInputStream(new FileInputStream(file));

    byte[] buffer = new byte[32 * 1024];
    int bytesRead = 0;
    int totalBytesRead = 0;
    while ((bytesRead = fis.read(buffer)) != -1)
    {
        totalBytesRead = totalBytesRead + bytesRead;                
            out.write(buffer, 0, bytesRead);// OOM Error                
    }

    out.flush(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T14:40:37.623

我向 google-android 提交了一个错误，他们声称它已针对 GingerBread 版本修复，但我仍然能够在 2.3.4 中复制该问题

链接到错误[https://code.google.com/p/android/issues/detail?id=53946](https://code.google.com/p/android/issues/detail?id=53946)和 [https://code.google.com/p/android/issues/detail?id=3164](https://code.google.com/p/android/issues/detail?id=3164)

我最终将 HttpClient 用于**Eclair**、**Froyo**、**GingerBread** 和 HttpURLConnection 用于**HoneyComb**及以上

# objective-c - 如何使财产的财产

> ID：15798827
> 
> 赞同：-2
> 
> 时间：2013-04-03T21:51:08.307
> 
> 标签：objective-c

我不太确定如何表达这个问题，所以我会举例说明。我想为一个财产创造一个财产。我目前正在使用来自不同类的属性：

```
player = [[Player alloc] init];
player.name = @"PlayerName"; 
```

这些属性在 Player 类中定义，并导入 Player.h。

我想为 .name 提供一个“子属性”，所以它看起来像 player.name.newProperty。UILabel 就是一个例子：

```
labelName = [[UILabel alloc] init];
self.labelName.text = @"String"; // .text being the 'sub-property' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:54:51.280

现在，`player.name`是一个`NSString`

如果`NSString`您将其设置为自定义类而不是 ，则使用它自己的属性，您将能够将它们作为“子属性”访问

```
player.name = [[MyCustomObject alloc] init];
player.name.subProperty = @"value"; 
```

请记住，您需要为 MyCustomObject 创建适当的 .m 和 .h 文件并定义其属性。

# asp.net-mvc - HttpModule 仅在特定 MVC 路由上

> ID：15798828
> 
> 赞同：3
> 
> 时间：2013-04-03T21:51:12.877
> 
> 标签：asp.net-mvc, asp.net-mvc-4, routes, httpmodule

我有一个习惯`IHttpModule`，我只想在特定的路线上工作。

例如 ：`http://example.com/HandleAzureTask`

我希望这个模块只在`/HandleAzureTask`路由上被调用/处理。

由于这不是一个控制器，我不能真正设置`[Authorize]`它的属性；如果用户经过身份验证，我如何强制它只被调用/处理？

我在 ASP.NET MVC 4 上，目前已将我的模块添加到 web.config 中，如下所示：

```
<modules>
  <remove name="AzureWebDAVModule" />
  <add name="AzureWebDAVModule" type="VMC.WebDAV.Azure.Module.AzureWebDAVModule, VMC.WebDAV.Azure.Module" />
</modules> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T19:22:27.690

每个请求都会调用 HttpModules（相反，可以过滤 HttpHandlers）。如果您只想在选定的路线上执行任务，您可以执行以下操作：

设置这样的路线：

```
routes.MapRoute(
    name: "AzureWebDAVRoute",
    url: "HandleAzureTask",
    // notice the enableHandler parameter
    defaults: new { controller = "YourController", action = "YourAction", enableHandler = true }
); 
```

在您的模块上：

```
public class AzureWebDAVModule : IHttpModule
{
    public void Init(HttpApplication context)
    {
        // you can't directly access Request object here, it will throw an exception
        context.PostAcquireRequestState += new EventHandler(context_PostAcquireRequestState);
    }

    void context_PostAcquireRequestState(object sender, EventArgs e)
    {
        HttpApplication context = (HttpApplication)sender;
        RouteData routeData = context.Request.RequestContext.RouteData;

        if (routeData != null && routeData.Values["enableHandler"] != null)
        {
            // do your stuff
        }
    }

    public void Dispose()
    {
        //
    }
} 
```

现在您的任务将仅在选定的路线上执行。请注意，您需要该参数，因为您无法按名称找到当前路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:36:51.863

为什么不创建一个名为 /HandleAzureTask 的普通文件夹，并在该文件夹中放置一个单独的 web.config 并注册模块。

然后该模块将针对该文件夹中的所有请求运行。

要获得授权工作，您还可以将 web.config 中的授权元素设置为禁止 *

# windows - 无法在 Netbeans（Win 和 cygwin）中运行 OpenGL 代码，未设置 DISPLAY

> ID：15798830
> 
> 赞同：4
> 
> 时间：2013-04-03T21:51:18.510
> 
> 标签：windows, opengl, cygwin, environment-variables, xterm

代码编译正常，但在运行时出现此错误： `freeglut (filename): failed to open display ''`

如何设置显示并让它运行？尝试打开 xterm 也会出现同样的错误（尝试了这个，因为发现建议在 xterm 中运行）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:50:46.183

您需要一个正在运行的 X 服务器，以便基于 X11 的程序可以显示输出。但是，如果您的目标是在 Windows 上进行 OpenGL 开发，那么您不应该*使用*X 服务器，因为不幸的是，现有的 Windows X 服务器都不支持现代 OpenGL 功能在其 GLX 客户端和服务器组件的实现中。

我强烈建议您在为 Windows 编译时以原生 Windows GDI 为目标。

# ios - iOS 中事件的 FQL 查询不起作用

> ID：15798832
> 
> 赞同：1
> 
> 时间：2013-04-03T21:51:26.360
> 
> 标签：ios, events, facebook-fql

因此，这是我的 FQL 查询，用于检索用户事件的场所：

```
 NSString* fql1 = [NSString stringWithFormat:
                      @"SELECT venue from event WHERE eid in (SELECT eid FROM event_member WHERE uid = me())"];
    NSString* fql2 = [NSString stringWithFormat:
                      @"SELECT name FROM page WHERE page_id IN (SELECT venue.id FROM #event_info)"];
    NSString* fqlStr = [NSString stringWithFormat:
                     @"{\"event_info\":\"%@\",\"event_venue\":\"%@\"}",fql1,fql2];
    NSDictionary* params = [NSDictionary dictionaryWithObject:fqlStr forKey:@"queries"];

    FBRequest *fql = [FBRequest requestWithGraphPath:@"fql.query" parameters:params HTTPMethod:@"POST"];

    [fql startWithCompletionHandler:^(FBRequestConnection *connection,
                                      id result,
                                      NSError *error) {
        if (result) {
            NSLog(@"result:%@", result);
        }
        if (error) {
            NSLog(@"error:%@", error);
        }
    }]; 
```

查询本身很好，我在 Graph API Explorer 中尝试过。但我收到了这个错误：

```
error:Error Domain=com.facebook.sdk Code=5 "The operation couldn’t be completed. (com.facebook.sdk error 5.)" UserInfo=0x1f01da20 {com.facebook.sdk:HTTPStatusCode=403, com.facebook.sdk:ParsedJSONResponseKey={
    body =     {
        error =         {
            code = 240;
            message = "(#240) Requires a valid user to be specified (either via the session or via the API parameter for specifying the user.";
            type = OAuthException;
        };
    };
    code = 403;
}, com.facebook.sdk:ErrorSessionKey=<PFReceptionist: 0xb2426b0>} 
```

我究竟做错了什么？这不是我对会话的第一次查询，我已经要求 user_events 权限和简单的非 FQL 事件查询工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:01:36.600

这是它的样子。如有错误请纠正我。

```
NSString *query =
@"{"
@"'event_info':'SELECT eid, venue, name, start_time, end_time, creator, host, attending_count from event WHERE eid in (SELECT eid FROM event_member WHERE uid = me())',"
@"'event_venue':'SELECT name, location, page_id FROM page WHERE page_id IN (SELECT venue.id FROM #event_info)',"
@"}";
NSDictionary *queryParam = [NSDictionary dictionaryWithObjectsAndKeys:
                            query, @"q", nil];

[FBRequestConnection startWithGraphPath:@"/fql" parameters:queryParam
                    HTTPMethod:@"GET" completionHandler:^(FBRequestConnection *connection,
                    id result, NSError *error) {
    if (error) {
        NSLog(@"Error: %@", [error localizedDescription]);
    } else {

        NSArray* data = [result objectForKey:@"data"];
        NSArray* events = [((NSDictionary*) data[0]) objectForKey:@"fql_result_set"];
        NSArray* venues = [((NSDictionary*) data[1]) objectForKey:@"fql_result_set"];

        NSLog(@"Result: %@", result);
    }        
} 
```

# c - 使用 scanf 读取整数或字符串

> ID：15798837
> 
> 赞同：3
> 
> 时间：2013-04-03T21:52:00.853
> 
> 标签：c

如何使用 scanf 读取 int 或字符串？

我想做的是：

```
printf("Enter Your Guess, 0 - 100: "); /* Input your guess */

scanf("%as", &pass);

printf("%s", pass); 
```

在这个程序中，玩家可以选择输入数字或通过我如何扫描数字或单词通过。有没有我可以输入的if语句或我已经研究了1个小时的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:53:43.320

扫描一个字符串，并确定它是否完全由数字的合法符号组成，或者字符串是否显示`"pass"`，如果是数字，则可以将其转换为您选择的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T21:53:47.323

好吧，一种解决方法是简单地一直读取一个字符串并使用 atoi 或 snprintf 将所需的字符串转换为一个数字，如果它不包含除 [0-9] 之外的其他字符

# symfony - Sublime 似乎正在锁定文件

> ID：15798841
> 
> 赞同：2
> 
> 时间：2013-04-03T21:52:32.987
> 
> 标签：symfony, sublimetext2

我正在使用 Sublime Text 2 和 Symfony2。

我不确定发生了什么变化，但 Sublime Text 2 似乎突然将文件锁定为只读。我正在使用`assets:install`Symfony2 的命令，并且不断收到错误消息`Failed to remove directory ...`。当我关闭 Sublime Text 2 时，Symfony 能够删除这些文件。

它大约有 50% 的时间有效。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T10:04:24.153

升级到[Sublime Text 3 Beta](http://www.sublimetext.com/3)（在测试期间对 Sublime Text 2 用户免费）在 Windows 8 上为我解决了这个问题。

我在没有任何框架或自动化的情况下遇到了文件锁定问题。如果文件或文件夹在 Sublime Text 2 中打开（或者之前在会话期间打开过），我无法在 Windows 资源管理器中手动删除它。

# node.js - 哪个分析器适用于节点 0.10.2 并会为我提供逐行计时？

> ID：15798843
> 
> 赞同：3
> 
> 时间：2013-04-03T21:52:50.417
> 
> 标签：node.js, profiling

尝试过[dannycoates v8-profiler——](https://github.com/dannycoates/v8-profiler)这个不适用于 0.10.2，最后一次更新是 11 个月前，所以可以说它已经死了。

尝试了[V8 Profiler](https://code.google.com/p/v8/wiki/V8Profiler)，发现输出不是很好，很多条目如：

```
line 288: unknown code state: undefined
line 292: unknown code state: undefined
line 293: unknown code state: undefined
line 295: unknown code state: undefined
line 296: unknown code state: undefined
line 299: unknown code state: undefined
line 300: unknown code state: undefined
line 301: unknown code state: undefined 
```

并发现我 87.2% 的刻度都在一个名为的库中`b7763000-b7764000`（或者那是一个函数指针列表？）......这没有帮助。

我正在对一些代码进行压力测试，这些代码花费的时间比看起来应该要长得多。我想看看哪些代码行占用的时间最多。

# matlab - 矩形空矩阵 0 的不正确分配

> ID：15798847
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:52:59.497
> 
> 标签：matlab, matrix

```
???Improper assignment with rectangular empty matrix
Error in task3, 18
y(:,1)=log(r); 
```

错误仍然存​​在，我不知道该怎么办。脚本如下

```
function task3    
time=xlsread('Kinetics_data.xls','B3:B82');    
Conc=xlsread('Kinetics_data.xls','C3:C82');    
CAo=0.050;    
CBo=0.0406;    
h=0.5;    
n=length(Conc);    
%Calculate the reaction rate using the forward difference equation and    
%eliminate outliners if necessary.    
global CA CB    
t=time(2:n-1);    
CA=Conc(2:n-1);    
CB=CBo-(CAo-CA);    
r=(-Conc(3:n)+Conc(1:n-2))/(2*h);    
y(:,1)=log(r);    
X(:,1)=ones(size(CA));    
X(:,2)=log(CA);    
X(:,3)=log(CB);
[b bint resid residint stats]=regress(y,X);    
b;    
bint;    
k=exp(b(1));    
kint=exp(bint(1,:));    
b(1)=k;    
% Set initial guess of parameter value.    
m0=b;    
% Set lower and upper bounds for the parameters    
ub=[2.981770068869469 1.515475186852946 0.914563691229481];    
lb=[1.354032677809809 0.938815382572068 0.753329300963922];    
options=optimset('TolX',1e-16,'TolFun',1e-16,'MaxFunEval',4000,'MaxIter',4000);    
[m,residn,resid,exiflage,output,lamda,Jacob]=lsqcurvefit(@ratefun,m0,t,r,lb,ub,options)
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T10:57:10.453

**暗示**

我可以通过在脚本顶部设置 $n=0$ 轻松重现您的错误，因此请考虑一下 $n=0$ 在您的情况下的原因（进一步提示：检查您的 Excel 文件以了解数据范围）

# c++ - 窗体视图不显示

> ID：15798848
> 
> 赞同：2
> 
> 时间：2013-04-03T21:53:04.613
> 
> 标签：c++, winapi

我使用 Visual Studio 资源编辑器创建了一个表单视图，但无法显示。

处理它的消息的过程是这样的：

```
BOOL CALLBACK DlgProc(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch(message)
    {
    case WM_INITDIALOG:
        return TRUE;
    case WM_COMMAND:
        switch (LOWORD (wParam))
        {
        case IDC_BUTTONCancel:
            EndDialog(hDlg,0);
            return TRUE;            
        }
        break;
    }
    return FALSE;
} 
```

在主窗口中按下按钮时，我调用：

```
DialogBox(hInst, MAKEINTRESOURCE(IDD_FORMVIEW), hwnd, (DLGPROC)DlgProc); 
```

主窗口冻结，但没有显示对话框。

我会很感激一些帮助。提前致谢。

# twitter-bootstrap - div 内的引导文本始终位于底部

> ID：15798849
> 
> 赞同：1
> 
> 时间：2013-04-03T21:53:11.947
> 
> 标签：twitter-bootstrap

我的代码中有以下使用引导程序的 HTML。

```
<div class="row-fluid image_div">
        <h4 class="text-center"><a href="/category">name_of_item</a></h4>
         <a target="_blank" href="link_for_item">
            <img class="item-size" src="photo.url" alt="name_of_item"/>
        </a>
        <p> quick_summary </p>
        <div class="row-fluid">
            <span class="pull-right"><b class="price">£ price </b></span>
        </div>
        <div class="row-fluid bottom">
            <a class="btn btn-small btn-warning pull-left" href="/user">Add To Wish List</a>
            <a target="_blank" 
               class="btn btn-info pull-right" 
               href="link_for_item">
                Check It Out
            </a>
        </div>
    </div> 
```

我的顶部 div (image_div) 高度定义如下

```
 .image_div{
    height: 450px;
     } 
```

在上面的代码中，我希望带有“底部”类的内部 div 始终保持在顶部 div (image_div) 的底部。请建议，我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T22:00:08.130

我认为正确的解决方案是定位`bottom`div 绝对值。像这样的东西：

```
.bottom {    
    position: absolute;
    bottom: 0;
} 
```

您还必须将 的 设置`position`为`image_div`使其`relative`工作，因为绝对位置需要知道它应该使用什么作为定位参考。

有诸如垂直对齐：底部之类的属性，但我建议不要使用它们，因为它们要求您使用 display: table-cell 和/或其他丑陋的 css。

**编辑：**
为了让价格出现在顶部，我会改变这个：

```
<div class="row-fluid">
    <span class="pull-right"><b class="price">£ price </b></span>
</div> 
```

进入这个：

```
<span class="price">£ price </span> 
```

然后以相同的方式将其绝对定位：

```
.price {
 position: absolute;
 top: 0;
 right: 0;
 display: block:
} 
```

我也很确定`.row-fluid`底部的 div 不是必需的。

# tomcat - Apache TomEE 和 Tomcat 在 Windows 系统上共存

> ID：15798851
> 
> 赞同：0
> 
> 时间：2013-04-03T21:53:17.710
> 
> 标签：tomcat, apache-tomee

是否可以在 Windows 机器上同时拥有 apache tomcat 和 apachetomee-plus。由于在设置Tomcat6时；我已经设置了 CATALINA_HOME 环境变量；我认为当 apache tomee 启动时[使用 TomEE 发行版中包含的 startup.bat 文件]，它会获取 Tomcat 设置的 CATALINA_HOME 变量。

我们能否在 Windows（或其他系统）中同时拥有这两个服务器，并确保当我启动 TomEE plus 服务器的 startp.bat 时，我的 Tomcat Servlet 容器不会被拾取？

```
System Info:
Windows 7 64 bit
JAVA 1.6.0_21
TomEE: apache-tomee-plus-1.5.1
Tomcat: 6.0 
```

谢谢，

阿尤斯曼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T09:16:53.860

您可以在启动脚本中设置 CATALINA_* 变量而不是 windows env 变量。它应该可以解决问题。

# regex - 如何使用语法或正则表达式识别以下字符串组？

> ID：15798853
> 
> 赞同：1
> 
> 时间：2013-04-03T21:53:19.760
> 
> 标签：regex, grammar, combinatorics

我唯一注意到的是每个 n 的元素数是[Catalan Number](http://en.wikipedia.org/wiki/Catalan_number)。

我们只有偶数。这个列表无限地继续下去。

```
n=2
ab

n=4
aabb
abab

n=6
aaabbb
aababb
aabbab
abaabb
ababab

n=8
aaaabbbb
aaababbb
aaabbabb
aaabbbab
aabaabbb
aabababb
aababbab
aabbaabb
aabbabab
abaaabbb
abaababb
abaabbab
ababaabb
abababab 
```

该列表可以通过以下 python 代码生成：http: [//pastebin.com/hynjWTrp](http://pastebin.com/hynjWTrp)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T22:01:55.513

没有正则表达式，因为我们的语言不是正则的。

匹配 a 和 b 的通用形式与匹配括号相同，它是无上下文语法：

```
S -> e | AS
A -> e | aAb 
```

`e`空字符串在哪里。

# c# - 在 Java 中使用 C# 类

> ID：15798857
> 
> 赞同：0
> 
> 时间：2013-04-03T21:53:28.173
> 
> 标签：c#, java

有没有办法将（项目的） **C#**类用于另一个**Java**项目？

或任何其他可能的解决方案（如转换 - 例如：[Java Language Conversion Assistant](http://msdn.microsoft.com/en-us/library/1kwtxa08%28v=vs.80%29.aspx)）。

从现在开始，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:55:44.413

**C# -> Java**

CodePorting C#2Java 是一个基于 Web 的工具，用于将 C# 应用程序和源代码转换为 Java。（[http://visualstudiogallery.msdn.microsoft.com/9789645d-9b31-4033-bcb1-53dc5ff58e05](http://visualstudiogallery.msdn.microsoft.com/9789645d-9b31-4033-bcb1-53dc5ff58e05)）

谷歌给你几个选项 [https://www.google.com/search?q=C%23+to+Java](https://www.google.com/search?q=C%23+to+Java)

# vim - 在 Mac OSX 上安装 Paredit vim 插件

> ID：15798858
> 
> 赞同：1
> 
> 时间：2013-04-03T21:53:34.163
> 
> 标签：vim, clojure, paredit

我最近在我的 mac osx 上下载了vim 的[paredit](http://www.vim.org/scripts/script.php?script_id=3998)插件。我将 paredit.vim 放在我的 ~/.vim 目录中。

文档说：

```
When you enter a '(' then a matching ')' is automatically inserted.
If needed, spaces before and/or after the '()' pair are added.
...
Paredit mode is set by default for .lisp, .cl, .clj, cljs, .scm and .rkt files,
but it is possible to switch it off by putting the following statement in the
.vimrc file: 
```

但是，当我打开 vim 并输入一个“（”没有关闭“）”时被插入。我还需要做其他事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:19:51.740

这是为 .clj 文件做的

```
syntax on
au BufNewFile,BufRead *.clj setfiletype clojure
au BufNewFile,BufRead *.clj call PareditInitBuffer() 
```

# javascript - 附加到 dom 时保持变量是最新的

> ID：15798859
> 
> 赞同：0
> 
> 时间：2013-04-03T21:53:37.987
> 
> 标签：javascript, html, dom

什么是保持对项目列表的引用最新的好技术？

理想情况下，当我将一个元素附加到 DOM 时，我希望我的变量保存一个要更新的该类型元素的列表。

**HTML：**

```
<ul>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
</ul> 
```

**JS：**

```
var ListOfItems = $("ul");
var Items = $("li");

alert(Items.length);

var NewItem = $("<li></li>");
ListOfItems.append(NewItem);
alert(Items.length); 
```

**输出：**

```
5
5 
```

[http://jsfiddle.net/S84yY/](http://jsfiddle.net/S84yY/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:58:19.813

它无法绑定，更好的方法是在这一行之后：

```
ListOfItems.append(NewItem); 
```

将其添加到您的数组中：

```
Items.push(NewItem); 
```

或者用这个再次更新你的数组：

```
Items = $("li"); 
```

# sql - 将 Xml 插入 Sql Server 的过程——必须声明标量变量

> ID：15798860
> 
> 赞同：0
> 
> 时间：2013-04-03T21:53:41.910
> 
> 标签：sql, sql-server, sql-server-2008

我正在使用以下过程尝试通过文件路径将 xml 插入 xml 列。我收到一个错误，必须为 ForeignId 声明标量变量。有没有更好的方法来做我想做的事情，还是我走在正确的道路上？

这是程序

```
ALTER PROC [dbo].[InsertXml] @path nvarchar(100)
                    ,@ForeignId uniqueidentifier
AS

BEGIN

SET NOCOUNT ON

DECLARE @SQL nvarchar(4000) = 
'INSERT INTO XmlTable(XmlId
           , ForeignId
           , TestXml)
SELECT NEWID()
     , @ForeignId
     ,* FROM OPENROWSET(
   BULK ''' + @path + ''', 
   SINGLE_BLOB) AS x;'
EXECUTE(@SQL);

RETURN @@ERROR;

END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:02:23.653

当您使用`EXECUTE(SQL)`它执行 SQL 语句时，它无法访问该`@ForeignId`值

解决此问题的一种方法是使用[sp_excuteSQL](http://msdn.microsoft.com/en-us/library/ms188001.aspx)并执行此操作而不是`EXECUTE(@SQL);`

```
DECLARE @ParmDefinition nvarchar(500);
SET @ParmDefinition = N'@ForeignId uniqueidentifier';
EXECUTE sp_executesql @SQL, @ParmDefinition, @ForeignId ; 
```

您也可以将 @ForeignId 连接到您的 sql 字符串，但我不记得在使用 uniqueidentifier 时是否存在问题

# git - git rev-parse 有什么作用？

> ID：15798862
> 
> 赞同：382
> 
> 时间：2013-04-03T21:53:47.110
> 
> 标签：git, git-rev-parse

做什么`git rev-parse`？

我已经阅读了手册页，但它提出的问题多于答案。像：

> 挑选和**按摩**参数

*按摩*？这意味着什么？

我用作修订说明符的解析器（到 SHA1），例如

```
git rev-parse HEAD^ 
```

或者

```
git rev-parse origin/master 
```

这是命令的目的吗？如果不是，使用它来实现这一点是否正确？

* * *

## 回答 #1

> 赞同：324
> 
> 时间：2013-04-04T04:03:28.010

[`git rev-parse`](http://git-scm.com/docs/git-rev-parse)`plumbing`是主要用于操作的辅助命令。

的一种常见用法`git rev-parse`是在给定修订说明符的情况下打印 SHA1 哈希。此外，它有多种选项来格式化此输出，例如`--short`打印更短的唯一 SHA1。

我还使用过其他用例（在脚本和其他基于 git 构建的工具中）：

*   `--verify`验证指定的对象是一个有效的 git 对象。
*   `--git-dir`用于显示`.git`目录的绝对/相对路径。
*   检查您当前是否在使用的存储库中`--is-inside-git-dir`或使用的工作树中`--is-inside-work-tree`
*   检查回购是否是裸使用`--is-bare-repository`
*   打印分支 ( `--branches`)、标签 ( `--tags`) 的 SHA1 哈希值和引用也可以基于远程过滤（使用`--remote`）
*   `--parse-opt`规范化脚本中的参数（类似于`getopt`）并打印可用于的输出字符串`eval`

`Massage`只是意味着可以将信息从一种形式转换为另一种形式，即转换命令。这些是我能想到的一些简单的例子：

*   将分支或标记名称添加到它指向的提交的 SHA1 中，以便可以将其传递给仅接受提交的 SHA1 值的管道命令。
*   底层管道命令的等效参数的修订`A..B`范围`git log`或`git diff``B ^A`

* * *

## 回答 #2

> 赞同：141
> 
> 时间：2015-01-31T07:34:35.783

只是为了详细说明命令名称的词源`rev-parse`，Git`rev`在管道命令中始终使用该术语作为“修订”的缩写，通常表示提交的 40 个字符的 SHA1 哈希。例如，该命令`rev-list`打印一个分支或其他任何内容的 40 字符提交哈希列表。

在这种情况下，名称可能会扩展为`parse-a-commitish-to-a-full-SHA1-hash`. 虽然该命令具有 Tuxdude 的回答中提到的几个辅助功能，但它的同名似乎是将用户友好的引用（如分支名称或缩写哈希）转换为对许多编程/管道最有用的明确 40 个字符的 SHA1 哈希的用例目的。

我知道在我弄明白之前我一直在想它是“反向解析”的东西，并且在理解“按摩”和“操纵”这两个术语时遇到了同样的麻烦:)

无论如何，我发现这种“解析到修订”的概念是一种令人满意的思考方式，并且是一种可靠的概念，可以在我需要这种东西时想到这个命令。通常在编写 Git 脚本时，您会将用户友好的提交参考作为用户输入，并且通常希望在收到它后尽快将其解析为经过验证且明确的工作参考。否则，输入翻译和验证往往会通过脚本激增。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2016-12-27T18:33:06.207

`git rev-parse`也适用于使用[--abbrev-ref](https://git-scm.com/docs/git-rev-parse#Documentation/git-rev-parse.txt---abbrev-refstrictloose)标志获取当前分支名称，例如：

```
git rev-parse --abbrev-ref HEAD 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-06-18T08:06:31.783

**TLDR：**

它可以帮助您找出当前 HEAD 的提交 ID（即您正在查看的当前提交）

```
git rev-parse HEAD 
```

或者如果你想要更短的提交

```
git rev-parse --short HEAD 
```

如果你想在另一个分支中找到最新的提交，你可以这样做

```
git rev-parse <local-branch-name>
git rev-parse origin/<remote-branch-name> 
```

# ios - 应用程序在 iPad 上崩溃但不是模拟器

> ID：15798866
> 
> 赞同：0
> 
> 时间：2013-04-03T21:53:51.847
> 
> 标签：ios, xcode, crash, int, segue

我的应用程序在 iPad 上运行时崩溃，但在 iPad 模拟器上工作 100% 我在 iPad 上使用的是 Xcode 4.6.1 版和 6.1.3 版。问题在于我试图在 segues 之间传递 int 的值

在我的.h

```
@property (nonatomic, assign)int currentQuestion; 
```

在我的.m

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
if ([segue.identifier isEqualToString:@"level1correct"]){
    AddLevel1IncorrectViewController *incorrect = [segue destinationViewController];
    incorrect.CQValue = self.currentQuestion;
}} 
```

AddLevel1Incorrect.h

```
@property (nonatomic, assign)int CQValue; 
```

AddLevel1Incorrect.m

```
@synthesize CQValue = _CQValue;

- (void)imageSelect{
int numItems = [arrayPath count];
NSMutableArray *left = [NSMutableArray arrayWithCapacity:numItems];
NSMutableArray *right = [NSMutableArray arrayWithCapacity:numItems];

for (NSDictionary *itemData in arrayPath) {
    [left addObject:[itemData objectForKey:@"L"]];
    [right addObject:[itemData objectForKey:@"R"]];
}

NSLog(@" value of %d CQValue ", self.CQValue);
leftImageViewer.image = [UIImage imageNamed:left[self.CQValue]];//this is the point where the crash happens
rightImageViewer.image = [UIImage imageNamed:right[self.CQValue]];
} 
```

有趣的是它确实在控制台的 NSLog 中显示了正确的值，正如您将在崩溃消息的顶部看到的那样

```
2013-04-03 22:50:00.404 thefyp[1506:907]  value of 1 CQValue 
2013-04-03 22:50:00.408 thefyp[1506:907] *** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 1 beyond bounds for empty array'
*** First throw call stack: 
```

有什么想法我在这里出错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:03:57.063

您的代码非常脆弱，这意味着它对正在使用的数据做出了很多假设，而没有验证数据是否准确。

在访问数组之前，您永远不会检查数组的边界。 `self.CQValue`是 1，但在这种情况下，数组本身是空的。so `left[self.CQValue]`, is `left[1]`, 无效。

检查`arrayPath`以确保它不是空的。

# .net - 存储库模式对复杂/非模型特定查询（即报告/聚合数据）的回答

> ID：15798870
> 
> 赞同：2
> 
> 时间：2013-04-03T21:54:14.167
> 
> 标签：.net, design-patterns, domain-driven-design, repository-pattern

我一直在阅读存储库模式并努力寻找关于人们如何处理返回的数据不仅仅是您的标准模型（即 NOT `Customer 1..* Account`）的情况的可靠答案

我正在构建一个分析系统，它返回聚合的数据，有时跨越许多表。此外，这些表中可能有数百万条记录正在连接中。简而言之，我的典型结果集不是我的核心领域模型，而是（有时是极端的）它们的跨度、排列和聚合。

过去，我只是简单地构建了我的查询并将结果作为自定义结果集返回（授予这允许从我的系统的上层访问 ORM，因此没有将我的系统与正在使用的 ORM 的知识分开） .

**存储库模式在这里不合适吗？其他人是如何处理这种情况的？感觉有点像方钉/圆孔。**

*作为参考，我正在使用带有 MSSQL DB 的 ASP MVC 在 C# .Net 中进行开发。*

## 更新

虽然我的方案主要基于报告，但我仍在处理构成报告所基于的数据的各个实体。

**作为（*只是*）一个例子**：我仍然需要我的`Customer`实体，而客户仍然需要`Orders`他们通过系统生成的实体。在这种情况下，我的域 POCOS 在这里运行良好。在收到 MANY`Orders`并且必须以与我现有域对象附近的任何地方都不匹配的格式报告它们以及它们的许多连接的聚合表后，问题就出现了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T01:31:55.290

我认为存储库模式不适用于您的场景，尤其是分析数据。当您不仅需要查询而且还需要持久化时，存储库会带来最大的好处。此外，除了某些例外，存储库应该与聚合是一对一的，而不仅仅是任何实体或值对象。

在您的场景中，您没有理由不能只使用 SQL 查询数据并返回简单的只读对象。您仍然可以通过封装这些查询来获得存储库的一些好处，这样消费者就不需要直接调用 SQL。将它们公开为简单的服务调用。这通常适用于[所有查询](http://gorodinski.com/blog/2012/04/25/read-models-as-a-tactical-pattern-in-domain-driven-design-ddd/)。

# java - 带菜单的 Java 服务器

> ID：15798871
> 
> 赞同：0
> 
> 时间：2013-04-03T21:54:14.660
> 
> 标签：java, menu, while-loop

我有点问题。我正在尝试使用菜单制作服务器。Evrythink 还可以，但是当我启动服务器时它就卡住了。我的想法是有菜单，并用它来启动服务器：命令：“启动服务器”并启动。但是当我启动它时，我可以摆脱这个循环。这是我的代码。如何在“启动服务器”后返回主菜单？

```
package meetingsserver;

import java.util.Scanner;
import server.DB.DataBase;
import server.LoadSettings;

public class MeetingsServer {

    private static server.ServerCore serverCore = null;

    public static void main(String[] args) {

        Scanner input = new Scanner(System.in);
        LoadSettings loadSettings = LoadSettings.Init();

        System.out.println("Use 'help' command to list all commands");

        while (input.hasNext()) {
            String command = input.nextLine();

            switch (command) {
                case "start server":
                    System.out.println("Starting server ....");
                    serverCore = new server.ServerCore();
                    serverCore.start();
                    break;
                case "status server":
                    serverCore.statusServer();
                    break;
                case "set config":
                    loadSettings.writeDatacondig();
                    break;
                case "reload config":
                    loadSettings.loadDataConfig();
                    System.out.println("Configuration was reseted");
                    break;
                case "view config":
                    loadSettings.viewConfig();
                    break;
                case "view config file":
                    System.out.println("Configuration from file");
                    loadSettings.viewConfigFile();
                    break;
                case "help":
                    helpText();
                    break;
                case "stop server":
                    System.exit(1);
                    break;
                case "cls":
                    clsTerminal();
                    break;
                case "database tables":
                    DataBase.Init().showTables();
                    break;
                default:
                    helpText();
                    break;

            }//switch

        }//while

    }//main

    private static void helpText() {
        System.out.println("\t Help commands:\n\r");
        System.out.println("SERVER FUNCTIONS :");
        System.out.println("\tstart server\t start the server");
        System.out.println("\tstop server\t stop the server");
        System.out.println("\tstatus server\t return status server");
        System.out.println("CONFIGURATION FUNCTIONS:");
        System.out.println("\tset config\t adding new confing  keys with values");
        System.out.println("\t\t\t exiting from this mode write ;edited;");
        System.out.println("\treload config\t reload confinguration from config file");
        System.out.println("\tview config\t returns loaded configuration");
        System.out.println("\tview config file\t returns configuration of file");
        System.out.println("OTHER FUNCTIONS :");
        System.out.println("\thelp\t\t listing help commands");
        System.out.println("\tcls\t\t clear   console");
        System.out.println("DATABASE  FUNCTIONS: ");
        System.out.println("\t database tables\t  return all tables in mysql");
    }

    private static void clsTerminal() {
        for (int i = 0; i < LoadSettings.Init().getConfigInt("clsTerminal"); i++) {
            System.out.println("");
        }
    }
} 
```

和 ：

```
package server;

import java.io.IOException;
import java.net.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import server.DB.DataBase;

public class ServerCore extends Thread {

    private LoadSettings loadSettings = LoadSettings.Init();
    private int port = loadSettings.getConfigInt("port");
    private int max_connections = loadSettings.getConfigInt("max_connections");
    private ServerSocket socket;
    private Socket connection;
    private boolean serverRuning = false;
    private int connectedUsers = 0;

    @Override
    public void run() {
        this.start();
    }

    @Override
    public void start() {

        DataBase.Init();
        try {

            socket = new ServerSocket(port);
            serverRuning = true;

            while (serverRuning) {
                if (connectedUsers <= max_connections) {
                    connection = socket.accept();
                    connectedUsers++;
                }
                System.out.println(connection.toString());
            }

        } catch (IOException ex) {
            Logger.getLogger(ServerCore.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    public void stopServer() {
        if (serverRuning) {
            statusServer();
        }
        serverRuning = false;
        System.out.println("+++++\t  SERVER WAS STOPED !");

    }

    public void statusServer() {
        if (serverRuning) {
            System.out.println("Server running at port:" + port + "  with  users :" + connectedUsers);
        } else {
            System.out.println("Server IS NOT RUNNING!");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:52:28.770

你很困惑`Thread#run()`并且`Thread#start()`：

`start()`神奇地启动一个新线程并立即返回给调用者（通常不需要覆盖`start()`）。

`run()`执行线程的工作并由 Java 线程框架自动调用；你绝不`run()`能从你的代码中调用。

因此，将您的代码移入`run()`（可能存在一些同步问题，但您稍后会解决...）

# java - UIManager.getColor 有时会返回 null

> ID：15798875
> 
> 赞同：0
> 
> 时间：2013-04-03T21:54:20.310
> 
> 标签：java, swing, look-and-feel, japplet, uimanager

我有一个小程序在加载时在这一行（但只是有时）生成一个空指针异常：

（txtpnNoSeHa 是扩展 JPanel 的类中的 JEditorPane。此面板在小程序构造函数中实例化）

```
txtpnNoSeHa.setBackground(UIManager.getColor("Panel.background")); 
```

在构造函数内部调用。

我从中了解到的是 UIManager.getColor 有时返回 null 可能是因为尚未加载某些数据（没有显示摆动面板或类似的东西）

这个小程序是用 eclipse 的窗口构建器设计的。我怎样才能解决这个问题？任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:00:43.587

正如您所预测的，`UIManager`一旦第一个摆动组件可见，就会加载 。这可能会导致`null`价值观。**您可以在例程开始时**`UIManager`使用此调用手动加载**（或****对于小程序）**：**`main``init`**

```
try {
    UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName());
} catch(InvocationTargetException | UnsupportedLookAndFeelException e) {
    e.printStackTrace(); 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T22:04:37.777

过去我遇到过类似的问题，我通过使每个与摆动相关的代码都从 GUI 线程 (EDT) 运行来解决它。

```
SwingUtilities.invokeLater(new Runnable()
{
    @Override
    public void run()
    {
        // ...
    }
}); 
```

# python - 如何使用 Python 搜索互联网？

> ID：15798878
> 
> 赞同：4
> 
> 时间：2013-04-03T21:54:23.033
> 
> 标签：python, search

我想编写一个程序来搜索一个相当大的网站并提取某些东西。我有几个在线 Python 课程，但都没有提到如何使用 Python 访问互联网。我不知道我应该从哪里开始。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T22:08:03.577

您必须首先阅读标准 python 库[urllib2](http://docs.python.org/2/library/urllib2.html)。

一旦你对这个库背后的基本想法感到满意，你就可以尝试更容易与 Web 交互的[请求，尤其是 API。](http://docs.python-requests.org/en/latest/)我建议将它与[httpie](https://github.com/jkbr/httpie)并行使用，以从命令行快速和肮脏地测试查询。

如果您进一步构建一个库或引擎来抓取网络，您将需要某种异步编程，我建议从[Gevent开始](http://www.gevent.org/)

最后，如果你想创建一个爬虫/机器人，你可以看看[Scrapy](http://scrapy.org/)。但是，在深入研究这个库之前，您应该从基本库开始，因为它可能会变得非常复杂

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T21:59:46.913

听起来你想要一个网络爬虫/抓取工具。你想拉什么样的东西？图片？链接？只是网络爬虫/抓取工具的工作。

从那里开始，应该有很多关于 Stackoverflow 的文章将帮助您实现连接到互联网（获取 Web 响应）等细节。

见[这篇](https://stackoverflow.com/questions/2861/options-for-html-scraping)文章。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-03T22:00:22.473

互联网上的内容远不止网站，但我假设您只想抓取一些 html 页面并从中提取数据。你有很多选择来解决这个问题。只是一些起点：

*   来自标准库的 urllib2
*   [https://pypi.python.org/pypi/requests](https://pypi.python.org/pypi/requests)（更容易和更用户友好）
*   [http://scrapy.org/](http://scrapy.org/)（一个很好的爬虫框架）
*   [http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)（从 html 中提取数据的库）

# perl - Perl：如何增加 Class::Struct 字段？

> ID：15798879
> 
> 赞同：1
> 
> 时间：2013-04-03T21:54:23.630
> 
> 标签：perl, class

如何增加[`Class::Struct`](http://perldoc.perl.org/Class/Struct.html)对象中的字段？

现在我被困在

```
use Class::Struct foo => [
  counter => '$',
];
my $bar = foo->new(counter => 5);
$bar->counter($bar->counter()+1); 
```

我想知道是否有比最后一行更具表现力的东西（明显的`$bar->counter++`结果`Can't modify non-lvalue subroutine call`）。

编辑：当然，我对`$bar->[0]++`等不感兴趣-如果我之前添加一个字段`counter`怎么办？我不想为所有这些“等待中的错误”寻找我的代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T22:37:37.217

您可以将`increment`方法添加到`foo`：

```
#!/usr/bin/env perl

package foo;

use strict; use warnings;

sub increment_counter {
    my $self = shift;
    my $val = $self->counter + 1;
    $self->counter($val);
    return $val;
}

package main;

use 5.012;
use strict;
use warnings;

use Class::Struct foo => [
  counter => '$',
];

my $bar = foo->new(counter => 5);

$bar->increment_counter;

say $bar->counter;

__END__ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T22:07:07.393

或者，尝试这样做：

```
use strict; use warnings;

use Class::Struct foo => [
  counter => '$',
];
my $bar = foo->new(counter => 5);
print ++$bar->[0]; 
```

或使用 SCALAR ref（无需像前面的代码片段那样硬编码“路径”）：

```
use strict; use warnings;

$\ = "\n";

use Class::Struct foo => [
  counter => '*$',
];
my $bar = foo->new(counter => 5);
print ++${ $bar->counter }; 
```

# javascript - KoGrid 更新单元格

> ID：15798881
> 
> 赞同：3
> 
> 时间：2013-04-03T21:54:26.373
> 
> 标签：javascript, knockout.js, kogrid

我正在尝试使用 KoGrid 更新单个单元格，但直到我通过单击列标题对网格进行排序后才看到更新。

以下是我正在使用的代码。JSFiddle 可在此处获得：http: [//jsfiddle.net/b22Ex/2/](http://jsfiddle.net/b22Ex/2/)

不起作用的行是：vm.data()[0].b(100)。既然值是 ko.observable，那不应该工作吗？

```
 var L = [
        {a:ko.observable('a1'), b:ko.observable('b1'), c:ko.observable('c1')},
        {a:ko.observable('a2'), b:ko.observable('b2'), c:ko.observable('c2')},
        {a:ko.observable('a3'), b:ko.observable('b3'), c:ko.observable('c3')}
    ];
    var vm = {
        data: ko.observableArray(L)
    };
    window.vm = vm;
    ko.applyBindings(vm);
    vm.data()[0].b(100)
    console.log("DONE CHANGING VALUE"); 

```

顺便说一句，我还遇到了[KoGrid 如何在数据更改](https://stackoverflow.com/questions/15642798/kogrid-how-to-refresh-grid-in-case-data-is-changed) 但我不想更新整个数据集的情况下刷新网格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T03:13:35.150

**更新**

试试这个 ：

[**工作小提琴**](http://jsfiddle.net/b22Ex/9/)

*JS*

```
var xxx = [
    {a:ko.observable('a1'), b:ko.observable('b1'), c:ko.observable('c1')},
    {a:ko.observable('a2'), b:ko.observable('b2'), c:ko.observable('c2')},
    {a:ko.observable('a3'), b:ko.observable('b3'), c:ko.observable('c3')}
];

var vm = {
    data: ko.observableArray(xxx),
};

window.vm = vm;
ko.applyBindings(vm);

 vm.data()[0].b(100);
 vm.data.valueHasMutated();  //This will update your observable in UI

console.log("DONE CHANGING VALUE"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T04:09:30.473

以下是您的问题的解决方案。检查这个[小提琴](http://jsfiddle.net/naveenkumarm/b22Ex/5/)。

```
var xxx = [
 {a:ko.observable('a1'), b:ko.observable('b1'), c:ko.observable('c1')},
 {a:ko.observable('a2'), b:ko.observable('b2'), c:ko.observable('c2')},
 {a:ko.observable('a3'), b:ko.observable('b3'), c:ko.observable('c3')}
];
var vm = {
 data: ko.observableArray(xxx)
};
window.vm = vm;
ko.applyBindings(vm);
vm.data()[0].b(100)

vm.data(vm.data()); //This line will make the fix that you need.

console.log("DONE CHANGING VALUE"); 
```

# php - PDO 类似条件，使大写匹配

> ID：15798882
> 
> 赞同：0
> 
> 时间：2013-04-03T21:54:38.457
> 
> 标签：php, pdo, xampp

我正在尝试使用 PDO LIKE 条件从数据库中获取相应的值。现在问题是数据库中的一些值以大写开头。我正在尝试使用 UPPERCASED 列值查询数据库。

如果我使用此代码：

```
$connection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $stmt = $connection->prepare('SELECT * FROM ingredient WHERE name LIKE ?');
    $query = '%'.$queryEntered.'%';
    $stmt -> execute(array($query)); 
```

我确实得到了结果，我更希望有一些类似的东西

```
$query = $queryEntered.'%';
    $stmt -> execute(array($query)); 
```

我似乎无法让列中的数据大写，所以永远不会匹配。一直在寻找。你能帮忙的话，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:04:48.757

这取决于您使用的字符集和排序规则。大多数 MySQL 安装默认为 latin1_swedish_ci，它具有不区分大小写的字符串比较。您可以尝试强制进行区分大小写的比较。

```
'SELECT * FROM ingredient WHERE name COLLATE latin1_general_cs LIKE ?' 
```

另见此处：[http ://dev.mysql.com/doc/refman/5.6/en/case-sensitive.html](http://dev.mysql.com/doc/refman/5.6/en/case-sensitivity.html)

# ruby - 使用 Ruby 访问 SQLAnywhere 12 数据库（DBI 或 SQLAnywhere gem）

> ID：15798883
> 
> 赞同：1
> 
> 时间：2013-04-03T21:54:40.807
> 
> 标签：ruby, dbi, sqlanywhere

我正在尝试使用 gem dbi 或 sqlanywhere gem 来访问 Windows 64 位机器上的 SQLAnywhere 12 数据库。数据库在本地运行。我完全没有成功，任何帮助将不胜感激。

```
Ruby Version = ruby 1.9.3p385 (2013-02-06) [i386-mingw32] 
*** LOCAL GEMS *** 

bigdecimal (1.1.0) 
builder (3.2.0) 
childprocess (0.3.9) 
chunky_png (1.2.7) 
commonwatir (4.0.0) 
compass (0.12.2) 
dbd-odbc (0.2.5) 
dbd-sqlanywhere (1.0.1) 
dbi (0.4.5) 
deprecated (2.0.1) 
epoxy (0.3.1) 
ffi (1.4.0 x86-mingw32) 
fssm (0.2.10) 
hoe (3.5.1) 
io-console (0.3) 
json (1.5.4) 
libxml-ruby (2.6.0 x86-mingw32) 
methlab (0.1.0) 
mini_magick (3.2.1) 
minitest (2.5.1) 
multi_json (1.6.1) 
nokogiri (1.5.6 x86-mingw32) 
rake (0.9.2.2) 
rautomation (0.7.3) 
rdbi (0.9.1) 
rdoc (3.9.5) 
rubygems-update (2.0.1) 
rubyzip (0.9.9) 
s4t-utils (1.0.4) 
sass (3.2.7) 
selenium-webdriver (2.31.0) 
sequel (3.46.0) 
sqlanywhere (0.1.6 x86-mingw32) 
subexec (0.0.4) 
typelib (0.1.0) 
user-choices (1.1.6.1) 
watir (4.0.2 x86-mingw32) 
watir-classic (3.4.0) 
watir-webdriver (0.6.2) 
websocket (1.0.7) 
win32-api (1.4.8 x86-mingw32) 
win32-process (0.7.1) 
win32screenshot (1.0.7) 
windows-api (0.4.2) 
windows-pr (1.2.2) 
xml-simple (1.1.2) 
```

使用 DBI 时

```
require 'rubygems' 
require 'dbi' 

DBI.connect('DBI:ODBC:Agency') 
```

返回

```
C:/Ruby193/lib/ruby/gems/1.9.1/gems/dbi-0.4.5/lib/dbi.rb:300:in `block in load_driver': Unable to load driver 'ODBC' (underlying error: uninitialized constant DBI::DBD::ODBC) (DBI::InterfaceError) 
        from C:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize' 
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/dbi-0.4.5/lib/dbi.rb:242:in `load_driver' 
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/dbi-0.4.5/lib/dbi.rb:160:in `_get_full_driver' 
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/dbi-0.4.5/lib/dbi.rb:145:in `connect' 
        from dbi_test.rb:4:in `<main>' 
```

使用 sqlanywhere 时

```
require 'sqlanywhere' 

api = SQLAnywhere::SQLAnywhereInterface.new() 
SQLAnywhere::API.sqlany_initialize_interface( api ) 
api.sqlany_init() 

sqlanywhere_test.rb:65: [BUG] Segmentation fault 
ruby 1.9.3p385 (2013-02-06) [i386-mingw32] 

-- Control frame information ----------------------------------------------- 
c:0027 p:---- s:0109 b:0109 l:000108 d:000108 CFUNC  :sqlany_init 
c:0026 p:0011 s:0106 b:0106 l:000093 d:000105 BLOCK  sqlanywhere_test.rb:65 
c:0025 p:0080 s:0104 b:0104 l:000103 d:000103 METHOD C:/Ruby193/lib/ruby/1.9.1/test/unit/assertions.rb:96 
c:0024 p:0054 s:0094 b:0094 l:000093 d:000093 METHOD sqlanywhere_test.rb:64 
c:0023 p:0046 s:0090 b:0090 l:000089 d:000089 METHOD C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:947 
c:0022 p:0025 s:0084 b:0084 l:000083 d:000083 METHOD C:/Ruby193/lib/ruby/1.9.1/test/unit/testcase.rb:17 
c:0021 p:0090 s:0080 b:0080 l:000068 d:000079 BLOCK  C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:787 
c:0020 p:---- s:0074 b:0074 l:000073 d:000073 FINISH 
c:0019 p:---- s:0072 b:0072 l:000071 d:000071 CFUNC  :map 
c:0018 p:0124 s:0069 b:0069 l:000068 d:000068 METHOD C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:780 
c:0017 p:0020 s:0061 b:0060 l:000050 d:000059 BLOCK  C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:565 
c:0016 p:---- s:0056 b:0056 l:000055 d:000055 FINISH 
c:0015 p:---- s:0054 b:0054 l:000053 d:000053 CFUNC  :each 
c:0014 p:0053 s:0051 b:0051 l:000050 d:000050 METHOD C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:563 
c:0013 p:0189 s:0045 b:0045 l:000044 d:000044 METHOD C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:746 
c:0012 p:0013 s:0035 b:0035 l:000034 d:000034 METHOD C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:909 
c:0011 p:0012 s:0032 b:0032 l:000023 d:000031 BLOCK  C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:896 
c:0010 p:---- s:0029 b:0029 l:000028 d:000028 FINISH 
c:0009 p:---- s:0027 b:0027 l:000026 d:000026 CFUNC  :each 
c:0008 p:0068 s:0024 b:0024 l:000023 d:000023 METHOD C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:895 
c:0007 p:0029 s:0020 b:0020 l:000019 d:000019 METHOD C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:884 
c:0006 p:0022 s:0016 b:0016 l:000015 d:000015 METHOD C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:21 
c:0005 p:0033 s:0012 b:0011 l:000c44 d:000010 BLOCK  C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:326 
c:0004 p:0036 s:0009 b:0009 l:000008 d:000008 METHOD C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:27 
c:0003 p:0026 s:0006 b:0006 l:000c44 d:000005 BLOCK  C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:325 
c:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH 
c:0001 p:0000 s:0002 b:0002 l:001d0c d:001d0c TOP   

-- Ruby level backtrace information ---------------------------------------- 
C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:325:in `block in autorun' 
C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:27:in `run_once' 
C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:326:in `block (2 levels) in autorun' 
C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:21:in `run' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:884:in `run' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:895:in `_run' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:895:in `each' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:896:in `block in _run' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:909:in `run_tests' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:746:in `_run_anything' 
C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:563:in `_run_suites' 
C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:563:in `each' 
C:/Ruby193/lib/ruby/1.9.1/test/unit.rb:565:in `block in _run_suites' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:780:in `_run_suite' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:780:in `map' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:787:in `block in _run_suite' 
C:/Ruby193/lib/ruby/1.9.1/test/unit/testcase.rb:17:in `run' 
C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb:947:in `run' 
sqlanywhere_test.rb:64:in `setup' 
C:/Ruby193/lib/ruby/1.9.1/test/unit/assertions.rb:96:in `assert_nothing_raised' 
sqlanywhere_test.rb:65:in `block in setup' 
sqlanywhere_test.rb:65:in `sqlany_init' 

-- C level backtrace information ------------------------------------------- 
C:\Windows\SysWOW64\ntdll.dll(ZwWaitForSingleObject+0x15) [0x77aaf8b1] 
C:\Windows\syswow64\kernel32.dll(WaitForSingleObjectEx+0x43) [0x75771194] 
C:\Windows\syswow64\kernel32.dll(WaitForSingleObject+0x12) [0x75771148] 
C:\Ruby193\bin\msvcrt-ruby191.dll(rb_vm_bugreport+0xf9) [0x62e5c69d] 
C:\Ruby193\bin\msvcrt-ruby191.dll(rb_name_err_mesg_new+0x17a) [0x62d3a856] 
C:\Ruby193\bin\msvcrt-ruby191.dll(rb_bug+0x2f) [0x62d3b533] 
C:\Ruby193\bin\msvcrt-ruby191.dll(rb_check_safe_str+0x1a4) [0x62dee738] 
 [0x004011e6] 
C:\Windows\syswow64\kernel32.dll(GetProfileStringW+0x12aa3) [0x757b003f] 
C:\Windows\SysWOW64\ntdll.dll(RtlKnownExceptionFilter+0xb7) [0x77b074df] 

-- Other runtime information ----------------------------------------------- 

* Loaded script: sqlanywhere_test.rb 

* Loaded features: 

    0 enumerator.so 
    1 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/enc/encdb.so 
    2 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/enc/iso_8859_1.so 
    3 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/enc/trans/transdb.so 
    4 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/rbconfig.rb 
    5 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/compatibility.rb 
    6 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/defaults.rb 
    7 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/deprecate.rb 
    8 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/errors.rb 
    9 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/version.rb 
   10 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/requirement.rb 
   11 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/platform.rb 
   12 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb 
   13 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/exceptions.rb 
   14 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/defaults/operating_system.rb 
   15 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_gem.rb 
   16 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb 
   17 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems.rb 
   18 C:/Ruby193/lib/ruby/site_ruby/1.9.1/ubygems.rb 
   19 C:/Ruby193/lib/ruby/1.9.1/optparse.rb 
   20 C:/Ruby193/lib/ruby/1.9.1/minitest/unit.rb 
   21 C:/Ruby193/lib/ruby/1.9.1/prettyprint.rb 
   22 C:/Ruby193/lib/ruby/1.9.1/pp.rb 
   23 C:/Ruby193/lib/ruby/1.9.1/test/unit/assertions.rb 
   24 C:/Ruby193/lib/ruby/1.9.1/test/unit/testcase.rb 
   25 C:/Ruby193/lib/ruby/1.9.1/test/unit.rb 
   26 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/date_core.so 
   27 C:/Ruby193/lib/ruby/1.9.1/date/format.rb 
   28 C:/Ruby193/lib/ruby/1.9.1/date.rb 
   29 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/path_support.rb 
   30 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/enc/utf_16le.so 
   31 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/enc/trans/utf_16_32.so 
   32 C:/Ruby193/lib/ruby/1.9.1/i386-mingw32/enc/trans/single_byte.so 
   33 C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb 
   34 C:/Ruby193/lib/ruby/gems/1.9.1/gems/sqlanywhere-0.1.6-x86-mingw32/lib/sqlanywhere.so 

[NOTE] 
You may have encountered a bug in the Ruby interpreter or extension libraries. 
Bug reports are welcome. 
For details: http://www.ruby-lang.org/bugreport.html 

This application has requested the Runtime to terminate it in an unusual way. 
Please contact the application's support team for more information. 
>Exit code: 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:31:07.447

sqlanywhere gem 已解决此问题。我一直无法成功使用 dbi。

基本上我运行的是 Ruby 的 32 位版本，并且在以下文件夹结构中没有 dbcapi.dll - `C:\Program Files\SQL Anywhere 12\Bin32`. 我有另一台测试机器（32 位）SQL Anywhere，我在 64 位测试机器上复制了 dbcapi.dll。我的路已经定好了。

总而言之 - 在运行 ruby​​ 1.9.3p385 (2013-02-06) [i386-mingw32] 以使用 sqlanywhere gem (sqlanywhere-0.1.6-x86-mingw32) 时，请确保以下几点：

dbcapi.dll 存在于以下文件夹结构中 -`C:Program Files\SQL Anywhere 12\Bin32` 确保您的路径包括`C:\Program Files\SQL Anywhere 12\Bin32`

# multithreading - 线程和锁

> ID：15798887
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:54:46.163
> 
> 标签：multithreading

我对多线程编程一无所知，所以想在这里发布一个一般性问题。我该如何执行以下操作：

main() 每 30 秒运行一次 MyMethod

MyMethod() 1\. 获取数据 2\. 进行计算 3\. 将结果保存到文件中

如何确保在 main 再次开始运行 MyMethod 之前完成保存结果（MyMethod 步骤 3）？基本上我必须以某种方式锁定该线程，直到 MyMethod 完成。随意使用任何语言作为示例，我对如何在现实中完成这些事情的概念更感兴趣。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:54:22.857

你不需要同步。您只需要确保线程工作已完成，因为最后会进行保存。

```
#include <thread>
#include <unistd.h>

int MyMethod(){
    // some code
}

int run(){
    std::thread thrd(MyMethod);
    sleep(30);
    thrd.join();
}

int main(){
    while(true)
        run();  
} 
```

# servicestack - ServiceStack 不缓存 Json

> ID：15798889
> 
> 赞同：1
> 
> 时间：2013-04-03T21:54:51.247
> 
> 标签：servicestack

我在 ASP.NET 4.5 上使用 ServiceStack。我在使用 ServiceStack InMemory 缓存时遇到问题。如果我只是直接从浏览器调用 URL，它会拉回缓存的版本，但如果我尝试通过 JQuery 中的 getJSON 调用它，它永远不会拉回缓存的版本，并且每次都重新获取数据。

这是基本的代码位...

```
 public class AResponse : IHasResponseStatus
{
    public ResponseStatus ResponseStatus { get; set; }

    public Html Html { get; set; }
}   

public object Get(A request)
    {
        var cacheKey = UrnId.Create<string>(request.UserKey + request.Id);
        var expireInTimespan = new TimeSpan(1, 0, 0);
        return RequestContext.ToOptimizedResultUsingCache(base.Cache, cacheKey, expireInTimespan, () =>
        {
            var ar = new AResponse();
            var html = new Html();
            html.Test = "test";
            ar.Html = html;
            return ar;
        });
    } 
```

...感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T05:17:14.810

我的理解是，当您从浏览器调用服务时，您将缓存一个 Html 版本。因此，ServiceStack 将通过在您的密钥上应用 .html 后缀来插入/检索。当您从 JQuery 调用它时，它将缓存 Json 版本并将 .json 后缀应用于您的密钥。`?format=json`您可以通过使用url从浏览器调用您的服务来测试这一点。这将缓存一个 json 版本（而不是 html），然后从 JQuery 调用以获取缓存的 json。

# c++ - 无法在结构中创建 1 个球体实例

> ID：15798894
> 
> 赞同：0
> 
> 时间：2013-04-03T21:55:05.577
> 
> 标签：c++, reference, struct, constants

```
#include <iostream>
#define _USE_MATH_DEFINES
#include <math.h>

using namespace std;

//the volume and surface area of sphere

struct sphere_t { float radius; }; 
sphere_t sph; 
sph.radius = 3; // this is the part that mess me up, error in sph.radius

double SphereSurfaceArea(const sphere_t &sph)
{
    return 4*M_PI*sph.radius*sph.radius; 
}

double SphereVolume(const sphere_t &sph)
{
    return 4.0/3.0*M_PI*sph.radius*sph.radius*sph.radius;
}

int main()
{

    cout << "Sphere's description: " << sph.radius << endl;
    cout << "Surface Area: " << SphereSurfaceArea(sph) << endl; 
    cout << "Volume :" <<SphereVolume(sph) << endl;

    system("pause");
    return(0);
} 
```

我得到的输出是：

> 固体的描述 表面积 体积

如何通过常量引用将数字放入 const 函数并将函数设置为 void 而不返回任何内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:07:08.970

您可以将初始化与全局变量的定义合并为一行：

```
sphere_t sph = { 3 }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T22:07:29.090

这个

```
sph.radius = 3; 
```

是一个赋值语句，它将值 3 赋给 sph.radius。C++ 的一条规则是赋值语句只能放在函数中。您已经在函数之外编写了一个。

我会这样写你的代码

```
int main()
{
    sphere_t sph; 
    sph.radius = 3;

    cout << "Sphere's description: " << sph.radius << endl; 
    cout << "Surface Area: " << SphereSurfaceArea(sph) << endl; 
    cout << "Volume :" << SphereVolume(sph) << endl;

    system("pause");
    return(0);
} 
```

现在赋值（和 sph 的声明）在函数 main 中。

# delphi - 添加注册表：从 ListBox 到 DataSet

> ID：15798899
> 
> 赞同：0
> 
> 时间：2013-04-03T21:55:20.323
> 
> 标签：delphi, listbox, dataset

我需要从两个不同的 ListBox 中读取两个名称，并将这两个名称关联到 DataSet 中的注册表中。但是，在 DataSet 上，关系是由人的 ID 建立的，名称只是一个 LookUp。

在我脑海里：

**第 1 步：**读取姓名并获取人员 ID。

**第 2 步：**在导航器的事件 BeforeInsert 中，在相应列中插入 ID。

重要信息：

*   该关系来自员工 ID 和经理 ID。

*   我是德尔福的新手。

**问题：**

实现失败，因为 DataSet 与 ListBox 位于不同的单元中，我不知道如何在不更改项目的情况下解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:12:21.937

将包含 的单元添加到具有 的单元`DataSet`的`implementation`uses 子句中`ListBox`。如果你`TDataSet`在`DataSet1`一个`TDataModule`命名`dmMyData`的 in 中`MyDataMod.pas`，你会这样做（见我下面的**注释**）：

```
unit Main;

interface
  uses Forms, ....

type
  TForm1 = class(TForm)
    ListBox1: TListBox;
    ListBox2: TListBox;
    Button1: TButton;
  protected
    procedure Button1Click(Sender: TObject);
  private
    ...
  public
    ...
  end;

implementation

uses
  MyDataMod;   // Use the actual unit name, of course

procedure TForm1.Button1Click(Sender: TObject);
begin
  if (ListBox1.ItemIndex <> -1) then
    if (ListBox2.ItemIndex <> -1) then
    begin
      // Access the dataset however you need here
      dmMyData.DataSet1.Insert;
    end;
end; 
```

**注意**当然，更好的方法是将数据与 UI 分离，并创建一个将员工和经理信息作为参数并在那里处理该信息的所有处理的过程。但是，这与您在此处提出的问题完全不同。

# php - 存储大量用户数据的最佳方式

> ID：15798900
> 
> 赞同：12
> 
> 时间：2013-04-03T21:55:22.660
> 
> 标签：php, database, linux, file, file-upload

我将用户文件存储在他们自己的名称目录中，例如

```
/username/file01.jpg
/username/file02.mp4
/username/file03.mp3 
```

但是如果更多的用户来上传更多的文件，那么这就会产生问题，因为这会导致一些或许多用户迁移到另一个驱动器。我首先选择用户名目录解决方案，因为我不希望文件名混合。我也不想更改文件名。此外，如果另一个用户上传相同的文件名，那么如果文件以原始名称存储，则会产生问题。

什么是最好的方法来做到这一点。我有一个解决方案，但想问社区这是最好的方法。

我将使用顺序文件夹，然后将文件名散列到一些非常独特的东西并存储到目录中。我要做的是将文件的原始名称和用户名存储到数据库中，并将文件名的哈希值存储在磁盘中。

当任何人想要访问该文件时，我将通过 php 读取该文件，或者替换名称，或者在此时执行某些操作，以便将文件作为原始文件名下载。

我脑子里只有这个建议的解决方案。你们有没有比这个更好的。

编辑：

我也使用文件夹系统，可能第二种方式我将使用虚拟文件夹。我的数据库是 MongoDB

**伙计们，你所有的答案都很棒而且很有帮助。我想给每个人赏金，这就是我离开它的原因，以便社区可以自动提供。谢谢大家的回答。我真的很感激。**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-03T22:59:36.343

你能创建关系 MySQL 表吗？例如：

`users`一桌`files`一桌。

您的用户表将跟踪您（我假设）已经跟踪的所有内容：

`id`, `name`,`email`等

然后文件表将存储如下内容：

`id`, `fileExtension`, `fileSize`, `userID`<----`userID`将是指向表中`id`字段的外键`files`。

那么当您保存文件时，您可以将其保存为`id`. `fileExtension`并使用查询来提取与该文件关联的用户，或与用户关联的所有文件。

例如：

```
SELECT users.name, files.id, files.extension
FROM `users`
INNER JOIN `files` on users.id = files.userID; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-20T20:49:14.877

我处理数据库上的文件元数据并使用 UUID 检索文件。我要做的是：

1.  **基于内容的识别**
    1.  来自文件内容的 MD5
    2.  命名空间 UUID:v5 根据用户的 uuid 和文件的 md5 生成唯一标识符。
    3.  基于“实名”生成路径的自定义函数。
    4.  保存在数据库中：uuid、originalname（上传的名称）、realname（生成的名称）、filesize 和 mime。（可选的添加日期和 md5）
2.  **文件检索。**
    1.  用于检索元数据的 UUID。
    2.  根据实名重新生成文件路径。
    3.  Originalname 用于向下载文件的用户显示熟悉的名称。

我处理文件名，为其分配一个命名空间 UUID 作为数据库主键，并根据用户和文件名生成路径。前提是你的用户有一个分配给他的 uuid。以下代码将帮助您避免数据库上的 id 冲突，并帮助您通过文件内容识别文件（如果您需要一种方法来发现重复的内容而不是文件名）。

```
$fileInfo = pathinfo($_FILE['file']['name']);
$extension = (isset($fileInfo['extension']))?".".$fileInfo['extension']:"";

$md5Name = md5_file($_FILE['file']['tmp_name']); //you could use other hash algorithms if you are so inclined.

$realName = UUID::v5($user->uuid, $md5Name) . $extension; //UUID::v5(namespace, value). 
```

我使用一个函数根据一些自定义参数生成文件路径，您可以使用 $username 和 $realname。如果您实现可能已按文件命名方案或任何自定义方案分区的分布式文件夹结构，这将很有帮助。

```
function generateBasePath($realname, $customArgsArray){
    //Process Args as your requirements.
    //might as well be  "$FirstThreeCharsFromRealname/"
    //or a checksum that helps you decide which drive/volume/mountpoint to use.
    //like some files on the local disk and some other from an Amazon::S3 mountpoint.
    return $mountpoint.'/'.$generatedPath; 
} 
```

作为额外的奖励，这还有：

1.  如果您在文件的记录上添加了一个属性来记录它已替换的文件 (uuid)，则可以帮助您维护版本化的文件存储库。
2.  如果添加“所有者”和/或“组”属性，则创建应用程序访问控制列表
3.  也适用于单个文件夹结构。

注意：我使用 php 的 $_FILE 作为基于此问题标签的文件源的示例。它可以来自任何文件源或生成的内容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-21T14:23:37.930

由于您已经使用 MongoDB，我建议您查看 GridFS。这是一个允许您将文件（即使它们大于 16mb）存储到 MongoDB 集合中的规范。

它是可扩展的，所以如果你添加另一个服务器就没有问题，它还存储元数据，可以分块读取文件，它还具有内置的备份功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-22T22:40:32.483

我会根据文件名的哈希值、上传的日期和时间以及文件名的用户名生成一个 GUID，保存这些值，以及数据库中文件的路径以供以后使用。如果您生成这样的 GUID，则无法猜测文件名。

例如，让用户 Daniel Steiner（我）在 2013 年 4 月 23 日凌晨 12 点 37 分将名为 resume.doc 的文件上传到您的服务器。这将给出 Daniel_Steiner+2013/23/04+00:37+resume.doc 的基值，然后将其作为 MD5 哈希 05c2d2f501e738b930885d991d136f1e。为确保文件将在正确的程序中打开，我们随后将添加正确的文件结尾，因此将获得类似[http://link.to/your/site/05c2d2f501e738b930885d991d136f1e.doc](http://link.to/your/site/05c2d2f501e738b930885d991d136f1e.doc)如果您的用户帐户已经有用户 ID ，您可以将这些添加到 URL，例如，如果我的用户 ID 为 123145，则 url 将为[http://link.to/your/site/123145/05c2d2f501e738b930885d991d136f1e.doc](http://link.to/your/site/123145/05c2d2f501e738b930885d991d136f1e.doc)

如果您将原始文件名保存到数据库中，您以后还可以提供一个下载脚本，为该文件提供其原始文件名以供下载，即使它在您的服务器上还有另一个文件名。

如果您可以使用符号链接，那么将文件重新定位到另一个硬盘上也应该不是问题。

如果您愿意，我也可以提出一个 PHP 示例 - 代码不应该太多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-16T13:35:42.833

由于文件系统是一棵树，而不是图（分面分类），因此很难想出某种方法来轻松表示多个实体，如用户、媒体类型、日期、事件、图像裁剪类型等。这就是使用关系数据库的原因更容易 - 它可以转换为图形。

但是由于它是另一个抽象级别，您需要自己编写进行低级同步的函数，包括避免名称冲突、长路径名、每个文件夹的大文件数、每个实体的传输方便性、水平缩放等。所以这取决于您的应用程序需要有多复杂

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-19T18:51:17.373

另一种策略是创建一个二维结构，其中第一级目录是用户名的前 2 个字符，然后第二级是其余字符（类似于 Git 存储其 SHA-1 对象 ID 的方式）。例如：

```
/files/jr/andomuser/456.jpg 
```

对于用户“jrandomuser”。

请注意，由于用户名可能不会像 SHA-1 值那样随机分布，您可能需要稍后添加另一个级别。怀疑它，虽然。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-23T08:18:52.967

我建议使用以下数据库结构：

![在此处输入图像描述](https://i.stack.imgur.com/ZslbN.png)

表`File`至少有：

![在此处输入图像描述](https://i.stack.imgur.com/GRnJT.png)

`IDFile`是`auto_increment`列/主键。 `UserID`是`nullable`外键。

因为`FK_File_User`我建议：

```
ON UPDATE NO ACTION -- IDUser is auto_increment too. No changes need to be tracked.
ON DELETE SET NULL  -- If user deleted, then File is not owned. Might be deleted
                    -- with CRON job or something else. 
```

不过，表中可能会添加另一列`File`：

1.  实际上传日期和时间
2.  实际的 mime 类型
3.  实际存储位置（用于分布式存储系统）
4.  下载计数（另一个表可能是更好的解决方案）

ETC...

***一些好处：***

1.  您不需要计算文件大小、哈希、扩展名或任何文件元，因为您可能通过一次数据库操作获得它。
2.  `File`您可以通过单个语句获取每个用户的文件计数/使用的空间/您写入表的任何内容的统计信息`SELECT ... GROUP BY ... WITH ROLLUP`，这比分析可能分布在多个存储设备上的实际文件要快。
3.  您可以为不同的用户应用文件访问权限。它不会对表结构数据库进行重大更改。

* * *

我不认为存储时需要原始文件名作为一种选择，原因有两个：

1.  文件可能有名称，服务器操作系统文件系统不正确支持该名称，如西里尔文文件系统。
2.  两个不同的文件可能具有完全相同的名称，因此其中一个可能会被另一个覆盖。

***所以，有一个解决方案：***

1) 将文件上传到表时重`IDFile`命名文件`INSERT`。`File`这是安全的，没有重复。

2）在需要/下载时恢复文件的名称，例如：

```
// peform query to "File" table by given ID

list($name, $ext, $size, $md5) = $result->fetch_row();

$result->free();

header('Content-Length: ' . $size);
header('Content-MD5: ' . $md5);
header('Accept-Ranges: bytes');
header('Connection: close');
header('Content-Type: application/force-download');
header('Content-Disposition: attachment; filename="' . $name . '.' . $ext . '"');

// flush file content 
```

3) 实际文件可能存储在单个目录中（因为`IDFile`是安全的）和`IDUser`-named 子目录 - 取决于具体情况。

4）作为`IDFile`直接序列，如果某些文件丢失了，您可以通过评估实际文件名序列的丢失段来获取它们的数据库元数据。然后，您可以“通知所有者”、“删除文件元”或这两个操作。

* * *

*我反对将大型实际文件作为二进制内容存储在 DBMS 本身中的想法*。

DBMS 是关于数据和分析的，它不是文件系统，如果我的拙见很重要，那么永远不应该以这种方式使用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-23T11:21:48.827

您可以安装 LDAP 服务器。LDAP 查找速度非常快，因为它针对繁重的读取操作进行了高度优化。您甚至可以查询数据

LDAP 以树状方式组织数据。

您可以按照以下示例“用户->IP 地址->文件夹->文件名”来组织数据。这种方式文件可以在物理/地理上分散，您可以非常快速地获取位置。

您也可以使用标准 LDAP 查询进行查询，例如获取特定用户的所有文件列表或获取文件夹中的文件列表等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-18T23:48:13.120

1.  Mongodb 用于存储实际文件名（例如：myImage.jpg）和其他属性（例如：MIME 类型），以及`$random-text.jpg`下面的 2\. 和 3.

2.  生成一些`$random-text`，例如：`base_convert(mt_rand(), 10, 36)`或`uniqid($username, true);`

3.  将文件物理存储为`$random-text.jpg`- 始终保持相同的扩展名

4.  注意：`filter_var()`用于确保输入文件名不会对 Mongodb 造成安全风险。

Amazon S3 可靠且便宜，请注意 S3 的“最终并发”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-22T06:25:49.437

假设用户在数据库中有一个唯一的 ID（Primary Key），如果 ID 为 73 的用户上传文件，保存如下：

“上传/$userid_$filename.$ext”

例如，73_resume.doc、73_myphoto.jpg

现在，在获取文件时，使用以下代码：

```
foreach (glob("uploads/$userid_*.*") as $filename) {
    echo $filename;
} 
```

这可以与散列解决方案（存储在数据库中）结合使用，以便获得下载路径为 73_photo.jpg 的用户不会在浏览器地址栏中随机尝试 74_photo.jpg。

# javascript - 防止将 NaN 输入到 contenteditable 字段中？

> ID：15798906
> 
> 赞同：0
> 
> 时间：2013-04-03T21:55:44.827
> 
> 标签：javascript, jquery, contenteditable, jquery-events

我正在寻找一种方法来制作仅数字（或广泛地，可以与多种类型的验证器一起使用的东西）到目前为止我有类似的东西：

```
this.ContentEditable.bind("keydown", this, function (event) {
    if ((event.data.NumericOnly === true) && (event.which != 8) && (event.which != 189) && (event.which != 190)) {
        var c = String.fromCharCode(event.which);
        if ('0123456789'.indexOf(c) < 0) { return (false); }
    }
}); 
```

这种方法的警告是，如果用户已经输入了“.”。（字符 190，`String.fromCharCode`不适用于它，字符 8 是退格）或“-”（字符 189）重复和/或除`contenteditable=true`'s 文本中的第一个字符以外的任何地方都应视为无效。我可以获取文本并使用 return (false) 取消输入；如果它已经包含一个“。” 和一个“。” 正在键入或检查光标是否位于零位置以表示 "-"`contenteditable=true`的文本中已经不存在任何内容，但我想要一些更可扩展的东西。

是否可以获得关键事件的最终结果，以便在我仍然可以选择取消关键事件的同时将其发送给验证器？

# vb6 - 如何在 VB6 中使用 execScript 检索表单值？

> ID：15798908
> 
> 赞同：2
> 
> 时间：2013-04-03T21:55:53.707
> 
> 标签：vb6

说，这是我的代码

> 将地址变暗为字符串
> 
> WebBrowser1.Document.parentWindow.execScript("var a = document.form1.address.text", "JavaScript")

如何将值提取`document.form1.address.text`到我的 VB6 变量 中`Address`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T23:20:49.830

您可以使用 DOM。

假设我们有简单的 HTML 表单：

```
<html>
<body>
    <form name="form1">
        Address: <input type="text" id="address">
    </form> 
</body>
</html> 
```

在将其加载到`WebBrowser`控件中并确保 DOM 准备就绪后，我们可以通过`address`以下方式获取字段文本：

```
Private Sub cmdGetAddressText_Click()
    Dim HTMLElement As Object
    Dim Address As String

    Set HTMLElement = WebBrowser1.Document.GetElementByID("address")
    Address = HTMLElement.Value

    MsgBox Address
End Sub 
```

**编辑：**

它甚至比这更简单。您可以直接从 VB6 访问字段值：

```
Address = WebBrowser1.Document.Form1.Address.Value 
```

**编辑#2**

如果您愿意，也可以获取 JavaScript 变量的值：

```
Private Sub cmdJSVar_Click()
    Dim Address As String
    Call WebBrowser1.Document.parentWindow.execScript("var a=document.form1.address.value; alert(a);")
    Address = WebBrowser1.Document.Script.a

    MsgBox Address
End Sub 
```

请注意，JS 变量名`.Script.a`区分大小写（即`.Script.A`不起作用）。花了一些时间才弄清楚这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T22:34:54.853

您可以提供一个`IDispatch`实现，`window.external`但这并不容易做到 VB6。

更容易`location`在 JS 中使用导航到您可以`Navigate`在 VB6 中捕获的地址，例如`http://callback?param=value&param2=anothervalue`，检测“回调”主机，解析参数并取消导航。

# php - 选择一个选择选项而不使用属性选择（做一个假的鼠标点击）

> ID：15798909
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:55:58.063
> 
> 标签：php, javascript, jquery, html, forms

我已经搜索了很长时间，但我找不到任何东西，所以我有一个问题。

我有一个表单选择选项字段，该表单有 5 个选择字段。当您在第一个字段中选择某些内容时，第二个字段将使用您选择的选项填充自己。我认为更新是由 Ajax 完成的。但我也想使用带有按钮（div/a）的表单选项字段，它将在选择字段中选择一个选项，但是当您使用

```
$('#finder-2--5').val("413058").attr('selected', 'selected').parent().focus(); 
```

该字段未单击，因此下一个字段不会重新加载。

那么有没有可能在 javascript/jQuery 中伪造真正的鼠标点击。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:18:02.427

我猜你想从选项元素中[分派一个点击事件。](http://www.w3.org/TR/DOM-Level-3-Events/#events-EventTarget-dispatchEvent)由于您使用的是 jQuery，因此您可以使用*trigger*方法。一些正在使用的浏览器不会响应点击选项元素，虽然我认为 jQuery 的事件模型提供了替代品。

设置 selected 属性并不一定会使选项被选中，它只是设置 selected 属性（这是一个[boolean 属性](http://dev.w3.org/html5/html-author/#attributes-95)）并影响*defaultSelected*属性。要选择一个选项，要么将选择的*selectedIndex*属性设置为选项的索引，要么使用*prop*方法将选项的*selected*属性设置为`true`（即 boolean `true`，而不是字符串“true”） 。

 *### 编辑

似乎最好的选择是在 select 元素上放置一个更改侦听器。*

# sql - Oracle 除数等于零

> ID：15798910
> 
> 赞同：0
> 
> 时间：2013-04-03T21:56:00.783
> 
> 标签：sql, oracle

如何在此查询周围包装 DECODE 以处理零除数而不计算分母总和两次？`thedate`除了四舍五入的百分比之外，我不想返回任何内容。

```
SELECT thedate, ROUND (100*
  SUM( case when TRUNC(ACTIVITY_END_DATE) <= thedate
     AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
     AND trunc(ACTIVITY_END_DATE) <= trunc(ACTIVITY_NEED_DATE) 
     AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0 end )  
  /
  SUM( case when TRUNC(ACTIVITY_END_DATE) <= thedate 
     AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
     AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0 end ) ) as OTR12 
       FROM TEST
       cross join (  select add_months(last_day(SYSDATE), level-7) as thedate 
       from dual connect by level <= 12  )  
       GROUP BY thedate 
       ORDER BY thedate 
```

似乎使用解码，我必须做两次分母求和
`DECODE(denominator_summation,0,NULL, numerator_summation / denominator_summation)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T21:58:36.730

使用有子句：

```
having 
SUM( case when TRUNC(ACTIVITY_END_DATE) <= thedate 
 AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
 AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0 end ) ) as OTR12 
   FROM TEST
   cross join (  select add_months(last_day(SYSDATE), level-7) as thedate 
   from dual connect by level <= 12  )
> 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T22:08:53.820

```
SELECT 
  thedate, 
  ROUND (
    100 * SUM( 
       case when TRUNC(ACTIVITY_END_DATE) <= thedate
       AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
       AND trunc(ACTIVITY_END_DATE) <= trunc(ACTIVITY_NEED_DATE) 
       AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0 end 
    ) / nullif(SUM( 
       case when TRUNC(ACTIVITY_END_DATE) <= thedate 
       AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
       AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0 end 
    ), 0) 
  ) as OTR12 
FROM 
  TEST
  cross join (  
     select add_months(last_day(SYSDATE), level-7) as thedate 
     from dual connect by level <= 12  
  )  
GROUP BY thedate 
ORDER BY thedate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T21:58:43.440

使用子查询怎么样？

```
select thedate, (case when denom <> 0 then round(100*num/denom) end)
from (SELECT thedate,
             SUM( case when TRUNC(ACTIVITY_END_DATE) <= thedate
                            AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
                            AND trunc(ACTIVITY_END_DATE) <= trunc(ACTIVITY_NEED_DATE) 
                            AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0
                  end )   as num,
             SUM( case when TRUNC(ACTIVITY_END_DATE) <= thedate 
                        AND TRUNC(ACTIVITY_END_DATE) >= add_months( trunc(thedate,'mm'), -12) 
                        AND SYSDATE  >=  trunc(thedate,'mm') then 1 else 0 end ) ) as OTR12 
        FROM TEST cross join
             (  select add_months(last_day(SYSDATE), level-7) as thedate 
                from dual connect by level <= 12  )  
        GROUP BY thedate 
     ) t
order by thedate 
```

# powershell - Powershell HTML 输出不是预期的

> ID：15798911
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:56:02.677
> 
> 标签：powershell, html-email

基本上我只是想将所有的 BIOS 信息输出到一个 HTML 表中，然后通过电子邮件发送给我自己。

具体来说，我只是想返回以下输出：

```
get-wmiobject -class "Win32_BIOS" -namespace "root\CIMV2" 
```

成一张桌子。我试过**convertto-html**，但输出到处都是，很多列（很难描述，在这里翻译得不是很好）。

到目前为止我所拥有的：

```
 function sendMail{
     $smtpServer = "server.com.au"
     $msg = new-object Net.Mail.MailMessage
     $smtp = new-object Net.Mail.SmtpClient($smtpServer)
     $msg.IsBodyHTML = $true
     $msg.From = "sender@server.com.au"
     $msg.To.Add("email@server.com.au")
     $msg.subject = "Subject"
     $msg.body = "$body"
     $smtp.Send($msg)  
}

$bios = get-wmiobject -class "Win32_BIOS" -namespace "root\CIMV2"
$body = $bios | ConvertTo-Html
sendmail 
```

虽然我也尝试过**format-table**和其他一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:09:25.823

你怎么想象它会是？期望的结果是什么？`ConvertTo-HTML`将对象转换为带有表格的 HTML 页面。这意味着它包含每个属性，这使得它变得混乱，因为它们有很多（就像 WMI 对象通常一样）。属性名称是标题，值在`ConvertTo-HTML`一行中，所以如您所见，ConvertTo-HTML 更适合输出项目数组（这将导致许多行带有单个标题行。

如果你只想显示一些属性，你需要`select-object`在使用之前定义它`ConvertTo-HTML`。

另一种解决方案（取决于您需要什么）只是使用控制台的输出而不是转换为 html。前任。

```
$bios = get-wmiobject -class "Win32_BIOS" -namespace "root\CIMV2"
$body = $bios | Out-String  
#You can use $bios | Format-List Your, Properties, Here | Out-String to specify different columns

$body

SMBIOSBIOSVersion : 3602
Manufacturer      : American Megatrends Inc.
Name              : 3602
SerialNumber      : System Serial Number
Version           : ALASKA - 1072009 
```

或者

```
$body = $bios | Format-Table -AutoSize | Out-String
#Again, you can specify columns with $bios| Format-Table -AutoSize My, Properties | Out-String

SMBIOSBIOSVersion Manufacturer             Name SerialNumber         Version         
----------------- ------------             ---- ------------         -------         
3602              American Megatrends Inc. 3602 System Serial Number ALASKA - 1072009 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T22:22:10.943

格莱默是正确的。试图把它做成一张表格并将其放入电子邮件中只会弄得一团糟。您可以通过执行以下操作将其作为 HTML 列表格式放入电子邮件中：

```
[string]$body = $bios | ConvertTo-Html -As List 
```

但是，如果您想要一个表格，您将不得不将其减少到合理数量的列以适合电子邮件。

# c# - C# 将两个属性链接在一起？

> ID：15798913
> 
> 赞同：0
> 
> 时间：2013-04-03T21:56:21.910
> 
> 标签：c#, inheritance, polymorphism

我正在尝试为学生检索模块列表并将它们添加到另一个类的属性中以显示它们。我的目标是，当我创建一个人的实例并且他们的程序具有特定名称时，它将检索该程序的模块。

这是我在 Program 类中的方法，我尝试从 Modules 类中的 ListOfModules 方法中获取模块。

```
 public List<Modules> ModuleList
    {
        get
        {
            Modules m = new Modules();

            if (m.ListOfModules == null)
            {
                return null;
            }
            else
            {
                return m.ListOfModules;
            }
        }
    } 
```

这是 Modules 类中的 ListOfModules 方法。

```
internal List<Modules> ListOfModules
    {
        get 
        {
            if (_modules == null)
            {
                return _modules;
            }
            else
            {
                return _modules;
            }
        }
    } 
```

这是我如何将模块添加到模块列表的示例。

```
class CGP : Programmes
{
    List<Modules> modules;
    public CGP() :base("CGP") //CGP is the name of the programme
    {
        modules = new List<Modules>();
        modules.Add(new Modules("example 1"));
        modules.Add(new Modules("example 2"));
    }
} 
```

那么，我如何才能在 Program 类中获取 ModuleList 方法以从 Modules 类中的 ListOfModules 方法中获取此模块列表呢？我知道这些模块正在添加到 ListOfModules 方法中，但我似乎无法弄清楚如何将其与 ModuleList 链接，因此我可以打印出该列表。

我将不胜感激任何帮助或支持，因为我花了无数时间试图解决这个问题。抱歉听起来像个业余爱好者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:16:08.367

您问题的根源似乎是您的基类中的 ModuleList 。我也不明白为什么你有 2 个级别的列表，它们似乎是完全相同的实现。

```
class Programme
{
    private List<Module> _modules = new List<Module>();

    public List<Module> Modules { get { return _moduleList; } }
}

class CGP : Programme
{
    public CGP() :base("CGP")
    {
        Modules.Add(new Module("example 1"));
        Modules.Add(new Module("example 2"));
    }
} 
```

这似乎特别愚蠢：

```
internal List<Modules> ListOfModules
{
    get 
    {
        if (_modules == null)
        {
            return _modules;
        }
        else
        {
            return _modules;
        }
    }
} 
```

无论哪种方式，您都返回相同的东西，所以检查是不必要的。它本质上与此相同：

```
internal List<Modules> ListOfModules { get { return _modules; } } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:05:14.977

没有直接的方法可以按照您描述的方式将这些东西联系起来。

我建议使用 Person 可以调用的临时服务来按名称检索模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:12:07.267

看起来您的问题是 List 模块是在 CGP 子类中声明的，因此 Programs 超类中的 ModuleList 属性无法访问它。如果您希望 Programs 类中的属性能够返回您在 CGP 构造函数中添加的模块，则需要将它们添加到 Programs 类的属性中，可能声明为受保护，以便只有子类可以访问它。

其他一些看起来很奇怪的事情：为什么您的 ModuleList getter 创建一个新的 Modules 对象然后返回它的属性？Modules 的构造函数是否会创建 ListOfModules 属性基础的数据或从某处检索它？

为什么您的 ListOfModules 属性检查 _modules 是否为空，然后返回它是否为空？我会跳过它和 _modules 属性并执行以下操作：

```
internal List<Modules> ListOfModules { get; private set; } 
```

# vb.net - EDM 模型根上的 ASP.NET Web API OData 操作

> ID：15798915
> 
> 赞同：4
> 
> 时间：2013-04-03T21:56:29.380
> 
> 标签：vb.net, asp.net-web-api, action, odata

我正在使用 OData 构建 Web API 服务，并希望将方法公开为服务中的操作，如下所示。

```
http://myServer/odata/myAction 
```

我目前正在按如下方式映射 OData 路由：

```
Dim modelBuilder As ODataModelBuilder = New ODataConventionModelBuilder
modelBuilder.EntitySet(Of Product)("Products")

Dim myAction = modelBuilder.Action("myAction")
myAction.Parameter(Of String)("Parameter1")
myAction.Returns(Of Boolean)()

Dim model As IEdmModel = modelBuilder.GetEdmModel
config.Routes.MapODataRoute("ODataRoute", "odata", model) 
```

[这个精彩的教程](http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/odata-actions)展示了如何将动作与这样的实体相关联：

```
http://myServer/odata/Products(1)/myAction 
```

按照教程，我可以在使用以下行创建模型后在 ProductsController 类中编写操作的方法：

```
Dim myAction = modelBuilder.Entity(Of Product).Action("myAction") 
```

但是，如果我不想将操作与实体相关联，我将在哪里编写操作的方法？我需要编写一个 DefaultController 类吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-03T23:30:55.210

我们目前不支持开箱即用，但您自己很容易做到这一点。下面的示例（这个不错的示例实际上来自尚未公开的 Mike Wasson :-)）

```
------------------------------------------------------
// CreateMovie is a non-bindable action. 
// You invoke it from the service root: ~/odata/CreateMovie
ActionConfiguration createMovie = modelBuilder.Action("CreateMovie");
createMovie.Parameter<string>("Title");
createMovie.ReturnsFromEntitySet<Movie>("Movies");

// Add a custom route convention for non-bindable actions.
// (Web API does not have a built-in routing convention for non-bindable actions.)
IList<IODataRoutingConvention> conventions = ODataRoutingConventions.CreateDefault();
conventions.Insert(0, new NonBindableActionRoutingConvention("NonBindableActions"));

// Map the OData route.
Microsoft.Data.Edm.IEdmModel model = modelBuilder.GetEdmModel();
config.Routes.MapODataRoute("ODataRoute", "odata", model, new DefaultODataPathHandler(), conventions);

--------------------------------------------------------------

// Implements a routing convention for non-bindable actions.
// The convention maps "MyAction" to Controller:MyAction() method, where the name of the controller 
// is specified in the constructor.
public class NonBindableActionRoutingConvention : IODataRoutingConvention
{
    private string _controllerName;

    public NonBindableActionRoutingConvention(string controllerName)
    {
        _controllerName = controllerName;
    }

    // Route all non-bindable actions to a single controller.
    public string SelectController(ODataPath odataPath, System.Net.Http.HttpRequestMessage request)
    {
        if (odataPath.PathTemplate == "~/action")
        {
            return _controllerName;
        }
        return null;
    }

    // Route the action to a method with the same name as the action.
    public string SelectAction(ODataPath odataPath, System.Web.Http.Controllers.HttpControllerContext controllerContext, ILookup<string, System.Web.Http.Controllers.HttpActionDescriptor> actionMap)
    {
        if (controllerContext.Request.Method == HttpMethod.Post)
        {
            if (odataPath.PathTemplate == "~/action")
            {
                ActionPathSegment actionSegment = odataPath.Segments.First() as ActionPathSegment;
                IEdmFunctionImport action = actionSegment.Action;

                if (!action.IsBindable && actionMap.Contains(action.Name))
                {
                    return action.Name;
                }
            }
        }
        return null;
    }
}

--------------------------------------------------

// Controller for handling non-bindable actions.
[ODataFormatting]
[ApiExplorerSettings(IgnoreApi = true)]
public class NonBindableActionsController : ApiController
{
    MoviesContext db = new MoviesContext();

    [HttpPost]
    public Movie CreateMovie(ODataActionParameters parameters)
    {
        if (!ModelState.IsValid)
        {
            throw new HttpResponseException(HttpStatusCode.BadRequest);
        }

        string title = parameters["Title"] as string;

        Movie movie = new Movie()
        {
            Title = title
        };

        db.Movies.Add(movie);
        db.SaveChanges();
        return movie;
    }

    protected override void Dispose(bool disposing)
    {
        db.Dispose();
        base.Dispose(disposing);
    }
} 
```

# asp.net-mvc - 编辑页面上的 DropDownListFor 在 POSTBACK 上将空值传递给控制器

> ID：15798916
> 
> 赞同：0
> 
> 时间：2013-04-03T21:56:31.047
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, postback, html.dropdownlistfor

我有一个在编辑页面中使用局部视图的 ASP MVC3 项目。它将正确的值加载到 中`DropDownListFor`，但是在 POST BACK 中，这些项目突然为空。

该视图使用视图模型来合并几个 SQL 表。作为该视图模型的一部分，`List`类型的集合对象`BankListAgentId`用于存储与特定客户端相关的所有代理 ID。为了正确发布和编辑集合对象中的项目，我关注了Steve Sanderson关于 ASP MVC 中的可变长度对象[的博客文章。](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)

这个过程非常适合代理 ID，但是一旦用户点击“保存”，状态代码就会全部为空。

这是视图中的代码

```
@model Monet.ViewModel.BankListViewModel

@using (Html.BeginForm())
{
    <fieldset>
        <legend>Stat(s) Fixed</legend>
        <table id="fixedRows">
            <tr>
                <th>State Code</th>
                <th>Agent ID</th>
                <th></th>
            </tr>
            @foreach (var item in Model.Fixed)
            {
                if (!String.IsNullOrWhiteSpace(item.AgentId))
                {
                    @Html.Partial("FixedPartialView", item) 
                }
            }
        </table>
        <br />
        @Html.ActionLink("Add another", "BlankFixedRow", null, null, new { id = "addFixed" })
    </fieldset>
} 
```

这是部分

```
@model Monet.Models.BankListAgentId

@using (Html.BeginCollectionItem("Variable"))
{
    <tr>
        <td>
            @Html.DropDownListFor(model => model.StateCode,
                (SelectList)ViewBag.StateCodeList, Model.StateCode)
        </td>
        <td>
            @Html.EditorFor(model => model.AgentId)
            @Html.ValidationMessageFor(model => model.AgentId)
        </td>
        <td>
        <a href="#" onclick="$(this).parent().remove();" style="float:right;">Delete</a></td>
    </tr>
} 
```

这是视图模型

```
public class BankListViewModel
{
    public int ID { get; set; }
    public string BankName { get; set; }
    public string LastChangeOperator { get; set; }
    public Nullable<System.DateTime> LastChangeDate { get; set; }

    public List<BankListAgentId> Fixed { get; set; }
    public List<BankListAgentId> Variable { get; set; }
    public List<BankListAttachments> Attachments { get; set; }

    public BankListViewModel()
    {
        //Initialize Fixed and Variable stat Lists
        Fixed = new List<BankListAgentId>();
        Variable = new List<BankListAgentId>();

        Models.BankListAgentId agentId = new BankListAgentId();

        for (int i = 0; i < 5; i++)
        {
            Fixed.Add(agentId);
            Variable.Add(agentId);

        }

        //Initialize attachment Lists
        Attachments = new List<BankListAttachments>();
        Attachments.Add(new BankListAttachments());
    }
} 
```

这是从控制器到编辑页面的原始 POST

```
 public ActionResult Edit(int id)
    {
        BankListMaster banklistmaster = db.BankListMaster.Find(id);
        BankListViewModel viewModel = new BankListViewModel();
        viewModel.BankName = banklistmaster.BankName;
        viewModel.LastChangeDate = banklistmaster.LastChangeDate;
        viewModel.LastChangeOperator = banklistmaster.LastChangeOperator;

        List<BankListAgentId> agentId = (from c in db.BankListAgentId
                                         where c.ID == id
                                         select c).ToList();

        foreach (var bankListAgentId in agentId)
        {
            string value = bankListAgentId.FixedOrVariable.Trim();
            if (value.Equals("Fixed"))
            {
                viewModel.Fixed.Add(bankListAgentId);
            }
            else
            {
                viewModel.Variable.Add(bankListAgentId);
            }
        }

        viewModel.Attachments = (from c in db.BankListAttachments
                                 where c.ID == id
                                 select c).ToList();

        SelectList tmpList = new SelectList(new[] { "AL", "AK", "AS", "AZ", "AR", "CA", "CO", "CT", "DE", "DC", "FM", "FL", "GA", "GU", "HI", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MH", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NA", "NM", "NY", "NC", "ND", "MP", "OH", "OK", "OR", "PW", "PA", "PR", "RI", "SC", "SD", "TN", "TX", "UT", "US", "VT", "VI", "VA", "WA", "WV", "WI", "WY" });
        ViewBag.StateCodeList = tmpList;

        ViewBag.ID = new SelectList(db.BankListAgentId, "ID", "FixedOrVariable", banklistmaster.ID);
        return View(viewModel);
    }

public partial class BankListAgentId
{
    public string AgentId { get; set; }
    public int ID { get; set; }
    public string FixedOrVariable { get; set; }
    public string StateCode { get; set; }

    public virtual BankListMaster BankListMaster { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:01:41.643

问题是您使用的是像 EditorTemplate 这样的局部视图。Partial Views 和 EditorTemplates 是不同的。您可以将局部视图视为包含一些额外内容的服务器端。

因此，这里的问题是您将不同的模型传递给部分，而不是在父类中使用。

```
@foreach (var item in Model.Fixed)
{
    if (!String.IsNullOrWhiteSpace(item.AgentId))
    {
        @Html.Partial("FixedPartialView", item) 
    }
} 
```

当您提交模型时，局部视图中的帮助程序将代码呈现为好像模型是固定的，因此它会错误地格式化和命名局部视图中的项目。在这种情况下，默认模型绑定器不知道“item”在名为“Fixed”的集合中，因为您已经通过迭代 foreach 循环并仅从包含的项目中渲染删除了该集合的上下文。

我建议不要使用局部视图，而是使用 EditorTemplate，因为这是它们旨在处理的内容（在对象中呈现类型），并且它们会自动处理集合。

或者，如果您希望渲染部分，则不要传入子模型，而是让它从父模型中渲染。否则，您将不得不做很多工作来确保您在部分内部有正确的命名。

或者，如果您只需要发布这个项目集合，那么您可以确保您的 Post 操作接受一个`IEnumerable<Fixed>`而不是您的父模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:03:06.020

您可能希望尝试使用编辑器模板，而不是在循环中注入部分。

```
 @foreach (var item in Model.Fixed)
    {
        if (!String.IsNullOrWhiteSpace(item.AgentId))
        {
            @Html.EditorFor(item => item, "FixedPartialView") 
        }
    } 
```

然后将 FixedPartialView.cshtml 放入适当的 EditorTemplates 文件夹。我相信，绑定对于框架来说会更加直观。

# php - 为什么我在 Opera Mobile 中打开网页时会放大网页？

> ID：15798917
> 
> 赞同：2
> 
> 时间：2013-04-03T21:56:33.097
> 
> 标签：php, html, mobile, opera-mini, opera-mobile

我正在开发网页的移动版本。我正在使用带有两个浏览器的 Symbian 手机进行测试。默认浏览器工作正常，但我在使用 Opera Mobile 时遇到问题。

每次页面加载时，它都会放大而不是适合屏幕加载。这甚至发生在这样的简单页面中：

```
 <?php
        echo    "<p>Guys I am developing a mobile version web pages, I am testing with a symbian phone with two browsers. The default browser is working properly but I am having problem with Opera Mibile, each time it loads a page a page that is zoomed in - instead of loading a page that just fits the screan. even a simple page like this one</P>
                <p>Is there anything i should include in the in my code to tell it to load a page that needs not to be zoomed. Will greatly apreciated, have spend almost the whole day on google?</p>";
    ?> 
```

**当我加载页面而不是让它们放大**加载时，有什么方法可以使页面适合屏幕？****

 **任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T22:56:07.610

`<head>`在你的元素中添加这个：`<meta content='width=device-width, initial-scale=1, maximum-scale=1' name='viewport' />`

```
<html>
    <head>
        <meta content='width=device-width, initial-scale=1, maximum-scale=1' name='viewport' />
    </head>
    <body>
        <p>Lorem ipsum ...</p>
    </body>
</html> 
```**

# php - 防止蛮力攻击的最佳方法是什么？

> ID：15798918
> 
> 赞同：35
> 
> 时间：2013-04-03T21:56:50.073
> 
> 标签：php, brute-force

我有我的登录页面，当然我想防止暴力攻击并减少用户登录时的延迟。

目前，您输入您的用户名和密码进行登录。

我正在考虑实施[reCAPTCHA](http://www.google.com/recaptcha)。但是，这会在 3 次尝试失败后在登录时显示。

我的问题是：

1.  你的尝试是基于什么。IP地址？它总是可以隐藏...用户名？如果他们正在尝试一个不存在的用户怎么办？

2.  计算失败登录尝试的最佳方法是什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-04-03T22:22:01.173

会话不可靠，因为它们依赖于 cookie，CAPTCHA 经常被破坏 [包括 ReCAPTCHA]。唯一可靠的方法看似简单：问一个问题。不要使用数学问题，因为出于某种原因，计算机*出奇地*擅长解决这些问题。伟大的旧备用是这样的：

*   [本页](http://link.to.some/page/)第六段的第四个字是什么？
*   这个网站的作者叫什么名字？[[暗示]](http://yoursite.com/about)

这是愚蠢的——容易实现，机器很难解决。

至于强制强制，请尝试在您的用户表中添加两个字段，'first_failed_login' [ `INTEGER`unix timestamp or `DATETIME`] 和 'failed_login_count'。[ `INTEGER`]

```
<?php
$bad_login_limit = 3;
$lockout_time = 600;

$first_failed_login, failed_login_count; // retrieve from DB

if(
    ($failed_login_count >= $bad_login_limit)
    &&
    (time() - $first_failed_login < $lockout_time)
) {
  echo "You are currently locked out.";
  exit; // or return, or whatever.
} else if( /* login is invalid */ ) {
  if( time() - $first_failed_login > $lockout_time ) {
    // first unsuccessful login since $lockout_time on the last one expired
    $first_failed_login = time(); // commit to DB
    $failed_login_count = 1; // commit to db
  } else {
    $failed_login_count++; // commit to db.
  }
  exit; // or return, or whatever.
} else {
  // user is not currently locked out, and the login is valid.
  // do stuff
} 
```

这将使您的登录系统每 10 分钟仅识别每个用户 3 次登录尝试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-14T22:12:30.817

不要依赖会话或 cookie，它们信任客户端，你永远不应该信任客户端。我在 PHP 中创建了一个负责暴力攻击保护的类。

[https://github.com/ejfrancis/BruteForceBlocker](https://github.com/ejfrancis/BruteForceBlocker)

它将站点范围内的所有失败登录记录在数据库表中，如果过去 10 分钟（或您选择的任何时间范围）内的失败登录次数超过设定的限制，它会强制执行时间延迟和/或验证码要求在再次登录之前。

例子：

```
 //build throttle settings array. (# recent failed logins => response).

 $throttle_settings = [

         50 => 2,            //delay in seconds
         150 => 4,           //delay in seconds
         300 => 'captcha'    //captcha 
];

 $BFBresponse = BruteForceBlocker::getLoginStatus($throttle_settings); 

//$throttle_settings is an optional parameter. if it's not included,the default settings array in BruteForceBlocker.php will be used

 switch ($BFBresponse['status']){

    case 'safe':
         //safe to login
         break;
     case 'error':
         //error occured. get message
         $error_message = $BFBresponse['message'];
         break;
     case 'delay':
         //time delay required before next login
         $remaining_delay_in_seconds = $BFBresponse['message'];
         break;
     case 'captcha':
         //captcha required
         break;

 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-23T12:59:46.590

尝试检查您是否正在处理真正的浏览器。也许一些带有随机函数名称或其他东西的讨厌的 java 脚本挑战可能会阻止许多简单的脚本，除非它们远程控制真正的浏览器（这并不罕见），或者在爬虫脚本中正确评估 js/css。

我建议您进一步阅读该主题，并针对 python mechanize 或其他一些知名的爬虫工具测试您的解决方案。

但可以肯定的是，没有针对自动攻击的真正解决方案。

# java - 如何让动画在移动的同时移动它的腿？

> ID：15798920
> 
> 赞同：-1
> 
> 时间：2013-04-03T21:56:51.567
> 
> 标签：java, swing, object, animation, jpanel

所以现在当你按下 go 时，它只是在屏幕上移动，但我也希望它移动它的腿，这样它就可以做某事，而不仅仅是静止不动。关于如何做到这一点的任何提示？我知道它会来回移动第二条腿指针，但我不知道该怎么做

类 Stick2 ：

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class Stick2 extends JFrame implements ActionListener {

    // Declares constants 
    public static final int FRAME_WIDTH = 500;
    private static final int FRAME_HEIGHT = 500;
    private static final int FRAME_X_ORIGIN = 150;
    private static final int FRAME_Y_ORIGIN  = 200;
    private static final int BUTTON_WIDTH =80;
    private static final int BUTTON_HEIGHT = 30;

    JPanel buttonPanel, panel;

    MovingBanner2 myBanner;
    JButton startButton, stopButton;

    Thread thrd;

    public static void main(String[] args) 
    {
        Stick2 frame = new Stick2();
        frame.setVisible(true);
    }

    public Stick2(){

         Container contentPane= getContentPane();

        // Sets Frame
        setSize(FRAME_WIDTH,FRAME_HEIGHT);
        setResizable(false);
        setTitle("Animation");
        setLocation(FRAME_X_ORIGIN, FRAME_Y_ORIGIN);

        // Sets layout manager
        contentPane.setLayout(new BorderLayout(10,0));

        buttonPanel = new JPanel();

        JButton startButton = new JButton("Start");
        startButton.setSize(BUTTON_WIDTH, BUTTON_HEIGHT);
        buttonPanel.add(startButton);
        startButton.addActionListener(this);

        JButton stopButton = new JButton("Stop");
        stopButton.setSize(BUTTON_WIDTH,BUTTON_HEIGHT);
        buttonPanel.add(stopButton);
        stopButton.addActionListener(this);

        contentPane.add (buttonPanel, BorderLayout.SOUTH);

        // Creates a balloon
        myBanner = new MovingBanner2();
        panel = myBanner;
        panel.setBorder(BorderFactory.createLineBorder(Color.BLUE));
        contentPane.add(panel, BorderLayout.CENTER);

    }

    public void actionPerformed (ActionEvent event){
        JButton clickedButton = (JButton) event.getSource();

        String buttonText = clickedButton.getText();

        if (buttonText.equals("Stop")) {

            myBanner.stopAnimation();
            thrd = null;
        }
        else {

            myBanner.startAnimation();
            thrd = new Thread (myBanner);
            thrd.start();

       }
    }            
} 
```

类 MovingBanner2：

```
class MovingBanner2 extends JPanel implements Runnable {

        private int x;

        private Boolean animate;

        int bodyX = 250;
        int bodyY1 = 160;
        int bodyY2 = 210;
        int armHeight = 190;
        int armLength = bodyX + 30;
        int armLength1 = bodyX - 30;
        int legY = 340;

        public MovingBanner2() {
            x=10;
            animate = true;
        }

        // Draws the String
        public void paintComponent (Graphics g) {
            super.paintComponent(g);

            g.setColor(Color.RED);
            //g.drawString("I love Java", x,50);
            g.drawLine(bodyX + x, bodyY1, bodyX + x, bodyY2); //body
            g.drawOval(bodyX + x - 15, bodyY1 - 40, 40, 40); //head
            g.drawLine(armLength + x,armHeight,  armLength1 + x, armHeight); //arms
            g.drawLine(bodyX + x, bodyY2, bodyX + 20 + x,legY); //leg
            g.drawLine(bodyX + x, bodyY2, bodyX - 20 + x, legY);    //leg
        }

        public void run() {
            while (animate) { 
                changeX();
                repaint();     
                try {Thread.sleep(100); } catch(Exception e){};
            }
        }

        public void changeX() {

            if (x <= Stick2.FRAME_WIDTH - 240)
                 x++;
            else x = 10;

        }

        public void stopAnimation() {
            animate = false;
        }

        public void startAnimation() {
            animate = true;
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T23:41:02.917

这个问题可能有很多答案。我能想到的最好的基本上就是设计某种“循环”。

循环是动画可以运行的已知时间段。在此示例中，为 1 秒。

然后，您需要提供一系列`Animatable`对象，这些对象会随着时间的推移通知循环的更改，从而允许它们进行相应的更改。您也可以忽略那些不需要循环的元素的循环。

目的是提供一个单一的动画引擎，可以负责一次更新整个状态，而不是尝试使用可能会降低系统性能的多个线程/计时器。

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.NumberFormat;
import java.util.ArrayList;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.Timer;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestAnimation06 {

    public static void main(String[] args) {
        new TestAnimation06();
    }

    public TestAnimation06() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public interface Animatable {
        public void update(float progress);
    }

    public class AnimationEngine {

        private List<Animatable> animations;
        private int cycleTime = 1000;
        private long startTime = -1;

        public AnimationEngine() {
            animations = new ArrayList<>(25);
            Timer timer = new Timer(40, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    if (startTime < 0) {
                        startTime = System.currentTimeMillis();
                    }
                    long duration = System.currentTimeMillis() - startTime;
                    float progress = (float)duration / (float)cycleTime;
                    if (duration >= cycleTime) {
                        progress = 1f;
                        startTime = System.currentTimeMillis();
                    }
                    for (Animatable animatable : animations) {
                        animatable.update(progress);
                    }
                }
            });
            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();
        }

        public void add(Animatable animatable) {
            animations.add(animatable);
        }

    }

    public class TestPane extends JPanel {

        private AnimationEngine engine;

        public TestPane() {
            setLayout(null);
            engine = new AnimationEngine();
            Legs legs = new Legs();
            Walker walker = new Walker(legs);
            engine.add(legs);
            engine.add(walker);
            walker.setSize(walker.getPreferredSize());
            add(walker);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.dispose();
        }
    }

    public class Walker extends JPanel implements Animatable {

        private int speed = 2;

        public Walker(Legs legs) {
            setLayout(new GridBagLayout());
            add(legs);
        }

        @Override
        public void update(float progress) {
            Container parent = getParent();
            int width = parent.getWidth();
            int xPos = getX() + speed;
            if (xPos <= 0) {
                speed *= -1;
                xPos = 0;
            } else if (xPos + getWidth() >= width) {
                speed *= -1;
                xPos = width - getWidth();
            }
            System.out.println(xPos);
            setLocation(xPos, (parent.getHeight() - getHeight()) / 2);
            repaint();
        }

    }

    public class Legs extends JPanel implements Animatable {

        private float frameProgress;

        public Legs() {
            setOpaque(false);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(25, 50);
        }

        @Override
        public void update(float progress) {
            frameProgress = progress;
            repaint();
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g); 
            int width = getWidth();
            int height = getHeight();

            g.setColor(Color.BLACK);
            g.drawLine(width / 2, 0, (int)(width * frameProgress), height);
            g.drawLine(width / 2, 0, width - (int)(width * frameProgress), height);
        }

    }

} 
```

# android - Android - 如何根据 Android 版本使用不同的代码行

> ID：15798926
> 
> 赞同：3
> 
> 时间：2013-04-03T21:57:12.197
> 
> 标签：android, android-version

我有一个与 10(GINGERBREAD_MR1) 到 17(JELLY_BEAN_MR1) 的 Android 版本兼容的项目。

所以，我想使用`setBackgroundDrawable`低于 16`setBackground`的版本和 16 或更高的版本。

我试过这个：

```
if (Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN) {
    subMessageFromToLinearLayout.setBackgroundDrawable(null);
} else {
    subMessageFromToLinearLayout.setBackground(null);
} 
```

但是，Eclipse 给了我：

警告`subMessageFromToLinearLayout.setBackgroundDrawable(null);`： *“视图类型的方法 setBackgroundDrawable(Drawable) 已弃用”*

并且出现错误`subMessageFromToLinearLayout.setBackground(null);`： *“调用需要 API 级别 16（当前最小值为 10）：android.widget.LinearLayout#setBackground”*

如何修复此错误，以便我可以根据正在运行的 Android 版本使用这两条线？

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T20:14:05.553

一般来说，最强大的方法是使用[类延迟加载](http://android-developers.blogspot.de/2010/07/how-to-have-your-cupcake-and-eat-it-too.html)：

```
static boolean isSDK17()
{
   return android.os.Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR1;
}

if (isSDK17())
    xyMode_SDK17.setXyMode(context, mode);
else
    xyMode_SDK8.setXyMode(context, mode);

@TargetApi(17)
public class xyMode_SDK17
{
  static void setXyMode(Context context, boolean mode)
  {...}
}

public class xyMode_SDK8
{
  @SuppressWarnings("deprecation")
  static void setXyMode(Context context, boolean mode)
   {...}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T22:16:26.257

你见过吗

[ActionBarSherlock 给出了大量“调用需要 API 级别 11（当前最小值为 7）”错误](https://stackoverflow.com/questions/10260801/actionbarsherlock-gives-tons-of-call-requires-api-level-11-current-min-is-7)

[Android - 以编程方式设置布局背景](https://stackoverflow.com/questions/12678949/android-set-layout-background-programmatically)

你可以用@TargetApi(16) 和@SuppressWarnings("deprecated") 来标记它。

如果错误仍然存​​在，请尝试清理项目或重新启动 eclipse。

> “啊，我知道 .setBackgroundDrawable(Drawable) 方法，但对我来说，IDE 与 api 16 要求有相同的错误。我正在使用 Eclipse，在重新打开 ide 并清理代码后它似乎是一个错误。非常非常抱歉，麻烦您了”。

# facebook - Facebook - 通过 Graph API 在页面上发布预定的帖子

> ID：15798928
> 
> 赞同：6
> 
> 时间：2013-04-03T21:57:23.710
> 
> 标签：facebook, facebook-graph-api

我已经阅读了不太清楚的[facebook 文档。](https://developers.facebook.com/docs/reference/api/page/#unpub_scheduled_posts)我的问题是，就像页面管理员可以在他们的页面上手动添加预定的帖子一样，我的应用程序是否可以使用正确的访问令牌执行相同的操作？我已经尝试使用 POST 请求在未来日期设置“created_time”，但它只是立即发布。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-03T22:36:33.477

是的，`scheduled_publish_time`在创建帖子时使用该参数 - 您在多个部分链接的文档中提到了此参数，其中列出了创建帖子时接受的参数，例如，在“状态更新”部分： [https://developers。 facebook.com/docs/reference/api/page/#statuses](https://developers.facebook.com/docs/reference/api/page/#statuses)

根据文档，它的值应该是 UNIX 时间戳，尽管在 Facebook API 的许多地方，您也可以使用 PHP`strtotime` [函数](http://php.net/manual/en/function.strtotime.php)可解析的任何日期，所以也尝试一下。

`Time when the page post should go live, this should be between 10 mins and 6 months from the time of publishing the post.`

如果您在指定为 false 时无法使其正常工作`published`，请尝试在创建时将其设置为“true”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-28T09:03:23.777

为最后一个答案做出贡献（我不允许发表评论）。如果您尝试发布时间表，则应使用`/{page-id}/promotable_posts`. 有关详细信息，请参阅[https://developers.facebook.com/docs/graph-api/reference/page/feed/](https://developers.facebook.com/docs/graph-api/reference/page/feed/)。

# windows - 批处理脚本 if else 命令

> ID：15798930
> 
> 赞同：8
> 
> 时间：2013-04-03T21:57:28.010
> 
> 标签：windows, batch-file, cmd, command-prompt

我正在尝试制作一个简单的批处理脚本来擦除/归零闪存驱动器并重新格式化它。它是为其他人准备的，所以我试图通过阻止格式化为 C:、D: 等来使其相对安全。

我正在寻找一个我可以使用的 IF ELSE 类型命令，作为一个错误包罗万象。

这是我的 ATM 的（主要部分）

```
:again
echo.
cls
echo.
echo  Please select the drive letter for the flash
echo  drive you wish to erase
echo.
echo    **** DO NOT SELECT C: OR D: ****
echo.
echo.
echo   *** Enter letter (no colon) ONLY e.g. "E" ***
echo.
set /p answer=
cls
echo.
echo.
echo.
if /i "%answer:~,1%" EQU "e" format E: /x /fs:FAT32 /v:FORENSICS /p:2
if /i "%answer:~,1%" EQU "f" format F: /x /fs:FAT32 /v:FORENSICS /p:2
if /i "%answer:~,1%" EQU "g" format G: /x /fs:FAT32 /v:FORENSICS /p:2
if /i "%answer:~,1%" EQU "h" format H: /x /fs:FAT32 /v:FORENSICS /p:2
if /i "%answer:~,1%" NOT exist goto again && echo    Please provide a valid drive letter for flash drive
echo. 
```

现在我知道了

```
if /i "%answer:~,1%" NOT exist goto again && echo    Please provide a valid drive letter for flash drive 
```

不是有效的语法，但我可以使用什么来实现相同的目标？我知道有一种更有效的方法可以做到这一点（例如，不要为可能的驱动器号定义 4 个变量，而是放置一个变量来监听用户输入并在存在时接受它。）

这是我第一次涉足批处理脚本（和一般的脚本），我正在学习动态，所以你可以做的“笨蛋”更好。

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-03T22:08:58.347

试试这个：

```
echo.%answer:~,1% | findstr /r /i "[e-h]"
if %errorlevel% equ 0 (
  format %answer:~,1%: /x /fs:FAT32 /v:FORENSICS /p:2
) else (
  echo Please provide a valid drive letter for flash drive.
  goto again
) 
```

# iphone - 如何在 ContainerView 内部的 ViewController 之间切换？

> ID：15798933
> 
> 赞同：2
> 
> 时间：2013-04-03T21:57:37.843
> 
> 标签：iphone, ios, objective-c, uiviewcontroller

我在另一个 ViewController 中添加了一个容器视图。由此，我真的不知道如何在 ContainerView 内的 ViewController 之间切换。

容器视图：

![容器视图](https://i.stack.imgur.com/asoBx.png)

ContainerView 中的默认 ViewController（故事板 id 为“firstView”）： ![在此处输入图像描述](https://i.stack.imgur.com/3BgPE.png)

我有最后一个 ViewController（故事板 id 为“secondView”）

由此，我该如何在 Container View 中的 firstView 和 secondView 之间切换？如何获得 ContainerView、firstView 和 secondView 的出口？如果这不是正确的方法，有人可以帮助我实现我想要的吗？

（我已经检查了苹果的文档，但没有找到我需要的东西：（）

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:45:23.110

只需将控制器的视图添加到容器视图中。

```
[controller.containerView addSubview: othercontroller.view] 
```

# java - 使用 maven-assembly-plugin 创建两个可执行的 jar

> ID：15798936
> 
> 赞同：33
> 
> 时间：2013-04-03T21:57:59.740
> 
> 标签：java, maven, maven-assembly-plugin

我有一个 Maven 项目，我想从中创建两个可执行的 jar 文件。一个将由用户交互使用，第二个将作为计划作业运行，读取前者生成的日志文件。最后，我希望这两个 jar 文件是相同的，除了 MANIFEST.MF 文件中的 Main-Class 属性。

我正在使用 maven-antrun-plugin 创建一个可执行的 jar，这似乎工作正常，直到我尝试通过引入 Maven 配置文件来创建第二个 jar 文件。我的 POM 文件的相关部分如下所示：

```
<profiles>
    <profile>
        <id>publisher</id>
        <build>
            <finalName>${project.artifactId}</finalName>
            <plugins>
                ...
                <plugin>
                    <artifactId>maven-assembly-plugin</artifactId>
                    <version>2.4</version>
                    <configuration>
                        <appendAssemblyId>false</appendAssemblyId>
                        <finalName>${project.artifactId}</finalName>
                        <archive>
                            <manifest>
                                <mainClass>fully.qualified.path.Publisher</mainClass>
                            </manifest>
                        </archive>
                        <descriptorRefs>
                            <descriptorRef>jar-with-dependencies</descriptorRef>
                        </descriptorRefs>
                    </configuration>
                    <executions>
                        <execution>
                            <phase>package</phase>
                            <goals>
                                <goal>single</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </build>
    </profile>
    <profile>
        <id>logReader</id>
        <build>
            <finalName>${project.artifactId}</finalName>
            <plugins>
                ...
                <plugin>
                    <artifactId>maven-assembly-plugin</artifactId>
                    <version>2.4</version>
                    <configuration>
                        <appendAssemblyId>false</appendAssemblyId>
                        <finalName>${project.artifactId}-logReader</finalName>
                        <archive>
                            <manifest>
                                <mainClass>fully.qualified.path.LogReader</mainClass>
                            </manifest>
                        </archive>
                        <descriptorRefs>
                            <descriptorRef>jar-with-dependencies</descriptorRef>
                        </descriptorRefs>
                    </configuration>
                    <executions>
                        <execution>
                            <phase>package</phase>
                            <goals>
                                <goal>single</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </build>
    </profile>
</profiles> 
```

实际上，两者之间的唯一区别是插件中定义的“finalName”和“mainClass”元素。

当我尝试在两个配置文件上执行 mvn:package 时（顺便说一下，我正在使用 IntelliJ IDEA），我得到两个 .jar 文件，但一个是正确的，另一个是不正确的。“正确”的包含所有依赖项和有效的 MANIFEST.MF 文件。“不正确”的文件不包含依赖项，并且 MANIFEST.MF 文件缺少我需要的“Main-Class”属性才能使其可执行。

我发现如果我只运行一个配置文件或另一个，它工作正常，但是，如果我尝试一次执行两个配置文件，它会失败。我的日志中也有以下注释，但我必须承认我并不完全理解他们在说什么：

```
[INFO] Building jar: .../target/publisher.jar
...
[INFO] Building jar: .../target/publisher-logReader.jar
[WARNING] Configuration options: 'appendAssemblyId' is set to false, and 'classifier' is missing.
Instead of attaching the assembly file: .../target/publisher-logReader.jar, it will become the file for main project artifact.
NOTE: If multiple descriptors or descriptor-formats are provided for this project, the value of this file will be non-deterministic!
[WARNING] Replacing pre-existing project main-artifact file: .../target/publisher.jar with assembly file: .../target/publisher-logReader.jar 
```

对此有什么想法吗？是否有可能以这种方式使用单个 mvn:package 生成两个 jar 文件，还是我在吠叫错误的树？

谢谢！

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-04-03T22:19:12.023

因此，我一发布此消息，就发现了此线程：

[从单个 Maven 项目创建多个可运行的 Jar（包括依赖项）](https://stackoverflow.com/questions/8726884/create-multiple-runnable-jars-with-depencies-included-from-a-single-maven-proj?rq=1)

这使用了一种不同的方法，因为它不使用两个配置文件，而是使用两个执行，例如：

```
<plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <version>2.4</version>
    <executions>
        <execution>
            <id>build-publisher</id>
            <configuration>
                <appendAssemblyId>false</appendAssemblyId>
                <archive>
                    <manifest>
                        <mainClass>fully.qualified.path.Publisher</mainClass>
                    </manifest>
                </archive>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
                <finalName>${project.artifactId}</finalName>
            </configuration>
            <phase>package</phase>
            <goals>
                <goal>single</goal>
            </goals>
        </execution>
        <execution>
            <id>build-logReader</id>
            <configuration>
                <appendAssemblyId>false</appendAssemblyId>
                <archive>
                    <manifest>
                        <mainClass>fully.qualified.path.LogReader</mainClass>
                    </manifest>
                </archive>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
                <finalName>${project.artifactId}-logReader</finalName>
            </configuration>
            <phase>package</phase>
            <goals>
                <goal>single</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

这似乎奏效了。这个故事的寓意似乎是我不完​​全了解配置文件或何时应该使用它们。

# r - 关于随机数生成器中的种子规范

> ID：15798940
> 
> 赞同：0
> 
> 时间：2013-04-03T21:58:17.387
> 
> 标签：r

我使用`sample`函数来执行一些随机采样操作。通常，随机数生成器是基于种子值的。如何确保每个 R 会话或每个示例调用将使用不同的种子值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T22:11:52.413

每当第一次需要 RNG 的种子时，R 会根据当前时间和正在运行的 R 会话的进程 ID 生成一个。设置种子的唯一（简单）方法是 via `set.seed()`，因此假设您不保存和恢复会话之间的种子（如果您希望存储种子，这是可能的，甚至是可重复研究的一个功能）*并且*不要使用相同的种子调用`set.seed()`，您应该为每个会话获得不同的种子。

要为每次调用 获取不同的种子`sample`，您必须在某种程度上模拟 R 所做的事情，并在每次调用 之前将种子设置为某个新值`sample`。这可能最好由包装函数安排，该函数将种子设置为新值**，**然后调用`sample`.

例如：

```
Sample <- function(seed, ..., verbose = FALSE) {
  if(missing(seed))
    seed <- floor(as.numeric(Sys.time()) + Sys.getpid())
  if(verbose)
    writeLines(paste("Using seed:", seed))
  set.seed(seed)
  sample(...)
}

> Sample(x = 10)
 [1]  7  3  8  9 10  2  4  5  6  1
> Sample(x = 10, verbose = TRUE)
Using seed: 1365040429
 [1]  9  5  7 10  6  8  1  4  3  2
> Sample(x = 10, verbose = TRUE)
Using seed: 1365040431
 [1]  6  9  3  5  2  1 10  8  7  4
> Sample(x = 10, verbose = TRUE)
Using seed: 1365040432
 [1]  9  6  8  1  2 10  3  4  7  5 
```

这并不完美 - 如果你调用`Sample`得太快（每秒超过一次），相同的种子将被用于在那一秒内调用的那些运行。

更多详细信息在 中`?Random`，您应该阅读。

# javascript - 谷歌地图信息框运行不正确

> ID：15798946
> 
> 赞同：0
> 
> 时间：2013-04-03T21:58:36.780
> 
> 标签：javascript, google-maps, google-maps-markers

我正在尝试创建一组附加信息框的标记。但是，无论我单击哪个标记，它总是会打开最后一个详细标记的信息框。有谁知道为什么？请帮忙。

```
var stepDisplay = new google.maps.InfoWindow();
function AddDetailMarker(map, itinerary) {
    var markers = [];
    for (var i = 1; i < itinerary.Legs.length; i++) {
        var position = new google.maps.LatLng(itinerary.Legs[i].BusStop.Latitude, itinerary.Legs[i].BusStop.Longitude);
        var title = itinerary.Legs[i].BusStop.Code + ": " + itinerary.Legs[i].BusStop.Location + " " + itinerary.Legs[i].BusStop.Street + ", Quận " + itinerary.Legs[i].BusStop.Ward;
        var detailmarker = new google.maps.Marker({
            position: position,
            map: map,
            title: title,
            icon: "/Content/img/customized_marker/" + "blue" + "/" + "bus-stop2" + ".png"
        });
        google.maps.event.addListener(detailmarker, 'click', function () {
            stepDisplay.setContent(title);
            stepDisplay.open(map, detailmarker);
        });
        markers[i-1] = detailmarker;
    }
} 
```

编辑：[谷歌地图信息窗口可能重复显示在错误的标记上](https://stackoverflow.com/questions/5736691/google-maps-infowindow-showing-on-wrong-marker?rq=1)。我已经尝试了在这里找到的所有解决方案，但没有一个有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:26:07.713

是的，这与您链接到的另一个问题完全相同，并且您的代码的解决方案是相同的 - 将创建每个标记的代码放入一个函数中，并在循环中调用该函数：

```
var stepDisplay = new google.maps.InfoWindow();
function AddDetailMarker(map, itinerary) {
    for (var i = 1; i < itinerary.Legs.length; i++) {
        addLegMarker( map, itinerary.Legs[i] );
    }
}

function addLegMarker( map, leg ) {
    var position = new google.maps.LatLng(leg.BusStop.Latitude, leg.BusStop.Longitude);
    var title = leg.BusStop.Code + ": " + leg.BusStop.Location + " " + leg.BusStop.Street + ", Quận " + leg.BusStop.Ward;
    var detailmarker = new google.maps.Marker({
        position: position,
        map: map,
        title: title,
        icon: "/Content/img/customized_marker/" + "blue" + "/" + "bus-stop2" + ".png"
    });
    google.maps.event.addListener(detailmarker, 'click', function () {
        stepDisplay.setContent(title);
        stepDisplay.open(map, detailmarker);
    });
} 
```

你明白为什么会解决它吗？和`title`现在`detailmarker`特定于每次调用`addLegMarker()`. 在原始代码中，这些变量中的每一个只有一个副本，在所有标记之间共享。

# directory-structure - 将 git 存储库克隆到自己的 .git 目录中是否安全？

> ID：15798952
> 
> 赞同：3
> 
> 时间：2013-04-03T21:59:06.410
> 
> 标签：directory-structure, git-clone, git-ftp

我最近将我的网站置于 Git 版本控制之下。我正在使用[git-ftp](https://github.com/resmo/git-ftp/)上传文件，并且我已将其设置为`master`分支是*应该*在服务器上`live`的内容，而分支是实际*在*服务器上的内容。我需要做出这种区分，因为我有时会在没有 Internet 连接的地方进行开发，因此无法立即上传。因此，为了上传，我这样做`git checkout live;git merge master;git ftp push`：我想自动化这个过程，而不是丢失其余的工作目录状态。将来，我还将设置几个文件的自动备份，这些文件将被 ftp 下载并提交到`live`分支。

为了完成所有这些，我将需要另一个克隆，它只会被自动化进程使用，并且总是有一个干净的工作目录。放置它的明显位置，因为它永远不需要查看，位于主存储库的 .git 目录中。这样，我的文件系统中的其他地方就没有一个克隆漂浮，它保持隐藏状态，很明显它是内部结构的一部分，不应该被戳穿。如果这很好用，我什至可以提交一个补丁来使用这种方法修复[git-ftp 问题 #180 。](https://github.com/resmo/git-ftp/issues/180)

但是，我不确定将随机的东西放在 .git 文件夹中是否是个好主意——我在任何地方都找不到任何关于副作用可能是什么的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T07:47:21.070

一个`.git`目录似乎完全忽略了任何额外的元素，所以直接添加一个 git repo`.git`应该可以。
如果您将嵌套存储库添加到子目录中，例如`.git/refs`（参见[Git Internals - Git References](http://git-scm.com/book/en/Git-Internals-Git-References)） ，这将不起作用

请注意，您还可以*在当前 git repo 中的任何位置*拥有该 git repo ，例如，作为一个名为的目录`.ftprepo`（以点开头的名称，默认情况下应隐藏）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T14:10:14.113

我在寻找其他东西时错误地找到了答案！

根据[https://www.kernel.org/pub/software/scm/git/docs/#_file_directory_structure](https://www.kernel.org/pub/software/scm/git/docs/#_file_directory_structure)，“更高级别的 SCM 可能会在 $GIT_DIR 中提供和管理其他信息”。这似乎意味着可以将其他信息存储在 .git 中而不会引起问题，可能包括存储库的另一个克隆。

# mysql - MYSQL SELECT MAX(id) + 1 其中 id < 1000

> ID：15798953
> 
> 赞同：2
> 
> 时间：2013-04-03T21:59:13.317
> 
> 标签：mysql, delphi, auto-increment

我需要使用类似的东西：

```
 INSERT into tablename(id) 
     SELECT max(id) + 1 
     FROM tablename 
```

其中`id`小于 1000 和`if max(id) = 1000 insert next id as 1`，因此该列从 1-1000 填充并重新开始。

我可以拥有并自动增加主键列。

任何帮助将不胜感激。

我不是 SQL 专家，但根据下面的评论，我在 Delphi 中完成了此操作，该 SQL 将在其中执行。我仍然想知道如何在 MYSQL 中完成这一切，也许这里的一位大师可以帮助解决这个问题。

这就是我所做的：

```
procedure TForm11.Button1Click(Sender: TObject);
var
lastserial : Integer;
begin
 with LastRowQuery do
  begin
    sql.Clear;
    sql.Add('SELECT autoid, id FROM inctest ORDER BY autoid DESC LIMIT 1;');
    execute;
  end;
  If  LastRowQueryid.value < 1000 then lastserial:=  LastRowQueryid.value + 1
  else
   lastserial := 1;
   with LastRowQuery do
    begin
     sql.Clear;
     sql.Add('Insert into inctest (id) values(:theserial)');
     ParamByName('theserial').Value := lastserial;
   execute;
 end;
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T22:02:29.173

我想也许你想要这个： [http ://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_mod](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_mod)

给出*类似的东西*：

```
INSERT into tablename(id) SELECT MOD(count(id),1000)+1 FROM tablename 
```

或类似地，

```
INSERT into tablename(id) SELECT (count(id)%1000)+1 FROM tablename 
```

干杯。

# .net - 窗口的高度绑定到 Wight 和 W 到 H

> ID：15798954
> 
> 赞同：0
> 
> 时间：2013-04-03T21:59:16.293
> 
> 标签：.net, wpf, xaml, binding

```
Height="{Binding Source=Self, Path=Width}"   
Width="627" 
```

这行不通。一开始，`Height`长度为`Width`，但是当我改变时`Width`，`Height`不想改变。

这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T06:12:59.993

`Height`并`Width`定义您希望元素的大小。

在渲染视觉效果期间，元素的可用大小会根据其他所有内容进行计算，`ActualHeight`并且`ActualWidth`会更新。

`Height`and`Width`不会因为这个计算而改变，但是如果`Height`和`Width`被改变，`ActualHeight`和`ActualWidth`被重新计算。

改变你`Binding`的使用路径`ActualWidth`，你应该得到一个正方形。

```
Height="{Binding ActualWidth, RelativeSource={RelativeSource Self}}" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T07:25:18.337

您应该使用`RelativeSource`绑定：

```
Height="{Binding ActualWidth,RelativeSource={RelativeSource Mode=Self}}" 
```

# android - 带有未绑定数据项的android自定义列表视图

> ID：15798955
> 
> 赞同：0
> 
> 时间：2013-04-03T21:59:17.503
> 
> 标签：android, listview, android-activity, android-edittext

我创建了一个包含带有自定义行视图的列表视图的活动。

行视图：

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/tableLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal"
    android:padding="1dp" >

    <TableRow
        android:id="@+id/row1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/itemID"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:visibility="gone" />

        <TextView
            android:id="@+id/itemDescription"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="2" />

        <TextView
            android:id="@+id/itemRequested"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1" />

        <EditText
            android:id="@+id/itemCompleted"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:inputType="number" />
    </TableRow>

</TableLayout> 
```

我正在使用我创建的自定义适配器类将 ArrayList 绑定到我的列表视图。这是我的项目类：

```
public class Item {

    @SerializedName("ItemID")
    public int ItemID;

    @SerializedName("ItemDescription")
    public String ItemDescription;

    @SerializedName("ItemModel")
    public String ItemModel;    

    @SerializedName("ItemCartons")
    public int ItemCartons;

} 
```

我正在做的是在活动列表视图中显示我的 ArrayList，并使用完美运行的自定义布局。当用户查看列表视图时，我希望他们能够在 itemCompleted EditText 控件中输入一个值，以便我可以使用已完成的数量更新项目。当我的更新事件被触发（操作栏上的按钮）时，我正在遍历列表视图并从自定义布局中获取值，如下所示：

```
 for (int i = 0; i < mListView.getCount(); i++) {
            View v = mListView.getAdapter().getView(i, null, null);
            TextView requested = (TextView) v
                    .findViewById(R.id.itemRequested);
            EditText completed = (EditText) v
                    .findViewById(R.id.itemCompleted);
            TextView itemID = (TextView) v.findViewById(R.id.itemID);

            int req = Integer.parseInt((String) requested.getText());
            int comp = Integer.parseInt(completed.getText().toString());
            int id = Integer.parseInt((String) itemID.getText());

            if (comp <= req) {
                //update item here

            } else {
                // qty is too much
                return;
            }
        } 
```

我的问题是我无法检索在 itemCompleted EditText 控件中输入的值。它始终拉取默认值，而不是用户输入的值。有没有办法可以从 EditText 中提取输入的值？

# c# - 在 XSL 中创建空格 ( )

> ID：15798957
> 
> 赞同：2
> 
> 时间：2013-04-03T21:59:24.430
> 
> 标签：c#, xml, xslt

我试图以下列方式在 XSL 文档中创建自动间距。

`<td><xsl:value-of select="Name/First"/> <xsl:text disable-output-escaping="yes"><![CDATA[&nbsp;]]></xsl:text><xsl:value-of select="Name/Last"/> </td>` 但是，呈现的 HTML 格式如下

```
<td>John&amp;nbsp;Grisham</td> 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T22:05:06.430

您的直接问题是，虽然 unicode 160 (hex 0xA0)`&nbsp;`是 HTML 实体，但它不是 XML 实体。

使用`&#160;`or`&#xA0;`代替非破坏空间。

但是对于您更大的问题，如何处理 XSL 中的空白，答案很简单：使用`<xsl:text>`.

每次包含任何纯文本时，将其括在`<xsl:text> the text goes here </xsl:text>`标签中。如果你不这样做，下次聪明的文本编辑器重新格式化你的文档时，你将陷入痛苦的世界。

您至少已经进入了一个大陆，或者如果幸运的话，您可能已经进入了一个痛苦的国家，因为期望 XML/XSL 可以节省空白。即使是理解 XSL 到第 n 级的天才，仍然会因空白处理而受到县级或至少自治市级的痛苦。（自治市镇级别的痛苦被编码在 XML 规范“2.11 End-of-Line Handling”中，因为其疯狂的设计决定拒绝区分 LF 和 CRLF - 所以没有人可以避免这种情况）。

只是为了让您知道会发生什么：这并不容易 - 您可以在没有`<xsl:text>`标签的情况下逃脱很长时间，但如果您只是接受它并从一开始就将它们放入，那么在长跑。

错误示例：

```
 <xsl:element name="MyElem">
      <xsl:attribute name="fullPath">c:\base\Path\here\<xsl:value-of select="../parent/@relPath"/>\<xsl:value-of select="@fileName">
      </xsl:attribute>
  </xsl:element> 
```

右例：

```
 <xsl:element name="MyElem">
      <xsl:attribute name="fullPath">
          <xsl:text>c:\base\Path\here\</xsl:text>
          <xsl:value-of select="../parent/@relPath"/>
          <xsl:text>\</xsl:text>
          <xsl:value-of select="@fileName">
      </xsl:attribute>
  </xsl:element> 
```

问题是，它们***都产生完全相同的输出***。

但是其中一个会***在未来的某个时候搞砸***，是的，可能***是尚未出生的人***，另一个不会。

简短的解释是这样的：默认情况下会忽略仅包含空白的节点（除非您调整选项）。所以这是任何仅由`CR`,`LF`和`TAB`和`SPACE`之间`>`的内容`<`。由具有前导和尾随空格的非空白文本组成的节点可能具有“折叠”的空白 - 即 effed。

因此，示例 RIGHT 与此之间的区别：

```
 <xsl:element name="MyElem">
      <xsl:attribute name="fullPath">
          c:\base\Path\here\
          <xsl:value-of select="../parent/@relPath"/>
          \
          <xsl:value-of select="@fileName">
      </xsl:attribute>
  </xsl:element> 
```

是一个生成`<MyElem fullPath="c:\base\Path\here\relative\path\filename.txt"/>`，另一个根据有效的 DOM 选项生成以下之一：

```
<MyElem fullPath="c:\base\Path\here\relative\path\filename.txt"/>
<MyElem fullPath="c:\base\Path\here\ relative\path \ filename.txt"/>
<MyElem fullPath="c:\base\Path\here\&#10;relative\path&#10;\&10;filename.txt"/>
<MyElem fullPath="c:\base\Path\here\&#9;&#10;relative\path&#9;&#10;\&#9;&10;&#9;filename.txt"/> 
```

只有其中一个是您想要的……但根据有效的选项***，其中任何一个都可能是正确的……***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T22:23:32.847

用了这个`<xsl:text disable-output-escaping="yes">&amp;</xsl:text>nbsp;`，它奏效了！

# javascript - ajax事件后window.location没有触发

> ID：15798959
> 
> 赞同：1
> 
> 时间：2013-04-03T21:59:25.653
> 
> 标签：javascript, ajax

我不确定这是否与 ajax 调用有关。我对 Ajax 很陌生，所以我怀疑这是原因。

我运行以下 javascript：

```
function GetXmlHttpObject() {
"use strict";
var objXMLHttp = null;

if (window.XMLHttpRequest) {
    objXMLHttp = new XMLHttpRequest();
} else if (window.ActiveXObject) {
    objXMLHttp = new window.ActiveXObject("Microsoft.XMLHTTP");
}

return objXMLHttp;
}

function delete_director(i) {
"use strict";
var r, url;

r = window.confirm("Are you sure you want to disable this director");
url = "ajax.php?task=director&event=delete&UserId=" + i;

if (r === true) {
    mdata = new GetXmlHttpObject();

    if (mdata === null) {
        alert("Browser does not support HTTP Request");
        return;
    }

    mdata.open("GET", url, true);
    mdata.send(null);
}
} 
```

这会调用以下 php 函数：

```
function deletedirector()
{
    $UserId=mysql_real_escape_string($_GET['UserId']);
    $query = "update tbl_users set IsDisabled='1' where UserId=".$UserId;
    $result = mysql_query($query) OR die('Cannot perform query!');
    if ($result) {
        error_log("a");
        ?><script type="text/javascript">window.location='index.php?task=director&success=Director Successfully Deleted.'</script><?
    } else {
        error_log("b");
        ?><script type="text/javascript">window.location='index.php?task=director&error=Director Deletion Failed.'</script><?
    }
} 
```

db 显示director 已被删除，错误日志中显示“a”，但window.location 永远不会触发。

用户体验是浏览器提示确认，然后 - 什么都没有。JavaScript 控制台现在显示错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:38:12.497

您已经返回带有函数的新对象（XMLHttpRequest API），所以这里不需要**new**

```
...
if (r === true) {
    mdata = GetXmlHttpObject();
... 
```

并尝试像这样使用[onreadystatechange](http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp)

```
mdata.onreadystatechange = function(){
    if (mdata.readyState === 4) {
        alert("some text");
    } else {
        alert(mdata.status);
    }
}; 
```

# mysql - 无法连接到mysql

> ID：15798960
> 
> 赞同：0
> 
> 时间：2013-04-03T21:59:26.003
> 
> 标签：mysql, linux, ubuntu

当我运行它`sudo service mysql`时，它工作得很好，但是当我运行它时`mysql -u root`，我收到一条错误消息：

拒绝用户访问：'root'@'@localhost'

我该如何解决？我需要检查 /etc/mysql/my.cnf 中的内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:02:00.060

尝试执行 -p - 这应该会提示您输入密码。

# sql - 包含不同数据类型的列的总和

> ID：15798962
> 
> 赞同：0
> 
> 时间：2013-04-03T21:59:29.550
> 
> 标签：sql

我正在尝试对成本值求和，但我认为问题在于我的成本列中除了实际值之外没有设置值和空值。所以`Sum(t.cost)`给了我错误的总和，`coalesce(t.cost)`给了我错误的总和。需要做什么才能为每个学生获得正确的金额？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:10:58.710

我认为您的“成本”列不是数字？！？任何...

```
declare @t table (id int, cost varchar(10) null)

insert into @t values (1,'123.456')
insert into @t values (2,'456.789')
insert into @t values (3,null)
insert into @t values (3,'notset')

select sum(cast(nullif(cost,'notset') as money)) from @t 
```

# average - 计算平均往返时间？

> ID：15798963
> 
> 赞同：2
> 
> 时间：2013-04-03T21:59:33.783
> 
> 标签：average, icmp, traceroute, roundtrip

我使用了 traceroute 命令并 ping 了我的 Amazon 实例。这是我回来的结果：

```
traceroute to 10.250.19.146 (10.250.19.146), 30 hops max, 60 byte packets

1  ip-10-8-145-1.us-west-2.compute.internal (10.8.145.1)  0.996 ms  1.234 ms  3.698 ms
2  100.70.166.213 (100.70.166.213)  0.855 ms  1.179 ms 100.70.166.117 (100.70.166.117)  0.860 ms
3  100.70.175.66 (100.70.175.66)  0.925 ms 100.70.175.174 (100.70.175.174)  0.771 ms 100.70.175.238 (100.70.175.238)  0.811 ms
4  100.70.173.157 (100.70.173.157)  0.811 ms 100.70.172.193 (100.70.172.193)  0.866 ms 100.70.173.69 (100.70.173.69)  0.849 ms
5  100.70.164.46 (100.70.164.46)  4.411 ms 100.70.163.206 (100.70.163.206)  4.655 ms  4.915 ms
6  ip-10-250-19-146.us-west-2.compute.internal (10.250.19.146)  0.563 ms  0.267 ms  0.267 ms 
```

使用数据，我如何计算平均 RTT 时间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T22:35:52.723

您不需要使用 traceroute 来获取到特定目的地的平均 RTT。您可以为此使用 ping。如果那是您要尝试做的事情，那么只需将 ping 命令输出中的“时间”字段平均分配给几个数据包。

如果您实际上是想获得到达目的地路径上每一跳的平均 RTT，那么您可以在显示的每条线上平均三次（traceroute 默认发送三个数据包并为每个数据包提供 RTT）。这将为您提供每个跃点的平均 RTT（显然，小样本，您需要调整 traceroute 以向每个跃点发送更多数据包以获得更完整的平均值）。

编辑：如果由于某种原因，您需要使用 traceroute 并且只对最终目的地感兴趣，您可以平均输出最后一行显示的时间。这是到最终目的地的平均 RTT。

# git - 如何从存储在外部文件夹中的克隆分支对 Git 发出拉取请求？

> ID：15798964
> 
> 赞同：0
> 
> 时间：2013-04-03T21:59:35.490
> 
> 标签：git, external, git-branch, repository, pull-request

我迷失了Git...

我`abc`在 Git 和本地都有一个分叉的存储库。我需要在一个单独的目录中创建原始 repo 分支的克隆（比如说`abc_branch_1.1`，修改内容，然后向原始分叉 repo 上的同一分支发出拉取请求。

我无法让它工作。

我设法将分支克隆到文件夹 ( `external_branches/`) 中，添加了我的东西并准备提交。

`abc_branch_1.1`问题是，我的在线分叉回购对文件夹中的分支一无所知`external_branches/`？我认为分支应该在那里，但事实并非如此。

**问题：**
知道如何解决这个 Git 难题 = 让我的“外部”分支位于实际的 repo 中（本地和在线），这样我就可以在 repo 中的分支上创建 PR，我是从哪里分叉出来的？

谢谢！

**编辑**：
所以我将遥控器设置为：

git remote set-url origin git@github.com:my_username/forked_repo

然后当我修改、添加、提交并尝试推送时，我得到

```
Everything up-to-date 
```

当我检查状态时：

```
Your branch is ahead of origin/abc_branch_1.1 by 1 commit 
```

还是一头雾水。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:28:31.437

我将假设“在 Git 和本地”，您实际上是指“在 Github 和本地”或任何其他类似的 git 存储库托管平台。

当您在本地从 fork 克隆时，您不再需要克隆。特别是，分支是在同一个本地存储库和目录中完成的，您不需要复制任何内容。所以它不同于其他系统，如 Subversion。实际上，互联网上有关于此的文档，例如[http://git-scm.com/book/en/Git-Branching-Basic-Branching-and-Merging](http://git-scm.com/book/en/Git-Branching-Basic-Branching-and-Merging)

为了解决您的难题，它可能归结为

```
git checkout -b abc_branch_1.1
<-- make modifications -->
<-- commit the modifications -->
<-- check git status -->
git push -u 
```

# php - 将变量从 Php 返回到 JQuery Ajax

> ID：15798967
> 
> 赞同：0
> 
> 时间：2013-04-03T21:59:53.943
> 
> 标签：php, jquery, ajax

**我想要做什么**
我想将用户名和分数发送到我的 php 页面，在那里它将数据插入数据库，然后吐出一个显示前十名分数的 html 字符串。

**实际发生**
了什么我输入用户名和分数，然后单击提交。数据被发送到php，然后将其存储在数据库中。然后，php 文件正确地构造了字符串，我可以通过直接访问 php 页面看到。但是，字符串不会返回到我的 JQuery。

```
$("#leaderboardForm > input[type=image]").click(function() {
    var theName = $("input#leaderboardName").val();
    var theScore = $("input#theScore").val();
    $.ajax({
      type: "POST",
      url: "../admin/submitleaderboard.php",
      data: { leaderboardName: theName, theScore: theScore },
      dataType: "html",
      success: function(leaderboard) {
        $("div#deadStats").html(leaderboard);
      },
      error: function() {
          alert("An error occured submitting your score.");
      }
    });
}); 
```

```
 $name = $_POST['leaderboardName'];
$score = $_POST['theScore'];

$sql="INSERT INTO leaderboard (leaderboard_date,leaderboard_name,leaderboard_score) VALUES (CURDATE(),'$name','$score')";
$result = mysql_query($sql);

$sql="SELECT * FROM leaderboard";
$result = mysql_query($sql);

while($row = mysql_fetch_array($result)) {
    $leaderboard = $leaderboard . "<div style='width: 433px; padding: 8px; overflow: hidden; border: 1px solid #300; margin-bottom: 5px;'>";
    $leaderboard = $leaderboard . "<div style='width: 200px; height: 30px; float: left;'>";
    $leaderboard = $leaderboard . "<span style='color: #EFEFEF; font-weight: bold; font-size: 20px;'>" . $row['leaderboard_name'] . "</span></div>";
    $leaderboard = $leaderboard . "<div style='width: 200px; height: 30px; float: left;'>";
    $leaderboard = $leaderboard . "<span style='color: #A00; font-weight: bold; font-size: 20px;'>" . $row['leaderboard_score'] . "</span></div>";
    $leaderboard = $leaderboard . "</div>";
}
echo $leaderboard;
mysql_close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:01:29.180

您的`$.ajax`方法需要`json`响应。你回来了`text/plain`。将最后一个 php 行更改为：

```
echo json_encode($leaderboard); 
```

它会像那样工作，但要真正正确，您可能应该添加：

```
header('Content-Type: application/json'); 
```

在输出任何内容之前到您的 PHP 页面顶部。

### 更新

我看到您正在阅读数据库行并在 php 中回显它。然后你想把它附加到你的页面上。

最**简单**的方法是删除通话中`dataType: "html"`的一部分。`$.ajax`（不要做上述**更新**标题的任何事情，我假设你在那里返回一个数组）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:44:52.857

我想我可能已经找到了解决方案。

出于某种原因，如果我使用输入>图像或输入>提交作为我的 Ajax 的触发器，我会收到错误消息。如果我使用 div/span/textfield 或任何其他通常不提交表单的元素，它就可以正常工作。

有人可以详细说明吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:02:19.500

您说您期望 html 作为答案，但您将 ajax 请求的数据类型声明为 json：

```
dataType: "json" 
```

尝试删除它，或将其设置为 html。

# python - Python MySQL 转义特殊字符

> ID：15798969
> 
> 赞同：9
> 
> 时间：2013-04-03T22:00:02.413
> 
> 标签：python, mysql

我正在使用 python 将带有特殊字符的字符串插入 MySQL。

要插入的字符串如下所示：

```
macaddress_eth0;00:1E:68:C6:09:A0;macaddress_eth1;00:1E:68:C6:09:A1 
```

这是SQL：

```
UPGRADE inventory_server 
set server_mac = macaddress\_eth0\;00\:1E\:68\:C6\:09\:A0\;macaddress\_eth1\;00\:1E\:68\:C6\:09\:A1' 
where server_name = 'myhost.fqdn.com 
```

当我执行更新时，我收到此错误：

```
ERROR 1064 (42000): 
You have an error in your SQL syntax; check the manual that corresponds to your 
MySQL server version for the right syntax to use near 'UPGRADE inventory_server 
set server_mac = 'macaddress\_eth0\;00\:1E\:68\:C6\:09\' at line 1 
```

蟒蛇代码：

```
sql = 'UPGRADE inventory_server set server_mac = \'%s\' where server_name = \'%s\'' % (str(mydb.escape_string(macs)),host)
print sql

try:
    con = mydb.connect(DBHOST,DBUSER,DBPASS,DB);
    with con:
       cur = con.cursor(mydb.cursors.DictCursor)
       cur.execute(sql)
   con.commit()
except:
return False 
```

我怎样才能插入这个文本原始？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-03T22:03:08.713

这是您应该使用[参数绑定](http://www.python.org/dev/peps/pep-0249/#id15)而不是在 Python 中格式化参数的原因之一。

只需这样做：

```
sql = 'UPGRADE inventory_server set server_mac = %s where server_name = %s' 
```

然后：

```
cur.execute(sql, macs, host) 
```

这样，您可以将字符串作为字符串处理，并让 MySQL 库为您找出如何引用和转义它。

最重要的是，您通常可以获得更好的性能（因为 MySQL 可以编译和缓存一个查询并将其重用于不同的参数值）并避免[SQL 注入攻击](http://xkcd.com/327/)（让自己被黑客入侵的最常见方法之一）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-09-26T14:56:15.783

## 欢迎来到字符串编码格式的世界！

tl;dr - 在 MySQL 列中存储数据时处理引号和转义字符的首选方法是使用参数化查询并让 MySQLDatabase 驱动程序处理它。或者，您可以通过在插入之前将引号和斜杠加倍来转义它们。

### 链接底部的完整示例

### 标准 SQL 更新

```
# as_json must have escape slashes and quotes doubled
query = """\
        UPDATE json_sandbox
        SET data = '{}'
        WHERE id = 1;
    """.format(as_json)

with DBConn(*client.conn_args) as c:
    c.cursor.execute(query)
    c.connection.commit() 
```

### 参数化 SQL 更新

```
# SQL Driver will do the escaping for you
query = """\
        UPDATE json_sandbox
        SET data = %s
        WHERE id = %s;
    """

with DBConn(*client.conn_args) as c:
    c.cursor.execute(query, (as_json, 1))
    c.connection.commit() 
```

### 无效的 JSON SQL

```
{
  "abc": 123,
  "quotes": "ain't it great",
  "multiLine1": "hello\nworld",
  "multiLine3": "hello\r\nuniverse\r\n"
} 
```

### 有效的 JSON SQL

```
{
  "abc": 123,
  "quotes": "ain''t it great",
  "multiLine1": "hello\\nworld",
  "multiLine3": "hello\\r\\nuniverse\\r\\n"
} 
```

### Python转换：

```
# must escape the escape characters, so each slash is doubled
# Some MySQL Python libraries also have an escape() or escape_string() method.
as_json = json.dumps(payload) \
    .replace("'", "''") \
    .replace('\\', '\\\\') 
```

# 完整示例

```
import json
import yaml

from DataAccessLayer.mysql_va import get_sql_client, DBConn

client = get_sql_client()

def encode_and_store(payload):
    as_json = json.dumps(payload) \
        .replace("'", "''") \
        .replace('\\', '\\\\')

    query = """\
            UPDATE json_sandbox
            SET data = '{}'
            WHERE id = 1;
        """.format(as_json)

    with DBConn(*client.conn_args) as c:
        c.cursor.execute(query)
        c.connection.commit()

    return

def encode_and_store_2(payload):
    as_json = json.dumps(payload)

    query = """\
            UPDATE json_sandbox
            SET data = %s
            WHERE id = %s;
        """

    with DBConn(*client.conn_args) as c:
        c.cursor.execute(query, (as_json, 1))
        c.connection.commit()

    return

def retrieve_and_decode():
    query = """
        SELECT * FROM json_sandbox
        WHERE id = 1
    """

    with DBConn(*client.conn_args) as cnx:
        cursor = cnx.dict_cursor
        cursor.execute(query)

        rows = cursor.fetchall()

    as_json = rows[0].get('data')

    payload = yaml.safe_load(as_json)
    return payload

if __name__ == '__main__':

    payload = {
        "abc": 123,
        "quotes": "ain't it great",
        "multiLine1": "hello\nworld",
        "multiLine2": """
            hello
            world
        """,
        "multiLine3": "hello\r\nuniverse\r\n"
    }

    encode_and_store(payload)
    output_a = retrieve_and_decode()

    encode_and_store_2(payload)
    output_b = retrieve_and_decode()

    print("original: {}".format(payload))
    print("method_a: {}".format(output_a))
    print("method_b: {}".format(output_b))

    print('')
    print(output_a['multiLine1'])

    print('')
    print(output_b['multiLine2'])

    print('\nAll Equal?: {}'.format(payload == output_a == output_b)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-20T15:06:34.483

## Python 示例如何插入原始文本：

**在 MySQL 中创建一个表：**

```
create table penguins(id int primary key auto_increment, msg VARCHAR(4000)) 
```

**Python代码：**

```
#!/usr/bin/env python
import sqlalchemy
from sqlalchemy import text

engine = sqlalchemy.create_engine(
    "mysql+mysqlconnector://yourusername:yourpassword@yourhostname.com/your_database")
db = engine.connect()

weird_string = "~!@#$%^&*()_+`1234567890-={}|[]\;':\""

sql = text('INSERT INTO penguins (msg) VALUES (:msg)')
insert = db.execute(sql, msg=weird_string)

db.close() 
```

**运行它，检查输出：**

```
select * from penguins

1      ~!@#$%^&*()_+`1234567890-={}|[]\;\':" 
```

插入时没有解释这些字符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-03T13:55:35.340

虽然我也觉得应该使用参数绑定，但是还有这个：

```
>>> import MySQLdb
>>> example = r"""I don't like "special" chars ¯\_(ツ)_/¯"""
>>> example
'I don\'t like "special" chars \xc2\xaf\\_(\xe3\x83\x84)_/\xc2\xaf'
>>> MySQLdb.escape_string(example)
'I don\\\'t like \\"special\\" chars \xc2\xaf\\\\_(\xe3\x83\x84)_/\xc2\xaf' 
```

# javascript - 如何检测javascript中多个ajax调用的处理何时完成？

> ID：15798970
> 
> 赞同：5
> 
> 时间：2013-04-03T22:00:05.587
> 
> 标签：javascript, jquery

假设我有以下内容：

```
function main() {

  var finished = false;

  for(var i=0; i < 3; i++) {
    do(i);
  }
}

function do(i) {
  $.ajax({
   url:"myurl.com/"+i,
   datatype:"text/xml",
   success: function() {

        // Two more layers of multiple nested $.ajax elements here
   }
  })
} 
```

在三次迭代后所有“做”完成后，有什么方法可以弹出一个警告框吗？如何？语法会有所帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-03T22:08:45.507

ajax 调用返回一个 jQuery Promise 对象。您可以在一个数组中收集每个的输出，并使用`$.when`将这些承诺“捆绑”在一起。

此代码是您想要的基本思想：

```
function main() {

  var finished = false;

  var defs = [];

  for(var i=0; i < 3; i++) {
    defs.push(do(i));
  }

  $.when.apply(null, defs).done(function() {
    //this code will only run when all ajax calls are complete
  });
}

function do(i) {
  var promise = $.ajax({
   url:"myurl.com/"+i,
   datatype:"text/xml",
   success: function() {

        // Two more layers of multiple nested $.ajax elements here
   }
  })

  return promise;
} 
```

浏览器可以有很多开放的 HTTP 连接，不要让反对者说服你。这是浏览器支持的最大并发连接表。让您的网站使用统计数据成为您的指南，但即使是一次 2 个 ajax 请求也比完全同步的数据请求更快......

```
Firefox 2:  2
Firefox 3+: 6
Opera 9.26: 4
Opera 12:   6
Safari 3:   4
Safari 5:   6
IE 7:       2
IE 8:       6
IE 10:      8
Chrome:     6 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T22:08:36.907

作为全球：

```
var complete = 0; 
```

所有 AJAX 调用；

```
$.ajax({
  ... //other attributes,
  complete: function(){
    complete++;
    if (complete == 3) {
      alert('all completed');
    }
  }
}); 
```

这将在完成三个 AJAX 调用时执行。但是，如果您需要增加它，那么就这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:06:40.623

您可以为此使用一组状态：

```
function main() {
  var ready = new Array(3);
  for (var i = 0; i < 3; i++) {
    ready[i] = false;
  }

  for (var i = 0; i < 3; i++) {
    do(i, ready);
  }
}

function do(i, ready) {
  $.ajax({
   url:"myurl.com/"+i,
   datatype:"text/xml",
   success: function() {
     // If there are multiple layers then the next statements should be executed in the last layer.
     ready[i] = true;
     if (isAllReady(ready)) {
       alert("All done!");
     }
   }
  })
}

function isAllReady(ready) {
  var allReady = true;
  for (var i = 0; i < 3; i++) {
    if (!ready[i]) {
      allReady = false;
    }
  }
  return allReady;
} 
```

# c - 第二次调用 printf 时出现分段错误

> ID：15798974
> 
> 赞同：7
> 
> 时间：2013-04-03T22:00:14.713
> 
> 标签：c, segmentation-fault

我正在编写一个简单的 C 程序，它打开一个文件，并将每一行读入一个数组，其中 LISTS 是我希望读取的文件中的最大行数。

但是，当 MASTER_LIST 小于 LISTS 行时，我第二次在 printf() 上遇到分段错误，但不是第一次（我已经评论显示在哪里）。

我对这种行为有点困惑，我想知道是什么原因导致它以及我能做些什么来规避它。理想情况下，当 fgets 找到文件末尾时，我会停止阅读。

```
#define MASTER_LIST "master_list.txt"
#define LINE 64
#define LISTS 32

char **lists = malloc(LISTS * sizeof(char *));
int i; 
for (i = 0; i < LISTS; i++) {
    lists[i] = malloc(LINE * sizeof(char));
}

/*Open the file for reading.*/
FILE *fp = fopen(MASTER_LIST, "r");
if (fp != NULL) {
    /*Each line of the file, up to LISTS is read into lists.*/
    for (i = 0; i < LISTS; i++){

        lists[i] = fgets(lists[i], LINE, fp);
        /*NO SEGFAULT HERE*/ printf("Line Read: %s\n", lists[i]);                   
    }
}

/*print out each line*/
for(i = 0; i < LISTS; i++){
    printf("Are we segfaulting yet? %d\n", i);
    /*HERE I GET A SEGFAULT*/ printf("%s\n", lists[i]);
    printf("How about now? %d\n", i);       
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-03T22:14:27.907

`fgets`如果它无法读取任何字符，则返回`NULL`，如果您的文件包含少于`LISTS`行数，则会发生这种情况。尝试`printf`NULL 指针是未定义的行为。

* * *

这是提醒自己未定义行为**确实是**未定义的好时机。看起来应该*第*`printf`一次崩溃。*但是，C 规范没有说明应该*发生什么，所以你只是打印（例如，许多 Linux libcs​​ 都这样做）。**`printf``(null)`**

 **那么为什么*第二次* `printf`崩溃呢？这是因为你使用了模式

```
printf("%s\n", lists[i]); 
```

许多编译器会将其优化为

```
puts(lists[i]); 
```

在您的系统上，`puts`不检查 NULL 指针，因此会出现段错误**。**

故事的道德启示？永远不要依赖未定义的行为，甚至不要期望一致的结果。**

# syntax-highlighting - Google Code Prettify - 没有行号的条纹/钢琴键？

> ID：15798976
> 
> 赞同：2
> 
> 时间：2013-04-03T22:00:15.070
> 
> 标签：syntax-highlighting, google-code-prettify

我正在使用 Prettify（来自 Google 代码 - [https://code.google.com/p/google-code-prettify/](https://code.google.com/p/google-code-prettify/)）。当添加 linenums 属性时，它会在每一行上使用交替的背景颜色来呈现程序（即，它使用“条纹”或“钢琴键”）。当一个人删除该属性时，Prettify 不再条纹线。

是否可以让 Prettify 在不添加行号的情况下对源代码进行条带化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:21:55.197

如果您查看[主题库](http://google-code-prettify.googlecode.com/svn/trunk/styles/index.html)，您会发现这受到样式表的影响，并且每行都有一些带有行号的内容。

* * *

就像是

```
<style>li.L4, li.L9 { list-style-type: none }</style> 
```

应该这样做。

[默认样式表](https://code.google.com/p/google-code-prettify/source/browse/trunk/src/prettify.css)的操作部分是

```
li.L0,
li.L1,
li.L2,
li.L3,
li.L5,
li.L6,
li.L7,
li.L8 { list-style-type: none } 
```

这会关闭索引为*i* where *(i % 10) ∉ (4,9)*的所有项目的列表项目符号，因此`li.L4, li.L9`选择器会填补空白。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-19T04:29:34.840

答案是肯定的。 [迈克塞缪尔的回答](/a/15839819)似乎误解或忽略了这个问题。

每当请求行号时，代码的“钢琴键”条带（不是行号）与具有交替背景颜色的每隔一行文本一起发生。我想在显示行号时将其关闭，但最初的提问者想知道如何打开它（如 Excel 电子表格）但不显示行号。然而，这两个问题**似乎**都与行号或`li`样式没有任何直接关系，因此造成了混乱。

为了解决这个问题，`background-color`可以添加一个属性；这会覆盖带编号的美化命令的条纹颜色并允许自定义条纹。

最终找到了我的问题和原始问题的答案。添加了一个样式来覆盖当前的美化代码，如下所示。您仍必须`linenums`在`prettify`课程中指定，但`none`会显示：

### 突出显示每 5 行没有数字：

```
<style>
 li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8
   { background:#000022  !important; list-style-type:none !important}
 li.L4,li.L9
   { background:#080833  !important; list-style-type:none !important}
</style> 
```

### 用 nums 突出显示每 5 行：

```
 <style>
  li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8
    { background:#000022  !important; list-style-type:decimal !important}
  li.L4,li.L9
    { background:#080833  !important; list-style-type:decimal !important}
 </style> 
```

* * *

**重要提示**：大括号前没有逗号。如果插入这样的逗号，样式将失败！

# trello - Trello 集成

> ID：15798977
> 
> 赞同：2
> 
> 时间：2013-04-03T22:00:16.130
> 
> 标签：trello

我不知道这是否可能。我正在尝试将 Trello 与谷歌应用程序集成，并希望能够让用户在应用程序中使用 Trello 卡，而不必明显地访问 Trello 站点。

我可以将实际卡导入应用程序还是仅导入数据？

马丁·罗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-07T12:34:19.203

如果您的 Google 应用程序提供了一种托管网页的方式，那么您应该能够托管卡片的页面。只需使用可通过 API 获得的卡片 URL，方法类似于：

```
/1/cards/<cardId>?fields=url&key=<appKey>[&token=<userToken>] 
```

否则，我认为您唯一的选择是通过 API 接收数据（通过`fields=url&`从上面删除）并在您的应用程序中重建卡片的 UI。

# arrays - 将实时音频输入数据放入数组

> ID：15798979
> 
> 赞同：0
> 
> 时间：2013-04-03T22:00:23.383
> 
> 标签：arrays, microphone, web-audio-api, getusermedia

嘿，我正在使用 GetUserMedia() 从用户的麦克风捕获音频输入。同时，我想将捕获的值放入一个数组中，以便我可以使用它们进行操作。我正在使用以下代码，但问题是我的数组一直被值 128 填充（我现在在控制台中打印结果），我找不到我的错误。有人可以帮我找出我的错误吗？

```
//create a new context for audio input
context = new webkitAudioContext();
var analyser = null;
var dataarray = [];

getLiveInput = function() {
 navigator.webkitGetUserMedia({audio: true},onStream,onStreamError);
};

function onStream(stream) 
{
  var input = context.createMediaStreamSource(stream);
  analyser = context.createAnalyser();
  var str = new Uint8Array(analyser.frequencyBinCount);
  analyser.getByteTimeDomainData(str);
  for (var i = 0; i < str.length; i++) {
    var value = str[i];

    dataarray.push(value);
    console.log(dataarray)
  }//end for loop
}//end function

function onStreamError(e) {
  console.error('Streaming failed: ', e);
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T04:14:48.587

从返回的值`getByteTimeDomainData`是 8 位整数，从 0 到 255。128 是一半，基本上意味着“没有信号”。它相当于从 -1 到 1 的 PCM 音频数据中的 0。

但无论如何 - 有几个问题：

首先，您永远不会将输入连接到分析仪。你需要`input.connect(analyser)`在你打电话之前`analyser.getByteTimeDomainData()`。

第二个问题不在于您的代码，而在于它只是一个实现问题。

基本上，该`gotStream`函数只被调用一次 - 并且`getByteTimeDomainData`只返回 1024 个音频样本的数据（几分之一秒）。问题是，这一切都发生*得如此之快*，而且在创建流之后的*如此短的时间*内，还没有真正的输入。尝试`analyser.getByteTimeDomainData()`在 1000 毫秒内包装呼叫和随后的循环，`setTimeout`然后在您授予浏览器录制权限后立即对着麦克风吹口哨。您应该会看到 128 以外的一些值。

这是一个例子：http: [//jsbin.com/avasav/5/edit](http://jsbin.com/avasav/5/edit)

# ios - 根据 UITableView 调整 UIScrollView 高度

> ID：15798980
> 
> 赞同：5
> 
> 时间：2013-04-03T22:00:31.563
> 
> 标签：ios, objective-c, uitableview, uiscrollview

我有一个 UIScrollView，其中包含一个 UIView 和一个 UITableView。我的目标是调整 UIScrollView 的高度以允许我将 UIScrollView 的内容滚动到特定点。

这是我的观点：它在顶部有一个 UIView，在下面有一个 UITableView。

![在此处输入图像描述](https://i.stack.imgur.com/8DJYu.png)

当我滚动时，我希望 UIView 在特定点停止，如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/B302v.png)

tableView 将能够继续滚动，但 UIView 将被锁定在原地，直到用户向上滚动并将 UIView 带回其原始状态。

我正在尝试做的一个主要示例是 iOS 6 上的 AppStore.app。当您查看应用程序的详细信息时，详细信息、评论和相关的过滤器栏会移动到屏幕顶部并停止。我希望这一切都有意义。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T15:34:15.920

我最终采用了一种更简单的方法。不敢相信我以前没见过这个。我创建了两个视图，一个用于 UITableView 的 tableHeaderView，另一个用于 viewForHeaderInSection。我希望始终保持可见的视图放置在 viewForHeaderInSection 方法中，而另一个视图放置在 tableHeaderView 属性中。我认为这是一种比使用滚动视图更简单的方法。我使用这种方法遇到的唯一问题是这两个视图中的所有 UIView 动画都不再动画。这是我的代码。

```
[self.tableView setTableHeaderView:self.headerView];

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
     return self.tableViewHeader;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T22:28:59.360

将自己添加为`UIScrollViewDelegate`UITableView 并实现，`- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView`以便如果您的视图处于起始位置，它们会执行以下操作：

**- 您将`UITableView`其大小设置为第二个状态：**

```
 [UIView animateWithDuration:.1f animations:^{
      CGRect theFrame = myView.frame;
      theFrame.size.height += floatOfIncreasedHeight;
      myView.frame = theFrame;
    }]; 
```

**- 你的`UIView`动画它的垂直运动**

```
 [UIView animateWithDuration:3 delay:0 options:UIViewAnimationOptionCurveLinear animations:^(void){
        view.center = CGPointMake(view.center.x , view.center.y + floatOfVerticalMovement);
        }completion:^(BOOL Finished){ 
        view.center = CGPointMake(view.center.x , view.center.y - floatOfVerticalMovement);] 
```

最后始终在委托实现中`– scrollViewDidScrollToTop:`，以便您知道可以动画回到初始状态（使用相同的技术反转）。

**更新：**

由于您的视图位于滚动视图内，因此如果您对表格视图在起始位置部分超出范围（即，它只是滚动到视图中而不是更改大小）感到满意，则有一种更简单的方法：

使滚动视图框架大小与最终`tableview`视图 + 初始（整个）视图一样大，并将其放置在 0,0 处（因此其最终部分将隐藏在屏幕之外）

```
scrollview.frame = CGRectMake(0,0,tableview.frame.size.width,tableview.frame.size.height + view.frame.size.height); 
```

您使容器`scrollview`内容与整个表格视图 + 整个视图 + 滚动表格视图时想要的视图数量一样大。

```
scrollview.contentSize = CGSizeMake(scrollview.frame.size.width, tableview.frame.size.height + view.frame.size.height + floatOfViewHeightIWantOutOfTheWay); 
```

您将视图一个接一个地放置在滚动视图中，在表格视图之后留下所有额外的空白空间

```
view.frame = CGRectMake(0,0,view.frame.size.width, view.frame.size.height);

tableview.frame = CGRectMake(0,view.frame.size.height, tableview.frame.size.width, tableview.frame.size.height); 
```

现在它应该可以工作了，因为由于支持`iOS 3`嵌套`scrolling`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:27:08.857

您可以通过正确设置 scrollView 的内容大小并保持 UITableView 的高度小于您的 viewcontroller 的高度来轻松实现这一点，使其适合顶部 UIView 和 UITableView 的底部...

另一种情况是将顶部视图分成两部分。将滚动的部分和将可见的部分。

然后将滚动的部分设置为整个 UITableView 标题，并将保持可见的部分设置为第一个表格部分的标题视图。因此，您可以使用单个 UITableView 来实现这一点，而无需使用 UIScrollView

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T03:33:52.447

您正在寻找的是类似于 Game Center 恰好与它的标题有关的东西，它实际上可以用表格标题、自定义部分标题视图和一些非常聪明的计算来建模，这些计算实际上从不涉及弄乱框架和边界桌子。

首先，最简单的部分：伪造一个粘性视图。该“滚动表格时始终存在的视图”实现为节标题。通过表 1 中的部分数量，并实现`-headerViewForSection:`，可以免费使视图与 tableview 无缝滚动（API 方面）：

```
- (UITableViewHeaderFooterView *)headerViewForSection:(NSInteger)section {
    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0,0,320,50)];
    label.text = @"Info that was always present when scrolling the UITableView";
    label.textAlignment = UITextAlignmentCenter;
    label.backgroundColor = [UIColor colorWithRed:0.243 green:0.250 blue:0.253 alpha:1.000];
    label.textColor = UIColor.whiteColor;
    return label;
} 
```

最后，最难的部分：KVO。当表格滚动时，我们必须保持标题相对于视图框架的顶部保持粘性，这意味着您可以 KVO `contentOffset`，并使用由此产生的值变化来近似视图应该坚持的框架小`MIN()`魔法。假设您的标题是 44 像素高，下面的代码计算适当的帧值：

```
CGPoint offset = [contentOffsetChange CGPointValue];
[self.tableView layoutSubviews];
self.tableView.tableHeaderView.frame = CGRectMake(0,MIN(0,offset.y),CGRectGetWidth(self.scrollView.frame),44); 
```

如果上述方法不可行，[SMHeadedList](https://github.com/stuartjmoore/SMHeadedList)实际上有一个相当出色但鲜为人知的示例，说明实现“双表视图”有多复杂。该实现具有允许“标题”表视图与“主”表视图一起滚动的额外好处。

[对于未来的访问者，我已经实现了一个[更简单的版本](https://github.com/CodaFi/GitPad/blob/master/GitPad/GPScrollingSegmentedControl.m)，尽管它使用 Reactive Cocoa 实现了目标，并且有一点不同的结果。即便如此，我相信这可能是相关的。]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T05:11:32.480

如果你把 UIView 分成顶部和底部怎么办。底部将是信息。在委托方法中
设置 并返回为 Section Header 以使其浮动：`UITableView.tableHeaderView = topView``viewDidLoad`
`bottomView`

```
(UITableViewHeaderFooterView *)headerViewForSection:(NSInteger)section
{
   return bottomView;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-03T15:41:47.243

只需使用 UITableView 就可以解决您的问题。它不需要使用另一个滚动视图。

1.  将您的视图设置为 UITableView 的标题视图。然后将您当前的视图添加到标题视图。
2.  完成`- (void)scrollViewDidScroll:(UIScrollView *)scrollView;`。Tn 检查滚动视图的内容偏移量的功能，并设置当前视图的框架。

# android - 椭圆化 TextView 中 SpannableString 的单行

> ID：15798981
> 
> 赞同：6
> 
> 时间：2013-04-03T22:00:33.980
> 
> 标签：android, textview, ellipsis, spannablestring

我有一个`TextView`存储两行长的地址。这条街在第一行并且是粗体的。城市和州在第二行并且不粗体。如果该行上的单个文本超出，我希望每行的末尾都被省略。我使用 a`SpannableString`来存储地址，因为我希望街道地址加粗，城市和州不加粗。

有没有一种方法可以做到这一点，而不是每行使用两个而不是完全破解`TextViews`？

示例输出：

例如：
123812 Washington A...
Schenectady New York...

例如：
2792 Dantzler Boulev...
查尔斯顿 SC，29406

例如： 佐治亚州亚特兰大
大街 3 号

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-08-23T20:57:29.713

我有同样的问题，并通过创建一个 EllipsizeLineSpan 类来解决它。你可以用它包裹你想要椭圆化的每一行。

用它标记可跨字符串的示例：

```
SpannableStringBuilder textspan = new SpannableStringBuilder("#1.Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\n"+
    "Protect from ellipsizing #2.Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\n"+
    "#3.Lorem ipsum dolor sit amet, consectetur adipisicing elit\n"+
    "#4.Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\n");

// find  ellipsizable text (from '#' to newline)
Pattern pattern = Pattern.compile("#.*\\n", Pattern.CASE_INSENSITIVE);
Matcher matcher = pattern.matcher(textspan);
while(matcher.find()) {
    textspan.setSpan(new EllipsizeLineSpan(), matcher.start(), matcher.end(),   Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
} 
```

椭圆尺寸线跨度：

```
public class EllipsizeLineSpan extends ReplacementSpan implements LineBackgroundSpan {
int layoutLeft = 0;
int layoutRight = 0;

public EllipsizeLineSpan () {
}

@Override
public void drawBackground (Canvas c, Paint p,
                            int left, int right,
                            int top, int baseline, int bottom,
                            CharSequence text, int start, int end,
                            int lnum) {
    Rect clipRect = new Rect();
    c.getClipBounds(clipRect);
    layoutLeft = clipRect.left;
    layoutRight = clipRect.right;
}

@Override
public int getSize (Paint paint, CharSequence text, int start, int end,
                    Paint.FontMetricsInt fm) {
    return layoutRight - layoutLeft;
}

@Override
public void draw (Canvas canvas, CharSequence text, int start, int end,
                  float x, int top, int y, int bottom, Paint paint) {
    float textWidth = paint.measureText(text, start, end);

    if (x + (int) Math.ceil(textWidth) < layoutRight) {  //text fits
        canvas.drawText(text, start, end, x, y, paint);
    } else {
        float ellipsiswid = paint.measureText("\u2026");
        // move 'end' to the ellipsis point
        end = start + paint.breakText(text, start, end, true, layoutRight - x - ellipsiswid, null);
        canvas.drawText(text, start, end, x, y, paint);
        canvas.drawText("\u2026", x + paint.measureText(text, start, end), y, paint);

    }

}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-20T18:24:26.067

DangVarmit 的回答对我帮助很大，但使用一段时间后，我发现有时文本的顶部偏移量随机不正确。这是需要更换的部分：

```
 override fun getSize(paint: Paint, text: CharSequence, start: Int, end: Int, fontMetricsInt: Paint.FontMetricsInt?): Int {
    fontMetricsInt?.let {
        it.top = paint.getFontMetricsInt(it)
    }
    return Math.round(paint.measureText(text, start, start))
} 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-04-03T22:17:21.603

尝试`TextView`在布局中设置椭圆大小，例如：

```
 android:ellipsize="end" 
```

# openssl - 有人可以分享 OpenSSL 示例代码吗？

> ID：15798982
> 
> 赞同：0
> 
> 时间：2013-04-03T22:00:37.260
> 
> 标签：openssl

我一直在搜索并尝试各种建议，但似乎没有一个能正常工作。

为了演示SSL_read()、SSL_write()、SSL_ERROR_WANT_READ和SSL_ERROR_WANT_WRITE的正确编程方法，有没有示例代码可以分享？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T03:46:18.283

以下是使用 SSL 的步骤（用于客户端）

1.  创建套接字并建立 TCP 连接。
2.  创建 SSL_CTX 结构和 BIO *（绑定套接字）
3.  使用 SSL_CTX 创建 SSL 结构
4.  调用 SSL_connect
5.  如果步骤3成功，则继续，否则返回错误
6.  之后调用 SSL_write 和 SSL_read。
7.  关闭连接
8.  清理分配的结构。

对于服务器，您需要使用 SSL_accept。

```
//Step 1
SSL_CTX * sslctx = SSL_CTX_new(SSLv3_client_method);
BIO * sock = BIO_new_socket((int)your_tcp_socket, BIO_NOCLOSE);
//Step 2
SSL * ssl = SSL_new(sslctx);
//Step 3
SSL_connect(ssl);

//for server
SSL_accept(ssl); 
```

# z3 - bv-enable-int2bv-propagation 选项

> ID：15798984
> 
> 赞同：2
> 
> 时间：2013-04-03T22:00:45.403
> 
> 标签：z3

`(set-option :bv-enable-int2bv-propagation true)`在线工作。但是，我的本地版本抱怨它，说：

> （错误“第1行第43列：未知参数'bv_enable_int2bv_propagation'，这是一个旧参数名称，调用'z3 -p'获取新参数列表”）

新的参数名称是什么？我试图在 的输出中找到它`z3 -p`，但我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:03:02.563

我假设您正在使用`unstable`（正在进行中的）分支或夜间构建之一。每晚构建是使用`unstable`分支生成的。此分支包含将在下一个版本 (Z3 v4.3.2) 中可用的修改。[Rise4fun](http://rise4fun.com)正在运行官方版本（即`master`分支）。下一个版本 (v4.3.2) 将包含一个新的参数设置基础结构。这些选项被组织在不同的模块中。而且，我只将最常用的参数移植到了新框架中。我以为没有人在使用参数`:bv-enable-int2bv-propagation`:)

无论如何， [我解决了这个问题](http://z3.codeplex.com/SourceControl/changeset/1c96a7d52f48b42891e5f40fa47e0b38c77a0b2e)。`smt.bv.enable-int2bv`我在`unstable`分支中添加了参数。您现在可以通过重新编译`unstable`分支来获得修复，或者等待修复在夜间构建中可用。该参数`smt.bv.enable-int2bv`也将在下一个正式版本 v4.3.2 中。[以下](http://z3.codeplex.com/wikipage?title=Building%20the%20unstable%20%28working-in-progress%29%20branch&referringTitle=Documentation)是有关如何编译`unstable`分支的说明。

# ms-access - MS Access 联动图片慢显示

> ID：15798988
> 
> 赞同：1
> 
> 时间：2013-04-03T22:00:53.453
> 
> 标签：ms-access, vba

所以我有一个包含大约 10,000 条记录的数据库。这些记录中的每一个都具有存储在共享驱动器上的图像和与记录关联的文件路径。当用户运行报表时，通过将图像控件的`Control Source`属性设置为来显示图像`DLookUp("[tblMasterList].[imagePath]","[tblMasterList]","[txtID]=[tblMasterList].[ID]")`问题是，当滚动报表时，每个图像控件进入查看图像的时间会有延迟。最初我认为这是由于图像是通过网络提取的，但是，我将所有图像复制到我的硬盘驱动器并更新了图像路径，但我仍然遇到了同样的问题。有没有更好的方法来显示图像而不将它们存储在数据库中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:09:57.733

*   压缩并修复您的 Access 数据库。如果您接近 2G 限制，可能会减慢速度。我认为只有 10,000 条记录不是问题，但有时如果数据库使用得相当多，那么仍然可能分配过多的内存。
*   文件路径是使用绝对路径还是相对路径？由于您在本地硬盘驱动器上测试了它们，我怀疑这就是问题所在。
*   tableMasterList 和 txtID 中的 ID 是主键吗？延迟可能在搜索上。

# c# - 如何通过 Wpf c# 中的代码获取特定的样式元素

> ID：15798994
> 
> 赞同：1
> 
> 时间：2013-04-03T22:01:14.303
> 
> 标签：c#, wpf, styles, datatemplate, controltemplate

嗨，我正在尝试在 c# 后面的代码中使用模板项

我正在尝试访问 WindowsFormHost 的 PictureBox。然后将其设置为我想要的。

```
<Style x:Key="ScreenListBox" TargetType="{x:Type ToggleButton}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
        <Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
        <Setter Property="Padding" Value="2,0,0,0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" SnapsToDevicePixels="true" Margin="-0.001,0" Background="#FFABABAB" Width="120" Height="117">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver"/>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="stackPanel">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="textBlock">
                                            <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected"/>
                                <VisualState x:Name="Selected"/>
                                <VisualState x:Name="SelectedUnfocused"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ValidationStates">
                                <VisualState x:Name="Valid"/>
                                <VisualState x:Name="InvalidFocused"/>
                                <VisualState x:Name="InvalidUnfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <StackPanel Orientation="Vertical" Name="TestStackPanel" d:LayoutOverrides="Height">
                            <Grid Margin="3" Height="85" Name="TestGrid" Background="White">
                                <WindowsFormsHost Name="wrapper" Margin="0,0,0,0" Background="{x:Null}">
                                    <Forms:PictureBox Name="Picture"></Forms:PictureBox>
                                </WindowsFormsHost>
                                <StackPanel x:Name="stackPanel" Margin="0" Width="Auto" Opacity="0">
                                    <DockPanel Margin="0" Width="Auto" Height="45">
                                        <Rectangle Fill="#FFD8D8D8" Margin="0" Width="16" HorizontalAlignment="Left"/>
                                        <Rectangle Fill="#FFEBE77A" Margin="0" Width="17" HorizontalAlignment="Left"/>
                                        <Rectangle Fill="#FF60CDE9" Margin="0" Width="16" HorizontalAlignment="Left"/>
                                        <Rectangle Fill="#FF60E98E" Margin="0" Width="16" HorizontalAlignment="Left"/>
                                        <Rectangle Fill="#FFC65F9C" Margin="0" Width="16" HorizontalAlignment="Left"/>
                                        <Rectangle Fill="#FFC43232" Margin="0" Width="17" HorizontalAlignment="Left"/>
                                        <Rectangle Fill="#FF0A37A5" Margin="0" Width="16" HorizontalAlignment="Left"/>
                                    </DockPanel>
                                    <DockPanel HorizontalAlignment="Stretch" Height="5" Width="Auto">
                                        <Rectangle Fill="#FF0A37A5" Margin="0" Width="16" HorizontalAlignment="Left" Height="Auto"/>
                                        <Rectangle Fill="Black" Margin="0" Width="16" HorizontalAlignment="Left" Height="Auto"/>
                                        <Rectangle Fill="#FFC65F9C" Margin="0" Width="17" HorizontalAlignment="Left" Height="Auto"/>
                                        <Rectangle Fill="Black" Margin="0" Width="16" HorizontalAlignment="Left" Height="Auto"/>
                                        <Rectangle Fill="#FF60CDE9" Margin="0" Width="16" HorizontalAlignment="Left" Height="Auto"/>
                                        <Rectangle Fill="Black" Margin="0" Width="16" HorizontalAlignment="Left" Height="Auto"/>
                                        <Rectangle Fill="#FFD8D8D8" Margin="0" Width="17" HorizontalAlignment="Left" Height="Auto"/>
                                    </DockPanel>
                                    <DockPanel HorizontalAlignment="Stretch" Height="15" VerticalAlignment="Bottom">
                                        <TextBlock x:Name="textBlock" TextWrapping="Wrap" Opacity="0" FontWeight="Bold" Width="60" TextAlignment="Center" FontSize="9.333"/>
                                    </DockPanel>

                                </StackPanel>

                            </Grid>
                            <Grid Margin="5,0" Height="20" VerticalAlignment="Bottom">
                                <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Bottom" Margin="15,0" HorizontalAlignment="Center">
                                    <ContentPresenter.Resources>
                                        <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource WrappingStyle}"/>
                                    </ContentPresenter.Resources>
                                </ContentPresenter>
                                <Button Content="Button" Margin="0" VerticalAlignment="Top" HorizontalAlignment="Right" Style="{DynamicResource Edit}"/>
                                <Path x:Name="path" Data="F1M29.2007,72.9482L25.9947,75.2372L25.9947,73.7922L18.5627,73.7922L18.5627,78.9302L25.9947,78.9302L25.9947,77.4862L29.2007,79.7752z" Fill="#FF231F20" Height="9.327" Stretch="Fill" Width="14.534" HorizontalAlignment="Left" Margin="0" VerticalAlignment="Top" Opacity="0"/>
                                <Rectangle x:Name="rectangle" Fill="#FF231F20" Margin="0" Width="20" Height="20" Opacity="0" VerticalAlignment="Top" d:LayoutOverrides="Width, Height, VerticalMargin" HorizontalAlignment="Left"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="true">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                            <Setter Property="Opacity" TargetName="path" Value="1"/>
                            <Setter Property="Background" TargetName="Bd" Value="#FF26A1E5"/>
                        </Trigger>
                        <Trigger Property="Selector.IsSelected" Value="False"/>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

每当我在 C# 中使用这种风格时，我都会：

```
var listboxitem = new ToggleButton();

listboxitem.Style = (Style)FindResource("ScreenListBox");

VideoListBox.Items.Add(listboxitem); 
```

//这里我希望能够使用ScreenListBox中的PictureBox。

将其传递给另一个函数。

我一直在尝试使用 Template.FindName，但没有成功。

任何人都可以看看并尝试将我带入正确的方向。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T23:13:24.177

嗨，我想实现这一点的唯一一种方法是创建一个自定义控件，您可以从 ToggleButton 继承该控件。您应该在某个地方为您的控件定义控件模板（如 generic.xaml 或 App.xaml）。在您的自定义控件中，您应该覆盖 OnApplyTemplate 方法，您可以在其中使用 FindName 方法至少访问 WindowsFormsHost（但也可能访问 PictureBox）。

您也可以尝试使用您的代码，在您尝试访问 PictureBox 之前 - 尝试调用 ApplyTemplate，也许这会强制 ToggleButton 加载所有内容并让您访问它的子项。

# java - 以日期或原语为参数的 Jersey Web 服务

> ID：15798995
> 
> 赞同：1
> 
> 时间：2013-04-03T22:01:20.260
> 
> 标签：java, jersey, jackson

我有一个球衣网络服务，它接受发布数据并将其（使用杰克逊）映射到一个看起来像的数据结构

```
public class MyObject {   
   String name
   Object dateOrPrimitive    
} 
```

在调用 Web 服务的 javascript 客户端上，它可以发送一个可以采用以下任一形式的对象

```
{ name : "Jeff", dateOrPrimitive : "someOtherString" } 
{ name : "Jeff", dateOrPrimitive : new Date() } 
```

如果`dateOrPrimitive`字段中有日期，则将其反序列化为日期的字符串表示形式。但是我想做的是将它反序列化为一个日期，如果它是一个有效的日期字符串。

我编写了一个自定义反序列化器，它检查值是否是有效日期，如果是则返回日期，否则返回原语，但我想知道是否已经有内置的方法来执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T14:36:49.837

不，杰克逊没有这样的东西。您的自定义反序列化器是解决此问题的方法。Personnaly 我会有两个不同的属性，一个是 Date，另一个是原语，但我猜你无法控制 Json 的格式。

# jenkins - 从 jenkins 服务器在远程 windows vm 上部署和启动 webdriver 测试程序

> ID：15798996
> 
> 赞同：0
> 
> 时间：2013-04-03T22:01:25.840
> 
> 标签：jenkins

我有一个 Java 测试程序，用于使用 webdriver 测试 Web 应用程序。它在我的本地机器上构建并运行得很好。

现在，我需要在 jenkins 中构建它，然后在 Windows 上运行的 VM 上部署和运行它（例如 server 2008 R2）。

显然，测试程序在 jenkins 上不起作用，因为它需要打开浏览器。这不能在 Jenkins 服务器的系统帐户下完成。所以我需要将它部署到远程机器上并以某种方式开始测试。

我听说这可以在 linux 机器上使用 ssh 来完成，但不知道如何为 windows VM 做这件事。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-02T10:05:23.657

如果您已将 jenkins 安装为服务，那么您需要创建一个 JNLP 节点才能运行您的 webdriver 测试。

按照帖子创建 JNLP 节点并在其上运行测试。
[http://qtp-help.blogspot.in/2013/09/setup-webdriver-maven-project-on-jenkins.html](http://qtp-help.blogspot.in/2013/09/setup-webdriver-maven-project-on-jenkins.html)

# ios - 使用 iOS 版 Firebase 验证电子邮件

> ID：15798998
> 
> 赞同：0
> 
> 时间：2013-04-03T22:01:38.093
> 
> 标签：ios, email-validation, firebase

提交创建新用户的请求时，如果用户尝试使用无效电子邮件提交，则应用程序崩溃（IE 没有@符号）。有没有办法通过 Firebase 检查电子邮件是否有效，或者我需要验证应用程序端吗？

我在控制台中得到的错误是：

***由于未捕获的异常“InvalidEmail”而终止应用程序，原因：“jfkdsla;fjdk 是无效的电子邮件地址”

```
NSString *url = [NSString stringWithFormat:@"https://myapp.firebaseio.com/users/%@", displayName.text];
    Firebase *dataRef = [[Firebase alloc] initWithUrl:url];
    [dataRef observeEventType:FEventTypeValue withBlock:^(FDataSnapshot *snapshot) {

        NSLog(@"Ref %@", snapshot.value);
        snapshotValue = snapshot.value;
    }];

    if (snapshotValue == NULL) {
        AppDelegate *appDelegate= (AppDelegate *)[[UIApplication sharedApplication] delegate];

        [appDelegate.authClient createUserWithEmail:email.text password:password.text andCompletionBlock:^(NSError* error, FAUser*user) {

            if (error != nil) {
                // Error
                NSLog(@"ERROR CODE: %d",error.code);
                NSLog(@"ERROR: %@",error);

                if (error.code == -9999) {

                    email.textColor = [UIColor redColor];

                }

            } else {

                NSLog(@"Created %@",user.userId);
                Firebase *userRef = [[Firebase alloc] initWithUrl:[NSString stringWithFormat:@"https://myapp.firebaseio.com/users/%@",displayName.text]];
                [[userRef childByAppendingPath:@"name"] setValue:fullName.text];
                [[userRef childByAppendingPath:@"user_id"] setValue:user.userId];

                Firebase *userCredentials = [[Firebase alloc] initWithUrl:[NSString stringWithFormat:@"https://myapp.firebaseio.com/users/%@/credentials",displayName.text]];
                [[userCredentials childByAppendingPath:@"email"] setValue:email.text];
                [[userCredentials childByAppendingPath:@"password"] setValue:password.text];

                AppDelegate *appDelegate= (AppDelegate *)[[UIApplication sharedApplication] delegate];

                [appDelegate.authClient loginWithEmail:email.text andPassword:password.text
                                   withCompletionBlock:^(NSError* error, FAUser* user) {

                                       if (error != nil) {
                                           NSLog(@"There was an error logging in to this account: %@",error);

                                       } else {
                                           NSLog(@"logged in");
                                           [self dismissViewControllerAnimated:NO completion:nil];

                                           [appDelegate.window.rootViewController presentViewController:appDelegate.tabBarController animated:YES completion:nil];

                                       }
                                   }];                    

            }

        }];

    }
    else {

        displayName.textColor = [UIColor redColor];

    }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T22:17:02.140

由于正在抛出异常，因此将“ `createUserWithEmail`”行代码放入“ `@try{} / @catch{}`”块中：

```
@try {
    [appDelegate.authClient createUserWithEmail:email.text password:password.text andCompletionBlock:^(NSError* error, FAUser*user) {
        ...
        ...
        // keep that big huge block part intact
        ...
        ...
    }
}
@catch (NSException * e) {
        NSLog(@"Exception: %@", e);
    }
} 
```