# StackOverflow 问答 16214000-16214999

# apache - apache配置中的CNAME地址

> ID：16214004
> 
> 赞同：0
> 
> 时间：2013-04-25T11:52:20.220
> 
> 标签：apache

我有多个域来映射我的服务器的子域。例如

```
www.xyz.com -> goo.myserverdomain.com
www.lmn.com -> fb.myserverdomain.com
www.abc.com -> twt.myserverdomain.com 
```

我在每个域中使用 CNAME 进行映射。现在在我的服务器端，我想解析我的服务器子域。所以我想像这样配置

```
ServerName myserverdomain.com
ServerAlias *.myserverdomain.com
ProxyPass / http://<IP>:8780/(goo/fb/twt ...) 
```

当我进行配置时，apache 无法识别虚拟主机并显示第一个默认主机。我似乎正在获取主机名。如何在我的配置中解析 myserverdomain 地址。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:01:51.300

域映射如何完成并不重要。Apache 不知道这一点，Web 浏览器也不在乎。它只是对发送标题的“主机：”行做出反应。

要启用虚拟名称解析，您需要设置

```
NameVirtualHost ... 
```

对于每个 IP + 端口组合或全部使用“*”。

通常在启动时，Apache 会告诉你有虚拟主机，但没有正确的名称切换。

# soap - 在 ADF mobile 中调用 SAOP 请求

> ID：16214010
> 
> 赞同：2
> 
> 时间：2013-04-25T11:52:51.113
> 
> 标签：soap, oracle-adf

我想使用 ADF 移动调用 SOAP 请求。我的要求是：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"><soap:Header><wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" soap:mustUnderstand="1"><wsse:UsernameToken xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"><wsse:Username>INDIA</wsse:Username><wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">welcome</wsse:Password></wsse:UsernameToken></wsse:Security></soap:Header>
    <soap:Body xmlns:ns1="http://xmlns.oracle.com/bpel/mobile/Notificationlist">
        <ns1:NotificationlistRetrievalREQ>
            <ns1:NotificationlistType>HR_OFFER</ns1:NotificationlistType>
            <ns1:Status>TODO</ns1:Status>
            <ns1:Mode/>
        </ns1:NotificationlistRetrievalREQ>
    </soap:Body>
</soap:Envelope> 
```

因此，我调用了没有安全标头的简单 SOAP 服务。但我不知道如何在 ADF 移动设备中传递安全标头。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T22:33:06.243

如果您使用 Web 服务数据控件并将其配置为通过安全身份验证，则您不需要手动弄乱标头。请参阅： [https ://blogs.oracle.com/shay/entry/accessing_secure_web_services_from](https://blogs.oracle.com/shay/entry/accessing_secure_web_services_from)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-01T14:46:32.123

您可以尝试创建一个扩展 SOAPProvider 类的 Provider 类并在其中实现 getAdditionalSoapHeaders 方法。在此方法中设置各种标头并修改 DataControls.dcx 文件以指向您的 Provider 类。我在[这里的博客文章中解释了一个这样的用例。](http://stick2code.blogspot.in/2014/07/passing-custom-soap-headers-in-adf.html)

# c++ - C2106 简单数学程序中的错误

> ID：16214013
> 
> 赞同：-6
> 
> 时间：2013-04-25T11:52:52.673
> 
> 标签：c++, math

```
#include <tchar.h>
#include <stdio.h>
#include <iostream>
using namespace std;

int main()
{
    int a = (1024^3)-(639^3)-(385^3);
    short max = 0;
    cout<< " Prints 0 if no answer." << endl;

    for(int iii = 100; iii < 1000; iii++)
    {
        if(a % iii = 0)
        {
            max = iii;
        }
    }
    cout<< " " << max;

    cin.clear(); cin.ignore(); cin.get();
    return 0;
} 
```

只是想写一个简单的程序，这样我就不必计算了，编译器在第 14 行返回 C2106 错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T11:56:07.770

```
if (a % iii = 0) 
```

这是一个无效的分配。如果您要进行比较，请使用比较运算符`==`。

```
if (a % iii == 0) 
```

此外，`^`在 C++ 中没有进行幂运算。这实际上是按位运算`xor`符。要进行指数运算，请`std::pow`从`<cmath>`标题中使用。

```
#include <cmath>

int main()
{
    int a = std::pow(1024, 3) - std::pow(639, 3) - std::pow(385, 3);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T11:54:40.913

应该是 == 用于比较

```
 if((a % iii) == 0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T11:54:50.150

您正在使用赋值运算符`=`而不是相等运算符`==`：

```
if(a % iii = 0) 
```

这应该是：

```
if( a % iii == 0) 
```

的结果`a % iii`是一个临时的，并且在您尝试分配`0`给该临时的原始代码中。除了该错误之外，您似乎还试图在这里通过幂来提高一些数字：

```
int a = (1024^3)-(639^3)-(385^3); 
```

运算符`^`实际上是按位`xor`您需要的是[`pow`](http://www.cplusplus.com/reference/cmath/pow/)来自`cmath`标题：

```
int a = std::pow(1024,3)-std::pow(639,3)-std::pow(385,3); 
```

我也会避免[`using namespace std`](https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-a-bad-practice-in-c)。

# zend-framework - 如何通过字符串查询 php 创建 Zend_Db_Table_Select

> ID：16214018
> 
> 赞同：1
> 
> 时间：2013-04-25T11:53:17.877
> 
> 标签：zend-framework, zend-db-table

我一直在看，是否有任何方法可以使用文字 sql 查询创建 Zend_Db_Table_Select 或 Zend_Db_Select 实例。我的意思是，我有一个复杂的查询，我想通过这个查询创建一个对象。我一直在阅读此类的文档，但没有找到任何东西。我想这是不可能的。

你知道吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:57:18.500

我认为你最好的选择是在你的模型中写这个：

```
public function customQuery ($table, $id) {
    return $this
        ->getDefaultAdapter()
        ->query("SELECT * FROM ? WHERE id = ?",
            array($table,$id)
        )
        ->fetchAll()
    ;
} 
```

还有一个[链接](http://framework.zend.com/manual/1.12/en/zend.db.statement.html)对您非常有用

# android - 由于在所有可绘制文件夹 android 中添加图像，apk 大小太大

> ID：16214020
> 
> 赞同：3
> 
> 时间：2013-04-25T11:53:21.773
> 
> 标签：android, android-drawable

在我的应用程序中，有很多图像，不仅是小按钮背景图像，而且在我的应用程序中也是全屏大小的图像。由于在所有 4 个可绘制文件夹中添加了所有不同大小的图像，应用程序的大小比预期的增加了 18MB，只是由于图像。有什么最好的方法来优化它，注意不要在任何屏幕尺寸下拉伸任何图像？我知道 9 个补丁图像，但是如何使用全屏大小的图像作为 9 个补丁图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:31:39.773

最好为每种分辨率设置单独的 APK。看看[多 APK 支持](http://developer.android.com/google/play/publishing/multiple-apks.html)：

> 例如，您可以提供一个支持小尺寸和普通尺寸屏幕的 APK，以及另一个支持大屏幕和超大屏幕的 APK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:11:01.380

9patches 通常用于渐变和背景。如果您使用的图像中包含一些信息或图片，则无法切换到 9.patch 图像。如果您使用 9patches，您只需要一个可绘制的图像。您可以通过将 xml drawables 用于按钮等来进一步优化您的应用程序。

# java - Onclick 监听器到可展开的列表视图

> ID：16214021
> 
> 赞同：2
> 
> 时间：2013-04-25T11:53:23.117
> 
> 标签：java, android, onclick, expandablelistview

我创建了一个可扩展的列表视图，但无法附加到子列表项的 onclick 侦听器。

**活动代码**：

 **```
 public class MyActivity extends Activity {

        private ExpandableListView mExpandableList;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

            mExpandableList = (ExpandableListView)findViewById(R.id.expandable_list);

            ArrayList<Parent> arrayParents = new ArrayList<Parent>();
            ArrayList<String> arrayChildren = new ArrayList<String>();

            //here we set the parents and the children
            for (int i = 0; i < 2; i++){
                //for each "i" create a new Parent object to set the title and the children
                Parent parent = new Parent();
                parent.setTitle("Parent " + i);

                arrayChildren = new ArrayList<String>();
                for (int j = 0; j < 3; j++) {
                    arrayChildren.add("Child " + j);
                }
                parent.setArrayChildren(arrayChildren);

                //in this array we add the Parent object. We will use the arrayParents at the setAdapter
                arrayParents.add(parent);
            }

            //sets the adapter that provides data to the list.
            mExpandableList.setAdapter(new MyCustomAdapter(MyActivity.this,arrayParents));

        }

    } 
```

列表的**自定义适配器**：

```
public class MyCustomAdapter extends BaseExpandableListAdapter {

    private LayoutInflater inflater;
    private ArrayList<Parent> mParent;

    public MyCustomAdapter(Context context, ArrayList<Parent> parent){
        mParent = parent;
        inflater = LayoutInflater.from(context);
    }

    @Override
    //counts the number of group/parent items so the list knows how many times calls getGroupView() method
    public int getGroupCount() {
        return mParent.size();
    }

    @Override
    //counts the number of children items so the list knows how many times calls getChildView() method
    public int getChildrenCount(int i) {
        return mParent.get(i).getArrayChildren().size();
    }

    @Override
    //gets the title of each parent/group
    public Object getGroup(int i) {
        return mParent.get(i).getTitle();
    }

    @Override
    //gets the name of each item
    public Object getChild(int i, int i1) {
        return mParent.get(i).getArrayChildren().get(i1);
    }

    @Override
    public long getGroupId(int i) {
        return i;
    }

    @Override
    public long getChildId(int i, int i1) {
        return i1;
    }

    @Override
    public boolean hasStableIds() {
        return true;
    }

    @Override
    //in this method you must set the text to see the parent/group on the list
    public View getGroupView(int i, boolean b, View view, ViewGroup viewGroup) {

        if (view == null) {
            view = inflater.inflate(R.layout.list_item_parent, viewGroup,false);
        }

        TextView textView = (TextView) view.findViewById(R.id.list_item_text_view);
        //"i" is the position of the parent/group in the list
        textView.setText(getGroup(i).toString());

        //return the entire view
        return view;
    }

    @Override
    //in this method you must set the text to see the children on the list
    public View getChildView(int i, int i1, boolean b, View view, ViewGroup viewGroup) {
        if (view == null) {
            view = inflater.inflate(R.layout.list_item_child, viewGroup,false);
        }

        TextView textView = (TextView) view.findViewById(R.id.list_item_text_child);
        //"i" is the position of the parent/group in the list and 
        //"i1" is the position of the child
        textView.setText(mParent.get(i).getArrayChildren().get(i1));

        //return the entire view
        return view;
    }

    @Override
    public boolean isChildSelectable(int i, int i1) {
        return true;
    }

    @Override
    public void registerDataSetObserver(DataSetObserver observer) {
        /* used to make the notifyDataSetChanged() method work */
        super.registerDataSetObserver(observer);
    }
} 
```

**父**类：

```
public class Parent {
    private String mTitle;
    private ArrayList<String> mArrayChildren;

    public String getTitle() {
        return mTitle;
    }

    public void setTitle(String mTitle) {
        this.mTitle = mTitle;
    }

    public ArrayList<String> getArrayChildren() {
        return mArrayChildren;
    }

    public void setArrayChildren(ArrayList<String> mArrayChildren) {
        this.mArrayChildren = mArrayChildren;
    }

} 
```

**我应该怎么做才能将 onclick 侦听器添加到子列表项？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-25T12:07:06.670

> **在可扩展列表的 setAdapter 之后添加此内容**

```
mExpandableList.setOnChildClickListener(new OnChildClickListener() {

   @Override
   public boolean onChildClick(ExpandableListView parent, View v,int groupPosition, int childPosition, long id) {

      /* You must make use of the View v, find the view by id and extract the text as below*/

      TextView tv= (TextView) v.findViewById(R.id.childTextView);

      String data= tv.getText().toString();                 

      return true;  // i missed this
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T11:57:02.273

您需要添加

> 子点击监听器

像这样：`mExpandableList.setOnChildClickListener` 将此行添加到[在此处读取](http://developer.android.com/reference/android/widget/ExpandableListView.html#setOnChildClickListener%28android.widget.ExpandableListView.OnChildClickListener%29)`onCreate`的方法 中

这也是[一个很好的例子](http://www.mysamplecode.com/2012/10/android-expandablelistview-example.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-09T18:41:38.467

使用覆盖的 onChildClick 声明您的 listView

```
ExpandableListView listView = getExpandableListView();
listView.setChoiceMode(ExpandableListView.CHOICE_MODE_SINGLE);
listView.setOnChildClickListener(new ExpandableListView.OnChildClickListener() {
        @Override
        public boolean onChildClick(ExpandableListView parent, View v,int groupPosition, int childPosition,long id) {
            Log.d(TAG,"I got clicked childPosition:["+childPosition+"] groupPosition:["+groupPosition+"] id:["+id+"]");
            return true;
        }
}); 
```**

# c# - 如何以编程方式更改文件夹审核选项下的“适用于”字段 (.NET)

> ID：16214024
> 
> 赞同：4
> 
> 时间：2013-04-25T11:53:39.113
> 
> 标签：c#, .net, windows, auditing

我正在尝试以编程方式设置文件夹审核选项下的“适用于”字段。在 MSDN 中，[代码示例使用 FileSystemAuditRule 类](http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.filesystemauditrule.aspx)向文件夹添加新的审核规则。在这个类中没有什么明显的设置需要应用特定的审计规则。

这是我用来设置一些权限的代码：

```
const string myFolder = @"S:\Temp\SomeFolderToAudit";

var account = new SecurityIdentifier(WellKnownSidType.WorldSid, null).Translate(typeof(NTAccount));

FileSecurity fSecurity = File.GetAccessControl(myFolder, AccessControlSections.Audit);

fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, AuditFlags.Success));

File.SetAccessControl(myFolder, fSecurity); 
```

这很好地创建了审计规则，除了下面突出显示的选项： ![适用于未设置的选项](https://i.stack.imgur.com/VOxcg.png)

例如，我需要将其设为“*此文件夹、子文件夹和文件”或“**仅此文件夹*”以外的任何内容。我不想遍历所有目录和文件并对它们设置相同的审核规则。我也不想尝试管理继承，规则将受到保护。我只需要一种方法来设置此选项，最好使用托管代码（如果这是唯一方法，欢迎使用 P/Invokes）。

提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-04T08:56:18.360

经过一番摆弄后，我设法找出了如何设置“适用于”字段。创建审计规则对象时，您需要结合使用 InheritanceFlags 和 PropagationFlags。

这是示例代码（基于问题示例），它向您展示了标志的组合以及它们对“适用于”字段的结果：

```
// This folder only (default)
fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, InheritanceFlags.None, PropagationFlags.None, AuditFlags.Success));
// This folder and subfolders
fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, InheritanceFlags.ContainerInherit, PropagationFlags.None, AuditFlags.Success));
// This folder and files
fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, InheritanceFlags.ObjectInherit, PropagationFlags.None, AuditFlags.Success));
// This folder, subfolders and files
fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit, PropagationFlags.None, AuditFlags.Success));
// Subfolders only
fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, InheritanceFlags.ContainerInherit, PropagationFlags.InheritOnly, AuditFlags.Success));
// Files only
fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, InheritanceFlags.ObjectInherit, PropagationFlags.InheritOnly, AuditFlags.Success));
// Subfolders and files only
fSecurity.AddAuditRule(new FileSystemAuditRule(account, FileSystemRights.WriteData | FileSystemRights.Delete | FileSystemRights.ChangePermissions, InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit, PropagationFlags.InheritOnly, AuditFlags.Success)); 
```

[可以在Michael Taylor 的这个非常有用的页面](http://msmvps.com/blogs/p3net/pages/access-control-in-net.aspx)上找到这些信息以及更多关于访问控制的信息。

# android - 如何在第二个java文件中显示吐司？

> ID：16214028
> 
> 赞同：1
> 
> 时间：2013-04-25T11:53:51.017
> 
> 标签：android, database-connection, toast

我已经阅读这个论坛好几天了，但我没有找到我的问题的答案。

我在尝试显示 Toast 时遇到 java.lang.NullPointerException 问题。

在我的 android 应用程序中，我有 MyWorkActivity.java 这是主要活动，而 Statistika.java 旨在根据我的数据库中的数据计算一些统计数据。

在 MyWorkActivity 类（公共类 MyWorkActivity 扩展 Activity 实现 OnClickListener）中，我有菜单项 statistika。

当我按下该项目时，我想使用来自 statistika.java 的数据显示布局 Statistika.xml，如下所示：

```
public class MyWorkActivity extends Activity implements OnClickListener 
{
    //Menu item statistika
    else if(item.getItemId()==R.id.statistika)
    {
        //Layout statistika.xml
         setContentView(R.layout.statistika);

         Statistika nova_statistika = new Statistika();
         nova_statistika.rsatiDanasJuceMjesec(sDatumZaPrikaz);
    }
} 
```

但是我一直在收到 java.lang.NullPointerException，`dbJuceDanas = this.openOrCreateDatabase(DatabaseInfo.IME_BAZE, MODE_PRIVATE,null);`所以我评论了数据库部分并只尝试了 Toast，但我仍然收到 java.lang.NullPointerException。

这是我的 Statistika.java：

```
public class Statistika extends Activity
{
 public void rsatiDanasJuceMjesec (String sDatumZaRacunanje)
   {
      Toast.makeText(getBaseContext(), "Toast is working! ", Toast.LENGTH_LONG).show();

    //Računanje radnih sati za prikazani dan
//      SQLiteDatabase dbJuceDanas = null;
//      dbJuceDanas = this.openOrCreateDatabase(DatabaseInfo.IME_BAZE, MODE_PRIVATE,null);
//          
//      //Filtriranje rekordseta po datumu
//      Cursor cJuceDanas = dbJuceDanas.rawQuery("SELECT * FROM " + DatabaseInfo.IME_TABELE + " WHERE " + DatabaseInfo.DATUM + " LIKE '%" + MyWorkActivity.sDatumZaPrikaz + "'", null);
//      
//      if (cJuceDanas !=null && cJuceDanas.getCount() > 0) 
//      {
//          //Ako postoje upisi za datum trenutnog upisa
//          int Column4 = cJuceDanas.getColumnIndex("r_vrijeme");
//
//          //Sumiranje svih radnih vremena od danas
//          fRVDanas=Float.valueOf(0);
//          do 
//          {
//              cJuceDanas.moveToFirst();
//              fRVDanas=fRVDanas+cJuceDanas.getFloat(Column4);
//          
//          }while (cJuceDanas.moveToNext());
//      }
    }
} 
```

这是 LogCat：

```
04-25 12:33:15.020: E/AndroidRuntime(927): FATAL EXCEPTION: main
04-25 12:33:15.020: E/AndroidRuntime(927): java.lang.NullPointerException
04-25 12:33:15.020: E/AndroidRuntime(927):  at android.content.ContextWrapper.getResources(ContextWrapper.java:80)
04-25 12:33:15.020: E/AndroidRuntime(927):  at android.widget.Toast.<init>(Toast.java:89)
04-25 12:33:15.020: E/AndroidRuntime(927):  at android.widget.Toast.makeText(Toast.java:231)
04-25 12:33:15.020: E/AndroidRuntime(927):  at myWork.amicus.ba.Statistika.rsatiDanasJuceMjesec(Statistika.java:69)
04-25 12:33:15.020: E/AndroidRuntime(927):  at myWork.amicus.ba.MyWorkActivity.onOptionsItemSelected(MyWorkActivity.java:3028)
04-25 12:33:15.020: E/AndroidRuntime(927):  at android.app.Activity.onMenuItemSelected(Activity.java:2205)
04-25 12:33:15.020: E/AndroidRuntime(927):  at com.android.internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:748) 
```

我试过以下：

```
Toast.makeText(this, "Toast is working! ", Toast.LENGTH_LONG).show();

Toast.makeText(Statistika.this, "Toast is working! ", Toast.LENGTH_LONG).show(); 
```

和许多其他组合，但它不起作用。

据我所知，问题在于上下文。

我需要做什么才能显示 Toast 消息并从 Statistika.java 访问数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:25:12.730

```
Try this code

public class MyWorkActivity extends Activity implements OnClickListener 
{
    //Menu item statistika
    else if(item.getItemId()==R.id.statistika)
    {
        //Layout statistika.xml
         setContentView(R.layout.statistika);

         Statistika nova_statistika = new Statistika(MyWorkActivity.this);
         nova_statistika.rsatiDanasJuceMjesec(sDatumZaPrikaz);
    }
}

public class Statistika extends Activity
{

Context context;

    public Statistika(MyWorkActivity mainActivity) {
        // TODO Auto-generated constructor stub

        context = mainActivity;
    }

 public void rsatiDanasJuceMjesec (String sDatumZaRacunanje)
   {
      Toast.makeText(context, "Toast is working! ", Toast.LENGTH_LONG).show();
}

} 
```

# ruby-on-rails - Webservice POST未在rails 2.3.8中使用rest客户端显示请求的参数

> ID：16214038
> 
> 赞同：0
> 
> 时间：2013-04-25T11:54:16.950
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-2

我的 POST 网络服务的标头设置为 Accept application/json 和 content-type application/json。以下是请求的参数：

```
 { 
  "OccupantID": 162921,
  "BuildingID": 13294,
  "QuizID": 397,
  "Score": 3,
  "Result": "fail"
 } 
```

路线.rb

```
 map.connect '', :controller => 'quiz_v2', :action => 'record_quiz_result', :conditions => { :method => :post } 
```

当我尝试查看控制器操作中的参数时

```
 def record_quiz_result
   p params
  end
 It returned just controller_name and action_name 
```

我不知道这里发生了什么，可能是我错过了什么。任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:10:30.313

```
Goto Headers => Custom Header 
```

1.Content-Type 作为名称，application/x-www-form-urlencoded 作为值并保存。

2.现在在正文中输入你的参数，这些参数应该可以通过rails中的参数哈希访问和访问

希望能帮助到你

# java - 插入到语法错误？访问权限

> ID：16214045
> 
> 赞同：2
> 
> 时间：2013-04-25T11:54:40.533
> 
> 标签：java, sql, ms-access-2010

我正在尝试将用户输入到 jtextfield 中的数据插入到 msaccess 数据库中。当我尝试执行我的 sql 语句时，我收到一条错误，指出 INSERT INTO 语句中的语法错误。我检查了我的 sql 语句并尝试了一些不同的方法，但似乎找不到任何类型的语法错误。

```
 conn = Connect.ConnectDB();
    String sql = "insert into Team ("
            +"TeamID,"
            +"TeamCity,"
            +"TeamMascot,"
            + "values("+txtid.getText()+ ",'"+txtname.getText()+"','"+txtaddress.getText()+"')" ;
    try{
        pst = conn.prepareStatement(sql);
        pst.execute();
        JOptionPane.showMessageDialog(null, "Entry " + txtid.getText() + " Saved");
        UpdateJTable();
        //conn.close();
    }
    catch(Exception e){
        JOptionPane.showMessageDialog(null, e);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T11:56:41.030

错误是**关键字之前的额外逗号和没有右括号`values`**

```
String sql = "insert into Team ("
            +"TeamID,"
            +"TeamCity,"
            +"TeamMascot,"    // <<== HERE, change comma into closing parenthesis 
```

顺便说一句，您的陈述很容易受到`SQL Injection`. 如果参数化了值，则可以避免它。例如，

```
String sql = "insert into Team (TeamID,TeamCity,TeamMascot) values (?, ?, ?, ?)"
pst = conn.prepareStatement(sql);
pst.setString(1, txtid.getText());
pst.setString(2, txtname.getText());
pst.setString(3, txtaddress.getText()); 
```

*   [准备好的语句](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/PreparedStatement.html)

# java - FusionCharts：X 轴值与预期不符

> ID：16214046
> 
> 赞同：0
> 
> 时间：2013-04-25T11:54:40.690
> 
> 标签：java, xml, charts, fusioncharts

我正在使用 FusionCharts，但我遇到了一些问题。在下面的快照中，我在 X 轴上的索引不是 0 处得到 0（我将其标记为红色）。

另一个问题是没有画线？

这是我得到的数字： ![在此处输入图像描述](https://i.stack.imgur.com/FcLjD.png)

这是我的 XML 代码：

```
 <chart caption="" xaxisname="Quantity (finished items)" yaxisname="Cost" numdivlines="9" lineThickness="2" showvalues="0" showLegend="1" canvasPadding="0" legendIconScale="1.4" numVisiblePlot="15">
<categories>
<category  x="0" label="0"/>
<category  x="5000" label="5000"/>
<category  x="10000" label="10000"/>
<category  x="15000" label="15000"/>
<category  x="20000" label="20000"/>
<category  x="25000" label="25000"/>
<category  x="30000" label="30000"/>
<category  x="35000" label="35000"/>
<category  x="40000" label="40000"/>
<category  x="45000" label="45000"/>
<category  x="50000" label="50000"/>
<category  x="55000" label="55000"/>
<category  x="60000" label="60000"/>
<category  x="65000" label="65000"/>
<category  x="70000" label="70000"/>
</categories>
<dataset seriesName="Flow Name" drawLine="1 " anchorSides="20" anchorRadius="5">
<set x="0" y="169.13"/>
<set x="5000" y="9046.95"/>
<set x="10000" y="17924.78"/>
<set x="15000" y="26802.6"/>
<set x="20000" y="35680.42"/>
<set x="25000" y="44558.25"/>
<set x="30000" y="53436.07"/>
<set x="35000" y="62313.9"/>
<set x="40000" y="71191.72"/>
<set x="45000" y="80069.54"/>
<set x="50000" y="88947.38"/>
<set x="55000" y="97825.2"/>
<set x="60000" y="106703.02"/>
<set x="65000" y="115580.84"/>
<set x="70000" y="124458.66"/>
</dataset>
<dataset seriesName="B1" drawLine="1 " anchorSides="3" anchorRadius="5">
<set x="0" y="123.16"/>
<set x="5000" y="271.37"/>
<set x="10000" y="419.59"/>
<set x="15000" y="567.8"/>
<set x="20000" y="716.02"/>
<set x="25000" y="864.23"/>
<set x="30000" y="1012.45"/>
<set x="35000" y="1160.66"/>
<set x="40000" y="1308.88"/>
<set x="45000" y="1457.09"/>
<set x="50000" y="1605.31"/>
<set x="55000" y="1753.52"/>
<set x="60000" y="1901.73"/>
<set x="65000" y="2049.95"/>
<set x="70000" y="2198.16"/>
</dataset>
</chart> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T10:36:45.817

您选择的似乎`chartType`不是`Scatter`（从屏幕截图推断，它是`MSColumn2D`或其他一些多系列柱形图）。无论您在代码中的哪个位置`new FusionCharts(/*...*/);`，尝试将图表类型更改为`Scatter`. 请参阅[解释如何更改图表类型的 FusionCharts 文档链接](http://docs.fusioncharts.com/charts/contents/FirstChart/ChangeChart.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T14:15:15.943

您能否尝试在 XML的元素中将“ **canvasPadding** ”属性设置为**“0”**`<chart>`，看看是否有帮助？

# python - 检查列表是否包含相同的元素

> ID：16214053
> 
> 赞同：-2
> 
> 时间：2013-04-25T11:54:54.427
> 
> 标签：python, list

我有一个清单

```
List1 = [(12,34),(12,6),(2,4),(1,3),(34,32),(34,6)] 
```

和另一个清单

```
List2 = [(12,34),(12,6),(2,4),(1,3),(34,32),(56,12),(78,23),(23,56)] 
```

我想创建一个新列表，检查第一个元素和第二个元素。基本上编辑第二个列表。这个列表将成为

```
List3 = [(56,12),(78,23),(23,56)] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T11:57:14.203

如果订单/重复无关紧要：

```
>>> A = [(12,34),(12,6),(2,4),(1,3),(34,32),(34,6)]
>>> B = [(12,34),(12,6),(2,4),(1,3),(34,32),(56,12),(78,23),(23,56)]
>>> set(B).difference(A)
set([(78, 23), (56, 12), (23, 56)]) 
```

否则，如果顺序确实很重要，只需使用集合的列表理解检查成员资格（O(1) 摊销成员资格检查）：

```
>>> set_A = set(A)
>>> [x for x in B if x not in set_A]
[(56, 12), (78, 23), (23, 56)] 
```

请记住，这个简单的解决方案也有效：

```
>>> [x for x in B if x not in A]
[(56, 12), (78, 23), (23, 56)] 
```

`A`它每次检查时都必须潜在地扫描整个列表`x not in A`。

# matlab - Matlab - 图形用户界面 (GUI)，使用 arduino 数据绘图

> ID：16214061
> 
> 赞同：0
> 
> 时间：2013-04-25T11:55:23.407
> 
> 标签：matlab, user-interface, plot, arduino

我有一个使用 arduino 从 LDR 传感器获取数据的实时绘图完成的 Matlab 程序。现在我想在 GUI 中实现该程序，并且在绘图方面遇到了一些问题。这是我的程序的一部分，我不知道如何在 GUI 模式下绘图。

> (...) While(1) state = a.analogRead(0); (...) 轴紧拉丝；x = [x，状态]；情节（x，'-*b'）；网格开启；结尾

代码必须在OpeningFcn中？我应该只是复制粘贴到那里吗？我必须在绘图代码中更改什么？非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T14:25:37.373

无休止的`while`循环`OpeningFcn`将无限期地锁定您的 GUI。您最好创建一个计时器对象并在其回调中运行您的“连续”绘图代码；一个例子：

```
function myui_OpeningFcn(hObject, eventdata, handles, varargin)

    % Create timer with delay of 0.1 seconds
    handles.tmrPlot = timer( ...
        'ExecutionMode', 'FixedRate', ...
        'Period', 0.1, ...
        'TimerFcn', @myPlottingFunction);

    % Store in ui data
    guidata(hObject, handles);

    % Start it!
    start(handles.tmrPlot);
end

function myPlottingFunction(src, evt)
    % Do some plotting
    plot(rand(10));

    drawnow;
end 
```

例如，使用计时器，您还可以在按钮的回调中启动和停止执行。

# android - 在 sqlite 数据库中创建外键

> ID：16214062
> 
> 赞同：0
> 
> 时间：2013-04-25T11:55:24.240
> 
> 标签：android, database, sqlite, foreign-key-relationship

我需要创建一个外键来映射我的表。基本上，这个外键是表的主键。但是插入语句正在引起问题。它是一个 SQLite 数据库。具有主键的表是

```
db.execSQL("CREATE TABLE IF NOT EXISTS "
            + Main
            + "(ROWID integer primary key autoincrement NOT NULL,appln_date VARCHAR,appln_no VARCHAR,rupees VARCHAR,tenure VARCHAR,asset VARCHAR);"); 
```

带有外键的表是

```
db.execSQL("CREATE TABLE IF NOT EXISTS "
            + Applicant
            + "(AppID integer primary key autoincrement, " +
                    "app_salutation VARCHAR,app_fname VARCHAR,app_mname VARCHAR,app_lname VARCHAR,app_door VARCHAR,app_street VARCHAR,app_building VARCHAR,app_area VARCHAR,app_post VARCHAR,app_tehsil VARCHAR,app_state VARCHAR,app_landmark VARCHAR,ROWID integer References "+Main+"(ROWID));"); 
```

插入语句是

```
openOrCreateDatabase();
    createappinfo();
    String insertString = "insert into " + Applicant
            + " Values(";

    String inString = "";
    for (int i =0; i < data.size(); i++) {

        inString = inString + "\"" + data.get(i) + "\",";

    }

    inString = inString.substring(0, inString.length() - 1);
    int row=db.rawQuery("select * from "+Main+";" ,null).getCount()+1;
    insertString = insertString + row+"," +inString + ");";
    System.out.println("** insert value ** " + insertString);
    db.execSQL(insertString);

    closeDatabase(); 
```

但是这段代码正在产生错误..

```
04-25 11:43:57.422: E/SQLiteLog(17825): (1) table applicanttable has 14 columns but 13 values were supplied 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:04:41.697

你应该在数据库上做这样的声明：

```
CREATE TABLE IF NOT EXISTS "Main" (ROWID integer primary key autoincrement NOT NULL,appln_date VARCHAR,appln_no VARCHAR,rupees VARCHAR,tenure VARCHAR,asset VARCHAR);
CREATE TABLE IF NOT EXISTS "Applicant" (AppID integer primary key autoincrement, app_salutation VARCHAR,app_fname VARCHAR,app_mname VARCHAR,app_lname VARCHAR,app_door VARCHAR,app_street VARCHAR,app_building VARCHAR,app_area VARCHAR,app_post VARCHAR,app_tehsil VARCHAR,app_state VARCHAR,app_landmark VARCHAR,ROWID integer References "Main"(ROWID));
insert into "Applicant" Values("11","a","b","c","d","e","f","g","h","i","j","k","l", (SELECT Count(*) +1 FROM main)); 
```

此示例中的值是随机的。

因此，如果您 100% 确定您的 for 语句正确返回除最后一个以外的所有值。您的最后一个论点应如下所示：

```
insertString = "ROWID integer References "Main"(ROWID);"; 
```

# php - 执行此搜索和替换模板的更好方法

> ID：16214063
> 
> 赞同：5
> 
> 时间：2013-04-25T11:55:25.170
> 
> 标签：php, replace

我目前正在搜索和替换这样的网页模板：

```
$template = <<<TEMP
<html>
<head>
<title>[{pageTitle}]</title>
</head>
[{menuA}]
[{menuB}]
[{bodyContent}]
</html>
<<<TEMP; 
```

**以上内容放在单独的文件中。**

**然后，我这样做：**

```
$template = str_replace("[{pageTitle}]",$pageTitle,$template);
$template = str_replace("[{menuA}]",$menuA,$template);
$template = str_replace("[{menuB}]",$menuB,$template);
$template = str_replace("[{bodyContent}]",$bodyContent,$template);
//Some 10 more similar to the above go here.
echo $template; 
```

问题是，总共有大约 15 个，就像上面的一样。

有没有更好/更清洁/专业的方法来做到这一点（搜索和替换，或者以不同的方式做整个事情）。我觉得这非常混乱和不专业。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T11:58:40.703

是的，您可以定义要替换的事物的数组以及要替换的事物的另一个数组。

```
$array1 = array("[{pageTitle}]", "[{menuA}]");
$array2 = array($pageTitle, $menuA);

$template = str_replace($array1 , $array2 , $template); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:36:16.243

通过修改[ljubiccica 的答案](https://stackoverflow.com/a/16214132/739897)。您可以使用变量和值创建关联数组，然后替换它们：

```
$array=array(
        'pageTitle'=>$pageTitle,
        'menuA'=> $menuA,
        );

$addBrackets = function($a)
{
    return '[{'.$a.'}]';
};
$array1 = array_keys($array);
$array1 = array_map($addBrackets,$array1);

$array2 = array_values($array);

$template = str_replace($array1 , $array2 , $template); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T12:08:21.367

最好的方法是使用现有的库，如[Smarty](http://www.smarty.net/)或[Twig](http://twig.sensiolabs.org/)。

如果您想推出自己的模板解决方案，您可以使用正则表达式：

```
// Just an example array
$values = array('pageTitle' => 'foo', 'menuA' => 'bar');
$offset = 0;
while(preg_match('/\[\{([a-zA-Z]+)\]\}/', $template, $matches, 
  PREG_OFFSET_CAPTURE, $offset)) {
    $varname = $matches[0][3];
    $value = isset($values[$varname]) ? $values[$varname] : "Not found!";
    $template = str_replace('[{'.$varname.'}]', $value, $template);
    $offset = $matches[1];
} 
```

如果你不喜欢关联数组，你可以这样做：

```
$value = isset($$varname)? $$varname : "Not found"; 
```

但我建议不要这样做，因为它可能会暴露你不想暴露的变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T12:12:09.467

不要重新发明轮子，使用现有的模板引擎。我建议使用[twig](http://twig.sensiolabs.org/)，因为它既简单又快速！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T12:07:48.177

使用正则表达式怎么样。如下所示：

```
 $matches = array();
    preg_match_all("/\[\{.*?\}\]/", $template, $matches);
    foreach ($matches[0] as $match){
    // this will replace the '[{','}]' braces as we don't want these in our file name
    $var = str_replace("[{", "", $match);
    $var = str_replace("}]", "", $var);
    // this should pull in the file name and continue the output
    $template = str_replace($match, $$var, $template);
    } 
```

我还没有测试过，但这样你就不必知道你需要更换什么？例如，它会用 $text 替换 [{text}] 标签中的内容吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-25T12:34:56.917

我发现这样的事情确实有效：

```
 $foo = 'bar';
    $baz = 'foo';

    $test = 'Test [{foo}] and [{baz}]';

    $test1 = preg_replace("/\[{(.*?)}\]/e", "$$1", $test);
    $test2 = preg_replace_callback("/\[{(.*?)}\]/", function($v) use($foo, $baz)
            {
                return ${$v[1]};
            }, $test);
    var_dump($test1); //string 'Test bar and foo' (length=16)
    var_dump($test2); //string 'Test bar and foo' (length=16) 
```

所以在你的情况下：

```
$template= preg_replace("/\[{(.*?)}\]/e", "$$1", $template); 
```

**编辑：**

您还可以检查变量是否设置如下：

```
 $foo = 'bar';
    $baz = 'foo';

    $test = 'Test [{foo}] and [{baz}] or [{ble}]';

    $test1 = preg_replace("/\[{(.*?)}\]/e", "isset($$1) ? $$1 : '$$1';", $test);
    var_dump($test1); //string 'Test bar and foo or $ble' (length=24) 
```

# php - PHP，合并多维数组中的键

> ID：16214064
> 
> 赞同：5
> 
> 时间：2013-04-25T11:55:25.087
> 
> 标签：php, arrays

如果我有一个看起来像这样的数组：

```
Array
(
    [0] => Array
    (
        [DATA] => Array
    (
        VALUE1 = 1
        VALUE2 = 2
    )
    )
    [1] => Array
    (   
        [DATA] => Array
    (
        VALUE3 = 3
        VALUE4 = 4
    )
    )
) 
```

并想把它变成这样：

```
Array
(
    [0] => Array
    (
        [DATA] => Array
    (
        VALUE1 = 1
        VALUE2 = 2
        VALUE3 = 3
        VALUE4 = 4
    )
    )
) 
```

我基本上想合并所有相同级别的相同键。实现这一目标的最佳途径是什么？array_merge 函数有什么用吗？

我希望这有任何意义，并提前感谢我能得到的任何帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-25T12:03:02.497

您可以使用[`array_merge_recursive`](http://php.net/manual/en/function.array-merge-recursive.php)将原始数组中的所有项目合并在一起。并且由于该函数采用可变数量的参数，因此在编译时该数字未知时使其变得笨拙，您可以使用它[`call_user_func_array`](http://php.net/manual/en/function.call-user-func-array.php)来获得额外的便利：

```
$result = call_user_func_array('array_merge_recursive', $array); 
```

结果将删除您输入的“顶级”（合乎逻辑，因为您将多个项目合并为一个），但将保留所有剩余的结构。

**[看到它在行动](http://ideone.com/shp1rk)**。

# java - 时区的奇怪行为

> ID：16214066
> 
> 赞同：5
> 
> 时间：2013-04-25T11:55:27.103
> 
> 标签：java, timezone

我运行以下 Java 代码：

```
TimeZone tz1 = TimeZone.getTimeZone("Etc/GMT-3");
System.out.println(tz1.getDisplayName()); 
```

显示器是`GMT+03:00`！

似乎当我们使用具有诸如 id 的时区时`Etc/GMTxx`，符号是相反的。为什么 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T11:57:38.410

那是 ETC 风格：

[http://en.wikipedia.org/wiki/Zoneinfo](http://en.wikipedia.org/wiki/Zoneinfo)

> “Etc”的特殊区域用于一些行政区，特别是“Etc/UTC”，它代表协调世界时。为了符合 POSIX 风格，那些以“Etc/GMT”开头的区域名称的符号与大多数人的预期相反。在这种风格中，格林威治标准时间以西的区域有一个正号，东部的区域有一个负号（**例如，“Etc/GMT-14”是格林威治标准时间之前/东部的 14 小时。**）

# git - .PO (gettext) 文件的 3 路 Git 合并驱动程序在哪里？

> ID：16214067
> 
> 赞同：16
> 
> 时间：2013-04-25T11:55:29.767
> 
> 标签：git, localization, merge, conflict, gettext

我已经有关注

```
[attr]POFILE merge=merge-po-files

locale/*.po POFILE 
```

在`.gitattributes`和我希望`locale/en.po`在并行分支中修改相同的本地化文件（例如）时合并分支以正常工作。我目前正在使用以下合并驱动程序：

```
#!/bin/bash
# git merge driver for .PO files (gettext localizations)
# Install:
# git config merge.merge-po-files.driver "./bin/merge-po-files %A %O %B"

LOCAL="${1}._LOCAL_"
BASE="${2}._BASE_"
REMOTE="${3}._REMOTE_"

# rename to bit more meaningful filenames to get better conflict results
cp "${1}" "$LOCAL"
cp "${2}" "$BASE"
cp "${3}" "$REMOTE"

# merge files and overwrite local file with the result
msgcat "$LOCAL" "$BASE" "$REMOTE" -o "${1}" || exit 1

# cleanup
rm -f "$LOCAL" "$BASE" "$REMOTE"

# check if merge has conflicts
fgrep -q '#-#-#-#-#' "${1}" && exit 1

# if we get here, merge is successful
exit 0 
```

但是，`msgcat`太笨了，**这不是真正的三路合并**。例如，如果我有

1.  基础版

    ```
    msgid "foo"
    msgstr "foo" 
    ```

2.  本地版本

    ```
    msgid "foo"
    msgstr "bar" 
    ```

3.  远程版

    ```
    msgid "foo"
    msgstr "foo" 
    ```

我会以冲突告终。但是，**真正的三路合并驱动程序会输出正确的合并**：

```
msgid "foo"
msgstr "bar" 
```

请注意，我不能简单地添加`--use-first`，`msgcat`因为远程可能包含更新的翻译。此外，如果 BASE、LOCAL 和 REMOTE 都是唯一的，我仍然想要一个冲突，因为那真的是一个冲突。

**我需要改变什么才能使这项工作？**如果可能的话，比“#-#-#-#-#”更少疯狂的冲突标记的奖励积分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-30T10:36:07.377

[这是一个历史版本，请参阅我对 2021 年合并驱动程序版本的另一个更新的答案。]

这是一个有点复杂的示例驱动程序，它似乎输出了正确的合并，其中可能包含一些应该被本地或远程版本删除的翻译。
什么都不应该丢失，所以这个驱动程序在某些情况下只会增加一些额外的混乱。

此版本使用`gettext`看起来像`#-#-#-#-#`与`fuzzy`标志结合的本机冲突标记，而不是普通的 git 冲突标记。驱动程序对于解决和中的错误（或*功能*）
有点难看：*`msgcat``msguniq`*

 *```
#!/bin/bash
# git merge driver for .PO files
# Copyright (c) Mikko Rantalainen <mikko.rantalainen@peda.net>, 2013
# License: MIT

ORIG_HASH=$(git hash-object "${1}")
WORKFILE=$(git ls-tree -r HEAD | fgrep "$ORIG_HASH" | cut -b54-)
echo "Using custom merge driver for $WORKFILE..."

LOCAL="${1}._LOCAL_"
BASE="${2}._BASE_"
REMOTE="${3}._REMOTE_"

LOCAL_ONELINE="$LOCAL""ONELINE_"
BASE_ONELINE="$BASE""ONELINE_"
REMOTE_ONELINE="$REMOTE""ONELINE_"

OUTPUT="$LOCAL""OUTPUT_"
MERGED="$LOCAL""MERGED_"
MERGED2="$LOCAL""MERGED2_"

TEMPLATE1="$LOCAL""TEMPLATE1_"
TEMPLATE2="$LOCAL""TEMPLATE2_"
FALLBACK_OBSOLETE="$LOCAL""FALLBACK_OBSOLETE_"

# standardize the input files for regexping
# default to UTF-8 in case charset is still the placeholder "CHARSET"
cat "${1}" | perl -npe 's!(^"Content-Type: text/plain; charset=)(CHARSET)(\\n"$)!$1UTF-8$3!' | msgcat --no-wrap --sort-output - > "$LOCAL"
cat "${2}" | perl -npe 's!(^"Content-Type: text/plain; charset=)(CHARSET)(\\n"$)!$1UTF-8$3!' | msgcat --no-wrap --sort-output - > "$BASE"
cat "${3}" | perl -npe 's!(^"Content-Type: text/plain; charset=)(CHARSET)(\\n"$)!$1UTF-8$3!' | msgcat --no-wrap --sort-output - > "$REMOTE"

# convert each definition to single line presentation
# extra fill is required to make sure that git separates each conflict 
perl -npe 'BEGIN {$/ = "\n\n"}; s/#\n$/\n/s; s/#/##/sg; s/\n/#n/sg; s/#n$/\n/sg; s/#n$/\n/sg; $_.="#fill#\n" x 4' "$LOCAL" > "$LOCAL_ONELINE"
perl -npe 'BEGIN {$/ = "\n\n"}; s/#\n$/\n/s; s/#/##/sg; s/\n/#n/sg; s/#n$/\n/sg; s/#n$/\n/sg; $_.="#fill#\n" x 4' "$BASE"  > "$BASE_ONELINE"
perl -npe 'BEGIN {$/ = "\n\n"}; s/#\n$/\n/s; s/#/##/sg; s/\n/#n/sg; s/#n$/\n/sg; s/#n$/\n/sg; $_.="#fill#\n" x 4' "$REMOTE"  > "$REMOTE_ONELINE"

# merge files using normal git merge machinery
git merge-file -p --union -L "Current (working directory)" -L "Base (common ancestor)" -L "Incoming (applied changeset)" "$LOCAL_ONELINE" "$BASE_ONELINE" "$REMOTE_ONELINE" > "$MERGED"
MERGESTATUS=$?

# remove possibly duplicated headers (workaround msguniq bug http://comments.gmane.org/gmane.comp.gnu.gettext.bugs/96)
cat "$MERGED" | perl -npe 'BEGIN {$/ = "\n\n"}; s/^([^\n]+#nmsgid ""#nmsgstr ""#n.*?\n)([^\n]+#nmsgid ""#nmsgstr ""#n.*?\n)+/$1/gs' > "$MERGED2"

# remove lines that have totally empty msgstr
# and convert back to normal PO file representation
cat "$MERGED2" | grep -v '#nmsgstr ""$' | grep -v '^#fill#$' | perl -npe 's/#n/\n/g; s/##/#/g' > "$MERGED"

# run the output through msguniq to merge conflicts gettext style
# msguniq seems to have a bug that causes empty output if zero msgids
# are found after the header. Expected output would be the header...
# Workaround the bug by adding an empty obsolete fallback msgid
# that will be automatically removed by msguniq

cat > "$FALLBACK_OBSOLETE" << 'EOF'

#~ msgid "obsolete fallback"
#~ msgstr ""

EOF
cat "$MERGED" "$FALLBACK_OBSOLETE" | msguniq --no-wrap --sort-output > "$MERGED2"

# create a hacked template from default merge between 3 versions
# we do this to try to preserve original file ordering
msgcat --use-first "$LOCAL" "$REMOTE" "$BASE" > "$TEMPLATE1"
msghack --empty "$TEMPLATE1" > "$TEMPLATE2"
msgmerge --silent --no-wrap --no-fuzzy-matching "$MERGED2" "$TEMPLATE2" > "$OUTPUT"

# show some results to stdout
if grep -q '#-#-#-#-#' "$OUTPUT"
then
    FUZZY=$(cat "$OUTPUT" | msgattrib --only-fuzzy --no-obsolete --color | perl -npe 'BEGIN{ undef $/; }; s/^.*?msgid "".*?\n\n//s')
    if test -n "$FUZZY"
    then
        echo "-------------------------------"
        echo "Fuzzy translations after merge:"
        echo "-------------------------------"
        echo "$FUZZY"
        echo "-------------------------------"
    fi
fi

# git merge driver must overwrite the first parameter with output
mv "$OUTPUT" "${1}"

# cleanup
rm -f "$LOCAL" "$BASE" "$REMOTE" "$LOCAL_ONELINE" "$BASE_ONELINE" "$REMOTE_ONELINE" "$MERGED" "$MERGED2" "$TEMPLATE1" "$TEMPLATE2" "$FALLBACK_OBSOLETE"

# return conflict if merge has conflicts according to msgcat/msguniq
grep -q '#-#-#-#-#' "${1}" && exit 1

# otherwise, return git merge status
exit $MERGESTATUS

# Steps to install this driver:
# (1) Edit ".git/config" in your repository directory
# (2) Add following section:
#
# [merge "merge-po-files"]
#   name = merge po-files driver
#   driver = ./bin/merge-po-files %A %O %B
#   recursive = binary
#
# or
#
# git config merge.merge-po-files.driver "./bin/merge-po-files %A %O %B"
#
# The file ".gitattributes" will point git to use this merge driver. 
```

关于此驱动程序的简短说明：

*   它将常规 PO 文件格式转换为单行格式，其中每一行都是一个翻译条目。
*   然后它使用常规`git merge-file --union`进行合并，合并后生成的单行格式转换回常规 PO 文件格式。
    在此使用之后完成实际的冲突解决`msguniq`，
*   然后它最终将生成的文件与通过定期`msgcat`组合原始输入文件生成的模板合并以恢复可能丢失的元数据。

**警告：**此驱动程序将`msgcat --no-wrap`在文件上使用，如果未指定实际编码`.PO`，将强制编码。 如果您想使用此合并驱动程序但始终检查结果，请将最终结果更改为.`UTF-8`
`exit $MERGESTATUS``exit 1`

从该驱动程序中获取合并冲突后，修复冲突的最佳方法是使用`virtaal`并选择打开冲突文件*`Navigation: Incomplete`*。
我发现这个 UI 是一个很好的解决冲突的工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-29T05:26:07.567

[这是一个历史版本，请参阅我对 2021 年合并驱动程序版本的另一个更新的答案。]

这是一个示例驱动程序，它使用正确位置的冲突标记来纠正基于文本的差异。但是，万一发生冲突，`git mergetool`肯定会弄乱结果，所以这并不是很好。如果您只想使用文本编辑器来修复冲突的合并，那么这应该没问题：

```
#!/bin/bash
# git merge driver for .PO files
# Copyright (c) Mikko Rantalainen <mikko.rantalainen@peda.net>, 2013
# License: MIT

LOCAL="${1}._LOCAL_"
BASE="${2}._BASE_"
REMOTE="${3}._REMOTE_"
MERGED="${1}._MERGED_"
OUTPUT="$LOCAL""OUTPUT_"

LOCAL_ONELINE="$LOCAL""ONELINE_"
BASE_ONELINE="$BASE""ONELINE_"
REMOTE_ONELINE="$REMOTE""ONELINE_"

# standardize the input files for regexping
msgcat --no-wrap --strict --sort-output "${1}" > "$LOCAL"
msgcat --no-wrap --strict --sort-output "${2}" > "$BASE"
msgcat --no-wrap --strict --sort-output "${3}" > "$REMOTE"

# convert each definition to single line presentation
# extra fill is required to make sure that git separates each conflict 
perl -npe 'BEGIN {$/ = "#\n"}; s/#\n$/\n/s; s/#/##/sg; s/\n/#n/sg; s/#n$/\n/sg; s/#n$/\n/sg; $_.="#fill#\n" x 4' "$LOCAL" > "$LOCAL_ONELINE"
perl -npe 'BEGIN {$/ = "#\n"}; s/#\n$/\n/s; s/#/##/sg; s/\n/#n/sg; s/#n$/\n/sg; s/#n$/\n/sg; $_.="#fill#\n" x 4' "$BASE"  > "$BASE_ONELINE"
perl -npe 'BEGIN {$/ = "#\n"}; s/#\n$/\n/s; s/#/##/sg; s/\n/#n/sg; s/#n$/\n/sg; s/#n$/\n/sg; $_.="#fill#\n" x 4' "$REMOTE"  > "$REMOTE_ONELINE"

# merge files using normal git merge machinery
git merge-file -p -L "Current (working directory)" -L "Base (common ancestor)" -L "Incoming (another change)" "$LOCAL_ONELINE" "$BASE_ONELINE" "$REMOTE_ONELINE" > "$MERGED"
MERGESTATUS=$?

# convert back to normal PO file representation
cat "$MERGED" | grep -v '^#fill#$' | perl -npe 's/#n/\n/g; s/##/#/g' > "$OUTPUT"

# git merge driver must overwrite the first parameter with output
mv "$OUTPUT" "${1}"

# cleanup
rm -f "$LOCAL" "$BASE" "$REMOTE" "$LOCAL_ONELINE" "$BASE_ONELINE" "$REMOTE_ONELINE" "$MERGED"

exit $MERGESTATUS

# Steps to install this driver:
# (1) Edit ".git/config" in your repository directory
# (2) Add following section:
#
# [merge "merge-po-files"]
#   name = merge po-files driver
#   driver = ./bin/merge-po-files %A %O %B
#   recursive = binary
#
# or
#
# git config merge.merge-po-files.driver "./bin/merge-po-files %A %O %B"
#
# The file ".gitattributes" will point git to use this merge driver. 
```

关于此驱动程序的简短说明：它将常规 PO 文件格式转换为单行格式，其中每行是一个翻译条目。然后它使用常规`git merge-file`进行合并，合并后生成的单行格式转换回常规 PO 文件格式。**警告：**此驱动程序将用于`msgcat --sort-output`.PO 文件，因此如果您希望您的 PO 文件按特定顺序排列，这可能不适合您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-09T10:13:11.560

从 Mikko 的回答中汲取灵感，我们为[`git-whistles`](https://github.com/mezis/git-whistles)Ruby gem 添加了一个成熟的 3 路合并。

它不依赖`git-merge`或用 Perl 重写字符串，只用 Gettext 工具操作 PO 文件。

这是代码（麻省理工学院许可）：

```
#!/bin/sh
#
# Three-way merge driver for PO files
#
set -e

# failure handler
on_error() {
  local parent_lineno="$1"
  local message="$2"
  local code="${3:-1}"
  if [[ -n "$message" ]] ; then
    echo "Error on or near line ${parent_lineno}: ${message}; exiting with status ${code}"
  else
    echo "Error on or near line ${parent_lineno}; exiting with status ${code}"
  fi
  exit 255
}
trap 'on_error ${LINENO}' ERR

# given a file, find the path that matches its contents
show_file() {
  hash=`git hash-object "${1}"`
  git ls-tree -r HEAD | fgrep "$hash" | cut -b54-
}

# wraps msgmerge with default options
function m_msgmerge() {
  msgmerge --force-po --quiet --no-fuzzy-matching $@
}

# wraps msgcat with default options
function m_msgcat() {
  msgcat --force-po $@
}

# removes the "graveyard strings" from the input
function strip_graveyard() {
  sed -e '/^#~/d'
}

# select messages with a conflict marker
# pass -v to inverse selection
function grep_conflicts() {
  msggrep $@ --msgstr -F -e '#-#-#' -
}

# select messages from $1 that are also in $2 but whose contents have changed
function extract_changes() {
  msgcat -o - $1 $2 \
    | grep_conflicts \
    | m_msgmerge -o - $1 - \
    | strip_graveyard
}

BASE=$1
LOCAL=$2
REMOTE=$3
OUTPUT=$LOCAL
TEMP=`mktemp /tmp/merge-po.XXXX`

echo "Using custom PO merge driver (`show_file ${LOCAL}`; $TEMP)"

# Extract the PO header from the current branch (top of file until first empty line)
sed -e '/^$/q' < $LOCAL > ${TEMP}.header

# clean input files
msguniq --force-po -o ${TEMP}.base   --unique ${BASE}
msguniq --force-po -o ${TEMP}.local  --unique ${LOCAL}
msguniq --force-po -o ${TEMP}.remote --unique ${REMOTE}

# messages changed on local
extract_changes ${TEMP}.local ${TEMP}.base > ${TEMP}.local-changes

# messages changed on remote
extract_changes ${TEMP}.remote ${TEMP}.base > ${TEMP}.remote-changes

# unchanged messages
m_msgcat -o - ${TEMP}.base ${TEMP}.local ${TEMP}.remote \
  | grep_conflicts -v \
  > ${TEMP}.unchanged

# messages changed on both local and remote (conflicts)
m_msgcat -o - ${TEMP}.remote-changes ${TEMP}.local-changes \
  | grep_conflicts \
  > ${TEMP}.conflicts

# messages changed on local, not on remote; and vice-versa
m_msgcat -o ${TEMP}.local-only  --unique ${TEMP}.local-changes  ${TEMP}.conflicts
m_msgcat -o ${TEMP}.remote-only --unique ${TEMP}.remote-changes ${TEMP}.conflicts

# the big merge
m_msgcat -o ${TEMP}.merge1 ${TEMP}.unchanged ${TEMP}.conflicts ${TEMP}.local-only ${TEMP}.remote-only

# create a template to filter messages actually needed (those on local and remote)
m_msgcat -o - ${TEMP}.local ${TEMP}.remote \
  | m_msgmerge -o ${TEMP}.merge2 ${TEMP}.merge1 -

# final merge, adds saved header
m_msgcat -o ${TEMP}.merge3 --use-first ${TEMP}.header ${TEMP}.merge2

# produce output file (overwrites input LOCAL file)
cat ${TEMP}.merge3 > $OUTPUT

# check for conflicts
if grep '#-#' $OUTPUT > /dev/null ; then
  echo "Conflict(s) detected"
  echo "   between ${TEMP}.local and ${TEMP}.remote"
  exit 1
fi
rm -f ${TEMP}*
exit 0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-16T08:02:03.600

这是 2021 年的另一个答案。我现在正在使用以下合并驱动程序，这似乎适用于我测试过的所有情况。我将其存储`./bin/merge-po-files`在我们的存储库中。

```
#!/bin/bash
#
# Three-way merge driver for PO files, runs on multiple CPUs where possible
#
# Copyright 2015-2016 Marco Ciampa
# Copyright 2021 Mikko Rantalainen <mikko.rantalainen@iki.fi>
# License: MIT (https://opensource.org/licenses/MIT)
#
# Original source:
# https://stackoverflow.com/a/29535676/334451
# https://github.com/mezis/git-whistles/blob/master/libexec/git-merge-po.sh
#
# Install with
# git config merge.merge-po-files.driver "./bin/merge-po-files %A %O %B %P"
#
# Note that you also need file `.gitattributes` with following lines:
#
# [attr]POFILE merge=merge-po-files
# locale/*.po POFILE
#
##########################################################################
# CONFIG:

# Formatting flags to be be used to produce merged .po files
# This can be set to match project needs for the .po files.
# NOTE: $MSGCAT_FINAL_FLAGS will be passed to msgcat without quotation
MSGCAT_FINAL_FLAGS="--no-wrap --sort-output"

# Verbosity level:
# 0: Silent except for real errors
# 1: Show simple header for each file processed
# 2: Also show all conflicts in merge result (both new and existing)
# 3: Also show all status messages with timestamps
VERBOSITY="${VERBOSITY:=2}"

##########################################################################
# Implementation:

# Use logical names for arguments:
LOCAL="$1"
BASE="$2"
OTHER="$3"
FILENAME="$4"
OUTPUT="$LOCAL"

# The temporary directory for all files we need - note that most files are
# created without extensions to emit nicer conflict messages where gettext
# likes to embed the basename of the file in the conflict message so we
# use names like "local" and "other" instead of e.g. "local.G2wZ.po".
TEMP="$(mktemp -d /tmp/merge-po.XXXXXX)"

# abort on any error and report the details if possible
set -E
set -e
on_error()
{
    local parent_lineno="$1"
    local message="$3"
    local code="$2"
    if [[ -n "$message" ]] ; then
        printf "### $0: error near line %d: status %d: %s\n" "${parent_lineno}" "${code}" "${message}" 1>&2
    else
        printf "### $0: error near line %d: status %d\n" "${parent_lineno}" "${code}" 1>&2
    fi
    exit 255
}
trap 'on_error ${LINENO} $?' ERR

# Maybe print message(s) to stdout with timestamps
function status()
{
    if test "$VERBOSITY" -ge 3
    then
        printf "%s %s\n" "$(date '+%Y-%m-%d %H:%M:%S.%3N')" "$@"
    fi
}

# Quietly take translations from $1 and apply those according to template $2
# (and do not use fuzzy-matching, always generate output)
# also supports all flags to msgmerge
function apply_po_template()
{
    msgmerge --force-po --quiet --no-fuzzy-matching "$@"
}

# Take stdin, remove the "graveyard strings" and emit the result to stdout
function strip_graveyard()
{
    msgattrib --no-obsolete
}

# Take stdin, keep only confict lines and emit the result to stdout
function only_conflicts()
{
    msggrep --msgstr -F -e '#-#-#-#-#' -
    # alternative slightly worse implementation: msgattrib --only-fuzzy
}

# Take stdin, discard confict lines and emit the result to stdout
function without_conflicts()
{
    msggrep -v --msgstr -F -e '#-#-#-#-#' -
    # alternative slightly worse implementation: msgattrib --no-fuzzy
}

# Select messages from $1 that are also in $2 but whose contents have changed
# and emit results to stdout
function extract_changes()
{
    # Extract conflicting changes and discard any changes to graveyard area only
    msgcat -o - "$1" "$2" \
    | only_conflicts \
    | apply_po_template -o - "$1" - \
    | strip_graveyard
}

# Emit only the header of $1, supports flags of msggrep
function extract_header()
{
    # Unfortunately gettext really doesn't support extracting just header
    # so we have to get creative: extract only strings that originate
    # from file called "//" which should result to header only
     msggrep --force-po -N // "$@"

    # Logically msggrep --force-po -v -K -E -e '.' should return the header
    # only but msggrep seems be buggy with msgids with line feeds and output
    # those, too
}

# Take file in $1 and show conflicts with colors in the file to stdout
function show_conflicts()
{
    OUTPUT="$1"
    shift
    # Count number of lines to remove from the output and output conflict lines without the header
    CONFLICT_HEADER_LINES=$(cat "$OUTPUT" | msggrep --force-po --color=never --msgstr -F -e '#-#-#-#-#' - | extract_header - | wc -l)
    # tail wants line number of the first displayed line so we want +1 here:
    CONFLICTS=$(cat "$OUTPUT" | msggrep --force-po --color --msgstr -F -e '#-#-#-#-#' - | tail -n "+$((CONFLICT_HEADER_LINES+1))")
    if test -n "$CONFLICTS"
    then
        #echo "----------------------------"
        #echo "Conflicts after merge:"
        echo "----------------------------"
        printf "%s\n" "$CONFLICTS"
        echo "----------------------------"
    fi
}

# Sanity check that we have a sensible temporary directory
test -n "$TEMP" || exit 125
test -d "$TEMP" || exit 126
test -w "$TEMP" || exit 127

if test "$VERBOSITY" -ge 1
then
    printf "Using gettext .PO merge driver: %s ...\n" "$FILENAME"
fi

# Extract the PO header from the current branch (top of file until first empty line)
extract_header -o "${TEMP}/header" "$LOCAL"

##########################################################################
# Following parts can be run partially parallel and "wait" is used to syncronize processing

# Clean input files and use logical filenames for possible conflict markers:
status "Canonicalizing input files ..."
msguniq --force-po -o "${TEMP}/base" --unique "${BASE}" &
msguniq --force-po -o "${TEMP}/local" --unique "${LOCAL}" &
msguniq --force-po -o "${TEMP}/other" --unique "${OTHER}" &
wait

status "Computing local-changes, other-changes and unchanged ..."
msgcat --force-po -o - "${TEMP}/base" "${TEMP}/local" "${TEMP}/other" | without_conflicts > "${TEMP}/unchanged" &
extract_changes "${TEMP}/local" "${TEMP}/base" > "${TEMP}/local-changes" &
extract_changes "${TEMP}/other" "${TEMP}/base" > "${TEMP}/other-changes" &
wait

# Messages changed on both local and other (conflicts):
status "Computing conflicts ..."
msgcat --force-po -o - "${TEMP}/other-changes" "${TEMP}/local-changes" | only_conflicts > "${TEMP}/conflicts"

# Messages changed on local, not on other; and vice-versa:
status "Computing local-only and other-only changes ..."
msgcat --force-po -o "${TEMP}/local-only"  --unique "${TEMP}/local-changes"  "${TEMP}/conflicts" &
msgcat --force-po -o "${TEMP}/other-only" --unique "${TEMP}/other-changes" "${TEMP}/conflicts" &
wait

# Note: following steps require sequential processing and cannot be run in parallel

status "Computing initial merge without template ..."
# Note that we may end up with some extra so we have to apply template later
msgcat --force-po -o "${TEMP}/merge1" "${TEMP}/unchanged" "${TEMP}/conflicts" "${TEMP}/local-only" "${TEMP}/other-only"

# Create a template to only output messages that are actually needed (union of messages on local and other create the template!)
status "Computing template and applying it to merge result ..."
msgcat --force-po -o - "${TEMP}/local" "${TEMP}/other" | apply_po_template -o "${TEMP}/merge2" "${TEMP}/merge1" -

# Final merge result is merge2 with original header
status "Fixing the header after merge ..."
msgcat --force-po $MSGCAT_FINAL_FLAGS -o "${TEMP}/merge3" --use-first "${TEMP}/header" "${TEMP}/merge2"

# Produce output file (overwrites input LOCAL file because git expects that for the results)
status "Saving output ..."
mv "${TEMP}/merge3" "$OUTPUT"

status "Cleaning up ..."

rm "${TEMP}"/*
rmdir "${TEMP}"

status "Checking for conflicts in the result ..."

# Check for conflicts in the final merge
if grep -q '#-#-#-#-#' "$OUTPUT"
then
    if test "$VERBOSITY" -ge 1
    then
        printf "### Conflict(s) detected ###\n"
    fi

    if test "$VERBOSITY" -ge 2
    then
        # Verbose diagnostics
        show_conflicts "$OUTPUT"
    fi

    status "Automatic merge failed, exiting with status 1."
    exit 1
fi

status "Automatic merge completed successfully, exiting with status 0."
exit 0 
```

此变体基于上面发布的@mezis 版本，但具有以下改进：

*   `&`尽可能在多个 CPU 上并行运行（分配到多个 CPU 是通过在后台运行多个管道来完成`wait`的给定的 .PO 输入似乎约为 1 MB/s。
*   添加大量文档。
*   在开始时添加可配置变量以定义最终的 gettext 文件格式。在上面的示例中，默认配置是`--no-wrap --sort-output`.
*   对所有临时文件使用不带文件扩展名的逻辑名称，以便更容易理解 gettext 合并冲突。
*   在合并驱动程序中使用新`git`选项`%P`将正确的文件名作为参数传递。这在合并文件内容与项目中的另一个文件匹配的情况下是必需的 - 在这种情况下，与文件内容 SHA-1 匹配的旧代码可能会打印错误的文件名。请注意，`%P`必须在 git config 中使用（请参阅文件开头的文档）。
*   避免使用`perl`,`awk`或`sed`用于修改甚至读取 gettext 文件 - 只是 gettext 工具。可选部分仅使用`tail`and`wc`来显示冲突，但不处理输出中的真实数据。
*   正确合并不同复数形式发生变化的情况（合并将导致该翻译发生冲突，但不会丢失任何内容）。
*   请注意，如果您在墓地中有合并冲突（以这些冲突开头`#~`的行将被静默删除，而不是尝试合并此类情况）。将保留不冲突的墓地数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-08T09:15:39.147

我制作[了一个 python 驱动程序](https://gist.github.com/oadam/a02f862ac7a88579ea2743986c9be121)，可以很好地处理任一分支删除或引入的密钥。

这是它的来源：

```
#!/usr/bin/env python3
import importlib
import subprocess
import sys

def default_merge_and_exit():
    print(f"running default git merge", file=sys.stderr)
    subprocess.run(['git', 'merge-file', '-L', 'ours', '-L', 'base', '-L', 'theirs', sys.argv[1], sys.argv[2], sys.argv[3]])
    exit(1)

# check if polib is available
try:
    import polib
except ModuleNotFoundError as err:
    print('polib is not installed', file=sys.stderr)
    default_merge_and_exit()

try:
    # create 3 dictionnaries
    ours={}
    for e in polib.pofile(sys.argv[1]):
        ours[e.msgid]=e.msgstr
    base={}
    for e in polib.pofile(sys.argv[2]):
        base[e.msgid]=e.msgstr
    theirs={}
    for e in polib.pofile(sys.argv[3]):
        theirs[e.msgid]=e.msgstr

    all_keys=set(ours.keys())
    all_keys.update(base.keys())
    all_keys.update(theirs.keys())

    # check for conflicts
    conflicts=[]
    for key in sorted(all_keys):
        presence = (key in ours, key in base, key in theirs)
        if presence == (False, True, True) and base[key] != theirs[key]:
            conflicts.append(f"key removed by us and modified by them : {key}")
        if presence == (True, True, False) and base[key] != ours[key]:
            conflicts.append(f"key removed by them and modified by us : {key}")
        if presence == (True, False, True) and ours[key] != theirs[key]:
            conflicts.append(f"key added by them and us in a different way : {key}")
        if presence == (True, True, True) and base[key] != ours[key] and base[key] != theirs[key] and ours[key] != theirs[key]:
            conflicts.append(f"key modified by them and us in a different way : {key}")
    if conflicts:
        print(f"\nERROR : automerge for {sys.argv[1]} will conflict :", file=sys.stderr)
        for c in conflicts:
            print(c, file=sys.stderr)
        print("\n", file=sys.stderr)
        default_merge_and_exit()

    # update ours_po, knowing that there are no conflicts
    ours_po=polib.pofile(sys.argv[1])

    # mutate all entries with their modifications
    for e in ours_po:
        key=e.msgid
        if key in theirs and key in base and theirs[key] != base[key]:
            e.msgstr = theirs[key]

    # remove all entries removed by them
    # mutate the object without creating a new one https://stackoverflow.com/a/1208792/436792
    ours_po[:] = [e for e in ours_po if e.msgid in theirs]

    # add all entries introduced by them
    theirs_po=polib.pofile(sys.argv[3])
    for e in theirs_po:
        key=e.msgid
        if key not in ours:
            ours_po.append(e)

    # save result
    ours_po.save(sys.argv[1])

    # format result
    formatted = subprocess.check_output(['msgcat', '--sort-output',sys.argv[1]], text=True)
    open(sys.argv[1], 'w').write(formatted)
except BaseException:
    default_merge_and_exit() 
```*

# python - Urllib2 POST 请求导致 409 冲突错误

> ID：16214070
> 
> 赞同：0
> 
> 时间：2013-04-25T11:55:38.570
> 
> 标签：python, django, nginx, urllib2, gunicorn

我正在通过 Django 的视图在[http://pubsubhubbub.appspot.com上致电 google 的 pubsubhubbub 发布者。](http://pubsubhubbub.appspot.com)我想使用它来获取所有 youtube 上传提要。我正在使用 urllib2.Request 向其发送“发布”请求，但出现 409 冲突错误。我已经正确设置了回调 url，如果我尝试使用以下命令发布相同的请求：`python manage shell`它工作得很好。我使用 nginx 服务器作为生产服务器上 gunicorn 实例的代理。什么可能是错的。提前致谢。

```
>>> response.request
<PreparedRequest [POST]>
>>> response.request.headers
{'Content-Length': u'303', 'Content-Type': 'application/x-www-form-urlencoded', 'Accept-Encoding': 'gzip, deflate, compress', 'Accept': '*/*', 'User-Agent': 'python-requests/1.2.0 CPython/2.6.6 Linux/2.6.18-308.8.2.el5.028stab101.3'}
>>> response.request.body
'hub.verify=sync&hub.topic=http%3A%2F%2Fgdata.youtube.com%2Ffeeds%2Fapi%2Fusers%2FUCVcFOpBmJqkQ4v6Bh6l1UuQ%2Fuploads%3Fv%3D2&hub.lease_seconds=2592000&hub.callback=http%3A%2F%2Fhypedsound.cloudshuffle.com%2Fhub%2F19%2F&hub.mode=subscribe&hub.verify_token=subscribe7367add7b116969a44e0489ad9da45ca8aea4605' 
```

请求正文，生成的两个请求的标头相同。

这是 nginx 配置文件： [http ://dpaste.org/bOwHO/](http://dpaste.org/bOwHO/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T16:52:03.600

事实证明，我使用的是 TransactionMiddleware，它在调用 model.save() 时不提交给 db，这导致了问题。

# php - 如果通过 Gmail 发送邮件，请勿将邮件保存在“已发送邮件”中

> ID：16214073
> 
> 赞同：0
> 
> 时间：2013-04-25T11:55:47.960
> 
> 标签：php, symfony

使用 Symfony2 很容易将 Gmail 配置为 smtp 提供程序。一个很棒的额外功能是已发送的消息存储在“已发送邮件”文件夹中。

但是对于某些电子邮件，不希望存储它们，例如“忘记密码”电子邮件。我在文档中找不到关于不在“已发送邮件”文件夹中存储消息的任何痕迹。

[http://symfony.com/doc/master/cookbook/email/gmail.html](http://symfony.com/doc/master/cookbook/email/gmail.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:07:17.363

我认为这是 GMail 特有的行为，因为 swiftmailer（symfony 中的邮件程序包）仅使用 SMTP 发送电子邮件，而 SMTP 用于发送邮件而不是存储它们。

将已发送电子邮件存储在已发送文件夹（本地或 IMAP 文件夹）中的任务是 MUA（邮件用户代理，您的电子邮件客户端）而不是服务器的工作。但是，是的，谷歌做自己的事情。

# sql - DB2 SQL 通过评估具有两种类型条目的 ID 过滤查询结果

> ID：16214077
> 
> 赞同：0
> 
> 时间：2013-04-25T11:56:03.080
> 
> 标签：sql, if-statement, db2, case

经过多次尝试，我在这方面失败了，希望有人能提供帮助。该查询返回用户在工厂生产项目时所做的每个条目和订单号。例如

```
Order Number   Entry type  Quantity
3000          1           1000
3000          1           500
3000          2           300
3000          2           100
4000          2           1000
5000          1           1000 
```

我想要查询做的是像这样返回过滤结果

如果订单号具有条目**类型 1 和 2**，则仅返回类型为 1 的行，否则仅返回该订单号的类型。

所以上面会结束：

```
Order Number   Entry type  Quantity
3000          1           1000
3000          1           500
4000          2           1000
5000          1           1000 
```

目前我的查询（DB2，在非常基本的术语中看起来像这样）并且在更改请求通过之前是正确的！

从 type=1 或 type=2 的预订中选择 *

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:06:52.563

```
select * from bookings
    left outer join (
       select order_number,
          max(case when type=1 then 1 else 0 end) + 
             max(case when type=2 then 1 else 0 end) as type_1_and_2
          from bookings
          group by order_number
    ) has_1_and_2 on 
       type_1_and_2 = 2
       has_1_and_2.order_number = bookings.order_number
    where 
        bookings.type = 1 or 
        has_1_and_2.order_number is null 
```

找到所有同时具有类型 1 和类型 2 的订单，然后加入它。

如果该行与连接匹配，则仅在类型为 1 时返回它 如果该行与连接不匹配，`has_type_2.order_number is null`则无论是什么类型都返回它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T22:32:45.787

“[通用表表达式”](http://pic.dhe.ibm.com/infocenter/iseries/v7r1m0/index.jsp?topic=%2Fdb2%2Frbafzintsel.htm) [CTE] 通常可以简化您的逻辑。您可以将其视为将复杂问题分解为概念步骤的一种方法。在下面的示例中，您可以将 g 视为 CTE 的结果集的名称，然后将其连接到

```
 WITH g as
    ( SELECT order_number, min(type) as low_type
        FROM bookings
        GROUP BY order_number
    )
    SELECT b.*
      FROM g 
      JOIN bookings b   ON  g.order_number = b.order_number
                        AND g.low_type     = b.type 
```

JOIN ON 条件将起作用，因此如果两种类型都存在，则 low_type 将为 1，并且仅选择该类型的记录。如果只有一种类型，它将与 low_type 相同。

只要 1 和 2 是预订表中允许的唯一类型，这应该可以正常工作。如果没有，那么您可以简单地在 CTE 和外部 SELECT 中添加 WHERE 子句。

# asp.net - 如果计算机空闲 5 分钟，如何关闭 asp.net 中的会话

> ID：16214079
> 
> 赞同：-1
> 
> 时间：2013-04-25T11:34:09.977
> 
> 标签：asp.net

我正在使用 ASP.NET 开发 Web 应用程序，如果计算机空闲 5 分钟，我想关闭当前用户会话。空闲不仅仅意味着 Web 应用程序，它的完整系统意味着如果 5 分钟内没有从键盘接收到击键。

我通过 Google 获得了一些关于 VC++ 中的空闲跟踪器的信息，但我不知道如何在我的 Web 应用程序中使用该 DLL。链接在这里。

请指导我如何实现这一目标。我想通过 asp.net 获得总的计算机活动时间和空闲时间，以获取我的员工生产力报告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:02:38.170

这将取决于您如何控制会话，但我会查看 web.config 部分

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/Login" timeout="2880" />
</authentication> 
```

这允许您指定超时和超时时返回的视图。

# php - 从 php 执行的 python 脚本给出错误

> ID：16214082
> 
> 赞同：0
> 
> 时间：2013-04-25T11:56:10.983
> 
> 标签：php, python, linux, xampp, debian

在我的 debian 上，我运行 xampp。我想使用 php shell_exec 执行 python 脚本。这是我的 php 代码：

```
shell_exec("/opt/lampp/htdocs/news/hello.py 2>1 &"); 
```

当我从浏览器运行它时，我收到此错误：

```
/usr/bin/python: /opt/lampp/lib/libz.so.1: no version information available (required by /usr/bin/python) 
```

如果我使用这个从终端窗口运行它：`php /opt/lampp/htdocs/page/index.php`它可以正常工作。那么有什么想法可以让它在浏览器上运行吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:14:34.177

我猜 xampp 带有它自己的库而不是使用系统库，这可能意味着它设置`LD_LIBRARY_PATH`为它的本地库目录。

这也会导致其他从 php 启动的程序使用这些库，它们可能不兼容。

为了验证这一点，请尝试`system("env");`，它会向您显示所有导出的环境变量。如果`LD_LIBRARY_PATH`已设置，请使用：

```
shell_exec("LD_LIBRARY_PATH= /opt/lampp/htdocs/news/hello.py 2>1 &"); 
```

这会在运行 python 脚本之前取消设置。

# javascript - 在弹出 div 中重置特定表单

> ID：16214084
> 
> 赞同：0
> 
> 时间：2013-04-25T11:56:17.950
> 
> 标签：javascript, forms, dom, popup, reset

我有一个页面，其中列出了用户以前创建的条目，每个条目都有一个链接，每个条目将调用一个在弹出 div 中打开编辑页面的函数。

编辑页面只包含一个带有更新和重置按钮的表单，但是每当我选择重置按钮以将表单返回到其初始状态时，什么都没有发生。

在过去的几天里，我在网上看了看，试图对可能导致这种情况的原因有更多的了解，但这就像在单击“重置”按钮时调用的 javascript 函数只是忽略了 document.getElementById(form)。 reset() 命令，因为没有返回 javascript 错误。

这是 parent.cfm 上的代码示例

```
<script language="javascript" src="functions.js" type="text/javascript"></script>
<table border="0" cellspacing="5" cellpadding="0" width="850">
<form action="##" method="post" name="parentForm" id="parentForm">
    <input type="hidden" name="formSubmitted" id="formSubmitted" value="1" />
    <tr>
        <td>Label 1</td>
        <td>                
            <select name="field1" id="field1">
                <option value="1">1</option>            
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
        </td>
    </tr>
    <tr>
        <td>Label 2</td>
        <td>                
            <select name="field2" id="field2">
                <option value="1">1</option>            
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
        </td>
    </tr>
    <tr>
        <td>Label 3</td>
        <td><input type="text" name="field3" id="field3" /></td>
    </tr>
    <tr>
        <td>Label 4</td>
        <td>
            <select name="field4" id="field4">
                <option value="1">1</option>                            
                <option value="2">2</option>
                <option value="3">3</option>
            </select>
        </td>
    </tr>
    <tr>
        <td>Label 5</td>
        <td><textarea name="field5" id="field5" rows="10" cols="75"></textarea></td>
    </tr>
    <tr>
        <td><input type="button" name="resetFormBtn" id="resetFormBtn" onClick="resetForm('parentForm');" value="RESET" /></td>
        <td><input type="button" name="formSubmittedBtn" id="formSubmittedBtn" onClick="checkForm('parentForm');" value="ADD" /></td>
    </tr>
</form>
</table>

<cfif qryRecords.RecordCount GT 0>      
<table border="0" cellspacing="5" cellpadding="0" width="850">
    <cfloop query="qryRecords">
        <tr>
            <td>Column Name 1</td>
            <td>#columnName1#</td>
        </tr>
        <tr>
            <td>Column Name 2</td>
            <td>#columnName2#</td>
        </tr>
        <tr>
            <td>Column Name 3</td>
            <td>#columnName3#</td>
        </tr>
        <tr>
            <td>Column Name 4</td>
            <td>#columnName4#</td>
        </tr>
        <tr>
            <td>Column Name 5</td>
            <td>#columnName5#</td>
        </tr>
        <tr>
            <td colspan="2">
                <button name="editRecordBtn" onClick="openPage('childPage.cfm?recordID=#qryRecords.recordID#')">EDIT RECORD</button>
            </td>
            <td colspan="2">
                <form action="##" name="removeRecord" id="removeRecord" method="post">
                    <input type="hidden" name="recordID" value="#qryRecords.recordID#" />
                </form>
                <button name="removeRecordBtn" onClick="document.getElementById('removeRecord').submit();">REMOVE RECORD</button>
            </td>
        </tr>
    </cfloop>
</table>
</cfif> 
```

这是在弹出窗口中打开的 child.cfm：

```
<script language="javascript" src="functions.js" type="text/javascript"></script>
<cfoutput>
<table border="0" cellspacing="5" cellpadding="0" width="850">
    <form action="##" method="post" name="recordEditForm" id="recordEditForm">
        <input type="hidden" name="editFormSubmitted" id="editFormSubmitted" value="1" />
        <tr>
            <td>Label 1</td>
            <td>
                <select name="field1" id="field1">
                    <option value="1" <cfif Form.field1 EQ Variables.field1>selected</cfif>>1</option>          
                    <option value="2" <cfif Form.field1 EQ Variables.field1>selected</cfif>>2</option>
                    <option value="3" <cfif Form.field1 EQ Variables.field1>selected</cfif>>3</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Label 2</td>
            <td>                
                <select name="field2" id="field2">
                    <option value="1" <cfif Form.field2 EQ Variables.field2>selected</cfif>>1</option>          
                    <option value="2" <cfif Form.field2 EQ Variables.field2>selected</cfif>>2</option>
                    <option value="3" <cfif Form.field2 EQ Variables.field2>selected</cfif>>3</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Label 3</td>
            <td><input type="text" name="field3" id="field3" value="#Variables.field3#" /></td>
        </tr>
        <tr>
            <td>Label 4</td>
            <td>
                <select name="field4" id="field4">
                    <option value="1" <cfif Form.field4 EQ Variables.field4>selected</cfif>>1</option>                          
                    <option value="2" <cfif Form.field4 EQ Variables.field4>selected</cfif>>2</option>
                    <option value="3" <cfif Form.field4 EQ Variables.field4>selected</cfif>>3</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Label 5</td>
            <td><textarea name="field5" id="field5" rows="10" cols="75">#Variables.field5#</textarea></td>
        </tr>           
        <tr>
            <td colspan="2">
                <input type="button" name="resetRecordBtn" id="resetRecordBtn" onClick="resetForm('recordEditForm');" value="RESET" />
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <input type="button" name="editRecordBtn" id="editRecordBtn" onClick="checkForm('recordEditForm');" value="EDIT RECORD" />
            </td>
        </tr>
    </form>
</table>
</cfoutput> 
```

这是functions.js中调用的两个函数：

```
function resetForm(formName) {
    var form = formName;
    document.getElementById(form).reset();
}

function openPage(source,width) {
    var source = source;
    var randStr = makeRandString(10);
    var hasQueryString = source.indexOf("?");
    if (hasQueryString > 0) {
        source = source + '&';
    } else {
        source = source + '?';
    }
    source = source + 'rid=' + randStr;
    var align = 'center';
    var top = 80;
    if (width != undefined) {
        var width = width;
    } else {
        var width = 805;
    }
    var padding = 20;
    var disableColor = '#666666';
    var disableOpacity = 40;
    var backgroundColor = '#FFFFFF';
    var borderColor = '#4b8bc8';
    var borderWeight = 2;
    var borderRadius = 5;
    var fadeOutTime = 300;
    var loadingImage = '/resources/images/layout/loading2.gif';
    modalPopup(align, top, width, padding, disableColor, disableOpacity, backgroundColor, borderColor, borderWeight, borderRadius, fadeOutTime, source, loadingImage);  
}

function modalPopup(align, top, width, padding, disableColor, disableOpacity, backgroundColor, borderColor, borderWeight, borderRadius, fadeOutTime, url, loadingImage){

var containerid = "innerModalPopupDiv";

var popupDiv = document.createElement('div');
var popupMessage = document.createElement('div');
var blockDiv = document.createElement('div');

popupDiv.setAttribute('id', 'outerModalPopupDiv');
popupDiv.setAttribute('class', 'outerModalPopupDiv');

popupMessage.setAttribute('id', 'innerModalPopupDiv');
popupMessage.setAttribute('class', 'innerModalPopupDiv');

blockDiv.setAttribute('id', 'blockModalPopupDiv');
blockDiv.setAttribute('class', 'blockModalPopupDiv');
blockDiv.setAttribute('onClick', 'closePopup(' + fadeOutTime + ')');

document.body.appendChild(popupDiv);
popupDiv.appendChild(popupMessage);
document.body.appendChild(blockDiv);

if (/MSIE (\d+\.\d+);/.test(navigator.userAgent)){ //test for MSIE x.x;
 var ieversion=new Number(RegExp.$1) // capture x.x portion and store as a number
   if(ieversion>6) {
     getScrollHeight(top);
   }
} else {
  getScrollHeight(top);
}

document.getElementById('outerModalPopupDiv').style.display='block';
document.getElementById('outerModalPopupDiv').style.width = width + 'px';
document.getElementById('outerModalPopupDiv').style.padding = borderWeight + 'px';
document.getElementById('outerModalPopupDiv').style.background = borderColor;
document.getElementById('outerModalPopupDiv').style.borderRadius = borderRadius + 'px';
document.getElementById('outerModalPopupDiv').style.MozBorderRadius = borderRadius + 'px';
document.getElementById('outerModalPopupDiv').style.WebkitBorderRadius = borderRadius + 'px';
document.getElementById('outerModalPopupDiv').style.borderWidth = 0 + 'px';
document.getElementById('outerModalPopupDiv').style.position = 'absolute';
document.getElementById('outerModalPopupDiv').style.zIndex = 100;

document.getElementById('innerModalPopupDiv').style.padding = padding + 'px';
document.getElementById('innerModalPopupDiv').style.background = backgroundColor;
document.getElementById('innerModalPopupDiv').style.borderRadius = (borderRadius - 3) + 'px';
document.getElementById('innerModalPopupDiv').style.MozBorderRadius = (borderRadius - 3) + 'px';
document.getElementById('innerModalPopupDiv').style.WebkitBorderRadius = (borderRadius - 3) + 'px';

document.getElementById('blockModalPopupDiv').style.width = 100 + '%';
document.getElementById('blockModalPopupDiv').style.border = 0 + 'px';
document.getElementById('blockModalPopupDiv').style.padding = 0 + 'px';
document.getElementById('blockModalPopupDiv').style.margin = 0 + 'px';
document.getElementById('blockModalPopupDiv').style.background = disableColor;
document.getElementById('blockModalPopupDiv').style.opacity = (disableOpacity / 100);
document.getElementById('blockModalPopupDiv').style.filter = 'alpha(Opacity=' + disableOpacity + ')';
document.getElementById('blockModalPopupDiv').style.zIndex = 99;
document.getElementById('blockModalPopupDiv').style.position = 'fixed';
document.getElementById('blockModalPopupDiv').style.top = 0 + 'px';
document.getElementById('blockModalPopupDiv').style.left = 0 + 'px';

if(align=="center") {
    document.getElementById('outerModalPopupDiv').style.marginLeft = (-1 * (width / 2)) + 'px';
    document.getElementById('outerModalPopupDiv').style.left = 50 + '%';
} else if(align=="left") {
    document.getElementById('outerModalPopupDiv').style.marginLeft = 0 + 'px';
    document.getElementById('outerModalPopupDiv').style.left = 10 + 'px';
} else if(align=="right") {
    document.getElementById('outerModalPopupDiv').style.marginRight = 0 + 'px';
    document.getElementById('outerModalPopupDiv').style.right = 10 + 'px';
} else {
    document.getElementById('outerModalPopupDiv').style.marginLeft = (-1 * (width / 2)) + 'px';
    document.getElementById('outerModalPopupDiv').style.left = 50 + '%';
}

blockPage();

var page_request = false;
if (window.XMLHttpRequest) {
    page_request = new XMLHttpRequest();
} else if (window.ActiveXObject) {
    try {
        page_request = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e) {
        try {
            page_request = new ActiveXObject("Microsoft.XMLHTTP");
        } catch (e) { }
    }
} else {
    return false;
}

page_request.onreadystatechange=function(){
    if((url.search(/.jpg/i)==-1) && (url.search(/.jpeg/i)==-1) && (url.search(/.gif/i)==-1) && (url.search(/.png/i)==-1) && (url.search(/.bmp/i)==-1)) {
        pageloader(page_request, containerid, loadingImage);
    } else {
        imageloader(url, containerid, loadingImage);
    }
}

page_request.open('GET', url, true);
page_request.send(null);

} 
```

重置此表单的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:04:35.717

使用[输入类型复位](http://www.w3schools.com/tags/att_input_type.asp)

```
<input type="reset" value="reset button" /> 
```

# asp.net-mvc-4 - Dbcontext with using-clause in Asp.Net Json-Call

> ID：16214085
> 
> 赞同：2
> 
> 时间：2013-04-25T11:56:26.370
> 
> 标签：asp.net-mvc-4, entity-framework-4, dbcontext, jsonresult

I ran into a problem when switching from the Local Development Server to the Local IIS Server (ASP.NET MVC4) using the following Controller-Method:

```
 public JsonResult GetJsonData(string Context, string Language)  
    {
       using (KeyValueDBContext db = new KeyValueDBContext())
       {

            var entries = from u in db.KeyValues
                          where ((u.Context == Context) && (u.Language == Language))
                          select u;

            return Json(entries, JsonRequestBehavior.AllowGet);
      }

   } 
```

Using the local server, I received data when calling the method from Javascript without a problem. The method retrieves a collection of basically Key-Value pairs from a database repository and sends them to the client). After switching to IIS I got an Exception telling me that the dbcontext had already been disposed of (although the using clause ends after the return-statement). (NB: Visual Studio also was not able to find JSONSerializer.cs for some reason, but only when the error occurred). Switching to the following version solved the problem completely:

```
public JsonResult GetJsonData(string Context, string Language)   
    {
        KeyValueDBContext db = new KeyValueDBContext();
        var entries = from u in db.KeyValues
                     where ((u.Context == Context) && (u.Language == Language))
                     select u;

        return Json(entries, JsonRequestBehavior.AllowGet);
   } 
```

In both cases, this was the using-block:

```
 using System;
  using System.Collections.Generic;
  using System.Data;
  using System.Data.Entity;
  using System.Linq;
  using System.Web;
  using System.Web.Mvc;
  using beepov4.Models; // project-models 
```

My question: Is this an acceptable way to use dbcontext for the purpose of JSON-calls (and dropping the using-clause) or is there a particular downside or hidden problem I should be aware of?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T14:27:06.160

Try reading the `entries` into memory with `entries.ToList()` before passing them to `Json()`:

```
using (KeyValueDBContext db = new KeyValueDBContext())
{
        var entries = from u in db.KeyValues
                      where ((u.Context == Context) && (u.Language == Language))
                      select u;

        return Json(entries.ToList(), JsonRequestBehavior.AllowGet);
} 
```

# maven - 通过maven创建zip文件时如何排除一些文件夹

> ID：16214086
> 
> 赞同：16
> 
> 时间：2013-04-25T11:56:28.433
> 
> 标签：maven, maven-assembly-plugin

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembl/1.1.0 http://maven.apache.org/xsd/assembly-1.1.0.xsd">
    <id>bin</id>
    <baseDirectory>/</baseDirectory>
    <formats>
      <format>zip</format>
    </formats>
    <fileSets>
      <fileSet>
         <directory>src/main</directory>
         <outputDirectory>/</outputDirectory>
         <excludes>
            <exclude>src/main/dml</exclude>
         </excludes>
      </fileSet>
    </fileSets>
    </assembly> 
```

这是我的 assemble.xml。**src/main**包含几个文件夹。我想**排除**一些文件夹，比如**src/main/dml**，但它没有被排除。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-25T12:26:40.287

试试这个排除：

```
 <excludes>
            <exclude>src/main/dml/**</exclude>
  </excludes> 
```

匹配文件夹及其子文件夹的所有内容

更新：哦，对不起，你的排除是相对于你的目录的，所以你想要的是

```
 <excludes>
            <exclude>dml/**</exclude>
  </excludes> 
```

# haskell - 如何生成随机的类型化函数

> ID：16214093
> 
> 赞同：19
> 
> 时间：2013-04-25T11:56:47.077
> 
> 标签：haskell, typechecking

我想以编程方式生成随机 Haskell 函数并评估它们。在我看来，这样做的唯一方法是基本上以编程方式生成 Haskell 代码并使用 GHC API 或外部进程运行它，返回一个字符串，并将其解析回 Haskell 数据类型。这是真的？

我的推理如下。这些函数是多态的，所以我不能使用 Typeable。更重要的是，即使我编写自己的类型检查器并用其类型注释每个函数，我也无法向 Haskell 编译器证明我的类型检查器是正确的。例如，当我从一个异构函数集合中提取两个函数并将一个函数应用到另一个时，我需要向编译器提供保证，即我用来选择这些函数的函数只选择具有相应类型的函数。但是没有办法做到这一点，对吧？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-25T16:43:19.563

DarkOtter 的评论提到了 QuickCheck`Arbitrary`和`CoArbitrary`类，这当然是您应该尝试的第一件事。QuickCheck 有这个实例：

```
instance (CoArbitrary a, Arbitrary b) => Arbitrary (a -> b) where ... 
```

碰巧的是，我昨天刚刚阅读了 QuickCheck 代码以了解它是如何工作的，所以我可以分享我所学到的知识，而我的脑海中还很新鲜。QuickCheck 是围绕一个看起来像这样的类型构建的（这不会完全相同）：

```
type Size = Int

-- | A generator for random values of type @a@.
newtype Gen a = 
    MkGen { -- | Generate a random @a@ using the given randomness source and
            -- size. 
            unGen :: StdGen -> Size -> a 
          }

class Arbitrary a where
    arbitrary :: a -> Gen a 
```

第一个技巧是 QuickCheck 有一个像这样工作的函数（我没有弄清楚它是如何实现的）：

```
-- | Use the given 'Int' to \"perturb\" the generator, i.e., to make a new
-- generator that produces different pseudorandom results than the original.
variant :: Int -> Gen a -> Gen a 
```

然后他们用它来实现这个`CoArbitrary`类的各种实例：

```
class CoArbitrary a where
    -- | Use the given `a` to perturb some generator.
    coarbitrary :: a -> Gen b -> Gen b

-- Example instance: we just treat each 'Bool' value as an 'Int' to perturb with.
instance CoArbitrary Bool where
    coarbitrary False = variant 0
    coarbitrary True = variant 1 
```

现在有了这些部分，我们想要这个：

```
instance (Coarbitrary a, Arbitrary b) => Arbitrary (a -> b) where
    arbitrary = ... 
```

我不会写出实现，但想法是这样的：

1.  使用`CoArbitrary`instance of`a`和`Arbitrary`instance of`b`我们可以创建`\a -> coarbitrary a arbitrary`具有 type的函数`a -> Gen b`。
2.  请记住，它`Gen b`是 的`StdGen -> Size -> b`新类型，因此该类型`a -> Gen b`与 同构`a -> StdGen -> Size -> b`。
3.  我们可以简单地编写一个函数，它接受后一种类型的任何函数并切换参数顺序以返回一个类型为 的函数`StdGen -> Size -> a -> b`。
4.  这个重新排列的类型与 同构`Gen (a -> b)`，所以瞧，我们将重新排列的函数打包到 a`Gen`中，我们得到了随机函数生成器！

我建议您阅读 QuickCheck 的源代码以亲自查看。当你解决这个问题时，你只会遇到两个可能会让你慢下来的额外细节。首先，Haskell`RandomGen`类有这个方法：

```
-- | The split operation allows one to obtain two distinct random generators.
split :: RandomGen g => g -> (g, g) 
```

该操作在 for 的`Monad`实例中使用`Gen`，并且相当重要。这里的技巧之一是它`StdGen`是一个纯伪随机数生成器；可行的方法`Gen (a -> b)`是，对于`a`我们扰动`b`生成器的每个可能值，使用该扰动生成器来生成`b`结果，但是我们**永远不会推进扰动生成器的状态**；基本上生成的`a -> b`函数是一个伪随机种子的闭包，每次我们用一些调用它时，`a`我们使用特定`a`的来确定性地创建一个新的种子，然后使用它来确定性地生成一个`b`依赖于`a`和隐藏的种子。

缩写类型`Seed -> a -> b`或多或少总结了正在发生的事情——伪随机函数是`b`从伪随机种子和`a`. 这不适用于命令式的有状态随机数生成器。

`(a -> StdGen -> Size -> b) -> StdGen -> Size -> a -> b`第二： QuickCheck 代码没有像我上面描述的那样直接具有函数，而是具有`promote :: Monad m => m (Gen a) -> Gen (m a)`，这是对 any 的概括`Monad`。`m`的函数实例是什么时候`Monad`，`promote`与 重合`(a -> Gen b) -> Gen (a -> b)`，所以真的和我上面画的一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-26T02:17:36.237

感谢上面非常彻底的答案！没有任何回应，但完全符合我的要求。我在问题的评论中跟进了 DarkOtter 的建议，并`unsafeCoerce`避免使用类型检查器。基本思想是我们创建一个 GADT，将 Haskell 函数与其类型打包在一起；我使用的类型系统非常接近 Mark P. Jones 的[“在 Haskell 中键入 Haskell”。](http://web.cecs.pdx.edu/~mpj/thih/)每当我想要一组 Haskell 函数时，我首先将它们强制转换为`Any`类型，然后做我需要做的事情，将它们随机拼接在一起。当我去评估新函数时，我首先将它们强制转换回我想要的类型。当然，这是不安全的。如果我的类型检查器是错误的，或者我用不正确的类型注释了 haskell 函数，那么我最终会胡说八道。

我已经粘贴了我在下面测试过的代码。请注意，有两个本地模块被导入`Strappy.Type`，并且`Strappy.Utils`. 首先是上面提到的类型系统。第二个为随机程序引入了助手。

注意：在下面的代码中，我使用组合逻辑作为基本语言。这就是为什么我的表达式语言只有应用程序而没有变量或 lambda 抽象的原因。

```
{-# Language GADTs,  ScopedTypeVariables   #-}

import Prelude hiding (flip)
import qualified  Data.List as List
import Unsafe.Coerce (unsafeCoerce) 
import GHC.Prim
import Control.Monad
import Control.Monad.State
import Control.Monad.Trans
import Control.Monad.Identity
import Control.Monad.Random

import Strappy.Type
import Strappy.Utils (flip)

-- | Helper for turning a Haskell type to Any. 
mkAny :: a -> Any
mkAny x = unsafeCoerce x 

-- | Main data type. Holds primitive functions (Term), their
-- application (App) and annotations.
data Expr a where
    Term :: {eName  :: String, 
             eType  :: Type, 
             eThing :: a} -> Expr a
    App  :: {eLeft  :: (Expr (b -> a)),
             eRight :: (Expr b),
             eType  :: Type}         ->  Expr a 

-- | smart constructor for applications
a <> b = App a b (fst . runIdentity . runTI $ typeOfApp a b)

instance Show (Expr a)   where
    show Term{eName=s} = s
    show App{eLeft=el, eRight=er} = "(" ++ show el ++ " " ++  show er ++ ")"

-- | Return the resulting type of an application. Run's type
-- unification.
typeOfApp :: Monad m => Expr a -> Expr b -> TypeInference  m Type
typeOfApp e_left e_right 
    = do t <- newTVar Star 
         case mgu (eType e_left) (eType e_right ->- t) of 
           (Just sub) -> return $ toType (apply sub (eType e_left))
           Nothing -> error $ "typeOfApp: cannot unify " ++
                      show e_left ++ ":: " ++ show (eType e_left) 
                               ++ " with " ++ 
                      show e_right ++ ":: " ++ show (eType e_right ->- t) 

eval :: Expr a -> a
eval Term{eThing=f} = f
eval App{eLeft=el, eRight=er} = (eval el) (eval er)

filterExprsByType :: [Any] -> Type -> TypeInference [] Any
filterExprsByType (e:es) t  
    = do et <- freshInst (eType (unsafeCoerce e :: Expr a))
         let e' = unsafeCoerce e :: Expr a
         case mgu et t of
           Just sub -> do let eOut = unsafeCoerce e'{eType = apply sub et} :: Any
                          return eOut `mplus` rest
           Nothing -> rest
      where rest = filterExprsByType es t
filterExprsByType [] t = lift []

----------------------------------------------------------------------
-- Library of functions

data Library = Library { probOfApp :: Double, -- ^ probability of an expansion
                         libFunctions :: [Any] }

cInt2Expr :: Int -> Expr Int
-- | Convert numbers to expressions. 
cInt2Expr i = Term (show i) tInt i 

--  Some basic library entires. 
t = mkTVar 0                  
t1 = mkTVar 1                  
t2 = mkTVar 2                  
t3 = mkTVar 3                  

cI = Term "I" (t ->- t) id
cS = Term "S" (((t2 ->- t1 ->- t) ->- (t2 ->- t1) ->- t2 ->- t)) $ \f g x -> (f x) (g x)
cB = Term "B" ((t1 ->- t) ->- (t2 ->- t1) ->- t2 ->- t) $ \f g x -> f (g x)
cC = Term "C" ((t2 ->- t1 ->- t2 ->- t) ->- t1 ->- t2 ->- t) $ \f g x -> (f x) g x
cTimes :: Expr (Int -> Int -> Int)
cTimes = Term "*" (tInt ->- tInt ->- tInt) (*)
cPlus :: Expr (Int -> Int -> Int)
cPlus = Term "+" (tInt ->- tInt ->- tInt) (+)
cCons = Term ":"  (t ->- TAp tList t ->- TAp tList t)  (:)
cAppend = Term "++" (TAp tList t ->- TAp tList t ->- TAp tList t) (++)
cHead = Term "head" (TAp tList t ->- t) head
cMap = Term "map" ((t ->- t1) ->- TAp tList t ->- TAp tList t1) map
cEmpty = Term "[]" (TAp tList t) []
cSingle = Term "single" (t ->- TAp tList t) $ \x -> [x]
cRep = Term "rep" (tInt ->- t ->- TAp tList t) $ \n x -> take n (repeat x)
cFoldl = Term "foldl" ((t ->- t1 ->- t) ->- t ->- (TAp tList t1) ->- t) $ List.foldl'
cNums =  [cInt2Expr i | i <- [1..10]]

--  A basic library

exprs :: [Any]
exprs = [mkAny cI, 
         mkAny cS, 
         mkAny cB, 
         mkAny cC, 
         mkAny cTimes, 
         mkAny cCons, 
         mkAny cEmpty,
         mkAny cAppend,
--         mkAny cHead,
         mkAny cMap,
         mkAny cFoldl,
         mkAny cSingle,
         mkAny cRep
        ] 
        ++ map mkAny cNums

library = Library 0.3 exprs

-- | Initializing a TypeInference monad with a Library. We need to
-- grab all type variables in the library and make sure that the type
-- variable counter in the state of the TypeInference monad is greater
-- that that counter.
initializeTI :: Monad m => Library -> TypeInference m ()
initializeTI Library{libFunctions=es} = do put (i + 1)
                                           return ()
    where go n (expr:rest) = let tvs = getTVars (unsafeCoerce expr :: Expr a)
                                 getTVars expr = tv . eType $ expr
                                 m = maximum $ map (readId . tyVarId) tvs 
                             in if null tvs then 0 else go (max n m) rest
          go n [] = n
          i = go 0 es

----------------------------------------------------------------------
----------------------------------------------------------------------
-- Main functions. 
sampleFromExprs :: (MonadPlus m, MonadRandom m) =>
                   Library -> Type -> TypeInference  m (Expr a)
-- | Samples a combinator of type t from a stochastic grammar G. 
sampleFromExprs lib@Library{probOfApp=prApp, libFunctions=exprs} tp 
    = do initializeTI lib
         tp' <- freshInst tp
         sample tp'
    where sample tp = do
            shouldExpand <- flip prApp
            case shouldExpand of
              True -> do t <- newTVar Star
                         (e_left :: Expr (b -> a))  <- unsafeCoerce $ sample (t ->- tp)
                         (e_right :: Expr b) <- unsafeCoerce $ sample (fromType (eType e_left))
                         return $ e_left <> e_right -- return application
              False -> do let cs = map fst . runTI $ filterExprsByType exprs tp
                          guard (not . null $ cs) 
                          i <- getRandomR (0, length cs - 1)
                          return $ unsafeCoerce (cs !! i) 

----------------------------------------------------------------------
----------------------------------------------------------------------

main = replicateM 100 $ 
       do let out =  runTI $ do sampleFromExprs library (TAp tList tInt) 
          x <- catch (liftM (Just . fst)  out)
                     (\_ -> putStrLn "error" >> return Nothing)                       
          case x of 
            Just y  -> putStrLn $ show x ++ " " ++ show (unsafeCoerce (eval y) :: [Int])
            Nothing  -> putStrLn "" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T13:03:55.337

这些方面的东西会满足您的需求吗？

```
import Control.Monad.Random

randomFunction :: (RandomGen r, Random a, Num a, Floating a) => Rand r (a -> a)
randomFunction = do
  (a:b:c:d:_) <- getRandoms
  fromList [(\x -> a + b*x, 1), (\x -> a - c*x, 1), (\x -> sin (a*x), 1)]
    -- Add more functions as needed

main = do
  let f = evalRand randomFunction (mkStdGen 1) :: Double -> Double
  putStrLn . show $ f 7.3 
```

* * *

**编辑：**基于这个想法，我们可以合并具有不同数量和类型的参数的函数......只要我们部分应用它们，以便它们都具有相同的结果类型。

```
import Control.Monad.Random

type Value = (Int, Double, String) -- add more as needed

type Function = Value -> String -- or whatever the result type is

f1 :: Int -> Int -> (Int, a, b) -> Int
f1 a b (x, _, _) = a*x + b

f2 :: String -> (a, b, String) -> String
f2 s (_, _, t) = s ++ t

f3 :: Double -> (a, Double, b) -> Double
f3 a (_, x, _) = sin (a*x)

randomFunction :: RandomGen r => Rand r Function
randomFunction = do
  (a:b:c:d:_) <- getRandoms -- some integers
  (w:x:y:z:_) <- getRandoms -- some floats
  n <- getRandomR (0,100)
  cs <- getRandoms -- some characters
  let s = take n cs 
  fromList [(show . f1 a b, 1), (show . f2 s, 1), (show . f3 w, 1)]
    -- Add more functions as needed

main = do
  f <- evalRandIO randomFunction :: IO Function
  g <- evalRandIO randomFunction :: IO Function
  h <- evalRandIO randomFunction :: IO Function
  putStrLn . show $ f (3, 7.3, "hello")
  putStrLn . show $ g (3, 7.3, "hello")
  putStrLn . show $ h (3, 7.3, "hello") 
```

# multithreading - 使用 PBO 和 VBO

> ID：16214095
> 
> 赞同：0
> 
> 时间：2013-04-25T11:56:53.877
> 
> 标签：multithreading, opengl, fbo, pbo

我的应用程序（QT/OpenGL）需要以 25fps 的速度从 IP camaras 上传一堆视频，然后处理它应用：

1.  对于每个视频，一个去马赛克滤镜、锐化滤镜、LUT 和失真文档。
2.  然后我需要在opengl（纹理投影等）中进行渲染，选择之前处理的一个或多个帧
3.  然后我需要将结果显示给一些小部件（QGLWidget）并读取像素以写入电影文件。

我试图了解 PBO 和 FBO 的优缺点，并描绘了以下架构，我想在您的帮助下进行验证：

*   我为每个视频创建一个线程，以在缓冲区（图像数组）中捕获。有一个视频缓冲区。
*   我创建了一个 Upload-filter-render 线程，其目的是：a）将帧上传到 GPU，b）将过滤器应用到 GPU，c）应用合成并渲染到纹理
*   我让 GUI 线程在我的小部件中呈现上一步中创建的纹理。

对于*Upload-Frames-to-GPU*过程，我想最好的方法是对每个视频使用 PBO（可能是两个 PBOS）来异步加载帧。

对于*Apply-Filter-info-GPU*，我想使用 FBO，这似乎是渲染到纹理的最佳选择。我会先绑定PBO上传的纹理，然后渲染到另一个纹理，过滤后的图像。我不确定只使用一个 FBO 并根据视频上传更改绑定纹理输入和绑定纹理目标，或者使用与要上传的视频一样多的 FBOS。

最后，为了将结果显示到小部件中，我使用了 FBO 渲染的最终纹理。为了写入电影文件，我使用 PBO 将像素从 GPU 异步复制回 CPU。

看起来正确吗？

# objective-c - 查找三角形排列的点的迭代公式

> ID：16214097
> 
> 赞同：0
> 
> 时间：2013-04-25T11:56:55.723
> 
> 标签：objective-c, loops, cocos2d-iphone, iteration

我想使用 for 循环在以下几点安排我的精灵：

```
ccp(240.0, 160.0);
ccp(300.0, 120.0);
ccp(300.0, 200.0);
ccp(360.0, 80.0);
ccp(360.0, 160.0);
ccp(360.0, 240.0); 
```

我正在尝试使用 for 循环为这些点获取迭代公式。我已经有一段时间了。下面是点的视觉表示。请帮忙。

```
 *

    *

*       *

    *

        * 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T18:16:15.007

这是一种方法：

我没有花几分钟的时间去想它，但是如果你从最大的一行开始往下走，它会更容易：

**模式测试.h**

```
#import "cocos2d.h"
@interface PatternTest : CCLayer
@end 
```

**模式测试.m**

```
@implementation PatternTest
-(id) init
{
    if( (self=[super init]))
    {
        CCNode *grid = [self generateArrowPatternWithBaseRowOfNumSprites:5 spacedApart:ccp(25.0f, 25.0f)];
        [grid setPosition:ccp(50.0f,50.0f)];
        [self addChild:grid];

    }

    return self;
}

-(CCNode *) generateArrowPatternWithBaseRowOfNumSprites:(float) numSprites spacedApart:(CGPoint) space
{
    CCNode* patternNode = [CCNode node];
    CGPoint tempPos = ccp(0.0f, 0.0f);
    float offset = 0.0f;
    while (numSprites > 0)
    {
        for(int x=numSprites;x>0;x--)
        {
            CCSprite *patternSprite = [CCSprite spriteWithFile:@"Icon.png"];
            [patternSprite setScale: 0.3f];
            [patternSprite setPosition: tempPos];
            [patternNode addChild:patternSprite];
            tempPos = ccpAdd(tempPos, ccp(0.0f,space.y));
        }

        tempPos = ccp(tempPos.x, 0.0f);
        offset = offset + (space.y / 2.0f);
        tempPos = ccpAdd(tempPos, ccp(space.x, offset));
        numSprites -= 1;
    }
    return patternNode;
}
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T16:32:24.167

你想要这样的东西吗？（它只是一个快速的草图）

假设初始参数：

```
initPoint (x0, y0)

initVector (vX,vY)

num of iteration c

index = c

while index

 for(j = index, currentPoint = initPoint+(c-index)*(0,2*vY); j;j--, currentPoint += initVector)
    draw currentPoint

index-- 
```

基本上，主要思想是，您从右上角开始，并随着迭代保持（到左下角）并绘制点，多次使用初始向量移动绘图的上下文。然后将初始点沿 y 轴向下移动并重复负一次。

# cuda - CUDA 计算和复制引擎队列限制

> ID：16214101
> 
> 赞同：4
> 
> 时间：2013-04-25T11:57:06.167
> 
> 标签：cuda

我似乎遇到了可以在计算引擎队列中排队的异步内核启动数量的限制。在此限制之后，主机被阻塞，GPU-CPU 并发丢失。这在 CUDA 编程指南中没有提到。

*   可以在计算引擎队列中排队的异步内核启动的最大数量是多少？
*   这个最大数量是否在某种程度上取决于正在启动的内核？
*   CPU 将内核启动放入计算引擎队列所需的时间是否取决于正在启动的内核？
*   可以在复制引擎队列中排队的异步 memcpy 的最大数量是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T15:58:26.713

我不确定这个问题是否有一个通用的答案，在某种程度上它是平台和 CUDA 版本特定的 AFAIK。回答你的要点

*   我相信，限制是队列大小，因此有最大数量的队列操作而不是内核启动。相同的总限制应适用于内核、复制操作和流事件的任何组合。操作总数取决于平台和 CUDA 版本
*   不
*   不，但是一旦驱动队列被填满，提交任何异步操作所花费的时间将大大增加
*   见第一点。我不相信驱动程序区分副本、内核启动或事件。

我记得在 CUDA 2.1 左右进行了一些基准测试，发现一切都运行得很快，直到 24 个操作已排队，然后后续操作排队所需的时间变慢。到 CUDA 3.0 发布时，我没有任何代码可以达到旧版本中存在的限制，因此发生了一些变化。编写一个基准来检查更现代的 CUDA 版本的功能应该是微不足道的。

# c# - TransactionScope Complete() 在退出 USING 语句之前不提交事务

> ID：16214102
> 
> 赞同：11
> 
> 时间：2013-04-25T11:57:08.080
> 
> 标签：c#, .net, transactionscope

我遇到了这种奇怪的行为，只有在`using`退出时才提交事务，而不是在调用时提交`scope.Complete();`

```
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.RequiresNew))
       {
        scope.Complete();
           // data still doesn't show in db
       }
       // now shows in db 
```

如何在退出`using`语句之前提交事务？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T12:04:26.193

从[文档](http://msdn.microsoft.com/en-gb/library/system.transactions.transactionscope.complete.aspx)：

> 如果 TransactionScope 对象创建了事务，则资源管理器之间的实际提交工作发生在**End Using语句中。**

所以看起来你不能在 using 语句结束之前真正提交事务。

# sql - PL/SQL 触发器，用于在插入、更新、删除后将数据输入到具有序列的日志表中

> ID：16214107
> 
> 赞同：3
> 
> 时间：2013-04-25T11:57:14.877
> 
> 标签：sql, oracle, plsql, triggers

我正在处理一个家庭作业问题。我的触发器遇到编译问题，并且无法理解如何创建引用序列和另一个表的触发器，并将这些值插入到我创建的日志表中。[我已经读过，在 Table 列条目上使用 SERIAL not null 可能会消除对序列和引用 table 的](http://www.dbforums.com/informix/1628545-create-sequence-create-trigger.html)需要，但我需要它来完成我的作业。

我需要一些帮助来弄清楚如何让我的触发器编译。我的绑定变量有问题：序列中的新，以及从另一个表插入的 idpay 值。我不确定我的声明是否正确，并且 BEGIN 语句之后的前两个语句是否正确，因为第一行被标记为编译错误。 [我认为这个示例发生了一些事情，并且我在 IF 语句中缺少 NULL 值条目，但不确定将该部分放在我的编码中的哪个位置。](http://www.razorsql.com/features/oracle_add_sequence_trigger.html)

当然还有[Oracle 11g Reference Doc for Triggers，我已经看过了，但您也可以自己查看。](http://docs.oracle.com/cd/E18283_01/appdev.112/e17126/triggers.htm#)

这是设置问题： 1\. 使用捐赠数据库。该组织希望跟踪所有质押支付活动。每次添加、更改或删除质押付款时，应在单独的表中捕获以下信息：用户名、当前日期、采取的操作（INSERT、UPDATE 或 DELETE）以及支付记录的 idpay 值。

创建一个名为 DD_PAYTRACK 的表来保存此信息。包括要由序列填充的主键列，并为主键列创建名为 DD_PTRACK_SEQ 的新序列。

创建一个触发器来记录请求的信息以跟踪质押支付活动，并测试 idpay=1470 的所有操作类型的触发器。使用 SELECT 语句显示 DD_PAYTRACK 表中的记录。

```
select * from dd_paytrack;

IDTRACK    PTUSER        PTDATE       PTACTION       PTPAYID                
4          AAX5367E220   10-DEC-12     INSERT        1470                   
5          AAX5367E220   10-DEC-12     UPDATE            1470                   
6          AAX5367E220   10-DEC-12     DELETE        1470 
```

这是我到目前为止所做的，即使在添加了这些插入、更新和删除语句之后，它仍然返回一个空表，但是由于下面的答案，我已经修复了建议的内容。

****我修复了它，我必须在编译触发器后添加我自己的更新、插入和删除语句。现在效果很好。谢谢诺尔！！！****

```
 DROP TABLE dd_paytrack;
    DROP SEQUENCE idtrack_seq;

    CREATE TABLE dd_paytrack(
    idtrack         NUMBER,
    pt_user         VARCHAR2(30),
    pt_date         DATE,
    pt_action       VARCHAR2(30),
    pt_payid        NUMBER(6,0),
    CONSTRAINT pk_dd_paytrack PRIMARY KEY (idtrack)
    );

    CREATE SEQUENCE idtrack_seq;

    CREATE OR REPLACE TRIGGER pledge_pay_trigger
      AFTER 
        INSERT OR 
        UPDATE OR 
        DELETE 
      ON dd_payment
      FOR EACH ROW  
    DECLARE
      log_action  dd_paytrack.pt_action%TYPE; 
      id_pay      dd_paytrack.pt_payid%TYPE;    
    BEGIN
    id_pay := :NEW.idpay;
    IF INSERTING THEN
    log_action := 'Insert';
    ELSIF UPDATING THEN
    log_action := 'Update';
    ELSIF DELETING THEN
    id_pay := :OLD.idpay;
    log_action := 'Delete';
    ELSE
    DBMS_OUTPUT.PUT_LINE('This code is not reachable.');
    END IF;

    INSERT INTO dd_paytrack (idtrack, pt_user, pt_date, pt_action, pt_payid)
      VALUES(idtrack_seq.NEXTVAL, USER, TO_CHAR(SYSDATE, 'DD-MON-YY'), log_action,      
    id_pay);

    END pledge_pay_trigger;
    /

   INSERT INTO dd_payment(idpay, idpledge, payamt, paydate, paymethod)
    VALUES (1470, 105, 250, SYSDATE, 'CC');
    commit;  

    UPDATE dd_payment
    SET payamt = 25
    WHERE idpay = 1470;
    commit;

    UPDATE dd_payment 
    SET payamt = 2000
    WHERE idpay = 1470;
    COMMIT;

    DELETE 
    FROM dd_payment
    WHERE idpay = 1470;
    COMMIT;

    SET serveroutput ON
    select * from dd_paytrack; 
```

这是捐赠表方案，它为我的作业问题引用了 dd_paytrack 表。我对其进行了测试，该架构在剪切和粘贴后似乎可以正常工作。

```
-- The DoGood Donor Database 
-- A donor, who represents a person or company that has committed to make a donation to             
the DoGood organzation. 

DROP TABLE dd_donor CASCADE CONSTRAINTS;
DROP TABLE dd_project CASCADE CONSTRAINTS;
DROP TABLE dd_status CASCADE CONSTRAINTS;
DROP TABLE dd_pledge CASCADE CONSTRAINTS;
DROP TABLE dd_payment CASCADE CONSTRAINTS;
CREATE TABLE DD_Donor (
    idDonor number(4),
    Firstname varchar2(15),
    Lastname varchar2(30),
                  Typecode CHAR(1),
    Street varchar2(40),
    City varchar2(20),
    State char(2),
    Zip varchar2(9),
    Phone varchar2(10),
    Fax varchar2(10),
    Email varchar2(25),
                  News char(1),
    dtentered date DEFAULT SYSDATE,
    CONSTRAINT donor_id_pk PRIMARY KEY(idDonor) );
CREATE TABLE DD_Project (
                   idProj number(6),
                   Projname varchar2(60),
                   Projstartdate DATE,
                   Projenddate DATE,
                   Projfundgoal number(12,2),
                   ProjCoord varchar2(20),
                   CONSTRAINT project_id_pk PRIMARY KEY(idProj),
                   CONSTRAINT project_name_uk  UNIQUE (Projname)  );      
CREATE TABLE DD_Status (
                   idStatus number(2),
                   Statusdesc varchar2(15),
                   CONSTRAINT status_id_pk PRIMARY KEY(idStatus) );     
CREATE TABLE DD_Pledge (
                   idPledge number(5),
                   idDonor number(4),
                   Pledgedate DATE,
                   Pledgeamt number(8,2),
                   idProj number(5),
                   idStatus number(2),
                   Writeoff number(8,2),
                   paymonths number(3),
                   Campaign number(4),
                   Firstpledge char(1),
                   CONSTRAINT pledge_id_pk PRIMARY KEY(idPledge),
                   CONSTRAINT pledge_idDonor_fk FOREIGN KEY (idDonor)
                           REFERENCES dd_donor (idDonor), 
                   CONSTRAINT pledge_idProj_fk FOREIGN KEY (idProj)
                           REFERENCES dd_project (idProj),
                   CONSTRAINT pledge_idStatus_fk FOREIGN KEY (idStatus)
                           REFERENCES dd_status (idStatus));                   
CREATE TABLE DD_Payment (
                   idPay number(6),
                   idPledge number(5),
                   Payamt number(8,2),
                   Paydate DATE,
                   Paymethod char(2),
                   CONSTRAINT payment_id_pk PRIMARY KEY(idPay),
                   CONSTRAINT pay_idpledge_fk FOREIGN KEY (idPledge)
                           REFERENCES dd_pledge (idPledge) );                   
INSERT INTO dd_donor  
  VALUES (301, 'Mary', 'Treanor', 'I','243 main St.', 'Norfolk',     
'VA','23510',NULL,NULL,'mtrea492@mdv.com','Y','01-SEP-2012');
INSERT INTO dd_donor  
  VALUES (302, 'Patrick', 'Lee', 'I','11 Hooper St.', 'Norfolk',     
'VA','23510','7572115445',NULL,'pleeNorf@gmail.com','N','09-SEP-2012');
INSERT INTO dd_donor  
  VALUES (303, 'Terry', 'Venor', 'I','556 Loop Lane.', 'Chesapeake', 
'VA','23320',NULL,NULL,'tervenr@drw.edu','Y','18-SEP-2012');
INSERT INTO dd_donor  
  VALUES (304, 'Sherry', 'Pane', 'I','Center Blvd.', 'Virginia Beach', 
'VA','23455',NULL,NULL,'toppane@yahoo.com','Y','21-SEP-2012');
INSERT INTO dd_donor  
  VALUES (305, 'Thomas', 'Sheer', 'I','66 Train St.', 'Chesapeake', 
'VA','23322','7579390022',NULL,'tls3488@sheer.com','Y','01-MAR-2013');
INSERT INTO dd_donor  
  VALUES (306, NULL, 'Coastal Developers', 'B','3667 Shore Dr.', 'Virginia Beach', 
'VA','23450','8889220004',NULL,'coastVA@cdev.com','Y','30-SEP-2012');
INSERT INTO dd_donor  
  VALUES (307, NULL, 'VA Community Org', 'G','689 Bush Dr.', 'Norfolk', 
'VA','23513','7578337467','7578337468','vacmorg@biz.com','Y','03-OCT-2012');
INSERT INTO dd_donor  
  VALUES (308, 'Betty', 'Konklin', 'I','11 Shark Ln.', 'Virginia Beach', 
'VA','23455','7574550087',NULL,'shark11@cox.net','N','04-OCT-2012');
INSERT INTO dd_donor  
  VALUES (309, 'Jim', 'Tapp', 'I','200 Pine Tree Blvd.', 'Chesapeake', 
'VA','23320','',NULL,'','N','08-OCT-2012');
INSERT INTO dd_donor  
  VALUES (310, NULL, 'Unique Dezigns', 'B','Connect Circle Unit 12', 'Chesapeake', 
'VA','23320','7574442121',NULL,'UDezigns@cox.net','Y','11-SEP-2012');
INSERT INTO dd_project
  VALUES (500,'Elders Assistance League', '01-SEP-2012','31-OCT-2012',15000,'Shawn 
Hasee');
INSERT INTO dd_project
  VALUES (501,'Community food pantry #21 freezer equipment', '01-OCT-2012','31-DEC-
2012',65000,'Shawn Hasee');
INSERT INTO dd_project
  VALUES (502,'Lang Scholarship Fund', '01-JAN-2013','01-NOV-2013',100000,'Traci 
Brown');
INSERT INTO dd_project
  VALUES (503,'Animal shelter Vet Connect Program', '01-DEC-2012','30-MAR-
2013',25000,'Traci Brown');
INSERT INTO dd_project
  VALUES (504,'Shelter Share Project 2013', '01-FEB-2013','31-JUL-2013',35000,'Traci 
Brown');
INSERT INTO dd_status
  VALUES (10,'Open');
INSERT INTO dd_status
  VALUES (20,'Complete');
INSERT INTO dd_status
  VALUES (30,'Overdue');
INSERT INTO dd_status
  VALUES (40,'Closed');
INSERT INTO dd_status
  VALUES (50,'Hold');
INSERT INTO dd_pledge
   VALUES (100,303,'18-SEP-2012',80,500,20,NULL,0,738,'Y');
INSERT INTO dd_pledge
   VALUES (101,304,'21-SEP-2012',35,500,20,NULL,0,738,'Y');
INSERT INTO dd_pledge
   VALUES (102,310,'01-OCT-2012',500,501,20,NULL,0,749,'Y');
INSERT INTO dd_pledge
   VALUES (103,307,'03-OCT-2012',2000,501,20,NULL,0,749,'N');
INSERT INTO dd_pledge
   VALUES (104,308,'04-OCT-2012',240,501,10,NULL,12,749,'Y');
INSERT INTO dd_pledge
   VALUES (105,309,'08-OCT-2012',120,501,10,NULL,12,749,'Y');
INSERT INTO dd_pledge
   VALUES (106,301,'12-OCT-2012',75,500,20,NULL,0,738,'N');
INSERT INTO dd_pledge
   VALUES (107,302,'15-OCT-2012',1200,501,10,NULL,24,749,'Y');
INSERT INTO dd_pledge
   VALUES (108,308,'20-JAN-2013',480,503,10,NULL,24,790,'N');
INSERT INTO dd_pledge
   VALUES (109,301,'01-FEB-2013',360,503,10,NULL,12,790,'N');
INSERT INTO dd_pledge
   VALUES (110,303,'01-MAR-2013',300,504,10,NULL,12,756,'N');
INSERT INTO dd_pledge
   VALUES (111,306,'01-MAR-2013',1500,504,20,NULL,0,756,'Y');
INSERT INTO dd_pledge
   VALUES (112,309,'16-MAR-2013',240,504,10,NULL,12,756,'N');
INSERT INTO dd_payment
   VALUES (1425,100,80,'18-SEP-2012','CC');
INSERT INTO dd_payment
   VALUES (1426,101,35,'21-SEP-2012','DC');
INSERT INTO dd_payment
   VALUES (1427,102,500,'01-OCT-2012','CH');
INSERT INTO dd_payment
   VALUES (1428,103,2000,'03-OCT-2012','CH');
INSERT INTO dd_payment
   VALUES (1429,106,75,'12-OCT-2012','CC');
INSERT INTO dd_payment
   VALUES (1430,104,20,'01-NOV-2012','CC');
INSERT INTO dd_payment
   VALUES (1431,105,10,'01-NOV-2012','CC');
INSERT INTO dd_payment
   VALUES (1432,107,50,'01-NOV-2012','CC');
INSERT INTO dd_payment
   VALUES (1433,104,20,'01-DEC-2012','CC');
INSERT INTO dd_payment
   VALUES (1434,105,10,'01-DEC-2012','CC');
INSERT INTO dd_payment
  VALUES (1435,107,50,'01-DEC-2012','CC');
INSERT INTO dd_payment
   VALUES (1436,104,20,'01-JAN-2013','CC');
INSERT INTO dd_payment
   VALUES (1437,105,10,'01-JAN-2013','CC');
INSERT INTO dd_payment
   VALUES (1438,107,50,'01-JAN-2013','CC');
INSERT INTO dd_payment
   VALUES (1439,104,20,'01-FEB-2013','CC');
INSERT INTO dd_payment
   VALUES (1440,105,10,'01-FEB-2013','CC');
INSERT INTO dd_payment
   VALUES (1441,107,50,'01-FEB-2013','CC');
INSERT INTO dd_payment
   VALUES (1442,108,20,'01-FEB-2013','CC');
INSERT INTO dd_payment
   VALUES (1443,109,30,'01-FEB-2013','CC');
INSERT INTO dd_payment
   VALUES (1444,104,20,'01-MAR-2013','CC');
INSERT INTO dd_payment
   VALUES (1445,105,10,'01-MAR-2013','CC');
INSERT INTO dd_payment
   VALUES (1446,107,50,'01-MAR-2013','CC');
INSERT INTO dd_payment
   VALUES (1447,108,20,'01-MAR-2013','CC');
INSERT INTO dd_payment
   VALUES (1448,109,30,'01-MAR-2013','CC');
INSERT INTO dd_payment
   VALUES (1449,110,25,'01-MAR-2013','CC');
INSERT INTO dd_payment
   VALUES (1450,111,1500,'01-MAR-2013','CH');
INSERT INTO dd_payment
   VALUES (1451,104,20,'01-APR-2013','CC');
INSERT INTO dd_payment
   VALUES (1452,105,10,'01-APR-2013','CC');
INSERT INTO dd_payment
   VALUES (1453,107,50,'01-APR-2013','CC');
INSERT INTO dd_payment
   VALUES (1454,108,20,'01-APR-2013','CC');
INSERT INTO dd_payment
   VALUES (1455,109,30,'01-APR-2013','CC');
INSERT INTO dd_payment
   VALUES (1456,110,25,'01-APR-2013','CC');
INSERT INTO dd_payment
   VALUES (1457,112,20,'01-APR-2013','CC');
INSERT INTO dd_payment
   VALUES (1458,104,20,'01-MAY-2013','CC');
INSERT INTO dd_payment
   VALUES (1459,105,10,'01-MAY-2013','CC');
INSERT INTO dd_payment
   VALUES (1460,107,50,'01-MAY-2013','CC');
INSERT INTO dd_payment
   VALUES (1461,108,20,'01-MAY-2013','CC');
INSERT INTO dd_payment
   VALUES (1462,109,30,'01-MAY-2013','CC');
INSERT INTO dd_payment
   VALUES (1463,110,25,'01-MAY-2013','CC');
INSERT INTO dd_payment
   VALUES (1464,112,20,'01-MAY-2013','CC');
COMMIT; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:10:54.863

由于您在插入语句中使用序列值，

```
 INSERT INTO dd_paytrack
           (idtrack, pt_user, pt_date,
            pt_action, pt_payid
           )
    VALUES (idtrack_seq.NEXTVAL, USER, TO_CHAR (SYSDATE, 'DD-MON-YY'),
            log_action, id_pay
           ); 
```

无需如下选择。

```
SELECT idtrack_seq.NEXTVAL
 INTO :NEW.idtrack
 FROM DUAL; 
```

此外，您在这一行中漏掉了一个冒号，

```
 id_pay := :OLD.idpay; 
```

编辑：还有一件事，在触发器中有 DBMS_OUTPUT 语句是没有意义的。因为你不会看到它，即使执行到达它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-20T11:59:30.583

PL/SQL 触发器，用于在插入、更新、删除后将数据输入到具有序列的日志表中

```
CREATE OR REPLACE TRIGGER pledge_pay_trigger2
      AFTER 
        INSERT OR 
        UPDATE OR 
        DELETE 
      ON dd_payment
      FOR EACH ROW  
    DECLARE
      log_action  dd_payment2.pt_action%TYPE; 
      id_pay      dd_payment2.idpay%TYPE;    
      id_Pledge   dd_payment2.idPledge%TYPE;    
      Pay_amt     dd_payment2.Payamt%TYPE;    
      Pay_date    dd_payment2.Paydate%TYPE;    
      Pay_method  dd_payment2.Paymethod%TYPE;    

BEGIN
id_pay := :NEW.idpay;
id_Pledge   := :NEW.IDPLEDGE;
Pay_amt     := :NEW.PAYAMT;
Pay_date    := :NEW.PAYDATE;
Pay_method  := :NEW.PAYMETHOD;
IF INSERTING THEN
  log_action := 'Insert';
   INSERT INTO dd_payment2(idpay, idpledge, payamt, paydate, paymethod,pt_action)
    VALUES (id_pay, id_Pledge, Pay_amt, TO_CHAR(Pay_date, 'DD-MON-YY'), Pay_method,log_action);
ELSIF UPDATING THEN
  log_action := 'Update';
  UPDATE DD_PAYMENT2 SET PAYAMT=Pay_amt,PAYDATE=TO_CHAR(Pay_date, 'DD-MON-YY'),pt_action='UPDATE' WHERE idpay=id_pay;
ELSIF DELETING THEN
id_pay := :OLD.idpay;
log_action := 'Delete';
UPDATE DD_PAYMENT2 SET pt_action='DELETE' WHERE idpay=id_pay;        
ELSE
DBMS_OUTPUT.PUT_LINE('This code is not reachable.');
END IF;
END pledge_pay_trigger2;
/

COMMIT;

//    if log_action ='Insert' then
       INSERT INTO dd_payment2(idpay, idpledge, payamt, paydate, paymethod,pt_action)
        VALUES (id_pay, id_Pledge, Pay_amt, TO_CHAR(Pay_date, 'DD-MON-YY'), Pay_method,log_action);
    else if log_action ='Update' then
      UPDATE DD_PAYMENT2 SET PAYAMT=Pay_amt,PAYDATE=TO_CHAR(Pay_date, 'DD-MON-YY'),pt_action='UPDATE' WHERE idpay=id_pay;
    else
      UPDATE DD_PAYMENT2 SET pt_action='DELETE' WHERE idpay=id_pay;        
    end if

     ALTER TABLE DD_PAYMENT2 ADD pt_action VARCHAR2(30 BYTE);

     COMMIT;

        INSERT INTO dd_payment(idpay, idpledge, payamt, paydate, paymethod)
    VALUES (1470, 105, 250, SYSDATE, 'CC');
    commit;  

         UPDATE dd_payment 
    SET payamt = 2000
    WHERE idpay = 1470;
    COMMIT;

        DELETE 
    FROM dd_payment
    WHERE idpay = 1470;
    COMMIT; 
```

# database - hibernate序列，使用具体的序列

> ID：16214116
> 
> 赞同：1
> 
> 时间：2013-04-25T11:57:51.567
> 
> 标签：database, oracle, hibernate, sequence, sequences

今天我负责数据库的老板告诉我，我在 JPA/Hibernate 中使用了错误的序列，但我没有，所以我检查了为什么我生成的表条目的 ID 比正常（触发器）生成的条目更高。
我[在 SO 上发现了这对](https://stackoverflow.com/a/7171829/533967)我来说太可怕了，因为我在数据库触发器中使用这个数据库序列来生成条目。这意味着，据我所知。在 50 倍的时间内，我的数据库将开始访问我的 Java 应用程序生成的序列号。

为了避免这种情况，我需要使用特定的序列，而不是序列*50。但是还没有找到如何做到这一点，任何人都可以帮助我吗？

提前致谢

目前它是这样定义的：

```
@Id
@Column(name = "PVP_COST_ELEMENTS_ID")
@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "wtStatSEQ")
@SequenceGenerator(name = "wtStatSEQ", sequenceName = "warehouse.wt_stat_SEQ") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:38:23.777

在hibernate中，您可以使用注释显式指定使用的seq

```
@Id
@Column(name = "COLUMN_NAME", nullable = false)
@GeneratedValue(strategy = AUTO, generator = "yourEntitySeqGen")
@SequenceGenerator(name = "yourEntitySeqGen", sequenceName = "SEQUENCE_NAME_IN_YOUR_DATABASE") 
```

干杯

# xpath - 如何在 Divs & grids 中单击刚在 selenium 中输入的特定记录

> ID：16214122
> 
> 赞同：0
> 
> 时间：2013-04-25T11:58:14.073
> 
> 标签：xpath, selenium

在我的应用程序中，我可以选择打开弹出菜单（通过单击表格的特定列）然后使用单击任何菜单项来调用该函数

我添加了一条记录 1，它将与其他 x、y、z 记录一起出现在表中。所以现在我在表中有 4 行。我想打开记录 1 的弹出菜单（刚刚由我的测试创建）我该怎么做？

我的应用程序中的所有工作都是使用 div 完成的。我正在通过 XPaths 查找元素，但在这种情况下，我无法做到这一点。

# node.js - 如何将变量的值从 Node.js 发送到浏览器？

> ID：16214128
> 
> 赞同：0
> 
> 时间：2013-04-25T11:58:23.077
> 
> 标签：node.js

我不明白为什么我无法在浏览器中获取“i”的值。我得到了这个 Erreur 101 (net::ERR_CONNECTION_RESET)

```
var http = require('http');
var i=0;

http.createServer(function (req, res) {
    i++;
    res.writeHeader(200, {'Content-Type': 'text/plain'});
    res.write(i);
    res.end();
}).listen(80, "127.0.0.1"); 
```

但如果：

```
res.write("i =" + i); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:06:34.217

简短的回答：

因为类型`i`是**number**。

长答案：

看一下[`Socket.prototype.write`](https://github.com/joyent/node/blob/master/lib/net.js#L593)定义：

```
Socket.prototype.write = function(chunk, encoding, cb) {
  if (typeof chunk !== 'string' && !Buffer.isBuffer(chunk))
    throw new TypeError('invalid data');
  return stream.Duplex.prototype.write.apply(this, arguments);
}; 
```

# ruby-on-rails-3 - rails 3.2中的自动保存问题

> ID：16214130
> 
> 赞同：-1
> 
> 时间：2013-04-25T11:58:28.677
> 
> 标签：ruby-on-rails-3, netzke

在给定的代码中，

```
class Supplier < ActiveRecord::Base  
  has_one :criteria, foreign_key: "crt_sup_id", :autosave => true   
  self.primary_key = 'sup_id'  
end  

class Criteria < ActiveRecord::Base  
  belongs_to :supplier, foreign_key: "crt_sup_id"  
  self.primary_key = 'crt_id'  
  self.table_name = 'criterias'  
end 
```

提交表单时自动保存不起作用。创建供应商记录但不创建标准。

## 表格代码

```
 class SupplierForm < Netzke::Basepack::Form
      def configure(c)
        c.model = 'Supplier'
        super
        c.items = [
          {field_label: "Name", name: :bname},
          {field_label: "Detail", name: :detail},
          {
            layout: :hbox, border: false, defaults: {border: false}, items: [
            {
              flex: 1,
              layout: :anchor,
              defaults: {anchor: "-8"},
              items: [
                {field_label: "Value 1", name: :criteria__val_one, xtype: :checkbox, nested_attribute: true},
                {field_label: "Value 2", name: :criteria__val_two, xtype: :checkbox, nested_attribute: true}
                ]
            }
            ]
          }
        ]
      end
    end 
```

## 控制器代码

```
def index
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T05:28:29.810

在 Netzke 作者的帮助下解决。将 criteria__val_one 替换为 criteria_val_one，将 criteria__val_two 替换为 criteria_val_two。在模型类中创建虚拟属性。现在表单中输入的所有值都可以通过这些虚拟属性访问并且可以保存。**归功于 Max** Gorin 。感谢伟大的工作（Netzke）

# mysql - 未标准化的表格适用于哪些地方？

> ID：16214133
> 
> 赞同：1
> 
> 时间：2013-04-25T11:58:53.033
> 
> 标签：mysql, database, database-design, metadata, business-intelligence

是否曾经是最佳实践或建议使用以下表格？

```
 id, uid, fieldname, fieldvalue
    4, 12, gender, male
    5, 12, age, 21-30
    6, 12, location, 5
    7, 13, gender, female
    8, 13, age, 31-40
    9, 13, location, 5
    10, 14, gender, female
    11, 14, age, 31-40
    12, 14, location, 6
    13, 15, gender, male
    14, 15, age, 21-30
    15, 15, location, 7 
```

它未规范化，您无法指定字段的数据类型。

以下不是更好吗

```
id, uid, gender, age, location
4, 12, male, 21-30, 5
5, 13, female, 31-40, 5
6, 14, female, 31-40, 6
7, 15, male, 21-30, 7 
```

我想知道您是否可以证明在数据库中有这样的表是合理的，我知道第一种方法可能更容易添加更多字段（而不是更改数据库）并且可能会删除所有空值。

但是，无法指定数据类型，并且每次要使用数据时都必须从字符串转换。

那么是否存在将第一个表视为最佳实践或解决方案的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:03:29.170

您可以通过添加另一个表来规范化初始设置：

```
fieldnames (fnid, name)
fieldvalues (id, uid, fnid, value, unique(uid,fnid)) 
```

但是，我建议不要这样做，因为它很复杂——使用单个表要容易得多，除非您要非常频繁地添加和/或删除字段，或者行获取哪些字段可能存在很大差异（在在这种情况下，您可能应该重新考虑重新设计您的数据库和应用程序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T16:19:55.110

您描述的第一种结构类型在预先不知道属性的应用程序中很常见。例如，您可能正在开发一个系统，用户可以在其中保存有关联系人的详细信息。您可能知道将存储的一些详细信息，但不知道其他详细信息。因此，您可能允许用户为联系人定义自定义属性。

当然，这种设计意味着失去了数据库应用检查，而不得不依赖应用应用检查。这是一个缺点，但如果确实需要灵活性，则不应成为交易破坏者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T21:28:46.373

在使用这种方法的系统上工作会让你失去理智。执行基本任务所需的查询非常复杂，性能更是一场噩梦。

这是一个男人的经历：[https ://www.simple-talk.com/opinion/opinion-pieces/bad-carma/](https://www.simple-talk.com/opinion/opinion-pieces/bad-carma/)

# c# - Catel（MVVM 框架） ObservableCollection

> ID：16214135
> 
> 赞同：1
> 
> 时间：2013-04-25T11:59:19.730
> 
> 标签：c#, wpf, mvvm, observablecollection, catel

我正在使用[Catel](https://catelproject.atlassian.net/wiki/display/CTL/Catel+documentation+Home)来实现 WPF 应用程序。

我有一个从`ObservableCollection`每次插入项目时扩展的类 UI 必须更新。

代码（*简化版*）：

```
 public abstract class LogCollections : ObservableCollection<Log4NetLog>  {

    private readonly Object _locker;

    protected LogCollections() {
        _logChart = new LoggingLevelChart();
        _locker = new object();
    }

    public object Locker {
        get { return _locker; }

    protected override void InsertItem(int index, Log4NetLog item) {
        lock (_locker) {
            base.InsertItem(index, item);

            if (item == null) {
                return;
            }
            Log4NetLog temp = item as Log4NetLog;

            // Updating

            if (temp != null) {

                // Updating
            }
        } //UnLock 
    }

  }
} 
```

到目前为止，我一直在使用[BindingOperations.EnableCollectionSynchronization](http://msdn.microsoft.com/en-us/library/hh198845.aspx)，它仅在 .NET 4.5 中可用。不幸的是，我必须使用 .Net 4 编译代码。

我想知道，Catel 框架中是否有任何东西可以解决此类问题。

**更多信息：**

对于这个应用程序性能是主要问题，因为我向集合中添加了许多项目。

**更新：**

using`FastObservableCollection`解决了这个问题，但是一旦我停止使用，UI 就会冻结大约 5-7 秒。我的猜测是，这是由`Dispatcher`

我已经手动覆盖了`OnCollectionChanged`：

```
protected override void OnCollectionChanged(NotifyCollectionChangedEventArgs e) {
  DispatcherHelper.CurrentDispatcher.BeginInvoke(new Action(() => base.OnCollectionChanged(e)),
              DispatcherPriority.ContextIdle);
} 
```

这不是一个好的解决方案。有没有更好的方法来避免这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:23:52.197

您可以考虑在 Catel 中使用[FastObservableCollection](https://github.com/Catel/Catel/blob/master/src/Catel.MVVM/Catel.MVVM.NET40/Collections/FastObservableCollection.cs?source=c)：

```
using (fastCollection.SuspendChangeNotifications())
{
    // TODO: Add and remove all your items here
} 
```

一旦您退出使用，它将通过它的更改通知

要解决线程问题，您可以使用 DispatcherHelper。

# windows - 如何从命令行使用 svn+ssh 和 Tortoise SVN

> ID：16214136
> 
> 赞同：20
> 
> 时间：2013-04-25T11:59:20.133
> 
> 标签：windows, shell, svn, command-line, tortoisesvn

我在使用 TortoiseSvn 的 Windows 7 工作站上尝试使用以下语法检查 repo 时遇到问题：

```
svn co svn+ssh://user@ip/repo . 
```

我为测试此问题所做的工作：

*   修改 TortoiseSvn 的网络设置指向 ..\TortoisePlink.exe
*   成功建立到目标机器的 ssh 连接，没有任何问题
*   使用 OpenSsh 从运行 Ubuntu 的工作站成功签出 repos

当我尝试从 Windows 7 工作站上的命令行执行上述语法时，出现错误：

```
svn: E720087: Unable to connect to a repository at URL 'svn+ssh:///user@ip/repo'
svn: E720087: Can't create tunnel:The parameter is incorrect. 
```

有趣的是，如果我使用 tortoise gui 浏览到 repo，我可以成功打开并查看 repo。但出于脚本目的，我需要从命令行执行此操作。

有什么建议么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-25T12:10:53.927

要使 svn+ssh 与 Tortoise 一起使用，请确保`%SVN_SSH%`设置为您的 ssh 客户端（可能是 Tortoise 或 Putty 中的 plink.exe），并且路径必须使用正斜杠`/`或转义的反斜杠编写`\\`。

尝试`%SVN_SSH%`在转义反斜杠时设置 plink 的绝对路径，类似于`C:\\Program Files\\TortoiseSVN\\bin\\TortoisePlink.exe`而不是`..\TortoisePlink.exe`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T20:07:56.563

*   使用 Plink 手动连接到服务器。定义 plink 所需和正确的（为您）启动选项
*   将此行（使用 tortoiseplink 作为 windowless-plink）添加到`%APPDATA%config`文件中，`[tunnels]`部分

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-10-11T20:46:10.993

检查 TortoisePlink 的路径在你的 Tortoise SVN 配置中没有损坏...

1.  开始 > 程序文件 > Tortoise SVN > 设置
2.  在常规设置下，“Subversion 配置文件：”单击“编辑”
3.  这将在记事本中打开配置文件
4.  向下滚动到该`[tunnels]`部分并检查`ssh`应该取消注释的值，使用双斜杠等 - 我遇到了问题，因为路径的开头似乎有一个 Unicode 控制代码。

```
### 在 Windows 上，如果要指定命令的完整路径，
### 使用正斜杠 (/) 或成对的反斜杠 (\\) 作为
### 路径分隔符。单个反斜杠将被视为
### 为以下字符转义。
ssh = C\:\\Program Files\\TortoiseSVN\\bin\\TortoisePlink.exe

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-08T22:03:43.030

事实证明，配置文件的 Tunnels 部分中的行是区分大小写的。

例如： sh = $SVN_SSH "C:/path/putty/plink.exe" -2 -C -i "C:/path/username/serversvn.ppk" 可能有效

和

sh = $SVN_SSH "C:/path/PuTTY/plink.exe" -2 -C -i "C:/path/username/serversvn.ppk" 不起作用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-10T18:12:24.287

我有一个类似但略有不同的问题。

我尝试通过 Pycharm 连接到我们的 SSH+SVN 服务器，但它挂了。通过Windows右键单击，tortoiseSVN尝试了常规方式并得到了同样的“无法创建隧道”问题。

我相信这个问题是因为我试图通过 pycharm 连接到我的 repo，它自动在 tortoise SVN 配置文件中创建了一条隧道线。

我按照凯文萨德勒的回答，但只是注释掉了 ssh 行，它就恢复了正常。签出和提交又开始工作了。

凯文的回答：

检查 TortoisePlink 的路径在你的 Tortoise SVN 配置中没有损坏...

1.  开始 > 程序文件 > Tortoise SVN > 设置
2.  在常规设置下，“Subversion 配置文件：”单击“编辑”
3.  这将在记事本中打开配置文件
4.  向下滚动到 [隧道] 部分。注释掉 SSH 行。

# shell - 如何在 shell 脚本中获取 sqlite 命令的输出

> ID：16214142
> 
> 赞同：0
> 
> 时间：2013-04-25T11:59:39.863
> 
> 标签：shell, sqlite

如果在执行我的 sql crud 操作期间出现问题，或者如果它无法使用 shell 脚本进行提交，我正在尝试回滚。

我有 test2.sh 和 test.sh test.sh：

```
 #!/bin/sh
 sqlite3 dB.sqlite << EOF
 begin;
 select * from Table1; 
```

和 test2.sh

```
#!/bin/sh
if echo `./test.sh`|grep -q "SQL error"; then
  rollback;
else
  err=commit;
  if echo $err |grep -q "error"; then
    rollback;
  fi
fi 
```

没有名为 Table1 的表，我希望得到 test.sh 的 sql 错误输出和回滚。

但它给出了错误：回滚：找不到命令。我怎样才能得到错误并进行回滚？还是我遵循的这种方式对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:55:22.160

您的 test2.sh 脚本失败，因为 shell 试图执行一个名为 的程序`rollback`，因此“找不到命令”。您想使用**sqlite 指令**回滚，这意味着您至少必须这样做：

```
sqlite3 dB.sqlite << EOF
rollback;
EOF 
```

但我**认为这行不通**。正如我所看到的，回滚必须发生在与 test.sh 启动的相同的 sqlite 会话中才能产生任何效果。您的 test.sh 脚本已经使 sqlite 遍历命令，直到它到达 EOF，当您使用 test2.sh grep 错误时，已经太晚了。您无法从位于该 sqlite 会话之外的 test2.sh 脚本进行回滚。

因此，为了完成我的回答，我建议您远离 Bash 脚本并使用一种编程语言，这将允许您打开一个 sqlite 会话、执行命令和控制事务。Python中的快速示例：

```
import sqlite3

conn = sqlite3.connect('dB.sqlite')

c = conn.cursor()

try:
    c.execute('INSERT INTO Table1 VALUES(1)')
    conn.commit()
except:
    conn.rollback()

c.close() 
```

# c# - WPF 数据网格 | 隐藏行验证列

> ID：16214148
> 
> 赞同：0
> 
> 时间：2013-04-25T11:59:54.590
> 
> 标签：c#, wpf

我有一个 WPF 数据网格，它有 4 列，所有这些都是数据网格模板列。当网格呈现时，左侧会自动添加一列，据我所知，该列用于显示行验证错误，并由模板 RowValidationErrorTemplate 绑定。

我的问题是，我不希望显示此列，并希望将其隐藏。如何在我的数据网格上设置它？

请注意，我使用的是 .NET 3.5。

我的网格样式如下：

```
 <Style x:Key="GridStyle" TargetType="{x:Type Controls:DataGrid}">
                <Setter Property="VerticalGridLinesBrush" Value="#7BA0CD"/>
                <Setter Property="HorizontalGridLinesBrush" Value="#7BA0CD"/>
                <Setter Property="AlternatingRowBackground" Value="#D3DFEE"/>
                <Setter Property="CanUserResizeRows" Value="False"/>
                <Setter Property="CanUserReorderColumns" Value="False"/>
                <Setter Property="CanUserResizeColumns" Value="False"/>
                <Setter Property="CanUserSortColumns" Value="False"/>
                <Setter Property="AutoGenerateColumns" Value="False"/>
            </Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T13:47:24.403

找到了如何做到这一点：

```
<Setter Property="RowHeaderStyle">
            <Setter.Value>
                <Style TargetType="Primitives:DataGridRowHeader">
                    <Setter Property="Background" Value="Transparent" />
                </Style>
            </Setter.Value>
        </Setter> 
```

# javascript - 通过 javascript 加载 jQuery 并从另一个文件运行函数

> ID：16214150
> 
> 赞同：2
> 
> 时间：2013-04-25T11:59:56.810
> 
> 标签：javascript, jquery

我需要在一个页面中加载 3 个 jquery 脚本。出于商业原因，我必须尽可能减少修改，因此我决定创建一个 javascript 以包含在网站中。

之后，这个脚本必须加载 jQuery 以及除了 3 个 css 文件之外的另外 3 个 jquery 脚本。

基本上，直到现在，这就是我所拥有的：

```
var jquery = document.createElement('script');
jquery.type = "text/javascript";
jquery.src = "common/com/jquery/jquery-1.9.1.js";
document.getElementsByTagName('head')[0].appendChild(jquery,document.getElementsByTagName('head')[0].firstChild);

var prettyPhoto = document.createElement('script');
prettyPhoto.type = "text/javascript";
prettyPhoto.src = "common/com/prettyPhoto/jquery.prettyPhoto.js";
document.getElementsByTagName('head')[0].appendChild(prettyPhoto,document.getElementsByTagName('head')[0].firstChild);

var jqueryui = document.createElement('script');
jqueryui.type = "text/javascript";
jqueryui.src = "common/com/jqueryui/jquery-ui.js";
document.getElementsByTagName('head')[0].appendChild(jqueryui,document.getElementsByTagName('head')[0].firstChild);

var kohlerApp = document.createElement('script');
kohlerApp.type = "text/javascript";
kohlerApp.src = "common/js/lelak.js";
document.getElementsByTagName('head')[0].appendChild(kohlerApp,document.getElementsByTagName('head')[0].firstChild);

var style = document.createElement("link");
style.type = "text/css";
style.href = "common/css/style.css";
style.rel = "stylesheet";
document.getElementsByTagName('head')[0].appendChild(style,document.getElementsByTagName('head')[0].firstChild);

var jqueryui = document.createElement("link");
jqueryui.type = "text/css";
jqueryui.href = "common/css/jquery-ui.css";
jqueryui.rel = "stylesheet";
document.getElementsByTagName('head')[0].appendChild(jqueryui,document.getElementsByTagName('head')[0].firstChild);

var prettyPhoto = document.createElement("link");
prettyPhoto.type = "text/css";
prettyPhoto.href = "common/css/prettyPhoto.css";
prettyPhoto.rel = "stylesheet";
document.getElementsByTagName('head')[0].appendChild(prettyPhoto,document.getElementsByTagName('head')[0].firstChild);

lelakApp.giveError("0","test"); 
```

我正在尝试执行包含在其中一个脚本中的 jquery 函数之一，但没有成功。返回以下错误：

```
Uncaught ReferenceError: lelakApp is not defined 
```

（**lelakApp**来自我的脚本）

**我如何加载 jQuery 和个人 Jquery 脚本并从该个人脚本加载函数？**

* * *

**编辑**

我正在尝试使用**requireJs执行一个简单的 jquery 请求**

```
define(["../com/jquery/jquery-1.9.1"], function($) {
$('body').html('');
}); 
```

但我收到此错误：

```
Uncaught TypeError: undefined is not a function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:16:47.013

I would think this is because you dont know whether the script has loaded or not at the time you try to use the function.

You could try adding an onload event handler to the script tags and only start using the scripts once they are all loaded.

Take a look at require.js either to use or for ideas : [http://requirejs.org/](http://requirejs.org/)

```
require(["helper/util"], function(util) {
    //This function is called when scripts/helper/util.js is loaded.
    //If util.js calls define(), then this function is not fired until
    //util's dependencies have loaded, and the util argument will hold
    //the module value for "helper/util".
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T12:17:28.270

在使用`lelakApp`. 我建议您使用[`require.js`](http://requirejs.org/)动态加载脚本。

为了在没有**require.js**的情况下执行此操作，您可以执行以下操作：

```
script.onload = script.onreadystatechange = function () {
    'use strict';

    if (script.readyState === 'complete') {
        // ...
    }
} 
```

注意：我对浏览器兼容性一无所知。

# android - 导出应用程序时android中的Proguard错误？

> ID：16214152
> 
> 赞同：0
> 
> 时间：2013-04-25T12:00:07.590
> 
> 标签：android, proguard

我开发了 android 应用程序，所有功能都运行良好。但是当我尝试导出应用程序时，出现以下错误

Proguard 带着`error code 1`. 见控制台

我的控制台在这里

```
 proguard.ParseException: Expecting class member name before '@' in line 162 of file 'D:\Android\Workspace.gopal\LoginActivity\bin\proguard.txt',
    LoginActivity]   included from argument number 6
    LoginActivity]  at proguard.ConfigurationParser.readNextWord(ConfigurationParser.java:1133)
    LoginActivity]  at     proguard.ConfigurationParser.readNextWord(ConfigurationParser.java:1117)
    LoginActivity]  at proguard.ConfigurationParser.parseMemberSpecificationArguments(ConfigurationParser.java:845)
    LoginActivity]  at proguard.ConfigurationParser.parseClassSpecificationArguments(ConfigurationParser.java:697)
    LoginActivity]  at proguard.ConfigurationParser.parseKeepClassSpecificationArguments(ConfigurationParser.java:490)
    LoginActivity]  at proguard.ConfigurationParser.parse(ConfigurationParser.java:139)
    LoginActivity]  at proguard.ProGuard.main(ProGuard.java:484) 
```

在此处添加了 proguard 设置

```
 view res/layout/my_eg.xml  generated:97
-keep class android.support.v4.view.ViewPager { <init>(...); }

  view AndroidManifest.xml  generated:96
-keep class com.eg.mobile.AboutUsActivity { <init>(...); }

  view AndroidManifest.xml  generated:74
-keep class com.eg.mobile.AddHighlightActivity { <init>(...); }

  view AndroidManifest.xml  generated:70
-keep class com.eg.mobile.AlbumCreationActivity { <init>(...); }

  view AndroidManifest.xml  generated:171
-keep class com.eg.mobile.CameraActivity { <init>(...); }

  view AndroidManifest.xml  generated:156
-keep class com.eg.mobile.CameraFlowActivity { <init>(...); }

  view AndroidManifest.xml  generated:160
-keep class com.eg.mobile.CameraHomeScreenActivity { <init>(...); }

  view AndroidManifest.xml  generated:164
-keep class com.eg.mobile.CameraPreviewActivity { <init>(...); }

  view AndroidManifest.xml  generated:181
-keep class com.eg.mobile.ChooseHomescreenActivity { <init>(...); }

  view AndroidManifest.xml  generated:92
-keep class com.eg.mobile.ContactUsActivity { <init>(...); }

  view AndroidManifest.xml  generated:66
-keep class com.eg.mobile.CreateActivity { <init>(...); }

  view AndroidManifest.xml  generated:194
-keep class com.eg.mobile.EGBlogActivity { <init>(...); }

  view AndroidManifest.xml  generated:198
-keep class com.eg.mobile.EGBlogDetailsActivity { <init>(...); }

  view AndroidManifest.xml  generated:190
-keep class com.eg.mobile.FAQActivity { <init>(...); }

  view AndroidManifest.xml  generated:147
-keep class com.eg.mobile.FanMemberDetailsActivity { <init>(...); }

  view AndroidManifest.xml  generated:46
-keep class com.eg.mobile.GCMIntentService { <init>(...); }

  view AndroidManifest.xml  generated:58
-keep class com.eg.mobile.LandingActivity { <init>(...); }

  view AndroidManifest.xml  generated:133
-keep class com.eg.mobile.LightboxActivity { <init>(...); }

  view AndroidManifest.xml  generated:34
-keep class com.eg.mobile.LoginActivity { <init>(...); }

  view AndroidManifest.xml  generated:207
-keep class com.eg.mobile.MessageConversation { <init>(...); }

  view AndroidManifest.xml  generated:213
-keep class com.eg.mobile.MultiPhotoSelectActivity { <init>(...); }

  view AndroidManifest.xml  generated:139
-keep class com.eg.mobile.MyEgActivity { <init>(...); }

  view AndroidManifest.xml  generated:119
-keep class com.eg.mobile.MyEgDetailsActivity { <init>(...); }

  view AndroidManifest.xml  generated:124
-keep class com.eg.mobile.MyEgLibraryActivity { <init>(...); }

  view AndroidManifest.xml  generated:114
-keep class com.eg.mobile.MyEgLibraryContentActivity { <init>(...); }

  view AndroidManifest.xml  generated:151
-keep class com.eg.mobile.MyEgMessagingActivity { <init>(...); }

  view AndroidManifest.xml  generated:185
-keep class com.eg.mobile.MyEgNotificationsActivity { <init>(...); }

  view AndroidManifest.xml  generated:143
-keep class com.eg.mobile.MyfanbaseActivity { <init>(...); }

  view AndroidManifest.xml  generated:219
-keep class com.eg.mobile.NotificationSettings { <init>(...); }

  view AndroidManifest.xml  generated:104
-keep class com.eg.mobile.OurCommunityActivity { <init>(...); }

  view AndroidManifest.xml  generated:100
-keep class com.eg.mobile.OurStoryActivity { <init>(...); }

  view AndroidManifest.xml  generated:135
-keep class com.eg.mobile.PostCommentsActivity { <init>(...); }

  view AndroidManifest.xml  generated:108
-keep class com.eg.mobile.PostCreationActivity { <init>(...); }

  view AndroidManifest.xml  generated:88
-keep class com.eg.mobile.PrivacyActivity { <init>(...); }

  view AndroidManifest.xml  generated:78
-keep class com.eg.mobile.RegistrationActivity { <init>(...); }

  view AndroidManifest.xml  generated:128
-keep class com.eg.mobile.SearchActivity { <init>(...); }

  view AndroidManifest.xml  generated:62
-keep class com.eg.mobile.ThankYouActivity { <init>(...); }

  view AndroidManifest.xml  generated:84
-keep class com.eg.mobile.TosActivity { <init>(...); }

  view AndroidManifest.xml  generated:176
-keep class com.eg.mobile.UpdateProfileActivity { <init>(...); }

  view AndroidManifest.xml  generated:168
-keep class com.eg.mobile.UploadActivity { <init>(...); }

  view AndroidManifest.xml  generated:202
-keep class com.eg.mobile.VideoPlayerActivity { <init>(...); }

  view AndroidManifest.xml  generated:29
-keep class com.eg.mobile.common.EGApplication { <init>(...); }

  view res/layout/myeg_message_conversation.xml  generated:83
  view res/layout/myeg_messaging.xml  generated:100
-keep class com.eg.mobile.common.EditTextBackEvent { <init>(...); }

  view res/layout/eg_library_list_item.xml  generated:22
-keep class com.eg.mobile.common.ExpandedGridView { <init>(...); }

  view res/layout/eg_blog_highlights.xml  generated:177
  view res/layout/egblog_landingpage.xml  generated:174
  view res/layout/myeg_notifications.xml  generated:37
-keep class com.eg.mobile.pulltorefreshlist.PullToRefreshView { <init>(...); }

  view res/layout/myeg_messages.xml  generated:122
  view res/layout/myeg_messaging.xml  generated:137
-keep class com.eg.mobile.srg.SrgEgMessage { <init>(...); }

  view res/layout/my_eg_library.xml  generated:39
  view res/layout/myeg_library_mycontent.xml  generated:191
-keep class com.eg.mobile.srg.SrgMyEgLibrary { <init>(...); }

  view res/layout/fan_member_details.xml  generated:39
  view res/layout/my_eg.xml  generated:48
  view res/layout/myfanbase.xml  generated:40
-keep class com.eg.mobile.srg.SrgMyEgTabs { <init>(...); }

  view res/layout/myeg_search.xml  generated:79
  view res/layout/search.xml  generated:111
-keep class com.eg.mobile.srg.SrgSearch { <init>(...); }

  view AndroidManifest.xml  generated:48
-keep class com.google.android.gcm.GCMBroadcastReceiver { <init>(...); }

  onClick res/layout/fanofpopup.xml  generated:28
  onClick res/layout/fanofpopup.xml  generated:41
  onClick res/layout/myeg_detail_view.xml  generated:75
-keepclassmembers class * { *** @drawable/gradient_active_button(...); }

  onClick res/layout/ac_image_grid.xml  generated:18
-keepclassmembers class * { *** btnChoosePhotosClick(...); }

  onClick res/layout/myeg_search_results.xml  generated:46
  onClick res/layout/search.xml  generated:68
-keepclassmembers class * { *** searchClick(...); } 
```

请任何人帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T01:23:38.793

如果您的 proguard.txt 显示：

```
-keepclassmembers class * { *** @drawable/gradient_activ_button(...); } 
```

或者 ：

```
-keepclassmembers class * { *** @string/onClickXXX(...); } 
```

检查您的布局文件，并替换：

```
android:onClick="@string/onClickXXX" 
```

和

```
android:onClick="real Name of onClickEvent Handler" 
```

直接引用事件处理程序的名称。Proguard 无法解析资源名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T00:15:59.493

错误

```
Expecting class member name before '@' in line 162 of file 'D:\Android\Workspace.gopal\LoginActivity\bin\proguard.txt' 
```

提示自动生成的文件 bin/proguard.txt 的第 162 行有问题。您可能需要检查您的 SDK 版本是否是最新的。

# javascript - 从请求中排除 Cookie

> ID：16214160
> 
> 赞同：2
> 
> 时间：2013-04-25T12:00:39.783
> 
> 标签：javascript, http, cookies

是否可以阻止将某些 cookie 发送到服务器？

我有在 JavaScript 中设置的 cookie，仅在客户端上需要（与其他浏览器窗口共享数据）。我不希望它们被发送到服务器。

# android - 需要在android中实现slider

> ID：16214162
> 
> 赞同：0
> 
> 时间：2013-04-25T12:00:45.820
> 
> 标签：android, android-sliding

我想实现一段时间后自动滑块的滑块，以及用户触摸的滑块（如在网站中运行）。

我尝试了很多东西，但对我来说没有用完。

**我正在尝试什么：**

```
<linearlayout =1 />
<linearlayout =2 />
<linearlayout =3 /> 
```

我正在用下面的 xml膨胀**布局 2**

```
<linearlayout>
     <imageview>
     <webview>
</linearlayout> 
```

**膨胀 xml 依赖于来自服务器的 Web 服务数据。**

并且需要在布局 2 中实现滑块功能。

所以现在需要方法锄头来在android中完成这项任务我已经尝试了很多东西但没有使用完整的顶级我。

# javascript - 你如何做物体进入的网络动画，它们的位置变得可见？

> ID：16214166
> 
> 赞同：-2
> 
> 时间：2013-04-25T12:00:56.030
> 
> 标签：javascript, jquery, css, html, css-animations

我需要为很多对象制作“入口”动画。他们应该从页面的两侧飞到他们应该去的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:02:41.257

您可以使用 jQuery **[.animate()](http://api.jquery.com/animate)**。

# php - MySQL 表仅从 EXT js + PHP 条目首次提交

> ID：16214168
> 
> 赞同：0
> 
> 时间：2013-04-25T12:01:03.750
> 
> 标签：php, mysql, extjs

我的 MySQL 有问题。

我已经设置好了一切，一切都很好，但是当我提交我的表格时，它只会在表格完全为空的情况下工作。如果表中已经存储了信息，它将不会提交另一个条目。

这是mysql表

```
CREATE TABLE student
(StudentID int NOT NULL,
StudentFirst varchar(30),
StudentLast varchar(30), 
StudentEmail varchar(254),
StudentPhone varchar(12),
StudentDOB date,
DateStarted date, 
LessonID int,
StudentAddress varchar(50), 
StudentCity varchar(30), 
StudentState char(2), 
StudentZip varchar(10), 
MusicInterest text);
alter table student add constraint StudentPK primary key AUTO_INCREMENT (StudentID); 
alter table student add constraint LessonFK foreign key (LessonID) references lesson(LessonID); 
```

这是我的 PHP

```
if(isset($_REQUEST['action'])){
switch($_REQUEST['action']){
        case 'submit_student':
            $first = $_REQUEST['StudentFirst'];
            $last = $_REQUEST['StudentLast'];
            $email = $_REQUEST['StudentEmail'];
            $phone = $_REQUEST['StudentPhone'];
            $dob = $_REQUEST['StudentDOB'];
            $datestarted = $_REQUEST['DateStarted'];
            $lessonid = $_REQUEST['LessonID'];
            $address = $_REQUEST['StudentAddress'];
            $city = $_REQUEST['StudentCity'];
            $state = $_REQUEST['StudentState'];
            $zip = $_REQUEST['StudentZip'];
            $musicinterest = $_REQUEST['MusicInterest'];

            $stmt = $dbh->prepare("insert into student (StudentFirst, StudentLast, StudentEmail,  StudentPhone, StudentDOB, DateStarted, LessonID, StudentAddress, StudentCity, StudentState, StudentZip,MusicInterest) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);");
            $stmt -> bindParam(1,$first);
            $stmt -> bindParam(2,$last);
            $stmt -> bindParam(3,$email);
            $stmt -> bindParam(4,$phone);
            $stmt -> bindParam(5,$dob);
            $stmt -> bindParam(6,$datestarted);
            $stmt -> bindParam(7,$lessonid);
            $stmt -> bindParam(8,$address);
            $stmt -> bindParam(9,$city);
            $stmt -> bindParam(10,$state);
            $stmt -> bindParam(11,$zip);
            $stmt -> bindParam(12,$musicinterest);
            $stmt -> execute();
        break; 
```

和我的 EXTJ

```
function addStudent(){
        Ext.Ajax.request ({
        url: 'inc/template.php',
        params: {action: 'submit_student',

                                 StudentFirst:firstNameTextField.getValue(),
                                 StudentLast:lastNameTextField.getValue(),
                                 StudentEmail: emailTextField.getValue(),
                                 StudentPhone:phoneNumberTextField.getValue(),
                                 StudentDOB:Ext.util.Format.date(dateOfBirth.getValue(), 'Y-m-d'),
                                 DateStarted:dateStarted.getValue(),
                                 LessonID:dayTypeCombo.getValue(),
                                 StudentAddress:streetTextField.getValue(),
                                 StudentCity:cityTextField.getValue(),
                                 StudentState:stateTextField.getValue(),
                                 StudentZip:zipTextField.getValue(),
                                 MusicInterest:musicInterest.getValue()
                                 },
                                 method: 'POST',
        });
    tabPanel.activate(studentGrid);
    tabPanel.activate(scheduleGrid);
    clearStudentForm(); 
```

我不知道为什么它只提交一次。真是莫名其妙。它显示了萤火虫中的帖子。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:29:05.100

我不确定`AUTO-INCREMENT`在

`alter table student add constraint StudentPK primary key AUTO_INCREMENT (StudentID);`

我还认为，您应该将此语法用于多个列。一列使用

```
CREATE TABLE student
(StudentID int NOT NULL PRIMARY KEY,
StudentFirst varchar(30),
... 
```

# sql-server - 使用 Excel 从 SQL Server 生成报告

> ID：16214170
> 
> 赞同：1
> 
> 时间：2013-04-25T12:01:13.203
> 
> 标签：sql-server, excel, data-warehouse

我为我们公司开发了一个使用 SQL Server 2008 后端的 Intranet 系统。这存储了大量信息，我经常被要求为各种经理构建报告以帮助处理业务。这些报告通常是一个主题的变体，而有时它们是非常独特的。目前我编写 SQL 来执行报告并让他们通过 ASP.Net 页面转储所需的输出。我真正想做的是摆脱这种情况，我正在考虑让经理使用 Excel 查询数据库，以便他们可以决定过滤哪些字段等。为此，我写了几个视图并使用 Excel 连接到它们。问题是如果不过滤你最终会得到很多数据，所以我想知道解决这个问题的最佳方法。我' 与数据仓库/分析服务没有任何关系，但我想知道这是一条值得关注的途径，还是我应该关注 Reporting Services？我可以访问完整的 Microsoft 堆栈，很高兴使用不同的解决方案

我更乐意花一些时间做一些阅读/研究，但我有点不确定从哪里开始，所以任何指针都会被感激地接受。

提前致谢

# django - 存储过程结果到 Django 模型

> ID：16214171
> 
> 赞同：3
> 
> 时间：2013-04-25T12:01:15.323
> 
> 标签：django, stored-procedures, django-models, python-2.7

如果有这样的模型：

```
class Person(models.Model):
    id = models.IntegerField()
    first_name = models.CharField(max_length=50)
    last_name = models.IntegerField()
    birthday = models.DateField()
    address = models.CharField(max_length=250)     
    phone = models.TimeField() 
```

要创建 Person 类对象，我从存储过程中获取数据，例如：

```
cursor = connection.cursor()
cursor.callproc('sp_get_person_by_id', {id:1234})
results = cursor.fetchall()

[Person(*row) for row in results] 
```

但是“sp_get_person_by_id”返回的字段比 Person 类属性多。因此“狗屎发生”，错误发生是因为有些字段没有要映射的属性。

可以仅映射此属性吗？我怎样才能做到这一点？

提前谢谢。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-18T20:15:50.823

如果您知道从存储过程中返回的属性的顺序，您可以像这样将它们传递给模型：

```
cursor = connection.cursor()
cursor.callproc('sp_get_person_by_id', {id:1234})
results = cursor.fetchall()
result_list = []   

from row in results:
    p = self.model(id=row[0], fist_name=row[1], last_name=row[2], birthday=row[3])
    result_list.append(p)
return result_list 
```

# javascript - 以编程方式删除缓存文件并为其释放分配的内存

> ID：16214172
> 
> 赞同：1
> 
> 时间：2013-04-25T12:01:15.520
> 
> 标签：javascript, performance, caching, browser-cache, samsung-smart-tv

我正在为 SmartTV 构建一个应用程序，主要是（JavaScript 和 HTML5）。由于电视上的 RAM 大小和处理器速度，该应用程序非常慢。

我目前正在努力解决这个问题。我决定在新页面加载时删除缓存文件，并且用户移动到另一个页面。

此解决方案是否有助于解决（RAM 和 CPU）问题？以及如何以编程方式删除它们？

我尝试了以下代码：

```
<meta http-equiv='cache-control' content='no-cache'>
<meta http-equiv='expires' content='0'>
<meta http-equiv='pragma' content='no-cache'> 
```

我在页面中调用它后，此代码会将缓存文件大小设置为零吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T09:27:30.040

不，它不会。此代码告诉浏览器不要缓存页面。它仅适用于 html 页面。并且不会影响此页面上加载的任何资源。

# hadoop - 使用 Hadoop 处理两个数据集

> ID：16214177
> 
> 赞同：0
> 
> 时间：2013-04-25T12:01:36.010
> 
> 标签：hadoop

我正在使用 Hadoop 并尝试使用两个数据集创建一些交互功能，这是最好的场景。我可以将一个加载到内存中，然后在地图函数中与其他数据集相交，但是如果数据集对于 RAM 内存来说太大，这不是一个解决方案，你有什么想法？

* * *

感谢您的回答，我会尝试这些，看看什么是最好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:04:16.897

您可以尝试将它们放入[`DistributedCache`](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/filecache/DistributedCache.html)- 该页面上有一个很好的说明性示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T15:06:25.317

分布式缓存适用于小数据集，可以考虑缓存在内存中。如您所述，如果数据很大，则不能选择分布式缓存。

Hadoop 框架允许对大型数据集进行排序，但是，您可能必须遵循多个步骤，其中要求之一是输入数据集必须在进行连接之前进行排序。您可以考虑为此利用 Apache Hive。如果 Hive 被排除在外，此链接中提到的步骤应该可以帮助您开始处理大型数据集

[在 Hadoop Map/Reduce 中为多个映射器配置 Map Side join](https://stackoverflow.com/questions/6323544/configure-map-side-join-for-multiple-mappers-in-hadoop-map-reduce/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T17:45:50.007

与围绕 Hadoop API 的其他平台系列相比，在 MapRed 中操作 Intersection 很困难。已经有人提到了 Hive（如果你有 SQL 背景，那么做交叉点超级容易），但你也可以考虑：

*   [猪](http://pig.apache.org/docs/r0.7.0/piglatin_ref2.html#JOIN+%28inner%29)
*   [级联](http://docs.cascading.org/cascading/2.0/userguide/html/ch03s03.html#N2061A)（特别是 CoGroup 如果内存是一个问题，而 HashJoin 如果不是）

# c# - 查找所有包含 linq 单词的文章

> ID：16214178
> 
> 赞同：2
> 
> 时间：2013-04-25T12:01:36.417
> 
> 标签：c#, asp.net, linq

试图学习 Linq 但在这里碰壁。

我试图查找所有包含多个字符串的文章，但不确定在传递列表时如何使用 .Contains。

```
private void SearchArticles()
{
    AdminEntities db = new AdminEntities();

    var searchStrs = new List<string> {"search_string1", "search_string2"};
    var artListfull = db.view_M02Articles_SearchPublished(0, "").ToList();
    var artList = artListfull.FindAll(n => n.Bodytext.Contains(searchStrs));

    Label1.Text = artList.Count.ToString();
    Repeater1.DataSource = artList;
    Repeater1.DataBind();
} 
```

这里的正确语法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T12:08:56.573

**[编辑]**假设那`BodyText`是类型`string`

你可以试试这个：

```
//the article body must contain "ALL" the search terms
var artList = artListfull.Where(art => searchStrs.All(art.BodyText.Contains)); 
```

或者

```
//the article body must contain "At least one" of the search terms
var artList = artListfull.Where(art => searchStrs.Any(art.BodyText.Contains)); 
```

**[编辑 2]**替换`str => art.BodyText.Contains(str)`为`art.BodyText.Contains`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:14:54.350

使用 LINQ

```
var artList= (from art in artFullList
              from search in searchStrs 
              where art.Bodytext.Contains(search)
              select art).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T12:10:25.060

```
var artList = artListfull.Where(a => searchStrs.Any(s => a.Bodytext.Contains(s)))
                         .ToList(); 
```

# ms-access-2007 - Microsoft Access 2007 - 2010 数据库兼容性？

> ID：16214183
> 
> 赞同：0
> 
> 时间：2013-04-25T12:01:50.063
> 
> 标签：ms-access-2007, ms-access-2010

我有一个运行 Access 2010 的人打开的 2007 数据库。

他们删除了一些表并保存了数据库，但现在该数据库无法在任何运行 Access 2007 的 PC 上打开。

我相信 2007 年和 2010 年之间存在兼容性 - 我想我错了？

谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-19T13:50:13.207

问题是，即使以 Access 2007 格式保存文件，它实际上也不会仅使用 2007 兼容的语法保存它。微软的白痴选择打破向后兼容性，急于按时发布。除了重新创建您的表格和报告之外，您运气不佳......希望您保留原始代码的副本。

# variables - SWI prolog 使用 rbtrees 或其他方式生成变量名称集

> ID：16214184
> 
> 赞同：0
> 
> 时间：2013-04-25T12:01:50.420
> 
> 标签：variables, tree, prolog, set

我有一个术语，我想从中获取一组变量名称。

例如。输入：my_m(aa,b,B,C,max(D,C),D) 输出：[B,C,D] （无需按照输入中出现的顺序排序）（这会调用 set_variable_name(输入输出）。）

我可以简单地从输入中获取 [B,C,D,C,D]，但不知道如何实现 set（输出中只有一次出现）。我尝试过类似存储在 rbtrees 中的方法，但失败了，因为

```
only_one([],T,T) :- !.
only_one([X|XS],B,C) :- rb_in(X,X,B), !, only_one(XS,B,C).
only_one([X|XS],B,C) :- rb_insert(B,X,X,U), only_one(XS,U,C). 
```

它返回只有一个节点和统一的树，如`B=C, C=D...`. 我想我明白了 - 因为在质疑 rb_in(..) 时统一了 X。

那么，如何只存储一次该变量名呢？还是因为我们使用的是逻辑编程，所以这个想法根本上是错误的？如果你想知道我为什么需要这个，那是因为我们被要求在 Prolog 中实现 A* 算法，这是制作搜索空间的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:35:47.980

您可以使用`sort/2`，它也可以删除重复项。

# java - 用java中的数组列表合并排序

> ID：16214186
> 
> 赞同：0
> 
> 时间：2013-04-25T12:01:58.187
> 
> 标签：java, arraylist, mergesort

因此，对于家庭作业，我必须编写一个程序，将与常规数组一起使用的代码中的数组列表合并排序，我只是想知道是否有人可以帮助我找出我出错的地方，因为我的代码抛出了大量的 NULL POINTER 异常，我试图修复它们，但是当我修复一个时，它会转到另一个......等等......

谢谢！我的代码：

```
private static ArrayList<Integer> numbers= new ArrayList<Integer>();
private static ArrayList<Integer> helper;
private static int number;
public static void sort(ArrayList<Integer> myNumbers){
    for(int i=0; i<myNumbers.size();i++){
        numbers.add(myNumbers.get(i));
    }
    //numbers=myNumbers;
    number = myNumbers.size()-1;

    mergesort(0, number -1);
}
private static void mergesort(int low, int high){
    //check if low is smaller than high, if not then the array is sorted
    if(low<high){
        //get the index of the element which is in the middle
        int middle=low+(high-low)/2;
        //sort the left side of the array
        mergesort(low, middle);
        //sort the right side of the array
        mergesort(middle +1, high);
        //combine them both
        merge(low, middle, high);
    }
}
private static void merge(int low, int middle, int high){
    //copy both parts into the helper array
    for(int i=high;i>low;i++){
        helper.add((numbers.get(i)));
    }

    int i=low;
    int j=middle+1;
    int k=low;
    //copy the smallest myNumbers from either the left or right side back to the original array
    while(i<middle  && j<high){
        if(helper.get(i)< helper.get(j)){
            numbers.set(k,(helper.get(i)));
            i++;
        }
        else{
            numbers.set(k,(helper.get(j)));
            j++;
        }
        k++;
    }
    //copy the rest of the left side of the array into target array
    while(i<middle){
        numbers.set(k,helper.get(i));
        k++;
        i++;
    }
} 
```

回报：

```
Exception in thread "main" java.lang.NullPointerException
at BinarySearch.merge(BinarySearch.java:61)
at BinarySearch.mergesort(BinarySearch.java:55)
at BinarySearch.mergesort(BinarySearch.java:51)
at BinarySearch.mergesort(BinarySearch.java:51)
at BinarySearch.mergesort(BinarySearch.java:51)
at BinarySearch.mergesort(BinarySearch.java:51)
at BinarySearch.mergesort(BinarySearch.java:51)
at BinarySearch.mergesort(BinarySearch.java:51)
at BinarySearch.sort(BinarySearch.java:43)
at BinarySearch.main(BinarySearch.java:25) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:05:45.683

它尝试访问未创建的合并函数中的辅助字段。

另外我认为您应该从所有函数/字段中删除静态关键字。

私有静态 ArrayList 助手；

至

私有静态 ArrayList helper= new ArrayList();

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:09:50.017

这是罪魁祸首：

```
for(int i=high;i>low;i++){
    helper.add((numbers.get(i)));
} 
```

改为使用`for(int i=high; i>=low; i--) {`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:19:10.757

blackuprise 指出了你的两个问题。

您的合并实现还有另一个问题，这可能会使您的合并结果错误。在您的合并方法结束时，您有：

```
//copy the rest of the left side of the array into target array
while... 
```

你怎么能确定每次数组的所有右侧都会被合并，只有左边的部分有元素？（奇怪的句子^_^ left part has sth. left。）

您也应该检查右侧。或使用 a`SENTINEL`来避免“休息”检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:22:33.350

如果您正在尝试使用您的算法实现合并排序以用于学术用途，并且给定的答案是一个好的答案，否则如果您对 Guava 已经拥有的实现感兴趣，那么这里是：[guava Iterators](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Iterators.html#mergeSorted%28java.lang.Iterable,%20java.util.Comparator%29)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-17T21:25:23.050

公共类合并

```
public  static void sort(List<String>result )
{

     for( i=0;i<result.size();i++)
     {
        try{

          try{

         if(result.get(i).compareTo(result.get(i+1))>0)
             {
             String aux=result.get(i);
             result.set(i, result.get(i+1));
             result.set(i+1, aux);

             }

             }catch(NullPointerException e){}
          }catch(ClassCastException z){}

        }
    }

public static void main(String[]args) throws ClassNotFoundException
{ 
    String[]resultentry=new String[100];
    int index;//nr de elemente din vectorul de stringuri//
    int i;

    try{
   //declare files and lists//
    BufferedReader firstfile;
    BufferedReader secondfile;

    firstfile=new BufferedReader(new FileReader("lista1.txt"));
    secondfile=new BufferedReader(new FileReader("lista2.txt"));;

         firstentry=firstfile.readLine();
        secondentry=secondfile.readLine();

        while(firstentry!=null&&secondentry!=null)
        {
        firstlist.add(firstentry);
        firstentry=firstfile.readLine();

        secondlist.add(secondentry) ;
        secondentry=secondfile.readLine();

         }

     }catch(IOException exp){}

     try{

    java.util.Collections.sort(firstlist);
    System.out.println("First list sorted :"+ firstlist);

    java.util.Collections.sort(secondlist);
    System.out.println("Second list sorted"+secondlist);

    firstlist.addAll(secondlist);
    java.util.Collections.sort(firstlist);

    System.out.println("Result  list sorted "+" "+firstlist);

    }catch(ClassCastException b){}

   }

}` 
```

# python - 如何将base64字符串转换为图像？

> ID：16214190
> 
> 赞同：69
> 
> 时间：2013-04-25T12:02:09.723
> 
> 标签：python, base64

我正在将图像转换为**base64**字符串并将其从 android 设备发送到服务器。现在，我需要将该字符串更改回图像并将其保存在数据库中。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2013-04-25T12:06:31.547

试试这个：

```
import base64
imgdata = base64.b64decode(imgstring)
filename = 'some_image.jpg'  # I assume you have a way of picking unique filenames
with open(filename, 'wb') as f:
    f.write(imgdata)
# f gets closed when you exit the with statement
# Now save the value of filename to your database 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2018-01-02T06:19:37.263

返回转换后的图像而不保存：

```
from PIL import Image
import cv2

# Take in base64 string and return cv image
def stringToRGB(base64_string):
    imgdata = base64.b64decode(str(base64_string))
    image = Image.open(io.BytesIO(imgdata))
    return cv2.cvtColor(np.array(image), cv2.COLOR_BGR2RGB) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-25T12:07:53.053

只需使用该方法`.decode('base64')`并获得快乐。

您还需要检测图像的 mimetype/扩展名，因为您可以正确保存它，在一个简短的示例中，您可以将以下代码用于 django 视图：

```
def receive_image(req):
    image_filename = req.REQUEST["image_filename"] # A field from the Android device
    image_data = req.REQUEST["image_data"].decode("base64") # The data image
    handler = open(image_filename, "wb+")
    handler.write(image_data)
    handler.close() 
```

然后，根据需要使用保存的文件。

简单的。非常简单。;)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-25T12:05:14.860

这应该可以解决问题：

```
image = open("image.png", "wb")
image.write(base64string.decode('base64'))
image.close() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-23T09:04:21.077

您可以尝试使用 open-cv 来保存文件，因为它有助于在内部进行图像类型转换。示例代码：

```
import cv2
import numpy as np

def save(encoded_data, filename):
    nparr = np.fromstring(encoded_data.decode('base64'), np.uint8)
    img = cv2.imdecode(nparr, cv2.IMREAD_ANYCOLOR)
    return cv2.imwrite(filename, img) 
```

然后在你的代码中的某个地方你可以像这样使用它：

```
save(base_64_string, 'testfile.png');
save(base_64_string, 'testfile.jpg');
save(base_64_string, 'testfile.bmp'); 
```

# facebook-graph-api - 使用 facebook FQL 获取包含所有评论的每个帖子 ID

> ID：16214193
> 
> 赞同：1
> 
> 时间：2013-04-25T12:02:20.437
> 
> 标签：facebook-graph-api, facebook-javascript-sdk, facebook-fql, fql.multiquery

我想使用 fql 查询获取每个帖子 ID 以及页面的所有评论。如果我使用 -

```
SELECT text,post_id  FROM comment  WHERE post_id IN(SELECT post_id  FROM stream  WHERE source_id=page_id_here) 
```

这返回 -

```
{
  "data": [
    {
      "text": "Would be nice if my website would let me do the update. It says I have the most current version 2.5.9 :(",
      "post_id": "2211155996_10151336546425997"
    },
    {
      "text": "All of mine just started showing the update message in the last hour and just got the emails from Admin tools.",
      "post_id": "2211155996_10151336546425997"
    },
........continues 
```

如您所见，它在一个对象中返回文本和 post_id。我想要的是在一个对象中会有 post_id 及其所有评论。希望我在挣扎一个小时时得到答案。这与多查询有关

# solr - 使用搜索结果获取可能的方面字段

> ID：16214195
> 
> 赞同：0
> 
> 时间：2013-04-25T12:02:22.310
> 
> 标签：solr

我正在为我的电子商务项目改进由 solr 提供支持的搜索。所以搜索查询在 Solr 中执行，结果由 Solr 返回。

这工作正常。现在我需要在搜索结果中提供一个方面。第一个可能是类别，这很容易实现，因为类别对所有产品都是通用的，在我所做的查询中，我只启用构面并将类别作为构面字段传递。

但是，对于不同性质的产品，可能会有不同的产品，并且它们几乎没有为它们定义的方面。

我一无所知，因为我怎么会提前知道它们并将其传递给 solr 搜索查询？solr 是否通过某些查询以及搜索结果返回所有方面字段？如果是，如何？

如果不是，那么进一步进行下去的正确方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T05:07:06.093

`Facet Field`使用..传递所有可能的字段（您需要分面）`facet.mincount=1`因此，您将仅获得在您的 solr 数据中至少出现一次的字段

```
http://<hostname>:<portname>/solr/<core_name>/select?q:<fieldname>:<value>&fq=<field_name>:<value>&fl=<field1>,<field2>,<fieldn>&start=0&rows=10&facet=true&facet.field=<field1>&facet.field=<field2>&facet.field=<fieldn>&facet.mincount=1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T07:08:31.753

传递您要对其进行构面过滤的所有唯一构面字段名称，您将获得所有具有构面字段的记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T16:53:55.020

在构面查询搜索中定义所有静态字段名，如果没有命中，您将不会得到该字段的任何结果。

# sql - 选择平均分最高的前 10 名

> ID：16214205
> 
> 赞同：4
> 
> 时间：2013-04-25T12:02:51.137
> 
> 标签：sql, sql-server, select, join

可以说，我有产品和分数表。

```
Product
-------
id
name

Score
-----
id
ProductId
ScoreValue 
```

我想获得 AVERAGE 得分最高的前 10 款产品，如何获得平均值并在一个 select 语句中选择前 10 款产品？

这是我的，它选择了意外的行

```
SELECT TOP 10 Product.ProductName Score.Score 
FROM Product, Score 
WHERE Product.ID  IN (select top 100  productid  
                       from score 
                       group by productid 
                       order by sum(score) desc) 
order by Score.Score desc 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:10:17.440

这可能会做到

```
SELECT TOP 10 p.ProductName, avg( s.Score ) as avg_score
FROM Product p
    inner join Score s on s.product_id = p.product_id
group by p.ProductName, p.product_id
order by avg_score desc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:06:09.147

试试这个，

```
WITH records
AS
(
    SELECT  a.ID, a.Name, AVG(b.ScoreValue) avg_score,
            DENSE_RANK() OVER (ORDER BY AVG(b.ScoreValue) DESC) rn
    FROM    Product a
            INNER JOIN Score b
                ON a.ID = b.ProductID
    GROUP   BY a.ID, a.Name
)
SELECT  ID, Name, Avg_Score
FROM    records
WHERE   rn <= 10
ORDER   BY avg_score DESC 
```

我不使用的原因`TOP`是因为它不会处理具有最高平均值的重复记录。但你可以`TOP WITH TIES`改用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-25T12:09:33.737

请试试：

```
declare @Product as table (id int, name nvarchar(20))
declare @Score as table (id int, ProductID int, ScoreValue decimal(23, 5))

insert into @Product values (1, 'a'), (2, 'b'), (3, 'c')

insert into @Score values (1, 1, 25), (2, 1, 30), (3, 2, 40), (4, 2, 45), (5, 3, 3)

select 
    distinct top 2 name, 
    ProductID, 
    AVG(ScoreValue) over (partition by name) 
from @Product a inner join @Score b on a.id=b.ProductID
order by 3 desc 
```

相应地更改您的表名和行数。

# wpf - 具有自定义排序的 WPF Propertygrid

> ID：16214217
> 
> 赞同：1
> 
> 时间：2013-04-25T12:03:17.133
> 
> 标签：wpf, propertygrid

我正在为我的 WPF 项目寻找一个 PropertyGrid，它允许我自定义列出的属性/类别的顺序。现在我正在使用[Extended WPF Toolkit](https://wpftoolkit.codeplex.com/) s（社区版）PropertyGrid 和`CustomPropertyDescriptor`s。我的研究表明，不可能使用该 PropertyGrid 进行自定义排序。

有（最好是免费的）解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-15T18:49:03.613

扩展 WPF 工具包中的属性排序可以通过使用 PropertyOrderAttribute 属性装饰属性来实现。

如果您不想通过在设计时用属性装饰 POCO 来污染 POCO，或者顺序以某种方式是动态的，那么可以通过创建类型转换器并覆盖 GetProperties 方法在运行时添加属性。例如，如果您希望维护通用 IList 类型的索引顺序：

```
using Xceed.Wpf.Toolkit.PropertyGrid.Attributes;
using System.ComponentModel;

 public class MyExpandableIListConverter<T> : ExpandableObjectConverter
{
    public override PropertyDescriptorCollection GetProperties(ITypeDescriptorContext context, object value, Attribute[] attributes)
    {
        if (value is IList<T>)
        {
            IList<T> list = value as IList<T>; 
            PropertyDescriptorCollection propDescriptions = new PropertyDescriptorCollection(null);
            IEnumerator enumerator = list.GetEnumerator();
            int counter = -1;
            while (enumerator.MoveNext())
            {
                counter++;
                propDescriptions.Add(new ListItemPropertyDescriptor<T>(list, counter));

            }
            return propDescriptions;
        }
        else
        {
            return base.GetProperties(context, value, attributes);
        }
    }        
} 
```

ListItemPropertyDescriptor 定义如下：

```
using Xceed.Wpf.Toolkit.PropertyGrid.Attributes;
using System.ComponentModel;

public class ListItemPropertyDescriptor<T> : PropertyDescriptor
{
    private readonly IList<T> owner;
    private readonly int index;

    public ListItemPropertyDescriptor(IList<T> owner, int index) : base("["+ index+"]", null)
    {
        this.owner = owner;
        this.index = index;

    }

    public override AttributeCollection Attributes
    {
        get
        {
            var attributes = TypeDescriptor.GetAttributes(GetValue(null), false);
            //If the Xceed expandable object attribute is not applied then apply it
            if (!attributes.OfType<ExpandableObjectAttribute>().Any())
            {
                attributes = AddAttribute(new ExpandableObjectAttribute(), attributes);
            }

            //set the xceed order attribute
            attributes = AddAttribute(new PropertyOrderAttribute(index), attributes);

            return attributes;
        }
    }
    private AttributeCollection AddAttribute(Attribute newAttribute, AttributeCollection oldAttributes)
    {
        Attribute[] newAttributes = new Attribute[oldAttributes.Count + 1];
        oldAttributes.CopyTo(newAttributes, 1);
        newAttributes[0] = newAttribute;

        return new AttributeCollection(newAttributes);
    }

    public override bool CanResetValue(object component)
    {
        return false;
    }

    public override object GetValue(object component)
    {
        return Value;
    }

    private T Value
      => owner[index];

    public override void ResetValue(object component)
    {
        throw new NotImplementedException();
    }

    public override void SetValue(object component, object value)
    {
        owner[index] = (T)value;
    }

    public override bool ShouldSerializeValue(object component)
    {
        return false;
    }

    public override Type ComponentType
      => owner.GetType();

    public override bool IsReadOnly
      => false;

    public override Type PropertyType
      => Value?.GetType();

} 
```

此代码的部分内容改编自[以下 SO 答案](https://stackoverflow.com/questions/36286530/xceed-wpf-propertygrid-show-item-for-expanded-collection/36441833)

# asp.net-mvc-4 - Foundation 4 MVC4 网格问题

> ID：16214220
> 
> 赞同：1
> 
> 时间：2013-04-25T12:03:29.917
> 
> 标签：asp.net-mvc-4, zurb-foundation

一些上下文：Foundation 4.0.9 SaSS & Compass(Newbie)，ASP.net MVC 4 设备：屏幕 Chrome/26.0.1410.64 也可以在用户代理中重现问题：Firefox、Chrome、IE Windows 7 64 位

我有一个问题，单列从包含行的左边缘居中/偏移。我期望该列与行的左边缘齐平？

```
<div class="row">
       <div class="large-12 columns">
          <div style="width: 500px; height: 500px;  outline: solid black 1px"> </div>

        </div>
</div> 
```

这是我的小提琴[http://jsfiddle.net/meanFiddler/aWNBp/](http://jsfiddle.net/meanFiddler/aWNBp/)

我知道 Foundation 包含用于中心列的类，例如大中心，尽管我的示例没有直接应用任何内容，并且我看不到它们被 chrome 开发工具面板下的外部样式表应用。

有人知道使用 Foundation 4 的任何深入教程吗？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T18:13:39.637

删除面板 div，您应该会看到所需的结果。面板添加边距和/或填充，我认为这是您*不*想要的。

编辑：我不确定您要做什么，但是，也可能没有必要将宽度设置为 500 像素，因为默认情况下 12 列网格将跨越整个宽度（960 像素）。

# c# - 在 C# 中运行/生成命令 vs 文件

> ID：16214226
> 
> 赞同：1
> 
> 时间：2013-04-25T12:03:46.530
> 
> 标签：c#, spawn

我可以在 C# 中执行以下操作：

```
var pSpawn = new Process
     {
         StartInfo = { WorkingDirectory = @"C:\temp", FileName = fileToRun, CreateNoWindow = true }
     };
     pSpawn.Start(); 
```

这很好用....但是我想知道是否有一种方法可以运行命令（即：“dir / b”）而不必将其封装在批处理文件中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:05:04.157

只需启动 cmd.exe 并传递所需的参数

```
 var pSpawn = new Process
 {
     StartInfo = 
     { 
         WorkingDirectory = @"C:\temp", 
         FileName = "cmd.exe", 
         Arguments ="/K dir /b" }
 };

 pSpawn.Start(); 
```

我添加了参数`/K`以使命令窗口保持打开状态，因此可以看到命令的输出`dir`。
当然，我认为您真的有兴趣捕捉命令的输出。
在这种情况下，您可以使用以下内容：

```
StringBuilder sb = new StringBuilder();
var pSpawn = new Process
{
     StartInfo = 
     { 
        WorkingDirectory = @"C:\temp", 
        FileName = "cmd.exe", 
        Arguments ="/c dir /b", 
        CreateNoWindow = true,
        RedirectStandardOutput = true,
        RedirectStandardInput = true,
        UseShellExecute = false
     }
};

pSpawn.OutputDataReceived += (sender, args) => sb.AppendLine(args.Data);
pSpawn.Start();
pSpawn.BeginOutputReadLine();
pSpawn.WaitForExit();
Console.WriteLine(sb.ToString()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:05:46.463

你可以这样称呼：

```
ProcessStartInfo info = new ProcessStartInfo("cmd.exe");
info.Arguments = "/c dir /b";
Process.Start(info); 
```

# apache-flex - 调度和处理从 ANE（Air Native Extension）到 flex 移动应用程序的事件

> ID：16214235
> 
> 赞同：0
> 
> 时间：2013-04-25T12:04:28.297
> 
> 标签：apache-flex

我的问题的解释需要一些背景信息，使问题有点长，所以请耐心等待。

ANE（Air Native Extension）由 3 部分组成，允许您使用设备特定功能的本机代码（我使用的是 android），访问这些本机代码功能并使它们可用于 Flex 移动应用程序的 actionscript 库，和 Flex 移动应用程序。

对于我的 ANE，我在从广播接收器扩展的 onReceive() 方法中获取互联网信息。现在该方法不会返回任何内容，所以当它完成后，我将它存储在一个全局变量中并发送一个事件，说明信息已准备好。

actionscript 接口监听这个事件，当它接收到它时，它会更新一个全局变量，然后还分派一个事件告诉 flex 移动应用程序信息已准备好。

因此，当 flex 移动应用程序得知它需要的信息已准备好时，它会进入并获取它。

如果解释不够清楚，这是我如何编码的示例：

```
NATIVE CODE:
public MyClass(AnotherClass v,FREContext c){
    this.v = v;
    this.c = c;       //Will use c to dispatch event
}
onReceive(){
    ....code....
    String x = "internet info"
    AnotherClass.setGlobalVar(x);
    c.dispatchStatusEventAsync("status", "internetInfoReady");
}

ACTIONSCRIPT INTERFACE CODE:
private var context:ExtensionContext;
var info:String;
public function Interface(){
    context = ExtensionContext.createExtensionContext("id",null);
    context.addEventListener(StatusEvent.STATUS,onStatus);
}

public function scan():void{
    //calls function that runs asynchronously to get internet info
}
public function onStatus(event:StatusEvent):void{
    if((event.level == "status") && (event.code="internetInfoReady")){
        info=String(context.all("getInfo"));  //function that retrieves value x in AnotherClass and returns it
        dispatchEvent(new Event("internetInfoReady"));
    }

}

public function getInfo():String{
    return info;
}

FLEX MOBILE APP CODE:
<s:View ....
<fx:Script>
    <![CDATA[
        var a:Interface = new Interface();

        protected function getInfo(event:MouseEvent):void{
            a.scan();
            test.addEventListener("internetInfoReady",onGetInfo);
        }

        protected function onGetInfo(evt:Event):void{
            var info:String = "";
            if(evt.type == "internetInfoReady"){
                info = a.getInfo();
                a.toast(info);  //function that calls android built in toast commands
            }
        }
    ]]>
</fx:Script>

<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<s:Button left="251" right="250" top="40" height="43" label="Get Info" click="getInfo(event)"
          fontFamily="Arial" horizontalCenter="0"/> 
```

该应用程序没有在我的设备上运行，我只想确保我正在正确调度事件。我创建了一个 android 应用程序，它使用已经编写的本机代码来显示在屏幕上获得的信息，这样我就可以确保这部分工作正常，所以我知道这不是问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T19:28:57.703

你的 as3 接口类必须**`extends EventDispatcher`**.

我注意到一个奇怪的事情，以防扩展项目中的自定义事件

```
dispatchEvent(new CustomEvent(CustomEvent.CONSTANT, someData)); 
```

不触发事件，但

```
var ce:CustomEvent = new CustomEvent(CustomEvent.CONSTANT);
    ce.data = someData;
    dispatchEvent(ce); 
```

工作正常

# delphi - 如果在 Win7 中禁用主题，TGridPanel 没有透明度

> ID：16214237
> 
> 赞同：0
> 
> 时间：2013-04-25T12:04:34.507
> 
> 标签：delphi, delphi-xe2

我有一个填满 TImage 的表格。我把它放在了一个 TGridPanel 上。如果在 Windows 7 中启用了主题，则 TGirdPanel 会以透明方式显示。如果主题被禁用（没有视觉样式），TGridPanel 会失去透明度并隐藏它占据的部分。我用德尔福 XE2

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T09:28:48.630

这是面板的基本生活事实。它对 没有什么特别的`TGridPanel`，您将看到任何从`TCustomPanel`. 仅当应用程序为主题时才支持透明度。

网格面板只是布局控件的一种便捷方式。如果您想支持非主题运行，那么最简单的解决方案是`TGridPanel`手动删除和布局您的控件。这几乎是微不足道的。处理`OnResize`当前包含面板的控件的事件，并根据需要定位控件。

# java - 如何在 REST 中处理异步操作

> ID：16214244
> 
> 赞同：14
> 
> 时间：2013-04-25T12:04:50.923
> 
> 标签：java, http, rest, asynchronous

我需要了解在 REST 中处理异步操作的方法以及它们的优缺点是什么。我发现的一些方法：

1.  **基于资源：**将操作的状态建模为状态。用户进行异步 REST 调用（PUT、POST 等）获取`Accepted`或`In-Progress`响应（`202`）。此外，通过 GET 反复轮询状态 URI，以检查来自操作执行的状态/进度/消息。

    **问题：**该资源在服务器上应该活动多长时间？如果客户端在操作完成之间的大间隔轮询，我们如何返回状态？似乎坚持执行状态会起作用。但是坚持多久，什么时候存档/删除，是这种标准的做法吗？

2.  **基于回调：**异步请求需要有回调 URI。请求被异步处理，并在完成后使用操作状态/结果调用回调 URI。

    **问题：**这似乎更优雅，并且在服务器端涉及更少的开销。但是如何处理回调服务器间歇性宕机、无响应等场景呢？在回调 URI 也提供重试配置的情况下实现典型的重试？这种方法还有其他缺点吗？

3.  **Servlet 3.0 异步支持：** HTTP 客户端与 Java Servlet 建立连接，Java Servlet 一直保持打开状态，直到它被显式关闭，并且在关闭之前，客户端和服务器可以通过它进行异步通信。

    **问：**自从它的 Servlet 3.0 规范以来，我认为 Spring REST 实现 Jersey 目前还没有使用这种方法。是否有任何特定的 REST 实现使用类似的方法或指针来使其成为可能？

4.  还有其他方法，也许是商业方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-01T11:46:01.633

Spring 3.2+ 支持 Servlet 3.0 的异步特性。来自[春季博客](https://spring.io/blog/2012/05/10/spring-mvc-3-2-preview-making-a-controller-method-asynchronous/)：

> 您可以通过将任何现有控制器方法更改为返回 Callable 来使任何现有控制器方法异步。例如，返回视图名称的控制器方法可以返回 Callable。返回一个名为 Person 的对象的 @ResponseBody 可以改为返回 Callable。任何其他控制器返回值类型也是如此。

Jersey 2+ 还支持异步服务器。请参阅参考文档中的[异步服务和客户端](https://jersey.java.net/documentation/latest/async.html)章节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T13:13:13.523

我认为，该方法取决于初始请求和操作结束之间的时间间隔。

*   对于短时间操作（< 10s），我只会保持请求打开并在操作完成后返回响应；
*   对于长操作（< 30m），我会使用 servlet 3.0 或 Comet 模型；
*   对于极长的操作（几小时，几天）来说，对我来说，这只是基于客户端的轮询或具有大超时的 Comet。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-27T16:00:15.047

我知道这已经过时了，但我想我会在这里插话说，如果你想要的是可以在无状态环境中扩展的东西，那么你应该选择你的第一个选择。您可以在任何地方执行底层操作，如果您将结果放入 redis 之类的东西中，则客户端发出后续轮询请求的 Web 服务器无关紧要。我通常会将轮询间隔放在发送给客户端的响应中。当结果准备好时，我将向客户端返回一个 SEE OTHER，其中包括 URI 中结果的 id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-01T11:24:51.427

我现在正在处理相同的情况，并找到了使用`Location`标头响应提供可以监视以检查状态的资源的常用方法（当然是通过轮询）。这似乎是最好的，但就我而言，我没有创建资源，所以我没有检查状态的位置（我的异步过程只是为了构建一个缓存页面）。

您始终可以使用自己的标题来给出完成操作的估计时间。无论如何，我正在考虑使用`Retry-After`标题来给出估计时间。你们有什么感想？

# ember.js - 子视图中处理的事件是否会冒泡到父视图？

> ID：16214247
> 
> 赞同：1
> 
> 时间：2013-04-25T12:04:53.987
> 
> 标签：ember.js

如果在子视图上触发事件，它是否不仅在子视图中处理，也在父视图中处理？

这是一个 Ember View 测试：

```
test("event manager should be able to re-dispatch events to view", function() {

  var receivedEvent=0;
  view = Ember.ContainerView.createWithMixins({
    elementId: 'containerView',

    eventManager: Ember.Object.create({
      mouseDown: function(evt, view) {
        // Re-dispatch event when you get it.
        //
        // The second parameter tells the dispatcher
        // that this event has been handled. This
        // API will clearly need to be reworked since
        // multiple eventManagers in a single view
        // hierarchy would break, but it shows that
        // re-dispatching works
        view.$().trigger('mousedown',this);
      }
    }),

    childViews: ['child'],

    child: Ember.View.extend({
      elementId: 'nestedView',

      mouseDown: function(evt) {
        receivedEvent++;
      }
    }),

    mouseDown: function(evt) {
      receivedEvent++;
    }
  });

  Ember.run(function() { view.append(); });

  Ember.$('#nestedView').trigger('mousedown');
  equal(receivedEvent, 2, "event should go to manager and not view");
}); 
```

我的问题是：为什么`receivedEvent`是 2，而不是 1？事件处理的顺序是什么？子视图不应该停止事件传播吗？

# vb.net - 双复选框选择vb/winform

> ID：16214256
> 
> 赞同：1
> 
> 时间：2013-04-25T12:05:18.537
> 
> 标签：vb.net, winforms, datagridview

我正在寻求一点帮助：

我有一个 datagridview 控件，我在其中添加了另外几列（作为复选框）以选择多行。当我选择第一个复选框列时，我希望自动选择第二个复选框，但如果需要，可以取消选择。如果第一个复选框被取消选中，第二个复选框也会自动取消选中。

我有这个使用以下代码：

```
Private Sub dgvBikeAvailability_CellContentClick(sender As System.Object, e As System.Windows.Forms.DataGridViewCellEventArgs) Handles dgvBikeAvailability.CellContentClick

    Debug.Print("Row index = " + e.RowIndex.ToString + ". Column index = " + e.ColumnIndex.ToString + ". Column Name = ")
    'Debug.Print()
    'when a bike is selected, a helmet is automatically selected, but can be deselected if the customer requires
    If e.ColumnIndex = 0 Then
        dgvBikeAvailability.Rows(e.RowIndex).Cells(0).Value = Not dgvBikeAvailability.Rows(e.RowIndex).Cells(0).Value
        dgvBikeAvailability.Rows(e.RowIndex).Cells(1).Value = dgvBikeAvailability.Rows(e.RowIndex).Cells(0).Value
    End If

End Sub 
```

不幸的是，当刷新 datagridview 时，列索引增加，2 个复选框列的列索引现在是 2 和 3。

我希望能够按名称引用它们。它们在刷新 datagridview 的 sub 中声明：

```
colBikeSelectionCheckBox.HeaderText = "Select Bike"    
colBikeSelectionCheckBox.Name = "colSelectBike")
colHelmetCheckBox.Name = "colSelectHelmet"
dgvBikeAvailability.Columns.Add(colHelmetCheckBox) 
```

但 System.Windows.Forms.DataGridViewCellEventArgs 类不允许我选择列名。

任何想法和建议将不胜感激！

编辑：更深入的代码段：

```
 Private Sub frmBikeHire_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    refreshGrid()
    getStaffMember()
End Sub

'loads and refreshes the dgv
Private Sub refreshGrid()
    Dim i As Integer

    'initially fill in the rental dates for current day
    txtDateFrom.Text = CStr(MonthCalendar1.SelectionRange.Start)
    txtDateTo.Text = CStr(MonthCalendar1.SelectionRange.End)

    'grab data from DB, set as dgv datasource
    startDate = CStr(MonthCalendar1.SelectionRange.Start)
    endDate = CStr(MonthCalendar1.SelectionRange.End)
    dtBikeAvailability = sqlFuncDB_getDataTable("SELECT * FROM tb_bikeDetail WHERE bikeid NOT IN (SELECT DISTINCT bikeid FROM tb_bikemovements WHERE bikeMovementDate BETWEEN '" + func_convertDateSQLSERVER(startDate) + "' AND '" + func_convertDateSQLSERVER(endDate) + "') AND bikeid NOT IN (SELECT tb_bikemovements.bikeid FROM tb_bikemovements JOIN (SELECT bikeid, max(bikemovementdate) bmd FROM tb_bikemovements WHERE bikemovementdate < '" + func_convertDateSQLSERVER(startDate) + "' group by bikeid) lastmove ON lastmove.bikeid=tb_bikemovements.bikeid AND lastmove.bmd=tb_bikemovements.bikemovementdate WHERE bikeMovementType = '0')")
    dvBikeAvailability = New DataView(dtBikeAvailability)
    dgvBikeAvailability.DataSource = dvBikeAvailability

    'switch off all columns
    For i = 0 To dgvBikeAvailability.Columns.Count - 1
        dgvBikeAvailability.Columns(i).Visible = False
    Next

    'displays only relevant column(s)
    dgvBikeAvailability.Columns("bikeName").Visible = True
    dgvBikeAvailability.Columns("bikeName").HeaderText = "Bike Name"
    dgvBikeAvailability.Columns("bikeStyle").Visible = True
    dgvBikeAvailability.Columns("bikeStyle").HeaderText = "Bike Style"
    dgvBikeAvailability.Columns("bikeColour").Visible = True
    dgvBikeAvailability.Columns("bikeColour").HeaderText = "Bike Colour"

    'remove this line for program deployment
    dgvBikeAvailability.Columns("bikeID").Visible = True
    dgvBikeAvailability.Columns("bikeID").HeaderText = "Bike Number"

    'add new check box column for selecting the bike 
    Dim colBikeSelectionCheckBox As New DataGridViewCheckBoxColumn
    colBikeSelectionCheckBox.DataPropertyName = "PropertyName"
    colBikeSelectionCheckBox.HeaderText = "Select Bike"
    colBikeSelectionCheckBox.Name = "colSelectBike"
    dgvBikeAvailability.Columns.Add(colBikeSelectionCheckBox)

    'add new column for selecting helmet - consider adding as default setting
    Dim colHelmetCheckBox As New DataGridViewCheckBoxColumn
    colHelmetCheckBox.DataPropertyName = "PropertyName"
    colHelmetCheckBox.HeaderText = "Helmet?"
    colHelmetCheckBox.Name = "colSelectHelmet"
    dgvBikeAvailability.Columns.Add(colHelmetCheckBox)

    dgvBikeAvailability.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill

End Sub

Private Sub MonthCalendar1_DateChanged(sender As System.Object, e As System.Windows.Forms.DateRangeEventArgs) Handles MonthCalendar1.DateChanged
    refreshGrid()
End Sub

Private Sub dgvBikeAvailability_CellClick(sender As Object, e As     System.Windows.Forms.DataGridViewCellEventArgs) Handles dgvBikeAvailability.CellClick
    Debug.Print("Row index = " + e.RowIndex.ToString + ". Column index = " + e.ColumnIndex.ToString + ". Column Name = " + dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectBike").OwningColumn.ToString)

    If dgvBikeAvailability.Columns(e.ColumnIndex).Name = "colSelectBike" Then
        dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectBike").Value = Not dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectBike").Value
        dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectHelmet").Value = dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectBike").Value
    End If

End Sub 
```

我不确定为什么这不起作用。每次更改日历控件时，它都会刷新 datagridview，这会增加列索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:18:37.007

您可以使用`DataGridViewCellEventArgs`类提供的列索引来检索列，并从中获取要比较的名称。

所以像：

```
If dgvBikeAvailability.Columns(e.ColumnIndex).Name == "colSelectBike" Then
    ' Your logic here
End If 
```

为了引用代码中的列来切换复选框，您可以非常愉快地使用名称，实际上不需要事件参数提供的索引。事件参数索引似乎仅用于检查是否选择了所需的列之一。

```
dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectBike").Value = Not dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectBike").Value
dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectHelmet").Value = dgvBikeAvailability.Rows(e.RowIndex).Cells("colSelectBike").Value 
```

* * *

尽管上面的代码*应该可以*工作，但您的网格似乎发生了一些奇怪的事情。一个快速的解决方案是代替使用DataGridView`.Add()`的`.Insert()`方法，它提供了一个索引参数，允许您直接控制列的位置。

# git - 如何将一系列提交添加到另一个分支？

> ID：16214261
> 
> 赞同：1
> 
> 时间：2013-04-25T12:05:38.120
> 
> 标签：git, branch

在 git 中，如何应用提交序列“DE”

```
master       A-B
                \
py3-version      C-D-…-E 
```

回到master上，得到

```
master       A-B - <D patch applied> - <…&gt; - <E patch applied>
                \
py3-version      C-D-…-E 
```

我想这样做是因为`master`它是一个 Python 2 版本，它是一个*自动生成*`C`的 Python 3 版本（通过），我需要改进（到）。现在，我想将改进放回到master分支上（最终忘记和，它将从新的 master 分支重新生成）。如何才能做到这一点？*`2to3``D``E``D``E``C``py3-version`*

 ** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:31:33.153

这在 git lingo 中被调用`cherry-picking`，您可以在其中有选择地将更改从一个分支导入另一个分支：

```
git checkout master
git cherry-pick py3-version~10..py3-version 
```

这将从“py3-version”分支中选择最后 10 个提交。

如果发生冲突，系统会提示您手动解决它们。然后你应该继续挑选樱桃`git cherry-pick --continue`（或者`git cherry-pick --abort`，如果出现问题）。*

# c - 通过内存布局中的确定性字段排序可以获得什么？

> ID：16214268
> 
> 赞同：1
> 
> 时间：2013-04-25T12:05:58.937
> 
> 标签：c, struct

[结构的成员按照它们在声明中出现的顺序在结构内分配，并且具有升序地址。](https://stackoverflow.com/a/2749009/1145760)

我面临以下**困境**：当我需要声明一个结构时，我是否

(1) 对字段进行逻辑分组，或

（2）按大小递减顺序，节省RAM和ROM的大小？

这是一个示例，其中最大的数据成员应该在顶部，但也应该与逻辑连接的分组`colour`：

```
struct pixel{
    int posX;
    int posY;

    tLargeType ColourSpaceSecretFormula;
    char colourRGB[3];
} 
```

结构的填充是不确定的（即依赖于实现），因此我们不能可靠地对结构元素进行指针运算（我们不应该：想象有人根据自己的喜好重新排序字段：BOOM，整个代码停止工作）。

*-fpack-structs*在 gcc 中解决了这个问题，但有其他限制，所以让我们把编译器选项排除在外。

另一方面，代码首先应该是*可读*的。应不惜一切代价避免微优化。

所以，我想知道，**为什么结构的成员按标准排序，让我担心以特定方式排序结构成员的微优化？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:55:56.107

编译器受到几个传统和实际限制的限制。

转换后指向结构的指针（标准称其为“适当转换”）将等于指向结构第一个元素的指针。这通常用于在消息传递中实现消息的重载。在这种情况下，结构的第一个元素描述了结构其余部分的类型和大小。

最后一个元素可以是动态调整大小的数组。甚至在官方语言支持之前，这已经在实践中经常使用。您分配`sizeof(struct) + length of extra data`并可以访问最后一个元素作为具有您分配的许多元素的普通数组。

这两件事迫使编译器在结构中具有第一个和最后一个元素，其顺序与声明它们的顺序相同。

另一个实际要求是每次编译都必须以相同的方式对结构成员进行排序。一个聪明的编译器可以做出决定，因为它看到一些结构成员总是被彼此靠近访问，它们可以以一种使它们最终进入缓存行的方式重新排序。这种优化在 C 中当然是不可能的，因为结构通常在不同的编译单元之间定义一个 API，我们不能只是在不同的编译中以不同的方式重新排序。

考虑到这些限制，我们能做的最好的事情是在 ABI 中定义某种打包顺序，以尽量减少不触及结构中第一个或最后一个元素的对齐浪费，但这会很复杂、容易出错并且可能不会买很多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:13:01.673

如果您不能依赖排序，那么编写将结构映射到硬件寄存器、网络数据包、外部文件格式、像素缓冲区等的低级代码将更加困难。

此外，一些代码使用了一个技巧，它假设结构的最后一个成员是内存中地址最高的，以表示更大数据块的开始（在编译时大小未知）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T12:56:38.037

重新排序结构的字段有时可以在数据大小和代码大小方面产生良好的收益，尤其是在 64 位内存模型中。这里举个例子来说明（假设常见的对齐规则）：

```
struct list {
   int  len;
   char *string;
   bool isUtf;
}; 
```

在 32 位模式下将占用 12 个字节，但在 64 位模式下将占用 24 个字节。

```
struct list {
   char *string;
   int  len;
   bool isUtf;
}; 
```

在 32 位模式下将占用 12 个字节，但在 64 位模式下仅占用 16 个字节。

如果您有这些结构的数组，您的数据和代码大小都会增加 50%，因为以 2 的幂为索引比在其他大小上更简单。如果您的结构是单例或不频繁，则重新排序字段没有多大意义。如果用得很多，那就是看点。

至于你问题的另一点。为什么编译器不对字段进行这种重新排序，因为在这种情况下，很难实现使用通用模式的结构的联合。比如说。

```
struct header {
    enum type;
    int  len;
};

struct a {
    enum type;
    int  len;
    bool whatever1;
};

struct b {
    enum type;
    int  len;
    long whatever2;
    long whatever4;
};

struct c {
    enum type;
    int  len;
    float fl;
};

 union u {
    struct h header;
    struct a a;
    struct b b;
    struct c c;
 }; 
```

如果编译器重新排列字段，这种结构会更加不方便，因为`type`在`len`通过`union`. 如果我没记错的话，标准甚至要求这种行为。

# python - 全局变量作为函数输入而不是参数

> ID：16214271
> 
> 赞同：0
> 
> 时间：2013-04-25T12:06:04.830
> 
> 标签：python

我只是在学习 Python 的工作原理，在阅读了一段时间后，我仍然对全局变量和正确的函数参数感到困惑。考虑 case 全局变量在函数内部没有被修改，只被引用。

可以使用全局变量代替函数参数吗？我听说使用全局变量被认为是一种不好的做法。在这种情况下会是这样吗？

不带参数调用函数：

```
def myfunc() :
    print myvalue

myvalue = 1
myfunc() 
```

带参数调用函数

```
def myfunc(arg) :
    print arg

myvalue = 1
myfunc(myvalue) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:13:19.997

> 我听说使用全局变量被认为是一种不好的做法。在这种情况下会是这样吗？

这取决于您要达到的目标。如果`myfunc()`应该打印任何值，那么...

```
def myfunc(arg):
    print arg

myfunc(1) 
```

...更好，但如果`myfunc()`应该始终打印相同的值，那么...

```
myvalue = 1

def myfunc():
    print myvalue

myfunc() 
```

...更好，尽管有一个如此简单的示例，您也可以将全局因素考虑在内，然后使用...

```
def myfunc():
    print 1

myfunc() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:08:48.577

是的。在这些情况下，使变量`global`有效，而不是将它们作为函数参数传递。但是，问题是一旦你开始编写更大的函数，你很快就会用完名字，而且很难维护全局定义的变量。如果您不需要编辑变量而只想读取它，则无需`global`在函数中定义它。

在此处阅读有关全局变量的缺点 -[全局变量是否不好？](https://stackoverflow.com/questions/484635/are-global-variables-bad)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:11:48.743

这取决于你想做什么。

如果您需要更改在函数外部声明的变量的值，则不能将其作为参数传递，因为这会在函数范围内创建该变量的“副本”。
但是，如果您只想使用变量的值，则应将其作为参数传递。这样做的好处是你不能不小心弄乱全局变量。

此外，您应该在使用全局变量之前声明它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:31:20.937

使用函数参数比使用全局变量更好的原因有以下几个：

1.  它消除了可能的混淆：一旦您的程序变大，就很难跟踪在哪里使用了哪个全局变量。传递函数参数可以让您更清楚地了解函数使用哪些值。
2.  如果你使用全局变量，你最终会犯一个特别的错误，在你理解发生了什么之前，这看起来*很奇怪。*它与修改和读取同一函数中的全局变量有关。稍后再谈。
3.  全局变量都存在于同一个命名空间中，因此您很快就会遇到名称重叠的问题。如果你想要两个不同的名为“index”的变量怎么办？打电话给他们会变得非常混乱，非常快`index1`。`index2`使用局部变量，或函数参数，意味着它们都存在于不同的命名空间中，混淆的可能性大大降低。

现在，我提到了在同一个函数中修改和读取全局变量，以及可能导致的令人困惑的错误。这是它的样子：

```
record_count = 0  # Global variable
def func():
    print "Record count:", record_count
    # Do something, maybe read a record from a database
    record_count = record_count + 1  # Would normally use += 1 here, but it's easier to see what's happening with the "n = n + 1" syntax 
```

这将失败：`UnboundLocalError: local variable 'record_count' referenced before assignment`

等等，什么？当它显然是全局变量时，为什么`record_count`被视为局部变量？好吧，如果你从未在函数中*赋值*，`record_count`那么 Python 将使用全局变量。但是当你给 赋值时`record_count`，Python 不得不猜测你的意思：是要修改全局变量，还是要创建一个新的局部变量来隐藏（隐藏）全局变量，并且只处理局部变量多变的。Python 会默认假设你对全局变量很聪明（即，在不知道你在做什么和为什么的情况下不修改它们*）*，并假设你打算创建一个名为`record_count`.

但是，如果您要访问`record_count`函数内部命名的局部变量，Python 将不允许您访问函数内部具有相同名称的全局变量。这是为了避免一些非常*讨厌的*、难以追踪的错误。这意味着如果这个函数有一个名为的*局部*变量`record_count`——并且由于赋值语句而确实如此——那么*所有*访问都`record_count`被认为是访问局部变量。**包括**语句中的访问`print`，在定义局部变量的值之前。因此，`UnboundLocalError`例外。

现在，给读者做一个练习。删除 print 语句并注意*仍然*抛出异常`UnboundLocalError`。你能弄清楚为什么吗？（提示：在分配给变量之前，必须计算分配右侧的值。）

 *现在：如果你*真的*想`record_count`在你的函数中使用全局变量，这样做的方法是使用 Python 的`global`语句，它说“嘿，我要指定这个变量名？永远不要让它成为局部变量，即使我分配给它。而是分配给全局变量。” 它的工作方式只是`global record_count`（或任何其他变量名），位于函数的开头。因此：

```
record_count = 0  # Global variable
def func():
    global record_count
    print "Record count:", record_count
    # Do something, maybe read a record from a database
    record_count = record_count + 1  # Again, you would normally use += 1 here 
```

这将首先满足您的期望。但希望现在你明白*为什么*它会起作用，而另一个版本不会。*

# java - 在 v2 地图上绘制不同颜色的折线

> ID：16214275
> 
> 赞同：3
> 
> 时间：2013-04-25T12:06:16.273
> 
> 标签：java, android, google-maps, rgb

我在版本 2 谷歌地图上使用 for 循环绘制多条折线。我正在使用代码为折线设置颜色。

```
mMap.addPolyline(new PolylineOptions()
.add(new LatLng(lats, lons), new LatLng(late,lone))
.width(5)
.color(0xFFFF0000)); 
```

如何为每个 for 循环迭代动态增加 RGB 颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:21:30.643

```
 Random rnd = new Random(); 
  int color = Color.argb(255, rnd.nextInt(256), rnd.nextInt(256), rnd.nextInt(256));  
  --- loop ----

   mMap.addPolyline(new PolylineOptions()
  .add(new LatLng(lats, lons), new LatLng(late,lone))
  .width(5)
  .color(color)); 
```

# javascript - 通过选择框更新图像时如何在画布中保留 z-index

> ID：16214279
> 
> 赞同：0
> 
> 时间：2013-04-25T12:06:24.143
> 
> 标签：javascript, jquery, canvas, html5-canvas

我正在构建一个扑克桌制造商，其工作方式如下：

1.  当页面加载时，我一个一个地加载扑克桌的组件。
2.  最终用户通过选择框在他们的扑克桌上选择需要什么样的毛毡、扶手、身体或杯托。
3.  当在选择框中检测到更改时，Image 对象的 src 属性也会更改。例如：如果用户想要黑色毛毡，我正在加载图像：felts/black.png；然后如果他认为蓝色看起来更好，则页面加载图像毡/blue.png

我的问题如下：

一旦他们更改了扑克桌的一个元素，新图像就会自动加载到其余元素之上。

例如：如果我改变毛毡的颜色，毛毡的图像会出现在扶手的图像之上。

我想知道如何强制毛毡图像保持其 z-index 之类的东西。

这是我的代码：

```
 var tableBody = new Image();
 tableBody.onload = function() {
  context.drawImage(tableBody, 0, 0);
 };

 tableBody.src = "http://www.mcptables.com/images/buildyourtable/body/autumn-oak.png";

 /* and it does the same thing for the other parts of the poker table... tableArmrest, tableFelt
    tableCupholders, etc... */

 $('#armrest').change(
function() {
    switch( $(this).val() ) {
        case "black":
                tableArmrest.src = "http://www.mcptables.com/images/buildyourtable/armrest/black.png";
        break;
        case "brown":
                tableArmrest.src = "http://www.mcptables.com/images/buildyourtable/armrest/wood.png";
    }
}
) 
```

您可以在以下页面上看到它的实际效果：

[http://mcptables.com/buildyourtable.html](http://mcptables.com/buildyourtable.html)

这是我的 JS 代码的链接：

[http://mcptables.com/js/pokertablebuilder.js](http://mcptables.com/js/pokertablebuilder.js)

任何帮助将不胜感激！如果我想改变

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:11:50.713

不幸的是，没有办法维护画布上已绘制对象的 z-index。您所能做的就是删除所有内容并适当地重绘。

有画布框架可以解决这个问题，并为开发人员提供画布上单独对象的“印象”。参见 processing.js、raphael、kineticjs 等

# jquery - jquery如何找到被拖拽的元素

> ID：16214281
> 
> 赞同：0
> 
> 时间：2013-04-25T12:06:32.333
> 
> 标签：jquery, drag

有哪些可能的方法来查找元素被拖动？

我使用了 jquery draggable() 方法，这与其他鼠标事件冲突。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:21:57.237

基本方法是`e.target`在拖动事件中使用：

```
 $('#draggable').draggable({
        drag:function(e){
           var $draggedElem = $(e.target);
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:20:19.347

尝试这个：

```
$(element).draggable(function(){
 start: function (event, ui) {
    var currentDraggable = ui.draggable;
  }
}); 
```

或者

```
 var currentDraggable = ui.helper; 
```

# django - Django模板 - 根据一天中的时间隐藏内容

> ID：16214282
> 
> 赞同：0
> 
> 时间：2013-04-25T12:06:33.260
> 
> 标签：django, django-templates

如果时间不是 09:00 到 17:00 之间的工作日，我想在我的模板 (base.html) 中隐藏一个块。

我在想类似的东西（非常简化）：

```
{% if now is 09:00 and 17:00 on weekdays %}

#Show callback form

{% else %}

#We do not answer the phone before 09:00 and after 17:00 

{% endif %} 
```

可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:23:10.193

我建议在你的`view.py`

```
import datetime

# In view
now = datetime.datetime.now()
call_us_now = False
if 9 < now.hour < 17:
   call_us_now = True

# Send 'call_us_now' to context 
```

.

```
{# In template #}
{% if call_us_now %}
    {# Show callback form #}
{% else %}
    {# We do not answer the phone before 09:00 and after 17:00 #}
{% endif %] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T14:42:25.803

> 我想在我的 base.html 上使用这个代码，所以在每个视图上实现你的代码可能有点困难？

写一个自定义`template context processor`。您可以以此为起点：

```
from datetime import datetime, time

from django.conf import settings

def calling_flag(request):
    """ Sets the flag in the template if the current time is between CALL_HOURS """
    if settings.CALL_HOURS:
        now = datetime.now().time()
        start_time,end_time = settings.CALL_HOURS
        start_time = time(start_time[:2],start_time[-2:])
        end_time = time(end_time[:2],end_time[-2:])
        return {'IN_TIME': start_time <= now <= end_time} 
```

将其保存在应用程序内的文件中。假设应用程序被调用`feedback`，并且您将上述代码放在目录中调用的文件`custom_template_flags.py`中`feedback`。下一步，将其添加到您的`settings.py`：

```
TEMPLATE_CONTEXT_PROCESSORS = (
    # -- your other context processors
    'feedback.custom_template_flags.calling_flag',
) 
```

最后，再次添加您的时间范围`settings.py`：

```
CALL_HOURS = ('0900','1700') 
```

现在，所有模板都将`{{ IN_TIME }}`具有`True`或`False`。

# css - 如何在引导进度条中垂直对齐文本

> ID：16214285
> 
> 赞同：6
> 
> 时间：2013-04-25T12:06:37.720
> 
> 标签：css, twitter-bootstrap

我修改了引导进度条的高度，您可以在以下链接中看到：http: [//jsfiddle.net/8Xf2j/31/](http://jsfiddle.net/8Xf2j/31/)

我想要做的是文本垂直居中。我试图添加属性：

```
vertical-align:middle 
```

但它不起作用......我还想增加包含进度条的文本的字体大小添加：

```
font-size:30px; 
```

正如您将在 de fiddle 中看到的那样，它也不起作用。任何想法或建议将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-25T12:08:18.213

实现单行文本垂直对齐的一种方法是使`line-height`匹配达到所需的高度。

**示例：http:** [//jsfiddle.net/VQS2k/](http://jsfiddle.net/VQS2k/)

```
.progress {
    height: 40px;
    font-size: 30px;
}
.bar {
    font-size: 30px;
    line-height: 40px;
} 
```

**普通版（无引导）：http:** [//jsfiddle.net/VQS2k/1/](http://jsfiddle.net/VQS2k/1/)

# sql - 存储过程的问题

> ID：16214286
> 
> 赞同：0
> 
> 时间：2013-04-25T12:06:39.260
> 
> 标签：sql, stored-procedures, sybase, sap-ase

我有一个有问题的 sybase 存储过程。

在这里，如果我直接使用插入语句，插入可以完美地工作，如图所示：

```
insert 
  into dbo.StudentData
     ( studID
     , studLetters
     , studCode 
     , studTelecast 
     , studName
     , monthCode
     , reportDate
     , startTime
     , endTime
     , startDateTime
     , endDateTime
     , cost
     , duration
     , creationTime
     )
values
     ( 113
     , 'ABCD'
     , 222
     , 333
     , 'One'
     , 02
     , getDate()
     , getdate()
     , getdate()
     , getdate()
     , getdate()
     , 999
     , 11
     , getdate()
     )
     ; 
```

但是，如果我使用存储过程，我会收到以下错误：

```
[EXEC - 0 row(s), 0.000 secs]  [Error Code: 102, SQL State: 42000]  Incorrect syntax near ')'.

exec dbo.sp_loadStudData(113, 'ABCD', 222, 333, 'One', 02, getDate(), getdate(), getdate(), getdate(), getdate(), 999, 11, getdate() ) 
```

我无法找出问题所在，但存储过程已成功创建，没有任何错误。存储的 Proc 如下：

```
create proc dbo.sp_loadStudData
(
@studID int,                   
@studLetters varchar(255),
@studCode int,
@studTelecast int,
@studName varchar(25),
@monthCode int,
@reportDate datetime,
@startTime datetime,
@endTime datetime,
@startDateTime datetime,
@endDateTime datetime,
@cost int,
@duration int,
@creationTime datetime
)
as
begin
set nocount on

insert into dbo.StudentData(studID,studLetters,studCode ,studTelecast ,studName ,monthCode,reportDate,startTime,endTime,startDateTime,endDateTime,cost,duration,creationTime)
values(@studID,@studLetters,@studCode ,@studTelecast ,@studName ,@monthCode,@reportDate,@startTime,@endTime,@startDateTime,@endDateTime,@cost,@duration,@creationTime)

end
go
EXEC sp_procxmode 'dbo.sp_loadStudData', 'unchained'
go
IF OBJECT_ID('dbo.sp_loadStudData') IS NOT NULL
    PRINT '<<< CREATED PROCEDURE dbo.sp_loadStudData >>>'
ELSE
    PRINT '<<< FAILED CREATING PROCEDURE dbo.sp_loadStudData >>>'
go
GRANT EXECUTE ON dbo.sp_loadStudData TO developers
go
GRANT EXECUTE ON dbo.sp_loadStudData TO web_group
go
GRANT EXECUTE ON dbo.sp_loadStudData TO crd_group
go
GRANT EXECUTE ON dbo.sp_loadStudData TO wd_group
go 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:27:07.267

我不是 Sybase 方面的专家，但肯定在 SQL Server 中，您需要首先将 getdate() 返回值存储在一个变量中。

即你不能...

```
EXEC MyProc getdate(), getdate(), getdate() 
```

但是你可以

```
DECLARE @Now DATETIME
SET @Now = GETDATE()
EXEC MyProc @Now, @Now, @Now 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T16:01:41.193

在此处删除大括号并运行

exec dbo.sp_loadStudData 113, 'ABCD', 222, 333, '一', 02, getDate(), getdate(), getdate(), getdate(), 999, 11, getdate()

# windows - x64 和 x86 机器中基于条件的文件安装

> ID：16214287
> 
> 赞同：0
> 
> 时间：2013-04-25T12:06:41.530
> 
> 标签：windows, build, installation, wix, windows-installer

嗨，我如何更新我的安装程序脚本条件以在 x86 和 x64 机器上安装以下文件。

```
<Component Id="Comp.Comp1" Guid="*" >
  <Condition><![CDATA[VersionNT < 602]]></Condition>
  <File Id="File1" Source="$(Dir1)\TestFile.dll" />
 </Component>

<Component Id="Comp.Comp2" Guid="*" >
  <Condition><![CDATA[VersionNT >= 602]]></Condition>
  <File Id="File2" Source="$(Dir2)\TestFile.dll" />
</Component> 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:41:44.607

该代码将在 x86 和 x64 机器上正常安装文件。请注意，Windows Installer 需要构建 64 位软件包才能安装到 64 位位置。32 位软件包仅安装到 32 位位置。不幸的是，64 位软件包无法安装在 32 位机器上。

最终结果是您需要两个包才能在 32 位和 64 位机器上本地安装。

# c# - 是否可以在 heroku 平台上运行 Windows 服务/应用程序（c#）？

> ID：16214290
> 
> 赞同：4
> 
> 时间：2013-04-25T12:06:53.163
> 
> 标签：c#, heroku

我正在检查在 Heroku 平台上运行我的 C# 服务的可能性......

有没有人有这种解决方案的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T18:51:39.140

有一些 Heroku buildpacks 使用 Mono 来运行 .NET 和 C#。这是我构建的一个：[https ://github.com/friism/heroku-buildpack-mono](https://github.com/friism/heroku-buildpack-mono)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-22T14:41:27.373

您可以创建一个 Dockerfile 来生成可在 Heroku 上运行的 Docker 映像。

```
FROM microsoft/aspnetcore-build:2.0 AS build-env
WORKDIR /app

# Copy csproj and restore as distinct layers
COPY *.csproj ./
RUN dotnet restore

# Copy everything else and build
COPY . ./
RUN dotnet publish -c Release -o out

# Build runtime image
FROM microsoft/aspnetcore:2.0
WORKDIR /app
COPY --from=build-env /app/out .
CMD ASPNETCORE_URLS=http://*:$PORT dotnet <YOUR_API_NAME>.dll 
```

然后，您可以使用以下 Docker 命令直接将其发布到 Heroku：

```
docker build -t aspnetapp <YOUR_API_NAME>
docker login --username=$HEROKU_USERNAME --password=$HEROKU_API_KEY registry.heroku.com
docker tag aspnetapp registry.heroku.com/$HEROKU_APP_NAME/web
docker push registry.heroku.com/$HEROKU_APP_NAME/web 
```

为了这些命令：

1.  创建 Docker 映像并在其中构建项目的发布
2.  使用您的凭据连接到 Heroku 的 docker 注册表
3.  为您的图像创建一个新标签
4.  将您的图像发布到您的 Heroku 应用程序

但是，如果您的机器不支持 Docker，您也可以使用 CircleCI 来运行这些命令。更多详细信息： [https ://www.codingnagger.com/2018/02/21/continuous-delivery/](https://www.codingnagger.com/2018/02/21/continuous-delivery/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-15T17:29:25.763

现在有一个官方的Heroku buildpack，用于使用 project.json 文件和 kpm 包管理器[构建 ASP.NET 5 (Core) 应用程序。](https://elements.heroku.com/buildpacks/heroku/dotnet-buildpack)Mono 被捆绑用于运行时执行。

示例用法：

```
$ heroku create --buildpack http://github.com/heroku/dotnet-buildpack.git
$ git push heroku master 
```

如果它有 project.json，buildpack 会将您的应用程序检测为 ASP.NET 5。如果您要构建的源代码包含多个 project.json 文件，您可以使用 .deployment 或设置 $PROJECT 配置变量来控制构建哪个。

# python - 是否可以在 Windows 上使用 Python 3 编写 EXIF 数据？

> ID：16214291
> 
> 赞同：5
> 
> 时间：2013-04-25T12:06:59.553
> 
> 标签：python, windows, python-3.x, exif

我有一组（数百个）JPEG 文件，我需要为这些文件配备（写入访问）EXIF 数据。为此，我想使用`python3`这样我可以批量处理文件并将其合并到我的数据流中。

我看过[Gexiv2](http://redmine.yorba.org/projects/gexiv2/wiki)，但我还没有找到在 Windows 中使用它的方法。

2009 年的这个[SO 问题](https://stackoverflow.com/questions/765396/exif-manipulation-library-for-python)类似，但我的更具体。

**问题**：
如何`python3`在 Windows 中将 EXIF 数据写入多个 JPEG 文件？

我宁愿不使用商业软件。

# php - php（shmop）如何锁定共享内存

> ID：16214292
> 
> 赞同：2
> 
> 时间：2013-04-25T12:07:00.047
> 
> 标签：php

请问如何使用 shmop（如果重要，不是 shm）在 PHP 中创建的共享内存被锁定和解锁？这需要图书馆吗？

似乎 shmop_read() 在 shmop_write() 仍在写入时运行，因为读取的值具有旧值和新值的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:12:35.780

您不能显式锁定共享内存段，但可以以独占模式打开它，例如

```
shmop_open($shm_key, "n", 0644, 100); 
```

引用[http://www.php.net/manual/en/function.shmop-open.php](http://www.php.net/manual/en/function.shmop-open.php)

> "n" 创建一个新的内存段（设置 IPC_CREATE|IPC_EXCL）当你想创建一个新的共享内存段时使用这个标志，但是如果已经存在一个具有相同标志的共享内存段，则失败。这对于安全目的很有用，使用它可以防止竞争条件漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-03T03:11:40.533

我建议使用`sem_acquire`,`sem_release`来做原子操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:31:14.623

我在 PHP 中找到了一些关于共享内存锁定的信息。

在此页面上，用户声称“（...）非常成功地使用了 mmcache 的系统内存功能。他们抽象了所有困难的东西。” （[链接](http://www.devnetwork.net/viewtopic.php?f=19&t=28924)）

在 Turck MMCache 的页面上： - 实现了新的 API 函数 mmcache_lock 和 mmcache_unlock

[图尔克-mmcache](http://turck-mmcache.sourceforge.net/index_old.html)

应该支持php5。希望也许你可以从这里开始......

# xcode - 在iphone中跟踪用户眼球的运动

> ID：16214296
> 
> 赞同：3
> 
> 时间：2013-04-25T12:07:06.657
> 
> 标签：xcode, core-image, face-detection, quartz-core

我正在开发一个应用程序，我需要跟踪用户眼球的运动，即用户是在看 iPhone 的顶部还是底部。我在早期的项目中使用过 FaceDetection，但只检测到眼睛而不是眼睛的运动。

是否有任何 API 或任何框架可以检测眼球的运动？任何帮助都会很棒。

# java - Solr：如何显示搜索的关键字是否匹配？

> ID：16214297
> 
> 赞同：0
> 
> 时间：2013-04-25T12:07:11.040
> 
> 标签：java, solr, search-engine, solrj

我不想突出显示搜索到的关键字，我只需要文档中存在哪个关键字的信息。

我的搜索看起来像这样：q=keyword1 OR keyword2 OR keyword3 OR keyword4

结果应如下所示：文档 A 有关键字 1 和关键字 3，文档 B 有关键字 3

我没有找到满足此要求的方法。我应该手动解析高亮片段还是有其他方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:07:29.023

似乎没有开箱即用的方法来知道哪些关键字与文档匹配。
选项突出显示，您需要将其配置为返回找到的所有搜索词。
您还可以运行 debugQuery，这将有助于返回文档的匹配项。
它们都是昂贵的操作。

# javascript - 上传 Base64 图片 Facebook Graph API

> ID：16214300
> 
> 赞同：22
> 
> 时间：2013-04-25T12:07:20.400
> 
> 标签：javascript, node.js, facebook-graph-api, encoding, base64

我正在尝试使用 Node.js 将 base64 图像上传到 FaceBook 页面。如果我从文件系统读取文件（即使用 fs.readFileSync('c:\a.jpg')

但是，如果我使用 base64 编码的图像并尝试上传它，它会给我以下错误：`{"error":{"message":"(#1) An unknown error occurred","type":"OAuthException","code":1}}`

我曾尝试将其转换为二进制`new Buffer(b64string, 'base64');`并上传，但没有运气。

我已经为此苦苦挣扎了 3 天，因此将不胜感激。

编辑：如果有人也知道我如何将 base64 转换为二进制并成功上传，那也适用于我。

编辑：代码片段

```
var postDetails = separator + newlineConstant + 'Content-Disposition: form-data;name="access_token"' + newlineConstant + newlineConstant + accessToken + newlineConstant + separator;

postDetails = postDetails + newlineConstant + 'Content-Disposition: form-data; name="message"' + newlineConstant + newlineConstant + message + newlineConstant;

//Add the Image information
var fileDetailsString = '';
var index = 0;
var multipartBody = new Buffer(0);
images.forEach(function (currentImage) {
    fileDetailsString = fileDetailsString + separator + newlineConstant + 'Content-Disposition: file; name="source"; filename="Image' + index + '"' + newlineConstant + 'Content-Type: image/jpeg' + newlineConstant + newlineConstant;
    index++;

    multipartBody = Buffer.concat([multipartBody, new Buffer(fileDetailsString), currentImage]); //This is what I would use if Bianry data was passed in 

    currentImage = new Buffer (currentImage.toString('base64'), 'base64'); // The following lines are what I would use for base64 image being passed in (The appropriate lines would be enabled/disabled if I was using Binary/base64)
    multipartBody = Buffer.concat([multipartBody, new Buffer(fileDetailsString), currentImage]);
});

multipartBody = Buffer.concat([new Buffer(postDetails), multipartBody, new Buffer(footer)]); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-05-08T11:16:22.557

我希望这会有用。通过仅在 javascript 的帮助下将照片上传到 FB，您可以使用以下方法。这里需要的东西是imageData（这是base64格式的图像）和mime类型。

```
try {
    blob = dataURItoBlob(imageData,mimeType);
} catch (e) {
    console.log(e);
}

var fd = new FormData();
fd.append("access_token",accessToken);
fd.append("source", blob);
fd.append("message","Kiss");

try {
   $.ajax({
        url:"https://graph.facebook.com/" + <<userID received on getting user details>> + "/photos?access_token=" + <<user accessToken>>,
        type:"POST",
        data:fd,
        processData:false,
        contentType:false,
        cache:false,
        success:function(data){
            console.log("success " + data);
        },
        error:function(shr,status,data){
            console.log("error " + data + " Status " + shr.status);
        },
        complete:function(){
            console.log("Ajax Complete");
        }
   });

} catch(e) {
    console.log(e);
}

function dataURItoBlob(dataURI,mime) {
    // convert base64 to raw binary data held in a string
    // doesn't handle URLEncoded DataURIs

    var byteString = window.atob(dataURI);

    // separate out the mime component

    // write the bytes of the string to an ArrayBuffer
    //var ab = new ArrayBuffer(byteString.length);
    var ia = new Uint8Array(byteString.length);
    for (var i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }

    // write the ArrayBuffer to a blob, and you're done
    var blob = new Blob([ia], { type: mime });

    return blob;
} 
```

//编辑 AJAX 语法

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-11-06T12:05:23.187

上面的代码对我来说不太好用（Missing comma after `type:"POST",`and data URI to blob function 报告了错误。我得到以下代码在 Firefox 和 Chrome 中工作：

```
function PostImageToFacebook(authToken)
{
    var canvas = document.getElementById("c");
    var imageData  = canvas.toDataURL("image/png");
    try {
        blob = dataURItoBlob(imageData);
    }
    catch(e) {
        console.log(e);
    }
    var fd = new FormData();
    fd.append("access_token",authToken);
    fd.append("source", blob);
    fd.append("message","Photo Text");
    try {
        $.ajax({
            url:"https://graph.facebook.com/me/photos?access_token=" + authToken,
            type:"POST",
            data:fd,
            processData:false,
            contentType:false,
            cache:false,
            success:function(data){
                console.log("success " + data);
            },
            error:function(shr,status,data){
                console.log("error " + data + " Status " + shr.status);
            },
            complete:function(){
                console.log("Posted to facebook");
            }
        });
    }
    catch(e) {
        console.log(e);
    }
}

function dataURItoBlob(dataURI) {
    var byteString = atob(dataURI.split(',')[1]);
    var ab = new ArrayBuffer(byteString.length);
    var ia = new Uint8Array(ab);
    for (var i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }
    return new Blob([ab], { type: 'image/png' });
} 
```

这是 GitHub 上的代码 [https://github.com/DanBrown180/html5-canvas-post-to-facebook-base64](https://github.com/DanBrown180/html5-canvas-post-to-facebook-base64)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-17T23:29:21.623

丹的答案效果最好。在这种情况下可能有用的其他内容是发布照片的可选参数：'no_story'。此参数默认为 true ，强制照片帖子跳过用户的墙。通过添加

```
fd.append("no_story", false); 
```

您可以使用照片帖子更新用户的墙。

我本来只是将其作为评论留下，但... 50 Rep 发表评论。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-14T06:44:51.277

我们可以通过使用现代 Fetch API 而不是 Uint8Array 来简化图像重新编码。

```
 var url = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="

 fetch(url)
  .then(res => res.blob())
  .then(blob => console.log(blob))` 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-23T23:00:41.717

我做了与你的问题非常相似的事情。我有一个需要发布到 Facebook 粉丝页面的网络摄像头快照。设置在一家餐厅，人们可以在那里拍照，然后将其发布到餐厅页面上。然后，人们会看到发布的 Facebook 照片上的二维码，他们可以选择在自己的个人资料中分享。希望这可以帮助某人，因为我进行了很多搜索才能找到这个可行的解决方案

**注意：**我的图像已经是 BASE64 编码的。

```
//imageData is a base64 encoded JPG
function postSocial(imageData, message){       
        var ia = toUInt8Array(imageData);
        postImageToFacebook(mAccessTokenPage, "imageName", "image/jpeg",ia, message);
}

function toUInt8Array(dataURI) {
        // convert base64 to raw binary data held in a string
        // doesn't handle URLEncoded DataURIs
        var byteString = window.atob(dataURI);

        // write the bytes of the string to an ArrayBuffer
        //var ab = new ArrayBuffer(byteString.length);
        var ia = new Uint8Array(byteString.length);
        for (var i = 0; i < byteString.length; i++) {
            ia[i] = byteString.charCodeAt(i);
        }
        return ia;
    }

function postImageToFacebook( authToken, filename, mimeType, imageData, message ) {        
        // this is the multipart/form-data boundary we'll use
        var boundary = '----ThisIsTheBoundary1234567890';

        // let's encode our image file, which is contained in the var
        var formData = '--' + boundary + '\r\n'
        formData += 'Content-Disposition: form-data; name="source"; filename="' + filename + '"\r\n';
        formData += 'Content-Type: ' + mimeType + '\r\n\r\n';
        for ( var i = 0; i < imageData.length; ++i )
        {
            formData += String.fromCharCode( imageData[ i ] & 0xff );
        }
        formData += '\r\n';
        formData += '--' + boundary + '\r\n';
        formData += 'Content-Disposition: form-data; name="message"\r\n\r\n';
        formData += message + '\r\n'
        formData += '--' + boundary + '--\r\n';

        var xhr = new XMLHttpRequest();
        xhr.open( 'POST', https://graph.facebook.com/ + {PAGE_ID} + "/photos?access_token=" + authToken, true );
        xhr.onload = function() {
            // ... Fill in your own
            //Image was posted 
           console.log(xhr.responseText);
        };
        xhr.onerror = function(){
            console.log("Error while sending the image to Facebook");
        };
        xhr.setRequestHeader( "Content-Type", "multipart/form-data; boundary=" + boundary );
        xhr.sendAsBinary( formData );
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-23T21:28:51.853

以下是我如何使用 facebook JS API 将图像发布到 facebook。我正在使用画布 HTML5 功能。并非每个浏览器都完全支持它。

您需要首先获取图像数据。然后将其封装在表单数据中。然后我使用 FB.login API 来检索访问令牌和用户 ID。

```
 var data = $('#map >> canvas').toDataURL('image/png');
          var blob;
          try {
            var byteString = atob(data.split(',')[1]);
            var ab = new ArrayBuffer(byteString.length);
            var ia = new Uint8Array(ab);
            for (var i = 0; i < byteString.length; i++) {
              ia[i] = byteString.charCodeAt(i);
            }
            blob = new Blob([ab], {type: 'image/png'});
          } catch (e) {
            console.log(e);
          }
          var fd = new FormData();
          fd.append("source", blob);
          fd.append("message", "Photo Text");
          FB.login(function(){
            var auth = FB.getAuthResponse();
            $.ajax({
              url:"https://graph.facebook.com/"+auth.userID+"/photos?access_token=" + auth.accessToken,
              type:"POST",
              data:fd,
              processData:false,
              contentType:false,
              cache:false,
              success:function(data){
                console.log("success " + data);
              },
              error:function(shr,status,data){
                console.log("error " + data + " Status " + shr.status);
              },
              complete:function(){
                console.log("Ajax Complete");
              }
            });
          }, {scope: 'publish_actions'}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-06T23:46:50.750

这是一个不需要 jQuery 或其他库的示例，只需要原生 Fetch API：

```
const dataURItoBlob = (dataURI) => {
    let byteString = atob(dataURI.split(',')[1]);
    let ab = new ArrayBuffer(byteString.length);
    let ia = new Uint8Array(ab);
    for (let i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }
    return new Blob([ia], {
        type: 'image/jpeg'
    });
}
const upload = async (response) => {
    let canvas = document.getElementById('canvas');
    let dataURL = canvas.toDataURL('image/jpeg', 1.0);
    let blob = dataURItoBlob(dataURL);
    let formData = new FormData();
    formData.append('access_token', response.authResponse.accessToken);
    formData.append('source', blob);

    let responseFB = await fetch(`https://graph.facebook.com/me/photos`, {
        body: formData,
        method: 'post'
    });
    responseFB = await responseFB.json();
    console.log(responseFB);
};
document.getElementById('upload').addEventListener('click', () => {
    FB.login((response) => {
        //TODO check if user is logged in and authorized publish_actions
        upload(response);
    }, {scope: 'publish_actions'})
}) 
```

来源： http: [//www.devils-heaven.com/facebook-javascript-sdk-photo-upload-from-canvas/](http://www.devils-heaven.com/facebook-javascript-sdk-photo-upload-from-canvas/)

# android - 空指针异常 getSharedPreferences

> ID：16214303
> 
> 赞同：0
> 
> 时间：2013-04-25T12:07:30.807
> 
> 标签：android, sharedpreferences

我正在尝试在我的 android 应用程序中保存一些首选项。但是当我试图获得一个共享偏好时，我得到了一个空指针异常。这是错误：

```
04-25 13:58:44.814: W/System.err(22795): java.lang.NullPointerException
04-25 13:58:44.824: W/System.err(22795):    at com.koeriers.standaard.SharedPreferences.setData(SharedPreferences.java:27)
04-25 13:58:44.829: W/System.err(22795):    at com.koeriers.standaard.actLogin.onCreate(actLogin.java:79)
04-25 13:58:44.834: W/System.err(22795):    at android.app.Activity.performCreate(Activity.java:5206)
04-25 13:58:44.839: W/System.err(22795):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1094)
04-25 13:58:44.844: W/System.err(22795):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2074)
04-25 13:58:44.849: W/System.err(22795):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2135)
04-25 13:58:44.854: W/System.err(22795):    at android.app.ActivityThread.access$700(ActivityThread.java:140)
04-25 13:58:44.859: W/System.err(22795):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1237)
04-25 13:58:44.864: W/System.err(22795):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-25 13:58:44.869: W/System.err(22795):    at android.os.Looper.loop(Looper.java:137)
04-25 13:58:44.874: W/System.err(22795):    at android.app.ActivityThread.main(ActivityThread.java:4921)
04-25 13:58:44.874: W/System.err(22795):    at java.lang.reflect.Method.invokeNative(Native Method)
04-25 13:58:44.879: W/System.err(22795):    at java.lang.reflect.Method.invoke(Method.java:511)
04-25 13:58:44.884: W/System.err(22795):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1027)
04-25 13:58:44.889: W/System.err(22795):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:794)
04-25 13:58:44.894: W/System.err(22795):    at dalvik.system.NativeStart.main(Native Method) 
```

这是我的 SharedPreferences 类：

```
package com.myapp.standaard;

import android.os.Bundle;
import android.preference.PreferenceActivity;
import android.widget.EditText;

public class SharedPreferences extends PreferenceActivity {

public static String GUID = "8BB4894B-92F7-45AF-9A40-B99D7A06A506";
public static String LicenseKey = "letmein";

EditText etLicense;
android.content.SharedPreferences sharedPrefs;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    try {
        addPreferencesFromResource(R.xml.preferences);
        etLicense = (EditText) findViewById(R.id.etLicense);
    } catch (Exception e) {
        e.printStackTrace();
    }
}

public Boolean setData(String setPreference, String setValue) {
    android.content.SharedPreferences.Editor editor = sharedPrefs.edit();
    editor.putString(setPreference, setValue);
    editor.commit();
    return true;
}

public String getData(String getPreference, String errorMessage) {
    sharedPrefs = getSharedPreferences(getPreference, MODE_PRIVATE);
    String returnData = sharedPrefs.getString(getPreference, errorMessage);
    return returnData;
}
} 
```

这是我的活动中我试图从我的偏好中检索值的地方：

```
try{

        SharedPreferences sp = new SharedPreferences();
        licentie = sp.getData("LicenseKey", "Error loading license");
    } catch (Exception e){
        e.printStackTrace();
        licentie = "";
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:11:30.310

你还没有调用公共布尔值

`setData(String setPreference, String setValue)`

这就是为什么在任何地方`licentie = sp.getData("LicenseKey", "Error loading license");`

它正在给予`nullpointerexception`。

首先设置“LicenseKey”尝试检索它。

**注意——你根据我使用的那种实现是不正确的。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:14:07.087

```
android.content.SharedPreferences.Editor editor = sharedPrefs.edit(); 
```

在这一行中 sharedPrefs 未初始化。更好地在 onCreate 中初始化您的 sharedPref，如下所示。

```
sharedPrefs = getSharedPreferences(name); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:14:22.103

在写入数据之前，您尚未初始化 sharedPrefs 对象

```
sharedPrefs  = _activity.getSharedPreferences(SPName, android.content.Context.MODE_PRIVATE);
SharedPreferences.Editor editor = preferences.edit(); 
```

现在设置您的数据，然后提交为

```
editor.putString(key, value);
editor.commit(); 
```

# ruby - 用 7n +1 填充 ruby 中的数组

> ID：16214304
> 
> 赞同：1
> 
> 时间：2013-04-25T12:07:42.557
> 
> 标签：ruby, arrays

如何在 Ruby (1.9) 中以编程方式创建以下数组。

它遵循模式 7n + 1，我希望它包含 24 个数字。

```
arr = ["8","15","22","29","36","43","50","57","64","71" ] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:09:20.250

使用`collect`并应用于`to_s`结果：

```
(1..24).collect{|n| (n*7 + 1).to_s} 
```

编辑：抱歉忘记将数字转换为字符串。现在编辑代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:32:22.363

```
Array.new(24){|i| (i * 7 + 8).to_s} 
```

# php - 有没有办法在本地覆盖 ZF2 application.config.php 指令？

> ID：16214305
> 
> 赞同：4
> 
> 时间：2013-04-25T12:07:43.947
> 
> 标签：php, zend-framework2

我正在做一个 ZF2 项目，我的 public/index.php 文件如下：

```
<?php
chdir(dirname(__DIR__));
require 'init_autoloader.php';
Zend\Mvc\Application::init(require 'config/application.config.php')->run(); 
```

应用程序初始化过程从使用 application.config.php 开始，我知道 ZF2 提供了很好的方法来通过像 modulename.local.php 这样的文件名在本地覆盖模块配置，但不适用于 application.config.php 文件。

例如，在 application.config.php 中，我有一个 module_listener_options 键，如下所示：

```
return array(
    'modules' => array(
    // ...
    ),

    'module_listener_options' => array(
        'module_paths' => array(
         // ...
         ),

    'config_glob_paths' => array(
        'config/autoload/{,*.}{global,local}.php',
     ),

     'config_cache_enabled' => TRUE,
     'config_cache_key' => 'configuration_cache',
     'cache_dir' => __DIR__ . '/../data/cache'
// ...
) 
```

所以我想在开发环境中工作时在本地禁用配置缓存，但我想在生产环境中打开它而不需要部署后的技巧（比如编写自定义 git-hook / bash 脚本等）。

此外，我`APPLICATION_ENVIRONMENT` `$_ENV`在所有服务器（开发、产品、测试）上都有一个变量，我不知道在 ZF2 中实现这一目标的最佳方法是什么。

我找到了[Stephen Rees-Carter 的文章](https://stephen.rees-carter.net/thought/zf2-config-caching-with-composer)，是的，解决了这个问题，但我想知道是否有任何其他/更优雅的解决方案不依赖于作曲家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:34:31.717

您可以在您的应用程序配置中测试您的环境变量并相应地设置缓存，例如，

```
<?php
// application.config.php
$env = getenv('APPLICATION_ENVIRONMENT');
$configCacheEnabled = ($env == 'production');

return array(
    //..

    'config_cache_enabled' => $configCacheEnabled,

    //..
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T13:52:20.510

Here's an example to include modules only on your development setup, with a local file override. You can easily just remove the environment variable check if you wished to just override with the presence of the local config file.

**application.config.php**

```
$config = array(
    'modules' => array(
        'Application',
        'ZfcBase',
    ),
    'module_listener_options' => array(
        'config_glob_paths'    => array(
            'config/autoload/{,*.}{global,local}.php',
        ),
        'module_paths' => array(
            './module',
            './vendor',
        ),
    ),
);

if(getenv('APPLICATION_ENV') == 'development' && is_readable('config/autoload/application.config.local.php')){
    $localAppConfig = require 'config/autoload/application.config.local.php';
    $config = array_merge_recursive($config,$localAppConfig);
} 

return $config; 
```

**config/application.config.local.php**

```
return array(
    'modules' => array(
        'ZendDeveloperTools',
        'ZFTool'
    ),
    /**
     * Add any overrides to the new local config
     */
); 
```

You can then just add overrides to your local file, which can be different for staging and production environments.

# python - Python中的函数式编程：返回无而不是正确的值

> ID：16214313
> 
> 赞同：1
> 
> 时间：2013-04-25T12:08:00.637
> 
> 标签：python, functional-programming

我在 python 中编写了一个功能代码，但我不明白为什么它返回 None 而不是代码清楚生成的正确值。

此脚本的目的是从 CSV 中获取 line.split(',') 并将无意中从 '{value1,value2,value3}' 拆分的任何值重新组合为 'value1,value2 ... valueN'。

```
def reassemble(list_name):
    def inner_iter(head, tail):
        if head[0][0] == '{':
            new_head = [head[0] + ',' + tail[0]]
            if tail[0][-1] == '}':
                return [new_head[0][1:-1]], tail[1:]
            else:
                inner_iter(new_head, tail[1:])

    def outer_iter(corrected_list, head, tail):
        if tail == []:
            print corrected_list + head
            return corrected_list + head
        else:
            if head[0][0] == '{':
                head, tail = inner_iter(head, tail)
                outer_iter(corrected_list + head, [tail[0]], tail[1:])

            else:
                outer_iter(corrected_list + head, [tail[0]], tail[1:])

    return outer_iter([], [list_name[0]], list_name[1:]) 
```

下面是一个测试：

```
x = ['x','y', '{a', 'b}', 'c']
print reassemble(x) 
```

这是奇怪的结果：

```
['x', 'y', 'a,b', 'c'] #from the print inside "outer_iter"
None                   #from the print reassemble(x) 
```

注意：我想保持代码功能作为练习。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:11:52.070

你忘了`return`在`else`子句中，在`outer_iter`。

在 python 中，不返回特定值的函数返回`None`.

[编辑]

完整来源：

```
def reassemble(list_name):
    def inner_iter(head, tail):
        if head[0][0] == '{':
            new_head = [head[0] + ',' + tail[0]]
            if tail[0][-1] == '}':
                return [new_head[0][1:-1]], tail[1:]
            else:
                return inner_iter(new_head, tail[1:])
                #before the change, control reached here upon return
        #control might still reach here, in case 'if' condition was not met
        #implicitly "return None"

    def outer_iter(corrected_list, head, tail):
        if tail == []:
            print corrected_list + head
            return corrected_list + head
        else:
            if head[0][0] == '{':
                head, tail = inner_iter(head, tail)
                return outer_iter(corrected_list + head, [tail[0]], tail[1:])
                #before the change, control reached here upon return
            else:
                return outer_iter(corrected_list + head, [tail[0]], tail[1:])
                #before the change, control reached here upon return
        #before the change, control reached here upon return
        #implicitly "return None"

    return outer_iter([], [list_name[0]], list_name[1:]) 
```

测试：

```
x = ['x','y', '{a', 'b}', 'c']
print reassemble(x) 
```

输出：

```
['x', 'y', 'a,b', 'c']
['x', 'y', 'a,b', 'c'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:13:10.850

```
def reassemble(list_name):
    def inner_iter(head, tail):
        if head[0][0] == '{':
            new_head = [head[0] + ',' + tail[0]]
            if tail[0][-1] == '}':
                return [new_head[0][1:-1]], tail[1:]
            else:
                return inner_iter(new_head, tail[1:])

    def outer_iter(corrected_list, head, tail):
        if tail == []:
            print corrected_list + head
            return corrected_list + head
        else:
            if head[0][0] == '{':
                head, tail = inner_iter(head, tail)
                return outer_iter(corrected_list + head, [tail[0]], tail[1:])

            else:
                return outer_iter(corrected_list + head, [tail[0]], tail[1:])

    return outer_iter([], [list_name[0]], list_name[1:])

x = ['x','y', '{a', 'b}', 'c']

print reassemble(x) 
```

查看此 Bunk 中的运行代码[http://codebunk.com/bunk#-It06-ImaZDpSrCrQSmM](http://codebunk.com/bunk#-It06-ImaZDpSrCrQSmM)

# jsf-2 - 为什么我在 jboss-7 上收到这个奇怪的 'ExceptionHandlerFactory' 问题？

> ID：16214324
> 
> 赞同：0
> 
> 时间：2013-04-25T12:08:27.220
> 
> 标签：jsf-2, jboss7.x, icefaces-3

我想将现有的 icefaces 应用程序迁移到 jboss server 7，但收到此异常：

```
 15:01:27,399 SEVERE [javax.enterprise.resource.webcontainer.jsf.config] (MSC ser
vice thread 1-2) Critical error during deployment: : com.sun.faces.config.Config
urationException: Factory 'javax.faces.context.ExceptionHandlerFactory' was not
configured properly.
        at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactories
Exist(FactoryConfigProcessor.java:305) [jsf-impl-2.1.7-jbossorg-2.jar:]
        at com.sun.faces.config.processor.FactoryConfigProcessor.process(Factory
ConfigProcessor.java:219) [jsf-impl-2.1.7-jbossorg-2.jar:]
        at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:361)
 [jsf-impl-2.1.7-jbossorg-2.jar:]
        at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureLi
stener.java:225) [jsf-impl-2.1.7-jbossorg-2.jar:]
        at org.apache.catalina.core.StandardContext.contextListenerStart(Standar
dContext.java:3392) [jbossweb-7.0.13.Final.jar:]
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:3
850) [jbossweb-7.0.13.Final.jar:]
        at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentS
ervice.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(Se
rviceControllerImpl.java:1811)
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceCont
rollerImpl.java:1746)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.
java:1110) [rt.jar:1.7.0]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor
.java:603) [rt.jar:1.7.0]
        at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0]
Caused by: javax.faces.FacesException: org.icefaces.impl.application.ExtendedExc
eptionHandlerFactory
        at javax.faces.FactoryFinder.getImplGivenPreviousImpl(FactoryFinder.java
:643) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
        at javax.faces.FactoryFinder.getImplementationInstance(FactoryFinder.jav
a:509) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
        at javax.faces.FactoryFinder.access$400(FactoryFinder.java:139) [jboss-j
sf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
        at javax.faces.FactoryFinder$FactoryManager.getFactory(FactoryFinder.jav
a:993) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
        at javax.faces.FactoryFinder.getFactory(FactoryFinder.java:343) [jboss-j
sf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
        at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactories
Exist(FactoryConfigProcessor.java:303) [jsf-impl-2.1.7-jbossorg-2.jar:]
        ... 11 more
Caused by: java.lang.InstantiationException: org.icefaces.impl.application.Exten
dedExceptionHandlerFactory
        at java.lang.Class.newInstance0(Class.java:357) [rt.jar:1.7.0]
        at java.lang.Class.newInstance(Class.java:325) [rt.jar:1.7.0]
        at javax.faces.FactoryFinder.getImplGivenPreviousImpl(FactoryFinder.java
:641) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
        ... 16 more 
```

我只是卡住了，因为我不知道如何解决这个问题。

有人有线索吗？

我`javax.faces.jar`在 ear 的 lib 目录中，但似乎删除它并没有帮助（我收到很多其他异常）。

**更新**：如果我将此添加到 web.xml：

```
<context-param>
        <param-name>org.jboss.jbossfaces.WAR_BUNDLES_JSF_IMPL</param-name>
        <param-value>true</param-value>
    </context-param> 
```

错误似乎消失了，但出现了另一个错误：

```
15:56:51,975 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-
host].[/cloudmatrix]] (MSC service thread 1-3) Exception sending context initial
ized event to listener instance of class com.sun.faces.config.ConfigureListener:
 java.lang.RuntimeException: com.sun.faces.config.ConfigurationException: CONFIG
URATION FAILED! Class org.jboss.as.web.deployment.jsf.JandexAnnotationProvider i
s not an instance of com.sun.faces.spi.AnnotationProvider
        at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureLi
stener.java:292) [javax.faces.jar:2.1.6-SNAPSHOT]
        at org.apache.catalina.core.StandardContext.contextListenerStart(Standar
dContext.java:3392) [jbossweb-7.0.13.Final.jar:]
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:3
850) [jbossweb-7.0.13.Final.jar:]
        at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentS
ervice.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(Se
rviceControllerImpl.java:1811)
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceCont
rollerImpl.java:1746)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.
java:1110) [rt.jar:1.7.0]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor
.java:603) [rt.jar:1.7.0]
        at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0]
Caused by: com.sun.faces.config.ConfigurationException: CONFIGURATION FAILED! Cl
ass org.jboss.as.web.deployment.jsf.JandexAnnotationProvider is not an instance
of com.sun.faces.spi.AnnotationProvider
        at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:375)
 [javax.faces.jar:2.1.6-SNAPSHOT]
        at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureLi
stener.java:225) [javax.faces.jar:2.1.6-SNAPSHOT]
        ... 8 more
Caused by: javax.faces.FacesException: Class org.jboss.as.web.deployment.jsf.Jan
dexAnnotationProvider is not an instance of com.sun.faces.spi.AnnotationProvider

        at com.sun.faces.spi.AnnotationProviderFactory.createAnnotationProvider(
AnnotationProviderFactory.java:78) [javax.faces.jar:2.1.6-SNAPSHOT]
        at com.sun.faces.config.ConfigManager$AnnotationScanTask.<init>(ConfigMa
nager.java:807) [javax.faces.jar:2.1.6-SNAPSHOT]
        at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:348)
 [javax.faces.jar:2.1.6-SNAPSHOT]
        ... 9 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T13:57:57.150

我不得不用以下内容将 jboss-deployment-structure.xml 放在我的耳朵里：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.0">
  <deployment>
        <exclusions>
          <module name="javax.faces.api" slot="main"/>
          <module name="com.sun.jsf-impl" slot="main"/>
          <module name="javax.faces.api" slot="1.2"/>
          <module name="com.sun.jsf-impl" slot="1.2"/>
          <module name="org.jboss.as.web" slot="main" />
        </exclusions>
        <dependencies>
          <module name="org.hibernate.validator" export="true"/>
          <module name="javax.validation.api" export="true"/>
          <module name="org.codehaus.jettison" export="true"/>
          <module name="org.jboss.resteasy.resteasy-jaxrs" export="true"/>
          <module name="org.jboss.resteasy.resteasy-jackson-provider" export="true"/>
          <module name="org.apache.log4j" export="true"/>
          <module name="org.jboss.as.web" slot="main" export="true"/>
          <module name="javax.faces.api" slot="main" export="true"/>
          <module name="com.sun.jsf-impl" slot="main" export="true"/>
          <module name="org.jboss.as.web" slot="main">
          <imports>
            <include path="/org/**" />
            <exclude path="/META-INF/**" />
          </imports>
          </module>
        </dependencies>
  </deployment>   
 </jboss-deployment-structure> 
```

# javascript - 带悬停的引导下拉菜单

> ID：16214326
> 
> 赞同：210
> 
> 时间：2013-04-25T12:08:37.470
> 
> 标签：javascript, jquery, html, css, twitter-bootstrap

好的，所以我需要的是相当简单的。

我已经设置了一个导航栏，其中包含一些下拉菜单（使用`class="dropdown-toggle" data-toggle="dropdown"`），它工作正常。

问题是它有效“ `onClick`”，而我更喜欢它是否有效“ `onHover`”。

有没有内置的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：403
> 
> 时间：2013-04-25T12:14:50.510

最简单的解决方案是 CSS。添加类似...

```
.dropdown:hover .dropdown-menu {
    display: block;
    margin-top: 0; // remove the gap so it doesn't close
 } 
```

[工作小提琴](http://jsfiddle.net/brbcoding/tah2tur9/)

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2014-03-01T08:12:14.823

最好的方法是通过悬停触发引导点击事件。这样，它仍应保持对触摸设备友好

```
$('.dropdown').hover(function(){ 
  $('.dropdown-toggle', this).trigger('click'); 
}); 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2013-10-24T09:21:17.347

您可以使用 jQuery 的悬停功能。

您只需要`open`在鼠标进入时添加类并在鼠标离开下拉菜单时删除类。

这是我的代码：

```
$(function(){
    $('.dropdown').hover(function() {
        $(this).addClass('open');
    },
    function() {
        $(this).removeClass('open');
    });
}); 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2013-10-04T21:57:23.303

使用 jQuery 的一种简单方法是：

```
$(document).ready(function(){
    $('ul.nav li.dropdown').hover(function() {
      $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeIn(200);
    }, function() {
      $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeOut(200);
    });  
}); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-11-20T06:57:21.930

对于 CSS，当您也单击它时，它会变得疯狂。这是我正在使用的代码，它也不会改变移动视图的任何内容。

```
$('.dropdown').mouseenter(function(){
    if(!$('.navbar-toggle').is(':visible')) { // disable for mobile view
        if(!$(this).hasClass('open')) { // Keeps it open when hover it again
            $('.dropdown-toggle', this).trigger('click');
        }
    }
}); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-04-25T12:12:46.827

在 Twitter Bootstrap[中没有实现](https://github.com/twitter/bootstrap/issues/983)，但你可以使用[这个插件](https://github.com/CWSpear/twitter-bootstrap-hover-dropdown)

更新1：

同样的问题[在这里](https://stackoverflow.com/questions/8878033/how-to-make-twitter-bootstrap-menu-dropdown-on-hover-rather-than-click)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-09-09T15:28:53.463

将鼠标悬停在导航项目上以查看它们在悬停时激活。 [http://cameronspear.com/demos/twitter-bootstrap-hover-dropdown/#](http://cameronspear.com/demos/twitter-bootstrap-hover-dropdown/#)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-03-12T13:25:23.397

所以你有这个代码：

```
<a class="dropdown-toggle" data-toggle="dropdown">Show menu</a>

<ul class="dropdown-menu" role="menu">
    <li>Link 1</li>
    <li>Link 2</li> 
    <li>Link 3</li>                                             
</ul> 
```

通常它适用于点击事件，您希望它适用于悬停事件。这很简单，只需使用以下 javascript/jquery 代码：

```
$(document).ready(function () {
    $('.dropdown-toggle').mouseover(function() {
        $('.dropdown-menu').show();
    })

    $('.dropdown-toggle').mouseout(function() {
        t = setTimeout(function() {
            $('.dropdown-menu').hide();
        }, 100);

        $('.dropdown-menu').on('mouseenter', function() {
            $('.dropdown-menu').show();
            clearTimeout(t);
        }).on('mouseleave', function() {
            $('.dropdown-menu').hide();
        })
    })
}) 
```

这很好用，解释如下：我们有一个按钮和一个菜单。当我们将鼠标悬停在按钮上时，我们会显示菜单，当我们将鼠标悬停在按钮上时，我们会在 100 毫秒后隐藏菜单。如果您想知道我为什么使用它，是因为您需要时间将光标从按钮上拖到菜单上。当您在菜单上时，时间会被重置，您可以在此处停留任意时间。当您退出菜单时，我们会立即隐藏菜单，不会有任何超时。

我在很多项目中都使用过这段代码，如果您在使用它时遇到任何问题，请随时向我提问。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-04-08T18:11:08.823

这就是我用一些 jQuery 让它在悬停时下拉的东西

```
$(document).ready(function () {
    $('.navbar-default .navbar-nav > li.dropdown').hover(function () {
        $('ul.dropdown-menu', this).stop(true, true).slideDown('fast');
        $(this).addClass('open');
    }, function () {
        $('ul.dropdown-menu', this).stop(true, true).slideUp('fast');
        $(this).removeClass('open');
    });
}); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-02-01T02:39:55.737

## 使用适当的插件更新

我已经为下拉悬停功能发布了一个适当的插件，您甚至可以在其中定义单击`dropdown-toggle`元素时会发生什么：

[https://github.com/istvan-ujjmeszaros/bootstrap-dropdown-hover](https://github.com/istvan-ujjmeszaros/bootstrap-dropdown-hover)

* * *

## 当已经有很多解决方案时，为什么我做到了？

我对所有以前存在的解决方案都有疑问。简单的 CSS 不使用 上的`.open`类`.dropdown`，因此当下拉列表可见时，下拉切换元素将没有反馈。

js 会干扰单击`.dropdown-toggle`，因此下拉菜单会在悬停时显示，然后在单击打开的下拉菜单时将其隐藏，移出鼠标将触发下拉菜单再次显示。一些 js 解决方案正在破坏 iOS 兼容性，一些插件无法在支持触摸事件的现代桌面浏览器上运行。

这就是为什么我制作了[Bootstrap Dropdown Hover](https://github.com/istvan-ujjmeszaros/bootstrap-dropdown-hover)插件，它通过仅使用标准 Bootstrap javascript API 来防止所有这些问题，而无需任何黑客攻击。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-04-04T06:07:46.250

尝试使用带有淡入淡出动画的悬停功能

```
$('ul.nav li.dropdown').hover(function() {
  $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeIn(500);
}, function() {
  $(this).find('.dropdown-menu').stop(true, true).delay(200).fadeOut(500);
}); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-03-12T22:32:34.500

这将帮助您为引导程序创建自己的悬停类：

CSS：

```
/* Hover dropdown */
.hover_drop_down.input-group-btn ul.dropdown-menu{margin-top: 0px;}/*To avoid unwanted close*/
.hover_drop_down.btn-group ul.dropdown-menu{margin-top:2px;}/*To avoid unwanted close*/
.hover_drop_down:hover ul.dropdown-menu{
   display: block;
} 
```

设置边距以避免不必要的关闭，它们是可选的。

HTML：

```
<div class="btn-group hover_drop_down">
  <button type="button" class="btn btn-default" data-toggle="dropdown"></button>
  <ul class="dropdown-menu" role="menu">
    ...
  </ul>
</div> 
```

如果要删除 onclick open，请不要忘记删除按钮属性**data-toggle="dropdown" ，当输入附加下拉菜单时，这也将起作用。**

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-05-26T19:23:39.867

这只会在您不在移动设备上时悬停导航栏，因为我发现悬停导航在移动设备上效果不佳：

```
 $( document ).ready(function() {

    $( 'ul.nav li.dropdown' ).hover(function() {
        // you could also use this condition: $( window ).width() >= 768
        if ($('.navbar-toggle').css('display') === 'none' 
            && false === ('ontouchstart' in document)) {

            $( '.dropdown-toggle', this ).trigger( 'click' );
        }
    }, function() {
        if ($('.navbar-toggle').css('display') === 'none'
            && false === ('ontouchstart' in document)) {

            $( '.dropdown-toggle', this ).trigger( 'click' );
        }
    });

}); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-10-01T09:40:25.610

我尝试了其他解决方案，我正在使用引导程序 3，但下拉菜单关闭得太快而无法移动

假设您将 class="dropdown" 添加到 li，我添加了超时

```
var hoverTimeout;
$('.dropdown').hover(function() {
    clearTimeout(hoverTimeout);
    $(this).addClass('open');
}, function() {
    var $self = $(this);
    hoverTimeout = setTimeout(function() {
        $self.removeClass('open');
    }, 150);
}); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-10-15T15:27:48.537

用 a触发`click`事件`hover`有一个小错误。If `mouse-in`and then a`click`产生反之亦然的效果。它`opens`何时`mouse-out`何`close`地`mouse-in`。更好的解决方案：

```
$('.dropdown').hover(function() {
    if (!($(this).hasClass('open'))) {
        $('.dropdown-toggle', this).trigger('click');
    }
}, function() {
    if ($(this).hasClass('open')) {
        $('.dropdown-toggle', this).trigger('click');
    }
}); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-03-10T17:41:49.583

```
 $('.navbar .dropdown').hover(function() {
      $(this).find('.dropdown-menu').first().stop(true, true).slideDown(150);
    }, function() {
      $(this).find('.dropdown-menu').first().stop(true, true).slideUp(105)
    }); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-01-21T11:17:27.850

Bootstrap 下拉菜单在悬停时工作，并通过添加属性**display:block 保持点击关闭；**在 CSS 中并从按钮标签中删除这些属性**data-toggle="dropdown"** **role="button"**

```
.dropdown:hover .dropdown-menu {
  display: block;
}
```

```
<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>
<body>

<div class="container">                                     
  <div class="dropdown">
    <button class="btn btn-primary dropdown-toggle">Dropdown Example</button>
    <span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="#">HTML</a></li>
      <li><a href="#">CSS</a></li>
      <li><a href="#">JavaScript</a></li>
    </ul>
  </div>
</div>

</body>
</html>
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-05-23T16:18:32.033

html

```
 <div class="dropdown">

            <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
                Dropdown Example <span class="caret"></span>
            </button>

            <ul class="dropdown-menu">
                <li><a href="#">HTML</a></li>
                <li><a href="#">CSS</a></li>
                <li><a href="#">JavaScript</a></li>
            </ul>

        </div> 
```

jQuery

```
 $(document).ready( function() {                

            /* $(selector).hover( inFunction, outFunction ) */
            $('.dropdown').hover( 
                function() {                        
                    $(this).find('ul').css({
                        "display": "block",
                        "margin-top": 0
                    });                        
                }, 
                function() {                        
                    $(this).find('ul').css({
                        "display": "none",
                        "margin-top": 0
                    });                        
                } 
            );

        }); 
```

[密码笔](https://codepen.io/antelove/pen/ZNrMLP)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-03-13T10:01:55.003

我提出的解决方案检测它是否不是触摸设备并且`navbar-toggle`（汉堡菜单）不可见，并使父菜单项**在悬停时显示子菜单，**并**在 click 上点击其链接**。

也使 tne margin-top 0 因为导航栏和某些浏览器中的菜单之间的间隙不会让您将鼠标悬停在子项上

```
$(function(){
    function is_touch_device() {
        return 'ontouchstart' in window        // works on most browsers 
        || navigator.maxTouchPoints;       // works on IE10/11 and Surface
    };

    if(!is_touch_device() && $('.navbar-toggle:hidden')){
      $('.dropdown-menu', this).css('margin-top',0);
      $('.dropdown').hover(function(){ 
          $('.dropdown-toggle', this).trigger('click').toggleClass("disabled"); 
      });			
    }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>

<ul id="nav" class="nav nav-pills clearfix right" role="tablist">
    <li><a href="#">menuA</a></li>
    <li><a href="#">menuB</a></li>
    <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">menuC</a>
        <ul id="products-menu" class="dropdown-menu clearfix" role="menu">
            <li><a href="">A</a></li>
            <li><a href="">B</a></li>
            <li><a href="">C</a></li>
            <li><a href="">D</a></li>
        </ul>
    </li>
    <li><a href="#">menuD</a></li>
    <li><a href="#">menuE</a></li>
</ul>
```

```
$(function(){
  $("#nav .dropdown").hover(
    function() {
      $('#products-menu.dropdown-menu', this).stop( true, true ).fadeIn("fast");
      $(this).toggleClass('open');
    },
    function() {
      $('#products-menu.dropdown-menu', this).stop( true, true ).fadeOut("fast");
      $(this).toggleClass('open');
    });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>

<ul id="nav" class="nav nav-pills clearfix right" role="tablist">
    <li><a href="#">menuA</a></li>
    <li><a href="#">menuB</a></li>
    <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">menuC</a>
        <ul id="products-menu" class="dropdown-menu clearfix" role="menu">
            <li><a href="">A</a></li>
            <li><a href="">B</a></li>
            <li><a href="">C</a></li>
            <li><a href="">D</a></li>
        </ul>
    </li>
    <li><a href="#">menuD</a></li>
    <li><a href="#">menuE</a></li>
</ul>
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-11-15T12:37:13.683

使用`mouseover()`函数触发点击。这样之前的点击事件就不会有害了。用户可以同时使用悬停和点击/触摸。它将是移动友好的。

```
$(".dropdown-toggle").mouseover(function(){
    $(this).trigger('click');
}) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-12-17T13:46:06.087

您可以使用 Jquery 实现此功能：

```
$('.dropdown').on('mouseover', function(){
    $(this).addClass('show');
    $('.dropdown-menu').addClass('show');
    $('.dropdown-toggle').attr('aria-expanded', 'true');

});
$('.dropdown').on('mouseout', function(){
    $(this).removeClass('show');
    $('.dropdown-menu').removeClass('show');
    $('.dropdown-toggle').attr('aria-expanded', 'false');
}); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2022-01-24T06:56:42.883

**测试和工作正常**

```
<nav class="dnt_show_mbl navbar navbar-default navbar-fixed-top" >
  <div class="container" style="width:100%;">
    <div class="navbar-header" style="height:90px;">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>

      <a class="navbar-brand dnt_show_mbl" href="index.html" style="margin-left:100%;margin-top:2%;">
        <img src="material/logo.png" width="160px;" alt="visoka">
      </a>
      <a class="navbar-brand dontdisplaylg" href="index.html" style="" alt="visoka">
        <img src="material/logo.png" width="200px;">
      </a>

    </div>

    <div class="collapse navbar-collapse" id="myNavbar" style="background-color: #fff;border-color:#fff;">
      <ul class="nav navbar-nav navbar-right" style="margin-top: 4px;margin-right: 180px;padding:15px;letter-spacing:1px;color:#000;">

        <li><a href="index.html" style="font-family: Inter !important;">HOME</a></li>
        <li><a href="About-Us.html" style="font-family: Inter !important;">ABOUT US</a></li>

        <li class="dropdown-header" style="margin-top:-3px;margin-left:-3%;" onmouseout="out_menu();" onmouseover="on_menu();">
        <a style="font-family: Inter !important;" class="dropdown-toggle" href="Projects.html">PROJECTS
        <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="Projects.html#ongoing" style="font-family: Inter !important;">Ongoing Projects</a></li><br>
          <li><a href="Projects.html#completed" style="font-family: Inter !important;">Completed Projects</a></li><br>
          <li><a href="Projects.html#upcoming" style="font-family: Inter !important;">Upcoming Projects</a></li>
        </ul>
      </li>
      </ul>
    </div>
  </div>
</nav> 
```

```
 <script>
function on_menu(){
$(".dropdown-header:first").addClass("open");
}

function out_menu(){
$(".dropdown-header:first").removeClass("open");
}
</script> 
```

# iphone - 从 AppDelegate 导航到视图控制器不会禁用前一个视图控制器的音频播放

> ID：16214327
> 
> 赞同：0
> 
> 时间：2013-04-25T12:08:40.340
> 
> 标签：iphone, ios, objective-c, avaudioplayer

我是iOS编程的新手。我的导航控制器有问题。我的 rootViewController 是“WelcomeViewController”。我从根视图导航到“AbcViewController”，当加载“AbcViewController”时，它会播放一个音频文件。但是，当我在“AppDelegate”类中收到一条特殊消息时，我正在从 AppDelegate 类中推入 XyzViewController。但问题是 AbcViewController 的音频播放继续播放，尽管当前视图显示 XyzViewController。但是当可见控制器是 XyzViewController 时，播放器不应该播放。我认为我的导航有问题。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:31:51.560

正如 Robert 已经说过的，您需要在 AbcViewController viewWillDisapper 中停止音频：

希望有所帮助。

# php - 控制台行输出重定向块文件并阻止读取它

> ID：16214329
> 
> 赞同：0
> 
> 时间：2013-04-25T12:08:46.153
> 
> 标签：php, console, output

如何将控制台应用程序（本例中为 php.exe）的输出重定向到文本文件（本例中为 output.txt）而不阻塞它？PHP 脚本需要很多时间，我需要从它异步读取输出（来自 httpd->javascript->webpage）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:29:22.097

没关系 - passthru php 函数帮助了我很多:)

# d3.js - D3 树：线而不是对角线投影

> ID：16214336
> 
> 赞同：8
> 
> 时间：2013-04-25T12:08:53.740
> 
> 标签：d3.js, tree

我正在使用 d3.js 使用[此示例](http://bl.ocks.org/mbostock/2949981/)创建一棵树。

这可以完美地处理我拥有的数据并产生所需的结果，除了一个细节：我不想要节点之间那些*摇摆不定*的连接线，我想要一条干净简单的线。谁能告诉我如何制作它？

我一直在查看 d3.js 的 API 文档，但没有成功。据我了解，`svg.line`给定一组两对坐标（x，y），该函数应该产生一条直线。我想我需要知道的是：给定这些数据，如何在给定*链接*数组中每对节点的 (cx,cy) 的情况下创建一条**线：**

 *`````
var margin = {top: 40, right: 40, bottom: 40, left: 40};

var width = 960 - margin.left - margin.right; 

var height = 500 - margin.top - margin.bottom;

var tree = d3.layout.tree()
    .size([height, width]);

var diagonal = d3.svg.diagonal()
    .projection(function(d) { return [d.y, d.x]; });

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.csv("graph.csv", function(links) {
    var nodesByName = {};

links.forEach(function(link) {
var parent = link.source = nodeByName(link.source),
    child = link.target = nodeByName(link.target);
    if (parent.children) parent.children.push(child);
    else parent.children = [child];
});

var nodes = tree.nodes(links[0].source);

svg.selectAll(".link")
    .data(links)
.enter().append("path")
    .attr("class", "link")
    .attr("d", diagonal);

svg.selectAll(".node")
    .data(nodes)
.enter().append("circle")
    .attr("class", "node")
    .attr("r", 10)
    .attr("cx", function(d) { return d.y; })
    .attr("cy", function(d) { return d.x; });

function nodeByName(name) {
    return nodesByName[name] || (nodesByName[name] = {name: name});
}
}); 
````  `* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-25T12:20:36.077

其实我从其他例子中发现：

 ````
svg.selectAll(".link")
    .data(links)
.enter().append("line")
    .attr("class", "link")
    .attr("x1", function(d) { return d.source.y; })
    .attr("y1", function(d) { return d.source.x; })
    .attr("x2", function(d) { return d.target.y; })
    .attr("y2", function(d) { return d.target.x; }); 
``````*

# python - 如何让 Django South 迁移更改 max_length 的字段？

> ID：16214341
> 
> 赞同：3
> 
> 时间：2013-04-25T12:09:01.530
> 
> 标签：python, django, django-south

我有`CharField`一个模型，我想为其增加`max_length`属性。South 没有注意到这种变化，说没有什么可以迁移的。我如何让它迁移这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T14:16:32.803

发出命令（更改`max_length`代码后）：

```
python manage.py schemamigration <name of the app> --auto
python manage.py migrate <name of the app> 
```

这对我有用。希望能帮助到你

# ruby-on-rails - 从 gem 中包含或扩展类/模块（例如设计）

> ID：16214344
> 
> 赞同：1
> 
> 时间：2013-04-25T12:09:10.670
> 
> 标签：ruby-on-rails, module, devise

我写了一个小模块**lib/encryption/encryption.rb**

```
module Encryption
  def self.encrypt(value)
    ...
  end

  def self.decrypt(value)
    ...
  end
end 
```

我想在 Devise 的这两个文件中使用/访问这个模块，即：

1.  **token_authenticable.rb**
2.  **可验证的.rb**

我已经通过创建 2 个新文件并将它们放入 /config/initilaizers 来覆盖它们（复制其中的原始源代码并修改它们）

1.  **/config/initializers/token_authenticable.rb**
2.  **/config/initializers/authenticable.rb**

例如，一个文件如下所示：

```
require 'devise/strategies/token_authenticatable'
require './lib/encryption/encryption.rb' #TRIED THIS, BUT DOES NOT WORK

module Devise
  module Models
    # The TokenAuthenticatable module is responsible for generating an authentication token and
    # validating the authenticity of the same while signing in.
    ... 
```

我的修改工作，但我怎样才能在这些文件中访问我的 lib/Encryption.rb 模块？这种修改方法是最佳实践吗？如果没有，正确的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:36:22.613

如果你的 application.rb 中有这个：

```
config.autoload_paths += %W(#{config.root}/lib) 
```

然后 '/lib' 将被自动加载。意思是你可以打电话

```
require 'encryption/encryption' 
```

它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:30:23.237

在一个类中包装两个方法，例如 MyEncryptionAlgo。创建该类的对象

```
obj = Encryption::MyEncryptionAlgo.new 
```

使用这个对象来访问这两个方法。

```
obj.encrypt(value)
obj.decrypt(value) 
```

# php - PHP中的视图状态

> ID：16214345
> 
> 赞同：1
> 
> 时间：2013-04-25T12:09:11.970
> 
> 标签：php, forms, viewstate

是否可以在 PHP 中启用视图状态？您输入值的地方，即使您刷新页面，该值也会保留在那里。如果是，非常感谢简要说明它的工作原理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:10:40.843

你在 PHP 中没有任何这样的东西，但你可以使用 PHP 会话来存储变量，即使在页面加载时你也可以在以后使用这些值。

# javascript - 什么时候定义一个模块，什么时候只需要使用 requireJS 的文件

> ID：16214348
> 
> 赞同：0
> 
> 时间：2013-04-25T12:09:29.710
> 
> 标签：javascript, module, requirejs

我正在努力让 requireJS 正常工作。Page 运行良好，但我认为我做事的方式非常错误。

例如，**在页面 xzy 上**，我在页面末尾添加了以下 JavaScript（JS 必须暂时保留在页面上，因此不可能有外部 js 文件）

```
<script type="text/javascript" language="javascript">
  //<![CDATA[
  (function () {
    require([
      'async!http://maps.google.com/maps/api/js?v=3&sensor=false',
      'maps/jquery.ui.map.full.min.js',
      'maps/jquery.ui.map.extensions.min'
      ], function() {

        // ... do stuff with Google Maps

      }
    );
  }());
//]]>
</script> 
```

这样做会使`google.map`方法`$.().gmap`全局可用，而这可能不应该全局可用。

**问题：**
我应该把它转换成 requireJS 模块吗？为什么？

如果是这样，该模块是否也可以在其他页面上使用，还是我只是在**第 123 页**“重新定义”并且依赖文件已经被缓存？

最后 - 我是否必须将我的 require 调用中的代码转换为 module.methods，然后我通过调用`module_name.method_name(pass_some_parameters)`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:40:20.370

只看JS：

[http://maps.google.com/maps/api/js?v=3&sensor=false](http://maps.google.com/maps/api/js?v=3&sensor=false)

你可以看到这`window.google`是一个全球性的。如果没有 Google 发布 AMD 版本，您将无能为力。

您是否应该创建一个模块的决定首先应该是 JS 代码的可读性/可维护性的问题。模块是（应该）、可读、可重用的代码块/可重用抽象，其余代码可以使用。您还应该从中获得测试好处 - 每个模块都应该更容易单独测试。

如果您选择模块化方法，您最终可能会得到更多的 JS 文件，并且您可能认为这会导致性能问题 - 即多个 HTTP 请求。但这可以通过使用[RequireJS 优化](http://requirejs.org/docs/optimization.html)器将您的模块优化为单个文件来缓解。

如果您转换为模块，是的，您可以`require`从其他页面进行转换，并且如果您的 HTTP 缓存标头已设置，则浏览器可能会选择使用缓存版本，从而为您节省 HTTP 请求（如果您使用相同的缓存试探法）已将每个模块优化为一个文件）。

如果您*重新定义*（我假设您的意思是复制并粘贴代码块），那么调用中列出的那些依赖项都`require` *应该*由浏览器缓存，因此*立即*可用（取决于您的 Web 服务器及其 HTTP 缓存标头） .

最后，是的，您可能需要稍微重构代码以公开新模块的 API。如果这意味着使用方法公开单个对象，那么这就是您应该做的。根据我的经验，这个过程几乎不可避免地会导致更好的代码。由于您必须更多地考虑模块的目的是什么，这通常会导致您破坏代码段之间的耦合。

# c# - 如何在 WPF 应用程序中启动主类？

> ID：16214349
> 
> 赞同：0
> 
> 时间：2013-04-25T12:09:30.713
> 
> 标签：c#, wpf, wpf-controls

我是 WPF 的新手。我在开发 WPF 应用程序时遇到问题，在我想显示欢迎表单之后，我想在其中启动一个类作为启动对象。当我试图将主要方法放在该类中时，将项目属性启动对象设置为该类。我收到此错误**“调用线程必须是 STA，因为许多 UI 组件都需要这个。”** .

我们如何通过将该类的主要方法作为启动对象来解决此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T15:29:43.983

在顶部 App.xaml

```
Exit="App_Exit"
Startup="App_Startup" 
```

在 app.xaml.cs 中

```
void App_Startup(object sender, StartupEventArgs e)
private void App_Exit(object sender, ExitEventArgs e) 
```

您可以订阅其他事件，如果您真的需要将 App 覆盖为启动，您需要在 Program.cs 中定义，如下所示：

```
public static class Program
    {

        [STAThread]
        [PermissionSet(SecurityAction.Demand, Name = "FullTrust")]
        public static void Main(string[] args)
        { 
```

在里面的某个地方

```
App app = new App();
app.InitializeComponent();
app.Run(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-25T12:21:47.250

当您说“欢迎表格”时，您的意思是`Window`？

您是否尝试过设置 App.xaml 的 StartupUri？

```
<Application x:Class="DemoApp.App"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         StartupUri="WelcomeWindow.xaml">
    <Application.Resources>

    </Application.Resources>
</Application> 
```

# cognos - IBM Cognos Report Studio：表达式构建器语法

> ID：16214351
> 
> 赞同：1
> 
> 时间：2013-04-25T12:09:35.870
> 
> 标签：cognos

我正在使用 Report Studio，需要为交叉表查询创建一些表达式。我正在尝试将订单分组为年龄组（对于交叉表中的行）。为了构建这些组，我尝试创建如下表达式：

```
select [SQL5].[OUTBOUND_ORDER_ID], [SQL5].[PRIORITY] 
where [SQL5].[OUTBOUND_ORDER_LINE_ID] =1 AND [SQL5].[AGE] <= 2 
```

尽管这适用于大多数 SQL 平台，但 cognos 并未验证表达式。虽然 IBM 有很多用于计算的材料，但我无法找到任何带有语法示例的材料。有 Report Studio 经验的人可以提供一个语法示例来执行上述表达式吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T07:28:22.340

What's the validation error you get? It appears you forgot the FROM part

```
select [SQL5].[OUTBOUND_ORDER_ID], [SQL5].[PRIORITY] 
from [SQL5]
where [SQL5].[OUTBOUND_ORDER_LINE_ID] =1 AND [SQL5].[AGE] <= 2 
```

# ruby-on-rails - Ruby on Rails - 在电子邮件 NoMethodError 上恢复密码

> ID：16214352
> 
> 赞同：3
> 
> 时间：2013-04-25T12:09:36.363
> 
> 标签：ruby-on-rails, ruby, haml, password-recovery

我正在设置重置密码功能。提交后，将发送一封电子邮件，其中包含重置密码链接。[如railscast 第 274 集](http://railscasts.com/episodes/274-remember-me-reset-password)所述，我正在从头开始执行此操作。但是，当我提交电子邮件时，我收到此错误。

## PasswordResetsController#create 中的 NoMethodError

```
undefined method `password_reset_sent_at=' for # <User:0xa9fd828>

app/models/user.rb:26:in `send_password_reset'
app/controllers/password_resets_controller.rb:7:in `create' 
```

**要求**

**参数：**

```
{"utf8"=>"✓",
"authenticity_token"=>"HnuB/J15XZtz3MTCd25MCwm06M3G2AbcRH+cFxzdj+8=",
"email"=>"cauterise@gmail.com",
"commit"=>"Reset Password"} 
```

开发日志说的和上面一样^

**应用程序/模型/user.rb**

```
def send_password_reset
  generate_token(:password_reset_token)
  self.password_reset_sent_at = Time.zone.now
  save!
  UserMailer.password_reset(self).deliver
end

def generate_token(column)
  begin
  self[column] = SecureRandom.urlsafe_base64
  end while User.exists?(column => self[column])
end 
```

**应用程序/控制器/password_resets_controller.rb**

```
class PasswordResetsController < ApplicationController
  def new
  end

def create
  user = User.find_by_email(params[:email])
  user.send_password_reset if user
  redirect_to root_url, :notice => "Email sent with password reset instructions."
end

def edit
  @user = User.find_by_password_reset_token!(params[:id])
end

def update
  @user = User.find_by_password_reset_token!(params[:id])
  if @user.password_reset_sent_at < 2.hours.ago
    redirect_to new_password_reset_path, :alert => "Password reset has expired."
  elsif @user.update_attributes(params[:user])
    redirect_to root_url, :notice => "Password has been reset!"
  else
    render :edit
  end
end
end 
```

**应用程序/控制器/application_controller.rb**

```
def current_user
  @current_user ||= User.find_by_auth_token!(cookies[:auth_token]) if cookies[:auth_token] 
```

**应用程序/vies/password_resets/new,html.haml**

```
%h1 Reset Password
= form_tag password_resets_path, :method => :post do
  .field
    = label_tag :email
    = text_field_tag :email, params[:email]
  .actions
    = submit_tag "Reset Password"
  end 
```

我已经做了 rake:db:reset 和 rake:db:migrate AND RESET SERVER。

编辑：数据库用户

*   id 整数主键

*   电子邮件 varchar(255)

*   密码哈希 varchar(255)

*   password_salt varchar(255)

*   created_at 日期时间

*   更新日期时间

*   auth_token varchar(255)

*   password_reset_token varchar(255)

*   password_reset_send_at 日期时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:03:18.540

看来您的数据库用户列password_reset_send_at 应该是password_reset_sent_at。您可以通过进入迁移文件并进行简单的更改然后运行来更改它

```
$ rake db:reset
$ rake db:migrate 
```

# iphone - 使用 url 连接时我的应用程序崩溃

> ID：16214353
> 
> 赞同：0
> 
> 时间：2013-04-25T12:09:37.647
> 
> 标签：iphone, ios, objective-c

我正在研究基于服务器的项目，如果我一个一个推送到 3 个视图控制器.. 每个视图我都在请求 url，并且在这种情况下我从服务器获取数据它工作正常但是当我弹出（或）来时返回上一个视图 不断单击后退按钮我的应用程序崩溃，因为来自服务器的数据没有完全收到，我再次请求另一个 url

```
 - (void)connectionDidFinishLoading:(NSURLConnection *)connection {

    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;

    [self hideLoader];

    if (_delegate != nil) {

        NSMutableData *data = [[NSMutableData alloc]initWithData:responseData];

        [_delegate finishedReceivingData:data withRequestMessage:requestMessage];

        [data release];

    } -- getting error here.. 
```

而且我想要我的应用程序的崩溃报告是否有任何框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:13:09.717

在控制器/视图的 dealloc 方法中（取决于谁是您的委托人），您需要将您的委托财产归零。

```
- (void)dealloc
{
   _urlConnection.delegate = nil;

[super dealloc];
} 
```

不要指望零条件。它可以被释放，但不能为零。

# drupal-7 - 如何在 omega 子主题中创建新区域？

> ID：16214354
> 
> 赞同：1
> 
> 时间：2013-04-25T12:09:38.013
> 
> 标签：drupal-7, drupal-themes, regions

我是drupal开发的新手。我知道在自定义主题中创建区域。但我想创建一个子主题作为欧米茄的基本主题。我想添加新区域但没有工作我无法在该区域中添加块？有人帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T02:48:53.713

在您的 omega subtheme .info 文件中添加一个新区域：

region[machine_name] = '实际名称'

然后清除缓存，进入子主题外观设置，单击“区域和区域配置”选项卡，然后向下滚动到底部以找到“未分配区域”。只需将其分配给一个区域，配置上面的选项，然后保存。

然后在 Structure->Blocks 中向区域中添加一个块并适当地对其进行模板化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T04:34:13.997

首先在您的主题 .info 文件中定义区域。请参阅：[.info 文件的结构](http://drupal.org/node/171205)

然后将相关的模板标签放入您的`page.tpl.php`文件中。例如，如果您在主题 .info 文件中定义了区域侧边栏，那么您将添加：`<?php print render($page['sidebar']); ?>`到 page.tpl.php 中的相关位置。

注意：如果您的主题没有 page.tpl.php 文件，您可以从基本主题复制默认值，然后修改该副本。并做`clear the cache`。

# javascript - 如何更改 NVD3 中控制按钮上的标签？

> ID：16214358
> 
> 赞同：1
> 
> 时间：2013-04-25T12:09:52.003
> 
> 标签：javascript, d3.js, nvd3.js

这是我的问题：在 NVD3 图表上，有时会出现带有单选按钮的“堆叠”或“分组”等选项。

我想做的是更改这些按钮的标签。由于我是法国人，我想用“Groupé”代替“Grouped”，用“Empilé”代替“Stacked”。不知道我说清楚了吗？

可能吗？我已经查看了不同的 js 文件，例如“legend”、tooltips”……但这并没有真正的帮助（对于我是 javascript 和 nvd3 新手……）。

谢谢你的回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:42:31.957

不幸的是，这些标签的字符串在源中（在相应的文件中`models/`）硬编码，因此您必须更改源。生成的带有文本的控件元素没有特定的 ID 或类，因此动态选择和更改它们并不是一个真正的选项。

你最好的选择是改变来源。只需在 Javascript 文件中搜索要更改的字符串即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-20T10:31:04.820

只是为了更新这个答案：在 1.8 版中，您可以执行以下操作：

```
chart = nv.models.multiBarChart()
    .controlLabels({"grouped":"Groupé","stacked":"Empilé"})
    // add your other chart parameters, eg color, margin etc here
; 
```

# java - 使用命令提示符创建一个包含外部 jar 的 war 文件

> ID：16214359
> 
> 赞同：0
> 
> 时间：2013-04-25T12:09:55.910
> 
> 标签：java, glassfish-3

我有两个项目 - Project1 和 Project2。Project1 包含所有的 java 类。而project2包含了project1中需要的所有jar文件。意味着，Project1 取决于 Project1（对于 jars）。

我正在使用 Glassfish 服务器。在创建 Project1 的 war 文件时，我包含了 project2 中的所有 jar 文件。

**示例：**
Project2 包含 2 个包 - POI 和 Web 服务。
**POI包包含：**
poi-examples-3.6-20091214.jar、
poi-contrib-3.6-20091214.jar、
poi-ooxml-3.6-20091214.jar、
poi-ooxml-schemas-3.6-20091214.jar、
poi-scratchpad- 3.6-20091214.jar。

**web-services 包包含：**
javax.servlet-3.0.jar、
javax.servlet-api.jar、
jersey-bundle-1.10.jar、
jersey-client-1.12.jar、
jersey-core-1.12.jar、
jersey-multipart- 1.4.jar。

现在为了从命令提示符创建 Project1 的 war 文件，我使用了以下命令：

```
jar cvf Project1.war D:\JavaProject\Project2\lib\external\poi\poi-examples-3.6-20091214.jar D:\JavaProject\Project2\lib\external\poi\poi-contrib-3.6-20091214.jar D:\JavaProject\Project2\lib\external\poi\poi-ooxml-3.6-20091214.jar D:\JavaProject\Project2\lib\external\poi\poi-ooxml-schemas-3.6-20091214.jar D:\JavaProject\Project2\lib\external\poi\poi-scratchpad-3.6-20091214.jar D:\JavaProject\Project2\lib\external\web-services\javax.servlet-3.0.jar D:\JavaProject\Project2\lib\external\web-services\javax.servlet-api.jar D:\JavaProject\Project2\lib\external\web-services\jersey-bundle-1.10.jar D:\JavaProject\Project2\lib\external\web-services\jersey-client-1.12.jar D:\JavaProject\Project2\lib\external\web-services\jersey-core-1.12.jar D:\JavaProject\Project2\lib\external\web-services\jersey-multipart-1.4.jar 
```

在当前目录中创建的 Project1.war 文件。但是，当我尝试在 Glassfish 服务器上部署 Project1.war 时，遇到了这个错误：

```
C:\glassfish3\glassfish\domains\domain1\applications\Project1\D:\JavaProject\Project2\lib\external\poi\poi-contrib-3.6-20091214.jar 
```

*（C:\glassfish3\glassfish\domains\domain1\applications\ 是部署后复制“.war”文件的目录）*

我无法理解这个问题。我为创建war文件而执行的命令有问题吗？使用命令行提示符创建war文件时如何包含外部jar？

请帮忙..提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:29:24.763

WAR 文件必须具有特定的文件结构。

```
/   
    META-INF/
    WEB-INF/
        classes/
             classes and other classpath resources go here
        lib/
             jar files go here
        web.xml
    other webapp stuff; e.g. HTML, JSPs, CSS ... 
```

如果你只是随意地将东西扔到一个 JAR 文件中，当它被 webapp 容器解包时，它不会被识别为 webapp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:25:32.690

您应该使用[WAR 展开的布局](http://en.wikipedia.org/wiki/WAR_file_format_%28Sun%29)，换句话说，project2 应该包含在 $PROJECT1_DEPLOYMENT_DIR/WEB-INF/lib 等等。然后，您的 jar 命令将生成一个可部署到 Glassfish 或任何其他 servlet 容器的文件。

# c# - 奇怪的 C# 属性定义（索引器）

> ID：16214363
> 
> 赞同：0
> 
> 时间：2013-04-25T12:10:07.160
> 
> 标签：c#, properties

这与 C# 中的普通属性有何不同？

```
 public new Point3D this[int index]
    {
        get { return base[index]; }
        set
        {
            base[index] = value;
            CollectionModified();
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T12:11:42.510

这是一个*索引器*；而不是被用作`obj.Foo`，它被用作`obj[index]`，即：

```
var oldVal = obj[1];
obj[1] = newVal; 
```

它是“不同的”，因为：

*   它没有明确的名称
*   它接受一个参数（或多个参数）

请注意，索引器参数不必是整数；可以是各种各样的：

```
Dictionary<string, decimal> lookup = ...
string employeeKey = "000006";
decimal salary = lookup[employeeKey]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:13:28.110

它是一个[索引器](http://msdn.microsoft.com/en-us/library/vstudio/6x16t2tx.aspx)。它是这样工作的（无需调用任何属性）：

```
yourPoints[0] = new Point3D();

Point3D point = yourPoints[0]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-25T12:14:53.490

这是一个*索引器属性*，一种让您的自定义类参与在方括号中传递数组下标的表达式的属性。

此索引器替换其基类（可能是集合）的索引器属性，该基类也必须具有索引器属性。getter 将调用转发到 base，而 setter 也调用`CollectionModified`，大概是为了通知正在监视集合中的修改的任何人。

# android - 奇怪的 NullpointerException android.content.ComponentName

> ID：16214365
> 
> 赞同：1
> 
> 时间：2013-04-25T12:10:16.527
> 
> 标签：android, android-activity

我有这行代码，我在这里得到一个 NullPointerException

第 219 行 Search.java

> > Intent intent = new Intent((Context) actionBar, SearchResultsMap.class)

例外

```
04-25 17:30:00.485: W/System.err(6518): java.lang.NullPointerException
04-25 17:30:00.501: W/System.err(6518):     at android.content.ComponentName.<init>(ComponentName.java:75)
04-25 17:30:00.501: W/System.err(6518):     at android.content.Intent.<init>(Intent.java:2823)
04-25 17:30:00.501: W/System.err(6518):     at com.itaxeeta.server.Search.onPostExecute(Search.java:219) 
```

AndroidManifest

```
<activity
            android:name="com.itaxeeta.SearchResultsMap"
            android:configChanges="keyboardHidden|orientation"
            android:label="@string/app_name"
            android:screenOrientation="portrait"
            android:theme="@android:style/Theme.Light.NoTitleBar" /> 
```

似乎 SearchResultsMap.class 即将作为 Null 出现，但它怎么可能，它是一个 Activity 并且它就在那里。它经常随机发生。我错过了什么？

编辑：为了清楚起见，添加了更多代码。

内部活动

```
public class HomeScreen extends MapActivity implements IActionBar
   ....
   onClick() {
   ....
   new Search(this, source, destination).execute();    
   ...
   }
} 
```

搜索类

```
 public Search(IActionBar actionBar, GeoPoint source, GeoPoint destination) {
    super(actionBar);
    this.source = source;
    this.destination = destination;
}

public interface IActionBar {
    public void setBusyVisibility(int visibility) ;
    public void setSubscribedToCount() ;
    public void setCurrentAddress(String address) ;
    public void setSubscribedToDetails(CustomJourneyUserInformation[] result);
    public Context getContext() ;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:27:35.990

利用

```
Intent intent = new Intent(getApplicationContext(), SearchResultsMap.class) 
```

或者

```
Intent intent = new Intent(Your_ClassName.this, SearchResultsMap.class) 
```

代替

```
Intent intent = new Intent((Context) actionBar, SearchResultsMap.class) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:16:18.997

`ActionBar` cannot be cast to `Context`, more than that, seems it's `null` at the time you instantiate the `Intent`. If this code is executed inside an `Activity`, just pass `this` as the first parameter.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T14:48:43.000

如果你想在 AsyncTask 中使用 Intent 然后使用这个代码，

```
public class Search extends AsyncTask<Main, Void, Main> {  
      @Override
        protected Main doInBackground(Main... params) { 
             return params[0]; 
       }
     protected void onPostExecute(Main params) { 
    // TODO Auto-generated method stub
         Intent intent = new Intent(params,SearchResultsMap.class); 
         startActivity(intent);
    }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-28T06:07:24.593

我也有同样的例外。就我而言，这是因为当我运行以下代码时： Intent intent = new Intent(activity, MyActivity.class) 活动已经完成。那么它是空的。

希望帮助别人。

# java - 错误/异常累积设计模式

> ID：16214367
> 
> 赞同：1
> 
> 时间：2013-04-25T12:10:19.823
> 
> 标签：java, design-patterns, exception-handling

一个方法返回一些结果，进行多次“尝试”来构建它。成功的第一次尝试应该返回。如果它们都没有成功，则应抛出异常：

```
class Calculator {
  public String calculate() throws Exception {
    // how do design it?
  }
  private String attempt1() throws Exception {
    // try to calculate and throw if fails
  }
  private String attempt2() throws Exception {
    // try to calculate and throw if fails
  }
  private String attempt3() throws Exception {
    // try to calculate and throw if fails
  }
} 
```

值得一提的是，抛出的异常`calculate`应该保留私有方法抛出的所有其他异常的堆栈跟踪。`calculate()`考虑到可扩展性和可维护性，您会如何推荐设计方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:16:52.780

I would use Composite and Command.

```
interface CalculateCommand {
     public void calculate(CalculateContext context);
} 
```

Now create an implementation for each attempt you want.

Next create a CompositeCommand -- here is an outline (you will need to fill in the blanks)

```
public class CompositeCalculateCommand implements CalculateCommand {

    CompositeCalculateCommand(List<CompositeCommand> commands) {
        this.commands = commands; // define this as a field
    }

    public void calculate(CommandContext context) {
         for (CalculateCommand command : commands) {
               try {
                   command.calculate(context);
               } catch(RuntimeException e) {
                   this.exceptions.add(e) // initialize a list to hold exceptions
               }
               if (context.hasResult) return; // break
         }
         // throw here. You didn't success since you never saw a success in your context.  You have a list of all exceptions.
    }

} 
```

finally use it like

```
CalculateCommand allCommands = new CompositeCalculateCommand(someListOfCommands);
allCommands.calculate(someContextThatYouDefine);
// results now on context. 
```

Note each command implementation is testable on its own, so this is very maintainable. If you need to add calculations, you simply define a new type of `CalculateCommand`, so this is extensible. It will also play well with dependency injection. Note I define a CommandContext object so different commands can take different types of stuff (put in a context).

# pdf - 使用 PS 驱动程序将文件 (pdf) 打印到打印机，获取 PS 文件并使用 ghostscript 转换为可搜索的 pdf

> ID：16214368
> 
> 赞同：0
> 
> 时间：2013-04-25T12:10:19.990
> 
> 标签：pdf, ghostscript, postscript

当我使用 PS 驱动程序打印 PDF 文件，然后使用 ghostscript（pdfwrite 设备）将 PS 文件转换为可搜索的 PDF 时，最终的 pdf 文件出现问题。它变得腐败。在某些情况下，空格字符会消失，而在其他情况下，文本宽度会变得太大，因此文本会与文本重叠。

gs 的设置是 -dNOPAUSE -dBatch -sDEVICE=pdfwrite -dEmbedAllFonts=true -dSubsetFonts=false -sOutputFile=output.pdf input.ps

我想知道当输入文件是pdf时是否是ghostscript无法产生良好的输出。如果我打印一个 word 文档，一切正常！

是否有任何其他解决方案，例如使用 xps 驱动程序并将 xps 文件转换为可搜索的 pdf 文件？有没有可以做到这一点的解决方案？

我使用 gs 9.07。

最好的问候乔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T13:10:36.383

您为什么要完成将 PDF 文件打印到 PostScript 文件的步骤？Ghostscript 已经能够接受 PDF 文件作为输入。

这只会增加更多的混乱，它肯定不会增加任何有用的东西。

如果没有看到原始 PDF 文件和驱动程序生成的 PostScript 文件，就无法说出“可能”是什么问题。我的猜测是，处理 PDF 的任何应用程序都没有嵌入字体，或者 PostScript 驱动程序无法将字体转换为适合 PostScript 的字体，导致输出中缺少字体，并且pdfwrite 设备必须用“其他东西”替换丢失的字体。

当输入是 PDF 时，Ghostscript（更准确地说是 pdfwrite 设备）完全有能力生成像样的 PDF 文件，但您的输入不是 PDF，它的 PostScript！

老实说，如果您的原始 PDF 文件不可“搜索”，那么 pdfwrite 生成的 PDF 文件也不太可能，无论您是使用原始 PDF 还是将其修改为 PostScript。

PDF 文件不可“搜索”的常见原因是没有 ToUnicode 信息，字体使用自定义编码进行编码，而 deos 不使用标准字形名称。如果是这种情况，除了 OCR 之外，您无法对 PDF 文件执行任何操作。

# jsf - 以编程方式注册 taglib 引用

> ID：16214371
> 
> 赞同：2
> 
> 时间：2013-04-25T12:10:26.670
> 
> 标签：jsf, el, jsf-1.2, taglib

有没有办法以编程方式在 java 代码中注册自定义 taglib 引用？
我正在使用 JSF 1.2_09，丰富的面孔 3.3.3，jsf-facelets 1.1.14。

具体来说：

在这段代码中，jsf 表达式语言用于为我们做一些工作，比如在一个字段中连接 2 个结果或类似的东西..

```
FacesContext ctx = FacesContext.getCurrentInstance();
Application app = ctx.getApplication();
ExpressionFactory ef = app.getExpressionFactory();
ELContext elContext = ctx.getELContext();
ValueExpression valueExpression = new OverrideValueExpression(singleResult.getClass(), singleResult);
elContext.getVariableMapper().setVariable("row", valueExpression);

for (int i = 0; i < jsfDisplayValue.size(); i++){
    Object value = ef.createValueExpression(elContext, jsfDisplayValue.get(i), Object.class).getValue(ctx.getELContext());
//Do something with value...
} 
```

例如，元素 of`jsfDisplayValue`可以是：
“#{row.name} #{row.surname}”、“#{row.age}”、`"#{tagfoo:fooFunction(row.age)}"`...
当表达式包含函数（如高亮显示）时会出现问题`tagfoo:fooFunction`。

堆栈跟踪：

```
javax.el.ELException: Function 'tagfoo:fooFunction' not found
    at org.apache.el.lang.ExpressionBuilder.visit(ExpressionBuilder.java:198)
    at org.apache.el.parser.SimpleNode.accept(SimpleNode.java:147)
    at org.apache.el.lang.ExpressionBuilder.prepare(ExpressionBuilder.java:155)
    at org.apache.el.lang.ExpressionBuilder.build(ExpressionBuilder.java:173)
    at org.apache.el.lang.ExpressionBuilder.createValueExpression(ExpressionBuilder.java:217)
    at org.apache.el.ExpressionFactoryImpl.createValueExpression(ExpressionFactoryImpl.java:67) 
```

`tagfoo`ELContext 无法识别自定义函数，由于ELContext 未知，因此无法解析该函数​​。如何在 java 类中注册 taglib 引用，以便 ELContext 可以识别自定义函数？

在 JSF 页面上，我会这样做：

```
<jsp:root version="2.0" xmlns:jsp="http://java.sun.com/JSP/Page"
xmlns:tagfoo="http://tagfoo.org/tags"> 
```

PS
我的自定义函数在 jsf 页面上正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-21T16:38:08.877

对不起，我来晚了，但我今天偶然发现了同样的问题。

检查 ElContext 和 FunctionMapper 实例，我发现它们肯定是标准抽象类的自定义实现。

由于我想保持我的代码可移植性，我决定不参与为特定实现编写代码，并且由于抽象类只定义了读取合同并省略了写入方面，所​​以我只编写了一个自定义 FunctionMapper。这是有意义的代码：

```
public void register(String prefix, String function, Method method) {
    register.put(prefix + ":" + function, method);
}

@Override
public Method resolveFunction(String prefix, String localName) {
    if (register.containsKey(prefix + ":" + localName)) {
        return register.get(prefix + ":" + localName);
    }
    for (FunctionMapper it : delegates) {
        final Method current = it.resolveFunction(prefix, localName);
        if (current != null) {
            return current;
        }
    }
    return null;
} 
```

通过包装标准 FunctionMapper，我可以轻松添加自己的函数并保持标准环境正常。在我的例子中，我也必须编写一个自定义的 ElContext 实现，它基本上克隆了默认的 ElContext 并只包装了 FunctionMapper。

我对结果很满意，希望这会有所帮助。

# php - 试图了解 php 脚本运行的整个进度

> ID：16214376
> 
> 赞同：-1
> 
> 时间：2013-04-25T12:10:41.433
> 
> 标签：php

我试图了解 php 脚本运行的整个进度。比如analyze,compile,...我在网上搜索，但没有找到关于它的好文章。那么有什么解释或文件吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:14:18.813

PHP 是一种脚本语言，在运行之前不会编译。

几乎所有你想知道的都可以在[http://www.php.net找到](http://www.php.net)

它确实是很好的文档，试一试。

# python - Python 布尔方法命名可读性

> ID：16214385
> 
> 赞同：11
> 
> 时间：2013-04-25T12:11:05.927
> 
> 标签：python, naming-conventions

对于 Python 中的布尔方法，以下哪种方式更具可读性？

```
document.is_editable    
document.editable    
document.has_editable    
document.can_be_editable    
document.can_edit 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:13:45.700

我会选择第一个（从 Java 开发人员的角度来看）。

# c# - 源绑定不起作用Windows Phone 7

> ID：16214388
> 
> 赞同：0
> 
> 时间：2013-04-25T12:11:14.757
> 
> 标签：c#, windows-phone-7

我正在将电影列表显示为我的 Windows Phone 7 应用程序的全景图。单击每部电影正在显示电影详细信息，演员表。电影细节，演员表显示为枢轴控件。电影细节效果很好但是当我展示演员时，它不起作用。我有演员表。并将源绑定到 cast pivot 控件中的列表框，但它不显示任何数据。请帮我。以下是我使用过的课程。谢谢

主视图模型.cs

```
public class MainViewModel
{
    public ObservableCollection<ItemViewModel> MovieItems { get; set; }

 } 
```

项目视图模型.cs

```
 public class ItemViewModel : INotifyPropertyChanged
{

     private string _title;
     public string _Title
      {
        get { return _title; }

        set
        {
            if (value != _title)
            {
                _title = value;
                NotifyPropertyChanged("title");
            }
        }
    }

      private ObservableCollection<Cast> _cast;

    public ObservableCollection<Cast> _Cast
    {
        get { return _cast; }

        set
        {
            if (value != _cast)
            {
                _cast = value;
                NotifyPropertyChanged("Cast");
            }
        }
    }
  ..........

} 
```

Cast.cs

```
public class Cast
 {
      public string name { get; set; }
      public string imagesource { get; set; }

      public Cast(string _name, string _imagesource)
      {
        this.imagesource = _imagesource;
        this.name = _name;
      }
 }
for each movie i have a list of cast objects 
```

电影模型.cs

```
 App.Model.MovieItems.Add(
                   new ItemViewModel()
                   {
                       _Title = data["title"].ToString(),
                       _Cast=casObs,
                      ........
                   }
                   ); 
```

电影细节.xml

```
 <ListBox Name="ListBox" Margin="0,0,-12,0" ItemsSource="{Binding _Cast}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="0,0,0,17" Width="432" Height="78">
                            <Canvas>
                                <TextBlock HorizontalAlignment="Center"   VerticalAlignment="Bottom" Margin="120,5,60,3" Text="{Binding name}" TextWrapping="Wrap" FontSize="32" Style="{StaticResource PhoneTextNormalStyle}"/>
                                <Image Height="90" HorizontalAlignment="Left" Margin="12,10,0,0" Name="image1" Stretch="Fill" VerticalAlignment="Top" Width="90" Source="{Binding imagesource}" />
                            </Canvas>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:39:12.570

代替

```
NotifyPropertyChanged("title"); 
```

至

```
NotifyPropertyChanged("_Title"); 
```

和

```
NotifyPropertyChanged("Cast"); 
```

至

```
NotifyPropertyChanged("_Cast"); 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T18:22:47.440

在中间应用转换器，您需要返回 ImageSource/BitmapImage，而不是字符串

# java - 使用 Itext 在文本到 PDF 转换期间创建新页面

> ID：16214389
> 
> 赞同：0
> 
> 时间：2013-04-25T12:11:17.490
> 
> 标签：java, itext

我正在使用 iText 将文本文件转换为 PDF。转换工作正常，但如果 BufferedReader 遇到某个文本，我需要在转换过程中启动一个新的 PDF 页面。这是我尝试过的但是遇到该文本时没有启动新页面。我的示例代码如下（只是相关部分）。

```
Document output = new Document(PageSize.B3);
FileInputStream fs = new FileInputStream("C:/ABC Statements final/File.TXT");
FileOutputStream file = new FileOutputStream(new File("C:/Pdf Statements/File.PDF"));
BufferedReader br = new BufferedReader(new InputStreamReader(fs));
PdfWriter writer = PdfWriter.getInstance(output, file);
                output.open();
                writer.open();
.............................
String pageend = "Page Total";
                String trimmedend = br.readLine().trim();
                if (trimmedend.startsWith(pageend)) {
                    output.newPage();
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T08:00:44.073

也许您需要将您的`if`-statement 更改为以下内容：

```
String pageend = "page total";
...
if (trimmedend.toLowerCase().contains(pageend)) {
    ...
} 
```

这样，您可以避免区分大小写，并避免在“页面总数”之前出现不被视为空格的字符的问题。当然：这只是一个有根据的猜测。我不知道您的原始数据流是什么样的。

# solr - 来自 cassandra 数据库的 solr 中的索引列 type="timestamp"

> ID：16214390
> 
> 赞同：0
> 
> 时间：2013-04-25T12:11:21.753
> 
> 标签：solr

在这里我使用 DSE-3.0。我想在 cassandra 数据库的 solr 中索引列 type="timestamp" name="DateTime"。对于 type="timestamp"，solr 中 schema.xml 中的 fieldType 应该是什么。请帮帮我.我非常需要它。谢谢 这是我的数据库输出： -- cqlsh:mykeyspace> SELECT * FROM mysolr ;

钥匙,124 | Date_Time,2013-02-11 10:10:10+0530 | 身体，每锅一只鸡... | 日期，1933 年 12 月 15 日 | 姓名，罗斯福 | 标题，炉边聊天

但是在查询中没有给出 Date_Time 字段的值。我在 solr 中的查询输出是：-- id,body,title,name,date 124,A chicken in every pot ...,炉边聊天,Roosevelt,"dec 15, 1933"

我缺少什么配置。请指导我正确的方式。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T15:42:12.703

在 4.2 之前的 Solr 版本`timestamp`中，示例[schema.xml](http://svn.apache.org/viewvc/lucene/dev/branches/lucene_solr_4_1/solr/example/solr/collection1/conf/schema.xml?view=markup)中有一个字段实现了预定义的`date`fieldType

```
 <field name="timestamp" type="date" indexed="true" stored="true" default="NOW"      
      multiValued="false"/> 
```

这是日期字段类型定义

```
 <!-- The format for this date field is of the form 1995-12-31T23:59:59Z, and
         is a more restricted form of the canonical representation of dateTime
         http://www.w3.org/TR/xmlschema-2/#dateTime    
         The trailing "Z" designates UTC time and is mandatory.
         Optional fractional seconds are allowed: 1995-12-31T23:59:59.999Z
         All other components are mandatory.

         Expressions can also be used to denote calculations that should be
         performed relative to "NOW" to determine the value, ie...

               NOW/HOUR
                  ... Round to the start of the current hour
               NOW-1DAY
                  ... Exactly 1 day prior to now
               NOW/DAY+6MONTHS+3DAYS
                  ... 6 months and 3 days in the future from the start of
                      the current day

         Consult the DateField javadocs for more information.

         Note: For faster range queries, consider the tdate type
      -->
    <fieldType name="date" class="solr.TrieDateField" precisionStep="0" positionIncrementGap="0"/> 
```

因此，基于此示例，我建议使用日期字段类型，注意它将以 UTC 格式存储。

# codeigniter - 替代 codeigniter 上的 uri 段？

> ID：16214391
> 
> 赞同：1
> 
> 时间：2013-04-25T12:11:27.943
> 
> 标签：codeigniter, uri

我从使用的表单中获取 id

```
 $id=$this->uri->segment(2) 
```

我需要你的帮助来用其他通用的东西代替它，而不需要从 url 获取 id 我也在几个页面中使用分页 & 我正在使用

```
$this->uri->segment() 
```

也 ..

PS：当我想显示属于某个类别的节目列表时，当我想显示属于某个类别的频道节目列表时，段会发生变化，所以我不会使用我想动态获取 id 的段。 .

最好的祝福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:17:04.710

不知道这是否是您所追求的，但您可以在标准的 codeigniter 安装中使用 URI 发送参数，并在方法 params 中捕获它们。

```
class Welcome extends MY_Controller {

    public function index($a = NULL, $b = NULL, $c= NULL)
    {
        echo 'Testing params: <br> 
            Param1: ' . $a . '<br>Param2: ' . $b . '<br>Param3: ' . $c;
    }
} 
```

调用`http://example.com/index.php/welcome/index/test1/test2/test3`会渲染

```
Testing params: 
Param1: test1
Param2: test2
Param3: test3 
```

* * *

## 例子

通过此评论代码：

> foreach $rows as $row .. .. id; ?>" href="程序/details_program/id; ?>"> program_title; ?> page detail.php $id = $this->uri->segment(2); $query = $this->db->get_where('programs', array('id' => $id));

看起来您有一个`program`带有您要链接到的方法的控制器，`details_program`这就是您想要不同解决方案的地方`uri->segment`。如果是这种情况，类似这样的内容将适用于以下 URL `http://example.com/program/program_details/123`：

```
class Program extends CI_Controller{

    function program_details($id = NULL){
        $query = $this->db->get_where('programs', array('id' => $id));
    }

} 
```

如果这不是您想要的，请使用所有相关（格式正确）代码更新问题

# vba - 使用 ppt 进行互动测验

> ID：16214395
> 
> 赞同：0
> 
> 时间：2013-04-25T12:11:42.123
> 
> 标签：vba, powerpoint

我之前发布了一个关于这个的垃圾问题并且已经离开并做了一些工作以重新提出。基本上我做了一个 ppt 测验，计算一个人给出了多少正确和错误的答案。然后它会在最后将此信息反馈给用户。但是我现在想要发生的是我希望存储结果，以便我可以返回并查看每个用户在测验中的表现。理想情况下，我希望它能够在 6 台联网计算机上工作，将所有测验结果存储在一个地方。但如果需要，我可以从 6 台计算机中的每台计算机中获取一个文件。

到目前为止，我的代码如下所示：

```
Dim username As String
Dim numberCorrect As Integer
Dim numberWrong As Integer

Sub YourName()
username = InputBox(prompt:="Type your Name")
MsgBox " Get Ready to begin " + username, vbApplicationModal, " Orange 1C Book 7"
End Sub

Sub correct()
numberCorrect = numberCorrect + 1
ActivePresentation.SlideShowWindow.View.Next
End Sub

Sub incorrect()
numberWrong = numberWrong + 1
ActivePresentation.SlideShowWindow.View.Next
End Sub

Sub Start()
numberCorrect = 0
numberWrong = 0
YourName
ActivePresentation.SlideShowWindow.View.Next
End Sub

Sub Results()
MsgBox "Well done " & username & " You got " & numberCorrect & " out of " & numberCorrect + numberWrong, vbApplicationModal, "Orange 1C Book 7"

End Sub' 
```

任何帮助将不胜感激。不知道从哪里开始下一步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:17:16.460

这是你的一个选择......但首先要解释一下。此代码将创建 TXT 文件。每次有人到达`Results`宏时，它都会将结果添加到文件中。因此，一个文件将保留所有结果，直到您不删除它们（或文件）。因此，我添加了分隔线和日期/时间信息，以便您轻松找到合适的结果。

```
Sub Save_Results_To_Txt()

    'set file results location to activepresentation path
    'or could be changed to any path string
    Dim strWhere As String
        strWhere = ActivePresentation.Path
    'let's set name of the file separately
    Dim strName As String
        strName = "\results.txt"

    Dim ff As Long
    ff = FreeFile

    Open strWhere & strName For Append As #ff

    Write #ff, Now & vbTab & username
    Write #ff, numberCorrect & vbTab & vbTab & numberWrong
    Write #ff, String(30, "-")

    Close #ff

End Sub 
```

您需要添加`Save_Results_To_Txt`到您的`Results`子中，可能`MsgBox`在行之前。

您的 results.txt 文件将如下所示：

```
"2013-04-25 16:11:05    Tom"
"10     11"
"------------------------------"
"2013-04-25 16:11:23    Mark"
"11     10"
"------------------------------" 
```

# java - 自定义验证器类不起作用

> ID：16214397
> 
> 赞同：4
> 
> 时间：2013-04-25T12:11:47.813
> 
> 标签：java, jsf-2, cdi

我在这里有一个问题：

**场景：** 我有一个 JSF-2，Spring（Beans 布线）应用程序。我编写了一个自定义验证器，我想执行它。

```
@FacesValidator("com.test.vali")
@Named("com.test.vali")
public class TestValidator implements Validator {

    @Override
    public void validate(FacesContext arg0, UIComponent arg1, Object arg2) throws ValidatorException {
        System.out.println("dhkdfkbhdfbkdfksdfdfk");

    }

} 
```

我试图使用以下方式注入验证器：

**方式#1：**

```
 <h:inputText value="#{helloWorld.name}">
      <f:validator binding="#{com.test.vali}" />
  </h:inputText> 
```

**输出**

当试图渲染页面时，它抛出了一个异常。

```
javax.servlet.ServletException: /testRichFaces.xhtml @17,48 <f:validator> A validator id was not specified. Typically the validator id is set in the constructor ValidateHandler(ValidatorConfig) 
```

对此进行了很多搜索，并验证了几种方法，例如：

1.  Java 文件在一个包中。

**方式#2**

```
 <f:validator validatorId="com.test.vali" /> 
```

**输出**

```
javax.servlet.ServletException: Expression Error: Named Object: com.test.vali not found. 
```

因此，从方式#1 和方式#2，我可以解释没有任何注释对我有用。

然后，我尝试转向最后一种方法：

方式#3：在 faces-config.xml 中添加验证器，只是为了表明我使用的是 2.0 合规性：

```
<faces-config xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
version="2.0"> 
```

验证器配置是：

```
 <validator>
       <validator-id>com.test.vali</validator-id>
       <validator-class>teet.TestValidator</validator-class>
 </validator> 
```

**输出**

作品

现在问题出现了，即使使用 JSF-2.0，我也不得不求助于 faces-config.xml。

可能是什么错误在做什么？

让知道是否需要更多配置。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T13:20:50.530

首先，您基本上混合了两种注册验证器实例的方法，它们完全独立工作：通过注册为面部验证器`@FacesValidator`，或通过注册为 CDI 托管 bean `@Named`。那些注解彼此不认识，也不考虑彼此。您基本上会得到两个完全不同的实例，它们不共享彼此的数据。为避免将来出现混淆，因此强烈建议**删除**其中一个注释，以便您可以保证始终使用同一个实例。

至于为什么方式1失败：

```
@Named("com.test.vali")
public class TestValidator implements Validator {
    // ...
} 
```

```
<f:validator binding="#{com.test.vali}" /> 
```

这是因为句`.`点是 EL 中的特殊运算符，表示 bean 属性访问或 bean 方法调用。Using`#{com.test.vali}`只会查找一个 bean `#{com}`，然后查找它的`test`属性，然后再查找它的`vali`属性。换句话说，它基本上是试图通过`com.getTest().getVali()`where `com`is a CDI managed bean like so 来获取验证器`@Named("com")`。

这不是你的本意。摆脱名称中的那些句点。更好的是，只要坚持默认的实例名称，`testValidator`. 这是最明智的选择，当然，如果你给你的类起一个合理的名字。

```
@Named
public class TestValidator implements Validator {
    // ...
} 
```

```
<f:validator binding="#{testValidator}" /> 
```

至于方式2失败的原因：

```
@FacesValidator("com.test.vali")
public class TestValidator implements Validator {
    // ...
} 
```

```
<f:validator validatorId="com.test.vali" /> 
```

`@FacesValidator`如果在启动期间未正确拾取，则可能会发生这种情况。当所讨论的类不在 WAR 内部，而是在 EAR 或 EJB 内部时，这可能反过来发生。在这种情况下，您需要在`faces-config.xml`. 但最好将类放在 WAR 中，即在项目的 EAR 或 EJB 部分中**绝对不要有任何 JSF 工件。**它将模型/服务逻辑（JPA、EJB 等）与视图（JSF）紧密耦合，并使它们不再可用于其他视图（前端），例如 JAX-RS、Spring MVC、Struts2 等。

# ruby-on-rails - 特定表的Rails脚手架奇怪的undefined_method错误

> ID：16214402
> 
> 赞同：0
> 
> 时间：2013-04-25T12:11:53.440
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我目前正在为现有数据库开发管理工具，在搭建特定表时遇到了一个奇怪的问题。

这是使用的表的架构`rake db:schema:dump`：

```
create_table "locality", :force => true do |t|
    t.integer "version",             :limit => 8,                  :null => false
    t.string  "truth_id",                                          :null => false
    t.string  "truth_record_id",                                   :null => false
    t.binary  "deleted",             :limit => 1,                  :null => false
    t.string  "internal_code",                                     :null => false
    t.string  "iso_code"
    t.string  "materialized_path",                                 :null => false
    t.string  "invariant_name",                                    :null => false
    t.binary  "published",           :limit => 1,                  :null => false
    t.float   "geo_point_latitude",               :default => 0.0
    t.float   "geo_point_longitude",              :default => 0.0
    t.string  "class",                                             :null => false
    t.integer "hut_count",                        :default => 0
    t.integer "hotel_count",                      :default => 0
    t.string  "destination_url"
  end

 add_index "locality", ["truth_record_id"], :name => "truth_record_id", :unique => true 
```

我使用[schema_to_scaffold](https://github.com/frenesim/schema_to_scaffold) gem 从转储的模式创建我的脚手架：

```
rails g scaffold locality version:integer truth_id:string truth_record_id:string
  deleted:binary internal_code:string iso_code:string materialized_path:string 
  invariant_name:string published:binary geo_point_latitude:float 
  geo_point_longitude:float class:string hut_count:integer hotel_count:integer 
  destination_url:string 
```

此工作流程适用于许多其他表，但是在 rails 控制台中访问 /localities 或 Locality.all 时，我得到了它：

```
irb(main):001:0> Locality.all
Locality Load (2.1ms)  SELECT `locality`.* FROM `locality` 
NoMethodError: undefined method `attribute_method_matcher' for "Country":String 
```

“国家”：字符串来自哪里？起初我认为模型名称“locality”在某种程度上是 i18n 东西的 rails 保留者，但在命名模型“Bla”时会发生同样的问题。

我正在使用 rails 3.2.13 和 MySQL 数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:26:02.640

我相信你的专栏：class 是无效的。由于该类已经是 ruby​​ 中任何对象的方法，您将如何访问该列？

我认为这会导致混乱。您加载的位置的类列的值是“国家”对吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:47:39.120

所以问题出在名为 的列上`class`，而 ruby​​ 显然讨厌这个列。

此 StackOverflow 问题中发布的解决方案：[Rails 中列名为“class”的旧表](https://stackoverflow.com/questions/4044043/legacy-table-with-column-named-class-in-rails)

或更具体地说，在这篇博文中（25.03.2013 访问）： http: [//kconrails.com/2011/01/28/legacy-database-table-column-names-in-ruby-on-rails-3/](http://kconrails.com/2011/01/28/legacy-database-table-column-names-in-ruby-on-rails-3/)

# r - 如何将 R 矩阵转换为 xts/zoo 对象？

> ID：16214409
> 
> 赞同：2
> 
> 时间：2013-04-25T12:12:21.650
> 
> 标签：r, matrix, xts, zoo

a我在运行返回函数后将 xts 派生的 R 矩阵转换回 xts 对象时遇到问题。这就是我所拥有的...

```
>    class(xtsData)
[1] "xts" "zoo"

> head(xtsData)
           ts_58_20_B_003_003 ts_58_20_S_021_005 ts_58_20_S_034_013 ts_58_20_S_042_021
2011-01-02            10001.0            10000.0              10000              10000
2011-01-03            10387.5            10001.0              10000              10000
2011-01-04            10387.5            10551.0              10000              10000
2011-01-05            10387.5            10562.5              10000              10000
2011-01-06            10387.5            10562.5              10000              10000
2011-01-07            10387.5            10562.5              10000              10000
> tail(xtsData)
           ts_58_20_B_003_003 ts_58_20_S_021_005 ts_58_20_S_034_013 ts_58_20_S_042_021
2013-03-05            21199.0              14905            10274.5               8859
2013-03-06            20498.0              14905            10274.5               8859
2013-03-07            20484.5              14905            10274.5               8859
2013-03-08            20957.5              15478            10847.5               9432
2013-03-11            20957.5              15478            10847.5               9432
2013-03-12            20531.5              14776            10847.5               9432 
```

按照 RMetrics 文档中的过程...

```
> xtsDataDiff <- xtsData[, ] / as.numeric( xtsData[1, ] )
> class( xtsDataDiff )
[1] "xts" "zoo" 
```

当我应用返回函数时，我将返回的对象丢失为 xts 对象......

```
> xtsData_1 <- returns( xtsDataDiff )
> class(xtsData_1)
[1] "matrix"
> tail ( xtsData_1 )
           ts_58_20_B_003_003 ts_58_20_S_021_005 ts_58_20_S_034_013 ts_58_20_S_042_021
2013-03-05       0.0000000000       -0.000099995        0.000099995        0.000000000
2013-03-06      -0.0337266853        0.000099995        0.000000000        0.000000000
2013-03-07      -0.0005588228        0.000000000        0.000000000       -0.000099995
2013-03-08       0.0228280749        0.037722934        0.054169546        0.062774267
2013-03-11       0.0000000000       -0.000099995        0.000099995        0.000000000
2013-03-12      -0.0206362804       -0.046315423        0.000000000        0.000000000 
```

当我尝试将数据集重新建立为 xts 对象时，出现错误。

所以我的问题是……如何将矩阵的数据重新建立为 xts 对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:33:47.230

一个想法是将矩阵再次转换为`xts`对象。使用`as.xts`或`xts`构造函数例如：

```
 xts(xtsData_1,as.POSIXct(rownames(xtsData_1))) 
```

# html - HTML 表格边框现在显示在 asp.net mvc 3 视图中

> ID：16214411
> 
> 赞同：0
> 
> 时间：2013-04-25T12:12:28.530
> 
> 标签：html, css, asp.net-mvc-3

所以这是我为解决这个问题所做的不同尝试的几个打印屏幕说明的问题。所有这些都发生在 ASP.NET MVC 3 视图中。

我这样创建我的表：

```
<div id="drawForm">
    <table id="drawTemplate" style="border:1px solid lightgrey;border-collapse: collapse">
        @for (var i = 0; i < Model.Count; i++)
        {
            if (Model[i].Columns.Count > 0)
            {
                <tr>
                    @for (var j = 0; j < Model[i].Columns.Count; j++)
                    {
                        <td>
                            @Html.HiddenFor(x => x[i].Columns[j].RowNumber)
                            @Html.HiddenFor(x => x[i].Columns[j].ColumnNumber)
                            @Html.DisplayFor(x => x[i].Columns[j].QuestionText)
                            @Html.EditorFor(x => x[i].Columns[j].FieldValue)
                        </td>
                    }
                </tr>
            }
        }
    </table>
  </div> 
```

注意表格的样式，当边框设置为 1px 我得到这个：

![一个像素表边框](https://i.stack.imgur.com/EcJCS.png)

在对该主题进行了一些搜索后，我找到了某种解决方案，方法是保持一切不变，只需将表格边框值从 1 更改为 3px。这样做后，我得到：

![三像素表边框](https://i.stack.imgur.com/EBN30.png)

现在我可以看到所有的边框，我将边框的颜色设置为红色只是为了更清楚我的意思，事实上我可以将它设置为`lightgray`它几乎可以接受，但是一个 - 这似乎是某种黑客这样做，而且 - 不要看到不允许正常渲染表格的异常情况，当然 - 我真的很想有一个正常的表格布局，而不是被迫改变边框宽度正因为如此。

我对两个示例都使用了一些相同的样式，所以我把它留到最后：

```
#drawForm 
{
    margin: 0 auto;
    width: 690px;
    height: 800px;   
    border: 1px solid black; 

}
#drawTemplate {
    width: 690px;
}
tr 
{
    height: 50px;
    border: 1px solid lightgrey;
    }
td {
 border: 1px solid lightgrey;
} 
```

所以我想知道的是 - 为什么我首先会遇到这个问题，当然 - 除了这个与边框宽度有关的技巧之外，还有什么方法可以解决它？

附言

HTML 输出：

```
<table id="drawTemplate" >
                <tr>
                        <td>
                            <input name="[0].Columns[0].RowNumber" type="hidden" value="1" />
                            <input name="[0].Columns[0].ColumnNumber" type="hidden" value="1" />
                            alabala
                            <input class="text-box single-line" name="[0].Columns[0].FieldValue" type="text" value="" />
                        </td>
                        <td>
                            <input name="[0].Columns[1].RowNumber" type="hidden" value="1" />
                            <input name="[0].Columns[1].ColumnNumber" type="hidden" value="2" />

                            <input class="text-box single-line" name="[0].Columns[1].FieldValue" type="text" value="yes" />
                        </td>
                </tr>
                <tr>
                        <td>
                            <input name="[1].Columns[0].RowNumber" type="hidden" value="2" />
                            <input name="[1].Columns[0].ColumnNumber" type="hidden" value="1" />
                            alabala
                            <input class="text-box single-line" name="[1].Columns[0].FieldValue" type="text" value="yes" />
                        </td>
                </tr>
                <tr>
                        <td>
                            <input name="[2].Columns[0].RowNumber" type="hidden" value="3" />
                            <input name="[2].Columns[0].ColumnNumber" type="hidden" value="1" />
                            alabala
                            <input class="text-box single-line" name="[2].Columns[0].FieldValue" type="text" value="yes" />
                        </td>
                </tr>
                <tr>
                        <td>
                            <input name="[3].Columns[0].RowNumber" type="hidden" value="4" />
                            <input name="[3].Columns[0].ColumnNumber" type="hidden" value="1" />
                            alabala
                            <input class="text-box single-line" name="[3].Columns[0].FieldValue" type="text" value="no" />
                        </td>
                        <td>
                            <input name="[3].Columns[1].RowNumber" type="hidden" value="4" />
                            <input name="[3].Columns[1].ColumnNumber" type="hidden" value="2" />
                            alabala
                            <input class="text-box single-line" name="[3].Columns[1].FieldValue" type="text" value="no" />
                        </td>
                        <td>
                            <input name="[3].Columns[2].RowNumber" type="hidden" value="4" />
                            <input name="[3].Columns[2].ColumnNumber" type="hidden" value="3" />
                            alabala
                            <input class="text-box single-line" name="[3].Columns[2].FieldValue" type="text" value="no" />
                        </td>
                </tr>
                <tr>
                        <td>
                            <input name="[4].Columns[0].RowNumber" type="hidden" value="5" />
                            <input name="[4].Columns[0].ColumnNumber" type="hidden" value="1" />
                            alabala
                            <input class="text-box single-line" name="[4].Columns[0].FieldValue" type="text" value="no" />
                        </td>
                        <td>
                            <input name="[4].Columns[1].RowNumber" type="hidden" value="5" />
                            <input name="[4].Columns[1].ColumnNumber" type="hidden" value="2" />

                            <input class="text-box single-line" name="[4].Columns[1].FieldValue" type="text" value="no" />
                        </td>
                </tr>
                <tr>
                        <td>
                            <input name="[5].Columns[0].RowNumber" type="hidden" value="6" />
                            <input name="[5].Columns[0].ColumnNumber" type="hidden" value="1" />
                            alabala
                            <input class="text-box single-line" name="[5].Columns[0].FieldValue" type="text" value="" />
                        </td>
                </tr>
                <tr>
                        <td>
                            <input name="[6].Columns[0].RowNumber" type="hidden" value="7" />
                            <input name="[6].Columns[0].ColumnNumber" type="hidden" value="1" />
                            alabala
                            <input class="text-box single-line" name="[6].Columns[0].FieldValue" type="text" value="no" />
                        </td>
                </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:14:50.663

尝试使用这个 CSS 声明，为你的表格元素和每个单元格获得一个边框就足够了

```
#drawForm table {
   border-collapse: collapse;
}

#drawForm table, .drawForm table td {
   border: 1px solid #aaaaaa;
} 
```

此外，您似乎会遇到这个问题，因为您正在循环遍历 tr 和 td，其中很少有 td 被遗漏，因此您需要声明`rowspan`和`colspan`

# python - Python：获取特定 XML 标记的所有内容

> ID：16214418
> 
> 赞同：0
> 
> 时间：2013-04-25T12:12:52.037
> 
> 标签：python, xml-parsing

我已经解析了一个 XML 文件，需要从所有`<name>`标签中获取所有内容。

到目前为止，我想出了这个：

```
xml_tag = dom.getElementsByTagName('person')[0].toxml()
xml_data = xml_tag.replace('<name>','').replace('</name>','') 
```

然而，这只会获得第一个标签。如何创建其中所有名称标签内容的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:24:13.840

通常我使用 lxml 来处理这些事情，但看看你的代码，这个或类似的东西应该可以工作。

```
xml_tag = dom.getElementsByTagName('person')[0]
xml_data = [elem.nodeValue for elem in dom.getElementsByTagName('name')] 
```

# jquery - Multiselect jQuery中的json来源

> ID：16214419
> 
> 赞同：6
> 
> 时间：2013-04-25T12:12:52.157
> 
> 标签：jquery, json, multi-select

我有一个多选的 jQuery，我想从 json 获取源代码。我从有效的自动完成组合框中获取了源代码，但在这里它不起作用。

我的代码：

```
 $(document).ready(function () {
        var warning = $("#message");
        $("select").multiselect({
            //selectedText: function (numChecked, numTotal, checkedItems) {
            //    return numChecked + ' of ' + numTotal + ' checked';
            //},
            source: function (request, response) {
                $.getJSON('http://' + $("[id$='ip']").val() + "/JSON/Auctocomplete.aspx?city=1&term=" + request.term, function (data) { response(data); });
            },
            select: function (event, ui) {
                $("#mfr").textContent = ui.item.id;
            },
            selectedList: 5,
            header: "choose up to 5",
            click: function (e) {
                if ($(this).multiselect("widget").find("input:checked").length > 5) {
                    warning.addClass("error").removeClass("success").html("choose up to 5");
                    return false;
                } else {
                    warning.addClass("success").removeClass("error").html("");
                }
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-28T11:19:03.087

这是因为[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。您不能使用 ajax 调用外部站点。如果你真的想使用，你必须使用[JSONP](http://en.wikipedia.org/wiki/JSONP)。或者您可以为此使用服务器端代理。意思是，在服务器端调用外部站点并对那个 web 服务进行 ajax 调用。

[有关更多信息，请参阅此链接](http://cmsnsoftware.blogspot.com/2012/02/how-to-use-cross-domain-ajax-request.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-01T08:39:26.487

我搜索了，我认为Jquery 多选没有**源属性。**看看[http://www.erichynds.com/blog/jquery-ui-multiselect-widget](http://www.erichynds.com/blog/jquery-ui-multiselect-widget)。您确定它有源属性吗？

我建议你，首先从 json 加载选择，然后将其转换为多选。

```
// The empty select element:
<select></select>

// In javascript:
$(document).ready(function () {
     var url = 'http://...';

     $.getJSON(url,function(result){
               $.each(result, function(i, field){
                      var option = $('<option value="' + field.value + '">' + field.text + '</option>');
                      $('select').append(option);
               });

               $('select').multiselect({...});
     });
}); 
```

# android - 使用 locationlistener 将当前位置发送到服务器

> ID：16214420
> 
> 赞同：1
> 
> 时间：2013-04-25T12:12:54.720
> 
> 标签：android, nullpointerexception, locationlistener, networkonmainthread

我在一个 android 应用程序中有一个服务，它实现 locationListener 以跟踪用户更改位置。

每次更改位置时，我都想将其发送到服务器。

因此，在 onLocationChanged 方法中，我正在获取纬度和经度。我想通过网络将它们发送到服务器。因此，我创建了一个新线程（因为主线程上不允许网络操作）。但是，我得到了这个线程的 java.lang.NullPointerException。

我应该怎么办？

这是我的代码......

```
 public class SService extends Service implements LocationListener{

public class LocalBinder extends Binder {
    SplashService getService() {
        return SplashService.this;
    }
}

@Override
public void onCreate() {
    super.onCreate();
    mNM = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);

    //Shows notification
    showNotification();
  }

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Log.i("SService", "Received start id " + startId + ": " + intent);

     // Sets parameters and location providers
    setLocationParam();

    return START_STICKY;
}

@Override
public void onDestroy() {
    super.onDestroy();
    // Cancel the persistent notification.
    mNM.cancel(NOTIFICATION);
}

@Override
public IBinder onBind(Intent intent) {
    return mBinder;
}

// This is the object that receives interactions from clients.  See
// RemoteService for a more complete example.
private final IBinder mBinder = new LocalBinder();

@Override
public void onLocationChanged(Location location) {

    // Getting latitude of the current location
    latitude = location.getLatitude();

    // Getting longitude of the current location
    longitude = location.getLongitude();        

    Log.v("SSERVICE",latitude+"    "+longitude);

    final SMessage sm=new SMessage("0", latitude, longitude,"");

            // Creates new thread
    new SThread(sm).start();    

}

@Override
public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}

@Override
public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

} 
```

}

# plone - Plone：内容规则操作中的电子邮件内容

> ID：16214421
> 
> 赞同：1
> 
> 时间：2013-04-25T12:12:57.747
> 
> 标签：plone

我有一个配置了 PloneFormGen 的 Plone 站点。我正在使用 save-data-to-content 适配器为每个提交创建一个页面，标题/id 具有唯一编号。我设置了内容规则，以便在提交的表单沿工作流程转换时通知各种角色。

有没有办法将提交的内容包含在这些电子邮件中？我知道 PloneFormGen 可以在提交时在初始电子邮件中发送表单的内容，但我需要稍后发送相同的信息。我很擅长解决问题，但我不是 Plone 专家，因此将不胜感激。

附加信息：我正在使用 uwosh.pfg.d2c 适配器执行 PFG -> Contenttype 转换，效果很好。在 uwosh.pfg.d2c 插件的设置中，内容类型设置为“页面”。然后，内容规则将根据结果内容的状态转换向各种组或角色发送电子邮件，这以正常方式工作 - 当发生转换时，规则执行。

实际上，我们拥有的是当用户单击提交时表单正在生成的页面。这是通过 PloneFormGen 中的插件完成的。这可能会提供一些额外的信息： http: [//pythonhosted.org/uwosh.pfg.d2c/](http://pythonhosted.org/uwosh.pfg.d2c/) - 诚然，我不是一个开发人员。

理想情况下，审阅者会在提交表单时获得所创建页面的正文：这是通过内容规则完成的，即当页面添加到文件夹时，它会发送电子邮件。当 PloneFormGen 中的插件创建页面时，页面被添加到文件夹中。

当我们拥有这些页面时，其他用户可以进来查看和更改它们的状态 - 就像您在 Plone 中的任何其他页面一样。PloneFormGen 转换为页面后应该不再使用。希望有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T15:43:13.050

坏消息是这需要编程。好消息是它不会花太多时间。解决问题有两种合理的方法：

1.  让您的内容规则操作运行处理邮件本身的脚本。您可以使用站点的邮件主机发送脚本邮件；或者，

2.  在 Python 包中（无法通过 web 脚本执行此操作），为上下文的文本属性提供一个实现 plone.stringinterp.interfaces.IStringSubstitution 的命名适配器。这会给你一个 $ 替代身体。这可能需要不到 10 行的总代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T06:37:11.423

您可能想看一下collective.contentrules.mailtogroup，最新版本能够将正文文本作为邮件发送（使用'$ {text}'-变量），触发一个方便的内容规则-事件，在您的情况下为“添加对象”。

您可以将您的角色分配给一个组并将其用于您的案例。

# c++ - 指向具有与非类型模板参数的外部链接的对象的指针

> ID：16214422
> 
> 赞同：1
> 
> 时间：2013-04-25T12:12:57.903
> 
> 标签：c++, templates

我尝试了以下代码。

```
template <int VAL>
void printVAL()
{
    for(int i=0;i<VAL; i++){
        cout << " i value is "<<i<<endl;
    }
} 
```

实例化：printVAL<100>()

当我使用（**std::string s**）作为非类型模板参数时，编译器向我大喊以下错误

```
"class std::basic_str<char>' is not a valid type for a template non-type parameter. 
```

我所知道的是我们应该只使用恒定的整数值。连双倍都没有。

**问题：**

1) 为什么我们不应该使用 std::string，有什么困扰？

2）“可以使用指向具有外部链接的对象的指针”是什么意思。我可以得到它的任何示例代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:18:19.730

您只能将整数值作为非类型模板参数传递。这是语言的限制。您可能需要以下内容：

```
template<class T>
void printVAL(const T& t)
{
    for (auto& x : t) {
        cout << " x value is "<< x << '\n';
    }
} 
```

这将打印任何内容：容器、字符串、数组等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:15:24.317

有两种类型的模板：泛型模板和指定类型的模板。

像这样的泛型类型的模板

```
template<typename T> 
```

或者

```
template<class T> 
```

这些模板几乎可以用于任何类型。这些类型的实际使用可能会限制可以使用的实际类型。

具有指定类型的模板就像您在问题中遇到的那样：

```
template<int VAL> 
```

它们只能与匹配指定类型的模板参数一起使用。在这种情况下，只能使用整数文字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:39:15.177

> 1) 为什么我们不应该使用 std::string，有什么困扰？

编译器必须能够在编译时推断和替换模板参数。这不能用一个`std::string`对象来完成，它可以（并且通常会）在运行时改变。

另请参阅[此问答](https://stackoverflow.com/questions/5687540/non-type-template-parameters)。

> 2）“可以使用指向具有外部链接的对象的指针”是什么意思。我可以得到它的任何示例代码吗？

那是因为具有静态存储持续时间的对象的地址（声明的对象`extern`是）是一个常量表达式。

n3337 5.19/3，强调我的：

> 文字常量表达式是文字类型的纯右值核心常量表达式，但不是指针类型。整型常量表达式是整型或无范围枚举类型的字面常量表达式。[注意：这样的表达式可以用作数组边界（8.3.4，5.3.4），位域长度（9.6），如果基础类型不固定（7.2），作为枚举器初始化器，作为空指针常量(4.10) 和对齐 (7.6.2)。—尾注] T 类型的已转换常量表达式是字面常量表达式，隐式转换为 T 类型，其中在字面常量表达式中允许隐式转换（如果有），并且隐式转换序列仅包含用户定义的转换，左值到右值转换 (4.1)、整数提升 (4.5) 和整数转换 (4\. 7) 除了缩小转换 (8.5.4)。[ 注意：这样的表达式可以用作 case 表达式 (6.4.2)，如果底层类型是固定的 (7.2)，则可以用作枚举器初始化器，也可以用作整数或枚举非类型模板参数 (14.3)。—尾注] 引用常量表达式是一个左值核心常量表达式，它指定具有静态存储持续时间的对象或函数。**地址常量表达式是指针类型的纯右值核心常量表达式，其计算结果为具有静态存储持续时间的对象**的地址、函数的地址、空指针值或 std 类型的纯右值核心常量表达式： :nullptr_t。字面常量表达式、引用常量表达式和地址常量表达式统称为常量表达式。

您要求的示例：

```
#include <iostream>
#include <string>

extern std::string str; // not really neccesary

std::string str;

template<std::string* ptr>
struct S {
    S() { std::cout << ptr->length() << '\n'; }
    ~S() { std::cout << *ptr; }
};

int main()
{
    S<&str> s;
    str = "Hello world!";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:25:23.593

根据 14.1/4，

> 非类型模板参数应具有以下类型之一（可选 cv 限定）：
> 
> *   整数或枚举类型，
> *   指向对象的指针或指向函数的指针，
> *   对对象的左值引用或对函数的左值引用，
> *   指向成员的指针，
> *   `std::nullptr_t`.

你`std::string`的不是这些。

# scala - Play Framework 2.1 中的 AbsoluteURI 支持

> ID：16214432
> 
> 赞同：13
> 
> 时间：2013-04-25T12:13:20.157
> 
> 标签：scala, playframework, routes, playframework-2.1

如此处所述：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec5.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html)

> 为了允许在 HTTP 的未来版本中的所有请求中转换为 absoluteURI，所有 HTTP/1.1 服务器必须在请求中接受 absoluteURI 形式，即使 HTTP/1.1 客户端只会在对代理的请求中生成它们。

我有客户端将 POST 请求发送到我的 play-2.1.1 服务器。他是这样发送的：

```
POST http://172.16.1.227:9000/A8%3aF9%3a4B%3a20%3a89%3a40/1089820966/ HTTP/1.1
Content-Length: 473
Content-Type: application/json
Date: Thu, 25 Apr 2013 15:44:43 GMT
Host: 172.16.1.227:9000
User-Agent: my-client

...some data... 
```

所有请求都因“找不到操作”错误而被拒绝。我使用 curl 发送的相同请求很好，它们之间的唯一区别是 curl 使用相对 URI 发送它：

```
POST /A8%3aF9%3a4B%3a20%3a89%3a40/1089820966/ HTTP/1.1
Accept: */*
Content-Length: 593
Content-Type: application/json
Host: 172.16.1.227:9000
User-Agent: curl/7.30.0 
```

我在 Global.scala 中创建了以下简单的解决方法：

```
override def onRouteRequest(request: RequestHeader): Option[Handler] = {
  if (request.path.startsWith("http://")) {
    super.onRouteRequest(request.copy(
      path = request.path.replace("http://"+request.host, "")
    ))
  } else super.onRouteRequest(request)
} 
```

通过这种解决方法，我客户的所有请求都得到了正确处理。

那么，有没有更直接的方法可以在 Play Framework 中做到这一点，或者那是唯一的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-01T10:57:33.307

感谢[@nraychaudhuri](https://github.com/nraychaudhuri) Play 2.2 支持`absoluteURI`-style 请求标头。

这是问题和拉取请求：[https ://github.com/playframework/playframework/pull/1060](https://github.com/playframework/playframework/pull/1060)

# django - 对数据库（PostgreSQL）进行分区时，如何从 Django（1.5 版）管理员添加记录？

> ID：16214434
> 
> 赞同：2
> 
> 时间：2013-04-25T12:13:24.460
> 
> 标签：django, postgresql

我想知道当数据库（PostgreSQL）已分区时，是否可以从 Django（1.5 版）管理员向数据库添加新记录？

更具体地说，在我的数据库中，我已经（通过使用触发器）将一个名为的表`Category`分区为两个名为`category_01`和的分区`category_02`。

完成对表的分区后，我尝试将新记录插入其中，但不断收到以下错误：

`'NoneType' object has no attribute '__getitem__'`.

有人知道如何解决这个问题吗？我也尝试将自定义`save()`方法添加到模型中，但无济于事。可能是这里最简单的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T10:46:14.763

After 2 days of research, I was finally able to solve this issue on my own. My solution was to override the `save(..)` method in my model like so:

```
def save(self, *args, **kwargs):
   #custom save method
   #pdb.set_trace()
   from django.db import connection
   connection.features.can_return_id_from_insert = False
   print "save"

   super(your model name here, self).save(*args, **kwargs) 
```

Thanks for the Django docs and PostgreSQL docs, [https://groups.google.com/forum/?fromgroups=#!topic/django-users/-AT4PLOmWAE](https://groups.google.com/forum/?fromgroups=#!topic/django-users/-AT4PLOmWAE) and [https://code.djangoproject.com/ticket/10467](https://code.djangoproject.com/ticket/10467) for helping me solve the issue!

# abap - 如何使用我的自定义对象查找传输请求？

> ID：16214435
> 
> 赞同：2
> 
> 时间：2013-04-25T12:13:25.283
> 
> 标签：abap, transport, sap-basis, function-module

我复制了两个功能模块`QM06_SEND_PAPER_STEP2`和`QM06_FM_TASK_CLAIM_SEND_PAPER`类似的 Z* 功能模块。我已将这些 FM 放入`ZQM06`另一个开发人员创建的功能组中。

我想使用 Transaction`SCC1`将我的开发从一个客户转移到另一个客户。在事务`SE01`传输管理器中，我在任何地方都找不到我的 2 个功能模块的名称。

我怎样才能找到我的工作的变更请求？

我复制了 FM 以修改功能，并且我知道 FM 是独立于客户端的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T13:03:02.110

与其他 ABAP 工作台实体一样，功能模块是独立于客户端的。也就是说，您不需要在同一实例上的客户端之间复制它们。

`Utilities -> Versions -> Version Management`但是，您可以通过转到事务 SE37，输入功能模块的名称，然后从菜单中选择来找到包含更改的传输请求。

如果您没有将更改放入本地包（`$TMP`如会根据该请求为您的用户创建一个新任务，其中包含您的更改。要检查包，请使用`Goto -> Object Directory Entry`SE37 中的菜单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T01:08:46.037

功能模块通常以功能组名称添加到传输中，特别是如果它们是新的。

找到dhte传输最简单的方法是去SE37，显示功能模块，然后去版本管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T19:59:09.253

mydoghasworms 的答案是正确的。或者，您也可以使用事务 SE03 -> 在请求/任务中搜索对象（事务屏幕顶部）-> 选中“R3TR FUGR”旁边的框并输入您的功能组名称。

# iphone - 像 Retina 4 一样显示的 Retina 3.5 视图

> ID：16214436
> 
> 赞同：0
> 
> 时间：2013-04-25T12:13:25.877
> 
> 标签：iphone, ios, xcode, user-interface

我想要一个仅适用于 Retina 3.5 的 iPhone 应用程序。对于我的一个观点，我将大小设置为“Retina 3.5 Fill Screen”。我在这个视图中添加了一个工具栏。但是，当我在 iPhone 5 上运行该应用程序时，视图显示为全屏（就像在 Retina 4 上一样），并且工具栏位于视图中间的某个位置。这是我在 XCode 中的设置： ![在此处输入图像描述](https://i.stack.imgur.com/4i3pz.png)

这是我的 iPhone 5 的截图： ![在此处输入图像描述](https://i.stack.imgur.com/sLLl8.png)

有没有想过如何确保视图在 iPhone 5 上显示为 Retina 3.5？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:20:36.883

你有什么特别的理由不希望它在 4 英寸显示器上工作吗？对于 iPhone 5 用户（至少对我而言）来说，拥有一个不是为更大显示屏而构建的应用程序是有史以来最烦人的事情。这些用户为拥有更多屏幕空间而付费，而不为他们制作应用程序并没有利用这些额外的屏幕空间。此外，苹果使自动布局更加通用。这意味着将来会有更多的屏幕尺寸出现，因此迟早您将不得不学习如何使用自动布局使应用程序正常运行。

# php - 完全匹配的简单关键字搜索

> ID：16214438
> 
> 赞同：0
> 
> 时间：2013-04-25T12:13:28.720
> 
> 标签：php

我需要简单的关键字搜索。

我有与它们相关联的一组关键字的对象。我需要可靠搜索这些关键字的方法。

在搜索了一组关键字后，搜索库应该返回与这些关键字关联的对象的 id。另外我需要知道是否有完全匹配（所有搜索的关键字都以单个集合[与对象关联]的形式呈现）。

我想避免使用多个 OR 运算符构建查询。

你能指点我一些图书馆或教程如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:34:24.400

因为我只看到一个 php 标签，所以我认为不涉及任何数据库。但它是您所说的对象列表。

我不太清楚你在没有数据库时构建查询是什么意思，但问题有点不清楚。

我假设这是您正在谈论的对象的类：

```
class SomeObject
{

    private $id;
    private $keywords = array();

    public function getId()
    {
        return $this->id;
    }
  public function getKeywords()
    {
        return $this->keywords;
    }

} 
```

那么这将是解决方案：

```
function filterObjectArray($objectArray, $search)
{
    $resultIds = array();
    $resultObjects = array();
    foreach ($objectArray as $object)
    {
        foreach ($object->getKeywords() as $keyword)
        {
            if ($search == $keyword)
            {
                $resultIds[] = $object->getId();
                $resultObjects[] = $object;
                break;
            }
        }
    }

    return $resultObjects;
    // or you could do return $resultIds; But i think returning the objects is a nicer solution.
} 
```

现在让我们假设它是与下表相关的数据库：

```
someobject
 \ id
 \ name 
 \ etc

keywords
 \ id
 \ keyword
 \ someobjectid 
```

那么它只是：

```
 select 
id 
from someobject o 
where 
exists (select 1 from keywords k where k.keyword = 'thekeywordiamlookingfor' and k.objectid = someobject.id) 
```

# php - 我正在尝试发布 使用 jquery $.post() 将内容写入数据库

> ID：16214439
> 
> 赞同：0
> 
> 时间：2013-04-25T12:13:29.173
> 
> 标签：php, jquery, mysql

我想使用 jquery $.post() 方法将数据添加到表中..但它没有更新。HTML：这是 html 代码

```
 <div id="ant-container" name="text" style="border:1px solid #CCCCCC;height:300px;width:80%;">
    <?php if (isset($_POST['submit'])&& $_POST['text'] ==''){
    echo parseWord($myFile);
    }elseif (isset($_POST['text'])) { echo $_POST['text'];}
    </div> 
```

jquery：这个 jquery 代码

```
 var div_contents = $('#ant-container').html();
    var ides = $('#id').val();
    $.post("content.php", { contents:div_contents, id :ides}); 
```

在这个我得到“ide”和“div_contents”PHP：这是我的php代码（content.php）

```
$div = mysql_real_escape_string($_POST['contents']); 
$id = mysql_real_escape_string($_POST['id']); 
$sql ="UPDATE `antr_essay` SET `annotext`=      {$div},`grade`='$_POST[grade]',`comments`='$_POST[comments]'
WHERE id=$id";
$update=$DB->update($sql);
$sql ="UPDATE `antr_essay` 
   SET `annotext`={$div},
   `grade`='$_POST[grade]',
    `comments`='$_POST[comments]'
        WHERE id=$id";
   $update=$DB->update($sql);
      //var_dump($sql);exit;
if (isset($update)){
  echo  '<div align="center" class="alert alert-success">';
  echo "Annotation added Successfully";
  echo '</div>';
}
header("loction:annotate.php"); 
```

我提交后没有重定向到 content.php 并且表没有更新。我能做什么请帮助我

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:16:10.680

Please check the spelling of location you have given in header().

Change

```
header("loction:annotate.php"); 
```

To

```
header("location:annotate.php"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:16:49.033

Try this, using [serializeArray()](http://api.jquery.com/serializeArray/):

```
var div = $("#ant-container").serializeArray();
$.post("content.php", div ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:17:04.423

Try to put that div into another div and try like this

```
 <div id="my_div"><div id="ant-container" name="text" style="border:1px solid #CCCCCC;height:300px;width:80%;"></div></div> 
```

Then get the content of "my_div" as

```
var div_contents = $('#my_div').html();
var ides = $('#id').val();
$.post("content.php", { contents:div_contents, id :ides}); 
```

and try to correct the spelling of **location**

```
header("location:annotate.php"); 
```

Better to use **ajax** like

```
$.ajax({
           type: "POST",
           url: "content.php", 
           data : { 'contents':div_contents, 'id' :ides},
           success: function(result) 
           {     
                alert(result);
           }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:25:48.530

在我看来你有一些 sql 错误：

```
$sql ="UPDATE `antr_essay` SET `annotext`=      {$div},`grade`='$_POST[grade]',`comments`='$_POST[comments]' -> like below .
WHERE id=$id";
$update=$DB->update($sql);
$sql ="UPDATE `antr_essay` 
   SET `annotext`={$div}, -> **this line why not SET `annotext`='{div}'** ?
   `grade`='$_POST[grade]',
    `comments`='$_POST[comments]'
        WHERE id=$id";
   $update=$DB->update($sql); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T12:36:36.823

以下是我将如何解决此问题：

1) 使用您可以运行的测试查询创建 AJAX 调用的页面版本，以确保该部分正在执行您期望的操作。建议仅通过浏览器访问此页面，而不是 AJAX，直到您知道它可以工作。正如其他人所说，它可能只是失败了，因为您试图在回显、SQL 错误或拼写错误等之后发送 php 标头。

2) 制作另一个测试页面，只提供您期望 AJAX 处理的响应。建议只是让 DIV 内容发布并回显。

一旦你让这两个按预期工作，你只需要将它们结合起来。逐步进行，如果它在某个时候失败，您将对原因有更好的了解。

最后，您似乎没有任何处理 SQL 错误的工具 - 建议您添加一些工具，这样您就会知道这是否是原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-25T13:07:12.083

用于`<script src = "http://code.jquery.com/jquery-1.9.1.js"></script>`连接到 jquery 并在下面尝试

```
<script type="text/javascript">
    $(document).ready(function () {
    var div_contents = $('#ant-container').html();
        var ides = $('#id').val();
        $.post("content.php", { contents:div_contents, id :ides});
    });
</script> 
```

# c# - 随机选择同名的 XML 节点

> ID：16214441
> 
> 赞同：1
> 
> 时间：2013-04-25T12:13:34.657
> 
> 标签：c#, xml, random

我有这个 XML 文件：

```
<Main>
<QA>
    <question>What is your favorite color?</question>
    <!--pick random!-->
    <answer>Blue</answer>
    <answer>Red</answer>
    <answer>Green</answer>
    <answer>Yellow</answer>
</QA>

<QA>
    <question>What is your favorite programming language?</question>
    <!--pick random!-->
    <answer>PHP</answer>
    <answer>C#</answer>
    <answer>Java</answer>
    <answer>VB.Net</answer>
</QA> 
```

我希望当用户输入上述 xml 文件中指定的问题之一时，程序从节点中选择一个随机答案。例如，当用户输入“您最喜欢的编程语言是什么？”时 在 TextBox 中，程序必须随机生成 PHP、C#、Java 或 VB.Net。

这是我的代码，但不正确：

```
XmlDocument xml = new XmlDocument();
xml.Load("QA.xml");

XmlNodeList xList = xml.SelectNodes("Main/QA");
foreach (XmlNode xn in xList)
{
    string Question = xn["question"].InnerText;
    if (Question == txtQuestion.Text)
    {
        XmlNodeList answerlist = xml.SelectNodes("Main/QA/answer");
        foreach (XmlNode ans in answerlist)
        {
            Console.WriteLine(ans.InnerText);
        }
    }
} 
```

输出：

蓝色 红色 绿色 黄色 PHP C# Java VB.Net

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:21:04.147

使用 Linq To Xml，

```
Random rnd = new Random();
var xDoc = XDocument.Load("QA.xml");

var question = xDoc.Descendants("QA")
                   .First(d => d.Element("question").Value == txtQ.Text);

var answer = question.Elements()
                     .Skip(rnd.Next(0, question.Elements().Count()))
                     .First().Value; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:28:59.217

尝试这个：

```
XmlDocument xml = new XmlDocument();
xml.Load("QA.xml");

XmlNodeList xList = xml.SelectNodes("Main/QA");
foreach (XmlNode xn in xList)
{
    string Question = xn["question"].InnerText;
    if (Question == txtQuestion.Text)
    {
        XmlNodeList answerlist = xn.SelectNodes("./answer");
        foreach (XmlNode ans in answerlist
            .Cast<XmlNode>()
            .OrderBy(elem => Guid.NewGuid()))
        {
            Console.WriteLine(ans.InnerText);
        }
    }
} 
```

# php - 我们应该使用什么技术来防止使用相同的 cookie 登录？

> ID：16214443
> 
> 赞同：1
> 
> 时间：2013-04-25T12:13:39.407
> 
> 标签：php, session-cookies, spam-prevention

我想在 php 中创建一个带有验证码的登录页面。用户输入用户 - 密码和验证码后，他将登录。之后，一些会话和 cookie 存储在 cookie 中。如果有人导出这些 cookie 也会话并导入到命令行浏览器，如 wget 或 elinks 并修改标题中的用户代理（并更改为与他之前登录一次的浏览器相同），他可以使用该信息登录而无需输入用户并通过然后循环 10000000 次刷新我的应用程序中的页面并在我的服务器上进行无用的进程。如何防止这种情况？我认为的一个解决方案是将其存储`$_SERVER['REQUEST_URI']`并存储在数据库中，如果一小时内点击次数超过 50 次，则为每次刷新计数一个计数器，然后我检测到它是一种攻击，是另一种防止它的解决方案吗？

**编辑：** 它适用于这个参数：`session_regenerate_id(true);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:15:43.697

To prevent this you can use

```
session_regenerate_id() 
```

function. This function can be used to regenerate/change the session ID of the current session. This might be useful if, for example, you want to refresh the session ID every 10 minutes or after changing the state of authenticity of a user associated with a session.

# android - 如何在 Android 中更新图像或在网络中保存新图像

> ID：16214446
> 
> 赞同：0
> 
> 时间：2013-04-25T12:13:45.963
> 
> 标签：android, database

我正在从服务器获取数据，它工作正常。图像成功与应用程序一起显示。但是，现在我想从相机或 SD 卡拍摄新照片并更新从网络获取的图像。在这里，图像必须保存在服务器上，并将旧的网络图像替换为从相机或 SD 卡拍摄的新照片。

我对这个技巧没有更多的想法，请你给我基本的想法。如何将当前图像更新为新图像。

# android - 如何将清单文件中的动画设置为活动

> ID：16214447
> 
> 赞同：-1
> 
> 时间：2013-04-25T12:13:47.213
> 
> 标签：android

我可以使用该`overridePendingTransition()`方法通过代码为活动设置动画。但我需要在清单文件中将动画设置为活动。我尝试使用主题，它不起作用。谁能帮我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:32:13.037

清单文件并非旨在保存动画。您的动画应该在存储可绘制代表的 xml 文件中完成。然后打电话

# c++ - 连接到 Gtk::Window signal_delete_event

> ID：16214467
> 
> 赞同：2
> 
> 时间：2013-04-25T12:14:34.673
> 
> 标签：c++, gtk, gtkmm

我想将信号连接到 window.signal_delete_event，但它失败并显示以下错误消息：

*   不匹配调用 '(sigc::bound_mem_functor0) (_GdkEventAny* const&)' OpticalInput
*   带有值的返回语句，在函数中返回 'void' [-fpermissive]
*   void 值没有被忽略，因为它应该被忽略

那是导致错误的代码行：

```
window.signal_delete_event().connect(sigc::mem_fun(this,&GUIWindow::onExitClicked)); 
```

指向的成员函数是这个：

```
void GUIWindow::onExitClicked()
{
    *state = false;
    Gtk::Main::quit();
} 
```

有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T18:21:54.540

您的方法必须与信号的签名相匹配。在 gtkmm 文档中`signal_delete_event()`，给出了以下原型：

```
bool on_my_delete_event(GdkEventAny* event) 
```

使用您的命名，该方法必须定义如下：

```
bool GUIWindow::onExitClicked(GdkEventAny* event) { ... } 
```

返回值用于指示您是否已完全处理该事件。如果您返回 true，则此事件的其他处理程序将看不到它。

# raspberry-pi - Raspberry PI 上的 Java 服务包装器

> ID：16214468
> 
> 赞同：5
> 
> 时间：2013-04-25T12:14:42.473
> 
> 标签：raspberry-pi, java-service-wrapper

我正在尝试使用 Tanuki Java Service Wrapper。我使用的硬件是带有 Raspbian wheezy 发行版的 Raspberry Pi。（见[http://www.raspberrypi.org/downloads](http://www.raspberrypi.org/downloads)）

我已经尝试过 Wrapper 32 位 armel 版本，但在阅读 libwrapper.so 时遇到问题。

> 信息 | 虚拟机 1 | 2013/04/24 20:15:34 | WrapperManager：正在初始化...
> 信息 | 虚拟机 1 | 2013/04/24 20:15:42 | WrapperManager 调试：尝试使用名称加载本机库：libwrapper.so 结果：/usr/iHome/lib/libwrapper.so：/usr/iHome/lib/libwrapper.so：无法打开共享对象文件：没有这样的文件或目录

我也尝试过 armhf 版本，因为似乎“apt-get java-7-openjdk”安装了 jdk-armhf 版本，但是在启动 Wrapper 时我确实遇到了“分段错误”。

一些额外的信息：

> pi@raspberrypi /usr/lib/jvm $ java -version
> java version "1.7.0_07" OpenJDK 运行时环境 (IcedTea7 2.3.2)
> (7u7-2.3.2a-1+rpi1)OpenJDK 零虚拟机 (build 22.0-b10, 混合模式）
> pi@raspberrypi /usr/lib/jvm $ ls -altr
> total 28 -rw-r--r-- 1 root root 2437 Sep 26 2012 .java-1.7.0-openjdk-armhf.jinfo lrwxrwxrwx
> 1 root root 20 2012 年 9 月 26 日 java-1.7.0-openjdk-armhf -> java-7-> openjdk-armhf drwxr-xr-x 3 root root 4096 Jan 17 20:59 java-7-openjdk-common
> drwxr-xr-x 5 root根 4096 1 月 17 日 21:00 java-7-openjdk-armhf
> drwxr-xr-x 4 根根 4096 1 月 17 日 21:00。
> drwxr-xr-x 74 root root 12288 Apr 24 20:32 ..
> pi@raspberrypi /usr/lib/jvm $ uname -a
> Linux raspberrypi 3.2.27+ #250 PREEMPT Thu Oct 18 19:03:02 BST 2012 armv6l GNU/Linux

提前致谢，

BR，罗伯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T01:38:28.170

这个问题已经在[这个线程](https://sourceforge.net/mailarchive/message.php?msg_id=30767505)的 Java Service Wrapper 用户邮件列表中讨论过，但这里是解决方案的摘要。

Wrapper 的 armhf 版本是在 armv7 平台上构建的，显然这与 armv6 硬浮点架构不兼容。当使用带有 armhf jvm 的包装器的 armel 版本时，由于目标不匹配，加载本机库会失败。

建议的解决方案是使用带有 armel 版本 Wrapper 的 armel jvm（因为 armv6 板应该支持两者），或者自己为他的板创建 armhf 二进制文件。对于第二个建议，必须下载、提取预发布包（来自 Wrapper 的 sourceforge 项目站点）并执行以下 shell 脚本：

```
./build32.sh release 
```

使用创建的二进制文件，Wrapper 能够成功启动。（构建过程需要安装 JDK 和 Apache-Ant）

干杯，

# r - read.table 将“T”读为 TRUE，将“F”读为 FALSE，如何避免？

> ID：16214471
> 
> 赞同：18
> 
> 时间：2013-04-25T12:14:49.927
> 
> 标签：r, read.table

我有一个包含数据的文件`c("A","T","B","F")`。

当我使用：

```
read.csv(myfile,header=F,stringsAsFactors=F) 
```

R将字符解释`T`为`TRUE`和`F``FALSE`

我做错什么了吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-25T12:19:50.337

如果你所有的列都是字符，那么试试这个：

```
# replace text = . with your filename
read.csv(text="A,B,T,T", header=FALSE, stringsAsFactors=FALSE, 
            colClasses = c("character")) 
```

否则，您必须将每列的类型传递`colClasses`为：`colClasses = c("numeric", "numeric", "character", ...)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-05T10:47:41.067

我遇到了类似的问题，这是解决方案：

```
#dummy data
df <- read.csv(text="
A,B,T,T,F
T,T,F,T,text1
A,T,NA,F,T",
               header=FALSE, stringsAsFactors=FALSE)
#data
df
#   V1 V2    V3    V4    V5
# 1  A  B  TRUE  TRUE     F
# 2  T  T FALSE  TRUE text1
# 3  A  T    NA FALSE     T

#convert logical columns to single letters
df[,sapply(df,class) == "logical"] <-
  sapply(df[,sapply(df,class) == "logical"],
         function(i) substr(as.character(i),1,1))

#result
df
#   V1 V2   V3 V4    V5
# 1  A  B    T  T     F
# 2  T  T    F  T text1
# 3  A  T <NA>  F     T 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-10T23:59:38.053

如果您不想更改所有列的类，revalue 也可以，但更适合对一列进行简单更改。

```
df$V3 <- as.factor(revalue(df$V3, c("TRUE" = "T", "FALSE" = "F"))) 
```

# list - scala中的侦听器模式上的NullPointerException

> ID：16214475
> 
> 赞同：1
> 
> 时间：2013-04-25T12:14:52.117
> 
> 标签：list, class, scala, nullpointerexception

我正在尝试创建这样的侦听器设计模式：

```
abstract class Listener(g: Engine) {
  g.addListener(this)
}
class Listener1(g: Engine) extends Listener(g)
class Listener2(g: Engine) extends Listener(g)

class Engine {
  val listener1 = new Listener1(this)
  val listener2 = new Listener2(this)  

  var listeners: List[Listener] = Nil
  def addListener(g: Listener) = {
    listeners = g::listeners
  }
} 
```

但是如果失败并带有`NullPointerException`, 因为`listeners`最初等于创建`null`时间`listener1`和`listener2`创建时间。

我该如何克服这个问题？

**编辑：**我尝试了以下方法：

```
 def addListener(g: Listener) = {
    if(listeners == null) {
      listeners = List(g)
    } else {
      listeners = g::listeners
    }
  } 
```

但问题是类初始化后，listeners = Nil。我需要一个更好的设计模式来实现我的目标。

**解决方案：**不使用惰性 val 或可变集合：

```
var listeners: List[Listener] = _
def addListener(g: Listener) = {
  if(listeners == null) 
    listeners = List(g)
  else
    listeners = g::listeners
} 
```

使用`_`for 初始化而不是 'null' 或 'Nil' 使编译器在创建`listeners`之后不会覆盖。`listener1``listener2`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:20:57.700

借助[惰性值](https://stackoverflow.com/questions/7484928/what-does-a-lazy-val-do)和[可变集合](http://docs.scala-lang.org/overviews/collections/overview.html)：

```
class Engine {
  val listener1 = new Listener1(this)
  val listener2 = new Listener2(this)  

  lazy val listeners = collection.mutable.ListBuffer.empty[Listener]
  def addListener(g: Listener) {
    listeners += g
  }
} 
```

如果您在某个地方急需不可变列表，只需使用调用位置`.toList`中的方法将缓冲区转换为它。

# java - 将元素添加到 JList

> ID：16214480
> 
> 赞同：7
> 
> 时间：2013-04-25T12:15:15.447
> 
> 标签：java, swing, jlist, defaultlistmodel

我有一个包含客户名称的对象数组，如下所示：`Customers[]`

按下按钮后，如何自动将这些元素添加到现有的 JList 中？我尝试过这样的事情：

```
for (int i=0;i<Customers.length;i++)
{
    jList1.add(Customers[i].getName());
} 
```

但我总是犯错误。我该如何解决？我正在研究 NetBeans。 **出现的错误是“为 add(String) 找到不合适**的方法。顺便说一下，我的方法 getName 正在返回字符串中的客户姓名。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-25T12:22:50.350

`add`您使用的方法就是方法`Container#add`，所以肯定不是您需要的。你需要改变`ListModel`，例如

```
DefaultListModel<String> model = new DefaultListModel<>();
JList<String> list = new JList<>( model );

for ( int i = 0; i < customers.length; i++ ){
  model.addElement( customers[i].getName() );
} 
```

编辑：

我调整了代码片段以将名称直接添加到模型中。这避免了对自定义渲染器的需要

# assembly - 存储指令中的数据对齐

> ID：16214481
> 
> 赞同：1
> 
> 时间：2013-04-25T12:15:21.717
> 
> 标签：assembly, arm

在 ARM 汇编中，我有跨寄存器的数据`r3 - r9`。`stm`我想使用从我拥有的地址开始的指令将它们存储回内存`r0`

指令`stm r0,{r3-r9}`会将来自寄存器的数据彼此相邻放置。但我想要的是在存储的值之间有一个 16 字节的间隙，例如执行以下操作：

```
str r3,[r0]
str r4,[r0,#16]
str r5,[r0,#32]
str r6,[r0,#48] 
... 
```

这可以通过`stm`指令实现还是有一些捷径？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T12:45:06.987

STM 指令[允许您指定目标地址应该向下还是向上增长](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0231b/Cacdibae.html)，但不能指定步幅应该是多少（它将是寄存器的大小，即一个字）。因此，您可能不得不使用一些替代解决方案，例如您自己建议的解决方案。

例如：

```
str r3,[r0]
str r4,[r0,#16]
str r5,[r0,#32]
.... 
```

或者

```
; Slightly simpler since it's obvious that the stores are spaced 16 bytes apart,
; altough it doesn't preserve the original value of r0 like the above version
str r3,[r0],#16
str r4,[r0],#16
str r5,[r0],#16
.... 
```

# c# - How to abort thread that use AcceptTcpClient() inside?

> ID：16214488
> 
> 赞同：4
> 
> 时间：2013-04-25T12:15:41.877
> 
> 标签：c#

`AcceptTcpClient()` prevents app from exit after I called `thrd.Abort()`.

How to exit application when in listening?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-25T12:39:23.657

您应该能够`AcceptTcpClient()`通过关闭来中断对的调用`TcpListener`(这将导致阻塞抛出异常`AcceptTcpClient()`。您*不*应该中止线程，这通常是一个非常糟糕的主意，除了一些非常具体的情况。

这是一个简短的例子：

```
class Program
{
    static void Main(string[] args)
    {
        var listener = new TcpListener(IPAddress.Any, 12343);
        var thread = new Thread(() => AsyncAccept(listener));
        thread.Start();
        Console.WriteLine("Press enter to stop...");
        Console.ReadLine();
        Console.WriteLine("Stopping listener...");
        listener.Stop();
        thread.Join();
    }

    private static void AsyncAccept(TcpListener listener)
    {
        listener.Start();
        Console.WriteLine("Started listener");
        try
        {
            while (true)
            {
                using (var client = listener.AcceptTcpClient())
                {
                    Console.WriteLine("Accepted client: {0}", client.Client.RemoteEndPoint);
                }
            }
        }
        catch(Exception e)
        {
            Console.WriteLine(e);
        }
        Console.WriteLine("Listener done");
    }
} 
```

上面的代码在单独的线程上启动了一个监听器，`Enter`在控制台窗口上按下会停止监听器，等待监听器线程完成，然后应用程序将正常退出，不需要线程中止！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-26T16:03:22.363

你可以：

使用 BeginAcceptTcpClient() 和 End.. 代替：请参阅：[https ://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.beginaccepttcpclient(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.beginaccepttcpclient(v=vs.110).aspx)

或者你可以：

创建一个 TcpClient 并发送您的侦听器消息：

因此（我猜你的线程中有一个循环）：

*   打破 listener.AcceptTcpClient() 正在运行的循环。（即 CancelAsync()）从外部和 Loop While (!Tread.CancellationPending);

*   创建一个 TcpClient 并向您的侦听器发送一条消息（并丢弃数据）；TcpClient 见：[https ://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient(v=vs.110).aspx)

*   现在你的线程可以继续了：client.close() 和 listener.stop()

# google-mirror-api - Playing video in the mirror API

> ID：16214493
> 
> 赞同：4
> 
> 时间：2013-04-25T12:15:46.977
> 
> 标签：google-mirror-api, google-glass

I'm a little confused about playing videos in the Mirror API

[Are there any restrictions for using HTML tags in "html" field?](https://stackoverflow.com/questions/16045816/are-there-any-restrictions-for-using-html-tags-in-html-f)...

Alain says

**Blocked HTML elements**: These elements, and their contents, are removed from html payloads. **Document headers**: head, title **Embeds**: audio, embed, object, source, video

However looking at the documentation ...

[https://developers.google.com/glass/v1/reference/timeline/insert](https://developers.google.com/glass/v1/reference/timeline/insert)

**Accepted Media MIME types**: image/* , audio/* , video/*

So ... I'm guessing that I can attach video but not embed video? Seems like a subtle distinction, so an app would have to have a main HTML card and a sub menu choice to view a video. Is this correct?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T14:28:54.760

正确的。HTML`video`元素已从插入的时间线卡片中删除，但您可以附加视频。附加到时间线卡片的视频由 Glass 上的本机播放器全屏播放。

如果您想将视频与其他丰富的内容一起包含，[捆绑](https://developers.google.com/glass/timeline#bundling_cards)是您的最佳选择。您可以通过指定 HTML 封面卡和许多具有相同`timelineItem.bundleId`.

# php - convert mime mails from the input stream to readable text

> ID：16214494
> 
> 赞同：0
> 
> 时间：2013-04-25T12:15:51.220
> 
> 标签：php, mime

Can I get any help for php mime email parser/decoder like [https://code.google.com/p/php-mime-mail-parser/](https://code.google.com/p/php-mime-mail-parser/) which does not involve any installations. I even tried Zend and decoder from phpclasses.org, but it did not help. I am unable to find how to give the input to program and take the output from as there is no tutorial for this

My aim: I need to convert mime mails from the input stream to readable text

Please help

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:39:08.610

试试这个库，我在许多应用程序中使用过，但请确保您的服务器中安装了邮件解析器扩展。

[http://codepad.org/zgUEf8lY](http://codepad.org/zgUEf8lY)

# android - How to start on current activity when user presses Home button

> ID：16214496
> 
> 赞同：0
> 
> 时间：2013-04-25T12:16:00.860
> 
> 标签：android

On my main activity I added the following `intent-filter`

```
<intent-filter>
    <action android:name="android.intent.action.MAIN" />
    <category android:name="android.intent.category.HOME" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.LAUNCHER" />
</intent-filter> 
```

So when I press the home button my main activity is showed. But I would like to the last seen activity to show, not the main one. How can it be achieved?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:24:11.520

Store each Activity in SharedPreference through onPause and then you can rectify it.

```
@Override
protected void onPause() {
    super.onPause();

    SharedPreferences prefs = getSharedPreferences("X", MODE_PRIVATE);
    Editor editor = prefs.edit();
    editor.putString("lastActivity", getClass().getName());
    editor.commit();
} 
```

In your MainActivity:

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Class<?> activityClass;

        try {
            SharedPreferences prefs = getSharedPreferences("X", MODE_PRIVATE);
            activityClass = Class.forName(
                prefs.getString("lastActivity", Activity1.class.getName()));
        } catch(ClassNotFoundException ex) {
            activityClass = Activity1.class;
        }

        startActivity(new Intent(this, activityClass));
    }
} 
```

# c# - 将 2 个数字组合成一个字节

> ID：16214497
> 
> 赞同：5
> 
> 时间：2013-04-25T12:16:02.947
> 
> 标签：c#, byte, bit, bitarray

我有两个数字（从 0 到 9），我想将它们组合成 1 个字节。数字 1 将占用位 0-3，数字 2 占用位 4-7。

示例：我有数字 3 和 4。3
= 0011 和 4 是 0100。
结果应该是 0011 0100。

如何用这些二进制值创建一个字节？

这是我目前拥有的：

```
 public Byte CombinePinDigit(int DigitA, int DigitB)
    {
        BitArray Digit1 = new BitArray(Convert.ToByte(DigitA));
        BitArray Digit2 = new BitArray(Convert.ToByte(DigitB));

        BitArray Combined = new BitArray(8);
        Combined[0] = Digit1[0];
        Combined[1] = Digit1[1];
        Combined[2] = Digit1[2];
        Combined[3] = Digit1[3];  

        Combined[4] = Digit2[0];
        Combined[5] = Digit2[1];
        Combined[6] = Digit2[2];
        Combined[7] = Digit2[3];
    } 
```

使用此代码，我有 ArgumentOutOfBoundsExceptions

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T12:18:17.143

忘记所有那些位数组的东西。

只需这样做：

```
byte result = (byte)(number1 | (number2 << 4)); 
```

并让他们回来：

```
int number1 = result & 0xF;
int number2 = (result >> 4) & 0xF; 
```

这通过使用`<<`和`>>`位移运算符起作用。

创建字节时，我们将`number2`左移 4 位（用 0 填充结果的最低 4 位），然后我们使用`|`to 或那些未移位的位`number1`。

在恢复原始数字时，我们将过程颠倒过来。我们将字节*右移*4 位，将原始字节`number2`放回原来的位置，然后我们用它`& 0xF`来屏蔽任何其他位。

这个位`number1`已经在正确的位置（因为我们从来没有移动它们）所以我们只需要屏蔽其他位，再次使用`& 0xF`.

在执行此操作之前，您应该验证数字是否在 0..9 范围内，或者（如果您不关心它们是否超出范围）您可以通过与 0xF 进行与运算将它们限制为 0..15：

```
byte result = (byte)((number1 & 0xF) | ((number2 & 0xF) << 4)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T12:18:24.567

这应该基本上可以工作：

```
byte Pack(int a, int b)
{
    return (byte)(a << 4 | b & 0xF);
}

void Unpack(byte val, out int a, out int b)
{
    a = val >> 4;
    b = val & 0xF;
} 
```

# android - problems with Request.executeMeRequestAsync(session, Request.GraphUserCallback()) function

> ID：16214499
> 
> 赞同：4
> 
> 时间：2013-04-25T12:16:07.300
> 
> 标签：android, facebook, login

I'm following the tutorial for login on an Android application using facebook.

I've had many problems with the hash keys and everything and I think I've solve them all, because my session already gets the `OPENED` state.

The problem I'm having now is that after I log in facebook, when the session is already opened, the code executes the `Request.executeMeRquestAsync()` and it never enters the `onComplete()` part... any idea?

Here is the code...

```
package com.example.firstandroidapp;

import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;

import android.app.Activity;
import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.content.pm.Signature;
import android.os.Bundle;
import android.util.Base64;
import android.util.Log;
import android.widget.TextView;

import com.facebook.Request;
import com.facebook.Response;
import com.facebook.Session;
import com.facebook.SessionState;
import com.facebook.model.GraphUser;

public class MainActivity extends Activity {
@Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // start Facebook Login
    Session.openActiveSession(this, true, new Session.StatusCallback() {

      // callback when session changes state
      @Override
      public void call(Session session, SessionState state, Exception exception) {
          try {
                PackageInfo info = getPackageManager().getPackageInfo("com.example.firstandroidapp",
                                            PackageManager.GET_SIGNATURES);
                for (Signature signature : info.signatures) {
                    MessageDigest md = MessageDigest.getInstance("SHA");
                    md.update(signature.toByteArray());
                    Log.i("Digest: ", Base64.encodeToString(md.digest(), 0));
                }
            } catch (NameNotFoundException e) {
                Log.e("Test", e.getMessage());
            } catch (NoSuchAlgorithmException e) {
                Log.e("Test", e.getMessage());
            }

          if (session.isOpened()) {

          // make request to the /me API
          Request.executeMeRequestAsync(session, new Request.GraphUserCallback() {

            // callback after Graph API response with user object
            @Override
            public void onCompleted(GraphUser user, Response response) {
              // it never gets here...
                  if (user != null) {
                TextView welcome = (TextView) findViewById(R.id.welcome);
                welcome.setText("Hello " + user.getName() + "!");
              }
            }
          });
        }
      }
    });
  }

  @Override
  public void onActivityResult(int requestCode, int resultCode, Intent data) {
      super.onActivityResult(requestCode, resultCode, data);
      Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);
  }

} 
```

Thanx very much in advance. David.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-28T07:08:52.263

我有同样的问题。

教程告诉我们修改AndroidManifest.xml。在修改中，我将下面的标签放在了错误的位置（我没有使用 Eclipse 来修改清单文件）并且阻止了回调。

```
<manifest ...>
  ...
  <application ...>
    ...
    <activity android:name="com.facebook.LoginActivity"/>
    ...
    <meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/app_id"/>
    ...
  </application>
  ...
  <uses-permission android:name="android.permission.INTERNET"/>
  ...
</manifest> 
```

尝试仔细检查您的 AndroidManifest.xml。[官方文档](https://developer.android.com/guide/topics/manifest/manifest-intro.html)会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-22T17:04:45.497

`Session.openActiveSession`如果会话已经打开，则直接返回会话。这可能是你的问题。在这种情况下可能不会调用回调。（我自己还在实施这个过程中。）

在调用它之前创建一个 SessionCallback 的实例，并且 - 如果会话直接返回 - 调用它：

```
StatusCallback cb = new StatusCallback() {/* implement */};
Session fbSession = Session.openActiveSession(this, true, cb);
if (fbSession != null) {
    cb.call(fbSession, fbSession.getState(), null);
} 
```

检查回调中的会话状态，这样您就不必两次处理不同的状态。

# c++ - 为什么每次运行时函数的地址都会改变？

> ID：16214502
> 
> 赞同：4
> 
> 时间：2013-04-25T12:16:15.280
> 
> 标签：c++, function-pointers

我正在努力将地址映射到它们的符号以进行调试（获取调用堆栈）。MS dbghelp.dll 可以从地址中分辨出符号（请参阅`SymFromAddr`，[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681323%28v=vs.85%29.aspx)）。但是，它不起作用，我想知道这怎么可能起作用，因为地址似乎随着程序的每次运行而改变：

```
#include <iostream>
void Foo() {}

int _tmain(int argc, _TCHAR* argv[])
{
    const long unsigned int addr = reinterpret_cast<long unsigned int>(&Foo);
    std::cout << "Address: " << std::hex << addr << std::endl;
    return 0;
} 
```

输出：

```
D:\dev\Sandbox\Debug>Sandbox.exe
Address: 901320
D:\dev\Sandbox\Debug>Sandbox.exe
Address: ce1320
D:\dev\Sandbox\Debug>Sandbox.exe
Address: 3a1320
D:\dev\Sandbox\Debug>Sandbox.exe
Address: 3f1320 
```

不同的程序怎么会像从堆栈跟踪中读取地址并将其映射到函数？这对我来说听起来很神奇。我在链接的文档中没有找到任何内容说我必须从地址或其他内容中减去一些内容。

据我了解，因为我们克服了实模式，所以每个进程都有一个虚拟内存空间，所以不再需要为加载地址掷骰子了。如果是 DLL，我会理解绝对地址的不确定性，但不是主要的可执行文件。

用VS2008在Win7上试过。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T12:18:39.523

[地址空间布局随机化](http://msdn.microsoft.com/en-us/library/bb384887.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T12:19:47.900

因为您的代码被编译为使用地址空间布局随机化，这使得代码不太容易受到“StackOverflows”的攻击。

如果你真的想改变它，有一个[链接器选项](http://msdn.microsoft.com/en-us/library/bb384887.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-25T12:19:58.130

有一个[安全功能可以随机化一些地址](http://en.wikipedia.org/wiki/Address_space_layout_randomization)，因此潜在的攻击者无法利用已知的固定相对位置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-25T12:46:36.450

正如其他人已经提到的那样，它是[ASLR在行动。](http://en.wikipedia.org/wiki/Address_space_layout_randomization)

看起来您需要做的是在调用[`SymLoadModuleEx()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681353%28v=vs.85%29.aspx). 是`BaseOfDll`参数。

我不知道它到底存储在故障转储中的什么位置（如果这是其他程序必须使用的东西），但是正在运行的程序可以使用[`GetModuleHandle()`](http://msdn.microsoft.com/en-us/library/ms683199%28VS.85%29.aspx)（在[此处](https://stackoverflow.com/q/4298331/968261)讨论）获取它自己的图像基地址。

您可能还想保存加载到进程中的所有 DLL 的名称和基地址，而不仅仅是 EXE 本身的名称和基地址。

# wpf - 根据当前主题更改控制模板

> ID：16214504
> 
> 赞同：4
> 
> 时间：2013-04-25T12:16:19.763
> 
> 标签：wpf, themes, controltemplate

不幸的是，我不得不`TabControl`在我的应用程序中覆盖其中一个 s 的控制模板，因为我需要对外观进行一些细微的修改，而这是其他方式无法完成的。

```
<TabControl Name="specialTabControl" Template="{StaticResource SpecialTabControlTemplate} />". 
```

在我切换操作系统的主题之前，一切看起来都很好。现在我`TabControl`看起来完全是垃圾，因为它使用了错误主题的控制模板（我的控制模板基于的主题，用 Blend 提取）。

所以我想需要找到一种方法来为`TabControl`需要根据当前 OS 主题选择的那个特殊提供 4 个控制模板（luna、aero、xp、classic）。

那么如何根据当前主题提供和应用**不同**的自定义控件模板`specialTabControl`，以便当用户切换操作系统的主题时，`specialTabControl`会切换到我为该主题提供的控件模板？

请注意，我`TabControl`在应用程序中还有其他没有覆盖控件模板的 s，并且应该始终具有该主题的标准控件模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:31:40.803

我认为您需要查看 WPF 应用程序中的主题。程序集可以包含以下几行：

[程序集：ThemeInfo（ResourceDictionaryLocation.SourceAssembly **，** ResourceDictionaryLocation.SourceAssembly）]

这意味着应用程序的系统主题位于您的程序集中（在文件夹 /themes 中）。主题名称必须符合系统主题...例如：

```
The Aero theme (Windows Vista and Windows 7): themes\Aero.NormalColor.xaml
The default Windows XP theme: themes\Luna.NormalColor.xaml
The olive green Windows XP theme: themes\Luna.Homestead.xaml
The Windows Classic theme: themes\Classic.xaml 
```

当用户更换系统皮肤时，WPF 应用程序会自动下载您的主题。相应地，您可以为每个系统主题设置控制模板。更多信息可参见：

“亚当·内森。WPF 4 释放”。第 14 章。

主题化 WPF 应用程序：http: [//blogs.infosupport.com/theming-wpf-applications/](http://blogs.infosupport.com/theming-wpf-applications/)

我希望这有帮助。

*** 编辑 ***

我发现了一个有趣的例子，其中提到了实际的变化主题：

[http://northhorizo​​n.net/2010/how-to-actually-change-the-system-theme-in-wpf/](http://northhorizon.net/2010/how-to-actually-change-the-system-theme-in-wpf/)

您可以设置显式样式，它不会响应系统中的皮肤更改：

```
<Style x:Key="ExplicitGreenButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
   <Setter Property="Background" Value="Green" />
   <Setter Property="Foreground" Value="White" />
</Style> 
```

因此，隐式样式将响应更改系统皮肤：

```
<Style x:Key="ImplicitGreenButtonStyle" TargetType="Button">
    <Setter Property="Background" Value="Green" />
    <Setter Property="Foreground" Value="White" />
</Style> 
```

此外，在示例中包含一个有用的代码**ThemeHelper**，其中一些主题功能。

*** 编辑 #2 ***

如果我理解正确，首先您需要获取系统主题名称。此操作可以通过多种方式完成。

第一个是使用库“UxTheme.dll”中的 Win32 函数，例如**GetCurrentThemeName()**：

```
[DllImport("uxtheme.dll", CharSet = CharSet.Auto)]
public static extern int GetCurrentThemeName(StringBuilder pszThemeFileName, int dwMaxNameChars, StringBuilder pszColorBuff, int dwMaxColorChars, StringBuilder pszSizeBuff, int cchMaxSizeChars);

StringBuilder stringThemeName = new StringBuilder(260);
StringBuilder stringColorName = new StringBuilder(260);
StringBuilder stringSizeName = new StringBuilder(260);

Int32 s = GetCurrentThemeName(stringThemeName, 260, stringColorName, 260, stringSizeName, 260); 
```

但是我这个功能没有正确接收到一些系统主题名称，比如“经典”。所以我尝试了不同的方法。

第二种方法是从注册表中获取主题名称。在路径**“HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Themes\LastTheme”**中包含当前系统主题。那么我们是否需要通过窗口挂钩拦截“更改系统主题事件”。

下面是一个带有几个按钮的示例，样式因系统主题而异：

添加到窗口：

```
SourceInitialized="Window_SourceInitialized" 
```

款式：

```
<Style x:Key="DefaultStyle" BasedOn="{StaticResource {x:Type Button}}" TargetType="{x:Type Button}">
    <Setter Property="Background" Value="CadetBlue" />
</Style>

<Style x:Key="LunaStyle" TargetType="{x:Type Button}">
    <Setter Property="Background" Value="Blue" />
    <Setter Property="Foreground" Value="White" />
</Style>

<Style x:Key="ClassicStyle" TargetType="{x:Type Button}">
    <Setter Property="Background" Value="Gray" />
    <Setter Property="Foreground" Value="Black" />
</Style> 
```

主网格：

```
<Grid>
    <Button Style="{StaticResource DefaultStyle}" Content="Default button" Width="100" Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" />
    <Button Name="ChangeButtonStyle" Content="Changes style" Width="100" Height="30" VerticalAlignment="Top" HorizontalAlignment="Right" />
    <TextBlock Name="CurrentTheme" FontSize="16" Text="Null" Width="150" Height="30" HorizontalAlignment="Center" VerticalAlignment="Top" />
</Grid> 
```

在代码中：

拦截“更改系统主题事件”：

```
private IntPtr hwnd;
private HwndSource hsource;

private void Window_SourceInitialized(object sender, EventArgs e)
{
    if ((hwnd = new WindowInteropHelper(this).Handle) == IntPtr.Zero)
    {
        throw new InvalidOperationException("Could not get window handle.");
    }

    hsource = HwndSource.FromHwnd(hwnd);
    hsource.AddHook(WndProc);
}

private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
{
    switch (msg)
    {
        case 0x31A:          // Define this as WM_DWMCOMPOSITIONCHANGED for Windows 7
        case 0x31E:          // Define this as WM_THEMECHANGED

        // Action on the change system theme
        GetThemeName(SubKey, Value); 

        return IntPtr.Zero;

        default:

        return IntPtr.Zero;
     }
} 
```

获取系统主题名称和设置样式：

```
public string SubKey = "Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\LastTheme";
public string Value = "ThemeFile";

private void GetThemeName(string OpenKey, string Value)
{
    RegistryKey pRegKey = Registry.CurrentUser;
    pRegKey = pRegKey.OpenSubKey(OpenKey);
    Object val = pRegKey.GetValue(Value);
    string NameThemeFile = val as string;

    if (NameThemeFile.IndexOf("Luna") != -1)
    {
        ChangeButtonStyle.Style = this.FindResource("LunaStyle") as Style;
        CurrentTheme.Text = "Luna";
    }

    if (NameThemeFile.IndexOf("Classic") != -1)
    {
        ChangeButtonStyle.Style = this.FindResource("ClassicStyle") as Style;
        CurrentTheme.Text = "Classic";
    }
} 
```

这种方法不是最好的，但会开始。

# ruby-on-rails - rspec 模拟未在 belongs_to 关联上被调用

> ID：16214505
> 
> 赞同：0
> 
> 时间：2013-04-25T12:16:20.823
> 
> 标签：ruby-on-rails, rspec, mocking

我正在尝试使用 RSpec 在 Rails 中测试我的控制器，但它没有调用我制作的模拟之一，我不知道为什么。

我的模型有一个用户类，一个游戏类，一个玩家类，分别属于一个用户和一个游戏。

我正在尝试测试这样的东西

```
player = Player.find_by_id(params[:id])
if player != nil && player.user == current_user && player.game.remove_player?(player)
  redirect_to games_url 
```

但我似乎无法模拟 remove_player？正确。我正在做的几乎是这样的：

```
@player = double("player")
Player.should_receive(:find_by_id).with(mock_player_id.to_s).and_return { @gplayer }
@player.stub(:user).and_return(@current_user)
fakeGame = double("game")
@player.stub(:game).and_return(fakeGame)
fakeGame.should_receive(:remove_player?).with(@player).and_return(true) 
```

我收到错误消息说 remove_player? 从未被调用。知道我做错了什么吗？我不能确定它是否到达了 player.user ==curent_user，但它正在调用 find_by_id 并且根本没有抱怨它，所以我想它必须到达用户检查。

编辑：@current_user 确实等于 current_user

另外，我尝试将第 3 行替换为

```
fakeUser = double("user")
@player.should_receive(:user).and_return(@current_user) 
```

它给了我错误消息：未调用用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:39:33.507

In the second line of your spec, return @player instead of @gplayer. If @gplayer isn't defined, your find_by_id will return nil in your spec, so your if condition will short circuit before it gets to remove_player.

# javascript - 完成后如何与JQuery Progressbar一起显示文本并转发到其他JSP页面？

> ID：16214506
> 
> 赞同：0
> 
> 时间：2013-04-25T12:16:21.670
> 
> 标签：javascript, jquery, jsp

我有进度条。它工作正常，但我需要显示一些文本以及进度条，当它达到 100% 时，它应该转发一个 jsp 页面。这是我的程序，增加了 10%，我想打印一些文本，例如：

*   10% -> 上传个人资料
*   20% -> 检查电子邮件 ID。
*   30% -> 生成用户 ID。
    ....
    重要的是，在达到 100% 后，它必须转发到 some.jsp。如何实现这一点。请建议。这是我的程序：

    ```
    <html>
    <head>
        <link rel="stylesheet" type="text/css" href="mystyle.css">
        <script type='text/javascript'>
           var progress = setInterval(function() {
           var $bar = $('.bar');

             if ($bar.width()==400) {
               clearInterval(progress);
               $('.progress').removeClass('active');
             } else {
               $bar.width($bar.width()+40);
             }
             $bar.text($bar.width()/4 + "%");
           }, 800);
        </script>
    </head>
    <body>
       <script src="http://code.jquery.com/jquery.js"></script>
       <script src="js/bootstrap.min.js"></script>
       <div class="container">
          <div class="progress progress-striped active">
            <div class="bar" style="width: 0%;"></div>
          </div>
       </div>
    </body>
    </html> 
    ```

    在 mystyle.css 中：

    ```
    @import url('css/bootstrap.css');

    .container {
      margin-top: 30px;
      width: 400px;
    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:27:07.973

您可以使用 Javascript 进行重定向`window.location.replace`

```
window.location.replace("http://example.com/finishedLoading"); 
```

您将必须跟踪您的进度，并据此显示消息。完成后，进行重定向。

根据您的示例：

```
<html>
<head>
<script type='text/javascript'>
  var progress = setInterval(function() {
    var $bar = $('.bar');

    if ($bar.width()==400) {
        clearInterval(progress);
        $('.progress').removeClass('active');
        window.location.replace("http://example.com/finishedLoading");
    } else {
        $bar.width($bar.width()+40);
        switch($bar.width()){
            case 40: $("#status").html("Uploading Personal Details"); break;
            case 80: $("#status").html("Checking Email ID"); break;
            case 120: $("#status").html("Generating user ID"); break;
             // other case statements...
            case 400: $("#status").html("Finished"); break;
        }
    }
    $bar.text($bar.width()/4 + "%");
  }, 800);
</script>
</head>
<body>
<script src="http://code.jquery.com/jquery.js"></script>
<script src="js/bootstrap.min.js"></script>
<div class="container">
   <div class="progress progress-striped active">
       <div class="bar" style="width: 0%;"></div>
   </div>
   <br>
   <span id="status">
</div>
</body>
</html> 
```

这里的进度直接保存在`$bar.width()`.

# r - Choosing right tool for visualization

> ID：16214511
> 
> 赞同：0
> 
> 时间：2013-04-25T12:16:32.670
> 
> 标签：r, d3.js, data-visualization

We are planing to do some visualization for our existing data its a political and news domain.
After doing my initial research I came to conclusion for using R and D3.

My requirement is the tool should be able to give dynamically, since it is web based visualization (Visualization should be able to change upon change in value)

I have following questions and need help in those.

Is there any other tool which I can use. R can be use for dynamic visuals? (My application is in php, python based solution can also be ok)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:35:45.743

然后您需要研究[如何在网页上设置基于 R 的服务](https://stackoverflow.com/questions/9174114/how-to-set-up-an-r-based-service-on-a-web-page/9174811#9174811)`Rook`，或者（更好）如何[将 R Shiny 集成到当前应用程序](https://stackoverflow.com/questions/15592144/how-to-integrate-r-shiny-into-current-application)中。`Shiny`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:39:32.917

如果您的应用程序（或某些部分）已经在 python 中，您可以使用[rpy2](http://rpy.sourceforge.net/rpy2_documentation.html)作为 和 之间的`R`桥梁`python`。

# c# - Error in MySQL syntax when adding object to objectcontext

> ID：16214512
> 
> 赞同：1
> 
> 时间：2013-04-25T12:16:36.283
> 
> 标签：c#, entity-framework-4

I seem to have trouble adding objects to tables that have a 'n to n' relationship.

Tables are defined as follows:

**Table A**

*   ID (PRIMARY)
*   ...
*   ...
*   ...

**Table B**

*   ID (PRIMARY)
*   ...
*   ...
*   ...

**Table C**

*   TableA_ID (index)
*   TableB_ID (index)

So basically Table C links Table A and B, by their IDs. Using the entity framework we now have an object TableA containing an Entity Collection of TableB entities.

However when I add an existing object of type TableB to the TableA.TableBs entity collection property, I receive an exception:

> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(SELECT\n `TableC`.`TableA`, \n ' at line 1

It seems that I'm trying to do a very normal / common thing, however I've not been successful getting this to work.

C# code:

```
var database = new DatabaseEntities();
var tableAObject = database.SingleOrDefault(e => e.ID == 1);
var tableBObject = database.SingleOrDefault(e => e.ID == 1);

tableA.TableBEntities.Add(tableBObject);
database.SaveChanges(); 
```

Apparently I'm doing something wrong, so my question is, how should I add an object to Table C?

# java - 如何用java从互联网上下载文件

> ID：16214513
> 
> 赞同：0
> 
> 时间：2013-04-25T12:16:42.887
> 
> 标签：java, download

当我想用java从互联网下载文件时遇到问题。我尝试使用这样的东西：

```
 String stringUrl = "http://imageshack.us/a/img841/7762/formd.png";
    File file = new File("");       
        try {
            URL url = new URL(stringUrl);
            FileUtils.copyURLToFile(url, file);
        } 
```

但我遇到了 I/O 异常。从互联网下载文件并将其放入“文件”对象的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:25:30.157

那是因为你没有给文件起名字，写一个没有名字的文件是没有意义的。

```
File file = new File(""); 
```

如果您将该行替换为以下内容：

```
File file = new File("x.png"); 
```

......那么它应该工作。

# ubuntu - 安装 MariaDB - 未满足的依赖项，mariadb-server-5.5

> ID：16214517
> 
> 赞同：29
> 
> 时间：2013-04-25T12:16:49.280
> 
> 标签：ubuntu, apt-get, mariadb

我正在尝试在 Ubuntu 12.04 LTS 上安装 MariaDB。

我已按照[https://askubuntu.com/questions/64772/how-to-install-mariadb](https://askubuntu.com/questions/64772/how-to-install-mariadb)和 MariaDB.org 提供的说明进行操作，这些说明会在您选择下载时出现。

最后一步是`sudo apt-get install mariadb-server`返回：

```
Reading package lists... Done
Building dependency tree
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 mariadb-server : Depends: mariadb-server-5.5 but it is not going to be installed
E: Unable to correct problems, you have held broken packages. 
```

依赖问题是一个确认问题（[https://mariadb.atlassian.net/browse/MDEV-3882](https://mariadb.atlassian.net/browse/MDEV-3882)），但我相信损坏的包阻止我解决这个问题。

如果我尝试安装 libmariadbclient18，我会得到以下信息：

```
Reading package lists... Done
Building dependency tree
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 libmariadbclient18 : Depends: libmysqlclient18 (= 5.5.30-mariadb1~precise) but 5.5.31-0ubuntu0.12.04.1 is to be installed
E: Unable to correct problems, you have held broken packages. 
```

我尝试使用 纠正损坏的包`sudo apt-get install -f`，但我仍然无法安装 mariadb-server 或 libmariadbclient18。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-04-26T09:04:52.457

```
sudo apt-get install libmysqlclient18=5.5.30-mariadb1~precise mysql-common=5.5.30-mariadb1~precise
sudo apt-get install mariadb-server 
```

第一个将 ubuntu 端的两个 mysql 库恢复为较旧的 mariadb 库。然后第二个就可以正常进行了。

由于运行了类似的东西，包被删除了`apt-get dist-upgrade`。GUI 实际上会警告您有问题。

为防止此问题再次出现，请通过在以下位置创建文件来告诉 apt[通过 pinning 支持 MariaDB](https://kb.askmonty.org/en/installing-mariadb-deb-files/#pinning-the-mariadb-repository)`/etc/apt/preferences.d`存储库：

```
$ cat /etc/apt/preferences.d/MariaDB.pref
Package: *
Pin: origin <mirror-domain>
Pin-Priority: 1000 
```

`libmariadbclient-dev`此外，如果您需要编译任何东西（如 Ruby gems），请务必安装。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-28T18:07:19.860

我做了类似于@Lloeki的事情

```
$ sudo apt-get purge libmariadbclient18 mariadb-server mariadb-client-5.5 libmysqlclient18 mysql-common``` 
```

然后查找要安装的候选人并重新安装它：

```
$ apt-cache policy libmysqlclient18 | grep -i quantal 
Installed: 5.5.30-mariadb1~quantal
*** 5.5.30-mariadb1~quantal 0
    500 http://ftp.osuosl.org/pub/mariadb/repo/5.5/ubuntu/ quantal/main amd64 Packages
$ apt-cache policy mysql-common | grep -i quantal 
Installed: 5.5.30-mariadb1~quantal
*** 5.5.30-mariadb1~quantal 0
    500 http://ftp.osuosl.org/pub/mariadb/repo/5.5/ubuntu/ quantal/main amd64 Packages
$ 
```

```
$ sudo apt-get install libmysqlclient18=5.5.30-mariadb1~quantal mysql-common=5.5.30-mariadb1~quantal mariadb-server mariadb-client

...
 * Stopping MariaDB database server mysqld                                                              [ OK ] 
130428 13:19:40 [Note] Plugin 'InnoDB' is disabled.
130428 13:19:40 [Note] Plugin 'FEEDBACK' is disabled. 
```

我收到了 Plugin Disabled 警告，但是在重新启动 mysql`sudo service mysql restart`并安装我的 sql 时，innodb 似乎很好并且按预期`show create table mytable`显示。`ENGINE=InnoDB DEFAULT CHARSET=utf8`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-02T17:23:31.670

@yuvlio 说得对：

`$ sudo apt-get install libmysqlclient18=5.5.30-mariadb1~quantal mysql-common=5.5.30-mariadb1~quantal mariadb-server mariadb-client`

这适用于 12.04、12.10 和 13.04（也是 LinuxMint 14）。

显然，MariaDB 对内核已更新到 3.5.0-25 之类的任何地方“敏感”，这似乎会影响使用普通香草“sudo apt-get install mariadb-server”安装 MariaDB

@yuvlio 提到插件 'InnoDB' 和 'FEEDBACK' 被禁用，但 InnoDB 在安装后工作。

这很有意义，因为 MariaDB 使用 XTRA-DB 作为 InnoDB 的替代品。大概 MariaDB 也有一个新的反馈模块（他们希望 MariaDB 反馈到 mariadb.org 而不是 Oracle/mySQL）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-07-10T14:25:43.860

@Lloeki 的答案不再对我有用，因为上述版本对我不可用，导致此错误：

```
E: Version '5.5.30-mariadb1~precise' for 'libmysqlclient18' was not found 
```

要解决此问题，您需要找到正确的版本：

您可以使用 获取可用版本的列表`aptitude versions libmysqlclient18`。对于我的系统，这看起来像：

```
Package libmysqlclient18:
[...]
p   5.5.31+maria-1~precise                                         <NULL>                                      1000
i   1:5.5.32-rel31.0-549.precise                                   <NULL>                                      500
[...] 
```

（还有几行，但只显示相关行）。

行`i`是当前安装的版本，没有建议的行`5.5.30-mariadb1~precise`。然而，还有另一位候选人看起来很有希望。请注意，就像我一样，这对您来说不必相同（随着时间的推移而变化）。

在此示例中，您可以像这样继续：

```
sudo apt-get install libmysqlclient18=5.5.31+maria-1~precise 
```

在此之后，安装将同时选择客户端*和* `mariadb-common`，您可以继续：

```
 sudo apt-get install mariadb-server 
```

没有OP的错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-25T13:04:49.443

尝试

```
sudo dpkg --remove --force-remove-reinstreq BROKEN_PACKAGE 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-01-22T07:16:58.260

让我分享一下我在我的案例中是如何解决的（**Ubuntu 14.04**）。

我有**错误**：

```
$ sudo apt-get install mariadb-server-5.5
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 mariadb-server-5.5 : Depends: mariadb-client-5.5 (>= 5.5.41+maria-1~trusty) but it is not going to be installed
                      Depends: mariadb-server-core-5.5 (>= 5.5.41+maria-1~trusty) but it is not going to be installed
E: Unable to correct problems, you have held broken packages. 
```

**解决方案：**

步骤1：`sudo apt-get install libmysqlclient18`

第2步：`sudo apt-get install mariadb-server`

**笔记：**

*   我是按照这些[说明安装的](https://downloads.mariadb.org/mariadb/repositories/#mirror=yamagata-university&distro=Ubuntu&distro_release=trusty--ubuntu_trusty&version=5.5)
*   我以前没有安装 MySQL

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-04-02T20:48:18.160

我不知道这是否对任何人有帮助，但是我在安装 mariadb 10 时遇到了问题，并且出现了一个错误，导致我进入此页面，但我尝试过的没有任何帮助。

我终于意识到我的 /tmp 目录归 root 所有，其他用户无法写入。我解决了这个问题，然后做了：

```
apt-get remove mariadb-server 
```

尝试再次安装它，但删除失败，所以我删除`/var/lib/mysql` 然后尝试：

```
apt-get remove mariadb-server 
```

再次，它实际上安装了 mariadb-server 并启动并运行...

现在可以了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-26T04:20:21.447

我能够通过删除所有 mysql 包然后运行来安装 mariadb：

```
    sudo apt-get 安装 mariadb-server-5.5 mariadb-client-5.5 \
    mariadb-server-core-5.5 mariadb-common mariadb-server \
    libmariadbclient18 libdbd-mysql-perl mariadb-client-core-5.5 \
    libmysqlclient18=5.5.30-mariadb1~quantal \
    mysql-common=5.5.30-mariadb1~quantal

```

我不确定是否需要先删除 mysql。

# jquery - 每个弹出窗口 div 的高度相等

> ID：16214520
> 
> 赞同：0
> 
> 时间：2013-04-25T12:16:53.407
> 
> 标签：jquery

如何在每个多个 div 上设置相等的高度？

```
<div class="brands">
    <div class="left" style="height:50px;">different height 1 same group</div>
    <div class="right" style="height:50px;">different height 2 same group</div>
</div>
 <div class="brands">
    <div class="left" style="height:150px;">different height 3 same group</div>
    <div class="right" style="height:150px;">different height 4 same group</div>
</div> 
```

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:25:36.793

如果你想要它们都一样：

```
$('div.brands').children('div').css('height', '100px'); 
```

或者，如果不同的需要不同的高度：

```
$('div.brands').eq(0).children('div').css('height', '50px');
$('div.brands').eq(1).children('div').css('height', '150px'); 
```

要将子 div 设置为给定品牌 div 中最高子 div 的高度：

```
var leftHeight = 0;
var rightHeight = 0;
$('div.brands').each(function() {
    leftHeight = $(this).children('div.left').height();
    rightHeight = $(this).children('div.right').height();
    if(leftHeight > rightHeight) {
        $(this).children('div.right').css('height', leftHeight + 'px');
    }
    else {
        $(this).children('div.left').css('height', rightHeight + 'px');
    }        
}); 
```

# perl - 查找两个文件之间第一列的匹配模式并打印第三个文件中每个文件的行

> ID：16214521
> 
> 赞同：2
> 
> 时间：2013-04-25T12:16:57.750
> 
> 标签：perl, sed, awk

我有两个文件，一个包含服务器名称和 IP，另一个包含服务器名称和机器名称，例如。这些文件没有真正的顺序。我尝试过使用 Sort、awk 和 sed 的变体。但是第一个文件维护得不是很好，并且包含虚假数据，这些数据抵消了我计划这样做的方式。

我试图基本上只为两行中包含的服务器在两个文件之间进行模式匹配，并将两个文件中的行中的数据打印在第三文件的一行上。

文件 1：

```
Server1 10.10.10.1
Server2 10.10.10.2
....
Server154 10.10.30.8
Server155 10.10.30.9 
```

文件 2：

```
Server1 site site1
Server2 site site2
....
Server154 site site154
Server155 site site155 
```

输出：

```
Server1 10.10.10.1 site site1
Server2 10.10.10.2 site site2
...
Server154 10.10.30.8 site site154
Server155 10.10.30.9 site site155 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:22:21.130

这应该可以解决问题：

```
$ awk 'FNR==NR{a[$1]=$0;next}($1 in a){print a[$1],$2,$3}' file1 file2
Server1 10.10.10.1 site site1
Server2 10.10.10.2 site site2
Server154 10.10.30.8 site site154
Server155 10.10.30.9 site site155 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-25T12:28:40.683

可以通过在 BEGIN 中用第一个文件填充数组，然后将第二个文件与该数组匹配来解决。

```
awk -v f1="file1.txt" 'BEGIN { while (getline < f1) { keys[$1]=$2 } ; close(f1) }
   keys[$1] { print }' file2.txt 
```

# maven - Maven添加不在pom文件中的依赖项

> ID：16214524
> 
> 赞同：2
> 
> 时间：2013-04-25T12:17:02.740
> 
> 标签：maven

我在 pom 文件中定义了一个只有两个依赖项的模块，但是生成的 .classpath 文件（使用 mvn eclipse:eclipse）还包含其他依赖项。

我检查了这个 pom 中添加的模块的依赖关系，但并不是所有的模块都被添加了。

所以场景是：

*   项目 A 依赖于项目 B
*   项目 B 依赖于项目 X、Y 和 Z

当我在项目 A 上运行 mvn eclipse:eclipse 时，.classpath 文件包含项目 B 和项目 X 和 Y，但不包含 Z。

这不会引起任何问题，但这是预期的行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:23:08.523

是的，这是预期的行为。项目 B 需要 X、Y 和 Z 才能正常工作，因此这些依赖项（称为**传递依赖**项）实际上是您项目的一部分。

有关 maven 依赖项解析的详细说明，请参阅[**this**](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)。

您可以调用`mvn dependency:tree`或`mvn dependency:list`从命令行查看所有依赖项，包括传递的依赖项。

如果你知道你依赖于一个工件，但它会在运行时可用，就像应用服务器上的 Java EE 库一样，你可以将它们标记`provided`为`pom`：

```
<dependency>
  <groupId>group</groupId>
  <artifactId>artifact</artifactId>
  <version>1.0</version>
  <scope>provided</scope>
</dependency> 
```

这些依赖项不会包含在生成的 atrifact 中。

**编辑：**请原谅我糟糕的阅读能力:) 我在“Z”之前监督了“不”。

如果 Z 的依赖项定义为`provided`或`optional`标志设置为`true`，或者如果它被排除，这可能仍然是正常行为。有关 maven 对可选和排除依赖项的处理，请参阅[**this**](http://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html)。

如果这些选项都不适用，那么我希望 Z 与其他依赖项一起存在。最好的检查方法是运行`mvn dependency:tree`或`mvn dependency:list`grep Z 的输出。

# r - 提取相关矩阵的相关元素

> ID：16214527
> 
> 赞同：5
> 
> 时间：2013-04-25T12:17:19.900
> 
> 标签：r, correlation

我在 R 中有一个相关矩阵，我想知道有多少组（并将这些组放入向量中）元素之间的相关性超过 95%。

```
X <- matrix(0,3,5) 
X[,1] <- c(1,2,3)
X[,2] <- c(1,2.2,3)*2
X[,3] <- c(1,2,3.3)*3
X[,4] <- c(6,5,1)
X[,5] <- c(6.1,5,1.2)*4

cor.matrix <- cor(X)
cor.matrix <- cor.matrix*lower.tri(cor.matrix)
cor.vector <- which(cor.matrix>0.95, arr.ind=TRUE) 
```

`cor.vector`然后包含：

```
 row col 
[1,]   2   1 
[2,]   3   1 
[3,]   3   2 
[4,]   5   4 
```

这意味着，正如预期的那样，向量 1,2 和 3 在它们之间具有相关性，还有 4 和 5。

我需要的是获得两个向量`c(1,2,3)`并`c(4,5)`作为最终结果。

这是一个简单的例子，不过我正在处理大型矩阵。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T13:03:07.033

这是一种使用`igraph`包的方法：

```
require(igraph)
g <- graph.data.frame(cor.vector, directed = FALSE)
split(unique(as.vector(cor.vector)), clusters(g)$membership)
# $`1`
# [1] 2 3 1

# $`2`
# [1] 5 4 
```

这本质上是在图 g（断开的集合）中找到集群，如下图所示。由于顶点用于按照您输入的顺序（从您的`cor.vector`）创建图形，因此聚类顺序也以相同的顺序返回。即：对于顶点 c(2,3,5,1,4)，簇为 c(1,1,2,1,2)，共有两个簇（簇 1 和簇 2）。因此，我们只是使用它来使用集群组进行拆分。

![在此处输入图像描述](https://i.stack.imgur.com/dTFBm.png)

# google-maps-api-3 - 将谷歌地图 api v2 转换为 v3 在 main.js 中获取脚本错误

> ID：16214528
> 
> 赞同：0
> 
> 时间：2013-04-25T12:17:21.673
> 
> 标签：google-maps-api-3

我正在将我的代码从版本 2 转换为版本 3。我在 [http://maps.gstatic.com/intl/en_us/mapfiles/api-3/12/9/main.js](http://maps.gstatic.com/intl/en_us/mapfiles/api-3/12/9/main.js)中收到脚本错误 我在页面上的代码就像

```
 <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true&key=<%=strGk%>"></script>
   <script type="text/javascript">
function initialize() {
            var myOptions = {
            zoom: 7,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            center: "<%=strOrig%>",
            mapTypeControl: true,
            mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
                position: google.maps.ControlPosition.BOTTOM
            },
            navigationControl: true,
            navigationControlOptions: {
                style: google.maps.NavigationControlStyle.ZOOM_PAN,
                position: google.maps.ControlPosition.TOP_RIGHT
            },
            scaleControl: true,
            scaleControlOptions: {
                position: google.maps.ControlPosition.TOP_LEFT
            }
        }

        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        directionsDisplay.setMap(map);
        directionsDisplay.setPanel(document.getElementById("directions"));
        google.maps.event.addListener(directionsDisplay, "addoverlay", afterDir);
        google.maps.event.addListener(directionsDisplay, "error", handleErrors);
        //  geocoder = new GClientGeocoder();
        geocoder = new google.maps.Geocoder(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T19:26:35.157

您正在使用已弃用的已弃用的**导航控件**

在 V3 中，它分为单独的缩放和平移控件。查看[**文档**](https://developers.google.com/maps/documentation/javascript/examples/control-positioning)

**尝试**

```
function initialize() {
  var mapOptions = {
    zoom: 7,
    center: new google.maps.LatLng(55.91913101970850, -4.650520),
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    mapTypeControl: true,
    mapTypeControlOptions: {
        style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
        position: google.maps.ControlPosition.BOTTOM
    },
    panControl: true,
    panControlOptions: {
        position: google.maps.ControlPosition.TOP_RIGHT
    },
    zoomControl: true,
    zoomControlOptions: {
        //style: google.maps.ZoomControlStyle.LARGE,
        position: google.maps.ControlPosition.TOP_RIGHT
    },
    scaleControl: true,
    scaleControlOptions: {
        position: google.maps.ControlPosition.TOP_LEFT
    },
  }
  var map = new google.maps.Map(document.getElementById('map_canvas'),
                                mapOptions);
} 
```

# highcharts - 当窗口缩小时，如何让我的高图缩小

> ID：16214538
> 
> 赞同：2
> 
> 时间：2013-04-25T12:17:45.673
> 
> 标签：highcharts

当窗口缩小时，我无法让我的 highchart 缩小尺寸。

我在 JSFiddle [http://jsfiddle.net/britboy/UvFaQ/中创建了我的代码示例](http://jsfiddle.net/britboy/UvFaQ/)

```
<table border='1' width='100%'><tr><td width='100%'>
<div id="container" width='100%'></div>
</td></tr></table> 
```

它是一个显示在表格中的简单 Highchart 图表 - 如果我让窗口更大，图表会扩展，但是如果我让窗口更小，图表不想缩小，而是表格会出现滚动条。

我尝试设置一个调整大小事件，然后使用 chart.setSize() 调整图表大小，但问题是包含图表的 div 永远不会进一步减小大小，因此不会触发 setSize()。由于图表容器变大时图表会自动调整大小，但当图表变小时，我也会这样做。我认为问题在于图表的大小正在阻止其容器缩小。

如何在表格中编码一个图表，当表格缩小时尺寸会减小？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:49:08.957

有*n*种方法来完成它。

正如@Azeem 所指出的那样。在评论中。

否则，我实际上将它与`window`. 每当窗口重新调整大小时，绑定事件都会触发一个函数来重新调整用于呈现图表的 div 元素的大小。

```
$(window).bind("resize", resizeChart); 
```

然后，

```
function resizeChart() {
    var width = $(document).width() - 55;
    var height = $(document).height() - 60;
    $("#container").css("width", width);
    $("#container").css("height", height);
} 
```

查看示例小提琴**[`here`](http://jsfiddle.net/gopinaghr/UvFaQ/5/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-09T09:10:04.167

试试这个方法：

```
var chart = $('#graph1').highcharts();
var DetailsWidth = $('#graph1'); 
```

[http://jsfiddle.net/cjohn/5ghzk4t8/4/](http://jsfiddle.net/cjohn/5ghzk4t8/4/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-02T13:03:32.510

[在`react-highcharts`此处添加解决方案，因为在 Google 上搜索“react-highcharts shrink”时，这会作为第一个 SO 解决方案弹出]

因为`react-highcharts`您可以简单地在窗口调整大小事件监听器中调用 React 组件的 forceUpdate() 方法。它将触发 Highcharts 重新绘制到新的更小的区域。另请参阅[使用 React 重新渲染浏览器调整大小的视图](https://stackoverflow.com/questions/19014250/rerender-view-on-browser-resize-with-react/39082160#39082160)

**注意：**我的代码`flex-auto`在父元素和 Highcharts DOM 元素中使用（参见 CSS 灵活框布局）进行了测试。知道这是否也适用于其他布局会很有趣。

```
import React      from 'react';
import Highcharts from 'react-highcharts';
...
export default class Chart extends React.Component {
    constructor(props) {
        ...
        // install callbacks
        this.resize = () => {
            // throttle resize events as redraw is expensive
            if (this.timeout)
                return;

            this.timeout = setTimeout(
                () => {
                    // force Highcharts to always adhere
                    // to changes in the view area
                    this.forceUpdate();
                    this.timeout = undefined;
                },
                50); // milliseconds
        };
        ...
    }
    ...
    componentDidMount() {
        ...
        // listen to window resize events
        window.addEventListener('resize', this.resize);
        ...
    }
    ...
    componentWillUnmount() {
        ...
        // remove listener when component goes away
        window.removeEventListener('resize', this.resize);
        if (this.timeout) {
            clearTimeout(this.timeout);
            this.timeout = undefined;
        }
        ...
    }
    ...
    render() {
        ...
        return (
            <Highcharts
                config={...}
                domProps={{
                    className: 'd-flex flex-auto',
                    ...
                }}
                ...
            />
        );
    }
    ...
} 
```

# javascript - 最新的 Google Analytics API 参考？

> ID：16214539
> 
> 赞同：2
> 
> 时间：2013-04-25T12:17:51.230
> 
> 标签：javascript, google-analytics, google-analytics-api

我有一个不寻常的 Google API 代码片段：

```
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-XXXXXX-1', '192.168.8.101');
ga('send', 'pageview'); 
```

这看起来与旧版本非常相似，但是，我找不到对这些 API 的任何引用。我正在寻找以下类似物：

*   `_setCustomVar`
*   `_trackPageView`（`'send', 'pageview'`相当于吗？）
*   `_setDomainName`（我想在内网/连接到本地运行的HTTP服务器的计算机上测试它）。

抱歉，这里有些混乱。我找到了参考：

[https://developers.google.com/analytics/devguides/collection/analyticsjs/domains](https://developers.google.com/analytics/devguides/collection/analyticsjs/domains)

在这里，为了后代，但是，我找不到`_setCustomVar`和的类似物`_setDomainName`。

**更新**

我发现（也许）`ga('set', { property : value });`会做同样的事情，`_setCustomVar`并且`ga('create', 'UA-XXXXX-1', { 'cookieDomain': 'none' })`会类似于`_setDomainName`. 但是，在本地测试时，我仍然无法让它报告任何内容:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:13:34.507

你是对的，_setDomainName 被替换为 create 的属性。这很有用，因为有些人在 _trakPageview 之后调用 _setDomainName，这会导致问题。因此，将其作为属性避免与排序混淆。

```
ga('create', 'UA-XXXXX-1', { 'cookieDomain': 'none' }) 
```

以前的 CustomVar 也称为自定义指标和维度。它们更强大，因为它们是在服务器端配置的，您只在 api 调用上发送值。现在您还可以发送将被汇总的指标。

新 API 和这些更改是 Google Analytics 平台上称为 Universal Analytics 的更大更新的一部分。

[关于通用分析](http://support.google.com/analytics/answer/2790010?hl=en)。

请注意，要使用新的跟踪代码，您的网络媒体资源必须设置为 Universal Analytics。您不能将旧的网络媒体资源更改为 Universal Analytics（至少目前还不能）。当您创建新的网络媒体资源时，您可以选择是否使用 Universal Analytics。

# php - php 表单：value=" vs. value="

> ID：16214542
> 
> 赞同：0
> 
> 时间：2013-04-25T12:18:02.863
> 
> 标签：php, forms, variables, post

当我使用时，我的表单生成错误：

```
<input type="hidden" name="total_amount" value="<?php=$_POST['total_amount']?>" /> 
```

但是当我使用它时它工作正常：

```
<input type="hidden" name="total_amount" value="<?=$_POST['total_amount']?>" /> 
```

我认为使用`<?=`而不是`<?php`.

这是完整的表格：

```
<form name="save_file" action="cyprus_funds_transfer.php" method="post" enctype="multipart/form-data">
  <? if($_POST['value_type'] == 1) {?>
  <input type="hidden" name="amount" value="<?php=$_POST['account_number']?>" />
  <input type="hidden" name="value_type" value="1" />
  <input type="hidden" name="total_amount" value="<?php=$_POST['total_amount']?>" />
  <? } else { ?>
  <input type="hidden" name="amount" value="<?php=$_POST['amount']?>" />
  <input type="hidden" name="value_type" value="0" />
  <? } ?>
  <input type="hidden" name="to" value="<?php=$_POST['send_to']?>" />
  <input type="hidden" name="from" value="<?php=$_POST['send_from']?>" />
  <input type="hidden" name="message" value="<?php=$_POST['message']?>" />
  <input type="hidden" name="mode" value="save" />
  <input type="hidden" name="order_id" value="<?php=$order_id?>" />
  <input type="hidden" name="email_id" value="<?php=$_POST['email_id']?>" />
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:19:53.833

这是错误的方式

```
<?php=$_POST['send_to']?> 
```

这是正确的方法

```
<?=$_POST['send_to']?> is similar to <?php echo $_POST['send_to']; ?> 
```

# [键盘](http://codepad.org/TZwLAzXq)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:19:46.917

尝试更换

```
<?php=$_POST['send_to'];?> 
```

对此

```
<?=$_POST['send_to'];?> 
```

或者有了这个

```
<?php echo $_POST['send_to'];?> 
```

# java - 如何将Java代码文件的修订号插入Java类文件

> ID：16214544
> 
> 赞同：-1
> 
> 时间：2013-04-25T12:18:09.043
> 
> 标签：java, version-control, cvs

Java 代码文件包含@author 和@version 标签。版本标签包含有关文件修订号的信息。此信息位于评论中。是否有任何可用的编译标志或其他机制可以将这些信息添加到 .class 文件中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:47:27.317

简短的回答：编译器忽略 JavaDoc 作为所有其他形式的注释。

长答案：您需要编写一个应用程序来复制类/方法声明上方的现有元素`@author AuthorName`和`@version VersionString`javadoc 元素，例如：

```
@Author({"AuthorName", "OtherAuthor"})
@Version("VersionString")
public class Something [...] { [...] } 
```

一个示例`Author`注释可以是：

```
@Author("afk5min")
@Target({ ElementType.ANNOTATION_TYPE, ElementType.CONSTRUCTOR, ElementType.METHOD, ElementType.TYPE })
@Retention(RetentionPolicy.CLASS)
public @interface Author {
  String[] value();
} 
```

这样，每个注释都存在于生成的类文件中并且可以被访问。

> 9.6.3.2。@保留
> 
> 注释可能只存在于源代码中，或者它们可能以类或接口的二进制形式存在。二进制形式的注解在运行时可能通过 Java SE 平台的反射库可用，也可能不可用。注释类型 java.lang.annotation.Retention 用于在这些可能性中进行选择。

此外，`RetentionPolicy.RUNTIME`如果您希望运行时访问注释，可以指定。反射 API 允许这样做：

```
Author.class.getAnnotation(Author.class).value()[0] -> "afk5min" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:06:29.857

有一次，我修改了我的 Ant 构建脚本以创建一个 MANIFEST.MF 文件，其中包含版本号以及其他信息。

这是最新的 MANIFEST.MF 文件，

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.6.5
Created-By: 19.0-b09 (Sun Microsystems Inc.)
Main-Class: gov.bop.svnreport.SVNReportMain
Built-By: Gilbert G. Le Blanc
Built-On: 20111109-1437
Version: 1.1.1
Specification-Title: Subversion Commit Report
Specification-Version: 1.1.1
Specification-Vendor: Federal Bureau of Prisons
Class-Path: svnkit.jar 
```

这是来自 Ant 脚本的 JAR 目标。

```
<target name="jar" depends="compile">
    <mkdir dir = "${jar}"/>
    <echo>Jar directory - "${jar}"</echo>
    <manifest file="META-INF/MANIFEST.MF">
        <attribute name="Main-Class" value="gov.bop.svnreport.SVNReportMain"/>
        <attribute name="Class-Path" value="svnkit.jar"/>
        <!-- This line puts your username into the manifest.
             Maybe you don't want to do that. -->
        <attribute name="Built-By" value="Gilbert G. Le Blanc"/>
        <attribute name="Built-On" value="${DSTAMP}-${TSTAMP}"/>
        <!-- This property was set by the svn-info task -->
        <!-- <attribute name="Revision" value="${svnrevision}"/> -->
        <!-- This property comes from the build.properties file -->
        <attribute name="Version" value="${app.version}"/>
        <attribute name="Specification-Title" value="Subversion Commit Report"/>
        <attribute name="Specification-Version" value="${app.version}"/>
        <attribute name="Specification-Vendor" value="Federal Bureau of Prisons"/>
    </manifest>

    <jar jarfile="${jar}/${ant.project.name}.jar"
                manifest="META-INF/MANIFEST.MF">
            <fileset dir="${build}/">
                    <patternset refid="all-classes"/>
            </fileset>
            <fileset dir="." includes="${bin.includes}/"/>          
    </jar>
    <copy file="${jar}/${ant.project.name}.jar" todir="${deploy}" />
    <copy file="${svnkit}" todir="${deploy}" />
</target> 
```

我试图将 Subversion 版本号放入 MANIFEST.MF 文件中，但我无法让它工作。

此方法的一个问题是它仅在您从 JAR 文件执行 Java 应用程序时才有效。如果您尝试从 Eclipse 等 IDE 中提取这些清单属性，`null`则会返回值。

# javascript - 如何在 Joomla 2.5 文章中一起编写 HTML、CSS 和 Javascript？

> ID：16214546
> 
> 赞同：-1
> 
> 时间：2013-04-25T12:18:10.833
> 
> 标签：javascript, html, css, joomla2.5

我正在尝试在 joomla 2.5 文章中一起编写 HTML、CSS 和 Javascript，但我未能获得所需的输出，有没有办法在 joomla 2.5 文章中将这三者一起工作？

请帮我解决这个问题。我是 Joomla 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:54:13.657

有一个名为[Sourcerer](http://www.nonumber.nl/extensions/sourcerer)的扩展，它允许您将代码添加到文章中。

安装后，启用插件，然后打开文章，您可以开始将代码添加到文章中。下面是一个例子：

```
{source}

<span style="color:red">This text should be red!</span>

<script type="text/javascript">
    alert("This is Javascript");
</script>

<?php
    echo 'This is PHP';
?>
{/source} 
```

希望这可以帮助

# java - 通过WIFI连接安卓设备

> ID：16214547
> 
> 赞同：1
> 
> 时间：2013-04-25T12:18:14.020
> 
> 标签：java, android, wifi

我正在尝试通过 WIFI 将我的电脑连接到我的安卓手机。

但问题是，每当我将手机与 WIFI 断开并再次打开时，我都会得到一个不同的 IP 地址，所以我的电脑在我更改要连接的 IP 地址之前无法连接.. 有什么方法可以得到正确的电话的IP地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:53:21.783

那可能是路由器设置问题。您听说过“DHCP 预留”吗？大多数路由器都支持这样的选项，它使路由器能够为曾经连接的每个不同客户端记住一个 IP，然后在每次重新连接时将该 IP 分配给相应的客户端。

检查您的路由器设置/文档以了解此选项。

这是一个链接，它可以帮助您进行进一步的调查：

[http://lifehacker.com/5822605/how-to-set-up-dhcp-reservations-so-you-never-have-to-check-an-ip-address-again](http://lifehacker.com/5822605/how-to-set-up-dhcp-reservations-so-you-never-have-to-check-an-ip-address-again)

# jquery - jquery 代码更改 CSS 但我想触发一个函数

> ID：16214548
> 
> 赞同：0
> 
> 时间：2013-04-25T12:18:15.560
> 
> 标签：jquery, function

我有一行代码等待 #total 增加 1 并在发生这种情况时更改 CSS。

```
$('#total_shares').html(parseFloat($('#total').html())+1).css({
   //Changes CSS of #total
}); 
```

我想知道 - 如果我想保留相同的代码而不是 .css(); 触发一个函数，而不是单独更改 CSS，我将拥有更多选项。这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:21:44.143

```
$('#total_shares').html(parseFloat($('#total').html())+1).each(function(idx, domElement){
   var $jQueryElement = $(domElement);
   // DO ANYTHING YOU WISH 
}); 
```

这样，您可以更改初始选择器并仍然保留每个匹配元素的所有功能。

否则，如果您**知道**您只有 1 个元素（这是您的情况），您可以执行以下操作：

```
var $jQueryElement = $('#total_shares').html(parseFloat($('#total').html())+1);
// DO ANYTHING YOU WISH with the matched element 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:20:24.020

当然，使用`.each()`，像这样：

```
$('#total_shares').html(parseFloat($('#total').html())+1).each(function() {
   $(this).css({left: 50});//example css change
   //Changes CSS of #total
}); 
```

# jsf - Primefaces如何在数据表选择事件后触发另一个事件

> ID：16214552
> 
> 赞同：0
> 
> 时间：2013-04-25T12:18:25.433
> 
> 标签：jsf, jsf-2, primefaces, datatable

我有一个带有选择和命令按钮的数据表。问题是如果用户没有从数据表中选择任何项目并单击按钮，则 selectedItem 对象返回 null。我认为数据表的选择事件在我的命令按钮的操作方法之后运行。

我想做的是；如果用户没有从数据表中选择任何项目并单击按钮，我将创建一个新的 SelectedItem 对象。但是在按钮的操作方法运行后，数据表将其更改为空。

```
<p:panel id="panel1">
<p:dataTable selection="#{myController.selectedItem}"
             selectionMode="single"....
//some other stuff
</p:panel>

<p:panel id="panel2">
//some other stuff
<p:commandButton value="Create" action="myController.create"....
</p:panel> 
```

我的控制器；

```
SelectedItem selectedItem = new SelectedItem();

public void create(){
 selectedItem = new SelectedItem();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:27:25.867

你可以试试这个：
**.xhtml**

```
<p:dataTable var="result" selection="#{myController.selectedItem}"
         selectionMode="single"....

<p:commandButton actionListener="#{myController.create()}">
    <f:setPropertyActionListener value="#{result}" target="#{myController.selectedItem}" />  
</p:commandButton> 
```

**.java**

```
SelectedItem selectedItem = new SelectedItem();  

public void create(){
  selectedItem = new SelectedItem();
} 
```

# javascript - Knockout.js 使用 foreach 显示对象属性

> ID：16214554
> 
> 赞同：0
> 
> 时间：2013-04-25T12:18:33.567
> 
> 标签：javascript, jquery, knockout.js

我有这个 Viewmodel 可以从 WCF 服务加载用户及其社交图列表。用户显示正确，但没有显示社交图条目。我检查了服务和返回的 json，一切似乎都很好。

我应该将我的模型更改为不同的东西还是我在 ViewModel 中加载东西的方式？谢谢

```
$(document).ready(function () {

var viewModel = {

    users: ko.observableArray([]),              

    loadUsers: function () {
        OData.read("Service_UserProfile/", function (data) {

            viewModel.users.removeAll();
            $.each(data.results, function (index, item) {                    
                var socialgraphs = viewModel.loadSocialGraph();
                var user = new UserProfileModel(item, socialgraphs);                   
                viewModel.users.push(user);                   
            });
        });
    },

    loadSocialGraph: function () {

        var result = new Array();
        // user id will be loaded dynamically in later steps
        OData.read("/Service_UserProfile(1)/Socialgraph/", function (data) {

            $.each(data.results, function (index, item) {                   
                result.push(new SocialGraph(item));                    
           });
        });        
        return result;
    }
};

ko.applyBindings(viewModel);   
viewModel.loadUsers(); 
```

});

该模型

```
function UserProfileModel(item,socialgraphs) {
    this.Id = ko.observable(item.Id),
    this.Nickname = ko.observable(item.Nickname),
    this.socialgraphs = ko.observableArray(socialgraphs)
};

function SocialGraph(item) {
    this.Id = ko.observable(item.Id),
    this.StartTime = ko.observable(item.StartTime),
    this.Latitude = ko.observable(item.Latitude),
    this.Longitude = ko.observable(item.Longitude)
}; 
```

风景

```
<table>
    <thead>
        <tr>
            <th>User ID</th>
            <th>Nickname
            </th>
            <th>Social Graph
            </th>
        </tr>
    </thead>
    <tbody data-bind="foreach: users">
        <tr>
            <td data-bind="text: Id"></td>
            <td data-bind="text: Nickname"></td>
            <td>
                <ul data-bind="foreach: socialgraphs">
                    <li data-bind="text: Id"></li>
                    <li data-bind="dateString: StartTime"></li>
                    <li data-bind="text: Latitude"></li>
                    <li data-bind="text: Longitude"></li>
                </ul>
            </td>
        </tr>

    </tbody>

</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:55:12.607

你应该改变：

```
loadSocialGraph: function () {

    var result = ko.observableArray();
    // user id will be loaded dynamically in later steps
    OData.read("/Service_UserProfile(1)/Socialgraph/", function (data) {

        $.each(data.results, function (index, item) {                   
            result.push(new SocialGraph(item));                    
       });
    });        
    return result;
} 
```

和

```
function UserProfileModel(item,socialgraphs) {
    this.Id = ko.observable(item.Id),
    this.Nickname = ko.observable(item.Nickname),
    this.socialgraphs = socialgraphs
}; 
```

原因：在 右边部分
的行socialgraphs 是 []。`this.socialgraphs = ko.observableArray(socialgraphs)`
只有在某个时间间隔后，它才会被值填充。而且由于它不是可观察的数组，因此淘汰赛不会注意到某些项目被推入其中。即它将保持为空。

# mysql - 安装 phpmyadmin 以便能够管理管理员为我创建的 mysql 数据库

> ID：16214560
> 
> 赞同：0
> 
> 时间：2013-04-25T12:18:47.740
> 
> 标签：mysql, phpmyadmin, dbmigrate

我无权访问 cPanel。我只能使用 FTP 访问我正在使用的站点的根目录，并使用域名、用户和密码。我想在 root 上安装 phpmyadmin，以便我可以管理管理员为我创建的 mysql 数据库。我有数据库名称、用户名和密码。我需要做什么？我需要下载phpmyadmin，上传安装吗？请给我一些细节和方法。我真的可以使用它吗？

此外，如何将我也可以访问的另一个 mysql 数据库的所有内容（具有其：数据库名称、用户和密码）迁移到为我正在使用的站点创建的这个数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:47:29.410

从以下站点下载 phpmyadmin：http: [//sourceforge.net/projects/phpmyadmin/files/phpMyAdmin/3.5.8.1/phpMyAdmin-3.5.8.1-all-languages.zip/download# !md5!a65d444787645735c75bca49cdb558cb](http://sourceforge.net/projects/phpmyadmin/files/phpMyAdmin/3.5.8.1/phpMyAdmin-3.5.8.1-all-languages.zip/download#!md5!a65d444787645735c75bca49cdb558cb)

通过 FTP 将其上传到您的网络服务器上的单独文件夹中

转到此文件夹并使用您的数据库用户名和密码登录 更正屏幕底部的警告和错误（主要是安全问题）

完毕 ：）

当您对错误或警告有任何疑问时，请发布新问题。

# sql-server - 分组方式不起作用 - SQL 2008 R2

> ID：16214565
> 
> 赞同：-2
> 
> 时间：2013-04-25T12:19:01.773
> 
> 标签：sql-server, group-by

我有 3 行需要输出到 1 行，下面的脚本应该可以，但我似乎无法得到预期的结果，它总是显示为 3 行，有什么我遗漏的吗？我应该总结所有字段，因为它们都在“GROUP”子句中吗？

顺便说一句，它就在我对以下结果字段进行更改之前工作；

```
TSL_DAY_A
TSL_NET_A
TSL_TX_SAL
TSL_CHG 
```

这些字段最初指定为 0.00 作为默认值。

看着它，我的眼睛已经很累了，...

```
SELECT BR_CODE
    ,N_CHECK
    ,CLAS_C
    ,CLAS_TRD_C
    ,STOR_NO
    ,SUM(TSL_NEW_A) AS TSL_NEW_A
    ,SUM(TSL_OLD_A) AS TSL_OLD_A
    ,SalesType
    ,SUM(TSL_DAY_A) AS TSL_DAY_A
    ,SUM(TSL_DIS_A) AS TSL_DIS_A
    ,TSL_DIS_B
    ,SUM(TSL_DIS_C) AS TSL_DIS_C
    ,TSL_DIS_D
    ,SUM(TSL_DIS_E) AS TSL_DIS_E
    ,TSL_Dis_F
    ,TSL_Dis_G
    ,TSL_Dis_H
    ,TSL_Dis_I
    ,TSL_Dis_J
    ,TSL_Dis_K
    ,TSL_Dis_L
    ,SUM(TSL_TAX_A) AS TSL_TAX_A
    ,TSL_TAX_B
    ,TSL_ADJ_A
    ,TSL_ADJ_POS
    ,TS_ADJ_NEG
    ,TSL_ADJ_NT_POS
    ,TSL_ADJ_NT_NEG
    ,SUM(TSL_NET_A) AS TSL_NET_A
    ,SUM(TSL_VOID) AS TSL_VOID
    ,SUM(TSL_RFND) AS TSL_RFND
    ,SUM(TSL_TX_SAL) AS TSL_TX_SAL
    ,SUM(TSL_NX_SAL) AS TSL_NX_SAL
    ,TSL_CHG
    ,SUM(TSL_CSH) AS TSL_CSH
    ,SUM(TSL_GC) AS TSL_GC
    ,TSL_EPS
    ,TSL_TND
    ,TSL_MCRD
    ,TSL_VISA
    ,TSL_AMEX
    ,TSL_DINERS
    ,TSL_JBC
    ,TSL_OTCRD
    ,TSL_SV_CHG
    ,TSL_OT_CHG
    ,SUM(TSL_FT) AS TSL_FT
    ,SUM(TSL_LT) AS TSL_LT
    ,SUM(TSL_NT) AS TSL_NT
    ,SUM(TSL_BEG_INV) AS TSL_BEG_INV
    ,SUM(TSL_END_INV) AS TSL_END_INV
    ,SUM(TSL_TC_CASH) AS TSL_TC_CASH
    ,SUM(TSL_TC_GC) AS TSL_TC_GC
    ,TSL_TC_EPS
    ,TSL_TC_TND
    ,TSL_TC_MCD
    ,TSL_TC_VIS
    ,TSL_TC_AMX
    ,TSL_TC_DIN
    ,TSL_TC_JBC
    ,TSL_TC_OC
    ,TSL_MCH
    ,TSL_SRL
    ,SUM(TSL_ZCNT) AS TSL_ZCNT
    ,TSL_TIME
    ,TSL_DTE
FROM(
    SELECT
        BR_CODE
        ,N_CHECK
        ,CLAS_C
        ,CLAS_TRD_C
        ,STOR_NO
        ,SUM(TSL_NEW_A) AS TSL_NEW_A
        ,SUM(TSL_OLD_A) AS TSL_OLD_A
        ,SalesType
        ,SUM(TSL_DAY_A) AS TSL_DAY_A
        ,SUM(TSL_DIS_A) AS TSL_DIS_A
        ,TSL_DIS_B
        ,SUM(TSL_DIS_C) AS TSL_DIS_C
        ,TSL_DIS_D
        ,SUM(TSL_DIS_E) AS TSL_DIS_E
        ,TSL_Dis_F
        ,TSL_Dis_G
        ,TSL_Dis_H
        ,TSL_Dis_I
        ,TSL_Dis_J
        ,TSL_Dis_K
        ,TSL_Dis_L
        ,SUM(TSL_TAX_A) AS TSL_TAX_A
        ,TSL_TAX_B
        ,TSL_ADJ_A
        ,TSL_ADJ_POS
        ,TS_ADJ_NEG
        ,TSL_ADJ_NT_POS
        ,TSL_ADJ_NT_NEG
        ,SUM(TSL_NET_A) AS TSL_NET_A
        ,SUM(TSL_VOID) AS TSL_VOID
        ,SUM(TSL_RFND) AS TSL_RFND
        ,SUM(TSL_TX_SAL) AS TSL_TX_SAL
        ,SUM(TSL_NX_SAL) AS TSL_NX_SAL
        ,TSL_CHG
        ,SUM(TSL_CSH) AS TSL_CSH
        ,SUM(TSL_GC) AS TSL_GC
        ,TSL_EPS
        ,TSL_TND
        ,TSL_MCRD
        ,TSL_VISA
        ,TSL_AMEX
        ,TSL_DINERS
        ,TSL_JBC
        ,TSL_OTCRD
        ,TSL_SV_CHG
        ,TSL_OT_CHG
        ,SUM(TSL_FT) AS TSL_FT
        ,SUM(TSL_LT) AS TSL_LT
        ,SUM(TSL_NT) AS TSL_NT
        ,SUM(TSL_BEG_INV) AS TSL_BEG_INV
        ,SUM(TSL_END_INV) AS TSL_END_INV
        ,SUM(TSL_TC_CASH) AS TSL_TC_CASH
        ,SUM(TSL_TC_GC) AS TSL_TC_GC
        ,TSL_TC_EPS
        ,TSL_TC_TND
        ,TSL_TC_MCD
        ,TSL_TC_VIS
        ,TSL_TC_AMX
        ,TSL_TC_DIN
        ,TSL_TC_JBC
        ,TSL_TC_OC
        ,TSL_MCH
        ,TSL_SRL
        ,SUM(TSL_ZCNT) AS TSL_ZCNT
        ,TSL_TIME
        ,TSL_DTE
    FROM
        (SELECT 
            @branchcode AS BR_CODE
            ,@ncheck AS N_CHECK
            ,@classc AS CLAS_C
            ,@classtrd AS CLAS_TRD_C
            ,@storeno AS STOR_NO
            ,SUM(CAST(NGTOTAL AS DECIMAL(16,2)) + CAST(OGTOTAL AS DECIMAL(16,2))) AS TSL_NEW_A
            ,SUM(CAST(OGTOTAL AS DECIMAL(16,2))) AS TSL_OLD_A
            ,@salestype AS SalesType
            ,SUM(((CAST(SALESREGULAR AS DECIMAL(16,2)) - CAST(SALESVATEXEMPT AS DECIMAL(16,2))) +
                CAST(SALESCD20 AS DECIMAL(16,2)) +
                CAST(SALESCD5 AS DECIMAL(16,2)) +
                CAST(SALEPWD AS DECIMAL(16,2)) +
                CAST(SALESTGOVT AS DECIMAL(16,2)) + 
                CAST(SALESZERORATED AS DECIMAL(16,2)) +
                CAST(DISCREGULARAMT AS DECIMAL(16,2)) +
                CAST(DISCSCD20AMT AS DECIMAL(16,2)) +
                CAST(DISCSCD5AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD20AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD5AMT AS DECIMAL(16,2)) +
                CAST(VOIDTRANAMT AS DECIMAL(16,2)) +
                CAST(ITEMVOIDAMT AS DECIMAL(16,2)) +
                CAST(TICKETRETAMT AS DECIMAL(16,2)) +
                CAST(ITEMRETAMT AS DECIMAL(16,2)))/1.12) + CAST(SALESVATEXEMPT AS DECIMAL(16,2)) AS TSL_DAY_A --SUM(cast(round((cast(TSALES as decimal)/1.12),2) AS DECIMAL(16,2))) AS TSL_DAY_A --Help
            ,SUM(ABS(CAST(DISCREGULARAMT AS DECIMAL(16,2)))) AS TSL_DIS_A
            ,0.00 AS TSL_DIS_B
            ,SUM(CAST(DISCSCD20AMT AS DECIMAL(16,2)) + CAST(DISCSCD5AMT AS DECIMAL(16,2))) AS TSL_DIS_C
            ,0.00 AS TSL_DIS_D
            ,SUM(CAST(DISCSCD20AMT AS DECIMAL(16,2)) + CAST(DISCSCD5AMT AS DECIMAL(16,2))) AS TSL_DIS_E
            ,0.00 AS TSL_Dis_F
            ,0.00 AS TSL_Dis_G
            ,0.00 AS TSL_Dis_H
            ,0.00 AS TSL_Dis_I
            ,0.00 AS TSL_Dis_J
            ,0.00 AS TSL_Dis_K
            ,0.00 AS TSL_Dis_L
            ,SUM(CAST(VATSALEAMT AS DECIMAL(16,2))) AS TSL_TAX_A
            ,0.00 AS TSL_TAX_B
            ,0.00 TSL_ADJ_A
            ,0.00 AS TSL_ADJ_POS
            ,0.00 AS TS_ADJ_NEG
            ,0.00 AS TSL_ADJ_NT_POS
            ,0.00 AS TSL_ADJ_NT_NEG
            ,SUM(CAST(DGROSSSALES AS DECIMAL(16,2)) - CAST(TOTALTAXVALUE AS DECIMAL(16,2))) AS TSL_NET_A --Help
            ,SUM(CAST(VOIDTRANAMT AS DECIMAL(16,2))) AS TSL_VOID
            ,SUM(ABS(CAST(ITEMRETAMT AS DECIMAL(16,2)))) AS TSL_RFND
            ,SUM(((CAST(SALESREGULAR AS DECIMAL(16,2)) + CAST(SALESVATEXEMPT AS DECIMAL(16,2))) +
                CAST(SALESCD20 AS DECIMAL(16,2)) +
                CAST(SALESCD5 AS DECIMAL(16,2)) +
                CAST(SALEPWD AS DECIMAL(16,2)) +
                CAST(SALESTGOVT AS DECIMAL(16,2)) + 
                CAST(SALESZERORATED AS DECIMAL(16,2)) +
                CAST(DISCREGULARAMT AS DECIMAL(16,2)) +
                CAST(DISCSCD20AMT AS DECIMAL(16,2)) +
                CAST(DISCSCD5AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD20AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD5AMT AS DECIMAL(16,2)) +
                CAST(VOIDTRANAMT AS DECIMAL(16,2)) +
                CAST(ITEMVOIDAMT AS DECIMAL(16,2)) +
                CAST(TICKETRETAMT AS DECIMAL(16,2)) +
                CAST(ITEMRETAMT AS DECIMAL(16,2)))) AS TSL_TX_SAL --Help
            ,(CAST(SALESVATEXEMPT AS DECIMAL(16,2)) + (CAST(ZERORATEDSALEAMT AS DECIMAL(16,2)) - CAST(ZERORATEDSALETAXVALUE AS DECIMAL(16,2)))) AS TSL_NX_SAL
            ,SUM(CAST(CCARDATMCHRGONLINEAMT AS DECIMAL(16,2))) AS TSL_CHG --Help
            ,SUM(CAST(TENDERCASHAMT AS DECIMAL(16,2))) AS TSL_CSH
            ,SUM(CAST(OTHTENDERSMGCAMT AS DECIMAL(16,2)) + CAST(OTHTENDERSODEXOAMT AS DECIMAL(16,2))) AS TSL_GC --+ CAST(TENDERCHKAMT AS DECIMAL) AS TSL_GC
            ,0.00 AS TSL_EPS
            ,0.00 AS TSL_TND
            ,0.00 AS TSL_MCRD
            ,0.00 AS TSL_VISA
            ,0.00 AS TSL_AMEX
            ,0.00 AS TSL_DINERS
            ,0.00 AS TSL_JBC
            ,0.00 AS TSL_OTCRD
            ,0.00 AS TSL_SV_CHG
            ,0.00 AS TSL_OT_CHG
            ,SUM(CAST(ABS(BEGSI) AS INT)) AS TSL_FT
            ,SUM(CAST(ABS(LASSI) AS INT)) AS TSL_LT
            ,SUM(CAST((CAST(QTYREGULAR AS DECIMAL(18,2)) + CAST(QTYSCD20 AS DECIMAL(18,2)) + CAST(QTYSCD5 AS DECIMAL(18,2)) + CAST(QTYPWD AS DECIMAL(18,2)) + CAST(QTYTGOVT AS DECIMAL(18,2)) + CAST(QTYZERORATED AS DECIMAL(18,2)) 
                + CAST(QTYVATEXEMPT AS DECIMAL(18,2)) + CAST(DISCREGULARQTY AS DECIMAL(18,2)) + CAST(DISCSCD20QTY AS DECIMAL(18,2)) + CAST(DISCSCD5QTY AS DECIMAL(18,2)) + CAST(DISCPWD20QTY AS DECIMAL(18,2)) 
                + CAST(DISCPWD5QTY AS DECIMAL(18,2)) + CAST(VOIDTRANQTY AS DECIMAL(18,2)) + CAST(ITEMVOIDQTY AS DECIMAL(18,2))*-1 + CAST(TICKETRETQTY AS DECIMAL(18,2))*-1 + CAST(ITEMRETQTY AS DECIMAL(18,2))*-1 
                + CAST(ADDLOANTOTQTY AS DECIMAL(18,2))) AS INT)) AS TSL_NT
            ,SUM(CAST(ABS(BEGSI) AS INT)) AS TSL_BEG_INV
            ,SUM(CAST(ABS(LASSI) AS INT)) AS TSL_END_INV
            ,SUM(CAST(QTYREGULAR AS INT)) as TSL_TC_CASH
            ,SUM(CAST(OTHTENDERSMGCQTY AS INT) + CAST(OTHTENDERSODEXOQTY AS INT)) AS TSL_TC_GC --+ CAST(TENDERCHKQTY AS INT) AS TSL_TC_GC
            ,0 AS TSL_TC_EPS
            ,0 AS TSL_TC_TND
            ,0 AS TSL_TC_MCD
            ,0 AS TSL_TC_VIS
            ,0 AS TSL_TC_AMX
            ,0 AS TSL_TC_DIN
            ,0 AS TSL_TC_JBC
            ,0 AS TSL_TC_OC
            ,@machineno AS TSL_MCH
            ,0 AS TSL_SRL
            ,SUM(CAST(ABS(ZCOUNTER) AS INT)) AS TSL_ZCNT
            --,LEFT(CONVERT(TIME,GETDATE()),8) AS TSL_TIME
            ,RIGHT('00'+RTRIM(CAST(DATEPART(HH,GETDATE())AS VARCHAR(5))),2)+RIGHT('00'+RTRIM(CAST(DATEPART(MI,GETDATE()) AS VARCHAR(5))),2)+RIGHT('00'+RTRIM(CAST(DATEPART(SS,GETDATE()) AS VARCHAR(5))),2) AS TSL_TIME
            --,SUBSTRING(convert(varchar,WorkDate,111),6,2)+'/'+Right(convert(varchar,WorkDate,111),2)+'/'+left(convert(varchar,WorkDate,111),4) AS TSL_DTE
            ,SUBSTRING(convert(varchar,WorkDate,111),6,2)+Right(convert(varchar,WorkDate,111),2)+left(convert(varchar,WorkDate,111),4) AS TSL_DTE
        FROM dbo.TermZTran t
        LEFT JOIN
                (SELECT sLessee, sTenantNumber AS TenantCode, sStoreNumber FROM mLandlordStore) tInfo
            ON CAST(t.STORE AS INT) = CAST(tInfo.sStoreNumber AS INT)
        WHERE CAST(t.Store AS INT) = CAST(@branchcode AS INT) 
            --AND CAST(t.POS AS int) = CAST(@posno AS int)
            AND tInfo.sLessee = @lesseeCode
            AND CONVERT(nvarchar(10),t.WorkDate,101) = @trandate
            --AND CONVERT(nvarchar(10),t.WorkDate,101) = '04/16/2013' --@trandate
        GROUP BY 
            SALESVATEXEMPT
            ,ZERORATEDSALEAMT
            ,ZERORATEDSALETAXVALUE
            ,WorkDate
        ) tFinal
    --WHERE CAST(BR_CODE AS INT) = CAST('0040' AS INT)
    GROUP BY
        BR_CODE
        ,N_CHECK
        ,CLAS_C
        ,CLAS_TRD_C
        ,STOR_NO
        ,TSL_NEW_A
        ,TSL_OLD_A
        ,SalesType
        ,TSL_DAY_A
        ,TSL_DIS_A
        ,TSL_DIS_B
        ,TSL_DIS_C
        ,TSL_DIS_D
        ,TSL_DIS_E
        ,TSL_Dis_F
        ,TSL_Dis_G
        ,TSL_Dis_H
        ,TSL_Dis_I
        ,TSL_Dis_J
        ,TSL_Dis_K
        ,TSL_Dis_L
        ,TSL_TAX_A
        ,TSL_TAX_B
        ,TSL_ADJ_A
        ,TSL_ADJ_POS
        ,TS_ADJ_NEG
        ,TSL_ADJ_NT_POS
        ,TSL_ADJ_NT_NEG
        ,TSL_NET_A
        ,TSL_VOID
        ,TSL_RFND
        ,TSL_TX_SAL
        ,TSL_NX_SAL
        ,TSL_CHG
        ,TSL_CSH
        ,TSL_GC
        ,TSL_EPS
        ,TSL_TND
        ,TSL_MCRD
        ,TSL_VISA
        ,TSL_AMEX
        ,TSL_DINERS
        ,TSL_JBC
        ,TSL_OTCRD
        ,TSL_SV_CHG
        ,TSL_OT_CHG
        ,TSL_FT
        ,TSL_LT
        ,TSL_NT
        ,TSL_BEG_INV
        ,TSL_END_INV
        ,TSL_TC_CASH
        ,TSL_TC_GC
        ,TSL_TC_EPS
        ,TSL_TC_TND
        ,TSL_TC_MCD
        ,TSL_TC_VIS
        ,TSL_TC_AMX
        ,TSL_TC_DIN
        ,TSL_TC_JBC
        ,TSL_TC_OC
        ,TSL_MCH
        ,TSL_SRL
        ,TSL_ZCNT
        ,TSL_TIME
        ,TSL_DTE) dt
GROUP BY
    dt.BR_CODE
    ,dt.CLAS_C
    ,dt.CLAS_TRD_C
    ,dt.N_CHECK
    ,dt.STOR_NO
    ,dt.SalesType
    ,TSL_DAY_A
    ,TSL_DIS_A
    ,TSL_DIS_B
    ,TSL_DIS_C
    ,TSL_DIS_D
    ,TSL_DIS_E
    ,TSL_Dis_F
    ,TSL_Dis_G
    ,TSL_Dis_H
    ,TSL_Dis_I
    ,TSL_Dis_J
    ,TSL_Dis_K
    ,TSL_Dis_L
    ,TSL_TAX_A
    ,TSL_TAX_B
    ,TSL_ADJ_A
    ,TSL_ADJ_POS
    ,TS_ADJ_NEG
    ,TSL_ADJ_NT_POS
    ,TSL_ADJ_NT_NEG
    ,TSL_NET_A
    ,TSL_VOID
    ,TSL_RFND
    ,TSL_TX_SAL
    ,TSL_NX_SAL
    ,TSL_CHG
    ,TSL_CSH
    ,TSL_GC
    ,TSL_EPS
    ,TSL_TND
    ,TSL_MCRD
    ,TSL_VISA
    ,TSL_AMEX
    ,TSL_DINERS
    ,TSL_JBC
    ,TSL_OTCRD
    ,TSL_SV_CHG
    ,TSL_OT_CHG
    ,TSL_FT
    ,TSL_LT
    ,TSL_NT
    ,TSL_BEG_INV
    ,TSL_END_INV
    ,TSL_TC_CASH
    ,TSL_TC_GC
    ,TSL_TC_EPS
    ,TSL_TC_TND
    ,TSL_TC_MCD
    ,TSL_TC_VIS
    ,TSL_TC_AMX
    ,TSL_TC_DIN
    ,TSL_TC_JBC
    ,TSL_TC_OC
    ,TSL_MCH
    ,TSL_SRL
    ,TSL_ZCNT
    ,TSL_TIME
    ,TSL_DTE 
```

这是创建示例表和数据的脚本

```
USE [LandLord]
GO
/****** Object:  Table [dbo].[mLandlordStore]    Script Date: 04/25/2013 20:21:42 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[mLandlordStore](
    [IDNumber] [int] IDENTITY(1,1) NOT NULL,
    [sStoreNumber] [nvarchar](50) NOT NULL,
    [sLessee] [nvarchar](50) NOT NULL,
    [sLesseeNumber] [int] NOT NULL,
    [sHOGenerated] [varchar](1) NOT NULL,
    [LastTranNo] [int] NULL,
    [sSpace] [nvarchar](50) NULL,
    [sMallCode] [nvarchar](20) NULL,
    [sTenantNumber] [nvarchar](20) NULL,
    [sClassCode] [nvarchar](20) NULL,
    [sTradeCode] [nvarchar](20) NULL,
    [sOutletNumber] [nvarchar](20) NULL,
    [nSaleType] [int] NULL,
    [BatchCount] [int] NULL
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
SET IDENTITY_INSERT [dbo].[mLandlordStore] ON
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (1, N'40', N'SMCOIN', 11002558, N'Y', 0, N'01', N'72', N'011002559', N'01', N'SAP', N'03', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (3, N'1033', N'SMCOIN', 103312345, N'Y', 0, N'01', N'73', N'7312345', N'01', N'SAP', N'04', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (4, N'1133', N'ACI', 113312345, N'Y', 0, N'01', N'74', N'7412345', N'01', N'SAP', N'05', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (5, N'1233', N'ALI', 123312345, N'Y', 0, N'01', N'75', N'7512345', N'01', N'SAP', N'06', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (6, N'1333', N'MWC', 133312345, N'Y', 0, N'01', N'76', N'7612345', N'01', N'SAP', N'07', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (7, N'1433', N'OCLP', 143312345, N'Y', 0, N'01', N'77', N'7712345', N'01', N'SAP', N'08', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (8, N'1533', N'RLC', 153312345, N'Y', 0, N'01', N'78', N'7812345', N'01', N'SAP', N'09', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (9, N'1633', N'SLE', 163312345, N'Y', 0, N'01', N'79', N'7912345', N'01', N'SAP', N'10', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (10, N'1733', N'STAR', 173312345, N'Y', 0, N'01', N'80', N'8012345', N'01', N'SAP', N'11', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (11, N'1833', N'WM', 183312345, N'Y', 0, N'01', N'81', N'8112345', N'01', N'SAP', N'12', 1, 0)
INSERT [dbo].[mLandlordStore] ([IDNumber], [sStoreNumber], [sLessee], [sLesseeNumber], [sHOGenerated], [LastTranNo], [sSpace], [sMallCode], [sTenantNumber], [sClassCode], [sTradeCode], [sOutletNumber], [nSaleType], [BatchCount]) VALUES (12, N'1933', N'FSI', 193312345, N'Y', 0, N'01', N'82', N'8212345', N'01', N'SAP', N'13', 1, 0)
SET IDENTITY_INSERT [dbo].[mLandlordStore] OFF
/****** Object:  Default [DF_mLandlordStore_LastTranNo]    Script Date: 04/25/2013 20:21:42 ******/
ALTER TABLE [dbo].[mLandlordStore] ADD  CONSTRAINT [DF_mLandlordStore_LastTranNo]  DEFAULT ((1)) FOR [LastTranNo]
GO

USE [LandLord]
GO
/****** Object:  Table [dbo].[TermZTran]    Script Date: 04/25/2013 20:19:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TermZTran](
    [HeaderID] [uniqueidentifier] NOT NULL,
    [WorkDate] [smalldatetime] NOT NULL,
    [ProcessDate] [smalldatetime] NOT NULL,
    [ProcessMode] [nvarchar](10) NOT NULL,
    [POSCount] [int] NULL,
    [SalePharma] [money] NULL,
    [SaleNonPharma] [money] NULL,
    [VoidAmount] [money] NULL,
    [VoidCount] [int] NULL,
    [ZCOUNTER] [nvarchar](4000) NULL,
    [STORE] [nvarchar](4000) NULL,
    [POS] [nvarchar](4000) NULL,
    [DATE] [nvarchar](300) NULL,
    [TIME] [nvarchar](300) NULL,
    [OGTOTAL] [nvarchar](300) NULL,
    [NGTOTAL] [nvarchar](300) NULL,
    [BEGSI] [nvarchar](300) NULL,
    [LASSI] [nvarchar](300) NULL,
    [TSALES] [nvarchar](300) NULL,
    [QTYREGULAR] [nvarchar](300) NULL,
    [SALESREGULAR] [nvarchar](300) NULL,
    [QTYSCD20] [nvarchar](300) NULL,
    [SALESCD20] [nvarchar](300) NULL,
    [QTYSCD5] [nvarchar](300) NULL,
    [SALESCD5] [nvarchar](300) NULL,
    [QTYPWD] [nvarchar](300) NULL,
    [SALEPWD] [nvarchar](300) NULL,
    [QTYTGOVT] [nvarchar](300) NULL,
    [SALESTGOVT] [nvarchar](300) NULL,
    [QTYZERORATED] [nvarchar](300) NULL,
    [SALESZERORATED] [nvarchar](300) NULL,
    [QTYVATEXEMPT] [nvarchar](300) NULL,
    [SALESVATEXEMPT] [nvarchar](300) NULL,
    [TDISCOUNT] [nvarchar](300) NULL,
    [DISCREGULARQTY] [nvarchar](300) NULL,
    [DISCREGULARAMT] [nvarchar](300) NULL,
    [DISCSCD20QTY] [nvarchar](300) NULL,
    [DISCSCD20AMT] [nvarchar](300) NULL,
    [DISCSCD5QTY] [nvarchar](300) NULL,
    [DISCSCD5AMT] [nvarchar](300) NULL,
    [DISCPWD20QTY] [nvarchar](300) NULL,
    [DISCPWD20AMT] [nvarchar](300) NULL,
    [DISCPWD5QTY] [nvarchar](300) NULL,
    [DISCPWD5AMT] [nvarchar](300) NULL,
    [DNETSALES] [nvarchar](300) NULL,
    [DGROSSSALES] [nvarchar](300) NULL,
    [SALESACCOUNTABILITY] [nvarchar](300) NULL,
    [VOIDTRANQTY] [nvarchar](300) NULL,
    [VOIDTRANAMT] [nvarchar](300) NULL,
    [ITEMVOIDQTY] [nvarchar](300) NULL,
    [ITEMVOIDAMT] [nvarchar](300) NULL,
    [TICKETRETQTY] [nvarchar](300) NULL,
    [TICKETRETAMT] [nvarchar](300) NULL,
    [ITEMRETQTY] [nvarchar](300) NULL,
    [ITEMRETAMT] [nvarchar](300) NULL,
    [ADDLOANTOTQTY] [nvarchar](300) NULL,
    [ADDLOANTOTAMT] [nvarchar](300) NULL,
    [TENDERCASHQTY] [nvarchar](300) NULL,
    [TENDERCASHAMT] [nvarchar](300) NULL,
    [TENDERATMOFFLINEQTY] [nvarchar](300) NULL,
    [TENDERATMOFFLINEAMT] [nvarchar](300) NULL,
    [TENDERCHRGOFFLINEQTY] [nvarchar](300) NULL,
    [TENDERCHRGOFFLINEAMT] [nvarchar](300) NULL,
    [TENDERCHKQTY] [nvarchar](300) NULL,
    [TENDERCHKAMT] [nvarchar](300) NULL,
    [TENDERBDOREBATESQTY] [nvarchar](300) NULL,
    [TENDERBDOREBATESAMT] [nvarchar](300) NULL,
    [OVERTENDERQTY] [nvarchar](300) NULL,
    [OVERTENDERAMT] [nvarchar](300) NULL,
    [OTHERTENDERQTY] [nvarchar](300) NULL,
    [OTHERTENDERAMT] [nvarchar](300) NULL,
    [TENDERCCMQTY] [nvarchar](300) NULL,
    [TENDERCCMAMT] [nvarchar](300) NULL,
    [TENDERARCODQTY] [nvarchar](300) NULL,
    [TENDERARCODAMT] [nvarchar](300) NULL,
    [TENDERADBQTY] [nvarchar](300) NULL,
    [TENDERADBAMT] [nvarchar](300) NULL,
    [TENDERFWV5QTY] [nvarchar](300) NULL,
    [TENDERFWV5AMT] [nvarchar](300) NULL,
    [TENDEREWT1QTY] [nvarchar](300) NULL,
    [TENDEREWT1AMT] [nvarchar](300) NULL,
    [TENDERTOP20KQTY] [nvarchar](300) NULL,
    [TENDERTOP20KAMT] [nvarchar](300) NULL,
    [CCARDATMCHRGONLINEQTY] [nvarchar](300) NULL,
    [CCARDATMCHRGONLINEAMT] [nvarchar](300) NULL,
    [OTHTENDERSMGCQTY] [nvarchar](300) NULL,
    [OTHTENDERSMGCAMT] [nvarchar](300) NULL,
    [OTHTENDERSODEXOQTY] [nvarchar](300) NULL,
    [OTHTENDERSODEXOAMT] [nvarchar](300) NULL,
    [OTHTENDERCORPACCQTY] [nvarchar](300) NULL,
    [OTHTENDERCORPACCAMT] [nvarchar](300) NULL,
    [OTHTENDERDIFFEREDQTY] [nvarchar](300) NULL,
    [OTHTENDERDIFFEREDAMT] [nvarchar](300) NULL,
    [TENDERTOTAL] [nvarchar](300) NULL,
    [VATSALEAMT] [nvarchar](300) NULL,
    [VATSALETAXVALUE] [nvarchar](300) NULL,
    [VATEXSALEAMT] [nvarchar](300) NULL,
    [VATEXSALETAXVALUE] [nvarchar](300) NULL,
    [ZERORATEDSALEAMT] [nvarchar](300) NULL,
    [ZERORATEDSALETAXVALUE] [nvarchar](300) NULL,
    [TOTALAMT] [nvarchar](300) NULL,
    [TOTALTAXVALUE] [nvarchar](300) NULL
) ON [PRIMARY]
GO
INSERT [dbo].[TermZTran] ([HeaderID], [WorkDate], [ProcessDate], [ProcessMode], [POSCount], [SalePharma], [SaleNonPharma], [VoidAmount], [VoidCount], [ZCOUNTER], [STORE], [POS], [DATE], [TIME], [OGTOTAL], [NGTOTAL], [BEGSI], [LASSI], [TSALES], [QTYREGULAR], [SALESREGULAR], [QTYSCD20], [SALESCD20], [QTYSCD5], [SALESCD5], [QTYPWD], [SALEPWD], [QTYTGOVT], [SALESTGOVT], [QTYZERORATED], [SALESZERORATED], [QTYVATEXEMPT], [SALESVATEXEMPT], [TDISCOUNT], [DISCREGULARQTY], [DISCREGULARAMT], [DISCSCD20QTY], [DISCSCD20AMT], [DISCSCD5QTY], [DISCSCD5AMT], [DISCPWD20QTY], [DISCPWD20AMT], [DISCPWD5QTY], [DISCPWD5AMT], [DNETSALES], [DGROSSSALES], [SALESACCOUNTABILITY], [VOIDTRANQTY], [VOIDTRANAMT], [ITEMVOIDQTY], [ITEMVOIDAMT], [TICKETRETQTY], [TICKETRETAMT], [ITEMRETQTY], [ITEMRETAMT], [ADDLOANTOTQTY], [ADDLOANTOTAMT], [TENDERCASHQTY], [TENDERCASHAMT], [TENDERATMOFFLINEQTY], [TENDERATMOFFLINEAMT], [TENDERCHRGOFFLINEQTY], [TENDERCHRGOFFLINEAMT], [TENDERCHKQTY], [TENDERCHKAMT], [TENDERBDOREBATESQTY], [TENDERBDOREBATESAMT], [OVERTENDERQTY], [OVERTENDERAMT], [OTHERTENDERQTY], [OTHERTENDERAMT], [TENDERCCMQTY], [TENDERCCMAMT], [TENDERARCODQTY], [TENDERARCODAMT], [TENDERADBQTY], [TENDERADBAMT], [TENDERFWV5QTY], [TENDERFWV5AMT], [TENDEREWT1QTY], [TENDEREWT1AMT], [TENDERTOP20KQTY], [TENDERTOP20KAMT], [CCARDATMCHRGONLINEQTY], [CCARDATMCHRGONLINEAMT], [OTHTENDERSMGCQTY], [OTHTENDERSMGCAMT], [OTHTENDERSODEXOQTY], [OTHTENDERSODEXOAMT], [OTHTENDERCORPACCQTY], [OTHTENDERCORPACCAMT], [OTHTENDERDIFFEREDQTY], [OTHTENDERDIFFEREDAMT], [TENDERTOTAL], [VATSALEAMT], [VATSALETAXVALUE], [VATEXSALEAMT], [VATEXSALETAXVALUE], [ZERORATEDSALEAMT], [ZERORATEDSALETAXVALUE], [TOTALAMT], [TOTALTAXVALUE]) VALUES (N'35a9637c-4342-4cb4-8f10-1c1d52b09cd4', CAST(0xA1A20000 AS SmallDateTime), CAST(0xA1A80478 AS SmallDateTime), N'sqljob', 1, 0.0000, 0.0000, 0.0000, 0, N'0001', N'0040', N'001', N'16/04/2013', N'19:06', N'0.00', N'73420.22', N'0000000001', N'0000000078', N'69827.81', N'75', N'48543.85', N'7', N'15683.96', N'4', N'940.00', N'6', N'4520.00', N'0', N'0.00', N'0', N'0.00', N'1', N'140.00', N'8283.98', N'30', N'4361.04', N'7', N'3136.79', N'4', N'41.96', N'3', N'723.21', N'3', N'20.98', N'56502.49', N'73420.22', N'61760.30', N'3', N'5815.95', N'-33', N'-1282.50', N'-14', N'-5886.00', N'-151', N'-3923.18', N'2', N'6000.00', N'68', N'46045.65', N'1', N'67.50', N'3', N'751.75', N'1', N'3200.00', N'2', N'310.82', N'2', N'-3.00', N'3', N'0.03', N'0', N'0.00', N'0', N'0.00', N'0', N'0', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'11', N'9096.12', N'5', N'800.00', N'5', N'450.00', N'1', N'1041.43', N'0', N'0.00', N'61760.30', N'43815.32', N'5257.81', N'15823.96', N'0.00', N'0.00', N'0.00', N'59639.28', N'5257.81')
INSERT [dbo].[TermZTran] ([HeaderID], [WorkDate], [ProcessDate], [ProcessMode], [POSCount], [SalePharma], [SaleNonPharma], [VoidAmount], [VoidCount], [ZCOUNTER], [STORE], [POS], [DATE], [TIME], [OGTOTAL], [NGTOTAL], [BEGSI], [LASSI], [TSALES], [QTYREGULAR], [SALESREGULAR], [QTYSCD20], [SALESCD20], [QTYSCD5], [SALESCD5], [QTYPWD], [SALEPWD], [QTYTGOVT], [SALESTGOVT], [QTYZERORATED], [SALESZERORATED], [QTYVATEXEMPT], [SALESVATEXEMPT], [TDISCOUNT], [DISCREGULARQTY], [DISCREGULARAMT], [DISCSCD20QTY], [DISCSCD20AMT], [DISCSCD5QTY], [DISCSCD5AMT], [DISCPWD20QTY], [DISCPWD20AMT], [DISCPWD5QTY], [DISCPWD5AMT], [DNETSALES], [DGROSSSALES], [SALESACCOUNTABILITY], [VOIDTRANQTY], [VOIDTRANAMT], [ITEMVOIDQTY], [ITEMVOIDAMT], [TICKETRETQTY], [TICKETRETAMT], [ITEMRETQTY], [ITEMRETAMT], [ADDLOANTOTQTY], [ADDLOANTOTAMT], [TENDERCASHQTY], [TENDERCASHAMT], [TENDERATMOFFLINEQTY], [TENDERATMOFFLINEAMT], [TENDERCHRGOFFLINEQTY], [TENDERCHRGOFFLINEAMT], [TENDERCHKQTY], [TENDERCHKAMT], [TENDERBDOREBATESQTY], [TENDERBDOREBATESAMT], [OVERTENDERQTY], [OVERTENDERAMT], [OTHERTENDERQTY], [OTHERTENDERAMT], [TENDERCCMQTY], [TENDERCCMAMT], [TENDERARCODQTY], [TENDERARCODAMT], [TENDERADBQTY], [TENDERADBAMT], [TENDERFWV5QTY], [TENDERFWV5AMT], [TENDEREWT1QTY], [TENDEREWT1AMT], [TENDERTOP20KQTY], [TENDERTOP20KAMT], [CCARDATMCHRGONLINEQTY], [CCARDATMCHRGONLINEAMT], [OTHTENDERSMGCQTY], [OTHTENDERSMGCAMT], [OTHTENDERSODEXOQTY], [OTHTENDERSODEXOAMT], [OTHTENDERCORPACCQTY], [OTHTENDERCORPACCAMT], [OTHTENDERDIFFEREDQTY], [OTHTENDERDIFFEREDAMT], [TENDERTOTAL], [VATSALEAMT], [VATSALETAXVALUE], [VATEXSALEAMT], [VATEXSALETAXVALUE], [ZERORATEDSALEAMT], [ZERORATEDSALETAXVALUE], [TOTALAMT], [TOTALTAXVALUE]) VALUES (N'35a9637c-4342-4cb4-8f10-1c1d52b09cd4', CAST(0xA1A20000 AS SmallDateTime), CAST(0xA1A80478 AS SmallDateTime), N'sqljob', 2, 0.0000, 0.0000, 0.0000, 0, N'0001', N'0040', N'002', N'16/04/2013', N'19:06', N'0.00', N'60296.14', N'0000000001', N'0000000076', N'58336.24', N'61', N'44770.01', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'7', N'4597.00', N'15', N'8269.23', N'4', N'700.00', N'3890.95', N'17', N'3890.95', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'49572.91', N'60296.14', N'54445.29', N'2', N'186.00', N'-133', N'-3567.50', N'-7', N'-6661.50', N'-90', N'-2085.50', N'2', N'6000.00', N'66', N'39251.01', N'1', N'67.50', N'1', N'149.00', N'0', N'0.00', N'0', N'0.00', N'3', N'-22.68', N'10', N'3989.88', N'0', N'0.00', N'0', N'0.00', N'0', N'0', N'11', N'205.23', N'11', N'41.05', N'13', N'41.05', N'8', N'4323.75', N'9', N'2500.00', N'1', N'100.00', N'2', N'3799.50', N'0', N'0.00', N'54445.29', N'40603.68', N'4872.38', N'700.00', N'0.00', N'8269.23', N'0.00', N'49572.91', N'4872.38')
INSERT [dbo].[TermZTran] ([HeaderID], [WorkDate], [ProcessDate], [ProcessMode], [POSCount], [SalePharma], [SaleNonPharma], [VoidAmount], [VoidCount], [ZCOUNTER], [STORE], [POS], [DATE], [TIME], [OGTOTAL], [NGTOTAL], [BEGSI], [LASSI], [TSALES], [QTYREGULAR], [SALESREGULAR], [QTYSCD20], [SALESCD20], [QTYSCD5], [SALESCD5], [QTYPWD], [SALEPWD], [QTYTGOVT], [SALESTGOVT], [QTYZERORATED], [SALESZERORATED], [QTYVATEXEMPT], [SALESVATEXEMPT], [TDISCOUNT], [DISCREGULARQTY], [DISCREGULARAMT], [DISCSCD20QTY], [DISCSCD20AMT], [DISCSCD5QTY], [DISCSCD5AMT], [DISCPWD20QTY], [DISCPWD20AMT], [DISCPWD5QTY], [DISCPWD5AMT], [DNETSALES], [DGROSSSALES], [SALESACCOUNTABILITY], [VOIDTRANQTY], [VOIDTRANAMT], [ITEMVOIDQTY], [ITEMVOIDAMT], [TICKETRETQTY], [TICKETRETAMT], [ITEMRETQTY], [ITEMRETAMT], [ADDLOANTOTQTY], [ADDLOANTOTAMT], [TENDERCASHQTY], [TENDERCASHAMT], [TENDERATMOFFLINEQTY], [TENDERATMOFFLINEAMT], [TENDERCHRGOFFLINEQTY], [TENDERCHRGOFFLINEAMT], [TENDERCHKQTY], [TENDERCHKAMT], [TENDERBDOREBATESQTY], [TENDERBDOREBATESAMT], [OVERTENDERQTY], [OVERTENDERAMT], [OTHERTENDERQTY], [OTHERTENDERAMT], [TENDERCCMQTY], [TENDERCCMAMT], [TENDERARCODQTY], [TENDERARCODAMT], [TENDERADBQTY], [TENDERADBAMT], [TENDERFWV5QTY], [TENDERFWV5AMT], [TENDEREWT1QTY], [TENDEREWT1AMT], [TENDERTOP20KQTY], [TENDERTOP20KAMT], [CCARDATMCHRGONLINEQTY], [CCARDATMCHRGONLINEAMT], [OTHTENDERSMGCQTY], [OTHTENDERSMGCAMT], [OTHTENDERSODEXOQTY], [OTHTENDERSODEXOAMT], [OTHTENDERCORPACCQTY], [OTHTENDERCORPACCAMT], [OTHTENDERDIFFEREDQTY], [OTHTENDERDIFFEREDAMT], [TENDERTOTAL], [VATSALEAMT], [VATSALETAXVALUE], [VATEXSALEAMT], [VATEXSALETAXVALUE], [ZERORATEDSALEAMT], [ZERORATEDSALETAXVALUE], [TOTALAMT], [TOTALTAXVALUE]) VALUES (N'35a9637c-4342-4cb4-8f10-1c1d52b09cd4', CAST(0xA1A20000 AS SmallDateTime), CAST(0xA1A80478 AS SmallDateTime), N'sqljob', 3, 0.0000, 0.0000, 0.0000, 0, N'0001', N'0040', N'003', N'16/04/2013', N'19:06', N'0.00', N'0.00', N'0000000000', N'0000000000', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0.00', N'0.00', N'0.00', N'1', N'0.01', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0', N'0.00', N'0.00', N'0.00', N'0.00', N'0.00', N'0.00', N'0.00', N'0.00', N'0.00', N'0.00') 
```

请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:50:47.707

你有很奇怪的数据模式。您是否尝试将数值存储为十进制而不是 nvarchar。可能这可能会有所帮助-

```
SELECT BR_CODE
    ,N_CHECK
    ,CLAS_C
    ,CLAS_TRD_C
    ,STOR_NO
    ,SUM(TSL_NEW_A) AS TSL_NEW_A
    ,SUM(TSL_OLD_A) AS TSL_OLD_A
    ,SalesType
    ,SUM(TSL_DAY_A) AS TSL_DAY_A
    ,SUM(TSL_DIS_A) AS TSL_DIS_A
    ,TSL_DIS_B = 0
    ,SUM(TSL_DIS_C) AS TSL_DIS_C
    ,TSL_DIS_D = 0
    ,SUM(TSL_DIS_E) AS TSL_DIS_E
    ,TSL_Dis_F = 0
    ,TSL_Dis_G = 0
    ,TSL_Dis_H = 0
    ,TSL_Dis_I = 0
    ,TSL_Dis_J = 0
    ,TSL_Dis_K = 0
    ,TSL_Dis_L = 0
    ,SUM(TSL_TAX_A) AS TSL_TAX_A
    ,TSL_TAX_B = 0
    ,TSL_ADJ_A = 0
    ,TSL_ADJ_POS = 0
    ,TS_ADJ_NEG = 0
    ,TSL_ADJ_NT_POS = 0
    ,TSL_ADJ_NT_NEG = 0
    ,SUM(TSL_NET_A) AS TSL_NET_A
    ,SUM(TSL_VOID) AS TSL_VOID
    ,SUM(TSL_RFND) AS TSL_RFND
    ,SUM(TSL_TX_SAL) AS TSL_TX_SAL
    ,SUM(TSL_NX_SAL) AS TSL_NX_SAL
    ,TSL_CHG
    ,SUM(TSL_CSH) AS TSL_CSH
    ,SUM(TSL_GC) AS TSL_GC
    ,TSL_EPS = 0
    ,TSL_TND = 0
    ,TSL_MCRD = 0
    ,TSL_VISA = 0
    ,TSL_AMEX = 0
    ,TSL_DINERS = 0
    ,TSL_JBC = 0
    ,TSL_OTCRD = 0
    ,TSL_SV_CHG = 0
    ,TSL_OT_CHG = 0
    ,SUM(TSL_FT) AS TSL_FT
    ,SUM(TSL_LT) AS TSL_LT
    ,SUM(TSL_NT) AS TSL_NT
    ,SUM(TSL_BEG_INV) AS TSL_BEG_INV
    ,SUM(TSL_END_INV) AS TSL_END_INV
    ,SUM(TSL_TC_CASH) AS TSL_TC_CASH
    ,SUM(TSL_TC_GC) AS TSL_TC_GC
    ,TSL_TC_EPS = 0
    ,TSL_TC_TND = 0
    ,TSL_TC_MCD = 0
    ,TSL_TC_VIS = 0
    ,TSL_TC_AMX = 0
    ,TSL_TC_DIN = 0
    ,TSL_TC_JBC = 0
    ,TSL_TC_OC = 0
    ,TSL_MCH = 0
    ,TSL_SRL = 0
    ,SUM(TSL_ZCNT) AS TSL_ZCNT
    ,TSL_TIME
    ,TSL_DTE
FROM(
    SELECT
          BR_CODE
        , N_CHECK
        , CLAS_C
        , CLAS_TRD_C
        , STOR_NO
        , SUM(TSL_NEW_A) AS TSL_NEW_A
        , SUM(TSL_OLD_A) AS TSL_OLD_A
        , SalesType
        , SUM(TSL_DAY_A) AS TSL_DAY_A
        , SUM(TSL_DIS_A) AS TSL_DIS_A
        , SUM(TSL_DIS_C) AS TSL_DIS_C
        , SUM(TSL_DIS_E) AS TSL_DIS_E
        , SUM(TSL_TAX_A) AS TSL_TAX_A
        , SUM(TSL_NET_A) AS TSL_NET_A
        , SUM(TSL_VOID) AS TSL_VOID
        , SUM(TSL_RFND) AS TSL_RFND
        , SUM(TSL_TX_SAL) AS TSL_TX_SAL
        , SUM(TSL_NX_SAL) AS TSL_NX_SAL
        , TSL_CHG
        , SUM(TSL_CSH) AS TSL_CSH
        , SUM(TSL_GC) AS TSL_GC
        , SUM(TSL_FT) AS TSL_FT
        , SUM(TSL_LT) AS TSL_LT
        , SUM(TSL_NT) AS TSL_NT
        , SUM(TSL_BEG_INV) AS TSL_BEG_INV
        , SUM(TSL_END_INV) AS TSL_END_INV
        , SUM(TSL_TC_CASH) AS TSL_TC_CASH
        , SUM(TSL_TC_GC) AS TSL_TC_GC
        , SUM(TSL_ZCNT) AS TSL_ZCNT
        , TSL_TIME
        , TSL_DTE
    FROM (
        SELECT 
              BR_CODE = 0
            , N_CHECK = 0
            , CLAS_C = 0
            , CLAS_TRD_C = 0
            , STOR_NO = 0
            , TSL_NEW_A = SUM(CAST(NGTOTAL AS DECIMAL(16,2)) + CAST(OGTOTAL AS DECIMAL(16,2))) 
            , TSL_OLD_A = SUM(CAST(OGTOTAL AS DECIMAL(16,2))) 
            , SalesType = 0
            , SUM(((CAST(SALESREGULAR AS DECIMAL(16,2)) - CAST(SALESVATEXEMPT AS DECIMAL(16,2))) +
                CAST(SALESCD20 AS DECIMAL(16,2)) +
                CAST(SALESCD5 AS DECIMAL(16,2)) +
                CAST(SALEPWD AS DECIMAL(16,2)) +
                CAST(SALESTGOVT AS DECIMAL(16,2)) + 
                CAST(SALESZERORATED AS DECIMAL(16,2)) +
                CAST(DISCREGULARAMT AS DECIMAL(16,2)) +
                CAST(DISCSCD20AMT AS DECIMAL(16,2)) +
                CAST(DISCSCD5AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD20AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD5AMT AS DECIMAL(16,2)) +
                CAST(VOIDTRANAMT AS DECIMAL(16,2)) +
                CAST(ITEMVOIDAMT AS DECIMAL(16,2)) +
                CAST(TICKETRETAMT AS DECIMAL(16,2)) +
                CAST(ITEMRETAMT AS DECIMAL(16,2)))/1.12) + CAST(SALESVATEXEMPT AS DECIMAL(16,2)) AS TSL_DAY_A --SUM(cast(round((cast(TSALES as decimal)/1.12),2) AS DECIMAL(16,2))) AS TSL_DAY_A --Help
            ,SUM(ABS(CAST(DISCREGULARAMT AS DECIMAL(16,2)))) AS TSL_DIS_A
            ,SUM(CAST(DISCSCD20AMT AS DECIMAL(16,2)) + CAST(DISCSCD5AMT AS DECIMAL(16,2))) AS TSL_DIS_C
            ,SUM(CAST(DISCSCD20AMT AS DECIMAL(16,2)) + CAST(DISCSCD5AMT AS DECIMAL(16,2))) AS TSL_DIS_E
            ,SUM(CAST(VATSALEAMT AS DECIMAL(16,2))) AS TSL_TAX_A
            ,SUM(CAST(DGROSSSALES AS DECIMAL(16,2)) - CAST(TOTALTAXVALUE AS DECIMAL(16,2))) AS TSL_NET_A --Help
            ,SUM(CAST(VOIDTRANAMT AS DECIMAL(16,2))) AS TSL_VOID
            ,SUM(ABS(CAST(ITEMRETAMT AS DECIMAL(16,2)))) AS TSL_RFND
            ,SUM(((CAST(SALESREGULAR AS DECIMAL(16,2)) + CAST(SALESVATEXEMPT AS DECIMAL(16,2))) +
                CAST(SALESCD20 AS DECIMAL(16,2)) +
                CAST(SALESCD5 AS DECIMAL(16,2)) +
                CAST(SALEPWD AS DECIMAL(16,2)) +
                CAST(SALESTGOVT AS DECIMAL(16,2)) + 
                CAST(SALESZERORATED AS DECIMAL(16,2)) +
                CAST(DISCREGULARAMT AS DECIMAL(16,2)) +
                CAST(DISCSCD20AMT AS DECIMAL(16,2)) +
                CAST(DISCSCD5AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD20AMT AS DECIMAL(16,2)) +
                CAST(DISCPWD5AMT AS DECIMAL(16,2)) +
                CAST(VOIDTRANAMT AS DECIMAL(16,2)) +
                CAST(ITEMVOIDAMT AS DECIMAL(16,2)) +
                CAST(TICKETRETAMT AS DECIMAL(16,2)) +
                CAST(ITEMRETAMT AS DECIMAL(16,2)))) AS TSL_TX_SAL --Help
            ,(CAST(SALESVATEXEMPT AS DECIMAL(16,2)) + (CAST(ZERORATEDSALEAMT AS DECIMAL(16,2)) - CAST(ZERORATEDSALETAXVALUE AS DECIMAL(16,2)))) AS TSL_NX_SAL
            ,SUM(CAST(CCARDATMCHRGONLINEAMT AS DECIMAL(16,2))) AS TSL_CHG --Help
            ,SUM(CAST(TENDERCASHAMT AS DECIMAL(16,2))) AS TSL_CSH
            ,SUM(CAST(OTHTENDERSMGCAMT AS DECIMAL(16,2)) + CAST(OTHTENDERSODEXOAMT AS DECIMAL(16,2))) AS TSL_GC --+ CAST(TENDERCHKAMT AS DECIMAL) AS TSL_GC
            ,SUM(CAST(ABS(BEGSI) AS INT)) AS TSL_FT
            ,SUM(CAST(ABS(LASSI) AS INT)) AS TSL_LT
            ,SUM(CAST((CAST(QTYREGULAR AS DECIMAL(18,2)) + CAST(QTYSCD20 AS DECIMAL(18,2)) + CAST(QTYSCD5 AS DECIMAL(18,2)) + CAST(QTYPWD AS DECIMAL(18,2)) + CAST(QTYTGOVT AS DECIMAL(18,2)) + CAST(QTYZERORATED AS DECIMAL(18,2)) 
                + CAST(QTYVATEXEMPT AS DECIMAL(18,2)) + CAST(DISCREGULARQTY AS DECIMAL(18,2)) + CAST(DISCSCD20QTY AS DECIMAL(18,2)) + CAST(DISCSCD5QTY AS DECIMAL(18,2)) + CAST(DISCPWD20QTY AS DECIMAL(18,2)) 
                + CAST(DISCPWD5QTY AS DECIMAL(18,2)) + CAST(VOIDTRANQTY AS DECIMAL(18,2)) + CAST(ITEMVOIDQTY AS DECIMAL(18,2))*-1 + CAST(TICKETRETQTY AS DECIMAL(18,2))*-1 + CAST(ITEMRETQTY AS DECIMAL(18,2))*-1 
                + CAST(ADDLOANTOTQTY AS DECIMAL(18,2))) AS INT)) AS TSL_NT
            ,SUM(CAST(ABS(BEGSI) AS INT)) AS TSL_BEG_INV
            ,SUM(CAST(ABS(LASSI) AS INT)) AS TSL_END_INV
            ,SUM(CAST(QTYREGULAR AS INT)) as TSL_TC_CASH
            ,SUM(CAST(OTHTENDERSMGCQTY AS INT) + CAST(OTHTENDERSODEXOQTY AS INT)) AS TSL_TC_GC
            ,SUM(CAST(ABS(ZCOUNTER) AS INT)) AS TSL_ZCNT
            ,RIGHT('00'+RTRIM(CAST(DATEPART(HH,GETDATE())AS VARCHAR(5))),2)+RIGHT('00'+RTRIM(CAST(DATEPART(MI,GETDATE()) AS VARCHAR(5))),2)+RIGHT('00'+RTRIM(CAST(DATEPART(SS,GETDATE()) AS VARCHAR(5))),2) AS TSL_TIME
            ,SUBSTRING(convert(varchar,WorkDate,111),6,2)+Right(convert(varchar,WorkDate,111),2)+left(convert(varchar,WorkDate,111),4) AS TSL_DTE
        FROM dbo.TermZTran t
        LEFT JOIN (
            SELECT sLessee, sTenantNumber AS TenantCode, sStoreNumber 
            FROM mLandlordStore
        ) tInfo ON t.STORE = tInfo.sStoreNumber
        WHERE CAST(t.Store AS INT) = CAST(@branchcode AS INT) 
            AND tInfo.sLessee = @lesseeCode
            AND CONVERT(nvarchar(10),t.WorkDate,101) = @trandate
            AND CONVERT(nvarchar(10),t.WorkDate,101) = '04/16/2013'
            AND CAST(BR_CODE AS INT) = CAST('0040' AS INT)
        GROUP BY 
              SALESVATEXEMPT
            , ZERORATEDSALEAMT
            , ZERORATEDSALETAXVALUE
            , WorkDate
) tFinal
GROUP BY
        BR_CODE
        ,N_CHECK
        ,CLAS_C
        ,CLAS_TRD_C
        ,STOR_NO
        ,TSL_NEW_A
        ,TSL_OLD_A
        ,SalesType
        ,TSL_DAY_A
        ,TSL_DIS_A
        ,TSL_DIS_C
        ,TSL_DIS_E
        ,TSL_TAX_A
        ,TSL_NET_A
        ,TSL_VOID
        ,TSL_RFND
        ,TSL_TX_SAL
        ,TSL_NX_SAL
        ,TSL_CHG
        ,TSL_CSH
        ,TSL_GC
        ,TSL_FT
        ,TSL_LT
        ,TSL_NT
        ,TSL_BEG_INV
        ,TSL_END_INV
        ,TSL_TC_CASH
        ,TSL_TC_GC
        ,TSL_ZCNT
        ,TSL_TIME
        ,TSL_DTE
) dt
GROUP BY
    dt.BR_CODE
    ,dt.CLAS_C
    ,dt.CLAS_TRD_C
    ,dt.N_CHECK
    ,dt.STOR_NO
    ,dt.SalesType
    ,TSL_DAY_A
    ,TSL_DIS_A
    ,TSL_DIS_C
    ,TSL_DIS_E
    ,TSL_TAX_A
    ,TSL_NET_A
    ,TSL_VOID
    ,TSL_RFND
    ,TSL_TX_SAL
    ,TSL_NX_SAL
    ,TSL_CHG
    ,TSL_CSH
    ,TSL_GC
    ,TSL_FT
    ,TSL_LT
    ,TSL_NT
    ,TSL_BEG_INV
    ,TSL_END_INV
    ,TSL_TC_CASH
    ,TSL_TC_GC
    ,TSL_ZCNT
    ,TSL_TIME
    ,TSL_DTE 
```

# c# - 如何改进 Linq-To-Sql 代码

> ID：16214570
> 
> 赞同：1
> 
> 时间：2013-04-25T12:19:13.977
> 
> 标签：c#, sql, linq-to-sql, profiling, mvc-mini-profiler

使用`StackExchange.Profiling.MiniProfiler`该类以将 Linq-To-Sql 用作 ORM 来分析 ASP.NET MVC 应用程序。

我正在尝试将一项操作减少为一个 SQL，以便不再有任何重复项。所以我相应地更改了我的 linq-to-sql 代码，但它对速度没有任何积极影响。

然后我检查了 SQL 所需的时间。

这显示了 MiniProfiler：

![在此处输入图像描述](https://i.stack.imgur.com/4Gg0d.png)

当我在 Management Studio 中启动完全相同的 SQL 时，它的速度非常快：

![在此处输入图像描述](https://i.stack.imgur.com/ZQTnr.png)

这是代码：

```
from t in type
let tDoc = (from d in context.documents
            where d.Key == t.No
            && d.RType == (int)RType.Art
            && d.AType == (int)AType.Doc
            select d).FirstOrDefault(d => d.UseForThumb)
select new Time
{
    Id = t.Id,
    //... more simple mappings here
    // then a complex one:
    DocsCount = context.documents.Count(d =>
        (d.Key == t.Id.ToString()
        && d.RType == (int)RType.Type
        && d.AType == (int)AType.Doc)
        ||
        (d.Key == t.No
        && d.RType == (int)RType.Art
        && d.AType == (int)AType.Doc)),

    // and another one
    ThumbId = (tDoc != null && tDoc.FRKey.HasValue) ? tDoc.FRKey.Value : 0
}; 
```

造成巨大差异的原因是什么？-**编辑**：没有区别，我只是误解了 SSMS :(

无论如何，我的问题仍然存在。我可以改变什么以使其更快？

我有时读到 Linq-To-Sql 的映射存在性能问题。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T07:54:31.897

我做了一些试验和错误，并将 Linq-To-Sql 代码更改为：

```
from t in types
let docs = context.documents.Where(d => (d.RKey == t.Id.ToString()
                                     && d.RType == (int)RType.Type
                                     && d.AType == (int)AType.Doc)
                                   ||
                                        (d.RKey == t.No 
                                     && d.RType == (int)RType.Art 
                                     && d.AType == (int)AType.Doc))
let tDoc = docs.FirstOrDefault(d => d.RType == (int)RType.Art && d.UseForThumb)
let docsCount = docs.Count()
select new Time
{                                               
  Id = t.Id,
  //... more simple mappings here
  DocsCount = docsCount,
  ThumbId = (tDoc != null && tDoc.FRKey.HasValue) ? tDoc.FRKey.Value : 0,
} 
```

这使得查询快得多。

# android - 在本地和 url 路径中播放视频时出现问题

> ID：16214571
> 
> 赞同：1
> 
> 时间：2013-04-25T12:19:15.493
> 
> 标签：android

我在 VideoView 中播放视频

当我从 SD 卡播放时，它全屏显示正确的宽度和高度。当我尝试从服务器播放时，视频宽度更小并且视频被重新调整大小。

如何以原始尺寸和全屏播放视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:53:20.063

查看[文档](http://developer.android.com/guide/topics/media/mediaplayer.html)并实现 onPrepared 方法，如以下代码：

```
//prepare the video
public void onPrepared(MediaPlayer mp) {        
    progressBarWait.setVisibility(View.GONE);

    //First get the size of the video
    int videoWidth = player.getVideoWidth();
    int videoHeight = player.getVideoHeight();
    float videoProportion = (float) videoWidth / (float) videoHeight;  

    //get the size of the screen
    int screenWidth = getWindowManager().getDefaultDisplay().getWidth();
    int screenHeight = getWindowManager().getDefaultDisplay().getHeight();
    float screenProportion = (float) screenWidth / (float) screenHeight;

    //Adjust
    LayoutParams lp = surfaceViewFrame.getLayoutParams();
    if (videoProportion > screenProportion) {
        lp.width = screenWidth;
        lp.height = (int) ((float) screenWidth / videoProportion);
    } else {
        lp.width = (int) (videoProportion * (float) screenHeight);
        lp.height = screenHeight;
    }
    surfaceViewFrame.setLayoutParams(lp);

    if (!player.isPlaying()) {
        player.start();         
    }
    surfaceViewFrame.setClickable(true);
} 
```

# c# - 使用 c# 在 mvc 中显示基本年龄助手

> ID：16214572
> 
> 赞同：-3
> 
> 时间：2013-04-25T12:19:15.820
> 
> 标签：c#, asp.net-mvc, razor

如何使用 c# 在 mvc 中实现基本的年龄显示助手。我现在被我的代码困住了，需要一些帮助。有人可以提供快速帮助。

谢谢

我的代码

```
@Html.DisplayFor(Model.Dob.Value) 
```

然而，这只是以日期时间格式显示 dob。我正在考虑做

```
var newDate = DateTime.Now.Subtract(Model.Dob.Value)
@Html.Display(newDate) 
```

但我想作为帮手做这个，而不是重复这个。

请帮助可怜的学生......哈哈哈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:39:48.930

这将为 DateTime 创建一个扩展方法来计算一个人的年龄：

```
public static class DateTimeUtil
{
    public static int YearsOld(this DateTime date)
    {
        DateTime now = DateTime.Now;
        var difference = now - date;
        return difference.Days / 365;
    }
} 
```

它可以通过以下方式调用：

```
Model.Dob.Value.YearsOld() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:29:35.037

您可以在 helpers 文件夹中构建一个辅助函数。这将包含您的 DOB，然后您可以对其进行格式化以输出一些字符串。

例如

```
public string (this HtmlHelper helper, DateTime dob){
   //do your formatting
   return result;
} 
```

这是我博客的链接，可能更有用。我在我的项目中使用了一个类似的。[年龄显示教程](http://mvctutorialsandguides.blogspot.co.nz/2013/04/mvc-c-age-display-helper-for-formatting.html)

干杯。

# vb.net - SAP 使用 RFC_CALL_TRANSACTION RFC VB 捕获数据

> ID：16214573
> 
> 赞同：0
> 
> 时间：2013-04-25T12:19:18.110
> 
> 标签：vb.net, saprfc

我变成了一个错误代码 1001，一个 SAP Remote 错误？

我用谷歌搜索了很多，但没有找到任何东西。也许有人知道这里的问题是什么。我使用 SAP 720。

> System.Runtime.InteropServices.COMException (0x000003E9): SAP Remote Function Call bei Microsoft.VisualBasic.CompilerServices.LateBinding.LateGet(Object o, Type objType, String name, Object[] args, String[] paramnames, Boolean[] CopyBack) bei Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateGet(Object Instance, Type Type, String MemberName, Object[] Arguments, String[] ArgumentNames, Type[] TypeArguments, Boolean[] CopyBack) ...

这是我的代码：

```
 Public FunctionCtrl As Object
    Function login_Call()
    Try

        Dim conn As Object
        FunctionCtrl = CreateObject("SAP.Functions")
        conn = FunctionCtrl.Connection

        conn.System = XXX
        conn.ApplicationServer = XXX
        conn.SystemNumber = XXX
        conn.Client = "XXX"
        conn.user = XXX
        conn.Password = XXX
        conn.Language = XXX
        'needed for frontend dialog
        conn.RfcWithDialog = True

        'log on with logon dialog
        If Not conn.Logon(0, 1) Then
            Dim WsShell
            Dim intText As Integer
            WsShell = CreateObject("WScript.Shell")
            intText = WsShell.Popup("Logon not succesful." & vbCrLf & _
                               "will be closed automatically in one minute...", 60)
            'conn = Nothing
            Anmeldung_Call = False
            Exit Function
        End If
        Anmeldung_Call = True

    Catch ex As Exception

        Anmeldung_Call = False
    End Try
    Me.Text = DateTime.Now.ToString()
End Function

Sub Open_IW73()
    Dim BdcTable As Object
    Dim RfcCallTransaction As Object
    Dim Messages As Object
    Dim count As Integer

    'call transaction IW73
    RfcCallTransaction = FunctionCtrl.Add("RFC_CALL_TRANSACTION")
    RfcCallTransaction.Exports("TRANCODE") = "IW73"
    RfcCallTransaction.Exports("UPDMODE") = "S"
    BdcTable = RfcCallTransaction.Tables("BDCTABLE")..... 
```

**错误出现在这一行：“RfcCallTransaction = FunctionCtrl.Add("RFC_CALL_TRANSACTION")”**

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T04:24:25.783

我有同样的错误。人们提出了不同的修复方法，例如使用 SAP.functions.Unicode。它对我所做的只是更改为“RFC_CALL_TRANSACTION_USING”。我不确定这些命令之间的确切区别，所以要小心。到目前为止，它一直在为我工作。

# xhtml - javascript 内容未加载，如果我使用 .xhtml 作为输入动态创建选项卡/内容窗格

> ID：16214583
> 
> 赞同：0
> 
> 时间：2013-04-25T12:19:48.667
> 
> 标签：xhtml, dojo, tabcontainer, contentpane

我正在 home.xhtml 文件中创建如下动态选项卡/内容窗格，我试图调用 order.xhtml 中存在的函数显示，它没有被调用。没有加载 order.xhtml 中的任何 java 脚本。

在 home.xhtml 中

```
 if(dijit.byId('ordersummary')!=null){
        dijit.byId('ordersummary').destroy();
        }
    newTab= new dijit.layout.ContentPane({
        id : 'ordersummary',
        title : 'Order Summary',
        href : 'order.xhtml',
        closable : true
    });
    dijit.byId('tabContainer').addChild(newTab);
     dijit.byId('tabContainer').selectChild(dijit.byId("ordersummary")); 
```

javascript in order.xhtml

```
<script type="text/javascript">
    //<![CDATA[
    function display(){
      alert(" I M BEING CALLED");
             }
     </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:45:46.603

虽然我不熟悉 dojo 工具包，但我认为您应该将 JavaScript 函数放在主文件中，或者像动态加载 JavaScript 一样； [如何在另一个 JavaScript 文件中包含一个 JavaScript 文件？](https://stackoverflow.com/questions/950087/include-javascript-file-inside-javascript-file)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:55:58.977

有两种方法，一种是使脚本类型为 dojo/method。或者使用扩展的 dojox/layout/ContentPane。

[http://livedocs.dojotoolkit.org/dijit/layout/ContentPane#executing-javascript-inside-contentpane](http://livedocs.dojotoolkit.org/dijit/layout/ContentPane#executing-javascript-inside-contentpane)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T09:37:04.553

dijit.layout.ContentPane will not support javascript,i mean it will not execute the javascript content in the input file.

dojox.layout.ContentPane is advanced one and it will support javascript.

# plugins - WebStorm 6.0 无法识别 Chrome JetBrains 插件

> ID：16214587
> 
> 赞同：10
> 
> 时间：2013-04-25T12:19:58.347
> 
> 标签：plugins, ide, google-chrome-devtools, webstorm

我已经尝试解决这个问题很长时间了。我已经从 Chrome 商店安装了插件，但浏览器中的插件按钮显示为灰色，并在悬停时显示“**未连接”。**当我在 WS 中调试时，我得到这个弹出窗口：

![在此处输入图像描述](https://i.stack.imgur.com/Vncji.png)

我看过 JB 网站上的帮助部分，但那里的帮助非常糟糕，甚至没有提到插件和 IDE 无法相互识别的问题。

我已经查看了这里有类似问题的其他帖子，尽管它通常围绕 LiveEditing 展开，但我没有找到任何解决我的问题的帮助。

有人可以给我一系列步骤来检查IDE和Chrome插件之间的同步问题出在哪里吗？

**编辑 ：**

当我打开 JB 控制台时它是空的：

![在此处输入图像描述](https://i.stack.imgur.com/IvPyP.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-31T11:03:16.347

*   右键单击 JetBrains chrome 扩展

*   选择“选项”

*   设置主机：127.0.0.1

*   设置端口：63343

*   点击“申请”

你准备好了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:35:50.017

请检查扩展控制台中写的内容（[http://confluence.jetbrains.com/display/WI/LiveEdit](http://confluence.jetbrains.com/display/WI/LiveEdit)，我怎么知道出了什么问题？）控制台内容以及您的idea.log（帮助/显示日志）会乐于助人

# c# - 嵌套事务范围.net

> ID：16214589
> 
> 赞同：0
> 
> 时间：2013-04-25T12:19:59.633
> 
> 标签：c#, sql-server, transactions, nested-transactions

我正在使用 SQL Server 2008 R2 并尝试使用事务。

首先是关于 .net 和 SQL Server 中的事务的问题。如果我有这样的事情

```
try {
    var transactionOption = new TransactionOptions();
    transactionOption.IsolationLevel = IsolationLevel.ReadCommitted;
    transactionOption.Timeout = TransactionManager.MaximumTimeout;

    using (var scope = new TransactionScope(TransactionScopeOption.RequiresNew, transactionOption)) {
        //create question this creates a new question in the database
        Helpers.CreateQuestionBankItem(ref mappedOldNewQuestionItemGuid, missingQuestionBankItems);
        //question created

        //query database for the code of the newly inserted question, will the database give me the code since Complete has not been called as yet?    

        scope.Complete();
    }
}
catch (Exception ex) {
    throw;
}

//query database for the code of the newly inserted question,  will the database give me the code since Complete has been called as now? 
```

此时我应该调用数据库来询问新插入问题的代码。现在我的第二个问题，在我问之前，我找到了这个链接[Nested Transaction](http://www.sqlskills.com/blogs/paul/a-sql-server-dba-myth-a-day-2630-nested-transactions-are-real/)。根据上面的链接，我仍然想问我是否有这样的东西

```
try {
    var transactionOption = new TransactionOptions();
    transactionOption.IsolationLevel = IsolationLevel.ReadCommitted;
    transactionOption.Timeout = TransactionManager.MaximumTimeout;

    using (var outerscope = new TransactionScope(TransactionScopeOption.RequiresNew, transactionOption)) {
        try {
            var transactionOption = new TransactionOptions();
            transactionOption.IsolationLevel = IsolationLevel.ReadCommitted;
            transactionOption.Timeout = TransactionManager.MaximumTimeout;

            using (var innerscope = new TransactionScope(TransactionScopeOption.RequiresNew, transactionOption)) {
                //create question this creates a new question in the database
                Helpers.CreateQuestionBankItem(ref mappedOldNewQuestionItemGuid, missingQuestionBankItems);
                //question created

                //query database for the code of the newly inserted question, will the database give me the code since Complete has not been called as yet?    

                innerscope.Complete();
            }
        }
        catch (Exception ex) {
        }

        //query database for the code of the newly inserted question,  will the database give me the code since Complete has been called as now?    

        outerscope.Complete();
    }
}
catch (Exception ex) {
    throw;
} 
```

如果我的内窥镜完成，查询 SQL Server 会给我新创建的问题的代码。

如果内部范围抛出异常并且我吞噬了它会发生什么，外部范围也会被处理掉吗？

调用 innerscope.Complete() 是否完成了该内部范围？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T13:08:32.307

如果要从事务上下文中的故障中恢复，则需要使用[事务保存点](http://msdn.microsoft.com/en-us/library/ms178157%28v=sql.105%29.aspx)。不幸的是，托管`System.Transaction`不支持保存点。不仅如此，如果您使用事务范围，您将无法使用保存点，甚至不能直接使用，因为事务范围将升级为分布式事务，而保存点在分布式上下文中不起作用。

您可以改用[`SqlTransaction`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqltransaction.aspx)支持[`Save()`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqltransaction.save.aspx)保存点的特定平台。有关事务感知异常处理的示例，请参阅[异常处理和嵌套事务。](http://rusanu.com/2009/06/11/exception-handling-and-nested-transactions/)

# neo4j - Neo4j 项目结构

> ID：16214590
> 
> 赞同：1
> 
> 时间：2013-04-25T12:20:01.243
> 
> 标签：neo4j, dao

我正在寻找构建一个相对复杂的 Neo4J 应用程序，我打算将其拆分为两个独立的项目，即前端和后端。前端将是 HTML5 并且与此问题无关，后端将具有与 Jersey 的 REST 接口，但我有疑问的是该 REST 接口背后的结构。

Atm，这就是我的设想：

```
RESTimpl <-DATA-> Service  <-DTO-> Repository <-NODE-> DAO <--> Neo4j Singleton 
```

一般流程是 RESTimpl 接收 JSON 并将其转换为简单的 java 对象，如字符串、int 等，然后将这些对象传递给使用它们创建 DTO 的服务。该 DTO 被传递到存储库，该存储库执行将此类 DTO 写入数据库所需的所有 DAO 调用（一个 DTO 可能需要创建多个节点和关系）。对于 DAO，我正在考虑创建一个 Core API 和 Cypher 实现，它只有非常基本的图形功能，比如创建节点、创建关系、删除节点……基本上对所有存储库都有用的方法。Neo4j 单例将包含我的 GraphDatabaseService 实例和一些配置内容。

这是一个相对复杂的结构，但我希望项目非常模块化。使依赖注入变得容易。（所有内容也将针对接口编写）

但是，互联网上的所有示例都有不同的实现。他们实际上使他们的 DTO 成为 Neo4J 节点的包装器，或者至少将底层节点存储在 DTO 中。但它确实只允许 REST-Service-DAO 结构。

但它不允许我更改存储库实现并将不同的数据库放在应用程序后面。

做我想做的事情的“最正确的方法”是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T06:02:50.610

我完全使用了您在上面描述的内容，并且我发现它运行良好（一个项目正在生产中，一个几乎在那里）并且不会混淆问题。我不使用 Spring Data，但它是一个可以考虑的选项。

我已将我的域对象定义为标准 POJO——其中根本没有 Neo4j 的东西。它们的持久性由 DAO 管理，其中主要包含 Cypher 查询，在某些情况下，某些核心 API 工作取决于复杂性。

GraphDatabase 是一个注入的（我有两个上下文——EmbeddedGraph 实现是为生产注入的，而 ImpermanentGraph 是为测试注入的）。使用处理域对象和/或 DTO 的 Jersey 公开 REST 服务。所以 Neo4j 的代码只出现在持久层。有几个通用的方便方法暴露于索引/按索引获取等。

我不会采用 wrap-Node 方式 - 尝试过，但发现它带来了自己的一系列问题，并导致设计有点臭。看起来你在正确的轨道上（至少对我来说）

# javascript - 如何从不区分大小写的下拉列表中选择一个值？

> ID：16214591
> 
> 赞同：0
> 
> 时间：2013-04-25T12:20:03.410
> 
> 标签：javascript, jquery, html-select

我试图在下拉列表中找到“CAT”，其中下拉列表的值为 [“Cat”，“Rat”，“Mat”]，因此无法通过文本找到，并且我没有“CAT”的 ID通过 id 查找。有什么建议吗？

**编辑：**小写（）会将“CAT”更改为 cat 对吗？但我的下拉菜单有“猫”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:22:52.833

尝试比较值[小写](http://www.w3schools.com/jsref/jsref_tolowercase.asp)：

```
if(myvalue.toLowerCase() === ddl[i].toLowerCase()) {
    //...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:38:26.877

有点晚了，基本上是 Mysteryos 的回答是跟进 jsFiddle 来支持它。

此函数将返回选项：

```
function Find(searchContent)
{
    var options = $('#dropDown option'); 
    var foundOption;
    $.each(options, function (key, value)
           {
               value = $(value);
               if(value.html().toLowerCase() == searchContent.toLowerCase())
               {
                  foundOption = value;
               }
           });
    return foundOption;
} 
```

在以下位置查看一个工作示例：http: [//jsfiddle.net/7fWxZ/](http://jsfiddle.net/7fWxZ/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:26:45.147

看一下这个：

**HTML 代码：**

```
<select id="ats">
  <option>Cat</option>
  <option>Rat</option>
  <option>Mat</option>
</select> 
```

**jQuery代码：**

```
function findmyat(comparetext){
  $('#ats option').each(function(){
     if ($(this).val().toLowerCase()==comparetext.toLowerCase()){
         //found the option i  was looking for, do what i want
         alert($(this).val()+' has been found');
     }
  }
} 
```

# java - 带有 ViewFlipper 的 onTouchListener 不能立即工作

> ID：16214592
> 
> 赞同：0
> 
> 时间：2013-04-25T12:20:06.230
> 
> 标签：java, android, viewflipper, ontouchlistener

我创建了一个使用 ScrollView 的活动。在 ScrollView 中，我创建了一个带有两个子布局的 ViewFlipper 的 LinearLayout，并将 ViewFlipper 设置为“不可见”。在 ViewFlipper 之前，我有两个按钮，我想将我的应用程序设置为根据用户按下的按钮加载 ViewFlipper 的右子项。ViewFlipper 的子布局带有按钮。我让他们在按下时将他们的 ID 添加到一个数组中，我想让他们处于按下状态，直到用户再次按下它们以释放它们。我几乎做到了，但我遇到了两个问题：

1）当按下按钮时，ViewFlipper 绘制相对布局，但 onTouchListener 直到我按下另一个按钮后才会起作用，ViewFlipper 将绘制另一个布局。然后它看起来在更改布局时工作正常。有谁知道如何让它立即工作而不在布局之间切换？

2) onTouchListener 不能完全正常工作。我的意思是，如果已经设置为 true，我想设置 button.setPressed(true) 或 false，但如果它可以正常工作，它看起来是随机的。有时，我按下一个按钮并没有任何反应，几秒钟后我再试一次并且工作正常。有谁知道我该如何解决它或必须建议一种更好的方法来使按钮保持按下状态？

我的活动 xml 文件是：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:gravity="center_horizontal"
android:orientation="vertical" >

    <ScrollView
    android:id="@+id/ScrollView"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <LinearLayout
        android:id="@+id/formLayout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:orientation="vertical" >

  <TextView
        android:id="@+id/selectTxt"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:text="Select an option" />

    <LinearLayout
            android:id="@+id/chooseButtons"
            android:layout_width="wrap_content"
            android:layout_height="120dp"
            android:layout_marginTop="10dp"
            android:layout_marginBottom="10dp"
            android:layout_gravity="center_horizontal"
            android:orientation="horizontal" >

        <Button
                   android:id="@+id/firstBtn"
                   android:layout_width="120dp"
                   android:layout_height="fill_parent"
                   android:layout_marginBottom="1dp"
                   android:layout_marginTop="2dp"
                   android:layout_marginRight="5dp"
                   android:text="Option 1"
                   android:textColor="@android:color/white"
                   android:background="@drawable/option1"/>

       <Button
                  android:id="@+id/secondBtn"
                  android:layout_width="120dp"
                  android:layout_height="fill_parent"
                  android:layout_marginBottom="1dp"
                  android:layout_marginTop="2dp"
                  android:layout_marginLeft="5dp"
                  android:text="Option 2"
                  android:textColor="@android:color/white"
                  android:background="@drawable/option2"/>

    </LinearLayout>

       <TextView
            android:id="@+id/subChoices"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="10dp"
            android:layout_marginBottom="20dp"
            android:layout_gravity="center_horizontal"
            android:text="Select 5 options" />

       <ViewFlipper  
        android:id="@+id/optionsFlipper"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:visibility="invisible">

        <include android:id="@+id/Include1" layout="@layout/option1layout" />
        <include android:id="@+id/Include2" layout="@layout/option2layout" />
           </ViewFlipper>

       <Button
            android:id="@+id/okBtn"
            android:text="OK"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="10dp"/>

    </LinearLayout>
    </ScrollView> 
```

这是我的java代码：

```
public class OptionsSelection extends Activity 
{
    protected Button ok, option1, option2;
    protected Button subOption1, subOption2, subOption3, subOption4, subOption5;
    protected ViewFlipper optionsFlipper;
    protected int optionID;
    protected boolean status, exists;
    protected int[] subOptions = new int[3];
    protected int counter=0;

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.options);
        option1 = (Button) findViewById(R.id.firstBtn);
        option2 = (Button) findViewById(R.id.secondBtn);
        ok = (Button) findViewById(R.id.okBtn);
        optionsFlipper = (ViewFlipper)findViewById(R.id.optionsFlipper);

        option2.setOnClickListener(new View.OnClickListener() 
        {
            @Override
            public void onClick(View v) 
            {
                if (optionID == 2)
                {
                    for(int i=0;i<subOptions.length;i++)
                        subOptions[i] = 20;
                }
                exists = false;
                optionID = 1;
                counter = 0;
                optionsFlipper.setDisplayedChild(1);
                subOption1 = (Button) findViewById(R.id.option1SubOption1);
                subOption2 = (Button) findViewById(R.id.option1SubOption2);
                subOption3 = (Button) findViewById(R.id.option1SubOption3);
                subOption4 = (Button) findViewById(R.id.option1SubOption4);
                subOption5 = (Button) findViewById(R.id.option1SubOption5);
                setOnTouchListeners();
                optionsFlipper.setVisibility(View.VISIBLE);
                status = false;

            }

        });

        option1.setOnClickListener(new View.OnClickListener() 
        {
            @Override
            public void onClick(View v) 
            {
                if (optionID == 1)
                {
                    for(int i=0;i<subOptions.length;i++)
                    {
                        subOptions[i] = 20;
                    }
                }
                exists = false;
                optionID = 2;
                counter = 0;
                optionsFlipper.setDisplayedChild(2);
                subOption1 = (Button) findViewById(R.id.option1SubOption1);
                subOption2 = (Button) findViewById(R.id.option1SubOption2);
                subOption3 = (Button) findViewById(R.id.option1SubOption3);
                subOption4 = (Button) findViewById(R.id.option1SubOption4);
                subOption5 = (Button) findViewById(R.id.option1SubOption5);
                setOnTouchListeners();
                optionsFlipper.setVisibility(View.VISIBLE);
                status = false;
            }

        });

        ok.setOnClickListener(new View.OnClickListener() 
        {   
            @Override
            public void onClick(View v) 
            {
                for(int i=0;i<subOptions.length;i++)
                {
                    System.out.println(subOptions[i]);
                }

            }
        });

    }

public class onTouchListener implements View.OnTouchListener
{
    @Override
    public boolean onTouch(View v, MotionEvent event) 
    {   
        if (status == true)
        {
            v.setSelected(false);
            v.setPressed(false);
            status=false;
            return true;
        }
        else if (status == false)
        {
            v.setSelected(true);
            v.setPressed(true);
            status=true;
                        /*getting subOption button tag and convert it to string in order to remove the first 6 characters*/
            String buttonClicked = v.getTag().toString();
            int buttonID = Integer.parseInt(buttonClicked.substring(6));
            switch (buttonID)
            {
            case 1:
                {
                    System.out.println("Case 1!");
                    if (optionID == 1)
                        addToArray(subOptions, 1);
                    else if (optionID == 2)
                        addToArray(subOptions, 6);
                    else
                        System.out.println("Error occurred in assign of key");
                }
                break;
            case 2:
                {
                    if (optionID == 1)
                        addToArray(subOptions, 2);
                    else if (optionID == 2)
                        addToArray(subOptions, 7);
                    else
                        System.out.println("Error occurred in assign of key");
                }
                break;
            case 3:
                {
                    if (optionID == 1)
                        addToArray(subOptions, 3);
                    else if (optionID == 2)
                        addToArray(subOptions, 8);
                    else
                        System.out.println("Error occurred in assign of key");
                }
                break;
            case 4:
                {
                    if (optionID == 1)
                        addToArray(subOptions, 4);
                    else if (optionID == 2)
                        addToArray(subOptions, 9);
                    else
                        System.out.println("Error occured in assign of key");
                }
                break;
            case 5:
                {   
                    if (optionID == 1)
                        addToArray(subOptions, 5);
                    else if (optionID == 2)
                        addToArray(subOptions, 10);
                    else
                        System.out.println("Error occured in assign of key");
                }
                break;
            }

            System.out.println("Pressed changed to true");
            return true;
        }
        else
            return true;
    }
};

    public void addToArray(int[] ar, int a)
    {
        for (int i=0;i<ar.length;i++) 
        {
            if (ar[i] == a)
            exists = true;  
            System.out.println("Already exists");
        }
        if((counter<=3)&&(exists==false))
        {
            ar[counter] = a;
            counter++;
        }
        else if ((counter>3)&&(exists==false))
        {
            counter = 0;
            ar[counter] = a;
            counter++;
        }
        else
        {
            System.out.println("Already Exists...");
        }
        System.out.println("Added new integer to Array");
    }

    public void setOnTouchListeners()
    {
        subOption1.setOnTouchListener(new onTouchListener());
        subOption2.setOnTouchListener(new onTouchListener());
        subOption3.setOnTouchListener(new onTouchListener());
        subOption4.setOnTouchListener(new onTouchListener());
        subOption5.setOnTouchListener(new onTouchListener());
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T09:40:30.453

最后，我使用片段而不是 ViewFlipper 和切换按钮而不是简单的按钮，并且工作正常！

# php - 在字符串的第一个空格处拆分

> ID：16214593
> 
> 赞同：41
> 
> 时间：2013-04-25T12:20:07.300
> 
> 标签：php, split

我有一个这样的字符串：

> *红色 黄色 蓝色*

我想得到一个这样的数组：

> 数组（ [0] => 红色 [1] => 黄色蓝色）

如何在字符串的第一个空格处拆分？我的代码不起作用

```
<?php
$str = "red yellow blue";
$preg = preg_split("/^\s+/", $str);
print_r($preg);
?> 
```

请帮我。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2013-04-25T12:21:25.517

`explode`有限制地使用：

```
$array = explode(' ', $string, 2); 
```

附带说明：第三个参数 of`preg_split`与 for 的参数相同`explode`，因此您也可以这样编写代码：

```
$array = preg_split('#\s+#', $string, 2); 
```

* * *

*参考：*

> [PHP：爆炸](http://www.php.net/manual/en/function.explode.php)
> 
> [PHP: preg_split](http://php.net/manual/en/function.preg-split.php)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-25T12:22:18.147

```
<?php
$string = "red yellow blue";
$result = explode(" ", $string, 2);
print_r($result);
?> 
```

爆炸吧

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-25T12:21:29.837

您可以像这样使用爆炸功能

```
print_r(explode(' ', $str, 2)); 
```

它将设置一个限制。[在这里](http://php.net/manual/en/function.explode.php)查看更多信息

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-18T22:52:42.770

您可以使用[explode](http://php.net/manual/en/function.explode.php)，但如果您不是 100% 确定每次都会有相同的空格数（爆炸），您可以使用[ltrim](http://php.net/manual/en/function.ltrim.php)删除第一个单词和空格

```
<?php
$full='John Doe Jr.';
$full1=explode(' ', $full);
$first=$full1[0];
$rest=ltrim($full, $first.' ');
echo "$first + $rest";
?> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2021-04-27T09:16:45.933

函数 splitName($name) { $parts = explode(' ', $name); return array('firstname' => array_shift($parts), 'lastname' => join('', $parts)); }

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2016-05-12T10:35:57.920

您可以通过这种方式 使用[爆炸：](http://php.net/manual/en/function.explode.php)

```
 $stringText  = "red yellow blue";
  $colours = explode(" ", $stringText);
  echo $colours[0]; //red 
  echo $colours[1]; //yellow
  echo $colours[2]; //blue 
```

也可以通过 foreach 循环获取 $colours 的所有元素，但在这种情况下，explode 更好

# javascript - 如何读取 javascript 变量中的文件内容？

> ID：16214598
> 
> 赞同：9
> 
> 时间：2013-04-25T12:20:18.497
> 
> 标签：javascript

我有一个小脚本在每 4 个字符后拆分 'var foo' 内的文本。它工作正常。但我的实际数据在一个文本文件中，比如“a.txt”。如何在“var foo”中获取整个文件文本。并将拆分输出写入另一个文本文件？

```
var foo = "this is sample text !!!"; 
var arr = [];
for (var i = 0; i < foo.length; i++) {
    if (i % 4 == 0 && i != 0)
        arr.push(foo.substring(i - 4, i));
    if (i == foo.length - 1)
        arr.push(foo.substring(i - (i % 4), i+1));          
}
document.write(arr);
console.log(arr); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-04-14T01:44:18.490

要获取文件的内容，您需要使用输入标签选择文件。

```
<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
</head>
<body>
  <input id="input" type="file" accept="text/plain">
  <script src="script.js"></script>
</body> 
```

阅读文件内容的好时机是在更改事件中。

```
const input = document.querySelector("#input");

input.addEventListener("change", () => {
  const file = input.files.item(0);
}); 
```

要将文件的内容作为字符串读取，您需要对其进行转换。

```
function fileToText(file, callback) {
  const reader = new FileReader();
  reader.readAsText(file);
  reader.onload = () => {
    callback(reader.result);
  };
} 
```

文件内容作为字符串将可用于回调函数。您可以创建一个链接并使用单击事件将字符串下载到文本文件中。

```
function save(content, fileName, mime) {
  const blob = new Blob([content], {
    tipe: mime
  });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = fileName;
  a.click();
} 
```

这是完整的代码

```
const input = document.querySelector("#input");

input.addEventListener("change", () => {
  const file = input.files.item(0);
  fileToText(file, (text) => {
    save(text, "fileName.txt", "text/plain");
  });
});

function fileToText(file, callback) {
  const reader = new FileReader();
  reader.readAsText(file);
  reader.onload = () => {
    callback(reader.result);
  };
}

function save(content, fileName, mime) {
  const blob = new Blob([content], {
    tipe: mime
  });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = fileName;
  a.click();
}
```

```
<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
</head>

<body>
  <input id="input" type="file" accept="text/plain">
  <script src="script.js"></script>
</body>
```

您可以在此处阅读有关在 JavaScript 中操作文件的更多信息：[https ://www.html5rocks.com/en/tutorials/file/dndfiles/](https://www.html5rocks.com/en/tutorials/file/dndfiles/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-09-08T08:39:51.303

对此的解决方案帮助了我：

[如何将文本文件的内容加载到 javascript 变量中？](https://stackoverflow.com/questions/196498/how-do-i-load-the-contents-of-a-text-file-into-a-javascript-variable)

```
var client = new XMLHttpRequest();
client.open('GET', '/foo.txt');
client.onreadystatechange = function() {
alert(client.responseText);
}
client.send(); 
```

# windows-phone-7 - 认证流程：Windows Phone -Location Service API

> ID：16214605
> 
> 赞同：-1
> 
> 时间：2013-04-25T12:20:27.497
> 
> 标签：windows-phone-7, windows-phone-8

我将一个 windows phone 应用程序上传到市场；认证过程失败；错误是

**“评论：该应用程序不包含解释该应用程序如何使用位置服务 API 的隐私政策。该应用程序似乎没有使用位置服务 API。”**

但应用程序不依赖于位置服务 API！绝不 ！

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:56:24.103

我看到这种类型的消息有几个原因：

*   您的应用引用了来自 Location API 命名空间之一的内容
*   您的应用程序使用的引用 您的应用程序引用了来自 Location API 命名空间之一的内容（通常这种情况发生在某些广告框架中）
*   您的 WMAppManifest.xml 包含该`ID_CAP_LOCATION`功能，从而为您的应用提供位置功能。

# ios - 如何获取 iPhone App 的 App Link

> ID：16214607
> 
> 赞同：-2
> 
> 时间：2013-04-25T12:20:34.750
> 
> 标签：ios, app-store

我正在制作一个 iPhone 应用程序，我需要在其中通过电子邮件发送指向该应用程序的链接。

我不知道如何获得该链接。谁能帮我解决问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:26:17.750

使用此机制：

例如： Headlines App 是应用程序的名称，然后：

```
http://appstore.com/headlinesapp 
```

或者

第一个公司名称，后跟 appname

```
http://appstore.com/u2opiamobilepteltd/headlinesapp 
```

将 appname 替换为您的 appname，将公司名称替换​​为您的。

希望这可以帮助。

# java - 使用java中的空格运行cmd

> ID：16214615
> 
> 赞同：1
> 
> 时间：2013-04-25T12:21:00.970
> 
> 标签：java, windows, command-line

我想通过 java 会话运行命令。该命令包含空格。as `"C:\With Space\sample.exe"`-command_option`"C:\Source File\test.c"` 如果

```
C:\WithoutSpace\sample.exe -command_option "C:\Source File\test.c" 
```

如果我们保留引号，`C:\With Space\sample.exe`我们会得到错误：“文件名、目录名或卷标语法不正确。” 如果我们删除引号，则 exe 不会运行...请指导。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:28:34.137

尝试这个：

```
String[] arg = {"cmd","/c","C:/Source File/test.c"};
ProcessBuilder pb = new ProcessBuilder(arg);
Process pr = pb.start(); 
```

此外，您可以使用`Runtime.exec(String[])`版本

例子：

```
Runtime rt = Runtime.getRuntime();
String[] args = { "cmd", "/c", "C:/Source File/test.c"};
try
{
    Process proc = rt.exec(processCommand);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:36:12.680

你可以试试这个：

```
Process process = Runtime.getRuntime().exec("'C:\WithoutSpace\sample.exe' -command_option 'C:\Source File\test.c'");
BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));

while ((line = in.readLine()) != null) {
    //line contain command output
} 
```

# pom.xml - 在 Maven 本地存储库中包含一个 jar

> ID：16214621
> 
> 赞同：1
> 
> 时间：2013-04-25T12:21:09.373
> 
> 标签：pom.xml

我想在我的本地存储库中包含一个 jar（google-api-java-client 1.6.0-beta）。要包含它，我们需要在 pom.xml 中写入，但是当我尝试包含它时，它并没有包含在本地存储库中。下面是我项目的 pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

<modelVersion>4.0.0</modelVersion>

<!-- The Basics -->
<groupId>com.google.tryPredictionJava</groupId>
<artifactId>gae-java</artifactId>
<version>1.0-SNAPSHOT</version>
<packaging>war</packaging>

<name>try-prediction-java</name>
<pluginRepositories>
    <pluginRepository>
        <id>maven-gae-plugin-repo</id>
        <name>maven-gae-plugin repository</name>
        <url>http://maven-gae-plugin.googlecode.com/svn/repository</url>
    </pluginRepository>
</pluginRepositories>
<repositories>
    <repository>
        <id>google-api-services</id>
        <url>http://mavenrepo.google-api-java-client.googlecode.com/hg</url>
    </repository>
    <repository>
        <id>maven-gae-plugin-repo</id>
        <name>maven-gae-plugin repository</name>
        <url>http://maven-gae-plugin.googlecode.com/svn/repository</url>
    </repository>

</repositories>

<dependencies>
    <!-- 8th Apr <dependency> <groupId>com.google.api-client</groupId> <artifactId>google-api-client</artifactId> 
        <version>1.13.2-beta</version> </dependency> -->

    <dependency>
        <groupId>com.google.api-client</groupId>
        <artifactId>google-api-client</artifactId>
        <version>1.14.1-beta</version>
    </dependency>

    <dependency>
        <groupId>com.google.api-client</groupId>
        <artifactId>google-api-client</artifactId>
        <version>1.6.0-beta</version>
    </dependency>

    <!-- <dependency> <groupId>com.google.api-client</groupId> <artifactId>google-api-client</artifactId> 
        <version>1.4.0-beta</version> </dependency> -->

    <!-- 8th Apr <dependency> <groupId>com.google.oauth-client</groupId> <artifactId>google-oauth-client</artifactId> 
        <version>1.13.1-beta</version> </dependency> <dependency> <groupId>com.google.oauth-client</groupId> 
        <artifactId>google-oauth-client-servlet</artifactId> <version>1.13.1-beta</version> 
        </dependency> <dependency> <groupId>com.google.api.client</groupId> <artifactId>google-api-client-http</artifactId> 
        <version>1.2.3-alpha</version> </dependency> <dependency> <groupId>com.google.api-client</groupId> 
        <artifactId>google-api-client</artifactId> <version>1.13.2-beta</version> 
        </dependency> <dependency> <groupId>com.google.http-client</groupId> <artifactId>google-http-client-jackson2</artifactId> 
        <version>1.13.0-beta</version> </dependency> -->

    <dependency>
        <groupId>com.google.oauth-client</groupId>
        <artifactId>google-oauth-client</artifactId>
        <version>1.14.1-beta</version>
    </dependency>
    <dependency>
        <groupId>com.google.oauth-client</groupId>
        <artifactId>google-oauth-client-servlet</artifactId>
        <version>1.14.1-beta</version>
    </dependency>
    <dependency>
        <groupId>com.google.api.client</groupId>
        <artifactId>google-api-client-http</artifactId>
        <version>1.2.3-alpha</version>
    </dependency>
    <dependency>
        <groupId>com.google.api-client</groupId>
        <artifactId>google-api-client</artifactId>
        <version>1.14.1-beta</version>
    </dependency>
    <dependency>
        <groupId>com.google.http-client</groupId>
        <artifactId>google-http-client-jackson2</artifactId>
        <version>1.14.1-beta</version>
    </dependency>

    <!-- <dependency> <groupId>com.google.http-client</groupId> <artifactId>google-http-client-jackson2</artifactId> 
        <version>1.13.0-beta</version> </dependency> <dependency> <groupId>com.google.oauth-client</groupId> 
        <artifactId>google-oauth-client-jetty</artifactId> <version>1.13.0-beta</version> 
        </dependency> -->

    <dependency>
        <groupId>com.google.oauth-client</groupId>
        <artifactId>google-oauth-client-jetty</artifactId>
        <version>1.14.1-beta</version>
    </dependency>

    <!-- -->

    <dependency>
        <groupId>com.google.http-client</groupId>
        <artifactId>google-http-client-jackson</artifactId>
        <version>1.13.1-beta</version>
    </dependency>

    <!-- -->
    <!-- Google App Engine meta-package -->
    <dependency>
        <groupId>net.kindleit</groupId>
        <artifactId>gae-runtime</artifactId>
        <version>${gae.version}</version>
        <type>pom</type>
    </dependency>

    <dependency>
        <groupId>org.datanucleus</groupId>
        <artifactId>datanucleus-core</artifactId>
        <version>${datanucleus.version}</version>
        <scope>runtime</scope>
    </dependency>

    <dependency>
        <groupId>javax.transaction</groupId>
        <artifactId>jta</artifactId>
        <version>1.1</version>
    </dependency>

    <!-- Java EE Servlet API. We need it to compile IndexServlet class. You can 
        probably remove it, if you don't explicitly use Servlets -->
    <dependency>
        <groupId>org.apache.geronimo.specs</groupId>
        <artifactId>geronimo-servlet_2.5_spec</artifactId>
        <version>1.2</version>
        <scope>provided</scope>
    </dependency>

    <!-- Make use of JSP tags. Remove, if you don't use JSPs -->
    <dependency>
        <artifactId>standard</artifactId>
        <groupId>taglibs</groupId>
        <version>1.1.2</version>
        <type>jar</type>
        <scope>runtime</scope>
    </dependency>

    <!-- These dependencies are here just for enabling logging -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.6.1</version>
    </dependency>

    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>0.9.24</version>
    </dependency>

    <!-- Test scope -->
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.5</version>
        <scope>test</scope>
    </dependency>

    <!-- GAE libraries for local testing as described here: http://code.google.com/appengine/docs/java/howto/unittesting.html -->

    <dependency>
        <groupId>com.google.appengine</groupId>
        <artifactId>appengine-api-stubs</artifactId>
        <version>${gae.version}</version>
        <scope>test</scope>
    </dependency>

    <dependency>
        <groupId>com.google.appengine</groupId>
        <artifactId>appengine-testing</artifactId>
        <version>${gae.version}</version>
        <scope>test</scope>
    </dependency>

    <!-- <dependency> <groupId>com.google.api-client</groupId> <artifactId>google-api-client</artifactId> 
        <version>1.4.1-beta</version> </dependency> -->

    <!-- 8th Apr <dependency> <groupId>com.google.api-client</groupId> <artifactId>google-api-client</artifactId> 
        <version>1.13.2-beta</version> </dependency> -->
    <dependency>
        <groupId>com.google.api-client</groupId>
        <artifactId>google-api-client</artifactId>
        <version>1.14.1-beta</version>
    </dependency>

    <dependency>
        <groupId>com.google.apis</groupId>
        <artifactId>google-api-services-prediction</artifactId>
        <version>v1.4-1.3.0-beta</version>
    </dependency>

    <!--<dependency> <groupId>com.google.apis</groupId> <artifactId>google-api-services-plus</artifactId> 
        <version>v1-rev22-1.8.0-beta</version> </dependency> -->
    <dependency>
        <groupId>com.google.apis</groupId>
        <artifactId>google-api-services-plus</artifactId>
        <version>v1-rev62-1.14.1-beta</version>
    </dependency>
    <dependency>
        <groupId>javax.jdo</groupId>
        <artifactId>jdo2-api</artifactId>
        <version>2.3-eb</version>
        <exclusions>
            <exclusion>
                <groupId>javax.transaction</groupId>
                <artifactId>transaction-api</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>com.google.appengine</groupId>
        <artifactId>appengine-api-1.0-sdk</artifactId>
        <version>${gae.version}</version>
    </dependency>
    <dependency>
        <groupId>com.google.appengine</groupId>
        <artifactId>appengine-api-labs</artifactId>
        <version>${gae.version}</version>
        <scope>compile</scope>
    </dependency>
    <dependency>
        <groupId>com.google.http-client</groupId>
        <artifactId>google-http-client-jackson2</artifactId>
        <version>1.14.1-beta</version>
    </dependency>
    <dependency>
        <groupId>com.google.oauth-client</groupId>
        <artifactId>google-oauth-client-jetty</artifactId>
        <version>1.14.1-beta</version>
    </dependency>
    <!--<dependency> 8th Apr <groupId>com.google.http-client</groupId> <artifactId>google-http-client-jackson2</artifactId> 
        <version>1.13.0-beta</version> </dependency> <dependency> <groupId>com.google.oauth-client</groupId> 
        <artifactId>google-oauth-client-jetty</artifactId> <version>1.13.0-beta</version> 
        </dependency> -->
</dependencies>

<build>
    <plugins>

        <plugin>
            <groupId>net.kindleit</groupId>
            <artifactId>maven-gae-plugin</artifactId>
            <version>0.8.4</version>
            <configuration>
                <port>8080</port>
                <address>127.0.0.1</address>
            </configuration>
            <executions>
                <execution>
                    <id>start-gae</id>
                    <goals>
                        <goal>stop</goal>
                        <goal>unpack</goal>
                        <goal>start</goal>
                    </goals>
                </execution>
                <execution>
                    <id>stop-gae</id>
                    <goals>
                        <goal>stop</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>

        <!-- This plug-in "enhances" your domain model objects (i.e. makes them 
            persistent for datanucleus) -->
        <plugin>
            <groupId>org.datanucleus</groupId>
            <artifactId>maven-datanucleus-plugin</artifactId>
            <version>1.1.4</version>
            <configuration>
                <!-- Make sure this path contains your persistent classes! -->
                <mappingIncludes>**/model/*.class</mappingIncludes>
                <verbose>true</verbose>
                <enhancerName>ASM</enhancerName>
                <api>JDO</api>
            </configuration>
            <executions>
                <execution>
                    <phase>compile</phase>
                    <goals>
                        <goal>enhance</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>org.datanucleus</groupId>
                    <artifactId>datanucleus-core</artifactId>
                    <version>${datanucleus.version}</version>
                    <exclusions>
                        <exclusion>
                            <groupId>javax.transaction</groupId>
                            <artifactId>transaction-api</artifactId>
                        </exclusion>
                    </exclusions>
                </dependency>
                <dependency>
                    <groupId>org.datanucleus</groupId>
                    <artifactId>datanucleus-rdbms</artifactId>
                    <version>${datanucleus.version}</version>
                </dependency>
                <dependency>
                    <groupId>org.datanucleus</groupId>
                    <artifactId>datanucleus-enhancer</artifactId>
                    <version>1.1.4</version>
                </dependency>
                <dependency>
                    <groupId>javax.jdo</groupId>
                    <artifactId>jdo2-api</artifactId>
                    <version>2.3-ec</version>
                    <scope>runtime</scope>
                </dependency>
            </dependencies>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.1-beta-1</version>
            <configuration>
                <webResources>
                    <resource>
                        <directory>src/main/webapp</directory>
                        <filtering>true</filtering>
                        <includes>
                            <include>**/appengine-web.xml</include>
                        </includes>
                    </resource>
                </webResources>
            </configuration>
        </plugin>

        <!-- The actual maven-gae-plugin. Type "mvn gae:run" to run project, "mvn 
            gae:deploy" to upload to GAE. -->
        <plugin>
            <groupId>net.kindleit</groupId>
            <artifactId>maven-gae-plugin</artifactId>
            <version>0.9.0</version>
            <dependencies>
                <dependency>
                    <groupId>net.kindleit</groupId>
                    <artifactId>gae-runtime</artifactId>
                    <version>${gae.version}</version>
                    <type>pom</type>
                </dependency>
            </dependencies>
        </plugin>

        <!-- Upload application to the appspot automatically, during release:perform -->
        <plugin>
            <artifactId>maven-release-plugin</artifactId>
            <configuration>
                <goals>gae:deploy</goals>
            </configuration>
        </plugin>

        <!-- Java compiler version -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.0</version>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
    </plugins>
</build>

<!-- Specify hard-coded project properties here -->
<properties>

    <!-- Sets the project's default encoding. http://docs.codehaus.org/display/MAVENUSER/POM+Element+for+Source+File+Encoding -->
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>

    <!-- This is just for "eclipse:eclipse" goal to always attempt downloading 
        sources -->
    <downloadSources>true</downloadSources>

    <!-- Specify AppEngine version for your project. It should match SDK version 
        pointed to by ${gae.home} property (Typically, one used by your Eclipse plug-in) 
        <gae.version>1.6.1</gae.version> -->
    <gae.version>1.6.3</gae.version>

    <!-- Upload to http://test.latest.<applicationName>.appspot.com by default -->
    <gae.application.version>test</gae.application.version>

    <datanucleus.version>1.1.5</datanucleus.version>
</properties>

<profiles>
    <!-- We can configure our integration server to activate this profile and 
        perform gae:deploy, thus uploading latest snapshot to the http://1.latest.<applicationName>.appspot.com 
        automatically -->
    <profile>
        <id>integration-build</id>
        <properties>
            <gae.application.version>stage</gae.application.version>
        </properties>
    </profile>

    <!-- This profile will activate automatically during release and upload 
        application to the http://2.latest.<applicationName>.appspot.com (We might 
        want to set the 2nd version as our applications Default version to be accessible 
        at http://<applicationName>.appspot.com) -->
    <profile>
        <id>release-build</id>
        <activation>
            <property>
                <name>performRelease</name>
                <value>true</value>
            </property>
        </activation>

        <properties>
            <!-- During release, set application version in appengine-web.xml to 
                2 -->
            <gae.application.version>release</gae.application.version>
        </properties>
    </profile>
</profiles> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T07:25:28.197

中央仓库的最新版本是 1.4.1-beta

```
<dependency>
    <groupId>com.google.api.client</groupId>
    <artifactId>google-api-client</artifactId>
    <version>1.4.1-beta</version>
</dependency> 
```

下载最新的 JAR 并安装在本地存储库中

```
mvn install:install-file -Dfile=google-api-client.jar -DgroupId=com.google.api.client \
    -DartifactId=google-api-client -Dversion=1.6.0-beta -Dpackaging=jar 
```

# select - AngularJS 选择指令不适用于选项

> ID：16214622
> 
> 赞同：0
> 
> 时间：2013-04-25T12:21:12.203
> 
> 标签：select, angularjs

这个例子看起来很简单，我似乎无法弄清楚它为什么不起作用（我不想使用 ng-options，因为它不适用于 select2，这是我得到这个后想使用的插件想通了）：

**HTML：**

```
<div ng-app="myApp">
    <div ng-controller="MyCtrl">
        selectedNumber: {{selectedNumber}}
        <select ng-model="selectedNumber">
            <option ng-repeat="number in numbers" value="{{number}}">{{number}}</option>
        </select> 
        <div ng-repeat="number in numbers">
            {{number}}
        </div>
    </div>
</div> 
```

**AngularJS：**

```
var app = angular.module('myApp', []);

app.controller('MyCtrl', function($scope) {
    $scope.numbers = [1, 2];
    $scope.selectedNumber = 2;
}); 
```

检查元素时，它看起来像这样：

```
<select ng-model="selectedNumber" class="ng-pristine ng-valid">
    <option value="? number:2 ?"></option>
            <!-- ngRepeat: number in numbers -->
    <option ng-repeat="number in numbers" value="1" class="ng-scope ng-binding">1</option>
    <option ng-repeat="number in numbers" value="2" class="ng-scope ng-binding">2</option>
</select> 
```

我猜是额外的“ `<option value="? number:2 ?"></option>`”导致了这个问题，但我不知道如何摆脱它。我还在行动中创建了一个[jsfiddle](http://jsfiddle.net/tadchristiansen/fGHHH/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:47:08.547

您看到的原因是因为您的选择绑定到一个不包含在其选项中的项目。尽管您正在通过 ng-repeat 添加选项，但我怀疑该指令将不起作用并且并非旨在以这种方式工作：

这是为什么会出现额外价值的参考。 [AngularJS - 在选择标签中使用 ng-repeat 添加了额外的空白选项](https://stackoverflow.com/questions/15488181/angularjs-extra-blank-option-added-using-ng-repeat-in-select-tag)

我认为您有两个选择： 1\. 编写您自己的指令 2\. 使用内置指令`ng-options`并尝试使其与您的插件一起使用

这是一个参考： [https](https://github.com/angular/angular.js/issues/639) ://github.com/angular/angular.js/issues/639 和该问题的一个小提琴：http: [//jsfiddle.net/GTynf/3/](http://jsfiddle.net/GTynf/3/)

这些可能会为您指明解决方案的正确方向。

# android - 片段之间的后退按钮问题（backstack）

> ID：16214635
> 
> 赞同：0
> 
> 时间：2013-04-25T12:21:48.503
> 
> 标签：android, fragment, back-button, back-stack

我有一个带有 3 个标签的应用程序。对于其中两个选项卡，我有按钮，可以在其中使用以下代码将当前片段更改为新片段：

```
MapFragment newFragment = new JourneyMapFragment(mContext, getFromDestinationCoordinate(), getToDestinationCoordinate());
                android.app.FragmentTransaction transaction = getFragmentManager().beginTransaction();
                transaction.setCustomAnimations(android.R.animator.fade_in,
                        android.R.animator.fade_out);

                // Replace whatever is in the fragment_container view with this fragment,
                // and add the transaction to the back stack
                transaction.replace(R.id.fragment_container, newFragment);
                transaction.addToBackStack(null);

                if(newFragment.isHidden()){
                    transaction.show(newFragment);
                }

                transaction.commit(); 
```

对于一个正常片段的选项卡，更改为地图片段后退按钮将我带回原始片段，没有任何问题。

但是，另一个作为 mapfragment 的选项卡，在按下后退按钮时不会给我相同的操作。当它被按下时，它会将视图更改为白色/黑色视图。

这是选项卡中的事务代码，其中后退按钮不起作用：

```
 Fragment newFragment = new CloseBusStopFragment(mContext, busStopList, getMyPosition());
                        android.app.FragmentTransaction transaction = getFragmentManager().beginTransaction();
                        transaction.setCustomAnimations(android.R.animator.fade_in,
                                android.R.animator.fade_out);

                        // Replace whatever is in the fragment_container view with this fragment,
                        // and add the transaction to the back stack
                        transaction.replace(R.id.fragment_container, newFragment);

transaction.addToBackStack(null);

                    if(newFragment.isHidden()){
                        transaction.show(newFragment);
                    }
                        // Commit the transaction
                        transaction.commit(); 
```

有谁知道为什么会这样？有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:01:50.653

如果您可以手动执行此操作，则可以尝试覆盖 onBackPressed() 并手动执行您想做的任何事情。

```
 @Override
   public void onBackPressed() {
                   // Do whatever your transaction manually
        super.onBackPressed();

    } 
```

# c# - 图像从文件夹保存到数据库并返回 UI

> ID：16214638
> 
> 赞同：0
> 
> 时间：2013-04-25T12:21:52.313
> 
> 标签：c#, webforms

我的应用程序（c#）中有一个字段可以将图像保存到数据库中。我编写了以下代码将图像保存到文件夹中，然后将路径保存到数据库中。但是图像没有保存到文件夹中。

```
string imgName = FileUpload1.FileName.ToString();
        string imgPath = null;
        if (imgName == "")
        {
            //int taxiid = Convert.ToInt32(HiddenField1.Value);
            Taxi t = null;
            t = Taxi.Owner_GetByID(tx.Taxi_Id, USM.OrgId);
            imgPath = t.CarImage;
        }
        else
        {
            imgPath = "ImageStorage/" + imgName;
        }
        FileUpload1.SaveAs(Server.MapPath(imgPath));
        tx.CarImage = imgPath; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:29:38.777

我认为您的问题是您将名称添加到我尝试的路径中，如果我像这样保存它，对我来说它工作正常：

> FileUpload1.SaveAs(Server.MapPath("ImageStorage") + imgName);

正如@Rahul 提到的，添加一个try catch 来防止错误。

你检查

> if (imgName == "")

根据我的理解，imgName 不可能是“”，但无论如何你最好添加一个检查文件上传是否有文件。

> if (FileUploadControl.HasFile)

# javascript - JQuery - 加载后重用数据

> ID：16214639
> 
> 赞同：0
> 
> 时间：2013-04-25T12:21:56.063
> 
> 标签：javascript, jquery, ajax

我有这个功能：

```
// AJAX MESSAGES SHOWING
show_msg.on('click', function(e){
    var $this = $(this),
    url = $this.attr('href'),
    url_info =  url + ' .basic_info > *',
    url_msg =  url + ' .contact_messages > *';

    basic_info.slideUp('fast', function(){
            basic_info.empty().load(url_info, function(){
                basic_info.slideDown('fast');
        });
    });

    contact_messages.slideUp('fast', function(){
            contact_messages.empty().load(url_msg, function(){
                contact_messages.slideDown('fast');
        });
    });
    return false;
}); 
```

它正在工作，但我使用了两次负载，我想这不是很有效的方法。有什么方法可以加载一次数据，然后从该数据中选择您需要的内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:27:38.183

你可以这样做：

```
(function(){

    var basicInfoLoaded = false, contactMessageLoaded = false;

// AJAX MESSAGES SHOWING
show_msg.on('click', function(e){
    var $this = $(this),
    url = $this.attr('href'),
    url_info =  url + ' .basic_info > *',
    url_msg =  url + ' .contact_messages > *';

    basic_info.slideUp('fast', function(){
                    if(basicInfoLoaded)
                        basic_info.slideDown('fast');
                    else{
                        basicInfoLoaded = true;
            basic_info.empty().load(url_info, function(){
                    basic_info.slideDown('fast');
            });
                    }
    });

    contact_messages.slideUp('fast', function(){
                    if(contactMessageLoaded)
                        contact_messages.slideDown('fast');
                    else{
                            contactMessageLoaded = true;
            contact_messages.empty().load(url_msg, function(){
                contact_messages.slideDown('fast');
                });
                    }
    });
    return false;
});

})(); 
```

# c# - 如何在c#中遍历对象的属性？

> ID：16214640
> 
> 赞同：1
> 
> 时间：2013-04-25T12:21:56.160
> 
> 标签：c#

我有一个方法可以获取对象属性的值并向其附加一些逗号。我想制作这个generinc，这样我就可以将它与其他对象一起使用。

```
 foreach (var row in rows.ToList())
            {
                sbResult.Append(
                    delimiter + row.MediaName + delimiter + separator +
                    delimiter + row.CountryName + delimiter + separator +
                    delimiter + row.ItemOverRideDate + delimiter + separator +
                    delimiter + row.Rating + delimiter + separator +
                    delimiter + row.BatchNo + delimiter + separator +
                    delimiter + row.NoInBatch + delimiter + separator +
                    delimiter + row.BatchDate + delimiter + separator +
                    delimiter + row.DataType + delimiter + separator +
                    delimiter + row.ByLine + delimiter + separator +
                    delimiter + row.IssueNo + delimiter + separator +
                    delimiter + row.Issue + delimiter + separator +
                    delimiter + row.MessageNo + delimiter + separator +
                    delimiter + row.Message + delimiter + separator +
                    delimiter + row.SourceName + delimiter + separator +
                    delimiter + row.SourceType + delimiter + separator);

                //end of each row
                sbResult.AppendLine();
            } 
```

我试过使用`var rowData = row.GetType().GetProperties();`，但它只返回属性本身，我不知道如何获取属性的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:25:24.033

由于`Type.GetProperties`返回 的集合[`PropertyInfo`](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)，因此您可以调用[`PropertyInfo.GetValue`](http://msdn.microsoft.com/en-us/library/6s562whf.aspx). 以下是使用 LINQ 执行此操作（以及所有其他操作）的方法：

```
var line = string.Join(
             row.GetType().GetProperties()
              .Select(pi => pi.GetValue(row))
              .Select(v => delimiter + v.ToString() + delimiter),
             separator); 
```

但是，您可能需要重新考虑您的方法。如果`GetProperties`获取静态属性或索引器以及“正常”属性，此代码将中断；它还要求代码以完全信任的方式运行（否则无法进行反射）。最后，它会很**慢**，因为a）反射本质上很慢，b）它会一遍又一遍地反射同样的东西，而不缓存它已经发现的任何信息。

除了上述潜在问题之外，如果您以后想要过滤打印出来的内容的可能性很小，那么最好将此逻辑封装在 ( `virtual`?) 方法中，`row`然后执行类似的操作

```
sbResult.AppendLine(row.SerializeAsLine()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:24:34.560

```
var values = instance
    .GetType()
    .GetProperties(BindingFlags.Instance | BindingFlags.Public)
    .Select(z => string.Format("{0}: {1}\n", z.Name, z.GetValue(instance, null)));

string res = string.Concat(values); 
```

`instance`你的对象的实例在哪里。如果需要，您可能希望避免使用 LINQ 并使用循环`StringBuilder`（取决于属性的数量）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:26:09.550

您可以使用类似这样的方法来迭代特定类型的所有属性：

```
public static IEnumerable<KeyValuePair<string, T>> PropertiesOfType<T>(object obj)
{
    return from p in obj.GetType().GetProperties()
            where p.PropertyType == typeof(T)
            select new KeyValuePair<string, T>(p.Name, (T)p.GetValue(obj));
} 
```

然后，您可以`string`为所有字符串属性指定类型。

可编译样本：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleApplication1
{
    class Program
    {
        private static void Main()
        {
            var test = new Test
            {
                Str1 = "S1",
                Str2 = "S2",
                Str3 = "S3",
                Str4 = "S4"
            };

            foreach (var property in PropertiesOfType<string>(test))
            {
                Console.WriteLine(property.Key + ": " + property.Value);
            }
        }

        public static IEnumerable<KeyValuePair<string, T>> PropertiesOfType<T>(object obj)
        {
            return from p in obj.GetType().GetProperties()
                    where p.PropertyType == typeof(T)
                    select new KeyValuePair<string, T>(p.Name, (T)p.GetValue(obj));
        }
    }

    public class Test
    {
        public string Str1 { get; set; }
        public string Str2 { get; set; }
        public string Str3 { get; set; }
        public string Str4 { get; set; }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:26:14.753

这里是。

```
List<PropertyInfo> _propInfo = _row.GetType().GetProperties();

    foreach (var item in _propInfo)
    {
    object _value = item.GetValue(_row, null);
    if (_value != null)
    {
    // Save the Value
    }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T12:29:08.483

`GetProperties`返回一个数组`PropertyInfo`，因此使用该`GetValue`方法并使用您的对象作为输入来获取每个属性的值。这是代码：

```
public class MyClass
{
    public string MyProperty1 { get; set; }
    public string MyProperty2 { get; set; }
    public string MyProperty3 { get; set; }
} 
```

然后

```
MyClass myObj = new MyClass() { MyProperty1 = "first", MyProperty2 = "second", MyProperty3 = "third" };

List<string> array = new List<string>();

foreach (var item in typeof(MyClass).GetProperties())
{
    array.Add(item.GetValue(myObj, null).ToString());
}

var result = string.Join(",", array); //use your own delimiter 
```

# sql - 与 where 子句相比，dateadd() 的 on-conditions 是否慢？

> ID：16214644
> 
> 赞同：1
> 
> 时间：2013-04-25T12:22:03.830
> 
> 标签：sql, sybase

我在 a 中遇到一种情况，`select`如果我`dateadd()`从`on`-condition 移动到`where`-clause，它会变得更快。

但有时可能无法将其从`on`-condition 移至`where`-clause。我的解决方案是将`dateadd()`-condition`on`移到临时表中，这样可以加快整个存储过程。

但我很想知道；在 - 条件下比其他地方`dateadd()`慢真的是真的吗？`on`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T13:08:18.593

除非我能找到确切的 Sybase 参考资料，否则我将回答一些 SQL Server 参考资料，但所有查询优化器的工作方式都类似

首先，谓词上的 DATEADD 函数使索引使用无效（请参见[此处的第 2](https://www.simple-talk.com/sql/t-sql-programming/ten-common-sql-programming-mistakes)点）。

ON 子句当然是谓词的形式（想想旧的implicit-JOIN-in-WHERE 语法），所以同样适用。

现在，查询尊重一个[逻辑处理步骤](http://blog.sqlauthority.com/2009/04/06/sql-server-logical-query-processing-phases-order-of-statement-executio)（如果不是实际的，这就是为什么这样称呼“查询优化器”）。ON 之前 WHERE 是其中之一。

在 WHERE 子句中使用 DATEADD，它是一个残差过滤器，因为主要工作已在 ON 子句中完成以限制行。如果 DATEADD 在 ON 子句中，它会比 WHERE 子句“更快”得到处理。

这是根据[Sybase JOIN 文档](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc32300.1502/html/sqlug/sqlug169.htm)状态

> ...优化器只能考虑列名上的索引。任何类型的运算符或表达式与列名组合意味着优化器不会使用列上的索引作为可能的访问方法进行评估。如果连接中的列具有不兼容的数据类型，则优化器可以考虑仅在其中一列上建立索引。

[此Sybase 文档](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc32300.1502/html/sqlug/sqlug169.htm)中提示了查询处理顺序

同样的事情也适用于 LEFT JOIN 中的外部表过滤器，真的：在这种情况下，WHERE 子句在 LEFT JOIN 之后为时已晚。或者为什么不存在几乎总是胜过 LEFT JOIN .. IS NULL。有关[Sybase OUTER JOINS的信息，请参见此内容](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc32300.1502/html/sqlug/sqlug169.htm)

DATEADD 本身不是问题：它是逻辑查询处理顺序使它看起来像一个

# hadoop - NodeManager 未在 Hadoop Yarn 中启动

> ID：16214649
> 
> 赞同：2
> 
> 时间：2013-04-25T12:22:19.380
> 
> 标签：hadoop, hadoop-yarn

我现在已经在独立模式下设置了 hadoop 和 yarn。我正在尝试在纱线中启动所有过程。除节点管理器外，所有进程都已启动。它每次都抛出 jvm 错误。

```
 [root@ip-10-100-223-16 hadoop-0.23.7]# sbin/yarn-daemon.sh start nodemanager
starting nodemanager, logging to /root/hadoop-0.23.7/logs/yarn-root-nodemanager-ip-10-100-223-16.out
Unrecognized option: -jvm
Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occurred. Program will exit. 
```

可能是什么问题？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T09:17:19.960

以下链接有针对上述问题的补丁：[https ://issues.apache.org/jira/browse/MAPREDUCE-3879](https://issues.apache.org/jira/browse/MAPREDUCE-3879)

在**bin/yarn**脚本中，我们需要注释以下行。这里 :
**'-' : 显示删除行
'+' : 显示添加行**

```
elif [ "$COMMAND" = "nodemanager" ] ; then
   CLASSPATH=${CLASSPATH}:$YARN_CONF_DIR/nm-config/log4j.properties
   CLASS='org.apache.hadoop.yarn.server.nodemanager.NodeManager'
-  if [[ $EUID -eq 0 ]]; then
-    YARN_OPTS="$YARN_OPTS -jvm server $YARN_NODEMANAGER_OPTS"
-  else
-    YARN_OPTS="$YARN_OPTS -server $YARN_NODEMANAGER_OPTS"
-  fi
+  YARN_OPTS="$YARN_OPTS -server $YARN_NODEMANAGER_OPTS"
 elif [ "$COMMAND" = "proxyserver" ] ; then
   CLASS='org.apache.hadoop.yarn.server.webproxy.WebAppProxyServer'
   YARN_OPTS="$YARN_OPTS $YARN_PROXYSERVER_OPTS" 
```

上述补丁可在[此](https://issues.apache.org/jira/secure/attachment/12515053/MAPREDUCE-3879.patch.txt)位置获得。

感谢[LorandBendig](https://stackoverflow.com/users/1050422/lorand-bendig)对我的帮助。

# c# - 使用 Linq 的值的外键

> ID：16214652
> 
> 赞同：0
> 
> 时间：2013-04-25T12:22:25.787
> 
> 标签：c#, asp.net, sql, vb.net, linq-to-sql

我有一个使用 Linq 的网页和站点。该页面包含一个显示客户并受列表（客户）约束的网格视图。

我使用下面的代码来获得一个客户

```
 Public Function GetCustById(ByVal id As Integer) As Customer Implements ICustomerService.GetCustById
        Return DataContext.Customers.SingleOrDefault(Function(c) c.Id = id)
    End Function 
```

然后，我通过将所有客户 ID 传递到方法中，将其绑定到我的 gridview。这会显示我需要的所有行，但我有一个问题。

一些作为外键的列显示为 1,2 等，通常我过去在不同项目上克服这个问题的方法是在数据层中向我的 SQL 查询添加一个子查询，但正如你猜到的那样，这是 Linq所以我不确定为了让外键使用 Linq 显示为值是什么/不可能？

我对 Linq 有点陌生，所以感谢任何可以帮助我的帮助或文章。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T21:03:59.997

建议将视图与实体类（或您喜欢的领域类）分开。因此，您将定义一个视图模型类，例如`CustomerViewModel`，并将您的项目投影`Customer`到其中。

我不确定您如何获得客户列表（通过 Id 获取每个客户的效率非常低），但在某个地方会有一个`IEnumerable<Customer>`. 让我们称之为`customers`。现在你可以做

```
From c in customers_
Select New CustomerViewModel With { Name = c.Name, ... } 
```

但是现在您可以添加`CustomerViewModel`不在的属性`Customer`！例如

```
Select New CustomerViewModel
       With { Name = c.Name, TypeName = c.CustomerType.Name } 
```

这`CustomerType`可能是您要显示的那些外键之一。

投影的结果是`IEnumerable<CustomerViewModel>`可以在网格中显示的。

# c# - Mediaelement播放列表重复如何？

> ID：16214661
> 
> 赞同：0
> 
> 时间：2013-04-25T12:22:42.380
> 
> 标签：c#, wpf, windows, listbox, repeat

我找不到任何解决方案如何在打开最后一个文件时重置索引。我有一个从列表框中读取图像的媒体元素，当播放完最后一张图像时，我希望它重新启动。就像一个可重复的 Mediaelement 播放列表。请帮忙，我真的需要这个帮助。

```
 Dictionary<string, string> Listbox1Dict = new Dictionary<string, string>();
    public static List<string> images = new List<string> { ".JPG", ".JPE", ".BMP", ".GIF", ".PNG" }; // Bildtyper som stöds
    public static List<string> movies = new List<string> { ".WMV", ".WAV", ".SWF", ".MP4", ".MPG", ".AVI" }; // Filmtyper som stöds
    List<string> paths = new List<string>();
    DispatcherTimer dispatcherTimer = new DispatcherTimer();
    DispatcherTimer NextImageTimer = new DispatcherTimer();
    int x = 20; //Ställa in antal sekunder per bild
    private int currentSongIndex = -1;

    private void dispatcherTimer_Tick(object sender, EventArgs e)
    {
            ShowNextImage();
    }
    private void dispatch()
    {
        dispatcherTimer.Tick += new EventHandler(dispatcherTimer_Tick);
        dispatcherTimer.Interval = new TimeSpan(0, 0, 0, x);
    }

    private void ShowNextImage()
    {
        if (currentSongIndex == -1)
        {
            currentSongIndex = Listbox1.SelectedIndex;
        }
        currentSongIndex++;

        var selected = Listbox1.Items[currentSongIndex];
        string s = selected.ToString();
        if (Listbox1Dict.ContainsKey(s))
        {

            if (images.Contains(System.IO.Path.GetExtension(s).ToUpperInvariant()))
            {

                if (currentSongIndex < Listbox1.Items.Count)
                {
                    mediaElement1.Visibility = Visibility.Visible;
                    SearchBtn.Visibility = Visibility.Hidden;
                    Listbox1.Visibility = Visibility.Hidden;
                    FileNameTextBox.Visibility = Visibility.Hidden;
                    mediaElement1.Source = new Uri(Listbox1Dict[s]);
                    mediaElement1.Width = System.Windows.SystemParameters.PrimaryScreenWidth;
                    mediaElement1.Height = System.Windows.SystemParameters.PrimaryScreenHeight;
                    this.Background = new SolidColorBrush(Colors.Black);
                    this.WindowStyle = WindowStyle.None;
                    this.WindowState = WindowState.Maximized;
                    mediaElement1.StretchDirection = StretchDirection.Both;
                    mediaElement1.Stretch = Stretch.Fill;
                    dispatcherTimer.Start();

                }
            }
            else if (movies.Contains(System.IO.Path.GetExtension(s).ToUpperInvariant()))
            {
                if (currentSongIndex < Listbox1.Items.Count)
                {
                    dispatcherTimer.Stop();
                    mediaElement1.Visibility = Visibility.Visible;
                    Listbox1.Visibility = Visibility.Hidden;
                    FileNameTextBox.Visibility = Visibility.Hidden;
                    mediaElement1.Source = new Uri(Listbox1Dict[s]);
                    mediaElement1.Width = System.Windows.SystemParameters.PrimaryScreenWidth;
                    mediaElement1.Height = System.Windows.SystemParameters.PrimaryScreenHeight;
                    this.Background = new SolidColorBrush(Colors.Black);
                    this.WindowStyle = WindowStyle.None;
                    this.WindowState = WindowState.Maximized;
                    mediaElement1.StretchDirection = StretchDirection.Both;
                    mediaElement1.Stretch = Stretch.Fill;
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:36:08.507

你不能做类似的事情：

```
private void ShowNextImage()
{
    if (currentSongIndex == -1)
    {
        currentSongIndex = Listbox1.SelectedIndex;
    }
    if (currentSongIndex == ListBox1.Items.Count)
    {
        currentSongIndex = 0;
    }
    currentSongIndex++;
    ....
} 
```

# ruby-on-rails - 即使一切似乎都很好，git push heroku master 也会失败

> ID：16214665
> 
> 赞同：1
> 
> 时间：2013-04-25T12:22:50.537
> 
> 标签：ruby-on-rails, git, heroku, heroku-toolbelt

这是控制台，一切似乎都正常，直到启动模块有`git push` 什么问题？

```
# Rails Environment Configuration.

---
git:
  user.name:  Theofilos_Mouratidis
  user.email: mtheofilos@gmail.com
  version:    git version 1.7.9.msysgit.0

ruby:
  bin:        C:/RailsInstaller/Ruby1.9.2/bin/ruby.exe
  version:    ruby 1.9.3p125 (2012-02-16) [i386-mingw32]

rails:
  bin:        C:/RailsInstaller/Ruby1.9.2/bin/rails.bat
  version:    Rails 3.2.13

ssh:
  public_key_location: C:\Users\acer/.ssh/id_rsa.pub
  public_key_contents: ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAvrft8l3K12KfGo9uXrFfK
YhiQW2mHxoBIWaHXmFec7/14bx3awQLb8rG4zYZdrAWijy86vOJlk7jm07amwrOPKjkTYkIkHoclEu1y
wYS3PEPBCLe5gpPMIoej22T7X3PqLfLza3MpW6HSE3TOOT+dG74Ms0T6v8YOFQ19SiGwKTIAyF7Mczx0
xet9rKxxnRQuvyqByWq+ZOBSFao5zlqsfh8QWwGGh3thsjNo7ICDfP8tQmu57jjOTcjZC3st0tEzUoNK
zdXdz5PDLRo2fSXTKG7PhadLmLn4Cg4fhY6sOraXeYrzt9pVp0b9SYnWqTYNhi74kSx0z1i5lfna6eXk
w== Theofilos Mouratidis <mtheofilos@gmail.com>

C:\Sites>cd tama

C:\Sites\tama>heroku login
Enter your Heroku credentials.
Email: mtheofilos@gmail.com
Password (typing will be hidden):
Authentication successful.

C:\Sites\tama>git status
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   .idea/workspace.xml
#
no changes added to commit (use "git add" and/or "git commit -a")

C:\Sites\tama>git add .

C:\Sites\tama>git commit
Aborting commit due to empty commit message.

C:\Sites\tama>git commit -m "nothing"
[master cd12603] nothing
 1 files changed, 3 insertions(+), 3 deletions(-)

C:\Sites\tama>git push heroku master
Counting objects: 172, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (152/152), done.
Writing objects: 100% (172/172), 210.47 KiB | 67 KiB/s, done.
Total 172 (delta 41), reused 0 (delta 0)
remote:
remote: -----> Ruby/Rails app detected
remote: -----> WARNING: Removing `Gemfile.lock` because it was generated on Wind
ows.
remote:        Bundler will do a full resolve so native gems are handled properl
y.
remote:        This may result in unexpected gem versions being used in your app
.
remote: -----> Installing dependencies using Bundler version 1.3.2
remote:        Running: bundle install --without development:test --path vendor/
bundle --binstubs vendor/bundle/bin
remote:        Fetching gem metadata from https://rubygems.org/........
remote:        Fetching gem metadata from https://rubygems.org/..
remote:        Resolving dependencies...
remote:        Installing rake (10.0.4)
remote:        Installing i18n (0.6.1)
remote:        Installing multi_json (1.7.2)
remote:        Installing activesupport (3.2.13)
remote:        Installing builder (3.0.4)
remote:        Installing activemodel (3.2.13)
remote:        Installing erubis (2.7.0)
remote:        Installing journey (1.0.4)
remote:        Installing rack (1.4.5)
remote:        Installing rack-cache (1.2)
remote:        Installing rack-test (0.6.2)
remote:        Installing hike (1.2.2)
remote:        Installing tilt (1.3.7)
remote:        Installing sprockets (2.2.2)
remote:        Installing actionpack (3.2.13)
remote:        Installing mime-types (1.23)
remote:        Installing polyglot (0.3.3)
remote:        Installing treetop (1.4.12)
remote:        Installing mail (2.5.3)
remote:        Installing actionmailer (3.2.13)
remote:        Installing arel (3.0.2)
remote:        Installing tzinfo (0.3.37)
remote:        Installing activerecord (3.2.13)
remote:        Installing activeresource (3.2.13)
remote:        Installing authlogic (3.3.0)
remote:        Using bundler (1.3.2)
remote:        Installing coffee-script-source (1.6.2)
remote:        Installing execjs (1.4.0)
remote:        Installing coffee-script (2.2.0)
remote:        Installing rack-ssl (1.3.3)
remote:        Installing json (1.7.7)
remote:        Installing rdoc (3.12.2)
remote:        Installing thor (0.18.1)
remote:        Installing railties (3.2.13)
remote:        Installing coffee-rails (3.2.2)
remote:        Installing jquery-rails (2.2.1)
remote:        Installing pg (0.15.1)
remote:        Installing rails (3.2.13)
remote:        Installing sass (3.2.8)
remote:        Installing sass-rails (3.2.6)
remote:        Installing uglifier (2.0.1)
remote:        Your bundle is complete! It was installed into ./vendor/bundle
remote:        Post-install message from rdoc:
remote:        Depending on your version of ruby, you may need to install ruby r
doc/ri data:
remote:        <= 1.8.6 : unsupported
remote:        = 1.8.7 : gem install rdoc-data; rdoc-data --install
remote:        = 1.9.1 : gem install rdoc-data; rdoc-data --install
remote:        >= 1.9.2 : nothing to do! Yay!
remote:        Cleaning up the bundler cache.
remote: -----> Writing config/database.yml to read from DATABASE_URL
remote: -----> Preparing app for Rails asset pipeline
remote:        Detected manifest.yml, assuming assets were compiled locally
remote: -----> Rails plugin injection
remote:        Injecting rails_log_stdout
remote:        Injecting rails3_serve_static_assets
remote: -----> Discovering process types
remote:        Procfile declares types      -> (none)
remote:        Default types for Ruby/Rails -> console, rake, web, worker
remote:
remote: -----> Compiled slug size: 9.4MB
remote: -----> Launching... !     Heroku push rejected, Could not communicate wi
th vendor, please try again later
remote:
To git@heroku.com:tamagotchi-connect.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:tamagotchi-connect.git'

C:\Sites\tama> 
```

这是`Gemfile`

```
source 'https://rubygems.org'

gem 'rails', '3.2.13'

group :development do
  gem 'sqlite3'
end

group :production do
  gem 'pg'
end

group :assets do
  gem 'sass-rails'
  gem 'coffee-rails'
  gem 'uglifier'
  gem 'jquery-rails'
end

gem 'authlogic' 
```

# regex - 如何在 perl 中显示确切的搜索关键字

> ID：16214671
> 
> 赞同：0
> 
> 时间：2013-04-25T12:23:04.853
> 
> 标签：regex, perl

我正在使用正则表达式在目录中搜索关键字列表。这是我当前的代码：

```
 if (/$search/i) 
   {

        printf $out "%s\t%s\n",$File::Find::name,$1;       
   } 
```

在我上面的代码`$1`中只给出关键字词组。但我想要整个关键字。

示例：我正在搜索“扫一扫”

电流输出：`C:\ac\acfrd\file.sql SWEEP`. 但是该文件包含单词“SWEEP_ID”，我希望输出是“SWEEP_ID”，而不是“SWEEP”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T12:25:58.547

试试这个正则表达式：

```
/\b(\w*$search\w*)\b/i 
```

它将您的搜索词和可选的相邻*单词符号*（`\w`- 字母、数字等）捕获到`$1`. 捕获的字符序列被*单词边界*（`\b`- 标点符号、空格、字符串开头或结尾）包围。

上面的正则表达式允许在您的搜索词之前和之后添加额外的单词符号。如果您只想在搜索词*后*允许附加符号（如您的示例中所示），只需删除第一个`\w*`：

```
/\b($search\w*)\b/i 
```

如果你不想依赖 Perl 对“单词符号”的定义，那么`\w`用你自己的字符类替换，例如（只允许字母和下划线）：

```
/\b([_a-z]*$search[_a-z]*)\b/i 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:26:49.210

```
/($search\S+)/ 
```

这可能有效，但你的问题不清楚......

# android - android 中所有 ldpi、mdpi、hdpi、xhdpi 的单个图像

> ID：16214672
> 
> 赞同：0
> 
> 时间：2013-04-25T12:23:05.907
> 
> 标签：android, android-layout

也许我们对需要保存图像的所有 ldpi、hdpi、mdpi 和 xdpi 使用一个图像（在哪个文件夹中）。这对我来说有点困惑。任何人都可以澄清我的困惑吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:24:57.687

把它放在`res/drawable`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:26:41.600

而不是创建所有不同的文件夹桶，`drawable-ldpi`等等`drawable-hdpi`。只需创建一个文件夹，，`drawable`然后将您的图像放在那里，当 Android 搜索图像并且没有找到其他文件夹时，它将默认为该`drawable`文件夹作为唯一的资源。这个文件夹被 Android 理解为等于`drawable-mdpi`并且会相应地缩放图像。

**编辑：**也可以使用`res/drawable-nodpi`, 这根本不会缩放您的图像，并且它将在所有屏幕上保持相同的大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-25T12:25:17.810

不建议这样做，因为您使用的图像将无法很好地适应不同的设备屏幕尺寸。但是，如果您在其中放置图像，`res/drawable`则可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:28:24.950

看看[如何支持多屏](http://developer.android.com/guide/practices/screens_support.html#support)

> “默认”资源是那些没有用配置限定符标记的资源。例如drawable/中的资源就是默认的drawable资源。系统假定默认资源是为基线屏幕尺寸和密度设计的，即正常屏幕尺寸和中等密度。因此，系统会酌情为高密度屏幕向上缩放默认密度资源，为低密度屏幕向下缩放。

所以是的，drawable 文件夹就是你要找的。

# spring - 从 3.0.4 升级到 spring 3.2.2，RequestBody String 被转义

> ID：16214682
> 
> 赞同：1
> 
> 时间：2013-04-25T12:23:25.430
> 
> 标签：spring, spring-mvc

我们最近从 3.0.4 升级到 spring 3.2.2。升级后，我们注意到控制器函数中的“RequestBody”参数被转义或urlencoded。我们将 spring-beans 和 spring-mvc 的 schemaLocation 更新为 3.2.xsd。

例如在下面的控制器功能中

```
@RequestMapping(value = "/getFunnyFilters", method = RequestMethod.POST)
public ModelAndView getFunnyFilters(@RequestBody String body, HttpSession session) { 
```

3.0.4 中 body 的值是

```
{"selectedFilters":{"values":[]}} 
```

而在 3.2.2 中是

```
%7B%22selectedFilters%22%3A%7B%22values%22%3A%5B%5D%7D%7D= 
```

我们是否缺少任何设置，或者它是 3.2.2 中的默认行为。任何输入将不胜感激。

谢谢

# unit-testing - 为什么 xUnit Runner 找不到我的测试

> ID：16214684
> 
> 赞同：66
> 
> 时间：2013-04-25T12:23:30.820
> 
> 标签：unit-testing, visual-studio-2012, xunit.net, testdriven.net

我有一个 xUnit.net 测试如下：

```
static class MyTestClass
{
    [Fact]
    static void MyTestMethod() 
    {
    }
} 
```

VS 2012 的 xUnit 插件说：

> 没有发现要运行的测试。

TestDriven.net 运行良好[，但提到了一些关于 Ad hoc 的内容](http://www.testdriven.net/quickstart.aspx#Ad%20Hoc%20Tests)：

> 1 次通过，0 次失败，0 次跳过（参见“任务列表”），耗时 0.47 秒（临时）

TeamCity`xunit.gui.exe`和`xunit.console.exe`Visual Studio 也找不到`TestMethod`

（我已经`xunit.runner.visualstudio`安装并且 VS 正在查看一些测试。）

是什么赋予了？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-04-25T12:24:28.310

TL;DR 你的测试类***必须***是`public`（但你的测试方法可以是`private`和/或`static`）

* * *

出于效率的原因，xUnit 作者选择`BindingFlags.NonPublic`在运行器中搜索测试类时不使用（MSIL 元数据表不会以相同程度索引`private`(/ `internal`) 类，因此相对效率存在显着的性能差异，即因此可以实现反射）。

***由于上述原因，您的`class`is`private`意味着它不会被拾取。***

**`private`测试方法很好而且很好的事实`static`- 自 1.0 以来的 xUnit 设计支持这两个方面。**

请注意，Visual Studio xUnit Runner 扩展`xunit.console.exe`（和 GUI）、`xunit`MSBuild 任务、Resharper 和 CodeRush 在遵守这一点方面都是一致的（尽管可以说它们 [尤其是后两者] 可以在测试类（即类[可能间接地]包含`Fact`-派生的注释）是`private`）。

TestDriven.net 运行您的测试的原因是 TestDriven.net 的作者已经付出了巨大的努力来使其正常工作。它在内部使用一个特殊的 Test Runner 包装器/垫片（称为 Adhoc Runner）来运行您的测试。请注意，该方法实际上并未通过 xUnit.net 运行程序运行，因此您在测试中放置的任何具有副作用的属性都不会被触发。

值得注意的是，NUnit（我很确定 MSTest）*确实*使用了私有反射 [因此在`private`课堂上进行测试]，这可能就是为什么它似乎从来没有让你担心过重要的事情。

注意：由此启用的副作用/技巧是，您可以创建一个测试类`private`作为`Skip`ping 测试类 [和任何嵌套类] 中所有测试的快速方法。（可悲的是，在这个星球上，无意中使用这个的案例远远超过了有意使用的案例！）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-01-09T23:15:18.180

此答案适用于 VS 2013，但步骤与 VS 2012 基本相同。这适用于通过[ReSharper 的单元测试功能运行](http://www.jetbrains.com/resharper/features/unit_testing.html)。

1.  为 Visual Studio 2013 安装 xUnit.net 运行程序（小心以管理员身份运行 Visual Studio，否则在以非管理员身份运行 IDE 时测试可能无法运行）：

    一种。在 Visual Studio 2013 中，转到工具 -> 扩展和更新 -> 在线

    湾。为 Visual Studio 2012 和 2013 搜索 xUnit.net 运行器

    C。然后下载（安装）它。如果从 VS 2012 升级到 VS 2013，建议先卸载这个，然后重新安装。

    d。重新启动 Visual Studio。

2.  如果安装了 ReSharper，请安装 xUnit.net 测试运行器插件：

    （注意：自 ReSharper 2016.1 起，ReSharper[内置了 xunit 支持](https://blog.jetbrains.com/dotnet/2016/04/14/resharper-ultimate-2016-1-is-released/)，这意味着不再需要 xunit 插件。）

    一种。在 Visual Studio 2013 中，导航：Resharper -> 扩展管理器。

    湾。在左侧，选择在线。

    C。搜索“xunit.net”。选择“xUnit.net 测试支持”。单击安装。

    d。重新启动 Visual Studio 2013。

3.  “清洁”解决方案

    一种。在 IDE 的解决方案资源管理器中，右键单击解决方案，然后选择“清理”。

    湾。重新编译。

    C。现在，当右键单击`[Fact]`属性时，选择 Resharper 的“运行单元测试”（而不是默认的“运行测试”）

**使用 XUnit 运行故障排除：**

*   如果使用 XUnit 运行 [Fact] 测试仍然存在问题，则可能需要从以下任何/所有文件夹中手动删除 xUnit 包（查看 xunit DLL 的内容，如果找到，则删除 xUnit 文件夹）：

    *   `C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\Extensions\`

    *   `C:\Users\<username>\AppData\Local\Microsoft\VisualStudio\12.0\Extensions\`

*   至于 ReSharper，请尝试卸载并重新安装 xunitcontrib 库（xUnit.net 测试支持）。我注意到卸载时有一次，一些错误消息闪烁过去。我有一次抓了一张屏幕截图，上面列出了：

    *   访问路径 `C:\Users\<username>\AppData\Local\JetBrains\ReSharper\vAny\packages\xunitcontrib.1.3.0\ReSharper\v8.1\plugins\xunit.dll` 被拒绝。
    *   ...对于该目录中的其他 DLL 也是如此

要解决此问题，请`C:\Users\<username>\AppData\Local\JetBrains\ReSharper\vAny\packages\xunitcontrib.1.3.0\`在从 Visual Studio 卸载后删除该目录，然后以非管理员身份运行 Visual Studio，然后通过 ReSharper（Resharper -> Extension Manager）重新安装

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-10-19T08:09:51.403

来自[http://xunit.github.io/docs/getting-started-desktop.html#run-tests-visualstudio](http://xunit.github.io/docs/getting-started-desktop.html#run-tests-visualstudio)：

> 如果您在发现或运行测试时遇到问题，您可能是 Visual Studio 中损坏的运行程序缓存的受害者。要清除此缓存，请关闭 Visual Studio 的所有实例，然后删除文件夹 %TEMP%\VisualStudioTestExplorerExtensions。还要确保您的项目仅链接到单个版本的 Visual Studio 运行程序 NuGet 包 (xunit.runner.visualstudio)。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-03-06T00:49:23.747

我在 VS2017 RC，.NET core 1.1 项目中遇到了同样的问题。更新 xunit.runner 对我有用，

```
Install-Package xunit.runner.visualstudio 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-11-26T02:31:57.143

（正如@Kyle 在另一个答案的评论中所提到的）`No tests found to run`使用 NuGet 获取 xUnit.dll 并最终获得版本 2.0.0 （当前标记为预发布作为一些核心功能，如发现v1 测试等尚未在该分支中实施）。

在这种情况下，解决方案是在 NuGet 包管理器中选择**Stable Only**版本（而不是**Include Prerelease ）。**

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-10T09:41:50.923

就我而言，为了查看任何测试，我必须完成以下步骤：

（全部通过 NuGet 包管理器安装）

1.  安装`xUnit`v2.0.50727
2.  安装`xUnit.extensions`v2.0.50727
3.  导航到以下链接并按照文档中概述的步骤操作：http: [//xunit.github.io/docs/running-tests-in-vs.html](http://xunit.github.io/docs/running-tests-in-vs.html)

我正在使用 Visual Studio 2013 Premium。（未安装 Resharper）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-08-09T15:05:51.253

对我来说，我的测试类和测试方法名称的组合太长了；xUnit 似乎对这种组合有一些限制。

*仅*缩短测试方法的名称允许 xUnit 发现单个测试。缩短整个*类*的名称允许 xUnit 发现类中的所有测试。

类名 + 方法名的阈值似乎是 172 个字符。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-12-07T02:51:52.400

一段时间以来，我一直在使用 .NET Core 遇到这个问题，其中没有发现测试类或测试方法。以下修复适用于我：

1.  打开命令提示符窗口。
2.  切换到项目目录。
3.  运行以下命令构建项目：

    ```
    dotnet build 
    ```

注意：从 Visual Studio.NET 构建将不起作用！<<<<<<<<<<<**重要！**

4.  运行测试：测试 --> 运行 --> 全部测试 - CTRL+R +A （这将发现新的测试 - 但不运行新的测试。
5.  再次运行测试。

# java - 是否可以将日历 c 设置为日历 c2？

> ID：16214685
> 
> 赞同：6
> 
> 时间：2013-04-25T12:23:31.647
> 
> 标签：java

我有：

```
Calendar c = Calendar.getInstance();
c.set(Calendar.HOUR_OF_DAY,1);
c.set(Calendar.MINUTE,23);
c.set(Calendar.SECOND,22);

Calendar c2 = Calendar.getInstance();

c2 = c ; // 
```

如果我想将 Calendar c2 设置为等于 Calendar c，这最后一条语句是否正确？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-25T12:26:09.867

尽管`c2 = c`看起来可行，但这不是您想要的：两个变量都将指向同一个日历实例。作为此分配的结果，对 所做的任何更改也`c`将在`c2`其中，反之亦然。

您可以使用`clone()`方法来制作对象的副本`Calendar`，如下所示：

```
Calendar c= (Calendar)c2.clone(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T12:29:07.410

这个说法：

```
c2 = c ; 
```

会将 的值复制`c`到`c2`. 的值`c`不是一个对象——*它*`Calendar`是一个引用。在此语句之后，两个变量具有相同的值 - 对同一对象的两个引用。`Calendar`可以通过任一变量观察对象的任何变化。

这就像给两个不同的人一张纸，上面写着你的家庭住址——如果一个人使用这个地址去你家并将前门涂成绿色，那么另一个人也会看到这一点。

请注意，这不是特定的 - 这是Java中*所有*`Calendar`类的赋值行为。

 *（基本上，区分变量、引用和对象非常重要。在正常讨论中，为了简洁起见，这三者经常被错误地使用，但你需要能够在需要时区分它们。）

请注意，此代码：

```
Calendar c2 = Calendar.getInstance();
c2 = c; 
```

正在毫无意义地创建一个新`Calendar`实例。它会更明智地写成：

```
Calendar c2 = c; 
```

该代码将具有相同的可见效果，但无需调用`Calendar.getInstance()`然后丢弃新创建的对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-25T12:27:46.187

c2 = c 意味着您将有 2 个字段指向同一个实例。如果你修改 c 你也会修改 c2

c2 = c.clone() 克隆实例并返回另一个实例。如果你修改 c 你不会修改 c2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:25:28.437

日历类有一个方法`compareTo`。看看那个

[相比于（）](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html#compareTo%28java.util.Calendar%29)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-25T12:26:21.407

你甚至不需要`c2 = Calendar.getInstance()`，直接分配'c2 = c'。*

# javascript - 在javascript的每个函数上获取不存在的textarea id？

> ID：16214694
> 
> 赞同：0
> 
> 时间：2013-04-25T12:23:58.950
> 
> 标签：javascript, html

我已经动态创建了用户表单，其中所有输入和文本区域控件都是动态创建的。在下面的代码中，我试图获取特定形式的所有输入和 textarea 的 id，并且在输入的情况下，获取正确的值但获取 textarea 的错误值。

```
$('#Detailcontact input, textarea').each(function() {   
    arr[i++] = this.id;
}); 
```

表单上只有一个 textarea，但此函数返回多个不存在的 textarea id。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:25:33.220

你需要做：

```
$('#Detailcontact input, #Detailcontact textarea').each(function() {  
  arr[i++] = this.id;
}); 
```

或`.find`改为使用。

```
$('#Detailcontact').find('input,textarea').each(function() {  
   arr[i++] = this.id;
}); 
```

你也可以这样做：

```
$('input,textarea', '#Detailcontact').each(function() {  
   arr[i++] = this.id;
}); 
```

# c# - 将两个 TrackBar 添加到 UserControl

> ID：16214698
> 
> 赞同：1
> 
> 时间：2013-04-25T12:24:10.293
> 
> 标签：c#, winforms, user-controls, trackbar

我正在使用 TrackBars，我必须在单个 UserControl 中并行添加两个 TrackBars，所以我可以将它们一个用于“低值”，第二个用于“高值”。

我也问过类似的问题，链接如下：

[如何制作具有两个手柄（针）的 SlideBar（TrackBar）](https://stackoverflow.com/q/16197686/1147352)

我在下面附上了我开始设计的图像，我也添加了工具提示，但现在我被困在如何覆盖或添加额外功能以将两个 Trackbars 中的值提取到单独的 TextBoxes/Labels 等中，并且不绑定它们相互重叠意味着 Min(Low) 不会超过 Max(High) ![在此处输入图像描述](https://i.stack.imgur.com/oeTEr.png)

# view - 我的图片没有出现在我设备的屏幕上

> ID：16214702
> 
> 赞同：1
> 
> 时间：2013-04-25T12:24:17.573
> 
> 标签：view, image

您好，

我的设备有问题。我创建了一个布局。它适用于模拟器。但是当我将项目导出到我的 GS3 时，图像视图消失了。

我能做些什么 ？我尝试删除按钮以查看图片是否出现，但它不起作用。

我的图片是png格式的。

谢谢

```
 //Obtenir les dimensions de l'écran
    Display display = getWindowManager().getDefaultDisplay();

    int largeur = display.getWidth();
    int hauteur= display.getHeight();
    int orientation = display.getOrientation();

    if (orientation==1 || orientation==3)
    {
        LinearLayout accueil = new LinearLayout(this);// création de la page d'accueil sans passer par les xml
        accueil.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
        accueil.setBackgroundColor(0xFF6E2524);
        accueil.setOrientation(LinearLayout.VERTICAL);

        TextView title = new TextView(this);//creation du titre
        LayoutParams lparams1 = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT);
        title.setLayoutParams(lparams1);//fixer largeur hauteur
        title.setGravity(Gravity.CENTER);
        title.setTextColor(0xFFFFFFFF);
        title.setText("Toucher pour créer");
        title.setTextSize(TypedValue.COMPLEX_UNIT_PX, hauteur*8/100);//réglage pour adapter le texte à la taille de l'écran
        accueil.addView(title); // ajout au layout principal

        Button b1 = new Button(this);
        LinearLayout.LayoutParams lparams2 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT);
        lparams2.setMargins(largeur/8, hauteur/18, largeur/8, 0); //fixe les marges
        b1.setLayoutParams(lparams2);//fixer largeur hauteur
        b1.setMinimumWidth(largeur*8/10);//fixe la largeur minimal 
        b1.setBackgroundColor(0xFFB7C025);
        b1.setGravity(Gravity.CENTER);
        b1.setTextColor(0xFFFFFFFF);
        b1.setText("Galerie des oeuvres");
        b1.setTextSize(TypedValue.COMPLEX_UNIT_PX, hauteur*5/100);//réglage pour adapter le texte à la taille de l'écran
        accueil.addView(b1); // ajout au layout principal

        Button b2 = new Button(this);
        LinearLayout.LayoutParams lparams3 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT);
        lparams3.setMargins(largeur/8, hauteur/18, largeur/8, 0); //fixe les marges
        b2.setLayoutParams(lparams3);//fixer largeur hauteur
        b2.setMinimumWidth(largeur*8/10);//fixe la largeur minimal 
        b2.setBackgroundColor(0xFFB7C025);
        b2.setGravity(Gravity.CENTER);
        b2.setTextColor(0xFFFFFFFF);
        b2.setText("Prise en main");
        b2.setTextSize(TypedValue.COMPLEX_UNIT_PX, hauteur*5/100);//réglage pour adapter le texte à la taille de l'écran
        accueil.addView(b2); // ajout au layout principal

        Button b3 = new Button(this);
        LinearLayout.LayoutParams lparams4 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT);
        lparams4.setMargins(largeur/8, hauteur/18, largeur/8, 0); //fixe les marges
        b3.setLayoutParams(lparams4);//fixer largeur hauteur
        b3.setMinimumWidth(largeur*8/10);//fixe la largeur minimal 
        b3.setBackgroundColor(0xFFB7C025);
        b3.setGravity(Gravity.CENTER);
        b3.setTextColor(0xFFFFFFFF);
        b3.setText("Quitter");
        b3.setTextSize(TypedValue.COMPLEX_UNIT_PX, hauteur*5/100);//réglage pour adapter le texte à la taille de l'écran
        accueil.addView(b3); // ajout au layout principal

        ImageView logo = new ImageView(this);
        LinearLayout.LayoutParams lparams5 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, hauteur/15);//calculer pour garder le ratio 1/2
        lparams5.setMargins(largeur/18, hauteur/18, 0, 0); //fixe les marges
        logo.setLayoutParams(lparams5);
        logo.setAdjustViewBounds(true);
        logo.setImageResource(R.drawable.logo);
        accueil.addView(logo);//ajout au layout ppl

        setContentView(accueil);//mise en place du layout accueil
    }
    else
    {
    LinearLayout accueil = new LinearLayout(this);// création de la page d'accueil sans passer par les xml
    accueil.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
    accueil.setBackgroundColor(0xFF6E2524);
    accueil.setOrientation(LinearLayout.VERTICAL);

    TextView title = new TextView(this);//creation du titre
    LayoutParams lparams1 = new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT);
    title.setLayoutParams(lparams1);//fixer largeur hauteur
    title.setGravity(Gravity.CENTER);
    title.setTextColor(0xFFFFFFFF);
    title.setText("Toucher pour créer");
    title.setTextSize(TypedValue.COMPLEX_UNIT_PX, largeur*8/100);//réglage pour adapter le texte à la taille de l'écran
    accueil.addView(title); // ajout au layout principal

    Button b1 = new Button(this);
    LinearLayout.LayoutParams lparams2 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT);
    lparams2.setMargins(largeur/8, hauteur/8, largeur/8, 0); //fixe les marges
    b1.setLayoutParams(lparams2);//fixer largeur hauteur
    b1.setMinimumWidth(largeur*8/10);//fixe la largeur minimal 
    b1.setBackgroundColor(0xFFB7C025);
    b1.setGravity(Gravity.CENTER);
    b1.setTextColor(0xFFFFFFFF);
    b1.setText("Galerie des oeuvres");
    b1.setTextSize(TypedValue.COMPLEX_UNIT_PX, largeur*6/100);//réglage pour adapter le texte à la taille de l'écran
    accueil.addView(b1); // ajout au layout principal

    Button b2 = new Button(this);
    LinearLayout.LayoutParams lparams3 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT);
    lparams3.setMargins(largeur/8, hauteur/8, largeur/8, 0); //fixe les marges
    b2.setLayoutParams(lparams3);//fixer largeur hauteur
    b2.setMinimumWidth(largeur*8/10);//fixe la largeur minimal 
    b2.setBackgroundColor(0xFFB7C025);
    b2.setGravity(Gravity.CENTER);
    b2.setTextColor(0xFFFFFFFF);
    b2.setText("Prise en main");
    b2.setTextSize(TypedValue.COMPLEX_UNIT_PX, largeur*6/100);//réglage pour adapter le texte à la taille de l'écran
    accueil.addView(b2); // ajout au layout principal

    Button b3 = new Button(this);
    LinearLayout.LayoutParams lparams4 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT);
    lparams4.setMargins(largeur/8, hauteur/8, largeur/8, 0); //fixe les marges
    b3.setLayoutParams(lparams4);//fixer largeur hauteur
    b3.setMinimumWidth(largeur*8/10);//fixe la largeur minimal 
    b3.setBackgroundColor(0xFFB7C025);
    b3.setGravity(Gravity.CENTER);
    b3.setTextColor(0xFFFFFFFF);
    b3.setText("Quitter");
    b3.setTextSize(TypedValue.COMPLEX_UNIT_PX, largeur*6/100);//réglage pour adapter le texte à la taille de l'écran
    accueil.addView(b3); // ajout au layout principal

    ImageView logo = new ImageView(this);
    LinearLayout.LayoutParams lparams5 = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, hauteur/20);//calculer pour garder le ratio 1/2
    lparams5.setMargins(largeur/18, hauteur/18, 0, 0); //fixe les marges
    logo.setLayoutParams(lparams5);
    logo.setAdjustViewBounds(true);
    logo.setImageResource(R.drawable.logo);
    accueil.addView(logo);//ajout au layout ppl

    setContentView(accueil);//mise en place du layout accueil
    } 
```

# ruby-on-rails - Ruby on Rails 的沙盒插件

> ID：16214705
> 
> 赞同：0
> 
> 时间：2013-04-25T12:24:31.620
> 
> 标签：ruby-on-rails, ruby, plugins

我正在寻找一个网络应用程序，它将运行来自不受信任的来源（即社区提交）的插件。所以我需要将这些插件锁定到一个只允许某些访问权限的沙箱中（不能写入磁盘等）。理想情况下，插件只能使用某些经过批准的包和 API。

这在 Ruby on Rails 中可行吗？如果是这样，您能否向我指出可以帮助我入门的软件包或文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:25:57.890

将 $SAFE 设置为 4，这应该可以解决问题。

# codeigniter - 未定义的属性：my_controller::$db

> ID：16214708
> 
> 赞同：-1
> 
> 时间：2013-04-25T12:24:40.857
> 
> 标签：codeigniter

严重性：通知

消息：未定义的属性：my_controller::$db

文件名：库/Session.php

行号：88

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-25T12:43:15.243

利用

```
$this->load->database(); 
```

在所有数据库操作之前。或打开 application/config/autoload.php 并搜索

**$autoload['libraries'] = array();** 将其替换为

```
$autoload['libraries'] = array('database','session'); 
```

# c++ - c++ 使用stringstreams自定义字符串格式

> ID：16214709
> 
> 赞同：1
> 
> 时间：2013-04-25T12:24:46.187
> 
> 标签：c++, string-formatting

我正在尝试使用新的 stringstreams 方法将某些 float+int 组合转换为某种格式，但尝试查看是否有更好的方法来处理此问题：

现在使用 //string String = static_cast( &(ostringstream() << Number) )->str(); 一种模式 - 如何将其存储为格式的字符串形式 - “1.10(3)”。精度等于小数。这里的问题是这些值都不是常量。即使解决方案不能是内联函数或字符串流 - 只要它足够通用就可以。另请注意，最终计划是将此字符串用于 GDI 文本字符串。

在此先感谢-如果有人可以提供帮助。

这是我当前的示例代码（并正在寻找另一种有效的方法来完成此操作）：

```
string Convert(float number,int decimals)
{
std::ostringstream buff;
buff<<setprecision(decimals)<<fixed<<number;
return buff.str();
}

float f=1.1;     // this can have any values from 1,1.5 or 1.52
int decimals=2;  //dynamic number - calculated by other means - not a fixed number
int i=3;         // some dynamic number as well - calculated by other means

string s=Convert(f,decimals)+"("+Convert(i,0)+")";  // output - 1.10(3) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T12:32:21.113

您可以使用[`std::fixed`](http://www.cplusplus.com/reference/ios/fixed/)、[`std::setprecision`](http://www.cplusplus.com/reference/iomanip/setprecision/)和[`std::setw`](http://www.cplusplus.com/reference/iomanip/setw/)定义：[`std::setfill`](http://www.cplusplus.com/reference/iomanip/setfill/)[`<iomanip>`](http://www.cplusplus.com/reference/iomanip/)

```
float f=1.1;  
int decimals=2;
int i=3;
ostringstream ss;
ss << std::fixed << std::setprecision(decimals) << f << '(' << i << ')';
string str = ss.str(); 
```

哪个输出：

```
1.10(3) 
```

您还可以配置 stringstream 并保留此配置：

```
ostringstream ss;
ss.precision(5);
ss.setf(std::ios::fixed); 
```

**编辑**

**如果您真的**想这样做，您仍然可以在一行中执行此操作：

```
string str = ((ostringstream&)(ostringstream() << fixed << setprecision(decimals) << f << '(' << i << ')')).str(); 
```

如果你想要一个`LPCWSTR`( `const wchar_t *`) 而不是`LPCSTR`( `const char*`)，你应该使用`wstringstream`而不是`stringstream`。

```
ostringstream ss;
string str = ss.str();
LPCSTR* c_str = str.c_str();

wostringstream wss;
wstring wstr = wss.str();
LPCWSTR* wc_str = wstr.c_str(); 
```

如果你想要一个`LPCTSTR`（`LPCSTR`或者`LPCWSTR`如果`UNICODE`被定义），你可以使用`typedef`这样的：

```
typedef std::basic_string<TCHAR> tstring;
typedef std::basic_ostringstream<TCHAR , std::char_traits<TCHAR> > tstringstream;

tostringstream tss;
tstring tstr = tss.str();
LPCTSTR* tc_str = tstr.c_str(); 
```

TCHAR 是一个`char *`if`UNICODE`没有在你的项目中定义并且一个`wchar_t *`if`UNICODE`被定义。

# raphael - raphael.js 纸是真正的画布吗？

> ID：16214719
> 
> 赞同：4
> 
> 时间：2013-04-25T12:25:09.323
> 
> 标签：raphael

我正在研究一个项目要使用什么图形，而 Raphael.js 成为了最有力的竞争者。但是，在阅读示例代码和文档时，它显示 Raphael 创建了一个画布（通过[主页](http://raphaeljs.com/)上的 paper 变量），然后您向其中添加内容。两个月后，一个路人过来问我们项目的一些问题，我解释说我们没有使用 Raphael（而是选择了静态 SVG 和 D3），因为 Raphael 使用的是 canvas，如果使用，我们的项目会受到很大的不利影响帆布。所以你拉斐尔专家在那里，拉斐尔的画布是不是真正的html画布？以及您在哪里可以链接到它，以便您/和/或我可以发送拉取请求以更好地解释这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T12:40:38.183

没有拉斐尔的论文`SVG`。

这有点奇怪，因为纸对象属性被调用`canvas`但它只包含`SVGAnimatedString`

小提琴：http: [//jsfiddle.net/V2DGy/](http://jsfiddle.net/V2DGy/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-26T05:09:35.163

Raphael 使用 SVG 和 VML 创建图形。该变量`canvas`被简单地命名为画布，而不是画布元素。事实上，它是与该特定论文相关联的根 SVG 元素。

Raphael 与 d3 非常相似，但更多的是图形库的第几行以及与 Internet Explorer 6 到 8 兼容的额外优势（使用 VML 而不是 SVG。）

尽管变量名称具有误导性，但 Raphael 在其主页中预先提到它是 SVG 库。

引用他们的网站。

* * *

Raphaël 是一个小型 JavaScript 库，可以简化您在 Web 上使用矢量图形的工作。例如，如果您想创建自己的特定图表或图像裁剪和旋转小部件，您可以使用此库简单轻松地实现它。Raphaël ['ræfeɪəl] 使用 SVG W3C Recommendation 和 VML 作为创建图形的基础。这意味着您创建的每个图形对象也是一个 DOM 对象，因此您可以附加 JavaScript 事件处理程序或稍后修改它们。Raphaël 的目标是提供一个适配器，使绘图矢量艺术跨浏览器兼容且容易。Raphaël 目前支持 Firefox 3.0+、Safari 3.0+、Chrome 5.0+、Opera 9.5+ 和 Internet Explorer 6.0+。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T12:36:02.197

不，是 svg。完全不同。Canvas 包含“一张图片”，svg 包含矢量元素。

# wpf - WPF Listview Gridview 样式列标题演示器

> ID：16214721
> 
> 赞同：1
> 
> 时间：2013-04-25T12:25:12.043
> 
> 标签：wpf, styles

我正在为 WPF 中的 gridview 制作一个样式，它由几个部分组成，目前我被列标题部分卡住了

我为 GridViewColumnHeader 制作了样式，但现在我需要为其容器设置样式

是否有类似于“DataGridColumnHeadersPresenter”的部分，它是所有列的包装器？

任何帮助在哪里可以找到控件的部件？我想找到该部分的名称和它的默认模板。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:57:39.777

[Snoop](http://snoopwpf.codeplex.com/)非常出色的另一个原因。

您可以让 Snoop 识别您要查找的元素

![在此处输入图像描述](https://i.stack.imgur.com/vaLoD.png)

猜猜这`GridViewHeaderRowPresenter`就是你要找的东西。

# java - 在 Java 中使用反射调用 Singleton 类中的方法

> ID：16214723
> 
> 赞同：3
> 
> 时间：2013-04-25T12:25:12.933
> 
> 标签：java, android, reflection, singleton

我有以下课程：

```
Public class ABCinfo { 
    private static ABCinfo instance = null;
    Public static ABCinfo getInstance(Param param); // get instance
    Private ABCinfo(Param); // making a Singleton class
    Public void methodA(Param1 param1); // need to invoke this method
} 
```

在java中使用反射，我怎样才能调用`methodA()`. 基本上我正在编写一个Android应用程序，我想在手机中已经存在的（假设它会一直存在）应用程序中使用方法。

以下是我尝试过的事情：

```
String apkName = activity.getPackageManager().getApplicationInfo(packageName, 0).sourceDir;

PathClassLoader myPathClassLoader =
    new dalvik.system.PathClassLoader(
    apkName,
    ClassLoader.getSystemClassLoader());

Class<?> handler = Class.forName(className, true, myPathClassLoader);
Method m0 = handler.getDeclaredMethod("getInstance", new Class[] { Param.class  });
m0.setAccessible(true);
Object b = m0.invoke(null, new Object[]{ Param});
Method m = handler.getMethod("methodA", new Class[] { Param1.class});
Param1 methodParameter = "asdf";
Object b1 = m.invoke(b, new Object[] { methodParameter }); 
```

但它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T10:16:51.453

我找到了解决方案，如下所示

```
Object b1 = m.invoke(handler.newInstance(), new Object[] { methodParameter }); 
```

# javascript - js中的函数提升

> ID：16214724
> 
> 赞同：2
> 
> 时间：2013-04-25T12:25:16.533
> 
> 标签：javascript, hoisting

```
function mymethod(){
  alert("global mymethod");
}

function mysecondmethod(){
  alert("global mysecondmethod");
}

function hoisting(){
  alert(typeof mymethod);
  alert(typeof mysecondmethod);

  mymethod();         // local mymethod
  mysecondmethod(); // TypeError: undefined is not a function

  // mymethod AND the implementation get hoisted
  function mymethod(){
    alert("local mymethod");  
}

// Only the variable mysecondmethod get's hoisted
var mysecondmethod = function() {
    alert("local mysecondmethod");  
};
}
hoisting(); 
```

我无法理解在这种情况下吊装是如何工作的，以及为什么`alert("local mysecondmethod");`没有显示。如果有人可以告诉我顺序会很有帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:31:00.300

在您的`hoisting`函数内部，代码重新排序如下：

```
function hoisting(){
  var mysecondmethod;

  function mymethod(){
    alert("local mymethod");  
  }

  alert(typeof mymethod);
  alert(typeof mysecondmethod);

  mymethod();
  mysecondmethod();

  mysecondmethod = function() {
    alert("local mysecondmethod");  
  };
} 
```

在这里很明显，您`mysecondmethod`在函数范围内创建了一个新变量，它覆盖了您的外部定义。但是，在调用函数时，它还没有定义（还），因此您会遇到错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:29:55.470

理解提升的最简单方法是获取所有 var 语句并将它们移动到包含它们的函数的顶部：

```
function hoisting(){
  var mysecondmethod; // locally undefined for now
  alert(typeof mymethod);
  alert(typeof mysecondmethod);

  mymethod();         // local mymethod
  mysecondmethod(); // TypeError: undefined is not a function

  // mymethod AND the implementation get hoisted
  function mymethod(){
    alert("local mymethod");  
  }

  // Only the variable mysecondmethod get's hoisted
  mysecondmethod = function() {
    alert("local mysecondmethod");  
  };
}
hoisting(); 
```

# java - HQL：选择语句以及使用“case when then”给出意外的令牌错误

> ID：16214729
> 
> 赞同：2
> 
> 时间：2013-04-25T12:25:25.213
> 
> 标签：java, sql, hibernate, hql

我在编写 Hql 查询时遇到问题。

我有一个名为 MyTable 的 mysql 表，其列名称为 Id、Column1、Column2 和 Type。所有字段都是整数类型。

选择查询基于“类型”列中的值。如果“类型”列中 `0` 的值是 Column1 中基于选择查询的值。如果类型列中的值是，`1`则选择查询将基于列 2 中的值。

我已经使用“case when then”成功编写了查询。但是当用作 Hql 查询时，相同的查询给出异常

SQL查询：

```
select * from  MyTable where case when Type=0 then Column1=234 when Type=1 then       Column2=564 end; 
```

HQL查询：

```
from MyTableObj obj where case when obj.type=0 then obj.column1=234 when obj.type=1 then obj.column2=564 end; 
```

给出以下错误，

```
 17:30:16,197 ERROR [PARSER] line 1:127: unexpected token: =
 17:30:16,198 ERROR [PARSER] line 1:134: unexpected token: end
 17:30:16,199 WARN  [HqlParser] processEqualityExpression() : No expression to process!
 org.hibernate.hql.ast.QuerySyntaxException: unexpected token: = near line 1, column 127 [from MyTableObj obj where case when obj.type=0 then obj.column1=234 when obj.type=1 then obj.column2=564 end]
    at org.hibernate.hql.ast.QuerySyntaxException.convert(QuerySyntaxException.java:54)
    at org.hibernate.hql.ast.QuerySyntaxException.convert(QuerySyntaxException.java:47)
    at org.hibernate.hql.ast.ErrorCounter.throwQueryException(ErrorCounter.java:82)
    at org.hibernate.hql.ast.QueryTranslatorImpl.parse(QueryTranslatorImpl.java:281)
    at org.hibernate.hql.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:180)
    at org.hibernate.hql.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:134)
    at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:101)
    at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:80)
    at org.hibernate.engine.query.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:94)
    at org.hibernate.impl.AbstractSessionImpl.getHQLQueryPlan(AbstractSessionImpl.java:156)
    at org.hibernate.impl.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:135)
    at org.hibernate.impl.SessionImpl.createQuery(SessionImpl.java:1650) 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-25T19:13:05.690

我做了类似的事情，但是条件的值是相同的，唯一会根据数据库中的某个值发生变化的是列。这是一个例子：

```
SELECT t.* FROM table t
WHERE CASE WHEN t.column1 = 1
   THEN t.column2
   ELSE t.column3
END = 123; 
```

这对我有用。如果您希望您的值（在我的示例中为 123）依赖于像列这样的条件，您也可以使用 CASE 语句。

在 SQL 中检查[这个例子](http://mitchelsellers.com/blogs/2009/01/09/creating-dynamic-where-clauses-with-sql.aspx)，它也应该适用于 HQL。

# python - 在 Python 中将数据写入磁盘作为后台进程

> ID：16214736
> 
> 赞同：7
> 
> 时间：2013-04-25T12:25:33.720
> 
> 标签：python, file, multiprocessing

我有一个 Python 程序，它基本上执行以下操作：

```
for j in xrange(200):
    # 1) Compute a bunch of data
    # 2) Write data to disk 
```

1) 大约需要 2-5 分钟
2) 大约需要 ~1 分钟

请注意，要保存在内存中的数据太多。

理想情况下，我想做的是以避免 CPU 空闲的方式将数据写入磁盘。这在 Python 中可能吗？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-25T12:33:06.380

您可以尝试[使用这样的多个进程](http://docs.python.org/2/library/multiprocessing.html)：

```
import multiprocessing as mp

def compute(j):
    # compute a bunch of data
    return data

def write(data):
    # write data to disk

if __name__ == '__main__':
    pool = mp.Pool()
    for j in xrange(200):
        pool.apply_async(compute, args=(j, ), callback=write)
    pool.close()
    pool.join() 
```

`pool = mp.Pool()`将创建一个工作进程池。默认情况下，worker 的数量等于您的机器拥有的 CPU 内核的数量。

每个[pool.apply_async](http://docs.python.org/2/library/multiprocessing.html#multiprocessing.pool.multiprocessing.Pool.apply_async)调用排队一个任务，由工作进程池中的工作人员运行。当工作人员可用时，它会运行`compute(j)`. 当worker返回一个值时，`data`主进程中的一个线程运行回调函数`write(data)`，`data`作为worker返回的数据。

一些警告：

*   数据必须是可挑选的，因为它是通过[Queue](http://docs.python.org/2/library/multiprocessing.html#exchanging-objects-between-processes)从工作进程传回主进程的。
*   无法保证工作人员完成任务的顺序与将任务发送到池中的顺序相同。因此，数据写入磁盘的顺序可能不对应于`j`从 0 到 199 的范围。解决此问题的一种方法是将数据写入 sqlite（或其他类型的）数据库，并将其`j`作为数据字段之一. 然后，当您希望按顺序读取数据时，您可以`SELECT * FROM table ORDER BY j`.
*   使用多个进程将增加所需的内存量，因为工作进程生成数据并且等待写入磁盘的数据会累积在队列中。您也许可以通过使用 NumPy 数组来减少所需的内存量。如果这不可能，那么您可能必须减少进程数：

    ```
    pool = mp.Pool(processes=1) 
    ```

    这将创建一个工作进程（运行`compute`），让主进程运行`write`。由于`compute`需要比 更长 `write`的时间，因此队列不会备份超过一大块要写入磁盘的数据。但是，您仍然需要足够的内存来计算一个数据块，同时将另一块数据写入磁盘。

    如果您没有足够的内存来同时执行这两项操作，那么您别无选择——您的原始代码按顺序运行是唯一的方法`compute`。`write`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T12:29:15.440

您可以使用诸如`Queue.Queue`（模块在这里：[队列](http://docs.python.org/2/library/queue.html)）和`threading.Thread`（或者`threading.start_new_thread`如果您只想要一个函数），模块在这里：[线程](http://docs.python.org/2/library/threading.html)- 因为文件写入不是 CPU 密集型并使用更多 IO。（并且 GIL 不会影响它）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-25T12:40:28.207

简单的方法是只使用线程和队列。另一方面，如果计算部分不依赖于全局状态，并且您的机器具有多个 CPU 核心，则更有效的方法是使用[进程池](http://docs.python.org/2/library/multiprocessing.html#module-multiprocessing.pool)

```
from multiprocessing import Pool

def compute_data(x):
    return some_calculation_with(x)

if __name__ == '__main__':
    pool = Pool(processes=4) # let's say you have quad-core, so start 4 workers

    with open("output_file","w") as outfile:
        for calculation_result in pool.imap(compute_data, range(200)):
        # pool.imap returns results as they come from process pool    
            outfile.write(calculation_result) 
```

# nlp - 聚类词

> ID：16214741
> 
> 赞同：3
> 
> 时间：2013-04-25T12:25:50.847
> 
> 标签：nlp, cluster-analysis

我有一个单词列表。我正在寻找一种将这些词在语义上聚集在一起的方法。谁能告诉我有关实现此目的的库或工具？我一直在网上搜索这个，但没有什么适合我的要求。大多数单词都是技术性的，因此在任何字典中都找不到。我想对单词列表进行本体聚类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:34:08.917

你有一个收藏，所以你会有一个可以使用的上下文吗？

如果您有一个给定的集合，您可以使用您可以计算每对术语一起出现的文档数量，并基于此计算它们之间的一些语义相似性，例如 [Jaccard] ( [http://en.wikipedia.org/wiki/ Jaccard_index](http://en.wikipedia.org/wiki/Jaccard_index) ) 或 [Dice] ( [http://en.wikipedia.org/wiki/Dice%27s_coefficient](http://en.wikipedia.org/wiki/Dice%27s_coefficient) )。

# ios - Reachability.m - 找不到文件 - 奇怪的行为

> ID：16214743
> 
> 赞同：-2
> 
> 时间：2013-04-25T12:26:00.483
> 
> 标签：ios, import, reachability

我有两个相关的文件： CollectionViewController.m 和 ImageDetailViewController.m

对于 CollectionViewController.m，“#import "Reachability.m" + 功能工作得很好。我也添加了所有框架。

但是，当尝试在我的 ImageDetailViewController.m 中导入 Reachability.m 文件时，我收到“Reachability.m - 未找到文件”错误。我不明白为什么会这样。这两个文件都在同一个组中，文件夹中的所有内容。

![集合视图控制器.m](https://i.imgur.com/f4o4zZ7.png) ![ImageDetailViewController.m](https://i.imgur.com/APvdTr7.png)

有没有人遇到过这个？我很感激一个解决方案，这让我发疯了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:29:39.893

您通常不 import `Reachability.m`，只有需要导入的文件具有`.h`称为头文件的扩展名。导入`.m`文件的问题是编译器可能无法找到 .m 文件并会抱怨。

我建议您使用前向声明，它可以更快地构建代码并对其进行索引，您可以在代码中添加这样的类

**集合视图控制器.h**

`@class Reachability;` 在你的`CollectionViewController.h`头文件中

```
 @property(strong,nonatomic)Reachability *reachability; // here you are declaring a property 
```

**集合视图控制器.m**

```
`#import "Reachability.h"` //only .h file is required to be imported 
```

现在您可以`reachability`通过`self.reachability`

# iphone - 如何在 Facebook 上发布地图溃败

> ID：16214746
> 
> 赞同：5
> 
> 时间：2013-04-25T12:26:04.240
> 
> 标签：iphone, ios, facebook, map, facebook-opengraph

我有一个健身应用程序。当用户开始运行然后路由开始绘制并且当用户停止然后路由现在完成因为我有地图路线所以我想在facebook上发布这个地图路线我已经检查了facebook的文档并且我发现了类似的东西

```
NSMutableDictionary<FBGraphObject> *action = [FBGraphObject graphObject];action[@"course"] = @"http://samples.ogp.me/136756249803614";

[FBRequestConnection startForPostWithGraphPath:@"me/fitness.walks"
                                   graphObject:action
                             completionHandler:^(FBRequestConnection *connection,
                                                 id result,
                                                 NSError *error) {
                                 // handle the result
                             }]; 
```

他们正在为“课程”提供参考

课程链接是这个[https://developers.facebook.com/docs/reference/opengraph/object-type/fitness.course](https://developers.facebook.com/docs/reference/opengraph/object-type/fitness.course) 但我不知道如何使用它

Facebook 文档是这个 [https://developers.facebook.com/docs/reference/opengraph/action-type/fitness.walks](https://developers.facebook.com/docs/reference/opengraph/action-type/fitness.walks)

如果有人告诉我如何使用这一切并在facebook上发布地图路线将非常有帮助，谢谢

# mysql - MySQL in 子句到表 Heirachy 上的枚举路径

> ID：16214756
> 
> 赞同：0
> 
> 时间：2013-04-25T12:26:15.170
> 
> 标签：mysql, nested, set, hierarchy

我对将 MySQL 与分层数据一起使用进行了一些调查，（目前我的表使用邻接列表模型）所以我通过一个循环获取面包屑，将父 ID 发送回并在 PHP 中重新诅咒相同的函数，但这会触发一个查询每一次。所以现在我想通过创建一个 _construct 方法来触发一次查询并返回一个我可以引用的对象来改进。

为此，我对嵌套集、路径枚举（物化路径）和闭包表进行了一些研究。

我选择了物化路径。

我的 SQL

```
SELECT t1.*
FROM menu t1
WHERE t1.menu_id IN (
    SELECT TRIM(REPLACE(t2.Lineage,'/',',')) as CAT_IDD
    FROM menu t2
    WHERE t2.page_id = 52
) 
```

我的表是这样的，我会粘贴在转储中，以便您测试它...

结构体

```
CREATE TABLE IF NOT EXISTS `menu` (
  `menu_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `menu_text` varchar(255) NOT NULL DEFAULT 'NEW !!!',
  `menu_alt_text` varchar(255) DEFAULT NULL,
  `menu_alt_location` varchar(255) DEFAULT NULL,
  `page_id` int(11) unsigned NOT NULL DEFAULT '0',
  `parent_menu_id` int(11) unsigned NOT NULL DEFAULT '0',
  `lineage` varchar(255) DEFAULT NULL,
  `menu_display_order` int(11) unsigned NOT NULL DEFAULT '1',
  `menu_display` tinyint(1) unsigned NOT NULL DEFAULT '1',
  `site_short_code` varchar(20) NOT NULL DEFAULT 'DEFAULT',
  `menu_can_delete` tinyint(1) NOT NULL DEFAULT '1',
  `user_id` int(11) unsigned NOT NULL DEFAULT '0',
  `opens_in_new_window` tinyint(1) unsigned NOT NULL DEFAULT '0',
   PRIMARY KEY (`menu_id`),
   KEY `site_short_codee` (`site_short_code`)
   ) ENGINE=InnoDB  DEFAULT CHARSET=latin1 COMMENT='This displays the menu/navigation of the site' AUTO_INCREMENT=75 ; 
```

插入数据

```
INSERT INTO `menu` (`menu_id`, `menu_text`, `menu_alt_text`, `menu_alt_location`, `page_id`, `parent_menu_id`, `lineage`, `menu_display_order`, `menu_display`, `site_short_code`, `menu_can_delete`, `user_id`, `opens_in_new_window`)    
VALUES (1, 'Home', 'opens in same window', 'none', 1, 0, '0', 1, 1, 'site1', 0, 0, 0),
(41, 'About Us', 'About Us, opens in same window', 'none', 42, 0, '0', 4, 1, 'site1', 1, 43, 0),
(42, 'Menu 3', 'Menu 3, opens in same window', 'none', 43, 0, '0', 30, 1, 'site1', 1, 43, 0),
(43, 'Menu 4', 'Menu 4 templates, opens in same window', 'none', 44, 42, '1/42', 9, 1, 'site1', 1, 43, 0),
(44, 'Menu 5', 'Menu 5, opens in same window', 'none', 45, 42, '1/42', 3, 1, 'site1', 1, 43, 0),
(45, 'Menn 6', 'Menu 6, opens in same window', 'none', 46, 42, '1/42', 6, 1, 'site1', 1, 43, 0),
(46, 'Menu 7', 'Menu 7, opens in same window', 'none', 47, 0, '0', 43, 1, 'site1', 1, 43, 0),
(47, 'Menu 8', 'Menu 8, opens in same window', 'none', 48, 46, '1/46', 3, 1, 'site1', 1, 43, 0),
(48, 'Menu 9', 'Menu 9, opens in same window', 'none', 50, 46, '1/46', 6, 1, 'site1', 1, 43, 0),
(49, 'Menu 10', 'Menu 10, opens in same window', 'none', 53, 48, '1/46/48', 9, 1, 'site1', 1, 43, 0),
(50, 'Menu 11', 'Menu 11, opens in same window', 'none', 49, 46, '1/46', 12, 1, 'site1', 1, 43, 0),
(51, 'Menu 12', 'Menu 12, opens in same window', 'none', 51, 48, '1/46/48', 15, 1, 'site1', 1, 43, 0),
(52, 'Menu 13', 'Menu 13, opens in same window', 'none', 52, 48, '1/46/48', 18, 1, 'site1', 1, 43, 0),
(53, 'Menu 14, 'Menu 14, opens in same window', 'none', 70, 0, '0', 7, 1, 'site1', 1, 43, 0),
(54, 'Release Dates', 'Release Dates, opens in same window', 'none', 56, 53, '1/53', 12, 1, 'site1', 1, 43, 0),
(55, 'Clients', 'Clients, opens in same window', 'none', 57, 0, '0', 65, 1, 'site1', 1, 43, 0),
(56, 'Menu 145 Clients', 'Menu 145 clients, opens in same window', 'none', 74, 55, '1/55', 3, 1, 'site1', 1, 43, 0),
(57, 'ffff', 'ffff, opens in same window', 'none', 59, 55, '1/55', 6, 1, 'site1', 1, 43, 0); 
```

这将返回 linage 中的 menu_ids 列表

```
 SELECT TRIM(REPLACE(t2.Lineage,'/',',')) as CAT_IDD
    FROM menu t2
    WHERE t2.page_id = 52 
```

但是，当用作上面的子查询时，它只返回 1 行。我需要它来返回 3。我也尝试过使用嵌套 JOIN ......

嗯，任何想法将不胜感激。

谢谢

和我

------ 编辑回答自己的问题

```
SELECT t1.* 
FROM menu t1, menu t2
WHERE 
t2.page_id = 52
AND
FIND_IN_SET (
      t1.menu_id, t2.Lineage
) 
```

这似乎对我有用......如果这对其他人有帮助，我希望如此。我将分隔符更改为逗号

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T05:17:26.497

好的，我认为这项工作可以找到历史......

```
SELECT t1.* 
FROM menu t1, menu t2
WHERE 
t2.page_id = 52
AND
FIND_IN_SET (
     t1.menu_id, t2.Lineage
) 
```

如果这对其他人有帮助，我希望如此。我在血统字段的数据中将分隔符更改为逗号...

谢谢

# javascript - JQuery，如何在html中选择文本后附加div？

> ID：16214758
> 
> 赞同：0
> 
> 时间：2013-04-25T12:26:17.563
> 
> 标签：javascript, jquery, rangy

嗨，可以在选定文本后添加 div 吗？使用 jQuery 或 java-script 和 rangy js

我正在尝试使用以下代码但无法正常工作..

```
function pin_surroundRange() {
    var range = getFirstRange(); //get selected text via rangy js 
    if(range != null) {
        $( '#content_area ('+range+')' ).replaceWith( ''+range+'<div><input type="text" /></div>' );}
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T14:04:01.250

我会使用的步骤是：

*   获取所选范围
*   将范围折叠到最后
*   调用范围的`insertNode()`方法

代码：

```
var div = document.createElement("div");
div.appendChild( document.createElement("input") );

var sel = rangy.getSelection();
if (sel.rangeCount > 0) {
    var range = sel.getRangeAt(0);
    range.collapse(false);
    range.insertNode(div);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T13:31:28.360

我创建了一个适用于文本节点的简单函数。我相信您可以通过一些额外的努力为元素节点获得相同的结果。

[http://jsfiddle.net/tarabyte/HTYhm/4/](http://jsfiddle.net/tarabyte/HTYhm/4/)

```
var addDiv = function() {
    rangy.init(); //This might be somewhere else
    var sel = rangy.getSelection();
    if(sel && sel.anchorNode && sel.anchorNode.nodeType === 3 ) { //For text nodes only
        var node = $(sel.anchorNode),
            text = node.text(),
            length = Math.max(sel.focusOffset, sel.anchorOffset); 

        node.replaceWith(text.substring(0, length) 
                         + "<div> <input name='edit'/></div>" 
                         + text.substring(length ));
    }
}
$("#mark").on("click", addDiv); 
```

# c++ - C++字符串函数返回语句

> ID：16214763
> 
> 赞同：1
> 
> 时间：2013-04-25T12:26:23.160
> 
> 标签：c++, string

我正在尝试在 return 语句中将 int 添加到字符串，如下所示：

```
string Birthday::asString() {
    return this -> day + "/" + this -> month + "/" + this -> year;
} 
```

并收到以下错误：

> 错误：表达式必须具有整数或无范围枚举类型

我对 C++ 有点陌生。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-25T12:28:36.967

做你想做的最简单的方法是使用 ostringstream（在 header 中找到`<sstream>`）：

```
string Birthday::asString() {
    std::ostringstream out;
    out << this -> day << "/" << this -> month << "/" << this -> year;
    return out.str();
} 
```

您收到显示的错误，因为`C++`不知道如何将整数添加到字符串中。

编辑：正如 M M. 自 C++11 以来的回答中所建议的那样，还有另一种选择，即使用函数 std::to_string。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-25T12:29:55.060

您可以使用[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)：

```
string Birthday::asString() {
     return std::to_string(this->day) + "/" +
            std::to_string(this->month) + "/" +
            std::to_string(this->year);
} 
```

*从 C++11 开始可用*

# java - Android - 通过 Html.fromHtml 在 TextView 中的图像？

> ID：16214767
> 
> 赞同：0
> 
> 时间：2013-04-25T12:26:36.490
> 
> 标签：java, android, html, image, textview

我想在 Android 中将图像显示到 TextView 中，并认为这可以通过`Html.fromHtml()`. 我发现图像是本地资源的不同教程。当我有图像的 URL 时也可以吗？如果是，有人可以举个例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:25:17.727

我有解决方案。将以下代码添加到您的文本视图中。

```
private static final Factory spannableFactory = Spannable.Factory
        .getInstance();

private static final Map<Pattern, Integer> emoticons = new HashMap<Pattern, Integer>();

static {
    addPattern(emoticons, ":)", R.drawable.happy);
    addPattern(emoticons, ":(", R.drawable.sad);
    addPattern(emoticons, ":D", R.drawable.very_happy);
    // ...as many pattern you want. But make sure you have images in drawable directory
}

private static void addPattern(Map<Pattern, Integer> map, String smile,
        int resource) {
    map.put(Pattern.compile(Pattern.quote(smile)), resource);
}

public static boolean addSmiles(Context context, Spannable spannable) {
    boolean hasChanges = false;
    for (Entry<Pattern, Integer> entry : emoticons.entrySet()) {
        Matcher matcher = entry.getKey().matcher(spannable);
        while (matcher.find()) {
            boolean set = true;
            for (ImageSpan span : spannable.getSpans(matcher.start(),
                    matcher.end(), ImageSpan.class))
                if (spannable.getSpanStart(span) >= matcher.start()
                        && spannable.getSpanEnd(span) <= matcher.end())
                    spannable.removeSpan(span);
                else {
                    set = false;
                    break;
                }
            if (set) {
                hasChanges = true;
                spannable.setSpan(new ImageSpan(context, entry.getValue()),
                        matcher.start(), matcher.end(),
                        Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
            }
        }
    }
    return hasChanges;
}

public static Spannable getSmiledText(Context context, CharSequence text) {
    Spannable spannable = spannableFactory.newSpannable(text);
    addSmiles(context, spannable);
    return spannable;
} 
```

完成复制粘贴后，编写以下代码以在文本视图中设置微笑。

```
textView.setText(getSmiledText(ActivityName.this,"Hi :) How are you...??? :D I am very :(")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:35:20.030

您可以使用 WebView 代替 TextView 来显示图像。如果您需要显示您的笑脸，您需要提取该关键字并替换为特定图像并绘制它。为此，您需要创建自定义视图。

# c++ - 在 C++ 非 GUI 应用程序中检测 USB 插入/移除

> ID：16214768
> 
> 赞同：14
> 
> 时间：2013-04-25T12:26:36.600
> 
> 标签：c++, windows, usb

我想通过在后台运行且没有 GUI 的 C++ 应用程序检测特定（自定义）USB 设备的插入/移除。

我在[MSDN](http://msdn.microsoft.com/en-us/library/aa363432.aspx)`RegisterDeviceNotification`上看到了很多问题，他们的解决方案也是示例代码

但是这些所有应用程序都有一些窗口/表单/GUI。我的应用程序没有。如何在我的应用程序中使用它？

我的最后一个选择是创建一个不可见的窗口......但是还有其他出路吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T12:51:47.850

创建一个[仅消息窗口](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632599%28v=vs.85%29.aspx#message_only)。尽管有这个名字，它实际上只是一个消息队列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-31T23:26:20.420

```
#define ANSI
#define WIN32_LEAN_AND_MEAN
#define _WIN32_WINNT   0x0501

#include <windows.h>
#include <winuser.h>
#include <Dbt.h>

#include <string>
#include <iostream>
#include <stdexcept>

#define HID_CLASSGUID {0x4d1e55b2, 0xf16f, 0x11cf,{ 0x88, 0xcb, 0x00, 0x11, 0x11, 0x00, 0x00, 0x30}}
#define CLS_NAME "DUMMY_CLASS"
#define HWND_MESSAGE     ((HWND)-3)

LRESULT message_handler(HWND__* hwnd, UINT uint, WPARAM wparam, LPARAM lparam)
{
    switch (uint)
    {
    case WM_NCCREATE: // before window creation
        return true;
        break;

    case WM_CREATE: // the actual creation of the window
    {
        // you can get your creation params here..like GUID..
        LPCREATESTRUCT params = (LPCREATESTRUCT) lparam;
        GUID InterfaceClassGuid = *((GUID*)params->lpCreateParams);
        DEV_BROADCAST_DEVICEINTERFACE NotificationFilter;
        ZeroMemory(&NotificationFilter, sizeof(NotificationFilter));
        NotificationFilter.dbcc_size = sizeof(DEV_BROADCAST_DEVICEINTERFACE);
        NotificationFilter.dbcc_devicetype = DBT_DEVTYP_DEVICEINTERFACE;
        NotificationFilter.dbcc_classguid = InterfaceClassGuid;
        HDEVNOTIFY dev_notify = RegisterDeviceNotification(hwnd, &NotificationFilter,
                                                           DEVICE_NOTIFY_WINDOW_HANDLE);
        if(dev_notify == NULL)
        {
            throw std::runtime_error("Could not register for devicenotifications!");
        }
        break;
    }

    case WM_DEVICECHANGE:
    {
        PDEV_BROADCAST_HDR lpdb = (PDEV_BROADCAST_HDR) lparam;
        PDEV_BROADCAST_DEVICEINTERFACE lpdbv = (PDEV_BROADCAST_DEVICEINTERFACE) lpdb;
        std::string path;
        if (lpdb->dbch_devicetype == DBT_DEVTYP_DEVICEINTERFACE)
        {
            path = std::string(lpdbv->dbcc_name);
            switch (wparam)
            {
            case DBT_DEVICEARRIVAL:
                std::cout << "new device connected: " << path << "\n";
                break;

            case DBT_DEVICEREMOVECOMPLETE:
                std::cout << "device disconnected: " << path << "\n";
                break;
            }
        }
        break;
    }

    }
    return 0L;
}

int main(int argc, char* argv[])
{
    HWND hWnd = NULL;
    WNDCLASSEX wx;
    ZeroMemory(&wx, sizeof(wx));

    wx.cbSize = sizeof(WNDCLASSEX);
    wx.lpfnWndProc = reinterpret_cast<WNDPROC>(message_handler);
    wx.hInstance = reinterpret_cast<HINSTANCE>(GetModuleHandle(0));
    wx.style = CS_HREDRAW | CS_VREDRAW;
    wx.hInstance = GetModuleHandle(0);
    wx.hbrBackground = (HBRUSH)(COLOR_WINDOW);
    wx.lpszClassName = CLS_NAME;

    GUID guid = HID_CLASSGUID;

    if (RegisterClassEx(&wx))
    {
        hWnd = CreateWindow(CLS_NAME, "DevNotifWnd", WS_ICONIC,
                            0, 0, CW_USEDEFAULT, 0, HWND_MESSAGE,
                            NULL, GetModuleHandle(0), (void*)&guid);
    }

    if(hWnd == NULL)
    {
        throw std::runtime_error("Could not create message window!");
    }

    std::cout << "waiting for new devices..\n";

    MSG msg;
    while (GetMessage(&msg, NULL, 0, 0))
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }
    return 0;
} 
```

这个简单的程序创建了一个不可见的窗口，它的消息处理程序还接收“RegisterDeviceNotification”的通知。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-22T16:07:35.740

# 外部 USB 存储设备检测器

* * *

这个简单的 C++ 代码可以检测任何**笔式驱动器**、**存储卡**和**外部硬盘驱动器**-

```
#include <stdio.h>
#include <time.h>
#include <windows.h>
#include <string>

using namespace std;

string allDrives;

char getRemovableDisk();

int main(void) {
    char driveLetter = getRemovableDisk();
    while (1) {
        driveLetter = getRemovableDisk();
        if (driveLetter != '0') {
            printf("%c \n", driveLetter);
        }

        Sleep(1000);
    }

    return 0;
}

char getRemovableDisk() {
    char drive = '0';

    char szLogicalDrives[MAX_PATH];
    DWORD dwResult = GetLogicalDriveStrings(MAX_PATH, szLogicalDrives);

    string currentDrives = "";

    //cout << dwResult << endl;
    for (int i = 0; i < dwResult; i++) {
        if (szLogicalDrives[i] > 64 && szLogicalDrives[i] < 90) {
            currentDrives.append(1, szLogicalDrives[i]);
            if (allDrives.find(szLogicalDrives[i]) > 100) {
                drive = szLogicalDrives[i];
            }

        }
    }

    allDrives = currentDrives;

    return drive;
} 
```

[**PS**：此代码片段可以检测插入一个新的用于 Windows 操作系统的 USB 存储设备。如果在 1 秒内同时插入多个设备，则只会检测到一个。但是，当然，您也可以通过一些代码更改来实现多个检测。:)]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-25T11:00:37.080

此 c++ 代码检测 USB 存储设备的 INSERTION 和 REMOVAL。

这也可以同时检测**多个 USB 设备的插入和移除。**

**c++ 代码：**在 VISUAL STUDIO 2015 中测试

您还可以检查其他类型的设备以进行移除和插入。`if else`只需在函数**getUSBStorageDeviceList()**的代码中填充传递的 char 数组到其他类型的设备

 **```
 #include "stdafx.h"
    #include <stdio.h>
    #include <time.h>
    #include <windows.h>
    #include <string>
    #include<iostream>

    using namespace std;

    #define MAX_LETTER 26
    char PREV_DRIVE_LIST[MAX_LETTER];
    char NEW_DRIVE_LIST[MAX_LETTER];

    /* To GET DRIVE LIST in char ARRAY */
    void getUSBStorageDeviceList(char drive[]) {

        int count = 0;

        char szLogicalDrives[MAX_PATH];
        size_t size = strlen(szLogicalDrives) + 1;
        wchar_t* text = new wchar_t[size];

        size_t outSize;
        mbstowcs_s(&outSize, text, size, szLogicalDrives, size - 1);

        DWORD dwResult = GetLogicalDriveStrings(MAX_PATH, text); // text = szLogicalDrives
        WCHAR* szSingleDrive = text;

        while (*szSingleDrive)
        {
            UINT nDriveType = GetDriveType(szSingleDrive);

        //  printf("\nFUNC: getRemovableDisk, Drive Name%d= %s", ++count, szSingleDrive);

            if (nDriveType == DRIVE_UNKNOWN) {
            //  cout << "\nDrive type : Unknown: The drive type cannot be determined." << endl;
            }
            else if (nDriveType == DRIVE_NO_ROOT_DIR) {
            //  cout << "\nDrive type : Invalid Root Directory Media: The root path is invalid." << endl;
            }
            else if (nDriveType == DRIVE_REMOVABLE) {
            //  cout << "\nDrive type :  Removable Media:" << endl;
                char letter = szSingleDrive[0];
                drive[letter - 65] = letter;
            }
            else if (nDriveType == DRIVE_FIXED) {
                //cout << "\nDrive type : Fixed Media: " << endl;
            }
            else if (nDriveType == DRIVE_REMOTE) {
                //cout << "\nDrive type : Remote Media: The drive is a remote (network) drive.." << endl;
            }
            else if (nDriveType == DRIVE_CDROM) {
                //cout << "\nDrive type : CD ROM:   The drive is a CD-ROM drive." << endl;
            }
            else if (nDriveType == DRIVE_RAMDISK) {
                //cout << "\nDrive type : RAM Disk: The drive is a RAM disk." << endl;
            }

            szSingleDrive += wcslen(szSingleDrive) + 1; // next drive 
        }
    }

    int main(void) {

        int count = 0;
        for (int i = 0; i < MAX_LETTER; i++) {
            PREV_DRIVE_LIST[i] = '0';
            NEW_DRIVE_LIST[i] = '0';
        }
        // initial drive list which is already attached 
        getUSBStorageDeviceList(PREV_DRIVE_LIST);

        while (1) {

            getUSBStorageDeviceList(NEW_DRIVE_LIST);
            count = 1;

            /* Check for insertion and removabal*/

            for (int i = 0; i < MAX_LETTER; i++) {
                // check for new drive
                if ((NEW_DRIVE_LIST[i] >= 65 && NEW_DRIVE_LIST[i] <= 89) && (PREV_DRIVE_LIST[i] == '0')) {

                    printf("\nNew Device Inserted%d : %c", count++, NEW_DRIVE_LIST[i]);
                    PREV_DRIVE_LIST[i] = NEW_DRIVE_LIST[i];
                }
            }
                // fill ALl zero 
                for (int i = 0; i < MAX_LETTER; i++) {
                    NEW_DRIVE_LIST[i] = '0';
                }
                // update NEW drive list
                getUSBStorageDeviceList(NEW_DRIVE_LIST);

                for (int i = 0; i < MAX_LETTER; i++) {
                    // check for removed drive
                    if ((PREV_DRIVE_LIST[i] >= 65 && PREV_DRIVE_LIST[i] <= 89) && (NEW_DRIVE_LIST[i] == '0')) {
                        printf("\nDevice Removed%d : %c", count++, PREV_DRIVE_LIST[i]);
                        PREV_DRIVE_LIST[i] = NEW_DRIVE_LIST[i];
                    }
            }
                Sleep(500);
        }

        return 0;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-28T18:13:03.437

首先创建一个服务，然后在 中`RegisterDeviceNotification`，给出该服务的句柄而不是窗口句柄。

也相应地调整第三个参数`RegisterDeviceNotification`。**

# java - 使用 JavaParser 在类中计算方法声明 + 方法调用

> ID：16214783
> 
> 赞同：2
> 
> 时间：2013-04-25T12:27:34.770
> 
> 标签：java, parsing, methods, javaparser

我正在尝试编写 rfc 指标（类的响应），它计算方法声明 + 方法调用。

方法声明工作正常，但我在使用 JavaParser API 计算方法调用时遇到了问题。

这是我的代码：

```
public class MethodPrinter {

    public static void main(String[] args) throws Exception {
        // creates an input stream for the file to be parsed
        FileInputStream in = new FileInputStream("D://test.java");
        CompilationUnit cu;
        try {
            // parse the file
            cu = JavaParser.parse(in);
        } finally {
            in.close();
        }
        // visit and print the methods names
        MethodVisitor MV =new MethodVisitor();

        cu.accept(new VoidVisitorAdapter<Void>(){
            @Override
            public void visit(final MethodCallExpr n, final Void arg){
                System.out.println("method call :"+n);
                super.visit(n, arg);

            }
        }, null);
    }
} 
```

测试.java

```
package test;
import java.util.*;

public class ClassA 
{
  private int test;
  private ClassB classB = new ClassB();
  public void doSomething(int t){

    System.out.println ( toString());
    int i= doSomethingBasedOnClassBBV(classB.toString());
  }
  protected void doSomethingBasedOnClassB(){
    System.out.println (classB.toString());
  }
}

public class ClassB 
{
  private ClassA classA = new ClassA();
  public void doSomethingBasedOneClassA(){
    System.out.println (classA.toString());
  }

  private String toString(){
    return "classB";
  }
  private String toString(){
    return "classB";
  }
  public void doSomethingBasedOneClassA(){
    System.out.println (classA.toString());
  }
  protected void doSomethingBasedOnClassB(){
    System.out.println (classB.toString());
  }
} 
```

该代码的结果：

```
*method call :System.out.println(toString())

method call :toString()

method call :doSomethingBasedOnClassBBV(classB.toString())

method call :classB.toString()

method call :System.out.println(classB.toString())

method call :classB.toString()

method call :System.out.println(classA.toString())

method call :classA.toString()

method call :System.out.println(classA.toString())

method call :classA.toString()

method call :System.out.println(classB.toString())

method call :classB.toString()* 
```

实际上，该代码检查方法调用，但在我的情况下，我不希望它计算像 System.out.println 这样的库方法调用`(toString())`，我希望它只计算`toString()`。

如果您有更好的代码或其他 API 可以使用...欢迎任何帮助，在此先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-13T12:47:52.163

仅使用解析器无法轻松解决问题，因为您需要解析方法调用并确定它是否是对标准库方法部分的调用。

[您可以使用JavaSymbolSolver](https://github.com/javaparser/javasymbolsolver)轻松做到这一点，这是一个为补充 JavaParser 而创建的库。在实践中，您调用：

`JavaParserFacade.solveMethodAsUsage(myMethodCallExpr)`

然后你会得到一个 MethodDeclaration，它还告诉你定义该方法的类型。获得类型后，您可以查看包并检查它是否以`java`或`javax`排除它开头。

# apache - 升级到 Mountain Lion 后 localhost 不起作用

> ID：16214786
> 
> 赞同：1
> 
> 时间：2013-04-25T12:27:37.817
> 
> 标签：apache, upgrade, osx-mountain-lion

我刚刚从 Lion 升级到 Mountain Lion，一切都和我在 Lion 上的一样，除了 localhost。我从终端启动 apache，它开始正常。但是，我无法访问本地主机，它给了我“无法连接到服务器本地主机”的错误。

我检查了我的`httpd.conf`文件，它就像以前工作时一样。升级后的唯一区别是从我重新创建的 apache2 目录中的`username.conf`文件`users`夹中删除。

apache 错误日志文件也不显示任何内容。事实上，那里没有任何日志文件。

有没有人有解决方案？

# c# - 在 VB 中使用 ASP.NET 构建登录

> ID：16214788
> 
> 赞同：-3
> 
> 时间：2013-04-25T12:27:39.600
> 
> 标签：c#, asp.net, vb.net, login

我发现了一个关于使用 asp.net 构建网站登录的 youtube 视频，问题是它在 C# 中，但是当我运行程序时我一直在将它转换为 VB，我收到了这个错误

```
Object reference not set to an instance of an object.

Description: An unhandled exception occurred during the execution of the current web       request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error: 

The source code that generated this unhandled exception can only be shown when compiled in debug mode. To enable this, please follow one of the below steps, then request the URL:

1\. Add a "Debug=true" directive at the top of the file that generated the error. Example: 
```

```
or:

2) Add the following section to the configuration file of your application:

<configuration>
<system.web>
   <compilation debug="true"/>
</system.web>
</configuration> 
```

我知道这意味着 C# 中有一些东西，但我找不到它是什么。这是代码。

```
 Imports System
       Imports System.Collections.Generic
       Imports System.Linq
       Imports System.Web
       Imports System.Web.UI
       Imports System.Web.UI.WebControls
       Imports System.Data.SqlClient
       Imports System.Configuration

Partial Class Registration
Inherits System.Web.UI.Page

Protected Sub Submit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Submit.Click
    Dim con As SqlConnection = New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
    con.Open()
    Dim insCmd As String = "Insert into Registration (Username, Password, EmailAddress, FullName, Country) values (@UserName, @Password, @EmailAddress, @FullName, @Country)"
    Dim InsertUser As SqlCommand = New SqlCommand(insCmd, con)
    InsertUser.Parameters.AddWithValue("@UserName", TextBoxUN.Text)
    InsertUser.Parameters.AddWithValue("@Password", TextBoxPass.Text)
    InsertUser.Parameters.AddWithValue("@EmailAddress", TextBoxEA.Text)
    InsertUser.Parameters.AddWithValue("@FullName", TextBoxFN.Text)
    InsertUser.Parameters.AddWithValue("@Country", DropDownListCountry.SelectedItem.ToString())

    Try
        InsertUser.ExecuteNonQuery()
        con.Close()
        Response.Redirect("Login.aspx")
    Catch ex As Exception
        Response.Write("You have just launched a nuclear warhead and started WWIII seek shelter ASAP")

    End Try
End Sub

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    If (IsPostBack) Then

        Dim con As SqlConnection = New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)
        con.Open()

        Dim cmdStr As String = "SELECT COUNT(*) FROM Registration WHERE UserName='" + TextBoxUN.Text + "'"

        Dim userExist As SqlCommand = New SqlCommand(cmdStr, con)

        Dim temp As Integer = Convert.ToInt32(userExist.ExecuteScalar().ToString())
        con.Close()

        If temp = 1 Then
            Response.Write("Username already exist. Please choose another username")
        End If
    End If

End Sub
End Class 
```

如果你看到任何东西，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:34:47.650

老实说，我唯一要做的就是逐步检查并确保没有任何“没有价值”的东西，而且我不熟悉 if 语句设置，我会更喜欢 =true or not(condition) 而不是 isPostback，不记得答案是否默认为真，但我会看看那些 2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T15:23:26.817

Dim con As SqlConnection = New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").ConnectionString)

你能把上面的代码替换为

Dim con As SqlConnection = New SqlConnection(ConfigurationManager.ConnectionStrings("RegconnectionString").toString())

# javascript - 在父函数方法中获取子函数名

> ID：16214795
> 
> 赞同：2
> 
> 时间：2013-04-25T12:28:10.293
> 
> 标签：javascript

函数 B 扩展 A，当我调用 B 子函数`parentMethod()`对象的对象时，如何在父函数 A 中获取 B 函数名称。

```
function A() {

    this.parentMethod = function() {
         //alert('display B function name');
    }
}

function B() {

}

B.prototype = new A();

var b = new B();  
b.parentMethod(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T15:13:19.780

最简单的方法是：

```
function A() {

    this.parentMethod = function() {
         alert(this.constructor.name);
    }
}

function B() {

}

B.prototype = new A();  
B.prototype.constructor = B; //Add this line.

var b = new B();  
b.parentMethod(); 
```

现在，当您调用 parentMethod 时，它会将 B 显示为构造函数名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:32:25.880

如果您修复`constructor`属性以指向正确的功能（即`B`）

```
B.prototype.constructor = B; 
```

然后您可以通过以下方式访问构造函数的名称

```
this.parentMethod = function() {
     alert(this.constructor.name);
} 
```

请注意，这[`Function.name`是一个**非标准**属性](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/name)，可能不适用于所有浏览器。另一种方法是通过覆盖`parentMethod`或添加属性到具有函数名称的实例来硬编码函数名称。您也可以直接使用函数引用 ( `this.constructor`)，具体取决于您要实现的目标。

* * *

设置继承的更好方法是使用[`Object.create` *^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)并在子构造函数中调用父构造函数：

```
function A() {}

A.prototype.parentMethod = function() {};

function B() {
    A.call(this); // call parent constructor
}

B.prototype = Object.create(A.prototype); // establish inheritance
B.prototype.constructor = B; 
```

# jquery - 滚动时需要修复 div 从顶部保持 20px

> ID：16214796
> 
> 赞同：5
> 
> 时间：2013-04-25T12:28:17.590
> 
> 标签：jquery, html, css

我不确定这是否可以用纯 CSS 来完成，或者我是否需要使用一些 jQuery 来做到这一点。

我有一个 div (product_image)，在其当前状态下，它位于距顶部约 400 像素并相对定位，因此它清除顶部菜单和标题，我需要做的是当用户向下滚动并从顶部到达约 20 像素时的 div，我需要 div 变得固定。

这是我尝试过的，我有相对定位的主 div，然后我有另一个 div 用固定定位将所有内容包装在里面。问题是 div 保持在距离顶部 400px 的位置。

这是代码：

```
<div class="product_image">
    <div class="product_image_fixed">
    <a href="products/1.jpg" class="zoom" title="A bed!" rel="gal1">  
        <img src="products/1.jpg" width="450" alt="" title="A bed!">  
    </a>

    <ul id="thumblist" class="clearfix" >
        <li><a class="zoomThumbActive" href='javascript:void(0);' rel="{gallery: 'gal1', smallimage: 'products/1.jpg',largeimage: 'products/1.jpg'}"><img src='products/1.jpg' width="150" height="100"></a></li>
        <li><a href='javascript:void(0);' rel="{gallery: 'gal1', smallimage: 'products/1a.jpg',largeimage: 'products/1a.jpg'}"><img src='products/1a.jpg' width="150" height="100"></a></li>    </ul>
    </div>
    </div> 
```

和 CSS

```
.product_image {
    position: relative;
    float: left;
    width: 450px;
    margin-left: 10px;
    margin-top: 10px;
}

.product_image_fixed {
    position: fixed;
    float: left;
} 
```

我希望我的问题已经足够清楚了，我似乎无法找到解决这个问题的方法，所以我提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-25T12:53:02.920

习惯了jquery

**jQuery**

```
$(document).ready(function() {
    var s = $("#sticker");
    var pos = s.position();                    
    $(window).scroll(function() {
        var windowpos = $(window).scrollTop();

        if (windowpos >= pos.top) {
            s.addClass("stick");
        } else {
            s.removeClass("stick"); 
        }
    });
}); 
```

**CSS**

```
div#wrapper {
    margin:0 auto;
    width:500px;
    background:#FFF;
}
div#mainContent {
    width:160px;
    padding:20px;
    float:left;
}
div#sideBar {
    width:130px;
    padding:20px;
    margin-left:30px;
    float:left;
}
.clear { 
    clear:both; 
}
div#sticker {
    padding:20px;
    margin:20px 0;
    background:#AAA;
    width:190px;
}
.stick {
    position:fixed;
    top:0px;
} 
```

**HTML**

```
<div id="wrapper">
  <div id="mainContent">
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
      some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
       some content here <br />
  </div>
  <div id="sideBar">Some content here 
    <!--Some content in your right column/sidebar-->
    <div id="sticker">...This is scroll here </div>
  </div>
  <div class="clear"></div>
</div> 
```

**[演示](http://jsfiddle.net/rohitazad/braDk/)**

**[更多关于](http://www.pixelbind.com/make-a-div-stick-when-you-scroll/)**

# ruby-on-rails - Rails 是否提供默认会话超时时间？如果是，它在哪里指定？

> ID：16214800
> 
> 赞同：19
> 
> 时间：2013-04-25T12:28:32.137
> 
> 标签：ruby-on-rails, session

我已经知道如何在 Rails 应用程序中设置到期时间，这在网络上已经有很好的记录。但是我想知道的是rails中会话到期的默认持续时间是多少，如果有，在哪里可以找到它？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-04-28T22:25:07.377

Rails 没有默认的过期时间。[session_store 的方法定义](https://github.com/rails/rails/blob/318a20c140de57a7d5f820753c82258a3696c465/railties/lib/rails/application/configuration.rb#L130)似乎只有一个默认值：

在第 32 行`@session_store = :cookie_store`

默认情况下，其他配置不存在。因此，`:expire_after`没有设置并且 Rails 的会话没有过期时间**，除非**您为其设置值。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-25T12:39:45.033

您可以在初始化文件中配置应用程序的会话信息

```
config/initializers/session_store.rb 
```

要设置 30 分钟，请尝试以下代码：

```
 YourApp::Application.config.session_store :cookie_store, 
    :key => '_my_session', 
    :expire_after => 30.minutes 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-19T17:57:51.080

根据定义，会话将在浏览器关闭后过期，它们没有超时。如果您打开 Chrome 开发工具并查看到期日期，它会在那里显示“会话”而不是日期/时间。

# python - 向 App Engine 数据存储区中的 User 类添加额外的属性？

> ID：16214803
> 
> 赞同：0
> 
> 时间：2013-04-25T12:28:37.763
> 
> 标签：python, google-app-engine, google-cloud-datastore, flask

我正在使用 Flask 和 App Engine 开发一个应用程序，除了昵称、电子邮件和 user_id 之外，它还需要将额外的信息存储在用户对象中。是否可以在数据存储中扩展用户类？

如果没有，是否有任何解决方法？我计划拥有自己的用户模型。因此，一旦用户登录应用程序（使用谷歌身份验证），我将使用 users.get_current_user() 函数收集用户信息，并添加一些我需要的其他额外字段。所有这些信息都将存储在我自己的用户模型中。这是处理这种情况的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:50:09.767

正如我在您的另一个问题中解释的那样，您需要一个单独的课程。`User`不是模型，也不存储在数据存储中。它只是登录时从 Google 帐户系统获取的 user_id 和 email 的组合。如果要存储有关用户的某些内容，则需要创建自己的模型类，并使用 store user_id 和/或 email 作为字段您将其与登录用户进行比较。

# java - 在一个框架中处理多个面板

> ID：16214808
> 
> 赞同：3
> 
> 时间：2013-04-25T12:28:50.687
> 
> 标签：java, swing, layout, frames, multiple-instances

我有一个问题，我希望程序在同一帧中的多个面板之间切换。我遇到的问题是我无法在面板切换时设置布局，并且在切换内容逐像素降低之后。这是我的代码。

```
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import javax.swing.JFrame;

public class Main {

    public static boolean logged_in = false;

    public static int width = 200, height = 400;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    Dimension d = new Dimension(width, height);
                    First frame = new First();
                         frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                    frame.setSize(d);
                    frame.setLocationRelativeTo(null);
                    frame.setVisible(true);
                    frame.setResizable(true);
                    frame.setLayout(new FlowLayout());  
                } catch (Exception e) { 
                    e.printStackTrace();    
                }
            }
        });
    }
} 
```

这是两个保存框架的类。

```
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class First extends JFrame {

    JPanel contentPane;
    private JButton button_1;
    private JTextField text;

    public First(){

        contentPane = new JPanel();
        setContentPane(contentPane);

        button_1 = new JButton("Second frame");
        button_1.setVisible(true);
        text = new JTextField(20);
        text.setVisible(true);

        contentPane.add(button_1);
        contentPane.add(text);

        thehandler handler = new thehandler();

        button_1.addActionListener(handler);
    }

    private class thehandler implements ActionListener {

        public void actionPerformed(ActionEvent event) {

            if (event.getSource() == button_1) {
                contentPane.removeAll();
                contentPane.invalidate();
                Second frame = new Second();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLocationRelativeTo(null);
                frame.setResizable(true);
                frame.setLayout(new FlowLayout());
                frame.contentPane.setVisible(true);
                contentPane.add(frame.contentPane);
                ((JPanel) contentPane).revalidate();
                contentPane.setSize(200, 400);
                contentPane.repaint();
            }
        }
    }
} 
```

第二个

```
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class Second extends JFrame {

    JPanel contentPane;
    private JButton button_1;
    private JTextField text;

    public Second(){

        contentPane = new JPanel();
        setContentPane(contentPane);

        button_1 = new JButton("First frame");
        button_1.setVisible(true);
        text = new JTextField(20);
        text.setVisible(true);

        contentPane.add(button_1);
        contentPane.add(text);

        thehandler handler = new thehandler();

        button_1.addActionListener(handler);
    }

    private class thehandler implements ActionListener {

        public void actionPerformed(ActionEvent event) {

            if (event.getSource() == button_1) {
                contentPane.removeAll();
                contentPane.invalidate();
                First frame = new First();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLocationRelativeTo(null);
                frame.setResizable(true);
                frame.setLayout(new FlowLayout());
                frame.contentPane.setVisible(true);
                contentPane.add(frame.contentPane);
                ((JPanel) contentPane).revalidate();
                contentPane.setSize(200, 400);
                contentPane.repaint();
            }
        }
    }
} 
```

任何帮助表示赞赏。请记住，我对 java GUI 不太擅长。泰。

**编辑**经过大量时间寻找答案后，我得到了答案。它可能并不完美，但我会将其发布以供将来参考或其他人需要此解决方案。这是代码。

容纳面板的主框架：

```
import javax.swing.JFrame;
import javax.swing.JPanel;

public class MainFrame extends JFrame {

    public static JPanel main_panel;
    private static FirstFrame first;

    public MainFrame(){

        setLayout(null);    
        setSize(400, 400);
        setLocationRelativeTo(null);
        setResizable(true);
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        main_panel = new JPanel();
        main_panel.setBounds(0, 0, 400, 400);
        add(main_panel);

        main_panel.invalidate();
        main_panel.removeAll();

        first = new FirstFrame();
        main_panel.add(first);
        main_panel.revalidate();
        main_panel.repaint();
    }

    public static void main(String[] args) {
        MainFrame frame = new MainFrame();
        frame.setVisible(true);
    }
} 
```

第一个面板：

```
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JPanel;

public class FirstFrame extends JPanel {

    private JButton button;

    public FirstFrame() {

        JPanel panel = new JPanel();

        panel.setPreferredSize(new Dimension(400, 400));
        panel.setLayout(null);

        button = new JButton("First");
        button.setBounds(20, 20, 200, 40);
        button.setVisible(true);

        thehandler handler = new thehandler();

        button.addActionListener(handler);

        panel.add(button);

        add(panel);
        revalidate();
        repaint();
    }
    private class thehandler implements ActionListener {

        public void actionPerformed(ActionEvent event) {
            if (event.getSource() == button) {
                MainFrame.main_panel.invalidate();
                MainFrame.main_panel.removeAll();
                SecondFrame frame = new SecondFrame();
                MainFrame.main_panel.add(frame);
                MainFrame.main_panel.revalidate();
                MainFrame.main_panel.repaint();
            }
        }
    }
} 
```

第二：

```
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JPanel;

public class SecondFrame extends JPanel {

    private JButton button;

    public SecondFrame() {
        JPanel panel = new JPanel();

        panel.setPreferredSize(new Dimension(400, 400));
        panel.setLayout(null);

        button = new JButton("Second");
        button.setBounds(20, 20, 200, 40);
        button.setVisible(true);

        thehandler handler = new thehandler();

        button.addActionListener(handler);

        panel.add(button);

        add(panel);
        revalidate();
        repaint();
    }
    private class thehandler implements ActionListener {

        public void actionPerformed(ActionEvent event) {
            if (event.getSource() == button) {
                MainFrame.main_panel.invalidate();
                MainFrame.main_panel.removeAll();
                ThirdFrame frame = new ThirdFrame();
                MainFrame.main_panel.add(frame);
                MainFrame.main_panel.revalidate();
                MainFrame.main_panel.repaint();
            }
        }
    }
} 
```

第三：

```
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JPanel;

public class ThirdFrame extends JPanel {

    private JButton button;

    public ThirdFrame() {
        JPanel panel = new JPanel();

        panel.setPreferredSize(new Dimension(400, 400));
        panel.setLayout(null);

        button = new JButton("Third");
        button.setBounds(20, 20, 200, 40);
        button.setVisible(true);

        thehandler handler = new thehandler();

        button.addActionListener(handler);

        panel.add(button);

        add(panel);
        revalidate();
        repaint();
    }
    private class thehandler implements ActionListener {

        public void actionPerformed(ActionEvent event) {
            if (event.getSource() == button) {
                MainFrame.main_panel.invalidate();
                MainFrame.main_panel.removeAll();
                FirstFrame frame = new FirstFrame();
                MainFrame.main_panel.add(frame);
                MainFrame.main_panel.revalidate();
                MainFrame.main_panel.repaint();
            }
        }
    }
} 
```

如您所见，您可以从面板 1 ->2 ->3 切换回 1，但不能切换到第二个面板。Ty all 对于您的回答，他们很有帮助。欢迎任何进一步的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T07:05:16.260

解决方案是使用卡片布局。这很简单，

1.  创建一个带有卡片布局的面板，其中添加了唯一字符串引用的其他子面板。
2.  调用`show`CardLayout 的方法来选择一个面板放在前面（[文档](http://docs.oracle.com/javase/7/docs/api/java/awt/CardLayout.html#show%28java.awt.Container,%20java.lang.String%29)）

检查以下代码。

```
 final JPanel mainPanel=new JPanel();
    JPanel panelOne=new JPanel();
    JPanel panelTwo=new JPanel();
    final CardLayout card=new CardLayout();
    mainPanel.setLayout(card);
    mainPanel.add(panelOne, "one"); // id one refers panelOne
    mainPanel.add(panelTwo, "two"); // id two refers panelTwo

    panelOne.add(new JLabel("first panel"));
    JButton btn1=new JButton("Show second");
    panelOne.add(btn1);
    btn1.addActionListener(new ActionListener(){public void actionPerformed(ActionEvent ae){
    card.show(mainPanel, "two"); // shows panelTwo
    }});

  panelTwo.add(new JLabel("second panel"));
    JButton btn2=new JButton("Show First");
    panelTwo.add(btn2);
    btn2.addActionListener(new ActionListener(){public void actionPerformed(ActionEvent ae){
    card.show(mainPanel, "one"); // shows panelOne
    }}); 
```

# firefox - Firefox 内置 pdf 查看器不显示所有字符

> ID：16214809
> 
> 赞同：0
> 
> 时间：2013-04-25T12:28:53.623
> 
> 标签：firefox

我用 Firefox 打开我的 pdf 文件，它没有显示所有字符（没有显示外来字符）。当我突出显示文本并复制然后将其粘贴到某处时，它会显示所有字符。

可能是什么原因造成的，我该如何解决？

编辑：经过更多的研究和测试，我认为这是一个 Firefox 错误。我从firefox下载了pdf文件>在chrome上打开它=一切都显示了。我下载了 Firefox 的 PDF 查看器插件并查看了我的 pdf 文件 = 一切都显示了。我删除了插件 = 没有再显示。

结论 - firefox 内置 pdf 查看器错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:34:57.150

尝试检查编码，例如它是 UTF-8 而不是 latin-1

# php - 如何使用 php 中的正则表达式从 jquery zoom 获取 src 值

> ID：16214811
> 
> 赞同：0
> 
> 时间：2013-04-25T12:28:59.700
> 
> 标签：php, regex, preg-match

我试过了

```
$content =file_get_contents("http://www.starplugins.com/cloudzoom");
preg_match('/<img[\s\S][^>]*src="([^"]*)"[^>]*id="zoom1"[^>]*>/',$content,$arr);
print_r($arr); 
```

它返回空数组，但是当仅获取 html 部分并使用[Rubular](http://rubular.com/r/6e318Wb0II)进行测试时， 它会给出正确的输出。请帮助弄清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:33:06.490

尝试这个：

```
/\<img.*?id\=["\']zoom1["\'].*?src\=["\'](.+?)["\'][\s]{0,}.*?\/{0,1}\>/ims 
```

如果它返回 false，他们尝试这个：

```
/\<img.*?src\=["\'](.+?)["\'][\s]{0,}.*?id\=["\']zoom1["\'].*?\/{0,1}\>/ims 
```

.

基本上，正则表达式将高度依赖于 id 和 src 的顺序。

但是，由于我们在这里处理的是 html，因此最好使用 DOM/XPath。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:36:49.477

您应该改用 DOM：

```
$dom = new DOMDocument();
@$dom->loadHTML($content);
$xpath = new DOMXPath($dom);

$src = $xpath->query('//img[@id="zoom1"]')->item(0)->getAttribute('src'); 
```

真的这么容易和正确的使用方法=）

# ruby-on-rails - Ruby：获取salesforce oauth_token

> ID：16214812
> 
> 赞同：2
> 
> 时间：2013-04-25T12:29:02.703
> 
> 标签：ruby-on-rails, salesforce, databasedotcom-gem

我有`client_id`但`client_secret`要进行身份验证，我需要`oauth_token`. 如何使用 Ruby on Rails 获取此令牌？我尝试了几个选项，但无法解决。

使用的宝石：databasedotcom

我尝试了以下选项，但没有响应 [https://gist.github.com/undees/300175](https://gist.github.com/undees/300175)

```
require 'oauth'

consumer_key    = '...' # from SalesForce
consumer_secret = '...' # from SalesForce

oauth_options = {
:site               => 'https://login.salesforce.com',
:scheme             => :body,
:request_token_path => '/_nc_external/system/security/oauth/RequestTokenHandler',
:authorize_path     => '/setup/secur/RemoteAccessAuthorizationPage.apexp',
:access_token_path  => '/_nc_external/system/security/oauth/AccessTokenHandler',
}
consumer = OAuth::Consumer.new consumer_key, consumer_secret, oauth_options
# consumer.http.set_debug_output STDERR # if you're curious 
request       = consumer.get_request_token
authorize_url = request.authorize_url :oauth_consumer_key => consumer_key 
puts "Go to #{authorize_url} in your browser, then enter the verification code:"
verification_code = gets.strip 
access = request.get_access_token :oauth_verifier => verification_code

puts "Access Token:  " + access.token
puts "Access Secret: " + access.secret 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T06:46:49.503

**SOLUTION**: databasedotcom-oAuth2 gem worked for me. It takes client key and secret and interact with salesforce. Detail is given in here. Click Here [http://wiki.developerforce.com/page/Introduction_to_the_databasedotcom-oauth2_Gem](http://wiki.developerforce.com/page/Introduction_to_the_databasedotcom-oauth2_Gem)

# ios - UITabBarController 显示

> ID：16214819
> 
> 赞同：0
> 
> 时间：2013-04-25T12:29:22.047
> 
> 标签：ios, objective-c, uitabbarcontroller, cgrectmake

我是iOS开发的新手。我正在开发一个使用标签栏控制器的应用程序。我正在以编程方式为标签栏控制器设置框架，但是当我切换到 iPhone 5 时，标签栏项目和主视图之间会创建空白区域。以下是 iPhone 5 模拟器上的应用程序屏幕截图。

![4.5 视网膜显示模拟器上的屏幕截图](https://i.stack.imgur.com/IHaET.png)

以下是我设置框架的代码行`UITabBarController`：

```
[rootTabBarController.view setFrame:CGRectMake(0,-20,320, 480)]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:32:55.757

把这行代码检查一下，你必须相应地设置框架。

```
if ([[UIScreen mainScreen] bounds].size.height == 568)
     {

       [rootTabBarController.view setFrame:CGRectMake(0,0,320, 568)];
     }
 else
     {
        [rootTabBarController.view setFrame:CGRectMake(0,0,320, 480)];
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:37:25.763

这是因为早期的 iPhone 和 iPhone 5 之间存在高度差异。

您可以通过两种方式解决此问题：

在 iPhone 5 上运行时手动设置帧大小。

```
BOOL isIphone5 = (([[UIDevice currentDevice] userInterfaceIdiom] 
== UIUserInterfaceIdiomPhone) && (([UIScreen mainScreen].bounds.size.height) >= 568));
if(isIphone5)
{
   [rootTabBarController.view setFrame:CGRectMake(0,0,320, 568)];
}
else{
   [rootTabBarController.view setFrame:CGRectMake(0,0,320, 480)];
} 
```

或者您可以设置 AutoResizingmasks 让您的视图自动调整为新的屏幕尺寸或方向（自动调整大小的有用性取决于视图的定义方式）。

```
[rootTabBarController.view setAutoResizingMask:UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:38:15.647

您需要根据设备分辨率调整帧。我们知道 iPhone 5 的屏幕尺寸为 (320,568)，因此您可以检查您使用的是 iPhone 5（4 英寸屏幕）还是其他（3.5 英寸屏幕）使用

```
#define IS_IPHONE ( [[[UIDevice currentDevice] model] isEqualToString:@"iPhone"])
#define IS_HEIGHT_GTE_568 [[UIScreen mainScreen ] bounds].size.height >= 568.0f
#define IS_IPHONE_5 ( IS_IPHONE && IS_HEIGHT_GTE_568 ) 
```

然后将框架设置为

```
[rootTabBarController.view setFrame:CGRectMake(0,-20,320,IS_IPHONE_5?568.0f:480.0f)]; 
```

希望它可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:35:07.803

just.dont.do.it（不要设置框架）！！！

最简单和干净的技术是：

YourAppDelegate.h：

```
@property(nonatomic,retain) UITabBarController * tabBarController; 
```

YourAppDelegate.m：

```
@synthesize tabBarController;
#pragma mark -
#pragma mark Application lifecycle

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

self.tabBarController = [[[UITabBarController alloc] init] autorelease];

UINavigationController      *viewController1 = [[[UINavigationController alloc] initWithRootViewController:[[[UIViewController alloc] init] autorelease]] autorelease];

UINavigationController      *viewController2 = [[[UINavigationController alloc] initWithRootViewController:[[[UIViewController alloc] init] autorelease]] autorelease];

self.tabBarController.viewControllers = @[viewController1, viewController2];
self.tabBarController.customizableViewControllers = nil;

self.window.rootViewController = self.tabBarController;
[self.window makeKeyAndVisible];

return YES; 
```

}

一切都会好起来的。iPhone、iPad 等上的框架、旋转、自动调整大小等。

顺便说一句，您可以在 Xcode 中使用“Tab Bar application”模板创建新项目，看看 Apple 是如何做到的

和..（建议，将来可以帮助您）UITabBarController 必须位于视图层次结构的顶部（直接在 UIWindow 上）才能正确旋转等，我的示例代码包括它（它可以在将来为您节省一些时间）

# javascript - HTML5 currentTime 在PhoneGap 中不起作用

> ID：16214827
> 
> 赞同：1
> 
> 时间：2013-04-25T12:29:52.973
> 
> 标签：javascript, html, cordova

我正在使用 PhoneGap 并为三星 Galaxy Tab 2 制作应用程序。我正在尝试从特定时间开始播放 mp4 视频。使用此代码，视频仅从头开始，而不是 20 秒。可能有什么问题？

```
function onDeviceReady() {
    var playerDiv = document.getElementById('player');

    playerDiv.innerHTML="<video id='video' src='"+window.localStorage.getItem("selectedVideo")+"' loop='loop' width='1285' height='752'></video>";

    document.getElementById("video").addEventListener("loadedmetadata", function() {
        this.currentTime = 20;
    }, false);
}

function playVideo() {
    document.getElementById('video').play();
} 
```

我也试过这个，但它仍然从头开始：

```
document.getElementById('video').addEventListener('loadedmetadata', function() {
   this.currentTime = 20;
   this.play();
}, false); 
```

并且使用 loadmetedata 的 canplay insted 不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:49:32.673

这是类似的问题

[音频标签、jQuery 和 currentTime 的问题](https://stackoverflow.com/questions/14064449/trouble-with-audio-tag-jquery-and-currenttime)

```
var audio = $('audio');
audio.bind('canplay', function() {
        this.currentTime = 20;
});
audio.get(0).play(); 
```

# sed - 'sed' : 如何在字符串匹配 + 2 行后添加新行

> ID：16214828
> 
> 赞同：8
> 
> 时间：2013-04-25T12:29:54.037
> 
> 标签：sed

我想在字符串匹配 + 2 行之后添加一个新行。

这是我的文件：

```
allow-hotplug eth0
auto eth0
iface eth0 inet static
address 172.16.2.245
netmask 255.255.254.0
gateway 192.168.1.1

allow-hotplug eth1
#auto eth1
iface eth1 inet static
address 192.168.0.240
netmask 255.255.255.0

iface eth2 inet static
address 192.168.2.240
netmask 255.255.255.0 
```

我想在找到“iface eth1”+ 2 行后添加“网关 192.168.1.1”。

示例：执行 sed 命令后我需要得到什么

```
allow-hotplug eth0
auto eth0
iface eth0 inet static
address 172.16.2.245
netmask 255.255.254.0
gateway 172.16.2.254

allow-hotplug eth1
#auto eth1
iface eth1 inet static
address 192.168.0.240
netmask 255.255.255.0
gateway 192.168.1.1

iface eth2 inet static
address 192.168.2.240
netmask 255.255.255.0 
```

我知道如何在特定字符串之后查找和移动 2 行，在特定字符串之后附加行等，但不结合这 2 个操作。斯蒂芬

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-25T13:00:48.803

这似乎有效：

```
sed '/^iface eth1/{N;N;s/$/\ngateway 192.168.1.1/}' input.txt 
```

添加`-i`选项以`sed`将结果保存回`input.txt`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T13:04:13.477

一种使用方式`sed`：

```
sed '
/iface eth1/ {
n
n
a\gateway 192.168.1.1
}' file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T13:10:32.083

您要求使用“sed”，但“Kent”正在使用“awk”，这是一个 sed 脚本，可以为您的示例执行您想要的操作。更一般地说，sed 脚本的第 1 行可以包含您想要的任何字符串，而 sed 脚本的第 5 行可以包含您想要的任何字符串。将以下脚本放在一个文件中，比如 x.sed，不要添加任何空格或制表符。

```
 /iface eth1/{
    n
    n
    a\
    gateway 192.168.1.1
    } 
```

然后在命令行上像这样运行它。

```
 sed -f x.sed "myinputfile" > "myoutputfile" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:49:32.483

如果您想在该块的末尾添加行，请尝试以下操作：

```
awk -v RS="" -v ORS="\n\n" '/iface eth1/{$0=$0"\ngateway 192.168.1.1"}1' file 
```

与您的文件：

```
kent$  cat file
allow-hotplug eth0
auto eth0
iface eth0 inet static
address 172.16.2.245
netmask 255.255.254.0
gateway 192.168.1.1

allow-hotplug eth1
#auto eth1
iface eth1 inet static
address 192.168.0.240
netmask 255.255.255.0

iface eth2 inet static
address 192.168.2.240
netmask 255.255.255.0

kent$  awk -v RS="" -v ORS="\n\n" '/iface eth1/{$0=$0"\ngateway 192.168.1.1"}1' file
allow-hotplug eth0
auto eth0
iface eth0 inet static
address 172.16.2.245
netmask 255.255.254.0
gateway 192.168.1.1

allow-hotplug eth1
#auto eth1
iface eth1 inet static
address 192.168.0.240
netmask 255.255.255.0
gateway 192.168.1.1

iface eth2 inet static
address 192.168.2.240
netmask 255.255.255.0 
```

# windows-phone-8 - 未找到 StoredContact 的寻呼机属性

> ID：16214832
> 
> 赞同：0
> 
> 时间：2013-04-25T12:30:12.350
> 
> 标签：windows-phone-8

我正在尝试从自定义联系人存储中创建的 StoredContact 对象中提取一些属性。我执行以下操作来提取属性：

```
StoredContact contact = ...
var properties = await contact.GetPropertiesAsync();
var number = properties[KnownContactProperties.MobileTelephone]; 
```

但是，在 KnownContactProperties 类中找不到号码类型“寻呼机”。

如何从 StoredContact 对象中获取寻呼机号码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:06:41.903

KnownContactProperties仅提供一些字符串常量来获取公共属性名称 - 可能是分页器未被广泛使用以提供属性名称的常量[。](http://msdn.microsoft.com/en-us/library/windowsphone/develop/windows.phone.personalinformation.knowncontactproperties%28v=vs.105%29.aspx)

相反，为什么不查看`properties`调试器中用于与寻呼机联系的键，然后使用它呢？

# opengl-es - 看不到灯光工作 openGL ES 2.0

> ID：16214834
> 
> 赞同：0
> 
> 时间：2013-04-25T12:30:22.840
> 
> 标签：opengl-es, opengl-es-2.0

我已经在我的代码和着色器中设置了我的照明，但除了我目前拥有的四边形之外什么都看不到。灯光不工作，我真的看不出哪里出错了。

我有一个带有纹理的四边形，其中四边形旋转了 90 度，因此它平放，在我的代码中，我已经完成了这样的照明......

```
 // Set light direction in model space
PVRTVec4 vLightDirModel;
vLightDirModel =  modelView.inverse() * PVRTVec4(0.57735f, 0.57735f, 0.57735f, 0);

glUniform3fv(m_ShaderProgram.auiLoc[eLight], 1, &vLightDirModel.x);

// Set eye position in model space
PVRTVec4 vEyePosModel;
vEyePosModel = modelView.inverse() * PVRTVec4(0, 0, 0, 1);

glUniform3fv(m_ShaderProgram.auiLoc[eEyePos], 1, &vEyePosModel.x); 
```

这是我的着色器

垂直着色器：

```
attribute highp   vec3  inVertex;
attribute mediump vec2  inTexCoord;

uniform highp   mat4  MVPMatrix;
uniform mediump vec3  LightDir;
uniform mediump vec3  EyePos;

varying mediump vec3  EyeDir;
varying lowp    float  specIntensity;
varying mediump vec2  TexCoord;

const mediump float  cShininess = 10.0;

void main()
{
    // Transform position
    gl_Position = MVPMatrix * vec4(inVertex,1.0);

    // Calculate direction from eye position in model space
    mediump vec3 EyeDir = normalize(EyePos - inVertex);

        // Specular lighting
    // We ignore that N dot L could be negative (light coming 
    // from behind the surface)
    mediump vec3 halfVector = normalize(LightDir + EyeDir);
    lowp float NdotH = max(dot(inNormal, halfVector), 0.0);     
    specIntensity = pow(NdotH, cShininess);

    TexCoord = inTexCoord;
} 
```

这是我的碎片着色器

均匀采样器2D反射Tex；

```
varying mediump vec2  TexCoord;
varying lowp    float specIntensity;

//This gets updated within the main code
uniform highp float Time;

void main()
{   
    lowp vec3 refColor = texture2D(reflectionTex, TexCoord).rgb;
    gl_FragColor =  vec4(refColor + specIntensity, 1.0);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T07:40:21.097

您正在混淆您的照明计算。在您的评论中，您说您正在计算镜面反射照明项。因此，对于您的平面，您希望在代码中看到的最多的是四边形某处的一个小的白色区域，**如果**光线的角度恰到好处。即使这样计算也是错误的，因为您没有计算反射光矢量。

基本的 phong 光照模型包括另外两个术语，漫反射（根据法线和光 vec 之间的角度改变颜色，即角度越大，颜色越深）和环境（向每个片段添加均匀的光以模拟环境光）。

我建议你阅读这个优秀的教程并将其改编为 ES： [http ://www.ozone3d.net/tutorials/glsl_lighting_phong.php](http://www.ozone3d.net/tutorials/glsl_lighting_phong.php)

# jquery - 将handsontable 与现有表一起使用

> ID：16214836
> 
> 赞同：1
> 
> 时间：2013-04-25T12:30:24.993
> 
> 标签：jquery, handsontable

你知道我是否可以将 hansontable jquery 插件与已经存在的表一起使用？

因为在文档中，我看到我们可以像这样创建一个带有可动手操作的表格：

```
var data = [
  ["", "Kia", "Nissan", "Toyota", "Honda"],
  ["2008", 10, 11, 12, 13],
  ["2009", 20, 11, 14, 13],
  ["2010", 30, 15, 12, 13]
];

var $container = $("#example1");
$container.handsontable({
  data: data
}); 
```

但我希望做这样的事情：

```
$("#monTableau").handsontable(); 
```

为了给我的桌子赋予handsontable的功能

请问你有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:38:02.100

解决方法：

```
 var data = [];
$('#monTableau tr').each(function(index,el){
    var rowData = [];
    $(el).children().each(function(index,el){
        rowData.push($(el).html()); //or use text() if u prefer
    });
    data.push(rowData);
});
el = $('#monTableau').after('<div class="handsontable"></div>').next();
$('#monTableau').remove();
el.handsontable({ data : date }); 
```

或自己扩展库以使其成为可能。

# java - transferhandler 忽略拖动事件

> ID：16214837
> 
> 赞同：0
> 
> 时间：2013-04-25T12:30:29.487
> 
> 标签：java, swing, drag-and-drop, jtable

我在 JTable（嵌入在 JPanel + JScrollPane 中）上设置了一个传输处理程序。将表格中的元素拖到其他地方（创建可转移的......）可以工作。将元素拖放到表格中不起作用，任何拖动事件都会被忽略。问题可能是事件消费者（消耗拖动事件），但这是我唯一的想法。

```
final JTable tbl = new MyJTable();
tbl.setDragEnabled(true);
tbl.setTransferHandler(new TransferHandler() {

@Override
protected Transferable createTransferable(JComponent comp) {
    // .... works
}

@Override
public boolean canImport(TransferSupport support) {
    // ... never called

}

@Override
public boolean importData(TransferSupport support) {
  // ... never called
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T14:42:50.047

我记得在使用 JTree 时遇到了同样的问题，并且解决方案`getSourceActions`在我的实现中实现`TransferHandler`并在其中定义了传输操作。例如：

```
 @Override
    public int getSourceActions(JComponent comp) {
        return MOVE;
    } 
```

# java - 找到浪费内存的班级

> ID：16214838
> 
> 赞同：1
> 
> 时间：2013-04-25T12:30:34.037
> 
> 标签：java, android, memory-management, memory-leaks

几个月前我在 Google Play 上发布了一个应用程序，我的大多数用户对我的应用程序的内存使用有很大的问题，这是真的，因为当我从“运行应用程序”选项卡检查我的内存使用情况时，我看到了它需要**80~110MB**的内存，如下图：

![在此处输入图像描述](https://i.stack.imgur.com/HYeGt.jpg)

要查找导致此问题的类/活动或代码片段，我发现 MAT（内存分析工具）插件很有用，但它真的让我感到困惑，请考虑下图：

![在此处输入图像描述](https://i.stack.imgur.com/iaz0a.jpg)

已用内存的总大小为**9.8MB** ，但“正在运行的应用程序”选项卡同时显示**80MB**！

另一个问题是直方图，对象的浅**堆**`byte[]`太高。

正常吗？另外，当我调试一些谷歌项目时，字节值总是太高！

![在此处输入图像描述](https://i.stack.imgur.com/RILm9.jpg)

那么我怎样才能找到正在使用所有这些内存的内容呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-18T09:02:39.430

当一个 Android 应用程序启动时，它会继承分配的对象`Zygote`- 一个使应用程序生成速度更快的技巧。因此，当您获得内存转储时，它们会显示为您自己的。

为什么 Zygote 有这么多内存分配的答案是另一个`resource`加快加载速度的技巧。在 Android 启动期间，Zygote*预加载*了一些类和资源列表，因此所有其他应用程序不需要每次都加载它们。

有关此预加载的实现，请参见[ZygoteInit.java #330。](https://android.googlesource.com/platform/frameworks/base/+/android-4.3_r3/core/java/com/android/internal/os/ZygoteInit.java)

字节数组的大量使用是由于这种预加载的资源（即位图）。

有关来自权威资源的 MAT / 字节数组使用分析的更具体示例，请参阅此[答案](https://stackoverflow.com/a/18643245/1163019)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T06:17:42.177

您是否尝试过使用[视觉虚拟](http://visualvm.java.net/)机？这是一个很好的教程，可以找出类和实例的内存使用情况（[visual vm tutorial](http://www.captaincasa.com/pdf/techdoc_memprofiling.pdf)）。希望这对您有所帮助。

# ios - 喜欢按钮操作的 Facebook 页面

> ID：16214839
> 
> 赞同：4
> 
> 时间：2013-04-25T12:30:35.960
> 
> 标签：ios, iphone, facebook, facebook-like, facebook-page

我正在尝试从应用程序实现类似页面的功能，我添加了最新`Facebook SDK`的并实现了所有委托和处理程序来检查用户登录到应用程序的会话和状态。它工作正常到这里（这已经在示例代码中完成）。无论如何，我从 Facebook 开发者网站上找到了以下代码来点赞一个页面，但它似乎不起作用。

```
- (void) likeFacebookIndia
{
    NSMutableDictionary<FBGraphObject> *action = [FBGraphObject graphObject];
    action[@"object"] = @"http://www.facebook.com/FacebookIndia";
    //action[@"object"] = @"FacebookIndia";
    [FBRequestConnection startForPostWithGraphPath:@"me/og.likes"
                                       graphObject:action
                                 completionHandler:^ (FBRequestConnection *connection,
                                                     id result,
                                                     NSError *error)
     {
         // handle the result
         if(error)
         {
             NSLog(@"%@",error.localizedDescription);
         }
         else
         {
             NSLog(@"%@",result);
         }
     }];
} 
```

一旦成功登录，我曾经调用上面的函数，它最终在`likeFacebookIndia`块中出现以下错误，

> 操作无法完成。（com.facebook.sdk 错误 5。）

在这里，我的问题是，

1.  我不确定这是否是喜欢页面的正确方法？

2.  如果它是正确的，那么我真的错过了什么？

3.  还有其他方法吗？

我已经访问了页面，`FacebookLikeView`并且`FBLikeButton`在这里已经提出了许多问题，但似乎没有一个适用于最新`Facebook SDK`更新。我可以喜欢一个页面，`FacebookLikeView`但是有很多问题，

1.  A`UIKeyBoard`在喜欢页面后出现
2.  如果需要登录，花时间加载 Facebook 页面，并且
3.  第二次点赞到同一页面后，点赞视图消失在某个地方！

**更新** 我在 Graph API Explorer 上测试了同样的东西，结果如下，

![图形 API 资源管理器](https://i.stack.imgur.com/zTk1F.png)

`{ "error": { "message": "(#100) Like actions are not yet supported against objects of this type.", "type": "OAuthException", "code": 100 } }`

**更新 2**

我确实闯入了`FacebookLikeView`课程并解决了我编写的上述问题，尽管它现在应该可以工作了吗？不，它不起作用，因为它正在使用`FBConnect`现在已经过时的东西，而且我最新`Facebook SDK`的其他东西工作得很好！*如果有人用最新的 SDK for FacebookLikeView 制作新项目，那就太好了。*【我已经在工作了！】

我就是这样的

```
//Calling this function in `viewDidLoad`

- (void) addLikeView
{
    facebookLikeView.delegate = self;
    facebookLikeView.href = [NSURL URLWithString:@"http://www.facebook.com/FacebookIndia"];
    facebookLikeView.layout = @"button_count";
    facebookLikeView.showFaces = NO;
    facebookLikeView.alpha = 0;
    [facebookLikeView load];
}

#pragma mark - Facebook Delegate
-(void)sessionDoneForPageShare:(FBSession *)session state:(FBSessionState)state error:(NSError *)error
{        
    if(error)
    {
        NSLog(@"error : %@",error);
    }
    else
    {
        [facebookLikeView load]; //In logged in or logged out, we've to call this
    }
}

- (void)facebookViewControllerCancelWasPressed:(id)sender
{
    NSLog(@"Login was cancelled by user");
}

- (void)facebookViewControllerDoneWasPressed:(id)sender
{
    NSLog(@"User tapped done button on login view");
}

- (void) checkFBloggedInStatus
{
    if (!FBSession.activeSession.isOpen)
    {
        NSArray *permissions = [NSArray array];
        [FBSession openActiveSessionWithPublishPermissions:permissions defaultAudience:FBSessionDefaultAudienceOnlyMe allowLoginUI:YES completionHandler:^(FBSession *session, FBSessionState status, NSError *error){
            [self sessionDoneForPageShare:session state:status error:error];}
         ];
    }
}

#pragma mark FacebookLikeViewDelegate methods
- (void)facebookLikeViewRequiresLogin:(FacebookLikeView *)aFacebookLikeView {
    [self checkFBloggedInStatus];
}

- (void)facebookLikeViewDidRender:(FacebookLikeView *)aFacebookLikeView {
    [UIView beginAnimations:@"" context:nil];
    [UIView setAnimationDelay:0.5];
    facebookLikeView.alpha = 1;
    [UIView commitAnimations];
}

- (void)facebookLikeViewDidLike:(FacebookLikeView *)aFacebookLikeView {
    NSLog(@"liked");
}

- (void)facebookLikeViewDidUnlike:(FacebookLikeView *)aFacebookLikeView {
    NSLog(@"unliked");
}

- (void)facebookLikeView:(FacebookLikeView *)aFacebookLikeView didFailLoadWithError:(NSError *)error
{
    NSLog(@"FacebookLikeView error: %@",error);
} 
```

有了这个，我可以看到like按钮，可以登录浏览器，但是什么也不会发生！它每次都会显示Like按钮！

这在旧 SDK 上运行良好`FBConnect`，问题出在最新版本`Facebook SDK`上，你可以在`FacebookLikeView` [**这里**](https://github.com/brow/FacebookLikeView)找到，

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-13T12:04:08.397

### 大更新！

如果您看到这意味着，现在您不需要在应用程序中修补（或破解）任何支持（如 Facebook 上的页面或任何 Open Graph 对象）的东西。随着 Facebook iOS SDK (FacebookSDK.framework) 的最新版本，他们支持类似按钮，但是（在我编写此更新时）它在`beta`，但我们有一些我们长期以来一直希望的东西，*谢谢 Facebook* .

这是更改日志和喜欢按钮的直接链接，也是文档。

*   [更改日志](https://developers.facebook.com/docs/ios/change-log-3.x/)（最新 v3.19）。

*   [喜欢按钮文档](https://developers.facebook.com/docs/ios/like-button)

*   [Facebook iOS 文档](https://developers.facebook.com/docs/ios)

**解决方案：** [推荐]

> Like 按钮可用于为 Facebook 主页或任何 Open Graph 对象点赞，并可通过 URL 或 ID 引用。代码如下所示：

```
FBLikeControl *like = [[FBLikeControl alloc] init];
like.objectID = @"http://shareitexampleapp.parseapp.com/photo1/";
[self addSubview:like]; 
```

![在此处输入图像描述](https://i.stack.imgur.com/WScR4.png)

（来源：[文档](https://developers.facebook.com/docs/ios/like-button)）。

* * *

**老派的方式**[不推荐]

最后，我能够解决我的问题，我正在提出解决步骤，所以它对正在寻找这种东西的人真的很有帮助，

您可能需要知道的一些事情（来自我的问题）

*   我在我的应用程序中同时使用 FBConnect 和 Facebook SDK。
*   两者都工作正常，FBConnect 仅用于`FacebookLikeView`- 您需要将 FBRequest 类替换为 FBConnect 中的其他名称，这样它就不会与最新的 SDK 冲突。
*   仍然需要一些简单快捷的解决方案，因为*这不是完美的解决方案。*

所以我们开始，

**您如何知道用户是否喜欢此特定页面？**

您需要使用 Graph API 并检查用户的喜欢。这是一个例子。

```
https://graph.facebook.com/{USER_ID}/likes/{PAGE_ID} 
```

如果用户喜欢相关页面，如果用户喜欢该页面，它将返回如下所示的 JSON。

```
{
  "data": [
    {
      "name": "SomeCafe", 
      "category": "Restaurant/cafe", 
      "id": "someIdWillCome", 
      "created_time": "2013-05-07T12:32:00+0000"
    }
  ], 
  "paging": {
    "next": "https://graph.facebook.com/me/likes/someIdWillCome?format=json&limit=5000&offset=5000&__after_id=someIdWillCome"
  }
} 
```

如果用户不喜欢该页面，就像这样：

```
{
  "data": [
  ]
} 
```

这是关于用户喜欢的文档： [https ://developers.facebook.com/docs/reference/api/user/#likes](https://developers.facebook.com/docs/reference/api/user/#likes)

**执行**

1）`FacebookLikeView`按照其文档中的规定实施。

2）我需要实现一个 HTTP 请求来调用上面的 URL 来检查该页面的当前状态，因为我无法从`FacebookLikeView`. **请记住，您需要与 access_token 一起执行 GET 请求。**

3）检查响应（接近上面的例子）并做你需要的事情！

## 就是这样！

这是`FacebookLikeView`我遇到的问题的解决方案

* * *

1)`FacebookLikeView`去了某个地方？

这是因为评论弹出框隐藏了它！下面是解决方案

在`FacebookLikeView.m`课堂上寻找，并*在最后*`- (void)didObserveFacebookEvent:(NSString *)fbEvent` 添加这些行，

 *```
if([[[UIDevice currentDevice] systemVersion] floatValue] >= 5.0f)
{
    //NS_AVAILABLE_IOS(5_0);
    [[_webView scrollView] setContentOffset: CGPointMake (0, 0)];
} 
```

2) FacebookLikeView 显示 UIKeyboard！！

这是因为评论文本框焦点在像页面之后，下面是解决方案。

```
- (void) keyboardWasShown:(NSNotification *)notification
{
    //force hide UIKeyBoard
    [self.view endEditing:YES];
} 
```

将通知添加到`viewDidLoad`您实施的类中

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWasShown:) name:UIKeyboardWillShowNotification object:nil]; 
```

> 这将放弃从该特定视图可见的所有键盘，在我的情况下`UITextField`，我不需要 Facebook Like 按钮，所以如果你的情况不同，那么请确保这一点。

3)*加载缓慢*的问题取决于 Facebook 服务器、互联网连接或其他方面的许多因素，所以我在其中添加了一个加载指示器——*这需要一些时间，但可以按我的意愿工作！*

* * *

> 这将允许我喜欢/不像 Facebook 页面，我也能够知道该特定用户的当前状态，以便我可以决定做什么！

最后，感谢所有检查此问题并回复我的人！赞赏！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-10T15:20:41.913

很抱歉告诉您坏消息，但您不能代表用户点赞主页。您可以代表用户点赞帖子、评论和照片，但不能代表页面点赞（您提到的点赞视图也是如此）。如果您尝试执行后者，您将收到错误消息

> "message": "(#3) 应用程序没有能力进行这个 API 调用。"

但好消息是您可以通过使用将加载到 UIWebView 中的 iFrame 来做到这一点。**目前，这是在本机应用程序中集成类似PAGE**按钮的唯一解决方案。如需进一步阅读，您可以查看此资源：[http ://www.raywenderlich.com/1626/how-to-post-to-a-users-wall-upload-photos-and-add-a-like-button- from-your-iphone-app](http://www.raywenderlich.com/1626/how-to-post-to-a-users-wall-upload-photos-and-add-a-like-button-from-your-iphone-app) 在那里你可以找到一个部分

> 向您的 Facebook 粉丝页面添加“赞”按钮

希望这会帮助你。*

# python - 测试是否引发了 ValidationError

> ID：16214846
> 
> 赞同：16
> 
> 时间：2013-04-25T12:31:00.753
> 
> 标签：python, django, unit-testing

我想测试是否引发了异常，我该怎么做？

在我的models.py中，我有这个功能，我想测试的那个：

```
 def validate_percent(value):
    if not (value >= 0 and value <= 100):
      raise ValidationError('error') 
```

在我的tests.py中我试过这个：

```
def test_validate_percent(self):
    self.assertRaises(ValidationError, validate_percent(1000)) 
```

测试的输出是：

```
..E
======================================================================
ERROR: test_validate_percent (tm.tests.models.helpers.HelpersTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/...py", line 21, in test_validate_percent
    self.assertRaises(ValidationError, validate_percent(1000))
  File "/....py", line 25, in validate_percent
    raise ValidationError(u'error' % value)
ValidationError: ['error'] 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-25T12:33:02.043

`assertRaises`用作上下文管理器：

```
def test_validate_percent(self):
    with self.assertRaises(ValidationError):
        validate_percent(1000) 
```

或可调用：

```
def test_validate_percent(self):
    self.assertRaises(ValidationError, validate_percent, 1000) 
```

*   [http://docs.python.org/2/library/unittest.html#unittest.TestCase.assertRaises](http://docs.python.org/2/library/unittest.html#unittest.TestCase.assertRaises)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T12:34:00.357

```
def test_validate_percent(self):
    self.assertRaises(ValidationError, validate_percent, 1000) 
```

# c# - 列表框项目未填满屏幕 WP7 的整个宽度

> ID：16214848
> 
> 赞同：0
> 
> 时间：2013-04-25T12:31:08.337
> 
> 标签：c#, windows, windows-phone-7

我正在尝试使用以下模板创建一个包含项目的列表框

```
 <ListBox x:Name="moviesactedin" Style="{StaticResource ListBoxStyle2}">
       <ListBox.ItemTemplate>
            <DataTemplate>
                <Border BorderThickness="0,0,0,1" BorderBrush="Black" Margin="0,0,0,5">
                   <StackPanel Orientation="Horizontal" Margin="0,0,0,5" HorizontalAlignment="Stretch">
                         <Image Source="{Binding Image}" Stretch="None" Margin="0,0,5,5" />
                         <StackPanel Orientation="Vertical" Margin="10,0,0,0" VerticalAlignment="Top">
                        <TextBlock Text="{Binding Title}" Foreground="Black" FontWeight="Bold"/>
                        <TextBlock Text="{Binding Director}" Foreground="Black"/>
                        <TextBlock Text="{Binding ReleaseDate}" Foreground="Black"/>
                  </StackPanel>
                      <Image Source="/Images/icon_arrow.png" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                   </StackPanel>

              </Border>
        </DataTemplate>
</ListBox.ItemTemplate> 
```

和列表框样式

```
<Style x:Key="ListBoxStyle2" TargetType="ListBox">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Foreground" Value="{StaticResource PhoneForegroundBrush}"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="Padding" Value="0"/>
    <Setter Property="HorizontalAlignment" Value="Stretch" />
    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
    <Setter Property="Template">
        <Setter.Value>
              <ControlTemplate TargetType="ListBox">
                        <ItemsPresenter  HorizontalAlignment="Stretch" 
                                            VerticalAlignment="Stretch"/>
               </ControlTemplate>
         </Setter.Value>
    </Setter>
</Style> 
```

第一个图像将在左侧，带有三个文本块的 stackPanel 将在中间，第二个图像将在右侧（最后）。

问题是列表框项目没有填满屏幕的整个宽度，因此我将最后一个图像放在屏幕宽度的末尾。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:41:16.520

这有效

```
<ListBox.ItemContainerStyle>
         <Style TargetType="ListBoxItem">
               <Setter Property="Template">
                      <Setter.Value>
                           <ControlTemplate>
                                   <ContentPresenter
                                        HorizontalAlignment="Stretch" 
                                       VerticalAlignment="Stretch"
                                   />
                          </ControlTemplate>
                      </Setter.Value>
               </Setter>
           </Style>
</ListBox.ItemContainerStyle> 
```

这些项目填满了屏幕的整个长度。感谢Fabrice提供的线索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:36:18.963

你可以试试吗？

```
<Style x:Key="ListBoxItemStyle" TargetType="ListBoxItem">
<Setter Property="HorizontalContentAlignment" Value="Stretch"/>
<Setter Property="HorizontalAlignment" Value="Stretch"/></Style> 
```

# c# - ASP 按钮打开带有参数的 SSRS 报告的新窗口

> ID：16214855
> 
> 赞同：0
> 
> 时间：2013-04-25T12:31:32.663
> 
> 标签：c#, javascript, asp.net, reporting-services

我正在构建一个带有 C# 代码隐藏的简单 ASP.NET 表单的页面。我需要一个按钮（或某种控件）来打开指向新窗口的链接，并且我找到了可以使用 Javascript 执行此操作的代码，并且我找到了可用于使我的按钮打开我的 SSRS 报告的代码从我的 aspx 页面动态传递的参数。我还没有找到任何东西来处理这两个问题。

我的 asp 表单以查找 NPI（ID 类型）的简单文本框开头。该 NPI 用于搜索数据库和填充表单。我还希望在页面上有一个按钮，该按钮将获取用户输入的 NPI 并将其传递到打开我的 SSRS 报告的新窗口。

我对此进行了研究，我知道我可以使用 Javascript 打开一个新窗口，这会很棒，但我不知道如何将用户输入 NPI 包含到 JS 版本中。我知道我不能使用代码隐藏打开一个新窗口，但我可以使用 Response.Redirect 将 NPI 发送到 SSRS 报告的 URL。我找不到两者的结合。

先感谢您。这是我第一次在 StackOverflow 上发帖，尽管它每天都用它来回答问题。我为我正在做的任何错误道歉。

文本框：

```
<asp:TextBox ID="NPI" runat="server" Width="144px"></asp:TextBox> 
```

当前打开我的 SSRS 报告的按钮：

```
<asp:Button ID="reports" runat="server" Text="View Reports" 
    onclick="reports_Click" /> 
```

这是按钮的代码隐藏：

```
protected void reports_Click(object sender, EventArgs e)  
{  
    Response.Redirect("http://myReportServer/Pages/ReportViewer.aspx?%2fDRPreports%2fApplicantOverview&rs:Command=Render&npi=" + HttpUtility.UrlEncode(NPI.Text));  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T19:32:35.257

让我们试试这个以在新窗口中打开报告。ASPX：

```
<asp:TextBox ID="txt" runat="server"></asp:TextBox>
<asp:Button  ID="take" runat="server" onclick="take_Click" Text="no"/> 
```

背后的 ASPX.cs 代码：

```
Response.Write("<script>window.open('../About.aspx?qs=" + txt.Text + "','_blank');</script>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T20:41:52.990

在阅读了许多具有类似但不确切问题的网站后，我能够找到答案。我没有在 StackOverflow 上看到答案，所以我没有删除我的问题，而是认为我会提供一个解决方案，以防万一它可能会有所帮助。

解决方案非常简单。如原帖所述，对于新窗口，无法使用代码隐藏。仅当您同意用户离开页面时才使用它。对于新窗口，将按钮代码更改为：

```
<asp:Button ID="reports" runat="server" Text="View Reports" 
    onclientclick="Navigate()" /> 
```

onclientclick 现在引用打开新窗口所需的 JS。该脚本是：

```
<script type="text/javascript">
    function Navigate() {
        var w = document.getElementById('NPI').value
        window.open('http://MyReportServer/Pages/ReportViewer.aspx?%2fDRPreports%2fApplicantOverview&rs:Command=Render&npi=' + w);
    }
</script> 
```

如您所见，无非就是创建变量 (w) 并将 NPI 文本框的值赋给它。然后，在 window.open 中，将变量 W 添加到末尾，如图所示。

现在它将打开加载时分配了 NPI 参数的 SSRS 报告。如果这太简单了，我可以删除整个帖子。否则，我希望其他人发现在一个帖子中同时拥有两个选项（response.redirect 和 JS open.window）会有所帮助。

# deserialization - 反序列化 xml 文档正在更改 xml 中节点的值

> ID：16214858
> 
> 赞同：0
> 
> 时间：2013-04-25T12:31:43.100
> 
> 标签：deserialization

我有一个 xml，我根据 xml 中的文本更新树视图。示例 xml：

```
<TaskSeverity></TaskSeverity>
<TaskCategory></TaskCategory>
<TaskTitle></TaskTitle>
<TaskMessage></TaskMessage>
<TaskCode></TaskCode>
<TaskName>SQL_MAPPING_COMPANIES</TaskName>
<Schema>CLIENT</Schema>
<!-- Schema is a required field -->
<Mapping>Companies</Mapping>
<!-- Mapping is a required field -->
<CacheDb>false</CacheDb>
<!-- CacheDb is an optional field. Default value is false -->
<DeleteTableBeforeExecute>true</DeleteTableBeforeExecute>
<!-- DeleteTableBeforeExecute is an optional field. Default value is false --> 
```

现在我有一个方法可以做到这一点。

```
public void UpdateTreeView(XmlDocument xDoc)
      {
         xmlTreeViewAdv.Nodes.Clear();
         _nodeToTaskDictionary.Clear();
         if (xDoc == null)
            return;
         TreeNodeAdv rootNode = new TreeNodeAdv(xDoc.DocumentElement.Name);
         if (rootNode.Text.Equals("DmtTask") && xDoc.DocumentElement != null)
         {
            foreach (XmlAttribute attribute in xDoc.DocumentElement.Attributes)
            {
               if (attribute.Name.Equals("xsi:type"))
               {
                  rootNode.Text = attribute.Value;
               }
            }
         }

   xmlTreeViewAdv.Nodes.Add(rootNode);

      rootNode.Font = new Font(rootNode.Font, FontStyle.Bold);

_nodeToTaskDictionary.Add(rootNode, DmtTaskToolbox.FromXml(xDoc));
//This particular line does the deserialization part.

} 
```

// _nodeToTaskDictionary 在哪里

```
 public Dictionary<TreeNodeAdv, DmtTask> _nodeToTaskDictionary = new Dictionary<TreeNodeAdv, DmtTask>();

//where TreeNodeAdv is the Treeview (Syncfusion) and DmtTask is an abstract class

public static class DmtTaskToolbox
   {
      public static DmtTask FromXml(XmlDocument xDoc)
      {
         DmtTask t = DmtTask.DmtXmlSerializer.Deserialize(new XmlNodeReader(xDoc)) as DmtTask;
          // As soon as the above line is executed the value of the last node DeleteTableBeforeExecute innerText is changing to False. I could not understand the reason for it
         if (t == null)
            throw new Exception("Unable to convert the specific XML document DmtTask");
         return t;
      }
   } 
```

公共静态 XmlSerializer DmtXmlSerializer = new XmlSerializer(typeof(DmtTask), DmtTaskTypes);

基于该节点的值，我将从表中删除整个记录并插入新记录。但它返回错误。

这是反序列化后看到的

```
<TaskSeverity></TaskSeverity>
<TaskCategory></TaskCategory>
<TaskTitle></TaskTitle>
<TaskMessage></TaskMessage>
<TaskCode></TaskCode>
<TaskName>SQL_MAPPING_COMPANIES</TaskName>
<Schema>CLIENT</Schema>
<!-- Schema is a required field -->
<Mapping>Companies</Mapping>
<!-- Mapping is a required field -->
<CacheDb>false</CacheDb>
<!-- CacheDb is an optional field. Default value is false -->
<DeleteTableBeforeExecute>false</DeleteTableBeforeExecute>
<!-- DeleteTableBeforeExecute is an optional field. Default value is false --> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T11:00:24.943

问题在于抽象类 DeleteTableBeforeExectue 中定义的公共变量与我试图反序列化的 xmldocument 中定义的标签 DeleteTableBeforeExecute 的拼写不同。

**将类序列化为 XML 时，每个公共属性和字段值都会转换为 XML 元素。元素的名称与属性的名称相匹配。XmlElement 属性允许修改 XML 标记的名称和格式**

# jquery-waypoints - 带有开关的粘性标题（如 Hongkiat）

> ID：16214862
> 
> 赞同：1
> 
> 时间：2013-04-25T12:31:51.493
> 
> 标签：jquery-waypoints

我在本教程[http://www.webtutorialplus.com/sticky-header-on-scroll-jquery/中使用航点创建粘性标题](http://www.webtutorialplus.com/sticky-header-on-scroll-jquery/)

但是如何创建一个“交换”的标题？

示例：如果您访问[http://www.hongkiat.com/blog/](http://www.hongkiat.com/blog/)并向下滚动滚动的标题，实际上并不是页面上最初可见的元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T22:27:32.730

这是你要找的吗？

[工作演示](http://jsfiddle.net/3JZL7/)

```
$('.showafterthis').waypoint(function() {
  if ($(".header2").is(":hidden")) {
    $(".header2").slideDown(100);
  } else {
        $(".header2").slideUp(100);
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T21:46:40.690

它们实际上是两个独立的导航。酒吧。

我会创建另一个并通过将其移出屏幕顶部来隐藏它。当然，将它放在具有相对位置的任何内部 html 之外。

```
<div id="nav2">Your links and jazz</div> 
```

在 CSS 中：

```
#nav2 { style:your; bar:!; }
.sticky-wrapper { position:absolute; top:-50px;  } 
```

粘性包装线非常重要。这是导航栏周围的 div，这是获取定位的行，而不是 nav2 行。

对于您的 JavaScript：

```
$('#nav2').waypoint('sticky', {
    offset: -300 // how far from top
}); 
```

您可以使用偏移量来获得所需的位置。

祝你好运！

# dependencies - 在 Gradle 中跳过禁用任务的依赖执行？

> ID：16214865
> 
> 赞同：9
> 
> 时间：2013-04-25T12:31:54.540
> 
> 标签：dependencies, gradle

当任务将被跳过时，是否有可能*不执行任务的依赖关系？*

在下面的示例中`jar`，`jar`如果*在*执行`runServerTests`. 在这种情况下，服务器将由另一个进程启动。

```
apply plugin: 'java'

task startServerIfNotRunning(dependsOn: jar) {
  onlyIf { isServerNotRunning() }
  ...
}

task runServerTests(dependsOn: startServerIfNotRunning) { ... } 
```

我不想`onlyIf`在`jar`任务中添加一个，因为总是应该执行的其他任务可能取决于那个任务。该`jar`任务也有自己的依赖关系。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-26T11:48:05.970

要获得所需的行为，您必须从任务执行图中排除任务，而不是跳过它的执行。您可以使用`-x`命令行或以编程方式使用`gradle.startParameter.excludedTaskNames << "..."`or来执行此操作`gradle.taskGraph.useFilter { task -> ... }`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-28T15:41:18.020

你可以做类似的事情

```
task startServerIfNotRunning(dependsOn: jar) {
    if (isServerNotRunning()) {
        enabled = false;
        dependsOn = [];
    }
} 
```

我们在配置阶段评估的 if 语句和相关任务被删除。我在[Skipping Gradle Tasks](http://opensourceforgeeks.blogspot.in/2014/12/skipping-gradle-tasks.html) with code and output 中总结了这一点。看一看。

# android - 我在 eclipse 资源文件夹中的哪里放置图像？

> ID：16214867
> 
> 赞同：2
> 
> 时间：2013-04-25T12:32:05.127
> 
> 标签：android, eclipse

在“res”下有几个文件夹，从 drawable-ldpi 到 drawable-xxhdpi，如果我只想让它在所有设备上都是相同的图像，我应该把我的图像放在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T12:34:21.363

无论其 dpi 如何，您都可以将其放在任一文件夹下：

*   res/drawable-nodpi
*   资源/可绘制

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T12:34:19.547

你必须把它放在drawable-nodpi中。drawable-nodpi 中的可绘制对象不会根据屏幕的密度进行缩放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T12:34:05.983

把它放进去`res/drawable`。如果 Android 在其他文件夹中没有找到该资源，它将在那里默认。

# java - 标准 MBean 和动态 MBean 有什么区别？

> ID：16214869
> 
> 赞同：10
> 
> 时间：2013-04-25T12:32:08.940
> 
> 标签：java, jmx, mbeans

有什么区别：

1.  标准 MBean
2.  动态 MBean

各自的优缺点是什么？我们何时应该选择这两个组件中的任何一个来管理资源？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T14:33:56.660

标准 mbean 具有固定的元数据，在 MBean 的生命周期内不会更改。动态 MBean 动态定义它们的元数据，并且可以修改和重新发布它们的元数据。想想这个与 Java 的 [糟糕] 人为的类比：假设您编写了一个列出目录中文件数量的类。标准的类方法可能如下所示：

`public int getFileCount(String directoryName)`

另一方面，这个类的 Dynamic MBean 版本开始时没有方法，但是当它启动时，它会扫描可用的目录，并为找到的每个目录创建一个新方法：

```
public int getFileCountDir1();
public int getFileCountDir2();
....
public int getFileCountDirN(); 
```

所以这不是一个非常有用的设置，但是假设您想要创建一个显示所有 JVM 系统属性的 MBean。嗯.... 系统属性发生变化... 没有合理的方法可以提前知道哪些属性键将被定义，因此这将更好地表示动态 MBean 的优点。

优点和缺点实际上归结为：

1.  标准 MBean 易于创建，并且现有的类实例可以作为标准 mbean 进行包装和公开。
2.  动态 MBean 在服务于有用的目的时很酷，但要实现它们要付出更多的努力。

# javascript - 处理多个 Ajax 请求

> ID：16214879
> 
> 赞同：2
> 
> 时间：2013-04-25T12:32:30.263
> 
> 标签：javascript, ajax, request

**如何处理多个 Ajax 请求**

我在单个*PHP 页面中使用了 1 个以上的**Like 按钮*，单击该按钮时会调用相同的 Ajax 代码，从而将相应的*Like*更新为*不同*的文本。

 ***下面的代码适用于所有 Like Button 当我点击其中任何一个时 n 等待 ajax 更新它.. 但是当我同时点击多个 1 并等待更新时，在这种情况下只有最后点击的 Like Text 更改为不像..

请提供更好的解决方案或代码来做到这一点

谢谢

* * *

**页面：Like.php**

```
<span id="like1" onclick="ajaxFun(1)">Like</span><br />
<span id="like2" onclick="ajaxFun(2)">Like</span><br />
<span id="like3" onclick="ajaxFun(3)">Like</span><br />
<span id="like4" onclick="ajaxFun(4)">Like</span><br />
<span id="like5" onclick="ajaxFun(5)">Like</span><br />
....
<span id="like10" onclick="ajaxFun(10)">Like</span><br /> 
```

* * *

**页面：ajaxx.js**

```
function ajaxFun(id) {
    document.getElementById("like"+id).innerHTML="wait !!!";
    if (window.XMLHttpRequest) {
        // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else {
        // code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function() {
        if (xmlhttp.readyState==4 && xmlhttp.status==200) {
            var getData=xmlhttp.responseText;
            if(getData=="ok") {
                document.getElementById("like"+id).innerHTML="Unlike";
            }
            else {
                    document.getElementById("like"+id).innerHTML="Like";
            }
        }
    }
    xmlhttp.open("GET","verify.php?id="+id,true);
    xmlhttp.send();
} 
```

* * *

**页面：verify.php**

它验证某些东西，如果完成*返回正常*，否则*不正常*

* * *

**错误 ：（**

```
Like
Like
Like
wait !!!
wait !!!
wait !!!
wait !!!
wait !!!
wait !!!
Unlike 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:48:47.097

只需为 AJAX 处理程序设置一个数组...

```
var arrAjaxHandlers = [];
function ajaxFun(id) {
document.getElementById("like"+id).innerHTML="wait !!!";
if ( arrAjaxHandlers[ "like"+id ] == null )
{
    if (window.XMLHttpRequest) {
        // code for IE7+, Firefox, Chrome, Opera, Safari
        arrAjaxHandlers[ "like"+id ]=new XMLHttpRequest();
    } 
    else {
        // code for IE6, IE5
        arrAjaxHandlers[ "like"+id ]=new ActiveXObject("Microsoft.XMLHTTP");
    }
}
arrAjaxHandlers[ "like"+id ].onreadystatechange=function() {
    if (arrAjaxHandlers[ "like"+id ].readyState==4 && arrAjaxHandlers[ "like"+id ].status==200) {
        var getData=arrAjaxHandlers[ "like"+id ].responseText;
        if(getData=="ok") {
            document.getElementById("like"+id).innerHTML="Unlike";
        }
        else {
                document.getElementById("like"+id).innerHTML="Like";
        }
    }
}
arrAjaxHandlers[ "like"+id ].open("GET","verify.php?id="+id,true);
arrAjaxHandlers[ "like"+id ].send();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:48:45.557

我认为正在发生的事情是`xmlhttp`在全球范围内使用，这可能是有问题的。（有关更详细的原因，请参阅[此问题和答案](https://stackoverflow.com/questions/1470488/difference-between-using-var-and-not-using-var-in-javascript)。如果尚未声明，请在函数中声明它。

```
function ajaxFun(id) 
{
    document.getElementById("like" + id).innerHTML = "wait !!!";
    var xmlhttp = null; /* NEW LINE */
    if (window.XMLHttpRequest)
    {
        // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp = new XMLHttpRequest();
    }
    else
    {
        // code for IE6, IE5
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    if (xmlhttp !== null)
    {
        xmlhttp.onreadystatechange = function()
        {
            if (xmlhttp.readyState == 4)
            {
                if (xmlhttp.status == 200)
                {
                    var getData = xmlhttp.responseText;
                    if (getData == "ok")
                    {
                        document.getElementById("like" + id).innerHTML = "Unlike";
                    }
                    else
                    {
                        document.getElementById("like" + id).innerHTML = "Like";
                    }
                }
            }
        }
        xmlhttp.open("GET", "verify.php?id=" + id, true);
        xmlhttp.send();
    }
    else
    {
        document.getElementById("like" + id).innerHTML = "Could not get XMLHttpRequest";
    }
} 
```***

# android - 通过特定的包名称记录在 android 中发生的事情

> ID：16214883
> 
> 赞同：0
> 
> 时间：2013-04-25T12:32:51.833
> 
> 标签：android, android-logcat

我正在寻找一个重型日志机制的解决方案，以注销例如`ANR`在特定包名处发生时发生的情况。我想要实现的是`LogCat`在手机连接到计算机时记录信息输出。**当电话断开连接并由“普通”用户使用时，是否可以这样做？**

我发现了这篇很棒[的帖子](https://stackoverflow.com/questions/11570458/periodic-logcat-polling-for-updates-and-saving-to-sdcard)，它将一些相关的 logcat 内容输出到 sdcard 上的文本文件中。

我使用命令：`logcat -b main -d -v time`作为字符串参数来对日志进行排序。

`DEBUG`我还通过扩展命令以在 Level( , `VERBOSE`, `ERROR`ETC)之后进行排序找到了一个可能的解决方案。

所以命令看起来像这样：

```
adb -d logcat com.my.package:E *:S 
```

我在这篇[文章](https://stackoverflow.com/questions/6854127/filter-logcat-to-get-only-the-messages-from-my-application-in-android)中找到了这个命令，但它不会将任何内容注销到我的文件中。

**所以我的问题是：**

我怎样才能根据上面的信息将logcat信息逐级注销`ERROR`到手机sdcard上的`.txt`文件中，而无需将手机连接到计算机和eclipse。有可能吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-16T10:33:31.107

经过长时间的反复试验，我找到了解决方案，希望这对其他人有所帮助。要将应用程序特定的日志写入 sd 卡中的文本文件，请使用此命令。

```
"logcat -b main -d -v time ['your package name will go here']". 
```

# google-maps - 如何在安卓中创建谷歌地图

> ID：16214887
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:03.357
> 
> 标签：google-maps

我是android中的新手。我需要创建Google Map。我尝试在**模拟器**中从我的驱动器 中创建Google Map

> android-sdk-windows\add-ons\addon-google_apis-google-16\samples\MapsDemo

1) 我在 libs 文件夹中添加了地图、效果和 usbs jar 文件。
2）我添加了权限

```
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" /> 
```

但是出现错误代码
**错误：**

```
04-25 18:00:00.857: E/AndroidRuntime(2339): FATAL EXCEPTION: main
04-25 18:00:00.857: E/AndroidRuntime(2339): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.androidmap/com.example.androidmap.MainActivity}: android.content.ActivityNotFoundException: Unable to find explicit activity class {com.example.androidmap/com.example.androidmap.MapsDemo}; have you declared this activity in your AndroidManifest.xml?
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.os.Looper.loop(Looper.java:137)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.ActivityThread.main(ActivityThread.java:4745)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at java.lang.reflect.Method.invokeNative(Native Method)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at java.lang.reflect.Method.invoke(Method.java:511)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at dalvik.system.NativeStart.main(Native Method)
04-25 18:00:00.857: E/AndroidRuntime(2339): Caused by: android.content.ActivityNotFoundException: Unable to find explicit activity class {com.example.androidmap/com.example.androidmap.MapsDemo}; have you declared this activity in your AndroidManifest.xml?
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1541)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1416)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Activity.startActivityForResult(Activity.java:3351)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Activity.startActivityForResult(Activity.java:3312)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Activity.startActivity(Activity.java:3522)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Activity.startActivity(Activity.java:3490)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at com.example.androidmap.MainActivity.onCreate(MainActivity.java:14)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Activity.performCreate(Activity.java:5008)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
04-25 18:00:00.857: E/AndroidRuntime(2339):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
04-25 18:00:00.857: E/AndroidRuntime(2339):     ... 11 more 
```

**编辑：**

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.androidmap"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />
   <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" />
    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <uses-library android:name="com.google.android.maps" />
         <activity
            android:name="com.example.androidmap.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity> 
       <activity android:name="com.example.android.apis.MapsDemo" android:label="MapsDemo"/>
       <activity android:name="com.example.android.apis.view.MapViewDemo" android:label="MapView"/>
       <activity android:name="com.example.android.apis.view.MapViewCompassDemo" android:label="MapView and Compass"/>
           </application>
</manifest> 
```

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:57:49.607

您需要使用 MapActivity 扩展 Class 并确保已在 Menifest.xml 文件中声明它或点击此链接以获取帮助 [Google Maps](http://www.vogella.com/articles/AndroidGoogleMaps/article.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:01:38.170

您尚未在清单文件中声明活动 - 添加它们。有关 Google Maps API 的更多信息，请查看[此](http://developer.android.com/google/play-services/maps.html)

# excel - “更新查找”提示框

> ID：16214888
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:05.003
> 
> 标签：excel, vba

我目前有这个简单的代码片段来粘贴一个 vlookup 并引用另一个工作簿中的数组。但是，我一直收到那个烦人的提示，要求我更新查找。我已经明确明确了我想要哪个文件及其位置，为什么它问我以及如何禁用提示并使其自动执行？

非常感谢，

```
Range("F2").Select
ActiveCell.FormulaR1C1 = _
    "=VLOOKUP(RC[-5],'\\Linkstation\rrm\Campaign Creator\Raw Data Generators\RDG\[power Event lookups.xlsx]Sheet1'!R1C1:R10000C2, 2, FALSE)"
Range("F2").AutoFill Destination:=Range("F2:F" & Cells(Rows.Count, 1).End(xlUp).Row) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T14:17:53.957

[http://support.microsoft.com/kb/826921](http://support.microsoft.com/kb/826921)

我相信这就是你要找的。

要在 Excel 2002 或 Excel 2003 中打开工作簿时隐藏消息并自动更新链接，请执行以下步骤：

```
1.On the Tools menu, click Options, and then click the Edit tab. 
2.Click to clear the Ask to update automatic links check box. 
```

若要在 Excel 2007 中打开工作簿时隐藏消息并自动更新链接，请执行以下步骤：

```
1.Click Microsoft Office Button, and then click Excel Options.
2.Click Advanced.
3.Under General, click to clear the Ask to update automatic links check box. 
```

# matlab - 在对非常大的矩阵中的每一行执行操作时，如何避免 MATLAB 中的 for 循环？

> ID：16214891
> 
> 赞同：1
> 
> 时间：2013-04-25T12:33:07.237
> 
> 标签：matlab, matrix, sparse-matrix, adjacency-matrix, bsxfun

我正在使用**MATLAB**。我有*非常大的* **稀疏矩阵**，我想在这个矩阵的每一列上执行一个`logical`或。`bsxfun`有一个循环，其中是填充稀疏矩阵`for`的单个操作。`logical`在这里，我包含了一个带有一些虚假小数据的示例函数，以查看我想要做什么；

```
函数 maskMat()
graph_temp = round(rand(10,10));
抽动；
com_mat = round(rand(10,10));
com = round(rand(10,1));
对于 ii=1：长度（graph_temp）    
    com_mat(:,ii) = 逻辑(com ~= com(ii));
    %bsxfun 也可以，但速度稍慢
    %com_mat(:,ii) = bsxfun(@ne,com,com(ii));
结尾
目录；
com_mat = graph_temp .* com_mat;

```

`graph_temp`并且`com_mat`更大，大约有**1M**`for`行和列，并且代码对循环的执行速度非常慢。[关于 SO 这里](https://stackoverflow.com/q/2307249/410975)还有另一个相关问题，但我还没有理解它背后的理论，看看我是否也可以将这些解决方案应用于这个问题。

我正在考虑编写一个`mex`c++ 函数或尝试进行某种嵌套`arrayfun`，以便将每个`logical`/`bsxfun`操作作为更大函数的子例程调用，以避免 for 循环瓶颈。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T13:01:56.700

我不确定我是否一直遵循您的代码。所以，为了确定，`com_mat(ii,jj)`等于`com(ii) ~= com(jj)`？

如果是这样，请尝试以下选项

```
com_mat = bsxfun( @ne, com, com' ); %' creates entire matrix at once
com_mat = graph_temp .* com_mat;  % do the masking 
```

既然您正在处理稀疏矩阵，为什么不利用它

```
[ii jj] = find( graph_temp );
[m n] = size( graph_temp );
com_mat = sparse( ii, jj, com(ii) ~= com(jj), m, n ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:51:48.977

我会尝试这种方式，但我目前无法访问 Matlab

`arrayfun(@(i) ~isequal(A(:,i),B),1:10,'UniformOutput',false)`

# java - 托管 bean 和缓存视图查找

> ID：16214892
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:10.863
> 
> 标签：java, xpages

从传统的 Notes 开发中，我们了解到在脚本中检索 Domino 对象（如数据库和视图）是无效的，应该避免循环使用。

在 XPages 中，我们不能序列化 Domino 对象，而且我们经常多次检索同一个对象。我们有一个示例，我们正在根据存储在项目相关文档中的项目编号检索项目数据。bean 的作用域`applicationScope`是缓存，结果是缓存的。

```
public class Projects{ 
      private TreeMap<String, Project> projectList; 

      public Projects() { 

      } 

      public Project getProjectInfo(String projNum) { 
              Project project = null; 
              if (projectList==null) { 
                      projectList = new TreeMap<String,Project>(); 
              } 

              if (projectList.containsKey(projNum)) { 
                      project = projectList.get(projNum); 
              } else { 
                      try { 
                              Database projDb = DominoAccess.getDatabase("projects"); 
                              View v = projDb.getView("(projLookup)"); 
                              ViewEntry ve = v.getEntryByKey(projNum); 
                              if (ve != null) { 
                                      project = new Project(ve); 

                                      projectList.put(projNum, project); 
                              } 
                      } catch (Exception e) { 
                      } 
              } 

              return project; 
      } 
} 
```

例如，当它首次用于重复时，将为每个文档创建数据库和视图对象。这是最佳实践还是有更好的方法来解决这个问题？

我知道我们可以在第一次使用时将所有项目放在地图中，但也不确定这是否是关于内存的最佳实践？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T06:38:06.910

当您在重复控件中使用它（例如 30 次）时，您使用 30 倍的 @DBLookup。这似乎效率不高。你可以做什么：使用视图导航器将所有具有 id 和 unid 的项目快速读取到地图中。然后，您无需执行@DBLookup，而是从地图中获取 UNID 并执行 getDocumentByUNID 来加载它。那应该更快。另一种变化 - 如果您的项目数据不是太大：将 JSON 表示保存到字段中并将其放入视图导航器中。这样，您只需要读取一个视图（同样，您有两种顺序读取或搜索它的变体）和一个字段。

让我知道是否需要进一步澄清

# ruby-on-rails-3.2 - ActiveRecord::RecordNotFound（找不到没有 ID 的批次）

> ID：16214893
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:10.900
> 
> 标签：ruby-on-rails-3.2, routes

基本上我有一个下拉菜单，旨在通过调用控制器中的方法来启动部分。部分如下图：

```
<%= form_for :exam_report, :url=>{:action=>'generated_report'} do |z| %>

<%= select_tag :exam_report_batch, 
options_for_select(
Batch.find(:all,:select=>"name,id").collect{|c| [c.name,c.id]}),
:data => { :remote => true, :url => url_for(:controller => "exam", 
                                 :action => "list_exam_types",
                                 :prompt =>"Select a batch")} %>

 <div id="exam-group-select">
 <%= select :exam_report, :exam_group_id, @exam_groups.map{|exam| [exam.name,exam.id]},:prompt=> "#{t('select_exam_group')}" %>
</div>

 <%= z.submit "View", class: "btn btn-large btn-primary" %>

 <% end %> 
```

Exam 控制器中的“list_exam_types”方法如下所示：

```
def list_exam_types
batch = Batch.find(params[:batch_id])
@exam_groups = ExamGroup.find_all_by_batch_id(batch.id)
respond_to do |format|
   format.html
   format.js   
end
end 
```

因此，当我从下拉列表中选择批次时，出现以下错误：**ActiveRecord::RecordNotFound (Couldn't find Batch without an ID): app/controllers/exam_controller.rb:224:in `list_exam_types'**

我的路线如下所示：

```
resources :batches do
resources :exam_groups
resources :additional_exam_groups
resources :elective_groups
end 

resources :exam_groups do
resources :exams do
  member do
    post :save_scores
  end
end
end 
```

我想我的路线很好，所以我不知道为什么 params[:batch_id] 是空的。非常感谢您的帮助，谢谢！

# c# - 如何使用 oAuth 2.0 获取 facebook 访问令牌？

> ID：16214896
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:15.657
> 
> 标签：c#, facebook, facebook-graph-api, oauth-2.0

我想在 c# 中使用 oAuth 2.0 协议获取 Facebook 访问令牌。我有 AppId 和 AppSecret 密钥。我google了很多，发现了很多关于这个的文章。所有文章都描述了使用 asp.net Web 应用程序获取访问令牌。但我不想使用asp.net。我想使用 C# 控制台应用程序来获取它。当我登录我的 facebook 帐户并转到应用程序部分，然后编辑该应用程序的设置时。然后有一个选项可以为该应用程序使用 graphAPI。Graph API 提供访问令牌。但这整个过程需要用户干预并登录 facebook 帐户。我想用 C# 和 oAuth 2.0 自动化整个过程。有什么办法吗？

# javascript - 在 for cicle 的 var 名称中使用 i

> ID：16214898
> 
> 赞同：-2
> 
> 时间：2013-04-25T12:33:29.750
> 
> 标签：javascript, for-loop

这不起作用，但我不知道如何纠正它：

```
for(i=1; i<=3; i++){
    var address_con+[i] = document.getElementById("address_con[i]")
    var CAP_con+[i] = document.getElementById("CAP_con[i]")
    var city_con+[i] = document.getElementById("city_con[i]")
} 
```

它应该产生：

```
//FIRST ELEMENT
address_con1 = document.getElementById("address_con1")
etc.
//LAST ELEMENT
city_con3 = document.getElementById("city_con3") 
```

错误是：

```
var name+[i] 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:34:47.530

在 JavaScript 中没有替换字符串中的变量（与 PHP 不同，这是可能的）。与创建新变量类似，这是您无法做到的，您正在尝试。

要获得您的命名，您可以使用以下代码，该代码会将您的所有值存储在`result`变量中。

```
var result = {};
for(var i=1; i<=3; i++){
    result[ "address_con" + i ] = document.getElementById("address_con" + i)
    result[ "CAP_con" + i ] = document.getElementById("CAP_con" + i)
    result[ "city_con" + i ] = document.getElementById("city_con" + i)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:39:12.017

在 for 循环中检查您的条件

```
for(i=1; i=3; i++) 
```

总会让你脱离循环，我认为你应该尝试以下代码：

```
for(i=1; i<=3; i++) 
```

# perl - Apache 服务器预处理 POST 的 FORM 数据

> ID：16214900
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:31.723
> 
> 标签：perl, apache, cgi

我想显示一个进度条，显示文件上传的实时状态。我有一个解决方案，它涉及从 STDIN 读取 perl，然后我每隔一秒左右对文件进行一次 AJAX 处理，它工作得很好，但现在我的托管服务提供商似乎已经改变了一些东西，它不再工作了。

现在似乎发生的事情是 FORM 提交了完整的数据，然后运行脚本。因此，数据首先被有效地上传，然后脚本对其进行处理。因此，在大上传时，页面似乎挂起 40 秒，然后再“上传”数据 40 秒，同时处理上传的数据（在第二阶段，进度条工作，所以我知道 perl 脚本是实际运行）

但是...如果我将 FORM 的目标设置为一个不存在的文件，它仍然需要 40 秒才能返回 404，这意味着 Apache 所做的第一件事就是接受上传？

我是一名程序员，而不是系统管理员类型，任何建议或意见将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:03:09.473

如果我不得不猜测，听起来您的提供商在您的 Perl Web 应用程序前面设置了一个反向代理。轻量级代理在将请求传递到您的应用程序之前完整地处理文件上传，以防止资源密集型进程等待网络流量。

如果是这种情况，您自己可能无法解决问题。您必须联系您的托管服务提供商，询问是否有解决方法。

# c# - xml：c#winform资源文件中的空格

> ID：16214901
> 
> 赞同：3
> 
> 时间：2013-04-25T12:33:34.853
> 
> 标签：c#, winforms, resx

我有一个 Windows 窗体应用程序，我在`resource file(.resx)`这里写下我所有的错误消息，如下所示

```
 <data name="Link_Name" xml:space="preserve">
    <value>The Link Name must be not blank and not greater than 255 symbols.</value>
  </data> 
```

这里我理解 name 是需要访问的资源的名称，value 是资源的值但是我没有得到什么是`xml:space="preserve"`什么？我还有一个选择`default`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:40:32.347

xml:space="preserve" 使得标签开头的空格不会被删除。（而且如果您将多个空格放在一起）

例子：

```
<data name="Link_Name" xml:space="preserve">
   <value>      The Link Name must be not blank and not greater than 255 symbols.</value>
</data> 
```

现在值将是：

```
"      The Link Name must be not blank and not greater than 255 symbols." 
```

如果 xml:space 未设置：

```
<data name="Link_Name">
   <value>      The Link Name must be not blank and not greater than 255 symbols.</value>
</data> 
```

该值将是：

```
"The Link Name must be not blank and not greater than 255 symbols." 
```

所以 xml:space="preserve" 保留标签开头的空白。

# vb.net - 在基类中使用派生类的shadowed属性

> ID：16214903
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:37.733
> 
> 标签：vb.net, oop, inheritance, shadow

我有两个班，`CustomerService class`和`CellphoneCustomerService`班。`CellphoneCustomerServic`类派生自`CustomerService`类。`CellphoneCustomerService`类隐藏了类的`CustomerRepository`属性`CustomerService`。

```
Public Class CustomerService
        <Microsoft.Practices.Unity.Dependency()> _
        Public Property CustomerRepository as ISQLRepository
            Set (Byval value As SQLRepository)
                _customerRepository = value
            End Set         
            Get 
                Return _customerRepository
            End Get
        End Property

        Public Sub Save(Byval Cust As Customer)
            Me.CustomerRepository.Save(object)
        End Sub

        Public Function GetAllCustomers(Byval Query As String) As Customer
            Me.CustomerRepository.GetAllCustomer(Byval Query As String)
        End Sub

        Public Function GetCustomer(Byval ID As Integer)
            Me.CustomerRepository.GetCustomer(object)
        End Sub             
End Class

Public Class CellphoneCustomerService
    Inherits CustomerService
        <Microsoft.Practices.Unity.Dependency()> _
        Public Shadow Property CustomerRepository As IOracleRepository
            Set (Byval value As OracleRepository)
                _customerRepository = value
            End Set         
            Get 
                Return _customerRepository
            End Get
        End Property            
End Class 
```

这段代码的问题是，当我创建一个`CellphoneCustomerService`类的实例并使用 Save 方法`GetAllCustomers`和`GetCustomer`函数时，它仍然使用`CustomerRepository`基类的属性而不是派生类的阴影`CustomerRepository`属性。

我需要做的是当对象是 a`CellphoneCustomerService`时，基类应该使用该类的 shadowed`CustomerRepository`属性，`CellphoneCustomerService`但如果对象是一个`CustomerService`类，它将使用它自己的`CustomerRepository`属性。

# sql - SQL查询：找出每件比平均价格高的商品，多多少少

> ID：16214906
> 
> 赞同：0
> 
> 时间：2013-04-25T12:33:58.733
> 
> 标签：sql

我正在为数据库考试做一些修改，其中一个问题如下：

给定表格`Items`（列：`itemid`、`description`、`unitcost`），制定一个查询来查找成本高于平均水平的每个项目，以及它的成本比平均水平高多少。

到目前为止我的回答是

```
SELECT itemid, 
       description, 
       unitcost - AVG(unitcost) 
FROM Items 
WHERE unitcost > (SELECT AVG(unitcost) FROM Items) 
```

*   这行得通吗？据我了解，所选列列表中允许使用表达式，但我不确定这是否扩展到使用`AVG()`.
*   有没有更干净、更清晰的方式来表达同样的事情？最好只使用 ISO SQL 结构，因为我的课程是相当理论化的，与任何特定的方言无关。

谢谢朋友 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:45:30.040

应该适用于几乎任何版本的 SQL（接受显式 JOIN 语法）的查询是：

```
SELECT i.itemid, 
       i.description, 
       i.unitcost - a.avg_cost cost_diff
FROM (SELECT AVG(unitcost) avg_cost FROM Items) a
JOIN Items i
ON i.unitcost > a.avg_cost 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T13:17:31.510

在大多数 SQL 方言中，您可以为此使用窗口函数。也就是说，你可以有一个函数的`partition`子句`avg()`：

```
SELECT itemid, 
       description, 
       unitcost - avgcost
FROM (select i.*, avg(unitcost) over () as avgcost
      from Items i
     ) i
WHERE unitcost > avgcost 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T12:56:12.473

只需稍作更改（使用窗口函数），原始查询就可以变成有效的（ANSI SQL）查询：

```
select itemid, 
       description, 
       unitcost - avg(unitcost) over() as delta 
from items 
where unitcost > (select avg(unitcost) from items); 
```

SQLFiddle 示例：[http ://sqlfiddle.com/#!12/cdb33/1](http://sqlfiddle.com/#!12/cdb33/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T12:39:20.833

这应该可行，但我不明白您为什么要尝试减法？

```
SELECT id, 
       title, 
       sort_price,
sort_price - (SELECT AVG(sort_price) as avg FROM item)
FROM item
WHERE sort_price> (SELECT AVG(sort_price) as items FROM item) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T12:40:04.657

子句是 ANSI SQL，因此`WITH`您可以编写如下内容：

```
WITH ap AS
 ( SELECT AVG(unitcost) avguc FROM Items )
SELECT i.itemid
     , i.description
     , (unitcost - a.avguc) avg_uc_diff 
FROM Items
   , ap a 
WHERE unitcost > a.avguc 
```

# jquery-ui - 强制 jQuery UI 对话框显示滚动条

> ID：16214909
> 
> 赞同：0
> 
> 时间：2013-04-25T12:34:04.390
> 
> 标签：jquery-ui, scrollbar, jquery-ui-dialog

我在我的网站上使用 jQuery UI 对话框来显示弹出表单。表单往往比模态框长，因此涉及垂直滚动。

当我用触控板或鼠标滚轮滚动时，垂直滚动条出现在右侧，然后再次淡出。我需要这个滚动条始终可见。

我用谷歌搜索无济于事。知道怎么做吗？

这是HTML：

```
<p class="open-support-form">Click to request support</p>
<div id="support-form" class="dialog" title="Request support">
    <p>Support line: 0800 123 4567</p>
    <p>Email: helpdeskuk@company.com</p>
    <p><a href="#">Screensteps manual</a></p>
    <p>More content</p>

</div> 
```

这是jQuery：

```
// Support form
jQuery( "#support-form" ).dialog({
    autoOpen: false,
    height: 500,
    width: 500,
    modal: true,
    close: function() {
        allFields.val( "" ).removeClass( "ui-state-error" );
    }
});

jQuery( ".open-support-form" )
    .click(function() {
        jQuery( "#support-form" ).dialog( "open" );
    }); 
```

这是我的小提琴：http: [//jsfiddle.net/NK4fM/1/](http://jsfiddle.net/NK4fM/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T13:01:18.010

这实际上是一个 webkit 问题。您可以在此处了解更多信息：[如何防止在 WebKit/Blink 中为 OS X 触控板用户隐藏滚动条？](https://stackoverflow.com/questions/7855590/how-can-i-prevent-scroll-bars-from-being-hidden-for-trackpad-users-in-webkit).

我添加了以下 CSS：

```
.ui-dialog-content::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 11px;
  height: 11px;
}

.ui-dialog-content::-webkit-scrollbar-thumb {
  border-radius: 8px;
  border: 2px solid white; /* should match background, can't be transparent */
  background-color: rgba(0, 0, 0, .5);
} 
```

# ios - 如何在 You Tube 上分享 iPhone 应用程序视频？

> ID：16214914
> 
> 赞同：5
> 
> 时间：2013-04-25T12:34:17.787
> 
> 标签：ios, youtube, gdata-api

我正在通过我的应用在 YouTube 上上传视频。我已经按照这些步骤[http://urinieto.com/2010/10/upload-videos-to-youtube-with-iphone-custom-app/](http://urinieto.com/2010/10/upload-videos-to-youtube-with-iphone-custom-app/)

但是我收到了 19 个在该示例代码中找不到库类的错误。

在 GDataOAuthViewControllerTouch.m 文件中，GDataOAuthAuthentication 类出现错误“预期类型”。这是快照 ![在此处输入图像描述](https://i.stack.imgur.com/ZquL7.png)

我也尝试过这些步骤[http://hoishing.wordpress.com/2011/08/23/gdata-objective-c-client-setup-in-xcode-4/](http://hoishing.wordpress.com/2011/08/23/gdata-objective-c-client-setup-in-xcode-4/)，但如果我使用提供的 gdata 客户端库通过 urinieto 示例代码比也得到错误。

请帮我

# firefox - 无法调用 FirefoxDriver 构造函数

> ID：16214915
> 
> 赞同：6
> 
> 时间：2013-04-25T12:34:18.690
> 
> 标签：firefox, selenium-webdriver

当我运行以下代码时，我不断收到 unsupportedCommandException：

```
System.setProperty("webdriver.firefox.bin","C:\\Program Files\\Mozilla Firefox\\Firefox.exe");
    FirefoxProfile firefoxProfile = new FirefoxProfile();

    String domain = "extensions.firebug.";
    firefoxProfile.setPreference("app.update.enabled", false);
    firefoxProfile.addExtension(new File("D:\\\\firebug-1.11.2-fx.xpi"));
    firefoxProfile.setPreference(domain + "currentVersion", "1.11.2");
    firefoxProfile.setPreference("extensions.firebug.cookies.enableSites", true);
    firefoxProfile.setPreference("extensions.firebug.allPagesActivation", "on");

    firefoxProfile.setPreference(domain + "framePosition", "bottom");
    firefoxProfile.setPreference(domain + "defaultPanelName", "cookies");

    WebDriver driver = new FirefoxDriver(firefoxProfile);
    driver.get("http://www.google.com/webhp?complete=1&hl=en");
    WebElement query = driver.findElement(By.name("q")); 
```

火狐版本：20.0，萤火虫 1.11.2。

我收到的错误消息如下：

```
Exception in thread "main" org.openqa.selenium.UnsupportedCommandException: Bad request

Command duration or timeout: 437 milliseconds
Build info: version: '2.32.0', revision: '6c40c18', time: '2013-04-09 17:23:22'
System info: os.name: 'Windows XP', os.arch: 'x86', os.version: '5.1', java.version: '1.6.0_24'
Driver info: org.openqa.selenium.firefox.FirefoxDriver
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at org.openqa.selenium.remote.ErrorHandler.createThrowable(ErrorHandler.java:187)
    at org.openqa.selenium.remote.ErrorHandler.throwIfResponseFailed(ErrorHandler.java:145)
    at org.openqa.selenium.remote.RemoteWebDriver.execute(RemoteWebDriver.java:554)
    at org.openqa.selenium.remote.RemoteWebDriver.startSession(RemoteWebDriver.java:216)
    at org.openqa.selenium.remote.RemoteWebDriver.<init>(RemoteWebDriver.java:111)
    at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:190)
    at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:183)
    at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:179)
    at org.openqa.selenium.firefox.FirefoxDriver.<init>(FirefoxDriver.java:96)
    at com.vinit.tiwari.TestCookieFirefox.main(TestCookieFirefox.java:48) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-08T15:42:52.693

这可能与您的主机配置有关。

如果你有这样的一行：

`127.0.0.1 domain1 domain2 domain3 localhost`

将其更改为：

`127.0.0.1 localhost domain1 domain2 domain3`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-09T04:33:27.630

根据@APWorsley 接受的答案，此问题可能是由`/etc/hosts`文件中环回适配器的多个别名引起的。

如果您没有方便的访问权限来删除或重新排序别名（可能没有 root 访问权限，或者 Puppet 正在定期重写文件），由于[Selenium 问题 #3280](https://code.google.com/p/selenium/issues/detail?id=3280)现在已修复，因此有一个配置属性访问权限来说明并允许来自主机文件中不同别名的连接。

首先在你的 hosts 文件中收集所有可能的 loopback/localhost/ 别名`127.0.0.1`，然后设置 Firefox Driver 属性。例如，如果您有`localhost`plus `localhost.localdomain`，您可以像这样配置驱动程序：

```
FirefoxProfile profile = new FirefoxProfile();
profile.setPreference(FirefoxProfile.ALLOWED_HOSTS_PREFERENCE, "localhost,localhost.localdomain");
WebDriver driver = new FirefoxDriver(profile); 
```

# opencv - 词袋训练样本

> ID：16214920
> 
> 赞同：3
> 
> 时间：2013-04-25T12:34:21.557
> 
> 标签：opencv, image-processing, computer-vision, svm, object-recognition

我已经实施了 Bag Of Words，一切都很顺利。但是，我对一些步骤以及如何实现它感到困惑。

我可以创建弓形描述符作为词袋中的最后一步来创建样本，如此处所示`bowDE.compute(img, keypoints, bow_descriptor);`.. 事情是我对接下来的步骤感到困惑。

我知道在 BOW 中我必须用非类（可乐）训练和测试一个类（汽车），我在 bow_descriptor 向量中创建的仅用于类汽车，所以我有只属于汽车的样本的向量. 以下是我在训练和测试系统时遇到的问题。

1- 我应该将 bow_descriptor 的向量一半用于 class(cola) ，其余用于 non-class(cola) ，还是我必须为 non-class(cola) 创建一个新的 bow_descriptor ？

2-我需要做多类分类，在完成第一个类（汽车）系统后，我需要训练一个新类（公共汽车+火车等），我应该为每个人创建一个新的训练模型吗, 或者可以和之前的培训一起做培训程序（即培训班BUS，与班车在同一系统中培训）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:15:54.967

是为所有类创建一个对象还是为每个类创建一个对象都没有关系，只要对所有类使用相同的字典即可。只创建一个对象可能更经济。但是提取的图像描述符应该是相同的。

关于多类 SVM：

您使用了 SVM 标签。所以我假设你想使用 SVM。确实存在使用 SVM 显式进行多类分类的方法，更常见的是训练几个二元 SVM 并将它们组合起来以获得多类结果。

您可以使用 1-vs-1 设置，每个类对训练一个 SVM。对于测试，您在每个 SVM 上评估您的测试示例。最常赢得这些决斗的班级将成为您的最终结果。

另一种流行的方法是 1-vs-all SVM。在这里，您为每个类训练一个 SVM，其中当前类的样本被标记为正样本，所有其他样本被标记为负样本。在测试中，得分最高的班级获胜。

因此，如果您想使用 1-vs-1 设置，您可以在添加新类时重用一些二进制 SVM。1-vs-All 设置是不可能的，因为您需要将新类添加到每个 SVM 的负样本中。

# typo3 - 如何在typo3 4.5.25的“生成工作区预览链接”中设置持续时间？这是可能的？

> ID：16214924
> 
> 赞同：2
> 
> 时间：2013-04-25T12:34:27.740
> 
> 标签：typo3

如何在typo3 4.5.25的“生成工作区预览链接”中设置持续时间？这是可能的？默认持续时间是？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-16T08:47:47.150

尝试 UserTSConfig：

```
options.workspaces.previewLinkTTLHours = x (x in hours) 
```

这应该适用于typo3 4.5到6.2

`typo3/sysext/version/cm1`或在(typo3 4.5) 或 (typo3 6.x) 中 搜索 '24 * 2'`typo3/sysext/version/Classes/Hook/PreviewHook.php`查看函数`getPreviewLinkLifetime()`

第三种方式是为单个链接操作`endtime`表中的字段`sys_preview`

# firebreath - 如何在通过firebreath生成的托管Visual C++项目中使用外部dll文件

> ID：16214931
> 
> 赞同：3
> 
> 时间：2013-04-25T12:34:51.647
> 
> 标签：firebreath

我必须在我的 firebreath 项目中使用外部 dll 文件的一些功能。这个项目是托管的 c++ 项目。我想知道如何在我的项目中引用或包含外部文件。我没有在我的 Visual Studio 2010 中获得“添加引用”选项（因为这是一个托管的 C++ 项目）。请告诉我一种方法来做到这一点..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-26T05:58:49.860

假设您知道要在 DLL 中调用的函数的名称，您必须使用的机制如下：

```
// these are examples of functions --> change return values and params as needed
typedef CHAR (WINAPI *DLL_FUNC1) (USHORT, USHORT);
typedef CHAR (WINAPI *DLL_FUNC2) (USHORT, UCHAR*, UCHAR*, USHORT, UCHAR*, USHORT*, UCHAR*);
typedef CHAR (WINAPI *DLL_FUNC3) (USHORT);

// load library
HMODULE hDLL = LoadLibrary( L"\\path\\to\\your.dll" );

// check if dll was loaded 
if (hDLL == NULL) {
    // error 
    return;
}

// assign functions
DLL_FUNC1 func1 = (DLL_FUNC1) GetProcAddress( hDLL, "name_of_func1" );
DLL_FUNC2 func2 = (DLL_FUNC2) GetProcAddress( hDLL, "name_of_func2" );
DLL_FUNC3 func3 = (DLL_FUNC3) GetProcAddress( hDLL, "name_of_func3" );

// use functions --> here func1 as an example
if( func1( 1, 2 ) != OK ) { // or whatever return value
    // error
    FreeLibrary( hDLL ); 
    return;
}

// --> go on working with the DLL functions

// do not forget to call at the end
FreeLibrary( hDLL ); 
```

# ruby-on-rails - Rails MultiJson::LoadError

> ID：16214933
> 
> 赞同：1
> 
> 时间：2013-04-25T12:34:52.710
> 
> 标签：ruby-on-rails, json, ruby-on-rails-3, httparty

我正在尝试获取 json 提要并获取 MultiJson::LoadError

原因是在提要中有一个尾随“，”在最后一个节点之后。

```
{"first_element" : "value", "second_element" : "value",} 
```

有没有办法在没有 LoadError 的情况下输出 json。是否有忽略这一点的原始函数。

我正在使用 httParty 来获取 url

# asp.net - ASP.Net 如何提示用户上传图像并将其存储到数据库中？

> ID：16214941
> 
> 赞同：0
> 
> 时间：2013-04-25T12:35:05.847
> 
> 标签：asp.net, database, image, image-uploading

我有一个用户注册页面，希望通过单击浏览按钮允许用户从本地计算机中选择图像并将其上传到数据库。然后可以检索该图像以供该用户在 ASP.Net 网页上将其显示在他们的姓名旁边。

我以前从未这样做过，也无法在网上找到任何东西。因此，有人可以指导我到一个页面，或者好心地告诉我如何编写选择图像并将其上传到 Access 数据库的过程。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:12:02.267

这个网站有一个如何做到这一点的例子：http: [//www.mikesdotnetting.com/Article/123/Storing-Files-and-Images-in-Access-with-ASP.NET](http://www.mikesdotnetting.com/Article/123/Storing-Files-and-Images-in-Access-with-ASP.NET)

# java - 无法实例化活动 - ClassNotFoundException

> ID：16214945
> 
> 赞同：4
> 
> 时间：2013-04-25T12:35:23.430
> 
> 标签：java, android

我的 android 应用程序抛出 ClassNotFoundException 异常。

这是我在 MainActivity.java 中的代码：

```
 package pl.advancedsoftware.manga;
    public class MainActivity extends FragmentActivity {
    ViewPager viewPager; 
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
        setContentView(R.layout.activity_main);
        Favourites.context= getApplicationContext();
        SectionsPagerAdapter sectionsPagerAdapter = new SectionsPagerAdapter(getSupportFragmentManager());
        viewPager= (ViewPager)findViewById(R.id.pager);
        viewPager.setAdapter(sectionsPagerAdapter); 
    }

    @Override   
    public boolean onCreateOptionsMenu(Menu menu) {
      //  getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

在 AndroidManifest.xml 中：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="pl.advancedsoftware.manga"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" /> 

    <uses-permission android:name="android.permission.INTERNET" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="pl.advancedsoftware.manga.MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="pl.advancedsoftware.manga.BookActivity" 
            android:label="Books" />
        <activity
            android:name="pl.advancedsoftware.manga.EpisodeActivity"
            android:label="Epsiode" />
    </application>

</manifest> 
```

我的例外是：

```
> 04-25 12:28:08.868: E/AndroidRuntime(898): FATAL EXCEPTION: main 04-25
> 12:28:08.868: E/AndroidRuntime(898): java.lang.RuntimeException:
> Unable to instantiate activity
> ComponentInfo{pl.advancedsoftware.manga/pl.advancedsoftware.manga.MainActivity}:
> java.lang.ClassNotFoundException: Didn't find class
> "pl.advancedsoftware.manga.MainActivity" on path:
> /data/app/pl.advancedsoftware.manga-1.apk 04-25 12:28:08.868:
> E/AndroidRuntime(898):    at
> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106)
> 04-25 12:28:08.868: E/AndroidRuntime(898):    at
> android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
> 04-25 12:28:08.868: E/AndroidRuntime(898):    at
> android.app.ActivityThread.access$600(ActivityThread.java:141) 04-25
> 12:28:08.868: E/AndroidRuntime(898):  at
> android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
> 04-25 12:28:08.868: E/AndroidRuntime(898):    at
> android.os.Handler.dispatchMessage(Handler.java:99) 04-25
> 12:28:08.868: E/AndroidRuntime(898):  at
> android.os.Looper.loop(Looper.java:137) 04-25 12:28:08.868:
> E/AndroidRuntime(898):    at
> android.app.ActivityThread.main(ActivityThread.java:5041) 04-25
> 12:28:08.868: E/AndroidRuntime(898):  at
> java.lang.reflect.Method.invokeNative(Native Method) 04-25
> 12:28:08.868: E/AndroidRuntime(898):  at
> java.lang.reflect.Method.invoke(Method.java:511) 04-25 12:28:08.868:
> E/AndroidRuntime(898):    at
> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
> 04-25 12:28:08.868: E/AndroidRuntime(898):    at
> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560) 04-25
> 12:28:08.868: E/AndroidRuntime(898):  at
> dalvik.system.NativeStart.main(Native Method) 04-25 12:28:08.868:
> E/AndroidRuntime(898): Caused by: java.lang.ClassNotFoundException:
> Didn't find class "pl.advancedsoftware.manga.MainActivity" on path:
> /data/app/pl.advancedsoftware.manga-1.apk 04-25 12:28:08.868:
> E/AndroidRuntime(898):    at
> dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:65)
> 04-25 12:28:08.868: E/AndroidRuntime(898):    at
> java.lang.ClassLoader.loadClass(ClassLoader.java:501) 04-25
> 12:28:08.868: E/AndroidRuntime(898):  at
> java.lang.ClassLoader.loadClass(ClassLoader.java:461) 04-25
> 12:28:08.868: E/AndroidRuntime(898):  at
> android.app.Instrumentation.newActivity(Instrumentation.java:1054)
> 04-25 12:28:08.868: E/AndroidRuntime(898):    at
> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
> 04-25 12:28:08.868: E/AndroidRuntime(898):    ... 11 more 
```

我看到路径 /data/app/pl.advancedsoftware.manga-1.apk 可能有问题，但我不知道。我想说这个项目在从存储库克隆它们后停止工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:56:58.217

检查您是继承自`android.support.v4.app.Fragment`而不是`android.app.Fragment`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T14:40:39.343

尝试从您的设备上卸载该应用程序，然后重新构建您的项目。在极少数情况下，重新启动 Eclipse 可能会有所作为。

# ios - 以编程方式在 plist 文件中添加索引

> ID：16214946
> 
> 赞同：0
> 
> 时间：2013-04-25T12:35:33.727
> 
> 标签：ios, xcode, arrays, indexing, plist

我正在以编程方式创建一个直接指向文档目录的 plist 文件。这是我的代码..

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *path = [documentsDirectory stringByAppendingPathComponent:@"myList.plist"];
NSFileManager *fileManager = [NSFileManager defaultManager];

if (![fileManager fileExistsAtPath: path])
{
    path = [documentsDirectory stringByAppendingPathComponent: [NSString stringWithFormat: @"myList.plist"] ];
}
NSMutableArray *data ;
if ([fileManager fileExistsAtPath: path])
{
    data = [[NSMutableArray alloc] initWithContentsOfFile: path];

}
else
{
    // If the file doesn’t exist, create an empty dictionary
    data = [[NSMutableArray alloc] init];
}
data = [[NSMutableArray  alloc] initWithCapacity:5];
[data addObject:value1];
[data addObject:value2];
[data addObject:value3]; 
```

它使用这种格式创建 plist 文件..

```
<array>
        <string>1</string>
        <string>2</string>
        <string>3</string>
</array> 
```

现在，我想向它添加另一个索引，例如，

```
<array>
        <string>1</string>
        <string>2</string>
        <string>3</string>
</array>
<array>
        <string>11</string>
        <string>22</string>
        <string>33</string>
</array> 
```

如何以编程方式在我的 plist 文件中添加索引？
任何帮助或建议将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T12:51:33.783

尝试

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *path = [documentsDirectory stringByAppendingPathComponent:@"myList.plist"];

NSMutableArray *data = [[NSMutableArray alloc] initWithContentsOfFile: path];
if (!data) {
    data = [NSMutableArray array];
}

[data addObject:@[value1,value2,value3]];

[data writeToFile:path atomically:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T12:43:00.373

您应该将您的 plist 组织为字典。对应于每个键，您可以存储数组对象。这很容易。将您的数组存储到 a`NSDictionary`中，并使用适当的键作为索引号。然后把字典放到 plist 上

```
<dict>
  <key>0</key>
  <array>
      <string>1</string>
      <string>2</string>
      <string>3</string>
  </array>
  <key>1</key>
  <array>
      <string>11</string>
      <string>22</string>
      <string>33</string>
  </array>
</dict> 
```

# c# - 在两个页面之间共享通用设计器代码

> ID：16214947
> 
> 赞同：0
> 
> 时间：2013-04-25T12:35:38.423
> 
> 标签：c#, asp.net, inheritance

我正在创建同一页面的两个版本。所以我想创建一个共同的祖先，但我需要从该代码中访问一些控件，所以最好的方法是在共享的 Designer.cs 文件中拥有一组公共控件，但 ASP.Net 将重新创建那些对于每个页面（由于公理化），只要它到达 aspx 文件上具有相同 ID 的 asp 标签。有没有办法做到这一点？

示例（代码看起来很相似）：

common.cs

```
partial class CommonClass [...]
    Function X
        Do something with MyRepeater 
```

common.designer.cs（或其他文件名）

```
partial class CommonClass
    protected global::System.Web.UI.WebControls.Repeater MyRepeater; 
```

page1.cs

```
Page1 : CommonClass 
```

page1.aspx

```
[...]
<asp:Repeater ID="MyRepeater" runat="server" [...] 
```

page2.cs

```
Page2 : CommonClass 
```

page2.aspx

```
[...]
<asp:Repeater ID="MyRepeater" runat="server" [...] 
```

编辑： page1 和 page2 允许用户查看表格并更改其内容（还有其他几个控件）。page1 使用一组对象填充表格。page2 使用一组完全不同的对象填充表格。然而 page1 和 page2 填充数据的方式是相同的（3 个中间表是从一组对象构造的），而且非常复杂。由于它相同（并且非常复杂），我希望填充逻辑位于一个公共文件中，但由于该填充逻辑依赖于一些转发器，因此我也需要在公共页面中定义这些转发器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T14:38:43.183

现在我已经运行了一些新的测试，显然 Asp.Net 足够聪明，不会重新定义它已经在父类中定义的部分设计器类控件。

甜的。它正在工作。

# extjs - 单击文本框时动态显示消息

> ID：16214953
> 
> 赞同：0
> 
> 时间：2013-04-25T12:35:56.557
> 
> 标签：extjs, textbox, extjs4, onclicklistener, keylistener

当单击文本字段/具有任何值以及删除文本字段的内容时，如何动态显示消息，该消息必须消失

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:50:56.613

您可以在文本字段上使用侦听器。我还没有测试过下面的代码，但你可以尝试类似的东西。

```
{
    xtype: 'textfield',
    messageTip: undefined,
    listeners: {
        afterrender: function(text) { //Textfield doesn't have a click even't so use afterrender to put a click event on the element
            //U can use text.inputEl.on({ aswell to only get the input element and not the label
            text.getEl().on({
                click: function() {
                     //Create tip here
                     text.messageTip = Ext.create('Ext.tip.Tip', {
                         //Configuration
                     }).show();
                }
            });
        },
        keypress: function(text) {
            if (text.getValue() == '') {
                //hide the message
                text.messageTip.hide()
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T18:45:33.710

您可以在文本字段上使用“更改”侦听器：

```
{
    xtype: 'textfield',
    listeners : {
        change: function(field, newValue, oldValue, options)) {
                   if(newvalue!=''){
                       Message=Ext.create('Ext.tip.ToolTip', {
                       closable:true,
                       hideDelay : 3000,
                       padding: '0 0 0 0',
                       maxWidth:400,
                       width:800,
                       html: ".......",
                      }).showAt([x, y]); 
                        }
                  else Message.hide();
                    }
                }
} 
```

# c# - C# 应用程序可以使用多少 RAM？

> ID：16214954
> 
> 赞同：4
> 
> 时间：2013-04-25T12:35:58.987
> 
> 标签：c#, memory

我有非常大的 DataTable 对象、非常大的数组等的应用程序。

目前我的内存使用量低于 2GB。

当我的应用程序在 32 位系统上生成 4 个大小为 1GB 的数组时会发生什么？

它会崩溃吗？

我知道 CLR 中的 2GB 对象大小限制，但是很多大对象呢？

我试图测试它，我声明了几个大数组，但是当它们为空时，它们似乎不使用 RAM。我没有尝试填写它们，我决定在这里问。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T12:44:43.940

64 位应用程序，包括托管应用程序，可以访问大内存。

32 位应用程序具有最大 4GB 的虚拟地址空间。在实践中，他们默认获得 2GB。[`/LARGEADRESSAWARE`](http://msdn.microsoft.com/en-us/library/wz223b1z%28v=vs.80%29.aspx)应用程序可以通过 boot.ini 中的 /3gb 获得 3GB 或在 WoW64 上运行时获得 4GB。

托管应用程序，即使在 x64 上也无法分配任何大于 2GB 的单个对象。包括数组。

但无论您可以使用多少 VA：操作一个 +2GB 的[DataTable](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)对象是行不通的。使用能够快速处理和操作大量数据并能够智能分页的存储引擎。[Redis](http://redis.io/)、[Cassandra](http://cassandra.apache.org/)甚至传统的 RDBMS 更适合这项工作。

即使*您*决定直接在内存中操作数据，您也需要一种比`DataTable`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T12:39:18.693

所有 32 位应用程序都限制为[2GB 内存](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366778%28v=vs.85%29.aspx)*。因此，无论您如何分配 RAM，您都将用完 2GB。

如果你需要更多，你需要在 64 位系统上运行它并为 64 位编译它。

*   使用[LARGEADDRESSAWARE](http://msdn.microsoft.com/en-us/library/wz223b1z.aspx) 32 位应用程序最多可以使用 3GB 内存，感谢 Marc Gravell 在评论中提醒我这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T12:41:02.890

如果您使用的 RAM 超出了您可以处理（或拥有）的数量，则会出现`System.OutOfMemoryException`异常。试试这段代码看看：

```
 List<byte[]> foo = new List<byte[]>();
        for (int i = 0; i < 10000; ++i )
            foo.Add(new byte[1024*1024*1024]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T12:42:22.340

是的，它会崩溃。这是我尝试过的示例代码：

```
class Program
{
    static byte[] arr = new byte[1024 * 1024 * 1024];
    static byte[] arr2 = new byte[1024 * 1024 * 1024];
    static byte[] arr3 = new byte[1024 * 1024 * 1024];
    static byte[] arr4 = new byte[1024 * 1024 * 1024];
    static void Main(string[] args)
    {            
        Console.ReadKey();
    }
} 
```

这是一个相当原始的测试程序。*除非可以立即*访问全部数据量，否则它可能已经被 GC 部分回收，因此不会崩溃。

您也可以将它们设为*本地*。但是，如果您进行**发布构建**（带有代码优化），则以下位*就像一个 charm*，因为未使用的数组（或通常的变量）可能会被优化掉：

```
static void Main(string[] args)
{
    byte[] arr = new byte[1024 * 1024 * 1024];
    byte[] arr2 = new byte[1024 * 1024 * 1024];
    byte[] arr3 = new byte[1024 * 1024 * 1024];
    byte[] arr4 = new byte[1024 * 1024 * 1024];
    Console.ReadKey();
} 
```

在**调试构建**（无代码优化）中，上述位也崩溃了`OutOfMemoryException`。

与之相反的领域当然不能被遗漏。因此，无论编译器是否优化了代码，第一个示例都会崩溃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T12:49:54.003

有关不同操作系统的物理内存限制，请参阅这篇文章[Windows 版本的内存限制](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366778%28v=vs.85%29.aspx)。

但是，可以将运行为 32 位的 .NET 应用程序的限制从 2GB 增加到最高 3GB。为此，您必须`editbin /LARGEADDRESSAWARE`在可执行文件上运行。您可以在此处找到有关它的更多详细信息：

*   [如何创建（32 位）.NET 应用程序以使用 3 GB RAM？](https://stackoverflow.com/questions/464458/how-do-i-create-a-32-bit-net-application-to-use-3-gb-ram)
*   [增加内存限制](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/c50ea343-b41b-467d-a457-c5a735e4dfff/)

# c# - 在文件上传中禁用 jquery 中的提交按钮后控制器操作未触发

> ID：16214969
> 
> 赞同：1
> 
> 时间：2013-04-25T12:36:41.480
> 
> 标签：c#, asp.net-mvc, jquery

我在 filepload 控件后有上传按钮，但在禁用按钮后，我的控制器中的操作方法没有被调用。请找到以下代码：在 JQUERY 中：

```
 $(document).ready(function () {
            $("input[type=submit]").removeAttr("disabled");
            $("#btnUpload").click(function () {

               $('#progressbardiv').show();
               $("input[type=submit]").attr("disabled", "disabled");

            });
        }); 
```

在控制器中的操作：

```
/// <summary>
        /// Action on Upload button click
        /// </summary>
        /// <returns>ActionResult</returns>
        [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult Upload(HttpPostedFileBase fileUpload)
        {     
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:40:01.503

`disabled`元素**不会触发事件**。您必须重新启用它才能触发提交。

# mysql - 用like进行子查询

> ID：16214970
> 
> 赞同：0
> 
> 时间：2013-04-25T12:36:42.387
> 
> 标签：mysql, subquery

我有以下两张表。如何查询表 B variant_id 在表 A 组合中匹配的位置？

```
TableA
product_id  combination     ean
1           952_4038        123456789
2           946_3989        101010101

TableB
variant_id  desc
4038        text1
3989        text2 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:38:37.660

```
SELECT  a.*, b.*
FROM    TableA a
        INNER JOIN TableB b
            ON a.combination LIKE CONCAT('%', b.variant_ID) 
```

这个查询在大型数据库上非常慢。考虑正确规范您的表格。

我建议的表架构：

表A

*   产品编号 (1)
*   整数列 (952)
*   组合 (4038)
*   伊恩 (123456789)

表B

*   组合 (4038)
*   DescColumn (text) [*不要使用保留关键字*]

确保在链接字段上有索引。

* * *

*后续问题：哪个表是主表和从属表？*

# mpeg - MPEG2 TS 端到端延迟

> ID：16214975
> 
> 赞同：0
> 
> 时间：2013-04-25T12:37:06.183
> 
> 标签：mpeg

我需要根据时间戳信息（PTS PCR DTS）计算 MPEG 2 TS 中的端到端延迟（编码器和解码器之间）。这些时间戳是否足以计算延迟？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T11:10:19.200

这些时间戳由编码器插入到传输流中，并由解码器使用 - 例如在音频和视频帧之间同步，并且通常与原始时钟锁定以正确显示视频。

另一方面，编码器和解码器之间的延迟就像询问从源传输数据到在目的地接收数据之间的延迟是多少。这不是由数据（即传输流和时间戳等数据）决定的，而是由网络条件决定的。

# arrays - 如何在cakephp中对数组日期进行明智的排序

> ID：16214980
> 
> 赞同：1
> 
> 时间：2013-04-25T12:37:36.510
> 
> 标签：arrays, cakephp, cakephp-2.0

我有 2 张桌子预订和消息，现在我想一次在收件箱中显示预订请求和消息。

```
$this->paginate = array(
            'conditions' => $conditions,'limit' =>10,
        'order'=>array('Booking.created'=>'DESC'));
    $bookings = $this->paginate('Booking');

    $this->paginate = array(
            'conditions' => $conditions,'limit' =>10,
        'order'=>array('MessageDetail.created'=>'DESC'));
    $messages = $this->paginate('MessageDetail'); 
```

我已经合并了两个表数据（ array_merge($bookings, $messages); ）现在我想按日期排序（或任何条件）

```
Array
(
[0] => Array
    (
        [Booking] => Array
            (
                [id] => 4
                [host_id] => 21
                [place_id] => 10
                [room_id] => 13
                [user_id] => 12
                [message_detail_id] => 16
                [created] => 2013-04-23 14:44:03
                [accept_date] => 
                [cancel_date] => 
            )

    )

[1] => Array
    (
        [Booking] => Array
            (
                [id] => 3
                [host_id] => 21
                [place_id] => 10
                [room_id] => 13
                [user_id] => 12
                [message_detail_id] => 13
                [created] => 2013-04-15 14:10:59
                [accept_date] => 2013-04-15 14:40:47
                [cancel_date] => 
            )

    )

[2] => Array
    (
        [MessageDetail] => Array
            (
                [id] => 17
                [message_id] => 2
                [user_id] => 12
                [sender_id] => 21
                [unread] => 0
                [created] => 2013-04-24 12:11:47
            )

    )

[3] => Array
    (
        [MessageDetail] => Array
            (
                [id] => 15
                [message_id] => 2
                [user_id] => 12
                [sender_id] => 21
                [booking_id] => 3
                [unread] => 0
                [created] => 2013-04-15 15:01:12
            )

    )

  ) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-24T19:25:25.627

**选项 #1：** 创建名为“BookingAndMessage”的第三个模型。您可以使用模型的[afterSave](http://book.cakephp.org/2.0/en/models/callback-methods.html#aftersave)方法（在预订和消息上）在新模型中创建重复记录。然后，您可以按正确的排序顺序查询 BookingAndMessage。

**选项#2**：要解决这个问题，就目前而言，您将需要使用 PHP 的[usort](http://php.net/manual/en/function.usort.php)函数（这里也解释了[PHP 按包含 date 的元素对多维数组进行排序](https://stackoverflow.com/questions/2910611/php-sort-a-multidimensional-array-by-element-containing-date)）。

```
<?php

$BookingsAndMessages = array_merge($bookings, $messages);

function date_compare($a, $b)
{   
   $modelKeyA = array_key_exists('Booking',$a) ? 'Booking' : 'MessageDetail';
   $modelKeyB = array_key_exists('Booking',$b) ? 'Booking' : 'MessageDetail';
   $t1 = strtotime($a[$modelKeyA]['created']);
   $t2 = strtotime($b[$modelKeyB]['created']);
   return $t1 - $t2;
}

usort($BookingsAndMessages, 'date_compare');
// Would sort the merged records by `created` date
?> 
```

选项 2 的缺点是，您必须为每个字段（和排序方向）创建规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-26T15:17:24.927

也许您应该`Union`首先查询，`Order`.

```
$bookings = $this->Bookings->find('all', [
        'conditions' => $conditions,'limit' =>10,
]);

$messages = $this->find('all', [
        'conditions' => $conditions,'limit' =>10
]);

$data = $bookings->union($messages);
// This works if your first selected field is the one you want to sort. 
$data->epilog('ORDER BY 1 ASC'); 
```

参考： [如何在 CakePHP 3 中修改 UNION 查询？](https://stackoverflow.com/questions/29379579/how-do-you-modify-a-union-query-in-cakephp-3/29386189#29386189)

# c++ - C++/Linux - 绘制到窗口

> ID：16214987
> 
> 赞同：2
> 
> 时间：2013-04-25T12:37:57.267
> 
> 标签：c++, linux, drawing, conways-game-of-life

我正在上一个面向对象的编程课，我们刚刚做了一个项目，我们必须实现[康威的生命游戏](http://www.conwaylife.com/wiki/Main_Page)。项目规范只是向终端输出文本行，显示单元格的演变，但它是不是很漂亮。我认为修改程序会很有趣，所以不是将文本行发送到终端，而是使用我们单元格的当前状态更新绘图窗口。我不想深入研究图形...我可以使用原始项目指定的单元格的文本表示。正如这个问题的标题所暗示的那样，该程序是用 C++ 编写的，并且可以在 Linux 机器上运行。对我来说最简单的方法是什么做到这一点。

编辑：好的，所以我认为我非常接近。问题是没有出现换行符。在我的 Life "toString" 运算符中，我尝试过`endl`and `\n`，但似乎都不起作用。这是代码...

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <X11/Xlib.h>
#include <sstream>

#include "Cell.h"
#include "Life.h"

int main (int argc, char *argv[])
{
    Display                 *display;
    Visual                  *visual;
    int                     depth;
    int                     text_x;
    int                     text_y;
    XSetWindowAttributes    frame_attributes;
    Window                  frame_window;
    XFontStruct             *fontinfo;
    XGCValues               gr_values;
    GC                      graphical_context;
    XEvent                  event;
    char                    hello_string[] = "Hello World";
    int                     hello_string_length = strlen(hello_string);

    display = XOpenDisplay(NULL);
    visual = DefaultVisual(display, 0);
    depth  = DefaultDepth(display, 0);

    frame_attributes.background_pixel = XWhitePixel(display, 0);
    /* create the application window */
    frame_window = XCreateWindow(display, XRootWindow(display, 0),
                                 0, 0, 400, 400, 5, depth,
                                 InputOutput, visual, CWBackPixel,
                                 &frame_attributes);
    XStoreName(display, frame_window, "The Game of Life");
    XSelectInput(display, frame_window, ExposureMask | StructureNotifyMask);

    fontinfo = XLoadQueryFont(display, "10x20");
    gr_values.font = fontinfo->fid;
    gr_values.foreground = XBlackPixel(display, 0);
    graphical_context = XCreateGC(display, frame_window, 
                                  GCFont+GCForeground, &gr_values);
    XMapWindow(display, frame_window);

    Life <ConwayCell> aLife (21, 21);

    aLife.animate (10, 5, '*');
    aLife.animate (10, 6, '*');
    aLife.animate (10, 7, '*');
    aLife.animate (10, 8, '*');
    aLife.animate (10, 9, '*');
    aLife.animate (10, 10, '*');
    aLife.animate (10, 11, '*');
    aLife.animate (10, 12, '*');
    aLife.animate (10, 13, '*');
    aLife.animate (10, 14, '*');

    std::ostringstream outStream;
    outStream << aLife;
    string aString = outStream.str ();
    const char* aChar = aString.c_str ();
    int len = outStream.str ().size ();

    while ( 1 ) {
        XNextEvent(display, (XEvent *)&event);
        switch ( event.type ) {
            case Expose:
            {
                XWindowAttributes window_attributes;
                int font_direction, font_ascent, font_descent;
                XCharStruct text_structure;
                XTextExtents(fontinfo, aChar, len, 
                             &font_direction, &font_ascent, &font_descent, 
                             &text_structure);
                XGetWindowAttributes(display, frame_window, &window_attributes);
                text_x = (window_attributes.width - text_structure.width)/2;
                text_y = (window_attributes.height - 
                          (text_structure.ascent+text_structure.descent))/2;

                outStream << aLife;

                XDrawString(display, frame_window, graphical_context,
                            text_x, text_y, aChar, len);
                break;
            }
            default:
                break;
        }
    }
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T12:42:45.903

我会给[SFML](http://www.sfml-dev.org/)一个机会。如果它不适合您的需求，请参阅[此链接](https://stackoverflow.com/questions/671395/a-simple-2d-cross-platform-graphics-library-for-c-or-c)以获取更多建议。

# php - Facebook CurlException 3 没有设置 URL

> ID：16214993
> 
> 赞同：0
> 
> 时间：2013-04-25T12:38:06.613
> 
> 标签：php, facebook-graph-api, curl, facebook-php-sdk

我正进入（状态

FacebookApiException 对象 (

[结果：受保护] => 数组

( [error_code] => 3 [error] => 数组 ( [message] => 没有设置 URL！[type] => CurlException )

```
 )

[message:protected] => No URL set!
[string:private] => 
[code:protected] => 3
[file:protected] => /home5/theteci0/public_html/team/fb6/base_facebook.php
[line:protected] => 979
[trace:private] => Array
    (
        [0] => Array
            (
                [file] => /home5/theteci0/public_html/team/fb6/base_facebook.php
                [line] => 911
                [function] => makeRequest
                [class] => BaseFacebook
                [type] => ->
                [args] => Array
                    (
                        [0] => https://graph.facebook.com/172535322883581_253291878141258
                        [1] => Array
                            (
                                [fields] => updated_time
                                [method] => GET
                                [access_token] => /*Acc_tkn*/
                            )

                    )

            )

        [1] => Array
            (
                [file] => /home5/theteci0/public_html/team/fb6/base_facebook.php
                [line] => 878
                [function] => _oauthRequest
                [class] => BaseFacebook
                [type] => ->
                [args] => Array
                    (
                        [0] => https://graph.facebook.com/172535322883581_253291878141258
                        [1] => Array
                            (
                                [fields] => updated_time
                                [method] => GET
                            )

                    )

            )

        [2] => Array
            (
                [file] => /home5/theteci0/public_html/team/fb6/base_facebook.php
                [line] => 656
                [function] => _graph
                [class] => BaseFacebook
                [type] => ->
                [args] => Array
                    (
                        [0] => /172535322883581_253291878141258
                        [1] => GET
                        [2] => Array
                            (
                                [fields] => updated_time
                            )

                    )

            )

        [3] => Array
            (
                [file] => /home5/theteci0/public_html/team/user/comments.php
                [line] => 71
                [function] => api
                [class] => BaseFacebook
                [type] => ->
                [args] => Array
                    (
                        [0] => Array
                            (
                                [0] => Facebook Object
                                    (
                                        [appId:protected] => 
                                        [appSecret:protected] => 
                                        [user:protected] => 
                                        [signedRequest:protected] => 
                                        [state:protected] => 
                                        [accessToken:protected] => /*Acc_tkn*/
                                        [fileUploadSupport:protected] => 
                                        [trustForwarded:protected] => 
                                    )

                                [1] => _graph
                            )

                        [1] => Array
                            (
                                [0] => /172535322883581_253291878141258
                                [1] => GET
                                [2] => Array
                                    (
                                        [fields] => updated_time
                                    )

                            )

                    )

            )

    )

) 
```

我经常遇到这个错误，如何预防或解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-25T18:49:58.570

by problems with IPV6 you should have included the following line in your facebook api.

```
Facebook::$CURL_OPTS[CURLOPT_IPRESOLVE] = CURL_IPRESOLVE_V4; 
```

however this alternative only works with version 5.3 of php largest and Curl version > 7.10.8

solution:

```
if((phpversion()>= 5.3)){ Facebook::$CURL_OPTS[CURLOPT_IPRESOLVE] = CURL_IPRESOLVE_V4; } 
```

# c# - 在 ASP.Net (C#) 中，HTML 表没有 'COLUMN' 属性，怎么办？

> ID：16214996
> 
> 赞同：3
> 
> 时间：2013-04-25T12:38:08.180
> 
> 标签：c#, asp.net

基本上我在 C# 中将 HTML 表导出为 CSV 导出，所以需要计算所有 ROWS 和 COLUMNS

我可以通过 Table1.Rows.Count 获得行数，但无法通过 Table1.Columns.Count 获得列数。

任何想法如何获得列数？

```
 StringBuilder sb = new StringBuilder();
     for (int i = 0; i < Table1.Rows.Count; i++)
     {
      for (int k = 0; k < **Table1.Column.Count**; k++)
       {
              //adding separator
              sb.Append(Table1.Rows[i].Cells[k].Text + ',');
        }
          //appending new line
            sb.Append("\r\n");
     } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T12:40:28.603

为什么不能用`Table1.Rows[i].Cells.Count`？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-25T12:40:36.377

`Tables.Rows[i].Cells.Count`会给你一行中的单元格总数。这就像列，但可能会改变单元格（列）跨度不同的地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-25T12:42:45.903

在这里，您有一个我认为更具可读性的替代方案

```
StringBuilder sb = new StringBuilder();
foreach(TableRow row in Table1.Rows)
{
    foreach (TableCell cell in row.Cells)
    {
          //adding separator
          sb.Append(cell.Text + ',');
    }
    //appending new line
    sb.Append("\r\n");
} 
```