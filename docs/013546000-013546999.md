# StackOverflow 问答 13546000-13546999

# ios - Facebook-ios-sdk 发布到粉丝页面成功但未出现在页面上

> ID：13546003
> 
> 赞同：3
> 
> 时间：2012-11-24T21:54:18.003
> 
> 标签：ios, facebook, facebook-graph-api

我正在将 Facebook-ios-sdk 3.1 集成到 iOS 5.1 下的 iPad 应用程序中。我的目标非常典型：允许用户在 Facebook 粉丝页面上发布消息/照片/视频/链接。但是，我遇到了这个奇怪的问题，在阅读了 Stack Overflow 上的许多问题/答案后，我仍然无法弄清楚出了什么问题。这是发生了什么：

我正在使用以下代码使用图形 API 将纯文本消息发布到粉丝页面：

```
[FBRequestConnection
 startWithGraphPath:@"fan_page/feed"
 parameters:postParams
 HTTPMethod:@"POST"
 completionHandler:^(FBRequestConnection *connection,
                     id result,
                     NSError *error) {
     // Valid object ID of post is returned here...
 }]; 
```

我在模拟器上对此进行了测试，一切正常。但是，当我在 iPad 设备上尝试此代码时，问题发生了：上述方法似乎是成功的，因为它返回了一个有效的 Facebook 对象 ID。我什至通过[访问 http://www.facebook.com/](http://www.facebook.com/) {page_id}/posts/{objectID} 验证了它是有效 ID，并确保它是正确的帖子。但是，如果我去 Facebook 粉丝页面或查看粉丝页面提要，我的帖子根本不存在！[除了由http://www.facebook.com/](http://www.facebook.com/) {page_id}/posts/{objectID}引用之外，该帖子不会出现在任何地方。

这里还有一些让我非常困惑的数据点：

*   此问题仅出现在真实设备上。在模拟器上，它工作正常。通过模拟器发布的帖子按预期出现在粉丝页面和提要上。
*   此问题仅发生在纯文本消息中。如果我在“postParams”中添加其他键，例如链接/图片/源，使其类型为“链接”/“视频”/“照片”而不是“状态”，那么帖子会按预期显示粉丝页面和提要。

我不确定发生了什么。设备和模拟器有什么区别？为什么只有纯文本消息有这个问题？我什至怀疑 Facebook 可能会过滤一些帖子，因为它怀疑它们是来自移动应用程序的某种垃圾邮件......

任何想法和见解在这里都有帮助。非常感谢！

# java - 如何每 10 秒更新一次 GPS 位置？

> ID：13546009
> 
> 赞同：0
> 
> 时间：2012-11-24T21:54:42.013
> 
> 标签：java, android, updates

我有这些变量，并且在 onResume 方法中有以下调用：

```
 private Location userLocation;
  private GeoPoint point;
  private LocationManager manager;
  private LocationListener listener = new LocationListenerC();

    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 10000, 25, locationListener); 
```

但是当我在 android 模拟器中运行这个应用程序时，用户的位置不是每 10 秒更新一次。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:26:41.837

该参数`mindTime`并不意味着您将**每** `minTime`毫秒接收一次更新。这意味着您不会经常收到少于`minTime`毫秒的更新，但没有指定**何时**收到它们。如果`LocationManager`没有新的位置可以每 10 秒给你一次，它根本不会给。只有在有新位置时，您才会收到更新。

你也在用`minDistance`。`25`意味着除非设备移动了至少 25 米，否则您将不会收到新的更新。模拟器不移动，所以将此参数设置为`0`（这意味着更新不依赖于用户是否移动）。

更新率很大程度上取决于用户的位置。例如，如果用户在建筑物内，则 GPS/网络提供商可能需要一段时间才能从卫星/基站接收更新。因此，您可能会以更长的时间间隔获得更新。但是，如果用户在外面且设备信号良好，则更新可能会变得非常频繁（但每 10 秒只会获得 1 次）

如果您想每 10 秒获取一次位置，则可以`getLastKnownLocation`每 10 秒调用一次。但是，如果没有发生来自提供商的更新，则位置可能相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:19:43.810

我认为，条件必须是，时间是 10（最小）秒，距离是 25（最小）米。

参考：http:
[//developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates%28java.lang.String,%20long,%20float,%20android.location.LocationListener%29](http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates%28java.lang.String,%20long,%20float,%20android.location.LocationListener%29)

minDistance 参数还可用于控制位置更新的频率。如果它大于 0，那么位置提供程序将仅在位置已更改至少 minDistance 米并且至少 minTime 毫秒已过去时向您的应用程序发送更新。然而，位置提供者使用 minDistance 参数来节省电量更加困难，因此 minTime 应该是节省电池寿命的主要工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:15:01.363

执行以下操作，如下所示

```
 private Location userLocation;
   private GeoPoint point;
   private LocationManager manager;
   private LocationListener listener = new LocationListenerC();

    //Change **locationManager** to **manager** 
    // and **locationListener** to **listener**  in the follwing line
   manager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 10000, 25, listener); 
```

# c# - 从列表框 C# 的列表中显示对象的特定属性

> ID：13546016
> 
> 赞同：3
> 
> 时间：2012-11-24T21:55:02.107
> 
> 标签：c#, winforms, list, listbox

我正在创建一个表单，用户可以在其中插入产品的名称、品牌和价格。这三个被保存为对象列表中对象的属性，如下所示：

```
private void button1_Click(object sender, EventArgs e)
{
   Product prod = new Product();
   string kind = textBox1.Text;
   prod.Kind = kind;
   string brand = textBox2.Text;
   prod.Brand = brand;
   double price = Convert.ToDouble(textBox3.Text);
   prod.Price = price;

   listofthings.Add(prod);
} 
```

我现在要做的是添加一个列表框，其中显示每个对象的属性“种类”，以便用户可以选择要购买的特定产品。

我试过了

```
listBox2.DataSource = listofthings.prod.Kind; 
```

但它不允许。有点帮助，好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T21:57:48.600

将列表框绑定到您的对象，并将属性设置[`DisplayMember`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listcontrol.displaymember.aspx)为要在列表框中显示的绑定对象属性的名称：

```
listBox2.DataSource = listofthings;
listBox2.DisplayMember = "Kind"; 
```

# javascript - 如何制作 YouTube 无铬播放器？

> ID：13546027
> 
> 赞同：3
> 
> 时间：2012-11-24T21:56:49.657
> 
> 标签：javascript, youtube, youtube-api, youtube-javascript-api

这听起来可能很愚蠢，但我在网上看了一段时间，但找不到如何让 YouTube 播放器无铬。我正在制作一个网络应用程序，并且正在使用 YouTube JavaScript API。无论我在网上查找有关如何真正使播放器无铬的一些信息，它都只是为我提供了有关如何使用无铬播放器进行操作的信息。没有人解决这个问题（这似乎很明显），但我就是不知道该怎么做。有人可以向我解释怎么做（我需要在某处传递某个参数吗？）谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T19:35:10.350

好吧，所以我想通了。因此，如果您像我一样使用 JavaScript（我相信它也适用于 AS3），只需编写“apiplayer”，而不是在 URL（您提供给 embedswf() 函数的那个​​）中写入视频 ID。然后，在视频播放器加载后，只需调用它的函数 cueVideo() （将要显示的视频的视频 ID 传递给它）。这将使视频播放器无铬。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-30T20:06:19.063

那么首先你会HTML代码

```
<embed src=""/> 
```

现在这需要网址： [http ://www.youtube.com/apiplayer?enablejsapi=1&version=3](http://www.youtube.com/apiplayer?enablejsapi=1&version=3)

这个没有ID，因为你在JS中给它一个ID

```
onYouTubePlayerReady() 
```

这是一个小例子

```
<script>
onYouTubePlayerReady = initializePlayer;
function initializePlayer(){
var video = document.getElementById('video');
video.loadVideoById(String id , int starttime , string quality);
var playbutton = document.getElementById('playbtn');
playbutton.addEventListener('click' , playVideo());
var pausebutton = document.getElementById('psbtn');
pausebutton.addEventListener('click' , pauseVideo());
}
</script> 
```

这是基本脚本，希望这有效！

# ruby-on-rails - rails select方法迭代数组

> ID：13546028
> 
> 赞同：0
> 
> 时间：2012-11-24T21:57:02.297
> 
> 标签：ruby-on-rails, ruby, arrays, iteration

我是 ruby​​ 和 rails 的新手，在我的学习中，我创建了我的 Order 的 Payment Types 数组。

```
class Order < ActiveRecord::Base

  PAYMENT_TYPES = [{:id => "check", :name => "Check"}, {:id => "credit_card", :name => "Credit card"}, {:id => "purchase_order", :name => "Purchase order"}] 
```

我想用这种方式

```
<%= f.select :pay_type, Order::PAYMENT_TYPES.each {|order| [order.name, order.id]}, :prompt => 'Select a payment method' %> 
```

但我收到了这个错误

```
undefined method `name' for {:id=>"check", :name=>"Check"}:Hash 
```

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:11:22.283

在您的块中，每次都用哈希填充`each`变量。`order`因此，您需要像哈希一样使用`order[:name]`and`order[:id]`而不是`.name`and来访问它`.id`。

**编辑**

此外，为了可维护性，您可能希望创建一个单独的 PaymentType 模型。这会给你更多的力量和灵活性。使用您当前的方法，如果您想稍后添加或删除付款类型会怎样？您必须编辑源代码。如果您只希望某些付款方式可用于某些交易怎么办？

# css - 如何强制内容使用滚动条水平流动，而不是通常的垂直方式

> ID：13546029
> 
> 赞同：0
> 
> 时间：2012-11-24T21:57:06.143
> 
> 标签：css

我只水平显示内容，因此当更多内容加载到视图中时，我需要动态更改宽度以适应让滚动条处理滚动。所以现在下面的这段代码只会占用最多 4500 像素的内容，之后它会尝试换行而不是水平继续。关于如何做到这一点的任何想法？

```
.container-scroll {
    width: 4500px;
    min-width: 3000px; 
    overflow-x:scroll;   
    position: relative;
    min-height: 100%;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:03:09.593

不要在容器上指定宽度。确保里面的元素是`display: inline`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:03:58.633

你需要这个 CSS：

```
.container-scroll {
    width: auto;
    min-width: 100px; 
    overflow-x:scroll;   
    position: relative;
    min-height: 100%;
}​ 
```

只需指定所需的最小宽度，滚动将处理其余部分。

# javascript - 带有公交路线的 Google 地图无法在本地加载

> ID：13546033
> 
> 赞同：0
> 
> 时间：2012-11-24T21:57:45.460
> 
> 标签：javascript, google-maps

我在网站的联系页面上需要一个像这样的页面

[http://gmaps-samples-v3.googlecode.com/svn/trunk/transit/transit.html](http://gmaps-samples-v3.googlecode.com/svn/trunk/transit/transit.html)

我想我只是查看源代码并将其复制到我的编辑器中，以便我可以使用 api 并对其进行自定义。我在新文件中 c/p 源代码，但页面（地图和公共交通数据）不会在浏览器中加载。

也许我错过了一块js？我不这么认为，因为只有一个，而且它托管在 Google 上。那么有什么想法为什么这在本地不起作用？

这是源代码，我没有编辑。

```
<!DOCTYPE html>
<html>

    <head>
            <title>Google Maps JavaScript API v3 Example: Transit</title>
            <script src="//maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>
            <style type="text/css">
            html, body {
                    height: 100%;
                    padding: 0;
                    margin: 0;
                    color: black;
                    font-family: arial, sans-serif;
                    font-size: 13px;
            }
            #map {
                    position: absolute;
                    top: 0;
                    bottom: 0;
                    left: 0;
                    right: 50%;
            }
            #panel-wpr {
                    position: absolute;
                    top: 0;
                    bottom: 0;
                    left: 50%;
                    right: 0;
                    overflow: auto;
            }
            #panel {
                    font-family: arial;
                    padding: 0 5px;
            }
            #info {
                    padding: 5px;
            }
            #from {
                    width: 90%;
                    font-size: 1.2em;
            }
            .adp-directions {
                    width: 100%;
            }
            .input {
                    background-color: white;
                    padding-left: 8px;
                    border: 1px solid #D9D9D9;
                    border-top: 1px solid silver;
                    -webkit-border-radius: 1px;
                    -moz-border-radius: 1px;
                    border-radius: 1px;
            }
            .time {
                    margin: 0;
                    height: 17px;
                    border: 1px solid;
                    border-top-color: #CCC;
                    border-right-color: #999;
                    border-left-color: #999;
                    border-bottom-color: #CCC;
                    padding: 2px 15px 1px 1px;
            }
            button {
                    border: 1px solid #3079ED;
                    color: white;
                    background-color: #4D90FE;
                    background-image: -webkit-gradient(linear, left top, left bottom, from(#4D90FE), to(#4787ED));
                    background-image: -webkit-linear-gradient(top, #4D90FE, #4787ED);
                    background-image: -moz-linear-gradient(top, #4D90FE, #4787ED);
                    background-image: -ms-linear-gradient(top, #4D90FE, #4787ED);
                    background-image: -o-linear-gradient(top, #4D90FE, #4787ED);
                    background-image: linear-gradient(top, #4D90FE, #4787ED);
                    filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#4d90fe', EndColorStr='#4787ed');
                    display: inline-block;
                    min-width: 54px;
                    text-align: center;
                    font-weight: bold;
                    padding: 0 8px;
                    line-height: 27px;
                    -webkit-border-radius: 2px;
                    -moz-border-radius: 2px;
                    border-radius: 2px;
                    -webkit-transition: all 0.218s;
                    -moz-transition: all 0.218s;
                    -o-transition: all 0.218s;
                    transition: all 0.218s;
            }
            #info div {
                    line-height: 22px;
                    font-size: 110%;
            }
            .btn {
            }
            #panel-wpr {
                    border-left: 1px solid #e6e6e6;
            }
            #info {
                    border-bottom: 1px solid #E6E6E6;
                    margin-bottom: 5px;
            }
            h2 {
                    margin: 0;
                    padding: 0;
            }
            </style>
            <script>
            var directions = new google.maps.DirectionsService();
            var renderer = new google.maps.DirectionsRenderer();
            var map, transitLayer;

            function initialize() {
                    var mapOptions = {
                            zoom: 14,
                            center: new google.maps.LatLng(51.538551, -0.016633),
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                    };

                    map = new google.maps.Map(document.getElementById('map'), mapOptions);

                    google.maps.event.addDomListener(document.getElementById('go'), 'click',
                    route);

                    var input = document.getElementById('from');
                    var autocomplete = new google.maps.places.Autocomplete(input);
                    autocomplete.bindTo('bounds', map);

                    transitLayer = new google.maps.TransitLayer();

                    var control = document.getElementById('transit-wpr');
                    map.controls[google.maps.ControlPosition.TOP_RIGHT].push(control);

                    google.maps.event.addDomListener(control, 'click', function () {
                            transitLayer.setMap(transitLayer.getMap() ? null : map);
                    });

                    addDepart();
                    route();
            }

            function addDepart() {
                    var depart = document.getElementById('depart');
                    for (var i = 0; i < 24; i++) {
                            for (var j = 0; j < 60; j += 15) {
                                    var x = i < 10 ? '0' + i : i;
                                    var y = j < 10 ? '0' + j : j;
                                    depart.innerHTML += '<option>' + x + ':' + y + '</option>';
                            }
                    }
            }

            function route() {
                    var departure = document.getElementById('depart').value;
                    var bits = departure.split(':');
                    var now = new Date();
                    var tzOffset = (now.getTimezoneOffset() + 60) * 60 * 1000;

                    var time = new Date();
                    time.setHours(bits[0]);
                    time.setMinutes(bits[1]);

                    var ms = time.getTime() - tzOffset;
                    if (ms < now.getTime()) {
                            ms += 24 * 60 * 60 * 1000;
                    }

                    var departureTime = new Date(ms);

                    var request = {
                            origin: document.getElementById('from').value,
                            destination: 'Olympic Park London, United Kingdom',
                            travelMode: google.maps.DirectionsTravelMode.TRANSIT,
                            provideRouteAlternatives: true,
                            transitOptions: {
                                    departureTime: departureTime
                            }
                    };

                    var panel = document.getElementById('panel');
                    panel.innerHTML = '';
                    directions.route(request, function (response, status) {
                            if (status == google.maps.DirectionsStatus.OK) {
                                    renderer.setDirections(response);
                                    renderer.setMap(map);
                                    renderer.setPanel(panel);
                            } else {
                                    renderer.setMap(null);
                                    renderer.setPanel(null);
                            }
                    });

            }

            google.maps.event.addDomListener(window, 'load', initialize);
            </script>
    </head>

    <body>
            <div id="transit-wpr">
                    <button id="transit">Toggle transit layer</button>
            </div>
            <div id="map"></div>
            <div id="panel-wpr">
                    <div id="info">
                            <div>
                                     <h2>Transit directions</h2>

                            </div>
                            <div>
                                    <label>from:</label>
                                    <input class="input" id="from" value="Belgrave House 76 Buckingham Palace Road, London, Greater London">
                            </div>
                            <div>
                                    <label>to:</label> <strong>Olympic Park London, United Kingdom</strong>

                            </div>
                            <div>Depart at
                                    <select id="depart"></select>
                            </div>
                            <div class="btn">
                                    <button id="go">Get Directions</button>
                            </div>
                    </div>
                    <div id="panel"></div>
            </div>
    </body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:59:05.833

请参阅[文档](https://developers.google.com/maps/documentation/javascript/tutorial#Loading_the_Maps_API)

脚本标签在您的网站或本地页面上需要协议“http:”，但在 google 示例上不需要（因为它们在同一台服务器上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:24:13.503

好的，解决了。我需要更改 js 的 url，不知道为什么它可以在 Google 而不是我的电脑上运行，无论如何

```
//maps.googleapis.com/maps/api/js?sensor=false&libraries=places 
```

变成

```
//maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&amp;libraries=places 
```

# android - 我可以同时开发适用于三星 S3 和其他 android 的 android 应用程序吗

> ID：13546040
> 
> 赞同：-1
> 
> 时间：2012-11-24T21:58:16.937
> 
> 标签：android, mobile

我想了解更多关于 android 应用程序开发的信息，我想开始使用

[这个 SDK](http://developer.android.com/training/basics/firstapp/index.html)，我不知道它是否与三星 Galaxy 3 和/或其他移动设备兼容！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:00:01.220

是的。这就是为什么Android被称为“平台”。许多设备，相同的操作系统。一般来说，您**应该**编写一个可以在任何 android 设备上完美运行的应用程序（更多/更少:)

经验法则 - 为 Android 编写。不适用于三星 S3（除非您绝对知道您只需要为三星 S3 编写并且您知道自己在做什么）

# database - Ruby on Rails - 数据库配置未指定适配器生产

> ID：13546042
> 
> 赞同：2
> 
> 时间：2012-11-24T21:58:45.433
> 
> 标签：database, ruby-on-rails-3, apache, rake, passenger

我正在尝试使用 Passenger、Apache 和 MySQL 在线设置我的应用程序，但是当我运行此命令时，我收到以下错误

```
rake db:migrate RAILS_ENV='production'

rake aborted!
database configuration does not specify adapter
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_specification.rb:47:in `resolve_hash_connection'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_specification.rb:41:in `resolve_string_connection'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_specification.rb:25:in `spec'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_specification.rb:130:in `establish_connection'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.9/lib/active_record/railtie.rb:82:in `block (2 levels) in <class:Railtie>'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/lazy_load_hooks.rb:36:in `instance_eval'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/lazy_load_hooks.rb:36:in `execute_hook'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/lazy_load_hooks.rb:43:in `block in run_load_hooks'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/lazy_load_hooks.rb:42:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activesupport-3.2.9/lib/active_support/lazy_load_hooks.rb:42:in `run_load_hooks'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.9/lib/active_record/base.rb:720:in `<top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p327/gems/activerecord-3.2.9/lib/active_record/railties/databases.rake:25:in `block (2 levels) in <top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p327/bin/ruby_noexec_wrapper:14:in `eval'
/usr/local/rvm/gems/ruby-1.9.3-p327/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => db:migrate => db:load_config
(See full trace by running task with --trace) 
```

# javascript - 拉斐尔如何改变颜色

> ID：13546043
> 
> 赞同：0
> 
> 时间：2012-11-24T21:58:51.137
> 
> 标签：javascript, text, raphael

嘿，伙计们，我刚刚画了一个简单的圆圈，想知道如何让它自动改变颜色。因此，例如，它将从黑色开始，然后变为橙色，然后变为黄色，然后变为红色等。

这就是我到目前为止所得到的。只是一些简单的代码，它是一个黑色的圆圈，会在 1 秒后向上移动屏幕。

```
 var ball1 = paper.circle(700,170,30);
        ball1.attr({ fill: "black"});
        var anim = Raphael.animation({cy: 10 , cx: 700}, 10000)
        ball1.animate(anim.delay(1000)); 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:17:01.743

要将黑色圆圈设置为白色，您只需为动画添加填充

```
var paper = Raphael( 0, 0, 1000, 1000 );
var ball1 = paper.circle(700,170,30);
ball1.attr({ fill: "black"});

ball1.animate({ cy: 10 , cx: 700 }, 10000 );
ball1.animate({ fill: "yellow" }, 3000, "linear", function( ) {
        ball1.animate({ fill: "orange" }, 3000, "linear", function( ) {
            ball1.animate({ fill: "red" }, 3000, "linear" );
        });
}); 
```

演示[**在这里**](http://jsfiddle.net/L7AFs/)

# c# - 从 bing 地图获取本地化结果

> ID：13546048
> 
> 赞同：0
> 
> 时间：2012-11-24T21:59:38.990
> 
> 标签：c#, windows-phone-7, localization, bing

我正在开发一个简单的 WP7 应用程序，它绘制出从用户当前位置到他/她的目的地的旅程路线。一切都很顺利，直到我遇到了 bing 地图的障碍。我希望用户搜索他的目的地，但获得本地化结果本身就是一个问题。从我得到的结果来看，我只得到美国的结果。有人知道我如何绕过这个吗？我见过有人说他们实现了谷歌本地搜索，但这有点模棱两可。如果可用，我也希望使用指向其他 API 的指针。任何澄清和建议将不胜感激。

编辑：经过大量研究，我决定使用 Openstreetmap (Nominatim) 来获取本地搜索结果，并进一步使用获得的纬度和经度在我的 Bing 地图画布上做更多事情

# c++ - 派生类指针指向的函数

> ID：13546049
> 
> 赞同：0
> 
> 时间：2012-11-24T21:59:57.777
> 
> 标签：c++, inheritance

我最近在一次采访中被问到这个问题。给定代码：

```
class A{
    public:
       void f() { cout << "f in A" << endl; }
};

class B : public A{
    public:
       void g() { cout << "g in B" << endl; }
};

int main()
{
    B *p2 = new B;    
} 
```

指针 p2 指向哪个函数？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:06:55.253

`p2`不是函数指针。`p2`只是指向分配的内存`new B`，而不是函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:07:44.353

嗯。p2 指向 B 类的一个实例。所以它也可以指向

- 特定于实现并且偶然指向函数 g （如果您应用一些奇怪的演员表），

但这毫无意义。p2 只是指向 B 类的一个实例，如果您愿意，可以调用该实例方法 g。如果你更喜欢冒险，你甚至可以调用 B 的基类 A 的方法 f 的方法 f。其他任何事情都只是依赖于实现，没有任何意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T22:22:09.587

`p2`不指向函数，而是指向`class B`. 它不仅不是函数指针（正如其他答案所指出的那样），而且它指向的地址也不是几乎任何实现中的任何函数的地址。如果`class B`有非静态数据成员，`p2`也将与第一个非静态数据成员的地址一致（但它不会指向它，因为它不是指向该类型对象的指针！）。但是，这不适用于成员方法：成员函数指针不依赖于对象。

很奇怪在面试中提出这样一个无厘头的问题。也许面试官想表明他们对基本编程的无知。

# java - 找到 Java 标准库

> ID：13546052
> 
> 赞同：6
> 
> 时间：2012-11-24T22:00:26.180
> 
> 标签：java, python, classpath

找到包含核心 Java 类的 jar 的最佳方法是`java.lang.Object`什么？我一直在使用`JAVA_HOME`，但事实证明只有安装了 JDK 才有效。`java`如果从命令行运行，我如何才能找到将使用的标准库位置？

另外，我需要从 Python 脚本中执行此操作，因此请不要使用 Java 库进行响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:00:10.197

当您`java`从 Oracle 的 JVM 启动时，它会将`sun.boot.class.path`属性设置为指向`rt.jar`，它通常包含所有`java.lang`内容。

您可以做的是启动一个简单的 Java 程序，该程序检索`System.getProperty("sun.boot.class.path")`并获取该文件应该在的位置。[在此处](http://www.tedneward.com/files/Papers/BootClasspath/BootClasspath.pdf)阅读更多信息。

如果您的环境是正确的（`JAVA_HOME`设置等），上面应该可以工作。否则，恐怕你有鸡和蛋的问题;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:58:40.307

Since there are no explicit restrictions on placing internal classes, then you should try handle all the possible (or as much as possible) places.

First of all, you should definitely look for `java` in PATH. Unfortunately, it will fail sometimes, for instance, you can often find `java.exe` in `C:\Windows\System32`. Fortunately, in case of Windows you can use registry to get a list of installed JREs.

If you have found some jars which might contain basic classes, you can use `zip` or `jar` to check that `java/lang/Object.class` is there.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:12:18.690

Python 应该有办法找到“java”或“java.exe”可执行文件的位置。按照所有符号链接显示真实位置。我的 Python 生锈了，但我认为`shutil.which`并将`os.path.realpath`完成这项工作。

核心类将`../lib/rt.jar`与 java 可执行文件相关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T22:08:08.277

如果您使用的是 linux，则可以使用 shell 命令：“type java”并解析输出。

# android - 每天更新一个巨大的 SQLite 数据库

> ID：13546053
> 
> 赞同：3
> 
> 时间：2012-11-24T22:00:28.340
> 
> 标签：android, database, sqlite

好的，所以我正在做一个项目，其中数据库将在一个表中保存大约 20000 个元素。示例：我有一家销售 20000 种产品的商店，我想每天更新它们。每天只会更新大约100-200个。

我正在考虑将整个数据库本地化，这样会更快。我想知道这是否是解决问题的好方法，还是我应该使用任何其他方法来保存和显示数据？我担心更新文件对于每日下载/更新来说太大了。

由于每次更新数据库时它都从 0 开始构建，因此是否可以更新数据库？

原谅我的语法。简

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:10:04.613

您不需要更新数据库。您需要更新**数据库内容**。让您的应用存储任何类型的标识符（比如说 int）。您每天发布对数据库**内容**的更新- 仅与前一天的内容不同。然后，您的应用程序应检查服务器上数据库的当前 id 是什么，然后获取并应用 db 包含的 id 与最新版本之间的所有差异。或者根据要求构建一个更新文件，了解客户拥有的内容修订版本和最新版本。如果用户每天都使用您的应用程序，那么这没什么大不了的。

> 是否可以更新数据库，因为每次更新数据库时它都会从 0 开始构建自己？

那么你很可能这样做有点错误。您需要能够增量构建（或者至少您应该始终能够将相同的 ID 分配给数据库中的相同产品）。

或者，如果最终的数据库转储很小（即 5MB-50MB-500MB - 您可以命名）。只需让您的应用程序获取整个数据库文件并替换旧内容，而无需浪费时间和精力进行增量更新，因为处理这些文件可能比替换整个数据库花费更多的时间/金钱。

# session - 如何在 clojure Web 应用程序中创建用户帐户？

> ID：13546055
> 
> 赞同：3
> 
> 时间：2012-11-24T22:00:47.670
> 
> 标签：session, web-applications, login, clojure

我正在尝试编写一个 clojure 网络应用程序，我想让人们创建用户帐户以及登录和注销，就像 reddit 或黑客新闻之类的那样。

我对此完全陌生，我的印象是它有点微妙和复杂。谷歌搜索没有多大帮助。

谁能给我指出一篇讨论问题和解决问题的方法的文章，以及一个展示如何在 clojure 中完成的教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T01:59:26.437

一般来说，有很多方法可以处理身份验证和 Web 应用程序，具体取决于您的要求。一般来说，我建议使用现有的 clojure 库（用于 Web 应用程序或身份验证）并弄清楚它们的具体工作方式。您可以从[Mustache](https://github.com/cgrand/moustache)开始运行您的 Web 应用程序，然后继续使用[Friend](https://github.com/cemerick/friend)添加身份验证。我个人没有使用过其中任何一个，并且已经使用 compojure 实现了基本身份验证，但是这些库在我看来可以完成工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T12:45:13.210

这个问题也出现在[Clojure 电子邮件组中。](https://groups.google.com/d/topic/clojure/ZytyHzOjwdw/discussion)许多人建议使用 Mozilla 的[Persona](https://login.persona.org/)身份验证系统，因为它最容易使用。

# gwt - 在 Eclipse 中进行 GWT 编译时不支持的 major.minor 版本

> ID：13546063
> 
> 赞同：1
> 
> 时间：2012-11-24T22:01:32.017
> 
> 标签：gwt, gwt-compiler, unsupported-class-version

所以我得到了以下异常：我知道`major.minor version`当您使用旧 jdk 编译并使用较新的 jdk 运行时会出现异常，但我只是在进行 GWT 编译。任何人都可以对此有所了解：

```
Compiling module com.domkee.entities.Entities
[ERROR] Unexpected internal compiler error
java.lang.UnsupportedClassVersionError: com/domkee/entities/client/annontations/Table : Unsupported major.minor version 51.0
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:621)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:260)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:56)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:195)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:247)
    at com.google.gwt.dev.javac.TypeOracleMediator.getAnnotationClass(TypeOracleMediator.java:575)
    at com.google.gwt.dev.javac.TypeOracleMediator.resolveAnnotation(TypeOracleMediator.java:643)
    at com.google.gwt.dev.javac.TypeOracleMediator.resolveAnnotations(TypeOracleMediator.java:663)
    at com.google.gwt.dev.javac.TypeOracleMediator.resolveClass(TypeOracleMediator.java:809)
    at com.google.gwt.dev.javac.TypeOracleMediator.addNewTypes(TypeOracleMediator.java:439)
    at com.google.gwt.dev.javac.TypeOracleMediatorFromSource.addNewUnits(TypeOracleMediatorFromSource.java:52)
    at com.google.gwt.dev.javac.CompilationState.assimilateUnits(CompilationState.java:164)
    at com.google.gwt.dev.javac.CompilationState.<init>(CompilationState.java:82)
    at com.google.gwt.dev.javac.CompilationStateBuilder.doBuildFrom(CompilationStateBuilder.java:450)
    at com.google.gwt.dev.javac.CompilationStateBuilder.buildFrom(CompilationStateBuilder.java:370)
    at com.google.gwt.dev.cfg.ModuleDef.getCompilationState(ModuleDef.java:360)
    at com.google.gwt.dev.Precompile.precompile(Precompile.java:252)
    at com.google.gwt.dev.Precompile.precompile(Precompile.java:233)
    at com.google.gwt.dev.Precompile.precompile(Precompile.java:145)
    at com.google.gwt.dev.Compiler.run(Compiler.java:232)
    at com.google.gwt.dev.Compiler.run(Compiler.java:198)
    at com.google.gwt.dev.Compiler$1.run(Compiler.java:170)
    at com.google.gwt.dev.CompileTaskRunner.doRun(CompileTaskRunner.java:88)
    at com.google.gwt.dev.CompileTaskRunner.runWithAppropriateLogger(CompileTaskRunner.java:82)
    at com.google.gwt.dev.Compiler.main(Compiler.java:177) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T17:37:44.043

我没有想出问题，但我想出了解决方案：

1.  关闭日食
2.  我卸载了所有的 jdks（显然我有 4 个）
3.  我安装了一个新的（java 1.6）
4.  运行日食
5.  在 window->preferences->java->compiler 中设置编译器
6.  Projects can have an individually set compilers that is not the default workspace compiler so go through each project and right->click ->preferences -> java compiler and set a 1.6 compiler.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:54:28.327

我不熟悉这些异常，但请确保您将 Java 编译器设置为以 Java 1.6（尤其不是 1.7）为目标，并且使用 Java 1.6 或更新版本来运行 GWT 编译器。

# python - networkx中的定向加权平衡树导入和最短路径

> ID：13546064
> 
> 赞同：4
> 
> 时间：2012-11-24T22:01:32.670
> 
> 标签：python, networkx

我有一个分支因子为 2 且高度为 100 的平衡树，每条边都有一个由文本文件给出的权重，如下所示：

```
 73 41
 52 40 09
 26 53 06 34
 etc etc until row nr 99 
```

即：从节点0到1的边权重为73，从0到2的边权重为41，从1到3的边权重为52，以此类推。

我希望找到从根到树末端的最短路径（具有相应的边缘权重和）。据我了解，这可以通过将所有边权重乘以 -1 并使用 Networkx 中的 Dijkstra 算法来完成。

1.  算法选择是否正确？
2.  如何“轻松”将此数据集导入 Networkx 图形对象？

（*PS：这是 Project Euler [Problem 67](https://projecteuler.net/problem=67)，在数字三角形中找到最大和。我已经用记忆递归解决了这个问题，但我想尝试用 Networkx 包解决它。*）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:35:35.320

> 算法选择是否正确？

是的。您可以使用正权重，并调用[nx.dijkstra_predecessor_and_distance](http://networkx.lanl.gov/reference/generated/networkx.algorithms.shortest_paths.weighted.dijkstra_predecessor_and_distance.html#networkx.algorithms.shortest_paths.weighted.dijkstra_predecessor_and_distance)以获取从根节点开始的最短路径`0`。

* * *

> 如何“轻松”将此数据集导入 Networkx 图形对象？

```
import networkx as nx
import matplotlib.pyplot as plt

def flatline(iterable):
    for line in iterable:
        for val in line.split():
            yield float(val)

with open(filename, 'r') as f:
    G = nx.balanced_tree(r = 2, h = 100, create_using = nx.DiGraph())
    for (a, b), val in zip(G.edges(), flatline(f)):
        G[a][b]['weight'] = val

# print(G.edges(data = True))

pred, distance = nx.dijkstra_predecessor_and_distance(G, 0)

# Find leaf whose distance from `0` is smallest
min_dist, leaf = min((distance[node], node) 
                     for node, degree in G.out_degree_iter()
                     if degree == 0)
nx.draw(G)
plt.show() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T22:59:55.303

我不确定我是否完全理解输入格式。但是类似的东西应该可以工作：

```
from itertools import count
import networkx as nx
adj ="""73 41
52 40 09
26 53 06 34"""
G = nx.Graph()
target = 0
for source,line in zip(count(),adj.split('\n')):
    for weight in line.split():
        target += 1
        print source,target,weight
        G.add_edge(source,target,weight=float(weight))
# now call shortest path with weight="weight" and source=0 
```

# wpf - DynamicDataDisplay ChartPlotter 滚动横轴

> ID：13546068
> 
> 赞同：1
> 
> 时间：2012-11-24T22:02:59.413
> 
> 标签：wpf, charts, dynamic-data-display

由于缺乏文档，我对这个库仍然很粗糙。

我有一个 ChartPlotter 对象，它通过从设备捕获数据来实时显示数据。每次我有来自设备的新数据时，都会调用以下事件：

```
 private void OnRawDataChanged(object sender, RawDataChangedEventArgs e)
    {
        System.Diagnostics.Debugger.Log(0, "event", "event received from data manager\n");
        System.Diagnostics.Debugger.Log(0, "event", e.NewRawDataSet.Length + " tuples of data returned\n");

        var batchSize = e.NewRawDataSet.Length;

        // Expected tuples of 2 values + 2 threshold values
        Point[][] points = new Point[4][];

        for (int i = 0; i < 4; i++)
        {
            points[i] = new Point[batchSize];
        }

        double period = 1.0 / Properties.Settings.Default.SamplingRate;

        for (int i = 0; i < batchSize; i++)
        {
            // Time is expressed in milliseconds
            double t = e.NewRawDataSet[i].Time / 1000.0;

            points[0][i] = new Point(t, e.NewRawDataSet[i].Sensors[0]);
            points[1][i] = new Point(t, e.NewRawDataSet[i].Sensors[1]);
            points[2][i] = new Point(t, parentForm.PressureHisteresysOpen);
            points[3][i] = new Point(t, parentForm.PressureHisteresysClose);
        }

        plotter.Dispatcher.Invoke(DispatcherPriority.Normal,
            new Action(() =>
                {
                    sensor0.AppendMany(points[0]);
                    sensor1.AppendMany(points[1]);
                    pressureOpen.AppendMany(points[2]);
                    pressureClose.AppendMany(points[3]);
                }));
    } 
```

使用 ChartPlotter 的标准设置，图形将自动适应窗口。我想让水平轴自动向左滚动，仅显示最后 10 秒（例如）的捕获。有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T16:03:32.293

为此，您必须修改 plotter.ViewPort.Visible 属性。此属性采用一个 DataRect 对象，您使用值构造该对象以形成一个矩形。每次您收到一条新数据时，您都必须重新计算此矩形，以便您的图表可以滚动查看。

这是构造 DataRect 的示例：

```
 double yMin = 1;
        double yMax = 10;
        double xMin = 1;
        double xMax = 10;
        plotter.ViewPort.Visible = new DataRect(xMin, yMin, xMax - xMin, yMax - yMin); 
```

您的最小值和最大值将基于轴上的数据类型。

# c++ - C++ - 运行摩西解码器时区域设置名称无效异常

> ID：13546074
> 
> 赞同：1
> 
> 时间：2012-11-24T22:03:35.193
> 
> 标签：c++, machine-translation, moses

[按照此处](http://www.statmt.org/moses/?n=Development.GetStarted)描述的步骤，我已经在我的机器（Windows 7 64 位）上成功编译了 Moses（v0.91）。但是，当我第一次尝试通过在 cygwin 中运行此命令来运行它时：

```
cd ~/mosesdecoder/sample-models
~/mosesdecoder/bin/moses -f phrase-model/moses.ini < phrase-model/in > out 
```

发生以下异常：

```
Defined parameters (per moses.ini or switch):
    config: phrase-model/moses.ini
    input-factors: 0
    lmodel-file: 8 0 3 lm/europarl.srilm.gz
    mapping: T 0
    n-best-list: nbest.txt 100
    ttable-file: 0 0 0 1 phrase-model/phrase-table
    ttable-limit: 10
    weight-d: 1
    weight-l: 1
    weight-t: 1
    weight-w: 0
Exception: locale::facet::_S_create_c_locale name not valid 
```

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T01:17:59.923

这对我有用：

```
export LC_ALL="C" 
```

# emacs - ctrl-x o 向后（与其他窗口相反）？

> ID：13546075
> 
> 赞同：12
> 
> 时间：2012-11-24T22:03:48.737
> 
> 标签：emacs

> CTRL-x o - 将光标切换到其他窗口

我想有能力扭转什么`control-x o`。类似的东西`control-x p`完全`control-x o`可以做，但是倒退了。这个请求的原因是我经常打开两个缓冲区是代码，一个缓冲区是 repl。我经常不得不穿过其中一个缓冲区才能到达另一个缓冲区，这很烦人。

假设我打开了 3 个缓冲区（A、B、C），并且我在缓冲区 B 上。缓冲区按字母顺序排列`control-x o`。当我想去 A 时，我只想按`control-x p`，而不是按`control-x o`两次。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-24T22:15:04.257

Call `other-window` with a negative count. This can be done interactively by pressing `C--` `C-x o`. The "C--" is supplying a numeric argument of -1\. You can supply any numeric (NUM) by pressing `C-u num`.

If you don't want to press the additional key cord, just write you own command command to hard code the "-1" argument:

Add this code to your `.emacs` file

```
(global-set-key "\C-xp" (lambda () 
                          (interactive)
                          (other-window -1))) 
```

How does it work? "C-x o" calls the function `other-window` (to find that out use `C-h k` and then type the key combo).

In the code above we define an anonymous function, make it interactive and do what we want. Then we bind that function to the key combinaion `C-x p`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:15:27.967

I was using emacs for a bit and i dont renember having any backward option of Ctrl-x o. Anyway i always prefaired using Ctrl-x Ctrl-f, this let you circle between files, using simple, text based file explorer. Previous file is in bacground. You can combine both.

# silverlight - 如何将数据绑定到不断变化的属性

> ID：13546078
> 
> 赞同：0
> 
> 时间：2012-11-24T22:04:01.587
> 
> 标签：silverlight, windows-phone-7, data-binding

我有一个表示计时器的简单类（为清楚起见进行了简化）：

```
public class Timer {
    DateTime startTime;

    // How do I notify the UI that this property is changing?
    public TimeSpan Value {
        get {
            return DateTime.Now - startTime;
        }
    }
    public void Start() {
        startTime = DateTime.Now;
    }
} 
```

以及一个包含 a`TextBlock`和 a 的实例的页面`Timer`。

我想对`TextBlock`'`Text`属性进行数据绑定以显示`Timer.Value`. 但是，这个字段显然在不断变化，所以触发`PropertyChanged`事件似乎没有任何意义。

是否有某种方法可以指示属性始终在变化，以便 UI 尽可能快地更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:26:01.583

这`PropertyChanged`就是设计要做的。UI 应该能够应对不断变化的值。

但是，为了确保您不会淹没 UI，您应该使用一个计时器来控制每个刻度的间隔：

```
System.Threading.Timer myTimer;

TimerCallback callback = TimerTick;
myTimer = new System.Threading.Timer(callback, null, 0, 1000); 
```

这会立即启动一个计时器 (the `0`)，它每秒触发一次 (the `1000`)。你的`TimerCallback`会看起来像这样：

```
void TimerTick(object stateInfo)
{
    // Raise property changed event with DateTime.Now
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T13:25:34.570

这就是我想出的：

```
public class ObservableTimer : Timer, INotifyPropertyChanged {
    public event PropertyChangedEventHandler PropertyChanged;
    // some extension methods are being used here
    public PropertyChangedEventArgs pcValue = Property.Changed<ObservableTimer>(t => t.Value);

    DispatcherTimer dTimer;

    public ObservableTimer() {
        dTimer = new DispatcherTimer();
        dTimer.Interval = TimeSpan.FromMilliseconds(50);
        dTimer.Tick += onTimerTick;
        dTimer.Start();
    }

    private void onTimerTick(object sender, EventArgs e) {
        // some extension methods are being used here
        PropertyChanged.Raise(this, pcValue);
    }
} 
```

如[ChrisF 的回答](https://stackoverflow.com/a/13546274/102441)中所述，这使用计时器来定期触发`PropertyChanged`事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T12:58:55.840

这是你可以做的，你有这门课，

```
public class Timer {
DateTime startTime;

// How do I notify the UI that this property is changing?
public TimeSpan Value {
    get {
        return DateTime.Now - startTime;
    }
}
public void Start() {
    startTime = DateTime.Now;
} 
```

}

首先将 INotifyPropertyChanged 应用于属性值。

现在在 XAML 中，您可能有一个网格。您需要将网格的“Datacontext”绑定到 Timer 类的当前实例。为此有很多方法，其中最简单的就是将网格命名为say（as RootGrid）。现在在用户控件的加载事件中：

```
private void UserControl_Loaded(object sender, RoutedEventArgs e)
    {
       RootGrid.DataContext = this;
    } 
```

Ok 游戏结束，最后一步是将 TextBlock 的 Text 属性绑定到您的“Value”。

```
<TextBlock Text="{Binding Value}"/> 
```

和上面的 XAML 代码，将为您完成。

# floating-point - 哪些算法用于 CPU 中的常见浮点运算？

> ID：13546082
> 
> 赞同：3
> 
> 时间：2012-11-24T22:04:31.620
> 
> 标签：floating-point, cpu, cpu-architecture

我正在写一篇关于 CPU 设计和实现不同数学运算的论文，例如加法、乘法、除法、平方根和对数。这篇论文也是关于数值分析的。然而，我似乎走到了尽头。结果，我有一些问题

1.  是否有任何阅读材料（其他论文、书籍）可以以更简单的步骤分解某些操作？
2.  我的印象是牛顿法用于平方根（有时是除法），泰勒级数用于对数。这是假的吗？使用什么？
3.  软件实现的浮点支持有什么不同吗？

我意识到它可能取决于 CPU 架构，因此对于像较新的 Intel i7 处理器（通常是 x86 架构）这样的常见 CPU 的答案将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T00:24:59.350

此外，您还想了解进位超前加法器（特别是[Kogge-Stone 加法器](http://en.wikipedia.org/wiki/Kogge%E2%80%93Stone_adder)）。

高性能乘法器的设计是一个相当复杂的主题，如果您不是研究生，可能超出了您想要考虑的学校项目的范围。

牛顿法通常不用于硬件平方根或除法器。有时会使用 Goldschmidt 的方法（请参阅 Peter Markstein 的关于该主题的论文以获取来源；它非常易读），因为它更适合硬件，但也经常使用教科书方法的变体（通常使用大于 2 的基数；看成有符号数除法算法）。

软件实现往往完全不同。

# java - 标签 x 和 y 轴 java gui

> ID：13546086
> 
> 赞同：3
> 
> 时间：2012-11-24T22:05:14.247
> 
> 标签：java, swing, user-interface, jpanel, paintcomponent

第一次海报所以请多多包涵。

我正在尝试使用 Java GUI 创建一个图形计算器（是的，我知道已经有应用程序可以这样做。）我正在使用 Graphics2D 类，只是想知道如何标记 x 和 y 轴。

这是我到目前为止所写的内容，它将绘制一个基本的抛物线以及 x 和 y 轴。另外，如果有人能告诉我如何改变它，使轴线更细，那将是惊人的！

提前致谢！-埃文

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.geom.Line2D;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class GraphWindow extends JPanel {

    /**
     * @param args
     */
    public void paintComponent(Graphics g){
        super.paintComponent(g);
        double max=16;
        double min=0;
        double x[]= {-4,-3,-2,-1,0,1,2,3,4};
        double y[]={16,9,4,1,0,1,4,9,16};

        Graphics2D g2=(Graphics2D)g;
        setBackground(Color.WHITE);
        g2.translate(getWidth()/2,getHeight()/2);
        g2.scale(5.0, 5.0);
        g2.draw( new Line2D.Double(-4*100,0,4*100,0));
        g2.draw( new Line2D.Double(0,min*100,0,-max*100));
        for(int i=0;i<x.length;i++){
            if(i+1<x.length){
            g2.setColor(Color.RED);
            g2.draw(new Line2D.Double(x[i], -y[i], x[i+1], -y[i+1]));
            }
            else{
                break;
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:28:39.340

您可以使用`Graphics.drawString()`绘制两个轴：

```
g.setColor(Color.black);
g.setFont(new Font("SansSerif", Font.BOLD, 8));

g.drawString("X Axis", 30, 10);

// rotate for Y axis
g2.rotate(-Math.PI/2);
g.drawString("Y Axis", 20, -8); 
```

旋转`Graphics2D`以绘制 Y 轴。确保将其作为*最后一*组语句，`paintComponent`以避免重新轮换`Graphics2D`。

您可以使用以下方法获得更细的线条：

```
g2.scale(2.0, 2.0); 
```

请参阅：[Graphics2D.scale()](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics2D.html#scale%28double,%20double%29)

# c# - 带有 DataGridView 的 DataTable 的奇怪行为

> ID：13546088
> 
> 赞同：4
> 
> 时间：2012-11-24T22:05:33.990
> 
> 标签：c#, datagridview, datatable, sqldataadapter

请解释一下发生了什么。我创建了一个 WinForms .NET 应用程序，该应用程序在表单上有 DataGridView，并且在使用 DataGridView 内联编辑时应该更新数据库。

表单有**SqlDataAdapter** _da 和四个 SqlCommands 绑定到它。DataGridView 直接绑定到 DataTable _names。

这样的 CellValueChanged 处理程序：

```
private void dataGridView1_CellValueChanged(object sender, DataGridViewCellEventArgs e)
{
    _da.Update(_names);
} 
```

尽管 _names DataTable 已更新，但不会更新数据库状态。_names 的所有行都有 RowState == DataRowState.Unchanged

好的，我修改了处理程序：

```
private void dataGridView1_CellValueChanged(object sender, DataGridViewCellEventArgs e)
{
    DataRow row = _names.Rows[e.RowIndex];
    row.BeginEdit();
    row.EndEdit();
    _da.Update(_names);
} 
```

此变体确实将修改后的单元格写入数据库，但是当我尝试将新行插入网格时，我收到一个错误，提示缺少索引为 e.RowIndex 的行

所以，我决定进一步改进处理程序：

```
private void dataGridView1_CellValueChanged(object sender, DataGridViewCellEventArgs e)
{
    if (_names.Rows.Count<e.RowIndex)
    {
        DataRow row = _names.Rows[e.RowIndex];
        row.BeginEdit();
        row.EndEdit();
    }
    else
    {
        DataRow row = _names.NewRow();
        row["NameText"] = dataGridView1["NameText", e.RowIndex].Value;
        _names.Rows.Add(row);
    }
    _da.Update(_names);
} 
```

现在，当我向网格插入新行时，真正奇怪的事情发生了：网格保持原样，直到 _names.Rows.Add(row); 在此行之后，将三行插入到表中 - 两行具有相同的值，另一行具有 Null 值。

稍作修改的代码：

```
DataRow row = _names.NewRow();
row["NameText"] = "--------------"
_names.Rows.Add(row); 
```

插入具有三个不同值的三行：一个输入到网格中，第二个具有“--------------”值，第三个 - 具有 Null 值。

我真的被困在猜测发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:59:44.857

我有一个解决方案给你，但让我解释一下发生了什么。在触发 CellValueChanged 事件时，DataGridView 已经识别出您对单元格进行了更改，并且实际上已经将值推送到了表格中，但表格仍处于编辑模式，因此修改后的行的 RowState 仍保持不变。此外，插入的行甚至在表中都不可见。要强制表反映这些更改，请调用表单的 BindingContext 的 EndCurrentEdit() 方法：

```
this.BindingContext[_names].EndCurrentEdit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T23:02:38.657

获得您想要的行为（我认为）的最简单方法是引入绑定源 - 将数据表设置为该绑定源的数据源，然后将绑定源设置为网格。

单元格值更改后变为：

```
private void dataGridView1_CellValueChanged(object sender, DataGridViewCellEventArgs e)
{
    bs.EndEdit();
    _da.Update(_names);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-05T20:11:21.450

NECRO 回答：最简单的方法是使用另一个数据集进行更改：

```
private void UpdateDB()
{
    using (SqlConnection conn = new SqlConnection(SQLString.ConnStr))   // All new connection
    {
        try
        {
            dataAdapter.SelectCommand = new SqlCommand(SQLString.QryStr, conn);
            cmd.DataAdapter = dataAdapter;

            changeSet = dataSet.GetChanges();
            if (changeSet != null)
            {
                dataAdapter.Update(changeSet, "tstRegion");
            }
        }
        catch (Exception e)
        {
            MessageBox.Show(e.ToString());
        }
    }
} 
```

请注意，原始数据集的更改是更改数据集中的所有内容。

# ruby-on-rails - Rails - 我如何拥有特定于该用户的帖子？

> ID：13546089
> 
> 赞同：1
> 
> 时间：2012-11-24T22:05:36.340
> 
> 标签：ruby-on-rails, ruby

我有一个 Rails 应用程序，我在其中为“帖子”生成了一些标题（字符串）和正文（内容）的脚手架。

这允许我创建、编辑和删除帖子。

我刚刚安装了设计，所以现在我可以在应用程序中拥有用户 - 唯一的问题是无论我以什么身份登录，都会显示相同的帖子。

有没有办法让每个用户都有特定的帖子？我是否必须更改帖子或用户模型或添加新控制器？

如果这让您感到困惑，另一种说法是，我希望每个用户都创建自己的“帖子”，而其他用户看不到。

### 更新

这是posts_controller

```
class PostsController < ApplicationController
before_filter :authenticate_user!, except: [:index, :show]

# GET /posts
# GET /posts.json
def index
  # @posts = current_user.posts
  @posts = Post.all

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @posts }
  end
end

# GET /posts/1
# GET /posts/1.json
def show
  @post = Post.find(params[:id])

  respond_to do |format|
    format.html # show.html.erb
    format.json { render json: @post }
  end
end

# GET /posts/new
# GET /posts/new.json
def new
  @post = Post.new

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @post }
  end
end

# GET /posts/1/edit
def edit
  @post = Post.find(params[:id])
end

# POST /posts
# POST /posts.json
def create
  @post = Post.new(params[:post])

  respond_to do |format|
    if @post.save
      format.html { redirect_to @post, notice: 'Post was successfully created.' }
      format.json { render json: @post, status: :created, location: @post }
    else
      format.html { render action: "new" }
      format.json { render json: @post.errors, status: :unprocessable_entity }
    end
  end
end

# PUT /posts/1
# PUT /posts/1.json
def update
  @post = Post.find(params[:id])

  respond_to do |format|
    if @post.update_attributes(params[:post])
      format.html { redirect_to @post, notice: 'Post was successfully updated.' }
      format.json { head :no_content }
    else
      format.html { render action: "edit" }
      format.json { render json: @post.errors, status: :unprocessable_entity }
    end
  end
end

# DELETE /posts/1
# DELETE /posts/1.json
def destroy
  @post = Post.find(params[:id])
  @post.destroy

  respond_to do |format|
    format.html { redirect_to posts_url }
    format.json { head :no_content }
  end
end
end 
```

这是帖子模型

```
class Post < ActiveRecord::Base
  attr_accessible :content, :name

  belongs_to :user
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:06:52.543

在您的 Posts**控制器**中使用`@posts = current_user.posts`index 方法。

您将需要在 Post 和 User**模型**中设置Post `belongs_to`User/User帖子关系。`has_many`

 **现在您的帖子/索引**视图**可以遍历@posts，它们将只适用于该用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:08:31.093

您必须修改您的视图和/或您的帖子控制器以仅显示 user_id = current_user 的帖子。您还必须在您的帖子模型中有一个 user_id。如果您在此处添加代码，我想有人可以帮助您

更新 ：

将 has_many :posts 添加到用户模型

然后在后控制器中替换：

```
def index
 @posts = current_user.posts

 respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @posts }
 end
end 
```

您在帖子模型中也有一个 user_id 列吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T07:35:38.313

您必须在用户模型中添加关联，因为用户可以有多个帖子，因此您将其添加到用户模型中

```
has_many :posts 
```

然后在你的帖子控制器的索引方法中，你做这样的事情

```
respond_to :html, :xml, :json

def index
  @posts = current_user.posts    
  respond_with(@post)
end 
```

关于respond_with，我们可以使用类方法respond_to指定支持哪些资源格式，然后在控制器动作中我们告诉控制器使用respond_with传递的资源或资源

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-24T22:07:46.733

当然，您可以在用户与其帖子之间建立关联！**

# java - 一次仅使用 2 个成员的平均值查找数组的平均值

> ID：13546094
> 
> 赞同：2
> 
> 时间：2012-11-24T22:06:19.547
> 
> 标签：java, c, algorithm, recursion, average

给你一个数组，有 8 杯水，每个杯子装的水量不同，你必须在所有杯子中得到等量的水，并且只能使用此功能

```
public void equals(double[] arr, int i, int j) {
    arr[i] = arr[j] = (arr[i] + arr[j]) / 2;
} 
```

也许递归？有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-24T22:11:23.617

似乎你可以在这里使用合并排序逻辑......

如果你有杯子 1,2,3,4,5,6,7,8...

首先做equals(1,2),equals(3,4),equals(5,6),equals(7,8)。此时杯子 1 和 2 的数量相同，杯子 3 和 4 的数量相同，依此类推。

接下来执行equals(1,3)、equals(2,4)、equals(5,7)、equals(6,8)。现在杯子 1,2,3,4 的数量相同，杯子 5,6,7,8 的数量相同。

最后做等于（1,5），等于（2,6），等于（3,7），等于（4,8）。请注意，您也可以使用 equals(1,4)、equals(1,5) 等，因为 1,2,3,4 的数量相同。在这一步之后，所有杯子的数量都一样！

如果您需要帮助在 java 中进行编码，请询问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T23:22:53.553

```
int qty=8;
for (int mask=1; mask<qty; mask+=mask)
   for (int k=0; k<qty/2; k++)
      equals(arr, k+(-mask&k), k+(-mask&k)+mask); 
```

# java - Eclipse，捆绑项目并单独运行它们

> ID：13546095
> 
> 赞同：1
> 
> 时间：2012-11-24T22:06:26.463
> 
> 标签：java, eclipse

eclipse中有没有办法让我可以捆绑我的独立java应用程序并将它们捆绑到一个解决方案中？

然后当我按下调试/运行按钮时，它会启动所有这些项目？（并且还构建它们）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:11:31.637

它不是直接的 eclipse 工具，但你可以看看[maven](http://maven.apache.org/)、[ant](http://ant.apache.org/)或不同的构建系统。那些与eclipse集成。

# unit-testing - 如何在 Github 中显示我的测试通过/失败？

> ID：13546097
> 
> 赞同：92
> 
> 时间：2012-11-24T22:06:39.630
> 
> 标签：unit-testing, github, continuous-integration

我在 github 上有一个包含大量单元测试的项目（对 node.js 使用 mocha）。

我想通过在每一页上显示这些测试通过/失败来炫耀。我注意到 Github 上的其他项目正在这样做。

![在此处输入图像描述](../Images/02602870d39b2e450b18b067dc2d76d6.png)

我一直找不到有关如何显示测试状态的任何文档。

*   如何让 Github 显示单元测试输出？
*   Github 运行测试还是需要连接外部 web 应用程序？
*   是否有免费的网络服务可以做到这一点（我的应用程序是开源的）？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-11-24T22:11:03.867

看看[Travis CI](https://travis-ci.org/)。您可以将它与 GitHub 一起使用。

他们有[关于使用 NodeJS 的文档](http://about.travis-ci.org/docs/user/languages/javascript-with-nodejs)

您看到的那些标记称为[“状态图像”，Travis 提供了 MarkDown，您可以将其插入](https://docs.travis-ci.com/user/status-images/)到项目的 README.md 文件中。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-26T23:51:59.033

请注意，自 2013 年 4 月 26 日起，您可以在[GitHub 存储库分支页面](https://github.com/blog/1484-check-the-status-of-your-branches)上查看[构建状态](https://github.com/blog/1227-commit-status-api)：

![在 GitHub 存储库分支上构建状态](../Images/192c13deb34383fe597850d3d5069d9e.png)

[提交状态 API](https://github.com/blog/1227-commit-status-api)允许您在其他地方使用它：请参阅“回购 [状态 API](http://developer.github.com/v3/repos/statuses/) ”。

从 2013 年 4 月 30 日开始，[提交状态的 API 端点](http://developer.github.com/v3/repos/statuses/#list-statuses-for-a-specific-ref)已扩展为允许分支**和标签名称，以及提交 SHA**。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-05-15T07:14:54.693

[CircleCI 状态徽章](https://circleci.com/docs/status-badges/)也是简单的图像，您可以`README.md`使用降价将其放入文件中。例如：

```
![Build Status](https://circleci.com/gh/<your github name>/<repo name>.png?circle-token=:circle-token) 
```

或者

```
![Build Status](https://circleci.com/gh/<your github name>/<repo name>.svg?style=shield&circle-token=:circle-token) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-24T22:11:12.617

是的，我很确定您的意思是 Jenkins 或[Travis-CI](https://travis-ci.org/)。他们在您的 github 帐户上工作！在每次提交时，都会执行测试。

# haskell - 有没有办法向 GHCI 询问特定实例的定义位置？

> ID：13546102
> 
> 赞同：4
> 
> 时间：2012-11-24T22:07:16.170
> 
> 标签：haskell, typeclass

例如，我可以查询“RWS 在哪里定义为 MonadState 的实例”？我希望得到一个像模块（版本）、源文件、行这样的答案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-24T22:19:03.180

```
λ> :info MonadState
...
instance (Monad m, Monoid w) => MonadState s (RWST r w s m)
  -- Defined in `Control.Monad.State.Class'
λ> :i RWS
type RWS r w s = RWST r w s Identity
        -- Defined in `Control.Monad.Trans.RWS.Lazy'
λ> :i RWST
...
instance MonadState s m => MonadState s (Reader.ReaderT r m)
  -- Defined in `Control.Monad.State.Class'
... 
```

您无法获取线路信息，它仅显示当前加载的模块，但这足以追踪实例。

# php - 如何使用按位运算符“添加”两个数字？

> ID：13546105
> 
> 赞同：-1
> 
> 时间：2012-11-24T22:07:26.530
> 
> 标签：php, bitwise-operators

我有两个数字，任何一个都可以是任何数字。我想把这些数字加在一起，但是以一种特殊的“二进制”方式。

所以假设我有以下两个数字：`7`和`9`。它们的二进制形式是：

```
0111 = 7
1001 = 9 
```

我需要一种以二进制形式将和加`7`在一起的方法`9`，但仅限于两位不同的地方。如果它们不同，则应将不同的位设置为 a `1`。

以`7`and为例，`9`我想要的结果是：

```
0111 = 7
1001 = 9
---- +
1111 
```

有没有办法在 PHP 中执行这样的操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T22:10:09.433

[位运算符](http://php.net/manual/en/language.operators.bitwise.php)：

```
$result = 7 | 9; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T22:14:21.523

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T22:26:53.573

您的描述要求按位异或，但您给出的示例演示了一个常规的按位或。在解决任何问题之前，您需要明确定义它。

# ruby-on-rails - 如果我在同一方法中使用变量和@variable，ruby 会感到困惑吗？

> ID：13546107
> 
> 赞同：0
> 
> 时间：2012-11-24T22:07:29.790
> 
> 标签：ruby-on-rails

如果我在同一方法中使用**变量**和**@** variable， ruby 会感到困惑吗？如果不是，如何在两个不同的操作方法中使用**变量**和**@variable**，但仍然在同一个控制器中？

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:13:34.970

No. The instance variable `@foo` and the local variable `foo` are entirely separate things. Whether it's good style to use both is very debatable, though.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:11:12.693

对这两个问题都没有。局部变量和实例变量不会相互冲突。

也就是说，出于可读性的原因，我建议更改其中一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T22:11:30.193

`variable`并且`@variable`是两个不同的变量名，所以没问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-24T22:11:56.713

不，你可以不用担心，因为它们是不同的。它们是两个不同的名称，因此您可以同时使用它们。至于两种不同的操作方法，您也可以这样做，因为它们不会同时加载。

# objective-c - 应用不可隐藏

> ID：13546114
> 
> 赞同：0
> 
> 时间：2012-11-24T22:08:14.050
> 
> 标签：objective-c, xcode, macos, cocoa, appkit

我知道可以使 NSWindow 不可隐藏。

但是是否也有可能，是否有一个属性来告诉编译器使整个应用程序不可隐藏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-27T01:24:34.293

对于单个窗口，您`-[NSWindow setCanHide:]`可以控制它是否可以隐藏。

如果您想完全禁用隐藏，您可能需要子类化以使用空实现`NSApplication`覆盖。`hide`我从来没有尝试过这个，但我看不出有任何理由它不会在没有麻烦的情况下工作。当然，您还应该从主菜单中删除“隐藏”选项。（请注意，仅仅这样做是不够的，因为您仍然会响应其他应用程序的发送`hideOtherApplications:`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T20:06:53.123

`Hide`我认为模拟这种行为的最简单方法是从菜单栏中删除操作，因为我没有看到执行此操作的属性。因为它控制`Command`+`H`快捷方式。但是，如果您有一个停靠图标，用户可以右键单击它并将其隐藏在那里。因此，您可以响应[`NSApplicationDelegate`'s](http://developer.apple.com/library/mac/#documentation/cocoa/reference/NSApplicationDelegate_Protocol/) `applicationWillHide:`和`applicationDidHide:`方法，然后再次显示您的应用程序。虽然我不认为这听起来像是一个好的用户体验。

# javascript - 如何让 SVG 显示的 javascript 生成的标题工具提示

> ID：13546118
> 
> 赞同：9
> 
> 时间：2012-11-24T22:08:35.890
> 
> 标签：javascript, svg, tooltip

我正在尝试获取 SVG 元素的工具提示。（在 Firefox 16.0.2 下测试）我尝试了这个小例子，它工作正常：

```
<svg xmlns="http://www.w3.org/2000/svg">
  <rect id="test" x="20" y="30" width="200" height="150">
  <title>Test tooltip</title>
  </rect>
</svg> 
```

但是，我需要从 javascript 生成工具提示，因为 SVG 也是从 javascript 生成的。因此，作为第一次测试，我尝试只生成工具提示：

```
<script type="text/javascript">
function test(text) {
  var title = document.createElement("title")
  title.text = text
  document.getElementById("test").appendChild(title)
}

</script>
</head>

<body onload="test('Test tooltip')">

<svg xmlns="http://www.w3.org/2000/svg">
  <rect id="test" x="20" y="30" width="200" height="150">
  </rect>
</svg> 
```

当我检查 Firefox 的结果时，标题对象看起来与从 HTML/SVG 生成的标题相同，除了**当我将鼠标悬停在矩形上时没有工具提示**！我究竟做错了什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-24T22:19:41.203

标题元素应该在 SVG 命名空间中，而不是默认命名空间中。因此，您应该使用`createElementNS()`. 此外，SVG 标题元素没有该`text`属性。改为使用`textContent`。所以，这应该工作：

```
<script type="text/javascript">
function test(text) {
  var title = document.createElementNS("http://www.w3.org/2000/svg","title")
  title.textContent = text
  document.getElementById("test").appendChild(title)
}

</script>
</head>

<body onload="test('Test tooltip')">

<svg xmlns="http://www.w3.org/2000/svg">
  <rect id="test" x="20" y="30" width="200" height="150">
  </rect>
</svg> 
```

# jquery - 选择文本输入上的 jQuery Mobile 边框

> ID：13546121
> 
> 赞同：2
> 
> 时间：2012-11-24T22:08:51.703
> 
> 标签：jquery, jquery-mobile

我在这个网站上看到了一个很酷的效果：http: [//bit.ly/USEOuH](http://bit.ly/USeOuH)

这里如果你用一些手机（我有android）打开它，如果你选择输入框，那么就没有边框了，只有文本框突出显示为蓝色。当我创建一个输入文本框时，当我选择文本框时，我的手机上会出现一个橙色边框。

我已经搜索了如何禁用此功能，但一无所获。是否有一些选项，如何禁用此橙色边框并使其像上面的站点一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:16:17.470

CSS [outline](http://www.w3schools.com/cssref/pr_outline.asp)属性应该对你有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:19:39.817

您必须编辑 JQM css 文件。根据选择的主题（a - f，或者更多，如果您使用主题生成器查找和编辑所选项目周围的边框轮廓。

如果没记错的话，每个主题只有一个属性。

知道了，搜索 css 文件并查找：.ui-btn-active，评论背景和背景图像，或将其更改为您喜欢的任何颜色。

[此外，关于您最近的帖子，您可以在这里](http://appcropolis.com/blog/advanced-customization-jquery-mobile-buttons/)找到很多好东西。它将向您展示如何对 JQM css 进行大量自定义。

# iphone - NSGenericException', reason: '只有当源控制器由 UINavigationController 的实例管理时，才能使用推送 segues

> ID：13546122
> 
> 赞同：52
> 
> 时间：2012-11-24T22:09:04.497
> 
> 标签：iphone, ios, uinavigationcontroller, segue

所以我正在制作一个带有 5 个视图控制器的应用程序，第一个嵌入在 UINavigationController 中，前 4 个视图控制器之间的 segue 工作正常。然而，引入第 5 个视图控制器打破了这一点，我得到了错误

```
Terminating app due to uncaught exception 'NSGenericException', reason: 'Push segues can only be used when the source controller is managed by an instance of UINavigationController.' 
```

我没有对第 5 个视图控制器做任何不同的事情，它只是一个带有图像视图和标签的标准 ViewController，我所有的 segue 都是由故事板中的 ctrl 拖动按钮调用的。有人知道是什么原因造成的吗？

谢谢

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2013-04-11T08:57:47.857

**将导航控制器添加到您的初始视图**

1.  选择初始视图
2.  转到**编辑器**-->**嵌入**-->**导航控制器。**

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-25T11:40:11.200

在 StoryBoard 中将 UINavigationcontroller 设置为初始视图控制器（初始场景）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-04-20T18:31:06.360

在我的情况下，当原始 VC 执行 segue 时，导航控制器正在转换并且已经改变了他可见的 VC。

我通过这样做解决了它：

```
if (self.navigationController.visibleViewController == self) {
    [self performSegueWithIdentifier:@"thankyou" sender:self];
} 
```

没有更多的崩溃。:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-23T21:32:51.313

这很可能是因为您从按钮或任何指向视图控制器而不是您的视图控制器继承的导航视图控制器的按钮中进行了推送。因此，您必须将 segue 指向导航控制器。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-26T00:08:50.710

您只需将导航控制器嵌入到您的源视图控制器中（一个初始视图，而不是您正在推动的视图）。这可以通过选择 Source View Controller 和 Go To Editor--> Embed In --> Navigation Controller 来完成。

如果你认为Navigation Controller已经做了Navigation Bar。只需选择 Navigation Controller ，在“Show the Attributes Inspector”中禁用 Shows Navigation Bar。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-06T15:36:04.223

在我的特定情况下，调用需要推送的视图子集的位置仅来自代码，并且无法通过 IB 连接。创建视图子集的原始项目是使用专用按钮启动的，因此是 IB'able。

没有 segue 是可配置的，因此任何推送都会导致此错误。

我的解决方案很简单：[self showViewController:targetViewController sender:self];

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-22T14:38:25.487

如果您的应用程序将导航控制器作为窗口的根视图控制器，请选择故事板文件，然后选择相应的导航控制器，在 Simulated Metrics 中选择 Is Initial View Controller 复选框。这对我有用。希望这可以帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-27T08:51:29.820

几分钟后我遇到了同样的问题，我可以解决它。

我已经删除了 segue 连接，并且我再次从一个视图连接到其他视图。这样就解决了问题。问题是我已经删除了视图，并且我对故事板场景中的视图进行了一些更改。重要的是您需要检查从一个视图到另一个视图的连接是否正常工作。

这可能对我希望的人有所帮助....

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-28T10:19:56.717

我遇到了同样的问题，我搜索了很多，但没有什么能帮助我。我尝试了很多方法。最后我找到了解决方案。我正在 xcode 5 中做一个项目，并使用故事板开发视图。我有 3 个屏幕，我的连接是..

view1 到 view2--> 推送

view2 到 view3--> 推送

view2 到 view1-->modal（这是我的错误，我们只需要使用推送）

这很好，但我在 view2 中放置了 bar button item(Back) 并且 segue 连接是 modal 。当我单击 view2 栏按钮时，它会正确重定向到 view1，但是当我尝试从 view1 转到 view2 时，我得到了同样的错误。因为如果您将推送 segue 类型从源视图提供给目标视图，您需要使用相同的推送 segue 从目标视图到源视图。

我希望它对某人有帮助..谢谢

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-06-20T22:35:59.397

我遇到了和你一样的问题。

我的问题是我正在调用一个 segue 的标识符，该标识符在我调用 segue 的类中无法访问。我通过从可以访问我正在使用的类的 ViewController 中直接向视图添加另一个 segue 来解决它。希望这会有所帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-01-19T09:40:16.617

如果您使用的是 UIViewController 类

然后检查 segue 标识符声明中的一件事，例如，您已设置

Identifier:MySegue1 Segue:Present Modally（如果您使用 UIViewController 类，请选择此选项）

演示文稿：默认转换：默认

并检查您的对象减速是否正确的另一件事

也许我的回答并不完全正确，但这就是我所知道的关于这个错误的所有信息。希望它能帮助你。

# plugins - Sublime Text 2 慢——禁用大文件的插件？

> ID：13546123
> 
> 赞同：19
> 
> 时间：2012-11-24T22:09:16.293
> 
> 标签：plugins, autocomplete, sublimetext2

Sublime Text 2 在大型文本文件（1000 行代码）上运行非常缓慢，我怀疑这是由于我安装的插件（如 SublimeCodeIntel），特别是自动完成。如何在 Sublime Text 2 中临时禁用插件，或者更好的是，仅在大文件上自动禁用它们？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-05T10:39:23.813

如果您想在插件使 sublime 变慢时禁用弹出窗口，您还可以将以下内容附加到设置文件中（尽管我知道这并不是您想要的，它可能对未来的 Google 员工有用）：

```
"detect_slow_plugins": false 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-11-25T05:10:33.030

找到了——如果你按下 Command-Shift-P（在 Mac 上），会有一个“Package Control: Disable Package”选项（以及再次启用包的相应选项）。

# c# - 可以将客户端生成的 guid 直接翻译到服务器端、存储它们等吗？没有更高的碰撞风险？

> ID：13546131
> 
> 赞同：0
> 
> 时间：2012-11-24T22:10:25.860
> 
> 标签：c#, javascript, guid

我写了一个客户端应用程序。我现在正在为其创建一个后端来保存数据，但对 GUID 实现感到好奇。

在客户端，我使用以下 JavaScript 生成具有唯一 ID 的 Song 对象。它基于[这个 StackOverflow 帖子](https://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript)。

```
//Based off of: https://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
generateGuid: function () {
    var startStringFormat = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';

    var guid = startStringFormat.replace(/[xy]/g, function (c) {
        var r = Math.floor(Math.random() * 16);

        var v = c === 'x' ? r : (r & 0x3 | 0x8);

        return v.toString(16);
    });

    return guid;
}, 
```

现在，我在 C# 中定义一个类来表示我的 Song 对象：

```
public class Song
{
    public virtual Guid Id { get; set; }
    public virtual Guid PlaylistId { get; set; }
    public virtual int VideoId { get; set; }
    public virtual string Url { get; set; }
    public virtual string Title { get; set; }
    public virtual int Duration { get; set; }
} 
```

这样做让我想知道交互 Guid 对象的含义。我可以只获取我在 localStorage 中的所有 Song 对象并直接翻译它们的 Guid 吗？我应该重新生成所有这些吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:14:48.153

由于 Guid 是唯一的（如果生成正确），您可以重复使用现有 ID。不过要小心，因为恶意客户端当然可以发送任何 ID，而不仅仅是随机的。因此，客户很容易在他自己的 Guid 之间引发冲突。如果所有善意的客户端随机生成他们的 Guid，恶意客户端就不会与它们发生冲突。从这个意义上说，Guid 就像一个 128 位密码，非常强大。

另一方面，生成这些 Guid 的方式不是使用加密安全的随机数生成器。所以我想你应该通过向它发出 AJAX 调用来让服务器为你提供一个安全的 Guid。

显示的生成算法对我来说看起来很时髦。您不需要维护任何特定的模式。您可以只生成一个由 100% 随机组件组成的 Guid。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T22:41:53.140

由于您的算法基于 Math.random 生成的伪随机数，并且由于 [随机数生成器是从当前时间播种的](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/random)，因此似乎存在发生冲突的风险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:17:50.877

似乎在某些情况下，您实际上可能会很有可能使用此方法发生冲突。检查这个问题：[在 JavaScript 中生成 UUID 时发生冲突？](https://stackoverflow.com/questions/6906916/collisions-when-generating-uuids-in-javascript)

# android - 扩展视图，onMeasure()，如何设置/获取边距

> ID：13546136
> 
> 赞同：3
> 
> 时间：2012-11-24T22:11:05.393
> 
> 标签：android, margin

**当您在onMeasure**方法中创建自定义组件时，可以指定大小甚至缩进（通过使用**this.getPaddingTop()**等）。**问题是onMeasure**的计算方法是否得到值“ **margin** ...”？鉴于不欢迎在 onMeasure 中使用“this.getLayoutParams ()”方法 - 请给出正确的规范解决方案来设置/获取“ **margin** ...”的值。

例子：

```
 @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        int wSpecMode = MeasureSpec.getMode( widthMeasureSpec );
        int wSpecSize = MeasureSpec.getSize( widthMeasureSpec );
        int hSpecMode = MeasureSpec.getMode( heightMeasureSpec );
        int hSpecSize = MeasureSpec.getSize( heightMeasureSpec );
        int lMargin = ((RelativeLayout.LayoutParams)this.getLayoutParams()).leftMargin;
        int rMargin = ((RelativeLayout.LayoutParams)this.getLayoutParams()).rightMargin;
        int tMargin = ((RelativeLayout.LayoutParams)this.getLayoutParams()).topMargin;
        int bMargin = ((RelativeLayout.LayoutParams)this.getLayoutParams()).bottomMargin;
        int wSize = 256, hSize = 256;

        if (wSpecMode == MeasureSpec.EXACTLY) {
            wSize = wSpecSize;
        } else {
            wSize += this.getPaddingLeft() + this.getPaddingRight() + lMargin + rMargin;

            if (wSpecMode == MeasureSpec.AT_MOST) {
                wSize = Math.min(wSize, wSpecSize);
            }
        }

        if (hSpecMode == MeasureSpec.EXACTLY) {
            hSize = hSpecSize;
        } else {
            hSize += this.getPaddingTop() + this.getPaddingBottom() + tMargin + bMargin;

            if (hSpecMode == MeasureSpec.AT_MOST) {
                hSize = Math.min(hSize, hSpecSize);
            }
        }
        this.setMeasuredDimension( wSize, hSize );
    } 
```

在这个例子中，计算的均值可以，我们已经考虑了边距和填充，但是获取边距的方法不太优雅。

此外，这种方法区域组件在相同的边距上变得更多，并且通过**getMeasuredWidth()**和**getMeasuredHeight()**获得尺寸- 计算不正确。

# erlang - 如何从linux命令行在模块中运行带参数的函数

> ID：13546137
> 
> 赞同：0
> 
> 时间：2012-11-24T22:11:09.600
> 
> 标签：erlang

我有一个以模块 mymodule 中的两个参数开头的函数。如何从命令行运行此功能。

我试试这个：

> erl -name myname@myserver.com -s mymodule 开始 5 10

但它会引发错误：{“init terminating in do_boot”,{undef,[{mymodule,start,[['5','10']]},{init,start_it,1},{init,start_em,1} ]}}

我希望能够从 bash 文件中运行此功能

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T00:46:37.713

我认为它希望 start 函数的数量为 1，因此在这种情况下，它试图调用 module:start(['5','10'])。因此，更改您的启动函数以接受 [arg1,arg2] 中的 2 个参数列表。此外，请查看有关 -run 和 -s 标志的文档。-s 将参数作为原子传递，而 -run 将它们作为字符串传递

> -run Mod [Func [Arg1, Arg2, ...]](init flag) 使 init 调用指定的函数。Func 默认启动。如果没有提供参数，则假定该函数的参数为​​ 0。否则，假定它的参数为 1，将列表 [Arg1,Arg2,...] 作为参数。所有参数都作为字符串传递。请参见初始化 (3)。

# tree - LISP 编程 - 计算树节点的函数

> ID：13546145
> 
> 赞同：-1
> 
> 时间：2012-11-24T22:11:34.577
> 
> 标签：tree, lisp, eval, common-lisp

我最近开始学习 lisp 并完成了一些可供我使用的简单练习，不幸的是我被卡住了，在花了几个小时之后，似乎我似乎没有更接近一个体面的解决方案。

我正在尝试生成一个函数，该函数将表达式“树”作为其参数，并返回具有相关计算值的树来代替运算符。

树的外观示例如下：`(* (+ 10 (* 4 9)) (- 6 10))`
函数应返回：`(-184 (46 10 (36 4 9)) (-4 6 10))`

我已经尝试了各种方法，但没有任何效果。我创建了一些可行但在编码风格方面非常糟糕的东西，我真的迷失了。

```
(defun evalTree (node &optional n)
  (when node
    (rplaca node (eval node))
    (setq n (first (rest node)))
    (rplaca n (eval n))
    (setq n (first (rest (rest node))))
    (rplaca n (eval n))
    (setq n (first (rest (rest (first (rest node))))))
    (rplaca n (eval n)))
  (format t "node=~a n=~a~%" node n)
  node) 
```

我认为我的解决方案应该使用 apply 函数或 eval 函数，但我只是不确定如何在树上正确使用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:41:30.693

```
(defun eval-tree (tree)
  (flet ((arg (a)
           (if (atom a) a (first a))))
    (if (atom tree)
        tree
      (destructuring-bind (op a b)
          tree
        (let ((a1 (eval-tree a))
              (b1 (eval-tree b)))
          (list (funcall op (arg a1) (arg b1)) a1 b1)))))) 
```

# statistics - 加权数据的百分位数计算

> ID：13546146
> 
> 赞同：2
> 
> 时间：2012-11-24T22:11:54.170
> 
> 标签：statistics, weighted, percentile

我一直在努力寻找一种方法来计算向量 X 的百分位数，给定权重 W 在 W 中连续为零。也就是说，当 W 的一个元素趋于零时，我希望百分位数计算的结果与 X 的相应值没有包含在初始向量中一样。任何人都可以建议尊重此属性的加权百分位数算法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T18:42:42.900

您可以通过模拟解决此问题，以获得预期正确的答案。

将权重重新归一化以总和为 1，然后以概率 W 从 X 中抽取 n 个替换样本。计算 n 个样本的百分位数，您就完成了。随着 max(W)/min(W) 的增加，您将需要更多的 n，但即使在现代机器上绘制一千万个样本也很快。

# android - 建议：在 Android 上实现 SlidingMenu (J. Feinstein)

> ID：13546148
> 
> 赞同：15
> 
> 时间：2012-11-24T22:12:19.693
> 
> 标签：android, android-sliding

我在为 Android 实现 SlidingMenu 库（来自 Jeremy Feinstein ... 链接是 dowm）时遇到问题*（说真的，我不知道该怎么做：D） 。*有没有人可以帮助我完成实施过程？我正在开始使用 Android 程序员，所以有时我需要帮助 :)

**图书馆 - [https://github.com/jfeinstein10/SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)**

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-05-18T22:39:08.483

我自己使用了 Feinstein 库，并决定尽可能多地创建具有灵活和可重用实现的示例应用程序。

请查看[GitHub 上的源代码](https://github.com/baruckis/Android-SlidingMenuImplementation)。

[直接下载app](https://play.google.com/store/apps/details?id=com.baruckis.SlidingMenuImplementation)到设备上试试。

这里的滑动菜单，作为它的内容，使用列表片段。我做了两种方法。一，当列表数据填充从 XML 文件加载的数据时。其次，当数据从单独的类中填充时。

我添加了许多评论以更容易地抓住这个想法。我希望它会有所帮助！;)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-24T22:20:53.747

创建一个`Activity`which extends `SlidingActivity`，`Fragment`为您的菜单创建一个并在方法中`onCreate`添加：

```
FrameLayout frameLayout = new FrameLayout(this);
frameLayout.setId(ID_MENUFRAME);
setBehindContentView(frameLayout);
FragmentTransaction ft = getFragmentManager().beginTransaction();
MenuFragment menuFragment = new MenuFragment();
ft.replace(ID_MENUFRAME, menuFragment);
ft.commit(); 
```

其中 ID_MENUFRAME 是一个 int，它不是您的布局中存在的 id（我将其设置为 1）。
然后，如果要打开或关闭菜单，请调用：

```
getSlidingMenu().toggle(); 
```

您可以像使用任何其他活动一样使用您的活动。
请注意，您必须以`SlidingMenu`编程方式自定义您的。例如 ：

```
sm.setBehindOffsetRes(R.dimen.slidingMenu_behindOffset);
sm.setShadowWidthRes(R.dimen.slidingMenu_shadowWidth);
sm.setShadowDrawable(R.drawable.slidingmenu_shadow); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-10T15:39:09.667

那里有一个示例项目：[https ://github.com/jfeinstein10/SlidingMenu/tree/master/example](https://github.com/jfeinstein10/SlidingMenu/tree/master/example)

只需将其导入 Eclipse。

# ios - 为注释创建自定义标注

> ID：13546149
> 
> 赞同：2
> 
> 时间：2012-11-24T22:12:24.157
> 
> 标签：ios, xcode, uiview, annotations

在 iOS6 中，我正在尝试为注释创建自定义标注，其中包含图像、标题、描述等细节。我在这里看到了相关的帖子，但不是我想要的。在我的应用程序中，当您选择注释时，您可以选择 4 个按钮。现在我正在尝试为第四个按钮创建选项，这是详细的标注。

我创建了一个代表自定义标注的 UIView 类。

编辑：

在 Live2Enjoy7 的帮助下，我修改了我的代码，如下所示。

BuildingViewController.m

```
- (void)MapMenu:(MapMenu *)menu didSelectButton:(NSInteger)index{

    if (index == 3) {

        image = [UIImage imageWithData: [NSData dataWithContentsOfURL:url]];
        _buildingShowCallout = YES;
        [parentView removeAnnotation:self];
        [parentView addAnnotation:self];
    }
} 
```

如果用户按下按钮，此方法会创建新图像（使用 url 链接），设置 _buildingShowCallout = YES，最后删除并再次添加所选注释以使 viewForAnnotation 方法起作用。

在我的 MapViewController.m

```
- (MKAnnotationView *)mapView:(MKMapView *)_mapView viewForAnnotation:(id<MKAnnotation>)annotation{

    if ([annotation isKindOfClass:[MKUserLocation class]]) {
        return nil;
    }

    static NSString *identifier = @"MyAnnotation";
    MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [_mapView dequeueReusableAnnotationViewWithIdentifier:identifier];

    BuildingViewController* building = (BuildingViewController*) annotation;

    // If a new annotation is created
    if (annotationView == nil) {

        annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:building reuseIdentifier:identifier];

        if (building.buildingShowCallout) {// Create the custom callout
            BuildingCallOut* buildingCallout = [[BuildingCallOut alloc]initWithFrame:CGRectMake(0, 0, 200, 150)];
            [buildingCallout showCallout:building];
            [annotationView addSubview:buildingCallout];//add the new callout as subview of the selected annotation.
        }

    } else{

        annotationView.annotation = annotation;

        if (building.buildingShowCallout) {// Create the custom callout
            BuildingCallOut* buildingCallout = [[BuildingCallOut alloc]initWithFrame:CGRectMake(0, 0, 200, 150)];
            [buildingCallout showCallout:building];
            [annotationView addSubview:buildingCallout];//add the new callout as subview of the selected annotation.
        }
    }

    return annotationView;
} 
```

这很好，但现在我有一个新问题。

1.  如果您选择查看一个注解的标注，然后选择查看另一注解的标注，则前一个标注会保留在地图上。我该如何解决这个问题？

屏幕截图！[在此处输入图像描述][1]

正如你所看到的......当我在底部调用新的标注时，屏幕顶部的前一个标注仍然存在。努力寻找将“消失”线放在哪里。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:39:10.010

我猜你的 BuildingViewController 是你的 MapViewController。

您想在标题中将其声明为 MKMapViewDelegate。这将使您可以访问几种方法，这些方法将允许您更改出现的注释视图，甚至是图钉。

首先，如果您还没有导入 MapKit/MapKit.h 和 UIKit/UIKit.h。

其次，声明您的 BuildingViewController 符合 MKMapViewDelegate 协议（如上所述）。

第三，在 ViewDidLoad 中将 BuildingViewController 声明为地图视图的委托，例如：

```
self.mapView.delegate=self; //assuming that the you have a MKMapView named MapView in your layout 
```

四、实现这些协议方法：

```
-(MKAnnotationView*)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation;

-(void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view; 
```

第一种方法允许您设置左右调出配件以及修改一堆其他东西（这是您想要做CGRectMakes的地方）。

在第二种方法中，您决定在注释视图中实际显示哪些数据。

在文档中搜索 MKMapViewDelegate -->[这里](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html)

# c++ - 访问 cv::Mat 数据的 OpenCV 错误

> ID：13546151
> 
> 赞同：3
> 
> 时间：2012-11-24T22:12:32.157
> 
> 标签：c++, opencv, mat

对于我与允许类型一起使用的任何 Mat 类型，当我尝试进行一些赋值或写入流等时，我会收到如下错误。它发生在 MSVC++ 2010 express 编译器上，它不会发生在 gnu g++ 编译器上。

错误用法示例：

```
Mat M = Mat::zeros( image.size(),  DataType<int>::type  );

std::cout << M.at<int>( 0,0 ) << std::endl; // error

// OR

int x = M.at<int>( 0,0 ); // error 
```

这两个错误一起触发：

在弹出窗口上

```
Unhandled exception at <some hex adress> in test.exe:Microsoft C++ exception: cv:xception at memory location <some hex adress> 
```

在控制台窗口上

```
OpenCV Error: Assertion failed ... \mat.hpp, line 537 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-24T22:15:33.453

Make the matrix data type `CV_16U`.

The `.at` accessor functions are very meticulous, requiring very exact data types. Some compilers ignore these issues, while others catch it early.

Rather than referencing the elements with `matrix.at<int>(row, col)`, `CV_16U` makes reference to the `unsigned short` data type. Therefore, the elements can be accessed with `matrix.at<unsigned short>(row, col)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:01:48.003

我不相信 openCV 有一个 int 数据类型的图像。
整数类型一般为CV_16s，即短16bit，所以使用

# css - 不服从宽度：可能的解决方案？

> ID：13546154
> 
> 赞同：0
> 
> 时间：2012-11-24T22:12:45.223
> 
> 标签：css, html

我有一个相当奇怪的行为`<nav>`： ![显示宽度为 1000 像素，而我将其设置为 200 像素](../Images/ec23b705b7fdb27faa2ed33d3730baed.png)

我的html很简单：

```
<div class="rounded screen defaultBg">
    <header>
        <img src="/img/logo-temp.png" alt="logo" width="185" height="88"/>
    </header>

    <nav>
        Nav<br/>
        Nav<br/>   <!--Placeholder-->
        Nav<br/>
        Nav<br/>
        Nav<br/>
        Nav<br/>
        Nav<br/>
        Nav<br/>
        Nav<br/>
        Nav
    </nav>

    <div id="content">
        ...
    </div>
    <footer>...</footer>
</div> 
```

相关的CSS是

```
nav {
    display:table-cell;
    width:200px;
}

#content {
    display:table-cell;
    width:80%;
}

.rounded {
    -moz-border-radius:5px;
    -webkit-border-radius:5px;
    border-radius:5px;
}

.screen {
    padding:3px;
    display:table;
    width:1000px;
    margin:auto;
}
.screen header, .screen footer {
    display:table-row;
    text-align:center;
} 
```

我发现的唯一解决方法是在 中指定`.screen`宽度`%`，但是，我的布局将特定于几个屏幕尺寸，因此我需要一个精确的像素值。谁能提供一些有关如何解决此问题的见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:33:17.380

发现由于某种原因，解决此问题的唯一方法是将页眉和页脚放在`div class="screen"`容器之外。现在看起来像预期的那样。

# javascript - jQuery 定位需要

> ID：13546155
> 
> 赞同：5
> 
> 时间：2012-11-24T22:12:49.970
> 
> 标签：javascript, jquery, html

我可以在 jQuery 中打开这样的对话框：

```
position: {
    of: $( "#Parent" ), 
    my: "left top", 
    at: "left top"
} 
```

这在 FF 中可以正常工作，但在 IE9 中，它仅在 doctype 设置为`<!DOCTYPE HTML>`而不是其他类似以下的情况下才有效：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
```

似乎所有其他文档类型都将 IE 置于怪癖模式。

问题是使用`<!DOCTYPE HTML>`混乱的 ActiveWidgets；网格不会显示在任何浏览器中。

我可以在没有`<!DOCTYPE HTML>`IE 的情况下使用 jQuery 定位吗？或者我可以让 ActiveWidgets 使用这个推荐的 DOCTYPE 吗？

* * *

感谢您的回答

花了一天时间用 jqwidgets 替换了 activeWidgets 网格，结果我终于不喜欢了。我使用 PHP 模板从 ini 文本文件生成动态网格。

我最终将我的文档分成 2 个 iframe。一个带对话框，另一个带网格

这样我不能将对话框移到框架外，但它可以工作

这是一个很棒的社区，帮助我设计了很棒的 Intranet 网站，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T00:51:30.470

**tldr; 使用*有效/公认*的DOCTYPE 来确保非 Quirks 模式**

[W3C 信息参考中列出](http://www.w3.org/QA/2002/04/valid-dtd-list.html) 的 HTML4 过渡 DOCTYPE*包括*DTD URI：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd"> 
```

[根据Quirks 模式](http://en.wikipedia.org/wiki/Quirks_mode)维基百科文章中的模式矩阵列表`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">`（没有系统标识符） ，IE8+*将*进入 Quirks 模式。哎呀。

（请注意，即使使用过渡系统标识符，它仍然处于*几乎标准*模式！最好使用 Strict DTD 和/或 HTML5 DOCTYPE，以便最近的浏览器将在标准模式下运行。）

有关一些解决方案，请参阅 Quentin 的评论 -*在*修复 DOCTYPE 以确保几乎标准/标准模式之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:29:35.037

您可以使用头中的此元标记将 MSIE 强制为可用的最新版本>：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

# c# - 如何在 Windows Store XAML/C# 应用程序中播放音频剪辑

> ID：13546162
> 
> 赞同：2
> 
> 时间：2012-11-24T22:13:47.927
> 
> 标签：c#, xaml, windows-store-apps

我试图弄清楚如何播放作为我的应用程序的一部分捆绑的 MP3 文件，即我不想使用文件选择器来选择我想要播放的文件，该文件将在我的项目中。所以每次我按下按钮时，我都希望文件自动播放，我不需要任何播放/暂停/停止控件，我该如何实现呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T03:35:20.213

我是这样做的。将 wav 添加到我的项目中，将 MediaElement 控件拖到我的 XAML 页面上。

```
<MediaElement x:Name="playSound" Source="Assets/mysound.wav" AutoPlay="False" Height="0" Width="0"  /> 
```

然后在我想玩的事件处理程序后面的代码中

```
playSound.Play(); 
```

# prolog - Definite clause grammar

> ID：13546163
> 
> 赞同：2
> 
> 时间：2012-11-24T22:13:49.233
> 
> 标签：prolog, dcg

I am trying to write a definite class grammar that takes a singleton list and determines if it is a 1 or 0.It keeps returning false and i can't figure out why it is not working.

```
zeroorone-->validnum.
validnum-->[0].
validnum-->[1]. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:41:29.797

您发布的语言匹配

0

和

1

但不是

[0, 0, 1, 1, 0, 1, 1, 1, 0, 0]

那是你所期望的吗？

短语（zeroorone，X）。应该回应

X = [0]。X = [1]。

现在，您也可能混淆了“代码”样式的 Prolog 字符串

"100" 和 [1,0,0] 前者是 ['1', '0', '0']

您的代码失败的示例将很有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-29T00:09:19.960

安妮普是对的。这适用于 SWI-Prolog。

我将您的代码放入文件 a.pl 并使用咨询（a）加载它。然后我可以运行以下。

```
zeroorone([0], []).
true .

zeroorone([1], []).
true . 
```

正如 Anniepoo 所说，在您按 Enter 后运行以下工作，然后按空格来获得第二个答案

```
phrase(zeroorone, X).
X = [ 0 ] ;
X = [ 1 ]. 
```

但是，正如她所说，除了两个列表 [0] 和 [1] 之外，它对任何东西都不起作用。

例如

```
zeroorone([1,0,0], []).
false. 
```

为了获得更好的答案，您可能需要指定实际需要的内容。

# jquery - 在 jquery 中选择特定的类

> ID：13546166
> 
> 赞同：0
> 
> 时间：2012-11-24T22:14:21.577
> 
> 标签：jquery

我想知道一旦屏幕尺寸低于 1000px 使用 jquery，我将如何选择此类并将其更改为 span12

```
<div class="span4 minus65"> 
```

我在用

```
$(window).resize(function(){
    if($(this).outerWidth() < 1000){
        $('.span4 minus65').attr('class',"span12");
    }

}); 
```

但是当屏幕宽度低于 1000px 时没有任何变化

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:16:37.073

用于选择具有多个类的 div

```
$('.span4.minus65') 
```

并替换所有类：

```
$('.span4.minus65').removeClass().addClass('span12'); 
```

或只更换一个班级

```
$('.span4.minus65').removeClass('span4').addClass('span12'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:21:40.503

听起来你想使用[`addClass`](http://api.jquery.com/addClass/)and[`removeClass`](http://api.jquery.com/removeClass/)功能

例如

```
$(window).resize(function(){
    if($(this).outerWidth() < 1000){
        $('.span4 minus65').removeClass('span4').addClass('span12');
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T22:22:17.007

如果你不能使用媒体查询，你应该使用“addClass”和“removeClass”

```
$(el).addClass('span12').removeClass('span4'); 
```

根据浏览器的不同，“resize”有时会触发，有时会触发太频繁。您应该使用您在“resize”事件中使用的函数并定期触发它，如下所示：

```
var resizeFunc = function(){
    //add/remove classes
};

//"fix" the sizing even if "resize" doesn't fire.
setInterval(resizeFunc(), 1000);

jQuery(document).resize(resizeFunc); 
```

此外，调整大小会触发......很多。您还可以“限制”它，使其每几百毫秒不会触发一次以上。

您可能应该考虑为此使用媒体查询（在较新版本的 IE 和所有其他现代浏览器中都有很好的支持：

[http://caniuse.com/#search=media%20queries](http://caniuse.com/#search=media%20queries)

# jakarta-ee - Service facades, detached entities and eager fetching

> ID：13546167
> 
> 赞同：1
> 
> 时间：2012-11-24T22:14:24.517
> 
> 标签：jakarta-ee, jpa, entity, stateless-session-bean, facade

Service facades are usually implemented as stateless session beans, which means that any entities they possibly return will be detached immediately. This makes me think that any entity returned as a result of a service facade business method should eagerly fetch all of its internals, as in the absence of eager fetching, its internals cannot be accessed by service clients. I want to know whether I'm right on this and whether there is possibly any other way which may be more appropriate in certain circumstances.

Thank you

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T14:43:38.167

是的，您基本上是对的，一旦实体从创建它们或从数据库中获取它们的会话 bean 方法返回，它们就会被分离。这意味着在客户端层无法访问延迟加载的相关实体。根据我的工作经验，我可以说有两种常见的情况。第一个是业务层中的数据模型，用实体和企业 bean 实现，与客户端层中使用的数据模型完全不同；在这种情况下，最好的解决方案是创建所谓的 DTO（数据传输对象），即带有 get 和 set 方法的普通 java 对象，并使用它们在两层之间传输数据。这种方法的主要缺点是编写 DTO 可能会很长，无聊且容易出错的任务，而且它们要么不实现业务逻辑，要么是纯 bean，要么逻辑必须在两个层中复制。如果两层中的数据模型相同并且一个会重用行为，则尤其如此。这导致我们采用第二种方法，即构建一个独特的数据模型，其中包含要在业务层和客户端层共享的实体，具有更少的代码编写和逻辑重用的明显优势。但是，为了将分离的实体从一层传递到另一层，您只有两个选择：要么将所有关系声明为急切，有可能在内存中加载太多对象，尤其是当您的实体紧密互连时，或者让它们懒惰并编写您的外观方法要小心，以便在返回之前加载所有需要的字段。我'

# html - Make the page scrollable in Windows 8 app

> ID：13546168
> 
> 赞同：0
> 
> 时间：2012-11-24T22:14:24.970
> 
> 标签：html, css, windows-8, winjs

I can't find anything similar to a SIMPLE scrollable body for Windows 8 app in Javascript.

I don't want to use listView. I think it's only when you have boxes of elements right ?

I have this simple app (converting timestamp) ![windows 8 simulator](../Images/b5c632b3fa20937eb09b84e1f5e16fbb.png)

You can see that there are other input fields and other elements at the bottom of the tablet but I cannot scroll to see them !

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T22:22:43.403

好吧，实际上这是一个非常愚蠢的问题。我发现它正在阅读一些 Windows 8 示例。我只需要在身体上添加 css

```
overflow:auto; 
```

# javascript - How to implement 2 submit buttons for 1 form. Both should trigger HTML5 validation, but only one should actually submit

> ID：13546172
> 
> 赞同：0
> 
> 时间：2012-11-24T22:14:53.113
> 
> 标签：javascript, jquery, html, validation, form-submit

Ok, so various forms of this question have been asked, but I can't find enough information to make my particular case work, so here is the context of what I'm trying to do:

I have a form which has half of its elements displayed on the page like normal, and the other half of its elements are displayed in a modal (on the same page, but starts out hidden and with all elements pre-populated with info off of a DB, so they are valid by default). This form also has 2 submit buttons, one on the page at the bottom of the 1st half of elements, and another on the modal itself. When the first submit button is clicked, I want the form to perform regular native HTML5 validation (yes, it will have to perform this on the entire form, including those fields in the modal, however, as I said, they are pre-populated off of a DB so they will be valid by default).

However, once all elements on the page itself are valid, I DON'T want the form to submit yet. Instead, I want to display the Modal with the other half of the elements (again, already pre-populated with info from the DB - I want the user to confirm that info). When the submit button contained on the modal is clicked, I want it to perform the same regular HTML5 validation and then actually submit the form (as long as it's all still valid).

So, I found the following jquery in another answer which allows the browser to perform the HTML5 validation on the form, but blocks the submit event:

```
 $(function() {
      $('#form').submit(function(event){

        // cancels the form submission
        event.preventDefault();

      });
    }); 
```

My problem is this, I only want the above jquery to run on the first submit button's click, and not the second button's click. If there is a way to do this, I think my problem will be solved. Again, the reason I'm doing this is because I want the user to confirm the information that is displayed on the modal which pops up before the entire form is completely submitted...I know I could mitigate this by not using a modal at all and having everything on the one page, but I really want to use the modal. Sorry if this question is misplaced, has already been answered, confusing, or anything else. If it is confusing or you need more explanation/code let me know and I will edit the question.

Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:21:42.310

jQuery 提供了`.one()`完全做到这一点的方法。

```
$('#form').one( "submit", function(event){

    event.preventDefault();

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:20:22.537

因此，要按照您的要求进行操作，这应该可以解决问题：

```
 $(function() {
  //track whether the form has been submitted, define here so it persists across submit events
  var submitted = false;
  $('#form').submit(function(event){
    // the outer function's variables are available in the inner function
    if (!submitted) {
      event.preventDefault();
      submitted = true;
    }
  });
}); 
```

但是，我真的不确定这是实现最终目标的最佳方式。更好的是使用 javascript 验证（例如[jQuery 验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)），在单击按钮（不是提交）后验证第一部分，然后跟踪表单的初始部分是否*有效*，而不是它是否已经提交，然后决定显示模态。

即做这样的事情（伪代码，不会按原样工作，只是为了说明方法）：

```
 $(function() {
  $('#form').on('click','button.first', function(e){
    //check that the first part of the form is valid when the `<button class="first">` is clicked, if it is, show the modal:
    var firstSectionValid = $('#form').find('#first-section').validate();
    if (!firstSectionValid) {
      showModal();
    }
  });
}); 
```

然后在表单的模态部分只有一个提交按钮。

# php - How to fix close to json with php

> ID：13546175
> 
> 赞同：1
> 
> 时间：2012-11-24T22:15:20.880
> 
> 标签：php, jquery, json

A follow up to: [https://stackoverflow.com/posts/13303108](https://stackoverflow.com/posts/13303108) where all the responses suggested JS

Is there a function of some sort to take the following and fix it with php when it occurs so that the output will be vaild json? front end (js) is not an option. The issue seems to be the number leading into the array not being quoted or something to that end. I cannot fix the source either.

```
 {
    29646191: [
        "https://www.facebook.com/RobertScoble/posts/480030845352725",
        "https://sphotos-a.xx.fbcdn.net/hphotos-prn1/s480x480/546943_10151235934049655_1771118951_n.jpg",
        "Today I tried... | Facebook",
        "Robert Scoble wrote: Today I tried something. I paid $49 and... Join Facebook to connect with Robert Scoble and others you may know.",
        null,
        [
            "//images3-focus-opensocial.googleusercontent.com/gadgets/proxy?url\u003dhttps://sphotos-a.xx.fbcdn.net/hphotos-prn1/s480x480/546943_10151235934049655_1771118951_n.jpg\u0026container\u003dfocus\u0026gadget\u003da\u0026rewriteMime\u003dimage/*\u0026refresh\u003d31536000\u0026resize_h\u003d150\u0026resize_w\u003d150\u0026no_expand\u003d1",
            150,
            150,
            null,
            null,
            null,
            null,
            null,
            [
                3,
                "https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?url\u003dhttps://sphotos-a.xx.fbcdn.net/hphotos-prn1/s480x480/546943_10151235934049655_1771118951_n.jpg\u0026container\u003dfocus\u0026gadget\u003dhttps://plus.google.com\u0026rewriteMime\u003dimage/*\u0026resize_h\u003d800\u0026resize_w\u003d800\u0026no_expand\u003d1"
            ]
        ],
        "//s2.googleusercontent.com/s2/favicons?domain\u003dwww.facebook.com",
        [],
        null,
        []
    ]
} 
```

Edit: the very base functions do not work here (json encode/decode). It had to have been taken from a source and run through many things for php to even start to be able to handle it.

To wit, this is the code that handles it before this

```
 $instring = false;
    $inescape = false;
    $lastchar = '';
    $output = "";
    for ( $x=0; $x<strlen( $sourcejson ); $x++ ) {

        $char = substr( $sourcejson, $x, 1 );

        //toss unnecessary whitespace
        if ( !$instring && ( preg_match( '/\s/', $char ) ) ) {
            continue;
        }

        //handle strings
        if ( $instring ) {
            if ( $inescape ) {
                $output .= $char;
                $inescape = false;
            } else if ( $char == '\\' ) {
                $output .= $char;
                $inescape = true;
            } else if ( $char == '"' ) {
                $output .= $char;
                $instring = false;
            } else {
                $output .= $char;
            }
            $lastchar = $char;
            continue;
        }

        switch ( $char ) {

            case '"':
                $output .= $char;
                $instring = true;
                break;

            case ',':
                if ( $lastchar == ',' || $lastchar == '[' || $lastchar == '{' ) { 
                    $output .= 'null';
                }
                $output .= $char;
                break;

            case ']':
            case '}':
                if ( $lastchar == ',' ) { 
                    $output .= 'null';
                }
                $output .= $char;
                break;

            default:
                $output .= $char;
                break;
        }
        $lastchar = $char;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:17:39.100

Do not try to encode/decode json on your own.

To encode json from a PHP array:

```
echo json_encode($data); 
```

To decode json:

```
var_dump(json_decode($data)); 
```

In your case, you need to convert the INT to a String. Try this:

```
# this solution requires PHP >= 5.4.0
var_dump(json_decode($data, false, 512, JSON_BIGINT_AS_STRING)); 
```

See [**`json_decode()`**](http://php.net/manual/en/function.json-decode.php) for more information

* * *

## EDIT

If this still isn't working for you, I'd highly consider get valid JSON in JavaScript before processing it with your PHP script.

```
// sadly this is the only solution i can find; luckily, your json is coming from a trusted source (Google), so eval shouldn't be an issue;
jsonObject = eval('(' + invalidJsonString + ')');

// conver the object back to json string
validJsonString = JSON.stringify(jsonObject);

// yay, valid json
console.log(validJsonString); 
```

[**See it working on jsfiddle**](http://jsfiddle.net/8XBnX/)

## Disclaimer

Normally you'd use `jQuery.parseJSON(jsonString)` or `JSON.parse(jsonString`, but these are giving a parse error with that int as a key in the object :(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:17:21.080

you should use the `json_decode();`

try this

```
$data[] = //some json;
 var_dump(json_decode($data)); 
```

then you can use

```
json_last_error() 
```

to check eventual errors

see the reference doc: [http://www.php.net/manual/en/function.json-decode.php](http://www.php.net/manual/en/function.json-decode.php)

# php - Proxy and SMTP connection from one server to another?

> ID：13546180
> 
> 赞同：0
> 
> 时间：2012-11-24T22:15:50.257
> 
> 标签：php, email, proxy

I have 2 servers, 1 is a small VPS with 128mb of RAM, the other is an old PC that I am running ubuntu on.

The old pc has way more ram and thus proves more useful but the only issue is that I cannot use php's mail() function as SMTP is blocked by my ISP.

I have heard on stackoverflow before that I can somehow make the 2 servers work together so I can send mail from the VPS while the script itself is on my old PC.

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:20:25.647

您可以使用 PEAR 库连接到远程 SMTP 服务器。或者，您可以使用 Zend 框架的邮件功能。PHPMailer 是您的另一个选择。

**PHPMailer 示例**

```
require_once('../class.phpmailer.php');
//include("class.smtp.php"); // optional, gets called from within class.phpmailer.php if not already loaded

$mail             = new PHPMailer();

$body             = file_get_contents('contents.html');
$body             = eregi_replace("[\]",'',$body);

$mail->IsSMTP(); // telling the class to use SMTP
$mail->Host       = "mail.yourdomain.com"; // SMTP server
$mail->SMTPDebug  = 2;                     // enables SMTP debug information (for testing)
                                           // 1 = errors and messages
                                           // 2 = messages only
$mail->SMTPAuth   = true;                  // enable SMTP authentication
$mail->Host       = "mail.yourdomain.com"; // sets the SMTP server
$mail->Port       = 26;                    // set the SMTP port for the GMAIL server
$mail->Username   = "yourname@yourdomain"; // SMTP account username
$mail->Password   = "yourpassword";        // SMTP account password

$mail->SetFrom('name@yourdomain.com', 'First Last');

$mail->AddReplyTo("name@yourdomain.com","First Last");

$mail->Subject    = "PHPMailer Test Subject via smtp, basic with authentication";

$mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; // optional, comment out and test

$mail->MsgHTML($body);

$address = "whoto@otherdomain.com";
$mail->AddAddress($address, "John Doe");

$mail->AddAttachment("images/phpmailer.gif");      // attachment
$mail->AddAttachment("images/phpmailer_mini.gif"); // attachment

if(!$mail->Send()) {
  echo "Mailer Error: " . $mail->ErrorInfo;
} else {
  echo "Message sent!";
} 
```

**PHP 梨示例**

```
include('Mail/smtp.php');

class MailHandler{

   var $params = null;
   var $mail_object = null;
   var $recipients = null;
   var $headers = null;
   var $body = "";

function MailHandler($host, $port, $auth, $username, $password, $persist) {
   $this->params["host"] = $host;
   $this->params["port"] = $port;
   $this->params["auth"] = $auth;
   $this->params["username"] = $username;
   $this->params["password"] = $password;
   $this->params["persist"] = $persist;

   // Create the mail object using the Mail::factory method
   //$this->mail_object =& Mail::factory('smtp', $this->params);
   $this->mail_object = new Mail_smtp($this->params);
}

function createFrom($email){
   $this->headers['From'] = $email;
}

function createTo($email){
   $this->headers['To'] = $email;
   $this->recipients = array($email);
}

function createCC($email){
   $this->headers['Cc'] = $email;
}

function createBCC($email){
   $this->headers['Bcc'] = $email;
}

function createSubject($sub){
   $this->headers['Subject'] = $sub;
}

function createBody($body){
   $this->body=$body;
}

function sendMail(){
   if ($this->mail_object->send($this->recipients, $this->headers, $this->body)) {
      return true;
   }else{
      return false;
   }
}

}

$smtpserver_host = "localhost"; // The server to connect. Default is localhost
$smtpserver_Port = 25; // The port to connect. Default is 25
$smtpserver_auth = FALSE; // Whether or not to use SMTP authentication. Default is FALSE
$smtpserver_username = "username"; // The username to use for SMTP authentication.
$smtpserver_password = "password"; // The password to use for SMTP authentication.
$smtpserver_persist = FALSE; // Indicates whether or not the SMTP connection should persist over multiple calls to the send() method.
$mailhandler=new MailHandler($smtpserver_host, $smtpserver_Port, $smtpserver_auth, $smtpserver_username, $smtpserver_password, $smtpserver_persist);

$mailhandler->createTo("toaddress");
$mailhandler->createFrom("fromaddress");
$mailhandler->createSubject("subject");
$mailhandler->createBody("body");

if($mailhandler->sendMail()){
   echo "Mail sent.\n";
}else{
   echo "Error sending mail!\n";
}

?> 
```

# sql - SQL Server 2008 从两个表中选择 JOIN

> ID：13546184
> 
> 赞同：1
> 
> 时间：2012-11-24T22:16:25.093
> 
> 标签：sql, sql-server, sql-server-2008, select, join

我有两张桌子，第一张看起来像这样：

**[比较]**

*   标识（整数）
*   Car_Id1 (int)
*   Car_Id2 (int)
*   蛞蝓（串）
*   时间戳

第二个：

**[车辆规格]**

*   标识（整数）
*   年份（整数）
*   制作（字符串）
*   型号（字符串）

我有这个查询

```
SELECT TOP 100 * 
FROM [Comparsions] 
WHERE 
ORDER BY [TimeStamp] 
```

它返回最新的 100 条记录，但我需要用第二个表中的信息替换`Car_Id1`and ，如下所示：`Car_Id2``Car_Id1 -> [Year + Make + Model]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:19:18.263

所以你需要的是两个`INNER JOIN`s 靠在`VehicleSpecs`桌子上，每个s`Car_Id1`和`Car_Id2`. 我已将它们别名为`car1, car2`.

```
SELECT TOP 100
  c.Id,
  c.Slug,
  c.TimeStamp,
  /* Select the relevant columns from *both* of the joined tables */
  /* And give each column an alias to differentiate it from the other */
  car1.Year AS car1Year,
  car1.Make AS car1Make,
  car1.Model AS car1Model,
  car2.Year AS car2Year,
  car2.Make AS car2Make,
  car2.Model AS car2Model
FROM 
  Comparisons c
  /* Join first against VehicleSpecs for Car_Id1 */
  INNER JOIN VehicleSpecs car1 ON c.Car_Id1 = car1.Id
  /* Then once more for Car_Id2 */
  INNER JOIN VehicleSpecs car2 ON c.Car_Id2 = car2.Id
ORDER BY c.TimeStamp 
```

你说你想要*最新*的，所以我假设你实际上是指在时间戳上使用降序：

```
ORDER BY c.TimeStamp DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:21:12.500

加入第二张桌子两次：

```
select top 100
  c.Id, c.Slug, c.TimeStamp,
  s1.Year as Car1_Year, s1.Make as Car1_Make, s1.Model as Car1_Model,
  s2.Year as Car2_Year, s2.Make as Car2_Make, s2.Model as Car2_Model
from Comparsions c
inner join VehicleSpecs s1 on s1.Id = c.Car_Id1
inner join VehicleSpecs s2 on s2.Id = c.Car_Id2
order by c.TimeStamp desc 
```

（旁注：您可能希望将表名更正为`Comparisons`。）

# html - getting rid of spaces (%20) in resulting anchor

> ID：13546185
> 
> 赞同：1
> 
> 时间：2012-11-24T22:16:27.250
> 
> 标签：html

I have a Local HTML document that I want to have an Anchor Tag (`<a>`) open a Website, however the URL Code being sent is

```
http://www.my%20%20%20%20%20%20%20%20firerules.net/ 
```

which apparently has 8 embedded spaces for some reason.

Here is the call (from within a Table (`<tb>`) in the HTML document):

```
<a href="http://www.myfirerules.net" target="_blank">MFR.net Link</a> 
```

The new browser window is opened, however the Address being opened is:

```
[http://www.my%20%20%20%20%20%20%20%20firerules.net/] 
```

rather than

```
[http://www.myfirerules.net] 
```

as the `href=` says to do.

Can anyone tell me how to correct this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:19:05.643

首先，您上面的链接（在编辑问题之前）写成：

```
<"a href="http://www.myfirerules.net" target="_blank">MFR.net Link<"/a"> 
```

你的意思：

```
<a href="http://www.myfirerules.net" target="_blank">MFR.net Link</a> 
```

* * *

其次，如果您在实际代码中的属性*中间*`href`有换行符和/或缩进，这可能会导致目标 URL 中包含空格。

# javascript - How to match any combination of letters using regex?

> ID：13546187
> 
> 赞同：13
> 
> 时间：2012-11-24T22:16:58.873
> 
> 标签：javascript, java, html, regex, perl

How can I match letters a,b,c once in any combination and varying length like this:

The expression should match these cases:

```
abc
bc
a
b
bca 
```

but should not match these ones:

```
abz
aab
cc
x 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-24T23:24:44.200

使用正则表达式模式

```
\b(?!\w*(\w)\w*\1)[abc]+\b 
```

您可以将此模式与任何集合和大小一起使用，只需替换`[abc]`为所需的集合...

* * *

*[示例](http://regexpal.com/?flags=gm&regex=%5Cb%28?!%28?:.%5CB%29*%28.%29%28?:%5CB.%29*%5C1%29%5Babc%5D%2b%5Cb&input=test%20a%20b%20c%20ab%20abd%20abc%20acb%20aab%20baa%20cab%20gac%20cga%20bba%20cba%20aa%20bb%20bc%20ab%20test%0A)：*

![在此处输入图像描述](../Images/9e7acdd5fdf9c04d67c4ae615de72a02.png)

（以上输出来自[myregextester](http://myregextester.com/index.php)）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-24T22:44:58.957

```
^(?=([^a]*a?[^a]*)$)(?=([^b]*b?[^b]*)$)(?=([^c]*c?[^c]*)$)[abc]{1,3}$ 
```

这[**适用**](http://regexpal.com/?flags=gm&regex=%5E%28%3F%3D%28%5B%5Ea%5D%2aa%3F%5B%5Ea%5D%2a%29%24%29%28%3F%3D%28%5B%5Eb%5D%2ab%3F%5B%5Eb%5D%2a%29%24%29%28%3F%3D%28%5B%5Ec%5D%2ac%3F%5B%5Ec%5D%2a%29%24%29%5Babc%5D%7B1%2C3%7D%24&input=abc%0Aab%0Aac%0Aab%0Aacb%0Aabb%0Aaa%0Abb%0Acaa%0Acbc)于[**前瞻**](http://www.regular-expressions.info/lookaround.html#lookahead)。

它以三种变体形式包含此模式：`(?=([^a]*a?[^a]*)$)`

`a`它说：从这里（开始）到结束最多需要一个。

结合[**前瞻**](http://www.regular-expressions.info/lookaround.html#lookahead)和[**反向引用**](http://www.regular-expressions.info/brackets.html#usebackrefinregex)：

```
^([abc])((?!\1)([abc])((?!\1)(?!\3)[abc])?)?$ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-25T00:57:25.783

只是为了完善该系列：

```
^(?:([abc])(?!.*\1))+$ 
```

想要处理更大的字符集？没问题：

```
^(?:([abcdefgh])(?!.*\1))+$ 
```

**编辑：**显然我误读了这个问题；您不是在验证单个字符串，例如`"abc"`and `"ba"`，而是在尝试在更大的字符串中查找全字匹配。我会这样做：

```
\b(?:([abc])(?![abc]*\1))+\b 
```

棘手的部分是确保前瞻不会超出当前匹配的单词的末尾。例如，如果我将前瞻保留为`(?!.*\1)`，它将无法匹配`abc`in ，因为前瞻会错误地将in`abc za`标记为`a`in`za`的副本。允许先行只查看有效字符 ( ) 使其保持足够短的约束。而且，如果当前单词中有无效字符，无论如何都不是先行的工作来发现它们。`a``abc``[abc]*`

（感谢[Honest Abe](https://stackoverflow.com/questions/13546187/how-to-match-any-combination-of-letters-using-regex/13547282#comment20671757_13547282)让我重新注意到这一点。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-24T22:24:29.397

```
^(?=(.*a.*)?$)(?=(.*b.*)?$)(?=(.*c.*)?$)[abc]{,3}$ 
```

锚定前瞻将每个字母的出现次数限制为一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-24T22:46:53.383

试试这个正则表达式：

```
^([abc])((?!\1)([abc]))?((?!(\1|\2))([abc]))?$ 
```

检查[**正则表达式**](http://regexpal.com/?flags=gm&regex=%5E%28%5Babc%5D%29%28%28?!.%2a%5C1%29%28%5Babc%5D%29%29?%28%28?!.%2a%28%5C1%7C%5C2%29%29%28%5Babc%5D%29%29?%24&input=a%0Aabc%0Aab%0Aac%0Aab%0Aacb%0Aabb%0Aaa%0Abb%0Acaa%0Acbc%0Aabx%0Abab)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-24T22:29:51.060

我在评论中链接了它（这有点像[How can I find repeat characters with a regex in Java?](https://stackoverflow.com/questions/664194/how-can-i-find-repeated-characters-with-a-regex-in-java)）..但更具体地说..正则表达式：

```
(\w)\1+ 
```

将匹配任何两个或多个相同的字符。否定它，你就有了你的正则表达式。

# jquery - jQuery color change on custom font working correctly in Firefox but not in Chrome?

> ID：13546190
> 
> 赞同：2
> 
> 时间：2012-11-24T22:17:16.253
> 
> 标签：jquery, html, css, fonts

I'm changing the color of a custom font with a jQuery-script on hover:

```
$(this).css({
   color: "#" + color
}); 
```

My custom font got a pretty big "R" so the color is not filling the whole letter. How can I fix this? This is just a problem with Chrome, it's working fine with FF...

![Firefox](../Images/f1b0594482f73ae595544f176517874e.png)

![Chrome](../Images/945960c501673270be7b31a1b5355029.png)

Firefox #1 Chrome #2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:57:58.063

这似乎是 WebKit 问题，因为我可以在 iPad 上重现它。你应该报告一个错误。要解决此问题，您可以使用元素的样式规则。`line-height`我通过添加更大的属性来修复它。

您更新的小提琴：http: [//jsfiddle.net/ca3rT/3/](http://jsfiddle.net/ca3rT/3/)

# iphone - uitableview with a divider

> ID：13546193
> 
> 赞同：0
> 
> 时间：2012-11-24T22:17:37.637
> 
> 标签：iphone, ios, xcode, ipad, uitableview

I am trying to make a uitableview that kind of look like this

![enter image description here](../Images/42ee4d2c80f95f6c2b2d286e46d6fc6e.png)

I am not sure how are they doing this? It looks like uitableview with grouped static cells but I am not sure how they inserted a divider and a uitextfield on the right hand side. Any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:31:40.130

这是在情节提要中完成的，设计了分组表视图的“原型单元”。只需输入文本字段，根据自己的喜好定位和设置样式。

对于分隔线，您可以绘制到一个视图（这对于初学者来说有点复杂），或者只是`UIView`在适当的位置插入一个。根据需要设置其背景颜色并将宽度设置为 1.0。——维奥拉！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:03:45.793

在 -cellForRowAtIndexPath 委托方法中，您可以将视图添加到单元格的 contentView 属性。在您的情况下，分隔符的图像，然后是适当的文本字段。

# iphone - 越狱设备上的 iOS 守护程序 - 防止睡眠模式

> ID：13546196
> 
> 赞同：1
> 
> 时间：2012-11-24T22:17:59.963
> 
> 标签：iphone, ios, daemon, sleep, jailbreak

我正在尝试使用以下代码阻止在越狱设备上在后台运行的 iOS Daemon 应用程序的睡眠模式：

```
- (void) disableSleepModeTimerEvent:(NSTimer *) timer; 
{
    [self writeTextFile]; // for debug purposes
    [UIApplication sharedApplication].idleTimerDisabled = NO;
    [UIApplication sharedApplication].idleTimerDisabled = YES;
} 
```

由于将 idleTimerDisabled 设置为 YES 的简单语句没有起到作用，因此我已将其放入一个由 NSTimer 每 10 秒调用一次的方法中，正如在 stackoverflow 上类似问题的答案中所建议的那样。可悲的是，这也不起作用。

触发了计时器事件（检查我将文件写入目录并查看以 10 秒间隔出现的文件，并且每 10 秒添加一个文件），但设备仍会进入睡眠状态。手动唤醒后，计时器恢复工作并再次开始写入文件，但显然禁用睡眠不起作用。

我有一个在这个应用程序中运行的服务器，当需要提供某些东西时，我想禁用睡眠模式。服务完成后，应再次启用睡眠模式。对于不可见的应用程序是否可以实现？

# java - 线程没有运行，为什么 jframe setresizeable 不起作用

> ID：13546200
> 
> 赞同：1
> 
> 时间：2012-11-24T22:18:32.543
> 
> 标签：java, multithreading, swing, jframe

为什么这个程序不起作用？（它不打印“正在运行...”）

```
package eu.inmensia.learn;

import java.awt.Canvas;
import java.awt.Dimension;

import javax.swing.JFrame;

public class Client extends Canvas implements Runnable {

    private static final long serialVersionUID = 1L;
    public static final int WIDTH = 300;
    public static final int HEIGHT = WIDTH / 16 * 9;
    public static final short SCALE = 3;

    private Thread thread;
    private JFrame frame = new JFrame();
    private boolean running = false;

    public Client() {
        Dimension size = new Dimension(WIDTH * SCALE, HEIGHT * SCALE);
        setPreferredSize(size);
    }

    public synchronized void start() {
        running = true;
        thread = new Thread("display");
        thread.start(); // start the thread
    }

    public synchronized void stop() {
        running = false;
        try{
            thread.join(); // end the thread
        }catch(InterruptedException e){ e.printStackTrace(); }
    }

    public void run() {
        while(running){
            System.out.println("Running...");
        }
    }

    public static void main(String[] args) {
        Client client = new Client();
        client.frame.setResizeable(false);
        client.frame.setTitle("Program test");
        client.frame.add(client);
        client.frame.pack();
        client.frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        client.frame.setLocationRelativeTo(null);
        client.frame.setVisible(true);

        client.start();
    }
} 
```

我正在尝试学习线程，这是我所学过的最难的事情之一。OOP 与这个 xD 无关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:27:53.993

您以错误的方式执行此操作，当您调用`client.start();`它时，它将调用`Client`类中的 start 函数，并在该函数中创建一个线程类的新实例，该实例的默认`run`方法为空

你可能指的是这段代码：

```
public synchronized void start() {
    running = true;
    thread = new Thread(this);
    thread.start(); // start the thread
} 
```

我希望这对你有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:24:39.680

因为这

```
new Thread("display"); 
```

将其更改为

```
new Thread(this) 
```

我只是希望你知道你在做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T22:26:33.833

您已经创建了一个通用（读取 BLANK）线程对象。您需要将您的类作为参数传递。

```
thread = new Thread(this); 
```

这会将您的 run 方法绑定到 Thread 对象。线程的名称通常不是那么重要。参考[这个例子](http://www.go4expert.com/forums/showthread.php?t=4202)

# c++ - 1\. 将常量对象传递给结构 & 2\. 删除向量中的指针元素，但不删除其指向的对象

> ID：13546201
> 
> 赞同：0
> 
> 时间：2012-11-24T22:18:38.193
> 
> 标签：c++

对于 vector 中的某些对象（元素）`aArray`，我想创建一个最小排序堆。

1.  我想修改`aArray`其他函数中的成员并调用`Heap`成员函数来更新最小堆。这意味着我应该将一个常量向量传递给`Heap`结构，但是我遇到了很多麻烦，因为它被错误淹没了。将常量对象传递给`Heap`构造函数的正确方法是什么？

2.  另外，当我调用函数时`popHeap`，我只想删除指向堆中根的指针，但它`aArray`也会删除向量中的对象。我怎样才能解决这个问题？

    ```
    #include <vector>
    #include <iostream>

    struct A
    {
        A(int av, int bv):a(av),b(bv){}
        int a, b;
    };

    struct Heap
    {
       Heap() : ptr(new std::vector<A>()) {}

       Heap(std::vector<A> *p) : ptr(p) {}

       void makeHeap()
       { // some code here }

       void popHeap()
       {
           ptr->erase(ptr.begin()+heapLoc[0]);  //DELETES aArray member! I only want to delete the pointer, not the object. 
           //some code here   
       }

       std::vector<A> *ptr;
       std::vector<int> heapLoc;
    };

    int main()
    {
         A a0(2,5), a1(4,2), a2(8,4), a3(0,3);  
         std::vector<A> aArray;  
         aArray.push_back(a0);  aArray.push_back(a1);  aArray.push_back(a2);   aArray.push_back(a3);

         for(int i=0; i<aArray.size(); ++i)
         {
            std::cout << "aArray[i].a = " << aArray[i].a << " "
                      << "aArray[i].b = " << aArray[i].b <<  "\n";
         } //All 4 objects outputted

         Heap h(&aArray);
         h.makeHeap();

         h.popHeap();

         for(int i=0; i<aArray.size(); ++i)
         {
            std::cout << "aArray[i].a = " << aArray[i].a << " "
                      << "aArray[i].b = " << aArray[i].b <<  "\n";
         } //Only 3 objects outputted. One gets deletated. 
    } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T15:53:17.493

在构造函数中复制整个传递的向量（不要只有指向它的指针）。允许任何东西修改需要具有特定结构（如排序元素）才能工作的东西的内部结构是一个坏主意。您可以简单地执行以下操作：

```
class Heap
{
   ...
   Heap(std::vector<A> &input): vect(input) { };
   std::vector<A> vect;
} 
```

您将需要有一个复制构造函数或覆盖`=`A 的运算符才能使上述工作正常工作，但两者都做并没有什么坏处。如：

```
class A
{
   ...
   A(const A &o): a(o.a), b(o.b) {}; // Copy constructor
   void operator=(const A &o): a(o.a), b(o.b) {}; // = operator
} 
```

添加这两段代码将复制堆构造函数中向量中的所有元素。指针不会为此工作，因为总是浅拷贝，除非你明确地深拷贝它们，这需要更多的努力。

对此的替代方法总是从一个空堆开始并拥有一个`add`方法（仍然不使用指针）。

如果不想复制元素，可以使用`const`关键字。就像在`const A`您使用的代码中的任何地方使用`A`.

注 1 - 我建议摆脱 makeHeap 方法，只在构造函数中完成这项工作。

注 2 - 我在`class`上面使用过，而不是`struct`. 不要`struct`在 C++ 中使用，`class`而是使用。`struct`更多 C.

# ios - 使用 moveRowAtIndexPath 更改 plist 项目的顺序

> ID：13546202
> 
> 赞同：0
> 
> 时间：2012-11-24T22:18:43.873
> 
> 标签：ios

我有一个加载了 plist 内容的 uitableview。plist 包含存储在设备文档目录中的图像的路径。因此，当我使用 moveRowAtIndex 更改 tableview 中项目的顺序时，我不知道如何更改 plist 中项目的顺序。[这里是 plist 的链接](http://gyazo.com/b1220ce15308b1a685af678a019c77f5)

所以说，如果我有三个图像“项目 0”、“项目 1”和“项目 2”，并且我将第 0 行与第 3 行交换，我将如何让它在 plist 中更改？

另外为了澄清表格从顶部到底部从 plist 加载文件，它与项目编号无关。

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:37:50.303

要更新数组，您可以在“从行”的索引处获取对象，从数组中删除该对象，然后将其插入回“到行”的索引处。这是一个示例（arr 是保存表数据的可变数组）：

```
 int toRow = 0;
    int fromRow = 3;
    [self.tableView moveRowAtIndexPath:[NSIndexPath indexPathForRow:fromRow inSection:0] toIndexPath:[NSIndexPath indexPathForRow:toRow inSection:0]];
    id obj = arr[fromRow];
    [arr removeObjectAtIndex:fromRow];
    [arr insertObject:obj atIndex:toRow]; 
```

# css - 在任何站点上快速更改 css 样式表

> ID：13546204
> 
> 赞同：1
> 
> 时间：2012-11-24T22:18:52.780
> 
> 标签：css

我通常阅读[一个在黑色背景上有白色文本的网站](http://www.dpreview.com)（为什么，哦，为什么！）。读了一分钟后，我的眼睛很痛，所以我通常最终打开 Chrome 的开发人员工具并更改两三个使页面可读的样式。

有没有办法自动化这个，这样我就不必为每一页一遍又一遍地做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:35:01.420

只需在 JS 中为 Chrome 编写一个用户脚本。我将用我曾经为一个烦人的网站做的脚本来解释它：

示例文件：

JS：

```
// ==UserScript==
// @author          me
// @version         1.0
// @name            User Script Test
// @date            August 10, 2012
// @include         *.test.com/*    // the asterisk gets every subdomain and page
// @run-at          document-end
// ==/UserScript==

(function(){
    var $ad = document.getElementById('skyscraper');
    var $link = $ad.getElementsByTagName('a');
    $ad.removeChild($link[0]);
    $ad.setAttribute('style', 'width:100%; left:480px;');
})(); 
```

1.  用 JS 编写它，例如覆盖一个令人讨厌的广告，它不会消失。

2.  **重要的！！！**确保脚本具有***.user.js**的扩展名！否则，Chrome 在以下步骤中无法识别该文件。（它只是向您显示源代码，多么棒的行为......）

3.  然后转到 Google Chrome 的扩展选项卡并将脚本文件拖放到您的扩展中。可能会有一个额外的警告，这是不安全的bla bla。

您甚至可以将 jQuery 加载到 dom 中，在这篇很棒的 SO-Post 中指出：
**[如何在 Google Chrome 的 Greasemonkey 脚本中使用 jQuery？](https://stackoverflow.com/questions/2246901/how-can-i-use-jquery-in-greasemonkey-scripts-in-google-chrome)**

如果您想知道脚本会发生什么：它位于 Chromes 扩展文件夹（Win 7、Chrome 23）中，并且在编辑时会自动更新：

```
C:\Users\YourUserName\AppData\Local\Google\Chrome\User Data\Default\Extensions 
```

# python - 如何在不使用大量 if 语句的情况下缩短此代码

> ID：13546205
> 
> 赞同：0
> 
> 时间：2012-11-24T22:18:52.740
> 
> 标签：python, python-3.x, python-2.7

```
CONSTANTS:

NDP_INDEX = 0
GREEN_INDEX = 1
LIBERAL_INDEX = 2
CPC_INDEX = 3 
```

各方数据出现在 4 元素列表中的索引分布。

```
PARTY_INDICES = [NDP_INDEX, GREEN_INDEX, LIBERAL_INDEX, CPC_INDEX] 
```

一个字典，其中每个键是一方名称，每个值是该方的索引。

```
NAME_TO_INDEX = {'NDP': NDP_INDEX,
'GREEN': GREEN_INDEX,'LIBERAL': LIBERAL_INDEX,'CPC': CPC_INDEX} 
```

一个字典，其中每个键是一方的索引，每个值是该方的名称。

```
INDEX_TO_NAME = {NDP_INDEX: 'NDP',GREEN_INDEX: 'GREEN', LIBERAL_INDEX:
'LIBERAL',CPC_INDEX: 'CPC'}

def voting_range(range_votes):
    ''' 
(list of list of int) -> tuple of (str, list of int)
#range_votes is a list of integers of range ballots for a single
#riding; the order of the inner list elements corresponds to the order
#of the parties in PARTY_INDICES.Based on range_votes, return a tuple
#where the first element is the name of the party winning the seat and
#the second is a list with the total range_votes for each party in the
#order specified in PARTY_INDICES.

>>> voting_range([[5, 4, 1, 4], [3, 2, 2, 5], [3, 3, 1, 4,]])
('CPC', [11, 9, 4, 13])

'''

NDP_count = 0
GREEN_count = 0
LIBERAL_count = 0

for sub_list in range_votes:
    NDP_count += sub_list[0]
    GREEN_count += sub_list[1]
    LIBERAL_count += sub_list[2]
    CPC_count += sub_list[3]

PARTY_INDICES[0] = NDP_count
PARTY_INDICES[1] = GREEN_count
PARTY_INDICES[2] = LIBERAL_count
PARTY_INDICES[3] = CPC_count

winner = max(NDP_count, GREEN_count, LIBERAL_count, CPC_count)
if winner == NDP_count:
    return 'NDP', PARTY_INDICES
elif winner == GREEN_count:
    return 'GREEN', PARTY_INDICES
elif winner == LIBERAL_count:
    return 'LIBERAL', PARTY_INDICES
elif winner == CPC_count:
    return 'CPC', PARTY_INDICES 
```

即使使用辅助函数，我也不确定如何缩短它，因为我们不允许创建新常量（通用变量），而只能创建局部变量

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:28:40.123

尝试这个：

```
for sub_list in range_votes:
   for i in range(4):
       PARTY_INDICES[i] += sub_list[i]
return ( {PARTY_INDICES[0] : 'NDP', PARTY_INDICES[1] : 'GREEN', ...}[max(PARTY_INDICES)], 
         PARTY_INDICES ) 
```

这就像我愿意做的那样短;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:54:16.400

您不需要所有这些字典和范围变量并定义/枚举看起来的东西。这是一个少一点的 C 和多一点的 python：

```
votes=[[5, 4, 1, 4], [3, 2, 2, 5], [3, 3, 1, 4,]]
parties=['NDP','GREEN','LIBERAL','CPC']

def voting_range(v):
  totals = [sum(x) for x in zip(*v)] # transpose row/col of list of lists
  pname = parties[totals.index(max(totals))]
  return (pname,totals)

>>> voting_range(votes)
('CPC',[11, 9, 4, 13]) 
```

这里发生了一些神奇的蟒蛇事件。[`*v`](http://docs.python.org/2/tutorial/controlflow.html#tut-unpacking-arguments)解包列表列表，并将它们作为单独的参数提供给[`zip`](http://docs.python.org/2/library/functions.html#zip)，它返回一个迭代，它给出列表中每个参数的第一个元素，然后是列表中每个参数的第二个元素，依此类推。这具有转置矩阵的效果（交换行和列）。在这种形式中，简单地将每个列表相加将是投票总数。括在括号中的`for x in`语法是[列表推导](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)，这是另一个很棒的 Python 功能，可以有效地从可迭代对象创建列表。最后，`index`是一个[列表方法](http://docs.python.org/2/tutorial/datastructures.html)这将返回具有指定值的第一个元素的索引，在这种情况下是最大值。由于 v 的元素应该具有与参与方数量相同的长度，这也将作为参与方列表的索引。

# javascript - jquery在属于一个/多个特定类的dom中动态显示表行

> ID：13546207
> 
> 赞同：-1
> 
> 时间：2012-11-24T22:19:02.517
> 
> 标签：javascript, jquery, dom

我有基本的html结构：

```
<table>

  <tbody>
    <tr class="1">
      <td>
        <p style="font-size:large"> 
            <span class="muted"> This is the first object </span> 
        </p>
      </td>
    </tr>

    <tr class="2">
      <td>
        <p style="font-size:large"> 
            <span class="muted"> This is second object </span> 
        </p>
      </td>
    </tr>

    <tr class="3">
        <p style="font-size:large"> 
            <span class="muted"> this is the third object </span> 
        </p>
      </td>
    </tr>

</tbody>
</table> 
```

然后我有复选框，我想要的功能是，如果选中复选框**1**，则只显示**tr**类**1**。

如果单击复选框**2**和**3** ，则具有类**1的****tr**将被隐藏，并且**2**、**3**显示在 dom 中。

 ******再次，如果复选框**2** ,* *3* * 未选中并且**1**被选中 tr 类**2**，**3**不显示并且显示**1**。

如何在 jQuery 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:46:28.213

这是使用收音机的解决方案，因为解释似乎表明您希望选择**2&3**或**1**来显示。收音机相互取消，而复选框则不会。

如果这不是你想要的行为，你需要澄清你的解释

HTML：

```
<label>Show All<input type="radio" value="0" name="radio"></label>
<label>1<input type="radio" value="1" name="radio"></label>
 <label>2 &amp; 3<input type="radio" value="23" name="radio"></label> 
```

JS

```
var rows = $('tr');

$(':radio').change(function() {
    var classNum = $(this).val();
    rows.hide();
    var toShow;
    if( classNum=='0'){
       toShow=rows;        
    }else{
        toShow = classNum=='1' ? rows.filter('.1') :  rows.not('.1');
    }
    toShow.show();
}); 
```

演示：http: [//jsfiddle.net/wGLfX/](http://jsfiddle.net/wGLfX/)******

# javascript - 如何列出所有可用于 webkit 的插件？

> ID：13546209
> 
> 赞同：2
> 
> 时间：2012-11-24T22:19:15.427
> 
> 标签：javascript, webkit

安装 WebKit 插件后[，即可部署它](https://developer.apple.com/library/mac/#documentation/InternetWeb/Conceptual/WebKit_PluginProgTopic/Concepts/AboutPlugins.html#//apple_ref/doc/uid/30001248-BAJGJJAH)。如何获取当前安装的所有插件的列表？我在 Linux 上，我知道所有`.so`已安装插件的目录。但是，我不知道它们的`CLASSID`值，也不知道在 JavaScript 中实例化它们的任何其他方式。是否有我可以查看的具有这些`CLASSID`值的文件或目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:22:38.210

查看`navigator.mimeTypes`对象内部。这不会给你，`CLASSID`但你可以检查你的插件`mime-type`是否可用。

这是[小提琴](http://jsfiddle.net/4EEKW/1/)

# c++ - 枚举引用参数传输而不是 int 引用参数

> ID：13546215
> 
> 赞同：1
> 
> 时间：2012-11-24T22:19:54.243
> 
> 标签：c++, reference, enums

我有以下代码：

```
typedef enum {Z,O,T} num;
bool toInt (str s,int& n);//<-if convert is possible converts s to integer ,puts the result in n and returns true,else returns false 
```

我想使用`toInt`function 和 transfer 作为第二个参数，类型为 num num n 的参数；toInt("2",n); 这会导致编译错误。

```
cannot convert parameter 2 from 'num' to 'int &' 
```

我尝试使用演员表：`toInt("2",(num)n);`但它仍然有问题 我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:26:23.690

type 的值`num`不是`int`，因此`int`在传递给函数之前必须将其转换为临时值。临时对象不能绑定到非常量引用。

* * *

*如果*要通过 转换`int`，则必须分两步进行转换：

```
int temp;
toInt("2", temp);
num n = static_cast<num>(temp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:35:01.950

我建议，您添加一个新的枚举类型来签署无效枚举，例如：

```
enum num {Z,O,T,Invalid=4711} ;//no need to use typedef in C++ 
```

并将签名更改为 num 而不是 int：

```
bool toInt (str s, num& n)
{
 if ( s=="Z" ) n=Z; 
 else if ( s=="O" ) n=O;
 else if ( s=="T" ) n=T;
 else { n=Invalid; return false; }
 return true;
} 
```

问候

# pascal - FreePascal 中的月份名称

> ID：13546216
> 
> 赞同：-1
> 
> 时间：2012-11-24T22:20:18.027
> 
> 标签：pascal, freepascal

输入：月份名称（一月/二月/.../十二月）

输出：季节（冬季/春季/夏季/秋季）

冬季：12 月 - 2 月

春季：三月至五月

夏季：6 月 - 8 月

秋季：九月至十一月

我试过了：

```
Program Months;

var
  Month:String;

begin
  writeln('Insert month name:');
  readln(Month);

  if Month = 'March' or Month = 'April' or Month = 'May' then

    begin
    writeln(Month,' is Spring month');
    end

    ...
    etc   
    ...

end. 
```

但是这个程序不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T01:21:30.397

运算符优先级 - 这很重要。你需要写：

```
if (Month = 'March') or (Month = 'April') or (Month = 'May') then 
```

这是因为在 Pascal 中，`or`优先级比`=`实际评估的要高：

```
if ((Month = ('March' or Month)) = ('April' or Month)) = 'May' then 
```

这显然是没有意义的并且不会编译（我可能在上面的行中犯了一个错误，但这是一般的想法）。请参阅[此链接](http://www.freepascal.org/docs-html/ref/refch12.html)以了解有关 Pascal 中运算符优先级的更多信息。

# java - 逐块加密：从第二个块解密不起作用

> ID：13546221
> 
> 赞同：1
> 
> 时间：2012-11-24T22:20:32.343
> 
> 标签：java, encryption

我正在使用自动生成的密钥和自定义IV逐块实现CBC加密+解密。我在第二个块解密中遇到问题，第一个块的解密正在工作，但它不适用于第二个块。这是我的代码。

```
public static void main(String args[]) {
    Cipher fcipher, scipher;
    String plaintextstring = "";

    System.out.println("Enter the first message:");
    BufferedReader buffp = new BufferedReader(new InputStreamReader(System.in));
    try {
        plaintextstring = buffp.readLine();
    } catch (Exception e) {
        System.out.println("Exception occured:" + e.getMessage());
    }

    int strlen1 = plaintextstring.length();

    int x1 = strlen1 % 8;

    int y1 = 8 - x1;

    StringBuffer buf1 = new StringBuffer(plaintextstring);

    if (x1 > 0) {
        for (int k = 0; k < y1; k++) {
            buf1.append('0');
        }
    }
    System.out.println("Modified plaintext is:" + buf1);
    String inp = buf1.toString();

    try {

        SecretKey key1 = KeyGenerator.getInstance("DES").generateKey();
        SecretKey key2 = KeyGenerator.getInstance("DES").generateKey();

        fcipher = Cipher.getInstance("DES/ECB/NoPadding");//CBC
        scipher = Cipher.getInstance("DES/ECB/NoPadding");//CBC

        // Create an 8-byte initialization vector 
        //byte[] iv = {0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08};
        //byte[] iv = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        byte[] iv = {(byte) 0x01, (byte) 0x02, (byte) 0x03, (byte) 0x04, (byte) 0x05, (byte) 0x06, (byte) 0x07, (byte) 0x08};
        System.out.println("Length of IV is :" + iv.length);

        byte[] sencrypted = new byte[8];

        fcipher.init(Cipher.ENCRYPT_MODE, key1);
        scipher.init(Cipher.DECRYPT_MODE, key2);
        System.out.println("Default Charset is :" + Charset.defaultCharset());
        byte[] pbytes = inp.getBytes("UTF-8");
        System.out.println("Byte array of input string is :" + pbytes);

        System.out.println("Size of first message in bytes is:" + pbytes.length);
        for (int i = 0; i < pbytes.length; i++) {
            System.out.println("Array values of byte array are: " + pbytes[i]);
        }

        int z = (pbytes.length) / 8;
        System.out.println("Number of data blocks of 8 bytes formed from message = " + z);
        for (int i = 0; i < z; i++) {
            byte[] ds = getSection(pbytes, i * 8);//getting block of 64bit
            byte[] out = new byte[8];

            for (int r = 0; r < 8; r++) {
                System.out.println("Array values of IV from previous stage is :" + iv[r]);
            }
            for (int k = 0; k < 8; k++) {
                out[k] = (byte) (ds[k] ^ iv[k]);//XORing of message block with IV bit by bit.
                // System.out.println("XORed array byte by byte is:"+out[k]);
            }
            byte[] fencrypted = fcipher.doFinal(out);//Applying DES Encryption to the XOR'ed result.(E)key1
            byte[] fdecrypted = scipher.doFinal(fencrypted);// (D)key2 
            sencrypted = fcipher.doFinal(fdecrypted);// (E)key1

            System.out.println("Encrypted byte length: " + sencrypted.length);
            System.out.println("Encrypted text is :" + sencrypted);

            fcipher.init(Cipher.DECRYPT_MODE, key1);
            scipher.init(Cipher.ENCRYPT_MODE, key2);

            byte[] sfdecrypted = fcipher.doFinal(sencrypted);//DES1 key1 (D)
            byte[] sfencrypted = scipher.doFinal(sfdecrypted);//DES Key2 (E)
            byte[] ssdecrypted = fcipher.doFinal(sfencrypted);//DES Key3  (D)
            System.out.println("length of final decrypted byte array is :" + ssdecrypted.length);
            byte[] d = new byte[8];
            for (int u = 0; u < 8; u++) {
                d[u] = (byte) (ssdecrypted[u] ^ iv[u]);//XORing of message block with IV bit by bit.
                System.out.println("final decrypted array byte by byte of a single 64 bit block is:" + d[u]);
            }
            String sdecryptedstr = new String(d);
            System.out.println("Decrypted block is :" + sdecryptedstr);
            iv = sencrypted;
            System.out.println("IV from previous stage is: "+iv); 
        }

    } catch (Exception e) {
        System.out.println("Exception Occured: " + e);
    }

}
//function to get CBC message blocks.
public static byte[] getSection(byte[] message, int start) {
    byte[] section = new byte[8];//dividing whole message into 64bit blocks.
    for (int i = 0, j = start; i < 8; i++, j++) {
        section[i] = message[j];
    }
    return section;
}//end of getSection function. 
```

# html - 有没有办法在 div 之间设置“换行符”？

> ID：13546227
> 
> 赞同：1
> 
> 时间：2012-11-24T22:21:13.653
> 
> 标签：html, css

所以我有一个菜单，4 个菜单点，我想把它们放在一个 2x2 的正方形中。有没有办法做到这一点，而无需为前两个课程和其他课程课程？

谢谢你的帮助 ：）

更新：我确实搞砸了一点，我正在使用弹性盒子结构，很抱歉没有发布这些信息：

```
 ul {
  -webkit-box-orient: horizontal;
  }

  ul li {
    -webkit-box-flex: 1;
    height: 44%;
    margin: 3%;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:24:38.900

当然。一方面，您可以使用浮动并相应地设置宽度。请参阅下面的示例，或[http://jsfiddle.net/BUPX7/](http://jsfiddle.net/BUPX7/)以获取实时示例。

**HTML**

```
<ul>
    <li>Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
    <li>Item 4</li>
</ul> 
```

**CSS**

```
ul {
    width: 200px;
}

ul li {
    width: 100px;   
    margin: 0;
    padding: 0;   
    float: left;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:28:11.603

`div`默认情况下，元素之间有换行符。您显然正在使用一些 CSS 来覆盖它。您需要相应地修改 CSS 代码，或选择不同的方法。

假设“菜单点”是链接，最简单的方法是使用

```
<div><a ...>link1</a> <a ...>link2</a></div>
<div><a ...>link3</a> <a ...>link4</a></div> 
```

但是，如果您正在使用一些详细的标记并希望单独在 CSS 中创建中断，那么您可能需要一些详细的选择器，例如`:nth-child(3)`.

# java - 如何更改android中videoview的参数？

> ID：13546231
> 
> 赞同：1
> 
> 时间：2012-11-24T22:21:29.847
> 
> 标签：java, android, android-videoview

如何更改视频视图的布局参数（centerInParent）

```
<VideoView
        android:id="@+id/videoPlayer"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_centerInParent="false" /> 
```

至

```
<VideoView
        android:id="@+id/videoPlayer"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_centerInParent="true" /> 
```

问候基督徒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T19:20:49.133

您是说以编程方式设置 LayoutParams 吗？也许有可能使用这样的代码

```
 RelativeLayout.Layoutparams params = new RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT);
    params.addRule(RelativeLayout.CENTER_IN_PARENT); 
```

# java - 对我的类 Java 来说，它是正确的 equals 方法吗

> ID：13546244
> 
> 赞同：0
> 
> 时间：2012-11-24T22:22:59.537
> 
> 标签：java, equals

如主题：对于我的Java类来说，它是正确的equals方法吗？我已经通过 Eclipse 自动生成了它，我不知道它是否`vector.remove(pracownik)`会正常工作。还是用Eclipse生成它是错误的？

```
import java.util.Date;
import java.util.Vector;

public class Pracownik extends Osoba {
    private String stanowisko;
    private int pensja;
    private Date dataZatrudnienia;

    public Pracownik(Adres adres, String telefon, String imie, String nazwisko,
            int id, Date dataUrodzenia, String stanowisko, int pensja,
            Date dataZatrudnienia) {
        super(adres, telefon, imie, nazwisko, id, dataUrodzenia);
        this.stanowisko = stanowisko;
        this.pensja = pensja;
        this.dataZatrudnienia = dataZatrudnienia;
    }

    public String getStanowisko() {
        return stanowisko;
    }

    public int getPensja() {
        return pensja;
    }

    public Date getDataZatrudnienia() {
        return dataZatrudnienia;
    }

    @Override
    public String toString() {
        return super.toString() + "\nstanowisko=" + stanowisko + "\npensja="
                + pensja + "\ndataZatrudnienia=" + dataZatrudnienia;
    }

    private static Vector<Pracownik> ekstensja = new Vector<Pracownik>();//kolekcja zawierajaca ekstensje

    private static void dodajPracownik(Pracownik pracownik) { //metoda dodajac aobiekt do ekstensji
        ekstensja.add(pracownik);
    }

    private static void usunPracownik(Pracownik pracownik) {//metoda usuwajaca obiekt z ekstensji
        ekstensja.remove(pracownik);
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        Pracownik other = (Pracownik) obj;
        if (dataZatrudnienia == null) {
            if (other.dataZatrudnienia != null)
                return false;
        } else if (!dataZatrudnienia.equals(other.dataZatrudnienia))
            return false;
        if (pensja != other.pensja)
            return false;
        if (stanowisko == null) {
            if (other.stanowisko != null)
                return false;
        } else if (!stanowisko.equals(other.stanowisko))
            return false;
        return true;
    }

    private static void pokazEkstensje(){ //wyswietlenie ekstensji przy pomocy petli for each
        System.out.println("Ekstensja klasy Pracownik");
        for(Pracownik pracownik: ekstensja)
            System.out.println(pracownik);
        System.out.println();
    }

    public static void main(String[] args){
        Adres adres = new Adres("tara", "588 m.42", "03-422", "Warszawa");
        Pracownik pracownik = new Pracownik(adres, "02-6451-4564", "Ala", "Kotowa", 323, new Date(), "szef", 14000, new Date()); //tworze pracownika
        System.out.println(pracownik);//wyswietlam pracowanika

        //tworze stazyste
        Stazysta stazysta = new Stazysta(adres, "3232 9898", "frajer", "costam", 3232, new Date(), "podawanie kawy", 0, new Umowa(new Date(2010,10,5), new Date(2011,11,8)));
        //wysswietlam stazyste
        System.out.println(stazysta);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:28:10.473

使用 Eclipse 生成 equals 方法很好。当且仅当它影响对象的逻辑相等性时，确保字段包含在生成中很重要。

当你覆盖equals时，你也应该覆盖hashCode。

通常，在覆盖继承的方法时，您需要确保新方法符合超类中规定的任何规则。[Object hashCode 文档](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)规定了几条规则，包括“如果两个对象根据 equals(Object) 方法相等，则对两个对象中的每一个调用 hashCode 方法必须产生相同的整数结果。”

您从 Object 继承的 hashCode 遵循该规则 - 如果 equals 方法也是从 Object 继承的方法。与您的 equals 方法一起使用时，它不遵循该规则。

如果您让 Eclipse 执行它的“生成 hashCode() 和 equals()”，它就会正确。如果手动编写equals方法，需要自己编写hashCode来匹配。

实际上，不遵循 Object hashCode 约定的类是未来重用的陷阱。散列数据结构，例如 HashMap 和 HashSet，如果 hashCode 方法损坏，可能无法找到实际存在的对象。我学到的一个教训是，依赖“我永远不会那样使用它”是错误的。随着事情的发展，最好保持事情的安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:27:59.273

我不是这方面的专家，但我相信双等号是比较地址而不是变量的内容。因此，您可以将其更改为 .equals()。如果我错了，我希望有更多经验的人纠正我。

# iphone - 自定义 UITableViewCell 未加载

> ID：13546246
> 
> 赞同：0
> 
> 时间：2012-11-24T22:23:29.567
> 
> 标签：iphone, objective-c, ios, uitableview

我正在使用界面生成器创建自己的自定义 UITableViewCell。我支持 iOS 5 和 iOS 6，但我不想使用 Storyboard。请不要建议情节提要。我坚持使用 Interface Builder 并以编程方式编写。

我创建了一个子类 UITableViewCell 的类。这是.h文件：

```
@interface CategoryCell : UITableViewCell
{
    __weak IBOutlet UIImageView *image;
    __weak IBOutlet UILabel *name;
    __weak IBOutlet UILabel *distance;
    __weak IBOutlet UILabel *number;
    __weak IBOutlet UIImageView *rating;
}

@property (nonatomic, weak) IBOutlet UIImageView *image;
@property (nonatomic, weak) IBOutlet UILabel *name;
@property (nonatomic, weak) IBOutlet UILabel *distance;
@property (nonatomic, weak) IBOutlet UILabel *number;
@property (nonatomic, weak) IBOutlet UIImageView *rating;

@end 
```

XIB 文件的类型为 UIViewController，并具有 CategoryCell 类型的视图。我按需要连接了插座。

**问题**

`dequeueResuableCellWithIdentifier`没有调用自定义单元格。这是我所拥有的：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *cellIdentifier = @"CategoryCell";
        CategoryCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

        if (cell == nil) {

            NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"CategoryCell" owner:self options:nil];
            cell = [topLevelObjects objectAtIndex:0];
            .....
        }
        return cell
} 
```

当我`loadBundle`用: 替换该行时`cell = [[CategoryCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];`，它确实有效。但是笔尖没有加载。所以加载了一个单元格，但不是我自己的单元格，所以我无法设置我想要的标签和图像。添加常规加载捆绑线（如上例所示）并`init`为自定义单元格的方法设置断点时，它不会被调用。此外，我得到的是一个全白屏幕，它覆盖了模拟器中的整个 iPhone 屏幕。

为什么会这样？我在这里做错了什么？当我尝试将插座设置为`strong`（我知道我不应该这样做）时，它也不起作用。

**编辑**：

我通过将 NSBundle 行替换为：

```
UIViewController *temporaryController = [[UIViewController alloc] initWithNibName:@"CategoryCell" bundle:nil];
cell = (CategoryCell *)temporaryController.view; 
```

我对 NSBundle 方法做错了什么？据说这应该是“更简单”的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T03:36:55.543

你有没有尝试过 tableview 中的 registerNib 方法？从 iOS 5 开始加载 nib 非常方便。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [self.tableView registerNib:[UINib nibWithNibName:@"CategoryCell" bundle:nil]
         forCellReuseIdentifier:@"CategoryCell"];
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *cellIdentifier = @"CategoryCell";
    CategoryCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    return cell
} 
```

确保您在 CategoryCell.nib 中定义了标识符，它在属性检查器下！希望这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:50:13.367

> XIB 文件的类型为 UIViewController，并具有 CategoryCell 类型的视图。我按需要连接了插座。

问题在于您的 XIB 的根对象需要是 UITableViewCell 或其子类。
并确保在您的 XIB 中设置了您的重用标识符。

# security - Node.js 应用程序的授权方法和设计模式

> ID：13546249
> 
> 赞同：84
> 
> 时间：2012-11-24T22:23:49.120
> 
> 标签：security, node.js, design-patterns, express, authorization

我正在为内部企业软件平台构建一个多页面管理界面。想想很多将各种 API、数据库查询和 shell 脚本捆绑在一起的粘合逻辑。

我们将使用 node.js、express 框架（包括 Jade 模板）和 LDAP 进行身份验证。

我正在努力寻找有关节点应用程序授权的设计模式和最佳实践的信息。我最好使用基于角色的模型，因为我的用户熟悉这种方法及其护理和喂养方式。

我是 node.js 的新手，所以请不要假设我已经看过一个模块或流行的博客文章。很可能有大量的信息，我根本不知道去哪里找。

提前感谢您提供的任何信息！

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2014-07-13T13:02:51.350

根据您的第一个问题，您需要在 NodeJs 中实现一些授权过程。我已经探索并使用了许多 NodeJs 的 API。我更喜欢以下用于企业应用程序的 API。

*   对于身份验证：如果在 AngularJS 中开发 SPA（前端），则使用[Passport](https://www.npmjs.org/package/passport)或[Satellizer 。](https://github.com/sahat/satellizer)

*   对于授权：[ACL](https://www.npmjs.org/package/acl)。方法和 REST API 上基于角色的安全性。如果您也想使用 RABC、ABAC，我想提一下[casbin 。](https://github.com/casbin/node-casbin)

其次，您需要 NodeJs 中的一些实现和开发方法。

*   Easy 和我最喜欢的 NodeJs 设计模式和框架：MVC 框架，[SailsJs](http://sailsjs.org)。因其准备启动和模块化架构。从长远来看，代码管理很容易（企业应用程序的最实际需求）。易于维护。SailsJs 还预配置了[Socket.io](https://socket.io/)，您可以使用它在项目中创建实时模块、小部件、聊天小部件。

*   [Express](https://expressjs.com/)您可以使用 Express 并设计自己的自定义 MVC 项目结构。这也是流行和强大的。[你可以在Yeoman](http://yeoman.io/)上找到相同的热门种子项目

*   [Redis](https://redis.io/)作为缓存或会话层。使用单独的缓存或会话层总是好的，因为它不会阻止您将云上的应用程序扩展到第 n 个实例。

*   您可以使用[Redis](https://redis.io/)和[Socket.io](https://socket.io/)创建实时功能，例如[地理位置](https://redis.io/commands/geoadd)、用户状态（在线/离线）、聊天、推送通知等等。

*   ORM：[水线](https://www.npmjs.org/package/waterline)。由于其简单的查询方法。它也是 SailsJs 的内置和默认 ORM。[如果不使用SailsJs](http://docs.sequelizejs.com/) ，您也可以使用 Sequelizejs。我建议使用数据库提供商提供的本机连接器。

*   数据库：根据您的要求。Waterline ORM 支持 PostgreSQL、MySQL、MongoDB 等。

*   我最喜欢的视图引擎：[EJS](http://embeddedjs.com/)。无需学习新事物来开发您的表示层。它也是 SailsJs 的内置和默认视图引擎，这就是为什么我是 SailsJs 的粉丝。

我想，我已经涵盖了在 NodeJs 中创建企业应用程序的所有重要信息。我并不是说，以上软件包是最好的，但是通过协作，它们可以最适合任何企业场景。还有其他已知的包，大家可以根据自己的需求使用。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-11-27T08:13:28.827

以下是一些入门信息：

*   [护照](http://passportjs.org/)是一种流行的身份验证模块
*   [express auth 示例](https://github.com/expressjs/express/blob/master/examples/auth/index.js)展示了如何在没有额外模块的情况下实现简单的身份验证
*   [express route中间件示例](https://github.com/visionmedia/express/blob/master/examples/route-middleware/index.js)说明如何实现基于角色的身份验证
*   nodejs.org 上关于[ldapjs 模块的](http://ldapjs.org/)[博客文章](http://blog.nodejs.org/2011/09/08/ldapjs-a-reprise-of-ldap/)

希望这会让开始变得更容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-07-26T11:18:16.357

另一种选择是使用与 MongoDB 很好集成的[CASL 。](https://stalniy.github.io/casl/)还有一篇关于如何将基于 CASL 的授权集成到 expressjs 应用程序中的文章 - [https://medium.com/@sergiy.stotskiy/authorization-with-casl-in-express-app-d94eb2e2b73b](https://medium.com/@sergiy.stotskiy/authorization-with-casl-in-express-app-d94eb2e2b73b)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-04T12:55:22.303

我应该说[节点授权](https://github.com/VinceZK/authorization)也是一个不错的选择。这个想法是从SAP（ERP提供商）借来的，它是一种面向对象的授权。它也可以用作其他框架的伴奏，例如：Passport 和 Express。

# c# - 序列化两个相互引用的对象

> ID：13546252
> 
> 赞同：2
> 
> 时间：2012-11-24T22:24:11.457
> 
> 标签：c#, xml, serialization

我目前正在第一次在 C# 中进行序列化，并且正在使用 XmlSerializer 类，但是我遇到了一个问题。我有两个相互引用的类，这在序列化时会导致错误。

该项目是一个类图绘制程序。每个类都有一个指向或指向它的箭头列表：

```
public List<UMLArrow> arrowlist; 
```

每个箭头都有一个起始类和一个结束类：

```
public UMLClass startingClass;
public UMLClass endClass; 
```

我想当我尝试序列化它时，由于这个问题，我进入了一个无限循环：

```
<UMLClass>
    <List<UMLArrow> >
        <UMLClass>
            <List<UMLArrow> >
                ...
            <List<UMLArrow> >
        </UMLClass>
    </List<UMLArrow>>
<UMLClass> 
```

有谁知道解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:30:37.443

我猜你已经实现了自己的序列化方法。实现循环依赖的序列化需要做的是为每个对象的表示添加一个 id 并跟踪序列化的对象。当你序列化一个对象时，你会检查它是否已经序列化。如果是，则只需序列化对该对象的引用及其 id。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T22:54:35.620

`XmlSerializer`不支持循环引用。您需要使用一个序列化程序。（`DataContractSerializer`如果用 初始化`preserveObjectReferences = true`）或`NetDataContractSerializer`do 支持它，因此您应该考虑更改您使用的序列化程序。

# mysql - 为文章内容解析 Wikipedia XML 转储并填充 MySQL 数据库的快速方法是什么？

> ID：13546254
> 
> 赞同：5
> 
> 时间：2012-11-24T22:24:13.720
> 
> 标签：mysql, mediawiki, wikipedia, text-mining

对于一些文本挖掘应用程序，我需要确定英语维基百科中每篇文章的每个单词的频率，并使用该数据填充 MySQL 数据库。[这个官方页面](http://www.mediawiki.org/wiki/Manual%3aImporting_XML_dumps)建议在转储上使用 mwdumper 或 xml2sql，但它们并不直接服务于我的目的（除非有人可以解释他们是如何做到的）。

另一方面，使用[WikiExtractor](http://medialab.di.unipi.it/wiki/Wikipedia_Extractor)、Python 的 MySQLdb 和本地 MySQL 服务器可以让我做我想做的事，但它的速度很慢，以至于解析整个转储需要一个月的时间。对修改后的 WikiExtractor 程序进行分析表明，大部分运行时都花在了它的嵌套正则表达式搜索和我的数据库插入中。

理想情况下，我不希望处理文章花费超过几天的时间。我怎样才能有效地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T17:28:36.787

Perl 包[MediaWiki::DumpFile](http://search.cpan.org/~triddle/MediaWiki-DumpFile-0.2.1/lib/MediaWiki/DumpFile.pm)非常适合解析。要加载转储并读取每个页面，您只需要很少的代码行。

要进行简单的词频计算，您可以使用[Perl FAQ 中的示例代码](http://search.cpan.org/~dom/perl-5.12.5/pod/perlfaq6.pod#How_can_I_print_out_a_word-frequency_or_line-frequency_summary?)或包[Text::Ngrams 来做](http://search.cpan.org/dist/Text-Ngrams/Ngrams.pm)一些更智能的事情。

将结果添加到数据库取决于您，因为您正在开发应用程序并且您应该知道需求。

# php - PHP-修剪（）函数不起作用

> ID：13546256
> 
> 赞同：6
> 
> 时间：2012-11-24T22:24:21.443
> 
> 标签：php, trim

`trim()`使用此代码的功能时遇到问题

```
$handle = @fopen("55.txt", "r");
if ($handle) {
    while (($buffer = fgets($handle, 4096)) !== false) {      
        $d = explode(" ", $buffer);
        foreach($d as $val) { 
            echo '<br>'.trim($val,'.');  //why not work 
        }   
    }
    if (!feof($handle)) {
        echo "Error: unexpected fgets() fail\n";
    }   
    fclose($handle);
} 
```

`trim()`不`'.'`修剪。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T22:46:09.660

除了行本身之外，该`fgets()`函数还返回文件中的换行符，这些换行符位于字符串中的点之后，从而防止点被修剪，因为它们实际上不是最后一个字符。

尝试同时修剪点和可能的换行符：

```
echo '<br>'.trim($val, ".\r\n"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:26:20.157

做

```
substr(trim($val),1,stlen(trim($val))); 
```

代替

```
trim($val,'.'); 
```

如果要删除前导和尾随`'.'`

# java - Java中的动态变量名称，因此每个新对象都有单独的名称

> ID：13546262
> 
> 赞同：1
> 
> 时间：2012-11-24T22:24:48.403
> 
> 标签：java, class, object

我怎么能做这样的事情？

```
String N = jTextField0.getText();
MyClass (N) = new Myclass(); 
```

它甚至可能吗？或者正如我的问题所解释的那样，我如何才能创建一个方法来创建我指定类的新对象，每次调用它时都使用不同的名称。我真的到处寻找，没有运气。提前致谢

PS我希望你们能原谅我不够清楚，就这样说吧，我制作了一个文本字段来获取想要创建帐户的人的姓名，并且我制作了一个名为“客户”的类。和一个名为“添加”的按钮。现在我希望每次单击“添加”时，编译器都会获取我的文本字段中的内容，并使用从文本字段中获取的内容命名“客户”类的对象

在评论中阅读它太难了，所以我再次更新了我的问题，很抱歉。我被困得太厉害了。我想我的问题是我没有“理解”你做了什么，只是试图复制它。这是我写的：

```
private void AddB0MouseClicked(java.awt.event.MouseEvent evt) {
    String name = NameT0.getText();
    Customer instance = new Customer(Name);
    Customer.customers.add(instance); 
```

这是我的客户课程：

```
public class Customer{
String name;
public Customer(String name){
this.name = name;
}
public String getName(){
    return name;
    }
static ArrayList<Customer> customers = new ArrayList<Customer>(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:29:11.277

变量名必须在编译时确定，它们甚至不是生成代码的一部分。所以没有办法做到这一点。

如果您希望能够为*您的对象命名*，您可以使用

```
Map<String, MyClass> map = new HashMap<>(); 
```

像这样向地图添加对象（例如）：

```
map.put(userInput, new MyClass()); 
```

并像这样检索对象：

```
MyClass mc = map.get(userInput); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:28:21.683

我不完全确定你的意思...

> 我如何才能创建一个方法来创建指定类的新对象，每次调用它时都使用不同的名称

...但是如果我对您的解释正确，我相信您正在尝试做的事情是 make`MyClass`接受构造函数参数。你可以做：

```
public class MyClass {
    private String name;

    public MyClass(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
} 
```

然后要创建 的新实例`MyClass`，请执行以下操作：

```
String name = jTextField0.getText();
MyClass instance = new MyClass(name);
instance.getName(); // returns the name it was given 
```

* * *

**编辑**

自从我第一次回答这个问题以来，您在评论中添加了说明，我想我会更新答案以描绘更多您正在寻找的功能。

要跟踪`MyClass`实例，您可以将它们添加到`ArrayList`. `ArrayList`对象可以按如下方式实例化：

```
ArrayList<MyClass> customers = new ArrayList<MyClass>(); 
```

`MyClass`然后对于您要添加的每个实例，执行以下操作：

```
customers.add(instance); 
```

请注意，`ArrayList`不应为您希望添加的每个实例重新实例化；你应该只实例化`ArrayList`一次。

# google-bigquery - 在 google Bigquery 中进行分组

> ID：13546263
> 
> 赞同：7
> 
> 时间：2012-11-24T22:24:58.403
> 
> 标签：google-bigquery

这是我的 BigQuery

```
SELECT word,word_count,corpus_date FROM 
[publicdata:samples.shakespeare] 
WHERE word="the" ORDER BY word_count asc 
```

输出为

```
 Row word    word_count corpus_date   
    1   the       57       1609  
    2   the       106      0     
    3   the       287      1609  
    4   the       353      1594  
    5   the       363      0     
    6   the       399      1592  
    7   the       421      1611 
```

我希望数据按 corpus_date 分组。我尝试使用按 corpus_date 分组

```
 SELECT word,word_count,corpus_date FROM 
   [publicdata:samples.shakespeare] 
    WHERE word="the" group by corpus_date 
    ORDER BY word_count asc 
```

但它不允许我按 corpus_date 进行分组。以任何方式获取按 corpus_date 分组的数据

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-25T20:57:44.413

您需要对查询中的所有非聚合值进行 GROUP BY。但是，由于您只是在寻找一个单词，因此您不需要在结果集中显示甚至 GROUP BY 该单词（它是使用 word="the" 子句隐式选择的）。

因此，如果您想要按日期分组的单词“the”的字数总和，您可以运行以下命令：

```
SELECT
  SUM(word_count) as sum_for_the,
  corpus_date
FROM
  [publicdata:samples.shakespeare]
WHERE
  word="the"
GROUP BY
  corpus_date
ORDER BY
  sum_for_the ASC; 
```

这本身并不是很有用......所以如果你想做更多的事情，例如了解每个日期的计数来自哪个语料库，请对单词的计数求和并使用如下查询列出语料库：

```
SELECT
  SUM(word_count) AS sum_for_the, corpus, corpus_date
FROM
  [publicdata:samples.shakespeare]
WHERE
  word="the"
GROUP BY
  corpus_date, corpus
ORDER BY
  sum_for_the ASC; 
```

为了列出每年出现一个单词的所有卷，我喜欢使用 GROUP_CONCAT 函数。“the”这个词出现在所有事物中，所以它可能不像“swagger”这样的不太常见的词那么有趣。（这是[莎士比亚发明的许多词](http://www.shakespeare-online.com/biography/wordsinvented.html)之一）。

```
SELECT
  SUM(word_count) AS word_sum, GROUP_CONCAT(corpus) as corpora, corpus_date
FROM
  [publicdata:samples.shakespeare]
WHERE
  word="swagger"
GROUP BY
  corpus_date ORDER BY corpus_date ASC; 
```

更有趣的是查看单词前缀，以及每个卷和日期的单词的 GROUP BY 变体：

```
SELECT
  word, SUM(word_count) AS word_sum, GROUP_CONCAT(corpus) as corpora, corpus_date
FROM
  [publicdata:samples.shakespeare]
WHERE
  word CONTAINS "swagger"
GROUP BY
  word, corpus_date
ORDER BY
  corpus_date ASC
IGNORE CASE; 
```

查看[BigQuery 查询语言](https://developers.google.com/bigquery/docs/query-reference)参考和[BigQuery Cookbook](https://developers.google.com/bigquery/docs/query-cookbook)了解更多示例。

# python - 通过标题名称访问 Google 电子表格数据

> ID：13546265
> 
> 赞同：3
> 
> 时间：2012-11-24T22:25:24.620
> 
> 标签：python, google-sheets, google-drive-api, google-spreadsheet-api

Google Spreadsheet API 让您可以使用标题名称向电子表格添加行，此过程在[此处描述](https://developers.google.com/google-apps/spreadsheets/#adding_a_list_row)

然而，该文档仅给出了一个简单案例的示例，其中标题文本由小写文本（或适合表达式 [a-z0-9] 的文本）组成。

我的应用程序要求我能够为文本设置任意标题名称（即那些不一定符合上述表达式的标题）。通过大量实验，我发现通常不支持特殊字符和符号（句号除外）。要访问使用包含特殊字符的标题行的电子表格，必须使用已删除特殊字符的标题文本。

这些转换没有[记录在案](https://stackoverflow.com/a/11605522/1193813)，我发现它们主要是通过反复试验。

例如，要`'Foo Bar'`通过 API 访问带有标题的列，需要将标题文本转换`'foobar'`为。同样，`'Foo.Bar'` 变成`'foo.bar'`。

一些特殊字符也必须消除，但是我的代码中不断出现极端情况。

**需要对实际的标题文本进行哪些转换才能通过 API 访问它？**

同样对于这个[电子表格](https://docs.google.com/spreadsheet/ccc?key=0ArksTvA-IDdcdEpRM0w1LUtERzV1cmY0X2tnMFRIUUE#gid=0)，标题文本的转换`'País'`似乎`'país'`不起作用。我怀疑它与非 ASCII 字符有关`'í'`

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T14:07:29.083

您必须记住，在使用“列表提要”时，它使用 XML 元素来分隔每个值，并从工作表的第 1 行中获取字段名称。因此，名称的限制是 XML 元素名称的限制。XML.com 上有一篇关于[这里](http://www.xml.com/pub/a/2001/07/25/namingparts.html)的文章。

至于他们用于将各种标题单元格值转换为有效 XML 元素名称的确切算法，我从未见过谷歌指定这一点（尽管人们之前已经要求澄清）。但是，人们可能会想象它是这样的：

```
foreach char in cell.value {
   if (isAllowed(char)) {
      name += char;
   }
}
return name; 
```

当然，它们确实倾向于*省略*空格（例如），而不是将它们（这是相当合理的）转换为下划线。

现在关于 ASCII 集之外的字符......

如果您的 í 是“LATIN SMALL LETTER I WITH ACUTE”，那么它的 Unicode 代码点是 U+00ED，并且它在 XML-land 中写为 í。因此，它是 XML 名称的有效字符。从[http://www.w3.org/TR/REC-xml/#NT-NameChar](http://www.w3.org/TR/REC-xml/#NT-NameChar)，它*似乎*是一个有效的`NameStartChar`

```
 [4]    NameStartChar      ::=      ":" | [A-Z] | "_" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]
 [4a]       NameChar       ::=      NameStartChar | "-" | "." | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040]
 [5]    Name       ::=      NameStartChar (NameChar)* 
```

如果他们确实有像上面这样的算法，那么 í 应该是'in'。但是，我会密切注意您发送电子表格 API 的编码，以及它发送回给您的编码。我不会让谷歌在这方面出现错误。

您当然可以做一个实验：使用 Google Apps 用户界面将值放在工作表的标题行，然后对 List 提要执行 GET，以查看 XML 的实际结果。（但我希望你到目前为止一直在你的实验中使用它）。

祝你好运。

# ios - 访问 2 个视图控制器

> ID：13546267
> 
> 赞同：0
> 
> 时间：2012-11-24T22:25:32.530
> 
> 标签：ios, xcode

我正在创建一个 ipad 应用程序，我有两个 iphone 5 尺寸屏幕的视图控制器，我想在 ipad 屏幕上显示它们，尽管它们是两个不同的 UIViewControllers。有没有办法做到这一点？我试图在第一个的 viewdidload 中分配第二个 viewcnotrller，但我注意到它分配了第一个和第二个，但第一个不再可访问（它看起来就像静止图像）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:04:47.060

您可以在情节提要中非常轻松地做到这一点。只需将 2 个容器视图（在对象列表中的常规 UIView 旁边）添加到控制器的视图中，然后根据需要调整它们的大小。您将通过嵌入 segue 自动获得 2 个连接到容器视图的视图控制器。只需将这 2 个控制器的类更改为您的自定义类，就可以了。如果需要从主控制器中获取对这些控制器的引用，可以从 childViewControllers 属性中获取。您的主控制器（假设它是初始控制器）和 2 个子控制器都将在启动时实例化，无需任何代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:49:39.803

查看[view controller contains](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81)，其中您有一个容器视图控制器，然后它可以加载一个或多个子视图控制器。[另请参阅View Controller Programming Guide](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW6)中的相关部分。另请参阅 WWDC 2011 会议，[Implementing UIViewController Containment](https://developer.apple.com/videos/wwdc/2011/?id=102)。

# css - 从支持媒体查询的浏览器中隐藏样式表

> ID：13546268
> 
> 赞同：1
> 
> 时间：2012-11-24T22:25:36.247
> 
> 标签：css, media-queries, legacy

我正在尝试创建一个响应式网站。该设计有 3 个中断，分别为 480px、768px 和 1024px。我在文档头中的链接部分如下所示：

```
<link media="only screen and (max-device-width: 479)" href="320.css" type="text/css" rel="stylesheet" />
<link media="only screen and (min-device-width: 480) and (max-device-width: 767)"  href="480.css" type="text/css" rel="stylesheet" />
<link media="only screen and (min-device-width: 768) and (max-device-width: 1023)" href="768.css" type="text/css" rel="stylesheet" />
<link media="only screen and (min-device-width: 1024)" href="1024.css" type="text/css" rel="stylesheet" /> 
```

这样做的问题是，不理解媒体查询的旧设备不会加载任何样式表。

有没有办法包含一个样式表，它只被**不**支持媒体查询的设备识别，比如旧的 Internet Explorer？

我宁愿不为所有浏览器包含此样式表，然后重置或覆盖它。

谢谢，约斯特

# c++ - 使用 fread() 和 UDP 套接字通过网络传输 pdf 文件

> ID：13546271
> 
> 赞同：0
> 
> 时间：2012-11-24T22:25:43.910
> 
> 标签：c++, c, unix

我正在制作一个使用 UDP 套接字通过网络传输文件的程序。我已经实现了处理丢失/重复数据包的协议，并且我的程序在文本文件上运行良好。但对于 pdf 文件，程序无法正确传输文件。我正在使用 fread() 来读取文件，并且我正在使用 linux。实际上我想知道pdf文件是否可以存储在char数组中，然后通过套接字传输，然后在客户端再次写入pdf。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:35:56.700

当然可以...如果您的文件传输内容可以传输字符而不管其内容如何。正如您所说，您可以传输文本文件。然后你可以尝试首先将你的pdf编码成一个帮助格式，例如 uuencode my.pdf somename>my.uue

# c# - SharePoint TimerJob：在类/静态方法的实例中使用 SPListItem.Update()

> ID：13546272
> 
> 赞同：5
> 
> 时间：2012-11-24T22:25:54.447
> 
> 标签：c#, sharepoint, sharepoint-2010, timer, timer-jobs

我创建了一个计时器作业（*SPJobDefintion*），它已正确注册并在 sharepoint 2010 环境中工作。

在 Timer Job 的*Execute*方法中，我可以使用以下代码，它设置特定*SPListItem*的字段。这工作正常。

```
using (SPSite mySite = new SPSite(mySiteId))
{
  using (SPWeb myWeb = mySite.OpenWeb(myWebId)))
  {
    SPList myList= myWeb.Lists[myListId];
    SPListItem myItem = myList.GetItemById(myItemId);

    myItem["myField"] = myValue;
    myItem.Update();
   }
} 
```

出于设计原因，我想将该代码放在单独类的单独方法中。所以我创建了以下类：

```
namespace myNamespace
{
  class myClass
  {

    [...some stuff...]        

    public myClass()
    {
      [...more stuff...]
    }

    public void setField()
    {
      using (SPSite mySite = new SPSite(mySiteId))
      {
        using (SPWeb myWeb = mySite.OpenWeb(myWebId)))
        {
          SPList myList = myWeb.Lists[myListId];
          SPListItem myItem = myList.GetItemById(myItemId);

          myItem["myField"] = myValue;
          myItem.Update();
        }
      }
    }
  }
} 
```

实际上，我希望在计时器作业的*Execute*方法中调用以下代码应该以相同的结果结束。

```
MyClass myClassInstance = new myClass();
myClassInstance.setField(); 
```

不幸的是，我会遇到以下异常：

```
Microsoft.SharePoint.SPException was unhandled by user code
  Message=""
  Source=Microsoft.SharePoint
  ErrorCode=-2147418113
  NativeErrorMessage=FAILED hr detected (hr = 0x8000ffff)

  NativeStackTrace=""
  StackTrace:
       bei Microsoft.SharePoint.SPGlobal.HandleComException(COMException comEx)
       bei Microsoft.SharePoint.Library.SPRequest.AddOrUpdateItem(String bstrUrl, [...])
       bei Microsoft.SharePoint.SPListItem.AddOrUpdateItem(Boolean bAdd, Boolean bSystem, [...])
       bei Microsoft.SharePoint.SPListItem.UpdateInternal(Boolean bSystem, [...])
       bei Microsoft.SharePoint.SPListItem.Update()
       bei myNamespace.myClass.<>c__DisplayClass1.<setField>b__0()
   InnerException: System.Runtime.InteropServices.COMException
       Message=<nativehr>0x8000ffff</nativehr><nativestack></nativestack>
       Source=""
       ErrorCode=-2147418113
       StackTrace:
            bei Microsoft.SharePoint.Library.SPRequestInternalClass.AddOrUpdateItem(String bstrUrl, [...])
            bei Microsoft.SharePoint.Library.SPRequest.AddOrUpdateItem(String bstrUrl, [...])
       InnerException: 
```

当我把*setField()*方法直接放在*Execute*方法所在的类中时，该方法就可以正常工作了。如果我将此方法声明为静态，则会发生相同的异常。

我还尝试使用提升的权限运行发生异常的*SPListItem.Update()*（应该不是原因，因为代码应该在 OWSTIMER 上下文中运行）。我还尝试在 SPSite 和 SPWeb 上使用 allowUnsafeUpdates()。两者都没有成功。

在网络上，我只找到了这个问题的一个描述[http://codekicker.de/fragen/sharepoint-2010-Sharepoint-2010-TimerJob-wirft-Fehler-timer](http://codekicker.de/fragen/sharepoint-2010-Sharepoint-2010-TimerJob-wirft-Fehler-timer)（德语），不幸的是没有任何解决方案。

还有什么可能是这个星座不起作用的原因？任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:11:06.820

它肯定需要 myWeb.AllowUnsafeUpdates = true; 在更新任何列表项之前。更新后不要忘记将其重置为false。

我要确保的一件事是确保代码正在运行的用户拥有更新项目的完全权限。我建议以站点管理员身​​份登录并尝试从按钮单击事件（而不是计时器作业）或其他事件运行代码，以确保它不是用户权限问题。

谢谢

森提尔

# php - 如何成功使用 PhpWebSocket？

> ID：13546275
> 
> 赞同：0
> 
> 时间：2012-11-24T22:26:19.633
> 
> 标签：php, apache, websocket, phpwebsocket

我尝试使用[PhpWebSocket](http://code.google.com/p/phpwebsocket/)但如果我没有将预期的端口（比如 1234）添加到 httpd.conf（`Listen 1234`），我得到：

```
No connection could be made because the target machine actively refused it 
```

但是如果我添加它，我会在调用时收到此错误`socket_bind`：

```
Address already in use 
```

对于任何端口都是如此（我尝试了几个）。我使用 CentOS 6。

## 编辑1：

根据[Jan Prieser](https://stackoverflow.com/users/1496136/jan-prieser)的评论，我`Listen 1234`从 httpd.conf 中删除了，现在的问题是：

```
No connection could be made because the target machine actively refused it 
```

所以我猜它可能是 SELinux 和防火墙，但似乎两者都没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T05:36:40.217

PHPWebSocket 自 2010 年以来一直没有更新。如果您正在寻找基于 PHP 的解决方案，我建议您查看[Ratchet](http://socketo.me)，它维护得非常积极。

# android - 在 Java 中按日期对时间戳进行排序

> ID：13546286
> 
> 赞同：0
> 
> 时间：2012-11-24T22:26:54.630
> 
> 标签：android, timestamp

我的班级`Event`有一堆不同的变量，如**名称**、**描述**、**开始时间**和**结束时间**，然后我有`Day`班级有可变日期和`ArrayList`这些`Events`。现在我想要 ArrayList `Days`，并且每个都`Day`应该包含`Events`在同一天。默认情况下，我得到事件列表，我需要根据这个列表创建日期。所有时间都是**int** `unix timestamp`格式。

澄清我所追求的示例：

```
Day 25.11
Event1
Event2
Event3

Day 26.11
Event1

Day 27.11
Event1
Event2
Event3
Event4 
```

我尝试了没有工作结果的代码：

```
private void getObjects(String url) throws JSONException, Exception {
    JSONObject jsonObject = new JSONObject(new NetTask().execute(url).get());
        JSONArray job1 = jsonObject.getJSONArray("events");
        ArrayList<Event> events = new ArrayList<Event>();
        Calendar calPrev = Calendar.getInstance();
        boolean first = true;
        for (int i = 0; i < job1.length(); i++) {
            JSONObject myEventArray = job1.getJSONObject(i);
            int start = myEventArray.getInt("start");
            int end = myEventArray.getInt("end");
            String name = myEventArray.getString("name");
            String description = myEventArray.getString("description");

            if(first){
                calPrev.setTimeInMillis(start*1000L);
                events.add(new Event(start,end,name,description));
                first = false;
            }else{
                Calendar calCur = Calendar.getInstance();
                calCur.setTimeInMillis(start*1000L);

                if(calPrev.get(Calendar.YEAR) == calCur.get(Calendar.YEAR) && calPrev.get(Calendar.DAY_OF_YEAR) == calCur.get(Calendar.DAY_OF_YEAR)){
                    events.add(new Event(start,end,name,description));
                }else{
                    days.add(new Day(323,events)); // HERE I CREATE NEW DAY AND ADD IT TO ARRAY
                    events.clear();
                    events.add(new Event(start,end,name,description));
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:40:07.527

您可以使用此方法获取唯一日期，然后将每天的事件添加到哈希图中`private HashMap<Integer, ArrayList<YourModel>> eventInfo = new HashMap<Integer, ArrayList<YourModel>>();`：

```
private List<String> getUniqueDays(List<YourModel> list)
{
    Set<String> res = new LinkedHashSet<String>();

    for (int i = 0; i < list.size(); i++)
    {
        if (list.get(i).getDay().length() > 0)
            res.add(list.get(i).getDay());
    }

    List<String> temp = new ArrayList<String>(res);
    Collections.sort(temp, dateComparator);
    return temp;
}

Comparator<String> dateComparator = new Comparator<String>()
{
    @Override
    public int compare(String lhs, String rhs)
    {
        try
        {
            DateFormat format = new SimpleDateFormat("MM-dd-yyyy h:mm:ss a");
            return format.parse(lhs).compareTo(format.parse(rhs));
        }
        catch (Exception e)
        {
            return 0;
        }
    }
}; 
```

# java - JPA 级联创建紧密耦合

> ID：13546289
> 
> 赞同：1
> 
> 时间：2012-11-24T22:27:49.897
> 
> 标签：java, jpa, entity, entity-relationship, cascade

JPA 提供了级联，可用于自动持久化/更新/删除特定实体所依赖的其他实体。假设我有三个实体：Job、BankAccount 和 Person（与前两个实体具有 OneToMany 关系）。在没有级联事件的情况下，我会写：

```
person.addJob(job);
person.addBankAccount(bankAccount);

em.persist(job);
em.persist(bankAccount);
em.persist(person); 
```

级联事件（例如 CascadeType.PERSIST 类型）使我能够省略前两个 persist() 调用，并确保单个`em.persist(person);`调用也将持久化依赖实体。

现在，这使得作用于实体的代码与其内部紧密耦合。我管理实体的方式现在与我在实体中使用的注释紧密绑定。由于它引入了额外的耦合，这可以被认为是一种不好的做法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T22:37:42.637

并非如此，利用级联操作是相当标准的做法。

您应该创建集成测试来验证在您的域上注释的任何级联实际发生。

# function - 对函数地址使用 JMP 有什么影响？

> ID：13546291
> 
> 赞同：7
> 
> 时间：2012-11-24T22:27:56.813
> 
> 标签：function, assembly, ida

当我试图弄清楚某个函数是如何工作的时，我正在查看 IDA 中的一个程序，当我遇到这样的事情时：

```
; C_TestClass::Foo(void)
__text:00000000 __ZN14C_TestClass7FooEv proc near
__text:00000000                 jmp     __ZN14C_TestClass20Barr ; C_TestClass::Barr(void)
__text:00000000 __ZN14C_TestClass7FooEv endp
__text:00000000 
```

谁能向我解释在这种情况下跳转到一个函数究竟会做什么？我猜它充当其他功能的包装器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T22:33:53.297

您是正确的，跳转通常是一种有效处理未内联的包装函数的方法。

通常，您必须先读取所有函数参数并将它们推回堆栈，然后才能调用子函数。

但是当包装函数具有完全相同的原型时：

1.  相同的调用约定
2.  相同的参数（并且以相同的顺序）
3.  相同的返回类型

不需要所有通常的函数调用开销。你可以直接跳到目标。（这些类别可能不是完全必要的，因为在其他一些情况下仍然可能。）

在调用包装函数时设置的所有参数（在堆栈或寄存器上）都已经为子函数准备好了（并且兼容）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T22:34:48.177

这就是所谓的*tail-call*。编译器能够直接调用该函数并让它*返回*给原始调用者而不会造成任何问题。例如：

```
int f(int x)
{
    ...
    return g(y);
} 
```

编译器可以简单地`jmp g`在最后，因为在与 ' 的参数相同的位置有参数的空间，`f`并且在返回到`f`' 的调用者之前不会修改返回值。

# google-app-engine - GAE 1.7.3 - 如何调试 appengine-web.xml XML 错误验证

> ID：13546296
> 
> 赞同：0
> 
> 时间：2012-11-24T22:28:07.920
> 
> 标签：google-app-engine

如何修复 appengine.web.xml 中的 xml 验证错误。

首先，错误消息告诉我添加“true”。

现在它只是失败了，说验证失败 - 但是，该怎么办？

我确实通过创建一个新的 ApEngine 项目并将其复制过来解决了这个问题，但是您如何找到错误？

寻找发现错误的过程？

问候

# php - PHP 重定向到 URL 变量

> ID：13546297
> 
> 赞同：0
> 
> 时间：2012-11-24T22:28:09.700
> 
> 标签：php, html, variables, redirect

我正在尝试制作一个重定向页面，当您访问 www.website.com/redirect.php?link=http://example.com 时，您的浏览器会在几秒钟内重定向到 example.com重定向免责声明。您的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T22:42:49.063

Javascript 工作，但你不需要它，只需使用元刷新

```
<?php 

$url=$_GET['link'];

?>
<html>
    <head>
        <title>Rediercting</title>
        <meta http-equiv="refresh" content="10;URL='<?php echo $url; ?>'" />
    </head>
    <body>
        <p><a href="<?php echo $url; ?>">Redirecting to <?php echo $url; ?></a></p>
        <p>Some disclaimer</p>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T22:34:53.713

```
<?php
    echo "disclaimer here";
?>
    <script type="text/javascript">
        setTimeout(function() { location.href = '<?php echo $_GET["link"]; ?>'; }, 3000);
    </script>'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T22:30:50.000

PHP 是服务器端脚本，因此您将无法在延迟后重定向（因为这将在页面加载后发生，因此此时由客户端处理重定向）。

尝试使用看起来像这样的页面：

```
<html>
    <head>
        <script type="text/javascript">
            function delayer(){
                window.location = "<?php echo $_GET['link']; ?>"
            }
        </script>
    </head>
    <body onLoad="setTimeout('delayer()', 5000)">
        Some info about the redirect!
    </body>
</html> 
```

这里有三个主要组成部分：

1) JavaScript：函数`delayer()`在 5 秒后被调用。

2) PHP：这会将`GET`参数`link`插入到 JavaScript 函数中。

3) HTML：这是您可以插入免责声明的地方，其中代码显示“有关重定向的一些信息！”，在标准 HTML 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T22:31:44.997

您需要先通过 JavaScript 执行此操作才能获得免责声明消息。

```
<html>
 <head>
  <title>Redirect</title>
 <script type="text/javascript">
    function redirect(){
        window.location = "<?php echo $link; ?>";
    }
 </script>
 </head>
 <body onload="setTimeout(redirect(), 5000);">
  <B>DISCLAIMER HERE</B>
 </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-24T22:52:18.963

正如用户名 tbd 已经说过的，您不能在服务器端延迟重定向。

JavaScript 解决方案的替代方案是原生 HTML

```
<!doctype html>
<html>
    <head>
        <meta http-equiv="refresh" content="15; url=<?php echo $redirectTarget; ?>">
    </head>
    <body>
         Your disclaimer
    </body>
<html> 
```

15 表示重定向完成前等待的时间（以秒为单位）。

# python - 使用 cx_Oracle 插入 CLOB

> ID：13546303
> 
> 赞同：5
> 
> 时间：2012-11-24T22:28:54.757
> 
> 标签：python, oracle, cx-oracle

我正在尝试使用以下代码插入 CLOB。

```
cursor = connection.cursor()
cursor.setinputsizes(HERP = cx_Oracle.CLOB)

cursor.execute("INSERT INTO myTable (FOO, BAR) VALUES (:FOO, :BAR)", FOO=val1, BAR=val2)
cursor.execute("INSERT INTO myTable2 (HERP) VALUES (:HERP)", HERP=val3) 
#len(HERP) 39097 
```

当我运行脚本 WITHOUT`cursor.setinputsizes(HERP = cx_Oracle.CLOB)`时，它在第二个查询 WITH 上失败`ValueError: string data too large`，当我运行脚本时，`cursor.setinputsizes(HERP = cx_Oracle.CLOB)`它在第一个查询时失败`DatabaseError: ORA-01036: illegal variable name/number`。我试图插入的 CLOB 包含一个代码片段（即它有很多分号、逗号和括号），`"string".decode("ascii")`返回`u'string'`，所以 unicode 不是问题......对吗？我不知道这些事情是否有问题。数据库中的字段当前是 CLOB，但是我已经尝试使用 NCLOB 并且行为没有改变。

我也尝试将该字段作为 BLOB，然后`.encode("hex")`在我插入的值上使用，同样的行为。

我也尝试过，`HERP = cursor.var(cx_Oracle.CLOB)`而不是`cursor.setinputsizes(HERP = cx_Oracle.CLOB)`相同的问题。

我一直在讨论[cx-oracle-users](http://comments.gmane.org/gmane.comp.python.db.cx-oracle/2302)列表，但还没有运气。

如果我使用这条线，它会起作用`cursor.execute("INSERT INTO myTable2 (HERP) VALUES (:HERP)", HERP="".join(set(val3)).encode("hex"))`，所以我认为这不是数据内容的问题（这是与 BLOB 相关的）。

如何使用`cx_Oracle`将 CLOB 插入 Oracle 数据库？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T15:22:15.187

有几种可能的解决方案：

1.  升级 cx_Oracle。我不确定您使用的是哪个版本，但我使用的是带有 cx_Oracle 5.1 的 python 2.7.2，并且在不使用 setinputsizes 的情况下将 150,000 个字符插入 CLOB 列时没有任何错误。
2.  由于 setinputsizes 适用于每个后续游标使用，因此只需在这些不同的 cursor.execute 语句之间更改它。

例如：

```
cursor = connection.cursor()
cursor.setinputsizes(FOO=None, BAR=None)
cursor.execute("INSERT INTO myTable (FOO, BAR) VALUES (:FOO, :BAR)", 
FOO=val1,  BAR=val2)
cursor.setinputsizes(HERP = cx_Oracle.CLOB)
cursor.execute("INSERT INTO myTable2 (HERP) VALUES (:HERP)", HERP=val3) 
```

# visual-c++ - 在项目属性中添加目录时，无法从 .h 文件中引用标识符

> ID：13546305
> 
> 赞同：0
> 
> 时间：2012-11-24T22:29:17.977
> 
> 标签：visual-c++

在项目属性中，我已将 .h 文件夹添加到“附加包含目录”，将 lib 文件夹添加到“附加库目录”，还将 lib 文件添加到“附加依赖项”。

但是我仍然不能使用 .h 文件中的标识符。我收到“标识符未定义”并且在“外部依赖项”中没有看到 .h 文件。

我还应该做什么？

为什么我在“外部依赖项”中添加到“其他包含目录”的文件夹中看不到 .h 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T22:43:30.500

我发现我必须添加`#include <neededlibrary.h>`. 一旦将这样的行添加到 cpp 文件中，所需的文件就会自动放置到外部依赖项中。

# objective-c - MKCoordinateRegion 是跨中心到边界还是边界到边界？

> ID：13546307
> 
> 赞同：3
> 
> 时间：2012-11-24T22:29:33.773
> 
> 标签：objective-c, ios, mapkit, mkcoordinateregion

MKCoordinateRegion 的跨度是表示从中心到每个边界的距离还是从边界到边界的距离？

如果我想计算区域的边界，我从中心添加/减去跨度还是需要 /2？

lowerLatitude=center-span.latitudeDelta 或 lowerLatitude=center-(span.latitudeDelta/2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:41:18.063

运行此代码：

self.mapView.region = MKCoordinateRegionMake(CLLocationCoordinate2DMake(0.0, 0.0), MKCoordinateSpanMake(23.5, 10.0));

我能看到最北到西撒哈拉的边界，最南到埃托沙国家公园；西至塞内加尔西海岸；向东远至恩贾梅纳。

基于此，再加上一点时间使用谷歌地图，看起来整个跨度总共是南北 47 度和东西 20 度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T03:32:46.840

跨度是边界到边界的距离。如果你能看到的最西风的地方是 10 度，最东风的地方是 20 度，那`longitudeDelta`将是 10 度（跨度）。中心坐标的经度为 15 度（一个点，而不是跨度）。

换句话说，跨度是中心到边缘距离的两倍。中心是两个跨度的中间点。

# android - ADK - 无法使用 R.id.x 找到布局

> ID：13546314
> 
> 赞同：1
> 
> 时间：2012-11-24T22:30:30.763
> 
> 标签：android, eclipse, background, adt

我正在尝试更改我的 Android 应用程序的背景颜色（我是 ADK 的新手）。
我在另一个问题中读到，我必须在我的主布局（RelativeLayout）和应用程序中的所有其他视图之间使用另一个 LinearLayout，并改为更改它的颜色。我想要一个偏好来指示背景更改为哪种颜色，以及偏好活动和一切运行顺利；但是，当我将 R.id.bg（*bg*是 LinearLayout 的 ID）传递给 findViewById() 时，每当我尝试更改背景颜色时，它都会返回 null 并抛出 NPE。

编辑：你知道吗，这是整个班级的来源。:P

```
public class Preferences extends PreferenceActivity implements
    OnSharedPreferenceChangeListener {

    SharedPreferences prefs;

    @Override
    protected void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);

        prefs = PreferenceManager.getDefaultSharedPreferences(this);
        prefs.registerOnSharedPreferenceChangeListener(this);

    }

    private void showToast(CharSequence text) {
        Context context = getApplicationContext();
        showToast(context, text, 3000);
    }

    private void showToast(Context context, CharSequence text, int duration) {
            Toast toast = Toast.makeText(context, text, duration);
            toast.show();
    }

    @Override
    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,
            String key) {

        if (key.equalsIgnoreCase("list_color")) {

            LinearLayout bg = (LinearLayout) findViewById(R.id.bg);
            String color = sharedPreferences.getString("list_color", "White");

            if (bg == null) {

                showToast("Unable to change background color");

            } else {

                if (color.equals("White")) {
                    bg.setBackgroundColor(android.R.color.white);
                    showToast("Background color set to white");
                } else if (color.equals("Black")) {
                    bg.setBackgroundColor(android.R.color.black);
                    showToast("Background color set to black");
                }

            } // end NP test

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:59:42.573

您不能`View`以传统方式直接从首选项中获取。

你能做的最接近的是[`Preference`](http://developer.android.com/reference/android/preference/Preference.html)使用[`findPreference()`](http://developer.android.com/reference/android/preference/PreferenceActivity.html#findPreference%28java.lang.CharSequence%29)：

```
Preference myPreference = findPreference("key"); 
```

如果你需要`View`（我假设你这样做），你可以试试这个：

```
View v = myPreference.getView(null, null); 
```

这应该返回`View`代表`Preference`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-24T23:41:19.190

显示您的 onCreate 方法。也许您忘记添加`setContentView(R.layout.your_layout);`：

```
super.onCreate(savedInstanceState);
setContentView(R.layout.your_layout); 
```

或导入不正确的 R 文件。

# android - admob : 改变广告

> ID：13546318
> 
> 赞同：1
> 
> 时间：2012-11-24T22:30:53.710
> 
> 标签：android, admob

我使用以下代码在活动的 onCreate() 中显示广告由于我的活动显示时间较长，我可以刷新广告吗？还是会自动刷新它们？我什至需要更改它们还是不应该打扰它？

```
 //only ask for test ad, in emulator , should remove this later in real device
        AdRequest adRequest = new AdRequest();
        //adRequest.addTestDevice(AdRequest.TEST_EMULATOR);               // Emulator
        //adRequest.addTestDevice("TEST_DEVICE_ID");                

         // Create the adView
        adView = new AdView(this, AdSize.BANNER, "908908098098");

        // Lookup your LinearLayout assuming it’s been given
        // the attribute android:id="@+id/mainLayout"    

        LinearLayout layout = (LinearLayout)findViewById(R.id.adLayout);

        // Add the adView to it
        layout.addView(adView);

        // Initiate a generic request to load it with an ad
        adView.loadAd(adRequest); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T22:45:20.470

更改 admob 帐户中的应用设置：

![在此处输入图像描述](../Images/381b23b1156d9218f045299629cc9e42.png)

此外，您应该在发布之前删除测试模式：

```
 AdView adView = (AdView) findViewById(R.id.ad);
    AdRequest adRequest = new AdRequest();
    adView.loadAd(adRequest); 
```

在 onDestroy() 中：`adView.destroy();`

在布局中：

```
<com.google.ads.AdView
    android:id="@+id/ad"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    ads:adSize="BANNER"
    ads:adUnitId="@string/admob_publisher_id"
    ads:loadAdOnCreate="true" >
</com.google.ads.AdView> 
```

在 AdMob 应用设置中选择此项：禁用所有请求的测试模式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:38:16.523

Admob 广告以您的 admob 帐户中设置的速率刷新。转到您的帐户，单击“管理设置”，然后单击“应用程序设置”，然后在此处查找自动刷新参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-01T11:42:17.143

将活动中的 adView 声明为数据成员，然后在活动的构造函数中创建 Timer Task，如下所示

```
adView = (AdView) findViewById(R.id.adView);
        TimerTask tt = new TimerTask() {

            @Override
            public void run() {
            MainActivity.this.runOnUiThread(new Runnable() {
                public void run() {
                    adView.loadAd(new AdRequest());
                }
            });

        }
    };

    Timer t = new Timer();
    t.scheduleAtFixedRate(tt, 0, 1000 * 60); 
```

# django - Django - 如何在通用外键中引用特定类型？

> ID：13546319
> 
> 赞同：0
> 
> 时间：2012-11-24T22:30:57.923
> 
> 标签：django, django-models, generic-foreign-key

我创建了一个通用外键，以便能够以通用方式引用 Report 模型中的任何类型（A 或 B）模型。
它工作正常，但我的问题是现在，我需要进行查询以检索所有引用特定类型模型的报告实例（例如，所有具有引用类 A 的外键的报告）。我试图访问数据库中的 content_type 但显然不可能（变量不存在......）
这是我的模型：

```
class Report(models.Model):
  content_type = models.ForeignKey(ContentType)
  object_id = models.CharField(max_length=50)
  reported_item = generic.GenericForeignKey('content_type', 'object_id')

class A(models.Model):
  reports = generic.GenericRelation(Report)

class B(models.Model):
  reports = generic.GenericRelation(Report) 
```

你知道怎么做吗？
以防万一它会改变任何东西，我使用 mongoDB 作为我的数据库。
非常感谢！

编辑：
当我在数据库中显示报告对象时，结果如下：

```
db.website_report.findOne()
{
"_id" : ObjectId("50afa903a96c5c2f63000001"),
"content_type_id" : ObjectId("50afa903a96c5c2f63000000"),
"object_id" : "50afa8a8a96c5c2f53000001",
} 
```

如您所见，数据库的内容与我的模型没有任何相似之处，所以我不知道如何进行查询以获取所有具有外键 A 的报告。
您能帮帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:17:59.140

我不明白你为什么认为 db 不能反映你的模型。那里有内容类型引用和对象 ID。您需要做的只是找出什么内容类型引用了您的模型 A，内容类型[文档中对此](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#the-contenttypemanager)进行了说明：

```
ct = ContentType.objects.get_for_model(A)
objs = Report.objects.filter(content_type=ct) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:19:31.500

这是我的一个项目中的一个示例类，它显示了某些模型和使用 Q 对象的应用程序的限制

```
class ContainerItem(models.Model) :
    """Items for containers"""
    limit = models.Q(model="page") & (models.Q(app_label='events') | models.Q(app_label='press')) & ~models.Q(app_label='press', model='category')
    object_type = models.ForeignKey(ContentType, limit_choices_to=limit)
    object_id = models.IntegerField(db_index=True)
    object = generic.GenericForeignKey(
        ct_field = "object_type", 
        fk_field = "object_id"
    ) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-24T22:49:01.440

[无法过滤 GenericForeignKeys：](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#django.contrib.contenttypes.generic.GenericForeignKey)

> 由于 GenericForeignKey 的实现方式，您不能通过数据库 API 直接将此类字段与过滤器（例如 filter() 和 exclude()）一起使用。因为 GenericForeignKey 不是普通的字段对象，所以这些示例将不起作用：

# android - 在 Android 4.2 中无法让屏幕保持休眠状态

> ID：13546321
> 
> 赞同：0
> 
> 时间：2012-11-24T22:31:41.387
> 
> 标签：android, wakelock

我有一个为 Android 编写的简单电池测试应用程序，现在已成功用于多个版本。它在 Android 4.1 中运行良好 该应用程序只需将 chrome 浏览器启动到不同的网站，将时间记录到数据库中，等待 60 秒，然后重新开始。

现在，在 Android 4.2 中，屏幕关闭并且系统进入睡眠状态，尽管我有一个唤醒锁并将屏幕超时设置为从不使用设置。最烦人的是它在不确定的时间关闭，而不是在开始测试后的固定时间。知道我需要做什么吗？

这是我在一遍又一遍地启动浏览器的服务中调用的唤醒锁代码。

```
 super.onCreate();
    // Wakelock
    PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "My Tag");
    wl.acquire(); 
```

我也把它放在布局文件中

机器人：keepScreenOn="真"

但是，在整个测试过程中，应用程序的屏幕本身并不可见，因为 Chrome 始终是前台窗口，并且浏览器启动器是一项服务，而唤醒锁在服务中。

知道如何防止屏幕超时吗？似乎没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T18:30:53.927

只需将以下行添加到您的 XML 文件中......

机器人：keepScreenOn="真"

:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:08:48.530

我猜Android正在杀死您的服务并导致您的唤醒锁被释放。尝试让您的服务在前台运行（使用[startForeground()](http://developer.android.com/reference/android/app/Service.html#startForeground%28int,%20android.app.Notification%29)），看看是否有帮助。

# android - getCheckedItemCount() 在光标更改后返回错误值

> ID：13546325
> 
> 赞同：4
> 
> 时间：2012-11-24T22:32:16.620
> 
> 标签：android, android-listview

我想要做的是放入`ListView`我的应用程序，它使用内部 SQLite 数据库来获取数据。当用户单击时，通过执行新查询从数据库中获取新数据。

我已经为`ListView`扩展`LinearLayout`和实现`Checkable`接口的项目实现了自定义视图。作品。

获得了基于`CursorAdapter`. 在`OnCreate()`我将我的适配器设置为`ListView`空光标。

```
ListView markersList = (ListView) findViewById(R.id.markersList);

Cursor c = null;
MarkersListAdapter adapter = new MarkersListAdapter(this, c, 0);
markersList.setAdapter(adapter); 
```

接下来，`AsyncTask`我正在查询`doInBackground()`将新游标传递`onPostExecute()`给 update的数据库`ListView`。我正在这样做：

```
adapter.changeCursor(newCursor); 
```

然后我默认检查所有项目（用户只需取消选中不需要的项目）

```
for(int i = 0; i < this.markersList.getCount(); i++)
{        
    this.markersList.setItemChecked(i, true);
} 
```

到目前为止，一切都很好。但是当我这样做时

```
int s = this.markersList.getCheckedItemCount(); 
```

我得到错误的价值。我猜它与旧光标有关。这只发生在新游标中的行数小于新游标中的行数时。

一般来说，我得到这样的东西

```
int s = this.markersList.getCheckedItemCount();   // s = 7
int d = this.markersList.getCount();              // d = 5 
```

有针对这个的解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T22:52:15.627

最简单的解决方案是手动清除检查的计数：

```
this.markersList.clearChoices();
for(int i = 0; i < this.markersList.getCount(); i++)
{        
    this.markersList.setItemChecked(i, true);
} 
```

# c++ - Qt 应用程序不在 Qt Creator 中执行

> ID：13546326
> 
> 赞同：3
> 
> 时间：2012-11-24T22:32:24.543
> 
> 标签：c++, qt

我正在开发一个跨平台的 Qt 音频应用程序。在 Linux 上，应用程序运行没有任何问题，但在 Windows 上，从 Qt Creator 启动时应用程序不会执行。

当使用 Release 配置运行（或没有调试）时，Qt Creator 简单地说：

“节目意外结束了。”

如果我使用 Debug 配置（或调试）运行，Qt Creator 会说：

“在启动时程序退出，代码为 0x0000135。”

由于谷歌搜索错误根本没有帮助，我决定将我的应用程序所需的每个 .exe 和 .dll（需要的 Qt 库 - 包括 QtCore - ）复制到一个空目录，并且应用程序完美执行，就像在 Linux 下一样。

所以，我猜这是 Windows 没有找到我的应用程序所需的 dll 的问题。

上周末我将系统升级到 Windows 8 时出现了这个问题。以前（使用 Windows 7）我没有这样的问题。

有谁知道不涉及修改构建参数（存储在 .user 文件中）的解决方案？

我不想这样做，因为当我在 Linux 下测试应用程序时，该文件将失效，并且我不想保留它的版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T20:25:52.820

刚刚解决了！

可能是 Qt Creator 中的一个错误。

我的项目里面有4个子项目：main.exe，一个core.dll，side.dll，external.dll。

```
main.exe needs core.dll and side.dll
core.dll needs external.dll 
```

由于 main.exe 只需要 core.dll 和 side.dll，我没有添加对 external.dll 的引用。Qt Creator 应该足够聪明，能够检测到它的依赖关系并相应地添加它们（好吧，最后这就是在 Linux 下发生的事情）。

由于它没有正确检测依赖关系，因此当我尝试从 Qt Creator 运行 main.exe 时，它​​不会构建正确的 PATH 环境变量，从而导致问题。

通过在我的 main.pro 文件中添加以下行来解决它：

```
win32:CONFIG(release, debug|release): LIBS += -L$$OUT_PWD/../external/release/ -lexternal
else:win32:CONFIG(debug, debug|release): LIBS += -L$$OUT_PWD/../external/debug/ -lexternal

#INCLUDEPATH += $$PWD/../external
win32: DEPENDPATH += $$PWD/../external 
```

注意：我更改了模块名称以便更好地理解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:53:46.730

我猜这是因为执行环境中的路径不再包含 Qt-DLL 的路径。转到项目设置并检查“调试和执行”设置中的 PATH 变量在我的情况下，例如：C:\QtSDK\mingw\bin;C:\QtSDK\Desktop\Qt\4.8.1\mingw\lib;...其他路径...

问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-25T16:11:06.947

问题肯定是缺少一些dll！我发现当我将 dll 直接放入带有可执行文件的文件夹（例如 png3.dll）中，然后从 qt creator 运行它时，它会运行！我做了什么：在您的输出目录（可执行文件所在的位置）中，您打开可执行文件（双击），Windows 显示缺少的 dll 名称。您找到它们并直接复制到文件夹中。然后从 Qt creator 运行应用程序！如果 dll 合适，您应该会成功。之后，您尝试从 exec 文件夹中删除 dll 并通过 qt creator 运行应用程序，直到它再次引发错误。这样你就可以找到丢失的 dll。之后，将“构建环境”中的 qt creator“项目”设置中的 dll 路径添加到“路径”变量中。

# python - 将列表 [['a'], ['b']] 转换为 ['a','b']

> ID：13546328
> 
> 赞同：4
> 
> 时间：2012-11-24T22:32:51.080
> 
> 标签：python, list, python-3.x, nested

> **可能重复：**
> [从 Python 中的列表列表中制作一个平面列表](https://stackoverflow.com/questions/952914/making-a-flat-list-out-of-list-of-lists-in-python)

在`python 3`，如何将列表转换`[['a'], ['b']]`为`['a','b']`？

我是一名初学者程序员，自己无法解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T22:38:03.240

尝试这个：

```
a = [['a'],['b']]

a = [item for list in a for item in list]
print a
>>>['a', 'b'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T22:38:39.947

使用[`itertools`](http://docs.python.org/2/library/itertools.html)，特别[`itertools.chain`](http://docs.python.org/2/library/itertools.html#itertools.chain)是（这比设计自己的方式要好得多）：

```
>>> l = [['a'], ['b']]
>>> print(list(itertools.chain.from_iterable(l)))
['a', 'b'] 
```

* * *

这也比纯列表理解解决方案更快：

```
$ python -mtimeit -s'l=[[1,2,3],[4,5,6], [7], [8,9]]*99' '[item for sublist in l for item in sublist]'
10000 loops, best of 3: 53.9 usec per loop
$ python -mtimeit -s'l=[[1,2,3],[4,5,6], [7], [8,9]]*99' 'list(itertools.chain.from_iterable(l))'
10000 loops, best of 3: 29.5 usec per loop 
```

[（从这个](https://stackoverflow.com/questions/952914/making-a-flat-list-out-of-list-of-lists-in-python)问题改编的测试）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-24T22:35:30.500

尝试：

```
[i[0] for i in [['a'], ['b']]
>>> ['a','b'] 
```

# objective-c - 在不同的 ViewController 故事板上使用 IBOutlets

> ID：13546331
> 
> 赞同：0
> 
> 时间：2012-11-24T22:33:36.940
> 
> 标签：objective-c, xcode, uiimageview, storyboard, viewcontroller

我有一个带有两个不同 ViewController 的故事板应用程序。在第二个 ViewController 我有一个 UIImageView ，我想在第一个上调用那个 UIImageView 。我一直在寻找解决方案，但找不到任何适合我的方法。

```
@property(nonatomic, retain) IBOutlet UIImageView *pic; 
```

我只想能够在另一个视图控制器上使用该 UIImageView。我希望你能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:54:51.687

## 编辑：

是的，你可以尝试设置你的 UIImageView 为 segue 做准备。我已经尝试过了，它似乎有效。你可以这样做：

**我假设您要使用的控制器称为 NewViewController **我还假设您的 NewViewController 有一个名为 imageView 的 UIImageView

```
-(void)prepareForSegue....
  {
   if ([segueIdentifier isEqual....])
       {
        NewViewController *newController=(NewViewController *)[segue destinationViewController];

        [[newViewController imageView]setImage:self.someUIImageFromCurrentClass];
        [[newViewController imageView]setNeedDisplay];
       }
  } 
```

是的，您必须在当前类中创建一个 UIImage（在本例中是 self.someUIImageFromCurrentClass）。关键是您正在从当前 ViewController（当前类）中获取图像并将其显示在您正在使用的 ViewController 中。

## 原来的：

```
-(void) prepareForSegue: (UIStoryboardSegue *)segue sender:(id)sender
{
  if ([segue.identifier isEqualToString:@"your segue name"])
     {
       [segue.destinationViewController setYourUIImage:self.someImageFromCurrentClass];
     }
} 
```

请务必为您要使用的控制器导入 .h 文件。

其次，YourUIImage 是一个 UIImage ，它在您要使用的控制器中公开声明（就像迈克尔提到的那样）。

在目标控制器中，您需要获取该 UIImage 并将其设置为 UIImageView 的图像：

```
[self.myImageView setImage:YourUIImage]; // <-- you can do this in ViewDidLoad or ViewWillAppear 
```

那应该让你去

**另外我想值得一提的是，segue 总是会创建一个你正在 segue 的控制器的新实例，它在 segue 之前不存在，这就是你必须将图像传递给它的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:39:37.677

您不能在视图控制器 (VC) 之间使用插座，因为一个 VC 无法自动引用另一个。您必须公开允许您需要的操作的公共属性或方法，并找到某种方法从另一个 VC 传递对一个 VC 的引用。

例如，如果您通过 segue 从一个 VC 传递到另一个 VC，您可以从`prepareForSegueWithIdentifier:`.

# python - USB 控制器在 Pygame 中不起作用

> ID：13546332
> 
> 赞同：2
> 
> 时间：2012-11-24T22:33:38.150
> 
> 标签：python, controller, usb, pygame, joystick

我有一个 USB 控制器，我已将其映射为游戏程序之外的键盘上的箭头键（例如，您可以将其用作键盘上的普通箭头键）。我使用程序 ControlMK 做到了这一点。我的 Pygame 程序无法将控制器识别为键盘。当我尝试使用操纵杆模块时，程序无法正常运行。

这是我的代码：

```
import pygame, sys, time, random
from pygame.locals import *

# set up pygame
try:
    pygame.init()
    pygame.display.init()
    pygame.mixer.init(size=8, buffer=2048)

    pygame.mixer.get_init

except:
    print "error in init\n"

white=(255,255,255)

screen=pygame.display.set_mode((800,600), pygame.RESIZABLE)

class Loadsound:

    def __init__(self, name, key, sound_file):
        self.name = name
        self.name=key
        self.sound = pygame.mixer.Sound(sound_file)

sound_left=[]
sound_left.append(Loadsound("left","K_LEFT", "left.wav"))
sound_right=[]
sound_right.append(Loadsound("right","K_RIGHT", "right.wav"))
sound_up=[]
sound_up.append(Loadsound("up","K_UP","up.wav")) 
sound_down=[]
sound_down.append(Loadsound("down","K_DOWN","down.wav"))

while True:
  for i in pygame.event.get():
   if i.type==QUIT:
    exit()
  pressed=pygame.key.get_pressed()

  if pressed[K_LEFT]:
      for left in sound_left:
          left.sound.play()
  elif pressed[K_RIGHT]:
      for right in sound_right:
          right.sound.play()
  elif pressed[K_UP]:
      for up in sound_up:
          up.sound.play()
  elif pressed[K_DOWN]:
      for down in sound_down:
          down.sound.play() 
```

感谢您的帮助！

编辑：

我一直在尝试使用操纵杆模块。这是我从中获取示例代码的地方：

[http://www.pygame.org/wiki/Joystick_analyzer](http://www.pygame.org/wiki/Joystick_analyzer)

我编辑了我的代码以包含其中的一些，但它仍然无法正常工作。这是我编辑的代码：

```
import pygame, sys, time, random
from pygame.locals import *
from pygame import *

# set up pygame
try:
    pygame.init()
    pygame.display.init()
    pygame.mixer.init(size=8, buffer=2048)

    pygame.mixer.get_init

except:
    print "error in init\n"

white=(255,255,255)

screen=pygame.display.set_mode((800,600), pygame.RESIZABLE)

class Loadsound:

    def __init__(self, name, key, sound_file):
        self.name = name
        self.name=key
        self.sound = pygame.mixer.Sound(sound_file)

sound_left=[]
sound_left.append(Loadsound("left","K_LEFT", "left.wav"))
sound_right=[]
sound_right.append(Loadsound("right","K_RIGHT", "right.wav"))
sound_up=[]
sound_up.append(Loadsound("up","K_UP","up.wav")) 
sound_down=[]
sound_down.append(Loadsound("down","K_DOWN","down.wav"))

def __init__(self):
    pygame.joystick.init()
    self.my_joystick = None
    self.joystick_names = []

    for i in range(0, pygame.joystick.get_count()):
        self.joystick_names.append(pygame.joystick.Joystick(i).get_name())

    print self.joystick_names

    if (len(self.joystick_names) > 0):
        self.my_joystick = pygame.joystick.Joystick(0)
        self.my_joystick.init()

    #max_joy = max(self.my_joystick.get_numaxes(), self.my_joystick.get_numbuttons(), self.my_joystick.get_numhats()

while True:
    for i in pygame.event.get():
        pygame.event.pump()
    if i.type==QUIT:
        exit()
    #pygame.joystick.Joystick(0)
    #Joystick.init()
    pressed=pygame.key.get_pressed()
    #pressed_j=Joystick.get_hat()
    def check_hat(self, p_hat):
        if (self.my_joystick):
            if (p_hat,self.my_joystick.get_numhats()):
                return self.my_joystick.get_hat(p_hat)

        return (0, 0)

    if check_hat==(-1,0):
    #if pressed[K_LEFT]:
        for left in sound_left:
            left.sound.play()
    elif pressed[K_RIGHT]:
        for right in sound_right:
            right.sound.play()
    elif pressed[K_UP]:
        for up in sound_up:
            up.sound.play()
    elif pressed[K_DOWN]:
        for down in sound_down:
            down.sound.play() 
```

为清楚起见，我的代码在使用键盘时确实有效。但是，它不会转换为映射到相同键的控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T09:14:00.650

尝试这个：

```
import pygame

pygame.init()
print "Joystics: ", pygame.joystick.get_count()
my_joystick = pygame.joystick.Joystick(0)
my_joystick.init()
clock = pygame.time.Clock()

while 1:
    for event in pygame.event.get():
        print my_joystick.get_axis(0),  my_joystick.get_axis(1) 
        clock.tick(40)

pygame.quit () 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T02:42:00.857

您将需要使用 Pygame 的[Joystick 模块](http://www.pygame.org/docs/ref/joystick.html)或类似的东西，它具有诸如: 之类的方法`Joystick.get_init()`，它告诉是否在 Pygame 中初始化了操纵杆，并`Joystick.get_axis(axis_number)`返回操纵杆的位置，作为一个浮点数，沿给定的轴`axis_number`。ControlMK 可能将操纵杆映射到与 Pygame 交互的级别太高的键输入，尽管可能有一些方法可以改变这一点，但它的文档似乎有限。

# sql - Postgres min 函数性能

> ID：13546336
> 
> 赞同：5
> 
> 时间：2012-11-24T22:34:20.343
> 
> 标签：sql, performance, postgresql, indexing, sql-limit

我需要`runnerId`.

这个查询：

```
SELECT "runnerId" FROM betlog WHERE "marketId" = '107416794' ; 
```

需要 80 毫秒（1968 个结果行）。

这个：

```
SELECT min("runnerId") FROM betlog WHERE "marketId" = '107416794' ; 
```

需要 1600 毫秒。

有没有更快的方法来找到最小值，或者我应该在我的 java 程序中计算最小值？

```
"Result  (cost=100.88..100.89 rows=1 width=0)"
"  InitPlan 1 (returns $0)"
"    ->  Limit  (cost=0.00..100.88 rows=1 width=9)"
"          ->  Index Scan using runneridindex on betlog  (cost=0.00..410066.33 rows=4065 width=9)"
"                Index Cond: ("runnerId" IS NOT NULL)"
"                Filter: ("marketId" = 107416794::bigint)"

CREATE INDEX marketidindex
  ON betlog
  USING btree
  ("marketId" COLLATE pg_catalog."default"); 
```

另一个想法：

```
SELECT "runnerId" FROM betlog WHERE "marketId" = '107416794' ORDER BY "runnerId" LIMIT 1 >1600ms
SELECT "runnerId" FROM betlog WHERE "marketId" = '107416794' ORDER BY "runnerId" >>100ms 
```

如何`LIMIT`减慢查询速度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-24T22:47:25.807

您需要的是一个[多列索引](http://www.postgresql.org/docs/current/interactive/indexes-multicolumn.html)：

```
CREATE INDEX betlog_mult_idx ON betlog ("marketId", "runnerId"); 
```

如果有兴趣，您可以在[dba.SE 上的相关问题](https://dba.stackexchange.com/questions/6115/working-of-indexes-in-postgresql/7484#7484)下找到有关 PostgreSQL 中的多列索引、链接和基准的深入信息。

*我是怎么想出来的？*
在多列索引中，行按索引的第一列（“marketId”）排序（从而聚集），每个簇依次按索引的第二列排序 - 因此第一行符合条件`min("runnerId")`. 这使得索引扫描非常快。

关于`LIMIT`减慢查询速度的悖论效应——Postgres 查询规划器有一个弱点。常见的解决方法是使用 CTE（在这种情况下*不是*必需的）。在这个最近的密切相关的问题下找到更多信息：
[PostgreSQL querytaking too long](https://stackoverflow.com/questions/13407555/postgresql-query-taking-too-long)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T18:32:40.290

当您有一个索引`("runnerId")`（或至少`"runnerId"`作为高阶列）但没有索引时`("marketId", "runnerId")`，比较使用该列上的索引传递所有行与匹配项的成本，并从该组中`"marketId"`挑选出最小值使用索引扫描并在找到匹配的第一行时停止`"runnerId"`的成本。基于可用的统计数据以及*值将随机分布在其上的索引的索引条目中**的假设，*估计后一种方法的成本较低。`"runnerId"``"marketId"`*`"marketId"``"runnerId"`*

它还估计了扫描整个表并从匹配行中挑选最小值以及可能还有许多其他替代方案的成本。它并不总是使用某种类型的计划，而是比较所有替代方案的成本。

问题是值将随机分布在范围内的假设不一定正确（如本例所示），导致扫描范围的高百分比以查找潜伏在末尾的行。对于 的某些值`"marketId"`，所选值在索引开头附近可用`"runnerId"`，此计划应该非常快。

PostgreSQL 开发人员社区已经讨论过，如果数据分布不是假设的那样，我们可能会如何偏向运行时间较长的“风险”计划，并且已经在跟踪多列统计数据以便相关价值观不会遇到这样的问题。预计在接下来的几个版本中会在这方面有所改进。在那之前，Erwin 的建议都是针对如何解决这个问题的。

基本上，它归结为提供更有吸引力的计划或引入优化障碍。在这种情况下，您可以通过添加索引来提供更有吸引力的选项`("marketId", "runnerId")`-- 这允许以非常直接的方式直接获得答案。计划者为该备选方案分配了非常低的成本，从而使其被选中。如果您不想添加索引，则可以通过执行以下操作来强制设置优化障碍：

```
SELECT min("runnerId")
  FROM (SELECT "runnerId" FROM betlog
          WHERE "marketId" = '107416794'
          OFFSET 0) x; 
```

当有一个`OFFSET`子句（即使偏移量为零）时，它会强制单独计划子查询，并将其结果提供给外部查询。我希望这将在 80 毫秒内运行，而不是在没有优化障碍的情况下运行的 1600 毫秒。当然，如果可以加索引的话，缓存数据时的查询速度应该在1ms以内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T22:41:02.657

PostgreSQL 将使用对整个表的顺序扫描来执行 min 语句。您可以使用以下方法优化查询： SELECT col FROM sometable ORDER BY col ASC LIMIT 1;

# javascript - 在 Rails 中禁用 Javascript 变量重命名

> ID：13546339
> 
> 赞同：3
> 
> 时间：2012-11-24T22:34:30.017
> 
> 标签：javascript, ruby-on-rails, assets

我正在尝试在我的应用程序中使用 Tripleflap.js。我的观点是调用函数：

```
<script type='text/javascript' charset='utf-8'>
    TwitterBird();
</script> 
```

因此，在 application.js 中：

```
function TwitterBird() {
    var twitterAccount = 'ulmicru';
    var showTweet = false;
    var birdSprite='http://127.0.0.1/birdsprite.png';
    tripleflapInit();
} 
```

然后我尝试运行它，Javascript 调试器告诉我：

```
Uncaught ReferenceError: birdSprite is not defined 
```

在 /public/assets/ 的预编译 application.js 中，我正在看这个：

```
function TwitterBird()
{var e="ulmicru",t=!1,n="http://127.0.0.1/birdsprite.png";tripleflapInit()} 
```

似乎 Rails 预编译器重命名了变量，而 Tripleflap.js 找不到它们。

是否可以禁用资产中的变量重命名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T04:09:56.853

尝试将变量定义移到函数之外，或者只是删除`var`它们前面的 from，如下所示：

```
function TwitterBird() {
  twitterAccount = 'ulmicru';
  showTweet = false;
  birdSprite='http://127.0.0.1/birdsprite.png';
  tripleflapInit();
} 
```

我用谷歌搜索了`tripleflapInit`脚本并查看了它。基本上它直接在窗口上定义了一堆配置变量，并希望你覆盖它们；总而言之，这是一个非常笨拙的脚本，但这不是重点。

因为您是`birdSprite`在一个函数内部定义`var`，所以实际上是在该函数的本地定义一个新变量。即使它没有被缩小器重命名，窗口定义的`tripleflapInit`仍然不会使用它，而是查看窗口上定义的变量。

我不确定您为什么会收到`birdSprite`未定义的错误，但编译器可能会混淆并删除它，认为它没有被使用。

# utf-8 - 在 Ubuntu 上将 UTF-8 字符输入到 Sublime Text 2

> ID：13546346
> 
> 赞同：4
> 
> 时间：2012-11-24T22:35:18.847
> 
> 标签：utf-8, sublimetext2

我已经看遍了，但我无法弄清楚这一点。

我想在 Sublime Text 2 中输入一些 2 字节的字符，但我不知道该怎么做。Linux 上的标准方式是 CTRL-SHIFT-u 后跟 4 个十六进制数字。这在 Sublime Text 2 中不起作用。它是如何完成的？

而且，如果这在某处*有*记录，请告诉我*在哪里*？？？

# api - 设计一个高效的休息 API

> ID：13546351
> 
> 赞同：1
> 
> 时间：2012-11-24T22:36:02.637
> 
> 标签：api, rest

我正在尝试通过 HTTP 设计一个 REST API。我对此完全陌生，所以请告诉我我的任何假设或想法是否完全错误。

该域是简约的。我有一个产品数据库，每个产品都有一个关联的图像。正如我所看到的，我可以通过以下两种方式之一来设计我的 API：

1.  我可以将每个图像与其产品捆绑在一起，并将它们表示为一个资源。此 api 的缺点是每次 PUT 或 GET 产品时，您都必须通过网络发送图像，即使您不需要特别读取或更改图像。据我了解，不 PUT 或 GET 资源的**完整**表示不是 RESTful。此外，在这种情况下，图像的客户端缓存将毫无用处。

2.  我可以将产品和图像建模为两种不同的资源。当您获取产品时，它将包含一个可用于获取图像的 image_id。该模型需要两个 HTTP 请求。一个获取产品，一个获取其对应的图像。也许还不错，但是如果我想显示所有产品的列表以及它们的图像怎么办？然后我突然有一堆HTTP请求。在使用 SSL 时，我想这可能会产生性能问题。不过，好消息是我的 API 的使用者可以选择在客户端缓存图像。

那么，如何将我的 API 建模为既 RESTful 又高效？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T23:14:00.960

您正在考虑数据模型，这很好。
与此相关的是，REST 没有指定或暗示数据模型必须完全去规范化。

通常，在获取资源时，您会收到一个信息包，其中还包括对其他相关资源的 URL 引用，例如产品图像。它还可以包括对产品类别、产品制造商等的引用。每个都可能是 URL，或者您可以从中派生 URL 的 ID。像这样的消息：

```
{
   "id": 123456,
   "description" : "Your basic paperweight",
   "category" : { id: 17717,  "name" : "Home furnishings" },
   "manufacturer": { id : 78783, "name" : "Boeing" },
   "price" : 1.99,
   "imageId" : 109101
} 
```

...可能暗示这样的 URL：

```
http://api.mycompany.com/product/123456   
http://api.mycompany.com/category/17717   
http://api.mycompany.com/manufacturer/78783   
http://api.mycompany.com/image/109101 
```

...并注意链接到资源的完整表示，如类别、制造商等，不会与原始资源一起传输。这是一个部分去规范化的数据模型。

关于您对 PUT 的评论：

1.  这是一个见仁见智的问题，但是……*对于许多开发人员* 来说，允许通过 PUT 进行部分更新是完全可以接受的。因此，您可以在不指定所有内容的情况下更新资源；现有字段将保持不变。如果您选择此行为，则在处理边缘情况时可能会使您的（服务器端）代码复杂化。例如，客户如何指示他要擦除或删除字段？（传递 null 可能有效，但对于某些数据， null 是一个有意义的值。）

2.  为什么要担心 PUT？如果您想要部分更新，很容易使用 POST，在查询参数中带有动词（例如，“partialUpdate”）。实际上[，这就是 Roy Fielding 所倡导](http://tech.groups.yahoo.com/group/rest-discuss/message/17421)的，对我来说很有意义。

部分更新将是这样的：

```
POST /products/123456?action=partialUpdate 
*headers*

{ 
  "description" : "A fabulous paperweight designed in Sweden, now at a new low price." },
  "price" : 1.78 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:40:16.057

我会使用选项 2，但不是 image_id，而是存储图像 URL。此外，不要害怕使用自定义脚本来返回您需要的内容（例如，显示所有产品和图像）。REST 是设计目标，不一定是实现真理。你的设计仍然是 RESTful。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T07:00:19.227

我同意其他 2 个答案，我认为您应该选择选项 2。但是您还询问了有关获取产品列表的问题，因此这是我的回答。

考虑使用只能与 GET 一起使用的另一个资源，该资源将返回产品列表。通过这种方式，将只有一个 HTTP 请求来使用该列表。如果列表可能非常大，则需要实现某种分页机制。

例如，假设您需要退回 2500 件产品，但您决定退回的产品不超过 1000 件。第一个 GET 请求将返回前 1000 个项目，并且还将在答案中包含使用下一个“页面”的 URL，在这种情况下是下一个 1000 个产品，然后在第二个请求中，您将返回产品 1001-2000 和一个 URL到下一个“页面”，在这种情况下是最后 500 个产品。

然后，如果需要，消费者也可以获取图像。您也可以对图像使用此列表选项，但每个“页面”中的图像束应该明显更小。我不建议选择列表机制来消费图像。

# ruby - 在没有初始化的情况下迭代数组

> ID：13546356
> 
> 赞同：0
> 
> 时间：2012-11-24T22:36:52.323
> 
> 标签：ruby, arrays, hash

我有一个哈希`PAYMENT_TYPES_HASH`。有没有办法从这个哈希创建一个数组，`each`而不用在它之前声明数组`a = []`？

```
a = [];
PAYMENT_TYPES_HASH.each {|order| a << [order[:name], order[:id]]}
a 
```

像这样的东西：

```
array = PAYMENT_TYPES_HASH.each {|order| do something to return the array} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:50:17.307

你应该使用`#map`方法：

```
PAYMENT_TYPES_HASH.map {|order| [order[:name], order[:id]]} 
```

# java - PrintWriter 不会立即刷新，即使使用 autoFlush

> ID：13546358
> 
> 赞同：2
> 
> 时间：2012-11-24T22:37:03.617
> 
> 标签：java, append, printwriter, autoflush

我有一个 Java 服务器，它将来自多个客户端的某些信息附加到一个文件中。所以我正在创建一个`FileWriter`带有 append=true 和一个`PrintWriter`带有 autoFlush=true 的。但是，当我监视（例如，使用 tail 命令）文件时，内容不会立即写出，通常会有 10-30 秒的延迟。该服务器在带有 JDK 1.7 64b 的 Linux 上运行。为什么自动刷新在这里不起作用？如何使文件中的数据立即可用？

```
//Create appendable FileWriter, and autoflushable PrintWriter
PrintWriter pw = new PrintWriter(new FileWriter(file, true), true);

... ...

if (save2File) {
    //println(String) supposed to flush the content
    pw.println(getEventOutput(event));
    // adding flush still not working!
    pw.flush();
} 
```

这是重现问题的代码。在 Linux 上，在应用程序输出该行之后和在另一个终端中可以看到该行之前（使用 tail -f），有一个明显的延迟（~1-2 秒）。在 Windows 上，输出似乎非常快（比我在 Notepad++ 中刷新文件的速度还快）

```
public static void main(String[] args) throws IOException,
        InterruptedException {
    long time = 5000;
    File file = new File("xyz.test");
    PrintWriter pw = new PrintWriter(new FileWriter(file, true), true);

    for (int i = 0; i < 10; ++i) {
        pw.println("this is line " + i);
        System.out.println("output line " + i);
        // Thread.sleep(time);
        System.in.read();
    }
    System.in.read();
} 
```

2012 年 12 月 4 日更新：

我想我找到了问题的根本原因。它实际上是 Linux 上的 async /nfs 挂载。服务器写入文件的目录挂载为 async nfs

```
...   ...   nfs   vers=3,async,rw,rsize=32768,wsize=32768 0 0 
```

在我将文件切换到 /tmp 后，文件附加现在是立即的。

# php - 如果键值对存在于多维数组中..如何？

> ID：13546359
> 
> 赞同：1
> 
> 时间：2012-11-24T22:37:06.560
> 
> 标签：php, codeigniter, loops

我有一个 codeigniter 购物车，它的“购物车”数组如下：

```
Array (
[a87ff679a2f3e71d9181a67b7542122c] => Array
    (
        [rowid] => a87ff679a2f3e71d9181a67b7542122c
        [id] => 4
        [qty] => 1
        [price] => 12.95
        [name] => Maroon Choir Stole
        [image] => 2353463627maroon_3.jpg
        [custprod] => 0
        [subtotal] => 12.95
    )

[8f14e45fceea167a5a36dedd4bea2543] => Array
    (
        [rowid] => 8f14e45fceea167a5a36dedd4bea2543
        [id] => 7
        [qty] => 1
        [price] => 12.95
        [name] => Shiny Red Choir Stole
        [image] => 2899638984red_vstole_1.jpg
        [custprod] => 0
        [subtotal] => 12.95
    )

[eccbc87e4b5ce2fe28308fd9f2a7baf3] => Array
    (
        [rowid] => eccbc87e4b5ce2fe28308fd9f2a7baf3
        [id] => 3
        [qty] => 1
        [price] => 14.95
        [name] => Royal Blue Choir Stole
        [image] => 1270984005royal_vstole.jpg
        [custprod] => 1
        [subtotal] => 14.95
    ) 
```

)

我的目标是遍历这个多维数组，如果存在任何具有键值对“custprod == 1”的产品，那么我的结帐页面将显示一件事，如果购物车中没有自定义产品，它会显示另一件事. 任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:39:33.987

您可以使用 . 检查`custprod`密钥，而不是循环遍历它[`array_key_exists`](http://www.php.net/manual/en/function.array-key-exists.php)。或者只是检查一下`arr['custprod']` [`isset`](http://php.net/manual/en/function.isset.php)（两个函数的处理`null`方式不同）。

```
$key = "custprod";
$arr = Array(
    "custprod" => 1, 
    "someprop" => 23
);
if (array_key_exists($key, $arr) && 1 == $arr[$key]) {
    // 'custprod' exists and is 1
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:59:59.507

```
function item_exists($cart, $custprod) {
    foreach($cart as $item) {
        if(array_key_exists("custprod", $item) && $item["custprod"] == $custprod) {
            return true;
        }
    }
    return false;
} 
```

现在，您可以使用此函数检查产品是否存在于堆栈中：

```
if(item_exists($cart, 1)) {
    // true
} else {
   // false
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T22:57:08.813

您仍然需要循环数组来检查它：

```
$cust_prod_found = false;

foreach($this->cart->contents() as $item){
    if (array_key_exists("custprod", $item) && 1 == $item["custprod"]) {
        $cust_prod_found = true; break;
    }
}

if ($cust_prod_found) {
    // display one thing
} else {
    // display another thing
} 
```

# jquery - 我使用咖啡脚本的 ajax 帖子未处理成功回调

> ID：13546360
> 
> 赞同：4
> 
> 时间：2012-11-24T22:37:25.483
> 
> 标签：jquery, ruby-on-rails-3, coffeescript

我正在尝试使用 coffeescript 和 jquery 发表一篇文章，但我的脚本没有处理成功回调。

*cards_controller.js.coffee*

```
if $('form').attr('action') == '/cards'   alert "Hey ho"   $('#add_card').click (e) ->
    e.preventDefault()
    $.ajax '/cards',
      type: 'PUT' #Tried POST also
      dataType: 'json'
      error: (jqXHR, textStatus, errorThrown) ->
        console.log textStatus
      success: (res) ->
        console.log "Card name: " + data.card.code + "\nPoints: " + data.points
      complete: (jqXHR, textStatus) ->
        console.log "Status: " + textStatus 
```

*index.html.erb*

```
<%= form_tag url_for(:controller => 'cards', :action => 'create'), :remote => true %> 
```

生成的javascript如下：

```
(function() {

  if ($('form').attr('action') === '/cards') {
    alert("Hey ho");
    $('#add_card').click(function(e) {
      e.preventDefault();
      return $.ajax('/cards', {
        type: 'POST',
        dataType: 'json',
        error: function(jqXHR, textStatus, errorThrown) {
          return alert(textStatus);
        },
        success: function(res) {
          console.log("Card name: " + data.card.code + "\nPoints: " + data.points);
          return $('#card-list > tbody:last').append('<tr>test</tr><tr>uauauiua</tr>');
        },
        complete: function(jqXHR, textStatus) {
          return console.log("Status: " + textStatus);
        }
      });
    });
  }

}).call(this); 
```

*cards_controller.rb*

```
def create
    card = Card.find_by_code(params[:code])

    if card && card.user.nil?
      current_user.add_card(card)
    else
      return render :status => 401, :json => { :message => "O cartão não existe ou já está cadastrado"}
    end      

    respond_to do |format|
        format.js { render json: { :card => card, :points => card.card_business_points.sum("points") } , content_type: 'text/json' }
    end
end 
```

请求成功发送到控制器，并且正确创建了卡。问题是 Chrome 上的调试似乎不处理回调并且不记录。

请问有人可以帮助e吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-25T16:11:51.297

我只是想出了问题所在。

在我的咖啡脚本中，使用 jQuery ajax 函数进行提交时，我忘记在数据字段中添加我要提交的内容。

最终脚本与此类似：

```
(document).ready ->
    if $('form').attr('action') == '/cards'
        $('#add_card').click (e) ->
            e.preventDefault()
            $.ajax '/cards',
                type: 'POST'
                dataType: 'json'
                data: { code: $("#code").val() }
                error: (jqXHR, textStatus, errorThrown) ->
                    alert textStatus
                success: (data, textStatus, jqXHR) ->
                    console.log "Card name: " +
                                data.card.code + "\nPoints: " + data.points 
```

感谢您的帮助，当我没有传递数据参数时，我无法弄清楚为什么我的回调没有被调用。

问候！

# facebook - Facebook PHP SDK 访问令牌过期时重定向到索引页面

> ID：13546361
> 
> 赞同：0
> 
> 时间：2012-11-24T22:37:28.983
> 
> 标签：facebook, oauth-2.0, facebook-php-sdk, fatal-error

我正在一个使用 Facebook PHP SDK 的网站上工作。它运行良好，2 小时后，每当我尝试进入网站上的一个常规页面时，我都会...

```
 Fatal error: Uncaught OAuthException: An active access token must be used to query information about the current user. 
```

如果我回到索引页面，我会得到一个新的访问令牌，一切都会再次正常运行......持续 2 小时。

当访问令牌过期时，我可以在我的网页上放置什么代码以重定向到索引页面？

感谢您帮助这个菜鸟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T09:13:46.677

您必须将用户重定向到具有授权代码的页面。如果您的用户未取消对 app 的授权，则不会出现 Oauth 对话框。

有关更多信息，请 [访问访问令牌和处理](https://developers.facebook.com/docs/howtos/login/debugging-access-tokens/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:10:13.897

您可以`try / catch`在代码中放置一个块。

将每个 Facebook API 调用放在这样的块中，如果发生异常，您可以通过以下方式将用户重定向到正确的资源`header('Location: <url>');`：

```
try {
  # FB API call 
} 
catch(OAuthException e) {
  header('Location: <url>');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T15:45:25.657

有一个像这样的文件并将其包含在您的网页中。

```
$facebook = new Facebook(array(
  'appId'  => "app id",
  'secret' => "app secret",
));

$user = $facebook->getUser();
$loginUrl = $facebook->getLoginUrl();

if ($user) {
  try {
    $me = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);   
  }
}
else {
    echo "<script type='text/javascript'>top.location.href = '$loginUrl';</script>";
} 
```

# php - 如何在通过php生成的html中进行php

> ID：13546362
> 
> 赞同：1
> 
> 时间：2012-11-24T22:37:36.737
> 
> 标签：php, html

> **可能重复：**
> [php中单引号和双引号字符串的区别](https://stackoverflow.com/questions/3446216/difference-between-single-quote-and-double-quote-string-in-php)

我需要在我通过 PHP 生成的一些 html 文件中包含一些 php 代码。

我尝试了以下方法，但这不起作用。你能给我解释一下为什么吗？

```
<?php
$text='mc';
echo '<text>"$text"</text>'
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T22:38:49.813

因为你应该在这种情况下使用`echo "<text>\"$text\"</text>"`

[在此问题](https://stackoverflow.com/questions/3446216/difference-between-single-quote-and-double-quote-string-in-php)和[手册](http://php.net/manual/en/language.types.string.php)中阅读有关 PHP 中不同类型字符串的更多信息

您还可以使用字符串连接，如下所示： `echo '<text>' . $text . '</text>'`

您喜欢哪种方式完全取决于您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:38:59.020

它应该是：

```
<?php
$text='mc';
echo '<text>'.$text.'</text>';
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T22:40:00.353

```
<?php
$text='mc';
echo '<text>'.$text.'</text>'
//or
echo "<text>$text</text>";
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T22:41:49.677

您应该注意到单引号和双引号之间的用法差异。以下资源将为您提供帮助。 [http://php.net/manual/en/language.types.string.php](http://php.net/manual/en/language.types.string.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-24T22:42:38.913

有几个选项：

```
<?php
$text = 'mc';
echo '<text>'.$text.'</text>';
echo '<text>',$text,'</text>';
echo "<text>$text</text>";
echo "<text>{$text}</text>";?> 
```

您可以参考php.net上的[字符串手册以了解更多用法。](http://php.net/manual/en/language.types.string.php)

# ms-office - Google 协作平台 - 产品组合

> ID：13546369
> 
> 赞同：1
> 
> 时间：2012-11-24T22:38:23.740
> 
> 标签：ms-office, onedrive

我目前正在为学生创建一个作品集模板。作品集模板应该与 Dropbox/Skydrive/... 之类的程序链接（用于同步到桌面），但它还需要具有在作品集中编辑 .docx 文件的功能。

所以我想要一个包含所有文件的文件夹的概述 + 可编辑的 .docx 文件。这是一个不切实际的想法吗？或者有可能做到这一点？

如果是，如何或使用哪些脚本？

# javascript - 将日期排序为字符串的回调函数

> ID：13546370
> 
> 赞同：0
> 
> 时间：2012-11-24T22:38:34.293
> 
> 标签：javascript, sorting

我在 JS 中有一个字符串数组，它们表示格式为 M/D/Y 的日期，其中 M 和 D 可以分别有一个或两个数字。如何编写回调函数对这个数组进行排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T22:51:29.493

Date.parse() （与 new Date(string) 等效）在 JS 实现中不一致，因此我可能应该首先手动解析日期字符串以保持一致性，然后完全按照 Minko Gechev 的建议进行操作：

```
array.sort(function (d1, d2) {
  function parseDate(str) {
    var parts = str.match(/(\d+)/g);
    // assumes M/D/Y date format
    return new Date(parts[2], parts[0]-1, parts[1]); // months are 0-based
  }
  return parseDate(d1) - parseDate(d2);
}); 
```

顺便说一句，我认为您几乎总是最好存储 Date 对象而不是字符串，然后在需要输出时将 Dates 格式化为字符串，因为它使这种操作更容易，并使你的代码也更清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:37:56.593

您还可以将字符串拆分为它们的 mdy 组件并比较组件。

```
array.sort(function(a,b){
  var a1= a.split('/'), b1=b.split('/');
  if(a1[2]==b1[2]){
    return (a1[0]==b1[0])? a1[1]-b1[1]: a1[0]-b1[0];
  }
  return a1[2]-b1[2];
} 
```

# android - 如何正确使用多点触控 - MotionEvent.getActionIndex() 的目的？

> ID：13546376
> 
> 赞同：3
> 
> 时间：2012-11-24T22:39:07.513
> 
> 标签：android, multi-touch

[MotionEvent](http://developer.android.com/reference/android/view/MotionEvent.html)的文档在 Consistency Guarantees 中指出：*“（对于触摸事件）......指针一次下降一个，作为一组移动，然后一次上升一个或被取消”*。

如果我理解正确，有两种方法可以确定触发的操作`onTouchEvent()`：

*   `MotionEvent.getAction()`
*   `MotionEvent.getActionMasked()`with `MotionEvent.getActionIndex()`（这应该用于多点触控，这就是我所追求的）

由于`getActionMasked()`总是只返回`ACTION_POINTER_DOWN`and `ACTION_POINTER_UP`，根据一致性保证，应该总是**只有一个**指针传递`MotionEvent`给`onTouchEvent()`，这意味着`MotionEvent.getActionIndex()`总是返回 0。

如果是这样，那有什么意义`MotionEvent.getActionIndex()`呢？换句话说：我错过了什么？

**更新：**为了进一步澄清我的问题：`MotionEvent.getActionMasked()`只返回一个动作并`MotionEvent.getActionIndex()`告诉我们它适用于哪个指针。这是否意味着我们无法获得其他指针的操作？或者如果所有指针都相同，为什么要指定 actionIndex 呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:43:57.067

该事件`ACTION_POINTER_DOWN`表示两个或多个手指现在正在触摸屏幕，以区分您需要使用的是第二根手指还是第三根（等）手指`getActionIndex()`。

* * *

> 因为`getActionMasked()`总是返回公正`ACTION_POINTER_DOWN`和`ACTION_POINTER_UP`

如果有任何混淆，`getActionMasked()`返回更多类型，如`ACTION_DOWN`,`ACTION_MOVE`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T07:03:43.440

[在这个出色的答案](https://stackoverflow.com/questions/4268426/android-difference-between-action-up-and-action-pointer-up#4269592)的帮助下，我已经弄清楚了。

函数`getActionMasked()`获取适用于所有指针或仅适用于其中一个指针的操作（如果操作是`ACTION_POINTER_DOWN`and `ACTION_POINTER_UP`），您可以使用`getActionIndex()`.

我缺少的一条信息是，当您获得`ACTION_POINTER_DOWN`仅适用于其中一个指针的屏蔽操作时，调用中仍提供其他指针。但是您可以保证每次调用最多有一个`ACTION_POINTER_DOWN`或`ACTION_POINTER_UP`存在于`onTouchEvent()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-14T10:39:36.757

getActionIndex() 返回指针在两个主要事件上的索引，即DOWN 和UP。在所有其他动作中，例如 ACTION_MOVE，它总是返回索引 0 处的指针。

因此，如果我们想针对 MOVE 实现一些特定的操作，我们必须使用指针索引而不是获取 ActionIndex。

# linq - LINQ 按具有不同值的字母排序

> ID：13546378
> 
> 赞同：-1
> 
> 时间：2012-11-24T22:39:16.360
> 
> 标签：linq, list, lambda

我想以这种方式对已经排序的列表进行排序。

已排序列表 =

```
Ali-23423423423
Ali-234234
Ali-234234255
Bali-36365356
Bali-32326546456
Bali-361111
Tali1-234234
Tali2-2342342
Tali3-23424 
```

我正在尝试找到一个查询，以便我可以像这样对其进行排序

```
Ali-12315254
Bali-23346363
Tali-242452345
Ali-2342134134
Bali-234234234
Tali-242342 
```

等等。

我为这项工作做了一个循环，但它非常慢，而且有些问题也存在。有什么解决办法吗？

```
while (List1.Count+10 < List.Count) 
{ 
    i++; 
    if (List.ElementAt(i).Remove(List.ElementAt(i).IndexOf('-')) == List1.ElementAt(i + 1).Remove(List1.ElementAt(i + 1).IndexOf('-'))) 
    { 
        String Element = List.ElementAt(i); 
        List.RemoveAt(i); 
        List.Add(Element); 
        i--; 
    } 
    else 
    { 
        List1.Add(List.ElementAt(i)); 
    } 
} 
List = List1; 
```

是不是我想出的不太好的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:43:00.103

此查询将按名称为您提供唯一项目

```
var query = from s in list                        
            let name = s.Split('-')[0]
            group s by name into g
            orderby g.Key // don't sure if you need ordering
            select g.First(); 
```

*更新*我认为这段代码完全符合您的要求 - 首先选择每个名称的第一次出现，然后选择第二次出现，等等

```
List<string> sortedList = new List<string>();

while (list.Any())
{
    var query = list.GroupBy(s => s.Split('-')[0], (k,g) => g.First()).ToList();
    // list.RemoveAll(s => query.Contains(s));
    query.ForEach(s => list.Remove(s)); // I think this is more effective
    sortedList.AddRange(query);
} 
```

您的样本数据的输出是：

```
Ali-23423423423 // first loop
Bali-36365356
Tali1-234234
Tali2-2342342
Tali3-23424
Ali-234234 // second loop
Bali-32326546456
Ali-234234255 // third loop
Bali-361111 
```

# php - 准备好的语句错误“没有为准备好的语句中的参数提供数据”

> ID：13546379
> 
> 赞同：2
> 
> 时间：2012-11-24T22:39:16.843
> 
> 标签：php, mysql

我正在尝试使用事务更新 2 个不同的表。对于我的第一个查询，我收到错误“没有为准备好的语句中的参数提供数据”。我的第二个查询通过就好了。我知道错误是指传递给 $stmt->bind_param() 的变量。我已经检查，三次检查并且可以确认我传递给它的所有变量实际上都包含值。我还检查以确保传递的值由“s”或“i”正确指示。我的问题是我是否有一个语法错误会给我这个错误消息，或者是否有任何其他关于如何修复它的建议？

```
function updateClient($id,$first,$last,$email,$phone,$phoneCarrier,$tz,$wdh1,$wdh2,$weh1,$weh2,$goals){
global $conguest;
global $database;

$conguest->autocommit(false);  

//update the client tabel
$sql="UPDATE $database.client SET clientFirst = '?', clientLast = '?', clientEmail ='?', clientPhone =?, phoneCarrierId =?, timezoneId =?, clientHour1 ='?',clientHour2 ='?',clientHour3 ='?',clientHour4 ='?'
WHERE clientId = ?";

if($stmt = $conguest->prepare($sql)){        
    $stmt->bind_param('ssssiissssi', $first, $last, $email, $phone, $phoneCarrier, $tz, $wdh1, $wdh2, $weh1, $weh2, $id);
    $stmt->execute();        
    $clientupdate = $stmt->affected_rows;        
    $stmt->close();
}   
//update the goals table
$sql = "UPDATE $database.goal SET goalContent=?, categoryId = ?, goalDate=now() WHERE goalId = ?";

foreach ($goals as $goal) {
    if ($stmt = $conguest->prepare($sql)) {
        $stmt->bind_param('sii', $goal['goal'],$goal['cat'], $goal['id']);
        $stmt->execute();
        $i = $stmt->affected_rows;
        $stmt->close();
    }
    if($i){
        $goalupdate ++;
    }
}
//test that all updates worked
echo "$clientupdate, $goalupdate";
exit;
if($clientupdate ==1 && $goalupdate == 3){
    $conguest->commit();
    $conguest->autocommit(true);
    return 1;
}else{
    $conguest->rollback();
    $conguest->autocommit(true);
    return 0;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:53:06.470

删除占位符周围的单引号。代替

```
$sql="UPDATE $database.client SET clientFirst = '?', clientLast = '?', clientEmail ='?', clientPhone =?, phoneCarrierId =?, timezoneId =?, clientHour1 ='?',clientHour2 ='?',clientHour3 ='?',clientHour4 ='?' WHERE clientId = ?"; 
```

和

```
$sql="UPDATE $database.client SET clientFirst = ?, clientLast = ?, clientEmail = ?, clientPhone = ?, phoneCarrierId = ?, timezoneId = ?, clientHour1 = ?, clientHour2 = ?,clientHour3 = ?,clientHour4 = ? WHERE clientId = ?"; 
```

此外，在“where clientid”之前有一个换行符。我不知道这是否相关。

# c# - Python 到 C# RGBA 值的转换不起作用

> ID：13546389
> 
> 赞同：3
> 
> 时间：2012-11-24T22:40:44.980
> 
> 标签：c#, python, rgba

我目前正在将一些 python 代码转换为 C#，我遇到了 RGBA C# 库的问题

```
# Original Python Code:
    d = math.sqrt( (x - size/2.0)**2 + (y - size/2.0)**2 )
    rgbVal = int(200*d/md + 50)
    rgba = (0,0,0, 255 - rgbVal)
    img.putpixel((x,y), rgba)

// My C# Code
double d = Math.Sqrt(Math.Pow((x - DotSize / 2.0), 2) + Math.Pow((y - DotSize / 2.0), 2));
int rgbVal = (int) (200 * d / md + 50);
Color color = Color.FromArgb(255 - rgbVal, 0, 0, 0);     // ** ERROR **
img.SetPixel(x,y, color); 
```

在代码的两个实例中，d 等于 106，md 等于 53。但是，生成的 rgbVal 值是 450。这显然意味着 255 - 450 是 -195，这会导致抛出错误，因为每个单独的值都必须介于 0 到 255 之间。任何人都知道我该如何解决这个问题。请注意，运行 python 和 C# 版本时数据是相同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:01:38.500

您可以使用 mod 标准化该值。

```
// I'm a little confused by your code, so it's this
Color color = Color.FromArgb(255 - ((-190 + 255) % 255), 0, 0, 0);
// or this...
Color color = Color.FromArgb(((-190 + 255) % 255), 0, 0, 0); 
```

# jsf - JSP 标记库和 xhtml

> ID：13546390
> 
> 赞同：1
> 
> 时间：2012-11-24T22:40:58.650
> 
> 标签：jsf, richfaces, jsp-tags

我尝试通过扩展`TagSupport`. 我想使用自定义标记在也使用 RichFaces 和 JSF 的 xhtml 文件中呈现一些 html。

我看到的所有关于您在`jsp`页面中注册的自定义标签的教程：

```
 <% taglib prefix="example" tagdir="/WEB-INF/tag-descriptor.tld" %> 
```

但是，这在 xhtml 文档中不起作用。我已经看到了基于 xhtml 片段的自定义 xhtml 标记，但我确实需要代码中的逻辑。

那么如何在jsf中注册一个jsp标签库呢？这可能吗？如果没有，是否可以像使用 jsp 一样在 xhtml 页面中编写 java 脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T09:24:04.753

对于 Facelet (.xhtml)，您不能注册 JSP 标记库。

`javax.servlet.jsp.tagext.TagSupport`Facelets 是一种与 JSP 完全不同的技术，并且在涉及特定于每种技术的工件（例如）时，这两种技术在任何方面都不兼容。

但是，JSF 的自定义 JSP 标记背后是一个组件，您当然可以在 Java 中为 Facelets 编写这些标记。它归结为直接在 Java 中创建一个组件，然后将其注册到一个`*-taglib.xml`（对于 JSF 2.2，不再需要在 XML 文件中进行此注册）。

有关详细信息，请参阅[基于简单 Java 的 JSF 自定义组件](http://jdevelopment.nl/simple-java-based-jsf-custom-component)。

# android - 我活动中的条形码扫描仪意图

> ID：13546392
> 
> 赞同：1
> 
> 时间：2012-11-24T22:41:07.183
> 
> 标签：android, android-intent, zxing

有没有办法将 Zxing 意图放入我的活动的一部分？例如，我想在屏幕上保留一些文本和按钮 + 条形码扫描仪意图。任何示例/教程将不胜感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-24T23:07:51.390

我记得我以前做过类似的东西。您应该尝试：
- 创建一个`Activity`. （例如 MyCaptureActivity）
- 复制粘贴上面创建的类`CaptureActivity`的内容。 - 创建布局 XML 文件。（例如 mycapture.xml） - 将文件 capture.xml 的内容复制粘贴到上面创建的文件中。-在 MyCaptureActivity 中 找到该行并将其替换为。 - 然后，您可以在布局中添加文本和按钮。 - 您可以修改活动以根据需要做出反应并删除一些视图。`Activity`

`setContentView(R.layout.capture);``setContentView(R.layout.mycapture);`

# java - 如何执行外部程序

> ID：13546393
> 
> 赞同：4
> 
> 时间：2012-11-24T22:41:08.203
> 
> 标签：java, python, ipc

我正在尝试从 python 程序执行 java 程序：

```
subprocess.Popen(["java -mx256m -jar /sphinx4-1.0beta5/bin/HelloWorld.jar"], shell=True) 
```

但它失败并出现此错误：

```
Error: Unable to access jarfile /sphinx4-1.0beta5/bin/HelloWorld.jar 
```

我需要在特定目录中：`/home/karen/sphinx4-1.0beta-src`，才能执行命令：`"java -mx256m -jar /sphinx4-1.0beta5/bin/HelloWorld.jar"` 但我不知道该怎么做。我需要我的 python 程序执行它！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T22:54:32.283

使用 cwd 参数

```
subprocess.Popen(["java -mx256m -jar ../sphinx4-1.0beta5/bin/HelloWorld.jar"], cwd=r'path', shell=True) 
```

[http://docs.python.org/2/library/subprocess.html](http://docs.python.org/2/library/subprocess.html) "如果cwd不是None，子进程的当前目录在执行前会被改成cwd。注意搜索可执行文件时不考虑这个目录，所以你不能指定程序相对于 cwd 的路径。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:50:12.773

您的问题可能与您的 jar 文件路径有关。您的代码很可能在您的 popen 调用中调用 /home/Karen/sphynx4-1beta-src。这不是一个适用于不同系统的解决方案，除非文件位于相同的绝对路径中。

# node.js - Jade - 如何用连字符表示属性？

> ID：13546400
> 
> 赞同：2
> 
> 时间：2012-11-24T22:42:24.140
> 
> 标签：node.js, pug

我想`data-attribute`在翡翠模板的标签上放置一个 html5。我到底该怎么做？下面给出了一个语法错误。

```
 script(data-main="public/javascripts" src="public/javascripts/require.js") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T22:58:28.007

这是正确的，但您需要在属性之间使用逗号。

```
script(data-main="public/javascripts", src="public/javascripts/require.js") 
```

# c++ - 用不同的方法填充指针

> ID：13546403
> 
> 赞同：1
> 
> 时间：2012-11-24T22:42:40.257
> 
> 标签：c++, pointers

以下情况：

```
class Main{
   void MainMethod(){
      C * c;
      B * b = new B();
      b->fillC(c);
   }
};

class B{
   void fillC(C* c){
      c = new C();
   }
};

class C{
}; 
```

在我的软件中，我有这种情况。在程序结束时，对于 Main 类，c 仍然是空的。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:46:29.470

指针`c`被复制到`fillC`函数中——这称为*按值传递*。然后，您分配给该副本。原始`c`变量 from`MainMethod`不受影响。如果要更改指针，则需要*通过引用*传递指针：

```
class B{
  void fillC(C*& c){
    c = new C();
  }
}; 
```

现在`c`inside指向与in`fillC`相同的指针。改变一个值会影响另一个值。`c``MainMethod`

您也可以将参数更改`fillC`为 type `C**`，调用它`fillC(&c)`并分配给它`*c = new C()`- 但您已经在使用来自其他语言的成语混搭，所以我不推荐这样做。

不要忘记`delete c`在某个时候做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:46:22.093

将 B::fillC 更改为：

```
class B{
   void fillC(C*& c){
        c = new C();
    }
}; 
```

# c# - 在迭代之前等待任务完成

> ID：13546405
> 
> 赞同：1
> 
> 时间：2012-11-24T22:42:51.193
> 
> 标签：c#, .net-4.0, foreach, sqlbulkcopy

我有一个从目录中读取每个文件并将其上传到数据库的函数。我无法弄清楚如何在任务返回到 foreach 循环之前等待任务完成，因为它似乎马上就完成了，因为任务需要几秒钟：

```
foreach (string file in Directory.EnumerateFiles(folderPath, "*.xml"))
{
    //load file
    currentReader = new XmlDataReader(transferInstructions, file);

    currentReader.RowsUploaded += new EventHandler<RowsUploadedEventArgs>(currentReader_RowsUploaded);
    currentReader.TableUploaded += new EventHandler<TableUploadedEventArgs>(currentReader_TableUploaded);
    currentTask = new Task(() => currentReader.executeBulkCopy(initialConnString, workingDatabase));
    currentTask.ContinueWith(task =>
    {
        cleanUp(task);
        //MessageBox.Show("Complete!");
    });
    currentTask.Start();
    writeResult("Started the transfer process.");
    cmdDataTransfer.Text = "CANCEL TRANSFER";
    cmdDataTransfer.ForeColor = Color.DarkRed;
    transferAction = () => cancelCurrentReader();   
} 
```

在继续 foreach 循环之前，我需要等待 MessageBox.show 的位置。到达 cleanUp(task) 需要几秒钟；//MessageBox.Show("完成！"); 部分。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T22:52:40.340

C# 5 / .NET 4.5 中的 async-awqait 模式与此完美匹配。我看到您已将其标记为 .NET4，但如果您可以使用[Async Targeting Pack](http://www.microsoft.com/en-us/download/details.aspx?id=29576)，则有一种非常优雅的方法：

```
void Main()
{
    foreach (string file in Directory.EnumerateFiles(folderPath, "*.xml"))
    {
        currentReader = new XmlDataReader(transferInstructions, file); //load file
        currentReader.RowsUploaded += new EventHandler<RowsUploadedEventArgs>(currentReader_RowsUploaded);
        currentReader.TableUploaded += new EventHandler<TableUploadedEventArgs>(currentReader_TableUploaded);

        var task = Task.Factory.StartNew(() => currentReader.executeBulkCopy(initialConnString, workingDatabase));
        await task;

        cleanUp(task);
        MessageBox.Show("Complete!");
        writeResult("Started the transfer process.");
        cmdDataTransfer.Text = "CANCEL TRANSFER";
        cmdDataTransfer.ForeColor = Color.DarkRed;
        transferAction = () => cancelCurrentReader();   
    }
} 
```

如果您必须保留它 VS2010，则必须模仿 async-await 的功能，类似于：

```
void MyForm()
{
    _syncContext = SynchronizationContext.Current;
    Execute(Directory.EnumerateFiles(folderPath, "*.xml").GetEnumerator());
}

void Execute(IEnumerator<string> files)
{
    if (!files.MoveNext())
    {
        files.Dispose();
        return;
    }
    Task.Factory.StartNew(() => Execute(files.Current)).ContinueWith(() => Execute(files));
}

public void Execute(string file)
{
    currentReader = new XmlDataReader(transferInstructions, file); //load file
    currentReader.RowsUploaded += new EventHandler<RowsUploadedEventArgs>(currentReader_RowsUploaded);
    currentReader.TableUploaded += new EventHandler<TableUploadedEventArgs>(currentReader_TableUploaded);
    () => currentReader.executeBulkCopy(initialConnString, workingDatabase);
    cleanUp(task);
    _syncContext.Send(updateGUI); 
    transferAction = () => cancelCurrentReader(); 
}
public void updateGUI()
{
    MessageBox.Show("Complete!");
    writeResult("Started the transfer process.");
    cmdDataTransfer.Text = "CANCEL TRANSFER";
    cmdDataTransfer.ForeColor = Color.DarkRed;
} 
```

编辑现在我想到它还有一种更简单的方法。您可以让整个循环在它自己的任务中运行（委派给同步上下文以进行 GUI 工作）。使用上面代码的约定：

```
Task.Factory.StartNew(() => 
{
    foreach (var file in Directory.EnumerateFiles(folderPath, "*.xml"))
        Execute(file);
} 
```

# php - Twig 模板试图在无限循环中呈现自身（Symfony2 应用程序）

> ID：13546408
> 
> 赞同：0
> 
> 时间：2012-11-24T22:43:00.240
> 
> 标签：php, symfony, twig

应该在屏幕底部呈现的 Web 分析器栏抛出“达到 '100' 的最大函数嵌套级别”错误，因为它陷入了无限循环，试图在生成的代码中加载相同的模板文件。

这是导致无限循环的两行代码。

```
0.5359    7623912  96\. __TwigTemplate_12d25e382d980637bca9380c409ddd59->__construct(???) /var/www/site/app/cache/dev/classes.php:7999
0.5359    7624296  97\. Twig_Environment->loadTemplate(???, ???) /var/www/site/app/cache/dev/twig/12/d2/5e382d980637bca9380c409ddd59.php:10 
```

我检查了源代码，似乎同一个 Twig 模板正在其构造函数中加载自身。我在下面包含了这两个文件的源代码片段。我确定我需要包括更多，但我不确定要包括什么。

应用程序/缓存/dev/classes.php

```
public function loadTemplate($name, $index = null)
{
    $cls = $this->getTemplateClass($name, $index);
    if (isset($this->loadedTemplates[$cls])) {
        return $this->loadedTemplates[$cls];
    }
    if (!class_exists($cls, false)) {
        if (false === $cache = $this->getCacheFilename($name)) {
            eval('?>'.$this->compileSource($this->loader->getSource($name), $name));
        } else {
            if (!is_file($cache) || ($this->isAutoReload() && !$this->isTemplateFresh($name, filemtime($cache)))) {
                $this->writeCacheFile($cache, $this->compileSource($this->loader->getSource($name), $name));
            }
            require_once $cache;
        }
    }
    if (!$this->runtimeInitialized) {
        $this->initRuntime();
    }
    return $this->loadedTemplates[$cls] = new $cls($this); // CALLS THE CONSTRUCTOR BELOW
} 
```

应用程序/缓存/开发/树枝/12/d2/5e382d980637bca9380c409ddd59.php

```
public function __construct(Twig_Environment $env)
{
    parent::__construct($env);

    $this->parent = $this->env->loadTemplate("WebProfilerBundle:Profiler:layout.html.twig"); // CALLS THE loadTemplate METHOD ABOVE

    $this->blocks = array(
        'body' => array($this, 'block_body'),
        'panel' => array($this, 'block_panel'),
    );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-06T23:35:00.410

我无法发表评论，因此我将其发布为解决方案。对不起。

有时，在服务器配置或 htaccess 中定义的某些重定向或重写规则会导致无限的重写或重定向。我建议修改你的路线，比如改变

```
/foo/bar/1 
```

至

```
/foo/bar/1/ 
```

或者，尝试检查您的重定向或重写规则。如果你 100% 确定你的代码是正确的，我相信你会赶上一些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-29T06:58:42.007

这是旧的，但我最近遇到了同样的问题。

我尝试清除我的缓存，增加我的 xdebug 限制，并检查我的 twig 文件中的循环包含，但这些都没有帮助。

对我来说，解决方案是确保在我的`composer.json`文件中加载稳定版本的 twig，方法是将以下代码添加到我的 require 部分：

```
"twig/twig": "@stable" 
```

# matlab - 将图像的裁剪部分放回原始尺寸

> ID：13546410
> 
> 赞同：0
> 
> 时间：2012-11-24T22:43:15.700
> 
> 标签：matlab

你好 StackOverflow 社区，

两天以来，我遇到了一个问题，图像更大，ROI 是图像的一部分。我想用它`imrect`来选择 ROI 并裁剪 ROI，这样我就可以处理更少的数据。处理后，我想将裁剪后的图像重新映射回图像的原始位置。

到目前为止我通过调试做了什么：

```
function paddedImg = putCroppedImgBack(croppedIm, Pos, origDim)
paddedImg = zeros(origDim);
r = round(Pos(1));
c = round(Pos(2));
if(r ==0) % because ML addresses a matrix not with 0 like in cpp
     r=1;
end
sizeR = size(croppedIm,1);
sizeC = size(croppedIm,2);
paddedImg(r:sizeR,c:sizeC) = croppedIm; %this part doesn't work!
%Subscripted assignment dimension mismatch. 
```

我尝试了`round`的坐标`imrect`，但效果不佳。我还使用值手动`paddedImg`处理，例如 `paddedImg(1:5,20:50) = 1;`，它有效。

**编辑：** 在我在这里开始发帖后找到了解决方案....有时我应该早一点问 StackOverflow，而不是花一整天不眠之夜。

`paddedImg(r:sizeR+r-1,c:sizeC+c-1) = croppedIm;`

真挚地

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T16:09:28.057

编辑：在我在这里开始发帖后找到了解决方案....有时我应该早一点问 StackOverflow，而不是花一整天不眠之夜。

`paddedImg(r:sizeR+r-1,c:sizeC+c-1) = croppedIm;`

# css - 这是一种正确的水平菜单技术吗？

> ID：13546411
> 
> 赞同：0
> 
> 时间：2012-11-24T22:43:22.813
> 
> 标签：css, menu

我的 CSS 是：

```
#menu {
    background-color: #a40a0a;
    width: 830px;
    height: 36px;
    position: relative;
    top: 39px;
    left: 172px;
}
#menu >ul {
    list-style-type: none;
}
#menu ul li {
    font-family: Arial, Helvatica, Verdana;
}
#menu ul li >a {
    display: block;
    float: left;
    text-decoration: none;
    color: #ffffff;
    line-height: 36px;
    width: 166px;
    text-align: center;
}
#menu ul li >a:hover {
    background-color: #d74343;
    border-bottom: 2px solid #bc1515;
    line-height: 34px;
}
#menu ul li >a:active {
    background-color: #a40a0a;
} 
```

此菜单看起来不正确 ie7 及以下。如果是错的，请告诉我正确的，谢谢。

[http://jsfiddle.net/a4Qe3/](http://jsfiddle.net/a4Qe3/)这里是链接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:15:42.610

你需要穿上`float`而`li`不是`a`。这是因为 li 每次都会阻塞。

这是更新的代码：

**CSS**

```
#menu {
    background-color: #a40a0a;
    width: 830px;
    height: 36px;
    position: relative;
    top: 39px;
    left: 172px;
}
#menu > ul {
    list-style-type: none;
}
#menu ul li {
    font-family: Arial, Helvatica, Verdana;
    float: left;
}
#menu ul li > a {
    display: block;
    text-decoration: none;
    color: #ffffff;
    line-height: 36px;
    width: 166px;
    text-align: center;
}
#menu ul li > a:hover {
    background-color: #d74343;
    border-bottom: 2px solid #bc1515;
    line-height: 34px;
}
#menu ul li > a:active {
    background-color: #a40a0a;
} 
```

**[演示](http://jsfiddle.net/a4Qe3/1/)**

**编辑 1**

我们把 the 放在 the`float`上，`li`而不是 the，`a`因为每个`a`都包裹在适用于每个的 a`li`中。`display: block;`如果您考虑 DOM 结构，如果您浮动`a`标签，您就是浮动的项目，它们彼此相邻，它们不在同一个范围内。它们不是 DOM 兄弟姐妹。他们的父母是。所以你只是让他们的父母闲逛。现在在 IE7 中，如果您在阻塞元素之后浮动，则该浮动项目将被向下推，就像您的情况一样。所以我们应该做的是浮动`li`项目。

[这是一个标签浮动的演示](http://jsfiddle.net/a4Qe3/2/)，`a`我在标签周围放置了一个边框`li`以显示正在发生的事情。在 IE7 中检查它。

# function - 从Scala中的可迭代传递函数参数？

> ID：13546412
> 
> 赞同：4
> 
> 时间：2012-11-24T22:43:26.963
> 
> 标签：function, scala, arguments

是否可以从 Scala 中的可迭代对象中传递函数参数？

```
val arguments= List(1,2)
def mysum(a:Int,b:Int)={a+b} 
```

如何使用 List 内容作为参数调用 mysum？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:07:49.523

要让它在列表上工作，您需要将该`mysum`函数容纳为“varargs”：

```
scala> def mysum ( args : Int* ) = args.sum
mysum: (args: Int*)Int

scala> val arguments = List(1,2)
arguments: List[Int] = List(1, 2)

scala> mysum(arguments: _*)
res0: Int = 3 
```

# variables - 在批处理脚本中使用变量时，它会添加讨厌的空格

> ID：13546417
> 
> 赞同：1
> 
> 时间：2012-11-24T22:44:29.700
> 
> 标签：variables, batch-file

我正在做一些批处理编程，我使用感叹号！对于计数器变量

因此，每当我使用`!count!`它时，它都会在该变量之后直接添加一个讨厌的空间。因为我想用它来重命名文件，所以很烦人

这是在 .jpg 之前插入空格的完整代码

`FOR %%F IN ("*.*") DO ( MOVE "%%F" "%MyDir%-file-0!count!.jpg" SET /a count=!count!+1 )`

任何想法如何避免空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T00:22:39.833

BAT 肯定非常古怪。也许是 "+1" 和 ")" 之间的空格？您的脚本是否包含 DelayedExpansion？这通常是必要的。

我建议尽管使用子程序。它有一些非常有用的参数编辑能力。看“呼叫/？”。

特别是，说 call :MySub "File name.txt" 在 "MySub" 中，%1 将是 "File name.txt" - 包括引号。但是 %~1 会去掉引号。这使您可以很好地处理带有空格的文件名。所以“我的路径有空格\%~1”会导致“我的路径有空格\文件名.txt” - 在整个字符串周围有一组引号。您还可以拆分文件名和扩展名。

```
@echo off

setlocal ENABLEDELAYEDEXPANSION
set count=0
set MyDir=MyDir
FOR %%F IN ("*.*") DO call :MoveThatFile  %%F
goto :EOF

:MoveThatFile
    echo MOVE "%~1" "%MyDir%-file-0!count!.jpg"
    SET /a count=!count!+1
    goto :EOF 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T11:14:41.030

如果这真的是完整的代码，那么一切都很糟糕，您没有连接命令，而是尝试使用变量 !COUNT! 在设置变量值之前。

除此之外，不包含变量是一种不好的做法。

```
@Echo OFF

Setlocal enabledelayedexpansion

FOR %%F IN (*) DO (
    SET /A "Count+=1"
    MOVE "%%F" "%MyDir%-file-0!COUNT!.jpg" 
) 

Pause&Exit 
```

# php - 使用 PHP 获取 URL 字符串

> ID：13546420
> 
> 赞同：1
> 
> 时间：2012-11-24T22:44:54.603
> 
> 标签：php, echo, explode, implode

这是我的网址：

```
http://www.mywebsite.com/local/cityname-free-services 
```

我在用

```
$url = $_SERVER['REQUEST_URI'];
$check = end(explode('/local/',$url));
$check = strtoupper($check);
echo $check; 
```

获取城市名称并将其大写。但是，当它回响时，我得到了这个：

```
CITYNAME-FREE-SERVICES 
```

当我想要回应的是：

```
CITYNAME 
```

我需要在代码中更改什么才能获得城市名称？

此外，一些城市名称中有破折号，我需要在回显时将它们替换为空格。为此需要添加什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:48:21.130

几种方式之一。这里有人可能会向您展示一些做得更好的正则表达式，但这会删除“免费服务”，并用空格替换破折号：

```
$url = $_SERVER['REQUEST_URI'];
$check = end(explode('/local/',$url));
$check = strtoupper(str_ireplace("free-services", "", $check));
echo str_replace("-", " ", $check); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:49:53.130

你想再次爆炸你的结果字符串`-`并保留第一个元素，类似于

```
$url = $_SERVER['REQUEST_URI'];
$check = end(explode('/local/',$url));
$check = current(explode('-', strtoupper($check)));
echo $check; 
```

这样，如果最后一部分发生了变化，你仍然有你的`CITYNAME`有效。

Some more explanation, `explode` (documentation [here](http://ca3.php.net/manual/en/function.explode.php)) will break the string into array elements, and it will break it using the first parameter, so in this case, passing `-` will create an array with 3 elements, `CITYNAME`, `FREE` and `SERVICES`. `current` (documentation [here](http://ca3.php.net/manual/en/function.current.php)) will take the current position in the array and return this value, by default, the current position is on the first element. You can also index individual elements in your array, so `explode('-', strtoupper($check))[0]` would also give you `CITYNAME`, and using `[1]` and `[2]` would give you `FREE` and `SERVICES`.

Edit: I didn't see the dash part about city names. This complicates a bit the problem as your URL contains other dashes that you want to get rid of. If "-FREE-SERVICES" is **constant** and that's always the part you want to get rid of, then doing what cale_b suggested is a good idea, which is to replace `"free-services"` with `""`. So I'm +1 his answer.

**Edit 2:** For some reason my answer was picked, for names with **dashes** you will need to do something similar to what cale_b suggested!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T22:49:33.973

```
$url = 'http://www.mywebsite.com/local/cityname-free-services';
$check = end(explode('/local/',$url));
$check = strtoupper($check);
echo $check; // prints CITYNAME-FREE-SERVICES
echo '<br>';
$first_element = strtoupper(str_ireplace(array("-free-services","-"),array(""," "),$check));
echo $first_element; // prints CITYNAME 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T22:51:19.223

```
$url = $_SERVER['REQUEST_URI'];
$check = end(explode('/local/',$url));
$check = strtoupper($check);
$check = explode("-", $check);
echo $check[0]; 
```

# c - 如何在C中为多个UDP数据包设置超时？

> ID：13546423
> 
> 赞同：2
> 
> 时间：2012-11-24T22:45:34.807
> 
> 标签：c, udp, timeout, alarm, select-function

我正在编写一个 UDP 服务器/客户端程序，其中服务器通过具有固定窗口大小的单个端口向客户端发送数据包，客户端将为收到的每个数据包发送回 ack 数据包。现在我希望服务器处理丢失数据包的情况。通过一些谷歌搜索，似乎我应该使用`ALARM`or `SELECT`。我当然不想发送一个数据包，等待ack或超时，然后再发送另一个，但是`SELECT`会在超时期间阻塞调用函数，所以我认为它不好。`ALARM`也不好，因为一个程序只能有一个`ALARM`. 那么有什么方法可以让我继续跟踪服务器发送的多个数据包的超时时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:21:23.920

以下是我首先想到的。

打开套接字以在非阻塞模式下监听。非阻塞是关键。如果 select 说有些东西在那里，但事件正好对齐，这可能是在其他地方处理的错误警报，并且阻止不来的东西是麻烦的。

对于发送的每个数据包，保留一个按超时时间升序排序的链接列表。

收到响应后，从链表中删除。

使用 select 等待下一个传入的数据包并具有合理的超时时间。我倾向于使用最多几秒钟，即使看起来更长的超时时间是合理的，以涵盖任何罕见的“以防万一”情况。您在这里阻止的是传入的数据包，但不会超过下一次超时。

一旦选择返回，如果请求可用，则接受（）并处理请求。

在迭代循环处理任何新的超时之前，适当地调整链表。

快速的网络搜索在[http://www.lowtek.com/sockets/select.html 找到](http://www.lowtek.com/sockets/select.html)了更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:50:42.380

select() 将以相同的方式阻止 recvmsg() 阻止。它是超时的替代品。您还可以使用 SO_RCVTIMEO 选项来设置读取超时，如果您的平台支持，这会更简单。

# javascript - 如何等待 WebSocket 的 readyState 改变

> ID：13546424
> 
> 赞同：44
> 
> 时间：2012-11-24T22:45:39.663
> 
> 标签：javascript, websocket, polling

我正在尝试使用回退到轮询的 WebSocket 来实现。如果 WebSocket 连接成功，`readyState`则变为 1，但如果失败，`readyState`则为 3，我应该开始轮询。

我试过这样的事情：

```
var socket = new WebSocket(url);
socket.onmessage = onmsg;
while (socket.readyState == 0)
{
}
if (socket.readyState != 1)
{
    // fall back to polling
    setInterval(poll, interval);
} 
```

我期待`socket.readyState`异步更新，并允许我立即阅读。但是，当我运行它时，我的浏览器冻结了（我在放弃之前将它打开了大约半分钟）。

我想也许有一个`onreadyStateChanged`事件，但我没有在 MDN 参考中看到一个事件。

我应该如何实施？显然空循环不起作用，并且没有事件。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-01-28T00:38:21.523

这很简单，而且效果很好......您可以添加关于最大时间的条件，或尝试次数以使其更健壮......

```
function sendMessage(msg){
    // Wait until the state of the socket is not ready and send the message when it is...
    waitForSocketConnection(ws, function(){
        console.log("message sent!!!");
        ws.send(msg);
    });
}

// Make the function wait until the connection is made...
function waitForSocketConnection(socket, callback){
    setTimeout(
        function () {
            if (socket.readyState === 1) {
                console.log("Connection is made")
                if (callback != null){
                    callback();
                }
            } else {
                console.log("wait for connection...")
                waitForSocketConnection(socket, callback);
            }

        }, 5); // wait 5 milisecond for the connection...
} 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-11-27T18:20:45.410

这是一个更详细的解释。首先，检查特定的浏览器 API，因为并非所有浏览器都使用最新的 RFC。您可以咨询

您不想运行循环来不断检查就绪状态，这是您不需要的额外开销。更好的方法是了解与就绪状态更改相关的所有事件，然后将它们适当地连接起来。它们如下：

`onclose`当 WebSocket 连接的 readyState 更改为 CLOSED 时要调用的事件侦听器。侦听器收到一个名为“close”的 CloseEvent。

`onerror`发生错误时要调用的事件侦听器。这是一个名为“错误”的简单事件。

`onmessage`从服务器接收到消息时要调用的事件侦听器。侦听器收到一个名为“消息”的 MessageEvent。

`onopen`当 WebSocket 连接的 readyState 变为 OPEN 时调用的事件监听器；这表明连接已准备好发送和接收数据。该事件是一个名称为“open”的简单事件。

JS 完全是事件驱动的，因此您只需连接所有这些事件并检查就绪状态，这样您就可以相应地从 WS 切换到轮询。

我建议您查看 Mozilla 参考资料，它比 RFC 文档更易于阅读，并且可以很好地概述 API 及其工作原理（[链接](https://developer.mozilla.org/en-US/docs/WebSockets/WebSockets_reference/WebSocket)）。

如果失败并轮询，请不要忘记为重试进行回调，直到触发成功重新连接的回调。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-01-05T13:10:01.523

我根本没有使用池。相反，我使用排队。首先我创建新的发送函数和一个队列：

```
var msgs = []
function send (msg) {
  if (ws.readyState !== 1) {
    msgs.push(msg)
  } else {
    ws.send(msg)
  }
} 
```

然后我需要在首次建立连接时读取并发送：

```
function my_element_click () {
  if (ws == null){
    ws = new WebSocket(websocket_url)
    ws.onopen = function () {
      while (msgs.length > 0) {
        ws.send(msgs.pop())
      }
    }
    ws.onerror = function(error) {
      // do sth on error
    }
  } 
  msg = {type: 'mymessage', data: my_element.value}
  send(JSON.stringify(msg))
} 
```

此示例中的 WebSocket 连接仅在第一次单击时创建。通常，在第二个消息开始直接发送。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-05-15T12:07:36.543

看看[http://dev.w3.org/html5/websockets/](http://dev.w3.org/html5/websockets/)

搜索“事件处理程序”并找到表。

onopen -> 打开
onmessage -> message
onerror ->error
onclose ->close

```
function update(e){ /*Do Something*/};
var ws = new WebSocket("ws://localhost:9999/");

ws.onmessage = update; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-10-30T18:48:07.873

如果您使用`async`/`await`并且只想等到连接可用，我建议您使用此功能：

```
async connection (socket, timeout = 10000) {
  const isOpened = () => (socket.readyState === WebSocket.OPEN)

  if (socket.readyState !== WebSocket.CONNECTING) {
    return isOpened()
  }
  else {
    const intrasleep = 100
    const ttl = timeout / intrasleep // time to loop
    let loop = 0
    while (socket.readyState === WebSocket.CONNECTING && loop < ttl) {
      await new Promise(resolve => setTimeout(resolve, intrasleep))
      loop++
    }
    return isOpened()
  }
} 
```

用法（在`async`函数中）：

```
const websocket = new WebSocket('...')
const opened = await connection(websocket)
if (opened) {
  websocket.send('hello')
}
else {
  console.log("the socket is closed OR couldn't have the socket in time, program crashed");
  return
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-05-20T10:24:15.803

**tl;博士**

一个简单的[代理](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)包装器，用于向[WebSocket](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API)`state`添加事件，该事件将在其更改时发出：`readyState`

```
const WebSocketProxy = new Proxy(WebSocket, {
    construct: function(target, args) {
        // create WebSocket instance
        const instance = new target(...args);

        //internal function to dispatch 'state' event when readyState changed
        function _dispatchStateChangedEvent() {
            instance.dispatchEvent(new Event('state'));
            if (instance.onstate && typeof instance.onstate === 'function') {
                instance.onstate();
            }
        }

        //dispatch event immediately after websocket was initiated
        //obviously it will be CONNECTING event
        setTimeout(function () {
            _dispatchStateChangedEvent();
        }, 0);

        // WebSocket "onopen" handler
        const openHandler = () => {
            _dispatchStateChangedEvent();
        };

        // WebSocket "onclose" handler
        const closeHandler = () => {
            _dispatchStateChangedEvent();
            instance.removeEventListener('open', openHandler);
            instance.removeEventListener('close', closeHandler);
        };

        // add event listeners
        instance.addEventListener('open', openHandler);
        instance.addEventListener('close', closeHandler);

        return instance;
    }
}); 
```

**很长的解释**：

您可以使用[Proxy](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)对象来监视内部[WebSocket](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API)状态。

这是一篇很好的文章，它解释了如何[使用 JS 代理对象调试 WebSockets](https://air.ghost.io/debugging-websockets-using-js-proxy-object/)

这是上面文章中的代码片段示例，以防将来该站点不可用：

```
// proxy the window.WebSocket object
var WebSocketProxy = new Proxy(window.WebSocket, {  
  construct: function(target, args) {
    // create WebSocket instance
    const instance = new target(...args);

    // WebSocket "onopen" handler
    const openHandler = (event) => {
      console.log('Open', event);
    };

    // WebSocket "onmessage" handler
    const messageHandler = (event) => {
      console.log('Message', event);
    };

    // WebSocket "onclose" handler
    const closeHandler = (event) => {
      console.log('Close', event);
      // remove event listeners
      instance.removeEventListener('open', openHandler);
      instance.removeEventListener('message', messageHandler);
      instance.removeEventListener('close', closeHandler);
    };  

    // add event listeners
    instance.addEventListener('open', openHandler);
    instance.addEventListener('message', messageHandler);
    instance.addEventListener('close', closeHandler);

    // proxy the WebSocket.send() function
    const sendProxy = new Proxy(instance.send, {
      apply: function(target, thisArg, args) {
        console.log('Send', args);
        target.apply(thisArg, args);
      }
    });

    // replace the native send function with the proxy
    instance.send = sendProxy;

    // return the WebSocket instance
    return instance;
  }
});

// replace the native WebSocket with the proxy
window.WebSocket = WebSocketProxy; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-24T23:57:21.670

就像您定义了一个`onmessage`处理程序一样，您也可以定义一个`onerror`处理程序。连接失败时将调用这个。

```
var socket = new WebSocket(url);
socket.onmessage = onmsg;
socket.onerror = function(error) {
    // connection failed - try polling
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-24T22:51:31.970

您的 while 循环可能会锁定您的线程。尝试使用：

```
setTimeout(function(){
    if(socket.readyState === 0) {
        //do nothing
    } else if (socket.readyState !=1) {
        //fallback
        setInterval(poll, interval);
    }
}, 50); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-08-03T08:40:01.330

在我的用例中，如果连接失败，我想在屏幕上显示错误。

```
let $connectionError = document.getElementById("connection-error");

setTimeout( () => {
  if (ws.readyState !== 1) {
    $connectionError.classList.add( "show" );
  }
}, 100 );  // ms 
```

请注意，在 Safari (9.1.2) 中不会`error`触发任何事件 - 否则我会将其放在错误处理程序中。

# ruby - 编写一个解析 xml 以分发给非编码人员的 ruby 脚本

> ID：13546425
> 
> 赞同：1
> 
> 时间：2012-11-24T22:45:54.187
> 
> 标签：ruby, macos, applescript, atom-feed

我正在创建一个开源工作流，它将通过以下方式将 OS X 应用程序 Devonthink 绑定到 Zotero：

1.  在 OS X 应用程序 devonthink 中调用的 AppleScript 将通过 shell 运行 Ruby 脚本
2.  这个 Ruby 脚本（我发现它比旧的 applescript 更快，更适合这类事情）将进行 API 调用并以 Atom 格式下载响应数据 [示例数据](https://api.zotero.org/users/475425/collections/9KH9TNSJ/items?format=atom)
3.  ruby 脚本将**解析 Atom 文件**并提取该数据的子集并输出
4.  Applescript 将捕获 Ruby 脚本的输出，并以各种方式与 devonthink 交互，同步数据。

我想在这里获得帮助的是**解析**这个工作流的 Atom 文件部分。

我知道有一些很棒的库可以在 Ruby 中解析 A​​tom，例如 Feedzirra 等，但它们需要安装 Gem。我将把 applescript+ruby 组合分发给可能对命令行或安装 gem 等几乎不熟悉或什至完全不熟悉的用户。我想让最终用户尽可能简单地将我的脚本放入他们的 applescript 文件夹和 ruby​​ 脚本连同它一起，无需他们采取任何进一步的行动。

**鉴于此：对于在 ruby​​ 中解析 A​​tom 文件而不**需要为脚本的最终用户安装任何 gem 或其他任务的最佳解决方案，您有哪些建议（是否有可以简单地包含在正文中的解析代码？例如脚本本身？）。

我想一些可能的解决方案可能会暗示答案：

a) 使用原生 ruby​​ 功能来解析 xml

b) 使用一些可以直接复制/粘贴到我的 ruby​​ 脚本中的方法

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T11:44:57.253

认为您在单个查询中提出了太多问题。尝试进一步分解您的问题，并在单独的帖子中提出主要问题。

顺便说一句，Nokogiri 是一个优秀的 Ruby XML 解析器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T15:38:05.510

我不是一个 ruby​​ 人，但您应该能够获取库的源文件，将它们放入您的 .rb 文件中，并且可能进行一些小的更改，使用其余源中的库。线索是找到一个小型且没有太多依赖项的库。

也许[Simple-RSS](https://github.com/cardmagic/simple-rss)会起作用？

# c# - 调用 JSON Web 服务时如何获取异常信息

> ID：13546429
> 
> 赞同：3
> 
> 时间：2012-11-24T22:46:10.437
> 
> 标签：c#, asp.net, .net, web-services, asp.net-ajax

在 .NET 3.5 中，我有以下代码：

```
[WebService(Namespace = "http://kitchenpc.com/schemas/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService]
public class KitchenPC : System.Web.Services.WebService
{
   [WebMethod]
   public LogonResult Logon(string username, string password)
   {
      //If username and password are not valid...
      throw new InvalidUsernameOrPasswordException();
   }
} 
```

当我调用它时，如果我传入了无效的用户名和密码，`InvalidUsernameOrPasswordException`则会抛出该异常，我可以通过查看`error.get_exceptionType()`. 这是因为 Web 服务会序列化 JSON 中的异常信息。

但是，一旦我升级到 .NET 4.5，它就坏了。现在，当我传入一个无效的用户名和密码时，我得到了 HTTP 响应：

```
HTTP/1.1 500 Internal Server Error
Cache-Control: private
Content-Type: application/json; charset=utf-8
Server: Microsoft-IIS/7.5
jsonerror: true
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Sat, 24 Nov 2012 22:42:33 GMT
Content-Length: 91

{"Message":"There was an error processing the request.","StackTrace":"","ExceptionType":""} 
```

基本上，异常类型会丢失并替换为通用错误消息。

是什么导致了这种行为的改变，还有没有办法以 JSON 格式返回异常信息？几乎我的整个 API 都是为了依赖这种行为而设计的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T22:59:47.467

啊，这是一个愚蠢的问题。仅当您具有以下条件时才会出现异常信息：

```
<customErrors mode="Off" /> 
```

在您的 web.config 中（在 下`<system.web>`）。我实际上不确定这是否是 .NET 3.5 -> .NET 4.5 的行为变化，或者当我使用 web.config 转换重写我的 web.config 构建过程时它是否被破坏。

有谁知道是否有办法在每个 Web 服务级别上控制它？我宁愿不在正常页面请求上显示完整的调试信息。

**更新：**

我还得出结论，抛出异常以从 Web 服务传达错误信息确实不是一个好的设计。事实上，我在我的博客上为感兴趣的人写了一篇[关于这个主题的文章。](http://blog.kitchenpc.com/2012/11/26/without-exception/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T22:57:53.220

异常类型不可序列化。请改用 FaultException。

```
throw new FaultException(..); 
```

# c# - 返回 MissingMethodException 的组合框的强类型列表

> ID：13546435
> 
> 赞同：1
> 
> 时间：2012-11-24T22:46:47.273
> 
> 标签：c#, asp.net, database

好的，所以有很多关于此类错误的帖子，但没有足够具体的内容让我缩小问题的范围。

```
SqlConnection con = null;
        List<State> list = new List<State>();
        try
        {
            con = Common.openConnection(Common.connectionString);
            string sql = "Select * from State order by state";
            SqlCommand cmd = new SqlCommand(sql, con);
            SqlDataReader reader = cmd.ExecuteReader();
            while (reader.Read())
            {
                State m = new State(int.Parse(reader.GetValue(0).ToString()),reader.GetString(1), reader.GetString(2), int.Parse(reader.GetValue(3).ToString()));
                list.Add(m);
            }
            reader.Close();
        }
        catch (Exception ex)
        {
            throw new Exception("Error:[DALStateSQL] in selectAll : " + Common.NEWLINE + ex.ToString());
        }
        finally
        {
            Common.closeConnection(con);
        }
        return list; 
```

这是导致问题的方法。我只是想将它绑定到对象数据源并将其显示在列表框中。我得到这个堆栈跟踪：

```
[MissingMethodException: No parameterless constructor defined for this object.]
System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck) +0
System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache) +98
System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean skipCheckThis, Boolean fillCache) +241
System.Activator.CreateInstance(Type type, Boolean nonPublic) +69
System.Web.UI.WebControls.ObjectDataSourceView.InvokeMethod(ObjectDataSourceMethod method, Boolean disposeInstance, Object& instance) +138
System.Web.UI.WebControls.ObjectDataSourceView.ExecuteSelect(DataSourceSelectArguments arguments) +1953
System.Web.UI.WebControls.ListControl.OnDataBinding(EventArgs e) +97
System.Web.UI.WebControls.ListControl.PerformSelect() +34
System.Web.UI.WebControls.BaseDataBoundControl.DataBind() +74
System.Web.UI.WebControls.BaseDataBoundControl.EnsureDataBound() +66
System.Web.UI.WebControls.ListControl.OnPreRender(EventArgs e) +29
System.Web.UI.Control.PreRenderRecursiveInternal() +103
System.Web.UI.Control.PreRenderRecursiveInternal() +175
System.Web.UI.Control.PreRenderRecursiveInternal() +175
System.Web.UI.Control.PreRenderRecursiveInternal() +175
System.Web.UI.Control.PreRenderRecursiveInternal() +175
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2496 
```

这什么也没告诉我，因为跟踪中没有任何内容是我自己的代码。

我有另一种相同的方法，它有效，它只是行为不端的方法的复制粘贴。状态类本身相当简单：

```
private int stateId;
    private string stateCode;
    private string name;
    private int countryCode;

    public int StateId
    {
        get { return stateId; }
        set { stateId = value; }
    }

    public string StateCode
    {
        get { return stateCode; }
        set { stateCode = value; }
    }

    public string Name
    {
        get { return name; }
        set { name = value; }
    }

    public int CountryCode
    {
        get { return countryCode; }
        set { countryCode = value; }
    }

    public State()
    {
        this.stateId = 0;
        this.stateCode = "";
        this.name = "";
        this.countryCode = 0;
    }

    public State(int stateId, string stateCode, string name, int countryCode)
    {
        this.stateId = stateId;
        this.stateCode = stateCode;
        this.name = name;
        this.countryCode = countryCode;
    } 
```

编辑：我忘了提及 selectAll() 方法在其他地方完美调用，但在尝试将其绑定到对象数据源时中断。……？

# mysql - Rake 似乎在劫持 MySQL

> ID：13546440
> 
> 赞同：1
> 
> 时间：2012-11-24T22:47:57.803
> 
> 标签：mysql, ruby-on-rails, rake, ubuntu-12.10, mysqladmin

因此，如果我键入`mysql -u root`我应该已登录，但是在尝试创建或访问数据库时，我会收到这个可爱的错误：`ERROR 1044 (42000): Access denied for user ''@'localhost' to database 'test1'`. 我不知道为什么在以 root 身份登录后它正在尝试访问数据库`''@'localhost'`，这让我现在有点发疯。可能相关，当我尝试设置 root 密码时出现错误`mysqladmin: Can't turn off logging; error: 'Access denied; you need (at least one of) the SUPER privilege(s) for this operation'`。我尝试通过运行删除 mysql-server `apt-get purge mysql-server`，然后重新安装，但没有成功。这是运行 Ubuntu Server 12.10 64 位并且 mysql 确实在运行。

- 编辑 -

我想知道是否可能*没有*root用户。所以我尝试使用启动 MySQL`--skip-grant-tables`并创建 root 用户，但随后我得到了这个： `ERROR 1290 (HY000): The MySQL server is running with the --skip-grant-tables option so it cannot execute this statement`. 好玩好玩好玩好玩。

--再次编辑--

我对加工中的所有mysql都采取了钝锤，并以root身份运行`apt-get remove .*mysql.*`，`apt-get purge .*msyql.*`然后重新安装了所有东西。这次安装按预期进行。如果没有人能对此提出答案（并且问题不再存在以进行测试可能无济于事）我会自己回答这个问题......似乎是这样的，绝对删除糟糕的安装是最好的选择。

--再次编辑--

我发现了导致问题的原因。我跑了`rake db:create`，`rake db:migrate`我新安装且功能正常的 MySQL 现在又出现了同样的问题。我想知道 rake 任务是否已经接管了 MySQL，就像一种真菌接管了一只蚂蚁一样……我的 MySQL 是一只被 rake 出没的僵尸蚂蚁（？！？！？！？！）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:14:18.613

如果您使用的是 Ubuntu，您的 mysql root 密码应该是您系统 root 用户的密码，除非您在安装 mysql 的过程中更改了它。

在任何其他情况下，停止mysql。

执行这个：

```
sudo mysqld_safe --skip-grant-tables & 
```

它将使您无需密码即可登录到 mysql root。

现在执行这个：

```
UPDATE mysql.user SET Password=PASSWORD(‘new_password’) WHERE User=’root’;
FLUSH PRIVILEGES; 
```

不要忘记；最后，不要忘记刷新特权；现在再次启动mysql：

```
sudo /etc/init.d/mysql start 
```

这应该这样做。

如果 root 用户因某种奇怪的命运转折而无法使用，则此行：

```
 sudo mysqld_safe --skip-grant-tables & 
```

仍然会为您提供创建新 root 用户的选项，但在这种情况下，请使用 google 查找方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T15:26:17.663

几秒钟前我遇到了这个问题并来到这里寻求答案，但后来我开始思考我从 mysqladmin 命令中得到的答案。所以我尝试了这个1：使用sudo su（root-password）在终端中以root身份登录，然后输入不带引号但空格是必须的：

```
mysqladmin -u @'hostname' (us your hostname then press enter). 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:05:00.720

使用 登录 mysql`mysql -u root`并输入`show grants for 'root'@'localhost';`. 这应该告诉你，是否允许 root 任何东西。

顺便说一句，您是否在不提供密码的情况下登录？

# symfony - Symfony2 实体字段类型（多对多形式）包裹在 s

> ID：13546441
> 
> 赞同：1
> 
> 时间：2012-11-24T22:48:18.027
> 
> 标签：symfony

我有一个`buildForm()`看起来像这样的表单函数：

```
public function buildForm(FormBuilder $builder, array $options)
{   
    $builder->add('interestingSports', 'entity', array(
        'multiple' => true,
        'expanded' => true,
        'property' => 'name',
        'class'    => 'Foo\MyBundle\Entity\Sport',
    )); 
} 
```

这很好用，除了表单只是弹出一堆没有`<li>`s 或周围任何东西的复选框，我想要`<li>`s。

Symfony 是否有办法让我将每个复选框放在一个`<li>`?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-24T23:07:20.370

`<li>`显示被标签包围的复选框的最佳和最简单的方法是通过单独显示字段来自[定义表单呈现，](http://symfony.com/doc/2.0/cookbook/form/form_customization.html)

```
{# Any other form field #}
{{ form_widget(form.otherField) }}
{{ form_widget(form.otherField) }}
{# ... #}
{# Your checkboxes surrounded by <li> tags #}
{% for field in form.interestingSports %}
   <li>
     {{ form_label(field) }}
     {{ form_widget(field) }}
   </li>
{% endfor %}
{# Render all fields that have not yet been rendered #}
{{ form_rest(form) }} 
```

# reporting-services - SQL Server 2012 的 SSDT - SSRS 向后兼容性

> ID：13546444
> 
> 赞同：1
> 
> 时间：2012-11-24T22:48:48.827
> 
> 标签：reporting-services, sql-server-data-tools

从我学到`Business Intelligence Studio`的关于 SQL Server 2012 的各种文章中，现在称为`SQL Server Data Tools (SSDT)`，并且是 VS 的插件。有 VS 2010 和 2012 的版本，可以[从这里](http://blogs.msdn.com/b/ssdt/archive/2012/11/07/sql-server-data-tools-november-2012-is-now-available.aspx?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20ssdtblog%20%28SQL%20Server%20Developer%20Tools%20Team%20Blog%29)下载。

向后兼容的范围是什么，即我可以使用 SSDT 为 SQL server 的早期版本开发报告吗？我对2005年及以上特别感兴趣。

根据[这篇文章](http://www.dbi-services.com/index.php/blog/entry/sql-server-2012-new-features-for-reporting-services-ssrs-)，SSDT 应该支持 2005 及更高版本，但对于 VS 2010。这种支持的级别是什么 - 项目需要转换吗？另外，这同样适用于 2012 SSDT 吗？

如果我们可以避免为每个开发人员安装多个版本的 Visual Studio，那将是很好的，只是为了老客户的报告开发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:50:50.480

SSDT 支持 2005 及更高版本，但解决方案和项目都需要转换。我能够将 2005 解决方案和 2008 R2 解决方案转换为 VS 2010 (v10)。您可以选择仅转换解决方案，而不保存转换后的项目，以保持与之前版本的 BIDS 的兼容性。因此，在过渡阶段，其他开发人员将继续使用项目文件。但是，使用此设置，BIDS 会在您每次启动项目时不断要求升级项目，因此这是一个折衷方案。

官方支持仅适用于 2008 年及更高版本，因为如果您尝试使用`Detect Version`SSRS，它将在 2005 年失败。因此它可以针对 2008 和 2008 R2+，但您仍然可以使用 2008 目标生成 2005 年的报告。而且由于 RDL 文件的格式在转换过程中不会改变，我假设您可以使用这种方法成功开发和部署报告到 SSRS 2005（风险自负）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-05T16:28:19.277

测试了这个：

1.  SQL Server Data Tools (SSDT) 向后兼容 BIDS 2005 和 BIDS 2008，但是：

a.您可以将 BIDS 2005 文件转换为 SSDT，然后修改 SSDT 中的 rdl，但这不会在 BIDS 2005 中打开备份（与 BIDS 2005 和 BIDS 2008 相同的问题）

b.您可以在 SSDT 中修改现有的 BIDS 2008 rdl，然后在 BIDS 2008 中打开它，反之亦然。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-09T19:38:30.087

更新信息：

SSDT-BI 团队有[一篇博客文章](https://blogs.msdn.microsoft.com/analysisservices/2014/04/02/sql-server-data-tools-business-intelligence-for-visual-studio-2013-ssdt-bi/)显示了 SSDT-BI 2014 对 VS 2013 的向后兼容性

[![SSDT-BI 2014 for VS 2013 兼容性矩阵](../Images/8a2247ee85e68286ebd7d2c50dcfcf67.png)](https://i.stack.imgur.com/mhEZf.png)

此外，有关该主题的 MSDN 链接：SSRS - [https://msdn.microsoft.com/en-us/library/ee635898.aspx](https://msdn.microsoft.com/en-us/library/ee635898.aspx) SSIS - [https://msdn.microsoft.com/en-us/library/bb522577.aspx](https://msdn.microsoft.com/en-us/library/bb522577.aspx)

# visual-studio - 从流中反序列化多种类型

> ID：13546447
> 
> 赞同：0
> 
> 时间：2012-11-24T22:49:15.013
> 
> 标签：visual-studio, serialization, types, deserialization, binaryformatter

我有一个纸牌游戏程序，到目前为止，聊天在主机和客户端之间的 TCPClient 流上来回运行良好。我想通过序列化和反序列化来做到这一点，这样我也可以在主机和客户端之间传递卡片。我试图为卡片的传递创建一个单独的 TCPClient 流，但它不起作用，并且认为保留一个获取文本消息和卡片的 TCPClient 流可能更容易。所以我创建了一个类，称为谷物，它具有卡片的属性，可以帮助我从另一端的嵌入式卡片数据库重建卡片。有没有办法让我的程序弄清楚卡片是否已放入流中，或者它是否' s 只是流中的文本，所以我可以正确地将其反序列化为字符串或谷物？或者我应该在我的谷物类中添加一个字符串属性，并且在反序列化为谷物后填充该属性时，我会知道它只是文本（如果反序列化后该字段为空，我会知道它是一张卡片）？我在想一个 try catch，它试图反序列化为一个字符串，如果它失败了，它会捕获并转换为谷物。或者我只是远离基地，应该选择另一条路线？我正在使用 Visual Studio 2011，正在使用二进制格式化程序，并且是序列化/反序列化的新手。如果它失败了，它将捕获并作为谷物投射。或者我只是远离基地，应该选择另一条路线？我正在使用 Visual Studio 2011，正在使用二进制格式化程序，并且是序列化/反序列化的新手。如果它失败了，它将捕获并作为谷物投射。或者我只是远离基地，应该选择另一条路线？我正在使用 Visual Studio 2011，正在使用二进制格式化程序，并且是序列化/反序列化的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:25:34.203

这应该适合你。通过网络发送 BaseMessage，然后检查输入的类型。

命名空间 ConsoleApplication3 { 类程序 { 静态无效 Main(string[] args) { BaseMessage bm = new CardMessage(); if (bm.GetType() == typeof(CardMessage)) { } } }

```
class BaseMessage : ISerializable
{
}

class ChatMessage : BaseMessage
{
}

class CardMessage : BaseMessage
{
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T19:25:01.693

最终创建了一个可序列化的容器类。如果我将文本发送到另一台计算机，我将容器的文本属性设置为任何文本。那么当接收到这个容器时，如果它有文本，接收计算机就会显示文本。如果接收到的容器包含一张卡片，它将创建卡片并根据在接收到的容器中找到的其他属性将其放置在需要去的地方。如果是弃牌，则根据容器中的附加属性找到该牌，并将其弃到正确的牌堆中。我还在容器中包含了一个命令作为字符串属性，所以如果所有其他属性都为假，它将查看命令属性是否具有字符串。如果是，则调用命令接收方法并找到正确的命令并执行代码。到目前为止效果很好。

# php - phpDoc @method 签名中的可选参数

> ID：13546450
> 
> 赞同：4
> 
> 时间：2012-11-24T22:49:29.693
> 
> 标签：php, phpdoc

有没有办法将@method签名中的参数标记为phpDoc中的可选？

像这样的东西：

```
/*
* @method bool alloc() alloc(int $filesize [, string &$result]) Allocates space for a file to be uploaded
*/ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T20:54:18.190

通常，phpDocumentor 通过查看方法签名中 arg 的默认值来识别可选参数。因此，使用您的示例：

```
@method bool alloc() alloc(int $filesize, string &$result = '') Allocates space for ... 
```

# c++ - 在函数内部创建两个 std::vector 对象并通过引用返回

> ID：13546460
> 
> 赞同：2
> 
> 时间：2012-11-24T22:50:37.747
> 
> 标签：c++, function, pass-by-reference

使用 C++，我想创建一个向量对象的实例`input`，如`main()`下面的测试程序的函数所示。向量填充数据，然后`input`通过引用传递给`compute()`函数。计算函数是返回两个向量对象`real`和`imag`。

是否可以按照下面代码片段中显示的方式返回这两个向量对象？

使用编译此代码`gcc`会出现以下错误：

```
In function ‘void compute(const std::vector<double>&, std::vector<double>&, std::vector<double>&)’:
error: declaration of ‘std::vector<double> real’ shadows a parameter
error: declaration of ‘std::vector<double> imag’ shadows a parameter 
```

也许有更好的方法来做到这一点？这是完整的测试程序：

```
#include <iostream>
#include <vector>

void compute(const std::vector<double> &input,
                    std::vector<double> &real, std::vector<double> &imag)
{
        unsigned int N = input.size();
        unsigned int csize = (N / 2) + 1;

        // the error occurs here
        std::vector<double> real(csize);
        std::vector<double> imag(csize);

        for (int i = 0; i < csize; i++)
        {
            real[i] = input[i] * i;
            imag[i] = input[i] * -i;
        }
 } // end

int main()
{
    const int num = 10;
    std::vector<double> input(num);
    for(int i = 0; i < num; i++)
        input[i] = i;

    std::vector<double> real;
    std::vector<double> imag;

    compute(input, real, imag);

 } // end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T22:52:24.490

矢量已经存在，因此您不想再次创建它们，而是将它们调整为适当的大小：

```
real.resize(csize);
imag.resize(csize); 
```

您的代码实际上是有效的，但是由于您在 -Werror 上进行编译，因此它被拒绝了。“阴影”意味着您将创建和修改函数本地的向量，因此通过引用传递的向量不会被更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T22:54:05.737

将“计算”更改为：

```
void compute(const std::vector<double> &input,
                std::vector<double> &real, std::vector<double> &imag)
{
    unsigned int N = input.size();
    unsigned int csize = (N / 2) + 1;

    real.resize(csize);
    imag.resize(csize);

    for (int i = 0; i < csize; i++)
    {
        real[i] = input[i] * i;
        imag[i] = input[i] * -i;
    }
} // end 
```

# api - glUseProgram(0) 有什么作用？

> ID：13546461
> 
> 赞同：22
> 
> 时间：2012-11-24T22:50:55.643
> 
> 标签：api, opengl, shader

[OpenGL 文档`glUseProgram`](http://www.opengl.org/sdk/docs/man/xhtml/glUseProgram.xml)声称使用*零*参数调用它会导致着色器执行的结果为`undefined`.

然而，经过一番搜索后，我看到了一些人们`glUseProgram`用来*卸载*当前着色器程序的例子。

这种行为可靠吗？如果不是，那么具体是`glUseProgram(0)`做什么的？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-24T23:33:31.673

`glUseProgram`表示给定的程序对象是将用于使用程序（`glUniform`、渲染命令等）的当前程序。0 很像`NULL`OpenGL 对象。它不代表一个对象（对于大多数对象）。因此，`glUseProgram(0)`意味着*没有*程序是当前的，因此没有程序将用于使用程序的事物。

`glUniform`如果您在没有当前程序的情况下尝试调用这些函数，它们将失败并出现错误。如果您尝试在没有当前程序时进行渲染，则会发生以下两种情况之一。在 OpenGL 3.1+ 核心配置文件中，您将获得未定义的行为，因为核心 OpenGL*必须*使用程序进行渲染。在兼容性配置文件或版本 3.0 或更低版本中，您将获得固定功能渲染。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T18:43:59.703

与这里和其他地方的许多答案相反，`glUseProgram(0)` **不会**恢复到固定功能模式。以这种方式使用它是不安全的。您可以使用它将渲染状态设置为无效的程序对象，但如果在渲染发生时它仍然绑定到 this，则行为是**undefined**。

从[文档](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glUseProgram.xhtml)：

> “如果程序为零，则当前渲染状态指的是无效的程序对象，着色器执行的结果是 `undefined`”

因此，结果完全特定于操作系统、驱动程序和显卡。在许多情况下，它似乎恢复到固定功能模式，但这不是规范中定义的，不应依赖。它可以很容易地保留最后一个着色器、渲染垃圾或导致段错误（我已经看到这种情况发生）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T22:57:12.157

它告诉 OpenGL 使用固定功能管道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T08:40:46.207

一旦您使用`glUseProgram(myShader)` 所有后续渲染，将使用着色器 ID 完成`myShader`。

如果您每次在 a 中进行重大更改时都调用它`modern openGL 3.1+`，那么 . 几乎没有用处`glUseProgram(0)`。

但是，如果您打算在其中集成一些固定功能渲染，例如`glVertex3f(..)`，那么`glUseProgram(0)` 将确保最后使用的着色器不再处于活动状态，并且它将使用固定功能管道，例如`glColor3f(...)`

# objective-c - '?:' 和目标 c 中的 if 语句有什么区别吗？

> ID：13546462
> 
> 赞同：9
> 
> 时间：2012-11-24T22:51:02.207
> 
> 标签：objective-c, if-statement, conditional, conditional-operator, inline-if

使用 '?:' 条件语句和简单的 'if-then-else' 语句之间有区别吗？它只是另一种方法，还是它实际上比“if”语句使用更少的空间/花费更少的时间来阅读？

例子：

如果声明：

```
if (item1.isEqualToString:@"2") //If statement
    [self doSomething];
else
    [self doSomethingElse];

item1.isEqualToString:@"2" ? [self doSomething] : [self doSomethingElse]; //'?:' statement 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-24T22:53:35.160

是，有一点不同。

从语义上讲，if/else 语句意味着

```
if (condition)
  statements
else
  statements 
```

而三元条件是

```
condition ? expression : expression 
```

因此，您可以将 ?: 运算符的结果分配给某事，而您不能使用 if 语句来执行此操作。实际上 ?: 运算符本身就是一个表达式，因此您可以将它嵌套在其他表达式中，甚至是其他 ?: 运算符。

?: 也经过类型检查，这

```
condition ? [self methodThatReturnsVoid] : [self methodThatReturnsInt] 
```

引发错误，因为结果类型可能会根据条件而改变。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-24T23:14:04.933

正如杰克所建议的那样，这是有区别的。您可以将运算符重写`?:`为：

```
ExpressionType temp;
if (condition) {
    temp = trueExpression;
}
else {
    temp = falseExpression;
}
lvalue = temp;  // (Where "lvalue" refers to the receiver of the resulting value) 
```

至于效率，一些机器指令集`?:`在简单情况下具有在硬件中实现的版本，但对于更复杂的情况（他们会使用类似于上述的东西）则没有，所以很难说哪个更有效。

运算符的主要优点`?:`是它允许将条件操作嵌入到表达式中，而不必用 if/else 分解表达式，这可以使代码在概念上（和视觉上）更简单，即使实际的机器复杂度没有显着（如果有的话）减少。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T21:43:02.067

除了 Jack 和 Hot Licks 提供的好答案之外，决定使用哪个部分是由必要性驱动的，部分是由风格驱动的。例如， ?: 通常会减少冗余，这可以使代码更简单、更短，更易于阅读和维护——没有更新 if..else 的一半而忘记另一半的风险。例如

```
int result = SomeFunction(arg1, arg2, arg3, (someBool ? arg4a : arg4b)); 
```

对比

```
int result = -1;
if (someBool) {
    result = SomeFunction(arg1, arg2, arg3, arg4a);
} else {
    result = SomeFunction(arg1, arg2, arg3, arg4b);
} 
```

为了简洁起见，这是一个简洁的示例，但是您可以想象，使用真实的参数名称和周围的复杂性，很容易在几个月后返回并修改对 SomeFunction 的第二次调用而没有意识到另一个调用存在，更不用说也应该修改.

# php - 多词搜索引擎查询

> ID：13546464
> 
> 赞同：2
> 
> 时间：2012-11-24T22:51:27.950
> 
> 标签：php, mysql, sql

我有这段代码，它希望将我输入的单词转换成一个数组，然后应该在数据库中搜索数组。该数据库具有由爬虫在网站中扫描的单词的行。

数组代码似乎不起作用:(我的查询如下：

```
 if( isset($_POST['keyword']) ){
        $k = $_POST['keyword'];
        }else{
        $k = '';
        }
        $k = ( isset($_POST['keyword']) )? trim($_POST['keyword']) : '';
        $terms = (strlen($k) > 0)? explode(' ', $k) : Array();

          $keyword = addslashes( $k);
          $results = addslashes( $_POST['results'] );

          /* Execute the query that performs the actual search in the DB: */
             $result = mysql_query(" SELECT p.page_url AS url,
                       COUNT(*) AS occurrences 
                       FROM page p, word w, occurrence o
                       WHERE p.page_id = o.page_id AND
                       w.word_id = o.word_id AND
                       w.word_word = \"$keyword\"
                       GROUP BY p.page_id
                       ORDER BY occurrences DESC
                       LIMIT $results" ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:42:00.507

您的问题的标题是“多词搜索引擎”，但是这段代码（SQL 部分暗示了一个经过深思熟虑的索引）不能容纳多个词。事实上，PHP 代码是乱码。它首先使用 if 表达式设置 $k 的值。然后它使用三元运算符将其设置为相同的值。

您没有提供您正在使用的搜索词的示例，也没有提供从中生成的查询。您也没有提供“似乎不起作用”的任何解释。

我建议您与编写爬虫和搜索数据库的人交谈 - 他们会解释说，如果您有多个术语，那么您需要以非常不同的方式将文字值拼接到查询中或加载它们（临时）进入一个表并将其与搜索查询连接起来。他们还应该给你一巴掌，告诉你去学习SQL注入。

例如

```
...
$qry=searchQuery($_POST['keywords'], $dbh);
if ($qry) {
    $limit = (integer) $_POST['results'] ? (integer) $_POST['results'] : 20;
    $qry.=" LIMIT $limit";
    result=mysql_query($qry, $dbh);
} else {
    ...
    exit;
}
...

function searchQuery($keywords $dbh)
{
   if (''==$keywords) return false;
   $keywords=str_replace('  ', ' ', $keywords); // remove consecutive spaces
   $keywords=str_replace('  ', ' ', $keywords); // cos you might have an odd number of consecutive spaces
   $parts=explode(' ', $keywords);
   foreach ($parts as $x=>$word) {
       $parts[$x]="'" . mysql_real_escape_string($word, $dbh) . "'";
   }
   $keywords=implode(',', $parts);
   return " SELECT p.page_url AS url,
                   COUNT(*) AS occurrences 
                   FROM page p, word w, occurrence o
                   WHERE p.page_id = o.page_id AND
                   w.word_id = o.word_id AND
                   w.word_word in ($keywords)
                   GROUP BY p.page_id
                   ORDER BY COUNT(DISTINCT w.word_id)*COUNT(*) DESC";

} 
```

# java - 以编程方式截取 JFrame 的屏幕截图

> ID：13546469
> 
> 赞同：0
> 
> 时间：2012-11-24T22:51:59.993
> 
> 标签：java, swing, jframe, screenshot, bluej

> **可能重复：**
> [Java Swing：获取 JFrame 的“图像”](https://stackoverflow.com/questions/5853879/java-swing-obtain-image-of-jframe)

是否可以以编程方式截取 JFrame 的屏幕截图？如何？

我正在使用 BlueJ。谢谢！

# ruby-on-rails-3 - 使用 ActiveRecordStore + 粘性会话的 RoR Cookie

> ID：13546471
> 
> 赞同：6
> 
> 时间：2012-11-24T22:52:06.230
> 
> 标签：ruby-on-rails-3, activerecord

我有一个在多个相同服务器上负载平衡的 RoR Web 应用程序（w/mysql）。该应用程序需要 cookie 和会话才能运行。

目前，客户端总是被路由到负载均衡器后面的同一台服务器，如果服务器被关闭，客户端将被路由到不同的服务器，他们的会话将结束。

当前架构的负载均衡器只会对同一数据中心的机器进行负载均衡。我想使用多个数据中心使用 DNS 循环在地理上进行负载平衡，并提供额外的冗余。

如果我要在我的 RoR 应用程序中为会话存储打开 ActiveRecordStore，这*应该可以*解决上述问题，客户端可以路由到每个服务器，并且它们的会话将保持不变。它是否正确？

使用 ActiveRecordStore 进行会话是否有严重后果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-19T09:44:03.130

**快速回答：** 鉴于所有数据中心的所有服务器都与同一个数据库通信，是的，这将解决您遇到的问题。

**后果：** 这里明显的问题是来自不同数据中心的所有服务器都与数据库通信到一个数据中心。这是非常低效的，因为它抵消了将应用程序分发到不同数据中心的大部分收益。您当然可以尝试通过 Internet 复制 mysqls，但这可能会导致数据最终保持一致，这意味着在切换服务器时，用户可能仍然面临无效会话。

**替代方案：** 为您的会话建立一个全球分布的存储，有点像 cassandra ring 或 riak 可能会更好，因为这些数据库旨在保持同步并提供对数据的一致访问。

# dynatree - 创建一个节点并将其作为兄弟节点添加到另一个具有 dynatree 的兄弟节点之前

> ID：13546476
> 
> 赞同：0
> 
> 时间：2012-11-24T22:52:31.730
> 
> 标签：dynatree, jquery-dynatree

我想以编程方式创建一个新节点。然后我想在另一个节点之前添加它作为兄弟节点。

此代码不起作用：

```
var node = $("#TreeDiv").dynatree("getActiveNode");
var nextSiblingNode = node.getNextSibling();
var childNode = node.addChild({ title: response.title, key: response.unitId }, nextSiblingNode); 
```

我错了什么？

更新：

那是我用上面的代码得到的例外：

```
Unhandled exception at line 4, column 20662 in http://localhost:1726/Scripts/jquery.dynatree.min.js

0x800a139e - runtime error in JavaScript: <beforeNode> must be a child of <this> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:45:06.740

在作为孩子创建节点后，我不得不移动节点并且它工作......当然代码仍然需要一些空检查;-)

```
var newNode = { title: response.title, key: response.unitId };
var activeNode = $("#TreeDiv").dynatree("getActiveNode");
var nextSiblingNode = activeNode.getNextSibling();
if (nextSiblingNode != null) {
    newNode = activeNode.addChild(newNode);
    newNode.move(nextSiblingNode, 'before');
}
else
{                      
    var parentNode = activeNode.getParent();
    newNode = parentNode.addChild(newNode);
}
newNode.activate(true);
newNode.focus(true); 
```

# ios - UIView 翻转动画问题

> ID：13546478
> 
> 赞同：0
> 
> 时间：2012-11-24T22:52:45.173
> 
> 标签：ios, xcode, animation, uiview, flip

我采用了一种在两个图像之间翻转的相当常用的方法。然而在这种情况下，由于目前我无法理解的原因 - 动画目前只是从“newView”翻转到“newView”。

任何指向我的方式错误的帮助将不胜感激。代码如下：

```
UIImageView *oldView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"dark_wood.png"]];
UIImageView *newView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"light_wood.png"]];
[container addSubview:oldView]; 
```

和：

```
[UIView transitionWithView:container
                  duration:2
                   options:UIViewAnimationOptionTransitionFlipFromLeft
                animations:^{ [oldView removeFromSuperview]; [container addSubview:newView]; }
                completion:nil]; 
```

（这可能是超出此代码的简单内容..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:06:27.040

可能是它们是 UIImageViews 但是这里有一些对我有用的示例代码。这是一个视图控制器，其视图加载方法看起来像这样

```
[super viewDidLoad];
view1 = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
view1.backgroundColor = [UIColor yellowColor];
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
button.frame = CGRectMake(0, 0, 50, 50);
[button addTarget:self action:@selector(thusFar:) forControlEvents:UIControlEventTouchUpInside];
[view1 addSubview:button];
[self.view addSubview:view1]; 
```

这是按钮调用的方法

```
-(void)thusFar:(id)sender
{

    UIView *view2 = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
    view2.backgroundColor = [UIColor brownColor];
    [UIView transitionWithView:self.view duration:5 options:UIViewAnimationOptionTransitionFlipFromLeft animations:^{ [view1 removeFromSuperview]; [self.view addSubview:view2]; } completion:nil];
} 
```

这对我有用。继续并使用此代码作为示例。但我看到的唯一不同是您使用的是 UIImageViews 而不是 UIViews。现在我知道 UIImageView 是 UIView 的孩子，但这可能是个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:43:52.680

*解决方案：*

我用来启动翻转的方法有问题。我有一个 UISlider 调用翻转 - 但没有适当的系统阻止它这样做，它不断调用翻转动画 - 所描述的后果！

代码中的解决方案如下：

创建一个`BOOL`停止`UISlider`重复调用动画：

```
BOOL playing; 
```

UISlider 的 IBAction：

```
- (IBAction)slider:(id)sender {
    if (!playing) {
        [UIView transitionWithView:self.view
                      duration:3
                       options:UIViewAnimationOptionTransitionFlipFromLeft
                    animations:^{ [view1 removeFromSuperview]; [self.view addSubview:view2]; }
                    completion:nil];
        playing = YES;
    }
} 
```

感谢托尼在这方面的帮助。如果有一个保持脚本干净的教训！

# django - 干燥 Django 视图 request.user 对象

> ID：13546483
> 
> 赞同：3
> 
> 时间：2012-11-24T22:53:38.750
> 
> 标签：django, django-models, django-views

我正在构建一个 Web 应用程序，我发现在检查 request.user 是否与创建电影的用户匹配时有很多复制。电影对用户有一个 FK，因此只有创建特定电影的用户才能对其执行适当的操作。

```
@login_required
def edit_movie(request, slug, template_name="movies/edit_movie.html"):
    movie = get_object_or_404(Movie, slug=slug)
    if movie.user != request.user:
        raise HttpResponseForbidden
    # Rest of code omitted for brevity.

@login_required
def edit_screener(request, slug, template_name="movies/edit_screener.html"):
    movie = get_object_or_404(Movie, slug=slug)
    movie_media = movie.moviemedia_set.get(movie_type='screener')
    if movie.user != request.user:
        raise HttpResponseForbidden()
    # Rest of code omitted for brevity.

@login_required
def dashboard(request, template_name='movies/dashboard.html'):
    movies = Movie.objects.active().filter(
        user=request.user).order_by('-created_at')
    # Rest of code omitted for brevity. 
```

我在 Ruby on Rails 方面有很强的背景，我们只需在控制器上使用 before_filter :find_user 以避免重复。Django 中处理这种重复的最佳方法是什么？

Ĵ

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:06:03.810

如果可以显示 404 而不是 403 你可以这样做：

```
movie = get_object_or_404(Movie, slug=slug, user=request.user) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T23:15:56.430

为什么不创建一个简单的函数来代替复制相同的代码呢？

```
def get_movie(slug, user):
    movie = get_object_or_404(Movie, slug=slug)
    if movie.user != user:
        raise Http403
    return movie 
```

# mysql - 如何确定 VARCHAR 字段值中的字节数？

> ID：13546484
> 
> 赞同：1
> 
> 时间：2012-11-24T22:53:39.090
> 
> 标签：mysql, varchar

我有一个 mysql 字段，其数据类型为 VARCHAR(5)，采用 utf 编码。如果我理解正确，字段值最多可以容纳 5 个字符，并且由于我使用的是 utf-8 编码，因此最多 20+1 个字节。

有什么方法可以确定字段值占用了多少空间？

例如，我希望以下内容占用超过 5 个字节

```
رروحي 
```

但是为此要占用 5 个字节

```
hello 
```

并为此占用超过 5 个字节

```
分別以後才 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T22:55:27.350

IIRC, mysql 有`length`和`char_length`功能，所以选择你需要的。显然，一个应该以字节为单位返回长度，另一个以字符为单位。

如果您想在它到达服务器端之前找到它，您需要提及您使用的编程语言。

# c++ - 窗口内的 C++ 输入框

> ID：13546488
> 
> 赞同：2
> 
> 时间：2012-11-24T22:53:59.770
> 
> 标签：c++, winapi, input

我正在尝试在我的窗口内放置一个小输入框，该窗口目前是一个黑色的窗口。

我的代码如下，谁能告诉我如何将输入框输入到窗口中，谢谢

```
"#include <windows.h>

 /*  Declare Windows procedure  */
 LRESULT CALLBACK WindowProcedure (HWND, UINT, WPARAM, LPARAM);

  /*  Make the class name into a global variable  */
 char szClassName[ ] = "WindowsApp";

 int WINAPI WinMain (HINSTANCE hThisInstance,
                HINSTANCE hPrevInstance,
                LPSTR lpszArgument,
                int nFunsterStil)

{
HWND hwnd;               /* This is the handle for our window */
MSG messages;            /* Here messages to the application are saved */
WNDCLASSEX wincl;        /* Data structure for the windowclass */

/* The Window structure */
wincl.hInstance = hThisInstance;
wincl.lpszClassName = szClassName;
wincl.lpfnWndProc = WindowProcedure;      /* This function is called by windows */
wincl.style = CS_DBLCLKS;                 /* Catch double-clicks */
wincl.cbSize = sizeof (WNDCLASSEX);

/* Use default icon and mouse-pointer */
wincl.hIcon = LoadIcon (NULL, IDI_APPLICATION);
wincl.hIconSm = LoadIcon (NULL, IDI_APPLICATION);
wincl.hCursor = LoadCursor (NULL, IDC_ARROW);
wincl.lpszMenuName = NULL;                 /* No menu */
wincl.cbClsExtra = 0;                      /* No extra bytes after the window class */
wincl.cbWndExtra = 0;                      /* structure or the window instance */
/* Use Windows's default color as the background of the window */
wincl.hbrBackground = (HBRUSH)GetStockObject (BLACK_BRUSH);

/* Register the window class, and if it fails quit the program */
if (!RegisterClassEx (&wincl))
    return 0;

/* The class is registered, let's create the program*/
hwnd = CreateWindowEx (
       0,                   /* Extended possibilites for variation */
       szClassName,         /* Classname */
       "Windows App",       /* Title Text */
       WS_OVERLAPPEDWINDOW, /* default window */
       CW_USEDEFAULT,       /* Windows decides the position */
       CW_USEDEFAULT,       /* where the window ends up on the screen */
       544,                 /* The programs width */
       375,                 /* and height in pixels */
       HWND_DESKTOP,        /* The window is a child-window to desktop */
       NULL,                /* No menu */
       hThisInstance,       /* Program Instance handler */
       NULL                 /* No Window Creation data */
       );

/* Make the window visible on the screen */
ShowWindow (hwnd, nFunsterStil);

/* Run the message loop. It will run until GetMessage() returns 0 */
while (GetMessage (&messages, NULL, 0, 0))
{
    /* Translate virtual-key messages into character messages */
    TranslateMessage(&messages);
    /* Send message to WindowProcedure */
    DispatchMessage(&messages);
}

/* The program return-value is 0 - The value that PostQuitMessage() gave */
return messages.wParam;
}

 /*  This function is called by the Windows function DispatchMessage()  */

LRESULT CALLBACK WindowProcedure (HWND hwnd, UINT message, WPARAM wParam, LPARAM     lParam)
{
switch (message)                  /* handle the messages */
{
    case WM_DESTROY:
        PostQuitMessage (0);       /* send a WM_QUIT to the message queue */
        break;
    default:                      /* for messages that we don't deal with */
        return DefWindowProc (hwnd, message, wParam, lParam);
}

return 0;
}" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:04:08.410

调用`CreateWindowEx()`with`L"EDIT"`作为窗口类名，主窗口作为父窗口。您可能还需要指定 X 和 Y 位置（不仅仅是 pass `CW_USEDEFAULT`），否则文本框可能不会显示。

# javascript - 在 Javascript 中进行长时间运行的计算时如何避免冻结浏览器

> ID：13546493
> 
> 赞同：40
> 
> 时间：2012-11-24T22:54:25.287
> 
> 标签：javascript, performance

我有一个网页，其中函数中的 javascript 计算需要大量时间才能完成并使页面冻结。当计算在后台发生时，我应该使用什么技术来确保 javascript 不会冻结浏览器？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-24T22:56:26.663

如果您只需要进行计算并且在长时间运行的计算过程中不需要访问 DOM，那么您有两种选择：

1.  您可以将计算分解为多个部分，并在`setTimeout()`. 在每次`setTimeout()`调用时，浏览器都可以自由地处理其他事件，并使页面保持活跃和响应。当您完成计算的最后一部分时，您可以执行结果。
2.  您可以在现代浏览器中使用网络工作者在后台运行计算。在 webworker 中完成计算后，它会向主线程发送一条消息，然后您可以使用结果更新 DOM。

这是一个相关的答案，也显示了一个示例：[Best way to iterate over an array without blocking the UI](https://stackoverflow.com/questions/10344498/best-way-to-iterate-over-an-array-without-blocking-the-ui/10344560#10344560)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-18T20:35:54.400

让我通过一个具体的精简示例来详细说明@jfriend00 的答案。这是一个长时间运行的 JavaScript 进程，可以通过单击按钮来启动。一旦它运行，它会冻结浏览器。该过程由一个长循环组成，该循环重复一些工作负载，其中一次迭代花费的时间相对较短。

由于浏览器冻结，调试这样的脚本并不容易。避免浏览器冻结的一种替代方法是使用网络工作者。这种方法的缺点是 web worker 本身的可调试性很差：不支持像 Firebug 这样的工具。

```
<html>
<head>
    <script>
        var Process = function(start) {
            this.start = start;
        }

        Process.prototype.run = function(stop) {
            // Long-running loop
            for (var i = this.start; i < stop; i++) {
                // Inside the loop there is some workload which 
                // is the code that is to be debugged
                console.log(i);
            }
        }

        var p = new Process(100);

        window.onload = function() {
            document.getElementById("start").onclick = function() {
                p.run(1000000000);
            }
        }
    </script>
</head>
<body>
    <input id="start" type="button" value="Start" />
</body>
</html> 
```

使用 Queue 数据结构（例如[http://code.stephenmorley.org/javascript/queues/](http://code.stephenmorley.org/javascript/queues/)）、间隔计时器和对原始流程的控制流的一些小修改，可以构建一个不会冻结浏览器的 GUI ，使过程完全可调试，甚至允许其他功能，如步进、暂停和停止。

这是怎么回事：

```
<html>
<head>
    <script src="http://code.stephenmorley.org/javascript/queues/Queue.js"></script>
    <script>
        // The GUI controlling process execution
        var Gui = function(start) {
            this.timer = null; // timer to check for inputs and/or commands for the process
            this.carryOn = false; // used to start/pause/stop process execution
            this.cmdQueue = new Queue(); // data structure that holds the commands 
            this.p = null; // process instance
            this.start = start;
            this.i = start; // input to the modified process 
        }

        Gui.prototype = {
            /**
             * Receives a command and initiates the corresponding action 
             */
            executeCmd: function(cmd) {
                switch (cmd.action) {
                    case "initialize":
                        this.p = new Process(this);
                        break;
                    case "process":
                        this.p.run(cmd.i);
                        break;
                }
            },

            /*
             * Places next command into the command queue
             */
            nextInput: function() {
                this.cmdQueue.enqueue({
                    action: "process",
                    i: this.i++
                });
            }
        }

        // The modified loop-like process
        var Process = function(gui) {
            this.gui = gui;
        }

        Process.prototype.run = function(i) {
            // The workload from the original process above
            console.log(i);

            // The loop itself is controlled by the GUI
            if (this.gui.carryOn) {
                this.gui.nextInput();
            }
        }

        // Event handlers for GUI interaction
        window.onload = function() {

            var gui = new Gui(100);

            document.getElementById("init").onclick = function() {
                gui.cmdQueue.enqueue({ // first command will instantiate the process
                    action: "initialize"
                });

                // Periodically check the command queue for commands
                gui.timer = setInterval(function() {
                    if (gui.cmdQueue.peek() !== undefined) {
                        gui.executeCmd(gui.cmdQueue.dequeue());
                    }
                }, 4);
            }

            document.getElementById("step").onclick = function() {
                gui.carryOn = false; // execute just one step
                gui.nextInput();
            }

            document.getElementById("run").onclick = function() {
                gui.carryOn = true; // (restart) and execute until further notice
                gui.nextInput();
            }

            document.getElementById("pause").onclick = function() {
                gui.carryOn = false; // pause execution
            }

            document.getElementById("stop").onclick = function() {
                gui.carryOn = false; // stop execution and clean up 
                gui.i = gui.start;
                clearInterval(gui.timer)

                while (gui.cmdQueue.peek()) {
                    gui.cmdQueue.dequeue();
                }
            }
        }
    </script>
</head>
<body>
    <input id="init" type="button" value="Init" />
    <input id="step" type="button" value="Step" />
    <input id="run" type="button" value="Run" />
    <input id="pause" type="button" value="Pause" />
    <input id="stop" type="button" value="Stop" />
</body>
</html> 
```

虽然这种方法当然不适合人们能想到的所有长时间运行的脚本，但它肯定可以适应任何类似循环的场景。我正在使用它将[Numenta 的](http://numenta.org/) [HTM/CLA](https://github.com/nupic-community/htm.JavaScript)人工智能算法移植到浏览器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-24T22:57:55.997

有些浏览器只有一个线程来运行代码和更新 UI（换句话说，在计算完成之前，浏览器会显示为“冻结”）。您会想尝试以一种或另一种方式异步执行操作。

如果计算*真的*很贵，你可能想调用服务器，让服务器计算，计算完成后回调客户端。

如果计算*有点*昂贵，您可以尝试在客户端上分块进行。这实际上不是异步的（因为客户端*会*在执行每个块时阻塞），但目标是使块足够小，以至于阻塞不明显。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-09-19T08:05:14.720

```
 setTimeout(function() { ..code  }, 0); 
```

我推荐这个用于繁重的执行时间，也可以尝试添加加载 ajax

```
$(window).on("load", function (e) { }); // for jquery v3 
```

如果它在加载过程中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-29T08:32:47.550

我认为这应该可以解决您的问题，

```
function myClickOperation(){
    var btn_savebutton2 = document.querySelector("input[id*='savebutton2']");
    setTimeout(function () { btn_savebutton2.click() }, 1000);
} 
```

// 完整的 Html 内容

```
<html>
<script>
    function myClickOperation(){
        var btn_savebutton2 = document.querySelector("input[id*='savebutton2']");
        document.getElementById('savebutton1').disabled = true;
        setTimeout(function () { btn_savebutton2.click() }, 1000);
    }
    function testClick(){
        var idd = document.getElementById("myid");
        idd.innerHTML =idd.innerHTML +"<br/>" + new Date();
        if(true){
            setTimeout(function () { testClick() }, 1);
        }
    }

</script>
<body>
    <input type="button" id="savebutton1" onclick="myClickOperation()" value="Click me" />
    <input type="button" id="savebutton2" onclick="testClick()" value="Do not click this" />
    <input type="text"/>

    <input type="button" value="temp"/>
    <div style="height: 300px;overflow-y: scroll;" id="myid"/>
</body> 
```

# css - 流体图像 - 纵向/横向

> ID：13546498
> 
> 赞同：0
> 
> 时间：2012-11-24T22:54:57.613
> 
> 标签：css, image, height, fluid

我有一个简单的幻灯片（列表项），但是是纵向和横向图像的组合。我正在研究一个流体网格，所以一切基本上都是 100% 的。

我想知道是否有办法让所有图像保持相同的高度，但宽度保持真实的比例。所有图像在上传时都具有相同的高度 - 2000px。

请参阅此处的网站：http: [//goo.gl/BdFUj](http://goo.gl/BdFUj)

请参阅此处以获取所需的输出：[http ://d.pr/i/HJUH](http://d.pr/i/HJUH)

谢谢，R

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-24T23:02:38.307

简单的 CSS 声明；

```
img.gallery-image {  //substitute for the appropriate class, obviously
    height: 2000px;
    width: auto;
} 
```

就这么容易。

# ruby-on-rails - 依赖于控制器的条件模型验证

> ID：13546499
> 
> 赞同：0
> 
> 时间：2012-11-24T22:54:58.257
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model, controller

我有一个用户模型，其中存储用户地址等。创建帐户（user_sessions 控制器）时，我只想验证他们的姓名是否存在，地址是可选的。

当他们升级他们的帐户（升级控制器）时，我想验证是否输入了他们的完整地址。

是否有一种基于控制器进行条件验证的优雅方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:10:02.557

您是否尝试过创建一个继承旧模型的新模型。所以你可以有：

```
class User < ActiveRecord::Base
  attr_accessible :name, :address
  validates_presence_of :name
end

class UpgradedUser < User
  validates_precense_of :address
end 
```

由于它继承自`User`该类，因此`UpgradedUser`该类对地址和名称都有验证。而且这个解决方案仍然只使用一个数据库表。因为它们仍然是一个表，所以您必须添加一`:account_status`列或其他内容来确定帐户是否已升级。

在您的 upgrade_users 控制器中，您将有一个标准的更新方法：

```
class upgraded_users_controller   

  def update
    @upgraded_user = UpgradedUser.find params[:id]
    respond_to do |format|
      if @upgraded_user.update_attributes params[:user]
        format.html { redirect_to @upgraded_user }
      end
    end 
```

此方法将像以前一样访问同一个用户表`users_controller` ，但它只是通过`UpgradedUser`模型来访问，因此将在保存时检查验证器是否存在名称和地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T02:17:57.530

## 装饰器/实例扩展

您可以使用装饰器模式来完成此操作。实例扩展是另一种选择。因为我们使用的是 ruby​​，所以这里的实例扩展方式更有趣：

```
class User < ActiveRecord::Base
  validate :decorator_validations

  protected

  def decorator_validations
    # noop at this point
  end
end

module User::Upgrader

  def upgrade!
    # do whatever upgrade operation is needed
    save
  end

  protected

  def decorator_validations
    super
    self.errors.add(:address, 'needs to be provided') unless self.address.present?
  end
end 
```

在你的控制器中：

```
def upgrade
  @user = User.find(params[:id])
  @user.extend User::Upgrader
  if @user.upgrade!
    # success case
  else
    # failure case
  end
end 
```

## 命令模式

另一种方法是使用命令模式：

```
class UserUpgrader

 def initialize(user)
   @user = user
 end

 def call
   validate_upgrade_state
   return false if @user.errors.present?
   @user.update_attribute(:upgraded, true)
 end

 protected

 def validate_upgrade_state
   @user.errors.add(:address, 'must be present') unless @user.address.present?
 end
end 
```

在这种情况下，您的控制器将如下所示：

```
@user = User.find(params[:id])
if UserUpgrader.new(@user).call
 # success case
else
 # failure case
end 
```

这两种解决方案的好处是它们非常可测试。

# java - Java Applet 无法解析 Json

> ID：13546506
> 
> 赞同：1
> 
> 时间：2012-11-24T22:56:53.247
> 
> 标签：java, exception, applet, noclassdeffounderror, japplet

我正在用 Django 开发一个 Web 服务器，并在一个页面中嵌入了一个 Java Applet。

我必须在实例化时向这个小程序传递一个 JSon 数组。完全没有问题，我已经在 Eclipse 中对其进行了测试，没有任何错误或问题。

当我把它放在网页上时，大问题就出现了。

首先我尝试使用[Jackson](http://jackson.codehaus.org/)，这是页面上的代码：

```
 <applet name="mapGenerator"
            id="mapGenerator"  
            code="main.MapGenerator.class"
            archive="{{STATIC_URL}}jar/MapGenerator.jar, 
                            {{STATIC_URL}}jar/plugin.jar
                            {{STATIC_URL}}jar/jackson-annotations-2.1.1.jar,
                            {{STATIC_URL}}jar/jackson-core-2.1.1.jar,
                            {{STATIC_URL}}jar/jackson-databind-2.1.1.jar"
                     >
                    <param name=id value="{{building.id}}">
                    <param name=piani value='{{floors}}'>  
            MAYSCRIPT
    </applet> 
```

解析Json的Java代码：

```
 public static  Floor[] parse(String input, URL codebase) {

        ObjectMapper mapper = new ObjectMapper(); // can reuse, share globally
    BaseFloor[] bfloors=null;

        try {
              bfloors = mapper.readValue(input, BaseFloor[].class);
    } catch (JsonParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (JsonMappingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
          for (int i=0; i < bfloors.length; i++) {

        Floor f = new Floor(bfloors[i]);
        f.setCodeBase(codebase);
        floors[i] = f;
    }
    return floors;
} 
```

这是我尝试在网页中使用 Java 控制台时遇到的错误：

```
 Exception in thread "thread applet-main.MapGenerator.class-1" java.lang.NoClassDefFoundError: com/fasterxml/jackson/annotation/JsonAutoDetect
at com.fasterxml.jackson.databind.introspect.VisibilityChecker$Std.<clinit>(VisibilityChecker.java:172)
at com.fasterxml.jackson.databind.ObjectMapper.<clinit>(ObjectMapper.java:195)
at objects.Floor.parse(Floor.java:37)
at main.MapGenerator.loadParameters(MapGenerator.java:67)
at main.MapGenerator.start(MapGenerator.java:31)
at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Plugin2Manager.java:1698)
at java.lang.Thread.run(Thread.java:662)
  Caused by: java.lang.ClassNotFoundException: com.fasterxml.jackson.annotation.JsonAutoDetect
at sun.plugin2.applet.Applet2ClassLoader.findClass(Applet2ClassLoader.java:252)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Plugin2ClassLoader.java:250)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Plugin2ClassLoader.java:180)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Plugin2ClassLoader.java:161)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
... 7 more 
```

所以我遇到了一些奇怪的实现问题，我尝试使用[google-gson](http://code.google.com/p/google-gson/)

和以前一样，这里是网页代码：

```
 <applet name="mapGenerator"
            id="mapGenerator"  
            code="main.MapGenerator.class"
            archive="{{STATIC_URL}}jar/MapGenerator.jar, 
                            {{STATIC_URL}}jar/gson-2.2.2.jar,
                            {{STATIC_URL}}jar/plugin.jar
                     >
                    <param name=id value="{{building.id}}">
                    <param name=piani value='{{floors}}'>  
            MAYSCRIPT
    </applet> 
```

和Java代码：

```
 public static  Floor[] parse(String input, URL codebase) {

    Gson gson = new Gson();

    BaseFloor[] bfloors = gson.fromJson(input, BaseFloor[].class);

    Floor[] floors = new Floor[bfloors.length];

    for (int i=0; i < bfloors.length; i++) {

        Floor f = new Floor(bfloors[i]);
        f.setCodeBase(codebase);
        floors[i] = f;
    }
    return floors;
} 
```

我在 Eclipse 上运行小程序时没有收到任何错误，但是当我在网页上进行测试时……我收到另一个错误：

```
 java.security.AccessControlException: access denied (java.lang.reflect.ReflectPermission suppressAccessChecks)
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)
at java.security.AccessController.checkPermission(AccessController.java:546)
at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)
at java.lang.reflect.AccessibleObject.setAccessible(AccessibleObject.java:107)
at com.google.gson.internal.ConstructorConstructor.newDefaultConstructor(ConstructorConstructor.java:84)
at com.google.gson.internal.ConstructorConstructor.get(ConstructorConstructor.java:66)
at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:71)
at com.google.gson.Gson.getAdapter(Gson.java:353)
at com.google.gson.internal.bind.ArrayTypeAdapter$1.create(ArrayTypeAdapter.java:48)
at com.google.gson.Gson.getAdapter(Gson.java:353)
at com.google.gson.Gson.fromJson(Gson.java:794)
at com.google.gson.Gson.fromJson(Gson.java:761)
at com.google.gson.Gson.fromJson(Gson.java:710)
at com.google.gson.Gson.fromJson(Gson.java:682)
at objects.Floor.parse(Floor.java:33)
at main.MapGenerator.loadParameters(MapGenerator.java:67)
at main.MapGenerator.start(MapGenerator.java:31)
at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Plugin2Manager.java:1698)
at java.lang.Thread.run(Thread.java:662)
  Eccezione: java.security.AccessControlException: access denied (java.lang.reflect.ReflectPermission suppressAccessChecks) 
```

这是我试图解析的 BaseFloor 类，它位于静态函数的同一个包中**：**

```
 package objects;

  public class BaseFloor {

      public int numero_di_piano;
      public String link;
      public String bearing;

      public float getBearing() {
    return Float.parseFloat(bearing);
      }

      public int getFloor() {
    return numero_di_piano;
      }

      public String getLink() {
    return link;
      }

      public String toString() {
    return numero_di_piano + " " + bearing + " " + link;
      }
  } 
```

这是我传递给小程序的 JSON：

```
 [{"bearing": "354.00", "link": "/media/floors/Foto_del_63333991-02-2455618_alle_17_35_6.jpg", "numero_di_piano": 0}, {"bearing": "354.00", "link": "/media/floors/IMG_20111009_171138_7.jpg", "numero_di_piano": 1}] 
```

我很好奇：这是我实现代码的问题，还是安全问题，因为我的小程序没有签名，所以无法使用反射？

如果您需要什么，请随意询问。

先感谢您。

**编辑**

我已经尝试了你建议的@Nikita，并且错误改变了！

```
 java.security.AccessControlException: access denied (java.lang.RuntimePermission accessDeclaredMembers)
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)
at java.security.AccessController.checkPermission(AccessController.java:546)
at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)
at java.lang.SecurityManager.checkMemberAccess(SecurityManager.java:1662)
at java.lang.Class.checkMemberAccess(Class.java:2157)
at java.lang.Class.getDeclaredMethods(Class.java:1790)
at com.fasterxml.jackson.databind.introspect.AnnotatedClass._addMemberMethods(AnnotatedClass.java:593)
at com.fasterxml.jackson.databind.introspect.AnnotatedClass.resolveMemberMethods(AnnotatedClass.java:421)
at com.fasterxml.jackson.databind.introspect.AnnotatedClass.memberMethods(AnnotatedClass.java:243)
at com.fasterxml.jackson.databind.introspect.POJOPropertiesCollector._addMethods(POJOPropertiesCollector.java:442)
at com.fasterxml.jackson.databind.introspect.POJOPropertiesCollector.collect(POJOPropertiesCollector.java:232)
at com.fasterxml.jackson.databind.introspect.BasicClassIntrospector.collectProperties(BasicClassIntrospector.java:142)
at com.fasterxml.jackson.databind.introspect.BasicClassIntrospector.forDeserialization(BasicClassIntrospector.java:81)
at com.fasterxml.jackson.databind.introspect.BasicClassIntrospector.forDeserialization(BasicClassIntrospector.java:11)
at com.fasterxml.jackson.databind.DeserializationConfig.introspect(DeserializationConfig.java:507)
at com.fasterxml.jackson.databind.deser.DeserializerCache._createDeserializer(DeserializerCache.java:326)
at com.fasterxml.jackson.databind.deser.DeserializerCache._createAndCache2(DeserializerCache.java:264)
at com.fasterxml.jackson.databind.deser.DeserializerCache._createAndCacheValueDeserializer(DeserializerCache.java:244)
at com.fasterxml.jackson.databind.deser.DeserializerCache.findValueDeserializer(DeserializerCache.java:143)
at com.fasterxml.jackson.databind.DeserializationContext.findRootValueDeserializer(DeserializationContext.java:342)
at com.fasterxml.jackson.databind.ObjectMapper._findRootDeserializer(ObjectMapper.java:2898)
at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:2792)
at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:1942)
at objects.Floor.parse(Floor.java:40)
at main.MapGenerator.loadParameters(MapGenerator.java:67)
at main.MapGenerator.start(MapGenerator.java:31)
at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Plugin2Manager.java:1698)
at java.lang.Thread.run(Thread.java:662)
  Eccezione: java.security.AccessControlException: access denied (java.lang.RuntimePermission accessDeclaredMembers) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:08:22.310

尝试`{{STATIC_URL}}jar/plugin.jar`在页面中插入逗号。可能是 java 插件因为这个而忽略了 jackson-annotations.jar 并且你得到`NoClassDefFoundError`.
这是一个类似的问题：[NoClassDefFoundError JsonAutoDetect while parsing JSON object](https://stackoverflow.com/questions/10094300/webapp-noclassdeffound-jsonautodetect) and missing`jackson-annotations`导致问题。

# objective-c - 术语“数据库播种”是什么意思？

> ID：13546519
> 
> 赞同：12
> 
> 时间：2012-11-24T22:59:20.933
> 
> 标签：objective-c, database

什么是 Core Data 上下文中的数据库播种？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-25T02:57:19.923

在核心数据播种的上下文中，仅意味着使用预先填充了默认数据的持久存储来交付您的应用程序。在 Apple 的食谱示例中，种子数据是他们在作为项目一部分的 sqlite 数据库中拥有的食谱数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-28T17:20:59.560

[http://en.wikipedia.org/wiki/Database_seeding](http://en.wikipedia.org/wiki/Database_seeding)

数据库播种是使用数据对数据库进行初始播种。

这通常是在应用程序初始设置时执行的自动化过程。

数据可以是虚拟数据，也可以是初始管理员账户等必要数据。

# smlnj - 如何在 sml/nj 中将单个 char 更改为 int

> ID：13546520
> 
> 赞同：4
> 
> 时间：2012-11-24T22:59:26.517
> 
> 标签：smlnj

我只是想将 char 更改为 int 并返回 int。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T16:50:44.187

您可能想要`Char.ord`（[基础库页面](http://www.standardml.org/Basis/char.html#SIG%3aCHAR.ord%3aVAL)）。

例如，`Char.ord #"a"`

# c - 将矩形阵列旋转 45 度

> ID：13546521
> 
> 赞同：3
> 
> 时间：2012-11-24T22:59:30.917
> 
> 标签：c, arrays, algorithm

认为：

```
2D array:  abcdef
           ghijkl
           mnopqr 
```

存储在长度宽度 * 高度的简单字符串中，因此，我们称之为 arr。

```
arr = abcdefghijklmnopqr
width = 6
height = strlen ( arr ) / width 
```

目标是将此数组旋转 45 度 ( PI/4 ) 并获得以下结果：

```
arr = abgchmdinejofkplqr
width = 3
height = 8
converted to 2D array:  a..
                        bg.
                        chm
                        din
                        ejo
                        fkp
                        .lq
                        ..r 
```

我花了几个小时试图弄清楚如何进行这种转换并提出了一些半功能解决方案，但我无法让它完全正常工作。你能描述/写一个算法来解决这个问题吗？最好在 C.

谢谢你的帮助

编辑：这是我已经尝试过的编辑
2：45度旋转的目的是将对角线变成线，以便可以使用strstr搜索它们。

```
// this is 90 degree rotation. pretty simple
for ( i = 0; i < width * height; i++ ) {
  if ( i != 0 && !(i % height) ) row++;
  fieldVertical[i] = field[( ( i % height ) * width ) + row];
}   

// but I just can't get my head over rotating it 45 degrees. 
// this is what I've tried. It works untile 'border' is near the first edge.

row = 0;
int border = 1, rowMax = 0, col = 0; // Note that the array may be longer
// than wider and vice versa. In that case rowMax should be called colMax.

for ( i = 0; i < width * height; ) { 
  for ( j = 0; j < border; j++, i++ ) {
    fieldCClockwise[row * width + col] = field[i];
    col--;
    row++;
  }

  col = border;
  row = 0;
  border++;
} 
```

我的代码中的“边界”是一个虚构的边界。在源代码中，它是分隔对角线的对角线。结果，它将是每行之间的水平线。

```
1   2   3 / 4   5
6   7 / 8   9   10
11 /12  13  14  15 
```

那些斜线是我们的分界线。该算法应该非常简单，只需读取 riagonals：首先是数字 1，然后是 2，然后是 6，然后是 3，然后是 7，然后是 11，然后是 4，依此类推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:47:19.460

我查看了[http://en.wikipedia.org/wiki/Shear_mapping](http://en.wikipedia.org/wiki/Shear_mapping)以获取灵感并生成了这个 python 代码：

```
a = [['a', 'b', 'c', 'd', 'e', 'f'],
     ['g', 'h', 'i', 'j', 'k', 'l'],
     ['m', 'n', 'o', 'p', 'q', 'r']]

m = 1 # 1/m = slope

def shear_45_ccw(array):
    ret = []
    for i in range(len(array)):
        ret.append([0] * 8)
        for j in range(len(array[i])):
            ret[i][int(i + m * j)] = array[i][j]
    return ret

print(shear_45_ccw(a)) 
```

产生：

```
[['a', 'b', 'c', 'd', 'e', 'f', 0, 0], 
 [0, 'g', 'h', 'i', 'j', 'k', 'l', 0], 
 [0, 0, 'm', 'n', 'o', 'p', 'q', 'r']] 
```

这就像你想要的。该算法希望是可读的，即使它在 python 中。它的肉是这样的：`ret[i][int(i + m * j)] = array[i][j]`。祝你好运！我在初始化数组时作弊；无论如何，你必须在 C 中以不同的方式处理它。

编辑：另外，我不知道为什么你的结果会被翻转等等：我相信你可以做出正确的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:15:07.710

我称之为对角线扫描，而不是旋转 45 度。

在您的示例中，对角线在左下方；我们可以枚举它们 1, 2, ...：

```
123456
234567
345678 
```

这将是外循环迭代的计数器。内部循环将运行 1、2 或 3 次迭代。为了从一个编号符号跳到另一个，`col--; row++;`像你一样做，或者添加`width-1`到一个线性索引：

```
....5\. (example)
...5..
..5... 
```

代码（未经测试）：

```
char *field;
int width = 6;
int height = 3;
char *field45 = malloc(width * height);
int diag_x = 0, diag_y = 0; // coordinate at which the diagonal starts
int x, y; // coordinate of the symbol to output
while (diag_y < height)
{
    x = diag_x; y = diag_y;
    while (x >= 0 && y < height) // repeat until out of field
    {
        *field45++ = field[y * width + x]; // output current symbol
        --x; ++y; // go to next symbol on the diagonal
    }
    // Now go to next diagonal - either right or down, whatever is possible
    if (diag_x == width - 1)
        ++diag_y;
    else
        ++diag_x;
} 
```

如果您想在另一个方向“旋转”，您可能需要更改`++`为`--`围绕代码，并且可能将循环中的边界检查更改为相反。

此外，您可以`(x,y)`只用一个索引替换坐标（用 替换`++y`）`index+=width`；我`(x,y)`为了清楚起见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-19T08:07:12.790

我想通过上面的帮助并通过一个例子来解决这个问题：

```
import pandas as pd
import numpy as np
bd = np.matrix([[44., -1., 40., 42., 40., 39., 37., 36., -1.],
                [42., -1., 43., 42., 39., 39., 41., 40., 36.],
                [37., 37., 37., 35., 38., 37., 37., 33., 34.],
                [35., 38., -1., 35., 37., 36., 36., 35., -1.],
                [36., 35., 36., 35., 34., 33., 32., 29., 28.],
                [38., 37., 35., -1., 30., -1., 29., 30., 32.]])
def rotate45(array):
    rot = []
    for i in range(len(array)):
        rot.append([0] * (len(array)+len(array[0])-1))
        for j in range(len(array[i])):
            rot[i][int(i + j)] = array[i][j]
    return rot

df_bd = pd.DataFrame(data=np.matrix(rotate45(bd.transpose().tolist())))
df_bd = df_bd.transpose()
print df_bd
```

其中输出如下：

```
44   0   0   0   0   0   0   0   0
42  -1   0   0   0   0   0   0   0
37  -1  40   0   0   0   0   0   0
35  37  43  42   0   0   0   0   0
36  38  37  42  40   0   0   0   0
38  35  -1  35  39  39   0   0   0
0   37  36  35  38  39  37   0   0
0    0  35  35  37  37  41  36   0
0    0   0  -1  34  36  37  40  -1
0    0   0   0  30  33  36  33  36
0    0   0   0   0  -1  32  35  34
0    0   0   0   0   0  29  29  -1
0    0   0   0   0   0   0  30  28
0    0   0   0   0   0   0   0  32
```

# java - 在 Eclipse 中运行 web 项目时出错

> ID：13546523
> 
> 赞同：0
> 
> 时间：2012-11-24T22:59:40.670
> 
> 标签：java, servlets

我是 servlet 的新手。我在 Eclipse 中创建了一个动态 Web 项目。我的项目中有以下文件

home.html validateServlet.java

我已将经过验证的 servlet 定义为 home.html 表单中的操作。但是，当我运行它时，我得到 http 状态 404。下面是我的项目的层次结构

```
Project
Java Resources
   src
     com.servlets
    ValidateServlet.java
build
WebContent
    META-INF
    WEB-INF
        web.xml
    hello.html 
```

我的 web.xml 的内容如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web- app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
<display-name>Website</display-name>
<servlet>
<description></description>
<display-name>ValidateServlet</display-name>
<servlet-name>validate</servlet-name>
<servlet-class>com.oracle.coen235.servlets.ValidateServlet</servlet-class>
</servlet>
</web-app> 
```

在我的 hello.html 中，动作被指定为

可能是什么问题？我想我无法为我的 servlet 生成类文件。谁能指导我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:02:27.517

你好像把事情搞混了。

```
<servlet-class>com.oracle.coen235.servlets.Validate</servlet-class> 
```

应该列出完整的类名。我没有看到您的包裹名称。

它应该是

```
<servlet-class>com.oracle.coen235.servlets.ValidateServlet</servlet-class> 
```

或者你的包名是什么。

我们是否将您的 servlet 映射到路径？它应该是这样的：

```
 <servlet-mapping>
      <servlet-name>validate</servlet-name>
      <url-pattern>/validate</url-pattern>
 </servlet-mapping> 
```

或直接在您的 servlet 类中的注释。

# android - 将数据从活动传递到列表活动或列表视图

> ID：13546532
> 
> 赞同：1
> 
> 时间：2012-11-24T23:00:47.057
> 
> 标签：android, android-intent, android-listview

需要帮助将数据从活动传递到 Android 应用程序的列表活动或列表视图。我在将数据传递到列表视图时遇到问题。

应用程序所做的是来自 addact 类，用户可以输入要做的事情，并且在 viewact 类中，这将显示用户在 listview 中添加的活动

```
public class addact extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.newact);
        Button btn1 = (Button)findViewById(R.id.btnsave);
       final EditText et1 = (EditText)findViewById(R.id.etactivity);
      btn1.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View arg0) {

            Intent it = new Intent(addact.this, viewact.class);
            it.putExtra("thekey", et1.getText().toString());
            startActivity(it);
        }
    });
    }
}

public class viewact extends ListActivity {

    String addToDo =getIntent().getExtras().getString("thekey");
     String[] toDoAct = new String[] {addToDo };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.viewact);

        setListAdapter(new ArrayAdapter<String>(this, R.layout.viewact,toDoAct));

        ListView listView = getListView();

        listView.setTextFilterEnabled(true);

        listView.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {

                for (int i=0; i < 2; i++)
                {
                    Toast.makeText(getApplicationContext(),
                            ((TextView) view).getText(), Toast.LENGTH_LONG).show();
                }

            }
        });

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:04:57.160

在内部之前您无法访问您的 Intent，`onCreate()`并且您应该执行一些检查以确保您的应用在数据不存在时不会崩溃：

```
String addToDo = "";
String[] toDoAct;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.viewact);

    Intent intent = getIntent();
    if(intent != null) {
        addToDo = intent.getStringExtra("thekey", "");
    }
    toDoAct = new String[] { addToDo }; 
```

# ruby-on-rails - 保存后，counter_cache 未在模型上更新

> ID：13546534
> 
> 赞同：3
> 
> 时间：2012-11-24T23:00:53.237
> 
> 标签：ruby-on-rails, counter-cache

我正在使用 a`counter_cache`让 MySQL 为我做一些簿记：

```
class Container
  has_many :items
end

class Item
  belongs_to :container, :counter_cache => true
end 
```

现在，如果我这样做：

```
container = Container.find(57)
item = Item.new
item.container = container
item.save 
```

`INSERT`在 SQL 日志中，后面会有类似的内容：

```
UPDATE `containers` SET `items_count` = COALESCE(`items_count`, 0) + 1
    WHERE `containers`.`id` = 57 
```

这是我期望它做的。然而，这`container[:items_count]`将是陈旧的！

...除非我`container.reload`拿起更新的价值。在我看来，这有点违背了使用 :counter_cache 来支持自定义构建的部分目的，特别是因为`reload`在我尝试访问该`items_count`属性之前我可能实际上并不想要一个。（由于域逻辑的性质，我的模型代码量很大，所以有时我必须在一个控制器调用中保存和创建多个东西。）

我知道我可以自己修改回调，但在我看来，这似乎是对简单功能的一个相当基本的期望。同样，如果我必须编写额外的代码以使其完全工作，那么实现自定义计数器可能会更容易。

我在做什么/假设错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T01:13:43.780

您不应该期望项目计数器的值会在您的 Container 实例中自动更新。请记住，大多数 Rails 应用程序在多进程（通常是多服务器）配置中运行。如果一个进程添加了一个与另一个进程上的 Container 实例相关联的 Item，则计数器的值将变得陈旧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T11:13:09.203

您实际上并没有让容器知道该项目，这实际上是您在 container.reload 时所做的！它。你有没有尝试过：

```
container = Container.find(57)
item = container.items.create() 
```

这将使项目在容器的上下文中并为您建立这些关联。

# asp.net - Asp.net 是否可以将服务器控件存储在缓存中？

> ID：13546536
> 
> 赞同：0
> 
> 时间：2012-11-24T23:01:00.847
> 
> 标签：asp.net, web-controls

Asp.net 将服务器控件存储在缓存中是否可能/坏主意？

创建一个控件是不是一个坏主意，即：HtmlGenericControl，然后将其添加到 Page.Cache，然后在 OnInit() 上检索它并将其添加到页面控件集合中？

还是使用 ParseControl 更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:06:58.117

这是相当危险的。每次调用页面时，您都会获得它的一个实例。此实例将包含设计器放入的所有控件的实例。如果将控件的实例存储在缓存中，则可能会遇到一个页面的多个实例将共享该控件的实例的情况。您需要小心进入此控制数据部分的内容，因为它也将被共享

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:07:38.077

由于控件特定于页面（例如具有页面属性），因此您不能将其存储在缓存中并在多个页面之间共享。也许您可能会改为查看[片段缓存。](http://support.microsoft.com/kb/308378)

# maven - Maven：发布插件看不到我的 在

> ID：13546539
> 
> 赞同：6
> 
> 时间：2012-11-24T23:01:38.893
> 
> 标签：maven, deployment, repository, maven-deploy-plugin

为了让 Maven “部署”到一个目录，我使用这个：

```
<distributionManagement>
    <downloadUrl>http://code.google.com/p/junitdiff/downloads/list</downloadUrl>
    <repository>
        <id>local-hack-repo</id>
        <name>LocalDir</name>
        <url>file://${project.basedir}/dist-maven</url>
    </repository>
    <snapshotRepository>
        <id>jboss-snapshots-repository</id>
        <name>JBoss Snapshots Repository</name>
        <!--
        <url>https://repository.jboss.org/nexus/content/repositories/snapshots</url>
        -->
        <url>file://${project.basedir}/dist-maven</url>
    </snapshotRepository>
</distributionManagement> 
```

这出现在有效的 pom 中。

```
...
<distributionManagement>
<repository>
  <id>local-hack-repo</id>
  <name>LocalDir</name>
  <url>file:///home/ondra/work/TOOLS/JUnitDiff/github/dist-maven</url>
</repository>
<snapshotRepository>
  <id>jboss-snapshots-repository</id>
  <name>JBoss Snapshots Repository</name>
  <url>file:///home/ondra/work/TOOLS/JUnitDiff/github/dist-maven</url>
</snapshotRepository>
<downloadUrl>http://code.google.com/p/junitdiff/downloads/list</downloadUrl>
</distributionManagement> 
```

但是，Maven 坚持认为它不存在：

```
[INFO] [ERROR] Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy (default-deploy) on project JUnitDiff: Deployment failed: repository element was not specified in the POM inside distributionManagement element or in -DaltDeploymentRepository=id::layout::url parameter -> [Help 1]
[INFO] org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy (default-deploy) on project JUnitDiff: Deployment failed: repository element was not specified in the POM inside distributionManagement element or in -DaltDeploymentRepository=id::layout::url parameter
...
[INFO] Caused by: org.apache.maven.plugin.MojoExecutionException: Deployment failed: repository element was not specified in the POM inside distributionManagement element or in -DaltDeploymentRepository=id::layout::url parameter
[INFO]  at org.apache.maven.plugin.deploy.DeployMojo.getDeploymentRepository(DeployMojo.java:235)
[INFO]  at org.apache.maven.plugin.deploy.DeployMojo.execute(DeployMojo.java:118)
[INFO]  at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
[INFO]  at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
[INFO]  ... 19 more 
```

我通过 maven-release-plugin 使用它。

*更新：*这 ^^^ 似乎是关键部分 -`mvn deploy`工作正常。

相关：[http ://www.java-tutorial.ch/maven/maven-release](http://www.java-tutorial.ch/maven/maven-release)

怎么了？

Maven 3.0.4。要添加的 Pom。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-26T13:33:35.737

由于 maven-release-plugin 不仅适用于本地文件，还适用于版本控制中的文件，看起来它实际使用的文件缺少`<distributionManagement>`标签。

# javascript - Assign different colors to individual array elements

> ID：13546541
> 
> 赞同：0
> 
> 时间：2012-11-24T23:02:06.827
> 
> 标签：javascript, jquery

Say I have the array, arr1\. I want to print this array (i.e. just display the numbers) but, I want to color the numbers based on their values. If arr1[i]<15, green, if arr1[i]>20, red, else orange. Something to this effect.

```
var arr1 = [ 5,10,13,19,21,25,22,18,15,13,11,12,15,20,18,17,16,18,23,25,25,22,18,15,13,11,12,15,20,18]; 
```

Here is what I tried doing:

```
 for(var i=0; i<arr1.length;i++){
            if(arr1[i]<15){
                var temp = $(this).css("color","green");
                $this.text(temp);
            } else if(arr1[i]>20){
                var temp = $(this).css("color","red");
                $this.text(temp);
            } else {
                var temp = $(this).css("color","orange");
                $this.text(temp);
            }

        } 
```

I tried changing the css property of individual elements and them adding them to the div, but it did not work for me.

Can someone suggest how should I go about doing this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:06:59.350

I'd suggest:

```
var arr1 = [5, 10, 13, 19, 21, 25, 22, 18, 15, 13, 11, 12, 15, 20, 18, 17, 16, 18, 23, 25, 25, 22, 18, 15, 13, 11, 12, 15, 20, 18],
    target = document.getElementById('test');

for (var i = 0; i < arr1.length; i++) {
    var elem = document.createElement('span'),
        text = document.createTextNode(arr1[i]);
    elem.appendChild(text);
    if (arr1[i] < 15) {
        elem.style.color = 'green'
    } else if (arr1[i] > 20) {
        elem.style.color = 'red'
    } else {
        elem.style.color = 'orange'
    }
    target.appendChild(elem);
}​ 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/KRduL/)

I'm using plain JavaScript because I couldn't see what `$(this)` was referring to, and it seemed easier to simply use a known variable to demonstrate.

And the reason I'm using a `span` to contain the text that's being assessed is simply because a `textNode` can't be styled directly, only an *element* can have a `style` attribute.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T23:04:26.207

You can't set css with jQuery directly on text nodes. It has to be on an element containing the text.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T23:07:54.043

Wrap a `<span>` around the text and color that instead..

```
for(var i=0; i<arr1.length;i++){
    var value = arr1[i],
        element = $('<span/>',{'text':value}),
        color = '';

    if(value<15){
        color = 'green';
    } else if(value>20){
        color = 'red';
    } else {
        color = 'orange';
    }

    $this.append( element.css({'color':color}) );
} 
```

Demo at [http://jsfiddle.net/gaby/6w7xL/](http://jsfiddle.net/gaby/6w7xL/)

# c++ - 基类具有抽象虚函数的派生类的对象分配问题

> ID：13546542
> 
> 赞同：-1
> 
> 时间：2012-11-24T23:02:23.097
> 
> 标签：c++, inheritance, virtual

我试图让这个基于僵尸/人类代理的模拟运行，但是我遇到了这些具有父类“Creature”的派生类（人类和僵尸）的问题。我在“Creature”中声明了 3 个虚函数，所有这三个虚函数都在“Human”和“Zombie”中重新声明和定义。但是由于某种原因，当我让我的程序调用“new”来为 Human 或 Zombie 类型的对象分配内存时，它抱怨虚函数是抽象的。这是代码：

标题：

```
class Creature
{          
public:
      virtual void Attack(Grid G) =0;
      virtual void AttackCreature(Grid G, int attackdirection) =0;
      virtual void Breed(Grid G) =0;
      virtual ~Creature() {}          
      void Die();
      void Move(Grid G);
      int DecideSquare(Grid G);
      void MoveTo(Grid G, int dir);           
};

class Human : public Creature 
{
public:          
      void Attack(Grid G);
      void AttackCreature(Grid G, int attackdirection);
      void Breed(Grid G); //will breed after x steps and next to human          
      int DecideAttack(Grid G);
};

class Zombie : public Creature
{
   public:
      void Attack(Grid G); 
      void AttackCreature(Grid G, int attackdirection);
      void Breed(Grid G) {} //does nothing  
      int DecideAttack(Grid G);
}; 
```

cp:

```
void Creature::Move(Grid G) {...}
int Creature::DecideSquare(Grid G) {...}
void Creature::MoveTo(Grid G, int dir) {...}
void Creature::Die() {...}
void Human::Breed(Grid G) {...}   
int Human::DecideAttack(Grid G) {...}
void Human::AttackCreature(Grid G, int attackdirection) {...}
int Zombie::DecideAttack(Grid G) {...}
void Zombie::AttackCreature(Grid G, int attackdirection) {...}
void Zombie::Attack(Grid G) {...} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:05:13.650

在`Creature`：

```
virtual void Breed() =0; 
```

在`Human`：

```
void Breed(Grid G); 
```

这些是不同的功能；后者不会覆盖前者。使纯虚函数`Creature`采用适当的参数。

对于`Attack()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T19:11:38.890

声明了一个纯虚函数：`virtual void Creature::Attack(Grid G)`但没有实现派生类`Human`，即没有`void Human::Attack(Grid G)`定义方法，这就是我收到`vtable`错误的原因。它找不到我承诺的功能的源代码。坏我！

# macos - GitHub（Mac 应用程序）- 提交不可见

> ID：13546547
> 
> 赞同：0
> 
> 时间：2012-11-24T23:03:44.727
> 
> 标签：macos, github, commit

我最近刚刚安装了 github mac 应用程序，并尝试使用 Synchronize 按钮将一些现有提交推送到分支。我使用 SSH 密钥进行了身份验证，应用程序没有抱怨，而且似乎可以正常工作。但是，在检查 github.com 上的远程存储库时，我似乎无法在任何地方找到我的提交，而不是在分支或单个文件的历史记录中。就好像我什么都没做一样。

但是，在 GitHub 应用程序中，我可以单击“在 github 上查看”按钮，它会检查提交并正确显示差异等，就像我在网站上导航到它们一样。

有人知道为什么会这样吗？如果这是一个微不足道的问题，请提前道歉！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:06:44.160

我不确定我是否理解您的问题，但您是否先提交然后使用同步按钮？

# drupal - 在 Drupal 7 自定义表单元素中选择列表

> ID：13546549
> 
> 赞同：0
> 
> 时间：2012-11-24T23:03:45.177
> 
> 标签：drupal, drupal-7, drupal-fapi, drupal-forms

我在一个模块中创建了几个自定义元素，它们非常适合将多个控件分组到一个表单字段中。

但是，我现在需要添加一个包含下拉列表的选项。这个想法是有一个国家代码的下拉列表和一个电话号码的文本字段。

在提交表单之前它显示正确并且看起来不错，这导致错误“检测到非法选择。请联系站点管理员。” 这似乎表明 Drupal 没有将选项识别为选择控件的一部分。

这是我的代码：

```
function my_module_element_info() {
  $types = array(
    'phone' => array(
      '#input' => TRUE,
      '#process' => array('my_module_phone_process'),
      '#element_validate' => array('my_module_phone_validate'),
      '#autocomplete_path' => FALSE,
      '#theme_wrappers' => array('my_module_inline_form_element'),
    ),
  );
  return $types;
}

function my_module_phone_process($element, &$form_state, $complete_form) {
  $element['#tree'] = TRUE;

  $element['prefix'] = array(
    '#type' => 'select',
    '#value' => $element['#value']['prefix'] ,
    '#options' => $element['#options'],
    '#required' => $element['#required'],
  );
  $element['number'] = array(
    '#type' => 'textfield',
    '#size' => 20,
    '#maxlength' => 40,
    '#value' => $element['#value']['number'],
    '#required' => $element['#required'],
  );
  if (isset($element['#attributes'])) {
    $element['prefix']['#attributes'] = $element['#attributes'];
    $element['number']['#attributes'] = $element['#attributes'];
  }
  $element['prefix']['#attributes']['class'][] = 'form-phone-prefix';
  $element['number']['#attributes']['class'][] = 'form-phone-number';
  if (isset($element['#ajax'])) {
    $element['prefix']['#ajax'] = $element['#ajax'];
    $element['number']['#ajax'] = $element['#ajax'];
  }

  return $element;
}

function my_module_phone_validate($element) {
  if (!preg_match('/^[0-9 ]+$/', $element['#value']['number'])) {
    form_error($element['number'], t('Phone number may contain only digits and spaces.'));
  }
  return $element;
} 
```

任何帮助得到这个工作将不胜感激。

感谢您的关注。

詹姆士

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T00:00:59.817

这个问题被搁置了一段时间，但我本周又回到了它。

我想我现在明白了错误的原因。如果一个元素有一个“#options”属性，那么它应该表现得像一个选择控件，并且应该提交其中一个选项。由于字段本身是其他控件的容器，因此没有直接输入，因此没有与“#options”中的条目匹配的发布值，因此 Drupal 将其标记为无效的表单提交。

经过大量的反复试验，我找到了一些非常简单的东西。“#options”用于填充子控件，但一旦填充，父控件不再需要它们。所以我为元素添加了一个“#after_build”函数，并用它来删除“#options”，它工作得很好。

```
function common_pricing_phone_after_build($element, &$form_state) {
    unset($element['#options']);
    return $element;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T07:20:20.440

您可以将以下属性添加到导致此错误的元素。

```
'#validated' => TRUE, 
```

# css - 到处都是相同的字体大小

> ID：13546558
> 
> 赞同：-1
> 
> 时间：2012-11-24T23:05:07.163
> 
> 标签：css, font-size

我希望到处都有统一的字体大小。现在不是这种情况，我不知道错误在哪里。

例如，第 1 页中的字体大小与[第 2](http://www.marmsoft.nl/website-bouwer/website-maken/)[页](http://www.marmsoft.nl/It-diensten/)中的不同。（我不需要针对 IE8 及更低版本。我的目标受众是 Mozilla Firefox、Opera、Chrome 和 Safari。）

顺便说一句，什么是`main copy`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:25:45.593

1.  `style.css`在任何文本编辑器中打开。
2.  找到所有`font-size`规则。
3.  全部删除。
4.  创建一个新规则：你想要的值`body { font-size: size; }`在哪里。`size`

# jquery - 模板中的骨干、引导模式未显示

> ID：13546560
> 
> 赞同：2
> 
> 时间：2012-11-24T23:05:42.763
> 
> 标签：jquery, ruby-on-rails-3, backbone.js, twitter-bootstrap, eco

我正在尝试为我的每个帖子生成一个模式，以便每个帖子都有一个包含帖子内容（以及最终评论）的模式。单击评论链接时，将出现模式。问题是我必须为每个帖子创建一个引导模式块，所以我决定在我的主干模板中这样做是最简单的。为什么这不起作用？

这是我的代码：

## 应用程序/资产/模板/帖子/index.jst.eco

```
<% for post in @posts.models: %>
<tbody><td>
<%= post.get('content') %>
</td></tbody>
<tr><td>
<a href="#<%= post.get('id') %>">Comment</a>
</td></tr>
<div class="modal" id="post-<%= post.get('id')%>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-header">
<%= post.get('content') %>
</div>
</div>
<% end %> 
```

## 应用程序/资产/javascripts/路由器/posts_router.js.coffee

```
class Voice.Routers.Posts extends Backbone.Router
        routes:
                '': 'index'
                ':id': 'show'
        initialize: ->
                @collection = new Voice.Collections.Posts()
                @collection.fetch()
        index: ->
                view = new Voice.Views.PostsIndex(collection: @collection)
                $('#container').html(view.render().el)
        show: (id) ->
                $("#post-#{id}").modal('show') 
```

js控制台中没有错误，模态似乎没有出现。每个帖子都有一个模态块，其 html id 字段等于“post-(the posts id)”

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T07:47:28.387

这听起来与许多关于 Bootstrap modals 和使用 Backbone 的 SO 问题非常相似。从 Dereck Bailey 处查看此解决方案，

[http://lostechies.com/derickbailey/2012/04/17/managing-a-modal-dialog-with-backbone-and-marionette/](http://lostechies.com/derickbailey/2012/04/17/managing-a-modal-dialog-with-backbone-and-marionette/)

```
// the template
<script id="modal-view-template" type="text/html">
  <div class="modal-header">
    <h2>This is a modal!</h2>
  </div>
  <div class="modal-body">
    <p>With some content in it!</p>
  </div>
  <div class="modal-footer">
    <button class="btn">cancel</button>
    <button class="btn-default">Ok</button>
  </div>
</script>

// the html has only one modal div
<div id="modal"></div>

// inside your show router function
var view = new MyView();
view.render();

var $modalEl = $("#modal");

$modalEl.html(view.el);
$modalEl.modal(); 
```

他的解释是，

> 人们在使用模态对话框时遇到的问题的核心是模态插件从 DOM 中删除了包装模态的 DOM 元素。它通常被添加到一些特殊的保存位置，模态插件可以保证在打开模态对话框之前元素不可见。我对此进行了过度概括，但许多模式对话框以这种方式或类似方式工作。
> 
> 这通常导致的问题是当 DOM 元素被模态对话框移动时，Backbone 视图将失去其事件处理。当模态对话框`el`从 DOM 中删除视图时，`events`配置会丢失，因为 DOM 元素已从 DOM 中移动或删除，并且 jQuery 必须释放事件。当`el`重新添加到 DOM 以将其显示为模式时，则`events`不会重新附加。

# c - 用c语言铸造

> ID：13546564
> 
> 赞同：-1
> 
> 时间：2012-11-24T23:06:37.053
> 
> 标签：c, casting

我现在了解套接字，我发现它非常混乱，因为转换结构。

该指南说在 sockaddr_in 中包含 8 位以将其与 sockaddr 进行比较。

所以我的问题是为什么要这样做我的意思是当你投射时你不会将 char 大小与 int 进行比较

例如你做

```
char a[1]='1';
int b=(int)a; 
```

并不是

```
char a[2]='1';//compare to size of int
int b=(int)a; 
```

那么它是如何工作的呢？

它的铸件结构不同吗？如果是，那为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:13:05.350

当传递指向结构的指针时，接收它的函数可能会尝试访问其所有字段中的任何一个。

如果您收到一个`struct something *`，您希望您可以读取`sizeof(struct something)`您收到的指针后面的任何字节。因此，不自己保留这些字节`struct`会使它们不兼容 - 每当函数尝试访问您尚未分配的字节时，它将访问非保留内存，因此它可能是分段错误，或者可能会破坏另一个的结构数据。

* * *

看看这个程序：

```
#include <stdlib.h>
#include <stdio.h>

struct __attribute__ ((__packed__)) pair {
        short first;
        char second;
        long int third;
        int forth;
        char last;
};

void main(void) {
        struct pair myPair;
        printf("myPair         is at 0x%x\n", &myPair);
        printf("myPair.first   is at 0x%x\n", &(myPair.first));
        printf("myPair.second  is at 0x%x\n", &(myPair.second));
        printf("myPair.third   is at 0x%x\n", &(myPair.third));
        printf("myPair.forth   is at 0x%x\n", &(myPair.forth));
        printf("myPair.last    is at 0x%x\n", &(myPair.last));
} 
```

和一个示例输出：

```
myPair         is at 0xabbd0aa0
myPair.first   is at 0xabbd0aa0
myPair.second  is at 0xabbd0aa2
myPair.third   is at 0xabbd0aa3
myPair.forth   is at 0xabbd0aab
myPair.last    is at 0xabbd0aaf 
```

我们在这里学到的是，每个字段都存储在内存中的前一个字段的旁边，更准确地说是`sizeof(previous_field)`前一个字段右侧的字节（什么时候- 请参阅[this](http://gcc.gnu.org/onlinedocs/gcc/Type-Attributes.html#Type-Attributes)以了解为什么要打包，但这是理想情况）。`struct``packed`

所以，想象一下我们想要创建另一个`struct`与这个兼容。如果我们创建类似的东西：

```
struct __attribute__ ((__packed__)) small_pair {
        long int first;
        char second;
        int third;
        char forth;
}; 
```

我们可以通过强制转换将 a 传递`struct small_pair *`给任何期望 a 的函数`struct pair *`：

```
void my_function(struct pair *);

void main(void) {
    struct small_pair my_small_pair;
    // ...
    my_function((struct pair*) &my_small_pair);
    // ...
}

void my_function(struct pair *a_pair) {
    //...
    printf("Second character of pair is %c\n", a_pair->second);
    //...
    printf("Last character of pair is %c\n", a_pair->last);
    //...
} 
```

编译后，访问`a_pair->second`是“读取结构开始后两个字节的一个字节”（`0xabbd0aa2 - 0xabbd0aa0 = 2`）。所以这将是 a 字段的第三个字节`first`，`struct small_pair`无论它具有哪个值。

但是，怎么`a_pair->last`办？它是`0xf`结构开始后的 (15) 个字节，但显然超出了它的空间（`sizeof(struct small_pair)`只有 14 个）。

所以这将取决于变量在内存中的加载方式，但显然我们不会引用我们想要的值。最好的情况是该地址超出我们的进程空间，因此我们得到一个分段错误，程序中止。但很可能在该内存位置声明了另一个变量，我们将读取/写入与我们想要的不同的变量，留给谁知道结果。

因此，如果我们只是在 的末尾添加另一个 2 字节长的字段`struct small_pair`，我们保证每个可能的 a 引用`struct pair`在我们自己的 中仍然是正确的`struct`，因此它们将在内存级别兼容。

然后，它仍然保留了语义级别的兼容性，但这是另一回事 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:11:30.637

如果我们谈论的是传统的 C，这是不可能的，因为 C 转换的是指针而不是数据类型。如果您使用指针执行此操作，您的程序会将 char 的字节作为 int 的最高有效字节。后面的三个字节将填充 char 变量后面的任何内容。请不要再这样做了！！！！！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:22:13.637

Winsock 中强制转换的原因是它们实现了一种奇怪的多态性破坏形式，其中所有结构的大小相同（因此在某些结构的末尾未使用的字节数组）并且函数采用“通用”结构（例如 sockaddr ）。

因此，在使用适当的多态性时，您将拥有：

```
class SockAddr
{
    ...
};

class SockAddrIn : public SockAddr
{
    ...
};

class SockAddrIn6 : public SockAddr
{
    ...
}; 
```

使用 Winsock，您有几个不相关的结构，它们都是二进制兼容的，并且在将它们传递给函数时，您必须将它们转换为“通用”sockaddr。

# android - Zxing 处理返回按钮

> ID：13546565
> 
> 赞同：2
> 
> 时间：2012-11-24T23:06:38.227
> 
> 标签：android, android-intent, zxing

如果用户从我的应用程序（意图）启动 Zxing 条码扫描器然后按下返回按钮，我应该如何捕捉？- 它显示“抱歉 MyApp 被迫关闭”（或多或少因为我的语言不是英语）。我现在有：

```
if (scanResult != null) {
          intent.putExtra("com.tajchert.kolejrogowska.SCAN.SCAN_MODE", "QR_CODE_MODE");
          String contents = intent.getStringExtra("SCAN_RESULT");
          whatToDo(contents);
      }
      else{
          finish();
      } 
```

没有`else{}`阻塞是一样的。

编辑：日志：

```
11-25 00:16:33.738: E/AndroidRuntime(21969): FATAL EXCEPTION: main
11-25 00:16:33.738: E/AndroidRuntime(21969): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=49374, result=0, data=null} to activity {com.tajchert.kolejrogowska/com.tajchert.kolejrogowska.Kody}: java.lang.NullPointerException
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.app.ActivityThread.deliverResults(ActivityThread.java:3515)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.app.ActivityThread.handleSendResult(ActivityThread.java:3557)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.app.ActivityThread.access$2800(ActivityThread.java:125)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2063)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.os.Handler.dispatchMessage(Handler.java:99)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.os.Looper.loop(Looper.java:123)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.app.ActivityThread.main(ActivityThread.java:4627)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at java.lang.reflect.Method.invokeNative(Native Method)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at java.lang.reflect.Method.invoke(Method.java:521)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at dalvik.system.NativeStart.main(Native Method)
11-25 00:16:33.738: E/AndroidRuntime(21969): Caused by: java.lang.NullPointerException
11-25 00:16:33.738: E/AndroidRuntime(21969):    at com.tajchert.kolejrogowska.Kody.onActivityResult(Kody.java:77)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.app.Activity.dispatchActivityResult(Activity.java:3890)
11-25 00:16:33.738: E/AndroidRuntime(21969):    at android.app.ActivityThread.deliverResults(ActivityThread.java:3511)
11-25 00:16:33.738: E/AndroidRuntime(21969):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:59:56.963

输入这个：

```
if (scanResult != null) {
    String contents = scanResult.getContents();
    if(contents != null)
        whatToDo(contents);
    else
        finish();
} 
```

# php - 将 MySQL 数据库完全导入 Solr 4 会出现 404 错误

> ID：13546580
> 
> 赞同：4
> 
> 时间：2012-11-24T23:08:15.957
> 
> 标签：php, mysql, jdbc, solr

又一个 Solr 4 新用户。我很佩服 Solr 能够在全文搜索中做些什么，但是在线文档有点令人沮丧。无论如何，我正在将我的 MySQL 数据库（有几百万条记录）导入到 Solr。

*   我下载了 Java 连接器并将其保存在`example/lib`目录中。
*   我创建`data-config.xml`并放入其中：

    ```
    <document name="doc">
        <entity name="pagey" query="SELECT * FROM page">

            <field column="id" name="pid" />
            <field column="Content" name="pcontent" />
            <field column="bid" name="bid" />
            <field column="Num" name="num" />
        </entity>
    </document> 
    ```

    并将其保存在：`/example/solr/collection1/conf`.

*   `solrconfig.xml`通过添加将该文件链接到：

    `<requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler"> <lst name="defaults"> <str name="config">data-config.xml</str> </lst> </requestHandler>`

*   修改 schema.xml 以添加我的新字段。

但是当我到达通过 interring 执行完全导入时：`http://[localhost]:8983/solr/dataimport?command=full-import`我收到了这个错误：`HTTP ERROR 404 Problem accessing /solr/dataimport. Reason: Not Found`. 我认为这在上一个版本 4 中不再有效。所以我尝试了：`http://[localhost]:8983/solr/#/collection1/dataimport?command=full-import`但没有任何反应。

我的字段已成功添加，我可以在 collection1 的架构浏览器部分的管理面板上看到它们。

从 admin -> collection1 -> Dataimport，它显示：`sorry, no dataimport-handler defined!`. 运行`start.jar`不会显示错误。

**我在这里错过了什么？**

**编辑：**解决后，请记住“XML 区分大小写”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T20:43:38.937

您的数据配置需要看起来更像这样。您没有指定 mysql 主机、用户或密码。

```
<dataConfig>
    <dataSource type="JdbcDataSource"
   driver="com.mysql.jdbc.Driver"
   url="jdbc:mysql://127.0.0.1:8889/yourdatabase"
   user="mysql_user"
   password="mysql_password"/>

<document name="doc">
    <entity name="pagey" query="SELECT * FROM page">

        <field column="id" name="pid" />
        <field column="Content" name="pcontent" />
        <field column="bid" name="bid" />
        <field column="Num" name="num" />
    </entity>
</document>
</dataConfig> 
```

您需要将其包含在您的 solrconfig.xml 文件中。

```
<lib dir="../../../dist/" regex="apache-solr-dataimporthandler-\d.*\.jar" /> 
```

和

```
 <requestHandler name="/dataimport"
     class="org.apache.solr.handler.dataimport.DataImportHandler">
    <lst name="defaults">
      <str name="config">data-config.xml</str>
    </lst>
  </requestHandler> 
```

在 solr.xml 你需要确保你有以下

```
<solr persistent="true" sharedLib="../lib"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T11:09:27.990

```
If you are using latest Solr then use 

<lib dir="../../../dist/" regex="solr-dataimporthandler-\d.*\.jar" />

instead of

<lib dir="../../../dist/" regex="apache-solr-dataimporthandler-\d.*\.jar" /> 
```

# java - 优化屏幕从手机尺寸到平板电脑尺寸 android 开发

> ID：13546583
> 
> 赞同：0
> 
> 时间：2012-11-24T23:08:40.517
> 
> 标签：java, android, intellij-idea

我对java和android相当陌生。目前我正在学校学习java。我刚开始在这个计算器上工作只是为了让我参与到 android 开发中。我目前的问题是，当我将应用程序部署到模拟器（手机尺寸 480x800）时看起来像 Pic 001，但是当我将它部署到我的 Kindle fire 第一代（我相信是 1024x600）时看起来像 Pic 002。我该怎么做所以它在每部手机中看起来都一样。

![图片 001](../Images/eeeccee3dc215b9ce024bc5ad475b838.png)![图片 002](../Images/dd03d3e59f5cb48da43a5a3cc761a81e.png)

[XML 文件](https://dl.dropbox.com/u/27136243/main.xml)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:31:39.703

为了让你的按钮填满屏幕的整个宽度，把它放在你的标签中`Button`：

```
android:layout_width="0dp" android:layout_weight="1" 
```

代替 ：

```
android:layout_width="80dp" 
```

如果您希望按钮更高：
- 在您的标签中`Button`更改`android:layout_height="80dp"`为`android:layout_height="match_parent"`。- 在包含按钮
的标签中更改为. - 在您的标签中更改为X 是为您提供正确比例的值。您将收到一条警告，告诉您嵌套重量对性能不利，但这是我知道的唯一方法。 一般来说，如果你想让一个组件填充空白空间，请将宽度或高度设置为 0dp 并添加权重。权重将定义要填充空间的元素的比例。 我希望它会帮助你。`LinearLayout``android:layout_height="wrap_content"``android:layout_height="0dp" android:layout_weight="1"`
`TextView``android:layout_height="wrap_content"``android:layout_height="0dp" android:layout_weight="X"`

# smartgwt - 在 smart gwt 中找不到 skin_styles.css 和 PNG 图像

> ID：13546591
> 
> 赞同：0
> 
> 时间：2012-11-24T23:09:53.070
> 
> 标签：smartgwt

我将主题指定为：

我的 smartgwt-skins 在 com\smartclient\theme\enterpriseblue\public\sc\skins\EnterpriseBlue 下有 css 和图像

但是当我在浏览器中执行代码时，它抱怨找不到 skin_styles.css 和 PNG 图像。出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T01:49:58.557

我通过在 Eclipse 中将 GWT 调试级别设置为“ALL”解决了这个问题，然后我看到路径名的大写错误。然后我用小写字母重命名了模块。现在可以了。

# php - 自定义页面模板上 wordpress 中的帖子格式问题

> ID：13546592
> 
> 赞同：1
> 
> 时间：2012-11-24T23:09:54.887
> 
> 标签：php, html, wordpress

嘿伙计们，所以我试图循环运行以获取页面上某个类别中的所有帖子，但由于某种原因没有任何反应？

代码 ：

```
<?php
/*
Template Name: djequip
*/

get_header(); ?>

        <div id="primary">

            <div id="content" role="main">

                <?php /*query_posts('test');uncategorized*/
                if ( have_posts() ) : while ( have_posts() ) : the_post(); 
                 get_template_part( 'content', get_post_format() ); 
                endwhile; endif; ?>

            </div><!-- #content -->
        </div><!-- #primary -->

<?php get_sidebar(); ?>
<?php get_footer(); ?> 
```

让我知道您是否可以提供帮助，非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T15:42:39.113

```
<?php /* Template Name: TEMPLATE NAME */ ?>
<?php get_header();?>

<?php query_posts('category_name=CATEGORY NAME'); ?>
   <?php while (have_posts()) : the_post(); ?>
      <?php the_excerpt(); ?>
<?php endwhile; ?> 
```

你是这个意思吗？

> 摘录

可以改为

> 内容

另外，我想补充一点，您可以在 WP PHP 周围放置 div。

# java - 这是解析 ftp url 方案的好方法吗？

> ID：13546594
> 
> 赞同：1
> 
> 时间：2012-11-24T23:10:01.510
> 
> 标签：java, parsing, url

我写了一个小的java工具，一开始我必须解析一个url。我想知道，您对我的解决方案有何看法以及是否有更好的方法？这里有些例子：

> aaa://username:password@server:port/dir/
> 
> aaa://服务器：端口/目录/
> 
> aaa://服务器：端口

如果用户不小心，每一种字符串都是可能的。所以我的函数有可能得到这样的字符串

> aaa://用户名：通过

也。但是字符串总是以 wwitch aaa:// 开头。

这是我的代码：

url = url.replaceFirst("aaa://", "");

```
String params[] = url.split("@");
if(params[0].compareTo("") != 0) {
    String paramsfst[] = params[0].split(":");
    if(params.length == 1) {
        if(paramsfst.length >= 1) {
            this.server = parsePort(paramsfst[0]);
            if(paramsfst.length == 2) {
                this.port = parsePort(paramsfst[1]);
            }
        }               
    } else {
        String paramssec[] = params[1].split(":");
        if(paramssec.length >= 1) {
            this.server = parsePort(paramssec[0]);
            if(paramssec.length == 2) {
                this.port = parsePort(paramssec[1]);
            }
        }
        if(paramsfst.length == 2) {
            this.username = paramsfst[0];
            this.password = paramsfst[1];   
        }
    }
    if(url.contains("/")) {
        this.path = url.substring(url.indexOf("/"), url.length() -1);   
    }

private String parsePort(String port) {
    int i = port.indexOf("/");
    if(i == -1) {
        return port;
    }
    return port.substring(0, i);
} 
```

你怎么看？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T23:15:01.103

你看过[**URL 类**](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URL.html)吗？

[**有关示例，**](http://docs.oracle.com/javase/tutorial/networking/urls/urlInfo.html)请参见此处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:16:10.770

就我个人而言，这看起来像是很多代码。我认为你可以更紧凑地使用`regex`，当你定义你的模式以及如何在一行中将它切割成不同的捕获组时，然后将你的组值读入 vars 并完成交易。我现在要运行，也许我以后可以想出代码，但只要看看下面`java regex`，Oracle 有一个相当不错的教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-31T21:27:44.607

**我认为您正在寻找[java.net.URI](https://docs.oracle.com/javase/7/docs/api/java/net/URI.html)：**

```
final String destination = "ftp://anonymous@localhost:21/inbox?password=secret"

final URI uri = new URI(destination);

String host = uri.getHost(); //localhost
final int port = uri.getPort(); //21
final String directoryPath = uri.getPath();  //inbox
String username = uri.getUserInfo(); //anonymous

//The password can exist as a query parameter or as part of the user info
final List<NameValuePair> queryParams = URLEncodedUtils.parse(uri, "UTF-8");
final Map<String, String> paramsMap = new HashMap();
queryParams.forEach((param) -> { paramsMap.put(param.getName(), param.getValue()); });

String password = null;
if (paramsMap.containsKey("password"))
{
    password = paramsMap.get("password"); //secret
}
else if ((username != null) && username.contains(":"))
{
    password = username.split(":")[1];
    username = username.split(":")[0];
} 
```

# php - 在 PHP 中用空格替换破折号

> ID：13546597
> 
> 赞同：43
> 
> 时间：2012-11-24T23:10:16.770
> 
> 标签：php, string

我目前在我的代码中有这一行：

```
<div><a href="http://www.envisionforce.com/local/'.$row[website].'-seo-services">'.ucwords($row[website]).'</a></div> 
```

它会显示一个城市名称，如下所示：

```
Puiol-del-piu 
```

但我需要的是它显示没有破折号，这样 ucwords 将大写每个单词的第一个字母，例如：

```
Puiol Del Piu 
```

如果代码可以限制在这一行，那就太好了，因为我在页面中还有很多其他内容。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-11-24T23:16:56.457

这个 str_replace 完成了这项工作：

```
$string = str_replace("-", " ", $string); 
```

此外，您可以将其作为一个函数。

```
function replace_dashes($string) {
    $string = str_replace("-", " ", $string);
    return $string;
} 
```

然后你叫它：

```
$varcity = replace_dashes($row[website]);
<div><a href="http://www.envisionforce.com/local/'.$row[website].'-seo-services">'.ucwords($varcity).'</a></div> 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-11-24T23:11:35.583

```
<?php
echo '<div><a href="http://www.envisionforce.com/local/'.$row[website].'-seo-services">'.ucwords(str_replace("-"," ",$row[website])).'</a></div>'; 
```

在上面的示例中，您可以使用`str_replace()`空格替换连字符来创建单独的单词。然后使用`ucwords()`将新创建的单词大写。

[http://php.net/manual/en/function.str-replace.php](http://php.net/manual/en/function.str-replace.php)

[http://php.net/manual/en/function.ucwords.php](http://php.net/manual/en/function.ucwords.php)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-05-24T10:17:57.593

用空格替换破折号

```
str_replace("-"," ",$row[text]) 
```

用破折号替换空格

```
str_replace(" ","-",$row[text]) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-12-29T10:39:30.377

str_replace('找到你要替换的', '替换为', '你的数组或字符串变量');

如果你想用空格替换破折号，你可以使用这个：

```
str_replace("-"," ",$row[text]) 
```

如果你想用破折号替换空格，使用这个：

```
str_replace(" ","-",$row[text]) 
```

使用 ucwords() 将单词大写。

# c++ - 为什么我在 typedef 存在时收到 Unresolved External Symbol 错误？

> ID：13546598
> 
> 赞同：0
> 
> 时间：2012-11-24T23:10:16.610
> 
> 标签：c++, c, visual-c++, visual-studio-2012

我正在创建一个将四元数转换为欧拉角的转换器，我编写了以下代码：

```
//(...)
/*
* Converter Includes
*/
#include "EulerAngles.h"
//(...)
static cell AMX_NATIVE_CALL n_QuatToEuler( AMX* amx, cell* params )
{
    Quat q;
    q.x = amx_ctof(params[1]);
    q.y = amx_ctof(params[2]);
    q.z = amx_ctof(params[3]);
    q.w = amx_ctof(params[4]);
    EulerAngles EU = Eul_FromQuat(q,params[5]);
    //(...)
    return 1;
}
//(...) 
```

[我将http://tog.acm.org/resources/GraphicsGems/gemsiv/euler_angle/](http://tog.acm.org/resources/GraphicsGems/gemsiv/euler_angle/)中的 EulerAngles.c 包含到我的项目中，我还将所有其他文件下载到我的项目中。

当我尝试编译我的项目时，我从 Visual Studio 2012 收到以下错误消息：

```
Error   1   error LNK2001: unresolved external symbol "struct Quat __cdecl Eul_FromQuat(struct Quat,int)" (?Eul_FromQuat@@YA?AUQuat@@U1@H@Z)    .\calculatorSAMP\calculatorSAMP.obj calculatorSAMP
Error   2   error LNK1120: 1 unresolved externals   .\calculatorSAMP\Release\calculatorSAMP.dll calculatorSAMP 
```

EulerAngles.h 中包含的 QuadTypes.h 具有以下代码：

```
/**** QuatTypes.h - Basic type declarations ****/
#ifndef _H_QuatTypes
#define _H_QuatTypes
/*** Definitions ***/
typedef struct {float x, y, z, w;} Quat; /* Quaternion */
enum QuatPart {X, Y, Z, W};
typedef float HMatrix[4][4]; /* Right-handed, for column vectors */
typedef Quat EulerAngles;    /* (x,y,z)=ang 1,2,3, w=order code  */
#endif 
```

我在这里想念什么？

我试图将其编辑为：

```
/**** QuatTypes.h - Basic type declarations ****/
#ifndef _H_QuatTypes
#define _H_QuatTypes
/*** Definitions ***/
struct Quat {float x, y, z, w;}; /* Quaternion */
enum QuatPart {X, Y, Z, W};
typedef float HMatrix[4][4]; /* Right-handed, for column vectors */
#define EulerAngles Quat ;    /* (x,y,z)=ang 1,2,3, w=order code  */
#endif 
```

但它导致了更多的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:13:52.053

该错误表明您缺少一个功能：

```
Eul_FromQuat(struct Quat,int); 
```

我在您提供的代码中看不到该功能。

所以你的编译器和我都认为它丢失了，并且是一个未解析的符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:31:27.147

如果是 .c 文件，则默认编译为 C。

您要么必须更改该文件的“编译为”选项，要么添加`extern "C"`到 .h 文件中的声明。

# php - PHP打印机_写入PDF文件？

> ID：13546600
> 
> 赞同：1
> 
> 时间：2012-11-24T23:11:22.043
> 
> 标签：php, pdf

我知道您可以使用 printer_write 函数在连接到服务器的打印机上使用 PHP 打印文本。但是您可以使用此功能打印位于服务器上的 pdf 文件吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:19:15.217

是的，这是可能的，但它很麻烦。我们最近构建了一个应用程序，需要使用 PHP 为客户打印标签。我们决定使用 Windows 服务器和具有自己的打印软件的打印机。

这是我们最终用于打印生成的标签的代码：

```
system('"C:\Program Files\Foxit Software\Foxit Reader\Foxit Reader.exe" /p "C:\www\pdf\label.pdf"'); 
```

请注意，这是针对特定打印机和平台的非常特定的解决方案。具有适当 Linux 驱动程序的打印机或其他 Windows 打印机的类似解决方案应该可以正常工作，前提是它们具有通过命令行处理文件的类似方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T04:17:10.820

花了很多时间修修补补，但我终于想出了：

```
exec("\"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\AcroRd32.exe\" /t \"C:\\PathToPDF.pdf"); 
```

我无法让福昕在 Brother 打印机上使用较小的标签尺寸，它会默认为 4x6" 标签并导致错误。（使用 Brother QL-1060N）。--不过，我必须注意它可以正常工作使用默认标签大小。

我使用 Adob​​e Reader 9 解决了这个问题，并在服务器计算机上始终保持打开状态，并使用适当的打印设置。我使用 9 是因为出于某种原因，Adobe Reader X 在第一个标签之后的每个标签上都会减少 1 个 ACSII 字符。（例如 1=2、8=9、=！）。

谢谢卡尔。我希望这对未来的读者很有用！=)

快乐编码

# iphone - 如何使用来自相机的 AVCaptureVideoPreviewLayer 将流延迟到 UIImageview？

> ID：13546606
> 
> 赞同：0
> 
> 时间：2012-11-24T23:12:09.080
> 
> 标签：iphone, ios, xcode, ipad, cocoa-touch

如何使用来自相机的 AVCaptureVideoPreviewLayer 将流延迟到 UIImageview？

请参阅下面我如何绑定它们，但我不知道如何延迟它（我不想要实时）

```
AVCaptureVideoPreviewLayer* captureVideoPreviewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session];

captureVideoPreviewLayer.frame = self.imageView.bounds;
[self.imageView.layer addSublayer:captureVideoPreviewLayer]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:46:26.187

首先，您将要删除您现在拥有的预览图层框架，因为没有任何方法可以延迟这些预览框架开箱即用。

您将要创建一个缓冲区。如果我们谈论的是几帧，你可以有一个 NSMutableArray，你在一端用 UIImages 填充它，同时你从另一端提供你的图像视图。

您的 UIImage 将来自 didOutputSampleBuffer 方法，使用类似[从 CMSampleBufferRef 创建的 UIImage 不显示在 UIImageView 中？](https://stackoverflow.com/questions/3305862/uiimage-created-from-cmsamplebufferref-not-displayed-in-uiimageview)

现在，您将不得不应对几个挑战：

*   你说的是有几秒的延迟，5秒大约是150帧。在内存中存储 150 个 UIImage 是不会发生的，除非它们非常小并且在最新的设备上
*   您可以通过将图像保存到磁盘并让您的阵列仅存储这些图像的路径而不是图像本身来解决这个问题。现在你可能会遇到性能问题，因为你要实时进行读/写操作，你的帧率会受到影响
*   由于糟糕的帧速率，您必须确保录制的提要和实时提要之间没有失去同步，否则您将以 5 秒的延迟开始并以更长的延迟结束

祝你好运，它可以通过一些折衷（较慢的帧速率......）来完成，但它可以完成。（我自己多次做过非常相似的事情，由于IP原因无法共享代码）。

# javascript - 将图像添加到 javascript 对象

> ID：13546609
> 
> 赞同：0
> 
> 时间：2012-11-24T23:12:29.937
> 
> 标签：javascript, image, object, constructor

我正在尝试创建/发明一个新的 javascript 滑块对象，该对象将通过显示基线图像来工作：http: [//imgur.com/DuVkE.png](http://imgur.com/DuVkE.png)

然后我想根据某些情况使用这些“旋钮”在上面分层

[http://imgur.com/GKkqx.png](http://imgur.com/GKkqx.png) 这些已经被“切割”并将被放置在三个黑色旋钮之一上。我有许多不同的颜色，因为我计划穿过它们，使颜色看起来从一种转变为另一种。

所以我需要能够将图像附加到我从用户那里收到的 id 上，然后再操作图像。

我的代码：

```
<div id='option1'></div>

<script type="text/javascript">

var slide1 = new slider("option1"); 
```

我的构造函数看起来像这样：

```
function slider(id) {

var obj = document.getElementById(id);
if (!obj) { 
var state = -1;
return -1;
}
var state = 0; //blank state

//alert("in");
//alert(document.getElementById(id).className);

//this.addClass("hSliderBack"); INCORRECT SYNTAX!!!
$("#"+id).addClass("hSliderBack"); //this works
} 
```

我用上面的 addClass 解决了这个问题，虽然有点难看。

我的 CSS 脚本：

```
.hSliderBack
{
background-image: url('/Switches/switchLine.png');
background-repeat: no-repeat;
padding-left: 2px;  /* width of the image plus a little extra padding */
display: block;  /* may not need this, but I've found I do */
} 
```

这就是我可以向构造函数添加图片的方式。还有很多工作要做，但至少这是一个开始。任何意见仍然受到赞赏，因为我很绿色！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:20:26.480

你在这里写的：

```
//obj.innerHTML = "<img src=' this doesn't seem right to me. 
```

实际上是一种完全合理可行的方式。`<img>`您将引用要显示的图像的节点输入到 DOM 中。

但是，在许多情况下，更常见且可能更易于维护的解决方案是使用引用背景图像的 CSS 样式，然后`<div>`使用导致图像显示的样式将 a 输入到 DOM 中。

但是，您应该问自己，最好在没有任何工具支持的情况下执行此操作。许多最流行的 JavaScript 库都内置了这样的工具，或者至少有一些方法可以让构建这种类型的代码变得更加容易。

当然，如果你这样做是为了在使用框架之前学习 Web 开发的基础知识，这样你就会更彻底地了解他们在做什么，对你来说更有力量:-)

# java - 使用参数调用通用 Java 函数

> ID：13546612
> 
> 赞同：0
> 
> 时间：2012-11-24T23:13:15.727
> 
> 标签：java, generics, casting, unchecked

以下是可能的吗？

```
interface Foo<T> {
    public void bar(T object);
} 
```

...

```
public void callBar(Foo<?> foo) {
    foo.bar("Hello world!");
} 
```

显然，这不是类型安全的，因为它假设`Foo<?>`在这种情况下实际上是一个`Foo<String>`.

但不是通常的“未经检查”警告，这实际上给了我以下错误：*Foo 类型中的方法 bar(capture#1-of ?) 不适用于参数 (String)*

通常我可以做一些转换来将此异常转换为我想要的警告，但不知何故我现在找不到一个......

任何想法（**除了“不要这样做！”，请**）？

**编辑：**

似乎每个人**都想**讨论“不要这样做”，所以让我解释一下我试图尽可能优雅地解决的整个问题，然后也许有人有更简洁的方法来做到这一点......

我正在尝试编写一个灵活的事件总线系统，我不需要为每个事件声明十亿个接口类型。

我想要一个`EventBus`看起来像这样的类：

```
public class EventBus<GroupType, EventType>  {

  ...

  public void addHandler(EventHandler<GroupType, EventType, ?> handler, GroupType group, EventType... events) {
    //                                                      ^ this is the <?> !!!
    // add handler to list of handlers for group and requested event types
  }

  public <Source> void fireEvent(GroupType group, EventType event, Source source) {
    // call all handlers registered for group and event type
  }
} 
```

界面`EventHandler`如下所示：

```
public interface EventHandler<GroupType, EventType, Source> {
  public void onEvent(GroupType group, EventType event, Source source);
} 
```

这样，我可以简单地编写我的事件处理程序，如下所示：

```
public class Handler implements EventHandler<Groups, Events, TextBox> {
  public void onEvent(Groups group, Events event, TextBox source) {
    // Do something with source immediately
  }
} 
```

where`Groups`和`Events`是描述可能的事件类型的枚举。

然后我注册他们

```
addHandler(myHandler, Groups.EDIT_BOXES, Events.VALUE_CHANGED, Events.CLEARED, ...); 
```

我可以打电话给他们

```
fireEvent(Groups.EDIT_BOXES, Events.VALUE_CHANGED, myEditField); 
```

在我的代码中，我**知道**组中的`EDIT_BOXES`所有源都是类型的`TextBox`，我不想在我编写的每个处理程序中都用类型转换我的生活。这就是为什么我希望能够在处理程序中实现特定接口，但使用来自 EventBus 的不安全类型转换（我编写一次并永远隐藏）调用它，而不是像这样编写我的所有处理程序：

```
public class Handler implements EventHandler<Groups, Events> {
  public void onEvent(Groups group, Events event, Object source) {
    TextBox usableSource = (TextBox) source;
    // Do something with usableSource
  }
} 
```

如果演员阵容错误，程序将会而且应该以任何方式崩溃和烧毁。即使我在处理程序中放置了“instanceof”检查，我也需要以某种方式将其作为错误抛出。我可以优雅地做到这一点，但这并不重要，因为这种情况下的任何错误都是代码中需要修复的错误，而不是一些运行时用户错误，我应该优雅地通知用户。

现在，我已经看到其他库实现了一个完全类型安全的事件系统，但这通常涉及必须为每种可能的事件类型和每种可能的事件处理程序类型声明接口，有时甚至为事件总线本身上的函数声明接口，其中，如果你问我，是不是比它的价值更痛苦。

如果你们中的任何人有一种干净的方式来做我想要实现的目标，我会很兴奋。但我不确定这是否可行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:54:47.177

您建议这是一个解决方案：

```
public void callBar(Foo<?> foo) {
    ((Foo<String>) foo).bar("Hello world!");
} 
```

我声称如果这*确实*有效，那么您的 API 输入有问题。

一种可能性是所有`callBar`将被调用的地方，`foo`实际上将是一个`Foo<String>`. 但如果是这种情况，那么（通用）方法签名是不正确的。您应该将其声明为：

```
public void callBar(Foo<String> foo) {
    foo.bar("Hello world!");
} 
```

另一种可能性是，`bar`当使用与泛型类型不匹配的参数调用该方法时，该方法实际上可以正常工作。例如

```
Foo<Integer> f = ...
f.bar("Hello world!"); 
```

不会因为时间错误而导致任何运行时中断`"Hello world!"`。在这种情况下，您可能在接口中错误地声明了方法签名。它应该是：

```
public void bar(Object object); 
```

第三种可能性是您的代码适用于该`Foo.bar`方法的特定实现，并且您只会将它与这些实现一起使用。但如果是这种情况，您的代码应该反映这一点：

```
public void callBar(Foo<?> foo) {
    if (foo instanceof SomeFooImpl) {
        foo.realBar("Hello world!");
    } else {
        throw InvalidArgument("barring the wrong kind of foo");
    }
} 
```

和

```
public class SomeFooImpl<T> implements Foo<T> {
    ...
    public void bar(T object) {
        realBar(object);
    }

    publiC void realBar(Object object) {
        System.out.print("Breaker breaker - come in '" + object + "'"));
    }
} 
```

（注意我们不能重载`bar`and `realBar`; 即给它们相同的名字。这些方法需要有不同的擦除签名......）

* * *

但最重要的是，您提出的正确解决方案*可能*会导致`foo`使用与基类型不匹配的实际参数调用该方法。这是错误的，至少从您声明它们的类型签名的角度来看是错误的。

* * *

**更新**以回应您的评论。

我认为最好的解决方案是改变这一点：

```
public interface EventHandler<GroupType, EventType, Source> {
    public void onEvent(GroupType group, EventType event, Source source);
} 
```

到

```
public interface EventHandler<GroupType, EventType> {
    public void onEvent(GroupType group, EventType event, Object source);
} 
```

这意味着特定的处理程序需要将`source`对象类型转换为它所期望的类型。但这几乎是您的 EventBus API 的强制要求......这似乎是说处理程序注册和调度与处理程序对象的源类型无关。从功能的角度来看，它也可能很好，因为它允许单个处理程序处理来自多种源类型的事件。

（评论：您的 API 设计看起来可能过于关注泛型的优雅使用......以支持事件总线需要提供的功能为代价。我对事件总线的概念是它应该避免静态依赖在事件的提供者和消费者之间。这意味着它需要能够动态地“处理”生产者和消费者之间的类型不匹配。但是您对泛型的使用似乎是（重新）引入静态类型依赖... )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T23:38:31.057

如果您有一个通用接口，请不要让该方法以特定类型调用它。或者不要使用特定类型并保持通用

```
interface Foo<T> {
    public void bar(T object);
}

class SomeGenericClass {
    public <T> void callGenericBar(Foo<T> foo, T param) {
        foo.bar(param);
    }
    public void callStringBar(Foo<String> foo) {
        foo.bar("Hello");
    }
} 
```

如果你这样做

```
public void callBar(Foo<?> foo) {
    ((Foo<String>) foo).bar("Hello world!");
} 
```

以下代码可以正常编译：

```
interface Foo<T> {
    public void bar(T object);
}

class StringFoo implements Foo<String> {
    public void bar(String object) {
        System.out.println(object);
    }
}

class IntFoo implements Foo<Integer> {
    public void bar(Integer object) {
        System.out.println(object);
    }
}

class TestClass {
    public static void callBar(Foo<?> foo) {
        ((Foo<String>) foo).bar("Hello world!");
    }

    public static void main(String[] args) {
        StringFoo foo1 = new StringFoo();
        IntFoo foo2 = new IntFoo();
        callBar(foo1);
        callBar(foo2);
    }
} 
```

但是：一旦你运行它，你会得到

```
java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer 
```

它*要求*是`foo`一个`Foo<String>`. 采用

```
public static void callBar(Foo<String> foo) {
    foo.bar("Hello world!");
} 
```

如果你有多种类型的 Foo 使用方法重载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:16:24.687

没关系......只是想通了：

```
public void callBar(Foo<?> foo) {
    ((Foo<String>) foo).bar("Hello world!");
} 
```

# .htaccess - 具有干净 URL 且没有 .htaccess 文件的单页应用程序？

> ID：13546615
> 
> 赞同：5
> 
> 时间：2012-11-24T23:13:53.440
> 
> 标签：.htaccess, url-rewriting, amazon-s3, router, clean-urls

我的问题专门针对下面的两个页面，但也更普遍地与使用没有 .htaccess 文件的干净 URL 的方法有关。

[http://www.decitectural.com/](http://www.decitectural.com/) 和 [http://www.decitectural.com/about/](http://www.decitectural.com/about/)

以上页面托管在 Amazon 的 S3 上，不允许使用 htaccess 文件。结果，我发现没有简单的方法来创建一个干净的 url 重写方案，该方案将所有请求发送到一个索引文件，然后使用 javascript 解释 URL 并加载正确的页面（使用 AJAX，或者，带有 decitectural 的案例，带有简单的 div 可见性切换）。

为了规避这个问题，我通常编辑amazon S3存储桶属性，将索引页面和错误页面都设置为index.html文件。在这种情况下，即使请求了无效路径（例如 /about/），也会提供 index.html 文件。这在很大程度上是一个有效的解决方案......也就是说，直到我意识到我也得到了一个带有 index.html 页面的 404，这将阻止谷歌对其进行索引。

这导致我寻找解决这个问题的替代方案。目前，作为临时修复，我实际上是在服务器上创建 /about/ 目录，其中包含 index.html 文件的副本。这可行，但显然不是问题的真正解决方案。

对于如何在 S3 上或在任何无法使用 .htaccess 文件的情况下设置干净的 URL 路由方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T11:27:11.617

这里有一些解决方案：[没有 mod_rewrite 的漂亮 URL，没有 .htaccess](https://stackoverflow.com/questions/975262/pretty-urls-without-mod-rewrite-without-htaccess)

另外，我想您可以运行一个脚本来从数组或数据库**动态创建文件，以便生成所有 URL：**

*   /index.html
*   /about/index.html
*   /contact/index.html
*   ...

并在每次编辑时挂钩脚本，在 cron 中或手动运行。在性能方面不是最好的，但是嘿，它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T04:00:38.517

我认为你的做法是错误的。S3 让您可以完全控制网站的页面结构。如果你希望你的链接是“/about”，只需上传一个名为“about”的文件，你就完成了。（设置标题以便浏览器知道它是 HTML。）

是的，如果有人链接到“/about/”或“/about.html”，它将中断。但是，如果您以奇怪的方式弄乱他们的链接，几乎任何网站都会崩溃。在链接到您自己的网站时，您必须保持警惕，因为您不会有任何重写规则来为您清理。但是你应该让自动化来做到这一点。

# cassandra - Cassandra，存储有关项目的各种事件

> ID：13546619
> 
> 赞同：0
> 
> 时间：2012-11-24T23:14:18.043
> 
> 标签：cassandra, data-modeling

我需要为上传的歌曲存储这些类型的事件：

*   意见
*   喜欢
*   不喜欢
*   评论
*   收藏夹
*   下载

而且可能还有更多。

为了存储有关歌曲本身的信息，我使用了宽行，其中列名是时间戳，值是`JSON`包含有关该歌曲的所有信息的字符串。

现在如果我只需要存储数字就不会有太大的问题，但我实际上需要存储有关说喜欢那首歌的用户的信息。

因此，如果 1000 位用户喜欢某首歌曲，那么将所有这些信息放在一个列中可能是个坏主意。

所以我可能这样做的唯一方法是将这些信息存储在不同的 CF 中。

但我不确定如何将歌曲本身与分散在不同列中的所有信息“连接”起来？

所以我的问题是，我是否朝着正确的方向前进，如果是，我将如何存储所有这些动作并将它们连接在一起。

**编辑**

我正在尝试建立喜欢系统，它几乎失控了，这些是我需要执行的操作才能喜欢/不喜欢

1.  检查用户是否已经喜欢该项目
2.  检查用户之前是否不喜欢该项目
3.  如果他确实不喜欢，则删除该条目
4.  现在获取当前喜欢
5.  现在更新项目本身，设置新的喜欢计数
6.  更新`CF`包含所有喜欢该项目的用户

实际上我需要运行更多查询，所以我总共得到了将近 6 个查询，甚至更多是正常的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T14:34:49.553

为“User、Song、Song_Likes、User_Likes、Song_Dislike、User_Dislike”创建不同的列族，使用songId（UUID）和UserId（UUID）在列族之间建立like。

```
CF
 User: KS {userId} -> {{user}, {JSON user Info}}
 Song: KS {songId} -> {{song}, {JSON song Info}}

 Song_Comments: {songId -> {(Reversed)timestamp, userUUID:UserName:comment}}
  Reveresed Time stamp can help you to get latest N comments quickly.

 Song_Likes: {songId -> {timeStamp, userUUID}}
   (or if time of event is not important.)
 Song_Likes: {songId -> {userUUID, column Data {....} }

 similarly for other Column Families. 
```

下面的赞可能对你有帮助。[http://www.rackspace.com/blog/cassandra-by-example/](http://www.rackspace.com/blog/cassandra-by-example/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:28:54.340

在 casandra 中，您无法执行连接，因此您必须对数据进行非规范化。所以这个想法是将实体和关系保持在单独的列族中。还要记住 cassandra 确实有超级列，当你想深入一层时，这非常有用，所以你有所有在一起。也不要错过 cassandra 的限制 - 取决于您使用的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-02T04:24:10.683

在规划 Cassandra 模式时，了解您需要查询的内容是最重要的考虑因素之一，如果不是最重要的考虑因素之一。Cassandra 旨在处理大量写入。

根据您要实现的其他功能，您可能需要创建额外的列族或完全替换这些列族，以便以最优化 cassandra 查询的方式存储数据。

此外，我建议尽可能多地将数据本地存储在 cassandra 中。我不会将 JSON 对象加载到胖字符串列中。至少在cassandra中直接存储相关数据，比如点赞值等。

您有两个域模型，用户和歌曲，以及要存储的三类数据：

1.  评论
2.  喜欢/不喜欢/收藏
3.  查看/下载

您详细说明了更新算法所需的一些功能查询：

1.  检查用户是否已经喜欢该项目
2.  检查用户之前是否不喜欢该项目
3.  如果他确实不喜欢，则删除该条目
4.  现在获取当前喜欢
5.  现在更新项目本身，设置新的喜欢计数
    *   使用 cassandra 计数器，这两个步骤可以同时发生
6.  更新包含所有喜欢该项目的用户的 CF

可以满足这些查询要求的模式如下。

首先，我们将为**User 和 Song**定义 CF ，它们都使用 UUID 作为键。

```
create column family users with comparator=UTF8Type
   and column_metadata=[{column_name: user_name, validation_class: UTF8Type, index_type: KEYS},
   {column_name: json_data, validation_class: UTF8Type}];

create column family songs with comparator=UTF8Type
   and column_metadata=[{column_name: user_name, validation_class: UTF8Type, index_type: KEYS},
      {column_name: json_data, validation_class: UTF8Type}]; 
```

二级索引有助于按用户名检索用户行。有关性能注意事项，请参阅[此内容。](http://www.datastax.com/docs/1.0/ddl/indexes)

* * *

**可以使用每个评论的 UUID 对评论**进行建模，如下所示：

```
create column family comments with comparator = 'UTF8Type' 
   and column_metadata=[{column_name: user, validation_class: UUIDType, index_type: KEYS},
      {column_name: song, validation_class: UUIDType, index_type: KEYS},
      {column_name: timestamp, validation_class: DateType},
      {column_name: comment, validation_class: UTF8Type}]; 
```

* * *

由于**用户的喜欢和不喜欢**是互斥的，我们可以使用一个列族来存储用户的所有歌曲喜欢/不喜欢。如果您将“收藏”限制为暗示喜欢，我们可以只用这个来完成所有三个。使用用户的 UUID 作为行键，歌曲的 UUID 作为列键，列值为 0 => 无值，1 => 不喜欢，2 => 喜欢，3 => 喜欢。

```
create column family user_likes with comparator = 'UUIDType'
   and default_validation_class = IntegerType; 
```

* * *

现在剩下的就是跟踪每首歌曲的总**喜欢、不喜欢、收藏、观看和下载。**我们可以使用[Cassandra 的计数器列](http://wiki.apache.org/cassandra/Counters)类型在一个 CF 中完成此操作。使用歌曲的 UUID 作为 CF 键。

```
create column family song_data with default_validation_class=CounterColumnType
   and column_metadata=[{column_name: likes},
      {column_name: dislikes},
      {column_name: favorites},
      {column_name: views},
      {column_name: downloads}]; 
```

# haskell - Haskell 不明确的类型错误

> ID：13546621
> 
> 赞同：0
> 
> 时间：2012-11-24T23:14:29.877
> 
> 标签：haskell

我有以下定义

```
{-# LANGUAGE MultiParamTypeClasses,
             FunctionalDependencies,
             FlexibleInstances,
             FlexibleContexts #-}

import qualified Data.Map as M

class Graph g n e | g -> n e where
      empty :: g    -- returns an empty graph

type Matrix a = [[a]]
data MxGraph a b = MxGraph { nodeMap :: M.Map a Int, edgeMatrix :: Matrix (Maybe b) } deriving Show

instance (Ord n) => Graph (MxGraph n e) n e where
         empty = MxGraph M.empty [[]] 
```

当我尝试调用空时，我得到一个模棱两可的类型错误

```
*Main> empty
Ambiguous type variables `g0', `n0', `e0' in the constraint: ... 
```

为什么我会收到此错误？我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:32:48.833

您看到此类型错误是因为没有为 Haskell 提供足够的信息来了解空的类型。

任何评估表达式的尝试都需要类型。尚未定义类型，因为尚无法选择实例。也就是说，正如函数依赖所说，只有在类型参数 g 已知的情况下才能选择实例。简单地说，它是未知的，因为您没有以任何方式指定它（例如使用类型注释）。

类型类系统做了一个开放世界的假设。这意味着所讨论的类型类可能有很多实例，因此类型系统在选择实例时是保守的（即使目前只有一个实例对您有意义，但其他日子可能会更多，并且系统不想仅仅因为其他一些实例进入范围而改变主意）。

# c# - 如何在 SQLite 表的类中将字段标记为可为空？

> ID：13546627
> 
> 赞同：2
> 
> 时间：2012-11-24T23:15:34.197
> 
> 标签：c#, sqlite, nullable

对于在用于 SQLite 数据库的类中应该可以为空的列，是否可以通过附加“？”将该列标记为可以为空。

IOW，如果我希望“TimeOfTheSeason”可以为空，这是这样做的方法：

```
public class PlatypiRUs
{
    [SQLite.PrimaryKey, AutoIncrement]
    public int Id { get; set; }
    public string PlatypusId { get; set; }
    public string PlatypusName { get; set; }
    public DateTime EOW { get; set; }
    public DateTime? TimeOfTheSeason { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T08:33:34.427

**是**的，你可以这样做。

**DateTime 不能用作常量**，但您可以将其设为可为**空的类型（DateTime？）**。

给出**日期时间？默认值为 null**，如果在函数开始时将其设置为 null ，则**可以将其初始化为所需的任何值**。

```
static void TestMethod(DateTime? dt = null)
{
    if (dt == null)
    {
        dt = new DateTime(1981, 03, 01);
    }

    //...
} 
```

您可以使用这样的**命名参数**调用它：

```
TestMethod(dt: new DateTime(2010, 03, 01)); 
```

并使用这样的**默认参数**：

```
TestMethod(); 
```

# java-me - 如何在 Java ME 中使用类名创建新对象？

> ID：13546628
> 
> 赞同：0
> 
> 时间：2012-11-24T23:15:37.950
> 
> 标签：java-me

到目前为止，我找不到不需要 Constructor 类的方法。

此类在 Java ME 中不可用。

还有其他方法吗？

请注意，类的构造函数需要参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T01:59:00.077

这是你想要的？

```
String className = "java.lang.String";
Class theClass = Class.forName(className);
// this line will call the empty constructor
String s = (String) theClass.newInstance(); 
```

[http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/java/lang/Class.html#newInstance%28%29](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/java/lang/Class.html#newInstance%28%29)

# curl - curl 代码不完整或不工作

> ID：13546632
> 
> 赞同：2
> 
> 时间：2012-11-24T23:16:06.543
> 
> 标签：curl, referer

我正在使用这段代码：

```
<?php
 error_reporting(E_ALL);
 $ch = curl_init();
 curl_setopt($ch, CURLOPT_URL, 'http://www.csservers.ro/voteaza/cs.mnx.ro');
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
 curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
 curl_setopt($ch, CURLOPT_REFERER, 'http://www.csservers.ro/evidenta/cs.mnx.ro');
 $html = curl_exec($ch);
 curl_close($ch);
 echo $html;
?> 
```

最终结果应该是“Ip-ul sau clasa asta a mai votata odata ！Incarca maine ！” 或“Se accepta doar voturi din Romania si Republica Moldova”，但我只显示一个空矩形。该网址上的访问权限也应该记录我的IP。curl 会阻止它吗？请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:24:20.347

我添加了

```
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'); 
```

现在html以

```
<p>Se accepta doar voturi din Romania si Republica Moldova </p> 
```

# ruby-on-rails - 如何通过两个对象（到同一个“目标”对象）写入 has_many？

> ID：13546636
> 
> 赞同：0
> 
> 时间：2012-11-24T23:16:32.537
> 
> 标签：ruby-on-rails, activerecord, has-many-through

描述用户与其问题和联系人的结果之间的关系的正确方法是什么？我希望能够调用 User.outcomes 并为用户获取所有结果，无论结果是针对问题还是针对联系人。

这是我现在的模型。是否正确描述了 has_many through 关系？

**用户模型**

```
has_many :questions
has_many :contacts
has_many :outcomes, through: :questions
has_many :outcomes, through: :contacts 
```

**问题模型**

```
has_many :outcomes 
```

**联系方式**

```
has_many :outcomes 
```

**结果模型**

```
belongs_to :question
belongs_to :contact 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T06:49:30.180

因此，这可能不是理想的解决方案，因为它返回一个 Array 而不是 ActiveRecord::Relation。这意味着您将失去延迟加载以及进一步添加范围和`where`语句等的能力。它比编写 SQL 更好，并且应该做你想做的事：

```
class User < ActiveRecord::Base

  has_many :questions
  has_many :contacts
  has_many :questions_outcomes, :through => :questions, :class_name => "Outcomes"
  has_many :contacts_outcomes, :through => :contacts, :class_name => "Outcomes"

  def outcomes
    return questions_outcomes + contacts_outcomes
  end
end 
```

如果您想出更好的方法，请告诉我们。

# javascript - 想要在外部点击时隐藏此 div，排除其中的任何点击

> ID：13546637
> 
> 赞同：0
> 
> 时间：2012-11-24T23:16:34.073
> 
> 标签：javascript, jquery, html

> **可能重复：**
> [检测点击外部元素？](https://stackoverflow.com/questions/1160880/detect-click-outside-element)

当焦点（单击）在它之外时，我试图隐藏一个 div，但是它里面有一些元素，而不是在所有这些上执行 e.target.id 有没有办法包含所有元素？我的意思清楚吗？

编辑：我试图当外面的`hide`任何人`#contain_name``click``newsletter`

jsfiddle：[演示](http://jsfiddle.net/FUDLk/8/)

```
<div id="newsletter">
    <form action="#" class="form-post">
        <div class="clearfix">
            <input type="text" id="email" name="email" placeholder="email" />
            <button id="fake">Send</button>
        </div>
        <div id="contain_name" class="clearfix">
            <input type="text" id="person_name" placeholder="full name" />
            <button id="real_button">Send</button>
        </div>
    </form> 
</div> 

$('#email').focus(function() {
    $('#fake').fadeOut();
    $('#contain_name').slideDown();
});

$(document).on('click', function(){
    //do something here
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:20:10.070

```
$(document).on('click', function(e){
    if (e.target !== $("#excludedDiv")[0]) {
      // do something there
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:21:43.563

这？

```
$( document ).on( 'click', function ( e ) {
    if ( !$( e.target ).closest( '#newsletter' )[0] ) {
        $( '#contain_name' ).hide();
    }
}); 
```

**现场演示：http:** [//jsfiddle.net/FUDLk/11/](http://jsfiddle.net/FUDLk/11/)

# gwt - 在服务器端使用引用项目中的 java 类？

> ID：13546642
> 
> 赞同：1
> 
> 时间：2012-11-24T23:17:34.597
> 
> 标签：gwt

我有一个 GWT 项目，我想在另一个项目的服务器端使用一些类：

```
MyServerProject
    com.me.myserverproject.server.Horse

SomeSupportProject
    com.me.somesupportproject.server.Animal 
```

和 MyServerProject Horse.java 看起来像：

```
class Horse extends Animal {
} 
```

在 Eclipse 中，我有 MyServerProject 引用 SomeSupportProject 项目。所有编译都很好，GWT Compile 也运行良好，没有错误。

当我将 MyServerProject 部署到本地实例时，它会立即在“Animal.java”上引发 NoClassDefFoundError 错误：

```
java.lang.NoClassDefFoundError: com/me/somesupportproject/server/Animal
  at java.lang.ClassLoader.defineClass1(Native Method) 
```

我在 Eclipse 项目属性中将 SomeSupportProject 标记为导出。但似乎 Animal.java 的类文件在部署时没有被导出。我们需要在这里做一些特别的事情来让它发挥作用吗？

我一定遗漏了一些非常明显的东西，因为这是非常基本的东西。我有客户端java文件被引用就好了，我认为这是更棘手的情况。但是这些都是服务器端的类，以为会更简单，

谢谢

------- 更新：项目设置 ---------------

关于我的环境的一些注意事项：

使用eclipse，两个项目并排。我没有使用 Ant 或 Maven。我已将 Eclipse 设置为自动构建，因此不会出现任何编译器错误。为了实际编译部署，我尝试右键单击“MyServerProject”，选择 Google -> GWT Compile。我将输出设置为“全部”。我没有得到任何编译错误。输出未提及任何警告。

GWT Compile 完成后，我再次右键单击该项目，选择 Run As -> Web Application。这就是为在 SomeSupportProject 项目中找到的类引发 java.lang.NoClassDefFoundError 的原因。

如果有任何细节会有所帮助，请告诉我。

--------- 最终更新：已解决 -----

在进行了更多工作之后，似乎我们无法添加项目引用并让服务器端类在部署的顶级项目中遇到。相反，我链接到 SomeSupportProject 中的“src”文件夹。这使得事情仍然可以正常编译，但是当你部署你的项目时，所有的类都没有问题。

所以这确实是一个应用程序引擎问题，应该在下面标记它。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T03:09:40.343

在进行了更多工作之后，似乎我们无法添加项目引用并让服务器端类在部署的顶级项目中遇到。相反，我链接到 SomeSupportProject 中的“src”文件夹。这使得事情仍然可以正常编译，但是当你部署你的项目时，所有的类都没有问题。

所以这确实是一个应用程序引擎问题，应该在下面标记它。

谢谢！

# c++ - C++ 数组中的多字节 UTF-8

> ID：13546643
> 
> 赞同：3
> 
> 时间：2012-11-24T23:17:42.707
> 
> 标签：c++, arrays, unicode, wchar

我在处理数组中的 3 字节 Unicode UTF-8 字符时遇到了问题。当它们在 char 数组中时，我会收到多字符字符常量和隐式常量转换警告，但是当我使用 wchar_t 数组时，wcout 什么也不返回。由于项目的性质，它必须是数组而不是字符串。下面是我一直在尝试做的一个例子。

```
#include <iostream>
#include <string>
using namespace std;
int main()
{
    wchar_t testing[40];
    testing[0] = L'\u0B95';
    testing[1] = L'\u0BA3';
    testing[2] = L'\u0B82';
    testing[3] = L'\0';
    wcout << testing[0] << endl;
    return 0;
} 
```

有什么建议么？我正在使用 OSX。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:41:36.020

由于`'\u0B95'`需要 3 个字节，因此它被视为*多字符文字*。多字符文字具有类型`int`和实现定义的值。（实际上，[我认为 gcc 这样做是不正确的](https://stackoverflow.com/q/13547368/150634)）

将`L`前缀放在文字之前使其具有类型`wchar_t`并具有实现定义的值（它映射到执行宽字符集中的值，*这是**基本执行宽字符集*的实现定义的超集）。

C++11 标准为我们提供了一些更多的 Unicode 感知类型和文字。其他类型是`char16_t`和`char32_t`，其值是表示字符的 Unicode 代码点。它们分别类似于 UTF-16 和 UTF-32。

由于您需要字符文字来存储来自基本多语言平面的字符，因此您需要`char16_t`文字。例如，这可以写成`u'\u0B95'`。因此，您可以按如下方式编写代码，而不会出现警告或错误：

```
char16_t testing[40];
testing[0] = u'\u0B95';
testing[1] = u'\u0BA3';
testing[2] = u'\u0B82';
testing[3] = u'\0'; 
```

不幸的是，I/O 库不能很好地处理这些新类型。

如果您确实不需要使用上述字符文字，则可以使用新的 UTF-8 字符串文字：

```
const char* testing = u8"\u0B95\u0BA3\u0B82"; 
```

这会将字符编码为 UTF-8。

# java - 如何在 OSX 上删除 Java AWT 框架的阴影？

> ID：13546644
> 
> 赞同：1
> 
> 时间：2012-11-24T23:17:48.753
> 
> 标签：java, macos, awt, frame, dropshadow

是否可以在 OS X 上禁用 Java AWT 应用程序的投影？我想创建一个透明的窗口，效果很好，但我无法摆脱阴影。

如果我使用的是 a`JFrame`这可以使用：

```
 JRootPane root = frame.getRootPane();
 root.putClientProperty( "Window.shadow", Boolean.FALSE ); 
```

AWT 框架是否有类似的可能性？

我使用框架[处理](http://processing.org/)，我的代码看起来像这样：

```
void setup(){
  frame.removeNotify();
  frame.setUndecorated(true);
} 
```

处理本身会创建主框架，这里是[source](http://code.google.com/p/processing/source/browse/trunk/processing/core/src/processing/core/PApplet.java)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T03:27:10.603

这是一个简单的应用程序，它使用在 Java 7 下的 Max OS X 10.7.5 上运行的透明窗口（已在 Java 6 下运行），没有任何问题...

![在此处输入图像描述](../Images/d844354e5d42530cdd55f29f6d2292a4.png)

分享一些代码，以便我们可以复制问题

**根据反馈更新**

我已经使用 JDK 1.7.0_07 和 1.6.0_37 在 Mac OS 10.7.5 和 10.8.2 上对此进行了测试

没有和`Window.shadow`有财产...

![在此处输入图像描述](../Images/1951094dfcedf61d9ab5a176e43b3ba2.png)![在此处输入图像描述](../Images/42c3c94fb3a625adb8ce4da01e95c4a3.png)

在没有进行大量测试和进一步信息的情况下，我建议您尽可能早地拨打这个电话。如果这不起作用，请在使窗口可见之前将其作为最后一次调用。

这可能与 Java/AWT 如何连接到它的本机对等点有关，大概，一旦建立连接，您将不再能够影响这些类型的属性......

```
public class TransparentFrame {

    public static void main(String[] args) {
        new TransparentFrame();
    }

    public TransparentFrame() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }
                // Use this to test the transparentancy API
                //doTransparentFrame();
                doDropShadow();
            }

        });
    }

    protected void doDropShadow() {
        String version = System.getProperty("java.version");
        System.out.println(version);
        JFrame frame = new JFrame("Testing");
        JRootPane root = frame.getRootPane();
        root.putClientProperty("Window.shadow", root);
        frame.setUndecorated(true);
        frame.setContentPane(new ContentPane());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new BorderLayout());
        frame.add(new ImagePane());
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    protected void doTransparentFrame() {
        JFrame frame = new JFrame("Testing");
        frame.setUndecorated(true);
        frame.setContentPane(new ContentPane());

        String version = System.getProperty("java.version");
        System.out.println(version);
        if (version.startsWith("1.7")) {
            frame.setBackground(new Color(0, 0, 0, 0));
        } else if (version.startsWith("1.6")) {
            if (supportsPerAlphaPixel()) {
                setOpaque(frame, false);
            } else {
                System.out.println("Per Pixel Alphering is not support with Java " + version);
                System.exit(1);
            }
        } else {
            System.out.println("Per Pixel Alphering is not support with Java " + version);
            System.exit(1);
        }
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new BorderLayout());
        frame.add(new ImagePane());
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public static boolean supportsPerAlphaPixel() {

        boolean support = false;

        try {

            Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
            support = true;

        } catch (Exception exp) {
        }

        return support;

    }

    public static void setOpaque(Window window, boolean opaque) {

        try {

            Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
            if (awtUtilsClass != null) {

                Method method = awtUtilsClass.getMethod("setWindowOpaque", Window.class, boolean.class);
                method.invoke(null, window, opaque);

            }

        } catch (Exception exp) {
        }

    }

    public class ContentPane extends JPanel {

        public ContentPane() {
            setOpaque(false);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.RED);
            g.drawRect(0, 0, getWidth() - 1, getHeight() - 1);
        }

    }

    public class ImagePane extends JPanel {

        private BufferedImage background;
        private BufferedImage offImage;
        private Ellipse2D offButton;
        private boolean mouseIn;

        public ImagePane() {
            setOpaque(false);
            try {
                background = ImageIO.read(new File("tamagotchi400.png"));
                offImage = ImageIO.read(new File("powerSmall.png"));
            } catch (IOException ex) {
                ex.printStackTrace();
            }
            offButton = new Ellipse2D.Float(212, 330, 25, 25);
            MouseAdapter handler = new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    if (e.getClickCount() == 1 && e.getButton() == MouseEvent.BUTTON1) {
                        if (offButton.contains(e.getPoint())) {
                            Window window = SwingUtilities.getWindowAncestor(ImagePane.this);
                            if (window != null) {
                                window.dispose();
                            }
                        }
                    }
                }

                @Override
                public void mouseMoved(MouseEvent e) {
                    Cursor cursor = Cursor.getDefaultCursor();
                    if (offButton.contains(e.getPoint())) {
                        cursor = Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);
                    }
                    setCursor(cursor);
                }

                @Override
                public void mouseEntered(MouseEvent e) {
                    mouseIn = true;
                    repaint();
                }

                @Override
                public void mouseExited(MouseEvent e) {
                    mouseIn = false;
                    repaint();
                }

            };
            addMouseListener(handler);
            addMouseMotionListener(handler);
        }

        @Override
        public Dimension getPreferredSize() {
            return background == null ? new Dimension(400, 400) : new Dimension(background.getWidth(), background.getHeight());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (background != null) {
                Graphics2D g2d = (Graphics2D) g.create();
                int x = (getWidth() - background.getWidth()) / 2;
                int y = (getHeight() - background.getHeight()) / 2;
                g2d.drawImage(background, x, y, this);
                if (mouseIn && offImage != null) {
                    g2d.drawImage(offImage, (int) offButton.getX(), (int) offButton.getY(), this);
                }
                g2d.dispose();
            }
        }

    }

} 
```

该代码还包括透明度测试代码，用于测试现在在 Java 1.7 和 Java 1.6_10+ 中可用的透明度 API。我已经在许多项目中成功使用了此代码，它比 AWT 机器人“hack”更简单，并提供了一个实时背景，但这是您需要做出的选择。

**更新**

演示使用`java.awt.Frame`

![在此处输入图像描述](../Images/a38ea8d737dea33949ac7bf334af8d3c.png)

```
public class TestTransparentFrame {

    public static void main(String[] args) {
        new TestTransparentFrame();
    }

    public TestTransparentFrame() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception exp) {
                }

                Frame frame = new Frame("Test");
                frame.setUndecorated(true);
                setOpaque(frame, false);
                frame.addWindowListener(new WindowAdapter() {
                    @Override
                    public void windowClosing(WindowEvent e) {
                        System.exit(0);
                    }

                });
                frame.setLayout(new BorderLayout());
                frame.add(new ContentPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class ContentPane extends JPanel {

        private BufferedImage background;

        public ContentPane() {
            try {
                background = ImageIO.read(new File("duke.png"));
            } catch (IOException ex) {
                ex.printStackTrace();
            }
            setOpaque(false);
            JButton close = new JButton("Close");
            close.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    SwingUtilities.getWindowAncestor(ContentPane.this).dispose();
                }
            });
            setBorder(new LineBorder(Color.RED));
            setLayout(new GridBagLayout());
            add(close);
        }

        @Override
        public Dimension getPreferredSize() {
            return background == null ? new Dimension(200, 200) : new Dimension(background.getWidth(), background.getHeight());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (background != null) {
                g.drawImage(background, 0, 0, this);
            }
        }

    }

    public static boolean supportsPerAlphaPixel() {

        boolean support = false;
        String version = System.getProperty("java.version");
        if (version.startsWith("1.6")) {
            try {
                Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
                support = true;
            } catch (Exception exp) {
            }
        } else if (version.startsWith("1.7")) {
            try {
                Class<?> winTransClass = Class.forName("java.awt.GraphicsDevice$WindowTranslucency");
                Field field = winTransClass.getField("TRANSLUCENT");

                GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
                GraphicsDevice gd = ge.getDefaultScreenDevice();

                gd.isWindowTranslucencySupported(GraphicsDevice.WindowTranslucency.TRANSLUCENT);

                Method isWindowTranslucencySupported = GraphicsDevice.class.getMethod("isWindowTranslucencySupported", winTransClass);
                System.out.println(isWindowTranslucencySupported);

                Object value = isWindowTranslucencySupported.invoke(gd, field.get(null));
                if (value instanceof Boolean) {
                    support = ((Boolean) value).booleanValue();
                }

            } catch (Exception exp) {
            }
        }
        return support;
    }

    public static void setOpaque(Window window, boolean opaque) {

        String version = System.getProperty("java.version");
        if (version.startsWith("1.6")) {
            try {
                Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
                if (awtUtilsClass != null) {
                    Method method = awtUtilsClass.getMethod("setWindowOpaque", Window.class, boolean.class);
                    method.invoke(null, window, opaque);
                }
            } catch (Exception exp) {
            }
        } else if (version.startsWith("1.7")) {
            Color color = UIManager.getColor("Panel.background");
            if (opaque) {
                color = new Color(color.getRed(), color.getGreen(), color.getBlue());
            } else {
                color = new Color(color.getRed(), color.getGreen(), color.getBlue(), 0);
            }
            window.setBackground(color);
        }

    }

} 
```

在 Windows 7 Java 1.6 和 1.7、Mac OS 10.7.5 和 10.8.2 上测试，使用 JDK 1.7.0_07 和 1.6.0_37

看来您不了解 Java 中的窗口层次结构

Java 中的所有“窗口”都派生自`java.awt.Window`.

`JFrame`延伸`Frame`哪个延伸`Window`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T02:30:53.690

Using this line, it works:

```
AWTUtilities.setWindowOpaque(frame, false); 
```

Eclipse prints out a warning on this and I had to change some settings to comile it, so I guess there may be better ways. I read [here](http://www.visualinformation.org/2009/09/transparent-application-window-in-processing/), that this is supported since OS X 10.6 (Lion).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-03T10:20:31.590

似乎当你的框架没有对焦时，会触发阴影效果。尝试添加此代码，以便您的框架将无法获得焦点。

```
frame.setFocusableWindowState(false); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-28T20:02:37.857

我今天在 OSX 上遇到了 JInternalFrame 的影子问题，我在另一个论坛上找到了这个解决方案（在 Java 11、Catalina 10.15 上验证）

```
internalFrame.putClientProperty("JInternalFrame.frameType", "normal"); 
```

# web - 向浏览器的上下文菜单添加一个选项（浏览器的扩展）

> ID：13546646
> 
> 赞同：2
> 
> 时间：2012-11-24T23:17:51.243
> 
> 标签：web, google-chrome-extension, firefox-addon

我想为我的浏览器编写一个扩展，它为所选单词引起的上下文菜单添加了一个选项。这就是我想要实现的目标：

我从网站上的文本中选择一个词。我点击它鼠标右键。我在上下文菜单中看到了一个附加位置当我单击鼠标左键时，所选单词将保存在我的磁盘上，并且其中一个在线翻译器将打开该单词。

我更喜欢在 Chrome 或 Firefox 上编写它。

我应该用哪种语言写它？我在哪里可以找到教程？很难做到吗？一般来说，该怎么做？（我从未写过扩展）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T08:12:04.137

Chrome 有一个用于创建和操作上下文菜单的[API 。](https://developer.chrome.com/extensions/contextMenus.html)

我为上下文菜单编写了一个示例扩展（

> 它为所选单词引起的上下文菜单添加了一个选项

) 在 Chrome 中。

***清单.json***

```
{
  "name": "Context Menu Demo",
  "description": "This gives demo of context menu features",
  "version": "1",
  "permissions": ["contextMenus"],
  "background": {
    "scripts": ["sample.js"]
  },
  "manifest_version": 2,
  "icons":{"16":"screen.png","48":"screen.png","128":"screen.png"}
} 
```

***示例.js***

```
function reportclick(info,tab){
    // Do all you need here when clicked
    console.log("item " + info.menuItemId + " was clicked");
}
var item2=chrome.contextMenus.create({"title":"Search for %s in Context Menu","id":"item2","onclick": reportclick,"contexts":["selection"]  },function (){
        // Do what all you need here when created
        console.log("Context Menu 2 Created");
}); 
```

# java - 我可以在迭代时从列表中删除吗？

> ID：13546647
> 
> 赞同：1
> 
> 时间：2012-11-24T23:17:51.297
> 
> 标签：java

我有这个代码：

```
for(int i = 0; i < oldCars.size(); ++i)
    {
        if(oldCars.get(i).getVelocity().length() > 0.0f)
        {
            oldCars.get(i).update(timeStep);
        }
        else
        {
            oldCars.remove(i);
        }
    } 
```

它似乎工作正常，但它会在所有条件下工作吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-24T23:22:35.730

如果要在迭代时删除，请从末尾开始：

```
for(int i = oldCars.size() - 1; i >= 0; i--)
{
    if(oldCars.get(i).getVelocity().length() > 0.0f)
    {
        oldCars.get(i).update(timeStep);
    }
    else
    {
        oldCars.remove(i);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T23:20:29.033

我猜它不会更新所有条目。

如果您删除一个条目，您的`i`索引会上升，但是下一个条目也将具有当前`i`值。

```
oldcar 1
oldcar 2
oldcar 3 
```

删除“oldcar 1”，我将是 1，您检查的下一个条目是“oldcar 3”而不是“oldcar 2”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-24T23:24:01.787

```
 Iterator<T> it = oldCars.iterator();

    while (it.hasNext()) {
        T oldCar = it.next();
        if (oldCar.getVelocity().length() > 0.0f) {
            oldCar.update(timeStep);
        } else {
            it.remove();
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-25T03:16:26.317

您可以使用您的方法，但稍作修改。当您从列表中删除一个项目时，下一个项目将被跳过，因此您`i`每次删除一个项目时都必须递减。因此，您将拥有以下内容：

```
for(int i = 0; i < oldCars.size(); ++i)
{
    if(oldCars.get(i).getVelocity().length() > 0.0f)
    {
        oldCars.get(i).update(timeStep);
    }
    else
    {
        oldCars.remove(i--);
    }
} 
```

# c - Valgrind：大小为 4 -> sigsegv 的无效读取，在没有 valgrind 和 Visual Studio 的情况下工作正常

> ID：13546650
> 
> 赞同：21
> 
> 时间：2012-11-24T23:18:23.947
> 
> 标签：c, memory-leaks, visual-studio-2012, valgrind, priority-queue

我已经实现了一种压缩算法（使用霍夫曼编码），它使用节点的优先级队列（我定义的结构）。现在，当我在 linux 或 Visual Studio 中运行代码时，一切正常。当我在 Visual Studio 中检查内存泄漏时，没有给出。

现在的问题是，当我使用 valgrind 分析我的程序时，它以信号 11 (sigsegv) 终止。遇到的第一个错误是方法 delete min 中的“大小为 4 的无效读取”。之后的其他错误是：已释放大小为 453 的块内的地址为 0 字节，大小为 4 的无效写入，无效的释放、删除或重新分配。

谁能给我建议，我可能会犯什么样的错误？我已经在互联网上搜索了几个小时，但找不到我做错了什么（特别是因为它在不使用 valgrind 时才有效）。或提示如何调试并找出导致读取错误的原因。

非常感谢！

这是代码，以防有人想要查看它，但我想仅仅深入研究这个特定的代码并不容易。

我猜它与代码的优先级队列有关：

我做霍夫曼部分的部分 - >每次删除2个最小节点并将两者的总和添加回一个节点。

```
while(queue->size > 1){
    node* n1 = delete_min(queue);
    node* n2 = delete_min(queue); // all the errors are encountered in this call
    node* temp = (node*) calloc(sizeof(node),1);
    temp->amount = n1->amount + n2->amount;
    insert_node(queue,temp);
    n1->parent = temp;
    n2->parent = temp;
    temp->left = n1;
    temp->right = n2;
} 
```

这是优先级队列的 delete_min 和 insert_node 方法：

```
void insert_node(priority_queue* p_queue, node* x){
    int i = p_queue->size;
    if(i == 0){
        p_queue->queue = (node**) malloc(sizeof(node*));
    }
    else{
        p_queue->queue = (node**) realloc(p_queue->queue,sizeof(node*)*(p_queue->size+1));
    }
    p_queue->queue[p_queue->size] = x;

    while(i>=0 && p_queue->queue[i]->amount < p_queue->queue[(i-1)/2]->amount){
        node* temp = p_queue->queue[i];
        p_queue->queue[i] = p_queue->queue[(i-1)/2];
        p_queue->queue[(i-1)/2] = temp;
        i = (i-1)/2;
    }
    p_queue->size++;
}

node* delete_min(priority_queue* p_queue){
    node** queue = p_queue->queue;
    node* min = queue[0];

    if(p_queue->size>1){
        int r = 0;
        int current = 1; //left child of root

        queue[0] = queue[p_queue->size-1];
        queue = (node**) realloc(queue,sizeof(node*)*(--p_queue->size));
        while(current < p_queue->size){
            //in case of 2 children, check if current needs to be right or left child
            if(current < p_queue->size-1 && queue[current] > queue[current+1]){
                current++;
            } 
            if(queue[current] < queue[r]){
                node* temp = queue[r];
                queue[r] = queue[current];
                queue[current] = temp;

                r = current;
                current = 2 * current;
            }
            else{
                break;
            }
            current++;
        }
    }
    else{
        free(queue);
        p_queue->size--;
    }
    return min;
} 
```

编辑：添加了 valgrind 输出：

```
Invalid read of size 4
==1893==    at 0x80498E0: delete_min (huffman.c:331)
==1893==    by 0x80492DA: huffman_encode (huffman.c:196)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893==  Address 0x441d9a8 is 0 bytes inside a block of size 452 free'd
==1893==    at 0x402BC70: realloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==1893==    by 0x8049922: delete_min (huffman.c:335)
==1893==    by 0x80492CC: huffman_encode (huffman.c:195)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893== 
==1893== Invalid read of size 4
==1893==    at 0x8049901: delete_min (huffman.c:333)
==1893==    by 0x80492DA: huffman_encode (huffman.c:196)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893==  Address 0x441db64 is 444 bytes inside a block of size 452 free'd
==1893==    at 0x402BC70: realloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==1893==    by 0x8049922: delete_min (huffman.c:335)
==1893==    by 0x80492CC: huffman_encode (huffman.c:195)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893== 
==1893== Invalid write of size 4
==1893==    at 0x8049906: delete_min (huffman.c:333)
==1893==    by 0x80492DA: huffman_encode (huffman.c:196)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893==  Address 0x441d9a8 is 0 bytes inside a block of size 452 free'd
==1893==    at 0x402BC70: realloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==1893==    by 0x8049922: delete_min (huffman.c:335)
==1893==    by 0x80492CC: huffman_encode (huffman.c:195)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893== 
==1893== Invalid free() / delete / delete[] / realloc()
==1893==    at 0x402BC70: realloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==1893==    by 0x8049922: delete_min (huffman.c:335)
==1893==    by 0x80492DA: huffman_encode (huffman.c:196)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893==  Address 0x441d9a8 is 0 bytes inside a block of size 452 free'd
==1893==    at 0x402BC70: realloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==1893==    by 0x8049922: delete_min (huffman.c:335)
==1893==    by 0x80492CC: huffman_encode (huffman.c:195)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893== 
==1893== Invalid read of size 4
==1893==    at 0x8049A0E: delete_min (huffman.c:337)
==1893==    by 0x80492DA: huffman_encode (huffman.c:196)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
==1893== 
==1893== 
==1893== Process terminating with default action of signal 11 (SIGSEGV)
==1893==  Access not within mapped region at address 0x0
==1893==    at 0x8049A0E: delete_min (huffman.c:337)
==1893==    by 0x80492DA: huffman_encode (huffman.c:196)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32) 
```

第 331 行是 delete_min 中的行： node* min = queue[0];

编辑：

现在问题已经解决了。在接受的答案中，解释了原因。只需在 delete_min 中正确分配重新分配的值即可解决所有问题。

```
//realloc queue and assign new value to local queue var
p_queue->queue = (node**) realloc(queue,sizeof(node*)*(--p_queue->grootte));
queue = p_queue->queue; 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-25T10:41:40.283

我会向你解释第一个错误。

```
==1893== Invalid read of size 4
==1893==    at 0x80498E0: delete_min (huffman.c:331)
==1893==    by 0x80492DA: huffman_encode (huffman.c:196)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32) 
```

在第 331 行，您可能正在读取一个（无符号）int，它位于您尚未为自己的程序分配的内存的一部分中。

```
==1893==  Address 0x441d9a8 is 0 bytes inside a block of size 452 free'd
==1893==    at 0x402BC70: realloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==1893==    by 0x8049922: delete_min (huffman.c:335)
==1893==    by 0x80492CC: huffman_encode (huffman.c:195)
==1893==    by 0x8049DDE: encode_file (main.c:94)
==1893==    by 0x8049BBE: main (main.c:32)
==1893== 
```

这部分提供了有关您尝试读取的内存部分的更多信息。它说您已经使用了内存，但 reallox 释放了它。这意味着您正在从旧指针读取已重新分配的内存部分。

您应该确保使用指针 realloc 返回，而不是旧指针。

在 valgrind 之外运行时不会崩溃的原因是大多数时候，相同部分的内存将由 realloc 分配。所以指针保持不变，因此您的代码将起作用。然而，有时，realloc 会决定移动这部分内存，然后你的代码就会崩溃。Valgrind 正试图为此警告你。

当您使用返回的指针时，其余的错误可能会得到解决。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T23:30:50.310

根据您的 Valgrind 错误，您可能正在访问然后释放已删除的节点。您应该考虑使用相应的行号发布 Valgrind 错误（在 gcc 中使用 -g 编译），以便我们更轻松地为您提供帮助。

编辑：最明显的错误，段错误，是你应该开始调试的地方。此行失败：

```
while((2*i)+2 < p_queue->grootte-1 && (queue[i]->amount > queue[(2*i)+1]->amount || queue[i]->amount > queue[(2*i)+2]->amount)){ 
```

大概是因为`queue`是NULL。为什么它是空的？可能是因为 realloc 没有分配任何东西。为什么它没有分配任何东西？要么是因为内存不足（不太可能），要么是因为你试图分配大小为 0 的东西。（有关 realloc 的详细信息，请参见[http://www.cplusplus.com/reference/cstdlib/realloc/](http://www.cplusplus.com/reference/cstdlib/realloc/)）。你怎么能要求尺寸 0？如果`p_queue->size-1`是 0。

# linux - 杀死 ssh 会话会杀死正在运行的进程

> ID：13546651
> 
> 赞同：3
> 
> 时间：2012-11-24T23:18:26.653
> 
> 标签：linux, shell, ubuntu

我正在使用 ssh 连接到我的 ubuntu 服务器。我使用命令启动编码程序。但是，似乎当我的 ssh 会话关闭时（因为我在一台进入睡眠状态的笔记本电脑上启动它）。有没有办法避免这种情况（当然防止我的笔记本电脑休眠不是永久的解决方案）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T23:20:02.453

[`nohup`](http://en.wikipedia.org/wiki/Nohup)当您的程序生成一些日志输出时，使用或使用命令会更好，因为它会转发到文件，然后您可以检查它，但是使用屏幕您可以分离 ssh 会话，当您再次登录时，您可以恢复您的工作空间。对于编码，我将使用. 它更容易，你可能在后台运行它，所以你真的不需要分离[`screen`](http://en.wikipedia.org/wiki/GNU_Screen) `nohup``nohup`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T23:21:12.720

屏幕是最适合您的。

```
screen -S some_name 
```

比运行它。分离它： ctrl+ad

下次，附上：

```
screen -rd some_name 
```

您可以拥有更多正在运行的屏幕。要显示它们的列表：

```
screen -ls 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T23:22:13.850

在你的ubuntu服务器上安装“screen”，这样你就可以在你的会话中启动任何程序，从你当前的会话中断开程序的输出并退出。

稍后当您再次连接到服务器时，您可以恢复将继续运行的程序并查看其进度。

# opengl - 无法加载和保存矩阵Opengl

> ID：13546652
> 
> 赞同：0
> 
> 时间：2012-11-24T23:18:38.440
> 
> 标签：opengl, glut, freeglut

我有以下代码：

```
 void setupCamera() {

    // Clear the screen buffer
    glClear(GL_COLOR_BUFFER_BIT);

    // reset the projection matrix //
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    // and set the perspective with the current field of view,
    // and the current height and width
    gluPerspective(fov, ratio, objDepth - objRadius * 2,
            objDepth + objRadius * 2);
    glViewport(0, 0, WINDOW_SIZE, WINDOW_SIZE);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    if(first){
        glMultMatrixf(rotMatrix);

    }
    first = true;

    //translate everything to be in objDepth//
    glTranslatef(initX * 0.01, initY * 0.01, (-1) * objDepth);

    glRotatef(200 * angle, rotationVector[0], rotationVector[1],
            rotationVector[2]);

    glutWireTeapot(1.5);

    glGetFloatv (GL_MODELVIEW_MATRIX, rotMatrix);

    } 
```

旋转向量保持旋转轴，

translate 用于将所有内容移动到正确的位置。

问题是，我正在使用`glMultMatrixf`以使用保存的最后一个矩阵，

旋转然后平移，然后用 . 再次保存矩阵`glGetFloatv`。

这个函数经常用定时器调用，但出于某种原因

我想不通，矩阵不会保存任何东西并且总是一遍又一遍地初始化，

意味着旋转总是以小角度使用（因为不保存矩阵）。

保存的矩阵未在代码中的其他任何地方使用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T00:25:39.637

您是否每次都调用 setupCamera() ？如果你是，你可能想停下来。您不需要每帧都重置投影矩阵，除非您需要，否则您也不需要重置模型视图矩阵。考虑自行增加角度和平移，而不是存储整个矩阵。

您可能要采取的步骤是：

1）初始化矩阵。将投影初始化为身份并使用 gluPerspective。然后切换到模型视图并将其初始化为身份。这真的应该只做一次。

2）在你的更新循环中，增加你的角度和平移他们的代表变量。

3) 在你的绘图循环中，使用 glPushMatrix() 来推送模型视图矩阵。使用 gltranslate 和 glrotate 应用您的矩阵更改，然后绘制您正在绘制的任何内容。之后，glPopMatrix() 以返回身份。

我仍然不太明白您是否正在尝试绘制某些东西并认为您需要每帧读取、存储和恢复当前的 glMatrix，或者您是否真的在尝试评估 OpenGL 对矩阵的作用并且确实需要阅读出来。

# c - Malloc 为字符串 concat C 初始化 char 加一

> ID：13546654
> 
> 赞同：0
> 
> 时间：2012-11-24T23:18:57.740
> 
> 标签：c, malloc, concatenation

我在 stackoverflow 上找到了这个函数，它将两个字符串连接在一起。这是功能：

```
char* concatstring(char *s1,char *s2)
{
 char *result = malloc(strlen(s1)+strlen(s2)+1);
 strcpy(result,s1);
 strcat(result,s2);
 return result;
} 
```

我的问题是，为什么我们在 malloc 调用中加 1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:22:28.913

这是因为在 C 中，“字符串”存储为字符数组，后跟一个空字节。这是约定俗成的。因此，空字节可能不会出现在任何 C 字符串中。

但是，实际字符串本身不包含空字节（这只是字符串*表示*的一部分），因此会`strlen`报告字符串*中非空*字节的数量。要创建一个连接两个字符串的 C 字符串，您需要为空终止符留出空间。

事实上，*每个*字符串操作都需要以某种方式处理空终止符。不幸的是，细节因函数而异（例如`snprintf`，它是否正确，但`strncpy`危险地不同），您应该非常仔细地阅读每个函数的手册，以了解谁负责处理空终止符以及如何处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T23:21:25.177

您需要为用于终止 C 中的字符串的 '\0'（NULL 字符）分配空间。

即字符串“cat”实际上是“cat\0”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:25:25.123

如果字符串是“猫”：

```
char * mystring = "cat"; 
```

然后 strlen(mystring) 将返回 3。

但实际上存储 mystring 需要 4 个字节，存储空字符需要 1 个字节。

因此，如果您有两个字符串，“dog”和“cat”，它们的长度将是 3 和 3 ，尽管存储它们所需的字节数各为 4。存储它们的连接所需的内存为 3+3 +1 = 7。

所以 malloc 中的 1 是分配额外的字节来存储空字符。

# ubuntu - 在Virtualbox中使用Ubuntu进行开发，稳定安全吗？

> ID：13546656
> 
> 赞同：3
> 
> 时间：2012-11-24T23:19:17.100
> 
> 标签：ubuntu, virtualization, virtualbox

我已经双启动 Ubuntu 和 Windows 7 很长一段时间了，老实说，我对此感到恼火，我一直在寻找替代方案。我目前想知道 virtualbox 是否足够稳定，可以用于开发。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:42:26.520

我已经在虚拟盒子中使用 Ubuntu 快一年了。没问题。我主要只是使用 eclipse 和 vim 以及命令行的东西。这对我来说做得很好，而且我认识很多其他人也这样做并且没有遇到任何问题。

虚拟盒子就是炸弹。

尽管出于某种原因，我拥有的处理器不支持虚拟化 64 位操作系统，即使它是 64 位 i5... 奇怪的东西，但运行 32 位 ubuntu 对我来说并不是什么大问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:34:49.880

在 virtualbox 中，您可以安装任何您想要的操作系统（Mac OS 除外）。您可以使用向导创建虚拟机并选择您的选项。之后，您必须在此虚拟机中安装带有 ISO 映像或 CD/DVD 的 Ubuntu。在虚拟机中安装操作系统后，您可以安装提供一些虚拟化功能的来宾添加。它可以正常工作并且稳定。唯一的缺点是性能，因为您的机器上同时有两个操作系统（需要 RAM 和其他资源）。

# javascript - jquery 悬停打开关闭微型窗口

> ID：13546657
> 
> 赞同：0
> 
> 时间：2012-11-24T23:19:18.923
> 
> 标签：javascript, jquery, html

```
 <div id="pop">
 <ul>
      <li>Item 1</li>
      <li>Item 2</li>
      <li>Item 3</li>
      <li>Item 4</li>
      <li>Item 5</li>
      <li>Item 6</li>
      <li>Item 7</li>
 </ul>
 </div>
 <div id="info-1></div>
 <div id="info-2></div> 
```

当您将鼠标悬停在其中一个项目上时，会显示一个窗口，其中包含有关该项目的一些信息。我已经为一个项目解决了这个问题，现在我想知道如何让这个项目适用于整个列表。

我最初的想法是为每个项目创建一个脚本......但考虑到 js 的功能，这似乎有点厚。

Javascript

```
 $(function(){
 $('pop il li').hover(function(){
      $('#info-1').show();
 },function(){
      $('#info-1').hide();
 }); 
```

});

现在我需要以下内容。一旦悬停时显示“窗口”，我需要窗口以某种方式保持打开状态，以便我能够使用鼠标滚动浏览内容。这主要是因为我里面有一些链接，需要访问它们！现在，只要我离开 li 项目，窗口当然会消失......这并不好玩。那么，我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:54:38.473

**更新**

我会做一个函数来处理你想要的动作。确保 'info' div 与 'pop' li 的顺序相同

这是一个示例[**FIDDLE**](http://jsfiddle.net/videsignz/FrKBJ/2/)

```
<div id="pop">
<ul>
  <li>Item 1</li>
  <li>Item 2</li>
  <li>Item 3</li>
  <li>Item 4</li>
  <li>Item 5</li>
  <li>Item 6</li>
  <li>Item 7</li>
</ul>
</div>

<div class="info"></div>
<div class="info"></div>
<div class="info"></div> 
```

然后使用这个jquery

```
$('#pop li').mouseover(function() {
    $('.info').hide();
    var x = $(this).index();
    $('.info').eq(x).show();
});

$('.info').mouseout(function(){
    $(this).hide();
}); 
```

# c++ - 实现一个用于在图中存储边的高效容器

> ID：13546658
> 
> 赞同：1
> 
> 时间：2012-11-24T23:19:28.437
> 
> 标签：c++, performance, algorithm, graph, dijkstra

我需要有效地在`std::set<Edge>`. Edge 表示图中的一条边（不是多重图）。

```
class Edge
    {
        friend class Graph;
        string from;
        string to;
        EdgeInfo edge_length; //constructor is `EdgeInfo(int edge_length)`
    public:
        bool operator==(const Edge& rhs) {
            return (from==rhs.from && to==rhs.to);               
        }
    }; 
```

问题是如何有效地找到

*   是否`std::set<Edge>`包含给定“from”和“to”的边
*   从给定的“from”到某个“to”的边，其中“to”不在给定的内部`set<string>`

使用`std::set.count()`和`std::set.find()`。我需要以某种方式在`std::set`. 这可能吗？

* * *

**编辑**：我想我应该使用`map`or`multimap`而不是`set`. 最终我使用了`map`. 该解决方案的灵感来自@tom 建议使用`map of maps`.

* * *

**解决方案**：

```
typedef int EdgeInfo; //just for the sake of this example (EdgeInfo can be length,price,...) 
map< string, map<string, EdgeInfo> > edges; 
```

> 是否`std::set<Edge>`包含给定“from”和“to”的边

```
if (edges.count(from)!=0 && edges[from].count(to)!=0) {
        return true; 
} 
```

或者如果函数是`const`

```
if (edges.count(from)!=0 && ((edges.find(top.second))->second).count(to)!=0) {
        return true; 
} 
```

> 从给定的“from”到某个“to”的边，其中“to”不在给定的集合内

如果功能是`const`

```
//if there are any edges from "from"
if (edges.count(from)!=0) {  

    //iterate over all edges from "from"
    for (map<string,EdgeInfo>::const_iterator
                 edge=((edges.find(from))->second).begin();
                 edge!=((edges.find(from))->second).end();
                 ++edge) {

        //if the edge goes to some vertex V that has not been discarded
        if (discarded.count(edge->first)==0) { //edge->first means "to" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T00:31:37.880

### 邻接表

```
map< string, set<string> > edges;
// edges["a"] is the set of all nodes that can be reached from "a"

// O(log n)
bool exists(string from, string to)
{
    return edges[from].count(to) > 0;
}

// Ends of edges that start at 'from' and do not finish in 'exclude', O(n)
set<string> edgesExcept(string from, set<string>& exclude)
{
    set<string>& fromSet = edges[from];
    set<string> results;
    // set_difference from <algorithm>, inserter from <iterator>
    set_difference(fromSet.begin(), fromSet.end(),
            exclude.begin(), exclude.end(),
            inserter(results, results.end()));
    return results;
} 
```

### 邻接矩阵

```
map< string, map<string, Edge*> > edgesMatrix;
// edgesMatrix["a"]["b"] is the Edge* from "a" to "b"
// e.g. Edge* e = new Edge(...); edgesMatrix[e->from][e->to] = e;

bool exists(string from, string to)
{
    return edgesMatrix[from].count(to) > 0;
}

vector<Edge*> edgesExcept(string from, set<string>& exclude)
{
    map<string, Edge*>& all = edgesMatrix[from];
    vector<Edge*> results;

    map<string, Edge*>::iterator allIt = all.begin();
    set<string>::iterator excludeIt = exclude.begin();

    while (allIt != all.end())
    {
        while (excludeIt != exclude.end() && *excludeIt < allIt->first)
        {
            ++excludeIt;
        }

        if (excludeIt == exclude.end() || allIt->first < *excludeIt)
        {
            results.push_back(allIt->second);
        }
        ++allIt;
    }

    return results;
} 
```

### 一组有序

这更符合OP的原始要求，但我觉得它比其他选项丑得多。
为了完整起见，我将其包括在内。

```
// sorted first by 'from', then by 'to'
class Edge {
    // ...
public:
    bool operator<(const Edge& r) const {
        return from < r.from || (from == r.from && to < r.to);
    }
};

set<Edge> edges;

bool exists(string from, string to) {
    Edge temp(from, to, -1);
    return edges.count(temp) > 0;
}

set<Edge> edgesExcept(string from, set<string>& exclude) {
    Edge first = Edge(from, "", -1); // ugly hack: "" sorts before other to's
    set<Edge> results;

    set<Edge>::iterator allIt = edges.lower_bound(first);
    set<string>::iterator excludeIt = exclude.begin();

    while (allIt != edges.end() && allIt->from == from) {
        while (excludeIt != exclude.end() && *excludeIt < allIt->to) {
            ++excludeIt;
        }
        if (excludeIt == exclude.end() || allIt->to < *excludeIt) {
            results.insert(results.end(), *allIt);
        }
        ++allIt;
    }
    return results;
} 
```

### 的解释`edgesExcept()`

这是一个伪代码版本：

```
for each edge e in edges_of_interest (in sorted order)
    get rid of edges in exclude_edges that sort before e
    if e is equal to the first edge in exclude_edges
        e is in exclude_edges, so
        ignore e (i.e. do nothing)
    otherwise
        e is not in exclude_edges, so
        add e to good_edges 
```

C++ 版本并没有实际从 中删除不再相关的边，而是`exclude_edges`使用迭代器来记住其中的哪些边`exclude_edges`不再相关（那些小于尚未检查的所有感兴趣的边）。一旦其中的所有边`exclude_edges`都小于`e`已被删除/跳过，检查是否`e`出现`exclude_edges`可以简单地通过将其与 的第一个（最小）元素进行比较来完成`exclude_edges`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:47:09.197

出于什么原因，您应该为此类工作使用多图？我认为 Map 就足够了，如果我理解得很好，您不需要在图表上保留相同的节点。

如果您决定使用地图，很容易找到现有边缘以及您的第二个问题。您只需要搜索密钥并迭代您的地图。使用Set，元素以随机顺序插入，因此，这意味着您的搜索时间很长（O（N）。如果您将元素存储在地图中（我认为最好的方法是使用“from”作为键），插入将被订购，您的搜索使用 O(Log n) 的时间

如果您需要修改图表中的连接，如果它们在集合中，则无法修改集合元素，在地图中您可以。

# php - php://input 返回空

> ID：13546660
> 
> 赞同：5
> 
> 时间：2012-11-24T23:19:39.087
> 
> 标签：php, rest, backbone.js, kohana

我有主干应用程序。当模型更新 PUT 请求到达我的服务器时。

![在此处输入图像描述](../Images/d2462aa7c88f4830ef42292304401f53.png)

客户端看起来不错。但是在服务器端（PHP）我遇到了一些麻烦。当我第一次在 PHPStorm 中测试这个请求时：

```
file_get_contents('php://input') 
```

返回我所期望的。但在其他时候，它总是返回空。我重新启动了 Apache - 没有任何帮助。

我知道

> 注意：使用 php://input 打开的流只能读取一次；

但我认为这意味着一个请求。一生不一次:)我的错误在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T10:50:24.607

这是Kohana的问题。在 Kohana_Request 类中有一段代码，已经打开了 php://input 流

```
if ($method !== HTTP_Request::GET)
{
    // Ensure the raw body is saved for future use
    $body = file_get_contents('php://input');
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-28T09:33:37.980

您应该使用`$this->request->body()`来获取请求正文。

# c# - 必应地图控件是否依赖于 Internet？

> ID：13546661
> 
> 赞同：0
> 
> 时间：2012-11-24T23:19:43.063
> 
> 标签：c#, windows-store-apps, bing-maps

Bing Maps 控件是否依赖于 Internet 连接，或者它们是否包含其世界地图以及“嵌入”到控件中的缩放、滚动和变形其演示样式（空中、鸟瞰、道路）的能力？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T01:07:46.680

为 silverlightcontrol 说话：是的，没有 Internet 连接，bingmap-control 就无法工作！此外，您需要一个 API 密钥，它可以使您的底层数据访问合法化。Dataexchange 依赖于 Web 服务。

此致

# html - ios应用程序使用json从数据库中读取html数据

> ID：13546663
> 
> 赞同：0
> 
> 时间：2012-11-24T23:19:57.143
> 
> 标签：html, ios, database

我在云中有一个数据库，我正在从中读取数据。其中一个字段包含带有 html 标签的 html 表格信息。我想在 ios 应用程序中显示它。

我如何以及在 ios 应用程序中将这些数据读入什么？文本视图？或者它会处理文本中的html标签并将数据显示为表格吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T01:25:39.303

使用[UIWebView](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html)并将您的 html 作为字符串加载到其中。

# javascript - 在 setInterval() 中调用时，HTML5 音频播放功能在 iPad 中不起作用

> ID：13546666
> 
> 赞同：2
> 
> 时间：2012-11-24T23:20:10.577
> 
> 标签：javascript, html5-audio

```
 setInterval('playSound()',2000);

                             function playSound(){

                                            var sound=new Audio('song.mp3');
                                                          sound.play();

                              } 
```

这适用于 chrome，但不适用于 ipad 应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T00:16:14.413

您无法在 iOS 上以编程方式触发音频或视频元素的播放。我曾经写过一篇关于它的[博文。](http://uxebu.com/blog/2011/11/29/state-of-html5-audio-in-ios-5/)

> 悲伤，但真实。[Apple 特意决定](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/ControllingMediaWithJavaScript/ControllingMediaWithJavaScript.html#//apple_ref/doc/uid/TP40009523-CH3-SW5)加载和播放音频必须有一个触摸事件。没有解决方法。

有三种方法可以规避这一点（至少以某种方式），所有这些都在帖子中描述：

1.  将 touchstart 事件绑定到正文
2.  热插拔源
3.  使用音频精灵

当然你也可以使用 PhoneGap/Cordova 来包装你的 App。Cordova.plist 中有一个名为“MediaPlaybackRequiresUserAction”的设置。只需将其设置为“否”。

# shell - 自定义 Oh My Zsh 主题：长提示消失/切断

> ID：13546672
> 
> 赞同：9
> 
> 时间：2012-11-24T23:21:11.783
> 
> 标签：shell, themes, zsh, prompt

我之前尝试过制作自己的 Oh My Zsh 主题。一切都很好，除非我在提示符中键入长行（比下面看到的行长），该行消失了。但是，如果我调整窗口大小，该行会重新出现。

我的主题中有什么导致这种情况发生吗？

![](../Images/ce1e9fa709fd671ae69fd5176b9004d1.png)

如果我输入一个额外的字符然后删除一个，光标会出现在窗口的边缘。

![](../Images/5a24982b78b1a054f761761ac80aa346.png)

您可以[在此处查看主题的代码](https://github.com/OliverJAsh/SolarizedZSH)。这是我认为我们关心的一点：

```
# Build the prompt
PROMPT='
' # Newline
PROMPT+='${style_user}%n' # Username
PROMPT+='${style_chars}@' # @
PROMPT+='${style_host}%m' # Host
PROMPT+='${style_chars}: ' # :
PROMPT+='${style_path}%c ' # Working directory
PROMPT+='$(git_custom_status)' # Git details
PROMPT+='
' # Newline
PROMPT+='${style_chars}\$${RESET} ' 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-06T05:16:19.507

顺便说一句，您的链接已损坏，突出显示了发布代码链接而不是代码本身的问题之一 - 您问题的任何未来查看者都无法全面了解。

我认为您的问题是您使用的“颜色”字符应该在一对中转义[`%{...%}`](http://www.manpagez.com/man/1/zshmisc/)：

```
%{...%}
Include  a string as a literal escape sequence.  The string within the braces
should not change the cursor position.  Brace pairs can nest. 
```

[使用你在 github 上](https://github.com/OliverJAsh/SolarizedZSH/blob/master/solarized.zsh-theme)的最新提交，我没有看到这个问题 - 你解决了吗？但是，我发现光标放置和线条绘制存在一些问题，尤其是`TAB`. 按下`TAB`时，光标向上移动一行：

![在此处输入图像描述](../Images/06487cacf2355268bc7c2b92cead70ca.png) 压`TAB`在这里。 ![在此处输入图像描述](../Images/2c05dc6841d02b785ec2359465849aa6.png) 压`TAB`在这里。 ![在此处输入图像描述](../Images/bc48dca4156f5cdd93afec522ea1efe0.png)

`PROMPT`每次都重新“向上”绘制一条线。这是通过将颜色代码封装在以下内容中来解决的`%{...%}`：

```
# Solarized Dark colour scheme
BOLD="%{$(tput bold)%}"
RESET="%{$(tput sgr0)%}"
SOLAR_YELLOW="%{$(tput setaf 136)%}"
SOLAR_ORANGE="%{$(tput setaf 166)%}"
SOLAR_RED="%{$(tput setaf 124)%}"
SOLAR_MAGENTA="%{$(tput setaf 125)%}"
SOLAR_VIOLET="%{$(tput setaf 61)%}"
SOLAR_BLUE="%{$(tput setaf 33)%}"
SOLAR_CYAN="%{$(tput setaf 37)%}"
SOLAR_GREEN="%{$(tput setaf 64)%}"
SOLAR_WHITE="%{$(tput setaf 254)%}" 
```

如果没有原版，我不能 100% 确定`~/.zshrc`，但这应该会稍微改善您的提示。:)

除了橙色，您还可以使用基于终端的*配置*`Solarized`文件和`zsh` `colors`可能更便携的配置文件。但是，如果没有 ，我将无法获得正确的橙色。*`tput`*

 *```
#autoload colors && colors
#SOLAR_YELLOW="%{$fg[yellow]%}"
#SOLAR_ORANGE="%{$(tput setaf 166)%}"
#SOLAR_RED="%{$fg[red]%}"
#SOLAR_MAGENTA="%{$fg[magenta]%}"
#SOLAR_VIOLET="%{$fg_bold[magenta]%}"
#SOLAR_BLUE="%{$fg[blue]%}"
#SOLAR_CYAN="%{$fg[cyan]%}"
#SOLAR_GREEN="%{$fg[green]%}"
#SOLAR_WHITE="%{$fg[white]%}" 
```*

# php - Facebook 应用程序致命错误：未捕获的 OAuthException：

> ID：13546678
> 
> 赞同：0
> 
> 时间：2012-11-24T23:21:27.680
> 
> 标签：php, facebook, facebook-graph-api, facebook-javascript-sdk

首先，我对用户进行身份验证并获得对 index.php 的权限，并在验证用户身份后重定向到应用程序工作的 action.php。

我收到这个错误

> 致命错误：未捕获的 OAuthException：必须使用活动访问令牌来查询有关当前用户的信息。扔在 /home/flysw4fr/public_html/event/facebook.php

这个应用程序两年前运行良好，现在不再运行

这是我的 action.php 代码

```
 <?php

require_once('config.php');

if(!$_SESSION['init']){
    die;
}

unset($_SESSION['init']);

require_once('facebook.php');

$data = loaddata();
$facebook = new Facebook(array(
  'appId'  => $fbappid,
  'secret' => $appsecret,
  'cookie' => true,
));

$friendsdate = $facebook->api('/me/friends');
if($friendsdate && $friendsdate['data'] && count($friendsdate['data'])){
    $friends = array();
    foreach($friendsdate['data'] as $f){
        $friends[] = $f['id'];
    }

    sleep(3);

    $session = $facebook->getSession();
    $params = array('name' => $data['name'], 
                     'start_time' => $data['start_time'], 
                     'end_time' => $data['end_time'],
                     'description' => $data['description']);
    if($data['source']){
        $params['source'] = '@'.realpath('image/'.$data['source']);
        $facebook->setFileUploadSupport(true);
    }
    $result = $facebook->api('/me/events', 'POST', $params);

    sleep(4);
    $eid = $result['id'];

    $params = array(
        'access_token' => $facebook-> getAccessToken(),
        'eid' =>$eid,
        'api_key' => $fbappid,
        'uids'=> implode(',', $friends),
        'format'=>'json-strings',
        'personal_message'=> $data['personal_message']
    );

    $url = 'https://api.facebook.com/method/events.invite';
    $facebook->setFileUploadSupport(false);
    $result = $facebook->makeRequest($url, $params);
}

header('Location: '.$data['url']); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T13:16:20.017

您应该认真更新您的代码并使用当前的 SDK 版本，或者您可以使用 opengraph。

Facebook::getSession 现在已经过时了，2 年前还没有。（这个应用程序在两年前运行良好，现在不再运行了：-/）

# c++ - std::shared_ptr 用于 std::map 中的值破坏我的对象

> ID：13546680
> 
> 赞同：4
> 
> 时间：2012-11-24T23:21:55.290
> 
> 标签：c++, map, shared-ptr

我在使用以下函数调用时遇到了一些代码问题：

```
User::User(const Socket::SocketAddress& addr) {
    address = addr;
    _usersListBySession.insert(std::pair<uint32_t, std::shared_ptr<User>>(sessionID, std::shared_ptr<User>(this)));
    assert(this->address == addr); // succeeds
    _userListByAddress.insert(std::pair<Socket::SocketAddress, std::shared_ptr<User>>(addr, std::shared_ptr<User>(this)));
    assert(this->address == addr); // fails
} 
```

我通过这样做解决了这个问题：

```
User::User(const Socket::SocketAddress& addr) {
    address = addr;
    std::shared_ptr<User> user(this);
    _usersListBySession.insert(std::pair<uint32_t, std::shared_ptr<User>>(sessionID, user));
    assert(this->address == addr); // succeeds
    _userListByAddress.insert(std::pair<Socket::SocketAddress, std::shared_ptr<User>>(addr, user));
    assert(this->address == addr); // succeeds
} 
```

我做了什么，为什么它会起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:29:28.847

在您的第一个示例中，您分配`this`给两个不同`std::shared_ptr`的 s，从而产生一个 double `delete`。

在您的第二个示例中，您分配`this`给*one* `std::shared_ptr user`，当您将其作为要插入的参数时，它会得到正确的引用计数。

# ruby-on-rails - 如何覆盖 gem 控制器操作 Ruby on Rails？

> ID：13546682
> 
> 赞同：2
> 
> 时间：2012-11-24T23:21:56.690
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, gem

我有用于用户身份验证的**设计**gem。基本上，我想在本地覆盖 Devise gem 中的 registrations_controller.rb。gem中的代码：

```
class Devise::RegistrationsController < DeviseController
   ...
    def update
        ...(need to override)
    end
end 
```

**如果选择了edit_form**中的特定属性，我想将用户重定向到其他页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:27:53.180

我建议不要覆盖该方法。相反，请查看有关配置文件编辑后自定义重定向的[Wiki 页面。](https://github.com/plataformatec/devise/wiki/How-To%3a-Customize-the-redirect-after-a-user-edits-their-profile)它解释了重写此方法：

```
def after_update_path_for(resource)
  user_path(resource)
end 
```

您可以根据您的属性返回不同的路径，例如

```
def after_update_path_for(resource)
  resource.foo? ? foo_path : bar_path
end 
```

# actionscript-3 - 命中测试反弹

> ID：13546692
> 
> 赞同：0
> 
> 时间：2012-11-24T23:23:27.930
> 
> 标签：actionscript-3, flash, 2d-games

我正在尝试为 Flash 制作一种气球格斗游戏。我在屏幕顶部有一个天花板，所以当玩家击中它时，它应该会从上面反弹。问题是，我不知道该怎么做。这是代码。

我在乱搞数字。在问题所在的 upBumping 变量中，我想让角色在击中后反弹，但它只执行一次。之后，它只是穿过天花板。也许我正在以错误的方式解决这个问题？

```
//gravity and stuff
var gravity:Number = 0.3;
var fall:Number = 0.3;
var downBumping:Boolean = false;
var upBumping:Boolean = false;

//direction I guess
var leftKeyDown:Boolean = false;
var upKeyDown:Boolean = false;
var rightKeyDown:Boolean = false;
var spaceKeyDown:Boolean = false;

//character movement ya'll
var mainSpeed:Number = 6;

stage.addEventListener(Event.ENTER_FRAME, game);
stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDownHandler);
stage.addEventListener(KeyboardEvent.KEY_UP, keyUpHandler);

function game(e:Event): void{

//if certain keys are down then move dat fool
    if(leftKeyDown){
        Monkey.x -= mainSpeed;
    }
    if(rightKeyDown){
        Monkey.x += mainSpeed;
    }
    if(upKeyDown){

        fall = fall-0.9;
        gravity = 0.3;
    }
    if(Floor.hitTestObject(Monkey)){
        downBumping = true;
        trace("downBumping");
    }
    if(Ceiling.hitTestObject(Monkey)){
        upBumping = true;
        trace("upBumping");
        trace(Monkey.y);
    }
    if(upBumping){
        Monkey.y += 20;
    }
    Monkey.y = Monkey.y+fall;
    gravity = gravity*1.0;
    fall = fall+gravity;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T03:03:10.277

这是我将如何进行跳跃和弹跳的方法-这不包括其他代码，例如从左向右移动，因为您已经掌握了

```
function game(e:Event):void {
    if(jumping){
        yVelocity += 0.1; //gravity
        Monkey.y += yVelocity;
        if(Floor.hitTestObject(Monkey)){
            jumping = false;
            while(Floor.hitTestObject(Monkey)){
                y--;
            }
        }
        if(Ceiling.hitTestObject(Monkey)){
            yVelocity = 0;
            while(Ceiling.hitTestObject(Monkey)){
                y++;
            }
        }
    }
    if(upKeyDown && !jumping){
        jumping = true;
        yVelocity = -3;
    }
} 
```

显然，声明此示例中使用的变量。

# c++ - 从 QGraphicsItem 派生类绘制 QGraphicsScene

> ID：13546698
> 
> 赞同：0
> 
> 时间：2012-11-24T23:24:24.860
> 
> 标签：c++, qt, qgraphicsview, qgraphicsscene

我正在使用图形视图框架在 Qt 中开发 RPG 游戏。我创建了一个类“Player”，它继承了 QGraphicsItem。现在，我正在尝试制作一个“攻击”动画，所以每次我按空格键时，角色前面都会有一个动画。我已经使用“advance()”函数实现了移动动画。

因此，每次我按空格键时，“is_attacking”变量都会变为真。每 85 毫秒，程序检查“is_attacking”是否为真，如果是，动画将前进（绘制下一帧）并更新。当所有帧都被使用时，“is_attacking”变为假。

问题是我不能使用“播放器”类来绘制动画。QGraphicsItem 是独立的，有自己的坐标系。我已经完成了攻击系统，但我无法将动画绘制到场景中。

```
void Player::paint(QPainter *painter, const QStyleOptionGraphicsItem *option, QWidget *widget){

painter->drawPixmap(QRect(0, 0, 32, 32), *pixmap, QRect(position.x(), position.y(), 32, 32));

if(its_attacking()){
    switch(pos){
case NORTH: // draw animation frame to x, y - 32
break;
case SOUTH: // draw animation frame to x, y + 32
break;
case WEST: // draw animation frame to x - 32, y
break;
case EAST: // draw animation frame to x + 32, y

     }

   } 

} 
```

我如何使用 QGraphicsItem 中的“paint()”来绘制该项目所属的 QGraphicsScene？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T12:49:54.700

[`paint()`](http://doc.qt.digia.com/qt/qgraphicsitem.html#paint)用于以**局部坐标**绘制项目。更改项目位置所需的[`setPos()`](http://doc.qt.digia.com/qt/qgraphicsitem.html#setPos)功能是设置项目在父坐标中的位置。

动画不应在`paint()`函数中处理（除非您想更改项目的位置），而是在计时器超时时调用的插槽中处理：

```
// Slot called at 85 ms timer's timeout
void Player::timerTimeoutSlot()
{
   if(its_attacking()){
      switch(pos){
        case NORTH: // draw animation frame to x, y - 32
            setPos(QPointF(pos().x(), pos().y()-32);
            break;
        case SOUTH: // draw animation frame to x, y + 32
            setPos(QPointF(pos().x(), pos().y()+32);
            break;
        case WEST: // draw animation frame to x - 32, y
            setPos(QPointF(pos().x()-32, pos().y());
            break;
        case EAST: // draw animation frame to x + 32, y
            setPos(QPointF(pos().x()+32, pos().y());
            break;
     }
   }
} 
```

请注意，为了启用信号/插槽，您应该继承自[`QGraphicsObject`](http://doc.qt.digia.com/qt/qgraphicsobject.html)而不是[`QGraphicsItem`](http://doc.qt.digia.com/qt/qgraphicsitem.html).

# python - 从 mongoDB 中提取信息

> ID：13546699
> 
> 赞同：1
> 
> 时间：2012-11-24T23:24:30.023
> 
> 标签：python, mongodb, pymongo

我有一个 mongoDB 并将坐标存储在一个集合中。如果我做：

```
 print doc["coordinates"] 
```

它返回：

```
{u'type': u'Point', u'coordinates': [-81.4531344, 28.5287337]} 
```

但如果我只想要单独的经度和纬度，我试图通过以下方式提取它：

```
print doc["coordinates" : [0][1]] 
```

我什么也没打印。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:39:01.813

我不熟悉 mongoDB，但如果返回的结构是 Python 字典，您可以像这样访问坐标：

```
print doc['coordinates']['coordinates'] 
```

`doc`似乎是一个字典字典，当你访问元素时`coordinates`，你会得到另一个字典，在这个字典里面是另一个`coordinates`包含实际坐标列表的键（类似地，如果你想要`type`，你可以说`print doc['coordinates']['point']`）。

假设它们是`lat, long`格式的，你可以做这样的事情来把它们拉到自己的变量中（这可能不适合你的情况，所以请随意忽略:)）：

```
lat, long = doc['coordinates']['coordinates'] 
```

# file - Matlab：改进树遍历代码

> ID：13546701
> 
> 赞同：1
> 
> 时间：2012-11-24T23:24:52.177
> 
> 标签：file, matlab, data-structures, tree

我的结构如下所示：

![数据库结构](../Images/121e1a84a9395e53357d9e48290b1d46.png)

我有一个`database`文件夹，其中包含`brands`. 每个`brand`由`logo`和组成`query`。我想遍历所有文件（`file_1`to `file_n`）`database`并对它们执行一些操作。

我写了这段代码：

```
d = dir(database);
isub = [d(:).isdir];
brandsFolders = {d(isub).name}';
brandsFolders(ismember(brandsFolders,{'.','..'})) = [];
[numberOfBrands not_used]=size(brandsFolders); %holds the number of the brands
for i=1:numberOfBrands
    temp=strcat(database,  '\');
    currentBrand=strcat(temp, brandsFolders(i));
    d = dir(currentBrand{1,1});
    isub = [d(:).isdir];
    logoAndQuery = {d(isub).name}';
    logoAndQuery(ismember(logoAndQuery,{'.','..'})) = [];
    logo=strcat(currentBrand, '\', logoAndQuery(1));
    files=dir(logo{1,1});
    [numberOfFiles not_used]=size(files);
    for j=1:numberOfFiles
        if strcmp(files(j).name, '..')~=1 && strcmp(files(j).name, '.')~=1
            %operations on each files(j).name
        end
    end
end 
```

该代码*工作正常*，它遍历所需的文件。但是，代码有点丑陋和令人困惑。

**我想知道我是否可以用另一种更好的方式来做到这一点？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T02:16:12.053

遍历一组目录的过程与您所做的差不多。但是，imo，您可以更轻松地做一些事情/我会做不同的事情：

```
brandsFolders = dir(database);
brandsFolders( ~[brandsFolders.isdir] | strcmp({brandsFolders.name},'.') | strcmp({brandsFolders.name},'..')) = [];

for ii=1:numel(brandsFolders)
    logoAndQuery  = dir(fullfile(database,brandsFolders(ii).name));
    logoAndQuery( ~[logoAndQuery.isdir] | strcmp({logoAndQuery.name},'.') | strcmp({logoAndQuery.name},'..')) = [];

    logo = fullfile(databasecurrentBrand,brandsFolders(ii).name), logoAndQuery(1).name);
    files = dir(logo);
    files(strcmp({files.name},'.') | strcmp({files.name},'..'))=[];

    for jj=1:numel(files)
        %operations on each files(j).name
    end
end 
```

（这当然只有在您确定它`logoAndQuery(1)`始终是“logo”目录时才有效。）
或者使用子函数进行目录查询：

```
function dirs = getDirs(strPath)
    dirs = dir(strPath);
    dirnames = {dirs.name};
    dirs ( ~[dirs.isdir] | strcmp(dirnames ,'.') | strcmp(dirnames ,'..')) = [];
end 
```

它已经为您提供了一些较短的代码并提供了以下内容，其中我还假设“logo”目录中没有目录：

```
brandsFolders = getDirs(database);

for ii=1:numel(brandsFolders)
    logoAndQuery  = getDirs(fullfile(database,brandsFolders(ii).name));
    logo = fullfile(databasecurrentBrand,brandsFolders(ii).name), logoAndQuery(1).name);
    files = dir(logo);
    files([files.isdir])=[];

    for jj=1:numel(files)
        %operations on each files(j).name
    end
end 
```

# c - C 参考。错误

> ID：13546704
> 
> 赞同：-1
> 
> 时间：2012-11-24T23:25:06.373
> 
> 标签：c, reference

我被我的代码卡住了 20 分钟。

这个简单的 C 代码有什么问题？

```
void function (char & reference_to_something) {} 
```

错误：

```
expected ';' , ',' or ')' before '&' token 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T23:26:26.103

C 没有引用；C++ 可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T23:30:52.510

除了引用不允许更改其地址这一事实外，引用和指针之间没有语义差异。改用指针，你会没事的。

```
void function (char* pointer_to_something) {} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T23:29:57.753

如果你想传递一个指针，你可以这样做：

```
void function (char * reference_to_something) { return; } 
```

# xcode - xcode错误词法或预处理器问题

> ID：13546711
> 
> 赞同：1
> 
> 时间：2012-11-24T23:25:52.037
> 
> 标签：xcode, smtp

我正在尝试遵循[本教程](http://techgeekanirudh.blogspot.co.uk/2012/08/stmp-client-server-in-xcode.html)并遇到此错误。如果有人可以帮助我，那将非常非常感激。

谢谢。![在此处输入图像描述](../Images/859af927d7e1f628067435e43df96c55.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T02:00:47.737

我可以建议几个选项：

*   添加路径的框架部分`#import <SMTPSend/NSData+Base64Additions>`（如果这是一个框架，您可能应该使用这些附件：`<.../file.h>`而不是引号）
*   将框架路径添加到构建设置（框架搜索路径）
*   确保框架在该`Link Binary With Libraries`部分中
*   从项目管理器窗格 (cmd+1) 中删除框架引用，然后将其拖回（刷新文件的路径）
*   清理/清理构建文件夹/重建

希望其中之一有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:29:13.040

该标头可能不在您的xcode项目导航器中，您需要在finder中找到该文件并将其拖入xcode并将其放置在您的项目导航器中

# iphone - 来自变量的 AVAudioPlayer 音量

> ID：13546713
> 
> 赞同：0
> 
> 时间：2012-11-24T23:26:32.797
> 
> 标签：iphone, objective-c, ios

我正在尝试通过变量更改音效的音量。我正在使用 AVAudioPlayer 并调用变量来设置音量，但是当我运行应用程序时，无论变量设置如何，我都听不到声音。(.1-1.0) 但是，如果我从 AvAudioPlayer 块 (player.volume = .5;) 中设置数字，那么它会做出应有的响应。任何想法我做错了什么？

我的代码示例：

```
@interface

@property (nonatomic) float setVolume;

@implementation
@synthesize setVolume;

float setVolume = .5;

-(void)countdown
{
//play sound
NSString *musicFilePath = [[NSBundle mainBundle] pathForResource:@"Countdown_beep" ofType:@"wav"];
NSURL *musicURL = [[NSURL alloc] initFileURLWithPath:musicFilePath];
player = [[AVAudioPlayer alloc] initWithContentsOfURL:musicURL error:nil];
player.volume = setVolume;
[player play]; 
```

谢谢。:)

编辑：

我通过从头文件中删除声明并在实现中创建 ivar 来解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:50:53.830

此行没有意义，与您的程序无关：

```
float setVolume = .5; 
```

您已经在合成一个名为`setVolume`. 这不是。因此，默认情况下，您的属性`setVolume`为零，并且您没有做任何更改，因此音量最终为零并且没有声音发生。

要设置属性的值，请设置属性的值。:) 例如，你可以说`self.setVolume = .5`. 例如，您可以在`countdown`方法的早期或其他方法中执行此操作（属性的要点之一是该对象的所有方法都可以看到它）。

现在，您的代码的另一个问题是您的属性名称以“set”开头。这可能是个坏主意。如果我是你，我会选择另一个名字。“setX”形式的名称最好仅用作实例变量/属性 X 的 setter 方法的名称。

# php - php tricker 重新加载网页（重新发送数据）

> ID：13546714
> 
> 赞同：0
> 
> 时间：2012-11-24T23:27:21.017
> 
> 标签：php, post, reload

我有一个分成三页的表格。每个页面都提交到下一页。现在我需要放置一个语言选择器，以便可以在中途以新语言重新加载表单。

问题：发布语言选择器（表单）时，旧的帖子变量被删除。

如何在不丢失旧 postvar 的情况下更改语言？就像按f5一样？

# git - Git：我可以将所有内容放在一个子文件夹中并且仍然有历史记录吗

> ID：13546718
> 
> 赞同：4
> 
> 时间：2012-11-24T23:28:15.760
> 
> 标签：git

> **可能重复：**
> [是否可以在 git 中移动/重命名文件并维护它们的历史记录？](https://stackoverflow.com/questions/2314652/is-it-possible-to-move-rename-files-in-git-and-maintain-their-history)

我是以前的颠覆用户，不确定 git 在以下情况下如何帮助我。

我有一个 git 存储库，我的项目包含多个目录，我一直在这个结构上进行多次提交

现在我需要进行结构更改，以便将根目录下的所有文件夹/文件移动到一个新文件夹，并且我仍然想保留文件的提交历史记录。

所以例如在我的回购中，我目前有这样的结构

```
src
res
xml
file.txt
.gitignore 
```

我希望将它们全部移动到一个名为 common 的文件夹中，以便我在 repo 的根目录中具有以下结构

```
common
.gitignore 
```

有可能吗，如果可以怎么办？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:36:11.713

你可以使用这样的命令

```
mkdir common
git mv src res xml file.txt common 
```

这会移动文件，您仍然可以使用`git log --follow common/file.txt`. 如果您想重写历史记录，请查看[如何重写历史记录，以便所有文件（除了我已经移动的文件）都位于子目录中？](https://stackoverflow.com/questions/4042816/how-can-i-rewrite-history-so-that-all-files-are-in-a-subdirectory)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-24T23:32:07.663

```
mkdir common
git mv src res xml file.txt common
git commit 
```

# c++ - 在 C++ 中验证输入

> ID：13546719
> 
> 赞同：0
> 
> 时间：2012-11-24T23:28:48.863
> 
> 标签：c++

我有这个代码：

```
double input2;
cout<<"please enter one number:"<<endl;
cin>>input2; 
```

如何判断用户是否只输入数字，如“3”、“4”或“4.241”。有时当用户输入'n'、'3.q'之类的字符时，我的程序会崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:34:54.390

您可以使用 stringstream 将字符串安全地转换为数字：

```
 string input;
 int mynumber;    
 cout << "Please enter a valid number: ";
 getline(cin, input);

   // This code converts from string to number safely.
   stringstream myStream(input);
   if (myStream >> myNumber)
    cout <<"number is valid"<<endl;
   else
    cout<<"invalid number"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T23:36:48.517

`cin::<<`如果操作出错，运算符返回`NULL`。原因可能很多，但如果解释失败，`failbit`则设置。您可以通过以下方式进行检查`rdstate()`：

```
int main()
{
  double input2;
  cout<<"please enter one number:" << endl;

  cin >> input2;

  if (cin.rdstate() & ifstream::failbit)
     cout << "input badly formatted" << endl;

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:34:48.693

您需要验证输入是否成功

```
if (std::cin >> input2) {
    ...
} 
```

..如果不处理错误输入，例如：

```
std::cin.clear();
std::cin.ignore(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T23:32:39.457

它不会因此而崩溃。如果 cin >> input2 操作因无效输入而失败，则 cin 将处于无效状态，但不会崩溃。

# sql - 更新 ms 访问表中的记录

> ID：13546724
> 
> 赞同：0
> 
> 时间：2012-11-24T23:29:55.507
> 
> 标签：sql, ms-access, ms-access-2010

我当前的表格如下所示；

![更新前](../Images/9cb52abf1daed2cd743e628740fa357c.png).

我希望能够更新这个表，使它看起来像这个表；

![更新后](../Images/d5488869e8a81450a3635ab9f49bf43e.png).

我的目标是使用 PLMonthly 记录中的增量值更新 PL YTD 记录的 0 值，如第二个屏幕截图所示。谢谢你的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T04:41:43.017

只是重复了很多...

```
SELECT "PLYTD" AS Name, 
    [PL].JanActual AS JanActual, 
    [PL].[JanActual]+[PL].[FebActual] AS FebActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual] AS MarActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual] AS AprActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual] AS MayActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual]+[PL].[JunActual] AS JunActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual]+[PL].[JunActual]+[PL].[JulActual] AS JulActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual]+[PL].[JunActual]+[PL].[JulActual]+[PL].[AugActual] AS AugActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual]+[PL].[JunActual]+[PL].[JulActual]+[PL].[AugActual]+[PL].[SepActual] AS SepActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual]+[PL].[JunActual]+[PL].[JulActual]+[PL].[AugActual]+[PL].[SepActual]+[PL].[OctActual] AS OctActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual]+[PL].[JunActual]+[PL].[JulActual]+[PL].[AugActual]+[PL].[SepActual]+[PL].[OctActual]+[PL].[NovActual] AS NovActual, 
    [PL].[JanActual]+[PL].[FebActual]+[PL].[MarActual]+[PL].[AprActual]+[PL].[MayActual]+[PL].[JunActual]+[PL].[JulActual]+[PL].[AugActual]+[PL].[SepActual]+[PL].[OctActual]+[PL].[NovActual]+[PL].[DecActual] AS DecActual
FROM PL
WHERE (((PL.Name)="PLMonthly")); 
```

一旦你有了更新或追加查询，取决于**PLYTD**行是否已经存在，你就可以开始了。您可以将它嵌套在 FROM 中，也可以只使用它构建一个查询并像我在下面所做的那样引用它......

```
UPDATE PL INNER JOIN plytd_query AS ytd ON PL.Name = ytd.Name SET 
    PL.JanActual = [ytd].[JanActual], 
    PL.FebActual = [ytd].[FebActual], 
    PL.MarActual = [ytd].[MarActual], 
    PL.AprActual = [ytd].[AprActual], 
    PL.MayActual = [ytd].[MayActual], 
    PL.JunActual = [ytd].[JunActual], 
    PL.JulActual = [ytd].[JulActual], 
    PL.AugActual = [ytd].[AugActual], 
    PL.SepActual = [ytd].[SepActual], 
    PL.OctActual = [ytd].[OctActual], 
    PL.NovActual = [ytd].[NovActual], 
    PL.DecActual = [ytd].[DecActual] 
```

这做出了一些假设，但无论如何它应该让你朝着正确的方向开始。

# facebook-opengraph - Facebook linter 看不到我的一些 cms 页面

> ID：13546726
> 
> 赞同：1
> 
> 时间：2012-11-24T23:30:01.407
> 
> 标签：facebook-opengraph

我的网站主要基于 wordpress，另一部分基于 Zenphoto（主题包括 wordpress 主题布局）我注意到某些 zenphoto 页面（不是全部）缺少类似按钮，但我认为以后再处理……”

我后来在一些 php 上工作以获取打开的图形标签（图像、url），并注意到它们没有被 FB 接收到某些页面（我之前提到的相同，正如我稍后注意到的那样。）

## 将它们传递给 linter，我看到它没有看到它们。

例子 ：

[http://www.voirleloup.com/galerie/catalogue/](http://www.voirleloup.com/galerie/catalogue/)

（不显示按钮）这是一个进入 linter 的 zenphoto 页面：“响应代码：404”和“确切地查看我们的抓取工具对您的 URL 看到的内容”......给了我一个空白页面。

* * *

第二个例子 [http://www.voirleloup.com/galerie/](http://www.voirleloup.com/galerie/)

... linter 可以完美看到的另一个 zenphoto 页面（就像按钮一样）

由于 linter 没有给我们任何线索，我不知道是什么导致了第一页中的这个问题，而第二页中没有……任何帮助都将受到欢迎，谢谢，Nicolas

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T00:16:48.093

> 这是进入 linter 的 zenphoto 页面：“响应代码：404”

好吧，它也在浏览器中提供了相同的响应代码——你可以很容易地验证自己，例如使用 Firebug。

是的，一个包含显然是页面内容的 HTML 文档，而不仅仅是返回错误消息——但是像 linter 这样的工具无法确定它是错误消息还是实际内容，这需要更多的 AI 比这样的工具是必须要有的。它依赖于服务器发送的 HTTP 响应代码。

> 第二个示例 [...] linter 完美看到的另一个 zenphoto 页面

响应代码为 200 OK。

所以这不是 linter 的问题，而是您的页面的问题。究竟出了什么问题，不能从外面说出来。因此，开始检查您的服务器的日志文件和您的 CMS 配置。

# android - android自动启动应用程序，然后是启动画面

> ID：13546727
> 
> 赞同：0
> 
> 时间：2012-11-24T23:30:04.633
> 
> 标签：android, onresume, splash-screen

我是android新手，如果我的问题很愚蠢，请多多包涵。我有一个在开始时有 5 秒闪屏的应用程序。当设备开机时，我的应用程序会自动启动。这意味着，在我打开设备电源后，启动屏幕的计时器开始在后台计数。如果我在 5 秒后解锁屏幕，启动画面就消失了。我希望计时器仅在活动被带到最前面时才开始计数。我试过了

```
onResume() 
```

但它不起作用。

提前致谢！

# ios - 为什么 Apple 使用特殊的 COREDATA_EXTERN 限定符而不仅仅是 extern？

> ID：13546730
> 
> 赞同：4
> 
> 时间：2012-11-24T23:30:36.320
> 
> 标签：ios, cocoa, core-data

有时我喜欢浏览 Apple 源代码，看看专业人士是如何做到的，有时我会学习一两件事。我现在正在查看 的头文件`NSManagedObjectContext.h`，以及它们的全局变量，例如`NSManagedObjectContextDidSaveNotification`，它们声明它是这样的：

```
COREDATA_EXTERN NSString * const NSManagedObjectContextDidSaveNotification; 
```

而通常它只是：

```
extern NSString * const NSManagedObjectContextDidSaveNotification 
```

Cmd+点击 COREDATA_EXTERN 将我带到它的定义：

```
#define COREDATA_EXTERN     extern 
```

所以`COREDATA_EXTERN`等于`extern`，所以我的问题是，为什么他们不只是使用`extern`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T00:02:46.390

如果您查看 CoreDataDefines.h 文件，您会看到 COREDATA_EXTERN 的一些不同定义，例如：

```
#ifdef __cplusplus
#define COREDATA_EXTERN     extern "C" 
```

或者：

```
#ifdef __cplusplus
#define COREDATA_EXTERN     extern "C" _NSWINDOWS_DLL_GOOP 
```

这允许一些特定于平台的定义，所有定义都包含在一个定义下。

Windows goop，这很有趣。我想知道的是你什么时候在 Windows 平台上编译核心数据......

# java - 奇怪的实体管理器错误

> ID：13546731
> 
> 赞同：-1
> 
> 时间：2012-11-24T23:30:37.897
> 
> 标签：java, openjpa

我做了这个查询：

```
Usuario user1=(Usuario) request.getSession().getAttribute("user");
String query1 = "SELECT f FROM Favorito f WHERE f.usuarioBean = 'user1'"; 
```

我在这里调用Manager方法

```
List<Favorito> favoritos = managerFavorito.getFavoritoByUser(query1); 
```

Manager 方法如下所示：

```
public List<Favorito> getFavoritoByUser(String query1) {
        EntityManager em = getEntityManager();
        List<Favorito> results = null;
        try {
            Query query = em.createNativeQuery(query1);
            results = (List<Favorito>) query.getResultList();
        } finally {
            em.close();
        }
        return results;
    } 
```

错误：

```
 org.apache.openjpa.persistence.ArgumentException: Metadata not found for type "class java.lang.String". Class not improved. 
```

完全错误：

```
[25/11/12 0:17:37:538 CET] 0000002b servlet       E com.ibm.ws.webcontainer.servlet.ServletWrapper service SRVE0068E: Se ha creado una excepción no detectada en uno de los métodos de servicio del servlet servletControl en la aplicación MotorSalesGR83.15\. Excepción creada: <openjpa-2.0.2-SNAPSHOT-r422266:1032678 nonfatal user error> org.apache.openjpa.persistence.ArgumentException: No se han encontrado metadatos para el tipo "class java.lang.String". La clase no se ha mejorado.
    at org.apache.openjpa.meta.MetaDataRepository.getMetaDataInternal(MetaDataRepository.java:377)
    at org.apache.openjpa.meta.MetaDataRepository.getMetaData(MetaDataRepository.java:358)
    at org.apache.openjpa.jdbc.meta.MappingRepository.getMapping(MappingRepository.java:355)
    at org.apache.openjpa.jdbc.meta.strats.RelationStrategies.toDataStoreValue(RelationStrategies.java:88)
    at org.apache.openjpa.jdbc.meta.strats.RelationFieldStrategy.toDataStoreValue(RelationFieldStrategy.java:836)
    at org.apache.openjpa.jdbc.meta.FieldMapping.toDataStoreValue(FieldMapping.java:938)
    at org.apache.openjpa.jdbc.kernel.exps.PCPath.toDataStoreValue(PCPath.java:844)
    at org.apache.openjpa.jdbc.kernel.exps.Lit.calculateValue(Lit.java:109)
    at org.apache.openjpa.jdbc.kernel.exps.CompareEqualExpression.appendTo(CompareEqualExpression.java:98)
    at org.apache.openjpa.jdbc.kernel.exps.SelectConstructor.buildWhere(SelectConstructor.java:298)
    at org.apache.openjpa.jdbc.kernel.exps.SelectConstructor.evaluate(SelectConstructor.java:93)
    at org.apache.openjpa.jdbc.kernel.JDBCStoreQuery.createWhereSelects(JDBCStoreQuery.java:349)
    at org.apache.openjpa.jdbc.kernel.JDBCStoreQuery.executeQuery(JDBCStoreQuery.java:187)
    at org.apache.openjpa.kernel.ExpressionStoreQuery$DataStoreExecutor.executeQuery(ExpressionStoreQuery.java:776)
    at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:1003)
    at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:861)
    at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:792)
    at org.apache.openjpa.kernel.DelegatingQuery.execute(DelegatingQuery.java:542)
    at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:288)
    at org.apache.openjpa.persistence.QueryImpl.getResultList(QueryImpl.java:302)
    at entities.controller.FavoritoManager.getVehiculoFavorito(FavoritoManager.java:172)
    at tiw.servletControl.doPost(servletControl.java:78)
    at tiw.servletControl.doGet(servletControl.java:38)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:718)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:831)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1657)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:939)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:502)
    at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:179)
    at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3933)
    at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:276)
    at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:931)
    at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1583)
    at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:186)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)
    at com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complete(HttpICLReadCallback.java:83)
    at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
    at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
    at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
    at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
    at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
    at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
    at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1604) 
```

有问题？我开始认为我无法使用简单的 Where 在 Favorito 中搜索行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T09:51:07.190

您的代码中发生了一些奇怪的事情。

首先，您将`user1`对象拉出会话，但从不使用它。此外，在您的查询中，您断言`f.usuarioBean`等于字符串“user1”，我认为这永远不会是真的：

```
String query1 = "SELECT f FROM Favorito f WHERE f.usuarioBean = 'user1'"; 
```

我认为你的意思是做这样的事情：

```
String query1 = "SELECT f FROM Favorito f WHERE f.usuarioBean = '" + user1.getId() + "'"; 
```

一个更好的方法（实际上，唯一正确的方法）是使用查询参数：

```
String query1 = "SELECT f FROM Favorito f WHERE f.usuarioBean = ?";
// and then later:
query.setParameter(1, user1); 
```

其次，您正在调用[`createNativeQuery`](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#createNativeQuery%28java.lang.String%29)，它将 SQL 查询字符串作为参数。但是，您传递的字符串不是 SQL，而是 JPQL（您无法在 SQL 中选择表别名，对吗？）。为了更好的类型安全，您应该调用[`createQuery`](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#createQuery%28java.lang.String%29)或更好地调用[`createQuery(String, Class)`](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#createQuery%28java.lang.String,%20java.lang.Class%29)创建 a的重载。`TypedQuery`

# ruby-on-rails - Rails Sass 在快速开发机器上编译太慢

> ID：13546738
> 
> 赞同：8
> 
> 时间：2012-11-24T23:31:30.373
> 
> 标签：ruby-on-rails, sass

我的电脑运行频率为 3.6ghz，内存为 12gb，并使用 Windows 7 和 RailsInstaller 来开发 Rails 应用程序。

当我使用纯 css 时，没有问题，但是当我开始使用 Sass 和 Compass 时，我必须等待 10-15 秒以上才能刷新才能看到新的更改。（这只发生在我编辑 .scss 文件时）

任何人都知道在相当快的机器上导致这种情况的原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T14:59:35.103

随着从 sass 3.1.x 到 3.2.x 的更新，sass 编译时间显着延长。
根据上面 Roman 的回答，似乎有一个特定的问题，如果您`@extend`在深度嵌套的选择器中使用它，因为 '@extend' 做了很多处理工作。[这是 github 上 sass 项目上当前未解决的问题的链接，用于解决这个确切的问题](https://github.com/nex3/sass/issues/495)。

话虽如此，关于该问题的报告更像是 90-100 秒的编译时间（我自己的个人项目使用了 104 秒，它使用了`@extend`很多来引入基础/引导类）。因此，如果您遇到 9-10 秒的延迟，您的问题可能只是一个普遍问题，因为最新更新的编译时间通常较慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T14:41:10.150

就我而言，这是因为过于频繁地使用 @extend 指令。

# c# - 具有命名空间的 SelectNodes 返回过多的事件

> ID：13546739
> 
> 赞同：1
> 
> 时间：2012-11-24T23:31:38.413
> 
> 标签：c#, xml-namespaces, xmldocument, bing-api

我正在尝试处理来自 Bing Maps REST Routes API 的响应。

查询是关于带有参数 routePathOutput=Point 的行驶路线（即返回路线路径的点（纬度和经度）值列表）。

我只需要在 RoutePath 子树中选择“纬度”和“经度”元素，但 SelectNodes 方法会返回 XmlDocument 中出现的所有“纬度”和“经度”。

```
XmlNamespaceManager nsmgr = new XmlNamespaceManager(routeResponse.NameTable);
nsmgr.AddNamespace("rest", "http://schemas.microsoft.com/search/local/ws/rest/v1");

// This works fine:
XmlNodeList pathList = routeResponse.SelectNodes("//rest:RoutePath", nsmgr);
// ... and now pathList.Count = 1

// This doesn't work as I expected:
XmlNodeList latitudeList = pathList[0].SelectNodes("//rest:Latitude", nsmgr);
// ... because latitudeList contains all the occurrences of the element 'Latitude' in the  XmlDocument,
// not only the once in the 'RoutePath' subtree. 
```

谢谢，卡罗

# python - 删除字符串中的字符“'s”

> ID：13546741
> 
> 赞同：1
> 
> 时间：2012-11-24T23:31:47.287
> 
> 标签：python, python-3.2

假设`'s`单词末尾有字符，我该如何删除它？

下面，是我尝试过的：

```
st = "s'ss python's is fun's "
for ch in st:
    if ch[-2:] in "'s":   # check if last two index is 's
        st = st.replace(ch, "") 
```

输出应该是：“sss python is fun”

不知何故，它会删除所有`s`and `'`，而不仅仅是在最后。

我怎样才能删除具有“'s”的字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T01:26:35.750

我认为这可以完成您正在寻找的东西（如果我误解了 :) 抱歉）。这会将您的字符串拆分为空格，然后遍历生成的“单词”。如果单词以 结尾`'s`，则删除该部分；如果不是，则返回整个单词。然后将结果与空格字符连接以返回一个字符串：

```
In [16]: st = "s'ss a python's is fun's "

In [17]: ' '.join(s if s[-2:] != "'s" else s[:-2] for s in st.split())
Out[17]: "s'ss a python is fun" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T09:40:15.927

```
mylist = []
strin = "s'ss hello you's"
mylist = list(strin)
mylist.remove[-1]
print str(mylist)
#the output will be as , "s'ss hello you'" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T09:23:52.810

我会使用正则表达式，如下所示：

```
>>> import re
>>> re.sub(r"'s\b", "", "s'ss python's ")  
"s'ss python " 
```

（`\b`匹配单词的开头或结尾）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T10:55:22.070

首先，你的`st`结尾是一个空格——你可能想用[`str.split`](http://docs.python.org/2/library/stdtypes.html#str.strip)or删除它[`str.lstrip`](http://docs.python.org/2/library/stdtypes.html#str.lstrip)：

```
>>> st = "s'ss python's is fun's "
>>> st = st.strip()
>>> print(st)
s'ss python's is fun's 
```

然后删除尾随`'s`有许多不同的方法。

使用正则表达式是一种简洁的方式：

```
>>> import re
>>> re.sub("'s$", "", st)
"s'ss python's is fun" 
```

或者您可以检查字符串是否以`'s`并删除最后两个字符结尾：

```
>>> if st.endswith("'s"):
...     st = st[:-2] 
```

不要[`str.rstrip`](http://docs.python.org/2/library/stdtypes.html#str.rstrip)用来执行此操作，因为它可能不像您预期​​的那样：

```
>>> st.rstrip("'s") # Bad
"s'ss python's is fun" 
```

在这种情况下看起来是正确的，但正如文档解释的那样，“[the] 参数不是后缀；相反，它的值的所有组合都被剥离了”。例如：

```
>>> "lots of ssssss's".rstrip("'s")
'lots of ' 
```

# c++ - 将向量写入文件并读回

> ID：13546743
> 
> 赞同：1
> 
> 时间：2012-11-24T23:31:56.863
> 
> 标签：c++, qt, stl, stdvector

我正在尝试做一些快速而肮脏的矢量序列化，但它没有按预期工作。尝试从文件中读取向量时，问题是段错误。我将文件偏移量和矢量大小存储在标题中。这是代码：

```
// writing
std::vector<size_t> index;

header.offset = ofs.tellp();
header.size = sizeof(index);
ofs.write((char *) &index[0], sizeof(index)); // pretty bad right, but seems to work   

// reading
std::vector<size_t> index;
index.resize(header.numElements)

ifs.seekg(header.offset);
// segfault incoming
ifs.read((char *) &index[0], header.size); 
```

老实说，如果这行得通，我会感到惊讶，但我不确定什么是实现我想要的正确方法。我宁愿远离 boost，但我已经在使用 Qt，所以如果 QVector 或 QByteArray 能以某种方式帮助我，我可以使用这些。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:36:44.197

`sizeof`不会做你认为它对`vector`. 如果要获取向量分配内存的大小（以字节为单位），可以执行`index.size() * sizeof(size_t)`. `index.size()`是向量中元素的数量， 是向量`sizeof(size_t)`中一个元素的大小。

更正后的代码更像（修剪额外的东西）：

```
// writing...
std::vector<size_t> index;

size_t numElements = index.size();
size_t numBytes = numElements * sizeof(size_t); // get the size in bytes
ofs.write((char *) &index[0], numBytes);

// reading...
std::vector<size_t> index;
index.resize(numElements);

ifs.read((char *) &index[0], numBytes); // again, numBytes is numElements * sizeof(size_t) 
```

至于`sizeof(index)`真正做什么，它返回实际矢量对象的大小。向量存储的元素与其大小是分开的。例如：

```
int* array = new int[500];
// sizeof(array) is the size of the pointer, which is likely 4 or 8 bytes if you're on 32 or 64 bit system 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:36:29.163

我会尝试使用指向向量的指针。您正在尝试使用对数据类型的引用。如果你的 C++ 试图是类型安全的，它可能不起作用

# c# - Winforms Drawing.rectangle.union 的 WPF 等效项是什么？

> ID：13546754
> 
> 赞同：4
> 
> 时间：2012-11-24T23:33:40.440
> 
> 标签：c#, wpf, winforms, rectangles

标题说明了一切。我需要知道 WPF 中与`drawing.rectange.union()`. 我知道我可以 import `System.Drawing`，但我不想这样做。我是 WPF 的初学者。

**编辑：**

我想要实现的是有两个矩形并制作一个可以适合它们的矩形，用于缩放目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T00:49:17.780

尝试[System.Windows.Rect 结构](http://msdn.microsoft.com/en-us/library/system.windows.rect.aspx)及其[Union](http://msdn.microsoft.com/en-us/library/ms600240.aspx)方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:26:34.740

没有，因为 WPF 没有与`System.Drawing.Rectangle`. WPF 确实有一个`Rectangle`，但是因为它只有大小，没有位置，所以联合是不可能的。

如果你能描述你想要达到的目标，你会得到一个更好的答案。

# java - 使用java将文件夹存储在文件中

> ID：13546756
> 
> 赞同：1
> 
> 时间：2012-11-24T23:34:04.680
> 
> 标签：java

在 JAVA 中将文件夹存储在单个文件（如 zip、tar、rar、iso 等）中的更简单、更安全的方法是什么？像压缩和解压缩它。我真的不需要压缩，只需将整个文件夹放在一个文件中

我正在寻找一个库，它允许我简单地给它文件夹的路径并获取文件和相反的过程。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T00:11:26.503

在 GitHub 上查看[ZT-Zip 。](https://github.com/zeroturnaround/zt-zip)

### 将目录压缩到 ZIP 存档中

```
ZipUtil.pack(new File("/tmp/demo"), new File("/tmp/demo.zip")); 
```

### 提取 ZIP 存档

```
ZipUtil.unpack(new File("/tmp/demo.zip"), new File("/tmp/demo")); 
```

该库还支持许多其他很酷的操作，包括[存在检查](https://github.com/zeroturnaround/zt-zip#check-if-an-entry-exists-in-a-zip-archive)、[提取 zip 存档的子集](https://github.com/zeroturnaround/zt-zip#extract-an-entry-from-a-zip-archive-into-file-system)和[比较](https://github.com/zeroturnaround/zt-zip#compare-two-zip-archives-ignoring-timestamps-of-the-entries)zip 存档。

查看[自述文件](https://github.com/zeroturnaround/zt-zip#zip---convenience-methods)

# c++ - 为什么我不能将声明和逻辑运算符放在一起？

> ID：13546757
> 
> 赞同：3
> 
> 时间：2012-11-24T23:34:21.267
> 
> 标签：c++

出于效率原因（尽管很小），我想在 if 条件块中声明并分配一个变量。

即而不是说

```
if(a != 0 && a->b >= 10){
    int c = a->b
    ...
} 
```

我想首先分配 int c 并说

```
if(a != 0 && (int c = a->b) >= 10){
    ...
} 
```

以最直接的方式（对我而言），我得到编译错误。有谁知道在 C++ 中是否/不可能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:45:07.943

```
if(a != 0) {
    int c = a->b;

    if (c >= 10) {
        //using c here
    }

    // common cleanup here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-24T23:40:41.720

为什么你认为这会优化任何东西？

即使假设您被允许在条件内声明和初始化变量（这在 C++ 中是不可能的，因为编译器想要可以评估的东西并且声明不返回任何内容），这将在每次评估条件时完成（除非你把它短路，你的代码片段就是这种情况）但无论如何都不会改变：你仍然在声明和初始化一个变量，无论在哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T23:48:53.297

如果您在第一个条件下拥有它，它将起作用。但是，在这种情况下，比较在分配之前，你不会得到你想要的

```
int a = 3;
int x = 0;
if ( bool b = a > 5 && x < 2) {
printf("%d",b);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T00:45:08.977

```
int c = (a == 0 ? 0 : a->b);
if(a != 0 && c >= 10){

    ...
} 
```

如果你想避免`a->b`多次使用。

# android - 如何在列表视图中添加当前位置

> ID：13546761
> 
> 赞同：2
> 
> 时间：2012-11-24T23:35:18.923
> 
> 标签：android, google-maps, listview, listviewitem

```
import java.util.ArrayList;
import java.util.List;

import android.app.Activity;
import android.content.Context;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.widget.Adapter;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;

import com.example.geotask.maptask;
import com.google.android.maps.GeoPoint;

public class list extends Activity{ 
    private ListView listView; 
    List<String> data = new ArrayList<String>(); 
    ArrayAdapter<String> Adapter;
    /** Called when the activity is first created. */ 
    @Override 
    public void onCreate(Bundle savedInstanceState) { 
        super.onCreate(savedInstanceState); 
        LocationManager locationManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
        String provider = locationManager.GPS_PROVIDER;
        Location location = locationManager.getLastKnownLocation(provider);
       String latLongString = "Lat:" + location.getLatitude() + "\nLong:" + location.getLongitude();

        setContentView(R.layout.list); 
        locationManager.requestLocationUpdates(provider, 2000, 10, locationListener);
        listView = (ListView)findViewById(R.id.listView1); 
        Adapter = new ArrayAdapter<String>(this, android.R.layout.simple_expandable_list_item_1,data);
        listView.setAdapter(Adapter);
        data.add(latLongString);
    } 

     private  LocationListener locationListener = new LocationListener() {
            public void onLocationChanged(Location location) {

                final String latLongString = "Lat:" + location.getAltitude() + "\nLong:" + location.getLongitude();
                 Runnable add= new Runnable(){
                        public void run()
                        {   data.add(latLongString);
                        Adapter.notifyDataSetChanged();
                        }
                    };
             // updateWithNewLocation(location);

        //      addlayout(location);
            }

            public void onProviderDisabled(String provider){
              //updateWithNewLocation(null);
          //    addlayout(null);

            }

            public void onProviderEnabled(String provider) {
                //updateWithNewLocation(null);
            //  addlayout(null);

            }

            public void onStatusChanged(String provider, int status, Bundle extras) {}
          };

          //Update the map with a new location 

} 
```

就像上面的代码一样，当我启动应用程序时，它就可以工作了。但是在我通过模拟器控制发送另一个位置点后，它失败了。我更新了问题。现在logcat没有显示任何错误信息（没有红线），但是如果我更改位置，新项目仍然无法添加到数据列表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:46:09.223

你没有设置你的适配器。你应该把它放在`onCreate`：

```
Adapter = new ArrayAdapter<String>(this, android.R.layout.simple_expandable_list_item_1,data);
listView.setAdapter(Adapter); 
```

代替 ：

```
listView.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_expandable_list_item_1,data)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:46:40.023

您无法从不同的班级获取位置，您只能在当前班级内获取`onLocationChanged()`

```
 String latLongString = location.getAttitude()" + "location.getLongtitude(); 
      Runnable add= new Runnable(){
            public void run()
            {   

                data.add(latLongString);
                Adapter.notifyDataSetChanged();
            }
      }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T21:23:45.367

我通过添加一个新方法解决了这个问题

# java - 如何使文本带有双下划线？

> ID：13546764
> 
> 赞同：1
> 
> 时间：2012-11-24T23:35:38.627
> 
> 标签：java, swing

我知道 StyleConstants 中有一种方法可以用一个下划线设置文本。

但是如果我想设置带有双下划线的文本怎么办？

有什么简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T06:13:11.860

[http://java-sl.com/tip_colored_strikethrough.html](http://java-sl.com/tip_colored_strikethrough.html) 该链接显示彩色删除线，但您可以使用相同的方法并绘制 2 条线

```
import javax.swing.*; 

import javax.swing.text.*; 
import java.awt.*; 

public class ColoredStrikeThroughText { 

    public ColoredStrikeThroughText() { 
        JFrame fr = new JFrame("Custom color StrikeThrough attribute"); 

        fr.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 

        JEditorPane pane = new JEditorPane(); 
        pane.setEditorKit(new StyledEditorKit() { 
            public ViewFactory getViewFactory() { 
                return new NewViewFactory(); 

            } 
        }); 
        pane.setText("Color red text, color blue text, text without coloring."); 

        StyledDocument doc = (StyledDocument) pane.getDocument(); 
        MutableAttributeSet attr = new SimpleAttributeSet(); 
        attr.addAttribute("strike-color", Color.red); 

        doc.setCharacterAttributes(0, 9, attr, false); 

        attr.addAttribute("strike-color", Color.blue); 
        doc.setCharacterAttributes(17, 27, attr, false); 

        JScrollPane sp = new JScrollPane(pane); 

        fr.getContentPane().add(sp); 
        fr.setSize(300, 300); 
        fr.setLocationRelativeTo(null); 

        fr.setVisible(true); 
    } 

    public static void main(String[] args) { 
        ColoredStrikeThroughText test = new ColoredStrikeThroughText(); 
    } 
} 

class NewViewFactory implements ViewFactory { 
    public View create(Element elem) { 
        String kind = elem.getName(); 
        if (kind != null) { 
            if (kind.equals(AbstractDocument.ContentElementName)) { 

                return new MyLabelView(elem); 
            } 
            else if (kind.equals(AbstractDocument.ParagraphElementName)) { 
                return new ParagraphView(elem); 
            } 
            else if (kind.equals(AbstractDocument.SectionElementName)) { 
                return new BoxView(elem, View.Y_AXIS); 

            } 
            else if (kind.equals(StyleConstants.ComponentElementName)) { 
                return new ComponentView(elem); 
            } 
            else if (kind.equals(StyleConstants.IconElementName)) { 
                return new IconView(elem); 
            } 

        } 

        // default to text display 
        return new LabelView(elem); 
    } 
} 

class MyLabelView extends LabelView { 

    public MyLabelView(Element elem) { 
        super(elem); 
    } 

    public void paint(Graphics g, Shape allocation) { 
        super.paint(g, allocation); 
        paintStrikeLine(g, allocation); 

    } 

    public void paintStrikeLine(Graphics g, Shape a) { 
        Color c=(Color)getElement().getAttributes().getAttribute("strike-color"); 
        if (c!=null) { 
            int y = a.getBounds().y + a.getBounds().height - (int) getGlyphPainter().getDescent(this); 

            y = y - (int) (getGlyphPainter().getAscent(this) * 0.3f); 
            int x1 = (int) a.getBounds().getX(); 
            int x2 = (int) (a.getBounds().getX() + a.getBounds().getWidth()); 

            Color old = g.getColor(); 
            g.setColor(c); 
            g.drawLine(x1, y, x2, y); 
            g.setColor(old); 
        } 
    } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-30T22:16:05.027

您将在 CSS 元素中输入 `{ text-decoration: underline double;}`

例如：`p { text-decoration: underline double;}`

# python - pylint 在 PyQt4 中找不到 QtCore

> ID：13546767
> 
> 赞同：5
> 
> 时间：2012-11-24T23:36:09.007
> 
> 标签：python, pyqt, pylint, spyder

我最近为 spyder 和 PyQt4 支持安装了 Python(x,y)。我在安装过程中选择了 pylint，并从“使用 Python 和 Qt4 进行快速 GUI 开发”的代码资源中加载了一个脚本……特别是第 4 章中的第一个简单的“alert.pyw”。

Pylint 说这是一个错误：

```
from PyQt4.QtCore import (QTime, QTimer, Qt, SIGNAL) 
```

...这是错误消息：

```
[E0611]19: No name 'QtCore' in module 'PyQt4' 
```

...但是在常规 Python 解释器 (2.7.3) 和 ipython 解释器 (0.13) 中，我都可以输入：

```
from PyQt<tab>4.QtC<tab>ore 
```

并且自动完成似乎发现它很好。

有什么方法可以设置 pylint 以便它看到明显存在的东西，还是我最好禁用 pylint 并返回 pyflakes 或其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:48:05.323

这看起来可能与[此处](http://www.riverbankcomputing.com/pipermail/pyqt/2009-July/023864.html)提出的 pylint 问题有关，尽管它是很久以前的。你使用的是什么版本的 PyQt4 和 pylint？

如果是同样的问题，则将导入更改为：

```
from PyQt4 import QtGui
from PyQt4.QtCore import (QTime, QTimer, Qt, SIGNAL) 
```

可能会停止“错误”消息。

# twilio - 您可以从美国以外的号码拨打 Twilio 免费电话号码吗？

> ID：13546773
> 
> 赞同：0
> 
> 时间：2012-11-24T23:36:43.617
> 
> 标签：twilio

我从国家（主要是亚洲）拨打了 1-800 和 1-888 号码，由于“号码不存在”，这些号码无法接通。同样，我尝试从美国向加拿大拨打免费电话并得到相同的结果。

有谁知道/确认如果我要从 Twilio 购买一个免费电话号码，那么人们可以从北美以外的地方拨打电话？如果是，它仍然可以免费使用吗？暗示来电者不会被收取国际通话费用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T03:51:03.083

刚试过。他们没有。该号码在其他国家无效。

# mongodb - Spring Data MongoDB 存储库中的 IndexOutOfBoundsException

> ID：13546777
> 
> 赞同：0
> 
> 时间：2012-11-24T23:37:18.913
> 
> 标签：mongodb, spring-roo, spring-data

在 Spring Roo 上尝试使用 MongoDB，但我遇到了 Spring Data Repositories 查找方法的问题。我的存储库如下所示：

```
package com.sample.test.repositories;

import com.sample.test.domain.SiteUser;
import java.util.List;
import org.springframework.roo.addon.layers.repository.mongo.RooMongoRepository;

@RooMongoRepository(domainType = SiteUser.class)
public interface SiteUserRepository {

    public List<SiteUser> findAll();

    public List<SiteUser> findByLoginId();

    public List<SiteUser> findByRealId();
} 
```

但是，当我尝试调用任何 find 方法时，会出现以下异常：

```
org.springframework.data.repository.query.ParameterOutOfBoundsException: java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
    at org.springframework.data.repository.query.Parameters.getParameter(Parameters.java:168)
    at org.springframework.data.repository.query.Parameters.getBindableParameter(Parameters.java:238)
    at org.springframework.data.repository.query.ParametersParameterAccessor.getBindableValue(ParametersParameterAccessor.java:98)
    at org.springframework.data.repository.query.ParametersParameterAccessor$BindableParameterIterator.next(ParametersParameterAccessor.java:126)
    at org.springframework.data.mongodb.repository.query.ConvertingParameterAccessor$ConvertingIterator.next(ConvertingParameterAccessor.java:187)
    at org.springframework.data.mongodb.repository.query.ConvertingParameterAccessor$ConvertingIterator.nextConverted(ConvertingParameterAccessor.java:195)
    at org.springframework.data.mongodb.repository.query.MongoQueryCreator.from(MongoQueryCreator.java:216)
    at org.springframework.data.mongodb.repository.query.MongoQueryCreator.create(MongoQueryCreator.java:102)
    at org.springframework.data.mongodb.repository.query.MongoQueryCreator.create(MongoQueryCreator.java:48)
    at org.springframework.data.repository.query.parser.AbstractQueryCreator.createCriteria(AbstractQueryCreator.java:109)
    at org.springframework.data.repository.query.parser.AbstractQueryCreator.createQuery(AbstractQueryCreator.java:88)
    at org.springframework.data.repository.query.parser.AbstractQueryCreator.createQuery(AbstractQueryCreator.java:73)
    at org.springframework.data.mongodb.repository.query.PartTreeMongoQuery.createQuery(PartTreeMongoQuery.java:69)
    at org.springframework.data.mongodb.repository.query.AbstractMongoQuery.execute(AbstractMongoQuery.java:82)
    at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.invoke(RepositoryFactorySupport.java:301)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy75.findByLoginId(Unknown Source)
    at com.thirtytwopasteight.xchange.services.UserServiceImpl.findSiteUsersByLoginIdEquals(UserServiceImpl.java:39)
    at com.sample.test.authentication.LocalUserDetailsService.loadUserByUsername(LocalUserDetailsService.java:32)
    at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:81)
    at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:132)
    at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:156)
    at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:174)
    at org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.attemptAuthentication(UsernamePasswordAuthenticationFilter.java:94)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:194)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at com.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.traceNextValve(HttpRequestOperationCollectionValve.java:116)
    at com.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.invoke(HttpRequestOperationCollectionValve.java:98)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
    at java.util.ArrayList.rangeCheck(ArrayList.java:604)
    at java.util.ArrayList.get(ArrayList.java:382)
    at org.springframework.data.repository.query.Parameters.getParameter(Parameters.java:166)
    ... 59 more
org.springframework.data.repository.query.ParameterOutOfBoundsException: java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
    at org.springframework.data.repository.query.Parameters.getParameter(Parameters.java:168)
    at org.springframework.data.repository.query.Parameters.getBindableParameter(Parameters.java:238)
    at org.springframework.data.repository.query.ParametersParameterAccessor.getBindableValue(ParametersParameterAccessor.java:98)
    at org.springframework.data.repository.query.ParametersParameterAccessor$BindableParameterIterator.next(ParametersParameterAccessor.java:126)
    at org.springframework.data.mongodb.repository.query.ConvertingParameterAccessor$ConvertingIterator.next(ConvertingParameterAccessor.java:187)
    at org.springframework.data.mongodb.repository.query.ConvertingParameterAccessor$ConvertingIterator.nextConverted(ConvertingParameterAccessor.java:195)
    at org.springframework.data.mongodb.repository.query.MongoQueryCreator.from(MongoQueryCreator.java:216)
    at org.springframework.data.mongodb.repository.query.MongoQueryCreator.create(MongoQueryCreator.java:102)
    at org.springframework.data.mongodb.repository.query.MongoQueryCreator.create(MongoQueryCreator.java:48)
    at org.springframework.data.repository.query.parser.AbstractQueryCreator.createCriteria(AbstractQueryCreator.java:109)
    at org.springframework.data.repository.query.parser.AbstractQueryCreator.createQuery(AbstractQueryCreator.java:88)
    at org.springframework.data.repository.query.parser.AbstractQueryCreator.createQuery(AbstractQueryCreator.java:73)
    at org.springframework.data.mongodb.repository.query.PartTreeMongoQuery.createQuery(PartTreeMongoQuery.java:69)
    at org.springframework.data.mongodb.repository.query.AbstractMongoQuery.execute(AbstractMongoQuery.java:82)
    at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.invoke(RepositoryFactorySupport.java:301)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy75.findByLoginId(Unknown Source)
    at com.sample.test.services.UserServiceImpl.findSiteUsersByLoginIdEquals(UserServiceImpl.java:39)
    at com.sample.test.authentication.LocalUserDetailsService.loadUserByUsername(LocalUserDetailsService.java:32)
    at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:81)
    at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:132)
    at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:156)
    at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:174)
    at org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.attemptAuthentication(UsernamePasswordAuthenticationFilter.java:94)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:194)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at com.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.traceNextValve(HttpRequestOperationCollectionValve.java:116)
    at com.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.invoke(HttpRequestOperationCollectionValve.java:98)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
    at java.util.ArrayList.rangeCheck(ArrayList.java:604)
    at java.util.ArrayList.get(ArrayList.java:382)
    at org.springframework.data.repository.query.Parameters.getParameter(Parameters.java:166)
    ... 59 more 
```

我不确定这是否是正确的方法，因为到目前为止我一直在处理 JPA 实体，这是我在 Mongo 的第一次尝试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T09:37:51.770

如果您在查询方法中引用了一个属性，您需要将一个参数传递给该方法，您显然不会在此处执行此操作。我当然会期待一个更具语义的例外。那么你介意在 Spring Data MongoDB JIRA 中提交一张票吗？

# javascript - 如何在 Chrome 扩展中的 popup.js 和 background.js 之间进行通信？

> ID：13546778
> 
> 赞同：69
> 
> 时间：2012-11-24T23:37:22.050
> 
> 标签：javascript, google-chrome-extension

来自 popup.js 的消息被两次发布到 background.js，但我从 background.js 中一无所获。

背景.js

```
function login(username,password){

    console.log(username);
var xhr = new XMLHttpRequest();

xhr.open("POST", "http://localhost:3000/login/", true);
xhr.setRequestHeader('Content-type','application/json; charset=utf-8');
data = {"username":username,"password":password};
console.log(JSON.stringify(data));
xhr.send(JSON.stringify(data));
xhr.onreadystatechange = function() {
  if (xhr.readyState == 4) {
    // JSON.parse does not evaluate the attacker's scripts.
    var resp = JSON.parse(xhr.responseText);
    console.log(resp);
    var lStorage = localStorage;
    localStorage.setItem("username",resp["username"]);
    localStorage.setItem("apiKey",resp["apiKey"]);
    localStorage.setItem("password",resp["password"]);
    console.log(localStorage.getItem("username"));

  }
};

}

chrome.extension.onRequest.addListener(
    function(request, sender, sendResponse){
        console.log("hello");
        if(request.msg == "login") {
            //alert(request.password);
            login(request.username,request.password);}
    }
);

  chrome.extension.onConnect.addListener(function(port) {
  console.log("Connected .....");
  port.onMessage.addListener(function(msg) {
        console.log("message recieved "+ msg);
        port.postMessage("Hi Popup.js");
  });
}); 
```

popup.js：

```
function login(){
alert(document.login.username.value);
chrome.extension.sendRequest({ msg: "login",username:document.login.username.value,password:document.login.password.value});
document.getElementById('openBackgroundWindow').visbility = "hidden";

}

$(document).ready(function (){

checkUserAuth();
console.log("Inside");
$("#openBackgroundWindow").click(login);

});

function checkUserAuth(){
console.log(localStorage.getItem("apiKey"));
if(localStorage.getItem("apiKey") != null)
    {
        $("#openBackgroundWindow").visbility ="hidden";
    }
}

var port = chrome.extension.connect({name: "Sample Communication"});
port.postMessage("Hi BackGround");
port.onMessage.addListener(function(msg) {
        console.log("message recieved"+ msg);
}); 
```

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-11-25T07:47:05.450

***方法 - A：***
*使用长寿命连接*，您可以从 background.js 与任何活动的扩展页面的 popup.js 进行通信（这里我包含了 popup.html 和`only initiated`来自 popup.js 的示例通信作为示例）

***背景.js***

```
 chrome.extension.onConnect.addListener(function(port) {
      console.log("Connected .....");
      port.onMessage.addListener(function(msg) {
           console.log("message recieved" + msg);
           port.postMessage("Hi Popup.js");
      });
 }) 
```

***popup.js***

```
 var port = chrome.extension.connect({
      name: "Sample Communication"
 });
 port.postMessage("Hi BackGround");
 port.onMessage.addListener(function(msg) {
      console.log("message recieved" + msg);
 }); 
```

***Method - B :***
Direct Manipulation of DOM* 如果你的最终结果是修改 DOM，你可以用这个来实现

***popup.html***

```
<html>
    <head>
        <script src="popup.js"></script>
    </head>
    <body>
        <div id="x" value="m">Some thing</div>
    </body>
</html> 
```

***背景.js***

```
var views = chrome.extension.getViews({
    type: "popup"
});
for (var i = 0; i < views.length; i++) {
    views[i].document.getElementById('x').innerHTML = "My Custom Value";
} 
```

***方法 - C：***

*使用 Long Lived Connections*，您可以从 background.js 与任何活动的扩展页面的 popup.js 进行通信（这里我没有包含 popup.html 并从 background.js 发起示例通信；

***背景.js***

```
chrome.browserAction.onClicked.addListener(function(tab) {

    var port = chrome.extension.connect({
        name: "Sample Communication"
    });
    port.postMessage("Hi BackGround");
    port.onMessage.addListener(function(msg) {
        console.log("message recieved" + msg);
    });

}); 
```

我已经更改了您的代码并在消除了一些内容并使其成为简单版本后使其运行。**在这个骨架上添加你的 AJAX 请求和 HTML DOM 代码**（确保你`<script>`在 head 部分添加标签并`chrome.extension.onConnect.addListener`放出`(xhr.readyState == 4)`代码；）

***popup.html***

```
<html >
    <head>
        <script src="popup.js"></script>
    </head>
    <body></body>
</html> 
```

***清单.json***

```
{
    "name": "Demo",
    "version": "1.0",
    "manifest_version": 2,
    "description": "This is a demo",
    "browser_action": {
        "default_popup": "popup.html"
    },
    "background": {
        "scripts": ["background.js"]
    },
    "permissions": ["<all_urls>",
        "storage",
        "tabs"
    ]
} 
```

***背景.js***

```
chrome.extension.onConnect.addListener(function(port) {
    console.log("Connected .....");
    port.onMessage.addListener(function(msg) {
        console.log("message recieved " + msg);
        port.postMessage("Hi Popup.js");
    });
}); 
```

***popup.js***

```
var port = chrome.extension.connect({
    name: "Sample Communication"
});
port.postMessage("Hi BackGround");
port.onMessage.addListener(function(msg) {
    console.log("message recieved" + msg);
}); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2017-04-16T19:36:17.217

这可以用于2路通信。两个文件中都有相同的代码。

***popup.js & background.js***

```
//for sending a message
chrome.runtime.sendMessage({greeting: "hello"}, function(response) {

});

//for listening any message which comes from runtime
chrome.runtime.onMessage.addListener(messageReceived);

function messageReceived(msg) {
   // Do your work here
} 
```

*参考：[https ://developer.chrome.com/extensions/runtime#method-sendMessage](https://developer.chrome.com/extensions/runtime#method-sendMessage)*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-11-29T05:23:37.503

# 全双工通信

`background.js`异步调用方法`popup.js`并*返回响应*：

**Popup.js：**

```
// wrapper method 
function getContent() {
    callEventPageMethod('getContent', 'some parameter', function (response) {
        doSomethingWith(response);
    });

}

//generic method
function callEventPageMethod(method, data, callback) {
    chrome.runtime.sendMessage({ method: method, data: data }, function (response) {
        if(typeof callback === "function") callback(response);
    });
} 
```

**背景.js/eventPage.js：**

```
chrome.runtime.onMessage.addListener(callback);
function callback(obj, sender, sendResponse) {
    if (obj) {
        if (obj.method == 'getContent') {
            getContent(sendResponse);
        } else if (obj.method == 'othermethod') {

        }
    }
    return true; // remove this line to make the call sync!
}

//some async method
function getContent(sendResponse) {
    chrome.storage.local.get(["mydata"], function (obj) {
        var mydata = $.trim(obj["mydata"]);
        sendResponse(mydata);
    });
} 
```

* * *

如果需要从**background.js调用****popup.js**方法，则将上述代码交换到文件中。

 *** * *

**方法二：** 可以在变量中加载背景页面的引用，访问所有方法。

```
var bgPage = chrome.extension.getBackgroundPage();
 var response =  bgPage.someMethodInBGPage(); 
```**

# haskell - 读取字符串输入

> ID：13546779
> 
> 赞同：-2
> 
> 时间：2012-11-24T23:37:33.220
> 
> 标签：haskell

我正在尝试编写 Read 类的实例以将输入读取为字符串，如下所示：

```
"1 3 -    
 - 2 3      
 - - 5" 
```

将其转换为`[[Maybe Int]]`

“-”将被翻译成`Nothing` “3”将是`Just 3`

```
"('a',3) - ('b',7)
 ('c',5) ('e',0) -  
 ('d',9) - ('h',8)" 
```

将其转换为`[[Maybe (Char,Int)]]`

"-" 将被翻译成 Nothing "('a',3)" 将是`Just ('a',3)`

我试图通过处理 List of Char 来编写它们，但这需要做很多工作。你有什么建议吗？抱歉，我对 Haskell 很陌生，所以我问你这个问题。:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:52:50.980

如果你摆脱了这些`-`条目，你可以很快地做到这一点

```
Prelude> (map (map read) . map words. lines $ "('a',3) ('b',4)\n('c',5)")::[[(Char,Int)]]
[[('a',3),('b',4)],[('c',5)]] 
```

或者将其定义为一个函数

```
genericReadLines :: Read a => String -> [[a]]
genericReadLines = map (map read) . map words. lines 
```

您可以这样使用：

```
*Main> (genericReadLines "('a',3) ('b',4)\n('c',5)")::[[(Char,Int)]]
[[('a',3),('b',4)],[('c',5)]] 
```

但你可能会发现这样做更容易

```
readCharInts :: String -> [[(Char,Int)]]
readCharInts = genericReadLines

readInts :: String -> [[Int]]
readInts = genericReadLines 
```

所以你可以输入

```
*Main> readInts "1 2 3\n4 5 6\n7 8 9"
[[1,2,3],[4,5,6],[7,8,9]]
*Main> readCharInts "('a',3) ('b',4)\n('c',5)"
[[('a',3),('b',4)],[('c',5)]] 
```

* * *

但是保留`-`? 您必须使用 Maybe 数据类型来表示列表中某些点没有值；我们可以`-`用作 的简写`Nothing`和`a`的简写`Just a`。

```
read' :: Read a => String -> Maybe a
read' "-" = Nothing
read' xs = Just (read xs) 
```

我应该警告您，如果您的数据可能是，那么该代码是脆弱的`'-'`，但也许不能。

```
genericMaybeReadLines :: Read a => String -> [[Maybe a]]
genericMaybeReadLines = map (map read') . map words. lines 
```

然后我们可以有

```
readMaybeCharInts :: String -> [[Maybe (Char,Int)]]
readMaybeCharInts = genericMaybeReadLines

readMaybeInts :: String -> [[Maybe Int]]
readMaybeInts = genericMaybeReadLines 
```

所以现在我们可以做

```
*Main> readMaybeCharInts "('a',3) ('b',4)\n- ('c',5)"
[[Just ('a',3),Just ('b',4)],[Nothing,Just ('c',5)]]
*Main> readMaybeInts "2 3 -\n4 - 2"
[[Just 2,Just 3,Nothing],[Just 4,Nothing,Just 2]] 
```

# php - 使用 where 和 order by 语句时从数据库中获取行号

> ID：13546782
> 
> 赞同：4
> 
> 时间：2012-11-24T23:38:04.287
> 
> 标签：php, mysql

好的，我尝试了几种方法来做到这一点，但它们都不起作用，所以我没有要显示的代码。但我会尽我所能解释这一点。

我有一个比赛脚本，我想添加一行，向用户显示他们在当前获胜者列表下的位置。所以我希望桌子看起来像这样。

```
-----------------------------------------
| Place |    User   | Prize | Completed |
|   1   | Someuser1 | $5.00 |     5     |
|   2   | Someuser2 | $2.50 |     3     |
|   3   | Someuser3 | $1.25 |     2     |
|   20  |    You    |  ---  |     1     |
----------------------------------------- 
```

我拥有所谓的某些用户的一切，但我希望能够计算正在查看页面的当前用户可以看到他们在比赛中的位置。我可以运行什么样的查询来获取当前用户所在的位置。

我希望没有代码就有意义。

表结构

```
 Column   |  Type | Null |  Default
--------------------------------------
    id       |int(11)|  No  |   
    username |text   |  No  |   
    completed|int(11)|  No  | 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:49:48.323

有几种方法可以做到这一点。一种是计算有多少行的排名高于给定行：

```
SELECT COUNT(*) AS Place, t.*
FROM TheTable t
LEFT OUTER JOIN TheTable t2 ON t.Prize < t2.Prize
GROUP BY t.id
HAVING Place <= 3 OR user = 'You'; 
```

另一种是使用会话变量来跟踪排名：

```
SELECT * FROM (
  SELECT (@row := COALESCE(@row, 0)+1) AS Place, t.*
  FROM TheTable t
  ORDER BY Prize DESC) r
WHERE Place <= 3 OR user = 'You'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T23:49:11.767

好的，据我了解，我可以想到两种方法。

1.  有 2 个查询。第一个查询获得前 3 个，然后一个查询获得用户位置

    ```
    # First query to get top three

    if (  user not in top three) {
         $db->prepare('SELECT whatever FROM table WHERE user = ?')->execute(array($user));
    } 
    ```

2.  检索所有结果，显示前三个并与当前用户一起显示一个。

编辑：比尔的回答似乎更好:)

# android - camera.takePicture() 在我的 JB & GB & Froyo 手机上不起作用

> ID：13546788
> 
> 赞同：10
> 
> 时间：2012-11-24T23:39:14.917
> 
> 标签：android, android-camera

好吧，我再次更新了我的问题，完全是这一次。

我已经在 Galaxy Nexus(JB)、Moto-XX(GB)、SAMSUNG(Froyo) 上一一测试了以下代码，出现了不同的问题/异常。

```
public class MainActivity extends Activity {
    @SuppressLint("NewApi")
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

          ShutterCallback shutterCallback = new ShutterCallback() {
           public void onShutter() {
                  System.out.println("shutterCallback");
           }
          };

          PictureCallback rawCallback = new PictureCallback() {
           public void onPictureTaken(byte[] data, Camera camera) {
                  System.out.println("onPictureTaken");
           }
          };

          PictureCallback jpegCallback = new PictureCallback() {
           public void onPictureTaken(byte[] data, Camera camera) {
                  System.out.println("jpegCallback");
                  FileOutputStream outStream = null;
                  try {
                  System.out.println("jpegCallback begin");
                     camera.startPreview();
                     File storagePath =  new File("/mnt/sdcard/");
                     File myImage = new File(storagePath, "example2.jpg");
                     outStream = new FileOutputStream(myImage); 
                     outStream.write(data);
                     outStream.close();
                    } catch (FileNotFoundException e) {
                          System.out.println("jpegCallback FileNotFoundException");
                     e.printStackTrace();
                    } catch (IOException e) {
                          System.out.println("jpegCallback IOException");
                     e.printStackTrace();
                    } finally {
                     camera.stopPreview();
                     camera.release();
                    }
            }
          };

          if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.GINGERBREAD) {
              for (int i = 0; i < Camera.getNumberOfCameras(); i++) {
              Camera.CameraInfo info = new Camera.CameraInfo();
              Camera.getCameraInfo(i, info);
              if (info.facing == Camera.CameraInfo.CAMERA_FACING_BACK) {
                     try{
                             Camera camera = Camera.open(i);
                             Camera.Parameters parameters = camera.getParameters();
                             camera.setParameters(parameters);
                              camera.startPreview();
                             camera.setPreviewDisplay(null);
                              System.out.println("takePicture ahead");
                             camera.takePicture(null, rawCallback, jpegCallback);
                              System.out.println("takePicture finish");
                            }
                            catch (Exception e){
                                  System.out.println("printStackTrace");
                                     e.printStackTrace();
                            }
                    }
                }
            }  
    } 
```

## 具体问题如下：

* * *

**在 Android4.1&4.2**中，有**三部分**异常：
1.由“Camera camera = Camera.open(i);”引起

```
11-26 00:36:29.144: D/DOMX(132): ERROR: failed check:status >= 0 - returning error: 0x81000 - Can't connect
11-26 00:36:29.144: D/DOMX(132): ERROR: failed check:eRPCError == RPC_OMX_ErrorNone - returning error: 0x80001001 - Error initializing RPC
11-26 00:36:29.144: D/DOMX(132): ERROR: failed check:hRPCCtx != NULL - returning error: 0x81001 - NULL context handle supplied to RPC Deinit
11-26 00:36:29.144: D/DOMX(132): ERROR: rror in Initializing Proxy
11-26 00:36:29.144: E/CameraHAL(132): OMX_GetHandle() failed, error: 0x80001001 
```

2.由“camera.startPreview();”引起

```
11-26 00:36:30.488: D/DOMX(132): ERROR: failed check:(eError == OMX_ErrorNone) || (eError == OMX_ErrorNoMore) - returning error: 0x80001005 - Error returned from OMX API in ducati
11-26 00:36:30.488: E/CameraHAL(132): Error while configuring rotation 0x80001005 
```

3.由“camera.takePicture()”引起

```
11-26 00:36:30.495: E/CameraHAL(132): Adapter state switch INTIALIZED_STATE Invalid Op! event = 0x13
11-26 00:36:30.738: D/DOMX(132): ERROR: failed check:(eError == OMX_ErrorNone) || (eError == OMX_ErrorNoMore) - returning error: 0x80001005 - Error returned from OMX API in ducati
11-26 00:36:30.738: E/CameraHAL(132): Exiting function UseBuffersCapture because of ret 0 eError=80001005 
```

因此，结果是**，即使在 Galaxy Nexus i9250 等普通设备中，照片也不是在 Jelly Bean 中拍摄的**。

* * *

接下来**在 Android2.3**中，有**两部分**异常：
1.caused by "Camera camera = Camera.open(i);"

```
E/CameraSettings(1235): Param type 53 not supported        
E/CameraSettings(1235): Param type 51 not supported        
E/CameraSettings(1235): Param type 50 not supported 
```

2.尽管如此，camera.takePicture() 仍然可以执行。结果显示照片被拍了。除了一个问题：“E/MemoryHeapBase(1235): mmap(fd=50, size=0) failed (Invalid argument)”

```
11-26 01:28:33.835: I/AwesomePlayer(1235): prepareAsync_l
11-26 01:28:33.835: D/CameraHal(1235): Capture size 2048x1536, res enum 3
11-26 01:28:33.835: I/AwesomePlayer(1235): prepareAsync_l
11-26 01:28:33.835: D/CameraHal(1235): Setting capture format 0 header 2
11-26 01:28:33.835: I/HPAndroidHAL(1235): APILOG: SetCaptureDataFormat (1 2 0)
11-26 01:28:33.835: D/CameraHal(1235): Thumbnail enabled
11-26 01:28:33.843: E/MemoryHeapBase(1235): mmap(fd=50, size=0) failed (Invalid argument)
11-26 01:28:33.843: D/CameraHal(1235): Initializing capture memory raw: 0x42ee6000 (6295552), jpg: 0x434e7000 (3147776), pv 0xffffffff (0)
11-26 01:28:33.843: I/HPAndroidHAL(1235): APILOG: InitializeCaptureMemory(3 3147776 0x434e7000 6295552 0x42ee6000 0 0xffffffff)
11-26 01:28:33.843: I/HPAndroidHAL(1235): APILOG: InitializeCaptureMemoryBuffers(3 1 0_0x42de5d9c 6295552_0x42de5dc0 3147776_0x42de5d94 0_0x42de5dc8)
11-26 01:28:33.843: I/HPAndroidHAL(1235): APILOG: SetCaptureS2 with finish3A = 1
11-26 01:28:33.843: I/VorbisDecoder(1235): mNumChannels=1, mSampleRate=44100
11-26 01:28:33.843: E/OMXCodec(1235): Successfully allocated software codec 'VorbisDecoder'
11-26 01:28:33.843: I/VorbisDecoder(1235): mNumChannels=1, mSampleRate=44100
11-26 01:28:33.843: E/OMXCodec(1235): Successfully allocated software codec 'VorbisDecoder'
11-26 01:28:33.851: I/AwesomePlayer(1235): play_l
11-26 01:28:33.851: I/AwesomePlayer(1235): play_l
11-26 01:28:33.874: I/AwesomePlayer(1235): pause_l 1
11-26 01:28:33.874: I/AwesomePlayer(1235): reset_l
11-26 01:28:33.874: I/ExtendFileSource(1235): release pFilename = 0xfb690
11-26 01:28:33.874: I/AwesomePlayer(1235): reset_l
11-26 01:28:33.874: I/AwesomePlayer(1235): reset_l
11-26 01:28:33.882: I/AwesomePlayer(1235): pause_l 1
11-26 01:28:33.882: I/AwesomePlayer(1235): reset_l
11-26 01:28:33.882: I/ExtendFileSource(1235): release pFilename = 0xf9098
11-26 01:28:33.882: I/AwesomePlayer(1235): reset_l
11-26 01:28:33.882: I/AwesomePlayer(1235): reset_l 
```

因此，**在Android2.3中，拍照后都不会调用shutterCallback、rawCallback和jpegCallback中的任何一个**。

* * *

之后，**在 Android2.2**中，拍照后会调用 shutterCallback 和 rawCallback。但他们都不能为我提供数据（字节流）。如[http://developer.android.com/reference/android/hardware/Camera.html#takePicture(android.hardware.Camera.ShutterCallback, android.hardware.Camera.PictureCallback, android.hardware.Camera.PictureCallback)](http://developer.android.com/reference/android/hardware/Camera.html#takePicture%28android.hardware.Camera.ShutterCallback,%20android.hardware.Camera.PictureCallback,%20android.hardware.Camera.PictureCallback%29)中介绍的 ，如果没有可用的原始图像回调缓冲区或原始图像回调缓冲区不足以容纳原始图像，则数据将为空。而且我确实**在 rawCallback 中得到了空数据**。

* * *

**这都是硬件不兼容还是代码故障造成的？**
**请帮忙**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:16:09.763

希望你现在已经解决了你的问题，但我认为你遇到的问题是你将相机预览设置为空，它需要一个有效`SurfaceView`的预览来​​打开闪光灯（至少在 Galaxy Nexus和其他一些三星设备......）

罪魁祸首：

```
 camera.setPreviewDisplay(null); 
```

可能的解决方案：

将 a 添加`SurfaceView`到您的布局中，并将其大小指定为 1px x 1px。似乎它必须至少那么大（大小为 0 会产生不同的错误）。`SurfaceView`关闭屏幕（滚动`RelativeLayout`或其他）可能会奏效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T06:56:40.923

好的，这不是一个答案，但我不能发表评论，所以我会以这种形式尝试一下：我可以确认你在我的 Galaxy Nexus 上遇到的例外情况。

除此之外，但可能有点帮助，如果我希望我的图片不是黑色的，我必须在 startPreview 和 takePicture 之间添加一个 Thread.Sleep(500) 。

也就是说，我正在读取两台摄像机（按顺序读取，因为同时尝试只是不起作用），有时一台摄像机工作，另一台产生错误，有时两者都工作，有时没有工作。

1.  解决回调不被调用的问题：释放相机并重试。它通常有效。
2.  解决旋转 0x80001005 的问题：重新启动应用程序/服务
3.  RPC_OMX 问题：这似乎与我第一次购买这款手机时的经历非常相似。它安装了 4.0.2，偶尔，相机会“迷路”——就好像我不在那里一样。在这种情况下，只有手机重启有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T00:07:58.640

尝试放置一个 if 语句来测试您使用的文件路径是否是这样的真实目录

```
if(file.isDirectory()){

    Log.w("file test---->","filepath is good");

}else{

    Log.w("file test---->","filepath is bad");

 } 
```

仅仅说“sdcard”通常是一个坏主意，因为它在多个设备上是不同的。您最好创建自己的目录来存储文件。

# java - 布尔表达式求解器/简化器

> ID：13546791
> 
> 赞同：-1
> 
> 时间：2012-11-24T23:40:05.317
> 
> 标签：java, c++, boolean, eval, solver

我正在为非常大（但不复杂）的代数寻找布尔表达式求解器，例如： [Boolsche Ausdrücke vereinfachen (Axiome)](http://www.elektroniker-bu.de/boolesche.htm) 我想要一些代码（c++ 或 java [或库]）来简化巨大的布尔表达式。我还没有发现什么。我只想做一些“简单”的转换，比如：

```
a && ~a -> 0

a || a && (b || c) -> a 
```

但要长得多。我现在想使用符号（a、b、c1、d1..）而不是 TRUE、FALSE、0 或 1。先感谢您。

**编辑：** 如果我自己编写，我可以使用 Javaluator 并进行评估。当我有：`(adb+c) && d`我想从乘出开始。任何人的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T10:07:51.370

对于此类任务，我最喜欢的工具是`Logic Friday 1`. 它可免费用于非商业用途。

Logic Friday 1 接受布尔表达式作为公式和真值表。它包括 Berkeley 工具[Espresso](http://en.wikipedia.org/wiki/Espresso_heuristic_logic_minimizer)和 misII 的编译二进制文件。后者用于多级功能。

另一个工具是[bc2cnf](http://users.ics.aalto.fi/tjunttil/circuits/)。它将布尔表达式（或一组表达式）读取为“电路”并将其转换为合*取范式*（CNF），基本上是 OR 表达式的产物。bc2cnf 在此翻译过程中应用了一些简化规则。对于中等大小的表达式，可以选择将 CNF 转换为析*取范式*(DNF) 并使用 Espresso 来获得最小化的形式。

# php - 使用 $_SESSION 时在下一页显示错误的模块

> ID：13546793
> 
> 赞同：1
> 
> 时间：2012-11-24T23:40:12.770
> 
> 标签：php, mysql, mysqli

下面我有一个 php 脚本，它显示一个“课程”下拉菜单和一个“模块”下拉菜单。假设发生的是用户首先从“课程”下拉菜单中选择一门课程，然后属于所选课程的模块列表将出现在“模块”下拉菜单中。下面是这个的代码：

```
create_session.php  

$sql = "SELECT CourseId, CourseNo, CourseName FROM Course"; 

$sqlstmt=$mysqli->prepare($sql);

$sqlstmt->execute(); 

$sqlstmt->bind_result($dbCourseId, $dbCourseNo, $dbCourseName);

$courses = array(); // easier if you don't use generic names for data 

$courseHTML = "";  
$courseHTML .= '<select name="courses" id="coursesDrop">'.PHP_EOL; 
$courseHTML .= '<option value="">Please Select</option>'.PHP_EOL;  

while($sqlstmt->fetch()) 
{ 
    $courseno = $dbCourseNo;
    $course = $dbCourseId;
    $coursename = $dbCourseName; 
    $courseHTML .= "<option value='".$course."'>" . $courseno . " - " . $coursename . "</option>".PHP_EOL;  
} 

$courseHTML .= '</select>'; 

?>

<form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
    <table>
        <tr>
            <th>Course: <?php echo $courseHTML; ?>
                <input id="courseSubmit" type="submit" value="Submit" name="submit" />
            </th>
        </tr>
    </table>
</form>

<?php

if (isset($_POST['submit'])) {

    $submittedCourseId = $_POST['courses'];

    $query = "SELECT cm.CourseId, cm.ModuleId, c.CourseNo, m.ModuleNo,
            c.CourseName,
            m.ModuleName
            FROM Course c
            INNER JOIN Course_Module cm ON c.CourseId = cm.CourseId
            JOIN Module m ON cm.ModuleId = m.ModuleId
            WHERE
            (c.CourseId = ?)
            ORDER BY c.CourseName, m.ModuleId";

    $qrystmt=$mysqli->prepare($query);

    // You only need to call bind_param once
    $qrystmt->bind_param("s",$submittedCourseId);
    // get result and assign variables (prefix with db)

    $qrystmt->execute(); 

    $qrystmt->bind_result($dbCourseId,$dbModuleId,$dbCourseNo,$dbModuleNo,$dbCourseName,$dbModuleName);

    $qrystmt->store_result();

    $num = $qrystmt->num_rows();

    if($num ==0){
        echo "<p style='color: red'>Please Select a Course</p>";
    } else { 

        $dataArray = array();

        while ( $qrystmt->fetch() ) { 
            // data array
            $dataArray[$dbCourseId]['CourseName'] = $dbCourseName; 
            $dataArray[$dbCourseId]['CourseNo'] = $dbCourseNo; 
            $dataArray[$dbCourseId]['Modules'][$dbModuleId]['ModuleName'] = $dbModuleName; 
            $dataArray[$dbCourseId]['Modules'][$dbModuleId]['ModuleNo'] = $dbModuleNo; 

            // session data
            $_SESSION['idcourse'] = $dbCourseNo;
            $_SESSION['namecourse'] = $dbCourseName;
            $_SESSION['idmodule'] = $dbModuleNo;
            $_SESSION['namemodule'] = $dbModuleName;

            }

        foreach ($dataArray as $foundCourse => $courseData) {

            $output = ""; 

            $output .= "<p><strong>Course:</strong> " . $courseData['CourseNo'] .  " - "  . $courseData['CourseName'] . "</p>";

            $moduleHTML = ""; 
            $moduleHTML .= '<select name="module" id="modulesDrop">'.PHP_EOL;
            $moduleHTML .= '<option value="">Please Select</option>'.PHP_EOL;      
            foreach ($courseData['Modules'] as $moduleId => $moduleData) {        

                $moduleHTML .= "<option value='$moduleId'>" . $moduleData['ModuleNo'] . " - " . $moduleData['ModuleName'] ."</option>".PHP_EOL;        
            } 
        }
    $moduleHTML .= '</select>';

    echo $output;

?>

<form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
    <table>
        <tr>
            <th>Course: <?php echo $moduleHTML; ?>
                <input id="courseSubmit" type="submit" value="Submit" name="submit" />
            </th>
        </tr>
    </table>
</form> 
```

因此，假设我`INFO101 - Information Communication Technology`在“课程”下拉菜单中选择了课程，它会在下面的模块下拉菜单中显示与该课程相对应的以下模块：

```
CHI2520 - Advanced Web Programming
CHI2220 - Systems Strategy
CHI2350 - Interactive Systems 
```

现在这是我遇到的问题。如果我选择模块`CHI2520 - Advanced Web Programming`然后访问下面的页面，它会显示这个模块`CHI2350 - Interactive Systems`。

QandATable.php：

```
 <?php

    if (isset($_POST['idmodule'])) {

        $_SESSION['idmodule'] = $_POST['idmodule'];

    }

    if (isset($_POST['namemodule'])) {

        $_SESSION['namemodule'] = $_POST['namemodule'];

    }

if (isset($_POST['idcourse'])) {

$_SESSION['idcourse'] = $_POST['idcourse'];

}

if (isset($_POST['namecourse'])) {

$_SESSION['namecourse'] = $_POST['namecourse'];

}

    $outputDetails = "";
    $outputDetails .= "
    <table id='sessionDetails' border='1'>
    <tr>
    <th>Course:</th> 
    <th>{$_SESSION['idcourse']}  {$_SESSION['namecourse']}</th>
    </tr>
<tr>
<th>Module:</th> 
<th>{$_SESSION['idmodule']}  {$_SESSION['namemodule']}</th>
</tr>
    </table>
    ";

    echo $outputDetails;

    ?> 
```

我的问题是为什么它在另一页显示错误的模块编号和名称？两个页面都包含`session_start();`

下面是导航到 QandATable.php 的表单：

```
<form action="QandATable.php" method="post" id="sessionForm">
            <table><tr><th>6: Module:</th>
            <td><?php echo $moduleHTML; ?></td>
            </tr>
            </table>
            <p><strong>11: </strong><input class="questionBtn" type="submit" value="Prepare Questions" name="prequestion" /></p>   

        </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T20:47:22.453

一旦页面已经加载，您就无法分配[php 会话！](http://www.w3schools.com/php/php_sessions.asp)那么你可以，但不仅仅是 php 本身！让我解释：

*   第一个请求（表单被下载 - 没有显示模块）

*   第二个请求（新表单被下载 - 基于已提交的 courseid 显示正确的模块）

*   第三个请求（基于提交的模块ID，您必须填充php会话以供以后使用）

您试图做的是在第二个请求期间填充会话变量......但是，您无法通过这样做来检索正确的模块 ID！只有浏览器和最终的 javascript 才知道在页面位于浏览器内部的特定时间点选择了什么！

正如我刚才所说，您实际上所做的是在第二个请求中编写您的会话。**这意味着您在用户选择模块之前编写了会话变量！**而您放入会话的内容只不过是循环中最后一个获取的结果行！这就是为什么您总是在会话中使用最后一个模块的原因，在您的情况下是`Interactive Systems`！

## 让我们现在找到解决方案

如果您的课程/模块选择器正常工作，一旦用户选择了课程，就会显示正确的模块，您只需提出第三个请求！

```
<form name="moduleid" [...] >

    <option value="[moduleid]> [moduleno] - [modulename] </option>

    [...]

</form> 
```

基于这样的结构...我只是猜这就是您的模块表单的样子...您必须向服务器执行第三个请求，该请求可以在同一页面上，就像您添加模块时所做的那样选择，或在另一个！**这里的线索代码类似于下面的代码**……您甚至不必生成任何输出；）

```
if ( isset($_POST['moduleid']) )
{
    $stmt = $mysqli->prepare('select moduleno, modulename from  module where moduleid = ?');

    $stmt->bind_param('s', $_POST['moduleid'] );

    if ( $stmt->execute() )
    {   
            $stmt->bind_result($moduleno, $modulename); $stmt->fetch();

        $_SESSION['moduleid'] = $_POST['moduleid'];
        $_SESSION['moduleno'] = $moduleno;
        $_SESSION['modulename'] = $modulename;
    }
} 
```

如果您的课程/模块选择器无法正常工作......请参考我的其他答案；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:27:10.060

我不知道你从这里的原始脚本中遗漏了什么，但你的问题似乎强化了如果没有正确使用会话和发布变量可能会很棘手！[正如您可以在此处阅读](https://stackoverflow.com/questions/3559655/when-to-use-url-session-cookie-variables)的那样，这两种方法中的每一种都有一个非常特定的目的。对于您提供给我们的信息，post vars 绰绰有余:)

在您的脚本中的某个地方，您每次循环循环时都会重新分配会话变量。这意味着只有最后一个“模块”将存储在您的会话中：

```
$_SESSION['idcourse'] = $dbCourseNo;
$_SESSION['namecourse'] = $dbCourseName;
$_SESSION['idmodule'] = $dbModuleNo;
$_SESSION['namemodule'] = $dbModuleName; 
```

但是，另一方面，您没有在此代码中的任何地方使用会话......因此它们可能无用或无关紧要（至少在此页面上）！

除此之外没有必要在你的行动中做奇怪的事情！

```
<form action="" method="post"> 
```

这完全一样；）并且不涉及任何php！

还有什么...问题也可能出在您的查询中，从您的数据库中检索损坏的信息！

* * *

## 这是一个快速的解决方案

可能有一些错误......我还没有运行脚本！我没有可用的网络服务器，我的错……但您可能会发现其中的一种方法！它只是为了给你一个想法，因为你真的不需要整个会话开销；）我什至稍微改变了你的第二个查询......你很可能也不需要加入三个表！实际上**course_modules**和**module**为您提供了所有需要的信息，前提是您从之前的表单提交中获得了 courseid！

每次只运行第一个查询...加入三个表并不比进行更简单的查询更快..也就是说...这是代码：P希望这有帮助！

```
<?php $_courseid = isset($_POST['courseid']) ? $_POST['courseid'] : null; ?>

<!-- action filled only for validation purpose, all browsers will reload the same page by default -->

<form method="post" action="<?php echo $_SERVER['PHP_SELF'] ?>">

    <!-- you should be using tables for tabular data only -->

    Course: 

    <!-- using onchange is user friendly -->

    <select name="courseid" id="coursesDrop" onchange="this.form.submit()">

    <?php if ( !isset($_courseid) ): ?>

        <option selected>Please Select</option>

    <?php endif; 

    $result = $mysqli->query('select courseid, courseno, coursename from course');

    while( list($courseid, $courseno, $coursename) = $result->fetch_array() ): ?>

        <option value="<?php echo $courseid ?>" <?php if ($_courseid == $courseid) echo "selected" ?>>

            <?php echo "{$courseno} - {$coursename}" ?>

        </option>

    <?php endwhile; $result->free(); ?> 

    </select>            

    <?php if ( isset($_courseid) ): ?>

    <select name="module" id="modulesDrop">   

        <option selected>Please Select</option>         

        <?php $stmt = $mysqli->prepare('select m.moduleid, moduleno, modulename form `course_module` join `module` m using(moduleid) where courseid = ? order by m.moduleid');

        $stmt->bind_param('s', $_courseid);

        $stmt->execute();

        $result = $stmt->store_result();

        while( list($moduleid, $moduleno, $modulename) = $result->fetch_array() ): ?>

            <option value="<?php echo $moduleid ?>"><?php echo "{$moduleno} - {$modulename}" ?></option>

        <?php endwhile; $result->free(); $stmt->close(); ?>

        </select>

    <? endif; ?>

</form> 
```

# asp.net-mvc-3 - ListBoxFor 未填充所选项目

> ID：13546794
> 
> 赞同：1
> 
> 时间：2012-11-24T23:40:26.953
> 
> 标签：asp.net-mvc-3, entity-framework-4

我已经看到这个问题被问了几次，在我自己尝试了 MS 音乐商店演示无济于事后，我遵循了[这个](https://stackoverflow.com/questions/8696358/how-to-show-multiple-selected-with-asp-net-mvc-3-and-listboxfor)问题，但我仍然无法让它工作。我还注意到，当我在视图模型中查看 MultiSelectList 对象时，它在 selected items 属性中具有正确的项目，但是如果我展开结果视图，它没有任何具有所选值的 listboxitem。我在这里想念什么？我觉得我正在服用疯狂的药丸！提前致谢。

模型：

```
public class Article

    {
        public int ArticleID { get; set; }
        public DateTime? DatePurchased { get; set; }
        public DateTime? LastWorn { get; set; }
        public string ThumbnailImg { get; set; }
        public string LargeImg { get; set; }

        public virtual List<Outfit> Outfits { get; set; }
        public virtual List<Tag> Tags { get; set; }
    } 
```

视图模型：

```
public class ArticleViewModel
{
    public int ArticleID { get; set; }
    public List<Tag> Tags { get; set; }
    public MultiSelectList mslTags { get; set; }
    public virtual Article Article { get; set; }

    public ArticleViewModel(int ArticleID)
    {
        using (ctContext db = new ctContext())
        {
            this.Article = db.Articles.Find(ArticleID);
            this.Tags = db.Tags.ToList();
            this.mslTags = new MultiSelectList(this.Tags, "TagID", "Name", this.Article.Tags);

        }
    }

} 
```

控制器：

```
 public ActionResult Index()
    {
        ArticleIndexViewModel vm = new ArticleIndexViewModel(db);

        return View(vm);
    } 
```

看法：

```
 @model ClosetTracker.ArticleViewModel
        @using (Html.BeginForm())
        {

            <img id="bigImg" src="@Model.Article.ThumbnailImg" alt="img" />
            @Html.HiddenFor(m => m.ArticleID);

            @Html.LabelFor(m => m.Article.Tags)
 @*   @Html.ListBoxFor(m => m.Article.Tags, Model.Tags.Select(t => new SelectListItem { Text = t.Name, Value = t.TagID.ToString() }), new { Multiple = "multiple" })
*@  
   @Html.ListBoxFor(m => m.Article.Tags, Model.mslTags);

            @Html.LabelFor(m => m.Article.LastWorn)    
            @Html.TextBoxFor(m => m.Article.LastWorn, new { @class = "datepicker" })
            @Html.LabelFor(m => m.Article.DatePurchased)            
            @Html.TextBoxFor(m => m.Article.DatePurchased, new { @class = "datepicker" })

            <p>
                <input type="submit" value="Save" />
            </p>
        } 
```

**已编辑**

好的，我改变了 MultiSelectList 的构造函数，在所选值 arg 中有一个 TagID 列表，而不是一个 Tag 对象列表。当我在调试模式下观察 mslTags 对象时，这会显示结果视图中选择的正确标签。但是，它仍然无法正确呈现到页面。

```
 public class ArticleViewModel
    {
        public int ArticleID { get; set; }
        public List<Tag> Tags { get; set; }
        public MultiSelectList mslTags { get; set; }
        public virtual Article Article { get; set; }

        public ArticleViewModel(int ArticleID)
        {
            using (ctContext db = new ctContext())
            {
                this.Article = db.Articles.Find(ArticleID);
                this.Tags = db.Tags.ToList();
                this.mslTags = new MultiSelectList(this.Tags, "TagID", "Name",  this.Article.Tags.Select(t => t.TagID).ToList());

            }
        }

    } 
```

**更新 2**

我尝试使用 listbox helper 而不是 listboxfor 并且效果很好

@Html.ListBox("ArticleTags", new MultiSelectList(Model.Tags, "TagID", "Name", Model.selectedTagIDs))

# wordpress - WordPress定位

> ID：13546804
> 
> 赞同：0
> 
> 时间：2012-11-24T23:41:59.310
> 
> 标签：wordpress

我在我的 Wordpress 网站上将元素居中时遇到问题。

使用以下代码：

```
<div id="ss" >
<?php echo do_shortcode( "[smoothslider]" ); ?>
</div> 
```

在网站上：www.enyx.sk

我添加了一个名为“smoothslider”的插件。我尝试通过以下方式更改 div 在 css 中的位置：

边距：0 自动；

并且

左边距：自动；右边距：自动；

没有任何效果。谁能给我一个关于这个问题的建议？我不知道出了什么问题。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:44:41.803

你应该穿上`width`div：

```
<div id="ss" style="width: 600px; margin: 0 auto;">
   <?php echo do_shortcode( "[smoothslider]" ); ?>
</div> 
```

# c++ - 可能重复： >?= 运算符是什么意思？ 我遇到过这条线， 问问题 问问题 2012-11-24T23:42:00.357 208 次 This question shows research effort; it is useful and clear 3 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 可能重复： >?= 运算符是什么意思？ 我遇到过这条线， bot

> ID：13546805
> 
> 赞同：3
> 
> 时间：
> 
> 标签：c++

> **可能重复：**
> [>?= 运算符是什么意思？](https://stackoverflow.com/questions/5199630/what-does-the-operator-mean)

我遇到过这条线，

```
bot <?= fnet[v][u] ? fnet[v][u] : ( cap[u][v] - fnet[u][v] ); 
```

这个`<?=`标志是什么意思？Visual Studio 2012 说它不存在，那它是什么？也许它在以前的一些版本中？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T23:45:20.180

Visual Studio 是对的，运算符不再有效。我不确定它是否曾经是，或者它是一种语言扩展。编辑：这是一个已删除的 gcc 扩展 - [http://gcc.gnu.org/ml/gcc/2005-09/msg00299.html](http://gcc.gnu.org/ml/gcc/2005-09/msg00299.html)

这是一个条件赋值 -`a <?= b`意思是“赋值`b`给`a`if `a < b`”。

您可以使用`std::min`and`std::max`代替。

```
bot <?= fnet[v][u] ? fnet[v][u] : ( cap[u][v] - fnet[u][v] ); 
```

将转化为

```
bot = std::min(bot, fnet[v][u] ? fnet[v][u] : (cap[u][v]-fnet[u][v]) ); 
```

# python - Python读取文件中的每个字符串

> ID：13546809
> 
> 赞同：1
> 
> 时间：2012-11-24T23:42:29.560
> 
> 标签：python, string, file, input, int

我有一个文本文件：

```
1 0 1 0 1 0

1 0 1 0 1 0

1 0 1 0 1 0

1 0 1 0 1 0 
```

我希望能够检索每个字符串并将其转换为整数数据类型，但我的一段代码导致`ValueError: invalid literal for int() with base 10: ''`

```
tile_map = open('background_tiles.txt','r');

    for line in tile_map:

        for string in line:

             self.type = int(string); 
```

检索数据并成功转换的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-24T23:47:00.330

遍历文件时要记住的一件事是包含换行符，当您尝试使用 进行`int()`转换时，您将收到您正在引用的错误（因为 Python 不知道如何将其转换为整数）。尝试使用类似的东西：

```
with open('background_tiles.txt', 'r') as f:
    contents = f.readlines()

for line in contents:
    for c in line.split():
        self.type = int(c) 
```

这`with`是一个上下文管理器，它通常是一种更有效的文件处理方式，因为它会在离开块时自动为您处理诸如关闭之类的事情。`readlines`将文件读入一个列表（每一行表示为一个列表元素），并`split()`在空间上分割。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T23:44:41.907

您的行包含类似 - 的字符串`"1 0 1 0 1 0"`。你需要在空间上分割你的行： -

```
for string in line.split():
    self.type = int(string); 
```

# java - 使用 InputStream 时的同步

> ID：13546811
> 
> 赞同：0
> 
> 时间：2012-11-24T23:42:47.223
> 
> 标签：java, synchronization, mapreduce, java.util.scanner, bufferedreader

我需要实现一个简短的 Map-Reduce 程序。我需要做的一项操作是将 txt 文件拆分为 X 部分，这样当我只对文件片段执行读取操作时，每个部分都将用作我的 Map 函数的输入。

我可以将文件拆分为更多本地文件，并将每个文件用作 Map 函数的输入。但我正在考虑尝试这个解决方案：在文件中的不同位置使用 InputStream 构建的 X 扫描仪中拆分文件。

当每个线程使用 Scanner 对象时，我会遇到同步问题吗？它会因为每个线程都试图访问同一个文件而变慢吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T01:32:59.003

原则上，如果你小心，那么*如果*操作系统允许你应该能够做到这一点。我建议为每个线程打开文件上的 BufferedReader，然后获取相应的 FileChannel 对象（通过 BufferedReader.getChannel()）并**锁定该线程打算处理的部分**（请参阅 FileChannel.lock()）。如果操作系统能让你走到这一步，我认为你不应该有任何实际问题。

但是，我想知道以这种方式做事是否有很多性能优势。如果可以的话，我怀疑从性能的角度来看，**让单个线程通过文件串行执行实际读取，然后根据需要将连续行耕种到线程池**，每个线程运行一个扫描仪。

# app-store-connect - 图标未显示在 xcode 管理器中

> ID：13546817
> 
> 赞同：1
> 
> 时间：2012-11-24T23:43:44.240
> 
> 标签：app-store-connect, xcode4.5, archive, organizer

参考问题[Xcode 4.1 Archive Build in Organizer 不显示 icon](https://stackoverflow.com/questions/6808357/xcode-4-1-archive-build-in-organizer-doesnt-show-icon)。我正在使用 xcode 4.5 (IOS6)

我遇到了一个问题，我已经尝试了所有我能找到的关于此的 SO 答案，但它仍然无法正常工作。所以你我只是要上传到应用商店，我在[http://www.raywenderlich.com/8045/how-to-submit-your-app-to-apple-from-no-account -to-app-store-part-2](http://www.raywenderlich.com/8045/how-to-submit-your-app-to-apple-from-no-account-to-app-store-part-2)是时候归档了。我去存档，在组织者中我的图标是空白的！没有问号什么的，就是空白。

我尝试过的：将所有相关的图标文件添加到 plist (Icon.png, Icon@2x.png, iTunesArtwork) 在键 Icon Files、Icon Files (IOS5)、Icon File 中尝试过，也可以单独使用。尝试在支持文件文件夹和根目录之间移动文件（不再有资源文件夹）

我已经没有想法了！这一步有那么重要吗？我的意思是图标显示在手机上，当然还有应用商店设置。无论如何，所有帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-19T05:57:15.390

只是证实了之前回答者的假设：尽管我将所有图标文件都添加到了我的 XCode 项目中，但当我归档应用程序时，图标并没有出现在 Organizer 中。我还是提交了二进制文件，它被接受了——它一定是一个 XCode 错误，但这没什么大不了的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:40:55.263

我的两分钱：如果你看到它出现在手机上并且确定你在那里添加了所有的图标/艺术品文件，你可能没什么好担心的。

或者，您可以查看使用 Xcode->Organizer->Archives->YourApp->“Validate”按钮获得的结果，

或者

您可以尝试在选中“等待直到我告诉您发布它”（释义）选项的情况下将其提交到应用商店，然后在您的 iTunes 连接帐户中查看它的外观。如果您看到那里的图标/艺术品并且看起来都很花哨，那么您应该很高兴。这样，如果有什么看起来很有趣，您可以在图标上线之前重新提交图标（我相信您可以将其作为元数据而不是整个二进制文件来完成）。

作为旁注，我相当肯定 iTunes 很可能会拒绝并且不会发布不包含图标/艺术品的应用程序。

希望有帮助。

# jquery - Phonegap jquery ajax表单提交不起作用

> ID：13546820
> 
> 赞同：3
> 
> 时间：2012-11-24T23:43:53.580
> 
> 标签：jquery, cordova

我是 Phonegap 和 jQuery 的新手，但研究过如何通过 jQuery ajax 提交表单。此代码在网页中有效，但在由 Phonegap 构建和安装时在 android 模拟器中失败。如您所见，我已经设置了`$.mobile.allowCrossDomainPages = true;`. 当我在模拟器中测试时，屏幕闪烁了几次，表单被清除，好像页面重新加载一样，并且没有任何内容写入服务器。

```
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
    </title>
    <link rel="stylesheet" href="css/jquery.mobile-1.2.0.css" />
    <link rel="stylesheet" href="enter.css" />
    <style>
        /* App custom styles */
    </style>

    <script>
        $( document ).bind( "mobileinit", function() {
          // Make your jQuery Mobile framework configuration changes here!

          $.mobile.allowCrossDomainPages = true;
        });

        function doform()
        {

            var datas = $("#enteractivity").serialize();
            $.ajax({

              url: "http://www.scottallencarter.com/llp/record.logactivity",
              data: datas,
              async: false,
              cache: false,
              dataType: 'text',
              type: 'POST',
              jsonp: 'jsoncallback',
              timeout: 120000,
              crossDomain: true,
              error: function (xhr, ajaxOptions, thrownError) {
                    alert('error');

                },
              success: function(msg){ 
                    alert('done success');
                    return true;
                }
            });

        }
    </script>
    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="js/jquery.mobile-1.2.0.min.js"></script>
    <script src="enter.js"></script>
</head>
<body>
    <!-- Home -->
    <div data-role="page" data-theme="a" id="page1">
        <div data-theme="c" data-role="header">
            <h3>
                Activity
            </h3>
        </div>
        <div data-role="content">
            <form id="enteractivity" name="enteractivity" onsubmit="doform()">
                <div data-role="fieldcontain">
                    <fieldset data-role="controlgroup">
                        <label for="activityspecifics">
                            Activity
                        </label>
                        <input name="activityspecifics" id="activityspecifics" placeholder="Enter Activity" value="" type="text" />
                    </fieldset>
                </div>
                <div data-role="fieldcontain">
                    <label for="category">
                        Category:
                    </label>
                    <select name="category" data-theme="c">
                        <option value="">(choose one)</option>
                        ...
                        <option value="Test">Test</option>
                    </select>
                </div>
                <div data-role="fieldcontain">
                    <label for="activityInCategory">
                        Specific Category:
                    </label>
                    <select name="activityInCategory" data-theme="c">
                        <option value="AddSubCategory">+ Add New Specific Category</option>
                        <option value="">------------</option>
                        ...
                    </select>

                </div>
                <input type="hidden" name="userid" value="1-1-1-1-1">
                <input type="hidden" name="mobile" value="true">
                <input type="submit" data-inline="true" data-theme="b" data-icon="arrow-r" data-iconpos="left" value="Submit" />
            </form>
        </div>
    </div>
</body> 
```

此外，当表单确实从网页提交时，它总是返回错误。不确定我需要从服务器端返回什么才能成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T23:57:28.023

I do not know if Phonegap just read the `index.html` file from the first run..

so, move any `ajax` form submission on `form.html` to `index.html` at the bottom of the body tag.

its work for me

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T04:44:53.827

好的，找到问题了。这实际上是对 jquery mobile 工作原理的误解。带有表单的页面是从另一个页面链接的，默认的 jquery 移动行为是通过 ajax 加载页面并忽略 head 部分。提交表单的脚本位于 head 标记中。将 ajax 表单提交的脚本移动到页面中 body 标记的底部修复了该问题。感谢您的帮助，我希望这对其他人有所帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-25T00:19:50.803

您不能将*POST*与*JSONP*混合使用。*JSONP*正在使用*GET*。
但是，服务器必须支持*JSONP*。查看您的示例，应该已经是这种情况了。

**试试这个：**
这是一个工作示例，我正在使用：

```
$.ajax({
    url: 'http://www.yoursite.com',
    contentType: "application/json; charset=utf-8",
    data: datas,
    dataType: "jsonp",
    success: function (json) {
        // Do some stuff
    },
    error: function (data, textStatus) {
        // Error handling
    }
}); 
```

* * *

**编辑：仅供参考，如果您通过***POST*
跨域发送数据，您将始终收到错误，因为浏览器会丢弃响应（尽管它存在）。 您可以创建一个本地 html 页面（使用您的示例代码）并使用您的浏览器打开它。*然后用fiddler*和*firebug* 检查流量。*AFAIK，您只能使用JSONP* 从跨域请求中接收数据。

 *****此致*****

# visual-studio-2010 - 在 Visual Basic for Windows Phone 7 中轻松生成随机数

> ID：13546823
> 
> 赞同：0
> 
> 时间：2012-11-24T23:44:15.827
> 
> 标签：visual-studio-2010, windows-phone-7, vba, random, numbers

如何使用 Visual Basic for Windows Phone 获取随机数 (1-6)？我已经尝试过的一切都导致了错误。以下是一些一直在产生错误的代码示例：

```
Randomize()
Dim randnum As Integer = CInt(Int((6 * Rnd()) + 1)) 
```

“'Randomize' 未声明。函数已移至 'Microsoft.VisualBasic' 命名空间。” “'Int' 未声明。由于其保护级别，它可能无法访问。” “'Rnd' 未声明。函数已移至 'Microsoft.VisualBasic' 命名空间。”

我需要做什么？相同的代码在 Visual Basic 中也能正常工作。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:48:52.860

`Random`Phone 7.x 支持该类

```
 Dim r As New Random
    Dim From1to6 = r.Next(1, 7) 
```

# imagemagick - 如何在 mac os x Lion 上卸载 ImageMagick？

> ID：13546824
> 
> 赞同：0
> 
> 时间：2012-11-24T23:44:35.120
> 
> 标签：imagemagick, osx-lion

我在我的 Lion OS 上错误地安装了适用于 Mac OS X 山狮的 ImageMagick。如何卸载干净？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T23:47:25.763

[http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=14274](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=14274)

试试这种卸载方式。虽然这可能是一项小工作，但您可能是最好的选择。

# php - 将 YouTube 视频添加到产品和 CMS 页面 Magento

> ID：13546829
> 
> 赞同：1
> 
> 时间：2012-11-24T23:45:14.530
> 
> 标签：php, zend-framework, magento, module, content-management-system

我在我的 Magento 商店中创建了一个自定义属性，以便通过将视频 ID 添加到文本字段来显示 youtube 视频。

我已将此代码放在`video.phtml`文件`catalog/product/view`夹中

```
<p>
<?php $attStuff= $_product->getData(); ?>
<?php if( !empty( $attStuff['videoid'] ) ): ?>
<iframe width="330" height="253" src="http://www.youtube.com/embed/<?php echo $attStuff['videoid']; ?>" frameborder="0" allowfullscreen></iframe>
<?php endif; ?>
</p> 
```

我现在希望在 CMS 页面的右侧边栏中显示视频，并添加了布局更新引用`video.phtml`：

```
 <reference name="right"> 
 <block type="core/template" name="catalog.product.video"   template="catalog/product/view/video.phtml" /> 
  </reference> 
```

我现在收到以下错误：

> 致命错误：在第 13 行的 /Applications/MAMP/htdocs/mysite/app/design/frontend/bootstrapped/default/template/catalog/product/view/video.phtml 中的非对象上调用成员函数 getData()

我无法诊断问题！

关于这里可能存在什么问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:24:10.770

你很亲密。`core/template`您需要使用能够检查当前产品的类，而不是将块类型设置为。该`catalog/product_abstract`块具有这些功能。为您的布局文件执行此操作：

```
<reference name="right"> 
    <block type="catalog/product_view" name="catalog.product.video" template="catalog/product/view/video.phtml" /> 
</reference> 
```

然后，在您的视频文件中：

```
<p>
    <?php $_product = $this->getProduct(); ?>
    <?php if($_product->getVideoid()): ?>
    <iframe width="330" height="253" src="http://www.youtube.com/embed/<?php echo $_product->getVideoid(); ?>" frameborder="0" allowfullscreen></iframe>
    <?php endif; ?>
</p> 
```

* * *

**编辑：**

如果您在 CMS 页面上使用它，那将变得更具挑战性。您需要确定要检索视频的产品。有很多方法可以做到这一点。如果您在 CMS 页面中使用布局更新，您可以执行以下操作：

```
<reference name="right"> 
    <block type="catalog/product_view" name="catalog.product.video" template="catalog/product/view/video.phtml">
        <action method="setProductSku"><sku>sku-here</sku></action>
    </block> 
</reference> 
```

然后，在您的视频文件中：

```
<?php $_product = Mage::getModel('catalog/product')->load($this->getProductSku(), 'sku'); ?>
<?php if ($_product->getId() && $_product->getVideoid()): ?>
<p>
    <iframe width="330" height="253" src="http://www.youtube.com/embed/<?php echo $_product->getVideoid(); ?>" frameborder="0" allowfullscreen></iframe>
</p>
<?php endif;?> 
```

我建议使用这种方法，因为这听起来好像您不太熟悉创建自己的模块。我强烈建议您查一下，因为我在这里向您展示的并不是最佳实践，即在块模板文件中加载模型。它应该被移动到它自己的块类中（可以扩展`Mage_Catalog_Block_Product_Abstract`，并覆盖该`getProduct()`方法）。

* * *

**编辑#2：**

可以使用产品 ID。在布局 xml 中，更改

```
<block type="core/template" name="catalog.product.video" template="catalog/product/view/video.phtml">
    <action method="setProductId"><id>id-here</id></action>
</block> 
```

在模板代码中，使用这一行：

```
<?php $_product = Mage::getModel('catalog/product')->load($this->getProductId()); ?> 
```

# delphi - 为什么 FindFirstFile/FindNextFile 没有列出 Windows 7 上系统目录的全部内容？

> ID：13546833
> 
> 赞同：3
> 
> 时间：2012-11-24T23:45:36.650
> 
> 标签：delphi, winapi, windows-7, delphi-xe3

我有一个小问题。API`FindNextFile`不会列出目录的全部内容`C:\Windows\System32`（仅限 Windows 7）。任何人有任何解决方案？

代码[德尔福]：

```
Var
  sAtr:       String;
  sPathName:  String;
  I:          Integer;
  iCont:      Integer;
  tHnd:       THandle;
  tArrAtr:    TStringList;
  tWDF:       WIN32_FIND_DATA;
Begin
  iCont := 0;
  sAtr := '';
  Result := TStringList.Create;
  tArrAtr := TStringList.Create;
  tHnd := FindFirstFile(PChar(sPath + '*.*'), tWDF);

  If RightStr(sPath, 1) <> '\' Then
    sPath := sPath + '\';

  If tHnd = INVALID_HANDLE_VALUE Then
    Exit;

  Repeat
    If (tWDF.dwFileAttributes And FILE_ATTRIBUTE_ARCHIVE) > 0 Then
      If (String(tWDF.cFileName[0]) <> '.') Then
      Begin
        sPathName := sPath + String(tWDF.cFileName);

        Result.Add(String(tWDF.cFileName) + sDel +
                   GetFileSizeAPI(sPathName));
        sAtr := '';
        Inc(iCont);
      End;
  Until (FindNextFile(tHnd, tWDF) <> True);

  //CloseHandle(tHnd); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-25T11:06:02.790

我敢打赌，你有一台 64 位机器和一个 32 位进程。[文件系统重定向器](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384187%28v=vs.85%29.aspx)进来播放并`System32`重定向到`SysWOW64`.

避免重定向器的最佳方法是执行 64 位进程。或者您可以列出`Sysnative`从 32 位进程中获取 64 位系统文件夹。您甚至可以禁用文件系统重定向器，但这样做非常危险，我不建议这样做。

此外，您通过调用`FindClose`而不是`CloseHandle`. 您应该在调用之前添加反斜杠`FindFirstFile`。`.`并`..`通过将全名与这些特殊值进行比较来测试特殊值。

# php - 确定返回的代码格式

> ID：13546834
> 
> 赞同：4
> 
> 时间：2012-11-24T23:45:58.980
> 
> 标签：php, drupal

我试图找出这种格式是什么：

```
a:2:{i:0;s:2:"29";i:1;s:2:"30";} 
```

它有点像json。为了提供背景信息，我将 php/drupal 与 webform 模块一起使用，并提交表单返回一个输入字段作为文件上传框的此值。

我正在尝试获取 29 和 30。希望有一种简单的方法可以获取这两个数字，而无需使用正则表达式解析字符串。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T23:48:05.983

这是一个序列化数组。

您可以通过以下方式使用 PHP 获取值：

`$value = unserialize('a:2:{i:0;s:2:"29";i:1;s:2:"30";}');`

你可以在这里阅读更多：http: [//php.net/manual/en/function.serialize.php](http://php.net/manual/en/function.serialize.php)

# iphone - 获取我的 FB 页面的通知

> ID：13546836
> 
> 赞同：0
> 
> 时间：2012-11-24T23:46:20.727
> 
> 标签：iphone, ios, facebook

请允许我描述一下我的最终目标：我正在运行一个 Facebook 页面，我希望我的用户也可以选择安装我的品牌 iPhone 应用程序，该应用程序将向他们显示页面中的所有帖子（仅根帖子 - 不需要提出意见）。

该应用程序还应该支持推送通知（在页面上的每个新帖子上），并且还能够分析所有帖子并按排序顺序（按喜欢的数量）呈现它们。

我浏览了新的 FB API，并没有真正想出一个方向。

知道我应该如何实现这个吗？

10倍

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T05:29:01.307

您可以尝试适用于 iOS 的 facebook sdk。

1.  要在页面中显示帖子，您可以通过 Facebook 对象请求 ${pageId}/feed。像这样的东西。这是[页面对象](http://developers.facebook.com/docs/reference/api/page/)。

    ```
    [facebook requestWithGraphPath:@"pageId/feed" andDelegate:self]; 
    ```

2.  推送通知，您必须通过检查相同的 ${pageId}/feed 来检查页面中是否有新的提要，可能每 2 分钟在您的服务器中。如果 ${pageId}/feed 中有新帖子，您可以将内容推送给您的粉丝。

3.  从 iPhone 中的 ${pageId}/feed 获取数据（这是一个 post 对象）后，您可以将它们存储到核心数据中。[帖子](http://developers.facebook.com/docs/reference/api/post/)对象中有一个“喜欢”字段供您订购。

# java - 未捕获异常的原因？

> ID：13546845
> 
> 赞同：4
> 
> 时间：2012-11-24T23:47:43.870
> 
> 标签：java, exception, maven, eclipselink

我有一些抛出 OptimisticLockException (JPA Exception) 的代码：

```
try{
    account.someFunction();
}catch(OptimisticLockException ole){
    logger.log(Level.DEBUG, "OptimisticLockException with ole !");      
}catch(Exception e){
    logger.log(Level.DEBUG, "OptimisticLockException with e !");
} 
```

我总是收到`OptimisticLockException with e !`。我的服务器日志显示：

```
Exception [EclipseLink-5006] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.OptimisticLockException
... 
```

我`OptimisticLockException`在我的 catch 块中的类型`org.eclipse.persistence.exceptions.OptimisticLockException`与我的服务器日志中的类型类似，但我从未落入这个 catch 块......

为什么...？

感谢您的想法。

PS：我与 Maven 和 Glassfish 一起工作。一开始，我使用的是工件 eclipselink v2.4.1，而服务器端是 2.3.2（请参阅日志），所以我将 Maven 版本更改为 2.3.2，但结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T14:12:26.443

显然，我们无法直接捕获 OptimisticLockException（在 javax.persistence 或 org.eclipse.persistence.exceptions 包中），因为它被包装在其他异常中。

我测试了这段代码：

```
try{
        account.someFunction();
    }catch(OptimisticLockException o1){
        logger.log(Level.DEBUG, "org.eclipse.persistence.exceptions.OptimisticLockException thrown !");         
    }catch(javax.persistence.OptimisticLockException o2){
        logger.log(Level.DEBUG, "javax.persistence.OptimisticLockException thorwn !");          
    }catch(Exception e){            

        int i=1;

        for(Throwable t=(Throwable)e; t!=null; t=t.getCause()){
            if(t instanceof OptimisticLockException)
                logger.log(Level.DEBUG, "org.eclipse.persistence.exceptions.OptimisticLockException thrown by Exception block ! " + i);
            else if(t instanceof javax.persistence.OptimisticLockException)
                logger.log(Level.DEBUG, "javax.persistence.OptimisticLockException thrown by Exception block ! " + i);
            else
                logger.log(Level.DEBUG, t + " " + i);
            i++;
        }

    } 
```

我得到：

> 2012-11-26 14:58:03,515 致命 [com.sim.web.LoginBean] javax.ejb.EJBException：事务中止 1
> 
> 2012-11-26 14:58:03,515 致命 [com.sim.web.LoginBean] javax.transaction.RollbackException：标记为回滚的事务。2
> 
> 2012-11-26 14:58:03,515 FATAL [com.sim.web.LoginBean] javax.persistence.OptimisticLockException 抛出异常块！3
> 
> 2012-11-26 14:58:03,515 FATAL [com.sim.web.LoginBean] org.eclipse.persistence.exceptions.OptimisticLockException 抛出异常块！4

所以首先有一个`org.eclipse.persistence.exceptions.OptimisticLockException`被包裹进`javax.persistence.OptimisticLockException`哪个被包裹进`javax.transaction.RollbackException`哪个被包裹进`javax.ejb.EJBException`（我正在使用EJB和JTA）。

我无法使用 catch 块`RollbackException`异常进行测试，因为 Eclipse 没有检测到可以抛出这样的异常：`Unreachable catch block for RollbackException. This exception is never thrown from the try statement body`。

这很丑陋，但我认为我注定要捕获类型异常`Exception`并递归测试它是否包含类型异常`OptimisticLockException`...

感谢您之前的建议

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:36:58.713

尝试将您的代码更改为以下内容：

```
try {
    account.someFunction();
}
catch(javax.persistence.OptimisticLockException ole) {
    logger.log(Level.DEBUG, "OptimisticLockException with ole !");      
}
catch(Exception e) {
    logger.log(Level.DEBUG, "OptimisticLockException with e !");
} 
```

看看这是否有效。我认为您会想要捕获 JPA OptimisticLockException，而不是 Eclipse 实现。

此外，仔细检查您的日志配置，确保您的阈值是正确的，看看您是否能够在 DEBUG 级别获取其他日志语句（也许在`account.someFunction();`.

# ruby-on-rails - 如何迭代对象模型的值？

> ID：13546847
> 
> 赞同：0
> 
> 时间：2012-11-24T23:47:49.533
> 
> 标签：ruby-on-rails, activerecord

我有 2 个对象**Weeklyactivity**和**Weeklyfood**。Weeklyactivity 具有名为**food_id**的属性。**Weeklyfood**有 7 个属性，分别称为**mon, tue, ..., sun**。

当用户单击更新每周食物时，操作方法检索给定一周的每日活动。它还检索所有weeklyfood 对象，其中包含用户在该周的每一天吃的食物的**ID 。**

```
Weeklyactivities = Weeklyactivity.where(:week => wk)
@weeklyfood = Weeklyfood.New(forms[:weeklyfood]) 
```

现在我想遍历weeklyfood 并传输它的数据，其中包含用户一周中每天吃的食物的ID。

我不知道这是否是正确的方法，或者是否有一种编写此代码的紧凑方法。

```
Weeklyactivities[:day => 'mon'].food_id = @weeklyfood[:mon]
Weeklyactivities[:day => 'tue'].food_id = @weeklyfood[:tue]
//and son ... 
```

# 编辑

我收到以下错误：**“无法将哈希转换为整数......”**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:50:35.433

不确定我是否理解这个问题。

您有一个`Weeklyactivity`具有属性`week`和`day`（和其他）的模型？

根据您的代码示例，您已经在数据库中创建了一周内所有天的行`Weeklyactivity`？

现在您想从表单更新这些行吗？

在那种情况下，我有这个建议：

```
@weeklyfood = Weeklyfood.New(forms[:weeklyfood])
Weeklyactivity.where(:week => wk).each do |weekly_activity|
  if food_id = @weeklyfood[weekly_activity.day.to_sym]
    weekly_activity.food_id = food_id
    unless weekly_activity.save
      # do stuff if not successful
      break
    end
  end
end 
```

而且我认为您的对象应该分别命名`Weeklyactivity`和使用表格和`Weeklyfood``WeeklyActivity``WeeklyFood``weekly_activities``weekly_foods`

# css - 锚标记上的边框底部填充

> ID：13546851
> 
> 赞同：7
> 
> 时间：2012-11-24T23:48:52.053
> 
> 标签：css, header, border, padding

我在标题中有一个锚标签，我试图在锚标签上放置一个边框底部，这可以工作，但是底部的填充太大并且负填充不起作用，我该如何解决这个问题？

现场[直播](http://anderskitson.ca/update)

**html**

```
<div id="featureText">
        <h1>Recent Works / <a href="#">All</a></h1>
    </div> 
```

**css**

```
#featureText a {
    color: #414042;
    text-decoration: none;
    border-bottom: solid 2px #414042;
    padding-bottom: -2px; } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-24T23:56:38.667

```
#featureText a {
    line-height: 1em;
    display: inline-block;
    color: #414042;
    text-decoration: none;
    border-bottom: solid 2px #414042;
    padding: 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-24T23:57:25.170

我建议：

```
#featureText h1 a {
    /* all your other CSS... */
    display: inline-block;
    line-height: 1em;
} 
```

# sql - SQL Server 中的 sp_rename 编程错误

> ID：13546855
> 
> 赞同：0
> 
> 时间：2012-11-24T23:49:15.073
> 
> 标签：sql, sql-server-2008

您能否就如何正确编写此代码提出建议：

```
declare @str nvarchar(50)
Set @str = '[table1].[column_name1]'
sp_RENAME @str, 'column2', 'COLUMN' 
```

它目前给出了一个错误

> *“sp_RENAME”附近的语法不正确*

这应该等同于：

```
sp_RENAME '[table1].[column1]', '[column2]', COLUMN 
```

用于重命名表中的列。

我需要使用第一种方法，因为这是程序中的一般步骤。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T23:54:39.180

我刚试了你的代码，一点问题都没有，难道是你忘记使用“执行”来调用存储过程了？

```
declare @str nvarchar(50)
Set @str = '[table1].[column_name1]'
execute sp_RENAME @str, 'column2', 'COLUMN' 
```

# java - 处理大量大型jpg

> ID：13546856
> 
> 赞同：2
> 
> 时间：2012-11-24T23:49:37.367
> 
> 标签：java, image, swing

我正在编写一个程序，部分只是为了好玩，部分是为了帮助我处理一堆我想划分为打印类别的数字图片。主要思想是它应该在单列中显示图片，并在每张图片旁边有一组带有类别名称的复选框。我检查了所需的复选框，按“开始！” 按钮，图片会被复制到子文件夹中，具体取决于所选的复选框。

现在，一切都差不多完成了——除了一件事。有问题的图片是大 jpg，每张大约 7-8MB，大约有 700 张。如果我尝试一次全部加载它们，自然地，将它们全部加载需要大量的内存和时间。那么，有没有很好的解决问题的办法呢？我的两个想法如下。

1) 一次加载 10 张图片并在某处设置下一个/上一个按钮。我不喜欢这个想法，因为它添加了不需要的元素。2）让应用程序在您滚动到新图片时加载它们并卸载您滚动过去的那些。我真的喜欢这个主意。

有人可以为我指出正确的方向，至于我如何实施后一个想法吗？我只在 Google 上找到了一个相关[链接](http://sahits.ch/blog/?p=1205)，但我不能说它对我有帮助，我对代码的某些部分感到有些困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T00:10:20.767

如果缩略图就足够了，这个[答案](https://stackoverflow.com/a/6916719/230513)包括一个简单的重采样方法，并引用了一些权衡。如果没有，此[答案](https://stackoverflow.com/a/13522496/230513)概述了显示和缓存最近图像的一般方法。

在任何一种情况下，默认的`Boolean` [渲染器/编辑](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)`JTable`器都是`JCheckBox`. [`CheckOne`](https://stackoverflow.com/a/7920159/230513)是一个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T01:11:00.580

您必须为所有图片创建缩略图，您可以将缩略图保存在内存中。这可能需要很多时间。

然后你要么准备好了pronblem。否则缩略图将无法全部放入内存。如果是这种情况：您加载其中的 30-40 个，在滚动期间您检测滚动方向，并将下一组加载到单独的线程中。

如果加载速度比用户滚动速度慢，那么您将为此类“尚未加载的图片”显示默认占位符图像

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T07:11:06.943

如果这是一个“使用一次就扔掉”的程序，我不会费心去解决这个问题。我会使用命令行为每张图片生成缩略图，并在我的程序中使用这些生成的缩略图。在内存中保留 700 个缩略图应该是可行的。

如果这不是一个选项，我会从`JTable`. 您可以创建一个`TableModel`而无需将所有图像加载到内存中。你只需要知道图像数量。将`JTable`只想渲染当时可见的图像。需要注意的是，在渲染器请求图像时加载图像可能为时已晚。我可以想象，`JTable`当您必须加载几 MB 大小的图像时，它不会顺利运行。但这可能可以通过使用填充有工作线程的缓存来解决。因此，如果渲染器请求第 5 张图像，您还将前 5 张图像和后 5 张图像加载到缓存中。

另请注意，如果您正在移动图片 iso 复制它们，这可能会影响您`TableModel`，因为目录中的图像数量会发生变化。一定要考虑到这一点！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T01:35:07.477

您可以缩小所有图像以使用更少的 RAM。例如，此代码将所有图像缩小到 200x200。这样，您可以在 100MB 中容纳 1000 张图像。

```
import javax.swing.*;
import java.awt.*;
import java.awt.image.*;
import javax.imageio.ImageIO;
import java.io.File;

public class Scroll extends JPanel {
    public static void main(String[] args) throws Exception {
        JFrame frame = new JFrame();
        JPanel panel = new Scroll();

        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));

        for(int i = 0; i < 10; i++) {
            JPanel buttonPanel = new JPanel();
            JRadioButton b1 = new JRadioButton("button 1");
            JRadioButton b2 = new JRadioButton("button 2");
            JRadioButton b3 = new JRadioButton("button 3");
            ButtonGroup group = new ButtonGroup();
            group.add(b1);
            group.add(b2);
            group.add(b3);
            buttonPanel.add(b1);
            buttonPanel.add(b2);
            buttonPanel.add(b3);

            BufferedImage buffer = new BufferedImage(200,200,BufferedImage.TYPE_INT_RGB);
            Graphics2D g = buffer.createGraphics();

            BufferedImage image = ImageIO.read(new File("image.jpg"));
            g.scale(buffer.getWidth()*1.0/image.getWidth(),
                    buffer.getHeight()*1.0/image.getHeight());
            g.drawImage(image, 0, 0, null);
            g.dispose();
            JLabel imageLabel = new JLabel(new ImageIcon(buffer));
            JSplitPane splitPane = new JSplitPane();
            splitPane.add(imageLabel, JSplitPane.LEFT);
            splitPane.add(buttonPanel, JSplitPane.RIGHT);
            panel.add(splitPane);
        }
        JScrollPane spane = new JScrollPane(panel);
        frame.add(spane);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(500,600);
        frame.setVisible(true);
    }
} 
```

如果要在图像可见时动态加载图像，则必须为每个图像使用空的 JPanel 而不是 ImageIcons，然后覆盖这些 JPanel 的绘制方法。只有当 JPanel 可见时才会调用paint 方法。因此，最简单的解决方案是始终以绘制方法从磁盘加载图像，然后将其绘制到屏幕上。

```
import javax.swing.*;
import java.awt.*;
import java.awt.image.*;
import javax.imageio.ImageIO;
import java.io.File;

public class Scroll extends JPanel {
    public static void main(String[] args) throws Exception {
        JFrame frame = new JFrame();
        JPanel panel = new Scroll();

        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));

        for(int i = 0; i < 10; i++) {
            JPanel buttonPanel = new JPanel();
            JRadioButton b1 = new JRadioButton("button 1");
            JRadioButton b2 = new JRadioButton("button 2");
            JRadioButton b3 = new JRadioButton("button 3");
            ButtonGroup group = new ButtonGroup();
            group.add(b1);
            group.add(b2);
            group.add(b3);
            buttonPanel.add(b1);
            buttonPanel.add(b2);
            buttonPanel.add(b3);

            JPanel imagePanel = new JPanel() {
                {
                    BufferedImage image = ImageIO.read(new File("image.jpg"));
                    setPreferredSize(new Dimension(image.getWidth(), image.getHeight()));
                    image.flush();
                }
                @Override
                public void paint(Graphics g) {
                    try {
                        BufferedImage image = ImageIO.read(new File("image.jpg"));
                        g.drawImage(image, 0, 0, null);
                        image.flush();
                    } catch(Exception e) {
                    }
                }
            };

            JSplitPane splitPane = new JSplitPane();
            splitPane.add(imagePanel, JSplitPane.LEFT);
            splitPane.add(buttonPanel, JSplitPane.RIGHT);
            panel.add(splitPane);
        }
        JScrollPane spane = new JScrollPane(panel);
        frame.add(spane);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(500,600);
        frame.setVisible(true);
    }
} 
```

# html - 微数据 - 我们应该使用 rdf.data-vocabulary.org 还是 Schema.org

> ID：13546858
> 
> 赞同：4
> 
> 时间：2012-11-24T23:49:48.870
> 
> 标签：html, seo, microdata

正如我在标题中所说，我问我们应该使用 data-vocabulary 或 Schema.org 中的哪一个（或者两者兼而有之）？

我知道 Schema.org 是谷歌推荐的网站，但我可以在许多网站上看到数据词汇表。我什至在一个页面上看到了两者！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T15:10:32.167

两者都很好。我不会混搭！

但是，我会说（就个人而言，轶事）我已经从实施良好的架构站点中看到比其他微格式更好的搜索结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-13T10:42:33.943

我在想 Schema.org。由于这些原因：

在谷歌自己的丰富片段页面上，他们推荐它：[https ://support.google.com/webmasters/answer/164506?hl=en](https://support.google.com/webmasters/answer/164506?hl=en)

> 新的！schema.org 允许您使用 Google、Microsoft 和 Yahoo! 的词汇表在您的页面上标记更广泛的项目类型。都能理解。了解更多。（不过，Google 仍然支持您现有的丰富网页摘要标记。）

这个 Google 常见问题解答也非常支持：[https ://support.google.com/webmasters/answer/1211158?hl=en](https://support.google.com/webmasters/answer/1211158?hl=en)

> schema.org 是 Google、Microsoft 和 Yahoo! 的合作项目。通过创建主要搜索引擎支持的结构化数据标记模式来改进网络。

所以这似乎是谷歌现在正在推动的一个，他们也声称得到了 3 个主要搜索引擎的支持。

# google-places-api - Google 地方信息详情 - REQUEST_DENIED

> ID：13546860
> 
> 赞同：1
> 
> 时间：2012-11-24T23:50:39.743
> 
> 标签：google-places-api

我正在使用 Google Places API，特别是 Places Search 和 Places Details。

Places Search 运行良好。当试图获取搜索返回的某个地点的详细信息时，我得到一个`REQUEST_DENIED`.

这是地方详细信息 API：[https ://developers.google.com/places/documentation/details](https://developers.google.com/places/documentation/details)

根据谷歌的说法，`REQUEST_DENIED`状态是：`REQUEST_DENIED indicates that your request was denied, generally because of lack of a sensor parameter.`当然，API 不准确，因为这显然不是唯一的原因。事实上，在查看 JavaScript 库时，它给出了 REQUEST_DENIED 的不同原因。它指出原因为：`REQUEST_DENIED: The webpage is not allowed to use the PlacesService`。

我正在传递传感器参数。这是我试图通过的请求：

```
https://maps.googleapis.com/maps/api/place/details/json?key=MYKEYHERE?reference=CqQBlgAAAAdB_-Ga9gk_D8abGjz87Wub3yNBhjfj9xte74Z1wgyuvseOayauYGztcTf3oMW5W3hJ0kqLiT8EM4Uow6Vlk5yqUSD6H3gIwB5LrrBgjYzHsbPfF_5_WyncSsAA9eFMWNHY4lgEdInj90HOuS0PfbG-JJm37NMOfksUoUSOlStQ2ARdogsg4XN3LEiWLO7lyAeWvNueWVMF_POTVpeFrgcSEIVX2qMHe1rcML_LSiEnXBAaFA0BorgBjWsyltpA5BvyYjiOXt8Z&sensor=false 
```

有人知道那有什么问题吗？我正在尝试使用 HTTP GET 方法来检索它。我也没有使用 JavaScript，而是用 Python 编写。尝试在 Python 中处理此请求或将其粘贴到浏览器中时，我得到相同的响应。请注意，我实际上是在替换我放置的密钥`MYKEYHERE`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-25T06:40:28.013

查询字符串语法无效。参数必须用 & 号分隔。

更改`?key=MYKEYHERE?reference=`为`?key=MYKEYHERE&reference=`。我用我的钥匙对其进行了测试，并收到了“Pizza Port”的回复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-24T17:44:27.260

好的，这对我有用：

```
https://maps.googleapis.com/maps/api/place/details/json?reference=CjQoAAAA4ynl7-ZIzpaYrdEYNSkf_oB80GHsunwyyg13Zk5EJqnfsg-4O6ryyfDnZgmujjkEEhC96j2B-AFclOdKWHPR8zhvGhQIy_DKfiD5Or7HSEMj-a8tJVDccA&key=KEY&sensor=true 
```

尝试运行其他地方的api，以确保您的密钥没有问题。以这个自动完成 api 为例：

```
https://maps.googleapis.com/maps/api/place/autocomplete/json?sensor=false&key=KEY&types=geocode&input=is 
```

# jquery - jQuery width() 在表格单元格上返回不正确的值

> ID：13546865
> 
> 赞同：6
> 
> 时间：2012-11-24T23:51:14.587
> 
> 标签：jquery, html-table, width

在我正在编写的插件中，我在表格单元格的宽度方面遇到了可怕的麻烦。我所做的就是使用 jQuery 的`.width()`函数获取表格单元格的宽度，然后*将相同的单元格设置*为返回的宽度。基本上，这是：

```
$table.find('> thead > tr > th').each( function() {
    var $th = $(this);
    $th.css({width: $th.width()});
} ); 
```

但是，在许多情况下，返回的宽度不正确，设置它会更改单元格的宽度。起初它看起来好像偏离了 1px，所以我在返回的宽度上添加了 1px。但是如果边框更厚，它会关闭更多 - 但是它似乎不是简单地添加边框宽度的情况。对于初学者来说，显然有 2 个边框，但仅相差 1 个边框的宽度。并且随着边框宽度的变化，您需要添加的值似乎几乎是随机的。

[这是我的代码示例](http://codepen.io/svivian/full/lpaiv)- 宽度设置部分在页面加载后 1 秒运行，因此您可以看到更改。是否有可靠的方法来获取/设置 Javascript 中表格单元格的宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:33:37.647

> **演示：** [https ://so.lucafilosofi.com/jquery-width-returning-incorrect-values-on-table-cells/](https://so.lucafilosofi.com/jquery-width-returning-incorrect-values-on-table-cells/)

这是您几乎重写的插件...在**IE7-10、Chrome、Firefox上测试**

```
 (function($) {
        $.fn.stickyHeader = function() {
            return this.each(function() {

                // apply to tables only
                if (this.tagName.toUpperCase() !== 'TABLE')
                    return;

                var $table = $(this).addClass('jq-stickyHeader-table');
                var $wrapper = $table.wrap('<div/>').parent().addClass('jq-stickyHeader-wrapper');

                // set each TH to its own width
                $table.find('thead th').each(function() {
                    $(this).html('<div>' + $(this).text() + '</div>');
                    $(this).width($(this).find('div').width());
                });

                $wrapper.width($table.width()).height($table.height());

                // clone entire table and remove tbody (performance seems fine)
                var $stickyheader = $table.find('thead').clone().wrap('<table/>').parent().addClass('jq-stickyHeader');

                // hack for IE7
                if ($.browser.msie && parseInt($.browser.version, 10) == 7) {
                    $table.find('tr:first-child td').css('border-top', 0);
                }

                $stickyheader.css({
                    'width' : $table.width(),
                }).insertAfter($table);

                $(window).scroll(function() {
                    // while over the table, show sticky header
                    var currTop = ($(this).scrollTop() - $table.offset().top);

                    $stickyheader.stop(true, true).animate({
                        top : currTop
                    }, 100);

                    var scrollLimit = $table.offset().top + ($table.height() - $stickyheader.height());
                    var isVisible = (currTop > $table.offset().top && currTop < scrollLimit) ? 'block' : 'none';
                    $stickyheader.css({
                        display : isVisible
                    });
                });

            });
        };

    })(jQuery);

    $(function() {
        $('table').stickyHeader();
    }); 
```

* * *

css里面的demo源码！

# c - 当是一个字符时，C while 循环对自身调用 ++

> ID：13546866
> 
> 赞同：4
> 
> 时间：2012-11-24T23:51:25.023
> 
> 标签：c, while-loop, increment

我找到了这个功能，但我不明白它的某些部分。我有大约 3 天的 C 经验，所以请耐心等待。此函数用于解析命令行参数。

1.  为什么他们重​​新分配`*arg`到`*c`？

2.  我不明白他们为什么要运行一个while循环。

3.  其次，他们为什么要针对 char 指针运行 while 循环？我知道 char 实际上是一个字符数组，但我的理解是他们只会对 char 运行一个 while 循环，即单独访问数组字符值，而他们不会做任何事情。

4.  你怎么能增加一个字符？

5.  为什么我们甚至有 *c？

6.  我添加了字符串检查以查看 arg 是否是`-styles`例如，它有一个`-`所以我可以解析标志并获取值，它是下一个 arg `argv`— 使用正确吗？

就像我说的，我有大约 3 天的 C 经验，所以请彻底、有条不紊，并尽可能帮助我更好地理解这个函数和 C 整体。

```
void print_args(int argc,char *argv[])
{
     int i;
     if(argc > 1){
       for(i=1;i<argc;i++){
           char *arg = argv[i];
           char *c = arg;
           while(*c){
             if(strchr("-", *c)){
                 printf("arg %d: %s -> %s\n",i,arg,argv[i+1]);
             }  
             c++;
         }
       }
     }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T23:58:12.937

1)`arg`赋值为指向当前char数组的头部，`c`用于遍历数组。

2,3,5) while 循环一直运行，直到`c`指向`(char)0`，顺便说一下 也是`\0`。所以实际上它们遍历了 char 数组中的每个字符，直到它们到达空终止符。一个更好的条件应该是`while (*c != '\0')`，而不是隐含地依赖`'\0' == 0`

4) 他们增加一个指针，从而让它指向下一个存储单元，即下一个数组单元。

6）您的添加将作为识别选项的测试，您仍然需要将其与它进行比较`-styles`以查看它确实是一个有效的选项。

此代码示例可以进行大量修复以使其更加健壮和清晰。如果这是来自一本书或 C 教程，我建议你寻找另一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:08:04.313

我变成了一个什么都不包含的程序的函数并运行它`print_args`。`main`这就是它的作用：

```
$ ./a.out a ab abc abcd
arg 1: a -> ab
arg 2: ab -> abc
arg 2: ab -> abc
arg 3: abc -> abcd
arg 3: abc -> abcd
arg 3: abc -> abcd
arg 4: abcd -> (null)
arg 4: abcd -> (null)
arg 4: abcd -> (null)
arg 4: abcd -> (null) 
```

换句话说，对于每个命令行参数的每个字符，它都会打印*整个*命令行参数、一个细箭头和*下一个*命令行参数。（如果我的 C 库对 不满意`printf("%s", (char *)NULL)`，它会在它结束时崩溃。）打印*整个*命令行参数是它需要`c`和的原因`arg`，尽管该行完全可以读取

```
printf("arg %d: %s -> %s\n", i, argv[i], argv[i+1]); 
```

然后`arg`就没有必要了。

你的猜测和我的猜测一样好，*为什么*这个函数会做这个特定的事情。对我来说，这似乎不是一件特别有用的事情。

**编辑：**如果您的目标是打印`argv[i]`并且*无论*`argv[i+1]`何时`argv[i]`以破折号开头并且`argv[i+1]`不为NULL（这在上下文中可能实际上是有意义的），那么您应该这样写：

 *```
void
print_args(int argc, const char *const *argv)
{
    int i;
    for (i = 0; i < argc; i++)
        if (argv[i][0] == '-' && argv[i+1])
            printf("arg %d: %s -> %s\n", i, argv[i], argv[i+1]);
} 
```

如果您想在`argv[i]` *包含*破折号时打印，请替换

```
argv[i][0] == '-' 
```

和

```
strchr(argv[i], '-') 
```

在 if 语句中。

附录：我强烈建议您阅读[http://www.gnu.org/software/libc/manual/html_node/Argument-Syntax.html](http://www.gnu.org/software/libc/manual/html_node/Argument-Syntax.html)，它描述了现代 UNIX 命令行程序*应该*如何解释它们的参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T00:01:50.313

代码所做的大多数单独的事情都可以单独进行，但是`while`对字符进行循环`arg`是很奇怪的。这类似于“为 arg 中的每个破折号打印 arg 和下一个 arg”。但我怀疑是否有人真的想要那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-24T23:57:03.357

当您增加一个指针时，您将转到该指针之后的下一个地址。因此，假设您在地址 0000，下一个地址是 0004、0008 等。例如，该地址的值可以是字符串中的一个字符。所以如果字符串是“hello”，那么*c就是“h”，第一个*c++就是“e”。

while 循环通常不是最有效的处理方式，因为您很容易陷入无限循环。这是为了确保字符串中的每个字符都已被考虑在内。

我不完全确定他们为什么将 arg 分配给 *c。*

# haskell - 原始递归函数

> ID：13546872
> 
> 赞同：3
> 
> 时间：2012-11-24T23:52:40.780
> 
> 标签：haskell, recursion

我正在尝试在 Haskell中定义一些[基本的原始递归函数。](http://en.wikipedia.org/wiki/Primitive_recursive_function#Definition)为什么我的`times`函数重复了太多次（即`eval times[x,y]`导致`(x+1)*y`）？我认为我的问题通常是由于对合成功能的工作原理缺乏了解。请不要在没有解释的情况下给出答案以澄清我的理解。

```
 import Prelude hiding (pred,and,or,not)

 data PR = Z
         | S
         | P Int
         | C PR [PR]
         | PR PR PR
         deriving Show
 eval :: PR -> [Integer] - Integer
 eval Z _ = 0
 eval S [x] = x+1
 eval (P n) xs = nth n xs
 eval (C f gs) xs = eval f (map (\g -> eval g xs) gs)
 eval (PR g h) (0:xs) = eval g xs
 eval (PR g h) (x:xs) = eval h ((x-1) : eval (PR g h) ((x-1):xs) : xs)

 nth _ [] = error "nth nil"
 nth 0 _ = error "nth index"
 nth 1 (x:_) = x
 nth (n) (_:xs) = nth (n-1) xs

 one = C S [Z]
 plus = PR (P 1) (C S [P 2])
 times = PR (P 1) (C plus [P 2, P 3]) 
```

我已经为`times`最接近的人尝试了其他一些东西，`times = PR (P 1) (C plus[P 2, P 2]`但这结果是`2x*y`我想“好吧，我只需用其中一个替换`P 2`它`Z`，然后它就会是`x*y`”这实际上使它成为身份功能，`y`我没有知道为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T01:55:11.010

假设`op`是形式`PR something (C otherThing projections)`。那么，如果`x > 0`，

```
eval op [x,y] 
```

来电

```
eval (C otherThing projections) [x-1, (x-1) `op` y, y] 
```

是组成`otherThing`更高级别的操作。`op`在更简单的情况下，您只想`(x-1) `op` y`在递归调用的结果上调用它`y`，因此投影应该选择参数列表的第二个和第三个元素。

因此我们有

```
times = PR something (C plus [P 2, P 3]) 
```

因为我们有递归方程

```
x*y = (x-1)*y + y 
```

这不涉及孤立的`x-1`.

现在，当`x == 0`达到基本情况时，递归调用应该返回基本结果。对于乘法，那当然是 0，因此`something`应该是`Z`，独立于`y`，而不是`y`哪个`P 1`会给你。

因此，正如[user5402 所说](https://stackoverflow.com/a/13547387/1011995)，你应该有

```
times = PR Z (C plus [P 2, P 3]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-25T01:14:52.933

这个时间定义似乎有效：

```
times' = PR Z (C plus [P 2, P 3])

*Main> eval times' [6,7]
42 
```

这是有道理的，因为 0*x = 0 而不是 1。

请注意，我必须更改的定义`eval (C ...)`才能编译：

```
eval (C f gs) cs = eval f (map (\g -> eval g cs) gs) 
```

更详细的解释...

我们知道这`times`将是`PR Z h`一些形式`h`。

让我们展开`eval (PR Z h) (x+1:y:ys)`...

```
eval (PR z h) (x+1:y:ys)
    = eval h ((x+1-1) : eval (PR g h) ((x+1-1):y:ys) : y : ys)
    = eval h (x : eval (PR Z h) (x:y:ys) : y : ys)
    = eval h (x : x*y : y : ys) 
```

因为通过归纳我们知道`eval (PR z h) (x:y:ys) = x*y`。

那么`h`为了得到什么必须是什么`(x+1)*y = y+x*y`？我们需要添加`y`(which is `P 3`) 和`x*y`(which is `P 2`)，所以我们应该定义`h`为：

```
h = C plus [P 2, P 3] 
```

如果您使用`P 1`而不是`Z`，那么您的基本情况是`y`而不是`0`：

```
eval (PR (P 1) ...) (0:y) = eval (P 1) (y) = y 
```

递归保持不变，所以你`y`的答案是关闭的。

# android - 使用 Asmack 更新好友列表 ListView

> ID：13546877
> 
> 赞同：0
> 
> 时间：2012-11-24T23:53:39.637
> 
> 标签：android, listview, asmack

我正在尝试使用 Asmack API 动态更新好友列表。出于测试目的，我正在使用我的 Facebook 帐户。我发现如果我使用我的连接登录然后使用

```
adapter = new ArrayAdapter<Contact>(this, android.R.layout.simple_list_item_1, contacts);
listView.setAdapter(adapter);

Roster people = connection.getRoster();

people.people.addRosterListener(new RosterListener() {

        public void presenceChanged(Presence arg0) {

          contacts.clear();

          for(RosterEntry entry: people.getEntries()) {

                if(people.getPresence(entry.getUser()).equals(Presence.Type.available)) {
                    Contact person = new Contact();
                    person.setJid(entry.getUser());
                    person.setName(entry.getName());

                    contacts.add(person);
                }
            }

           adapter.notifyDataSetChanged();
        } 
```

这似乎不起作用。我的 listView 仍然是空的。有什么想法吗？

在此先感谢，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T17:45:22.350

对于任何好奇的人来说，最好的方法是使用 AsyncTask。最初填充它和一个 RosterListener 以使其保持最新。随着实时变化的发生。

这是我的代码。希望它可以帮助将来的人。

```
 @Override
public void onResume() {
    super.onResume();

    pd = ProgressDialog.show(this,getString(R.string.DialogConnecting1),getString(R.string.DialogConnecting2) + " " + settings.getString("username", "NOT SET") + ". " + getString(R.string.DialogConnecting3), true, true);

    new ContactFetcher().execute("");

}

class ContactFetcher extends AsyncTask<String, Void, String> {

    @Override
    protected String doInBackground(String... params) {

        contacts.clear();

        while(connection.getRoster().getEntries().isEmpty()){}

        people = connection.getRoster();

        for(RosterEntry entry: people.getEntries()) {

            //if(people.getPresence(entry.getUser()).getType().equals(Presence.Type.available)) {
                Contact person = new Contact();
                person.setJid(entry.getUser());
                person.setName(entry.getName());
                person.setStatus(people.getPresence(entry.getUser()));
                //person.setMsgState("");

                contacts.add(person);
            //}

        }

        return "";
    }      

    @Override
    protected void onPostExecute(String result) {
        adapter.sort(comparator);
        adapter.notifyDataSetChanged();

        pd.dismiss();

    }

    @Override
    protected void onPreExecute() {
    }

    @Override
    protected void onProgressUpdate(Void... values) {
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:07:01.233

您可以注册一个`RosterListener`来添加、删除或更新您的朋友。请参阅[文档](http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/RosterListener.html)。

# binary-search-tree - 二叉搜索树的例外

> ID：13546880
> 
> 赞同：1
> 
> 时间：2012-11-24T23:53:45.523
> 
> 标签：binary-search-tree

我正在为班级制作二叉搜索树，作业说明说我应该使用 5 个例外。如果在树中找不到一个项目，以及另一个与输入法有关的项目，我已经提出了重复项的例外情况。但是，与尝试在不存在的节点上操作或重复插入相比，我在想出更多让 BST 动摇的方法时遇到了很多麻烦。

你们对需要独特例外的其他潜在问题有什么想法吗？

# ruby-on-rails - 验证失败时，Rails 3 fields_for 范围删除字段

> ID：13546885
> 
> 赞同：5
> 
> 时间：2012-11-24T23:54:21.200
> 
> 标签：ruby-on-rails, nested-forms, simple-form

我正在使用 Rails 3、simple_form 和 cocoon 作为包含多个 TodoLists 的项目的嵌套表单。我希望我的 simple_fields_for 调用仅包含尚未软删除的 TodoList，这就是我想使用我的命名范围“未删除”的原因。

在我的项目表格中，我有：

```
<%= f.simple_fields_for :todo_lists, f.object.todo_lists.nondeleted do |todo_list_form| render "todo_list_fields", :f => todo_list_form end %> 
```

这在我的编辑视图的第一次加载时工作正常（即未显示已删除的 TodoLists），但在提交验证失败的表单时，任何新添加的 TodoLists 都会丢失。

如果我删除命名范围，新添加的 TodoLists 在验证失败时不会丢失，但会显示所有 TodoLists（包括已删除的）。

我还尝试了以下方法：

```
<% @project.todo_lists.each do |todo_list| %>
    <% if !todo_list.deleted && !todo_list.name.blank? %>
     <%= f.simple_fields_for :todo_lists, todo_list do |todo_list_form| render "todo_list_fields", :f => todo_list_form end %>
    <% end %>
<% end %> 
```

这解决了这两个问题，但不允许我获得所需的灵活性，例如将 TodoLists 保持在正确顺序的能力。

有没有办法将集合传递给 simple_fields_for（据我所知，它与 Rails 的 fields_for 具有相同的相关行为），这将允许我使用命名范围和排序，而不会在验证失败时丢弃新添加的字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T22:38:25.790

我能够通过修改我的项目模型的 has_many :todo_lists 关联来解决问题，如下所示：

```
has_many :todo_lists, :conditions => { :deleted => false }, :order => :name 
```

在视图中它很简单：

```
<%= f.simple_fields_for :todo_lists do |todo_list_form| render "todo_list_fields", :f => todo_list_form end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-21T13:27:30.267

**默认范围**也可以解决问题

```
class Foo < ActiveRecord::Base
  has_many :bars
end

class Bar < ActiveRecord::Base
  default_scope { where(active: true) }
end 
```

和

```
<%= f.simple_fields_for :bars ... %> 
```

# multithreading - 为什么同步需要上下文切换到操作系统？

> ID：13546887
> 
> 赞同：0
> 
> 时间：2012-11-24T23:54:37.427
> 
> 标签：multithreading, concurrency, context-switch

我正在观看关于高性能计算的[演讲](http://www.infoq.com/presentations/LMAX)，从 24:55 开始，一位演讲者表示，通过获取锁进行同步需要将上下文切换到操作系统的内核（如果应用程序的话，甚至不是虚拟机的内核）运行在一个）。我希望能简要解释一下为什么会这样以及为什么它不能在 JVM 内部处理（如果是 Java 应用程序）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:57:01.550

从 24:55 左右的视频来看，他们似乎正在讨论“获取互斥锁 - 进入临界区 - 释放互斥锁”。

同步依赖于获取互斥锁是一个原子操作这一事实。由于内核中发生了抢占，因此当多个进程试图获取/释放互斥锁时，内核需要处理互斥锁以保证其原子性。

有关更多信息，请参见此处：[互斥锁真的更慢吗？](https://stackoverflow.com/questions/1666653/are-mutexes-really-slower)

# objective-c - 自我中心

> ID：13546891
> 
> 赞同：0
> 
> 时间：2012-11-24T23:55:14.323
> 
> 标签：objective-c, ios

我试图在大 self.view 中居中 UIImageView 并使用：

```
CGPoint point;
point.x = self.view.center.x; 
```

工作正常，它水平对齐。然而，

```
self.view.center.y; 
```

iPhone模拟器的值为250，当图像在视觉上位于中心时

self.view.center.y = 230

不是250。

视图的中心值怎么会偏离？

编辑：

我还应该提到我已经尝试设置框架，但我遇到了同样的问题。我的图像视图的中心最终是 250 而不是 230，它在视觉上仍然关闭。

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T00:05:00.917

状态栏高 20 点，如果您希望图像位于*设备*屏幕的中心，则需要为此进行调整。`self.view.center`为您提供应用视图可见部分的中心。

# ios - iOS：自动增量 NSString

> ID：13546892
> 
> 赞同：0
> 
> 时间：2012-11-24T23:55:32.077
> 
> 标签：ios, string, integer, coordinate

我正在重构我的应用程序，该应用程序在地图视图上显示了一堆多边形和注释。

目前，它实际上是由以下元素组成的大量代码的情况：

```
CLLocationCoordinate2D theCoordinate1;
theCoordinate1.latitude = xx.xxxxx;
theCoordinate1.longitude = x.xxxxx;

MyAnnotation* myAnnotation1=[[MyAnnotation alloc] init];
myAnnotation1.coordinate=theCoordinate1;
myAnnotation1.title=@"buildingTitle";
myAnnotation1.subtitle=@"BuildingAddress"; 
```

然后我将注释添加到地图视图中。但是，由于有多个注释，这会导致大量代码，我希望通过将文本文件中的坐标加载到由 for 循环组成的方法中来变得更聪明（因此相同的代码块将定义坐标并从这些坐标创建注释）。

目前我唯一遇到的问题是如何为注释赋予不同的名称。如果我正在初始化一个注释对象，它肯定必须具有与前一个不同的名称吗？我对他们只是有数字后缀没意见，那么我该怎么做呢？我可以添加代码来自动递增 NSInteger，然后将其转换为 NSString 并追加吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:02:54.837

> 如果我正在初始化一个注释对象，它肯定必须具有与前一个不同的名称吗？

并不真地。假设您在循环内完成所有注释，您可以为变量使用相同的名称，这不会导致任何问题，因为该变量的范围被限制在循环内。

如果您需要稍后访问/查找对象，那么您需要将这些注释存储在一个数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:04:33.027

当然，您可以轻松地将数字添加到字符串中：

```
int increment = 0;
// etc....
NSString *myLabel = [NSString stringWithFormat:@"myLabel-%d", increment++]; 
```

# java - 如何使用 java 库 Jodd Email 将图像嵌入到电子邮件的 html 正文中？

> ID：13546904
> 
> 赞同：1
> 
> 时间：2012-11-24T23:57:54.103
> 
> 标签：java, image, email, embed, jodd

[在 Jodd 电子邮件库http://jodd.org/doc/email.html](http://jodd.org/doc/email.html)的主页上， 有一个非常具体的示例，说明如何使用该库将图像嵌入（而不仅仅是简单地将其作为文件附加）到您将要发送的电子邮件。

不幸的是，包含图像的电子邮件部分的结果 Content-Type 是：

```
Content-Type: application/octet-stream 
```

但是为了正确显示它，我们需要这个 Content-Type：

```
Content-Type: image/png 
```

例如，如果您有 png 图像。

但我似乎无法在 Jodd 电子邮件库中找到如何配置它。

这就是我所寻求的。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T10:09:28.053

如果您遵循 Jodd 站点中的示例，那么您使用方法**embedFile()**嵌入了您的文件。此方法是一种“捷径”方法：

```
attach(new FileAttachment(file)); 
```

其中**attach()**是附加内容的中心通用方法。**FileAttachment**依赖**javax.mail**来设置内容类型，可能基于扩展名。

因此，要手动设置内容类型，请使用通用**attach()**方法。例如，像这样嵌入文件：

```
.embedFile("d:\\c.xxx") 
```

将内容类型设置为“application/octet-stream”，因为它无法被**xxx**扩展识别。相反，您可以使用以下内容：

```
.attach(new ByteArrayAttachment(
        FileUtil.readBytes("d:\\c.xxx"), "image/png", "c.png", "c.png")) 
```

无论文件名如何，您都可以在其中手动设置内容类型。如果您不想加载文件字节，则可以改为传递**InputStream**等。

另一种解决方案（如果您想继续使用**embedFile**）是检查您的[mime 类型设置](https://stackoverflow.com/questions/6308142/adding-mimetypes-to-mimetypesfiletypemap)。

注意：由于如何附加内容（字节、输入流、文件、内联...）有多种组合，附加方法将在 Jodd 3.4.1 中重构。为了提供对开发者更友好的 api。敬请关注 ;）

# ios - 无法从 ImageView 访问 TabBarController

> ID：13546906
> 
> 赞同：3
> 
> 时间：2012-11-24T23:58:14.203
> 
> 标签：ios

我有一个在标签栏控制器中有导航控制器的应用程序。导航控制器的根是表视图控制器。表格视图与图像视图有一个segue。我想从图像视图控制器更新选项卡上的徽章值。从标签栏控制器，这工作正常：

```
UIViewController *viewController = [self.tabBarController.viewControllers objectAtIndex:1];
viewController.tabBarItem.badgeValue = @"x"; 
```

但是当我将相同的代码放入 imageview 控制器时，它不起作用。当我在执行后检查'viewController'的值时，该值为nil。self.tabBarController 也一样。由于某种原因，图像视图控制器看不到它的标签栏控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T03:52:41.570

您应该能够使用 self.navigationController.tabBarController 访问 tabBarController。所以你的代码需要是：

```
UIViewController *viewController = [self.navigationController.tabBarController.viewControllers objectAtIndex:1];
viewController.tabBarItem.badgeValue = @"x"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:04:41.057

所以有很多方法可以做到这一点，但最好的方法是订阅 NSNotification，然后从您的图像视图或任何地方，发出通知，使其看起来像这样。

```
[[NSNotificationCenter defaultCenter]
    addObserver:objectToListen
    selector:@selector(methodToRun:)
    name:@"NotificationName"
    object:nil]; 
```

然后在你更深的项目中，比如 imageview 或者你像这样发布的任何东西

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"NotificationName" object:nil userInfo:dictionaryWithValuesForMethodToUse to use]; 
```

然后您从 userInfo 获取信息，就像您在更改徽章值的方法中一样

```
- (void)methodToRun:(NSNotification *)notification
{
    NSDictionary *dictionary = [notification userInfo];
} 
```

# jquery - 使用 .find() 和 .attr()

> ID：13546908
> 
> 赞同：2
> 
> 时间：2012-11-24T23:58:18.037
> 
> 标签：jquery

我想搜索 JQuery 的后代搜索`href`s。我想我应该使用该`.find()`方法，但收效甚微，因为我不确定是将`.attr()`方法作为参数还是作为后续方法传递。

```
var trialMethod = function($this) {
  //Ive tried along the lines of this
  $this.find(.attr('href'));
  //and this
  $this.find().attr('href');
} 
```

我正在使用一个点击处理程序（这个专门附加到所有链接，无论它们是否由 JS/JQ 更新），并试图找到`href`被点击的内容。由于我试图在没有 JS 的情况下最大化网站的功能，因此链接是静态的，然后通过 JS/JQ 替换。因此，当单击链接时，它可能位于 a`<li>`或 a中`<span>`。我试图保持约定不声明第 n 个子元素或特定元素，而是搜索，因为 DOM 树可能会更改，因此寻找`href`属性，我将检查是否单击了某个链接。

1 - 你如何`href`使用这两种方法找到子元素的 s`.find()`和`.attr()`？

2 - 我已经阅读了 JQ API，但只是想澄清一下；`.find()`方法¿必须？被传递一个参数？如果是这种情况，那么我现在知道不要浪费时间进行类似于我的第二次尝试的尝试......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T00:02:36.593

你的意思是：

```
var allHrefs = $this.find("[href]").map(function() {
    return this.href;
}).get(); 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:02:13.143

要查找具有 HREF 属性的所有链接，只需使用：

```
$(document).find('a[href]'); 
```

`rel`例如，也可以这样做

```
$(document).find('a[rel]'); 
```

# c++ - 为什么 cin.fail() 在输入数字后跟字符时不返回 false？

> ID：13546911
> 
> 赞同：1
> 
> 时间：2012-11-24T23:58:44.903
> 
> 标签：c++, cin

我写了这个简单的代码：

```
 #include <iostream>
 using namespace std;
 int main()
 {
   double s;
   cin >> s;
   if (cin.fail())
     cout<<"Error";
   return 0;
 } 
```

当我进入`12.03`时，`cin.fail()`返回`false`，这很好。

当我进入时`sd234`，`cin.fail()`返回`true`，这也很好。

但是，例如，如果我输入`234.abcd`. 或任何后跟字符的数字，`cin.fail()`尽管`true`我没有`double`通过`cin`.

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:07:33.720

[std::istream::operator>>()](http://www.cplusplus.com/reference/iostream/istream/operator%3E%3E/)读取符合当前类型的字符（例如，digits 和 . for `double`）。以下字符留在输入缓冲区中以供另一个提取运算符使用。如果读取的字符可以满足当前类型，则不会发出错误信号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:05:17.560

输入要求，即`double`满足，即读操作成功。如果您想检查流是否继续播放您期望的内容，则需要阅读此内容。或者，您可以检查流中的下一个字符是否属于某种类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T00:02:34.807

因为它读取`'234.'`，这是一个有效的数字。您输入的其余内容`'abcd'`正在等待下一次阅读。

# asp.net - 删除的 css 类仍然有效

> ID：13546912
> 
> 赞同：4
> 
> 时间：2012-11-24T23:58:54.387
> 
> 标签：asp.net, css

```
<link href="~/Styles/Site.css" rel="stylesheet" type="text/css" /> 
```

我在我的页面中只添加了一个（以上）样式表。我有按钮作为菜单，并`CssClaas`设置为`mbt`. 如果我`CssClass="mbt"`从按钮标签中删除，我将看到该按钮完全没有样式。

```
<asp:Button ID="mHome1" runat="server" Text="Home" CssClass="mbt"
PostBackUrl="~/Default.aspx"/> 
```

但我已经`mbt`从`Styles/Site.css`. 我现在整个项目中没有`mbt`课程，但它的效果仍然存在。我试图重建项目并重新启动visual-studio，但它的效果没有任何进展。如何？为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T00:01:27.823

您是否尝试过清除浏览器的缓存？也许样式表文件被缓存了。

对于大多数浏览器，您可以通过单击 Shift-F5 或 Ctrl-F5 强制重新加载所有文件。

根据我的经验，我在使用 Google Chrome 时遇到了与缓存相关的最多的问题。

在 Internet Explorer 中，有一个有用的选项（在 Internet 选项 -> 常规选项卡 -> 浏览历史记录 -> 设置中），您可以在其中告诉浏览器在每次加载页面时检查文件的较新版本。此设置在开发 Web 应用程序时特别有用。

在 Firefox 中，您可以在高级 -> 网络下的选项对话框中找到设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:12:23.280

清除浏览器缓存。`Ctrl + Shift + Del`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T00:03:33.980

尝试删除，然后重新上传css。

# c# - 当我从应用程序中的一个页面导航到另一个页面时，为什么会丢失导航返回条目？

> ID：13546914
> 
> 赞同：0
> 
> 时间：2012-11-24T23:59:04.013
> 
> 标签：c#, silverlight, windows-phone-7.1

我有两个页面：Page1.xaml 和 Page2.xaml。Page1.xaml 有一个列表框，当用户选择一个项目时，我会在其中执行`NavigationService.Navigate(new Uri("/Page2.xaml", UriKind.Relative));`.

但是从 Page2.xaml 中，当我按下硬件后退按钮时，它只是退出了应用程序。Page1.xaml 是应用程序的启动页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:14:14.840

当我按下第二页上的返回按钮时出现异常，导致应用程序关闭。我从未调试过这部分，因此从未意识到。

# algorithm - 在图中查找断开节点的算法

> ID：13546924
> 
> 赞同：3
> 
> 时间：2012-11-25T00:01:24.703
> 
> 标签：algorithm, graph

在给定有向图的情况下，我正在寻找一种方法来查找从给定起点无法到达的所有节点。我有一个想法，基于与 Dijkstra 算法类似的概念，就像这样（伪代码），但有更好的方法吗？

```
function DisconnectedNodes(Graph, Start)
  var Unknown = new list
  var Open = new list
  var Closed = new list
  for each Node in Graph
    Unknown.add(Node)
  Open.StealFrom(Unknown, Start)
  while Open.Count > 0
    var Current = Open[0]
    for each Node in Current.Destinations
      if Node in Unknown
         Open.StealFrom(Unknown, Node)
    Closed.StealFrom(Open, Current)
  return Unknown 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-25T00:07:42.497

只需从起始节点运行[广度优先搜索！](http://en.wikipedia.org/wiki/Breadth-first_search)在 BFS 之后未访问的所有节点都无法从您的起点到达。

# ruby - Ruby：如何从模块调用类的实例方法？

> ID：13546927
> 
> 赞同：0
> 
> 时间：2012-11-25T00:01:38.680
> 
> 标签：ruby, methods, instance

我在一个类上定义了一个实例方法：

```
class Foo
  def is_linux
    # some code...
    # returns true or false
  end
end 
```

我想在一个模块中调用这个方法：

```
class Foo
  module Dog
    is_linux? ? puts "Is Linux" : puts "Is Windows"
  end
end 
```

这给了我以下错误：

```
NoMethodError: undefined method `is_linux?' for Foo::Foo:Module 
```

我知道我会写

```
class Foo
  module Dog
    Foo.new.is_linux? ? puts "Is Linux" : puts "Is Windows"
  end
end 
```

但我想知道模块是否有办法访问当前实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T01:00:15.150

基本上，您需要以某种方式“共享”您的实用程序方法。

我建议将它们放入mixin：

```
module Mixin
  def is_linux?
    true
  end
end

class Foo
  include Mixin # adding methods at instance level
end

class Foo
  module Dog

    extend Mixin # adding methods at class level

    puts is_linux? ? "Is Linux" : "Is Windows"

  end
end

#=> Is Linux 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:06:04.803

没有这样的选项，因为子类型（如模块）没有与其父实例连接。如果你需要这样的构造，你只能制作`is_linux?`类方法。如果没有这种可能性，那么很可能你的设计是错误的。

# linux - sudo 事件在哪里报告？

> ID：13546933
> 
> 赞同：146
> 
> 时间：2012-11-25T00:02:33.947
> 
> 标签：linux, command-line, permissions, debian, sudo

在我的机器上尝试一些不正当的事情会导致

```
ryan@debian:~$ sudo EAT_ALL_THE_COOKIES_BEFORE_DINNER
[sudo] password for ryan: 
ryan is not in the sudoers file.  This incident will be reported. 
```

此事件在哪里报告，我如何获取所有令人讨厌的尝试命令的日志？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2012-11-25T00:13:12.220

没关系，我刚刚在[xkcd](http://xkcd.com/838/)的替代文本中找到了答案：

![xkcd838](../Images/30122b8bcf8a6d9d77d922d397ce5aaa.png "他在你睡觉时看到你，他知道你什么时候醒着，他被复制到 /var/spool/mail/root 上，所以看在上帝的份上。")

`root`在我的情况下，替换为您的用户名，`ryan`因此可以找到日志：

```
cat /var/spool/mail/ryan 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-11-25T00:23:56.213

报告作为电子邮件发送给`root`用户。许多 Linux 发行版会自动为该用户设置一个别名，将邮件定向到安装过程中创建的第一个帐户。

# python - 我如何在python中进行strtotime？

> ID：13546936
> 
> 赞同：15
> 
> 时间：2012-11-25T00:02:40.920
> 
> 标签：python, datetime

我正在抓取一个页面，其中包括日期信息。所以我有一个名为的变量`warrant_issued`，它包含`u'11/5/2003'`——我想将它存储为机器可读的日期。PHP 有一个非常方便的`strtotime`函数。我希望[datetime](http://docs.python.org/2.7/library/datetime.html#strftime-strptime-behavior)的[strptime](http://docs.python.org/2.7/library/datetime.html#strftime-strptime-behavior)对我有帮助，但它似乎在我的版本中不可用`datetime`- 这是我的选项卡中的所有内容`datetime.`

```
In [231]: datetime.
datetime.MAXYEAR           datetime.__hash__          datetime.__sizeof__
datetime.MINYEAR           datetime.__init__          datetime.__str__
datetime.__class__         datetime.__name__          datetime.__subclasshook__
datetime.__delattr__       datetime.__new__           datetime.date
datetime.__dict__          datetime.__package__       datetime.datetime
datetime.__doc__           datetime.__reduce__        datetime.datetime_CAPI
datetime.__file__          datetime.__reduce_ex__     datetime.time
datetime.__format__        datetime.__repr__          datetime.timedelta
datetime.__getattribute__  datetime.__setattr__       datetime.tzinfo 
```

我正在使用 iPython 2.7.2+

我在这里吠错树了吗？`u'11/5/2003'`变成约会对象的最佳方式是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-25T00:05:18.550

[`strptime()`](http://docs.python.org/2.7/library/datetime.html#datetime.datetime.strptime)绝对是正确的方法，它只是类的类方法[`datetime`（](http://docs.python.org/2.7/library/datetime.html#datetime.datetime)令人困惑的`datetime`模块的一部分）。

也就是说，这是`datetime.datetime.strptime()`您正在寻找的（而不是`datetime.strptime()`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-25T00:10:48.553

试试这个：

与[此处](http://docs.python.org/2/library/datetime.html)`datetime module`的文档一起使用

```
>>>import datetime
>>>a = u'11/5/2003'
>>>time1 = datetime.datetime.strptime(a, "%m/%d/%Y")
>>>print time1
datetime.datetime(2003, 11, 5, 0, 0) 
```

在`ipython`：

```
In [1]: import datetime

In [2]: a = u'11/5/2003'

In [3]: time1 = datetime.datetime.strptime(a, "%m/%d/%Y")

In [4]: print time1
2003-11-05 00:00:00 
```

与[此处](http://docs.python.org/2/library/time.html)`time module`的文档一起使用

```
>>>import time
>>>a = u'11/5/2003'
>>>time1 = time.strptime(a, "%m/%d/%Y")
>>>print time1
time.struct_time(tm_year=2003, tm_mon=11, tm_mday=5, tm_hour=0, tm_min=0, tm_sec=0, tm_wday=2, tm_yday=309, tm_isdst=-1) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-26T06:23:56.407

感谢@David Cain 的评论回复：

> dateutil 库可以解析日期时间字符串（推断它们的格式）。但是，请注意“11/5/2003”不是一种明确的格式（MM/DD 或 DD/MM 因地区而异），因此在这种情况下应谨慎使用 dateutil。——大卫凯恩

因此，另一种好的做法是使用 dateutil 库：

```
>>> from dateutil.parser import parse
>>> dt = parse('2016/12/05 05:18 pm')
>>> dt
datetime.datetime(2016, 12, 5, 17, 18)
>>> dt.timestamp()
1480929480.0

>>> parse('16/11/12')
>>> datetime.datetime(2012, 11, 16, 0, 0) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-07T22:30:53.090

[`strtotime`](https://www.php.net/manual/en/function.strtotime.php)您在 PHP 中使用的工作可能与`dateparser`.

请注意，如果您没有`dateparser`库。

安装它

```
pip3 install dateparser 
```

如果您使用的是 conda

```
conda install dateparser 
```

该库以与语言无关的方式理解 200 多种语言区域和多种格式。

解析通用术语也有效：

```
import dateparser
print (dateparser.parse('yesterday')) #2019-05-19 08:08:14.934992 
```

并且还支持非公历系统。

# windows - 无法从 Windows ping 我的 MFP，但可以通过 Linux

> ID：13546944
> 
> 赞同：0
> 
> 时间：2012-11-25T00:03:53.543
> 
> 标签：windows, networking, ubuntu, printing, dhcp

我有麻烦。无法从 Windows 7 客户端访问我的以太网连接的 MFP，但通过 Ubuntu（和路由器/服务器）机器它可以访问它。

MFP = Epson Stylus Color 730

网络：

MFP (192.168.0.100) + win7clients (192.168.0.101-200) ---> Ubuntu 服务器/路由器 (192.168.0.1) ---> 互联网

MFP 从 DHCP 服务器获取正确的 IP 和设置。在 Windows 机器上禁用所有防火墙等等。

从 Ubuntu 我可以用 MFP 做我想做的事，但为什么我什至不能从 Windows ping 它？

谢谢

编辑：

**/etc/sysctl.conf**的内容：

```
#
# /etc/sysctl.conf - Configuration file for setting system variables
# See /etc/sysctl.d/ for additional system variables
# See sysctl.conf (5) for information.
#

#kernel.domainname = example.com

# Uncomment the following to stop low-level messages on console
#kernel.printk = 3 4 1 3

##############################################################3
# Functions previously found in netbase
#

# Uncomment the next two lines to enable Spoof protection (reverse-path filter)
# Turn on Source Address Verification in all interfaces to
# prevent some spoofing attacks
#net.ipv4.conf.default.rp_filter=1
#net.ipv4.conf.all.rp_filter=1

# Uncomment the next line to enable TCP/IP SYN cookies
# See http://lwn.net/Articles/277146/
# Note: This may impact IPv6 TCP sessions too
#net.ipv4.tcp_syncookies=1

# Uncomment the next line to enable packet forwarding for IPv4
net.ipv4.ip_forward=1

# Uncomment the next line to enable packet forwarding for IPv6
#  Enabling this option disables Stateless Address Autoconfiguration
#  based on Router Advertisements for this host
#net.ipv6.conf.all.forwarding=1

###################################################################
# Additional settings - these settings can improve the network
# security of the host and prevent against some network attacks
# including spoofing attacks and man in the middle attacks through
# redirection. Some network environments, however, require that these
# settings are disabled so review and enable them as needed.
#
# Do not accept ICMP redirects (prevent MITM attacks)
#net.ipv4.conf.all.accept_redirects = 0
#net.ipv6.conf.all.accept_redirects = 0
# _or_
# Accept ICMP redirects only for gateways listed in our default
# gateway list (enabled by default)
# net.ipv4.conf.all.secure_redirects = 1
#
# Do not send ICMP redirects (we are not a router)
#net.ipv4.conf.all.send_redirects = 0
#
# Do not accept IP source route packets (we are not a router)
#net.ipv4.conf.all.accept_source_route = 0
#net.ipv6.conf.all.accept_source_route = 0
#
# Log Martian Packets
#net.ipv4.conf.all.log_martians = 1
# 
```

编辑 2：经过一些修复 - 除了本地网络中的我之外，其他所有人都可以使用 MFP。所以，新的谜题：

我的本地网络： http: [//prntscr.com/kvk5g](http://prntscr.com/kvk5g)

“Hakuhonoo”看不到 MFP，但其他的可以。

**/etc/iptables.conf**的内容：

```
# Generated by iptables-save v1.4.12 on Fri Nov  9 01:51:58 2012
*filter
:INPUT ACCEPT [23:1420]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [20:18904]
-A INPUT -i lo -j ACCEPT
-A INPUT -i eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -d 224.0.0.0/4 -i eth0 -j ACCEPT
-A INPUT -s 224.0.0.0/4 -i eth0 -j ACCEPT
-A INPUT -i eth0 -p tcp -m tcp --dport 80:85 -j ACCEPT
-A INPUT -i eth0 -p tcp -m tcp --dport 1985 -j ACCEPT
-A INPUT -i eth0 -p tcp -m tcp --dport 25565 -j ACCEPT
-A INPUT -i eth0 -p tcp -m state --state NEW -m tcp --dport 60000:65000 -j ACCEPT
-A INPUT -i eth0 -j DROP
-A FORWARD -i eth0 -o br0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i br0 -o eth0 -j ACCEPT
-A FORWARD -d 224.0.0.0/4 -j ACCEPT
-A FORWARD -s 224.0.0.0/4 -j ACCEPT
-A FORWARD -i eth0 -p tcp --dport 81:85 -j ACCEPT
-A FORWARD -i eth0 -j DROP
COMMIT
# Completed on Fri Nov  9 01:51:58 2012
# Generated by iptables-save v1.4.12 on Fri Nov  9 01:51:58 2012
*nat
:PREROUTING ACCEPT [377:31747]
:INPUT ACCEPT [39:3558]
:OUTPUT ACCEPT [11:872]
:POSTROUTING ACCEPT [7:570]
-A PREROUTING -i eth0 -p tcp --dport 81:85 -j DNAT --to 192.168.0.101
-A POSTROUTING -o eth0 -j MASQUERADE
COMMIT
# Completed on Fri Nov  9 01:51:58 2012
# Generated by iptables-save v1.4.12 on Fri Nov  9 01:51:58 2012
*mangle
:PREROUTING ACCEPT [1425:140833]
:INPUT ACCEPT [762:69219]
:FORWARD ACCEPT [495:56655]
:OUTPUT ACCEPT [643:122295]
:POSTROUTING ACCEPT [1152:179096]
-A PREROUTING -d 224.0.0.0/4 -p udp -j TTL --ttl-inc 1
COMMIT
# Completed on Fri Nov  9 01:51:58 2012 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T07:15:43.937

您是否将 Ubuntu 设置为转发数据包？
启用路由：（取自[此处](https://help.ubuntu.com/community/Internet/ConnectionSharing)）

1.  通过启用 IP 转发配置网关以在两个接口之间进行路由：

    `sudo sh -c "echo 1 > /proc/sys/net/ipv4/ip_forward"`

2.  编辑 /etc/sysctl.conf，并（最高 10.04）添加以下行：

    `net.ipv4.conf.default.forwarding=1`
    `net.ipv4.conf.all.forwarding=1`

3.  从 10.10 开始，编辑 /etc/sysctl.conf 并取消注释就足够了：

    `net.ipv4.ip_forward=1`

# sql - 列出共享相同数据的数据

> ID：13546946
> 
> 赞同：0
> 
> 时间：2012-11-25T00:04:03.320
> 
> 标签：sql, sql-server-2008

我有三张桌子：

```
SN | Table Name  | Primary Key   | Foreign Key | Attribute 
-----------------------------------------------------------------
1  | salesArea   | salesAreaID   |             | areaDescription
2  | store       | storeID       | salesAreaID | 
3  | salesPerson | salesPersonID | storeID     | salesPersonName 
```

我正在尝试获取与某个`salesPersonName`相同的任何人的（s）。`salesArea``salesPerson`

例如，一个`salesPerson`名叫 David`storeID`在 NE 的 23工作`salesArea`。还有一个`salesPerson`叫 Bob 在`storeID`34 工作，也在 NE `salesArea`。

到目前为止，我的查询是...

```
SELECT salesPersonName,
salesPersonID,
    st.salesAreaID,
    areaDescription,
    sp.storeId
  FROM salesperson as sp, salesArea as sa, store as st 
```

我很困惑如何让它得到`storeID`'大卫'然后检索它是什么`salesArea`。然后用那个，用那个`salesArea`检索所有。`salesPersons``salesArea`

Salesperson 表只给出s ，`storeID`然后`store`给出s。`salesArea``storeID`

指向正确的方向会很好，加入子句？一些花哨的地方有一个`group by`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T01:26:50.400

我假设：

*   地区有商店
*   商店有售货员
*   销售人员有名字

所以，我们首先要找到通过的营业员的区域ID：

```
SELECT sp.SalesPersonID, st.SalesAreaID
FROM salesperson as sp
INNER JOIN store as st on sp.StoreID = st.StoreID
WHERE sp.SalesPersonName = 'David' 
```

现在，我们可以使用此查询的结果来执行问题的第二部分，即“获取给定销售区域中的其他人”。例如，如果上述查询返回 SalesAreaID = 23 和 SalesPersonID = 10，我们的第二个查询将如下所示：

```
SELECT sp.SalesPersonID, sp.SalesPersonName, st.StoreID
FROM stores st
INNER JOIN salespersons sp on st.StoreID = sp.StoreID
WHERE st.SalesAreaID = 23 and sp.SalesPersonID <> 10 
```

但是，我们可以将这两个查询组合成一个做同样事情的查询：

```
SELECT sp2.SalesPersonID, sp2.SalesPersonName, st2.StoreID
FROM salesperson as sp
-- Join to stores to get the areaID of the salesperson passed (multiplicity 1)
INNER JOIN store as st on sp.StoreID = st.StoreID
-- self join to store to get all stores in that area (multiplicity 1 x Stores[area])
INNER JOIN store as st2 on st.SalesAreaID = st2.SalesAreaID
-- get all salespersons assigned to all stores in the area (multiplicity 1 x salespersons[area])
INNER JOIN salesperson as sp2 
    on st2.StoreID = sp2.StoreID 
    -- only return "other" salespersons
    and sp2.SalesPersonID <> sp.SalesPersonID
WHERE sp.SalesPersonName = 'David' 
```

等等，我们有一个查询，提供与通过的销售人员在同一区域的所有其他销售人员。

# facebook - 如何在 iOS 6 中使用社交框架来点赞 Facebook 页面/关注 Twitter 用户？

> ID：13546948
> 
> 赞同：3
> 
> 时间：2012-11-25T00:04:08.770
> 
> 标签：facebook, twitter, ios6, facebook-like, social

有没有一种简单的方法可以在 iOS 6 中使用社交框架来点赞 Facebook 页面/关注 Twitter 用户？

我可以使用该框架将消息发布到用户的 facebook/twitter 帐户。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T09:26:16.947

这是一种在 Twitter 上关注用户的方法

```
-(void)followTwitter{

ACAccountStore *account = [[ACAccountStore alloc] init];
ACAccountType *accountType = [account accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

[account requestAccessToAccountsWithType:accountType withCompletionHandler:^(BOOL granted, NSError *error)
 {
     NSLog(@"this is the request of account ");
     if (granted==YES) {
         NSArray *arrayOfAccounts = [account accountsWithAccountType:accountType];
         if ([arrayOfAccounts count] > 0)
         {
             // Keep it simple, use the first account available
             ACAccount *acct = [arrayOfAccounts objectAtIndex:0];

             NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:@"FollowedUserNameHere",@"screen_name",@"TRUE",@"follow", nil];
             TWRequest *request = [[TWRequest alloc] initWithURL:[NSURL URLWithString:@"https://api.twitter.com/1.1/friendships/create.json"] parameters:dictionary requestMethod:TWRequestMethodPOST];

             [request setAccount:acct];

             [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error)
              {
                  if ([urlResponse statusCode] == 200)
                  {
                      // The response from Twitter is in JSON format
                      // Move the response into a dictionary and print
                      NSError *error;
                      NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:responseData options:0 error:&error];
                      NSLog(@"Twitter response: %@", dict);
                  }
                  else
                      NSLog(@"Twitter error, HTTP response: %i", [urlResponse statusCode]);
              }];
         }     
     }
 }]; 
```

}

并点击此链接以喜欢 Facebook 页面

[http://angelolloqui.blogspot.jp/2010/11/facebook-like-button-on-ios.html](http://angelolloqui.blogspot.jp/2010/11/facebook-like-button-on-ios.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-03T21:55:28.613

应该注意的是，从 iOS 6.0开始，社会框架`TWRequest`已弃用`SLRequest`，例如接受的答案：[Twitter SLRequest performRequestWithHandler - 无法准备 URL 请求](https://stackoverflow.com/questions/16945888/twitter-slrequest-performrequestwithhandler-could-not-prepare-the-url-request)

# ruby-on-rails - 在 htaccess 实施后，Rake 测试全部失败

> ID：13546951
> 
> 赞同：0
> 
> 时间：2012-11-25T00:04:37.110
> 
> 标签：ruby-on-rails, .htaccess, authentication

感谢[这个出色的问答](https://stackoverflow.com/questions/2799641/using-htaccess-password-protection-on-rails)，我发现了如何通过将以下代码放入我的应用程序控制器来保护我的 Rails 应用程序：

```
before_filter :authenticate

protected
def authenticate
    authenticate_or_request_with_http_basic do |username, password|
      username == "username" && password == "password"
    end
end 
```

这一切都很好，但我注意到我编写的所有测试（全部通过）现在都失败了。当我注释掉 before_filter 调用时，它们都会再次通过。

我该怎么办？有没有办法从 htaccess 保护中排除测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:15:25.673

您可以通过包含基本身份验证来更改测试，请参见：

```
def test_should_get_index
  @request.env["HTTP_AUTHORIZATION"] = "Basic " + Base64::encode64("username:password")
  get :index
  assert_response :success
  assert_not_nil assigns(:articles)
end 
```

资料来源： http: [//flip.netzbeben.de/2008/06/functional-test-for-http-authentication-in-rails-2/](http://flip.netzbeben.de/2008/06/functional-test-for-http-authentication-in-rails-2/)

# php - 如果我要替换多个单词/字符，如何结合 ucwords 和 str_replace？

> ID：13546957
> 
> 赞同：1
> 
> 时间：2012-11-25T00:05:04.707
> 
> 标签：php, str-replace, capitalize

如果我只需要替换一个字符，这可以结合 ucwords 和 str_replace：

```
echo str_replace('_', ' ', ucwords($cname)); 
```

这可以替换单词/字符：

```
$search_name = array('_', ',', 'neckline', 'skirts', 'skirt','pants', 'neckline_size', 'sleeves', 'pants_length');
$replace_name = array(' ', ', ', '');
$rows = str_replace($search_name, $replace_name, $row);
echo $rows['silhouettes_like']; 
```

但是如果我尝试通过添加它来组合它们，它会回显“数组”而不是值

```
$style_names = ucwords($rows); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:12:19.027

看起来您希望[array_map](http://php.net/manual/en/function.array-map.php)函数将 ucwords 映射到每一行值

```
$rows = array_map('ucwords', $rows); 
```

# java - Android FileObserver onEvent 没有被调用

> ID：13546958
> 
> 赞同：3
> 
> 时间：2012-11-25T00:05:15.243
> 
> 标签：java, android, fileobserver

有人可以帮助我吗？

我想观察一个文件以查看它是否被修改，以便我可以更新活动。经过几次测试，我确定它根本不起作用。难道我做错了什么？

我正在创建一个带有 onEvent 方法的 FileObserver 来显示 Toast 并记录数据只是为了查看它是否工作，但是 onEvent 永远不会被调用。我已经对现有文件和新文件进行了尝试，但在这两种情况下似乎都不起作用。

```
 Context context = this;
    File fileFolder = context.getFilesDir();

    String fileName = "quest";
    FileObserver questObserver = new FileObserver(fileFolder.getPath()) { // also tried fileFolder.getName()
        @Override
        public void onEvent(int event, String path) {
            Toast.makeText(getApplicationContext(), "onEvent fired", Toast.LENGTH_LONG).show();
            Log.d(TAG, "FileObserver().onEvent");
        }
    };
    questObserver.startWatching();

    /* create file */
    ObjectOutputStream objectOut = null;
    try {
        FileOutputStream fileOut = context.openFileOutput(fileName, Context.MODE_PRIVATE);
        objectOut = new ObjectOutputStream(fileOut);
        objectOut.writeObject(new Quest());
        fileOut.getFD().sync();
    } catch (IOException e) {
        Log.d(TAG, e.getMessage());
    } finally {
        if (objectOut != null) {
            try {
                objectOut.close();
            } catch (IOException e) {
                Log.d(TAG, e.getMessage());
            }
        }
    }

    /* read file */
    ObjectInputStream objectIn = null;
    Quest quest = null;

     try {
         FileInputStream fileIn = context.openFileInput(fileName);
         objectIn = new ObjectInputStream(fileIn);
         quest = (Quest) objectIn.readObject();
     } catch (FileNotFoundException e) {
         // Do nothing
     } catch (IOException e) {
         e.printStackTrace();
     } catch (ClassNotFoundException e) {
         e.printStackTrace();
     } finally {
         if (objectIn != null) {
             try {
                 objectIn.close();
             } catch (IOException e) {
                 Log.d(TAG, e.getMessage());
             }
         }
     }
     Toast.makeText(context, quest.getTitle(), Toast.LENGTH_LONG).show();

    questObserver.stopWatching(); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-21T11:31:05.640

' **public abstract void onEvent (int event, String path)** " -

> 此方法在特殊的 FileObserver 线程上调用。它独立于任何线程运行，因此请注意使用适当的同步！考虑使用 post(Runnable) 将事件处理工作转移到主线程以避免并发问题。

[http://developer.android.com/reference/android/os/FileObserver.html](http://developer.android.com/reference/android/os/FileObserver.html)

如果您将吐司放入 handler.post(new Runnable(){...}) 中，那应该可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:39:03.087

假设您的文件不（总是）存在，您可能应该将您的观察者放在文件夹中，如下所示：

```
Context ctx = ...;
File filesFolder = ctx.getFilesDir(); 
```

请注意，这也将确保`filesFolder`创建目录。

现在，每当使用例如写入、删除或更新文件时，您的观察者都会收到通知- 您可以在您的示例“quest”中`Context#.openFileOutput(..)`过滤您的文件名。`FileObserver`

# css - 居中 或者 在父母的底部

> ID：13546967
> 
> 赞同：1
> 
> 时间：2012-11-25T00:06:22.207
> 
> 标签：css

我想最终得到类似的[东西](http://tinypic.com/r/2lsgyvd/6)

“11 月 22 日”元素应在父 div 的底部对齐并在中心对齐。剩下的日期（21、20、19、18）应该紧随其后。（中心垂直线仅用于说明目的）。

这在css中可能吗？

编辑：这是我到目前为止所得到的：

```
<div class="container">
    <div id="motd">
        <ul>
            <li class="selected">22 November</li>
            <li>21</li>
            <li>20</li>
        </ul>
    </div>
</div> 
```

和 CSS

```
 .container
    {
        width: 960px;
        margin: 0 auto;
        overflow: hidden;
    }        

    #motd
    {
        width: 700px;
        height: 300px;     
        background-color: #efefef;       
        position: relative;
    }

    ul
    {
        position: absolute;
        left: 0;
        bottom: 0;          
    }

    li
    {
        float: left;
        list-style: none;
        padding: 7px 10px 7px 10px;
        background-color: #cacaca; 
        color: #ffffff;
    }

    li.selected
    {
        background-color: #393939;   
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T00:13:17.413

为孩子使用相对位置并为孩子设置样式

```
postion:relative;
margin-right:auto;
margin-left:auto; 
```

第二个选项是给它一个确定的宽度并减去父 div

父 div - 子，然后 css 子位置绝对和左侧：差除以二（基本上你想要每边的像素数量均匀

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:38:23.183

你不应该设置一个`left`位置。仅将元素绝对定位到底部（就像您所做的那样），然后通过将左右边距设置为`auto`.

```
ul {
    position: absolute;
    bottom: 0;
    width: 90%;
    margin: 0 auto;
} 
```

您还可以将列表的宽度设置为 100% 并将 child`li`在列表中居中。

# c# - ListView 中的“值不在预期范围内”异常

> ID：13546968
> 
> 赞同：2
> 
> 时间：2012-11-25T00:06:22.760
> 
> 标签：c#, windows-8, microsoft-metro

适用于 Windows 8 应用程序开发环境。

代码：

```
 var deserialized = JsonConvert.DeserializeObject<RootObject>(json);
   listView.ItemsSource = deserialized; // error 
```

数据模型：

```
 public class C
    {
        public List<Y> programs { get; set; }
        public string name { get; set; }
        public int code { get; set; }
    }
    public class RootObject
    {
        public List<C> cs { get; set; }
        public string date { get; set; }
    }
    public class Y
    {
        public string category { get; set; }
        public string time { get; set; }
        public string name { get; set; }
    } 
```

我能做些什么 ？我没有找到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T04:40:08.423

`ItemsSource`正在寻找`IEnumerable`，但您在 中提供单个对象`RootObject`。如果您在代码中创建一个 RootObject 实例并尝试相同的分配，您会得到同样的错误。

列表中具体应该显示什么？如果您只是将代码更改为：

```
listView.ItemsSource = deserialized.cs; 
```

listView 应该显示您的`C`对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T01:29:40.937

我总是无法弄清楚如何从序列化器输出中走出来。我确实有我在下面粘贴的工作代码（Windows 8 商店）。它的作用很明显。

```
 HttpResponseMessage responseGetEmailByPersonsBare =
                         await clientGetEmailByPersonsBare.PostAsync(UrlBase + EmailDetailGetEmailByPersonsBare, contentGetEmailByPersonsBare);
                     Stream myStream = await responseGetEmailByPersonsBare.Content.ReadAsStreamAsync();
                     var djsGetEmailByPersonsBare = new DataContractJsonSerializer(typeof(AEWebDataStructures.RootObjectEmailDetail));

                     var rootObjectEmailDetail = (AEWebDataStructures.RootObjectEmailDetail)djsGetEmailByPersonsBare.ReadObject(myStream);
                     responseGetEmailByPersonsBare.EnsureSuccessStatusCode();
                     returnTaskInfo.EmailDetails = rootObjectEmailDetail.Data;
                     returnTaskInfo.StatusReturn = AEWebDataStructures.StatusReturn.Success; 
```

# google-maps - Google Places Autocomplete - 如何删除永久关闭的地点？

> ID：13546969
> 
> 赞同：1
> 
> 时间：2012-11-25T00:06:31.340
> 
> 标签：google-maps, google-maps-api-3, google-api, google-places-api, google-places

我正在使用[Google Maps JavaScript API v3](https://developers.google.com/maps/documentation/javascript/places#place_searches)自动完成库，我注意到它返回了永久关闭的地方（这对我的用户没有用）。

我知道它们已永久关闭，因为地点详细信息上有一个属性，上面写着“place.permanently_closed = true”

```
 var view = {};
 view.placesAutocomplete = new google.maps.places.Autocomplete($('#venue').get()[0], {});
 google.maps.event.addListener(view.placesAutocomplete, 'place_changed', function() {
      view.place = view.placesAutocomplete.getPlace();
      // view.place.permanently_closed equals true for some results! not helpful...
 }); 
```

如何防止这些永久关闭的场所出现在我的自动填充结果中？还是过滤掉它们？

**更新：** 遇到这种情况的任何人，我最终得出结论，除了在 javascript 中循环遍历位置结果并手动提取结果之外，没有其他办法，或者根据检查 place.permanently_closed 变量警告用户该位置已关闭显示一条消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T09:01:21.303

目前不存在任何过滤建议的方法（您甚至无法访问建议，除非您选择一个）。

到目前为止，我看到的唯一方法是请求一个位置（没有自动完成）并自己构建自动完成框。

# javascript - 如果 console.log 禁用，则登录 casper.js

> ID：13546970
> 
> 赞同：2
> 
> 时间：2012-11-25T00:06:53.417
> 
> 标签：javascript, firefox, webkit, phantomjs, casperjs

以下代码使用`casper.js`不输出`This is thenEvaluate`字符串，因为**Twitter.com**已禁用`console.log`（空函数）：

```
var casper = require('casper').create({
    verbose: false,
    logLevel: 'debug'
});

casper.start("http://twitter.com");

casper.on('remote.message', function(msg) {
    this.echo('remote message caught: ' + msg);
})

casper.thenEvaluate(function() {
    console.log('This is thenEvaluate');
});

casper.run(); 
```

**如果我将url**交换到**google.com**或任何其他网站，它就可以工作。我的问题是：

1.  对于网站禁用`console.log`，有没有办法*重新启用*它？

2.  如果 #1 没有，有没有办法在内部`evaluate()`或`thenEvaluate()`函数中做任何类型的日志？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:26:32.893

[我在这里找到了关于恢复 console.log()](https://stackoverflow.com/questions/7089443/restoring-console-log)的答案

```
var i = document.createElement('iframe');
i.style.display = 'none';
document.body.appendChild(i);
window.console = i.contentWindow.console; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T09:36:55.277

只需删除对象的`log`属性`console`：

```
>>> console.log('plop')
undefined
>>> delete console.log
true
>>> console.log('plop')
plop
undefined 
```

这可以用 casper 给出：

```
var casper = require('casper').create();

casper.start("http://twitter.com");

casper.on('remote.message', function(msg) {
    this.echo('remote message caught: ' + msg);
})

casper.thenEvaluate(function() {
    delete console.log;
    console.log('This is thenEvaluate');
});

casper.run(); 
```

[免责声明：在这里找到](https://stackoverflow.com/a/7089671/330911)答案，原作者应相应注明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T00:17:01.253

![视觉断言](../Images/dcfbced0f7c3cac0d39cf5d92f58008e.png)

您可能需要考虑构建一个断言小部件，它将一种可视化的 console.log 效果附加到 DOM，然后您可以输出文本。我在 Github 上有一个 Gist，我已经在这种情况下实现了类似的东西：[https ://gist.github.com/3773871](https://gist.github.com/3773871)

如果您只是将该代码调用到您的程序中，则可以使用

```
assert(true, 'This is thenEvaluate()') 
```

显然，您并没有真正将它用作正确的断言，但如果您只是传入 true 和一个字符串并调用它来代替控制台日志，它会将您的结果输出到屏幕右上角的绝对定位元素阅读。

# c# - 为什么这个脚本会出现解析错误？

> ID：13546974
> 
> 赞同：0
> 
> 时间：2012-11-25T00:07:19.850
> 
> 标签：c#, unity3d

目前我真的不太了解 C#；我只是以光速通过 Unity 速成课程。

我尝试将此脚本从我的桌面拖放到 Unity 项目视图中的资产文件夹，但它显示“解析错误 1,13”。我不确定脚本有什么问题。有经验的人可以看一下吗？

```
var emitter : ParticleEmitter = GetComponentsInChildren(Partic­­leEmitter);

if (Input.GetButton("Fire1")){ emitter.emit=true;

}

else{

emitter.emit=false;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-25T00:15:54.943

我自己没有使用过带有 C# 的 Unity，但我可以告诉你，你的脚本甚至不是有效的 C# 语法。C# 变量以以下两种方式之一输入：

*   隐式：`var x = SomeExpression;`其中 x 自动采用表达式的类型
*   明确地：`ParticleEmitter x = SomeExpression;`其中 x 是 a`ParticleEmitter`并且表达式必须是相同的类型。

具体来说，该错误与`:`您的第一行中的有关。这是非法的 C# 语法，因为唯一可以合法出现在该位置的字符是`=`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T04:14:31.160

这不是 C#，这是用 UnityScript（基于 JavaScript）编写的。

您可以这样说，因为“:”冒号字符在 UnityScript 中用作类型声明，但在 C# 中无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T00:11:26.223

我自己从未使用过 C#，但我会尝试通过在第一行省略“：ParticleEmitter”部分来尝试隐式类型声明......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T01:37:31.317

GetComponentsInChildren() 返回组件的类型。解析错误可能来自编译器试图协调将类型传递`Component`给`ParticleEmitter`类型。

Unity3D 文档中的这个示例`Component.GetComponentsInChildren`应该可以帮助您：

```
 // Disable the spring on all HingeJoints 
 // in this game object and all its child game objects
 var hingeJoints : Component[];
 hingeJoints = GetComponentsInChildren (HingeJoint);
 for (var joint : HingeJoint in hingeJoints) {
     joint.useSpring = false;
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-25T15:03:57.970

正如 CC Inc 所说，您提供的代码不是 C#

我试图为你转换它：

```
ParticleEmitter emitter = GetComponentsInChildren<ParticleEmitter>().FirstOrDefault();

if (emitter != null)
{
    if (Input.GetButton("Fire1"))
    {
        emitter.emit = true;
    }
    else
    {
        emitter.emit = false;
    }
} 
```

GetComponentsInChildren 返回一个数组。因此，为了模仿你上面的内容，我已经说过我想要第一个，如果你找不到任何给我默认值（它是空的）。

这可能不是您所需要的，您可能只需要以下几行：

```
bool fire = Input.GetButton("Fire1");
ParticleEmitter[] emitters = GetComponentsInChildren<ParticleEmitter>();
foreach(ParticleEmitter emitter in emitters)
{
    emitter.emit = fire; 
} 
```

上面将存储 Input.GetButton 的布尔结果，然后遍历它找到的所有发射器并将它们设置为与 Input.Getbutton 相同的值。

显然以上只是猜测你想要什么，我希望它有所帮助。

# android - 无法从 QR Generator API Android 检索图像

> ID：13546976
> 
> 赞同：0
> 
> 时间：2012-11-25T00:07:39.103
> 
> 标签：android, http, qr-code

我正在尝试通过向 QR 生成器 API 发送 HTTP 请求并将图像放入 imageview 来在我的应用程序中生成 QR 码。然而，我只是得到一个空白屏幕。我尝试了几种不同的解决方案，但都没有找到。这是我正在使用的代码。我还在清单中添加了互联网权限

**活动主.xml：**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <ImageView android:id="@+id/qrImageView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" />

</RelativeLayout> 
```

**MainActivity.java**

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ImageView imageview = (ImageView) findViewById(R.id.qrImageView);

        String qrURL = "http://api.qrserver.com/v1/create-qr-code/?data=thisisatest&amp;size=300x300";
        String src = "QRGenerator";

        Drawable qrCode=null;
        try {
            qrCode = drawable_from_url(qrURL, src);
        } catch (MalformedURLException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } 

        imageview.setImageDrawable(qrCode); 
    }

        Drawable drawable_from_url(String qurl, String src_name) throws MalformedURLException, IOException {
            URL url = new URL(qurl);
            HttpURLConnection connection = (HttpURLConnection) url.openConnection();
            InputStream is = connection.getInputStream();
            Drawable d = Drawable.createFromStream(is, src_name);
            return d;
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:11:28.243

您必须首先下载图像：

```
public static Bitmap loadBitmap(String url) {
    Bitmap bitmap = null;
    InputStream in = null;
    BufferedOutputStream out = null;

    try {
        in = new BufferedInputStream(new URL(url).openStream(), IO_BUFFER_SIZE);

        final ByteArrayOutputStream dataStream = new ByteArrayOutputStream();
        out = new BufferedOutputStream(dataStream, IO_BUFFER_SIZE);
        copy(in, out);
        out.flush();

        final byte[] data = dataStream.toByteArray();
        BitmapFactory.Options options = new BitmapFactory.Options();
        //options.inSampleSize = 1;

        bitmap = BitmapFactory.decodeByteArray(data, 0, data.length,options);
    } catch (IOException e) {
        Log.e(TAG, "Could not load Bitmap from: " + url);
    } finally {
        closeStream(in);
        closeStream(out);
    }

    return bitmap;
} 
```

然后使用 Imageview.setImageBitmap 将位图设置到 ImageView

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T11:47:53.373

我已经解决了。我在没有互联网连接的模拟器上运行它，所以它显然无法联系 API。我在手机上运行它，它工作。我会把这个问题留给其他人参考。感谢您的输入

# android - 手机上不显示通知，但在模拟器中没问题

> ID：13546979
> 
> 赞同：0
> 
> 时间：2012-11-25T00:07:46.567
> 
> 标签：android, google-cloud-messaging

我从[这里](http://code.google.com/r/felipeal-gcm/source/browse#git/gcm-client/src/com/google/android/gcm)运行 Google GCM 测试代码，它在模拟器和手机上运行，​​但是当我发送消息时，通知仅适用于模拟器而不是手机。

**GCMIntentService 通知**

```
import android.support.v4.app.NotificationCompat;
...

// issues a notification to inform the user that server has sent a message
private void generateNotification(Context context, String message) {
    NotificationCompat.Builder builder = new NotificationCompat.Builder(context).setSmallIcon(R.drawable.ic_launcher)
            .setTicker(context.getString(R.string.app_name)).setContentText(message);

    Intent notificationIntent = new Intent(context, Main.class);
    notificationIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);
    PendingIntent contentIntent = PendingIntent.getActivity(context, 0, notificationIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    builder.setContentIntent(contentIntent);

    // add notification
    NotificationManager manager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
    manager.notify(FM_NOTIFICATION_ID, builder.build());
} 
```

**PHP 发送消息和发送函数**

```
require_once 'push_db_functions.php';
$dbf = new push_db_functions();
$id = '40';
$message = "Test Message";

$response = $dbf->sendMessage($id, $message);
$response = json_decode($response);
print_r($response); 
```

* * *

```
public function sendMessage($id, $message) {
    $results = mysql_query("SELECT regid FROM test WHERE id = '$id'");
    $processed = mysql_fetch_row($results);
    $url = 'https://android.googleapis.com/gcm/send';
    $apiKey = "AIzaSyD-xxx";
    $fields = array('registration_ids' => $processed, 'data' => array( "message" => $message),);
    $headers = array('Authorization: key=' . $apiKey, 'Content-Type: application/json');

    // open connection
    $ch = curl_init();
    // set the url, number of POST vars, POST data
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($fields));
    // execute post
    $response = curl_exec($ch); 
    curl_close($ch);
    return $response;
} 
```

**发送消息响应**

```
stdClass Object ( [multicast_id] => 5036849453049739126 [success] => 1 [failure] => 0 [canonical_ids] => 0 [results] => Array ( [0] => stdClass Object ( [message_id] => 0:1353799902066759%04108f12f9fd7ecd ) ) ) success 
```

我的数据库中有 2 条 regId 记录，一条用于模拟器，一条用于手机 $id 39 和 40，并相应地更改它们以向任一设备发送消息。

**数据库记录**

```
id | regid
39 | APA91bFyMJx4b0ddI........ Emulator
40 | APA91bFhwEhHOClkg........ Phone 
```

手机正在运行 Gingerbread，程序在其上注册并正常运行，除了在收到消息时不显示通知。

```
 mDisplay = (TextView) findViewById(R.id.display);
    registerReceiver(mHandleMessageReceiver, new IntentFilter(DISPLAY_MESSAGE_ACTION));
    final String regId = GCMRegistrar.getRegistrationId(this);
    Log.d("registrationID", "::" + regId);
    if (regId.equals("")) {
        // automatically registers application on startup.
        GCMRegistrar.register(this, SENDER_ID);
    } 
```

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T04:49:21.593

感谢所有回答这个问题的人。

我已经解决了这个问题：

在我的手机上帐户和同步，常规同步设置下，我发现后台数据同步框没有被勾选。设置后一切正常。

我应该在问这个问题之前弄清楚这一点，我很抱歉。

但是我希望这个答案可以对其他人有所帮助。

# file - matlab如何将矩阵保存到文件中

> ID：13546982
> 
> 赞同：0
> 
> 时间：2012-11-25T00:08:05.390
> 
> 标签：file, matlab, matrix, octave

我在 Octave 中做一个程序，将很多矩阵相乘。所有的矩阵都存储在一个单元矩阵中。在哪里：

```
cell(index,1) is the matrix in the left
cell(index,2) is the matrix in the right
cell(index,3) is the result. 
```

我想以这种方式将很多矩阵保存在一个文件中，例如：

```
cell(index,1) cell(index,2) = cell(index,3) 
cell(index,1) cell(index,2) = cell(index,3)
cell(index,1) cell(index,2) = cell(index,3) 
```

等等。

我知道存在一个函数`dlmwrite`，但我不知道如何使用它（我是八度的新手），所以我可以拥有这种格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T00:15:12.517

至少有两种方法可以做到这一点。如果您只打算在 matlab 中使用它，请使用 save 命令。`save filename.dat cell`. 这是`read filename.dat`由`cell2mat`

在您的情况下，我相信您实际上想要将值打印到屏幕或文件中。如果您在 matlab 中以正确的方式进行操作，则任何一种方法都几乎相同。这是一般的想法：

```
for index=1:size(cell,1)
  fprintf("%i %i = %i\n",cell(index,1),cell(index,2),cell(index,3));
end 
```

打印到文件非常相似

```
fid=fopen("somefile.txt","w")
for index=1:size(cell,1)
  fprintf(fid,"%i %i = %i\n",cell(index,1),cell(index,2),cell(index,3));
end
fclose(fid); 
```

# ios - 一个操作的多个 UIButtons，读取当前按钮并将其存储为临时值

> ID：13546983
> 
> 赞同：0
> 
> 时间：2012-11-25T00:08:22.510
> 
> 标签：ios, uibutton, uislider

我是一名从事情感注释应用程序的初学者。有几个按钮，如“快乐”、“愤怒”等......所有按钮都会调用相同的动作。还有一个 UISlider。如果单击“快乐”，则调整滑块以注释您现在的快乐程度。之后单击“生气”按钮，滑块的当前值将存储在相对于最后一个按钮的浮点变量中，例如“快乐”。然后你调整同一个滑块来标注你有多“生气”。还有下一个按钮......我不知道如何存储最后一个按钮的滑块值......有什么想法吗？非常感谢你！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:29:09.317

有很多方法可以解决这个问题。最简单的解决方案之一是标记您的按钮，然后使用一种方法来确定操作来自哪个按钮，设置一个字典对象，其中包含滑块值，然后将其写入相应的强数组。

主视图控制器.h

```
int emotionNumber
@property (strong, nonatomic) NSMutableArray *array;
//Declare your slider and buttons 
```

* * *

主视图控制器.m

```
@implementation
@synthesise array;

- (void)viewDidLoad {
[happyButton setTag:0];
[angryButton setTag:1];

array = [[NSMutableArray alloc] initWithCapacity:X]; <---- number of emotions
}

- (IBAction)setValue:(id)sender {

    // You will also want to keep track of emotionNumber (the int) here, and modify the
    //code below to write it to the correct place in the array.

    NSMutableDictionary *dictionary = [NSMutableDictionary dictionary];
    UIButton *button = (UIButton *)sender;

    switch (button.tag) {
        case 0:
            [dictionary setValue:slider.value forKey:@"angry"];
            [array addObject:dictionary];
            break;

        case 1:
            [dictionary setValue:slider.value forKey:@"happy"];
            [array addObject:dictionary];
            break;

        default:
            break;
    }

} 
```

# jquery - 风格可折叠

> ID：13546984
> 
> 赞同：0
> 
> 时间：2012-11-25T00:08:32.840
> 
> 标签：jquery, forms, fieldset, toggleclass

在单独的 fieldset-s 中有一个登录和注册表单，如下所示：

```
<fieldset class="login selected">
    <legend class="login_link">Login</legend>
    <div class="form_container">
        <form id="loginform">
            [loginform]
        </form>
    </div>
</fieldset>
<fieldset class="reg">
    <legend class="registration_link">Registration</legend>
    <div class="form_container clearfix">
        <form id="regform">
            [regform]
       </form>
    </div>
</fieldset> 
```

一个是打开的，另一个是默认关闭的，带有 css 样式

```
.login .form_container {
    display: block;
}
.reg .form_container {
    display: none;
}
fieldset {
    border: none;
}
.selected {
    border: 1px inset #000;
}
legend {
    background: #ccc;
    cursor: pointer;
} 
```

fieldset-s 可以使用 jQuery 进行折叠。添加和删​​除 .selected 类可以很好地分别设置打开和关闭的样式

```
$(".login_link,.registration_link").live("click",function(){
    $(this).parent().parent().children().children('.form_container').toggle();
    $(this).parent().parent().children().toggleClass("selected");
});

​ 
```

查看结果：http: [//jsfiddle.net/eapo/43UUP/11/embedded/result/](http://jsfiddle.net/eapo/43UUP/11/embedded/result/)

你可以制作更优化的代码来做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:35:17.667

这有点干净：

```
$(".login_link,.registration_link").on("click",function(){
    $(".form_container").toggle()
                        .closest("fieldset")
                        .toggleClass("selected");
}); 
```

注意：从 jQuery 1.7 开始，[`.live()`](http://api.jquery.com/live/)已弃用。使用[`.on()`](http://api.jquery.com/on/).

这是[一个工作小提琴](http://jsfiddle.net/KwrZP/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:46:21.237

我曾经为此目的为一个项目构建了一个脚本。

我将`click`-event 绑定到带有 class 的字段集中的每个图例`view_toggle`。

HTML：

```
<fieldset class="view_toggle">
    <legend>Some fieldset title to click on</legend>

    <div class="view_toggle_contents">Fieldset contents to appear after click</div>
</fieldset> 
```

CSS：

```
<style>
/* view toggle for fieldsets */
.view_toggle legend {
    padding: 0 1em 0 0;
    cursor: pointer; }
.view_toggle legend:after {
    content: ' ▼'; }
.view_toggle legend.is_active_handler:after {
    content: ' ▲'; }
</style> 
```

jQuery切换：

```
<script type="text/javascript">
$(document).ready(function() {
    $('fieldset.view_toggle').each(function() {
        var handler = $(this).find('legend');
        var toggledObject = $(this).find('.view_toggle_contents');
        toggledObject.hide();
        handler.click(function() {
            $(this).toggleClass('is_active_handler');
            toggledObject.slideToggle(300);
            toggledObject.find(':input:not(:button):visible:enabled:first').focus();
        });
    });
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T00:58:33.830

无论如何，字段集都属于表单

```
<form>
<fieldset class="selected">
    <legend>Bejelentkezés</legend>
    <div class="form_container">        
            [loginform]
    </div>
</fieldset>
<fieldset>
    <legend>Regisztráció</legend>
    <div class="form_container clearfix">
            [regform]  
    </div>
</fieldset>
</form>​ 
```

稍微改变你的 CSS

```
fieldset {
    border: none;
}
.selected {
    border: 1px inset #000;
}
.form_container {
    display: none;
}    
.selected .form_container
{
    display:block;                
}
legend {
    background: #ccc;
    cursor: pointer;
}
​
    ​ 
```

少 jQuery

```
$('legend').on('click', function(){
    $(this).closest('form').find('fieldset').toggleClass('selected');
});​ 
```

尽管实际上单击任一都会切换

# android - 在 android sdk 上播放声音

> ID：13546985
> 
> 赞同：0
> 
> 时间：2012-11-25T00:08:40.097
> 
> 标签：android, microphone

下面的这段代码记录并保存为音频文件'sample.wav'

```
recorder = new MediaRecorder();

recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
recorder.setOutputFile("/sdcard/sample.wav");

recorder.setOnErrorListener(errorListener);
recorder.setOnInfoListener(infoListener);

try {
    recorder.prepare();
    recorder.start();
} catch (IllegalStateException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} 
```

我想在不保存音频文件的情况下播放（对讲）录音

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T04:55:16.180

您可以使用 AudioRecord 录制音频和使用 AudioTrack 播放。

你可以看到这个链接，例如[http://android-er.blogspot.com/2012/06/audiorecord-and-audiotrack.html](http://android-er.blogspot.com/2012/06/audiorecord-and-audiotrack.html)

# php - 使用 .htaccess 用于 mod_rewrite

> ID：13546986
> 
> 赞同：3
> 
> 时间：2012-11-25T00:09:44.577
> 
> 标签：php, apache, .htaccess, ubuntu, virtualhost

我在 Ubuntu 12.10 上安装了一个 LAMP 堆栈，其中创建了三个站点`/etc/apache2/sites-available`，所有站点都在运行。我的问题在于想要使用这些文件从 URL`.htaccess`中附加`.php`文件扩展名。我的文件目前是这样的：

```
# The VGC
<VirtualHost *:80>
            ServerAdmin codyu@thevgc.net
            ServerName thevgc.net
            ServerAlias www.thevgc.net

            DocumentRoot /var/www/www
            <Directory />
                    Options FollowSymLinks
                    AllowOverride All
            </Directory>
        <Directory /var/www/www/>
                Options Indexes +FollowSymLinks +MultiViews Includes
                RewriteEngine On
                RewriteBase /
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule ^(.*)$ $1.php [L,QSA]
                AddType application/x-httpd-php .php
                AllowOverride All
                Order allow,deny
                allow from all
        </Directory>

        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
        <Directory "/usr/lib/cgi-bin">
                AllowOverride None
                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
                Order allow,deny
                Allow from all
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/access.log combined
    </VirtualHost> 
```

我几乎可以肯定我做错了什么。我所知道的是我的`.htaccess`文件拒绝附加扩展名，或者更确切地说是找到具有相同名称的文件并加载该文件，所以我想采用这种方法。

有什么建议么？[这是我网站的示例页面](http://www.thevgc.net/about)。

# javascript - Jquery 脚本以计数脚本中的所有 div 为目标，希望它为每个 div 单独工作

> ID：13546990
> 
> 赞同：4
> 
> 时间：2012-11-25T00:10:29.380
> 
> 标签：javascript, jquery, html, css

我有一个 jquery 脚本，它计算单词并根据单词的数量调整字体大小。问题是它计算了父级中所有带有 h1 的属性。我希望它为每个 h1 单独计算。最初的脚本被标记为 h1:first。这是计算 wofa 类中所有 h1 的脚本：

```
$(function(){

var $quote = $(".wofa h1");

var $numWords = $quote.text().split(" ").length;

if (($numWords >= 1) && ($numWords < 3)) {
    $quote.css("font-size", "1px");
}
else if (($numWords >= 3) && ($numWords < 6)) {
    $quote.css("font-size", "5px");
}
else if (($numWords >= 20) && ($numWords < 30)) {
    $quote.css("font-size", "10x");
}
else if (($numWords >= 30) && ($numWords < 40)) {
    $quote.css("font-size", "15px");
}
else {
    $quote.css("font-size", "1px");
} 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:20:44.673

**[**更新的**](http://jsfiddle.net/videsignz/tacgh/) 工作示例**FIDDLE**[](http://jsfiddle.net/videsignz/tacgh/)**

 ****您可以使用 .each() 函数

```
$('.wofa').each(function() {
    var quote = $(this).find('h1');
    var numWords = quote.text().split(" ").length;
    console.log(numWords);
    if ((numWords >= 1) && (numWords < 3)) {
        quote.css("font-size", "1px");
    } else if ((numWords >= 3) && (numWords < 6)) {
        quote.css("font-size", "5px");
    } else if ((numWords >= 20) && (numWords < 30)) {
        quote.css("font-size", "10x");
    } else if ((numWords >= 30) && (numWords < 40)) {
        quote.css("font-size", "15px");
    } else {
        quote.css("font-size", "1px");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T00:36:33.150

我用您的选择器尝试了 .each() 方法，但没有选择任何内容。

我结束了使用 $('.wofa, h1).each()：

```
$('.wofa, h1').each(function() { 
    var words = $(this).html().split(" ");
    alert($(this).html() + ' has ' + words.length + ' words');
}); 
```

这是关于 jsfiddle 的工作版本：http: [//jsfiddle.net/russianator/jKPdQ/](http://jsfiddle.net/russianator/jKPdQ/)****

# c - 如何使用C获取列的不同计数

> ID：13546998
> 
> 赞同：0
> 
> 时间：2012-11-25T00:11:36.080
> 
> 标签：c, string, count, distinct

我想使用 C 获取大型数据文件的列的不同计数。我该怎么做。请告诉我。谢谢。我的示例数据文件如下。

对于第二个属性，不同的计数是 6。

```
399547,v4149,p3178,1990,2065,fraud
399940,v5852,p3194,8278,2180,fraud
399983,v3476,p3199,766,1125,fraud
400206,v3467,p3216,494,311000,fraud
400345,v4497,p3219,1211,432100,fraud
400471,v3473,p3225,41392,3710,fraud
400498,v3476,p3225,102,23820,fraud
401325,v4497,p3297,1322,1110,fraud 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T00:46:48.523

为每一列创建一个搜索树。假设您在一个文件中有 10 行，`nth`列即有 2 个不同的值。`3456`和`3457`。您的列搜索树`nth`将如下所示： ![第 n 列的搜索树](../Images/0eaab608d35555ee4d92ad5c0d2ba4bb.png)

你最终会得到 6 棵搜索树。阅读整个文件后，遍历每个搜索树中的所有可能路径，这将为您提供不同值的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T00:33:35.170

*   阅读并拆分每一行。
*   将第二个属性放入一个数组中。
*   [qsort](http://linux.die.net/man/3/qsort)数组

您现在有一个彼此相邻的相等字符串的数组。您可以遍历数组并计算不同的条目。

如果您的条目都是 5 个字符长，否则您必须`malloc()`记住每个属性。

```
char (*array)[6];
int i;
int n; /* number of lines read */
int distinct = 1;
/* read the data file and put it into array */
/* qsort() array */
for (i = 1; i < n; ++i) {
    if (strcmp(array[i], array[i - 1]) != 0)
        ++distinct;
}

printf("There are %d distinct rows\n", distinct); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T00:16:08.220

您可以使用`std::map<std::string,int>`- 它将保存键值对，其中键是 vNNNN，值是重复次数。

第一个循环将扫描输入文件并填充此映射，然后映射中的键数将是不同的计数。

**编辑：**如果你不能使用 C++ 并且确实需要 C，你将不得不为 C 找到一些 hashmap 库，比如[sparsehash](http://code.google.com/p/sparsehash/)。

如果数据量真的非常大，那么它可能不会适合内存。在这种情况下，我建议使用 SQLite 临时数据库来解析、存储和索引您的数据，然后`SELECT DISTINCT`在其上使用标准。