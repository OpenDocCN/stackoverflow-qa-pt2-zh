# StackOverflow 问答 12661000-12661999

# ios - 如何在 iOS 中以编程方式禁用/启用睡眠模式？

> ID：12661004
> 
> 赞同：164
> 
> 时间：2012-09-30T11:46:11.517
> 
> 标签：ios

我有一个应用程序必须保持清醒直到倒计时结束，但只要达到分配的睡眠时间，它就会进入“睡眠模式”。

在我的应用程序中，我可以选择推迟睡眠，因此用户可以禁用/启用它。

我如何以编程方式进行操作？

* * *

## 回答 #1

> 赞同：387
> 
> 时间：2012-09-30T12:05:04.047

您可以按如下方式禁用空闲计时器；

在 Objective-C 中：

```
[UIApplication sharedApplication].idleTimerDisabled = YES; 
```

在斯威夫特：

```
UIApplication.sharedApplication().idleTimerDisabled = true 
```

在 Swift 3.0 和 Swift 4.0 中：

```
UIApplication.shared.isIdleTimerDisabled = true 
```

将其设置回`NO`或`false`重新启用睡眠模式。

例如，如果您在离开视图之前需要它，您可以通过覆盖 viewWillDisappear 来设置它：

```
override func viewWillDisappear(_ animated: Bool) {
    UIApplication.shared.isIdleTimerDisabled = false
} 
```

更多关于[UIApplication 类](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instp/UIApplication/idleTimerDisabled)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-10-31T04:22:09.220

在 Swift 3 中，要禁用空闲计时器，现在是：

```
UIApplication.shared.isIdleTimerDisabled = true 
```

要重新打开空闲计时器，只需：

```
UIApplication.shared.isIdleTimerDisabled = false 
```

此外，请注意`YES`and`NO`在 Swift 中不可用，您必须使用`true`or `false`（与之前的答案相反）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-25T06:43:04.017

**iOS 13、Swift 5,5.1+**禁用空闲计时器。在`SceneDelegate.swift`.

```
 func scene(_ scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions) {
     UIApplication.shared.isIdleTimerDisabled = true
 } 
```

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2017-08-12T13:10:00.837

在 Swift 3 中可以做到这一点的确切位置是`AppDelegate.swift`- 您应该`UIApplication.shared.isIdleTimerDisabled = true`在`application`func 中添加，因此结果将如下所示：

```
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
    UIApplication.shared.isIdleTimerDisabled = true
    return true
} 
```

# groovy - 如何了解 Gpars runForkJoin 和 forkOffChild 方法

> ID：12661009
> 
> 赞同：0
> 
> 时间：2012-09-30T11:47:11.593
> 
> 标签：groovy, gpars

我正在尝试使用这些方法但没有成功，如果有人可以帮助我，我会很高兴。我正在使用 groovy，我有 2 个字符串映射。我想用线程（由 gpars 使用）在 2 个映射的字符串之间进行匹配 例如：def firstMap = ["a":"A", "b":"B"] def secondMap = ["c":" C", "a":A"]

地图之间相等的正常方法是

```
fistMap.findAll().each { first ->
    secondMap.findAll.each { second ->
       if (first.key.equals(second.key) && (first.value.equlas(second.value))
         //saveItIntoArray
  }
} 
```

我想用 gpars 线程来做，所以我尝试了：

```
withPool(2) {
    runForkJoin(firstMap) { task ->
      task.each {
         secondMap.each {
            //equals
        }
        forChild(?)
     }
  }
} 
```

我对这个有点陌生，我真的不知道如何让它工作。我将不胜感激。谢谢，或者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T05:56:09.517

我建议使用并行集合：

```
def firstMap = ["a":"A", "b":"B"]
def secondMap = ["c":"C", "a":"A"].asImmutable()
withPool{
    println firstMap.findAllParallel { fk, fv -> secondMap.findResult { sk, sv -> fk == sk && fv == sv ? [(fk):fv] : null } }
} 
```

# php - 看不到页面时显示通知

> ID：12661014
> 
> 赞同：-3
> 
> 时间：2012-09-30T11:48:03.340
> 
> 标签：php, javascript, mysql, ajax

如何 使用 ajax、php、mysql显示通知**“对您的问题的新回复” ？**我什至开始如何编码也遇到了麻烦。
一旦有人回复，我将不得不检查用户是否看过该页面。
并在用户看到页面之前显示通知。

我该如何开始这样做，请至少给我一个提示。

好的，我制作了一个包含通知的表格。在此表中，存储了提问者的 questionid、replyid 和用户 ID。

但我又遇到了同样的问题。我怎么知道提出问题的用户没有看到**答案页面？**
就像 stackoverflow 一样，这个网站会一直通知我，直到并且除非我看到答案页面......他们是怎么做到的？我在谷歌搜索了很多次，比如“回复通知”或“新答案通知”等，但每个人都有兴趣显示登录欢迎通知或类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T11:55:30.003

尝试设置页面的 cookie 函数 onLoad 事件，当用户回复时尝试测试 cookie 是否存在，并在响应后清除此 cookie

# objective-c - 将 NSMutableDictionary 保存到 plist iOS

> ID：12661017
> 
> 赞同：0
> 
> 时间：2012-09-30T11:48:32.213
> 
> 标签：objective-c, ios, cocoa, nsmutabledictionary, save

这在过去的一天变得非常令人沮丧，而且有点太多了：为什么这不起作用？

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
 NSString *documentsDirectory = [paths objectAtIndex:0];
 NSString *path = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.plist",kAllScoresUnorderedArray]];

 NSMutableDictionary *test = [[NSMutableDictionary alloc] init];
 [test setObject:@"bob" forKey:@"tmo"];

 [test writeToFile:path atomically: YES]; 
```

我以前用过它，而且效果很好：我忘记在 info.plist 中添加什么了吗？这是我唯一能想到的。

感谢您的帮助！

编辑：也许它与 Xcode 4.5 和 iOS6 有关？它适用于 4.3/iOS5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T15:14:37.123

您是否已将 .plist 文件添加到您的项目中？如果是这样，试试这个：

```
NSError *error;
        NSFileManager *fileManager = [[NSFileManager alloc] init];
     NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
     NSString *documentsDirectory = [paths objectAtIndex:0];
     NSString *path = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.plist",kAllScoresUnorderedArray]];

    if (![fileManager fileExistsAtPath: path])
            {
                NSString *bundle = [[NSBundle mainBundle] pathForResource:kAllScoresUnorderedArray ofType:@"plist"];

                [fileManager copyItemAtPath:bundle toPath: path error:&error];
            }

     NSMutableDictionary *test = [[NSMutableDictionary alloc] initWithContentsOfFile: path];
     [test setObject:@"bob" forKey:@"tmo"];

     [test writeToFile:path atomically: YES]; 
```

如果没有，请在您的项目中创建属性列表。

# sql - 反向部署

> ID：12661018
> 
> 赞同：1
> 
> 时间：2012-09-30T11:48:33.240
> 
> 标签：sql, sql-server, unpivot

> **可能重复：**
> [将多列拆分为多行](https://stackoverflow.com/questions/3678479/split-multiple-columns-into-multiple-rows)

我的桌子看起来像这样

```
accounting | research | sales | operations 
------------------------------------------
         3 |        5 |     6 |          0 
```

有必要接收具有两列和四行的结果集

```
dname      |        cnt
-----------------------
accounting |          3
research   |          5
sales      |          6
operations |          0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:24:16.267

并非所有 RDBMS 都具有此`UNPIVOT`功能，因此如果您没有`UNPIVOT`运算符，另一种方法是使用`UNION ALL`：

```
select 'accounting' dname, IsNull(accounting, 0) cnt
from yourtable
union all
select 'research' dname, IsNull(research, 0) cnt
from yourtable
union all
select 'sales' dname, IsNull(sales, 0) cnt
from yourtable
union all
select 'operations' dname, IsNull(operations, 0) cnt
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/0a5d4/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T11:53:32.323

像这样使用[`UNPIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)表运算符：

```
DECLARE @t table (accounting int, research int, sales int, operations int);

INSERT INTO @t VALUES(3, 5, 6, 0);

   SELECT dname, cnt
    FROM
    (
       SELECT accounting, research, sales, operations 
       FROM @t
    ) t 
    UNPIVOT
    (
      cnt FOR dname IN (accounting, research, sales, operations )
    ) u 
```

## 这是一个[现场演示](https://data.stackexchange.com/stackoverflow/query/81334/unpivot-columns-into-rows)

对于不支持`UNPIVOT`表运算符的 RDBMS，这是执行此操作的标准 sql 查询：

```
SELECT dname,
  CASE dname
    WHEN 'accounting' THEN accounting 
    WHEN 'research'   THEN research
    WHEN 'sales'      THEN sales
    WHEN 'operations' THEN operations
  END AS cnt
FROM @t
CROSS JOIN
(
   SELECT 'accounting' dname
   UNION ALL SELECT 'research' 
   UNION ALL SELECT 'sales' 
   UNION ALL SELECT 'operations'
) t2
WHERE dname IS NOT NULL 
```

## [现场演示](https://data.stackexchange.com/stackoverflow/query/81341/unpivot-columns-into-rows-without-unpivot-operator)

# android - 如何判断眼睛是睁眼还是闭眼人脸检测算法Android

> ID：12661019
> 
> 赞同：1
> 
> 时间：2012-09-30T11:48:33.630
> 
> 标签：android, image-processing, face-detection, eye-detection

我正在尝试检测在检测到的面部中眼睛是睁着还是闭着。我正在使用以下代码进行眼睛检测。这段代码的作用本质上是检测眼睛之间的距离。然后它计算面部的中点，并从那里检测眼睛的中心并在眼睛周围画一个圆圈。那就是眼睛检测部分。

但是我想做的是找到眼睛是闭着还是闭着。我想如何做到这一点首先找出如何检测眼睛/如何在较低级别检测眼睛之间的距离，并使用该较低级别的代码来决定眼睛是闭上还是闭上 - 即我想使用此代码能够检测眼睛以找出它是如何做到的，从而确定它是打开还是关闭。有人可以帮帮我吗？我不想使用opencv。我只想使用下面给出的代码的简单性。

```
package my.eyedetector.code;

import android.app.Activity;

import android.os.Bundle;

import android.content.Context;

import android.graphics.Bitmap;

import android.graphics.BitmapFactory;

import android.graphics.Canvas;

import android.graphics.Color;

import android.graphics.Paint;

import android.graphics.PointF;

import android.media.FaceDetector;

import android.media.FaceDetector.Face;

import android.view.View;

public class EyeDetectorActivity extends Activity {

    /** Called when the activity is first created. */

    @Override

    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

        //setContentView(R.layout.main);

        setContentView(new myView(this));

    }

    private class myView extends View {

     private int imageWidth, imageHeight;

     private int numberOfFace = 4;

     private FaceDetector myFaceDetect; 

     private FaceDetector.Face[] myFace;

     float myEyesDistance;

     int numberOfFaceDetected;

     Bitmap myBitmap;

     public myView(Context context) {

        super(context);

        // TODO Auto-generated constructor stub

         BitmapFactory.Options BitmapFactoryOptionsbfo = new BitmapFactory.Options();

         BitmapFactoryOptionsbfo.inPreferredConfig = Bitmap.Config.RGB_565; 

         myBitmap = BitmapFactory.decodeResource(getResources(), R.drawable.mypic, BitmapFactoryOptionsbfo);

         imageWidth = myBitmap.getWidth();

         imageHeight = myBitmap.getHeight();

        myFace = new FaceDetector.Face[numberOfFace];

        myFaceDetect = new FaceDetector(imageWidth, imageHeight, numberOfFace);

         numberOfFaceDetected = myFaceDetect.findFaces(myBitmap, myFace); 

         }

         @Override

         protected void onDraw(Canvas canvas) {

         // TODO Auto-generated method stub

             canvas.drawBitmap(myBitmap, 0, 0, null);

             Paint myPaint = new Paint();

             myPaint.setColor(Color.RED);

             myPaint.setStyle(Paint.Style.STROKE); 

             myPaint.setStrokeWidth(3);

             for(int i=0; i < numberOfFaceDetected; i++) {

                 Face face = myFace[i];

                 PointF myMidPoint = new PointF();

                 face.getMidPoint(myMidPoint);

                 myEyesDistance = face.eyesDistance();

                 canvas.drawCircle((float)(myMidPoint.x - myEyesDistance/2.0), myMidPoint.y, (float)20.0, myPaint);

                 canvas.drawCircle((float)(myMidPoint.x + myEyesDistance/2.0), myMidPoint.y, (float)20.0, myPaint);

            }

         }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:30:12.573

人脸检测基本上是使用 Haar 级联来寻找眼睛。Si 它基本上是一组弱特征检测器。您无法使用此功能检测眼睛的闭合或睁开。您必须通过训练 Haar 级联来训练自己的闭眼/睁眼检测器。另一种简单的方法是使用霍夫变换检测黑色和圆形的瞳孔（如果有足够的分辨率，它可能是可能的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-04T11:07:23.050

您可以检查眼睛周围区域的肤色（在左侧和右侧，以避免眉毛颜色）。如果它与眼睛的颜色相匹配，也许它们是闭着的。反之亦然，眼睛是睁开的。

# g++ - 在 ubuntu 下使用 make/g++ 链接库

> ID：12661020
> 
> 赞同：0
> 
> 时间：2012-09-30T11:48:48.933
> 
> 标签：g++, makefile, libs

假设我的makefile看起来像这样：

```
CXX = g++

OGLLIBS = -lglut32 -lglu32 -lopengl32

projname : projname.o
    ${CXX} -o projname $< ${OGLLIBS} 
```

那么 g++ 在哪个目录中查找库？我假设 . 但是如果我把库放在那里，它仍然会抱怨找不到它们（`*.lib`是正确的文件还是 unix 使用另一个结尾？！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T11:56:03.963

1.  文件夹 unix 使用文件夹 /lib（用于系统库）和 /usr/lib 您自己的库或新安装的库应该在 /usr/local/lib 中，但您需要添加“-I/usr/local/lib”作为编译器标志.

2.  对于共享库，文件结尾基本上是 .so

3.  寻找库你可以告诉你的编译器通过设置一个名为 LD_LIBRARY_PATH=/root-to-my-libs 的变量来添加其他目录来寻找库

# c++ - 如何在迭代时有效地替换 unordered_set 中的元素？

> ID：12661023
> 
> 赞同：2
> 
> 时间：2012-09-30T11:49:19.557
> 
> 标签：c++, iterator, replace, unordered-set

假设你有一个

```
std::unordered_set<std::shared_ptr<A>> as;
// (there is an std::hash<std::shared_ptr<A>> specialisation) 
```

并且您想在迭代它时替换它的一些元素：

```
for (auto it = as.begin(); it != as.end(); ++it) {
  if ((*it)->condition()) {
    as.erase(it);
    as.insert(std::make_shared<A>(**it));
  }
} 
```

这可能**会使**迭代器在`erase`and处无效`insert`（如果发生重新散列），因此此循环将表现出未定义的行为，并且很可能会严重崩溃。

我能想到的一种解决方案是使用两个单独`vector`的 s 来缓冲`insert`and`erase`操作，然后使用采用迭代器对进行擦除和插入的重载（这可能对重新散列更友好）。

即使我使用缓冲区方法，这仍然看起来是臃肿的代码，并且可能导致两次重新散列，这可能都是不必要的。

那么，有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T11:54:36.463

我只是想到了一种可能的方法（在询问之后），但也许还有更好的方法。

将所有内容复制到向量，然后从向量重建集合应该更快：

```
std::vector<std::shared_ptr> buffer;
buffer.reserve(as.size());
for (auto it = as.begin(); it != as.end(); ++it) {
  if ((*it)->condition()) {
    buffer.push_back(std::make_shared<A>(**it));
  } else {
    buffer.push_back(*it);
  }
}
as = std::unordered_set<std::shared_ptr<A>>(buffer.begin(),buffer.end()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T11:55:35.947

当您调用`as.erase(it)`迭代器时，它会`it`失效。插入无序关联容器会使所有迭代器无效。因此，插入需要与迭代器分开。避免插入对于避免处理新插入的对象也是必要的：

```
std::vector<std::shared_ptr<A>> replaced;
for (auto it = as.begin(); it != as.end(); ) {
    if ((*it)->condition()) {
        replaced.push_back(std::make_shared<A>(**it));
        as.erase(it++);
    }
    else {
        ++it;
    }
}
std::copy(replaced.begin(), replaced.end(), std::inserter(as, as.begin()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-22T16:51:38.290

我会将其作为对@bitmask 答案的评论。为什么不将向量用于替换元素？

```
std::vector<decltype(as)::value_type> buffer;
buffer.reserve(as.size());
for (auto it = as.begin(); it != as.end(); )
{
  if ((*it)->condition())
  {
    buffer.push_back(*it);
    it = as.erase(it);
  }
  else
  {
    ++it;
  }
}
as.insert(buffer.begin(),buffer.end()); 
```

而且，如果`*it`已经是`shared_ptr<A>`，我再也找不到理由`make_shared()`了。只需分配并让复制构造函数/赋值运算符发挥他们的魔力。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-15T22:38:36.400

在你的情况下，你可以在我看来交换：

```
for(auto iter = as.begin(); iter != as.end(); ++iter)
{
    if(/*Check deletion condition here*/)
    {
        auto newItem = std::make_shared<A>(/*...*/);
        swap(*iter, newItem);
    }
} 
```

# linux - 我可以使用 find 命令根据文件名在子目录中创建链接吗？

> ID：12661024
> 
> 赞同：0
> 
> 时间：2012-09-30T11:49:22.543
> 
> 标签：linux

（这里是 Linux 新手）

我有一个目录，其中包含一个主文件“cs010101.SETUP”和一些子目录。每个子目录包含大量文件，包括一些格式为 cs??????.dat3。我正在寻找一种方法来查找所有 cs??????.dat3 文件，然后为每个文件在其相应的目录中创建一个软链接，返回到具有六位数字的主文件 (cs010101.SETUP)更改为匹配相应的 cs??????.dat3 文件。

*例如*，如果子目录包含文件 cs219254.dat3，我想执行命令

```
ln -s ../cs010101.SETUP cs219254.SETUP 
```

到目前为止，我已经掌握了 find 命令

```
find . -name "cs*dat3" 
```

并查看要切割的管道以提取数字

```
find . -name "cs*dat3" | cut -c 13-18 
```

（这目前有效，因为子目录的命名约定是一致的，但如果不必依赖这个事实会很好）。

但现在我难住了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:51:17.783

只是一个想法...... CSH（又名 TCSH）为变量提供了各种“：”选项 - 例如：

```
% set a = ./b/bb/cs219255.dat3

% echo $a:h
./b/bb

% echo $a:t
cs219255.dat3

% echo $a:r
./b/bb/cs219255

% echo $a:e
dat3 
```

你想要绝对路径还是相对路径？

```
foreach T ( `find . -name 'cs*dat3' -print` )
foreach? ln -s `pwd`/cs010101.SETUP  $T:r.SETUP-absolutepath
foreach? ln -s `echo $T:h | sed 's|/[^/]*|/..|g'`/cs010101.SETUP $T:r.SETUP-relativepath
foreach? end 
```

警告：我们可能应该在 sed 表达式中使用 + 而不是 *，例如 sed 's|/[^/]+|/..|g'。但是我在一个非常有限的系统上测试了这个，它的 sed 版本被破坏了。 *叹息*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:31:18.240

使用 sed。脚本可能如下所示：

```
for dname in `find . -maxdepth 1 -name "*" -type d`; do #list all subdirectories of this directory only
    for fnum in `find $dname -name "cs*.dat3" | sed 's/^.*cs\([0-9]*\)\.dat3$/\1/'`; do #extract numbers of needed files in subdir
        ln -s $PWD/cs010101.SETUP $dname/cs$fnum.SETUP #create link
    done
done 
```

# c++ - glMapBufferRange 访问冲突

> ID：12661027
> 
> 赞同：2
> 
> 时间：2012-09-30T11:49:50.650
> 
> 标签：c++, opengl

我想将一些粒子存储在着色器存储缓冲区中。我使用 glMapBufferRange() 函数来设置粒子值，但每当调用此函数时，我总是会收到访问冲突错误。

```
glGenBuffers(1, &bufferID);
glBindBuffer(GL_SHADER_STORAGE_BUFFER, bufferID);
glBufferData(GL_SHADER_STORAGE_BUFFER, numParticles*sizeof(Particle), NULL ,GL_STATIC_DRAW);

struct Particle* particles = (struct Particle*) glMapBufferRange(GL_SHADER_STORAGE_BUFFER, 0, numParticles*sizeof(Particle), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);

for(int i = 0; i < numParticles; ++i){
    //.. Do something with particles..//
}

glUnmapBuffer(GL_SHADER_STORAGE_BUFFER); 
```

当我改用 glMapBuffer() 时，一切正常。我已经确定我已经使用 glfw 创建了一个 OpenGL 上下文并正确初始化了 glew。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T12:09:28.107

好的，我终于找到了问题所在。当我设计我的 GLFW-Window 类时，我使用 GLFW_OPENGL_FORWARD_COMPAT 提示来创建一个向前兼容的 OpenGL 上下文。我不知道我为什么这样做，但是当我不使用这个提示时，一切正常。:)

# matlab - matlab创建exe文件的问题

> ID：12661030
> 
> 赞同：0
> 
> 时间：2012-09-30T11:49:53.153
> 
> 标签：matlab, compiler-construction, compiler-errors, exe, matlab-deployment

这是在 matlab 7.1 中构建 exe 文件的会话。

我想我的编译器有问题。

```
mbuild -setup

Please choose your compiler for building standalone MATLAB
applications:    Would you like mbuild to locate installed compilers
[y]/n? y

Select a compiler: 
[1] Microsoft Visual C++ 2008 Express in C:\Program Files (x86)\Microsoft Visual Studio 9.0 

[0] None 

Compiler: 1

Please verify your choices: 

Compiler: Microsoft Visual C++ 2008 Express  
Location: C:\Program Files (x86)\Microsoft Visual Studio 9.0 

Are these correct [y]/n? y

***************************************************************************** 
Error: Could not find the 64-bit compiler.  This may indicate that the  
     "X64 Compilers and Tools" or the Microsoft Windows Software  
     Development Kit (SDK) is not installed.  To build 64-bit binaries,  
     Microsoft Visual C++ 2008 Express Edition requires that these two  
     packages be properly installed.  
***************************************************************************** 

Trying to update options file: C:\Users\****\AppData\Roaming\MathWorks\MATLAB\R2010a\compopts.bat 
From template:              C:\PROGRA~1\MATLAB\R2010a\bin\win64\mbuildopts\msvc90freecompp.bat 

Done . . . 

>> mcc -m mainmain.m -o mainmain
Could not find the compiler "cl" on the DOS path. 
Use mbuild -setup to configure your environment properly. 

C:\PROGRA~1\MATLAB\R2010A\BIN\MEX.PL: Error: Unable to locate compiler. 

Error: An error occurred while shelling out to mbuild (error code = 2). 
Unable to build executable (specify the -v option for more information). 
??? Error using ==> mcc
Error executing mcc, return status = 1 (0x1). 
```

如果问题出在编译器上，我该如何安装另一个编译器？

我有 Windows 7（64 位），我希望 exe 文件可以在 Windows 操作系统上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T16:37:17.443

这可能是两个问题之一的结果。

1) 您没有安装 Windows SDK（如错误消息中所示）。根据这个关于支持的编译器的 MathWorks[页面](http://www.mathworks.com/support/compilers/R2012b/win64.html)

> 必须安装 Microsoft Visual Studio 2008 和 Windows 软件开发工具包 (SDK) 6.1。安装Microsoft Visual Studio时，安装Microsoft Visual Studio时必须选择“X64 Compilers and Tools”；默认情况下不选择此项。

现在，请记住，此参考适用于 MATLAB 的最新版本，但我敢打赌，此信息仍然与您的问题相关。

[您可以在此处](http://www.microsoft.com/en-us/download/details.aspx?id=24826)下载 SDK 。

2）您使用的编译器也可能不支持您的 MATLAB 版本。有关 MATLAB 7.1 支持的编译器的信息，请参阅[此处](http://www.mathworks.com/support/compilers/1601_71.html)。

# ios - 如何在 iOS 中隐藏状态栏？

> ID：12661031
> 
> 赞同：61
> 
> 时间：2012-09-30T11:50:19.417
> 
> 标签：ios, statusbar

我可以在我的应用程序中隐藏状态栏：

```
- (void)viewDidLoad{
    [[UIApplication sharedApplication] setStatusBarHidden:YES];
    [super viewDidLoad];
    } 
```

当我选择我的启动图像并第一次启动它时，它是图片上方的状态栏。我该如何隐藏这个？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2012-09-30T12:02:36.623

您需要将此代码添加到您的 AppDelegate 文件中，而不是您的根视图控制器中

或者添加属性**状态栏最初隐藏**在您的 plist 文件中

![在此处输入图像描述](../Images/c168fa5d82ffa22a6c7f492d9d15b206.png)

伙计们，在**iOS 7+**

请将此添加到您的 info.plist 文件中，它会有所作为:)

UIStatusBarHidden UIViewControllerBasedStatusBarAppearance

![在此处输入图像描述](../Images/2c3a5462fc38c70e191ea946ae6facb5.png)

适用于 iOS **11.4+ 和 Xcode 9.4+**

在一个或所有视图控制器中使用此代码

> 覆盖 var prefersStatusBarHidden: Bool { return true }

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2013-08-14T10:40:51.210

将以下代码添加到您的视图控制器：

```
if ([self respondsToSelector:@selector(setNeedsStatusBarAppearanceUpdate)]) {
    // iOS 7
    [self performSelector:@selector(setNeedsStatusBarAppearanceUpdate)];
} else {
    // iOS 6
    [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationSlide];
}

- (BOOL)prefersStatusBarHidden {
    return YES;
} 
```

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2013-12-17T10:02:34.793

对我有帮助的是（更改 plist 文件）：

1.  设置**状态栏最初是隐藏的 = YES**
2.  添加行：**查看基于控制器的状态栏外观 = NO**

![隐藏状态栏 - plist 设置](../Images/463e3c30b6b0f44348fbc1a1012864d1.png)

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2013-09-23T07:18:11.543

将此代码放入隐藏状态栏的视图控制器中：

```
- (BOOL)prefersStatusBarHidden {return YES;} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-08-23T22:51:42.217

在 iOS 7 状态栏外观取决于`UIViewController`默认情况。要全局隐藏状态栏，`info.plist`使用key 的 value 并使用`NO`value的方法。`UIViewControllerBasedStatusBarAppearance``UIApplication``setStatusBarHidden``YES` `BOOL`

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-09-23T21:24:55.393

从“info.plist”的下拉列表中添加此键，瞧，您将不会再看到包含诸如 GSM、wifi 图标等元素的顶部栏。
![在此处输入图像描述](../Images/2c3a5462fc38c70e191ea946ae6facb5.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-05-12T09:30:21.483

它对我有用，

将以下代码添加到 info.plist 文件中，

```
 <key>UIStatusBarHidden</key>
 <false/>
 <key>UIViewControllerBasedStatusBarAppearance</key>
 <false/> 
```

希望这对某人有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-21T13:38:01.073

我支持 iOS 5、6 和 7。我的应用仅适用于 iPad。我需要使用以下所有内容：

```
[[UIApplication sharedApplication] setStatusBarHidden:YES]; 
```

视图控制器：

```
- (BOOL)prefersStatusBarHidden{ return YES; } 
```

信息列表

```
 <key>UIStatusBarHidden</key>
    <string>YES</string>

    <key>UIStatusBarHidden~ipad</key>
    <true/>

    <key>UIViewControllerBasedStatusBarAppearance</key>
    <string>NO</string> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-24T11:06:06.583

在`info.plist`

```
View controller-based status bar appearance NO
Status bar is initially hidden YES 
```

在`view controller.m`

```
- (BOOL) prefersStatusBarHidden
{
    return YES;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-20T20:29:30.173

I had the same problem, but its an easy fix! Just set

```
status bar is initially hidden = YES 
```

then add an row by clicking on the plus right after the text `status bar is initially hidden`, then set the text to

```
view controller-based status bar appearance 
```

by clicking the arrows, and set it to `NO`

Hope this helps!

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-08T11:12:29.747

只需选中 Targets/Summary iPad Deployment Info 上的框，您的状态栏就会消失。它适用于我的应用程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-05-15T11:17:27.237

好吧，我最简单的方法是在 .m 文件中输入以下内容。

```
- (BOOL) prefersStatusBarHidden
{
    return YES;
} 
```

这应该工作！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-05-21T12:41:24.133

```
-(void) viewWillAppear:(BOOL)animated
{
     [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationSlide];
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-08-04T04:12:44.280

要以编程方式隐藏每个单独视图控制器的状态栏，请使用以下两个过程中的任何一个：

## 程序1：

```
[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone]; 
```

## 程序2：

```
-(BOOL)prefersStatusBarHidden {
    return YES;
} 
```

要隐藏整个应用程序的状态栏，我们应该遵循以下过程：

您应该将此值添加到 plist：“查看基于控制器的状态栏外观”并将其设置为“否”。

[点击这里查看截图](https://i.stack.imgur.com/FSxcK.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-05-26T04:08:24.063

一个完整的解决方案，在您的视图控制器中

```
// you can use your own logic to determine if you need to hide status bar
// I just put a var here for now
var hideStatusBar = false
override func preferStatusBarHidden() -> Bool {
    return hideStatus
}

// in other method to manually toggle status bar
func updateUI() {
    hideStatusBar = true
    // call this method to update status bar
    prefersStatusBarHidden()
} 
```

# javascript - 如何从 cookie 中检索指定的数据？jQuery

> ID：12661035
> 
> 赞同：0
> 
> 时间：2012-09-30T11:52:16.480
> 
> 标签：javascript, jquery, cookies

我目前正在处理一个简单的待办事项列表。我将任务存储在 cookie 中，当网页重新加载时，我会从 cookie 中检索我以前的任务。但是我无法将我的任务保存为已完成，即我标记为完成的任务。

```
function toHTML(id, text) {

    return '<div class="todo" id="' + id + '">' +
        '<div id="' + cbid + '"><input type="checkbox" class="check_todo" name="check_todo"/></div>' +
        '<div class="todo_description" contentEditable = "true">' +
            text +
        '</div>' +
        '<img src = "sun-icon.gif" class="close" title = "Delete the Task" />' +
    '</div>';
} 
```

当我按下复选框时，带有 class = "todo" 的 div 得到 class = "checked" 并且这个 div 内的文本 (todo_description) 变成了交叉，带有 class="todo" 的 div 本身也得到了另一种颜色。

```
$('#item-' + counter +' .check_todo').unbind('click');
    $('#item-' + counter +' .check_todo').click( function() {   
        var todo = $(this).parent().parent();
        todo.toggleClass('checked');

    }); 
```

当我重新加载页面时，我看到了我以前的任务但没有完成的任务，因为我只从 cookie 中检索文本：

```
 function get_cookies_array(){ 

        var cookies = { };
        if (document.cookie && document.cookie != '') {

            var split = document.cookie.split(';');
            for (var i = 0; i < split.length; i++) {
                var name_value = split[i].split("=");
                name_value[0] = name_value[0].replace(/^ /, '');
                cookies[decodeURIComponent(name_value[0])] = decodeURIComponent(name_value[1]);
            } 
        }
        return cookies;   
    } 
```

//这里显示我的任务

```
var cookies = get_cookies_array();
        var i = 0;
        for(var name in cookies) {
            $('.todo_list').prepend(toHTML('item-' + (i++), cookies[name]));
             } 
```

我试图检查类“已检查”， `if $(cookies[name]).hasClass('checked') { make stylings for this div}` 但这不起作用，我需要检查带有 class =“todo”的 div，当我按下复选框时它变成“todo checked”。

如果有人可以帮助我，我会很感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T12:08:38.300

如果你想检查复选框是否被选中，你可以尝试：

```
$('#id_checkbox').is(':checked'); 
```

如果您想在不重新加载页面的情况下获取 cookie，您可以在设置和获取 cookie 之间设置超时

# iphone - 应用程序在 [managedObjectContext save:] 上退出而没有错误

> ID：12661038
> 
> 赞同：0
> 
> 时间：2012-09-30T11:52:37.977
> 
> 标签：iphone, objective-c, ios, core-data, crash

我的代码使用核心数据执行了许多任务，然后当我去保存时，它崩溃而没有任何错误。我的保存代码很简单：

```
[[self managedObjectContext] save:&error];

NSLog(@"Error: %@", error); 
```

它没有到达错误行，到那时它已经崩溃并退出到主屏幕。

我在诊断中选择了除“Guard Malloc”之外的所有内容。

这是我在运行 save 命令时得到的日志：

```
CoreData: sql: BEGIN EXCLUSIVE
CoreData: sql: SELECT Z_MAX FROM Z_PRIMARYKEY WHERE Z_ENT = ?
CoreData: sql: UPDATE Z_PRIMARYKEY SET Z_MAX = ? WHERE Z_ENT = ? AND Z_MAX = ?
CoreData: sql: COMMIT
CoreData: sql: BEGIN EXCLUSIVE
CoreData: sql: INSERT INTO ZENTRY(Z_PK, Z_ENT, Z_OPT, ZLOCATION, ZBOOKMARKED, ZCREATIONDATE, ZENTRYID, ZMESSAGE, ZSECTIONIDENTIFIER, ZTICDSSYNCID, ZVERSION) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
CoreData: sql: COMMIT
CoreData: sql: pragma page_count
CoreData: annotation: sql execution time: 0.0047s
CoreData: sql: pragma freelist_count
CoreData: annotation: sql execution time: 0.0069s 
```

在此之前没有提及任何错误。我怎样才能得到一些迹象表明是什么让我的应用程序崩溃了？

编辑：我现在知道这发生在调用之后，`[NSEntityDescription insertNewObjectForEntityForName:@"Entry" inManagedObjectContext:[self managedObjectContext]];`并且它是由 TICoreDataSync 在此之前在我的核心数据存储上执行的方法引起的。我无法更改该代码，也无法将其从我的核心数据存储中移除。我认为这是在多个线程上访问商店的问题，所以现在我需要知道如何在主线程上处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T12:46:38.530

显然 MOC 已损坏。它是从多个线程访问的吗？

我要做的是，每次更改（moc 可保存 - 一致），尝试保存。发生损坏的地方会崩溃，因此您现在至少或多或少地知道问题出在哪里。

我在我的应用程序中执行此操作 - 事实上，所有开发构建都会不断保存，只有部署和 QA 构建将其关闭。我以这种方式发现了很多错误。将保存包装在一些 if 标志语句中或编写宏。

# android - 如何在 Android 中初始化一个新的 Camera.Size

> ID：12661041
> 
> 赞同：11
> 
> 时间：2012-09-30T11:53:19.947
> 
> 标签：android

例如：

```
int width = 720;
int height = 1280; 
```

我想创建一个 Camera.Size。

```
Camera.Size size = new Camera.Size(width,height); 
```

但它有一些错误。

```
No enclosing instance of type Camera is accessible. Must qualify the allocation with an enclosing instance of type Camera (e.g. x.new A() where x is an instance of Camera). 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-09-08T19:01:29.427

实际上，需要稍微不同的语法：

```
Camera camera = Camera.open();
Camera.Size size = camera.new Size(width, height); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-20T08:51:44.537

我知道您很久以前就发布了您的问题，但我对此错误有一些解释。正如您[在此处](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/hardware/Camera.java#Camera.Size)看到的，Size 类在 Camera 类中被声明为公共（但非静态）。[您可以在此处](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)找到有关此架构的一些信息。

因此，要创建一个新的 Camera.Size 对象，您必须从创建一个 Camera 对象开始。

```
Camera camera = Camera.open(); 
```

然后你可以创建你的 Camera.Size 对象：

```
Camera.Size size = camera.new Camera.Size(width, height); 
```

我不确定您是否真的想使用这种方式来执行此操作，但这是对您的错误的解释。

# php - Symfony2：将表单添加到另一个表单

> ID：12661043
> 
> 赞同：1
> 
> 时间：2012-09-30T11:53:25.460
> 
> 标签：php, symfony, many-to-one

很简单：

我有一个实体机构

```
/**
 * @var \Rewards\LocationBundle\Entity\Address
 *
 * @ORM\ManyToOne(targetEntity="\Acme\xxBundle\Entity\Address", cascade={"persist"})
 * @ORM\JoinColumn(name="address_id", referencedColumnName="id")
 */
protected $address; 
```

我有一个用于创建表单的 AgencyType：

```
 $builder
        ->add('name')
        ->add('address'); 
```

我也有地址类型

```
 $builder
        ->add('street')
        ->add('zipCode')
        ->add('city')
        ->add('country'); 
```

如果我把这个配置：

```
{{ form_widget(form) }} 
```

在树枝模板中，我只查看“选择”表单小部件，但我想查看表单 AgencyType AddressType 中的所有字段。

我怎么能这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T17:32:17.340

我已经解决了这个问题！

```
$builder
    ->add('name')
    ->add('agents')
    ->add('address', new AddressType()); 
```

干净又简单！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-16T10:06:23.500

在 symfony 3/4 中，您应该在 AdressType 表单中添加实体的数据类（实体）。例如：

```
public function configureOptions(OptionsResolver $resolver)
{
    $resolver->setDefaults([
        'data_class' => Address::class,
    ]);
} 
```

# python - 句子拆分的基本编号？

> ID：12661049
> 
> 赞同：0
> 
> 时间：2012-09-30T11:53:59.657
> 
> 标签：python, xml

> **可能重复：**
> [对 .xml 文件中 <P> 内的句子进行编号？](https://stackoverflow.com/questions/12643798/numbering-the-sentences-inside-a-p-in-a-xml-file)

我刚开始编程，所以这个问题很简单，除了我。我有一个 .xml 文件，其中包含如下内容：

```
<p> sentence1\. sentence2\. sentence3.</p>
<p> sentence1\. </p> 
```

现在我用 BeautifulSoup 编写了一个脚本来附加每个以字符串结尾的段落，所以它看起来像：

```
<p> sentence1\. sentence2\. sentence3\. STRING</p>
<p> sentence1\. STRING </p> 
```

在仅包含 1 个句子的 < p > 中，这就是我想要做的。但是如果一个 <p> 包含的句子多于 I 句，我想将 STRING 添加到每个句子结尾 + 句号。例如上面的段落是：

```
<p> sentence1\. STRING1 sentence2\. STRING2 sentence3\. STRING3 </p> 
```

这是我使用 .append 方法的 1 个句子的工作脚本，但我无法让它适用于多个句子。任何帮助，将不胜感激！

```
soup = BeautifulSoup(xmlfile)
p = norm.findAll("p")

for i in p:
    dotsplit = re.compile(r'\. \w')
    sentences = dotsplit.split(i.text)

    if len(sentences) == 1:
        appendix = "STRING"
        i.append(appendix)
        print i

    if len(sentences) > 1:
        for x in sentences:
            sentencenumber = ???????  
            # Should equal (index of sentences)+1,  meaning sentences[0] = 1
            appendix = sentencenumber + "STRING"
            i.append(appendix)
            print i 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:04:04.297

这应该足够了：

```
if len(sentences) > 1:
    for n, x in enumerate(sentences):
        sentencenumber = n + 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T12:54:11.660

如果我理解正确：

```
if len(sentences) == 1:
    print sentences[0] + 'STRING'
elif len(sentences) > 1:
    isentences = ('%s%s%d' % (s, 'STRING', i) for i, s in enumerate(sentences, 1))
    print ' '.join(isentences) 
```

> 我不知道如何在每句话后面附加它

[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)文档说您必须使用方法 tag.string.replace_with 而不是 tag.append：

```
 isentences = ('%s%s%d' % (s, 'STRING', i) for i, s in enumerate(sentences, 1))
    i.string.replace_with(' '.join(isentences)) 
```

# rvm - 使用 rvm 安装后 jruby/lib 在哪里？

> ID：12661050
> 
> 赞同：1
> 
> 时间：2012-09-30T11:54:06.400
> 
> 标签：rvm, jruby

使用 rvm，Jruby 的安装很简单：

```
rvm install jruby 
```

但是，我不知道在哪里可以找到要添加特定 java jar（例如 swt.jar）的 jurby/lib。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T03:55:52.557

```
$ rvm use jruby
Using /Users/asari/.rvm/gems/jruby-1.6.8
$ jruby -e 'p $:'
["/Users/asari/.rvm/rubies/jruby-1.6.8/lib/ruby/site_ruby/1.8", "/Users/asari/.rvm/rubies/jruby-1.6.8/lib/ruby/site_ruby/shared", "/Users/asari/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8", "."] 
```

你可以随时设置你`$:`的，例如，

```
$: << File.join(File.dirname(__FILE__), 'lib') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T06:29:25.663

当你安装jruby as`rvm install jruby`时，我相信它仍然安装1.6.7.2，所以你会发现lib目录下`~/.rvm/rubies/jruby-1.6.7.2/lib`

# c# - WCF 将自定义 HTTP 标头添加到请求中

> ID：12661053
> 
> 赞同：4
> 
> 时间：2012-09-30T11:54:39.163
> 
> 标签：c#, wcf, soap

我对 WCF 服务的消息解析有问题。我运行了 WCF 应用程序的**服务器端**。另一家公司向我发送了这样的 HTTP POST 请求：

```
POST /telemetry/telemetryWebService HTTP/1.1
Host: 192.168.0.160:12123
Content-Length: 15870
Expect: 100-continue
Connection: Keep-Alive

<?xml version="1.0" encoding="utf-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
  <soapenv:Header>
    <wsse:Security> ... </wsse:Security>
  </soapenv:Header>
<soapenv:Body>
...
</soapenv:Body>
</soapenv:Envelope> 
```

您如何在此 HTTP 请求中看到这一点，缺少 2 个重要的标头：**Soap Action**和**Content-type**。这就是我的服务无法正确处理此请求的原因。

我需要捕获请求**，直到它开始被处理并手动添加这些标头。**

我已经尝试过**IDispatchMessageInspector**，但没有任何结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T07:26:35.853

当处理 SOAP 消息时，服务器端的调度是根据soap action header 完成的，它指示调度程序应该处理消息的相应方法是什么。

有时肥皂动作为空或无效（java 互操作）。

我认为您最好的选择是实现 IDispatchOperationSelector。这样，您可以覆盖服务器将传入消息分配给操作的默认方式。

在下一个示例中，调度程序将 SOAP 主体内的第一个元素的名称映射到操作名称，消息将被转发到该操作名称以进行处理。

```
 public class DispatchByBodyElementOperationSelector : IDispatchOperationSelector
    {
        #region fields

        private const string c_default = "default";
        readonly Dictionary<string, string> m_dispatchDictionary;

        #endregion

        #region constructor

        public DispatchByBodyElementOperationSelector(Dictionary<string, string> dispatchDictionary)
        {
            m_dispatchDictionary = dispatchDictionary;
            Debug.Assert(dispatchDictionary.ContainsKey(c_default), "dispatcher dictionary must contain a default value");
        }

        #endregion

        public string SelectOperation(ref Message message)
        {
            string operationName = null;
            var bodyReader = message.GetReaderAtBodyContents();
            var lookupQName = new
               XmlQualifiedName(bodyReader.LocalName, bodyReader.NamespaceURI);

            // Since when accessing the message body the messageis marked as "read"
            // the operation selector creates a copy of the incoming message 
            message = CommunicationUtilities.CreateMessageCopy(message, bodyReader);

            if (m_dispatchDictionary.TryGetValue(lookupQName.Name, out operationName))
            {
                return operationName;
            }
            return m_dispatchDictionary[c_default];
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T07:32:43.750

谢谢你们。

1）您需要创建自己的**自定义消息编码器**，默认情况下可以在其中创建 Content-type。Yщu 可以在[这里](http://msdn.microsoft.com/en-us/library/ms735115%28v=vs.110%29)阅读示例。

2）您需要创建**自定义消息过滤器**，因为您需要跳过没有**SoapAction的消息**

```
public class CustomFilter : MessageFilter
{
    private int minSize;
    private int maxSize;
    public CustomFilter()
        : base()
    {

    }
    public CustomFilter(string paramlist)
        : base()
    {
        string[] sizes = paramlist.Split(new char[1] { ',' });
        minSize = Convert.ToInt32(sizes[0]);
        maxSize = Convert.ToInt32(sizes[1]);
    }
    public override bool Match(System.ServiceModel.Channels.Message message)
    {
        return true;
    }
    public override bool Match(MessageBuffer buffer)
    {
        return true;
    }
} 
```

3）您需要创建**自定义消息选择器**以将传入消息分配给操作。**Cyber​​maxs**的例子非常好。

# java - Java算法：按多个案例条件配对列表条目

> ID：12661054
> 
> 赞同：4
> 
> 时间：2012-09-30T11:54:45.163
> 
> 标签：java, algorithm, list

我担心这不是一个简单的问题。我一直在思考这个问题的适当解决方案，并希望一群新的大脑对这个问题有更好的看法 - 让我们开始吧：

**资料**：

我们在这里使用的是一个包含多个列的 csv 文件，与此问题相关的是：

*   用户ID（整数，3~8位，存在多个同一个UserID的条目）**LIST IS SORTED BY THIS**
*   请求参数）
*   Epoc (Long, epoc 时间值)
*   点击网址（字符串）

我们在这里使用的数据中的每个条目都有这些属性的 !null 值。

**示例数据：**

```
SID,UID,query,rawdate,timestamp,timegap,epoc,lengthwords,lengthchars,rank,clickurl
5,142,westchester.gov,2006-03-20 03:55:57,Mon Mar 20 03:55:57 CET 2006,0,1142823357504,1,15,1,http://www.westchestergov.com
10,142,207 ad2d 530,2006-04-08 01:31:14,Sat Apr 08 01:31:14 CEST 2006,10000,1144452674507,3,12,1,http://www.courts.state.ny.us
11,142,vera.org,2006-04-08 08:38:42,Sat Apr 08 08:38:42 CEST 2006,11000,1144478322507,1,8,1,http://www.vera.org 
```

**注意：** “Epoc”有多个具有相同值的条目，这是由于用于收集数据的工具所致

**注意2：**列表的大小约为700000，仅供参考

**目标**：匹配具有相同查询的条目对

范围：共享相同 UserID 的条目

由于在数据收集过程中提到的异常，必须考虑以下几点：

如果 'Query' 和 'Epoc' 的两个条目共享相同的值，则必须检查列表中的以下元素是否符合这些条件，直到下一个条目具有这些属性之一的不同值。共享相同 Query 和 Epoc 值的条目组将被视为 -one- 条目，因此为了匹配一对，必须找到与“Query”值匹配的另一个条目。由于没有更好的名称，我们将共享相同 Query 和 Epoc 值的组称为**“链”**

现在它已经出来了，它变得更容易了，我们可以从中得到 3 种类型的配对组合：

1.  入境与入境
2.  入口&连锁
3.  链条&链条

此处键入 1 仅表示列表中的两个条目对于“Query”共享相同的值，但对于“Epoc”不共享。

所以这总结了**相等的查询对**

还有**不同查询对**的情况，可以描述如下：

在我们匹配了相等的查询对之后，有可能存在没有与其他条目配对的条目，因为它们的查询不匹配 - 因为这个原因而没有与另一个条目匹配的每个条目都是**集合的一部分称为“不同的查询”**

该集合的成员必须在不遵循任何标准的情况下配对，但链仍被视为该对的一个条目。

至于匹配对，一般来说，可能没有冗余对——单个条目可以是 n 多个对的一部分，但两个单独的条目只能形成一对。

***例子：***

以下条目将成对出现

```
UID,Query,Epoc,Clickurl
772,Donuts,1141394053510,https://www.dunkindonuts.com/dunkindonuts/en.html
772,Donuts,1141394053510,https://www.dunkindonuts.com/dunkindonuts/en.html
772,Donuts,1141394053510,https://www.dunkindonuts.com/dunkindonuts/en.html
772,raspberry pi,1141394164710,http://www.raspberrypi.org/
772,stackoverflow,1141394274810,http://en.wikipedia.org/wiki/Buffer_overflow
772,stackoverflow,1141394274850,http://www.stackoverflow.com
772,tall women,1141394275921,http://www.tallwomen.org/
772,raspberry pi,1141394277991,http://www.raspberrypi.org/
772,Donuts,114139427999,http://de.wikipedia.org/wiki/Donut
772,stackoverflow,1141394279999,http://www.stackoverflow.com
772,something,1141399299991,http:/something.else/something/ 
```

在这个例子中，甜甜圈是一个链，因此对是（没有标题的行号）：

*   相等的查询对：(1-3,9) (4,8) (5,6) (5,10) (6,10)
*   不同的查询对：(7,11)

我的 - 失败 - 解决问题的方法：

我开发来解决这个问题的算法如下：

迭代条目列表，直到 UserID 的值发生更改。

然后，应用于一个单独的列表，该列表仅包含共享相同 UserID 的刚刚迭代的元素：

```
 for (int i = 0; i < list.size(); i++) {
            Entry tempI = list.get(i);
            Boolean iMatched = false;
            //boolean to save whether or not c1 is set
            Boolean c1done = false;
            Boolean c2done = false;

        //Hashsets holding the clickurl values of the entries that form a pair
        HashSet<String> c1 = null;
        HashSet<String> c2 = null;

        for (int j = i + 1; j < list.size(); j++) {
            Entry tempJ = list.get(j);
            // Queries match
            if (tempI.getQuery().equals(tempJ.getQuery())) {
                // wheter or not Entry at position i has been matched or not
                if (!iMatched) {
                    iMatched = true;
                }
                HashSet<String> e1 = new HashSet<String>();
                HashSet<String> e2 = new HashSet<String>();
                int k = 0;
                // Times match
                HashSet<String> chainset = new HashSet<String>();
                if (tempI.getEpoc() == tempJ.getEpoc()) {
                    chainset.add(tempI.getClickurl());
                    chainset.add(tempJ.getClickurl());
                } else {
                    e1.add(tempI.getClickurl());
                    if (c1 == null) {
                        c1 = e1;
                        c1done = true;
                    } else {
                        if (c2 == null) {
                            c2 = e1;
                            c2done = true;
                        }
                    }
                }
                //check how far the chain goes and get their entries
                if ((j + 1) < list.size()) {
                    Entry tempjj = list.get(j + 1);
                    if (tempjj.getEpoc() == tempJ.getEpoc()) {
                        k = j + 1;
                        //search for the end of the chain
                        while ((k < list.size())
                                && (tempJ.getQuery().equals(list.get(k)
                                        .getQuery()))
                                && (tempJ.getEpoc() == list.get(k).getEpoc())) {

                            chainset.add(tempJ.getClickurl());
                            chainset.add(list.get(k).getClickurl());
                            k++;

                        }
                        j = k + 1; //continue the iteration at the end of the chain
                        if (c1 == null) {
                            c1 = chainset;
                            c1done = true;
                        } else {
                            if (c2 == null) {
                                c2 = chainset;
                                c2done = true;
                            }
                        }

                        // Times don't match
                    }
                } else {
                    e2.add(tempJ.getClickurl());
                    if (c1 == null) {
                        c1 = e2;
                        c1done = true;
                    } else {
                        if (c2 == null) {
                            c2 = e2;
                            c2done = true;
                        }
                    }
                }

                /** Block that compares the clicks in the Hashsets and computes the resulting data
                *  left out for now to not make this any more complicated than it already is
                **/

                // Queries don't match
            } else {
                if (!dq.contains(tempJ)) { //note: dq is an ArrayList holding the entries of the differen query set
                    dq.add(tempJ);
                }
            }

            if (j == al.size() - 1) {
                if (!iMatched) {
                    dq.add(tempI);
                }
            }
        }
        if (dq.size() >= 2) {

            for (int z = 0; z < dq.size() - 1; z++) {
                if (dq.get(z + 1) != null) {
                    /** Filler, iterate dq just like the normal list with two loops
                    *
                    **/
                }
            }
        }

    } 
```

因此，我尝试使用过多的循环来匹配这些对，导致运行时间非常长，直到这一点我才看到

好的，我希望我没有忘记任何重要的事情，稍后我会添加更多需要的信息如果您已经做到了这一点，感谢您的阅读 - 希望您有一个可以帮助我的想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T19:11:08.747

使用 SQL 将数据导入数据库，然后执行查询。你的txt文件太大了；难怪需要这么长时间才能通过它。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T18:10:11.740

首先，从每个链中删除除一个条目之外的所有条目。为此，请按（用户 ID、查询、纪元）排序，删除重复项。

然后，扫描排序列表。获取 (userid, query) 对的所有条目。如果只有一个，则将其保存在列表中以供以后处理，否则发出所有对。

对于您为以后处理而保存的给定用户的所有条目（这些是类型 2 和 3），发出对。

# php - 如何使用 textinput 值添加 mysql 查询条件？

> ID：12661059
> 
> 赞同：0
> 
> 时间：2012-09-30T11:55:32.787
> 
> 标签：php, ajax, jquery, yii

如何在控制器动作中处理表单？

例如在我看来：

```
<form id="formid">
 <input name="yrlevel"></input>
</form> 
```

我将如何在我的操作中这样处理它（从文本字段的值添加 mysql 查询条件）：

```
$criteria->addSearchCondition('yrLvl', $_GET['yrlevel'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:39:52.837

你已经完成了一半的工作；您需要将值添加到条件中，就像您所做的那样，然后您需要在调用搜索时指定该条件，如下所示：

```
$criteria = new CDbCritera;
// If you want to use MySQL's 'LIKE' syntax you could use addSearchCondition()
$criteria->addSearchCondition('yrlevel',$_GET['yrlevel'], true);
// If you want to do a direct comparison you could use condition()
$criteria->condition('yrlevel = :yrlevel');
$criteria->params = array(
    ':yrlevel'=>$_GET['yrlevel']
);

$models = MyModel::model()->findAll($criteria); 
```

`$models`然后将包含与搜索条件匹配的模型数组。我已经在上面展示`addSearchCondition()`了`condition()`如何使用它们的示例（您可能不想将它们一起用于我上面展示的相同字段），请查看[CDbCriteria](http://www.yiiframework.com/doc/api/1.1/CDbCriteria)以获取有关如何构建的更多信息查询。

Yii 将使用 PDO 绑定您的参数，因此您绝对不需要自己清理数据，尽管您可能出于任何原因想要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T11:58:16.800

我不是`yii`专家，但本教程将帮助您添加搜索条件

[http://www.yiiframework.com/doc/api/1.1/CDbCriteria#addSearchCondition-detail](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#addSearchCondition-detail)

试试这个..

`strip_slashes`并在直接输入`$_GET`数据前尝试使用。

# asp.net-mvc - asp.net mvc 中的 IDependencyResolver

> ID：12661069
> 
> 赞同：2
> 
> 时间：2012-09-30T11:56:32.603
> 
> 标签：asp.net-mvc

我在 MVC（基础书籍）中阅读了有关 IDependencyResolver 的内容，但我不知道 mvc 中的 DependencyResolver 到底是什么？

有人可以解释这些方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T11:58:22.023

它允许在控制器和其他组件中实现依赖注入。布拉德威尔逊写了一篇关于它的[好文章](http://bradwilson.typepad.com/blog/2010/10/service-location-pt5-idependencyresolver.html)。例如，当您实现一个能够为给定类型返回正确实现的自定义依赖解析器时，您可以让您的 ASP.NET MVC 控制器将抽象依赖或接口作为构造函数参数：

```
public class HomeController: Controller
{
    private readonly ISomeService _someService;
    public class HomeController(ISomeService someService)
    {
        _someService = someService;
    }

    ... some actions
} 
```

如果您编写了自定义依赖关系解析，它将能够在实例化控制器时注入接口的正确实现。

依赖注入允许应用程序的不同层之间的耦合更弱，并使它们更容易单独进行单元测试。

# c# - VS2012 C# SQL 数据库错误 - 安装不正确？

> ID：12661073
> 
> 赞同：0
> 
> 时间：2012-09-30T11:57:18.593
> 
> 标签：c#, visual-studio-2012, sql-server-2012

在计算机 A 上，我的项目运行良好，但在计算机 BI 上出现 SQL 异常：

> *建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 -**错误定位服务器/指定实例**）*

每次我调用该`CreateDatabse()`方法（从`Database`类继承自`DataContext`类）。

我已经尝试重新安装整个 SQL Server - 但异常仍然存在。我安装了 SQL Server 2012。我安装的 SQL 相关程序列表：

![我安装的 SQL 相关程序列表](../Images/6e7e065271e8297d2fe0ffd2dc1eab0a.png)

如果有任何区别，计算机A在win8下运行，计算机B在win7下运行。

数据库由程序代码创建：

```
String FOLDER_PATH = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), "ProgramName");
Directory.CreateDirectory(FOLDER_PATH);

String path = Path.Combine(FOLDER_PATH, "database.mdf");
Database db = new Database(path);

bool exists = db.DatabaseExists();

if (exists == false)
    db.CreateDatabase();

public class Database : DataContext
{
    public Table<Record> RecordTable;
    public Database(string connection) : base(connection) { }
} 
```

编辑：我的问题仍未解决。我尝试再次重新安装 MS SQL，但没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T12:03:23.773

当连接字符串未正确配置或计算机 A 上的防火墙阻止 SQLServer 在网络上正常工作时，会出现此问题...

# android - 没有这样的列异常？

> ID：12661075
> 
> 赞同：0
> 
> 时间：2012-09-30T11:57:34.367
> 
> 标签：android, android-sqlite

我正在通过 web 上的教程尝试使用 android 数据库，但没有得到这样的列异常，请帮助。这是我的代码：

```
public class MySQLiteHelper extends SQLiteOpenHelper {

    private static final String DB_NAME = "db_name.db";
    private static final int DB_VERSION = 1;

    public static final String DB_TABLENAME="vaib";

    //columns
    public static final String DB_COL1 = "_id";
    public static final String DB_COL2 = "comments";

    private static final String DB_CREATE = " create table "
            + DB_TABLENAME + "(" + DB_COL1 +
            " integer primary key autoincrement, " + DB_COL2 
            + " text );";
    public MySQLiteHelper(Context context)
    {
        super(context,DB_NAME,null,DB_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub
        db.execSQL(DB_CREATE);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        Log.w(MySQLiteHelper.class.getName(),
                "Upgrading database from version " + oldVersion + " to "
                    + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS" + DB_TABLENAME);
        onCreate(db);

    }

}

//comment.java
//this class will store data in database & display value on UI.
public class Comment {

    private long id;
    private String comments;
    public long getId() {
        return id;
    }
    public void setId(long id) {
        this.id = id;
    }
    public String getComments() {
        return comments;
    }
    public void setComments(String comments) {
        this.comments = comments;
    }

    // Will be used by the ArrayAdapter in the ListView
      @Override
      public String toString() {
        return comments;
      }
}

//main activity
public class MainActivity extends ListActivity {
  private CommentsDataSource datasource;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    datasource = new CommentsDataSource(this);
    datasource.open();

    List<Comment> values = datasource.getAllComments();

    // Use the SimpleCursorAdapter to show the
    // elements in a ListView
    ArrayAdapter<Comment> adapter = new ArrayAdapter<Comment>(this,
        android.R.layout.simple_list_item_1, values);
    setListAdapter(adapter);
  }

  // Will be called via the onClick attribute
  // of the buttons in main.xml
  public void onClick(View view) {
    @SuppressWarnings("unchecked")
    ArrayAdapter<Comment> adapter = (ArrayAdapter<Comment>) getListAdapter();
    Comment comment = null;
    switch (view.getId()) {
    case R.id.add:
      String[] comments = new String[] { "Cool", "Very nice", "Hate it" };
      int nextInt = new Random().nextInt(3);
      // Save the new comment to the database
      comment = datasource.createComment(comments[nextInt]);
      adapter.add(comment);
      break;
    case R.id.delete:
      if (getListAdapter().getCount() > 0) {
        comment = (Comment) getListAdapter().getItem(0);
        datasource.deleteComment(comment);
        adapter.remove(comment);
      }
      break;
    }
    adapter.notifyDataSetChanged();
  }

  @Override
  protected void onResume() {
    datasource.open();
    super.onResume();
  }

  @Override
  protected void onPause() {
    datasource.close();
    super.onPause();
  }

} 
```

以下是日志消息：

```
09-30 17:21:42.679: E/AndroidRuntime(30819): FATAL EXCEPTION: main
09-30 17:21:42.679: E/AndroidRuntime(30819): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.databaseapp/com.example.databaseapp.MainActivity}: android.database.sqlite.SQLiteException: no such column: comments: , while compiling: SELECT _id, commentss FROM vaib
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.os.Looper.loop(Looper.java:130)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.app.ActivityThread.main(ActivityThread.java:3687)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at java.lang.reflect.Method.invokeNative(Native Method)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at java.lang.reflect.Method.invoke(Method.java:507)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at dalvik.system.NativeStart.main(Native Method)
09-30 17:21:42.679: E/AndroidRuntime(30819): Caused by: android.database.sqlite.SQLiteException: no such column: commentss: , while compiling: SELECT _id, commentss FROM vaib
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteCompiledSql.compile(SQLiteCompiledSql.java:92)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:65)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:83)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:49)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:42)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1357)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1236)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1190)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1272)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at dao.CommentsDataSource.getAllComments(CommentsDataSource.java:56)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at com.example.databaseapp.MainActivity.onCreate(MainActivity.java:23)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-30 17:21:42.679: E/AndroidRuntime(30819):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:05:10.903

仔细阅读异常：

```
SQLiteException: no such column: commentss: , while compiling: SELECT _id, commentss FROM vaib 
```

这告诉我们没有名为 的列`commentss`。您的列名为`comments`，而不是`commentss`...只需修复您的`SELECT`-statement 中的拼写错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:47:23.140

这一切都基于猜测和类似问题..您正在使用库或框架来代表您实现使用反射的数据访问层。

也就是说：
它使用模型类（如类）中的成员变量名称`Comment`来访问数据库中`comments`具有相似字段的表。

所以..基于这个假设，错误在以下行：

```
private String comments; 
```

在你的`Comment`课上。
它应该是：

```
private String comment; 
```

在行尾没有 (s)。

让我知道它是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-29T16:38:56.597

该错误表明该错误可能是在 MainActivity.java 中调用时

```
List<Comment> values = datasource.getAllComments(); 
```

使用文件“CommentsDataSource.java”第 56 行中的 getAllComments() 方法：

“在 dao.CommentsDataSource.getAllComments(CommentsDataSource.java:56)”

请检查此行，确保在此行的查询中重用相同的变量名称 DB_COL2。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T12:01:49.917

我猜你在某处拼错了评论 - >评论，因为这是错误。再次检查您的代码并确保在重新启动之前确实删除了数据库。只是改变

```
 private static final String DB_NAME = "db_name.db"; 
```

至

```
private static final String DB_NAME = "db_name01.db"; 
```

等等以避免混淆 - 并不断增加 01 到 02 等，直到您的数据库正常。

在更改数据库时保留相同的名称可能会给您带来奇怪的错误。

查看您的代码，我在任何地方都找不到评论-因此必须在其他地方或您以前的一些尝试中...

# pdf - 使用 PoDoFo 或其他任何开源的 PDF 预检程序？

> ID：12661093
> 
> 赞同：5
> 
> 时间：2012-09-30T12:00:59.000
> 
> 标签：pdf, printing, preflight, podofo

我必须自动对 PDF 文档进行预检检查。预检包括：

1.  检测现有文档中图像的分辨率，如果它们尚未达到该分辨率，则将其更改为 300dpi。
2.  检测图像的色彩空间，如果不是 CMYK，则使用颜色配置文件将它们转换为 CMYK。
3.  检测现有 PDF 文档中是否嵌入了字体，并通过替换字体来纠正此问题。（或绘制字体轮廓——我不确定这部分）。

只是想知道这是否可以使用 PoDoFo 或任何其他开源项目来完成。或者，如果我真的需要在 2000 美元到 6000 美元之间订购一些合适的软件。我的托管环境在 Linux 上，支持 PHP、Perl、Python、Ruby、Java。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T14:40:22.853

我不知道有任何现成的开源软件可以满足您的要求。

通过编写自己的 shell 脚本（或其他程序）只能解决其中的一部分问题。

1.  **检测图像的分辨率。**

    运行`pdfimages -list some.pdf`以输出 PDF 中包含的图像列表以及它们的尺寸......看似。但并不明显的是：这些尺寸是原始图像的尺寸（嵌入在 PDF 中）。这可能是 720x720 像素。但是，如果渲染到页面的 10x10 平方英寸，则此图像在页面上的 DPI 为 72。如果在 1x1 英寸的正方形上渲染，它将是 720 DPI。PDF 中的两种“渲染”类型都可以从同一个嵌入的原始图像中进行，而当前“图形状态”的上下文决定了应用哪种类型。因此，要确定页面上显示的图像的实际 DPI，需要一些额外的 PDF 解析......

    在任何情况下，您都可以告诉 Ghostscript 将图像重新采样到 300 dpi，并为此使用“阈值”。（Ghostscript 永远不会对图像进行“上采样”，只会对超出阈值的图像进行下采样。上采样几乎没有任何意义——它只会放大文件大小而不会带来更高质量的回报。）

2.  **使用 ICC 配置文件将颜色转换为色彩空间 CMYK。**

    最新版本的[**Ghostscript 可以做到这一点**](https://stackoverflow.com/a/10474997/359307)。另请参阅描述其对 ICC 的支持的[**最新 Ghostscript 文档。**](http://git.ghostscript.com/?p=ghostpdl.git;a=blob_plain;f=gs/doc/GS9_Color_Management.pdf;hb=HEAD)

3.  **嵌入未嵌入的字体。**

    运行（并评估结果）`pdffonts some.pdf`将显示哪些字体未嵌入。

    Ghostscript 可以[**嵌入未嵌入的字体**](https://stackoverflow.com/a/2981689/359307)。

因此，一个可以满足您大部分要求的 Ghostscript 命令是：

```
gs                                     \
  -o cmyk.pdf                          \
  -sDEVICE=pdfwrite                    \
  -sColorConversionStrategy=CMYK       \
  -sProcessColorModel=DeviceCMYK       \
  -sOutputICCProfile=/path/to/your.icc \
  -sColorImageDownsampleThreshold=2    \
  -sColorImageDownsampleType=Bicubic   \
  -sColorImageResolution=300           \
  -sGrayImageDownsampleThreshold=2     \
  -sGrayImageDownsampleType=Bicubic    \
  -sGrayImageResolution=300            \
  -sMonoImageDownsampleThreshold=2     \
  -sMonoImageDownsampleType=Bicubic    \
  -sMonoImageResolution=1200           \
  -dSubsetFonts=true                   \
  -dEmbedAllFonts=true                 \
  -sCannotEmbedFontPolicy=Error        \
  -c ".setpdfwrite<</NeverEmbed[ ]>> setdistillerparams" \
  -f some.pdf 
```

此命令将对分辨率高于两倍所需分辨率 ( `*ImageDownSampleThreshold=2`) 的所有图像进行下采样。它还将所有这些设置应用于任何输入文件（除非某些特殊的 PDF 预检软件会根据特殊属性的“检查”结果应用选择性“修复”）。

最后，我看不出是什么让您认为您必须花费 2,000 到 6,000 美元，以防您不得不求助于封闭源代码的商业预检软件。[（我在这个领域最喜欢的是非常强大的[callas pdfToolbox6](http://www.callassoftware.com/callas/doku.php/en:products:pdftoolbox)（它甚至有一个在 Linux 上作为 CLI 运行的版本）——它的基本版本需要 500 欧元。）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T20:49:18.753

我的背景是印刷，所以在阅读我的答案时请记住这一点。您建议做的项目看起来有些直截了当，但当您深入了解其中的本质时，这些操作中有很多印刷行业知识。

以下是对您的要点的一些快速反馈：

1.  您不希望将低分辨率图像上采样到 300 dpi，因为它会降低图像质量（通过重新插值）并增加文件大小。

2.  您需要小心颜色转换。您可能只想将某些 RGB 版本转换为黑色。或者，如果有人提供了一个已经是 cmyk 并带有错误配置文件标记的文件，会发生什么情况。

3.  字体检测 - 替换字体非常复杂。如果您没有与原始字体完全相同的字体，则最终可能会出现文本重排问题。要拥有该字体，您必须支付许可证费用。您也不能在没有嵌入字体的情况下将字体转换为轮廓。

我的建议是查看用于预检的商业包。这些开发人员已投入数年时间来开发他们的程序，并且是印刷领域的专家。具有挑战性的部分将是在您的价格范围内找到那些是 unix 的。大多数都是为 Windows 或 Mac 设计的。Callas 有一个 linux cl 版本，但没有列出的价格。你需要服务器版本。

您打算通过它运行什么类型的卷？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-08T07:14:45.997

您尝试过 Enfocus [PitStop Pro](http://www.enfocus.com/en/products/pitstop-pro)吗？根据您的具体要求联系他们的支持部门。他们有大量的[PDF 预检](http://www.enfocus.com/en/preflight)示例，很乐意为您提供帮助。

# java - 为什么我在这里得到空异常？

> ID：12661095
> 
> 赞同：0
> 
> 时间：2012-09-30T12:01:11.633
> 
> 标签：java, nullpointerexception

嗯，这似乎很奇怪。我有点初始化变量，它在初始化后立即在构造函数中工作，但是在 draw 方法中它不再工作了......

好吧，这是代码，每当我尝试在方法 draw() 中调用对象位置的任何方法时，我都会遇到异常：

```
public class GlText extends GraphicObject {

String fullText = "";

public GlText(Bounds bounds) {
    this.bounds = bounds;
    this.position = getPosition();
    System.out.println("BLOGAS: " + position.getX());
}

@Override
public void draw(Graphics g, AlignStrategy align) {
    g.setColor(Color.orange);
    g.setFont(new Font("Arial", Font.BOLD, 36));

    FontMetrics metrics = g.getFontMetrics();
    int textHeight = metrics.getHeight();
    int textWidth = metrics.stringWidth(fullText);

    // drawing position is recalculated according to text size, etc...
    int x = 0;
    int y = 0;

    // calculating x according to text width

    // !!!!!!!!!!!!!!! the Null pointer exception happens in the next line:
    System.out.println("POSITION " + position.getX());**
    System.out.println("TEXTWIDTH " + textWidth);
    System.out.println("BOUNDS " + bounds.getX());
    if (position.getX() - textWidth < bounds.getX())
        x = bounds.getX();
    else
        x = position.getX() - textWidth;

    // calculating y according to text height
    if (position.getY() - textHeight < bounds.getY())
        y = bounds.getY();
    else
        y = position.getY() - textHeight;

    Bounds drawPos = new Bounds(x, y, textWidth, textHeight);       

    // ADDED ALIGN STRATEGY
    Bounds alignedPosition = (Bounds) align.getAligned(drawPos, bounds);

    g.drawString(fullText, alignedPosition.getX(), alignedPosition.getY());

}

public final Bounds getPosition() {

        int x = 0;
        int y = 0;
        Random random = new Random();
        random.setSeed(System.nanoTime());

        x = bounds.getX() + random.nextInt(bounds.getWidth());
        y = bounds.getY() + random.nextInt(bounds.getHeight());

        Bounds newPosition = new Bounds(x, y, 0, 0);
        return newPosition;

} 
```

以下是异常的样子：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at GraphicObjectPkg.GlText.draw(GlText.java:43) 
```

这是我用 GlText 扩展的抽象类：

```
public abstract class GraphicObject {
    protected Bounds bounds = new Bounds();
    protected Bounds position = null;

    public abstract void draw(Graphics g, AlignStrategy align);
} 
```

好的，这是调用构造函数的地方，嗯，它是从外部调用的，但构造函数确实打印了“BLOGAS：180”行：

```
GlText myText = new GlText(currentBounds);
        myText.setFullText("gerai");
        mainGroup.addChild(myText); 
```

最终编辑：感谢大家帮助我，由于您的帮助，我终于确定了问题所在，这是剩下的：

```
public void setFullText(String fullText) {
    this.fullText = fullText;
    position = null;
} 
```

我已经修改了类，我完全忘记了这个方法有这样的东西......我通过使用 find 命令找到了这个，所以我想这次对我来说这个故事的寓意是你是否似乎没有创建任何其他变量，最好用编辑器上的查找功能测试一下...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:06:25.233

如果 draw 是一个回调事件，并且框架不使用您构造的对象，那么您将获得`NullPointerException`.

您需要确保框架在调用 draw 方法时使用传递的对象，您可以简单地使用方法中`==`的运算符来完成`draw`。

将构造函数中的引用存储到`GlText`

```
private final GlText customized = null;
//Inside Constructor 
 customized = this; 
```

内部`draw`方法

```
 if(this != customized )
 {
    System.out.println("Objects are different");
 } 
```

困难是理解框架并检查`draw`方法是如何被调用的:-)

# node.js - 在 mongoDB 中插入嵌入对象

> ID：12661096
> 
> 赞同：1
> 
> 时间：2012-09-30T12:01:15.070
> 
> 标签：node.js, mongodb, node-mongodb-native

鉴于此 Person 集合：

```
{
    "_id" : ObjectId("4f8e95a718bcv9c74da1e6511a"),
    "name" : "John",
    "hobbies" : [{
        "id" : 001,
        "name" : "reading",
        "location" : "home"
    },{
        "id" : 002,
        "name" : "sport",
        "location" : "outside"
    }]
} 
```

和这些新的/编辑的爱好对象：

```
{
    "name" : "walking",
    "location" : "outside"
} 
```

和

```
{
    "id" : 001,
    "name" : "reading",
    "location" : "outside"
} 
```

如果我知道`Person`我想要管理的内容，那么插入嵌入对象的最佳方法是什么？

目前我的方法是找到`Person`对象，在我的代码中对其进行必要的修改，然后将其保存回数据库。这行得通。但我想简化并减少到数据库的往返次数。

# java - JFrame 不显示

> ID：12661100
> 
> 赞同：3
> 
> 时间：2012-09-30T12:01:37.483
> 
> 标签：java, swing, jframe, bufferedimage

我正在尝试用下载的小程序制作游戏。我更改了所有内容，直到没有错误为止，但是当我运行它时，它显示一个空框架，我不知道出了什么问题！

`a.java`：

```
package game;

import javax.swing.JFrame;

public class a {
public a() {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(500,500);
    frame.add(new b());
    frame.setVisible(true);
}

    public static void main(String [] args) {
    a a = new a();
    }
} 
```

`b.java`：

```
package game;

import java.awt.Color;
import java.awt.Event;
import java.awt.Graphics;
import java.awt.Image;
import javax.swing.JPanel;

public class b extends JPanel implements Runnable {

Thread thread;
static final int TILE_SIZE = 16;
static final int WALL_HEIGHT = 16;
static final int PROJECTIONPLANEWIDTH = 320;
static final int PROJECTIONPLANEHEIGHT = 200;
static final int ANGLE60 = PROJECTIONPLANEWIDTH;
static final int ANGLE30 = (ANGLE60 / 2);
static final int ANGLE15 = (ANGLE30 / 2);
static final int ANGLE90 = (ANGLE30 * 3);
static final int ANGLE180 = (ANGLE90 * 2);
static final int ANGLE270 = (ANGLE90 * 3);
static final int ANGLE360 = (ANGLE60 * 6);
static final int ANGLE0 = 0;
static final int ANGLE5 = (ANGLE30 / 6);
static final int ANGLE10 = (ANGLE5 * 2);
float fSinTable[];
float fISinTable[];
float fCosTable[];
float fICosTable[];
float fTanTable[];
float fITanTable[];
float fFishTable[];
float fXStepTable[];
float fYStepTable[];
Image fOffscreenImage;
Graphics fOffscreenGraphics;
int fPlayerX = 100;
int fPlayerY = 160;
int fPlayerArc = ANGLE0;
int fPlayerDistanceToTheProjectionPlane = 277;
int fPlayerHeight = 32;
int fPlayerSpeed = 8;
int fProjectionPlaneYCenter = PROJECTIONPLANEHEIGHT / 2;
boolean fKeyUp = false;
boolean fKeyDown = false;
boolean fKeyLeft = false;
boolean fKeyRight = false;
byte fMap[];
static final byte W = 1;                                // wall
static final byte O = 0;                                // opening
static final int MAP_WIDTH = 12;
static final int MAP_HEIGHT = 12;
private boolean run = true;

float arcToRad(float arcAngle) {
    return ((float) (arcAngle * Math.PI) / (float) ANGLE180);
}

public void createTables() {
    int i;
    float radian;
    fSinTable = new float[ANGLE360 + 1];
    fISinTable = new float[ANGLE360 + 1];
    fCosTable = new float[ANGLE360 + 1];
    fICosTable = new float[ANGLE360 + 1];
    fTanTable = new float[ANGLE360 + 1];
    fITanTable = new float[ANGLE360 + 1];
    fFishTable = new float[ANGLE60 + 1];
    fXStepTable = new float[ANGLE360 + 1];
    fYStepTable = new float[ANGLE360 + 1];

    for (i = 0; i <= ANGLE360; i++) {
        radian = arcToRad(i) + (float) (0.0001);
        fSinTable[i] = (float) Math.sin(radian);
        fISinTable[i] = (1.0F / (fSinTable[i]));
        fCosTable[i] = (float) Math.cos(radian);
        fICosTable[i] = (1.0F / (fCosTable[i]));
        fTanTable[i] = (float) Math.tan(radian);
        fITanTable[i] = (1.0F / fTanTable[i]);
        if (i >= ANGLE90 && i < ANGLE270) {
            fXStepTable[i] = (float) (TILE_SIZE / fTanTable[i]);
            if (fXStepTable[i] > 0) {
                fXStepTable[i] = -fXStepTable[i];
            }
        } else {
            fXStepTable[i] = (float) (TILE_SIZE / fTanTable[i]);
            if (fXStepTable[i] < 0) {
                fXStepTable[i] = -fXStepTable[i];
            }
        }
        if (i >= ANGLE0 && i < ANGLE180) {
            fYStepTable[i] = (float) (TILE_SIZE * fTanTable[i]);
            if (fYStepTable[i] < 0) {
                fYStepTable[i] = -fYStepTable[i];
            }
        } else {
            fYStepTable[i] = (float) (TILE_SIZE * fTanTable[i]);
            if (fYStepTable[i] > 0) {
                fYStepTable[i] = -fYStepTable[i];
            }
        }
    }

    for (i = -ANGLE30; i <= ANGLE30; i++) {
        radian = arcToRad(i);
        fFishTable[i + ANGLE30] = (float) (1.0F / Math.cos(radian));
    }

    byte[] map = {
        W, W, W, W, W, W, W, W, W, W, W, W,
        W, O, O, O, O, O, O, O, O, O, O, W,
        W, O, O, O, O, O, O, O, O, O, O, W,
        W, O, O, O, O, O, O, O, W, O, O, W,
        W, O, O, W, O, W, O, O, W, O, O, W,
        W, O, O, W, O, W, W, O, W, O, O, W,
        W, O, O, W, O, O, W, O, W, O, O, W,
        W, O, O, O, W, O, W, O, W, O, O, W,
        W, O, O, O, W, O, W, O, W, O, O, W,
        W, O, O, O, W, W, W, O, W, O, O, W,
        W, O, O, O, O, O, O, O, O, O, O, W,
        W, W, W, W, W, W, W, W, W, W, W, W
    };
    fMap = map;
}

public void start() {
    createTables();
    thread = new Thread(this);
    thread.start();
}

public void run() {
    start();
    fOffscreenImage = createImage(size().width, size().height);
    fOffscreenGraphics = fOffscreenImage.getGraphics();

    while (true) {
        if (fKeyLeft) {
            if ((fPlayerArc -= ANGLE10) < ANGLE0) {
                fPlayerArc += ANGLE360;
            }
        } else if (fKeyRight) {
            if ((fPlayerArc += ANGLE10) >= ANGLE360) {
                fPlayerArc -= ANGLE360;
            }
        }

        float playerXDir = fCosTable[fPlayerArc];
        float playerYDir = fSinTable[fPlayerArc];

        if (fKeyUp) {
            fPlayerX += (int) (playerXDir * fPlayerSpeed);
            fPlayerY += (int) (playerYDir * fPlayerSpeed);
        } else if (fKeyDown) {
            fPlayerX -= (int) (playerXDir * fPlayerSpeed);
            fPlayerY -= (int) (playerYDir * fPlayerSpeed);
        }

        render();
        try {
            Thread.sleep(50);
        } catch (Exception sleepProblem) {
            System.out.println("Sleep problem");
        }
    }
}

public void drawBackground() {
    int c = 25;
    int r;
    for (r = 0; r < PROJECTIONPLANEHEIGHT / 2; r += 10) {
        fOffscreenGraphics.setColor(new Color(c, 125, 225));
        fOffscreenGraphics.fillRect(0, r, PROJECTIONPLANEWIDTH, 10);
        c += 20;
    }
    c = 22;
    for (; r < PROJECTIONPLANEHEIGHT; r += 15) {
        fOffscreenGraphics.setColor(new Color(c, 20, 20));
        fOffscreenGraphics.fillRect(0, r, PROJECTIONPLANEWIDTH, 15);
        c += 15;
    }
}

public void render() {
    drawBackground();

    int verticalGrid;
    int horizontalGrid;
    int distToNextVerticalGrid;
    int distToNextHorizontalGrid;
    float xIntersection;
    float yIntersection;
    float distToNextXIntersection;
    float distToNextYIntersection;

    int xGridIndex;
    int yGridIndex;

    float distToVerticalGridBeingHit;
    float distToHorizontalGridBeingHit;

    int castArc, castColumn;

    castArc = fPlayerArc;
    castArc -= ANGLE30;
    if (castArc < 0) {
        castArc = ANGLE360 + castArc;
    }
    for (castColumn = 0; castColumn < PROJECTIONPLANEWIDTH; castColumn += 5) {
        if (castArc > ANGLE0 && castArc < ANGLE180) {
            horizontalGrid = (fPlayerY / TILE_SIZE) * TILE_SIZE + TILE_SIZE;
            distToNextHorizontalGrid = TILE_SIZE;
            float xtemp = fITanTable[castArc] * (horizontalGrid - fPlayerY);
            xIntersection = xtemp + fPlayerX;
        } else {
            horizontalGrid = (fPlayerY / TILE_SIZE) * TILE_SIZE;
            distToNextHorizontalGrid = -TILE_SIZE;

            float xtemp = fITanTable[castArc] * (horizontalGrid - fPlayerY);
            xIntersection = xtemp + fPlayerX;

            horizontalGrid--;
        }
        if (castArc == ANGLE0 || castArc == ANGLE180) {
            distToHorizontalGridBeingHit = 9999999F;
        } else {
            distToNextXIntersection = fXStepTable[castArc];
            while (true) {
                xGridIndex = (int) (xIntersection / TILE_SIZE);
                yGridIndex = (horizontalGrid / TILE_SIZE);
                if ((xGridIndex >= MAP_WIDTH)
                        || (yGridIndex >= MAP_HEIGHT)
                        || xGridIndex < 0 || yGridIndex < 0) {
                    distToHorizontalGridBeingHit = Float.MAX_VALUE;
                    break;
                } else if ((fMap[yGridIndex * MAP_WIDTH + xGridIndex]) != O) {
                    distToHorizontalGridBeingHit = (xIntersection - fPlayerX) * fICosTable[castArc];
                    break;
                }
                else {
                    xIntersection += distToNextXIntersection;
                    horizontalGrid += distToNextHorizontalGrid;
                }
            }
        }

        if (castArc < ANGLE90 || castArc > ANGLE270) {
            verticalGrid = TILE_SIZE + (fPlayerX / TILE_SIZE) * TILE_SIZE;
            distToNextVerticalGrid = TILE_SIZE;

            float ytemp = fTanTable[castArc] * (verticalGrid - fPlayerX);
            yIntersection = ytemp + fPlayerY;
        }
        else {
            verticalGrid = (fPlayerX / TILE_SIZE) * TILE_SIZE;
            distToNextVerticalGrid = -TILE_SIZE;

            float ytemp = fTanTable[castArc] * (verticalGrid - fPlayerX);
            yIntersection = ytemp + fPlayerY;

            verticalGrid--;
        }
        if (castArc == ANGLE90 || castArc == ANGLE270) {
            distToVerticalGridBeingHit = 9999999;
        } else {
            distToNextYIntersection = fYStepTable[castArc];
            while (true) {
                xGridIndex = (verticalGrid / TILE_SIZE);
                yGridIndex = (int) (yIntersection / TILE_SIZE);

                if ((xGridIndex >= MAP_WIDTH)
                        || (yGridIndex >= MAP_HEIGHT)
                        || xGridIndex < 0 || yGridIndex < 0) {
                    distToVerticalGridBeingHit = Float.MAX_VALUE;
                    break;
                } else if ((fMap[yGridIndex * MAP_WIDTH + xGridIndex]) != O) {
                    distToVerticalGridBeingHit = (yIntersection - fPlayerY) * fISinTable[castArc];
                    break;
                } else {
                    yIntersection += distToNextYIntersection;
                    verticalGrid += distToNextVerticalGrid;
                }
            }
        }

        float scaleFactor;
        float dist;
        int topOfWall;
        int bottomOfWall;
        if (distToHorizontalGridBeingHit < distToVerticalGridBeingHit) {
            dist = distToHorizontalGridBeingHit;
            fOffscreenGraphics.setColor(Color.gray);
        } else {
            dist = distToVerticalGridBeingHit;
            fOffscreenGraphics.setColor(Color.darkGray);
        }
        dist /= fFishTable[castColumn];
        int projectedWallHeight = (int) (WALL_HEIGHT * (float) fPlayerDistanceToTheProjectionPlane / dist);
        bottomOfWall = fProjectionPlaneYCenter + (int) (projectedWallHeight * 0.5F);
        topOfWall = PROJECTIONPLANEHEIGHT - bottomOfWall;
        if (bottomOfWall >= PROJECTIONPLANEHEIGHT) {
            bottomOfWall = PROJECTIONPLANEHEIGHT - 1;
        }
        fOffscreenGraphics.fillRect(castColumn, topOfWall, 5, projectedWallHeight);
        castArc += 5;
        if (castArc >= ANGLE360) {
            castArc -= ANGLE360;
        }
    }
    paint(getGraphics());
}

public void paint(Graphics g) {

    if (fOffscreenImage!=null) g.drawImage(fOffscreenImage, 0, 0, this);
}

  public boolean keyDown(Event evt, int key)
  {
    switch (key)
    {
      case Event.ESCAPE:
        System.exit(0);
      case Event.UP:
        fKeyUp=true;
        break;
      case Event.DOWN:
        fKeyDown=true;
        break;
      case Event.LEFT:
        fKeyLeft=true;
        break;
      case Event.RIGHT:
        fKeyRight=true;
        break;
      default:
    }
    return true;
  }

  public boolean keyUp(Event evt, int key)
  {
    switch (key)
    {
      case Event.UP:
          fKeyUp=false;
          break;
      case Event.DOWN:
          fKeyDown=false;
          break;
      case Event.LEFT:
         fKeyLeft=false;
         break;
      case Event.RIGHT:
         fKeyRight=false;
         break;
      default:
    }
    return true;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T12:25:52.057

我没有仔细阅读所有代码，但是您发布的课程中有一些基本缺陷：

*   创建 的新实例`b`与创建空的`JPanel`. 当然，您什么也看不到，因为面板是空的。首先填充面板，然后添加它。
*   单独`Thread`填充`b`面板违反了 Swing 线程规则。您应该只访问/修改/...事件调度线程上的 Swing 组件。有关更多信息，请参阅[Swing 并发指南](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)
*   在 EDT 上有一个`Thread.sleep`会阻止你的 UI。永远不要那样做。如果您想要某种动画，请改用`javax.swing.Timer`该类。此类旨在定期更新您的 UI。
*   不要重写`paint`方法，而是重写`paintComponent`方法，不要忘记调用`super`

# java - Glassfish 3.1.2 和 Java EE + Hibernate 的性能非常低

> ID：12661103
> 
> 赞同：4
> 
> 时间：2012-09-30T12:01:49.510
> 
> 标签：java, performance, hibernate, jakarta-ee, glassfish

我在 Glassfish 3.1.2 上遇到了 Java EE（EJB + JSF）应用程序和 Hibernate（3.6.8.Final 和 4.1.7.Final）的性能非常低的问题。发送大约 300 个选择查询大约需要 20 秒。这是无法接受的。

我在 JBoss 和 TomEE 上部署了完全相同的应用程序。在那里，同样的 300 个选择查询大约需要 1.5 秒。

我在谷歌中找到了一些答案，可能`hibernate.show_sql`是`true`或者`hibernate.hbm2ddl`使应用程序太慢了。但事实并非如此。我关了`hibernate.show_sql`但没关系。此外，这些选项在 JBoss 和 TomEE 版本中都是正确的，并且运行速度快了 10 倍以上！我认为这是 Glasfish 和 Hibernate 之间的问题。但是我有下一个具有相同业务逻辑的应用程序，与 Hibernate 提供但配置了 Spring 的 EntityManager 相同的 DAO。而且性能很棒。这很奇怪，不是吗？

`persistence.xml`从缺陷版本：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.0"
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
  http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">

   <persistence-unit name="jee_project" transaction-type="JTA">
      <provider>org.hibernate.ejb.HibernatePersistence</provider>
      <jta-data-source>jdbc/PostgreSQL</jta-data-source>
      <properties>
         <property name="hibernate.dialect" value="org.hibernate.dialect.PostgreSQLDialect"/>
         <property name="hibernate.hbm2ddl.auto" value="update"/>
         <property name="hibernate.show_sql" value="false"/>
         <property name="current_session_context_class" value="thread"/>
      </properties>
   </persistence-unit>

</persistence> 
```

Glassfish JDBC 配置

```
<jdbc-connection-pool driver-classname="" datasource-classname="org.postgresql.ds.PGConnectionPoolDataSource" res-type="javax.sql.ConnectionPoolDataSource" description="" name="PostgreSQLPool">
      <property name="User" value="postgresql"></property>
      <property name="DatabaseName" value="qazxsw"></property>
      <property name="LogLevel" value="0"></property>
      <property name="Password" value="1234"></property>
      <property name="ServerName" value="localhost"></property>
      <property name="Ssl" value="false"></property>
      <property name="ProtocolVersion" value="0"></property>
      <property name="TcpKeepAlive" value="false"></property>
      <property name="SocketTimeout" value="0"></property>
      <property name="PortNumber" value="5432"></property>
      <property name="LoginTimeout" value="0"></property>
      <property name="UnknownLength" value="2147483647"></property>
      <property name="PrepareThreshold" value="5"></property>
    </jdbc-connection-pool>
    <jdbc-resource pool-name="PostgreSQLPool" description="" jndi-name="jdbc/PostgreSQL__pm"></jdbc-resource>
    <jdbc-resource pool-name="PostgreSQLPool" description="" jndi-name="jdbc/PostgreSQL__nontx"></jdbc-resource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T12:47:53.487

您的事务是否处于只读模式。当您的会话包含大量对象时，休眠可能会花费大量时间进行自动脏检查。也许您的事务在 tomcat/jboss 下处于只读模式，但在 glassfish 下没有

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T14:26:46.700

我找到了原因。答案隐藏在我上面粘贴的列表中。三个月前，我在 Glassfish 上部署了相同的应用程序。然后我第一次使用 Glassfish。我在一些博客上找到了如何设置数据源（在 localhost:4848）。假设我的数据源名为`jdbc/PostgreSQL`. 然后我得到 glassfish 找不到 datasource 的异常`jdbc/PostgreSQL__pm`。在互联网的某个地方，我发现`__pm`需要后缀的信息。下一个例外是关于 suffix`__nontx`的。更改名称后，应用程序启动。但也具有非常低的性能。

现在我添加了名为的数据源`jdbc/PostgreSQL`，它开始以良好的性能工作！数据源的名称怎么可能是错误的，尽管它正在（缓慢地）工作？

# facebook - ios6 facebook集成登录始终 FBSessionStateClosedLoginFailed 从不打开

> ID：12661104
> 
> 赞同：16
> 
> 时间：2012-09-30T12:02:02.010
> 
> 标签：facebook, ios6, facebook-ios-sdk

[这个问题与iOS 4.0 设备上的 Facebook SDK for iOS](https://stackoverflow.com/questions/11924651/facebook-sdk-for-ios-on-ios-4-0-device)非常相似，但由于我无法在那里发表评论，因此我提出了一个新问题。我认为问题不一样：

当尝试将我的应用程序的 facebook 集成更新到 facebook 3.1 时，我没有让 facebook 会话打开 sessionStateChanged 回调总是以 FBSessionStateClosedLoginFailed 结束。在我的设置中，我的 appdelegate 中有回调

```
- (BOOL)application:(UIApplication *)application 
            openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication
         annotation:(id)annotation {
    // attempt to extract a token from the url
    //    return [self.session handleOpenURL:url]; 
    return [FBSession.activeSession handleOpenURL:url];
} 
```

但它永远不会被调用！它不应该被调用吗？我遵循了 facebook 文档并致电

```
- (BOOL)openSessionWithAllowLoginUI:(BOOL)allowLoginUI {
    NSArray *permissions = [NSArray arrayWithObjects:@"publish_actions", nil];
    return [FBSession openActiveSessionWithPublishPermissions:permissions
                                              defaultAudience:FBSessionDefaultAudienceFriends
                                              allowLoginUI:allowLoginUI
                                         completionHandler:^(FBSession *session,
                                                             FBSessionState state,
                                                             NSError *error) {
                                             [self sessionStateChanged:session
                                                                 state:state
                                                                 error:error];
                                         }];
} 
```

我也试过

`openActiveSessionWithReadPermissions`使用`nil`facebook 教程示例中的权限，以便稍后重新授权 publish_actions 权限。同样的结果： FBSessionStateClosedLoginFailed 再次。

我什至试着打电话

```
ACAccountStore *accountStore;
    ACAccountType *accountTypeFB;
    if ((accountStore = [[ACAccountStore alloc] init]) &&
        (accountTypeFB = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook] ) ){

        NSArray *fbAccounts = [accountStore accountsWithAccountType:accountTypeFB];
        id account;
        if (fbAccounts && [fbAccounts count] > 0 &&
            (account = [fbAccounts objectAtIndex:0])){

            [accountStore renewCredentialsForAccount:account completion:^(ACAccountCredentialRenewResult renewResult, NSError *error) {
                //we don't actually need to inspect renewResult or error.
                if (error){

                }
            }];
        }
    } 
```

在尝试打开会话之前，但我从来没有在我的 ios6 设备（iphone 4s）上打开它。在应用程序中，我被要求获得许可，但由于会话始终处于 FBSessionStateClosedLoginFailed 状态，因此什么也没有发生！我对会话状态的回调是

```
- (void)sessionStateChanged:(FBSession *)session
                      state:(FBSessionState) state
                      error:(NSError *)error
{
    switch (state) {
        case FBSessionStateOpen:
            if (!error) {
                // We have a valid session
                NSLog(@"User session found");
            }
            break;
        case FBSessionStateClosed:
            NSLog(@"FBSessionStateClosed");
        case FBSessionStateClosedLoginFailed:
            NSLog(@"FBSessionStateClosedLoginFailed");
            [FBSession.activeSession closeAndClearTokenInformation];
            break;
        default:
            break;
    }

    [[NSNotificationCenter defaultCenter]
     postNotificationName:FBSessionStateChangedNotification
     object:session];

    if (error) {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"facebook Hinweis"
                                                        message:@"facebook Login nicht möglich, bitte versuchen Sie es erneut."
                                                       delegate:nil
                                              cancelButtonTitle:@"OK"
                                              otherButtonTitles:nil];
        [alert show];
        NSLog(@"Facebook session error: %@", error.localizedDescription);
    }
} 
```

在 ios 5 上使用 facebook 3.0 我从来没有遇到过问题，所以我的 facebook 应用程序设置正确。我真的很感激任何帮助让我能够打开 facebook 会话，没想到会遇到 facebook 3.1 的这些问题，而且文档在这一点上没有帮助我，谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-12-30T22:43:07.537

我有同样的问题，这是因为我忘了实施

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url
{
    return [FBSession.activeSession handleOpenURL:url];
} 
```

在我的 AppDelegate

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-03-19T19:19:29.180

虽然 JohnG 的回答是正确的，但该特定委托方法现在已被[弃用](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40006786-CH3-SW15)。要使用的正确委托方法[是这样的](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UIApplicationDelegate/application%3aopenURL%3asourceApplication%3aannotation%3a)：

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation
{
    return [FBSession.activeSession handleOpenURL:url];
} 
```

将它放在我的应用程序委托中为我解决了这个问题。如果没有这个，iOS 6.0 的本机登录会起作用，但 Facebook 应用登录会失败。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-23T09:05:36.930

我有同样的问题。如果用户没有在系统偏好设置中配置 Facebook 帐户，则会出现 Facebook 登录对话框，并且一切正常。但是，如果用户在设备中配置了一个帐户，我总是会`FBSessionStateClosedLoginFailed`出错。

这无关，`handleOpenURL:url`因为在 iOS 6 或更高版本的“本机登录流程”中没有快速应用程序更改。因此，您的应用永远不会进入后台，并且不需要 URL 重定向。

问题已解决配置 Facebook 应用程序。您需要启用“本机 iOS 登录”部分并输入您的应用程序的捆绑 ID。如果您的应用程序尚未在 Apple Store 中，恐怕您需要将沙盒模式设置为 ON。一旦您的应用程序在 Apple Store 中发布，我认为您需要将沙盒模式设置为 OFF 并在 Facebook 配置中设置 Apple Store ID。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-01T20:34:42.653

即使我不能发表评论，所以把它写成答案。我不确定，让我分析一下潜在的原因 1）你说：“但它永远不会被调用！它不应该被调用吗？” - 为了

```
- (BOOL)application:(UIApplication *)application 
        openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication
     annotation:(id)annotation 
```

要被调用，在 info.plist 文件中，应正确设置 url 方案，即转到 URL 类型-->Item0-->URL 方案--->Item 0，此处的值应为 fbAPPID，即 fb 附加您的实际 facebookappID [FacebookAppID 也可能存在于 info.plist 中或硬编码在代码中]。

2）你说：“sessionStateChanged 回调总是以 FBSessionStateClosedLoginFailed 结束”

在 sessionStateChanged 开关方法中检查会话的状态，如果它创建或 createdTokenLoaded 然后尝试打开会话。

注意：[FBSession openActiveSessionWithPublishPermissions ....] 这是一个静态方法将创建一个新会话并设置为 FBSession.activeSession 其中 openWithCompletionHandler 是一个实例方法，只有在会话已经创建时才能工作。

```
 case FBSessionStateCreated:
    case FBSessionStateCreatedTokenLoaded:{
        [session openWithCompletionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
            //handle the updating of views according to the sate of session 
        }];
        break; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-03T18:32:51.380

在 FB SDK 3.5 上，您可以使用以下命令终止令牌：

```
 [[FBSessionTokenCachingStrategy defaultInstance] clearToken]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-19T00:18:43.670

我同意 JohnG 的观点，另外需要注意的是：

请注意，如果您在 内有多个案例`handleOpenURL:`，您可以过滤：

```
if ([sourceApplication isEqualToString:@"com.facebook.facebook"] ||
    [sourceApplication isEqualToString:@"com.facebook.Facebook"]){
  //Do Stuff
} 
```

这很奇怪，但我能够在多个设备上复制`sourceApplication`以“Facebook”和“facebook”的形式回归。

# asp.net - 页面不加载 asp.net 3.5 中的母版页

> ID：12661105
> 
> 赞同：0
> 
> 时间：2012-09-30T12:02:12.130
> 
> 标签：asp.net

我刚从 asp.net 开始，并按照有关如何制作母版页的教程[http://www.asp.net/web-forms/videos/](http://www.asp.net/web-forms/videos/building-35-applications/masterpages)进行操作。但是按照教程我仍然无法使其工作。我什至使用了视频中使用的相同模板。

我拥有的代码是通过 Visual Studio 的向导自动生成的。

更具体地说：我没有收到任何错误消息，只是一个带有 css 的普通页面，该页面来自我在教程中使用的模板。带有菜单的 div 和其余部分不显示在屏幕上。（应该首先写这个）

从母版页：

 ````
<asp:ContentPlaceHolder ID="MenuContentPlaceHolder" runat="server">
    <div id="header">
            <p> <a href="#">Link 1</a> . <a href="#">Link 2</a> . <a href="#">Link 3</a> . <a href="#">Link 4</a></p>
        </div>

        <div id="subheader">
                <p>Apple Core 1.0</p>
        </div>

        <div id="menu">
                <p><a href="#">Menu 1</a> <a href="#">Menu 2</a> <a href="#">Menu 3</a> <a href="#">Menu 4</a> <a href="#">Menu 5</a> <a href="#">Menu 6 </a></p>
        </div>
    </asp:ContentPlaceHolder> 
````  `从 default.aspx

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site1.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication2.Default" %>
<asp:Content ID="Content2" ContentPlaceHolderID="MenuContentPlaceHolder" runat="server">
    <br />
<h1>Hey</h1>
</asp:Content> 
```

奇怪的是，当我从 default.aspx 中完全删除内容标签时，我似乎能够让菜单显示在屏幕上

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:35:54.337

我认为你应该尝试这样的事情

## 您的母版页

```
<div id="header">
    <p> <a href="#">Link 1</a> . <a href="#">Link 2</a> . <a href="#">Link 3</a> . <a href="#">Link 4</a></p>
</div>

<div id="subheader">
    <p>Apple Core 1.0</p>
</div>

<div id="menu">
    <p><a href="#">Menu 1</a> <a href="#">Menu 2</a> <a href="#">Menu 3</a> <a href="#">Menu 4</a> <a href="#">Menu 5</a> <a href="#">Menu 6     </a></p>
</div>

<asp:ContentPlaceHolder ID="MenuContentPlaceHolder" runat="server">

</asp:ContentPlaceHolder> 
```

**将菜单代码放在母版页内容占位符之外

## 你的 aspx 页面

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site1.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs"     Inherits="WebApplication2.Default" %>
<asp:Content ID="Content2" ContentPlaceHolderID="MenuContentPlaceHolder" runat="server">
    <br />
<h1>Hey</h1>
</asp:Content> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:31:13.703

我相信您正在做的是通过将 HTML 放入MasterPage*和*ContentPage的标签中来*覆盖MasterPage 内容。*这实际上是 MasterPage 概念的一个特征。如果您想要页面上的标准内容，但希望能够在某些页面上替换它，那么您将内容放在 PlaceHolder 中，并在应该有不同内容的页面上提供替换内容。（或者，您可以将其视为“如果 ContentPage 中未提供任何内容，则使用此默认内容。”）`PlaceHolder`

 *您对在删除内容标签时显示菜单的评论是因为您已删除用于替换 MasterPage 内容的自定义标签。如果在使用给定 MasterPage 的*每个页面上都有一些您**始终*想要的内容，请将内容放在 MasterPage 中，而不是 PlaceHolder 中。*`

# mysql - 从子表中选择多行数据以及MySQL中的父行表

> ID：12661107
> 
> 赞同：2
> 
> 时间：2012-09-30T12:02:27.050
> 
> 标签：mysql, sql, group-concat

我的数据库中有两个表，大致如下所示

客户

```
id |  other data
1  |  data 1
2  |  data 2
3  |  data 3
4  |  data 4 
```

分配的员工

```
id  | clientid | employee
1   | 1        | Fred
2   | 1        | Jim
3   | 3        | Peter
4   | 4        | Fred
5   | 4        | Peter
6   | 4        | James 
```

有没有办法从员工表中返回包含所有员工记录的客户表？理想情况下，我想要行的 id 和员工姓名，所以我认为我不能使用 GROUP_CONCAT 来收集多于一列。也不能保证员工表中的每个客户总是有一个条目，因此它需要为这些客户返回空/空结果。

到目前为止，我已经尝试了两种在 php 中实现这一点的方法，两种方法都非常低效。

(A) 第一个是在第一个连接的中途有效地建立一个新的数据库连接，以返回与该客户端 ID 关联的员工列表，但显然这会导致仅针对一个查询建立大量数据库连接。

(B) 第二个是在代码开头将整个员工表拉入一个数组，并在该数组中搜索以提取与该客户 ID 相关的行，然后将员工姓名和行 ID 放入其中。随着时间的推移，这最终会立即将一个相当大的数组转储到 php 中。

有没有办法只使用一个 SQL 查询来解决这个问题？我并不是那么在意数据是如何出来的，因为我确信我可以在另一端的 php 中对其进行排序，但可能类似于以下内容

结果

```
id |  other data | employees
1  |  data 1     | 1,Fred;2,Jim
2  |  data 2     | 
3  |  data 3     | 3,Peter
4  |  data 4     | 4,Fred;5,Peter;6,James 
```

如果在某个地方之前有人问过这个问题，我会道歉，但上周我一直在搜索，但没有找到太多帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T12:16:24.890

```
SELECT e.*, c.other_data FROM Employee e
INNER JOIN Client c ON e.client_id = c.id 
```

因此，您最终得到的是在一个查询中获取的两个表中的所有信息。因此，数据将是：

```
 id        client_id    Employee    other_data
     1             1          Fred        data 1
     2             1          Jim         data 1
     3             3          Peter       data 3
     4             4          Fred        data 4
     5             4          Peter       data 4
     6             4          James       data 4 
```

# emacs - Emacs，十六进制编辑器并确定文本文件为 DOS 格式

> ID：12661108
> 
> 赞同：2
> 
> 时间：2012-09-30T12:02:30.260
> 
> 标签：emacs, hex-editors

这是我的问题的简化版本：我有两个文本文件，不同的数据，但第一行相同，由同一个程序生成，尽管可能在不同的操作系统上。当 emacs 读取其中一个时，它说它是 DOS 格式，而在读取另一个时却不是。

我使用了几个 Hex 编辑器（Kubuntu 上的 Bless、GHex、OKTeta），在所有这些编辑器上我看到了相同的东西，即每行都以两个文件的序列 OD OA (CR LF) 结尾，包括最后一行。

所以我的问题是：emacs 如何确定什么是 DOS 文件，什么不是，文件中是否还有 Hex 编辑器不会显示或添加的其他内容？

这两个文件在不同的目录中具有相同的名称。我也遇到了这个问题，因为我有解析字符串的 C++ 代码，并且在 emacs 列为 DOS 的文件上失败了，所以问题实际上出在文件内容上。

最后一点：你会注意到没有 C/C++ 标签。我不是在寻找关于如何修改我的 C++ 代码来处理这种情况的建议。我知道该怎么做。

谢谢你的帮助

一个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T02:09:51.377

Emacs 通过在读取文件时将 CRLF 转换为 LF，然后在写出文件时将 LF 转换回 CRLF 来处理 DOS 文件。因此，如果文件中有一个单独的 LF，即使缓冲区没有被修改，读写最终也会添加一个 CR。由于这个原因，如果文件中间隐藏着这样一个单独的 LF，Emacs 将不会将该文件作为 DOS 而是作为 UNIX 文件来处理。

# rest - Apache 无法向 localhost:8080 发送请求（使用 Mule Esb Flow）

> ID：12661110
> 
> 赞同：1
> 
> 时间：2012-09-30T12:03:13.113
> 
> 标签：rest, esb, mule

我正在尝试使用使用 Ajax 向 php REST 服务发送请求的示例 Web 应用程序。

我需要使用 Mule ESB 来执行此操作，因此我修复了我的 ajax 函数以向 localhost:8080 上的 ESB 发送请求。但是浏览器说出于安全原因我不能这样做。

那么，有什么方法可以在本地将 mule ESB 与 Web 应用程序（本地应用程序服务器）一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:19:43.473

尝试从同一主机但从不同端口获取资源被视为跨脚本，如此[处所述](https://stackoverflow.com/questions/4669494/xmlhttprequest-cross-site-scripting-on-same-server-but-differnt-port)

如果你想找回它，你可以：

1.  上面链接中列出的所有选项
2.  将 mule 放在 apache 配置中的反向代理后面
3.  通过 mule 提供所有内容

# javascript - jQuery - 如何知道窗口是否正在调整宽度/高度或两者？

> ID：12661111
> 
> 赞同：8
> 
> 时间：2012-09-30T12:03:15.890
> 
> 标签：javascript, jquery, resize, window

[我对使用 jQuery 的函数.resize()](http://api.jquery.com/resize/)调整窗口大小有一点问题。我想知道哪个尺寸变大/变小 - 宽度或高度。我需要这个，因为如果我只设置两个条件 - 如果宽度比 div 大 50px，如果高度比 div 大 50px，

```
// (pseudocode)
if width = div.width + 50px
   width = something
if height = div.height + 50px
   height = something 
```

然后只在一种条件下工作，我只能调整宽度或高度。

我怎么知道哪个维度的大小正在变化，或者两者都在变化？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-30T12:06:17.857

通过将最后一个窗口大小值保存在变量中。

```
var h = $(window).height(), w = $(window).width();
$(window).resize(function(){

    var nh = $(window).height(), nw = $(window).width();
     // compare the corresponding variables.
    h = nh; w = nw; // update h and w;
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T12:07:13.533

每次更改大小时，保存以前的大小并与之比较。

例如：

```
var prevW = -1, prevH = -1;

$(document).ready(function() {

    // ... other stuff you might have inside .ready()

    prevW = $(window).width();
    prevH = $(window).height();
});

$(window).resize(function() {
    var widthChanged = false, heightChanged = false;
    if($(window).width() != prevW) {
        widthChanged  = true;
    }
    if($(window).height() != prevH) {
        heightChanged = true;
    }

    // your stuff

    prevW = $(window).width();
    prevH = $(window).height();

}); 
```

**演示：http:** [//jsfiddle.net/44aNW/](http://jsfiddle.net/44aNW/)

# java - 在调试模式下运行时如何修改 Java 代码？

> ID：12661114
> 
> 赞同：19
> 
> 时间：2012-09-30T12:03:48.500
> 
> 标签：java, eclipse, debugging

如何启用这个“运行时调试”Notch在 Eclipse的[这个视频中谈到的？](http://www.youtube.com/watch?v=BES9EKK4Aw4&feature=player_detailpage#t=32s)

作为测试，我希望能够编辑以下代码的输出，并在其运行时将其更改为“Hello Runtime Debugging”。

```
public class HelloWorld {
    public static void main(String[] args) throws InterruptedException {
        doIt();     
    }

    private static void doIt() throws InterruptedException {
        for (int i = 0; i < 1000; ++i) {
            System.out.println("Hello World " + i);
            Thread.currentThread().sleep(100);
        }
    }
} 
```

* * *

**编辑：**我修改了代码，现在我得到了我正在寻找的结果。Suraj Chandran 下面的回答对此进行了解释。

```
private static void doIt() throws InterruptedException {
    for (int i = 0; i < 1000; ++i) {
        print(i);
        Thread.currentThread().sleep(100);
    }
}

private static void print(int i) {
    System.out.println("Hello Sir " + i);
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-30T12:13:08.177

Eclipse 在调试期间支持热交换代码，开箱即用。

调试时，只要修改任意代码并保存，Eclipse 会自动将修改后的代码传输到目标虚拟机中。

请注意，您不能对代码进行结构更改，例如添加新方法、更改方法签名或添加新字段。但是您可以在方法中更改代码。

编辑：请注意，在调试期间更改代码将使该方法从头开始重新执行，重置该方法中的局部变量。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-09-17T06:24:25.507

您需要确保选中*Project > Build Automatically 。*否则可能无法正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-18T02:50:35.250

启用 Project-> Build Automatically 后，调试模式下的热交换代码对我来说没问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T12:09:49.460

我可能误解了这个问题，但是如果您在 Eclipse 中以调试模式（运行/调试）运行程序，您可以在程序运行期间编辑方法的内容（如果 JVM 支持的话）。通常，您不能更改导入、方法签名、类定义等，只能更改方法的内容。

# windows-8 - Windows 8 Javascript 将 html 读入 data.js

> ID：12661115
> 
> 赞同：0
> 
> 时间：2012-09-30T12:03:50.763
> 
> 标签：windows-8

我正在使用示例网格 javascript 模板来构建一个 win8 应用程序。

我也在使用 data.js 文件来加载数据。然而，这使用：

`var content = "test content";`

 ````
var sampleItems = [
{group: sampleGroups[0], title: "Title", description: "DESC", content: content}, 
````  `但是，我的内容文本越来越长，我还想输入 html 语法，如 IMG 和 P 等。

将本地 html 文件加载到上面的内容变量中的最简单方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:47:57.947

要读取应用程序本地存储中的 HTML 文件，您将使用 WinJS.Application.local 对象的 readText 方法。

```
var loc = WinJS.Application.local;
loc.readText("fileName", "failed").done( /* Your success and error handlers */ ); 
```

要读取存储在应用程序包中的文件，您将执行类似这样的操作：

```
var myText;

var url = new Windows.Foundation.Uri("ms-appx:///html/filename.html"); 
Windows.Storage.StorageFile.getFileFromApplicationUriAsync(url).then(function (file) { 
    Windows.Storage.FileIO.readTextAsync(file).then(function (text) { 
        myText=text;
    }); 
}); 
````

# facebook - 来自我自己的粉丝页面的 Facebook 状态更新

> ID：12661117
> 
> 赞同：0
> 
> 时间：2012-09-30T12:04:07.470
> 
> 标签：facebook, facebook-php-sdk, facebook-fql

我正在尝试检索我自己的 Facebook 帖子以显示在我的网站上。查看 SDK 文档，我在任何地方都找不到它，也没有 FQL 查询。我只能找到如何获取登录的用户状态。

有没有办法做我需要的？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:11:35.207

您需要通过身份验证才能访问`feed`API 对象或`stream`FQL 表。两者都返回您的 Facebook 帖子。

最简单的方法是创建一个应用程序，并使用您的应用程序 ID 进行身份验证，然后进行此 API 调用：

```
$result = $facebook->api('/USER_ID_OR_USERNAME/feed', 'GET'); 
```

您将仅限于公开更新。如果您想要更详细的更新，您将需要对您希望获取其流的人进行身份验证，获取长期访问令牌并将其存储在您的数据库中。

# android - Android twitter4j 上传图片

> ID：12661118
> 
> 赞同：10
> 
> 时间：2012-09-30T12:04:19.750
> 
> 标签：android, twitter4j, multipartform-data

我有一个 android 应用程序，通过它我可以成功更新 Twitter 状态。我正在使用它来共享指向显示图像的网页的链接。我认为像 instagram 一样，将图像的缩小预览与推文一起进行会很好。如何将这张图片与我的推文一起上传？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-05T06:07:00.097

我有时也有同样的要求，最后附带了这个功能，它可能也会对你有所帮助。

```
/**
 * To upload a picture with some piece of text.
 * 
 * 
 * @param file The file which we want to share with our tweet
 * @param message Message to display with picture
 * @param twitter Instance of authorized Twitter class
 * @throws Exception exception if any
 */

public void uploadPic(File file, String message,Twitter twitter) throws Exception  {
    try{
        StatusUpdate status = new StatusUpdate(message);
        status.setMedia(file);
        twitter.updateStatus(status);}
    catch(TwitterException e){
        Log.d("TAG", "Pic Upload error" + e.getErrorMessage());
        throw e;
    }
} 
```

**注意：**要使用它，请确保您有最新的 jar 文件，我为此使用了twitter4j [-core-2.2.5.jar](http://repo1.maven.org/maven2/org/twitter4j/twitter4j-core/2.2.5/twitter4j-core-2.2.5.jar)

# wcf - XML 配置 IRepository . MSDN错了吗？

> ID：12661122
> 
> 赞同：0
> 
> 时间：2012-09-30T12:05:07.253
> 
> 标签：wcf, unity-container

我正在尝试为通用类型存储库接口实现构造函数注入。我通过应用[http://msdn.microsoft.com/en-us/library/ff660933(v=pandp.20).aspx](http://msdn.microsoft.com/en-us/library/ff660933(v=pandp.20).aspx)文档来做到这一点。然而，xml 编辑器不接受方括号，例如：

```
 <alias alias="IGenericRepository"
       type="Design.DataModel.Interfaces.IGenericRepository'1    [[Design.DataModel.Entities.GaugeModel, Design.DataModel]], Design.DataModel"/> 
```

xml 编辑器给出以下错误：“意外的文本”。完整的 xml 部分是：

```
<unity xmlns="http://schemas.microsoft.com/practices/2010/unity">
<sectionExtension prefix="" type="Microsoft.Practices.Unity.InterceptionExtension.Configuration.InterceptionConfigurationExtension, Microsoft.Practices.Unity.Interception.Configuration" />

<alias alias="IGenericRepository" type="Design.DataModel.Interfaces.IGenericRepository'1[[Design.DataModel.Entities.GaugeModel, Design.DataModel]], Design.DataModel"/>
<alias alias="GenericSqlRepository" type="Design.DataAccess.GenericSqlRepository'1[[Design.DataModel.Entities.GaugeModel, Design.DataModel]], Design.DataAccess"/>
<alias alias="IGaugeModelbaseService" type="Design.Contracts.IGaugeModelbaseService, Design.Contracts"/>
<alias alias="GaugeModelbaseService" type="Design.ContractImplememtations.GaugeModelbaseService, Design.ContractImplementations"/>
<alias alias="IContractMapper" type="Design.ContractImplementations.IContractMapper, Design.ContractImplementations"/>
<alias alias="ContractMapper" type="Design.ContractImplementations.ContractMapper"/>
 <container>
  <register type="IGaugeModelbaseService" mapTo="GaugeModelbaseService"> 
    <interceptor type="InterfaceInterceptor" />
  </register>
  <register type="IContractMapper" mapTo="ContractMapper"> 
    <lifetime type="hierarchical" />
  </register>
  <register type="IGenericRepository" mapTo="GenericSqlRepository">
    <lifetime type="hierarchical" />
  </register>
</container> 
```

然而，浏览 svc 结果会导致错误：“无法解析类型名称或别名 GaugeModelbaseService”

xml 必须等同于以下 fluent API 配置（工作正常）：

```
public class WcfServiceFactory : UnityServiceHostFactory
{
    #region Methods

    protected override void ConfigureContainer(IUnityContainer container)
    {
        //container.LoadConfiguration();
        container.AddNewExtension<EnterpriseLibraryCoreExtension>();
        container.AddNewExtension<Interception>();
        container.RegisterType<IGaugeModelbaseService, GaugeModelbaseService>(
            new InterceptionBehavior<PolicyInjectionBehavior>(), new Interceptor<TransparentProxyInterceptor>());
        container.RegisterType<IContractMapper, ContractMapper>(new HierarchicalLifetimeManager());
        container.RegisterType<IGenericRepository<GaugeModel>, GenericSqlRepository<GaugeModel>>(
            new HierarchicalLifetimeManager());
    }

    #endregion
} 
```

我错过了 xml 配置中的某些内容吗？请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T17:50:08.837

这是从您的配置文件直接复制/粘贴吗？如果是这样，问题是一个错字：

```
<alias alias="GaugeModelbaseService" type="Design.ContractImplememtations.GaugeModelbaseService, Design.ContractImplementations"/> 
```

注意：“实现”

否则，您的语法看起来是正确的。

# html - 如何在 html 区域标签上应用悬停？

> ID：12661124
> 
> 赞同：44
> 
> 时间：2012-09-30T12:05:16.963
> 
> 标签：html, css, tags, anchor

我正在尝试将 HTML 的区域标签悬停。我在 CSS 中试过这个：

```
area:hover
{
    border:1px solid black;
} 
```

这是应该应用它的 HTML。

```
<!-- This imagemap inserted by Gwyn's Imagemap Selector http://gwynethllewelyn.net/gwyns-imagemap-selector/ -->
<img src='http://dailyaeen.com.pk/epaper/wp-content/uploads/2012/09/27+Sep+2012-1.jpg?1349003469874' usemap='#imgmap_css_container_imgmap201293016112' class='imgmap_css_container' title='imgmap201293016112' alt='imgmap201293016112' id='img-imgmap201293016112' />
<map id='imgmap201293016112' name='imgmap_css_container_imgmap201293016112'>
    <area shape="poly" coords="2,0,604,-3,611,-3,611,166,346,165,345,130,-2,130,-2,124,1,128,1,126" href="" alt="imgmap201293016112-0" title="imgmap201293016112-0" class="imgmap201293016112-area" id="imgmap201293016112-area-0" />
    <area shape="rect" coords="1,131,341,213" href="" alt="imgmap201293016112-1" title="imgmap201293016112-1" class="imgmap201293016112-area" id="imgmap201293016112-area-1" />
    <area shape="rect" coords="346,166,614,241" href="" alt="imgmap201293016112-2" title="imgmap201293016112-2" class="imgmap201293016112-area" id="imgmap201293016112-area-2" />
    <area shape="poly" coords="917,242,344,239,345,496,574,495,575,435,917,433" href="" alt="imgmap201293016112-3" title="imgmap201293016112-3" class="imgmap201293016112-area" id="imgmap201293016112-area-3" />
    <area shape="rect" coords="1,416,341,494" href="" alt="imgmap201293016112-4" title="imgmap201293016112-4" class="imgmap201293016112-area" id="imgmap201293016112-area-4" />
    <area shape="rect" coords="1,215,341,410" href="" alt="imgmap201293016112-5" title="imgmap201293016112-5" class="imgmap201293016112-area" id="imgmap201293016112-area-5" />
    <area shape="poly" coords="916,533,916,436,578,436,576,495,806,496,807,535" href="" alt="imgmap201293016112-6" title="imgmap201293016112-6" class="imgmap201293016112-area" id="imgmap201293016112-area-6" />
    <area shape="rect" coords="805,536,918,614" href="" alt="imgmap201293016112-7" title="imgmap201293016112-7" class="imgmap201293016112-area" id="imgmap201293016112-area-7" />
    <area shape="rect" coords="461,494,803,616" href="" alt="imgmap201293016112-8" title="imgmap201293016112-8" class="imgmap201293016112-area" id="imgmap201293016112-area-8" />
    <area shape="rect" coords="0,497,223,616" href="" alt="imgmap201293016112-9" title="imgmap201293016112-9" class="imgmap201293016112-area" id="imgmap201293016112-area-9" />
    <area shape="rect" coords="230,494,456,614" href="" alt="imgmap201293016112-10" title="imgmap201293016112-10" class="imgmap201293016112-area" id="imgmap201293016112-area-10" />
    <area shape="rect" coords="345,935,572,1082" href="" alt="imgmap201293016112-11" title="imgmap201293016112-11" class="imgmap201293016112-area" id="imgmap201293016112-area-11" />
    <area shape="rect" coords="1,617,457,760" href="" alt="imgmap201293016112-12" title="imgmap201293016112-12" class="imgmap201293016112-area" id="imgmap201293016112-area-12" />
    <area shape="rect" coords="345,760,577,847" href="" alt="imgmap201293016112-13" title="imgmap201293016112-13" class="imgmap201293016112-area" id="imgmap201293016112-area-13" />
    <area shape="rect" coords="0,759,344,906" href="" alt="imgmap201293016112-14" title="imgmap201293016112-14" class="imgmap201293016112-area" id="imgmap201293016112-area-14" />
    <area shape="rect" coords="346,850,571,935" href="" alt="imgmap201293016112-15" title="imgmap201293016112-15" class="imgmap201293016112-area" id="imgmap201293016112-area-15" />
    <area shape="rect" coords="578,761,915,865" href="" alt="imgmap201293016112-16" title="imgmap201293016112-16" class="imgmap201293016112-area" id="imgmap201293016112-area-16" />
    <area shape="rect" coords="0,1017,226,1085" href="" alt="imgmap201293016112-17" title="imgmap201293016112-17" class="imgmap201293016112-area" id="imgmap201293016112-area-17" />
    <area shape="rect" coords="0,908,342,1017" href="" alt="imgmap201293016112-18" title="imgmap201293016112-18" class="imgmap201293016112-area" id="imgmap201293016112-area-18" />
    <area shape="rect" coords="229,1010,342,1084" href="" alt="imgmap201293016112-19" title="imgmap201293016112-19" class="imgmap201293016112-area" id="imgmap201293016112-area-19" />
    <area shape="rect" coords="0,1086,340,1206" href="" alt="imgmap201293016112-20" title="imgmap201293016112-20" class="imgmap201293016112-area" id="imgmap201293016112-area-20" />
    <area shape="rect" coords="0,1209,224,1290" href="" alt="imgmap201293016112-21" title="imgmap201293016112-21" class="imgmap201293016112-area" id="imgmap201293016112-area-21" />
    <area shape="rect" coords="0,1290,225,1432" href="" alt="imgmap201293016112-22" title="imgmap201293016112-22" class="imgmap201293016112-area" id="imgmap201293016112-area-22" />
    <area shape="rect" coords="0,1432,340,1517" href="" alt="imgmap201293016112-23" title="imgmap201293016112-23" class="imgmap201293016112-area" id="imgmap201293016112-area-23" />
    <area shape="rect" coords="346,1432,686,1517" href="" alt="imgmap201293016112-24" title="imgmap201293016112-24" class="imgmap201293016112-area" id="imgmap201293016112-area-24" />
    <area shape="rect" coords="461,1266,686,1429" href="" alt="imgmap201293016112-25" title="imgmap201293016112-25" class="imgmap201293016112-area" id="imgmap201293016112-area-25" />
    <area shape="rect" coords="230,1365,455,1430" href="" alt="imgmap201293016112-26" title="imgmap201293016112-26" class="imgmap201293016112-area" id="imgmap201293016112-area-26" />
    <area shape="rect" coords="231,1291,457,1360" href="" alt="imgmap201293016112-27" title="imgmap201293016112-27" class="imgmap201293016112-area" id="imgmap201293016112-area-27" />
    <area shape="rect" coords="230,1210,342,1289" href="" alt="imgmap201293016112-28" title="imgmap201293016112-28" class="imgmap201293016112-area" id="imgmap201293016112-area-28" />
    <area shape="rect" coords="692,928,916,1016" href="" alt="imgmap201293016112-29" title="imgmap201293016112-29" class="imgmap201293016112-area" id="imgmap201293016112-area-29" />
    <area shape="rect" coords="460,616,916,759" href="" alt="imgmap201293016112-30" title="imgmap201293016112-30" class="imgmap201293016112-area" id="imgmap201293016112-area-30" />
    <area shape="rect" coords="693,1316,917,1518" href="" alt="imgmap201293016112-31" title="imgmap201293016112-31" class="imgmap201293016112-area" id="imgmap201293016112-area-31" />
    <area shape="rect" coords="344,1150,572,1219" href="" alt="imgmap201293016112-32" title="imgmap201293016112-32" class="imgmap201293016112-area" id="imgmap201293016112-area-32" />
    <area shape="rect" coords="693,1015,916,1171" href="" alt="imgmap201293016112-33" title="imgmap201293016112-33" class="imgmap201293016112-area" id="imgmap201293016112-area-33" />
    <area shape="rect" coords="577,955,686,1032" href="" alt="imgmap201293016112-34" title="imgmap201293016112-34" class="imgmap201293016112-area" id="imgmap201293016112-area-34" />
    <area shape="rect" coords="577,1036,687,1101" href="" alt="imgmap201293016112-35" title="imgmap201293016112-35" class="imgmap201293016112-area" id="imgmap201293016112-area-35" />
    <area shape="rect" coords="576,1104,689,1172" href="" alt="imgmap201293016112-36" title="imgmap201293016112-36" class="imgmap201293016112-area" id="imgmap201293016112-area-36" />
    <area shape="rect" coords="691,1232,918,1313" href="" alt="imgmap201293016112-37" title="imgmap201293016112-37" class="imgmap201293016112-area" id="imgmap201293016112-area-37" />
    <area shape="rect" coords="341,1085,573,1151" href="" alt="imgmap201293016112-38" title="imgmap201293016112-38" class="imgmap201293016112-area" id="imgmap201293016112-area-38" />
    <area shape="poly" coords="917,868,917,925,688,927,688,955,576,955,574,867,572,864" href="" alt="imgmap201293016112-39" title="imgmap201293016112-39" class="imgmap201293016112-area" id="imgmap201293016112-area-39" />
    <area shape="poly" coords="919,1173,917,1231,688,1231,688,1266,574,1267,576,1175,576,1175" href="" alt="imgmap201293016112-40" title="imgmap201293016112-40" class="imgmap201293016112-area" id="imgmap201293016112-area-40" />
    <area shape="poly" coords="572,1222,572,1265,459,1265,458,1289,339,1290,344,1225" href="" alt="imgmap201293016112-41" title="imgmap201293016112-41" class="imgmap201293016112-area" id="imgmap201293016112-area-41" />
</map> 
```

那么当我悬停该区域时，它的边框颜色怎么可能变成黑色甚至红色呢？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-10-01T05:03:11.367

我所做的是创建一个画布元素，然后将其放置在图像映射的前面。然后，每当一个区域被鼠标悬停时，我都会调用一个函数来获取该形状和形状类型的坐标字符串。如果它是多边形，我使用坐标在画布上绘制轮廓。如果是矩形，我会画一个矩形轮廓。您可以轻松添加代码来处理圆圈。

在填充多边形/矩形/圆形之前，您还可以将画布的不透明度设置为小于 100%。您还可以更改画布上下文对全局的依赖 - 这意味着您可以在同一页面上处理超过 1 个图像映射。

```
<!DOCTYPE html>
<html>
<head>
<script>

// stores the device context of the canvas we use to draw the outlines
// initialized in myInit, used in myHover and myLeave
var hdc;

// shorthand func
function byId(e){return document.getElementById(e);}

// takes a string that contains coords eg - "227,307,261,309, 339,354, 328,371, 240,331"
// draws a line from each co-ord pair to the next - assumes starting point needs to be repeated as ending point.
function drawPoly(coOrdStr)
{
    var mCoords = coOrdStr.split(',');
    var i, n;
    n = mCoords.length;

    hdc.beginPath();
    hdc.moveTo(mCoords[0], mCoords[1]);
    for (i=2; i<n; i+=2)
    {
        hdc.lineTo(mCoords[i], mCoords[i+1]);
    }
    hdc.lineTo(mCoords[0], mCoords[1]);
    hdc.stroke();
}

function drawRect(coOrdStr)
{
    var mCoords = coOrdStr.split(',');
    var top, left, bot, right;
    left = mCoords[0];
    top = mCoords[1];
    right = mCoords[2];
    bot = mCoords[3];
    hdc.strokeRect(left,top,right-left,bot-top); 
}

function myHover(element)
{
    var hoveredElement = element;
    var coordStr = element.getAttribute('coords');
    var areaType = element.getAttribute('shape');

    switch (areaType)
    {
        case 'polygon':
        case 'poly':
            drawPoly(coordStr);
            break;

        case 'rect':
            drawRect(coordStr);
    }
}

function myLeave()
{
    var canvas = byId('myCanvas');
    hdc.clearRect(0, 0, canvas.width, canvas.height);
}

function myInit()
{
    // get the target image
    var img = byId('img-imgmap201293016112');

    var x,y, w,h;

    // get it's position and width+height
    x = img.offsetLeft;
    y = img.offsetTop;
    w = img.clientWidth;
    h = img.clientHeight;

    // move the canvas, so it's contained by the same parent as the image
    var imgParent = img.parentNode;
    var can = byId('myCanvas');
    imgParent.appendChild(can);

    // place the canvas in front of the image
    can.style.zIndex = 1;

    // position it over the image
    can.style.left = x+'px';
    can.style.top = y+'px';

    // make same size as the image
    can.setAttribute('width', w+'px');
    can.setAttribute('height', h+'px');

    // get it's context
    hdc = can.getContext('2d');

    // set the 'default' values for the colour/width of fill/stroke operations
    hdc.fillStyle = 'red';
    hdc.strokeStyle = 'red';
    hdc.lineWidth = 2;
}
</script>

<style>
body
{
    background-color: gray;
}
canvas
{
    pointer-events: none;       /* make the canvas transparent to the mouse - needed since canvas is position infront of image */
    position: absolute;
}
</style>

<title></title>
</head>
<body onload='myInit()'>
    <canvas id='myCanvas'></canvas>     <!-- gets re-positioned in myInit(); -->
<center>
<img src='http://dailyaeen.com.pk/epaper/wp-content/uploads/2012/09/27+Sep+2012-1.jpg?1349003469874' usemap='#imgmap_css_container_imgmap201293016112' class='imgmap_css_container' title='imgmap201293016112' alt='imgmap201293016112' id='img-imgmap201293016112' />
<map id='imgmap201293016112' name='imgmap_css_container_imgmap201293016112'>
    <area shape="poly" onmouseover='myHover(this);' onmouseout='myLeave();' coords="2,0,604,-3,611,-3,611,166,346,165,345,130,-2,130,-2,124,1,128,1,126" href="" alt="imgmap201293016112-0" title="imgmap201293016112-0" class="imgmap201293016112-area" id="imgmap201293016112-area-0" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="1,131,341,213" href="" alt="imgmap201293016112-1" title="imgmap201293016112-1" class="imgmap201293016112-area" id="imgmap201293016112-area-1" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="346,166,614,241" href="" alt="imgmap201293016112-2" title="imgmap201293016112-2" class="imgmap201293016112-area" id="imgmap201293016112-area-2" />
    <area shape="poly" onmouseover='myHover(this);' onmouseout='myLeave();' coords="917,242,344,239,345,496,574,495,575,435,917,433" href="" alt="imgmap201293016112-3" title="imgmap201293016112-3" class="imgmap201293016112-area" id="imgmap201293016112-area-3" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="1,416,341,494" href="" alt="imgmap201293016112-4" title="imgmap201293016112-4" class="imgmap201293016112-area" id="imgmap201293016112-area-4" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="1,215,341,410" href="" alt="imgmap201293016112-5" title="imgmap201293016112-5" class="imgmap201293016112-area" id="imgmap201293016112-area-5" />
    <area shape="poly" onmouseover='myHover(this);' onmouseout='myLeave();' coords="916,533,916,436,578,436,576,495,806,496,807,535" href="" alt="imgmap201293016112-6" title="imgmap201293016112-6" class="imgmap201293016112-area" id="imgmap201293016112-area-6" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="805,536,918,614" href="" alt="imgmap201293016112-7" title="imgmap201293016112-7" class="imgmap201293016112-area" id="imgmap201293016112-area-7" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="461,494,803,616" href="" alt="imgmap201293016112-8" title="imgmap201293016112-8" class="imgmap201293016112-area" id="imgmap201293016112-area-8" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,497,223,616" href="" alt="imgmap201293016112-9" title="imgmap201293016112-9" class="imgmap201293016112-area" id="imgmap201293016112-area-9" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="230,494,456,614" href="" alt="imgmap201293016112-10" title="imgmap201293016112-10" class="imgmap201293016112-area" id="imgmap201293016112-area-10" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="345,935,572,1082" href="" alt="imgmap201293016112-11" title="imgmap201293016112-11" class="imgmap201293016112-area" id="imgmap201293016112-area-11" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="1,617,457,760" href="" alt="imgmap201293016112-12" title="imgmap201293016112-12" class="imgmap201293016112-area" id="imgmap201293016112-area-12" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="345,760,577,847" href="" alt="imgmap201293016112-13" title="imgmap201293016112-13" class="imgmap201293016112-area" id="imgmap201293016112-area-13" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,759,344,906" href="" alt="imgmap201293016112-14" title="imgmap201293016112-14" class="imgmap201293016112-area" id="imgmap201293016112-area-14" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="346,850,571,935" href="" alt="imgmap201293016112-15" title="imgmap201293016112-15" class="imgmap201293016112-area" id="imgmap201293016112-area-15" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="578,761,915,865" href="" alt="imgmap201293016112-16" title="imgmap201293016112-16" class="imgmap201293016112-area" id="imgmap201293016112-area-16" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,1017,226,1085" href="" alt="imgmap201293016112-17" title="imgmap201293016112-17" class="imgmap201293016112-area" id="imgmap201293016112-area-17" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,908,342,1017" href="" alt="imgmap201293016112-18" title="imgmap201293016112-18" class="imgmap201293016112-area" id="imgmap201293016112-area-18" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="229,1010,342,1084" href="" alt="imgmap201293016112-19" title="imgmap201293016112-19" class="imgmap201293016112-area" id="imgmap201293016112-area-19" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,1086,340,1206" href="" alt="imgmap201293016112-20" title="imgmap201293016112-20" class="imgmap201293016112-area" id="imgmap201293016112-area-20" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,1209,224,1290" href="" alt="imgmap201293016112-21" title="imgmap201293016112-21" class="imgmap201293016112-area" id="imgmap201293016112-area-21" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,1290,225,1432" href="" alt="imgmap201293016112-22" title="imgmap201293016112-22" class="imgmap201293016112-area" id="imgmap201293016112-area-22" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="0,1432,340,1517" href="" alt="imgmap201293016112-23" title="imgmap201293016112-23" class="imgmap201293016112-area" id="imgmap201293016112-area-23" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="346,1432,686,1517" href="" alt="imgmap201293016112-24" title="imgmap201293016112-24" class="imgmap201293016112-area" id="imgmap201293016112-area-24" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="461,1266,686,1429" href="" alt="imgmap201293016112-25" title="imgmap201293016112-25" class="imgmap201293016112-area" id="imgmap201293016112-area-25" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="230,1365,455,1430" href="" alt="imgmap201293016112-26" title="imgmap201293016112-26" class="imgmap201293016112-area" id="imgmap201293016112-area-26" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="231,1291,457,1360" href="" alt="imgmap201293016112-27" title="imgmap201293016112-27" class="imgmap201293016112-area" id="imgmap201293016112-area-27" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="230,1210,342,1289" href="" alt="imgmap201293016112-28" title="imgmap201293016112-28" class="imgmap201293016112-area" id="imgmap201293016112-area-28" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="692,928,916,1016" href="" alt="imgmap201293016112-29" title="imgmap201293016112-29" class="imgmap201293016112-area" id="imgmap201293016112-area-29" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="460,616,916,759" href="" alt="imgmap201293016112-30" title="imgmap201293016112-30" class="imgmap201293016112-area" id="imgmap201293016112-area-30" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="693,1316,917,1518" href="" alt="imgmap201293016112-31" title="imgmap201293016112-31" class="imgmap201293016112-area" id="imgmap201293016112-area-31" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="344,1150,572,1219" href="" alt="imgmap201293016112-32" title="imgmap201293016112-32" class="imgmap201293016112-area" id="imgmap201293016112-area-32" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="693,1015,916,1171" href="" alt="imgmap201293016112-33" title="imgmap201293016112-33" class="imgmap201293016112-area" id="imgmap201293016112-area-33" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="577,955,686,1032" href="" alt="imgmap201293016112-34" title="imgmap201293016112-34" class="imgmap201293016112-area" id="imgmap201293016112-area-34" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="577,1036,687,1101" href="" alt="imgmap201293016112-35" title="imgmap201293016112-35" class="imgmap201293016112-area" id="imgmap201293016112-area-35" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="576,1104,689,1172" href="" alt="imgmap201293016112-36" title="imgmap201293016112-36" class="imgmap201293016112-area" id="imgmap201293016112-area-36" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="691,1232,918,1313" href="" alt="imgmap201293016112-37" title="imgmap201293016112-37" class="imgmap201293016112-area" id="imgmap201293016112-area-37" />
    <area shape="rect" onmouseover='myHover(this);' onmouseout='myLeave();' coords="341,1085,573,1151" href="" alt="imgmap201293016112-38" title="imgmap201293016112-38" class="imgmap201293016112-area" id="imgmap201293016112-area-38" />
    <area shape="poly" onmouseover='myHover(this);' onmouseout='myLeave();' coords="917,868,917,925,688,927,688,955,576,955,574,867,572,864" href="" alt="imgmap201293016112-39" title="imgmap201293016112-39" class="imgmap201293016112-area" id="imgmap201293016112-area-39" />
    <area shape="poly" onmouseover='myHover(this);' onmouseout='myLeave();' coords="919,1173,917,1231,688,1231,688,1266,574,1267,576,1175,576,1175" href="" alt="imgmap201293016112-40" title="imgmap201293016112-40" class="imgmap201293016112-area" id="imgmap201293016112-area-40" />
    <area shape="poly" onmouseover='myHover(this);' onmouseout='myLeave();' coords="572,1222,572,1265,459,1265,458,1289,339,1290,344,1225" href="" alt="imgmap201293016112-41" title="imgmap201293016112-41" class="imgmap201293016112-area" id="imgmap201293016112-area-41" />
</map>
</center>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-30T13:05:37.537

您可以使用`jQuery`来实现这一点

例子：

```
$(function () {
        $('.map').maphilight();
    }); 
```

通过此[**链接**](http://www.c-sharpcorner.com/UploadFile/abhikumarvatsa/image-map-mouse-hover-effect-on-area-using-jquery/)了解更多信息。

如果上述方法不起作用，请通过此**[链接](http://davidlynch.org/blog/2008/03/maphilight-image-map-mouseover-highlighting/)**。

**编辑**：

`area`为每个标签赋予相同的类，例如`class="mapping"`

并尝试以下代码

```
$('.mapping').mouseover(function() {
    alert($(this).attr('id'));
}).mouseout(function(){
    alert('Mouseout....');      
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-25T14:07:35.790

为了完成这个脚本，画圆的功能，

```
 function drawCircle(coordon)
    {
        var coord = coordon.split(',');

        var c = document.getElementById("myCanvas");
        var hdc = c.getContext("2d");
        hdc.beginPath();

        hdc.arc(coord[0], coord[1], coord[2], 0, 2 * Math.PI);
        hdc.stroke();
    } 
```

# iphone - 是否有开源库可以为 iOS 构建音频可视化？

> ID：12661132
> 
> 赞同：4
> 
> 时间：2012-09-30T12:06:31.337
> 
> 标签：iphone, ios, audio, visualization, core-audio

我有一个均衡器视图，在 OpenGL ES 中有 10 个条，可以点亮和熄灭。现在我想从 iOS 中播放的背景音乐中驱动这个均衡器视图。

有人建议我需要一个[快速傅立叶变换](http://en.wikipedia.org/wiki/Fast_Fourier_transform)来将音频数据转换成其他东西。但由于有这么多的音频可视化浮动，我希望有一个开源库或任何我可以开始的东西。

也许有做音频可视化的开源 iOS 项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-18T12:01:54.147

是的。

你可以试试我为此目的编写的[这个 Objective-C 库。](https://github.com/tomer8007/real-time-audio-fft)它的作用是为您提供一个界面，用于播放`URL`s 中的文件，然后获取实时 FFT 和波形数据，以便您可以使用 OpenGL 条或任何用于可视化声音的图形来提供它。它还试图提供非常准确的结果。

如果你想快速完成，你可以看一下[这个更简洁的例子](https://github.com/jscalo/tempi-fft)，它还展示了如何实际绘制均衡器视图。

# html - 如何将 AppEngine 数据获取到 GWT 客户端，仅一次

> ID：12661142
> 
> 赞同：0
> 
> 时间：2012-09-30T12:08:00.663
> 
> 标签：html, google-app-engine, gwt

我的 AppEngine 支持的应用程序中有一个 6MB 的二进制文件。我需要将此文件发送给我的 GWT 客户端以进行许多计算。我试图避免在服务器上进行计算以节省我的实例小时配额。但这意味着我必须以某种方式将文件发送给我的客户。

我也不想每次打开应用程序时都将它下载到应用程序，这会损害我的 appengine 传出带宽配额。

最好下载一次，然后让客户端以某种方式存储它以供下次打开应用程序时使用。

如何最好地做到这一点？

客户端捆绑包？使用 HTML5 存储？这种事情还没有完成，我应该在服务器上进行计算并将结果发送给客户端吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:48:01.920

永久缓存文件的最简单方法是使用[应用程序缓存](http://www.html5rocks.com/en/tutorials/appcache/beginner/)。

另一种方式是 HTML5 Storage (localStorage)，但有 2.5 MB 的限制。要使用超过这个数量，您可以使用 IndexedDB（Chrome、Firefox、IE10）和 WebSQL（Safari、Opera）。[在这种情况下，像YDN-DB](http://git.yathit.com/ydn-db)这样的包装库会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T15:40:12.063

您可以使用数据资源：

[https://developers.google.com/web-toolkit/doc/latest/DevGuideClientBundle#DataResource](https://developers.google.com/web-toolkit/doc/latest/DevGuideClientBundle#DataResource)

您面临的唯一问题是文件大小。不同的浏览器有不同的限制——我见过 5MB 和 8MB 的数字。如果您可以将文件压缩到 5MB 以下，那么大多数浏览器都应该没问题。（顺便说一句，如果不能进一步压缩，这将是一个巨大的数据量。）

此外，您可以检测移动浏览器（或为移动版本提供不同的 URL），并在服务器上为移动用户进行计算。

# windows - 如何强制 GitHub Windows 客户端每次都询问在哪里克隆 repo？

> ID：12661146
> 
> 赞同：0
> 
> 时间：2012-09-30T12:08:52.073
> 
> 标签：windows, github, settings, clone

每次我要从 GitHub 克隆它时，我希望 GitHub 客户端询问我在哪里克隆一个 repo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T18:49:55.370

GitHub for Windows 1.0.18 版本的发行[说明包括：](http://windows.github.com/release-notes.html)

> 添加：“ `clone to...`”菜单项用于克隆到特定的基本目录

因此，如果您选择*该*菜单项（**右键单击**存储库），它将询问您在哪里克隆存储库。每次。

![GitHub for Windows 克隆到选项](../Images/1270a9d7f40e3a5a53e3f34294006f68.png)

# netbeans - Netbeans 从数据库的多个 shcemas 生成 hbm.xml 文件

> ID：12661151
> 
> 赞同：0
> 
> 时间：2012-09-30T12:10:44.703
> 
> 标签：netbeans, netbeans-7, hibernate-mapping, pojo, hbmxml

我正在使用 netbeans，我正在从数据库生成 POJO 和 hbm.xml 文件，但我只能从一个模式生成。但我需要从两个不同的模式创建，并且它的表具有交叉引用或关系。我怎样才能在 Netbeans 中做到这一点？或者是否有任何替代解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T06:06:54.643

```
似乎是 Netbean 的错误，同时创建了一个反向
工程 xml 文件，实际上你不能从多个模式创建它们，
因为只是 Netbean 不会简单地生成它们。有几种解决方案
如果您不想在逆向工程文件中手动编写所有代码：
1）首先您可以生成逆向工程文件
 Eclipse IDE，然后您可以将其复制并粘贴到
 Netbeans 逆向工程文件，那么它应该
可以很好地生成 POJO 和 hbm.xml 文件；

```

# mysql - Mysql中的语法错误

> ID：12661152
> 
> 赞同：0
> 
> 时间：2012-09-30T12:10:49.123
> 
> 标签：mysql, sql, phpmyadmin

我正在使用 phpmyadmin 和 mysql 来编译我的数据库，我正在尝试调试遇到的约束问题，因此我尝试在下面执行此代码：

```
SHOW ENGINE INNODB STATUS\G 
```

但它是说这是错误的语法，

有人知道正确的语法是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T12:26:56.637

`\G`仅用于mysql交互式客户端，我认为phpmyadmin不支持它。

只需执行以下操作：

```
SHOW ENGINE INNODB STATUS; 
```

# openerp - 在 openerp 中更改日历视图

> ID：12661153
> 
> 赞同：1
> 
> 时间：2012-09-30T12:10:57.207
> 
> 标签：openerp

截至目前，openerp 中的日历默认为 24​​ 小时格式，但我想更改日历的 12 小时格式。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T10:18:34.080

Do you mean to display only 12 hrs ? Or you want the 24 hrs but with a range of 2 hrs ?

if you want the first solution, simply put day_length attribute to your calendar tag with an integer to specify how many hrs you want to display (actually, it only permits to create records on those 12 hrs, it's consided as a "working day length".).

example :

```
<calendar day_length="12" ....... >
<!-- some fields -->
<calendar /> 
```

Otherwise, i think you have to override default calendar view, but i can't help you to do that.

Regards,

Nonow Dev

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T11:04:01.627

日历视图中有三种类型的类别。

*   天
*   星期
*   月

当您单击日期按钮时，您的数据将以 12 小时的方式分叉。

# curl - curl：从文件中读取标题

> ID：12661159
> 
> 赞同：48
> 
> 时间：2012-09-30T12:11:46.763
> 
> 标签：curl

--dump-header 写入文件后，如何将这些标头读回下一个请求？我想从文件中读取它们，因为它们有很多。

我尝试了标准：`cat headers | curl -v -H - ...`

我实际上是在使用 Firebug 中的功能来“复制请求标头”，然后将它们保存到文件中。这似乎是相同的格式。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-10-02T10:56:16.460

# 自卷曲 7.55.0

简单的：

```
$ curl -H @header_file $URL 
```

...其中头文件是一个纯文本文件，每行都有一个 HTTP 头。像这样：

```
Color: red
Shoesize: 11
Secret: yes
User-Agent: foobar/3000
Name: "Joe Smith" 
```

# 在 curl 7.55.0 之前

curl 无法像那样“批量更改”标题，甚至无法从文件中。

使用旧 curl 版本的最佳方法可能是编写一个 shell 脚本，从文件中收集所有标题并使用它们，例如：

```
#!/bin/sh
while read line; do
  args="$args -H '$line'";
done
curl $args $URL 
```

像这样调用脚本：

```
$ sh script.sh < header_file 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2014-08-06T08:10:27.367

这个怎么样：

```
curl -v -H "$(cat headers.txt)" yourhost.com 
```

`headers.txt`看起来像哪里

```
Header1: bla
Header2: blupp 
```

在 BASH 中工作。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2017-10-15T21:15:37.410

从 curl 7.55.0 开始，它现在可以从文件中读取标题：

```
curl -H @filename 
```

现在就这么容易。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-02-13T08:39:15.073

正如[@dmitry-sutyagin](https://stackoverflow.com/users/3952027/dmitry-sutyagin)所回答的那样，如果您的 curl 至少是 7.55.0 版本，您可以使用该`@`符号从文件中读取标题：

```
curl -H @headerfile.txt https://www.google.com/  # requires curl 7.55.0 
```

如果您的 curl 不是 7.55.0 或更高版本，则有一个有用的技巧：

*   使用选项`-K/--config <config file>`，并在文本文件中放置几`-H/--header <header>`行。

例如：

1.  `curl --dump-header foo.txt https://www.google.com/`
2.  如有必要，`dos2unix foo.txt`
3.  手动或使用脚本将文件转换为`-H 'header'`行：

    ```
    cat foo.txt |
      awk '$1 == "Set-Cookie:"' |
      perl -ne "chomp; next if /^\\s*\$/; if (/'/) { warn; next } print \"-H '\$_'\\n\";" |
      tee headerfile.txt 
    ```

    这可能会输出如下内容：

    ```
    -H 'Set-Cookie: 1P_JAR=2018-02-13-08; [...]'
    -H 'Set-Cookie: NID=123=n7vY1W8IDElvf [...]' 
    ```

4.  `curl --config headerfile.txt https://www.google.com/`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-12-24T01:16:35.310

```
curl $(xargs -a headers.txt printf "-H '%s'") example.org 
```

# iphone - Appcelerator - 从 iPhone 应用发布推文 - 卡在回调 URL 上

> ID：12661160
> 
> 赞同：1
> 
> 时间：2012-09-30T12:11:47.127
> 
> 标签：iphone, twitter, titanium, appcelerator, callbackurl

我需要使用 Appcelerator Titanium 和 javascript 从我的 iphone/ipad 应用程序发送推文。我在 github 上找到了以下示例（代码也在下面发布）：

[https://gist.github.com/2eabc31db388144b3abc](https://gist.github.com/2eabc31db388144b3abc)

我已经在我的 twitter 开发者帐户中创建了我的应用程序详细信息（密钥、秘密等），并使用示例中的代码我得到了 twitter 登录和授权弹出窗口，但是一旦你点击授权，我得到的只是一个显示回调 url 的 web 视图（即我被要求输入 twitter 应用程序设置）。所以应用程序卡在显示回调 url 的 web 视图上，但之后什么也不做。如果我关闭弹出窗口，它只会返回我的应用程序而不发送推文。

任何人都可以帮忙吗？

app.js 中的代码：

```
var win = Ti.UI.createWindow({ backgroundColor: '#fff' });
var shareButton = Ti.UI.createButton({
    width: 90, bottom: 10, height: 30,
    title: 'Tweet!"'
});
win.add(shareButton);
win.open();

var social = require('social');
var twitter = social.create({
    site: 'Twitter',
    consumerKey: 'XXXXXXXXXXXXXXXX', 
    consumerSecret: 'XXXXXXXXXXXXXXXXXXXXX' 
});

shareButton.addEventListener('click', function() {
    twitter.share({
        message: 'Hello, world!',
        success: function() {
            alert('Tweeted!');
        },
        error: function(error) {
            alert('Oh no! ' + error);
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T14:48:09.437

正如[Aaron 在问答中回答的](http://developer.appcelerator.com/question/142880/post-a-tweet-from-iphone-app---stuck-on-callback-url)那样，在使用 Social.js 时，您不应该使用回调 URL。代码本身将[监视 Web 视图](https://gist.github.com/00e95c5d95d2b7d5d027#L991)以获取所需的内容。

# wpf - wpf 滚动查看器对话框

> ID：12661166
> 
> 赞同：2
> 
> 时间：2012-09-30T12:13:17.163
> 
> 标签：wpf, modal-dialog, scrollviewer

我对 WPF 的 ScrollViewer 有疑问

这是我目前拥有的代码：

```
<Window x:Class="BasketNovelEditor.Menu.AboutBox"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    WindowStartupLocation="CenterOwner"
    Title="AboutBox" Height="Auto" Width="425" Focusable="True" SizeToContent="Height">
<Grid>     
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="200"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <Label Grid.Row="0" MinHeight="50" VerticalContentAlignment="Center" HorizontalContentAlignment="Center">Thank you!</Label>
    <Label Grid.Row="1" MinHeight="30" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">BasketNovel uses the following Libraries:</Label>
    <Button Grid.Row="3" DockPanel.Dock="Bottom" IsDefault="True" IsCancel="True">Close Window</Button>
    <ScrollViewer Grid.Row="2" Margin="5" Height="200">
        <StackPanel>

        </StackPanel>
    </ScrollViewer>
</Grid> 
```

这些是我得到的结果：

[http://i1280.photobucket.com/albums/a500/daegon123/ss.png](http://i1280.photobucket.com/albums/a500/daegon123/ss.png)

[http://i1280.photobucket.com/albums/a500/daegon123/ss_zps3d6b8c90.png](http://i1280.photobucket.com/albums/a500/daegon123/ss_zps3d6b8c90.png)

我完全不知道为什么我的滚动条会这样显示。我至少期望将向上/向下箭头放置在滚动条的起点/终点。

任何人都知道为什么会这样？我不确定这是否与它有关，但 Window 被用作如下调用的对话框：

aboutbox.ShowDialog();

我目前正在使用 .NET 4.0

--EDIT2--

经过一些测试，我意识到如果我在其中放置滚动查看器，这将发生在我所有的模态窗口中。我的主窗口中的滚动查看器看起来不错，所以我感觉这是特定于模式窗口的东西，或者我可能在不知道的情况下对它们做的事情。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:26:42.243

您是否尝试过将 Height="200" 移动到 StackPanel ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-01T06:53:03.850

由于某种原因，在更新到 Visual Studio 2012 update2 后，此问题已得到解决。

我仍在使用 .NET 4.0

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-15T17:12:20.280

2019年遇到同样的问题，VS2019社区。ScrollViewer 在主窗口中工作得很好，但在模态窗口中它根本不滚动。

我将高度设置为 ScrollViewer 和 StackPanel，它开始工作正常。

```
<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" PanningMode="Both" Height="340"> 
```

我也玩过不同版本的 .NET Framework

# php - 确定生成的日期是否在假期（PHP）？

> ID：12661167
> 
> 赞同：3
> 
> 时间：2012-09-30T12:13:18.357
> 
> 标签：php, date, bank

有谁知道现有的库，甚至是一个有用的函数，它允许 php 脚本检查生成的日期是否与假期冲突，无论是美国、英国、澳大利亚还是 SAF 假期？

如果没有图书馆，我可以利用任何有用的在线资源来开发自己的资源吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T12:23:43.040

我只是在谷歌上搜索，因为这是一个有趣的主题，我还没有尝试过，但似乎可以使用 pear 包。

这是链接： http: [//pear.php.net/package/Date_Holidays](http://pear.php.net/package/Date_Holidays)

这是示例： http: [//pear.php.net/manual/en/package.datetime.date-holidays.example.php](http://pear.php.net/manual/en/package.datetime.date-holidays.example.php)

希望这对你有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T09:40:02.973

今天早上我发现了这个有用的包：

[http://maccrafters.com/home/current-offerings/programming/php-holiday-class/](http://maccrafters.com/home/current-offerings/programming/php-holiday-class/)

调整它并使其更强大很容易，但它非常用户友好并且到目前为止运行良好。它还有一个很好的功能，可以从特定日期获取下一个工作日。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-16T13:24:17.433

一些选项可以是： Michalmanko/Holiday 是一个小型图书馆，用于检查指定日期是否是特定国家/地区的假期。 [https://github.com/michalmanko/php-library-holiday](https://github.com/michalmanko/php-library-holiday)

# java - 给定 jRadioButton 选项的 jButton 的 ActionEvent

> ID：12661171
> 
> 赞同：3
> 
> 时间：2012-09-30T12:14:14.787
> 
> 标签：java, swing, jbutton, actionlistener, jradiobutton

所以基本上，我试图在这里用 GUI 制作一个简单的程序，让您在给定两个 jRadioButtons 的情况下做出选择，这两个按钮中的任何一个都会以类似于视觉小说的方式导致相应的故事情节。然而，问题是我无法将 jButton 的想法与 jRadioButton 的选择联系起来。

这个概念是这样的：在一个框架中，有一个 jTextArea，它显示形成一个故事情节的文本字符串，它提供了两个选项可供选择，由两个 jRadioButtons 表示，然后必须由一个 jButton 执行。

到目前为止，我在两个 jRadioButtons 的 ActionListener 中放置的唯一逻辑是，一旦单击 jRadioButton 而 jButton 故意为空，则必须禁用另一个。任何人有任何类似的程序或模块，他/她想至少以编程方式分享这个逻辑吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T13:36:20.633

我们通常使用 RadioButtons 在几个选项之一之间进行选择，并且一次只能选择一个按钮。要获得此功能，您需要将按钮添加到[javax.swing.ButtonGroup](http://docs.oracle.com/javase/tutorial/uiswing/components/buttongroup.html)。这是一个简单的例子：

```
 //Fields declared in your main GUI class
 JRadioButton option1,option2;
 JButton goButton; //executes the "Story"

 //Constructor code or place in init() method that constructor calls:
 {
    //initialize buttons and place them in your frame.
    ButtonGroup buttonGroup = new javax.swing.ButtonGroup();
    buttonGroup.add(option1);
    buttonGroup.add(option2);
    buttonGroup1.setSelected(option1.getModel(), true);
    goButton.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            goButtonActionPerformed(evt);
        }
    });

}

private void goButtonActionPerformed(java.awt.event.ActionEvent evt) {                                             
     if(option1.isSelected()) {                
         //place text in your text area
     }
     if(option2.isSelected()) {                
         //place different text in your text area
     }
} 
```

# sencha-touch-2 - 从其他文件夹运行 Sencha Touch 2 构建命令

> ID：12661174
> 
> 赞同：0
> 
> 时间：2012-09-30T12:15:17.053
> 
> 标签：sencha-touch-2

我有一个部署脚本，我想在其中执行 Sencha 构建命令。

理想情况下，我想做这样的事情：

```
sencha app /opt/server/webapps/mybipperapi build production 
```

如何设置绝对路径以指向 sencha 命令应在何处查找 Sencha 应用程序？

# mp4 - 为 mp4 的大小设置唯一值

> ID：12661178
> 
> 赞同：0
> 
> 时间：2012-09-30T12:15:36.320
> 
> 标签：mp4

我想做的是让我的 mp4 始终显示相同的大小，就像用户在播放 mp4 时双击它一样（即，顶部和底部的黑条），而不是全屏打开。

如何按照开头所述显示 mp4 并且不允许用户更改它？

我最好的猜测是更改帧大小，但我不确定这是最佳方法。

# jsp - 用托管属性填充 selectonemenu

> ID：12661180
> 
> 赞同：0
> 
> 时间：2012-09-30T12:16:08.250
> 
> 标签：jsp, jsf, java-ee-6, managed-bean

对于一个项目，我需要用 faces-config 文件中初始化的列表的值填充 selectonemenu。我似乎无法找到正确的答案，希望有人可以为我解答。
为什么不将 faces-config 中的值加载到 selectonemenu 中？我很确定我忘记了一些东西，但我不知道我忘记了什么。目前 selectonemenu 完全为空。下面是我的代码的副本。

面孔配置：

```
<managed-bean-name>myBean</managed-bean-name>
<managed-bean-class>beans.MyBean</managed-bean-class>
<managed-bean-scope>session</managed-bean-scope>
<managed-property>
    <property-name>animals</property-name>
    <list-entries>
        <value>Cat</value>
        <value>Dog</value>
    </list-entries>
</managed-property> 
```

豆豆

```
private String animal;
private List<SelectItem> animals;

public String getAnimal() {
    return animal;
}

public void setAnimal(String animal) {
    this.animal = animal;
}

public void setAnimals(List<String> items) {     
    animals = new ArrayList<SelectItem>();
    for (String item : items){
      animals.add(new SelectItem(item));
    }
}

public List<SelectItem> getAnimals() {        
    return animals;
} 
```

索引.xhtml

```
<h:form>
    <h:inputText value="#{myBean.name}"/>
    <h:inputText value="#{myBean.age}"/>
    <h:selectOneMenu id="animal" value="#{myBean.animal}">
        <f:selectItems value="#{myBean.animals}"/>
    </h:selectOneMenu>

    <h:commandButton value="press" action="page2"/>
</h:form> 
```

# c# - 在C#中查找所有特定值的子节点

> ID：12661188
> 
> 赞同：1
> 
> 时间：2012-09-30T12:17:28.053
> 
> 标签：c#, xml, search, xmlnode

```
<main>
  <myself>
    <pid>1</pid>
    <name>abc</name>
  </myself>
  <myself>
    <pid>2</pid>
    <name>efg</name>
  </myself>
</main> 
```

那是我的名为 simpan 的 XML 文件。我有两个按钮。下一个和上一个。我想要做的是，当用户单击按钮时，所有信息都将显示在 TextBox 上。搜索节点将基于 pid。

Next 按钮将添加 1 个 pid 值（假设 pid=2），它将搜索具有相同 pid=2 值的节点。它还将显示 pid=2 的名称。（显示名称=abc）

上一个按钮也是如此，它将减少 pid 的 1 值（pid = 1）。

有人知道该怎么做吗？

// - - - - - - -编辑 - - - - - - - - -

感谢LB，我正在尝试使用他的代码。但是我有一个错误。

![在此处输入图像描述](../Images/0b05d385ccb8d27b16fd75af1e458d89.png)

我的代码实现是否正确？

```
private void previousList_Click(object sender, EventArgs e)
    {
        pid = 14;

        XDocument xDoc = XDocument.Parse("C:\\Users\\HDAdmin\\Documents\\Fatty\\SliceEngine\\SliceEngine\\bin\\Debug\\simpan.xml");

        var name = xDoc.Descendants("myself")
                    .First(m => (int)m.Element("PatientID") == pid)
                    .Value;

        textETA.Text = name;
        ////////////////////

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T12:28:37.317

```
int pid = 2;
XDocument xDoc = XDocument.Parse(xml); //Load

var name = xDoc.Descendants("myself")
            .First(m => (int)m.Element("pid") == pid)
            .Element("name")
            .Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:43:03.910

您可以使用以下`XPath`命令列出所有标签，然后使用简单的命令`Myself`查找您想要的内容：`Linq`

```
XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.Load(AppDomain.CurrentDomain.BaseDirectory + "file1.xml");
        var resNodes = xmlDoc.SelectNodes("//myself");
        XmlNode res = null;
        var val = textBox1.Text;

        var item = from XmlNode x in resNodes
                   select x;

        foreach (var nodP in item) {
            foreach (XmlNode nod in nodP.ChildNodes) {
                if (nod.InnerText == val) {
                    res = nodP;
                }
            }
        }

        if (res == null)
            // not found!
            ;
        else
            // show the result
            ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T12:44:13.927

叫我老式的，但你可以使用[XPath](http://msdn.microsoft.com/en-us/library/ms256086.aspx)，例如：

```
string xml =
    @"<main>
        <myself>
            <pid>1</pid>
            <name>abc</name>
        </myself>
        <myself>
            <pid>2</pid>
            <name>efg</name>
        </myself>
      </main>";

using System.Xml;

....

XmlDocument xmlDocument = new XmlDocument();
xmlDocument.LoadXml(xml);
// Replace "2" in the string below with the desired pid
XmlNode xmlNode = 
    xmlDocument.DocumentElement.SelectSingleNode("myself/name[../pid=2]");
// xmlNode contains the <name>efg</name> XmlElement. For example:
string name = xmlNode.Value; 
```

如果它可以匹配多个节点，例如可能有多个`<myself>`元素的子元素`<pid>`设置为 2，请改用以下内容：

```
foreach(XmlNode xmlNode in 
    xmlDocument.DocumentElement.SelectNodes("myself/name[../pid=2]"))
{
    // xmlNode contains the matching <name> element
} 
```

在这两种情况下，都可以使用[Value](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.value.aspx)属性从[XmlNode中提取值。](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T14:17:52.433

```
public class simpman
{

    private static XElement root = XElement.Load("Simpman.xml");

    public static string GetItem(int index)
    {
        XElement item =
        (from element in root.Elements("myself")
        where (int)element.Element("pid") == index
        select element.Element("name")).SingleOrDefault();

        return item != null ? item.Value : "Please check the Index";
    }
} 
```

将 static 初始化`itemIndex`为 1 并进一步使用它，例如`itemIndex++`（for Next）和`itemIndex--`（for Prev）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-30T12:53:19.427

```
private void previousList_Click(object sender, EventArgs e)
{
    pid = 14;

    XDocument xDoc = XDocument.Load(@"C:\Users\HDAdmin\Documents\Fatty\SliceEngine\SliceEngine\bin\Debug\simpan.xml");

    var name = xDoc.Root
                   .Descendants("myself")
                   .FirstOrDefault(e => e.Element("pid")
                   .Value
                   .Equals(pid.ToString(CultureInfo.InvariantCulture)))
                   .Element("name")
                   .Value;

    textETA.Text = name;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-03T06:20:10.127

`XmlDocument doc = new XmlDocument(); FileStream fs = new FileStream(rootXMLPath, FileMode.Open, FileAccess.Read); doc.Load(fs); XmlNode node = doc.DocumentElement;`

`nodeName = "/main/myself";`

`var child1 = node.SelectSingleNode(nodeName).ChildNodes[0].FirstChild.InnerXml; var child2 = node.SelectSingleNode(nodeName).ChildNodes[0].LastChild.InnerXml; var child3 = node.SelectSingleNode(nodeName).ChildNodes[1].FirstChild.InnerXml; var child4 = node.SelectSingleNode(nodeName).ChildNodes[1].LastChild.InnerXml;`

# ruby - 用异步版本 + 纤程替换 Ruby IO 库

> ID：12661189
> 
> 赞同：1
> 
> 时间：2012-09-30T12:17:29.627
> 
> 标签：ruby, asynchronous, nonblocking, fibers

是否可以用不同的实现替换所有 ruby​​ IO 类，这些实现在幕后使用反应器和光纤？我的意思是，实际上所有使用原生 ruby​​ IO 的库都将按预期工作，因为所有对 IO 的调用都将用纤维包装，它们将等待请求的操作。但是在等待连接/文件中的数据可用时，ruby 将服务于其他 io 操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:03:41.237

有可能吗？是的，只是猴子补丁 IO。工作量很大吗？是的，但如果你真的想要，那就去做吧。如果您不知道如何修补 IO，请提出您的问题。

例如，要覆盖`read`：

```
class IO
  def read(count = -1)
    #Some fiber code here...
  end
end 
```

# c# - 形成列表时出现 System.IndexOutOfRangeException

> ID：12661191
> 
> 赞同：0
> 
> 时间：2012-09-30T12:17:33.007
> 
> 标签：c#

我正在尝试借助看起来像这样的多维数组来形成一个列表。

```
[validatorKey][counter]
1453          10
1231          12
6431          7
1246          1
1458          2 
```

但是，我无法应付。顺便说一句，这是我的方法。并且数组大小应该在方法的最后增加。我知道我应该使用 Array.Resize(ref array, 2); 但由于我的数组是多维的，在这种情况下应该是什么合适的方法。

```
private int AracaAitSeferSayisiDondur(int pValidatorKey)
{
     int iSeferSayisi = 0;
     int[,] iSeferListesi = (int[,])ViewState["SeferListesi"];
     if (iSeferListesi == null)
     iSeferListesi = new int[1,1];

     bool aynisiVarmi = false;

     for (int i = 0; i < iSeferListesi.Length; i++)
     {
        if (iSeferListesi[i,0] == pValidatorKey)
        {
           aynisiVarmi = true;
           iSeferListesi[i,1]++;
           iSeferSayisi = iSeferListesi[i,1]++;
           break;
        }
     }
     if (!aynisiVarmi)
     {
        int arrayLength = iSeferListesi.Length;
        iSeferListesi[arrayLength--, 0] = pValidatorKey;
        iSeferListesi[arrayLength--, 1] = 1;
        //IN THIS PART ARRAY SIZE SHOULD BE INCREASED
        iSeferSayisi = iSeferListesi[arrayLength--, 1];
     }
     ViewState["SeferListesi"] = iSeferListesi;
     return iSeferSayisi;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:22:04.663

该`Length`属性返回数组中元素的总数。

使用[`GetLength(dimension)`方法](http://msdn.microsoft.com/en-us/library/system.array.getlength.aspx)获取维度的大小：

```
for (int i = 0; i < iSeferListesi.GetLength(0); i++) 
```

和：

```
int arrayLength = iSeferListesi.GetLength(0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T12:47:51.830

我认为你需要类似的东西：

```
// not tested
private int AracaAitSeferSayisiDondur(int pValidatorKey)
{
    var iSeferListesi = (Dictionary<int,int>)ViewState["SeferListesi"];
     if (iSeferListesi == null)
        iSeferListesi = new Dictionary<int,int>;

     int iSeferSayisi;

    if ( iSeferListesi.TryGetValue(pValidatorKey, out iSeferSayisi)
    {
       iSeferSayisi += 1;
       iSeferListesi[pValidatorKey] = iSeferSayisi;
       iSeferSayisi += 1;  // is this OK ??
    }
    else
    {
       iSeferSayisi = 1;
       iSeferListesi[pValidatorKey] = iSeferSayisi;
    }

    ViewState["SeferListesi"] = iSeferListesi;
    return iSeferSayisi;
} 
```

iSeferListesi 的双倍增量（源自您的代码）可能不是您想要的，没有它，if/else 逻辑会变得更加简单。

# java - 在 RichTextArea 中添加单选按钮

> ID：12661193
> 
> 赞同：0
> 
> 时间：2012-09-30T12:17:48.657
> 
> 标签：java, gwt

有一个 RichTextArea

```
private final RichTextArea rta = new RichTextArea(); 
```

我想当我按星号在这个 RichTextArea 中添加一个单选按钮时。

我写

```
 if(event.getCharCode()=='*')
   {            
     RadioButton radio0 = new RadioButton("group0", "");
     HorizontalPanel hp = new HorizontalPanel();
     hp.add(radio0);
     RootPanel.get().add(hp);
   } 
```

它从 RTA 中创建了一个单选按钮，但我无法在 RTA 中添加它，特别是光标所在的位置且没有星号。

知道怎么做吗？非常感谢您提前提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:38:08.467

你真的可以在富文本区域添加一个单选按钮吗！！！我真的不知道但如果可以，那么答案可能是：您已将单选按钮添加到根面板而不是富文本区域。

# php - 等待来自 apns 的错误，在 php 中具有增强的格式

> ID：12661194
> 
> 赞同：1
> 
> 时间：2012-09-30T12:18:32.747
> 
> 标签：php, stream, push-notification, apple-push-notifications

我们正在使用修改版的[easy-apns](http://www.easyapns.com/)来发送我们的推送消息。使用增强的推送消息格式，如果发生错误，Apple 服务器会做出响应，如果一切顺利，则不执行任何操作。

问题是我们必须在每条消息发送后等待错误一段时间。例如，如果我们在 1 秒后没有收到响应，我们假设一切正常。

对于 20000 条推送消息，这需要的时间太长了。有什么方法可以让我以更快的方式收听错误吗？例如发送到 1000 个设备然后监听错误？如果连接关闭会发生什么，我还能读取错误响应吗？

理想的是某种异步读写，但我认为这是不可能的。

下面是对应的代码：

```
 $fp = $this->connect();

    $expiry = time()+60*60;

    // construct message
    $msg = chr(1).pack("N",$batchid).pack("N",$expiry).pack("n",32).pack('H*',$devicetoken).pack("n",strlen($payload)).$payload;

    // send message to Apple
    $fwrite = fwrite($fp, $msg);

    if(!$fwrite) {
        // connection has been closed
        $this->disconnect();
        throw new Exception("Connection closed");

    } else {
        // read response from Apple

        // Timeout. 1 million micro seconds = 1 second
        $tv_sec = 1;
        $tv_usec = 0;

        $r = array($fp);
        $we = null; // Temporaries. "Only variables can be passed as reference."

        // PROBLEM: this method waits for $tv_sec seconds for a response
        $numChanged = stream_select($r, $we, $we, $tv_sec, $tv_usec);

        if( $numChanged === false ) {
            throw new Exception("Failed selecting stream to read.");
        } elseif ( $numChanged > 0 ) {

            $command = ord( fread($fp, 1) );
            $status = ord( fread($fp, 1) );
            $identifier = implode('', unpack("N", fread($fp, 4)));

            if( $status > 0 ) {

                // The socket has also been closed. Cause reopening in the loop outside.
                $this->disconnect();
                throw new MessageException("APNS responded with status $status: {$this->statusDesc[$status]} ($devicetoken).".microtime(), $status);

            } else {
                // unknown response, assume ok
            }

        } else {
            // no response, assume ok
        }
    } 
```

# eclipse - 从 ant 重命名 eclipse 项目

> ID：12661195
> 
> 赞同：0
> 
> 时间：2012-09-30T12:18:38.460
> 
> 标签：eclipse, ant

我正在寻找一个允许我执行诸如重命名 Eclipse 项目之类的 ant 任务，就像我单击“重构 > 重命名”一样（因此它会重命名目录和项目名称，并告诉工作区在哪里可以找到更新的项目）。

我依稀记得，有一些项目已经提供了这样的任务，但我再也找不到了（或者我只是做梦了？）

如果没有，那么我理想地寻找一个完整的示例如何实现这样的东西（包括我需要哪些库等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T21:02:16.537

我知道的两个具有 Eclipse 特定任务的现有 Ant 插件：

*   [Ant4Eclipse](http://www.ant4eclipse.org/)
*   [蚁蚀](http://sourceforge.net/projects/ant-eclipse/)

但我不知道他们是否为您的需求提供解决方案 - 从未使用过它们。
毕竟，您可能会使用一些低级方法，这意味着只需以
编程方式编辑 Eclipse 配置文件（.project ..）！？

# matlab - 为什么 matlab 的 psychtoolbox 在运行 AssertOpenGL 时无法检测到 Screen mexfile？

> ID：12661196
> 
> 赞同：0
> 
> 时间：2012-09-30T12:18:42.843
> 
> 标签：matlab

我已经成功地从 NeuroDebian 存储库安装了 psychtoolbox-3，没有任何明显的错误，但是运行 AssertOpenGL 会产生[这个](http://paste.ubuntu.com/1251588/)非常冗长的错误消息。

我的系统规格如下： 带有 Ubuntu 12.04 LTS 的基于 Intel 的 PC

我已经尝试将`~/Documents/MATLAB`其所有子目录添加到 Matlab pathdef，因为这是我将`DownloadAdditionsForNeuroDebian`函数指向的位置。同样，我也尝试将`/usr/share/octave/site/m/psychtoolbox-3/`它的子目录添加到 matlab 路径中。

该错误似乎源于对`Screen`;的失败调用 根据上面的错误信息，`Screen`找不到。话虽如此，我可以`Screen`在 Matlab 控制台上运行，尽管我收到此错误：

```
>> Screen

In place of the expected mex file this placeholder file was executed:

  Screen

This mex file seems to be missing or inaccessible on your Matlab path or it is dysfunctional:

  Screen.*

Hmm. I cannot find the file on your Matlab path?!?

One reason could be that your Matlab path is wrong or not up to date
for the current Psychtoolbox. You may want to run SetupPsychtoolbox to 
fix possible path problems.

??? Error using ==> AssertMex at 210
Missing or dysfunctional Psychtoolbox Mex file for this operating system. Read the help text above carefully!!

Error in ==> Screen at 161
AssertMex('Screen.m'); 
```

运行会`SetupPsychtoolbox`产生一个[与第一个非常相似的错误](http://paste.ubuntu.com/1251601/)。

我尝试安装建议的软件包，但它们都已经安装了——似乎没有任何效果。

我完全不知道从这里去哪里。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T23:27:29.657

SetupPsychtoolbox 命令似乎有一个错误。对您（以及对我来说，当我尝试此操作时）发生的事情是包含 Screen.mex 的文件夹被放置在搜索路径的底部。这是解决方法；

在 Matlab 命令行中输入“pathtool”

找到 PsychtoolboxAddons 条目并将其移到顶部（对我来说，这是 /usr/share/psychtoolbox-3/PsychtoolboxAddons）

如果您没有文件夹 PsychtoolboxAddons，您可能需要按照[http://docs.psychtoolbox.org/DownloadAdditionsForNeuroDebian上的说明进行操作](http://docs.psychtoolbox.org/DownloadAdditionsForNeuroDebian)

不要忘记将您的个人 Matlab 目录也移动到顶部（SetupPsychtoolbox 命令将您的个人目录移动到它的目录下面，这有点意思）。

保存路径。永远不要再运行 SetupPsychtoolbox！

祝你好运！

# mysql - 如何在 MySQL 中存储 Coldfusion #variable# 并从数据库中输出变量值（而不是变量名）？

> ID：12661200
> 
> 赞同：0
> 
> 时间：2012-09-30T12:19:17.227
> 
> 标签：mysql, variables, dynamic, coldfusion

我在跑步`Coldfusion8/MySQL 5.0.88`。

我的数据库中有两个表：

```
modules
textblocks 
```

我的网站运行多种语言，所以我在每个页面的开头都这样做，以根据用户选择的语言从数据库中加载文本块。

```
<cfquery datasource="#Session.datasource#" name="texte">
   SELECT *
   FROM textblocks
   WHERE lang = <cfqueryparam value = "#Session.lang#" cfsqltype="cf_sql_varchar" maxlength="2">  
</cfquery>
<cfoutput query="texte">
    <cfset "#trim(label)#" = "#trim(content)#">
</cfoutput> 
```

如果我需要一个文本块，我可以简单地使用`label`这样的：

```
<cfoutput>#tx_hello_world#</cfoutput> 
```

我的问题是包含模块列表的第二个表。

每个模块都有自己的描述（标题、子标题、信息、项目符号 1-5）。我必须遍历所有模块（25），所以我只是将它们存储`labels`在数据库中，希望做一个循环并`labels`从数据库中输出。不幸的是输出`label123`回报

```
 #label123# 
```

vs我希望

```
 "text from table textblocks stored at label123" 
```

**问题：**
是否可以在 MySQL 中存储“动态变量”并在输出这些变量时检索它们的基础值？如果不是，那么在一个循环中输出 25 个模块而不说“如果这是模块 A，则采用文本 tx_module_a_title，否则如果 ...”的更好方法是什么？

谢谢！

**编辑：**
所以我希望避免这个必须在每个循环上运行：

```
<cfif mods.module_name EQ "agents">
    <cfset variables.module_header = tx_module_b2b_agents_title>
    <cfset variables.module_subheader = tx_module_b2b_agents>
    <cfset variables.module_info = tx_module_b2b_agents_info>
    <cfset variables.module_bull_1 = tx_module_b2b_agn_accounts>
    <cfset variables.module_bull_2 = tx_module_b2b_agn_price_clients>
    <cfset variables.module_bull_3 = tx_module_b2b_agn_client_mgt>
    <cfset variables.module_bull_4 = tx_module_b2b_agn_create_retailer>
    <cfset variables.module_bull_5 = tx_module_b2b_exp_grace>
    <cfset variables.module_usage_tx = tx_vertreter/tx_gen_month>
<cfelseif mods.module_name EQ "preorder">
    <cfset variables.module_header = tx_module_b2b_preorder_title>
    <cfset variables.module_subheader = tx_module_b2b_preorder>
    <cfset variables.module_info = tx_module_b2b_preord_info>
    <cfset variables.module_bull_1 = tx_module_b2b_pre_split_type>
    <cfset variables.module_bull_2 = tx_module_b2b_pre_qty_y_n>
    <cfset variables.module_bull_3 = tx_module_b2b_pre_deliverydate>
    <cfset variables.module_bull_4 = tx_module_b2b_exp_grace>
    <cfset variables.module_bull_5 = "">
    <cfset variables.module_usage_tx = tx_gen_month >
<cfelseif mods.module_name EQ "export">
    <cfset variables.module_header = tx_module_b2b_export_title>
    <cfset variables.module_subheader = tx_module_b2b_export>
    <cfset variables.module_info = tx_module_b2b_export_info>
    <cfset variables.module_bull_1 = tx_module_b2b_exp_pricelists>
    <cfset variables.module_bull_2 = tx_module_b2b_exp_currencies>
    <cfset variables.module_bull_3 = tx_module_b2b_exp_customerlist>
    <cfset variables.module_bull_4 = tx_module_b2b_exp_regional_assortme>
    <cfset variables.module_bull_5 = tx_module_b2b_exp_grace>
    <cfset variables.module_usage_tx = tx_gen_month>
... 22 else-ifs to go
</cfif> 
```

`tx_`如果我可以将文本块存储在数据库模块记录中的值后面，我可以从那里检索它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:03:43.933

当您从数据库输出内容时，您可以使用`de()`并`evalaute()`在内容上处理变量。您可能需要使用嵌套组合。我忘记了确切的语法。 `De(evaluate('#var#'))`或类似的东西。

但是，如果您`#`的内容中有任何其他不是 var 的，这将证明是有问题的。我建议改用词典。请参阅本文[内容管理：处理动态内容](http://www.michaels.me.uk/post.cfm/content-management-processing-dynamic-content)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T15:08:51.793

假设您的 texte 查询中包含变量内容您可以执行以下操作：

```
<cfloopquery="texte">
    <cfset variables[trim(texte.label)] = trim(texte[content][texte.currentrow])>
</cfloop> 
```

您的查询是一个结构，您可以像另一个结构一样引用它，您可以使用内置的 currentrow 属性来引用结构中的 currentrow

重新阅读您的问题后，看起来上下文存储在模块表中？那你就可以了。无论哪种方式，您都应该尽可能避免使用评估，尽管这会起作用。

```
<cfloop query="texte">
  <cfloop query="modulesquery">
    <cfset variables[trim(texte.label)] = trim(modulesquery[content][modulesquery.currentrow])>
 </cfloop>
</cfloop> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T18:07:39.230

我只关注这一点：

> 问题：是否可以在 MySQL 中存储“动态变量”并在输出这些变量时检索它们的基础值？

我可能会做的是将文本存储为文件，并将文件的路径存储在数据库中。然后，当您需要让 CF 处理文件时——这是解析变量的唯一方法——只需从数据库中提取路径，并将文件包含在该路径中。

如果文本需要进入数据库，那么您需要从数据库中读取它，将其写入文件，然后包含该文件。要处理 CF 变量，它需要由 CF 处理，为此，您需要将文件传递给 ColdFusion。而已。

但是，到处写文件并在每次需要时都包含它们会很慢，因为文件需要在运行之前进行编译，并且编译过程相对较慢。

解决此问题的方法是仅在文件更改时写入文件，而不是每次需要时写入。在大多数网站上，数据的读取频率比更改的频率高出几个数量级，这取决于网站的工作方式。

# javascript - Javascript/jQuery 函数返回值为空

> ID：12661202
> 
> 赞同：-2
> 
> 时间：2012-09-30T12:19:25.493
> 
> 标签：javascript, jquery, api, youtube, jquery-data

> **可能重复：**
> [jQuery AJAX：成功时返回值](https://stackoverflow.com/questions/9055810/jquery-ajax-return-value-on-success)

我正在尝试从 YouTube 数据 API 加载歌曲列表，并且一直成功，直到我将其分解为它自己的函数。

问题在于当我将局部变量返回给调用函数时，它的值会蒸发。基本上，当我尝试使用它时，当它有值时它是一个空数组。有人知道会发生什么吗？

```
function LoadSongList(feed){
    songList = new Array();
    $.getJSON(feed, function(data){

        if (data['feed']) {
            $.each(data['feed']['entry'], function(i, entry){
                songList.push({
                    videoID: entry.media$group.yt$videoid.$t,
                    title: entry.title.$t,
                    tumbnailUrl: entry.media$group.media$thumbnail[0].url,
                    author: entry.author[0].name.$t
                });

            });
        }

    });
    return songList;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T12:22:25.787

你应该提供一个回调方法。`$.getJSON`是异步方法，您试图`songList`在调用成功方法之前返回。

```
function LoadSongList(feed, callback){
    songList = new Array();
    $.getJSON(feed, function(data){

        if (data['feed']) {
            $.each(data['feed']['entry'], function(i, entry){
                songList.push({
                    videoID: entry.media$group.yt$videoid.$t,
                    title: entry.title.$t,
                    tumbnailUrl: entry.media$group.media$thumbnail[0].url,
                    author: entry.author[0].name.$t
                });

            });
          callback(songList);
        }
    });
} 
```

调用为：

```
LoadSongList(feed, function(songList){
  // your code 

}); 
```

# java - 检索上周一和周五日期的最佳方法是什么

> ID：12661203
> 
> 赞同：12
> 
> 时间：2012-09-30T12:19:42.930
> 
> 标签：java, date, datetime, calendar

我需要得到上周星期一和星期五的日期。为此，我得到本周星期一的日期并减去 7 天。这给了我上周星期一的日期。

要获得星期五的日期，我必须添加 4。这让我有点困惑，因为出于某种原因，一周的第一天是星期日，而不是英国的星期一。

无论如何，这就是我获取日期的方式。

```
 // Get the dates for last MON & FRI
        Calendar cal = Calendar.getInstance();
        cal.setTime(date);

        cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
        cal.add(Calendar.DAY_OF_WEEK, -7);

        cal.set(Calendar.HOUR_OF_DAY,0);
        cal.set(Calendar.MINUTE,0);
        cal.set(Calendar.SECOND,0);
        cal.set(Calendar.MILLISECOND,0);

        // Get the date on Friday
        cal.add(Calendar.DAY_OF_WEEK, 4);

        cal.set(Calendar.HOUR_OF_DAY,23);
        cal.set(Calendar.MINUTE,59);
        cal.set(Calendar.SECOND,59);
        cal.set(Calendar.MILLISECOND,0); 
```

以上有效，但如果逻辑有任何问题，我很感兴趣。即它适用于二月，闰年等。

随意提出更好的解决方案/方法。

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-09-19T19:47:35.580

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-30T12:44:56.703

**注意：**对于 Java 8 及更高版本，请查看[Basil Bourque](https://stackoverflow.com/users/642706/basil-bourque)的回答（[链接](https://stackoverflow.com/a/39580958/1288408)）。
Java 8 引入了一个新的时间/日期 API，它提供了 Joda-Time 的大部分功能。

* * *

[Joda-Time](http://www.joda.org/joda-time/)为此类问题提供了非常好的方法。

使用 Joda Time 获取上周星期一和星期五的日期看起来像这样：

```
DateTime today = DateTime.now();
DateTime sameDayLastWeek = today.minusWeeks(1);
DateTime mondayLastWeek = sameDayLastWeek.withDayOfWeek(DateTimeConstants.MONDAY);
DateTime fridayLastWeek = sameDayLastWeek.withDayOfWeek(DateTimeConstants.FRIDAY); 
```

您可以`DateTime`从`java.util.Date`对象创建对象，反之亦然，因此很容易与 Java 日期一起使用。

* * *

使用上面的代码和日期

```
DateTime today = new DateTime("2012-09-30"); 
```

结果为星期一的“2012-09-17”和星期五的“2012-09-21”，将日期设置为

```
DateTime tomorrow = new DateTime("2012-10-01"); 
```

结果为星期一的“2012-09-24”和星期五的“2012-09-28”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-30T13:16:35.407

您仍然将一周开始设置为星期日，这意味着`Calendar.MONDAY`星期六是前星期一，而`Calendar.MONDAY`星期日是第二天。

您需要做的是（根据您上面的评论根据您想要的方式），将一周的开始设置为星期一。

```
Calendar cal = Calendar.getInstance();
cal.setFirstDayOfWeek(Calendar.MONDAY);

cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
cal.add(Calendar.DAY_OF_WEEK, -7); 
... 
```

除此之外，并且星期五的最后一秒不包括在范围内，您的逻辑似乎是合理的，并且在闰年/夏令时转变等方面应该没有问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T12:27:17.190

我唯一看到的错误是您实际上是在测试Mo-Fr的**范围，而不是如前所述，检索两个特定的日子。**使用专属上限测试 Mo-Sa 范围会更安全。

# html - Python Sphinx 中的 RTL 支持

> ID：12661206
> 
> 赞同：14
> 
> 时间：2012-09-30T12:20:01.970
> 
> 标签：html, python-sphinx, right-to-left

[有没有办法在Sphinx](http://sphinx.pocoo.org/)中使用 RTL（从右到左，如波斯语、阿拉伯语……）文本？

从 .rst 文件生成 HTML 时，生成的 HTML 是 LTR（默认情况下从左到右）并左对齐，我的问题是如何更改它，使其 RTL 并右对齐。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:52:48.053

你可以查看 python 的 docutils [FAQ](http://docutils.sourceforge.net/FAQ.html#can-i-produce-documents-in-right-to-left-languages)。它解释了如何使用 css 和类来标记文本方向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-04-23T15:42:46.350

您可以尝试支持 RTL 语言（如波斯语）的[Minoo](https://github.com/saeiddrv/SphinxMinooTheme)主题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-02T23:37:06.097

如[this answer](https://stackoverflow.com/a/13693907/886607)中所述，您可以使用css。在[将文本放在中心](https://stackoverflow.com/a/33132104/886607)和[从右到左编号问题](https://stackoverflow.com/q/36847050/886607)中，我提到您可以使用 rtl 和 ltr 等类名来更改文本的方向。[我的网站](http://yoosofan.github.io)由[Nikola](https://getnikola.com)提供支持。[我的波斯 gitlab 指导项目](https://gitlab.com/yoosofan_course/Farsi_gitlab_guide)更简单，更易读。特别[是 farsi.css](https://gitlab.com/yoosofan_course/Farsi_gitlab_guide/blob/master/farsi.css)和[README.rst](https://gitlab.com/yoosofan_course/Farsi_gitlab_guide/raw/master/README.rst)的最后一行可能更有帮助。

# c# - 在 Windows 8 中播放铃声？

> ID：12661207
> 
> 赞同：1
> 
> 时间：2012-09-30T12:20:02.170
> 
> 标签：c#, windows-8, microsoft-metro

我需要能够在 Windows 8 中播放“叮”声（一种逐渐淡出的哔声），类似于此处所见：http: [//tonematrix.audiotool.com/](http://tonematrix.audiotool.com/)

是否有可能在给定频率的情况下以某种方式播放这个？或者我可以在任何地方为此下载声音文件吗？

我注意到它`SoundPlayer`不再起作用了，所以我在桌面程序中使用的旧代码将不再起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T12:21:25.987

如果您有它的声音文件，例如 mp3 或 wav，请使用[MediaElement](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.mediaelement)控件。有几种方法可以做到这一点。例如，将[Source](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.mediaelement.source.aspx)属性设置为 URL（Uri 类）或调用[SetSource()](http://msdn.microsoft.com/en-us/library/windows/apps/br244338.aspx)然后调用[Play](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.mediaelement.play.aspx)方法。

Windows 8 不包含生成音调或音高的简单方法（假设您指的是 Metro/Windows Store 应用程序）。如果您可以生成播放声音所需的字节，请将它们放在缓冲区中，为其创建一个[IRandomAccessStream](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.streams.irandomaccessstream.aspx)，然后将其传递给 SetSource。您可以通过使用计时器设置[音量](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.mediaelement.volume.aspx)来模拟淡出。

如果有可以与[SetAudioEffect](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.mediaelement.addaudioeffect)一起使用的“淡出”音频效果会很好，但微软[目前不提供任何音频效果](http://social.msdn.microsoft.com/Forums/nl-NL/winappswithcsharp/thread/357e9fc8-7fa6-4790-b29f-6b25644a08c8)。

# python - 似乎无法让 pyqt 倒数计时器工作

> ID：12661211
> 
> 赞同：1
> 
> 时间：2012-09-30T12:20:56.053
> 
> 标签：python, timer, qt4, pyqt

我已经在互联网上搜索了几天，但可以弄清楚如何让这段代码工作。这是一个非常简单的 gui（在 Qt Designer 上制作），带有一个 lcd 和一个按钮。我希望它在按下按钮时从 180 秒开始倒计时。在第一刻，我能够使按钮减少一个值，但是在尝试了这么多不同的东西之后，没有任何效果。有人能帮助我吗？可能是非常简单的事情。谢谢你。

```
# -*- coding: utf-8 -*-
import sys
import time
from PyQt4 import QtCore, QtGui
from relogio import Ui_relogiocc

class StartQT4(QtGui.QMainWindow):
 def __init__(self, parent=None):
  QtGui.QWidget.__init__(self, parent)
  self.ui = Ui_relogiocc()
  self.ui.setupUi(self)
  self.timer = QtCore.QTimer()
  text = "%d:%02d" % (180/60,180 % 60)
  self.ui.QLCDNumber.display(text)
  self.timer.start(1000)
  self.ui.iniciar.clicked.connect(self.updateTimerDisplay)

 def updateTimerDisplay(self):
  self.inicio = 180
  while self.inicio != 0:
   text = "%d:%02d" % (self.inicio/60,self.inicio % 60)
   self.ui.QLCDNumber.display(text)
   self.inicio - 1
  else:
   self.timer.stop()  

if __name__ == "__main__":
 app = QtGui.QApplication(sys.argv)
 myapp = StartQT4()
 myapp.show()
 sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:10:42.657

正如其他答案中所说，您的代码包含一些明显的错误。在这里，您有一个完整的工作示例（UI 不是通过设计器创建的），每次单击按钮时都会正确重置计数器（即在再次启动之前停止计时器。如果您不这样做并`Start`在计时器已停止，然后每次单击按钮时计数器计数得更快）。

```
from PyQt4.QtGui import *
from PyQt4.QtCore import *

class MyMainWindow(QMainWindow):
    def __init__(self, parent=None):
        QMainWindow.__init__(self, parent)

        self.central = QWidget(self)
        self.hbox = QHBoxLayout(self.central)
        self.lcd = QLCDNumber(self.central)
        self.timer = QTimer(self)
        self.start_time = 20
        self.lcd.display("%d:%02d" % (self.start_time/60,self.start_time % 60))
        self.start_button = QPushButton("Start", self.central)
        self.hbox.addWidget(self.lcd)
        self.hbox.addWidget(self.start_button)
        self.setCentralWidget(self.central)

        self.start_button.clicked.connect(self.restartTimer)
        self.timer.timeout.connect(self.updateLCD)

    def restartTimer(self):
        # Reset the timer and the lcd
        self.timer.stop()
        self.start_time = 20
        self.lcd.display("%d:%02d" % (self.start_time/60,self.start_time % 60))
        # Restart the timer
        self.timer.start(1000)

    def updateLCD(self):
        # Update the lcd
        self.start_time -= 1
        if self.start_time >= 0:
            self.lcd.display("%d:%02d" % (self.start_time/60,self.start_time % 60))
        else:
            self.timer.stop()

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    ui = MyMainWindow()
    ui.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:23:09.710

It seems there are a number of things you are missing here.

Firstly, the timer emits a `timeout()` signal whenever each timeout period completes. In your case, this is every one second. However, you're not connecting this signal to anything.

Secondly, your `updateTimerDisplay` contains the following line:

```
 self.inicio - 1 
```

This reads the value of `self.inicio`, subtracts 1 from it and then throws the result away. Because `self.inicio`'s value doesn't change your `updateTimerDisplay` method goes into an infinite loop.

I'm guessing you meant

```
 self.inicio -= 1 
```

instead, which assigns the new value of `self.inicio` back to itself.

Ultimately, however, it seems you're trying to use your `updateTimerDisplay` method to start the timer, count it down and also update the display of the timer. I'd recommend breaking this method up to smaller methods.

Firstly, `updateTimerDisplay` should only update the display of the timer:

```
 def updateTimerDisplay(self):
  text = "%d:%02d" % (self.inicio/60,self.inicio % 60)
  self.ui.QLCDNumber.display(text) 
```

Secondly, you'll want a method to start the timer. Something like the following should do:

```
 def startTimer(self):
  self.inicio = 180
  self.updateTimerDisplay()
  self.timer.start(1000) 
```

Of course, you'll also need to connect your `iniciar` button's `clicked()` signal to this function, instead of to `updateTimerDisplay`.

Finally, you'll need a method that handles a tick from the timer. Something like the following should do:

```
 def timerTick(self):
  self.inicio -= 1
  self.updateTimerDisplay()
  if self.inicio <= 0:
   self.timer.stop() 
```

You'll also need to connect the `timeout()` signal of the timer to this function, using something like:

```
 self.timer.timeout.connect(self.timerTick) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:22:42.030

There are multiple things wrong with your code. For starters, you wrote `self.inicio - 1` instead of `-= 1`, and you never actually use the `Qtimer` you create. But ignoring that, the structure of your program isn't right: Currently you call `updateTimerDisplay` when the user clicks your `iniciar` button and loop in there until your countdown reaches zero. What you want to do is start the timer when the user clicks the button and connect the timer (actually its `timeout` signal) to a method that just counts down one second and updates the display:

```
def startTimerDisplay(self):
    """ set the countdown value and start the timer """
    self.inicio = 180
    self.timer.start(1000)

def updateTimerDisplay(self):
    """ count down one second, set the text, and check if the timer should stop """
    self.inicio -= 1
    text = "%d:%02d" % (self.inicio/60,self.inicio % 60)
    self.ui.QLCDNumber.display(text)
    if self.inicio == 0:
        self.timer.stop() 
```

Alter your `__init__` method to connect these functions like this:

```
def __init__(self, parent=None):
    QtGui.QWidget.__init__(self, parent)
    self.ui = Ui_relogiocc()
    self.ui.setupUi(self)
    self.timer = QtCore.QTimer()
    text = "%d:%02d" % (180/60,180 % 60)
    self.ui.QLCDNumber.display(text)
    #connect the button to the start method ...
    self.ui.iniciar.clicked.connect(self.startTimerDisplay)
    #... and the timer to the update method
    self.timer.timeout.connect(self.updateTimerDisplay) 
```

# android - Facebook Util.java 没有登录 eclipse logcat

> ID：12661223
> 
> 赞同：2
> 
> 时间：2012-09-30T12:23:22.977
> 
> 标签：android, facebook, facebook-android-sdk, facebook-authorization

我正在研究 facebook sso android。我遇到了 keyhash 问题（[使用 facebook android sso 时出现白色空白屏幕](http://facebook.stackoverflow.com/questions/12660230/white-blank-screen-on-using-facebook-android-sso)）。Facebook 的 android 指南说要编辑 sdk 的 Uti.java`private static boolean ENABLE_LOG = true;`我已将其设置为 true。但是，logcat 中没有带有标签 Android Key Mismatch 的日志，其中显示了哪个密钥被发送到 facebook。请帮忙。

# c# - 实体框架：关系的元数据信息

> ID：12661226
> 
> 赞同：0
> 
> 时间：2012-09-30T12:24:18.293
> 
> 标签：c#, entity-framework

有没有办法获取关系的元数据信息？

```
public partial class Contact
{
    public Contact()
    {
        this.Addresses = new HashSet<Address>();
    }

    public int Id { get; set; }
    public virtual ICollection<Address> Addresses { get; set; }
}

public partial class Address
{
    public int Id { get; set; }
    public int? ContactId { get; set; }
} 
```

实体框架如何知道 ContactId 是外键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:46:27.483

没有元数据，它是按照惯例完成的，在下面的博客文章中你可以找到更多信息：

[代码优先的约定](http://blogs.msdn.com/b/efdesign/archive/2010/06/01/conventions-for-code-first.aspx)

可以通过使用属性装饰属性来添加元数据，但这不是必需的。

# ios - 检查设备锁定并验证证书

> ID：12661227
> 
> 赞同：1
> 
> 时间：2012-09-30T12:24:35.770
> 
> 标签：ios, ipad, security

对于我的一个 iOS 应用程序，我需要检查两件事：

*   是否有活动设备锁（密码）
*   设备锁定是否由正确的授权/证书（例如我自己的证书）触发。这是确保特定安全准则所必需的。

对于我的问题的第一部分，我找到[了这个](https://stackoverflow.com/a/6195643)答案——这对我来说已经足够了。你将如何完成第二部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T20:42:31.083

回答我自己的问题。

首先，正确的问题不是关于证书的验证。这是关于验证配置文件中的元信息（在我的情况下，它提供了设备锁定的安全指南）。

您必须创建一个自定义 CA 并颁发一个证书。颁发的证书必须放在您的应用程序中，自定义 CA 的证书进入配置文件。

如果安装了配置文件，则可以检查应用程序二进制文件中的证书是否使用放置在配置文件中的根证书进行签名。

这不是最安全的解决方案，但绝对是一种方法。

--

[这篇](https://devforums.apple.com/message/665263#665263)文章让我进入了正确的方向（需要 Apple 开发者帐户）。

# objective-c - 我们可以为视图控制器创建一个 IBOutlet

> ID：12661232
> 
> 赞同：0
> 
> 时间：2012-09-30T12:26:03.720
> 
> 标签：objective-c, storyboard, xcode4.3

我有一个视图控制器。该 viewController 有一个包含另一个控制器的 containerView。列表和地图。

我希望用户能够通过按钮在列表和地图之间切换。

这意味着父视图控制器（或某人）需要能够同时引用 mapViewController 和 ListViewController。

我怎样才能做到这一点？

一种方法是使用 instantiateViewControllerWithIdentifier。但是，我不喜欢标识符。标识符容易出现输入错误和冲突。我喜欢奥特莱斯

我读到这样做的一种可能方法是设置一个storyboardid。如果我喜欢旧的好插座怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:49:24.407

As I understand it, you have to sub view controllers. What I would do is create a master controller class, which imports all of the other view controllers (think of it as the super class of the entire project) which will then control a empty view, less a button. The background of the empty view will be fed by an "active" view, which will be supplied by either listViewController.h or mapViewController.h This will let the users use both the list/map VC's, and be able to switch between the two.

# java - GetTileID() 抛出数组异常

> ID：12661233
> 
> 赞同：0
> 
> 时间：2012-09-30T12:26:21.430
> 
> 标签：java, arrays, bounds

我在我正在控制的游戏中有一个角色，我正试图用它`getTileId()`来获取他周围瓷砖的瓷砖 id。我正在使用 TilED 地图编辑器和 slick2d。这是我的代码：

```
int tileID = map.getTileId(idX, idY, 0);        
System.out.println("Id: "+tileID); 
```

地图：

```
public TiledMap map; 
```

哪个进口自：

```
import org.newdawn.slick.tiled.TiledMap; 
```

`idX`和`idY`设置为零，是我角色的坐标。我收到此错误：

```
java.lang.ArrayIndexOutOfBoundsException: 188
at org.newdawn.slick.tiled.Layer.getTileID(Layer.java:137)
at org.newdawn.slick.tiled.TiledMap.getTileId(TiledMap.java:228)
at tile.Game.update(Game.java:144)
at org.newdawn.slick.GameContainer.updateAndRender(GameContainer.java:657)
at org.newdawn.slick.AppGameContainer.gameLoop(AppGameContainer.java:408)
at org.newdawn.slick.AppGameContainer.start(AppGameContainer.java:318) 
```

我的错误是什么意思，但我不知道为什么我会得到它。我现在的代码中没有一个数组。谁能给我一些帮助？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:12:57.493

Java 堆栈跟踪非常有用且易于理解，我无法解释您的困惑。**您**不使用数组，但跟踪说明`map.getTileId()`调用`Layer.getTileID()`并且它**确实使用数组**（[链接](https://bitbucket.org/liamzebedee/slick/src/e6fe92be50cc/trunk/Slick/src/org/newdawn/slick/tiled/Layer.java#cl-152)到源代码）：

```
public int getTileID(int x, int y) {
        return data[x][y][2];
} 
```

因此，要么 要么`idX`保留`idY`在`188`您的通话中。如果不访问您的完整代码，我们无法说明**原因**，但是您的字符存在问题：您*认为*它在 `(0, 0)`bun 实际上不是。可能是竞争条件或 API 误用，或者对象初始化不当：我们不能说，但至少你知道在哪里寻找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T09:47:24.060

我知道这是旧的。但是，我也遇到了这个问题，我修复它的方法是将玩家坐标除以图块大小，因为地图是图块数组。

例子：

```
int tileID = map.getTileId(playerX / TILE_SIZE, playerY / TILE_SIZE, 0); 
```

# c - 如何在 Xcode 中清除屏幕

> ID：12661234
> 
> 赞同：1
> 
> 时间：2012-09-30T12:26:40.650
> 
> 标签：c, xcode, screen

我曾经`#include <conio.h>`在.`clrscr ()``C`

`system("cls")`是一样的。我试过了，但它在`Xcode`.

那么如何清屏`Xcode`呢？

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T12:44:31.860

system("clear") 应该在终端上工作，在 xcode 中可能不行。

检查此线程中的帖子 #10 -> [http://forums.macrumors.com/showthread.php?t=173777](http://forums.macrumors.com/showthread.php?t=173777)

（这将是一个评论，但我还没有声誉）

# java - 如何使用 SAX 解析器检查 XML 属性是否存在？

> ID：12661244
> 
> 赞同：1
> 
> 时间：2012-09-30T12:28:36.500
> 
> 标签：java, android, xml, sax

我给了一个 XML 文件，一个标签包含许多属性。然而，其中一个有时会被跳过。示例：

```
<data>
    <item attribute0="value 0" attribute1="value 1" attribute2="value 2">
    <item attribute0="value 0" attribute1="value 1">
    <item attribute0="value 0" attribute1="value 1" attribute2="value 2">
</data> 
```

我正在使用 SAX 解析器来处理这个文件，并且在一个`startElement`方法中我获取了所有属性的值，但在获取之前`attribute2`我需要检查它是否存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:41:21.750

*您可以使用getIndex(name)*或*getIndex(uri, localName)*检查属性是否存在。如果它返回 -1，则该属性不存在。请参阅[getIndex javadoc](http://developer.android.com/reference/org/xml/sax/Attributes.html#getIndex%28java.lang.String%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-18T16:31:30.903

我的答案建立在 Javanator 的答案之上，使用 SAX Parser。

您可以通过以下方式检查属性是否为空：

```
if (item.getAttribute("attribute2").isEmpty()) { } 
```

> 公共布尔 isEmpty()
> 
> 返回：如果 length() 为 0，则返回 true，否则返回 false

询问是否存在特定属性的另一种方法是：

```
if (item.hasAttribute("attribute2")) { } 
```

> boolean hasAttribute（字符串名称）
> 
> 如果在此元素上指定了具有给定名称的属性或具有默认值，则返回 true，否则返回 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T12:47:53.407

这个链接是 SAXParser 的一个很好的例子

[http://java-samples.com/showtutorial.php?tutorialid=152](http://java-samples.com/showtutorial.php?tutorialid=152)

在 startElement 委托中，我们通常去读取 Attributes(org.xml.sax.Attributes)

```
//Event Handlers
public void startElement(String uri, String localName, String qName,
    Attributes attributes) throws SAXException {
 // Read Attributes Here    
} 
```

首先你也可以找

```
attributes.getLength() 
```

确保您是否在提要中获得所需数量的属性的方法

真正可取的是，您不应该担心这些和代码，就好像您会得到所有。

**如果**

```
 attributes.getValue("blahblah"); 
```

**给出空值。这意味着它不存在。**

并且您将 null 直接填充到您的数据对象中，并在代码本身中使用它们时采取预防措施。（空检查等）

希望能帮助到你 ：）

# c++ - 为什么我不能编译这个开源项目

> ID：12661248
> 
> 赞同：0
> 
> 时间：2012-09-30T12:29:11.660
> 
> 标签：c++, visual-studio-2010, directx

我使用 tar 球[http://construct.svn.sourceforge.net/viewvc/construct/?view=tar从](http://construct.svn.sourceforge.net/viewvc/construct/?view=tar)[http://construct.svn.sourceforge.net/viewvc/construct/](http://construct.svn.sourceforge.net/viewvc/construct/)下载了源代码

我在 VS2010 中转换的 IDE 子目录中有一个 Visual Studio 解决方案文件。编译时出现 56 个错误，例如

> 错误 1 ​​错误 C1083：无法打开包含文件：'d3dx9.h'：没有这样的文件或目录 C:...\construct\construct\ide\stdafx.h 106 1 Construct

为什么？怎么修？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T12:31:57.400

很可能您没有安装 DirectX SDK 和/或包含项目目录（或 VS 中的全局设置）未正确设置。

这有帮助吗：[无法打开包含文件“d3dx9.h”](https://stackoverflow.com/questions/4931151/cannot-open-include-file-d3dx9-h)

# jquery - jQuery 的 .data() getter 只获取最初设置为值的元素

> ID：12661249
> 
> 赞同：0
> 
> 时间：2012-09-30T12:29:32.977
> 
> 标签：jquery

...但是如果该值最初为空，例如“”，则无法使用相同的键更改该值！

```
function loadDialog(link, e, ajaxRequest) {

    e.preventDefault();
    var $title = link.innerHTML;
    var $contenturl = $(link).attr('href');
    var $dialog = $('<div id="MyDialog"></div>');

    // Read value from hidden input field
    var templateIdValue = $('input[name=TemplateId]').val();     

    // Change the value: This will always and only happen the 2nd time I come here,
    // the first time the templateIdValue will always be empty
    if (templateIdValue != '') {
        templateIdValue = 777;
    }

    $dialog.load($contenturl).data('templateIdKey', templateIdValue).dialog({
        title: $title,
        autoOpen: true,
        modal: true,               
        buttons: {
            "OK": function () {debugger;
                ajaxRequest($(this), $('form', this));
            },
            "Cancel": function () {
                $dialog.dialog("close");
            }
        }
    });
} 
```

当第二次 templateIdValue 更改为 777

我来到这段代码：

在这里，我再次检索该值，它应该是 777。但它不是。它是空的 ！

```
@model ITMS.Web.Models.UnitViewModel

@*Remote Validation*@
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

<script type="text/javascript">

    $(document).ready(function () {
        var templateId = $('#MyDialog').data('templateIdKey');
        $('input[name=TemplateId]').val(templateId);      
    }); 

</script>

@using (Html.BeginForm("Create", "Unit"))
{ 
     @Html.ValidationSummary(false)
    <p class="editor-label">@Html.LabelFor(model => model.Name)</p>
    <p class="editor-field">@Html.EditorFor(model => model.Name)</p>
    <p class="editor-field">@Html.ValidationMessageFor(model => model.Name)</p> 

    @Html.HiddenFor(x => x.TemplateId)    
} 
```

如何更改第一次使用 .data() 方法传递的键的值？

**更新**

```
 // Does not cache the ajax requests to the controller e.g. IE7/8/9 is doing that...
    $.ajaxSetup({ cache: false });

    $(document).ready(function () {
        $('#OpenTemplate').click(function (event) { loadDialog(this, event, openTemplate); });
        $('#CreateTemplate').click(function (event) { loadDialog(this, event, createTemplate); });
        $('#DeleteTemplate').click(function (event) { loadDialog(this, event, deleteTemplate); });

        $('#CreateUnit').click(function (event) { loadDialog(this, event, createUnit); });
        $('#DeleteUnit').click(function (event) { deleteUnit(); });

        $('#CreateTeststep').click(function (event) { loadDialog(this, event, createTeststep); });
        $('#DeleteTeststep').click(function (event) { deleteTeststep(); });

        $('#SaveTemplate').click(function (event) { saveTemplate(); });    
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T13:27:29.617

即使在更新之后，我也发现您的问题相当令人困惑，因此我仍然不太了解您要做什么，但是您使用的方式似乎存在两个大问题`.data()`。

第一个问题是您在文档就绪处理程序中检索值：

```
$(document).ready(function () {
    var templateId = $('#MyDialog').data('templateIdKey'); 
```

...但是在调用该函数以响应单击之前不会存储该值，`loadDialog()`因此由于尚未处理任何单击，因此当时自然可能没有针对该键的数据。

其次，`loadDialog()`每次单击几个元素中的任何一个时都会调用相同的函数，但每次`loadDialog()`调用它都会创建一个新的`"MyDialog"`div，然后用于`.data()`将键和值与该新 div 关联：

```
var $dialog = $('<div id="MyDialog"></div>');
// other code, then
$dialog.load($contenturl).data('templateIdKey', templateIdValue) 
```

同样，您的问题并不清楚，但您*似乎*在说您希望这会更新为先前创建的`"MyDialog"`div 存储的值，但`.data()`会将值与单个元素关联。为什么每次都重新创建对话框 div？

# jquery - 使用异步 JQuery 请求和 RavenDB 将大量行加载到 SlickGrid

> ID：12661250
> 
> 赞同：1
> 
> 时间：2012-09-30T12:29:46.603
> 
> 标签：jquery, coffeescript, ravendb, slickgrid

我需要将 > 10k 行数据加载到[SlickGrid](https://github.com/mleibman/SlickGrid/wiki)

我相信 SlickGrid 是专为这种用途而设计的，基于以下加载 500,000 个客户端行的官方示例：[优化 DataView](http://mleibman.github.com/SlickGrid/examples/example-optimizing-dataview.html)

由于我不能违反 RavenDB 规定每个会话查询返回少于 1024 行的“安全第一”规则，因此我使用了 RavenDB 的 skip-take 机制，该机制允许 Web 客户端以 256 行的字节大小块从服务器收集所有 10K 行每个http请求。

我的问题是：当这些行从服务器返回时，将它们输入 SlickGrid 的最佳方法是什么？SlickGrid 是否积极支持像这样的分块数据子集的异步加载？

我在寻找：

1.  允许我发出下一个服务器请求的 SlickGrid 回调。
2.  一种将结果行一次性附加到 DataView 中的优化方式，例如

`grid.appendRows(rowSubset)`

[SlickGrid RemoteModel 与 Dataview 模型](https://stackoverflow.com/q/9706833/776476)表明，SlickGrid 设计用于处理大型客户端数据集或更常见的网格*按需页面*服务器模型。我想使用以前的客户端方法，因为它可以带来卓越的用户体验，恕我直言。

**免责声明**：我知道我正在加载大量行，并且通常的方法是根据需要简单地从服务器请求每个页面。无论这种方法多么值得称赞，这都不是我想要实现的目标。相反，我故意尝试以不会给用户带来不便的方式从服务器加载整个数据集。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T19:28:55.523

好的，SlickGrid 没有任何内置功能，所以我们必须自己滚动它。这是stackoverflow的一个答案：

*   [SlickGrid AJAX 数据](https://stackoverflow.com/questions/6668613/slickgrid-ajax-data)

现在这是我的解决方案，它很有效，我认为这很容易。这方面的技术栈是：

*   乌鸦数据库
*   南希FX
*   咖啡脚本
*   SlickGrid

**咖啡脚本**

```
loadData=(grid)->
    take = 600
    loadingGlyph = $ "<img/>", {class:"loading", style:"float:right;margin-top:5px", src:"/Content/img/ajax-loader.gif", alt:"loading", width:"16", height:"16"}
    $(".slick-pager-status").after loadingGlyph
    for skip in [0..viewdata.UserCount] by take
        $.getJSON("/users/#{skip}/#{take}")
        .done (users) =>
            grid.addRows users
            $(".loading").hide() if users.length < take

$ -> 
    columns = [..your columns..]
    grid = [..your slick-grid..]
    loadData grid 
```

首先，我贴上一个精美的加载字形图形来显示网格很忙。请注意，我打算异步加载批量数据。这将很快将网格置于可用状态（在第一批返回后），但需要告知用户数​​据仍在后台下载。

为了批量加载数据，我以块的形式循环，其大小由值确定`take`并终止于该`viewData.UserCount`值。这已在请求页面时预先填充，并且是可用项目的总数（或您希望加载的最大值）。

最后，我使用了`addRows`添加到我的 slick-grid 包装器中的方法（未显示）。这允许快速添加行批次，它看起来像这样：

**扩展 Slick-Grid**

```
addRows:(rows)->
    dataView.beginUpdate()
    dataView.addItem row for row in rows 
    dataView.endUpdate() 
```

为了完整起见，这里是其余的过程，包括进行批量数据检索的 RavenDB 服务调用。

**NancyFX 模块**

```
Get["/users/{skip}/{take}"] = parameters =>
{
    var skip = (int)parameters.skip;
    var take = (int)parameters.take;
    var data = UserService.GetForGrid(Db, skip, take);
    return Response.AsJson(data);
}; 
```

**RavenDB 服务**

```
public static List<UserGridDTO> GetForGrid(IDocumentSession db, int skip=0, int take=512)
{
    return db.Query<User>()
        .OrderBy(u=>u.Id)
        .Skip(skip)
        .Take(take)
        .ToList()
        .Select(user =>
                        new UserGridDTO
                        {
                                id = user.Id,
                                Email = user.Email,
                                Name = user.DisplayName,
                        })
                        .ToList();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T02:57:49.980

SlickGrid 不包含任何用于加载或保存数据的内置功能（不包括示例 slick.remotemodel.js，它只是作为如何使用 SlickGrid API 的示例）。这取决于实现 SlickGrid 的开发人员。

# django - 如何使用 Django 进行“批量更新”？

> ID：12661253
> 
> 赞同：206
> 
> 时间：2012-09-30T12:30:07.353
> 
> 标签：django, django-models

我想用 Django 更新一个表——在原始 SQL 中是这样的：

```
update tbl_name set name = 'foo' where name = 'bar' 
```

我的第一个结果是这样的——但这很讨厌，不是吗？

```
list = ModelClass.objects.filter(name = 'bar')
for obj in list:
    obj.name = 'foo'
    obj.save() 
```

有没有更优雅的方式？

* * *

## 回答 #1

> 赞同：321
> 
> 时间：2012-09-30T12:43:55.860

## 更新：

Django 2.2 版本现在有一个[bulk_update](https://docs.djangoproject.com/en/stable/ref/models/querysets/#bulk-update)。

## 老答案：

请参阅以下 django 文档部分

> [一次更新多个对象](https://docs.djangoproject.com/en/stable/topics/db/queries/#updating-multiple-objects-at-once)

简而言之，您应该能够使用：

```
ModelClass.objects.filter(name='bar').update(name="foo") 
```

您还可以使用`F`对象来执行诸如递增行之类的操作：

```
from django.db.models import F
Entry.objects.all().update(n_pingbacks=F('n_pingbacks') + 1) 
```

请参阅[文档](https://docs.djangoproject.com/en/stable/topics/db/queries/)。

但是，请注意：

*   这不会使用`ModelClass.save`方法（所以如果你里面有一些逻辑，它就不会被触发）。
*   不会发出 django 信号。
*   您不能`.update()`对切片的 QuerySet 执行 an ，它必须在原始 QuerySet 上，因此您需要依靠`.filter()`and`.exclude()`方法。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2015-02-16T22:42:27.510

考虑使用[在 GitHub 上找到](https://github.com/aykut/django-bulk-update)`django-bulk-update`的。

安装：`pip install django-bulk-update`

实施：（代码直接取自项目自述文件）

```
from bulk_update.helper import bulk_update

random_names = ['Walter', 'The Dude', 'Donny', 'Jesus']
people = Person.objects.all()

for person in people:
    r = random.randrange(4)
    person.name = random_names[r]

bulk_update(people)  # updates all columns using the default db 
```

**更新：**正如 Marc 在评论中指出的那样，这不适合一次更新数千行。虽然它适用于 10 到 100 的小批量。适合您的批处理大小取决于您的 CPU 和查询复杂性。这个工具更像是手推车而不是自卸卡车。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2019-01-04T08:28:05.257

Django 2.2 版本现在有一个`bulk_update`方法（[发行说明](https://docs.djangoproject.com/en/2.2/releases/2.2/#models)）。

[https://docs.djangoproject.com/en/stable/ref/models/querysets/#bulk-update](https://docs.djangoproject.com/en/stable/ref/models/querysets/#bulk-update)

例子：

```
# get a pk: record dictionary of existing records
updates = YourModel.objects.filter(...).in_bulk()
....
# do something with the updates dict
....
if hasattr(YourModel.objects, 'bulk_update') and updates:
    # Use the new method
    YourModel.objects.bulk_update(updates.values(), [list the fields to update], batch_size=100)
else:
    # The old & slow way
    with transaction.atomic():
        for obj in updates.values():
            obj.save(update_fields=[list the fields to update]) 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-11-15T14:05:38.087

如果你想**在一组 rows 上设置相同的值**，你可以使用 update() 方法结合任何查询词来更新一个查询中的所有行：

```
some_list = ModelClass.objects.filter(some condition).values('id')
ModelClass.objects.filter(pk__in=some_list).update(foo=bar) 
```

如果您想根据某些条件**更新具有不同值的行集合**，您可以在最好的情况下根据值对更新进行批处理。假设您有 1000 行想要将列设置为 X 值之一，那么您可以事先准备批次，然后只运行 X 更新查询（每个都基本上具有上面第一个示例的形式）+ 初始 SELECT -询问。

如果**每一行都需要一个唯一值**，则无法避免每次更新一个查询。如果您在后一种情况下需要性能，也许可以研究其他架构，如 CQRS/事件溯源。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-11-07T22:12:24.767

这是我在互联网上找到的关于上述问题的有用内容

[https://www.sankalpjonna.com/learn-django/running-a-bulk-update-with-django](https://www.sankalpjonna.com/learn-django/running-a-bulk-update-with-django)

**低效的方式**

```
model_qs= ModelClass.objects.filter(name = 'bar')
for obj in model_qs:
    obj.name = 'foo'
    obj.save() 
```

**高效的方法**

```
ModelClass.objects.filter(name = 'bar').update(name="foo") # for single value 'foo' or add loop 
```

**使用 bulk_update**

```
update_list = []
model_qs= ModelClass.objects.filter(name = 'bar')
for obj in model_qs:
    model_obj =ModelClass.object.get(id=obj.id)
    model_obj.name = "foo" # Or what ever the value is for simplicty im providing foo only
    update_list.append(model_obj)

ModelClass.objects.bulk_update(update_list,['name']) 
```

**使用原子事务**

```
from django.db import transaction

with transaction.atomic():
    model_qs = ModelClass.objects.filter(name = 'bar')
    for obj in model_qs:
       ModelClass.objects.filter(name = 'bar').update(name="foo") 
```

任何赞成票？提前致谢：感谢您的关注；）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2022-01-19T04:29:25.833

要更新相同的值，我们可以简单地使用它

```
ModelClass.objects.filter(name = 'bar').update(name='foo') 
```

使用不同的值进行更新

```
list = ModelClass.objects.filter(name = 'bar')
obj_to_be_update = []
for obj in list:
    obj.name = "Dear "+obj.name
    obj_to_be_update.append(obj)
ModelClass.objects.bulk_update(obj_update_list, ['name'], batch_size=1000) 
```

它不会每次都触发保存信号，而是我们将所有要更新的对象保留在列表中并立即触发更新信号。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-22T06:00:51.247

> IT 返回的对象数量在表中更新。

```
update_counts = ModelClass.objects.filter(name='bar').update(name="foo") 
```

您可以参考此链接以获取有关批量更新和创建的更多信息。 [批量更新和创建](https://voorloopnul.com/blog/doing-bulk-update-and-bulk-create-with-django-orm/)

# tumblr - Tumblr 重定向自定义域 - WWW 到非 WWW

> ID：12661256
> 
> 赞同：5
> 
> 时间：2012-09-30T12:30:23.280
> 
> 标签：tumblr

Tumblr 的文档**“[使用自定义域名](http://www.tumblr.com/docs/en/custom_domains)”**非常有帮助，它清楚地指出我需要创建一个指向的**A 记录**，以便可以通过**example.com**访问我的网站。`example.com``66.6.44.4`

 **但我不明白这一点：我该**如何让`www.example.com`用户去`example.com`？**

不用说，这需要通过 DNS 以与 Tumblr 兼容的方式完成（以防万一有任何不兼容性）。

* * *

通过搜索，我了解到无法重定向`example.com`到`www.example.com`. 我只能希望这不是真的。

如果不幸的是，它碰巧是真的，我唯一的选择是创建一个 CNAME 记录指向`www.example.com`-`domains.tumblr.com`不是吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-30T12:38:21.823

啊! 如[本答案所述](https://stackoverflow.com/a/5667868/1071413)，您需要创建两个 DNS 条目，如下所示：

*   **`example.com`一条**记录：**指向`66.6.44.4`**
***   **`www.example.com`一条**记录：**指向`66.6.44.4`****

 ****我检查了答案中的域`emmaraviv.com`- 显然，`www.emmaraviv.com`重定向到`emmaraviv.com`. 所以，是的，就是这样！

您需要创建两条记录，一条用于二级域 ( `example.com`) 的 A 记录和一条用于三级域 ( ) 的 A 记录`www.example.com`，然后添加`example.com`到`Tumblr > Settings`您的博客中，现在应该可以顺利`example.com`重定向到`www.example.com`我能看到它。

**更新：**刚刚在我的博客上进行了测试，是的，我可以确认它有效！******

# c++ - 使用一个参数调用宏

> ID：12661258
> 
> 赞同：3
> 
> 时间：2012-09-30T12:30:55.130
> 
> 标签：c++, c, macros

最近我正在浏览 SO，我遇到了[这个主题](https://stackoverflow.com/questions/1537964/visual-c-equivalent-of-gccs-attribute-packed)，Sam Jansen 在其中声明了一个宏`PACKED_STRUCT(name)`，但在代码中他使用它一次没有参数，一次使用提供的 name 参数。

我试图用 GCC 4.6.1 编译一个类似的示例程序，我很惊讶它编译得很好，根本没有任何警告（我使用的是`-std=c99 -Wall -Wextra -pedantic`命令行开关）。但是，当我尝试创建两个参数宏并使用少于两个参数调用它时，它不起作用。

所以我的问题是，如果这是 GCC 中的一个错误，或者它是 GCC 的一个特性，或者它是在标准中的某个地方定义的，它必须像这样工作吗？

根据GCC 文档中的[这个页面](http://gcc.gnu.org/onlinedocs/cpp/Macro-Arguments.html)，这应该是不可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T12:41:36.730

再次阅读 GCC 文档的那一页；它区分了*空*参数和*缺少*参数。给定

```
#define ONE(x)    one(x)
#define TWO(x,y)  two(x,y) 
```

就预处理器而言，所有这些都非常好（评论中的扩展）：

```
ONE(1)    /* one(1)   */
ONE()     /* one()    */
TWO(1,2)  /* two(1,2) */
TWO(1,)   /* two(1,)  */
TWO(,2)   /* two(,2)  */
TWO(,)    /* two(,)   */ 
```

但这不行：

```
TWO()     /* error: macro "TWO" requires 2 arguments, but only 1 given */ 
```

# mysql - ComboBox 未填充 MySQL 查询结果 - 我该如何解决？

> ID：12661262
> 
> 赞同：0
> 
> 时间：2012-09-30T12:31:24.063
> 
> 标签：mysql, vb.net

我相信你们一切都好。我想知道我做错了什么以及如何解决它。我对下面代码的意图是查询我的 MySQL 数据库并在 ComboBox 内显示表的一列。Then, when that value in the ComboBox is selected, I want all the records associated to be populated into other controls on my form (I'll create a separate question for this part).

现在，查询正在运行，但 ComboBox 没有被填充。我究竟做错了什么？请帮忙，谢谢。

这是我的代码：

```
 Private Sub RetrieveMySQLdata()

    Try
        Dim dbConn As New MySqlConnection
        Dim dbQuery As String = ""
        Dim dbCmd As New MySqlCommand
        Dim dbAdapter As New MySqlDataAdapter
        Dim dbTable As New DataTable
        If dbConn.State = ConnectionState.Closed Then
            dbConn.ConnectionString = String.Format("Server={0};Port={1};Uid={2};Password={3};Database=accounting", FormLogin.ComboBoxServerIP.SelectedItem, My.Settings.DB_Port, My.Settings.DB_UserID, My.Settings.DB_Password)
            dbConn.Open()
        End If

        dbQuery = "SELECT *" & _
                   "FROM cc_master INNER JOIN customer ON customer.accountNumber = cc_master.customer_accountNumber " & _
                   "WHERE customer.accountNumber = '" & TextBoxAccount.Text & "'"
        With dbCmd
            .CommandText = dbQuery
            .Connection = dbConn
        End With
        With dbAdapter
            .SelectCommand = dbCmd
            .Fill(dbtable)
        End With
        Dim i As Integer
        For i = 0 To dbTable.Rows.Count - 1
            ComboBoxCard.ValueMember = "ccNumber"

        Next
    Catch ex As Exception
        MessageBox.Show("A DATABASE ERROR HAS OCCURED" & vbCrLf & vbCrLf & ex.Message & vbCrLf & _
                    vbCrLf + "Please report this to the IT/Systems Helpdesk at Ext 131.")
    End Try

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T12:39:22.053

你想在哪里填充`ComboBox`？我看到的唯一交互是在这里：

```
For i = 0 To dbTable.Rows.Count - 1
    ComboBoxCard.ValueMember = "ccNumber"
Next 
```

我猜这并没有做你认为它正在做的事情。一方面，您`ValueMember`在一个循环中多次设置为相同的值。语句中的任何内容都不会随着循环的每次迭代而改变，那么为什么要循环呢？

更具体地说，`ValueMember`实际上不是任何类型的显示值。 [它用于指示绑定数据中的哪个字段应该包含 value](http://msdn.microsoft.com/en-us/library/system.windows.forms.listcontrol.valuemember.aspx)。当您为`DataSource`您缺少的控件提​​供 a 时，将使用此选项。

我假设`DataSource`应该是`dbTable`，所以你可能想要做这样的事情：

```
ComboBoxCard.DataSource = dbTable
ComboBoxCard.ValueMember = "ccNumber"
ComboBoxCard.DisplayMember = "Some Other Field in the database" 
```

I don't remember if you need to explicitly call `.DataBind()` on the control after these statements, but the example I linked to doesn't do it so I'll leave it out.

Essentially what you're *trying* to do in your code is loop through the results and add them to the `ComboBox`. You don't need to do this. The `ComboBox` is capable of doing this internally if you just point its `DataSource` to the set of data being used and tell it which fields it needs to use on that set. This is called [data binding](http://msdn.microsoft.com/en-us/library/ms752347.aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T12:38:52.537

看起来您没有`DataSource`为 ComboBox 对象设置。而不是这段代码：

```
Dim i As Integer
For i = 0 To dbTable.Rows.Count - 1
    ComboBoxCard.ValueMember = "ccNumber"
Next 
```

使用类似这样的代码：

```
ComboBoxCard.DataSource = dbTable
ComboBoxCard.ValueMember = "ccNumber"
ComboBoxCard.DisplayMember = "(some other column if you want)" 
```

# delphi - 无法将函数引用传递给框架中的表单

> ID：12661263
> 
> 赞同：4
> 
> 时间：2012-09-30T12:31:33.517
> 
> 标签：delphi

我有一个正在构建的应用程序，它有一个带有几个创建的 TabSheets 的 PageControl，我将其放置在几个预定义的框架上。每个帧中都有一个名为“GetValue”的例程，它将控件的内容解析为字符串并返回结果。在主窗体（RGMain）上，我有：

```
Type
   TGetValueFunction = Function: String;
...   
Private
   fGetValueFunction: TGetValueFunction;
...      
Public
   Property GetValueFunction: TGetValueFunction Write fGetValueFunction; 
```

在我拥有的每个框架中：

```
Public
Constructor Create(AQwner: TComponent);
...
Interface
Constructor TBooleanChoiceFrame.Create(AOwner: TComponent);
   Begin
   Inherited Create(AOwner);
   RGMain.GetValueFunction := GetValue; <<<< compile error on this line
   End; 
```

E2009 不兼容的类型：“常规过程和方法指针”

除了纠正问题之外，这甚至是解决在每一帧中访问 GetValue 例程问题的正确方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T12:37:33.393

如果你想使用一个类的方法，你必须像这样声明函数类型：

```
Type
   TGetValueFunction = Function: String of object; 
```

# php - 通过 codeigniter 发送的 sendgrid 电子邮件被作为垃圾邮件接收

> ID：12661270
> 
> 赞同：1
> 
> 时间：2012-09-30T12:33:09.613
> 
> 标签：php, codeigniter, email, html-email, sendgrid

我正在使用 Codeigniter 和 SendGrid 将我的电子邮件发送给用户......

我发送的每封电子邮件都有一个模板，用于注册，它看起来像这样：

```
<html>
<body>
    <h1>Activate account for <?php echo $identity;?></h1>
    <p>Please click this link to <?php echo anchor('auth/activate/'. $id .'/'. $activation, 'Activate Your Account');?>.</p>
</body>
</html> 
```

我使用一个不存在的**from** `email address``no-reply@domain.com`

问题是该电子邮件是作为垃圾邮件收到的，我想修复它......可能是因为电子邮件地址是假**的吗？**

我猜HTML很好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:39:38.183

请参考这些问题，因为这基本上与 CI/SG 无关，而是一般的电子邮件问题，通常会导致上下文和标头问题：

1.  [https://serverfault.com/questions/48428/how-to-send-emails-and-avoid-them-being-classified-as-spam](https://serverfault.com/questions/48428/how-to-send-emails-and-avoid-them-being-classified-as-spam)
2.  [http://www.allspammedup.com/2009/09/7-ways-to-prevent-your-emails-being-blocked-as-spam/](http://www.allspammedup.com/2009/09/7-ways-to-prevent-your-emails-being-blocked-as-spam/)
3.  [如何确保以编程方式发送的电子邮件不会自动标记为垃圾邮件？](https://stackoverflow.com/questions/371/how-do-you-make-sure-email-you-send-programmatically-is-not-automatically-marked/598#598)

# java - htmlunit，在同一窗口中更改地址

> ID：12661271
> 
> 赞同：0
> 
> 时间：2012-09-30T12:33:48.270
> 
> 标签：java, htmlunit

```
 HtmlPage open1 =  (HtmlPage) webClient.getPage("http://www.google.com");

    ScriptResult result = open1.executeJavaScript("window.location.assign('https://www.google.com.tr/search?q'));

    HtmlPage afterExecution = (HtmlPage) result.getNewPage();

    System.out.println(afterExecution); //in window new adres 
```

> 如何在同一窗口中打开新站点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T12:48:39.083

只是打电话`webClient.getPage("https://www.google.com.tr/search?q");`。您不需要调用任何 javascript。

从[javadocs](http://htmlunit.sourceforge.net/apidocs/com/gargoylesoftware/htmlunit/WebClient.html)：

> 构建 URL 并将其加载到当前 WebWindow 的便捷方法，就像通过 getPage(WebWindow, WebRequest) 完成的那样。

# ruby-on-rails - 如何以原始（或simple_format）文本显示rails link_to

> ID：12661273
> 
> 赞同：2
> 
> 时间：2012-09-30T12:34:51.820
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个带有属性 :description 的图像模型，它是一个文本，格式为 html 文本（例如，文本中有一些
），我在视图中显示如下：

```
simple_format(@image.description) 
```

我认为 raw(@image.description) 将主要做同样的事情。如何添加带有链接到该文本的 link_to 助手？我正在搜索类似以下文本的内容（将是@image.description）：

文字文字文字文字。

文本文本 #{link_to "Text", @image.link)

@image.link 将是链接。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:45:13.627

使用 ERB：

```
<%= raw ERB.new(@image.description).result(binding) %> 
```

将其包装在辅助方法中：

```
module ApplicationHelper
  def simple_format(content)
    ERB.new(content).result(binding).html_safe
  end
end 
```

并像这样使用它：

```
<%= simple_format(@image.description) %> 
```

您可以用于图像描述的一些示例内容可能是：

```
Check out <%= link_to "the first image", image_path(1) %>! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:36:37.810

你可以用这段代码做到这一点

```
link_to raw(@image.description), @image.link 
```

如果您只需要选择一个随机单词：

```
words = @image.description.split

link_to raw(words.sample), @image.link 
```

**更新：**

例如，当您创建描述时，您可以将特殊符号添加到可以用作链接的单词中，例如它可以是括号：

```
@image.description = This my description with link (Hello) you can follow it!

@image.description.gsub(/\(([^\)]+)\)/, link_to('\1', @image.link)) 
```

它将产生：

```
"This my description with link <a href=\"/\">Hello</a> you can follow it!" 
```

# c# - C# 字典是如何实现的？(C++)

> ID：12661276
> 
> 赞同：1
> 
> 时间：2012-09-30T12:35:24.407
> 
> 标签：c#, c++, dictionary

您好我正在使用 C++ 创建一个类似 C# 的字典对象。我对程序运行时在内存中移动的所有内容使用类似的垃圾收集 ref 对象系统。我首先将字典 aa 实现为一个非常标准的哈希表，这很好，我有这种类型的布局：

```
header + hash table -> storage -> element 0 -> object x
                                  element 1 -> object y
                                  element ... -> object ...

'+': In same allocation 
'->': Indirect pointer ie different allocation 
```

所以“标题”只包含表格大小。“哈希表”是存储区域的整数偏移量数组。

存储实现为 C# 列表，即指向自定大小数组的间接指针（引用对象），即类似于 C++ 向量。

存储中的每个元素 ( `Dictionary::Element`) 都包含一个 id、一个指向实际对象的间接指针（引用对象）和一个指向下一个元素的整数偏移量。

```
// C++ like pseudo code:
template< typename _Type_, typename _HashType_ = int >
class Dictionary
{
private:

   class Element
   {
       _HashType_ m_id;
       _Type_     m_object;   // Ref object ie indirect pointer to actual object
       int        m_next;     // Next element
   }

   int            m_tablesize; // Power of 2
   int*           m_table;     // Pointer here but in reality just a continuous block                      
                               // of memory after m_tablesize;
   List<Element>  m_storage;      // Like a C++ vector
} 
```

所以我的问题是 C# 的字典一次只允许一个对象用于任何一个哈希。

有没有比上述实现更简单的方法？

例如`Dictonary::Add(_HashType_ id, _Type_ object)`，在上面的实现中，将按位与哈希表的大小来获得哈希表的索引，然后分配一个带有传入的 id 和对象的元素，然后它将该元素添加（推回）到列表中（m_storage ) 的元素并修复元素的链表：

```
template < typename _Type_, typename _HashType_ >
inline bool Dictionary< _Type_, _HashType_ >::Add( _HashType_ id, _Type_ element )
{
    Element element = Element::New( id, object );
    m_storage->Add( element );

    // PushBack here fixes up the offset of the element in the storage array stored in 
    // the hash table (zero elements for this id) or the next pointer in the element 
    // (one or more elements exist for this id)
    return PushBack( element );
} 
```

更明确一点：有没有办法只拥有对象的标题和哈希表，即：

```
header + hash table -> object x
                       object y
                       ... 
```

我问这个是因为 C# 对每个哈希施加了一个项目限制，而上面更复杂的实现实际上没有这样的限制，除了 Remove 需要同时传入 id 和对象，并且可能你可能想要 PushFront 和 PushBack 而不是 Add。

在此先感谢您，请不要问我为什么要做这种看似疯狂的事情，只是让我感到高兴！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T05:59:59.107

您可以使用[反编译器](http://www.jetbrains.com/decompiler/)查看字典是如何在 mscorlib 中实现的。包含的内容太长，但这里有一个片段：

```
namespace System.Collections.Generic { 

using System;
using System.Collections;
using System.Diagnostics; 
using System.Diagnostics.Contracts;
using System.Runtime.Serialization; 
using System.Security.Permissions; 

[DebuggerTypeProxy(typeof(Mscorlib_DictionaryDebugView<,>))] 
[DebuggerDisplay("Count = {Count}")]
[Serializable]
[System.Runtime.InteropServices.ComVisible(false)]
public class Dictionary<TKey,TValue>: IDictionary<TKey,TValue>, IDictionary, IReadOnlyDictionary<TKey, TValue>, ISerializable, IDeserializationCallback  { 

    private struct Entry { 
        public int hashCode;    // Lower 31 bits of hash code, -1 if unused 
        public int next;        // Index of next entry, -1 if last
        public TKey key;           // Key of entry 
        public TValue value;         // Value of entry
    }

    private int[] buckets; 
    private Entry[] entries;
    private int count; 
    private int version; 
    private int freeList;
    private int freeCount; 
    private IEqualityComparer<TKey> comparer;
    private KeyCollection keys;
    private ValueCollection values;
    private Object _syncRoot; 

    // constants for serialization 
    private const String VersionName = "Version"; 
    private const String HashSizeName = "HashSize";  // Must save buckets.Length
    private const String KeyValuePairsName = "KeyValuePairs"; 
    private const String ComparerName = "Comparer";

    public Dictionary(): this(0, null) {}

    public Dictionary(int capacity): this(capacity, null) {}

    public Dictionary(IEqualityComparer<TKey> comparer): this(0, comparer) {} 

    public Dictionary(int capacity, IEqualityComparer<TKey> comparer) { 
        if (capacity < 0) ThrowHelper.ThrowArgumentOutOfRangeException(ExceptionArgument.capacity);
        if (capacity > 0) Initialize(capacity);
        this.comparer = comparer ?? EqualityComparer<TKey>.Default;
    } 

    public Dictionary(IDictionary<TKey,TValue> dictionary): this(dictionary, null) {} 

    public Dictionary(IDictionary<TKey,TValue> dictionary, IEqualityComparer<TKey> comparer):
        this(dictionary != null? dictionary.Count: 0, comparer) { 

        if( dictionary == null) {
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.dictionary);
        } 

        foreach (KeyValuePair<TKey,TValue> pair in dictionary) { 
            Add(pair.Key, pair.Value); 
        }
    } 

    protected Dictionary(SerializationInfo info, StreamingContext context) {
        //We can't do anything with the keys and values until the entire graph has been deserialized
        //and we have a resonable estimate that GetHashCode is not going to fail.  For the time being, 
        //we'll just cache this.  The graph is not valid until OnDeserialization has been called.
        HashHelpers.SerializationInfoTable.Add(this, info); 
    } 

    public IEqualityComparer<TKey> Comparer { 
        get {
            return comparer;
        }
    } 

    public int Count { 
        get { return count - freeCount; } 
    }

    public KeyCollection Keys {
        get {
            Contract.Ensures(Contract.Result<KeyCollection>() != null);
            if (keys == null) keys = new KeyCollection(this); 
            return keys;
        } 
    } 

    ICollection<TKey> IDictionary<TKey, TValue>.Keys { 
        get {
            if (keys == null) keys = new KeyCollection(this);
            return keys;
        } 
    }

    IEnumerable<TKey> IReadOnlyDictionary<TKey, TValue>.Keys { 
        get {
            if (keys == null) keys = new KeyCollection(this); 
            return keys;
        }
    }

    public ValueCollection Values {
        get { 
            Contract.Ensures(Contract.Result<ValueCollection>() != null); 
            if (values == null) values = new ValueCollection(this);
            return values; 
        }
    }

    ICollection<TValue> IDictionary<TKey, TValue>.Values { 
        get {
            if (values == null) values = new ValueCollection(this); 
            return values; 
        }
    } 

    IEnumerable<TValue> IReadOnlyDictionary<TKey, TValue>.Values {
        get {
            if (values == null) values = new ValueCollection(this); 
            return values;
        } 
    } 

    public TValue this[TKey key] { 
        get {
            int i = FindEntry(key);
            if (i >= 0) return entries[i].value;
            ThrowHelper.ThrowKeyNotFoundException(); 
            return default(TValue);
        } 
        set { 
            Insert(key, value, false);
        } 
    }

    public void Add(TKey key, TValue value) {
        Insert(key, value, true); 
    }

    void ICollection<KeyValuePair<TKey, TValue>>.Add(KeyValuePair<TKey, TValue> keyValuePair) { 
        Add(keyValuePair.Key, keyValuePair.Value);
    } 

    bool ICollection<KeyValuePair<TKey, TValue>>.Contains(KeyValuePair<TKey, TValue> keyValuePair) {
        int i = FindEntry(keyValuePair.Key);
        if( i >= 0 && EqualityComparer<TValue>.Default.Equals(entries[i].value, keyValuePair.Value)) { 
            return true;
        } 
        return false; 
    }

    bool ICollection<KeyValuePair<TKey, TValue>>.Remove(KeyValuePair<TKey, TValue> keyValuePair) {
        int i = FindEntry(keyValuePair.Key);
        if( i >= 0 && EqualityComparer<TValue>.Default.Equals(entries[i].value, keyValuePair.Value)) {
            Remove(keyValuePair.Key); 
            return true;
        } 
        return false; 
    }

    public void Clear() {
        if (count > 0) {
            for (int i = 0; i < buckets.Length; i++) buckets[i] = -1;
            Array.Clear(entries, 0, count); 
            freeList = -1;
            count = 0; 
            freeCount = 0; 
            version++;
        } 
    }

    public bool ContainsKey(TKey key) {
        return FindEntry(key) >= 0; 
    }

    public bool ContainsValue(TValue value) { 
        if (value == null) {
            for (int i = 0; i < count; i++) { 
                if (entries[i].hashCode >= 0 && entries[i].value == null) return true;
            }
        }
        else { 
            EqualityComparer<TValue> c = EqualityComparer<TValue>.Default;
            for (int i = 0; i < count; i++) { 
                if (entries[i].hashCode >= 0 && c.Equals(entries[i].value, value)) return true; 
            }
        } 
        return false;
    }

    private void CopyTo(KeyValuePair<TKey,TValue>[] array, int index) { 
        if (array == null) {
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.array); 
        } 

        if (index < 0 || index > array.Length ) { 
            ThrowHelper.ThrowArgumentOutOfRangeException(ExceptionArgument.index, ExceptionResource.ArgumentOutOfRange_NeedNonNegNum);
        }

        if (array.Length - index < Count) { 
            ThrowHelper.ThrowArgumentException(ExceptionResource.Arg_ArrayPlusOffTooSmall);
        } 

        int count = this.count;
        Entry[] entries = this.entries; 
        for (int i = 0; i < count; i++) {
            if (entries[i].hashCode >= 0) {
                array[index++] = new KeyValuePair<TKey,TValue>(entries[i].key, entries[i].value);
            } 
        }
    } 

    public Enumerator GetEnumerator() {
        return new Enumerator(this, Enumerator.KeyValuePair); 
    }

    IEnumerator<KeyValuePair<TKey, TValue>> IEnumerable<KeyValuePair<TKey, TValue>>.GetEnumerator() {
        return new Enumerator(this, Enumerator.KeyValuePair); 
    }

    [System.Security.SecurityCritical]  // auto-generated_required 
    public virtual void GetObjectData(SerializationInfo info, StreamingContext context) {
        if (info==null) { 
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.info);
        }
        info.AddValue(VersionName, version);

#if FEATURE_RANDOMIZED_STRING_HASHING
        info.AddValue(ComparerName, HashHelpers.GetEqualityComparerForSerialization(comparer), typeof(IEqualityComparer<TKey>)); 
#else 
        info.AddValue(ComparerName, comparer, typeof(IEqualityComparer<TKey>));
#endif 

        info.AddValue(HashSizeName, buckets == null ? 0 : buckets.Length); //This is the length of the bucket array.
        if( buckets != null) {
            KeyValuePair<TKey, TValue>[] array = new KeyValuePair<TKey, TValue>[Count]; 
            CopyTo(array, 0);
            info.AddValue(KeyValuePairsName, array, typeof(KeyValuePair<TKey, TValue>[])); 
        } 
    }

    private int FindEntry(TKey key) {
        if( key == null) {
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.key);
        } 

        if (buckets != null) { 
            int hashCode = comparer.GetHashCode(key) & 0x7FFFFFFF; 
            for (int i = buckets[hashCode % buckets.Length]; i >= 0; i = entries[i].next) {
                if (entries[i].hashCode == hashCode && comparer.Equals(entries[i].key, key)) return i; 
            }
        }
        return -1;
    } 

    private void Initialize(int capacity) { 
        int size = HashHelpers.GetPrime(capacity); 
        buckets = new int[size];
        for (int i = 0; i < buckets.Length; i++) buckets[i] = -1; 
        entries = new Entry[size];
        freeList = -1;
    }

    private void Insert(TKey key, TValue value, bool add) {

        if( key == null ) { 
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.key);
        } 

        if (buckets == null) Initialize(0);
        int hashCode = comparer.GetHashCode(key) & 0x7FFFFFFF;
        int targetBucket = hashCode % buckets.Length; 

#if FEATURE_RANDOMIZED_STRING_HASHING 
        int collisionCount = 0; 
#endif

        for (int i = buckets[targetBucket]; i >= 0; i = entries[i].next) {
            if (entries[i].hashCode == hashCode && comparer.Equals(entries[i].key, key)) {
                if (add) {
                    ThrowHelper.ThrowArgumentException(ExceptionResource.Argument_AddingDuplicate); 
                }
                entries[i].value = value; 
                version++; 
                return;
            } 

#if FEATURE_RANDOMIZED_STRING_HASHING
            collisionCount++;
#endif 
        }
        int index; 
        if (freeCount > 0) { 
            index = freeList;
            freeList = entries[index].next; 
            freeCount--;
        }
        else {
            if (count == entries.Length) 
            {
                Resize(); 
                targetBucket = hashCode % buckets.Length; 
            }
            index = count; 
            count++;
        }

        entries[index].hashCode = hashCode; 
        entries[index].next = buckets[targetBucket];
        entries[index].key = key; 
        entries[index].value = value; 
        buckets[targetBucket] = index;
        version++; 

#if FEATURE_RANDOMIZED_STRING_HASHING
        if(collisionCount > HashHelpers.HashCollisionThreshold && HashHelpers.IsWellKnownEqualityComparer(comparer))
        { 
            comparer = (IEqualityComparer<TKey>) HashHelpers.GetRandomizedEqualityComparer(comparer);
            Resize(entries.Length, true); 
        } 
#endif

    }

    public virtual void OnDeserialization(Object sender) {
        SerializationInfo siInfo; 
        HashHelpers.SerializationInfoTable.TryGetValue(this, out siInfo);

        if (siInfo==null) { 
            // It might be necessary to call OnDeserialization from a container if the container object also implements
            // OnDeserialization. However, remoting will call OnDeserialization again. 
            // We can return immediately if this function is called twice.
            // Note we set remove the serialization info from the table at the end of this method.
            return;
        } 

        int realVersion = siInfo.GetInt32(VersionName); 
        int hashsize = siInfo.GetInt32(HashSizeName); 
        comparer   = (IEqualityComparer<TKey>)siInfo.GetValue(ComparerName, typeof(IEqualityComparer<TKey>));

        if( hashsize != 0) {
            buckets = new int[hashsize];
            for (int i = 0; i < buckets.Length; i++) buckets[i] = -1;
            entries = new Entry[hashsize]; 
            freeList = -1;

            KeyValuePair<TKey, TValue>[] array = (KeyValuePair<TKey, TValue>[]) 
                siInfo.GetValue(KeyValuePairsName, typeof(KeyValuePair<TKey, TValue>[]));

            if (array==null) {
                ThrowHelper.ThrowSerializationException(ExceptionResource.Serialization_MissingKeys);
            }

            for (int i=0; i<array.Length; i++) {
                if ( array[i].Key == null) { 
                    ThrowHelper.ThrowSerializationException(ExceptionResource.Serialization_NullKey); 
                }
                Insert(array[i].Key, array[i].Value, true); 
            }
        }
        else {
            buckets = null; 
        }

        version = realVersion; 
        HashHelpers.SerializationInfoTable.Remove(this);
    } 

    private void Resize() {
        Resize(HashHelpers.ExpandPrime(count), false);
    } 

    private void Resize(int newSize, bool forceNewHashCodes) { 
        Contract.Assert(newSize >= entries.Length); 
        int[] newBuckets = new int[newSize];
        for (int i = 0; i < newBuckets.Length; i++) newBuckets[i] = -1; 
        Entry[] newEntries = new Entry[newSize];
        Array.Copy(entries, 0, newEntries, 0, count);
        if(forceNewHashCodes) {
            for (int i = 0; i < count; i++) { 
                if(newEntries[i].hashCode != -1) {
                    newEntries[i].hashCode = (comparer.GetHashCode(newEntries[i].key) & 0x7FFFFFFF); 
                } 
            }
        } 
        for (int i = 0; i < count; i++) {
            int bucket = newEntries[i].hashCode % newSize;
            newEntries[i].next = newBuckets[bucket];
            newBuckets[bucket] = i; 
        }
        buckets = newBuckets; 
        entries = newEntries; 
    }

    public bool Remove(TKey key) {
        if(key == null) {
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.key);
        } 

        if (buckets != null) { 
            int hashCode = comparer.GetHashCode(key) & 0x7FFFFFFF; 
            int bucket = hashCode % buckets.Length;
            int last = -1; 
            for (int i = buckets[bucket]; i >= 0; last = i, i = entries[i].next) {
                if (entries[i].hashCode == hashCode && comparer.Equals(entries[i].key, key)) {
                    if (last < 0) {
                        buckets[bucket] = entries[i].next; 
                    }
                    else { 
                        entries[last].next = entries[i].next; 
                    }
                    entries[i].hashCode = -1; 
                    entries[i].next = freeList;
                    entries[i].key = default(TKey);
                    entries[i].value = default(TValue);
                    freeList = i; 
                    freeCount++;
                    version++; 
                    return true; 
                }
            } 
        }
        return false;
    }

    public bool TryGetValue(TKey key, out TValue value) {
        int i = FindEntry(key); 
        if (i >= 0) { 
            value = entries[i].value;
            return true; 
        }
        value = default(TValue);
        return false;
    } 

    // This is a convenience method for the internal callers that were converted from using Hashtable. 
    // Many were combining key doesn't exist and key exists but null value (for non-value types) checks. 
    // This allows them to continue getting that behavior with minimal code delta. This is basically
    // TryGetValue without the out param 
    internal TValue GetValueOrDefault(TKey key) {
        int i = FindEntry(key);
        if (i >= 0) {
            return entries[i].value; 
        }
        return default(TValue); 
    } 

    bool ICollection<KeyValuePair<TKey,TValue>>.IsReadOnly { 
        get { return false; }
    }

    void ICollection<KeyValuePair<TKey,TValue>>.CopyTo(KeyValuePair<TKey,TValue>[] array, int index) { 
        CopyTo(array, index);
    } 

    void ICollection.CopyTo(Array array, int index) {
        if (array == null) { 
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.array);
        }

        if (array.Rank != 1) { 
            ThrowHelper.ThrowArgumentException(ExceptionResource.Arg_RankMultiDimNotSupported);
        } 

        if( array.GetLowerBound(0) != 0 ) {
            ThrowHelper.ThrowArgumentException(ExceptionResource.Arg_NonZeroLowerBound); 
        }

        if (index < 0 || index > array.Length) {
            ThrowHelper.ThrowArgumentOutOfRangeException(ExceptionArgument.index, ExceptionResource.ArgumentOutOfRange_NeedNonNegNum); 
        }

        if (array.Length - index < Count) { 
            ThrowHelper.ThrowArgumentException(ExceptionResource.Arg_ArrayPlusOffTooSmall);
        } 

        KeyValuePair<TKey,TValue>[] pairs = array as KeyValuePair<TKey,TValue>[];
        if (pairs != null) {
            CopyTo(pairs, index); 
        }
        else if( array is DictionaryEntry[]) { 
            DictionaryEntry[] dictEntryArray = array as DictionaryEntry[]; 
            Entry[] entries = this.entries;
            for (int i = 0; i < count; i++) { 
                if (entries[i].hashCode >= 0) {
                    dictEntryArray[index++] = new DictionaryEntry(entries[i].key, entries[i].value);
                }
            } 
        }
        else { 
            object[] objects = array as object[]; 
            if (objects == null) {
                ThrowHelper.ThrowArgumentException(ExceptionResource.Argument_InvalidArrayType); 
            }

            try {
                int count = this.count; 
                Entry[] entries = this.entries;
                for (int i = 0; i < count; i++) { 
                    if (entries[i].hashCode >= 0) { 
                        objects[index++] = new KeyValuePair<TKey,TValue>(entries[i].key, entries[i].value);
                    } 
                }
            }
            catch(ArrayTypeMismatchException) {
                ThrowHelper.ThrowArgumentException(ExceptionResource.Argument_InvalidArrayType); 
            }
        } 
    } 

    IEnumerator IEnumerable.GetEnumerator() { 
        return new Enumerator(this, Enumerator.KeyValuePair);
    }

    bool ICollection.IsSynchronized { 
        get { return false; }
    } 

    object ICollection.SyncRoot {
        get { 
            if( _syncRoot == null) {
                System.Threading.Interlocked.CompareExchange<Object>(ref _syncRoot, new Object(), null);
            }
            return _syncRoot; 
        }
    } 

    bool IDictionary.IsFixedSize {
        get { return false; } 
    }

    bool IDictionary.IsReadOnly {
        get { return false; } 
    } 
```

< 其余代码省略...>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:40:01.180

[它与std::map](http://www.cplusplus.com/reference/stl/map/)非常相似，尽管 std::map 不需要您先向其中添加条目......您可以通过使用地图的条目来添加

IE。

```
std::map< int, int > m;
m[78]++; 
```

将创建并递增由键“78”表示的 int 值...

# svn - 如何从 Subversion 中删除大量修订

> ID：12661279
> 
> 赞同：1
> 
> 时间：2012-09-30T12:36:06.220
> 
> 标签：svn

我有一个大型存储库，我想删除最旧的 6,000 个修订版。如果我也可以在中间删除不需要的修订组，那就太好了。

我已经想出了如何消除不需要的文件和分支，但我仍然留下了很多不需要的修订。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:55:37.480

您需要使用**svnadmin 转储**命令，您可以从任意修订创建转储文件，然后过滤它以进入/排除某些路径。语法是：

```
svnadmin dump REPOS_PATH [-r LOWER[:UPPER]] [--incremental] 
```

一个例子：你想从你的存储库中排除修订版 10-99：

```
svnadmin dump REPOS_PATH -r 0:9  > my_dump_file.dmp
svnadmin dump REPOS_PATH -r 100:HEAD  > my_dump_file.dmp --incremental 
```

有一些问题：

*   在我的示例中，您在 rev 10-99 中添加的 rev 100 之后的文件更改将创建一条错误消息，您需要在*之前从 repo 中删除它们*

*   删除以后用作复制源的文件也会导致转储文件出错。

这两个限制你大多可以规避，但它需要更多的转储/过滤/加载周期迭代，因此需要更多时间。何时处理这些边界情况取决于您。

使用 svnbook 读取[svnadmin dump](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.ref.svnadmin.c.dump)和[svndumpfilter的详细信息](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.reposadmin.maint.tk.svndumpfilter)

# mongodb - Mongoose 验证嵌入

> ID：12661280
> 
> 赞同：0
> 
> 时间：2012-09-30T12:36:29.127
> 
> 标签：mongodb, mongoose

我创建了以下架构（咖啡脚本）：

```
user_schema = new app.db.schema(
    username: String
    email: String
    password: String
    account:
        plan:
            type: String
            default: "Free"
            enum: ["Free", "Bronze", "Silver", "Gold"]
        comments: [
            title: String
            message: String
            date_added: Date
        ]
) 
```

我可能在这里创建了另外 2 个模式（帐户和评论），但我知道每个用户都有一个关联的帐户，每个帐户最多有 100 条评论，所以我喜欢将它们全部放在一个文档中的想法。我知道（用户/帐户/评论）没有意义，但我只是让自己熟悉 noSql 和丰富的文档，所以这只是一个测试。

我的问题是关于为给定帐户保存新评论并验证它们。我可以通过这样做来验证用户电子邮件（顺便说一句）：

```
user_schema.path("email").validate((value, respond)->
    respond v.check(value).isEmail()
, "Invalid email address") 
```

...但是我将如何验证评论？如何在给定的 user.account.comments 数组下保存新评论？默认情况下不需要评论，但如果添加了新评论，我想验证标题和消息是否是必需的。

这种嵌套是正常的还是我必须创建单独的模型并引用它们？我读了很多关于嵌入与链接的内容，我觉得这会成为嵌入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:15:39.803

您将验证属性放在嵌入对象的架构定义中：

```
comments: [
    title:
        type: String
        required: true
    message: 
        type: String
        required: true
    date_added: Date
] 
```

# php - 从主数组中删除匹配的数组

> ID：12661283
> 
> 赞同：0
> 
> 时间：2012-09-30T12:37:04.543
> 
> 标签：php, arrays

我已经能够搜索一个多维数组，比如

```
Array
(
    [0] => Array
        (
            [size] => 39
            [colour] => N/A
            [quantity] => 5
        )

    [1] => Array
        (
            [size] => 35
            [colour] => N/A
            [quantity] => 5
        )

    [2] => Array
        (
            [size] => 40
            [colour] => N/A
            [quantity] => 5
        )

    [3] => Array
        (
            [size] => 30
            [colour] => N/A
            [quantity] => 5
        )

) 
```

并返回匹配的匹配数组，如下所示

```
Array
(
    [size] => 35
    [colour] => N/A
    [quantity] => 5
) 
```

使用这个片段

```
$result = array();
foreach ($multi_array as $arr) {
  if ($arr['size'] == $one_dimen_arr['size'] && $arr['colour'] == $one_dimen_arr['colour']) {
    $result = $arr;
    break;
  }
} 
```

是否可以从主多维数组中删除匹配项并替换为该位置的更新数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:43:26.077

像这样试试

```
$result = array();
foreach ($multi_array as $key => $arr) {
  if (
     $arr['size'] == $one_dimen_arr['size'] && 
     $arr['colour'] == $one_dimen_arr['colour']
  ) {
    $result = $arr;
    unset($multi_array[$key])  //to remove the matching array
    $multi_array[$key] = $yourUpdatedArr; //to update the values
    break;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:42:24.283

尝试这个，

```
 $result = array();
    foreach ($multi_array as $key=>$arr) {
      if ($arr['size'] == $one_dimen_arr['size'] && $arr['colour'] == $one_dimen_arr['colour']) {
        $i = $key;
        $result = $arr;
        break;
      }

    }
if(isset($i)){$multi_array[$i] = $updatedArray;} 
```

# .htaccess - htaccess clean URL 的最佳方法是什么？

> ID：12661287
> 
> 赞同：2
> 
> 时间：2012-09-30T12:37:57.387
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, clean-urls

我正在为我的网站开发干净的 URL，我注意到您在互联网上找到的内容几乎是将您的干净 url 重写为您的服务器可以使用的 url。所以是这样的：

```
www.domain.com/profile/username --> www.domain.com/profile.php?u=username

RewriteEngine On
RewriteRule ^profile/(.*)$ /profile.php?u=$1 [L] 
```

所以现在有了这个，我应该在我的网站内链接到 cleanurl。但直观地说，链接到“脏”网址感觉更可靠/更好。因此，在这种情况下，您应该对上述内容使用重写器规则并使用重定向规则将“脏 url”重新定义为干净的 url，因此用户始终只能在浏览器中看到干净的 url。

```
www.domain.com/profile.php?u=username --> www.domain.com/profile/username 
```

这是一件好事吗。是网站做的吗？反对/支持它的论据是什么？

你怎么做这样的重定向。像下面这样的东西似乎不起作用：

```
RewriteRule ^profile\.php?u=(.*)$ /profile/$1 [R=301, L] 
```

我对 .htaccess 还很陌生，所以我可能会要求一些显而易见的东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T19:44:29.480

```
RewriteRule ^profile\.php?u=(.*)$ /profile/$1 [R=301, L] 
```

不起作用，因为您无法匹配来自 a 的查询字符串`RewriteRule`（您的标志中也有一个杂散空间）。您还希望与实际请求而不是 URI 匹配，因为您只会导致来自其他规则的重定向循环。

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /profile\.php\?u=([^&\ ]+)
RewriteRule ^/?profile\.php$ /profile/%1 [R=301,L] 
```

# c++ - c++：vtable 是否包含指向非虚拟函数的指针？

> ID：12661292
> 
> 赞同：9
> 
> 时间：2012-09-30T12:38:41.480
> 
> 标签：c++, virtual, vtable

vtable 包含指向该类的虚函数的指针。它是否还包含指向非虚拟函数的指针？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-30T12:41:09.603

这是一个实现细节，但不是。如果实现将指向非虚拟函数的指针放入 vtable 中，则它不能使用这些指针进行函数调用，因为它通常会导致调用不正确的非虚拟函数。

当调用非虚拟函数时，实现*必须*使用调用函数的对象的静态类型来确定要调用的正确函数。*由vptr*访问的存储在*vtable*中的函数将取决于对象的动态类型，而不是任何静态类型的引用或访问它的指针。

 ** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-30T12:41:26.670

不，它没有。

由于可以在编译期间解析对非虚方法的调用（因为编译器知道非虚函数的地址），所以编译器生成指令以“直接”（即静态地）调用它们。

对于编译期间已知的方法，没有理由通过 vtable 间接机制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T12:46:12.830

标准没有定义任何实现是否使用“vtable”。大多数实现使用函数指针表，尽管指向的函数通常不是直接被调用的函数（相反，指向的函数可以在调用实际函数之前调整指针）。

非虚函数是否出现在此表中也没有标准定义。毕竟，标准甚至不需要 vtable 的存在。通常，非虚函数不在虚函数表中，因为任何必要的指针调整和调用都可以在编译或链接时解决。我可以想象一个实现类似地处理所有函数，因此在所有情况下都使用虚函数表中的指针。我不需要很受欢迎。然而，在与更灵活的对象系统无缝交互的环境中实现 C++ 可能是一种好方法，例如，可以在运行时替换单个函数的语言（我的理解是这样的事情是可能的，例如，在python中）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-27T18:03:26.960

No. A vtable only contains pointers to virtual functions in the same class or file.*

# javascript - 保存和加载日期本地存储

> ID：12661293
> 
> 赞同：19
> 
> 时间：2012-09-30T12:38:46.063
> 
> 标签：javascript, local-storage

我必须将日期保存到 localStorage，当页面刷新时，我想计算从那时起已经过去了多少时间。

现在，问题来了：localStorage 将日期保存为字符串，因此在将其保存在 localStorage 中之后，尝试计算这两个日期之间的差异会返回 NaN。

在你的 javascript 控制台中试试这个：

```
var a = new Date();
var b = new Date();
console.log(b - a); //this works
localStorage.a = a;
localStorage.b = b;
console.log(localStorage.b - localStorage.a); //this doesn't work 
```

我也尝试`JSON.stringify`并`JSON.parse`尝试保持日期对象完好无损，但这也不起作用。

我的猜测是我必须解析 localStorage 中的日期。如果没有更好的方法，我该怎么做？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-30T12:39:32.630

**演示：http:** [//jsfiddle.net/AuhtS/](http://jsfiddle.net/AuhtS/)

**代码：**

```
var a = new Date();
var b = new Date();
console.log(b - a); //this works
localStorage.a = a;
localStorage.b = b;
a = Date.parse(localStorage.a); // parse to date object
b = Date.parse(localStorage.b);
console.log(b - a); // now, this will work 
```

**原因**

一切都以**字符串**形式存储在`localStorage`.

因此，当您这样做时`localStorage.b - localStorage.a`，您正在尝试从另一个字符串中减去一个字符串。这就是为什么它不起作用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-30T12:42:52.367

要将日期存储在 localStorage 中，只需执行

```
localStorage['key'] = ''+myDate.getTime(); 
```

并恢复它：

```
var myDate = new Date(parseInt(localStorage['key'], 10)); 
```

（您可能还想测试它之前定义的）

它也适用于持续时间（一个日期减去另一个日期）：只需将值用作 long（毫秒）并在字符串之间进行转换。

请注意，JSON 不包含标准化的日期格式。不要将 JSON 用于日期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-16T20:23:27.770

我会用这个：

```
var d1 = new Date();
localStorage.setItem("key", d1.getTime());
var d2 = new Date(parseInt(localStorage.getItem[key])); 
```

缺少的只是正确的空验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-27T12:38:25.297

就我而言，我需要它的`Date`类型。因此，这里是：

```
var a = new Date();
localStorage.a = a;
var c = new Date(localStorage.a); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-22T19:46:55.570

你可以简单地去：

```
var date1 = <date1>
var date2 = <date2>
localStorage.setItem('date1', date1.toString())
localStorage.setItem('date2', date2.toString())

var date1 = new Date(localStorage.getItem('date1'))
var date2 = new Date(localStorage.getItem('date2'))
var diff = date1 - date2 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-01-02T07:18:07.993

```
localStorage.setItem("date", new Date().toString()); 
```

你可以像这样直接添加

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2021-04-28T22:39:56.370

我相信 localStorage 只需要时间戳。如果我错了，请纠正我。我建议你使用 moment 库而不是 JS 内置的 Date 库。moment 更容易使用，并且有一些方便的内置函数。一种是 toString()，它允许您将数据解析为字符串。一个例子是：

```
// create a moment (the current time)
const now = moment()
// convert it to a timestamp to store it in localStorage
now.valueOf()
// get the data back in string format
now.toString() 
```

Moment 也有有用的 .fromNow() 方法，它允许您获取从创建日期到编辑它的那一刻的时间差。我希望这会有所帮助。在此处阅读文档以获取更多信息：[https ://momentjs.com/docs/](https://momentjs.com/docs/)

# git - 如果从不同的分支拉出，git 会收到警告

> ID：12661300
> 
> 赞同：1
> 
> 时间：2012-09-30T12:39:43.817
> 
> 标签：git

如果我在分支“x”上并试图从分支“y”中拉出，如何让 git 向我发出警告？

举个例子；

考虑到我当前的本地工作分支是 x 并且我正在发布：

```
git pull origin y 
```

在这一点上，我希望 git 发出类似于“您正在获取另一个分支并将其合并到当前工作分支中的警告。您要继续吗？（y/n）”

这可能吗？可能有一些配置选项？

我知道如何挽回这个错误，但是我宁愿在犯这样的错误之前得到警告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:18:20.800

无法在拉取请求之前停止 git 处理并接受用户输入。我的意思是，这是可能的，但为此您必须对 git 进行一些更改并从源代码构建它。我不会走这条路。

*在git hooks*中使用条件语句有一个漂亮的小技巧。您可以在 git 挂钩中使用 Ruby（或任何其他语言）使其成为有条件的。这`pre-commit`在任何实际处理发生之前调用的钩子或钩子中最有效。在 a 的情况下`git pull`，您可以锁定的唯一钩子是`post-merge`钩子，并且只有在整个处理完成后才会调用它。因此，没有必要真正询问用户是否要在合并分支后合并另一个分支，对 :) 但是，您可以向他们显示一条消息。

为此，请使用以下内容：

```
#!/usr/bin/env ruby

branch=$(git rev-parse --symbolic --abbrev-ref $1)
if branch != $GIT_DIR/ORIG_HEAD
  puts "You merged a different branch dim wit"
end 
```

现在，我要做的是比较合并的分支是否与原始分支名称相同，如果不是，则向用户显示一条消息。这将显示`remote`在您的 git 合并摘要中。

同样，我不确定这是否可行，因为我不确定是否`git rev-parse --symbolic --abbrev-ref $1`会给你分支名称。

这又是一个建议，而不是您问题的解决方案:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T18:37:20.410

如果您的当前分支已设置为[跟踪上游分支](https://stackoverflow.com/a/11012861/6309)（如 中`git branch --set-upstream test origin/test`），您只需：

```
 git pull origin 
```

（避免任何错误的可能性）

注意：根据您的 git 版本，这也会对您的推送操作产生影响：请参阅“[与之间`git checkout --track origin/branch`的`git checkout -b branch origin/branch`](https://stackoverflow.com/a/10002469/6309)区别”。

因此，要准确回答您的问题：**没有内置方法可以使用 git 获得该警告**。[您可以对rizwaniqbal](https://stackoverflow.com/users/1156254/rizwaniqbal)的[回答](https://stackoverflow.com/a/12665203/6309)
中推荐的钩子脚本进行版本化（赞成），但每个用户都必须在他/她自己的仓库中声明该钩子。

# wordpress - 延迟加载或查看

> ID：12661301
> 
> 赞同：1
> 
> 时间：2012-09-30T12:39:53.020
> 
> 标签：wordpress, lazy-loading, jquery-isotope

我正在使用同位素，我正在尝试让延迟加载[http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)工作。但是我还引用了一个名为 Inview 和 ImagesLoaded 的插件。

我很难让他们工作。我的困惑在于 Inview 和 Lazy Loading 之间的区别！这两个插件执行相同的功能吗？

我最初遵循本指南[http://www.haizumdesign.com/masonry-infinite-scroll-inview-a-tale-of-3-plugins/](http://www.haizumdesign.com/masonry-infinite-scroll-inview-a-tale-of-3-plugins/)但我删除了无限滚动，因为它冻结了我的浏览器。我认为加载的 Inview 和图像足以进行延迟加载，但后来我遇到了延迟加载网站，我感到很困惑。

此外，同位素似乎已经加载了图像，所以我应该停止加载单独的 js 文件吗？

请帮帮我，以下是我的同位素配置

```
jQuery(document).ready(function($) {

    $('#big_container .media_block img').each(function(index) {
        var item_height = $(this).attr("height");
        $(this).parent().parent().css("height",item_height);
    });

    $('#big_container').imagesLoaded(function(){
    $('#big_container').isotope({
    itemSelector : '.item',
    layoutMode : 'masonry',
    masonry: {
        columnWidth: 1,
    },
    sortBy : 'date',
    sortAscending : false,
    getSortData : {
        date : function ( $elem ) {
            return $elem.find('.date').text(); // Date format should be [Y-m-d H:i]
        },
        views : function( $elem ) {
            return parseInt( $elem.attr('data-views'), 10 );
          },
        //featured : function ( $elem ) {
        // return $elem.attr('data-featured');
        //  },
        rates : function( $elem ) {
            return parseInt( $elem.attr('data-rates'), 10 );
          },
        comments : function( $elem ) {
            return parseInt( $elem.attr('data-comments'), 10 );
          }
    }
    });
    }); //close imagesLoaded
    $('#sort-by li a').click(function(){
        var $this = $(this);
        if ($(this).parent().hasClass('selected') ) {
          return false;
        }
        var $optionSet = $this.parents();
        $optionSet.find('.selected').removeClass('selected');
           $this.addClass('selected');

          var sortName = $(this).attr('href').slice(1);
          $('#big_container').isotope({ sortBy : sortName });
          return false;
    });
});
$(document).on("inview", ".item", function(e) {
    var $this = $(this);
    if(!$this.hasClass('loaded')) {
        $this.addClass('loaded');
        $this.css('visibility','visible').hide().fadeIn('slow');
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:51:24.627

Image Loaded 插件包含在 Isotope 中，请参阅[文档](http://isotope.metafizzy.co/docs/help.html)。您通常使用 Paul Irish 的 Infinite Scroll 插件来实现它。至于延迟加载，[这里](https://stackoverflow.com/questions/11337291/combining-jquery-isotope-and-lazy-load)和其他地方都有关于 SO 的答案。但是，如果您正确地实现了无限滚动并且您的图像已针对使用 ImageOptim 或其他方式的快速加载进行了优化，那么您可能无论如何都不需要延迟加载。

# git - git rm --cached 文件 vs git 重置文件

> ID：12661306
> 
> 赞同：66
> 
> 时间：2012-09-30T12:40:55.657
> 
> 标签：git, git-reset, git-rm

我正在努力学习 Git。我很困惑

```
git rm --cached file 
```

和

```
git reset file 
```

这两个命令似乎都将文件从暂存区域转移到非暂存区域。命令有何不同？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-09-30T12:46:22.030

`git rm --cached <file>`将从索引中完全删除文件的内容。这意味着在提交时，文件将从提交中删除`HEAD`。（如果文件仅添加到索引中并且尚未跟踪，则这是“无操作”。）

`git reset -- <file>`将索引中文件的内容重置为与头部提交相同。这意味着在提交时不会向文件提交*任何更改*。如果提交中没有文件的跟踪版本，则此操作无效`HEAD`。

# directwrite - IDWriteTextFormat::SetTextAlignment 不适用于 DWRITE_TEXT_ALIGNMENT_JUSTIFIED

> ID：12661307
> 
> 赞同：2
> 
> 时间：2012-09-30T12:41:07.220
> 
> 标签：directwrite

IDWriteTextFormat::SetTextAlignment 用于在 DirectWrite 中对齐文本，它需要一个 DWRITE_TEXT_ALIGNMENT 类型的参数

```
enum DWRITE_TEXT_ALIGNMENT {
  DWRITE_TEXT_ALIGNMENT_LEADING,
  DWRITE_TEXT_ALIGNMENT_TRAILING,
  DWRITE_TEXT_ALIGNMENT_CENTER,
  DWRITE_TEXT_ALIGNMENT_JUSTIFIED 
}; 
```

前 3 种都运行良好，但最后一种 DWRITE_TEXT_ALIGNMENT_JUSTIFIED 不起作用，当我尝试设置它时，我得到一个无效参数错误

```
HRESULT hr = g_pTextFormat->SetTextAlignment(DWRITE_TEXT_ALIGNMENT_JUSTIFIED);
if(FAILED(hr))
{
    MessageBox(NULL, L"Center text failed!", L"Error", 0);
    return;
} 
```

![在此处输入图像描述](../Images/4faf484c897a80995ab0ce43fe41ae8a.png)

这似乎不是一个有效的论点，为什么？有人遇到同样的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T02:34:50.783

从Microsoft DirectX论坛得到了答案，因为这个标志不支持Win7，但是SDK文档没有指出。 [http://xboxforums.create.msdn.com/forums/p/108456/640004.aspx#640004](http://xboxforums.create.msdn.com/forums/p/108456/640004.aspx#640004)

# iphone - 如何获取背景音乐的当前输出 dB 值以在 iOS 中显示声级计？

> ID：12661308
> 
> 赞同：3
> 
> 时间：2012-09-30T12:41:07.780
> 
> 标签：iphone, ios, ipad, core-audio

有没有一种简单的方法可以读取它输出到扬声器/或正在播放的背景音乐的 iOS 的当前 dB 声级值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T19:29:49.330

不可以。应用程序无法获取任何其他应用程序（例如背景音乐播放器）当前正在播放的声音的音频输出电平。

# ruby-on-rails - 尝试创建用户会话 --> 没有路由匹配 {:action=>"show", :controller=>"users", :id=>nil}

> ID：12661314
> 
> 赞同：0
> 
> 时间：2012-09-30T12:42:06.640
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在完成 Michael Hart 的 Rails 教程后，我正在尝试制作自己的简单应用程序。

我设法创建了用户资源，现在正在尝试创建会话资源，以跟踪某人何时登录。我得到了一些非常古怪的结果。

1) 我试图在有人登录时和有人注销时显示不同的菜单选项。它有效，只是它的行为与我预期的相反！即当我写

```
 <ul class="nav pull-right">
          <% if signed_in? %>
               #menu for registered users
          <% else %>
               #menu for unregistered users             
          <% end %>
        </ul> 
```

当我登录时，未注册用户的#menu 出现，当我退出时，注册用户的#menu 出现。

2) 我也在尝试创建一个指向用户管理页面的链接，这基本上是用户的 id 页面。

我把它作为下面的链接代码

```
<%= link_to "Admin", user_path(current_user) %> 
```

并得到了错误

> 没有路线匹配 {:action=>"show", :controller=>"users", :id=>nil}

这让我觉得我在会话助手中定义的 current_user 没有被保存，但比我想象的要好，但我不知道为什么。

这是我为 **用户模型提供的代码**

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation
  has_secure_password

  before_save { |user| user.email = email.downcase }
  before_save :create_remember_token

  validates :name, presence: true, length: { maximum: 50 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence:   true,
                    format:     { with: VALID_EMAIL_REGEX },
                    uniqueness: { case_sensitive: false }
  validates :password, presence: true, length: { minimum: 6 }
  validates :password_confirmation, presence: true

  private

        def create_remember_token
          self.remember_token = SecureRandom.urlsafe_base64
        end

end 
```

**会话控制器**

```
class SessionsController < ApplicationController

def new
end

def create
    user = User.find_by_email(params[:session][:email].downcase)
    if user && user.authenticate(params[:session][:password])
        sign_in user
        redirect_to user
    else
        flash.now[:error] = 'Invalid Email/Password Combination' #Not quite right; 
        render 'new'
    end
end 
```

结尾

**会话助手**

```
module SessionsHelper
  def sign_in(user)
    cookies.permanent[:remember_token] = user.remember_token
    self.current_user = user
  end

  def signed_in?
    !current_user.nil?
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
  end
end 
```

**应用控制器**

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  include SessionsHelper
end 
```

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T14:29:08.030

谢谢你们的帮助！似乎我有两个错误——1）当用户在用户控制器中注册时我没有登录用户，2）我没有重新启动服务器，并执行 db:reset。尝试之后，与注销不起作用有关的其他问题已修复。

# java - @ExceptionHandler 和验证错误

> ID：12661316
> 
> 赞同：1
> 
> 时间：2012-09-30T12:42:41.897
> 
> 标签：java, spring, spring-mvc

您好我想知道如何将信息传递给异常处理程序。比如说我在做验证。惠特@Valid。我可以捕捉到那个特定的异常，但这并不能告诉我是错误的人的名字还是姓氏。

可能是带有错误字段属性的自定义异常。如果我这样做，我将如何通过它？如果验证失败，@Valid 已经抛出异常。

我可以检查绑定结果是否有错误并抛出我的自定义异常吗？如何解决这个问题？

```
@RequestMapping(value = "/post", method = RequestMethod.POST)
public String post(@Valid Person person) {
    System.out.println(person);
    System.out.println(person2);

    return "home";
}

@ExceptionHandler(Exception.class)
@ResponseBody
public List<FailureResult> handleException
    (Exception re, HttpServletResponse response) {

    FailureResult failureResult = new FailureResult();
    failureResult.setName("name");
            //wich feild failed the validation?

    List<FailureResult> r = new ArrayList<FailureResult>();
    r.add(failureResult);

    return r;
} 
```

# c++ - 使用c ++如何在finder mac osx中显示覆盖图标

> ID：12661317
> 
> 赞同：2
> 
> 时间：2012-09-30T12:42:45.703
> 
> 标签：c++, macos, qt, overlay, finder

最近我们开发了一个 MAC 安装程序（.dmg）。这是用 c++ 和 QT 开发的。我们有一个硬性要求，即在查找器中的文件上显示覆盖图标，例如 CVS/Dropbox 如何显示文件的同步状态。

我的问题与下面的帖子完全相同。我知道，如果我们尝试在 finder 中显示覆盖图标，MAC 应用商店不允许我的应用出现。我对此很好，我的用户将从网站下载该应用程序。

[如何在查找器中添加图标叠加层？](https://stackoverflow.com/questions/7991131/how-can-i-add-icon-overlay-in-finder)

我对 MAC 和 c++ 也很陌生，请您详细提供 c++ 中的建议或解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-19T16:08:09.950

我知道这个答案有点晚了，但总比没有答案好，不是吗？！

[Dropbox 使用一个名为mach_inject](https://github.com/rentzsch/mach_inject)的开源框架。最初由 Jonathan Rentzsch 开发，被称为 Mach_Star，它允许将代码注入应用程序。

Dropbox 使用它来注入 OSX Finder 应用程序。如果您在 Google 上搜索“Dropbox mach_inject”，您会发现对此的各种参考。虽然它不完全是你想要的，这里还有一个项目[也](https://github.com/infinitelabs/FinderMenu/)注入到 Finder 中，但要添加菜单项。您应该可以将其用作参考。

# php - $_GET 没有被我的 php 文件的第二页读取，但是当我尝试回显它的工作时

> ID：12661322
> 
> 赞同：-3
> 
> 时间：2012-09-30T12:43:12.117
> 
> 标签：php, html

我有一个问题`$_GET`。当我单击提交按钮时，它不会读取来自我的第一页 php 的“id”。这是 id 值来自的链接，`<?php echo $content."<p><a href='post.php?id=$pid'>Comment.</a>"?></p>`但是当我尝试运行`echo $_GET['id'];`它时，它的工作表明它具有价值。

```
<?php
if (isset($_GET['id'])) {
$c = $_GET['id'];
}
mysql_connect("localhost","root","");
mysql_select_db("blog");
?>
<html>
<head>
<body background="u.jpg">
<center>

<a href="register.php"><img src="1.jpg" width="100" height="50"/></a>
<a href="login.php"><img src="2.jpg" width="100" height="50"/></a>
<a href="index.php"><img src="3.jpg" width="100" height="50"/></a>
</center>
<center>
<title>Pinoy Blog</title>
</head>
<?php
if(isset($_POST['submit']))
{
$content = $_POST['content'];

mysql_query("INSERT INTO comment (comment,p_id) VALUE('$content','$c')");
echo '<a href="index.php">span style="font-size:26px;"><strong><span style="font-family: verdana, geneva, sans-serif; ">Success! Tignan ang post.&nbsp;</span></strong></span>.</a> 
|| <a href="post.php">Magpost ulit? Click mo to.</a>';
}else{
?>
<form action='post.php' method='post'>
<span style="font-size:26px;"><strong><span style="font-family: verdana, geneva, sans-serif; ">Comment:&nbsp;</span></strong></span>
<textarea name='content' ></textarea><br />
<input type='submit' name='submit' value='POST!'/>
</form>
<?php
}
?>

<center>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:56:13.670

1）当您从第一页到带有链接的第二页时，它被称为查询字符串，您将在 $_GET['id'] 中获得它

2）但是现在您在第二页并单击提交按钮，这意味着它是新的 http 请求，它不携带来自先前 http 请求的 $_GET 值。因此您需要将 $_GET['id'] 作为隐藏表单字段存储到第二页。

更改您的 php 代码如下

```
if (isset($_REQUEST['id'])) {
$c = $_REQUEST['id'];
} 
```

现在在您的表单中取一个隐藏字段。

```
<form action='post.php' method='post'>
   <span style="font-size:26px;"><strong><span style="font-family: verdana, geneva, sans-serif; ">Comment:&nbsp;</span></strong></span>
   <input type="hidden" value="<?php echo $_REQUEST['id'] ?>" name="id">
  <textarea name='content' ></textarea><br />
   <input type='submit' name='submit' value='POST!'/>
</form> 
```

注意：$_REQUEST 默认包含 $_GET、$_POST 和 $_COOKIE 的内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:45:40.897

您正在提交 POST 表单，然后搜索 GET 变量？？？

老实说，我很难理解这个问题，你是说当你第一次登陆页面时 $_GET['id'] 正在打印出来，但是当你在该页面上提交表单时，ID 不是那里？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T12:54:49.977

首先，您在哪里/何时`echo`输入查询字符串值以使其显示？

更重要的是，我将假设我们看到的代码是 for`post.php`并且页面本质上是提交给它自己的。我还将假设当您第一次加载页面时，您会使用查询字符串参数来执行此操作。像这样的东西：

```
/path/to/post.php?id=123 
```

但是，当您提交表单时，您会更改该 URL：

```
<form action='post.php' method='post'> 
```

现在你正在加载这样的东西：

```
/path/to/post.php 
```

URL 上没有更多的查询字符串值，所以当 PHP 代码响应这个请求时，它不会在`$_GET['id']`. 向服务器提交请求时，您需要包含查询字符串值。像这样的东西可能会起作用：

```
<form action="post.php?id=<?php echo htmlspecialchars($_GET['id']); ?>" method="post"> 
```

相反，您可以在表单中设置隐藏字段，而不是混合`POST`和值。`GET`像这样的东西：

```
<input type="hidden" name="id" value="<?php echo htmlspecialchars($_REQUEST['id']); ?>" /> 
```

然后您`form`的 '`action`不必更改，但您必须更改如何访问 PHP 代码中的值。 `$_REQUEST['id']`将从GET 值*或POST 值中提取值**，*因此它只需要存在于其中之一中。这样，在首次加载页面和将页面提交回自身时都可以使用相同的数组。

注意`htmlspecialchars()`这里的使用。我*不是*PHP 专家，但我明确尝试做的是防止一些跨站点脚本攻击，即代码会盲目地回显到页面（代表您）用户提交的输入，这可能是恶意的。 `url encode()`也可以解决问题。对于您的需求，值得进一步研究。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T12:58:06.137

```
<form action='post.php?id=<?php echo $id;?>' method='post'>
<span style="font-size:26px;"><strong><span style="font-family: verdana, geneva, sans-serif; ">Comment:&nbsp;</span></strong></span>
<textarea name='content' ></textarea><br />
<input type='submit' name='submit' value='POST!'/>
</form> 
```

它会将表单发布到 post.php?id=1 或任何其他，您将获得以下值`$_GET['id']`

替换`action='post.php'`为`action='post.php?id=<?php echo $id;?>'`

# html - svg，路径标签在 Firefox 上不起作用

> ID：12661323
> 
> 赞同：5
> 
> 时间：2012-09-30T12:43:20.273
> 
> 标签：html, firefox, path, svg, tags

我正在使用 svg 路径标签制作一张简单的地图，但它不适用于火狐或 IE（绘图本身不会出现）

听到是其中的一个样本

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
<path id="lineAB" d= "M450.59,294.28l3.64-0.29l5.97,8.44l-5.54,4.18l-4.01-1.03l-5.39,0.07l-0.87,3.16l-4.52,0.22l-1.24-1.69l1.6-5.14L450.59,294.28L450.59,294.28z" stroke="blue" stroke-width="3" fill="blue" onclick="alert('Hello')"/>
</svg> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-17T05:34:29.920

您不应该使用逗号作为`d`属性，而是使用空格。也`stroke-width`必须是一个长度（例如`px`）。这应该有效：

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
<path id="lineAB" d= "M450.59 294.28l3.64-0.29l5.97 8.44l-5.54 4.18l-4.01-1.03l-5.39 0.07l-0.87 3.16l-4.52 0.22l-1.24-1.69l1.6-5.14L450.59 294.28L450.59 294.28z" stroke="blue" stroke-width="3px" fill="blue" onclick="alert('Hello')"/>
</svg> 
```

请参阅[规范](http://www.w3.org/TR/SVG11/paths.html#PathDataBNF)以获得更长更准确的解释:)。

# asp.net - 记录未出现在表格报告服务 2008 中

> ID：12661325
> 
> 赞同：2
> 
> 时间：2012-09-30T12:43:39.000
> 
> 标签：asp.net, sql, sql-server, sql-server-2008, ssrs-2008

当我在 Reporting Services 2008 中使用表格并将字段拖入其中时，它会显示列标题的重复记录，而不是值。

这里有什么问题？

![在此处输入图像描述](../Images/b8ee18af277576374bd34c7d93f7c5ce.png)

它不是在输出中显示字段值，而是显示字段名称

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:46:13.943

数据集中的字段是计算字段，必须是查询字段

# java - String.equals() 是如何工作的

> ID：12661335
> 
> 赞同：3
> 
> 时间：2012-09-30T12:45:14.967
> 
> 标签：java, string, equals

我一直试图了解一些 API 方法是如何工作的

下面是 java.lang.String 类的 equals 方法的片段

有人可以告诉我代码实际上是如何比较两个字符串的。我明白计数的意义，但偏移意味着什么。这些变量如何获得值？

就像我创建一个字符串一样。这些是如何初始化的。

详细的逐行描述以及实例变量、值、计数、偏移量等初始化的方式和时间？

```
 public boolean equals(Object anObject) {
  1014           if (this == anObject) {
  1015               return true;
  1016           }
  1017           if (anObject instanceof String) {
  1018               String anotherString = (String)anObject;
  1019               int n = count;
  1020               if (n == anotherString.count) {
  1021                   char v1[] = value;
  1022                   char v2[] = anotherString.value;
  1023                   int i = offset;
  1024                   int j = anotherString.offset;
  1025                   while (n-- != 0) {
  1026                       if (v1[i++] != v2[j++])
  1027                           return false;
  1028                   }
  1029                   return true;
  1030               }
  1031           }
  1032           return false;
  1033       } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T12:52:29.777

逻辑上

```
while (n-- != 0) {
if (v1[i++] != v2[j++])
    return false;
} 
```

是相同的

```
for (int i = 0; i < n; i++) {
    if (v1[i] != v2[j])
        return false;
    }
} 
```

我不确定为什么 JVM 设计者会这样做。也许使用 while 循环比使用 for 循环可以提高性能。它在我看来很像 C，所以也许写这篇文章的人有 c 的背景。

`Offset`用于定位字符串在 char 数组中的起始位置。内部字符串存储为 char 数组。这是`value`

```
if (v1[i++] != v2[j++])
    return false; 
```

检查字符串底层 char 数组中的字符。

并逐行是

如果引用指向同一个对象，则必须等于

```
1014           if (this == anObject) {
1015               return true;
1016           } 
```

如果对象是字符串，则检查它们是否相等

```
1017           if (anObject instanceof String) { 
```

将传入的参数转换为字符串。

```
1018               String anotherString = (String)anObject; 
```

记住 this.string 的长度

```
1019               int n = count; 
```

如果两个字符串的长度匹配

```
1020               if (n == anotherString.count) { 
```

得到一个字符数组（值就是这个数组）

```
1021                   char v1[] = value;
1022                   char v2[] = anotherString.value; 
```

找出这个数组中字符串的开始位置

```
1023                   int i = offset;
1024                   int j = anotherString.offset; 
```

遍历 char 数组。如果值不同，则返回 false

```
1025                   while (n-- != 0) {
1026                       if (v1[i++] != v2[j++])
1027                           return false;
1028                   } 
```

其他一切都必须是真的

```
1029                   return true;
1030               }
1031           } 
```

如果不是 String 类型，则它们不能相等

```
1032           return false;
1033       } 
```

要了解偏移量和值，请查看 String 类

```
/** The value is used for character storage. */
private final char value[];

/** The offset is the first index of the storage that is used. */
private final int offset;

/** The count is the number of characters in the String. */
private final int count; 
```

构造函数初始化这些变量。默认构造函数代码如下。对于其他构造函数，您应该会看到类似的内容。

```
/**
  * Initializes a newly created {@code String} object so that it represents
  * an empty character sequence.  Note that use of this constructor is
  * unnecessary since Strings are immutable.
  */
 public String() {
    this.offset = 0;
    this.count = 0;
    this.value = new char[0];
 } 
```

[这](http://illya-keeplearning.blogspot.co.uk/2009/03/java-string-internals.html)是一个很好的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T12:52:42.170

正如您可能知道的那样，Java 中的字符串处理是一种特殊情况，大多数情况下，字符串是从字符串池中分配的，因此对于 char 数组`"I am Learning Java"`，一个字符串引用指向`"I am Learning Java"`，然后偏移量可能是`0`，其他字符串可能指向`"am"`这样的偏移量`2`。**由于一些本机代码处理其初始化，所以我认为在该过程中设置了偏移量。（在从字符串池共享内存期间）**

从代码中也可以看出

```
 public String(String original) {
         int size = original.count;
        char[] originalValue = original.value;
        char[] v;
        if (originalValue.length > size) {
            // The array representing the String is bigger than the new
          // String itself.  Perhaps this constructor is being called
            // in order to trim the baggage, so make a copy of the array.
           int off = original.offset;
          v = Arrays.copyOfRange(originalValue, off, off+size);
        } else {
           // The array representing the String is the same
          // size as the String, so no point in making a copy.
            v = originalValue;
       }
      this.offset = 0;
       this.count = size;
       this.value = v;
    } 
```

当从旧字符串创建新字符串时，可能是旧字符串（在这种情况下为原始字符串）可能来自字符串池，这就是为什么首先获取偏移量然后复制整个数组以分配新内存（新字符串不共享来自字符串池的内存）

您还应该记住 String 是派生类型，并且字符串始终存储在字符数组中，因此我们需要一个偏移量来确定字符串在字符数组中的起始位置。

# android - Twitter API 和将 Jars 添加到构建路径

> ID：12661336
> 
> 赞同：0
> 
> 时间：2012-09-30T12:45:26.087
> 
> 标签：android, eclipse, jar, buildpath

我正在尝试第一次手动将 jar 文件添加到我的项目中。我已经下载了 Twitter4j 以便在我的应用程序中使用这些 API。我提取了 twitter4j-core-2.2.6-sources.jar 和 twitter4j-core-2.2.6-javadoc.jar 并将它们复制到我的 /libs 文件夹中。刷新 eclipse 中的文件夹并将 2 个文件添加到我的构建路径中。在“引用库”和“android 依赖项”文件夹中，我可以看到我的 2 个新 jar。但是我现在有以下问题：a）无法查看源（如果无法查看，我会理解，我是 C++ 程序员，我是否必须依靠文档来了解 Java 中的 API 名称？ ）b）在eclipse中，javasources也看不到：当我点击一个项目时，我得到：打开编辑器时出现问题。原因打开 (Annotations.xml) 的编辑器时出现问题无法打开外部编辑器 null xxx (org. eclipse.ui.browser.editorsupport) c) 我将示例文件之一添加到我的项目中，但它无法编译：import twitter4j.Status; ==> 导入 twitter4j.Status 无法解析

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T12:52:32.777

不要创建 lib 文件夹..您应该有 libs 文件夹，eclipse 会自动将其中的所有内容添加到您的构建路径中。除了把罐子放在那里，你不需要做任何其他事情。

# ios - 在应用程序图标上添加“新”横幅

> ID：12661337
> 
> 赞同：0
> 
> 时间：2012-09-30T12:45:30.430
> 
> 标签：ios, xcode

一些新安装的应用程序在应用程序图标的右上角有一个“新”横幅。

我可以通过编程添加此横幅吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:09:47.893

操作系统会在下载应用程序后执行此操作，并在应用程序首次运行时将其删除。我 99% 确定，一旦删除此横幅，您将无法以编程方式将其添加到您的应用中。只有其他解决方案是在图标本身中添加横幅，或者如果您正在寻找一种通知“新”更新的方法，那么请使用图标徽章编号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:10:01.913

当您的设备运行 iOS6 时，新横幅会自动显示在新安装的应用程序（来自 App Store）的图标上。因此，我认为不可能也没有必要以编程方式将其应用于图标。

# python - 使用现有的 Python 发行版安装 Enthought Python 发行版

> ID：12661342
> 
> 赞同：0
> 
> 时间：2012-09-30T12:46:20.007
> 
> 标签：python, installation, ipython, sage, enthought

我目前正在尝试安装 Enthought Python Distribution (EPD)，并拥有现有的 python 发行版。我目前安装了`ipython`，`numpy`以及许多其他工具，以及 Sage（一个开源 Python 科学/数学发行版）。

当我尝试安装 EPD 时，我尝试`ipython`使用`import pandas`EPD 中包含的 进行测试。这给了我一个错误。**如何使 EPD 成为我的默认 python 发行版？**

我`$PATH`的是这样的：`Users/scott/.zcm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/texbin`

我`$PYTHONPATH`的当前是空的。

编辑：我还安装了 ZSH，正在运行 Mac，还有更多其他东西。事实证明，问题出在 ZSH 上。在我的`.zshrc`中，我必须添加：是在`export $PATH=/Library/Frameworks/EPD64.framework/Versions/7.3/bin:$PATH`其余部分*之前*添加的。`/Library/...`*`$PATH`*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:50:57.967

我还安装了 ZSH，正在运行 Mac，以及更多其他东西。

事实证明问题出在 ZSH 上，`.zshrc`我不得不添加以下内容：

```
export $PATH=/Library/Frameworks/EPD64.framework/Versions/7.3/bin:$PATH 
```

是在其余`/Library/...`部分之前添加的`$PATH`。*

# php - 如何将动态 facebook like 按钮添加到页面中？

> ID：12661346
> 
> 赞同：2
> 
> 时间：2012-09-30T12:46:30.147
> 
> 标签：php, facebook-like

我是这个网站的新手。

我之所以说“动态..”是因为，我知道如何创建点赞按钮，但那是针对一页的。但是，我正在建立一个新闻网站，而不是在每条新闻和文章上手动输入 Facebook 代码，我希望这会在新的和动态创建的页面上自动发生，这样我就不必每次发布时都放置它们页面上的一篇文章。

通常我的页面 URL 会像 www.site.com/articles.php?id=12

所以id，是它唯一改变的东西，所以我不知道在那之后该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T12:54:35.637

您需要替换嵌入代码中的 URL。像

```
<div class="fb-like" data-href="<?=$current_url?>" data-send="true" data-width="450" data-show-faces="true"></div> 
```

所有你需要`$current_url`用适当的 url 替换变量

但是，如果您省略 ，`data-href`它将使用当前 URL（XFBML 版本）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T12:51:08.427

欢迎来到堆栈溢出！

请参阅[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

只需输入页面的 URL (http://www.site.com/articles.php?id=12) 并单击“获取代码”。将出现一个带有说明的弹出窗口。然后，对于您的其他页面，当您嵌入类似按钮的代码时，您只需将“href”参数更改为您正在显示的文章的 URL。

# lua - Lua 新手，对错误感到困惑

> ID：12661347
> 
> 赞同：1
> 
> 时间：2012-09-30T12:46:32.367
> 
> 标签：lua, eof, minecraft

我最近开始对 Lua 编程感兴趣，我使用了一个名为 Computercraft 的 Minecraft 插件，它涉及基于控制台的 GUI 来使用 Lua 控制计算机和其他东西。但是，我似乎随机收到一个错误，其中代码需要称为“eof”的东西。我搜索了多本手册和操作方法，但没有人提到这个特定的错误。事实上，我很难找到带有错误列表的任何内容。我对编程很陌生，但有基本的 Python 经验。谁能解释一下“eof”是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T05:25:21.717

`eof`是`do`或`then`。_

通常`eof`意味着你有太多（或不够）的`end`陈述。粘贴代码可能吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T06:43:00.817

Suppose I create a file with one too many `end` statements:

`> edit test.lua`

```
for i = 1, 10 do
  print(i)
end
end 
```

When I run it, and `lua` encounters that extra `end` statement on the last line where there is no code block still open, you'll get an error like:

`> test.lua`

```
bios: 337: [string "test.lua"]: 4: '<eof>' expected 
```

(from a quick test in [CCDesk pr7.1.1](http://ccdesk.afterlifelochie.net/))

Problems with the basic structure of the blocks of lua code show up with `bios` on the left rather than your file name; the part of `bios` that loads lua files will usually tell you where it was at in the file when couldn't make sense of the code anymore (like line `4:` here). Sometimes it might be a bit of a puzzle to work your way from the scene of the accident back to where things got off track. =)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-29T23:07:54.700

使用 ESPlorer，“上传”脚本和“发送”脚本是有区别的。使用“上传”。

这与报告的问题不同，但搜索让我来到这里......

# c# - 假人的自定义等待对象

> ID：12661348
> 
> 赞同：29
> 
> 时间：2012-09-30T12:46:32.967
> 
> 标签：c#, .net, asynchronous, .net-4.5, async-await

在[Async/Await FAQ](http://blogs.msdn.com/b/pfxteam/archive/2012/04/12/10293335.aspx)中，Stephen Toub 说：

> awaitable是公开返回有效 awaiter 的方法**的***任何*类型。 ... awaiter是从**awaitable**的方法返回的*任何*类型，*并且*符合特定模式。`GetAwaiter` *****`GetAwaiter`*****

 *****所以为了成为一个*awaiter*，一个类型应该：

*   实现[`INotifyCompletion`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.inotifycompletion.aspx)接口。
*   提供一个名为 的布尔属性`IsCompleted`。
*   提供一个返回or的无参数`GetResult`方法。`void``TResult`

（*我暂时忽略`ICriticalNotifyCompletion`。*）

我知道我提到的页面有一个示例，该示例显示了编译器如何翻译等待操作，但我仍然很难理解。

当我*等待*一个*awaitable*时，

*   什么时候`IsCompleted`检查？我应该在哪里设置它？
*   什么时候`OnCompleted`调用？
*   哪个线程调用`OnCompleted`？
*   我看到了直接调用 continuation 参数`OnCompleted`和`Task.Run(continuation)`在不同示例中使用的示例，我应该选择哪个，为什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-30T13:00:38.857

为什么要自定义等待者？

`await` [您可以在此处](http://blogs.msdn.com/b/lucian/archive/2011/04/15/async-ctp-refresh-design-changes.aspx)查看编译器的解释。本质上：

```
var temp = e.GetAwaiter();
if (!temp.IsCompleted)
{
  SAVE_STATE()
  temp.OnCompleted(&cont);
  return;

cont:
  RESTORE_STATE()
}
var i = temp.GetResult(); 
```

**从评论中编辑：** `OnCompleted`应该将其参数安排为异步操作的延续。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-30T13:05:53.003

在绝大多数情况下，您作为开发人员不必担心这一点。使用`async`and`await`关键字，编译器和运行时会为您处理所有这些。

要回答您的问题：

> 代码何时检查 IsCompleted？我应该在哪里设置它？

`IsCompleted`当任务完成它正在做的事情时，任务应该设置。例如，如果任务正在从文件加载数据，则在加载数据`IsCompleted`并且调用者可以访问它时应该返回 true。

> 它什么时候调用 OnCompleted？

OnCompleted 通常包含一个由调用者提供的委托，以便在任务完成时执行。

> 它是并行调用 OnCompleted 还是 OnCompleted 中的代码应该是异步的？

OnCompleted 中的代码应该是线程中立的（不关心它是从哪个线程调用的）。这对于更新单线程公寓中的 COM 对象（如 Metro/Windows8/Windows Store 应用程序中的任何 UI 类）可能会有问题。它不必是异步的，但可以包含异步代码。

> 我看到了直接调用 OnCompleted 的 continuation 参数和在不同示例中使用 Task.Run(continuation) 的示例，我应该在什么时候使用？

尽可能使用`async`/ `await`。否则，请使用 Task.Run() 或 Task.Wait()，因为它们遵循大多数人习惯的顺序编程模型。可能仍需要使用延续，尤其是在您遇到公寓问题的 Metro 应用程序中。*****

# c# - 通用协方差问题

> ID：12661353
> 
> 赞同：1
> 
> 时间：2012-09-30T12:47:16.807
> 
> 标签：c#, generics, covariance

我正在尝试制定一些通用接口，其中包括 Dictionary 及其包含的项目，这两者目前看起来都像下面的代码。

正如你所看到的，我在 Dictionary 上进行了下注，使值成为对象。理想情况下，我想要一个具有 TParentMOdel 的协变 KEY 和 TModel 的协变值的接口，就像项目一样，但到目前为止我还不能解决这个问题（也不确定它是否可能）。

在我尝试在下面的最后一个使用示例中添加最后一项之前，我所做的似乎有效。GenderVm 本质上是一个 ISatteliteVm

似乎问题在于 Gender 是一个枚举，这对我*来说*并不完全有意义。本例中的 TParentModel 是 Person，它是 Party 的子类。协方差似乎在这里起作用，因为我可以添加其他项目，其中 TParentModel 是一个人。

这就是为什么我说问题*似乎*在于价值性别。它是一个枚举，虽然枚举是一个对象，但我*认为*类型约束系统不支持枚举。

有没有简单的解决方法，比如演员表？A 有人看到设计 SatelliteMap 的更好方法吗？

干杯，
贝里尔

# 物品

```
public interface ISatelliteVm<out TParentModel, out TModel> : ISatelliteVm
{
    TParentModel ParentModel { get; }
    TModel Model { get; }
} 
```

# 字典

```
public class SatelliteVmMap<TParentModel> : Dictionary<Type, ISatelliteVm<TParentModel, object>>, IEditableObject, IIsDirty
{

    public void Add(ISatelliteVm<TParentModel, object> item) {
        if (item == null)
            throw new ArgumentNullException("item");
        Add(item.GetType(), item);
    }
} 
```

# 用法（包含 SatelliteMap 的抽象类）

```
public interface IHubViewModel<out TModel> where TModel : Entity
{

    public void AddSatelliteVm(ISatelliteVm<TModel, object> vm) {
        if (_satelliteVmMap == null) {
            _satelliteVmMap = new SatelliteVmMap<TModel>();
        }
        if (_satelliteVmMap.ContainsKey(vm)) return;

         _satelliteVmMap.Add(vm);
    }
} 
```

# 用法（包含多个 ISatelliteVm 条目的子类）

```
 public abstract class PartyDetailVm : HubViewModel<Party>
{
    ...

    public LifespanVm LifespanVm { get { return GetSatelliteVm<LifespanVm>(); } }
    public AvatarVm AvatarVm { get { return GetSatelliteVm<AvatarVm>(); } }
    public TelecomNumberPcmShellVm TelecomNumberPcmShellVm { get { return GetSatelliteVm<TelecomNumberPcmShellVm>(); } }

    ...
} 
```

# 用法（包含多个 ISatelliteVm 条目的子类）

```
public class PersonDetailVm : PartyDetailVm
{
    ...

    public PersonNameVm PersonNameVm { get { return GetSatelliteVm<PersonNameVm>(); } }
    public HonorificVm HonorificVm { get { return GetSatelliteVm<HonorificVm>(); } }

    // THIS is the problem child I cannot add to the map
   ** public GenderVm GenderVm { get { return GetSatelliteVm<GenderVm>(); } } **

 } 
```

# 错误

> 错误 82 参数 1：无法从“Parties.Presentation.ViewModels.PimDetailVms.PersonDetailVms.GenderVm”转换为“Core.Presentation.Wpf.ViewModels.MasterDetailVms.DetailVms.SatelliteVms.ISatelliteVm”

# 为比利编辑

比利，SatelliteVm 只是一个实现 ISatelliteVm 的基类。Person 是 Party 的子类，Gender 是枚举。

```
public class GenderVm : SatelliteViewModel<Person, Gender>
{
} 
```

对 GenderVm 的更改似乎可以解决问题（不知道为什么！）

```
 public class GenderVm : SatelliteViewModel<Person, Gender>, ISatelliteVm<Party, object>
{

    Party ISatelliteVm<Party, object>.ParentModel { get { return base.ParentModel; } }

    object ISatelliteVm<Party, object>.Model { get { return base.Model; } }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T17:41:16.483

请参阅[文档](http://msdn.microsoft.com/en-us/library/dd233059.aspx)：

> 泛型接口的变化仅支持引用类型。值类型不支持方差。例如，`IEnumerable<int>`不能隐式转换为`IEnumerable<object>`，因为整数是由值类型表示的。

这必须解决您的问题。

也许你应该改变`Gender`成为一个班级？

# asp.net - 如何触发重置密码？

> ID：12661356
> 
> 赞同：2
> 
> 时间：2012-09-30T12:47:48.060
> 
> 标签：asp.net, sql, tsql, asp.net-membership

我在 Microsoft .NET 4.0 环境中工作。在我的应用程序中，我使用户能够获得新的自动密码。所以我在我的 .cs 文件中使用了这个方法：

```
MembershipUser user = Membership.GetUser();
user.ResetPassword(); 
```

我想在重置密码时触发，这意味着：当密码更改为自动密码时，将向用户的电子邮件地址发送一封电子邮件，其中包含新密码（从 user.ResetPassword() 返回）。

我使用标准的会员数据库表。

我写了以下触发器：

```
CREATE TRIGGER MembershipChangePass ON aspnet_Membership
AFTER UPDATE,DELETE
AS
BEGIN

DECLARE @user uniqueidentifier
DECLARE @email nvarchar(256)

SELECT @user = (SELECT UserId FROM UPDATED)
SELECT @email =(SELECT LoweredEmail FROM aspnet_Membership
            WHERE @user=UserId)

EXEC xp_sendmail @email, ??? 

END
GO 
```

1.  问题是我如何获得？？？- 我通过方法创建的新自动密码：user.ResetPassword();
2.  我可以将 TRIGGER 定义为仅与 user.ResetPassword() 一起使用，而不是与其他方法一起使用（例如：（user.ChangePassword(...)）吗？
3.  也许还有另一种简单的方法来触发重置密码？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:10:57.970

该`ResetPassword()`方法返回您可以获取并发送给用户的新密码

```
string newPassword = user.ResetPassword();

string toAddr = "user email here";
string subject = "Password reset notification";
string body = "Your new password is "+newPassword;

//mail.Send(fromAddr, toAddr, subject, body); 
```

# sql - 执行删除和更新其他表中的相应行

> ID：12661364
> 
> 赞同：1
> 
> 时间：2012-09-30T12:48:49.927
> 
> 标签：sql, oracle, plsql, cursor, oracle11g

我有以下表格

```
CREATE TABLE A2SKU 
(
  SKUID NUMBER NOT NULL,
  SKUNAME VARCHAR2(20),
  SKUQTY NUMBER, 
  CONSTRAINT A2SKU_PK PRIMARY KEY (SKUID)
);

CREATE TABLE A2LOC 
(
  LOCID NUMBER NOT NULL, 
  LOCNAME VARCHAR2(20), 
  LOCQTY NUMBER, 
  MAXQTY NUMBER, 
  CONSTRAINT A2LOC_PK PRIMARY KEY (LOCID)
);

Create Table A2BOX ( 
boxId NUMBER Primary Key, 
skuId NUMBER, 
locId NUMBER, 
constraint FK_A2BOX_SKUID foreign key (skuid) references A2SKU, 
constraint FK_A2BOX_LOCID foreign key (locid) references A2LOC
);

CREATE SEQUENCE A2BOXSEQ; 
```

我想从 A2Box 表中删除所有具有匹配 SKU 的框，并将每个框的 A2Loc 表中匹配位置的 LocQty 调整 1

我如何使用存储过程来做到这一点。

我尝试了自己并想出了这个

```
create or replace procedure A2DeleteSKU
(
pskuid IN number
)
AS
CURSOR row_cursor IS
      SELECT boxid,locid from A2BOX where skuid =  pskuid;
skuid_count Number;
skuid_check exception;

sku_rec row_cursor%rowtype;

Begin
select count(*) into skuid_count from A2SKU where skuid = pskuid;
if skuid_count <1 then
raise skuid_check;
End If;

 FOR sku_rec in row_cursor 

LOOP 
    delete from a2box where boxid = sku_rec.boxid;
    update A2LOC set locqty = locqty -1 where locid = sku_rec.locid;
 END LOOP;

   delete from A2SKU where skuid =pskuid;
   commit;
Exception
When skuid_check then
  RAISE_APPLICATION_ERROR(-20014, 'Delete Box failed. Boxid does not exist: '||TO_CHAR(pskuid));
When others then
raise;
End A2DeleteSku; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:00:15.357

[这是使用RETURNING INTO](http://docs.oracle.com/cd/E11882_01/appdev.112/e25519/returninginto_clause.htm#LNPLS01354)子句的绝佳机会，当它与[BULK COLLECT](http://docs.oracle.com/cd/E11882_01/timesten.112/e21639/sqlexamples.htm#TTPLS337)结合使用时会非常有用。

为了使用它，您必须设置一个数组来保存`locid`您要删除的内容。由于`locid`每个 s 可能有多个 s `SKUID`，因此您可能必须将每个 s 的数量减少一个以上`locid`。

```
create or replace procedure remove_boxes ( PSKUID number ) is

   -- Set up an array to hold the deletes
   type t__locid is table of a2loc.locid%type index by binary_integer;
   t_locid t__locid;

begin

   -- Delete the rows and return the deleted locids
      delete from a2box
       where skuid = PSKUID
   returning locid
        bulk collect into t_locid
             ;

   for i in t_locid.first .. t_locid.last loop
      update a2loc
         set locqty = locqty - 1
       where locid = t_locid(i)
             ;
   end loop;

end remove_boxes;
/ 
```

有可能您可以将其更改`for .. loop`为 a `forall`，但我以前从未这样做过，也找不到您可以这样做的确认。如果可能的话，它看起来像这样：

```
forall i in t_locid.first .. t_locid.last
   update a2loc
      set locqty = locqty - 1
    where locid = t_locid(i)
          ; 
```

正如[Tom Kyte 建议](http://tkyte.blogspot.co.uk/2009/10/httpasktomoraclecomtkyteunindex.html)的那样，我强烈建议索引外键；在这种情况下肯定会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:18:03.817

```
CREATE PROCEDURE remove_boxes(pp_skuId NUMBER) IS
BEGIN
    UDPATE a2loc SET locqty = locqty - 1
      WHERE locid IN (SELECT locid FROM a2box
                        WHERE skuId = pp_skuId);
    DELETE FROM a2box
      WHERE skuId = pp_skuId;
END; 
```

我不确定您将 locqty 调整为 1 是什么意思。您必须以正确的方式修改更新命令

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:15:10.807

据我了解，A2LOC 上的 LOCQTY 列代表具有相应 locid 的框的摘要，您希望在移除框时对其进行调整。因此，请检查以下代码：

```
create or replace procedure adjustLoc(p_skuid number) is
begin

-- Adjusts the locqty value
update A2LOC loc
  set LOCQTY = LOCQTY  -1
 where exists(select 1 
                from A2BOX box
               where box.locid = loc.locid
                 and box.skuid = p_skuid);

-- Removes all sku matching boxes
Delete A2BOX 
where skuid = p_skuid;

end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T14:12:04.233

```
create or replace procedure A2DeleteSKU
(
pskuid IN number
)
AS
CURSOR row_cursor IS
      SELECT boxid,locid from A2BOX where skuid =  pskuid;
skuid_count Number;
skuid_check exception;

sku_rec row_cursor%rowtype;

Begin
select count(*) into skuid_count from A2SKU where skuid = pskuid;
if skuid_count <1 then
raise skuid_check;
End If;

 FOR sku_rec in row_cursor 

LOOP 
    delete from a2box where boxid = sku_rec.boxid;
    update A2LOC set locqty = locqty -1 where locid = sku_rec.locid;
 END LOOP;

   delete from A2SKU where skuid =pskuid;
   commit;
Exception
When skuid_check then
  RAISE_APPLICATION_ERROR(-20014, 'Delete Box failed. Boxid does not exist: '||TO_CHAR(pskuid));
When others then
raise;
End A2DeleteSku; 
```

# java - 打开时只调用一次函数

> ID：12661365
> 
> 赞同：1
> 
> 时间：2012-09-30T12:49:04.693
> 
> 标签：java, android

需要你的帮助！
如何在我的应用程序中打开时只调用一次该函数？
**我愿意：**

```
private boolean is_first = true;

@Override
public void onCreate(Bundle savedInstanceState) {

    if ( is_first ) {

        MyFirstFunction();   

    }    

}

public void onResume(Bundle savedInstanceState) {
    super.onResume();
    is_first = false;
} 
```

同样在清单文件中添加到活动中`android:configChanges="orientation"`，但在您转动设备重新启动时仍然有效

我希望能得到你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T12:53:07.553

您可以使用 Application 类在`onCreate`您可以调用函数的方法中执行此操作

```
public class MyApp extends Application {

    @Override
    public void onCreate() {
        //this will be called each time you open the application 
        super.onCreate();
//call you function here 

    }   
} 
```

然后将此类添加到清单中

```
 <application
        android:name=".MyApp or your class name" 
......
....> 
```

# android - 保存、加载可扩展列表视图复选框状态以共享首选项 - 必须有更好的方法

> ID：12661373
> 
> 赞同：0
> 
> 时间：2012-09-30T12:51:06.470
> 
> 标签：android, arraylist, sharedpreferences, performance

基本上，我有一个带有复选框的可扩展列表视图，我希望将它们的状态保存到共享首选项中。我正在实施的方法有效，但我有一种感觉，这并不是它可能的全部。看到它崩溃我不会感到惊讶。基本上使用我的方法，我通过序列化加载和保存我的活动类中的状态。

```
SharedPreferences settings3 = getSharedPreferences("MYPREFS", 0);    
        try {
            check_states = (ArrayList<ArrayList<Integer>>) ObjectSerializer.deserialize(settings3.getString("CBSTATES", ObjectSerializer.serialize(new ArrayList<ArrayList<Integer>>())));
        } catch (IOException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } 
```

中间还有一些代码。

```
protected void onStop() {
            SharedPreferences settings3 = getSharedPreferences("MYPREFS", 0);
            SharedPreferences.Editor editor3 = settings3.edit();
            try {
                editor3.putString("CBSTATES", ObjectSerializer.serialize(check_states));
            } catch (IOException e) {
                e.printStackTrace();
            }
            editor3.commit();
        } 
```

为了从我的实际可扩展适配器中获取数组列表，我将它实例化为静态变量并进行传输。在我的 espandablelistadpater 类中 -->

```
//  set checkbox states
    static ArrayList<ArrayList<Integer>> check_states = new ArrayList<ArrayList<Integer>>();
    public void setChildrenAndValues() {
        //initialize the states to all 0;
        for(int i = 0; i < children.length; i++) {
            ArrayList<Integer> tmp = new ArrayList<Integer>();
            for(int j = 0; j < children[i].length; j++) {
                tmp.add(0);
            }
            check_states.add(tmp);
        }
    } 
```

这是getChildView

```
public View getChildView(final int groupPosition, final int childPosition, boolean isLastChild,
            View convertView, ViewGroup parent) {
        LayoutInflater childInflate = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View childView = childInflate.inflate(R.layout.mtopics_childview, parent, false);

        TextView childtxt = (TextView)childView.findViewById(R.id.mtopicschildtv);
        childtxt.setText(getChild(groupPosition, childPosition).toString());

        //      Load the checkbox states        
        setChildrenAndValues();

        final CheckBox childcb = (CheckBox)childView.findViewById(R.id.mtopicchildchkbox);

        if (check_states.get(groupPosition).get(childPosition) == 1) {
            childcb.setChecked(true);
        }else{ childcb.setChecked(false);
        }

        childcb.setOnClickListener(new OnClickListener() {  
            public void onClick(View v) {
                if (childcb.isChecked()) {
                    check_states.get(groupPosition).set(childPosition, 1);
                }else{ check_states.get(groupPosition).set(childPosition, 0);
                }
            }
        });

        return childView; 
```

我只是想知道我是否一切正常，或者我是否错过了一步，因为我实际上可以感觉到减速，尤其是在反序列化时。也许我应该在另一个线程中执行此操作（无论这意味着什么）。我是否以正确的方式使用静态变量，因为我在两个方向上都在改变它们。也许我错过了一个 if null 语句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T23:10:58.570

ArrayLists 有一个 CAPACITY，你可以在声明/初始化实例时显式设置它；a 如果您未指定容量，则应用默认值。

每当元素的数量超过容量时，该容量就会被重置。我没有使用过 ArrayLists，但假设它们表现为类似的集合，超出容量会导致容量增加到更大的值，然后为新容量分配空间，然后从“旧”较小的值中复制所有值存储到新的。

我想，这就是减慢代码速度的原因：每次增加容量时，都会重复复制越来越多的数据。

验证（和补救）：尝试初始化您的数组列表 - 使用将整数作为初始容量参数的构造函数 - 使用它们最终将采用的大小，即 children.length

# php - Wordpress 单页、类别和档案菜单当前项

> ID：12661378
> 
> 赞同：1
> 
> 时间：2012-09-30T12:51:55.370
> 
> 标签：php, wordpress, navigation, html-lists

我无法理解如何执行以下操作。

在我的网站上，我有一个菜单：

> **主页 | 关于 | 技能 | 投资组合 | 接触**

要调用上面的菜单，我的 header.php 文件中有以下内容：

```
<nav>
             <?php wp_nav_menu( $args ); ?> 

        </nav> 
```

在页面处于活动状态时，链接的背景颜色会发生变化，这是生成的 CSS 和 HTML：

```
header ul li a
      {
border-radius: 4px;
    background-color: transparent;
    border: 1px solid transparent;
    color: #939393;
    margin: 0px;
    border-image: initial;
    padding-left: 5px;
    padding-right: 5px;
    padding-top: 3px;
    padding-bottom: 3px;
    font-size: 18px;
    text-decoration: none;
      }

    header ul li.current-menu-item a,
    header ul li a:hover
      {
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    -o-border-radius: 4px;
    -ms-border-radius: 4px;
    -khtml-border-radius: 4px;
    border-radius: 4px;
    background-color: rgba(0, 0, 0, 0.042);
    border: 1px solid rgba(0, 0, 0, 0.15);
    margin: 0;
    border-image: initial;
    padding-left: 5px;
    padding-right: 5px;
    padding-top: 3px;
    padding-bottom: 3px;
    color: #939393;
      }

    header ul li.selected {
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    -o-border-radius: 4px;
    -ms-border-radius: 4px;
    -khtml-border-radius: 4px;
    border-radius: 4px;
    background-color: rgba(0, 0, 0, 0.042);
    border: 1px solid rgba(0, 0, 0, 0.15);
    margin-top: -3px;
    border-image: initial;
    padding-left: 0px;
    padding-right: 0px;
    padding-top: 3px;
    padding-bottom: 3px;
    color: #939393;
     } 
```

下面是生成的 HTML：

```
<nav>
   <div class="menu-main-navigation-container"><ul id="menu-main-navigation" class="menu"><li id="menu-item-42" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-42"><a href="http://localhost:8888/paulkenyon/home/">Home</a></li>
   <li id="menu-item-41" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-41"><a href="http://localhost:8888/paulkenyon/about/">About</a></li>
   <li id="menu-item-45" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><a href="http://localhost:8888/paulkenyon/skills/">Skills</a></li>
   <li id="menu-item-56" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-56"><a href="http://localhost:8888/paulkenyon/portfolio/">Portfolio</a></li>
   <li id="menu-item-49" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-49"><a href="http://localhost:8888/paulkenyon/contact/">Contact</a></li>
   <li id="menu-item-52" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-50 current_page_item menu-item-52"><a href="http://localhost:8888/paulkenyon/blog/">Blog</a></li>
   </ul></div> 

        </nav> 
```

以上工作正常，但我想要实现的是当用户点击博客文章或存档或选择一个类别时，我希望“博客”链接使用不同颜色的背景图像保持突出显示。

目前没有任何显示。有没有我可以使用的功能来说明所有单个和存档页面以突出显示“博客”锚点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T01:49:37.413

不知道这篇文章是否仍然相关，但我今天以相当动态的方式解决了一个类似的问题，没有使用 JavaScript 来定位特定的 ID。

在您的 body HTML 标签上，确保您使用 body_class 函数，如下所示：

```
<body <?php body_class(); ?>> 
```

这告诉 WordPress 提供一些有用的 CSS 类来反映您当前所在的页面。例如，如果您当前在存档页面上，则 body 标记现在将具有`archive`CSS 类。如果您在类别页面上，body 标签将有一个`category`类，如果您在单个帖子页面上，body 标签将有一个`single-post`类，依此类推（检查元素以查看 WordPress 提供了哪些附加类）。

接下来，您要在 WordPress 管理界面的“菜单”页面上为您的目标菜单项指定一个 CSS 类（确保从“屏幕选项”窗格中勾选“CSS 类”选项）。如果是您的博客菜单项，您可能会给它类似`menu-item-blog`.

现在，当您在单个帖子页面上时，您可以使用 CSS 专门定位您的“博客”菜单项，如下所示：

```
body.single-post .menu-item-blog {
    /* Your highlight style goes here */
} 
```

现在，我知道这不是一个完美的解决方案，因为您仍然需要在单个菜单项上设置自定义 CSS 类，但我喜欢可以从管理界面而不是代码来实现。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T11:46:17.307

这是一个小的**php - jquery**组合脚本。

**wordpress 的 PHP 函数**检查页面是存档、类别还是单个帖子页面。

然后在 Jquery 的帮助下，我们将类“ **current-menu-item”**添加到 li，**id 为“menu-item-52”**，即“Blog”li。

请在 wordpress 博客的标题中添加以下脚本。

```
<?php

if(is_archive() || is_category() || is_single())
{
    ?>
    <script type="text/javascript">
    $(document).ready(function(){

        $("li#menu-item-52").addClass("current-menu-item");

    });
    </script>
    <?  

}

?> 
```

# mysql - MySQL 混乱

> ID：12661379
> 
> 赞同：-4
> 
> 时间：2012-09-30T12:52:05.813
> 
> 标签：mysql

我很困惑为什么会发生这种情况，但是当我导入一个表时，它会返回这个并且表是空的......

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'all' at line 2 
```

在消息下方我有这个，但我不确定如何删除“ALL”或它来自哪里。

```
SELECT *
FROM `Vehicles`
LIMIT 0 ,
ALL 
```

我尝试删除表并再次将其导入，但结果始终相同。

这是我要导入的表：

[http://pastebin.com/9PWaix39](http://pastebin.com/9PWaix39)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:12:00.490

该错误与您要导入的数据无关。`SELECT`您正在使用的语句中指出了错误：

```
SELECT *
FROM `Vehicles`
LIMIT 0 ,
ALL 
```

这是什么查询？它来自哪里？您正在尝试使用此查询，我很确定使用 of`ALL`是无效的。 [检查手册](http://dev.mysql.com/doc/refman/5.0/en/select.html)，我没有看到`ALL`列为该`LIMIT`子句的选项。如果我猜的话，我会认为这个子句试图让行从索引开始`0`并继续，嗯，所有行。如果是这种情况，则`LIMIT`首先不需要该子句。默认情况下，查询将返回所有匹配的行。如果您确实想从给定索引匹配所有行，则手册建议这样做：

> 要检索从某个偏移量到结果集末尾的所有行，您可以为第二个参数使用一些较大的数字。此语句检索从第 96 行到最后一行的所有行：
> 
> 从 tbl 限制 95,18446744073709551615 中选择 *；

也许不同版本的 MySQL 支持`ALL`在`LIMIT`子句中使用？如果您使用的是生成此查询的自动化工具，那么该工具可能需要您未使用的特定版本的 MySQL。

# titanium - 如何在 Titanium 中创建布局

> ID：12661385
> 
> 赞同：0
> 
> 时间：2012-09-30T12:52:53.390
> 
> 标签：titanium, appcelerator, titanium-mobile, appcelerator-mobile

![在此处输入图像描述](../Images/2dab83a98e79351b22ea9b0a3f40011f.png)

如何在钛中创建如上图所示的布局？

当有人滚动时，我希望左右列保持固定在屏幕上（如 CSS 固定位置），而只有中间列滚动。

当有人点击左列或右列的按钮时，中间列的按钮将被新按钮替换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T16:50:53.780

.1 创建包含左右按钮的基本视图。

.2 在该视图之上，创建一个透明的可滚动视图，上面带有学习、进食按钮。

```
// SCROLLER
var scroller = Titanium.UI.createScrollableView({
    pagingControlColor:'transparent',
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T05:58:34.850

首先，将当前窗口的布局设置为“水平”。

然后创建左视图（Ti.UI.View）、中视图（Ti.UI.ScrollView）和右视图（Ti.UI.View）。

将所有这三个视图的布局设置为“垂直”。

现在，当您滚动时，左右视图将保持相同状态，而仅滚动中间视图。

希望它能解决你的问题。

# ruby-on-rails - 面向服务的架构——登录系统

> ID：12661388
> 
> 赞同：0
> 
> 时间：2012-09-30T12:53:11.287
> 
> 标签：ruby-on-rails, web-services, soa

我目前正在设计一个面向服务的架构，实际上我正面临如何设计登录系统。

实际上我出来的是：

1.  webUI（对其他服务执行多项操作的客户端）
2.  loginService（存储用户凭据）
3.  其他服务...

由于 WebUI 是访问服务的一种方式，因此将登录设置为单独的服务对我来说很有意义，因此也可以轻松实现对特定服务的访问设计。

但是我不确定这是否是设计登录系统的好方法，大多数时候都可以通过 Web 界面访问。它也可以集成在 webUI 本身中，公开某种方式来验证尝试直接访问其他服务的用户....您对此有何看法？

我希望这很清楚我想要做什么，如果没有，请问我，我会用你需要更好地理解的信息更新这篇文章。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:47:53.473

几个相关的场景：

1.  实际用户进行身份验证，然后应用程序代表他们调用 Web 服务
2.  系统调用 Web 服务

对于 1，您可以按照您的建议提供 Web 登录。然后，您可以使用 UsernameToken 配置文件进行 Web 服务身份验证。或者，您可以根据您的要求探索基于 SAML 的 SSO 解决方案，并将 SAML 令牌发送到 Web 服务。

第二次查看 STS。

# php - php重定向到XAMPP文件夹

> ID：12661390
> 
> 赞同：1
> 
> 时间：2012-09-30T12:53:22.397
> 
> 标签：php, webserver, xampp

我的问题与这里遇到的问题类似[https://stackoverflow.com/questions/320205/why-does-my-xampp-installation-auto-redirect-to-http-localhost-xampp](https://stackoverflow.com/questions/320205/why-does-my-xampp-installation-auto-redirect-to-http-localhost-xampp)但不幸的是，似乎没有一个解决方案去工作 。我做了以下

a) 持续清除缓存

b) 将我在 htdocs 文件夹中的 index.php 文件重命名为 index_int.php 。

我无法弄清楚重定向失败的原因。我是否还需要对任何配置文件进行一些更改？我在一些关于优先重定向的帖子中读到。“httpd.conf 文件设置为优先考虑 .php 文件”是真的吗？如果是这种情况，我应该在这个文件中编辑什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T16:43:59.953

你好`XAMPP`有2个索引页一个是`index.html`另一个是`index.php`

如果您重命名`index.php`它将不起作用，因为备份会接管......`index.php`内容看起来像这样

```
if (!empty($_SERVER['HTTPS']) && ('on' == $_SERVER['HTTPS'])) {
    $uri = 'https://';
} else {
    $uri = 'http://';
}
$uri .= $_SERVER['HTTP_HOST'];
header('Location: '.$uri.'/xampp/');
exit; 
```

只需将其更改`/xampp/`为您想要的..如果还有问题请告诉我

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T03:58:21.157

我想我应该回答我的问题。我怀疑问题出在我尚未配置我的测试环境以允许 facebook 在本地测试应用程序的事实。这是失败的代码-

$facebook_login_url = $facebook->getLoginUrl(array('scope' => $facebook_app_permissions, 'redirect_uri' => $redirect_uri));

它可以在实时服务器上完美运行，但不能在我的本地环境中运行。我发现我需要在本地设置开发和测试 facebook 应用程序。这里有一些关于它[开发和测试 Facebook 应用程序的](https://stackoverflow.com/questions/39365/developing-and-testing-a-facebook-application)帖子。

我希望这可以在调试 xampp 看似神秘的重定向时节省一些时间。

# iphone - 有没有一种简单的方法来设置核心音频回调来访问播放背景音频的样本？

> ID：12661391
> 
> 赞同：1
> 
> 时间：2012-09-30T12:53:35.447
> 
> 标签：iphone, ios, ipad, audio, core-audio

如何从我的应用程序中访问播放背景音乐的各个音频样本？是否有 Core Audio 提供/调用的基于块的方法或回调函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:26:31.073

啊哈。我以前做过很多次。使用斯坦福的 API。它叫莫穆。它有一个用于访问左右通道样本的 C 级 API。

# regex - 正则表达式在 FrontPage 中查找不是链接的单词

> ID：12661396
> 
> 赞同：0
> 
> 时间：2012-09-30T12:54:46.790
> 
> 标签：regex, frontpage

FrontPage 2003 有一个使用正则表达式查找的选项，我需要查找不是链接的单词。

例如，要查找前后没有“a”标签的单词“Download”或“any text download something”

我的意思是没有标签的东西

```
<a href>  </a> 
```

之前和之后

# linq-to-sql - 如何映射 LINQ To SQL 以启用预加载、返回 EntitySet 或 ICollection？

> ID：12661398
> 
> 赞同：3
> 
> 时间：2012-09-30T12:54:51.137
> 
> 标签：linq-to-sql, eager-loading

这与我的问题相关（但相当独立）：[Why SELECT N + 1 with no foreign keys and LINQ?](https://stackoverflow.com/questions/12605374/why-select-n-1-with-no-foreign-keys-and-linq)

我试过使用`DataLoadOptions`强制加载，但我没有让它工作。

我正在手动编写我的 LinqToSQL 映射，并且首先遵循本教程： http: [//www.codeproject.com/Articles/43025/A-LINQ-Tutorial-Mapping-Tables-to-Objects](http://www.codeproject.com/Articles/43025/A-LINQ-Tutorial-Mapping-Tables-to-Objects)

现在我找到了这个教程：http: [//msdn.microsoft.com/en-us/library/bb386950.aspx](http://msdn.microsoft.com/en-us/library/bb386950.aspx)

至少有一个我可以发现的主要区别。第一个教程建议返回`ICollection`'s 和第二个`EntitySet`'s。由于我遇到问题，我试图将我的代码切换为 return `EntitySet`，但后来我遇到了需要在我的视图和控制器中引用 System.Data.Linq 的问题。我试图这样做，但没有让它发挥作用。我也不确定这是个好主意。

在这一点上，我只想知道我应该使用哪种返回类型来进行好的设计？我可以有一个好的设计并且仍然能够在特定情况下强制加载吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T06:05:33.050

大量的试验和错误最终导致了解决方案。可以返回`ICollection`or `IList`，或者在某些情况下`IEnumerable`。有些人认为返回`EntitySet`或者`IQueryable`是一个坏主意，我同意，因为它暴露了大部分数据源/技术。有些东西返回`IEnumerable`是一个坏主意，它似乎取决于它。问题在于它可以用于延迟加载，这可能是也可能不是一件好事。

一个反复出现的问题是返回分页结果并计算页面外的总项目数。这可以通过创建一个`CollectionPage<T>`（[http://www.codetunnel.com/blog/post/104/how-to-properly-return-a-paged-result-set-from-your-repository](http://www.codetunnel.com/blog/post/104/how-to-properly-return-a-paged-result-set-from-your-repository)）来解决

更多关于从这里的存储库返回的内容：

[http://www.codetunnel.com/blog/post/103/should-you-return-iqueryablet-from-your-repositories](http://www.codetunnel.com/blog/post/103/should-you-return-iqueryablet-from-your-repositories)

[http://www.shawnmclean.com/blog/2011/06/iqueryable-vs-ienumerable-in-the-repository-pattern/](http://www.shawnmclean.com/blog/2011/06/iqueryable-vs-ienumerable-in-the-repository-pattern/)

[IEnumerable 与 IQueryable 用于业务逻辑或 DAL 返回类型](https://stackoverflow.com/questions/6677722/ienumerable-vs-iqueryable-for-business-logic-or-dal-return-types)

[List、IList、IEnumerable、IQueryable、ICollection，哪种返回类型最灵活？](https://stackoverflow.com/questions/3559868/list-ilist-ienumerable-iqueryable-icollection-which-is-most-flexible-return)

更重要的是，`DataLoadOptions` **可以**进行急切加载！我现在已经对我的代码进行了如此多的重组，我不能 100% 确定我做错了什么导致`DataLoadOptions`无法工作。据我所知，如果我尝试将它添加到使用`DataContext`后，我应该得到一个例外`DataContext`，但它没有。我发现的是在工作单元模式中思考。但是，出于我的需要（并且因为我不想返回`EntitySet`或`IQueryable`来自我的存储库）我不会实现跨存储库工作单元。相反，我只是将我的存储库方法视为他们自己的小型工作单元。我确信这有一些不好的地方（例如，在某些更新场景中它可能会导致更多的数据库往返），将来我可能会重新考虑。然而，这是一个简单干净的解决方案。

更多信息在这里：

[https://stackoverflow.com/a/7941017/1312533](https://stackoverflow.com/a/7941017/1312533)

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net- mvc-应用程序](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

这就是我在存储库中的最终结果：

```
public class SqlLocalizedCategoriesRepository : ILocalizedCategoriesRepository
{
    private string connectionString;
    private HttpContextBase httpContext;
    public SqlLocalizedCategoriesRepository(string connectionString, HttpContextBase httpContext) // Injected with Inversion of Control
    {
        this.connectionString = connectionString;
        this.httpContext = httpContext;
    }

    public CollectionPage<Product> GetProductsByLocalizedCategory(string category, int countryId, int page, int pageSize)
    {
        // Setup a DataContext
        using (var context = new DataContext(connectionString)) // Because DataContext implements IDisposable it should be disposed of
        {
            var dlo = new System.Data.Linq.DataLoadOptions();
            dlo.LoadWith<Product>(p => p.ProductSubs); // In this case I want all ProductSubs for the Products, so I eager load them with LoadWith. There's also AssociateWith which can filter what is eager loaded.
            context.LoadOptions = dlo;
            context.Log = (StringWriter)httpContext.Items["linqToSqlLog"]; // For logging queries, a must so you can see what LINQ to SQL generates

            // Query the DataContext
            var cat = (from lc in context.GetTable<LocalizedCategory>()
                       where lc.CountryID == countryId && lc.Name == category
                       select lc.Category).First(); // Gets the category into memory. Might be some way to not get it into memory by combining with the next query, but in my case my next step is that I'm also going to need the Category anyway so it's not worth doing because I'm going to restructure this code to take a categoryId parameter instead of the category parameter.

            var products = (from p in context.GetTable<Product>()
                            where p.ProductCategories.Any(pm => pm.Category.CategoryID == cat.CategoryID)
                            select p); // Generates a single query to get the the relevant products, which with DataLoadOptions loads related ProductSubs. It's important that this is just a query and not loaded into memory since we're going to split it into pages.

            // Return the results
            var pageOfItems = new CollectionPage<Product>
            {
                Items = products.Skip(pageSize * (page - 1)).Take(pageSize).ToList(), // Gets the page of products into memory
                TotalItems = products.Count(), // Get to total count of items belonging to the Category
                CurrentPage = page
            };
            return pageOfItems;
        }
    }
} 
```

# php - PHP CMS URL 模式匹配

> ID：12661399
> 
> 赞同：0
> 
> 时间：2012-09-30T12:55:36.130
> 
> 标签：php, regex, preg-match

正如标题中提到的，我正在构建一个 CMS，并且我正在尝试将 Patterned URLs 工作到系统中。作为其中的一部分，可以将模块分配给基本句柄，然后将参数传递给它。

使用正则表达式我想匹配 URL 并能够从中提取通配符信息。一般格式如下。

```
http://i3network.net/module/
http://i3network.net/module/action/
http://i3network.net/module/action/id/
http://i3network.net/module/action/id/subaction/ 
```

我目前正在通过从数据库中加载每个模块（启用了此功能）的 4 个正则表达式并单独检查来运行它。

我遇到的问题是表达式匹配第一个，然后不继续执行顺序。

这是我目前用于第一级的表达方式。

```
/^module\// 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-27T03:20:28.757

我正在使用`/^photography$/`,`/^photography\/([a-zA-Z0-9_-])*$/`和`/^photography\/([a-zA-Z0-9_-])*\/([a-zA-Z0-9_-])*/`来确认要使用哪个模块（与另一个（`[a-zA-Z0-9_-])*\/`对于每个级别更深，然后`/^photography\/(.*?)/`为每个子操作更深入`/^proofs\/(.*?)\/(.*?)/`地获取'action'和'id `(additionally with another`/（。*？）/`。它都已处理在 PHP 中 - 我从数据库中获取所有表达式，然后遍历它们。

# mysql - 消息系统查询不起作用

> ID：12661402
> 
> 赞同：2
> 
> 时间：2012-09-30T12:55:52.650
> 
> 标签：mysql, sql

我正在尝试构建一个内部消息传递系统，用户可以在其中向一个或多个用户发送/回复消息。我想要显示收件箱，如 gmail 系统。原始消息将列在表中。如果有与该消息对应的回复，则回复计数显示在侧面。如果消息或回复中的任何一个未读，我希望行以粗体显示。我有以下表结构。

**msg_inbox 表**

```
message_id
message_subject
message_body
sender_id
recipient_id
read_status
message_date
marked_important 
```

**msg_reply 表**

```
reply_id
message_id
reply_subject
reply_body
reply_sender_id
reply_recipient_id
reply_read_status
reply_date 
```

到目前为止，我有以下查询，但似乎不起作用

```
SELECT 
  m.*,
  COUNT(r.reply_id) replycount,
  (SELECT 
    reply_read_status 
  FROM
    sc_messages_reply 
  WHERE message_id = r.message_id 
    AND reply_recipient_id = r.reply_recipient_id 
    AND reply_read_status='0'
  ) AS reply_read_status,
  r.reply_sender_id,
  r.reply_date 
FROM
  sc_messages m 
  LEFT OUTER JOIN sc_messages_reply r 
    ON m.message_id = r.message_id 
WHERE m.sender_id = '34' 
  OR m.recipient_id = '34' 
  OR r.reply_sender_id = '34' 
  OR r.reply_recipient_id = '34' 
GROUP BY m.message_id 
ORDER BY m.marked_important DESC,
  m.message_date DESC,
  r.reply_date DESC 
```

我在上面的查询中一定有什么地方出错了，如果有人指出它会很棒。

这是样本数据

**msg_inbox**

```
insert into `msg_inbox`
(`message_id`, `message_subject`, `message_body`, `sender_id`,
 `recipient_id`, `read_status`, `message_date`, `marked_important`) 
 values (1, 'This is test message',
         'This is test message body apart from subject', 
         12, 34, 1, '2012-09-29 07:49:37', 1), 
        (2, 'This is yet another message',
         'This is yet another subject', 13, 34, 1, '2012-09-29 07:51:00', 0); 
```

**msg_reply**

```
insert into `msg_reply`
(`reply_id`, `message_id`, `reply_subject`, `reply_body`, `reply_sender_id`,
 `reply_recipient_id`, `reply_read_status`, `reply_date`)
 values (1, 2, 'Test reply', 'test body\r\n', 
         34, 13, 1, '2012-09-29 07:51:46'),          
        (2, 2, 'Reply of the reply\r\n', 'Message reply of the reply',
         13, 34, 1, '2012-09-29 07:52:32'),
        (4, 1, 'Re.This is test message', 
         'Naturally I took it upon myself to solve this problem for all of you :) I created this plugin to be as general purpose as possible. As a result it ended up being vastly more customizable than any other jQuery auto-complete plugin. Not only that, I am using actual jQuery. For some reason all the other &amp;#34;jQuery&amp;#34; plugins don&amp;#39;t really take advantage of the radness that is jQuery. Consequently, my plugin ended up being',34,12,1,'2012-09-30 14:37:40'),(5,1,'Re.This is test message','Well its all good sir',12,34,0,'2012-09-30 15:07:38'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:37:57.093

我想我已经解决了我将子查询更改为的问题

```
SELECT 
    reply_read_status 
  FROM
    sc_messages_reply 
  WHERE message_id = r.message_id 
    AND  reply_read_status='0' AND reply_recipient_id='34' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:59:34.090

我想你必须`JOIN`上桌

```
SELECT 
  m.*,
  COUNT(r.reply_id) replycount, unreaded.reply_read_status,
  r.reply_sender_id,
  r.reply_date 
FROM sc_messages m 
INNER JOIN
(
     SELECT *
     FROM sc_messages_reply  
     WHERE reply_read_status = '0'
) unreaded ON m.message_id = unreaded.message_id
INNER JOIN  -- You can also join the readed messages like this:
(
     SELECT *
     FROM sc_messages_reply  
     WHERE reply_read_status = '1'
) readed ----
LEFT OUTER JOIN sc_messages_reply r ON m.message_id = r.message_id 
  AND unreaded.reply_recipient_id = r.reply_recipient_id
WHERE m.sender_id = '34' 
  OR m.recipient_id = '34' 
  OR r.reply_sender_id = '34' 
  OR r.reply_recipient_id = '34' 
GROUP BY m.message_id 
ORDER BY m.marked_important DESC,
  m.message_date DESC,
  r.reply_date DESC 
```

# java - 单表继承（使用 Ebean + Play! 框架）

> ID：12661404
> 
> 赞同：5
> 
> 时间：2012-09-30T12:56:02.917
> 
> 标签：java, database-design, jpa, playframework-2.0, ebean

我使用的概念`single table inheritance`当然是出于 OOP 的考虑。
例如，从`PostLike`类`TopicLike`继承`Like`。
我发现这种方法有两个问题：

1.  而不是两张表（PostLike 和 TopicLike），我得到了“一张大桌子”的赞。
2.  *该表有一个称为dtype*的额外列，它启用记录标识（即类似的类型）。从长远来看，这可能会**浪费**大量磁盘空间。不是吗？

我不是数据库专家，因此我想了解您对这个数据库设计的见解，以及这两个问题是否至关重要。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T13:08:16.110

如果您只有一张表而不是两张，则读取速度会更快，因为您将避免“连接”。但是您将使用更多空间，因为您将有一个额外的“dtype”列和一些空列。

让我们举个例子。这是模型（没有 JPA 注释）：

```
public abstract class Like {
    public Long id;

    public String foo;
}

public class PostLike extends Like {

    public String post;
}

public class TopicLike extends Like {

    public String topic;
} 
```

你会得到这张桌子`Like`：

```
----------------------------------
|dtype | id | foo | topic | post |
----------------------------------
|post  |  1 |   a |  NULL |   p1 |
|topic |  2 |   b |    t1 | NULL |
---------------------------------- 
```

如您所见，对于“PostLike”项目，您将有一个 NULL“主题”值。

但是现在，磁盘空间如果不是一个真正的问题。

我在单表继承中看到的唯一缺陷是如果您有很多属性，列的数量可能会很大，并且在您的模型中添加新的属性/列更加困难（如果您必须应用数据库演变） .

而AFAIK，[ebean只支持](http://www.avaje.org/limitation.html#inheritance)“单表继承”。

# c++ - 单例抽象工厂模式

> ID：12661405
> 
> 赞同：4
> 
> 时间：2012-09-30T12:56:11.143
> 
> 标签：c++, design-patterns, singleton, abstract-factory

我想实现一个抽象工厂模式，但也想成为一个单身人士。

```
class WindowFactory {
protected:
    virtual Scrollbar* createScrollbar() = 0;
};

class MacWindowFactory: public WindowFactory {
    virtual Scrollbar* createScrollbar() {
        //return a instance
    }
    ;
};

class LinuxWindowFactory: public WindowFactory {
    virtual ScrollBar* createScrollbar() {
        //return a instance
    }
    ;
}; 
```

有人可以帮助我制作这个 Abstract Factory Singleton 的示例代码吗？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-30T18:08:05.160

我设法想出了更优雅的解决方案（目前没有错误检查）。请让我知道你的想法

```
#include<iostream>
#include<map>

class AbstractFactory
{
private:
    typedef std::map< std::string, AbstractFactory* > ClientMap;
    static ClientMap s_clientMap;
public:
    void virtual createScrollbar() = 0;
    void virtual createWindow() = 0;
    static AbstractFactory* createInstance( std::string client );
protected:
    void Register( std::string, AbstractFactory* );
};

AbstractFactory::ClientMap AbstractFactory::s_clientMap;

class LinuxFactory: public AbstractFactory
{
public:
    void createScrollbar()
    {
        std::cout<<"Scrollbar for Linux"<<std::endl;
    }

    void createWindow()
    {
        std::cout<<"WIndow for Linux"<<std::endl;
    }
private:
    LinuxFactory()
    {
        Register( "Linux", this );
    }
    LinuxFactory( const LinuxFactory& );
    static LinuxFactory s_LinuxFactory;

};
LinuxFactory LinuxFactory::s_LinuxFactory;

class MacFactory: public AbstractFactory
{
public:
    void createScrollbar()
    {
        std::cout<<"Scrollbar for Mac"<<std::endl;
    }

    void createWindow()
    {
        std::cout<<"WIndow for Mac"<<std::endl;
    }

private:
    MacFactory()
    {
        Register( "Mac", this );
    }
    MacFactory( const MacFactory& );
    static MacFactory s_MacFactory;
};
MacFactory MacFactory::s_MacFactory;

void AbstractFactory::Register( std::string clientName, AbstractFactory* factory )
{
    s_clientMap.insert( ClientMap::value_type( clientName, factory ) );

}
AbstractFactory* AbstractFactory::createInstance( std::string client )
{
return s_clientMap.find( client )->second;

}

int main()
{
AbstractFactory *factory = AbstractFactory::createInstance( "Linux" );
factory->createScrollbar();
factory->createWindow();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:14:42.177

如果你需要一个真正动态的抽象工厂，你需要在运行时以某种方式设置它。你可以通过一个函数来选择所需的工厂，并使用一个合适的函数来设置实际的单例。在实际的应用程序中，您可能会有某种注册函数，您可以在其中注册获取工厂实例的函数（工厂工厂函数）。在下面的示例中，我使用了一个简单的设置，其中可用的工厂在编译时是已知的。

```
#include <memory>
#include <stdexcept>
#include <string>

class Scrollbar;

class WindowFactory {
public:
    static void setFactory(std::string const&);
    static Scrollbar* createScrollbar();
    virtual ~WindowFactory() {}

private:
    virtual Scrollbar* doCreateScrollbar() = 0;
};

class MacWindowFactory
    : public WindowFactory {
    friend void WindowFactory::setFactory(std::string const&);
    virtual Scrollbar* doCreateScrollbar() {
        return 0;
    }
};

class LinuxWindowFactory
    : public WindowFactory {
    friend void WindowFactory::setFactory(std::string const&);
    virtual Scrollbar* doCreateScrollbar() {
        return 0;
    }
};

// in WindowFactory.cpp

static std::auto_ptr<WindowFactory>& getPointer()
{
    static std::auto_ptr<WindowFactory> pointer;
    return pointer;
}

Scrollbar* WindowFactory::createScrollbar()
{
    return getPointer().get()
        ? getPointer()->doCreateScrollbar()
        : throw std::runtime_error("WindowFactory not set");
}

void WindowFactory::setFactory(std::string const& what)
{
    if (what == "Mac") {
        getPointer() = std::auto_ptr<WindowFactory>(new MacWindowFactory());
    }
    else if (what == "Linux") {
        getPointer() = std::auto_ptr<WindowFactory>(new LinuxWindowFactory());
    }
    else {
        throw std::runtime_error("unknown factory: '" + what + "'");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:06:05.227

```
namespace WindowFactory {
      Scrollbar* createScrollbar() {
        #ifdef TARGET_OS_MAC 
         ...
        #elif __linux__ 
         ...
        #endif
      }
}; 
```

我会这样做的。

# c# - 当前记录没有元素时，MVC dbContext查找父记录

> ID：12661411
> 
> 赞同：0
> 
> 时间：2012-09-30T12:56:25.583
> 
> 标签：c#, asp.net-mvc, entity-framework-4.1, dbcontext

我是 MVC/C# 初学者，所以请轻松一点。

我有一个现有的数据库，其中客户有零个或多个项目。我已经从 ADODB 实体数据模型和 dbContext 代码生成器构建了一个 ASP.Net 项目。

我有一个客户：Joe Bloggs (ID=7)。我在我的表单中单击 Joe Bloggs 的“项目”链接以查看他的项目。他没有。我想为他创建一个项目，所以我在项目控制器上调用 Create 操作。

出于三个原因，我需要将 Joe Bloggs ID 传递给 Create 操作（这可能没有必要 - 如果需要，请赐教）

1.  因为这是 Joe Bloggs 的项目，所以我需要将 ID=7 传递给控制器​​，以便在为创建视图生成模型数据时为他设置默认客户 ID

2.  当我点击 Create 视图上的 Cancel 按钮时，我想回到基于 Joe Blogs 的最初过滤的项目视图

3.  当我点击保存时，我想回到最初基于 Joe Bloggs 过滤的项目视图。

无论如何，如果我*确实*有一个或多个 Joe Bloggs 项目，那么我可以使用下面的这个怪物从视图中的模型数据中访问他的 id：

```
<input type="button" title = "New Project" value="New Project" onclick="location.href='@Url.Action("Create", new { id = Model.First().Customer_ID })'" /> 
```

这是问题所在：如果他没有任何项目， Model.First() 不会返回任何内容，因此我找不到“父” Customer_ID 记录。

我使用 dbContext 生成模型类（这是数据优先开发）。有些东西告诉我，我可以扩展这些类或创建一个新类以允许上述情况。

我目前的解决方法是使用 ViewBag 从查看器 > 控制器中传递各种 id 和字符串，就像烫手山芋一样，但这意味着如果获得三个深度（客户 > 项目 > 任务），并且我想在任务上显示客户名称，我已经通过了两次。它闻起来臭臭的。

我注意到项目索引视图中的下拉列表中**有客户**。这是我的代码：

```
@Html.DropDownList("Customer_ID", null, "Select a Customer to Filter", new { @onchange = "this.form.submit();" }) 
```

我也许可以从那里破解它，但我真的希望能够从一个可能有两到三个深度并且与此下拉菜单相距甚远的类向上遍历

这是从 dbContext 生成的删节的 Customer 和 CustomerProject 类

```
public partial class Customer
{
    public Customer()
    {
        this.Tasks = new HashSet<Task>();
        this.CustomerProjects = new HashSet<CustomerProject>();
    }

    public int Customer_ID { get; set; }
    public string Customer_Name { get; set; }

    public virtual ICollection<CustomerProject> CustomerProjects { get; set; }
}

public partial class CustomerProject
{
    public CustomerProject()
    {
        this.Tasks = new HashSet<Task>();
        this.CustomerProjectTasks = new HashSet<CustomerProjectTask>();
    }

    public int CustomerProject_ID { get; set; }
    public int Customer_ID { get; set; }
    public string Project_Name { get; set; }

    public virtual ICollection<Task> Tasks { get; set; }
    public virtual Customer Customer { get; set; }
    public virtual ICollection<CustomerProjectTask> CustomerProjectTasks { get; set; }
} 
```

我确信有一个明显的解决方案，但我的优势在于数据库和 VB6，而不是 C#

在 Mystere Man 的建议下，我构建了一个 ViewModel 类，但我遇到了一些麻烦：

这是我的模型类文件中的内容（据我了解，这只是现有项目实体的包装）：

```
namespace zzz.Models
{
    using System;
    using System.Collections.Generic;

    public class ProjectsViewModel
    {
        public int Customer_ID { get; set; }
        public ICollection<CustomerProject> CustomerProjects;
    }
} 
```

这是我的控制器的 Index 操作中的内容（我刚刚将现有的 Project 集合添加到新的 ViewModel 类中）：

```
 public ViewResult Index(int pCustomer_ID = 0, string pProjectName_Filter = "")
    {

        // Set up drop down
        ViewBag.Customer_ID = new SelectList(db.Customers.OrderBy(x => x.Customer_Name), "Customer_ID", "Customer_Name");
        //ViewBag.Selected_Customer_ID = Customer_ID;

        // If no parameters entered, show nothing
        // Otherwise optionally filter each parameter
        var projects = from p in db.CustomerProjects
            orderby p.Active, p.Project_Order
            where
            (p.Project_Name.Contains(pProjectName_Filter) || pProjectName_Filter.Equals("")) &&
            (p.Customer_ID == pCustomer_ID || pCustomer_ID.Equals(0)) &&
            !(pCustomer_ID.Equals(0) && pProjectName_Filter.Equals(""))
            select p;

        var customerprojects = new ProjectsViewModel
        {
            Customer_ID = pCustomer_ID,
            CustomerProjects = projects.ToList()
        };

        return View(customerprojects);
    } 
```

这是我的视图的摘录（我试图遍历 ViewModel 类中的 Project 集合）：

```
@model IEnumerable<BistechPortal.Models.ProjectsViewModel>

<table>
@foreach (var item in Model.CustomerProjects)
{
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.Project_Name)
    </td>
</tr>
}
</table> 
```

当我运行 Index 操作时，在 foreach 行上我得到：

```
'System.Collections.Generic.IEnumerable<zzzzPortal.Models.ProjectsViewModel>' does not contain a definition for 'CustomerProjects' " 
```

请翻译 - 为什么它在我的 ViewModel 中找不到我的“CustomerProjects”集合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T18:55:55.057

这就是为什么您不应该将实体对象直接传递给视图的原因。在大多数情况下，视图需要比定义的实体提供的信息更多的信息（或不同的信息）。

这就是视图模型存在的原因。您将创建一个包含 Customer_ID 和项目（以及您需要的任何其他数据）的视图模型。然后，即使用户没有项目，您也可以访问 Customer_ID。

```
public class ProjectsViewModel {
     public int Customer_ID {get;set;}
     public List<CustomerProject> CustomerProjects;
} 
```

然后你将这个新对象传递给你的视图。

*（由OP添加：）*

要将这个对象传递给您的视图，您需要告诉视图它不再接受 CustomerProjects 类型的数据，**并且**（这花了我三个小时来解决）它不再获得“可枚举”数据。

所以在你看来改变

```
@model IEnumerable<Portal.Models.CustomerProjects> 
```

到

```
@model Portal.Models.ProjectsViewModel 
```

同样在您的视图中，您现在想要迭代 Model.CustomerProject，所以更改

```
@foreach (var item in Model) 
```

到

```
@foreach (var item in Model.CustomerProjects) 
```

# javascript - 在 Web 应用程序上使用 Adob e Flash 图表库是个好主意吗？

> ID：12661412
> 
> 赞同：1
> 
> 时间：2012-09-30T12:56:31.947
> 
> 标签：javascript, html, flash, charts, libraries

我一直在使用 jqplot 在我的 Web 应用程序上显示图表。但现在我的客户想要更多交互式图表，用于向下钻取导航。

我认为在使用 Adob​​e Flash 图表库。但我已经读到 Flash 在 Web 应用程序和网页上的存在普遍减少了。

那么，使用闪存图表是个好主意吗？如果我决定使用它，我之前需要记住什么？您以前使用过哪些开源库？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:20:17.450

Flash图表非常有吸引力，但它们有成本。我还在一个使用 Flash 图表的项目中工作过。但是，当这些图表不再在 iOS 上呈现时，我的客户希望使用基于 HTML5 的图表来替换它们。

因此，如果您的目标受众不包括 iOS 设备用户，您可以使用 Flash 图表。

此外，以下链接显示使用闪存的趋势正在下降 [http://w3techs.com/technologies/details/cp-flash/all/all](http://w3techs.com/technologies/details/cp-flash/all/all)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:05:56.030

正如你所说，它的存在正在减少，但支持也在减少，例如在 iPad 和 iPhone 等移动设备上。所以如果你想成为未来的证明，我应该使用 html5 和 JavaScript 的组合。

# ruby-on-rails - Rails 3 - 如何跳过验证规则？

> ID：12661413
> 
> 赞同：7
> 
> 时间：2012-09-30T12:56:55.573
> 
> 标签：ruby-on-rails, ruby, validation, twitter, model

我在注册表单上有这个验证规则：

```
 validates :email, 
    :presence => {:message => 'cannot be blank.'}, 
    :allow_blank => true, 
    :format => {
      :with => /\A[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]+\z/, 
      :message => 'address is not valid. Please, fix it.'
    }, 
    :uniqueness => true 
```

此规则检查用户是否填写注册表单电子邮件地址（+ 其正确格式）。

现在我正在尝试添加使用 Twitter 登录的机会。Twitter 不提供用户的电子邮件地址。

在这种情况下如何跳过上面的验证规则？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-30T13:42:50.773

您可以在将用户保存在代码中时跳过验证。而不是使用`user.save!`，使用`user.save(:validate => false)`。[从Omniauth 的 Railscasts 剧集](http://railscasts.com/episodes/236-omniauth-part-2?view=asciicast)中学到了这个技巧

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T13:13:07.517

我不确定我的答案是否正确，只是想提供帮助。

我想你可以从[这个问题](https://stackoverflow.com/questions/10728005/simple-omniauth-twitter-failing-to-create-new-user-because-of-validation)中得到帮助。如果我修改了您问题的已接受答案，它将类似于（**免责声明**：我无法测试以下代码，因为 env 在我现在正在工作的计算机中尚未准备好）

```
validates :email, 
  :presence => {:message => 'cannot be blank.', :if => :email_required? },
  :allow_blank => true, 
  :format => {
    :with => /\A[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]+\z/, 
    :message => 'address is not valid. Please, fix it.'
  },
  :uniqueness => true

def email_required?
  #logic here
end 
```

现在，您更新`email_required?`方法以确定它是否来自 twitter！如果来自 twitter，则返回 false，否则返回 true。

我相信，您也需要`:if`对 :uniqueness 验证器使用相同的方法。否则它会。不过，我也不确定:(。对不起

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-12T05:19:32.683

**跳过单个验证** 跳过单个验证需要更多的工作。我们需要在我们的模型上创建一个类似于 skip_activation_price_validation 的属性：

```
class Product < ActiveRecord::Base
  attr_accessor :skip_activation_price_validation
  validates_numericality_of :activation_price, :greater_than => 0.0, unless: :skip_activation_price_validation
end 
```

接下来，只要我们想跳过验证，我们就会将该属性设置为 true。例如：

```
def create
   @product = Product.new(product_params)
   @product.skip_name_validation = true
   if @product.save
    redirect_to products_path, notice: "#{@product.name} has been created."
  else
    render 'new'
  end
end

def update
  @product = Product.find(params[:id])
  @product.attributes = product_params

  @product.skip_price_validation = true

  if @product.save
    redirect_to products_path, notice: "The product \"#{@product.name}\" has been updated. "
  else
    render 'edit'
  end
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T16:19:38.270

您似乎在这里进行了两个单独的验证：

*   如果用户提供了电子邮件地址，请验证其格式和唯一性
*   验证电子邮件地址的存在，除非它是 Twitter 注册

我会这样做作为两个单独的验证：

```
validates :email, 
  :presence => {:message => "..."}, 
  :if => Proc.new {|user| user.email.blank? && !user.is_twitter_signup?}

validates :email, 
  :email => true, # You could use your :format argument here
  :uniqueness => { :case_sensitive => false }
  :unless => Proc.new {|user| user.email.blank?} 
```

附加信息： [仅当不是空白 Rails 3 时才验证电子邮件格式](https://stackoverflow.com/questions/6567793/validate-email-format-only-if-not-blank-rails-3)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-12T06:21:48.400

最好的方法是：

当用户未从 twitter 登录时，它将验证电子邮件，并在从 twitter 登录时跳过电子邮件验证。

```
 validates :email, 
    :presence => {:message => 'cannot be blank.'}, 
    :allow_blank => true, 
    :format => {
      :with => /\A[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]+\z/, 
      :message => 'address is not valid. Please, fix it.'
    }, 
    :uniqueness => true
    unless: Proc.new {|user| user.is_twitter_signup?} 
```

# javascript - 据说所有的 Javascript 对象都有一个原型属性，但是如果 foo 是一个函数，我只看到 foo.prototype 吗？

> ID：12661416
> 
> 赞同：18
> 
> 时间：2012-09-30T12:57:34.350
> 
> 标签：javascript, prototype

人们常说每个 Javascript 对象都有一个`prototype`属性，但我发现`foo.prototype`只有当`foo`它是一个函数时它才有一个值。

在 Chrome 和 Firefox 上，`obj.__proto__`有一个值——这是所说的`prototype`属性吗？但是在 IE 9 上，它不起作用（有什么方法可以吗？），我认为通过`prototype`属性，这意味着`obj.prototype`应该起作用吗？

我明白这`Object.getPrototypeOf(obj)`似乎显示了这个`prototype`属性，但是为什么需要一个特殊的方法来获取它呢？为什么不直接like `person.name`，也就是获取对象的`name`属性`person`呢？

* * *

**更新：**顺便说一句，**有时**`obj.constructor.prototype`似乎是那个原型，但有时不是，如以下代码中没有构造函数的原型继承：（此方法在 Apress 的 Harmes 和 Diaz 的 Pro Javascript Design Patterns 书中 2008，p . 46)

 **```
var Person = {
    name: 'default value',
    getName: function() {
        return this.name;
    }
}

var reader = clone(Person);
console.log(reader.getName());
reader.name = "Ang Lee";
console.log(reader.getName());

function clone(obj) {
    function F() {};
    F.prototype = obj;
    return new F;
}

console.log("the prototype of reader is", Object.getPrototypeOf(reader));

console.log(Object.getPrototypeOf(reader) === reader.constructor.prototype);
console.log(Object.getPrototypeOf(reader) == reader.constructor.prototype);

console.log(Object.getPrototypeOf(reader) === reader.__proto__);
console.log(Object.getPrototypeOf(reader) == reader.__proto__); 
```

结果将显示最后 4 行的 false、false、true、true。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-30T13:12:46.883

每个 JavaScript 对象都有一个内部“原型”属性，通常称为 [[prototype]]，它指向它直接继承的对象。这在 FF 和 Chrome 中由非标准`__proto__`属性公开。`Object.getPrototypeOf`是这个内部属性的吸气剂。

每个 JavaScript 函数 [object] 都有一个 property `prototype`，它用一个 [几乎] 空的 object 进行初始化。当您通过将其作为构造函数调用来创建此函数的新实例时，该新对象的 [[prototype]] 将指向构造函数的`prototype`对象。

如果你得到一个函数的 [[prototype]]（每个函数都是一个对象，所以它有一个），它将导致`Function.prototype`函数继承其方法（如绑定、调用、应用等）的对象。另请参阅[为什么函数原型被重复链接？](https://stackoverflow.com/a/10812392/1048572)在那。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-30T13:03:20.777

它是`constructor`每个具有`prototype`. 所以对于一些`foo`, `bar`or `foobar`:

```
var foo = {};
console.log(foo.constructor.prototype); //=> Object
var bar = 5;
console.log(bar.constructor.prototype); //=> Number
function Foobar(){} 
var foobar = new Foobar; //Foobar used a constructor
console.log(foobar.constructor.prototype); //=> Foobar 
```**

# java - Java：“局部变量可能尚未初始化”不够智能？

> ID：12661417
> 
> 赞同：5
> 
> 时间：2012-09-30T12:57:35.340
> 
> 标签：java, variables, compiler-errors, local, initialization

考虑以下方法：

```
void a ()
{
    int x;
    boolean b = false;
    if (Math.random() < 0.5)
    {
        x = 0;
        b = true;
    }
    if (b)
        x++;
} 
```

在`x++`我收到“局部变量可能尚未初始化”错误。显然 x 永远不会在未初始化的情况下使用。除了初始化 x 之外，还有什么方法可以抑制警告？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T13:01:08.767

不，Java 无法检查程序的所有可能代码路径以确定变量是否已初始化，因此它采用安全路线并警告您。

所以不，你必须初始化你的变量来摆脱这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T13:00:23.140

有一个 ：

```
void a () {
    if (Math.random() < 0.5) {
        int x = 1;
    }
} 
```

编译器不负责设计和测试算法。你是。

但也许你应该提出一个更实际的用例。你的例子并没有真正表明你的目标是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T13:12:31.233

你为什么不简单地使用

```
void a ()
{
    int x;
    boolean b = false;
    if (Math.random() < 0.5)
    {
        x = 0;
        b = true;
        x++;
    }
    if (b) {
        //do something else which does not use x
    }
} 
```

在代码中为什么要在第一个 if 块之外使用 x，所有涉及的逻辑`x`只能在第一个 if 块中实现，我没有看到需要使用另一个 if 块来使用 x 的情况.

编辑：或者您也可以使用：

```
void a ()
{
    int x;
    boolean b = (Math.random() < 0.5);
    if (b) {
         x=1
        //do something 
    }
} 
```

# css - 一个部分 100% 高的视口，然后向下滚动时另一个部分可见

> ID：12661421
> 
> 赞同：1
> 
> 时间：2012-09-30T12:58:32.480
> 
> 标签：css

我试图找出这个网站的样式（http://hairproject.ch/fr/）。我喜欢当你打开它时的想法，标题图像覆盖 100% 的视口，无论浏览器大小是多少。但随后您可以向下滚动到另一个部分。

我正在尝试重新创建那个 CSS，我最终得到了这个：

```
header {            
    display: block;         
    background-image: url(background_03.jpg);           
    background-repeat: no-repeat no-repeat;         
    background-size: cover;         
    height: 100%;           
    width: 100%;            
    position: absolute;         
    left: 0;            
    top: 0;
} 
```

这使得图像覆盖整个视口，但绝对定位会将该标题从正常工作流程中取出并将其他部分放在下面。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:10:16.460

标题的父元素具有固定的高度（目前在我的屏幕上为 402px）和相对定位。这就是导致内容低于标题的原因。

```
<div id="banner" style="height:402px;"> 
```

该网站正在使用 JS 来保持这个高度正确。

脚本来源：[http ://static.hairproject.ch/js/script.js](http://static.hairproject.ch/js/script.js)

感兴趣的代码：

```
// Figure out browser width/height and ajust main picture -------------------------------------------------
var width  = $(window).width();
var height = $(window).height();
if ((width > 320) && (width <= 480)) { height = height + 240; }
else if (width <= 320) { height = height + 80; }
var margintop = Math.round((height/3) - 120);
$("body.home #banner").attr("style","height:" + height + "px;");
$("body.home h2").attr("style","margin-top:" + margintop + "px");

$(window).resize(function() {
  // $('#log').append('<div>Handler for .resize() called.</div>');
  var width  = $(window).width();
  var height = $(window).height();
  if ((width > 320) && (width <= 480)) { height = height + 240; }
  else if (width <= 320) { height = height + 80; }
  var margintop = Math.round((height/3) - 120);
  $("body.home #banner").attr("style","height:" + height + "px;");
  $("body.home h2").attr("style","margin-top:" + margintop + "px");
}); 
```

# objective-c - 获取 NSButtonCell 的高亮状态

> ID：12661423
> 
> 赞同：3
> 
> 时间：2012-09-30T12:58:55.637
> 
> 标签：objective-c, macos, cocoa, nsbuttoncell

我有一个在其中一列`NSTableView`中包含 a的。`NSButtonCell`要在相邻单元格中绘制自定义背景（基于`NSTextFieldCell`），我使用`isHighlighted`方法：

```
- (void)drawWithFrame:(NSRect)cellFrame inView:(NSView *)controlView {
     if ([self isHighlighted]) {
     //here I draw the cell background 
```

但是对于`NSButtonCell` *`isHighlighted`*只显示按钮按下状态。

如何确定何时`NSButtonCell`被选中，即何时在行中突出显示？

# php - 如何使用正则表达式将标签 html 保存到变量

> ID：12661424
> 
> 赞同：0
> 
> 时间：2012-09-30T12:59:10.967
> 
> 标签：php, regex

我有`<?php the_content(); ?>`生成html标签的功能：

```
<p>
 <a href="http://127.0.0.1/www/www1/wordpress/wordpressEng/wp-content/uploads/2012/09/page1-img2.jpg">
  <img class="alignnone size-full wp-image-82" title="page1-img2" src="http://127.0.0.1/www/www1/wordpress/wordpressEng/wp-content/uploads/2012/09/page1-img2.jpg" alt="" width="219" height="124" />
 </a>
</p> 
```

我试图提取`<img.**./>`但我不成功。

类似于：

```
//$String =
<p>
 <a href="http://127.0.0.1/www/www1/wordpress/wordpressEng/wp-content/uploads/2012/09/page1-img2.jpg">
  <img class="alignnone size-full wp-image-82" title="page1-img2" src="http://127.0.0.1/www/www1/wordpress/wordpressEng/wp-content/uploads/2012/09/page1-img2.jpg" alt="" width="219" height="124" />
 </a>
</p> 

$String = "the_content()";

$pattern = '/^<img/.*/$/>/';//Take string wich start with "<img" and all between and End in "/>"
preg_match($pattern, substr($subject,3), $StrImg, PREG_OFFSET_CAPTURE);
echo $StrImg[0];
output
//<img class="alignnone size-full wp-image-82" title="page1-img2" src="http://127.0.0.1/www/www1/wordpress/wordpressEng/wp-content/uploads/2012/09/page1-img2.jpg" alt="" width="219" height="124" /> 
```

如何设置变量`$StrImg`完整的 img 标签？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:16:13.163

因此，您想获取发布中所有图像的 src 属性。有更简单的方法：

```
$images = get_posts(array(
            'post_parent' => $post->ID,
            'post_type' => 'attachment',
            'numberposts' => -1,
            'post_mime_type' => 'image'
        ))

        foreach( $images as $image ) {
            $image_url[] = wp_get_attachment_image_src( $image->ID, full );

        } 
```

# android - android listview复选框无法点击

> ID：12661426
> 
> 赞同：0
> 
> 时间：2012-09-30T12:59:55.130
> 
> 标签：android, listview, checkbox

我在带有复选框的列表视图中有这个方法向量元素：

```
public class sensor_choose extends Activity {
    public ListView mainListView;
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.sensors);

    SensorManager sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    List<Sensor> listSensor = sensorManager.getSensorList(Sensor.TYPE_ALL);

    List<String> arrStr = new Vector<String>();

    // for (Sensor s : listSensor) {
    //
    // arrStr.add(s.getName());
    // }

    arrStr.add("Vector Object 1");
    arrStr.add("Vector Object 2");
    arrStr.add("Vector Object 3");
    arrStr.add("Vector Object 4");
    arrStr.add("Vector Object 5");

    for (int i = 0; i < arrStr.size(); i++) {
        // System.out.println("Vector Element " + i + " :" + arrStr.get(i));
        Log.i("Vector Element ", arrStr.get(i));
    }

    ListView listView = (ListView) findViewById(R.id.sensor_list);
    // a listát berakni aegy arraylist-be
    final ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            R.layout.simple_sensor, android.R.id.text1, arrStr);

    // ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
    // android.R.layout.simple_list_item_multiple_choice, arrStr);
    listView.setAdapter(adapter);

    listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View item,
                int position, long id) {
            Toast.makeText(sensor_choose.this,
                    "megnyomott:    "+ adapter.getItem(position),
                    Toast.LENGTH_SHORT).show();
        }
    });

}
} 
```

和xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Aze elérhető szenzorok:"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <ListView
        android:id="@+id/sensor_list"
        android:layout_marginTop="20pt"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true" 
        android:clickable="true">
    </ListView>

</RelativeLayout> 
```

和服装行xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <CheckBox
        android:id="@+id/checkBox1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true" />

    <TextView
        android:id="@android:id/text1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@+id/checkBox1"
        android:padding="5pt"
        android:paddingBottom="3dip"
        android:paddingRight="5dip"
        android:paddingTop="2dip"
        android:textSize="8pt"
        android:clickable="true" />

</RelativeLayout> 
```

我的问题是我不能点击 textview，就像它设置 clickable:false... 我可以点击复选框，但没有别的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:06:26.330

您应该创建自己的`Adapter`并在`getView()`设置 onClick Listener 的方法中`TextView`

例子：

```
public View getView(int position, View convertView, ViewGroup parent) {
.....
.....
....
...
TextView text = (TextView) convertView.findViewById(android.R.id.text1);
text.setOnClickListener(new View.OnClickListener() {

                @Override
                public void onClick(View arg0) {
                    Log.d("TAG", "hello from textView");

                }
            });
} 
```

# java - 在java中计算大于整数和长整数的阶乘？

> ID：12661427
> 
> 赞同：3
> 
> 时间：2012-09-30T13:00:01.977
> 
> 标签：java, biginteger, factorial

在这里和谷歌搜索了几天，并询问了我的编程朋友。不幸的是，我仍然不明白如何更改我的代码......

我的程序计算给定数字的阶乘。然后它提供一个数字，表示阶乘答案包括多少位数。然后它将这些数字的值相加得出总数。

我的程序适用于 1 之间的任何数字！和 31 ！...如果你放任何超过 31 的东西！（例如 50！或 100！）它不起作用，只是返回负数而不是总数。

我希望你们能指出我正确的方向或给我一些建议。我了解使用 BigIntegers 可能是一个解决方案，但我个人并不了解它们，因此来到这里。

任何帮助将非常感激。谢谢。

```
 package java20;

    /**
    * Program to calculate the factorial of a given number.
    * Once implemented, it will calculate how many digits the answer includes.
    * It will then sum these digits together to provide a total.
     * @author shardy
     * date: 30/09/2012
     */

    //import java.math.BigInteger;
    public class Java20 {

    /**
    * @param args the command line arguments
    */
    public static void main(String[] args) {

    //Using given number stored in factorialNo, calculates factorial
    //currently only works for numbers between 1! and 31! :(
        int fact= 1;
        int factorialNo = 10;

        for (int i = 1; i <= factorialNo; i++)
            {
               fact=fact*i;
            }

        System.out.println("The factorial of " + factorialNo + 
                " (or " + factorialNo + "!) is: " + fact);

        //Using answer stored in fact, calculates how many digits the answer has
        final int answerNo = fact;
        final int digits = 1 + (int)Math.floor(Math.log10(answerNo));

        System.out.println("The number of digits in the factorials "
                + "answer is: " + digits);        

        //Using remainders, calculates each digits value and sums them together
        int number = fact;
        int reminder;
        int sum = 0;

        while(number>=1)
            {
             reminder=number%10; 
             sum=sum+reminder;
             number=number/10;
            }

        System.out.println("The total sum of all the " + digits 
                + " idividual digits from the answer of the factorial of " 
                + factorialNo + " is: " + sum);

      }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:02:59.533

你可以在 java 中使用 BigInteger，它有你想要的尽可能多的数字

```
 BigInteger fact= BigInteger.ONE;
    int factorialNo = 10;

    for (int i = 2; i <= factorialNo; i++){
      fact = fact.multiply(new BigInteger(String.valueOf(i)));
    }

    System.out.println("The factorial of " + factorialNo +
                                " (or " + factorialNo + "!) is: " + fact);
   final int digits = fact.toString().length();

   BigInteger number = new BigInteger(fact.toString());
   BigInteger reminder;
   BigInteger sum = BigInteger.ZERO;
   BigInteger ten = new BigInteger(String.valueOf(10));

   while(number.compareTo(BigInteger.ONE)>=0)
     {
     reminder=number.mod(ten);
     sum=sum.add(reminder);
     number=number.divide(ten);
     }

     System.out.println("The total sum of all the " + digits
                     + " idividual digits from the answer of the factorial of "
                     + factorialNo + " is: " + sum 
```

**编辑**：代码经过改进以与作者的代码兼容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:08:53.357

> 如果你把任何超过 31 的东西放进去！（例如 50！或 100！）它不起作用，只是返回负数而不是总数。

这是因为当您超过它们的最大可能值时，原始整数类型会[溢出。](http://en.wikipedia.org/wiki/Integer_overflow)哪些计算阶乘倾向于做。

> 我希望你们能指出我正确的方向或给我一些建议。我了解使用 BigIntegers 可能是一个解决方案，但我个人并不了解它们，因此来到这里。

您是正确的，使用`BigInteger`是一种可能的解决方案。例如，您可以执行以下操作：

```
public BigInteger factorial(int num) {
    if (num < 0) {
        throw new IllegalArgumentException("Not today!");
    }

    BigInteger result = BigInteger.ONE;

    for (int next = 2; next <= num; next++) {
        result = result.multiply(new BigInteger(Integer.toString(next, 10)));
    }

    return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:03:43.657

如果您要计算 (m!/n!) 之类的东西，最好使用阶乘的对数。

您还应该考虑以下两项改进：

1.  记住，不要重新计算。计算后存储这些来之不易的值。
2.  您应该使用[gamma 函数](http://mathworld.wolfram.com/GammaFunction.html)来计算阶乘。您使用循环执行此操作的方式是呈现给学生的天真事物。`ln(gamma(x))`在[Numerical Recipes](https://rads.stackoverflow.com/amzn/click/com/0521880688)中有一个很好的实现。

如果必须，您始终可以使用 BigDecimal，但这是最后的手段。你仍然应该考虑这些点。

[Apache Commons](http://commons.apache.org/math/api-1.2/org/apache/commons/math/special/Gamma.html)提供了一个 gamma 函数实现。源代码可能不像幼稚的方法那样熟悉，但如果你看到它是如何完成的，很明显即使对于温和的论点它也更有效。

# c# - 在 C# win forms 中，表单应该全屏显示

> ID：12661430
> 
> 赞同：-3
> 
> 时间：2012-09-30T13:00:23.697
> 
> 标签：c#, winforms

在 C# windows 应用程序中，我需要设置表单大小最大值，以便在我运行程序时它应该显示完整。

我应该在属性中设置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:01:33.707

本主题可以帮助您做到这一点：http: [//www.codeproject.com/Articles/16618/How-To-Make-a-Windows-Form-App-Truly-Full-Screen-a](http://www.codeproject.com/Articles/16618/How-To-Make-a-Windows-Form-App-Truly-Full-Screen-a)

```
myFormsApp.WindowState = FormWindowState.Maximized; 
```

# xamarin.ios - 获取后台请求时，Monotouch UITableView 图像“闪烁”

> ID：12661436
> 
> 赞同：0
> 
> 时间：2012-09-30T13:01:11.453
> 
> 标签：xamarin.ios

我需要你们的帮助。我有一个包含一些网络图像的 Monotouch UITableView。我已经实现了一个异步获取它们的任务，因此 UI 是响应式的，甚至添加了一些动画以在它们从 Web 获取时淡入它们。

当用户向下快速向下滚动 UITableView 时，我的问题就开始了，因此由于单元格是可重复使用的，因此有几个后台任务排队等待图像。当他位于列表底部时，他可能会看到缩略图显示另一个单元格的图像，然后是另一个单元格，然后是另一个单元格，然后是另一个单元格，因为任务完成并且每个图像都替换另一个。我需要某种检查当前显示的单元格是否对应于正确的图像 url，但不知道该怎么做。

这是我的 TableSource 类的代码。

```
using System;
using MonoTouch.UIKit;
using MonoTouch.Foundation;
using System.Collections.Generic; 
using System.Threading;
using System.Threading.Tasks;
using System.Diagnostics;

{
    public class ListDelegate:UITableViewDelegate
    {
        private UINavigationController nav;
        public override float GetHeightForRow (UITableView tableView, NSIndexPath indexPath)
        {
            return 128;
        }
        public override void RowSelected (UITableView tableView, NSIndexPath indexPath)
        {
            DealViewController c = new DealViewController(((ListDataSource)tableView.DataSource).deals[indexPath.Row].Id,nav);
            nav.PushViewController(c,true);
            tableView.DeselectRow(indexPath,true);
        }
        public ListDelegate(UINavigationController nav)
        {
            this.nav = nav;
        }
    }
    public class ListDataSource:UITableViewDataSource
    {
        bool toggle=true;
        Dictionary<string,UIImage> images = new Dictionary<string, UIImage>();
        public List<MyDeal> deals = new List<MyDeal>();
        Dictionary<int,ListCellViewController> controllers = new Dictionary<int, ListCellViewController>();
        public ListDataSource(List<MyDeal> deals)
        {
            this.deals = deals;
        }
        public override int RowsInSection (UITableView tableview, int section)
        {
            return deals.Count;
        }
        public override UITableViewCell GetCell (UITableView tableView, MonoTouch.Foundation.NSIndexPath indexPath)
        {
            UITableViewCell cell = tableView.DequeueReusableCell("cell");
            ListCellViewController cellController = null;
             if (cell == null || !controllers.ContainsKey(cell.Tag))
             {
                cellController = new ListCellViewController();
                NSBundle.MainBundle.LoadNib("ListCellViewController", cellController, null);
                cell = cellController.Cell;
                cell.Tag = Environment.TickCount;
                controllers.Add(cell.Tag, cellController);
             }
             else
             {
                cellController = controllers[cell.Tag];
             }
            if (toggle)
            {
                cell.BackgroundView = new UIImageView(UIImage.FromFile("images/bg1.jpg"));
            }
            else
            {
                cell.BackgroundView = new UIImageView(UIImage.FromFile("images/bg2.jpg"));
            }
            toggle = !toggle;
            MyDeal d = deals[indexPath.Row];
            cellController.SetValues(d.Title,d.Price,d.Value,d.DiscountPercent);
            GetImage(cellController.Thumbnail,d.Thumbnail);
            return cell;
        }
        private void GetImage(UIImageView img, string url)
        {
            img.Alpha = 0;
            if (url != string.Empty)
            {
                if (images.ContainsKey(url))
                {
                    img.Image = images[url];
                    img.Alpha = 1;
                }
                else
                {
                    var context = TaskScheduler.FromCurrentSynchronizationContext ();
                    Task.Factory.StartNew (() => {
                        NSData imageData = NSData.FromUrl(new NSUrl(url));
                        var uimg = UIImage.LoadFromData(imageData);
                        images.Add(url,uimg);
                        return uimg;
                    }).ContinueWith (t => { 
                        InvokeOnMainThread(()=>{
                            img.Image = t.Result;
                            RefreshImage(img);
                        });             
                    }, context);
                }
            }
        }
        private void RefreshImage(UIImageView img)
        {
            UIView.BeginAnimations("imageThumbnailTransitionIn");
            UIView.SetAnimationDuration(0.5f);
            img.Alpha = 1.0f;
            UIView.CommitAnimations();
        }
    }
} 
```

这是包含自定义单元格的 ListCellViewController

```
using System;
using System.Collections.Generic;
using System.Linq;
using MonoTouch.Foundation;
using MonoTouch.UIKit;

{
    public partial class ListCellViewController : UIViewController
    {
        #region Constructors

        // The IntPtr and initWithCoder constructors are required for items that need 
        // to be able to be created from a xib rather than from managed code

        public ListCellViewController (IntPtr handle) : base(handle)
        {
            Initialize ();
        }

        [Export("initWithCoder:")]
        public ListCellViewController (NSCoder coder) : base(coder)
        {
            Initialize ();
        }

        public ListCellViewController () : base("ListCellViewController", null)
        {
            Initialize ();
        }

        void Initialize ()
        {
        }
        public UIImageView Thumbnail
        {
            get{return thumbnailView;}
        }
        public UITableViewCell Cell
        {
            get {return cell;}
        }
        public void SetValues(string title,decimal price,decimal valuex,decimal discount,int purchases)
        {

        }
        #endregion
    }
} 
```

非常感谢所有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T15:35:57.477

我找到了一个简单的（也许不是最优的）解决方案。我使用的技巧是一个 Queue 对象来存储最后 n 个有效图像 url，其中 n 是屏幕中可显示的单词数。一旦一个单元格被重用，最后一个图像 url 就会出队，当它即将显示时，我检查它是否在队列中，如果不是，我拒绝它。

# java - 将 Double 舍入为 2dp

> ID：12661455
> 
> 赞同：1
> 
> 时间：2012-09-30T13:05:41.613
> 
> 标签：java, decimal

我目前正在尝试编写一个将“双”变量四舍五入到小数点后两位的程序。

我有方法：

```
DecimalFormat df = new DecimalFormat("#.00"); 
```

但是，当我应用该方法时：

```
double x = df.format(y-z); 
```

我收到一个错误，告诉我应该是“双”，但找到了一个“字符串”。

关于如何解决这个问题的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:07:24.773

试试这个

```
@Test
public void test() {
    int f = 100;

    double d = 123.456;
    double temp = d * f;
    double rounded = Math.round(temp);
    double to2dp = rounded / f;

    Assert.assertEquals(123.46, to2dp, 0.00001);
} 
```

f = 100 来自 2dp。您将 f = 10 用于 1dp 等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T20:24:55.093

如果您使用双精度数来存储/计算货币价值，那么您可能会发现自己陷入了四舍五入的痛苦世界。去过那里，做过，有伤痕。

我强烈建议您使用**所有**`BigDecimal`货币值的值，甚至不要在实例化中涉及双精度值。始终使用构造函数。**`String`**

 **[请在此处](https://stackoverflow.com/questions/7186204/bigdecimal-to-use-new-or-valueof/9713581#9713581)和[此处](https://stackoverflow.com/questions/460755/new-bigdecimal13-3d-results-in-imprecise-13-3000000000000007105?rq=1)查看相关问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T01:30:29.823

在对我的其他答案的评论中，Gary Rowe 建议使用 Joda Money 作为解决方案。

现在虽然这可能是一个很好的产品，我不得不承认我没有尝试过，但我有点担心他们文档中的以下示例：

```
// multiplies by 3.5 with rounding
money = money.multipliedBy(3.5d, RoundingMode.DOWN); 
```

现在这是一个有趣的例子，因为他们使用了可以用双精度精确表示的双精度数。

为了说明这一点，我们以下面的单元测试为例：

```
 double d1 = 3.5d;
    BigDecimal bd1 = new BigDecimal(d1);
    System.out.println("BD version of " + d1 + " = " + bd1);

    BigDecimal bd2 = new BigDecimal("10000000");
    BigDecimal bd3 = bd2.multiply(bd1);

    System.out.println("Result in bd3 = " + bd3); 
```

这会产生以下输出：

```
BD version of 3.5 = 3.5
Result in bd3 = 35000000.0 
```

但是，如果将 '3.5d' 更改为 '3.4d'，则会得到截然不同的结果：

```
BD version of 3.4 = 3.399999999999999911182158029987476766109466552734375
Result in bd3 = 33999999.999999999111821580299874767661094665527343750000000 
```

现在 Joda Money 类可能会（以某种方式）处理这个问题，但是将任何双精度数字引入混合中是充满危险的。

Gary，也许你可以评论一下 Joda Money 中类似计算的结果。**

# eclipse - 在单个面板中显示更改的 Eclipse 比较编辑器

> ID：12661457
> 
> 赞同：0
> 
> 时间：2012-09-30T13:05:53.480
> 
> 标签：eclipse, plugins

[有没有办法像Trac 那样](http://www.hermann-uwe.de/files/images/trac.preview.jpg)比较单个面板中对文件所做的更改，而不是并排显示更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:15:59.823

在 Eclipse 中不是默认设置，但是您可以使用[External Diff](http://sourceforge.net/projects/externaldiff/)插件来使用您想要的任何外部差异应用程序。

# ruby-on-rails - 仅当内容类型为图像时，如何设置回形针样式？

> ID：12661458
> 
> 赞同：7
> 
> 时间：2012-09-30T13:05:53.893
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在使用以下内容：

```
has_attached_file :file,:styles => { :thumbnail => '320x240!'},:url => "/images/:attachment/:id/:style/:basename.:extension",:path => ":rails_root/public/images/:attachment/:id/:style/:basename.:extension"

validates_attachment_content_type :file, :content_type => [ 'image/gif', 'image/png', 'image/x-png', 'image/jpeg', 'image/pjpeg', 'image/jpg' ] 
```

上传图片和视频。如果我使用`:style =>{}`，则图像不会上传。`:style`只有当文件的内容类型是图像时，我才想使用方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-30T19:49:06.887

您可以在 lambda 中使用条件，对于丑陋的格式感到抱歉：

```
has_attached_file :file, :styles => lambda 
{ |a| 
      if a.instance.is_image?
        {:thumbnail => "320x240!"}
      end
}

def is_image?
    return false unless asset.content_type
    ['image/jpeg', 'image/pjpeg', 'image/gif', 'image/png', 'image/x-png', 'image/jpg'].include?(asset.content_type)
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-28T15:39:27.390

2016 年更新：

大多数赞成的答案仍然有效，但如果它不是预期的类型（例如，您不想处理的 PDF 而不是图像），您需要返回一个空哈希，否则您会遇到`TypeError - can't dup NilClass`问题。

为了简洁起见，使用三元组的示例：

```
has_attached_file :file, :styles => lambda { |a| a.instance.is_image? ? {:thumbnail => "320x240!"} : {} } 
```

# hadoop - 为什么我的 hadoop map reduce 程序中出现类转换异常？

> ID：12661464
> 
> 赞同：1
> 
> 时间：2012-09-30T13:07:48.907
> 
> 标签：hadoop

为什么我的 hadoop map reduce 程序中出现类转换异常？现在这给了我一个例外。我的地图应该在键/值中生成 Text/IntWritable 输出。我正在这样做，但仍然收到 IOException

```
public class AverageClaimsPerPatentsByCountry {

    public static class  MyMap extends MapReduceBase implements Mapper<LongWritable, Text, Text, IntWritable> {

        @Override
        public void map(LongWritable key, Text value,
                OutputCollector<Text, IntWritable> output, Reporter reporter)
                throws IOException {

            String[] fields = value.toString().split(",");
            if(fields.length >=7) {
                String country = fields[4];
                String claimsCount = fields[8];
                System.out.println(value.toString());

                int i = Integer.valueOf(claimsCount);
                System.out.println(country+" --> "+i);
                if(claimsCount.length() > 0) {

                    output.collect(new Text(country), new IntWritable(i));
                }
            }
        }

    }

    public static class MyReducer extends MapReduceBase implements Reducer<Text, IntWritable, Text, DoubleWritable> {

        @Override
        public void reduce(Text key, Iterator<IntWritable> values,
                OutputCollector<Text, DoubleWritable> output, Reporter reporter)
                throws IOException {
            int count = 0;
            double claimsCount = 0;
            while(values.hasNext()) {
                claimsCount+=Double.valueOf(values.next().get());
                count++;
            }
            double average = claimsCount/count;
            output.collect(key, new DoubleWritable(average));           
        }

    }

    public static class MyJob extends Configured implements Tool {

        @Override
        public int run(String[] args) throws Exception {
            Configuration conf = getConf();
            JobConf job = new JobConf(conf, MyJob.class);
            FileInputFormat.addInputPaths(job, "patents/patents.csv");
            FileOutputFormat.setOutputPath(job, new Path("patents/output"));
            job.setInputFormat(TextInputFormat.class);
            job.setOutputFormat(TextOutputFormat.class);
            job.setOutputKeyClass(Text.class);
            job.setOutputValueClass(DoubleWritable.class);
            job.setMapperClass(MyMap.class);
            job.setReducerClass(MyReducer.class);
            JobClient.runJob(job);
            return 0;
        }

    }

    public static void main(String[] args) throws Exception {
        Configuration conf = new Configuration();
        ToolRunner.run(conf, new MyJob(), args);
    }

}

Exception :-->
12/09/30 18:32:34 INFO mapred.JobClient: Running job: job_local_0001
12/09/30 18:32:34 INFO mapred.FileInputFormat: Total input paths to process : 1
12/09/30 18:32:34 INFO mapred.MapTask: numReduceTasks: 1
12/09/30 18:32:34 INFO mapred.MapTask: io.sort.mb = 100
12/09/30 18:32:35 INFO mapred.MapTask: data buffer = 79691776/99614720
12/09/30 18:32:35 INFO mapred.MapTask: record buffer = 262144/327680
4000000,1976,6206,1974,"US","NV",,1,10,106,1,12,12,17,0.3333,0.7197,0.375,8.6471,26.8333,,,,
"US" --> 10
12/09/30 18:32:35 WARN mapred.LocalJobRunner: job_local_0001
java.io.IOException: Type mismatch in value from map: expected org.apache.hadoop.io.DoubleWritable, recieved org.apache.hadoop.io.IntWritable
    at org.apache.hadoop.mapred.MapTask$MapOutputBuffer.collect(MapTask.java:850)
    at org.apache.hadoop.mapred.MapTask$OldOutputCollector.collect(MapTask.java:466)
    at action.eg1.AverageClaimsPerPatentsByCountry$MyMap.map(AverageClaimsPerPatentsByCountry.java:53)
    at action.eg1.AverageClaimsPerPatentsByCountry$MyMap.map(AverageClaimsPerPatentsByCountry.java:1)
    at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:50)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:358)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:307)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:177)
12/09/30 18:32:35 INFO mapred.JobClient:  map 0% reduce 0%
12/09/30 18:32:35 INFO mapred.JobClient: Job complete: job_local_0001
12/09/30 18:32:35 INFO mapred.JobClient: Counters: 0
Exception in thread "main" java.io.IOException: Job failed! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:15:55.703

如果您没有为您的映射器指定输出类，它将默认为 setOutputClass 中给出的类，即 MyReducer。

你需要这个：

```
setMapOutputClass(IntWritable.class) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T20:59:15.323

引用[https://developer.yahoo.com/hadoop/tutorial/module4.html](https://developer.yahoo.com/hadoop/tutorial/module4.html)：

> reducer 发出的数据类型由 setOutputKeyClass() 和 setOutputValueClass() 标识。默认情况下，假设这些也是映射器的输出类型。如果不是这种情况，则 JobConf 类的方法 setMapOutputKeyClass() 和 setMapOutputValueClass() 方法将覆盖这些方法。

因此 setOutputKeyClass() 和 setOutputValueClass() 定义了 mapper 和 reducer 的输出类型。如果映射器应该具有不同的输出类型，请使用 setMapOutputKeyClass() 和 setMapOutputValueClass()。

在当前的 Haddop 版本（2.5.1 以及之前的一些版本）中，建议使用 Job 类而不是 JobConf：

```
Job job = Job.getInstance(new Configuration());

job.setMapOutputKeyClass(YourOutputKeyClass1.class);
job.setMapOutputValueClass(YourOutputValueClass1.class);

job.setOutputKeyClass(YourOutputKeyClass2.class);
job.setOutputValueClass(YourOutputValueClass2.class); 
```

如果您有一个仅映射器的工作（没有减速器），则从引用（和我的经验）得出结论 setOutputKeyClass() 与 setMapOutputKeyClass() 具有相同的效果（对于 setOutputValueClass() 和 setMapOutputValueClass() 相同）。

# xcode - 未调用 tableview 上的 Xcode didSelectRowAtIndexPath

> ID：12661471
> 
> 赞同：0
> 
> 时间：2012-09-30T13:09:25.460
> 
> 标签：xcode, uitableview, uiviewcontroller, didselectrowatindexpath

我一直在看今天早上6点，但我无法弄清楚为什么没有调用didSelectRowAtIndexPath方法。我对此感到非常绝望。

表格视图显示正确，但我无法成功启用单元格的选择。

在头文件中，我添加了：

```
@interface AlertsTable : UIViewController<UITableViewDelegate, UITableViewDataSource, CMPopTipViewDelegate>{
    UITableView *TableView;
}

@property (nonatomic, retain)   UITableView *TableView; 
```

在实现文件中：

```
@synthesize TableView;

- (void)viewDidLoad
{
    [super viewDidLoad];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;

    //Set the title

    //Format Alerts table
    //self.view.backgroundColor = [UIColor redColor];
    CGFloat sideMargin = 10;
    CGFloat topBottomMargin = 44;
    CGFloat originX = sideMargin;
    // compute width based on view size
    CGFloat sizeWidth = (self.view.bounds.size.width - (sideMargin * 2));
    CGFloat originY = topBottomMargin;
    // compute height based on view size
    CGFloat sizeHeight = (self.view.bounds.size.height - (topBottomMargin * 2));
    //self.view.frame = CGRectMake(originX, originY, sizeWidth, sizeHeight);

    self.TableView = [[UITableView alloc] initWithFrame:CGRectMake(originX, originY, sizeWidth, sizeHeight) style:UITableViewStylePlain];

    //Initialize the array.
    AlertsItems = [[NSMutableArray alloc] initWithObjects: @"Alert 1", @"Alert 2", @"Alert 3" , @"Alert 4", @"Alert 5", @"Alert 6", nil];

[self.TableView setDelegate:self];
[self.TableView setDataSource:self];
[self.view addSubview:TableView];
TableView.userInteractionEnabled = YES;
TableView.allowsSelection = YES;
TableView.allowsSelectionDuringEditing = YES;
NSLog(@"delegate:%@ dataSource:%@", self.TableView.delegate, self.TableView.dataSource);

} 
```

检查时委托和数据源都不是零。
请注意，“Alertstable”继承自 UIViewController，而不是 UITableViewController。
由于我选择的实现，这是必要的：表格视图显示在屏幕上显示的弹出窗口上（使用我从互联网上获取的另一个类）。

这是 didSelectRowAtIndexPath 方法：

```
#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *alertString = [NSString stringWithFormat:@"Clicked on row #%d", [indexPath row]];
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:alertString message:@"" delegate:self cancelButtonTitle:@"Done" otherButtonTitles:nil];
    [alert show];

} 
```

方法：

```
[super touchesBegan:...];  
[super touchesEnded:...];  
[super touchesMoved:...]; 
```

没有实施。

我从另一个 ViewController 添加了 AlertTable

```
AlertsTable *AlertTable = [[AlertsTable alloc] WithButton:sender withArray:self.PopTipViews];
[self.view addSubview:AlertTable.view]; 
```

我还实现了：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Set up the cell...
    [[cell textLabel] setText:[AlertsItems objectAtIndex:indexPath.row]];
    NSLog (@"%@",[AlertsItems objectAtIndex:indexPath.row]);
    return cell;

} 
```

你知道问题可能是什么吗？
我在 Xcode 方面不是很有经验，而且我真的被卡住了。

编辑：

我知道这不是自定义的，但是可以在这里找到项目的链接（也许我忽略了一些东西：

[https://www.bilbu.be/BarConnect_v2.zip](https://www.bilbu.be/BarConnect_v2.zip)

LoginViewController.xib 没有正确链接（它在 en.lproj 子文件夹中可用）所以你可能需要先链接（我注意到太晚了，我之前有朋友上传了文件 - 不幸的是我自己无法重新上传）。
ViewController VC 类调用AlertsTable VC 类。我想你可以忽略项目中的更多内容......
请注意，这个项目的目的只是作为可视化界面原型。它并不意味着是最佳优化的应用程序（这是其他开发人员会做的）。如果这不起作用，我将使用 Photoshop 创建界面，但我想这不会那么令人信服……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:37:45.060

我成功编译了你的项目。问题是你违背了 MVC 模式。控制器 ( `AlertsTable`) 在视图 ( `CMPopTipView`) 内。我建议您重新考虑控制器和视图的层次结构。希望这会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:41:14.150

尝试改变

```
TableView.userInteractionEnabled = YES;
TableView.allowsSelection = YES;
TableView.allowsSelectionDuringEditing = YES; 
```

到

```
self.TableView.userInteractionEnabled = YES;
self.TableView.allowsSelection = YES;
self.TableView.allowsSelectionDuringEditing = YES; 
```

你在分配 self.TableView 吗？就像是...

```
self.TableView = [[UITableView alloc] init];//[[UITableView alloc] initWithStyle:UITableViewStylePlain]; 
```

# c++ - 如何使用代码块 Ubuntu 编译 64 位 c++ prog

> ID：12661472
> 
> 赞同：1
> 
> 时间：2012-09-30T13:09:39.393
> 
> 标签：c++, 64-bit, codeblocks, ubuntu-11.10

我有一个多线程 c++ 代码，我正在尝试使用 64-ubuntu 上的代码块对其进行编译，对于 32 位编译，我给出了 -m32 并且效果很好，但对于 64 位，我给出了 -m64 并且它失败了。我在用

```
#elif defined(__ia64__) && defined(__GNUC__) 
```

它根本无法识别它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:19:31.790

您确定要使用“ia64”吗？在大多数情况下，这指的是 Itanium CPU；您可能打算检查 __x86_64 或 __amd64 或类似的东西。

编辑：这仍然留下了为什么要检查特定 CPU 的问题。

# css - 响应式全屏网格

> ID：12661475
> 
> 赞同：1
> 
> 时间：2012-09-30T13:10:00.377
> 
> 标签：css, media-queries

我的目标是：

*   全屏
*   侧边栏菜单和内容
*   调整为移动设备时，菜单在顶部，其余在下方
*   就是这样

我喜欢 Foundation 网格。但我发现没有“合法”的方式来做到这一点。

有可能吗，或者您会为此建议什么网格框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:19:38.570

听起来你真正需要的是：

```
<body>
    <div id="navbar">...</div>
    <div id="content">...</div>
</body> 
```

CSS：

```
#navbar {
    position: fixed; 
    left: 0; top: 0; bottom: 0;
    width: 150px;
    overflow: auto;
}
#content {margin-left: 150px;}
@media all and (max-width: 480px) {
    #navbar {
        bottom: auto; right: 0;
        height: 150px;
        overflow: auto;
    }
    #content {margin-left: 0; margin-top: 150px;}
} 
```

或者，有两个导航栏（一个用于普通设备，一个用于移动设备）并使用媒体查询显示/隐藏它们。

# android - 使用 linux convert 实用程序用空白填充图标

> ID：12661479
> 
> 赞同：1
> 
> 时间：2012-09-30T13:10:25.353
> 
> 标签：android, linux, image, imagemagick, imagemagick-convert

我有一堆不同大小的PNG图标：

```
96x96
96x23
96x46
96x80
etc... 
```

`convert`我怎样才能在 linux实用程序的帮助下填充它们。这样所有图标都具有相同的正方形尺寸，例如`96x96`。

现有图像应居中。像这样（对于 size 的图像`5x5`）：

```
.....
xxxxx
xxxxx
xxxxx
..... 
```

我使用以下命令来缩放图像。也许，我只是忘记了一些参数？

```
convert -size 96x96 icon.png -resize 96x96 +profile '*' scaled.png 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:06:46.163

这个应该有帮助：

```
convert             \
   icon.png         \
  -scale 96x96      \
  -background white \
  -gravity center   \
  -extent 96x96     \
  +profile '*'      \
   scaled.png 
```

# css - div 顶部和后面的图像

> ID：12661485
> 
> 赞同：-1
> 
> 时间：2012-09-30T13:11:11.473
> 
> 标签：css, html

有人可以快速帮助我。

看看[http://www.laebelliving.dk/](http://www.laebelliving.dk/)我的想法是把两张图片放在同一个地方，但在某些 div 的后面和上面。

例如，我希望在我的 div 内容周围从它的后面和上面生长一片叶子。但我希望这对跨浏览器非常友好，因此无论他们使用什么分辨率或浏览器，它都会将叶子放在页面的完全相同的位置。

我怎样才能用css轻松做到这一点？:)

回答所有 z-index 答案：是的，但是我如何将图像准确地放在我的 div 的边界上，无论人们查看网站的分辨率是多少，如果您打开浏览器的窗口大小并查看它，您会看到盒子大小不变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:19:30.897

看一下z-index。示例：http: [//jsfiddle.net/xY5Re/64/](http://jsfiddle.net/xY5Re/64/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:17:46.263

您可以使用 CSS z-index 将 div 和图像作为图层：

[这里的例子](http://www.quackit.com/css/properties/css_z-index.cfm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T13:20:08.010

也许使用 z-index:-1; 为您的图像

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T13:25:13.560

我不知道所有浏览器都需要支持什么。我的建议是使用 cuss3 比例属性和 z-index

# python - 如何优化在`django-mptt`中添加新节点？

> ID：12661488
> 
> 赞同：5
> 
> 时间：2012-09-30T13:12:32.510
> 
> 标签：python, database, django, performance, django-mptt

我正在创建一个脚本，它将同步两个数据库。数据库中有一个数据应该存储为树，所以我将[django-mptt](http://django-mptt.github.com/django-mptt/)用于新数据库。当我同步数据库时，我从旧数据库中选择新数据并将其保存在新数据库中。

我想知道是否有更好的方法将新节点添加到树中？现在它看起来下一个方式：

```
...
# Add new data to DB
for new_record in new_records:
    # Find appropriate parent using data in 'new_record'
    parent = get_parent(new_record)

    # Create object which should be added using data in 'new_record'
    new_node = MyMPTTModel(...)
    new_node.insert_at(parent, save = True)
    # Similar to:
    # new_node.insert_at(parent, save = False)
    # new_node.save() 
```

但它的工作非常缓慢。我认为它以这种方式工作，因为在每次调用该`insert_at(..., save = True)`方法后，都`django-mptt`应该将新节点写入数据库并修改数据库中已经存在的记录的键 `left`。`right`

有没有办法在`django-mptt`我每次打电话时修改查询`insert_at`，然后在我打电话时一起应用所有更改`save`？或者您知道如何减少执行时间的其他方法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-01T21:05:12.407

首先，不要使用`insert_at`. 这不是性能缓慢的原因，但它是不必要的并且看起来很难看。只需设置`node.parent`：

```
for new_record in new_records:
    new_node = MyMPTTModel(..., parent=get_parent(new_record))
    new_node.save() 
```

现在是性能问题。如果您使用的是最新的 mptt（git master，而不是 0.5.4），则会调用一个上下文管理器[`delay_mptt_updates`](http://django-mptt.github.com/django-mptt/mptt.managers.html#mptt.managers.TreeManager.delay_mptt_updates)来防止 mptt 在添加所有节点之前进行大量此类更新：

```
with transaction.atomic():
    with MyMPTTModel.objects.delay_mptt_updates():
        for new_record in new_records:
            new_node = MyMPTTModel(..., parent=get_parent(new_record))
            new_node.save() 
```

[`disable_mptt_updates`](http://django-mptt.github.com/django-mptt/mptt.managers.html#mptt.managers.TreeManager.disable_mptt_updates)或者，如果您几乎要接触整棵树，则可以通过在最后使用并重建整棵树来加快速度：

```
with transaction.atomic():
    with MyMPTTModel.objects.disable_mptt_updates():
        for new_record in new_records:
            new_node = MyMPTTModel(..., parent=get_parent(new_record))
            new_node.save()
    MyMPTTModel.objects.rebuild() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:55:05.217

Django-MPTT 为您维护了一个树形结构。因此，在每个`insert_at`节点上，它都会修改插入节点右侧的所有节点 - 这就是您遇到性能问题的原因。

一种方法是手动构建不带`django-mptt`.

因此，您将必须获取新记录，并根据它们确定树中的旧节点必须修改多少。由于您只是插入数据，因此只有左右属性会更改，但不会更改级别，因此应该会更容易一些。一旦您知道要修改哪些节点，您就可以使用一个`update`事务（*编辑*）来修改它们。

然后，您可以开始插入新数据。同样，最快的方法是计算每个新条目的左、右和水平值，然后计算一个`bulk_insert`（Django>=1.4）。这样做只会导致两个数据库操作，这在数据库事务方面显然应该快得多。

然而，这种方法需要一些聪明的方法来弄清楚如何更改树中的旧节点。最简单的方法是将所有树转储到 python 结构中，然后找出该结构上的更改。但是，如果您的树由于内存限制而非常大，那将不可行。

现在不确定是否有更有效的方法来做到这一点。也许 StackOverflow 上的其他人有一些很酷的想法......

**编辑**

很抱歉`update`造成混乱。我的意思是一笔交易。在这种情况下，我通常会在我做的地方进行原始 sql 查询`update tbname set ... where id=1; update tbname set ... where id=2;`所以我在一个 sql 查询中执行多个 sql 语句。根据我的经验，数据库的昂贵部分不是执行语句，而是事务本身，因为存在网络延迟、数据库锁等。因此，拥有一个事务可以让数据库尽可能快。但是不确定如何在 django 中使用查询集来做到这一点。我通常做原始的 sql 查询。

# c# - 受保护的内部

> ID：12661494
> 
> 赞同：13
> 
> 时间：2012-09-30T13:13:14.767
> 
> 标签：c#, internal, protected

MSDN 上的 C# 语言参考将“受保护的内部”定义为“访问仅限于当前程序集或从包含类派生的类型”。但是从语义的角度来看，“受保护的内部”对我来说听起来像“受保护的和内部的”，这意味着该成员只能被同一程序集中的那些派生类访问。是否有任何具有相同含义的访问修饰符？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-30T13:18:03.297

C# 没有任何这样的访问修饰符。

但是，CLR 确实支持它，因为 FamANDAssem 访问级别（`protected internal`是 FamORAssem）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:17:36.997

不，没有这样的修饰符。`Internal`应该足够了，因为您应该能够从同一程序集中的其他类型中知道什么是合法的，什么不是。

# javascript - 使用 dojo 1.8 创建类声明

> ID：12661496
> 
> 赞同：0
> 
> 时间：2012-09-30T13:13:27.520
> 
> 标签：javascript, class, dojo

我使用 dojo 1.8 作为 javascript 库。我正在尝试为我的一个项目创建一个小的 Vector 类。

我创建了一个函数 clone 来克隆向量对象。这是我的课“td/Vector”

```
define([
    'dojo/_base/declare',
    'td/Vector'
], function(declare, Vector) {
return declare(null, {

    x: null,
    y: null,

    constructor: function(x, y) {
        this.x = x;
        this.y = y;
    },

    clone: function() {
        return new Vector(this.x, this.y);
    },

    length: function() {
        return Math.sqrt((this.x * this.x) + (this.y * this.y));
    },

    normalize: function() {
        var length = this.length();
        this.x = this.x / length;
        this.y = this.y / length;
    },

    distance: function(target) {
        return new Vector(target.x - this.x, target.y - this.y);
    }
});
}); 
```

现在我的问题：

变量“Vector”是一个空对象。

那么我该怎么做这样的事情。JavaScript中是否存在PHP中的“self”之类的东西？在类本身中创建新的 self 实例的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T17:36:29.680

该`Vector`变量是`td/Vector`模块的返回值，即`td/Vector.js`文件，而不是你`declare`上面的类，这应该是它是一个空对象的原因。

要引用类本身：

```
define(["dojo/_base/declare"], function(declare) {

    var Vector = declare(null, {    

        constructor: function(x, y) {
            this.x = x;
            this.y = y;
        },

        clone: function() {
            return new Vector(this.x, this.y);
        }
    });

    return Vector;

}); 
```

在 jsFiddle 上查看它的实际效果：http: [//jsfiddle.net/phusick/QYBdv/](http://jsfiddle.net/phusick/QYBdv/)

# jsp - 通过单个 Servlet 处理不同的请求

> ID：12661497
> 
> 赞同：0
> 
> 时间：2012-09-30T13:13:42.993
> 
> 标签：jsp, servlets

我的servlet是这样的

```
@WebServlet(name = "login", urlPatterns = {"/login"})
public class login extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
    }

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        String username = request.getParameter("username");
        String password = request.getParameter("password");
        password = Base64.encode(password.getBytes());
        User user = new User();
        user.setUsername(username);
        user.setPassword(password);
        user.getLoggedIN();
} 
```

根据这个 servlet，我可以使用“登录”并将 GET 或 POST 数据发送到这个 serverlt，这完全没问题我的问题是，有没有办法可以使用这个 serverlt 并引导不同的请求。例子

1.  'login'（将执行 post 请求）-> doPost() 方法（我知道 doPost）
2.  'signout'（将执行 post 请求）-> 定义了另一个方法，它将充当 doPost 方法

我不知道这是否可能！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:42:08.400

*   我想你会有`SignOut`和`Login`按钮的名称。因此，当您单击其中一个时，`Servlet`您可以 `button`通过调用`request.getParameter()`按钮名称来检查实际单击的是哪个，然后将请求转发给适当的方法。

所以，在你的`servlet`，你可以有这样的代码： -

```
if (request.getParameter("LoginButton") != null) {
     // Forward to login method

} else if(request.getParameter("SignOutButton") != null) {
     //Forward to signout method..
} 
```

*   另一种方法是将名称发送`Button`为`Query String`... 您可以`servlet`使用从该查询字符串中获取名称`request.getParameter()`

所以你的**查询字符串**看起来像：

```
http://localhost:8080/yourServlet?action=Login
http://localhost:8080/yourServlet?action=SignOut 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:33:10.420

我在类似情况下所做的如下：

1.  使用隐藏字段描述我想要执行的操作类型（例如登录、注销、输入数据、更新数据等任何你想要的）
2.  从请求对象中检索隐藏参数的值。
3.  对每个可能的操作使用 if else 梯形图，然后在 if else 块中调用适当的方法。

我知道这是非常基本的，但希望它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:33:57.983

添加另一个模式。检查每种请求类型的唯一请求参数，或者您还可以使用“request.getRequestURI”方法验证它是登录请求还是路标请求

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-12-03T04:36:02.857

请参阅根据我们用于将要处理的数据（例如，从 HTML 表单）提交到已识别资源的一般场景帖子。数据包含在请求的正文中。这可能导致创建新资源或更新现有资源或两者兼而有之。

因此，在 UI 中，您将插入数据以及您也可以在数据库中看到的特定数据。在您的代码中

```
 @Override
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {

    String username = request.getParameter("username");
    String password = request.getParameter("password");
    password = Base64.encode(password.getBytes());
    User user = new User();
    user.setUsername(username);
    user.setPassword(password);
    user.getLoggedIN(); 
```

只获取您正在设置的数据。或者你可以使用

```
if(user!=null){ 
```

//在这里您可以将您的请求转发到某个地方。}

# android - 如何在 shell 脚本中作为 /src last 文件夹的变量？

> ID：12661499
> 
> 赞同：0
> 
> 时间：2012-09-30T13:14:28.630
> 
> 标签：android, shell, adb, ubuntu-12.04, pwd

这个 sh 脚本位于`<project-dir>/w`名为“install.sh”的文件中

我想抓住我的目录姓氏“bes”在哪里 `<project-dir>/src/com/seri/bes`

```
 #!bin/bash 
```

我`myendpath=${PWD##*/}`在这一行使用，但变量返回“w”；

```
myendpath=ls ../src/com/seri/
me="../bin/$myendpath-debug.apk"
adb uninstall com.seri.$myendpath
adb install $me 
```

我怎样才能达到名称价值`<project-dir>/src/com/seri/*`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:38:05.050

```
#!bin/sh  
my1=$(ls ../src/com/seri)
my2="../bin/$my1-debug.apk"
adb uninstall com.seri.$my1
adb install $my2 
```

我做到了.. 使用命令行 android 太有用了

# css - 整页设计：如何强制 Div 在页面底部停止扩展

> ID：12661500
> 
> 赞同：5
> 
> 时间：2012-09-30T13:14:45.613
> 
> 标签：css, overflow

如果标题有点混乱，我很抱歉，但我不知道如何用一句话来描述我的问题。所以基本上我几天以来一直在整页/屏幕设计上苦苦挣扎。

在我的设计中，我有多个包含一些文本的 Div，其中一个比正常屏幕分辨率的高度大得多。此外，我不希望网站在查看者浏览器的一侧有滚动条，我宁愿在 div 中有一个太大的滚动条（例如在这个 div 中使用*溢出：自动；*）。但是我似乎无法同时获得 div 和滚动的正确定位。

[这是我的情况的 CodePen](http://codepen.io/anon/pen/IlKtq)，我希望红色和蓝色的 Div 像这样定位，但我也希望蓝色的 div 在到达页面底部时停止扩展，并在它发生时滚动。

我发现获得滚动的唯一方法是使用*max-height*或*absolute 定位*。然而，这些解决方案都不可行，因为每个屏幕分辨率的蓝色 div 的最大高度是不同的，并且红色 div 的高度不是固定的。另外，如果我尝试使用绝对定位，我最终会看到蓝色 div 站在红色 div 上方，因为蓝色 div 的绝对定位使它离开“流”（并且我不能使用*margin-top: “height of the red div"* ; 解决这个问题，因为红色 div 的高度不固定）。

希望我的解释很清楚，有人能够帮助我。顺便说一句，我宁愿不使用 JS，但如果有必要我会使用它。此外，我欢迎旧版 IE 上没有的解决方案，因为我的观众都没有使用它们。

谢谢，托马斯A

**编辑：**为了更清楚，我希望它看起来像那样[，](http://codepen.io/anon/pen/rGlom)但蓝色 div 的高度（*#bottom-inside-container*）是动态的而不是固定的（从 div 的开头到页面底部，无论如何页面大小）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-09-15T18:16:21.317

3 年后，有了更好的浏览器支持，使用 flexbox 属性很容易。您可以在 CSS 中**添加**以下内容：

```
#wrapper {
    display:flex; 
    flex-direction:column;
}
#top-inside-container {
    flex-grow:2;
}
#bottom-inside-container {
    flex-grow:1;
    overflow-x: hidden;
    overflow-y: auto;
} 
```

将 flex-grow:2 设置在容器的顶部，它很小，它会使其增长，直到它显示出它的所有内容。在容器底部设置溢出将隐藏（用于水平滚动）并设置（用于垂直滚动）滚动条，具体取决于它必须显示的内容量。

这是基于您的 codepen 的代码，修改最少：

[http://codepen.io/anon/pen/BLKENA](http://codepen.io/anon/pen/BLKENA)

PD：我来自谷歌搜索类似的答案......无论如何它可以帮助某人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:53:26.363

您可以通过将蓝色 div 设置为 position: absolute 然后设置顶部和底部值来做到这一点。IE

```
html, body{
    width: 100%; height: 100%; margin: 0; padding: 0;
}
#top-inside-container {
    position: absolute; top: 0; width: 100%; height: 100px; background:rgb(75,0,0);
}
#bottom-inside-container {
    position: absolute; width: 100%; top: 100px; bottom: 0; background:rgb(0,75,200); overflow-y: scroll;
} 
```

它在这里工作： [http ://codepen.io/anon/pen/qnwFf](http://codepen.io/anon/pen/qnwFf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T13:30:41.223

您的包装器不会滚动，因为它没有高度（或 100%）。然后，应用默认浏览器滚动，但您不能在包装级别滚动。

通过简单地给你的包装器一个高度来滚动工作 - 例如：

```
#wrapper { 
  position:fixed;
  right:550px;
  left:0;
  background:rgb(200,200,200);
  height: 500px;
  overflow: auto;
} 
```

希望这会有所帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T15:21:33.663

您说您的第二个失败选项（在蓝色 div 上使用绝对定位）无法完成，因为它离开了正常流程。好吧，我通过将红色和蓝色 div 都包含在相对父级中，使蓝色 div 成为绝对的，同时不离开正常流程，请参阅[http://codepen.io/anon/pen/KEdwG](http://codepen.io/anon/pen/KEdwG)

但是，它仍然失败..原因是，您将现在的绝对蓝色 div 设置为多少高度？你不能给出答案，我也不能，但是“溢出：滚动”需要知道在什么高度开始滚动。这就是为什么这不能仅使用 CSS 完成的原因。

因此，如果您不介意在您的 中添加两行 jquery `document.ready()`，请参阅[**我的笔**](http://codepen.io/nbenitez/pen/wrnLg)以这种方式解决它，您可以忽略`window.resize()`页面的代码，因为我将它放在笔中，这样您就可以垂直拖动 iframe 并查看如何蓝色 div 保持预期的高度。

另外，如果您查看我的笔的 css 注释，我会将您的内容更改`left:25px`为`4%`，因为相对父母需要正确处理（除了通常使用 % 比使用 px 更好）。

我在这里粘贴 pen jquery 代码只是为了方便：

```
$(document).ready(function() {
  max = $(document).height() - $('#bottom-inside-container').offset().top;
  $('#bottom-inside-container').css('max-height',max);
}); 
```

# python - Python二类初始化

> ID：12661504
> 
> 赞同：1
> 
> 时间：2012-09-30T13:15:07.263
> 
> 标签：python

我在 python 类上有我的第一个任务：

*   创建一个模块`vectors.py`
*   这将是一个类定义`MyVector`
*   构造函数将接受一个参数，该参数将是一维数组。
*   `get_vector()`方法返回包含向量元素的一维数组。
*   使用特殊方法`__ mul__(self, other)`实现两个 MyVector 类型对象的点积。输出是一个标量（单个数字）。

现在看起来是这样的：

```
class MyVector:
    def __init__(self,vector=[]):
        self.vector=vector

    def get_vector(self):
        return (self.vector)        

    def __mul__(self,other):
        dot=sum(p*q for p,q in zip(self.vector, WHAT IS HERE?))
        return(dot) 
```

我有第一个向量，但是如何初始化第二个向量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:17:40.023

如果您假设`other`特殊`__mul__`方法的参数是 的实例`MyVector`，则该实例还将具有一个名为的属性`vector`，您可以访问该属性：

```
def __mul__(self,other):
    dot=sum(p*q for p,q in zip(self.vector, other.vector))
    return (dot) 
```

并且不要`[]`在函数参数中用作默认值，请使用以下内容：

```
 def __init__(self,vector=None):
    self.vector=vector if vector else [] 
```

# trac - 我怎么能算出 $ENV 的 trac？

> ID：12661509
> 
> 赞同：2
> 
> 时间：2012-09-30T13:15:28.063
> 
> 标签：trac

我在 win7_64 上通过 bitnami 安装 trac 并在对话框询问我时设置一个项目。当我创建一个新的存储库时，我想与它同步并输入“trac-admin $ENV repository resync "libs_and_apps"

错误消息“错误：在 C:\Program Files\BitNami Trac Stack\$ENV [Errno 2] 没有找到 Trac 环境：'C:\Program Files\BitNami Trac Stack\$EN V\VERSION'”

我试图找出 $ENV 的正确答案，谷歌告诉我这是你项目的路径，但我不知道在哪里可以找到项目的路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:47:56.790

简而言之：使用引号来说明完整路径。

如您在此处看到的，文件补丁中的空格是邪恶的，最好避免使用它们。

# php - Yii : 如何使用最佳方法选择 1 个注册

> ID：12661510
> 
> 赞同：0
> 
> 时间：2012-09-30T13:15:50.433
> 
> 标签：php, mysql, yii, yii-cactiverecord

我在数据库中有一个表，我想从这个表中选择 1 个注册，使用 UPDATE 字段，例如：

```
select * from website order by update asc limit 1; 
```

有没有比使用 createCommand 更好的方法来加载注册？

一旦我加载注册，我如何更新更新字段？

我更喜欢使用 Active Records。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T15:07:36.400

您可以使用带有 CDbCriteria 和 CActiveRecord 的模型从数据库表中选择一行，如下所示：

```
$criteria = new CDbCriteria;
$criteria->order = '`update` ASC';
$model = Registration::model()->find($criteria); 
```

假设您的模型称为“注册”。

请参阅 CDbCriteria 的[order](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#order-detail)属性和 CActiveRecord 的[find()](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#find-detail)方法的手册。

然后，您可以像编辑任何其他活动记录一样编辑该记录并像往常一样保存，即

```
$model->update = new CDbExpression('NOW()');
$model->save(); 
```

（或任何你想设置“更新”字段的东西）

# dll - DLL 注入 - 调用目标进程的过程

> ID：12661523
> 
> 赞同：0
> 
> 时间：2012-09-30T13:17:17.497
> 
> 标签：dll, call, code-injection, procedure

我正在学习 DLL 注入，现在，我已经成功注入了我的 dll，（我已经通过添加`while(1){}`它来检查它）并且我想调用我的目标进程的内部函数（例如执行进程的内部函数，即在屏幕上写东西）。我不确定这一切是如何运作的，谁能指出一些描述良好的教程/手册？我自己很难找到这些信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T17:20:48.860

您还必须看看[“将代码注入另一个进程的三种方法”](http://www.codeproject.com/Articles/4610/Three-Ways-to-Inject-Your-Code-into-Another-Proces)！Robert Kuster 写了一篇关于一些非常智能的注入机制的优秀文章，在 Jeffrey Richter 的书中没有描述。它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:30:20.083

我会推荐[Jeffrey Richter 的](https://rads.stackoverflow.com/amzn/click/com/0735663777 "杰弗里·里希特")书。我就喜欢。关于 DLL 注入 API 挂钩的整整一章。我想这就是你要找的。

# android - 无法从 URI 启动应用程序

> ID：12661528
> 
> 赞同：0
> 
> 时间：2012-09-30T13:17:41.363
> 
> 标签：android

我已经查看了大多数类似主题的问题，并了解了意图过滤器的工作原理，但我无法让 android 启动我的应用程序。这是清单的相关部分：

```
 <activity
        android:name=".UriHandler" >
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />

            <category android:name="android.intent.category.DEFAULT" />

            <data android:scheme="myapp" />
        </intent-filter>
    </activity> 
```

我尝试从默认浏览器中单击以下链接：

```
<a href="myapp://param1/param2/param3">Test</a> 
```

它只是尝试将 URI 作为地址加载，而不是启动我的应用程序。我错过了什么？

**更新：**要使其工作，您需要添加

```
<category android:name="android.intent.category.BROWSABLE" /> 
```

根据意图，也忽略 Lint 并且不要添加

```
android:exported="false" 
```

就我而言，它粉碎了浏览器。

# c++ - 类型特定的执行和编译

> ID：12661529
> 
> 赞同：0
> 
> 时间：2012-09-30T13:17:45.403
> 
> 标签：c++, templates

我有一个双端队列，它应该包含结构 a 或结构 b。问题是其中一个结构包含一个我必须删除的指针。

```
#pragma once

#include <iostream>
#include <deque>
#include <typeinfo>

struct packetUpdate {
    int recv;
    int packetID;
};

struct packet {
    int recv;
    int packetSize;
    char* m_packet;
};

template <class T>
class PacketQueue
{
private:
    int m_lastElement;
    int m_maxElementReached;
    int m_maxElements;

    std::deque<T> m_PacketList;

public:
    PacketQueue() { m_lastElement = -1; m_maxElements = 0; m_maxElementReached = 0; }
    ~PacketQueue() 
    { 
        if(typeid(T).name() == typeid(packet).name()) {
            for(int i = 0; i < m_lastElement+1; i++) {
                delete[] m_PacketList[i].m_packet;
            }
        }

        m_PacketList.~deque(); 
    }
}; 
```

这行不通。编译器告诉我`packetUpdate`没有 member `m_packet`。我理解为什么它不起作用，但问题是，有没有办法在不编写两个看起来几乎相同的不同类的情况下完成这项工作。

这当然只是班级的一小部分，但它应该能说明我的问题。

我想我不是第一个遇到这样问题的人，但由于我不习惯使用模板，所以我不知道我应该寻找什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:28:48.123

这应该可行，**但是** `m_PacketList.~deque();`在析构函数中是一个坏主意，无论如何都会调用队列的析构函数，因此您要调用它两次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:23:50.177

您可以为类型数据包指定类析构函数，如下所示：

```
template<>
PacketQueue<packet>::~PacketQueue()
{
  //your code
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:28:42.707

最简单的方法就是在数据包中添加析构函数。如果这不可能，您可以添加策略模板来解决您的问题：

```
struct null_cleaner
{
    template <typename T>
    void perform_clean(T& v)
    { /* do nothing */ }
};

template <typename PacketQueue, typename Cleaner = null_cleaner>
class PacketQueue
{
    ~PacketQueue ()
    {
        for (int i = 0; i < m_PacketList.size(); ++i) {
            Cleaner::perform_clean(m_PacketList[i]);
        }  
    }
}; 
```

然后，当您添加需要清洁的类型时，您需要使用不同的清洁器：

```
// no cleaning
PacketQueue<packetUpdate> q1;

// requires cleaning
struct packet_cleaner
{
   void perform_clean(packet& p)
   {
       delete[] m_packet;
   }
};

// performs cleaning
PacketQueue<packet, packet_cleaner> q2; 
```

此外，不需要对 m_PacketList.~deque() 进行特定调用，实际上它只会破坏您的程序，因为编译器会确保无论如何都会调用它（因此您只需调用它两次）。

另外，由于 m_packet 不存在而导致编译器错误的原因是，无论 T == packet 还是 T == packetUpdate 都会编译 if 块，并且对于 packetUpdate，没有 m_packet。

# ios - 如何通过滑动制作可拖动的 UIView？

> ID：12661535
> 
> 赞同：0
> 
> 时间：2012-09-30T13:18:36.277
> 
> 标签：ios, uigesturerecognizer, gesture-recognition

在我的应用程序中，我有一个包含一些信息的屏幕，属于指定日期。我想制作滑动效果，左右拖动屏幕，更改日期。

我想，我应该创建 2 个 UIView（一个带有“明天”日期，第二个带有“昨天”）。

当我开始拖动时，如何使两个视图控件移动，一个开始从屏幕上消失，另一个开始出现，就像我们在标准应用程序中翻转照片一样？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:21:35.213

有一个名为 iCarousel 的库。它完全符合您的要求，并且通过处理所有动画/手势编码节省了很多麻烦。用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:23:03.393

使用 UIScrollView。使用分页设置 UIScrollView，然后设置内容大小...

```
yourScrollView.contentSize = CGSizeMake(320 * numberOfPages, 100); 
```

如果您需要知道用户正在查看哪个视图，请使用“scrollViewDidScroll:”来确定他们正在查看的页面。

# iphone - 更新 xcode 4.5 和 iOS 6 后应用程序在启动时崩溃

> ID：12661544
> 
> 赞同：1
> 
> 时间：2012-09-30T13:19:43.110
> 
> 标签：iphone, objective-c, ios6, xcode4.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T05:09:29.140

我在 C++ 子项目中意外禁用动态链接后遇到此错误，这导致`-static`编译时将标志传递给 clang。

通过在 LLVM 编译器语言设置中将“启用与共享库的链接”切换为“是”（默认）来摆脱它。`GCC_LINK_WITH_DYNAMIC_LIBRARIES = NO`（这将从项目文件中删除）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T15:29:06.350

在您的方案诊断中删除 Guard Malloc 选项。这就是导致我的错误的原因。

![在此处输入图像描述](../Images/6f2526962596592a40b011242fca82c7.png)

# python - MacOS 10.8 Python site-packages Eclipse Geek_tools

> ID：12661547
> 
> 赞同：0
> 
> 时间：2012-09-30T13:20:28.383
> 
> 标签：python, eclipse, libraries

I have python 2.7.3 installed to Mac OS 10.8\. All the files are in /Library/Frameworks/Python.framework/Versions/2.7/ ...

I installed setuptools-0.6c11-py2.7 with the following /.pydistutils.cfg:

```
[install]
install_lib = /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages
install_scripts = ~/bin 
```

I also use Eclipse Indigo Service Release 1 with PyDev installed. The Python interpreter is set up as follows:

```
Name: Python2.7 Location: /Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python
System PYTHONPATH:
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg
/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages 
```

Now. I want to install python_twitter-0.8.2-py2.7 package. I download the files. Run python setup.py install command

All goes well, I have an python_twitter-0.8.2-py2.7.egg in my site-packages, i have it in easy-install.pth but Eclipse is angry about unresolved imports when I do:

```
import twitter
import oauth2
import simplejson 
```

[Note: oauth2, simplejson are dependancies of twitter library]

What goes wrong ?

Another thing. When I create as shell window in Geek Tools and run python file with the following code:

```
import sys

for pth in sys.path:
    print pth 
```

I receive:

```
/Users/{Username}/Documents/Eclipse/{package name}/src
/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages
/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload
/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC 
```

but when I run the same file with the same command in the Terminal I receive:

```
/Users/Mihails/Documents/Eclipse/Console/src
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/httplib2-0.7.6-py2.7.egg
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/python_twitter-0.8.2-py2.7.egg
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/oauth2-1.5.211-py2.7.egg
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/simplejson-2.6.2-py2.7-macosx-10.6-intel.egg
/usr/local/lib/wxPython-ansi-2.8.12.1/lib/python2.7/site-packages
/usr/local/lib/wxPython-ansi-2.8.12.1/lib/python2.7/site-packages/wx-2.8-mac-ansi
/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages
/usr/local/lib/wxPython-ansi-2.8.12.1/lib/python2.7 
```

Bottom line.

When I try to run my project in Eclipse it would give an ImpoerError for the libraries that seem to be installed.

When I run my project through Geek Tools I don't even have site-packages in sys.path.

When I run my project from terminal everything works brilliant.

What is wrong? And how to make project to behave in absolutely similar way running from Eclipse, Terminal and Geek Tools?

I was like trying to find out for 2 days... Please anyone...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T19:19:18.740

尝试在 window > preferences > pydev > interpreter - python 中删除和添加您的解释器并检查那里的路径...

如果它没有抓住正确的路径，您可以尝试在那里手动设置它们。

# python - Python socket error in HTTP request

> ID：12661548
> 
> 赞同：0
> 
> 时间：2012-09-30T13:20:33.957
> 
> 标签：python, http, sockets

I'm trying to exchange HTTP messages between a client and a server. The request contains HTTP/1.0, when I place this in the beginning of the request, it works fine.

```
client_socket.send("HTTP/1.0 400 Bad Request") 
```

But When I place it at the end, it doesn't received on the other side and the program halts.

```
client_socket.send("GET 1.txt HTTP/1.0") 
```

When I add an extra space to the request between HTTP and /1.0

> client_socket.send("GET 1.txt HTTP/ 1.0")

It works fine and I receive the contents of the requested file.

I thinks the problem is with the forward slash, I want to omit it in order to make my client connect to another given server written in another language.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:48:30.830

HTTP 1.0 请求至少具有以下格式：

```
GET /1.txt HTTP/1.0<CRLF>
Host: the.server.com<CRLF>
<CRLF> 
```

也就是说，所有行结尾都应该是 CR+LF（即 ASCII 字符 13 和 10 十进制，或 Python 字符串中的“\015\012”），并且在第一行之后是任意数量的附加标题，然后是一个空线。虽然不是严格要求，但您应该始终提供 Host: 标头以帮助虚拟主机；没有这个，许多网站都无法运行。请注意，GET 动词之后的 URI 部分必须是绝对的，因此以斜杠开头。

# android - Refreshing simple list (android, adapter)

> ID：12661549
> 
> 赞同：0
> 
> 时间：2012-09-30T13:20:37.103
> 
> 标签：android, list, adapter

I'm not sure if i made good title (still new in android).

Question: If I make function:

```
 public void refresh_lists() {
    // wyswietlanie listy miesiecy
    ArrayAdapter<String> month_adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, miesiac_data);
    month_list_v.setAdapter(month_adapter);

    // wyswietlanie listy dni
    ArrayAdapter<String> daily_adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, dzien_data);
    daily_list_v.setAdapter(daily_adapter);
} 
```

(`miesiac_data` and `dzien_data` are `String` arrays) Then remake arrays somewhere else, like:

```
miesiac_data[] = new String[new_length];
dzien_data[] = new String[new_length]; 
```

Then add new records to arrays and finally, add `refresh_list` function as `onClick()` effect, does it create new lists everytime I push button, or just refreshes old ones?

# amazon-ec2 - 我如何在 MAC 中将文件上传到 EC2 amazon

> ID：12661553
> 
> 赞同：0
> 
> 时间：2012-09-30T13:21:46.590
> 
> 标签：amazon-ec2

我在亚马逊创建了一个 EC2 实例，但我不知道如何在其中上传文件，我使用的是 mac，所以请有人指导我，他们的文件对我没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T13:27:32.513

实例的操作系统是什么？

如果是 linux 机器，则可以使用 scp： `scp -i key.pem somefile.txt root@someip.compute-1.amazonaws.com:/tmp/`

对于 Windows，这可能会有所帮助： [http ://haacked.com/archive/2010/05/17/remote-desktop-file-copy.aspx](http://haacked.com/archive/2010/05/17/remote-desktop-file-copy.aspx)

# xaml - 在 XAML 中指定区域性信息

> ID：12661559
> 
> 赞同：0
> 
> 时间：2012-09-30T13:22:24.950
> 
> 标签：xaml, windows-runtime, culture, typeconverter

我正在为 WinRT 开发一个自定义控件。我有一个 CultureInfo 类型的属性。当我尝试在 XAML 中设置此属性时，它会显示以下错误。（但它会在智能感知中显示可能的值。）

> 无法将文本值“af-ZA”分配给“CultureInfo”类型的属性“Culture”

从 XAML 设置此属性的正确方法是什么？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:28:20.130

听起来未命名控件的 Culture 属性采用[CultureInfo](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx)对象而不是区域性名称。创建一个 CultureInfo 对象并将其分配给属性，可能在后面的代码中。

看来[CultureInfoConverter](http://msdn.microsoft.com/en-us/library/system.componentmodel.cultureinfoconverter.aspx)类在 WinRT 中可能不可用。它不在 WinRT [System.ComponentModel 命名空间](http://msdn.microsoft.com/en-us/library/windows/apps/hh454035.aspx)中。实际上，TypeConverter 类不存在（请参阅[System.ComponentModel.TypeConverter 的 WinRT 替换](https://stackoverflow.com/questions/12495937/winrt-replacement-for-system-componentmodel-typeconverter)），但[IValueConverter](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.data.ivalueconverter.aspx)确实存在，因此您可以自己编写。有关使用转换器的信息，请参阅[如何在 XAML 中注入转换](https://stackoverflow.com/questions/900825/how-to-inject-a-converter-in-xaml)器。

# vb.net - How can I merge and convert cells in vb.NET datagridview?

> ID：12661564
> 
> 赞同：1
> 
> 时间：2012-09-30T13:23:10.377
> 
> 标签：vb.net, datagridview, cells

I will start by explaining what I am trying to achieve.

I have a DataGridView in Visual Studio and when I click on a cell, that cell is converted to a button. Reason for this is I want the grid to look like a project planner. So I want people to select a number of cells (on the same line) and on MouseUp the cells must get converted to one button.

I managed to convert only 1 cell at a time to a button but when I select many cells it simply doesn't let me do it. (and I am not sure how to achieve this)

As you can see from the image below, when I click on individual cells they get converted to button but ultimately I want to select a number of cells and on MouseUp it should convert them to a button.

[http://postimage.org/image/o0kkgsnpp/](http://postimage.org/image/o0kkgsnpp/)

Reason I chose a button is because in future I will add drag and drop functionality so that I am able to drag that button to a new line for example. It doesn't mean I can't do this another way if it is more efficient so any recommendation will be welcome.

This is the code I am using to convert to button so please have a look at it and let me know how I can achieve this functionality:

> Blockquote

. . . AddHandler Grid.CellMouseUp, AddressOf Grid_MouseUp

```
End Sub

Private Sub Grid_MouseUp(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs)

    Dim ButtonColumn As New DataGridViewButtonCell

    For Each cell As DataGridViewCell In Grid.SelectedCells
        Grid(cell.ColumnIndex, cell.RowIndex) = ButtonColumn

    Next cell

End Sub 
```

> Blockquote

# php - 带有附加数据的 jQuery 文件上传

> ID：12661566
> 
> 赞同：4
> 
> 时间：2012-09-30T13:23:58.083
> 
> 标签：php, jquery, ajax, upload

我正在使用 jQuery 使用附加数据进行 AJAX 上传。Stackoverflow 代码我正在关注这个[如何异步上传文件？](https://stackoverflow.com/questions/166221/how-can-i-upload-files-asynchronously-with-jquery)我使用的代码如下：

```
var formData = new FormData($('form')[0]);
                $.ajax({
                    type: "POST",
                    url: "ajax/register.php",
                    dataType: "text",
                    data: {
                        name: $("#name").val(),
                        city: $("#city").val(),
                        image: formData
                    },
                    success: function(text) {
                        if(text == "data ok pic ok") { window.location = "reg3.php"; }
                        else { errorMessage(text); }
                    },
                    cache: false,
                    contentType: false,
                    processData: false
                });
            }); 
```

问题是，如果我删除与文件相关的代码，例如

```
var formData = new FormData($('form')[0]);
image: formData
cache: false,
contentType: false,
processData: false 
```

然后代码工作，我可以发送其他数据，比如“名称”和“城市”。当我放回与文件相关的代码时，它停止工作，控制台中没有错误并且服务器上的 PHP 脚本没有任何操作（就像它没有收到其他相关数据一样）

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T13:35:41.397

编写表单以发送文件时，您指定 POST 方法和`multipart/form-data`编码。HTML 代码中的每一个`<input>`都会被浏览器转换成`part`HTTP 请求正文中的一个，这样就可以同时发送多个文件和字符串。[这是 FormData 的文档](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/FormData/Using_FormData_Objects)（请参阅页面的最底部）。基本上你应该使用

```
var data = new FormData($('form')[0]);
data.append("name",  $("#name").val());
data.append("city",  $("#city").val());

// ...

$.post({
  "ajax/register.php",
  data: data,
  processData: false,  // tell jQuery not to process the data
  contentType: false   // tell jQuery not to set contentType
}); 
```

该`FormData`对象旨在直接分配给`data`键。您将附加字段附加到`FormData`对象：它不代表二进制内容。相反，它是一个[名称-值对数据结构](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/FormData)，其中键始终是字符串，而值可以是字符串或二进制对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:31:59.837

尝试添加：enctype：'multipart/form-data'

例如

```
 {
                type: "POST",
                url: "ajax/register.php",
                dataType: "text",
                enctype: 'multipart/form-data',
                data: {
                    name: $("#name").val(),
                    city: $("#city").val(),
                    image: formData
                }
            } 
```

# c# - 具有基类函数取决于其子类 C#

> ID：12661569
> 
> 赞同：0
> 
> 时间：2012-09-30T13:24:30.397
> 
> 标签：c#, inheritance, overriding

我有一个带有子类几乎总是会覆盖的方法的基类。但是，我不想完全替换基类的方法，而是希望将子类中派生的任何内容添加到基类中已有的内容中。

例如：

```
class BaseClass{

public string str()
 {
   return "Hello my name is" ;
 }
}

class ChildClass : BaseClass{

public override string str() 
 {
   return "Sam";
 }
} 
```

关键是如果我想通过创建 ChildClass 的实例来访问 str() 方法，字符串将打印为“你好，我的名字是 Sam”。

我一直在环顾四周，我发现这不应该发生，因为基类甚至不应该知道它正在被继承。那么，如果设计是错误的，我该怎么做呢？请记住，将有多个从 BaseClass 继承的子类。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-30T13:30:12.533

如果您总是想这样做，并且不想依赖派生类的实现者记住重写方法*并*调用基类，则可以使用模板模式：

```
public abstract class BaseClass
{
    public string str()
    {
        return "Hello my name is " + Name;
    }

    protected abstract string Name { get; }
} 
```

`BaseClass`现在，编译器将要求任何继承的非抽象类覆盖`Name`，并且该值可以被`BaseClass`.

```
public class ChildClass : BaseClass
{
    protected override string Name
    {
        get { return "Sam"; }
    }
} 
```

显然，这取决于基类是`abstract`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T13:26:43.273

如果要调用基类方法：

1.将基类中的方法声明为`virtual`，这样就可以`override`从子类中。

2.`base`用于从基类调用方法。

```
internal class BaseClass
{
    public virtual string str()
    {
        return "Hello my name is" ;
    }
}

class ChildClass : BaseClass
{
    public override string str(){
        return base.str() + "Sam";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:30:48.447

首先你必须制定你的方法，`virual`否则你不能覆盖它：

```
public class BaseClass
{
  public virual string Str()
  {
    return "Hello my name is ";
  }
} 
```

然后在您的子类中，您可以使用它`base`来访问基类中的方法。

```
public class ChildClass : BaseClass
{
  public override string Str()
  {
    return base.Str() + "Sam";
  }
} 
```

# c++ - 传递 shared_array 争论

> ID：12661570
> 
> 赞同：0
> 
> 时间：2012-09-30T13:24:34.513
> 
> 标签：c++, pointers, boost, shared-ptr

下面的代码在未注释时崩溃，并且 get() 中的 shared_array<> 参数似乎有问题。

print() 至少现在似乎没有崩溃......

传递 shared_array<> 参数的正确方法是什么？

```
#include <iostream>
#include <cstring>
#include <boost/shared_array.hpp>
using namespace std;
using namespace boost;

shared_array<wchar_t> get(const wchar_t* s) {
//shared_array<wchar_t> get(const shared_array<wchar_t>& s) {

    size_t size = wcslen(s);
    //size_t size = wcslen(s.get());

    shared_array<wchar_t> text(new wchar_t[size+1]);

    wcsncpy(text.get(), s, size+1);
    //wcsncpy(text.get(), s.get(), size+1);

    return text;
}

void print(shared_array<wchar_t> text) {
    wcout << text.get() << endl;
}

int wmain(int argc, wchar_t *argv[]) {
    //shared_array<wchar_t> param(argv[1]);

    shared_array<wchar_t> text = get(argv[1]);
    //shared_array<wchar_t> text = get(param);

    print(text);
    //print(text.get()); 
} 
```

编辑：谢谢。所以这里的关键是在使用 boost::shared_ptr/array 时我应该始终只使用 new/new[]。

主要功能固定：

```
int wmain(int argc, wchar_t *argv[]) {
    size_t szArg = wcslen(argv[1]);
    wchar_t* paramBuf = new wchar_t[szArg+1];
    wcscpy_s(paramBuf, szArg+1, argv[1]);
    shared_array<wchar_t> param(paramBuf);

    shared_array<wchar_t> text = get(param);

    print(text);
} 
```

实际上，起初我在堆栈中分配了 paramBuf，所以我找不到错误。

```
WRONG:    
int wmain(...) {
    wchar_t paramBuf[100];
    wcscpy_s(paramBuf, 100, argv[1]);
    ...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T13:35:09.620

问题在于：

```
shared_array<wchar_t> param(argv[1]); 
```

shared_array 需要使用指向使用 new[] 分配的数组的指针进行初始化，但 argv[1] 只是一个 c 字符串，因此当它超出范围（即变量参数）时，shared_array 的析构函数会调用 delete[] argv[1] 这是不允许的。

# php - 带有前缀和逗号分隔的 PHP 内爆数组

> ID：12661578
> 
> 赞同：4
> 
> 时间：2012-09-30T13:25:43.623
> 
> 标签：php

我正在尝试使用数组构建 sql 查询并添加前缀。

例如：

```
$columns = array('column1', 'column2');

"SELECT ". ltrim(implode(", media_", $columns), ', ') . " FROM media WHERE media_id = '{$id}'"; 
```

输出：

> 选择文件名，media_image FROM media WHERE media_id = '3'

我真正想要的：

> 选择 media_column1、media_column2 从媒体 WHERE media_id = '3'

问题：我怎样才能： 1\. 以“media_”为数组的所有项目添加前缀 2\. 用逗号分隔多个项目？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-30T13:31:40.840

为什么不把“media_”放在前面？：

```
$columns = array('column1', 'column2');
$selectColumns = 'media_' . implode(', media_', $columns);

"SELECT {$selectColumns} FROM media WHERE media_id = '{$id}'"; 
```

你也可以使用array_map：

```
$columns = array_map(function($column) {
    return 'media_' . $column;
}, $columns);

"SELECT " . implode(',', $columns) . " FROM media WHERE media_id = '{$id}'"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:30:53.377

[编辑]
另一种方式

```
$fields = array_reduce($columns, function ($result, $element) {
  $result = is_null($result) ? 'media_'.$element : $result.', media_'.$element;
  return $result;
});

"SELECT {$fields} FROM media WHERE media_id = '{$id}'"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T14:51:24.283

还有一种方式：

```
<?php

$id = 1;
$columns = array('column1', 'column2');
array_walk($columns,'add_prefix','media_');

function add_prefix(&$item, $key, $prefix) {
    $item = $prefix . $item;
}

$sql = "SELECT `" . implode('`,`', $columns) . "` FROM media WHERE media_id = '{$id}'";
echo "SQL:" . $sql . "\r\n"; 
```

选择最适合您的。

# android - achartengine 的图形问题：如果图形为空，则不会出现轴的标签

> ID：12661580
> 
> 赞同：1
> 
> 时间：2012-09-30T13:26:22.737
> 
> 标签：android, achartengine

嗨，伙计，我的应用程序中有一个图形。我使用 achartengine 库！当我的图表没有任何意义时，在我看来不会出现轴的标题和标签。我以这种方式配置我的渲染器：

```
private static XYMultipleSeriesRenderer createCustomRender(String titleX,String titleY){
        XYMultipleSeriesRenderer mRenderer = new XYMultipleSeriesRenderer();
         mRenderer.setApplyBackgroundColor(true);
            mRenderer.setBackgroundColor(Color.WHITE);
          mRenderer.setShowGridX(true);
           mRenderer.setShowGridY(true);
            mRenderer.setAxisTitleTextSize(16);
            mRenderer.setAxesColor(Color.RED);
            mRenderer.setGridColor(Color.BLACK);
            mRenderer.setLabelsColor(Color.WHITE);
            mRenderer.setMarginsColor(Color.DKGRAY);
            mRenderer.setXLabelsColor(Color.BLACK);
            mRenderer.setYLabelsColor(0,Color.BLACK);
            mRenderer.setChartTitleTextSize(20);
            mRenderer.setLabelsTextSize(15);
            mRenderer.setLegendTextSize(15);
            mRenderer.setChartTitle("Graphic droid");
            mRenderer.setXTitle(titleX);
            mRenderer.setYTitle(titleY);
            mRenderer.setMargins(new int[] { 20, 30, 15, 0 });
            mRenderer.setZoomButtonsVisible(true);
            mRenderer.setPointSize(5f);
            mRenderer.setShowLabels(true);
            mRenderer.setShowCustomTextGrid(true);
            mRenderer.setShowAxes(true);
        return mRenderer;

    } 
```

当我添加第一点时，在我的图表中出现标题和标签。但是如果图形为空以显示标签和标题图，我也想要

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T17:46:17.700

AChartEngine 根据默认添加到数据集的数据点创建可见区域。没有添加点时，没有可见区域，当只有一个点时，最小和最大可见范围相等。这仅在添加多个点时才会更改，现在它能够显示标签。

但是，您可以手动设置可见区域，您可能会得到可见标签：

```
renderer.setXAxisMin(minXValue);
renderer.setXAxisMax(maxXValue);
renderer.setYAxisMin(minYValue);
renderer.setYAxisMax(maxYValue); 
```

# ios - 大 iPhone 5 模拟器？

> ID：12661587
> 
> 赞同：16
> 
> 时间：2012-09-30T13:27:19.140
> 
> 标签：ios, ios-simulator

我在我的应用程序上弄乱了仪表板。4 英寸视网膜模拟器运行良好，看起来与 iPhone 5 完全一样：

![在此处输入图像描述](../Images/6e273d46e2ddf1e1c77e3dce86ce42bc.png)

然而，当我搞乱自动化时，4 英寸视网膜模拟器发生了变化，现在看起来很像一个很长的 iPad：

![在此处输入图像描述](../Images/74bb39e364ebf7feeccbbb04f43fb355.png)

（抱歉，图片太大了，但这是现在的实际尺寸）。

现在每当我想调出模拟器时，它仍然看起来像上面的这个。我确信有一个简单的解决方法，这就是我问的原因，因为老实说我不想重新安装 Xcode 4.5

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-30T13:30:52.240

当模拟器处于活动状态时，转到 Window > Size > 50%。

您还可以使用更改大小`⌘</kbd>+`1`, `⌘</kbd>+`2` or `⌘</kbd>+`3````

**编辑：**

当您使用视网膜 MBP 时，模拟器将利用这一点并进入视网膜模式，该模式与常规模拟器的大小相同（就像使用真实设备一样）。由于它的尺寸相同，它可以使用稍大的边框并看起来像实际设备，而不是使用类似 iPad 的薄边框。

在“正常分辨率”显示器上，只有非视网膜 iPhone 模拟器会使用 iPhone 边框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T14:37:26.927

发生这种变化的原因是您升级到 XCode 5 带来了 iOS7 模拟器并放弃了您正在使用的旧模拟器。

上面 DrummerB 的回答将控制模拟器的大小，但不会带回黑色边框，您的应用程序看起来也不一样。要查看您之前看到的内容，请执行以下操作：

1.  在 XCode 窗口的左上角，您将看到项目（或“目标”）名称和选定的模拟器。像“我的程序 > iPhone Retina（4 英寸）”。点击“iPhone 视网膜...”

2.  顶部会出现一个下拉列表，标题为“iOS 设备”。在底部，您将看到“更多模拟器...”。单击该选项。

3.  这会在“下载”页面上打开首选项对话框，您可以在其中在 XCode 中安装额外的组件。选择“iOS 6.1 Simulator”，它将开始下载。这大约是半场演出，所以需要一些时间。

4.  当它完成时，它会抛出一个对话框，要求您重新启动 XCode - 继续。

5.  现在回到 XCode，再次转到 iOS 设备选项，这次选择“iOS 6”选项之一。

你会找回你之前拥有的东西——黑色的 iPhone-4ish 设备。

（如果你按照上面 DrummerB 的建议，它现在可能看起来很小，所以在 iOS 模拟器中转到 Window->Scale 并选择 100%）

另请注意，您可能也想在某些时候使用 iOS7 模拟器，因为它会向您展示您的应用程序在许多用户的 iPhone 上的外观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-19T15:18:27.847

实际上我认为模拟器代码或界面构建器或某处可能存在错误......

我有两个故事板（iphone/ipad）和一个用于表格单元的笔尖。在我更改笔尖中的一些自动调整大小值之前，我的模拟显示看起来完全符合预期。然后突然间，模拟器开始显示 iPhone Retina 3.5 显示屏的巨型/ipad 视图。此外，当我在模拟器中重新定位硬件时，它实际上显示了整个设备环境。过了一会儿，我将情节提要中的一个表格从分组更改为普通表格，然后模拟器再次看起来很好。我刚刚再次更改了一些自动调整大小的值，它又回到了巨型 iPhone。

我想知道它是否与自动调整大小/自动布局有关。在我的笔尖上，我关闭了自动布局，但在我的故事板上它是打开的。

# activex - activeX 暴露方法

> ID：12661589
> 
> 赞同：0
> 
> 时间：2012-09-30T13:27:37.790
> 
> 标签：activex

我有一个在本地机器上运行良好的 MFC activeX，但是当我尝试在服务器上（在 LAN 上）使用时，我得到对象没有方法 AboutBox 的异常（例如）。这就是我调用该方法的方式： document.all('Ctrl1').AboutBox(); AboutBox 方法来自于activeX 的Ctrl 类。他有这个方法。我注意到 idl 文件中有一些奇怪的东西：方法 AboutBox 没有在控件中声明，而是在其他地方声明 - idl 文件在下面，请指教。谢谢，那鸿。

这是idl：

```
[ uuid(E0D6BB50-57F3-4C0D-9163-CCC0AEC87EF4), version(1.0),
  control ]
library nsip_ax_10Lib
{
        importlib(STDOLE_TLB);

    //  Primary dispatch interface for Cnsip_ax_10Ctrl
        [ 
            uuid(16C6DE45-B481-4795-AFBA-BE64E1CEF9AA)  
       ]
        dispinterface _Dnsip_ax_10
       {
        properties:
            methods:

                [id(DISPID_ABOUTBOX)] void AboutBox();
                [id(1)] BYTE try2(void);
         };

        //  Event dispatch interface for Cnsip_ax_10Ctrl

       [ 
        uuid(871F4F0A-3333-4FDF-A53F-CFB581D15596)  
       ]
        dispinterface _Dnsip_ax_10Events
       {
          properties:
                //  Event interface has no properties

            methods:
     };

        //  Class information for Cnsip_ax_10Ctrl
       [
           uuid(E228C560-FA68-48E6-850F-B1167515C920)
       ]
     coclass nsip_ax_10
            {
            [default] dispinterface _Dnsip_ax_10;
            [default, source] dispinterface _Dnsip_ax_10Events;
            };

           }; 
```

* * *

加载 activeX 的 HTML 代码：

```
 <OBJECT CLASSID="CLSID:871F4F0A-3333-4FDF-A53F-CFB581D15596"
        CODEBASE="nsip.CAB#version=1,0,0,1"
        ID="Ctrl1"
        name="Ctrl1"></OBJECT> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-17T07:52:47.720

1.  您在 Object 标签中使用的类 ID 不正确：

> **CLASSID="CLSID:871F4F0A-3333-4FDF-A53F-CFB581D15596** "

ActiveX 控件类 ID 是 IDL 文件中的最后一个，即

```
CLASSID="CLSID:E228C560-FA68-48E6-850F-B1167515C920" 
```

2.  我从代码中想到的是，您的应用程序没有指向对象标记中 CAB 文件的完整服务器路径。

    ```
    CODEBASE="nsip.CAB" 
    ```

    给出 ActiveX cab 的完整路径。

# android - TextView 数组分成几行

> ID：12661594
> 
> 赞同：0
> 
> 时间：2012-09-30T13:28:22.940
> 
> 标签：android, arrays, textview

我已将 TextViews 动态添加到 LinearLayout 中。问题是，如果 TextViews 的文本比布局宽度长，它们会显示错误。有什么方法可以使 TextViews 匹配布局宽度并从新行开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:18:05.257

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

</LinearLayout> 
```

使用 LinearLayout.LayoutParams

```
params = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);
txtView.setLayoutParams(params);
layout.addView(txtView); 
```

# ssh - 在 ssh/rsync 到远程目标后，目标计算机如何在传输完成后立即知道新文件？

> ID：12661610
> 
> 赞同：2
> 
> 时间：2012-09-30T13:30:51.863
> 
> 标签：ssh, rsync, scp

我正在对远程服务器执行 ssh/rsync。我希望文件随后由服务器传输到另一台远程机器（我无法直接传输）。为此，服务器应该知道它在传输完成后立即收到了一个新文件。

那么服务器如何才能最早知道新文件呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:42:33.297

你可以使用例如。Linux 下的 inotify 并在目录中创建新文件时通知 shell 脚本（查看 inotify-tools）。但是，您也可以定期检查文件的存在，例如。每秒，找出它的创建时间（据我所知，rsync 在将文件重命名为其最终名称之前使用临时文件名进行传输）。

# nhibernate - 可以休眠检查唯一约束，而不是主键

> ID：12661612
> 
> 赞同：1
> 
> 时间：2012-09-30T13:31:05.513
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我有一个简单的类，它有一个`Name`成员，用于唯一标识一个实例。此类在 ManyToMany-mapping 中被引用，它将使用`Name`（因为它是主键）来创建映射表。所涉及的字符串类型使得这非常慢（长度> 128个字符，通常只在最后几个不同）。为了加快速度，我想为连接创建一个`auto_increment`列（我正在使用 MySQL），同时仍然能够让 nhibernate 使用`Name`-column 对我的对象的唯一性进行排序。

这是它的外观示例。实际上，对象要大得多。

```
class MyObject{
  public String Name;
  public String Value;
}
//Mapping
Id(x => x.Name)
  .Length(255)
  .Unique();
Map(x => x.Value); 
```

这按预期工作。如果我`MyObject`在表中添加一个新的，nhibernate 将首先进行选择以查看`Name`表中是否已经存在相同的记录。

我有一个`ObjectHolder`有一组`MyObject`

```
class ObjectHolder{
  public UInt64 Id;
  public ICollection<MyObject> MyObjects;
}
//Mapping
Id(x => x.Id)
  .GeneratedBy.Native();
HasManyToMany(x => x.MyObjects)
  .AsSet()
  .Cascade.SaveUpdate(); 
```

`ObjectHolder.Id`这将使用and创建一个映射`MyObject.Name`，这很慢。我希望`MyObject`有一个自动生成的 Id 列，仅用于映射表，但不用于 nhibernate 对主键所做的 select-to-see-if-it-exists-checking。

我已将映射更改为

```
class MyObject{
  public UInt64 Id;
  public String Name;
  public String Value;
}
//Mapping
Id(x => x.Id)
  .GeneratedBy.Native();
Map(x => x.Name)
  .Length(255)
  .Unique();
Map(x => x.Value); 
```

这将创建一个 auto_increment 列并将其用于映射表，但是它现在将不再正确检查是否`Name`存在相同的记录，这会导致重复条目异常。

我可以告诉 nhibernate 检查`Name`列而不是 id，或者注释`Id`-column 以便它仅用作外键，而不是别的吗？我是否必须修改 manyToMany 映射？

编辑：如果我必须使用复合 id 似乎更糟。所有 id 属性都保存了两次，一次在对象本身中，一次在映射中，这增加了巨大的时间和存储空间开销。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T00:58:05.157

您以错误的方式看待这个问题，NH 不应该检查它是否已经为您存在。你应该知道它是否已经存在。

检查名称是否唯一应该是您的验证和业务逻辑的一部分。因此，您应该在尝试保存之前检查该名称是否被占用。

如果您自己访问数据库，则可以处理约束冲突。然而，NHibernate 不支持这一点，因为它会使批处理复杂化。即，当事务被刷新时，批次将被保存，这将是引发错误的地方，而不是你持久化实体的地方。所以 NH 唯一明智的做法就是回滚整个事务并抛出错误。

本质上，数据库约束只是最终的故障保护，以防止无效数据，而不是您依赖的东西来检查您的业务规则。

# javascript - 将 iFrame CSS 设置为显示：加载期间无

> ID：12661614
> 
> 赞同：13
> 
> 时间：2012-09-30T13:31:33.493
> 
> 标签：javascript, jquery, html, css, iframe

我有这个：

```
<div class="upload_slide">
    <iframe class="upload_iframe" style="visibility:hidden;"></iframe>
</div> 
```

如果我随后将一些文件发布到 iFrame 并设置`.upload_slide`为`display:none;`，而它正在加载，这会影响 iFrame 的加载或检测它何时完成加载吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-30T13:54:14.827

不，iFrame 的加载和加载检测不应因将显示设置为无而受到影响。

CSS 只是为了样式，它没有影响 DOM 的能力。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-30T14:23:39.423

应该没有问题，但如果有的话，一个很好的技巧是将元素移出屏幕而不是隐藏它。您可以创建一个类

```
.offscreen{
    position: absolute;
    left: -5000px;
} 
```

您可以根据需要添加和删除。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-01-21T15:29:59.323

Firefox 目前确实存在 display:none 问题：

> 一些浏览器假定当“display:none”应用于替换元素（如 Flash 或 iframe）时，不再需要该元素的视觉信息。因此，如果元素稍后由 CSS 显示，浏览器实际上将重新创建可视数据表单。
> 
> 我想将 iframe 默认设置为“display:none;” 使浏览器跳过 HTML 的呈现，因此标签没有任何尺寸。我会将可见性设置为“隐藏”或将其放置在页面之外，而不是使用“显示：无；”。
> 
> 史蒂文·帕利戈

[关联](https://stackoverflow.com/a/2786429)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-30T14:29:43.097

**没有。。一点都没有。。**

CSS -`display:none`或者`visibility:hidden`只是说浏览器不向用户显示 iframe 内容。

但是该功能可以正常工作，没有任何问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-30T13:37:19.233

据我所知，它应该可以正常工作。一段时间以来，我一直在使用隐藏的 iframe 加载内容，但没有遇到任何问题。

也就是说，我知道某些浏览器会尝试通过不加载隐藏的图像来提高效率，因此某些浏览器（尤其是移动浏览器）可能会对 iframe 执行相同的操作。

# objective-c - ARC 不释放分配给私有变量的内存

> ID：12661616
> 
> 赞同：0
> 
> 时间：2012-09-30T13:31:53.827
> 
> 标签：objective-c, ios5, memory-leaks, automatic-ref-counting, private-members

在我的一个视图控制器中，我定义了一个私有变量，如下所示，

```
@implementation CNLibraryViewController {
 CNMaterialsViewController *_materials;
} 
```

每次重新加载视图时，我都会重新分配内存并初始化此变量，如下所示，

```
_materials = [[CNMaterialsViewController alloc] init];
_materials.gridViewActionDelegate = self;
_materials.itemRetrieving = self.dataModel.itemRetrieval;
[_materials setSortDescriptors:_sortDescriptors];
[_materials loadItems:[results allObjects]]; 
```

在`CNMaterialsViewController.m`我定义了一些私有变量如下，

```
@implementation CNMaterialsViewController {
    CNItemViewController *_itemViewController;
    id<CNItemViewControllerViewSetupDelegate> _itemDescriptionTileSetup;
} 
```

`CNMaterialsViewController`所以问题是，这两个变量的保留计数在每次初始化时都会增加一个。

找不到任何理由。谁能帮我找出问题所在。

作为解决方案，我`nil`在 initialize 之前分配给这些变量`CNMaterialsViewController`。但我不认为这是一个好的解决方案。

所以，请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:58:57.950

您必须向编译器提示您希望 ARC 如何处理 ivars。如果您不限定变量，因为`__weak`编译器会假定您需要一个强引用，并且只要它的父级仍然存在，就会保留它。

添加到@mariusLAN 所说的内容，您不再需要声明 ivars - 您可以简单地声明一个属性并在那里说明您的意图。IE

```
@interface CNLibraryViewController
@property (weak, nonatomic) CNMaterialsViewController *_materials;
@end 
```

# c++ - 编译一个简单的 MFC 项目

> ID：12661618
> 
> 赞同：0
> 
> 时间：2012-09-30T13:32:04.803
> 
> 标签：c++, mfc, mingw32

我需要包含 MFC 库的 DLL，因此我可以使用 MinWG 编译 MFC 项目。

我无法下载 Visual C++，因为我有 50mb 的下载限制。

根据维基百科，最新的 MFC 版本是 MFC 10.0.40219.1，它包含在一个名为`mfc100.dll`.

我在哪里可以下载这个文件，或者一般的基本 MFC 框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:46:42.900

你可以在 Visual C++ 2010 Redistributable Package 中找到它（从微软网站下载大约 5mb）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T15:29:35.970

MFC*.dll 的分发需要 Visual Studio (Professional) 许可证。因此，您不会发现它是可再分发的。

# automapper - 使用xml在运行时动态构建地图？

> ID：12661621
> 
> 赞同：0
> 
> 时间：2012-09-30T13:32:40.240
> 
> 标签：automapper, automapper-2

我有一个 XML 文件，它定义了一个对象的映射——它基本上告诉我映射：

```
A -> _a
B -> _b
C -> SomeFunction(_d) 
```

我想在运行时解析它（足够简单），然后以某种方式为此初始化一个自动映射器映射。我已经尝试了几次，但我不知道如何做到这一点.. ForMember 是否有一些过载我迷路了？其他方式来做到这一点？

# android - 将 sms:?body=xyz 传递给 android webview 中的默认浏览器

> ID：12661625
> 
> 赞同：0
> 
> 时间：2012-09-30T13:33:16.760
> 
> 标签：android, android-webview

我正在使用 Webview 来显示 html 页面页面有类似的链接

`<a href="sms:body=xym">Forward</a>`

哪个在 Opera 和默认浏览器中工作正常，但在使用 webview 的应用程序中不工作

我尝试下面的代码但不工作

```
 public boolean shouldOverrideUrlLoading(WebView myWebView, String url) {
        if (url != null && url.startsWith("sms:?")) {
            myWebView.getContext().startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(url)));
            return true;
        } else {
            return false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T14:30:58.143

您需要创建一个具有适当类型的单独 SMS Intent 并向应用程序授予 SMS 写入权限。

```
Intent smsIntent = new Intent(Intent.ACTION_VIEW);
smsIntent.setType("vnd.android-dir/mms-sms");
smsIntent.putExtra("address", "Phone number scrapped from url");
smsIntent.putExtra("sms_body","Body of Message scrapped from url");
startActivity(smsIntent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T15:52:24.107

您的代码中有错误。

它应该是

```
if (url != null && url.startsWith("sms")) { 
```

另外：如果您对正在显示的网页拥有权力，则可能需要包含 phonegap 库（如果您还没有的话）。那是为了处理这些事情。

# php - Joomla 的模板覆盖和安全性

> ID：12661626
> 
> 赞同：0
> 
> 时间：2012-09-30T13:33:29.337
> 
> 标签：php, security, joomla, joomla2.5

因此，每当您需要对组件、模块等进行更改时，您都应该使用覆盖，这样它就不会在未来的核心更新中被更改。

当您更新核心时，这些覆盖是否会成为安全风险，因为基本代码现在更旧？我从未见过任何提及使用新更新来更新覆盖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:09:20.857

不，它们不是安全风险。所有覆盖都是从另一个位置调用 HTML 或 CSS。覆盖仅用于样式设置，不用于 PHP 或 Javascript 函数。

Quote:*我从未见过任何提及用新的更新来更新覆盖。*

那是因为它们不应该得到更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T23:18:37.790

我要说的是注意更新，尤其是指定的安全更新，它们总是在版本中单独标记（并且有自己的提要等），如果你看到你已经覆盖的布局得到修复，然后检查你的。布局安全性可能涉及的一件事是错过了输出过滤，因此如果您在布局中小心翼翼，那么您会没事的。如果您使用 Joomla，订阅安全源是必不可少的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T15:08:10.840

覆盖被认为会改变扩展的显示方式，但是依赖它并认为没有其他代码可能存在安全风险（我在不同的扩展中看到了一些“不良做法”），您应该检查每次发布时的更新。

# ruby-on-rails-3 - 使用 Rails 3 和 sqlite3 在acts_as_taggable_on gem 中缺少列错误

> ID：12661633
> 
> 赞同：2
> 
> 时间：2012-09-30T13:34:49.180
> 
> 标签：ruby-on-rails-3, sqlite, acts-as-taggable-on

我想我在acts-as-taggable-on 中发现了一个奇怪的错误。其他人可以重现此错误吗？从一个裸 Rails 3 项目开始：

```
~ [13:57:32]: cd Development/
~/Development [13:59:44]: rvm use 1.9.3
Using /Users/andywhite/.rvm/gems/ruby-1.9.3-p194
Running /Users/andywhite/.rvm/hooks/after_use
~/Development [13:59:54]: rails -v
Rails 3.2.8
~/Development [14:00:01]: rails new foo --skip-bundle
      create  
      create  README.rdoc
      create  Rakefile
      create  config.ru
      create  .gitignore
      create  Gemfile
      create  app
      (snip)
      create  vendor/assets/javascripts/.gitkeep
      create  vendor/assets/stylesheets
      create  vendor/assets/stylesheets/.gitkeep
      create  vendor/plugins
      create  vendor/plugins/.gitkeep
~/Development [14:00:21]: cd foo
~/Development/foo [14:01:26]: rvm --rvmrc --create 1.9.3@foo
~/Development/foo [14:02:38]: cd ..
~/Development [14:02:40]: cd -
/Users/andywhite/Development/foo
====================================================================================
= NOTICE                                                                           =
====================================================================================
= RVM has encountered a new or modified .rvmrc file in the current directory       =
= This is a shell script and therefore may contain any shell commands.             =
=                                                                                  =
= Examine the contents of this file carefully to be sure the contents are          =
= safe before trusting it! ( Choose v[iew] below to view the contents )            =
====================================================================================
Do you wish to trust this .rvmrc file? (/Users/andywhite/Development/foo/.rvmrc)
y[es], n[o], v[iew], c[ancel]> yes
~/Development/foo [14:02:44]: vi Gemfile 
~/Development/foo [14:08:18]: cat Gemfile 
source 'http://rubygems.org'

gem 'rails', '3.2.8'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger'
gem 'acts-as-taggable-on'
~/Development/foo [14:08:26]: bundle
Fetching gem metadata from http://rubygems.org/.........
Using rake (0.9.2.2) 
Installing i18n (0.6.1) 
Installing multi_json (1.3.6) 
Installing activesupport (3.2.8) 
Installing builder (3.0.3) 
Installing activemodel (3.2.8) 
Installing erubis (2.7.0) 
Installing journey (1.0.4) 
Installing rack (1.4.1) 
Installing rack-cache (1.2) 
Installing rack-test (0.6.2) 
Installing hike (1.2.1) 
Installing tilt (1.3.3) 
Installing sprockets (2.1.3) 
Installing actionpack (3.2.8) 
Installing mime-types (1.19) 
Installing polyglot (0.3.3) 
Installing treetop (1.4.10) 
Installing mail (2.4.4) 
Installing actionmailer (3.2.8) 
Installing arel (3.0.2) 
Installing tzinfo (0.3.33) 
Installing activerecord (3.2.8) 
Installing activeresource (3.2.8) 
Using bundler (1.2.0) 
Installing rack-ssl (1.3.2) 
Installing json (1.7.5) with native extensions 
Installing rdoc (3.12) 
Installing thor (0.16.0) 
Installing railties (3.2.8) 
Installing rails (3.2.8) 
Installing acts-as-taggable-on (2.3.3) 
Installing coffee-script-source (1.3.3) 
Installing execjs (1.4.0) 
Installing coffee-script (2.2.0) 
Installing coffee-rails (3.2.2) 
Installing jquery-rails (2.1.3) 
Installing sass (3.2.1) 
Installing sass-rails (3.2.5) 
Installing sqlite3 (1.3.6) with native extensions 
Installing uglifier (1.3.0) 
Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.
Post-install message from rdoc:
Depending on your version of ruby, you may need to install ruby rdoc/ri data:

<= 1.8.6 : unsupported
 = 1.8.7 : gem install rdoc-data; rdoc-data --install
 = 1.9.1 : gem install rdoc-data; rdoc-data --install
>= 1.9.2 : nothing to do! Yay!

~/Development/foo [14:08:58]: rails g model Post body
      invoke  active_record
      create    db/migrate/20120930130941_create_posts.rb
      create    app/models/post.rb
      invoke    test_unit
      create      test/unit/post_test.rb
      create      test/fixtures/posts.yml
~/Development/foo [14:09:41]: rails g  acts_as_taggable_on:migration
      create  db/migrate/20120930131032_acts_as_taggable_on_migration.rb
~/Development/foo [14:10:31]: rake db:migrate
==  CreatePosts: migrating ====================================================
-- create_table(:posts)
   -> 0.0014s
==  CreatePosts: migrated (0.0015s) ===========================================

==  ActsAsTaggableOnMigration: migrating ======================================
-- create_table(:tags)
   -> 0.0013s
-- create_table(:taggings)
   -> 0.0012s
-- add_index(:taggings, :tag_id)
   -> 0.0005s
-- add_index(:taggings, [:taggable_id, :taggable_type, :context])
   -> 0.0007s
==  ActsAsTaggableOnMigration: migrated (0.0043s) =============================

~/Development/foo [14:10:41]: vi app/models/post.rb 
~/Development/foo [14:11:32]: cat app/models/post.rb 
class Post < ActiveRecord::Base
  attr_accessible :body, :tag_list
  acts_as_taggable
end
~/Development/foo [14:11:42]: rails c
Loading development environment (Rails 3.2.8)
1.9.3-p194 :001 > p = Post.create :body => 'My hat blew off'
   (0.1ms)  begin transaction
  SQL (217.4ms)  INSERT INTO "posts" ("body", "created_at", "updated_at") VALUES (?, ?, ?)  [["body", "My hat blew off"], ["created_at", Sun, 30 Sep 2012 13:12:28 UTC +00:00], ["updated_at", Sun, 30 Sep 2012 13:12:28 UTC +00:00]]
   (2.8ms)  commit transaction
 => #<Post id: 1, body: "My hat blew off", created_at: "2012-09-30 13:12:28", updated_at: "2012-09-30 13:12:28"> 
1.9.3-p194 :002 > p.tag_list = "news, boring, hats"
  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 1 AND "taggings"."taggable_type" = 'Post' AND (taggings.context = 'tags' AND taggings.tagger_id IS NULL)
 => "news, boring, hats" 
1.9.3-p194 :003 > p.save
   (0.1ms)  begin transaction
   (0.6ms)  UPDATE "posts" SET "updated_at" = '2012-09-30 13:13:28.210803' WHERE "posts"."id" = 1
  ActsAsTaggableOn::Tag Load (0.1ms)  SELECT "tags".* FROM "tags" WHERE (lower(name) = 'news' OR lower(name) = 'boring' OR lower(name) = 'hats')
  ActsAsTaggableOn::Tag Exists (0.1ms)  SELECT 1 AS one FROM "tags" WHERE "tags"."name" = 'news' LIMIT 1
  SQL (0.2ms)  INSERT INTO "tags" ("name") VALUES (?)  [["name", "news"]]
  ActsAsTaggableOn::Tag Exists (0.1ms)  SELECT 1 AS one FROM "tags" WHERE "tags"."name" = 'boring' LIMIT 1
  SQL (0.0ms)  INSERT INTO "tags" ("name") VALUES (?)  [["name", "boring"]]
  ActsAsTaggableOn::Tag Exists (0.1ms)  SELECT 1 AS one FROM "tags" WHERE "tags"."name" = 'hats' LIMIT 1
  SQL (0.0ms)  INSERT INTO "tags" ("name") VALUES (?)  [["name", "hats"]]
  ActsAsTaggableOn::Tag Load (0.1ms)  SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 1 AND "taggings"."taggable_type" = 'Post' AND (taggings.context = 'tags' AND taggings.tagger_id IS NULL)
  ActsAsTaggableOn::Tagging Exists (0.2ms)  SELECT 1 AS one FROM "taggings" WHERE ("taggings"."tag_id" = 1 AND "taggings"."taggable_type" = 'Post' AND "taggings"."taggable_id" = 1 AND "taggings"."context" = 'tags' AND "taggings"."tagger_id" IS NULL AND "taggings"."tagger_type" IS NULL) LIMIT 1
  SQL (0.4ms)  INSERT INTO "taggings" ("context", "created_at", "tag_id", "taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES (?, ?, ?, ?, ?, ?, ?)  [["context", "tags"], ["created_at", Sun, 30 Sep 2012 13:13:28 UTC +00:00], ["tag_id", 1], ["taggable_id", 1], ["taggable_type", "Post"], ["tagger_id", nil], ["tagger_type", nil]]
  ActsAsTaggableOn::Tagging Exists (0.1ms)  SELECT 1 AS one FROM "taggings" WHERE ("taggings"."tag_id" = 2 AND "taggings"."taggable_type" = 'Post' AND "taggings"."taggable_id" = 1 AND "taggings"."context" = 'tags' AND "taggings"."tagger_id" IS NULL AND "taggings"."tagger_type" IS NULL) LIMIT 1
  SQL (0.1ms)  INSERT INTO "taggings" ("context", "created_at", "tag_id", "taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES (?, ?, ?, ?, ?, ?, ?)  [["context", "tags"], ["created_at", Sun, 30 Sep 2012 13:13:28 UTC +00:00], ["tag_id", 2], ["taggable_id", 1], ["taggable_type", "Post"], ["tagger_id", nil], ["tagger_type", nil]]
  ActsAsTaggableOn::Tagging Exists (0.1ms)  SELECT 1 AS one FROM "taggings" WHERE ("taggings"."tag_id" = 3 AND "taggings"."taggable_type" = 'Post' AND "taggings"."taggable_id" = 1 AND "taggings"."context" = 'tags' AND "taggings"."tagger_id" IS NULL AND "taggings"."tagger_type" IS NULL) LIMIT 1
  SQL (0.1ms)  INSERT INTO "taggings" ("context", "created_at", "tag_id", "taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES (?, ?, ?, ?, ?, ?, ?)  [["context", "tags"], ["created_at", Sun, 30 Sep 2012 13:13:28 UTC +00:00], ["tag_id", 3], ["taggable_id", 1], ["taggable_type", "Post"], ["tagger_id", nil], ["tagger_type", nil]]
   (1.9ms)  commit transaction
 => true 
1.9.3-p194 :004 > p.tag_list
 => ["news", "boring", "hats"] 
1.9.3-p194 :005 > Post.tag_counts
  ActsAsTaggableOn::Tag Load (0.4ms)  SELECT tags.*, taggings.tags_count AS count FROM "tags" JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM "taggings" INNER JOIN posts ON posts.id = taggings.taggable_id WHERE (taggings.taggable_type = 'Post' AND taggings.context = 'tags') AND (taggings.taggable_id IN(SELECT posts.id FROM "posts" )) GROUP BY taggings.tag_id HAVING COUNT(taggings.tag_id) > 0) AS taggings ON taggings.tag_id = tags.id
ActiveRecord::StatementInvalid: SQLite3::SQLException: no such column: taggings.tag_id: SELECT tags.*, taggings.tags_count AS count FROM "tags" JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM "taggings" INNER JOIN posts ON posts.id = taggings.taggable_id WHERE (taggings.taggable_type = 'Post' AND taggings.context = 'tags') AND (taggings.taggable_id IN(SELECT posts.id FROM "posts" )) GROUP BY taggings.tag_id HAVING COUNT(taggings.tag_id) > 0) AS taggings ON taggings.tag_id = tags.id
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/sqlite3-1.3.6/lib/sqlite3/database.rb:91:in `initialize'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/sqlite3-1.3.6/lib/sqlite3/database.rb:91:in `new'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/sqlite3-1.3.6/lib/sqlite3/database.rb:91:in `prepare'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/connection_adapters/sqlite_adapter.rb:246:in `block in exec_query'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/connection_adapters/sqlite_adapter.rb:242:in `exec_query'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/connection_adapters/sqlite_adapter.rb:467:in `select'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/database_statements.rb:18:in `select_all'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/query_cache.rb:63:in `select_all'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/querying.rb:38:in `block in find_by_sql'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/explain.rb:40:in `logging_query_plan'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/querying.rb:37:in `find_by_sql'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/relation.rb:171:in `exec_queries'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/relation.rb:160:in `block in to_a'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/explain.rb:33:in `logging_query_plan'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/relation.rb:159:in `to_a'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/activerecord-3.2.8/lib/active_record/relation.rb:498:in `inspect'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/railties-3.2.8/lib/rails/commands/console.rb:47:in `start'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/railties-3.2.8/lib/rails/commands/console.rb:8:in `start'
  from /Users/andywhite/.rvm/gems/ruby-1.9.3-p194@foo/gems/railties-3.2.8/lib/rails/commands.rb:41:in `<top (required)>'
  from script/rails:6:in `require'
  from script/rails:6:in `<main>'1.9.3-p194 :006 > 
1.9.3-p194 :007 >   exit 
```

因此，我们似乎缺少 *taggings.tag_id* 列。因此，让我们进入 sqlite3 进行调查：

```
~/Development/foo [14:14:39]: sqlite3 db/development.sqlite3 
SQLite version 3.7.14 2012-09-03 15:42:36
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> .headers on
sqlite> select * from taggings;
id|tag_id|taggable_id|taggable_type|tagger_id|tagger_type|context|created_at
1|1|1|Post|||tags|2012-09-30 13:13:28.357091
2|2|1|Post|||tags|2012-09-30 13:13:28.360285
3|3|1|Post|||tags|2012-09-30 13:13:28.362351
sqlite> .schema taggings
CREATE TABLE "taggings" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "tag_id" integer, "taggable_id" integer, "taggable_type" varchar(255), "tagger_id" integer, "tagger_type" varchar(255), "context" varchar(128), "created_at" datetime);
CREATE INDEX "index_taggings_on_tag_id" ON "taggings" ("tag_id");
CREATE INDEX "index_taggings_on_taggable_id_and_taggable_type_and_context" ON "taggings" ("taggable_id", "taggable_type", "context");
sqlite> 
```

嗯。所以专栏*在*那里！？让我们剪切并粘贴有问题的 SQL，看看我们得到相同的缺失列错误：

```
sqlite> SELECT tags.*, taggings.tags_count AS count FROM "tags" JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM "taggings" INNER JOIN posts ON posts.id = taggings.taggable_id WHERE (taggings.taggable_type = 'Post' AND taggings.context = 'tags') AND (taggings.taggable_id IN(SELECT posts.id FROM "posts" )) GROUP BY taggings.tag_id HAVING COUNT(taggings.tag_id) > 0) AS taggings ON taggings.tag_id = tags.id;
id|name|count
1|news|1
2|boring|1
3|hats|1
sqlite> .exit
~/Development/foo [14:17:25]: 
```

什么……？有谁知道这里发生了什么。我错过了一些非常明显的事情吗？

更新（当天晚些时候）：我找到了一个解决方法。覆盖 Posts 中的 *tag_counts* 类方法：

```
def self.tag_counts
  ActsAsTaggableOn::Tag.select("tags.*, count(taggings.tag_id) as count").
    joins(:taggings).group("taggings.tag_id")
end 
```

感谢 Ryan Bates 和他出色的[Railscasts 插曲](http://railscasts.com/episodes/382-tagging)作为此方法的起点。仍然有兴趣看看其他人是否可以重现该错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T05:54:33.693

我也有同样的错误。在我的 ubuntu 开发环境中运行良好，但在 centos 的生产环境中，我也收到了缺少 taggings.tag_id 错误。

相同版本的 ruby​​、rails 等。

# c# - 重写 ASMX Web 服务的 URL

> ID：12661634
> 
> 赞同：1
> 
> 时间：2012-09-30T13:34:59.420
> 
> 标签：c#, url-rewriting, asmx, global-asax

我正在尝试将来自 ajax 请求的传入 URL 映射到 Global.asax 中的 Web 服务方法。Web 服务位于此路径`/ajax/BookWebService.asmx`中，它有 2 个方法`GetListOfBook`和`GetListOfAuthor`.

我想在 Script 标签中使用 url:`/ajax/book/list`而不是 url: 。`/ajax/BookWebService.asmx/GetListOfBook`

这是我的脚本和标记：

```
<script type="text/javascript">

  $(function () {
      $("#btnCall").click(function () {

          $.ajax({type: "POST",
              url: "/ajax/book/list",
              data: "{}",
               contentType: "application/json; charset=utf-8",
               dataType: "json",
              success: function (response) {
                  var list = response.d;
                      $('#callResult').html(list);
              },
              error: function (msg) {
                  alert("Oops, something went wrong");
              }
          });

      });
  });

</script>

<div>
  <div id="callResult"></div>
  <input id="btnCall" type="button" value="Call Ajax" />
</div> 
```

这是 Global.asax ：

```
void Application_BeginRequest(object sender, EventArgs e)
{
    var currentRequest = HttpContext.Current.Request.Url.AbsolutePath;

    if (currentRequest.Contains("ajax/book/list")) {
        HttpContext.Current.RewritePath("/ajax/BookWebService.asmx/GetListOfBook");
    }

} 
```

当我检查 FireBug 控制台时，这就是我得到的：

> “NetworkError：500 内部服务器错误 - localhost:13750/ajax/book/list”

如果我将*url:`/ajax/book/list`*更改为*url:`/ajax/BookWebService.asmx/GetListOfBook`*它会按预期工作。

我正在使用 VS 2010 和 .NET 4。

我如何做 ajax 调用`/ajax/book/list`而不是`/ajax/BookWebService.asmx/GetListOfBook`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T00:54:10.780

如果您可以将 ajax 调用更改为类型：“GET”，请尝试以下更改：

阿贾克斯调用：

```
 $(function () {
        $("#btnCall").click(function () {

            $.ajax({ type: "GET",  //Change 1
                url: "/ajax/book/list",
                data: "{}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    var list = response.d;
                    $('#callResult').html(list);
                },
                error: function (msg) {
                    alert("Oops, something went wrong");
                }
            });

        });
    });

</script> 
```

全球.asax：

```
 void Application_BeginRequest(object sender, EventArgs e)
    {
        var currentRequest = HttpContext.Current.Request.Url.AbsolutePath;
        //Change 2
        if (currentRequest.Contains("ajax/book/")) // maybe you can use a generic path to all rewrites...
        {
            IgnoreWebServiceCall(HttpContext.Current);
            return;
        }
    }
    //Change 3
    private void IgnoreWebServiceCall(HttpContext context)
    {
        string svcPath = "/ajax/BookWebService.asmx";

        var currentRequest = HttpContext.Current.Request.Url.AbsolutePath;

        //You can use a switch or....
        if (currentRequest.Contains("ajax/book/list"))
        {
            svcPath += "/list";
        }

        int dotasmx = svcPath.IndexOf(".asmx");
        string path = svcPath.Substring(0, dotasmx + 5);
        string pathInfo = svcPath.Substring(dotasmx + 5);
        context.RewritePath(path, pathInfo, context.Request.Url.Query);
    } 
```

BookWebService.asmx：

```
 [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    [ScriptService] ///******************* Important
    public class BookWebService : System.Web.Services.WebService
    {

        [WebMethod]

        [ScriptMethod(ResponseFormat = ResponseFormat.Json, UseHttpGet = true)] ///******************* Important
        public string list()
        {
          return "Hi";

        }

     } 
```

为我工作:)

# php - MVC 设计约定：CRUDing 继承的模型

> ID：12661637
> 
> 赞同：2
> 
> 时间：2012-09-30T13:35:09.507
> 
> 标签：php, model-view-controller, design-patterns, convention

这是我的数据库结构：

![数据库模式](../Images/b27c64803fc134b1e9e3a3b595838564.png)

在我的应用程序中，我对客户、员工和分支机构进行了公司管理。

客户和员工与一个人、一个个人和一个用户相关联。分支机构与一个人和一个公司相关联。

因此，要插入一个新的客户或员工，我必须先将其公共数据插入`Person`表中，将其人员数据插入`Person`表中，然后将其用户数据插入表中，`User`最后在表中创建新记录。`Customer``Employee`

要插入一个新的分支，我必须先将它的公共数据插入到`Person`表中，然后将其公司数据插入到`Company`表中，最后在表中创建一条新记录`Branch`。

我是 MVC 概念的新手，我对如何设计我的模型类来对它们进行 CRUD 有点迷茫。我正在使用 CodeIgniter 框架，但我认为这无关紧要。我应该为每个数据库表创建一个单独的类模型吗？如果是这样，我应该如何编码？（仅理论）

例如，要插入一个新客户...

1.  开始新的交易
2.  实例化一个新的人
3.  填写个人资料
4.  救人
5.  实例化一个新个体
6.  填写个人数据并与其个人相关
7.  保存个人
8.  实例化一个新用户
9.  填写用户的数据并与其人员相关
10.  保存用户
11.  实例化一个新的 Costumer
12.  填写客户的数据并与其人员相关
13.  节省客户
14.  结束交易

那是对的吗？在客户的控制器中，这段代码应该在哪里？使用该数据库结构有什么更好的约定（我需要使用第三范式设计）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T17:33:12.703

**TL;博士**。不，您不应该为每个表创建单独的模型。

* * *

首先，您的数据库图是错误的。和的碎片`User`化。它们都有 1:1 的关系，而且表格看起来非常多余。哦..表格的单数命名约定是什么？！`Individual``Person``User`

[*反正 ..*]

* * *

实际上，您所说的“模型”实际上是[域对象](http://c2.com/cgi/wiki?DomainObject)。它们只是模型层的一部分。是的，MVC 中的模型是一层。不是类也不是对象。

如果实施得当，您的域对象将与实现存储逻辑的类分开（通常：[数据映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)）。除了遵守[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)之外，这样的实现还可以让您能够使域对象独立于存储形式。数据映射器可以将多个表映射到单个域对象，这与将逻辑与存储机制混为一谈的*活动记录*（反）模式不同。

至于控制器......好吧。每个视图都应该有一个控制器。控制器应该仅通过传递来自传入请求的数据来更改模型层和当前视图的状态。

您的问题似乎表明您的域业务逻辑从模型层泄漏到表示层。相反，您应该创建服务（您可以将它们视为“高阶域对象”），这有助于多个域对象与您选择的存储抽象（数据映射器、DAO、存储库、工作单元等）之间的交互。控制器应该只有用户管理服务：*“这里是数据，给我创建一个新的用户帐户。”*

* * *

***PS*：**你可能会发现[这篇文章](https://stackoverflow.com/a/5864000/727208)很相关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T16:18:05.843

好吧，有趣的是，为什么要使用 3NF？

在 MVC Web 框架（如 Codeigniter、Zend Framework 或 Ruby on Rails）中，您不需要 3NF，甚至不需要关心不同的表。我想说的是，您正在尝试的是多表继承，这不是很常见。

所以实际上你有一个`Custumer`类，它具有你的 Customer、User 和 Person 表的所有属性。要坚持 MVC 和*瘦控制器*方法，您的类中有一个`save`动作，`CustomerController`它接受这些属性并从此类实例化一个对象`Costumer`：

```
class CostumerController {
    function create() {
        Costumer c = new Customer();
        c.save($_POST['costumer']);
    }
} 
```

（确保您检查 SQL 注入的参数，但您的框架应该以某种方式处理它。）

您的自定义类应该有一个构造函数，它应该接受其所有属性并将它们保存到适当的表中。IE：

```
class Costumer {
    function save(params) {
        $sql = 'INSERT INTO person SET `phoneNumber` = "' . params['phonenumber'] . '"';
        $dbh->query($sql);
        $lastid = PDO::lastInsertId;
        $sql = 'INSERT INTO user SET `password` = "'. md5(params['password']) . '", `personId` = "' . $lastid . '";
        ...
    }
} 
```

您可能已经注意到，由于我不了解 CodeIgniter，因此我缩短了 Sql 语句和一些代码。但是这个想法是将您需要的所有数据提供给 save 方法，该方法将其保存到数据库中的适当表中。 **记住：**只有模型类与 MVC 中的数据库通信。

问题是您在其他表中用作外键的 ID。因此，在将数据插入到人员之后，您需要在表中查询它刚刚插入的 ID，并在另一个表中使用它。

这就是为什么一些框架（可以这么说：*我所知道*的）默认使用单表继承。把它想象成这样：

您描述它的方式，您的`Costumer`继承自`User`which 继承自`Person`. 所有这些表都合并到一个表中，该表还包含一个`type`属性，该属性表示该行的对象是哪种类型，在我们的例子中是`Customer`：`User`或`Person`。如果只添加一个用户，所有未使用的属性都将设置为`NULL`。但这当然会破坏你的 3NF。

不过，我不明白为什么你总是需要 1:1 的关系。例如`Person`和之间`Company`。哦，现在我明白了，既然没有`companyId (FK)`in `Person`，很多`Person`s 可以在一个中`Company`。但是为什么`Branch`会有一个`personId (FK)`. 通常有更多的人在一个分支机构工作，不是吗？

**回到你的问题**

您可以使用*Thin-controller-fat-model*或*fat-controller-thin-model*，但我更喜欢第一个。在这种情况下，您的控制器中只有几行代码，模型中有更多逻辑（如我上面的示例所示）。与数据库的通信仅发生在您的模型类中。您通常没有一个表等于一个模型类型的方法，但您也可能有多个模型类型访问一个表（请参阅单表继承）。

**另一种方法**

您可以有一个`Costumer`模型来接受您的数据并以表格“分散”的方式对其进行“分组”：

```
class Customer {
    function save(params) {
        Person $person = new Person();
        $person.save(params['person']);
        User $user = new User();
        $user.save(params['user'], $person->id);
        ....
    }
} 
```

但是...好吧，正如我所说，我建议您离开 3NF 方法并使用 STI（单表继承）。

**不要忘记**确保引用表单数据以避免 SQL 注入或查看您的框架提供哪些功能来为您执行此操作。

对不起，代码中的任何错误，我只是从内存中“编码”，甚至没有语法解析它。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T14:14:09.600

你可能会得到很多不同的意见。在不了解有关您的应用程序的太多细节的情况下，一种可能的方法是将其放入应用程序服务中。

然后您的 Web 应用程序将使用适当的应用程序服务来执行此逻辑。这将使您的 Web 界面与应用程序逻辑分离，从而使某些其他应用程序（例如某些内部审计服务）能够使用相同的逻辑，而无需复制实现逻辑。

我不懂 PHP，所以我将使用一些 .NET 式的伪代码，而不考虑任何特定技术（这就是为什么故意不对任何流行的 Web 应用程序框架进行方法调用的原因）。

```
class CustomerService // typically it will be an interface ICustomerSvc, but nevermind...
{ 
   // this will implement your logic to add customer - points 1-14
   // it might return the ID of the customer or not (CustomerID is typically
   // an integer, string, GUID, etc
   CustomerID AddCustomer(CustomerInfo info); 
} 
```

然后在您的网络应用程序中，您将有一个处理网络请求的方法

```
void AddCustomer(CustomerData data) 
{
   // note: data is not necessarily the same CustomerInfo type.
   // this is your web app model, and can be same but doesn't have to
   try {
      // m_customerSvc - can be instantiated withing class, provided in constructor, etc
      var id = m_customerSvc.AddCustomer(data);      // add a customer
      RedirectTo("confirmation_page_for_user_", id); // show confirmation page
   }
   catch(...) {
      RedirectTo("error_page");
   }
} 
```

不太明显的一件事是在哪里放置事务处理。它可以在应用程序服务内部，也可以在 Web 请求处理程序方法内部。

虽然第一个看起来更直观，但问题是应用服务通常不知道足够的上下文来决定事务处理。想象一下这个流行的汇款示例：

```
 m_svc.TakeMoney(account1, amount);
 m_svc.AddMoney(account2, amount); 
```

该服务无法处理服务方法调用内部的事务，因为如果第一个方法成功而第二个方法失败，我们最终会出现不一致的状态，即资金从一个帐户中提取，但从未到达另一个帐户。

因此，事务必须在外部进行管理：

```
using(var tx = new Transaction())
{
   // now both execute within same transaction
   m_svc.TakeMoney(account1, amount);
   m_svc.AddMoney(account2, amount);
} 
```

由您决定最适合您的应用程序的内容。

# android - 如何在自身内部重绘片段

> ID：12661639
> 
> 赞同：0
> 
> 时间：2012-09-30T13:35:30.633
> 
> 标签：android, fragment

我想`Fragment`在我的数据`Fragment`更新时重绘一个，比如说在一个`updateView()`方法中。我如何实现这一目标？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-30T18:46:58.090

您可以使用 FragmentManager 和 FragmentTransaction 类在 UI 中动态切换片段。您执行以下操作：

在 XML 中为您的片段定义一个容器视图。这可以是一个简单的 LinearLayout

```
FragmentManager fragmentManager = getFragmentManager;
FragmentTransaction ft = fragmentManager . beginTransaction; 
```

使用添加或删除片段

```
ft.add (R.id.frag_container, myFrag);
ft.replace (etc...)
ft.remover (etc...) 
ft.commit (); 
```

# javascript - 返回搜索到的字符串 + 上一个和下一个单词

> ID：12661640
> 
> 赞同：2
> 
> 时间：2012-09-30T13:35:31.353
> 
> 标签：javascript, ajax, string, match

我有一个这样的字符串： `This is my text`

当我搜索我想要得到的字符串`is`时`This is my`，当我搜索`This`我想要得到`This is`的`text`结果应该是`my text`

所以我总是尝试找到一个字符串并获取搜索到的字符串+上一个和下一个单词（如果存在）。

我知道我可以搜索`mystring.match('search')`一个字符串，给我索引，但我如何走得更远，也许使用`split`？

也许你们中的某个人有一个想法。

感谢任何帮助

鲁文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T14:10:00.210

我建议使用以下方法，它使用一种功能方法，允许您传递要搜索的单词和用于搜索该单词的字符串：

```
function findWordAndNeighbours(needle, haystack) {
    if (!needle || !haystack) {
        return false;
    }
    else {
        var re = new RegExp('(\\S+[\\b\\s]' + needle + '[\\b\\s]\\S+)', 'i'),
            foundWords = haystack.match(re)[0].split(/\s+/),
            foundFragment = foundWords.join(' ');
        return foundFragment;
    }
}

var sentenceFragment = findWordAndNeighbours('test', 'This is a Test of a matching thing.');

console.log(sentenceFragment); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/2GHJ5/)。

**编辑**以更新上述内容以包含一些错误捕获，基本上在尝试使用这些匹配之前检查是否存在一些正则表达式匹配*：*

```
function findWordAndNeighbours(needle, haystack) {
    if (!needle || !haystack) {
        return false;
    }
    else {
        var re = new RegExp('(\\S+[\\b\\s]' + needle + '[\\b\\s]\\S+)', 'i'),
            matches = haystack.match(re);
        if (matches) {
            // this is for if you wanted the individual words (as an array)
            var foundWords = haystack.match(re)[0].split(/\s+/),
                // this is to return the found sentence-fragment:
                foundFragment = foundWords.join(' ');
            return foundFragment;
        }
        else {
            /* this just follows the indexOf() pattern of, if you'd rather
               'return false' instead, that's entirely your call. */
            return -1;
        }
    }
}

var sentenceFragment = findWordAndNeighbours('test', 'This is a Test of a matching thing.');

console.log(sentenceFragment); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/2GHJ5/2/)。

**编辑**以纠正 OP 在评论中发现的问题（如下）：

> 但是如果您搜索 This 或 thing，这将不起作用，所以第一个或最后一个词

操作数/特殊字符的使用`?`（意味着匹配前面的字符/组零次或一次）似乎可以纠正在提供的字符串中搜索第一个和最后一个单词时出现的问题。

```
function findWordAndNeighbours(needle, haystack) {
    if (!needle || !haystack) {
        return false;
    }
    else {
        var re = new RegExp('((\\S+[\\b\\s]?)' + needle + '([\\b\\s]?\\S+))', 'i'),
            matches = haystack.match(re);
        console.log(matches);
        if (matches) {
            var foundWords = haystack.match(re)[0].split(/\s+/),
                foundFragment = foundWords.join(' ');
            return foundFragment;
        }
        else {
            return -1;
        }
    }
}

var sentenceFragment = findWordAndNeighbours('es', 'This is a Test of a matching thing.');

console.log(sentenceFragment); 
```

但是，我无法找到一种从给定单词中搜索子字符串的简洁方法，例如`es`(from `test`，如示例中所示)。该函数返回完整的单词（在本例中为`test`）。如果您想对该行为进行天真的更正，那么您可以轻松地添加`if (needle == matches[0]) {/* do something */}`检查，并按照您认为最好的方式改变行为。但我不完全确定最好的处理方法是什么。

参考：

*   [`Array.join()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join).
*   [JavaScript 正则表达式](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)。
*   [`RegExp()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp).
*   [`String.match()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match).
*   [`String.split()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:39:46.920

```
'asd d This is my text a'.match(/\s(\w*\sis\s\w*)\s/)[1] //=> "This is my" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T13:44:22.820

试试这个

这是工作[示例](http://jsfiddle.net/CbXPB/)

代码在javascript中

```
var str = "This is my text";

var strArr = str.split(" ");

var seacrhWord = "is";

for (i=0; i<strArr.length; i++)
   {
      if ( strArr[i] == seacrhWord)
      {
          var result = "";
          if (strArr[i-1] != null)
             result += strArr[i-1]

          result += " " + strArr[i];

          if (strArr[i+1] != null)
             result += " " + strArr[i+1];

          alert(result);
      }
  } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-23T12:17:51.113

另一个解决方案：

```
var input = 'Text? This is my simple text string where I use word TEXT a few times. Is it finding my text?'
var text = 'text';

input = input.toString();
text = text.toString().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, '\\$&');

var preLength = 7;

var search = function () {
    if (position !== -1) {
        var sliceStart = (position - preLength) >= 0 ? position - preLength : 0;
        var sliceEnd = position + text.length + preLength;

        var matchedText = input.slice(sliceStart, sliceEnd).trim();

        var preText = ((position - preLength) >= 0) && !result.length ? '...' : '';
        var postText = input.slice(sliceEnd).trim().length > 0 ? '...' : '';

        result = result + preText + matchedText + postText;

        input = input.slice(sliceEnd);
        lowercaseInput = lowercaseInput.slice(sliceEnd);

        position = lowercaseInput.search(lowercaseText);
    }
}

var lowercaseInput = input.toLowerCase();
var lowercaseText = text.toLowerCase();

var result = '';
var position = lowercaseInput.search(lowercaseText);

while (position !== -1) {
    search();
}

console.log(result); 
```

这会查找搜索到的文本并返回包含所有匹配项的结果。

[http://jsfiddle.net/bqwn1whq/](http://jsfiddle.net/bqwn1whq/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-30T13:47:24.427

在我看来，对于“this i”等，您可以使用正则表达式、3 或 4 大小写以 ^this 开头？但如果不小心，这种搜索是不健康的。空格和不匹配的术语可能会产生难以匹配此 i* 的问题。for substring match match(/y​​oursearchterm/[A-Za-z0-9_-]*/i) 如果不匹配，则在 for 循环中使用 yoursearchterm 的子字符串，例如 yoursearchterm.substring(0,yoursearchterm.length-1) 尝试制作-1 到 -i 表示相似性，

全文搜索或 sql 中的类似表达式。为了获得更好的结果，用于 sql 的正则表达式可能会对您有所帮助，但它们都 {like 和 regex not very fast} .for 通过相似性进行匹配，例如 apple 是您的数据，而 appla 或 app 或 appl 或 eppl 是您的搜索，您可以让他们找到通过莱文斯坦。在 php [http://php.net/manual/en/function.levenshtein.php](http://php.net/manual/en/function.levenshtein.php) 中，对于子字符串或长句，您可以使用按空间拆分{或分解}数据的方式。即我在这里，您的数据在这里拆分为 3，我是他们两个，您可以应用 lev 或喜欢正则表达式匹配成功，但您必须考虑查询的性能

# sql-server-2008 - 如何使用 T-SQL 从管理控制台连接到 SQL

> ID：12661644
> 
> 赞同：2
> 
> 时间：2012-09-30T13:35:47.953
> 
> 标签：sql-server-2008, tsql, ssms

我有一组 SQL 服务器分布在 25 个位置，它们都具有相同的数据库。我可以使用管理控制台手动连接到所有这些。在“新查询”下的服务器管理控制台中，我想学习如何使用循环包装一个查询或一组 t-sql 语句，该循环首先连接到其中一个服务器，指定数据库，然后运行查询/语句。这样，如果我需要对所有数据库运行一个通用查询，例如更新数据库，我不必手动连接每个数据库，展开控制台，单击数据库，然后单击“新建查询。 "

这些服务器都命名为 wsrv01、wsrv02、wsrv03 等，所以我可以轻松地遍历这些名称；我只是不知道如何进行循环或建立连接。

这是一种独特的环境……我过去在其他项目中使用过 RedGate 并且喜欢它；但这是另一种情况。

基本上，我想避免这样做并深入每个服务器以运行查询：

![在此处输入图像描述](../Images/457e1a4186f660e162597eee7653b334.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T17:01:22.947

Martin Smaith 的回答是我首选的解决方案，但我可以建议另外两种方法：

1）您可以在SSMS中使用“SQLCMD模式”。

它看起来像：

```
:connect MyServer -U MyLogin -P MyComplexPassword
--Then have some code

:connect MyOtherServer ...
--Then have some code 
```

但是你不能循环，所以你会有重复的代码。

或者

2) 您可以基于服务器列表创建一个带有 FOR 循环的 CMD 文件。这是我自己酿造的一个例子。只需将其复制粘贴到 REQ.CMD 并创建一个名为 SERVERS.LST 的文本文件，每行有一个服务器名称。连接将通过 Windows 身份验证。如果愿意，您可以将 OSQL 更改为 SQLCMD，但 OSQL 应该适用于 SQL 2008。

```
REM To execute a SQL command or file to multiple servers
REM Using a server list file
REM And using 2 kind of parameters (script file or query)
REM Pollus Brodeur - June 2007
@echo off

set PARAM1=%1
set PARAM2=%2
set PARAM3=1

REM You need at least 1 parameter
if x==%1x goto ERROR1
if EXIST %PARAM1% (set ISFILE=1) else (set ISFILE=0)

REM Setting Servers List File and verify file existance or X
if x==%2x (set PARAM2=servers.lst)
if X==%2 (set PARAM3=0 & set PARAM2=servers.lst & goto MAIN)
if NOT EXIST %PARAM2% (goto ERROR2)

REM Not interactive
if X==%3 (set PARAM3=0)

:MAIN
echo ===============================================================================
echo REQ - Execute a SQL command or file to multiple servers using a list file
echo %DATE% %TIME%
if %PARAM3%==0 (echo Non Interactive mode)
echo ===============================================================================

if %ISFILE%==0 (GOTO COMMAND)

echo For following file :
echo %PARAM1%
goto EXEC

:COMMAND
echo For following command :
echo %PARAM1%

:EXEC
echo ===============================================================================
echo For following servers :
type %PARAM2%
echo ===============================================================================

if %PARAM3%==1 (echo Interactive mode. Use X parameter to deactivate & pause)

echo Exec...
if NOT EXIST .\out mkdir out
if EXIST out\req.out (del out\req.out)
if %ISFILE%==0 (GOTO COMMAND1)

for /F %%a in (%PARAM2%) do echo %%a & osql -S %%a -E -n -h-1 -w 9999 -u -i %PARAM1% -o out\req.out.%%a.txt
goto ENDEXEC

:COMMAND1
for /F %%a in (%PARAM2%) do echo %%a & osql -S %%a -E -n -h-1 -w 9999 -u -Q %PARAM1% -o out\req.out.%%a.txt

:ENDEXEC
type out\req.out.*.txt >> out\req.out 2>&1
echo ===============================================================================
echo Execution is done. Output files are in .\out
echo more /E /C out\req.out.*.txt
echo more out\req.out
echo ===============================================================================
if %PARAM3%==1 (pause)
goto END

:ERROR1
goto CALLEXAMPLE

:ERROR2
echo Error: Server File List named %PARAM2% doesn't exists
goto CALLEXAMPLE

:CALLEXAMPLE
echo -------------------= REQ call examples =--------------------
echo REQ.cmd Param1 Param2 Param3
echo Param1 = command or scriptfile.sql {mandatory}
echo Param2 = servers list file {servers.lst per default}
echo Param3 = X {for non interactive mode}
echo ------------------------------------------------------------

:END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T13:21:52.667

如果您真的不能使用其他任何东西.. 尝试创建链接服务器。这样你就可以像这样简单地查询..

```
select * from <linkedserver>.<database>.<schema>.<object> 
```

# android - 如何设置触发定期服务的切换按钮？

> ID：12661645
> 
> 赞同：0
> 
> 时间：2012-09-30T13:35:56.153
> 
> 标签：android, service, alarmmanager, togglebutton

我需要在我的 Android 应用程序中实现以下功能：触发定期服务的切换按钮。

让我以更好的方式提出这个问题：我想要一个具有“开启”模式的切换按钮。在这种模式下，我想定期启动一个服务（例如每 5 分钟）。在“关闭”模式下，定期服务被禁用。我想我需要使用 AlarmManager 服务。

你能给我提供指导方针（如果可能的话，附上代码）或一个很好的教程来做到这一点？

预先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:57:29.007

私人警报管理器警报管理器；私有的 PendingIntent

使用此创建的方法在单击切换按钮时打开和关闭服务。还要确保使用 AlarmManager 作为单例。

```
private void setService() {

                try {
                    if (alarmManager != null) {
                        alarmManager.cancel(pendingIntent);
                    }
                } catch (Exception e) {

                    e.printStackTrace();
                }
                Intent intent = new Intent(this, MyBroadCastReceiver.class);

                pendingIntent = PendingIntent.getBroadcast(this, 0, intent, 0);

                alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE); //
                        // 60 seconds i.e 1 min 
                long time = 60 * 1000;

                alarmManager.setRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP,
                        SystemClock.elapsedRealtime() + time, time, pendingIntent);

            } 
```

要删除 serviceUpdates，请使用以下方法：

```
 private void removeService() {
            try {
                if (alarmManager != null) {
                    alarmManager.cancel(pendingIntent);
                }
            } catch (Exception e) {
                // TODO: handle exception
                e.printStackTrace();
            }
        } 
```

现在广播类应该如下所示：

```
public class MyBroadCastReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {

        Log.d("test_log", "broadcast worked ");

    }
} 
```

现在是接收器的清单声明：

```
<receiver android:name=".MyBroadCastReceiver"></receiver> 
```

# c++ - 无法在 WMI (c++) 中检索对象属性

> ID：12661648
> 
> 赞同：5
> 
> 时间：2012-09-30T13:36:09.440
> 
> 标签：c++, events, notifications, wmi

我想用 WMI 做一些事情（接收一些事件通知），所以我从 MSDN 网站上的简单示例开始：

[通过 WMI 接收事件通知](http://msdn.microsoft.com/en-us/library/windows/desktop/aa390425%28v=vs.85%29.aspx)

该程序通过WMI接收事件通知（进程创建），并在接收到事件时调用函数EventSink::Indicate。

我在上面的链接（复制/过去）中使用了相同的代码，但做了一个更改：在 EventSink 类中，函数

```
HRESULT EventSink::Indicate(long lObjectCount, IWbemClassObject **apObjArray) 
```

我添加了几行来检索对象的属性（对象在 apObjArray 中返回）：

```
 for (int i = 0; i < lObjectCount; i++)
    {
        VARIANT varName;
        hres = apObjArray[i]->Get(_bstr_t(L"Name"),
            0, &varName, 0, 0);
//...
    } 
```

现在 Get(...) 函数返回 WBEM_E_NOT_FOUND （未找到指定的属性），无论我寻找什么（从文档中确定属性在那里......）

请让我知道我错过了什么？！任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-01T03:14:13.850

该`Name`属性是`TargetInstance`对象的一部分，因此您必须获取 TargetInstance 对象的值，然后检索该`Name`属性的值。

试试这个样本

```
HRESULT EventSink::Indicate(long lObjectCount,
    IWbemClassObject **apObjArray)
{
   HRESULT hr = S_OK;
   _variant_t vtProp;

    for (int i = 0; i < lObjectCount; i++)
    {

    hr = apObjArray[i]->Get(_bstr_t(L"TargetInstance"), 0, &vtProp, 0, 0);
     if (!FAILED(hr))
     {
       IUnknown* str = vtProp;
       hr = str->QueryInterface( IID_IWbemClassObject, reinterpret_cast< void** >( &apObjArray[i] ) );
       if ( SUCCEEDED( hr ) )
       {
          _variant_t cn;
         hr = apObjArray[i]->Get( L"Name", 0, &cn, NULL, NULL );
          if ( SUCCEEDED( hr ) )
          {
            if ((cn.vt==VT_NULL) || (cn.vt==VT_EMPTY))
             wcout << "Name : " << ((cn.vt==VT_NULL) ? "NULL" : "EMPTY") << endl;
            else
             wcout << "Name : " << cn.bstrVal << endl;
          }
          VariantClear(&cn);

       }
     }
     VariantClear(&vtProp);

    }

    return WBEM_S_NO_ERROR;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-29T13:24:38.433

上面的例子似乎有内存泄漏。

```
IUnknown* str = vtProp; 
```

此赋值使用 _variant_t 类的运算符 IUnknown*，它隐式调用对象上的 AddRef()。所以 str->Release() 需要在使用后调用，因为

```
VariantClear(&vtProp); 
```

不足以减少对象的引用计数。

# boost - Boost.Build 针对 boost 库的链接

> ID：12661653
> 
> 赞同：1
> 
> 时间：2012-09-30T13:36:42.490
> 
> 标签：boost, bjam, boost-build

我正在尝试链接来自 Jamfile 的 boost 库：

```
import os ;
path-constant BOOST_ROOT : [ os.environ BOOST_ROOT ] ;
use-project /boost : $(BOOST_ROOT) ;

exe hello :
            hello.cpp
            /boost//filesystem
            /boost//system
          :
            <link>static
          ; 
```

虽然我可以从控制台输出中看到库已编译，但链接器输出错误：

```
msvc.link bin\msvc-10.0\debug\link-static\hello.exe
LINK : fatal error LNK1104: cannot open file 'libboost_filesystem-vc100-mt-gd-1_46.lib' 
```

为什么会报错？**我**正在从 Jamfile 级别链接库，那么为什么在应该链接的时候没有链接库？据我了解，如果整个构建过程由 Jamfiles 控制，则该库应自动静态链接，并且不应添加特定于编译器的标志（因为它会使 Jamfiles 的可移植性降低）。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T21:10:34.310

您可能在使用 boost 的自动链接功能时遇到问题。您可以通过定义来禁用它`BOOST_ALL_NO_LIB`（我想添加`<define>BOOST_ALL_NO_LIB`到目标的要求`hello`就足够了）。

# ruby-on-rails - 使用 Rails 3 构建和处理多个参数查询

> ID：12661655
> 
> 赞同：2
> 
> 时间：2012-09-30T13:36:49.543
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

我对如何处理 URL 中的多个参数输入以在 Rails 3.2 中构建过滤器有点迷茫

基本上，我想把[http://example.com/products/?category=24](http://example.com/products/?category=24)和[http://example.com/products/?category=24&country=24](http://example.com/products/?category=24&country=24)一起工作。

我有以下型号`Product`，，，，`Country``Category``Categorization`

我可以在我的`ProductController`

```
def index
  @products = product.all

  if params[:country]
    @products = Country.find(params[:country]).products
  end

  if params[:category]
    @products = Category.find(params[:category]).products
  end

end 
```

我想知道解决这个问题的最佳方法，因为我`Category`和`Product`模型通过`Categorization`模型通过 has_many 关联。

```
class Product < ActiveRecord::Base

  has_many :categorization
  belongs_to :country

end

class Category < ActiveRecord::Base
  has_many :categorization
  has_many :products, through: :categorization

  attr_accessible :name

end

class Categorization < ActiveRecord::Base
  belongs_to :category
  belongs_to :product

  attr_accessible :category, :product
end 
```

我的视图布局模板是一个简单的类别和国家链接列表。因此，如果有人点击一个名为“Toys”的类别并点击国家“England”，它应该建立一个如下链接：[http ://www.example.com/products/category=12&country_id=1](http://www.example.com/products/category=12&country_id=1)

```
<div class="wrapper">
  <div class="products">
  </div>
  <div class="sidebar>
   <h2>Categories</h2>
   <ul>
     <% @categories.each do |category| %>
       <li><%= link_to category.name, params.merge(category: category.id) %></li>
     <% end %>
   </ul>
    <h2>Countries</h2>
   <ul>
     <% @countries.each do |country| %>
       <li><%= link_to country.name, params.merge(country: country.id) %></li>
     <% end %>
   </ul>
  </div>
</div> 
```

**更新**

我已经接受了在模型类上创建过滤器的建议，并且下面的代码可以工作，但它看起来很混乱而且不是 DRY .. 有人可以协助另一种方法。

```
# Product Model

class Product < ActiveRecord::Base 

  # Search filter
  def self.filter_by_params(params)
    if params.has_key?(:category) && params.has_key?(:country_id)
      scoped.joins(:categorization).where("category_id = ? AND country_id = ?", params[:category], params[:country_id])
    elsif params.has_key?(:category)
      scoped.joins(:categorization).where("category_id = ?", params[:category])
    elsif params.has_key?(:country_id)
      scoped.where(country_id: params[:country_id])
    else
      scoped
    end
  end

end

# Product Controller

def index
  @product = Product.filter_by_params(params)
end 
```

非常感谢您的任何建议。

西部数据

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T16:07:48.697

我会改变你`ProductsController`如下：

```
def index
  @products = Product.filter_by_params(params)
end 
```

然后在你的`Product`模型中：

```
def self.filter_by_params(params)
  scoped = self.scoped
  scoped = scoped.where(:country_id => params[:country_id]) if params[:country_id]          
  scoped = scoped.where(:category_id => params[:category_id]) if params[:category_id]
  scoped
end 
```

您需要更改视图以传递 category_id 和 country_id。

# android - Android ListView w/ TextView 在顶部和 EditText & Button 在底部

> ID：12661662
> 
> 赞同：0
> 
> 时间：2012-09-30T13:38:05.153
> 
> 标签：android, listview

总有一天我会破解这些 Android 布局的代码。*叹*

我需要一个活动，其 TextView 固定在屏幕顶部，下方有一个可滚动的列表视图，底部固定在屏幕上，有一个 editText 和一个按钮（这个想法是让用户能够将项目添加到列表）。

现在回答下面的工作代码作为问题：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="fill_parent"
     android:layout_height="match_parent" 
     >

     <TextView
         android:id="@+id/tvAddQuizWordQuizName"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content" 
         android:layout_alignParentTop="true"
         android:text="Quiz Name" 
         android:textSize="26dip"
         />

     <ListView 
         android:layout_width="fill_parent"
         android:layout_height="wrap_content" 
         android:id="@+id/list"
         android:layout_below="@+id/tvAddQuizWordQuizName"
         android:layout_above="@+id/bottomArea"
         />

     <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
         xmlns:tools="http://schemas.android.com/tools"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
         android:layout_alignParentBottom="true"
         android:id="@+id/bottomArea"
         >
         <EditText
             android:id="@+id/etAddQuizWord"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_toLeftOf="@+id/btnAddQuizWord"
             android:textColor="@android:color/black" 
             android:inputType="textNoSuggestions"
             android:hint="Enter quiz word..."
             android:textSize="32dip"
             android:layout_alignParentLeft="true"
             android:background="#0000ff"
             >
         </EditText>

         <Button
             android:text="Add"
             android:id="@+id/btnAddQuizWord"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:textSize="20dip"
             android:textStyle="bold"
             android:gravity="center"
             android:layout_alignParentRight="true" 
             android:onClick="AddButtonClicked"
             />
     </RelativeLayout>

 </RelativeLayout> 
```

问题是，lop 的 textview 和 listView 没有显示。我确信这是非常简单的事情，但我就是不明白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:44:06.820

下面的布局应该像你想要的那样定位元素。

```
<RelativeLayout >

    <TextView android:id="@+id/ttvAddQuizWordQuizName"
         android:layout_alignParentTop="true"
         android:layout_width="match_parent" 
         android:layout_height="wrap_content" />

    <RelativeLayout android:id="@+id/InnerRelativeLayout"     
         android:layout_alignParentBottom="true" 
         android:layout_width="match_parent"
         android:layout_height="wrap_content" >
         <!-- contebt here -->
    </RelativeLayout>

     <ListView 
         android:layout_width="match_parent"
         android:layout_height="wrap_content" 
         android:id="@+id/list"
         android:layout_above="@id/InnerRelativeLayout"
         android:layout_below="@id/tvAddQuizWordQuizName" />

 </RelativeLayout> 
```

# javascript - javascript 中是否存在 getColorBoundsRect() 等效项？

> ID：12661664
> 
> 赞同：2
> 
> 时间：2012-09-30T13:38:22.857
> 
> 标签：javascript, actionscript-3, html, canvas

只是想知道是否有人已经用 Javascript 完成了这项工作，或者我是否必须自己做——如果是后者：我将如何做？（不要求一段代码，只是好奇你会使用哪种方法）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-22T14:51:34.097

我有更好的解决方案。不必遍历**所有**像素，只需遍历边界框外的像素即可。这样想，如果你想在一维中做同样的事情：在数组中找到一个值的第一个和最后一个位置，你会遍历整个数组吗？*最好从头开始直到找到第一个值，然后从结尾*遍历直到找到最后一个值。以下代码对 2D 执行相同的操作。我还没有彻底测试过它（无论是正确性还是速度），但它似乎有效，而且常识说它更快。

```
BitmapData.prototype.getColorBoundsRect = function(mask, color, findColor, rect){
    findColor = typeof findColor !== 'undefined' ? findColor : true;
    rect = typeof rect !== 'undefined' ? rect : new module.Rect(0, 0, this.width, this.height);

    var l = rect.w - 1;
    var r = 0;
    var t = rect.h - 1;
    var b = 0;

    var data = this.context.getImageData(rect.x, rect.y, rect.w, rect.h).data;

    // Scan from top to first pixel.
    for (var i = 0; i < data.length; i += 4){
        var val = module.RGBToHex({r:data[i], g:data[i+1], b:data[i+2], a:data[i+3]});
        // console.log(val, mask, color, (val & mask) >>> 0)
        if ((findColor && ((val & mask) >>> 0 == color)) || (!findColor && ((val & mask) >>> 0 != color))){
            l = r = ((i / 4) % rect.w);
            t = b = Math.floor(i / 4 / rect.w);
            break;
        }
    }

    // We found nothing.
    if (i >= data.length) {
        return null;
    }

    // Scan from bottom to first pixel
    for (var j = data.length - 4; j > i; j -= 4){
        var val = module.RGBToHex({r:data[j], g:data[j+1], b:data[j+2], a:data[j+3]});
        if ((findColor && ((val & mask) >>> 0 == color)) || (!findColor && ((val & mask) >>> 0 != color))){
            l = Math.min(l, ((j / 4) % rect.w))
            r = Math.max(r, ((j / 4) % rect.w))
            b = Math.floor(j / 4 / rect.w);
            break;
        }
    }

    console.log(l, r, t, b);

    // Scan from left
    for (var x = 0; x < l; x ++){
        for (var y = t + 1; y <= b; y ++){
            i = (y * rect.w + x) * 4
            var val = module.RGBToHex({r:data[i], g:data[i+1], b:data[i+2], a:data[i+3]});
            if ((findColor && ((val & mask) >>> 0 == color)) || (!findColor && ((val & mask) >>> 0 != color))){
                l = Math.min(l, x);
                break;
            }
        }
    }

    console.log(l, r, t, b);

    // Scan from right
    for (var x = rect.w - 1; x > r; x --){
        for (var y = t; y < b; y ++){
            i = (y * rect.w + x) * 4
            var val = module.RGBToHex({r:data[i], g:data[i+1], b:data[i+2], a:data[i+3]});
            if ((findColor && ((val & mask) >>> 0 == color)) || (!findColor && ((val & mask) >>> 0 != color))){
                r = Math.max(r, x);
                break;
            }
        }
    }

    console.log(l, r, t, b)

    return new module.Rect(l + rect.x, t + rect.y, (r - l), (b - t));
} 
```

在此代码`BitmapData`中，仅包装了一个画布对象及其 context2d，并且`Rect`是一个`{x: , y: , w: , h: }`对象。我不得不对 RGBToHex 进行一些操作，以确保我也得到了正数（uint's）：

```
module.RGBToHex = function(rgb) { 
    return (rgb.a << 24 | rgb.r<<16 | rgb.g<<8 | rgb.b) >>> 0; 
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:36:26.247

这是我的快速'n'dirty解决方案，也许有人会发现它有用;）

```
/**
 * get a rectangle around color
 * @param  {...} ctx 2dCanvasObject to be scanned
 * @return {Object}     object storing the rectangle's data (x, y, w(idth), h(eight))
 */
function getColorBoundsRect(ctx) {
    /**
     * the canvas' context's data property (shorthand)
     * @type {...}
     */
    var data = ctx.data,
    /**
     * counter variable
     * @type {Number}
     */
        i = 0,
    /**
     * the "leftest" pixel that is not black (starts right, as we check if currently looped pixel (that is not black) is "lefter" than the current outerLeftPixel)
     * @type {Number}
     */
        outerLeftPixel = w-1,
    /**
     * the "rightest" pixel that is not black (starts left, as we check if currently looped pixel (that is not black) is "righter" than the current outerRightPixel)
     * @type {Number}
     */
        outerRightPixel = 0,
    /**
     * the "toppest" pixel that is not black (starts at bottom, as we check if currently looped pixel (that is not black) is "topper" than the current outerTopPixel)
     * @type {Number}
     */
        outerTopPixel = h-1,
    /**
     * the "bottomest" pixel that is not black (starts at top, as we check if currently looped pixel (that is not black) is "bottomer" than the current outerBottomPixel)
     * @type {Number}
     */
        outerBottomPixel = 0,
    /**
     * x coordinate of currently looped pixel
     * @type {Number}
     */
        x,
    /**
     * y coordinate of currently looped pixel
     * @type {Number}
     */
        y;

    // loop through all pixels
    // i equals the i'th pixel (0 is the upper left pixel, w*h is the bottom right pixel)
    while (i < (data.length / 4)) {
        // check if currently looped pixel is anything else than black --> color
        if ((data[i*4] + data[i*4+1] + data[i*4+2]) > 0) {
            // set coordinates for the currently looped pixel
            x = i % w; // if one row has 10px and i = 35, the x coordinate of the current pixel is 35 % 10 = 5
            y = Math.floor(i / w); // if one row has 10px and i=35, the y coordinate of the current pixel is 35/10 = 3.5 (--> rounded off = 3)

            // if the x coordinate of the current (colored) pixel is smaller than the current "leftest" pixel, set the x coordinate as new "leftest pixel"
            // same procedure for the other values
            if (x < outerLeftPixel) {
                outerLeftPixel = x;
            }
            if (x > outerRightPixel) {
                outerRightPixel = x;
            }
            if (y < outerTopPixel) {
                outerTopPixel = y;
            }
            if (y > outerBottomPixel) {
                outerBottomPixel = y;
            }
        }
        ++i;
    }

    // if there is color on the canvas, the outer[Right|Left|Bottom|Top]Pixel properties should have been updated accordingly and the following condition should be true 
    if (outerRightPixel > outerLeftPixel && outerBottomPixel > outerTopPixel) {
        return {
            x: outerLeftPixel,
            y: outerTopPixel,
            w: outerRightPixel - outerLeftPixel,
            h: outerBottomPixel - outerTopPixel
        };
    } 
    // if there is no color on the canvas, return false, as there is no rectangle
    else {
        return false;
    }
} 
```

# xml - 编写我的第一个 Ant 任务：我缺少什么？

> ID：12661665
> 
> 赞同：2
> 
> 时间：2012-09-30T13:38:30.633
> 
> 标签：xml, ant, taskdef

我已经阅读[了这篇](http://ant.apache.org/manual/develop.html)文章并用它来编写我的第一个 Ant 任务，名为`AutoTestTask`：

```
public class AutoTestTask extends org.apache.tools.ant.Task {
    // ...
} 
```

我还将此对象编译并打包成`auto-test.jar`.

如果我对 Ant 的理解是正确的，那么为了将它包含在另一个项目的构建中，我使用以下 XML：

```
<project name="SomeProject" basedir="." default="deploy" xmlns:at="antlib:org.me.auto-test">
    <!-- Task definitions. -->
    <taskdef name="at-autotest" classname="org.me.auto-test.AutoTestTask"/>

    <!-- Use the task. -->
    <at:autotest/>
</project> 
```

我*相信*我还需要复制`auto-test.jar`到我的 ${ANT_HOME}/lib 目录中 -**有人可以确认吗？**令我困惑的是`xmlns:at="antlib:org.me.auto-test"`XML 顶部的属性，特别是该`antlib:<whatever>`部分。这是某种特定于 Ant 的协议，它说“*任何由`at`命名空间限定的东西都可以在 ${ANT_HOME}/lib 中找到，并且根包为`org.me.auto-test`*”？如果没有，有人可以解释它的含义吗？

另外，如果我遗漏了任何明显的内容或配置不正确，请告诉我。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T18:33:49.403

1.  我不能用连字符编译一个包，所以我建议你`auto-test`改成`autotest`
2.  在`taskdef`你有`at-autotest`，应该是`autotest`
3.  `xmlns`声明用于 xml 解析器和使用 antlibs。您不需要将它们用于您的第一个 ant 任务。所以：删除`xmlns`和`at:`前缀。

既然您问“我错过了什么”，请报告您收到的错误消息是什么。可能在遵循上述建议之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:53:25.943

您正在尝试将您的任务打包为[antlib](http://ant.apache.org/manual/Types/antlib.html)。XML 文件将匹配命名空间并包含 taskdef 操作。

antlibs 相对较新，这可以解释为什么一些较旧的“如何创建 ANT 任务”教程没有提及它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T01:17:10.470

好的，它比你想象的要简单，但你必须要小心一点。

第一个问题是`<taskdef name="at-autotest" .. />`，因为您尝试将任务用作“at:autotest”。“at”是 xml 命名空间前缀，因此您需要在任务台定义的开头删除“at-”。

第二个问题是你没有将你的taskdef与xml命名空间“antlib:org.me.auto-test”相关联，所以你不能使用前缀。在这个阶段，您可以将它与当前命名空间（即无前缀）一起使用，如`<autotest/>`. 但我鼓励您为所有外部任务指定一个单独的命名空间，因此正确的版本是：

```
<project name="SomeProject" basedir="." default="deploy" xmlns:at="antlib:org.me.auto-test">
    <!-- Task definitions. -->
    <taskdef name="autotest" classname="org.me.auto-test.AutoTestTask" uri="antlib:org.me.auto-test"/>

    <!-- Use the task. You can use the prefix "at:" here -->
    <at:autotest/>
</project> 
```

还有几件事：

1.  此设置强制您将任务类的 jar 放入 ${ANT_HOME}/lib。但是你不必这样做，如果你知道位置可以直接引用jar（例如，你的项目根文件夹中的一个lib文件夹）。您可以使用 指定包含 jar 的类路径`<taskdef>`，如下所示（假设您已经定义了该类路径并分配了 id="autotest.classpath"）：

    ```
    <!-- Task definitions. -->
    <taskdef name="autotest" classname="org.me.auto-test.AutoTestTask" 
           uri="antlib:org.me.auto-test" classpathref="autotest.classpath" /> 
    ```

2.  正如另一个人在这里所建议的那样，您可以将您的类完全打包在一个 antlib 中。与 jar 的唯一区别是它包含一个文件“antlib.xml”，如果这个 jar 已经在主类路径中，您甚至可以跳过 taskdef 声明。在[此处](http://ant.apache.org/manual/Types/antlib.html%20here)阅读。这是“antlib：”命名空间前缀的位置带来了一些好处。我个人不喜欢将东西放在 ${ANT_HOME}/lib 中，所以我很乐意`<taskdef />`将无论如何，命名空间前缀作为约定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T20:17:18.910

大多数情况下，通过扩展创建一个新的 ant 任务`org.apache.tools.ant.Task`是矫枉过正的。
请注意，还有其他方法：
使用[**scriptdef**](http://ant.apache.org/manual/Tasks/scriptdef.html)与可以完全访问 ant api ieGroovy 的脚本语言、Javascript
（jdk >= 6 附带基于 rhino 1.6 的内置 javascript 引擎）在 ant 中定义任务。
之后要捆绑你的东西，创建一些包含所有[**scriptdef**](http://ant.apache.org/manual/Tasks/scriptdef.html)和[**macrodef**](http://ant.apache.org/manual/Tasks/macrodef.html)的 commons.xml，并使用 import 使其可用于其他 ant 脚本。

# c++ - C++ 访问虚方法中的公共变量

> ID：12661667
> 
> 赞同：1
> 
> 时间：2012-09-30T13:39:02.327
> 
> 标签：c++, class, virtual, abstract-class

在 C++ 中，我有一个抽象类 A：

```
 class A
 {
 public:
    A(){}
    virtual ~A(){}
    virtual void out(std::ofstream& outFile) = 0;
    virtual void in(std::ifstream& inFile) = 0;
}; 
```

我想在其中使用虚拟方法的 B 类：

```
class B : public A
{
public:
   B();              
   double angle;
   int index;

   virtual void out(std::ofstream& outFile);
   virtual void in(std::ifstream& inFile);

}; 
```

现在这里有一个问题：我想在虚拟方法中使用像 (int index) 这样的 B 类变量：

```
virtual void out(std::ofstrea& outFile)
{
    outFile<< index << angle;       
} 
```

在这里，我得到编译器错误，角度和索引未在此范围内声明。这有点合乎逻辑，因为该变量未在 A 类中声明。现在我如何才能访问虚拟方法中的变量角度和索引？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:41:44.640

当定义你的函数时，你想使用这样的东西：

```
void B::out(std::ofstream& outFile)
{
    outFile<< index << angle;       
} 
```

各个类的任何成员都可以在成员函数中访问，而与该函数是否为虚函数无关。

既然谈到了读取或写入数据的函数：除非你真的需要使用`std::ofstream`or的特定细节`std::ifstream`，例如 use `open()`，否则你可能应该传递`std::ostream`or`std::istream`引用。这样，函数也可以与不同的流流类型一起使用，例如`std::ostringstream`和`std::istringstream`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:41:47.250

如果您在类之外实现该方法，则不要将其标记为`virtual`并限定其名称：

```
void B::out(std::ofstrea& outFile)
{
    outFile<< index << angle;       
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:41:27.123

除非你在类声明中写了你的函数体，否则你必须在成员函数名前加上类名：

```
void B::out(std::ofstream& out)
{
   out << index << angle;
} 
```

顺便说一句，您得到了什么确切的错误，如果您可以发布确切的错误代码，这会简单得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T13:41:30.167

您在成员函数定义之前缺少类名。

```
void B::out(std::ofstrea& outFile)  // Virtual keyword is optional in defintion.
{
    // ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-30T13:41:56.360

当你在你的 cpp 文件中定义一个类方法时，你必须给类名作为范围，如下所示：

```
void B::out(std::ofstrea& outFile)
{
outFile<< index << angle;       
} 
```

# regex - 正则表达式在双引号之间隔离特定字符串

> ID：12661671
> 
> 赞同：1
> 
> 时间：2012-09-30T13:39:50.497
> 
> 标签：regex

我有这个字符串：

*"TEST_START" List of 4 $ test : Named num 0.983 ..- attr( *, "names")= chr "W" $ p.value : num 0.975 $ method : chr "**这是测试名称**" $ data.name : chr "x" - attr(* , "class")= chr "htest" [1]*

我正在尝试编写一个正则表达式，它可以用双引号隔离以下子字符串：*这是测试名称*

目前我做了这个正则表达式：

```
method\s:\schr\s"([^"]*)" 
```

它隔离了字符串的一个子集。但是，我只需要匹配上述子字符串（*这是测试名称*）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T14:09:10.700

试试这个，

```
(?<=method\s:\schr\s").*?(?=") 
```

请参阅**[Lookahead 和 Lookbehind 零宽度断言](http://www.regular-expressions.info/lookaround.html)**。

正则表达式好友截图

![在此处输入图像描述](../Images/b5f8407bdf5706c650cce3f6167cf376.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:47:38.083

`chr "(.*?)" \$`，然后选择第二个匹配项。如果您对输入字符串的一致性有信心，则可以使用。但请注意，并非所有正则表达式的实现都是 100% 相同的。您可能想清楚您正在使用哪种语言进行正则表达式。

# javascript - jquery动画内存问题

> ID：12661673
> 
> 赞同：1
> 
> 时间：2012-09-30T13:40:08.127
> 
> 标签：javascript, jquery, memory-leaks, jquery-animate

我使用了 jQuery .animate（灵感来自[如何让 div 在页面上随机移动（使用 jQuery 或 CSS）](https://stackoverflow.com/questions/10385950/how-to-get-a-div-to-randomly-move-around-a-page-using-jquery-or-css)）为多个 div 设置动画。我一直使用 javascript，而不是 jQuery，所以我有点不确定我在这里的立足点。因此最初需要片段。

我的代码完全按预期执行，但似乎我在某处发生了内存泄漏，并且随着时间的推移（大约 10 分钟）浏览器（IE、chrome 和 FF）将累积大约 500MB 的 RAM 使用量。

我无法理解为什么，因为没有排队的指令 - 在帮助的帮助下`setTimeout`- 并且没有加载图像等。

（`IF`声明是允许我在其他时间 - 将类更改为我的 50 个 '#z' div，并关闭动画。）

有人知道调试这类问题吗？它会随着时间的推移使浏览器崩溃，因此作为生产页面基本上没有用。还有一件事，FF 的在线崩溃报告非常糟糕，提交后没有“转储”，而且该问题在 chrome/IE 上不太明显——因此没有可用的崩溃报告。一旦我得到有用的东西就会更新。

```
function animateDiv() {
    for (z = 0; z < 50; z++) {
        var newq = makeNewPosition();
        var oldq = $("#" + z).position()
        var speed = calcSpeed([oldq.left], newq);

        if (document.getElementById(z).class != "b") {
            $("#" + z).animate({
                left: newq
            }, speed, function() {});
        }
    }

    setTimeout(function() {
        animateDiv();
    }, 0.1);
}

function makeNewPosition() {
    var w = $('#content').width() - 25;
    var nw = Math.floor(Math.random() * w);    
    return [nw];
}

function calcSpeed(prev, next) {
    var y = Math.abs(prev - next);
    var greatest = y;
    var speedModifier = 0.1;
    var speed = Math.ceil(greatest / speedModifier);
    return speed;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:51:32.323

在`animateDiv()`中，您既要启动动画，又要设置超时以从现在开始启动下一个动画 0.1 毫秒。如果您的动画长于 0.1 毫秒（可能是），那么您的动画将无限堆积，最终杀死浏览器。此外，`setTimeout()`需要整数毫秒，而不是十进制秒数。

由于我怀疑您的意图是在同一对象上同时运行多个动画，因此您应该使用前一个动画的完成功能而不是使用计时器来为一个对象启动下一个动画。这将保证它们永远不会堆积起来。为了安全起见，您还可以在开始下一个动画之前在对象上发出 a `.stop(true)`，以确保在开始下一个动画之前完成/停止之前发生的任何事情，再次确保它们永远不会无限期地累积。

您可以使用类似的方法来解决问题并确保安全：

```
function animateDiv() {

    function animateItem(item) {
        if (!item.hasClass("b")) {
            var newq = makeNewPosition();
            var oldq = item.position()
            var speed = calcSpeed([oldq.left], newq);
            // make sure animations can never accumulate and 
            // then start the next one
            item.stop(true).animate({
                left: newq
            }, speed, function() {
                // run next animation on this object when this one finishes
                animateItem(item);
            });
        }

    }
    // start all animations
    for (z = 0; z < 50; z++) {
        animateItem($("#" + z));
    }
} 
```

# python - rijndael：在 C 和 Python 中加密/解密相同的数据

> ID：12661675
> 
> 赞同：2
> 
> 时间：2012-09-30T13:40:20.117
> 
> 标签：python, c, encryption, rijndael

我试图弄清楚如何将加密/解密从现有的 C 函数镜像到 python。但是，在我用 C 加密和用 python 解密的测试中，我无法弄清楚密钥周围的一些元素。

这些都是在线代码示例，所以我评论了 Python 中的 base64 调用之类的东西，此时我不确定：

**1) 如果我正确确定了 KEYBIT 到 KEY_SIZE/BLOCK_SIZE 设置。**

**2）如何在python中获取密码以匹配C代码。**

**3）我是否缺少任何核心转换步骤？**

C中的rijndael.h：

```
#define KEYLENGTH(keybits) ((keybits)/8)
#define RKLENGTH(keybits)  ((keybits)/8+28)
#define NROUNDS(keybits)   ((keybits)/32+6) 
```

C中的加密

```
#define KEYBITS 256

unsigned long rk[RKLENGTH(KEYBITS)];
unsigned char key[KEYLENGTH(KEYBITS)];

char *password = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";

for (i = 0; i < sizeof(key); i++)
    key[i] = *password != 0 ? *password++ : 0;  

nrounds = rijndaelSetupEncrypt(rk, key, 256);

count = 0;
while (count < strlen(input)) {
    unsigned char ciphertext[16];
    unsigned char plaintext[16];
    for (i = 0; i < sizeof(plaintext); i++) {
        if (count < strlen(input))
            plaintext[i] = input[count++];
        else
            plaintext[i] = 0;
    }
    rijndaelEncrypt(rk, nrounds, plaintext, ciphertext);
    if (fwrite(ciphertext, sizeof(ciphertext), 1, output) != 1)             
        fclose(file);
        fputs("File write error", stderr);
        return 0;
    }
} 
```

在 Python 中解密

```
KEY_SIZE = 32
BLOCK_SIZE = 16

def decrypt(password, filename):

    #
    # I KNOW THIS IS WRONG, BUT HOW DO I CONVERT THE PASSWD TO KEY?
    #
    key = password

    padded_key = key.ljust(KEY_SIZE, '\0')

    #ciphertext = base64.b64decode(encoded)
    ciphertext = file_get_contents(filename);

    r = rijndael(padded_key, BLOCK_SIZE)

    padded_text = ''
    for start in range(0, len(ciphertext), BLOCK_SIZE):
        padded_text += r.decrypt(ciphertext[start:start+BLOCK_SIZE])

    plaintext = padded_text.split('\x00', 1)[0]

    return plaintext 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:46:04.413

`password`示例 C 代码仅将字符串中的32 个字节复制到键中。如果密钥小于 32 字节，则在右侧用零填充。翻译成python，这将是：

```
key = password[:32]+b'\x00'*(32-len(password)) 
```

这实际上产生了相同的结果

```
password.ljust(32, '\0') 
```

但是您应该注意，这种生成密钥的方法被认为是[*极其不安全*](http://bityard.blogspot.nl/2012/08/symmetric-crypto-with-pycrypto-part-3.html)的。如果攻击者怀疑密钥由用 0 字节填充的 ASCII 字符组成，则密钥空间（可能的密钥数量）会大大减少。如果密钥由随机字节组成，则有 256^32 = 1.15e77 个密钥。例如，如果密钥以 8 个 ASCII 字符后跟零开头，则只有 (127-32)^8 = 6.63e15 个可能的密钥。而且由于那里有带有常用密码的[字典](http://www.skullsecurity.org/wiki/index.php/Passwords)，攻击者可能不必用尽这个减少的密钥空间。他会先尝试相对较小的字典。

考虑使用[加密散列函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)或其他适当的[密钥派生函数](http://en.wikipedia.org/wiki/Key_derivation_function)将密码短语转换为密钥。

尝试使用[pycrypto](https://www.dlitz.net/software/pycrypto/)工具包。它实现[了 Rijndael/AES 和其他密码](https://www.dlitz.net/software/pycrypto/doc/#crypto-cipher-encryption-algorithms)。

# c# - 标签在鼠标中键单击时关闭

> ID：12661683
> 
> 赞同：0
> 
> 时间：2012-09-30T13:41:56.143
> 
> 标签：c#, .net, windows, tabs

这是默认的 Windows 行为（我认为是这样）。问题是，即使我的 .net 应用程序的选项卡在中键单击时也会关闭！我如何至少在我的应用程序中摆脱它们？

# c# - 是什么导致 FileHelpers 错误：System.Data.DataTable 是在未引用的程序集中定义的？

> ID：12661684
> 
> 赞同：1
> 
> 时间：2012-09-30T13:41:57.540
> 
> 标签：c#, csv, datatable, filehelpers

我正在尝试使用`FileHelpers CsvEngine.CsvToDataTable`.
结果，我收到一条错误消息，告诉我以下内容：

> *'System.Data.DataTable' 类型是在未引用的程序集中定义的。您必须添加对程序集“System.Data，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”的引用。*

我正在使用 .Net 3.5 为 Windows CE 设备开发。据我了解`CsvEngine.CsvToDataTable`需要.net 2.0

所以我的问题是：

1.  是否有`Filehelper`适用于 .Net 3.5 的版本，或者我是否必须将所有项目迁移到 .Net 2.0？
2.  什么（参考您知道的任何库）对于将 CSV 转储到数据表很有用`CsvToDatatable`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T17:27:10.433

1.  您应该能够在 3.5 项目中引用 2.0 dll。 [http://msdn.microsoft.com/en-us/library/bb383796%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/bb383796%28v=vs.90%29.aspx)
2.  你可以试试[https://github.com/JoshClose/CsvHelper](https://github.com/JoshClose/CsvHelper)

# openstreetmap - 2 种不同的传单弹出样式

> ID：12661685
> 
> 赞同：2
> 
> 时间：2012-09-30T13:42:03.503
> 
> 标签：openstreetmap, leaflet

Leaflet中的弹出窗口是否可以有2种不同的样式？用户交互时将触发 2 个不同的弹出窗口（在样式和内容方面），一个 on`mouseover`和一个 on `click`。

**问题：**我尝试`.leaflet-popup-content-wrapper'`在适用于一种弹出样式的样式表中覆盖 CSS 样式，但无法在运行时切换 CSS 样式以在两种 CSS 样式之间来回切换，可能是因为尚未加载弹出 DOM 元素.

```
marker.on('mouseover', function() {
    marker.bindPopup('<b>Hello world</b>');
    marker.openPopup();
})

marker.on('click', function() {
    marker.bindPopup('<b>Click click</b>');
    marker.openPopup();

    // Failed attempt to switch style
    $('.leaflet-popup-content-wrapper').addClass('new-style');
}) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T18:53:47.770

该`bindPopup`方法可以传递一个`"options"`参数，该参数可以包含一个`"className"`属性，该属性将添加到弹出窗口的 div 中：

```
marker.on('mouseover', function() {
    marker.bindPopup('<b>Hello world</b>',{className: 'mouseover-popup'});
    marker.openPopup();
})

marker.on('click', function() {
    marker.bindPopup('<b>Hello world</b>',{className: 'click-popup'});
    marker.openPopup();
}) 
```

# c - 如何评估这些表达式？

> ID：12661686
> 
> 赞同：0
> 
> 时间：2012-09-30T13:42:03.257
> 
> 标签：c, boolean-logic

整数 a = 17 (=10001)

诠释 b=5 (101)

```
a&b      1         bitwise AND
a|b     21         bitwise OR
a^b     20         XOR (16+4) “just one”
a&&b     1         logical AND
a||b     1         logical OR
-b      -5         minus b
~b       -6         ?
~(~a)      17        ?
!b       0         logical “NOT B”
!(!a))   1         logical “NOT NOT A”
a=b      0         “a==b?”
a=’A’   65         ?
a|’@’   64         ? 
```

你能帮我解释一下在哪里吗？是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:45:45.327

`-`是一元负数。假设没有溢出，它只取值的负数。负5显然是'-5'。

`~`是按位补码。我建议你查一下它是如何工作的。在二进制补码中，`~x`等价于`-x - 1`。而对于`~(~a)`，显然补码的补码就是原数。

对于最后两个，您只是将一个字符视为一个数字。这只是使用字符的 ascii 值。'A' 的值是 65，但我非常怀疑你的老师希望你把它们都记住。你可能会得到一个ASCII表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T13:46:25.710

假设 a = 17（10001 二进制）和 b = 5（101 二进制），我们有：

```
a&b      1         bitwise AND
a|b     21         bitwise OR
a^b     20         XOR (16+4) “just one”
a&&b     1         logical AND
a||b     1         logical OR
-b      -5         minus b
~b       -6         bitwise NOT 
~(~a)      17        bitwise NON NOT - the same as a
!b       0         logical “NOT B”
!(!a))   1         logical “NOT NOT A”
a=b      5         assignment to a the value of b
a='A'   65         assignment to a the ASCII value of char 'A'
a|'@'   81         a OR ASCII value of char '@' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T13:49:17.423

```
~b       -6         ? 
```

“~”翻转所有位，负数使用称为[2s 补码](http://en.wikipedia.org/wiki/2s_complement)的东西表示。-6 正是翻转“5”的所有位时发生的情况：您得到不同的位模式，与 2s 补码中的“-6”位相同。

```
~(~a)      17        ? 
```

相似的。翻转所有位，然后再次翻转所有位，你会得到什么？和以前一样。

```
a=’A’   65         ? 
```

在内部，字符由数字表示，就像计算机中的其他所有内容一样。实际上，今天使用的所有这些数字<->字符表都是基于[ASCII](http://en.wikipedia.org/wiki/ASCII)的，而“A”恰好在 ASCII 表中具有数字 65。

```
a|’@’   64         ? 
```

那没有意义。'@' 是 64（同样是 ASCII），即十六进制 0x40。0x40 | 17 应该是 81。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-30T13:44:58.587

运算符是按位 NOT，这`~`意味着 的所有位`int`都被反转。对数字的影响取决于类型和实现。

`|`运算符是按位或。`int`在 C 中，将a 与 a进行 OR 是完全有效的`char`，就像在 a|'A' 中所做的那样。那么的值`char`就是 ASCII 数字。

`=`运算符是赋值。分配的结果是已分配的任何内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-30T13:46:30.533

```
~b - binary NOT b
~(~a) - binary NOT ( NOT a )
a='@' - assign the int value of '@' to a
a|'A' - bitwise OR with the int value of 'A' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-30T13:46:48.023

*   `=`: 赋值运算符。
*   `~`：位`NOT`运算符（每个位的逻辑否定）。
*   `|`：位`OR`运算符（逻辑包含`OR`在每个位上）。

# php - codeigniter s3 图像上传在本地工作，但不适用于生产

> ID：12661688
> 
> 赞同：0
> 
> 时间：2012-09-30T13:42:11.707
> 
> 标签：php, codeigniter, file-upload, amazon-s3, image-uploading

我有一个名为**photos_model.php**的模型，它负责将图像上传到 s3 的后端工作

这是上传到 s3 的函数

```
public function uploadPhoto($photo){
    $this->load->model("misc_model");

    //required vars
    $tmp_name = $photo["tmp_name"];
    $name = $photo["name"];
    $type = $photo["type"];
    $size = $photo["size"];
    $error_upload = $photo["error"];

    $random_str = $this->misc_model->generateRandomNumber(20, true, true);

    $this->s3->putBucket($this->config->item("bucket"), S3::ACL_PUBLIC_READ);

    if($this->s3->putObjectFile($tmp_name, $this->config->item("bucket") , 'photos/'.$random_str.".jpg", S3::ACL_PUBLIC_READ) ){
        echo 'ok';
    }else{
        echo 'fail';
    }

} 
```

**s3 库：**

取自这里[http://net.tutsplus.com/tutorials/php/how-to-use-amazon-s3-php-to-dynamically-store-and-manage-files-with-ease/](http://net.tutsplus.com/tutorials/php/how-to-use-amazon-s3-php-to-dynamically-store-and-manage-files-with-ease/)

这将适用于我的本地机器 MAC OS X Lion

**但是当我在亚马逊 ec2 机器**上尝试脚本时，它根本不打印任何东西......就像什么都没有......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T20:49:46.067

**解决方案：**

它总是error_log ...它正在报告`PHP Fatal error: Call to undefined function imagecreatefromjpeg()`，所以我安装了GD库，我们很好

# zend-framework2 - Zend Framework 2 搜索 Lucene？

> ID：12661693
> 
> 赞同：7
> 
> 时间：2012-09-30T13:42:49.840
> 
> 标签：zend-framework2, zend-search-lucene

ZF1 有一个很好的搜索 lucene 实现。ZF2有类似的东西吗？我什么都找不到...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-30T14:57:32.347

它是 ZendSearch 的一部分，你可以在这里找到它[https://github.com/zendframework/ZendSearch](https://github.com/zendframework/ZendSearch)

如果您向下钻取文件夹，您会找到 Lucene，但您可能需要按照我链接到的第一页上的自述文件中的说明安装整个东西。

或者，您可以 cd 进入您的供应商目录并运行：-

```
git clone https://github.com/zendframework/ZendSearch.git 
```

这将创建 ZendSearch 模块，然后您可以将其添加到 application.config.php 中的模块列表中

另请参阅[Zend Framework 包存储库](http://packages.zendframework.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-17T13:36:06.760

**这适用于 Zend Framework 3 / Zend Search**

以下代码将帮助您开始使用 Zend Search：

```
use ZendSearch\Lucene\Lucene;
use ZendSearch\Lucene\Document;
use ZendSearch\Lucene\Document\Field;
use ZendSearch\Lucene\MultiSearcher;

$index = Lucene::create($path_to_index); // or use open to update an index
$document = new Document;
$document->addField(Field::Text($key,$value));
$index->addDocument($document);

$search = Lucene::open($path_to_index);
$search->find($str); 
```

然而值得注意的是，在编写 Zend Search 时，期望 ErrorHandler:: 可用，它是 Zend 的 Stdlib 的一部分。我相信这已从 stdlib 中删除，所以我只是用 try/catch 块替换了这些调用。

除了上面的例子——ZF v1 手册中的代码在功能方面提供了一个很好的基础：[https](https://framework.zend.com/manual/1.12/en/zend.search.lucene.overview.html) ://framework.zend.com/manual/1.12/en/zend.search.lucene.overview.html .

# java - Maven 不会在 Eclipse 中自动构建默认文件夹路径

> ID：12661695
> 
> 赞同：2
> 
> 时间：2012-09-30T13:43:14.083
> 
> 标签：java, eclipse, maven, eclipse-indigo

我正在使用 Eclipse 靛蓝。我在eclipse上安装了maven包。我配置了 Pom，几乎一切都很好。只是 maven 没有构建默认文件夹浴

> 源/主/java

![在此处输入图像描述](../Images/a115daf30fe9f16f65217051184dea6e.png)

这是pom。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>TestProject</groupId>
  <artifactId>TestProject</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>
   <dependencies>
   <dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-log4j12</artifactId>
    <version>1.5.6</version>
    </dependency>
        <dependency>
    <groupId>com.lowagie</groupId>
    <artifactId>itext</artifactId>
    <version>2.0.7</version>
        </dependency>
   </dependencies>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
              <source>1.6</source>
              <target>1.6</target>
            </configuration>
          </plugin>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-eclipse-plugin</artifactId>
            <version>2.6</version>
            <configuration>
              <ajdtVersion>1.6</ajdtVersion>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </project> 
```

我清理了项目，安装并构建了它......我还升级了项目......依赖关系都很好......根本没有错误......为什么文件夹没有构建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:55:36.683

Eclipse 与 maven 的集成（至少可以这么说）令人震惊。如果要创建一个新项目：创建 pom 和文件夹，然后运行 ​​mvn eclipse:eclipse 为 eclipse 创建项目文件。我使用了几年的简单解决方案是使用[Intellij 的社区版](http://www.jetbrains.com/idea/download/)。

* * *

回答你的第二个问题：嗯......再次，集成太差了，有时你需要关闭并重新打开项目以供 Eclipse 阅读新的更改。大多数情况下，刷新 + 清理项目会强制 eclipse 读取项目配置。

# python - 为什么 urllib.urlopen() 只工作一次？- Python

> ID：12661703
> 
> 赞同：1
> 
> 时间：2012-09-30T13:44:21.487
> 
> 标签：python, web-crawler, urllib2, urllib

我正在编写一个爬虫来使用`urllib`.

get_page 函数工作 1 个周期，但是当我尝试循环它时，它不会将内容打开到我输入的下一个 url。

*   **我如何使`urllib.urlopen`连续下载 HTML 页面？**
*   *如果不可能，是否有任何其他建议可以在我的 python 代码中下载网页？*

我下面的代码只返回列表中第一个网站的 html `seed`：

```
import urllib
def get_page(url):
    return urllib.urlopen(url).read().decode('utf8')

seed = ['http://www.pmo.gov.sg/content/pmosite/home.html', 
            'http://www.pmo.gov.sg/content/pmosite/aboutpmo.html']    

for j in seed:
      print "here"
      print get_page(j) 
```

同样的抓取“一次性”问题也发生在`urllib2`：

```
import urllib2
def get_page(url):
    req = urllib2.Request(url)
    response = urllib2.urlopen(req)
    return response.read().decode('utf8')

seed = ['http://www.pmo.gov.sg/content/pmosite/home.html', 
            'http://www.pmo.gov.sg/content/pmosite/aboutpmo.html']    

for j in seed:
      print "here"
      print get_page(j) 
```

没有例外，我得到一个带有 urllib 的 IOError：

```
Traceback (most recent call last):
  File "/home/alvas/workspace/SingCorp/sgcrawl.py", line 91, in <module>
    print get_page(j)
  File "/home/alvas/workspace/SingCorp/sgcrawl.py", line 4, in get_page
    return urllib.urlopen(url).read().decode('utf8')
  File "/usr/lib/python2.7/urllib.py", line 86, in urlopen
    return opener.open(url)
  File "/usr/lib/python2.7/urllib.py", line 207, in open
    return getattr(self, name)(url)
  File "/usr/lib/python2.7/urllib.py", line 462, in open_file
    return self.open_local_file(url)
  File "/usr/lib/python2.7/urllib.py", line 476, in open_local_file
    raise IOError(e.errno, e.strerror, e.filename)
IOError: [Errno 2] No such file or directory: 'http://www.pmo.gov.sg/content/pmosite/aboutpmo.html' 
```

没有例外，我得到一个带有 urllib2 的 ValueError：

```
Traceback (most recent call last):
  File "/home/alvas/workspace/SingCorp/sgcrawl.py", line 95, in <module>
    print get_page(j)
  File "/home/alvas/workspace/SingCorp/sgcrawl.py", line 7, in get_page
    response = urllib2.urlopen(req)
  File "/usr/lib/python2.7/urllib2.py", line 126, in urlopen
    return _opener.open(url, data, timeout)
  File "/usr/lib/python2.7/urllib2.py", line 392, in open
    protocol = req.get_type()
  File "/usr/lib/python2.7/urllib2.py", line 254, in get_type
    raise ValueError, "unknown url type: %s" % self.__original
ValueError: unknown url type: http://www.pmo.gov.sg/content/pmosite/aboutpmo.html 
```

**回答：**

发生 IOError 和 ValueError 是因为存在某种 Unicode 字节顺序标记 (BOM)。在第二个 URL 中发现了一个不间断空格。感谢您为解决问题提供的所有帮助和建议！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T14:47:56.833

您的代码令人窒息`.read().decode('utf8')`。

但是您不会看到这一点，因为您只是在吞咽异常。 `urllib`“不止一次”工作正常。

```
import urllib

def get_page(url):
    return urllib.urlopen(url).read()

seeds = ['http://www.pmo.gov.sg/content/pmosite/home.html', 
            'http://www.pmo.gov.sg/content/pmosite/aboutpmo.html']    

for seed in seeds:
      print 'here'
      print get_page(seed) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T14:52:03.803

你的两个例子对我来说都很好。对于您的确切错误，我能想到的唯一解释是，第二个 URL 字符串包含某种不可打印的字符（可能是 Unicode BOM），这些字符在将代码粘贴到此处时被过滤掉了。尝试将代码从该站点复制回您的文件中，或者从头开始重新键入整个第二个字符串。

# android - 使用简单适配器在带有图像和文本的列表视图中设置 OnClickListener？

> ID：12661705
> 
> 赞同：1
> 
> 时间：2012-09-30T13:44:38.577
> 
> 标签：android, listview, onclick, onclicklistener, simpleadapter

我使用 android 中的简单适配器制作带有图像和文本的列表视图。但我厌倦了让 OnClickListener 使用意图切换其他活动。例如，我点击印度，活动切换到 IndiaActivity.java 等...请帮助我..谢谢！（对不起英语不好）

我的代码：

```
public class MainActivity extends Activity {

    // Array of strings storing country names
    String[] countries = new String[] {
        "India",
        "Pakistan",
        "Sri Lanka",
        "China",
        "Bangladesh",
        "Nepal",
        "Afghanistan",
        "North Korea",
        "South Korea",
        "Japan"
    };

    // Array of integers points to images stored in /res/drawable-ldpi/
    int[] flags = new int[]{
        R.drawable.india,
        R.drawable.pakistan,
        R.drawable.srilanka,
        R.drawable.china,
        R.drawable.bangladesh,
        R.drawable.nepal,
        R.drawable.afghanistan,
        R.drawable.nkorea,
        R.drawable.skorea,
        R.drawable.japan
    };

    // Array of strings to store currencies
    String[] currency = new String[]{
        "Indian Rupee",
        "Pakistani Rupee",
        "Sri Lankan Rupee",
        "Renminbi",
        "Bangladeshi Taka",
        "Nepalese Rupee",
        "Afghani",
        "North Korean Won",
        "South Korean Won",
        "Japanese Yen"
    };

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Each row in the list stores country name, currency and flag
        List<HashMap<String,String>> aList = new ArrayList<HashMap<String,String>>();

        for(int i=0;i<10;i++){
            HashMap<String, String> hm = new HashMap<String,String>();
            hm.put("txt", "Country : " + countries[i]);
            hm.put("cur","Currency : " + currency[i]);
            hm.put("flag", Integer.toString(flags[i]) );
            aList.add(hm);
        }

        // Keys used in Hashmap
       String[] from = { "flag","txt","cur" };

       // Ids of views in listview_layout
       int[] to = { R.id.flag,R.id.txt,R.id.cur};

       // Instantiating an adapter to store each items
       // R.layout.listview_layout defines the layout of each item
       SimpleAdapter adapter = new SimpleAdapter(getBaseContext(), aList, R.layout.listview_layout, from, to);

       // Getting a reference to listview of main.xml layout file
       ListView listView = ( ListView ) findViewById(R.id.listview);

       // Setting the adapter to the listView
       listView.setAdapter(adapter);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:01:20.937

```
listView.setOnItemClickListener(new OnItemClickListener() {

  public void onItemClick(AdapterView adapterView, View view, int position, long id) {
    SimpleAdapter adapter = (SimpleAdapter) adapterView.getAdapter();
    ListView currentLv = (ListView) view;

    Object item = adapter.getItem(position);
    //Do some more stuff here and launch new activity

  }
}); 
```

# html - 内容的文本越过页脚 div

> ID：12661708
> 
> 赞同：0
> 
> 时间：2012-09-30T13:44:49.660
> 
> 标签：html, css

我有以下 HTML 代码，如果我的 div 中有很多名为 content 的文本，则页脚 div 不会向下移动，并且文本会越过我的页脚 div。

要查看问题，请查看此链接[http://jsfiddle.net/LhzrQ/](http://jsfiddle.net/LhzrQ/)

你能告诉我如何解决这个问题吗？

```
 <div id="container" style="width:500px">

        <div id="header" style="background-color:#FFA500;">
            <h1 style="margin-bottom:0;">Main Title of Web Page</h1>
        </div>

        <div id="menu" style="background-color:#FFD700;height:200px;width:100px;float:left;">
            <b>Menu</b><br>
            HTML<br>
            CSS<br>
            JavaScript
        </div>

        <div id="content" style="background-color:#EEEEEE;width:400px;float:left;">
            HyperText Markup Language (HTML) is the main markup language for displaying web pages and other information that can be displayed in a web browser.
            HTML is written in the form of HTML elements consisting of tags enclosed in angle brackets (like <html>), within the web page content. HTML tags most commonly come in pairs like <h1> and </h1>, although some tags, known as empty elements, are unpaired, for example <img>. The first tag in a pair is the start tag, the second tag is the end tag (they are also called opening tags and closing tags). In between these tags web designers can add text, tags, comments and other types of text-based content. The purpose of a web browser is to read HTML documents and compose them into visible or audible web pages. The browser does not display the HTML tags, but uses the tags to interpret the content of the page.

        </div>

        <div id="footer" style="background-color:#FFA500;clear:both;text-align:center;">
            Copyright © W3Schools.com
        </div>

    </div>

</body> 
```

​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:46:28.367

您可以删除内容 div 的高度元素。

见：http: [//jsfiddle.net/LhzrQ/1/](http://jsfiddle.net/LhzrQ/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:47:00.450

工作[**小提琴**](http://jsfiddle.net/LhzrQ/8/)

删除`fixed height`到`content`div。它会起作用的。

# javascript - 用 mocha 测试 json.parse

> ID：12661711
> 
> 赞同：0
> 
> 时间：2012-09-30T13:45:12.853
> 
> 标签：javascript, node.js, mocha.js

为什么使用mocha进行测试时下面的代码没有通过？

我的示例模块：

```
module.exports = function(){
  JSON.parse("this is not json")
} 
```

和我的 test.js：

```
var should = require("should")
var module = require("./module")

describe("error testing", function(){
  it("should throw an error", function(done){
    module().should.throw();
    done();
  })
}) 
```

我希望测试能够通过，但运行 mocha 会给我以下信息：

```
✖ 1 of 1 tests failed:

1) error testing should throw an error:
   SyntaxError: Unexpected token h
    at Object.parse (native)
    at module.js:9:8
    at Context.<anonymous> (test.js:6:5)
    at Test.run (/usr/local/lib/node_modules/mocha/lib/runnable.js:145:15)
    at Runner.runTest (/usr/local/lib/node_modules/mocha/lib/runner.js:270:10)
    at /usr/local/lib/node_modules/mocha/lib/runner.js:314:12
    at next (/usr/local/lib/node_modules/mocha/lib/runner.js:198:14)
    at /usr/local/lib/node_modules/mocha/lib/runner.js:207:7
    at next (/usr/local/lib/node_modules/mocha/lib/runner.js:157:23)
    at Array.0 (/usr/local/lib/node_modules/mocha/lib/runner.js:175:5)
    at EventEmitter._tickCallback (node.js:192:40) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:19:58.480

should.throw() 期望在函数上调用，而不是函数的结果。改变这个：

```
module().should.throw(); 
```

对此：

```
module.should.throw(); 
```

# ruby - Unicorn / KGIO 无法在带有 ruby 1.9.3 的 Mountain Lion 上安装

> ID：12661712
> 
> 赞同：2
> 
> 时间：2012-09-30T13:45:14.087
> 
> 标签：ruby, gem, rvm, unicorn

主要错误信息是：

```
checking size of struct RFile in ruby.h,ruby/io.h... *** extconf.rb failed *** 
```

kgio 使用 RVM 在 ruby​​ 1.9.1 上成功安装，但在 ruby​​ 1.9.3 上失败。我在安装了 Xcode + 命令行工具的 Mountain Lion 上。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T16:09:33.813

这可能是 RVM 中的这个错误：[问题 #1157](https://github.com/wayneeseguin/rvm/issues/1157 "问题 #1157")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:42:40.313

啊。

没有找到根本原因，但现在使用`rbenv`代替`rvm`似乎已经修复了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T16:43:27.087

将 .rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb 的第 597 行更改为此将解决该问题：

返回整数（（v = f.gets）？v：0）

# javascript - etag 中的 Javascript 支持

> ID：12661713
> 
> 赞同：2
> 
> 时间：2012-09-30T13:45:17.750
> 
> 标签：javascript, emacs, etag

我使用 etags 从 javascript 源文件中为 emacs 生成一个 TAGS 文件。

标签中缺少某些功能。为什么 ？

javascript支持是否包括以下样式

```
ZmZimletBase.prototype.doubleClicked =
function(canvas) {
    this.createPropertyEditor();
}; 
```

提示：js-mode 的 js-find-symbole 也不支持这种风格，它会覆盖默认的 M-。查找标签的绑定。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T23:42:10.977

看看[jsctags](https://github.com/mozilla/doctorjs)。我没有使用它，所以我不确定它是否支持 emacs 和 vim。

# asp.net-mvc-3 - 在 ASP.Net Mvc 4 中渲染视图的特定部分

> ID：12661715
> 
> 赞同：0
> 
> 时间：2012-09-30T13:45:27.140
> 
> 标签：asp.net-mvc-3, razor, asp.net-mvc-4, sections

在 Asp.Net Mvc 中，当您在定义某些部分的布局中渲染视图时，视图中的所有部分都放置在您在布局文件中定义的正确部分中，

考虑一种情况，当您想在另一个视图中渲染一个视图（有一些部分），但是您放置在子视图部分的所有代码都没有在父视图中呈现（因为父视图不一定具有定义的部分） ) 因此只渲染未放置在任何部分中的视图部分，

现在我的问题是：是否可以使用方法 RenderPartial 或 RenderAction 呈现特定的视图部分？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-30T16:33:29.987

您可以将代码放在单独的视图中。您将能够使用`RenderPartial`. 如果您在 controll 中创建操作，您将能够使用`RenderAction`.

但是在您的代码中，您可以定义如下部分

```
@section MySection{
   @Html.RenderPartial(/*bla bla*/)
    } 
```

# javascript - Win8 JS 代码中的“结果”是什么： WinJS.xhr({urlhere}).done(function complete(result) { });

> ID：12661727
> 
> 赞同：1
> 
> 时间：2012-09-30T13:46:55.597
> 
> 标签：javascript, windows-8, microsoft-metro

请参见以下代码行：

```
WinJS.xhr({ url: "http://someurl.com" }).then(
          function fulfilled(result)
          {
             if (result.status === 200)
             {
                resDiv.style.backgroundColor = "lightGreen";
                resDiv.innerText = "Success";
             }
          }); 
```

据我了解，当 WinJS.xhr 完成它所做的一切**后**，执行带有参数“result”的匿名函数“fulfilled”

来自 Java/C++ 背景，我对这段代码的工作方式感到非常困惑——“结果”是如何传递给这个函数的？它在哪里说明了什么是“结果”？我如何知道什么类型的对象“结果”以及它如何具有“状态”成员？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T14:10:55.430

我将把我的答案分成两部分：第一部分涉及 Javascript 的实际执行模型，第二部分涉及编写的高级表达式。

## Javascript 执行模型

1.  `WinJS`评估为一个对象。
2.  该对象有一个原型，其中包含一个评估为的`xhr`成员。`WinJS.xhr`该成员是一个函数，我们将在`A`下面对其进行引用，以便我们清楚到底发生了什么。
3.  在我们开始之前，`{ url: "http://someurl.com" }`返回一个我们将称为 的对象`B`。
4.  该对象`B`有一个名为 的属性`url`。
5.  `A(B)``A`以值`B`作为参数调用函数。它*返回*一个我们将称为 的对象`C`。
6.  该对象`C`有一个原型，其中包含一个名为 的成员`then`。`C.then`碰巧评估为一个函数。该函数我们将称为`D`。
7.  `function fulfilled(result) {...}`返回一个我们将称为 的函数`E`。它也可以被称为，`fulfilled`但在这个程序片段中没有使用这个事实。
8.  `D(E)``D`以值`E`作为参数调用函数。没有对返回值做任何事情。

## 高层观点

这里有三个功能；一个是回调（称为`fulfilled`），另外两个可以称为“方法”——一个`xhr`是`WinJS`全局对象，`then`一个是 promise 对象。

`WinJS.xhr({ url: "http://someurl.com" })`创建并返回该[承诺对象](http://msdn.microsoft.com/en-us/library/windows/apps/br211867.aspx)。[您可以通过查阅文档](http://msdn.microsoft.com/en-us/library/windows/apps/br229787.aspx)来说服自己相信这一点。

Promise 对象有一个调用方法，该方法`then`注册您可以认为的事件处理程序，以便在 Promise*完成*时进行处理。`result`在注册的回调中使用的值`then`来自于通过实际上调用该承诺上的方法来*完成*`done`该承诺。您看不到执行此操作的代码，因为它位于`WinJS.xhr`.

正在做`WinJS.xhr`的是执行网络请求。当该网络请求*完成*时，它将通过调用该 Promise 上的方法通过该Promise发出该网络请求的结果（根据文档，它是一个[XMLHttpRequest](http://msdn.microsoft.com/en-us/library/ie/ms535874%28v=vs.85%29.aspx)`done()`对象） 。这反过来又调用了我们用该`then()`方法注册的回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:53:42.553

该[`xhr`方法](http://msdn.microsoft.com/en-us/library/windows/apps/br229787.aspx)返回一个[`Promise`对象](http://msdn.microsoft.com/en-us/library/windows/apps/br211867.aspx)，该对象具有采用,和回调函数的[`then`方法。](http://msdn.microsoft.com/en-us/library/windows/apps/br229728.aspx)`onComplete``onError``onProcress`

此代码仅使用`onComplete`回调。请求完成时调用回调，并发送一个参数，其中包含从服务器发送的值。

如果你不熟悉回调函数，如果你声明一个常规函数用作回调可能会更清楚：

```
function fulfilled(result) {
  if (result.status === 200) {
    resDiv.style.backgroundColor = "lightGreen";
    resDiv.innerText = "Success";
  }
}

WinJS.xhr({ url: "http://someurl.com" }).then(fulfilled); 
```

该`then`方法旨在预处理结果，您应该使用该[`done`方法](http://msdn.microsoft.com/en-us/library/windows/apps/hh701079.aspx)来处理结果。

我没有在文档中找到任何确切指定值来自服务器的形式的任何内容。它可能在某个地方，但与 Microsoft 文档一样，它相当完整，但并非所有内容都无处不在，因此您必须在不同的地方查找特定信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T13:54:53.893

IMO，WinJS 函数的文档仍然不是很好。您可以查看[http://msdn.microsoft.com/en-us/library/windows/apps/br229787.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/br229787.aspx)`WinJS.xhr`上的文档，这将为您提供一些相关信息 - 它说函数“wraps . .. 承诺中的 XMLHttpRequest 对象”。就个人而言，我发现查看示例/快速入门比查看参考文档更容易。`xhr`

您传递给`fulfilled`函数（或那里的第一个函数）的不是操作的“结果”，而是`XMLHttpRequest`对象本身。在那您可以获取它的属性以查看结果 - 请查看[http://msdn.microsoft.com/en-us/library/windows/apps/ms535874.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/ms535874.aspx)以供参考。

# python - 无法在 python 2.7 中将文件读取为二进制文件

> ID：12661729
> 
> 赞同：0
> 
> 时间：2012-09-30T13:47:06.170
> 
> 标签：python, file

```
file = open("images.jpeg", "rb")

c = file.read(512)
print(type(c))
print(c)

file.close() 
```

c 是一个 str 对象。它不应该是一个字节对象吗？根据医生的说法，应该是！

在 Python 3.2 中，它实际上是一个字节对象。Python2.7 发生了什么？

平台：Kubuntu 12.04 64 位

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:50:43.077

`bytes`是`str`Python 2.7中的别名

# jquery - 为什么在页面加载时执行转换？

> ID：12661735
> 
> 赞同：0
> 
> 时间：2012-09-30T13:47:26.243
> 
> 标签：jquery, css, css-transitions

我有一个导航菜单，它有一个过渡 CSS：

```
nav {
    height: 700px;
    width: 100%;
    background-color: rgb(158, 165, 177);
    position: relative;
    margin-top: -622px;
    -webkit-transition: margin .4s cubic-bezier(1,-0.29,.76,1.32);
       -moz-transition: margin .4s cubic-bezier(1,-0.29,.76,1.32);
        -ms-transition: margin .4s cubic-bezier(1,-0.29,.76,1.32);
         -o-transition: margin .4s cubic-bezier(1,-0.29,.76,1.32);
            transition: margin .4s cubic-bezier(1,-0.29,.76,1.32);

}

.show-nav {
    margin-top: -100px;
} 
```

我使用这个 jQuery 来触发它：

```
$('nav').click(function(e) {
    e.preventDefault();
    $(this).toggleClass('show-nav');
}); 
```

问题是每次页面加载时，我都会看到边距转换，就好像它有`show-nav`类然后被删除一样。

这是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:32:48.450

为什么不将转换放在 css 中的 .show-nav 声明中？

# ios - 更改 com.apple.wifi.plist 中的系统属性

> ID：12661737
> 
> 赞同：2
> 
> 时间：2012-09-30T13:47:45.777
> 
> 标签：ios, xcode, wifi, system, jailbreak

我一直在开发一个应用程序来以编程方式启用/禁用我的 iphone 的 Wi-Fi 接口。我曾尝试在我越狱的 Iphone 4s (iOS 5.1.1) 上使用 Apple 80211（苹果的私人服务）来使其工作。然而，事情并没有像我预期的那样顺利。我可以成功扫描并获取 Wi-Fi 连接状态，但是`Apple80211SetPower`启用/禁用 WiFi 的方法似乎不适用于 iOS 5。

正如我从 SBsetting 的 WiFi 切换中发现的那样，它可能还需要更改 WiFi 的系统属性`"/var/preferences/systemconfiguration/com.apple.wifi.plist"`。但是，我的应用程序无法更改该文件中的系统属性，我怀疑问题是由文件属性和所有权引起的。因此，我模仿了SBsetting的WiFi切换的文件属性，但它并没有改变任何东西。有谁知道我如何更改此文件的系统属性？这是我使用的代码。谢谢并恭祝安康

```
NSMutableDictionary *plistDict = 
   [NSMutableDictionary dictionaryWithContentsOfFile:@"/var/preferences/SystemConfiguration/com.apple.wifi.plist"];

BOOL wifiState = [[plistDict objectForKey:@"AllowEnable"] boolValue];
NSLog(wifiState ? @"Yes" : @"No");
if (value == YES) 
{
    [plistDict setValue:[NSNumber numberWithBool:YES] forKey:@"AllowEnable"];
    [plistDict writeToFile:@"/var/preferences/SystemConfiguration/com.apple.wifi.plist" 
                atomically: YES];
} 
else if (value== NO) 
{
    [plistDict setValue:[NSNumber numberWithBool:NO] forKey:@"AllowEnable"];
    [plistDict writeToFile:@"/var/preferences/SystemConfiguration/com.apple.wifi.plist" 
                atomically: YES];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T08:24:54.107

在我的手机（iOS 5.0.1，而不是 5.1.1）上，我在 SystemConfiguration 目录中看到了这个：

```
iPhone4:/var/preferences/SystemConfiguration mobile$ ls -altr
total 144
drwxr-xr-x 3 root wheel   136 Dec 25  2007 ..
-rw-r--r-- 1 root wheel   181 Jul 26  2009 OSThermalStatus.plist
-rw-r--r-- 1 root wheel    79 Jan 10  2012 com.apple.mobilegestalt.plist
-rw-r--r-- 1 root wheel    60 Sep 30 00:47 com.apple.radios.plist
-rw-r--r-- 1 root wheel  1162 Sep 30 15:50 NetworkInterfaces.plist
-rw-r--r-- 1 root wheel 57087 Sep 30 15:51 com.apple.network.identification.plist
-rw-r--r-- 1 root wheel   127 Oct  1 01:04 com.apple.PowerManagement.plist
-rw-r--r-- 1 root wheel  7323 Oct  1 01:18 preferences.plist
-rw-r--r-- 1 root wheel 31648 Oct  1 01:18 com.apple.wifi.plist
-rw-r--r-- 1 root wheel  1223 Oct  1 01:18 com.apple.AutoWake.plist
drwxr-xr-x 2 root wheel   374 Oct  1 01:18 . 
```

因此，看起来用户`mobile`（通常运行应用程序的用户）将无法写入该文件，只有读取权限。

您可以在此处查看[如何赋予您的应用`root`权限](https://stackoverflow.com/a/8796556/119114)。

# tfs - 基于 TFS 标签的 CC.NET Checkout

> ID：12661739
> 
> 赞同：0
> 
> 时间：2012-09-30T13:48:25.267
> 
> 标签：tfs, cruisecontrol.net

如何从 CruiseControl.NET 中的 Team Foundation Server 中提取基于构建标签的代码。

```
<sourcecontrol type="vsts" autoGetSource="true" applyLabel="true">
  <server>http://tfs.internal.com:8080/</server>
  <username>*********</username>
  <password>*********</password>
  <domain>corp</domain>
  <project>$/Code</project>
  <workingDirectory>D:\BuildServer\Lane1\SourceCode\</workingDirectory>
  <cleanCopy>false</cleanCopy>
</sourcecontrol> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T15:30:01.773

根据CruiseControl.NET TFS 插件[的文档](http://build.sharpdevelop.net/ccnet/doc/CCNET/Visual%20Studio%20Team%20Foundation%20Server%20Plugin.html)（来自 codeplex）：

```
<sourcecontrol type="vsts" autoGetSource="true" applyLabel="true">
  <server>http://my_team_foundation_server:8080</server>
  <username>my_user</username>
  <password>my_password</password>
  <domain>my_domain</domain>
  <project>$/Foobar</project>
  <workingDirectory>c:\projects\Foobar</workingDirectory>
  <cleanCopy>false</cleanCopy>
  <workspace>my_workspace_name</workspace>
  <deleteWorkspace>false</deleteWorkspace>
</sourcecontrol> 
```

我不认为这是一种选择。

我确实在此处查看了通用 TFS 源控制[块文档](http://build.sharpdevelop.net/ccnet/doc/CCNET/VSTS%20Team%20Foundation%20Server%20Source%20Control%20Block.html)，您可以将其用作将标签作为参数传递给可执行文件的一种方式。我从来没有用 Visual Studio 尝试过，但也许你可以弄清楚如果你可以使用 dynamicValues 作为参数来针对编译器指定你的标签。如果不是，我认为 CruiseControl.NET 不能支持这些 TFS 功能。

# c# - 对服务器的 FTP 请求无法连接远程服务器

> ID：12661744
> 
> 赞同：0
> 
> 时间：2012-09-30T13:50:05.363
> 
> 标签：c#, ftp

我在这里找到了许多类似的文章，但仍然没有解决我的问题。我正在尝试将文本文件上传到 ftp 服务器。我使用了多种方法，所有方法都出现相同的错误：“无法连接到远程服务器”

Method1：filename为文件所在的完整路径

```
 private string Upload(string ftpServer, string userName, string password, string filename)
    {
        string reply = "Success";
        try
        {
            using (System.Net.WebClient client = new System.Net.WebClient()) //System.Net.WebClient client = new System.Net.WebClient()
            {
                client.Credentials = new System.Net.NetworkCredential(userName, password);
                client.Proxy = new WebProxy();
                FileInfo fi = new FileInfo(filename);
                client.UploadFile(ftpServer + "//" + fi.Name, "STOR", filename);
            }
        }
        catch (Exception ex)
        {
            reply = ex.Message;
        }
        return reply;
} 
```

方法2：

filename = "D:\folder\file.txt" public static void uploadFileUsingFTP(string filename) { FileInfo fileInf = new FileInfo(filename); 字符串 uri = "ftp://" + serverIP + "/" + fileInf.Name;

```
 FtpWebRequest reqFTP; 
            // Create FtpWebRequest object from the Uri provided
            reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(uri));
            reqFTP.Proxy = null;
            // Provide the WebPermission Credintials
            reqFTP.Credentials = new NetworkCredential(user, pass); 

            // By default KeepAlive is true, where the control connection is not closed
            // after a command is executed.
            reqFTP.KeepAlive = false; 

            // Specify the command to be executed.
            reqFTP.Method = WebRequestMethods.Ftp.UploadFile; 

            // Specify the data transfer type.
            reqFTP.UseBinary = true; 

            // Notify the server about the size of the uploaded file
            FileStream fs = File.OpenRead(filename); 
            reqFTP.ContentLength = fileInf.Length; 
            // The buffer size is set to 2kb
            int buffLength = Convert.ToInt32(fs.Length);
            byte[] buff = new byte[buffLength];
            int contentLen; 

            try
            {
                // Stream to which the file to be upload is written
                Stream strm = reqFTP.GetRequestStream(); 

                // Read from the file stream 2kb at a time
                contentLen = fs.Read(buff, 0, buffLength); 

                // Till Stream content ends
                while (contentLen != 0)
                {
                    // Write Content from the file stream to the FTP Upload Stream
                    strm.Write(buff, 0, contentLen);
                    contentLen = fs.Read(buff, 0, buffLength);
                } 

                // Close the file stream and the Request Stream
                strm.Close();
                fs.Close();
            }

            catch (Exception ex)
            {
                string s = ex.Message;
            }

        } 
```

方法3：

```
 public static void Sample(string filename)
        {

            // Get the object used to communicate with the server.
            FtpWebRequest request = (FtpWebRequest)WebRequest.Create("ftp://serverip/"); //test.htm
            request.Method = WebRequestMethods.Ftp.UploadFile;

            // This example assumes the FTP site uses anonymous logon.
            request.Credentials = new NetworkCredential (user,passs);

            try
            {
                // Copy the contents of the file to the request stream.
                StreamReader sourceStream = new StreamReader(filename);
                byte[] fileContents = Encoding.UTF8.GetBytes(sourceStream.ReadToEnd());
                sourceStream.Close();
                request.ContentLength = fileContents.Length;

                request.Proxy = null;

                Stream requestStream = request.GetRequestStream();
                requestStream.Write(fileContents, 0, fileContents.Length);
                requestStream.Close();

                FtpWebResponse response = (FtpWebResponse)request.GetResponse();

                Console.WriteLine("Upload File Complete, status {0}", response.StatusDescription);

                response.Close();
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
            }

            Console.ReadLine();

        } 
```

使用它们中的每一个都会导致相同的问题，是的，我可以使用 filezilla 连接到 ftp 并传输文件。

我知道我一定错过了一些非常愚蠢的东西，但这花了我很多时间。任何建议都会受到重视。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:26:44.547

连接问题可能很麻烦。像[WireShark](http://www.wireshark.org/)这样的工具可以在跟踪问题方面提供很大帮助，例如在尝试主动与被动模式 FTP 传输时。

我一直在使用以下代码，效果很好：

```
 bool result = false;
        long length = 0;
        // Set up the FTP upload.
        //   The URI for the request specifies the protocol, the server and the filename.
        FtpWebRequest ftpRequest = (FtpWebRequest)WebRequest.Create("ftp://" + ftpServerUrl + "/" + targetFilename);
        ftpRequest.EnableSsl = false;
        ftpRequest.KeepAlive = true;
        ftpRequest.ReadWriteTimeout = ftpTimeout; // To perform an individual read or write.
        ftpRequest.Timeout = ftpTimeout; // To establish a connection or start an operation.
        ftpRequest.Credentials = new NetworkCredential(ftpUsername, ftpPassword);
        ftpRequest.Method = WebRequestMethods.Ftp.UploadFile;
        ftpRequest.UseBinary = true;
        ftpRequest.UsePassive = true;

        // Upload the file.
        using (FileStream fileStream = File.OpenRead(filename))
        {
            using (Stream ftpStream = ftpRequest.GetRequestStream())
            {
                fileStream.CopyTo(ftpStream);
                length = fileStream.Length;
                ftpStream.Close();
            }
            FtpWebResponse ftpResponse = (FtpWebResponse)ftpRequest.GetResponse();
            if (ftpResponse.StatusCode == FtpStatusCode.ClosingData)
                result = true;
            else
                throw new Exception(ftpResponse.StatusDescription + " (" + ftpResponse.StatusCode + ")");
            ftpResponse.Close();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T04:29:22.240

已经在另一个帖子中回复了，但在这里也重复了。我遇到了同样的问题，这是我的解决方案。

```
request.Credentials = new NetworkCredential(
    usernameVariable.Normalize(),passwordVariable.Normalize(),domainVariable.Normalize()); 
```

详细信息可以在[这里找到](http://www.godwinpaul.com/sharepoint/2013/ftp-c-error-the-remote-server-returned-an-error-530-not-logged-in)

希望它可以帮助某人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-13T18:21:13.620

添加以下内容`web.config`让您的 FtpWebRequest 使用默认代理

```
<defaultProxy enabled="true" useDefaultCredentials="true">
</defaultProxy> 
```

# javascript - 从下拉 onchange 菜单运行多个 Javascript 函数

> ID：12661747
> 
> 赞同：0
> 
> 时间：2012-09-30T13:50:41.980
> 
> 标签：javascript, html

假设我有不同的JS函数......

```
function stores(NY)
{
blah, blah, blah...
}
function stores(CA)
{
blah, blah, blah...
}
function stores(FL)
{
blah, blah, blah...
} 
```

我希望从这个下拉菜单中运行它们......

```
<select onchange="stores(this.value);">
<option>Please select your state from this list...</option>
<option value="NY">New York</option>
<option value="CA">California</option>
<option value="FL">Florida</option>
</select> 
```

等等多达 50 个美国州，这就是为什么我需要一种简单的方法来调用这些函数，但这不起作用。任何想法将不胜感激。先谢谢大家了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:54:23.700

最简单的方法是创建一个对象字面量，其*键值*对中的键是调用函数的名称。

```
var methods = {
    "NY": function() {},
    "CA": function() {},
    "FL": function() {}
};

element.onchange = function() {
    methods[ this[ this.selectedIndex ].value ]();
}; 
```

这个概念摆脱了 if 和 case 语句，并且是面向对象的。我们以编程方式发出事件处理程序并根据元素选定索引的值调用函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T13:54:10.993

你只需要一个功能。

```
function stores(city) {
  if (city === 'NY') {
    //blah, blah, blah...
  } else if (city === 'CA') {
    //blah, blah, blah...
  } else if (...) {
    // ... and so on
  }
  // ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T13:55:07.403

你可以通过开关盒做到这一点

```
function stores(city) {

switch(city){
 case 'NY':
    //your stuf
    break;
  case 'CA':
    //your stuf
   break;
  case 'FL':
    //your stuf
   break;
 default:
   code to be executed if n is different from above all case
  }

} 
```

# ejb-3.0 - 从 JBoss AS 7.1.1 上的 Servlet 调用部署在 GlassFish 3.1 上的 EJB 3

> ID：12661750
> 
> 赞同：3
> 
> 时间：2012-09-30T13:51:06.613
> 
> 标签：ejb-3.0, glassfish-3, jboss7.x, initial-context

我在 GlassFish 3.1 上部署了一个带有远程接口的简单会话 EJB（3.0 规范）。这是显示部署的日志片段：

```
INFO: Portable JNDI names for EJB RandomNumber2Bean : [java:global/RandomNumberEJB/RandomNumber2Bean, java:global/RandomNumberEJB/RandomNumber2Bean!beans.RandomNumber2]
INFO: Glassfish-specific (Non-portable) JNDI names for EJB RandomNumber2Bean : [RandomNumber2, RandomNumber2#beans.RandomNumber2] 
```

我试图从部署在同一台机器上的 JBoss AS 7.1.1 实例上的 Servlet 调用它。以下是来自 servlet 的相关代码：

```
Properties props = new Properties();
props.setProperty("java.naming.factory.initial", "com.sun.enterprise.naming.impl.SerialInitContextFactory");
props.setProperty("java.naming.factory.url.pkgs", "com.sun.enterprise.naming");
props.setProperty("java.naming.factory.state", "com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl");
InitialContext initialContext = new javax.naming.InitialContext(props);
RandomNumber2 randomNumber2 = (RandomNumber2) initialContext.lookup("RandomNumber2"); 
```

但是，每当我尝试从 servlet 获取 InitialContext 来查找 bean 时，都会收到以下错误：

```
javax.naming.NamingException: JBAS011843: Failed instantiate InitialContextFactory com.sun.enterprise.naming.SerialInitContextFactory from classloader ModuleClassLoader for Module "deployment.RandomNumberTesterGlassfish.war:main" from Service Module Loader
at org.jboss.as.naming.InitialContextFactoryBuilder.createInitialContextFactory(InitialContextFactoryBuilder.java:64)
at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:681)
at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:307)
at javax.naming.InitialContext.init(InitialContext.java:242)
at javax.naming.InitialContext.<init>(InitialContext.java:216)
at test.RandomNumberServlet.doGet(RandomNumberServlet.java:32)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:734)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)
at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671)
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930)
at java.lang.Thread.run(Thread.java:722) 
```

我已将来自 GlassFish 的客户端 jar appserv-rt.jar 和 gf-client.jar 添加到客户端 Servlet 应用程序的构建路径（我使用 Eclipse Juno 来部署它）和`%JBOSS_HOME%\standalone\lib\ext`目录中。

我在网上找不到任何东西，甚至提到从 JBoss AS 7.1.1 调用部署在 GlassFish 3.1 上的 EJB。在这一点上，我完全不知所措。我能够使用独立客户端调用部署在 GlassFish 上的 EJB，并且能够从独立客户端和 GlassFish 调用部署在 JBoss 上的相同 EJB。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T09:47:07.560

它写在日志中：“Glassfish-specific (Non-portable) JNDI names”。因此，它可能不适用于 JBoss。试试这个：

```
RandomNumber2 randomNumber2 = (RandomNumber2) initialContext.lookup("java:global/RandomNumberEJB/RandomNumber2Bean"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-12T08:15:33.693

我认为您无法在 Jboss AppServer 中加载 GlassFish 本机库。我`props.setProperty("java.naming.factory.initial", "com.sun.enterprise.naming.impl.SerialInitContextFactory");`在三个 AppServer 中测试配置：GlassFish 3、Jboss 7 和 WebSphere 8。正确运行应用程序的唯一应用程序服务器是 Glassfish。（因为`com.sun.enterprise.naming.impl.SerialInitContextFactory`）

您应该在 GlassFish 中运行您的应用程序。这是完整的配置：

```
 Properties props = new Properties();
        props.setProperty("java.naming.factory.initial",
                "com.sun.enterprise.naming.SerialInitContextFactory");

        props.setProperty("java.naming.factory.url.pkgs",
                "com.sun.enterprise.naming");

        props.setProperty("java.naming.factory.state",
                "com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl");

        props.setProperty("org.omg.CORBA.ORBInitialHost", "IP");
        props.setProperty("org.omg.CORBA.ORBInitialPort", "3700");

        InitialContext context = new InitialContext(props);
        RandomNumber2 randomNumber2 =(RandomNumber2)context.lookup("RandomNumber2"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T13:02:17.807

您也可以尝试设置以下属性吗

```
props.setProperty("org.omg.CORBA.ORBInitialHost", "localhost");
props.setProperty("org.omg.CORBA.ORBInitialPort", "3700"); 
```

# ruby-on-rails - 在 Rails 数据库中使用 user_id 的三种方法，哪一种最好？

> ID：12661757
> 
> 赞同：0
> 
> 时间：2012-09-30T13:52:21.793
> 
> 标签：ruby-on-rails

我有一个链接到数据库表的 Rails 应用程序，其中包含电子邮件地址和密码。我想创建一个唯一编号，用于识别系统中的每个用户。该号码将在注册时提供给用户，并存储在同一张表的 user_id 字段中。因此，例如，john@foo.bar 可以得到 0001 作为 ID，martha@foo.bar 可以得到 0002，依此类推。我的问题是：最好的方法是什么？我是否应该使用第一个 user_id (0001) 为数据库 (rake db:seed) 播种，并在控制器中编写一个方法来每次 +1 user_id？如果是这种情况，我如何访问最后一行以找出最后一个 user_id？

另一种方法是在表中找到最大的 user_id 并将其 +1。为此，我想我需要使用 tablename.find_by_user_id 或类似的东西（tablename.find_by_user_id.max 会起作用吗？）

第三种方法是将最新的 user_id 存储在某处，并让应用程序在需要时检索它。这些信息可以存储在哪里？

我对 rails 很陌生。非常感谢您对哪种方法最好的反馈。

谢谢， TimmyOnRails

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T14:18:34.550

假设您的模型有两个属性名称和电子邮件。现在默认情况下，rails 将为您生成另外三列

1 id - 自动增量

2 created_at 和 updated_at - 时间戳

如果您想预填充数据库，Rake db:seed 是一种很好的解决方案。您只需要担心姓名和电子邮件。为这些属性添加适当的验证。Rest rails 将处理，即 id 由 rails 本身维护。你不必担心它。Created_at 和 updated_at 列也由 rails 维护。

如果您是 Rails 新手，那么我建议您查看[http://railsforzombies.com](http://railsforzombies.com)，这会让您对活动记录有一个很好的了解

Railsguides 和 RailsCasts 也是 Rails 的另外两种学习材料。

# php - 当我没有登录我的 vbulletin 论坛时，为什么弹出窗口会被弹出窗口阻止程序阻止？

> ID：12661758
> 
> 赞同：0
> 
> 时间：2012-09-30T13:52:25.563
> 
> 标签：php, javascript, popup-blocker

我正在为我的网站使用 vBulletin 论坛，并且正在设计一个应用程序。**在我的应用程序中，javascript 使用window.open()** javascript 方法打开一个弹出窗口。此时我必须在我的应用程序中打开弹出窗口，因为我不想松开当前加载的网页。当我登录我的论坛时，一切正常。

**但是当我没有登录到我的论坛时，执行window.open()**时 javascript 不会打开弹出窗口。每次我尝试执行 JavaScript 代码时，弹出窗口阻止程序都会阻止弹出**窗口打开。**

为什么我登录论坛时浏览器不阻止弹出窗口？弹出窗口阻止程序的工作方式不同的这两种状态有什么区别？在打开弹出窗口时，是否有任何代码或技巧可以绕过弹出窗口阻止程序？

请指导我..提前谢谢。

# php - 如何在 post 变量中使用 wget 发布文件内容？

> ID：12661759
> 
> 赞同：5
> 
> 时间：2012-09-30T13:52:42.227
> 
> 标签：php, wget

我有一个非常简单的 php 脚本：

```
<?
  $received:file = $_POST['file'];
  // do something with it
?> 
```

我正在尝试使用 wget 发布本地文件（unix）的内容。

```
wget --post-data='operation=upload' --post-file myfile 
```

似乎发布但不附加到任何“字段”。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T13:56:06.343

你真的需要`wget`吗？实际上在阅读 wget 手册页后...... wget 不能做你想做的事。

您可以使用`curl`

```
curl -F"operation=upload" -F"file=@myfile" http://localhost:9000/index.php 
```

获取文件：

```
<?php
$uploadfile = '/tmp/' . basename($_FILES['file']['name']);
move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile);
$content = file_get_contents($uploadfile);
?> 
```

# c++ - 覆盖和追加文本文件中的行 (C++)

> ID：12661761
> 
> 赞同：-1
> 
> 时间：2012-09-30T13:52:58.010
> 
> 标签：c++, file, text, append, overwrite

我正在尝试在没有太多 I/O 或使用文本文件经验的情况下完成 CSE 实验室。该程序的目标是根据用户输入的单词和定义创建字典。输出文本文件的格式应该是

> 条目数（作为数字）
> 
> 单词
> 
> 定义
> 
> 单词
> 
> 定义

等等。

此时，如果所有单词都是“Alberta”且定义为“Threesome”，则输出显示为：

> 1
> 
> 阿尔伯塔
> 
> 三人行
> 
> 2艾伯塔省
> 
> 三人行
> 
> 2艾伯塔省
> 
> 三人行

显然有些不对劲。这是生成的代码：如果它很混乱并且输出语句被奇怪地分开，我很抱歉，我已经尝试了一段时间。

```
#include <iostream>
#include <string>
#include <fstream>
#include <stdlib.h>

using namespace std;
int main() 
{
    string name; // Name of writing/reading document

cout << "Please enter the path (including file name) for the dictionary you want to create: " ;
getline(cin,name); // Inputs name

fstream dicFile;

int addcount = 0; // number of times file has been added to.

int choice = 0; // Controls while loop

while (choice != 3) 
{
    cout << "- - - - - - - - - -" << endl;
    cout << "1) Add a word to the dictionary" << endl;
    cout << "2) Print Dictionary" << endl;
    cout << "3) Quit" << endl;
    cout << "Choose an option from the menu: ";

    string choiceS;
    getline(cin,choiceS);

    choice = atoi(choiceS.c_str());

    string wordAdd; // Stores word to be added
    string defAdd; // Stores definition to be added

    int size = 1; // Number of entries after the first entry

    if(choice > 0 && choice < 4)
    {
        cout << "- - - - - - - - - -" << endl;

        if(choice == 1) 
        {

            if(addcount == 0) 
            {
                dicFile.open(name.c_str(),ios::in|ios::out|ios::app);
                cout << "Enter a word or phrase to add to the dictionary: ";
                getline(cin,wordAdd);
                dicFile << size;
                dicFile << endl;
                dicFile << wordAdd;

                dicFile << endl;

                cout << "Enter the definition for \"" << wordAdd << "\": ";
                getline(cin,defAdd);
                dicFile << defAdd << endl;

                dicFile.close();    
                addcount++;
            }

            else 
            {
                dicFile.open(name.c_str(),ios::in|ios::out|ios::app);
                size = size + 1;
                dicFile << size;
                dicFile.close();

                dicFile.open(name.c_str(),ios::in|ios::out|ios::app);
                cout << "Enter a word or phrase to add to the dictionary: ";
                getline(cin,wordAdd);
                dicFile << wordAdd;

                dicFile << endl;

                cout << "Enter the definition for \"" << wordAdd << "\": ";
                getline(cin,defAdd);
                dicFile << defAdd << endl;

                dicFile.close();
            }

        }   

        if(choice == 2)
        {
            if(true)
            {
                dicFile.open(name.c_str(),ios::in);

                string readSize;
                int readSizei;

                getline(dicFile,readSize);
                readSizei = atoi(readSize.c_str());

                for(int i = 0; i < readSizei*2 + 1; i++)
                {
                    string word;
                    string def;
                    getline(dicFile,word);
                    cout << word << endl;
                    getline(dicFile,def);
                    cout << def << endl;
                }
                dicFile.close();    
            }

            else 
            {   cout << "- - - - - - - - - -" << endl;
                cout << "The dictionary is empty!" << endl;
            }
        }

    }

    else 
    {   cout << "- - - - - - - - - -" << endl; 
        cout << "Invalid menu selection (number should be between 1-3)" << endl; 
    }

}
} 
```

为了覆盖文本文件的第一行，但在选择选项 2 时将新定义附加到文件中，我需要做什么？对 I/O 来说相当新。谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:57:57.510

您不能“就地”修改现有文件。相反，您必须创建一个新的临时文件，并将所有内容复制到临时文件，并进行所需的修改。然后将临时文件重命名为原始文件，从而替换它。

在伪代码中：

```
open_old_file();
create_temporary_file();

while (read_line_from_old_file())
{
    do_possible_modifications_to_line();
    write_line_to_temporary_file();
}

close_temporary_file();
close_old_file();

rename_temporary_file_to_old_file();
// or if the above doesn't work:
//   copy_temporary_file_to_old_file();
//   delete_temporary_file(); 
```

# sql-server-2008 - Exchange SQL Server 2008 数据库邮件问题

> ID：12661763
> 
> 赞同：2
> 
> 时间：2012-09-30T13:53:27.190
> 
> 标签：sql-server-2008, exchange-server

在我的 Web 应用程序中，我创建了一个邮件发件人类并`web.config`像这样设置文件的配置：

```
 <mailSettings>
  <smtp deliveryMethod="PickupDirectoryFromIis">
    <network host="smtp.domain.com"
             port="587"
             userName="mail@domain.com"
             password="password"/>
  </smtp>
 </mailSettings> 
```

这是发送电子邮件。但是 SQL Server 数据库邮件不能发送具有相同帐户信息的邮件。

只有一个区别是`PickupDirectoryFromIis`。

交换服务器上有设置吗？

在 SQL Server 日志中，错误如下。

信息

> *由于邮件服务器故障，无法将邮件发送给收件人。（使用帐户 2 (2012-09-30T16:55:04) 发送邮件。异常消息：无法将邮件发送到邮件服务器。（SMTP 服务器需要安全连接或客户端未通过身份验证。服务器响应为：5.7。 1 客户端未通过身份验证）。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-11T08:16:09.667

看起来这是一个身份验证问题或端口没有问题。

身份验证问题： —————————- 请确保您已按照以下说明输入信息：

服务器名称：smtp.gmail.com（这很重要）端口号：587（在许多网站上这是错误的 465，使用 587）检查：此服务器需要安全连接检查基本身份验证用户名：yourremailid@gmail .com（应该有 gmail.com） 密码：XXXXXXXXXXXXX 确认密码：确认您的密码

端口无问题： ——————– 如果您遵循上述示例，请确保在您的机器中打开端口 587。如果您使用任何其他端口号（通常是其端口 25）在办公室中设置数据库邮件，请确保与您的安全团队交谈并要求他们解除对 25 端口的封锁。一旦他们解除对 25 端口的封锁，您的数据库邮件就可以工作了。

网络连接： —————————– 如果您可以从正在测试数据库邮件的机器连接到 Internet，请检查您机器的网络连接。要测试，请执行以下操作

开始 - 运行 - 键入 cmd - 按 Enter 键入 ping gmail.com -t，然后按 Enter。

如果输出显示为 Request timed out，这实际上意味着存在网络连接问题。否则，您的网络连接良好。

# php - 使用正则表达式匹配多个变量（PHP/JS）

> ID：12661767
> 
> 赞同：0
> 
> 时间：2012-09-30T13:53:59.787
> 
> 标签：php, javascript, regex

我了解如何使用 PHP`preg_match()`从字符串中提取变量序列。**但是，如果有2 个**变量需要匹配，我不确定该怎么做。

这是我感兴趣的代码：

```
$string1 = "help-xyz123@mysite.com";
$pattern1 = '/help-(.*)@mysite.com/'; 
preg_match($pattern1, $string1, $matches);
print_r($matches[1]); // prints "xyz123"

$string2 = "business-321zyx@mysite.com"; 
```

所以基本上我想知道如何提取两种模式：1）字符串的第一部分是“帮助”还是“业务”以及 2）第二部分是“xyz123”还是“zyx321”。

可选的额外问题是用 JS 编写的答案是什么样的？我从来没有真正弄清楚正则表达式（即，包括斜杠的代码`/..../`）在 PHP 与 JS（或与此相关的任何语言）中是否总是相同或不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:03:37.320

解决方案实际上非常简单。对于您要匹配的每个模式，将该模式放在括号之间`(...)`。因此，要提取任何模式，请使用您已经使用`(.*)`的 . 为了简单地区分“帮助”与“业务”，您可以`|`在正则表达式模式中使用：

```
/(help|business)-(.*)@mysite.com/ 
```

上面的正则表达式应该匹配这两种格式。`(help|business)`基本上说，要么 match`help`要么`business`.

所以最后的答案是这样的：

```
$string1 = "help-xyz123@mysite.com";
$pattern1 = '/(help|business)-(.*)@mysite.com/'; 
preg_match($pattern1, $string1, $matches);
print_r($matches[1]); // prints "help"
echo '<br>';
print_r($matches[2]);  // prints "xyz123" 
```

相同的正则表达式模式应该可以在 Javascript 中使用。你不需要调整它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:14:17.320

是的，凯末尔是对的。您可以在 javascript 中使用相同的模式。

```
var str="business-321zyx@mysite.com";
var patt1=/(help|business)-(.*)@mysite.com/;
document.write(str.match(patt1)); 
```

只需注意不同函数的返回值。PHP 返回一个比 Javascript 中的代码包含更多信息的数组。

# java - JetS3t 与 AWS Java 开发工具包

> ID：12661768
> 
> 赞同：12
> 
> 时间：2012-09-30T13:54:02.617
> 
> 标签：java, amazon-s3, jets3t, aws-java-sdk

我需要弄清楚 AWS SDK Java API 和 Jets3t API 之间的关系吗？在吞吐量和性能方面哪个更好？

我假设连接不可靠，所以我可能需要分块上传/下载数据。

JetS3t 中有用于分段上传的 API。但我也在寻找多部分下载。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T21:28:58.687

在我看来，我会选择[AWS SDK](https://aws.amazon.com/sdk-for-java/)。

我在 6 个月前进行了转换，到目前为止我有很好的经验。我无法准确回答您的吞吐量和性能，但我可以告诉您的一件事是它不易出错。有时，在切换到 AWS 开发工具包之前，我在使用 Jets3t 时遇到了奇怪的行为/错误。

您还应该考虑的一件事是两个库提供的支持。Jets3t 现在很少发布新版本。Jets3t 大约每 6 个月或更长时间发布一个新版本，而亚马逊大约每 2 周发布一个新版本的 SDK。因此，如果亚马逊在其服务中更改或修复某些内容，您可能会通过使用亚马逊 API 而不是 Jets3t API 获得更多利润。

如果您在 2 或 3 年前问同样的问题，我的答案会有所不同，但现在我认为 Amazon 的 SDK 已经足够成熟，并且提供比 Jets3t 更好的支持/稳定性。

# php - 下载的临时链接

> ID：12661774
> 
> 赞同：0
> 
> 时间：2012-09-30T13:54:54.170
> 
> 标签：php

下午，女士们，先生们！

我的问题是关于为下载某个文件而创建的临时链接。

我希望在下载完成后停用该链接。有什么方法可以编写一个脚本来检查特定（临时）下载链接是否已完成将文件传输到特定客户端？

总而言之，我想生成一个链接。允许某人使用它来下载文件。下载完成后删除链接。

提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T13:57:10.300

PHP 有一个名为[tmpfile](http://php.net/manual/en/function.tmpfile.php)的函数。它创建一个临时文件并返回一个资源。该资源可以像任何其他资源一样使用。

# c - “无法压缩二进制文件”是什么意思？

> ID：12661775
> 
> 赞同：1
> 
> 时间：2012-09-30T13:55:04.877
> 
> 标签：c, binaries

我已经成功编译了我的代码，但它说：

```
注意：您也可以通过键入“run”和任何命令行参数来运行您的应用程序。
启动没有 args 的应用程序...
检查库...
正在复制文件...
正在处理文件...
正在编译...
无法压缩二进制文件！

应用程序退出。

```

我希望我的代码让用户输入三个数字，中间有空格，并让它们相乘，所以这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>

int mult( int x, int y, int z) {
    return x * y * z;

int main()
    {
    int x;
    int y;
    int z;

    printf("Input two integers to be multiplied: ");
    scanf("%d", &x);
    scanf("%d", &y);
    scanf("%d", &z);
    printf("The product of the three numbers is %d\n", mult( x, y, z) );
    getchar();
}

int mult (int x, int y, int z)
{
return x * y * z;
    }
} 
```

我使用[compilr.com](https://compilr.com/home?action=login)作为我的开发平台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T13:57:51.083

您的代码包含语法错误。`mult`定义了两次，大括号有问题。此外，如果您使用的是 C89，`main`则应该返回一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:05:15.837

事实上，您的代码[根本不会链接](http://ideone.com/3cv1q). 您的第一个定义`mult`是最后缺少一个大括号。您的第二个（不必要的）定义似乎后面有一个额外的大括号。因此，似乎只有一个大的 mult 方法，根本没有 main，导致链接器错误。main（即使没有被大括号夹住）也不返回任何东西。

令人惊讶的是，Compilr 似乎没有返回任何与此相关的错误。（或者您不向我们展示）但是，由于链接失败，没有二进制文件。因此，当尝试压缩它们时，实际压缩失败并显示您看到的错误消息。

我会认真地建议您选择一个体面的编译器/IDE 来自己编译您的代码，然后再将其提交到其他任何地方。首先确保它确实可以在您的本地系统上运行。如果 compilr.com 没有返回任何实际的语法/编译器/链接器错误信息，那么它对您来说几乎没有用处。（请注意，我不熟悉该系统，因此它实际上可能会提供给您。如果是这样，请弄清楚它是如何工作的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T15:20:50.937

除了您的代码有些奇怪而且可能是错误的之外，在我看来，您的错误表明存在链接器问题：http: [//ideone.com/iBOtP](http://ideone.com/iBOtP)

# javascript - 在 Javascript 中，为什么 Object.getPrototypeOf(person) 有效但 person.getPrototypeOf(person) 无效？

> ID：12661777
> 
> 赞同：0
> 
> 时间：2012-09-30T13:55:09.433
> 
> 标签：javascript, prototype

对于以下代码，我想知道为什么`Object.getPrototypeOf(person)`有效，但`person.getPrototypeOf(person)`不起作用？我认为规则是：如果对象没有这样的属性或方法，它会沿着原型链上去尝试获取它，然后调用它`this`（例如对象的上下文在`Animal.getName.call(this)`哪里）。那么在那种情况下，应该成为并且应该工作呢？`this``woofie``person.getPrototypeOf(person)``Object.getPrototypeOf.call(person, person)`

```
function Person(name) {
    this.name = name;
}

var person = new Person("Ang Lee")

console.log("the prototype of person is", Object.getPrototypeOf(person)); 
```

* * *

**更新：**对于说`getPrototypeOf`是静态方法的答案，这是否意味着：

```
function Person(name) {
    this.name = name;
    this.foo = function() { ... }
}

Person.bar = function() { ... } 
```

那`foo`是“在链中”，并且可以被任何继承的对象调用，而`bar`不是，`bar`就像`getPrototypeOf`，这是一个静态方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T13:56:42.503

`Object.getPrototypeOf`是`Object` *类型*本身的属性，而不是 of 的`prototype`属性`Object`。

因为它实际上不在原型链中，所以在调用`person.getProtoTypeOf()`.

它更类似于在其他 OO 语言中看到的“静态方法”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T13:59:21.687

`.getPrototypeOf`是一个函数 put on `Object`，而不是它的原型。如果需要，您可以查找它：

```
"getPrototypeOf" in Object.prototype; // false 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T13:59:31.453

如果`getPrototypeOf`是包含在 中的方法`Object.prototype`，那么它也可以在 类型的对象上使用`Person`，但是，`getPrototypeOf`附加到`Object`，这只是`Object`实例的构造函数，而不是原型。

出于某种原因，Javascript 的创建者决定将原型附加到构造函数，反之亦然；如果他们没有做出这样有问题的决定，你就不必问这个问题。

PS任何对基于原型的对象继承的更优雅/干净的实现感兴趣的人都可以查看[http://iolanguage.com/](http://iolanguage.com/)

# node.js - 为生产（部署）构建（准备）node.js 应用程序

> ID：12661779
> 
> 赞同：0
> 
> 时间：2012-09-30T13:55:35.640
> 
> 标签：node.js, web-applications, nodejitsu

我有一个由几个 nod.js 后端应用程序组成的项目。这些应用程序使用相同的模块（放置在每个 ap 文件夹之外的共享位置）。它们将部署在不同的环境（服务器）上的应用程序，一些代码用于测试，一些用于像往常一样调试。

如果我为我的一个应用程序选择了一个平台（例如 PaaS nodejitsu），我应该如何只为我的一个应用程序发送生产代码？我部署在 nodejitsu 上，它只是发送应用程序文件夹并使用 package.json 来配置应用程序。但是有一堆代码是不需要的（例如测试），有些代码是外部的。如果我也想阻止服务器代码怎么办？这个问题应该如何解决？

对于前端应用程序，有大量的方法可以用于生产。我知道要求是不同的，但没有找到任何关于如何正确准备 node.js 后端应用程序以进行部署的最佳实践的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-01T22:37:33.407

阅读[NPM 开发者页面中的“将文件保留在包之外”](https://npmjs.org/doc/developers.html)部分。它指出以下

> 使用 .npmignorefile 将内容保存在您的包之外。如果没有 .npmignore 文件，但有 .gitignore 文件，则 npm 将忽略 .gitignore 文件匹配的内容。如果要包含 .gitignore 文件排除的内容，可以创建一个空的 .npmignore 文件来覆盖它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T15:19:09.560

将这些测试文件添加到`.gitignore`

或创建另一个`git`生产分支并推送生产分支。

# ssis - mdx ssis 动态表

> ID：12661786
> 
> 赞同：1
> 
> 时间：2012-09-30T13:56:48.007
> 
> 标签：ssis, mdx

在 SSIS 包中，我有一个 DataSource 和 DataDestination。我想在 DataDestination 中动态创建目标表。我不应该有其他任何东西（SQLTask ...），因为我正在使用 mdx 查询。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T13:35:12.210

我添加了一个脚本任务，并使用它使用 ado.net 执行了我的脚本

# .net - 使用 Mono 的跨平台 .NET 应用程序打包？

> ID：12661794
> 
> 赞同：3
> 
> 时间：2012-09-30T13:57:55.277
> 
> 标签：.net, monodevelop, executable, packaging

我已经开始在 Mac OSX 上大量使用 MonoDevelop，并且我需要将一些应用程序打包到 Windows 和 Mac OSX 的单个可执行文件中。

我知道 MonoDevelop 有 mkbundle 和一个特定的 Mac OSX 打包程序。然而，我对 mkbundle 的体验并不是很好，在 OSX 上最好的时候它似乎有问题和脾气暴躁，而特定的 OSX 打包程序在 Windows 情况下对我没有帮助。

所以我想我的问题是，其他人用什么来构建他们的可执行文件。我之前使用 Launch4J for Java 非常棒，所以我正在.NET 上寻找类似的解决方案。

谢谢

# javascript - jQuery 单击页面中除 1 div 之外的任何位置

> ID：12661797
> 
> 赞同：95
> 
> 时间：2012-09-30T13:58:15.280
> 
> 标签：javascript, jquery, html, triggers, click

当我单击页面上除一个 div ( ) 之外的任何位置时，如何触发功能`id=menu_content`？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-09-30T14:00:30.987

如果事件是由带有 id 的 div 生成的，`click`您可以应用`body`文档并取消`click`处理，这会将事件绑定到单个元素并保存与每个元素的绑定，除了`click``menu_content``click``menu_content`

```
$('body').click(function(evt){    
       if(evt.target.id == "menu_content")
          return;
       //For descendants of menu_content being clicked, remove this check if you do not want to put constraint on descendants.
       if($(evt.target).closest('#menu_content').length)
          return;             

      //Do processing of click event here for every element except with id menu_content

}); 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-09-30T14:04:29.737

请参阅[jQuery 事件目标](http://api.jquery.com/event.target/)的文档。使用事件对象的 target 属性，您可以检测点击在`#menu_content`元素内的位置，如果是，则提前终止点击处理程序。您将不得不使用[`.closest()`](http://api.jquery.com/closest/)来处理点击源自`#menu_content`.

```
$(document).click(function(e){

    // Check if click was triggered on or within #menu_content
    if( $(e.target).closest("#menu_content").length > 0 ) {
        return false;
    }

    // Otherwise
    // trigger your click function
}); 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2012-09-30T14:00:12.330

试试这个

```
 $('html').click(function() {
 //your stuf
 });

 $('#menucontainer').click(function(event){
     event.stopPropagation();
 }); 
```

你也可以使用 [外部事件](http://archive.plugins.jquery.com/project/ba-jquery-outside-events-plugin)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-09-05T09:52:06.257

我知道这个问题已经回答了，而且所有的答案都很好。但我想为有类似（但不完全相同）问题的人在这个问题上加两分钱。

以更一般的方式，我们可以这样做：

```
$('body').click(function(evt){    
    if(!$(evt.target).is('#menu_content')) {
        //event handling code
    }
}); 
```

这样，我们不仅可以处理除具有 id 的元素`menu_content`之外的任何事物触发的事件，还可以处理除我们可以使用 CSS 选择器选择的任何元素之外的任何事物触发的事件。

例如，在下面的代码片段中，我得到了由任何元素触发的事件，除了所有`<li>`div 元素的后代元素 id `myNavbar`。

```
$('body').click(function(evt){    
    if(!$(evt.target).is('div#myNavbar li')) {
        //event handling code
    }
}); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-09-13T16:43:33.460

这就是我所做的。想确保我可以点击我的日期选择器中的任何孩子而不关闭它。

```
$('html').click(function(e){
    if (e.target.id == 'menu_content' || $(e.target).parents('#menu_content').length > 0) {
        // clicked menu content or children
    } else {
        // didnt click menu content
    }
}); 
```

我的实际代码：

```
$('html').click(function(e){
    if (e.target.id != 'datepicker'
        && $(e.target).parents('#datepicker').length == 0
        && !$(e.target).hasClass('datepicker')
    ) {
        $('#datepicker').remove();
    }
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-06-11T17:30:33.423

你可以试试这个：

```
$(":not(#menu_content)").on("click", function(e) {
    e.stopPropagation();
    // Run your function when clicked anywhere except #menu_content
    // Use with caution, 'cause it will prevent clicking on other elements
});

$("#menu_content").on("click", function(e) {
    e.stopPropagation();
    // Run when clicked on #menu_content
}); 
```

# android - Unity3D 中的 Mobclix 广告

> ID：12661807
> 
> 赞同：1
> 
> 时间：2012-09-30T13:59:54.763
> 
> 标签：android, unity3d, mobclix

我已经浪费了很多时间来解决这个问题，看起来我又回到了起点。我想在 Unity3D 游戏中从 Mobclix 运行全屏广告。我找到了很多教程，但我无法让它们中的任何一个工作。

据我所知，有两种方法：1.) 扩展统一播放器 2.) 制作用于显示 AD 的 JAVA 端方法，然后从统一调用它（c#）

对我来说最重要的是让它发挥作用，但我更喜欢 2\. 方法。有人可以给我一些建议，也许能给我一些提示/例子我错过了什么？

我尝试了两种方式。我制作了一个 JAVA 插件，但是当我尝试调用一个方法时没有任何反应，或者我从 JNI 收到错误消息，例如：“找不到该方法”，我的清单配置不正确，或者我的应用程序崩溃。

如果我正在制作一个插件（不扩展 UnityPlayer），我是否需要在清单中添加一些东西来支持我的活动/使我的类能够在统一内部调用？清单会是什么样子？可以那样做吗？

如果我正在扩展 UnityPlayer，那么 anifest 文件会是什么样子，我如何调用我的方法来显示广告？

我尝试从 unity/c# 调用 java/android 方法并且有效，但是当我尝试从插件调用我自己的简单方法时它不起作用。看起来我在那部分遗漏了一些东西。（连接JAVA插件和unity3d）

我在 C# 方面经验丰富，但我的 JAVA 知识实际上是最低限度的。我确信这可以工作（有些人在销售解决方案）但看起来我不够聪明并且总是错过一些东西:)

我尝试了很多东西，我停止计数并删除了大部分。有人可以告诉我这样做的正确方法吗？一个工作示例将非常有用...

感谢您花时间阅读所有这些，我希望会有一些有用的回应，因为我开始感到沮丧:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T20:07:25.867

不幸的是，看起来最简单的方法是购买专门为此制作的插件。我在[这里](https://www.paypal.com/us/cgi-bin/webscr?cmd=_flow&SESSION=sLKBplWPL-v1JG7pRJyRL22ygqS4o9P0l9MzAuDlAP6AnqTNyKNLU_D6H4a&dispatch=50a222a57771920b6a3d7b606239e4d529b525e0b7e69bf0224adecfb0124e9b61f737ba21b08198c76d66ace6699a60677529753b095fab)找到了一个，售价 50 美元，它特别声明它支持全屏 Mobclix 广告。

Unity3D论坛的工作人员开发了一个免费的，但是看起来更复杂，因为你必须在实际的android设备上运行它，我不确定它是否支持全屏。[您可以在此处](http://forum.unity3d.com/threads/78453-Mobclix-plugin-that-works-with-Unity-3.2)找到讨论主题。

希望这些链接有所帮助！

**编辑**：我找到了一个更实惠的 6.00 英镑 Unity3D 插件，你可以在[这里](http://www.platoevolved.com/blog/unity-plugins/#ecwid%3acategory=2743024&mode=product&product=11950435)获得。但是，它没有明确声明对全屏的支持。

**注意**：我从提供 6 英镑插件的同一网站上找到了一个[教程](http://www.platoevolved.com/blog/programming/android/creating-an-android-plugin-for-unity/)。本教程可能值得一试，但它涉及编译您自己的 Unity Android 插件。因为它来自同一个网站，所以可能值得一试。它是专门用于在 Unity3D for Android 应用上显示 Mobclix 广告的插件。

# objective-c - 精灵位置变化之间的延迟

> ID：12661814
> 
> 赞同：0
> 
> 时间：2012-09-30T14:00:23.830
> 
> 标签：objective-c, for-loop, cocos2d-iphone, sprite

现在我里面有`NSArray`很多`x`坐标；我有一个精灵需要去每个点沿着选定的路径走。我尝试使用 for 循环，但这样做的速度如此之快，以至于它似乎只是传送到最终目的地。我已经尝试了一个 with 选择器，但我也无法让它们工作。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:44:31.483

你必须使用 NSTimer

```
@implementation whatever
{
int count;
NSTimer *myTimer;
CCSprite *mySprite;
NSArray *locationArray;
} 
```

然后从某个地方启动计时器...

```
 count=0
 //1.0 is one second, so change it to however long you want to wait between position changes
 myTimer =   [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(movealong) userInfo:nil repeats:YES]; 
```

然后它调用它直到它遍历所有对象

```
-(void)movealong{

//assuming array is full of CGPoints...
//mySprite.position = [locationArray objectAtIndex:count];
//try this then
CGPoint newPoint = [locationArray objectAtIndex:count];
mySprite.position = ccp(newPoint.x,newPoint.y);
//I think maybe THIS is what you need to do to make it work... 
//if you want it to not jump directly there
//you can also use CCMoveTo 
/*//  under actionWithDuration: put the same amount of time or less of what you had
  //  under scheduledTimerWithTimeInterval in your NSTimer
    CCFiniteTimeAction *newPos = [CCMoveTo actionWithDuration:1.0 position:[locationArray objectAtIndex:count]];
    [mySprite runAction:newPos];
*/
count++;
if(count >= locationArray.count){
    [myTimer invalidate];
    myTimer = nil;
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T18:14:16.740

创建一个方法，将您的精灵放置在位置数组中某个索引处（例如，_i）的位置。并在此方法结束时再次延迟调用它，依次使用 CCDelayTime 和 CCCallFunc 动作。并且不要忘记增加索引。喜欢

```
// somewhere in code to start move
_i = 0;
[self setNewPosition];

// method that will set the next position
- (void) setNewPosition
{
    sprite.position = // get position at index _i from your array here
    _i++;

    BOOL needSetNextPosition = // check if _i is inside bounds of your positions array
    if( needSetNextPosition )
    {
        id delay = [CCDelayTime actionWithDuration: delayBetweenUpdate];
        id callback = [CCCallFunc actionWithTarget: self selector: @selector(setNewPosition)];
        id sequence = [CCSequence actionOne: delay two: callback];
        [self runAction = sequence];
    }

} 
```

这只是示例，但我希望您可以根据需要对其进行调整。

# wpf - 使用 Kinect 在 WPF 图像控件上移动鼠标

> ID：12661817
> 
> 赞同：0
> 
> 时间：2012-09-30T14:00:55.527
> 
> 标签：wpf, cursor, kinect

我正在尝试使用 kinect 移动鼠标。我实现了在 c# 中使用互操作服务。现在我只想在图像控件内移动鼠标。所以鼠标不应该在其他布局上移动。有什么方法可以在不使用互操作服务的情况下实现鼠标移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T17:17:05.180

```
Cursor.Position = new Point() 
```

会让你移动光标。您也可以限制代码中的位置。

那是你要找的东西，还是我错过了什么？我看不到任何特定于 Kinect 的东西。

编辑：

您可以在以下帖子中找到我使用的跟踪功能： [how to use skeletal joint to act as cursor using bounds (No gestures)](https://stackoverflow.com/questions/12569706/how-to-use-skeletal-joint-to-act-as-cursor-using-bounds-no-gestures/12610931#12610931)

在其中，我将手的位置分配给“RightHandX”和“RightHandY”参数。这些基本上是鼠标位置——您可以用对 Cursor.Position 的调用来替换它们。

如果您只想在图像周围移动鼠标，则可以获取图像的边界，然后只需添加另一个“if”语句，根据这些边界和计算出的位置发送或不发送 Cursor.Position手。

# php - 如何为 NetBeans PHP 项目设置默认目录？

> ID：12661824
> 
> 赞同：1
> 
> 时间：2012-09-30T14:02:57.380
> 
> 标签：php, netbeans

> **可能重复：**
> [如何更改默认的 Netbeans 6.7 项目目录？](https://stackoverflow.com/questions/1266792/how-to-change-the-default-netbeans-6-7-project-directory)

我已经安装了 Netbeans，我正在尝试创建一个新项目 - 系统建议我安装在 /var/www 文件夹中，但我已经为它创建了一个新文件夹 /home/myuser/myprojects，我想要该文件夹将是默认文件夹。那么，请告诉我，我在哪里可以更改默认文件夹？先感谢您。

# python - 对象不能全局创建但可以在本地python

> ID：12661832
> 
> 赞同：0
> 
> 时间：2012-09-30T14:04:07.710
> 
> 标签：python, class, module, global, local

我在同一个模块中定义了两个类，并希望在第一个中使用第二个（作为全局变量）：

```
class Class1(object):
    global_c2 = Class2()

    def foo(self):
        local_c2 = Class2()

class Class2(object):
    pass 
```

global_c2 出现错误，但 local_c2 没有。这是有道理的，因为当编译器查看这个文件时，它不会知道 Class2 将会存在。此外，如果我切换类以便首先定义 Class2 它可以工作。

但是我想知道是否有另一种方法可以解决这个问题。也许我可以以某种方式告诉 python Class2 将会存在，所以不用担心，或者我只需要将它们按正确的顺序排列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:06:11.907

您可以执行以下操作（即在声明 Class2 后回填 Class1 的内容。

```
class Class1(object):
    pass

class Class2(object):
    pass

Class1.global_c2 = Class2() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:11:34.900

编译器在这里不做任何事情。在这两种情况下，都会生成完全相同的字节码序列以在运行时查找类并将其实例化。

不同之处在于语句的运行时间。Python 模块中的所有代码都是从上到下执行的——没有声明之类的东西，一切都是定义，每个绑定都是动态的。类定义中的代码在遇到类定义时运行（因此*在*第二个类存在并绑定到 name之前`Class2`）。函数中的代码在函数被调用时运行，并且因为您在第二个类的定义之前不调用该函数，所以它在您调用该函数时可用。

That's basically what every solution boils down to: Delay binding until whatever you're binding to exists.

# android - 如何从 android ping 网站以获取服务器响应的平均时间。

> ID：12661835
> 
> 赞同：2
> 
> 时间：2012-09-30T14:04:34.137
> 
> 标签：android, ping

我正在制作一个可以从 android 应用程序获取 ping 响应时间的 android 应用程序。我已经在 windows 环境下完成了，但是当我把它带到 android 设备上时，设备无法发送任何响应。我怎么解决这个问题。？

提前致谢。这是我的代码

```
 String ip="www.google.com"; String pingResult="  ";
                String pingCmd="ping"+ip;

                Runtime r=Runtime.getRuntime();
                Process p=r.exec(pingCmd);
                BufferedReader in=new BufferedReader(new InputStreamReader(p.getInputStream()));
                String inputLine;
                Toast.makeText(getApplicationContext(), "Going loop", 1).show();
                while((inputLine=in.readLine())!=null)
                {
                    pingResult=inputLine;
                }
                Toast.makeText(getApplicationContext(),pingResult, 1).show();
                in.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T16:30:49.720

如果您更改线路，您将正常工作：

```
Process p=r.exec(pingCmd); 
```

至：

```
Process p=r.exec(new String[] {"ping", "-c 4", "www.google.pt"}); 
```

原因是：

-Android exec 命令需要一个 String[] 而不是 String。

- 需要 -c 参数来将 ping 次数限制为 4（以复制 Windows 行为）。否则它将永远ping通。

最后，这只适用于真实设备。要让它在模拟器中工作，您需要配置 adb 以将 ping 重播重定向到模拟器。

祝你好运。

# c++ - UVa 11402 运行时错误

> ID：12661836
> 
> 赞同：-1
> 
> 时间：2012-09-30T14:04:45.977
> 
> 标签：c++, runtime-error

我正在尝试解决 UVa Online Judge 上的问题[11402-Ahoy Pirates](http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&category=&problem=2397)。该代码应该在某些指定信息上构建一个段树并执行更新或查询操作。我的 C++ 代码在我的系统上运行良好。但是我在提交时收到运行时错误。由于我的数组大小可以达到〜3000000个元素，我担心这么大的数组是否会导致运行时错误。有任何想法吗？

```
#include <algorithm>
#include <cctype>
#include <cmath>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <map>
#include <queue>
#include <set>
#include <sstream>
#include <stack>
#include <string>
#include <vector>

using namespace std;
typedef long long ll;

struct Node{
    char upd;
    // 0 - Buccaneer pirates
    // 1 - Barbary pirates
    int p[2];
    Node(){
        p[0] = 0;
    p[1] = 0;
        upd = ' ';
    }
    void update(char cmd){
        if (cmd == 'I'){
            switch(upd){
                case ' ': upd = 'I';break;
                case 'I': upd = ' ';break;
                case 'E': upd = 'F';break;
                case 'F': upd = 'E';break;
            }
        }
        else if (cmd != ' '){
            upd = cmd;
        }
    }
    void S(){
        int temp;
        switch(upd){
            case 'I': temp=p[0]; p[0]=p[1]; p[1]=temp; break;
            case 'E': p[1]+=p[0]; p[0]=0; break;
            case 'F': p[0]+=p[1]; p[1]=0; break;
        }
        upd = ' ';
    }
};

Node tree[4028000];
char pirates[1024010];

void buildTree(int index, int i, int j){
    if (i>j)
        return;
    if (i==j){
        if (pirates[i] == '0'){
            tree[index].p[1] = 1;
            tree[index].p[0] = 0;
        }
        else{
            tree[index].p[0] = 1;
            tree[index].p[1] = 0;
        }
        tree[index].upd = ' ';
        return;
    }
    int mid = (i+j)/2;
    buildTree(2*index+1,i,mid);
    buildTree(2*index+2,mid+1,j);
    tree[index].p[0] = tree[2*index+1].p[0] + tree[2*index+2].p[0];
    tree[index].p[1] = tree[2*index+1].p[1] + tree[2*index+2].p[1];
    tree[index].upd = ' ';
}

void update(int index,int i,int j,int l,int r,char c){
    if (i == l && j == r){
        tree[index].update(c);
    }
    tree[2*index+1].update(tree[index].upd);
    tree[2*index+2].update(tree[index].upd);
    tree[index].S();
    if (i == l && j ==r)
        return;
    if (l>j || r<i || l > r)
        return;
    int mid = (i+j)/2;
    update(2*index+1,i,mid,l,min(r,mid),c);
    update(2*index+2,mid+1,j,max(l,mid+1),r,c);
    tree[index].p[0] = tree[2*index+1].p[0] + tree[2*index+2].p[0];
    tree[index].p[1] = tree[2*index+1].p[1] + tree[2*index+2].p[1];
}

int query(int index,int i,int j,int l,int r){
    if (l>j || r<i)
        return 0;
    tree[2*index+1].update(tree[index].upd);
    tree[2*index+2].update(tree[index].upd);
    tree[index].S();
    if (i == l && j == r){
        return tree[index].p[0];
    }
    int mid = (i+j)/2;
    int b1 = query(2*index+1,i,mid,l,min(mid,r));
    int b2 = query(2*index+2,mid+1,j,max(mid+1,l),r);
    return b1+b2;
}

int main(void){
    int t;
    scanf("%d",&t);
    for(int z=0; z<t; z++){
        int m,len=0,T,q,querycnt=1;
        char str[64];
        scanf("%d",&m);
        for(int i=0; i<m; i++){
            scanf("%d %s",&T,str);
            for(int j=0; j<T; j++){
                int length = strlen(str);
                for(int k=0; k<length; k++){
                    pirates[len] = str[k];
                    len++;
                }
            }
        }
        buildTree(0,0,len-1);
    scanf("%d",&q);
        printf("Case %d:\n",z+1);
        for(int i=0; i<q; i++){
            char cmd;
            int l,r;
        scanf(" %c %d %d", &cmd, &l, &r);
            if (cmd == 'S'){
                int ans = query(0,0,len-1,l,r);
                printf("Q%d: %d\n",querycnt++,ans);
            }
            else{
                update(0,0,len-1,l,r,cmd);
            }
        }
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T16:02:06.287

解决方案的问题在于以下两个语句

```
tree[2*index+1].update(tree[index].upd);
tree[2*index+2].update(tree[index].upd); 
```

在上述两个语句中，数组树的索引最多可以达到 2*(2*N+1)（溢出操作），其中 N 是输入的最大大小。在上面的问题中N = 1024000。由于数组树的大小小于4*N，如果输入量很大，程序会产生分段错误。上述问题的解决方案是在访问数组或使数组足够大以处理所有溢出更新操作之前检查索引的边界。

# php - 将谷歌地图坐标传输到mysql数据库

> ID：12661838
> 
> 赞同：-1
> 
> 时间：2012-09-30T14:04:56.820
> 
> 标签：php, mysql, google-maps-api-3, markers

我有一个谷歌地图，用户可以在其中创建折线。我已将折线 (lat,lng) 坐标存储到一个数组中。现在我想使用 php 或 javascript 将这些坐标传输到 mysql 数据库，或者还有其他更好的选择吗？我应该如何进行？

这是我的代码：

```
(function() {
    window.onload = function() {

    var path;
    var marker;
    var infowindow;
    var places = [];

    //create reference to div tag in HTML file
    var mapDiv = document.getElementById('map');

    // option properties of map
    var options = { 
            center: new google.maps.LatLng(-20.2796, 57.5074),
            zoom : 16,
            mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    // create map object
    var map = new google.maps.Map(mapDiv, options);

    // create MVC array to populate on click event
    var route = new google.maps.MVCArray();

    var polyline = new google.maps.Polyline({
        path: route,
        strokeColor: '#ff0000',
        strokeOpacity: 0.6,
        strokeWeight: 5
    });

    polyline.setMap(map);

    // create click event,attach to map and populate route array

    google.maps.event.addListener(map,'click', function(e) {

        // create reference to polyline object
         path = polyline.getPath();

         // add the position clicked on map to MVC array
        path.push(e.latLng);

    });

    // display coordinates
    document.getElementById('coords').onclick = function() {

        for(var i = 0; i < path.getLength(); i++) {

            alert('coords: ' + path.getAt(i).toUrlValue(2) +'\n');
        }

    }

    // create marker on right click
        google.maps.event.addListener(map,'rightclick', function(e) {

                marker = new google.maps.Marker({
                position: e.latLng,
                map: map
            });
                places.push(e.latLng);

                // get coordinates in infowindow on click

                google.maps.event.addListener(marker,'click', function(event){

                    if(!infowindow) {

                        infowindow = new google.maps.InfoWindow();

                    }
                    infowindow.setContent('coords: ' + marker.getPosition().toUrlValue(3));
                    infowindow.open(map,marker);
                });

            });

    };

})(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:15:14.757

您可以随时存储它 - 这取决于您以后要如何使用这些数据。您可以将其作为 JSON 编码数组存储在 TEXT 字段中，您可以将 lat / lng 坐标保存在单独的字段中，如下所示：

```
// Table for polylines
CREATE TABLE `polylines` (
  `pID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `pName` VARCHAR(45) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
  PRIMARY KEY (`pID`)
)
ENGINE = MyISAM
CHARACTER SET utf8 COLLATE utf8_general_ci;

// Table for coordinates
CREATE TABLE `coords` (
  `cID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `cPolyline` INTEGER UNSIGNED NOT NULL,
  `cLat` VARCHAR(15) NOT NULL,
  `cLng` VARCHAR(15) NOT NULL,
  PRIMARY KEY (`cID`)
)
ENGINE = MyISAM
CHARACTER SET utf8 COLLATE utf8_general_ci; 
```

现在你可以得到这样的折线：

```
SELECT * FROM polylines WHERE pName = 'something' 
```

然后坐标：

```
SELECT cLat, cLng FROM coords WHERE cPolyline = ID 
```

有很多可能性和选择——就像我之前说的——这完全取决于你接下来想做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T14:51:04.523

好的，这是适合您的数据库解决方案：

表路径将存储您的阵列中的路径。

```
CREATE TABLE `gmap`.`paths` (
  `pID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `pName` VARCHAR(75) NOT NULL,
  `pStartLat` VARCHAR(25) NOT NULL,
  `pStartLng` VARCHAR(25) NOT NULL,
  `pAverageSpeed` FLOAT NOT NULL,
  PRIMARY KEY (`pID`)
)
ENGINE = MyISAM; 
```

表路径将在 pName 字段中存储您的用户/路径名称（无论您想要什么），在 pStartLat/pStartLng 字段中存储起点，pAverageSpeed 当然是平均速度（不知道您是否想要它，以防万一）并且 pID 是标识符您将与另一个表一起使用：

```
CREATE TABLE `gmap`.`coords` (
  `cID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `cLat` VARCHAR(25) NOT NULL,
  `cLng` VARCHAR(25) NOT NULL,
  `cSpeed` FLOAT NOT NULL,
  `cPath` INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY (`cID`)
)
ENGINE = MyISAM; 
```

这张表将让您存储坐标 - 每个坐标都有速度。

现在，假设您要显示名为“TestOne”的路径。

```
// Connect to the database - I assume you can do that
// and retrieve data

SELECT * FROM paths WHERE pName = "TestOne" 
```

现在您在表中获得了 ID、名称、起点坐标和平均速度（mysql_fetch_assoc 非常适合）。

然后，您可以使用 ID 检索其余坐标：

```
SELECT * FROM coords WHERE cPath = ID 
```

现在，使用例如 while 循环，您可以将所有坐标检索到一个数组中。

当然，首先您必须使用 INSERT INTO 构造或类似方法来存储该数据:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-30T14:14:22.357

您可以使用许多解决方案，例如您的代码似乎是这样的：

```
var my_map= new GMap2(document.getElementById("my_map"));
    my_map.setCenter(new GLatLng(36.82,10.17),10);
    my_map.addControl(new GSmallMapControl());
    GEvent.addListener(my_map, "click", function(overlay,point){
    var lat = point.lat();
    var lng = point.lng();
    $('#input_lat').val(lat);
    $('#input_long').val(lng); 
 }); 
```

并且 input_lat, input_long 可以隐藏或可见输入到您的表单中，然后保存到您的数据库中

# javascript - 正文标签未定义或为空

> ID：12661840
> 
> 赞同：0
> 
> 时间：2012-09-30T14:05:09.270
> 
> 标签：javascript, html, dom, getelementsbytagname

你知道为什么当我尝试使用它时我的身体标签/元素仍然是空的吗？我有以下代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<title>Max</title>
<link rel="stylesheet" type="text/css" href="css/style.css"/>
<script>
alert(document.getElementsByTagName("*"));
function se(){
  var twenty = document.getElementsByTagName("*")[20];
 //twenty.children[1].children[0].children[1].innerHTML = "hiephoi";
}
se();

var fg = document.getElementsByTagName("body")[0];//undefined
</script>
</head>
<body>
<script>
alert(document.getElementsByTagName("*"));
function se(){
  var twenty = document.getElementsByTagName("*")[20];
  //twenty.children[1].children[0].children[1].innerHTML = "hiephoi";
}
se();</script>
:
:
: 
```

如果我对此进行调试，`document.getElementsByTagName("*")`确实会在断点处给出元素列表，但是，当我要求时让代码运行会出错

```
document.getElementsByTagName("*")[20].children[1].children[0].children[1].innerHTML = "hiephoi"; 
```

它说`document.getElementsByTagName("*")[20].children`不是对象，实际上它是未定义的。你可能想知道我为什么要使用通配符，但是仅仅寻找任何特定的标签什么都不会返回。奇怪的是，通配符确实返回了一个节点列表。我可以尝试使用 JQuery，但我试图理解这一点。我认为这可能与文档的加载阶段有关？或者可能是 html 在某处包含丢失的标签而 JS 感到困惑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:16:29.243

您正在尝试在创建 DOM 树之前获取元素。将您的 javascript 放在最后，在结束 body 标记之前，看看是否有效（未经测试。它仍然可能不是出于同样的原因）。

更好的是，`window.onload`在尝试读取 DOM 之前检查以确保已加载。[window.onload 与 <body onload=""/>](https://stackoverflow.com/questions/191157/window-onload-vs-body-onload)

# javascript - 获取多选的值 - 没有 jQuery

> ID：12661844
> 
> 赞同：4
> 
> 时间：2012-09-30T14:05:30.437
> 
> 标签：javascript, html, multi-select

每个相关的“可能已经有[我的]答案的问题”都使用我没有使用的 jQuery。

那么，有什么简单的方法可以获取`<select multiple>`标签中选定选项的值，还是我必须遍历所有选项以查看选择了哪些选项并手动构建一个数组？

附带问题：哪些浏览器*不*支持`selectElement.value`而是需要`selectElement.options[selectElement.selectedIndex].value`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T14:17:19.030

您可以使用[`select.selectedOptions`](http://dev.w3.org/html5/spec/the-select-element.html#dom-select-selectedoptions). 但是，这会返回一个`HTMLCollection`，因此您仍然必须清理它以获取字符串数组。[http://jsfiddle.net/9gd9v/](http://jsfiddle.net/9gd9v/)

```
<select multiple>
  <option value="foo" selected>foo</option>
  <option value="bar">bar</option>
  <option value="baz" selected>baz</option>
</select> 
```

和：

```
var select = document.querySelector("select");
var values = [].map.call(select.selectedOptions, function(option) {
  return option.value;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:25:14.203

如果您最终想要循环并获取选定的值，您可以使用如下内容：

```
function loopSelected()
{
  var txtSelectedValuesObj = "";
  var selectedArray = new Array();
  var selObj = document.getElementById('selectID');
  var i;
  var count = 0;
  for (i=0; i<selObj.options.length; i++) {
    if (selObj.options[i].selected) {
      selectedArray[count] = selObj.options[i].value;
      count++;
    }
  }
  txtSelectedValuesObj = selectedArray;
  alert(txtSelectedValuesObj);  
} 
```

**[您可以在此处](http://jsfiddle.net/rByjY/1/)**查看示例，改编自此**[示例](http://www.mredkj.com/tutorials/tutorial004.html)**。

.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T19:06:29.467

`onchange`您还可以简单地通过事件实时跟踪所选选项，并在需要时随时收集它们。我承认它仍然在循环，但至少你不是每次需要检索选定的选项时都这样做，而且它具有简单的额外好处（无论如何，检索时间到了......）。工作小提琴：http: [//jsfiddle.net/cyg9Z/](http://jsfiddle.net/cyg9Z/)

```
var Test;
if (!Test) {
    Test = {
    };
}
(function () {
    Test.trackSelected = function (e) {
        var selector = document.getElementById('selector'),
            selected = [],
            i = 0;
        for (i = 0; i < selector.children.length; i += 1) {
            if (selector.children[i].selected) {
                selected.push(selector.children[i].value)
            }
        }
        selector.selMap = selected;
    };
    Test.addListeners = function () {
        var selector = document.getElementById('selector'),
            tester = document.getElementById('tester');
        selector.onchange = Test.trackSelected;
        tester.onclick = Test.testSelected;
    };
    Test.testSelected = function () {
        var div = document.createElement('div');
        div.innerText = document.getElementById('selector').selMap.join(', ');
        document.body.appendChild(div);
    };
    Test.addListeners();
}());​ 
```

# ruby-on-rails - rails，根据用户的IP地址重写路由

> ID：12661845
> 
> 赞同：1
> 
> 时间：2012-09-30T14:05:41.063
> 
> 标签：ruby-on-rails, routes

我有一个搜索索引器索引我的应用程序中的特定页面。我们为索引构建的 url 是在应用程序的其他页面中提供的内容的聚合。索引器应该看到聚合页面，用户应该看到找到的主题的第一页/仪表板。

我想看看我如何将除搜索索引器之外的所有人路由（通过 routes.rb 或 before_filter）到主题的仪表板。

例如。聚合页面在这里/topics/123-my-topic/searchindex。索引器将该页面作为相关内容返回，因为它具有主题 123 的所有内容。当用户（不是搜索索引器 ip）转到 /topics/123-my-topic/searchindex 时，他们应该被路由到 /topics/123-my-topic。

从本质上讲，除了已知 IP 地址之外，将 /searchindex 从每个人的请求中剥离的最佳方法是什么？

这可能可以通过 apache 中的 .htaccess 来完成，但我更愿意将其保留在我的应用程序中，因此如果索引器 IP 地址发生变化，我不必修改服务器上的文件。

谢谢

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:58:01.917

```
before_filter :redirect_users

def searchindex
  # :id => '123-my-topic'
  redirect_users
  # Handle searchindex traffic for the indexer
end

def redirect_users
  unless ip == '127.0.0.1'
    redirect_to :action => :show, :id => :topic_id
  end
end 
```

# ruby - erb 模板和新行/间距问题

> ID：12661852
> 
> 赞同：0
> 
> 时间：2012-09-30T14:07:42.177
> 
> 标签：ruby, erb

我有一个用于生成源代码的 erb 模板，但问题是我希望 erb 模板看起来可读，但同时我希望生成的输出也看起来不错。

所以我有这个片段：

```
 <% model.attributes.each do |attribute| %>
private <%= model.get_instance(attribute) %> <%= ... %>;<% end%> 
```

所以我的代码输出没有像我想要的那样出现，我希望它像：

```
private type name;
private type name2;
private type name3; 
```

但它在每行之间都有一个额外的空间。

我怎样才能解决这个问题？

我提到的另一个挑战是我不希望我的 erb 看起来不可读（如果可能的话）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T23:23:55.290

我也遇到过同样的问题。试图在不影响模板可读性的情况下获得格式良好的输出源代码是一场噩梦。我选择在代码生成过程中使用链接的代码格式化程序，并且只专注于我的模板文件。祝你好运

# javascript - Javascript：Ajax $.post Cookie 文件问题

> ID：12661853
> 
> 赞同：0
> 
> 时间：2012-09-30T14:08:10.523
> 
> 标签：javascript, ajax, cookies

我正在使用 PHP cURL 登录一个网站——它会在成功登录后生成一个 cookie 文件。

```
 $cookieFile = tempnam("/tmp", "curl-cookie"); // Cookie file to login. 
```

php 脚本由对 php 文件的 ajax $.get 请求执行。

现在，由于我已登录，我想导航（不是真正的“导航”，只是直接发出 $.post 请求）到另一个页面，但我想在 Javascript/Ajax 中执行此操作；但是，要成功加载页面，保持身份验证的唯一方法是读取 cookie。我试图弄清楚如何将 cookie 文件中的所有 cookie 设置到 $.post 请求的标头中，以便我得到适当的响应，而不是“您需要登录”响应。

我敢肯定这看起来有点奇怪。但这就是我想要做的。有任何想法吗？

另外请记住，我正在尝试将 cookie 发送到另一个域，而不是我自己的域。不确定这是否是一个问题...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:15:07.677

如果您在服务器端进行身份验证，收集一个 cookie，您希望重播以进行进一步访问，那么这些访问也需要在服务器端完成。

从客户端的角度来看，cookie 存储在浏览器中。出于明显的安全原因，网页无法修改客户端的 cookie 存储，因此您无法将从您的服务器复制的 cookie“添加”到您希望进行身份验证的任何客户端。

目标网站应公开一个跨站点 js API，如 Facebook、gmail 或其他此类 API，以便识别您的客户。

# mysql - 将 .bak 文件转换为 .sql 文件

> ID：12661854
> 
> 赞同：11
> 
> 时间：2012-09-30T14:08:11.983
> 
> 标签：mysql, sql-server, phpmyadmin

我有一个*asp*脚本，我打算用*PHP*编写它，所以我必须获取它的数据库并使用它。

我将数据库作为**.bak**文件，我知道它是一个备份，我想将其更改为**.sql**以将其导入 phpMyAdmin

我在网上阅读了有关此问题的信息，但没有找到贯穿整个过程的准确教程。

他们在谈论**mssql** 数据库，但我什至没有达到这一步..

任何帮助将不胜感激。提前致谢 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T14:15:08.197

请注意，所有这些都适用于 MS SQL，因为 .bak 通常是 MS SQL 备份。

.bak 不能直接转换为 SQL - 它包含与 SQL 没有明确关系的数据库的备份。

您可以恢复备份，然后使用 SQL Server 工具，然后使用它来创建一些 SQL 来重新创建 SQL Server 对象而不是 dat。

> 从 SQL Server Management Studio：Databases 项，右键单击“Restore Database”，然后从数据库右键单击脚本数据库。

这不会为数据编写脚本。

* * *

另一种选择是使用 RedGate 的优秀工具，它应该可以满足您的所有需求。

[http://www.red-gate.com/products/sql-development/sql-toolbelt/](http://www.red-gate.com/products/sql-development/sql-toolbelt/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T14:13:21.033

.bak 文件很可能确实是 Microsoft SQL Server 数据库的二进制备份（这与 MySQL 完全不同）。

因此，您首先需要将 Microsoft SQL Server (Express) 与 SQL Server Management Studio 一起安装（我认为有一个捆绑下载“SQL Server Express 包括工具”。

然后，您可以在 Management Studio 中将 .bak 文件导入新数据库。导入完成后，您可以使用它从数据库中创建 SQL 脚本。

# asp.net-mvc - 如何在请求中保留为文件类型输入选择的文件？

> ID：12661855
> 
> 赞同：2
> 
> 时间：2012-09-30T14:08:18.470
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我`input type="file"`在某些视图中有一个标签。当我提交表单时，如果存在验证问题并且我的控制器操作返回相同的/视图模型但出现验证错误，则为文件输入选择的文件将被清除。我怎样才能保留这个选定的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:33:10.683

您通常会使用`input type="password"`标签获得相同的行为。这是浏览器中的一种安全措施，用于帮助保护用户免受恶意服务器的侵害，这些服务器可能会尝试通过在文件上传字段中预先填充用户的私人敏感文件来获取对它们的访问权限。

如果文件无效，为什么要保留它？

**回复评论**

如果是这种情况，您应该能够处理客户端上的其他字段验证，而无需进行完整的回发。这将保留用户的文件上传条目，因为在发现验证错误后服务器不会重新呈现页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T15:35:16.957

AFAIK 出于安全原因，这是不可能的。您无法设置`value`文件输入字段的属性，这就是您无法在回发后填充它的原因。

# matlab - 在 Matlab 中将时代转换为日期

> ID：12661862
> 
> 赞同：9
> 
> 时间：2012-09-30T14:09:27.870
> 
> 标签：matlab, utc, epoch

我在 Matlab 中有一个 Epoch 毫秒数组（数字数组）。我想将这些转换为 UTC 日期时间格式，例如 DD-MM-YYYY HH:MM。

是否有预定义的 Matlab 方法来执行此操作，或者我必须编写自己的函数？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-30T17:28:38.580

假设你从一个向量开始`time_unix`，那么：

```
>> time_unix = 1339116554872; % example time
>> time_reference = datenum('1970', 'yyyy'); 
>> time_matlab = time_reference + time_unix / 8.64e7;
>> time_matlab_string = datestr(time_matlab, 'yyyymmdd HH:MM:SS.FFF')

    time_matlab_string =

    20120608 00:49:14.872 
```

笔记：

1）见matlab的时间定义。

2) 8.64e7 是一天中的毫秒数。

3) Matlab 不应用任何时区偏移，因此结果是相同的 UTC 时间。

4）后向变换示例：

```
>> matlab_time = now;
>> unix_time = round(8.64e7 * (matlab_time - datenum('1970', 'yyyy')))

unix_time =

             1339118367664 
```

总结一下，这里有两个功能：

```
function tm = unix2matlab(tu)
    tm = datenum('1970', 'yyyy') + tu / 864e5;
end
function tu = matlab2unix(tm)
    tu = round(864e5 * (tm - datenum('1970', 'yyyy')));
end 
```

这里的 matlab 时间是数字的。您始终可以使用 datestr() 将其转换为字符串

**更新**纳秒

```
time_unix_nanos = 1339116554872666666;
millis = round(time_unix_nanos / 1e6);
nanos = time_unix_nanos - 1e6 * millis;
time_matlab = unix2matlab(millis);
s = [datestr(time_matlab, 'yyyymmdd HH:MM:SS.FFF'), num2str(nanos)];

        s =
        20120608 00:49:14.872666666 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-28T12:31:11.190

我尝试了上面的代码，但结果是错误的。我意识到主要错误与 Unix 时间（纪元时间）的尴尬定义有关。[Unix 时间（纪元时间）](http://en.wikipedia.org/wiki/Unix_time)定义为 1970 年 1 月 1 日 00h:00 之后的**秒数**，而不是 **milli** 秒数（[http://en.wikipedia.org/wiki/Unix_time](http://en.wikipedia.org/wiki/Unix_time)）。根据这个定义，Unix 时间应该除以 8.64e5 而不是 8.64e7。

此外，`datenum('1970', 'yyyy')`似乎不会导致所需的参考时间为 1-1-1970, 00h:00。

这是我改进的代码：

```
tMatlab = datenum (1970,1,1,0,0) + tUnix / 86400; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-25T16:45:51.160

Serg 的答案是我在 MATLAB 中工作时通常使用的答案。今天我发现自己想*在 MATLAB 中转换为日期，*如标题所述 - 没有在问题正文中指定日期字符串转换 - 并从 shell 输出日期编号。

这是我确定的四舍五入日期数字：

```
TODAY_MATLAB="$[719529 + $[`date +%s` / 24/60/60]]" 
```

这实际上只是您所期望的 bash 等价物：719529 是时代的日期编号（1970-01-01 或`datenum(1970,1,1)`在 MATLAB 中）。我最近也在摸索ksh，似乎可以通过以下方式完成：

```
TODAY_EPOCH=`date +%s`
TODAY_MATLAB=`expr $TODAY_EPOCH / 24 / 60 / 60 + 719529` 
```

作为一个附带练习，我将小数部分添加回*bash*中的日期- 我没有在 ksh 中打扰，但它只是算术并且类似：

```
N_DIGITS=7
FORMAT=$(printf "%%d.%%0%dd" $N_DIGITS)

NOW_EP_SEC=`date +%s` 
SEC_PER_DAY=$(( 24*60*60 )) 
NOW_EP_DAY=$(( $NOW_EP /$SEC_PER_DAY ))  
SEC_TODAY=$(( $NOW_EP_SEC - $NOW_EP_DAY*$SEC_PER_DAY )) 

TODAY_MATLAB="$(( NOW_EP_DAY+719529 ))"
FRACTION_MATLAB="$( printf '%07d' $(( ($SEC_TODAY*10**$N_DIGITS)/SEC_PER_DAY )) )"
MATLAB_DATENUM=$( printf $FORMAT $TODAY_MATLAB $FRACTION_MATLAB )

echo $MATLAB_DATENUM 
```

# c# - 显示列表 在列表视图中

> ID：12661866
> 
> 赞同：0
> 
> 时间：2012-09-30T14:11:01.967
> 
> 标签：c#, .net, listview

我有一个清单：

```
public class Person
{
    public decimal n1 { get; set; }
    public decimal n2 { get; set; }
}

List<Person> dbItems = new List<Person>();

public void getinfo(int id)
{
    using (var con = new SqlConnection(connectionString))
    {
        con.Open();
        string query = "select * from Zboruri where cod_decol_ateriz = " + id;
        var resQuery = new List<Person>();
        using (var com = new SqlCommand(query, con))
        {
            var reader = com.ExecuteReader();
            int a = reader.GetOrdinal("number1");
            int b = reader.GetOrdinal("number2");
            while (reader.Read())
            {
                resQuery.Add(new Person { 
                    n1 = reader.GetDecimal(a),
                    n2 = reader.GetDecimal(b)
                });
            }
        }
    } 
```

我希望在列表视图中显示此列表，但我不知道如何。我知道我必须使用`foreach`，但是如何使用？请给我一个例子如何！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T06:49:42.227

```
 <asp:ListView ID="ListView1" runat="server">
    <ItemTemplate> 
    <asp:Label Text='<%#Eval("n1")%>' runat="server"></asp:Label>
    </ItemTemplate>
    </asp:ListView>

  public class Person
    {
        public string n1 { get; set; }
        public string n2 { get; set; }
    }

        List<Person> list = new List<Person>();
        list.Add(new Person { n1 = "A", n2 = "A" });
        list.Add(new Person { n1 = "B", n2 = "B" });
        list.Add(new Person { n1 = "C", n2 = "C" });
        list.Add(new Person { n1 = "D", n2 = "D" });
        list.Add(new Person { n1 = "E", n2 = "E" });

        ListView1.DataSource = list;     
        ListView1.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T15:11:36.817

这是一个非常简单的问题。我不知道我理解的对吗？

```
 ListView L = new ListView();

        foreach (Person P in resQuery)
        {
            L.Items.Add(P.n1);//if name is a string property
        }
        Controls.Add(L); 
```

# java - 使 BufferedImage 中的黑色像素变亮

> ID：12661867
> 
> 赞同：2
> 
> 时间：2012-09-30T14:11:06.907
> 
> 标签：java, graphics, bufferedimage

我`RescaleOp`用来提亮我的图像，我的问题是，如果我使用黑色（0,0,0）和白色（255,255,255），它们会完全一样。

我可以猜到为什么，0（黑色 RGB 值）x 1.3（亮度因子）= 0，而白色像素不能高于 255，所以它们保持不变，我对白色像素保持不变感到满意。

另一方面，如果我使图像变暗，我会得到想要的结果，因为白色像素变暗，255（白色 RGB 值）* .8（亮度因子）=/= 255，黑色像素不能低于0 所以它们保持不变。

如何使黑色像素变亮，就像使用 BufferedImageOp 使白色像素变暗一样？

这是重新缩放操作

```
 float scale = 1.3f;//This is the aformentioned "Brightness Factor"
        RescaleOp op = new RescaleOp(new float[] {scale,scale,scale, 1}, new float[4], null);
        BufferedImage brightImage = op.filter(...); 
```

感谢当前的答案，但我不知道如何将它们应用于我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:15:09.120

您将不得不从最大值开始。亮度因子代表什么并不明显，因此您可能需要在这里进行一些试错研究。一种方法可能是：

```
int newValue = (int) (255 - (255 / 1.3)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:18:53.243

任何乘以 0 都是 0。使用否定方法。

最大值 - （最大值/亮度因子）。

255-255/1.3 在你的情况下。

将其存储在整数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-29T16:33:26.700

选项：

*   编写一个扩展 RescaleOp 的自定义 RasterOp 以提供您想要的行为（特别是，如果值 = 0 && 比例因子 > 1，则新值 = 1 * 比例因子 = 比例因子）
*   串行使用两个 RasterOps。第一个将具有 1 的比例因子和 1 的偏移量（使一切都稍微亮一点）。第二个将是您已经定义的现有 RasterOp。它比第一个更混乱，可能更慢，但实现起来可能更简单。

# facebook - Facebook SDK 3.1 和 MonoTouch

> ID：12661868
> 
> 赞同：1
> 
> 时间：2012-09-30T14:11:07.983
> 
> 标签：facebook, xamarin.ios

有没有办法在我的 monotouch 应用程序中使用新的 facebook sdk？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:20:20.290

您是否尝试过在这里使用 MonoTouch 绑定：[https ://github.com/mono/monotouch-bindings/tree/master/facebook](https://github.com/mono/monotouch-bindings/tree/master/facebook)

# javascript - asp.net + 访问从 CodeBehind 回发的 JS 中分配的 HiddenField 值

> ID：12661873
> 
> 赞同：1
> 
> 时间：2012-09-30T14:11:40.253
> 
> 标签：javascript, asp.net

我试图从后面的代码中访问我的隐藏字段值，但我得到了空值，我在这里做的是从 Javascript 函数设置 2 个隐藏字段值，然后通过 asp:button click 进行回发。不知道我在这里做错了什么，请协助：

谢谢。

```
 <form id="Form1" class="form" runat="server">

            <p class="SearchAddress">
                <asp:TextBox ID="searchTextField" runat="server" />
                <label for="searchTextField">
                    Location</label>
            </p>
            <p class="Date">
                <asp:TextBox ID="txtDate" runat="server">18/10/2012</asp:TextBox>
                <label for="txtDate">
                    Date</label>
            </p>
            <p class="TimeFrom">
                <asp:TextBox ID="TimeFrom" runat="server">18:00</asp:TextBox>
                <label for="txtTimeFrom">
                    Time From</label>
            </p>
            <p class="TimeTo">
                <asp:TextBox ID="TimeTo" runat="server">19:00</asp:TextBox>
                <label for="txtTimeTo">
                    Time To</label>
            </p>

            <p class="submit">
                <asp:Button ID="btnCalculateCoordinates" runat="server" Text="Post It!" 
                  onClientclick="calculateCoordinates();" onclick="btnCalculateCoordinates_Click" 
            />
           </p>

            <asp:ScriptManager ID="ScriptManager1" runat="server" />
            <asp:UpdatePanel ID="uppnlLatLong" runat="server" UpdateMode="Conditional">
            <ContentTemplate>
                         <asp:HiddenField ID="txtLatitude" runat="server"  />
                         <asp:HiddenField ID="txtLongitude" runat="server" />
             </ContentTemplate>
           </asp:UpdatePanel>
            </form>

      function calculateCoordinates() {
                    var txtAddress1 = document.getElementById('<%=searchTextField.ClientID%>');
                    var txtLat = document.getElementById('<%=txtLatitude.ClientID%>');
                    var txtLng = document.getElementById('<%=txtLongitude.ClientID%>');

                    var address = txtAddress1.value + ', ';

                    var geocoder;
                    geocoder = new google.maps.Geocoder();

                    geocoder.geocode({ address: address }, function (results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {
                            var location = results[0].geometry.location;
                            txtLat.value = location.lat(); //SETTING THE HIDDENFIELD VALUE
                            txtLng.value = location.lng(); //SETTING THE HIDDENFIELD  VALUE
                        }
                        else
                            alert('Opps, sorry but we are unable to locate' + $(txtAddress1).val());
                    });
            }
        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:13:31.780

您还需要将生成事件的命令放在更新面板中以获取隐藏的 . 字段值。您需要将所有控制权放在参与 ajax 调用的更新面板中。

```
<form id="Form1" class="form" runat="server">
        <asp:ScriptManager ID="ScriptManager1" runat="server" />
        <asp:UpdatePanel ID="uppnlLatLong" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
                <asp:HiddenField ID="txtLatitude" runat="server"  />
                <asp:HiddenField ID="txtLongitude" runat="server" />
                <asp:Button ID="btnCalculateCoordinates" runat="server" Text="Post It!"  onClientclick="calculateCoordinates();" onclick="btnCalculateCoordinates_Click" /> 
```

您可以使用 ajax 事件 begin_request 的 asp .net 在调用服务器之前调用 ajax 方法。

```
Sys.WebForms.PageRequestManager.getInstance().remove_beginRequest(beginRequestHandler);

function BeginRequestHandler(sender, args)
{
       calculateCoordinates();
} 
```

# jquery - 我无法在 jQuery 上触发“点击”事件

> ID：12661874
> 
> 赞同：2
> 
> 时间：2012-09-30T14:11:54.677
> 
> 标签：jquery, click, eventtrigger

所以，我有一个听众：

```
$('div#Team div.wrap ul').on('click', 'li:not(.current)', function(){
...
} 
```

和

```
$('div#Team div.wrap ul li#' + hash.split("/")[1]).click(); 
```

但它不会触发，我检查了选择器是否使用了正确的 LI，并且它正在抓取正确的元素。我尝试手动将代码“...”复制并粘贴到我调用不起作用的“.click()”的位置（对***$(this)****进行了一些小的调整）***并且 id 也可以工作，但这意味着我有重复的代码，这是我不想要的。**

 **先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:15:13.103

jQuery 使用数组。

`click`将在*dom*对象上工作。

while`trigger('click')`将对*jquery 对象*起作用。

```
$('div#Team div.wrap ul li#' + hash.split("/")[1])[0].click(); 
```

或者

```
$('div#Team div.wrap ul li#' + hash.split("/")[1]).trigger('click'); 
```**

# mysql - MySQL 如果存在则更新，如果不存在则插入，如果不存在则删除（周计划配置文件）

> ID：12661875
> 
> 赞同：1
> 
> 时间：2012-09-30T14:11:54.863
> 
> 标签：mysql

我已经搜索了很长时间，但我没有找到我的问题的答案。首先让我解释一下我的问题来自哪里。

我有一个具有用户表单的 Web 应用程序，用户可以在其中指定他/她在一周中的哪几天有空以及这几天的办公时间。将其想象为一个 web 表单，其中包含 mo-su 复选框以及每个复选框/天的从时到时下拉列表。现在，如果将用户配置文件插入到数据库表中，我的表中有类似的内容：

```
idUser | idDay | fromTime | toTime

     1 |     0 |    08:00 |  09:00 
```

（在本例中，0 代表星期一 (0=mo - 6=su)）

当然还有更改用户资料的功能。因此，可能首先用户从早上 5 点到下午 3 点有空。现在配置文件已更改，因此用户只能在上午 5 点到下午 3 点使用，而我们只到下午 1 点和上午 9 点到下午 5 点，在这种情况下，我必须更新现有条目，以删除已删除的条目（本例中为周二）并插入新的可用天数。

现在我首先删除用户的所有条目，然后执行新的插入。这很容易，在这种情况下可能是最好的做法（因为每个用户最多有 7 个条目）。但是同样的问题可能会出现在不同的情况下，在这种情况下优化查询可能会更好。

所以最后我的问题是：是否可以执行更新（如果存在），如果不存在则插入并删除仅 ONE 查询中的所有其他条目？

我希望我的问题是可以理解的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:19:40.760

您不能在 1 个查询中执行`INSERT`AND `UPDATE`AND 。`DELETE`

你有一些选择：

*   在**MySql**中：编写一个存储过程来处理您的问题，并调用存储过程来执行任务。来自 PHP 的 1 次调用即可完成工作。
*   在**PHP**中：编写一些代码来执行任务并将其包装在事务中。

如果你问什么是完成工作的最佳方法，你可能会挑起一场战争。我把钱花在了 PHP 解决方案上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:36:26.650

最简单的事情就是删除所有实例，然后为更新的条目创建一个新的计划。听起来您正在尝试对流程进行一些过早的优化，恕我直言，这是不必要的。如果您发现删除所有现有条目并替换它们是性能瓶颈，那么您可能需要考虑使用一种尝试最小化额外插入的方法，但我认为这实际上可能会比简单的选项更简单删除所有内容并替换它

# email - 谷歌使用哪个代码来格式化电子邮件（不是 bbcode）

> ID：12661878
> 
> 赞同：2
> 
> 时间：2012-09-30T14:12:28.253
> 
> 标签：email, formatting, gmail

一旦我尝试从 gmail 向自己（webmaster@mydomain_name.com.np）发送电子邮件。我收到的邮件，粗体被“**”符号包围，我确定不是bbcode，它类似于我们提问时stackoverflow使用的那些，希望我能得到答案，我很抱歉我的语法不好，如果我不能让你理解，我非常抱歉。

# algorithm - 按时间戳和手动排序照片

> ID：12661879
> 
> 赞同：1
> 
> 时间：2012-09-30T14:12:39.117
> 
> 标签：algorithm, workflow

# 语境

我正在开发一个小型网络应用程序来存储照片。照片是根据时间戳（拍摄日期）排序的，效果很好。这是数据库的简化视图：

```
+--------------+-------------------+
|      id      |     timestamp     |
+--------------+-------------------+
|       1      |    1000000003     |
|       2      |    1000000000     |
+--------------+-------------------+ 
```

现在我想添加重新排序照片的可能性。而且我找不到没有任何缺点的方法。

# 我做了什么

我首先在表格中添加了一列以保存自定义订单。

```
+--------------+-------------------+-------------+
|      id      |     timestamp     |    order    |
+--------------+-------------------+-------------+
|       1      |    1000000003     |      1      |
|       2      |    1000000000     |      2      |
+--------------+-------------------+-------------+ 
```

**第一个问题：**我相信我不能根据两个不同的标准来排序照片，因为很难知道哪个必须优先。

所以我使用`order`列来订购它们，而且**只有**这一列。当我添加`order`列时，我给每张照片一个值，以便保持当前顺序。我现在有按`order`订购时的顺序排列的照片`timestamp`。

我现在可以手动重新排序一些照片，而其他照片将保留在它们所属的位置。**第一个问题已经解决了。**

但现在，我想添加一张新照片。

**第二个问题：**我知道我添加的新照片是什么时候拍摄的，但我的照片不再按他们的顺序排列`timestamp`了。这张照片需要正确排序，因此它需要一个正确的`order`值。

这就是问题所在：*正确* `order`的值。

以下是我可以处理新照片的两种方法：

*   给它一个`order`比其他更大的价值。在前面的表格中，将给出一张新照片`order = 3`。这显然是一个坏主意，因为它没有考虑其时间戳。最近的照片仍将是最后显示的照片。
*   根据其时间戳将其“插入”它所属的位置。再看同一张表，如果新照片的时间戳为`1000000002`，则给出新照片`order = 2`，`order`每张照片的 都加 1。

第二种解决方案看起来不错，除了在一种情况下：如果手动将照片 #2 的顺序更改为 50，`order = 50`即使它属于第一张照片（根据其时间戳），也会给出新照片。

# 我需要的

我需要的是一种根据时间戳**和**手动设置的顺序对照片进行排序的方法。

**也许您对我强调的第二个问题**有解决方案，或者您可能知道解决此问题的另一种方法。不管怎样，谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:22:37.157

在您的问题中，您从未提及计算机或编程语言。这没关系（实际上，这是一个很好的方法，在编码之前将问题和解决方案写在纸上），这是一个也忽略计算机和编程语言的答案。

把你所有的照片按照你拿到它们的顺序放进一个鞋盒里。

现在，拿三张纸：

在第 1 页上写下从 1 到 N 的数字（一个到一行）（盒子可以容纳的照片数量）。每当您将照片放入盒子中时，请在与其在盒子中的顺序相对应的行上写下其时间戳。

在第 2 页上，将照片 1 的时间戳记下几行。在同一行写一个 1。对于下一张照片，在纸上的适当位置写下它的时间戳，上下留出尽可能多的空间，以便将来插入照片。在同一行写一个 2。继续直到行之间的空间用完，当您需要将所有信息复制到具有更多插入空间的新版本页面上时。此页的信息与第 1 页的信息相同，但每行的两个数字交换位置。

在第 3 页再次写下从 1 到 N 的数字。当您收集每张照片时，将第 1 页上的编号（即所有照片编号顺序中的编号）写在您手动设置排序的正确位置。您可能需要在此页面上进行大量的删改和重写，因为您决定应将后来者插入此页面的高位。

现在你有：

*   存放照片的商店，鞋盒；您应该已经意识到您不能一次存储多个订单的照片；
*   三个索引（如果您愿意，可以使用索引）；第一个是固定的，只是为每张照片分配一个唯一的序列号；它还会告诉您框中每张照片的时间戳；
*   第二个索引使您可以在给定时间戳的情况下找到照片的唯一序列号，然后在鞋盒中找到该照片；
*   第三个索引可让您随意订购照片；每行的第一个数字是排序顺序中的序列号，第二个数字是第一个索引中照片的唯一序列号。

所有这些都是一种非常冗长的方式告诉您，由于您不能（在鞋盒或计算机化数据存储中）同时保存多个订单的照片，因此您必须为您希望的订单维护索引采用。这些索引直接或间接地从一个数字指向鞋盒中的某个位置（这就是索引的作用）。

# c# - 在实体框架中更新时排除属性

> ID：12661881
> 
> 赞同：88
> 
> 时间：2012-09-30T14:13:07.763
> 
> 标签：c#, entity-framework

我一直在寻找一种正确的方法来标记在 MVC 中更新模型时不会更改的属性。

例如，让我们以这个小模型为例：

```
class Model
{
    [Key]
    public Guid Id {get; set;}
    public Guid Token {get; set;}

    //... lots of properties here ...
} 
```

那么 MVC 创建的编辑方法如下所示：

```
[HttpPost]
public ActionResult Edit(Model model)
{
    if (ModelState.IsValid)
    {
        db.Entry(model).State = EntityState.Modified;
        db.SaveChanges();
        return RedirectToAction("Index");
    }
    return View(model);
} 
```

现在，如果我的视图不包含令牌，它将通过该编辑无效。

我正在寻找这样的东西：

```
db.Entry(model).State = EntityState.Modified;
db.Entry(model).Property(x => x.Token).State = PropertyState.Unmodified;
db.SaveChanges(); 
```

到目前为止我发现的最好方法是包容并手动设置我想要包含的所有属性，但我真的只想说要排除哪些属性。

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2013-07-10T11:54:55.577

我们可以这样使用

```
 db.Entry(model).State = EntityState.Modified;
 db.Entry(model).Property(x => x.Token).IsModified = false;
 db.SaveChanges(); 
```

它将更新但没有 Token 属性

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2019-09-05T15:14:38.850

任何正在寻找如何在 EF Core 上实现这一目标的人。基本相同，但您的 IsModified 需要在添加要更新的模型之后进行。

```
db.Update(model);
db.Entry(model).Property(x => x.Token).IsModified = false;
db.SaveChanges(); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-30T15:26:32.773

创建具有要更新的有限属性集的新模型。

即，如果您的实体模型是：

```
public class User
{
    public int Id {get;set;}
    public string Name {get;set;}
    public bool Enabled {get;set;}
} 
```

您可以创建自定义视图模型，允许用户更改名称，但不允许更改标志：

```
public class UserProfileModel
{
   public int Id {get;set;}
   public string Name {get;set;}
} 
```

当您想要进行数据库更新时，请执行以下操作：

```
YourUpdateMethod(UserProfileModel model)
{
    using(YourContext ctx = new YourContext())
    { 
        User user = new User { Id = model.Id } ;   /// stub model, only has Id
        ctx.Users.Attach(user); /// track your stub model
        ctx.Entry(user).CurrentValues.SetValues(model); /// reflection
        ctx.SaveChanges();
    }
} 
```

当您调用此方法时，您将更新 Name，但 Enabled 属性将保持不变。我使用了简单的模型，但我想你会知道如何使用它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-04-08T07:07:39.503

我做了一个简单的方法来编辑我将与你分享的实体的属性。此代码将编辑实体的名称和家庭属性：

```
 public void EditProfileInfo(ProfileInfo profileInfo)
    {
        using (var context = new TestContext())
        {
            context.EditEntity(profileInfo, TypeOfEditEntityProperty.Take, nameof(profileInfo.Name), nameof(profileInfo.Family));
        }
    } 
```

并且此代码将忽略编辑实体的名称和家庭属性，它将编辑另一个属性：

```
 public void EditProfileInfo(ProfileInfo profileInfo)
    {
        using (var context = new TestContext())
        {
            context.EditEntity(profileInfo, TypeOfEditEntityProperty.Ignore, nameof(profileInfo.Name), nameof(profileInfo.Family));
        }
    } 
```

使用这个扩展：

```
public static void EditEntity<TEntity>(this DbContext context, TEntity entity, TypeOfEditEntityProperty typeOfEditEntityProperty, params string[] properties)
   where TEntity : class
{
    var find = context.Set<TEntity>().Find(entity.GetType().GetProperty("Id").GetValue(entity, null));
    if (find == null)
        throw new Exception("id not found in database");
    if (typeOfEditEntityProperty == TypeOfEditEntityProperty.Ignore)
    {
        foreach (var item in entity.GetType().GetProperties(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.GetProperty))
        {
            if (!item.CanRead || !item.CanWrite)
                continue;
            if (properties.Contains(item.Name))
                continue;
            item.SetValue(find, item.GetValue(entity, null), null);
        }
    }
    else if (typeOfEditEntityProperty == TypeOfEditEntityProperty.Take)
    {
        foreach (var item in entity.GetType().GetProperties(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.GetProperty))
        {
            if (!item.CanRead || !item.CanWrite)
                continue;
            if (!properties.Contains(item.Name))
                continue;
            item.SetValue(find, item.GetValue(entity, null), null);
        }
    }
    else
    {
        foreach (var item in entity.GetType().GetProperties(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.GetProperty))
        {
            if (!item.CanRead || !item.CanWrite)
                continue;
            item.SetValue(find, item.GetValue(entity, null), null);
        }
    }
    context.SaveChanges();
}

public enum TypeOfEditEntityProperty
{
    Ignore,
    Take
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-01T08:47:58.637

我猜您不希望仅在某些情况下更改属性，因为如果您不打算在应用程序中使用它，只需将其从模型中删除即可。

如果您只想在某些情况下使用它并避免在上述情况下“无效”，您可以尝试：

*   用 HiddenFor 在视图中隐藏参数：

    `@Html.HiddenFor(m => m.Token)`

这将使您的原始值保持不变并传递回控制器。

*   使用`TryUpdateModel`： http: [//msdn.microsoft.com/en-us/library/dd460189 (v=vs.108).aspx](http://msdn.microsoft.com/en-us/library/dd460189(v=vs.108).aspx)

从您的控制器中再次加载您的对象`DBSet`并运行此方法。您可以指定应更新或不应更新的参数的白名单和黑名单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-08T21:25:04.997

我使用 dapper，但我的解决方案也适用于 EF。如果您将来可能要更改您的 ORM，我的解决方案可能对您更好。

```
class Model
{
    public Foo { get; set; }
    public Boo { get; set; }
    public Bar { get; set; }
    // More properties...

    public void SafeUpdate(Model updateModel, bool updateBoo = false)
    {
        // Notice Foo is excluded

        // An optional update
        if (updateBoo)
            Boo = updateModel.Boo;

        // A property that is always allowed to be updated
        Bar = updateModel.Bar;

        // More property mappings...
    }
} 
```

如您所见，我只允许更新我希望的属性。

我的方法的一个缺点是，如果您向模型引入新属性（允许更新），则需要手动更新此方法。但我相信这并不总是一个缺点，但有时是一个优点，因为您需要了解正在更新的内容，这在安全性方面可能是有益的。

让我们看一下这种方法的演示。

```
// Some code, DI etc...

public IActionResult Put([FromBody] Model updateModel)
{
   var safeModel = new Model();
   safeModel.Update(updateModel);

   // Add validation logic for safeModel here...

   _modelRepository.Update(safeModel);
} 
```

# php - 使用递归目录迭代器

> ID：12661885
> 
> 赞同：4
> 
> 时间：2012-09-30T14:13:52.653
> 
> 标签：php

> **可能重复：**
> [显示文件夹并建立这些文件夹的链接](https://stackoverflow.com/questions/6218145/displaying-folders-and-making-links-of-those-folders)

我正在尝试使用 RecursiveDirectoryIterator 创建一个简单的文件浏览器，但似乎无法弄清楚...有什么帮助吗？

```
$cwd = '/path/to/somewhere';
if(isset($_GET['path']) && is_dir($cwd.$_GET['path'])) {
    $cwd .= $_GET['path'];
}

$dir = new RecursiveDirectoryIterator($cwd);
$iter = new RecursiveIteratorIterator($dir, RecursiveIteratorIterator::SELF_FIRST);
while($iter->valid()) {
    // skip unwanted directories
    if(!$iter->isDot()) {
        if($iter->isDir()) {
            // output linked directory along with the number of files contained within
            // for example: some_folder (13)
        } else {
            // output direct link to file
        }
    }
    $iter->next();
} 
```

不确定这是否是最好的方法，但我的印象是 RecursiveDirectoryIterator 比 opendir() 和 glob() 方法都快。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-30T14:36:38.257

`SELF_FIRST`与但`CHILD_FIRST`无关`RecursiveDirectoryIterator``RecursiveIteratorIterator`

如果你跑

```
$iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir), RecursiveIteratorIterator::SELF_FIRST );

foreach ( $iterator as $path ) {
    if ($path->isDir()) {
        print($path->__toString() . PHP_EOL);
    } else {
        print($path->__toString() . PHP_EOL);
    } 
```

你会得到

```
...\htdocs\lab\stockoverflow\css
...\htdocs\lab\stockoverflow\css\a.css
...\htdocs\lab\stockoverflow\css\b.css
...\htdocs\lab\stockoverflow\css\c.css
...\htdocs\lab\stockoverflow\css\css.php
...\htdocs\lab\stockoverflow\css\css.run.php 
```

如果您将其更改为`RecursiveIteratorIterator::CHILD_FIRST`

```
...\htdocs\lab\stockoverflow\css\a.css
...\htdocs\lab\stockoverflow\css\b.css
...\htdocs\lab\stockoverflow\css\c.css
...\htdocs\lab\stockoverflow\css\css.php
...\htdocs\lab\stockoverflow\css\css.run.php
...\htdocs\lab\stockoverflow\css 
```

你能看到区别在于当前文件夹的位置吗

# objective-c - 如何通过拖动鼠标在 Interface Builder 中复制视图？

> ID：12661886
> 
> 赞同：3
> 
> 时间：2012-09-30T14:14:06.000
> 
> 标签：objective-c, xcode, interface-builder

在 Visual Studio 中，我只需在拖动视图时按 Ctrl 即可。视图被复制而不是移动。

我如何在 Objective-c 的 Interface Builder 中做同样的事情

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-30T14:21:01.043

command + d 将复制一个视图，尽管我不知道执行此操作的拖动方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-30T14:35:45.353

如果您使用 alt 拖动视图，则可以复制视图。

# objective-c - 如何将 NSData 原始字节直接编码为 UTF-16 (Unicode)？

> ID：12661890
> 
> 赞同：1
> 
> 时间：2012-09-30T14:14:38.997
> 
> 标签：objective-c, ios, encoding, nsdata

环境：iOS Xcode Objective-C 乱码 Unicode UTF-16

我的问题：

我从远程文件中获取文件内容，然后将其存储到 NSData 对象中，然后我想将 NSData 转换为 Unicode 编码（注意：不是 UTF-8，UTF-16 可以），问题是我不知道原始文件内容编码，如何将未知的原始字节转换为 Unicode (UTF-16)？

我尝试了很多方法，但没有人成功触及我的目标，代码：

```
NSData *chunk = [NSData dataWithContentsOfURL:url];
NSString* newStr = [[[NSString alloc] initWithData:chunk encoding:NSUTF16LittleEndianStringEncoding]  autorelease];
NSData* d = [newStr dataUsingEncoding:NSUnicodeStringEncoding];
[d writeToFile:newFilePath atomically:YES]; 
```

将文件放入 NSData，将其编码为 Unicode 并写入文件。

```
NSString*  converted_str = [[NSString alloc] initWithData:chunk encoding:NSUTF8StringEncoding];
NSData * d = [(id)CFStringCreateExternalRepresentation(NULL, (CFStringRef)converted_str, kCFStringEncodingUnicode, 0) autorelease];
[d writeToFile:newFilePath atomically:YES]; 
```

将 NSData 转换为 NSString，然后将其恢复为 NSData 以写入文件，不起作用。

```
[converted_str writeToFile:newFilePath atomically:YES encoding:NSUnicodeStringEncoding error:&error]; 
```

使用 NSString 对象直接写入文件，乱码。

```
CFStringRef converted_str = CFStringCreateWithBytes(NULL, [chunk  bytes],[chunk length], kCFStringEncodingUTF8,false);  
CFStringRef newStr = [chunk dataUsingEncoding:NSUTF8StringEncoding];
NSData * d = [(id)CFStringCreateExternalRepresentation(NULL, (CFStringRef)big5Str, NSUnicodeStringEncoding, 0) autorelease];
[d writeToFile:newFilePath atomically:YES]; 
```

用cString做编码工作，也是失败。

```
char converted[([chunk length] + 1)];
[chunk getCString:converted maxLength:([chunk length] + 1) encoding: NSWindowsCP1251StringEncoding];
NSLog(@"converted:%s", converted);
NSString *converted_str = [NSString stringWithCString:converted encoding:NSUnicodeStringEncoding];
NSLog(@"converted_str:%@", converted_str); 
```

我还使用 usedEncoding:&xxx 来获取原始文件编码，然后尝试使用返回的编码将其解码为字符串对象，...，再次失败。

```
NSStringEncoding encoding;
NSString *chunk = [[NSString alloc] initWithContentsOfURL:[rb fileURL] usedEncoding:&encoding error:&error];
... 
```

然后我尝试使用 kCFStringEncodingUTF16 来获取 Unicode 编码的缓冲区，但是失败了。

```
NSStringEncoding encode = CFStringConvertEncodingToNSStringEncoding(kCFStringEncodingUTF16);
NSString *chunk = [NSString stringWithContentsOfURL:url encoding:encode error:&error]; 
```

最后，我想尝试iOS（iPhone，iPad）的libiconv，但问题是源内容的编码未知， usedEncoding:&xxx 函数总是不能工作。

我不知道这个麻烦... :(

有没有人遇到类似的问题，请给我一些指导，任何答案将不胜感激，谢谢。

衷心祝愿您和您的家人幸福健康。

# javascript - 如何自动设置下拉列表的大小？

> ID：12661892
> 
> 赞同：2
> 
> 时间：2012-09-30T14:14:47.810
> 
> 标签：javascript, web, greasemonkey, dom-manipulation

我正在尝试在 Greasemonkey 中编写一个脚本，该脚本将自动设置下拉列表的大小（可以有多个......）选择选项的数量，但由于我有限的 JavaScript 知识，我真的不知道知道如何做到这一点。

主题示例：

```
<select name="z_pos_id">
<option value="2463">Option A</option>
<option value="2609">Option B</option>
<option value="3013">Option C</option>
</select>

<select name="z_pos_id">
<option value="140">Option AA</option>
<option value="3038">Option AB</option>
<option value="3519">Option AC</option>
<option value="2645">Option AD</option>
</select> 
```

所需输出的示例：

```
<select size="3" name="z_pos_id">
<option value="2463">Option A</option>
<option value="2609">Option B</option>
<option value="3013">Option C</option>
</select>

<select size="4" name="z_pos_id">
<option value="140">Option AA</option>
<option value="3038">Option AB</option>
<option value="3519">Option AC</option>
<option value="2645">Option AD</option>
</select> 
```

所以，`<select name="z_pos_id">`应该用这个代替：

```
<select size="*the number of options*" name="z_pos_id"> 
```

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:39:05.540

这是一个完整的脚本。它应该是不言自明的：

```
// ==UserScript==
// @name     _Auto-size select selects.
// @include  http://YOUR_SERVER.COM/YOUR_PATH/*
// @grant    none
// ==/UserScript==

var posIdSelects = document.querySelectorAll ("select[name=z_pos_id]");
for (var J = posIdSelects.length - 1;  J >= 0;  --J) {
    var numOpts  = posIdSelects[J].getElementsByTagName ("option").length;
    posIdSelects[J].setAttribute ("size", numOpts);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:39:33.967

```
$(document).ready(function() {
    var ln = $("select[name=z_pos_id] option").length ;
    alert(ln); // you can delete this alert after your test
        $("select[name=z_pos_id]").attr('size', ln);
}); 
```

# html - Firefox 在页脚标记后添加空格

> ID：12661901
> 
> 赞同：0
> 
> 时间：2012-09-30T14:16:23.610
> 
> 标签：html, css, firefox, footer

这不会发生在 chrome 或 ie 中。相反，Firefox 在我的页脚后添加了 50px。使用分析元素和萤火虫，它表明该空间在 html 标记之外。这是链接： http: [//www.sociallab.ro/index_romana](http://www.sociallab.ro/index_romana) 谢谢！

html:

```
<html>
 <body>
  <div id="main">
  </div>
  <footer>
    <a href="http://www.messagelab.ro" target="_blank"><div class="message_lab"><img src="images/logo_mic.png" alt="Tineret in Actiune"/></div></a>
  </footer>
 </body>
</html> 
```

CSS：

```
html{ 
 margin: 0;
 padding: 0;
}
footer{position:relative; 
 top: -50px; 
width:1060px; 
height:50px; 
overflow:hidden;
text-align: center;
margin:0 auto;
padding:0;}
body{
     margin-top:0px;
     margin:0 auto;
     padding:0;
     text-align: center;
     height: 1950px !important; 
background:url(../images/bg.png) left top repeat; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T14:25:31.077

### 一些东西：

1.  `<div>`标签内不应该有`<a>`标签。
2.  有一个`height`for`body`和`#wrap`。
3.  对于`footer`，请删除 并将其`top: -50px;`替换为否定`margin`的 as `margin-top: -50px;`。

### 使页脚链接居中对齐

不使用 div，使用这种方式：

```
<footer>
    <a target="_blank" href="http://www.messagelab.ro">
        <img alt="Tineret in Actiune" src="images/logo_mic.png">
    </a>
</footer> 
```

和 CSS：

```
footer a {display: block; text-align: center;} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T14:24:00.583

使用top:-50px，在页脚使用margin-top:-50px，问题就解决了。

# linux - 无法在 Glade 3.14.0 中编辑按钮标签

> ID：12661904
> 
> 赞同：3
> 
> 时间：2012-09-30T14:16:32.027
> 
> 标签：linux, ubuntu, glade

我无法在 Glade 中编辑按钮标签。他们被禁用。我怎样才能解决这个问题？这是屏幕截图；

![在此处输入图像描述](../Images/c0b33eaccad77dea9691576b1fd074c1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T11:26:29.843

这已经回答[here](https://askubuntu.com/a/201251/9781)。总之，您现在需要添加*相关操作*并禁用*使用操作外观*才能在 Glade 中编辑按钮的标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T05:54:25.370

除了上面添加的[David Planella](https://stackoverflow.com/users/1049318/david-planella)之外，您还可以使用文本编辑器打开 .glade 文件并手动编辑标签文本。我刚试了一下，效果很好。

# iphone - 许多 webviews 会导致我的应用在我的 iphone 4 上崩溃吗？

> ID：12661905
> 
> 赞同：0
> 
> 时间：2012-09-30T14:16:52.763
> 
> 标签：iphone, objective-c, ios, xcode, debugging

//这个点

我逐渐将许多对象（UIWebView）加载到内存中，过了一会儿它崩溃了。请帮忙

//细节

我有一个带有水平分页的 UIScrollView，其中每个页面（带有一个单独的视图控制器）都包含一个 UIWebView 禁用了用户交互。起初，只有第 0 页上的 webview #0 被加载，当我在页面中前进时，应用程序逐渐发送请求以加载特定数据。下载的数据保留在内存中。

从 Internet 源加载大约 20 个 Webview 后，我的应用程序冻结并崩溃。如果我使用存储在设备上的虚拟 html 字符串，这会在我加载大约 50 个 webview 后发生。但问题仍然存在。

我修复了大部分漏洞，只剩下 Mallocs。由于加载少量 UIWebviews 不会出现问题，因此我假设我必须将代码更改为 3 个 webviews 并重用它们。但我不知道这是否能解决问题。我已经开发了几个不会崩溃的应用程序，这是一个独特的案例。

我将指向 webview 的指针和数组中的每个 Webview（例如标签）中的一些其他元素存储。每加载一个新页面，数组的计数就会增加。

我使用 xcode 4.3 和越狱的 iphone 4 进行开发。我关闭了在我的 xcode 中要求签名，因此应用程序被复制到我的手机上但无法附加到进程。我无法在手机上调试。我的应用程序在模拟器中运行良好，但在我通过点击图标在手机上启动它后会崩溃一段时间。

从我能够描述的情况来看，您认为可能是什么问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:01:09.380

您只需要使用三个 UIWebView 进行分页。假设用户在第 2 页（第 1 页是左页，第 3 页在右页）。当用户滑动到第 3 页时，您可以只在第 3 页的第 1 页上显示当前的 web 视图。当用户在页面之间滑动时，您需要重新加载正确的 html。

通过对 Web 内容进行一些缓存，下载内容后速度应该不会成为问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:35:19.147

WebKit 因占用内存而臭名昭著。它会分配大块内存并在让您有机会释放其他资源之前失败。一个`UIWebView`已经够糟糕了。我在只有 5`UIWebView`秒的应用程序中遇到过这个问题，更不用说 50 秒了。

您可以尝试几件事。一，如果网页不是太复杂，您可以使用替代视图，例如[DTCoreText](https://github.com/Cocoanetics/DTCoreText)来呈现它们。如果你必须有 webviews，你可以缓存各种 HTML 内容并使用一个`UIWebView`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T14:29:41.197

是的，当然有太多`UIWebView`的 s 会由于内存不足而导致崩溃。我不确定您拥有多个`UIWebView`s 的原因是什么，但我会按照您的想法重复使用少量而不是创建多个。

基于您的设备在使用少量时不会崩溃，我会说问题在于使用了太多`UIWebView`的 s 而不是与您的越狱设备的兼容性问题，例如。

# asp.net - asp.net中复选框的数字模式？

> ID：12661907
> 
> 赞同：0
> 
> 时间：2012-09-30T14:17:07.540
> 
> 标签：asp.net, sql, c#-4.0, bit

我有一个数据库表，其中包含一个字段名称**省位**，它加起来了模式的计数，例如：

```
AB-1
BC-2
CD-4
DE-8
EF-16.... and so on. 
```

现在在表条目中我有一个值 13（省位），这意味着应该检查针对条目 AB、CD、DE（加起来为 13）的复选框。

我无法获得相同背后的逻辑，如何仅检查总和与表中条目相加的那些复选框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:26:35.433

您需要检查该值是否在按位总计中。

```
if( interestedInValue & totalValue == interestedInValue) 
{
  // this value is in the total, check the box
} 
```

[和http://msdn.microsoft.com/en-us/library/sbf85k1c(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/sbf85k1c(v=vs.71).aspx)上的文档

例如 13 = 1 + 4 + 8
13 & 1 == 1 // true
13 & 2 == 2 // false
13 & 4 == 4 // true
13 & 8 == 8 // true
13 & 16 == 16 // 错误的

编辑：更多说明

```
ab.Checked = 1 && ProvinceBit == 1  // checkbox AB  
bc.Checked = 2 && ProvinceBit == 2  // checkbox BC  
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:27:25.263

该字段正在使用位标志。

13 是 1101 二进制。

因此，将值转换为位并为每个复选框分配一位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T01:57:08.107

通过将您的数字转换为字符串，您可以转换为数组或仅遍历字符串。有点蛮力，但会给你你需要的。

```
var value = 13
string binary = Convert.ToString(value, 2);
//binary = "1101" 
```

# genetic-algorithm - 为什么遗传学算法会多次评估同一个基因组？

> ID：12661908
> 
> 赞同：0
> 
> 时间：2012-09-30T14:17:16.693
> 
> 标签：genetic-algorithm, mathematical-optimization

我正在尝试使用[遗传算法 DLL解决](http://www.codeproject.com/Articles/3172/A-Simple-C-Genetic-Algorithm)[DARP 问题](http://pgrouting.org/docs/1.x/darp.html)。

问题是，尽管它有时会提出正确的解决方案，但有时却没有。尽管我使用了一个非常简单的问题版本。当我检查算法评估的基因组时，我发现它对同一个基因组进行了多次评估。

为什么它多次评估相同的值？如果不这样做会不会更有效率？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T18:05:35.680

对同一染色体进行两次评估与在一个群体（或不同群体）中多次使用同一染色体是有区别的。第一个可能可以有效地避免；第二个，也许不是。

考虑：

在某些一代 G1 中，您将 0011 和 1100 交配，将它们从中间穿过，幸运并且未能使任何基因发生突变，最终得到 0000 和 1111。您评估它们，将它们放回种群中以备下一个生成，并继续算法。

然后在一些较晚的 G2 代中，您在第一个索引处将 0111 和 1001 配对，并且（再次忽略突变）最终得到 1111 和 0001。其中一个已经被评估过，那么为什么要再次评估呢？特别是如果评估该函数非常昂贵，如果您负担得起内存，最好保留一个哈希表（或类似的）来存储先前评估的结果。

但！仅仅因为您已经为染色体生成了一个值，并不意味着您不应该将它自然地包含在未来的结果中，允许它进一步突变或允许它与同一种群的其他成员交配。如果你不这样做，你实际上是在惩罚成功，这与你想要做的完全相反。如果一条染色体代代相传或重新出现，这强烈表明它是一个很好的解决方案，如果它是局部最大值而不是全局最大值，一个精心挑选的变异算子将采取行动将其赶出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T18:20:11.157

为什么 GA 可能评估同一个人的基本解释正是因为它是非指导性的，因此重新创建以前看到（或同时看到）的基因组是可以预期的。

更有用的是，您的问题可以解释为两件不同的事情：

1.  与评估适应度函数相关的高成本，可以通过对基因组进行散列来减轻，但要以内存为代价。这是可以想象的，但我从未见过。通常 GAs 搜索高维空间，所以你最终会得到一个非常稀疏的散列。

2.  许多或所有成员都收敛到一个或几个模式的群体：在某些时候，你的基因组的多样性将趋于 0。这是预期的结果，因为算法已经收敛到它找到的最佳解决方案。如果这种情况发生得太早，结果平庸，则表明您陷入了局部最小值，并且您过早地失去了多样性。

在这种情况下，研究输出以确定发生了两种情况中的哪一种：

1.  你*失去了*多样性，因为特别适合的人赢得了很大比例的父母彩票。或者，
2.  你*不会获得*多样性，因为随着时间的推移，人口是相当静态的。

在前一种情况下，您必须保持多样性。确保不太适合的人获得更多机会，可能通过减少营业额或缩放适应度函数。

在后一种情况下，您必须增加多样性。确保您向种群注入更多的随机性，可能是通过增加突变率或增加营业额。

（当然，在这两种情况下，您最终*确实*希望随着 GA 在解决方案空间中收敛而减少多样性。所以您不只是想“调高所有刻度”并转移到蒙特卡洛搜索。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T18:45:34.273

根据您 GA 的具体情况，您可能在连续种群中拥有相同的基因组。例如，精英主义从每个种群中保存了最好的或*n 个*最好的基因组。

从计算的角度来看，重新评估基因组是低效的。避免这种情况的最简单方法是`HasFitness`为每个基因组放置一个布尔标志。您还可以为每个基因组编码创建一个唯一的字符串键，并将所有适应度值存储在字典中。此查找可能会变得非常昂贵，因此仅在您的适应度函数足够昂贵以保证查找的额外费用时才建议这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T14:32:15.100

撇开精英主义不谈，遗传算法不会重复评估*同一个基因组。*你所看到的是*相同*的基因组被再生和重新评估。这是因为每一代都是一组新的基因组，之前可能已经或可能没有被评估过。

为避免重新评估，您需要保留一份已产生的基因组列表及其适用性。要访问适合度，您需要将每个新人口与列表进行比较，当它不在列表中时，您需要对其进行评估，并将其添加到列表中。

由于现实世界的应用程序有数千个参数，因此您最终会存储数百万个基因组。然后，搜索和维护变得非常昂贵。所以每次只评估基因组可能会更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-30T15:05:16.070

基本上遗传算法包括

*   初始种群（大小 N）
*   适应度函数
*   变异操作
*   交叉操作（通常对 2 个个体进行，通过提取他们基因组的某些部分并将其组合成新个体）

在每一步它

1.  选择随机个体
2.  执行交叉导致新个体
3.  可能进行突变（改变随机个体中的随机基因）
4.  使用适应度函数评估所有新旧个体
5.  选择 N 最适合作为下一次迭代的新种群

算法在达到适应度函数的阈值时停止，或者在最后 K 次迭代中种群没有变化。

因此，它可能不会停在最佳解决方案上，而是停在局部最大值上。

一部分人口可以从一次迭代到另一次迭代保持不变，因为它们可能具有良好的适应度函数值。由于突变，也有可能“退回”到以前的基因组。

有很多技巧可以让遗传算法更好地工作：选择合适的种群编码到基因组中，找到一个好的适应度函数，玩交叉和变异比率。

# python - 按降序对字典条目进行排序并打印前 n 个条目

> ID：12661915
> 
> 赞同：0
> 
> 时间：2012-09-30T14:18:13.780
> 
> 标签：python, python-3.x, python-2.7

> **可能重复：**
> [从有序字典中获取前 N 个密钥对到 python 中的另一个](https://stackoverflow.com/questions/8287000/get-first-n-key-pairs-from-an-ordered-dictionary-to-another-one-in-python)

我有一本大字典。如何按降序对这些条目进行排序，然后打印前 n 个项目？要打印字典中的排序项目，我使用以下代码：

```
print sorted(mydictionary.iteritems(), key=operator.itemgetter(1), reverse=True) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T14:35:44.843

您可以使用[`heapq.nlargest`](http://docs.python.org/library/heapq.html#heapq.nlargest)：

```
import heapq
print heapq.nlargest(n, mydictionary.iteritems()) 
```

*通常这在效率方面大致相同（排序然后切片），但是对于非常大的字典和小的字典来说，`n`它会稍微快一些（接下来的分析）。*它的好处是易于阅读！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T14:20:14.533

然后你可以打印一个切片：

```
print sorted(mydictionary.items(), key=operator.itemgetter(1), reverse=True)[:10] 
```

# java - 我怎么知道文件是否存在？

> ID：12661917
> 
> 赞同：0
> 
> 时间：2012-09-30T14:18:26.037
> 
> 标签：java, android, android-file, file-exists

我在 android 上写了这段代码来了解 .txt 文件是否存在。

```
 File file_a =new File("a.txt");

 InputStream in3 = getResources().openRawResource(R.raw.b);
         FileOutputStream out3 = null;

        try {   out3=openFileOutput("a.txt",Context.MODE_WORLD_WRITEABLE);
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
         byte[] buff3 = new byte[1024];
         int read3 = 0; 

         try {
            while ((read3 = in3.read(buff3)) > 0) {
               out3.write(buff3, 0, read3);
            }
         } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace(); 
        } finally {
              try {
                in3.close();
                out3.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

         }

    boolean a=file_a.exists(); 
```

它总是返回`false`。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:23:14.447

您根本没有创建文件。您所做的只是实例化一个文件句柄。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:26:17.260

`File`如果不存在，您可以创建

使用这个

```
if(!file.exist()){
file.createNewFile( ); 
} 
```

之后当你打电话时`file.exist();`它会返回`true`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T14:21:02.123

**它并不总是返回 false。**

`File#exists()`当且仅当此抽象路径名表示的文件或目录存在时，才返回 true；否则为假。

您正在创建一个新文件，然后您应该调用`File#createNewFile`which 如果成功创建则返回 true，否则返回 false。

在文件已经创建然后您可以检查`File#getAbsolutePath()`以验证文件的绝对路径是否相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T14:34:06.277

我找到了解决方案。我尝试了读取文件，如果它获得了不存在的 catch 块。谢谢大家。

```
try {
        FileInputStream deneme=openFileInput("a.txt");
    } catch (FileNotFoundException e1) {
        // TODO Auto-generated catch block
         kopyala();
        e1.printStackTrace();
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-30T14:36:49.700

您需要提供文件的路径以及文件名。假设该文件位于根目录中的 sd 卡上：

```
File file_a = new File(Environment.getExternalStorageDirectory() + "/a.txt"); 
boolean a=file_a.exists(); 
```

如果它在子目录中，请添加路径的其余部分：

```
 File file_a = new File(Environment.getExternalStorageDirectory() + "yourpath/a.txt"); 
```

如果您已将文件写入内部存储，它位于“data/data/your.package.name”路径中的某个位置，请使用它。

```
 File file_a = new File(Environment.getExternalStorageDirectory() + "date/data/your.package.name/a.txt"); 
```

# performance - Google Page Speed 说避免字符集的元标记，但我没有为此使用元标记

> ID：12661919
> 
> 赞同：0
> 
> 时间：2012-09-30T14:18:40.450
> 
> 标签：performance, character-encoding, google-pagespeed

**使用 Google Page Speed**时，我收到一条消息“*避免在元标记中使用字符集”，其中包含指向*[页面](https://developers.google.com/speed/docs/best-practices/rendering#SpecifyCharsetEarly)的链接，该链接告诉我为什么不应该使用元标记来定义字符集。

但是我的页面（WordPress）没有在元标记中指定字符集。相反，我通过将它放在主题的顶部来完成它`header.php`：

```
<?php
    header('Content-Type: text/html; charset=utf-8');
?> 
```

我的问题是：

1.  我指定字符集的方法是否正确？
2.  如果是，为什么 Google 的 PageSpeed 工具会抱怨不存在的元标记规范？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:44:34.180

检查页面的 HTML 代码，发送到浏览器和其他用户代理。（例如，在浏览器中查看页面时使用查看源代码。）很可能存在`meta`声明字符编码（“字符集”）的标签。它可能是由您正在使用的创作软件生成的。

[在我的测试中，使用https://developers.google.com/speed/pagespeed/](https://developers.google.com/speed/pagespeed/)时触发消息的唯一方法是阻止服务器在 HTTP 中发送编码信息并为其添加`meta`标签。在这样的环境下，性能可能会下降是可以理解的。

否则，Google Page Speed 在这个问题上的建议是不好的建议。*除了*在 HTTP 标头中声明编码之外，您还*应该*`meta`在标记中声明编码，因为在这种情况下，页面可能会保存在本地，当打开本地副本时，不会有任何 HTTP 标头。

# php - 我保护 MySQL 数据库密码的方法安全吗？

> ID：12661923
> 
> 赞同：1
> 
> 时间：2012-09-30T14:19:36.743
> 
> 标签：php, mysql, database-connection, password-encryption

使用时：

```
$con = mysql_connect('localhost','user','password') 
```

我已经阅读了将密码部分存储在其他地方的好处（[https://stackoverflow.com/a/3354457/1704651](https://stackoverflow.com/a/3354457/1704651)）。

我对 PHP 还很陌生，想知道我存储 MySQL 密码的方法是否安全：

1.  第一步，选择一个冗长的 MySQL 数据库密码 ( [https://www.random.org/passwords/?num=1&len=24&format=html&rnd=new](https://www.random.org/passwords/?num=1&len=24&format=html&rnd=new) )
2.  第二步，把这个放在 /outsidewebroot/salt.php （我的实际盐更长）

    ```
    <?php $salt = sdcjbdt8veADJbyuQxsfJtYeW7tC5; ?> 
    ```

3.  第三步，使用临时 PHP 文件（使用后删除）对密码进行编码：

    ```
    $decrypted = "my decrypted MySQL password"
    $key = $salt;
    $encrypted = base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($key), $decrypted, MCRYPT_MODE_CBC, md5(md5($key))));
    var_dump($encrypted); 
    ```

4.  第四步，将此代码放入.htaccess

    ```
    SetEnv encrypted-password i3NOByNkztBtEbJ8LJMt2GbX9VjMzO2MTYtBXsxyYVI= 
    ```

5.  第五步，把这段代码放在你需要连接数据库的地方：

    ```
    require_once("../../outside-webroot/salt.php")
    $key = $salt
    $decrypted = rtrim(mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5($key), base64_decode($encrypted-password), MCRYPT_MODE_CBC, md5(md5($key))), "\0");
    $con = mysql_connect('localhost','user',$decrypted) 
    ```

/outsidewebroot/salt.php 中的盐与我在数据库中用于散列密码的盐相同，因此我只需将其包含一次以供两次使用。

我在这里看到的加密/解密方法：http: [//ideone.com/yQIAX](http://ideone.com/yQIAX)

我也见过这种方法：[https](https://stackoverflow.com/a/3354457/1704651) ://stackoverflow.com/a/3354457/1704651使用哈希而不是加密/解密方法。

感谢您对我的方法的反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:30:25.907

不会。如果有人可以获取您的文件或运行程序，则游戏结束：

1.  如果您的 web 目录是可写的，我可以简单地在`echo $decrypted;`上面添加一行`mysql_connect()`并获取密码。
2.  我可以将您的文件复制下来并在那里进行编辑。

安全性是您经历的过程，而不是您可以链接到程序中的某个库。

*   您应该将配置存储在[php.ini](http://php.net/manual/en/mysql.configuration.php)文件中，以便您的程序只需要`mysql_connect()`（不带参数）。这是一个好主意，因为攻击者可能更容易说服您的系统打印出源代码和 Web 可访问的文件，而不是在您的系统上打印任意文件。

*   在像 OSX 和 Linux 这样的 Unixish 系统上，你应该确保你使用的是 unix 域套接字，它不会将你的 MySQL 服务器暴露给 Internet；如果您的 MySQL 服务器不在 Internet 上，则有人无法连接到它。这提供了一些针对“获取您的文件”攻击的进一步保护。

*   注意不要让您的网络用户创建 php 文件（或任何其他可执行文件）。这提供了一些针对“运行程序”攻击的保护，

*   如果我可以上传/编辑你的文件，我可以做他们能做的任何事情，所以你还应该小心`GRANT`你放在 MySQL 服务器中的语句：如果只有管理员需要对某些`INSERT`或`DELETE`某些表执行操作，请考虑运行管理员脚本作为具有单独权限的单独 Web 用户。如果您的脚本无法删除您的所有数据，那么我作为攻击者也不能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T16:31:09.330

安全的第一条规则是，如果您不确定自己是否安全，那么您可能不是。

下一版本的 PHP (v5.5) 将具有一组内置函数，可提供标准化的密码散列。一旦此版本发布，这将是唯一推荐的处理密码的方法。

同时，您可以下载一个兼容库，它为当前的 PHP 版本实现了相同的功能。从这里下载：[https ://github.com/ircmaxell/password_compat](https://github.com/ircmaxell/password_compat)

另请参阅：[http](http://www.h-online.com/open/news/item/PHP-5-5-should-reduce-password-sloppiness-1707835.html) ://www.h-online.com/open/news/item/PHP-5-5-should-reduce-password-sloppiness-1707835.html以供参考。

# javascript - JavaScript 幻灯片不工作

> ID：12661926
> 
> 赞同：1
> 
> 时间：2012-09-30T14:19:44.217
> 
> 标签：javascript, html, slideshow

我正在编写一个非常简单的 JavaScript 幻灯片，但它不工作。我不想要 jQuery。此代码在 5 秒后显示第一张图像，但不会循环显示其余图像。完整的代码如下，我就是想不通我做错了什么：

```
<!DOCTYPE html>
<html dir="ltr" lang="en">
    <head>
        <title>JavaScript Slideshow</title>
        <style>
        #slider > img { display: none }
        </style>
    </head>
    <body>
        <div id="slider">
            <img src="img1.png">
            <img src="img2.png">
            <img src="img3.png">
            <img src="img4.png">
            <img src="img5.png">
        </div>
        <script>
            var s = document.getElementById("slider").getElementsByTagName("img");
            var c = s.length;
            setInterval(function() {
                s[(s.length++) % c].style.display="block";
            }, 5000);
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:29:44.130

您的代码中有几个错误。

1.  您正在尝试增加数组长度，并通过计数器对其取模。我敢打赌你想反过来做：

    `s[c % (s.length)].style.display="";`

2.  您没有隐藏已经循环通过的图像，因此您的循环只会显示一次。

    ```
     var s = document.getElementById("slider").getElementsByTagName("img");
        var c = s.length;
        setInterval(function() {
            s[c % s.length].style.display="";
            s[(++c) % s.length].style.display="block";
        }, 5000); 
    ```

# javascript - 使用jquery查找位置top> x的对象

> ID：12661927
> 
> 赞同：0
> 
> 时间：2012-09-30T14:19:44.737
> 
> 标签：javascript, jquery, html

什么是在 html 文档中查找第一个元素的最佳方法，其中类 myClass 的位置顶部大于指定

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T14:23:25.687

`.myClass`根据top过滤元​​素`position`，然后获取集合中的第一个元素：

```
var elem = $('.myClass').filter(function() {
    return $(this).position().top > 200;
}).first(); 
```

这将为您提供第一个元素，其中包含距离内部顶部超过 200px 的元素等。要获得相对于文档的位置，您可以使用[offset()](http://api.jquery.com/offset/)代替。

如果性能是一个问题，我想这是最快的：

```
var elems = document.getElementsByClassName('myClass'), elem;
for (var i=0;i<elems.length;i++) {
    if (parseInt(elems[i].style.top, 10)>200) {
        elem=elems[i];
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:24:16.993

**错误**（第一个答案）：

```
var $elm = jQuery.each($('.myClass'), function() {
    if ($(this).attr('top') > x) return $(this); 
}); 
```

**好的**：

```
var $elm;
jQuery.each($('.myClass'), function() {
    if ($(this).attr('top') > x) {
        $elm = $(this);
        return false;
    }
}); 
```

此解决方案不解析所有`.myClass`元素，只返回第一个元素并停止。

# c# - 如何在数据网格绑定中指定对象

> ID：12661928
> 
> 赞同：0
> 
> 时间：2012-09-30T14:19:51.937
> 
> 标签：c#, .net, wpf, silverlight, xaml

如何在 DataGrid 绑定中指定对象？我的数据网格有`ItemsSource="{Binding Source=TripsCollection}"`and`AutoGenerateColumns="False"`和 Columns 设置为：

```
<DataGrid.Columns>
     <DataGridTextColumn Header="ID" Binding="{Binding TripID}" IsReadOnly="True"></DataGridTextColumn>
     ...
</DataGrid.Columns> 
```

但是有错误：

> System.Windows.Data 错误：40：BindingExpression 路径错误：在“对象”“Char”（HashCode=7209070）上找不到“TripID”属性。绑定表达式：路径=TripID；DataItem='Char' (HashCode=7209070); 目标元素是'TextBlock'（名称=''）；目标属性是“文本”（类型“字符串”）。

如何将对象设置为 Trip 对象？

数据上下文类：

```
private ObservableCollection<Trip> _tripsCollection;
    public ObservableCollection<Trip> TripsCollection
    {
        get { return _tripsCollection; }
        set { _tripsCollection = value; NotifyPropertyChanged("TripsCollection"); }
    } 
```

旅行等级：

```
[Table(Name="Trips")]
public class Trip
{
    private uint _tripID;
    private string _start;
    private string _end;
    private DateTime _date;
    private double _length;
    private string _note;
    private uint _carID = 0;
    private EntityRef<Car> _Car;

    ..and properties for this fields..
} 
```

设置数据上下文

```
public MainWindow()
{
    InitializeComponent();
    string connString = @"Data Source=.\SQLEXPRESS; Integrated security=SSPI; Connect Timeout=30"; // User Instance=True";
    conn = new SqlConnection(connString);
    conn.Open();

    LogBookViewModel lbvm = new LogBookViewModel(conn);
    DataContext = lbvm;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:31:30.513

您必须更改 ItemsSource 中的绑定，如下所示：

```
ItemsSource="{Binding Source=TripsCollection}" 
```

对此：

```
ItemsSource="{Binding TripsCollection}" 
```

如果您将来遇到绑定问题，请尝试使用[snoop](http://snoopwpf.codeplex.com/)。

# google-maps-api-3 - 使用 Google Map API 在给定坐标之间画线

> ID：12661940
> 
> 赞同：0
> 
> 时间：2012-09-30T14:22:55.243
> 
> 标签：google-maps-api-3

> **可能重复：**
> [折线使用谷歌地图 api v3 捕捉到道路](https://stackoverflow.com/questions/10513360/polyline-snap-to-road-using-google-maps-api-v3)

我的用例很常见，但不知何故找不到正确的解决方案。我不断记录移动车辆的坐标，然后将预定义的路线与行驶路径一起显示。预定义的路线和行进路径应以不同的颜色显示。为了显示预定义的路径，我使用了 DirectionsService.route。对于走过的路，我尝试了不同的方法，但没有一个能完美地工作。

1.  在路径中记录的所有坐标之间绘制一条折线。但是如果转弯落在两个记录的坐标之间，则该线直接连接点而忽略转弯。

    `var line = new google.maps.Polyline({ path: arr_all_coordinates, strokeColor: "red", strokeOpacity: 1, strokeWeight: 1 });`

2.  使用新的 DirectionsRenderer 对象在 2 个连续坐标之间形成一条路线，并使用 DirectionsService.route 显示直到最后一个坐标。在这种情况下，地图会继续跳转到最后 2 个坐标，并将焦点放在最后绘制的路线上。我尝试将 preserveViewport 设置为 true 但没有用。

    `directionsService.route(request, function(response, status) { if (status == google.maps.DirectionsStatus.OK) { directionsRenderer.setDirections(response); }`

请有任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:54:26.940

这与绘制一条捕捉道路的线基本上是相同的问题。请参阅我的解决方案：[polyline snap to road using google maps api v3](https://stackoverflow.com/questions/10513360/polyline-snap-to-road-using-google-maps-api-v3/10515516)

# ruby - 无法启动 sinatra 进程 - eventmachine“没有接受者”

> ID：12661941
> 
> 赞同：6
> 
> 时间：2012-09-30T14:22:59.867
> 
> 标签：ruby, apache, sinatra, eventmachine

我有一个作为守护进程运行的 Sinatra 应用程序，使用 Apache 端口转发在端口 80 和端口 7655 之间进行调解。过去一直运行良好。今天，不太好。我不知道为什么。

问题：`sudo ruby my_process.rb`返回：

```
/var/lib/gems/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:526:in `start_tcp_server': no acceptor (port is in use or requires root privileges) (RuntimeError) 
```

试过：更新所有系统包，更新所有gem。没有帮助（除了来自 eventmachine 的更清晰的错误消息）。

当我跑步时，`sudo lsof -i :7655`我什么也得不到。当我运行时，`sudo ps aux`我根本看不到*任何*Ruby 进程。考虑到错误消息的性质，我发现它非常不规则！

那么，在找出端口不可用的原因时，我是否遗漏了什么？

* * *

还：

试过换端口，没用。我想知道它是否与“本地主机”有关？当我 ping localhost 时，我得到所有丢弃的数据包。这似乎不正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T13:05:06.097

事实证明，主要 Sinatra 脚本中的这两行提供了最多的信息：

```
set bind: "localhost"
set port: 7655 
```

问题出在本地主机上。环回接口未正确配置。`ifconfig`显示了`lo`界面，但尚未为其分配 IP `127.0.0.1`。要解决此问题，请在 shell 中运行以下命令（在 Ubuntu Linux 系统上）：

```
ifdown lo
ifup lo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-03-03T16:23:43.783

当您关闭术语时，有时您忘记停止 [CTRL+C] 实际服务器，只需运行以下命令即可杀死所有 ruby​​ 进程，如 sinatra，然后再次运行

```
killall ruby 
```

您可以通过运行查看您的实际 ruby​​ 进程

```
ps -ef | grep ruby 
```

# php - 用某些值排序数组？

> ID：12661944
> 
> 赞同：0
> 
> 时间：2012-09-30T14:23:18.473
> 
> 标签：php, arrays, grouping

这是从 mysql 查询推送的输出数组

```
Array
(
    [0] => Array
        (
            [CategoryID] => 7
            [CategoryName] => Test it
            [Parent] => 2
            [Thumb] => 4
            [sort] => 0
            [MediaID] => 4
            [MediaTitle] => asd
            [MediaName] => 1349012691_4.jpg
            [MediaType] => image
            [MediaSize] => 369848
            [UploadTime] => 1349012691
        )

    [1] => Array
        (
            [CategoryID] => 8
            [CategoryName] => Test all
            [Parent] => 4
            [Thumb] => 5
            [sort] => 0
            [MediaID] => 5
            [MediaTitle] => asaas
            [MediaName] => 1349012728_9.jpg
            [MediaType] => image
            [MediaSize] => 416817
            [UploadTime] => 1349012728
        )

    [2] => Array
        (
            [CategoryID] => 4
            [CategoryName] => Test Image
            [Parent] => 0
            [Thumb] => 0
            [sort] => 2
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [3] => Array
        (
            [CategoryID] => 2
            [CategoryName] => Test Sub
            [Parent] => 1
            [Thumb] => 0
            [sort] => 4
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [4] => Array
        (
            [CategoryID] => 3
            [CategoryName] => Test Category
            [Parent] => 0
            [Thumb] => 0
            [sort] => 6
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [5] => Array
        (
            [CategoryID] => 1
            [CategoryName] => Test Category
            [Parent] => 0
            [Thumb] => 0
            [sort] => 8
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [6] => Array
        (
            [CategoryID] => 5
            [CategoryName] => Test Category
            [Parent] => 0
            [Thumb] => 0
            [sort] => 10
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [7] => Array
        (
            [CategoryID] => 6
            [CategoryName] => Test Remove
            [Parent] => 0
            [Thumb] => 0
            [sort] => 12
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

) 
```

我需要对这个数组进行排序，以便它首先显示父母类别，然后是子类别。

我需要类似的输出

```
Array
(

    [2] => Array
        (
            [CategoryID] => 4
            [CategoryName] => Test Image
            [Parent] => 0
            [Thumb] => 0
            [sort] => 2
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )
        //sub category
            [1] => Array
            (
                [CategoryID] => 8
                [CategoryName] => Test all
                [Parent] => 4
                [Thumb] => 5
                [sort] => 0
                [MediaID] => 5
                [MediaTitle] => asaas
                [MediaName] => 1349012728_9.jpg
                [MediaType] => image
                [MediaSize] => 416817
                [UploadTime] => 1349012728
            )

    [3] => Array
        (
            [CategoryID] => 2
            [CategoryName] => Test Sub
            [Parent] => 1
            [Thumb] => 0
            [sort] => 4
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )
                //sub category
                [0] => Array
                (
                    [CategoryID] => 7
                    [CategoryName] => Test it
                    [Parent] => 2
                    [Thumb] => 4
                    [sort] => 0
                    [MediaID] => 4
                    [MediaTitle] => asd
                    [MediaName] => 1349012691_4.jpg
                    [MediaType] => image
                    [MediaSize] => 369848
                    [UploadTime] => 1349012691
                )

    [4] => Array
        (
            [CategoryID] => 3
            [CategoryName] => Test Category
            [Parent] => 0
            [Thumb] => 0
            [sort] => 6
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [5] => Array
        (
            [CategoryID] => 1
            [CategoryName] => Test Category
            [Parent] => 0
            [Thumb] => 0
            [sort] => 8
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [6] => Array
        (
            [CategoryID] => 5
            [CategoryName] => Test Category
            [Parent] => 0
            [Thumb] => 0
            [sort] => 10
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

    [7] => Array
        (
            [CategoryID] => 6
            [CategoryName] => Test Remove
            [Parent] => 0
            [Thumb] => 0
            [sort] => 12
            [MediaID] => 
            [MediaTitle] => 
            [MediaName] => 
            [MediaType] => 
            [MediaSize] => 
            [UploadTime] => 
        )

) 
```

我可以用 PHP 做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:04:29.843

你可以试试

```
# Short Version of your Array
$oldList = Array(
    "0" => Array("CategoryID" => 7,"CategoryName" => "Test it","Parent" => 2),
    "1" => Array("CategoryID" => 8,"CategoryName" => "Test all","Parent" => 4),
    "2" => Array("CategoryID" => 4,"CategoryName" => "Test Image","Parent" => 0),
    "3" => Array("CategoryID" => 2,"CategoryName" => "Test Sub","Parent" => 1),
    "4" => Array("CategoryID" => 3,"CategoryName" => "Test Category","Parent" => 0),
    "5" => Array("CategoryID" => 1,"CategoryName" => "Test Category","Parent" => 0),
    "6" => Array("CategoryID" => 5,"CategoryName" => "Test Category","Parent" => 0),
    "7" => Array("CategoryID" => 6,"CategoryName" => "Test Remove","Parent" => 0)
);

echo "<pre>";
print_r(__group($oldList)); 
```

使用的功能

```
function __group($oldList)
{
    # Get Category Position
    $category = array_map(function($item) { return $item['CategoryID'];}  ,$oldList); 

    #Get Only Parent List and add to new list
    $newList = array_filter($oldList , function($item) {  return $item['Parent']  == 0 ; } );

    foreach($oldList as $key => $value)
    {
        if($value['Parent'] != 0) {
            # Mapt Chiled to parent using Parent ID & Category ID 
            $newList[array_search($value['Parent'],$category)]['child'][] = $value;
        }
    }
    return $newList ;
} 
```

输出

```
Array
(
    [2] => Array
        (
            [CategoryID] => 4
            [CategoryName] => Test Image
            [Parent] => 0
            [child] => Array
                (
                    [0] => Array
                        (
                            [CategoryID] => 8
                            [CategoryName] => Test all
                            [Parent] => 4
                        )

                )

        )

    [4] => Array
        (
            [CategoryID] => 3
            [CategoryName] => Test Category
            [Parent] => 0
        )

    [5] => Array
        (
            [CategoryID] => 1
            [CategoryName] => Test Category
            [Parent] => 0
            [child] => Array
                (
                    [0] => Array
                        (
                            [CategoryID] => 2
                            [CategoryName] => Test Sub
                            [Parent] => 1
                        )

                )

        )

    [6] => Array
        (
            [CategoryID] => 5
            [CategoryName] => Test Category
            [Parent] => 0
        )

    [7] => Array
        (
            [CategoryID] => 6
            [CategoryName] => Test Remove
            [Parent] => 0
        )

    [3] => Array
        (
            [child] => Array
                (
                    [0] => Array
                        (
                            [CategoryID] => 7
                            [CategoryName] => Test it
                            [Parent] => 2
                        )

                )

        )

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:59:37.443

这将根据需要对条目进行分组：

```
function groupData($data) {
    $tree = array();
    $waiting = array();
    $index = array();
    foreach ($data as &$entry) {
        $index[$entry['CategoryID']] = &$entry;
        if (isset($waiting[$entry['CategoryID']])) {
            $entry['children'] = &$waiting[$entry['CategoryID']];
        } else {
            $entry['children'] = array();
        }
        if ($entry['Parent']) {
            if (isset($index[$entry['Parent']])) {
                $index[$entry['Parent']]['children'][] = &$entry;
            } else {
                if (!isset($waiting[$entry['Parent']])) {
                    $waiting[$entry['Parent']] = array();
                }
                $waiting[$entry['Parent']][] = &$entry;
            }
        } else {
            $tree[] = &$entry;
        }
    }
    return $tree;
} 
```

如果您还需要按“排序”属性对结果进行排序，则最好在 SQL 查询中使用某个名称或其他任何名称。上面的函数不会改变记录顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T15:32:48.247

您可以使用下面的代码。这将对数组进行分组并根据排序键对每个数组（根数组和子数组）进行排序。要检索新的分组/排序数组，请使用此 $newArray = groupMe($originalArray);

```
function groupMe($array) {
    $returningArray = array();

    $mapCatIdCategory = array();
    //first pass create mapCatIdCategory
    foreach ($array as &$item) {
        $mapCatIdCategory[$item['CategoryId']] = &$item;
        $item['child'] = array();
    }

    //second pass is for setting child
    foreach ($array as &$item) {
        $parentId = $item['Parent'];
        if ($parentId == 0) {   //no parent category => add to root
            $returningArray[] = &$item;
        }
        else if (isset($mapCatIdCategory[$parentId])){ //not sure if data is always valid
            $mapCatIdCategory[$parentId]['child'][] = &$item; 
        }
    }

    //third pass sort root and all child array(recursively)
    recursiveSort($returningArray);

    return $returningArray;
}

function recursiveSort(&$array) {
    foreach ($array as &$item) {
        if (count($item['child']) >  1) { //empty or 1 elements arrays are already sorted
            recursiveSort($item['child']); //sort child
        }
    }

    usort($array, "cmpCategory"); //sort array by user comparasion function
}

function cmpCategory($a, $b) {
    if ($a['sort'] == $b['sort']) {
        return 0;
    }
    return ($a['sort'] < $b['sort']) ? -1 : 1;
} 
```

# css - 将奇偶样式定位到具有 id 的特定表

> ID：12661949
> 
> 赞同：2
> 
> 时间：2012-09-30T14:24:05.167
> 
> 标签：css, css-selectors

我有几个表，我只想针对偶数行和奇数行：

```
<table class="record">
<tbody>
  <tr>
    <th scope="col">Score</th>
    <th scope="col">Time</th>
  </tr>
  <tr>
    <td>A</td>
    <td>1.20</td>
  </tr>
  <tr>
    <td>B</td>
    <td>1.35</td>
  </tr>
  <tr>
    <td>C</td>
    <td>1.39</td>
  </tr>
  </tbody>
</table> 
```

我尝试使用我在网上找到的以下代码，但它可以在网站周围的所有表格中使用：

```
tr:nth-child(even) { background: #666; }
tr:nth-child(odd)  { background: #CCC; } 
```

任何建议我如何才能只针对具有“记录”类的表？谢谢你的建议。

编辑：如果这个表在另一个表下作为 td 怎么办？:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T14:25:27.570

首先要做的事情是：您的问题标题暗示/说明您要使用 an `id`，而在您的问题代码中，您使用 a `class`, 来选择相关`table`元素。这些是*不*等价的；一个元素可能只有一个`id`，但有多个类。也就是说，要*使用*课程，发布的答案已经涵盖了您。

另一方面，如果您想使用 an `id`（如您的标题中所述），则替换`.record`为`#idOfTable`（并记住将 an 传递`id`给您的 HTML: `<table id="idOfTable"><!-- other stuff --></table>`）。

当然，您可以将 an`id`与`class`选择器结合使用：

只需将祖先作为选择器的一部分传递：

```
.record tr:nth-child(even) {background: #666;}
.record tr:nth-child(odd) {background: #CCC;} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/J5x7A/)。

由于您可能只希望它在 中工作`tbody`，您也可以将其作为选择器的一部分传递：

```
.record tbody tr:nth-child(even) {background: #666;}
.record tbody tr:nth-child(odd) {background: #CCC;} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/J5x7A/1/)。

当然，您可以将 an`id`与`class`选择器结合使用：

```
#idOfTable.classNameOfTable {
    /* CSS */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-30T14:26:27.310

只需`table.record`在您发布的 CSS 代码之前添加，如下所示：

```
table.record tr:nth-child(even) { background: #666; }
table.record tr:nth-child(odd)  { background: #CCC; } 
```

部分是将其`table`仅用于表，因为该类可能还有其他元素，`record`而您不会干扰它们。

`.record`只是指定类（`<elem>.<class>`是语法，`<elem>`不是必需的）。

嵌套也很容易理解：它在外部元素中寻找匹配的元素。[这是相关的 W3S 文档。](http://www.w3schools.com/css/css_grouping_nesting.asp)

# c++ - 用 C::B 编译我的第一个应用程序

> ID：12661951
> 
> 赞同：0
> 
> 时间：2012-09-30T14:24:39.720
> 
> 标签：c++, compilation, codeblocks

我是 C++ 新手，最近我一直在学习 web-dev 语言。我在使用 Code::Blocks 编译我的第一个 C++ 应用程序时遇到问题。

这是我的代码，非常简单：

```
#include <windows.h>
using namespace std;

int main()
{
SetCursorPos(2000, 10);
mouse_event(MOUSEEVENTF_LEFTDOWN,0 ,0,0,0);
mouse_event(MOUSEEVENTF_LEFTUP,0 ,0,0,0);
} 
```

但是在构建时，上面会产生以下错误：

```
Untitled1.c|2|error: expected '=', ',', ';', 'asm' or '__attribute__' before 'namespace'|

||=== Build finished: 1 errors, 0 warnings ===| 
```

代码本身对我来说似乎没有错误，但我想从专业人士那里得到一些提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T14:26:01.273

您正在将 C++ 编译为 C — 只需将扩展名更改为`.cpp`.

# regex - 使用 sed 替换数字

> ID：12661952
> 
> 赞同：5
> 
> 时间：2012-09-30T14:25:13.497
> 
> 标签：regex, macos, sed

我想用找到的数字计算的结果替换文件中的一些数字，并且想在 MacOSX 上使用 sed。我尝试了很多变体，现在知道我必须使用 -E 来使用现代而不是基本的正则表达式。

一些例子：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed s/\ +\ wwv_flow_id.offset/blabla/ 
```

给

```
bla 18934750blabla bla 
```

因此，如果没有 -E，它会查找并替换固定文本。但是使用 -E，它不会：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E s/\ +\ wwv_flow_id.offset/blabla/ 
```

给

```
bla 18934750 + wwv_flow_id.offset bla 
```

换句话说：没有匹配，文本没有变化。最终目标是找到固定文本“+ wwv_flow_id.offset”之前的数字并使用该数字并从中减去一个固定数字（例如750），因此最终结果变为：

```
bla 18934000 + wwv_flow_id.offset bla 
```

为此，我至少需要反向引用，这也不能像我预期的那样工作，因为

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E s/\([0-9]+\)\ /\1/ 
```

给

```
bla 1+ wwv_flow_id.offset bla 
```

我希望一些正则表达式大师可以在这里帮助我。

**更新**

在 ruakh 的帮助下，这就是我现在所拥有的：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E 's/([0-9]+) \+ wwv_flow_id.offset/(\1-750) \+ wwv_flow_id.offset/' 
```

返回：

```
bla (18934750-750) + wwv_flow_id.offset bla 
```

现在的奖金问题是，如何把它变成

```
bla 18934000 + wwv_flow_id.offset bla 
```

**更新 2**

通过将 sed 与 awk 结合起来，我设法达到了我想要的结果，如下所示：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E 's/([0-9]+)([ ]*)\+([ ]*)wwv_flow_id.offset/~\1~\2\+\3wwv_flow_id.offset/' | awk -F~ '{print $1 $2-750 $3}' 
```

（我确定`~`原始行上没有标记）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-30T14:39:55.120

在“现代”正则表达式中，`+`有一个特殊的含义——它的意思是“一个或多个”（就像`*`“零或多个”的意思一样）——所以要匹配一个实际的加号，你需要使用`\+`. 由于您显然不希望将`sed`-script 用引号括起来，因此您可以将其写为`\\+`：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E s/\ \\+\ wwv_flow_id.offset/blabla/ 
```

虽然我认为如果你放弃这种偏好，它会让你的生活更轻松，并写下：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E 's/ \+ wwv_flow_id.offset/blabla/' 
```

引用您的论点还将解决您的反向引用问题，即 Bash 正在转换`\1`为`1`：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E 's/([0-9]+) /\1/' 
```

但是，如果您仍然喜欢坚持使用未引用的脚本`sed`样式，则可以编写`\\1`：

```
echo "bla 18934750 + wwv_flow_id.offset bla" | sed -E s/\([0-9]+\)\ /\\1/ 
```

# file-upload - 如何验证文件大小和输入 ?

> ID：12661967
> 
> 赞同：6
> 
> 时间：2012-09-30T14:26:33.763
> 
> 标签：file-upload, jsf-2, primefaces

在 PrimeFaces 3.4 中，`<p:fileUpload>`属性`sizeLimit`和`allowTypes`在`mode="simple"`. 如何验证文件大小和允许的类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T13:22:38.613

`mode="simple"`生成一个纯 HTML5 ，`<input type="file">`而不是使用 jQuery/Ajax 文件上传，因此客户端设施是有限的。

如果网络浏览器支持新的[HTML5 `File`API](http://caniuse.com/fileapi)，那么您就可以使用它。它增加了对新`accept`属性的支持`<input type="file">`，并使 JavaScript 能够访问特定的文件属性，例如`File#size`.

例如

```
<p:fileUpload mode="simple" styleClass="imagesOnlyMax10MB" /> 
```

使用这个 JS（使用 PrimeFaces 中的 jQuery）：

```
$("input[type=file].imagesOnlyMax10MB").attr("accept", "image/*").on("change", function() {
    var max = 10 * 1024 * 1024; // 10MB

    if (this.files && this.files[0].size > max) {
        alert("File too large."); // Do your thing to handle the error.
        this.value = null; // Clears the field.
    }
}); 
```

否则，你最好的选择是在服务器端验证它。您可以[`ExternalContext#getMimeType()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#getMimeType%28java.lang.String%29)用来获取基于文件扩展名的 mime 类型（您可以管理所有 mime 类型，如`<mime-mapping>`；`web.xml`容器自己的有一堆默认类型）。

```
if (!externalContext.getMimeType(filename).startsWith("image/")) {
    // Not an image.
} 
```

# android - 在自定义视图的 TypedArray 上获取 getString 的空指针异常

> ID：12661972
> 
> 赞同：3
> 
> 时间：2012-09-30T14:27:08.673
> 
> 标签：android, nullpointerexception, android-custom-view, typed-arrays

我创建了一个新的自定义视图，旨在替换 linearLayout 的权重机制。我添加了一些可以直接在布局 xml 文件中使用的样式属性。

attrs.xml 文件包含：

```
<resources>
  <declare-styleable name="WeightedLayout_LayoutParams">
    <attr name="horizontalWeights" format="string" />
    <attr name="verticalWeights" format="string" />
  </declare-styleable>
</resources> 
```

可以在[此处查看](https://stackoverflow.com/questions/12427885/android-replacement-for-the-linearlayout-weights-mechanism)示例和完整代码。我面临的问题是，在可视化编辑器中，我不断收到一个空指针异常，我从 typedArray 获取字符串：

```
final TypedArray arr=context.obtainStyledAttributes(attrs,R.styleable.WeightedLayout_LayoutParams);
//...
final String horizontalWeights=arr.getString(R.styleable.WeightedLayout_LayoutParams_horizontalWeights); 
```

奇怪的是，如果我运行该应用程序，它运行良好（除了我在原始线程中报告的奇怪错误）。我试图修改[制作 flowLayout 的 RomainGuy 的代码](https://docs.google.com/file/d/0B_VKZCqEnHblNDdiY2UxODgtYWNhNS00MmU4LWE4NDMtZjQ1OWI5MDMxZTVh/edit?num=50&sort=name&layout=list&pli=1#)，并且我注意到那里也发生了相同的行为。

谁能告诉我我该怎么做？怎么行不通？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T19:57:30.177

最后我通过查看 android 代码找到了答案：

[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/TextView.java?av=f](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/TextView.java?av=f)

为了获取文本，您需要检查所有属性并使用 getText ，例如：

```
final TypedArray a=getContext().obtainStyledAttributes(attrs,R.styleable.WeightedLayout_LayoutParams);
int indexCount=a.getIndexCount();
for(int i=0;i<indexCount;++i)
  {
  final int attr=a.getIndex(i);
  if(attr==R.styleable.WeightedLayout_LayoutParams_horizontalWeights)
    _textToShow=a.getText(attr);
  }
a.recycle(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-14T21:23:33.493

您应该在分配之前检查 TypedArray.hasValue() ：

```
final TypedArray arr = context.obtainStyledAttributes(attrs,R.styleable.WeightedLayout_LayoutParams);
//...
if (arr.hasValue(R.styleable.WeightedLayout_LayoutParams_horizontalWeights)) {
final String horizontalWeights = arr.getString(R.styleable.WeightedLayout_LayoutParams_horizontalWeights);
} 
```

# ios - 透明 UITableViews 不正确滚动

> ID：12661975
> 
> 赞同：1
> 
> 时间：2012-09-30T14:27:23.270
> 
> 标签：ios, uitableview, scroll, transparent

我`UITableView`在我的应用程序中使用 a。此表没有特殊编码，也没有特殊的 IB 设置。一旦我通过以下方式设置背景透明：

```
myTableView.backgroundColor=[UIColor clearColor] 
```

我的 Tableview 不能再正确滚动了。如果您点击 TableView 或图像中的文本，它会滚动正常，但如果我在文本行或空单元格之间触摸，它不会滚动或反弹。

这发生在模拟器（iOS 6.0、5.1、5.0 iPhone 或 iPad）和我的设备 iPhone 4、4S、5 和带有 XCode 4.5 的 iPad 上

一个令人惊讶和奇怪的解决方案是使用`[UIColor colorWithWhite:0.1 alpha:0.1]`而不是`[UIColor clearColor]`. 使用 0 而不是 0.1 也会有同样的问题。

给 TableView 添加透明背景视图也有同样的效果。

是否有人对如何使 UITableView 透明有相同的问题或其他解决方案？

# android - Android System.currenttimemillis 的区别

> ID：12661979
> 
> 赞同：0
> 
> 时间：2012-09-30T14:28:32.843
> 
> 标签：android, datetime, format, chat

我正在开发聊天应用程序并保存`currentTimeMilis`。我得到了按 currenttimemilis 排序的新条目。当新条目来时 listview 更新。但是有些人的 currenttimemilis 值比其他人大.. 所以显示新条目是个问题

所以我不能得到新的条目......我应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:47:12.113

如果在不同的设备上收集定时，它们将始终因设备而异，因为它们彼此不同步。我只看到解决它的选项：

- 如果消息是立即发送的，您可以将消息时间设置为消息到达的时间，因为它们将“可能”按照它们发送的顺序到达。“可能”是因为某些用户的互联网连接速度可能较慢，这可能会延迟消息，但这对于大多数用途来说并不重要。

- 如果消息是稍后发送的，您必须连接到时间服务器，从那里获取时间以在消息中设置。当然，您不需要连接每条消息，只需在应用程序启动时获取设备和服务器之间的时间差，然后为每条消息应用该差异。

- 如果您的应用程序需要启用 GPS，您还可以从中获取准确的时间。由于 GPS 使用 UTC，因此您需要对您的时区进行更正。

--已编辑--

有关如何从时间服务器获取时差的更多详细信息：

1-在应用程序启动时，您连接到时间服务器以获取准确时间并将该时间与设备时间进行比较。您将时间差存储在一个变量中以供以后使用。

2-每次使用Cloud API发送消息时，获取设备时间，加上上面第1步得到的时间差，设置消息时间为这个值。如果您有不同国家的用户，您可能还需要应用与不同时区相关的更正。

祝你好运。

# java - 如何在 windows 7 中启动 apache-tomcat- 5.0.28 以在 java 中运行 servlet 程序

> ID：12661980
> 
> 赞同：0
> 
> 时间：2012-09-30T14:28:38.940
> 
> 标签：java, apache, tomcat, servlets, windows-7

我已经在 windows 7 操作系统中安装了下载并解压的 apache-tomcat- 5.0.28。然后我按照下面的说明进行操作。

1.  现在右键单击我的电脑图标，选择属性->高级->环境变量。
2.  单击系统变量框架中的新按钮（在上图中突出显示）。单击新按钮打开对话框以添加新的系统变量。
3.  现在在变量名中键入 CATALINA_HOME，在变量值中键入 C:\Program Files\jakarta-tomcat-5.0.28，然后单击确定。
4.  再次单击系统变量框架中的新按钮
5.  现在在变量名中输入 JAVA_HOME，在变量值中输入 C:\Program Files\Java\jdk1.5.0_21，然后单击确定。
6.  现在从系统变量框架中选择路径变量单击系统变量框架中的编辑按钮现在添加；C:\Program Files\apache-tomcat-5.0.28\lib; 然后单击确定。
7.  现在通过单击 start->run->cmd type SET CLASSPATH= C:\Program Files\jakarta-tomcat-5.0.28\lib\servlet-api.jar type cd C:\Program Files\jakarta-tomcat- 打开 Dos 提示符5.0.28\bin 输入startup（启动tomcat服务器）和需要关闭服务器的时候输入shutdown

完成上述所有步骤后，当我在 dos 提示符中键入启动时，出现大量错误并且无法启动 apache tomcat。任何人都可以提出任何解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-23T16:53:55.427

通过 cmd 行更容易。cd 到 apache-tomcat-5.0.28\bin 然后键入命令`set JAVA_HOME=c:\Program Files\Java\jdk1.5.0_21`然后按回车键然后键入`set JRE_home=c:\Program Files\Java\(JRE you have)`你的 jre 将是一个文件，可能在你的 Jdk 旁边使用它的名称 () 所在的位置。然后按回车类型`startup`，然后再次按回车，它应该可以工作。

# java - Mockito 我如何模拟这个方法？

> ID：12661989
> 
> 赞同：0
> 
> 时间：2012-09-30T14:29:30.367
> 
> 标签：java, unit-testing, junit, mocking

我是嘲笑的新手，所以我正在玩这个场景。我有一个`MyClass.process()`调用`MyClass.getFactory()`. 我想模拟`getFactory()`失败，以便我可以确保`process()`正确恢复。

似乎如果我`getFactory()`在模拟之后调用它会正确抛出异常，但如果它是通过原始`process()`方法调用的，则不会抛出异常。

```
public class MyClass {

    public MyFactory getFactory() throws FactoryException {
        return ...
    }

    public String process() {
        try {
            MyFactory factory = getFactory();
            ...
        }
        catch(FactoryException ex) {
            ...
        }
    }

} 
```

测试类：

```
public class MyClassTest {

    @Test
    public void testGetFactoryFails() {
        try {
            MyClass mockMyClass = mock(MyClass.class);
            when(mockMyClass.getFactory()).thenThrow(new FactoryException());
            mockMyClass.process();
            fail("FactoryException should have been thrown.");
        }
        catch(FactoryException ex) {
            // all good
        }
    }

} 
```

感谢所有的反馈。我可以看到在更复杂的环境下模拟单个方法会很快变得难以管理。getFactory() 的内容并不重要，因为这是概念代码，而不是生产代码。

我尝试过的一种方法效果很好：

```
public class MyClassTest {

    class MyClassMock1 extends MyClass {

        @Override
        public MyFactory getFactory() throws FactoryException {
            throw new FactoryException("Bad factory instance.");
        }

    }

    @Test
    public void testGetFactoryFails() {
        try {
            MyClassMock1 mockMyClass = new MyClassMock1();
            mockMyClass.process();
            fail("FactoryException should have been thrown.");
        }
        catch(FactoryException ex) {
            assertEquals("Bad factory instance.", ex.getMessage());
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T14:51:36.723

我将扩展[*@Can't Tell*](https://stackoverflow.com/users/672841)已经说过的内容。您使用模拟库来模拟被测类的依赖关系。在您的情况下，您进行测试`MyClass`，并且在测试期间您应该模拟所有依赖项（`MyClass`使用的类）。

您想在一个类中模拟一个方法并测试另一种方法。虽然这在技术上可能是可行的（但由于各种代理/包装机制对您不起作用），但它肯定是一个糟糕的设计。

告诉我们你的`getFactory()`方法。如果它单独处理整个工作，请将其提取到单独的类并模拟它。如果它只委托给另一个类，则模拟该类。可悲的是，这个提取的类将被命名为`MyFactoryFactory`......

提取依赖项后，对其进行模拟并`MyClass`在测试之前传递给它（通过构造函数、设置器...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:51:56.070

这是因为部分嘲笑是不好的（这就是你想要做的）。它恰恰导致了这类问题。它主要用于遗留系统测试。如果您编写新代码并且必须使用部分模拟，这意味着您很可能有糟糕的系统设计。

您应该`getFactory`将调用委托给其他服务（注入`MyClass`），然后您应该模拟整个服务

# python - 从 mysqldb 查询中获取原始十进制值

> ID：12661999
> 
> 赞同：21
> 
> 时间：2012-09-30T14:30:39.933
> 
> 标签：python, mysql, mysql-python

我正在使用 MySQLdb 包在 python 中执行 mysql 查询。代码看起来像这样：

```
c=db.cursor()
c.execute("""select * from table""")
output = []
for row in c:
    output.append(row[4]) 
```

其中`row[4]`包含我要存储在`output`列表中的十进制值。

问题是我得到的每个值都是这样的：`Decimal('XX.XX')`我想要的`output`列表中的所有值都是 XX.XX。在脚本的末尾，我的`output`列表如下所示：

```
[Decimal('10.02'), Decimal('20.24'), ...] 
```

但我需要它只包含数字，如下所示：

```
[10.02, 20.24, ...] 
```

我怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-30T14:33:46.530

您可以将 Decimal 对象转换为字符串：

```
cursor = db.cursor()
cursor.execute("""select * from table""")
output = []
for row in cursor:
    output.append(str(row[4])) 
```

或浮动：

```
cursor = db.cursor()
cursor.execute("""select * from table""")
output = []
for row in cursor:
    output.append(float(row[4])) 
```

将其转换为浮点数会导致其失去全部精度，因此像 20.24 这样的值将变为 20.239999999999998。

此外，如果值为 ，则将其转换为浮点数会引发异常`None`。为避免这种情况，您可以使用这样的辅助函数：

```
def convert_mysql_decimal_to_float(decimal_object):
    if (decimal_object == None):
        return None
    else:
        return float(decimal_object)

cell_value = convert_mysql_decimal_to_float(row[4]) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-30T14:33:11.803

使用`float()`：

```
output.append(float(row[4])) 
```

但`float()`可能会导致类似：

```
In [184]: float(Decimal('10.02'))
Out[184]: 10.02

In [185]: float(Decimal('20.24'))
Out[185]: 20.239999999999998 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-07-21T09:41:32.357

如果您尝试编写对列输出进行操作的通用代码，则上述解决方案将无法运行。在这种情况下，我们可以以将列返回为 String 的方式编写`SELECT`查询，我们只需得到我们想要的值。查询可以通过以下方式构建，

```
SELECT 
 CAST(COL1 AS CHAR) AS COL1,
 CAST(COL2 AS CHAR) AS COL2,
 .
 .
 .
FROM TABLE; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-12T07:49:28.957

为避免丢失精度，您可以使用[Python 的十进制模块](https://docs.python.org/3/library/decimal.html)。

```
from decimal import Decimal
c=db.cursor()
c.execute("""select * from table""")
output = []
for row in c:
    row_data = []
    for data in row:
        if type(data) is Decimal:
            row_data.append(float(data))
        else:
            row_data.append(str(dat))
        output.append(row_data) 
```