# StackOverflow 问答 13463000-13463999

# excel - ColdFusion 在多个工作表上导出到 Excel

> ID：13463001
> 
> 赞同：1
> 
> 时间：2012-11-19T21:57:57.267
> 
> 标签：excel, coldfusion, spreadsheet

我正在使用下面的代码将数据从数据库导出到 Excel 工作表。我想要做的是将一组字段导出到同一工作簿中的不同工作表。最终结果是每个人的数据都在单独的工作表上，而不是像这段代码那样全部组合在同一个工作表上。关于如何编写公式或 ColdFusion 的任何想法让我这样做？

另外我使用的是 ColdFusion 8，所以我不能使用 cfspreadsheet 函数。

```
<!--- use cfsetting to block output of HTML 
outside of cfoutput tags --->
<cfsetting enablecfoutputonly="Yes">

<!--- set content type to invoke Excel --->
<cfcontent type="application/msexcel">

<!--- suggest default name for XLS file --->
<!--- use "Content-Disposition" in cfheader for 
Internet Explorer  --->
<cfheader name="Content-Disposition" value="filename=export.xls">
<!--- output data using cfloop & cfoutput --->

<cfquery name="qquestionnaire_export" datasource="mydatabase">
Select * from registration
</cfquery>

<cfoutput>
<table>
<tr><td align="center">Transfer Registration Questionnaire</td>
<td></td>
</tr>
<th>Credit Category</th>
<th>Completed Degree</th>
<th>Highest Degree</th>

</cfoutput>

<cfloop query="qquestionnaire_export">
<cfoutput>  
<tr>
<td align="center">#credit_category#</td>
<td align="center">#completed_degree#</td>
<td align="center">#highest_degree#</td>

</tr>
</cfoutput>
</cfloop>

<cfoutput><tr><td height="10"></td></tr></cfoutput>

<cfoutput></table></cfoutput> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:40:06.460

如果你不能使用`<cfspreadsheet>`，那么我建议使用 Apache POI 项目，而不是简单的“HTML as Excel via CFCONTENT”方法。POI 使您能够创建具有与之相关的所有乐趣的*实际Excel 电子表格。*

Ben Nadel 有一个 CFC 包装器，它公开了 API 的多页部分。

[http://www.bennadel.com/projects/poi-utility.htm](http://www.bennadel.com/projects/poi-utility.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-03T14:58:14.823

我知道这是一个老话题，但如果我早点找到它，这个解决方案会很有帮助。但是，这是一个基本的函数调用，它应该允许将任意数量的查询放入具有多个选项卡的 Excel 工作表中。

```
<cffunction name="QueriesToXLS" access="public">
    <cfargument name="queryArr" required="true"><!--- An Array of Query Objects --->
    <cfargument name="sheetNameArr" required="false"><!--- Optional sheet names to use instead of "Sheet1","Sheet2",... --->
    <cfset tempPath = GetTempDirectory() & CreateUuid() & ".xls"><!--- Creaete a Temp XLS File --->
    <cfset counter = 1>
    <cfloop array="#ARGUMENTS.queryArr#" index="i">
        <cfset sheetName = "Sheet#counter#">
         <cfif isDefined("ARGUMENTS.sheetNameArr")>
            <cfset sheetName = ARGUMENTS.sheetNameArr[counter]>
        </cfif>
        <cfspreadsheet action="update" filename="#tempPath#" query="i" sheetName="#sheetName#"/>
        <cfset counter += 1>
    </cfloop>
    <cfreturn SpreadsheetRead(tempPath)>
</cffunction>

<cfset xlsData = QueriesToXLS(
    [query1,query2],
    ["Details","Summary"]
)>

<cfheader name="content-disposition" value="attachment; filename=export.xls">
<cfcontent type="application/msexcel" variable="#spreadsheetReadBinary(xlsData)#" reset="true"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T00:04:26.140

Apache POI 是必经之路。[http://poi.apache.org/](http://poi.apache.org/)

花点时间阅读文档并进行一些测试，因为它可以让您完全控制而不是试图用 CSS 来伪造 HTML 表格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T11:36:03.737

如果您可以避免使用此方法，那将是最好的。Excel 足够聪明，可以在“电子表格”外观的输出中输出您的 HTML，但它仍然是一个带有 xls 扩展名的 HTML 文档。我在使用像这样创建的电子表格时遇到了几个问题，这些电子表格需要一个**实际**的Excel 文件。在 ColdFusion 中，如果您尝试使用 cfspreadsheet 读取此文件，您很可能会收到类似`expected binary input file`（或类似内容）的错误消息，您必须使用 excel 将其`save as`变为实际的 Excel 电子表格。更不用说这是一个静态输出。您不能包含任何公式或任何有趣的东西，如 iKnowKungFoo 指出的。

由于这不能*回答*您的问题，除了 POI 工具之外，您还可以查看其他 BI 工具，例如 JasperSoft、Crystal Reports，或者如果您使用的是 Oracle 或 MS SQL Server，您可以查看 Oracle 的 BI 工具或 SSRS对于 SQL 服务器。有几个 BI 工具在没有支持选项的情况下是免费的，我相信 JasperSoft 就是其中之一。

回到 ColdFusion，我从未尝试将 CFReport 与报表生成器一起使用来创建 Excel 格式的报表，但在 CF 8 中可以使用 excel 格式。我不确定你是否可以用它创建多张纸，我假设不考虑下面的片段，但它可能值得研究。我找不到任何东西，但时间还早，我病了，今天早上我的 google-foo 有点慢。

> *注意：* Excel 报告输出格式类型对 ColdFusion Reporting 中可用的格式选项提供有限的支持。不支持图像和图表，并且包含格式（逗号、百分比、货币等）的数字数据在 Excel 中显示为纯文本。Excel 输出格式仅支持简单的报告，Adobe 建议您仔细考虑设计和布局用于 Excel 输出的报告。

# ruby-on-rails - 按相关对象选择的正确方法

> ID：13463005
> 
> 赞同：0
> 
> 时间：2012-11-19T21:58:04.593
> 
> 标签：ruby-on-rails, activerecord

我想问，从给定的书架上选择书籍的正确方法是什么

```
class Book < ActiveRecord::Base
    belongs_to :shelf
end

class Shelf < ActiveRecord::Base
    has_many :books
end 
```

使用`Book.where(:shelf => shelf)`会引发异常，例如`no such column: book.shelf`. 我知道我可以反转它，`shelf.books`但是如果需要过滤多个对象，这将不起作用。我所能找到的只是查询应该看起来像`Books.where(:shelf_id => shelf.id)`，但这似乎不是很干，甚至有点酷..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:13:20.433

您可以使用连接或包含：

```
Book.joins(:shelfs) # will load all the Books that have one Shelf

Book.includes(:shelfs) # will load all the Books and Shelfs even if the book has no Shelf associated

# or beginning with a Shelf object:
@shelf.books # will return all Book where shelf_id = @shelf.id 
```

如果您需要精确度/有疑问，请随时发表评论；）（我在想您的短语*“就像shelf.books，但如果需要过滤多个对象，这将不起作用。”*我不是很明白）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:18:07.617

对于关系枯燥，请看一下[委托](http://blog.jayfields.com/2006/05/law-of-demeter-and-forwardable.html)，其中从一个模型到另一个模型的引用被封装在其中一个模型中。关于这是否是解决实际问题的方法有很多讨论，我个人认为可以，但请自行决定。文章很旧，但没有过时。

# windows - 以编程方式配置 Windows 搜索服务，可以吗？

> ID：13463006
> 
> 赞同：0
> 
> 时间：2012-11-19T21:58:07.043
> 
> 标签：windows, desktop-search

我正在开发一款软件，该软件使用过滤器驱动程序管理对用户配置文件区域的读/写。我意识到 Windows 搜索服务被我们的过滤器驱动程序弄糊涂了，需要从搜索中排除磁盘的这个区域（无论如何这对这个区域没有意义）。

我意识到可以通过编程方式将排除项添加到：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Search\CrawlScopeManager\Windows\SystemIndex\DefaultRules 
```

并重新启动服务以获取它。但是，这有点重。有谁知道是否有可能以更优雅的方式做这种事情？我查看了 Search SDK，但它似乎更针对想要使用搜索数据而不是配置服务的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T12:49:00.467

事实证明，如果不使用直接注册表操作，这是可能的：

[Crawl Scope Manager API](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb266541%28v=vs.85%29.aspx)（现在是 SDK 7+ 的一部分）

# scala - 意外更改 Scala Actor 的局部变量

> ID：13463011
> 
> 赞同：0
> 
> 时间：2012-11-19T21:58:18.453
> 
> 标签：scala, actor-model

我目前正在研究一种与 Scala 一起使用的日志记录机制，但我遇到了一个意外问题，阻止了我实际研究它。为了测试功能，我希望设置一个简单的消息传递环。在环内，每个节点都是 Scala Actor 的扩展，并且知道它的直接邻居（上一个/下一个）。

环构造如下完成，参数“nodes”从控制器参与者传递：

```
def buildRing(nodes:Array[Actor]){
  var spliceArr:Array[Actor] = new Array[Actor](2)
  spliceArr(0) = nodes(nodes.length-1)
  spliceArr(1) = nodes(1)
  nodes(0) !  spliceArr
  Thread.sleep(100)
  spliceArr(0) = nodes(nodes.length-2)
  spliceArr(1) = nodes(0)
  nodes(nodes.length-1) ! spliceArr
  Thread.sleep(100)
  for(i <-1 to numNodes-2){
      spliceArr(0) = nodes(i-1)
      spliceArr(1) = nodes(i+1)
      nodes(i) ! spliceArr
      Thread.sleep(100)
  }
} 
```

这似乎可以按我的意愿运行，每个节点都接收到正确的邻居对。在节点类中有一个大小为 2 的数组，设置如下：

```
class node(locLogger:logger,nid:Int,boss:Actor) extends Actor{
  val ringNeighbors:Array[Actor] = new Array[Actor](2)
  def act{
    locLogger.start
    loop{
        receive{
            case n:Array[Actor] =>
              ringNeighbors(0) = n(0)
              ringNeighbors(1) = n(1) 
```

一切都很好，但是，当我引入要在环周围传递的消息时（从节点 0 开始），我发现每个节点现在在它的 ringNeighbors 数组中都有相同的值。这些值与 ringBuilder（即节点 8 的邻居）函数中循环的最终迭代一致。没有发生额外的消息传递，所以我不明白这些值是如何为节点数组中的每个实例修改的，因此是环。

我仍在学习 Scala 的基本知识，希望我没有错误地忽略一些简单的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:46:14.540

我认为问题如下：

Actor 模型本质上是一个异步模型，这意味着 Actor 有时会处理消息，而与发送时间无关。

您正在向每个参与者发送对大小为 2 数组的引用，该数组会根据迭代的状态不断更改其内容。但是，actor 不会在调用之后立即处理初始化消息`nodes(i) ! spliceArr`。所以可能发生的是迭代完成，并且只有在这之后，参与者才被安排来处理消息。`spliceArr`问题是，当 for 循环完成时，他们都看到了实例。

所以简单的解决方案是不发送数组而是发送一对：

```
nodes(i) ! spliceArr 
```

变成

```
nodes(i) ! (nodes(i-1), nodes(i+1)) 
```

并且您还应该在循环之前修改相应的行。这种改变也应该在参与者的代码中执行——使用元组而不是数组来处理这种东西。

如果我的猜测是正确的，那么核心问题是您正在使用可变数据结构（在您的情况下为数组），这些数据结构在各种实体（在您的示例中为演员）之间共享。这总是会导致问题，因此除非您正在处理的应用程序确实特别需要有状态的数据结构，否则您应该始终将赌注押在不变性上。

现在，在参与者系统的特定情况下，参与者之间交换的消息更需要是不可变的。Actor 应该是封闭的数据结构，它们的状态不应该从外部访问。此外，在参与者系统中不应该有全局状态。

不幸的是，与其他实现 Actor 系统的语言（如 Erlang）不同，Scala 无法强制执行此行为。因此，确保发生这种情况是开发人员的工作。

可变消息是不好的，因为它们会导致参与者共享状态——消息中包含的状态在参与者并发执行的上下文中可能会导致难以发现的问题。

以下是上述修复后代码的外观：

```
def buildRing(nodes: Array[Actor]) {
    nodes.zipWithIndex.foreach {
        case (actor, index) => actor ! (previous(nodes, index), next(nodes, index))
    }
}

//Gets the next actor from the ring for the specified index.
def next(nodes: Array[Actor], index: Int): Actor = {
    val k = (index + 1) % nodes.length
    nodes(k)
}

//Gets the previous actor
def previous(nodes: Array[Actor], index: Int): Actor = {
    val k = if (index == 0) nodes.length - 1 else index - 1
    nodes(k)
}

class Node(locLogger:logger, nid:Int, boss:Actor) extends Actor {
    private var leftNeighbour: Option[Actor] = None //avoid using null in favor of Option
    private var rightNeighbour: Option[Actor] = None
    def act {
        locLogger.start
        loop {
            receive {
                case (left, right) => {
                    leftNeighbour = Some(left)
                    rightNeighbour = Some(right)
                }
            }
        }
    }
} 
```

为了提高算法的可读性，我还做了一些更改，希望您不要介意。

# c - 为什么需要取消引用 char 指针？

> ID：13463012
> 
> 赞同：-1
> 
> 时间：2012-11-19T21:58:22.473
> 
> 标签：c, memory, malloc

我不明白为什么必须在这里取消引用指针。`char *toParseStr = (char*)malloc(10);`有人有想法么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T21:59:23.960

`char *toParseStr = (char*)malloc(10);`

这里没有取消引用，而是将`malloc`返回值转换为`char *`. 演员表不是必需的，甚至应该避免。

要知道为什么应该避免演员表：

[http://c-faq.com/malloc/mallocnocast.html](http://c-faq.com/malloc/mallocnocast.html)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-19T22:01:30.820

malloc 返回一个 void*，因此在某些情况下需要强制转换以防止编译错误

# cdi - 使用 CDI 修改类注释

> ID：13463014
> 
> 赞同：0
> 
> 时间：2012-11-19T21:58:29.717
> 
> 标签：cdi, weld

尝试使用 CDI 扩展事件`ProcessAnnotatedType`来更改`@javax.ws.rs.Path`JAX-RS 资源。

```
<X> void process(@Observes ProcessAnnotatedType<X> pat) {
  if (!pat.getAnnotatedType().isAnnotationPresent(javax.ws.rs.Path.class)) {
    return;
  }
  final AnnotatedType<X> org = pat.getAnnotatedType();
  AnnotatedType<X> wrapped = new AnnotatedType<X>() {
    @Override
    public <T extends Annotation> T getAnnotation(final Class<T> annotation) {
    if (javax.ws.rs.Path.class.equals(annotation)) {
      class PathLiteral extends AnnotationLiteral<javax.ws.rs.Path> implements javax.ws.rs.Path {
        @Override
        public String value() {
          return "change_me/" + (javax.ws.rs.Path) org.getAnnotation(annotation);
        }
      }
      return (T) new PathLiteral();
    } else {
      return org.getAnnotation(annotation);
    }
  }
  pat.setAnnotatedType(wrapped);
} 
```

...然后在引导之后，使用构建 bean`javax.enterprise.inject.spi.BeanManager`期望以下代码打印“change_me/....”

```
Set<Bean<?>> beans = beanManager.getBeans(jaxrsClass);
for (Bean<?> bean : beans) {
  CreationalContext cc = bm.createCreationalContext(bean);
  Object jaxrs = bean.create(cc);
  Path p = jaxrs.getClass().getAnnotation(Path.class);
  System.out.println(p.value());
} 
```

...但这不起作用。`javax.ws.rs.Path`对于 JAX-RS 资源 'jaxrsClass' 保持不变。

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:25:02.500

`AnnotatedType`是 CDI 和实际 Java 类注解之间的抽象层。CDI 只考虑`AnnotatedType`元数据，而不考虑原始注释。

修改`AnnotatedType`观察者方法中的 an 不会更改底层 Java 类上的原始注解。

# jsf - 从 xhtml 将字符串参数传递给函数或方法

> ID：13463016
> 
> 赞同：4
> 
> 时间：2012-11-19T21:58:40.220
> 
> 标签：jsf, el

我有一个按钮，我想根据函数返回真假来呈现。

**的HTML：**

```
<p:commandButton type="button" rendered="#{myBean.checkPermission(1)}" value="Create"  /> 
```

**和支持bean：**

```
public boolean checkPermission(String actionKey) {
...
} 
```

问题是当我使用数字参数调用 checkPermission 时

`#{myBean.checkPermission(1)}`,

它工作正常，但我传递一个字符串作为参数，即

`#{myBean.checkPermission(ABC)}`

，我得到一个空字符串传递。知道为什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T00:19:02.097

您没有传递`String`，而是传递了一个`ABC`EL 无法理解的变量，并且您的方法将收到`null`值（感谢 BalusC 的纠正）。您应该添加撇号 (') 来告诉您正在传递的框架`String`：

```
<p:commandButton type="button" rendered="#{myBean.checkPermission('ABC')}"
    value="Create" /> 
```

# null - 如何在 Extjs 4 上加载空网格

> ID：13463020
> 
> 赞同：1
> 
> 时间：2012-11-19T21:58:47.847
> 
> 标签：null, grid, load, extjs4

我想在应用程序开始时加载并清空网格。仅当用户从复选框中选择一个值时，才应填充网格。我不能在商店中使用 autoLoad: false ... 是否有类似 onLoad: false .. 之类的功能

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:11:29.533

默认[情况下](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.AbstractStore-cfg-autoLoad) *不*加载网格的存储，因此您实际上无需执行任何操作。

我假设您正在谈论一个常规[Store](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.Store)，而[TreeStore](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.TreeStore)事情有点复杂，因为您需要确保根节点没有展开或取消*onbeforeload*侦听器中的负载。

# ruby-on-rails - 在 ActiveRecord 模型中隐藏属性

> ID：13463025
> 
> 赞同：2
> 
> 时间：2012-11-19T21:59:12.840
> 
> 标签：ruby-on-rails, ruby, activerecord

我对 Rails 有点陌生，正在使用 ActiveRecord 设计用户模型。在这个模型中，我有一个密码属性，用于保存用户密码的哈希值。

我想直接删除此属性的读取和设置。但是，在使用 Rails 控制台时，我似乎找不到删除访问器的方法。到目前为止，唯一可行的解​​决方案是显式覆盖密码的访问器方法，我真的不想覆盖它们，我希望访问器消失 - 或者至少是读者。

这是我的模型：

```
class User < ActiveRecord::Base

  // various associations

  def password_correct?(password)
    read_attribute(:password) == hash(password)
  end

  def password=(password)
    write_attribute(:password, hash(password))
  end

  def password
    "get your dirty fingers off this attribute"
  end

  private

  def hash(input)
    Digest::SHA2.new(512).update(input).hexdigest
  end

end 
```

任何想法如何实现这一目标或这种方法的任何缺点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T22:29:54.773

基于以上答案，我做了一些实验以获得预期的结果。我最终制作了一个“私有”密码哈希属性和一个名为密码的虚拟访问器。

在这个过程中我做了一些观察：

*   ActiveRecord 似乎没有任何私有属性的概念。使用诸如此类的符号将访问器方法设为私有`private :password, :password=`不是一种选择，因为 Rails`NameError: undefined method`在实例化模型时会抛出一个，因为模型本身没有定义这两个方法（它们似乎是从 继承的`ActiveRecord::Base`）。

*   用纯无覆盖 password_hash 访问器对于防止对属性的操作非常有用，但这也意味着 ActiveRecord 本身在更新 password_hash 属性时会失败，因为它正在调用空实现。

因此，将访问器设为私有会失败，因为它们在实际模型中未定义。定义它们也失败了，因为它破坏了 ActiveRecord。所以，你可以做什么？

我做了两个，还有更多。我将访问器设为私有，定义它们并通过调用`super`. 这可以防止控制器（和 rails 控制台）通过抛出 a 来访问它们`NoMethodError`，但不会拒绝 ActiveRecord。

### 旁注：验证问题

我的方法遇到的一个问题是验证失败。对 password_hash 实施最小长度是不好的，因为任何密码（甚至没有）都会导致 128 个字符的 SHA512 哈希。所以验证哈希没有什么意义。相反，我向虚拟密码访问器添加了验证并添加了一个`before_save :hash_password`回调，该回调检查是否已设置虚拟访问器属性，如果已设置，则对其进行哈希处理并将其写入 password_hash 属性。

## 最终实施

我的实现以这种方式结束：

```
class User < ActiveRecord::Base
  attr_accessible :first_name, :last_name, :email
  attr_accessor :password
  validates :password, :length => { :minimum => 8 }, :if => :password_changed?
  validates :first_name, :last_name, :email, presence: true
  # Various associations
  before_save :hash_password

  def password_correct?(p)
    if(password.present?)
      password == p
    else
      read_attribute(:password_hash) == hash_string(p)
    end
  end

  def role_symbols
    roles.collect do |r|
      r.name.to_sym
    end
  end

  private

  def hash_string(input)
    Digest::SHA2.new(512).update(input).hexdigest
  end

  def hash_password
    if(password.present?)
      write_attribute(:password_hash, hash_string(password))
      self.password = nil
    end
  end

  def password_changed?
    password.present? or new_record?
  end

  def password_hash
    super
  end

  def password_hash=(p)
    super
  end

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:15:24.170

您可以使用私有方法轻松地将访问器设为私有，在您的模型中添加以下行：

```
private :password, :password= 
```

另外，我建议您不要覆盖密码字段访问器。也许您可以命名`password_hash`数据库中的字段并将此列的访问器设为私有。然后按预期编写方法`password`。`password=`

如果它不符合您的需求，您能解释一下为什么吗？为什么你想要的会是更好的解决方案？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T01:46:27.260

我在为应用程序寻找身份验证解决方案时偶然发现了 devise 之类的宝石，最后采用了[http://bcrypt-ruby.rubyforge.org/](http://bcrypt-ruby.rubyforge.org/)中举例说明的这种更简单的方法。

```
require 'bcrypt'

class Account < ActiveRecord::Base
  attr_accessor :password, :password_confirmation, :role

  def password
    @password ||= BCrypt::Password.new(crypted_password)
  end

  def password=(new_password)
    @password = BCrypt::Password.create(new_password)
    self.crypted_password = @password
  end
end 
```

**编辑：**演示，在带有 ActivecRecord 和 Postgresql 的 Padrino 应用程序中实现

```
[6] pry(main)> a = Account.new
=> #<Account id: nil, name: nil, email: nil, role: nil, uid: nil, provider: nil, created_at: nil, updated_at: nil, crypted_password: nil>
[7] pry(main)> a.password = "asdf"
=> "asdf"
[8] pry(main)> a.password
=> "$2a$10$9udQKttf5zFqCv7da9ZY0uMsWYlbeGK3apEkIY6x05KND1v3vOkh2"
[9] pry(main)> a.password == "asdf"
=> true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-17T20:36:49.613

让我讲一个简短的故事，说明为什么我必须走与您类似的道路。我曾经不得不“取消订阅”我模型的许多属性/列。

问题是我想通过`read_attribute`方法达到列值。我正在寻求几周后应该从数据库中删除这些列，所以我想首先优雅地迁移这些“已弃用”列中的数据（并将它们移植到新表中），但我仍然想使用整个应用程序中使用相同的旧属性访问器方法，但它们将使用新的数据库结构。

因此，我没有简单地逐个方法（读取器和写入器）覆盖方法，而是简单地编写`method_missing`以捕获所有旧列（通过正则表达式）并将它们的操作重定向到新逻辑中。但只有当我可以“取消定义”旧的访问器（“脏”）方法时，我才能做到这一点，否则它们将永远无法到达`method_missing`方法。

因此，经过一番挣扎后，我进入了以下解决方案（适应您的情况）：

```
class Account < ActiveRecord::Base

  # ...

  unless attribute_methods_generated?
    define_attribute_methods
    undef_method "password"
    undef_method "password="
  end

  # ...

end 
```

我只需要删除 reader 和 writter 方法，但如果需要，您可以删除所有其他“脏”方法。

`attribute_methods_generated?`如果脏方法已经生成，则类方法返回 true 。然后它强制生成脏方法，然后才删除所需的方法。如果您简单地尝试`undef_method`直接在类范围内使用方法，它会抛出一个异常，告诉您您尝试删除的方法不存在（尚）。这就是为什么你需要在上面那样做。

# ios - Cordova 2.2 + ChildBrowser 3.0.4 + iOS == 失败

> ID：13463030
> 
> 赞同：0
> 
> 时间：2012-11-19T21:59:22.777
> 
> 标签：ios, cordova, childbrowser

我只是想在我的 PhoneGap 应用程序中设置一个功能，在外部浏览器中打开某些链接。该代码似乎在 Android 上运行良好（我没有在 Windows Phone 上进行测试，因为插件信息声称支持尚不存在......），但每次我尝试让它在 iPhone 上运行时模拟器（iOS 5.1），它因以下错误而爆炸：

```
testCB[3332:c07] CDVPlugin class childbrowser.js (pluginName: ChildBrowser) does not exist.
testCB[3332:c07] ERROR: Plugin 'ChildBrowser' not found, or is not a CDVPlugin. Check your plugin mapping in Cordova.plist.
testCB[3332:c07] -[CDVCommandQueue executePending] [Line 102] FAILED pluginJSON = ["ChildBrowser1249404349","ChildBrowser","showWebPage",["http://www.apple.com",{"showLocationBar":true}]] 
```

我浏览了所有的论坛和这里，我不断看到人们提到更新 Cordova.plist 文件。好的，这就是（请注意，这是针对全新的 Cordova 应用程序，而不是升级或更新，我现在正在使用测试应用程序尝试此操作，以排除我自己的应用程序中的不稳定因素）：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <!-- the standard keys snipped -->
    <key>ExternalHosts</key>
    <array>
        <string>*</string>
    </array>
    <key>Plugins</key>
    <dict>
        <key>ChildBrowser</key>
        <string>childbrowser.js</string>
        <key>ChildBrowserCommand</key>
        <string>ChildBrowserCommand</string>
        <key>Device</key>
        <string>CDVDevice</string>
        <key>Logger</key>
        <string>CDVLogger</string>
        <key>Compass</key>
        <string>CDVLocation</string>
        <key>Accelerometer</key>
        <string>CDVAccelerometer</string>
        <key>Camera</key>
        <string>CDVCamera</string>
        <key>NetworkStatus</key>
        <string>CDVConnection</string>
        <key>Contacts</key>
        <string>CDVContacts</string>
        <key>Debug Console</key>
        <string>CDVDebugConsole</string>
        <key>Echo</key>
        <string>CDVEcho</string>
        <key>File</key>
        <string>CDVFile</string>
        <key>FileTransfer</key>
        <string>CDVFileTransfer</string>
        <key>Geolocation</key>
        <string>CDVLocation</string>
        <key>Notification</key>
        <string>CDVNotification</string>
        <key>Media</key>
        <string>CDVSound</string>
        <key>Capture</key>
        <string>CDVCapture</string>
        <key>SplashScreen</key>
        <string>CDVSplashScreen</string>
        <key>Battery</key>
        <string>CDVBattery</string>
        <key>Globalization</key>
        <string>CDVGlobalization</string>
    </dict>
</dict>
</plist> 
```

（编辑）在我的 index.html 文件中，我已经包含（我意识到这几乎是不言而喻的。我也意识到很多问题都是由那些不考虑先尝试所有明显的东西的人发布的！）：

```
 <script type="text/javascript" src="cordova-2.2.0.js"></script>
    <script type="text/javascript" src="childbrowser.js"></script> 
```

我的 js 调用看起来像：

```
onDeviceReady: function() {
    app.receivedEvent('deviceready');

    var link = document.getElementById('launchApple');
    console.log('derp?');

    if(link){
        //var cb = ChildBrowser.install();
        console.log("We're trying to add a click handler link");
        link.addEventListener('click', function() {
                              console.log('click');
                              window.plugins.childBrowser.openExternal('http://www.apple.com'); });
    }

}, 
```

当我单击链接时，我收到上述错误。

我尝试将 childbrowser.js 文件的大小写更改为 ChildBrowser.js。我试过在 iPhone 6 模拟器中运行它。我的插件文件夹包含从[https://github.com/alunny/ChildBrowser下载的包中的所有文件](https://github.com/alunny/ChildBrowser)

我已经从我的 ~/Library/Application Support 中清除了缓存我已经在项目上尝试过 Clean。

有什么想法吗？我即将开始寻找一只好山羊或一只鸡，以快速祭祀“一次编写，到处运行”的神（我相当肯定他们是骗子 Loki 的后裔）！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:52:01.757

好的，有几件事。一，个人“DERP！” 但其余的我归结为糟糕的文档和奇怪的实现。

在首页 ( [https://github.com/alunny/ChildBrowser](https://github.com/alunny/ChildBrowser) ) 上，文档中有一条注释`.openExternal()`说这是仅限 Android 的。这是我的“笨蛋！”

（我还没有弄清楚为什么有一个 onOpenExternal 的钩子，据说是 iOS 专用的......）

其次，扔掉所有告诉您添加 childbrowser.js 作为 ChildBrowser Plugins 项的字符串的文档。您的插件应如下所示：

```
<key>ChildBrowser</key>
<string>ChildBrowserCommand</string>
<key>ChildBrowserCommand</key>
<string>ChildBrowserCommand</string> 
```

这个问题的要点：

*   target="_blank" 适用于`<a>`iPhone 上的标签。
*   确保将 ChildBrowser（字符串）ChildBrowserCommand 项放在插件列表中，而**不是**childbrowser.js！
*   .openExternal() 不适**用于**iPhone（此时），但 .showWebPage() 可以（或者，如果您想要 iPhone 上的 openExternal() 功能，我想您可以在锚点上设置 target="_blank"标记，并且仅针对不支持它的平台（如 Android）使用 preventDefault()）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:04:36.803

在脚本之后将 childbrowser.js 添加到您的 HTML 文件中`cordova.js`，如下所示：

```
<script type="text/javascript" src="childbrowser.js"></script> 
```

# javascript - 设置要在函数中使用的变量

> ID：13463033
> 
> 赞同：0
> 
> 时间：2012-11-19T21:59:41.477
> 
> 标签：javascript, jquery

我有这样的功能：

```
var name_regex = /^[a-zA-Z0-9_ -]{3,32}$/,
body_regex = /^[a-zA-Z0-9_ -]$/,
email_regex = /^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,
phone_regex = /^[0-9-]{3,32}$/,
error_count;

function validation_test (name, value) {
    var test_name = name + '_regex';
    console.log(test_name);
    error_count = 0;
    if(!test_name.test(value)){
        error_count += 1;
    }
} 
```

如果我尝试运行它（提交时），我会收到以下错误：

**test_name.test 不是函数**

console.log(test_name) 为我提供了变量的正确名称（例如 name_regex）。我怎样才能使这个变量起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T22:05:17.460

只需使用一个对象：

```
var regexes = {
    name: /^[a-zA-Z0-9_ -]{3,32}$/,
    body: /^[a-zA-Z0-9_ -]$/,
    email: /^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,
    phone: /^[0-9-]{3,32}$/
};

function isValid(name, value) {
    return regexes[name].test(value);
} 
```

在您的其他代码中：

```
 if( !isValid( "phone", 123 ) ) {
       alert("Invalid phone");
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:05:30.357

变量 test_name 应该是正确的 regExp 对象[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)

考虑

```
...
function validation_test (name, value) {
    var test_name = name + '_regex';
    console.log(typeof(test_name)); // string
... 
```

由于控制台日志上方的行上的串联而发生

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T22:07:27.283

您是否尝试调用该函数，例如

```
validation_test('phone', '9184079201'); 
```

如果是这样，我建议将您的正则表达式放入一个对象中：

```
var regex = {
    'name':  '...',
    'body':  '...',
    'email': '...',
    'phone': '...',
};

function validation_test(name, value) {
    if(!regex[name].test(value)) {
        //...
    }
} 
```

这样你就可以通过字符串查找它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:05:37.147

`test_name`是一个字符串，而不是它所代表的正则表达式，所以`!test_name.test(value)`不会做你想做的事。

既然您没有`name`在函数中使用其他任何地方，为什么不直接将正则表达式作为参数传递呢？

```
function validation_test (test_name, value) {
    error_count = 0;
    if(!test_name.test(value)){
        error_count += 1;
    }
} 
```

# java - Tomcat 会话超时 web.xml

> ID：13463036
> 
> 赞同：14
> 
> 时间：2012-11-19T21:59:47.863
> 
> 标签：java, jsp, tomcat, web.xml, session-timeout

这是我的 web.xml 文件，它位于`WEB-INF/lib`. 它指定会话超时为 1 分钟，但它不会在 1 分钟的活动后让用户超时。

**`Web.xml`：**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
    <servlet>
        <servlet-name>Login</servlet-name>
        <servlet-class>Login</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>Login</servlet-name>
        <url-pattern>/Login</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>1</session-timeout>
    </session-config>
</web-app> 
```

`session.getMaxInactiveInterval()`我在我的 jsp 文件中使用了这一行，它输出了`1800`(30 minutes) 。有谁为什么它默认为 30 而不是使用我的 web.xml 文件中指定的时间？

编辑：

我在我的 jsp 页面上编写了检查会话属性的代码，如果它确实存在，则即使在页面刷新时用户也不会被重定向，一分钟后将用户重定向到登录页面。

```
if(session.getAttribute("username") != null){
                            out.println(session.getAttribute("username"));
                        }else{
                            response.setStatus(response.SC_MOVED_TEMPORARILY);
                            response.setHeader("Location", "index.jsp");
                        } 
```

编辑完整代码（Login.java）：

```
package com.labs.xmlgenerator.controller.managesession;

import java.io.IOException;
import java.sql.SQLException;
import java.util.HashMap;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.labs.xmlgenerator.model.dbconnection.*;
/**
 * Servlet implementation class Login
 */
@WebServlet(description = "Verifies Users Credentials", urlPatterns = { "/Login" })
public class Login extends HttpServlet {
    private static final long serialVersionUID = 1L;

    private DbLoginQueries query = new DbLoginQueries();

    /**
     * @see HttpServlet#HttpServlet()
     */
    /*
    public Login() {
        super();
        // TODO Auto-generated constructor stub
    }*/

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        try {
            validateLoginCredentials(request.getParameter("liUsr"),request.getParameter("liPwd"),request,response);
        } catch (ClassNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (SQLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

    private void validateLoginCredentials (String username, String password, HttpServletRequest request, HttpServletResponse response) throws IOException, ClassNotFoundException, SQLException{

        Boolean valid = true;
        int resultSize;
        HashMap<String, String> userDetails = null;
        HttpSession session = request.getSession(true);
        String location = "index.jsp";
        Cookie usernameErrorCookie;
        Cookie passwordErrorCookie;
        Cookie usernameCookie;

        if(username == null || username == ""){
            valid = false;
            usernameErrorCookie = new Cookie("liUsrErrCookie","Please enter a valid username");
            response.addCookie(usernameErrorCookie);
        }else{
            usernameCookie = new Cookie("liUsrCookie",username);
            response.addCookie(usernameCookie);
        }

        if(password == null || password == ""){
            valid = false;
            passwordErrorCookie = new Cookie("liPwdErrCookie","Please enter a valid password");
            response.addCookie(passwordErrorCookie);
        }

        if(valid == true){
            userDetails = query.loginQuery(username);
            resultSize = userDetails.size();
            if(resultSize < 4){
                valid = false;
                usernameErrorCookie = new Cookie("liUsrErrCookie","The username entered is not valid");
                response.addCookie(usernameErrorCookie);
            }
            else if(resultSize > 4){
                valid = false;
                usernameErrorCookie = new Cookie("liUsrErrCookie","The username is returning more than one result, please contact admin");
                response.addCookie(usernameErrorCookie);
            }
            else if(resultSize == 4){

                if(!userDetails.get("Password").equals(password)){
                    valid = false;
                    passwordErrorCookie = new Cookie("liPwdErrCookie","The entered password is incorrect");
                    response.addCookie(passwordErrorCookie);
                }
            }
        }

        if(valid == true){
            session.setAttribute("username", userDetails.get("Username"));
            session.setAttribute("permission", userDetails.get("AdminPermissions"));
            session.setAttribute("email", userDetails.get("Email"));
            location = "home.jsp";

        }else{
            location = "index.jsp#login";
        }

        response.setStatus(response.SC_MOVED_TEMPORARILY);
        response.setHeader("Location", location);

    }
} 
```

主页.jsp

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Home</title>
    <link rel="stylesheet" href="resources/css/Common.css" type="text/css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="resources/js/Common.js"></script>
</head>
<body>
    <header>
        <div id="actionsMenu">
            <ul id="actionLinks">
                <li><a class="linkButtons" id="userNameLink">
                                     <%
                        System.out.println(session.getMaxInactiveInterval());
                        if(session.getAttribute("username") != null){
                            out.println(session.getAttribute("username"));
                        }else{
                            out.println("no user");
                            /*
                            response.setStatus(response.SC_MOVED_TEMPORARILY);
                            response.setHeader("Location", "index.jsp");*/
                        }   
                    %>
                </a></li>
                <li><a class="linkButtons" href="Logout">Log Out</a></li>
                <li><a class="linkButtons"  href="#">Update</a></li>
            </ul>
        </div>
    </header>
    <nav class="tabs">
        <section id="generateSection">
            <h2 class="selectedTab" id="generateTab">
                <a id="gene" href="#generateXML">Generate XML</a>
            </h2>
            <div class="selectedContent" id="generateNav">
                <ul id="links">
                    <li><a class="navLink" href="#graphic">Graphic Interface</a></li>
                    <li><a class="navLink" href="#xml">XML Interface</a></li>
                </ul>
            </div>
        </section>
        <section id="adminSection">
            <h2 class="normalTab" id="adminTab">
                <a href="#admin">Admin</a>
            </h2>
            <div class="normalContent" id="adminNav">
                <ul id="links">
                    <li><a class="navLink" href="#images">Manage Images</a></li>
                    <li><a class="navLink" href="#keywords">Manage Keywords</a></li>
                    <li><a class="navLink" href="#users">Manage Users</a></li>
                </ul>
            </div>
        </section>
    </nav>  
    <div id="content">
        <noscript><p id="javascriptError">This website requires JavaScript to be enabled.</p></noscript>
    </div>
    <div id="updateUserDetails"></div>
    <div id="popup">
        <input type="button" value="X" id="exitButton">
        <p class="pageTitle" style="float:left; margin:0px;">Update Details</p>
        <form id="updateForm"  action="Update" onsubmit="return updateValidation()" method="post" >
            <p id="user">Username :</p>
            <p id="userNameUpdate"><%
                if(session.getAttribute("username") != null){
                    out.println(session.getAttribute("username"));
                }%></p>
            <p class="error" id="updCurrentPwdErr">
            <% 
                        Cookie[] currentPassEror = null;
                        currentPassEror = request.getCookies();
                        if(currentPassEror != null){
                            for(int i = 0; i < currentPassEror.length; i++){
                                 Cookie cookie = currentPassEror[i];
                                 if(cookie.getName().equals("updCurrentPwdErrCookie")){
                                     out.println(cookie.getValue());
                                     cookie.setMaxAge(0);
                                     response.addCookie(cookie);
                                 }
                             }
                        }
                        %>
            </p>
            <label for="updCurrentPwdLbl">Current Password :</label>
            <br />
            <input type="password" name="updCurrentPwd" id="updCurrentPwd">
            <br />
            <p class="error" id="updNewPwdErr">
            <% 
                        Cookie[] newPassCookies = null;
                        newPassCookies = request.getCookies();
                        if(newPassCookies != null){
                            for(int i = 0; i < newPassCookies.length; i++){
                                 Cookie cookie = newPassCookies[i];
                                 if(cookie.getName().equals("updNewPwdErrCookie")){
                                     out.println(cookie.getValue());
                                     cookie.setMaxAge(0);
                                     response.addCookie(cookie);
                                 }
                             }
                        }
            %></p>
            <label for="updNewPwdLbl">New Password :</label>
            <br />
            <input type="password" id="updNewPwd" name="updNewPwd">
            <br />
            <p class="error" id="updReNewPwdErr">
            <% 
                        Cookie[] reNewPassCookies = null;
                        reNewPassCookies = request.getCookies();
                        if(reNewPassCookies != null){
                            for(int i = 0; i < reNewPassCookies.length; i++){
                                 Cookie cookie = reNewPassCookies[i];
                                 if(cookie.getName().equals("updReNewPwdErrCookie")){
                                     out.println(cookie.getValue());
                                     cookie.setMaxAge(0);
                                     response.addCookie(cookie);
                                 }
                             }
                        }
            %>          
            </p>
            <label for="updReNewPwdLbl">Re-Enter New Password :</label>
            <br />
            <input type="password" id="updReNewPwd" name="updReNewPwd">
            <br />
            <p class="error" id="updEmailErr">
            <% 
                        Cookie[] emailErrCookies = null;
            emailErrCookies = request.getCookies();
                        if(emailErrCookies != null){
                            for(int i = 0; i < emailErrCookies.length; i++){
                                 Cookie cookie = emailErrCookies[i];
                                 if(cookie.getName().equals("updEmailErrCookie")){
                                     out.println(cookie.getValue());
                                     cookie.setMaxAge(0);
                                     response.addCookie(cookie);
                                 }
                             }
                        }
            %>
            </p>
            <label for="updEmailLbl">Email :</label>
            <br />
            <input type="text" id="updEmail" name="updEmail" value="<%
                    boolean foundEmailCookie = false;
                    Cookie[] emailCookies = null;
            emailCookies = request.getCookies();
                    if(emailCookies != null){
                        for(int i = 0; i < emailCookies.length; i++){
                             Cookie cookie = emailCookies[i];
                             if(cookie.getName().equals("updEmailCookie")){
                                 foundEmailCookie = true;
                                 out.println(cookie.getValue());
                                 cookie.setMaxAge(0);
                                 response.addCookie(cookie);
                             }
                         }
                    }
                    if(!foundEmailCookie){
                        if(session.getAttribute("email") != null){
                            out.println(session.getAttribute("email"));
                        }
                    }
            %>">
            <input type="hidden" id="updUrl" name="updUrl" value="">
            <br />
            <input type="submit" value="UPDATE">
        </form>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-12-19T14:40:15.760

会话超时层次结构：

*   TOMCAT_HOME/conf/web.xml
*   WebApplication/webapp/WEB-INF/web.xml
*   在 Java 中对会话超时进行硬编码：HttpSession.setMaxInactiveInterval(int)

会话超时配置的顺序：

`HttpSession.setMaxInactiveInterval(int) > $WebApplication/webapp/WEB-INF/web.xml`> $TOMCAT_HOME/conf/web.xml

每个后续条目都会覆盖上述配置。

此致。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-20T12:21:18.450

`web.xml`应该直接在，而`WEB-INF`不是在~~WEB-INF/库~~.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-19T22:35:04.500

1.  一分钟是一个非常低的会话超时。应该是几个*小时。*

2.  超时发生在那么多*不活动之后，*而不是那么多活动之后。

3.  正确的测试是`request.getSession(false) == null`或`request.getSession(true).isNew()`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-06T18:39:58.977

如果您的目标是测试会话到期，您根本不必等待。您的应用程序服务器可能会提供一种手动使会话过期的方式。例如`Tomcat`，您可以通过管理器应用程序执行此操作。每个应用程序旁边都有一个“过期会话”按钮，旁边有一个字段，您可以在其中指定空闲时间阈值。所有空闲时间超过阈值的会话都将失效。要使所有会话无效，只需输入`0`并按 Enter；无论`web.xml`.

如果您不使用 Tomcat，请查看应用程序服务器的文档，您可能会找到通过管理控制台或命令行执行此操作的方法。

# ruby-on-rails - Rails3，apache，乘客不工作。但是 rails2 应用程序在相同的环境中工作

> ID：13463037
> 
> 赞同：2
> 
> 时间：2012-11-19T21:59:51.573
> 
> 标签：ruby-on-rails, apache, passenger

环境：

*   OpenSUSE 11.4
*   阿帕奇 2.2.17
*   乘客 3.0.18
*   红宝石 1.8.7
*   导轨 3.2.8

我已经在 apache 下安装了 RoR 应用程序 - `ChiliProject`（但使用 rails 2.3.14）并且工作正常。

它安装`/chiliproject`在 httpd 配置中（实际上是在默认服务器中，因为我没有虚拟主机）我有“RailsBaseURI /chiliproject/public”。

现在，我需要开发自己的应用程序（网络开发的第一次经验）。

“rails new hello_world”，Webrick 工作正常，但我想用 CGI 在 apache 下运行它。我添加了“RailsBaseURI /hello_world/public”。但它不能正常工作。当我在索引页面上按“关于您的应用程序环境”时，它给了我 404“您要查找的页面不存在。”。对于 rails 中的任何路由，它都会给出错误 500 或 404。但是相同的路由和控制器可以在 webrick 上正常工作。即使我将 ChiliProject 放入 /hello_world 它也可以工作。这意味着问题不在于 apache 或乘客。

日志中没有 apache/passenger 错误，只有 404 或 500。我尝试了“rails *2.4.13* new hello_world”，但它给了我很多错误，简单的谷歌搜索并不能解决所有这些错误。因此，我无法轻松地使用 rails 2.4.13 创建一个新项目，该项目可与另一个应用程序一起正常工作，我认为它无济于事。

我在 ruby​​ 网站上读到 1.8.7 可能会导致 rails3 崩溃。之后，我花了 4 个小时研究 RVM 和不同的 ruby​​ 版本。毕竟，ChiliProject（甚至是最新版本）不适用于 ruby​​ 1.9，我最初的问题并没有消失。现在我把所有东西都回来了（来自发行版的 repo 的 ruby​​ 1.8.7，没有 RVM）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T22:34:00.113

如果您的 webbrick 可以正常工作，请对您的 apache 配置文件进行重大更改。

我使用 bitnami RubyStack 和下面的配置没有任何问题：

```
<VirtualHost *:80>
    ServerName www.myhostname.com
    DocumentRoot /home/bitnami/app_name/public  
    RailsEnv development
    <Directory /home/bitnami/app_name/public>
        Allow from all
        Options -MultiViews
    </Directory>
</VirtualHost> 
```

我的乘客版本：

```
:~$sudo passenger-config --root
/opt/bitnami/ruby/lib/ruby/gems/1.9.1/gems/passenger-3.0.17 
```

请检查乘客是否正在运行：

```
:~$sudo passenger-status

----------- General information -----------
max      = 6
count    = 2
active   = 0
inactive = 2
Waiting on global queue: 0

----------- Application groups -----------
/home/bitnami/app_1:
  App root: /home/bitnami/app_1
  * PID: 4972    Sessions: 0    Processed: 24      Uptime: 33h 38m 14s

/home/bitnami/app_2:
  App root: /home/bitnami/app_2
  * PID: 24538   Sessions: 0    Processed: 1682    Uptime: 296h 14m 44s 
```

# iphone - 委托函数 audioPlayerDidFinishPlaying 每次都不会触发

> ID：13463041
> 
> 赞同：0
> 
> 时间：2012-11-19T22:00:06.270
> 
> 标签：iphone, xcode, ipad, avaudioplayer

我有类似应用程序的键盘，并且我将每个新的 AVAudioPlayer 添加到 NSMutableArray 以便我可以叠加声音。我的问题是，那个 delagate 函数

```
-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag 
```

如果在短时间内有击键，则不会触发。例如，如果我以 0.5 秒或更长时间的间隔进行中风，一切正常。知道为什么吗？当他的声音播放完成时，我想释放内存并从数组中删除对象。

**更新**

。H

```
@interface .. <AVAudioPlayerDelegate>
{
    NSMutableArray *soundObjects;
}

@property (nonatomic,strong) AVAudioPlayer *audioPlayer; 
```

.m

```
-(void)playSound {

    //
    //  play sound
    //

    _audioPlayer = [self loadWav:_soundID];
    _audioPlayer.delegate = self;

    [soundObjects addObject:_audioPlayer];
    AVAudioPlayer *temp = [soundObjects objectAtIndex:soundIndex];
    soundIndex = [soundObjects count];
    [temp play];
}

-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
#ifdef DEBUG_SOUND
        NSLog(@"FLAG");
        soundIndex--;
        [soundObjects removeObjectAtIndex:soundIndex];
#endif
}

- (AVAudioPlayer *)loadWav:(NSString *)filename {
    NSURL * url = [[NSBundle mainBundle] URLForResource:filename withExtension:@"mp3"];
    NSError * error;

    AVAudioPlayer * player = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];

    if (!player) {
#ifdef DEBUG_MODE
        NSLog(@"Error loading %@: %@", url, error.localizedDescription);
#endif
    } else {
        [player prepareToPlay];
    }
    return player;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T03:28:11.937

尝试在后台进程中触发播放。这是我第一次讨论这个问题，在不知道更多细节的情况下，我只能推测你是如何演奏这些声音的。如果您在主线程上播放声音，那么也在主线程上的键盘将无响应，而声音正在被缓冲并被触发以在同一线程上播放。在处理媒体时，您通常应该加载它并从主线程播放它，以消除竞争条件的可能性。如果加载图像是歌曲或电影，它通常不应该在主线程上，因为 UI 将无响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T03:24:34.270

开发人员文档中有几个 NSQueue 示例作为一个快速示例，我将使用我自己的作品整理的 Obj C 食谱书中的改编。

```
//This method detatches the instruction from the main thread
-(void)keyStrokeSelector:(NSString*)objectSound{

       [NSThread detachNewThreadSelector:@selector(keyStroke:objectSound)
                                toTarget:self
                              withObject:nil];

 }

//this selector will acctually execute the task
-(void)keyStroke:(NSString *)objectSound
{
   @autoreleasepool {
      //code to play the sound
   }
} 
```

我希望这个对你有用。关于上述代码的一些注意事项：您必须为每个单独的线程使用自动释放池，否则引用计数（MRC 或 ARC）将不起作用，因为它只能在自动释放池中工作，发生在主线程之外的线程中的代码应该被编码像其他任何东西一样，它只会执行并运行到完成。如果您在子线程中有无限循环，则在测试您的应用程序时可能不明显，但是如果我正确记住了后台线程的当前最大时间，操作系统将在十分钟后终止应用程序。更重要的是，如果您不创建特定于线程的@autoreleasepool，那么即使您没有在新线程中创建新对象，您的对象也不会被释放并且会占用内存，我对此怎么强调都不为过，

我希望这会有所帮助，祝你的程序好运

# sql-server - 为搜索功能创建 LINQ 查询

> ID：13463044
> 
> 赞同：1
> 
> 时间：2012-11-19T22:00:25.147
> 
> 标签：sql-server, linq-to-entities

我的应用程序中有搜索功能。它的工作方式是，用户拉出一条记录，然后使用搜索按钮将记录中的名字、姓氏和出生日期传递给 LINQ 查询。LINQ 查询应该提供可能的匹配项。现在它提供了太多的结果。我希望出生日期匹配准确，然后名字和姓氏匹配可能有点松散。在一个完美的世界中，结果将是：

1.  与 DOB 完全匹配
2.  模糊匹配名字
3.  接近但不严格匹配姓氏。

例如，如果我要搜索 1974 年 11 月 27 日出生的 James May，我希望得到如下结果：

吉姆 1974 年 11月 27 日
杰克 1974 年 11 月 27 日 詹姆斯 梅福德 1974 年 11 月 27 日

我知道最好的方法是存储过程，但我试过了，每次我将存储的 Proc 添加到我的项目中时，它都会损坏 EDMX 文件，所以我坚持使用 LINQ。

这是我到目前为止所拥有的：

```
 var query = from p in _Elig_DB.PersonAttributes.ToList()
                    where   p.getDateOfBirth == DOB &&
                                    p.FirstName.Contains(FName) || p.FirstName.StartsWith(FName) &&
                                    p.LastName.Contains(LName) || p.LastName.StartsWith(LName)

                    select p; 
```

这给出了这样的结果：

```
Ileana   May         10/30/1967
Kristina May         4/23/1971
margaret Mayberry    7/26/1942
Karla    Mayorga     5/14/1986
Stan     Mayer       3/8/1952
Lori     Maynard     7/22/1965 
```

所以姓是好的，但出生日期不应该那样变化。感谢您的阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:08:22.943

只需修正括号。

```
 var query = from p in _Elig_DB.PersonAttributes.ToList()
                where   p.getDateOfBirth == DOB &&
                                (p.FirstName.Contains(FName) || p.FirstName.StartsWith(FName) &&
                                p.LastName.Contains(LName) || p.LastName.StartsWith(LName))

                select p; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T10:11:44.840

抱歉，我还不能添加评论，但想补充一点，从数据库中获取数据时，您的查询没有使用 where 过滤器。

目前，以下 sql 或等效语句将在您的数据库上执行。

```
select * _Elig_DB.PersonAttributes 
```

表中的所有行都将更新为实体对象。只有这样，您语句的 where 部分才会针对实体执行并忽略不需要的结果。

我假设这是无意的，您宁愿优化初始查询。

发生这种情况的原因是您的 linq 语句的 from 部分有一个 .ToList() 语句。tolist 语句强制查询立即执行并构建对象列表。

如果您将您的声明更改为（不带tolist）：

```
var query = from p in _Elig_DB.PersonAttributes
            where   p.getDateOfBirth == DOB &&
                            (p.FirstName.Contains(FName) || p.FirstName.StartsWith(FName) &&
                            p.LastName.Contains(LName) || p.LastName.StartsWith(LName))

            select p; 
```

此时您的查询尚未获取任何数据。（注意显式 var 查询类型是 Queryable）现在您可以执行完整的查询，只获取您需要的数据库行。

```
var results = query.ToList(); 
```

# c++ - C ++如何从具有不同返回类型的接口多重继承？

> ID：13463048
> 
> 赞同：9
> 
> 时间：2012-11-19T22:00:31.917
> 
> 标签：c++, visual-studio-2012, multiple-inheritance

也许我有两个具有相同函数名称和参数但返回值不同的接口：

```
struct A { virtual void foo() = 0; };
struct B { virtual int foo() = 0; }; 
```

如何定义继承此接口的 C 类（如果可能的话）？例如，我编写了一些未编译的伪代码：

```
// this code is fake, it doesn't compiled!!
struct C : A, B
{
    // how to tell compiler what method using if referenced from C?
    using void foo();  // incorrect in VS 2012
    // and override A::foo() and B::foo()?
    virtual void foo() { std::cout << "void C::foo();\n"; } // incorrect
    virtual int foo() { std::cout << "int C::foo();\n"; return 0; } // incorrect
 }
 // ... for use in code
 C c;
 A &a = c;
 B &b = c;
 c.foo();     // call void C::foo() when reference from C instance
 a.foo();     // call void C::foo() when reference from A instance
 b.foo();     // call int C::foo() when reference from B instance 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:10:34.480

这是不可能的，但不是因为多重继承。由于`foo`in class的无效重载而产生歧义`C`。您不能同时拥有两者`int foo()`，并且`void foo()`由于返回类型不是函数签名的一部分，因此编译器将无法解析对`foo`. 您可以将您的接口视为`A`和`B`类的联合，因此从逻辑上讲，问题在实际继承之前就已经存在。由于从编译器的角度来看`A`，并且`B`是 2 种不同且不相关的类型，因此在编译它们时没有问题，并且错误会延迟到 class 中的实际统一点`C`。

在此处查看有关函数签名和重载的更多信息：[返回类型是函数签名的一部分吗？](https://stackoverflow.com/questions/290038/is-the-return-type-part-of-the-function-signature)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T22:24:46.490

您*可以*做的是将所有共享的东西放入一个`virtual`基础中，例如`C_base`并覆盖辅助类中的冲突`virtual`函数。由于共享的东西`C`很容易获得，`C_base`因此本质上就像最衍生的`C`. 最后，你`C`上课只是因为班级把事情放在一起：

```
struct A { virtual void foo() = 0; };
struct B { virtual int foo() = 0; };

struct C_base { int all_data; };

struct A_aux: virtual C_base, A {
    void foo() { std::cout << "A_aux::foo()\n"; }
};

struct B_aux: virtual C_base, B {
    int foo() { std::cout << "B_aux::foo()\n"; return 0; }
};

struct C : A_aux, B_aux
{
    using A_aux::foo;
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-19T22:26:39.457

您可以明确限定。

```
class C : A, B {
public:
    void A::foo() { ... }
    int B::foo() { ... }
}; 
```

编辑：

This appears to be an MSVC extension, rather than Standard.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T22:23:39.003

无法使用相同的签名覆盖虚函数的返回类型（正如@icepack 的回答所解释的那样）。

另一种方法可能是使用模板基类声明`foo()`返回类型指定为模板参数，并提供具体返回参数类型的特化。

这将是对@Dietmar Kühl 提议的概括。

# d3.js - 冷静力布局的初始刻度

> ID：13463053
> 
> 赞同：49
> 
> 时间：2012-11-19T22:00:47.407
> 
> 标签：d3.js, force-layout

我刚刚开始涉足 d3，发现学习曲线相当陡峭。这个过程与我习惯的完全不同，数学大部分都超出了我的想象。

无论如何，我的项目包括一个代表系统之间集成图的力布局。这部分效果非常好，但我确实有一个主要问题，这也体现在 Michael Bostocks 网站上的力导向布局演示中：当节点启动时，它们似乎是在画布之外渲染的。在此之后，一些严肃的物理数学正在接管，模拟引力，它将节点在相当混乱的路径上来回发送，直到它们平静下来并定居在一些随机坐标上。尽管这些动作在第一次运行演示时非常酷，但是当您尝试从公司管理员的角度查看网络接口的状态并且服务器不会保持静止时，一段时间后就会变得厌烦。

我确信我有这个项目的正确布局设置，因为我确实希望服务器自动布局，我确实希望可视化它们之间的链接。然而，我对引力效应持矛盾态度。

我想知道; 是否可以手动设置每个节点的初始位置，以便我可以将它们靠近重心并缩短“反弹时间”？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-10-04T08:14:29.967

以上所有答案都误解了Øystein Amundsen的问题。

稳定启动力的唯一方法是设置 node.x 和 node.ya 适当的值。请注意，节点是 d3.js 的数据，而不是表示的 DOM 类型。

例如，如果您加载

```
nodes = [{"id": a}, {"id": b}, {"id": c}] 
```

进入

```
d3.layout.force().nodes(nodes) 
```

您必须设置节点数组中所有元素的所有 .x 和 .y ，它将像这样（在 coffeescript 中）

```
nodes = [{"id": a}, {"id": b}, {"id": c}]
for i in [0..2]
  nodes[i].x = 500 #the initial x position of node
  nodes[i].y = 300 #the initial y position of node
d3.layout.force().nodes(nodes).links(links) 
```

那么节点将在 force.start() 时的位置开始。这样可以避免混乱。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-11-20T00:29:04.037

`tick()`在内部，在“正常”使用情况下，强制布局反复异步调用自己的方法（通过 a`setInterval`或`requestAnimationFrame`），直到布局确定解决方案。此时，它的`alpha()`值等于或接近 0。

因此，如果您想通过此解决方案过程“快进”，您可以`tick()`一遍又一遍地同步调用该方法，直到布局的 alpha 达到一个值，对于您的特定要求，构成一个“足够接近”的解决方案。像这样：

```
var force = d3.layout.force(),
    safety = 0;
while(force.alpha() > 0.05) { // You'll want to try out different, "small" values for this
    force.tick();
    if(safety++ > 500) {
      break;// Avoids infinite looping in case this solution was a bad idea
    }
}

if(safety < 500) {
  console.log('success??');
} 
```

此代码运行后，您可以根据节点的状态绘制布局。或者，如果您通过绑定到 tick 事件（即 ）来绘制布局，则您需要在此代码运行**后**`force.on('tick', drawMyLayout)`进行绑定，否则您将在循环期间不必要地同步渲染布局数百次。**`while`**

 **JohnS 将这种方法归结为一个简洁的函数。在此页面的某处查看他的答案。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-11-21T14:40:11.070

不久前我处理过类似的事情。有几件事需要考虑。

1) 迭代滴答正在模拟一个达到平衡的系统。因此，在系统稳定并且您拥有自动布局之前，无法避免根据需要多次调用 tick。也就是说，您不需要在每个滴答声中都更新您的可视化来让模拟工作！事实上，如果你不这样做，迭代会快得多。我的代码的相关部分是：

```
var iters = 600; // You can get decent results from 300 if you are pressed for time
var thresh = 0.001;
if(!hasCachedLayout || optionsChanged || minorOptionsChanged) {
    force.start(); // Defaults to alpha = 0.1
    if(hasCachedLayout) {
        force.alpha(optionsChanged ? 0.1 : 0.01);
    }
    for (var i = iters; i > 0; --i) {
        force.tick();
        if(force.alpha() < thresh) {
            //console.log("Reached " + force.alpha() + " for " + data.nodes.length + " node chart after " + (iters - i) + " ticks.");
            break;
        }
    }
    force.stop();
} 
```

它同步运行，运行后我为所有节点和链接创建 dom 元素。对于小图，这运行得非常快，但是您会发现对于较大的图（100 多个节点）会有延迟——它们的计算成本要高得多。

2）您可以缓存/种子布局。*如果没有设置位置*，力布局将在初始化时均匀分布节点！因此，如果您确保您的节点设置了 x 和 y 属性，这些将被使用。特别是当我更新现有图表时，我将重新使用以前布局中的 x 和 y 位置。

您会发现，有了良好的初始布局，您将需要*更少*的迭代来达到稳定的配置。（这是上面代码中 hasCachedLayout 跟踪的内容）。注意：如果你在相同的布局中重复使用相同的节点，那么你还必须确保将 px 和 py 设置为 NaN，否则你会得到奇怪的结果。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-05-03T02:29:48.247

根据其他答案，我制作了这种方法：

```
function forwardAlpha(layout, alpha, max) {
  alpha = alpha || 0;
  max = max || 1000;
  var i = 0;
  while(layout.alpha() > alpha && i++ < max) layout.tick();
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-03-18T09:22:00.907

也许`force.friction(0.5)`，或低于默认 0.9 的其他数字，会有帮助吗？至少它在页面加载时给人的印象不那么混乱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-29T01:22:09.947

```
 var width = 960,
	  height = 500;

	var fill = d3.scale.category20();

	var force = d3.layout.force()
	  .size([width, height])
	  .nodes([{}]) // initialize with a single node
	  .linkDistance(30)
	  .charge(-60)
	  .on("tick", tick);

	var svg = d3.select("body").append("svg")
	  .attr("width", width)
	  .attr("height", height)
	  .on("mousedown", mousedown);

	svg.append("rect")
	  .attr("width", width)
	  .attr("height", height);

	var nodes = force.nodes(),
	  links = force.links(),
	  node = svg.selectAll(".node"),
	  link = svg.selectAll(".link");

	 // var cursor = svg.append("circle")
	 //     .attr("r", 30)
	 //     .attr("transform", "translate(-100,-100)")
	 //     .attr("class", "cursor");

	restart();

	function mousedown() {
	  var point = d3.mouse(this),
	    node = {
	      x: width / 2,
	      y: height / 2,
	      "number": Math.floor(Math.random() * 100)
	    },
	    n = nodes.push(node);

	  // add links to any nearby nodes
	  /*  nodes.forEach(function(target) {
		    var x = target.x - node.x,
		        y = target.y - node.y;
		    if (Math.sqrt(x * x + y * y) < 30) {
		      links.push({source: node, target: target});
		    }
		  });
		*/
	  restart();
	}

	function tick() {
	  link.attr("x1", function(d) {
	      return d.source.x;
	    })
	    .attr("y1", function(d) {
	      return d.source.y;
	    })
	    .attr("x2", function(d) {
	      return d.target.x;
	    })
	    .attr("y2", function(d) {
	      return d.target.y;
	    });

	  node.attr("transform", function(d) {
	    return "translate(" + d.x + "," + d.y + ")";
	  });
	}

	function restart() {
	  link = link.data(links);

	  link.enter().insert("line", ".node")
	    .attr("class", "link");

	  node = node.data(nodes);

	  // node.enter().insert("circle", ".cursor")
	  //     .attr("class", "node")
	  //     .attr("r", 5)
	  //     .call(force.drag);

	  var nodeEnter = node.enter().insert("svg:g", ".cursor")
	    .attr("class", "node")
	    .call(force.drag);

	  nodeEnter.append("svg:circle")
	    .attr("r", 5)

	  nodeEnter.append("svg:text")
	    .attr("class", "textClass")
	    .attr("x", 14)
	    .attr("y", ".31em")
	    .text(function(d) {
	      return d.number;
	    });

	  force.start();
	}
```

```
 rect {
	  fill: none;
	  pointer-events: all;
	}
	.node {
	  fill: #000;
	}
	.cursor {
	  fill: none;
	  stroke: brown;
	  pointer-events: none;
	}
	.link {
	  stroke: #999;
	}
	.textClass {
	  stroke: #323232;
	  font-family: "Lucida Grande", "Droid Sans", Arial, Helvetica, sans-serif;
	  font-weight: normal;
	  stroke-width: .5;
	  font-size: 14px;
	} 
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
```

您可能正在寻找的示例。它在将新节点插入布局之前设置新节点的 x 和 y 属性。所需位置是 svg 元素的中心。**

# r - igraph read.graph 添加一个顶点

> ID：13463055
> 
> 赞同：4
> 
> 时间：2012-11-19T22:01:00.680
> 
> 标签：r, igraph

当我运行这个简单的例子时，igraph 添加了一个顶点，我的顶点从 2 开始而不是 1

```
# very very simple graph (1-2-3)
edges <- rbind(c(1,2), c(2,3))

write.table(edges, file="edgetest.txt", sep=" ", quote=F, row.names=F, col.names = F)
g <- simplify(read.graph(file="edgetest.txt", format="edgelist", directed=F))
plot(g) 
```

这是运行示例后的样子

![在此处输入图像描述](../Images/1341e7a00583d37d4f2da4db5e8394af.png)

有人知道为什么会这样吗？这可以吗还是我错过了什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T04:38:03.887

`read.edgelist()`需要一个文本文件，其中顶点 id 从零开始。如果要将矩阵中的边列表写入文件，请减去 1：

```
write.table(edges-1, file="edgetest.txt", sep=" ", 
            quote=F, row.names=F, col.names = F) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:13:49.993

我认为您通过写出文本并回读来引入一些错误。您可以这样做：

```
edges <- rbind(c(1,2), c(2,3))
g <- graph.edgelist(edges)
plot(g) 
```

# batch-file - 使用批处理文件替换 Javascript 代码？

> ID：13463056
> 
> 赞同：0
> 
> 时间：2012-11-19T22:01:04.427
> 
> 标签：batch-file

有没有办法使用批处理文件进行 JavaScript 代码查找和替换。这是一个例子：

寻找：`<script type="text/javascript" src="http://www.mega.edu/Course/WebCTfooter/footer.js">Footer</script>`

代替：`<script type="text/javascript" src="http://www.mega.edu/Course/WebCTfooter/footer_ungrad.js">Footer</script>`

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T13:34:20.540

由于您可以使用 python，我建议使用 python 程序而不是批处理文件，可能是这样的：

```
#!/usr/bin/python

import shutil
import sys
import re

for path in sys.argv[1:]:
    print "processing " + path
    infile = open(path,'r')
    tmpfile = open(path+'.tmp','w')

    # make the replacements
    for line in infile:
        line = re.sub("/footer.js","/footer_ungrad.js",line)
        line = re.sub("/header.js","/header_ungrad.js",line)
        line = re.sub("/sample.js","/sample_ungrad.js",line)
        tmpfile.write(line)

    infile.close()
    tmpfile.close()

    # now move it back to the original file
    shutil.move(path+'.tmp',path) 
```

用 python 2.4 测试。

# php - Mod_Rewrite 和 REQUEST_URI 漏斗

> ID：13463057
> 
> 赞同：1
> 
> 时间：2012-11-19T22:01:19.993
> 
> 标签：php, apache, mod-rewrite

我想为我的网站使用*前端控制器*设计模式，所以我想将所有内容都指向，比如说`index.php`.

在里面`index.php`我想把它`REQUEST_URI`分成不同的东西，然后从那里决定下一步该做什么。

我怎样才能写我`.htaccess`的来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:02:56.373

Wordpress 正是这样做的：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
</IfModule> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:06:38.297

如果您运行的是 Apache 2.2.17 或更高版本，我建议您使用[`FallbackResource`](http://httpd.apache.org/docs/trunk/mod/mod_dir.html#fallbackresource). 我发现在这些情况下它会稍微快一些，即前端控制器。

# iphone - 设置 4 个 UIButtons 来呼叫号码 XCode

> ID：13463059
> 
> 赞同：0
> 
> 时间：2012-11-19T22:01:25.127
> 
> 标签：iphone, xcode

我有前 4 个 ImageView，下面有 4 个 UIButton，因此用户可以更改背景图片。这完美无缺。但是后来我在 ImageViews 上有 4 个 UIButtons 应该拨打电话号码。当我运行它时，它似乎没有调用该按钮，因为当我单击它时没有任何反应。这是我的代码：

```
#import "ViewController.h"

@interface ViewController ()
{
UIImagePickerController *imagePickerController;
UIImagePickerController *imagePickerController2;
UIImagePickerController *imagePickerController3;
UIImagePickerController *imagePickerController4;
}

@end

@implementation ViewController
@synthesize firstImageView, secondImageView, thirdImageView, fourthImageView;
- (void)viewDidLoad
{
[super viewDidLoad];

}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];

}

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
UIImage *image1 = [info objectForKey:UIImagePickerControllerOriginalImage];

NSData *data = UIImagePNGRepresentation(image1);
NSString *myGrabbedImage = @"myGrabbedImage.png";
NSArray *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentDirectory = [path objectAtIndex:0];
NSString *fullPathToFile = [documentDirectory stringByAppendingPathComponent:myGrabbedImage];

[data writeToFile:fullPathToFile atomically:YES];

if (picker == imagePickerController) {
    [[self firstImageView]setImage:image1];
} else if (picker == imagePickerController2) {
    [[self secondImageView]setImage:image1];
} else if (picker == imagePickerController3) {
    [[self thirdImageView]setImage:image1];
} else {
    [[self fourthImageView]setImage:image1];
}

[self dismissViewControllerAnimated:YES completion:nil];

}

- (IBAction)firstChangeButton:(id)sender
{
imagePickerController = [[UIImagePickerController alloc]init];
[imagePickerController setDelegate:self];
[imagePickerController setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
[self presentViewController:imagePickerController animated:YES completion:nil];

}
- (IBAction)secondChangeButton:(id)sender
{
imagePickerController2 = [[UIImagePickerController alloc]init];
[imagePickerController2 setDelegate:self];
[imagePickerController2 setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
[self presentViewController:imagePickerController2 animated:YES completion:nil];

}
- (IBAction)thirdChangeButton:(id)sender
{
imagePickerController3 = [[UIImagePickerController alloc]init];
[imagePickerController3 setDelegate:self];
[imagePickerController3 setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
[self presentViewController:imagePickerController3 animated:YES completion:nil];

}
- (IBAction)fourthChangeButton:(id)sender
{
imagePickerController4 = [[UIImagePickerController alloc]init];
[imagePickerController4 setDelegate:self];
[imagePickerController4 setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
[self presentViewController:imagePickerController4 animated:YES completion:nil];

}

- (IBAction)callFirst:(id)sender
{
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:0739421700"]];
}

- (IBAction)callSecond:(id)sender
{
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:073942100"]];
}

- (IBAction)callThird:(id)sender
{
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:0739421700"]];
}

- (IBAction)callFourth:(id)sender
{
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:0739421700"]];

}
@end 
```

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:06:33.210

我将假设您正在 iOS 模拟器上对此进行测试，但这是行不通的。此代码仅适用于真正的 iOS 设备。

# c++ - 可通过位图拖动的 C++ 窗口

> ID：13463063
> 
> 赞同：0
> 
> 时间：2012-11-19T22:01:45.143
> 
> 标签：c++, winapi, visual-studio-2012

我正在用 C++ 开发一个自定义窗口边框，我想就是这样。我不知道我是否以正确的方式执行此操作，但我希望知道如何通过位图制作可拖动的窗口。

我在photoshop中制作了一个位图栏并添加到客户区，我希望能够仅通过位图拖动它。目前，您可以使用以下代码将其拖动到客户区的任何位置：

```
case WM_NCHITTEST: {
    LRESULT hit = DefWindowProc(hWnd, message, wParam, lParam);
    if(hit == HTCLIENT) hit = HTCAPTION;
    return hit;
    }
    break; 
```

我在绘画部分使用此代码绘制了位图：

```
DrawBitmap(hdc,"header-bar-1.bmp", 2, 4); 
```

它看起来像这样：

![窗户](../Images/716bdfb3a22ab0d62044843553e64691.png)

您可以看到顶部的栏，这是我希望能够拖动它的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:26:41.433

我还没有尝试过，但类似的东西应该可以工作：

1.  声明一个名为 eg 的布尔值`isDragging`并将其设置为 false。
2.  在 的处理程序中`WM_LBUTTONDOWN`，如果`isDragging`为 false 并且鼠标在位图栏上（使用`PtInRect`），设置`isDragging`为 true，并通过调用将光标限制在位图的矩形中`ClipCursor`。保存光标相对于窗口左上角的位置。
3.  在 的处理程序中`WM_MOUSEMOVE`，如果`isDragging`为真，则移动窗口（调用`MoveWindow`或`SetWindowPos`）以恢复其相对于光标的位置。
4.  在 的处理程序中`WM_LBUTTONUP`，如果`isDragging`为真，则将其设置为假，并通过`ClipCursor`适当的调用释放光标。

（始终考虑客户端坐标和屏幕坐标之间的差异。）

# jquery - javascript滚动滞后 - Chrome

> ID：13463064
> 
> 赞同：2
> 
> 时间：2012-11-19T22:01:49.683
> 
> 标签：jquery, google-chrome, scroll, lag, parallax

我正在尝试在用户滚动时更改背景位置和顶部属性。我想模拟精灵的背景和视差的固定位置，所以我做了以下事情：

**HTML 部分**

```
<section id="first" data-type="background" data-speed="1">
    <div id="sprite1" data-type="sprite" data-speed="-1.5"></div>
    <div id="sprite2" data-type="sprite" data-speed="-1"></div>
</section>
<section id="second" data-type="background" data-speed="1">

</section> 
```

**CSS 部分**

```
section {
    width: 100%;
    height: 1000px;
    position: relative;
}

#first {
   background: url('../img/bg1.png'), no-repeat, fixed, 50% 0;
}

#second {
    background: url('../img/bg2.png'), no-repeat, fixed, 50% 0;
}

#sprite1 {
    position: relative;
    background: url('../img/sprite1.png'), no-repeat, fixed, 50% 0;
    width: 100px;
    height: 100px;
    top: 550px;
    left: 100px;
}

#sprite2 {
    position: relative;
    background: url('../img/sprite2.png'), no-repeat, fixed, 50% 0;
    width: 200px;
    height: 200px;
    top: 650px;
    left: 150px;
} 
```

**JS部分**

```
$(document).ready(function() {

    /* Initialisation */
    var $window = $(window);

    var offset = 0;
    $('section[data-type="background"]').each(function(index) {
        var $this = $(this);
        console.log($this);
        $this.data('data', {
            height: $this.height() + offset,
            speed: parseFloat($this.attr('data-speed'))
        });
        offset = $this.data('data').height;
    });

    $('div[data-type="sprite"]').each(function(index) {
        var $this = $(this);
        $this.data('data', {
                xPosition: parseInt($this.css('top').replace(/px/, '')),
            yPosition: parseInt($this.css('left').replace(/px/, '')),
            speed: parseFloat($this.attr('data-speed'))
        });
        console.log($this.data('data'));
    });

    $('#first').data('position', '0');
    $(window).scroll(function(){
        console.log($(this));
        var scrollPos = parseInt($window.scrollTop());
        $('section[data-type="background"]').each(function(index) {
            var $this = $(this);
            $this.css('background-position', '50% ' + (scrollPos / $this.data('speed') + $this.data('data').height) + 'px');
        });
        $('div[data-type="sprite"]').each(function(index) {
            var $this = $(this);
            $this.css('top', ((scrollPos / $this.data('data').speed) + $this.data('data').xPosition) + 'px');
        });
    });

}); 
```

你可以在[这里看到结果](http://pcreations.fr/labs/)

在 Firefox 上没有问题，背景似乎是固定的，但在 Chrome 上，浏览器似乎从滚动页面开始，然后执行代码。所以它在 Chrome 上完全被吓到了......有没有办法在页面滚动之前强制执行代码？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:07:28.047

我不确定您在滚动动画中指的是什么，我只是猜测。您可以开始使用 $.animate() 而不是使用 $.css() 来使过渡更平滑。我也在 IE 中检查了这一点，它似乎也这样做了。当使用 $.animate() 而不是 $.css 时，可能会在多个浏览器中以不同方式注册的 $.scroll() 可能会被平滑掉。

# django-templates - 模型级 Django 模板的问题

> ID：13463066
> 
> 赞同：0
> 
> 时间：2012-11-19T22:01:53.267
> 
> 标签：django-templates

我正在尝试自定义模型的“编辑”模板以输出纯文本值而不是表单字段。我按照 Django 文档中的说明进行了搜索，但没有任何运气。

我试图覆盖的模板是 change_form.html，由于某种原因，我无法覆盖应用级或模型级模板。我可以在项目级别覆盖，但是，这不是解决方案。我在 settings.py 中的 TEMPLATE_DIRS 中确实有该目录。我的模板路径如下所示：templates/admin/app/model/change_form.html（是的，我使用的是小写的模型名称。）

作为一种解决方法，我目前正在向 urls.py 添加一些内容以使用特定模板。不过，我更喜欢使用内置逻辑。建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:33:34.033

没关系，我只是忘记了我为我的模型指定了不同的 app_label。因此，模板没有被覆盖，从应用程序级别开始。我在模板路径中更改了应用程序目录名称，它可以工作。

# css - CSS font-face 在 Firefox 中不起作用

> ID：13463072
> 
> 赞同：3
> 
> 时间：2012-11-19T22:02:16.623
> 
> 标签：css, firefox, font-face

我在下面有这个字体代码，它在谷歌浏览器中运行良好，但在 Firefox 中根本不起作用？为什么？

```
 <style type="text/css">
    @font-face {
    font-family: 'Lato';
    src: url('http://www.website.com/fonts/ca/Lato-Reg-webfont.eot');
    src: url('http://www.website.com/fonts/ca/Lato-Reg.ttf') format('truetype'),
         url('http://www.website.com/fonts/ca/Lato-Reg-webfont.eot?#iefix') format('embedded-opentype'),
         url('http://www.website.com/fonts/ca/Lato-Reg-webfont.woff') format('woff'),
         url('http://www.website.com/fonts/ca/Lato-Reg-webfont.svg#LatoRegular') format('svg');
    font-weight: normal;
    font-style: normal;
}
@font-face {
    font-family: 'LatoBold';
    src: url('http://www.website.com/fonts/ca/Lato-Bol-webfont.eot');
    src: url('http://www.website.com/fonts/ca/Lato-Bol.ttf') format('truetype'),
         url('http://www.website.com/fonts/ca/Lato-Bol-webfont.eot?#iefix') format('embedded-opentype'),
         url('http://www.website.com/fonts/ca/Lato-Bol-webfont.woff') format('woff'),
         url('http://www.website.com/fonts/ca/Lato-Bol-webfont.svg#LatoBold') format('svg');
    font-weight: normal;
    font-style: normal;
}

nav ul li{
    font-family: 'LatoBold', sans-serif !important;
}
    </style>

 <nav id="mainNav">
            <ul class="grid_0">
                            <li>
                        <a href="http://www.website.com">Home</a>
                        </li></ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T09:13:27.297

看来您的字体链接已损坏。如果我可以建议您，请使用[google web fonts](http://www.google.com/webfonts)。有许多字体可用于您的网站，易于使用且免费。Lato's Font 也在那里。

在此处查看我的演示：http: [//jsfiddle.net/ongisnade/Nx5VR/](http://jsfiddle.net/ongisnade/Nx5VR/)

下面的CSS规则

```
@font-face {
  font-family: 'LatoBold';
  font-style: normal;
  font-weight: 700;
  src: local('Lato Bold'), local('Lato-Bold'), url(http://themes.googleusercontent.com/static/fonts/lato/v6/wkfQbvfT_02e2IWO3yYueQ.woff) format('woff');
}
@font-face {
  font-family: 'Lato';
  font-style: normal;
  font-weight: 400;
  src: local('Lato Regular'), local('Lato-Regular'), url(http://themes.googleusercontent.com/static/fonts/lato/v6/9k-RPmcnxYEPm8CNFsH2gg.woff) format('woff');
} 
```

是从谷歌字体链接中提取的结果：

```
<link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'> 
```

希望它的帮助:)

# html - 未能在 HTML 中指定字符集会导致页面定期呈现垃圾吗？

> ID：13463077
> 
> 赞同：2
> 
> 时间：2012-11-19T22:02:44.983
> 
> 标签：html, web-applications, character-encoding, iso-8859-1

我们一直遇到页面偶尔呈现为垃圾的问题，在调查该问题的过程中，我发现该网站的原始开发人员从未指定字符集或文档类型。

现在，由于大部分站点是在没有doctype的情况下开发的，并且默认在IE中以兼容模式呈现，因此添加doctype目前是不可能的。但是，我确实指定该站点应该使用字符集**ISO-8859-1**，希望它可以解决我们遇到的问题。

未能指定字符集会导致这些问题吗？如果是，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:36:45.457

不指定字符编码（charset）意味着浏览器和搜索引擎将不得不猜测。影响差异很大。

例如，如果内容完全是 Ascii 字符，则错误行为的几率非常小。然而，即便如此，也可能会出现问题。假设我访问了一个没有声明其编码的页面，我必须手动尝试不同的编码并最终选择 UTF-16（不太可能，但可能）。当我访问另一个页面时，只有 Ascii 编码，没有声明其编码，它将使用 UTF-16 显示，这意味着它看起来主要是中文。

一个更常见的问题是，如果文档包含非 Ascii 字符并且浏览器猜错了，您可能会看到各种各样的东西而不是一些字符：小矩形；里面有十六进制数字的小矩形；像Ã¤这样的奇怪字符组合；符号；来自不同书写系统的字符（例如，您希望看到拉丁字母的希腊字母或西里尔字母；或其他内容。

字符编码与 doctype 声明和 quirks 模式（兼容性）几乎没有任何关系，这与样式、框的尺寸、框的位置等有关。

您应该声明的是页面上使用的实际编码。您可能需要研究创作工具和页面本身来决定可能是什么。它很可能是 ISO-8859-1，但将 UTF-8 作为创作软件生成的默认值越来越普遍。您不会在仅包含 Ascii 字符的页面上看到差异。

如果发现编码是ISO-8859-1，还是声明windows-1252比较好。原因是人们实际上可能会生成 windows-1252 编码的页面，例如从某处复制文本时。编码之间的区别在于 windows-1252 在某些代码位置具有可打印字符（如智能标点符号），为 ISO-8859-1 中的控制字符保留 - 而这些字符（C1 控件）在 HTML 中是不允许的。

# javascript - 如何使用jQuery从子类中获取值

> ID：13463083
> 
> 赞同：0
> 
> 时间：2012-11-19T22:03:17.103
> 
> 标签：javascript, jquery, css

我正在创建一个简单的 5 星投票系统，并试图获取我的 href 元素的数值。HTML 效果很好，但我不确定如何获取点击事件的数值。

HTML 如下所示：

```
<div id="voting"> 
    <span class="rating_container"> 
        <span class="star_container">  
            <a href="#" class="star star_1" >1<span class="rating">Terrible</span></a>   
            <a href="#" class="star star_2" >2<span class="rating">Bad</span></a>
            <a href="#" class="star star_3" >3<span class="rating">OK</span></a>
            <a href="#" class="star star_4" >4<span class="rating">Good</span></a>   
            <a href="#" class="star star_5" >5<span class="rating">Great</span></a>   
        </span> 
    </span> 
</div> 
```

我的 jQuery 点击事件如下所示：

```
$('.star').click(function(e) {
    e.preventDefault();

   // How can I get the numeric value of the clicked star (e.g., 5,6,7 etc)

}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T22:05:09.810

做这个：

```
var n = this.firstChild.data; 
```

或这个：

```
var n = this.className.split("_")[1]; 
```

* * *

如果您需要将字符串转换为数字，请添加：

```
n = parseInt(n, 10); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-19T22:06:13.617

我会用`data-tag`.

```
<div id="voting"> 
    <span class="rating_container"> 
        <span class="star_container">  
            <a href="#" data-val="1" class="star star_1" >1<span class="rating">Terrible</span></a>   
            <a href="#" data-val="2" class="star star_2" >2<span class="rating">Bad</span></a>
            <a href="#" data-val="3" class="star star_3" >3<span class="rating">OK</span></a>
            <a href="#" data-val="4" class="star star_4" >4<span class="rating">Good</span></a>   
            <a href="#" data-val="5" class="star star_5" >5<span class="rating">Great</span></a>   
        </span> 
    </span> 
</div> 
```

然后在我的点击处理程序中，

```
$('.star').click(function(e) {
    e.preventDefault();
   $(this).data('val'); //should return you the number
}); 
```

# spring - 使用 Spring Security 的 GAE REST 服务和 HTTP 基本身份验证

> ID：13463089
> 
> 赞同：1
> 
> 时间：2012-11-19T22:04:07.800
> 
> 标签：spring, google-app-engine, spring-security, jersey

我正在尝试使用 Spring Security 为基于 JAX-RS Jersey 并在 App Engine 上运行的 REST 服务实现 HTTP 基本身份验证。我找到了几个示例和教程，但它对我不起作用。每当我访问资源时，都不需要身份验证，并且 200 OK 与相应的正文一起重新调整。

以下是我的 web.xml 的摘录。

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        /WEB-INF/application-context.xml
        /WEB-INF/security-context.xml
    </param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/resources/*</url-pattern>
</filter-mapping>

<servlet>
    <servlet-name>SystemServiceServlet</servlet-name>
    <servlet-class>com.google.api.server.spi.SystemServiceServlet</servlet-class>
    <init-param>
        <param-name>services</param-name>
        <param-value/>
    </init-param>
</servlet>

<servlet>
    <servlet-name>JerseyServlet</servlet-name>
    <servlet-class>com.sun.jersey.spi.spring.container.servlet.SpringServlet</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>com.example.endpoint</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
        <param-value>true</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>JerseyServlet</servlet-name>
    <url-pattern>/resources/*</url-pattern>
</servlet-mapping> 
```

这里是 security-context.xml 的摘录。

```
<sec:http create-session="stateless">
    <sec:intercept-url pattern="/resources/**" access="ROLE_USER" />
    <sec:http-basic />
</sec:http>

<sec:authentication-manager>
    <sec:authentication-provider>
        <sec:user-service>
             <sec:user name="admin" password="0000" authorities="ROLE_USER" />
        </sec:user-service>
    </sec:authentication-provider>
</sec:authentication-manager> 
```

任何人都可以看到有什么问题吗？

# antlr - Antlr 忽略 ~,@,#,$,%,*,(,),{,},[,] 等字符

> ID：13463090
> 
> 赞同：2
> 
> 时间：2012-11-19T22:04:12.533
> 
> 标签：antlr, antlr3, antlrworks

Antlr 以某种方式忽略了输入字符串中的字符，例如 ~,@,#,$,%,*,(,),{,},[,]。

我使用输入字符串（例如 show~~~、show ~@#$% 等）测试了以下语法，但 Antlr 转义了 eclipse/antlr 工作解释器上的字符。我希望这样的场景抛出异常而不是从中恢复。请让我知道您是否曾经遇到过这种情况，如果遇到过，您做了什么来摆脱它。

```
grammar Sample; 
options {language = Java;} @header {package a.b.c;} @lexer::header {package a.b.c;} 
prog: stat+ ; stat: expr ; expr: paramValueChildStructure ; 
paramValueChildStructure: ALPHANUMERIC;
ALPHANUMERIC: ('a'..'z' |'A'..'Z' | '0'..'9')+ ; 
```

我尝试使用以下选项来摆脱上述问题，但这在我生成的 lexer.java 中给出了无法访问的代码编译时间问题

```
OTHER      : . {throw new RuntimeException("unknown char: '" + $text + "'");}; 
```

谢谢，阿希什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T16:30:13.410

看这里：[http ://www.antlr3.org/wiki/display/ANTLR3/Custom+Syntax+Error+Recovery](http://www.antlr3.org/wiki/display/ANTLR3/Custom+Syntax+Error+Recovery)

结论前的最后一段可能是您需要的：

> ANTLR 运行时中的其他恢复机制
> 
> 您可能需要自定义恢复的另一个方面，这就是发生 mismatch() 时发生的情况。您将在生成的代码中看到对 match() 方法的大量调用。检查默认实现（在 Java 运行时），我们发现 match 方法将调用方法 recoverFromMismatchedToken() ，这反过来会尝试使用当前的 Follow 集合堆栈来确定我们不匹配的原因是否是存在虚假令牌在输入中：当我们只想要 XZ 时为 XYZ，或者当我们想要 XY Z 时缺少令牌：XZ虚假令牌，报告额外的令牌，但不会引发 RecognitionException。相似地，
> 
> 如果您想要与此不同的行为，则可以覆盖 match() 方法，或者更有可能覆盖 recoverFromMismatchedToken() 方法。也许您不想要虚假/缺失错误检测？或者，正如您将在默认实现中看到的那样，ANTLR 将首先查看它是否可以通过忽略令牌来修复问题，然后继续查看它是否可以通过添加令牌来修复问题。但是，使用这两种方法都可以恢复一些语法错误——也许您想颠倒这些策略的尝试顺序？

# android - 焦点阻止点击

> ID：13463096
> 
> 赞同：0
> 
> 时间：2012-11-19T22:04:41.840
> 
> 标签：android

某些元素正在窃取焦点，并且我的列表视图上的点击没有注册。有人可以建议一种方法来找到哪个吗？

这是该应用程序的工作方式：

Activity > 内部自定义 View > onTouch > AlertDialog.builder.setView(custom ListView)

我错误地认为我需要两个选择，并且完全成功地使用了相同的设置，之前在构建器上使用了 .setPositiveButton 和 .setNegativeButton 。但我需要更多选择，因此需要一个 ListView。

以下是 ListView 中的相关行：

```
final ListView lv = new ListView(this);
lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, names) {
  @Override
  public View getView(int position, View convertView, ViewGroup parent) {
    if (convertView == null) { convertView = new TextView(GameActivity.this); }
    ((TextView)convertView).setText((String)getItem(position));
    return convertView;
  }
  public long getItemId(int position) { return position; }
  public String getItem(int position) { return names[position]; }
  public int getCount() { return names.length; }
});                     
lv.setOnItemClickListener(new OnItemClickListener() {
  @Override
  public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
  ///////Nothing happens, never called
  }
}); 
```

我阅读了二十或三十篇堆栈溢出帖子，几乎总是与视图窃取焦点有关。哪个视图正在窃取焦点，我该如何调试？

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:09:27.713

答案在 Sam 的评论中：它很简单，我并没有关闭（）对话。

# iphone - 就应用而言的模型-视图-控制器

> ID：13463097
> 
> 赞同：1
> 
> 时间：2012-11-19T22:04:45.183
> 
> 标签：iphone, model-view-controller, controller

我有编码经验，但我是 MVC 世界的**新手**。

我了解模型和视图，并且从概念上了解控制器，但我很难弄清楚它们是如何工作的。

我会为应用程序中的每个可能的屏幕状态设置一个控制器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:06:13.243

> 我会为应用程序中的每个可能的屏幕状态设置一个控制器吗？

如果“屏幕”是指视图，那么单个控制器可以管理屏幕的所有不同状态（即视图）。

如果“屏幕状态”是指视图，那么答案可能是肯定的：一个控制器将管理一个视图。

至少，如果你的目标是一个相当规范的 MVC 实现。

如果您查看任何 SDK 控制器类（例如`UITableViewController`、`UIViewController`等）的接口，您会发现控制器只有一个对视图对象的引用。

# apache - 不允许通过代理服务器的 HTTP

> ID：13463098
> 
> 赞同：0
> 
> 时间：2012-11-19T22:04:46.227
> 
> 标签：apache, tomcat, centos, port80

当我尝试连接到我的`Tomcat`服务器时，`http://<servername>:8080`它工作正常，但是从另一个 ISP 提供的它给出了以下错误：

```
HTTP through a proxy server is not allowed. 
```

一些 ISP 显然不允许通过端口 8080 进行 http，因为他们认为客户端使用代理。

我的`httpd`网站也在端口 80 上运行。

因此，为了避免代理错误，我想进行以下路由：

*   如果用户连接到`http://<servername>`，则该网站通过 apache 提供服务。
*   如果用户连接到 `http://<servername>/AppName`，则端口将重新路由到 8080，而客户端（或他的 ISP）不知道。

这可能吗（使用 iptables 或其他东西）？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:22:37.240

您可以使用 mod_proxy 配置 Apache 为您执行此操作

在您的 apache conf 中添加类似这样的内容

```
ProxyPass /appName http://localhost:8080/appName
ProxyPassReverse /appName http://localhost:8080/appName 
```

[http://httpd.apache.org/docs/current/mod/mod_proxy.html](http://httpd.apache.org/docs/current/mod/mod_proxy.html)

使用 Tomcat，您还可以使用 mod_proxy AJP

[http://httpd.apache.org/docs/current/mod/mod_proxy_ajp.html](http://httpd.apache.org/docs/current/mod/mod_proxy_ajp.html)

# r - R Packaging 中的 inst 和 extdata 文件夹

> ID：13463103
> 
> 赞同：54
> 
> 时间：2012-11-19T22:05:01.777
> 
> 标签：r, package

在文档中，R 建议将原始数据文件（不是 Rdata 或 Rda）放在`inst/extdata/`

从第一段开始：[http ://cran.r-project.org/doc/manuals/R-exts.html#Data-in-packages](http://cran.r-project.org/doc/manuals/R-exts.html#Data-in-packages)

> data 子目录用于存放数据文件，可以通过延迟加载或使用 data() 加载。（由DESCRIPTION文件中的'LazyData'字段进行选择：默认不这样做。）它不应该用于包所需的其他数据文件，并且约定已经成长为使用目录inst/此类文件的 extdata。

因此，我已将所有原始数据移动到此文件夹中，但是当我构建并重新加载包然后尝试使用（例如）访问函数中的数据时：

```
read.csv(file=paste(path.package("my_package"),"/inst/extdata/my_raw_data.csv",sep="")) 
# .path.package is now path.package in R 3.0+ 
```

我收到“无法打开文件”错误。

但是，看起来确实`/extdata`在包目录中调用了一个文件夹，其中包含文件（构建后和安装）。`/inst`文件夹怎么了？

/inst 文件夹中的所有内容是否都被推送到`/`包中？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-11-19T22:49:21.900

比使用更有用的`file.path`是使用`system.file`. 安装软件包后，您可以像这样获取文件：

```
fpath <- system.file("extdata", "my_raw_data.csv", package="my_package") 
```

`fpath`现在将在您的 HD 上拥有该文件的绝对路径。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-11-19T22:46:01.463

你们都很亲近，基本上都有这个。'Writing R Extensions' 的正式参考是：

> 1.1.3 包子目录
> 
> [...]
> 
> 子目录的内容`inst`将递归复制到安装目录。的子目录`inst`不应干扰 R 使用的那些（当前，`R`，`data`，`demo`， `exec`，`libs`，`man`，`help`，`html`和`Meta`，以及使用的早期版本`latex`，`R-ex`）。`inst`在构建之后发生的复制，`src` 因此它`Makefile`可以创建要安装的文件。在 R 2.12.2 之前，这些文件是使用包源中的权限安装在 POSIX 平台上的，因此应注意确保这些限制不会太严格：`R CMD build`将进行适当的调整。要从安装中排除文件，可以在文件中指定排除模式列表`.Rinstignore`在顶级源目录中。这些模式应该是类似于 Perl 的正则表达式（有关`regexp`详细信息，请参阅 R 中的帮助），每行一个，与文件和目录路径匹配（10），例如，`doc/.*[.]png$`将`inst/doc`根据 (小写）扩展。

# javascript - 通过 $.ajax 请求 json 文件时出现奇怪的 JSON 行为

> ID：13463106
> 
> 赞同：0
> 
> 时间：2012-11-19T22:05:14.050
> 
> 标签：javascript, ajax, json

我有一个 json 文件 (text2.json) 和一个文本文件 (text2.txt)，其内容与 text2.json 完全相同。

当通过 $.ajax 请求 json 文件时，我发现这很有趣：

向网络服务器请求 text2.json：

```
 $.ajax({
   url: "./scripts/text2.json",
   dataType:"json",
   success: function(data){
            alert('success');
   },
   error: function(){alert('error');}
 }); 
```

这会警告错误。

向网络服务器请求 text2.txt：

```
 $.ajax({
   url: "./scripts/text2.txt",
    dataType:"json",
    success: function(data){
            alert('success');
    },
    error: function(){alert('error');}
  }); 
```

这会提示成功。

到目前为止，我只有 2 天的 javascript 经验，我只是想知道是什么导致了这种权衡......

**编辑**

对于 text2.json + type:"json"，我错误地修改了我的 alert()：正如你们建议的那样。然后警报给出“[object object]”，因为我的 json 文件是“{“result”：true，“count”：2}”。这看起来像一个空对象或其他东西。

然后我检测到将 text2.json 请求为 json dataType 时出现“parseerror”。我不确定这个信息。看起来有些初始设置不正确。有人想给我一个提示吗？

看起来我的 json 文件很像格式错误的 json。情况可能是这样...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:13:26.993

该错误可能与响应的标头有关。您正在指定一个 json 数据类型，因此预期的标头应该是类型`application/json`

# css - 图片是在 Chrome 中从我的 javascript 幻灯片中推出的，而不是在 IE8 中

> ID：13463108
> 
> 赞同：1
> 
> 时间：2012-11-19T22:05:19.080
> 
> 标签：css

这可能是一个简单的问题，但是我似乎找不到适用于所有浏览器的解决方案。

链接： http: [//immeublesninamiller.com/fr/listings/details/ ?ID=71](http://immeublesninamiller.com/fr/listings/details/?ID=71)

我认为问题所在的css：

```
#image {
    position: relative;
    width: 500px;
    height: 375px;
    left: 0px;
    z-index: 100;
} 
```

我尝试使用 left:-250px; 并且它也将 IE8 图片向左移动，所以这不是一个好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:17:54.210

首先将其调整为在 Chrome 中看起来正确，然后您可以`*`在规则前面添加额外的代码行，使其仅适用于 IE，例如：`*left: 0;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:08:23.673

将 left:0 添加到您的#image 选择器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:10:08.413

试试这个

```
#image {
    position: relative;
    width: 500px;
    height: 375px;
    left: 0px;
    z-index: 100;
    margin-left:-250px;
} 
```

# java - 无法找到命名空间 http://www.mulesoft.org/schema/mule/jersey 的 NamespaceHandler

> ID：13463111
> 
> 赞同：3
> 
> 时间：2012-11-19T22:05:49.057
> 
> 标签：java, xml, web-services, xsd, mule

我可能真的不喜欢这个，但是任何人都可以查看这个配置并告诉我为什么我在 tomcat 7 启动时看到这个问题？我使用的是 mule 3.3，但您可以从下面的标题中看到。

```
Unable to locate NamespaceHandler for namespace [http://www.mulesoft.org/schema/mule/jersey] 
```

这是我的骡子配置文件的标题：

```
<mule xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:spring="http://www.springframework.org/schema/beans"
    xmlns:mulexml="http://www.mulesoft.org/schema/mule/xml" xmlns:jersey="http://www.mulesoft.org/schema/mule/jersey" 
    xsi:schemaLocation="  
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd  
    http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.3/mule.xsd  
    http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/3.3/mule-http.xsd  
    http://www.mulesoft.org/schema/mule/xml http://www.mulesoft.org/schema/mule/xml/3.3/mule-xml.xsd 
    http://www.mulesoft.org/schema/mule/jersey http://www.mulesoft.org/schema/mule/jersey/3.0/mule-jersey.xsd
    http://jersey.apache.org/core http://jersey.apache.org/schemas/core.xsd"> 
```

这是使用球衣标签的内容：

```
<flow name="HelloWorld">
 <inbound-endpoint address="http://localhost:8081/helloworld"/>
     <jersey:resources>
         <component class="com.sample.helloworld.HelloRest"/>
     </jersey:resources>
</flow> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:16:57.990

如果您使用 maven，请在您的 POM 中添加以下依赖项：

```
<dependency>
        <groupId>org.mule.modules</groupId>
        <artifactId>mule-module-jersey</artifactId>
        <version>3.3.0</version>
</dependency> 
```

# c# - 字符串替换：忽略空格

> ID：13463123
> 
> 赞同：1
> 
> 时间：2012-11-19T22:06:52.790
> 
> 标签：c#, xml, regex, string

我遇到的问题如下。

我的问题的根本原因是“XML”解析（XML 用引号引起来，因为在这种情况下，它不是直接的 XML）和空格。

我需要能够转换这个：

```
 "This is a <tag>string</tag>" 
```

进入

```
 "This is a {0}" 
```

它必须能够处理嵌套标签之类的东西。我的计划是使用以下内容来获取我的替换文本。

```
 var v = XDocument.Parse(string.Format("<root>{0}</root>", myString),LoadOptions.PreserveWhitespace);
 var ns = v.DescendantNodes();
 var n = "" + ns.OfType<XElement>().First(node => node.Name != "root"); 
```

该代码返回第一对匹配的标签。它可以处理嵌套等。唯一真正的问题是，即使使用“PreserveWhitespace”选项，回车也会被消除。 `"\r\n"`转换为`"\n"`. 这可以防止匹配，因此：

```
 myString = myString.Replace(n,"{0}"); 
```

没有按预期工作。所以我试图想出一种方法让替代品正常工作，忽略空格，但我不知道如何开始......想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:27:06.190

### 输入：

```
string s = "This <tag id=\"1\">string <inner><tag></tag></inner></tag> is <p>inside <b>of</b> another</p> string"; 
```

### C#代码：

```
Match m;
do
{
  m = Regex.Match(s, @"\A([\s\S]*)(<(\S+)[^[<>]*>[^<>]*</\3>)([\s\S]*)\Z");
  if (m.Success) {
    s = m.Groups[1].Value + "{0}" + m.Groups[4].Value;
    System.Console.WriteLine("Match: " + m.Groups[2].Value);
  }
} while (m.Success);
System.Console.WriteLine("Result: " + s); 
```

### 输出：

```
Match: <b>of</b>
Match: <p>inside {0} another</p>
Match: <tag></tag>
Match: <inner>{0}</inner>
Match: <tag id="1">string {0}</tag>
Result: This {0} is {0} string 
```

**[在此处](http://ideone.com/8auRKT)**测试此代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:18:18.207

虽然不是最好的解决方案（如果你只是`'\n'`在你的`myString`），但值得一试：

```
myString =  myString.Replace(n.Replace("\n", "\r\n"), "{0}"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:02:36.170

试试 CDATA 部分？

```
v = XDocument.Parse(string.Format("<root><![CDATA[{0}]]></root>", myString)); 
```

没有任何方便，但我怀疑你可能不得不在它之后弄乱选择器，并得到它的孩子（文本节点）

# batch-file - 使用批处理从文件名中删除花括号

> ID：13463127
> 
> 赞同：1
> 
> 时间：2012-11-19T22:07:18.557
> 
> 标签：batch-file

我们的一台 Windows 服务器处理文件并通过网络发送它们，但是当文件名中有特殊字符（例如大引号）时，它们会中断。示例：“This_person's_file”.jpg

我正在尝试编写一个批处理脚本来重命名文件以删除这些特殊字符。我见过很多删除 & 符号等的脚本，但找不到任何可以处理上述问题的批处理脚本。

愚蠢的想法？是的。我需要批量处理吗？是的。

# c# - 线程缓慢且不可预测？

> ID：13463142
> 
> 赞同：5
> 
> 时间：2012-11-19T22:08:26.733
> 
> 标签：c#, .net, multithreading

我已经创建了光线追踪器的基础，这是我绘制场景的测试函数：

```
public void Trace(int start, int jump, Sphere testSphere)
{
    for (int x = start; x < scene.SceneWidth; x += jump)
    {
        for (int y = 0; y < scene.SceneHeight; y++)
        {
            Ray fired = Ray.FireThroughPixel(scene, x, y);

            if (testSphere.Intersects(fired))
                sceneRenderer.SetPixel(x, y, Color.Red);
            else sceneRenderer.SetPixel(x, y, Color.Black);
        }
    }
} 
```

SetPixel 只是在颜色的一维数组中设置一个值。如果我通过直接调用它来正常调用该函数，它会以恒定的 55fps 运行。如果我做：

```
Thread t1 = new Thread(() => Trace(0, 1, testSphere));
t1.Start();
t1.Join(); 
```

它以恒定的 50fps 运行，这很好并且可以理解，但是当我这样做时：

```
Thread t1 = new Thread(() => Trace(0, 2, testSphere));
Thread t2 = new Thread(() => Trace(1, 2, testSphere));

t1.Start();
t2.Start();

t1.Join();
t2.Join(); 
```

它到处运行，在 30-40 fps 之间快速移动，有时会超出该范围，达到 50 或下降到 20，它根本不是恒定的。如果我在单个线程上运行整个事情，为什么它的运行速度比它慢？我在四核 i5 2500k 上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:26:24.333

如果不分析您的应用程序，这很难回答，但我会怀疑虚假分享。

您的两个线程都在写入共享内存结构，这将导致您的 CPU 缓存不断失效。

测试的简单方法是为每个线程创建一个单独的输出数组。
它不必工作 - 只需查看帧速率。

不久前我写了一篇关于这个的文章：“[并发危害：虚假共享](http://simplygenius.net/Article/FalseSharing)”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:19:15.197

线程通常不是渲染的方式。我不知道线程中究竟执行了什么，但是创建线程并加入它们可能比您通过并行计算赢得的时间更多。也取决于处理器内核的数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:56:03.337

实验：将 x 与 y 交换，在内部循环中通过 x，在外部循环中通过 y，并且始终按行分配每个线程的负载，而不是按列 (x)。

我的假设是基于这样一个事实，即位图几乎总是以 x-direction 的升序内存地址存储。如果是这种情况，则您当前的内存访问模式在 CPU 缓存上很困难，尤其是在使用多个线程时。

# c# - 在我的虚拟机上：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例

> ID：13463144
> 
> 赞同：1
> 
> 时间：2012-11-19T22:08:28.540
> 
> 标签：c#, asp.net, virtual-machine

从我的开发机器上，我可以成功连接到 sql server。其他程序员也可以从他们的开发机器成功连接。

我设置了一个 VM，安装了 VS2010 ，连接到 TFS，并且确实获得了我的代码的最新信息。我能够在 VM 上成功构建 .sln。但是在 VM 上，当我运行应用程序时，出现以下黄屏错误。如何在 VM 上解决此问题。它适用于我的本地开发人员，但不适用于 VM。请帮忙。

**建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:57:23.810

我通过在我的连接字符串中完全限定服务器设置的域名来解决它。

```
<add name="MyName" connectionString="server=MyServer.FullDomainName; uid=MyUid; pwd=MyPwd; database=MyDB" providerName="System.Data.SqlClient"/> 
```

# linux - 发生分段错误时停止 linux bash 脚本

> ID：13463147
> 
> 赞同：6
> 
> 时间：2012-11-19T22:08:44.080
> 
> 标签：linux, shell, segmentation-fault

如果调用程序导致 linux bash 脚本中的分段错误，如何注意可能会停止脚本呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T22:51:43.987

如果程序以分段错误或任何其他错误退出，它将以非零退出代码退出。您可以测试此退出代码，并在执行此操作时退出您的脚本。如果您想停止任何错误（不仅仅是分段错误），您可以使用：

```
some-crashy-program args || exit 1 
```

如果你想在你调用的*任何*程序返回错误时退出你的脚本（除了作为`if`or`while`语句的一部分），你可以`set -e`在脚本的开头调用，以使脚本在任何命令失败时立即退出。在需要随时间维护的大型脚本中，这种用法有点不鼓励，因为如果`grep`返回非零退出代码之类的东西，它可能会导致您的脚本在意外时间退出，但它对于快速一次性脚本很有用如果你知道你总是想停止错误。

如果您只想在程序因段错误而崩溃时退出，而不是任何其他错误，您可以查看具体的退出代码。在大多数系统上，`SEGV`值为 11，但您可以检查：

```
$ kill -l SEGV
11 
```

然后添加 128，这将是您的程序退出的退出代码。测试退出代码以了解您的程序是否因 SIGSEGV 崩溃：

```
some-crashy-program args
if [ $? -eq 139 ]; then
    echo "It crashed!"
    exit 1
fi 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:01:01.800

分段错误将导致`139`作为返回码。

您可能可以像这样检查返回码：

```
run_your_thing
if [[ $? -eq 139 ]]; then echo "oops, sigsegv"; fi 
```

# sitecore - 如何恢复 Sitecore CMS 6.x 附带的原始 Sitecore 角色？

> ID：13463150
> 
> 赞同：0
> 
> 时间：2012-11-19T22:08:49.303
> 
> 标签：sitecore, sitecore6

我想恢复原始的 Sitecore 角色，例如 Sitecore Client Authoring。我在 6.3.1 上有另一个“干净”安装，我可以从中复制数据。我可以从该实例的 aspnet_Roles 表中复制行吗？还需要什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:46:58.420

您不能直接复制数据，因为 ASP.NET 成员使用的 ID 可能不匹配。您可以尝试从全新安装中序列化角色，然后在要还原的实例中恢复它们。

当您对它们进行序列化时，它们将被写入 Data 文件夹内的“序列化”文件夹。将其复制到另一个实例上的同一目录，然后使用目标实例中的角色管理器来恢复它们。

# vba - 从 Access 2010 中的函数调用子

> ID：13463151
> 
> 赞同：0
> 
> 时间：2012-11-19T22:08:54.427
> 
> 标签：vba, ms-access, ms-access-2010

我的 MS Access 应用程序有一个子例程，它在我更新表单上的一个控件后触发。

```
Public Sub cboCrew_AfterUpdate()
    ...do some work...
End Sub 
```

我想从我在 Module1 中定义的函数中调用这个相同的子

```
Function my_function()
     Call cboCrew_AfterUpdate
End Function 
```

此代码引发错误：“编译错误子或未定义函数”

我怀疑问题在于我在给潜艇的电话中不够具体。我需要引用子`"some_modulte_name.sub_name"`吗？谁能告诉我我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:11:42.833

反过来设置这个...

```
Public Sub cboCrew_AfterUpdate()
    My_Function
End Sub

Function my_function(frm As Form)
     ''Do stuff
End Function 
```

重新评论

```
Public Sub cboCrew_AfterUpdate()
    My_Function Me 
End Sub

Function my_function(frm As Form)
     MsgBox frm.Name
End Function

Sub AnotherSub()
   My_Function Forms!AFormName
End Sub 
```

# html - td 出现在 html 表格中的其他 td 下方

> ID：13463152
> 
> 赞同：0
> 
> 时间：2012-11-19T22:08:55.623
> 
> 标签：html

我想知道是否可以在 HTML 2 行中制作一个表格行，以便我拥有。

```
---------------------
|<td></td>|<td></td>|      <- all within one <tr></tr> block
|-------------------|
|<td>          </td>|
--------------------- 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:11:11.183

根据您的图纸，我认为您需要以下内容：

```
<table>
    <tr><td></td><td></td></tr>
    <tr><td colspan="2"></td></tr>
</table> 
```

请注意，这是在两行中完成的，而不是一行。

如果你真的不希望那样，Divs 是要走的路......

```
<div id="container" style="width:501px">
    <div id="column1" style="width:49%; float:left; border:1px solid #000"> Some content here </div>
    <div id="column2" style="width:49%; float:left; border:1px solid #000"> Some content here </div>
    <br style="height:0px; clear:both"/>
    <div id="column3" style="width:98%; border:1px solid #000"> Some content here </div>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

数字略有偏差，但为了速度，我没有让事情完全对齐

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:11:00.813

是的，`<td colspan="2">Will take two cells' width</td>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:11:03.057

不，您需要一个新行来执行此操作。

如果使用无序列表，则可以使用浮点数来获得相同的效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:11:45.943

您可以做的是使用以下内容：

```
<table width="500px">
  <tr>
    <td></td>
    <td></td>
  </tr>
</table>
<table width="500px">
  <tr>
    <td></td>
  </tr>
</table> 
```

只需更改`500px`您想要的尺寸即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-19T22:14:24.940

他想将所有内容都包含在 1 TR 中。一种可能的解决方案是在该 TD 中包含另一个表。

```
<tr> 
<td>
<table style="width:100%;margin:0">
    <tr>
        <td></td><td></td>
    </tr>
    <tr>
        <td colspan="2"><td>
    </tr>
</table>
</td>
</tr> 
```

# z3 - 防止解决方案被简化

> ID：13463153
> 
> 赞同：5
> 
> 时间：2012-11-19T22:09:05.027
> 
> 标签：z3

我想从 z3 得到解决方案，而无需使用`let`语句进行简化。

例如，如果我给出以下内容：

```
(declare-const x Int)
  (elim-quantifiers (exists ((x.1 Int)) 
    (and (or (and (= (- x.1 2) 0) (<= (- x.1 9) 0)) 
             (and (or (= (- x.1 2) 0) (and (<= (- x.1 4) 0) 
                                      (and (<= (- 4 x.1) 0) 
                                           (<= (- x.1 11) 0)))) (<= (- x.1 9) 0))) (= (- (+ x.1 2) x) 0)))) 
```

我得到了解决方案：

```
(let ((a!1 (and (or (and (<= x 4) (>= x 4)) (and (<= x 6) (>= x 6) (<= x 13)))
                (<= x 11))))
    (or (and (<= x 4) (>= x 4) (<= x 11)) a!1)) 
```

有没有办法告诉 Z3 不要将一些复杂的表达式提取到 let 语句中？如果我在没有 let 语句的情况下得到平坦的答案，我会更容易解析结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T22:23:49.450

我们可以设置以下选项来防止 Z3 漂亮打印机使用`let`s

```
(set-option :pp-min-alias-size 1000000)
(set-option :pp-max-depth      1000000) 
```

任何大数字都可以解决问题。

我们必须记住，当我们避免使用`let`s 时，显示一些包含大量共享子表达式的公式可能不可行。在内部，Z3 将公式存储为 DAG 而不是树。如果我们不使用`let`s，这些公式的漂亮打印可能会比它们的内部表示大得多。因此，我们不应滥用上述选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-29T21:26:04.263

我正在使用`z3-4.5.0`，看起来选项名称发生了一些变化。如果`pp-max-depth`对您不起作用，请尝试`pp.max_depth`和`pp.min_alias_size`。

我正在使用 Java API，以下内容与我一起使用

```
com.microsoft.z3.Global.setParameter("pp.min_alias_size", "1000000");
com.microsoft.z3.Global.setParameter("pp.max_depth", "1000000"); 
```

# windows-server-2008 - 使用 Powershell get-acl 检索 AD-LDS 对象 ACL

> ID：13463155
> 
> 赞同：1
> 
> 时间：2012-11-19T22:09:17.807
> 
> 标签：windows-server-2008, powershell-2.0, acl, adlds

我已经使用 LDP 在一些 AD-LDS 对象上手动设置了一些自定义 DACL。我正在尝试编写一个脚本，以 SDDL 形式导出这些 ACL（目前只有 DACL）。

我可以使用以下代码检索 AD-LDS 对象：

```
$obj = Get-ADOrganizationalUnit -Filter {Name -Like 'stuff'} -searchbase "OU=apps,DC=example,DC=com" -server 'localhost:389'
$obj[0].distinguishedName
OU=stuff,OU=apps,DC=example,DC=com 
```

我知道[get-acl Powershell 命令](http://technet.microsoft.com/en-us/library/dd378932%28v=ws.10%29.aspx)及其[Active Directory 感知语法](http://blogs.technet.com/b/heyscriptingguy/archive/2012/03/12/use-powershell-to-explore-active-directory-security.aspx)，但是当我在我的 AD-LDS 对象上尝试它时，它失败了

```
Get-Acl : Cannot find path 'OU=stuff,OU=apps,DC=example,DC=com' because 
it does not exist.
At line:1 char:9
+ (Get-Acl <<<<  "DC=example,DC=com").access
    + CategoryInfo          : ObjectNotFound: (:) [Get-Acl], ItemNotFoundException
    + FullyQualifiedErrorId : GetAcl_PathNotFound_Exception,Microsoft.PowerShell.Commands.GetAclCommand 
```

我尝试在 get-acl 命令前加上`AD:`前缀，以及`ldap://localhost/`，但错误保持不变。我也未能检索到其他类型对象（如`user`和`group`）的 DACL。

如何使用 Powershell 以 SDDL 形式检索 AD-LDS 对象的 DACL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-22T20:25:39.483

我有同样的问题，但没有在互联网上找到正确的答案。我花了很长时间才找到一个可行的解决方案。由于此讨论是通常搜索引擎上的最佳结果之一，但没有提供实际答案，因此我决定将其发布在这里：

以下问题将我推向了正确的方向： [How do I set-location ad: to a different active directory domain with Powershell](https://stackoverflow.com/questions/28508117/how-do-i-set-location-ad-to-a-different-active-directory-domain-with-powershell)

我用 Windows 2012R2（我认为它有 Powershell 4.0）对其进行了测试

假设您有一个 AD LDS 实例在“server:port”上运行，后缀为“dc=root,dc=com”，以下代码将使用“get-acl”屏幕打印此后缀节点的 ACL：

1.  添加活动目录模块：

*导入模块活动目录*

2.  您需要定义一个类似于“AD:”的新访问标识符。此标识符绑定到您当前的 Powershell 会话：（此示例使用“myLDS:”，但您可以定义任何您想要的标识符字符串）

*New-PSDrive -Name myLDS -PSProvider ActiveDirectory -Server "server:port" -Scope Global -Root "//RootDSE/"*

3.  最后，您可以使用这个新标识符来访问 LDS 存储的 acl，例如在屏幕上打印它们：

*(Get-ACL 'myLDS:\dc=root,dc=com').access*

请注意，“get-acl”和 dsacls.exe 的输出不同。'get-acl' 将返回主题的原始 SID，而 dsacls 在内部将 SID 转换为 DN 并返回 DN。因此，如果您使用“get-acl”，但需要 DN，则需要使用额外的 LDAP 查询自己进行此转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-16T17:18:20.517

尝试：

dsacls 'OU=stuff,OU=apps,DC=example,DC=com'

我在 PowerShell 中看到了一些有趣的东西，并怀疑它与权限有关。也就是说，尝试：

获取 ADOrganizationalUnit -Filter 'name -eq "stuff"'

这可能有效，使用 Get-ADOrganizationalUnit 上的方法和属性可能有助于隔离问题

当我找到问题的根本原因时，我会更新这篇文章。

# jquery - 当 html 页面存在时，jQuery .load() 返回 404

> ID：13463157
> 
> 赞同：0
> 
> 时间：2012-11-19T22:09:24.717
> 
> 标签：jquery, html, firebug

我有一行代码：

```
$(".class").load(variable + ".html"); 
```

这在我的本地主机上运行良好，但是在实时站点上它根本不起作用。谁能解释为什么会发生这种情况？这些页面都在我网站上的同一个 public_html 文件夹中。

Firebug 给出了 URL 和 404 错误。手动加载页面工作正常。

使用`.toLowerCase()`修复了这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:11:19.377

如果服务器区分大小写，您可能正在检查正确的拼写

```
$(".class").load("Filename.html");
$(".class").load("filename.html");
$(".class").load("Filename.Html");
$(".class").load("Filename.HTML"); 
```

或任何你称之为文件的东西。

# jquery - 从 HTML 块中提取 HTML

> ID：13463161
> 
> 赞同：2
> 
> 时间：2012-11-19T22:10:05.997
> 
> 标签：jquery

我正在尝试使用下面的函数从下面显示的 HTML 块中提取（引号在返回值中，不确定是否重要）字符串“演示使用 App Cloud Studio 的内容部分的基础知识”。

我想我可以使用第一个`<div class="field-item odd">`来检索所需的字符串，如代码行所示

```
var displayDescription = $(fullDescription).find( "#field-item odd" ).html(); 
```

但是，这总是返回 null。（我可以使用 Chrome 开发者工具来查看 fullDescription 是否正确填充。）

非常感谢任何帮助。

代码：

```
function onGetDataSuccess( data ) {
  for (var i = 0; i < data.length; i++) {
    var thisItem = data[i];
    var isVideo = jQuery.contains( thisItem.link, "/training-videos/" );
    if ( isVideo ){
      var fullDescription = thisItem.description;
      var displayDescription = $(fullDescription).find( "#field-item odd" ).html();
    }
  }
} 
```

HTML：

```
<p>testing</p>
<div class="field field-type-text field-field-video-short-desc">
      <div class="field-label">Short Description:&nbsp;</div>
    <div class="field-items">
        <div class="field-item odd">
                Demonstrates the basics of using the Content section of App Cloud Studio        
        </div>
    </div>
</div>
<div class="field field-type-text field-field-video-id">
      <div class="field-label">Video ID:&nbsp;</div>
    <div class="field-items">
            <div class="field-item odd">
                    1251462871001        
            </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:13:24.683

您一起使用了错误的选择器。field-item 是一个类，odd 也是一个类。你应该使用：

```
$(fullDescription).find( ".field-item.odd" ).html() 
```

对于大多数用例，jQuery 选择器与 CSS 选择器相同。

# php - 我如何解决标头已发送的问题

> ID：13463164
> 
> 赞同：-4
> 
> 时间：2012-11-19T22:10:12.750
> 
> 标签：php, mysql, arrays

当我测试我的脚本时，我得到了这个错误

```
Warning: Cannot modify header information - headers already sent by (output started at /nfs/c06/h04/mnt/153892/domains/authomotive.com/html/artpoint/gallery/index.php:12) in /nfs/c06/h04/mnt/153892/domains/authomotive.com/html/artpoint/gallery/main.php on line 17 
```

我们当然都知道我删除了其他文件中的所有空格并将 ob_start() 和 ob_flush() 添加到文件中我还能做什么？我是否必须找到另一种发送标头的方法，或者是否有另一种方法可以绕过此警告？

该脚本从我的数据库和地图中删除了一个文件。

main.php 的来源

```
<?php 
ob_start();
    if(isset($_GET['remove'])){
        $id=$_GET['id'];
        include('conf.php');
        require_once('classes/db.class.php');
        $db = new DB($db_name,$db_host,$db_user,$db_passw);
        $q = $db->query('SELECT photourl,minurl,projectID FROM photo WHERE id='.$id);
            while ($line = $db->fetchNextObject()) {
                $file = $line->photourl;
                unlink($file);
                $filemin = $line->minurl;
                unlink($filemin);
            }
        //$db->execute('DELETE FROM project WHERE id='.$line->projectID,true);
        $db->execute('DELETE FROM photo WHERE id='.$id);
        header("Location:index.php");
    }
    if(isset($_GET['success'])){
        echo('het werkt');
    }
    ob_flush();
?>
<h1> Projecten </h1>

<ul id="edit-menu">
    <li>
        <ul>
            <li><a class="addPro" href="#"><img src="images/addProject.png" /></a></li><br/>
            <li><a class="add" style="padding-left:15px"href="#">Project +</a></li>
        </ul>

    </li>
    <li>
        <ul>
            <li><a class="addPho" href="#"><img src="images/add.png" /></a></li><br/>
            <li><a class="add" href="#">Toevoegen </a></li>
        </ul>
    </li>

    <li>
        <ul>
            <li><a class="deletePho" href="#"><img src="images/delete.png" /></a></li><br/>
            <li><a href="#">Verwijderen </a></li>
        </ul>
    </li>
    <div id="addproject">
        <?php include('addproject.php'); ?>
    </div>
    <div id="addphoto">
        <?php include('addphoto.php'); ?>
    </div>
    <div id="deletephoto">
        <?php include('removePhoto.php'); ?>
    </div>
</ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:20:09.293

很多时候，这个问题是由文件结尾处的空白行引起的，在`<?php ... ?>`标签之外。这些空行被 PHP 解释为需要输出的 (HTML) 内容的一部分。

在主 PHP 文件的情况下，它显然只适用于文件的开头，但是对于包含的文件，它们任一端的空行都可能导致输出发生，因此您的`header()`调用失败。

当然，它们生成的任何其他输出也将具有相同的效果，但是空行很容易成为人们遇到此问题的最常见原因，而无法弄清楚是什么内容导致了它，因为它并不明显，而且因为它是当您查看源代码以了解正在发生的事情时，很难发现一个杂散的空白行。

您应该检查程序加载的所有 PHP 文件，以确保不输出任何内容。特别检查文件的开头和结尾，以确保那里没有任何空行。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:18:48.390

这里最有可能发生的是正在执行的文件`index.php`是`include('main.php');`. 但是，如果`index.php`在 include 之前已经发送了一些数据`main.php`，那么您将很难更改标题。

`index.php`可能有一些正在回显的空白行。这真的很容易被忽视。

此外，这是非常不安全的：

```
$db->execute('DELETE FROM photo WHERE id='.$id); 
```

Web 安全规则 #1：**[永远不要信任客户端](https://stackoverflow.com/questions/13224877/php-restricting-post-data-at-client-side-failed)**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:16:46.417

您不能在 html 输出或回显之后使用标头。您仍然可以使用元或 javascript 重定向。

# ruby-on-rails - 如何在 Ruby on Rails Gem 中使用 zurb 基础？

> ID：13463168
> 
> 赞同：1
> 
> 时间：2012-11-19T22:10:39.347
> 
> 标签：ruby-on-rails, ruby, gem, zurb-foundation

无法准确确定在何处以及如何使用开箱即用的 RTL，并且无法使用 Ruby Gem 根据不同的本地人进行切换。

[http://www.zurb.com/playground/foundation-rtl](http://www.zurb.com/playground/foundation-rtl)

更新：在 Zurb 网站上它说：“Sassy RTL 如果您使用的是 Foundation Gem 版本，则内置 RTL 支持，并且切换文本方向比以往更容易。您只需在设置 SCSS 中更改单个变量文件。”

```
$textDirection: rtl !default; 
```

这个文件是什么，我在哪里添加这个代码？

# git - 由于空格错误，git rebase 失败

> ID：13463173
> 
> 赞同：26
> 
> 时间：2012-11-19T22:11:02.063
> 
> 标签：git, rebase

我正在尝试重新设置分支并且 git 正在弹出，因为它正在尝试执行一些失败的合并操作。我如何让 git 阻止这个？

```
# git rebase -f --onto master~2 master~ master
First, rewinding head to replay your work on top of it...
Applying: r1002 - CS 1.0.23
Using index info to reconstruct a base tree...
M   about.html
<stdin>:68: trailing whitespace.                     
<stdin>:115: trailing whitespace.
<stdin>:201: trailing whitespace.
<stdin>:2369: trailing whitespace.
<stdin>:2385: trailing whitespace.
warning: squelched 2305 whitespace errors
warning: 2310 lines add whitespace errors.
Falling back to patching base and 3-way merge...
Auto-merging about.html
CONFLICT (content): Merge conflict in about.html
Failed to merge in the changes.
Patch failed at 0001 r1002 - 1002
The copy of the patch that failed is found in:
   /local/melder/tmp/test/.git/rebase-apply/patch

When you have resolved this problem, run "git rebase --continue".
If you prefer to skip this patch, run "git rebase --skip" instead.
To check out the original branch and stop rebasing, run "git rebase --abort". 
```

如您所见，有 2000 多个空格错误，手动合并并不容易。

~~编辑：暂时不做合并我做了：~~

 ~~```
# git add -A
# git rebase --continue 
```~~  ~~编辑：没关系，这是一个愚蠢的想法。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2015-03-05T11:26:03.567

我今天遇到了同样的问题：由于空格错误引起的冲突，rebase 失败。`whitespace`在对选项 (`git rebase --whitespace=fix`和)进行不同设置的试验失败后`git rebase --whitespace=nowarn`，对我有用的解决方案是忽略递归合并策略中的尾随空格错误（`git rebase --abort`如果需要，首先运行任何运行的 rebase）：

```
git rebase -Xignore-space-at-eol <newbase> 
```

取决于空白错误、选项的类型`-Xignore-space-change`，`-Xignore-all-space`可能更有用。我不知道该选项`--ignore-whitespace`是否也有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T01:45:40.193

这不会回避问题。现在，您的文件中有冲突标记！

空格问题是警告，您不应该有尽可能多的合法冲突。如果文件难以解决，您可能需要手动重建它。这取决于你在做什么。

很多时候，这两个基础是如此不同，以至于您重新设置的每个提交都会使您处理这种可怕的冲突。我倾向于避开变基工作流程并订阅合并/重置。这就是我所做的： http: [//dymitruk.com/blog/2012/02/05/branch-per-feature/](http://dymitruk.com/blog/2012/02/05/branch-per-feature/)

如果您的问题只是行尾之类的空格问题，您可以尝试通过先在每一侧执行过滤器分支或交互式变基来清理存储库，以使每次提交的空格保持一致。

我也使用超越比较 3 或 Perforce Merge 来解决冲突。BC3 具有语法意识，应该最好地处理空格。很多时候，它甚至不会打开，因为它会为你解决冲突，你可以继续。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-12T16:02:17.337

今天我这样解决了这样一个问题：

```
REMOVE_AFTER="3cd7a0db76ff9dca48979e24c39b408c"
REPO="git@github.com:company/repo.git"
cd ~/tmp
git clone $REPO gitfix
cd gitfix
git checkout --orphan temp $REMOVE_AFTER
git commit -m "Truncated history"
git rebase --strategy=recursive --strategy-option=theirs --onto temp $REMOVE_AFTER master 
```

在 rebase 期间，如果您遇到`CONFLICT (modify/delete)`由已删除文件引起的冲突，您可以通过以下方式解决：

```
git rm path/to/both/deleted/file
git rebase --continue 
```

在 rebase 期间遇到其他冲突时，您需要手动修复它，然后：

```
git add path/to/conflict/file
git rebase --continue 
```

完成后，rebase 会说`All done.`Then you can:

```
git branch -D temp 
```

现在检查结果：

```
git log --format=oneline 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T05:03:49.703

我认为大多数差异查看器（特别是那些带有 GUI 的查看器）让您选择如何处理空白更改。

我建议你使用类似的东西`meld`来`git mergetool`自动更正这些冲突。启动时`meld`，设置它的空白处理策略（从面板的`Text filters`选项卡中`Preferences`），它将自动调整这些更改。~~

# c# - 保存在一列中的单独值

> ID：13463175
> 
> 赞同：0
> 
> 时间：2012-11-19T22:11:05.863
> 
> 标签：c#, asp.net

我有一栏。在该列中保存了一个人的全名（名字，姓氏）。有时它被保存为

```
Michael, Myers 
```

有时名称会像这样保存

```
Michael Myers 
```

它们之间没有逗号。

如果我加载该列并将其保存到一个变量中，它当然看起来像：`Michael, Myers`或`Michael Myers`。

问题是：如果我从数据库中加载列，如何将名字和姓氏彼此独立地保存在不同的变量中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:18:17.977

这是一场数据噩梦。我强烈建议在源头更正此问题（使用两个单独的列）并在可能的情况下修复一次数据。

假设它不是（或现在不是）：

通过尝试查找逗号并根据结果使用分支逻辑，您将得到大多数情况。但是，有许多边缘情况需要考虑。一种方法的概要是

```
string[] parts = theColumn.Trim().Split(',');
if (parts.Length == 1)
{
    // Find the last occurrence of ' ' and split first/last name based on that
    // People may have middle names entered e.g. Michael M. Myers
}
else if (parts.Length == 2)
{
    firstName = parts[1];
    lastName = parts[0];
}
else
{
    // Dealing with a more complex case like Myers, Jr., Michael
    // You will have to develop logic for such special cases that may
    // be in your data.
} 
```

您将遇到名称像 Michael Myers, Jr. 或 Michael Meyers, DDS 这样的单逗号大小写的问题。更完整的逻辑将测试这种情况。

当存在某种名称后缀时，您可能会在 Last, First 格式中遇到 2 个（或更多）逗号的情况。您将不得不决定花多少时间来清理那里的逻辑。就我个人而言，我倾向于记录几个月内发生的所有情况，以发展我的逻辑。

几年前我使用了一个产品，它很好地从自由格式的字段中提取名称并整理出名字、姓氏等。可能[值得一看](http://softwarecompany.com/dotnet/netgender.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:20:22.680

的可能值是`fullname`多少？鉴于你上面的例子，除了像下面这样的蹩脚的东西之外，没有好的、一致的方法可以将两者分开：

```
string firstName;
string lastName;
if(fullname.Contains(","))
{
    string[] splitNames = fullName.Split(",");
    lastName = splitNames[0];
    firstName = splitNames[1];
}
else if(splitNames.Contains(" "))
{
    string[] splitNames = fullName.Split(" ");
    firstName = splitNames[0];
    lastName = splitNames[1];
}
else
{
    //Some other logic.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:19:30.793

您可以对“，”进行字符串拆分。然后另一个字符串在“”上拆分。这将确保您已经涵盖了这两种情况。

但是，您*真正*想要做的是用一个大的木制物体击中您的 DBA，以便将两列塞进一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:38:46.277

正如其他人所说，用逗号分割是微不足道的。真正的问题是你不知道还有多少口味会出现。如果只有这两个

以下假设 sql server 是您的数据库，例如

```
Select 
Case 
 When CharIndex(',',[DaftNameField]) = 0 
 Then Substring([SomeNameField],CharIndex(',',[SomeNameField]),255)
else  Substring([SomeNameField],1, CharIndex(' ',[SomeNameField]) - 1)
end As Forename,
Case 
 When CharIndex(',',[SomeNameField]) = 0 
 Then Substring([SomeNameField],1 CharIndex(',',[SomeNameField]) - 1)
else  Substring([SomeNameField], CharIndex(' ',[SomeNameField]) + 1, 255)
end As Surname
From SomeTable 
```

这是我的头顶，但它基本上是正确的。

正如你所看到的已经很痛苦，加上中间名、敬语等，会变得更糟。

哦，请告诉我这张表中有某种 PersonID。

# java - 使用 String 变量访问类中的对象

> ID：13463177
> 
> 赞同：2
> 
> 时间：2012-11-19T22:11:11.500
> 
> 标签：java

我对 JAVA 相当陌生，但我正在开发一个程序，这是我遇到的问题，可能是一个简单的修复。

我提示用户为模拟 ATM 系统输入他们的 ID。

```
 {
            System.out.println("Enter an ID: ");
            Scanner input = new Scanner(System.in);
            String acctID = input.next();
            withdrawAccount(acctID);
            System.out.println(IDnum.getBalance());
            } 
```

代码还有更多内容，但目前无关紧要。将有几个 if 语句来查看用户想要执行的操作，即从他们的帐户中提取资金。在这个程序中，我想让用户在那里输入 ID 并将其保存为字符串并将其传递给 WithdrawAccount 方法。因此 acctID 将引用用户为帐户 ID 输入的任何内容。请注意，帐户 ID 与 Account 变量的名称相同。所以账户 0 的 ID 为 0。

```
 public static void withdrawAccount(String acctID)
            {
            System.out.println("Enter Withdraw Amount: ");
            Scanner input = new Scanner(System.in);
            double WithdrawAmount = input.nextDouble();
            acctID.setBalance(acctID.getBalance() - WithdrawAmount);
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:36:52.780

如果我正确理解您的问题，您希望将字符串 ID 与这些 ID 标识的帐户相关联。一种方法是使用地图：

```
private Map<String, Account> accountsById = new HashMap<String, Account>();

...

accountsById.put("1", account1);
accountsById.put("2", account2);
accountsById.put("3", account3);
... 
```

然后获取具有给定 ID 的帐户：

```
Account account = accountsById.get(idEnteredByTheUser); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:42:47.683

可能将它们存储到 ArrayList 或 Map 中最好保存它们。

当你调用withdraw方法时，你需要传递整个'Account'而不是一个字符串，这样你就可以使用类的'setBalance'方法准确地编辑他们的余额。

# javascript - Javascript中获取数字符号的最简单方法是什么？

> ID：13463180
> 
> 赞同：8
> 
> 时间：2012-11-19T22:11:20.563
> 
> 标签：javascript

> **可能重复：**
> [JavaScript 中的 Number.sign()](https://stackoverflow.com/questions/7624920/number-sign-in-javascript)

给定一些数字变量，确定它的符号的最简单方法是什么？

我一直以这样的代码结束：

```
var direction = (vector[0] > 0) ? 1: (vector[0] < 0) ? -1: 0; 
```

这似乎不太优雅，当我想要的只是数字为负时为 -1，如果为正则为 1，如果为 0 则为 0。

我所说的“最简单”是指优雅或更少的打字。

或者，也许有一种方法可以绝对增加价值。就像如果数字是负数，则从中减去 1，如果是正数，则将其加一。Math.abs() 提供绝对值，但是一旦运行 Math.abs() 就无法将其转换回有符号数。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-19T22:13:48.967

你可以这样做：

```
var sign = number && number / Math.abs(number); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-19T22:14:23.537

如何定义一个函数来做到这一点？

```
sign = function(n) { return n == 0 ? 0 : n/Math.abs(n); } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-19T22:13:37.610

您可以将数字除以其绝对值，您将得到符号：

```
var sign = number && number / Math.abs(number); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-19T22:22:10.723

如果您想要更短的方式，并且您知道它是一个数字，并且您不介意被限制在有符号的 32 位范围内，您可以这样做：

```
n ? -(n >>> 31) || 1 : 0; 
```

* * *

*   如果`n`是`0`，那么`0`
*   如果`n >>> 31`是`1`，它被签署，所以否定，并且将被否定`-1`
*   如果`n >>> 31`是`0`，它没有被签名，所以是肯定的，默认为`1`

# java - D'n'D 上的幽灵图像从 2d 画布到 3d 画布

> ID：13463182
> 
> 赞同：2
> 
> 时间：2012-11-19T22:11:27.627
> 
> 标签：java, image, swing, drag-and-drop, awt

我正在尝试创建重影图像，同时`awt.dnd`从程序顶部面板中的画布 2D 到也在程序中间面板中的画布 3D 执行操作。DnD 的东西已实现并使用`setDragImage()`. 我可以很容易地得到我的幻影图像，但我需要让它在 Java 1.6 上工作，因为 Java 1.6 缺少这个方法。

现在我尝试了很多玻璃面板等：

*   玻璃面板在 Canvas3D（重量级组件）上工作除外
*   如果我使用 AWT 玻璃面板（框架），它会绘制我的幻影图像，但整个程序都是黑色的

[GHOST 在多个窗口上拖放](http://free-the-pixel.blogspot.com.au/2010/04/ghost-drag-and-drop-over-multiple.html)：看到这个有趣的链接来创建一个`JDialog`，也创建了它，但我不知道如何让我的对话框不透明：`WindowsUtils.setOpaque(d, false);`我没有类，我找不到它。这是必要的，因为我需要光标上的这个 1 像素空间才能将注意力集中在我的 canvas3d 上。我希望任何人有任何建议我在谷歌上找不到任何对我的问题有用的东西，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:23:48.300

你要做很多工作。我不熟悉`canvas3d`or `canvas2d`，但正如你所说，它们似乎是重量级的组件，这些往往不支持透明度。

Per-Pixel Alphing 作为私有 API 被引入 Java 6.10，并从 Java 7 开始公开。

你可以访问私有API，但不推荐，下一个你需要问的问题是，当API不存在时该怎么办？！

```
public static void setOpaque(Window window, boolean opaque) {
    try {
        Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
        if (awtUtilsClass != null) {
            Method method = awtUtilsClass.getMethod("setWindowOpaque", Window.class, boolean.class);
            method.invoke(null, window, opaque);
        }
    } catch (Exception exp) {
    }
} 
```

# wcf - 将 WSDL 过滤为仅某些操作

> ID：13463184
> 
> 赞同：6
> 
> 时间：2012-11-19T22:11:32.920
> 
> 标签：wcf, wsdl

我有一个巨大的 WSDL，但我只需要其中的几个方法。

是否可以仅为这些方法生成 WCF 代理？

“完全实现”为我的 DLL 添加了 9 兆字节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:19:20.900

您可以手动构建数据协定和仅包含您感兴趣的操作的接口，然后将该接口与[ChannelFactory](http://msdn.microsoft.com/en-us/library/ms576132.aspx)一起使用来创建一个仅针对这些操作的基本客户端，或者...

...您还可以从您不需要的所有操作和元素中剥离 WSDL，并将结果提供给 svcutil.exe 以创建更简单的客户端。一种更安全的方法是将大型 WSDL 提供给 svcutil.exe 并从生成的代码中去除不需要的内容（这样更安全，因为如果您删除了不应该删除的内容，编译器会立即通知您）。

无论哪种方式，我认为您将不得不执行一些手动干预。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:11:02.847

svcutil 有一个`/excludeType`标志。它可以在元数据导出和类型生成期间使用。

从 svcutil 命令行帮助：

> /excludeType: - 从导出或验证中排除的完全限定或程序集限定类型名称。导出服务或一组服务合同的元数据时可以使用此选项，以排除类型被导出。此选项不能与 /dataContractOnly 选项一起使用。（简称：/et）

[如何使用 svcutil.exe 导出单个合同的元数据](https://stackoverflow.com/questions/1433540/how-do-i-export-metadata-for-a-single-contract-with-svcutil-exe)？用它来解决一个类似的问题。

我希望类型过滤对你有用，因为我不知道“开箱即用”的方法来做到这一点。

# .net - 我的 Windows XP 目标 .Net 框架

> ID：13463185
> 
> 赞同：1
> 
> 时间：2012-11-19T22:11:38.067
> 
> 标签：.net

我需要将我的 C# 应用程序定位到至少在 Windows XP 或更高版本上运行

该应用程序针对家庭用户，他们中的一些人不愿意在他们的计算机上安装额外的框架，

所以我试图针对大多数用户拥有的框架。

我的应用程序甚至可以使用 2.0，但是我需要使用的一些第三方库（在我的例子中是 NetSparkle）需要至少 4.0 的目标

考虑到我需要我的应用程序准备好在 Windows XP 上运行，定位框架 4 是一个不错的选择吗？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:13:42.377

如果您需要 .NET 4 来满足您的要求，那么您将别无选择。您需要至少定位 4.0 才能使用这些库。

话虽如此，.NET 4 并未包含在 Windows XP 中，因此您至少需要在应用程序部署中包含 Web 框架安装程序。这允许没有 .NET 4 的用户安装您的应用程序并正确运行它。

就个人而言，我发现强加一个框架安装远比试图从一个你可以使用的库中复制功能的限制要小得多，所以我几乎不担心将 .NET 4 强加给用户，但这是我的观点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:21:11.100

Windows XP 不附带任何版本的 .Net Framework。在您的应用程序可以使用之前，您的目标版本必须安装在 XP 机器上。我会说，更有可能已经安装了旧版本的框架，但显然不能保证。

我会更多地根据您需要的功能来决定您的决定，并为您的软件所需的框架提供一个安装程序。

# asp.net - 如何使用 If Not File.Exists 覆盖现有的 XML 文件

> ID：13463191
> 
> 赞同：0
> 
> 时间：2012-11-19T22:12:06.910
> 
> 标签：asp.net, file, exists, xmlwriter

我正在尝试覆盖现有的 XML 文件。如果文件存在，它不会被覆盖。我在这里检查一下。为什么不被覆盖。我错过了什么？

这是我的代码

```
 Dim settings As New XmlWriterSettings()
        settings.Indent = True

        Dim FilePath As String = "\\server02\me_public$\audits\alert-special-reports.xml"

        If Not File.Exists(FilePath) Then
            Dim writer As XmlWriter = XmlWriter.Create(FilePath, settings)

            writer.WriteStartDocument()
            writer.WriteStartElement("audits")
            writer.WriteStartElement("alert-special-reports")
            writer.WriteElementString("title", "Alert and Special Reports")
            writer.WriteElementString("rsslink", "http://www.me.org/rss/alert-special-reports.xml")
            While dr.Read()

                writer.WriteStartElement("item")
                writer.WriteElementString("title", dr.GetString(dr.GetOrdinal("Title")))
                writer.WriteElementString("description", dr.GetString(dr.GetOrdinal("Description")))
                Dim dateNew As String = "", linkNew As String = ""
                Dim DTNew As DateTime
                Dim PDF As String = ""
                DTNew = dr.GetDateTime(dr.GetOrdinal("PubDate"))
                PDF = dr.GetString(dr.GetOrdinal("FilePath"))
                dateNew = DTNew.ToLongDateString()
                linkNew = "" & PDF & ""
                writer.WriteElementString("link", linkNew)
                writer.WriteElementString("pubdate", dateNew)
                writer.WriteEndElement()

            End While
            writer.WriteEndElement()
            writer.WriteEndElement()
            writer.WriteEndDocument()
            writer.Flush()
            writer.Close()
            dr.Close()
        End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:18:51.943

如果您忘记关闭现有的打开流，可能会发生这种情况。您可以尝试使用其中的重载版本，`XMLWriter.Create`而`stream`不是`string`使用该`File.Create`方法。类似于以下内容

```
Dim writer As XmlWriter = XmlWriter.Create(File.Create(FilePath), settings) 
```

# c++ - 是什么导致了这个太少的参数错误？

> ID：13463195
> 
> 赞同：1
> 
> 时间：2012-11-19T22:12:19.620
> 
> 标签：c++

我正在努力从键盘获取输入并将它们传递给 C++ 中的变量。我得到的参数错误太少。

```
#include <stdio.h>
void_fullname(char fname, char lname) {
    printf("Enter Your First Name\n");
    scanf( "%d", &fname );
    printf("Enter Your Last Name\n");
    scanf( "%d", &lname );
    printf("Welcome: %d\n",First Name + Last Name)\n");
}

int main() {
    printf( "1.Full Name\n" );
    printf( "2.Exit\n" );
    scanf( "%d", &input );
    switch ( input ) {
        case 1:          
            void_fullname();
            break;
    }

    getchar();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T22:17:16.540

很难弄清楚你对什么感到困惑。你写了一个有两个参数的函数，`void_fullname(char fname, char lname)`然后你用零参数调用它，`void_fullname();`编译器然后告诉你你做错了什么。也许阅读一本关于 C++ 的介绍性书籍会有所帮助？

恐怕您的代码中还有许多其他错误，一旦您解决了编译器错误，您就会发现。

这里有几个小窍门，

1)`char`表示单个字符，而不是字符序列。对于名称之类的东西，您需要一个字符数组或一个字符串。

2)`%d`不是读取字符数据的正确格式说明符。

3) 当你希望在函数的参数中返回数据时，你应该传递一个指针或对该函数的引用。

等等......我认为你应该从更简单的开始。例如，您可能会发现这更容易，而无需编写除 main 之外的任何函数。当你先让它在没有函数的情况下工作时，稍后添加一些函数。慢慢开始，逐步建立。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:16:07.327

你没有给出`void_fullname()`任何论据

```
switch ( input ) {
    case 1:          
    void_fullname(); // Need args here
    break; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:14:26.033

此函数需要两个参数，`fname`并且`lname`

```
case 1:          
    void_fullname(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:15:00.523

您在没有任何参数的情况下调用 void_fullname，它需要 2 个参数。

# android - android模拟器没有启动，avd

> ID：13463197
> 
> 赞同：13
> 
> 时间：2012-11-19T22:12:28.440
> 
> 标签：android, linux, ubuntu, emulation, avd

这是我的情况：我在 Ubuntu 10.04 LTS 64 位下有一个 XPS

我用 eclipse 下载了最新的 Android SDK。SDK 工作正常，但是当我创建一个新的 AVD 并运行时。我的 AVD 加载但未显示。我不明白，你对我的问题有想法吗？

谢谢

我从命令行开始我的 avd ：

```
romain@XPS-Dak:~/.android$ emulator -verbose -avd Test
emulator: found SDK root at /home/romain/android-sdk-linux
emulator: Android virtual device file at: /home/romain/.android/avd/Test.ini
emulator: virtual device content at /home/romain/.android/avd/Test.avd
emulator: virtual device config file: /home/romain/.android/avd/Test.avd/config.ini
emulator: using core hw config path: /home/romain/.android/avd/Test.avd/hardware-qemu.ini
emulator: Found AVD target API level: 3
emulator: 'magic' skin format detected: 1024x600
emulator: autoconfig: -skin 1024x600
emulator: autoconfig: -skindir (null)
emulator: keyset loaded from: /home/romain/.android/default.keyset
emulator: found SDK root at /home/romain/android-sdk-linux
emulator: trying to load skin file '/home/romain/android-sdk-linux/tools/lib/emulator/skins/dynamic//layout'
emulator: loaded dynamic skin width=1024 height=600 bpp=16

emulator: autoconfig: -kernel /home/romain/android-sdk-linux/platforms/android-3/images//kernel-qemu
emulator: autoconfig: -ramdisk /home/romain/android-sdk-linux/platforms/android-3/images//ramdisk.img
emulator: Using initial system image: /home/romain/android-sdk-linux/platforms/android-3/images//system.img
emulator: autoconfig: -data /home/romain/.android/avd/Test.avd/userdata-qemu.img
emulator: autoconfig: -initdata /home/romain/.android/avd/Test.avd/userdata.img
emulator: autoconfig: -cache /home/romain/.android/avd/Test.avd/cache.img
emulator: Physical RAM size: 512MB

Content of hardware configuration file:
  hw.cpu.arch = arm
  hw.ramSize = 512
  hw.screen = touch
  hw.mainKeys = no
  hw.trackBall = no
  hw.keyboard = yes
  hw.keyboard.lid = yes
  hw.keyboard.charmap = qwerty2
  hw.dPad = no
  hw.gsmModem = yes
  hw.gps = yes
  hw.battery = yes
  hw.accelerometer = yes
  hw.audioInput = yes
  hw.audioOutput = yes
  hw.sdCard = no
  disk.cachePartition = yes
  disk.cachePartition.path = /home/romain/.android/avd/Test.avd/cache.img
  disk.cachePartition.size = 66m
  hw.lcd.width = 1024
  hw.lcd.height = 600
  hw.lcd.depth = 16
  hw.lcd.density = 160
  hw.lcd.backlight = yes
  hw.gpu.enabled = no
  hw.camera.back = emulated
  hw.camera.front = none
  vm.heapSize = 16
  hw.sensors.proximity = yes
  hw.sensors.magnetic_field = yes
  hw.sensors.orientation = yes
  hw.sensors.temperature = yes
  kernel.path = /home/romain/android-sdk-linux/platforms/android-3/images//kernel-qemu
  kernel.parameters =  android.checkjni=1
  disk.ramdisk.path = /home/romain/android-sdk-linux/platforms/android-3/images//ramdisk.img
  disk.systemPartition.initPath = /home/romain/android-sdk-linux/platforms/android-3/images//system.img
  disk.systemPartition.size = 200m
  disk.dataPartition.path = /home/romain/.android/avd/Test.avd/userdata-qemu.img
  disk.dataPartition.size = 200m
  avd.name = Test
.
QEMU options list:
emulator: argv[00] = "/home/romain/android-sdk-linux/tools/emulator64-arm"
emulator: argv[01] = "-android-hw"
emulator: argv[02] = "/home/romain/.android/avd/Test.avd/hardware-qemu.ini"
Concatenated QEMU options:
 /home/romain/android-sdk-linux/tools/emulator64-arm -android-hw /home/romain/.android/avd/Test.avd/hardware-qemu.ini
emulator: registered 'boot-properties' qemud service
emulator: nand_add_dev: system,size=0xc800000,initfile=/home/romain/android-sdk-linux/platforms/android-3/images//system.img
emulator: mapping 'system' NAND image to /tmp/android-romain/emulator-wbnmYS
emulator: rounding devsize up to a full eraseunit, now c810000

emulator: nand_add_dev: userdata,size=0xc800000,file=/home/romain/.android/avd/Test.avd/userdata-qemu.img
emulator: rounding devsize up to a full eraseunit, now c810000

emulator: registered 'boot-properties' qemud service
emulator: Adding boot property: 'dalvik.vm.heapsize' = '16m'
emulator: Adding boot property: 'qemu.sf.lcd_density' = '160'
emulator: Adding boot property: 'qemu.hw.mainkeys' = '0'
emulator: Adding boot property: 'qemu.sf.fake_camera' = 'back'
emulator: nand_add_dev: cache,size=0x4200000,file=/home/romain/.android/avd/Test.avd/cache.img
emulator: Initializing hardware OpenGLES emulation support
Erreur de segmentation (core dumped) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-19T23:05:16.207

你遇到了和我一样的问题，在[这个问题](http://code.google.com/p/android/issues/detail?id=34233)中有所概述。`libOpenglRender.so`在您的 SDK目录中找到您的`tools/`，并将其重命名为其他名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-03T18:08:19.540

不是解决OP的确切问题，而是解决“android模拟器无法启动，avd”。

确保没有其他东西可以竞争虚拟化。

我运行了一个无头 Virtual Box 映像并经历了类似的行为。它会显示为已启动，但模拟器不可见。`./emulator -verbose -avd ...`永远不会完成。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-11-19T22:26:26.987

在第一次运行时您需要耐心等待。加载需要一段时间。

# winapi - 如何使用所有者绘制的富编辑控件

> ID：13463198
> 
> 赞同：1
> 
> 时间：2012-11-19T22:12:31.770
> 
> 标签：winapi

我在 Windows 上使用富编辑控件。我尝试将值传递`SS_OWNERDRAWN`给`CreateWindowEx`调用，但它似乎没有任何效果。如何防止富编辑控件绘制任何内容以便我可以拥有它？

我还尝试设置一个简单地忽略`WM_PAINT`但转发所有其他消息的窗口子类。这对我的整个系统产生了非常恶劣的影响，还导致我的应用程序停止。

编辑：显然，系统仍然期望 BeginPaint 和 EndPaint 响应 WM_PAINT，即使您返回 0 并且不绘制任何内容。我的系统不再死机，我的应用程序不再停止，富编辑当然不再绘制任何东西，但我仍然无法在该区域呈现我的 Direct3D9 文本。:(

编辑：事实证明，事实上，您不拥有由 .返回的 DC 的所有权`ID3DXFont::GetDC()`。文档不清楚，但问题已解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:53:49.387

RichEdit 控件不支持所有者绘图窗口样式，因此您不能使用`SS_OWNERDRAWN`或类似。

至于`WM_PAINT`，简单地忽略绘画消息不应该造成如此严重的副作用，所以你一定做错了什么。

# wpf - 图像在运行时不显示

> ID：13463200
> 
> 赞同：2
> 
> 时间：2012-11-19T22:12:41.230
> 
> 标签：wpf, image, xaml

我有一个名为 Guitar 的 WPF 项目，guitar.png 图像确实显示在视觉工作室。但是每当我运行项目时，图像在运行时都不会显示。这是要了我的命。

```
<Image Canvas.Left="640" Canvas.Top="297"  Name="guitar" Source="/Guitar;component/guitar.png" Stretch="None"/> 
```

以前有没有人有同样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:16:02.503

将图像源设置为“guitar.png”后，它可以工作。

# mysql - SQL - 昨天的日期

> ID：13463203
> 
> 赞同：0
> 
> 时间：2012-11-19T22:12:43.003
> 
> 标签：mysql, sql

我有一个 SQL 查询：

```
SELECT ....
WHERE CalendarDateTime.StartDate >= NOW() 
```

我怎样才能将`NOW()`零件更改为昨天的参考？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T22:13:44.427

```
SELECT ....
WHERE CalendarDateTime.StartDate >= NOW() - INTERVAL 1 DAY 
```

但我想`StartDate`是一个日期，而您真正想要的是包括今天的事件，您当前的解决方案仅在午夜执行。在这种情况下，更合适的解决方案是：

```
SELECT ....
WHERE CalendarDateTime.StartDate >= DATE(NOW()) 
```

# java - 又一个 NoClassDefFoundError 难题

> ID：13463204
> 
> 赞同：0
> 
> 时间：2012-11-19T22:12:58.967
> 
> 标签：java, noclassdeffounderror

我创建了两个 jar 文件 my.common.jar，其中包含辅助类和方法（主要是静态方法）。我还创建了一个 jar 文件 test.jar，其中包含一个调用 my.common.jar 中的类中的静态方法的 main 方法。

当我像这样启动 main 时，一切正常：

```
java -classpath path/to/myjars/my.common.jar:./test.jar test.Tester 
```

Tester 是 test.jar 中包含方法 main 的类。

但是`NoClassDefFoundError my/common/Myclass`当我以这种方式运行它时，我得到了：

```
java -classpath path/to/myjars/my.common.jar -jar test.jar 
```

我非常努力，但我无法弄清楚它失败的原因或如何解决这个问题。我很感激你的帮助。

----- 附录 ---- 我忘了提到 test.jar 中的清单文件是这样的：

```
 Manifest-Version: 1.0
    Build-Jdk: 1.6.0_13
    Created-By: Apache Maven
    Main-Class: test.Tester
    Archiver-Version: Plexus Archiver 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:16:44.903

您不能在命令行上同时使用`-classpath`和选项。`-jar`使用其中一种……但不能同时使用。

当您使用该`-jar`选项时，该命令期望在 JAR 文件清单中找到入口点类和运行时类路径。您的`-classpath`参数将被忽略，CLASSPATH 环境变量也将被忽略。从[`java`手册页](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html)引用：

> “使用此选项时，JAR 文件是所有用户类的来源，其他用户类路径设置将被忽略。”

如果您的（可执行）JAR 文件需要使用其他 JAR 中的内容，那么它需要`Class-Path`清单中的属性。这个属性值是一个空格分隔的 URL 列表；看[这里](http://docs.oracle.com/javase/7/docs/technotes/guides/jar/jar.html#Main_Attributes)。

所以在你的情况下，你需要在你的 JAR 清单中添加这样的东西：

```
Class-path: /path/to/myjars/my.common.jar 
```

[Java 教程的这一页](http://docs.oracle.com/javase/tutorial/deployment/jar/downman.html)涵盖了该主题，并包含警告，即`Class-path`清单行必须以 CR 或 NL 正确终止，以便 JVM 识别它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:20:27.330

将清单放入 test.jar。其他 jars 通常进入 ./lib 目录。要将 META-INF/MANIFEST.MF 添加到 jar 中，通常可以使用构建基础结构：ant 或 maven。或者手动进行。

Main-Class: test.Tester 已经有了它。现在类路径：...

在 Maven 中，依赖项通常添加到 pom.xml 中的 jar 中。您可以使用 mvn 将您自己的 jar 放入您的存储库中。然后在 pom.xml 中为其添加依赖项。

# c# - 当我尝试构建它时，Visual Studio 会执行一些东西。我如何找出留在这背后的代码？

> ID：13463205
> 
> 赞同：4
> 
> 时间：2012-11-19T22:13:01.790
> 
> 标签：c#, visual-studio-2010, msbuild

如标题所示，我从 github 下载了一个程序，但是当我尝试构建它时，它说：

> 命令 ""E:\LoLNotes\LoLNotes\Properties\GitExport.exe" "E:\LoLNotes\" "E:\LoLNotes\LoLNotes\"" 以代码 2 退出。

GitExport.exe 不起作用，因为我没有安装 git。但我想知道，我如何在程序源中找到一个位置，该代码在哪里执行？简单的 ctrl-f 和搜索解决方案不起作用，所以我认为它可能隐藏在配置文件中的某个地方？有谁知道它可能在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T22:15:12.287

这可能是 Post 或 Pre Build 事件。

在项目中，打开“属性”，然后查看“构建事件”选项卡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T22:15:35.780

在解决方案资源管理器中，右键单击项目并选择属性。然后在 Build Events 部分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-19T22:21:22.317

它也可以是项目文件自定义的一部分（类似于 nuget 所做的）。为了准确找出它被触发的位置，请在 Tools\Options\Projects and Solutions\Build and Run 中将项目构建输出详细程度打开到诊断。然后重建并搜索 GitExport.exe 的输出。这应该给你一个更好的背景，了解它发生在哪里。![在此处输入图像描述](../Images/97ff913485c7a548ba86136c9c38be7b.png)

# python - 如何通过 TOR 和 Privoxy 使用 Python 请求获取 HTTPS 内容

> ID：13463206
> 
> 赞同：2
> 
> 时间：2012-11-19T22:13:12.563
> 
> 标签：python, proxy, tor, python-requests

我在我的系统上使用 Privoxy 设置了 TOR，该 Privoxy 已经过测试并且运行良好。我要做的是通过此设置代理 HTTPS 请求，以便这些 GET 和 POST 来自 TOR。以下是我可以生成的最简单的代码版本：

```
import requests
proxy = { 'http':'127.0.0.1:8118','https':'127.0.0.1:8118' }
r = requests.get('https://www.whatismyip.com/',proxies=proxy)
#r = requests.get('http://www.whatsmyip.org/')
print r 
```

使用 HTTPS 时，我没有收到响应正文（r.content 为空白），但我确实收到了 200 状态代码，并且我可以在 Privoxy 日志中看到请求发出。[我在这个](https://stackoverflow.com/questions/13005301/https-proxy-support-in-python-requests-library)线程上看到了一个错误，但似乎几个月前在 Requests 库中用[this](https://github.com/kennethreitz/requests/pull/478)解决了这个问题。

我的 privoxy 设置是基本设置，并设置为在 localhost 上侦听，并添加了以下两行：

```
forward-socks4a / localhost:9050 .
forward-socks5 / localhost:9050 . 
```

在这一点上，我不确定发生了什么，但我所做的一切似乎都不起作用。我在 Python 2.6.5 上使用最新的请求库和 urllib3。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T19:08:55.300

HTTPS 代理尚未被`urllib3`（由 使用`requests`）正确支持。

有关详细信息，请参阅[请求问题 905](https://github.com/kennethreitz/requests/issues/905)和[urllib3 问题 50](https://github.com/shazow/urllib3/issues/50)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-26T04:28:56.900

Try [`requesocks`](https://github.com/dvska/requesocks)，一个设计用于直接连接到 SOCKS 代理的分支`requests`（就像 Tor 一样，一开始就没有使用 Privoxy。如果你特别需要 Privoxy，你可能不走运，否则，请`pip install requesocks`替换

```
import requests 
```

和

```
import requesocks
requests = requesocks.session()
requests.proxies = {"http": "socks5://127.0.0.1:8118",
                   "https": "socks5://127.0.0.1:8118"} 
```

现在，该`requests`变量是一个会话（与`requests.get()`朋友一起），您可以以与直接导入完全相同的方式使用它`requests`。

# magento - Magento 多国/多域设置

> ID：13463215
> 
> 赞同：1
> 
> 时间：2012-11-19T22:13:27.313
> 
> 标签：magento, nginx, multiple-domains

这是场景：

-我有一个朋友拥有一个 magento 网站，例如 abcd.co.uk。- 他们想将业务扩展到其他一些欧洲国家，因此他们购买了 abcd.at、abcd.be、abcd.de 等域名 - 他们希望使用相同的目录、相同的界面、相同的所有这些域名上可用的一切除了货币（这将是自动汇率转换）、商店地址、帮助联系地址等 - 没有语言翻译要求。一切都将是英文

在阅读了大量的论坛和帮助手册之后，我们做了以下工作：-为每个域创建了 1 个网站、1 个商店和 1 个商店视图。- 在网站级别配置他们的网址和货币。-在magento主安装中创建了一个名为stores的文件夹，并在该文件夹内为每个域创建了单独的文件夹。- 将 index.php 和 .htaccess 文件复制到每个文件并配置它们（稍后意识到 .htaccess 文件配置是徒劳的，因为 vps 使用的是 nginx）。

问题 01\. 这是我们需要的正确方法吗？还是我们错过了什么或遵循了任何不必要的步骤？问题02：如果这是正确的方法，可以解释一下，逐步完成其余步骤（使用nginx的虚拟主机配置和任何其他必要的步骤，好吗？

正如我所提到的，我做了功课，发现了大量关于如何设置 Apache 的信息，但关于 nginx 设置的信息非常零散。更糟糕的是，我对nginx一无所知

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T09:11:13.233

我曾经有过类似的任务。我所做的是：

1.  单个 magento 文件夹，单个 index.php。
2.  Magento 有多个网站/商店/商店视图，具有正确的 URL 域、货币、根类别设置。
3.  index.php 文件配置为根据域运行 store_view。

那么如何进行这种“调度”呢？[此处](http://www.crucialwebhost.com/blog/how-to-setup-multiple-magento-stores/#parked-domain-method)对其进行了描述。

# objective-c - 为什么从 Google Data Objective-C 客户端库子类化 GDataEntryBase 时出现“无法识别的选择器”错误？

> ID：13463216
> 
> 赞同：5
> 
> 时间：2012-11-19T22:13:27.987
> 
> 标签：objective-c, xcode4.3, google-data-api, google-provisioning-api

我已经构建了[Google Data APIs Objective-C 客户端库](http://code.google.com/p/gdata-objectivec-client/)，并让它链接并与我的应用程序（包括 GTMOAuth2）一起工作，并且可以拉回数据。我需要使用[Provisioning API](https://developers.google.com/google-apps/provisioning/)（仍然只有 XML），所以我在自己的应用程序中构建了我需要的附加功能。我想我终于弄清楚了所有这些是如何工作的，并且我*非常*接近阅读自定义元素，但我错过了一些东西。

我已经对 , 进行了子类化`GDataServiceGoogle`，`GDataEntryBase`并且`GDataFeedBase`正在获取正确的数据。我从一个简单直接的元素类型开始：`quota`. 在用户提要中，配额元素如下所示：

```
<apps:quota limit="2048"/> 
```

因此，我添加了以下值构造：

```
@interface GDataQuotaProperty : GDataValueConstruct <GDataExtension>
+ (NSString *)extensionElementURI;
+ (NSString *)extensionElementPrefix;
+ (NSString *)extensionElementLocalName;
@end

@implementation GDataQuotaProperty
+ (NSString *)extensionElementURI       { return kGDataNamespaceGApps; }
+ (NSString *)extensionElementPrefix    { return kGDataNamespaceGAppsPrefix; }
+ (NSString *)extensionElementLocalName { return @"quota"; }
@end 
```

我在我的`GDataEntryBase`子类中添加了以下方法：

```
- (GDataQuotaProperty *)quota;
- (void)setQuota:(GDataQuotaProperty *)val; 
```

实现如下：

```
- (GDataQuotaProperty *)quota {
    return [self objectForExtensionClass:[GDataQuotaProperty class]];
}

- (void)setQuota:(GDataQuotaProperty *)val {
    [self setObject:val forExtensionClass:[GDataQuotaProperty class]];
} 
```

正如（我一直在使用,和作为参考实现）[中的评论中所述`GDataObject.h`](http://code.google.com/p/gdata-objectivec-client/source/browse/trunk/Source/BaseClasses/GDataObject.h)，在我的子类中，我实现如下：`GDataServiceGoogleCalendar``GDataEntryCalendar``GDataFeedCalendar``GDataBaseEntry``addExtensionDeclarations`

```
- (void)addExtensionDeclarations {
    [super addExtensionDeclarations];

    Class entryClass = [self class];

    // User extensions
    [self addExtensionDeclarationForParentClass:entryClass
                                   childClasses:[GDataQuotaProperty class], nil];
} 
```

但是，当我尝试`quota`在回调中按如下方式调用该方法时：

```
GDataTextConstruct *titleTextConstruct = [user title];
NSString *title = [titleTextConstruct stringValue];
GDataQuotaProperty *quotaConstruct = [user quota];
NSString *quota = [quotaConstruct stringValue]; 
```

我得到一个异常和这个错误：

```
2012-11-19 12:42:22.667 Google Apps Open Directory Sync[47679:903] -[GDataEntryBase quota]: unrecognized selector sent to instance 0x2836d0 
```

在上面的示例中，我确实`title`正确地返回了用户名（元素的）而没有错误。此外，该`user`对象实际上是我的`GDataEntryBase`子类的类型，而不是`GDataEntryBase`它本身（在调试器中验证），加上我的子类中的`classForEntries`方法`GDataFeedBase`正确地返回了我的子类的类`GDataEntryBase`）所以在这两者之间它*真的*必须是正确的班级。我的`GDataEntryBase`子类`quota`方法上有一个断点，它永远不会被绊倒，那么我在这里缺少什么？

如前所述，我一直在与 Calendar 的 Service/Feed/Entry 实现（特别是`accessLevel`&`color`元素和方法）进行比较，只是没有看到我缺少的内容。

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:43:08.270

虽然我已经`classForEntries`在我的子类中实现了该方法`GDataFeedBase`并从中正确返回了我的子类的`GDataEntryBase`类，如下所示：

```
- (Class)classForEntries {
    return [GDataEntryUser class];
} 
```

我错过了`standardKindAttributeValue`在同一`GDataFeedBase`个子类中的实现，它应该返回适​​当的类别架构 URL（在 Google Provisioning API 用户提要的情况下为“http://schemas.google.com/apps/2006#user”） . 所以，我实现如下（虽然我实际上使用了一个常量）：

```
+ (NSString *)standardKindAttributeValue {
    return @"http://schemas.google.com/apps/2006#user";
} 
```

一旦`addExtensionDeclarations`,`classForEntries`和`standardKindAttributeValue`都正确实现，`GDataEntryBase`就能够正确确定我的子类应该用于提要中的对象，因此我的选择器被识别。

非常感谢 Google 的 Greg Robbins[在 Google Data APIs Objective-C Client Libraries 讨论组的这个线程中](https://groups.google.com/d/msg/gdata-objectivec-client/zbwzYKDTlgE/mWugfn-Ix9oJ)为我指明了正确的方向。

# ruby-on-rails - FactoryGirl 未注册（只有一家工厂遇到此问题）

> ID：13463223
> 
> 赞同：0
> 
> 时间：2012-11-19T22:13:50.587
> 
> 标签：ruby-on-rails, rspec, factory-bot

我有三个模型：用户、站点和护照。

用户和网站彼此拥有并属于彼此，而护照是带有几个额外列的连接模型。

我已经尝试了以下两种方法：

1.

```
FactoryGirl.define do
  factory :passports do
    association :site, factory: :site
    association :user, factory: :user
    access_token 'mock_token'
  end
end 
```

2.

```
FactoryGirl.define do
  factory :passports do
    access_token 'mock_token'
  end
end 
```

无论哪种方式，我都在使用它：

```
let(:site) { FactoryGirl.create :site }
let(:user) { FactoryGirl.create :user }
let(:site_user) { FactoryGirl.create :site_user, site: site, user: user }
let(:passport) { FactoryGirl.create :passport, user: user, site: site } 
```

请不要问为什么同时存在 site_user 和 passport..这需要一段时间来解释。

谢谢！

最大限度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:28:23.270

所以，回顾一下：

```
# Sites
has_many :passports
has_many_and_belongs_to :users, :through => :passport

# User
has_many :passports
has_many_and_belongs to :sites, :through => :passport

# Pasport
belongs_to :site
belongs_to :user
# has a few other things going on as wel 
```

我*认为*你应该能够做类似的事情

```
FactoryGirl.define do
  factory :user do
    # details go here
  end

  factory :site_with_users do
    users { |site| [site.association(:user), site.association(:user)] }
  end
end 
```

然后你应该可以做

```
let( :site_with_users ) { FactoryGirl.create :site_with_users } 
```

不过这些都是猜测，希望对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:42:36.963

OMFG 这太蠢了……

切换到 Factory.define :passport do |f| 语法使它工作......

消除一个半小时生产力的好方法

# ssis - 数据流性能 - 主键更新

> ID：13463224
> 
> 赞同：0
> 
> 时间：2012-11-19T22:13:52.070
> 
> 标签：ssis

我有一个数据流任务，它更新表中包含 250k 条记录的记录。正在使用主键进行更新。SSIS 是否需要 3 秒。

1.  有没有办法提取为记录评估的确切 sql（任何记录，我只想要一个可靠的例子）

当我模拟我合理认为是正确的 sql 并在 SSMS 中运行它时，它需要 0.0 秒（记录正在通过 SSIS 包更新，所以我很确定它正在做我认为它正在做的事情）

1.  什么可能需要 3 秒。它似乎特定于 SSIS。我的理由是 SSMS 执行得如此之快。它不是数据库。

我在钓鱼，我承认，但谷歌并没有帮助我。有人有什么建议吗？

谢谢

格雷格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:31:09.610

开箱即用的更新组件 OLE DB 命令组件执行逐行 (RBAR) 更新。这通常不会提供良好的性能。更好的更新模式是将更改暂存到“正常”目标（OLE DB 目标或 ADO .NET 目标）。数据流任务完成后，使用执行 SQL 任务对这些行执行基于集合的更新。阅读[Stairway to Integration Services](http://www.sqlservercentral.com/stairway/72494/)系列，尤其是第 4 级以了解此模式。

除了我上面提到的更新问题之外，SSIS 更新与 SSMS 更新之间的区别在于 SSMS 只是要运行一个脚本并退出。SSIS 不只是“去”。它有一个相当复杂的处理模型，因此它需要验证包处于正确的状态、资源是否可用等。如果您正在记录事件（并且应该记录），请为您的任务捕获 OnPreExecute 和 OnPostExecute。这将显示 SSIS 在包中的特定步骤上花费了多长时间。请注意，出于计时目的，从 Visual Studio (BIDS/SSDT) 中运行包将比命令行版本慢，因为它必须启动并管理调试资源（并显示漂亮的框更改颜色/接收复选标记）。

还想知道发生了什么吗？打开 SQL Profiler，您可以从 SSIS 包中捕获所有 SQL Server 活动。如果您长时间捕获生产服务器上的所有内容，请注意这可能产生的影响。如果您使用自己喜欢的搜索引擎，有大量可用资源解释如何运行分析器。

# javascript - 如何使用 em 和字体大小百分比准确调整嵌套元素的大小？

> ID：13463226
> 
> 赞同：1
> 
> 时间：2012-11-19T22:13:55.163
> 
> 标签：javascript, css, percentage, font-size, em

我有一个带有每个图像的文本框的轮播，我的客户（对 HTML 一无所知）使用所见即所得的文本编辑器编辑文本框。由此产生的输出类似于你最糟糕的噩梦；就像是：

```
<div class="carousel-text-container">
<span style="font-size:18pt;">
    <span style="font-weight:bold;">
         Lorem 
         <span style="font-size:15pt;">Dolor</span>
     </span>
    Ipsum
    <span style="font-size:19pt;">
         <span>&nbsp;</span>
         <span>Sit<span>Amet</span></span>
    </span>
</span>
</div> 
```

这个网站必须以 3 种不同的尺寸显示以适应较小的显示器，所以我一直在使用 CSS 媒体查询来调整网站的大小。

现在我无法正确调整文本框中的文本大小。我曾尝试使用`jQuery.fn.css`获取 中每个元素的字体大小`px`，然后将其转换为`em`. 然后，通过在`font-size:x%`上设置一种声明`.carousel-text-container`，我希望这会正确调整所有内容的大小。

不幸的是，字体大小在 ems 中的应用似乎具有递归性质。也就是说，`.example`在下面没有正确调整大小，因为它的父级也在影响它

```
<span style="font-size:2em;">
    Something
    <span class="example" style="font-size:1.5em;">Else</span>
</span> 
```

如何可靠且精确地调整所有内容的大小，以便为所有子级实现原始字体大小、边距、填充、行高等的真实百分比`.carousel-text-container`？

现在，我正在想象某种递归 JavaScript 函数：

```
var carouselTextBoxEl;
function resizeCarouselTextBox () {
    // some example numbers thrown in
    var newWidthRatio = .8,
    function resizeCarouselTextBoxEl (el, nestedLevelNum) {
        nestedLevelNum = nestedLevelNum || 1;

        var childElFontSizePxStr = parseFloat(el.css('font-size')), // 16.2984392, for example
            // calculate new font size based on
            // width ratio of original size site to new size,
            // and do something with nestedLevelNum... what's the math with that?
            newChildElFontSizePxStr = childElFontSizePxStr * newWidthRatio,
            // get children of el, if any
            elChildrenEls = el.children(),
            i = elChildrenEls.length;

            el.css('font-size', newChildElFontSizePxStr + 'em');               
            while (--i >= 0) {
                resizeCarouselTextBoxEl(elChildrenEls[i], nestedLevelNum + 1);    
            }

    }

    carouselTextBoxEl.children().each(function () {
        resizeCarouselTextBoxEl($(this)
    });    
}
onSmallerScreen(resizeCarouselTextBox); 
```

更新：我让客户利用调整某些单词的大小以用作标题等，所以我不能简单地将所有内容设置为单一字体大小。

只是一个想法：是否可以放置在 HTML5 画布中并以这种方式拍摄快照和/或调整大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:23:23.467

This is a nature of CSS (**Cascading** Style Sheets) that all child elements inherit styles of their parents :)

I would use jQuery to dynamically select all child elements of the given container and change their font size:

```
$('.carousel-text-container').find('*').css('font-size', '14px'); 
```

Alternatively, you can remove font size so that all child elements will use font size declared for `.carousel-text-container` class:

```
$('.carousel-text-container').find('*').css('font-size', ''); 
```

# android - Android WebView 不会滚动

> ID：13463228
> 
> 赞同：2
> 
> 时间：2012-11-19T22:14:09.590
> 
> 标签：android, html, webview, scroll

我在 Android (4.2) 中有一个**WebView** ，它使用 javascript (放置在 assets 文件夹中)加载**本地 html 。**

我的问题是，我**无法在我的 WebView 中滚动**。我通过类似的 SO 问题尝试了很多事情和建议，但没有任何效果。

我的 Html 只是一个简单的 div-Tag，Kinetic-js 框架使用它在上面绘制图片和一些画布。

**XML 布局：**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">

        <TextView 
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="@dimen/text_size_smed_16sp"
            android:textColor="@android:color/white"
            android:text="@string/ui_floor_plan_building_textView" />

        <Spinner android:id="@+id/floor_plan_building_spinner"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <TextView 
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="@dimen/text_size_smed_16sp"
            android:textColor="@android:color/white"
            android:text="@string/ui_floor_plan_level_textView" />

        <Spinner android:id="@+id/floor_plan_level_spinner"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"/>

        <AutoCompleteTextView android:id="@+id/floor_plan_room_autoTextView"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:completionThreshold="1"
            android:hint="@string/ui_floor_plan_autocomplete_hint"
            android:inputType="number"
            android:imeOptions="actionSearch" />

    </LinearLayout>

     <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <WebView android:id="@+id/floor_plan_webView"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />

     </LinearLayout>

</LinearLayout> 
```

**Java onCreate：**

```
 this.webView = (WebView) findViewById(R.id.floor_plan_webView);
    this.webView.getSettings().setJavaScriptEnabled(true);

    this.webView.getSettings().setLoadWithOverviewMode(true);
    this.webView.getSettings().setUseWideViewPort(true);

    this.webView.setScrollBarStyle(View.SCROLLBARS_OUTSIDE_OVERLAY);
    this.webView.setScrollbarFadingEnabled(false);
    this.webView.setVerticalScrollBarEnabled(true);
    this.webView.setHorizontalScrollBarEnabled(true);

    this.webView.getSettings().setSupportZoom(true);
    this.webView.getSettings().setLightTouchEnabled(true);

    this.webView.setWebViewClient(new WebViewClient(){

        private boolean initialLoad = true;

        @Override
        public void onPageFinished(WebView view, String url) {
            super.onPageFinished(view, url);
            if(this.initialLoad){
                this.initialLoad = false;
                drawFloorPlan();
            }
        }

    });
    this.webView.loadUrl(PATH_FLOOR_PLAN_HTML); 
```

**HTML 文件：**

```
 <html>
        <head>
        <title>Floor Plans</title>

        <meta charset="UTF-8">

        <script type="text/javascript" src="floor_plan.js"></script>
        <script type="text/javascript" src="kinetic-v4.0.5.js"></script>
    </head>

    <body onload="initialize()" style="margin:0px; padding:0px; width:100%; height:100%">
        <div id="container"></div>
    </body>

</html> 
```

**观察：** 当显示的图像（html 文件）小于 webview 时，只要触摸事件在显示的 html 之外，就可以垂直和水平滚动。通常我的图片非常大，所以根本没有机会触摸外部和滚动。

我不确定它是 WebView 本身还是 html 页面的问题。有什么想法可以让滚动恢复工作吗？

我非常感谢每一个答案=）提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T11:44:01.933

我找到了一个**解决方案**：

我实现了自己的 onTouchListener 并自己进行滚动。从另一个 SO 问题/答案（[Android: Scrolling an Imageview](https://stackoverflow.com/questions/3058164/android-scrolling-an-imageview)）中得到了这个想法

认为这可能对其他人有帮助，因为它在 WebView 中似乎有一些错误，其中包含从 file:/// 加载的某些 html 文件...

# java - 创建活动以打开 YouTube 并自动搜索

> ID：13463229
> 
> 赞同：0
> 
> 时间：2012-11-19T22:14:21.427
> 
> 标签：java, android

所以我不知道如何把它放在标题中，但我一直在尝试做的是让我的应用程序打开，比如说 YouTube，然后自动输入搜索（之前给出）。这是我的代码，它更容易解释。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Get the URL and search from the intent
    Intent intent = getIntent();
    String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);

    // Open browser and auto search in searchbar
    if (!message.startsWith("http://") && !message.startsWith("https://"))
    message = "http://" + message + ".com";
    Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(message));
    startActivity(browserIntent);
} 
```

所以我想做的是打开 YouTube（这很好用），但是我想使用搜索中的下一个单词（用空格分隔）输入到 YouTube 的搜索栏中。

1.  您输入的内容：Youtube 搞笑视频

2.  将消息传递到第二个活动：打开 URL“Youtube”（到目前为止工作正常）

3.  该活动识别“Youtube”之后的消息的其他部分（用空格分隔）并将它们放入 YouTube 的搜索栏中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:46:15.233

据我了解，您想要做的是从字符串中提取`"youtube cat videos"`部分`"youtube"`和`"cat videos"`. 以下代码执行此操作：

```
String message = "youtube cat videos";
// Remove leading and trailing whitespaces.
message = message.trim();  
// Set limit to one so only the first  space is used to split.
String[] parts = message.split(" ", 2);  
// Check if domain and query are set.
if (parts.length < 2) {
    // Invalid.
}
String domain = parts[0];  
String query = parts[1];  
// Check if we have a valid domain name.
if (domain.matches("[a-zA-Z][a-zA-Z0-9]+")) {
    // Do stuff.
} 
```

不要忘记使用 trim() 和 matches() 函数过滤无效查询。

# php - 设置cookie不工作

> ID：13463239
> 
> 赞同：2
> 
> 时间：2012-11-19T22:14:56.920
> 
> 标签：php, cookies, setcookie

我看到很多人都问过类似的问题，所以如果我重复但我在其他帖子中找不到答案，请原谅。

这只是一个测试页面，在 localhost 上运行。我有一个 HTML 登录页面，将表单数据发送到 PHP 脚本，该脚本正在检查 MySQL 数据库中的详细信息。尝试设置带有结果的 cookie，但无法使其正常工作。

```
$user = $_POST['USER'];
$pass = $_POST['PASS'];

$res = $con->query("SELECT * FROM users WHERE username = '".$user."' AND password = '".$pass."'");
$row_no = $res->num_rows;
if ($row_no > 0) {
    $row = $res->fetch_assoc();
    $username = $row['username'];
    $password = $row['password'];

    setcookie('cookie1', $user, time() + 3600);

    if (isset($_COOKIE['cookie1'])) {
        echo "cookie set";
    }
    else {
        echo 'cookie not set';
    }

    echo "Hello " . $username . ', your password is ' . $password;
}
else {
    echo "Sorry, either your username or password is wrong";
} 
```

我想我知道该 cookie 在为其设置的页面上不可用，但即使我重新加载该页面，$_COOKIE 变量也是空的。`isset`脚本部分的结果始终是“cookie not set”。我还尝试将 cookie 上的域设置为“/”。

感激地收到任何帮助。

（ps MySQL部分工作正常）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:22:04.390

做类似的事情

```
setcookie(...);
var_dump($_COOKIE[...]); 
```

总会失败。

在处理用户请求的默认状态下， `$_COOKIE`超全局表示与请求一起从浏览器发送的所有 cookie 的数据数组。对于当前正在处理的请求，该`setcookie()`函数不会更改此数组。

但是，它应该出现在用户的下一个请求中。

如果出于某种原因，您希望当前的请求处理逻辑“理解”已设置了与响应标头一起发回的 cookie，则可以手动设置`$_COOKIE`数组中的值，例如：

```
setcookie(...);
$_COOKIE[...] = 'some value';
var_dump($_COOKIE); 
```

在使用`setcookie()`. 如果您正在使用`display_errors`on 进行开发，`error_reporting(E_ALL)`您应该会看到一个警告。您还可以查看浏览器的基本 Web 开发工具，以检查响应标头以查看 cookie 是否正在发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:16:21.867

另外，检查客户端和服务器上的时间。您的服务器将 cookie 设置为距当前时间一小时。cookie 的生命周期由客户端决定——如果客户端浏览器上的时间比服务器提前一个多小时，浏览器可能会立即丢弃 cookie。您可以通过将 cookie 设置得更长一些来测试这一点，例如 time() + 36000（10 小时）。

该 cookie 可在 NEXT PAGE REQUESTED 的 $_COOKIE 数组中使用，而不是在您调用 setcookie() 之后的当前页面中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:19:49.843

这不起作用的原因是因为正如 Ray 指出的那样，cookie 在请求的下一页上可用。这是因为 cookie 信息是在 HTTP 标头中传输的。所以你的代码基本上是这样做的：

-嘿，当我将此页面发送给用户时，告诉他创建此 cookie。

-（在将页面发送给用户之前）嘿，使用用户拥有的cookie。

但是他还没有那个 cookie，因为你还没有将页面发送给他（因此还没有发送 HTTP 标头告诉他创建 cookie）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:20:04.053

[单击此处获取有关 setcookie() 的 PHP 文档；](http://us2.php.net/manual/en/function.setcookie.php)

setcookie() 定义了一个 cookie 与其余的 HTTP 标头一起发送。与其他标头一样，必须在脚本的任何输出之前发送 cookie（这是协议限制）。这要求您在任何输出之前调用此函数，包括和标记以及任何空格。

一旦设置了 cookie，就可以在**下一页加载**时使用 $_COOKIE 或 $HTTP_COOKIE_VARS 数组访问它们。注意，像 $_COOKIE 这样的超全局变量在 PHP 4.1.0 中可用。Cookie 值也存在于 $_REQUEST 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-19T22:22:15.267

来自[http://php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)

> 一旦设置了 cookie，就可以***在下一页加载***时使用 $_COOKIE 或 $HTTP_COOKIE_VARS 数组访问它们。注意，像 $_COOKIE 这样的超全局变量在 PHP 4.1.0 中可用。Cookie 值也存在于 $_REQUEST 中。

# c# - 随机敌人移动方向

> ID：13463242
> 
> 赞同：0
> 
> 时间：2012-11-19T22:15:16.927
> 
> 标签：c#, random, xna, direction

我正在开发一款自上而下的射击游戏，我希望我的敌人漫无目的地四处游荡。在这段代码中，我有一个 Enemy 类，其中包含所有变量（旋转、位置等），包括主类中的 random(rnd)。

我的问题是敌人不断从屏幕的右上角移动到左下角。所以他们不是四处游荡，而是总能找到某个方向。我想知道为什么会这样。

```
refresh += gameTime.ElapsedGameTime.TotalSeconds;

if (refresh >= 3)
{
    refresh -= 3;
    int rndDirection = rnd.Next(4);

    if (rndDirection == 1) vektor = new Vector2(0, -1);
    if (rndDirection == 2) vektor = new Vector2(0, 1);
    if (rndDirection == 3) vektor = new Vector2(1, 0);
    if (rndDirection == 4) vektor = new Vector2(-1, 0);

    foreach (Enemy enemy in enemies)
    {
        Vector2 rndDirVec = vektor;
        enemy.directionX = enemy.position.X - rndDirVec.X;
        enemy.directionY = enemy.position.Y + rndDirVec.Y;
        enemy.rotation = (float)Math.Atan2(enemy.directionY, enemy.directionX);
    }
}
foreach (Enemy enemy in enemies) 
    {
        enemy.position -= new Vector2((float)(enemy.speed/2 *   Math.Cos(enemy.rotation)), (float)(enemy.speed/2 * Math.Sin(enemy.rotation)));
    } 
```

我对 C# 还很陌生，所以我可能缺乏一些关于其中事物如何运作的知识，所以有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T22:44:55.680

的整数参数`Random.Next`是一个唯一的上限，因此`rndDirection`将是 0、1、2 或 3。你永远不会增加 X 坐标，所以敌人总是会向左走。

我会做这样的事情（我从未使用过 XNA，而且我不知道您的代码的详细信息，所以我不确定这是否 100% 正确）：

```
foreach (Enemy enemy in enemies)
{
  enemy.direction.X = rnd.Next(3) - 1; // -1, 0, +1
  enemy.direction.Y = rnd.Next(3) - 1; // -1, 0, +1
  Vector2 movement = Vector2.Multiply(enemy.direction, enemy.speed);
  enemy.position = Vector2.Add(enemy.position, movement);
} 
```

或者，如果您想要更精细的方向更改：

```
const float rotationStep = 5.0f * Math.PI / 180.0f; // 5 degrees
foreach (Enemy enemy in enemies)
{
  enemy.rotation += (rnd.Next(3) - 1) * rotationStep;
  enemy.direction.X = Math.Cos(enemy.rotation);
  enemy.direction.Y = Math.Sin(enemy.rotation);
  Vector2 movement = Vector2.Multiply(enemy.direction, enemy.speed);
  enemy.position = Vector2.Add(enemy.position, movement);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:51:18.217

rand.next 的参数是一个上限，除非您希望所有敌人始终一起移动，否则我会在 foreach 循环内为敌人重新计算随机向量，以便它们每个都获得随机移动，而不是全部执行相同的随机移动运动（除非那是你想要的）。

# android - 使用 listView 和 listAdaptor，列表无法正确显示

> ID：13463246
> 
> 赞同：0
> 
> 时间：2012-11-19T22:15:41.507
> 
> 标签：android, listadapter

我正在尝试 listView 和 listAdaptor 使用数据库值填充屏幕。我的列表没有正确显示。下面是我的 DataBaseHandler 类的代码

```
 public List<Notifications> getNotificationList() {

        List<Notifications> notificationList = new ArrayList<Notifications>();

        String selectQuery = "SELECT  * FROM " + TABLE_CONTACTS; 

        SQLiteDatabase db = this.getWritableDatabase(); 
        Cursor cursor = db.rawQuery(selectQuery, null); 

        // looping through all rows and adding to list 
        if (cursor.moveToFirst()) { 
            do { 

                Notifications objN = cursorToNotifications(cursor);
                notificationList.add(objN);

            } while (cursor.moveToNext()); 
        } 

        // return contact list 
        return notificationList; 

    } 
```

这是我如何打印调用上述函数的值

```
ArrayAdapter<Notifications> adapter = new ArrayAdapter<Notifications>(this,
        android.R.layout.simple_list_item_1, objN);
    setListAdapter(adapter); 
```

当我运行应用程序时，它显示两个输入，这是正确的，但显示正确的数据。它显示类似

com.example.appname@41448fa0

com.example.appname@41449278

有人可以指出我哪里出错了。谢谢

* * *

抱歉，Android 世界的新手。你的意思是添加

```
@Override
public String toString() {
    return "something useful";  // define this
} 
```

在我的通知类中，就像

```
public class Notifications {

    //private variables 
    String _type; 
    String _message;
    String _id;

    // Empty constructor 
    public Notifications() {}

    // constructor 
    public Notifications(String type, String message, String id){ 
        this._type = type; 
        this._message = message; 
        this._id = id;
    } 

    // getting ID 
    public String getId(){ 
        return this._id; 
    } 

    public void setId(String id){ 
        this._id = id; 
    } 

    public String getType(){ 
        return this._type; 
    } 

    // setting id 
    public void setType(String type){ 
        this._type = type; 
    } 

    // getting name 
    public String getMessage(){ 
        return this._message; 
    } 

    // setting name 
    public void setMessage(String message){ 
        this._message = message; 
    } 

    @Override
    public String toString() {
        return "something useful";  // define this
    }
} 
```

* * *

抱歉，Android 世界的新手。你的意思是添加

```
@Override
  public String toString() {
     return "something useful";  // define this
  } 
```

在我的通知类中，就像

```
public class Notifications {

//private variables 
      String _type; 
String _message;
String _id;

     // Empty constructor 
     public Notifications(){ 

     } 
     // constructor 
    public Notifications(String type, String message, String id){ 
    this._type = type; 
    this._message = message; 
    this._id = id;

} 

// getting ID 
public String getId(){ 
    return this._id; 
} 

public void setId(String id){ 
    this._id = id; 
} 

public String getType(){ 
    return this._type; 
} 

// setting id 
public void setType(String type){ 
    this._type = type; 
} 

// getting name 
public String getMessage(){ 
    return this._message; 
} 

// setting name 
public void setMessage(String message){ 
    this._message = message; 
} 
@Override
public String toString() {
    return "something useful";  // define this
} 
```

}

我是否需要在任何地方进行任何其他更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:18:29.090

然后你必须生成`toString()`概率，假设你有这样的模型`City`，你生成`toString()`如下：

```
 @Override
    public String toString() {
        return "City [name=" + name + ", latitude=" + latitude + ", longitude="
              + longitude + "]";
    } 
```

生成我的模型后如下所示：

```
public class City {
    private String name;
    private double latitude;
    private double longitude;

    public City(String name, double latitude, double longitude) {
        this.name = name;
        this.latitude = latitude;
        this.longitude = longitude;
    }

    public String getName() {
      return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public double getLatitude() {
        return latitude;
    }

    public void setLatitude(double latitude) {
        this.latitude = latitude;
    }

    public double getLongitude() {
         return longitude;
    }

    public void setLongitude(double longitude) {
        this.longitude = longitude;
    }

    @Override
    public String toString() {
        return "City [name=" + name + ", latitude=" + latitude + ", longitude="
              + longitude + "]";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:26:15.860

看起来您只需要`toString()`在 Notifications 类中覆盖。

```
@Override
public String toString() {
    return "something useful";  // define this
} 
```

* * *

现在我已经看到你的代码使用了：

```
@Override
public String toString() {
    return _message; //  + " (" + _id + ", " + type + ")";
} 
```

# macos - shell脚本等待java jar文件完成

> ID：13463250
> 
> 赞同：2
> 
> 时间：2012-11-19T22:16:02.220
> 
> 标签：macos, bash, shell, jar

我在 Mac OS X 10.8.2 上

我有一个执行 jar 文件的简单 bash 脚本（一个带有窗口的简单 hello world gui 程序）

```
#!/bin/sh

if ls /Applications/javahello.jar >& /dev/null ; then
    echo "File exists."
     java -jar /Applications/javahello.jar
     exit 0 
else
     echo "File doesn't exist."
     exit 1
fi 
```

问题是脚本执行 jar，弹出一个窗口，终端窗口保持“被占用”并显示 File Exists 消息。它永远不会完成它的执行。...直到我更精确地手动终止 java 程序

我需要能够在这个 bash 脚本中执行 java 程序，以便脚本退出而不等待 java 程序完成运行。

这将发生在将 jar 文件复制到 /Applications/ 文件夹的安装程序包的末尾……因为，安装程序永远不会完成，并且显然正在等待 shell 脚本完成其执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:21:33.753

只需将`java`进程置于后台，使用`&`.

```
#!/bin/sh
if ls /Applications/javahello.jar >& /dev/null ; then
  echo "File exists."
  java -jar /Applications/javahello.jar &
  exit 0 
else
  echo "File doesn't exist."
  exit 1
fi 
```

此外，您无需`ls`判断文件是否存在：

```
#!/bin/sh
if [ -f /Applications/javahello.jar ]; then
  echo "File exists."
  java -jar /Applications/javahello.jar &
  exit 0 
else
  echo "File doesn't exist."
  exit 1
fi 
```

此外，由于您使用了两次文件名，如果您编辑脚本以更改文件名或制作副本以运行不同的 jar 文件或其他任何内容，您可能会在两个文件名不同的地方打错字。一个 shell 参数将解决这个问题，所以它不会发生：

```
#!/bin/sh
jar=/Applications/javahello.jar
if [ -f "$jar" ]; then
  echo "File exists."
  java -jar "$jar" &
  exit 0 
else
  echo "File doesn't exist."
  exit 1
fi 
```

# wcf - WCF 授权对端点的请求

> ID：13463251
> 
> 赞同：1
> 
> 时间：2012-11-19T22:16:04.117
> 
> 标签：wcf, rest

我正在开发一个 WCF REST 服务，其中使用基于 SSL 的基本身份验证对请求进行身份验证。但是，在发送身份验证质询之前，我想使用预共享的 API 密钥确保请求有效。我不希望在 URL 中传递键值，那么自定义 HTTP 标头是最佳解决方案吗？像 X-APIKey: keyvalue 这样的东西。

我在 HttpModule 中验证用户的凭据：

```
public void OnAuthenticateRequest(object source, EventArgs eventArgs)
    {
        HttpApplication app = (HttpApplication)source;

        if (!app.Request.IsSecureConnection)
        {
            app.Response.StatusCode = 403;
            app.Response.StatusDescription = "SSL Required";
            app.Response.End();
            return;
        }

        string authHeader = app.Request.Headers[AUTH_HEADER];
        if (authHeader == null)
        {
            app.Response.StatusCode = 401;
            app.Response.End();
            return;
        }

        ClientCredentials credentials = ClientCredentials.FromHeader(authHeader);
        if (credentials.Authenticate())
        {
            app.Context.User = new GenericPrincipal(new GenericIdentity(credentials.Id), null);
        }
        else
        {
            DenyAccess(app);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:30:06.090

这是一个很好的选择（在标题中传递它）。然后，您可以使用自定义消息检查器来验证共享密钥是否存在于对特定端点的所有请求中，如下面的代码所示。

```
public class StackOverflow_13463251
{
    const string SharedKeyHeaderName = "X-API-Key";
    const string SharedKey = "ThisIsMySharedKey";
    [ServiceContract]
    public interface ITest
    {
        [WebGet(ResponseFormat = WebMessageFormat.Json)]
        string Echo(string text);
        [WebGet(ResponseFormat = WebMessageFormat.Json)]
        int Add(int x, int y);
    }
    public class Service : ITest
    {
        public string Echo(string text)
        {
            return text;
        }
        public int Add(int x, int y)
        {
            return x + y;
        }
    }
    public class ValidateSharedKeyInspector : IEndpointBehavior, IDispatchMessageInspector
    {
        public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
        {
        }

        public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
        {
        }

        public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
        {
            endpointDispatcher.DispatchRuntime.MessageInspectors.Add(this);
        }

        public void Validate(ServiceEndpoint endpoint)
        {
        }

        public object AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)
        {
            HttpRequestMessageProperty httpReq = request.Properties[HttpRequestMessageProperty.Name] as HttpRequestMessageProperty;
            string apiKey = httpReq.Headers[SharedKeyHeaderName];
            if (!SharedKey.Equals(apiKey))
            {
                throw new WebFaultException<string>("Missing api key", HttpStatusCode.Unauthorized);
            }

            return null;
        }

        public void BeforeSendReply(ref Message reply, object correlationState)
        {
        }
    }
    static void SendRequest(string uri, bool includeKey)
    {
        string responseBody = null;
        Console.WriteLine("Request to {0}, {1}", uri, includeKey ? "including shared key" : "without shared key");

        HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(uri);
        req.Method = "GET";
        if (includeKey)
        {
            req.Headers[SharedKeyHeaderName] = SharedKey;
        }

        HttpWebResponse resp;
        try
        {
            resp = (HttpWebResponse)req.GetResponse();
        }
        catch (WebException e)
        {
            resp = (HttpWebResponse)e.Response;
        }

        Console.WriteLine("HTTP/{0} {1} {2}", resp.ProtocolVersion, (int)resp.StatusCode, resp.StatusDescription);
        foreach (string headerName in resp.Headers.AllKeys)
        {
            Console.WriteLine("{0}: {1}", headerName, resp.Headers[headerName]);
        }

        Console.WriteLine();
        Stream respStream = resp.GetResponseStream();
        responseBody = new StreamReader(respStream).ReadToEnd();
        Console.WriteLine(responseBody);

        Console.WriteLine();
        Console.WriteLine("  *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  ");
        Console.WriteLine();
    }
    public static void Test()
    {
        string baseAddress = "http://" + Environment.MachineName + ":8000/Service";
        ServiceHost host = new ServiceHost(typeof(Service), new Uri(baseAddress));
        ServiceEndpoint endpoint = host.AddServiceEndpoint(typeof(ITest), new WebHttpBinding(), "");
        endpoint.Behaviors.Add(new WebHttpBehavior());
        endpoint.Behaviors.Add(new ValidateSharedKeyInspector());
        host.Open();
        Console.WriteLine("Host opened");

        SendRequest(baseAddress + "/Echo?text=Hello+world", false);
        SendRequest(baseAddress + "/Echo?text=Hello+world", true);
        SendRequest(baseAddress + "/Add?x=6&y=8", false);
        SendRequest(baseAddress + "/Add?x=6&y=8", true);

        Console.Write("Press ENTER to close the host");
        Console.ReadLine();
        host.Close();
    }
} 
```

# html - 如何使用 CodeIgniter 引用我的 Bootstrap 样式表

> ID：13463253
> 
> 赞同：3
> 
> 时间：2012-11-19T22:16:08.333
> 
> 标签：html, css, codeigniter, twitter-bootstrap

我正在使用 CodeIgniter，我正在通过执行加载视图`$this->load->view('index')`。

我的目录看起来像这样

*   应用
*   资产/css/bootstrap.css

在视图内部（in `applications/views/index.php`），我在 head 标签内引用如下：

```
<link href="/assets/css/bootstrap.css" rel="stylesheet"> 
```

但是控制器只加载html的元素，没有任何样式的Bootstrap css。我引用错误的方式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T22:18:00.740

您可以使用 url 帮助器，`site_url()`函数使其变得简单：

```
<link href="<?php echo site_url('assets/css/bootstrap.css'); ?>" > 
```

您还可以使用 HTML 帮助程序和`link_tag()`函数：

```
echo link_tag('assets/css/bootstrap.css'); 
```

要使用帮助程序，请在控制器构造函数中添加以下行：

```
$this->load->helper('url');
$this->load->helper('html'); 
```

或者，您可以在`application/config/autoload.php`文件中全局加载这些帮助程序。有关详细信息，请参阅[http://codeigniter.com/user_guide/general/autoloader.html](http://codeigniter.com/user_guide/general/autoloader.html) 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T16:25:33.030

CodeIgniter 提供了自己的方式将 .css 文件添加到视图中。您只需使用 $config['css'] = '/assets/css/bootstrap.css'; 更新应用程序文件夹中的“config.php”文件。然后在模型类中声明一个数据数组，该数组加载配置并在样式文件中使用它。转到以下链接。用一个例子来讨论这个过程。忽略他们的目录 url，因为它是使用早期版本的 CI 完成的。

[http://www.phpeveryday.com/articles/CodeIgniter-Form-Creating-Beautiful-Form-Code-P243.html](http://www.phpeveryday.com/articles/CodeIgniter-Form-Creating-Beautiful-Form-Code-P243.html)

# salesforce - 将 Google Drive 文件上传到 Salesforce 附件

> ID：13463254
> 
> 赞同：1
> 
> 时间：2012-11-19T22:16:10.263
> 
> 标签：salesforce, google-apps-script, base64

除了实际文件不可读外，我一切正常。我假设它会加载，因为我没有收到任何错误并且附件已创建。“文件”在salesforce中需要是base64，所以我假设我的问题是Drive中的blob不是base64。问题是，如何将文件 blob 转换为 base64 格式以进行上传，这是否真的有效。

相关代码块

```
 var payload =  Utilities.jsonStringify(
      {"Name" : name, //string
       "ParentId" : acctId,  //string
       "OwnerId" : ownerId,  //string
       "body" : content  //base64
      }
    );

    var contentType = "application/json; charset=utf-8";
    var feedUrl = instanceUrl + "/services/data/v23.0/sobjects/Attachment/"
    var response = UrlFetchApp.fetch(feedUrl, { method : "POST", headers : { "Authorization" : "OAuth " + accessToken }, payload : payload, contentType: contentType });

    var feed = JSON.parse(response.getContentText()); 
```

在这里查看它会与 Utilities.jsonStringify() 接缝，该文件将是一个问题。尽管如此，仍然需要一些帮助来完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:23:10.190

下面的代码片段对我有用。我重写了一点以适合我的样本。我没有包含 ownerid，因为我不知道该包含什么。我认为关键问题可能是您没有使用`getAs()`. 如果您有纯 Google Doc blob，那么您的浏览器将不知道如何转换它。注意，我是如何使用 application/pdf 的。我相信您也可以对 MS Word 使用类似的 MIME 类型。另请注意，我使用 Utilities API 转换为 Base64。

```
var myFileId = 'MY_FILE_ID';
var myParendId = 'ACCOUNT_ID';
var myToken = 'USER_TOKEN';

var baseContent = DocsList.getFileById(myFileId).getAs('application/pdf').getBytes();
var base64Content = Utilities.base64Encode(baseContent);

var payload =  Utilities.jsonStringify(
  {"Name" : 'ArunTest.pdf', //string
   "ParentId" : myParendId,  //string
   "body" : base64Content  //base64
  }
);

var options = {
        "method": "post",
        "contentType" : "application/json",
        "payload" : payload,
        "headers" : {
                     "Authorization" : "Bearer " + myToken
                    }
}

var getDataURL = UserProperties.getProperty(baseURLPropertyName) + '/services/data/v26.0/sobjects/Attachment/';
var dataResponse = UrlFetchApp.fetch(getDataURL,options).getContentText(); 
```

# android - 垂直于屏幕时，视图在 Y 轴上的旋转动画上剪辑

> ID：13463256
> 
> 赞同：2
> 
> 时间：2012-11-19T22:16:19.557
> 
> 标签：android, animation, clipping

我有一个片段（来自支持库），其中包含一个带有翻转动画的视图（与姜饼兼容）。该视图包含两个视图，一个用于首页，一个用于后页。根据翻转的父视图的角度，“PageViews”被隐藏或显示为 90°。翻转动画由移动事件触发。这有点像翻书页——书页粘在手指上。但是在某些时候，当视图旋转到最垂直于屏幕时，视图就会消失。由于穿过近剪裁平面，它似乎被剪裁了。

有没有办法改变近乎剪裁或以其他方式解决这个问题（可能会展平视图层次结构？）？还是应该用 OpenGL ES 更好地完成这些事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T22:55:26.550

可以通过将所需图像设置为翻转视图/布局的背景来解决此问题，而不是将 ImageView 放在顶部。所以不是翻转视图本身被剪裁了。如果顶部的视图到达其翻转父级的边界，则它们将被剪裁。我认为这个问题只出现在大视图被翻转（例如整个屏幕）。

# javascript - JavaScript window.onresize AND 小于 1024 宽

> ID：13463257
> 
> 赞同：0
> 
> 时间：2012-11-19T22:16:19.143
> 
> 标签：javascript, jquery, javascript-events

我有一个固定的左 DIV，我想隐藏小于 1024 的窗口宽度，我可以这样做。但是如果用户调整到小于 1024，我不确定如何隐藏它？

这是我目前拥有的，但如果用户将窗口大小调整为小于 1024，则不起作用。

```
$(document).ready(function () {

if (window.innerWidth < 1024) {
    $(".leftnav").css({
    "width": "0px"
});

}
}); 
```

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:18:53.703

怎么样？

```
window.onresize = function(event) {
    // your code here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:21:33.223

应该可以工作（http://jsfiddle.net/PPTXJ/ <--调整正确的框架！）：

```
$(window).resize(toggleNav);
$(document).ready(toggleNav);

function toggleNav() {

 if($(window).width() < 1024)
    $(".leftnav").hide();
 else
    $(".leftnav").show();
} 
```

# javascript - 用于域验证的正则表达式

> ID：13463265
> 
> 赞同：0
> 
> 时间：2012-11-19T22:16:41.330
> 
> 标签：javascript, jquery, regex

我在这里看到了一个类似的问题[Jquery how to validate domain name](https://stackoverflow.com/questions/7916370/jquery-how-to-validate-domain-name)但我似乎无法让这个示例与我的代码一起使用。

我基本上想对输入文本框执行 reg ex，并通过 jquery 验证它是否符合我的域名搜索条件。格式必须是

domainname.co.uk 或 .com/.org/.net（无 http:// 或 https:// 且无子域）

我的代码目前：

```
if(!/([a-z0-9-]+\.(?:com|net|org|co.uk))(?:\/|$)/$("#domain").val()) {
        $('#error').html("Invalid domain name, , please correct before proceeding.");
        return false;   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:19:35.133

```
!/([a-z0-9-]+\.(?:com|net|org|co.uk))(?:\/|$)/$("#domain").val()) 
```

应该：

```
!/([a-z0-9-]+\.(?:com|net|org|co\.uk))(?:\/|$)/.test($("#domain").val()))
//                              ^              ^^^^^ 
```

# java - 无法使用包将一个 java 类的方法用于第二个类

> ID：13463270
> 
> 赞同：1
> 
> 时间：2012-11-19T22:16:46.877
> 
> 标签：java, jsp

实际上，我的任务是在同一个包中创建 java bean 类并将它们用于 JSP（java 服务器页面）。

下面是我正在做的事情。

**包名：mypack** **第一个类名：UserBean.java* *（包含所有getter和setter方法） **第二个类名：Databean.java**（包含与数据库交互的方法）
**d:\java：** jdk1.5和tomcat，两者都是在这个文件夹中。

**UserBean.java：** 我想使用这个类的setter和getter方法来设置和获取值。 **DataBean.java：**我想使用这个类的方法与 MS Access 数据库进行交互，如获取、更新、删除等。对于这些操作，我想将 UserBean 类对象实例化为 DataBean 类来设置和获取 DataBean 类的值。

我是如何编译的？

**d:\java\mypack> 设置路径=d:\java\jdk1.5\bin**
**d:\java\mypack>javac UserBean.java**

但是当我在 DataBean 类中实例化 UserBean 类的对象时，我得到了我已经提到的错误。

**d:\java\mypack>javac DataBean.java**
在这里我得到了上面的错误信息

为了解决这个问题，我稍微修改了编译行：

**d:\java\mypack>javac -classpath .. DataBean.java**
这工作并成功生成类文件

目前，这两个类都已成功编译。现在还有另一个问题，在下面进行描述。

```
package mypack;
**//UserBean.java**
public class UserBean{
       String username;    //an attribute of UserBean Class
       String password;    //an attribute of UserBean Class

public UserBean(){} //Default Constructor of UserBean Class
public void setUsername(String username){ this.username = username;   }//setter      method
       public String getUsername(){return username; } //getter method
}

package mypack;
**//DataBean.java**
public class DataBean{
       UserBean user = new UserBean();  //Instantiating UserBean class object in
       //DataBean class
       String username;     //an attribute of DataBean Class

       public DataBean(){}  //Default Constructor of UserBean Class
       public String getUsernameTwo(){return user.getUsername(); } //gettter method
} 
```

在jsp页面上，我实例化了两个对象

```
<%@ page import="java.sql.*, mypack.*"%> //importing packages
<html>
<body>
<%
UserBean u = new UserBean(); *//UserBean class object u has been instantiated*
DataBean d = new DataBean(); //DataBean class object d has been instantiated

u.setUsername("John");  //username has been set as john
out.println(u.getUsername()); //gets the string john, and prints it successfully 
(prints: John)

out.println(d.getUsernameTwo()); //Does'nt print John, but prints null 
                                 //**(it should print john too but it doesnt)**
%> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:29:42.797

getUsernameTwo() 方法返回已在 DataBean 的构造函数中创建的 UserBean 的用户名。此 UserBean 实例与您在 JSP 中实例化的 UserBean 对象不同。

这就像打开两个瓶子，在其中一个瓶子里放一条信息，然后在另一个瓶子里看，希望能找到你放在第一个瓶子里的信息。它不适用于瓶子，也不适用于 Java 对象，因为 Java 对象有点像真实对象。

您可以做的一件事是让 DataBean 使用在其 cnstructor 中传递的 UserBean：

```
public class DataBean{
    private UserBean user;       

    public DataBean(UserBean user) {
        this.user = user;
    }

    public String getUsernameTwo() {
        return user.getUsername(); 
    }
} 
```

在您的 JSP 中：

```
<%
UserBean u = new UserBean();
DataBean d = new DataBean(u);

u.setUsername("John");
out.println(u.getUsername());
out.println(d.getUsernameTwo());
%> 
```

看来您还没有掌握基本的 OO 概念。我建议在使用 JSP 之前先开始学习基本 Java 和 OO 的教程。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-19T22:23:39.177

The problem is that in DataBean Class you create another instace of UserBean, that is not the same with the one that you create in the jsp page.

In class DataBean try this:

```
UserBean user = (UserBean)FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get("u"); 
```

"u" - is your instance of UserBean that you want to use.

# java - 尝试使用 GSON 解析 JSON

> ID：13463276
> 
> 赞同：7
> 
> 时间：2012-11-19T22:17:12.077
> 
> 标签：java, android, gson

我正在尝试在我的 Android 应用程序上使用 GSON 库解析 JSON。我可以正确解析 JSON 数组，但现在我需要解析另一个 json，使用以下结构：

```
 {
    "articles": [
        {
            "article": {
                "articleId": 1,
                "articleName": "Bocadillo de calamares",
                "merchantId": 2,
                "price": 3.5
            },
            "computable": true,
            "orderArticleId": 3157,
            "orderId": 203,
            "price": 3.5,
            "requestedDate": "2012-11-19 13:15:20",
            "shared": true,
            "status": "AS01_INITIAL"
        },
        {
            "article": {
                "articleId": 3,
                "articleName": "Desayuno",
                "merchantId": 2,
                "price": 2.2
            },
            "computable": true,
            "orderArticleId": 3158,
            "orderId": 203,
            "price": 0,
            "requestedDate": "2012-11-19 13:17:30",
            "shared": true,
            "status": "AS01_INITIAL"
        },
        {
            "article": {
                "articleId": 2,
                "articleName": "Café",
                "merchantId": 2,
                "price": 1.1
            },
            "computable": true,
            "orderArticleId": 3156,
            "orderId": 203,
            "price": 1.1,
            "requestedDate": "2012-11-19 13:15:20",
            "shared": true,
            "status": "AS01_INITIAL"
        },
        {
            "article": {
                "articleId": 1,
                "articleName": "Bocadillo de calamares",
                "merchantId": 2,
                "price": 3.5
            },
            "computable": true,
            "orderArticleId": 3155,
            "orderId": 203,
            "price": 3.5,
            "requestedDate": "2012-11-19 12:40:17",
            "shared": true,
            "status": "AS01_INITIAL"
        }
    ],
    "comment": null,
    "creationDate": "2012-11-19 12:06:41",
    "customer": {
        "creationDate": 1353321506000,
        "customerId": 152,
        "devices": [
            {
                "customerId": 152,
                "deviceId": "2000",
                "phone": null
            }
        ],
        "image": false,
        "mail": null,
        "name": null,
        "password": null
    },
    "finishDate": null,
    "group": 0,
    "groupOrders": [],
    "location": {
        "location": "Table 1",
        "locationId": 1,
        "shopId": 2
    },
    "orderId": 203,
    "parentOrderId": 192,
    "score": null,
    "shopId": 2,
    "status": "OS01_INITIAL",
    "ticketUrl": null,
    "tip": null,
    "total": 0,
    "totalArticles": 0,
    "type": "BILL"
}

I have a Order.class like this:

    public class Order {

    private final String orderId;
    (....)
    private final ArrayList<Articles> articles;
    private final String group;

    public Order() {

        orderId = "";
         (....)

        articles = new ArrayList<Articles>();
        group = "";
    }

    public String getOrderId() {
        return orderId;
    }

     (... All getters for each element)

    public ArrayList<Articles> getArticles() {
        return articles;
    }
} 
```

还有一个 Articles.class

```
public class Articles {

private final String orderArticleId;
(...)
private final ArrayList<Article> article;

public Articles() {
    orderArticleId = "";
    (....)
    article = new ArrayList<Article>();

};

public String getPrice() {
    return price;
}

(....All getters for each element)

public ArrayList<Article> getArticle() {
    return article;
} 
```

}

而且，在我的主要活动中，我尝试获取所有信息：

```
 final Gson gson = new Gson();
    Order o = gson.fromJson(jsonData, Order.class);
    System.out.println(" - " +  o.getOrderId() ); 
```

并且工作正常，但是如果我想获取文章信息，则值为空，我不知道如何获取它。

我尝试这样的事情：

```
 Type collectionType = new TypeToken<List<Merchants>>() {
            }.getType();
            data = gson.fromJson(response, collectionType); 
```

我尝试使用 ArticlesWrapper，但我不知道该怎么做。但我想我忘记了什么……我不知道是什么。在应用程序的另一部分，我正确反序列化了 JSON，因为它是一个数组，但在这种情况下，我不知道如何正确获取所有数据。

如果您需要更多信息，我会提供给您！谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-22T12:40:28.243

这是因为您没有正确地将 JSON 结构转换为 Java POJO，基本上省略了您具有以下结构的某些字段。

```
+ Order
    + List<BigArticle> articles
    + Customer customer
    + Location location
    + other basic fields

+ BigArticle
    + Article article
    + other basic fields

+ Article
    + basic fields

+ Customer
    + List<Device> devices
    + other basic fields

+ Device
    + basic fields

+ Location
    + basic fields 
```

因此，您应该最终得到 6 个 Java POJO，GSon 在反序列化 JSON 数据时应该能够填充这些 POJO。

我刚刚在这里将您的 JSON 结构转换为 POJO，并且我让 Dates as String 来简化解析。如果要`java.util.Date`正确填充，则必须自定义 GSon 实例。

**主班**

```
public class Main {
    public static void main(String[] args) {
        String jsonData = "...";
        final Gson gson = new Gson();
        Order o = gson.fromJson(jsonData, Order.class);
        System.out.println("orderId: " +  o.getOrderId());
        System.out.println("first article price: " + o.getArticles().get(0).getPrice());
        System.out.println("second article status: " + o.getArticles().get(1).getStatus());
        System.out.println("third article requested date: " + o.getArticles().get(2).getRequestedDate());
    }
} 
```

**命令**

```
public class Order {
    private List<BigArticle> articles;
    private String comment;
    private String creationDate;
    private Customer customer;
    private String finishDate;
    private int group;
    private List<Integer> groupOrders;
    private Location location;
    private int orderId;
    private int parentOrderId;
    private int score;
    private int shopId;
    private String status;
    private String ticketUrl;
    private String tip;
    private int total;
    private int totalArticles;
    private String type;

    // getters and setters
} 
```

**大文章**

```
public class BigArticle {
    private Article article;
    private boolean computable;
    private int orderArticleId;
    private int orderId;
    private double price;
    private String requestedDate;
    private boolean shared;
    private String status;

    // getters and setters
} 
```

**文章**

```
public class Article {
    private int articleId;
    private String articleName;
    private int merchantId;
    private double price;

    // getters and setters
} 
```

**顾客**

```
public class Customer {
    private long creationDate;
    private int customerId;
    private List<Device> devices;
    private boolean image;
    private String mail;
    private String name;
    private String password;

    // getters and setters
} 
```

**设备**

```
public class Device {
    private int customerId;
    private String deviceId;
    private String phone;

    // getters and setters
} 
```

**地点**

```
public class Location {
    private String location;
    private int locationId;
    private int shopId;

    // getters and setters
} 
```

**输出**

```
orderId: 203
first article price: 3.5
second article status: AS01_INITIAL
third article requested date: 2012-11-19 13:15:20 
```

# c++ - 编译为 C++ 时 libav 中的未定义符号，但不是 C

> ID：13463279
> 
> 赞同：1
> 
> 时间：2012-11-19T22:17:20.673
> 
> 标签：c++, linker, libav

我正在尝试使用 libav 库编译一些简单的代码。

```
// Some simple code to demonstrate
#include <libavformat/avformat.h>

int main(int argc, char *argv[]) {
    av_register_all();
    return 0;
} 
```

我在 Mac 上，使用 gcc 版本 4.2.1。

当我尝试将代码编译为 C 使用

```
gcc -o main main.c -lavformat 
```

然后代码编译并链接正常。但是，当我尝试将其编译为 C++ 使用

```
g++ -o main main.cpp -lavformat 
```

它给了我未定义的符号错误：

```
Undefined symbols for architecture x86_64:
  "av_register_all()", referenced from:
      _main in ccQ23HMe.o 
```

当我使用该`-v`选项运行时，运行的链接步骤是：

```
// gcc
"/usr/bin/ld" -demangle -dynamic -arch x86_64 -macosx_version_min 10.8.0 -o c
 /var/folders/r0/n22t1hyn7ts92jxgd9_pn8yw0000gn/T/main-uUfZkM.o -lavformat
-lSystem /usr/bin/../lib/clang/4.1/lib/darwin/libclang_rt.osx.a

// g++
"/usr/bin/ld" -demangle -dynamic -arch x86_64 -macosx_version_min 10.8.0 -o c
 /var/folders/r0/n22t1hyn7ts92jxgd9_pn8yw0000gn/T/main-5QU6fj.o -lavformat
 -lstdc++ -lSystem /usr/bin/../lib/clang/4.1/lib/darwin/libclang_rt.osx.a 
```

在这里，唯一的区别是添加`-lstdc++`到链接。

为什么会出现这些未定义的符号错误？是否有某些原因简单地将库添加到链接会导致这些未定义的符号？还是有其他原因导致此问题，可能与 libavformat 相关？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:20:53.693

*libav* “常见问题”列表[涵盖了这个*确切的*场景](http://libav.org/faq.html#I_0027m-using-Libav-from-within-my-C_002b_002b-application-but-the-linker-complains-about-missing-symbols-which-seem-to-be-available_002e)！

> 在这里，唯一的区别是在链接中添加了 -lstdc++。

不——那个，而且您使用的是具有不同默认调用约定的不同语言。

`av_register_all`如标头中声明的未标记`extern "C"`，而实际编译库中的定义需要良好的老式 C 调用约定。

将您的*libav*包含在`extern "C"`.

# ruby-on-rails - 强制加载整个关联的Rails finder？

> ID：13463280
> 
> 赞同：0
> 
> 时间：2012-11-19T22:17:24.557
> 
> 标签：ruby-on-rails, activerecord

问题类 has_many 选项。我需要通过某个属性值（通常是 id）找到一个选择。

澄清：父记录（问题）围绕不同的对象和方法传递，它们使用不同的属性和值搜索子项。

我可以这样做`question.choices.find(choice_id)`，但这每次都会生成一个 SQL 查询。

知道问题通常只有少数选择，并且在一个父记录上会有许多不同的搜索，我怀疑加载整个关联并在 Ruby 中搜索会更便宜：

```
question.choices.detect{|choice| choice.id == some_choice_id} 
```

Detect 来自 Enumerable 并强制 Rails 在第一次调用时加载关联（并在以后的搜索中使用缓存的数据）。这也与急切加载很好地配合：我可以做 Question.all(include:choice) 并将整个树加载两个查询，然后搜索非常快。虽然它读起来不太好。

如果我想模拟查找，它会变得更加毛茸茸！行为：

```
question.choices.detect{|choice| choice.id == choice_id} or raise ActiveRecord::RecordNotFound.new 
```

*这正是我想要的，我只是在寻找更好的语法。*

Rails 是否提供某种以这种方式运行的动态查找器（在第一次查询时强制加载整个关联，然后搜索这个预加载的集合）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:22:15.510

我怀疑我错过了在 Rails 中烘焙或在流行的 gem 中可用的东西。如果不是这种情况，我只会推出我自己的助手：

```
Enumerable.module_eval do
  def select_by(attribute_name, value)
    detect do |item|
      item.send(attribute_name) == value
    end
  end

  def select_by!(attribute_name, value)
    select_by(attribute_name, value) \
      or raise StandardError.new("can't find item with #{attribute_name} equal to #{value} in #{self.inspect}")
  end
end 
```

用法是：

```
question.choices.select_by(:id, 7)
user.question.select_by(:name, "Is it shiny?") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:23:23.437

我相信您想要的称为“急切加载”，并使用该`.includes`方法实现。

```
@questions = Question.includes(:choices).all 
```

将导致执行内部连接的查询，返回问题及其每个选择。这假设您已经在模型中声明了关系。大概你会限定 this will some where 子句而不是`.all`.

# apache - Apache 简单重定向从一页到另一页

> ID：13463282
> 
> 赞同：0
> 
> 时间：2012-11-19T22:17:28.380
> 
> 标签：apache, redirect

我需要从一个网址重定向到另一个完整网址

我见过的所有示例都使用 reg 表达式和我需要重定向的复杂语法

www.mydomain.com/page1.html

至

www.mydomain.com/page1replacement.html

我想它在 .htaccess 文件中，但是语法是什么？

**Update1** 试过了，但它不起作用：我需要重新启动 apache 吗？

```
Redirect 301 http://www.theprinterdepo.com/catalogsearch/result/index/?cat=100&q=1022&x=0&y=0 http://www.theprinterdepo.com/catalogsearch/advanced/result/?name=1022&sku=&price%5Bfrom%5D=&price%5Bto%5D=&free_shipping=&category=100 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:22:09.830

This goes into your .htaccess file. Full URLs can be used.

```
Redirect 301 /page1.html http://mydomain.com/page1replacement.html 
```

# php - 网站浏览器跟踪器

> ID：13463283
> 
> 赞同：0
> 
> 时间：2012-11-19T22:17:39.800
> 
> 标签：php, html, database, browser, registration

我想跟踪哪些浏览器访问我的网站。我有一个数据库，用于存储用户在网站上注册后的信息，以及他们在表单中输入的数据，我还想存储他们用来访问和注册网站的浏览器。实际上有什么方法可以让网站查看正在使用的浏览器并保存该信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:19:49.200

`get_browser()` [http://php.net/manual/en/function.get-browser.php](http://php.net/manual/en/function.get-browser.php)

这将返回正在使用的浏览器

从文档：

“尝试通过在 browscap.ini 文件中查找浏览器信息来确定用户浏览器的功能。”

更新：

正如@Brad 指出的那样，此功能不再可靠。您可以使用`$_SERVER['HTTP_USER_AGENT'];`.

# r - 在 R 中为多行创建散点图

> ID：13463294
> 
> 赞同：6
> 
> 时间：2012-11-19T22:18:24.113
> 
> 标签：r, plot, ggplot2, lattice, scatter-plot

我有一个看起来像这样的数据框：

```
 Samp1    Samp2    Samp3     Samp4    Samp5
Gene1    84.1     45.2     34.3      54.6     76.2
Gene2    94.2     12.4     68.0      75.3     24.8
Gene3    29.5     10.5     43.2      39.5     45.5
... 
```

我正在尝试创建一个散点图，其中 x 轴是样本（Samp1-5），y 轴是行（Gene1-3 等），但我希望绘制每行的数据作为同一情节上的不同颜色。

关于如何在 R 中执行此操作的任何想法？我非常愿意在 R 中使用 ggplot2、lattice、car 或任何其他包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T09:37:36.400

这是一个解决方案`ggplot2`：

数据：

```
dat <- read.table(text="Samp1    Samp2    Samp3     Samp4    Samp5
  Gene1    84.1     45.2     34.3      54.6     76.2
  Gene2    94.2     12.4     68.0      75.3     24.8
  Gene3    29.5     10.5     43.2      39.5     45.5", header = TRUE) 
```

剧情：

```
library(ggplot2)  
ggplot(stack(dat), aes(x = ind, y = values, colour = rownames(dat))) +
  geom_point() 
```

![在此处输入图像描述](../Images/4f05b6aafce1be6991dd9a530e35df89.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:41:29.430

如果您想在 lattice 或 ggplot2 中执行此操作，那么您可能需要将数据重塑为长格式，请参阅`reshape`函数或`reshape2`包。

对于基本图形，该`matplot`函数可能会执行您想要的操作，`axis`如果您不希望仅将数字 1 到 5 作为轴刻度线，则可能需要抑制 x 轴并使用该函数添加您自己的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T09:26:26.180

将数据放入矩阵：

```
foo <- as.matrix(structure(list(Samp1 = c(84.1, 94.2, 29.5),
    Samp2 = c(45.2, 12.4, 10.5),Samp3 = c(34.3, 68, 43.2),
    Samp4 = c(54.6, 75.3, 39.5),Samp5 = c(76.2, 24.8, 45.5)),
  .Names = c("Samp1", "Samp2","Samp3", "Samp4", "Samp5"),
  class = "data.frame", row.names = c("Gene1","Gene2", "Gene3"))) 
```

和情节：

```
plot(seq(1,ncol(foo)),foo[1,],xlab="",ylab="",xaxt="n",
  pch=21,bg=1,ylim=c(min(foo),max(foo)))
axis(side=1,at=seq(1,ncol(foo)),labels=colnames(foo))
for ( ii in 2:nrow(foo) ) points(seq(1,ncol(foo)),foo[ii,],pch=21,col=ii,bg=ii) 
```

请注意，我正在按颜色循环显示它们的数字 ( `col=ii,bg=ii`)。见`?palette`。

你可能还想看看`?legend`。

![散点图](../Images/a800ea3153a5070d4a771501e2bafc10.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-04T08:26:37.460

在引入 tidyverse 之后，推荐的方法是使用 tidyr 将数据转换为长格式。例如

```
dat <- read.table(text="Gene Samp1    Samp2    Samp3     Samp4    Samp5
  Gene1    84.1     45.2     34.3      54.6     76.2
  Gene2    94.2     12.4     68.0      75.3     24.8
  Gene3    29.5     10.5     43.2      39.5     45.5", header = TRUE)

dat %>% 
  # transform data to long form
  tidyr::gather("sample", "value", contains("Samp")) %>%
  # plot the data
  ggplot(aes(x = sample, y = value, col = Gene)) + geom_point() 
```

# hadoop - hadoop 中映射器的输出文件

> ID：13463295
> 
> 赞同：0
> 
> 时间：2012-11-19T22:18:27.643
> 
> 标签：hadoop

我有只使用映射器的 map-reduce 工作。现在，当我运行这项工作时，我有这些 part-m-***** 文件，它们包含不同映射器的输出。如果我想要一个映射器的一个 part-m-***** 文件，我该怎么做。可能吗 ？

![在此处输入图像描述](../Images/18a5e511f187b6ef4152c804fb4e477f.png)

# css - Twitter Bootstrap：嵌套行？

> ID：13463296
> 
> 赞同：8
> 
> 时间：2012-11-19T22:18:32.053
> 
> 标签：css, twitter-bootstrap

Twiter Bootstrap 问题：鉴于下图，我如何标记 3 个红色容器以使其流畅且响应迅速？我可以在 a 中定义一个容器/行`span*`吗？不知道如何处理这样的布局。

![在此处输入图像描述](../Images/9a45a7aa3f53acf11491298b977d7f26.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T22:24:11.560

Sure you can nest rows inside other spans as deep as you like.

```
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span9">
            <div class="span4"></div>
            <div class="span4"></div>
            <div class="span4"></div>
        </div>
        <div class="span3"></div>
    </div>
</div> 
```

that should work for your 3 containers inside the 9 row.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-14T12:38:28.590

您可以在行内嵌套行，但是您必须确保标记是正确的。

```
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span9">
            <div class="row-fluid">
                <div class="span4">...</div>
                <div class="span4">...</div>
                <div class="span4">...</div>
            </div>
        </div>
        <div class="span3">...</div>
    </div>
</div> 
```

按照链接查看工作示例。尝试在 HTML 和结果视图之间移动垂直条，您将看到响应式布局在当时和那里工作。[使用 Twitter Bootstrap 的三个响应式列](http://jsfiddle.net/rakeshtembhurne/bQNSJ/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:20:06.513

您是否尝试过这种嵌套顺序：

*   容器流体
*   行流体
*   跨度9
*   行流体
*   跨度3 跨度3 跨度3

# javascript - 它的javascript代码你能告诉我为什么它不工作吗

> ID：13463298
> 
> 赞同：-5
> 
> 时间：2012-11-19T22:18:41.090
> 
> 标签：javascript

```
<!DOCTYPE html>
<html>
<head>
<script language="javascript" type="text/javascript"> 

function changeValue()
{
    var list, index, element;
    list = document.getElementsByClassName('box-title');
    for (index = 0; index < list.length; ++index){
        element = list[index].innerHTML;
        if(element == "Related Products"){
            list[index].innerHTML = "Choose Extra To make It More Special";
            alert("Page is loaded");
        }
    }
} 
</script>
</head>
<body onload =”changeValue()”&gt;
<div class="box-title">Related Products</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:22:26.000

Mayby you have to remove the space between onload and = and change the weird double quote (also known as 'smart quotes')

So this:

```
<body onload =”changeValue()”&gt; 
```

will be this:

```
<body onload="changeValue()"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:22:04.893

Have you tried changing the `++` operator?

```
<!DOCTYPE html>
<html>
<head>
<script language="javascript" type="text/javascript"> 

function changeValue()
{
 var list, index, element;
 list = document.getElementsByClassName('box-title');
 for (index = 0; index < list.length; index++)
 {
  element = list[index].innerHTML;
    if(element == "Related Products")
{
  list[index].innerHTML = "Choose Extra To make It More Special";
  alert("Page is loaded");
}
}

} 
</script>
</head>
<body onload =”changeValue()”&gt;
<div class="box-title">Related Products</div>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:24:24.667

There's a number of reasons for which it may not be working.

For example, [`getElementsByClassName()`](http://caniuse.com/getelementsbyclassname) might be unsupported by the browser.

# jpa - EJB 3.x：使用 EntityManagerFactory 扩展或事务范围的 EnityManager

> ID：13463303
> 
> 赞同：1
> 
> 时间：2012-11-19T22:18:53.873
> 
> 标签：jpa, ejb, entitymanager

试图找出一些可能的情况，什么时候 a`EntityManagerFactory`在 EJB 中可能有用。当然，通常只需要一个事务范围`EntityManager`（JTA 范围），以便所有注入的 EntityManager 共享相同的`PersistenceContext`. 在以下情况下会发生什么：

1.  何时`@PersistenceContext(type=PersistenceContextType.EXTENDED)`使用：此 JTA 是否启用？这种 EntityManager 的请求会在 JTA 的上下文中执行吗？如果不是，那在哪一个？（注意：当然它只适用于`@Stateful`EJB）。当然很清楚，在这种情况下，EntityManager 将拥有自己的/特殊的 PersistenceContext。

2.  当一个人用于在 EJB`@PersistenceUnit`中获取 a`EntityManagerFactory`时（我想它适用于所有类型的 EJB，对吗？），获得的`Entitymanager`JTA 是否启用（当然`Entitymanager.joinTransaction()`是必要的）？如何从工厂获得事务范围（启用 JTA）或扩展实体管理器？何时使用工厂而不是实体管理器有用。（当然，很明显 EntityManagerFactory 是 Java SE 应用程序到 JPA 的唯一接口，但是 EJB 呢？）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T02:16:26.723

您的问题围绕着假设您处于一种情况，即您必须注入 @PersistenceUnit 以在 EJB 中获取 EntityManagerFactory。好吧......让我在这里叙述一些缺失的背景：

### 在 servlet 中

我们必须按照以下步骤来实例化 EntityManager：

1.  注入 @PersistenceUnit 以获取 EntityManagerFactory
2.  使用这条线： entityManager = entityManagerFactory.createEntityManager();

上述 2 个步骤保证 EntityManager 是当前线程的本地，因此是线程安全的。这种情况是 servlet 在容器注入方面可重入的一种解决方法。这意味着 servlet 将接受由容器注入的已经存在的 entityManager。

### 在 EJB 中

根据定义，EJB 在容器注入方面是不可重入的，因此我们知道容器将为 EJB 实例化一个新的本地实体管理器代理，因此是线程安全的。

### 也就是说，我们可以讨论如何/何时使用 Extended PersistenceContext

引用 JPA 规范第 294 页的 JSR-317：

> 容器管理的扩展持久性上下文只能在有状态会话 bean 的范围内启动。它从创建声明依赖于 PersistenceContextType.EXTENDED 类型的实体管理器的有状态会话 bean 开始存在，并且据说绑定到有状态会话 bean... 当容器关闭持久性上下文时有状态会话 bean 的 @Remove 方法完成（否则有状态会话 bean 实例被破坏）。

因此，可以使用属性 PersistenceContextType.EXTENDED 破坏不可重入功能，仅用于服务有状态会话 bean 语义。只要有状态会话 bean 存在，它就必须维护完全相同的 EntityManager。

### 总结

在你的第一个问题中：

> EntityManagerFactory 什么时候在 EJB 中有用？

答案是：没用。

至于你的第二个问题，我相信第一个答案和上面的背景叙述首先不需要问它！

# ios - Spatialite 和 iOS

> ID：13463305
> 
> 赞同：4
> 
> 时间：2012-11-19T22:19:02.030
> 
> 标签：ios, xcode, ios6, spatialite

我正在尝试构建最新版本的 Spatialite 以在 iOS 平台上使用，但进展不大。我已经下载了以下库的最新版本，并尝试将它们带入一个项目（每个项目都作为自己的目标）并将它们构建为一个静态库。

*   Spatialite（3.0.1合并）
*   GEOS（每晚在 20121114 上构建）
*   PROJ.4 (4.8.0)

每次下载都包含数十个文件，其中包含脚本、标题和源代码。从[这里](http://spatialteam.blogspot.com/2011/04/building-spatialite-for-iphone-ios.html)的步骤中不清楚哪些应该加载，哪些不应该加载。我尝试将每个目录中的所有文件都引入到他们自己的组中，但无济于事，我在第 2 步遇到困难，因为我的 Xcode 版本与示例中使用的版本不同。添加 PROJ.4 位时，Xcode 询问我是否要创建“外部构建系统项目”。

我还尝试从这篇[文章](https://stackoverflow.com/questions/4793970/how-to-compile-spatialite-for-ios)中获取 Lionel 的项目并更新所有软件的版本。不幸的是，Xcode 在新源代码中抛出了几十个警告，并且也抛出了一些错误。如有必要，我可以分享这些。更进一步，我什至将他的输出（一个静态库和头文件）带到另一个项目中，但由于某种原因，编译器抛出错误，说他们找不到“sqlite3”。我已将 SQLite3 添加到项目中，但并没有解决问题。

我也尝试过跟进这个[线程](https://stackoverflow.com/questions/13221006/spatialite-ios5-and-xcode-4-5-could-not-prepare-statement-no-such-function-g)，但我无法提问，所以我无法询问原始用户他/她是如何做到这一点的。

最后，一个问题：

有谁知道如何使用 Xcode 4.5 和 iOS 6 构建最新版本的 Spatialite 及其配套库（GEOS、PROJ.4）？

如果是这样，你能分享一下你是怎么做到的吗？我也想从概念上理解正在发生的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-26T09:04:58.303

我知道两种替代方法，对我来说都很好。

1.  [从libspatialite-ios](https://github.com/gstf/libspatialite-ios)获取 Makefile 和补丁，输入`make`
2.  使用名为 'spatialite' 的 Cocoapods 和 pod 或更通用的[SpatialDBKit](http://cocoadocs.org/docsets/SpatialDBKit/0.1.1/)

两者都将为您提供当前较旧的 4.1.1 版本，但这对于大多数用途来说都很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-18T12:38:59.373

**通过 CocoaPods：**

安装 pod install 的依赖项

```
brew install automake autoconf libtool 
```

然后在您的 XCode 项目中添加您的 Podfile 模板：

```
pod init 
```

添加 spatialite pod 依赖：

```
vi Podfile 
```

并将这一行添加到您的主要目标中

```
pod 'spatialite', '4.1.1' 
```

如果 Podfile 中存在现有项目，则添加工作区

```
workspace 'YourWorkspaceName' 
```

跑

```
pod install 
```

高枕无忧。完成后使用 XCode 打开工作区

# c# - 如果验证失败，清除文本框？

> ID：13463311
> 
> 赞同：1
> 
> 时间：2012-11-19T22:19:18.207
> 
> 标签：c#, asp.net, validation, textbox

当比较验证失败时，我试图清除两个不同的文本框。我曾尝试在 C# 代码中使用 .clear 方法，但 VS 不允许在 Web 表单中使用它。我正在使用 Visual Studio 2010，几乎没有任何 asp.net 经验。任何帮助，将不胜感激。

当用户在validator.isvalid 的Else 语句中按下“提交”时，我尝试了多种方式清除文本框。但似乎除非整个页面都有效，否则该程序不会触发。

这是提交按钮的代码：

```
 If valCompPassword.IsValid Then
        If Page.IsValid Then
            lblWelcome.Text = "Welcome " & txtNameFull.Text & "!"
        End If
    Else
        txtPassword.Text = ""
    End If 
```

反正有没有绕过验证并启动程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:09:30.610

您是否检查过控件的属性（即 TextBox、Button 等）**CausesValidation**？[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.causesvalidation.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.causesvalidation.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-04T01:05:47.933

将提交按钮的“原因验证”属性设置为 false 会清除密码文本框。不太清楚为什么或如何清除那些我认为它正在清除“文本模式”属性设置为密码的文本框。如果您仍想使用按钮进行验证，则必须在按钮单击代码中使用“Page.Validate”过程。

这是按钮的 C# 代码：

```
 Page.Validate()
    If Page.IsValid Then
        lblWelcome.Text = "Welcome " & txtNameFull.Text & "!"
    End If 
```

# android - 在条目对话框中完成的操作

> ID：13463312
> 
> 赞同：3
> 
> 时间：2012-11-19T22:19:17.827
> 
> 标签：android

我有一个标准的条目弹出对话框

```
 AlertDialog.Builder builder = new AlertDialog.Builder(activity);

    builder.setTitle(title)
        .setMessage(message)
        .setPositiveButton(buttonPositif, new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                   // Send the positive button event back to the host activity
                   mListener.onDialogPositiveClick(EntryDialogFacade.this);
               }
           })
        .setNegativeButton(buttonNegatif, new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                   // Send the negative button event back to the host activity
                   mListener.onDialogNegativeClick(EntryDialogFacade.this);
               }
           });        

    editText = new EditText(activity);
    editText.setLines(1);
    editText.setImeOptions(EditorInfo.IME_ACTION_DONE);
    builder.setView(editText);

    Dialog dialog = builder.create();        
    dialog.show(); 
```

我正在尝试在输入字段键盘上显示“完成”按钮（请参阅代码片段），但是，这种方式不起作用。

会有人经历过同样的事情吗？

干杯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:45:00.963

你需要使用`setSingleLine(true)`而不是`setLines(1)`然后你需要一个`EditorActionListener`来抓住`Done`钥匙。

```
editText.setSingleLine(true);
editText.setImeOptions(EditorInfo.IME_ACTION_DONE);
editText.setOnEditorActionListener(new OnEditorActionListener() {

    @Override
    public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
        Toast.makeText(MainActivity.this, "Got IME Done", Toast.LENGTH_SHORT).show();
        return true;
    }
}); 
```

# django - 在 Django 模型表单中包含一个 editable=False 字段作为 HiddenInput

> ID：13463317
> 
> 赞同：1
> 
> 时间：2012-11-19T22:19:38.927
> 
> 标签：django, django-models, django-forms

所以我们最近升级到 Django 1.4，我注意到模型表单处理带有可编辑=假的模型字段的方式发生了变化。

如果我有一个用户模型：

```
class User(models.Model):
    id              = UUIDField(primary_key=True, default=uuid4str)
    name            = models.CharField(max_length=128) 
```

其中 UUIDField 自动具有 kwargs['editable'] = False，然后尝试制作一个模型形式：

```
class UserFormSelf(ModelForm):
    class Meta:
        model = models.User
        fields = ('id', 'name',)
        widgets = {
        'id': HiddenInput()
            } 
```

运行时出现以下错误：

“为用户指定的未知字段（ID）”

根据文档，[如果为 False，该字段将不会显示在管理员或任何其他 ModelForm 中。默认为真。](https://docs.djangoproject.com/en/dev/ref/models/fields/#editable). 但是，由于该字段是隐藏的并且仅用于我可以确定正在编辑哪个用户，因此应该有一种方法可以在表单中允许它，对吗？

我真的不希望 id 是可编辑的，但是如果这是我可能需要的唯一解决方案。也许它可以是可编辑的，但是如果它不是一个新对象，那么在保存时，我会引发一个异常。想知道是否可以先使用 editable=False 来做到这一点。

谢谢你的帮助！

编辑：显然无法检查 id 字段是否已被编辑并在 pre_save 上编写自定义“editable = False”，因为 pre_save 自动认为一个对象是新的，如果它有一个新的 id。如果您无法提供上述问题的答案，但知道如何执行此操作，请也告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:21:16.010

为什么不自己显示价值？表单用于输入/输出，并且如果记录已经存在，大概您的 UUID 将在您端计算或为应用程序所知。由于您没有提供模板代码，因此我很难举个例子，但是如果您`as_p()`用于显示表单，只需添加类似于`<p>Id: {{ object.id }}</p>`在编辑现有对象的情况下的内容。

# user-interface - 获取拖放手势的放置点

> ID：13463321
> 
> 赞同：1
> 
> 时间：2012-11-19T22:20:02.853
> 
> 标签：user-interface, drag-and-drop, javafx-2

我认为使用 JavaFX 应该很容易做到这一点——所以我一定在某处遗漏了这一点。我有一个从工具栏到 AnchorPane 的简单拖放操作，效果很好，但是我试图找出放置的确切位置，以找出在已经存在的一组节点中插入新项目的位置。事件对象 DragEvent 告诉您目标对象，但不告诉您它相对于目标的放置位置（仅相对于源）。我尝试只听目标上的所有鼠标释放事件，但不会触发拖动到对象上。有谁知道这应该怎么做？

迈克·沃茨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T08:46:16.500

您可以使用这些`getSceneX/Y`方法来获取放置位置的绝对坐标，也可以在 AnchorPane 上安装一个侦听器来侦听 DRAG_OVER DragEvents。DRAG_OVER 事件在它被丢弃之前发生的最后一个位置是它被丢弃的位置。

# winapi - 使用编辑控件样式进行富编辑

> ID：13463325
> 
> 赞同：0
> 
> 时间：2012-11-19T22:20:09.663
> 
> 标签：winapi

我有一个丰富的编辑控件，像这样创建的，

```
 box = CreateWindowEx(
                0, 
                MSFTEDIT_CLASS, 
                L"Type here", 
                WS_VISIBLE | WS_CHILD | WS_TABSTOP | SS_OWNERDRAW,
                position.x,
                position.y,
                dimensions.x,
                dimensions.y,
                owner,
                0,
                hinst,
                0); 
```

该文档表明`ES_LEFT`将左对齐文本，这就是我正在寻找的。但是当我将它添加到样式列表中时，什么也没有发生。如何设置此编辑控件样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:57:12.000

就像您在 的第四个参数中使用任何其他样式一样`CreateWindowEx()`：

```
WS_VISIBLE | WS_CHILD | WS_TABSTOP | ES_LEFT 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-18T18:35:54.813

```
#define ES_CENTER   1
#define SS_OWNERDRAW 0xd 
```

这是微软的 BUG：不幸`ES_CENTER`的是包含在`SS_OWNERDRAW`.

# javascript - HTML window.scroll 方法只能在 localhost 上正常工作

> ID：13463326
> 
> 赞同：0
> 
> 时间：2012-11-19T22:20:20.847
> 
> 标签：javascript, html, firefox

我尝试调用 parent.scroll 和 parent.window.scroll 从子框架滚动浏览器窗口。然而，

本地主机测试：适用于 IE、Firefox 和 Chrome。生产/非本地主机：仅适用于 Chrome。

你们能告诉我为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:25:17.067

我想你可能只想使用 window.scroll(X, Y)，或者 window.scrollBy(X, Y)。在这两种情况下都省略了“父母”

如果我是对的并且您正在尝试滚动到特定的其他部分，则使用 scrollBy 或 scrollTo 可能是一个不错的方法。

# java - 首选项类覆盖默认行为

> ID：13463329
> 
> 赞同：0
> 
> 时间：2012-11-19T22:20:32.837
> 
> 标签：java, android, sharedpreferences, android-preferences

我不喜欢 Android`SharedPreferences`类的工作方式。我的主要原因是每次在应用程序的任何部分查找键值对时都必须指定默认值。鉴于大多数应用程序可能会在多个位置调用这些值，这种方法确实会在预期的应用程序/偏好行为中引发错误，因为没有中心点可以获取您的*默认* 设置。示例：活动 A getBoolean(key133, false)，活动 B getBoolean(key133, true)：问题。

我通过在 a 中指定/存储我所需的应用程序首选项值来规避这个问题`HashMap`，并且我有一个自定义派生类，它懒惰地在指定的 s`SharedPreferences`中查找默认值。`HashMap`我只是说一个 MyClass.getBoolean(key) 或 MyClass.getString(key)，它会在 中查找默认值，`HashMap`如果它不存在，则返回并存储（.commit()-ing）它。默认行为是调用`getBoolean(key, default_value)`. 这也有利于性能，因为在应用程序初始化时存储所有首选项在性能方面非常糟糕。

一个问题解决了，但现在我有了一个新问题：所有`Preference`派生类都找不到默认值，因为我无法使用自己的`SharedPreference`派生方式来查询默认的应用程序设置。这导致我的应用程序工作正常，但我的设置实际上并没有显示默认值，因为在第一次打开设置页面时它们还没有（总是）存储......

长话短说：我如何覆盖`Preference`课程以防止这种情况发生？

编辑：一些代码来解释问题以及我为什么选择这种方式

```
private final static Context context                    = ApplicationSubclass.getApplicationContext_();
private final static SharedPreferences prefs            = PreferenceManager.getDefaultSharedPreferences(context);  
private final static SharedPreferences.Editor editor    = prefs.edit();
public static Map<String, Boolean> booleans             = new HashMap<String, Boolean>();
public static Map<String, Integer> longs                = new HashMap<String, Integer>();
public static Map<String, String> strings               = new HashMap<String, String>();
public static Map<String, Integer> integers             = new HashMap<String, Integer>();

public aPreferences(){
    initialise();
}//end constructor

public void initialise(){
    // setup default preferences
    setBooleans();
    //setLongs();
    setStrings();
    //setIntegers();
}//end method   

private void setBooleans(){
    booleans.put("does_this_work", true);
    booleans.put("is_it_easy", true);
    booleans.put("is_it_free_of_problems", false);
    // and some hundreds more
}//end method

private void setStrings(){
    strings.put("show_me", "Show me!");
    // and some hundreds more
}//end method

// work the magic here
public boolean getBoolean(String key){
    if (!prefs.contains(key)) putBoolean(key, booleans.get(key));
    return prefs.getBoolean(key, booleans.get(key));
}//end method

public void putBoolean(String key, boolean value){
    editor.putBoolean(key, value).commit();
}//end method 
```

这有效：

```
private static aPreferences values = new aPreferences();
if (values.getBoolean("does_this_work")) // value initialised upon first access
    Log.d(getClass().getSimpleName(), values.getString("show_me")); 
```

这不会：

```
CheckBoxPreference sound = new CheckBoxPreference(this);
sound.setKey("does_this_work"); // value not initialised, so checkbox not checked
sound.setTitle(getResources().getString(R.string.sound_title));
sound.setSummary(getResources().getString(R.string.sound_text));
root.addPreference(sound); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:04:14.613

我实际上建议创建自己的首选项管理类来处理这样的事情。如果您需要知道默认值是什么，您可以设置自己的全局 get/set 方法并将默认值公开为公共静态字段。像这样的东西：

```
public class MyPreferences {

    private static final String INT_VALUE_1_KEY = "VALUE_1";
    public static final int INT_VALUE_1_DEFAULT = -1;

    public static void setDefaults(Context c) {
       SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(c);
       Editor edit = prefs.edit();

       if (!prefs.contains(INT_VALUE_1_KEY)) {
          edit.putInt(INT_VALUE_1_KEY, INT_VALUE_1_DEFAULT);
       }
       // etc..

       edit.commit();
    }

    public static int getValue1(Context c) {
       SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(c);
       return prefs.getInt(INT_VALUE_1_KEY, INT_VALUE_1_DEFAULT);
    }
} 
```

# magento - Magento 和 Paypal - 取消并返回

> ID：13463333
> 
> 赞同：1
> 
> 时间：2012-11-19T22:20:43.880
> 
> 标签：magento, paypal

在我的 Magento 商店中，我启用了 Onepage 结帐和 Paypal 模块。当一些客户选择 Paypal 选项作为付款方式并完成订单时，他们将被重定向到 Paypal 站点（在这里您可以登录到 Paypal 或以 paypal 访客身份结帐或取消并返回我的 magento 商店）。当客户选择最后一个“取消并返回我的 magento 商店”时，他们将被重定向到标准购物车，而我不会按照我的意愿进行 Onepage 结帐。也许有什么建议？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T12:01:37.380

我在 app\code\core\Mage\Checkout\controllers\ 中找到了这个

```
protected function _goBack()
{
    $returnUrl = $this->getRequest()->getParam('return_url');
    if ($returnUrl) {
        // clear layout messages in case of external url redirect
        if ($this->_isUrlInternal($returnUrl)) {
            $this->_getSession()->getMessages(true);
        }
        $this->getResponse()->setRedirect($returnUrl);
    } elseif (!Mage::getStoreConfig('checkout/cart/redirect_to_cart')
        && !$this->getRequest()->getParam('in_cart')
        && $backUrl = $this->_getRefererUrl()
    ) {
        $this->getResponse()->setRedirect($backUrl);
    } else {
        if (($this->getRequest()->getActionName() == 'add') && !$this->getRequest()->getParam('in_cart')) {
            $this->_getSession()->setContinueShoppingUrl($this->_getRefererUrl());
        }
        $this->_redirect('checkout/cart');
    }
    return $this;
} 
```

您是否想修改此代码以更正 URL（结帐/购物车/）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:21:47.757

我的驱动器上现在没有 Magento 来查看确切的目录结构，但是在 PayPal 结帐模块中，当调用 SetExpressCheckout 时，他们正在为 ReturnURL 设置一个值。

您需要编写一个模块来使用您自己的使用正确 URL 的模块来覆盖他们的 SEC 请求，或者他们可能已经有专门用于生成 ReturnURL 的方法，因此您可以直接覆盖它。

您可以创建一些逻辑来根据商家选择的结帐类型生成 URL，这似乎是他们的核心模块所缺少的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T14:57:33.017

我找到了解决方案，我希望这个解决方案有人帮助。

在 app\code\core\Mage\Paypal\Controller\Express\Abstract.php

行号 152。有重定向代码。将其更改为以下。

```
 $this->_redirect('checkout/onepage/'); 
```

这将完成你的工作。

# c# - 在 C# 中管理多对多关系

> ID：13463336
> 
> 赞同：0
> 
> 时间：2012-11-19T22:20:47.013
> 
> 标签：c#, asp.net, many-to-many

*我正在尝试在应用程序级别*以多对多关系管理一些简单的列表。`teacher.AddStudent()`每次在它们之间建立连接（例如，`student.RemoveTeacher()`）时，我都希望更新两个对象中的关系。

我知道如果我使用 SQL，我会使用类似`StudentTeacher`table 的东西来管理关系，但我试图了解如何在应用程序中执行此操作。

```
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;

namespace StudentTeacher
{
    // create simple interface
    public interface IPerson {}

    // abstract class
    public abstract class Person : IPerson 
    {
        public int Id { get; set; }
    }

    // concrete "Teacher"
    public class Teacher : Person
    {
        // private list of student ids
        private List<int> _studentIds { get; set; }

        // readonly accessor
        public ReadOnlyCollection<int> StudentIds {
            get { return _studentIds.AsReadOnly(); }
        }

        // constructor
        public Teacher(int id) {
            Id = id;
            _studentIds = new List<int>();    
        }

        // add a student
        public void AddStudent(Student student)
        {
            if (!_studentIds.Contains(student.Id)) {
                _studentIds.Add(student.Id);
                student.AddTeacher(this);
            }
        }

        // remove a student
        public void RemoveStudent(Student student)
        {
            if (_studentIds.Contains(student.Id)) {
                _studentIds.Remove(student.Id);
                student.RemoveTeacher(this);
            }
        }

        public string ToString() {
            return String.Format("Id:{0} | StudentIds:{1}", Id, String.Join(",", StudentIds));
        }
    }

    /// concrete "Student"
    public class Student : Person
    {

        // private list of teacher ids
        private List<int> _teacherIds { get; set; }

        // readonly accessor
        public ReadOnlyCollection<int> TeacherIds {
            get { return _teacherIds.AsReadOnly(); }
        }

        // constructor
        public Student(int id) {
            Id = id;
            _teacherIds = new List<int>();    
        }

        // add a teacher
        public void AddTeacher(Teacher teacher)
        {
            if (!_teacherIds.Contains(teacher.Id)) {
                _teacherIds.Add(teacher.Id); 
                teacher.AddStudent(this);
            }
        }

        // remove teacher
        public void RemoveTeacher(Teacher teacher)
        {
            if (_teacherIds.Contains(teacher.Id)) {
                _teacherIds.Remove(teacher.Id);
                teacher.RemoveStudent(this);
            }
        }

        // simple override
        public string ToString() {
            return String.Format("Id:{0} | TeacherIds:{1}", Id, String.Join(",", TeacherIds));
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            // create teachers
            var teacher1 = new Teacher(101);
            var teacher2 = new Teacher(102);

            // create students
            var student1 = new Student(501);
            var student2 = new Student(502);
            var student3 = new Student(503);

            // create some relationships
            teacher1.AddStudent(student1);
            teacher1.AddStudent(student2);
            teacher1.AddStudent(student3);

            // see what's happening
            Console.WriteLine(teacher1.ToString()); // "Id:101 | StudentIds:501,502,503"
            Console.WriteLine(student1.ToString()); // "Id:501 | TeacherIds:101"
            Console.WriteLine(student2.ToString()); // "Id:502 | TeacherIds:101"
            Console.WriteLine(student3.ToString()); // "Id:503 | TeacherIds:101"

            // update student1, student2
            student1.AddTeacher(teacher2);
            student2.AddTeacher(teacher2);

            // -- Outputs 
            Console.WriteLine(student1.ToString()); // "Id:501 | TeacherIds:101,102"
            Console.WriteLine(student2.ToString()); // "Id:502 | TeacherIds:101,102"

            Console.ReadLine();
        }
    }
} 
```

对我来说，直接调用相反方向的添加/删除方法感觉不对；

```
if (!_studentIds.Contains(student.Id)) {
    _studentIds.Add(student.Id);
    student.AddTeacher(this); // calling this directly feels bad
} 
```

我有一种感觉，这很快就会变得非常混乱。我的问题是；

*   我是否应该寻找添加诸如静态观察者之类的东西 `StudentTeacherObserver`并在其上引发事件，例如 `OnTeacherAdded`，`OnStudentAdded`？
*   是否有管理此类关系的特定模式？
*   是否有适合此目的的更好的数据结构，如果有，它是什么以及如何使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T03:10:39.267

嵌套对象图 ( `Teacher.Students[0].Teacher...`) 通常会让人感到“混乱”，尤其是在决定是延迟加载关系（聊天）还是先加载所有对象，然后映射引用（胖）时。

不过，我认为你并没有想太多。如果不对数据访问做出某种类型的让步，多对多很难正确表示。我认为您需要更深入地评估您的业务问题，以发现更具体的场景以确定您是否需要更改任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T05:20:08.793

最简单的事情就是选择一个赢家。所以不要实现这两种情况。这是一个有一点背景的链接：

[http://www.ebenroux.co.za/post/2009/09/09/Many-to-Many-Aggregate-Roots.aspx](http://www.ebenroux.co.za/post/2009/09/09/Many-to-Many-Aggregate-Roots.aspx)

你必须想出适合你的方法。表示真实的对象也不总是一个好主意。简单地存储相关 ID 可能就足够了。在`Order`/`OrderItem`以`Product`示例中。可能没有理由在其中包含实际`Product`对象，`OrderItem`因为它不是`Order`聚合的一部分。您只`Product`使用`OrderItem`. 直到执行`Order`操作（实际上有人开始填充`Order`），它都可以更改。当然，关于停止流程（取消订单）和退回产品等的业务规则可能很繁琐，但从一种情况/业务到下一种情况/业务会发生变化。

关键是尝试“切割”您的对象图，以便您拥有明确定义的聚合。

这有助于延迟加载位。我从不使用延迟加载，并且会敦促我遇到的任何人尽最大努力避免它。这个想法实际上不是查询您的对象/域模型，但这完全是另一个讨论。

我希望这是有道理的 ：）

# c - 操作系统使用的数据结构来实现动态内存管理的堆？

> ID：13463337
> 
> 赞同：-6
> 
> 时间：2012-11-19T22:20:53.473
> 
> 标签：c, data-structures, heap-memory

操作系统使用哪种数据结构来实现动态内存管理中使用的堆内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:01:33.927

我发现链表的派生是堆管理的一个很好的候选者。

在具有非常小的受限内存区域的嵌入式系统上，不同的内存池效率更高。一个内存池可以用于小（字节单元）分配，并使用位向量来判断分配了哪些块。另一个用于中等或经常分配的块的内存池和用于不经常分配的块的剩余区域。

这个想法是以低内存开销有效地分配内存块并减少碎片。

一些操作系统使用*虚拟内存*的概念，其中内存被分页到外部设备，例如硬盘驱动器。当 OS 接收到*page fault*时，表示访问内存页面之外，它会从外部设备加载一个页面。

希望有帮助。

# javascript - 带有 xml DOM 的 Chrome getElementsByTagName() 返回不正确的 NodeList

> ID：13463339
> 
> 赞同：3
> 
> 时间：2012-11-19T22:20:54.193
> 
> 标签：javascript, ajax, google-chrome

> **可能重复：**
> [Chrome：禁用同源策略](https://stackoverflow.com/questions/3102819/chrome-disable-same-origin-policy)

所以关于我的问题的一些背景信息：

*   为画廊编写 JavaScript 文件；从 xml 文件中提取数据，[这里](https://www.dropbox.com/s/yjqlz43jcd8224n/gallery_info.xml)。
*   使用异步加载，使用 XMLHttpRequest() 加载 DOM 对象。
*   使用 DOMParser 解析 responseText 以生成 DOM 对象。
*   在 FireFox 上工作，在 Chrome 上失败。

**编辑（请阅读）：**

> 使用 console.log 后，Chrome 似乎报告了一个跨域问题：
> 
> *   加载资源文件失败：./Gallery/dropdown_style.css
> *   XMLHttpRequest 无法加载文件：./Gallery/gallery_info.xml。仅 HTTP 支持跨源请求。
> *   节点列表[0]
> *   长度：0
> *   未捕获的错误：NETWORK_ERR：XMLHttpRequest 异常 101
> *   加载资源失败 ./Gallery/Pictures/bg_one.jpg
> 
> 现在我的问题是：
> 
> 1.  如何在本地级别（离线）解决此问题？
> 2.  即使我将所有文件上传到同一台服务器，这仍然是一个问题吗？
> 3.  如果是这样，那么解决方案是什么（在线）？

现在 DOM 对象通过了，大概在 Firefox 和 Chrome 上都是正确的。并在以下代码中：

```
window.alert(xmlDoc.getElementsByTagName("pic")); 
```

它返回“HTML Collection”的响应，或者在 Chrome 中返回“NodeList”。但是当我在 Chrome 中询问 NodeList 的长度时，它返回 0，这意味着 NodeList 的格式不正确，或者不是我想要的那样。

在 FireFox 中，长度将返回值 2，这正是我想要的。

这是我的源代码，没有多余的行话：

```
var elemPic = [];

function initGallery(xmlFName){

    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("GET", xmlFName, true);
    xmlhttp.onreadystatechange = function(){
        if (xmlhttp.readyState == 4){ //since it's offline and local, don't check status == 200
            //use a DOMParser, which is in a different file
            myCallBack(parseXml(xmlhttp.responseText));
        }
    }
    xmlhttp.send();
}

function myCallBack(xmlDoc){
    //window.alert(xmlDoc);
    elemPic = xmlDoc.getElementsByTagName("pic");
    //window.alert(elemPic);

    for(var i = 0; i < elemPic.length; i++){
        //whats the source path?
        var src = elemPic[i].getElementsByTagName('src')[0].childNodes[0].nodeValue;
        window.alert(src);
    }
} 
```

这是我的整个源文件夹，如果你想看的话：[Source Folder](https://www.dropbox.com/sh/up0zrncfa6bfw1j/cPy_ijYd9q)

我不确定这是哪个问题：

1.  DOM xml 对象已损坏
2.  节点列表已损坏
3.  getElementsByTagName() 的总体 Chrome 问题
4.  其他

如果你们能帮助我确定问题的确切根源和解决方案，那么我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T02:30:37.657

答案：看起来问题出在同源策略上。对于本地访问，将文件上传到本地 Web 服务器，或更改 Chrome 设置以进行测试。如果上传到服务器应该没有问题。

非常感谢 Luminously、Diego Pino 和 Bergi 用户。

解决问题的步骤：

1.  使用 console.log() 而不是 window.alert() - 它更加详细和准确。
2.  本地：将文件上传到本地网络服务器或更改 Chrome 设置（禁用网络安全）
3.  全局：如果上传到服务器没有问题。

# sql - 如何比较两个表

> ID：13463340
> 
> 赞同：3
> 
> 时间：2012-11-19T22:20:55.127
> 
> 标签：sql, sql-server, sql-server-2008

我有两个表（`Original`和`Load`），我想使用存储过程比较它们。

数据库是 SQL Server 2008。

这是我的示例 SP：

```
USE [TestDB]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[ValidateLoad] 
AS 
    SET nocount ON; 

    IF EXISTS(SELECT * 
              FROM   dbo.original 
              EXCEPT 
              SELECT * 
              FROM   dbo.LOAD) 
      BEGIN 
          PRINT 
      'Warning! The following information has not been loaded' 

       PRINT '---------------------------------' 

       PRINT 'Load result: Fail' 

          SELECT * 
          FROM   dbo.original 
          EXCEPT 
          SELECT * 
          FROM   dbo.LOAD 

      set noexec on
      END 

    IF EXISTS(SELECT * 
              FROM   dbo.LOAD 
              EXCEPT 
              SELECT * 
              FROM   dbo.original) 
      BEGIN 
          PRINT 
      'Warning! The following information does not exist in Original table' 

       PRINT '---------------------------------' 

       PRINT 'Load result: Fail' 

    SELECT * 
    FROM   dbo.LOAD 
    EXCEPT 
    SELECT * 
    FROM   dbo.original 

    set noexec on
END 

    PRINT 'Load result: Succeeded' 
```

我觉得效率不是很高。

我的目的是验证这两个表/数据集是否相同，如果不是，则输出结果并带有有意义的错误消息。

任何想法？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:32:49.477

假设您至少有一个具有 NOT NULL 约束的列 c1，那么此查询应该为您提供任一表中缺少的所有行的列表：

```
SELECT t1.*,t2.* 
FROM dbo.original t1 full outer join dbo.LOAD t2
ON (list of join keys)
WHERE t1.c1 IS NULL or t2.c1 IS NULL 
```

不过，不确定它与基于 EXCEPT 的查询相比效率如何，您需要尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:25:00.077

您是否考虑过使用合并语句比较两者。

当不匹配时插入#temp。然后您可以显示临时表的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T11:45:02.470

一般情况下的回答：

```
SELECT * FROM tableA
UNION 
SELECT * FROM tableB
EXCEPT 
SELECT * FROM tableA 
INTERSECT
SELECT * FROM tableB; 
```

* * *

详细解答：

问：字母 SQL 代表什么？A. 几乎没有资格作为一门语言...... ROFL 但请考虑以下严重问题：

```
CREATE TABLE MyTable
   ( ID INTEGER NOT NULL UNIQUE, data_col VARCHAR(10) NOT NULL );

DECLARE @MyTable TABLE 
   ( ID INTEGER NOT NULL UNIQUE, data_col VARCHAR(10) NOT NULL ); 
```

现在提问：

问：在语言（计算机科学）术语中，是`@MyTable`一个变量吗？一口井...

问题 1：无法将表值分配给`@MyTable`eg

```
-- Assignment attempt 1:
SET @MyTable = MyTable;  -- COMPILE ERROR

-- Assignment attempt 2:
SET @MyTable = ( VALUES ( 1, NULL ), ( 2, '' ), ( 3, 'Test' ) );  -- COMPILE ERROR 
```

问题 2：无法比较变量，例如

```
-- Comparison attempt 1:
IF ( @MyTable = @MyTable ) BEGIN; 
    PRINT 'Tables are the same.' 
END;  -- COMPILE ERROR

-- Comparison 2:
IF ( @MyTable = ( VALUES ( 1, NULL ), ( 2, '' ), ( 3, 'Test' ) ) ) BEGIN; 
    PRINT 'Tables are the same.' 
END;  -- COMPILE ERROR 
```

...所以我们必须相信 @MyTable 是一个既不支持赋值也不支持比较的“变量”。

问：如果`@MyTable`是一个变量，在语言（计算机科学）术语中是`MyTable`什么？A. 常数？价值？类型？班级？结构？以上都不是？

...是的，SQL 确实是一种非常奇怪的语言！

问：什么是关系运算符？A. 在关系模型中，它是一个以两个关系值作为参数并返回一个关系值作为结果的运算符。

问：SQL 是否支持关系运算符？答：不完全是。SQL 确实具有真正关系语言的用户所熟悉的运算符（`UNION`、`INTERSECT`、`EXCEPT`等）。但是，SQL 支持非关系特性，最显着的是空值、重复行和重复列名。因此，需要非常小心地确保这些运算符的参数和结果等价于关系。

Q 如何使用 SQL 的“关系式”运算符比较两个表的相等性？A 这是一种方法：

```
SELECT * FROM tableA
UNION 
SELECT * FROM tableB
EXCEPT 
SELECT * FROM tableA 
INTERSECT
SELECT * FROM tableB; 
```

测试以证明上述内容（注意以下*并非*所有关系值，但确实证明了运算符在 SQL 空值上的逻辑工作）：

示例 1：表相同（期望零行 == PASS）：

```
WITH tableA AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 2, '' ), 
                              ( 3, 'Test' )
                     ) AS T ( ID, data_col ) ),
     tableB AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 2, '' ), 
                              ( 3, 'Test' )
                     ) AS T ( ID, data_col ) )
SELECT * FROM tableA
UNION 
SELECT * FROM tableB
EXCEPT 
SELECT * FROM tableA 
INTERSECT
SELECT * FROM tableB; 
```

示例 2：tableB 是 tableB 的真子集（期望行 == FAIL）：

```
WITH tableA AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 2, '' ), 
                              ( 3, 'Test' )
                     ) AS T ( ID, data_col ) ),
     tableB AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 2, '' ) 
                     ) AS T ( ID, data_col ) )
SELECT * FROM tableA
UNION 
SELECT * FROM tableB
EXCEPT 
SELECT * FROM tableA 
INTERSECT
SELECT * FROM tableB; 
```

示例 3：tableA 是 tableB 的真子集（期望行 == FAIL）：

```
WITH tableA AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 3, 'Test' )
                     ) AS T ( ID, data_col ) ),
     tableB AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 2, '' ), 
                              ( 3, 'Test' )
                     ) AS T ( ID, data_col ) )
SELECT * FROM tableA
UNION 
SELECT * FROM tableB
EXCEPT 
SELECT * FROM tableA 
INTERSECT
SELECT * FROM tableB; 
```

示例 4：tableA 和 tableB 有一些但不是所有的共同行值（期望行 == FAIL）：

```
WITH tableA AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 4, 'Lone' )
                     ) AS T ( ID, data_col ) ),
     tableB AS
     ( SELECT * FROM ( VALUES ( 1, NULL ), 
                              ( 4, 'Sole' )
                     ) AS T ( ID, data_col ) )
SELECT * FROM tableA
UNION 
SELECT * FROM tableB
EXCEPT 
SELECT * FROM tableA 
INTERSECT
SELECT * FROM tableB; 
```

示例 5：tableA 和 tableB 没有共同的行值（期望行 == FAIL）：

```
WITH tableA AS
     ( SELECT * FROM ( VALUES ( 5, NULL ), 
                              ( 6, 'Different' )
                     ) AS T ( ID, data_col ) ),
     tableB AS
     ( SELECT * FROM ( VALUES ( 7, NULL ), 
                              ( 8, 'Not the same' )
                     ) AS T ( ID, data_col ) )
SELECT * FROM tableA
UNION 
SELECT * FROM tableB
EXCEPT 
SELECT * FROM tableA 
INTERSECT
SELECT * FROM tableB; 
```

问：为什么 SQL Server DBA 倾向于不使用这种语法，而更喜欢使用`FULL OUTER JOIN`. A. 可能出于多种原因，例如熟悉遗留语法（例如`EXCEPT`在 SQL Server 2005 中引入）。但最有可能的是，SQL DBA 倾向于编写他们认为最有效的查询（贬义，过早优化）。确实，SQL Server 优化器不能很好地处理运算符`INTERSECT`和`EXCEPT`.

问：为什么更喜欢“关系型”运算符？A. 因为它们不那么冗长并且可以说更容易阅读。这两个都是测试代码的好品质。

# jquery-ui - 返回 ajax 数组的回调不起作用？

> ID：13463341
> 
> 赞同：0
> 
> 时间：2012-11-19T22:21:09.633
> 
> 标签：jquery-ui, jquery

回调始终为空

```
// calling the function
var returnArray = getArrayData(fileName, function(data) {
    return data;
})
alert(returnArray); // output says undefined

function getArrayData(fileName, callback) {
    var arrayData = [];
    $.getJSON("sendRequestFile", {
        fileContent: fileName
    }, function(data) {
        $.each(data, function(index, value) {
            if (value === "false") {} else if (value === "") {} else {
                arrayData[index] = value;
            }
        });
        alert(arrayData); // see data without no problems
    });
    alert(arrayData); // empty
    callback(arrayData); // undefined
}​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:24:46.427

Ajax is asynchronous, run the callback within the complete callback.

```
$.getJSON("sendRequestFile", {
    fileContent: fileName
}, function(data) {
    $.each(data, function(index, value) {
        if (value === "false") {} else if (value === "") {} else {
            arrayData[index] = value;
        }
    });
    callback(arrayData); // worky
});
//alert(arrayData); // empty
//callback(arrayData); // undefined​ 
```

# c - WINAPI 代表什么

> ID：13463346
> 
> 赞同：12
> 
> 时间：2012-11-19T22:21:17.353
> 
> 标签：c, windows, api, winapi, winmain

我已经开始在 C 中学习 Win32 API。我看到 main 函数类似于

```
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,
LPSTR lpCmdLine, int nCmdShow) { .. } 
```

但我知道 C 中的函数就像

```
[ReturnType] [FunctionName] (Args) { .. } 
```

在这种情况下，返回类型是 int，函数名称是 WinMain。那么WINAPI代表什么，有必要吗？

谢谢你 。:)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-19T22:27:53.313

它指定了[调用约定](http://www.codeproject.com/Articles/1388/Calling-Conventions-Demystified)，即函数参数在堆栈上的放置和管理方式。

您可以混合调用约定，例如，如果您正在调用一些外部代码，例如 Windows API，只要每个人都在同一个“页面”上，都符合他们的期望。

典型的 c 调用是使用所谓的 cdecl 编译的。在 cdecl 中，调用者清除压入堆栈的参数。

WINAPI，也称为“标准调用”，是指被调用的函数负责清理其参数的堆栈。

MS 编译器将使用 _ 作为 cdecl 调用的前缀，而 WINAPI 获取前导 _ 并在破坏函数名称时在函数名称前添加 @{BYTES-NEEDED}。从上面的链接：

```
call        _sumExample@8  ;WINAPI
call        _someExample   ;cdecl 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-19T22:24:47.537

它是“调用约定”，定义为宏，`#define`并解析为[`__stdcall`](http://msdn.microsoft.com/en-us/library/zxk0tw93%28v=vs.110%29.aspx).

[在 MSDN 上](http://msdn.microsoft.com/en-us/library/office/bb687850.aspx)阅读更多信息：

> 名称的修饰方式取决于语言以及编译器如何被指示使函数可用，即调用约定。DLL 使用的 Windows 的标准进程间调用约定称为 WinAPI 约定。它在 Windows 头文件中定义为 WINAPI，而后者又使用 Win32 声明符 __stdcall 定义。

* * *

## 回答 #3

> 赞同：-9
> 
> 时间：2013-11-23T18:41:37.850

赢 - Windows

API - 应用程序编程接口

Windows 应用程序编程接口

# php - PHP - TimeSpan From DateTime

> ID：13463351
> 
> 赞同：0
> 
> 时间：2012-11-19T22:21:38.837
> 
> 标签：php

I have a date in the format of "14/11/2012 4:26:10 PM" pulled from a mysql query.

I'm not very experienced with PHP, but how can i calculate a simple timespan between dates "Then" and "Now"?

And format it in a human readable string? for example... "1hour, 5 minutes ago".

I've tried to search for a solution and i found one that i thought worked but it didn't account for the AM/PM so it ended up causing a problem when i converted it to a time stamp. does anyone have any idea?

This is what i am trying to do but this does not work so well:

```
$time = $row["NotificationSent"];           
            list($day, $month, $year, $hour, $minute) = split('[/ :]', $time); 
            $timestamp = mktime($hour, $minute,0, $month, $day, $year);         
            $j = TimeSince($timestamp); 
```

the timesince function i found off google that I'm using is:

```
 function TimeSince($original) // $original should be the original date and time in Unix format
    {
        // Common time periods as an array of arrays
        $periods = array(
            array(60 * 60 * 24 * 365 , 'year'),
            array(60 * 60 * 24 * 30 , 'month'),
            array(60 * 60 * 24 * 7, 'week'),
            array(60 * 60 * 24 , 'day'),
            array(60 * 60 , 'hour'),
            array(60 , 'minute'),
            );

        $today = time();
        $since = $today - $original; // Find the difference of time between now and the past

        // Loop around the periods, starting with the biggest
        for ($i = 0, $j = count($periods); $i < $j; $i++)
        {
            $seconds = $periods[$i][0];
            $name = $periods[$i][1];

            // Find the biggest whole period
            if (($count = floor($since / $seconds)) != 0)
            {
                break;
            }
        }

        $output = ($count == 1) ? '1 '.$name : "$count {$name}s";

        if ($i + 1 < $j)
        {
            // Retrieving the second relevant period
            $seconds2 = $periods[$i + 1][0];
            $name2 = $periods[$i + 1][1];

            // Only show it if it's greater than 0
            if (($count2 = floor(($since - ($seconds * $count)) / $seconds2)) != 0)
            {
                $output .= ($count2 == 1) ? ', 1 '.$name2 : ", $count2 {$name2}s";
            }
        }
        return $output;
    } 
```

The returned result is formatted to what I'm looking for but is giving incorrect numbers. "19/11/2012 2:48:53 PM" is returning "1 day, 5 hours" but it should be "17 hrs, 32 mins"

Any help is appreciated.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:30:55.200

看，这就是`DateTime`对象来救援的地方：

```
<?php

$time = DateTime::createFromFormat("d/m/Y g:i:s A", "14/11/2012 4:26:10 PM");;
$now = new DateTime;

$diff = $time->diff($now);
var_dump($diff); 
```

你得到了准确的区别，你可以用你喜欢的任何方式格式化它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:29:33.093

如果您有人类可读的时间戳，则可以使用`strtotime()`将其转换为 unix 时间戳：

[http://php.net/manual/en/function.strtotime.php](http://php.net/manual/en/function.strtotime.php)

然后只需从该值中减去`time()`即可获得过去的时间（以秒为单位）。

# c# - RadioGroupItem's description html string

> ID：13463353
> 
> 赞同：0
> 
> 时间：2012-11-19T22:21:47.760
> 
> 标签：c#, .net, devexpress

I am using DevExpress' RadioGroupItem and I need to send HTML text to its description.RadioGroupItem does not provide AllowHtmlString property.Is there a way to do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T05:01:00.943

据我所知，RadioGroupItem 没有嵌入式[HTML 文本格式](http://documentation.devexpress.com/#WindowsForms/CustomDocument4874)支持。无论如何，您可以在这方面跟踪以下票证：[RadioGroupItem 提供在项目描述中使用 HTML 文本的能力](http://www.devexpress.com/Support/Center/p/S32827.aspx)

# ios - iOS Custom button title is blurry

> ID：13463362
> 
> 赞同：1
> 
> 时间：2012-11-19T22:22:13.937
> 
> 标签：ios, button, title, blurry

If I create a button in IB, and set only the type to be Custom, the Title and font size, it comes out nice and clear. If I create it programmatically, then the font comes out fuzzy. The code to create the button is:

CGRect frame = self.sendButton.frame;

```
 NSString *title = @"Read Disclosure";
    UIFont *font = [UIFont boldSystemFontOfSize:17.0];
    CGSize titleSize = [title sizeWithFont:font constrainedToSize:frame.size];

    CGFloat xValue = (self.view.frame.size.width - titleSize.width) / 2;
    CGFloat yValue = frame.origin.y - (titleSize.height / 2);

    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];

    [button setFrame:CGRectMake(xValue, yValue, titleSize.width, titleSize.height * 2)];
    [button setTitle:@"Read Disclosure" forState:UIControlStateNormal];
    [button.titleLabel setFont:font];
    [button setTitleColor:[UIColor colorWithRed:50.0/255.0 green:79.0/255.0 blue:133.0/255.0 alpha:1.0] forState:UIControlStateNormal];
    [button setTitleShadowColor:nil forState:UIControlStateNormal];
    [button setTitleColor:[UIColor whiteColor] forState:UIControlStateHighlighted];
    [button addTarget:self action:@selector(disclosureButtonAction) forControlEvents:UIControlEventTouchUpInside];

    [self.view addSubview:button]; 
```

I've tried every setting I can think of, and nothing seems to make a difference. Any idea of what I'm missing here?

Thanks.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T22:31:20.200

您应该确保框架的`x`、`y`、`width`和`height`是整数。`round`您可以使用/ `floor`/手动执行此操作`ceil`，或者[`CGRectIntegral`](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGGeometry/Reference/reference.html#//apple_ref/c/func/CGRectIntegral)如果您不需要那么多手动控制，请使用。您的按钮落在非整数像素边界上，可能是因为代码中的浮点除以 2。这是[这个问题](https://stackoverflow.com/questions/1254657/uitextfield-blurred-text)的副本。

请注意，它`sizeWithFont:`也可能返回非整数浮点数。

# xcode - Xcode static library without source files (only aggregating other static libraries)

> ID：13463366
> 
> 赞同：1
> 
> 时间：2012-11-19T22:22:23.050
> 
> 标签：xcode, static-libraries

There is a library (Xcode project intended to add as subproject) with plenty of small static libraries. The user can decide to use some of them, or all of them. To ease setup for the user who decides to use all of them I would like to create one bigger, "container" static library, which would contain all the smaller static libraries.

The problem is, that after adding to the new app, the container library is not built, unless I add at least one dummy source file.

The compiler error is ld: library not found for -lContainerLibraryName clang: error: linker command failed with exit code 1 (use -v to see invocation)

This dummy source file might be empty, no properties, no methods. Does anyone out there know, why the static library needs to include at least one source file? Otherwise it will not build, even if it contains other static libraries.

Is there any way to force static library to build even if it does not contain any source file?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:25:26.693

您应该尝试将 -all_load 添加到构建设置下的“其他链接器标志”中。

# mysql - How to query records containing certain number?

> ID：13463371
> 
> 赞同：-5
> 
> 时间：2012-11-19T22:22:50.163
> 
> 标签：mysql, sql

Edited: How to query records containing certain number, USING REGEXP?

Data base:

```
id | number
1 | ["5","8","9","19","1"]
2 | ["2","3","8","11","10"]
3 | ["1","14","3","22","15"]
4 | ["20","8","4","6","7"]
5 | ["3","9","14","20","10"] 
```

In sql, how to query only the records that have the number 8, for example? (Id's 1, 2 and 4)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:28:43.533

你没有告诉我们数据类型号是什么，所以我假设它是文本。

```
Select * from mytable
Where number like '%"8"%' 
```

# qt - 调试模式下的内存损坏 (?)

> ID：13463375
> 
> 赞同：0
> 
> 时间：2012-11-19T22:23:09.803
> 
> 标签：qt, winapi, dll, mingw, dynamic-linking

我需要使用[`GetVolumeInformationW`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364993%28v=vs.85%29.aspx). 由于未知的原因，我决定`Kernel32.dll`动态加载，在运行时解析函数地址……结果是内存损坏问题和修改堆栈的一些奇怪的副作用。虽然静态版本就像一个魅力，我可以坚持下去继续前进，但我想调查这件事。

源代码是不言自明的（如果您需要更多信息，请评论，完整版可以在[这里](http://pastebin.com/z9PJz8NE)找到）：

```
#include <QtDebug>
#include <QByteArray>
#include <QLibrary>
#include <QDir>

static inline QString LAT1(const char *str, const int len = -1) {
    return QString::fromLatin1(str, len);
}

template <typename T>
static inline QByteArray createByteArray(const T *from, const int numElements) {
    return QByteArray(reinterpret_cast<const char*>(from), sizeof(T) * numElements);
}

// This one resolves functions from Kernel32.dll dynamically and uses standard types.
// (Dynamic linking.)
QByteArray fingerprintDynamic() {
    const uint32_t kMaxPath = 260 + 1;  // MAX_PATH + 1
    wchar_t path[kMaxPath]       = {0};
    wchar_t name[kMaxPath]       = {0};
    wchar_t fileSystem[kMaxPath] = {0};
    uint32_t serial = 0;
    uint32_t maximumComponentLength = 0;
    uint32_t fileSystemFlags = 0;

    QLibrary kernel32("kernel32");
    typedef uint32_t (*fnGetLastError)(void);
    typedef bool (*fnGetVolumeInformationW)(const wchar_t*, wchar_t*, uint32_t, uint32_t*, uint32_t*,
                                            uint32_t*, wchar_t*, uint32_t);
    fnGetVolumeInformationW GetVolumeInformationW = reinterpret_cast<fnGetVolumeInformationW>(kernel32.resolve("GetVolumeInformationW"));
    fnGetLastError GetLastError = reinterpret_cast<fnGetLastError>(kernel32.resolve("GetLastError"));

    if (!GetVolumeInformationW) {
        qWarning(LAT1("GetVolumeInformationW() not resolved: %1").arg(kernel32.errorString()).toLatin1().constData());
        return QByteArray();
    }
    else if (!GetLastError) {
        qWarning(LAT1("GetLastError() not resolved: %1").arg(kernel32.errorString()).toLatin1().constData());
        return QByteArray();
    }

    QDir::toNativeSeparators(QDir::rootPath()).toWCharArray(path);
    bool apiCall = GetVolumeInformationW(path, name, kMaxPath, &serial, &maximumComponentLength,
                                         &fileSystemFlags, fileSystem, kMaxPath);
    if (!apiCall)
        qWarning(LAT1("GetVolumeInformationW() failed: %1").arg(GetLastError()).toLatin1().constData());

    // At this point, fileSystem is correct and contains
    // L"NTFS"

    // ONLY HAPPENS IN DEBUG MODE
    //
    // After this call memory becomes corrupted. wcslen() is not a problem.
    // And createByteArray<>() is ok too, I believe.
    //size_t len;  // But if I change stack a bit (like uncomment this line),
                   // result will be correct, so I guess it's related to memory offset.
    return createByteArray<wchar_t>(fileSystem, wcslen(fileSystem));
}

void print(const QByteArray &bytes) {
    qDebug() << QString::fromWCharArray(reinterpret_cast<const wchar_t*>(bytes.constData()));
    qDebug() << bytes.size() << "bytes" << bytes.toHex();
    qDebug() << "";
}

int main(int, char**)
{    
    qDebug() << "dynamic";
    print(fingerprintDynamic());

    return 0;
} 
```

样本输出：

```
// this is DEBUG build
dynamic 
"(?(" 
8 bytes "280052f828000400"

// this is RELEASE build
// (same with `size_t len` uncommenented before `return` in DEBUG)
dynamic 
"NTFS" 
8 bytes "4e00540046005300" 
```

**问题是**：这种行为的原因是什么？我的错误在哪里？

我正在使用`g++.exe (GCC) 4.4.0`,`Qt 4.8.1`和`Creator 2.5.2`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:29:38.403

该问题可能是由调用约定不匹配引起的。`GetVolumeInformationW()`具有调用约定`WINAPI`，因此将函数指针类型更改为：

```
typedef BOOL (WINAPI *fnGetVolumeInformationW)(const wchar_t*,
                                               wchar_t*,
                                               uint32_t,
                                               uint32_t*,
                                               uint32_t*,
                                               uint32_t*,
                                               wchar_t*,
                                               uint32_t); 
```

`WINAPI`是调用约定[`__stdcall`](http://msdn.microsoft.com/en-us/library/zxk0tw93%28v=vs.100%29.aspx)，而默认是[`__cdecl`](http://msdn.microsoft.com/en-us/library/zkwh89ks%28v=vs.100%29.aspx). 注意返回类型是`BOOL`，而不是`bool`。

# azure - 为运行 Windows Server 2012 的 azure 更正 gacutil 命令语法

> ID：13463377
> 
> 赞同：1
> 
> 时间：2012-11-19T22:23:22.627
> 
> 标签：azure, startup, gac, windows-server-2012

我有一个使用[Pkcs12ProtectedConfigurationProvider](http://archive.msdn.microsoft.com/pkcs12protectedconfg)的项目。以 windows server 2008 sp2 或 r2 为目标时，在 azure 中使用此 dll 从来没有任何问题。但是，当我尝试使用 windows server 2012 (osFamily="3") 部署到 azure 时，我收到一个异常，指出找不到程序集。

我隐约记得在模拟器中遇到过这个问题，解决方案是将这个 dll 添加到 GAC。我在谷歌上搜索并找到了有关如何将 DLL 作为天蓝色启动任务安装到 GAC 中的[说明。](http://blogs.infosupport.com/adding-assemblies-to-the-gac-in-windows-azure/)只要我在 web 角色项目的根目录中拥有 gacutil 和相关的 .cmd 文件，一切都可以正常工作。但是，我想将它移动到应用程序的 /startup 文件夹中，其中我有其他启动命令。

到目前为止，我一直无法让它发挥作用。gacutil 也不是很有帮助，因为在对它运行命令后，我无法让它显示任何输出。这是我尝试过的：

在 csdef 文件中：

```
<Startup>
  <!-- other tasks, such as disabling the IIS idle timeout -->
  <Task commandLine="startup\gacRegistrations.cmd" executionContext="elevated" taskType="simple" />
</Startup> 
```

在 gacRegistrations.cmd 文件中：

```
gacutil /nologo /i ..\PKCS12ProtectedConfigurationProvider.dll
exit /b 0 
```

我认为问题与引用 cmd 文件中 dll 位置的语法有关。所有相关文件都设置为构建操作：无并复制到输出目录：始终复制。但是，gacutil.exe 和 cmd 文件被复制到 webrole/bin/startup，而 PKCS12ProtectedConfigurationProvider.dll 文件位于 webrole/bin 中的 1 个文件夹中。

这里的正确语法是什么？我应该尝试`gacutil /nologo /i ..\.\PKCS12ProtectedConfigurationProvider.dll`吗？就像我说的，当文件没有嵌套在 /startup 目录中时，一切正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:39:55.070

当前目录始终是 bin 文件夹，因此您应该尝试以下操作：

```
startup\gacutil /nologo /i PKCS12ProtectedConfigurationProvider.dll
exit /b 0 
```

# ajax - ajax user connexion

> ID：13463379
> 
> 赞同：-1
> 
> 时间：2012-11-19T22:23:27.823
> 
> 标签：ajax, cordova

I'm trying to get userconnexion in Ajax (will be used in Phonegap application).

I've no javascript error but my ajax function is always with error status without details.

This is my form :

```
<form id="loginForm">
                <div data-role="fieldcontain" class="ui-hide-label">
                    <label for="username">Username:</label>
                    <input type="text" name="username" id="user"/>
                </div>
                <div data-role="fieldcontain" class="ui-hide-label">
                    <label for="password">Password:</label>
                    <input type="password" name="password" id="pass"/>
                    </div>
                <input type="text" size="25" id="message" value="error" />
                <input type="button" value="Submit" id="sendButton"/>
                    </form> 
```

This is my Js file

```
$(document).ready(function(){
    $(window).load(function(){
        $('#sendButton').click(function() {
             var user = $("#user").val();
             var pass = $("#pass").val();
             $.ajax({
                 url: "http://myurl.php",
                 type: "GET",
                 data: { username: user, password: pass },
                 success: function (html) {alert(html); },
                 error: function(){alert('false');}
              });
         });

    });
}); 
```

This is my php file

```
<?php
$user = $_GET['username'];
$pass = $_GET['password'];

$link = mysql_connect('dbhost', 'dblogin', 'dbpss');
if (!$link) {
  die('Could not connect: ' . mysql_error());
}
mysql_select_db('dbname',$link); 

$result = mysql_query("SELECT email, mdp, id FROM auteur WHERE email = '$user'");
while($row = mysql_fetch_array($result)){
  if(md5($pass) == $row["mdp"]){
     echo $row["id"];
  } else {
     echo '';
  }
} 
?> 
```

About my PHP I've try [http://myurl.php?password=test&username=test](http://myurl.php?password=test&username=test) and I get my ID, so I think this part works.

But when I try form with same value, I get a 'false', so an error...

I'm a newbie, someone can explain me my errors ?

Thanks a lot !

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:40:04.083

```
<script>
    function submitme(){
         var user = $("#user").val();
         var pass = $("#pass").val();
         $.ajax({
             url: "http://myurl.php",
             type: "GET",
             data: { username: user, password: pass },

          }).done(function(answer){
             alert(answer + 'server is saying okay');
       });
    }
</script> 
```

html:

```
 <form id="loginForm">
            <div data-role="fieldcontain" class="ui-hide-label">
                <label for="username">Username:</label>
                <input type="text" name="username" id="user"/>
            </div>
            <div data-role="fieldcontain" class="ui-hide-label">
                <label for="password">Password:</label>
                <input type="password" name="password" id="pass"/>
                </div>
            <input type="text" size="25" id="message" value="error" />
            <input type="button" value="Submit" id="sendButton" onclick="submitme()"/>
    </form> 
```

试试这个代码。

# ruby-on-rails-3 - Rails 3 CanCan 授权范围所有权

> ID：13463380
> 
> 赞同：2
> 
> 时间：2012-11-19T22:23:30.020
> 
> 标签：ruby-on-rails-3, devise, cancan, before-filter

我正在建立一个学校系统，教师可以在其中管理各自学校范围内的教室。

我有以下匹配的能力设置：

```
class Ability
  include CanCan::Ability

  #define the user ability
  def initialize(user)
    user ||= User.new # guest user (not logged in)    
    if user.has_role? :instructor
      can :manage, Classroom do |classroom|
        classroom.new_record? && classroom.school_id == user.school_id || classroom.instructor == user
      end
    end
  end 

end 
```

从理论上讲，这应该使教师能够管理与教师设置无关的新记录，只要教师和新教室都属于同一所学校。

在我的课堂新动作中，我从父学校构建教室以适应这种情况`@classroom = @school.classrooms.build`。这将使用 school_id 初始化新的教室记录，从而使教师能够管理该记录。然而，在我的教室控制器中，我调用`load_and_authorize_resource`了在学校与教室关系建立之前授权教师并引发 CanCan 授权异常。

有没有办法解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:34:42.807

CanCan 可能在与学校建立联系之前检查能力。您可以明确打破创建和管理权限：

```
can :create, Classroom
can :manage, Classroom, instructor_id: user.id 
```

然后在验证中检查教室是否属于教师的学校。

# javascript - 在数组中查找具有相似值的数字

> ID：13463381
> 
> 赞同：4
> 
> 时间：2012-11-19T22:23:30.423
> 
> 标签：javascript, arrays, algorithm

我正在使用 Javascript。我有一个在 3d 空间中有点的数组，我希望这些点不要非常靠近数组中的其他点。我的意思是，我希望点之间的距离大于`x`. 现在我正在做的是有一个双循环比较距离并将点在 Z 维度上移动得更远，比如

```
while(there_are_objects_that_are_close){
    for(all_the_objects){
        for (all_the_objects){
            if (distance_between_them < 100){
                object[i].z += 150;      
            }
        }
     }
} 
```

问题是我讨厌这个算法，它看起来很慢，我正在寻找更好的解决方案。如果您有一个解决方案，它也是具有文学背景的“有名字的算法”，我会更感激它，因为这是我们学校项目的一部分。

![](../Images/ae343eefb09ff5095a355922c52818aa.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:49:53.310

将每个点与每个点进行比较确实是最简单的，因此您的算法是一个好的开始。

这样做的缺点是，当点的数量变得巨大时，算法将开始表现得很糟糕，因为它必须将每个点与所有点进行比较，而大多数点并不接近。在这种情况下，您可能希望以仅检查可能足够接近的点的方式拆分点。

对于静态点（那些不移动的点），制作一棵树是微不足道的，这样您只需遍历几个父节点并检查其子节点（距离较近的子节点距离更近）。这也称为 R 树，也存在其他选项。

![](../Images/cdaa054601930e3e9078e8804cc6e766.png)

这也适用于 3D。

![](../Images/c76c0290bb30a3244ca6c29016fe9a33.png)

[两张图片均来自维基百科。]

从视觉上你可以看到它变得更加简单，你只需选中你半径内的框，你最终会做更少的工作。

对于动态点（那些移动的点），保持如此详细的 R 树存在可能是不可行的。因此，我们将不得不降低细节级别，并在您的方法和 R 树之间寻找一些东西，例如，制作稍大的框是一种方法。

其他方法包括使用四边形（每次将一个立方体分成 4 个较小的立方体，只要它包含一个点）和一个网格（创建许多大小相同的立方体）。[您可以在此处](http://openlife.cc/blogs/2012/august/spatial-data-structures)阅读有关 R 树和其他结构的更多信息，它可以很好地作为对它们的介绍。

例如，它的派生是将地球分割成三角形的测地线网格，尽管这可能不适用于 3D（除非您将三角形与地球中间的顶点连接起来）。

![](../Images/64512121a6f07c93bfb5e09ac620ea37.png)

[图片来自维基百科。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T03:47:23.847

需要找到一种方法将点分成更小的区域进行比较。

由于您只能通过更改 Z 维度来移动点，所以我的第一个想法是按 Z 维度值对点进行排序，并且只比较 Z 维度上接近的点。但是我仍然不知道如何划分区域。

# parsing - Scala - 带有查询字符串解析器和构建器 DSL 的 URL

> ID：13463387
> 
> 赞同：18
> 
> 时间：2012-11-19T22:23:50.010
> 
> 标签：parsing, scala, url, query-string, dsl

在 Scala 中，如何以编程方式构建带有查询字符串参数的 URL？

另外，如何将`String`包含带有查询字符串参数的 URL 解析为允许我以编程方式编辑查询字符串参数的结构？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-10-26T20:21:36.423

Spray 有一个非常[高效的 URI 解析器](https://github.com/spray/spray/blob/master/spray-http/src/main/scala/spray/http/Uri.scala)。用法是这样的：

```
import spray.http.Uri
val uri = Uri("http://example.com/test?param=param") 
```

您可以像这样设置查询参数：

```
uri withQuery ("param2" -> "2", "param3" -> 3") 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-19T22:23:50.010

以下库可以帮助您解析和构建带有查询字符串参数的 URL（免责声明：这是我自己的库）：[https ://github.com/lemonlabsuk/scala-uri](https://github.com/lemonlabsuk/scala-uri)

它提供了一个 DSL 来构建带有查询字符串的 URL：

```
val uri = "http://example.com" ? ("one" -> 1) & ("two" -> 2) 
```

您可以解析 uri 并将参数转换为`Map[String,List[String]]`如下所示：

```
val uri = parseUri("http://example.com?one=1&two=2").query.params 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-02T23:29:16.923

Theon的图书馆看起来很不错。但如果你只想要一种快速编码方法，我有这个。它处理可选参数，并且还会从[spray-json](https://github.com/spray/spray-json "喷雾-json")识别 JsValues并在编码之前压缩打印它们。（这些恰好是我必须担心的两件事，但是您可以轻松地扩展匹配块以用于您想要对其进行特殊处理的其他情况）

```
import java.net.URLEncoder
def buildEncodedQueryString(params: Map[String, Any]): String = {
  val encoded = for {
    (name, value) <- params if value != None
    encodedValue = value match {
      case Some(x:JsValue) => URLEncoder.encode(x.compactPrint, "UTF8")
      case x:JsValue       => URLEncoder.encode(x.compactPrint, "UTF8")
      case Some(x)         => URLEncoder.encode(x.toString, "UTF8")
      case x               => URLEncoder.encode(x.toString, "UTF8")
    }
  } yield name + "=" + encodedValue

  encoded.mkString("?", "&", "")
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-07-19T10:54:59.583

**sttp 为此**提供了一个很好的 URI 插值器。

请参阅此处的[文档](https://sttp.softwaremill.com/en/latest/model/uri.html#uri-interpolator)

这里是它的例子：

```
import sttp.client._
import sttp.model._

val user = "Mary Smith"
val filter = "programming languages"

val endpoint: Uri = uri"http://example.com/$user/skills?filter=$filter"

assert(endpoint.toString ==
  "http://example.com/Mary%20Smith/skills?filter=programming+languages") 
```

如您所见，它会自动对所需部分进行编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-25T08:40:08.540

还没有提到派送。

[https://dispatchhttp.org/Defining+requests.html](https://dispatchhttp.org/Defining+requests.html)

```
val myRequest = host("somehost.com") / "some" / "path" <<? Map("id" -> "12345") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-27T06:32:22.880

也很有用：[https ://github.com/mobiworx/urlifier](https://github.com/mobiworx/urlifier)

```
val url = (http || "some-domain".de) ? german & version(1) & foobar
url.toString 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-15T14:01:19.773

试试 KFoundation 的 URL 类。它既是构建器又是解析器。

例如

```
val url1 = URL("http://exampel.net/path")
val url2 = url1/"subpath"        // -> http://exampel.net/path/subpath
val url3 = url2?("key"->"value") // -> http://exampel.net/path/subpath?key=value 
```

API 文档：[https](https://mscp.co/resouces/apidoc/kfoundation/scala/0.3/net/kfoundation/scala/io/URL.html) ://mscp.co/resouces/apidoc/kfoundation/scala/0.3/net/kfoundation/scala/io/URL.html 依赖：[https ://search.maven.org/artifact/net.kfoundation/ kfoundation-scala_2.13/0.3.1/jar](https://search.maven.org/artifact/net.kfoundation/kfoundation-scala_2.13/0.3.1/jar)

# sml - smlnj 中的 Compose 函数

> ID：13463389
> 
> 赞同：1
> 
> 时间：2012-11-19T22:24:02.123
> 
> 标签：sml

我必须编写一个函数 compose，它接受一元函数列表 f1,...,fn 和一个值 v 作为参数并计算 f1(f2(... (fn(v)) ...))...在 SMLNJ

我正在尝试使用内置的咖喱实现来制作它的咖喱版本，有什么建议吗？

如何用自己的咖喱技术实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:31:40.873

使用 时`::`，请删除模式周围的方括号。否则，您匹配一个元素是另一个嵌套列表的 1 元素列表。

此外，您定义中的第二种情况似乎是多余的。

# c - Using Piezo electric sensors for Touch input gesture profiles in C

> ID：13463390
> 
> 赞同：1
> 
> 时间：2012-11-19T22:24:06.763
> 
> 标签：c, hardware, signal-processing, gesture

I'm working on a project that takes touch input from Piezo-electric sensors and turns those gestures into MIDI commands that are sent to an external device. I've worked through all of the nuances of our ADC and have managed to build it out from front to back using a simple "tap" as a command. A "tap" would look something like this

[![tap](../Images/e416a075b111192ebad475d9c6c453cf.png)](https://i.stack.imgur.com/6Bqdr.jpg)
[(source: [evolver.fm](http://evolver.fm/media/Oscilloscope/oscilloscope2.jpeg))]

And here's what the tap "profile" I built looks like for detection on our DSP chip (in C)

```
/* Tap Detection Function */

short tap_detect(float *x, int len){

int threshold = 200;  //calibration
int taplen = 500;
int i,j;
float y[len];
float avg = 0.0;

for(i = 0; i < len; i++){

    if(x[i] < 0)
        y[i] = x[i] * -1000;
    else
        y[i] = x[i] * 1000;

    if(y[i] >= threshold && i < len-taplen-20){

        for(j = i+taplen-20; j <= i+taplen+20; j++)
            avg += y[j];

        avg /= 41.0;
        if(avg <= 0.2*y[i])
            return 1;
    }
}

return 0;

} 
```

So my question is, where would I start for writing a similar "profile" for something like a circle? or a swipe? I'm just not sure where to start with this.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:29:08.973

开始记录和比较，特别是观察手势之间的差异，这样你就可以区分它们。总之听起来并不容易。

# asp.net - 如何在 ASMX Web 方法中生成 500 错误？

> ID：13463391
> 
> 赞同：0
> 
> 时间：2012-11-19T22:24:09.567
> 
> 标签：asp.net, web-services, asmx

我有一个提供各种搜索实用程序的 ASMX Web 服务。如果我的用户输入的搜索条件太少，我希望 Web 服务返回带有自定义消息的 HTTP 500。我该怎么做呢？由于浏览器内的操作能力，我不想处理客户端输入不足的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:29:29.663

HTTP 500 表示内部错误。抛出一个未处理的异常应该会给你一个 HTTP 500。

```
throw new Exception("Your error message"); 
```

但是，这样做可能不是一个好主意。

更好的方法是抛出 SOAP 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:31:36.333

如果你只是抛出任何`Exception`它会产生 HTTP 500 错误

```
throw new Exception(); 
```

# python - 按元素对python中的列表进行排名

> ID：13463393
> 
> 赞同：0
> 
> 时间：2012-11-19T22:24:21.703
> 
> 标签：python, list, rank

我正在尝试使用 Python 中的 Lists 进行奖牌统计排名之类的事情。我有一个不断增长的列表。列表中的每个元素都是一个包含四个元素的列表。

例如：`L = [[0,1,2,3],[3,0,6,2]]`

我正在尝试对这个列表中的元素进行排名，结果结果是（对于上面的例子）：

`L = [[3,0,6,2],[0,1,2,3]]`即类似于奖牌计数，内部列表中的第一个元素是金，第二个是银等

有没有一种简单的方法可以在 python 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:27:16.140

你可以只使用内置的，[排序的](http://docs.python.org/2/library/functions.html#sorted)

```
sorted(L, reverse=True) 
```

[编辑：以上将按金总数排序，然后是银数等。这似乎是对金属进行排名的最常用方法（请参阅[此处的金属理货）](http://www.topendsports.com/events/summer/medal-tally/rankings.htm)。您还可以定义自己的函数，并使用 cmp 关键字以不同的方式对它们进行排名。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:37:14.447

不需要做任何花哨的事情，这就是内置的具体`sorted`功能。

```
L = [[0,1,2,3],[3,0,6,2],[3,0,5,2],[3,0,6,3],[11,1,0,0],[3,0,7,1]]
sorted(L,reverse=True)

[[11, 1, 0, 0],
 [3, 0, 7, 1],
 [3, 0, 6, 3],
 [3, 0, 6, 2],
 [3, 0, 5, 2],
 [0, 1, 2, 3]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:31:44.487

如果您正在寻找的是基于谁拥有最多奖牌的降序排序，您可以使用：

```
L = [[0,1,2,3],[3,0,6,2],[0,0,0,22]]
sorted(L, key=sum, reverse=True) 
```

指定`sum`为键会导致 sorted 调用每个元素上的函数来计算键值。

# ruby-on-rails-3 - 使用 Savon 的响应元素集合出现问题

> ID：13463398
> 
> 赞同：1
> 
> 时间：2012-11-19T22:24:38.680
> 
> 标签：ruby-on-rails-3, savon

我正在尝试使用 Savon 与使用 SOAP 的旧式 Web 服务进行通信。关于 Savon 如何从响应信封中构造散列，我遇到了问题。

```
client = Savon.client("http://my-service-endpoint/?wsdl")

response = client.request :my_soap_operation do
  soap.body do |xml|
    xml.in("test")
  end
end

response.to_hash[:my_soap_operation_response][:out].each do |a|
   puts "Return element: #{a}"
   puts "Name #{a[:name]}"
   puts "Type #{a[:type]}"
   puts "Code #{a[:code]}"
end 
```

结尾

如果 SOAP 响应包含超过 1 个“out”元素，例如：

```
<mySoapOperationResponse>
  <out>
   <code>C1947944</code>
   <name>Use</name>
   <type>type 1</type>
 </out>
 <out>
   <code>C1947946</code>
   <name>name 2</name>
   <type>type 2</type>
 </out>
 <out>
   <code>C1947947</code>
   <name>name 2</name>
   <type>type 3</type>
 </out>
</mySoapOperationResponse> 
```

输出如预期：

```
Return element: {:code=>"C1947944", :name=>"Use", :type=>"type 1"}
Name Use
Type type 1
Code C1947944
Return element: {:code=>"C1947946", :name=>"name 2", :type=>"type 2"}
Name name 2
Type type 2
Code C1947946
Return element: {:code=>"C1947947", :name=>"name 2", :type=>"type 3"}
Name name 2
Type type 3
Code C1947947 
```

但是，如果 SOAP 响应只包含一个“out”元素，例如：

```
<mySoapOperationResponse>
     <out>
        <code>C1947944</code>
        <name>name 1</name>
        <type>type 1</type>
     </out>
</mySoapOperationResponse> 
```

我在控制台中看到了这个

```
Return element: [:code, "C1947944"] 
```

...然后我收到错误消息

```
can't convert Symbol into Integer 
```

看起来 :name 和 :type 元素似乎不存在于 SOAP 响应中，但是我可以通过响应 XML 消息看到它们。

我正在使用 Savon v1.2.0。

**附录**

我添加了以下代码以尝试进一步调试该问题：

```
 response = client.request :my_soap_operation do
  soap.body do |xml|
    xml.in("test")
  end
 end

pp response.to_hash

response.to_hash[:my_soap_operation_response][:out].each do |a|
   pp a
   puts "Return element: #{a}"
   puts "Name #{a[:name]}"
   puts "Type #{a[:type]}"
   puts "Code #{a[:code]}" 
```

我可以看到响应哈希中的元素被打印得很漂亮。这是控制台的快照：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<soapenv:Body>
    <mySoapOperationResponse>
        <out>
            <code>C1947944</code>
            <name>name 1</name>
            <type>type 1</type>
        </out>
    </mySoapOperationResponse>
 </soapenv:Body>
</soapenv:Envelope>

{:my_soap_operation_response=>
    {:out=>{:code=>"C1947944", :name=>"name 1", :type=>"type 1"},
        :@xmlns=>"http://namespace.removed.com/"}}

[:code, "C1947944"]
Return element: [:code, "C1947944"] 
```

但是，似乎在 .each 循环内部（循环每个“out”元素），只能访问第一个元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T02:33:55.170

我认为问题在于，在第二种情况下，Savon 不会返回数组。您需要检查 [:out] 是数组还是单个值并采取相应措施。我所做的是将单个值包装到一个元素的数组中，以保持我的程序结构简单。

```
def wrapped_soap_call
  # prepare Savon::Client to your liking
  client = Savon::Client.new do
    # your stuff here
  end

  # call the SOAP WS
  result = client.request :wsdl, :function do
    # your stuff here
  end

  list = result.to_hash[:response][:out]
  # if there was only one item list is not an array!
  if list.is_a? Array
    return list
  else
    return Array.new << list
  end
end 
```

这对我行得通。

# django - How to design shopping basket using session?

> ID：13463399
> 
> 赞同：11
> 
> 时间：2012-11-19T22:24:43.247
> 
> 标签：django, database-design, shopping-cart

```
class Product(models.Model):
    name = models.CharField(max_length=50)
    slug = models.SlugField()
    unit_price = models.DecimalField(max_digits=5, decimal_places=2) 
```

I'am newbie to Django. How to design shopping basket using session? (ask for a general "algorithm" or some example code)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-20T01:49:37.903

我不会使用模型。您可以将值直接存储在会话中。考虑到您可以将所有内容存储在会话中，您可以将项目存储在字典中，执行类似的操作。

```
def view_cart(request):
    cart = request.session.get('cart', {})
    # rest of the view

def add_to_cart(request, item_id, quantity):
    cart = request.session.get('cart', {})
    cart[item_id] = quantity
    request.session['cart'] = cart
    # rest of the view 
```

# python - 将变量构建到 python zip 脚本中

> ID：13463400
> 
> 赞同：0
> 
> 时间：2012-11-19T22:24:45.493
> 
> 标签：python, zip, archive

在开始之前，我正在尝试创建一个 python zip 脚本，它将拍摄 target_dir 的快照，将其压缩，将其保存在 temp 文件夹中，并为其指定“now”变量的文件名。这是我的代码：

```
#!/usr/bin/env python

import os
import sys
import datetime

now = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M")
target_dir = '/var/lib/data'
temp_dir='/tmp'

zip = zipfile.ZipFile('/tmp/example.zip', 'w', zipfile.ZIP_DEFLATED)
rootlen = len(target_dir) + 1
for base, dirs, files in os.walk(target_dir):
   for file in files:
      fn = os.path.join(base, file)
      zip.write(fn, fn[rootlen:]) 
```

我不知道如何让这一行改为使用变量“now”和“temp_dir”而不是硬编码目的地：

```
zip = zipfile.ZipFile('/tmp/example.zip', 'w', zipfile.ZIP_DEFLATED) 
```

我想我想要这样的东西（伪代码）：

```
zip = zipfile.ZipFile('<temp_dir>/<now>.zip', 'w', zipfile.ZIP_DEFLATED) 
```

谁能告诉我这应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:28:06.673

简而言之，，`os.path.join(temp_dir, now + '.zip')`但我不确定这是否真的是你要问的。因为我不知道你是怎么做到的并被困在这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:29:52.000

Python 字符串格式化允许您将变量的内容放入字符串中，即

```
zip = zipfile.ZipFile('%s/%s.zip' % (temp_dir, now), 'w', zipfile.ZIP_DEFLATED) 
```

字符串格式化将“%s”的出现替换为格式化运算符之后元组中的字符串`%`。

或者（更清洁），使用`os.path.join`您稍后在代码中使用的相同：

```
zip = zipfile.ZipFile(os.path.join(temp_dir, now+".zip"), 'w', zipfile.ZIP_DEFLATED) 
```

os.path.join 是一个函数，它根据文件系统使用的任何逻辑将文件系统路径的元素粘合在一起，因此它将使用`\`而不是`/`在路径中使用该字符的操作系统中。字符串连接 is just `+`，因此将文件结尾粘合`.zip`到另一个 string `now`，`now+".zip"`就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:45:55.410

您还可以在[shutil](http://docs.python.org/2/library/shutil.html)中使用更高级别的函数：

```
>>> import shutil
>>> from time import strftime
>>> now = strftime("%Y-%m-%d_%H-%M")
>>> shutil.make_archive('/tmp/file_%s' % now, 'zip', '/usr/games/')
'/tmp/file_2012-11-19_22-43.zip' 
```

# java - 如何为 cURL 创建和运行命令行脚本

> ID：13463405
> 
> 赞同：1
> 
> 时间：2012-11-19T22:24:52.120
> 
> 标签：java, web-services, curl, command-line, scripting

我正在尝试测试我刚刚编写但我不熟悉 cURL 的 Web 服务。谁能提供一些简单的脚本以及如何在 Windows 命令行中运行它们？

# javascript - 有没有办法逐步完成 DOM 加载？

> ID：13463407
> 
> 赞同：2
> 
> 时间：2012-11-19T22:25:05.360
> 
> 标签：javascript, dom, firebug, google-chrome-devtools

我在一个网站上工作，我已经设置了一些响应规则。在某一点之后，似乎有一个奇怪的灰色形状出现了一秒钟然后消失了。

是否可以在元素加载时单步执行 DOM？我无法弄清楚是什么元素导致了这种情况，这显然是我正在改变的东西，但无法将其锁定。

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:29:09.427

我不知道这是否可行，但您可以尝试在页面顶部附近放置类似的内容：

```
<script type="text/javascript">
debugger;
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:39:37.513

chrome中有一个`--show-paint-rect`选项。

观看Paul Irish 的视频：使用[Chrome DevTools 查看绘画行为](http://www.youtube.com/watch?v=Ea41RdQ1oFQ)

~~虽然我有一段时间没有尝试过，但不确定当前版本对它的支持程度......~~

**编辑：**

好吧，好像他们把它移到了开发工具中。显示开发人员工具后，单击设置图标（工具面板的右下角）。有“显示油漆矩形”复选框。检查后，您可以重新加载页面以查看其呈现方式。

不过，最初的实现似乎更有效率。

# c++ - 给定种子和偏移量，生成下一个伪随机值

> ID：13463411
> 
> 赞同：0
> 
> 时间：2012-11-19T22:25:30.450
> 
> 标签：c++, c, linux, random

对于给定的实现，是否有可能`rand`在给定初始种子和`rand`到目前为止的调用次数的情况下有效地生成序列中的下一个数字？

我想要的是用来`rand`为模拟中的节点提供时间偏移。每个节点都将以其唯一的 id 作为种子，并使用 的输出`rand`来提供模拟延迟中的抖动。我希望每个节点都能够计算任何其他节点的下一个延迟以测量碰撞。我可以访问任何节点的初始种子并且`rand`已调用次数。

我想避免不得不播种和循环`n + 1`时间来获得下一个值。使用通用的 linux 实现，我想要什么`rand`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:14:11.760

glibc 中的随机数生成器是一个线性同余生成器，一个形式为 x_{n+1} = a * x_{n} + b mod m 的生成器。对于 a、b 和 m 的正确选择，它可能就足够了。结合两个或更多提高质量。

以这样的顺序向前跳过是相当容易的。x_{n+k} = a^{k} * x_{n} + b * (a^{k} - 1)/(a - 1) mod m。将一个数提高到一个 mod m 的幂与该数中的位数成线性关系，即 O(log(number))。要进行乘法逆运算，您只需使用扩展的欧几里得算法。您只需执行后者一次。

# java - 合并 XML Web 内容文件

> ID：13463412
> 
> 赞同：0
> 
> 时间：2012-11-19T22:25:31.847
> 
> 标签：java, xml, eclipse, merge, sax

我处于一个独特的位置，正在将一堆 xml 内容文件合并到客户端特定的 svn 分支中，问题是我不能只是复制/粘贴，因为该客户端定义了不同的翻译和其他标签。试图通过 svn merge 做到这一点是令人生畏的，它有 50 个文件和许多客户参与其中。所以我的问题是如何编写一个 Eclipse 插件，甚至是一个将两个 xml 文件作为源、目标的 java 程序。源添加中不在目标中的所有元素以及目标中具有不同标签的现有元素都不会更改。我能写得这么快吗？我想使用什么解析器，有人会使用什么工具来快速实现这一点。我可以快速编写插件来进行比较的实际代码，我需要一些输入。- 邓肯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:28:59.507

XSLT 是一个非常有用的工具。它专门用于将一个 XML 文档或任何子变体（如 HTML）转换为另一个文档。这似乎是你正在做的具体事情。

使用 XSLT，您可以定义如何将 XML 转换为 XSL 文件的规则；此 XSL 文件包含用于指定要更改的 XML 部分以及如何更改它们的简单逻辑。接下来，输入 XSL 规则和 XML 源文档，它会输出新的 XML 结果。

使用 XSLT 的好处是您可以调整它并再次运行它。您可以在批量源 XML 文件上运行它。请注意，您可以在许多情况下使用它也很好。您可以将其作为命令行工具执行，您可以将指向 XML 源和 XSL 规则的参数传递给该工具，也可以在 Java 代码中使用它。它非常灵活。

在您的用例中，我以前没有使用 XSLT 做过的唯一事情是一次检查两个源文件。但是[这个问题](https://stackoverflow.com/questions/2192627/merging-two-xml-source-documents-with-xslt)只是讨论这样的事情。

# sharepoint - Sharepoint 文件夹不能被创建者删除

> ID：13463414
> 
> 赞同：-1
> 
> 时间：2012-11-19T22:25:33.760
> 
> 标签：sharepoint

我在库中创建了一个文件夹。然后我使用复选框选择了文件夹并单击“文档权限”。在权限页面中，我选择了所有用户和组并意外删除了它们:(。立即这样做，文件夹消失了（可能是因为我不再具有读取权限。我尝试创建一个具有相同名称的新文件夹但得到了一个错误说文件夹已经存在。

基本上我猜这个文件夹现在没有任何权限。我现在正试图删除该文件夹，但徒劳无功。我收到拒绝访问错误。那么文件夹的所有者是谁呢？你能帮忙吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:34:22.507

您可以尝试编写一些删除文件夹的代码。

将删除文件夹命令放在“以提升的权限运行”块中。

然后，您将使用系统权限而不是特定用户的权限删除该文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T11:14:34.357

要删除该特定文件夹，您必须具有 FullControl 或 Contribute 权限，但正如您所说，您甚至没有看到该文件夹​​，这意味着您也没有读取权限。因此，要删除该文件夹，请使用任何其他具有该文件夹的凭据的帐户，该帐户有权读取和贡献该文件夹。或者正如 Lostpacket 告诉你的那样，编写一些自定义代码来删除该文件夹并使用 Run With Elivited 权限

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T02:13:05.240

显然，网站集所有者必须删除该文件夹。

# iphone - 生成唯一编号

> ID：13463416
> 
> 赞同：0
> 
> 时间：2012-11-19T22:25:36.347
> 
> 标签：iphone, objective-c, ios, arrays

我正在尝试为宾果应用程序生成一个唯一编号，现在它在 1-90 之间选择 90 个随机数并将它们添加到 NSMutableSet。这一切都有效，但我从集合中挑选的号码是唯一的，所以同一个号码被拉出两次。

这是我到目前为止所拥有的：

```
NSMutableSet * numberSet1 = [NSMutableSet setWithCapacity:90];
while ([numberSet1 count] < 90 ) {
    NSNumber * randomNumber1 = [NSNumber numberWithInt:(arc4random() % 90 + 1)];
    [numberSet1 addObject:randomNumber1];
}
//NSLog(@"numberWithSet : %@ \n\n",numberSet1);

NSArray * numbers = [numberSet1 allObjects];
//to display
int r = arc4random() % [numbers count];
if(r<[numbers count]){
    numberLabel.text = [NSString stringWithFormat:@"%@", [numbers objectAtIndex:r]];
} 
```

我怎样才能阻止它给我重复？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:36:18.040

作为选择随机数的替代方法`arc4random()`（其中[带有替换的样本](http://www.ma.utexas.edu/users/parker/sampling/repl.htm)，您可能不希望在宾果游戏中使用）：

1.  取一个从 1 到 90 的数组。
2.  [随机播放](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)该数组。
3.  从数组中选择第一个数字，然后选择第二个，依此类推。

保留数组中当前选定元素的索引。要获得下一个数字，请递增并检查您是否取消引用第 90 个元素。

一些伪代码：

```
#define SIZE 90

unsigned int index;
unsigned int elements[SIZE];

/* step 1 -- populate the array with elements 1 through 90 */
for (index = 0; index < SIZE; index++)
    elements[index] = index + 1;

/* step 2 -- shuffle the array */
fisher_yates_shuffle(elements);

/* step 3 -- read from the array */
for (index = 0; index < SIZE; index++)
    fprintf(stdout, "element at index %u is %u\n", index, elements[index]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:09:15.697

这将创建并打乱一个数组。

```
// array to shuffle
NSMutableArray *array = [NSMutableArray array];
for(int i=1; i<91; i++){
    [array addObject:[NSNumber numberWithInt:i]];
}

// shuffle
for (int i = [array count]-1; i>0; i--) {
    [array exchangeObjectAtIndex:i withObjectAtIndex:arc4random()%(i+1)];
} 
```

不确定这是否是您想要的，因为从 1-90 中随机选择 90 个没有重复的数字并将它们添加到可变集合中与将所有内容添加到可变集合中没有什么不同。但是，如果您想要 90 个数字的子集，只需从数组中获取 n 个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:15:35.070

从我不久前写的一个彩票应用程序中，也适用于这里-

```
int ball[6], counter, check, similarity;
for ( counter = 1; counter <= 6; counter++ )
{
    for (;;)
    {
        similarity = 0;
        ball[counter] = 1 + arc4random() % 6;
        for (check = counter-1; check >= 1;check--)
        {
            if ( ball[check] == ball[counter] )
            {
                similarity = 1;
                break;
            }
        }
    if(similarity == 0)
        break;
    }
printf("%i\n", ball[counter]);
} 
```

将选中的球与之前所有的球进行核对，永远不会两次得到相同的号码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T00:30:52.370

在 NSMutableArray 上创建一个类别

```
@implementation NSMutableArray (RandomUtils)
-(void)shuffle
{
    NSUInteger count = [self count];
    for (NSUInteger i = 0; i < count; ++i) {
        NSUInteger nElements = count - i;
        NSUInteger n = (arc4random() % nElements) + i;
        [self exchangeObjectAtIndex:i withObjectAtIndex:n];
    }
}

@end 
```

您也可以将其包装为 NSArray 版本

```
@implementation NSArray (RandomUtils)

-(NSMutableArray *)mutableArrayShuffled
{
    NSMutableArray *array = [[self mutableCopy] autorelease];
    [array shuffle];
    return array;
}

-(NSArray *)arrayShuffled
{
    return [NSArray arrayWithArray:[self mutableArrayShuffled]];
}

@end 
```

在需要的地方，导入类别，然后执行：

```
NSMutableArray *array = [NSMutableArray array];
for(int i=0; i<90; i++){
    [array addObject:[NSNumber numberWithInt:i+1]];
}
[array shuffle];
NSArray *newarray = [array subarrayWithRange:NSMakeRange(0,6)]; 
```

* * *

另一种方法可能是用 6 个随机选择填充一组。

在类别中：

```
@implementation NSArray (RandomUtils)
-(id)randomElement
{
    if ([self count] < 1) return nil;
    NSUInteger randomIndex = arc4random() % [self count];
    return [self objectAtIndex:randomIndex];
}
@end 
```

像这样使用它：

```
NSMutableSet *mset = [NSMutableSet set];

while ([mset count]<6) {
    [mset addObject:[array randomElement]];
} 
```

# python - Python中的“Eratosthenes的真正筛子” - 为什么heapq比dict慢？

> ID：13463417
> 
> 赞同：9
> 
> 时间：2012-11-19T22:25:40.187
> 
> 标签：python, performance, heap, sieve-of-eratosthenes

按照[M. O'Neill 的精彩论文](http://www.cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf)，我尝试在 Python 中实现一些惰性的、无限版本的 Eratosthenes 筛。我惊讶地发现，论文声称应该运行得更快的基于堆的版本实际上对我来说慢了两倍多。

该论文包含两个示例，一个基于 dict，我已将其翻译（来自 Haskell），因此：

```
from itertools import count
def dict_sieve():
    yield 2
    yield 3
    candidates = count(5, 2)
    composites = {9:{3}}  # map composites to their prime factors

    for candidate in candidates:
        try:
            factors = composites.pop(candidate)
        except KeyError:  # if it's not in the dict, it's prime
            yield candidate
            composites[candidate**2] = {candidate}  # Euler's optimization: start from prime**2
        else:
            for prime in factors:  # go through the prime factors and increment their keys
                try:
                    composites[candidate+prime*2].add(prime)  # use prime*2 because we are ignoring evens
                except KeyError:
                    composites[candidate+prime*2] = {prime} 
```

论文中的第二个示例演示了优先级队列作为数据结构的使用。它还使用惰性列表，而不是简单的增量，为了公平测试，我没有这样做。（此外，我在惰性列表中使用了实例，`itertools.count`但我发现它的运行速度稍慢）。

```
from itertools import count
from heapq import heappush, heapreplace
def heap_sieve():
    yield 2
    yield 3
    candidates = count(5,2)
    composites = [(9, 3)]  # a priority queue of composite/factor pairs, keyed by composite

    for candidate in candidates:
        prime_flag = True
        while composites[0][0] == candidate:  # loop because there may be duplicates
            prime_flag = False  # signal to the if statement below
            composite, prime = composites[0]
            heapreplace(composites, (composite + prime*2, prime))

        if prime_flag:
            yield candidate
            heappush(composites, (candidate**2, candidate)) 
```

我对这两个进行了计时，以及一个“渴望”的版本，这里没有复制，它产生了一个低于限制的所有素数的列表：

```
In [44]: from itertools import islice

In [45]: %timeit list(islice(dict_sieve(), 100000))
    ...: %timeit list(islice(heap_sieve(), 100000))
    ...: %timeit eager_sieve(1299710)  # 1299709 is the 100,000th prime
    ...: 
1 loops, best of 3: 2.12 s per loop
1 loops, best of 3: 4.94 s per loop
1 loops, best of 3: 677 ms per loop 
```

'eager' 版本更快并不奇怪——它基本上是在内存使用、必须指定上限的不便和 CPU 时间之间进行权衡。然而，当论文声称它更高效时，我*确实*发现版本慢得多，这让我感到惊讶。`heapq`我的实施有问题吗？或者仅仅是因为我们都知道，dicts 是超快的（而且`heapq`相对较慢）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T22:51:17.330

实际上，应该期望基于字典的方法比基于堆队列的方法更快。堆插入和替换操作是 O(log n)，而字典插入和替换操作是 O(1)。

事实上，我很惊讶地听到这篇论文的作者声称并非如此。但事实上并非如此。您假设 a`Data.Map`被实现为*hash map*，但实际上，它是一个[大小平衡的二叉树](http://www.haskell.org/ghc/docs/6.12.2/html/libraries/containers-0.3.0.0/Data-Map.html)。所以它的性能特征与堆队列的性能特征非常相似。不同之处在于从堆队列中检索最小键是 O(1)，这加快了部分筛选代码的速度——但哈希映射更快。

# r - 在 R 中聚合来自多个输入文件的输出

> ID：13463418
> 
> 赞同：0
> 
> 时间：2012-11-19T22:25:59.060
> 
> 标签：r, count, aggregate

现在我有下面的 R 代码。它读取如下所示的数据：

```
track_id    day hour    month   year    rate    gate_id pres_inter  vmax_inter
9   10  0   7   1   9.6451E-06  2   97809   23.545
9   10  0   7   1   9.6451E-06  17  100170  13.843
10  3   6   7   1   9.6451E-06  2   96662   31.568
13  22  12  8   1   9.6451E-06  1   94449   48.466
13  22  12  8   1   9.6451E-06  17  96749   30.55
16  13  0   8   1   9.6451E-06  4   98702   19.205
16  13  0   8   1   9.6451E-06  16  98585   18.143
19  27  6   9   1   9.6451E-06  9   98838   20.053
19  27  6   9   1   9.6451E-06  17  99221   17.677
30  13  12  6   2   9.6451E-06  2   97876   27.687
30  13  12  6   2   9.6451E-06  16  99842   18.163
32  20  18  6   2   9.6451E-06  1   99307   17.527

##################################################################
# Input / Output variables
##################################################################
for (N in (59:96)){
  if (N < 10){
#     TrackID <- "000$N"
     TrackID <- paste("000",N, sep="")
  }
  else{
#     TrackID <- "00$N"
     TrackID <- paste("00",N, sep="")
  }
  print(TrackID)

# For 2010_08_24 trackset
#  fname_in <- paste('input/2010_08_24/intersections_track_calibrated_jma_from1951_',TrackID,'.csv', sep="")
#  fname_out <- paste('output/2010_08_24/tracks_crossing_regional_polygon_',TrackID,'.csv', sep="")
# For 2012_05_01 trackset
  fname_in <- paste('input/2012_05_01/intersections_track_param_',TrackID,'.csv', sep="")
  fname_out <- paste('output/2012_05_01/tracks_crossing_regional_polygon_',TrackID,'.csv', sep="")
  fname_out2 <- paste('output/2012_05_01/GateID_',TrackID,'.csv', sep="")

#######################################################################
# we read the gate crossing track date
  cat('reading the crosstat output file', fname_in, '\n')
  header <- read.table(fname_in, nrows=1)
  track <- read.table(fname_in, sep=',', skip=1)
  colnames(track) <- c("ID", "day", "month", "year", "hour", "rate", "gate_id", "pres_inter", "vmax_inter")

#  track_id=track[,1]
#  pres_inter=track[,15]

# Function to select maximum surge by stormID 
  ByTrack <- ddply(track, "ID", function(x) x[which.max(x$vmax_inter),])
  ByGate <- count(track, vars="gate_id")

# Write the output file with a single record per storm                     
  cat('Writing the full output file', fname_out, '\n')
  write.table(ByTrack, fname_out, col.names=T, row.names=F, sep = ',')

# Write the output file with a single record per storm                     
   cat('Writing the full output file', fname_out2, '\n')
   write.table(ByGate, fname_out2, col.names=T, row.names=F, sep = ',')
} 
```

我对最后一段代码的输出是一个按 GateID 分组的文件，并输出出现频率。它看起来像这样：

```
gate_id freq
1   935
2   2096
3   1363
4   963
5   167
6   17
7   43
8   62
9   208
10  267
11  64
12  162
13  178
14  632
15  807
16  2003
17  838
18  293 
```

问题是我为 96 个不同的输入文件输出了一个看起来像这样的文件。我不想输出 96 个单独的文件，而是想计算每个输入文件的这些聚合，然后将所有 96 个输入的频率相加并打印出一个 SINGLE 输出文件。任何人都可以帮忙吗？

谢谢，克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:56:32.587

您将需要执行以下功能。这将抓取一个目录中的所有 .csv 文件，因此该目录必须只包含您要分析的文件。

```
myFun <- function(out.file = "mydata") {
files <- list.files(pattern = "\\.(csv|CSV)$")
# Use this next line if you are going use the file name as a variable/output etc
files.noext <- substr(basename(files), 1, nchar(basename(files)) - 4)

for (i in 1:length(files)) {
    temp <- read.csv(files[i], header = FALSE)
    # YOUR CODE HERE
    # Use the code you have already written but operate on files[i] or temp
    # Save the important stuff into one data frame that grows
    # Think carefully ahead of time what structure makes the  most sense
    }

datafile <- paste(out.file, ".csv", sep = "")
write.csv(yourDataFrame, file = datafile)
} 
```

# python - Python中常用的构造函数

> ID：13463419
> 
> 赞同：4
> 
> 时间：2012-11-19T22:26:00.293
> 
> 标签：python, constructor

> **可能重复：**
> [将函数参数分配给`self`](https://stackoverflow.com/questions/8682848/assign-function-arguments-to-self)

通常我有如下所示的构造函数：

```
class Foo(object):
  def __init__(self,a,b,c):
    self.a = a
    self.b = b
    self.c = c 
```

我想知道是否有一种方便的方法来编码这样的构造函数。也许看起来像：

```
class Foo(object):
  SOME_MACRO_LIKE_THINGY_THAT_SPECIFIES_THE_CONSTRUCTOR(a,b,c) 
```

这将与上面的原始代码完全一样。

原始版本让我感到困扰的是，我必须将 Foo 的每个实例变量写三次（一次作为参数，一次作为 self.a，再次作为分配给 self.a 的值）。

我想这没什么大不了的，但我觉得代码看起来更整洁，重复更少。

处理这种情况的 Pythonic 方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:28:59.583

您可以将`Foo`所有其他人作为主类的子类，即

```
class MasterObject(object):
  def __init__(self,a,b,c):
    self.a = a
    self.b = b
    self.c = c

class Foo(MasterObject):
  def __init__(self,a,b,c):
    MasterObject.__init__(a,b,c) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T22:35:02.243

这很奇怪，但你可以`__slots__`用来实现这一点：

```
class Base(object):
    def __init__(self, *args, **kw):
        for k,v in zip(self.__slots__, args):
            setattr(self, k, v)

        for k,v in kw.items():
            setattr(self, k, v)

class ChildA(Base):
    __slots__ = 'a', 'b', 'c'

class ChildB(Base):
    __slots__ = 'x', 'y', 'z' 
```

在初始化具有大量参数的类时，您还可以使用以下技术来节省一些输入：

```
def autoargs(l):
    self = l.pop('self')
    for k,v in l.items():
        setattr(self, k, v)

class Base(object):
    def __init__(self, a, b, c):
        autoargs(locals()) 
```

我希望我能正确理解你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:34:56.670

你可以做这样的事情

```
class Foo(object):
    def __init__(self, **kw):
        self.__dict__.update(kw)
        del self.__dict__["self"] 
```

但是每次实例化类时都必须命名所有实例变量。我认为这使代码更加脆弱。由于大多数人不喜欢脆弱的代码，他们坚持使用显式版本。

我想你可以为你的编辑器编写一个宏来扩展它们，但我认为不会有很大一部分时间花在那个细节上，而且并不是所有的类都希望将所有参数保存到实例中。

# javascript - jQuery replaceWith 后查找 div 高度

> ID：13463422
> 
> 赞同：1
> 
> 时间：2012-11-19T22:26:23.490
> 
> 标签：javascript, jquery

`left_s`我需要用 id= 的div 查找并替换 id的 div `newdiv`。另外，我需要获取前一个 div的`height`and并将其应用到 id= 的新 div 中。`width``left_s``newdiv`

我有这个代码，但它不工作：

```
$('#left_s').replaceWith('<div id="newdiv" </div>');
var w = $("#newdiv").width();
$(".left_s").width(w); 
```

///////在“.replaceWith”之后，我无法从div“left_s”获取高度和宽度并将其应用于“newdiv”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:50:47.440

尝试：

```
$("body").append('<div id="newdiv"></div>');
$(".left_s").width($("#newdiv").width()); 
```

您可以修复代码以使其符合您的目的，但关键是将元素附加到 DOM 中。否则，它没有计算出的宽度/高度。

# xcode - UIAlertView exec_bad_access 表单块对象

> ID：13463424
> 
> 赞同：1
> 
> 时间：2012-11-19T22:26:26.830
> 
> 标签：xcode, uialertview, objective-c-blocks

当我尝试在块对象中显示 UIAlertView 时，我得到了 EXEC_BAD_ACCESS。如果我从“viewDidAppear”方法调用“onEventAdded”方法，则警报按预期工作。

提前致谢。

```
- (void) addEvent:(NSDictionary *) event_data
{
   NSLog(@"event_data: %@ ",event_data);    
   // create event
   EKEventStore *store = [[EKEventStore alloc] init];

   [store requestAccessToEntityType:EKEntityTypeEvent completion:^(BOOL granted, NSError *error) {

        // event code ...

        NSError *err;
        [store saveEvent:event span:EKSpanThisEvent error:&err];
        if(err == NULL)
        {
            [self onEventAdded];
        }
    }];
}

-(void) onEventAdded{
   uiAlert = [[UIAlertView alloc]initWithTitle: nil
                                               message: @"Event added to calendar."
                                              delegate: nil
                                     cancelButtonTitle:nil
                                     otherButtonTitles:@"OK",nil];
   [uiAlert show];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:36:00.567

完成块可能不在主线程上执行。你只能在主线程上做 UI 的东西（例如显示警报）。

# iphone - 故事板中的 xib 覆盖导致未捕获的异常

> ID：13463426
> 
> 赞同：0
> 
> 时间：2012-11-19T22:26:38.360
> 
> 标签：iphone, objective-c, ios, xcode, interface-builder

我的主要应用程序是使用 Storyboard 来展示我的所有观点。下一步...我还有一个 xib 文件，其中包含一些按钮，我想将它们应用到一种花哨的覆盖中。使用我在这里找到的一种技术，这也很有效：http: [//www.stackoverflow.com/a/12574190/949538](http://www.stackoverflow.com/a/12574190/949538)

文件所有者连接到主视图控制器。从我的主视图上的一个按钮，我可以很好地弹出这个 xib。

问题来自试图将 IBAction 附加到我放在这个 xib 上的任何东西上。我所有人都没有警告，没有构建错误，一切看起来都很好。直到我打开 xib/view，然后点击我的一个按钮，然后我得到这个：

```
2012-11-19 15:44:48.685 Frolfer[89367:c07] -[UIViewController closeStartPanel:]: unrecognized selector sent to instance 0x8352e90
2012-11-19 15:44:48.686 Frolfer[89367:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIViewController closeStartPanel:]: unrecognized selector sent to instance 0x8352e90' 
```

**主视图控制器.m**

```
-(IBAction)closeStartPanel:(id)sender {
    NSLog(@"close start panel");
} 
```

![在此处输入图像描述](../Images/15902818e2b49b5b221ae797e975a7b1.png)

它必须是非常基本的东西，以至于我忘记/错过了。

有什么想法吗？

PS 从字面上看，还没有编写太多代码，但是如果您想查看更多内容，请告诉我。我不确定你想看什么……

提前致谢！！- 画了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T03:07:27.953

是否`closeStartPanel:`为此定义了选择器`UIButton`？你可以发布代码吗？异常清楚地表明它无法在...中找到`closeStartPanel`选择器`UIButton``UIViewController`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:48:32.237

我想到了！

不知道为什么我以前没有尝试过，但现在效果很好。

通常，当我在 Storyboard 中时，我会将“Touch Up Inside”手柄拖到按钮顶部，以查看我在标题中创建的可用 IBAction。使用 xib 文件，这根本没有发生。如前所述，我将 xib 上的 Files Owner 类更改为 MainViewController。

在那之后，当将“Touch Up Inside”拖到 IB 屏幕上的按钮上时，我所有定义的 IBAction 都会按照我的预期出现。

![在此处输入图像描述](../Images/e285c09d3dbd617d5faecf2bed39eecb.png)

这就是崩溃开始发生的地方。

今天早上，我在我的 xib 文件中删除了与 MainViewController 的所有关联，并且意外地将“Touch Up Inside”句柄交给了 First Responder。我想我很少和 First Responder 一起玩……但令我惊讶的是，我所有的 IBAction 都列在那里。出于某种原因，我以为我不会看到他们。

![在此处输入图像描述](../Images/c5bb72aae647c429d8aa0d4d0b7c1500.png)

经过清理和编译......繁荣，他们工作！我想唯一的缺点（如果你想这样称呼它）是在代码视图中，它没有表明你定义的 IBAction 已连接到 IB 中的一个按钮，其中填充的灰色点就像我的直接在情节提要上的其他按钮可以。

哦，好吧，似乎正在按照我希望的方式工作（目前），所以我将继续使用它。

:-) 感恩节周末愉快。- 德鲁

![在此处输入图像描述](../Images/bf395c52cad6c46d3d858c96e9d7cc98.png) ![在此处输入图像描述](../Images/a08839aacbcaa04926fab1cf91a34782.png)

# c# - 图像格式转换异常缓慢

> ID：13463430
> 
> 赞同：0
> 
> 时间：2012-11-19T22:26:42.130
> 
> 标签：c#, .net, algorithm, image-processing

我从外部系统接收图像，格式为一系列 BGR 值，后跟一个空字节。序列看起来有点像......

[B,G,R,0,B,G,R,0,...,B,G,R,0] 其中每个 BGR0 是图像中的单个像素。

我需要在 .NET 位图中使用它，这样我就可以对其进行一些操作，并提出了以下功能：

```
 private Bitmap fillBitmap(byte[] data, int width, int height)
    {
        Bitmap map = new Bitmap(width, height);
        for (int i = 0; i < data.Length; i += 4)
        {
            int y = ((i / 4) / width);
            int x = ((i / 4) - (y * width));
            int b = data[i];
            int g = data[i + 1];
            int r = data[i + 2];
            Color pixel = Color.FromArgb(r, g, b);
            map.SetPixel(x, y, pixel);
        }
        return map;
    } 
```

这通常没问题，除了我的大多数图像都是 1920x1200 ......所以我有一个迭代超过 200 万次的循环。即便如此，这也不会那么糟糕，因为 200 万次迭代对任何现代处理器都不会造成太大负担。

但由于某种原因，这个循环可能需要 5-15 秒以上才能在我的服务器上相当强大的 Xeon 上运行。并行化循环将是微不足道的，但我怀疑有更好的方法来解决这个问题。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:36:07.883

[Bitmap.LockBits 方法](http://msdn.microsoft.com/en-us/library/5ey6h79d.aspx)的描述说，

> 您可以使用 SetPixel 方法更改图像的颜色，尽管 LockBits 方法为大规模更改提供了更好的性能。

我猜，另一种方法可能是在创建与位图文件格式匹配的 Stream 之后使用[Bitmap(Stream) Constructor 。](http://msdn.microsoft.com/en-us/library/z7ha67kw.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:31:36.183

检查一些[FastBitmap](https://www.google.com/search?q=FastBitmap%20C#&aq=f&oq=FastBitmap%20C#&aqs=chrome.0.57j0j62l3.3684&sugexp=chrome,mod=1&sourceid=chrome&ie=UTF-8)实现，这将帮助您设置能够从中生成图像的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:42:46.680

对 GetPixel 和 SetPixel 的调用对本机函数进行互操作调用。每次调用其中一个函数时，位图图像被锁定，相应的像素/字节被修改，然后图像最终被解锁。您可以想象重复执行此操作非常低效。

正如其他人建议的那样，使用 LockBits 方法，尽管我想你将不得不使用不安全的代码。现在，如果允许，请使用它。它允许直接访问非托管内存缓冲区中的位图像素。

# c++ - OSX“ld”：如何显示未解析符号的错位名称？如何获取地图文件？

> ID：13463431
> 
> 赞同：1
> 
> 时间：2012-11-19T22:26:42.050
> 
> 标签：c++, c++11, clang, ld, libc++

~~在 OS X 10.8.2（Mountain Lion）上，我正在尝试使用 libc++（不是 libstdc++）链接一个程序，并`ld`给我一个未解决的符号错误。~~

```
Undefined symbols for architecture x86_64:
  "std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::operator=(char const*)", referenced from:
      bool process_load_commands<mytype_t>(unsigned char*, ...) in module_mach_o.cpp.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

~~这似乎是指以下行的代码生成：~~

```
mystdstring = ::std::string(mycharpointer + myint); 
```

~~如果我将其更改为~~

```
mystdstring = mycharpointer + myint; 
```

~~然后一切正常，因为我们停止使用移动构造函数并开始使用非移动赋值运算符。~~

我正试图追查这一点，但由于缺乏我的传统工具而受到阻碍。两个问题立刻浮现在脑海：

*   如何`ld`生成地图文件？这个链接器不起作用`-map` `-Map` `-Wl,-map=foo` `-Wl,-Map=foo`。

    ```
    @(#)PROGRAM:ld  PROJECT:ld64-134.9
    configured to support archs: armv6 armv7 armv7s i386 x86_64
    LTO support using: LLVM version 3.1svn, from Apple Clang 4.1 (build 421.11.65) 
    ```

*   如何`ld`向我显示未解析的 C++ 符号的未分解名称，以便我可以轻松地 grep 映射/nm 文件？

~~当然，如果有人以前见过这个特定的错误并且知道如何修复它，我也会接受这些答案。:)~~

编辑：我意识到我上面写的关于移动构造函数的内容没有意义，因为在我写这个问题的过程中症状发生了变化。:P 每当我对发生的事情有了更好的了解时，我都会修复它。

编辑＃2：错误消失了。我暂时责怪我们自建的 libc++：我最好的猜测是它没有*任何*符号（由于构建错误的拱门），我们真的很幸运，我们从未尝试使用任何非内联函数，除了这个。

不过，我关于`-map`和显示错误名称的问题仍然悬而未决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-22T08:59:18.100

要让 clang 显示未解析符号列表的错位符号名称，请使用链接器/编译器标志：

```
-Xlinker --no-demangle 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:59:33.690

在 libc++`<string>`标头中，`basic_string::operator=(const char*)`声明/定义为：

```
_LIBCPP_INLINE_VISIBILITY basic_string& operator=(const_pointer __s) {return assign(__s);} 
```

_LIBCPP_INLINE_VISIBILITY 是一个扩展为“始终内联”和“标记隐藏”的宏。因此，这个成员函数应该总是被内联的，并且链接器永远不应该寻找它。

您是否偶然更改了 _LIBCPP_INLINE_VISIBILITY 宏的定义？

# css - 移动网站不呈现

> ID：13463434
> 
> 赞同：1
> 
> 时间：2012-11-19T22:26:55.797
> 
> 标签：css, mobile, resize, smartphone

我为我的网站构建了一个新模板，该模板重新排列了内容，以便在检测到小屏幕尺寸 (<801px) 时将侧边栏移动到底部。为了使这尽可能简单，我将其简化为 html 和 CSS。问题是手机声称拥有比实际更大的屏幕尺寸，但他们还是选择了全尺寸显示屏。此外，如果我将媒体类型指定为“移动”，手机似乎会故意忽略它。有没有更好的方法来定位手机（即安卓和iPhone）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:28:06.590

您可能需要以下`meta`标签`head`：

```
<meta name="viewport" content="width=device-width"> 
```

# java - 发黑杰克印刷卡

> ID：13463439
> 
> 赞同：1
> 
> 时间：2012-11-19T22:27:27.557
> 
> 标签：java, arrays

我在二十一点游戏中需要帮助。我有一个数组中的卡片组，每次我拿出一张卡片并处理它时，数组都会重新分配为比大小小一个。所以我有这个循环，向每个第 n 个玩家发两张牌

```
 deck=createCardArray();
        shuffle(deck); 
        int[] players = createPlayers(n);
        int[] points = createPoints(n);

        for(int i = 1 ; i<= players.length; i++){
            Card a = dealCard(deck);
            updatePoints(players, points, i, a);
            Card b = dealCard(deck);
            updatePoints(players, points, i, b);
            printStats(players, points, a, b);
        } 
```

我想要做的是在向每个玩家发两张牌后打印出牌和最终点数。所以我有这个方法 printstats 看起来像这样：

```
public static void printStats(int[] nplayers, int[] points, Card a, Card b){
    for (int i=0; i<nplayers.length;i++){
        System.out.println("Player " + nplayers[i] + ": Points " + points[i]);
        System.out.println("Card 1: " + a.showCardSuit() + " " + a.showCardValue());
        System.out.println("Card 2: " + b.showCardSuit() + " " + b.showCardValue());
        System.out.println();
    }
} 
```

它的作用是它每次迭代并每次输出卡点和玩家。但是当我运行它时，它只给出最后一个玩家的两张牌。我明白为什么会这样。但我想要一个关于如何解决这个问题的建议。

我应该创建一个新的 2d 数组长度播放器和大小 2Xn 还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:00:51.740

您可以通过创建一个包含您正在调用的方法的 Player 类来改进设计。一个简单的实现看起来像这样。

```
 public class Player{
        Card a;
        Card b;

        public Card getA() {
            return a;
        }
        public void setA(Card a) {
            this.a = a;
        }
        public Card getB() {
            return b;
        }
        public void setB(Card b) {
            this.b = b;
        }

        public int points(){
            //calculation for returning point value
            int points = 0;
            return points;
        }

    } 
```

现在，您只需一个包含每个玩家的数组，而不是 2 个数组。当你遍历这个数组时，你可以使用`setA()`and`setB()`方法给玩家他们的牌。一旦每个玩家都有卡片，您就可以再次遍历数组并使用`getA()`和`getB()`打印卡片。Using`points()`为您提供了一种简单的方法来计算每个玩家手牌的分数，而无需拖拽额外的数组。

如果您使用 List 或 ArrayList 而不是使用显式的 A、B 属性来保存卡片，则可以使此功能更加有用。这将使您可以将相同的系统用于可能不仅使用 2 张牌的其他纸牌游戏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:48:57.930

玩家“有”手...所以给玩家他的牌！换句话说，创建一个代表玩家当前卡片的字段。然后，当你发牌时，做`player.hit(Card newCard)`，然后展示他的手，就做`List<Card> player.getHand()`

# cuda - 为什么只有一个经线由 cuda 中的 SM 执行？

> ID：13463440
> 
> 赞同：2
> 
> 时间：2012-11-19T22:27:27.093
> 
> 标签：cuda

我经常在一些 CUDA 材料中发现以下词语：

“在任何时候，只有一个经线被 SM 执行”。

这里我不太明白，既然每个SM可以同时运行成百上千个线程，为什么一个时间点只能执行一个warp，也就是32个线程？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:36:19.067

不同代的 CUDA 硬件的详细信息有所不同，但例如在前几代中，每个 SM 有 8 个执行单元，每个执行单元执行 4 个线程（每 4 个周期来自每个线程的一条指令）。因此，您获得 4 路 SMT，每个 SM 提供 32 个并发线程。

当然，每个 GPU 有多个 SM，例如 30 个，这意味着 30 x 32 线程扭曲 = 960 个线程在任何给定时刻执行。除此之外，warp 可以切换进出，因此您可以拥有比例如 960 个“活动”线程更多的线程，即使在任何给定时间实际上只有 960 个线程在执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T02:49:57.930

这句话对于特斯拉架构是正确的，但对于费米和开普勒来说是不正确的。从 warp 调度器的角度来看 SM 更容易。在每个周期，warp 调度程序选择一个符合条件的 warp（一个未停止的 warp）并将一个或两个指令从该 warp 分派到执行单元。每个 SM 的执行单元数量记录在 Fermi 和 Kepler 白皮书中。CUDA 内核大致相当于可以执行整数和单精度浮点运算的执行单元的数量。还有用于加载/存储操作、分支等的附加执行单元。

**计算能力 1.x** (特斯拉)

*   每个 SM 1 个 warp 调度程序
*   每个 warp 调度器调度 1 条指令

**计算能力 2.0**（费米第一代）

*   每个 SM 2 个 warp 调度程序
*   每个 warp 调度器调度 1 条指令

**计算能力 2.1**（Fermi 第二代）

*   每个 SM 2 个 warp 调度程序
*   每个 warp 调度器调度 1 或 2 条指令

**计算能力 3.x**（开普勒）

*   每个 SM 4 个 warp 调度程序
*   每个 warp 调度器调度 1 或 2 条指令

# drupal - 视图，Pathauto，视图参数

> ID：13463443
> 
> 赞同：0
> 
> 时间：2012-11-19T22:27:45.003
> 
> 标签：drupal, views

我在尝试配置以下 senario 时遇到了极大的困难：

我网站上的每个用户都有一个使用路径 auto 别名的内容配置文件。例如 Jeff 的个人资料是 mysite.com/profile/jeff

我想配置一个 views 参数来输出这个用户创建的内容，这样当用户导航到 mysite.com/profile/jeff/term1 时，只显示由 Jeff 创建并带有 term1 标记的内容。

使用视图预览时一切正常。问题是当我导航到 mysite.com/profile/jeff/term1 时，drupal 会将我带到 mysite.com/jeffsprofile 而不是页面视图。

在视图中，如果我将路径更改为 profile/%，则路径设置为 profile/% - 一切正常。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T14:48:57.537

Drupal 已经在使用路径 mysite.com/profile/jeff

在您的视图中尝试不同的东西，lige mysite.com/member/jeff

希望能帮助到你

公关

# jquery - 如何解析这个json数组？

> ID：13463446
> 
> 赞同：0
> 
> 时间：2012-11-19T22:27:52.437
> 
> 标签：jquery, json, parsing

我有一个输出 json 数组的 php 文件：

```
[{"id":407,"parentId":406,"level":null,"name":"Зал VIII"},{"id":408,"parentId":406,"level":null,"name":"Зал IV"},] 
```

试试这个功能：

```
var levels = '';
function parse() {
    $.get('url_to_json_file', function(data){
        $.each(data, function(key, value){
            levels += (value.id +' - '+ value.name);
        });
    });
return levels;
} 
```

但结果总是`undefined - undefined`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:09:48.550

jQuery 有一个`$.parseJSON()`功能。

尝试：

```
$.parseJSON('[{"id":407,"parentId":406,"level":null,"name":"Зал VIII"},{"id":408,"parentId":406,"level":null,"name":"Зал IV"}]');
//Returns [Object,Object]; 
```

# c++ - Direct3D 中的 Windows Phone 8 触摸位置

> ID：13463448
> 
> 赞同：4
> 
> 时间：2012-11-19T22:28:04.523
> 
> 标签：c++, touch, directx, direct3d, windows-phone-8

我似乎找不到任何有关如何在 Windows Phone 8 中的纯原生 C++ Direct3D 应用程序中处理触摸的文档。有人设法将触摸输入输入到他们的游戏中吗？我在网上阅读的所有内容都与 XAML/Silverlight 或桌面 Metro 应用程序有关。Microsoft 的很多人都告诉我支持此功能，所以我知道它可以完成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T00:30:12.590

我认为在某种程度上，您在 Windows Phone 8（或 Windows 8）上的 C++ Direct3D 应用程序将使用 CoreWindow。

CoreWindow 有指针事件：

[http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.core.corewindow.pointerpressed.aspx?cs-save-lang=1&cs-lang=cpp#code-snippet-1](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.core.corewindow.pointerpressed.aspx?cs-save-lang=1&cs-lang=cpp#code-snippet-1)

也可以从 C++ 获得。

# arrays - 多行文本框到二维数组

> ID：13463451
> 
> 赞同：0
> 
> 时间：2012-11-19T22:28:16.043
> 
> 标签：arrays, vb.net, .net-4.0

我将如何将以下输入插入到 2d 数组中，或者如果需要相同效果的不同类型的数组。

```
 abcd
  efgh
  ijkl 
```

当我单击一个按钮时，我的阵列向右或向左旋转 90 度（如果选择）我已经考虑了大约一个小时我尝试了一些事情但我在 VB.net 上是全新的

使用数字代替的示例：

```
1 2 3
4 5 6
7 8 9 
```

旋转：

```
7 4 1
8 5 2
9 6 3 
```

等等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:50:12.797

这可能会让您入门 您可能希望动态设置“行”和“列”的上限。这会将它输出到一个文本框，但是将变量分配给一个新数组就很容易了。

```
Dim arr(3, 3) As String

Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    Dim i As Integer = 1
    For row As Integer = 0 To 2
        For col As Integer = 0 To 2
            arr(row, col) = i
            i += 1
        Next
    Next
End Sub

Public Sub showStraight()
    TextBox1.Text = ""
    For row As Integer = 0 To 2
        Dim line As String = ""
        For col As Integer = 0 To 2
            line += arr(row, col)
        Next
        TextBox1.Text += line & vbNewLine
        line = ""
    Next
End Sub    Public Sub showRotated()
    TextBox1.Text = ""
    For col As Integer = 0 To 2
        Dim line As String = ""
        For row As Integer = 2 To 0 Step -1
            line += arr(row, col)
        Next
        TextBox1.Text += line & vbNewLine
        line = ""
    Next
End Sub 
```

# java - Java switch 语句 问题

> ID：13463452
> 
> 赞同：6
> 
> 时间：2012-11-19T22:28:16.403
> 
> 标签：java, switch-statement, identifier

该程序的重​​点是让用户输入三个考试成绩，然后将他们的平均成绩和字母成绩返回给他们。

它当前的编写方式给了我一个错误的“公共静态字符串 getLetterGrade..”行，我不知道为什么会这样..

```
public class GradeProblem
{
public static void main(String[] args)
{
 char letterGrade;
 String exam1, exam2, exam3;
 double exam1Score, exam2Score, exam3Score, average; 

 exam1 = JOptionPane.showInputDialog(null, "Enter your score for Exam 1: ");
 exam1Score = Double.parseDouble(exam1.substring(0,2));
 int intExam1Score = (int)exam1Score;

 exam2 = JOptionPane.showInputDialog(null, "Enter your score for Exam 2: ");
 exam2Score = Double.parseDouble(exam2.substring(0,2));
 int intExam2Score = (int)exam2Score;

 exam3 = JOptionPane.showInputDialog(null, "Enter your score for Exam 3: ");
 exam3Score = Double.parseDouble(exam3.substring(0,2));
 int intExam3Score = (int)exam3Score;

 average = (intExam1Score + intExam2Score + intExam3Score) / 3;

 int intAvergage = (int)average;
 letterGrade = getLetterGrade(intAverage);

 System.out.println("Your average is "+average);  
 System.out.println("Your letter grade is "+letterGrade); 

 }

 private static String getLetterGrade(average)
 {
String letterGrade;
switch(intAverage/10)
{
    case 10: letterGrade = "A";
    case 9: letterGrade = "A";
              break;
    case 8: letterGrade = "B";
              break;
    case 7: letterGrade = "C";
              break;
    case 6: letterGrade = "D";
    default:
              letterGrade = "E";
}
return letterGrade;

   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:29:57.237

它应该是

```
 private static String getLetterGrade(int average){ 
```

或任何数据类型，并且您在 switch 语句中引用另一个不存在的变量`intAverage`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:30:50.647

```
private static String getLetterGrade(int average) 
```

您忘记输入变量的类型`average`，它需要是`int`我假设的类型。

switch(intAverage/10) 需要更改为 switch(average/10)。

我还发现您选择 int 会导致准确性出现一些问题，除非您想忽略这一点。我会使用 if 语句和 switch 案例的范围，而不是仅仅将它们全部转换为整数。也许它会有所作为，也许它不会，但所有的铸造和准确性的损失只是让我觉得代码不完整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:31:11.593

该参数`average`没有类型。它应该是：

```
private static String getLetterGrade(int average) { 
```

匹配您传递给它的变量的类型。

# xml - Apache FOP XML - XLS-FO 生成无效的 pdf

> ID：13463455
> 
> 赞同：1
> 
> 时间：2012-11-19T22:28:27.420
> 
> 标签：xml, xslt, pdf, xsl-fo, apache-fop

我正在尝试使用 Apache FOP 从使用 xlst 样式表格式化的 xml 文件创建 PDF 文档，以将原始 xml 文件转换为 xml-fo 格式的 xml 文件。由于我是新手，我尝试创建一个简单的 hello world 示例，但没有成功。

生成过程似乎成功（没有例外），但生成的 pdf 文件由于某种原因无效。文件大小为 4.8KB，用 libreoffice writer 打开时，数据肯定已写入文件，但文件在 pdf 阅读器中打不开。

XML 文件相当简单：

```
<rentalRequest>
  <firstName>foo</firstName>
  <lastName>bar</lastName>
  <email>foo@bar.com</email>
  <street>foo street</street>
  <houseNo>42</houseNo>
  <postalCode>4242</postalCode>
  <city>bar city</city>
</rentalRequest> 
```

XSL 文件，只是尝试打印 Hello World!：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
                xmlns:fo="http://www.w3.org/1999/XSL/Format">

    <xsl:output method="xml" indent="yes" />

    <xsl:template match="/">
        <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
            <fo:layout-master-set>          
                <fo:simple-page-master master-name="all">
                    <fo:region-body />
                </fo:simple-page-master>
            </fo:layout-master-set>

            <fo:page-sequence master-reference="all">
                <fo:flow flow-name="xsl-region-body">
                    <fo:block>
                        Hello World!
                    </fo:block>
                </fo:flow>
            </fo:page-sequence>
        </fo:root>
    </xsl:template>

</xsl:stylesheet> 
```

使用 JAXP + FOP 生成 pdf 文件的 java 代码：

```
public void buildWithXSL(String xml) throws Exception {
        OutputStream out = new BufferedOutputStream(new FileOutputStream(new File("rentalrequest.pdf")));

        // setup xml input source
        StreamSource xmlSource =
                new StreamSource(new ByteArrayInputStream(xml.getBytes()));

        File xslFile = new File("src/main/resources/xml/rentalrequest2fo.xsl");
        FileInputStream xslFileStream = new FileInputStream(xslFile);
        StreamSource xslSource = new StreamSource(xslFileStream);

        TransformerFactory tfactory = TransformerFactory.newInstance();
        Transformer transformer = tfactory.newTransformer(xslSource);

        FopFactory fopFactory = FopFactory.newInstance();
        Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, out);

        // perform transformation 
        Result res = new SAXResult(fop.getDefaultHandler());
        transformer.transform(xmlSource, res);
    } 
```

生成的 pdf 文件可以在[http://www.filedropper.com/rentalrequest找到](http://www.filedropper.com/rentalrequest)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T07:17:14.270

您得到了一个不完整的 PDF 文件，因为您忘记正确地`close`将`OutputStream`. 当您打开`OutputStream`（或`InputStream`就此而言）时，请始终使用以下模式：

```
OutputStream out = new [Something]OutputStream([something]);
try {
    //write to the OutputStream
} finally {
    out.close();
} 
```

# javascript - 摆脱 jsfiddle 中的字符

> ID：13463458
> 
> 赞同：4
> 
> 时间：2012-11-19T22:28:44.450
> 
> 标签：javascript, jsfiddle

jsFiddle 似乎在小提琴中放置了一个不可见的字符，当 javascript 被复制/粘贴到另一个编辑器并运行时会导致错误。我知道简单的答案就是不要从该站点复制/粘贴。但是假设已经完成，并且您必须在文档中找到该字符：有没有在线工具可以用来显示不可见字符，并协助删除它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T23:04:25.307

[jsFiddle](http://jsfiddle.net)添加的不可见字符是**U+200B**（dec 8203），称为“零宽度空间”。您可以通过以下方式将其删除`.replace('\u200b','')`

具有讽刺意味的是，[**这是一个小提琴**](http://jsfiddle.net/djfdc/)。

# javascript - 更改CSS，当TAB具有活动类别时

> ID：13463460
> 
> 赞同：0
> 
> 时间：2012-11-19T22:28:59.163
> 
> 标签：javascript, jquery

我正在尝试`<body>`根据特定的选项卡处于活动状态来更改背景颜色。

When a tab is active, a class called 'st_view_active' is added onto the tab content. 在选项卡内容中，我添加了一个隐藏的 div，其中包含当该选项卡处于活动状态时我的正文背景颜色应该是什么的十六进制代码，我的 jQuery 代码如下所示：

```
$(document).ready(function() {
    $(function(){
         $('body').css('backgroundColor',$('.st_view_active').find('.background').text());
     });
 }); 
```

当标签处于活动状态时，我的HTML代码如下：

```
<div class="tab-6 st_view st_view_active" >
   <div style="display:none" class="background">yellow</div>
   <div class="st_view_inner">
        tab 6
    </div>
</div> 
```

因此，当 tab6 处于活动状态时，主体的背景应该是黄色的。但是，这不起作用，背景颜色没有改变，我在这里做错了什么？

[DEMO](http://jsfiddle.net/yunowork/CNYDU/1/)和[JSfiddle](http://jsfiddle.net/yunowork/CNYDU/1/show/)

谢谢 PS：红色和蓝色方块是下一个和上一个选项卡处理程序..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:20:55.747

见这里：http: [//jsfiddle.net/CNYDU/25/](http://jsfiddle.net/CNYDU/25/)

我将默认颜色放在 末尾`sColor`，但您可以改为获取第一个视图并使用它的颜色。我这样做是为了减少测试，因为你的小提琴很难用。

```
$(document).ready(function() {
    var hsh = window.location.hash.replace('#','');
    var sColor = hsh ? $("#slidetabs_45").find("."+hsh+" .background").text() : "#3b0";
    $("body").css("background-color", sColor);

    $("#slidetabs_45").slidetabs({
        onContentVisible:function(e){
            var color = $("#slidetabs_45").find(".st_view_active .background").text();

            $("body").css("background-color", color);
        }
    });       
}); 
```

我还将`.st_view_active`该类添加到第一个视图中，以便它可以正确启动。

我还为背景颜色添加了 CSS3 过渡，这不是必需的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:54:52.673

这听起来像是在 html 中使用数据元素的绝佳机会。`data-color`您可以简单地将属性添加到选项卡标签，而不是使用您想要的背景颜色隐藏 div `a`。然后，当单击 div 时，您可以使用事件处理程序轻松设置颜色。

链接到更新的小提琴 - [http://jsfiddle.net/CNYDU/15/](http://jsfiddle.net/CNYDU/15/)

注意：下一个和上一个选项卡在此示例中不起作用，但应该很容易让它们工作，只需将侦听器附加到每个运行的

`$('body').css('background-color', $(".st_tab_active").attr('data-color'));`

作为它的回调。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-19T22:49:43.307

查看 jQuery 的[livequery](http://docs.jquery.com/Plugins/livequery)插件。

> **Live Query 还能够*在匹配新元素时触发函数（回调），并在元素不再匹配时触发另一个函数（回调）***。这提供了最大的灵活性和无数的用例。例如，以下代码使用基于函数的 Live Query 来实现 jQuery hover 辅助方法，并在元素不再匹配时将其删除。

他们的例子：

```
$('li') 
.livequery(function(){ 
// use the helper function hover to bind a mouseover and mouseout event 
    $(this) 
        .hover(function() { 
            $(this).addClass('hover'); 
        }, function() { 
            $(this).removeClass('hover'); 
        }); 
}, function() { 
    // unbind the mouseover and mouseout events 
    $(this) 
        .unbind('mouseover') 
        .unbind('mouseout'); 
}); 
```

您应该能够使其适应您的 css 更改，例如触发事件，并因此根据哪个选项卡处于活动状态来执行您的操作。

我已经分叉[了 Jlange 的](https://stackoverflow.com/a/13463833/908471) [jsfiddle](http://jsfiddle.net/CNYDU/15/)，它使用了 data 属性，以演示如何使用这个插件：

*   [http://jsfiddle.net/nj6ZY/2/](http://jsfiddle.net/nj6ZY/2/)
*   [http://jsfiddle.net/nj6ZY/2/show/#tab-10](http://jsfiddle.net/nj6ZY/2/show/#tab-10) - 也适用于激活特定选项卡的链接

以及相关位：

```
$('.st_tabs_ul li a.st_tab_active').livequery(function(){ 
    $('body').css('background-color', $(this).data('color'));
}); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-19T22:36:38.437

把身份证放在你的标签上。id="tab6" 的示例：

```
$(document).ready(function() {
   if ($('#tab6').attr('class') == 'tab-6 st_view st_view_active') {
      $('body').css('background-color', 'yellow');
   }
}); 
```

但是，您为什么要将此功能附加到仅准备好的文档上？我会将函数绑定到单击元素时...

# android - IntentService android下载并返回文件给Activity

> ID：13463463
> 
> 赞同：2
> 
> 时间：2012-11-19T22:29:04.983
> 
> 标签：android, service, download

我有一个相当棘手的情况，我正在尝试确定最佳设计。基本情况是这样的：

*   我正在设计一个与电子邮件界面相似的消息传递系统。
*   当用户单击带有附件的消息时，将生成一个活动，该活动显示该消息的文本以及一个表明还有附加附件的回形针。
*   此时，我开始预加载附件，以便当用户单击它时 - 它加载得更快。
*   目前，当用户单击附件时，它会提示加载对话框，直到下载完成，此时它会加载单独的附件查看器活动，并传入 bmp 字节数组。
*   我不想将附件保存到持久存储中。

我遇到的困难是支持旋转以及按下主页按钮等。下载当前是通过线程和处理程序设置完成的。

而不是这个，我希望流程如下：

*   用户像以前一样加载消息，像以前一样预加载附件（用户不可见）。
*   当用户单击附件链接时，附件查看器活动会立即生成。
*   如果下载完成，将显示图像。如果没有，则在此活动中显示一个对话框，直到它完成并可以显示。请注意，理想情况下，下载永远不会重新启动，否则我在预加载上浪费了周期。

显然，我需要一些能够持续下载并能够回调任意绑定活动的持久后台进程。看起来 IntentService 几乎符合我的需求，因为它在后台线程中工作并且具有服务（非 UI）生命周期。但是，**它可以满足我的其他需求吗？**

我注意到我想要做的事情的常见实现从调用者 Activity 获取 Messenger，以便可以将 Message 对象发送回调用者线程中的 Handler。这一切都很好，但是在我的情况下，当调用者 Activity 被停止或销毁并且当前活动的 Activity（附件查看器）正在显示时会发生什么？ **是否有某种方法可以将新 Activity 动态绑定到正在运行的 IntentService，以便我可以将消息发送回新 Activity？**

另一个问题是关于 Message 对象。我可以在这个包中发回任意大的数据吗？例如，我不需要发回“文件已下载”，而是需要发回下载文件本身的字节数组，因为我不想将其写入磁盘（是的，必须如此）。

非常感谢任何有关实现我想要的行为的建议。我使用 Android 的时间不长，而且我经常对如何在 Activity 生命周期中最好地处理异步进程感到困惑，尤其是在方向更改和主页按钮按下时……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:55:39.623

您使用 IntentService 启动、工作，然后将其发布到某个持久存储中。要与 Activity 通信，您可以在 Activity 中使用广播接收器，并从 IntentService 发送广播 Intent。

旋转和按下主页按钮对 IntentService 没有影响，只要它仍在工作，但旋转会执行重绘，主页按钮会暂停 Activity。由于这些原因，您应该避免在 AsyncTask 中执行异步工作，除非它不必完成并且不必持久化。

消息是针对处理程序的，而不是针对组件的。通过系统传输信息的基本功能是意图和广播意图。

IntentService 简单地处理将 Intent 转换为 Message、创建新的 HandlerThread、将 Message 放入 HandlerThread 的 MessageQueue 以及触发 Looper 的工作。在后台线程上执行的 run() 是 onHandleIntent() 中的任何内容（这有点简化）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T22:56:04.840

有很多方法可以解决这个问题。你是对的，我认为你显然需要一个服务来将下载过程与可能来来去去的活动分离。为此，您需要在此服务中实现一些下载队列，并且 IntentService 提供了开箱即用的此行为，因此您可以使用它。IntentService 唯一想到的缺点是取消您之前发布的工作并不容易。

但是，我不会序列化下载的数据，它听起来效率不高，尤其是在处理大量二进制数据时。您可以将下载的数据写入内存中的 LRU 缓存并为其分配一个 ID，查看器活动可以通过该 ID 获取下载的数据。

您还可以使用广播 Intent 向服务中的查看器活动发出信号，表明具有特定 ID 的下载已完成。这将确保查看活动和下载服务之间的松散耦合。

所以它会是这样的：

1.  用户打开带有附件的消息。
2.  您将此附件的下载作业发布到下载器 IntentService，并为此附件分配一个唯一 ID。
3.  当用户单击附件时，您将启动查看器活动并将附件的唯一 ID 作为此活动的参数传递。
4.  查看器活动打开，它立即检查缓存以显示要显示的内容。如果还没有完成，它会显示一些加载图形并等待下载器 IntentService 用广播 Intent 喊出“xy ID 完成”。如果 xy ID == 传递给此查看器活动的 ID，您将从缓存中获取现已完全下载的内容并将其呈现给用户。

**编辑：**

至于缓存，你必须做出一些选择。我认为这本身就是一个相当广泛的话题，所以我将根据我之前的项目在这里写一些想法。

上面，我只提到了内存中的 LRU 缓存。这将存在于自定义应用程序对象中，或作为单例。这是使用邪恶的全局状态，但我认为在这种情况下它是合理的。优点是您不需要在任何地方序列化下载的数据：下载完成，内存中有内容，您可以立即从 Viewer Activity 访问它。缺点是，这些数据只有在没有从缓存中删除或者系统不会因为内存不足而终止应用程序的进程时才可用。

为了避免在丢失此易失性内存缓存的内容时重新下载数据，您需要为其添加一个持久层。例如将下载的数据写入[应用程序的缓存目录](http://developer.android.com/reference/android/content/Context.html#getCacheDir%28%29)。这带来了将下载的数据写入磁盘的开销，但至少您以后可以访问它，即使系统杀死了您的进程。您可以使用 2 级缓存方法将此持久性缓存与内存中缓存相结合，或者您可以选择其中任何一种。我建议查看一些广泛使用的实现此行为的图像下载器库以获取灵感，例如[Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader)。

# objective-c - 在委托回调期间应该如何延长委托对象的生命周期？

> ID：13463467
> 
> 赞同：6
> 
> 时间：2012-11-19T22:29:11.753
> 
> 标签：objective-c, memory-management, object-lifetime

我将把一个非常常见的情况提炼成一般形式。假设我正在构建一些关闭的库对象，执行一些异步工作，然后在完成后回调委托方法。现在，还出于某种任意原因说我不能使用 ARC 或块进行回调。这是老式的。我们称这个对象为 Worker。

现在说在各种应用程序中还有其他几个类，除了它的公共接口之外，它们对 Worker 一无所知。他们利用工人达到自己的目的。我们称这些类为消费者。

说 Worker 像这样进行委托回调：

```
// "Private" method called internally when work is done.
- (void)somethingFinished
{
    [self.delegate workerDidFinish];
    [self someTask];
} 
```

并说一些特定的消费者像这样处理回调：

```
- (void)workerDidFinish
{
    // Assume "worker" is a retain property to a Worker
    // instance that we previously created and began working,
    // and that it's also the sender of the message.
    self.worker = nil;
    // Other code...
} 
```

现在，如果没有其他东西保留了那个特定的 Worker 实例，我们就有麻烦了。Worker 将被释放，然后控制权将返回到它的`-somethingFinished`方法，然后它将发送`-someTask`到回收或垃圾内存，并可能崩溃。没有人公然违反任何内存管理规则。

我不是在这里寻求技术解决方案。我知道几种选择。我想知道修复的责任落在谁身上。作为组件设计者，我是否应该实现 Worker 的`-somethingFinished`方法，以便在方法的持续时间内延长 Worker 的生命周期，就像`[[self retain] autorelease]`在开始时一样？或者，作为组件的使用者，我是否应该意识到我可能会在实例方法的中途吹走一个对象，然后等到稍后再释放它？

[这个问题](https://stackoverflow.com/questions/4064604/releasing-a-delegating-object-in-its-delegate-callback-method)的答案似乎都表明从回调中释放对象是一个坏主意。不幸的是，关于 Worker（在本例中为 CLLocationManager）究竟是如何传递给委托的，这个问题中有很多令人分心的信息，而我在这里故意避免了这些信息。[这个问题](https://stackoverflow.com/questions/4705520/how-to-allow-the-object-to-be-released-on-callback)遇到了同样的情况，并提供了另一种解决方案。

就个人而言，我看不出如何追究消费者的责任。它没有违反任何内存管理规则，并且礼貌地使用了 Worker 的公共接口。它只是在不再需要时释放一个实例。但另一方面，这是否意味着任何可能以某种方式在中间方法中被释放的对象都需要人为地延长其自身的生命周期？毕竟，委托方法并不是消息发送者最终在方法中间被释放的唯一方式。

那么最终，谁负责修复？工人？消费者？它可以规范地确定吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:58:53.533

我认为这个例子中的负担在工人身上。我看到的问题是 Worker 对象在告诉其 Consumer 其工作已完成后正在内部做某事。Worker 只是为了消费者而存在，所以如果消费者的目标得到满足，为什么 Worker 仍然在做对消费者没有价值的事情呢？如果在“消耗性”工作完成后需要完成内部任务，则这些任务不适合放置在 Worker 对象的实例中，但可能应该由易失性较小的库类拥有的另一个内部对象完成不会被消费者的行为解除分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:58:08.523

当代理收到通知时，应该开始观察工作人员并仅在 somethingFinushed 方法终止时释放它。

# npm - grunt js 安装包

> ID：13463468
> 
> 赞同：16
> 
> 时间：2012-11-19T22:29:13.607
> 
> 标签：npm, gruntjs

我正在用 grunt 构建一个 grunt javascript 项目，并且我有一个 package.json 文件，它看起来像：

```
{
   ... name, author, etc here ...

   "dependencies": {
      "grunt-html":"0.2.1"
   }

 } 
```

我可以运行`npm install`安装 grunt-html 并且这工作得很好。但是当我添加新的依赖项时，团队中的所有开发人员都必须知道要`npm install`再次运行。有没有办法自动安装尚未安装的任何软件包？我应该只运行 npm install 以确保我是最新的吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-20T00:02:08.707

是`npm install`的，这是 IMO 最简单的方法。让每个人都熟悉其他`npm`命令也可以更轻松地管理部门。如：

*   `npm ls`列出当前安装的模块。
*   或`--save`标志，即`npm install grunt-html --save`安装包和版本并将其插入到您的`package.json`.
*   `npm prune`删除未包含在您的`package.json`.

管理依赖项的其他方法是提交`node_modules`存储库中的文件夹以避免其他开发人员必须运行`npm install`. 或者对于更复杂的项目，考虑使用`npm shrinkwrap`将依赖项锁定到特定版本：[npm shrinkwrap docs](https://npmjs.org/doc/shrinkwrap.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-26T15:20:58.020

我没有尝试过 grunt-install-dependencies ( [https://github.com/ahutchings/grunt-install-dependencies](https://github.com/ahutchings/grunt-install-dependencies) )，但这似乎可以满足您的需求。只需将命令 install-dependencies 添加为自定义定义的 grunt tasts 中的第一个任务，例如

grunt.registerTask('build', ['install-dependencies', 'useminPrepare', ... ]);

# c++ - OpenCV StereoRectifyUncalibrated 到 3D 点云

> ID：13463476
> 
> 赞同：1
> 
> 时间：2012-11-19T22:29:38.240
> 
> 标签：c++, opencv, stereo-3d

我有一些代码可以计算出使用 cv::stereoRectifyUncalibrated 计算值的所有部分。但是，我不确定从那里去哪里获得 3D 点云。

我的代码可以与校准版本一起使用，它给我一个 Q 矩阵，然后我将它与 reprojectImageTo3D 和 StereoBM 一起使用，给我一个点云。

我想比较两种不同方法的结果，因为有时我无法校准相机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:01:09.453

[http://blog.martinperis.com/2012/01/3d-reconstruction-with-opencv-and-point.html](http://blog.martinperis.com/2012/01/3d-reconstruction-with-opencv-and-point.html)我认为这会有所帮助。它有一个使用 PCL 将视差图像转换为点云并在 3D 查看器中显示的代码。

由于您有 Q、两个图像和其他相机参数（来自校准），您应该使用它`ReprojectTo3D`来获取深度图。

使用`StereoBM`或`stereoSGBM`获取视差图并使用该视差图和 Q 获取深度图像。

```
StereoBM sbm;
sbm.state->SADWindowSize = 9;
sbm.state->numberOfDisparities = 112;
sbm.state->preFilterSize = 5;
sbm.state->preFilterCap = 61;
sbm.state->minDisparity = -39;
sbm.state->textureThreshold = 507;
sbm.state->uniquenessRatio = 0;
sbm.state->speckleWindowSize = 0;
sbm.state->speckleRange = 8;
sbm.state->disp12MaxDiff = 1;

sbm(g1, g2, disp); // g1 and g2 are two gray images
reprojectImageTo3D(disp, Image3D, Q, true, CV_32F); 
```

该代码基本上将深度图转换为点云。

```
 pcl::PointCloud<pcl::PointXYZRGB>::Ptr point_cloud_ptr (new pcl::PointCloud<pcl::PointXYZRGB>);
 double px, py, pz;
 uchar pr, pg, pb;

 for (int i = 0; i < img_rgb.rows; i++)
 {
     uchar* rgb_ptr = img_rgb.ptr<uchar>(i);
     uchar* disp_ptr = img_disparity.ptr<uchar>(i);
     double* recons_ptr = recons3D.ptr<double>(i);
     for (int j = 0; j < img_rgb.cols; j++)
     {
         //Get 3D coordinates

          uchar d = disp_ptr[j];
          if ( d == 0 ) continue; //Discard bad pixels
          double pw = -1.0 * static_cast<double>(d) * Q32 + Q33; 
          px = static_cast<double>(j) + Q03;
          py = static_cast<double>(i) + Q13;
          pz = Q23;

          // Normalize the points
          px = px/pw;
          py = py/pw;
          pz = pz/pw;

          //Get RGB info
          pb = rgb_ptr[3*j];
          pg = rgb_ptr[3*j+1];
          pr = rgb_ptr[3*j+2];

          //Insert info into point cloud structure
          pcl::PointXYZRGB point;
          point.x = px;
          point.y = py;
          point.z = pz;
          uint32_t rgb = (static_cast<uint32_t>(pr) << 16 |
          static_cast<uint32_t>(pg) << 8 | static_cast<uint32_t>(pb));
          point.rgb = *reinterpret_cast<float*>(&rgb);
          point_cloud_ptr->points.push_back (point);
    }
}

point_cloud_ptr->width = (int) point_cloud_ptr->points.size();
point_cloud_ptr->height = 1;

//Create visualizer
boost::shared_ptr<pcl::visualization::PCLVisualizer> viewer;
viewer = createVisualizer( point_cloud_ptr ); 
```

# javascript - 在函数内部传递一个 JSON 对象

> ID：13463477
> 
> 赞同：0
> 
> 时间：2012-11-19T22:29:39.957
> 
> 标签：javascript, json

是否可以在第一个函数中将 JSON 对象作为参数传递，然后将相同的 JSON 对象从第一个函数传递给第二个函数？我是否需要先提取它，然后在将其传递给第二个函数之前进行字符串化？

谢谢

例如，我有以下 JSON 对象

```
var client=[{"clientID":"1234",
             "businessName":"ABC Corporation",
             "legalName":"DCF Inc.",
             "clientName":"John"}]; 
```

我将此客户端 JSON 对象传递给第一个函数：

```
function saveClient(clients){

// inside this function, I want to pass this whole Client object into the
// second function     

    function showClient(clients){
    // so inside this function, I can parse this Client object to get the 
    // string and value
    var clientID=client.clientID;
    var businessName=client.businessName;
    .....
    .....
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:31:26.727

当然，只需传递您想要的数组元素（假设`i`是感兴趣的客户端的索引）：

```
showClient(clients[i]); 
```

绝对不需要“字符串化”或类似的东西，因为您在这里完全在 Javascript 中工作。

# c# - 通用铸造

> ID：13463478
> 
> 赞同：1
> 
> 时间：2012-11-19T22:29:41.450
> 
> 标签：c#, .net, generics, casting

我有这个通用类

```
public abstract class BaseExportCommand<T> where T : EditableEntity, new()
{
....
} 
```

我有这个派生类

```
public class MessageExportCommand : BaseExportCommand<Message> 
{
 .....
} 
```

Message 继承自 EdittableEntity 的位置

```
public class Message : EditableEntity
{
...
} 
```

现在，当我尝试做这个声明时

```
BaseExportCommand<EditableEntity> myValue = new MessageExportCommand (); 
```

我收到以下错误：

```
Cannot convert type 'MessageExportCommand' to 'BaseExportCommand<EditableEntity>' 
```

知道为什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T22:34:51.170

> 知道为什么吗？

是的。您的泛型*类型*在`T`.

我们不能立即判断它是否应该。例如，假设它看起来像这样：

```
public abstract class BaseExportCommand<T> where T : EditableEntity, new()
{
    public abstract DoSomethingWithEntity(T entity);
} 
```

然后假设你可以写：

```
BaseExportCommand<EditableEntity> myValue = new MessageExportCommand();
EditableEntity entity = new SomeEditableEntity();
myValue.DoSomethingWithEntity(entity); 
```

...而`MessageExportCommand`只期望`DoSomethingWithEntity(Message)`.

如果您仅将`T`其用作 的*输出*，这是安全的`BaseExportCommand<T>`，但不幸的是，C# 不允许您为类声明协变类型参数 - 仅用于接口和委托。所以你可能*会*写：

```
// Note the "out" part, signifying covariance
public interface IExportCommand<out T> where T : EditableEntity, new() 
```

然后：

```
IExportCommand<EditableEntity> = new MessageExportCommand(); 
```

...但这取决于接口中声明了哪些成员。如果您尝试`T`在任何“输入”位置使用，编译器会注意到并阻止您进行`T`协变声明。

有关更多详细信息，请参阅[MSDN 中的泛型类型的方差](http://msdn.microsoft.com/en-us/library/ms228359.aspx)，以及[Eric Lippert 的有关该主题的博客文章](http://blogs.msdn.com/b/ericlippert/archive/tags/covariance+and+contravariance/)（安顿下来，放松一下，有很多要阅读的内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:33:28.837

这仅在您声明`T`为协变体时才有效：

```
public abstract class BaseExportCommand<out T> where T : EditableEntry, new()
{
    ...
} 
```

协变意味着，您可以将它用于`T`或任何继承自`T`.

另请参阅[协变和逆变常见问题解答](http://blogs.msdn.com/b/csharpfaq/archive/2010/02/16/covariance-and-contravariance-faq.aspx)。

# c# - WPF 用户控件调整大小

> ID：13463480
> 
> 赞同：0
> 
> 时间：2012-11-19T22:29:50.000
> 
> 标签：c#, wpf, user-controls, wpf-controls

我的目标是创建一个用户控件，当我在设计器中更改它的大小时它会重绘。为简单起见，我创建了 usercontrol Cross。（我是 WPF 的初学者）。

*交叉.xaml：*

```
<UserControl x:Class="WpfApplication2.Cross"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid Name="Grid1">
    </Grid>
</UserControl> 
```

*Cross.xaml.cs*（不使用 using 语句）：

```
namespace WpfApplication2
{
    /// <summary>
    /// Interaction logic for Cross.xaml
    /// </summary>
    /// 
    public partial class Cross : UserControl
    {
        public Cross()
        {
            InitializeComponent();

            Line l = new Line();
            l.X1 = 0; l.Y1 = 0; l.X2 = 300; l.Y2 = 300;
            l.Stroke = new SolidColorBrush(Colors.Black);
            Grid1.Children.Add(l);
            l = new Line();
            l.X1 = 0; l.Y1 = 300; l.X2 = 300; l.Y2 = 0;
            l.Stroke = new SolidColorBrush(Colors.Black);
            Grid1.Children.Add(l);
        }
    }
} 
```

因此，当我将设计器中 Cross 的大小从 300 更改为 600 时，我希望有 2 行 - [0,0,600,600]、[0,600,600,0] 而不是 [0,0,300,300]、[0,300,300,0]。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:36:01.223

尝试使用 The [`ViewBox`](http://msdn.microsoft.com/en-us/library/system.windows.controls.viewbox.aspx)Control ，将您的 xaml 更改为

```
<UserControl x:Class="WpfApplication2.Cross"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <Viewbox>
            <Grid Name="Grid1"/>
        </Viewbox>
    </Grid>
</UserControl> 
```

# python - 在 numpy 数组上使用二进制结构迭代以获得单元格总和

> ID：13463483
> 
> 赞同：3
> 
> 时间：2012-11-19T22:29:55.087
> 
> 标签：python, multidimensional-array, numpy, scipy

在包 scipy 中有定义二进制结构的功能（例如出租车（2,1）或棋盘（2,2））。

```
import numpy
from scipy import ndimage
a = numpy.zeros((6,6), dtype=numpy.int) 
a[1:5, 1:5] = 1;a[3,3] = 0 ; a[2,2] = 2
s = ndimage.generate_binary_structure(2,2) # Binary structure
#.... Calculate Sum of 
result_array = numpy.zeros_like(a) 
```

我想要的是用给定的结构迭代这个数组的所有单元格。然后我想将一个函数附加到在空数组中索引的当前单元格值（示例函数 sum），它使用二进制结构中所有单元格的值。

例如：

```
array([[0, 0, 0, 0, 0, 0],
    [0, 1, 1, 1, 1, 0],
    [0, 1, 2, 1, 1, 0],
    [0, 1, 1, 0, 1, 0],
    [0, 1, 1, 1, 1, 0],
    [0, 0, 0, 0, 0, 0]]) 
```

# 数组 a。单元格 1,2 中的值当前为 1。给定结构 s 和一个示例函数，例如 sum，结果数组 (result_array) 中的值变为 7（如果当前单元格值被排除，则为 6）。

有人有想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T01:27:36.263

对于总和的特殊情况，您可以使用[ndimage.convolve](http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.filters.convolve.html)：

```
In [42]: import numpy as np

In [43]: a = np.zeros((6,6), dtype=np.int) 
a[1:5, 1:5] = 1;
a[3,3] = 0;
a[2,2] = 2

In [48]: s = ndimage.generate_binary_structure(2,2) # Binary structure

In [49]: ndimage.convolve(a,s)
Out[49]: 
array([[1, 2, 3, 3, 2, 1],
       [2, 5, 7, 7, 4, 2],
       [3, 7, 9, 9, 5, 3],
       [3, 7, 9, 9, 5, 3],
       [2, 4, 5, 5, 3, 2],
       [1, 2, 3, 3, 2, 1]]) 
```

对于产品的特定情况，您可以使用事实`log(a*b) = log(a)+log(b)`将问题转换回涉及总和的问题。例如，如果我们想要 "product-convolve" `b`：

```
b = a[1:-1, 1:-1]
print(b)
# [[1 1 1 1]
#  [1 2 1 1]
#  [1 1 0 1]
#  [1 1 1 1]] 
```

我们可以计算：

```
print(np.exp(ndimage.convolve(np.log(b), s, mode = 'constant')))
# [[ 2\.  2\.  2\.  1.]
#  [ 2\.  0\.  0\.  0.]
#  [ 2\.  0\.  0\.  0.]
#  [ 1\.  0\.  0\.  0.]] 
```

如果`b`包含负值，情况会变得更加复杂：

```
b[0,1] = -1
print(b)
# [[ 1 -1  1  1]
#  [ 1  2  1  1]
#  [ 1  1  0  1]
#  [ 1  1  1  1]] 
```

但并非不可能：

```
logb = np.log(b.astype('complex'))
real, imag = logb.real, logb.imag
print(np.real_if_close(
    np.exp(
        sum(j * ndimage.convolve(x, s, mode = 'constant')
            for x,j in zip((real, imag),(1,1j))))))
# [[-2\. -2\. -2\.  1.]
#  [-2\. -0\. -0\.  0.]
#  [ 2\.  0\.  0\.  0.]
#  [ 1\.  0\.  0\.  0.]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:50:46.317

如果您使用 2 深的零墙会更容易：

```
In [11]: a0
Out[11]: 
array([[ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  1.,  1.,  1.,  0.,  0.],
       [ 0.,  0.,  1.,  2.,  1.,  1.,  0.,  0.],
       [ 0.,  0.,  1.,  1.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  1.,  1.,  1.,  1.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]])

In [12]: b0 = zeros_like(a0)

In [13]: for i in range(1,len(a0)-1):
   ....:     for j in range(1,len(a0)-1):
   ....:         b0[i,j] = sum(a0[i-1:i+2, j-1:j+2] * s) 
```

这使您可以根据需要将两个子矩阵相乘并求和。（你也可以在这里做一些更详细的事情......）

```
In [14]: b0
Out[14]: 
array([[ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  2.,  3.,  3.,  2.,  1.,  0.],
       [ 0.,  2.,  5.,  7.,  7.,  4.,  2.,  0.],
       [ 0.,  3.,  7.,  9.,  9.,  5.,  3.,  0.],
       [ 0.,  3.,  7.,  9.,  9.,  5.,  3.,  0.],
       [ 0.,  2.,  4.,  5.,  5.,  3.,  2.,  0.],
       [ 0.,  1.,  2.,  3.,  3.,  2.,  1.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]])

In [15]: b0[1:len(b0)-1, 1:len(b0)-1]
Out[15]: 
array([[ 1.,  2.,  3.,  3.,  2.,  1.],
       [ 2.,  5.,  7.,  7.,  4.,  2.],
       [ 3.,  7.,  9.,  9.,  5.,  3.],
       [ 3.,  7.,  9.,  9.,  5.,  3.],
       [ 2.,  4.,  5.,  5.,  3.,  2.],
       [ 1.,  2.,  3.,  3.,  2.,  1.]]) 
```

# touch - Sencha touch 2 filterby() 不更新记录

> ID：13463486
> 
> 赞同：2
> 
> 时间：2012-11-19T22:30:08.690
> 
> 标签：touch, sencha-touch-2

我在从“offices.json”中提取数据的选项卡式面板应用程序的一个页面上有一个嵌套列表

当用户单击工具栏按钮时，我希望能够过滤此列表。但是，我的 filterBy() 函数不会更新商店和我可以看到的办公室列表，即使我可以在控制台中看到它正在迭代记录并找到匹配项。我究竟做错了什么？（是的，我在 filterBy 之前和之后都尝试过 s.load() 无济于事！）

```
toolbar:{                        
   items:[{
           text: 'Near you',
           id: 'btnNearYou',
           xtype: 'button',
           handler: function() {
             s = Ext.StoreMgr.get('offices');
             s._proxy._url = 'officesFLAT.json';        
             console.log("trying to filter");
             s.filterBy(function(record) {
              var search = new RegExp("Altrincham", 'i'); 
              if(record.get('text').match(search)){
               console.log("did Match");
               return true;
              }else {
               console.log("didnt Match");
               return false;
             }
           });
           s.load();
          }                            
   }] 
```

为了记录，我这样定义我的商店：

```
store: {
    type: 'tree',
    model: 'ListItem',
    id: 'offices',
    defaultRootProperty: 'items',
    proxy: {
        type: 'ajax',
        root: {},
        url: 'offices.json',
        reader: {
            type: 'json',
            rootProperty: 'items'
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:43:53.353

1.  无需每次都重新创建正则表达式，将其缓存在外部。

2.  您可以大大简化代码（见下文）。

3.  为什么你之后直接调用load？这会将它发送到服务器，它只会检索相同的数据集。

```
toolbar: {
    items: [{
        text: 'Near you',
        id: 'btnNearYou',
        xtype: 'button',
        handler: function() {
            s = Ext.StoreMgr.get('offices');
            s._proxy._url = 'officesFLAT.json';
            var search = /Altrincham/i;
            s.filterBy(function(record) {
                return !!record.get('text').match(search);
            });
        }
    }]
} 
```

# android - 使用搜索栏将数据从主要活动传递到 SurfaceView 线程

> ID：13463487
> 
> 赞同：1
> 
> 时间：2012-11-19T22:30:08.430
> 
> 标签：android, multithreading, surfaceview

我有一个主要活动类，我还有一个 SurfaceView 类，它在我的主要活动开始时启动。

我在主要活动中有一个搜索栏。我想将搜索栏产生的任何数据发送到 SurfaceView 以在每次更改时显示它。

我怎样才能做到这一点？

谢谢。

这是我的 SurfaceView 类：

```
public class SurfaceViewGauge extends SurfaceView implements SurfaceHolder.Callback{

 private MySurfaceThread thread;
 private Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);

 public SurfaceViewGauge(Context context) {
  super(context);
  // TODO Auto-generated constructor stub
  init();
 }

 public SurfaceViewGauge(Context context, AttributeSet attrs) {
  super(context, attrs);
  // TODO Auto-generated constructor stub
  init();
 }

 public SurfaceViewGauge(Context context, AttributeSet attrs, int defStyle) {
  super(context, attrs, defStyle);
  // TODO Auto-generated constructor stub
  init();
 }

  private void init(){
    getHolder().addCallback(this);
    thread = new MySurfaceThread(getHolder(), this);

    setFocusable(true); // make sure we get key events

    paint.setStyle(Paint.Style.STROKE);
    paint.setStrokeWidth(3);
    paint.setColor(Color.WHITE);

   }

 public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
  // TODO Auto-generated method stub

 }

 public void surfaceCreated(SurfaceHolder holder) {
  // TODO Auto-generated method stub
  thread.setRunning(true);
  thread.start();

 }

 public void surfaceDestroyed(SurfaceHolder holder) {
  // TODO Auto-generated method stub
  boolean retry = true;
  thread.setRunning(false);
  while (retry) {
   try {
    thread.join();
    retry = false;
   }
   catch (InterruptedException e) {
   }
  }
 }

 @Override
 protected void onDraw(Canvas canvas) {
  // TODO Auto-generated method stub

 }

} 
```

这是我的线程类：

```
 public class MySurfaceThread extends Thread {
 private SurfaceHolder myThreadSurfaceHolder;
 private SurfaceViewGauge myThreadSurfaceView;
 private boolean myThreadRun = false;

 public MySurfaceThread(SurfaceHolder surfaceHolder, SurfaceViewGauge surfaceView) {
  myThreadSurfaceHolder = surfaceHolder;
  myThreadSurfaceView = surfaceView;
 }

 public void setRunning(boolean b) {
  myThreadRun = b;
 }

 @Override
 public void run() {
  // TODO Auto-generated method stub
  while(myThreadRun){
   Canvas c = null;

   try{
    c = myThreadSurfaceHolder.lockCanvas(null);
    synchronized (myThreadSurfaceHolder){
     myThreadSurfaceView.onDraw(c);
    }
    sleep(0);
   } catch (InterruptedException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
   finally{
    // do this in a finally so that if an exception is thrown
    // during the above, we don't leave the Surface in an
    // inconsistent state
    if (c != null) {
     myThreadSurfaceHolder.unlockCanvasAndPost(c);
    }
   }
  }
 } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T14:52:46.117

在您的代码中，添加 Handler..

```
public Handler mhandler;

public SurfaceViewGauge(Context context, Handler mhandler) 
{
super(context);
this.mhandler = mhandler;
// TODO Auto-generated constructor stub
init();
} 
```

在上面的代码中，使用 Handler 对象来发送代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T20:58:14.963

在您的 MainActivity 中声明一个静态变量，该变量将保存 seekbar 值，并在您的表面视图代码中借助处理程序调用该静态变量，例如

```
MainClass.seekValue; 
```

# mysql - DATETIME 选择过去 2 小时内的行

> ID：13463498
> 
> 赞同：13
> 
> 时间：2012-11-19T22:31:11.050
> 
> 标签：mysql, sql

我正在尝试从过去 2 小时中选择行。由于某种原因，它不起作用。代码语法在其他表上使用时看起来不错并且可以工作，但由于某种原因在 table 上使用时`Posts`，获取的行早于 2 小时。

```
SELECT * FROM Posts WHERE `Date` > SUBDATE( CURRENT_DATE, INTERVAL 2 HOUR) 
```

代码有问题吗？有没有别的写法？这可能是什么原因？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-19T22:34:02.873

您可以使用更简单的符号：

```
SELECT * FROM Posts WHERE `Date` > NOW() - INTERVAL 2 HOUR 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-19T22:35:00.583

那是因为你正在使用`CURRENT_DATE`，你应该使用`NOW()`or`CURRENT_TIMESTAMP`代替。

问题是使用`CURRENT_DATE`, 作为日期值，时间默认为`00:00:00`，因此通过减去 2 小时，您最终会得到`22:00:00`前一天，而不是最后 2 小时......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-19T22:33:27.843

改为：

```
SELECT * FROM Posts WHERE `Date` > SUBDATE( CURRENT_TIMESTAMP, INTERVAL 2 HOUR) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-02T12:02:41.313

你可以试试这个

```
SELECT * FROM Posts WHERE `Date` > DATE_SUB(CURDATE(), INTERVAL 3 HOUR) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-24T13:58:24.887

上面的答案都不适合我，试试这个：

```
SELECT * FROM POSTS WHERE DATE > DATEADD(HH, (-2), GETDATE()) 
```

# php - 如何向特定 IP 显示内容

> ID：13463499
> 
> 赞同：0
> 
> 时间：2012-11-19T22:31:12.593
> 
> 标签：php, html, ip-address

我正在尝试将 div 显示到特定的 IP 地址。我该怎么做呢？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T22:32:58.823

```
if ( $_SERVER['REMOTE_ADDR'] == '192.168.1.114' )
    // show the div 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T22:36:13.647

最简单的是：

```
<?php

if($_SERVER['REMOTE_ADDR'] == "127.0.0.1")
{
    echo "<div>Nothing beats home</div>";
}    

?> 
```

请注意，如果服务器位于 NAT 后面，则 $_SERVER['REMOTE_ADDR'] 将是路由器的，如果您使用端口转发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T22:35:17.277

```
if (isset($_SERVER["REMOTE_ADDR"])){$ip = $_SERVER["REMOTE_ADDR"];}
else if (isset($_SERVER["HTTP_X_FORWARDED_FOR"])){$ip = $_SERVER["HTTP_X_FORWARDED_FOR"];}
else if ( isset($_SERVER["HTTP_CLIENT_IP"])){$ip = $_SERVER["HTTP_CLIENT_IP"];}

if($ip == 'xxx.xxx.xxx'){echo '<div>special content</div>';} 
```

# javascript - 如何使用 Javascript/JQuery 在悬停时设置缩略图背景？

> ID：13463504
> 
> 赞同：0
> 
> 时间：2012-11-19T22:31:25.957
> 
> 标签：javascript, jquery, image, html, css

当用户将鼠标悬停在一个小缩略图上时，我希望该图像替换背景图像。

如何使用 Javascript/JQuery 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:33:51.347

```
$('thumbnail id').hover(function(){
    $(this).css('background-image','new image');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:39:29.560

[JQuery 的悬停](http://api.jquery.com/hover/)会解决这个问题。基本上，您想获取图像并设置其悬停功能以设置背景图像（如果这是您想要的行为，则在悬停时取消设置）

```
$('#tumbnail_id').hover(function() {
    // set the background
}, function() {
    // unset the background
}); 
```

假设您的缩略图 HTML 标记的 id 为`tumbnail_id`. 如果你有几个缩略图，你可以用你的选择器和 CSS 类做一些更聪明的事情，但这是添加悬停功能的基础。

# perl -

> ID：13463509
> 
> 赞同：28
> 
> 时间：2012-11-19T22:31:42.870
> 
> 标签：perl

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-19T22:33:58.213

引用[文档](http://perldoc.perl.org/SelfLoader.html#The-__DATA__-token)：

> 该`__DATA__`标记告诉 perl 编译器用于编译的 perl 代码已完成。
> 
> `__DATA__`令牌之后的所有内容都**可以通过 filehandle 读取`FOOBAR::DATA`**，其中是到达令牌`FOOBAR`时当前包的名称。`__DATA__`
> 
> 这与包'main'中的工作方式相同`__END__`，但对于其他模块，数据之后`__END__`不会自动检索，而数据之后`__DATA__`是。

只能补充一点，使用`__DATA__`部分非常方便地说明 Perl 中一些与文件读取相关的概念。它基本上是一个附加到代码的文件，并且该文件的内容可以通过`<DATA>`. 这就是为什么它在 SO 上很受欢迎的原因。)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-19T22:34:13.667

之后的所有内容都`__DATA__`被视为可以从 filehandle 读取的文件`DATA`。 `DATA`会自动打开，您无需执行任何操作即可获得它。

什么不清楚？您的程序似乎正在正确使用它。

# android - 如何检查数据是否已保存在 Android 数据库中

> ID：13463514
> 
> 赞同：0
> 
> 时间：2012-11-19T22:32:00.373
> 
> 标签：android, database, compare

我正在尝试检查用户输入的文本是否已经在我的数据库中，但不确定应该如何完成。

所以我可以通过在我的数据库助手类中调用以下命令从我的数据库中获取数据：

```
public Cursor fetchDamagedComponentsForLocation(long damagedComponentId) {
    Cursor mCursor =
            rmDb.query(true, DAMAGED_COMPONENTS_TABLE, new String[] {
                    COMPONENT_ID, LOCATION_LINK, RUN_LINK, AREA_LINK, INSPECTION_LINK, LOCATION_REF, RACKING_SYSTEM, COMPONENT, POSITION, RISK, ACTION_REQUIRED, NOTES_GENERAL, MANUFACTURER, TEXT1, TEXT2, TEXT3, TEXT4, NOTES_SPEC}, 
                    LOCATION_LINK + "=" + damagedComponentId, null,
                    null, null, null, null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
} 
```

对于每个数据库条目，我需要检查两个用户输入是否与用户单击保存按钮时从 Spinners 获得的两个数据库字段（在本例中为 COMPONENT 和 POSITION）匹配：

```
 String component = ((Cursor)componentSpinner.getSelectedItem()).getString(2).toString();
    String position = ((Cursor)positionSpinner.getSelectedItem()).getString(1).toString(); 
```

这基本上是为了确保尚未保存该组件。

我敢肯定这很简单，但我不知道该怎么做..

编辑 - 按照 Sams 的建议，我已将以下类添加到我的数据库助手类中：

```
 public boolean checkIfComponentAlreadySaved(long locationId, String component, String position) {
     Cursor mCursor = rmDb.query(DAMAGED_COMPONENTS_TABLE, new String[] {"1"}, 
             LOCATION_LINK + " = " + locationId + " AND " + COMPONENT + " = " + component + " AND " + POSITION + " = " + position, null, null, null, null, null);
     boolean result = mCursor.moveToFirst();
     mCursor.close();
     return result;
 } 
```

但是，我收到以下错误：

android.database.sqlite.SQLiteException：靠近“pin”：语法错误：，编译时：从损坏的组件表中选择 1 WHERE location_link = 3 AND component = Locking pin AND position = Not Applicable

我猜这是因为我正在比较字符串，但是有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:42:03.983

`moveToFirst()`如果存在一行或多行，则返回 true，如果 Cursor 为空，则返回 false。所以创建一个像这样的新方法：

```
public boolean isComponentDamagedForLocation(long damagedComponentId) {
    Cursor mCursor =
            rmDb.query(DAMAGED_COMPONENTS_TABLE, new String[] {"1"}, 
                    LOCATION_LINK + "=" + damagedComponentId, null,
                    null, null, null, null);
    result = mCursor.moveToFirst();
    mCursor.close();
    return result;
} 
```

确切的列无关紧要，因此您可以传递您想要的任何内容，WHERE 子句是此查询的核心。使用此 Java 方法来测试数据是否存在。如果`isComponentDamagedForLocation)`为假，则插入数据。

* * *

**添加**
由于您在查询中使用字符串，因此您应该使用替换字符 ( `?`) 来防止您现在看到的错误并保护自己免受 SQL 注入攻击：

```
public boolean checkIfComponentAlreadySaved(long locationId, String component, String position) {
    Cursor mCursor = rmDb.query(DAMAGED_COMPONENTS_TABLE, new String[] {"1"}, 
            LOCATION_LINK + " = " + locationId + " AND " + COMPONENT + " = ? AND " + POSITION + " = ?", 
            new String[] {component, position}, null, null, null, null);
    // etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:49:23.277

我很困惑。您在 Cursor 中从数据库中检索数据，但您还从 Spinner 获取 Cursor ID？微调器数据的来源是什么？getSelectedItem 是 AdapterView 的一个方法，它假定 View 中的每个条目都绑定到支持数据中的一行。getSelectedItem 在当前选择的绑定视图的后备数据中返回一个“id”值。

退后一步，从逻辑上思考问题。数据库中有哪些数据？用户输入了什么数据？您如何记录用户选择的内容，并在数据库中的数据中查找该选择？不要试图做花哨的捷径，一步一步地去做。如果用户必须输入数据，您将如何搜索数据库？

# java - 这是对 Java 中构建器模式的有效使用（甚至是良好的 OO 设计）吗？

> ID：13463517
> 
> 赞同：2
> 
> 时间：2012-11-19T22:32:18.593
> 
> 标签：java, design-patterns

作为 OO 的新手，我经常觉得我理解了一个概念，直到我尝试从一个简化的示例转移到给我的实际需求。对于理解如何思考这个特定问题的任何帮助，我将不胜感激。

我有一个 GUI，它有一个面板，它定义了一个容器和其中的项目。目前，有三种类型的容器。容器具有一些属性（如大小），可以包含一到三种不同类型的项目（两种是可选的）。一旦输入了足够的信息，我就会使用这些信息来制作图表。

我实现了一个观察者模式。当用户输入信息时，它会更新一个 observable，它会通知图形它已更改。

到目前为止我很高兴。现在皱纹。我的容器有一个大小，但有时它是明确输入的，有时它是由容器所容纳的东西决定的。这取决于容器的类型。如果没有明确输入，如何确定大小取决于可选项目之一是否在容器中。我不确定需求编写者只是讨厌我还是我缺乏足够的 OO 经验，但是这些皱纹让我很不舒服。现在，我的 observable 只有变量来保存所有分类信息，我使用一堆 switch 语句来处理特殊情况。

我在想我可以使用构建器模式。导演将产生被绘制的数据。我将为每种类型的容器都有一个具体的构建器，并且我将使用容器属性和其中的项目来实例化该类。我将使用抽象构建器类的方法将图形所需的值返回给主管，例如 getContainerSize() 并将它们组合起来以生成实际的数据点。此外，如果用户还没有输入足够的数据来完成图表，director 可能会返回 null。

我是否正在接近可用的 OO 设计？我不确定我是否只是将特殊外壳埋得更深一些。

另一种皱纹。其中一种物品类型放在所有三个容器中。现在，我的 observable 分别跟踪容器和项目，创建图表的方法决定了要求的内容（随着用户使用这些值，图表会发生很大变化）。如果我有多个构建器模式，那将如何工作？

也许我错过了一步？observable 更新当前容器的构建器，然后让图知道它应该调用 director 来获取它的坐标？那么哪个还需要询问当前容器是什么？

欢迎所有评论帮助我了解 OO 设计，尤其是这个问题。实际需求有更多的特殊情况，但都是在这个基本主题上的变化。

感谢您的回复。我认为我将两个问题混为一谈而感到内疚。这里尝试提供一个专注于 Builder 模式的最小代码示例。注意 IE8 我看不到任何身份，FireFox 8，我很抱歉任何阅读 IE8 代码的人。

```
interface MyContainerBuilder
{
     void   setContents( MyContents contents );

     Double myVolume();
     Double myDensity();   
}

class SmallContainerBuilder implements MyContainerBuilder
{
    Double     volume   = null;
    Double     density  = null;
    MyContents contents = null;

    public void   setVolume()
    {
        if (contents != null)
        {
            volume = contents.myDensity() / 3.0;
        }
    }

    public void   setContents( MyContents contents )
    {
        this.contents = contents;
    }

    public Double myVolume()
    {
        if (volume == null)
            setVolume();
        return volume;
    }

    public Double myDensity()   
    {
        return contents.myDensity();
    }
}

class BigContainerBuilder implements MyContainerBuilder
{
    Double     volume   = null;
    Double     density  = null;
    MyContents contents = null;

    public void   setVolume( Double volume )
    {
        this.volume = volume;
    }

    public void   setContents( MyContents contents )
    {
        this.contents = contents;
    }

    public Double myVolume()
    {
        return volume;
    }

    public Double myDensity()   
    {
        return contents.myDensity();
    }
}

class ContainerDirector
{
    Double myResult( MyContainerBuilder container )
    {
        return container.myVolume() * container.myDensity();
    }
}

class MyContents
{
    Double density;

    MyContents( Double density )
    {
        this.density = density;
    }

    public Double myDensity()
    {
        return density;
    }
}

class Test
{
    public static void main(String[] args)
    {
        SmallContainerBuilder smallContainer = new SmallContainerBuilder();
        BigContainerBuilder   bigContainer   = new BigContainerBuilder();
        ContainerDirector     director       = new ContainerDirector();
//
// Assume this comes from the GUI, where an ActionListener knows which Builder
// to use based on the user's action. I'd be having my observable store this.
       Double        density       = 15.0;
       MyContents    contents      = new MyContents( density );
       smallContainer.setContents( contents );
//
// Then I would need to tell my observer to do this.
        Double       results       = director.myResult( smallContainer );
        System.out.println( "Use this result: " + results );
    }
} 
```

我有两种类型的容器，它们使用不同的方法来计算体积。因此，假设我有单选按钮来选择容器类型，并且在每个单选按钮下都有一个可以进入所选容器的项目组合框。组合框上的 ActionListener 会将项目放在正确的容器中并将其保存到我的 observable 中（实际上还有很多其他的东西被设置），它告诉我的观察者使用 director 来获取适当的值，然后观察者更新GUI的一些视图组件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T01:21:00.450

> 我的容器有一个大小，但有时它是明确输入的，有时它是由容器所容纳的东西决定的。那是*由容器的类型决定的*。[...] 如果没有明确输入，则取决于其中一项可选项目是否在容器中。

听起来您可以拥有抽象容器的不同子类，每个子类都`getContainerSize()`以不同的方式实现。一种用于明确输入，一种用于有可选项目的情况，另一种用于没有它的情况。

> ...我使用一堆 switch 语句来处理特殊情况。

听起来不太好。如果适用[，将条件替换为多态。](http://sourcemaking.com/refactoring/replace-conditional-with-polymorphism)

> 我在想我可以使用构建器模式......

我假设您需要`null`根据一组输入变量来确定对象（或）的具体类型。该模式提供了一种构建复杂对象的方法，如果它知道这是什么类型，但实际的问题是决定哪种类型。所以你在某个地方需要条件代码。那个地方可以是建造者，但也可以是简单的工厂。

> 现在，我的 observable 分别跟踪容器和项目 [...] observable 更新当前容器的构建器 [...] 如果我有多个构建器模式，那将如何工作？

并不真正了解 Observable 正在观察什么以及在哪种情况下会触发什么变化，但是 Observable 更新一个构建器（或多个）听起来很奇怪。不过，这更像是一种直觉:)

> 我是否正在接近可用的 OO 设计？

如果它有效，是的。但实际上我无法告诉您您是否创建了一个好的或可用的设计，因为我仍然不知道您的问题或您的设计的细节 - 在阅读了您的文本几次之后。

现在不要在您的问题中添加另一页信息，而是尝试将您的问题分解成更小的部分，并使用代码片段/图像/图表或任何类型的可视化来帮助人们理解您的问题以及这些部分之间的所有联系。只是大量的文本是相当可怕的，像这样的巨大的 OO 设计对于 SO 来说整体来说太大而且太本地化。

* * *

您的方法看起来不错，但它需要 IMO 相当复杂的对象来证明这种使用的合理性。

您通过观察者在您的 GUI 中创建一个 MyContents 实例。然后将该对象包装在 MyContainerBuilder 中，然后将其提供给 ContainerDirector ，然后生成结果。如果 MyContents 或结果很简单，我认为这一步太过分了。

此外，将 MyContents 设置为 MyContainerBuilder 的方式意味着您不能盲目地重用相同的具体 MyContainerBuilder 实例。您要么必须确保按顺序使用它，要么每次都必须构建一个新的。

即这不起作用

```
MyContents content1 = new MyContents( 5 );
MyContents content2 = new MyContents( 6 );
smallContainer.setContents( content1 );
smallContainer.setContents( content2 ); // overwriting old state
Double results1 = director.myResult( smallContainer ); // wrong result
Double results2 = director.myResult( smallContainer ); 
```

我假设 MyContents 是一个通用的数据保存对象，用户在几个步骤中填充了数据。一旦用户对它感到满意，它就会被提交以构建结果。据我所知，那时你知道结果是什么。

下面是一种使用策略模式的方法（？ - 我对所有这些名称和微小的差异都不满意），我选择直接插入 MyContents，因此 MyContents 对象一旦完成，就会包含如何将其转换为结果的所有细节. 这样可以确保一步，您不需要创建/维护额外的构建器对象。MyContents 现在在某种程度上已经是 Builder。

```
interface VolumeStrategy {
     Double calculateVolume(Double density);
}
class SmallVolumeStrategy implements VolumeStrategy {
    public Double calculateVolume(Double density) {
        return density / 3.0;
    }
}
class BigVolumeStrategy implements VolumeStrategy {
    public Double calculateVolume(Double density) {
        return density;
    }
}

class ContainerDirector {
    Double myResult( MyContents container ) {
        Double density = container.myDensity();
        VolumeStrategy strategy = container.myStrategy();
        return density * strategy.calculateVolume(density);
    }
}

class MyContents {
    // built via observer
    Double density;
    MyContents( Double density ) {
        this.density = density;
    }
    public Double myDensity() {
        return density;
    }

    // plugged in at the end.
    VolumeStrategy strategy;
    public void setStrategy(VolumeStrategy strategy) {
        this.strategy = strategy;
    }
    public VolumeStrategy myStrategy() {
        return strategy;
    }
}

public class Test {
    public static void main(String[] args) {
        // all those can be static 
        VolumeStrategy       smallStrategy  = new SmallVolumeStrategy();
        VolumeStrategy       bigStratetgy   = new BigVolumeStrategy();
        ContainerDirector    director       = new ContainerDirector();

       // from the GUI
       Double        density       = 15.0;
       MyContents    contents      = new MyContents( density );
       // building this contents ...
       // ... time to submit, we know what strategy to use
       contents.setStrategy(smallStrategy);

       // can turn contents into result without needing to know anything about it.
        Double       results       = director.myResult( contents );
        System.out.println( "Use this result: " + results );
    }
} 
```

这是我认为应该很好地解决我想象中的问题的一种方式。我可能错了。

# java - JAVA TCP 客户端/服务器模型：服务器是否有可能暂时成为客户端，然后又恢复为服务器？

> ID：13463523
> 
> 赞同：0
> 
> 时间：2012-11-19T22:32:47.923
> 
> 标签：java, client-server

我有两个客户A，B

我也有服务器 S

A 向服务器 S 发送请求，由于该请求，服务器 S 想要通知客户端 B 客户端 A 提出了请求。

如果 B 向服务器 S 发送请求，也会发生同样的情况，但这次服务器 S 将通知 A

客户端服务器模型可以做到这一点吗？我设法创建了一个简单的程序，其中客户端 A 向服务器 S 发送请求并显示服务器的响应。在这个程序中，服务器 S 监听无休止的连接，这意味着我有这样的事情：

```
while(true){
   Socket userSocket = serverSocket.accept();
   new Connection(clientSocket);
   //where in the Connection class we manage the connection events
} 
```

但我不明白如何使服务器“S”成为“连接”类中的客户端到未发送请求的客户端。如果我对任何客户端（A 或 B）执行相同的过程，我会得到一个打印一些 IP 地址的异常，但我不确定是哪些，因为我在本地运行所有内容。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:45:41.013

实际上，您可以按照您说的做，即让 S 通知 B A 已提出请求，反之亦然。从概念上讲，尽管这并不意味着 S 现在是 B 的客户端。S 仍然是服务器，它只是碰巧自己向 B 发送消息，而不是对来自 B 的输入做出反应。

想想 S 代表一个聊天服务器。如果 A 向 S 发送消息并且 S 将其转发给 B，那么 S 现在是 B 的客户端还是仍然是服务器？

# android - SurfaceView 显示空白屏幕

> ID：13463525
> 
> 赞同：1
> 
> 时间：2012-11-19T22:33:01.733
> 
> 标签：android, surfaceview

我正在尝试在屏幕上绘制一个椭圆形，但我得到的只是一张空白的白色画布。我不仅不确定我是否正确地绘制了椭圆，而且在屏幕上什么也没有。有谁知道为什么会这样，我认为问题在于它没有进入线程的绘图部分......

```
package hidden;

import android.app.Activity;
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.PixelFormat;
import android.graphics.PorterDuff;
import android.graphics.RectF;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.shapes.OvalShape;
import android.os.Bundle;
import android.util.Log;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.view.View.OnTouchListener;

public class Surface extends Activity implements OnTouchListener
{
    SurfaceView v;

    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.activity_main);
        setRequestedOrientation(1);

        v = new SView(this);
        v.setOnTouchListener(this);
        v.setZOrderOnTop(true);
        setContentView(v);
    }
    public class SView extends SurfaceView implements Runnable
    {
        Thread t1 = null;
        SurfaceHolder holder;
        boolean isItOk = false;

        public SView(Context context) 
        {
            super(context);

            holder = getHolder();
            holder.setFormat(PixelFormat.TRANSPARENT);
        }
        public void run() 
        {
            while(isItOk)
            {
                if(!holder.getSurface().isValid())
                {
                    continue;
                }
                Canvas c = holder.lockCanvas();
                Paint p = new Paint();
                p.setColor(Color.BLUE);

                //OvalShape oval = new OvalShape();
                //oval.draw(c, p);

                Paint paint = new Paint();
                paint.setColor(Color.GREEN);
                paint.setStyle(Paint.Style.STROKE);
                float leftx = 20;
                float topy = 20;
                float rightx = 50;
                float bottomy = 100;
                RectF ovalBounds = new RectF(leftx, topy, rightx, bottomy);
                c.drawOval(ovalBounds, paint);

                holder.unlockCanvasAndPost(c);
            }
        }
        public void pause()
        {
            isItOk = false;
            while(true)
            {
                try
                {
                    t1.join();
                }
                catch(InterruptedException e)
                {
                    e.printStackTrace();
                }
                break;
            }
            t1 = null;
        }
        public void resume()
        {
            isItOk = true;
            t1 = new Thread(this);
            t1.start();
        }
    }
    public boolean onTouch(View arg0, MotionEvent arg1)
    {
        return false;
    }
} 
```

# batch-file - 在 .wav 文件中运行批处理文件

> ID：13463526
> 
> 赞同：0
> 
> 时间：2012-11-19T22:33:09.647
> 
> 标签：batch-file, wav

是否可以在 .wav 中运行批处理文件？我的计费软件不会为某些应用重新启动我的电脑，该计费软件会在重新启动/关闭计算机之前在 .wav 文件上播放声音。所以我认为如果我可以在那个 .wav 文件上放置或运行批处理文件，我可以强制重启/关闭应该没问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:35:13.457

不，.wav 文件不能运行批处理文件或任何其他程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-13T17:44:12.940

.WAV 文件是不包含代码的音频波形文件。.BAT 或 .CMD 文件在执行后无法运行，因为没有检测系统。您可以制作一个播放 .WAV 文件的批处理文件，但不能制作一个运行 .BAT 文件的 .WAV 文件。

# mongodb - 无法生成 querydsl Q 类

> ID：13463527
> 
> 赞同：2
> 
> 时间：2012-11-19T22:33:12.457
> 
> 标签：mongodb, maven-plugin, spring-data, querydsl, spring-data-mongodb

我相信这个问题已经在这里问了一段时间，但没有任何被接受的回应。我实际上尝试了各种教程，但没有得到它们。我有一个`multi modules` `maven`项目。所以我有`dependency-management`并且`plugin-management`在父项目中。poms 如下所示：

```
<!--parent ${querydsl.version} = 2.3.2-->
 <build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.0.2</version>
                <configuration>
                    <source>1.7</source>
                    <target>1.7</target>
                    <encoding>${project.build.sourceEncoding}</encoding>
                    <!--                        <fork>true</fork>
                    -->                        
                    <meminitial>128m</meminitial>
                    <maxmem>512m</maxmem>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-resources-plugin</artifactId>
                <version>2.4.3</version>
                <configuration>
                    <encoding>${project.build.sourceEncoding}</encoding>
                </configuration>
            </plugin>

            <plugin>
            <groupId>com.mysema.maven</groupId>
            <artifactId>maven-apt-plugin</artifactId>
            <version>1.0</version>
            </plugin>
        </plugins>
    </pluginManagement>
</build>
<dependencyManagment>
    <dependencies>
     <!-- Querydsl -->
        <dependency>
            <groupId>com.mysema.querydsl</groupId>
            <artifactId>querydsl-core</artifactId>
            <version>${querydsl.version}</version>
        </dependency>

        <dependency>
            <groupId>com.mysema.querydsl</groupId>
            <artifactId>querydsl-apt</artifactId>
            <version>${querydsl.version}</version>
        </dependency>

        <dependency>
            <groupId>com.mysema.querydsl</groupId>
            <artifactId>querydsl-jpa</artifactId>
            <version>${querydsl.version}</version>
        </dependency>

        <dependency>
            <groupId>com.mysema.querydsl</groupId>
            <artifactId>querydsl-mongodb</artifactId>
            <version>${querydsl.version}</version>
        </dependency>
        <!-- End Querydsl -->
    </dependencies>
</dependencyManagment> 
```

我在 db mobule 中有 jpa 和 mongo，它们都在单独的包中。但我只希望`query dsl`用于 mongodb。db 模块 pom 如下所示：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <source>1.7</source>
                <target>1.7</target>
            </configuration>
        </plugin>

                <plugin>
                    <groupId>com.mysema.maven</groupId>
                    <artifactId>maven-apt-plugin</artifactId>
                    <version>1.0.2</version>
                    <executions>
                        <execution>
                            <phase>generate-sources</phase>
                            <goals>
                                <goal>process</goal>
                            </goals>
                            <configuration>
                                <outputDirectory>${generatedSources}</outputDirectory>
                                 <processor>com.mysema.query.mongodb.morphia.MorphiaAnnotationProcessor</processor>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>

    </plugins>
</build>
<dependencies>
    <!-- Querydsl -->
       <dependency>
            <groupId>com.mysema.querydsl</groupId>
            <artifactId>querydsl-core</artifactId>
        </dependency>

        <dependency>
            <groupId>com.mysema.querydsl</groupId>
            <artifactId>querydsl-apt</artifactId>
        </dependency>

    <dependency>
        <groupId>com.mysema.querydsl</groupId>
        <artifactId>querydsl-mongodb</artifactId>
    </dependency>
    <!-- End Querydsl -->
</dependencies> 
```

我在 mongo 实体上使用`spring data framework 3.1`它的`@Document`注释。我也使用`MongoRepository`所以我想知道在生成类之前我是否应该这样做。

谢谢阅读

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T22:38:49.317

`com.mysema.query.mongodb.morphia.MorphiaAnnotationProcessor`旨在与[Morphia](http://code.google.com/p/morphia/)注释类一起使用。对于`@Document`带注释的类，请使用`org.springframework.data.mongodb.repository.support.MongoAnnotationProcessor`.

# c# - 使用虚拟路径提供程序和 Amazon S3 开发工具包上传文件

> ID：13463528
> 
> 赞同：5
> 
> 时间：2012-11-19T22:33:13.500
> 
> 标签：c#, amazon-s3

这个问题的背景是基于我正在开发的虚拟文件系统。我使用的概念是不同类型存储类型的虚拟路径提供程序，即本地文件系统、保管箱和亚马逊 s3。我的虚拟文件基类如下所示：

```
public abstract class CommonVirtualFile : VirtualFile {
    public virtual string Url {
        get { throw new NotImplementedException(); }
    }
    public virtual string LocalPath {
        get { throw new NotImplementedException(); }
    }
    public override Stream Open() {
        throw new NotImplementedException();
    }
    public virtual Stream Open(FileMode fileMode) {
        throw new NotImplementedException();
    }
    protected CommonVirtualFile(string virtualPath) : base(virtualPath) { }
} 
```

第二个 Open 方法的实现是我的问题所在。如果我们查看我的本地文件系统实现，即在磁盘上保存文件，它看起来像这样：

```
public override Stream Open(FileMode fileMode) {
    return new FileStream("The_Path_To_The_File_On_Disk"), fileMode);
} 
```

如果我想在本地文件系统上保存一个文件，它看起来像这样：

```
 const string virtualPath = "/assets/newFile.txt";
    var file = HostingEnvironment.VirtualPathProvider.GetFile(virtualPath) as CommonVirtualFile;
    if (file == null) {
        var virtualDir = VirtualPathUtility.GetDirectory(virtualPath);
        var directory = HostingEnvironment.VirtualPathProvider.GetDirectory(virtualDir) as CommonVirtualDirectory;
        file = directory.CreateFile(VirtualPathUtility.GetFileName(virtualPath));
    }
    byte[] fileContent;
    using (var fileStream = new FileStream(@"c:\temp\fileToCopy.txt", FileMode.Open, FileAccess.Read)) {
        fileContent = new byte[fileStream.Length];
        fileStream.Read(fileContent, 0, fileContent.Length);
    }
    // write the content to the local file system
    using (Stream stream = file.Open(FileMode.Create)) {
        stream.Write(fileContent, 0, fileContent.Length);
    } 
```

我想要的是，如果我切换到我的 amazon s3 虚拟路径提供程序，我希望这段代码可以直接工作而不做任何更改，所以总结一下，我如何使用 amazon s3 sdk 解决这个问题以及我应该如何实现我的 Open(FileMode我的亚马逊 s3 虚拟路径提供程序中的 fileMode) 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T09:53:05.347

嘿，我也支持这个问题，我通过实现流解决了它。

这是我的做法，也许它有帮助：

```
public static Stream OpenStream(S3TransferUtility transferUtility, string key)
    {                     
        byte[] buffer  = new byte[Buffersize + Buffersize/2];

        S3CopyMemoryStream s3CopyStream =
            new S3CopyMemoryStream(key, buffer, transferUtility)
            .WithS3CopyFileStreamEvent(CreateMultiPartS3Blob);

        return s3CopyStream;
    } 
```

我的带有构造函数的 Stream 覆盖了 close 和 write(array, offset, count) 方法，并将流部分上传到 amazon s3。

```
public class S3CopyMemoryStream : MemoryStream
    {

        public S3CopyMemoryStream WithS3CopyFileStreamEvent(StartUploadS3CopyFileStreamEvent doing)
        {
            S3CopyMemoryStream s3CopyStream = new S3CopyMemoryStream(this._key, this._buffer, this._transferUtility);

            s3CopyStream.StartUploadS3FileStreamEvent = new S3CopyMemoryStream.StartUploadS3CopyFileStreamEvent(CreateMultiPartS3Blob);

            return s3CopyStream;
        }

        public S3CopyMemoryStream(string key, byte[] buffer, S3TransferUtility transferUtility)
            : base(buffer)
        {
            if (buffer.LongLength > int.MaxValue)
                throw new ArgumentException("The length of the buffer may not be longer than int.MaxValue", "buffer");

            InitiatingPart = true;
            EndOfPart = false;
            WriteCount = 1;
            PartETagCollection = new List<PartETag>();

            _buffer = buffer;
            _key = key;
            _transferUtility = transferUtility;
        } 
```

事件 StartUploadS3FileStreamEvent 调用启动、上传部分和完成上传的调用。

或者，您可以实现一个更容易的 FileStream，因为您可以使用

```
TransferUtilityUploadRequest request =
            new TransferUtilityUploadRequest()
            .WithAutoCloseStream(false).WithBucketName(
                transferUtility.BucketName)
                .WithKey(key)
                .WithPartSize(stream.PartSize)
                .WithInputStream(stream) as TransferUtilityUploadRequest;

        transferUtility.Upload(request); 
```

在被覆盖的 FileStream 的 close 方法中。缺点是你必须先将整个数据写入磁盘，然后才能上传。

# python - 从python 3中的pygame表面加载tkinter中的图像

> ID：13463529
> 
> 赞同：4
> 
> 时间：2012-11-19T22:33:14.647
> 
> 标签：python, image, tkinter, pygame, geometry-surface

我想从 pygame 表面加载 tkinter 中的图像，但我遇到了问题。

这是我目前正在尝试的：

```
image= pygame.image.tostring(surf, 'RGB')
tkimage= tkinter.PhotoImage(data= image)
canvas.create_image(0, 0, tkimage) 
```

但不幸的是，我收到了这个错误：

```
_tkinter.TclError: couldn't recognize image data 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T11:26:59.463

该类[`PhotoImage`只能](http://effbot.org/tkinterbook/photoimage.htm)直接从文件或编码字符串中读取`GIF`和`PGM`/文件。`PPM``base64`

* * *

您应该使用[Python Imaging Library](http://www.pythonware.com/products/pil/)为 Tk 加载和创建图像。

这是一个例子：

```
import pygame
from PIL import Image
import ImageTk
import Tkinter

# load image in pygame
pygame.init()
surf = pygame.image.load('bridge.png')

# export as string / import to PIL
image_str = pygame.image.tostring(surf, 'RGB')         # use 'RGB' to export
w, h      = surf.get_rect()[2:]
image     = Image.fromstring('RGB', (w, h), image_str) # use 'RGB' to import

# create Tk window/widgets
root         = Tkinter.Tk()
tkimage      = ImageTk.PhotoImage(image) # use ImageTk.PhotoImage class instead
canvas       = Tkinter.Canvas(root)

canvas.create_image(0, 0, image=tkimage)
canvas.pack()
root.mainloop() 
```

![在此处输入图像描述](../Images/c7a66a149886022c6c3e0ccae066239c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-30T11:09:21.863

- - - - 更新 - - -

```
import pygame
from pygame.locals import *
from PIL import Image
import ImageTk
import Tkinter

# load image in pygame
pygame.init()
surf = pygame.image.load('pic_temp.png')         # you can use any Surface a Camers is also an Surface
mode = "RGB"
# export as string / import to PIL
image_str = pygame.image.tostring(surf, mode)         # use 'RGB' to export
size      = (640, 480)
#image    = Image.fromstring(mode, size, image_str) 
# use frombuffer() - fromstring() is no longer supported
image     = Image.frombuffer(mode, size, image_str, 'raw', mode, 0, 1) # use 'RGB' to import

# create Tk window/widgets
root      = Tkinter.Tk()
tkimage   = ImageTk.PhotoImage(image) # use ImageTk.PhotoImage class instead
label     = Tkinter.Label(root, image=tkimage)
label.pack()
root.mainloop() 
```

# objective-c - 使 UITabBarController 成为根视图控制器

> ID：13463531
> 
> 赞同：1
> 
> 时间：2012-11-19T22:33:19.520
> 
> 标签：objective-c, xcode

我做了一个空的应用程序，然后我`UITabBarController`在情节提要中添加了一个。然后我将其作为初始值进行检查，`viewcontroller`并连接两个`NavigationControllers`以表示选项卡。但是，如果我现在运行该应用程序，它会显示“应用程序窗口`viewcontroller`在应用程序启动结束时应该有一个根”。并显示白屏。

我的`AppDelegate`样子是这样的：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
self.window.backgroundColor = [UIColor whiteColor];
[self.window makeKeyAndVisible];
return YES;
} 
```

我必须添加`TabBarController`作为主窗口，但如何做到这一点？如果`TabBarController`是以编程方式制作的，我会想到它，但是当它在情节提要中创建时如何？我可以为它做一个财产`AppDelegate`吗？在这种情况下如何将它挂在故事板中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:38:54.737

您可以在目标设置中挂钩故事板![故事板](../Images/4b01423ebd7fb987f39351db1c23e34c.png)然后确保故事板内的 UITabBarController 是初始 UIViewController ![初始视图控制器](../Images/9999aabf6a1499be5c8c3e82d0bd4715.png)。您也可以使用以下代码：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
UIViewController *initialViewController = (UIViewController *)[storyboard instantiateViewControllerWithIdentifier:@"IdentifierOfYourViewController"];
self.window.rootViewController = initialViewController; 
```

# javascript - 从 chrome.history.search() 回调中返回一个字符串

> ID：13463532
> 
> 赞同：0
> 
> 时间：2012-11-19T22:33:19.480
> 
> 标签：javascript, google-chrome-extension

我正在尝试从 chrome.history.search [http://developer.chrome.com/extensions/history.html#method-search中的回调返回最后一个 URL](http://developer.chrome.com/extensions/history.html#method-search)

到目前为止，我的方法如下所示：

```
var getLastUrl = function() {
    chrome.history.search({
        text: '',
        maxResults: 1
    }, function(results) {
        console.log(results);
        console.log(results[0].url);
        return 'Return value: ' + results[0].url;
    });
}; 
```

这是运行 getLastUrl() 时后台页面控制台的输出 ![输出](../Images/398bf6511a43852aaf5c1afb5b02d782.png)

如您所见，有一个返回对象，并且 console.log(results[0].url) 正在工作，但回调返回一个未定义的值。我怎样才能解决这个问题，以便它返回正确的 url？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:24:04.343

自己弄清楚了如何做，这是因为 chrome 扩展 api 的异步特性，这帮助了我[How to make a function wait until a callback has been called using node.js](https://stackoverflow.com/questions/5010288/how-to-make-a-function-wait-until-a-callback-has-been-called-using-node-js)。

基本上我是不确定的，因为函数在没有等待回调的情况下完成（因为它是异步的）。

所以而不是做

```
var getLastUrl = function() {
chrome.history.search({
    text: '',
    maxResults: 1
}, function(results) {
    console.log(results);
    console.log(results[0].url);
    return 'Return value: ' + results[0].url;
});
};

var lastUrl = getLastUrl(); 
```

我将函数编辑为如下所示：

```
var getLastUrl = function(callback) {
chrome.history.search({
    text: '',
    maxResults: 1
}, function(results) {
    console.log(results);
    console.log(results[0].url);
    callback(results[0].url);
});
}; 
```

然后您可以使用以下方式访问该网址：

```
getLastUrl(function(lastUrl) {
  // now you can use lastUrl here
}); 
```

希望这对遇到此问题的任何人有所帮助！

# php - Wordpress：限制类别中每页的帖子

> ID：13463534
> 
> 赞同：0
> 
> 时间：2012-11-19T22:33:20.480
> 
> 标签：php, wordpress, categories

在我的 index.php 中，我使用此代码来限制每页的帖子，并且它可以正常工作：

```
$showposts = 5;
$do_not_show_stickies = 1;
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
$args = array('category__in' => $cat, 'showposts' => $showposts, 'ignore_sticky_posts' => 1, 'paged' => $paged);

$loop2query = new WP_Query($args);

query_posts($args); if(have_posts()) : while (have_posts()) : the_post(); ?>

<div class="blogpost"> ... </div>

<?php endwhile; endif;
posts_nav_link(); // Navigating the pages with $showposts each. ?> 
```

相同的代码在 category.php 中不起作用，因此我将其更改为以下内容，但它仍然不起作用：

```
$showposts = 4;
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

if (have_posts()) { while (have_posts()) { the_post(); ?>
    <div class="blogpost"> ... </div>

<?php } }

else { ?>
    <p>There are no blog posts in this category.</p>
<?php } ?>

<?php posts_nav_link(); // Navigating the pages with $showposts each. ?> 
```

我尝试使用`if(have_posts()) : while (have_posts()) : the_post(); ?> [...]`category.php 更改该行以使其与 index.php 中的该行相似，但我没有尝试过任何工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T06:35:03.353

Wordpress 对此有一个设置，在**设置 -> 阅读 -> 博客页面下的管理区域中最多显示**

您可以使用它而不是自定义修改您的查询。它可能会使您的项目在以后的维护过程中变得更容易一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:36:22.793

使用`posts_per_page`参数（[此处为 Codex](http://codex.wordpress.org/Class_Reference/WP_Query)）

```
$args = array('category__in' => $cat, 'posts_per_page' => $showposts, 'ignore_sticky_posts' => 1, 'paged' => $paged); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:04:19.813

在您的第一个示例中，您实际上有两个查询 : `new WP_query`, then `query_posts`，因此您需要删除其中一个，因为这是多余的。在第二个示例中，恰恰相反，您没有任何查询（尽管 WordPress 可能会默认执行一个查询，具体取决于调用此页面的位置）。所以无论如何，在你的第二个例子中使用是没有意义的`$showposts`，因为你没有在之后执行查询...... `if (have_posts())`通常用于处理来自 WordPress 的默认（在你的页面代码中不可见）循环或处理你的查询在之前声明（通常用`query_posts()`）。正如@Samuel 所说，要使用的参数是`posts_per_page`，但我认为你还没有到那里，你应该首先开始学习如何执行查询，所以你可以从阅读 WordPress codex 开始`query_posts`，这将是最好的去处：[http](http://codex.wordpress.org/Function_Reference/query_posts) ://codex.wordpress.org/Function_Reference/query_posts 。

# c# - asp.net mvc4 更改 jquery 版本

> ID：13463545
> 
> 赞同：8
> 
> 时间：2012-11-19T22:34:10.760
> 
> 标签：c#, jquery, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我在使用 jquery 时遇到了一些跨浏览器问题，经过一些研究后，我发现我的应用程序正在使用 jquery 1.8.11，或者至少我认为是这样。

我的项目是一个带有 c# 的 MVC4 asp.net 应用程序。

实际上我正在尝试禁用-启用一些按钮，它在 IE 上运行良好，但在 chrome / firefox / safari 中却不行。

```
<ul class="ui-grid-d">
<li class="ui-block-a"><a id="MostrarDetallePedido" class="ui-btn ui-btn-up-a" disabled="disabled" href="/Documentos/Docs/DocsDetalle?StrIdDocumento=01500___00000000000000041" data-role="button" data-theme="a" data-ajax="false"><span aria-hidden="true" class="ui-btn-inner"><span class="ui-btn-text">Detalle</span></span></a></li>
<li class="ui-block-b"><a id="ItemCondiciones" class="ui-state-disabled ui-btn ui-btn-up-b" disabled="disabled" href="/Documentos/Docs/DocsDetalle?StrIdDocumento=01500___00000000000000041" data-role="button" data-theme="b" data-ajax="false"><span aria-hidden="true" class="ui-btn-inner"><span class="ui-btn-text">Condiciones</span></span></a></li>
<li class="ui-block-c"><a id="ItemEliminar" class="ui-state-disabled ui-btn ui-btn-up-c" disabled="disabled" href="/Documentos/Docs/DocsDetalle?StrIdDocumento=01500___00000000000000041" data-role="button" data-theme="c" data-ajax="false"><span aria-hidden="true" class="ui-btn-inner"><span class="ui-btn-text">Eliminar</span></span></a></li>
<li class="ui-block-d"><a id="ItemAdiciones" class="ui-state-disabled ui-btn ui-btn-up-d" disabled="disabled" href="/Documentos/Docs/DocsDetalle?StrIdDocumento=01500___00000000000000041" data-role="button" data-theme="d" data-ajax="false"><span aria-hidden="true" class="ui-btn-inner"><span class="ui-btn-text">Adiciones</span></span></a></li>
<li class="ui-block-e"><a id="ItemComponentes" class="ui-state-disabled ui-btn ui-btn-up-e" disabled="disabled" href="/Documentos/Docs/DocsDetalle?StrIdDocumento=01500___00000000000000041" data-role="button" data-theme="e" data-ajax="false"><span aria-hidden="true" class="ui-btn-inner"><span class="ui-btn-text">Componentes</span></span></a></li> 
</ul>​ 
```

我试过了

```
$('#ItemEliminar').addClass('ui-disabled');​ 
```

这种方式到

```
$('#ItemEliminar').button({ disabled: false }).button('enable').button('refresh'); 
```

[我在http://jsfiddle.net/9386M/1/](http://jsfiddle.net/9386M/1/)上用我们自己的脚本做了一些测试，它在 jquery 1.8.2 上运行良好。

好吧，我只需要知道如何更改我的 jquery 库，我正在查看 _Layout.cshtml 但我找不到对我的 jquery 库的任何引用。

在脚本文件夹我找到 jquery-ui-1.8.11.js jquery-ui-1.8.11.min.js jquery-1.6.4.js jquery-1.6.4.min.js

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-19T22:40:28.960

有两种方法可以做到这一点：

1.  右键单击您的解决方案，选择“管理 NuGet 包...”，在打开的对话框中转到“更新”并更新 jQuery。

2.  从那里转到`/App_Start/BundleConfig.cs`并更新 jQuery 参考。您还需要将适当版本的 jQuery 库放入该`/Scripts/`文件夹。

而且您始终可以在所有解决方案中搜索“jQuery”字符串（按`Ctrl`++并在“查找范围”组合框中选择“整个解决方案” `Shift`）`F`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T22:49:09.507

MVC4 使用捆绑。

转到 App_Start => 打开 BunlingConfig.cs

您将看到如下内容：

```
 // For more information on Bundling, visit http://go.microsoft.com/fwlink/?LinkId=254725
    public static void RegisterBundles(BundleCollection bundles)
    {
        bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                    "~/Scripts/jquery-{version}.js"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                    "~/Scripts/jquery-ui-{version}.js"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
                    "~/Scripts/jquery.unobtrusive*",
                    "~/Scripts/jquery.validate*"));

       // and bunch of other bundles

    } 
```

这里的第一行为 jQuery 创建了一个包。

您可以将其更改为以下内容：

```
 bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                    "~/Scripts/jquery-1.8.2.min.js")); 
```

如果要使用 CDN，请确保已下载库，如下所示：

```
 bundles.UseCdn = true;  

        const string jqueryCdnPath = "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js";

        bundles.Add(new ScriptBundle("~/bundles/jquery",
                                     jqueryCdnPath).Include("~/Scripts/jquery-{version}.js")); 
```

您还可以为您的文件创建捆绑包。您可以在此处阅读更多信息[http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4)

在布局文件中，它们的使用方式如下：

```
 @Scripts.Render("~/bundles/jquery") 
```

希望这可以帮助。

# iphone - 初始化后更改 NSMutableURLRequest 的 url

> ID：13463549
> 
> 赞同：0
> 
> 时间：2012-11-19T22:34:17.253
> 
> 标签：iphone, objective-c, ios, ipad, cocoa

我想看看是否有办法在初始化 NSMutableURLRequest 后更改请求 url？我查看了实例方法，但没有任何地方表明您可以更改 url。我试图发出“URL”的请求并相应地更改它，但它仍然指向旧的 url。

任何知道如何改变它的人都想知道它。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:59:02.360

NSMutableURLRequest 上有一个方法叫做`- (void)setURL:(NSURL *)theURL`

这是一个例子：

```
NSURL *url = [NSURL URLWithString:@"http://www.google.com"];
NSMutableURLRequest *req = [[NSMutableURLRequest alloc] initWithURL:url];
NSURL *anotherURL = [NSURL URLWithString:@"http://www.yahoo.com"];
[req setURL:anotherURL]; 
```

具体来说，方法文档位于： [https ://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSMutableURLRequest_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableURLRequest/设置网址](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSMutableURLRequest_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableURLRequest/setURL)：

# php - 向多个收件人发送邮件

> ID：13463551
> 
> 赞同：1
> 
> 时间：2012-11-19T22:34:23.200
> 
> 标签：php, sql, arrays, email

我已经研究过使用 mail() 发送给多个收件人，但我无法让它工作。我想要做的是，对于我拥有的每个订单，订单 1、2、3，每个都有自己的电子邮件地址，当我将他们的订单状态从待定更改为确认时，mail() 将使用该 ID 来引用db 表并发送这 3 个订单的电子邮件。但就我而言，它只邮寄了最新的订单，即订单 3。这是我用来更改订单状态的表格。

```
<form action="results-action" method="post" enctype="multipart/form-data">
<fieldset>

<table id ="table_id" class="display">

<thead>

<tr><td><h2>Pending Order</h2></td></tr>

<tr>
<th scope="col">Order ID</th>
<th scope="col"> </th>
<th scope="col">Name</th>
<th scope="col">Address</th>
<th scope="col">Product Name</th>
<th scope="col">Produt Quantity</th>
<th scope="col">Price</th>
<th scope="col">Order status</th>
</tr>
</thead>

<tbody>

<?php 
while ($row = mysqli_fetch_array($result)) {
?>

<tr>
<td><input type="text" value='<?=$row['virtuemart_order_id']?>' name="orderid" id="virtuemart_order_id"></td>
<td><input type="hidden" value='<?=$row['virtuemart_product_id']?>' name="productid" id="virtuemart_product_id"></td>
<td><?=$row['first_name']?></td>
<td><?=$row['address_1']?></td>
<td><?=$row['order_item_name']?></td>

<td><?=$row['product_quantity']?></td>

<td><?=$row['product_final_price'] ?></td>
<td><select name='change[<?=$row['virtuemart_order_id']?>]'>
<option value='C'> Confirmed</option>

<option value='X'> Cancelled</option></select></td>
</tr>

<?php
}
?>

</tbody>
</table>
</fieldset>

<fieldset>
<table>
<tr>
<td><input type="submit" value="Update status" name="update status"> </td>
</tr>
</table>
</fieldset>

</form> 
```

这是 php，使用表单中的订单 ID 来选择电子邮件地址。

```
<?php
$orderid = $_POST['orderid'];

// build SQL statement to select email addresses
$query3 = "SELECT email from ruj3d_virtuemart_order_userinfos where virtuemart_order_id = '$orderid'";

// execute SQL statement
$result3 = mysqli_query($link, $query3) or die(mysqli_error($link)); 

$subject = "Order confirmed by Home and decor";
$message = "Hello! This is a message to inform that your order has been confirmed";
$from = "107496@myrp.edu.sg";
$headers = "From: $from";

while($row3 = mysqli_fetch_array($result3)){ 

$addresses[] = $row3['email'];

}

$to = implode(",", $addresses);

mail($to, $subject, $message, $headers);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:41:00.167

您可以将 a 添加到您的标题中，这是创建[Headers](http://php.net/manual/en/function.mail.php)`Cc`的部分原因：

```
$headers = "From: $from" . "\r\n";
$headers .= "Cc: ".$secondEmail.', '.$thirdEmail . "\r\n" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:40:20.723

我认为您需要在逗号后添加一个空格，如下所示： `$to = implode(", ", $addresses);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:44:43.793

代替

```
Select
  email 
From 
  ruj3d_virtuemart_order_userinfos 
Where 
  virtuemart_order_id = '$orderid' 
```

做

```
Select
  email 
From 
  ruj3d_virtuemart_order_userinfos 
Where 
  virtuemart_order_id In ($orderid) 
```

（我可能PHP错了，我只是在进行sql语句。如果您提交多个时$orderid看起来不像逗号分隔列表，那么您需要将其设为一个）

实际上，不要只是这样做，还要学习 SQL 注入，并用 PDO 尤其是[PDO::Prepare替换已弃用的 mysqli 库](http://www.php.net/manual/en/pdo.prepare.php)

哦，如果这些是不同的客户，请不要在收件人字段中发送邮件，您的客户不会感谢您将他们的电子邮件地址发送给彼此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:54:35.220

您使用了错误的`$_POST`字段来选择您的电子邮件地址。

第一个 php 文件生成的表单包含一个表格，每行包含一个名为`'orderid'`. 但是你真正感兴趣的字段是`select`每一行的输入值。这些都存储在一个以数组命名`change`的`$_POST`数组中。

这是一个如何`$_POST`初始化以对应于表单返回的选择值的示例：

```
$_POST['change'] = array('id1' => 'C', 'id2' => 'X' /*, 'id3' => ... */ ); 
```

所以你需要：

*   获取表单中返回的数组`$_POST`，
*   过滤掉不等于'C'的条目，
*   保留这些条目的密钥，
*   逃离它们以对它们进行消毒，

您应该将 php 文件的开头替换为以下内容，如上文所述。

第一个版本不清理条目：

```
<?php

function confirmed($v) { return ($v == 'C'); }

// pick the rows in your form table which have been set as confirmed, and use the keys 
$orderid = implode(',', array_keys(array_filter($_POST['change'],'confirmed')));

// build SQL statement to select email addresses
$query3 = "SELECT email FROM ruj3d_virtuemart_order_userinfos WHERE virtuemart_order_id IN (".$orderid.")";

// etc. 
```

这个做消毒：

```
<?php

function confirmed($v) { return ($v == 'C'); }

// pick the rows in your form table which have been set as confirmed, and use the keys 
$orderid = implode(',', array_map('mysql_real_escape_string', 
                                  array_keys(array_filter($_POST['change'],'confirmed'))));

// build SQL statement to select email addresses
$query3 = "SELECT email FROM ruj3d_virtuemart_order_userinfos WHERE virtuemart_order_id IN (".$orderid.")";

// etc. 
```

有关将 BCC 与该功能一起使用的信息，请参阅此[SO 问题。](https://stackoverflow.com/questions/4117091/php-mail-function-sending-mails-to-bcc-only)`mail()`

# css - jqm listview的搜索过滤器迷你版

> ID：13463552
> 
> 赞同：1
> 
> 时间：2012-11-19T22:34:23.427
> 
> 标签：css, jquery-mobile

我正在使用启用了[搜索过滤器栏](http://jquerymobile.com/test/docs/lists/lists-search.html)的列表视图。

似乎 data-mini 属性 ( `data-mini = true`)[不是](http://jquerymobile.com/test/docs/api/data-attributes.html)开箱即用的。有什么方法可以在列表视图中使用迷你版的搜索框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T21:43:55.743

如果您在谈论搜索过滤器栏，那么您应该知道可以对其应用 data-mini = true。

这是一个例子：

```
<input type="search" id="searchField" data-inline="true" placeholder="Search" data-mini = true> 
```

还有一个关于 jsFiddle的[例子。](http://jsfiddle.net/Gajotres/nXHNg/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:44:23.360

`data-mini=true`您始终可以覆盖您的 CSS 并为列表视图发明“自己的” ，[请参阅文档](http://jquerymobile.com/demos/1.2.0/docs/api/themes.html)

> **压倒一切的主题**
> 
> 主题旨在作为一个坚实的起点，但旨在定制。由于一切都由 CSS 控制，因此可以很容易地使用 Web 检查器工具来识别您要修改的样式属性。添加到元素中的一组主题类（全局）和语义结构类（特定于小部件）提供了一组丰富的可能选择器，用于定位样式覆盖。我们建议将外部样式表添加到头部，放置在结构和主题样式表引用之后，其中包含所有样式覆盖。这使您可以轻松地更新到较新版本的库，因为覆盖与库代码分开。

# python - 在 Python 中将答案四舍五入到小数点后 2 位

> ID：13463556
> 
> 赞同：10
> 
> 时间：2012-11-19T22:34:39.400
> 
> 标签：python, currency, rounding

我遇到的问题是将结果四舍五入到小数点后 2 位。我的应用程序得到了正确的结果，但是，我很难像使用货币一样使应用程序四舍五入到最接近的小数

```
cost = input("\nEnter the 12 month cost of the Order: ")
cost = float(cost)

print("\n12 Month Cost:",
  cost * 1,"USD")
print("6 Month Cost:",
  cost * 0.60,"USD")
print("3 Month Cost:",
  cost * 0.36,"USD") 
```

例如，如果 12 个月的价格是 23 美元，那么 6 个月的价格是 13.799999999999999 但我希望它显示 13.80

我环顾了谷歌以及如何对数字进行舍入，但在舍入结果方面找不到太多帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-19T22:39:45.583

您应该使用格式说明符：

```
print("6 Month Cost: %.2fUSD" % (cost * .6)) 
```

更好的是，您根本不应该依赖浮点数，[`decimal`](http://docs.python.org/2/library/decimal.html)而是使用该模块，它可以为您提供任意精度和对舍入方法的更多控制：

```
from decimal import Decimal, ROUND_HALF_UP
def round_decimal(x):
  return x.quantize(Decimal(".01"), rounding=ROUND_HALF_UP)

cost = Decimal(input("Enter 12 month cost: "))
print("6 Month Cost: ", round_decimal(cost * Decimal(".6"))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T22:37:34.657

一个经典的方法是乘以 100，加上 0.5（这是四舍五入）和 int() 结果。现在您有了四舍五入的美分数，再次除以 100 以返回四舍五入的浮点数。

```
cost = 5.5566
cost *= 100 # cost = 555.66
cost += 0.5 # cost = 556.16
cost = int(cost) # cost = 556
cost /= float(100) # cost =  5.56

cost = 5.4444
cost = int(( cost * 100 ) + 0.5) / float(100) # cost = 5.44 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-10T21:12:43.770

如果您只想将其作为字符串，格式可以提供帮助：

```
format(cost, '.2f') 
```

此函数返回一个字符串，该字符串的格式与第二个参数中定义的一样。因此，如果成本包含 3.1418，则上面的代码将返回字符串“3.14”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T22:40:09.433

如果您只想打印，字符串格式将起作用：

```
print("\n12 Month Cost:%.2f USD"%(cost*1)) 
```

# html - 使表格单元格更宽的最佳方法

> ID：13463557
> 
> 赞同：0
> 
> 时间：2012-11-19T22:34:40.300
> 
> 标签：html, css

我试图弄清楚如何使最后一个字段（注释）更宽。目前，该字段将“我们美国人民”作为占位符。当注释字段中有更多文本时，我不希望每一行都垂直增长。

[http://jsfiddle.net/sdbEc/](http://jsfiddle.net/sdbEc/)

```
<tr>
<td><a href="http://acme.com/pkg_testme.edit_item?p_item_id=1126" align="Right">RS-11</a>           </td>
<td width="300">a description</td>
<td width="200">INSTRUMENT CO</td>
<td width="40">28</td>
<td width="40">2.85</td>
<td width="40">15-OCT-12</td>
<td width="40">Euro</td>
<td width="200">spring scissor</td>
<td width="40">9</td>
<td width="40">2</td>
<td width="40">9</td>
<td width="40">1</td>
<td width="40">2</td>
<td width="40">1</td>
<td width="40">5</td>
<td width="40">9</td>
<td><a href="http://acme.com/pkg_testme2.edit_item?p_item_id=" align="Right"></a></td>
<td><a href="http://acme.com/pkg_testme.edit_notes?  p_item_id=We%20the%20people%20of%20the%20United%20States">We the people of the United  States</a></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:37:24.523

首先，不要`width=`在 HTML 元素上使用该属性。CSS应该用于设计。

其次，让浏览器在给定总宽度限制的情况下决定如何分隔表格。他们通常做得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T01:13:26.683

这是我使用的解决方案

```
<TD><div style="overflow: auto; height: 60px; width: 200px;">We the people of the United</div></TD> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-27T03:23:56.287

您应该使用 css :nth-child() 选择器来更好地设置表格样式：

[http://www.w3schools.com/cssref/sel_nth-child.asp](http://www.w3schools.com/cssref/sel_nth-child.asp)

[https://css-tricks.com/almanac/selectors/n/nth-child/](https://css-tricks.com/almanac/selectors/n/nth-child/)

HTML 代码：

```
<tr class="tableformat">
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr> 
```

代码：

```
.tableformat td:nth-child(1){
    width: 300px;
}
.tableformat td:nth-child(2){
    width: 200px;
}
.tableformat td:nth-child(3){
    color: red;
} 
```

等等...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:38:50.367

用 ie 设置样式。`<td style="width: 40px;">..</td>`

如果你想要绝对控制.. 添加`<table style="table-layout:fixed">...</table>`. 这将完全阻止浏览器弄乱你的宽度。

Ofcourse 样式应该在单独的 css 文件中，什么不是，但是在其他地方学习）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-09T14:37:16.183

您可以尝试在 TD 中添加 colspan="2" 以使其更宽。

例子 ：

```
<td colspan="2" ></td> 
```

# java - 案例没有下降到正确的数字/程序没有正确读取时钟

> ID：13463568
> 
> 赞同：2
> 
> 时间：2012-11-19T22:35:13.657
> 
> 标签：java, switch-statement, case, clock

我正在编写有关开关/案例的教程，我相信我已将程序复制到角色，但它返回的月份不正确。有人发现我的错误吗？谢谢。

导入 java.util.*；类时钟谈话{

```
/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub
    //get current time and date
    Calendar now  = Calendar.getInstance();
    int hour = now.get(Calendar.HOUR_OF_DAY);
    int minute = now.get(Calendar.MINUTE);
    int month = now.get(Calendar.MONTH);
    int day = now.get(Calendar.DAY_OF_MONTH);
    int year = now.get(Calendar.YEAR);

    //display greeting
    if (hour < 12)
            System.out.println("Good moring.\n");
    else if (hour < 17)
            System.out.println("Good afternoon.\n");
    else
            System.out.println("Good evening.\n");

    //begin time message by showing the minutes
    System.out.print("It's");
    if (minute != 0) {
        System.out.print(" " + minute + " ");
        System.out.print( (minute != 1) ? "minutes" : "minute");
        System.out.print(" past");
    }

    //Display the hour
    System.out.print(" ");
    System.out.print( (hour > 12) ? (hour - 12) : hour );
    System.out.print(" o'clock on ");

    //display the name of the month
    switch (month) {
        case 1:
            System.out.print("January");
            break;
        case 2:
            System.out.print("Febuary");
            break;
        case 3:
            System.out.print("March");
            break;
        case 4:
            System.out.print("April");
            break;
        case 5:
            System.out.print("May");
            break;
        case 6:
            System.out.print("June");
            break;
        case 7:
            System.out.print("July");
            break;
        case 8:
            System.out.print("August");
            break;
        case 9:
            System.out.print("September");
            break;
        case 10:
            System.out.print("October");
            break;
        case 11:
            System.out.print("November");
            break;
        case 12:
            System.out.print("December");

    }

    //display the date and year
    System.out.println(" " + day + ", " + year + ".");

} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:36:36.123

`Calendar.MONTH`从零开始。这可能是原因。您需要添加`case 0:`

例子：

```
 case 0:
    System.out.print("January");
    break; 
```

根据日历[javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/Calendar.html#MONTH)

> 公历和儒略历中的第一个月是 JANUARY，即 0；最后一个取决于一年中的月数。

# c++ - 如何从向量中删除 shared_ptr

> ID：13463570
> 
> 赞同：4
> 
> 时间：2012-11-19T22:35:12.847
> 
> 标签：c++, vector, shared-ptr

像下面的代码一样，m_vSprites 是一个 shred_ptr 的向量，如果他的一个元素更新失败，我想从向量中删除它，但是当我想使用擦除时我的代码崩溃了。但我不知道为什么，有人可以帮忙吗？

我需要使用擦除的原因是因为我的应用程序会不断地在向量中添加元素，但如果某些元素满足它们的终止条件，也会不断地从向量中擦除对象。如果我不删除它，随着程序的运行，矢量会变得很大！

```
RECT rcOldSpritePos;
    typedef boost::shared_ptr<Sprite> SmartSprite;
vector<SmartSprite>::iterator siSprite;
for (siSprite = m_vSprites.begin(); siSprite != m_vSprites.end();)
{
    // Save the old sprite position in case we need to restore it
    rcOldSpritePos = (*siSprite)->getPosition();

    if (!((*siSprite)->update()))
    {
        // Kill the sprite
        //siPreviousSprite = siSprite-1;
        siSprite = m_vSprites.erase(siSprite);
    }
            else
            {
                  siSprite++;
                  // See if the sprite collided with any others
          if (checkSpriteCollision(*siSprite))
        // Restore the old sprite position
        (*siSprite)->setPosition(rcOldSpritePos.left, rcOldSpritePos.top);
            }

} 
```

我已经按照某人的建议更改了代码，但擦除功能仍然失败，请任何人有一些建议？

有关如何在 vecotr 中添加元素的更多信息

这里有什么问题吗？

```
 SmartSprite sprite;
if (0 < enemies.size())
{
    // Pick a random enemy to drop bomb
    size_t nRandEnemy = (rand() % enemies.size());
    RECT rRandEnemy = enemies.at(nRandEnemy)->getPosition();
    sprite.reset(new BombSprite(m_system, rRandEnemy.right-OBJECTSIZE/2,   
            rRandEnemy.bottom));
    m_vSprites.push_back(sprite);
} 
```

我的精灵类没有任何析构函数......

另一个信息是，当我调试时，发现它在擦除内部函数中崩溃：_Destroy(_Mylast - 1, _Mylast);

* * *

问题解决了！，原因是在我的 Sprite 类中，我将它包装为一个智能指针，并创建了另一个智能指针作为其成员变量。现在我没有使用智能指针成员变量，系统也没有再次崩溃......我会继续思考为什么我不能在那个类中使用智能指针，当从向量中擦除精灵时，确实他的成员变量有关系吗？如果只使用原始指针而不是使用智能指针，我还需要删除该成员变量吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T22:41:25.933

如果您要擦除的迭代器是向量的开始迭代器，那么这个；

```
siPreviousSprite = siSprite - 1; 
```

是未定义的行为。像这样重组你的循环：

```
for (siSprite = m_vSprites.begin(); siSprite != m_vSprites.end(); )
{

    rcOldSpritePos = (*siSprite)->getPosition();

    if (!((*siSprite)->update()))
    {
        // Kill the sprite
        siSprite = m_vSprites.erase(siSprite);            
    }
    else
    {
        ++siSprite;
    }
} 
```

如果仍然崩溃，那么您的精灵类一定有问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:50:37.773

我会尝试使用[**erase-remove** idiom](http://en.wikibooks.org/wiki/More_C++_Idioms/Erase-Remove)。

您可能希望`bool`从 sprite 类中公开一个属性，并检查它是否`true`要从向量中删除 sprite。像这样（用 VC10/VS2010 SP1 测试的代码）：

```
#include <algorithm>
#include <iostream>
#include <memory>
#include <ostream>
#include <vector>

using namespace std;

struct Sprite
{
    explicit Sprite(int spriteId)
     : kill(false)
     , id(spriteId)
    {
    }

    int id;
    bool kill;
};

int main()
{
    typedef shared_ptr<Sprite> SmartSprite;  
    typedef vector<SmartSprite> SpriteArray;

    SpriteArray sprites;
    for (int i = 0; i < 5; i++)
        sprites.push_back( make_shared<Sprite>(i*11) );

    for (auto it = sprites.begin(); it != sprites.end(); ++it)
        cout << (*it)->id << " ";
    cout << endl;

    sprites[2]->kill = true;
    sprites[3]->kill = true;

    // Remove sprites with kill flag set    
    sprites.erase
    (
        remove_if
        (
            sprites.begin(),
            sprites.end(),
            [](const SmartSprite& ps){ return ps->kill; }
        ),
        sprites.end()
    );

    for (auto it = sprites.begin(); it != sprites.end(); ++it)
        cout << (*it)->id << " ";
    cout << endl;
} 
```

输出：

```
0 11 22 33 44
0 11 44 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-19T22:40:53.270

如果`siSprite == m_vSprites.begin()`那`siSprite-1`是不合法的。编写这种循环的通常方法是

```
for (siSprite = m_vSprites.begin(); siSprite != m_vSprites.end(); )
{
    rcOldSpritePos = (*siSprite)->getPosition();
    if ((*siSprite)->update())
    {
         ++siSprite;
    }
    else
    {
        siSprite = m_vSprites.erase(siSprite);
    }
} 
```

不确定这是否真的可以解决您的问题，因为您的错误可能是完全不相关的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T23:00:30.443

擦除可能会导致新的分配，迭代器可能会在那里中断。最好这样做：

```
for(size_t i=0; i<v.size(); ++i)
  if(!v[i].update())
  {
    v.erase(v.begin()+i);
    --i; // since the elements shifted up.
  } 
```

否则你可能想**使用队列**，擦除操作在向量上是非常昂贵的。

编辑：

我已经用一个虚拟的 Sprite 类对其进行了测试并且工作正常，错误必须在 Sprite 类的析构函数内。

# sharepoint-2010 - 使用 powershell 部署 sharepoint 2010 计时器作业解决方案

> ID：13463577
> 
> 赞同：1
> 
> 时间：2012-11-19T22:35:46.563
> 
> 标签：sharepoint-2010

我们制作了一个包含自定义计时器作业的解决方案，该作业需要部署在具有 sharepoint 2010 但没有 Visual Studio 2010 的服务器上。

如何才能做到这一点 ？我没有找到任何关于这个问题的信息。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T09:11:49.973

首先要找出您执行的 Timer 作业的功能范围。您应该`WSP`使用`SharePoint Management Shell`.

去 ：

> 开始 > 所有程序 > Microsoft SharePoint 2010 产品 > SharePoint 2010 Management Shell

打开它并

### 添加解决方案：

> 添加-SPSolution c:\wspfilename.wsp

### 部署/安装解决方案：

> 安装-SPSolution –Identity wspfilename.wsp –WebApplication [http://contoso.com](http://contoso.com) -GACDeployment

之后您可以手动激活功能或使用 Management Shell 像[这里](http://blogs.captechconsulting.com/blog/mark-digiovanni/discovering-activating-and-deactivating-features-sharepoint-site-collection-usi)

啤酒花它有帮助！

# c# - 带有图像的 ASP 文件上传

> ID：13463581
> 
> 赞同：0
> 
> 时间：2012-11-19T22:36:10.247
> 
> 标签：c#, asp.net, file-upload

我可以`FileUpload`控制我的 ASP.NET 页面并`Image`控制在哪里显示上传到服务器的图像。我想要的是`Image`控件显示我在`FileUpload`上传到服务器之前单击控件中的浏览时选择的内容。这样，用户可以看到他们正在上传的内容。

我在 ASP.NET 4 中使用 C#

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:53:51.300

JavaScript 会涉及到这样的事情，请注意这一点。开箱即用的 ASP.NET 控件上没有设置来完成此操作。（主要是因为标准`input type="file"`不支持这一点。）

一个快速的谷歌搜索出现了[一个 jQuery 插件](http://blueimp.github.com/jQuery-File-Upload/)，它似乎非常有效地完成了这项工作。我在添加文件时检查了我的网络检查器窗口，果然，在显示预览之前它似乎没有发布到服务器。

在他们的[设置文档](https://github.com/blueimp/jQuery-File-Upload/wiki/Setup)中，您将需要标题为“使用带有自定义服务器端上传处理程序的 jQuery 文件上传（UI 版本）”的部分。 [他们的 wiki](https://github.com/blueimp/jQuery-File-Upload/wiki)还包含指向示例 ASP.NET 代码的链接。

# xamarin.ios - Monotouch 对话框 - 从另一个线程刷新数据？

> ID：13463591
> 
> 赞同：1
> 
> 时间：2012-11-19T22:36:50.797
> 
> 标签：xamarin.ios, monotouch.dialog

我有一个 UITabBarController，它有一个构造函数，我在其中为我的 MT 对话框控件动态创建项目。这很好用，因为我可以正确渲染 mt 表。

我有一个后台线程从 appdelegate 运行，每 60 秒检查一次新数据。

将新数据获取到 mt.dialog 并使其刷新的最佳方法是什么？

谢谢，杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:19:25.443

看看 InvokeOnMainThread。

[http://docs.xamarin.com/ios/Guides/Advanced_Topics/Threading#Developing_Responsive_Applications](http://docs.xamarin.com/ios/Guides/Advanced_Topics/Threading#Developing_Responsive_Applications)

# java - 使用 Eclipselink 和 Moxy 编写 List 归档

> ID：13463593
> 
> 赞同：3
> 
> 时间：2012-11-19T22:37:05.640
> 
> 标签：java, jpa, jaxb, eclipselink, moxy

我正在使用 Eclipselink JPA 并且有一组我想写入文件的数据库实体，以防我的数据库连接在后续查询中不可用。我想使用 Moxy 简单地编组我的整个结果集，然后在稍后解组该文件，从而重新创建我的原始结果集（这是我的 JPA 实体对象）。由于 Eclipselink 和 Moxy 有点集成，我想知道我的 JPA 代码中，例如：

```
public void getDataFROMDATABASE() {

factory = Persistence.createEntityManagerFactory(PERSISTENCE_UNIT_NAME,getProperties());
EntityManager em = factory.createEntityManager();
// Read the existing entries and write to console
TypedQuery<CtoPolicyMatrix> query = em.createQuery("SELECT pm FROM CtoPolicyMatrix pm", CtoPolicyMatrix.class);

List<CtoPolicyMatrix> results = query.getResultList();
**//NOW PRESIST RESULTS to file IN CASE OF DB CONNECTION FAILURE**
    presistMatrixData(results);     
 em.close();
}

public void presistMatrixData(List results){
// Save CtoPolicyMatrix to XML
try {
    jc = JAXBContext.newInstance(CtoPolicyMatrix.class);
    Marshaller marshaller = jc.createMarshaller();
    StringWriter writer = new StringWriter();
    marshaller.marshal(results, writer);
    **???? NOT SURE WHAT TO DO HERE TO WRITE MY COLLECTION TO FILE**
    } catch (JAXBException e) {
        e.printStackTrace();
    }
}

public void retrieveMatrixData(List results){
        // Load CtoPolicyMatrix from XML
**???? REALLY NOT SURE HOW TO RETRIEVE MY JPA ENTITY COLLECTION FROM FILE**
Unmarshaller unmarshaller;
    try {
        unmarshaller = jc.createUnmarshaller();
        StringReader reader = new StringReader(writer.toString());
        List<CtoPolicyMatrix> savedResults = (List<CtoPolicyMatrix>)     
            Unmarshaller.unmarshal(reader);
    } catch (JAXBException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:30:26.303

你在正确的轨道上。为了使事情尽可能简单，我建议创建一个包装器对象来包含您的结果列表，然后编组/解组该包装器对象。

包装器对象可能如下所示：

```
import java.util.List;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class MatrixData {

    private List<CtoPolicyMatrix> data;

    public List<CtoPolicyMatrix> getData() {
        return data;
    }

    public void setData(List<CtoPolicyMatrix> data) {
        this.data = data;
    }

} 
```

您的 persistMatrixData 方法如下所示：

```
public void persistMatrixData(List results) {
    // Save CtoPolicyMatrix to XML
    try {
        MatrixData data = new MatrixData();
        data.setData(results);

        File file = new File("D:/Temp/MatrixData.xml");

        jc = JAXBContext.newInstance(MatrixData.class);
        Marshaller marshaller = jc.createMarshaller();
        marshaller.marshal(data, file);
    } catch (JAXBException e) {
        e.printStackTrace();
    }
} 
```

并将它们读回：

```
public void retrieveMatrixData(List results) {
    // Load CtoPolicyMatrix from XML
    Unmarshaller unmarshaller;
    try {
        File file = new File("D:/Temp/MatrixData.xml");

        unmarshaller = jc.createUnmarshaller();
        MatrixData data = (MatrixData) u.unmarshal(file);

        List<CtoPolicyMatrix> savedResults = data.getData();
    } catch (JAXBException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

希望这可以帮助，

瑞克

# graphviz - Graphviz，将图放在子图中会改变节点的 x 坐标

> ID：13463598
> 
> 赞同：0
> 
> 时间：2012-11-19T22:37:20.907
> 
> 标签：graphviz

我正在尝试创建一个包含集群的图表。当我将集群创建为自己的图时，布局是有意义的，但是当它是集群的一部分时，两个节点会交换位置，从而增加总边长。

这是图表不在集群中时的代码。

```
digraph OrgChart {

edge[dir=none,color=black];
11->13;
12->13;
12->14;
13->15;
13->60;
13->61;
14->15;
{rank="same"; 11 12 14};
{rank="same"; 13 15};

} 
```

这会生成一个看起来像这样的图表

![测试2](../Images/de04925112d636a28ce84da144a43acc.png)

当我使用以下代码使其成为集群的一部分时

```
digraph OrgChart {

subgraph cluster{
edge[dir=none,color=black];
11->13;
12->13;
12->14;
13->15;
13->60;
13->61;
14->15;
{rank="same"; 11 12 14};
{rank="same"; 13 15};
}

} 
```

这使我的图表看起来像这样

![测试1](../Images/74daf7564eaf7874dc4c1a50e3876251.png)

我看不出 11 介于 12 和 14 之间的任何原因。

为什么会发生这种情况，有什么办法可以解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:56:39.283

一个不满意的答案是添加以下内容：

11->12 [风格=隐形]；

这应该使 11 12 14 个节点恢复到所需的顺序。

# linq - linq 查询（sql 到 linq）

> ID：13463601
> 
> 赞同：1
> 
> 时间：2012-11-19T22:37:32.497
> 
> 标签：linq, linq-to-sql

拥有三个表（Item、Purchase、PurchaseItem）我正在尝试编写一个 linq 查询来查找一个项目包含多少有效购买。

在标准 SQL 中，我会使用带有计数的子查询，但我似乎无法获得 linq 查询来执行此操作。

![在此处输入图像描述](../Images/138bf8e553b00e7d815a3217e20283ce.png)

SQL：

```
select i.name, 
InTrade = (select count(*) from Purchase p join PurchaseItem pi on p.id = pi.PurchaseId where p.Isvalid = 1 and pi.ItemId = i.Id)
from Item i 
```

林克：

```
from i in Items select new 
{
    i.Name,
    InTrade = from pi in PurchaseItems where pi.ItemId == i.ID
        select new 
            {
                pi,
                Purchase = from p in Purchases where p.ID == pi.PurchaseId
                select new { p }
            }
} 
```

在这里，我试图在一个查询中检索我的所有数据，我可能需要另一个查询才能真正得到我想要的。我可能用这种方法走上了一条麻烦的道路，所以也许有人可以阐明在 linq 中实现这一目标的“最佳实践”。

我为这个例子准备了一些测试数据：

```
if exists (select * from sysobjects where name = 'PurchaseItem') drop table PurchaseItem
if exists (select * from sysobjects where name = 'Item') drop table Item
if exists (select * from sysobjects where name = 'Purchase') drop table Purchase
go

create table Item
(
    ID int not null primary key,
    Name nvarchar(30) not null
)

create table Purchase
(
    ID int not null primary key,    
    Name nvarchar(30) not null,
    ConfirmedDate datetime,
    Isvalid bit not null
)

create table PurchaseItem
(
    ID int not null primary key,
    PurchaseId int null references Purchase(ID),
    ItemId int null references Item(ID)
)

insert Item values (1, 'Bread')
insert Item values (2, 'Beer')
insert Item values (3, 'Wine')
insert Item values (4, 'Milk')
insert Item values (5, 'Apple')
insert Item values (6, 'Steak')
insert Item values (7, 'Hamburger')
insert Item values (8, 'Vinegar')

insert Purchase values (1, 'Purchase 1', null, 1)
insert Purchase values (2, 'Purchase 2', null, 0)
insert Purchase values (3, 'Purchase 3', '2008-1-7', 1)

insert PurchaseItem values (1, 1, 1)
insert PurchaseItem values (2, 1, 2)
insert PurchaseItem values (3, 1, 3)
insert PurchaseItem values (4, 1, 4)
insert PurchaseItem values (5, 1, 5)
insert PurchaseItem values (6, 1, 6)
insert PurchaseItem values (7, 2, 2)
insert PurchaseItem values (8, 3, 2)
insert PurchaseItem values (9, 3, 1)
insert PurchaseItem values (10, 3, 5) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:59:53.123

你也可以这样做：

```
var results = from i in db.Items
              select new InTradeResult
              {
                ProductName = i.Name,
                InTradeCount = i.PurchaseItems.Count(pi => pi.Purchase.IsValid)
              }; 
```

这是一个显示结果的示例控制台应用程序：

```
class Program
{
  static void Main(string[] args)
  {
    using (var db = new Context())
    {
      var results = from i in db.Items
                    select new InTradeResult
                    {
                      ProductName = i.Name,
                      InTradeCount = i.PurchaseItems.Count(pi => pi.Purchase.IsValid)
                    };

      foreach (var result in results)
      {
        System.Console.WriteLine("{0} - {1}", result.InTrade, result.ProductName);
      }

      System.Console.ReadKey();
    }
  }
}

public class InTradeResult
{
  public string ProductName { get; set; }
  public int InTradeCount { get; set; }
}

public class Context : IDisposable
{
  public IList<Item> Items { get; set; }
  public IList<Purchase> Purchases { get; set; }
  public IList<PurchaseItem> PurchaseItems { get; set; }

  public Context()
  {
    Items = new List<Item>();
    Items.Add(new Item { ID = 1, Name = "Bread" });
    Items.Add(new Item { ID = 2, Name = "Beer" });
    Items.Add(new Item { ID = 3, Name = "Wine" });
    Items.Add(new Item { ID = 4, Name = "Milk" });
    Items.Add(new Item { ID = 5, Name = "Apple" });
    Items.Add(new Item { ID = 6, Name = "Steak" });
    Items.Add(new Item { ID = 7, Name = "Hamburger" });
    Items.Add(new Item { ID = 8, Name = "Vinegar" });

    Purchases = new List<Purchase>();
    Purchases.Add(new Purchase { ID = 1, Name = "Purchase 1", ConfirmedDate = null, IsValid = true });
    Purchases.Add(new Purchase { ID = 2, Name = "Purchase 2", ConfirmedDate = null, IsValid = false });
    Purchases.Add(new Purchase { ID = 3, Name = "Purchase 3", ConfirmedDate = null, IsValid = true });

    PurchaseItems = new List<PurchaseItem>();
    PurchaseItems.Add(new PurchaseItem(1, Purchases[0], Items[0]));
    PurchaseItems.Add(new PurchaseItem(2, Purchases[0], Items[1]));
    PurchaseItems.Add(new PurchaseItem(3, Purchases[0], Items[2]));
    PurchaseItems.Add(new PurchaseItem(4, Purchases[0], Items[3]));
    PurchaseItems.Add(new PurchaseItem(5, Purchases[0], Items[4]));
    PurchaseItems.Add(new PurchaseItem(6, Purchases[0], Items[5]));
    PurchaseItems.Add(new PurchaseItem(7, Purchases[1], Items[1]));
    PurchaseItems.Add(new PurchaseItem(8, Purchases[2], Items[1]));
    PurchaseItems.Add(new PurchaseItem(9, Purchases[2], Items[0]));
    PurchaseItems.Add(new PurchaseItem(10, Purchases[2], Items[4]));
  }

  public void Dispose()
  {
    //Do nothing
  }
}

public class Item
{
  public int ID { get; set; }
  public string Name { get; set; }

  public IList<PurchaseItem> PurchaseItems { get; set; }

  public Item()
  {
    PurchaseItems = new List<PurchaseItem>();
  }
}

public class Purchase
{
  public int ID { get; set; }
  public string Name { get; set; }
  public DateTime? ConfirmedDate { get; set; }
  public bool IsValid { get; set; }

  public IList<PurchaseItem> PurchaseItems { get; set; }

  public Purchase()
  {
    PurchaseItems = new List<PurchaseItem>();
  }
}

public class PurchaseItem
{
  public int ID { get; set; }

  public int PurchaseId { get; set; }
  public Purchase Purchase { get; set; }

  public int ItemId { get; set; }
  public Item Item { get; set; }

  public PurchaseItem(int id, Purchase purchase, Item item)
  {
    ID = id;

    PurchaseId = purchase.ID;
    Purchase = purchase;
    purchase.PurchaseItems.Add(this);

    ItemId = item.ID;
    Item = item;
    item.PurchaseItems.Add(this);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:57:17.580

我认为有几种方法可以通过对数据库的单个查询来实现。这里有两个我能想到的：

在物品及其购买之间使用双向关联：

```
var resultUsingSubItems = context.PurchaseItems.Select(x => new
    {
        Item = x,
        ValidPurchases = x.Purchases.Count(y => y.IsValid)
    }); 
```

另一种方法，按项目分组：

```
var resultUsingGrouping = context.Purchases.GroupBy(x => x.Item).Select(
        g => new
            {
                Item = g.Key,
                ValidPurchases = g.Count(y => y.IsValid)
            }); 
```

请使用[SQL 分析器](http://www.techrepublic.com/article/step-by-step-an-introduction-to-sql-server-profiler/5054787)确保 Linq2SQL 将其转换为单个 SQL 查询。

# ruby-on-rails - 使用 rspec 单击文件选择器模式中的按钮

> ID：13463607
> 
> 赞同：0
> 
> 时间：2012-11-19T22:37:49.227
> 
> 标签：ruby-on-rails, rspec, filepicker.io

当我到达以下几点时，我正在 Rails 应用程序和我正在编写的集成测试中测试 filepicker.io 的实现：

```
sleep(5.0)
find_button('#fileUploadDummy').click 
```

我收到此错误：

```
Failure/Error: find_button('#fileUploadDummy').click
     Capybara::ElementNotFound: 
```

在出现此错误之前，我正在观察浏览器打开并进展到这一点。如何在文件选择器模式中单击此按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-26T11:21:29.387

我无法使用`Capybara-webkit`or `Poltergeist`（它们是无头的）进行此测试，所以我切换到`Selenium`.

示例代码：

```
test 'filepicker upload' do
    # in case your default driver is :webkit
    Capybara.current_driver = :selenium

    # this click_on will trigger filepicker.io plugin
    click_on 'Upload'

    # waiting for filepicker.io
    sleep 5

    within_frame 'filepicker_dialog' do
        # attach image to filepicker file input and upload...
        find('#fileUploadInput', visible: false).set("#{Rails.root}/test/integration/test_image.png")
        sleep 5
    end
end 
```

从我的调试来看，原始隐私或类似问题存在问题，因为我遇到了错误：

`Unsafe JavaScript attempt to access frame with URL`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T05:31:15.363

您很可能需要首先获得 iframe 的句柄，然后在该文档中进行查找。我不确定这如何转换为 rspec，但等效的 js 代码将是

```
var iframe_doc = document.getElementById("filepicker_dialog").contentDocument;
iframe_doc.getElementById("fileUploadDummy") 
```

当然这会因为跨域 javascript 调用而变得不安，但是 rspec 应该没问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T05:17:37.540

结果我认为文件选择器模式上的按钮是文件类型的输入元素，并且要在 rspec 中上传图片，我需要使用方法 attach_file。

# c# - 如何格式化 DataGrid 单元格，以便 SQL 中的时间条目显示为 hh:mm tt？

> ID：13463609
> 
> 赞同：1
> 
> 时间：2012-11-19T22:38:04.740
> 
> 标签：c#, sql-server-2008, xaml, wpfdatagrid

如果我的 SQL 表中的条目是 09:00:00，我的单元格要么显示为 09:00:00 之类的东西，要么我输入如下字符串格式：

```
 <DataGridTextColumn Binding="{Binding Path=tin, StringFormat=\{0:hh\\:mm\}}"  Header="Time In:"/> 
```

我得到 9:00。如何将其格式化为像“09:00 AM”这样的短时间字符串？

我尝试过使用 StringFormat=t ，它使单元格变为空白。任何使用“t”，单元格都会变为空白。我真的在这里泡菜。

DataGrid 填充了一个名为 displayGrid 的数据集。entryGrid 是 DataGrid 对象。
entryGrid.ItemsSource = displayGrid.Tables[0].DefaultView;

我在这里寻找的是在 XAML 中抛出什么以正确格式化它。我需要从我的 SQL 2008 表中的 09:00:00 到我的数据网格中的 09:00 AM。我在 VS 2012 中使用 C#.Net 和 XAML。我对编码非常陌生，所以我确信这是一个简单的错误或语法错误。感谢您提供的任何帮助。

编辑：

我什至回去了，尝试使用以下代码自动生成列来格式化单元格：

```
 private void ResultsDataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
    {
        if (e.PropertyType == typeof(DateTime))
        {
            DataGridTextColumn dataGridTextColumn = e.Column as DataGridTextColumn;
            if (dataGridTextColumn.Header.ToString().Equals("wkdate"))
            {
                dataGridTextColumn.Binding.StringFormat = "{0:d}";
            }
            if(dataGridTextColumn.Header.ToString().Equals("tin"))
            {
                dataGridTextColumn.Binding.StringFormat = "{0:t}";

            }
        }
    } 
```

适用于日期但不适用于时间！这让我发疯。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T13:01:33.957

根据您的格式，您可以更新现有的 XAML 代码并编写如下：

```
<DataGridTextColumn Binding="{Binding Path=tin, StringFormat=\{0:hh:mm tt\}}"  Header="Time In:"/> 
```

希望这可以帮助

或者，你能不能给你下面的。我确信这是有效的，因为我在许多项目中都使用过它。

CS文件代码：

```
 [ValueConversion(typeof(DateTime), typeof(string))]
    public class StringTime : IValueConverter
    {
        #region IValueConverter Members
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            if (value == null || value.ToString() == "")
            {
                return "";
            }
            String str = ((DateTime)value).ToString("hh:mm tt");
            return str;
        }
        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            if (value == null || value.ToString() == "")
            {
                return value;
            }
            DateTime dtr = DateTime.MinValue.Date;
            dtr = dtr.AddYears(1899);
            if (value == null)
                return dtr;
            dtr = dtr.AddHours(double.Parse((value.ToString().Substring(0, 2))));
            dtr = dtr.AddMinutes(double.Parse((value.ToString().Substring(3, 2))));
            if(value.ToString().Substring(7, 2) == "PM")
                dtr = dtr.AddHours(12);

            return dtr;
        }
        #endregion
    } 
```

XAML 文件：

```
 <Page.Resources>
        <custom:StringTime x:Key="StringTime" />
    </Page.Resources>

DataGrid Column Code:

    <DataGridTextColumn Binding="{Binding Path=tin, Converter={StaticResource StringTime}}"  Header="Time In:"/> 
```

如果您有任何问题，请告诉我。

# php - 使用 jquery 将 PHP 值加载到 jquery 语句内的文本框中

> ID：13463610
> 
> 赞同：0
> 
> 时间：2012-11-19T22:38:05.103
> 
> 标签：php, javascript, jquery

我试图将数据库中的数值加载到名为 jTagLabel 的文本框中。它来自 JTag API，它的设置方式是，html 代码位于 jquery 内部。

所以首先我做了一个 jquery 语句来从一个名为 tag count 的 php 文件中加载一个名为 span1 的 span 的值。我已经测试了这部分，它工作正常。

```
$('#jTagLabel.val()').load('tagcount.php #span1');

$('<div style="width:'+options.defaultWidth+'px;height:'+options.defaultHeight+'px"class="jTagDrag">       <div class="jTagSave"><div class="jTagInput"><input type="text" value="" id="jTagLabel"></div><div class="jTagSaveClose"></div><div class="jTagSaveBtn"></div><div style="clear:both"></div></div>').appendTo(overlay); 
```

我想要做的是让 .load 显示为上面“id=JTagLabel”的 value=""。任何和所有的帮助表示赞赏。

*注意，Jquery .load 语句写在 div 语句之后，但对于这个例子，我把它放在了前面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:42:42.080

大概是这样的？

```
$.get('tagcount.php', function(data) {
    var span_text = $('<div>')
                    .append(data)
                    .find('#span1').html();

    $('#jTagLabel').val(span_text);
}); 
```

这就是 .load() 做事的方式。它确实尝试删除`<script>`标签。

# web-services - JAX-WS Netbeans 如何启用压缩 Web 服务客户端

> ID：13463616
> 
> 赞同：0
> 
> 时间：2012-11-19T22:38:25.663
> 
> 标签：web-services, netbeans, compression, jax-ws

我在 Netbeans 7.1.2 中使用了 Web 服务客户端向导，但是当我尝试调用其中一个方法时，我收到以下错误：

***javax.xml.ws.soap.SOAPFaultException：异常：未启用压缩，此 Web 服务需要客户端支持 GZIP，Deflate 压缩***

生成的骨架文件很多，我无法弄清楚如何启用压缩。有人可以请教吗？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T10:36:10.847

这里有四点需要考虑。有一个**请求**和一个**响应**，还有一个**客户端**和**服务器**。在谈论压缩时，重要的是要准确说明我们针对的是哪种情况。我将海报的问题读作是关于客户端的问题，因为服务器似乎已经在进行压缩。（事实上​​，它似乎要求客户端能够处理压缩）。

这里有一点背景：压缩提示是 HTTP 协议的标准部分。客户端将向服务器表明它愿意通过随请求发送适当的 HTTP 标头来接受压缩响应。同样，服务器将通过响应中的适当 HTTP 标头元素指示它是否已发送压缩响应。客户端也可以发送压缩请求。

这些是相关的 HTTP 标头元素：

*   `Content-encoding`：如果设置了这意味着“我正在向您发送编码（例如压缩）消息”。客户端（在请求中）和服务器（在响应中）都可以使用它。

*   `Accept-encoding`: 如果设置了这意味着“我可以理解这些类型的编码（例如压缩方法），所以请随时向我发送以该格式编码的数据”。

这两个标头元素的典型值是“gzip”，这是迄今为止 HTTP 服务器和 HTTP 客户端使用的最常见的压缩方法。还有“放气”，但坚持使用“gzip”。

让我们从头说起：从客户端到服务器的**请求：**

实际上很少看到这种压缩。原因是客户端无法提前知道服务器是否可以理解压缩请求。因此，通常最好不要尝试这样做。通常这不是问题，因为它通常是很大的响应。如果绝对有必要压缩请求，那么您首先需要以某种方式查询服务器的功能，或者绝对确定它可以处理压缩请求。

然后是更有趣的部分：从服务器到客户端的**响应。**

首先，客户端需要告诉服务器他愿意接受压缩响应。这是根据请求完成的（呃！）。如何将 HTTP 标头元素添加到 JAX-WS 出站请求的一般方法在[此处](http://metro.java.net/2.1.1/guide/HTTP_headers.html)的 Metro 指南中进行了说明。所以你会这样做：

```
SomeWebService someWS = service.getMyWebServicePort();
((BindingProvider)someWS).getRequestContext().put(MessageContext.HTTP_REQUEST_HEADERS,
    Collections.singletonMap("Accept-Encoding",Collections.singletonList("gzip"))); 
```

您可能会说：“这不会替换*所有*HTTP 标头元素并将其替换为单个元素标头吗？”。技术上是正确的，但此时 JAX-WS 尚未添加任何 HTTP 标头。JAX-WS 稍后将添加它自己的标题元素。如果您监视服务器接收的 HTTP 标头，您现在将看到如下内容：

```
内容类型：文本/xml；charset="utf-8"
接受编码：gzip
肥皂动作：“http://blahblah”
接受：text/xml、multipart/related、text/html、image/gif、image/jpeg、*；q=.2, */*; q=.2
用户代理：JAX-WS RI 2.1.5-hudson-$BUILD_NUMBER-
主机：本地主机：8084
连接：保持活动
内容长度：216

```

如果没有我们的明确行动，“接受编码”元素就不会存在。（好问题为什么 JAX-WS 默认不添加这个？？）

现在你已经完成了客​​户端。之前的海报已经解释了如何在服务器端添加压缩能力。需要注意的是，服务器端的压缩（只要我们谈论压缩*响应*）仅由容器处理，例如由 Tomcat、Glassfish、JBoss 等处理，而不是由您的代码处理。您只需要在容器的配置中翻转一个开关。

快完成了。服务器现在可以自由地向您的客户端发送 gzip 压缩响应，但由服务器自行决定。服务器可以做也可以不做。你不知道这个。

您的最后一个问题应该是：“我如何在我的 JAX-WS 客户端中处理压缩响应？” 或更广泛地说“我的 JAX-WS 客户端将如何处理压缩和未压缩的响应？”。好消息是，这是由 JAX-WS 透明处理的。没有什么你需要做的。JAX-WS 将自动检测到它从服务器接收到压缩响应（它只是查看响应中的 HTTP 标头）并自动为您解压缩。瞧！

所以，亲爱的发帖者，我想说的是，如果您使用的是最新版本的 JAX-WS，那么您的客户端现在已经知道如何处理压缩响应了。但是，由于客户端没有明确告诉服务器它可以理解压缩响应，因此服务器认为情况并非如此，因此会给您该错误。这是我对你所看到的猜测。

哦，还有一件事。根据 RFC 2616，HTTP 标头元素名称（它们被正确地称为“标头字段”）不区分大小写。因此，您可以在不同的帖子中以多种不同的方式看到这一点。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T04:31:32.637

您可以从应用程序服务器配置中更好地启用压缩。从您的问题来看，您最有可能使用 glassfish 或 tomcat（我更喜欢 tomcat 人）。对于 glassfish，您可以通过将以下内容添加到您的`domain.xml`

```
 <property name="compression" value="on"/> 
```

或者，如果您通过管理控制台管理服务器，请使用[此可视指南](http://www.vikasing.com/2010/01/enable-gzip-compression-on-glassfish-v3.html)。对于tomcat添加

```
 compression="on" 
```

到配置文件中的 tomcat`<Connector/>`元素。`server.xml`

要实际发送压缩的 JAX-WS 请求，只需通过将压缩标头添加到 HTTP 有效负载来表明您发送压缩请求的意图

```
 Map<String, List<String> theHeaders = new HashMap<String, List<String>>();
theHeaders.put("Content-Encoding", Collections.singletonList("gzip"));//this indicates you're sending a compressed request
theHeaders.put("Accept-Encoding", Collections.singletonList("gzip")); //this says you're willing to accept a compressed response
Map<String, Object> reqContext = ((bindingProvider) proxy)
        .getRequestContext(); //get access to the request context of your webservice request
requestContext.put(MessageContext.HTTP_REQUEST_HEADERS, httpHeaders); 
```

作为设计问题，上述逻辑最好从 web 服务[处理程序执行](http://docs.oracle.com/cd/E12839_01/web.1111/e13734/handlers.htm)

# php - 一个对象可以包含另一个相同类型的对象吗？

> ID：13463624
> 
> 赞同：1
> 
> 时间：2012-11-19T22:38:58.203
> 
> 标签：php

我阅读了其他语言的几个问题和答案，但没有看到任何专门针对 PHP 的问题和答案。

以下内容在 PHP 中是否有效？

```
class foo 
{
    // constructor, etc..

    public function bar()
    {
        $newFoo = new foo();
        // do something
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:42:30.500

是的，这是有效的，只要您不在构造函数中创建相同类型的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:42:59.487

是的，这将是有效的。您可以创建嵌套的对象集。（虽然在构造函数中这样做会导致无限递归！）

**额外的！**您甚至可以将对象链接到自身！

```
$this->myself = $this; 
```

它会链接到同一个对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T22:44:31.500

没有什么可以阻止它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T22:47:16.807

简短的回答：是的，它有效！

您几乎可以在 php 代码的任何位置实例化您的对象。类方法内部没有什么不同，但是如果它是不同的类，则必须确保首先包含您的类文件，例如

```
<?php

    require_once './foo.class.php';

    class bar{
        //class stuff
        public doThingsWithFoo(){
            $foo = new foo();
        }
    }
?> 
```

在您的特定情况下，您似乎正在搜索[$this](http://www.php.net/manual/en/language.oop5.basic.php)关键字。从手册：

> 当从对象上下文中调用方法时，伪变量 $this 可用。$this 是对调用对象的引用（通常是方法所属的对象，但也可能是另一个对象，如果该方法是从辅助对象的上下文中静态调用的）。

那么在你的例子中：

```
class foo 
{
    // constructor, etc..

    public function bar()
    {
        $this->useAMethodFromThisClass();
        // do something
    }
} 
```

但是在同一个类的方法中使用同一个对象的另一个实例没有什么（除了常识），就像你正在做的那样：

```
class foo 
{
    // constructor, etc..

    public function bar()
    {
        $newFoo = new foo();
        // do something with this instance of foo that you cannot do using $this
    }
} 
```

我希望它有所帮助。干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-19T23:01:25.940

了解 PHP 中某些内容是否有效的最佳方法是在头文件中使用此函数：

```
<?php
error_reporting(E_ALL|E_NOTICE);
?> 
```

甚至PHP也会报错，比如没有使用“isset()”。

* * *

其他做法：

*   始终使用`$_GET`,`$_POST`而不是`global`

*   不要使用这个：`$_GET["test"]`这是最好的`$_GET['test']`

*   请务必阅读 PHP 文档以查看该函数是否已弃用（文档：[http](http://www.php.net/manual) ://www.php.net/manual ）

`Note:`您的“构造函数”是“有效的”。

# svn - 使用 SVN，我如何将标签/路径与非版本化文件进行比较？

> ID：13463630
> 
> 赞同：0
> 
> 时间：2012-11-19T22:39:33.653
> 
> 标签：svn

假设我在磁盘上有一组源文件，并且在 SVN 中有相同的应用程序。我想将这些文件与特定的存储库路径进行比较，例如查看磁盘上的文件是否实际上与特定标签相同。

svn diff 在这种情况下不起作用，因为磁盘上的文件不是工作副本。

显然，我可以将我感兴趣的标签签出或导出到一个临时位置，然后进行比较，但我希望找到一个不涉及磁盘上文件的整个第二个副本的选项。

（我的总体目标是审核未进入源代码控制的实时 Web 应用程序文件的更改）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:49:06.027

你真的应该考虑使用`rsync --dry-run -acp devbox:/workingCopy server:/liveCopy`比较。这就是我对我维护的庞大集群进行审计的方式......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:45:52.493

对于回购对象，您可以|必须使用`svn cat URL`，它输出目标的内容（并在其之后修复损坏的工作流程）

# c# - 有没有办法用 C# 关闭资源管理器的特定实例？

> ID：13463639
> 
> 赞同：11
> 
> 时间：2012-11-19T22:40:11.333
> 
> 标签：c#, process

我正在寻找一种方法来关闭对某个文件夹打开的 Windows 资源管理器窗口。说 c:\users\bob\folder。我可以使用下面的代码关闭所有资源管理器，但这显然不是我想要做的。这可能吗？

```
 foreach (Process p in Process.GetProcessesByName("explorer"))
 {
    p.Kill();
 } 
```

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-19T23:36:59.017

这篇文章让我大部分时间到达那里：[http ://omegacoder.com/?p=63](http://omegacoder.com/?p=63)

我找到了一种使用名为“Microsoft Internet Controls”的 COM 库的方法，该库看起来更适合 Internet Explorer，但我放弃了尝试使用进程 ID 和其他`MainWindowTitle`东西，因为 explorer.exe 只对所有打开的窗口使用一个进程，而我不能t 确定如何从中获取窗口标题文本或文件系统位置。

因此，首先，从 COM 选项卡添加对 Microsoft Internet 控件的引用，然后：

```
using SHDocVw; 
```

这个小程序对我有用：

```
ShellWindows _shellWindows = new SHDocVw.ShellWindows();
string processType;

foreach (InternetExplorer ie in _shellWindows)
{
    //this parses the name of the process
    processType = Path.GetFileNameWithoutExtension(ie.FullName).ToLower();

    //this could also be used for IE windows with processType of "iexplore"
    if (processType.Equals("explorer") && ie.LocationURL.Contains(@"C:/Users/Bob"))
        {
            ie.Quit();
        }    
} 
```

一个警告，可能是由于这个库是面向 IE 的，你必须在文件夹路径中使用正斜杠吗......那是因为`LocationURL`从`ie`对象返回的 true 是形式`file:///C:/Users/...`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:10:06.887

我会尝试导入 user32.dll 并调用 FindWindow 或 FindWindowByCaption，然后调用 DestroyWindow。

关于 FindWindow 的信息在这里： [http ://www.pinvoke.net/default.aspx/user32.findwindow](http://www.pinvoke.net/default.aspx/user32.findwindow)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-28T23:14:39.707

这行得通。这是对 Jeff Roe 帖子的跟进。

```
// Find window by Caption only. Note you must pass IntPtr.Zero as the first parameter.
[DllImport("user32.dll", EntryPoint = "FindWindow", SetLastError = true)]
public static extern IntPtr FindWindowByCaption(IntPtr ZeroOnly, string lpWindowName);

[DllImport("user32.dll", CharSet = CharSet.Auto)]
public static extern IntPtr SendMessage(IntPtr hWnd, int Msg, IntPtr wParam, StringBuilder lParam);

// caption is the window title.
public void CloseWindowsExplorer(string caption)
{
    IntPtr i = User32.FindWindowByCaption(IntPtr.Zero, caption);
    if (i.Equals(IntPtr.Zero) == false)
    {
        // WM_CLOSE is 0x0010
        IntPtr result = User32.SendMessage(i, 0x0010, IntPtr.Zero, null);
    }
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2017-05-07T02:03:08.047

```
foreach (Process p in Process.GetProcessesByName("explorer"))
{
    if (p.MainWindowTitle.Contains("YourFolderName"))
    {
        p.Kill();
    }
} 
```

# c++ - 使用多线程来模拟这个的好方法是什么？

> ID：13463648
> 
> 赞同：1
> 
> 时间：2012-11-19T22:40:43.903
> 
> 标签：c++, multithreading, parallel-processing, openmp

我正在 Visual Studio 中用 C++ 编写一个程序，以便能够在公园处理一条线。我的所有客户都在公园排队，我希望能够使用多线程和 openmp 为他们提供服务。

当我将编译指示等放入时，我有多个线程同时为我创建的每个客户服务同一个客户，而不是我想要的。

例如，如果我有两个线程和四个客户，那么线程 1 执行客户 1，而线程 2 执行客户 2。那么我希望线程 1 同时执行客户 3 和线程 2 客户 4。我不知道它是否可能或是否有更好的方法，但我需要使用 openMP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:54:07.227

您可以将每个迭代关联*为*客户，并以静态方式将它们（客户）分配给线程。

```
#pragma omp parallel for schedule(static, CHUNKSIZE)
for(i = 0; i < customer_max; i++)
{
 // do something with customers 

} 
```

**static**：在此分发中，线程在执行实际循环之前静态地预先计算了它们的工作。默认情况下，迭代在线程之间平均分配。但是，如果您为参数指定整数，则分布会将连续迭代`CHUNKSIZE`大小的块分配给线程。`CHUNKSIZE`

在具有 2 个线程和 4 个客户的示例中，您将使用 CHUNKSIZE = 1。因此，线程 0 将执行客户 0 和 2，而线程 2 将执行客户 1 和 3。

如果不指定`CHUNKSIZE`，线程 0 将执行前 2 个客户，线程 1 将执行剩下的 2 个。

另一方面，如果您希望每个线程以动态方式为客户服务，您可以使用动态分布。

```
 #pragma omp parallel for schedule(dynamic)
    for(i = 0; i < customer_max; i++)
    {
     // do something with customers 

    } 
```

动态调度适用于*for* with 迭代的情况，这些迭代执行的工作在时间上会发生很大变化。类似地，在您的情况下，如果您的消费者需要不同的时间来服务。

# php - 在 URL 中发送带有变量的 HTML 电子邮件

> ID：13463651
> 
> 赞同：1
> 
> 时间：2012-11-19T22:40:54.960
> 
> 标签：php, html, email, variables

我正在使用以下脚本将动态页面 (php) 作为 html 电子邮件发送...发送电子邮件的页面使用 URL 中的变量来确定从数据库中显示的记录

```
<?

 $evid = $_GET['evid'];

    $to  = 'dj@mail.com';
$subject = 'A test email!';

// To send HTML mail, the Content-type header must be set
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Put your HTML here
$message = file_get_contents('http://www.url.co.uk/diary/i.php?evid=2');

// Mail it
mail($to, $subject, $message, $headers);

?> 
```

如您所见，通过电子邮件发送的 html 文件有一个 evid 变量...如果我将其设置为 $evid 并在运行当前脚本时尝试发送该变量，我会收到错误...有人知道解决这个问题的方法吗？

希望我解释得足够清楚 Rob

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:52:58.697

PHP 不会计算单引号字符串中的变量。

```
$variable = "Hello World!";
echo '$variable'; //$variable
echo "$variable"; //Hello World! 
```

要么移动到双引号字符串，要么使用连接运算符 ( `.`)：

```
echo 'string' . $variable; //stringHello World! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:57:26.950

尝试将变量连接到 url 字符串的末尾，如下所示：

```
$message = file_get_contents('http://www.url.co.uk/diary/i.php?evid=' . $evid); 
```

为我工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:57:43.290

```
$message = file_get_contents('http://www.url.co.uk/diary/i.php?evid='.$evid); 
```

# ruby-on-rails - 在 ruby on rails 应用程序中查找变量

> ID：13463652
> 
> 赞同：1
> 
> 时间：2012-11-19T22:40:56.733
> 
> 标签：ruby-on-rails, variables, associations

我有两个表：一个称为样式，它有 5 个属性（加上 id 和 created_at），另一个称为推荐器，它有 6 个属性（加上 id 和 created_at）。

在 Styles 表上定义了 5 个属性后，我希望能够显示推荐表中的条目，该条目具有与样式表中的属性匹配的 5 个属性。

我尝试了几种 Model.find 和 Model.where 的组合来获得它，但似乎没有任何效果。

这是styles_controller.rb

```
def show
@style = Style.find(params[:id])
bt = @style.bodytype
n = @style.need
t = @style.texture
c = @style.color
st = @style.statement   
@recommender =  Recommender.with_bodytype(params[:bt]).with_need(params[:n]).with_texture(params[:t]).with_color(params[:c]).with_statement(params[:st])
respond_to do |format|
  format.html # show.html.erb
  format.json { render json: @style }
 end
end 
```

我得到的消息是：未定义的方法 `with_bodytype' for #

所以，感谢@bravenewweb 的帮助......但仍然存在一些问题：

我想我找到了问题所在，但我不知道如何解决它。

生产环境有 Recommender 及其所有数据（我把它放在那里），开发也是如此。

Recommender 现在存在于 Heroku，但没有任何数据。我不知道如何把它放在那里。

我认为问题在于生产数据库是 SQLite，即使它只应该在开发和测试中工作。那么如何让生产数据库与 Heroku 对话呢？

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T05:36:52.293

它应该比这容易得多，ActiveRecord 的 find 方法默认会返回匹配的第一条记录。您要做的是将属性名称与 and 链接，然后使用与方法名称相同的顺序传递查询属性

```
@recommender = Recommender.find_by_bodytype_and_need_and_texture_and_color_and_statement(bt, n, t, c, st) 
```

如果你想找到所有匹配这些参数的记录，你只需要开始它

```
@recommender = Recommender.find_all_by_bodytype_and_need_and_texture_and_color_and_statement(bt, n, t, c, st) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:53:48.730

我不熟悉这些`.with_<attribute>`方法（它们存在吗？），但听起来你想要一个简单的 where 子句。如果我理解正确，您希望找到所有共享所选样式属性的推荐者。所以像

```
@recommender = Recommender.where("bodytype = :bodytype AND need = :need AND texture = :texture AND color = :color AND statement = :statement", [:bodytype => @style.bodytype, :need => @style.need, :texture = @style.texture, :color => @style.color, :statement => @style.statement]).first 
```

你也可以使用`?`每个命名的占位符，但是当你有很多条件时，这会更清楚一点。

另外，这可能不是一种`show`方法，它更像是`index`因为查询可以返回多个结果，对吧？如果是这样，也许您的实例变量应该是复数 ( `@recommenders`)。或者，也许我错过了什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:17:33.790

如果您希望样式与推荐者唯一关联，则可以将组合键作为 [bodytype, need, texture, color, statement] 的 has_one 关联。

# php - 从 m/d/y 格式日期转换为 Unix 时间戳

> ID：13463655
> 
> 赞同：1
> 
> 时间：2012-11-19T22:41:03.813
> 
> 标签：php, timestamp

我试图想出一种方法来使用 PHP 将以下格式的任何日期转换为 unix 时间戳。我想知道是否有人可以帮助我完成这项工作。

这是我尝试过的，但没有奏效：

```
 $expiration_date = '11/22/12';

   $timestamp = strtotime(date("m/d/y", $expiration_date)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T22:43:51.217

你不需要这个`date()`部分。

只需这样做：

```
$expires = '11/22/12';
$unix = strtotime($expires); 
```

[http://php.net/manual/en/function.strtotime.php](http://php.net/manual/en/function.strtotime.php)

您的示例的问题是您将字符串传递给`date()`函数。
该`date()`函数需要一个格式字符串，例如`'m/d/y'`，然后是一个 int 值的时间。
您正在向它传递一个字符串，因此它不起作用。

`date()`： http: [//php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:08:49.193

请使用 DateTime 进行这些操作。

```
$expiration_date = '11/22/12';
list($m, $d, $y) = explode('/', $expiration_date);
$unix = (checkdate((int)$m, (int)$d, (int)$y + 2000)) ? DateTime::createFromFormat('m/d/y', $expiration_date, new DateTimeZone('Europe/Berlin'))->getTimestamp() : false;
echo $unix; 
```

这会给你一个整数。

# sql - 放置 where 子句后 SQL 语句不起作用

> ID：13463656
> 
> 赞同：1
> 
> 时间：2012-11-19T22:41:04.990
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005

```
SELECT     
   Event.Id, Event.Title, Event.StartDateTime, Event.DeadlineDate, 
   [File].ShortFileName, People.Initials
FROM         
   People 
INNER JOIN
   People2Event ON People.Id = People2Event.PeopleId 
RIGHT OUTER JOIN
   [File] 
INNER JOIN
   File2Event ON [File].Id = File2Event.FileId 
RIGHT OUTER JOIN
   Event ON File2Event.EventId = Event.Id ON People2Event.EventId = Event.Id 
```

我有这个声明它可以打印所有记录。下面不起作用，它与 where 函数的语句相同。有谁知道如何解决？

```
SELECT     
   Event.Id, Event.Title, Event.StartDateTime, Event.DeadlineDate, 
   [File].ShortFileName, People.Initials
FROM         
   People 
INNER JOIN
   People2Event ON People.Id = People2Event.PeopleId 
RIGHT OUTER JOIN
   [File] 
INNER JOIN
   File2Event ON [File].Id = File2Event.FileId 
RIGHT OUTER JOIN
   Event ON File2Event.EventId = Event.Id ON People2Event.EventId = Event.Id
WHERE 
   Event.ID = 8888 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T22:43:29.063

**编辑**：

正如 AndriyM 指出的那样，由于`WHERE`子句中的条件位于 的右侧，因此`RIGHT OUTER JOIN`移至`ON`将没有效果。OP 发布了一个查询，其中仅`INNER JOIN`包含他说解决了问题的内容，因此他的查询肯定存在其他问题。

* * *

如果您在`WHERE`子句中为属于 的表添加过滤器`OUTER JOIN`，它将消除任何`NULL`行，从而有效地将您`OUTER JOIN`转换为`INNER JOIN`.

不要将条件放在您的`WHERE`子句中，而是将其移至您的`ON`：

```
File2Event ON [File].Id = File2Event.FileId RIGHT OUTER JOIN
Event 
    ON File2Event.EventId = Event.Id 
    AND People2Event.EventId = Event.Id
    AND Event.ID = 8888 
```

另外，关于样式的提示，我会避免使用`RIGHT JOIN`，而是重新编写查询以使用`LEFT JOIN`......这通常会使逻辑更容易理解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:50:38.080

如果没有 Event.Id，这将正确地不返回任何行。

一个可能的混淆来源可能是您在引入 Event 时使用了“右外连接”，因此您可能希望它仍然显示来自另一个表的行，即使使用过滤器。

但是该过滤器位于您的 where 子句中，因此整个查询将仅返回与过滤器条件匹配的行。在这种情况下，这意味着您只会看到 event.id 为 8888 的行，而没有其他内容。

如果您希望它显示事件表中的行，但仅在 event.id 为 8888 时显示其他表中的信息，那么您可以将其作为联接的一部分。使用常量而不是来自另一个表的值作为连接子句的一部分有点不寻常，但服务器会很乐意接受它，并且只在需要条件时才加入。当使用内连接时，这几乎没有用，但对于外连接，它可以帮助控制何时引入另一个表的数据。它看起来像：

```
SELECT     Event.Id, Event.Title, Event.StartDateTime, Event.DeadlineDate, [File].ShortFileName, People.Initials
FROM         People INNER JOIN
                      People2Event ON People.Id = People2Event.PeopleId RIGHT OUTER JOIN
                      [File] INNER JOIN
                      File2Event ON [File].Id = File2Event.FileId RIGHT OUTER JOIN
                      Event ON File2Event.EventId = Event.Id 
                      ON People2Event.EventId = Event.Id
                          AND Event.ID = 8888 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:59:26.820

```
SELECT     Event.Id, Event.Title, Event.StartDateTime, Event.DeadlineDate, [File].ShortFileName, People.Initials
FROM         [File] INNER JOIN
                      File2Event ON [File].Id = File2Event.FileId INNER JOIN
                      People INNER JOIN
                      People2Event ON People.Id = People2Event.PeopleId INNER JOIN
                      Event ON People2Event.EventId = Event.Id ON File2Event.EventId = Event.Id
WHERE     (Event.Id = 8888) 
```

出于某种原因，这可以解决问题。使用查询设计器。

# java - Object 是抽象类的超类吗？

> ID：13463657
> 
> 赞同：1
> 
> 时间：2012-11-19T22:41:16.907
> 
> 标签：java, object, inheritance

我想知道`Object`“松散”抽象类的超类是否也是如此，即不扩展其他抽象类的抽象类。我不认为这很重要。但是，当把所有东西放在一起时，这个“正式”的措辞如何。

以下支持并与我看到的主题行中的 Q 相矛盾：

支持（对上面的 Q 表示“是”）：i.) 具体类可以从抽象类继承，ii.) 每个类都是 的后代`Object`，并且 iii.) 每个类（除了`Object`）都只有一个超类。如果`Object`不是抽象类的超类，那么 (iii) 必须违反特殊情况`Object`——“一个类可以有两个超类，如果其中一个是`Object`，另一个是抽象的。”

矛盾的（对 Q 表示“否”）：抽象类不能从属于具体类，`Object`而是具体的。但是，这也可以表述为“针对`Object`类的特殊情况”。

它是在一方面比另一方面更多，还是仅仅是“两者兼而有之——对于`Object`班级来说是例外”。提前致谢。

**注意**：我阅读了关于 [为什么 java.lang.Object 不是抽象的讨论？](https://stackoverflow.com/questions/2117689/why-java-lang-object-is-not-abstract).

**纠正我在上面原始消息中的明显错误：** 抽象类显然可以从具体类继承。这也使 Object 成为它们的超类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:43:43.687

是的，`Object`它是每个抽象类的超类型，而且——独一无二地——甚至是接口的超类型。

> 抽象类不能从属于具体类，[…]

那不是真的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:44:38.183

我认为您感到困惑的是抽象类继承具体类是合法的。这是相当罕见的，但它可能会发生。[这个问题](https://stackoverflow.com/q/7496010/544198)显示了很多这样的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:53:42.163

是的，所有“松散”的抽象类都继承`Object`. 抽象类继承具体类并不常见，但这是合法的。

# java - Java 库，如 org.apache.commons.io.FileUtils，但包含实例方法而不是静态方法

> ID：13463662
> 
> 赞同：1
> 
> 时间：2012-11-19T22:41:47.523
> 
> 标签：java, file, io

我想知道在 FileUtils 中只有静态方法有什么意义？有没有理由没有实例方法？我相信 FileUtils 是线程安全的（如果我错了，请纠正我），但我确实有一堆线程同时使用 FileUtils 方法，而且看起来拥有多个实例比拥有同步代码更好。是否有模仿 FileUtils 库但不包含任何静态方法的库？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-19T22:45:12.477

> 我想知道在 FileUtils 中只有静态方法有什么意义？有没有理由没有实例方法？

因为`FileUtils`是无状态方法的集合。为它引入一个对象是没有意义的——它会包含什么？

> 我相信 FileUtils 是线程安全的。

这一切都取决于你试图实现什么以及如何实现某事。例如，如果您尝试在多个线程中读取多个甚至同一个文件，它会正常工作。但是，如果您尝试从多个线程中写入同一个文件，您可能会遇到一些问题。然而，这些问题将源于您使用相同的文件来编写东西的事实，因此实际上并`FileUtils`没有使线程安全。

# android - JNI GetMethodId 返回 null

> ID：13463665
> 
> 赞同：5
> 
> 时间：2012-11-19T22:41:58.040
> 
> 标签：android, java-native-interface

我有一个简单的问题，但在网上找不到解决方案。

我只想使用 JNI 从本机检索 Java 字符串。

```
jint JNI_OnLoad(JavaVM *vm, void *reserved) {
void * my_lib_handle;

jmethodID mid;
jstring resultString;
JNIEnv *env;
int status;

__android_log_write(ANDROID_LOG_DEBUG,"JNI", "> JNI_OnLoad");
status = (*vm)->GetEnv(vm, (void**)&env, JNI_VERSION_1_4); 
if(status < 0){
    __android_log_write(ANDROID_LOG_DEBUG,"JNI", "failed to get JNI environment");
    status = (*vm)->AttachCurrentThread(vm, (void**)&env, NULL);
    if(status < 0){
        __android_log_write(ANDROID_LOG_DEBUG,"JNI", "failed to attach to current thread");
        return;
    }
}
jclass handlerClass = (*env)->FindClass(env, "com/mypackage/JniInterface");

if (handlerClass == NULL) {
    __android_log_write(ANDROID_LOG_DEBUG,"JNI", "can not find the class JniInterface ");
    return;
}
mid = (*env)->GetMethodID(env, handlerClass, "getCert", "()Ljava/lang/String");
if (mid == NULL) {
    __android_log_write(ANDROID_LOG_DEBUG,"JNI", "can not find the method getCert");
    return;
} 
```

`FindClass`作品。但它失败了`GetMethodId`。

这是我的简单类声明。我使它比以前更简单:)

```
package com.mypackage;
public class JniInterface {
private static String cert;
private static String key;
public JniInterface(){

}
public static String getCert() {
    return cert;
}
public static void setCert(String cert) {
    JniInterface.cert = cert;
}
public static String getKey() {
    return key;
}
public static void setKey(String key) {
    JniInterface.key = key;
}   
} 
```

我被困住了。我认为这是一个愚蠢的错误...

你能帮我调查一下吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-19T23:03:03.373

您的方法签名不正确，缺少尾随分号：

```
 "()Ljava/lang/String;"    
 --------------------^ 
```

# c - 如何为以下表达式进行类型转换

> ID：13463670
> 
> 赞同：1
> 
> 时间：2012-11-19T22:42:08.227
> 
> 标签：c, string, error-handling, realloc

我正在尝试使用以下表达式将内存重新分配给我的表。但我总是不断收到以下错误。请告诉我。

```
typedef char *OFAttribs[6];
 OFAttribs *tmp = realloc(pTable, sizeof(*tmp) * (nTableLen+1));

Error: invalid conversion from âvoid*â to âchar* (*)[6]â 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:47:06.870

试试这个：

```
OFAttribs *tmp = (OFAttribs*) realloc(pTable, sizeof(*tmp) * (nTableLen+1)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T22:58:26.320

您显示的代码是有效的 C。您确定您没有错误地在 C++ 模式下编译，其中`void *`不能隐式转换为其他指针类型？

# php - PHP case switch 行为破坏了递归 scandir 函数

> ID：13463671
> 
> 赞同：0
> 
> 时间：2012-11-19T22:42:12.533
> 
> 标签：php, switch-statement

在我寻求一些基本的 php 知识的过程中，我尝试做一个简单的函数来读取不使用递归迭代器的文件和目录。（更多的练习，但实际上需要任何 php<5.3 服务器）

该功能效果很好 - 但是当我尝试添加`switch`($output) - 它不再列出所有文件（例如，在添加开关之前，它可以在 4 个文件夹（3+root）中看到 61 个文件，但添加了`switch`它只能看到 47（仅根）。我在这里做错了吗？为什么该`switch`语句会破坏虚假的“递归嵌套”？

```
 function o99_list_my_files_scandir($dir,$output) 
    { 

        $result = $result2 = array(); 

        $root = scandir($dir); 

        foreach($root as $value) 
        { 

          if($value === '.' || $value === '..' || $value == 'Thumb.db' || $value == 'Thumbs.db' || $value == '') { continue;} 

            if(is_file("$dir/$value")) {$result[]="$dir/$value"; continue;} // array files
            if(is_dir("$dir/$value")) {$result2[]="$dir/$value"; continue;} // array dirs

            foreach(o99_list_my_files_scandir("$dir/$value") as $value) 

            { 
                $result[] = $value; 
            }
        } 
            // this is the troublemaker ...

            switch ($output) {
                case 'dirs' :
                return array_filter($result2);  // clean empty results of dirs
                break;

                case 'files' :
                return array_filter($result);   // Clean empty array of files
                break; 
            }

} 
```

有没有其他简单的方法可以让函数返回单独的目录和文件列表而不是统一数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:50:05.380

因为在这一行...

```
foreach(o99_list_my_files_scandir("$dir/$value") as $value) 
```

...你不给`$output`递归调用的函数，所以它不会输出任何东西。将其更改为：

```
foreach(o99_list_my_files_scandir("$dir/$value", $output) as $value) 
```

实际上，您应该收到有关缺少参数的警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:50:23.833

你似乎没有在`$output`任何地方设置。

顺便说一句：出于学习目的，我强烈建议您添加`error_reporting(E_ALL);`脚本的第一行并重新运行（首先，不修复任何内容），因为您应该看到警告，因为第二个函数参数不是可选的。你有签名

```
function o99_list_my_files_scandir($dir,$output) 
```

但打电话

```
o99_list_my_files_scandir("$dir/$value") 
```

而你应该

```
o99_list_my_files_scandir("$dir/$value", $output) 
```

在你的`foreach()`

# c# - UInt32 到 IntPtr

> ID：13463674
> 
> 赞同：-3
> 
> 时间：2012-11-19T22:42:28.400
> 
> 标签：c#

我有以下问题：

```
public class ListenThread : SocketInvoke
{
            [DllImport("Ws2_32", CharSet = CharSet.Auto)]
            public unsafe static extern UInt32 WSAWaitForMultipleEvents(UInt32 cEvents, IntPtr hEventObject,
            UInt32 fWaitAll, UInt32 dwTimeout, Boolean fAlertable);

            public void ListenConnections(NetSharedData data)
            {
                while (true)
                {
                    unsafe
                    {
                        if (WSAWaitForMultipleEvents((UInt32)1, data.signal, (UInt32)0, (UInt32)100, false) != WSA_WAIT_TIMEOUT)
                        {
                        }
                   }
             }
} 
```

data.signal 是 UInt32 我如何将其转换为 IntPtr？，我尝试：

```
IntPtr signal = (IntPtr)data.signal; 
```

但它不起作用，因为我需要一个指向 data.signal (UInt32) 类型的指针，而不是作为指针的 int 值，这将导致内存异常。

我需要的 C++ 示例：

```
int signal = 0;
int* psignal = &signal; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:55:10.567

```
new IntPtr(data.signal); 
```

您将在 64 位平台上遇到问题，因为 data.signal 仅挂在地址的低 32 位上。如果 NetSharedData 是您的，您应该考虑将信号类型更改为 IntPtr。

如果您尝试获取 data.signal 的地址：

```
new IntPtr(&data.signal); 
```

我不确定这是否会正确固定对象（以防止内存管理器重新定位它），我会执行以下操作：

1) 更改 PInvoke 签名：

```
public unsafe static extern UInt32 WSAWaitForMultipleEvents(UInt32 cEvents, 
       void* hEventObject, UInt32 fWaitAll, UInt32 dwTimeout, Boolean fAlertable); 
```

2) 使用固定固定对象

```
fixed (void* s = &data.signal)
{
    if (WSAWaitForMultipleEvents((UInt32)1, s, (UInt32)0, (UInt32)100, false) != WSA_WAIT_TIMEOUT)
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:48:19.430

这也编译

```
 UInt32 unsignedInt = 6;
        IntPtr iptr = new IntPtr(unsignedInt); 
```

所以也许这就是你想要的

```
IntPtr signal = new IntPtr(data.signal); 
```

# haskell - Haskell 为自定义类型导出 Show

> ID：13463678
> 
> 赞同：7
> 
> 时间：2012-11-19T22:42:40.070
> 
> 标签：haskell, instance, show

我如何告诉haskell，当`show`在代数类型的变量列表上调用时，应该在每行之后插入一个“\n”？

```
type Customer = (Int, Int, [Int]) 
```

我试图这样做：

```
instance of Show Customer where
show x = x ++ "\n" 
```

但显然我只能为“数据......”之类的东西创建这样的实例。我该如何解决这个问题？

我只需要为客户列表派生`Show`，这样当我显示它时，输出很容易阅读，每行一个客户。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-19T22:45:21.180

要只显示在不同的行上，不要更改`show`，只需执行`unlines (map show customerList)`. 这将显示它们中的每一个，然后将它们与中间的换行符重新组合在一起。

* * *

但是，您询问了将 show 更改为`type`同义词的问题，因此您可以选择：

`show`用于数据的基本序列化。如果你想做一些不同的事情，你有几个选择：

1.  编写一个在这种情况下执行此操作的函数。
2.  `display`创建您自己的 Display 类并定义您喜欢如何在其功能中布置事物。
3.  使用 a`newtype`包装数据。
4.  声明您自己的客户类型。
5.  稍后添加换行符

    类型客户 = (Int, Int, [Int])

**示例 1**

```
displayC :: Customer -> String
displayC = (++"\n").show 
```

**示例 2**

```
{-# LANGUAGE TypeSynonymInstances,  FlexibleInstances #-}
class Display a where
  display :: a -> String

instance Display Customer where
   display x = show x ++ "\n" 
```

（注意你应该说`instance Display Customer`而不是`instance of Display Customer`。）

示例输出：

```
*Main> display ((3,4,[5,6])::Customer)
"(3,4,[5,6])\n" 
```

不过，应该谨慎使用这些语言扩展。

**示例 3**

```
newtype Cust = Cust Customer
displayCust (Cust c) = show c ++ "\n" 
```

**示例 4**

```
data CustomerTup = CTup Int Int [Int]
displayCTup (CTup a b cs) = show (a,b,cs) ++ "\n" 
```

甚至更好，

```
data CustomerRec = CRec {custno::Int, custAge::Int, custMeasurements::[Int]}
  deriving Show
displayCRec r = show (custno r,custAge r,custMeasurements r) ++ "\n" 
```

你甚至可以坚持使用`Show`实例的做事方式。方法很好，`data`因为有更多的类型安全性，并且记录类型可以防止你犯一些微不足道的错误位置错误。

**示例 5**

```
stuff = unlines $ map show  [(1,2,[3,4]),(5,6,[7,8,9])] 
```

甚至

```
morestuff = unlines [show (1,2,[3,4]), 
                     show (5,6,[7,8,9]),
                     "are all more numbery than",
                     show (True,4,False)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T01:07:32.573

对 AndrewC 的出色答案的一个小补充：

**6.**编写一个函数，为类中任何类型的文本表示添加新行`Show`：

```
display :: Show a => a -> String
display = flip shows "\n" 
```

例如：

```
> display (2, 3, [5, 7, 11])
"(2,3,[5,7,11])\n" 
```

# html - 当表格具有动态内容时，如何保持表格的宽度不变？

> ID：13463679
> 
> 赞同：0
> 
> 时间：2012-11-19T22:42:40.287
> 
> 标签：html

如何保持表格的宽度不变，即使表格的内容以交互方式发生变化？

旧帖：

如何在 HTML 中插入可变长度选项卡？我希望表格中的某些动态字段对齐，但它们的宽度会不断变化。

编辑：我的意思是：在任何文本编辑器中，我都可以按 Tab 键对齐某些文本位，而不关心有多少空格。事实上，文本最左边需要的空格数可以改变，我仍然不在乎，只要文本对齐即可。我如何在 HTML 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:54:59.580

你最好的选择就是申请这样的课程：

```
.leftAlignedTable
{
    width: 90%; /*or whatever you want*/
} 
```

这将确保您的表格始终具有相同的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:47:54.573

桌子总是排成一列。即使您更改内容，表格也会随着大小的变化而扩大和缩小，并保持对齐不变。这就是a的意义所在`<table>`。

如果您`<table>`使用 CSS 将 ' 的宽度设置为一个常数（甚至是一个百分比）数字，那么无论它有什么内容，它都不会改变。

# python - 向 wsgi 脚本别名添加参数

> ID：13463687
> 
> 赞同：4
> 
> 时间：2012-11-19T22:43:23.580
> 
> 标签：python, apache, wsgi

有没有办法将额外的参数传递给 WSGIScriptAlias？例如：

`WSGIScriptAlias / /foo/bar/wsgi.py`但我想要的是：

`WSGIScriptAlias / /foor/bar/wsgi.py baz`

**编辑澄清**：

我有一个 Django 项目，它具有基于其运行环境（基于云的部署）的多种配置。目前，我正在加载基于主机名的配置（我不太满意，因为它不适合在不更改系统主机名的情况下在一台机器上测试多个配置）。因此，另一种解决方案是将命令行参数传递给应用程序并在 WSGI 入口点加载配置，这在运行开发服务器时相对简单，但我不知道有任何方法可以通过 Apache/ WSGI。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T04:41:48.853

首先，确保您使用的是守护程序模式，无论如何它都是首选。

*   [http://blog.dscpl.com.au/2012/10/why-are-you-using-embedded-mode-of.html](http://blog.dscpl.com.au/2012/10/why-are-you-using-embedded-mode-of.html)

然后在您的 WSGI 脚本文件中，您可以执行以下操作：

```
import mod_wsgi

process_group = mod_wsgi.process_group 
```

然后，您可以使用进程组的名称作为区分哪个配置的一种方式。

换句话说，使用您选择在 Apache 配置文件中使用的守护进程组的名称作为区分因素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-18T00:37:51.843

如果您使用 mod_wsgi，您可以在设置时利用 envvars 选项。

例如：

```
mod_wsgi-express start-server ./my-wsgi.py --port 8200 --envvars-script /home/user/envvars_localhost.sh 
```

在 envvars 文件“envvars_localhost.sh”中，设置一些需要的参数：

```
#!/bin/bash
export MOD_WSGI_VARIABLE='config1' 
```

然后在运行时您的 ./my-wsgi.py 可以引用数据：

```
mylocalConfigValue = os.environ['MOD_WSGI_VARIABLE'] 
```

# android - 使用 ToneGenerator 类生成哔声时出错

> ID：13463691
> 
> 赞同：5
> 
> 时间：2012-11-19T22:43:43.590
> 
> 标签：android, beep, tone-generator

我是安卓开发新手

我正在一个 android 应用程序中工作，它只是改变音量并播放哔声“以预览当前的声音级别”

我`startTone`在`ToneGenerator`课堂上使用来生成此哔声，如下所示：

```
 ToneGenerator tg = new ToneGenerator(AudioManager.STREAM_RING, 100);
 tg.startTone(ToneGenerator.TONE_PROP_BEEP); 
```

但*有时*此代码不起作用并生成以下异常

```
11-20 00:32:44.262: E/AudioTrack(4701): AudioFlinger could not create track, status: -12
11-20 00:32:44.262: E/ToneGenerator(4701): AudioTrack->initCheck failed 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-08-01T21:03:09.147

我知道现在为时已晚，但我正在发布答案，任何人都会稍后来。

它只是释放创建的对象，`ToneGenerator`因为快速创建“ToneGenerator”的对象而不释放它们会导致应用程序崩溃。

完整代码：

```
 final ToneGenerator tg = new ToneGenerator(AudioManager.STREAM_NOTIFICATION, 100);
    tg.startTone(ToneGenerator.TONE_PROP_BEEP);
    tg.release(); 
```

# clojure - 跨所有行的 Cassandra Cascalog 操作

> ID：13463693
> 
> 赞同：2
> 
> 时间：2012-11-19T22:43:51.080
> 
> 标签：clojure, mapreduce, cassandra, cascading

我有看起来像这样的数据

```
 {super-row-key1 [{ts1 {version-ts1 value, version-ts2 value}}
                   {ts2 {version-ts1 value}}]
   super-row-key2 ...} 
```

这些键和值看起来像

```
{"4447c9a6-9912-44d7-a6b5-cef40735f92c:2011-06"
 [{1291180500000 {1351709255098 -0.008084167000000001}}
  {1291184100000 {1351709255098 -0.004395833}}
  {1291185000000 {1351709255098 -0.003075}}]
 ...} 
```

所以我想弄清楚 ClojureWerks Cassandra Cascading tap 是否已经支持所有行的操作。如您所见，超级行键、超级行和超级列都已生成（uuid、日期、时间戳等）。在我看到的示例和代码中，我被引导相信需要预先指定标识列名、列字段名、键列名和字段映射的固定名称。

在 Cassandra 支持 MapReduce 的 Hadoop 级别上，Cassandra 似乎确实支持从给定的列族中获取所有数据行。从文档中：

> “Cassandra 行或行片段（即键对 + 列的 SortedMap）被输入到 Map 任务以供您的作业处理，由描述从每行获取哪些列的 SlicePredicate 指定。”

所以看起来在低级别肯定是可能的，但目前还不清楚如何完成我在级联级别上尝试做的事情。

这是否需要调整或创建现有水龙头的变体，或者可以用现有水龙头以某种方式完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T07:32:26.600

我假设罗伯特指的是：[https ://github.com/ifesdjeen/cascading-cassandra](https://github.com/ifesdjeen/cascading-cassandra)

我试图让 pingles/cascading.cassandra 与 Cascalog 一起工作，但没有成功，所有依赖项，因此必须更改所有接口。所以我决定写我自己的东西（并不总是最好的主意）。

现在，回答：

我花了比预期更长的时间来了解如何准确回答你，但我带来了好消息:)

首先，我不打算在水龙头中加入宽行支持，但事实证明它即使在当前版本中也能正常工作。不幸的是，我还不能推送示例，因为 Cassaforte（https://github.com/clojurewerkz/cassaforte，我们使用的 cassandra 驱动程序依赖于 Clojure 1.4，因为存在原始类型提示的错误：[http://dev .clojure.org/jira/browse/CLJ-852](http://dev.clojure.org/jira/browse/CLJ-852)如果我没记错的话，而且 Midje 设置了硬版本，所以它不支持 1.4，所以我不得不使用我们自己的驱动程序的过时版本）。

不包括宽行的原因是 cassandra 团队自己不鼓励使用它们，而是建议使用复合列，因为它们可以以更好的方式读取，并且不需要获取整个超列来获取部分数据。我意识到这并不总是那么容易，特别是如果有一个很久以前编写的应用程序。

接下来，

你是对的，现在你应该指定名字。我不知何故没有预见到生成的列名。

In order to fetch all the columns, you have to use SlicePredicate, and specify empty byte buffers and slice start and slice finish of SliceRange you pass into it. So you can set SliceRange (.setSlice_range) instead of (.setColumn_names), and it will be entirely same thing, you can make that change in CasssandraScheme.java [https://github.com/ifesdjeen/cascading-cassandra/blob/master/src/main/java/com/clojurewerkz/cascading/cassandra/CassandraScheme.java#L247](https://github.com/ifesdjeen/cascading-cassandra/blob/master/src/main/java/com/clojurewerkz/cascading/cassandra/CassandraScheme.java#L247) if you decide to stick to our tap. What I'd do, is when there're no column names specified, we just fetch all of them.

Another change that's going to be required is deserialization of values. Probably here you have a better feeling about how to deal with wide rows. In essence, you get a response like:

Key / {java.nio.HeapByteBuffer[pos=65 lim=70cap=93]=org.apache.cassandra.db.Column@478bb374}

So format would be pretty much the same. Here, you only have to deserialize key and convert column into the tuple. If amount of key-value pairs within a column varies, you'll have to fill it up (probably) with nulls, otherwise it could be hard to understand/debug.

Once again, if you decide to go with out tap, you'd have to upgrade to Cassaforte beta10 snapshot, (at least for initial tests) remove midje from project.clj and comment out everything related to it.

If you like, you can use cassaforte code to populate a smaller dataset (i usually go with a couple of records): [https://github.com/clojurewerkz/cassaforte/blob/master/test/clojurewerkz/cassaforte/thrift/core_test.clj#L26](https://github.com/clojurewerkz/cassaforte/blob/master/test/clojurewerkz/cassaforte/thrift/core_test.clj#L26)

# php - 有没有更有效的方法在 php 中查找数组中的元素？

> ID：13463696
> 
> 赞同：0
> 
> 时间：2012-11-19T22:43:55.630
> 
> 标签：php, arrays

我每天必须检索国际数据库的数千条记录，但我必须将每一条记录与我的数据库进行比较，以避免在我的数据库中注册重复的记录。实际上我正在使用该功能

```
in_array($element,$myarray) 
```

所以我正在寻找一种更有效的方法来验证一个元素是否已经在我的数组中。

我希望你能帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:47:30.303

您可以创建两个数组并使用`array_diff`.

`array_diff`会给你一个包含不同值的数组作为回报。

[在array_diff](http://php.net/manual/en/function.array-diff.php)中查看更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:47:20.207

我相信这是处理这个问题的最快方法。`for`唯一的其他几种方法是使用类似or的东西来遍历数组`foreach`，或者`serializing`使用数组来遍历数组`strstr`。但这些选项听起来效率不高。[这里](https://stackoverflow.com/questions/324665/which-is-faster-in-array-or-a-bunch-of-expressions-in-php)有一篇关于解析时间的好文章

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:12:03.323

您可以将元素放在键中：

```
$myarray[$element] = true; 
```

然后你可以检查它

```
if ($myarray[$element]) 
```

在[哈希表](http://nikic.github.com/2012/03/28/Understanding-PHPs-internal-array-implementation.html)中的查找应该比在数组值中的搜索快得多。

# qt4.8 - 我有一个定义为 QMap 的数据结构 ，我该如何按值排序？

> ID：13463698
> 
> 赞同：1
> 
> 时间：2012-11-19T22:43:57.573
> 
> 标签：qt4.8

我有一个随机生成的整数列表并用这些值填充了一个 QMap 但我想让 QMap 按值排序

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T06:45:20.070

这是一个演示如何`QMap <int, int>`在 qt C++ 中按值而不是按键对 a 进行排序。

QMap 的值被提取并存储在 QList 容器对象中，然后通过 qSort 方法进行排序。密钥也自己存储在 QList 中。排序完成后，QMap 对象被清空，键和值按值升序插入 QMap 容器中。请参阅下面的解决方案：

```
#include <QCoreApplication>
#include <qalgorithms.h>
#include <QMap>
#include <QDebug>
#include <QList>

int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);
    QMap <int, int> dataMapList;
    //QMap <int, int> sorted = new QMap<int, int>();
    QList <int> keys; // container to store all keys from QMap container
    QList<int> values; // container to store all values from QMap container
    QMap<int, int>::Iterator h; // used to loop/ iterate through QMap

    // used to iterate through QLists
    QList<int>::Iterator i; //
     QList<int>::Iterator j;

     //inserts to QMap Container
    dataMapList.insert(1,34);
    dataMapList.insert(3,2);
    dataMapList.insert(2,32);
    dataMapList.insert(14,89);
    dataMapList.insert(7,23);

    h=dataMapList.begin();

     qDebug()<< "unsorted";
    //list out the unsorted values along with their respective keys
    while(h!=dataMapList.end()){
        qDebug() << "[" << h.key()<<"], " <<"[" <<h.value()<<"]" << endl;
        h++;
    }

    values = dataMapList.values(); // pass all values in the QMap to a QList container to store values only
    keys= dataMapList.keys(); // pass all keys in the QMap to a QList container to store already sorted by default keys

    qSort(values); // sorts the values in ascending order
    dataMapList.clear(); // empties the QMap

    i=values.begin();
    j=keys.begin();

    // insert back the sorted values and map them to keys in QMap container
    while(i!=values.end() && j!=keys.end()){

        dataMapList.insert(*j, *i);
        i++;
        j++;
    }

    qDebug() << "sorted" << endl;
    h=dataMapList.begin();
    //the display of the sorted QMap
    while(h!=dataMapList.end()){
        qDebug() << "[" << h.key()<<"], " <<"[" <<h.value()<<"]" << endl;
        h++;
    }

    return a.exec();
} 
```

注意：QMap 和 QList 的迭代器用于遍历容器以访问存储的值和/或键。这些也有助于显示列表中的项目（未排序和排序）。该解决方案是在 Qt 控制台应用程序中完成的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T00:07:03.710

默认情况`QMap`下，项目总是按键排序。所以，如果你像这样迭代`QMap`：

```
 QMap<int, int>::const_iterator i = yourQMap.constBegin();
 while (i != yourQMap.constEnd()) {
     cout << i.key() << ": " << i.value() << endl;
     ++i;
 } 
```

你会得到按键排序的结果。

试着考虑改变你的任务以适应标准算法。否则，您可以使用此方法对标题进行排序：

```
QList<int> list = yourQMap.values();
qSort(list.begin(), list.end()); 
```

然后，如果您需要 - 通过调用 method 获取关联的键`QMap::key(const T &value);`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-12T21:45:42.050

根据具体情况，另一种选择是简单地交换键和值，因为键将自动按`QMap`. 在大多数情况下，这些值不会是唯一的，因此只需使用 a`QMultiMap`代替。

例如，假设我们在 QMap 中有以下数据：

```
Key       Value
---       -----
1         100
2         87
3         430
4         87 
```

以下代码将按值对数据进行排序。

```
QMap<int, int> oldMap;
QMultiMap<int, int> newMap;
QMapIterator<int, int> it(oldMap);

while (it.hasNext())
{
    it.next();
    newMap.insertMulti(it.value(), it.key()); //swap value and key
} 
```

我们的新地图现在看起来像这样：

```
Key       Value
---       -----
87        4
87        2
100       1
430       3 
```

# windows - 在设定的时间在 cmd 中替换桌面背景

> ID：13463699
> 
> 赞同：1
> 
> 时间：2012-11-19T22:43:59.143
> 
> 标签：windows, batch-file, cmd, wallpaper, desktop-background

我正在考虑在设定的时间使用 .bat 更改我的桌面背景。（即早上 6:00 到下午 6:00 有背景，然后从下午 6:00 到早上 6:00 有不同的背景）

我认为沿着这条线的东西会起作用，但我以前从来没有专门在dos上编程过，所以我不知道它是否会起作用。

```
IF Time <= 12:00:00.00 THEN
reg add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d "C:\Users\Pictures\Pic1.jpg" /f
Else
reg add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d "C:\Users\Pictures\Pic2.jpg" /f 
```

我是一个完全的编程新手，所以请解释你创建的任何内容。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:50:44.440

在 windows 中设置两个计划任务来运行独立的脚本，一个在早上 6 点运行，一个在下午 6 点运行。

在 cmd 文件中输入以下行，将 Image1.bmp 的路径替换为您选择的文件名和路径。

```
reg add “HKEY_CURRENT_USER\Control Panel\Desktop” /v Wallpaper /t REG_SZ /d E:\photos\image1.bmp /f
RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters 
```

# html - URL 框架破坏响应式网站

> ID：13463705
> 
> 赞同：3
> 
> 时间：2012-11-19T22:44:44.243
> 
> 标签：html, css, url, responsive-design, zurb-foundation

我正在使用 Zurb Foundation 创建一个单页响应式网站。该页面位于 foo.com/event.php，但我有一个单独的域 (event.com)，其 url 框架记录指向 foo.com/event.php 页面。这是问题所在：当我在 iOS 上访问 foo.com/event.php 时，移动优化版本正确显示。但是当我访问 event.com 时，会加载桌面版本。不知何故，网址框架正在破坏响应能力。奇怪的是，如果我在桌面浏览器上访问 event.com，我可以通过调整窗口大小来启动响应式布局。

我该如何解决这个问题？请记住，我对 js 和 css 媒体查询知之甚少。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-28T12:19:30.720

我今天偶然发现了这个问题，有些公司为了工作而提供基于框架集的 web 应用程序，这有点奇怪。可悲的是，我要尽最大努力做到最好。无论如何，我对此的解决方案是简单地将这个元标记添加到包含框架集的首页的头部：

```
<meta name="viewport" content="width=device-width,initial-scale=1"> 
```

# jquery - 如何将回调传递给 jQuery .click()？甚至是我需要的回调吗？

> ID：13463706
> 
> 赞同：2
> 
> 时间：2012-11-19T22:44:50.490
> 
> 标签：jquery, callback

我有一个点击事件，它根据下拉选择将用户带到一个 URL。但是，在我重定向用户之前，我想调用一个标记脚本来捕获用户所做的选择。这是一个第三方脚本，所以我认为我遇到了一些时间问题。

这是我的代码：

```
$('#submitCity').click(function(){

        //trigger tags
        var countrySelected = $country.val();
        var citySelected = $city.val();

        s.linkTrackVars='prop3,prop4,eVar3,eVar4,eVar6';
        s.prop3 = 'Visitor Action';
        s.prop4 = 'Home City Selected - ' + countrySelected + ', ' + citySelected;
        s.eVar3 = 'Visitor Action';
        s.eVar4 = 'Home City Selected - ' + countrySelected + ', ' + citySelected;
        s.tl(this,'o','Home City Selected - ' + countrySelected + ', ' + citySelected);

        //Link to appropriate city
        setTimeout(function() {
            location.href = "http://www.someURL.com/" + citySelected;
        }, 1000);
    }); 
```

大约一半的时间一切都按预期工作。捕获标签并成功重定向用户。但是，在另一半时间，click 事件会抛出错误，因为对象“s”未定义。我假设这是由于 location.href 在定义“s”对象之前触发的时间问题。

我的问题是，我是否要创建一个回调，以便在设置标签之前不会出现 location.href？我不喜欢使用 setTimeout，因为时间对我来说是任意的。我宁愿确保重定向总是等到标签被触发。

我想将回调函数传递给点击事件吗？还是我完全走错了路？对此问题的任何解决方案表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:46:11.303

您需要防止默认操作：

```
$('#submitCity').click(function(event){
    event.preventDefault(); 
```

但是我建议不要以这种方式拦截点击事件，因为它会阻止用户在他们想要的情况下在新窗口中打开链接。最好将它们发送到进行跟踪的重定向页面。

# javascript - 使用 Fancybox 的当前图像作为文档标题

> ID：13463708
> 
> 赞同：0
> 
> 时间：2012-11-19T22:44:59.327
> 
> 标签：javascript, php, jquery, jquery-events, fancybox-2

我目前正在建立一个网站，帖子上有一个图片库。我的问题是：

如何获取当前图像的标题属性，并将其设为文档标题。

解释：

当图像一，标题为“美丽，不是吗？” 在图库中打开，文档标题为“Beautiful, 不是吗？”。然后，当图像二时，标题为“伙计！那场车祸太可怕了！” 在图库中，文档标题是“伙计！那场车祸太可怕了！”。这是一个画廊，因此可以在 FancyBox 中推进图像，并且在更改为新图像时，文档标题会更改为新图像。当 FancyBox 关闭时，文档标题返回到之前（如果需要，可以在文档开头的变量中定义）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:47:33.470

```
document.title = 'This is easy!'; 
```

升级版：

看看回调[http://fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)

```
$(document).ready(function() {
    var origTitle = document.title

    $("#single_1").fancybox({
          helpers: {
              title : {
                  type : 'float'
              }
          },
          afterShow: function() {
            document.title = $(this).attr('title');
          },
          afterClose: function () {
             document.title = origTitle;
          }
      });
}); 
```

[http://jsbin.com/olufus/1](http://jsbin.com/olufus/1)上的完整代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:09:03.980

例如。[http://jsfiddle.net/ZJcD9/show/](http://jsfiddle.net/ZJcD9/show/)

代码[http://jsfiddle.net/ZJcD9](http://jsfiddle.net/ZJcD9)

```
$(document).ready(function() {

  title = document.title;

  $(".fancybox").attr('rel', 'gallery').fancybox({
        beforeLoad: function() {
            document.title = this.title;
        },
        beforeClose: function() {
            document.title = title;
        }
    });
}) 
```

# xcopy - XCOPY：有没有办法只得到一个特定的日期？

> ID：13463714
> 
> 赞同：1
> 
> 时间：2012-11-19T22:45:23.130
> 
> 标签：xcopy

xcopy 中是否有一种方法可以获取一个特定日期而不是日期以及比 /d:mm-dd-yyyy 中的日期更新的所有文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T14:10:40.937

如果您使用的是 Vista/Win7/WinServer2008，您可以像这样使用 robocopy：

robocopy c:\source c:\destination *。*/MAXAGE:[结束日期] /MINAGE:[开始日期]

例如。

robocopy c:\source c:\destination *。*/MAXAGE:20130311 /MINAGE:20130101 (YYYY.MM.DD)

如果您只想要一个日期，只需将这些值设置为相同。如果要复制特定文件类型，只需更改*.* 位到 *.docx 例如复制所有 word 文档等。

在 XP 上，我不确定是否有没有使用 Powershell 等的内置解决方案。

# xml - xsl 1.x 如何根据选择更改输出？

> ID：13463715
> 
> 赞同：1
> 
> 时间：2012-11-19T22:45:28.970
> 
> 标签：xml, xslt, xpath

这是我尝试过的，否则总是有效的。如果 type = 'WEEKLY' 我需要它输出“W”

```
 <xsl:for-each select="times/weekly_monthly">
    <tr>
  <td>
  <xsl:choose>
  <xsl:when test="type='WEEKLY'">W</xsl:when>
  <xsl:otherwise>
  otherwise always works
  </xsl:otherwise>
  </xsl:choose>
  </td>

  </tr>
</xsl:for-each> 
```

如果我取出选择，它会很好地迭代。这是xml

```
 <?xml version="1.0" encoding="ISO-8859-1"?>
        <?xml-stylesheet type= "text/xsl" href= "test.xsl"?>  

        <!-- Edited by XMLSpy® -->

        <times>
        <weekly_monthly>
        <type>
        WEEKLY
        </type>
        </weekly_monthly>
        <weekly_monthly>
        <type>
        MONTHLY
        </type>
        </weekly_monthly>
        <weekly_monthly>
        <type>
        NULL
        </type>
        </weekly_monthly>
        </times> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:51:04.707

这是因为`<type>`节点包含空格。使用`normalize-space()`函数，即：

```
normalize-space(type) = 'WEEKLY' 
```

或`contains()`功能：

```
contains(type, 'WEEKLY') 
```

# memory - presta shop - 显示在产品页面上使用了多少内存

> ID：13463720
> 
> 赞同：0
> 
> 时间：2012-11-19T22:45:54.850
> 
> 标签：memory, limit, prestashop

我有基于 PrestaShop 的在线商店，拥有大量的产品属性。大约 10-20k... 有内存问题。在产品页面上，Presta 构建了这个包含所有属性组合的大 JS 数组，256MB 的内存太少了，但 512 还可以。我想知道我现在使用了多少内存（接近 256 或 512），因为我想创建更多的属性组合。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:04:18.983

在这种情况下，您可以在上传之前手动减小图像的大小，或者您可以通过搜索和更改 php.ini 中的 memory_limit 设置来增加内存限制，或者如果它不存在则添加它：

```
; Set memory limit in megabytes
memory_limit = 128M 
```

# php - 正则表达式：PHP 的后视固定长度断言限制的解决方法

> ID：13463723
> 
> 赞同：1
> 
> 时间：2012-11-19T22:46:03.457
> 
> 标签：php, regex, assert

我试图了解更多关于环视断言的信息，我发现[了这个线程](https://serverfault.com/questions/172496/regex-negative-matching-trouble)，他们的解决方案应该适用于某些引擎，但不适用于 PHP，因为 PHP 要求环视断言是固定长度的。

我想要的是使相同的场景在 PHP 中工作，或者至少知道它是否可能。

我试图减少正则表达式规则的解释，所以它与我上面提到的线程中的不同，但它遵循相同的原则。

需要匹配一个字符串，内置三部分：

*   以任意数量的字母数字字符开头
*   不包含“abc-”后跟 3 到 5 个数字和/或连字符
*   以“.htm”或“.html”结尾

因此，这些将匹配：

*   xxxyz-123.html
*   xx123-abc.htm
*   xxabc123.html
*   xxabc-123-45.htm

但这些不匹配：

*   xxabc-4324.htm
*   xxabc-1-2.html
*   xxac-12-34.txt
*   xxabc-12345.htm

我一直在尝试下面的正则表达式模式的一些变体，但它不起作用 - 由于固定长度限制，这种特殊情况：

`.*(?<!abc-[\d-]{3,5})\.htm[^l]?$`

我还使用了不同的测试字符串，忘记了 3-5 范围部分，只关注 3 个数字和/或连字符，并使用了下面的正则表达式，但它仍然不起作用，这就是为什么我决定寻求帮助：

`.*(?<!abc-[\d-]{3})\.htm[^l]?$`

你们中的任何人都可以在这里帮助我吗？

**编辑**

这是我的测试 PHP 代码：

```
$regex = "/^(?!.*abc-[\d-]{3,5})[a-zA-Z0-9-]+\.html?$/";

foreach ( $matching2 as $k => $v ) {
    $matches = preg_match( $regex, $v );

    echo '"', $v, '"', ( $matches != 0 ) ? ' matches' : ' doesn\'t match', '<br />';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:49:27.007

为什么你需要反过来看？为什么不只使用前瞻？

```
^(?!.*abc-[\d-]{3,5}[^\d-])[a-zA-Z0-9-]+\.html?$ 
```

这将简单地开始查看字符串的开头，并且前瞻尝试在字符串中的任何位置 ( `.*`) 找到不允许的字符串。如果是这样，前瞻会使模式失败。这还包括要求，该字符串仅由字母数字和连字符组成。

顺便说一句，这与您链接的问题使用的解决方案相同。Perl 也不能处理可变长度的lookbehinds。**只有**.NET 可以。

另一个注意事项：如果你遇到一个例子，你确实**需要**一个可变长度的lookbehind（但不是一个可变长度的lookahead）......反转字符串（当然还有模式）。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:28:25.547

您可能正在寻找正则表达式模式

```
^(?!.*abc-[\d-]{3,5}[^\d-])[A-Za-z0-9].*[.]html?$ 
```

# android - readBooleanArray 抛出 RuntimeException("bad array lengths")

> ID：13463727
> 
> 赞同：2
> 
> 时间：2012-11-19T22:46:20.197
> 
> 标签：android, boolean, parcelable, runtimeexception

我知道 parcelable 隐藏了一些秘密，但没想到我现在需要知道它们。

这是我之前的代码：

```
...
parcel.writeBooleanArray(new boolean[]{booleanValue1, booleanValue2, booleanValue3});
....

boolean[] booleans = new boolean[3];
in.readBooleanArray(booleans);
... 
```

不知何故，它停止在除我之外的许多设备上工作，所以我无法重现它。然后我决定将其更改为：

```
 ...
    parcel.writeBooleanArray(new boolean[]{booleanValue1});
    parcel.writeBooleanArray(new boolean[]{booleanValue2});
    parcel.writeBooleanArray(new boolean[]{booleanValue3});
        ...

    boolean[] booleans1 = new boolean[1];
    boolean[] booleans2 = new boolean[1];
    boolean[] booleans3 = new boolean[1];
    in.readBooleanArray(booleans1);
    in.readBooleanArray(booleans2); // it crashes here
    in.readBooleanArray(booleans3);
        .... 
```

包裹源代码：

```
public final void readBooleanArray(boolean[] val) {
    int N = readInt();
    if (N == val.length) {
        for (int i=0; i<N; i++) {
            val[i] = readInt() != 0;
        }
    } else {
        throw new RuntimeException("bad array lengths");
    }
} 
```

LogCat 错误：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.my/com.my.activities.MyActivity}: java.lang.RuntimeException: bad array lengths
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1970)
    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995)
    at android.app.ActivityThread.access$600(ActivityThread.java:128)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4517)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
    at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.RuntimeException: bad array lengths
    at android.os.Parcel.readBooleanArray(Parcel.java:619) 
```

所以我猜我需要将代码更改为：

```
...
parcel.writeBooleanArray(new boolean[]{booleanValue1, booleanValue2, booleanValue3});
....

boolean[] booleans1 = new boolean[1];
boolean[] booleans2 = new boolean[1];
boolean[] booleans3 = new boolean[1];
in.readBooleanArray(booleans1);
in.readBooleanArray(booleans2);
in.readBooleanArray(booleans3);
.... 
```

但它会有帮助吗？

还有 Parcel.createBooleanArray() 的用途是什么返回 boolean[]; 也许我需要通过这种方法创建布尔数组，然后使用 writeBooleanArray(boolean[])？但这对我来说没有意义......为什么它可以在某些设备上运行而不能在其他设备上运行......

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T07:45:31.017

实际上我找到了解决问题的方法，但没有回答另一个[问题](https://stackoverflow.com/questions/6201311/how-to-read-write-a-boolean-when-implementing-the-parcelable-interface)：

以下是您如何在 Pracelable 中使用布尔值：

```
.....
// Write:
out.writeByte((byte) (booleanValue ? 1 : 0));

....

// Read:
boolValue = in.readByte() == 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-24T15:51:56.430

如果包裹中有一个数组，则`write.....Array`函数首先将数组的大小写为 an `int`，然后是值（如果是布尔值，则为`int`s，为 0 或 1）。因此，如果您使用 1 长度数组调用该函数 3 次（因为第一个写入 4 个整数，第二个读取 6 个整数），则无法返回 3 长度数组。

如果您调用 ，您可以轻松取回您的布尔值`parcel.createBooleanArray()`，这将返回您放入包裹中的数组`parcel.writeBooleanArray(boolean[])`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T00:51:35.883

在您开始从 Parcel 实例读取之前调用该`setDataPosition`方法。

例如。

```
in.setDataPosition(0); 
```

# perl - 根据第二个数组从数组中删除元素

> ID：13463738
> 
> 赞同：4
> 
> 时间：2012-11-19T22:47:17.913
> 
> 标签：perl

我有一个数组中的文件名前缀`@list1`列表和第二个数组中的完整文件名列表`@list2`。最后，我想得到第三个数组，其中仅包含与 . 中的前缀不匹配的完整文件名`@list1`。我开始了：

```
for my $match (@list1) {
  @list3 = grep { !/$match/ } @list2;
} 
```

但它没有做我认为它会做的事情。我有什么选择才能得到我正在寻找的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T23:58:12.977

也许交替正则表达式会有所帮助：

```
use strict;
use warnings;

my @list1 = qw/a.f c data g j/;
my @list2 = qw/myfile.txt a.file.txt data.txt otherfile.txt jargon.txt/;

my $regex = join '|', map "\Q$_\E", @list1;

my @list3 = grep !/^(?:$regex)/, @list2;

print "$_\n" for @list3; 
```

输出：

```
myfile.txt
otherfile.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T11:21:52.490

如果您想使用更像列表表达式的方式（如您的示例中所示），您可以使用以下方法：

```
#!/usr/bin/env perl

use strict;
use warnings;
use List::Util 'first';
use feature 'say';

my @filenames = qw(foo bar baz quux alice bob);
my @forbidden = qw(f ba);

my @matching  = grep {
    my $filename = $_;
    not defined first { $filename =~ /^\Q$_/ } @forbidden;
} @filenames;

say for @matching; 
```

输出：

```
quux
alice
bob 
```

**注意**：我`first`在这里使用了 core- 而不是 core- `grep`，因为对于长`@forbidden`列表，它可能会更有效，因为它在第一个（并且可能只有一个）匹配后停止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:03:55.993

```
#!/usr/bin/perl

use strict;
use warnings;

my @prefixes = qw(a b d);
my @items = qw(apple banana cow dog fruitcake orangutan crabcake deer);

my @nonmatching;
ITEMS: foreach my $item (@items) {
    foreach my $prefix (@prefixes) {
        next ITEMS if ($item =~ /^$prefix/)
    }
    push @nonmatching, $item
}

$,=$\="\n";
print @nonmatching; 
```

产量

```
cow
fruitcake
orangutan
crabcake 
```

根据raina77ow 的建议进行编辑。

# objective-c - UIWebView - 通过 UIWebView 将本地音频文件加载到 html 中

> ID：13463743
> 
> 赞同：1
> 
> 时间：2012-11-19T22:47:45.953
> 
> 标签：objective-c, cocoa-touch, uiwebview, uiwebviewdelegate

我正在尝试将本地 mp3 文件的路径发送到 javascript，并从那里创建一个填充有源的音频标签。但是，当我尝试此操作时，会出现“无法播放音频文件”消息。文件本身来自应用程序特定的沙箱，因此路径看起来像这样

**/Users/username/Library/Application Support/iPhone Simulator/6.0/Applications/818263D7-4246-4DEC-9186-6AC14F0175A3/Documents/audiofile.mp3**

问题是我可以使用相同的方法从桌面播放 mp3，而不是存储在应用程序本身的沙盒或本地文件系统中的 mp3。这是我用来获取路径并通过 webview 将其发送到 javascript 的代码。任何帮助将不胜感激。

```
UIWebView *webContainer = [[UIWebView alloc] initWithFrame: self.view.bounds];
webContainer.backgroundColor = [UIColor grayColor];
webContainer.autoresizingMask = ( UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight );
[webContainer setBackgroundColor:[UIColor clearColor]];
webContainer.delegate = self;
[self.view addSubview:webContainer];

NSString *imagePath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,         NSUserDomainMask, YES) objectAtIndex:0];

NSString *imPath = [NSString stringWithFormat:@"%@/angels.mp3",imagePath];
imPath = [imPath stringByReplacingOccurrencesOfString:@" " withString:@"%20"];

[webContainer stringByEvaluatingJavaScriptFromString:[NSString stringWithFormat:@"setupAudio('%@');", imPath]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:01:10.167

如果您的路径以“audiofile.mp3”结尾，我认为文件“angels.mp3”不会播放。

但是您可以只使用[MPMoviePlayerController](http://developer.apple.com/library/ios/#DOCUMENTATION/MediaPlayer/Reference/MPMoviePlayerController_Class/Reference/Reference.html)来播放文件：

```
NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,             NSUserDomainMask, YES) objectAtIndex:0];

NSString *audioPath = [NSString stringWithFormat:@"%@/angels.mp3",docPath];

MPMoviePlayerController* moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL: audioPath];

[moviePlayer.view  setFrame:self.view.bounds]; 

//add it to your view
[viewController.view addSubview:moviePlayer.view];

//if you don't want any controls
[moviePlayer setControlStyle:MPMovieControlStyleNone];

//play!
[moviePlayer prepareToPlay]; 
```

[来自一些](http://jinru.wordpress.com/2011/11/01/an-easy-way-to-play-streaming-audio-using-mpmovieplayercontroller/)示例的修改源。

可以在[此处](https://stackoverflow.com/questions/9802403/how-to-play-local-video-file)找到有关此主题的其他一些方便的相关问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T23:10:11.763

如果您必须使用 a `UIWebView`，并且只想使用音频文件，则可以使用 URL 请求直接加载它（*当然，请确保该文件存在于该 URL 处！*）。

```
NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *audioPath = [NSString stringWithFormat:@"%@/angels.mp3",docPath];

NSURL *url = [NSURL fileURLWithPath:audioPath isDirectory:NO];
NSURLRequest *request = [NSURLRequest requestWithURL:url];

[webContainer loadRequest:request]; 
```

# vb.net - 解析多个命名命令行参数

> ID：13463744
> 
> 赞同：6
> 
> 时间：2012-11-19T22:47:47.823
> 
> 标签：vb.net, command-line

通过命令行打开程序时，我需要向程序添加接受多个命名参数的能力。IE

```
program.exe /param1=value /param2=value 
```

然后能够将这些参数用作程序中的变量。我找到了几种方法来完成其中的一部分，但似乎无法弄清楚如何将它们组合在一起。

我已经能够传递一个命名参数并使用下面的代码恢复它，虽然我可以为每个可能的命名参数复制它，但我知道这不是首选的方法。

```
 Dim inputArgument As String = "/input="
    Dim inputName As String = ""

    For Each s As String In My.Application.CommandLineArgs
        If s.ToLower.StartsWith(inputArgument) Then
            inputName = s.Remove(0, inputArgument.Length)
        End If
    Next 
```

或者，我可以使用从命令行获取多个未命名参数

```
My.Application.CommandLineArgs 
```

但这要求每次都以相同的顺序/格式传递参数。我每次都需要能够传递随机的参数子集。

最终，我想做的是将每个参数和值分开，并将其加载到多维数组中以备后用。我知道我可以通过分隔“=”处的字符串并剥离“/”来找到一种方法，但由于我对此有些陌生，我想看看是否有一种“首选”的处理方式有多个命名参数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T23:00:24.647

我对处理这个问题的偏好是使用现有的库，例如[Command Line Parser Library](http://commandline.codeplex.com/)。（但是，默认情况下，它使用[不同的输入格式](http://commandline.codeplex.com/wikipage?title=Input%20Specification&referringTitle=Home)，基于`--input=Value`而不是`/input=value`。）

这使您不必自己编写代码，获得很大的灵活性和健壮性，并简化您的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-29T21:11:03.790

这是一个小功能，可以做你想做的事。它允许您将所有参数存储在结构中的名称-值对中。

```
Module Module1
Private Structure NameCommandLineStuct
    Dim Name As String
    Dim Value As String
End Structure
Private CommandLineArgs As New List(Of NameCommandLineStuct)

Sub Main()
    If ParseCommandLine() Then
        For Each commandItem As NameCommandLineStuct In CommandLineArgs
            Select Case commandItem.Name.ToLower
                Case "one"
                    Console.Write(String.Format("key one is {0}", commandItem.Value))
                Case "two"
                    Console.Write(String.Format("key two is {0}", commandItem.Value))
            End Select
        Next
    End If
End Sub
Function ParseCommandLine() As Boolean
    'step one, Do we have a command line?
    If String.IsNullOrEmpty(Command) Then
        'give up if we don't
        Return False
    End If

    'does the command line have at least one named parameter?
    If Not Command.Contains("/") Then
        'give up if we don't
        Return False
    End If
    'Split the command line on our slashes.  
    Dim Params As String() = Split(Command, "/")

    'Iterate through the parameters passed
    For Each arg As String In Params
        'only process if the argument is not empty
        If Not String.IsNullOrEmpty(arg) Then
            'and contains an equal 
            If arg.Contains("=") Then

                Dim tmp As NameCommandLineStuct
                'find the equal sign
                Dim idx As Integer = arg.IndexOf("=")
                'if the equal isn't at the end of the string
                If idx < arg.Length - 1 Then
                    'parse the name value pair
                    tmp.Name = arg.Substring(0, idx).Trim()
                    tmp.Value = arg.Substring(idx + 1).Trim()
                    'add it to the list.
                    CommandLineArgs.Add(tmp)
                End If
            End If
        End If

    Next
    Return True
End Function
End Module 
```

# file - 实现文件系统的基础知识

> ID：13463745
> 
> 赞同：4
> 
> 时间：2012-11-19T22:47:53.453
> 
> 标签：file, unix, directory, system, implementation

我目前的操作系统课程项目是设计和实现一个基本的文件系统。我已经阅读了我们书中关于文件系统的章节，但我不知道从哪里开始。我知道一些需要的结构（文件控制块、系统范围的打开文件表、每个进程打开的文件表、r+w 缓冲区、目录结构），以及我需要支持的操作（打开、读取、写入、删除，创建，关闭）。

我已经获得了一个 10MB 的“驱动器”来实现里面的文件系统。任何有关资源或直接答案的帮助将不胜感激。

编辑：这是作业的链接[https://www.dropbox.com/s/971ec21u3yn62wz/Laboratory%20Project%204_5%20Creating%20a%20File%20System.pdf](https://www.dropbox.com/s/971ec21u3yn62wz/Laboratory%20Project%204_5%20Creating%20a%20File%20System.pdf)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T23:12:33.353

你问了一个非常广泛的问题。而且还不清楚您是否必须实现一个真正的文件系统，但现在看起来您需要实现您的教授定义的一组操作。

你写：

> 我知道一些需要的结构（文件控制块、系统范围的打开文件表、每个进程打开的文件表、r+w 缓冲区、目录结构）

在我看来，你专注于错误的事情。这些是实际操作系统用来支持对文件系统的有效访问的内存结构。

*   **文件控制块**- 您的版本可能*非常*简单
*   **系统范围的打开文件表**- 您不需要它来支持单个用户
*   **每个进程的打开文件表**- 你只需要一个，它可能非常简单。
*   **r+w 缓冲区**- 这是一种性能增强，不是分配严格要求的，如果需要，可以稍后添加。
*   **目录结构**- 啊，现在你开始做点什么了。

我读到作业中提到的“目录结构”是指磁盘结构。这就是你可能需要关注的。你有一大块存储空间，你需要分发小块。所以你需要编写一个存储分配器。真正困难的部分是设计磁盘结构。您必须跟踪哪些块是免费的。文件可以被删除，所以你会发现漏洞。两种简单的方法是使用位图或连续可用空间列表。无论您选择哪种方法，它们都将成为您希望选择另一种的代码的一部分。

您还需要一个结构来跟踪名称。当用户创建一个文件时，他会命名它。为了稍后打开文件，他给出了相同的名称。需要磁盘结构来支持这一点。还有其他元数据：最后修改日期（您的作业特别需要这个）、文件大小、数据位置。您可以使用分配器来获取存储元数据的空间。

通常在存储的开头（或附近）有一个固定块来保存配置信息和指向加载文件系统所需的其他存储的指针。

对于 Unix 文件系统概念的一个很好的概述，我可以推荐 Marshall Kirk McKusick 和 George V. Neville-Neil 的“The Design and Implementation of the FreeBSD Operating System”，第 8 章本地文件系统。

[http://www.amazon.com/Design-Implementation-FreeBSD-Operating-System/dp/0201702452](https://rads.stackoverflow.com/amzn/click/com/0201702452)

特别是这些子章节：

*   8.8\. 本地文件存储
*   8.3\. 命名
*   8.9。伯克利快速文件系统

这有助于单独考虑存储分配和命名。

您的作业页面包含一些很好的参考资料。我有机会查看了[Practical File System Design](http://www.nobius.org/~dbg/)，作者在网上慷慨地发布了它。我可以特别推荐这些章节：

*   第 4 章 BFS 的数据结构
*   第六章 分配政策

加上也许：

*   附录 A 文件系统构建工具包

也许你遇到的问题是这个项目看起来很大而且势不可挡。将其分解成更小的部分确实很有帮助。如果您仍然迷路，请从实施您最了解的部分开始。

让我们回到你的任务的细节。它提到了这些文件系统约束：

*   文件最大为**16384**字节
*   磁盘上的分配单元或块是每个**512 字节**。
*   您的总存储区域为**2-10 MB**

在这种情况下，约束并不坏，它们很好，因为它们限制了您必须处理的内容并允许您走捷径。（我不再多说，因为弄清楚细节是你任务的重点。）

如果您仍然卡住，您可以将源代码读取到一个简单的文件系统，如 FAT。这是 FAT 的一个非常容易理解的描述：

[http://www.pjrc.com/tech/8051/ide/fat32.html](http://www.pjrc.com/tech/8051/ide/fat32.html)

（另请查看维基百科。）

以下是用于嵌入式应用程序的 FAT 的 C 实现的链接：

[http://ultra-embedded.com/?fat_filelib](http://ultra-embedded.com/?fat_filelib)

源代码只有大约 5K 行。

祝你好运。

# css - 两个画布在一个 div 容器中相互叠加？

> ID：13463747
> 
> 赞同：4
> 
> 时间：2012-11-19T22:48:08.243
> 
> 标签：css, html

我一直试图让两个画布在另一个 div 中彼此叠放，但他们不会这样做。他们最终在彼此之下。

我设置它的方式是这样的：

```
.container{
    width:100%;
    height:300px;
    margin:0 auto;
}
.canvas{
    width:100%;
    height:100%;
    position:relative; 
    left: 0; 
    top: 0;
} 
```

用这个输出：

```
<div class="container">
  <canvas id="layer1" class="canvas" style="z-index:1;"></canvas>
  <canvas id="layer2" class="canvas" style="z-index:2;"></canvas>
</div> 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:50:45.960

父容器需要`position: relative`设置

相应地更改您的 CSS：

```
.container{
   width:100%;
   height:300px;
   margin:0 auto;
   position: relative; /* add */
}
.canvas{
   width:100%;
   height:100%;
   position:absolute; /* change */
   left: 0; 
   top: 0;
} 
```

然后将画布容器的类更改为`class="canvas"` 或将 CSS 更改为`canvas`不带点或如果您更喜欢将 CSS 类更改为`.c`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-19T22:51:50.590

首先，我认为您的课程被标记为`c`而不是`canvas`.

其次，相对需要更改为绝对（在您的画布上），以便它们可以相互浮动。

```
.canvas{
    width:100%;
    height:100%;
    position:absolute; 
    left: 0; 
    top: 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-19T22:50:48.237

将画布更改`position: relative`为`absolute`

```
.container{
    width:100%;
    height:300px;
    margin:0 auto;
    position:relative; /* this to make the canvases children of the div.container */
}

.canvas{
    width:100%;
    height:100%;
    position:absolute; /* this to position them */
    left: 0; 
    top: 0;
} 
```

# arrays - 如何制作 C#。在 highcharts 中具有多个系列数据数组的 svc

> ID：13463751
> 
> 赞同：0
> 
> 时间：2012-11-19T22:48:18.993
> 
> 标签：arrays, wcf, highcharts, svc

Highcharts 和 WCF 服务的新功能。我可以为 highcharts 制作一个系列或数据，但我似乎无法制作多个数据数组，所以我的系列有更多的一行。试图制作一个数组数组，以便我的系列中有多个数据项。在 jsFiddl 中，我可以使用以下代码使其看起来像我想要的那样：

```
$(function() {
var chart = new Highcharts.Chart({
    chart: {
        renderTo: 'container'
    },
    xAxis: {
        minPadding: 0.05,
        maxPadding: 0.05
    },

    series: [{
            name: 'Curve 1',
            data: [[150, 80], [155, 55], [159.5, 49.2],  [170, 45]]

        }, {
            name: 'Curve 2',
            data: [[160, 90], [165, 65], [170, 60],  [180, 55]]
        }]

}); 
```

});

我当前的 WCF .svc 文件将 JSON 序列化为 {"data":[[150,80],[155,55],[160,50],[170,45]]}

我想要一个具有多个数据“数组”的系列“数组”。

注意我已经研究过 DotNetHighcharts，但现在我不想使用它，因为我最终需要 onClick 事件作为图表上的一个点，而且我的理解是 DonNetHighcharts 不支持该事件。

对任何人的任何其他想法持开放态度。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T06:38:32.457

```
public class Series
{
    public string name;
    public List<Data> data;
    public Series()
    {
        data = new List<Data>();
    }
}

public class Data
{ 
    public string name { get; set; }
    public double y { get; set; }
    public string color { get; set; }

} 
```

并将 seriesList 的序列化对象设置为 highcharts 系列：

```
series= new JavaScriptSerializer().Serialize(SeriesList)); 
```

# .net - 当值存储在实际数据库中的一组 Int 字段中时，我可以在实体框架模型端使用单个 DateTime 字段吗？

> ID：13463754
> 
> 赞同：0
> 
> 时间：2012-11-19T22:48:39.303
> 
> 标签：.net, entity-framework, ado.net

数据库中的实际表具有单独的整数字段，用于存储、 、`year`和`month`值（均以 UTC 表示）（秒和毫秒与我的任务无关，被认为为零）。`day``hour``minute`

不用说，在应用程序端只有一个`DateTime`类型的字段，并将所有转换隐藏在实体框架模型代码的掩护下，将非常方便。

关于如何做到这一点的任何指示？我对实体框架还不是很有经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T22:55:40.247

我之前回答了一个类似的问题：[我可以使用 Data Annotations 或 Fluent 在数据存储和实体类之间转换值吗？](https://stackoverflow.com/questions/13454652/can-i-use-data-annotations-or-fluent-to-convert-a-value-between-data-store-and-e)

据我所知，目前这在 EF 中是不可能的。

您可以做的是公开一个未映射到数据库的辅助属性。

```
[NotMapped]
public DateTime DateTime
{
  get { return new DateTime( Year, Month, Day, Hour, Minute, 0, DateTimeKind.Utc); }
  set
  {
    Year = value.Year;
    Year = value.Year;
    Month = value.Month;
    Day = value.Day;
    Hour = value.Hour;
    Minute = value.Minute;
  }
} 
```

# azure - 使用 powershell 在 Azure 中更新服务配置设置

> ID：13463755
> 
> 赞同：2
> 
> 时间：2012-11-19T22:48:49.100
> 
> 标签：azure

我在 Azure 中运行了一个部署。我需要更改该部署的一个配置设置。使用 powershell 以编程方式执行此操作的最简单方法是什么。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-11-19T22:59:30.587

Powershell 最好更改设置，但还有更简单的方法可以做到这一点：

*   通过门户（这允许您修改 ServiceConfiguration.cscfg）
*   通过使用[CSRun.exe](http://msdn.microsoft.com/en-us/library/windowsazure/gg433001.aspx)（这允许您上传新的 ServiceConfiguration.cscfg 文件）

# actionscript-3 - 在 AS3 中，如何存储、检索和重用省略号 (...) 参数提供的参数？

> ID：13463759
> 
> 赞同：2
> 
> 时间：2012-11-19T22:49:14.430
> 
> 标签：actionscript-3, apache-flex, syntax, flash

我有一个继承自 NetConnection 的类，具有以下功能：

```
override public function connect(command:String, ... arguments):void
{
    addEventListener(NetStatusEvent.NET_STATUS, onNetStatus);
    super.connect(command, arguments);
} 
```

我想要做的实际上是这样的：

```
override public function connect(command:String, ... arguments):void
{
    m_iTries = 0;
    m_strCommand = command;
    m_arguments = arguments;
    addEventListener(NetStatusEvent.NET_STATUS, onNetStatus);
    super.connect(command, arguments);
}

private function onNetStatus(pEvent:NetStatusEvent):void
{
    if (/* some logic involving the code and the value of m_iTries */)
    {
        super.connect(m_strCommand, m_arguments);
    }
    else
    {
        // do something different
    }
} 
```

这在 AS3 中可能吗？如果是这样，怎么做？我将如何声明变量、设置变量、将其传递给函数等？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:17:37.520

像这样的东西`connect`：

```
 ...
 // Add m_strCommand to the start of the arguments array:
 m_arguments.unshift(m_strCommand); 
 ... 
```

并在`onNetStatus`：

```
if (/* some logic... */)
{
    // .apply calls the function with first parameter as the value of "this". 
    // The second parameter is an array that will be "expanded" to be passed as 
    // if it were a normal argument list:
    super.connect.apply(this, m_arguments);
} 
```

这意味着调用例如（虚假参数）：

```
myNetConnection.connect("mycommand", 1, true, "hello"); 
```

将导致此调用的金额来自`onNetStatus`：

```
super.connect("mycommand", 1, true, "hello"); 
```

更多关于`.apply()`：[http ://adobe.ly/URss7b](http://adobe.ly/URss7b)

# php - 谷歌地图上的多个标记：只显示最后一个标记

> ID：13463760
> 
> 赞同：0
> 
> 时间：2012-11-19T22:49:20.997
> 
> 标签：php, javascript, google-maps-api-3

我在地图上显示多个标记时遇到问题。代码首先遍历一个数组，然后在显示标记并将 infoWindow 的内容设置为返回的地址之前对 lat、lon 值进行反向地理编码。

我的代码如下。

```
for(var i=0; i < useNowArray.length; i++) {
        // plot useNow on map
        latlng = new google.maps.LatLng(useNowArray[i]['lat'], useNowArray[i]['lon']);
        console.log(useNowArray[i]['lat'] + useNowArray[i]['lon']);
        geocoder.geocode({'latLng': latlng}, function(results, status) 
        {
            if (status == google.maps.GeocoderStatus.OK) 
            {
                if (results[0]) 
                {
                    marker = new google.maps.Marker({
                        position: latlng,
                        map: map,
                        icon: 'http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png',
                        title: results[0].formatted_address
                    });
                    content = results[0].formatted_address;
                    console.log(content);

                    google.maps.event.addListener(marker, 'click', (function(marker, i) {
                        return function() {
                            infowindow.setContent(content);
                            infowindow.open(map, this);
                        }
                    })(marker, i));
                }
            } else {
                alert("Geocoder failed due to: " + status);
            }
        }); // end geocode function
    }  
    var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions); 
```

问题是只显示了我的最后一个标记。

我错过了什么？:(

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:43:57.777

您的标记变量是全局的，地理编码是异步的。循环执行，触发 useNowArray.length 请求，每个请求都使用结果位置更新全局标记。循环完成后，标记将留在循环中的最后一个位置。与该问题的解决方案类似的问题：

*   [Google Maps API v3 - 多个地理编码器请求后的 fitBounds](https://stackoverflow.com/questions/11336405/google-maps-api-v3-fitbounds-after-multiple-geocoder-requests)
*   [多个标记的问题（Google Maps API v3）](https://stackoverflow.com/questions/4266377/problem-with-multiple-markers-google-maps-api-v3)

# xamarin.ios - MonoTouch 对话框 - MessageElement

> ID：13463766
> 
> 赞同：1
> 
> 时间：2012-11-19T22:49:30.200
> 
> 标签：xamarin.ios, monotouch.dialog

我有一个 MT Dialog 控件，我在其中添加了以下内容。

```
Root
---->Section
--------->MessageElement
--------->MessageElement
--------->MessageElement
--------->MessageElement etc. 
```

问题是如何在 MessageElement 下添加字段，以便当用户单击 MessageElement 时，我得到表单字段。

```
var root = new RootElement("Jobs");
var section = new Section();
root.Add(section);
foreach(var job in jobItems) {

    var m = new MessageElement();
    m.Body=job.dbInstructions;
    m.Caption = "My Caption";
    m.Date = DateTime.Parse(job.dbDueDate);
    m.Subject=job.dbSiteVenueName;
    m.Sender=job.dbServiceGroup;
    section.Add(m);
}
var jobsDialog = new DialogViewController(root);
.. 
```

# jquery - Colorbox iframe - 隐藏特定的 div（面包屑）

> ID：13463767
> 
> 赞同：3
> 
> 时间：2012-11-19T22:49:37.677
> 
> 标签：jquery, iframe, colorbox

我正在使用 jquery colorbox 插件，并且正在将我网站上的内部页面加载到`iframe`.

这个页面也可以直接加载，例如从谷歌搜索。

这些页面上有一个面包屑。当页面作为 iframe 加载时，我想隐藏面包屑，因为面包屑是不必要的。仅当人们直接访问该页面时，面包屑才有用。

我已经阅读了这个问题：[Colorbox iframe - loading specific div only](https://stackoverflow.com/questions/11365710/colorbox-iframe-loading-specific-div-only)并试图隐藏一个特定的 div 但它不起作用。

我还在[Colorbox 上阅读了这个问题：从 iframe 加载特定的 div](https://stackoverflow.com/questions/9025937/colorbox-load-specific-div-from-iframe)并尝试仅加载面包屑下方的 div。

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T15:51:19.827

我找到了在颜色框中加载页面时隐藏面包屑的解决方案。您必须将 fastIframe 设置为 false 并添加一个 onComplete 函数。

> $(document).ready(function(){ $(".iframe").colorbox({ iframe:true, fastIframe:false, onComplete: function() { $("iframe").contents().find(" #backlinks").css("display","none");
> } }); });

# c# - 单击按钮后，如何使用 ASP .NET 更新网页上的标签？

> ID：13463773
> 
> 赞同：0
> 
> 时间：2012-11-19T22:49:50.347
> 
> 标签：c#, asp.net, ajax

这是一个非常简单的问题，是的，但我还不习惯 Web 开发（我主要是赢得应用程序）。

我有一个按钮可以做各种各样的事情。我希望它做的第一件事是：

```
lblStatus.Text = "In progress, please wait..."; 
```

问题是，当按下按钮时，这不会将标签的默认文本“就绪”更新为“进行中，请稍候...”。

我的问题是，我应该这样做还是应该使用 AJAX 之类的其他东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:53:17.853

如果您仍然使用 ASP.NET Ajax，则可以使用为此而设计的[`UpdateProgress`控件。](http://msdn.microsoft.com/en-us/library/bb386421%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T22:54:02.350

“进行中”部分是在回发时发生的。在您编写的代码中，“进行中”只会在回复返回时显示。

这与使用 JS 防止双击（和双发）类似的问题

参考：[javascript/jquery 禁用点击提交按钮，防止重复提交](https://stackoverflow.com/questions/11705337/javascript-jquery-disable-submit-button-on-click-prevent-double-submitting)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T23:57:56.220

您可以尝试使用 AJAX（有关示例，请参见 URL）[http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/](http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T00:21:33.220

**详细信息：**您可以使用 jQuery 在按下按钮时显示标签并在页面加载时隐藏它

**例子：**

jQuery

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
<script  type="text/javascript">

        $(document).ready(function ()
        {
           // Hide the Label to start with
                $('#<%=lblStatus.ClientID %>').hide();

            $('#<%=btnSave.ClientID %>').click(function ()
            {
                // Show the Label when save button is clicked
                $('#<%=lblStatus.ClientID %>').show();
            });
        });

</script> 
```

ASP.NET 控件

```
<asp:Button ID="btnSave" runat="server" Text="Button" />
<asp:Label ID="lblStatus" CssClass="lblStatus" runat="server" Text="In progress, please wait..."></asp:Label> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T06:02:23.493

您可以为此使用“UpdateProgress”。您只需要在 aspx.xml 中添加以下代码。当您单击按钮时，将显示“进行中，请稍候...”，直到过程结束。

```
<asp:UpdateProgress ID="UpdateProgress1" runat="server">
                <ProgressTemplate>
                    <span style="text-decoration:blink; font-size:small; color:Gray;">
                    In progress, please wait...</span>
                    <%-- you can have image here instead of text--%>
                </ProgressTemplate>
            </asp:UpdateProgress> 
```

# java - 连接两个应用程序

> ID：13463777
> 
> 赞同：0
> 
> 时间：2012-11-19T22:50:05.293
> 
> 标签：java, python, voice-recognition, cmusphinx

我需要在它们运行时连接两个应用程序：CMU Sphinx4 和一个用 python 编写的程序。

我不想集成，只想在两个应用程序之间进行通信。

我想将 Sphinx 识别的行传递给`.py`文件。

我怎样才能做到这一点？

# php - 将两个 XML 文档合并到一个 XSLT 文档中并匹配值

> ID：13463781
> 
> 赞同：0
> 
> 时间：2012-11-19T22:50:14.633
> 
> 标签：php, xslt, xslt-1.0

我有两个具有不同结构的 XML 文档（下面的示例），我想将它们合并到用于创建 HTML 输出的 XSLT 文档中。

我想要做的是创建一个这样的表（以汽车为例）：

```
Serialnr    Brand    Color    Year    Price    Condition
 123456     'Opel'   'Blue'   '1978'  '10000$'   'Used'
  ...        ...      ...      ...     ...      ... 
```

最后两个（Price 和 Condition）要在第二个文档（foo2.xml）中找到，这些文档之间的匹配是 serialnr。汽车在文档中的顺序不同，并且 foo2.xml 中的汽车（不会使用）比 foo1.xml 中的汽车多。

**foo1.xml：**

```
<cars>
    <car>
        <serialnr>123456</serialnr>
        <brand>Opel</brand>
        <color>Blue</color>
        <year>1978</year>
    </car>
    ...and so on... 
```

**foo2.xml：**

```
<vehicles>
    <vehicle>
        <cell nr="2"><data nr="3">123456</data></vehicle> // <--- match on serialnr (123456)
        <cell><data nr="3">10000$</data></cell>
        <cell><data nr="3">Used</data></cell>
    ...and so on... 
```

Foo1.xml 在服务器端通过 PHP 连接到 XSLT 文档，而 foo2.xml 合并到 XSLT 文档中（见下文）。

**汽车.xsl：**

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">

    <xsl:param name="foo2" select="'foo2.xml'"/>

    <xsl:template match="/">

        <xsl:text disable-output-escaping='yes'>&lt;!DOCTYPE html></xsl:text>

        <html>
            <head>
                <title>Producers</title>
            </head>
            <body>
                       ...//table, thead, tr, th...

                    <tbody>
                        <xsl:for-each select="//car">
                        <tr>
                            <td>
                                <xsl:value-of select="serialnr" />
                            </td>
                            <td>
                                <xsl:value-of select="brand" />
                            </td>
                            <td>
                                <xsl:value-of select="color" />
                            </td>
                            <td>
                                <xsl:value-of select="year" />
                            </td>
                          </xsl:for-each>
                          <xsl:for-each select="document($foo2)//Vehicle">
                               // I need to match the serialnr in some way to get the correct car's data here, but how?
                               <td>
                                    // Selecting Cell node 2 (price)
                                    //<xsl:value-of select="/? "/>
                               </td>
                               <td>
                                    // Selecting Cell node 3 (condition)
                                    //<xsl:value-of select="/? "/>
                               </td> 
```

那么，我该怎么做呢？我真的很感谢这里的帮助。提前非常感谢！

### 笔记：

1.  foo2.xml 的结构并不一致。突然，子节点从“vehicle”变为“part”（即“vehicles/vehicle”变为“vehicles/part”）。
2.  在 foo2.xml 中有很多“车辆”节点包含我不感兴趣的数据，所以我想我必须使用某种 if 语句来测试在循环它们时是否存在所需的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T11:40:18.883

猜测我在主要评论提要中发布的问题的答案，请找到这个 XSLT 1.0 解决方案。

**以本文档为主要输入...**

```
<cars>
   <car>
        <serialnr>123456</serialnr>
        <brand>Opel</brand>
        <color>Blue</color>
        <year>1978</year>
  </car>
   <car>
        <serialnr>789</serialnr>
        <brand>Toyota</brand>
        <color>Beige</color>
        <year>2005</year>
  </car>
</cars> 
```

**...并将此文档作为可读文档资源传递给带有参数名称的样式表`foo2`...**

```
<vehicles>
  <vehicle>
    <cell><data>123456</data></cell>
    <cell><data>10000$</data></cell>
    <cell><data>Used</data></cell>
  </vehicle>
  <vehicle>
    <cell><data>789</data></cell>
    <cell><data>20000$</data></cell>
    <cell><data>Pre-loved</data></cell>
  </vehicle> 
```

**...这个 XSLT 1.0 样式表...***

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" doctype-system="about:legacy-compat" encoding="UTF-8" indent="yes" />
<xsl:strip-space elements="*" />  

<xsl:param name="foo2" select="'foo2.xml'" />
<xsl:variable name="vehicles" select="document($foo2)/vehicles/vehicle" />

<xsl:template match="/">
 <html lang="en">
   <head><title>Cars</title></head>
   <body>  
     <xsl:apply-templates select="cars" />
   </body>  
 </html>
</xsl:template>

<xsl:template match="cars">
  <table>
    <th>
      <td>Serialnr</td> <td>Brand</td> <td>Color</td> <td>Year</td> <td>Price</td> <td>Condition</td>
    </th>
    <xsl:apply-templates select="car" />
  </table>
</xsl:template>

<xsl:template match="car">
  <xsl:variable name="srl" select="serialnr/text()" />
    <tr>
      <td><xsl:value-of select="$srl" /></td>
      <td><xsl:value-of select="brand" /></td>
      <td><xsl:value-of select="color" /></td>
      <td><xsl:value-of select="year" /></td>
      <td><xsl:value-of select="$vehicles/self::*[cell/data=$srl]/cell[2]" /></td>
      <td><xsl:value-of select="$vehicles/self::*[cell/data=$srl]/cell[3]" /></td>
    </tr>
</xsl:template>

</xsl:stylesheet> 
```

**...将产生此输出**（HTML5 文档）...

```
<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Cars</title>
  </head>
  <body>
    <table>
      <th>
        <td>Serialnr</td>
        <td>Brand</td>
        <td>Color</td>
        <td>Year</td>
        <td>Price</td>
        <td>Condition</td>
      </th>
      <tr>
        <td>123456</td>
        <td>Opel</td>
        <td>Blue</td>
        <td>1978</td>
        <td>10000$</td>
        <td>Used</td>
      </tr>
      <tr>
        <td>789</td>
        <td>Toyota</td>
        <td>Beige</td>
        <td>2005</td>
        <td>20000$</td>
        <td>Pre-loved</td>
      </tr>
    </table>
  </body>
</html> 
```

## 笔记

使用密钥的解决方案也是可能的。

# openssl - libcurl 与 OpenSSLUnknown SSL 协议连接错误 - （无 Server Hello） - 为什么？

> ID：13463782
> 
> 赞同：4
> 
> 时间：2012-11-19T22:50:17.433
> 
> 标签：openssl, libcurl, wireshark, ssl

我正在开发一个需要与不同 HTTPS 服务器通信的应用程序。在某些情况下，服务器只是忽略 SSL/TLS 客户端问候（不返回服务器问候）。

该问题将在代码中表现出来，如下所示：

```
>curl32.exe -v -k --tlsv1 https://...
* timeout on name lookup is not supported
* About to connect() to <server> port 443 (#0)
*   Trying <IP>...
* connected
* Connected to <server> (<IP>) port 443 (#0)
* successfully set certificate verify locations:
*   CAfile: ./cacert.test.pem
  CApath: none
* Unknown SSL protocol error in connection to <Server>:443

* Closing connection #0
===> CURLcode is: 35 
```

返回的代码是：CURLE_SSL_CONNECT_ERROR

直接从 OpenSsl 运行时，可以：

```
OpenSSL> s_client -tls1 -connect <server>:443 
```

我尝试了各种组合（指定 TLS、SSL 或不指定）。发生问题时唯一常见的情况是 SSL/TLS 版本不一致。因此，在 WireShark 中，我将在 TCP 下看到安全套接字层：

*   SSL 记录层：握手协议：客户端 Hello <===
    *   版本：TLS 1.0 (0x0301)
    *   ...
    *   握手协议：客户端Hello
        *   ...
        *   版本：TLS 1.0 (0x0301)

在正确的情况下，我将看到来自服务器的 Server Hello，我将看到：

*   TLSv1 记录层：握手协议：客户端 Hello <===
    *   版本：TLS 1.0 (0x0301)
    *   ...
    *   握手协议：客户端Hello
        *   ...
        *   版本：TLS 1.0 (0x0301)

我不完全确定这是 libcurl 问题，或者 WireShark 没有正确解码它（因为两种情况下的记录层看起来几乎相同，并且 2 个版本字段是正确的），使得 libcurl 似乎是问题所在。

有什么想法吗？想法？类似的经历？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:46:00.130

我做了更多的测试和调试，发现有几个站点在默认或使用 Curl 的 TLSv1（curl.exe -k -v --tlsv1 或不使用 --tlsv1）时始终失败，但使用 SSLv3 没问题。我很漂亮，版本不是问题，因为 IE 使用 TLSv1 连接，openSSL 也可以使用 TLSv1。但是我没时间了，所以 SSLv3 将用作解决方法。

真正的问题可能是在 Client Hello 中发送的密码列表。在指定一个可以肯定工作的密码之后，SSL 就可以了：

```
curl.exe -k -v <site>                     # failed
curl.exe -k -v --ciphers RC4-MD5 <site>   # now will connect 
```

如果您有类似的问题，这篇文章对我解决“SSL 未知 SSL 协议错误”问题非常有用：

[http://blog.techstacks.com/2010/03/3-common-causes-of-unknown-ssl-protocol-errors-with-curl.html](http://blog.techstacks.com/2010/03/3-common-causes-of-unknown-ssl-protocol-errors-with-curl.html)

# oracle - Oracle 数据库客户端

> ID：13463793
> 
> 赞同：0
> 
> 时间：2012-11-19T22:51:16.907
> 
> 标签：oracle, sqlclient

你能推荐我任何**免费**的oracle sql客户端吗？它不必附带 GUI，但它必须能够连接到远程数据库，而无需任何 oracle 驱动程序。我知道有 SQL Plus 或 Sql Developer，但没有注册是无法下载的。我想要一些真正免费的东西，我**不会被迫**做任何事情......

平台：Win/Debian

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:21:45.543

实际上，您将需要在 OTN 上创建一个免费帐户并从 Oracle 下载一些东西，除非您准备真正牺牲功能（或从不知名的来源下载 Oracle 软件）。

无论使用哪种数据库，您总是需要一些特定于数据库的客户端软件，该软件了解如何与特定数据库进行通信，并且通常为应用程序公开一个合理的 API。这要么意味着安装 Oracle 客户端以获取 SQL*Plus 之类的东西，要么意味着使用 JDBC 驱动程序并使用可以使用 JDBC 的 GUI（如 SQL Developer）。您可以获得第三方 GUI，例如[SQuirreL SQL](http://squirrel-sql.sourceforge.net/)，它是 GPL 的，无需注册即可下载。但即使是这样的事情也取决于您为要连接的特定数据库提供 JDBC 驱动程序。Oracle 提供免费的 JDBC 驱动程序，但与其他 Oracle 软件一样，您需要一个免费的 OTN 帐户才能下载它。

您可能会寻找正在为 Oracle 开发 GPL-d Type 4 JDBC 驱动程序的人。这会有些困难，因为底层的有线协议 API 不是公开的，并且必须进行逆向工程（尽管有几家公司这样做是为了生产自己的有线协议 ODBC 和 JDBC 驱动程序）。不太可能有任何东西几乎与非商业项目的 Oracle JDBC 驱动程序一样健壮和高效，但如果你有一个[Richard Stallman](http://en.wikipedia.org/wiki/Richard_Stallman)式的致力于使用自由软件而不考虑给你带来的不便（虽然，如果在这种情况下，使用 Windows 和 Oracle 似乎很奇怪）你可能会得到应有的。

毫无疑问，除了 Oracle 站点之外，还有很多地方可以下载 Oracle 的 Type 4 JDBC 驱动程序，其中一些可能不需要注册，但那些是未经授权的镜像，因此您可能会面临某种损坏/病毒/等，否则未经授权的镜像将被关闭。

# eclipse - 使用 eclipse 在 git 上获取 $id 等效项

> ID：13463798
> 
> 赞同：1
> 
> 时间：2012-11-19T22:51:42.973
> 
> 标签：eclipse, git, pydev, egit

我正在编写一些脚本并将它们发送给一些朋友等......

当我使用 SVN 时，我曾经将 $Id 标签放在文件上（由 Eclipse 生成），这样我就可以清楚地识别文件。

但是，我找不到使用 egit/eclipse 的类似方法。

有什么建议/帮助/建议吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T08:48:14.010

首先，Git 没有关键字替换机制：
请参阅“ [Git 是否有类似`svn propset svn:keywords`或 pre-/post-commit 的钩子？](https://stackoverflow.com/questions/39742/does-git-have-anything-like-svn-propset-svnkeywords-or-pre-post-commit-hooks) ”

“[从 CVS 迁移到 git：`$Id:$`等效？](https://stackoverflow.com/questions/384108/moving-from-cvs-to-git-id-equivalent) ”解释说，这**[`git describe`](http://git-scm.com/docs/git-describe)**是不仅引用文件版本，而且引用整个 repo 提交（包括该特定文件版本）的首选方式

但是，在查看[JGit](https://github.com/eclipse/jgit)（由 Egit 使用）时，我没有看到任何 ' `describe`' 类。
所以EGit可能不直接支持它。

# macos - 当 NSTextField 在没有子类化的情况下退出第一响应者状态时得到通知

> ID：13463801
> 
> 赞同：1
> 
> 时间：2012-11-19T22:52:06.560
> 
> 标签：macos, cocoa, nstextfield, first-responder

我有一个`NSTextField`添加到自定义视图的视图层次结构中并设置用户在该自定义视图内单击时的位置。

如果文本字段退出第一响应者状态，例如因为用户`NSTextField`在窗口中单击了另一个，我需要获取它的值并再次从视图层次结构中删除它。

我的自定义视图如何得到通知`NSTextField`它拥有辞职的第一响应者状态，而不必仅仅为了这个单一目的而对该文本字段进行子类化？

该`NSTextFieldDelegate`方法`control:textShouldEndEditing:`不会执行，因为它仅在用户实际编辑文本字段中的内容时才被调用。如果用户没有在其中进行任何编辑，我还需要隐藏文本字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T04:05:56.707

NSTextField 失去焦点可以通过以下方式捕获：

```
- (void)controlTextDidEndEditing:(NSNotification *)aNotification 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-14T04:07:39.637

还有一种委托方法可以做同样的事情：-

```
- (BOOL)control:(NSControl *)control textView:(NSTextView *)textView doCommandBySelector:(SEL)command
{
    if (command==@selector(insertTab:) || (command==@selector(insertBacktab:)))
    {
      //Your Code
    }
    return YES;
} 
```

注意：- 它仅适用于 tab 和 backTab 键

# html - twitter 引导表对齐

> ID：13463804
> 
> 赞同：4
> 
> 时间：2012-11-19T22:52:31.287
> 
> 标签：html, css, twitter-bootstrap

我正在使用 twitter bootstrap 并试图让两个表对齐。我开始认为我走错路了。我有两张桌子，一张有 3 列，一张有 2 列。我已将 3 列表设置为 span6、span2、span4。我已将 2 列表设置为 span6 和 span6。根据页面宽度，它们似乎并不总是在中间对齐。有没有办法做到这一点？

示例：http: [//jsfiddle.net/PSBtr/](http://jsfiddle.net/PSBtr/)

```
<html>
<head><link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"></head>

    <body>

    <table class="table table-bordered table-condensed">
    <thead>
    <tr>
        <th class="span6">fdsafdfdf f dfdafs sd</th>
        <th class="span2">tesaaat</th>
        <th class="span4">ffdsfsd d</th>                     
    </tr>
</thead>

</table>

<table class="table table-bordered table-condensed">
<thead>
<tr>
    <th class="span6" >fdfdf  fds f </th>
    <th class="span6">test</th>
</tr>
</thead>

</table>

</body>
</html>​​​​​​​​​​​ 
```

最终，我试图设计一个有点流畅的布局，它也有可以扩展但有最小尺寸的表格。关于哪种布局（来自引导程序）可以实现这一点的任何其他建议也会有所帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T10:05:44.307

下面的代码将完成您想要实现的目标：

```
 <table class="table table-bordered table-condensed">
    <thead>
    <tr class="span12">
        <th class="span6">fdsafdfdf f dfdafs sd</th>
        <th class="span2">tesaaat</th>
        <th class="span4">ffdsfsd d</th>  
    </tr>
</thead>

</table>

<table class="table table-bordered table-condensed">
<thead>
<tr class="span12">
    <th class="span6">fdfdf  fds f </th>
    <th class="span6">test</th>
</tr>
</thead>

</table> 
```

对于您问题的后半部分，很难说，因为它取决于确切的要求，但是是的，您可以尝试单列[流体布局](http://twitter.github.com/bootstrap/scaffolding.html#layouts)..如果用户浏览紧凑的屏幕尺寸，那么您必须考虑[响应式设计](http://twitter.github.com/bootstrap/scaffolding.html#responsive)..

# memory - HashMap 会比链表需要更多的内存吗？

> ID：13463808
> 
> 赞同：0
> 
> 时间：2012-11-19T22:52:43.657
> 
> 标签：memory, linked-list, hashmap

根据我对哈希图的理解，内部数据结构可以看作是一个二维数组。第一个索引是“键”，第二个索引是包含哈希到同一键的值的数组。在我看来，您需要初始化一个足够大的数组以考虑未来的条目（否则您需要在某个点扩大数组或所有值散列到相同的值）。由于初始化特定大小的数组的初始成本，这意味着哈希图与链表相比具有较高的初始成本。

链表只需要表示 X 个项目所需的内存。我在这个假设中正确吗？我只是感到困惑，因为很多人说 LinkedList 使用更多内存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:05:07.287

您忘记了 Map 具有键和值。所以对于列表中的每个项目，地图中有 2 个。因此，如果 LinkedList`n`在存储方面需要成本，则 Map 将需要`2n`. 除此之外，正如您所指出的，您必须有一些可用空间，所以现在您最多为 2n + 2n*.c，即 (1+c)2n，其中 c 是 0.25 之类的分数。

那么与链表相比，这是否符合“高”空间要求？我不这么认为，除非您的内存要求受到限制。请记住，您还可以获得对任何元素的恒定时间访问，对于链表，它的访问时间为 O(n)。

最后，由于 Maps 处理具有键和值的问题，而列表主要只关注值，因此应用这些数据结构的问题往往不同，所以这个问题可能没有多大意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:12:11.777

只是一些数字：

一个空的 HashMap 需要 128 个字节：开销是 64 个字节加上每个条目 36 个字节。对于 10K 条目，预期开销约为 360K

一个空的 LinkedList 需要 48 个字节：开销是 24 个字节，加上每个条目 24 个字节。对于 10K 条目，预期开销约为 240K

来源：[http ://www.ibm.com/developerworks/java/library/j-codetoheap/](http://www.ibm.com/developerworks/java/library/j-codetoheap/)

![图片来自谷歌搜索](../Images/027dba6161723230b0045f1d39f8ec0d.png)

# postgresql - 将现有的 SMALLINT 数据转换为 INTEGER？

> ID：13463809
> 
> 赞同：4
> 
> 时间：2012-11-19T22:52:47.110
> 
> 标签：postgresql

我在 Postgres 中有一个大约 1M 行的表。此表中的一列存储 SMALLINT 数据。现在我需要在此列中存储比我预期的要大的数字。如何将此现有列从 SMALLINT 转换为 INTEGER？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-19T23:02:35.683

您需要将列数据类型从更改`smallint`为`integer`：

```
alter table T alter C type integer 
```

T 和 C 分别是表名和列名。

> 设置数据类型
> 
> 此表单更改表格列的类型。通过重新解析最初提供的表达式，涉及该列的索引和简单表约束将自动转换为使用新的列类型。可选的 COLLATE 子句指定新列的排序规则；如果省略，则排序规则是新列类型的默认值。可选的 USING 子句指定如何从旧的列中计算新的值；如果省略，则默认转换与从旧数据类型到新数据类型的赋值转换相同。如果没有从旧类型到新类型的隐式或赋值强制转换，则必须提供 USING 子句。

请参阅[ALTER TABLE](http://www.postgresql.org/docs/9.2/static/sql-altertable.html)文档。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T00:20:06.077

正如 Ondrej 所说，您可以使用`ALTER TABLE .. ALTER COLUMN ... TYPE INTEGER`.

但是，这将触发全表重写，锁定表以防止所有并发写入*或读取*持续时间。这对于大型表可能很耗时。

如果您需要避免这种情况，您可以分阶段进行更改。

*   `BEGIN`，添加一个新的整数列和`COMMIT`。
*   `BEGIN`一个事务并`LOCK TABLE ... IN EXCLUSIVE MODE`阻止并发插入。
*   `UPDATE``smallint`表，将数据复制到`integer`列。
*   现在删除`smallint`列，将列重命名为`integer`的`smallint`名称，然后`COMMIT`.

`LOCK TABLE`如果您愿意编写一个`BEFORE INSERT OR UPDATE ON ... FOR EACH ROW`触发器，将值从`smallint`列复制到`integer`任何`INSERT`or的列，您甚至可以避免并允许并发写入`UPDATE`。您需要在创建新整数列的同一事务中添加此触发器，以便捕获与 big `UPDATE`. 为了进一步减少更改对应用程序的影响，您可以在单个事务中小批量更新行，从而避免长的行级锁定。

[我在之前的 dba.SE 答案中](https://dba.stackexchange.com/a/27156/7788)写了更多关于此的内容。

# javascript - 数组创建，为什么会这样？

> ID：13463811
> 
> 赞同：1
> 
> 时间：2012-11-19T22:52:58.587
> 
> 标签：javascript

我明白为什么：

```
 output = new Array(); 
```

和

```
 output = []; 
```

但为什么这行得通？

```
 output = Array(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:57:13.850

构造函数的实现很简单，因此不需要`Array()`调用它。`new`这是其语义定义的一部分。

像这样的内置构造函数`Array()`（可能）不是用 JavaScript 编写的，但您可以在自己的代码中获得相同的效果：

```
function MyConstructor() {
  "use strict";
  var newObj = this || {};

  // ...

  return newObj;
} 
```

当你调用 with`new`时，构造函数会看到它绑定了一些东西`this`。如果您不这样做，那么`this`将是未定义的（因为“使用严格”；您也可以检查是否`this`是全局对象，对于旧 IE，您必须这样做）。

构造函数的返回值不是`new`表达式的值——它总是新创建的对象。但是，当您在没有 的情况下调用它`new`时，将使用返回值。

*编辑*——RobG 在评论中指出，要使其真正正常工作，`newObj`需要明确设置函数创建的“合成”，以便获得正确的原型等。这有点棘手；代码简单地执行此操作可能是最简单的：

```
function MyConstructor() {
  "use strict";
  if (!this) return new MyConstructor();
  // ... or possibly using "apply" if you need parameters too
} 
```

TJ Crowder 在这里就对象/继承争论的主题写了一些很棒的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:57:06.083

`Array()`可以编写一个函数来检测它是否在没有`new`运算符的情况下被调用，如果`new`被省略，则会自动创建一个新对象然后返回它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:58:14.997

简单的答案是“因为 ECMA-262 这么说”。实时调频。

第一个调用[Array 函数作为构造函数](http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.2)，第二个是[Array 初始化器](http://www.ecma-international.org/ecma-262/5.1/#sec-11.1.4)（又名 Array 字面量）。

第三种是将[Array函数作为函数](http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.1)调用，等价于`new Array()`and `[]`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T23:00:44.207

output = Array() 有效，因为 Array 是一个函数。

运行这个 cod3

```
<script>
var a = new Array();
var b = Array();
a[0] = 123;
b[0] = 32;
alert("a = " + a +"\nb = " +b +", " + Array);
</script> 
```

这打印出来：

```
a = 123
b = 32, function Array() {
    [native code]
} 
```

所以，既然 Array 是一个函数，你可以调用 Array()，它的实现就是给你一个 new Array()

# php - YouTube API 结果和实际 YouTube 查询之间的区别？

> ID：13463818
> 
> 赞同：0
> 
> 时间：2012-11-19T22:53:35.720
> 
> 标签：php, xml, youtube, youtube-api

我正在创建一个涉及解析来自 youtube api 的一些数据的 php 脚本。

这是我正在运行的查询：

```
http://gdata.youtube.com/feeds/api/videos?q=science&max-results=25&fields=entry[media:group/yt:duration/@seconds > 1200 and yt:statistics/@viewCount > 20] 
```

无论出于何种原因，我只得到 3 个结果。你会期待更多的结果。此外，如果我手动转到 youtube 并搜索相同的条件（搜索词的“科学”并且至少 20 分钟长），你会得到充满结果的页面。

为什么我只有3个？

这会重复多次查询；API 返回的数据集中只有一小部分，但在实际的 youtube 搜索页面上有常规查询的结果页面和页面。

我之前的主题已关闭，但是在 Youtube API 开发者论坛上，它指出 stackoverflow 是我应该提出问题的地方——如果在这里不合适，那么我应该去哪里寻求答案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:10:09.327

两件事情：

*   用于`&v=2`使用更强大的 API 版本 2。
*   版本 2 还引入了 Duration 参数，它比您在 Fields 参数中获得的 yt:duration 位更有效。

通过这样做可以使查询更加健壮（为了可读性而分解，因为我假设这个查询是在某种程度上以编程方式生成的）。

```
http://gdata.youtube.com/feeds/api/videos?
q=science
&max-results=25
&duration=long
&fields=entry[yt:statistics/@viewCount%20%3E%2020]
&v=2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T01:44:21.143

此外，要回答您为什么只获得 3 个结果的问题，请在此处查看我的评论：[youtube api 中多个字段/条目规范的语法？](https://stackoverflow.com/questions/13442273/syntax-for-multiple-field-entry-specifications-in-the-youtube-api#comment18413552_13443706)

# c++ - 为 stl::map 使用 value_type 数组

> ID：13463825
> 
> 赞同：0
> 
> 时间：2012-11-19T22:53:54.440
> 
> 标签：c++, arrays, map, find, value-type

我有以下代码：

```
//MyClass.h
class MyClass {
      typedef std::map<std::string, int> OpMap;
      static const OpMap::value_type opMap[OP_COUNT];

    public:
     //methods
};

//MyClass.cpp
const MyClass ::OpMap::value_type MyClass ::opMap[DDG::OP_COUNT] = {
    MyClass ::OpMap::value_type("hello", 42),
    MyClass ::OpMap::value_type("world", 88),
}; 
```

`bool findOP(string opKey)`我需要实现`opKey`在`opMap`.

看起来我需要使用类的`find`方法`map`。但`opMap.find(opKey)`不起作用，因为`opMap`是一对数组。为了在 中进行有效搜索，可以做些`opKey`什么`opMap`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:01:54.863

我不确定我是否理解您的代码和您的问题......但是如果您想要将键`std::map`关联`std::string`到`int`值，为什么要定义一个（键，值）对数组？

那么下面的呢？

```
std::map<std::string, int> m;
m["hello"] = 42;
m["world"] = 88; 
```

我想如果你有一个*无序*数组（就像*你的*`opMap`代码），如果你想搜索一些东西，你可以做一个*线性搜索*（）。只有对数组进行了*排序*，您才能使用例如*二进制搜索*（具有对数渐近复杂度）来优化搜索。**`O(N)`**`std::lower_bound()`****

 ***如果你想从`opMap`数组的内容初始化地图，你可以这样做：

```
// opMap is an array of (key, value) pairs
// m is a std::map<std::string, int>
// 
// For each item in the array:
for (int i = 0; i < DDG::OP_COUNT; i++)
{
  // opMap[i].first is the key;
  // opMap[i].second is the value.
  // Add current key-value pair in the map.
  m[ opMap[i].first ] = opMap[i].second;
} 
```***

# .net - IIS 6 子虚拟应用程序不使用 .Net 4.0 Bin 文件夹

> ID：13463828
> 
> 赞同：0
> 
> 时间：2012-11-19T22:54:10.907
> 
> 标签：.net, iis-6, windows-server-2003

我在 Windows 2003 上的 IIS 6 中有一个带有子虚拟应用程序的 .NET 站点。站点结构如下所示：

*   MyWebSite（指向 d:\MyWebSite\Versions\1.2）
    *   模板（虚拟应用程序，指向 d:\MyWebSite\Common\Templates）
    *   斌

它工作正常。现在我正在尝试从 .NET 3.5 升级到 4.0。运行来自虚拟应用程序的页面时，我在 web.config 中的 httpmodule 上遇到异常：

> 异常类型：ConfigurationErrorsException 异常消息：无法加载文件或程序集“MyWebSite.dll，Version=1.0.0.0，Culture=neutral”或其依赖项之一。该系统找不到指定的文件。

MyWebSite.dll 位于我网站的 bin 文件夹中。程序集活页夹日志条目具有以下报告：

> 日志：Appbase = file:///D:/MyWebSite/Common/Templates/
> 日志：初始 PrivatePath = D:\MyWebSite\Common\Templates\bin

所以它在虚拟应用程序目录中寻找 bin 文件夹，而不是根站点文件夹。它似乎不适用于 .NET 3.5。发生了什么变化，如何让 Templates 虚拟应用程序找到正确的 bin 文件夹？我宁愿不为 bin 文件夹中的每个 .dll 提供探测信息。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T21:12:52.790

好的，我想我已经解决了这个问题。我错过了我的问题中的几个关键问题。这些错误是针对无扩展路径的请求，应该返回 404 错误而不是被处理。.NET 4 似乎在 IIS 6 中包含一个默认启用的无扩展 url 功能。它通过 ISAPI 过滤器将“/eurl.axd/GUID”添加到 url，以便它由 aspnet_isapi.dll 处理。我必须添加一个注册表 DWORD HKLM\SOFTWARE\Wow6432Node\Microsoft\ASP.NET\4.0.30319.0\EnableExtensionlessUrls （或 HKLM\SOFTWARE\Microsoft\ASP.NET\4.0.30319.0\EnableExtensionlessUrls 对于非Wow64）并将其设置为0\. 你可以在这里阅读更多信息：http: [//blogs.msdn.com/b/tmarq/archive/2010/06/18/how-to-disable-the-asp-net-v4-0-extensionless- url-feature-on-iis-6-0.aspx](http://blogs.msdn.com/b/tmarq/archive/2010/06/18/how-to-disable-the-asp-net-v4-0-extensionless-url-feature-on-iis-6-0.aspx)

# java - 如何确定我要读取的文件是否确实存在？

> ID：13463832
> 
> 赞同：-2
> 
> 时间：2012-11-19T22:54:40.867
> 
> 标签：java, stream, inputstream

我正在学习 Java，我正在尝试编写一个可以从`.ser`文件中读取的程序，我已经用一种`writeTo()`方法创建了该文件。

在告诉程序从中读取之前，我想知道系统中存在给定文件。

我的代码如下所示：

```
public boolean readFromSerializedFile(String fileName){
    FileInputStream fileInStream = null;
    ObjectInputStream objectInStream = null;

    try{
        fileInStream = new FileInputStream(fileName);  
        objectInStream = new ObjectInputStream(fileInStream); 
```

有没有一种简单的方法可以确定具有参数名称的文件是否存在于根目录（或其他指定的位置）中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T22:56:05.647

您可以使用[File.exists()](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#exists%28%29)方法。

假设您想知道文件是否`abc.xml`存在。以下代码说明了如何执行此操作。

```
final File file = new File ("abc.xml");
final boolean exists = file.exists ();
System.out.println ("abc.xml " + (exists ? "exists" : "does not exist")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:04:46.763

其他人提到 File.exists，但如果您正在学习 Java 并且可能使用 Java SE 7，我建议使用新的 NIO File API 代替：

```
Files.exists(Paths.get(filename)); 
```

[http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#exists%28java.nio.file.Path,%20java.nio.file.LinkOption...% 29](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#exists%28java.nio.file.Path,%20java.nio.file.LinkOption...%29)

另请注意，Oracle 的 Java 教程对于学习标准 Java API 非常有用：

[http://docs.oracle.com/javase/tutorial/](http://docs.oracle.com/javase/tutorial/)

[http://docs.oracle.com/javase/tutorial/essential/io/fileio.html](http://docs.oracle.com/javase/tutorial/essential/io/fileio.html)

[http://docs.oracle.com/javase/tutorial/essential/io/check.html](http://docs.oracle.com/javase/tutorial/essential/io/check.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T22:56:43.833

```
Using java.io.File
...
String path = "C:\test.txt";
File f = new File(path);
if(f.exists()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:57:03.200

您可以捕获`java.io.FileNotFoundException`，它将在您描述的案例场景中抛出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-19T23:01:17.683

```
 FileReader br = new FileReader(file);

   if(br.ready())
    return;
   else
    System.exit(1); 
```

# asp.net-mvc - 使用 ClaimsPrincipalPermissionAttribute，我如何捕获 SecurityException？

> ID：13463835
> 
> 赞同：1
> 
> 时间：2012-11-19T22:55:03.277
> 
> 标签：asp.net-mvc, wif

在我的 MVC 应用程序中，我有一个删除客户的控制器操作，我正在应用基于声明的授权来使用 WIF。

问题：如果有人没有访问权限，他们会在浏览器中看到异常（完整的堆栈跟踪），但我宁愿只是重定向他们。

这有效并允许我重定向：

```
public ActionResult Delete(int id)
{
    try
    {
        ClaimsPrincipalPermission.CheckAccess("Customer", "Delete");
        _supplier.Delete(id);
        return RedirectToAction("List");
    }
    catch (SecurityException ex)
    {
        return RedirectToAction("NotAuthorized", "Account");
    }
} 
```

这可行，但会引发我不知道如何捕获的 SecurityException（当用户未获得授权时）：

```
[ClaimsPrincipalPermission(SecurityAction.Demand, Operation = "Delete", Resource =     "Customer")]
public ActionResult Delete(int id)
{
    _supplier.Delete(id);
    return RedirectToAction("List");
} 
```

我想使用声明性方法，但不确定如何处理未经授权的请求。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:14:11.653

您可以使用 HandleError 属性。你可以在这里查看它的用法：[ASP.Net MVC Preview 4 release](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)

本质上，您应该能够使用 HandleError 属性装饰您的 Delete ActionResult 并指定要捕获的异常类型和要显示的视图，如下所示：

```
[HandleError(ExceptionType = typeof(SecurityException), View = "UnauthorizedView")] 
```

当然，您必须创建 UnauthorizedView。如果您不指定视图，您将获得标准错误视图（位于 Shared Views 文件夹中）

# php - 为什么我的 Ajax 函数会返回我的整个代码？

> ID：13463836
> 
> 赞同：1
> 
> 时间：2012-11-19T22:55:07.390
> 
> 标签：php, javascript, ajax

我正在使用“Head first Ajax”一书中的示例代码。以下是重要的代码片段：

Index.php - html 片段：

```
<body>
  <div id="wrapper">
    <div id="thumbnailPane"> 
      <img src="images/itemGuitar.jpg" width="301" height="105" alt="guitar" 
           title="itemGuitar" id="itemGuitar" onclick="getDetails(this)"/>
      <img src="images/itemShades.jpg" alt="sunglasses" width="301" height="88" 
           title="itemShades" id="itemShades" onclick="getDetails(this)" />
      <img src="images/itemCowbell.jpg" alt="cowbell" width="301" height="126" 
           title="itemCowbell" id="itemCowbell" onclick="getDetails(this)" />
      <img src="images/itemHat.jpg" alt="hat" width="300" height="152" 
           title="itemHat" id="itemHat" onclick="getDetails(this)" />
    </div>

    <div id="detailsPane">
      <img src="images/blank-detail.jpg" width="346" height="153" id="itemDetail" />
      <div id="description"></div>
    </div>

  </div>
</body> 
```

Index.php - 脚本：

```
function getDetails(img){
  var title = img.title;
  request = createRequest();
  if (request == null) {
    alert("Unable to create request");
    return;
  }
  var url= "getDetails.php?ImageID=" + escape(title);
  request.open("GET", url, true);
  request.onreadystatechange = displayDetails;
  request.send(null);
}
function displayDetails() {
  if (request.readyState == 4) {
    if (request.status == 200) {
      detailDiv = document.getElementById("description");
      detailDiv.innerHTML = request.responseText;
    }else{
      return;
    }
  }else{
    return;
  }
  request.send(null);
} 
```

和 Index.php：

```
<?php
$details = array (
  'itemGuitar' => "<p>Pete Townshend once played this guitar while his own axe was in the shop having bits of drumkit removed from it.</p>",
  'itemShades' => "<p>Yoko Ono's sunglasses. While perhaps not valued much by Beatles fans, this pair is rumored to have been licked by John Lennon.</p>",
  'itemCowbell' => "<p>Remember the famous \"more cowbell\" skit from Saturday Night Live? Well, this is the actual cowbell.</p>",
  'itemHat' => "<p>Michael Jackson's hat, as worn in the \"Billie Jean\" video. Not really rock memorabilia, but it smells better than Slash's tophat.</p>"
);
if (isset($_REQUEST['ImageID'])){echo $details[$_REQUEST['ImageID']];}
?> 
```

这段代码所做的只是当有人点击缩略图时，页面上会出现相应的文本描述。

这是我的问题。我试图将`getDetails.php`代码带入内部`Index.php`，并修改`getDetails`函数以`var url`使`"Index.php?ImageID="...` . 当我这样做时，我遇到了以下问题：该函数没有显示数组中的文本片段，因为它应该。相反，它会复制整个代码——网页等——然后在底部复制预期的文本片段。

这是为什么？

PS：好的，我现在明白我的问题了，感谢下面的两个回复。当我调用 url`"Index.php?ImageID="...`时，我不只是加载与`$_GET`. 我正在加载整个页面，现在使用非空`$_GET` 值。这清楚地说明了为什么我需要为我想要添加的内容创建一个单独的页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T22:59:05.780

当您识别出对图像信息的请求时，您会吐出数据，但您没有做任何事情来阻止脚本的其余部分运行。你可以改变

```
if (isset($_REQUEST['ImageID'])){echo $details[$_REQUEST['ImageID']];} 
```

类似于

```
if (isset($_REQUEST['ImageID'])){
  echo $details[$_REQUEST['ImageID']];
  exit;
} 
```

不过，我还是建议使用单独的 URL 获取图像信息。毕竟，URL 应该描述在那里找到的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:57:44.957

嗯，那是因为您请求整个页面，Ajax 是成功的，并且按照您的请求将页面返回给您。

Ajax 不适用于同页请求。将处理文件与索引文件分开。

# c++ - 对于结构（位于堆上），getter 和 setter 是什么样的？

> ID：13463838
> 
> 赞同：3
> 
> 时间：2012-11-19T22:55:11.420
> 
> 标签：c++

非常简单的问题 - 如何访问堆内结构的数据？

附加信息：：我有一个名为“A”的类和一个名为“B”的类中的结构。创建的每个“B”都将存在于堆上。“A”类旨在将“B”向量作为私有数据成员（即“A”类可以容纳许多“B”）。我在“A”类中有一个方法，它将在“A”具有的向量中添加另一个新的“B”实例。我在“A”类中还有另一种方法，它将更新“B”实例向量中的每个元素。我的问题是：

如何在我的结构中使用 getter 和 setter？

这是一些可能有帮助的代码（注意：grafix.h 是一个图形库）

```
//.h file
#pragma once
#include <vector>
#include "grafix.h"

class A
{
    public:
        ~A();
        A();

        void addB();
        void updateB();

    private:

        struct B
        {
                 public:
                     ~B()
                     {
                           delete p_b;
                     p_b = 0;
                     }

                     B()
                     {
                     p_b = new B; //I need this here

                     p_ball->x = 0;
                     p_ball->y = 0;
                     p_ball->r = 15;

                      }
                      void setxy(int X, int Y) 
                      {
                     //What does this look like?
                                       //This?
                                       x = X; //?
                                       y = Y;
                      }

                      int retx()
                      {
                                        //Likewise.... ?
                      return x; //?
                      }

                      int rety()
                                  {
                                         return y;
                                  }

                       void update()
                       {
                          draw();

                                           //Movement code taken out for time being
                       }

                  private:
                       int x,y; //xy
                       int r; //radius

                       B* p_b; //pointer to object, do I need this?

                       void draw()
                       {
                         draw_circle_filled(x,y,r); 
                                          //how can I access the data within the struct B here?
                                          //do I use the getters/setters? dereference??
                       }

          };

vector <Ball*> bs; //Holds all of the B's that have been created

}; 
```

然后是具有方法的 .cpp 文件。这就是我的问题所在，我输入的语法是否正确？

```
#include "A.h"

A::A()
{
        addB();
}

void A::addB()
{
      B* b;

      bs.push_back(b);
}

void A::updateB()
{
       for(int i = 0; i < bs.size(); i++)
       {
            bs[i]->update();
       }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:03:59.697

这是**犯罪**：

```
void A::addB()
{
      B* b;

      bs.push_back(b);
} 
```

B* b**未初始化**。在您的容器中对其进行引用是犯罪行为：取消引用此地址没有意义，并且是未定义的行为/崩溃。

你应该这样分配：

```
{
      B* b = new B;

      bs.push_back(b);
} 
```

**编辑**：正如凯文在下面评论的那样，仍然存在内存泄漏。您宁愿使用`std::shared_ptr<B>`. 这样，当没有人保持指向它的 shared_ptr 时，该 B 对象将被删除。

# php - 如何在 PHP 中发布阿拉伯字符

> ID：13463839
> 
> 赞同：2
> 
> 时间：2012-11-19T22:55:14.420
> 
> 标签：php, forms, post, utf-8, arabic

好的，

所以我正在编写一个 OpenCart 扩展，它在发布数据时必须允许使用阿拉伯字符。

每当我发布 مرحبا`print_r($_POST)`退货时：u0645u0631u062du0628u0627

我检查了 HTML 标题，它有这个：

```
<meta charset="UTF-8" /> 
```

我检查了触发所有 SQL 查询的 PHP 文件，它有以下代码：

```
mysql_query("SET NAMES 'utf8'", $this->link);
mysql_query("SET CHARACTER SET utf8", $this->link);
mysql_query("SET CHARACTER_SET_CONNECTION=utf8", $this->link); 
```

这是我的表单标签：

```
<form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data" id="form" accept-charset="utf-8"> 
```

我想不出我还做错了什么。OpenCart 框架的其余部分支持 UTF8 和阿拉伯字符。只是在这种情况下，我不能发布任何阿拉伯语内容？

有人可以帮我吗？

非常感谢

彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T09:41:38.340

必须`json_encode`在某处发生 aa，首先`print_r($_POST)`在您的应用程序的最早点（在 index.php/您的引导文件的顶部）执行 a。如果它没有显示，`uxxxx`那么你知道它是在`$_POST`数据之间的某个地方完成的

# grails - 在集成测试中使用 GORM 方法

> ID：13463840
> 
> 赞同：0
> 
> 时间：2012-11-19T22:55:19.567
> 
> 标签：grails, integration-testing, grails-orm, spock

我正在尝试在 Spock 集成规范中的域类上使用 gorm find 方法。

我的代码：

```
class myDomainClassSpec extends IntegrationSpec{
    ...
    def 'my test'() {
        when: ...
        then:
            MyDomainClass.find { id == 1 }
    }
    ...
} 
```

这失败了，抛出：

```
groovy.lang.MissingPropertyException: No such property: id for class: grails.gorm.DetachedCriteria 
```

相反，如果我编码： MyDomainClass.findAll().find { id == 1 } 它可以工作。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:11:55.333

我不确定 Spock 在这里是如何工作的，但看起来你`MyDomainClass.find`调用的是创建一个[DetachedCriteria](http://grails.org/doc/latest/guide/GORM.html#detachedCriteria)，我想解决这个问题要么做

```
MyDomainClass.findById(1) 
```

或者如果您使用更复杂的标准，请尝试

```
MyDomainClass.where { id == 1 } 
```

或仅使用[标准](http://grails.org/doc/latest/guide/GORM.html#criteria)

```
(MyDomainClass.createCriteria()) { id == 1 } 
```

# hibernate - Grails 1.3 对未关联表的条件连接或子查询

> ID：13463847
> 
> 赞同：2
> 
> 时间：2012-11-19T22:55:59.850
> 
> 标签：hibernate, grails, grails-orm, criteria

我有一个简单的域对象

```
def MyDomain{
  String id
  String userId
  String blah

} 
```

和一个用户 ID 域对象

```
def User{
  String id //maps to user_id column, ommitted from example
  String firstName
  String lastName
} 
```

在 grails 1.3.7 中，有没有办法使用标准将表连接在一起？我们有许多（80 多个）域对象，它们使用动态构建的标准来进行行查找。我们最近需要为这些行查找中的每一个添加一个用户名，但如果可能的话，我们希望避免遍历和修改那么多域对象，特别是因为数据很小。

我已经查看了 DetachedCriteria，但这仅适用于 grails 2.0+，并且升级不仅仅是为此的选择。我见过的其他选项包括将 User 作为 MyDomain 定义中的一个字段。有没有更好的方法来做到这一点而没有所有的开销？相应的查询类似于：

```
select md.id, md.userId from myDomain md , user u where md.user_id = u.user_id order by     u.last_name, pu.first_name; 
```

# .net - 运行“身份和访问”向导后，带有 VS 2012 的 MVC4 应用程序中的 Principal 是 RolePrincipal 而不是 ClaimsPrincipal

> ID：13463860
> 
> 赞同：4
> 
> 时间：2012-11-19T22:56:49.283
> 
> 标签：.net, asp.net-mvc-4, visual-studio-2012, wif

由 Visual Studio 2012 中的默认（互联网）模板创建的 MVC 4 应用程序在运行“身份和访问...”向导后返回 RolePrincipal。

该向导创建与 STS（实际或“开发”时间 STS）的信任关系。

如果检查，用户对象将是***RolePrincipal***类型。这样做的结果是 User.IsInRole 针对本地角色数据库而不是声明集进行解析。

![在此处输入图像描述](../Images/ee2ff059b203dee08393713250a9b327.png)

我期待一个***ClaimsPrincipal***

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T01:50:36.950

这是因为新的 Oauth 支持。它使用了新的 simplemembership，它最终使用了所有的提供者。

删除`[InitializeSimpleMembership]`帐户控制器上的属性是不够的，因为初始化发生在***WebMatrix.WebData***程序集中：

```
[assembly: PreApplicationStartMethod(typeof (PreApplicationStartCode), "Start")] 
```

***PreApplicationStartCode.Start***最终调用：

```
WebSecurity.PreAppStartInit(); 
```

如果检查，则表明：

```
 ...
SimpleRoleProvider simpleRoleProvider = WebSecurity.CreateDefaultSimpleRoleProvider("AspNetSqlRoleProvider", currentDefault2);
      Roles.Providers.Remove("AspNetSqlRoleProvider");
      Roles.Providers.Add((ProviderBase) simpleRoleProvider);
... 
```

禁用所有这些“魔法”的方法是使用 web.config 中的此设置：

```
<add key="enableSimpleMembership" value="false"/> 
```

# php - 为什么我用于存储密码的哈希/盐技术不起作用？

> ID：13463870
> 
> 赞同：1
> 
> 时间：2012-11-19T22:57:27.630
> 
> 标签：php, hash, mysqli, salt

我正在尝试制作一个安全、自定义的用户登录系统，但它目前不起作用。这个想法是创建一个具有安全、加密密码的用户。但是，当使用正确的密码时，它不会登录到该站点。

使用密码时的输出`123456789jp`：

`$6$j7Rd68RhKNx.6ccH$9lvRDdks.jx4hk7.YQ0hpvzPE22h/BZQ/9yXiwTMBV1Kx2xr2gbIZZJxYjeLrA41nL2WGjmt.FMQi877uOXrP1`

相关功能：

```
// function register_user()
function bruger_opret_siden(){
            if ($stmt = $this->mysqli->prepare('SELECT NULL FROM `bruger` WHERE `brugernavn` = ?'))
            {
                $stmt->bind_param('s', $brugernavn);
                $brugernavn = $_POST["brugernavn"];
                $stmt->execute();
                $stmt->store_result();
                $count = $stmt->num_rows;
                $stmt->close();
                if($count > 0)
                {
                    $user_found = 1;
                }
            }
            if(!isset($user_found))
            {
                //Check if the user exists.

                if(!isset($errors))
                {
                    $pb = null;

                    include 'function/class.upload.php';
                    $handle = new Upload($_FILES["file"]);

                    if($handle->uploaded)
                    {
                        //trims to next request         
                    }

                 $password = $_POST["pass"];
                 $algorithm = '$6$'; //<--- This means the SHA 512
                 $salt = $this->generateSalt(16); //<--- SHA 512 uses a 16-character salt

                 $hash = crypt($password, $algorithm . $salt);

                if ($stmt = $this->mysqli->prepare('INSERT INTO `bruger` 
                (`rank`, `email`, `brugernavn`, `password`, `profilbillede`, `profilbillede_godkendt`, `navn`, `efternavn`, `alder_d`, `alder_m`, `alder_aar`, `status`, `kon`, `seksualitet`, `land_by`, `hojde`) 
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)'))
                {

                    $stmt->bind_param('issssisssssiiisi', $rank, $email, $brugernavn, $password, $profilbillede, $pb_godkendt, $navn, $efternavn, $alder_d, $alder_m, $alder_aar, $kon, $seksualitet, $partnerstatus, $land_by, $hojde);
                    $rank = '1';
                    $pb_godkendt = '1';
                    $email = $_POST["email"];
                    $brugernavn = $_POST["brugernavn"];//C
                    $password = $hash;//C
                    $profilbillede = $pb;//C
                    $navn = $_POST["navn"];
                    $efternavn = $_POST["efternavn"];
                    $alder_d = $_POST["alder_d"];
                    $alder_m = $_POST["alder_m"];
                    $alder_aar = $_POST["alder_aar"];
                    $kon = $_POST["kon"];
                    $seksualitet = $_POST["seksualitet"];
                    $partnerstatus = $_POST["partnerstatus"];
                    $land_by = $_POST["land_by"];
                    $hojde = $_POST["hojde"];

                    $stmt->execute();
                    $stmt->close();

                    echo "ok";

                    }
                    else
                    {
                        // There was an error 
                        echo 'error: ' . $mysqli->error;
                    }
                }
            }
            else
            {
                echo "<li id=\"check_not\">Dette brugernavn er optaget!!</li>";
            }
    } 
```

从密码和盐中生成哈希以注册用户的代码：

```
function generateSalt($length) {
         $alphabet = './ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
         $alphabet_length = strlen($alphabet);
         $salt = '';
         for ($i = 0; $i < $length; $i++) {
             $salt .= $alphabet[rand(0, $alphabet_length - 1)];
         }
         return $salt;
     } 
```

显示用户信息的两个功能。

```
$pass = $mebe->generateSalt();
                $users = $mebe->bruger_opret_siden(); 
```

以下函数包含问题；它不会让用户登录。虽然没有产生错误，但它不起作用。

```
function godkendt_login()
    {
        if ($stmt = $this->mysqli->prepare("SELECT `id`, `brugernavn`, `rank`, `profilbillede`, `profilbillede_godkendt` FROM `bruger` WHERE `brugernavn` = ? AND `password` = ?"))
        {
            $stmt->bind_param('ss', $brugernavn, $password);
            $brugernavn = $_POST["brugernavn"];
            $password = sha1($_POST["pass"]);
            $stmt->execute();
            $stmt->store_result();
            $stmt->bind_result($id, $brugernavn, $rank, $profilbillede, $profilbillede_godkendt);
            $stmt->fetch();
            $count = $stmt->num_rows;
            $stmt->close();

            if($count > 0)
            {
                $_SESSION["logged_in"] = true;
                $_SESSION["id"] = $id;
                $_SESSION["profilbillede"] = $profilbillede;
                $_SESSION["brugernavn"] = $brugernavn;
                $_SESSION["rank"] = $rank;
                $_SESSION["profilbillede_godkendt"] = $profilbillede_godkendt;

                if($_SESSION["logged_in"] == true)
                {
                    echo "ok";
                }
                else
                {
                    // Sorry, please try again.
                                    echo "Desværre prøve igen."
                }
            }
            else
            {
                          echo "Skrive et password eller brugernavn"
            }
        }
    } 
```

日志文件/inc文件：

```
<?php
    /*
     * // Grant the administrative privilige to show the content.
     * Giver admin adgang til se indhold på siden.
     */
    if(isset($_SESSION["rank"]) && $_SESSION["rank"] > 0) {
        $bruger = $mebe->brugerindhold_side();
    }

    /*
     * // Grant normal access to the page.
     * Hvis ingen af dem så få de bare adgang sådan her..
     */
    else{
    ?>
<form name="login" method="post" action="#">
    <h1>Log ind</h1>
    <p>Brugernavn</p><input type="text" name="brugernavn"/>
    <p>Password</p><input type="password" name="pass"/>
    <br />
    <input type="submit" name="Log_ind" value="Log ind" id="login">
    <?php
    if(isset($_POST["Log_ind"]))
    {
    $login = $mebe->godkendt_login();
    }
    ?>
</form>
<?php
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:08:13.187

好的，由于语言差异，我无法完全掌握您的代码。盐应该是可重复的值。从我收集的内容来看，您的似乎是@随机生成的。

如果是这样，则哈希不会相加，因此检查失败。为哈希使用一个常量值，**不要将它存储在数据库中**！

例如：

```
<?php

     function generateHash($in)
     {
         $salt = "Th1s1sAS4lt";
         return md5(sha1($in) . $salt);
     }
?> 
```

此外，任何帖子值都应检查，因为它是由用户输入的，可能包含非法字符或有害代码。请注意以下事项：

```
<?php
    // Note that the input contains SQL.
    // bemærke, at de input indeholder SQL.                 
    $_POST['passwd'] = "'p@ssword' OR 'a' = 'a'";

    if (tilmeld_dig())
    {
        // Log the user in.
        // brugeren er logget på
    }

    function tilmeld_dig()
    {
        $sql = "SELECT brugernavn from tbl_brugere WHERE adgangskode = " . $_POST['passwd'];

            // Execute the database command. 
        $res// = Database kommando udføre
        if ($res)
        {
            return true;
        }
        else
        {
            return false;
        }
    }
?> 
```

在上面的示例中，无论密码如何，用户都已登录，因为注入的 SQL 命令将**始终**为真。

虽然这是一个粗略的例子，但请查看： [http ://translate.google.com/translate?hl=nl&sl=en&tl=da&prev=_dd&u=http%3A%2F%2Fwww.unixwiz.net%2Ftechtips%2Fsql-injection .html](http://translate.google.com/translate?hl=nl&sl=en&tl=da&prev=_dd&u=http%3A%2F%2Fwww.unixwiz.net%2Ftechtips%2Fsql-injection.html)

我试图用一些丹麦语评论来支持你，因为这在安全系统中很重要。你在正确的轨道上，但我建议你看看我的建议。

此外，这是未经测试的代码，但或多或​​少是如何工作的。

# xml - XPATH：使用通配符命名空间选择多个记录

> ID：13463871
> 
> 赞同：4
> 
> 时间：2012-11-19T22:57:36.400
> 
> 标签：xml, xpath, selection, record

我对 XPATH 相当陌生，当某个节点等于两个值之一时，我需要从多个 XML 对象返回一个值。该解决方案还需要使用 local-name() 与命名空间无关。鉴于以下 XML，我希望返回“B”的所有值，其中“A”等于“4”或“5”。

```
<?xml version="1.0"?>
    <element>
        <A>3</A>
        <B>Value 1</B>
    </element>
    <element>
        <A>4</A>
        <B>Value 2</B>
    </element>
    <element>
        <A>5</A>
        <B>Value 3</B>
    </element> 
```

我已经尝试了以下表达式的多次迭代，但是当我尝试为“A”添加第二个值时似乎无法获得正确的语法。我似乎无法弄清楚“或”表达式的正确语法。我也考虑过使用联合，但也无法正确使用该语法。

这适用于“A”等于单个值“4”但如何添加“5”值的测试，以便结果返回“B”的两个值（“值 2”和“值 3” )?

```
//*[local-name()='element'][*[local-name()='A']='4']/*[local-name()='B']/text() 
```

谢谢你。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T23:06:37.737

试试这个：

```
//*[local-name() = 'element']/*[local-name() = 'A' and (. = 4 or . = 5)]
    /../*[local-name() = 'B'] 
```

此表达式选择`Value 2`和`Value 3`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:32:35.973

**处理命名空间的正确方法是将它们*注册*到您的 XPath API 并...在 XPath 表达式中*使用***它们：

**使用**：

```
//x:element[x:A = 4 or x:A = 5]/x:B 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:x="some:default NS">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
     <xsl:copy-of select="//x:element[x:A = 4 or x:A = 5]/x:B"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档**（提供的片段，由具有默认命名空间定义的单个顶部元素包装）时：

```
<t xmlns="some:default NS">
    <element>
        <A>3</A>
        <B>Value 1</B>
    </element>
    <element>
        <A>4</A>
        <B>Value 2</B>
    </element>
    <element>
        <A>5</A>
        <B>Value 3</B>
    </element>
</t> 
```

**对 XPath 表达式求值，并将该求值的结果（选定节点）复制到输出**：

```
<B xmlns="some:default NS">Value 2</B>
<B xmlns="some:default NS">Value 3</B> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:07:38.437

您可以嵌套谓词。

```
//*[
  local-name() = 'element' and *[local-name() = 'A' and (. = 4 or . = 5)]
]/*[
  本地名称（） = 'B'
]/文本（）

```

但实际上您应该使用命名空间感知 XPath：

```
//ns1:element[ns2:A[. = 4 or . = 3]]/ns2:B/text() 
```

# c - Mac OS 7-9 - C 编程

> ID：13463875
> 
> 赞同：6
> 
> 时间：2012-11-19T22:57:48.960
> 
> 标签：c, macos, mac-classic

我很好奇有多少依赖于标准 Unix 功能的 C 功能可以在 Mac OS System 7 到 OS 9 上运行。我没有任何平台开发经验，但我知道标准没有命令行，也没有任何地方流工作。没有命令行是否有任何命令行参数？环境变量呢？

我确实尝试过寻找经典的 Mac OS 编程指南，但它们出奇地难找。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-19T23:25:20.260

首先，没有依赖于 Unix 的 C 特性。C 在 Windows 上运行良好，在 8 位微控制器上运行良好。

至于经典的 Mac OS，有两个主要的编程环境：Metrowerks CodeWarrior 和 Apple 的 MPW。

1.  CodeWarrior 带有一个名为 SIOUX 的库，它打开一个窗口并提供简单的 I/O。任何`printf`语句都将打印到此窗口。没有管道或插座，但这不是 C 标准的一部分（管道是 POSIX 的一部分）。使用 SIOUX，您可以将一个简单的程序移植到 Mac OS，只要它坚持可移植的 C。

2.  苹果的 MPW 是另一种选择。MPW 提供了一个命令行、一组命令行程序（C、C++、Pascal、汇编的编译器）和用于为程序生成命令行参数的对话框“shell”。你甚至可以使用管道、设置环境变量等等。

    但是，Unix 和 MPW 之间的功能存在一些重大差异。MPW 有一个很棒的界面，但是你不能同时运行两个命令行程序，即使是在一个被挂起来运行另一个的非常微不足道的情况下也是如此。这意味着“make”程序无法运行编译器。相反，“make”生成了一个运行编译器的 shell 脚本。您通常会使用某种键盘快捷键来运行“make”，然后将生成的输出作为 shell 脚本运行。

    现在，这似乎暗示管道不起作用，但我认为管道只是处理临时文件的语法糖。

    据我所知，Xcode 没有 MPW 遗产。Xcode 源自于 NeXT 开发的 Project Builder，而 NeXT 始终是 Unix。Apple 将一些旧的 MPW 命令行工具移植到 OS X，但数量不多。最大的是`Rez`（和`DeRez`）。由于它们附带最新的 Xcode，我猜可能*有人*仍在使用它们。Rez 的头文件仍然存在，从过去的检查中得到一个爆炸：

    ```
    find /System/Library/Frameworks -name '*.r' 
    ```

似乎 Apple 真的清除了他们的开发网站上的任何早于 10.6 的内容，这有点可惜。不久前，您仍然可以在 Apple 网站上找到旧的 pre-Carbon 文档，包括所有“Inside Macintosh”系列。您以前也可以从 Apple 的 FTP 站点获得 MPW（它是免费的），我仍然有下载，但我不知道您是否仍然可以下载它。

请注意，您需要 10.4（或更早版本）和 PowerPC 计算机才能考虑使用它，除非您设法让 Sheep Shaver 工作。

有趣的花絮，MPW 的 C 编译器可能会产生一些有趣的错误消息。

```
在你程序的这一点上，一个 typedef 名称对我来说是一个完全的惊喜

您不能修改常量、上游浮动、赢得 IRS 的参数或满足此编译器

......而领主说，'看，在 switch 语句中只能有大小写或默认标签'

输入（强制转换）必须是标量；ANSI 3.3.4；第 39 页，第 10-11 行（我知道你不在乎，我只是想惹你生气）

称我为偏执狂，但在此评论中发现“/*”让我怀疑

符号表已满 - 致命的堆错误；请从您当地的 Apple 经销商处购买 RAM 升级

一行错误太多（减少）

此标签是包含此标签的块外部的 goto 目标，并且此块有一个带有初始化程序的自动变量，并且您的窗口不够宽，无法读取整个错误消息

我们已经做了这个功能

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T00:08:16.560

THINK C/Symantec C 也有一个标准的 I/O 窗口，使移植命令行程序相对容易。程序参数是通过对话框输入的。

但是最好的方法是使用 MPW - Macintosh Programmer's Workshop。对于 MacOS 来说，这是一个非常好的命令行环境、出色的编辑器、可编写脚本、各种“工具”以及内置的许多有用的 GUI 方面（因此它真正类似于 Mac）。

多年来，这可以从 Apple 的开发者网站免费下载。看起来链接现在可能已经消失了，但我确信可以通过一些搜索在网上找到一个副本。（尝试搜索 MPW-GM.img.bin 或 mpw-gm_images。）

# ruby - 在 Ruby 中读取制表符分隔的文件并连接选择性列

> ID：13463878
> 
> 赞同：1
> 
> 时间：2012-11-19T22:57:53.713
> 
> 标签：ruby, text-parsing

我有一个制表符分隔文件，其中前 10 列始终存在并保持在同一位置，但在第 10 列之后，列数可以更改。我想按原样保留前 10 列，并将其余列连接成一列，以`|`.

这是示例数据：

> 列： col1 col2 ... col 10 col11 col12 col13
> 
> 值：1 2 ... 10 11 12 13

结果：

> 列： col1 col2 ... col10 **col11|col12|col13**
> 
> 值：1 2 ... 10 **11 | 12 | 13**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:05:15.070

你可以从类似的东西开始

```
IO.foreach('path/to/file') do |line|
  splits = line.split("\t")

  col1, col2, col3, col4, col5, col6, col7, col8, col9, col10 = splits

  col11 = splits[10..-1].join('|')
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:22:35.357

看看 ruby​​ 的[split](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-split)方法——它有一个可选`limit`参数。假设您的数据在`row`每一行的变量中：

```
values = row.split("\t", 11) 
```

示例（为简洁起见，可变部分从第 3 列开始）：

```
s = "1\t2\t3\t4" 
cols = s.split("\t", 3) 
# result: ["1", "2", "3\t4"] 
```

然后您可以更改最后一个元素：

```
cols[2] = cols.last.gsub("\t", "|")
# cols is now: ["1", "2", "3|4"] 
```

# javascript - 在表单 POST 之前清除查询字符串的引用者

> ID：13463879
> 
> 赞同：0
> 
> 时间：2012-11-19T22:58:04.980
> 
> 标签：javascript

我有一个 POST 到 3rd-party 服务以进行验证和信息捕获的表单。在 3rd-party 后端，您可以为错误指定一个 URL，其中一个选项是“引用 URL”。

这看起来很完美。用户发布了一个无效的表单，他们所在的页面“重新加载”（不是真的，但这就是印象），错误消息取自查询字符串，如下所示：

```
http://somesite.com/?errorMessages=some%20message~~~some%20other%20message~~~etc 
```

我解析出单独的错误消息并将它们推送到一个 DIV 中，该 DIV 会告知用户出了什么问题。到现在为止还挺好。

但是，用户继续搞砸表单，当他们再次发布时，引用者现在是整个 URL，包括错误消息。服务器回复原始错误消息（毕竟是引用者！）以及任何剩余问题：

```
http://somesite.com/?errorMessages=some%20message~~~some%20other%20message~~~etc&errorMessages=new%20message~~~another%20new%20message~~~etc 
```

您可以看到问题，但要清楚：

1.  表格足够长，可以开始；这些未经检查的附加最终会导致查询字符串超出浏览器限制并且您会收到错误。
2.  解析算法不只报告最新的问题。它仍在报告原始问题。

*唷*

**对于一个简单的问题，这是一个很长的背景故事：**

在提交事件中，有没有办法使用 JavaScript 从引用 URL 中清除查询字符串？我不想进行任何引荐来源网址欺骗或避免任何合法的安全问题，我只想能够发送“真实”引荐页面减去查询字符串。

我已经在使用 jQuery，所以任何答案也可以免费使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:05:03.737

这是一种方法：

1.  到第 3 方网站的帖子带有推荐人[http://myapp.com/mypage](http://myapp.com/mypage)。
2.  第 3 方网站重定向到[http://myapp.com/mypage?errorMessages=Invalid](http://myapp.com/mypage?errorMessages=Invalid)
3.  在服务器端的 HTTP 请求处理程序（无论它是什么）中，您将 errorMessages 放入您的会话（在服务器端）并重定向到[http://myapp.com/mypage](http://myapp.com/mypage)。
4.  在渲染页面时，您使用会话中的错误消息（如果需要，清除它们）。我相信这些被称为闪存会话变量。

# android - 如何打开 com.android.contacts/.CallDetalActivity

> ID：13463881
> 
> 赞同：0
> 
> 时间：2012-11-19T22:58:09.403
> 
> 标签：android, android-intent, uri, calllog

我想打开 calldetail 活动以查看联系人通话记录信息。

我用这段代码取uri

```
Uri lookupUri = Uri.withAppendedPath(CallLog.Calls.CONTENT_FILTER_URI, Uri.encode(c1.getString(c1.getColumnIndex(CallLog.Calls.NUMBER)))); 
```

现在如果我使用

```
 Intent intent = new Intent(Intent.ACTION_VIEW,lookupUri);
    startActivity(intent); 
```

它会打开我手机上的通话选项卡，但不会打开 calldetail 活动。如何使用lookupUri 显示calldetail 活动？

编辑：感谢 commonsware 我做了修改

```
Uri lookupUri = Uri.withAppendedPath(CallLog.Calls.CONTENT_URI, Uri.encode(c1.getString(c1.getColumnIndex(CallLog.Calls._ID)))); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:14:11.910

尝试添加`CallLog.Calls.CONTENT_TYPE`为您的`Intent`.

# scala - 如何在 Akka 中保留请求上下文数据

> ID：13463883
> 
> 赞同：9
> 
> 时间：2012-11-19T22:58:14.003
> 
> 标签：scala, asynchronous, playframework, akka

作为一名长期的 Java EE 开发人员，我使用 MDC（映射诊断上下文）方法来处理与请求相关的上下文数据的传递，例如，用于跟踪在该请求的生命周期。

鉴于它依赖于 ThreadLocal，很明显这种方法在使用异步技术时会崩溃。

我仍处于学习 Scala 的早期阶段，与这个问题更相关的是 Akka。我阅读了大量论坛帖子，确认 Akka 和 MDC 不兼容，但尚未发现以某种方式模仿 MDC 方法的一致策略。

将此类数据作为在参与者之间发送的消息的一部分显式传递是最好的吗？它有点脏，但同时与轻松扩展的能力兼容。

除了直接通过消息之外，还有其他方法可以将上下文传递给 Actor 吗？另外，有没有人在使用 Play 2.0 Async 块时遇到过同样的挑战？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T00:02:57.193

我认为您可以`ThreadLocal`在静态上下文中使用 -s 声明，与此代码中的 executor 隐式参数相同：

```
implicit val executor = context.dispatcher
val f = Future[Boolean] {
  someTask()
} andThen { 
  case err if err.isLeft => log.error("Some error: " + err.left.get); false
  case ok if ok.isRight => log.info("Good work: " + ok.right.get); true
} 
```

每次未来向调度程序提交任务时，将线程安全上下文对象从一个线程复制到另一个线程。因此，您需要一个自定义调度程序-无论如何读取`ThreadLocal`，将其存储在执行程序（调度程序）内部的某个位置，然后提交将首先写入的任务`ThreadLocal`

# php - 如何过滤掉用户已回答的问题？

> ID：13463884
> 
> 赞同：0
> 
> 时间：2012-11-19T22:58:15.600
> 
> 标签：php, mysql

我正在使用 AJAX、PHP 和 MySQL 构建一个小型测验/测试引擎。所有数据（问题、答案等）都存储在数据库中。

我遇到的问题是我无法找到如何过滤掉已登录用户已回答的问题，因此导致问题被重复和永无止境的测验/测试。

当您单击“下一个问题”按钮时，会发送一个 AJAX 请求来`submit_answer.php`提交答案（将行添加到`user_answers`表中），它还会发送一个请求`get_question.php`，然后返回问题信息（问题、答案等）的 JSON，但是我似乎无法不选择已回答的问题（表中的问题`user_answers`）。这是我现在所拥有的：

```
$question = mysql_query("SELECT *, q.id qid, q.question question_text 
                         FROM questions q, user_answers ua
                         WHERE q.id != ua.question_id 
                           AND ua.test_id = $test 
                           AND ua.user_id = $_SESSION[userid] 
                         ORDER BY rand() 
                         LIMIT 1");

$q = mysql_fetch_assoc($question); 
```

此查询应该选择具有`test_id`当前测试的问题，`user_id`作为当前用户，而不是在`user_answers`表中。但显然，我只是做得不对。

你可以在这里看到整个`get_question.php`文件：http: [//pastebin.com/Td6mqp49](http://pastebin.com/Td6mqp49)

### 编辑：

这是@MadaraUchiha 要求的我的表结构：

`questions`

![在此处输入图像描述](../Images/b3a79c49cdf12385c064967523287870.png)

`user_answers`

![在此处输入图像描述](../Images/64c313ab36ceee733a8260b820a711a3.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:01:15.520

```
SELECT *, q.id qid, q.question question_text 
FROM questions q
WHERE NOT EXISTS (
    SELECT TRUE
    FROM user_answers ua
    WHERE ua.question_id = q.id
    AND ua.test_id = $test 
    AND ua.user_id = $_SESSION[userid]
)
ORDER BY rand() 
LIMIT 1 
```

您的查询不起作用的原因是，`q.id != ua.question_id`只要至少有一个不属于该问题的答案 -*任何*答案，它就会匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:02:47.423

您需要在 user_answers 表的问题之间进行左外连接。

最终查询如下所示：

```
SELECT *, q.id qid, q.question question_text 
FROM questions q left outer join
     user_answers ua
     on q.id = ua.question_id and
        ua.test_id = $test and
        ua.user_id = $_SESSION[userid] 
WHERE ua.user_id is null
ORDER BY rand() 
LIMIT 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:03:22.647

```
SELECT * FROM
questions q
WHERE 
q.id NOT IN (
    SELECT question_id as id
    FROM user_answers
    WHERE ua.test_id = $test AND ua.user_id = $_SESSION[userid]
) 
```

附带说明一下，请确保在传递给 SQL 之前正确清理数据。

# ios - UITableView 重新排序 UIViewController 中的单元格 - 重新排序控件未显示

> ID：13463886
> 
> 赞同：7
> 
> 时间：2012-11-19T22:58:32.687
> 
> 标签：ios, objective-c, uitableview

我试图让 UITableView 有 2 类 UITableViewCell （第 0 节有一行，第 1 节有 [self.dataArray count] 行）。

我尝试了这些链接：http: [//developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/ManageReorderRow/ManageReorderRow.html](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/ManageReorderRow/ManageReorderRow.html)

[UITableView 中的重新排序控件](https://stackoverflow.com/questions/1361820/reordering-control-in-uitableview)
[重新排序控件未显示在表格视图上](https://stackoverflow.com/questions/4769418/reorder-control-isnt-displayed-on-table-view)

我已经添加：

```
 -(void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath
{   

    // Get the object we are going to move
    Task *task = [[Task alloc] init];
    task = [self.taskArray  objectAtIndex:[destinationIndexPath row]];

    // We will delete and move it to another location so well have to retain it
    //[task retain];

    // Remove it an move it to other place
    [self.taskArray removeObjectAtIndex:[sourceIndexPath row]];
    [self.taskArray insertObject:task atIndex:[destinationIndexPath row]];
}

     // Override to support conditional rearranging of the table view.
     - (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath{
         if (indexPath.section == 1) {
             return YES;
         }
         return YES;
     } 
```

我确实为每个 UITableViewCell 类添加了：

```
cell.showsReorderControl = YES; 
```

但仍然没有运气，没有显示 readorderControl ......有人吗？有这么多教程，但对我不起作用，这是非常紧迫和烦人的。

### 编辑：

我更改了一些主题以包含事实，即我使用的是 UIViewController 而不是 UITableViewController。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-19T23:15:43.490

要在 a 中实现行重新排序`UITableView`，您需要实现`tableView:canMoveRowAtIndexPath:`and `tableView:moveRowAtIndexPath:toIndexPath:`，您可能还需要实现`tableView:targetIndexPathForMoveFromRowAtIndexPath:toProposedIndexPath:`。

最重要的是，表格视图必须处于编辑模式才能显示重新排序控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T09:47:13.033

尝试这个 。. .this 将在编辑模式下的简单表格视图的情况下处理单元格的排列和更新

```
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
  return YES;
}

- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath
{
     [tableData insertObject: [tableData objectAtIndex:sourceIndexPath.row] atIndex:destinationIndexPath.row];
     [tableData removeObjectAtIndex:(sourceIndexPath.row + 1)];
} 
```

# ruby-on-rails-3 - Backbone.js + Rails 3 urls 和带有嵌套路由的集合

> ID：13463889
> 
> 赞同：2
> 
> 时间：2012-11-19T22:58:55.993
> 
> 标签：ruby-on-rails-3, backbone.js, routes, has-and-belongs-to-many, nested-routes

我正在尝试使用 Rails 和 Backbone.js 创建一个新应用程序，但是有很多嵌套关系使它变得相当困难。

在 Rails 方面，我使用成分和过敏原之间的 HABTM 关系。我正在尝试获取与一系列过敏原相关的成分。计划是使用数组查询 Allergens 表，获取它们的 id，然后根据 AllergensIngredients 表查询它以获取成分 id。

路由嵌套如下：

```
 resources :ingredients do
    resources :allergens
  end 
```

网址为“/ingredients/:ingredient_id/allergens”。它非常适合 Rails。在 Backbone 方面，我尝试使用 Collections 来获取带有 url '/allergens' 的过敏原，但根据我的 Rails 路由（路由'/allergens' 不存在），这被拒绝了。所以，我`resources :allergens`在我的嵌套路由下添加了一个独立的路由。这为 Backbone 创建了一条可识别的路线，但我的 Rails allergens_controller.rb 仍然存在问题：

```
 class AllergensController < ApplicationController
    respond_to :html, :json
    def index
      respond_with(
        @ingredient ||= Ingredient.find(params[:ingredient_id]),
        @allergens = @ingredient.allergens,
      )
    end
  # ...
  end 
```

因为没有 id 就无法找到 @ingredient。我尝试过使用 Backbone.sync 和 $.get，但它们仍然需要一个 url，它最终会通过 rails 控制器。如何使用 Backbone 只查询数据库中的单个表，而不受 Rails 或 url 的任何干扰？非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:23:48.690

我用不同的方法让它工作。我在刚刚返回 Allergen.all 的 allergens_controller 中创建了一个新操作，然后在 Backbone 中使用 AJAX 获取请求来返回 xhr 对象。不是一个优雅的修复，但仍然是一个修复！

# multithreading - 不同线程中的上下文切换

> ID：13463893
> 
> 赞同：1
> 
> 时间：2012-11-19T22:59:06.937
> 
> 标签：multithreading, concurrency, multitasking

有没有办法执行抢占式同线程上下文切换？

我很确定这不是描述我正在寻找的内容的正确方式，所以这里有一个更长的描述：
我想要与 POSIX`ucontext_t`或`boost::context`. 可能还有其他我不知道的。我不知道它的官方术语，但基本上它们允许单线程多任务处理。这两个库都需要“协作”代码，即当前运行的“线程”必须显式执行上下文切换。
我正在寻找一种强制上下文切换的方法。我认为这必须从一个单独的线程（真正的操作系统线程）完成。我想要一组“上下文”，冻结执行路径，并能够切换到我选择的任何一个，冻结当前执行。

我不在乎解决方案是否为“切换器”使用单独的线程（我认为这是必需的）。
我对 Java/C#/C++/C 解决方案，或者 C/C++ 和一些最小程序集的组合很好。
我希望它是跨平台（Windows 和 Linux）和交叉编译器（GCC、MinGW 和 VS，假设为 ac/c++ 解决方案），但我知道这不太可能。至少它应该在至少有一个编译器的 Windows 上工作。
我几乎可以使用所需的任何库或兼容层（例如`boost`，或某种“Windows 上的 POSIX”层）

我希望这不是要求太多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T15:44:58.650

[boost.fiber](http://github.com/olk/boost-fiber) - can be programmed like boost.thread but provides user-land threads

# list - 如何调用给定范围内的部分列表

> ID：13463897
> 
> 赞同：0
> 
> 时间：2012-11-19T22:59:40.127
> 
> 标签：list, python-3.x, call, range, threshold

我有一个问题，需要我接受用户输入并返回该值或高于该值的所有项目，最高 100

我问用户他想从我拥有的一组数据中看到什么成绩。

所以我会让用户输入一个等级，我将返回该等级或更高等级的人的所有记录。

这是我到目前为止所拥有的

我从中提取的一小部分数据看起来像这样

```
 ['Bud', 'Abbott', 51, 92.3]
 ['Don', 'Adams', 51, 90.4]
 ['Mary', 'Boyd', 52, 91.4]
 ['Jill', 'Carney', 53, 76.3]
 ['Hillary', 'Clinton', 50, 82.1]
 ['Randy', 'Newman', 50, 41.2] 
```

到目前为止，我的代码只是一些确保用户输入正确函数的 if 和 elif 语句。此功能将起作用，如果用户输入字母 g，程序将要求一个等级阈值，然后将返回任何具有该等级及以上等级的数据行。

例如，如果我是用户，我输入 g 然后输入 90 我只会得到这三行

```
 ['Bud', 'Abbott', 51, 92.3]
 ['Don', 'Adams', 51, 90.4]
 ['Mary', 'Boyd', 52, 91.4] 
```

此外，如果用户输入字母 S，它会找到该部分的记录并返回该部分中的所有学生，因此如果用户输入 s 然后 50 程序将返回

```
 ['Hillary', 'Clinton', 50, 82.1]
 ['Randy', 'Newman', 50, 41.2] 
```

到目前为止我写的代码看起来像这样

```
def Query ():
    input("enter query type (g or s):")
    #checks user's input and takes user to grades
    if (operator == "g"):
        print("You have chosen to query Grades")
    GradeThreshold=input("enter the Grade threshold:")

    #checks user's input and takes user to section 
    elif (operator == "s"):
         print("You have chosen to query Section")
    SectionNumber=input("enter the section:")

    elif (operator != "g") and (operator != "s"):
          print("Invalid entry. Please re-enter the operation from above.")
    return() 
```

我对如何接受用户输入并让它从我上面的数据列表中选择等级范围或部分编号感到困惑。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:35:11.340

您需要遍历这些项目。例如：

```
items = [['Bud', 'Abbott', 51, 92.3],
         ['Don', 'Adams', 51, 90.4],
         ['Mary', 'Boyd', 52, 91.4],
         ['Jill', 'Carney', 53, 76.3],
         ['Hillary', 'Clinton', 50, 82.1],
         ['Randy', 'Newman', 50, 41.2]]

for item in items:
    print(item) 
```

这将按顺序打印所有项目。要从项目中获取值，您需要使用括号按索引访问它：

```
for item in items:
    print item[2] # Prints the 3rd element in item (because indexes start at 0) 
```

或在迭代时解包项目：

```
for first_name, last_name, some_integer, grade in items:
    print('Name:', first_name, last_name)
    print('Grade:', grade) 
```

当每个项目中的项目很少时，第二种解决方案被视为更*惯用，它是首选，因为它更清楚项目的组成。*

假设这是家庭作业，我想你可以从这里完成。

# javascript - 在 IISNode 中运行时，尚未为上下文加载模块名称“http”或“longjohn”：_

> ID：13463899
> 
> 赞同：0
> 
> 时间：2012-11-19T22:59:46.897
> 
> 标签：javascript, node.js, backbone.js, requirejs, iisnode

我正在开发一个基于 javascript 的应用程序，并且突然开始看到这些错误。

*   **消息：尚未为上下文加载模块名称“http”：_** [http://requirejs.org/docs/errors.html#notloaded](http://requirejs.org/docs/errors.html#notloaded)

我首先收到了 Longjohn 的错误（我的 node_modules 目录中有该模块），但是当我对此发表评论时，它开始引发下一个所需模块的问题，即“http:.

我看到的其他错误：

*   **'web' 为 null 或不是对象 - 在这一行中：env.web.protocol**

*   **'io' 为 null 或不是对象 - 在简单的 socketIO 连接方法中。**

定义（['socket.io']，函数（io）{

```
var socketConnection;

return {
    getConnection: function() { 
        if (! socketConnection) {
            socketConnection = io.connect();
        }
        return socketConnection;
    }
} 
```

所有这些在节点下都可以正常工作，但在 IISNode 下运行时会出现问题。我尝试了简单的 express 和 node 示例，效果很好。我在我的项目中使用 Node、IISNode、require.js、主干和下划线。我是 javascript 新手，非常感谢任何解决此问题的指针

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T17:46:37.877

这原来是 IISNode 设置中的一个问题，重新安装修复了它。但是，重新安装后，我必须在 web.config 文件中再次设置 IISNode 处理程序。不确定卸载是否也会从应用程序中删除配置详细信息。

```
 <handlers>
      <add name="my-app" path="index.js" verb="*" modules="iisnode" />
    </handlers> 
```

# dns - 您如何配置 dns 以允许将域指向另一个 url 的 url？

> ID：13463901
> 
> 赞同：0
> 
> 时间：2012-11-19T23:00:01.237
> 
> 标签：dns, amazon-web-services, webserver, cname, amazon-route53

我有兴趣使用域上的 url 设置 mysite.com 的博客：

```
Desired: mysite.com/blog
Not blog.mysite.com 
```

示例：http: [//37signals.com/svn/](http://37signals.com/svn/)

您如何修改 DNS 以实现这一目标？我不确定这叫什么，这使得谷歌甚至很难搜索想法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:51:52.633

@SamDufel 说的是对的：域是一回事（IP 地址的名称），路径是服务器上的东西。

此映射从定义域的 DNS 服务的域注册商（例如 GoDaddy）开始。如果您的定义为指向 AWS Route 53 服务器，那么您就是在其中进行 DNS 更改。在您更改域名注册商的 DNS 设置之前，请倾向于使用他们自己的 DNS 服务器。

所以现在您需要确保您的域`mysite.com`解析到托管您的博客的服务器。如果您使用的是 tumblr，您可能需要在 DNS 配置中创建 CNAME 记录。但这仍然只会产生一个 IP 地址（例如，“无论我从 tumblr.com 获得什么 IP 地址，我都会从 mysite.com 获得”）。

因此，您很可能需要配置 tumblr 帐户以知道当它从该域收到请求时要做什么——这完全取决于博客软件如何处理。

# css - 浮动左div停留在页面底部

> ID：13463902
> 
> 赞同：1
> 
> 时间：2012-11-19T23:00:05.733
> 
> 标签：css, html

我一直在努力解决这个问题已经有一段时间了，我只是被难住了。基本上我有一个左侧导航栏，然后我想要主要内容就在它的右侧，但无论我尝试什么，主要内容都在页面底部。

这是页面的代码部分。

```
<div class="leftnav">
<?php require_once('includes/leftnav.php'); ?>
 </div>
<div class="mainContent">
<?php if (isset($_SESSION['MM_UserGroup'])) { ?>
  Welcome back <?php echo $_SESSION['MM_UserGroup']; ?>.
<p>Here are just a few of your latest stats.</p>
<table width="500" border="1">
 <tr>
  <td scope="col">Most recent show total:</td>
  <th scope="col"><?php echo "$".$row_MostRecent['total_retail']; ?></th>
</tr>
<tr>
  <td>Current month shows total:</td>
  <td><?php echo "$".$row_CurrentMonth['CurrentMonth']; ?></td>
</tr>
<tr>
  <td>Last month shows total:</td>
  <td><?php echo "$".$row_LastMonth['LastMonth']; ?></td>
</tr>
<tr>
  <td>Year to date shows total:</td>
  <td><?php echo "$".$row_YeartoDate['YeartoDate']; ?></td>
</tr>
</table>
<p>&nbsp;</p>
<p>
<?php } else { ?>
Alternative text if user is not logged in.
<?php } ?>
</p>
<div class="clearfloat"></div>
</div> 
```

现在这里是上面列出的这些特定 div 的 CSS 代码。

```
.leftnav {
height: auto;
width: 25%;
border: 1px #000 solid;
float:left;
}
.mainContent {
float: left;
width: 70%;
padding-top: 10px;
padding-right: 0;
padding-bottom: 10px;
padding-left: 0;
}

.clearfloat { 
clear:both;
height:0;
font-size: 1px;
line-height: 0px;
} 
```

希望有人可以帮助我找出我哪里出了问题。作为一些附加信息，我正在为这个站点使用 Dreamweaver CS5。提前感谢您的任何反馈。

这是 leftnav.php 包含文件中的 HTML/CSS 代码。

```
 <?php if (!isset($_SESSION['MM_Username'])) { ?>
 <div id="login">
 Please login below:
 <form ACTION="<?php echo $loginFormAction; ?>" method="POST">
<p>
  <label for="username">Username:</label>
  <input name="username" type="text" id="username" />
</p>
<p>
  <label for="password">Password:</label>
  <input name="password" type="password" id="password" />
</p>
<p>
  <input type="submit" name="submit" id="submit" value="Submit" />
 </p>
 </form>
 <?php } else { ?>
 <?php echo "Welcome " . $_SESSION['MM_UserGroup']  . "!"; ?>
 <br />
 <a href="<?php echo $logoutAction ?>">Log out</a>
 <?php } ?>
 <p>Upcoming shows: </p>
<?php if (isset($_SESSION['MM_UserGroup'])) { ?>
<table class="upcoming" border="1">
  <tr>
    <th width="50%" scope="col">Hostess</th>
    <th width="50%" scope="col">Date/Time</th>
  </tr>
  <?php do { ?>
  <tr>
      <td><?php echo $row_UpcomingShows['hostess_fname'] . " " . $row_UpcomingShows['hostess_lname']; ?> </td>
      <td><?php $date = date_create($row_UpcomingShows['actual_datetime']); echo date_format($date, 'D M j Y'); ?></td>
  </tr>
  <?php } while ($row_UpcomingShows = mysql_fetch_assoc($UpcomingShows)); ?>
</table>
<?php } ?>
<p><br />
  Newest daughters:
  <br />
  </p>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T01:01:28.580

您的宽度加起来超过屏幕的 100%。您正在使用 95% + 未指定`.leftnav`和`.maincontent`边距 + 上的默认填充`.leftnav`。指定`0px`填充和边距，没有问题。

# python - 在 Python 中删除临时文件

> ID：13463903
> 
> 赞同：7
> 
> 时间：2012-11-19T23:00:06.407
> 
> 标签：python, join, zip

这是我现有的压缩文件夹的代码，我主要是从这里的帮助中整理出来的：

```
#!/usr/bin/env python

import os
import sys
import datetime

now = datetime.datetime.now().strftime("%Y-%m-%d_%H-%M")
target_dir = '/var/lib/data'
temp_dir='/tmp'

zip = zipfile.ZipFile(os.path.join(temp_dir, now+".zip"), 'w', zipfile.ZIP_DEFLATED)
rootlen = len(target_dir) + 1
for base, dirs, files in os.walk(target_dir):
   for file in files:
      fn = os.path.join(base, file)
      zip.write(fn, fn[rootlen:]) 
```

如果我想删除我刚刚在操作结束时创建的 zip 文件，最好的命令是这个吗？

```
os.remove.join(temp_dir, now+".zip") 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T00:02:44.043

会`os.remove(os.path.join(temp_dir, now + ".zip"))`好的。

但是，您应该确保它在您希望的每种情况下都正确执行。

如果要在任何情况下将其删除，您可以这样做

```
create it
try:
    work with it
finally:
    remove it 
```

但在这种情况下，您也可以使用该`tempfile`模块：

```
import tempfile
with tempfile.NamedTemporaryFile(suffix='.zip') as t:
    z = zipfile.ZipFile(t.name, 'w') # re-create it
    do stuff with z
# after the with clause, the file is gone. 
```

但是，如果您希望它仅在特殊情况下（成功，错误，...）消失，您会被卡住，`os.remove(os.path.join(temp_dir, now+".zip"))`并且您应该在要删除文件时使用它。

```
try:
    do_stuff
except VerySpecialException:
    os.remove(os.path.join(temp_dir, now+".zip")) # do that here for a special exception?
    raise # re-raise
except: # only use a bare except if you intend to re-raise
    os.remove(os.path.join(temp_dir, now+".zip")) # or here for all exceptions?
    raise # re-raise
else:
    os.remove(os.path.join(temp_dir, now+".zip")) # or here for success? 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:04:58.067

这将是这样做的方法：

```
os.remove(os.path.join(temp_dir, now+".zip")) 
```

玩得开心，迈克

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T15:30:46.397

考虑使用 Python 的[内置临时文件库](http://docs.python.org/2/library/tempfile.html)。它在关闭时处理临时文件的清理。

# bash - 将时间戳与“在线文件”进行比较

> ID：13463904
> 
> 赞同：0
> 
> 时间：2012-11-19T23:00:09.443
> 
> 标签：bash, comparison, timestamp, wget

我做类似的事情

```
wget --user=userName --password=passWord  --timestamping https://url.to/a/file.csv.gz
gzip -cd file.csv.gz > file.csv 
```

（未测试）

请注意，服务器需要身份验证。

仅当文件比本地文件新时才会下载该文件。这很好。

但是，仅当远程文件比本地文件新时才应执行第 2 行。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T23:07:37.470

只是测试看看 的修改时间`file.csv.gz`是否比`file.csv`.

在 Linux 上：

```
if [ $(stat -c '%Y' file.csv.gz) -gt $(stat -c '%Y' file.csv) ]; then
    gzip -cd file.csv.gz > file.csv
fi 
```

在 BSD（如 Mac OS X）上：

```
if [ $(stat -f '%m' file.csv.gz) -gt $(stat -f '%m' file.csv) ]; then
    gzip -cd file.csv.gz > file.csv
fi 
```

其他系统可能有不同的论点`stat`；检查`man stat`您的系统，或者`help stat`它是否是内置的 shell。

# visual-studio-2012 - 共享代码分析规则和字典

> ID：13463907
> 
> 赞同：0
> 
> 时间：2012-11-19T23:00:27.867
> 
> 标签：visual-studio-2012, code-analysis, fxcop

我们正在迁移到 Visual Studio Professional 2012，现在可以访问代码分析。

之前，我们使用 FxCop 并传递了`SourceControlPath\OurFxCopSharedProject.FxCop`. 我们还在`CustomDictionary.xml`包含 FxCop.exe 的（源代码控制）文件夹中添加了一个。这很有效，因为我们使用了许多行业特定的术语并标准化了我们的分析规则。

在 VS 2012 中，似乎[必须将代码分析字典应用于每个项目](http://msdn.microsoft.com/en-us/library/bb514188.aspx)，并且[必须为每个项目指定规则集](http://msdn.microsoft.com/en-us/library/dd465181.aspx)。

有没有办法将现有项目和新项目默认为我们的标准`.ruleset`和`CustomDictionary.xml`（而不是 Microsoft 最低推荐规则和标准字典）？我们有数百个解决方案和更多项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:18:23.657

是的，至少你可以在 VS2010 上运行，而且我认为它在 VS2012 上也一样。

我按照[这篇博](http://kentb.blogspot.co.nz/2011_01_01_archive.html)文中描述的细节进行了操作，这对我来说非常有用。

VS2010 中还有一个问题，即为第一个构建的项目配置的规则集成为所有项目的规则集，无论配置了什么。这对我来说效果不佳，因为我放宽了单元测试项目的规则。我认为（希望）它在 VS2012 中已修复，但如果不是，此过程也提供了解决方法。

* * *

**更新**

博客已不存在。我在[http://web.archive.org/web/20140531211137/http://kentb.blogspot.co.nz/2011_01_01_archive.html](http://web.archive.org/web/20140531211137/http://kentb.blogspot.co.nz/2011_01_01_archive.html)找到了以下内容。

仍然可以在[https://onedrive.live.com/?cid=328ba01b2a22de20&id=328BA01B2A22DE20%21178&authkey=!ALAeFtsfPqgdMCk找到示例解决方案](https://onedrive.live.com/?cid=328ba01b2a22de20&id=328BA01B2A22DE20%21178&authkey=!ALAeFtsfPqgdMCk)

所有功劳归功于[肯特·布加特](https://stackoverflow.com/users/5380/kent-boogaart)

* * *

**没有 Visual Studio 2010 的代码分析**

这篇文章提供了有关如何将 Visual Studio 2010 的代码分析集成到您的构建中的分步说明。如果您还没有这样做，请阅读我的第一篇文章，了解将要实现的目标。如果您愿意，可以按照我上一篇文章中的说明集成 Visual Studio 2008 的代码分析。虽然您需要一台安装了 Visual Studio 2010 的机器，但一旦正确设置，这将不是构建项目的要求。我假设 Visual Studio 安装在默认位置 - 根据需要调整路径。

假设我们从以下目录结构开始：

```
Project 
    Lib 
    Src 
```

**第 1 步：**复制代码分析工具

`C:\Program Files\Microsoft Visual Studio 10.0\Team Tools\Static Analysis Tools\FxCop`复制to的全部内容`Lib\Code Analysis`。

`C:\Program Files\MSBuild\Microsoft\VisualStudio\v10.0\CodeAnalysis`复制to的全部内容`Lib\Code Analysis`。

将以下文件复制到`Lib\Code Analysis`：

*   `C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Microsoft.VisualC\v4.0_10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualC.Dll`
*   `C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Microsoft.VisualStudio.CodeAnalysis.Sdk\v4.0_10.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.CodeAnalysis.Sdk.dll`
*   `C:\Program Files\Microsoft Visual Studio 10.0\DIA SDK\bin\msdia100.dll` `C:\Program Files\Microsoft Visual Studio 10.0\VC\redist\x86\Microsoft.VC100.CRT\msvcp100.dll`
*   `C:\Program Files\Microsoft Visual Studio 10.0\VC\redist\x86\Microsoft.VC100.CRT\msvcr100.dll`

**步骤 2：**创建代码分析目标文件

创建一个名为的文件`CodeAnalysis.targets`并将其放在您的`Src`目录中。这是此文件内容的起点。您应该根据需要进行调整：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <!--
        Inject our own target before the code analysis runs.
        -->
        <RunCodeAnalysisDependsOn>
            ConfigureCodeAnalysis;
            $(RunCodeAnalysisDependsOn);
        </RunCodeAnalysisDependsOn>

        <!--
        Ensure code analysis is run
        -->
        <RunCodeAnalysis>True</RunCodeAnalysis>

        <!--
        Set this to false if you don't want all code analysis violations to be treated as errors.
        -->
        <CodeAnalysisTreatWarningsAsErrors>True</CodeAnalysisTreatWarningsAsErrors>
        <!--
        This should be set to resolve to the Lib directory, which must contain the code analysis tooling.
        -->
        <PathToLib>$(MSBuildProjectDirectory)\..\..\Lib\</PathToLib>
        <!--
        This should be set to resolve to the directory containing this targets file.
        -->
        <PathToTargets>$(MSBuildProjectDirectory)\..\</PathToTargets>

        <!--
        Setting these properties is required in order for the code analysis targets to execute correctly.
        Without setting these, it will look for the tooling under default installation directories instead
        -->
        <CodeAnalysisTargets>$(PathToLib)\Code Analysis\Microsoft.CodeAnalysis.Targets</CodeAnalysisTargets>
        <CodeAnalysisPath>$(PathToLib)\Code Analysis</CodeAnalysisPath>
        <!--
        Assign default code analysis rules
        -->
        <CodeAnalysisRuleSet>$(PathToTargets)CodeAnalysis.Default.ruleset</CodeAnalysisRuleSet>
    </PropertyGroup>
    <UsingTask AssemblyFile="$(PathToLib)\MSBuildSdcTasks\Microsoft.Sdc.Tasks.dll" TaskName="StringComparison"/>
    <Target Name="ConfigureCodeAnalysis">
        <!--
        Assume that any projects with ".Tests" in their names are test projects
        -->
        <StringComparison Comparison="Contains" Param1="$(AssemblyName)" Param2=".Tests">
            <Output TaskParameter="Result" PropertyName="IsTestProject"/>
        </StringComparison>
        <!--
        Assign different rules for test projects (more relaxed)
        -->
        <CreateProperty Condition="$(IsTestProject)" Value="$(PathToTargets)CodeAnalysis.Tests.ruleset">
            <Output TaskParameter="Value" PropertyName="CodeAnalysisRuleSet"/>
        </CreateProperty>
    </Target>
</Project> 
```

**第 3 步：**创建规则集

在您的目录中创建名为`CodeAnalysis.Default.ruleset`and的文件。您可以使用 Visual Studio 2010 创建这些文件，方法是选择. 或者，您可以只复制下载示例中的文件。`CodeAnalysis.Tests.ruleset``Src``File / New / File / Code Analysis Rule Set`

**第 4 步：**为相关项目启用代码分析

对于每个需要代码分析的项目，打开 .csproj 文件并在导入之前插入以下内容`Microsoft.CSharp.targets`：

```
<Import Project="..\CodeAnalysis.targets" /> 
```

注意：在导入 Microsoft.CSharp.targets 之前插入它非常重要，而不是之后。

**第 5 步：**根据需要进行调整

您可能希望调整`CodeAnalysis.targets`、`CodeAnalysis.Default.ruleset`和`CodeAnalysis.Tests.ruleset`文件以更改启用的规则、使用规则集的条件等。如上所述，您可以使用 VS2010 创建和编辑`.ruleset`文件。

代码分析现在已与您的项目集成。从哪里构建无关紧要 - 无论是 Visual Studio、命令行还是构建服务器。在所有情况下，将为您的项目执行代码分析。您可以下载一个示例解决方案，在下面显示所有这些。

**故障排除**

如果你得到`CA0001 Phx.FatalError`，你可能需要`msdia100.dll`在构建机器上注册：

```
regsvr32 msdia100.dll 
```

如果您的构建用户有足够的权限，您也可以将其合并到您的构建脚本中。

# f# - 对于 F# 类型提供程序，如何为依赖程序集执行绑定重定向？

> ID：13463910
> 
> 赞同：9
> 
> 时间：2012-11-19T23:00:29.843
> 
> 标签：f#, type-providers, assembly-binding-redirect

我正在开发一个依赖于 FParsec 0.9.2.0 的 F# 类型提供程序。它取决于 FSharp.Core 4.0.0.0。当我尝试使用 F# 类型提供程序时，我收到此错误：

> {“无法加载文件或程序集 'FSharp.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' 或其依赖项之一。系统找不到指定的文件。”:“FSharp.Core, Version= 4.0.0.0，文化=中性，PublicKeyToken=b03f5f7f11d50a3a"}
> 
> === 预绑定状态信息 ===
> LOG: DisplayName = FSharp.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a (完全指定)
> LOG: Appbase = file:///C:/Program文件 (x86)/Microsoft Visual Studio 11.0/Common7/IDE/
> LOG：初始 PrivatePath = NULL
> 调用程序集：FParsec，版本=0.9.2.0，Culture=neutral，PublicKeyToken=e5c8267bb3bd1265。

我尝试添加 a`Froto.Gen.dll.config`和 a `FParsec.dll.config`，两者都有：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="FSharp.Core" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="4.0.0.0" newVersion="4.3.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

没运气。有任何想法吗？我的下一个行动计划是建立一个新的`FParsec.dll`，但这并不总是奏效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T20:17:24.010

当 args.Name 需要 4.0.0.0 时，您是否尝试过覆盖 AppDomain.CurrentDomain.AssemblyResolve 并在 FSharp.Core 4.3.0.0 的位置上执行显式 Assembly.LoadFrom？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-28T09:11:07.340

您实际上可以在类型提供程序中定义自己的程序集解析器。

如果您覆盖该`ResolveAssembly`方法，您可以提供自己的程序集解析方案。默认实现相当简单：

```
default this.ResolveAssembly(args) = 
    let expectedName = (AssemblyName(args.Name)).Name + ".dll"
    let expectedLocationOpt = 
        probingFolders 
        |> Seq.map (fun f -> IO.Path.Combine(f, expectedName))
        |> Seq.tryFind IO.File.Exists
    match expectedLocationOpt with
    | Some f -> Assembly.LoadFrom f
    | None -> null 
```

您还可以添加探测路径以影响检查装配分辨率的位置：

```
[<TypeProvider>] 
type MyProvider(config: TypeProviderConfig) as this = 
    inherit TypeProviderForNamespaces()
    do this.RegisterProbingFolder "/Developer/MonoTouch/usr/lib/mono/2.1/"
    ... 
```

# mysql - MySQL插入不存在/如果不存在

> ID：13463913
> 
> 赞同：1
> 
> 时间：2012-11-19T23:00:46.360
> 
> 标签：mysql, insert

我尝试了以下查询：

```
INSERT INTO `surfed_site` (user, site)
VALUES ('123', '456')
WHERE NOT EXISTS (SELECT site FROM `surfed_site` WHERE site=456) 
```

但我不断收到 MySQL 错误：

**1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以`surfed_site`在第 3 行的“WHERE NOT EXISTS (SELECT site FROM WHERE site=456)”附近使用正确的语法**

我不知道我做错了什么，有人可以指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:02:22.150

[`INSERT`语句支持两种¹语法：一种使用`VALUES`，另一种使用查询。](http://dev.mysql.com/doc/refman/5.6/en/insert.html)你不能组合它们，只有查询语法支持`WHERE`子句。所以：

```
INSERT INTO `surfed_site` (user, site)
SELECT '123', '456' FROM (SELECT 1) t
WHERE NOT EXISTS (SELECT site FROM `surfed_site` WHERE site=456) 
```

* * *

1.  实际上是*三种*语法；你也可以使用`SET`. 如果您只插入一条记录，则这条记录在功能上等同于`VALUES`，但可以说更具可读性。

# javascript - JSON 对象未定义

> ID：13463915
> 
> 赞同：1
> 
> 时间：2012-11-19T23:00:57.377
> 
> 标签：javascript, xml, json

我是一名学生，正在为我大学的图书馆网站开发一个电影浏览器项目。我有一些 Javascript 经验，但除了对这个项目的研究之外，我没有使用 XML 或 JSON 的经验。

我必须使用隐藏的 API 密钥查询我们馆藏中所有 DVD 的 WorldCat 搜索 API，并将 MARCXML 结果转换为 JSON。库服务器不支持服务器端脚本，所以我选择使用 Yahoo Pipes，它允许我将 API 密钥“隐藏”在私有字符串中，并将结果作为 JSON 返回。

我的问题是有时（但肯定不总是）我会收到一条错误消息：

`TypeError: root is undefined`

我假设与此错误的不一致是由于加载时间造成的（也许 Javascript 试图在 JSON 对象完全加载之前执行？如何提高代码效率以避免此错误？感谢您的任何建议。

下面你会发现我的代码的一个简短示例，它有时会重新创建此错误：

```
<!DOCTYPE html>
<html>
<head>
<script>
var my_JSON_object = {};
var movieArray = new Array();
var subject = 'Science+Fiction';
var recordSet = 1;

loadJSON(0);

function loadJSON(set) 
{
    if (set == 0)
        var yahooPipe = 'http://pipes.yahoo.com/pipes/pipe.run?_id=b54472aff1548e93022d07fddfd6aa38&_render=json&maximumRecords=20&startRecord=1&subject='+subject+'&_callback=getData';
    else
        var yahooPipe = 'http://pipes.yahoo.com/pipes/pipe.run?_id=b54472aff1548e93022d07fddfd6aa38&_render=json&maximumRecords=20&startRecord='+((set*20)+1)+'&subject='+subject+'&_callback=getNextData';
    var head = document.getElementsByTagName('head')[0];         
    var newJS = document.createElement('script');

    newJS.type = 'text/javascript';
    newJS.src = yahooPipe;
    head.appendChild(newJS);
}

function getData(json)
{
    my_JSON_object = json;
    if (my_JSON_object.value.items[0].numberOfRecords>0)
        prepData(0);
    else
        alert("No results...");
}

function getNextData(json)
{
    my_JSON_object = json;
    prepData(recordSet);
}

function loadData()
{   
    loadJSON(recordSet);
    recordSet++;
}

function prepData(set)
{
    var root = my_JSON_object.value.items[0];   

    if (set == 0 && root.numberOfRecords == 1)
    {
        root.records.record[0] = root.records.record;
    }

    for (var i=0; i<20; i++)
    {
        if (root.records.record[i]==undefined)  
        {
            document.getElementById('A1').innerHTML=root.numberOfRecords;
            document.getElementById('A2').innerHTML=movieArray[set*20+i-1];
            break;
        }

        for (var j=0; j<root.records.record[i].recordData.record.datafield.length; j++)
        {
            if (root.records.record[i].recordData.record.datafield[j].tag == 245)
            {               
                for (var k=0; k<root.records.record[i].recordData.record.datafield[j].subfield.length; k++)
                {
                    if (root.records.record[i].recordData.record.datafield[j].subfield[k].code == "a")
                    {
                        movieArray[i+(set*20)] = root.records.record[i].recordData.record.datafield[j].subfield[k].content; 
                        break;
                    }
                }
            }
        }
    }

    if (set*20<root.numberOfRecords)
        loadData();
}

</script>
</head>
<body>

<p><b>Results:</b><span id="A1"></span></p>
<p><b>Title(last record):</b><span id="A2"></span></p>

</body>
</html> 
```

# asp.net-mvc - 动态数字/货币格式与扩展方法/html 助手

> ID：13463918
> 
> 赞同：1
> 
> 时间：2012-11-19T23:01:09.213
> 
> 标签：asp.net-mvc, c#-4.0, extension-methods, html-helper, string.format

我们的数据库存储值及其相关格式。有些数字在小数点后有 0 个数字，有些是 1，有些是货币等。

我试图避免在需要显示数据的每个实例中执行以下操作。

```
@foreach (var i in Model.CandidateHireGoalsAndActivity)
{
    if (i.DataTypeId == 3)
    { 
        <tr>
            <td>@i.HireGoalName</td>
            <td>@i.ActivityValue.ToString("C0")</td>
            <td>@i.GoalValue.ToString("C0")</td>
        </tr>
    }
    else if (i.DataTypeId == 2)
    { 
        <tr>
            <td>@i.HireGoalName</td>
            <td>@i.ActivityValue.ToString("F2")</td>
            <td>@i.GoalValue.ToString("F2")</td>
        </tr>
    }
    else if....(etc)
} 
```

我正在尝试编写一个接收字符串和所需格式的基本扩展方法，然后我的代码可能看起来更像这样。

```
 @foreach (var i in Model.CandidateHireGoalsAndActivity)
    {
       <tr>
          <td>@i.HireGoalName</td>
          <td>@Html.FormatString(i.ActivityValue.ToString(), i.DataTypeId)</td>
          <td>@Html.FormatString(i.GoalValue.ToString(), i.DataTypeId)</td>
       </tr>
    } 
```

出于某种原因，从我的助手中出来的字符串永远不会被格式化。我传入的任何未格式化的数字都会被传回。我不确定我做错了什么或错过了什么。

辅助方法：

```
public static MvcHtmlString FormatString(this HtmlHelper helper, string stringToFormat, int format)
        {
            if (format == 3)
            {
                return MvcHtmlString.Create(String.Format("{0:C0}", stringToFormat));      
            }
            return MvcHtmlString.Create(String.Format("{0:0}", stringToFormat));
        } 
```

我也尝试过返回常规字符串而不是 MvcHtmlString 以及使用 ToString() 方法，但都没有帮助。

非常感谢任何帮助/建议。

谢谢，-蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T13:12:27.207

Your error here is you are trying to format a string, not a number. `String.Format()` can format only if you pass a number. So you just simply need to change parameter from string to double:

```
public static MvcHtmlString FormatString(this HtmlHelper helper, double numberToFormat, int format) 
```

And don't convert numbers in the view:

```
@Html.FormatString(i.ActivityValue, i.DataTypeId) 
```

If you have not only double values, but also other types (like float or decimal) you can use `object` instead of `double`:

```
public static MvcHtmlString FormatString(this HtmlHelper helper, object numberToFormat, int format) 
```

# java - 什么时候注册监听器？

> ID：13463925
> 
> 赞同：1
> 
> 时间：2012-11-19T23:01:28.407
> 
> 标签：java, user-interface, event-handling

在java中，我可以在构造对象后更改对侦听器的引用吗？例如，当实例化此类的对象时，我可以使用其设置器更改侦听器吗？如果我不能，我该怎么做，我的意思是在需要时更改侦听器？

```
public class ListenerTest extends JFrame {

    ActionListener listener;

    public ListenerTest() {

        JPanel jPanel = new JPanel();
        JButton jButton = new JButton("Activate!");
        jButton.addActionListener(listener);
        jPanel.add(jButton);
        add(jPanel);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setTitle("Demo Drawing");
        setLocationRelativeTo(null);
        pack();
        setVisible(true);
    }

    public ActionListener getListener() {
        return listener;
    }

    public void setListener(ActionListener listener) {
        this.listener = listener;

    }

    public static void main(String[] args) {
        ListenerTest frame = new ListenerTest();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:04:45.153

当然，您可以添加、删除 ActionListener，但不能像您尝试的那样。如果您更改侦听器变量引用的 ActionListener，这不会影响已添加到 JButton 中的 ActionListener。`addActionListener(...)`您必须通过其和方法专门添加或删除 JButton 的侦听器`removeActionListener(...)`才能产生此效果。我认为您需要了解的关键点是侦听器变量与它可能引用的 ActionListener 对象不同。这个变量所做的只是引用一个 ActionListener 对象（如果已经给它一个）。它对可能正在侦听或未侦听 JButton 的 ActionListener 绝对没有影响。

顺便说一句，您当前的代码似乎正试图添加`null`为 JButton 的 ActionListener，因为它是在将其添加到类的构造函数中的按钮时的侦听器变量 null ：

```
ActionListener listener; // variable is null here

public ListenerTest() {

    JPanel jPanel = new JPanel();
    JButton jButton = new JButton("Activate!");
    jButton.addActionListener(listener); // variable is still null here!
    // ....
}

public void setListener(ActionListener listener) {
    this.listener = listener;  // this has no effect on the JButton
} 
```

也许你想这样做：

```
public void setListener(ActionListener listener) {
    jButton.addActionListener(listener);
} 
```

或者如果您希望添加您的侦听器来代替所有现有的 ActionListener

```
public void setListener(ActionListener listener) {
    ActionListener[] listeners = jButton.getActionListeners();
    for(ActionListener l : listeners) {
       jButton.removeActionListener(l); // remove all current ActionListeners
    }
    // set new ActionListener
    jButton.addActionListener(listener);
} 
```

如果您更喜欢使用 AbstractActions，您也可以设置 JButton 的 Action，有些人认为这是一种更简洁的方法。

# r - 将data.frame写入R中具有特定格式的文本文件

> ID：13463926
> 
> 赞同：0
> 
> 时间：2012-11-19T23:01:27.760
> 
> 标签：r

我正在使用 R 访问一些旧的 FORTRAN 输入文件，并且在将数据框放入文本文件并保持其格式方面存在一些问题。

我的方法是：

1.  用于`read.table`导入数据。
2.  调整一列中的数字（乘以标量）。
3.  `write.table`使用函数保存所有内容。

我的代码：

```
con <- file(paste(pth,'/Input/met/G_test.MET', sep=""))
aaa <- read.table(con)
aaa[,2]=aaa[,2]*0.1
write.table(aaa)
close(con) 
```

我的方法失败了，因为它改变了输入文件的格式（它忽略了列之间的空格）。我的问题：有没有一种很好的方法来执行这三个步骤并保持相同的格式？我可以`readLines`用来保持格式，然后我必须在一个大循环中修改所有数字。

这是数据的外观（我知道列之间的空格数）：

```
 010192      0.00      0.04       8.3
 010292      0.33      0.02       7.5
 010392      0.61      0.23      11.7
 010492      0.00      0.04      10.0
 010592      0.00      0.07      10.6
 010692      0.00      0.02       8.9
 010792      0.00      0.19       9.4
 010892      0.00      0.30       9.4
 010992      0.00      0.08      11.4 
```

感谢您的任何建议。

### 更新

因为我必须维护格式并更新一列中的数字。我想出了一个“混合”的方法。这种方法有效，但我很欣赏有关标准方法的建议。

1.  使用 readLines 将数据加载为字符，以保持格式并保持起始零。
2.  使用 read.table 将数据加载为 data.frame 并修改它们
3.  循环替换数字。

    ```
    con_rain<- file(paste(pth,'/Out_Test/GA1LEVAP.MET', sep=""))
    a_rain=readLines(con_rain)
    b_rain=read.table(con_rain) 

    for (i in 1:731){
      a_rain[i]=paste(substr(a_rain[i],1,13),sprintf("%3.2f", b_rain[i,2]*p[19]),substr(a_rain[i],18,37),sep="")
    }

    writeLines(a_rain, paste(pth,'/Out_Test/GA1LEVAP.MET', sep="")) 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:15:32.067

只需提供一个`sep=`适合的论点。以下是 6 个空格后跟一个制表符的示例：

```
R> head(trees)
  Girth Height Volume
1   8.3     70   10.3
2   8.6     65   10.3
3   8.8     63   10.2
4  10.5     72   16.4
5  10.7     81   18.8
6  10.8     83   19.7
R> write.table(trees, sep="      \t", 
+              file="/tmp/trees6spaces.txt", row.names=FALSE, col.names=FALSE)
R> system("head /tmp/trees6spaces.txt")
8.3         70          10.3
8.6         65          10.3
8.8         63          10.2
10.5        72          16.4
10.7        81          18.8
10.8        83          19.7
11          66          15.6
11          75          18.2
11.1        80          22.6
11.2        75          19.9
R> 
```

# jquery - 仅在移动设备上的 jQuery 下拉效果

> ID：13463927
> 
> 赞同：0
> 
> 时间：2012-11-19T23:01:28.837
> 
> 标签：jquery, wordpress, mobile, navigation

目前，我已将移动导航设置为创建下拉功能。您可以在这里看到一个工作示例（只需将浏览器拉小即可查看移动导航）：http: [//goo.gl/TzPPd](http://goo.gl/TzPPd)

问题是 jQuery 下拉效果也被应用于非移动导航，这导致了一些问题。我希望 jQuery 效果仅适用于移动导航，这是我目前使用的代码：

```
$(function() {
  $('ul.menu > li > a').click(function(e) {
    $('ul.sub-menu').slideUp('normal');
      if($(this).next('ul.sub-menu').is(':hidden') === true) {    
        $(this).next('ul.sub-menu').slideDown('normal');
      }
   e.preventDefault();
  });
}); 
```

我试过这个，但没有运气：

```
$(function() {
  $('#main-nav_responsive > ul.menu > li > a').click(function(e) {
    $('#main-nav_responsive > ul.sub-menu').slideUp('normal');
      if($(this).next('#main-nav_responsive > ul.sub-menu').is(':hidden') === true) {    
        $(this).next('#main-nav_responsive > ul.sub-menu').slideDown('normal');
      }
    e.preventDefault();
  });
}); 
```

任何人都知道如何使 jQuery 效果仅适用于移动导航？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:22:35.683

啊，话说得太早了。解决了这个问题：

```
$(function() {
  $('#main-nav_responsive ul.menu > li > a').click(function(e) {
    $('#main-nav_responsive ul.sub-menu').slideUp('normal');
      if($(this).next('#main-nav_responsive ul.sub-menu').is(':hidden') === true) {    
        $(this).next('#main-nav_responsive ul.sub-menu').slideDown('normal');
      }
    e.preventDefault();
  });
}); 
```

# java - 为什么要在覆盖现有方法时调用超类方法？

> ID：13463930
> 
> 赞同：1
> 
> 时间：2012-11-19T23:01:45.560
> 
> 标签：java, android

一般来说，我是 JAVA 和 OOP 的新手。在这个非常简单的代码中，为什么我必须从超类调用 onCreate 方法？它不是从超类继承的吗？我知道构造函数方法不会继承给子类，如果要调用构造函数，则必须调用超类。super.onCreate 是构造函数调用吗？构造函数名称不是必须与类名相同吗？我知道这是一个愚蠢的问题，感谢您的回答。

```
import android.app.Activity;

public class MainActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-19T23:06:59.287

> 为什么我必须从超类调用 onCreate 方法？它不是从超类继承的吗？

实现是继承的，但您正在覆盖它。您需要表明您不只是想*替换*原始行为 - 您希望从超类执行该行为*，然后*执行额外代码。

这不是构造函数调用——除非你显式调用超类实现，否则它的代码根本不会被执行。与构造函数不同的是，超类实现调用不必是方法的第一条语句。您可以随心所欲地调用超类实现，甚至可以多次调用。

这是一个简短但完整的示例程序，演示了调用和不调用超级方法之间的区别：

```
class Super {
    void method1() {
        System.out.println("Super.method1");
    }

    void method2() {
        System.out.println("Super.method2");
    }
}

class Sub extends Super {
    @Override void method1() {
        // No explicit super call
        System.out.println("Sub.method1");
    }

    @Override void method2() {
        super.method2();
        System.out.println("Sub.method2");
    }
}

public class Test {
    public static void main (String[] args) {
        Super x = new Sub();
        x.method1(); // Prints just Sub.method1
        x.method2(); // Prints Super.method2 and Sub.method2
    }    
} 
```

`Sub.method1`（顺便调用也是完全可行`super.method2()`的。你可以从子类调用*任何*方法的超类实现。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-19T23:06:49.607

因为这就是android团队设计Activity的方式。Activity 的`onCreate()`方法会为创建的每个 Activity 执行必须执行的操作，不调用`super.onCreate()`会绕过这些强制执行的操作。

`onCreate()`不是构造函数。这是一种方法。如果您覆盖该方法并且不调用`super.onCreate()`，则重新定义该`onCreate()`方法的作用。调用`super.onCreate()`使您的`onCreate()`方法与基本方法执行相同的操作`onCreate()`，以及特定于您自己的活动的其他操作。

有关此方法的文档，请参阅[http://developer.android.com/reference/android/app/Activity.html#onCreate%28android.os.Bundle%29 。](http://developer.android.com/reference/android/app/Activity.html#onCreate%28android.os.Bundle%29)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-19T23:09:56.757

是的，它是相同的方法名称，因此您将覆盖 Activity 中的 onCreate 方法。如果您不在 MainActivity 中重新调用该方法，它只会执行 setContentView(R.layout.main);

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T23:07:15.580

实际上，这与构造函数无关（此外，在默认构造函数的情况下，您关于未调用构造函数的陈述是不正确的）。

这样做的“OOP”-ish 原因是类中的`onCreate`方法`Activity`可能包含*应由*子类的实现调用的某些代码。不过，您不必调用它（*就*Java 语言而言）。

要知道是否应该调用方法的超类实现，您应该查阅超类实现的文档。这里没有对错；绝对是个案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-19T23:09:07.527

超类中的方法是继承的，因为它对子类可用，但不会自动调用。在子类中，您调用超类的方法，以便它可以执行任何操作，然后您的方法执行任何其他工作（就像在您的示例中一样。

这是一个参考，它将为您提供更多信息：

[http://docs.oracle.com/javase/tutorial/java/concepts/](http://docs.oracle.com/javase/tutorial/java/concepts/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-19T23:09:27.320

您覆盖超类方法 - 就像您正在替换它一样。您可以选择调用超类方法，但您不必这样做。这完全取决于您要完成的工作。在某些情况下，您想调用超类方法，因为您需要子类的逻辑，也许您正在添加它。在其他情况下，您可能希望完全替换该行为。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-19T23:09:50.113

原来的`onCreate()`方法是继承的，但是那个确切的方法不是这段代码所做的。此代码需要原始方法，并且还需要调用`setContentView(R.layout.main);`. 它不是从这里复制超类的所有代码，而是简单地调用`super.onCreate()`然后添加新的东西。

# php - PHP中数值数据的查表

> ID：13463932
> 
> 赞同：3
> 
> 时间：2012-11-19T23:01:51.433
> 
> 标签：php, csv, lookup-tables

我有一个相当大的表（~5 MB csv 文件）存储在我们的服务器上，它由纯数字数据组成，根据两个参数给出一些结果，例如

```
A     B     Output
-----------------------
1     1     20
1     2     21
1     3     22
2     1     23
2     2     24
2     3     25
...   ...   ... 
```

我想做的是，根据用户的输入，找到最接近的参数，然后使用适当的输出。例如，使用上表，如果用户选择 A=1.1 和 B=2.9，则输出将为 22。

在 php 中进行此表查找的最佳方法是什么？我需要将整个表加载到 PHP 中吗？我应该将其设为二进制文件而不是 csv 文件，以便文件大小更小且加载速度更快？或者我应该创建一个 mySQL 数据库并以这种方式执行查找？

TL;DR：我正在寻找对严格数字数据执行最近邻表查找的最有效方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:11:53.300

如果 mysql 可用，我的建议是使用表格并进行查找。我想在查找之前将用户输入四舍五入到最接近的整数应该会给你最接近的整数。

# jquery-ui - jQuery UI 滑块绝对位置

> ID：13463934
> 
> 赞同：0
> 
> 时间：2012-11-19T23:01:54.200
> 
> 标签：jquery-ui

我对 jQuery UI 的滑块位置有疑问。

我正在尝试为滑块设置绝对位置。所以我所拥有的是：

```
<div id='scrollbar_x_wrapper' >
    <div id='scrollbar_x'></div>
</div> 
```

和

```
$('#scrollbar_x_wrapper').css({
    "position": 'absolute',
    "left": 100 + "px",
    "top": 100 + "px",
    'width': (chart_width * 0.85 - 15) + 'px'
})

scroll_x = $('#scrollbar_x').slider({
    value: 0
    min: 0,
    max: 5
    step: 1,

    slide: function(event, ui) {
        redraw();
    }
}); 
```

但是，似乎如果我单击滑块的轨道，滑块没有响应，但只有当我单击拇指时它才会响应。

当我删除 left 和 top 样式属性时，它工作得很好。在我的情况下，我需要使用 left 和 top 属性来正确定位滑块，所以我必须使用 left 和 top 属性。

谁能帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:08:54.627

您在寻找动画财产吗？

```
$(".SliderDiv").slider(
    { min: 0, 
      max: 16, 
      step: .25, 
      slide: SliderSlide, 
      animate: true 
    }); 
```

# c# - 访问列表 价值观

> ID：13463936
> 
> 赞同：0
> 
> 时间：2012-11-19T23:02:06.060
> 
> 标签：c#, list

我是编码初学者并尝试解决简单问题：

我有一个包含三列的列表，并试图访问存储在列表中的值。它没有给我答案......任何想法？谢谢

```
private void btnImage1Load_Click(object sender, EventArgs e)
    {
        openFileDialog1.ShowDialog();
        pictureBox1.ImageLocation = openFileDialog1.FileName;                    
    }

    public class ListThreeColumns
    {
        public int XCoord { get; set; }
        public int YCoord { get; set; }
        public Color Color { get; set; }
    }

    private List<ListThreeColumns> GetPixels()
    {
        Bitmap picture = new Bitmap(pictureBox1.Image);

        List<ListThreeColumns> colorList = new List<ListThreeColumns>
        {

        };

        for (int y = 0; y < picture.Height; y++)
        {
            for (int x = 0; x < picture.Width; x++)
            {
                colorList.Add(new ListThreeColumns { XCoord = x, YCoord = y, Color = picture.GetPixel(x, y) });
            }
        }
        return colorList;
    }

    private void btnScanPixels_Click(object sender, EventArgs e)
    {
        List<ListThreeColumns> seznamBarev = GetPixels();
       MessageBox.Show(seznamBarev[6].ToString());

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T23:05:11.003

在这一行：

```
MessageBox.Show(seznamBarev[6].ToString()); 
```

...您正在访问列表的第 6 个元素，然后只是调用`ToString`它。由于您没有覆盖`ListThreeElements`（顺便说一下，最好命名为`Pixel`），这意味着结果不会特别有用。

你可以写：

```
ListThreeColumns pixel = seznamBarev[6];
MessageBox.Show(string.Format("{0}, {1} - {2}", pixel.X, pixel.Y, pixel.Color); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T00:16:15.743

你想让我做什么？如果你想在字符串中显示每个项目，你可以使用 Jon 方式。但最好将操作转移到您的班级。如果您在 ListThreeColumns 类中覆盖 'ToString()' 方法，则您的代码可以正常工作，无需更改。

```
 public class ListThreeColumns
{
    public int XCoord { get; set; }
    public int YCoord { get; set; }
    public Color Color { get; set; }

    public override ToString()
    {
         return string.Format("X={0}, Y={1}, Color=({2};{3};{4})", 
             this.XCoord , this.YCoord , Color.R,Color.G,Color.B );
    }
} 
```

# asp.net-mvc - .Net MVC 控制器根据情况强制刷新缓存

> ID：13463939
> 
> 赞同：0
> 
> 时间：2012-11-19T23:02:23.960
> 
> 标签：asp.net-mvc, caching, controller, asp.net-optimization

我有一个控制器操作，它返回一组测试中一系列测量的平均值。控制器基本上从指定组内的所有测试中获取数据点，然后返回所有数据点的平均值。测试会定期添加到测试组。

我想优化我的控制器，以便它缓存结果（因为如果数据没有更改，那么在每个请求上查询数据库的意义何在？）并且只有在收到请求并且新测试已经完成时才重建缓存添加到测试组。我的表结构（简化）如下。

实现这一目标的最佳方法是什么？

```
TEST_GROUP
------------
group_name
group_id

TEST
-------------
test_id
group_id
test_date

DATA
--------------
test_id
measurement_number
measurement 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:10:08.473

如果没有数据库访问，您将无法确定是否有新记录。如果您想在控制器上提供基于时间的缓存，请查看 OutputCaching。我不相信您在操作中使用了任何参数，但如果您使用了，您可以增加缓存的时间量并根据参数而变化，以确保在传入新参数时单独获取结果。

在此处查看输出缓存记录：

[http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/improving-performance-with-output-caching-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/improving-performance-with-output-caching-cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:23:10.723

如果特定时间段的缓存满足您的需求，您可以通过执行以下操作在视图级别完成此操作：

```
[OutputCache(Duration = 300)] //Cache for 5 minutes.
public ActionResult Average() {
    //Do your stuff!
} 
```

另一种选择是只缓存您需要的数据：

```
HttpRuntime.Cache.Insert(key, value, null, DateTime.MaxValue, System.Web.Caching.Cache.NoSlidingExpiration); 
```

请注意，在最后一个示例中，最大缓存可能会过期，除非您有一个**非常**活跃的应用程序，或者如果您[将应用程序池](http://technet.microsoft.com/en-us/library/cc771956%28v=ws.10%29.aspx)进程配置为没有空闲关闭。

# c# - 组合框抛出 NullReferenceException

> ID：13463940
> 
> 赞同：-1
> 
> 时间：2012-11-19T23:02:35.190
> 
> 标签：c#, combobox

我有一个从列表中填充的 ComboBox。将列表添加到 ComboBox 的项目后，我尝试将所选项目设置为列表中的项目之一。这一项绝对不为空。

此时，会抛出 NullReferenceException。但是，所选项目已更改为我想要的项目。如果我只重新运行分配给 SelectedItem 的代码行，它不会引发另一个错误。

SelectedItem 的初始值为空。

```
MyComboBox.Items.AddRange(mylist.Select(t => (object)t).ToArray());
try
{
    MyComboBox.SelectedItem = mylist[0]; //Checked - not null.
}
catch (Exception e) { } 
```

NullReferenceException 来自什么？

**已解决：**在 SelectedIndexChanged 事件中引发了异常。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-19T23:07:37.027

看看如果你设置它是否有效`MyComboBox.SelectedItem = mylist[x]`。很有可能您实际上并未将其设置为列表中的项目。

# javascript - 如何在javascript中检测递归异步调用的完成

> ID：13463943
> 
> 赞同：6
> 
> 时间：2012-11-19T23:02:35.627
> 
> 标签：javascript, asynchronous, recursion

我正在使用以下代码从 Web SQL 数据库中获取分层数据：

```
...
function getResult(query, data, callback){
    db.transaction(function(tx) {
        tx.executeSql(query, data, function(tx, result) {
        callback(result);
        });
    });
}

function findChildren(id){
    getResult("SELECT * FROM my_table WHERE parent_id=?", [id], function(result){
        for (var i = 0, item = null; i < result.rows.length; i++) {
            item = result.rows.item(i);
            data.push(item);
            findChildren(item.id);
        }
    });
}
var data = Array();
getResult("SELECT * FROM my_table WHERE name like ?", ["A"], function(result){
    for (var i = 0, item = null; i < result.rows.length; i++) {
        item = result.rows.item(i);
        data.push(item);
        findChildren(item.id);
    }
});
... 
```

如何检测执行是否已完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:59:37.237

为未结交易使用回调`findChildren`和计数器：

```
function findChildren(id, callback){
    getResult("SELECT * FROM my_table WHERE parent_id=?", [id], function(result){
        var results = [],
            results.finished = 0;
            len = result.rows.length;
        for (var i = 0; i < len; i++) (function(i) {
            var item = result.rows.item(i);
            ...
            ...
            findChildren(item.id, function(result) {
                results[i] = result;
                if (++results.finished == len)
                    callback(results);
            });
        })(i);
    });
}

getResult("SELECT * FROM my_table WHERE name like ?", ["A"], function(result){
    var results = [],
        results.finished = 0, 
        len = result.rows.length;
    for (var i = 0; i < len; i++) (function(i) {
        var item = result.rows.item(i);
        ...
        ...
        findChildren(item.id, function(result) {
            results[i] = result;
            if (++results.finished == len) {
                // now results contains a nice tree of arrays with children ids
                // do something with it
            }
        });
    })(i);
}); 
```

Promise 将抽象计数器并简化回调处理。此外，由于您的两个查询非常相似，您可能也希望将它们抽象为一个通用函数。

# facebook - Facebook 是否返回专辑日期

> ID：13463953
> 
> 赞同：0
> 
> 时间：2012-11-19T23:03:17.943
> 
> 标签：facebook, gallery, image-gallery, photo-gallery

当您从 Facebook 获取相册时，它是否还会返回您在“编辑日期”字段中选择的日期？我不是指创建或更新的日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:22:26.197

不，API 仅返回专辑的创建时间和更新时间，不会通过 API 返回用户时间轴上专辑出现的时间点（例如，如果他们回溯了专辑）

# javascript - _.isUndefined 实现

> ID：13463955
> 
> 赞同：10
> 
> 时间：2012-11-19T23:03:24.930
> 
> 标签：javascript, underscore.js

为什么 underscore.js 的 isUndefined 是这样定义的？

`_.isUndefined = function(obj) { return obj === void 0; };`

为什么这行不通？

`typeof obj === 'undefined'`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T07:21:43.030

好的，一开始`typeof obj === 'undefined'`比较慢，因为您可以轻松验证。

那么问题是为什么要进行比较

```
obj === void 0 
```

对比

```
obj === undefined 
```

让我们来看看：

`void 0;``void`返回将始终返回的一元运算符的结果`undefined`（即`void 1`没有区别）

`undefined`指向全局变量`undefined`。

正常情况下两者是一样的。我认为虽然`void 0`是首选，因为可以`undefined`使用局部变量进行遮蔽`undefined`:) 这很愚蠢，但它确实发生了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:18:46.150

它的编写方式可能更有效。您为什么不分析这两个定义并查看？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-19T23:40:29.743

如果你写了`viod`，你会得到一个语法错误。您将“未定义”拼写为`'undeifned'`，但您没有收到任何错误。所以，一个可能的原因是更容易调试！:)

# android - 从网站崩溃加载图像

> ID：13463960
> 
> 赞同：0
> 
> 时间：2012-11-19T23:04:03.900
> 
> 标签：android

> **可能重复：**
> [使用 Android 下载文件，并在 ProgressDialog 中显示进度](https://stackoverflow.com/questions/3028306/download-a-file-with-android-and-showing-the-progress-in-a-progressdialog)

我正在尝试从网站加载图像，我看到了这个问题：[Android load from URL to Bitmap](https://stackoverflow.com/questions/8992964/android-load-from-url-to-bitmap)但我的应用程序在这一行崩溃：conn.connect();

```
public class HTTPTest extends Activity {

ImageView imView;
String imageUrl = "http://api.androidhive.info/images/sample.jpg";

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.main);

    Button bt3 = (Button) findViewById(R.id.get_imagebt);
    bt3.setOnClickListener(getImgListener);
    imView = (ImageView) findViewById(R.id.imview);
}

View.OnClickListener getImgListener = new View.OnClickListener() {

    @Override
    public void onClick(View view) {
        // TODO Auto-generated method stub
        downloadFile(imageUrl);
    }
};

Bitmap bmImg;

void downloadFile(String fileUrl) {
    URL myFileUrl = null;
    try {
        myFileUrl = new URL(fileUrl);
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    try {
        HttpURLConnection conn = (HttpURLConnection) myFileUrl
                .openConnection();
        conn.setDoInput(true);
        conn.connect();
        InputStream is = conn.getInputStream();

        bmImg = BitmapFactory.decodeStream(is);
        imView.setImageBitmap(bmImg);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

主.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<TextView  
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:text="Hello World, HTTPImage load test"
/>
    <Button 
android:id="@+id/get_imagebt"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="Get an image"
android:layout_gravity="center"
/>  
<ImageView 
android:id="@+id/imview"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_gravity="center"
/> 
```

我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.androidtest"
android:versionCode="1"
android:versionName="1.0" >
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.androidtest.HTTPTest"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

<uses-permission android:name="android.permission.INTERNET"></uses-permission>
<!-- Permission to write to external storage -->
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
</manifest> 
```

提前感谢您的帮助！

日耳曼。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:20:26.723

您应该在另一个线程上运行所有网络请求（即不在 UI 线程上）。事实上，Android 让你这样做。否则，您的 UI 将在您等待响应时锁定。将您的 downloadFile() 方法更改为如下所示。AsyncTask 将在另一个线程上运行您的代码。对于需要一段时间才能执行的任务，这是一个很好的做法。

```
void downloadFile(String fileUrl) {

    AsyncTask<String, Object, String> task = new AsyncTask<String, Object, String>() {

        @Override
        protected String doInBackground(String... params) {
            URL myFileUrl = null;
            try {
                myFileUrl = new URL(params[0]);
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            try {
                HttpURLConnection conn = (HttpURLConnection) myFileUrl
                        .openConnection();
                conn.setDoInput(true);
                conn.connect();
                InputStream is = conn.getInputStream();

                bmImg = BitmapFactory.decodeStream(is);
                imView.setImageBitmap(bmImg);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            return null;
        }
    };
    task.execute(fileUrl);

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T23:14:35.870

> 但我的应用程序在这一行崩溃：`conn.connect();`

从 Android 3+ 开始，您无法对主线程执行可能较慢的网络操作。

在 AsyncTask 中下载图像，以免降低用户体验。只需将您`downloadFile()`的方法移动到`doInBackground()`AsyncTask 的方法中。

如果您需要详细的细节，这里有一个[非常广泛的答案。](https://stackoverflow.com/q/3028306/1267661)

* * *

 **使用 Jimbo**时**`doInBackground()`，您可能会因为尝试从不同的线程访问 UI 而遇到错误，而这是您无法做到的。您可以在 AsyncTask 中覆盖`onPostExecute()`以使用您的视图，因为它可以访问 UI 线程：**

 **```
@Override
protected void onPostExecute(String unused) {
    imView.setImageBitmap(bmImg);
} 
```**

# sql - 使用 DateDim 连接值，其中空日期值将采用表中的最后一个非空值

> ID：13463964
> 
> 赞同：2
> 
> 时间：2012-11-19T23:04:32.220
> 
> 标签：sql, sql-server-2008, tsql

我需要加入，但我不确定是哪种类型。我有一张这样的桌子：

```
Date        Amount | FOO
------------------
2012-01-12       x
2012-03-14       y
2012-05-06       z
2012-05-14      aa
2012-09-02      bb 
```

我加入了 DateDim （谷歌在这里：[DATE DIM](http://www.google.com/search?q=datedim+sql)，这是一个日期表（历史和未来）。

我需要一个显示如下数据的查询：

```
datedim.Date    foo.Amount | FOO x DATEDIM
------------------------------------------
2012-01-12               x
2012-01-13               x
2012-01-14               x
... etc...
2012-03-14               y
2012-03-15               y
2012-03-16               y
2012-03-17               y
... etc...
2012-05-06               z
... etc... 
```

基本上，我需要这些值持续存在（如果它是左连接，它将是 NULL），直到下一个非空值。这也会持续存在......等等......

* * *

我目前所拥有的...

```
SELECT datedim.Date
    ,CASE
        WHEN Amount IS NULL
        THEN (SELECT TOP 1 Amount
        FROM FOO WHERE foo.Date <= datedim.Date
        ORDER BY Date DESC)
        ELSE Amount END AS Amount
FROM DATEDIM datedim
LEFT JOIN FOO foo
ON foo.Date = datedim.Date 
```

我需要从中创建一个视图。我收到一条错误消息，说 ORDER BY 对视图无效，除非由 TOP 指定？？？我在子查询中有一个 TOP ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:19:12.147

我确信使用 CTE 或窗口函数有更有效的方法，但是这些方面的东西应该可以工作：

```
Select
  d.Date,
  d.FooDate,
  f.Amount
From
  Foo f
    Inner Join (
    Select
      d.[Date],
      Max(f.[Date]) as FooDate
    From
      Foo f
       Inner Join
      DateDim d
        On f.[Date] < d.[Date]
    Group By
      d.[Date]
  ) d 
  On d.[FooDate] = f.[Date] 
```

[http://sqlfiddle.com/#!3/3c7d5/10](http://sqlfiddle.com/#!3/3c7d5/10)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T01:03:53.650

在 SQLServer2005+ 中使用递归 CTE

```
;WITH cte (id, [Date], Amount) AS
 (
  SELECT ROW_NUMBER() OVER (ORDER BY [Date] ASC) AS id,
         [Date], Amount
  FROM dbo.your_table t1
  ), cte2 (id, [Date], [LevelDate], Amount) AS
 (         
  SELECT c1.id, c1.[Date], DATEDIFF(day, c1.[Date], c2.[Date]) AS [LevelDate], c1.Amount
  FROM cte c1 LEFT JOIN cte c2 ON c1.id = c2.id - 1
  ), cte3 (id, [Date], Amount, [Level]) AS
 (
  SELECT  id, [Date], Amount, 1 AS [Level]
  FROM cte2 c
  UNION ALL
  SELECT c.id, DATEADD(day, 1, ct.[Date]) AS [Date], c.Amount, ct.[Level] + 1
  FROM cte2 c JOIN cte3 ct ON c.id = ct.id
  WHERE c.[LevelDate] > ct.[Level]
  )
  SELECT [Date], Amount
  FROM cte3
  ORDER BY Date
  OPTION (maxrecursion 0) 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/425a7/1/0)上的演示[](http://sqlfiddle.com/#!3/425a7/1/0)

# python - pyephem 恒星时间给出了意想不到的结果

> ID：13463965
> 
> 赞同：1
> 
> 时间：2012-11-19T23:04:35.120
> 
> 标签：python, astronomy, pyephem

我是`ephem`第一次使用，无法理解 oberver.sidereal_time() 的输出

我写了几个脚本来从小时角度确定太阳时。第一个使用 ephe 计算赤经，并使用 Meeus 的天文算法中的公式来获得格林威治平均恒星时，可以将其转换为带有经度的局部平均恒星时。

```
import sys
from datetime import datetime, time, timedelta
import ephem

def hour_angle(dt, longit, latit, elev):
    obs = ephem.Observer()
    obs.date = dt.strftime('%Y/%m/%d %H:%M:%S')
    obs.lon = longit
    obs.lat = latit
    obs.elevation = elev
    sun = ephem.Sun()
    sun.compute(obs)
    # get right ascention
    ra = ephem.degrees(sun.g_ra)

    # get sidereal time at greenwich (AA ch12)
    jd = ephem.julian_date(dt)
    t = (jd - 2451545.0) / 36525
    theta = 280.46061837 + 360.98564736629 * (jd - 2451545) \
            + .000387933 * t**2 - t**3 / 38710000

    # hour angle (AA ch13)
    ha = (theta + longit - ra * 180 / ephem.pi) % 360
    return ha

def main():
    if len(sys.argv) != 6:
        print 'Usage: hour_angle.py [YYYY/MM/DD] [HH:MM:SS] [longitude] [latitude] [elev]'
        sys.exit()
    else:
        dt = datetime.strptime(sys.argv[1] + ' ' + sys.argv[2], '%Y/%m/%d %H:%M:%S')
        longit = float(sys.argv[3])
        latit = float(sys.argv[4])
        elev = float(sys.argv[5])

    # get hour angle
    ha = hour_angle(dt, longit, latit, elev)

    # convert hour angle to timedelta from noon
    days = ha / 360
    if days > 0.5:
        days -= 0.5
    td = timedelta(days=days)

    # make solar time
    solar_time = datetime.combine(dt.date(), time(12)) + td
    print solar_time

if __name__ == '__main__':
    main() 
```

当我插入一些数据时，这给出了我期望的输出：

```
> python hour_angle_ephem.py 2012/11/16 20:34:56 -122.2697 37.8044 3.0
2012-11-16 12:40:54.697115 
```

我编写的第二个脚本以相同的方式计算赤经，但使用 ephem 的 sidereal_time() 来获取本地视恒星时间。

```
import sys
from datetime import datetime, time, timedelta
import math
import ephem

def solartime(observer, sun=ephem.Sun()):
    sun.compute(observer)
    # sidereal time == ra (right ascension) is the highest point (noon)
    t = observer.sidereal_time() - sun.ra
    return ephem.hours(t + ephem.hours('12:00')).norm  # .norm for 0..24

def main():
    if len(sys.argv) != 6:
        print 'Usage: hour_angle.py [YYYY/MM/DD] [HH:MM:SS] [longitude] [latitude] [elev]'
        sys.exit()
    else:
        dt = datetime.strptime(sys.argv[1] + ' ' + sys.argv[2], '%Y/%m/%d %H:%M:%S')
        longit = float(sys.argv[3])
        latit = float(sys.argv[4])
        elev = float(sys.argv[5])

    obs = ephem.Observer()
    obs.date = dt.strftime('%Y/%m/%d %H:%M:%S')
    obs.lon = longit
    obs.lat = latit
    obs.elevation = elev
    solar_time = solartime(obs)
    print solar_time

if __name__ == '__main__':
    main() 
```

这并没有得到我期望的输出。

```
python hour_angle_ephem2.py 2012/11/16 20:34:56 -122.2697 37.8044 3.0
9:47:50.83 
```

AFAIK，这两个脚本之间的唯一区别是第一个基于当地平均恒星时的小时角，而第二个基于当地视恒星时的小时角，考虑到地球的章动，我认为这应该是非常小的因素。相反，我看到了大约三个小时的差异。谁能向我解释发生了什么事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T05:27:45.413

当您为 PyEphem 提供一个原始浮点数时，它需要一个角度，然后它相信您首先将角度转换为弧度 - 因为它总是将浮点角度视为弧度，以保持一致。但是在您的第二个脚本中，您将获得以度数表示的经度和纬度，并将它们提供给 PyEphem，就好像它们以弧度为单位一样。如果您添加一`print`两个语句以查看您的外观`.lon`和`.lat`属性，您可以看到结果`Observer`：

```
print observer.lon  #--> -7005:32:16.0
print observer.lat  #-->  2166:01:57.2 
```

我认为您想要做的只是将原始经度和纬度字符串提供给 PyEphem，以便通过删除第二个脚本`float()`周围`argv[3]`和中的调用，它将它们解释为人类可读的度数而不是机器可读的弧度。`argv[4]`然后，您应该会发现它返回的值更接近您的预期：

```
$ python tmp11.py 2012/11/16 20:34:56 -122.2697 37.8044 3.0
12:40:55.59 
```

# mongodb - 未找到 Mongoid 会话

> ID：13463969
> 
> 赞同：4
> 
> 时间：2012-11-19T23:04:54.193
> 
> 标签：mongodb, sinatra, mongoid

试用 Sinatra | Mongoid 3\. 每当我尝试保存到数据库时，都会遇到以下错误。

```
Mongoid::Errors::NoSessionsConfig: 
Problem:
 No sessions configuration provided.
Summary:
Mongoid's configuration requires that you provide details about each session that can be connected to, and requires in the sessions config at least 1 default session to exist.
Resolution:
    Double check your mongoid.yml to make sure that you have a top-level sessions key with at least 1 default session configuration for it. You can regenerate a new mongoid.yml for assistance via `rails g mongoid:config`.

Example:
 development:
    sessions:
     default:
        database: mongoid_dev
     hosts:
      - localhost:27017

from /Users/rhodee/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/mongoid-3.0.13/lib/mongoid/sessions/factory.rb:61:in `create_session' 
```

我已经确认了以下内容：

*   加载 Mongoid.yml 文件
*   哈希包含正确的环境和数据库名称

使用 pry`Mongoid.load!`方法的返回值返回：

```
=> {"sessions"=>
 {"default"=>
 {"database"=>"bluster",
 "hosts"=>["localhost:27017"],
 "options"=>{"consistency"=>"strong "}}}} 
```

如果有任何帮助检查，我也添加了 app.rb 文件和 mongoid.yml 文件。

**应用程序.rb**

```
require 'sinatra'
require 'mongoid'
require 'pry'
require 'routes'
require 'location'

configure :development do
 enable :logging, :dump_errors, :run, :sessions
 Mongoid.load!(File.join(File.dirname(__FILE__), "config", "mongoid.yml"))
end 
```

**Mongoid.yml**

```
 development:
   sessions:
     default:
      database: bluster
      hosts:
        - localhost:27017
      options:
       consistency: strong 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:03:35.203

```
require 'sinatra'
require 'mongoid'
require 'pry'
require 'routes'

configure :development do
  enable :logging, :dump_errors, :run, :sessions
  Mongoid.load!(File.join(File.dirname(__FILE__), "config", "mongoid.yml"))
end

get '/db' do
  "db: " <<  Mongoid.default_session[:moped].database.inspect
end 
```

我整理了一个例子，它对我来说效果很好。可能您的问题是其他问题，例如配置文件没有读取权限或其他问题。无论如何，我的配置文件与您的相同，这是我的 sinatra 文件，它工作正常。

# .net - VB.NET - 我如何像 RegEx 一样使用这个 var？

> ID：13463972
> 
> 赞同：0
> 
> 时间：2012-11-19T23:05:03.073
> 
> 标签：.net, regex, vb.net

我需要使用一个名为“caracter”的变量作为“Char”类型，如正则表达式，在这个例子中：

```
 If CheckboxN.Name.Contains(caracter) Then... 
```

如果有人不理解我的意图，这是对上面示例在 Ruby 中的解释：

```
If CheckboxN.Name[(/^#{Regexp.escape(caracter)}$/)] Then... 
```

谢谢你的阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T23:07:16.547

看看[`Regex.Match()`方法](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.match.aspx)。

* * *

```
 Dim reg As New Regex(character)
 If reg.IsMatch(CheckboxN.Name) Then
     'Do Stuff...
 End If 
```

# android - Android UI 列表视图

> ID：13463977
> 
> 赞同：1
> 
> 时间：2012-11-19T23:05:13.870
> 
> 标签：android, button, user-interface, expandablelistview

我有一个包含许多类别的测验应用程序：

第一类

*   清单项目 1
*   清单项目 2

第 3 类

第 4 类

第 5 类

*   清单项目 1
*   清单项目 2
*   清单项目 3

因此，类别要么是指作为类别标题的一般不可选择类别，要么是实际类别。例如，假设类别 1 是水果，可能会有关于苹果和香蕉的问题。苹果和香蕉将是可选的，并且还会显示类别中有多少问题。但是第 3 类是蔬菜，它本身是可选择的，例如 100 个问题。

现在是否有可能将其变成每个类别的可扩展列表视图。但是，没有其他问题的类别是不可扩展的。是否有可能将按钮放在可扩展列表视图中，还是必须分开？复选框呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:10:27.083

您可以使用以下库轻松创建分段列表。您可以在六行中创建它

所以你可以在列表视图中为每个类别设置标题

[分段列表库](https://github.com/ragunathjawahar/simple-section-adapter)

## 分段列表示例

如何实现这一点，

```
 // 1\. Your data source
    String[] books = new String[] {
        "A Item", "F Item", "D Item", 
        "H Item", "T Item", 
        "A Item 1", "T Item 2"
    };

    // 2\. Sort it
    Arrays.sort(books, 0, books.length, Collator.getInstance());

    // 3\. Create your adapter
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, 
            android.R.layout.simple_list_item_1, books);

    // 4\. Create a Sectionizer
    Sectionizer<String> alphabetSectionizer = new Sectionizer<String>() {

        @Override
        public String getSectionTitleForItem(String categoryName) {
            return bookName;
        }
    };

    // 5\. Wrap your adapter within the SimpleSectionAdapter
    SimpleSectionAdapter<String> sectionAdapter = new SimpleSectionAdapter<String>(this, 
            adapter, R.layout.section_header, R.id.title, alphabetSectionizer);

    // 6\. Set the adapter to your ListView
    setListAdapter(sectionAdapter); 
```

# sql - 根据另一个表中的复合键删除

> ID：13463982
> 
> 赞同：15
> 
> 时间：2012-11-19T23:05:22.273
> 
> 标签：sql, sql-server, tsql

我真的不愿意发布这个，因为我觉得这是一个常见问题，但我似乎找不到适用于这种情况的答案......（也许我只是一个非常糟糕的谷歌用户）。

我有两个相同的表（按列，而不是数据），table1 和 table2。我希望删除 table1 中复合键 (col1, col2) 存在于两个表中的记录。这是我所拥有的，这对我来说似乎是正确的，但会引发错误。

```
DELETE FROM Table1
WHERE (**Col1**, Col2) IN
(SELECT Col1, Col2
FROM Table1 a
JOIN Table2 b
    ON a.Col1 = b.Col1
    AND a.Col2 = b.Col2) 
```

错误：

> 消息 4145，级别 15，状态 1，第 212 行 在预期条件的上下文中指定的非布尔类型表达式，靠近“，”。

我在`*`具有“红色错误曲线”的代码部分周围放置了两个。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-19T23:09:26.377

这可以使用`JOIN`您的[`DELETE`](http://msdn.microsoft.com/en-us/library/ms189835.aspx):

```
DELETE a
FROM 
    Table1 a 
    JOIN Table2 b
        ON a.Col1 = b.Col1
        AND a.Col2 = b.Col2 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-19T23:14:55.527

它是哪个 DBMS？如果它是在口头上，那么成对比较应该可以工作。

```
DELETE FROM Table1
WHERE (Col1, Col2) IN
(SELECT Col1, Col2
 FROM Table2) 
```

如果它是 SQL 服务器，那么迈克尔的解决方案应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-01-18T19:09:32.043

这两个答案都没有涵盖一般情况，所以我会提出我的：

您必须将您的字段合并为一个字段：

前任。：

```
DELETE FROM Table1 
WHERE concat(Col1,'******',Col2) 
 IN (SELECT concat(a.Col1,'******',b.Col2) 
FROM Table1 a 
JOIN Table2 b
ON a.Col1 = b.Col1
AND a.Col2 = b.Col2)) 
```

# facebook - Facebook登录和授权显示朋友，可以删除吗？

> ID：13463985
> 
> 赞同：-1
> 
> 时间：2012-11-19T23:05:40.963
> 
> 标签：facebook, login, authorization

在 facebook 登录对话框中，当用户必须授权应用程序时，它会显示“1 个朋友和 6 个其他人正在使用这个应用程序”之类的内容。

我不想在该屏幕上显示该信息，这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:20:51.683

鉴于在[FB.login()](http://developers.facebook.com/docs/reference/javascript/FB.login/)调用、[FB.init()](http://developers.facebook.com/docs/reference/javascript/FB.init/)调用和[Login URL](http://developers.facebook.com/docs/howtos/login/client-side-without-js-sdk/)中都没有记录参数，我认为这是不可能的。

# php - 管理部分中的 PHP 图片上传仅允许客户端上传 19 张图片

> ID：13463989
> 
> 赞同：1
> 
> 时间：2012-11-19T23:05:52.493
> 
> 标签：php, file-upload, for-loop, image-upload, file-io

我一直在为客户的管理面板工作（一家摄影公司将图像上传到客户的画廊），当我担任网络开发人员时，即使有**100 个文件上传框，它也只允许他上传****30 个图像**。只需将**for 循环更改为运行 100 次**即可解决此问题。这解决了这个问题。

 ****但是最近，连代码都没有，我的客户只能上传**19张图片**..我没有改变这个表格，他之前上传了40多张图片，所以我不太明白会发生什么..我已经一遍又一遍地检查代码，似乎无法确定问题所在。这可能是服务器端，因为我最近从他的**旧开发者的主机**移到了**我的 hostgator 帐户**。也许在htaccess的东西？我添加这个是因为**图像标签的更新**，而不是**图像本身**（*我也找不到它上传，在它发布后，但我的浏览器显示它正在上传*）

这是编辑库代码本身，如果它对问题有任何帮助：

```
<?php
require_once("../conn.php");
require_once("access.php");
require_once("GalleryNavigation.php");
require_once("dThumbMaker.inc.php");

/////////////common varilable
$__table = "devbg_gallery";
$__page = $_SERVER['PHP_SELF'];
$__page2 = "AddGallery.php";
$__id = "ItemID";
$__pagetitle = "GALLERY";
$__uploadfolder = "../myimages/";
$__thumbuploadfolder = "../myimages/thumbs/";
$__imageprefix = "Gallery";
$Thumb_Imgwidth = 200;
$Thumb_Imgheight = 77;
/////////////
if(isset($_POST[ds]))
{
    if(count($_POST['DelItem']) > '0')
    {
        while(list(, $value) = each($_POST['DelItem']))
        {
            $DelInfo = $value;
            $r2 = mysql_query("select * from ".$__table." where ".$__id." = '$DelInfo' ") or die(mysql_error());
            $a2 = mysql_fetch_array($r2);

            for($i=1;$i<=100;$i++)
            {
                if(file_exists($__uploadfolder.$a2['ItemImage'.$i]))
                {
                    unlink($__uploadfolder.$a2['ItemImage'.$i]);
                    unlink($__thumbuploadfolder.$a2['ItemImage'.$i]);
                }   
            }

            //delete the product
            mysql_query("delete from ".$__table." where ".$__id." = '".$DelInfo."' ") or die(mysql_error());
        }
    }
}

if(isset($_POST[s100]))
{
    $MyProductName = mysql_escape_string(trim(stripslashes(strip_tags($_POST[ProductName]))));
    $Description = mysql_escape_string(trim(strip_tags(stripslashes($_POST['Description']))));
    $Link = trim(strip_tags(stripslashes($_POST['Link'])));
    $TopLabel = cleaninput($_POST['TopLabel'],"mres|he|tr");
    $status = $_POST['status'];
    $NewTopLabelName = $TopLabel;

    if(!empty($_FILES['TopImage']['name']))
    {
        $NewTopImageName = $__imageprefix.$t.$_FILES['TopImage']['name'];
        if(is_uploaded_file($_FILES['TopImage']['tmp_name'])) 
        {
            move_uploaded_file($_FILES['TopImage']['tmp_name'], $__uploadfolder.$NewTopImageName);
            $NewTopImageName = $NewTopImageName;
            $NewTopLabelName = $TopLabel;
            //lets make the thumb
            $tm = new dThumbMaker;
            $load = $tm->loadFile($__uploadfolder.$NewTopImageName);
            if($load === true)
            { // Note three '='
                $tm->cropCenter($Thumb_Imgwidth, $Thumb_Imgheight);
                $tm->build($__thumbuploadfolder.$NewTopImageName);
            }
            else
            {
                // Error returned.
                $error .= "Could not open the file '".$NewTopImageName."'.\n";
                $error .= "The error returned was: ";
                $error .= $load;
            }
        }
    }
    else
    {
        $NewTopImageName = $_POST['OldTopImage'];
        $NewTopLabelName = $NewTopLabelName;
    }

    for($i=1;$i<=100;$i++) //This is where I believe the problem is --------------------------------------------------------------------
    {   
        ${'NewsItemLabel'.$i} = cleaninput($_POST['ItemLabel'.$i],"mres|he|tr");
        $ItemLabels .= "ItemLabel".$i ." = '". cleaninput($_POST['ItemLabel'.$i],"mres|he|tr") ."',";
        if(!empty($_FILES['ItemImage'.$i]['name']))
        {
            ${'NewImageName'.$i} = $__imageprefix.$t.$_FILES['ItemImage'.$i]['name'];
            if(is_uploaded_file($_FILES['ItemImage'.$i]['tmp_name'])) 
            {
                move_uploaded_file($_FILES['ItemImage'.$i]['tmp_name'], $__uploadfolder.${'NewImageName'.$i});
                //lets make the thumb
                $tm = new dThumbMaker;
                $load = $tm->loadFile($__uploadfolder.${'NewImageName'.$i});
                if($load === true)
                { // Note three '='
                    $tm->cropCenter($Thumb_Imgwidth, $Thumb_Imgheight);
                    $tm->build($__thumbuploadfolder.${'NewImageName'.$i});
                    $ItemImages .= "ItemImage".$i ." = '". ${'NewImageName'.$i} ."',";
                }
                else
                {
                    // Error returned.
                    $error .= "Could not open the file '".${'NewImageName'.$i}."'.\n";
                    $error .= "The error returned was: ";
                    $error .= $load;
                }
            } else {  }
        }
        else
        {
            ${'NewImageName'.$i} = $_POST['OldItemImage'.$i];
        }
    }

    if(empty($error))
    {
        //update the database
        $q1 = "update ".$__table." set 
                        ItemName = '".$MyProductName."',
                        Description = '".$Description."',
                        Link = '".$Link."',
                        TopImage = '$NewTopImageName',
                        Toplabel = '$NewTopLabelName',
                        ".$ItemImages.$ItemLabels."
                        status = '".$status."'

                        where ".$__id." = '".$_POST[$__id]."' ";

        mysql_query($q1) or die(mysql_error());
        echo "<br><br><center>Gallery Updated</center>";
    }
}
if(!empty($_GET[$__id]))
{
   $_POST[$__id] = $_GET[$__id];
}
if(!empty($_POST[$__id]))
{
    //get the product info
    $r1 = mysql_query("select * from devbg_gallery where ".$__id." = '".$_POST[$__id]."' ") or die(mysql_error());
    $a1 = mysql_fetch_array($r1);

    echo $error;
?>
<form method=post action=EditGallery.php enctype="multipart/form-data">
<table align=center width=740>
<caption align=center><b>Gallery Name:</b></caption>
<tr>
    <td align='right'>Event Name:</td>
    <td><input type=text class=input name="ProductName" value="<?php echo $a1['ItemName'];?>"></td>
</tr>
<TR>
    <td align='right'>Description:</td>
    <td><textarea name="Description"cols=60 rows=10><?php echo $a1['Description'];?></textarea></td>
</TR>
<?php
if(!empty($a1['TopImage']))
{
    $v = $a1['TopImage'];
     echo "<tr>";
       echo "<td></td><td><img src='".$__uploadfolder.$v."' width='72' border='0'><br><a href='DeleteImage.php?".$__id."=".$a1[$__id]."&Type=gallery&file=".$v."&img=top'>Delete Image</a></td>";
     echo "</tr>";
}
?>
<tr>
    <td align='right'>Top Image:</td>
    <td><input type=file name=TopImage></td>
</tr>
<tr>
    <td align='right'>Top Image Label:</td>
    <td><input type=text name=TopLabel value="<?php echo $a1['TopLabel'];?>"></td>
</tr>
<?php
            for($i = 1; $i <= 100; $i++)
            {
                if($a1['ItemImage'.$i] != "")
                {
                     echo "<tr>";
                     echo "<td></td><td><img src='".$__uploadfolder.$a1['ItemImage'.$i]."' width='72' border='0'><br><a href='DeleteImage.php?".$__id."=".$a1[$__id]."&Type=gallery&file=".$a1['ItemImage'.$i]."&id=".$i."'>Delete Image</a></td>";
                     echo "</tr>";
                }

                echo "<TR><TD align='right'>Image $i: </TD><TD><input type=file name='ItemImage$i'></TD></TR>\n\t";
                echo "<TR><TD align='right'>Label $i: </td><TD><input type=text name='ItemLabel".$i."' value='".cleaninput($a1['ItemLabel'.$i],"ss|hd|tr")."' size='79'></TD></TR>\n\t";
                echo "<input type='hidden' name='OldImage$i' value='".$a1['ItemImage'.$i]."'>";
                echo "<input type='hidden' name='OldLabel$i' value='".cleaninput($a1['ItemLabel'.$i],"ss|hd|tr")."'>";
            }
?>
<tr>
    <td></td>
    <td>
        <input type="hidden" name="OldTopImage" value="<?php echo $a1['TopImage'];?>">
        <input type="hidden" name="OldTopLabel" value="<?php echo $a1['TopLabel'];?>">
        <input type="hidden" name=<?php echo $__id;?> value="<?php echo $_POST[$__id];?>">
        <input type="submit" name="s100" value="Edit Gallery">
    </td>
</tr>
</form>
<?php
    exit();
}
if(!empty($_GET[Start]))
{
    $Start = $_GET[Start];
}
else
{
    $Start = '0';
}

$ByPage = "10";

//get the products list
$r1 = mysql_query("select * from devbg_gallery order by ordering_id ASC limit $Start,$ByPage") or die(mysql_error());
if(mysql_num_rows($r1) == '0')
{
    echo "<center>You have no items at the database!</center>";
    exit();
}
?>
<form method=post>
<table align=center width=500 cellspacing="0" cellpadding="3">
<tr style="background-color:#b5c3ce; color:white; font-family:verdana; font-size:11; font-weight:bold">
    <td>Title</td>
    <td>User</td>
    <td align='center'>Edit</td>
    <td align='center'>Delete</td>
</tr>
<?php
$col = "white";
$i=0;
while($a1 = mysql_fetch_array($r1))
{
    $r2 = mysql_query("select * from tbl_register where GID = '".$a1['ItemID']."'") or die(mysql_error());
    $a2 = mysql_fetch_array($r2);
    $name = $a2['firstname'] . " " . $a2['lastname'];

    $i++;
    if($col == "white" )
    {
        $col = "#f3f6f8";
    }
    else
    {
        $col = "white";
    }

    echo "<tr bgcolor=$col>
          <td>".$a1['ItemName']."</td>
          <td>".$name."</td>";
    echo "<td align=center><input type=radio name='".$__id."' value='".$a1[$__id]."'></td>
          <td align='center'><input type='checkbox' name='DelItem[]' value='".$a1[$__id]."'></td>
          </tr>\n\n";

}
    echo "<tr>
            <td colspan=4 align=right><br>\n\t<input class=input type=submit name=ds value='Edit Selected'>  <input type='submit' class='input' name='ds' value='Delete Selected'></td>
          </tr>
</table>
</form>\n\n";

//build the "next" - "prev" navigatioin
$qnav = "select * from ".$__table." order by ItemName ";
$rnav = mysql_query($qnav) or die(mysql_error());
$rows = mysql_num_rows($rnav);
        echo  "<br><table align=center width=600>";
        echo "<td align=center><font face=verdana size=2> | ";
        $pages = ceil($rows/$ByPage);

        for($i = 0; $i <= ($pages); $i++)
        {
            $PageStart = $ByPage*$i;
            $i2 = $i + 1;
            if($PageStart == $Start)
            {
                $links[] = " <span class=bodybold>$i2</span>\n\t ";
            }
            elseif($PageStart < $rows)
            {
                $links[] = " <a class=bodybold href=EditGallery.php?Start=$PageStart>$i2</a>\n\t "; 
            }
        }
        $links2 = implode(" | ", $links);
        echo $links2;
        echo  "| </td>";
        echo "</table><br>\n";
?>
<?php include("footer.php");?> 
```

如果我可以提供任何其他有助于找到解决方案的信息，我可以直接发布。这个问题真的让我很头疼，我的客户需要他的画廊运行！让我希望我可以自己编写代码并在他以前的开发人员之前到达那里。谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:03:22.733

我的一个朋友发现，当我移动主机时，我的 php.ini 中的**max_file_uploads**设置设置为**20**，并且您在上面看到的代码会循环每个图像并尝试上传它，即使没有图像也是如此，这就解释了为什么即使我只尝试自己上传1，它也不会在19之后上传任何内容。只是一个简单的设置被忽略了。

在我的ini中将此更改为**max_file_uploads = 100**，现在一切正常，客户满意！****

# objective-c - 将 UIImageViews 放在一行中

> ID：13463993
> 
> 赞同：1
> 
> 时间：2012-11-19T23:06:30.373
> 
> 标签：objective-c, ios, uiview

我正在遍历一个数组并添加 UIImageViews，该数组有不同的计数，具体取决于某些东西。所以 UIImageViews 的数量是不同的。我需要做的是在视图中心将它们排成一排。我知道我需要使用我遇到问题的计算的代码。

```
 for (int i = 0; i < [_lettersArray count]; i++){

    UIImage* imageContainer = [UIImage imageNamed:@"container.png"];
            UIImageView *containerView = [[UIImageView alloc] initWithImage:imageContainer];
            containerView.frame = CGRectMake(???,120,imageContainer.size.width,imageContainer.size.height);
[self.view addSubview:containerView];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:30:24.873

```
[self _layoutViews:self.imageViews inView:self.view];

- (void) _layoutViews:(NSArray *)views inView:(UIView *)contentView
{
    NSInteger overallWidth = 0;
    for ( UIView *view in views ) {
        overallWidth += view.frame.size.width;
    }

    CGSize contentSize = contentView.frame.size;
    CGFloat startOffset = (contentSize.width - overallWidth)/2.0;
    CGFloat offset = startOffset;
    for ( UIView *view in views ) {
        CGRect frame = view.frame;
        frame.origin.x = offset;
        frame.origin.y = (contentSize.height/2.0) - (frame.size.height/2.0);
        view.frame = frame;
        offset += view.frame.size.width;
    }
} 
```

对于您的示例代码，它将是这样的：

```
 CGFloat count = [_lettersArray count];
    NSMutableArray *imageViews = [[NSMutableArray alloc] initWithCapacity:count];
    for (int i = 0; i < [_lettersArray count]; i++) {
        UIImage *imageContainer = [UIImage imageNamed:@"container.png"];
        UIImageView *containerView = [[UIImageView alloc] initWithImage:imageContainer];
        containerView.frame = CGRectMake(0,120,imageContainer.size.width,imageContainer.size.height);
        [imageViews addObject:containerView];
        [self.view addSubview:containerView];
    }

    [self _horizontalCenterViews:imageViews inView:self.view];

    return YES;
}

- (void) _horizontalCenterViews:(NSArray *)views inView:(UIView *)contentView
{
    NSInteger overallWidth = 0;
    for ( UIView *view in views ) {
        overallWidth += view.frame.size.width;
    }

    CGSize contentSize = contentView.frame.size;
    CGFloat startOffset = (contentSize.width - overallWidth)/2.0;
    CGFloat offset = startOffset;
    for ( UIView *view in views ) {
        CGRect frame = view.frame;
        frame.origin.x = offset;
        view.frame = frame;
        offset += view.frame.size.width;
    }
} 
```

# ruby - 来自 Apache 服务器上的 Ruby 脚本的 ADODB.Connection 错误

> ID：13463996
> 
> 赞同：1
> 
> 时间：2012-11-19T23:06:41.120
> 
> 标签：ruby, apache, adodb

我有一个连接到 SQL Server 数据库的 Ruby 脚本（非 Rails）。从命令行运行时，它运行良好。当通过 http 请求执行时，它会产生错误，特别是在打开数据库连接时。关于 http/SQL 方法组合的某些事情失败了。

我在以下机器上运行脚本：Windows 7 Ultimate（64 位）、Ruby 1.9.3p125、Apache 2.2.11。该数据库是 SQL Server 10.0.4000，托管在单独的（公司、内部）服务器上。

脚本看起来像这样：

```
#!/Ruby193/bin/ruby
require 'win32ole'
...
$qadb = nil
begin
  $qadb = SqlServer.new('192.168.100.249', 'qauser', 'password')
  $qadb.open('qadb')
rescue
  logRegression("Rescued: Unable to access QADB: #{$!}")
end 
```

SqlServer 类基于 David Mullet 的代码，可在[http://rubyonwindows.blogspot.com/2007/03/ruby-ado-and-sqlserver.html](http://rubyonwindows.blogspot.com/2007/03/ruby-ado-and-sqlserver.html)找到（为简洁起见，此处未复制）。

从命令行，数据库打开正常，我从脚本中得到了预期的结果。当我通过内部服务器 (http://qatools/getTask.rb) 调用脚本时，我的日志文件中出现以下错误：

> 已获救：无法访问 QADB：无法从“ADODB.Connection”创建 WIN32OLE 对象 HRESULT 错误代码：0x8007007e 找不到指定的模块。

我考虑过我可能缺少一个 DLL。其他研究让我找到了 ntwdblib.dll——我尝试下载一个副本并将其放在不同的文件夹中。我还考虑过我可能面临 Apache 配置问题和/或安全/权限问题，但我还没有找到任何适合我的特定问题的解决方案。

有任何想法吗？

# javascript - 将变量传递给匿名函数/回调

> ID：13463998
> 
> 赞同：0
> 
> 时间：2012-11-19T23:06:42.210
> 
> 标签：javascript, callback, anonymous-function

我正在尝试传入包含匿名函数`product`的函数，该匿名函数同时包含和。不幸的是，整个函数在迭代中运行，只有第一个值进入。我如何传递给?`find()``.toArray()``error``array``find()``product``callbacks`

```
var find = function(product,callbacks){
    foos.find({
        "foo": product.bars,
    }).toArray(function (error, array) {
        if(error){
            callbacks.error(product,error);
        } else if (array.length == 0) {
            callbacks.none(product);
        } else {
            callbacks.exists(product);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:44:06.530

在我处理这个函数之前`products`，`forEach()`然后在回调中运行这个函数。这是个大麻烦。`products`用常规处理`for`，现在它可以工作了。

### 旧代码

```
var products = function(data,callback){
    products.forEach(function(product){
        insert.product_id = product.id;
        var variants = product.variants;
        variants.forEach(function(variant){
            insert.sku = variant.sku;
            insert.variant_id = variant.id;
            return callback(insert);
        });
    });
} 
```

### 新代码

```
var products = function(data){
    var insert = [];
    var products = data.products;
    for(var pKey in products){
        var product = products[pKey];
        var variants = product.variants;
        var set = {}
        set.product_id = product.id;
        for(var vKey in variants){
            var variant = variants[vKey];
            set.sku = variant.sku;
            set.variant_id = variant.id;
            insert.push(set);
        }
    }
    return insert;
} 
```

# language-agnostic - SRP 不违反封装

> ID：13463999
> 
> 赞同：5
> 
> 时间：2012-11-19T23:06:45.777
> 
> 标签：language-agnostic, encapsulation, single-responsibility-principle

我无法将单一职责原则与封装相协调。似乎在类之间划分职责需要公开大量数据。例如，考虑一些名为`DataPoints`. `DataPoints`填充了 x 和 y 坐标等。我可以创建一个生成器类来填充`DataPoints`. 现在，假设我想绘制这些数据点。显然，这是一个单独的职责，可能来自一个名为`DataPointsPlotter`. 但要绘制数据，我需要知道内部 x 和 y 坐标是什么。一个班级同时处理这两个问题，这没问题。x 和 y 是内部变量，但 create() 和 print() 方法都可以访问这些变量。我可以公开 x 和 y（也许通过 getters/setters--ugh）或者我可以通过`DataPoints`结构到 Plotter 类，但它仍然需要进入内部以获取 x 和 y。我可以在`DataPoints`发送 x 和 y 的类中声明一个 Plotter 实例。但这仍然是一个曝光。

在此示例中，如何在不违反封装的情况下使用绘图仪绘制 x 和 y？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T14:49:03.867

```
class DataPoint {

    protected x, y

    public function construct(theX, theY) {
        x = theX
        y = theY
    }

    public function getX {
        return x
    }

    public function getY {
        return y
    }

} 
```

这封装了以已知格式表示数据点的责任。假设还进行了一些健全性检查以确认这一点`x`并`y`具有良好的价值，这是此处封装的一项责任。

```
class Plotter {

    public function plot(DataPoint dp) {
        x = dp.getX
        y = dp.getY

        ... plot ...
    }

} 
```

绘图仪接受一个实例`DataPoint`并绘制它。这也是一项责任：绘制`DataPoint`. 它不需要对 . 的*内部结构*有`Plotter`任何了解。它只需要一个已定义且稳定的接口，如何从中获取必要的数据。哪些是吸气剂和. 只要它的*界面*保持不变，你就可以随意改变它的内部结构。的职责是保存一个数据点*并让其他代码以定义的方式访问其数据*。如果没有办法从中获取数据，那么它的存在将毫无用处。*`DataPoint``Plotter``DataPoint``getX``getY``DataPoint`*`DataPoint`*`DataPoint`***

 ***所以不，SRP 和封装并不矛盾。你只需要明确责任到底是什么。***